
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wikipedia - Documentación Técnica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #f6f6f6;
            font-family: 'Noto Sans', sans-serif;
            color: #202122;
            margin: 0;
            padding: 0;
        }
        .mw-body {
            background-color: #ffffff;
            border: 1px solid #a7d7f9;
            border-right-width: 0;
            margin-left: 11rem;
            padding: 1.25rem 1.5rem 1.5rem 1.5rem;
            min-height: 100vh;
        }
        .mw-header {
            font-family: 'Libre Baskerville', serif;
            border-bottom: 1px solid #a2a9b1;
            margin-bottom: 0.25em;
            padding-top: 0.5em;
            font-size: 1.8em;
            font-weight: normal;
        }
        .mw-sidebar {
            width: 11rem;
            position: absolute;
            left: 0;
            top: 0;
            padding: 1rem 0.5rem;
        }
        .sidebar-logo {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        .sidebar-logo span {
            font-family: 'Libre Baskerville', serif;
            font-size: 1.2rem;
            display: block;
        }
        .sidebar-logo small {
            font-size: 0.7rem;
            color: #54595d;
            text-transform: uppercase;
        }
        .nav-link {
            color: #0645ad;
            font-size: 0.85rem;
            display: block;
            padding: 0.2rem 0.5rem;
            text-decoration: none;
        }
        .nav-link:hover {
            text-decoration: underline;
        }
        .nav-link.active {
            color: #202122;
            font-weight: bold;
            border-left: 2px solid #3366cc;
            background: #f8f9fa;
        }
        
        /* Markdown Content Styling */
        #markdownBody h1 { font-family: 'Libre Baskerville', serif; font-size: 1.8em; border-bottom: 1px solid #a2a9b1; margin: 1em 0 0.25em; font-weight: normal; }
        #markdownBody h2 { font-family: 'Libre Baskerville', serif; font-size: 1.5em; border-bottom: 1px solid #a2a9b1; margin: 1.5em 0 0.25em; font-weight: normal; }
        #markdownBody h3 { font-size: 1.2em; font-weight: bold; margin: 1.2em 0 0.25em; }
        #markdownBody p { margin: 0.5em 0 1em; line-height: 1.6; font-size: 0.95rem; }
        #markdownBody ul { list-style-type: disc; margin-left: 2rem; margin-bottom: 1rem; }
        #markdownBody li { margin-bottom: 0.3em; font-size: 0.95rem; }
        #markdownBody a { color: #0645ad; text-decoration: none; }
        #markdownBody a:hover { text-decoration: underline; }
        #markdownBody code { background-color: #f8f9fa; border: 1px solid #eaecf0; padding: 0.1em 0.3em; border-radius: 2px; font-family: monospace; font-size: 0.9em; }
        #markdownBody pre { background-color: #f8f9fa; border: 1px solid #eaecf0; padding: 1em; margin: 1em 0; overflow-x: auto; border-radius: 2px; }
        #markdownBody blockquote { border-left: 4px solid #eaecf0; padding-left: 1em; color: #54595d; font-style: italic; margin: 1em 0; }
        
        .toc {
            background-color: #f8f9fa;
            border: 1px solid #a2a9b1;
            padding: 0.5rem;
            display: inline-block;
            min-width: 200px;
            margin-bottom: 1.5rem;
            font-size: 0.85rem;
        }
        .toc-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>

    <aside class="mw-sidebar">
        <div class="sidebar-logo">
            <span>Enciclopedia</span>
            <small>Libre de Desarrollo</small>
        </div>
        
        <div class="mb-4">
            <h4 class="text-[0.75rem] font-bold text-[#54595d] px-2 mb-1 border-b border-[#eaecf0] uppercase tracking-tighter">Navegación</h4>
            <nav id="sidebarNav">
                <!-- Nav items here -->
            </nav>
        </div>
        
        <div class="mt-8 px-2">
            <input id="searchInput" type="text" placeholder="Buscar en Docs..." class="w-full text-xs border border-[#a2a9b1] p-1 outline-none focus:border-[#3366cc]">
        </div>
    </aside>

    <main class="mw-body">
        <div class="flex justify-between items-start mb-4">
            <h1 id="mainTitle" class="mw-header">Cargando...</h1>
            <div class="text-[0.8rem] space-x-2">
                <button onclick="window.print()" class="text-[#0645ad] hover:underline">Imprimir</button>
            </div>
        </div>

        <div id="contentArea">
            <div id="markdownBody">
                <!-- Body content here -->
            </div>
        </div>
        
        <footer class="mt-12 pt-4 border-t border-[#a2a9b1] text-[0.75rem] text-[#54595d]">
            <p>Esta página fue editada por última vez por Antigravity (IA) el 07/01/2026.</p>
            <p>El texto está disponible bajo la Licencia Creative Commons Atribución Compartir Igual 3.0.</p>
        </footer>
    </main>

    <script>
        const docs = {
            "integracion_timeline.md": `# Integración Módulo Timeline (Cronologías)\n\n**Fecha:** 07/01/2026\n**Estado:** Completado / Estable\n\n## Resumen\nSe ha completado la integración del módulo de **Líneas de Tiempo** en la interfaz principal (\`ArchitectLayout\`), moviéndolo de una vista aislada a un panel lateral contextual (Right Sidebar) y una visualización central dedicada. Además, se han resuelto errores críticos de persistencia y sincronización.\n\n## Cambios Realizados\n\n### 1. Arquitectura Frontend (React)\n- **Integración en \`ArchitectLayout.jsx\`**:\n    - Se ha habilitado el modo \`CUSTOM\` en el panel lateral derecho para inyectar componentes dinámicos mediante **React Portals**.\n    - \`TimelineView.jsx\` ahora renderiza los formularios de creación/edición de eventos en el sidebar derecho, manteniendo la visualización del grafo en el centro.\n- **Sincronización de Contexto**:\n    - Se implementó un \`focus listener\` en \`ArchitectLayout\` que fuerza la recarga del contexto del proyecto (\`loadProject\`) al cambiar de pestaña en el navegador. Esto corrige el error de mezcla de datos entre proyectos abiertos simultáneamente.\n\n### 2. Backend (Spring Boot)\n- **Consolidación de Entidades**:\n    - Se eliminaron las clases redundantes \`EventoCronologia\` y \`LineaTemporal\`.\n    - Se estandarizó el uso de \`EventoTiempo\` y \`LineaTiempo\`.\n- **Nuevos Endpoints**:\n    - \`DELETE /api/timeline/evento/{id}\`: Para borrado de eventos.\n    - \`DELETE /api/timeline/linea/{id}\`: Para borrado de líneas de tiempo completas.\n- **Optimización JSON**:\n    - Se añadió \`@JsonProperty(access = WRITE_ONLY)\` en las relaciones bidireccionales (\`EventoTiempo\` -> \`LineaTiempo\`) para permitir la deserialización (guardado) sin causar recursión infinita en la serialización (lectura).\n\n### 3. Corrección de Errores (Bugfixes)\n- **Error de Borrado (Timeline y Eventos)**:\n    - **Causa**: Faltaban los endpoints \`DELETE\` en el controlador y \`api.js\` fallaba al procesar respuestas vacías (\`204 No Content\`).\n    - **Solución**: Implementación de endpoints y parcheo de \`api.js\` para devolver \`null\` en lugar de lanzar \`SyntaxError\` en respuestas vacías.\n- **Error \"No events yet\"**:\n    - **Causa**: El filtrado en cliente fallaba porque la relación \`lineaTiempo\` no se enviaba al cliente (por \`@JsonIgnore\`).\n    - **Solución**: Se cambió a filtrado en servidor (\`/timeline/linea/{id}/eventos\`).\n- **Ordenamiento de Eventos Negativos**:\n    - **Solución**: Se corrigió la lógica de sugerencia de orden para respetar fechas negativas (a.C.), evitando que el contador se reinicie a 1 incorrectamente.\n`,
            "Errores_Desarrollo.md": "# Errores durante la creaci\u00c3\u00b3n.md\n\nEste documento detalla los problemas encontrados y resueltos durante la sesi\u00c3\u00b3n de depuraci\u00c3\u00b3n para hacer funcionar el env\u00c3\u00ado de formularios (`POST /api/bd/insertar`) tras la refactorizaci\u00c3\u00b3n principal.\n\nLos errores se clasifican por su origen: Externo (entorno/configuraci\u00c3\u00b3n), Java (backend) o JavaScript/HTML (frontend).\n\n---\n\n## 1. Externo (Entorno y Configuraci\u00c3\u00b3n)\n\nEstos fueron los errores m\u00c3\u00a1s cr\u00c3\u00adticos que impidieron que la aplicaci\u00c3\u00b3n arrancara o se conectara a la base de datos.\n\n### Error 1.1: Incompatibilidad de Versi\u00c3\u00b3n de MySQL\n* **S\u00c3\u00adntoma:** La aplicaci\u00c3\u00b3n arrancaba, pero los datos no se guardaban. El log de Spring Boot mostraba la advertencia `HHH000511: The 5.5.5 version for [org.hibernate.dialect.MySQLDialect] is no longer supported... The minimum supported version is 8.0.0.`\n* **Causa:** La versi\u00c3\u00b3n antigua de XAMPP usaba MySQL 5.5, que no es compatible con Hibernate 6 (usado por Spring Boot 3+).\n* **Soluci\u00c3\u00b3n:** Desinstalar el XAMPP antiguo e instalar una versi\u00c3\u00b3n moderna que incluya MySQL 8.0+.\n\n### Error 1.2: Puerto 8080 en uso\n* **S\u00c3\u00adntoma:** La aplicaci\u00c3\u00b3n Spring Boot no arrancaba, mostrando un error indicando que el puerto 8080 ya estaba en uso.\n* **Causa:** Un proceso anterior de Spring Boot (o cualquier otra aplicaci\u00c3\u00b3n) no se cerr\u00c3\u00b3 correctamente y segu\u00c3\u00ada ocupando el puerto 8080.\n* **Soluci\u00c3\u00b3n:** Identificar el PID del proceso que ocupaba el puerto 8080 usando `netstat -ano | findstr :8080` y luego finalizar la tarea con `taskkill /PID [PID] /F` en la l\u00c3\u00adnea de comandos (como administrador).\n\n### Error 1.3: Permisos de XAMPP en Windows\n* **S\u00c3\u00adntoma:** El panel de control de XAMPP (nuevo) fallaba al iniciarse, mostrando errores `EAccessViolation` y `Error: Cannot create file \"C:\\Users\\...\\xampp-control.ini\". Acceso denegado`.\n* **Causa:** El panel de control no ten\u00c3\u00ada permisos de administrador para escribir su archivo de configuraci\u00c3\u00b3n en la carpeta `AppData` del usuario.\n* **Soluci\u00c3\u00b3n:** Ejecutar siempre `xampp-control.exe` usando la opci\u00c3\u00b3n \"Ejecutar como administrador\".\n\n### Error 1.4: Conflicto de Puerto de MySQL\n* **S\u00c3\u00adntoma:** Al intentar iniciar MySQL (como administrador), el panel de XAMPP mostraba `Error: MySQL shutdown unexpectedly... This may be due to a blocked port`.\n* **Causa:** El servicio `mysqld.exe` de la *antigua* instalaci\u00c3\u00b3n de XAMPP segu\u00c3\u00ada ejecut\u00c3\u00a1ndose en segundo plano, bloqueando el puerto 3306 e impidiendo que el nuevo servicio se iniciara.\n* **Soluci\u00c3\u00b3n:** Se utiliz\u00c3\u00b3 `netstat -ano | findstr :3306` para encontrar el ID de Proceso (PID) del `mysqld.exe` conflictivo y se finaliz\u00c3\u00b3 la tarea desde el Administrador de Tareas.\n\n### Error 1.4: Configuraci\u00c3\u00b3n de Dialecto de Spring (Post-actualizaci\u00c3\u00b3n)\n* **S\u00c3\u00adntoma:** Tras actualizar XAMPP, la aplicaci\u00c3\u00b3n Spring Boot no arrancaba, mostrando `BeanCreationException: Unable to determine Dialect`.\n* **Causa:** Ir\u00c3\u00b3nicamente, al quitar el dialecto (recomendado para MySQL 5.5), la auto-detecci\u00c3\u00b3n de Hibernate 6 fall\u00c3\u00b3 con MySQL 8.\n* **Soluci\u00c3\u00b3n:** Se volvi\u00c3\u00b3 a a\u00c3\u00b1adir `spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect` al archivo `application.properties`.\n\n### Error 1.5: Configuraci\u00c3\u00b3n de Contrase\u00c3\u00b1a de Spring\n* **S\u00c3\u00adntoma:** Tras arreglar el dialecto, la aplicaci\u00c3\u00b3n segu\u00c3\u00ada sin arrancar, mostrando `BeanCreationException: Access denied for user 'root'@'localhost' (using password: YES)`.\n* **Causa:** La nueva instalaci\u00c3\u00b3n de XAMPP usa el usuario `root` sin contrase\u00c3\u00b1a, pero `application.properties` segu\u00c3\u00ada configurado con `spring.datasource.password=root`.\n* **Soluci\u00c3\u00b3n:** Se cambi\u00c3\u00b3 la configuraci\u00c3\u00b3n a `spring.datasource.password=` (vac\u00c3\u00ado) en `application.properties`.\n\n---\n\n## 2. JavaScript (Frontend)\n\nEstos errores impidieron que el navegador enviara los datos al backend, aunque el backend ya funcionaba.\n\n### Error 2.1: M\u00c3\u00a9todo HTTP Incorrecto (PUT vs. POST)\n* **S\u00c3\u00adntoma:** Los datos no se guardaban. Si se hubiera inspeccionado la pesta\u00c3\u00b1a \"Red\" (Network) del navegador, se habr\u00c3\u00ada visto un error `405 Method Not Allowed`.\n* **Causa:** El script `opcionesForm.js` enviaba los datos usando `method: \"PUT\"`, pero el `BDController.java` esperaba un `method: \"POST\"` (definido por la anotaci\u00c3\u00b3n `@PostMapping(\"/insertar\")`).\n* **Soluci\u00c3\u00b3n:** Se modific\u00c3\u00b3 la llamada `fetch` en `opcionesForm.js` para usar `method: \"POST\"`.\n\n### Error 2.2: Fallo de Carga de Script Din\u00c3\u00a1mico (El Error Clave)\n* **S\u00c3\u00adntoma:** Al pulsar \"Guardar\", la p\u00c3\u00a1gina **se recargaba** por completo, ignorando el env\u00c3\u00ado de datos.\n* **Causa:** El script `ventanaCreacion.js` cargaba el HTML de los formularios usando `.innerHTML`. Por seguridad, los navegadores no ejecutan las etiquetas `<script>` (como `<script src=\"...opcionesForm.js\">`) que se insertan de esta manera. Como resultado, el `e.preventDefault()` en `opcionesForm.js` nunca se ejecutaba.\n* **Soluci\u00c3\u00b3n (en 3 partes):**\n    1.  **Modificar `ventanaCreacion.js`:** Se a\u00c3\u00b1adi\u00c3\u00b3 c\u00c3\u00b3digo para que, *despu\u00c3\u00a9s* de insertar el HTML, cree manualmente una nueva etiqueta `<script>`, le asigne el `.src` y la a\u00c3\u00b1ada al `document.body`, forzando su carga y ejecuci\u00c3\u00b3n.\n    2.  **Modificar `opcionesForm.js`:** Se elimin\u00c3\u00b3 el *listener* `DOMContentLoaded`, ya que el script ahora se carga din\u00c3\u00a1micamente *despu\u00c3\u00a9s* de que el DOM principal se haya cargado.\n    3.  **Modificar HTML (Opciones):** Se eliminaron las etiquetas `<script src=\"...\">` de los 6 archivos HTML en `html/opciones/`, ya que `ventanaCreacion.js` ahora gestiona su carga.\n\n---\n\n## 3. HTML (Frontend)\n\n### Error 3.1: Ruta de Script Incorrecta\n* **S\u00c3\u00adntoma:** La p\u00c3\u00a1gina se segu\u00c3\u00ada recargando incluso despu\u00c3\u00a9s de implementar la soluci\u00c3\u00b3n 2.2.\n* **Causa:** Un error en la refactorizaci\u00c3\u00b3n. La ruta del script en los HTML de `html/opciones/` era `../js/...` (un nivel arriba), pero la ruta correcta desde esa carpeta era `../../js/...` (dos niveles arriba).\n* **Soluci\u00c3\u00b3n:** Se corrigi\u00c3\u00b3 la ruta del script en los 6 archivos HTML de `html/opciones/` a `src=\"../../js/components/opcionesForm.js\"`. (Nota: esta soluci\u00c3\u00b3n se volvi\u00c3\u00b3 obsoleta por la soluci\u00c3\u00b3n 2.2, pero fue un paso intermedio en la depuraci\u00c3\u00b3n).\n\n---\n\n## 4. React Migration (SPA)\n\n### Error 4.1: Critical Blank Screen on Startup\n* **Symptom:** The new React application loaded a blank dark screen. The index.html was served, but the `#root` element remained empty. No obvious errors in the browser console initially.\n* **Cause**: The `src/main/frontend/jsx/main.jsx` entry point had a ReferenceError. It used `rootElement` in a conditional check before defining it.\n* **Solution**: Correctly defined `const rootElement = document.getElementById('root');` before usage. Added robust try-catch blocks during debugging to verify the fix, then cleaned them up.\n\n---\n\n## 5. Multi-Tenancy & SPA Architecture (v3.6.0)\n\n### Error 5.1: 500 Internal Server Error (Missing User Data Folder)\n* **S\u00edntoma:** Al intentar crear un proyecto con \newuser, el servidor devolv\u00eda Error 500. El log mostraba java.sql.SQLException: path to '.../data/users/user_3.db' does not exist.\n* **Causa:** La l\u00f3gica de aislamiento tenant intentaba conectar a una base de datos SQLite en una carpeta (data/users) que no exist\u00eda f\u00edsicamente en el entorno de despliegue, aunque el usuario s\u00ed exist\u00eda en la BD principal.\n* **Soluci\u00f3n:** Se a\u00f1adi\u00f3 la creaci\u00f3n autom\u00e1tica de directorios en el servicio de registro. Para este caso puntual, se repar\u00f3 manualmente creando la carpeta src/main/resources/data/users y copiando el template.\n\n### Error 5.2: 404 Whitelabel Error en Recarga (SPA Routing)\n* **S\u00edntoma:** Al recargar la p\u00e1gina en una ruta profunda (ej. /project/5/bible), Spring Boot devolv\u00eda un 404.\n* **Causa:** Spring Boot intentaba resolver la URL como un recurso est\u00e1tico o endpoint API. Al no existir, fallaba. React Router solo puede manejar la ruta si el servidor devuelve index.html primero.\n* **Soluci\u00f3n:**\n    1.  Se cre\u00f3 SpaController.java para redirigir cualquier ruta no-API y no-est\u00e1tica (regex /{path:[^\\.]*}) hacia \forward:/index.html.\n    2.  Se habilit\u00f3 spring.mvc.pathmatch.matching-strategy=ant_path_matcher en \u0007pplication.properties para soportar las regex complejas.\n\n### Error 5.3: UI Desactualizada tras Cambios (Build Pipeline)\n* **S\u00edntoma:** Los cambios en Sidebar (iconos colapsados) no se ve\u00edan en el navegador a pesar de estar codificados.\n* **Causa:** El servidor Spring Boot serv\u00eda los archivos est\u00e1ticos de \target/classes/static, que eran una copia antigua. Vite no estaba compilando autom\u00e1ticamente.\n* **Soluci\u00f3n:** Se actualiz\u00f3 INICIAR.bat para ejecutar \npm run build antes de arrancar el servidor Java, garantizando que el frontend siempre est\u00e9 sincronizado.\n\n\n### Error Critical 500: 'No such table: cuaderno' (SQLite)\n**S\u00edntoma:** Error 500 intermitente al cargar workspaces o crear carpetas. Logs truncados imped\u00edan ver la causa.\n**Diagn\u00f3stico:**\n- GlobalExceptionHandler revel\u00f3 SQLITE_ERROR: no such table: cuaderno.\n- La herramienta Diagnostic ve\u00eda la tabla, pero Hibernate no.\n- Causa ra\u00edz: Ambig\u00fcedad en la ruta relativa de JDBC (jdbc:sqlite:src/...) vs el directorio de trabajo de ejecuci\u00f3n.\n**Soluci\u00f3n:**\n1. Hardcodear ruta absoluta en \u0007pplication.properties: jdbc:sqlite:/src/... (o ruta f\u00edsica).\n2. spring.jpa.hibernate.ddl-auto=none para evitar que Hibernate intente validar/crear esquema y conf\u00ede en DatabaseMigration.\n**Estado:** Resuelto. Logs movidos a carpeta /Data.\n\n## [2026-01-02] Limpieza de directorio Data\n**Acci\u00c3\u00b3n:** Se movieron \backend.log, server.log, startup.log, \trace.txt del directorio Data a Docs/logs para centralizar la auditor\u00c3\u00ada.\n\n## [06/01/2026] Pantalla Blanca (Crash MapEditor)\n**S\u00c3\u00adntoma:** Pantalla blanca al cargar la app. Error silencioso de importaci\u00c3\u00b3n.\n**Diagn\u00c3\u00b3stico:** Conflicto de versiones. \neact-konva v19 requiere React 19, pero el proyecto usa React 18.\n**Soluci\u00c3\u00b3n:** Downgrade a \neact-konva@18.2.10 y konva@9.3.16.\n**Estado:** Resuelto.\n\n---\n\n### Error: SQLITE_ERROR: no such table: cuaderno\n* **S\u00c3\u0083ntoma:** Errores de base de datos al iniciar o abrir proyectos.\n* **Causa:** Uso de SQLite en memoria para el contexto maestro y falta de CREATE TABLE en migraciones.\n* **Soluci\u00c3\u0083n:** Cambiado a SQLite persistente en MultiTenantDataSource.java y habilitado CREATE TABLE IF NOT EXISTS en DatabaseMigration.java.\n* **Estado:** Resuelto.\n\n### Error: 401 Unauthorized / Password Generada\n* **S\u00c3\u0083ntoma:** Bloqueo de acceso a la API y logs de seguridad de Spring activados.\n* **Causa:** Configuraci\u00c3\u0083n de seguridad por defecto activada; sesion de proyecto se activaba demasiado tarde.\n* **Soluci\u00c3\u0083n:** Configuraci\u00c3\u0083n de SecurityConfig.java con permitAll() y activaci\u00c3\u0083n de sesi\u00c3\u0083n en ProyectoController.java antes de validaciones de metadatos.\n* **Estado:** Resuelto.\n\n### Error: Bot\u00c3\u0083n 'Guardar' desaparecido en EntityBuilder\n* **S\u00c3\u0083ntoma:** Los usuarios no pod\u00c3\u0083an guardar entidades creadas.\n* **Causa:** Posicionamiento \fixed oculto por el sidebar y conflicto de z-index (Stacking Context).\n* **Soluci\u00c3\u0083n:** Redise\u00c3\u0083o de la cabecera de EntityBuilder.jsx para incluir botones persistentes y eliminaci\u00c3\u0083n de z-0 en ArchitectLayout.jsx.\n* **Estado:** Resuelto.\n`,\n", "funcionalidades.md": "# Chronos Atlas: El IDE del Escritor (Redise\u00f1o \"Next\")\n\nChronos Atlas evoluciona hacia un entorno de trabajo a\u00fan m\u00e1s potente y flexible, donde la narrativa y el lore se integran de forma fluida a trav\u00e9s de un dise\u00f1o **Glassmorphism Oscuro** de alta fidelidad. El nuevo paradigma se basa en un espacio de trabajo modular de tres paneles flanqueado por una navegaci\u00f3n tipo dock.\n\n## 1. Biblia del Mundo (Panel Lateral Izquierdo)\n\n### Estructura de Carpetas Personalizable\n- **Prop\u00f3sito**: Sustituir las categor\u00edas fijas por una estructura de carpetas completamente personalizable, permitiendo una organizaci\u00f3n jer\u00e1rquica y tem\u00e1tica de tu lore.\n- **Qu\u00e9 puedes hacer**:\n    - **Crear Carpetas y Subcarpetas**: Un bot\u00f3n o un men\u00fa contextual (clic derecho) permite crear nuevas carpetas. Se pueden anidar para construir una estructura tan compleja como necesites (ej. \"Personajes de Eldoria\" dentro de \"Eldoria\").\n    - **Nombrar Carpetas**: Asigna nombres descriptivos (\"Lugares Importantes\", \"Deidades Antiguas\").\n    - **Definir Atributos por Defecto (en Carpeta)**: Al crear o editar una carpeta, puedes establecer atributos por defecto (ej. campo \"Rango\" para todos los personajes en la carpeta \"Militares\") que se aplicar\u00e1n autom\u00e1ticamente a cualquier nueva entidad creada dentro.\n    - **Arrastrar y Soltar**: Mueve libremente entidades y carpetas para reorganizar tu mundo.\n    - **Visualizaci\u00f3n**: Cada carpeta muestra iconos claros con acentos Indigo-500 al seleccionar.\n- **Dise\u00f1o**: Barra lateral transl\u00facida con \u00e1rbol de navegaci\u00f3n expandible y men\u00fas contextuales para Renombrar, Eliminar o A\u00f1adir Atributos.\n\n## 2. Constructor Universal de Fichas (\u00c1rea Central)\n\n### Lienzo Flexible y Arrastrar y Soltar Atributos\n- **Prop\u00f3sito**: El \u00e1rea central se transforma en un lienzo din\u00e1mico para construir fichas de entidad \u00fanicas, adapt\u00e1ndose a las necesidades de cada elemento de tu mundo.\n- **Qu\u00e9 puedes hacer**:\n    - **Campos por Defecto**: Al crear una entidad, el lienzo se precarga autom\u00e1ticamente con los atributos definidos en la carpeta padre.\n    - **Caja de Herramientas de Atributos**: El panel lateral derecho se transforma en una biblioteca de \"cajas\" de atributos arrastrables cuando el constructor est\u00e1 activo.\n    - **Tipos de Atributos**:\n        - **Texto Libre**: Para biograf\u00edas descripciones extensas.\n        - **Texto Corto**: Para nombres o t\u00edtulos.\n        - **N\u00famero**: Para edad, poblaci\u00f3n, tama\u00f1o.\n        - **Fecha/Hora**: Para eventos cronol\u00f3gicos precisos.\n        - **Selector (Dropdown)**: Para listas predefinidas (ej. \"Estado: Vivo/Muerto\").\n        - **Enlace a Entidad**: Para vincular personajes, lugares u objetos entre s\u00ed.\n        - **Imagen/Multimedia**: Para retratos o arte conceptual.\n        - **Booleano (S\u00ed/No)**: Para propiedades simples.\n        - **Tabla**: Para estad\u00edsticas, inventarios o datos estructurados.\n        - **Mapa Embedido**: Vincula una secci\u00f3n del atlas directamente a la ficha.\n        - **L\u00ednea de Tiempo Embedida**: Muestra una mini-cronolog\u00eda espec\u00edfica del elemento.\n- **Configuraci\u00f3n**: Cada caja de atributo permite renombrar etiquetas, establecer valores por defecto, marcarlos como obligatorios o a\u00f1adir descripciones de ayuda.\n\n## 3. Entidades Especializadas y Pesta\u00f1as de Funci\u00f3n\n\n### Flujo en Dos Pasos (Post-Guardado)\n- **Paso 1: Atributos B\u00e1sicos**: Se definen los atributos generales y se cataloga la entidad (Personaje, Lugar, etc., o tipos especiales como **L\u00ednea de Tiempo**, **Zona/Mapa** o **Lenguaje**).\n- **Paso 2: Pesta\u00f1as de Funciones Especiales**: Al detectar un tipo especializado, el \u00e1rea central habilita pesta\u00f1as superiores con herramientas espec\u00edficas:\n    - **Pesta\u00f1a \"Cronolog\u00eda\"**: Cargar\u00e1 el interfaz del M\u00f3dulo Cronol\u00f3gico Interconectado (para entidades tipo L\u00ednea de Tiempo).\n    - **Pesta\u00f1a \"Cartograf\u00eda\"**: Cargar\u00e1 el Editor de Mapas y Herramientas de Dibujo (para para entidades tipo Zona/Mapa).\n    - **Pesta\u00f1a \"Taller Ling\u00fc\u00edstico\"**: Cargar\u00e1 las herramientas de Conlangs (L\u00e9xico, Gram\u00e1tica, Editor de Glifos) para entidades tipo Lenguaje.\n- **Coherencia**: Siempre se puede volver a la pesta\u00f1a **\"Atributos\"** para modificar la ficha base. El dise\u00f1o mantiene el Glassmorphism con pesta\u00f1as resaltadas en Indigo-500.\n\n## 4. Unificaci\u00f3n del Espacio de Trabajo\n\nEl nuevo paradigma unifica todas las pantallas clave bajo la estructura de tres paneles:\n- **Explorador (Biblia)** a la izquierda.\n- **Lienzo de Trabajo (Vistas Centrales)**:\n    - **Ficha de Entidad**: Visualizaci\u00f3n y edici\u00f3n de atributos y contenido anidado.\n    - **Editor Gr\u00e1fico Vers\u00e1til**: Lienzo vectorial para s\u00edmbolos y logogramas.\n    - **Gesti\u00f3n de Territorios**: Listado y gesti\u00f3n geopol\u00edtica de biomas y asentamientos.\n    - **Mapa Interactivo**: Navegaci\u00f3n y colocaci\u00f3n de pines sobre el atlas.\n    - **Visualizaci\u00f3n de Grafo**: Lienzo din\u00e1mico de relaciones entre entidades.\n- **Contexto (Escritura/Atributos)** a la derecha.\n\n---\n\n### 5. Pantalla de Bienvenida a Nuevo Cuaderno\n- **Prop\u00f3sito**: Guiar al usuario en la configuraci\u00f3n inicial y ofrecer acceso r\u00e1pido a acciones clave.\n- **Dise\u00f1o**:\n    - **Central/Horizontal**: T\u00edtulo de bienvenida, mensajes motivadores y tarjetas de acci\u00f3n destacadas (\"A\u00f1adir Primera Entidad\", \"Crear Primer Mapa\", \"Empezar a Escribir\", \"Ver Ideas R\u00e1pidas\").\n    - **Visualizaci\u00f3n**: Ocupa el \u00e1rea central manteniendo visibles los paneles laterales y la navegaci\u00f3n superior. Estilo Glassmorphism Oscuro.\n\n### 6. Creaci\u00f3n y Edici\u00f3n de Mapas (Implementado)\n- **Editor de Mapas (`MapEditor.jsx`)**:\n    - **Panel Derecho Global**: Integrado con dise\u00f1o de Acorde\u00f3n de 3 secciones:\n        1.  **Identidad**: Nombre, Tipo (Regional, Mundo, etc.).\n        2.  **Sistema de Rejilla**: Toggle On/Off y Slider de tama\u00f1o (px).\n        3.  **Lienzo**: Dimensiones (Ancho/Alto) y Subida de Imagen de Fondo.\n    - **Sincronizaci\u00f3n**: Los cambios en el panel derecho se reflejan instant\u00e1neamente en el lienzo central.\n    - **Flujo de Guardado**: Al guardar cambios, el sistema redirige autom\u00e1ticamente a la carpeta contenedora para facilitar el flujo de trabajo.\n\n---\n\n### Flujo de Ejemplo:\n1. El usuario crea una carpeta \"Cronolog\u00edas Importantes\".\n2. Define como atributo por defecto de la carpeta el selector \"Tipo de Era\".\n3. Crea la entidad \"La Ca\u00edda del Imperio de Eldoria\" de tipo **L\u00ednea de Tiempo**.\n4. Al guardar, el \u00e1rea central habilita la pesta\u00f1a **\"Cronolog\u00eda\"**.\n5. Al cambiar a ella, el usuario empieza a a\u00f1adir eventos hist\u00f3ricos directamente sobre la ficha de la entidad.\n\nEste redise\u00f1o garantiza una flexibilidad total, permitiendo que cada autor estructure su mundo exactamente como su narrativa lo requiera.\n", "Guia_Pruebas_IA.md": "# Gu\u00eda de Pruebas para Agentes de IA (Worldbuilding App)\n\nEsta gu\u00eda est\u00e1 dise\u00f1ada para que un modelo de IA pueda navegar, probar y entender la estructura actual de la aplicaci\u00f3n **Chronos Atlas**.\n\n## URL Base\n- **Frontend**: `http://localhost:5173`\n- **Backend**: `http://localhost:8080` (API REST)\n\n## 1. Navegaci\u00f3n Principal\nLa aplicaci\u00f3n utiliza un layout principal (`ArchitectLayout`) con una barra lateral izquierda colapsable.\n\n- **Rutas Clave**:\n    - `/` o `/:user/:project`: Dashboard Principal.\n    - `.../bible`: **Biblia del Mundo** (Gestor de Carpetas y Entidades).\n    - `.../map`: **Atlas** (Visor de Mapas - *En desarrollo*).\n    - `.../map-editor/edit/:id`: **Editor de Mapas** (Pantalla completa).\n\n## 2. Flujo de Trabajo: Biblia del Mundo (`/bible`)\nEste es el n\u00facleo de la organizaci\u00f3n.\n\n1.  **Crear Carpeta**:\n    - En la ra\u00edz o dentro de otra carpeta, usa el bot\u00f3n \"Nueva Carpeta\" o Clic Derecho -> \"Nueva Carpeta\".\n    - Esto organiza tu lore jer\u00e1rquicamente.\n2.  **Men\u00fa Contextual (Clic Derecho)**:\n    - Sobre una Carpeta: `Nueva Entidad`, `Nuevo Mapa`, `Nueva Timeline`, `Renombrar`, `Eliminar`.\n    - Sobre un Archivo: `Renombrar`, `Eliminar`.\n\n## 3. Flujo de Trabajo: Creaci\u00f3n y Edici\u00f3n de Mapas\nEl sistema de mapas es una caracter\u00edstica destacada y compleja.\n\n### A. Crear un Mapa\n1.  Navega a una carpeta en la `/bible`.\n2.  Haz **Clic Derecho** en la carpeta -> Selecciona **\"Nuevo Mapa\"**.\n3.  **Wizard de Creaci\u00f3n**:\n    - Se abrir\u00e1 una pantalla de configuraci\u00f3n por pasos.\n    - Completa Nombre, Descripci\u00f3n, Tipo (Mundo/Regional) y selecciona una fuente (Imagen o Blanco).\n    - Clic en \"Create Map\".\n\n### B. Editor de Mapas (`MapEditor`)\nTras crear, ser\u00e1s redirigido al editor.\n- **Panel Central (Lienzo)**: Muestra el mapa/imagen y la rejilla.\n- **Panel Derecho (Ajustes)**:\n    - **Identidad**: Cambia el nombre o tipo.\n    - **Grid System**: Activa/Desactiva la rejilla y ajusta su tama\u00f1o con el slider.\n    - **Canvas**: Ajusta las dimensiones (WxH) o sube una nueva imagen de fondo.\n    *Nota: Este panel usa un dise\u00f1o de Acorde\u00f3n.*\n- **Guardado**:\n    - Bot\u00f3n \"Save Changes\" (arriba derecha).\n    - **Importante**: Al guardar, el sistema te redirigir\u00e1 autom\u00e1ticamente a la carpeta de la Biblia donde est\u00e1 el mapa.\n\n## 4. Estructura T\u00e9cnica Relevante\n- **Backend (Spring Boot)**:\n    - Entidades se guardan en `EntidadGenerica`.\n    - Mapas son entidades con `tipoEspecial = 'map'`.\n    - Los datos del mapa (grid, imagen, capas) se serializan en JSON dentro del campo `descripcion`.\n- **Frontend (React/Vite)**:\n    - `MapEditor.jsx`: Componente monol\u00edtico para la edici\u00f3n. Usa `useOutletContext` para comunicarse con el `ArchitectLayout` (Panel Derecho).\n\n## 5. Pruebas Recomendadas\nSi eres una IA probando la app, intenta:\n1.  Crear una estructura de carpetas anidada (ej. `Reino -> Capital -> Castillo`).\n2.  Crear un Mapa dentro de \"Castillo\".\n3.  En el editor, sube una imagen de prueba y ajusta la rejilla para que coincida con la escala de la imagen.\n4.  Guarda y verifica que vuelves a la carpeta \"Castillo\".\n5.  Vuelve a entrar al mapa y confirma que la rejilla y la imagen se mantienen.\n", "log_prompts.md": "# Bit\u00c3\u00a1cora de Desarrollo (Log Prompts)\n\n---\n\n### Prompt ID: 22 (Redise\u00c3\u00b1o \"Chronos Atlas Next\")\n**Prompt:** \"LAS FUNCIONALIDADES (capturas que te pase) sobreescribelas en ese archivo funcionalidades.md. Con esto YA\"\n**Resultados:**\n- [DOCS] Transcripci\u00c3\u00b3n total de 10 im\u00c3\u00a1genes detallando el nuevo paradigma modular.\n- [PLAN] Creaci\u00c3\u00b3n del plan de implementaci\u00c3\u00b3n para el esquema din\u00c3\u00a1mico (Folders/Templates).\n- [ARCH] Reestructuraci\u00c3\u00b3n visual hacia 3 paneles + Bottom Dock.\n\n\n---\n\n### Prompt ID: 0 (Setup Inicial)\n> Analizame la app WorldbuildingApp y todas sus versiones... serverless pero con funcionamiento en el explorador...\n**Resultados:**\n*   [AN\u00c3\u0083\u00ef\u00bf\u00bdLISIS] Determinada estructura (v1/v2 Java, v3 Next.js).\n*   [ESTRATEGIA] Migraci\u00c3\u0083\u00c2\u00b3n exitosa a Java Spring Boot + H2 (standalone).\n\n---\n\n### Prompt ID: 3 (Estructura de Cuadernos)\n> ...cuaderno/libro... plantillas/hojas... numerando las hojas...\n*   [BUG FIX] Corregido error en `DynamicDataSourceConfig`: el inicializador SQL ignoraba bloques que empezaban con comentarios, omitiendo la creaci\u00c3\u0083\u00c2\u00b3n de tablas.\n*   [COMPATIBILIDAD] Cambiado `MEDIUMTEXT` por `CLOB` en todas las entidades para asegurar compatibilidad total con H2.\n*   [VERIFICACI\u00c3\u0083\u00e2\u0080\u009cN] Verificado flujo completo en un nuevo proyecto \"Mundo_Arreglado\".\n\n\n### Prompt ID: 6 (Navegaci\u00c3\u0083\u00c2\u00b3n y Arquitectura)\n> Elimina la sidebar, pon un men\u00c3\u0083\u00c2\u00ba radial arriba y prepara el backend para multi-usuario...\n**Resultados:**\n*   [UX] Implementado men\u00c3\u0083\u00c2\u00ba radial Top-Center (Glassmorphism). Refactorizados todos los HTMLs.\n*   [BACKEND] Creada entidad Usuario y repositorio JPA. Configurado redirecci\u00c3\u0083\u00c2\u00b3n a Login.\n\n---\n\n### Prompt ID: 7 (Migraci\u00c3\u00b3n a SQLite)\n> Migrate to SQLite Database\n**Resultados:**\n*   [DATABASE] Migraci\u00c3\u00b3n completa de H2 a SQLite (data/worldbuilding.db).\n*   [CLEANUP] Eliminado c\u00c3\u00b3digo legacy H2 (DynamicDataSourceConfig, H2Functions).\n*   [REFACTOR] Reescritura de ProyectoController y BDController para JPA est\u00c3\u00a1ndar.\n\n### Prompt ID: 8 (Multi-tenancy & Real Login)\n> Aislamiento de datos por usuario y registro funcional.\n**Resultados:**\n*   [SECURITY] Implementado `ProjectSessionInterceptor` para proteger APIs.\n*   [AUTH] Completado `AuthController` con registro, login y logout real.\n*   [DATA] Modificados modelos (`Proyecto`) y repositorios para filtrar por `Usuario`.\n*   [FIX] Resuelto conflicto de puerto 8080.\n\n---\n\n### Prompt ID: 9 (Refinamiento UI & Librer\u00c3\u00ada)\n> Refinamiento est\u00c3\u00a9tico, Biblia de Entidades y M\u00c3\u00b3dulo de Librer\u00c3\u00ada.\n**Resultados:**\n*   [UX] Men\u00c3\u00ba Radial optimizado (m\u00c3\u00a1s amplio) y Perfil unificado (Dashboard style).\n*   [BIBLIA] Redise\u00c3\u00b1o total con filtros superiores, conteo din\u00c3\u00a1mico en tiempo real y nuevos tipos (Magia, Zonas, Efectos).\n*   [DASHBOARD] A\u00c3\u00b1adidos campos de g\u00c3\u00a9nero, tipo e imagen al crear proyectos.\n*   [LIBRER\u00c3\u008dA] Creado m\u00c3\u00b3dulo de gesti\u00c3\u00b3n de hojas (`libreria.html`) con navegaci\u00c3\u00b3n avanzada.\n\n### Prompt ID: 10 (Taller de Conlangs)\n> Implementaci\u00c3\u00b3n del Taller de Conlangs con NLP, Vectorizaci\u00c3\u00b3n y FontForge.\n**Resultados:**\n*   [BACKEND] Integraci\u00c3\u00b3n de CoreNLP y JWI (WordNet) para sem\u00c3\u00a1ntica.\n*   [GRAPHICS] Implementado `VectorizationUtils` (Raster -> SVG) y script Python para FontForge (SVG -> TTF).\n*   [FRONTEND] Nuevo m\u00c3\u00b3dulo `conlangs.html` con Canvas de dibujo Vanilla JS.\n*   [DATA] Nuevas entidades `MorphRule` y extensi\u00c3\u00b3n de `Palabra` con datos vectoriales.\n\n---\n\n### Prompt ID: 11 (Standardizaci\u00c3\u00b3n UI Escritura)\n> siempre que puedas debes poner unidades relativas\n> arregla el menu selector de paginas en la hoja de una escritura (no se ha arreglado)\n> en vez de intentar arreglarlo, copia el mismo codigo que en el resto de paginas\n\n**Resultados:**\n*   [REFACTOR] Reemplazada cabecera \"Premium\" personalizada por el est\u00c3\u00a1ndar de dise\u00c3\u00b1o de `libreria.html`.\n*   [UX] Eliminado selector de p\u00c3\u00a1ginas complejo; implementada navegaci\u00c3\u00b3n lineal (Anterior/Siguiente) y breadcrumbs est\u00c3\u00a1ndar.\n*   [CSS] Refactorizaci\u00c3\u00b3n completa a unidades relativas (`rem`) en m\u00c3\u00b3dulos de escritura.\n*   [FIX] Ajustado margen superior (`mt-24`) en cabecera de escritura para evitar solapamiento con men\u00c3\u00ba radial.\n*   [UX] Corregido toggle de barra lateral de notas y eliminado bot\u00c3\u00b3n de cierre redundante.\n\n### Prompt ID: 12 (Redise\u00c3\u00b1o Escritura & Sidebar)\n> Refactoriza la interfaz de escritura para tener una lista de hojas lateral persistente, contadores de notas y navegaci\u00c3\u00b3n directa. arregla bugs de carga y borrado.\n\n**Resultados:**\n*   [UI] Implementada **Sidebar Lateral** en `escritura.html` para navegaci\u00c3\u00b3n r\u00c3\u00a1pida entre hojas.\n*   [BACKEND] A\u00c3\u00b1adido conteo eficiente de notas (`countByHoja`) en `NotaRapidaRepository`.\n*   [UX] **Contadores de Notas** visuales (badges) en la lista de hojas.\n*   [FLOW] Navegaci\u00c3\u00b3n directa desde Librer\u00c3\u00ada al Editor (saltando vista intermedia).\n*   [FIX] Resuelto bug cr\u00c3\u00adtico de \"estados zombie\" al borrar hojas y recarga de notas al cambiar de p\u00c3\u00a1gina.\n\n### Prompt ID: 13 (Restructuraci\u00c3\u00b3n Frontend & React)\n> Restructure and Debug Frontend (Blank Screen)\n**Resultados:**\n*   [ARCH] Reestructuraci\u00c3\u00b3n completa del proyecto: frontend movido a `src/main/frontend`, compilaci\u00c3\u00b3n a `src/main/resources/static`.\n*   [REACT] Implementaci\u00c3\u00b3n base de SPA con React + Tailwind + Vite.\n*   [FIX] Resuelto bug de \"Pantalla Negra\" (ReferenceError en montaje de React).\n*   [DESIGN] Integraci\u00c3\u00b3n inicial del tema \"Arcane Void\".\n\n### Prompt ID: 15 (Calibraci\u00c3\u00b3n UI Arcane Void)\n> UI Overhaul and Calibration to match prototypes.\n**Resultados:**\n*   [ARCH] Implementado `ArchitectLayout.jsx` con sidebars duales (Bible & Canvas) y modo Focus.\n*   [UI] Redise\u00c3\u00b1adas `ProjectView.jsx` (Welcome screen) y `Dashboard.jsx` (Sidebar hidden) seg\u00c3\u00ban im\u00c3\u00a1genes 1 y 6.\n*   [FEAT] Creados m\u00c3\u00b3dulos `EntityProfile.jsx`, `CharacterEditor.jsx` y `Settings.jsx` (Im\u00c3\u00a1genes 3, 4, 5).\n*   [FIX] Corregidas rutas de importaci\u00c3\u00b3n relativas post-migraci\u00c3\u00b3n.\n*   [VERIF] Verificaci\u00c3\u00b3n exitosa de renderizado y est\u00c3\u00a9tica \"Arcane Void\" v\u00c3\u00ada subagente.\n\n### Prompt ID: 16 (Correcci\u00c3\u00b3n Error Sintaxis CharacterView)\n> Fix syntax error 'expected catch or finally' in CharacterView.jsx from user report.\n**Resultados:**\n*   [FIX] Eliminado bloque `try` hu\u00c3\u00a9rfano y c\u00c3\u00b3digo duplicado en `CharacterView.jsx` que causaba crash.\n\n### Prompt ID: 23 (Debug 500 & Logs Cleanup)\n> Continue (Debugging SESSION)\n**Resultados:**\n*   [FIX] Resuelto error cr\u00edtico 500 'no such table' mediante ruta absoluta JDBC y desactivaci\u00f3n de DDL-Auto.\n*   [INFRA] Implementado GlobalExceptionHandler para trazas completas.\n*   [CLEANUP] Logs (\backend.log, \trace.txt, etc) movidos a carpeta /Data para limpieza del root.\n\n### Prompt ID: 16 (CRUD & UI Improvements)\n- **Features**: Implementaci\u00c3n de CRUD de carpetas en World Bible, nuevo sistema de Notas con vista pantalla completa, Selector de Mapas y Editor de Mapas funcional (Canvas).\n- **Fixes**: Resuelto error 500 en el arranque (SQLDelete), arreglado redireccionamiento de logout en Settings.\n- **Impact**: Mejora significativa en la UX de cartograf\u00c3a y gesti\u00c3n de informaci\u00c3n.\n\n## Sesi\u00c3\u0083n 2026-01-07: Resoluci\u00c3\u0083n de Estabilidad y UI\n- [x] Correcci\u00c3\u0083n de persistencia DB (SQLite Master persistente).\n- [x] Inicializaci\u00c3\u0083n robusta de esquemas (CREATE TABLE IF NOT EXISTS).\n- [x] Resoluci\u00c3\u0083n de errores 401 (PermitAll + Session activation temprana).\n- [x] Fix de bot\u00c3\u0083n 'Guardar' desaparecido (Redise\u00c3\u0083o de Header y Stacking Context).\n\n", "manifiesto.md": "# Manifiesto del Proyecto: Chronos Atlas (WorldbuildingApp)\n\n## 1. Visi\u00f3n y Prop\u00f3sito\n**Chronos Atlas \"Next\"** es un entorno modular de construcci\u00f3n de mundos profesional. Abandonamos las categor\u00edas r\u00edgidas por un sistema de **Bible Bible Din\u00e1mica** basada en carpetas y un **Entity Builder Universal** que permite a los autores definir cada detalle de su mundo con flexibilidad total.\n\n---\n\n## 2. Estrategia T\u00e9cnica\n*   **Core:** Java Spring Boot (v2 Refactor).\n*   **Frontend:** HTML5, CSS3 (Vanilla + Tailwind CSS), JavaScript. Est\u00e9tica **Dark Glassmorphism**.\n*   **Base de Datos:** SQLite local. Portabilidad total mediante archivo `.db`.\n*   **Arquitectura:** Modular y desacoplada, preparada para expansi\u00f3n a sincronizaci\u00f3n en la nube (PostgreSQL/Supabase).\n\n---\n\n## 3. Sistema de Dise\u00f1o (UI Kit: \"Arcane Void\")\nEl dise\u00f1o busca un equilibrio entre la claridad de un IDE moderno y la m\u00edstica de un antiguo estudio de alquimia.\n\n*   **Paleta de Colores:**\n    - **Void Dark:** `#09090b` (Fondo profundo).\n    - **Glass Border:** `rgba(255, 255, 255, 0.05)`.\n    - **Accent Indigo:** `#6366f1` (Primario).\n    - **Accent Emerald:** `#10b981` (Secundario).\n    - **Parchment White:** `#fafafa` (Texto).\n*   **Tipograf\u00eda:**\n    *   **UI/Sistemas:** `Outfit` / `Inter` (Sans-serif limpia).\n    *   **Lectura/Escritura:** `Cormorant Garamond` / `Playfair Display` (Serif elegante para inmersi\u00f3n profunda).\n\n---\n\n## 4. Mapa de Funcionalidades (Roadmap & Status)\n\n### A. Entorno Modular [EN REDISE\u00d1O]\n*   **3-Panel Layout**: Explorador jer\u00e1rquico, Lienzo Central y Caja de Atributos.\n*   **Navigation Dock**: Barra flotante inferior con desenfoque.\n\n### B. Biblia del Mundo Din\u00e1mica [EN PLANIFICACI\u00d3N]\n*   **Carpetas Hier\u00e1rquicas**: Organizaci\u00f3n libre de lore.\n*   **Attribute Inheritance**: Las carpetas definen la estructura de las entidades hijas.\n\n### C. Entity Builder [EN PLANIFICACI\u00d3N]\n*   **Drag & Drop**: Construcci\u00f3n de fichas mediante bloques de atributos.\n*   **Pesta\u00f1as Contextuales**: Mapas y Cronolog\u00edas integradas directamente en las fichas.\n\n---\n\n## 5. Filosof\u00eda de Desarrollo\n1.  **Cero Distracci\u00f3n:** El autor no debe abandonar el teclado. Los comandos y atajos de teclado son prioridad.\n2.  **Contexto es Rey:** La informaci\u00f3n del mundo debe fluir hacia el texto, no al rev\u00e9s.\n3.  **Local-First:** Tus datos son tuyos. La sincronizaci\u00f3n es una opci\u00f3n, no un requisito.\n\n## Estado Actual (2026-01-07)\n- [x] **Fase de Estabilidad Core**: Completada. Persistencia de datos asegurada y esquema multi-tenant funcional.\n- [x] **Seguridad**: Configurada para desarrollo fluido (PermitAll) sin comprometer la activaci\u00c3n de sesiones de proyecto.\n- [x] **UI/UX Biblia**: Entity Builder optimizado con controles en cabecera y visualizaci\u00c3n corregida.\n\n", "Tareas_Pendientes_IA.md": "# Tareas Pendientes y Roadmap (Gu\u00eda para IA)\n\nEste documento resume el estado actual del proyecto y las tareas cr\u00edticas que deben abordarse en las pr\u00f3ximas sesiones de desarrollo.\n\n## Estado Actual\n- **Editor de Mapas**: Funcional en estructura (Panel Derecho de Ajustes, Guardado) pero falta la interactividad real del Canvas.\n- **Biblia**: Navegaci\u00f3n por carpetas funcional, creaci\u00f3n de entidades y mapas operativa.\n- **Interfaz**: Migrada a un dise\u00f1o de 3 paneles (Explorer, Canvas, Contexto).\n\n## 1. Prioridad Alta: Editor de Mapas\nEl esqueleto est\u00e1 listo, pero falta el motor gr\u00e1fico.\n- [ ] **Re-integrar Konva/Canvas**:\n    - Actualmente `MapEditor.jsx` usa un `CanvasPlaceholder`.\n    - Hay que descomentar y adaptar la l\u00f3gica de `react-konva` (Stage, Layers, Transformers) que est\u00e1 comentada o fue simplificada.\n    - Sincronizar el Canvas real con el `gridSize` y `bgImage` del panel derecho.\n- [ ] **Herramientas de Dibujo**:\n    - Implementar l\u00f3gica para las herramientas de la barra izquierda (Pincel, Figuras, Texto).\n    - Conectar estas herramientas con el estado de Konva.\n\n## 2. Refactorizaci\u00f3n del Constructor de Entidades (`EntityBuilder`)\nEl constructor actual es funcional pero necesita alinearse con el nuevo dise\u00f1o de \"Panel Derecho Global\".\n    - [x] Migrar Tabs al Panel Derecho (Completado).\n- [ ] **Mejoras en Identidad**:\n    - A\u00f1adir campo \"Apariencia\" (Texto rico o imagen).\n    - Permitir subir icono personalizado (Local Image) para la entidad.\n\n## 3. Mejoras de \"Calidad de Vida\" (UX)\n- [ ] **Renombrar en Sidebar**: A\u00f1adir opci\u00f3n \"Rename\" al men\u00fa contextual del \u00e1rbol lateral.\n- [ ] **Breadcrumbs**: Implementar migas de pan en la vista de carpetas para mejorar la navegaci\u00f3n profunda.\n- [ ] **Favoritos**: Secci\u00f3n en el sidebar para acceso r\u00e1pido a entidades frecuentes.\n\n## Notas T\u00e9cnicas\n- **Persistencia**: Recuerda que `EntidadGenerica` usa un campo `descripcion` (String/JSON) para guardar datos complejos. Para los mapas, esto incluye capas, im\u00e1genes en base64 (o URLs) y metadatos.\n- **Contexto Global**: `ArchitectLayout` usa `useOutletContext` para pasar estados del Panel Derecho (`rightPanelMode`, `setMapSettings`, etc.) a las p\u00e1ginas hijas. Todo nuevo editor debe engancharse a este contexto.\n\n## 4. Refactorizaci\u00f3n T\u00e9cnica y Backend (Desde TODOs)\nTareas extra\u00eddas de `WorldBibleController.java`:\n- [ ] **Refactorizaci\u00f3n Flujo de Creaci\u00f3n (Sin Prompts)**: Eliminar el uso de `window.prompt` y usar modales/wizards integrados.\n- [ ] **Restaurar Explorador Lateral**: Limpiar el sidebar para mostrar solo estructura de carpetas relevante.\n- [ ] **Rutas de Creaci\u00f3n Directa**: Implementar rutas como `/new/:type` para acceso r\u00e1pido.\n- [ ] **Guardado Diferido (Post-draft)**: Permitir crear entidades en memoria y solo persistir al guardar (evitar basura en DB).\n- [ ] **Herencia de Plantillas en Borrador**: Que los nuevos borradores hereden plantillas din\u00e1micamente antes de guardarse.\n"};
        const sidebarNav = document.getElementById('sidebarNav');
        const markdownBody = document.getElementById('markdownBody');
        const mainTitle = document.getElementById('mainTitle');
        const searchInput = document.getElementById('searchInput');

        function renderFile(name) {
            const content = docs[name];
            mainTitle.innerText = name.replace('.md', '').replaceAll('_', ' ');
            
            markdownBody.innerHTML = marked.parse(content);

            document.querySelectorAll('.nav-link').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.name === name);
            });
            
            window.scrollTo(0, 0);
        }

        function init() {
            const files = Object.keys(docs).sort();
            
            files.forEach(name => {
                const a = document.createElement('a');
                a.className = 'nav-link';
                a.href = '#';
                a.dataset.name = name;
                a.innerText = name.replace('.md', '').replaceAll('_', ' ');
                a.onclick = (e) => {
                    e.preventDefault();
                    renderFile(name);
                };
                sidebarNav.appendChild(a);
            });

            if (files.length > 0) {
                const priority = files.find(f => f.includes('manifiesto')) || files.find(f => f.includes('log_prompts')) || files[0];
                renderFile(priority);
            }
            
            searchInput.oninput = (e) => {
                const term = e.target.value.toLowerCase();
                document.querySelectorAll('.nav-link').forEach(link => {
                    const text = link.innerText.toLowerCase();
                    link.style.display = text.includes(term) ? 'block' : 'none';
                });
            };
        }

        init();
    </script>
</body>
</html>

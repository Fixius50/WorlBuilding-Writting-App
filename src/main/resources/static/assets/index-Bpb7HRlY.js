function nR(r,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in r)){const s=Object.getOwnPropertyDescriptor(i,a);s&&Object.defineProperty(r,a,s.get?s:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();var Pk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Kh(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var k1={exports:{}},tm={},C1={exports:{}},hr={};var Mk;function iR(){if(Mk)return hr;Mk=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function v(W){return W===null||typeof W!="object"?null:(W=p&&W[p]||W["@@iterator"],typeof W=="function"?W:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,S={};function k(W,re,ae){this.props=W,this.context=re,this.refs=S,this.updater=ae||y}k.prototype.isReactComponent={},k.prototype.setState=function(W,re){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,re,"setState")},k.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function T(){}T.prototype=k.prototype;function C(W,re,ae){this.props=W,this.context=re,this.refs=S,this.updater=ae||y}var N=C.prototype=new T;N.constructor=C,b(N,k.prototype),N.isPureReactComponent=!0;var P=Array.isArray,R=Object.prototype.hasOwnProperty,O={current:null},B={key:!0,ref:!0,__self:!0,__source:!0};function I(W,re,ae){var he,ve={},xe=null,se=null;if(re!=null)for(he in re.ref!==void 0&&(se=re.ref),re.key!==void 0&&(xe=""+re.key),re)R.call(re,he)&&!B.hasOwnProperty(he)&&(ve[he]=re[he]);var ge=arguments.length-2;if(ge===1)ve.children=ae;else if(1<ge){for(var le=Array(ge),pe=0;pe<ge;pe++)le[pe]=arguments[pe+2];ve.children=le}if(W&&W.defaultProps)for(he in ge=W.defaultProps,ge)ve[he]===void 0&&(ve[he]=ge[he]);return{$$typeof:r,type:W,key:xe,ref:se,props:ve,_owner:O.current}}function z(W,re){return{$$typeof:r,type:W.type,key:re,ref:W.ref,props:W.props,_owner:W._owner}}function V(W){return typeof W=="object"&&W!==null&&W.$$typeof===r}function $(W){var re={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ae){return re[ae]})}var Y=/\/+/g;function D(W,re){return typeof W=="object"&&W!==null&&W.key!=null?$(""+W.key):re.toString(36)}function q(W,re,ae,he,ve){var xe=typeof W;(xe==="undefined"||xe==="boolean")&&(W=null);var se=!1;if(W===null)se=!0;else switch(xe){case"string":case"number":se=!0;break;case"object":switch(W.$$typeof){case r:case e:se=!0}}if(se)return se=W,ve=ve(se),W=he===""?"."+D(se,0):he,P(ve)?(ae="",W!=null&&(ae=W.replace(Y,"$&/")+"/"),q(ve,re,ae,"",function(pe){return pe})):ve!=null&&(V(ve)&&(ve=z(ve,ae+(!ve.key||se&&se.key===ve.key?"":(""+ve.key).replace(Y,"$&/")+"/")+W)),re.push(ve)),1;if(se=0,he=he===""?".":he+":",P(W))for(var ge=0;ge<W.length;ge++){xe=W[ge];var le=he+D(xe,ge);se+=q(xe,re,ae,le,ve)}else if(le=v(W),typeof le=="function")for(W=le.call(W),ge=0;!(xe=W.next()).done;)xe=xe.value,le=he+D(xe,ge++),se+=q(xe,re,ae,le,ve);else if(xe==="object")throw re=String(W),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.");return se}function G(W,re,ae){if(W==null)return W;var he=[],ve=0;return q(W,he,"","",function(xe){return re.call(ae,xe,ve++)}),he}function Z(W){if(W._status===-1){var re=W._result;re=re(),re.then(function(ae){(W._status===0||W._status===-1)&&(W._status=1,W._result=ae)},function(ae){(W._status===0||W._status===-1)&&(W._status=2,W._result=ae)}),W._status===-1&&(W._status=0,W._result=re)}if(W._status===1)return W._result.default;throw W._result}var Q={current:null},J={transition:null},ie={ReactCurrentDispatcher:Q,ReactCurrentBatchConfig:J,ReactCurrentOwner:O};function ne(){throw Error("act(...) is not supported in production builds of React.")}return hr.Children={map:G,forEach:function(W,re,ae){G(W,function(){re.apply(this,arguments)},ae)},count:function(W){var re=0;return G(W,function(){re++}),re},toArray:function(W){return G(W,function(re){return re})||[]},only:function(W){if(!V(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},hr.Component=k,hr.Fragment=n,hr.Profiler=a,hr.PureComponent=C,hr.StrictMode=i,hr.Suspense=u,hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ie,hr.act=ne,hr.cloneElement=function(W,re,ae){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var he=b({},W.props),ve=W.key,xe=W.ref,se=W._owner;if(re!=null){if(re.ref!==void 0&&(xe=re.ref,se=O.current),re.key!==void 0&&(ve=""+re.key),W.type&&W.type.defaultProps)var ge=W.type.defaultProps;for(le in re)R.call(re,le)&&!B.hasOwnProperty(le)&&(he[le]=re[le]===void 0&&ge!==void 0?ge[le]:re[le])}var le=arguments.length-2;if(le===1)he.children=ae;else if(1<le){ge=Array(le);for(var pe=0;pe<le;pe++)ge[pe]=arguments[pe+2];he.children=ge}return{$$typeof:r,type:W.type,key:ve,ref:xe,props:he,_owner:se}},hr.createContext=function(W){return W={$$typeof:o,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:s,_context:W},W.Consumer=W},hr.createElement=I,hr.createFactory=function(W){var re=I.bind(null,W);return re.type=W,re},hr.createRef=function(){return{current:null}},hr.forwardRef=function(W){return{$$typeof:l,render:W}},hr.isValidElement=V,hr.lazy=function(W){return{$$typeof:d,_payload:{_status:-1,_result:W},_init:Z}},hr.memo=function(W,re){return{$$typeof:c,type:W,compare:re===void 0?null:re}},hr.startTransition=function(W){var re=J.transition;J.transition={};try{W()}finally{J.transition=re}},hr.unstable_act=ne,hr.useCallback=function(W,re){return Q.current.useCallback(W,re)},hr.useContext=function(W){return Q.current.useContext(W)},hr.useDebugValue=function(){},hr.useDeferredValue=function(W){return Q.current.useDeferredValue(W)},hr.useEffect=function(W,re){return Q.current.useEffect(W,re)},hr.useId=function(){return Q.current.useId()},hr.useImperativeHandle=function(W,re,ae){return Q.current.useImperativeHandle(W,re,ae)},hr.useInsertionEffect=function(W,re){return Q.current.useInsertionEffect(W,re)},hr.useLayoutEffect=function(W,re){return Q.current.useLayoutEffect(W,re)},hr.useMemo=function(W,re){return Q.current.useMemo(W,re)},hr.useReducer=function(W,re,ae){return Q.current.useReducer(W,re,ae)},hr.useRef=function(W){return Q.current.useRef(W)},hr.useState=function(W){return Q.current.useState(W)},hr.useSyncExternalStore=function(W,re,ae){return Q.current.useSyncExternalStore(W,re,ae)},hr.useTransition=function(){return Q.current.useTransition()},hr.version="18.3.1",hr}var Ak;function Cp(){return Ak||(Ak=1,C1.exports=iR()),C1.exports}var jk;function aR(){if(jk)return tm;jk=1;var r=Cp(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,c){var d,p={},v=null,y=null;c!==void 0&&(v=""+c),u.key!==void 0&&(v=""+u.key),u.ref!==void 0&&(y=u.ref);for(d in u)i.call(u,d)&&!s.hasOwnProperty(d)&&(p[d]=u[d]);if(l&&l.defaultProps)for(d in u=l.defaultProps,u)p[d]===void 0&&(p[d]=u[d]);return{$$typeof:e,type:l,key:v,ref:y,props:p,_owner:a.current}}return tm.Fragment=n,tm.jsx=o,tm.jsxs=o,tm}var Rk;function sR(){return Rk||(Rk=1,k1.exports=aR()),k1.exports}var m=sR(),ce=Cp();const Xt=Kh(ce),oR=nR({__proto__:null,default:Xt},[ce]);var r0={},E1={exports:{}},Es={},N1={exports:{}},T1={};var Lk;function lR(){return Lk||(Lk=1,(function(r){function e(J,ie){var ne=J.length;J.push(ie);e:for(;0<ne;){var W=ne-1>>>1,re=J[W];if(0<a(re,ie))J[W]=ie,J[ne]=re,ne=W;else break e}}function n(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var ie=J[0],ne=J.pop();if(ne!==ie){J[0]=ne;e:for(var W=0,re=J.length,ae=re>>>1;W<ae;){var he=2*(W+1)-1,ve=J[he],xe=he+1,se=J[xe];if(0>a(ve,ne))xe<re&&0>a(se,ve)?(J[W]=se,J[xe]=ne,W=xe):(J[W]=ve,J[he]=ne,W=he);else if(xe<re&&0>a(se,ne))J[W]=se,J[xe]=ne,W=xe;else break e}}return ie}function a(J,ie){var ne=J.sortIndex-ie.sortIndex;return ne!==0?ne:J.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();r.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,p=null,v=3,y=!1,b=!1,S=!1,k=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(J){for(var ie=n(c);ie!==null;){if(ie.callback===null)i(c);else if(ie.startTime<=J)i(c),ie.sortIndex=ie.expirationTime,e(u,ie);else break;ie=n(c)}}function P(J){if(S=!1,N(J),!b)if(n(u)!==null)b=!0,Z(R);else{var ie=n(c);ie!==null&&Q(P,ie.startTime-J)}}function R(J,ie){b=!1,S&&(S=!1,T(I),I=-1),y=!0;var ne=v;try{for(N(ie),p=n(u);p!==null&&(!(p.expirationTime>ie)||J&&!$());){var W=p.callback;if(typeof W=="function"){p.callback=null,v=p.priorityLevel;var re=W(p.expirationTime<=ie);ie=r.unstable_now(),typeof re=="function"?p.callback=re:p===n(u)&&i(u),N(ie)}else i(u);p=n(u)}if(p!==null)var ae=!0;else{var he=n(c);he!==null&&Q(P,he.startTime-ie),ae=!1}return ae}finally{p=null,v=ne,y=!1}}var O=!1,B=null,I=-1,z=5,V=-1;function $(){return!(r.unstable_now()-V<z)}function Y(){if(B!==null){var J=r.unstable_now();V=J;var ie=!0;try{ie=B(!0,J)}finally{ie?D():(O=!1,B=null)}}else O=!1}var D;if(typeof C=="function")D=function(){C(Y)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,G=q.port2;q.port1.onmessage=Y,D=function(){G.postMessage(null)}}else D=function(){k(Y,0)};function Z(J){B=J,O||(O=!0,D())}function Q(J,ie){I=k(function(){J(r.unstable_now())},ie)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(J){J.callback=null},r.unstable_continueExecution=function(){b||y||(b=!0,Z(R))},r.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<J?Math.floor(1e3/J):5},r.unstable_getCurrentPriorityLevel=function(){return v},r.unstable_getFirstCallbackNode=function(){return n(u)},r.unstable_next=function(J){switch(v){case 1:case 2:case 3:var ie=3;break;default:ie=v}var ne=v;v=ie;try{return J()}finally{v=ne}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(J,ie){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ne=v;v=J;try{return ie()}finally{v=ne}},r.unstable_scheduleCallback=function(J,ie,ne){var W=r.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,J){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=ne+re,J={id:d++,callback:ie,priorityLevel:J,startTime:ne,expirationTime:re,sortIndex:-1},ne>W?(J.sortIndex=ne,e(c,J),n(u)===null&&J===n(c)&&(S?(T(I),I=-1):S=!0,Q(P,ne-W))):(J.sortIndex=re,e(u,J),b||y||(b=!0,Z(R))),J},r.unstable_shouldYield=$,r.unstable_wrapCallback=function(J){var ie=v;return function(){var ne=v;v=ie;try{return J.apply(this,arguments)}finally{v=ne}}}})(T1)),T1}var Ok;function __(){return Ok||(Ok=1,N1.exports=lR()),N1.exports}var Dk;function uR(){if(Dk)return Es;Dk=1;var r=Cp(),e=__();function n(h){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+h,E=1;E<arguments.length;E++)g+="&args[]="+encodeURIComponent(arguments[E]);return"Minified React error #"+h+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,a={};function s(h,g){o(h,g),o(h+"Capture",g)}function o(h,g){for(a[h]=g,h=0;h<g.length;h++)i.add(g[h])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function v(h){return u.call(p,h)?!0:u.call(d,h)?!1:c.test(h)?p[h]=!0:(d[h]=!0,!1)}function y(h,g,E,j){if(E!==null&&E.type===0)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return j?!1:E!==null?!E.acceptsBooleans:(h=h.toLowerCase().slice(0,5),h!=="data-"&&h!=="aria-");default:return!1}}function b(h,g,E,j){if(g===null||typeof g>"u"||y(h,g,E,j))return!0;if(j)return!1;if(E!==null)switch(E.type){case 3:return!g;case 4:return g===!1;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}function S(h,g,E,j,H,X,oe){this.acceptsBooleans=g===2||g===3||g===4,this.attributeName=j,this.attributeNamespace=H,this.mustUseProperty=E,this.propertyName=h,this.type=g,this.sanitizeURL=X,this.removeEmptyString=oe}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(h){k[h]=new S(h,0,!1,h,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(h){var g=h[0];k[g]=new S(g,1,!1,h[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(h){k[h]=new S(h,2,!1,h.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(h){k[h]=new S(h,2,!1,h,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(h){k[h]=new S(h,3,!1,h.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(h){k[h]=new S(h,3,!0,h,null,!1,!1)}),["capture","download"].forEach(function(h){k[h]=new S(h,4,!1,h,null,!1,!1)}),["cols","rows","size","span"].forEach(function(h){k[h]=new S(h,6,!1,h,null,!1,!1)}),["rowSpan","start"].forEach(function(h){k[h]=new S(h,5,!1,h.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function C(h){return h[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(h){var g=h.replace(T,C);k[g]=new S(g,1,!1,h,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(h){var g=h.replace(T,C);k[g]=new S(g,1,!1,h,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(h){var g=h.replace(T,C);k[g]=new S(g,1,!1,h,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(h){k[h]=new S(h,1,!1,h.toLowerCase(),null,!1,!1)}),k.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(h){k[h]=new S(h,1,!1,h.toLowerCase(),null,!0,!0)});function N(h,g,E,j){var H=k.hasOwnProperty(g)?k[g]:null;(H!==null?H.type!==0:j||!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(b(g,E,H,j)&&(E=null),j||H===null?v(g)&&(E===null?h.removeAttribute(g):h.setAttribute(g,""+E)):H.mustUseProperty?h[H.propertyName]=E===null?H.type===3?!1:"":E:(g=H.attributeName,j=H.attributeNamespace,E===null?h.removeAttribute(g):(H=H.type,E=H===3||H===4&&E===!0?"":""+E,j?h.setAttributeNS(j,g,E):h.setAttribute(g,E))))}var P=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),O=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),$=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),Q=Symbol.for("react.offscreen"),J=Symbol.iterator;function ie(h){return h===null||typeof h!="object"?null:(h=J&&h[J]||h["@@iterator"],typeof h=="function"?h:null)}var ne=Object.assign,W;function re(h){if(W===void 0)try{throw Error()}catch(E){var g=E.stack.trim().match(/\n( *(at )?)/);W=g&&g[1]||""}return`
`+W+h}var ae=!1;function he(h,g){if(!h||ae)return"";ae=!0;var E=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(Be){var j=Be}Reflect.construct(h,[],g)}else{try{g.call()}catch(Be){j=Be}h.call(g.prototype)}else{try{throw Error()}catch(Be){j=Be}h()}}catch(Be){if(Be&&j&&typeof Be.stack=="string"){for(var H=Be.stack.split(`
`),X=j.stack.split(`
`),oe=H.length-1,we=X.length-1;1<=oe&&0<=we&&H[oe]!==X[we];)we--;for(;1<=oe&&0<=we;oe--,we--)if(H[oe]!==X[we]){if(oe!==1||we!==1)do if(oe--,we--,0>we||H[oe]!==X[we]){var ke=`
`+H[oe].replace(" at new "," at ");return h.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",h.displayName)),ke}while(1<=oe&&0<=we);break}}}finally{ae=!1,Error.prepareStackTrace=E}return(h=h?h.displayName||h.name:"")?re(h):""}function ve(h){switch(h.tag){case 5:return re(h.type);case 16:return re("Lazy");case 13:return re("Suspense");case 19:return re("SuspenseList");case 0:case 2:case 15:return h=he(h.type,!1),h;case 11:return h=he(h.type.render,!1),h;case 1:return h=he(h.type,!0),h;default:return""}}function xe(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case B:return"Fragment";case O:return"Portal";case z:return"Profiler";case I:return"StrictMode";case D:return"Suspense";case q:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case $:return(h.displayName||"Context")+".Consumer";case V:return(h._context.displayName||"Context")+".Provider";case Y:var g=h.render;return h=h.displayName,h||(h=g.displayName||g.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case G:return g=h.displayName||null,g!==null?g:xe(h.type)||"Memo";case Z:g=h._payload,h=h._init;try{return xe(h(g))}catch{}}return null}function se(h){var g=h.type;switch(h.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=g.render,h=h.displayName||h.name||"",g.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xe(g);case 8:return g===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function ge(h){switch(typeof h){case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function le(h){var g=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function pe(h){var g=le(h)?"checked":"value",E=Object.getOwnPropertyDescriptor(h.constructor.prototype,g),j=""+h[g];if(!h.hasOwnProperty(g)&&typeof E<"u"&&typeof E.get=="function"&&typeof E.set=="function"){var H=E.get,X=E.set;return Object.defineProperty(h,g,{configurable:!0,get:function(){return H.call(this)},set:function(oe){j=""+oe,X.call(this,oe)}}),Object.defineProperty(h,g,{enumerable:E.enumerable}),{getValue:function(){return j},setValue:function(oe){j=""+oe},stopTracking:function(){h._valueTracker=null,delete h[g]}}}}function me(h){h._valueTracker||(h._valueTracker=pe(h))}function be(h){if(!h)return!1;var g=h._valueTracker;if(!g)return!0;var E=g.getValue(),j="";return h&&(j=le(h)?h.checked?"true":"false":h.value),h=j,h!==E?(g.setValue(h),!0):!1}function Se(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}function Ue(h,g){var E=g.checked;return ne({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:E??h._wrapperState.initialChecked})}function We(h,g){var E=g.defaultValue==null?"":g.defaultValue,j=g.checked!=null?g.checked:g.defaultChecked;E=ge(g.value!=null?g.value:E),h._wrapperState={initialChecked:j,initialValue:E,controlled:g.type==="checkbox"||g.type==="radio"?g.checked!=null:g.value!=null}}function gt(h,g){g=g.checked,g!=null&&N(h,"checked",g,!1)}function Je(h,g){gt(h,g);var E=ge(g.value),j=g.type;if(E!=null)j==="number"?(E===0&&h.value===""||h.value!=E)&&(h.value=""+E):h.value!==""+E&&(h.value=""+E);else if(j==="submit"||j==="reset"){h.removeAttribute("value");return}g.hasOwnProperty("value")?Ve(h,g.type,E):g.hasOwnProperty("defaultValue")&&Ve(h,g.type,ge(g.defaultValue)),g.checked==null&&g.defaultChecked!=null&&(h.defaultChecked=!!g.defaultChecked)}function at(h,g,E){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var j=g.type;if(!(j!=="submit"&&j!=="reset"||g.value!==void 0&&g.value!==null))return;g=""+h._wrapperState.initialValue,E||g===h.value||(h.value=g),h.defaultValue=g}E=h.name,E!==""&&(h.name=""),h.defaultChecked=!!h._wrapperState.initialChecked,E!==""&&(h.name=E)}function Ve(h,g,E){(g!=="number"||Se(h.ownerDocument)!==h)&&(E==null?h.defaultValue=""+h._wrapperState.initialValue:h.defaultValue!==""+E&&(h.defaultValue=""+E))}var Oe=Array.isArray;function et(h,g,E,j){if(h=h.options,g){g={};for(var H=0;H<E.length;H++)g["$"+E[H]]=!0;for(E=0;E<h.length;E++)H=g.hasOwnProperty("$"+h[E].value),h[E].selected!==H&&(h[E].selected=H),H&&j&&(h[E].defaultSelected=!0)}else{for(E=""+ge(E),g=null,H=0;H<h.length;H++){if(h[H].value===E){h[H].selected=!0,j&&(h[H].defaultSelected=!0);return}g!==null||h[H].disabled||(g=h[H])}g!==null&&(g.selected=!0)}}function Ne(h,g){if(g.dangerouslySetInnerHTML!=null)throw Error(n(91));return ne({},g,{value:void 0,defaultValue:void 0,children:""+h._wrapperState.initialValue})}function ze(h,g){var E=g.value;if(E==null){if(E=g.children,g=g.defaultValue,E!=null){if(g!=null)throw Error(n(92));if(Oe(E)){if(1<E.length)throw Error(n(93));E=E[0]}g=E}g==null&&(g=""),E=g}h._wrapperState={initialValue:ge(E)}}function Ke(h,g){var E=ge(g.value),j=ge(g.defaultValue);E!=null&&(E=""+E,E!==h.value&&(h.value=E),g.defaultValue==null&&h.defaultValue!==E&&(h.defaultValue=E)),j!=null&&(h.defaultValue=""+j)}function ft(h){var g=h.textContent;g===h._wrapperState.initialValue&&g!==""&&g!==null&&(h.value=g)}function yt(h){switch(h){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Et(h,g){return h==null||h==="http://www.w3.org/1999/xhtml"?yt(g):h==="http://www.w3.org/2000/svg"&&g==="foreignObject"?"http://www.w3.org/1999/xhtml":h}var Rt,$t=(function(h){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(g,E,j,H){MSApp.execUnsafeLocalFunction(function(){return h(g,E,j,H)})}:h})(function(h,g){if(h.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in h)h.innerHTML=g;else{for(Rt=Rt||document.createElement("div"),Rt.innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=Rt.firstChild;h.firstChild;)h.removeChild(h.firstChild);for(;g.firstChild;)h.appendChild(g.firstChild)}});function wt(h,g){if(g){var E=h.firstChild;if(E&&E===h.lastChild&&E.nodeType===3){E.nodeValue=g;return}}h.textContent=g}var ot={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qe=["Webkit","ms","Moz","O"];Object.keys(ot).forEach(function(h){qe.forEach(function(g){g=g+h.charAt(0).toUpperCase()+h.substring(1),ot[g]=ot[h]})});function de(h,g,E){return g==null||typeof g=="boolean"||g===""?"":E||typeof g!="number"||g===0||ot.hasOwnProperty(h)&&ot[h]?(""+g).trim():g+"px"}function ye(h,g){h=h.style;for(var E in g)if(g.hasOwnProperty(E)){var j=E.indexOf("--")===0,H=de(E,g[E],j);E==="float"&&(E="cssFloat"),j?h.setProperty(E,H):h[E]=H}}var Ce=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Te(h,g){if(g){if(Ce[h]&&(g.children!=null||g.dangerouslySetInnerHTML!=null))throw Error(n(137,h));if(g.dangerouslySetInnerHTML!=null){if(g.children!=null)throw Error(n(60));if(typeof g.dangerouslySetInnerHTML!="object"||!("__html"in g.dangerouslySetInnerHTML))throw Error(n(61))}if(g.style!=null&&typeof g.style!="object")throw Error(n(62))}}function Re(h,g){if(h.indexOf("-")===-1)return typeof g.is=="string";switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ze=null;function Ge(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var ct=null,ut=null,kt=null;function zt(h){if(h=Xo(h)){if(typeof ct!="function")throw Error(n(280));var g=h.stateNode;g&&(g=Un(g),ct(h.stateNode,h.type,g))}}function Ft(h){ut?kt?kt.push(h):kt=[h]:ut=h}function xt(){if(ut){var h=ut,g=kt;if(kt=ut=null,zt(h),g)for(h=0;h<g.length;h++)zt(g[h])}}function Gt(h,g){return h(g)}function Wt(){}var kr=!1;function pr(h,g,E){if(kr)return h(g,E);kr=!0;try{return Gt(h,g,E)}finally{kr=!1,(ut!==null||kt!==null)&&(Wt(),xt())}}function pn(h,g){var E=h.stateNode;if(E===null)return null;var j=Un(E);if(j===null)return null;E=j[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(j=!j.disabled)||(h=h.type,j=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!j;break e;default:h=!1}if(h)return null;if(E&&typeof E!="function")throw Error(n(231,g,typeof E));return E}var qr=!1;if(l)try{var Wr={};Object.defineProperty(Wr,"passive",{get:function(){qr=!0}}),window.addEventListener("test",Wr,Wr),window.removeEventListener("test",Wr,Wr)}catch{qr=!1}function an(h,g,E,j,H,X,oe,we,ke){var Be=Array.prototype.slice.call(arguments,3);try{g.apply(E,Be)}catch(Xe){this.onError(Xe)}}var cr=!1,bt=null,Or=!1,Xn=null,Ma={onError:function(h){cr=!0,bt=h}};function Is(h,g,E,j,H,X,oe,we,ke){cr=!1,bt=null,an.apply(Ma,arguments)}function eo(h,g,E,j,H,X,oe,we,ke){if(Is.apply(this,arguments),cr){if(cr){var Be=bt;cr=!1,bt=null}else throw Error(n(198));Or||(Or=!0,Xn=Be)}}function ci(h){var g=h,E=h;if(h.alternate)for(;g.return;)g=g.return;else{h=g;do g=h,(g.flags&4098)!==0&&(E=g.return),h=g.return;while(h)}return g.tag===3?E:null}function sn(h){if(h.tag===13){var g=h.memoizedState;if(g===null&&(h=h.alternate,h!==null&&(g=h.memoizedState)),g!==null)return g.dehydrated}return null}function bn(h){if(ci(h)!==h)throw Error(n(188))}function di(h){var g=h.alternate;if(!g){if(g=ci(h),g===null)throw Error(n(188));return g!==h?null:h}for(var E=h,j=g;;){var H=E.return;if(H===null)break;var X=H.alternate;if(X===null){if(j=H.return,j!==null){E=j;continue}break}if(H.child===X.child){for(X=H.child;X;){if(X===E)return bn(H),h;if(X===j)return bn(H),g;X=X.sibling}throw Error(n(188))}if(E.return!==j.return)E=H,j=X;else{for(var oe=!1,we=H.child;we;){if(we===E){oe=!0,E=H,j=X;break}if(we===j){oe=!0,j=H,E=X;break}we=we.sibling}if(!oe){for(we=X.child;we;){if(we===E){oe=!0,E=X,j=H;break}if(we===j){oe=!0,j=X,E=H;break}we=we.sibling}if(!oe)throw Error(n(189))}}if(E.alternate!==j)throw Error(n(190))}if(E.tag!==3)throw Error(n(188));return E.stateNode.current===E?h:g}function to(h){return h=di(h),h!==null?_i(h):null}function _i(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var g=_i(h);if(g!==null)return g;h=h.sibling}return null}var lu=e.unstable_scheduleCallback,uu=e.unstable_cancelCallback,zd=e.unstable_shouldYield,pl=e.unstable_requestPaint,Qr=e.unstable_now,cu=e.unstable_getCurrentPriorityLevel,Bs=e.unstable_ImmediatePriority,ml=e.unstable_UserBlockingPriority,Aa=e.unstable_NormalPriority,Oo=e.unstable_LowPriority,ra=e.unstable_IdlePriority,na=null,mn=null;function yr(h){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(na,h,void 0,(h.current.flags&128)===128)}catch{}}var lt=Math.clz32?Math.clz32:Fr,dr=Math.log,on=Math.LN2;function Fr(h){return h>>>=0,h===0?32:31-(dr(h)/on|0)|0}var Tr=64,ia=4194304;function Mt(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function xr(h,g){var E=h.pendingLanes;if(E===0)return 0;var j=0,H=h.suspendedLanes,X=h.pingedLanes,oe=E&268435455;if(oe!==0){var we=oe&~H;we!==0?j=Mt(we):(X&=oe,X!==0&&(j=Mt(X)))}else oe=E&~H,oe!==0?j=Mt(oe):X!==0&&(j=Mt(X));if(j===0)return 0;if(g!==0&&g!==j&&(g&H)===0&&(H=j&-j,X=g&-g,H>=X||H===16&&(X&4194240)!==0))return g;if((j&4)!==0&&(j|=E&16),g=h.entangledLanes,g!==0)for(h=h.entanglements,g&=j;0<g;)E=31-lt(g),H=1<<E,j|=h[E],g&=~H;return j}function tc(h,g){switch(h){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function du(h,g){for(var E=h.suspendedLanes,j=h.pingedLanes,H=h.expirationTimes,X=h.pendingLanes;0<X;){var oe=31-lt(X),we=1<<oe,ke=H[oe];ke===-1?((we&E)===0||(we&j)!==0)&&(H[oe]=tc(we,g)):ke<=g&&(h.expiredLanes|=we),X&=~we}}function Qn(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function Fd(){var h=Tr;return Tr<<=1,(Tr&4194240)===0&&(Tr=64),h}function hi(h){for(var g=[],E=0;31>E;E++)g.push(h);return g}function Za(h,g,E){h.pendingLanes|=g,g!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,g=31-lt(g),h[g]=E}function wn(h,g){var E=h.pendingLanes&~g;h.pendingLanes=g,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=g,h.mutableReadLanes&=g,h.entangledLanes&=g,g=h.entanglements;var j=h.eventTimes;for(h=h.expirationTimes;0<E;){var H=31-lt(E),X=1<<H;g[H]=0,j[H]=-1,h[H]=-1,E&=~X}}function zs(h,g){var E=h.entangledLanes|=g;for(h=h.entanglements;E;){var j=31-lt(E),H=1<<j;H&g|h[j]&g&&(h[j]|=g),E&=~H}}var nr=0;function Fs(h){return h&=-h,1<h?4<h?(h&268435455)!==0?16:536870912:4:1}var ro,ps,rc,nc,Do,gl=!1,no=[],Si=null,Vs=null,ja=null,ir=new Map,qt=new Map,Dn=[],Pr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vd(h,g){switch(h){case"focusin":case"focusout":Si=null;break;case"dragenter":case"dragleave":Vs=null;break;case"mouseover":case"mouseout":ja=null;break;case"pointerover":case"pointerout":ir.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":qt.delete(g.pointerId)}}function Io(h,g,E,j,H,X){return h===null||h.nativeEvent!==X?(h={blockedOn:g,domEventName:E,eventSystemFlags:j,nativeEvent:X,targetContainers:[H]},g!==null&&(g=Xo(g),g!==null&&ps(g)),h):(h.eventSystemFlags|=j,g=h.targetContainers,H!==null&&g.indexOf(H)===-1&&g.push(H),h)}function _n(h,g,E,j,H){switch(g){case"focusin":return Si=Io(Si,h,g,E,j,H),!0;case"dragenter":return Vs=Io(Vs,h,g,E,j,H),!0;case"mouseover":return ja=Io(ja,h,g,E,j,H),!0;case"pointerover":var X=H.pointerId;return ir.set(X,Io(ir.get(X)||null,h,g,E,j,H)),!0;case"gotpointercapture":return X=H.pointerId,qt.set(X,Io(qt.get(X)||null,h,g,E,j,H)),!0}return!1}function vl(h){var g=ho(h.target);if(g!==null){var E=ci(g);if(E!==null){if(g=E.tag,g===13){if(g=sn(E),g!==null){h.blockedOn=g,Do(h.priority,function(){rc(E)});return}}else if(g===3&&E.stateNode.current.memoizedState.isDehydrated){h.blockedOn=E.tag===3?E.stateNode.containerInfo:null;return}}}h.blockedOn=null}function ms(h){if(h.blockedOn!==null)return!1;for(var g=h.targetContainers;0<g.length;){var E=pu(h.domEventName,h.eventSystemFlags,g[0],h.nativeEvent);if(E===null){E=h.nativeEvent;var j=new E.constructor(E.type,E);Ze=j,E.target.dispatchEvent(j),Ze=null}else return g=Xo(E),g!==null&&ps(g),h.blockedOn=E,!1;g.shift()}return!0}function yl(h,g,E){ms(h)&&E.delete(g)}function hu(){gl=!1,Si!==null&&ms(Si)&&(Si=null),Vs!==null&&ms(Vs)&&(Vs=null),ja!==null&&ms(ja)&&(ja=null),ir.forEach(yl),qt.forEach(yl)}function $r(h,g){h.blockedOn===g&&(h.blockedOn=null,gl||(gl=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,hu)))}function Sn(h){function g(H){return $r(H,h)}if(0<no.length){$r(no[0],h);for(var E=1;E<no.length;E++){var j=no[E];j.blockedOn===h&&(j.blockedOn=null)}}for(Si!==null&&$r(Si,h),Vs!==null&&$r(Vs,h),ja!==null&&$r(ja,h),ir.forEach(g),qt.forEach(g),E=0;E<Dn.length;E++)j=Dn[E],j.blockedOn===h&&(j.blockedOn=null);for(;0<Dn.length&&(E=Dn[0],E.blockedOn===null);)vl(E),E.blockedOn===null&&Dn.shift()}var Bo=P.ReactCurrentBatchConfig,fu=!0;function Ya(h,g,E,j){var H=nr,X=Bo.transition;Bo.transition=null;try{nr=1,io(h,g,E,j)}finally{nr=H,Bo.transition=X}}function gs(h,g,E,j){var H=nr,X=Bo.transition;Bo.transition=null;try{nr=4,io(h,g,E,j)}finally{nr=H,Bo.transition=X}}function io(h,g,E,j){if(fu){var H=pu(h,g,E,j);if(H===null)f(h,g,j,xl,E),Vd(h,j);else if(_n(H,h,g,E,j))j.stopPropagation();else if(Vd(h,j),g&4&&-1<Pr.indexOf(h)){for(;H!==null;){var X=Xo(H);if(X!==null&&ro(X),X=pu(h,g,E,j),X===null&&f(h,g,j,xl,E),X===H)break;H=X}H!==null&&j.stopPropagation()}else f(h,g,j,null,E)}}var xl=null;function pu(h,g,E,j){if(xl=null,h=Ge(j),h=ho(h),h!==null)if(g=ci(h),g===null)h=null;else if(E=g.tag,E===13){if(h=sn(g),h!==null)return h;h=null}else if(E===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;h=null}else g!==h&&(h=null);return xl=h,null}function or(h){switch(h){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cu()){case Bs:return 1;case ml:return 4;case Aa:case Oo:return 16;case ra:return 536870912;default:return 16}default:return 16}}var Jn=null,Fn=null,aa=null;function bl(){if(aa)return aa;var h,g=Fn,E=g.length,j,H="value"in Jn?Jn.value:Jn.textContent,X=H.length;for(h=0;h<E&&g[h]===H[h];h++);var oe=E-h;for(j=1;j<=oe&&g[E-j]===H[X-j];j++);return aa=H.slice(h,1<j?1-j:void 0)}function zo(h){var g=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&g===13&&(h=13)):h=g,h===10&&(h=13),32<=h||h===13?h:0}function ei(){return!0}function sa(){return!1}function kn(h){function g(E,j,H,X,oe){this._reactName=E,this._targetInst=H,this.type=j,this.nativeEvent=X,this.target=oe,this.currentTarget=null;for(var we in h)h.hasOwnProperty(we)&&(E=h[we],this[we]=E?E(X):X[we]);return this.isDefaultPrevented=(X.defaultPrevented!=null?X.defaultPrevented:X.returnValue===!1)?ei:sa,this.isPropagationStopped=sa,this}return ne(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var E=this.nativeEvent;E&&(E.preventDefault?E.preventDefault():typeof E.returnValue!="unknown"&&(E.returnValue=!1),this.isDefaultPrevented=ei)},stopPropagation:function(){var E=this.nativeEvent;E&&(E.stopPropagation?E.stopPropagation():typeof E.cancelBubble!="unknown"&&(E.cancelBubble=!0),this.isPropagationStopped=ei)},persist:function(){},isPersistent:ei}),g}var Ri={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xa=kn(Ri),oa=ne({},Ri,{view:0,detail:0}),tf=kn(oa),Li,mu,Vn,ln=ne({},oa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qa,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==Vn&&(Vn&&h.type==="mousemove"?(Li=h.screenX-Vn.screenX,mu=h.screenY-Vn.screenY):mu=Li=0,Vn=h),Li)},movementY:function(h){return"movementY"in h?h.movementY:mu}}),Dr=kn(ln),wl=ne({},ln,{dataTransfer:0}),la=kn(wl),rf=ne({},oa,{relatedTarget:0}),gu=kn(rf),ic=ne({},Ri,{animationName:0,elapsedTime:0,pseudoElement:0}),Ud=kn(ic),nf=ne({},Ri,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),_l=kn(nf),af=ne({},Ri,{data:0}),ao=kn(af),ac={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Op(h){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(h):(h=vs[h])?!!g[h]:!1}function Qa(){return Op}var ki=ne({},oa,{key:function(h){if(h.key){var g=ac[h.key]||h.key;if(g!=="Unidentified")return g}return h.type==="keypress"?(h=zo(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?sc[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qa,charCode:function(h){return h.type==="keypress"?zo(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?zo(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),Hd=kn(ki),Gd=ne({},ln,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fo=kn(Gd),oc=ne({},oa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qa}),Sl=kn(oc),lc=ne({},Ri,{propertyName:0,elapsedTime:0,pseudoElement:0}),kl=kn(lc),uc=ne({},ln,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),qd=kn(uc),Ra=[9,13,27,32],ys=l&&"CompositionEvent"in window,Vo=null;l&&"documentMode"in document&&(Vo=document.documentMode);var Oi=l&&"TextEvent"in window&&!Vo,ua=l&&(!ys||Vo&&8<Vo&&11>=Vo),ca=" ",cc=!1;function Uo(h,g){switch(h){case"keyup":return Ra.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function La(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var fi=!1;function Wd(h,g){switch(h){case"compositionend":return La(g);case"keypress":return g.which!==32?null:(cc=!0,ca);case"textInput":return h=g.data,h===ca&&cc?null:h;default:return null}}function Us(h,g){if(fi)return h==="compositionend"||!ys&&Uo(h,g)?(h=bl(),aa=Fn=Jn=null,fi=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return ua&&g.locale!=="ko"?null:g.data;default:return null}}var Oa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hs(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g==="input"?!!Oa[h.type]:g==="textarea"}function Ho(h,g,E,j){Ft(j),g=M(g,"onChange"),0<g.length&&(E=new Xa("onChange","change",null,E,j),h.push({event:E,listeners:g}))}var Cl=null,pi=null;function sf(h){gc(h,0)}function da(h){var g=Tn(h);if(be(g))return h}function Da(h,g){if(h==="change")return g}var Di=!1;if(l){var Ja;if(l){var ha="oninput"in document;if(!ha){var El=document.createElement("div");El.setAttribute("oninput","return;"),ha=typeof El.oninput=="function"}Ja=ha}else Ja=!1;Di=Ja&&(!document.documentMode||9<document.documentMode)}function xs(){Cl&&(Cl.detachEvent("onpropertychange",vu),pi=Cl=null)}function vu(h){if(h.propertyName==="value"&&da(pi)){var g=[];Ho(g,pi,h,Ge(h)),pr(sf,g)}}function Nl(h,g,E){h==="focusin"?(xs(),Cl=g,pi=E,Cl.attachEvent("onpropertychange",vu)):h==="focusout"&&xs()}function Cr(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return da(pi)}function Go(h,g){if(h==="click")return da(g)}function yu(h,g){if(h==="input"||h==="change")return da(g)}function dc(h,g){return h===g&&(h!==0||1/h===1/g)||h!==h&&g!==g}var Ii=typeof Object.is=="function"?Object.is:dc;function bs(h,g){if(Ii(h,g))return!0;if(typeof h!="object"||h===null||typeof g!="object"||g===null)return!1;var E=Object.keys(h),j=Object.keys(g);if(E.length!==j.length)return!1;for(j=0;j<E.length;j++){var H=E[j];if(!u.call(g,H)||!Ii(h[H],g[H]))return!1}return!0}function so(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function Vr(h,g){var E=so(h);h=0;for(var j;E;){if(E.nodeType===3){if(j=h+E.textContent.length,h<=g&&j>=g)return{node:E,offset:g-h};h=j}e:{for(;E;){if(E.nextSibling){E=E.nextSibling;break e}E=E.parentNode}E=void 0}E=so(E)}}function Cn(h,g){return h&&g?h===g?!0:h&&h.nodeType===3?!1:g&&g.nodeType===3?Cn(h,g.parentNode):"contains"in h?h.contains(g):h.compareDocumentPosition?!!(h.compareDocumentPosition(g)&16):!1:!1}function En(){for(var h=window,g=Se();g instanceof h.HTMLIFrameElement;){try{var E=typeof g.contentWindow.location.href=="string"}catch{E=!1}if(E)h=g.contentWindow;else break;g=Se(h.document)}return g}function Tl(h){var g=h&&h.nodeName&&h.nodeName.toLowerCase();return g&&(g==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||g==="textarea"||h.contentEditable==="true")}function Bi(h){var g=En(),E=h.focusedElem,j=h.selectionRange;if(g!==E&&E&&E.ownerDocument&&Cn(E.ownerDocument.documentElement,E)){if(j!==null&&Tl(E)){if(g=j.start,h=j.end,h===void 0&&(h=g),"selectionStart"in E)E.selectionStart=g,E.selectionEnd=Math.min(h,E.value.length);else if(h=(g=E.ownerDocument||document)&&g.defaultView||window,h.getSelection){h=h.getSelection();var H=E.textContent.length,X=Math.min(j.start,H);j=j.end===void 0?X:Math.min(j.end,H),!h.extend&&X>j&&(H=j,j=X,X=H),H=Vr(E,X);var oe=Vr(E,j);H&&oe&&(h.rangeCount!==1||h.anchorNode!==H.node||h.anchorOffset!==H.offset||h.focusNode!==oe.node||h.focusOffset!==oe.offset)&&(g=g.createRange(),g.setStart(H.node,H.offset),h.removeAllRanges(),X>j?(h.addRange(g),h.extend(oe.node,oe.offset)):(g.setEnd(oe.node,oe.offset),h.addRange(g)))}}for(g=[],h=E;h=h.parentNode;)h.nodeType===1&&g.push({element:h,left:h.scrollLeft,top:h.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<g.length;E++)h=g[E],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}}var oo=l&&"documentMode"in document&&11>=document.documentMode,Pl=null,gn=null,qo=null,Ml=!1;function hc(h,g,E){var j=E.window===E?E.document:E.nodeType===9?E:E.ownerDocument;Ml||Pl==null||Pl!==Se(j)||(j=Pl,"selectionStart"in j&&Tl(j)?j={start:j.selectionStart,end:j.selectionEnd}:(j=(j.ownerDocument&&j.ownerDocument.defaultView||window).getSelection(),j={anchorNode:j.anchorNode,anchorOffset:j.anchorOffset,focusNode:j.focusNode,focusOffset:j.focusOffset}),qo&&bs(qo,j)||(qo=j,j=M(gn,"onSelect"),0<j.length&&(g=new Xa("onSelect","select",null,g,E),h.push({event:g,listeners:j}),g.target=Pl)))}function ti(h,g){var E={};return E[h.toLowerCase()]=g.toLowerCase(),E["Webkit"+h]="webkit"+g,E["Moz"+h]="moz"+g,E}var ri={animationend:ti("Animation","AnimationEnd"),animationiteration:ti("Animation","AnimationIteration"),animationstart:ti("Animation","AnimationStart"),transitionend:ti("Transition","TransitionEnd")},Ia={},xu={};l&&(xu=document.createElement("div").style,"AnimationEvent"in window||(delete ri.animationend.animation,delete ri.animationiteration.animation,delete ri.animationstart.animation),"TransitionEvent"in window||delete ri.transitionend.transition);function Wo(h){if(Ia[h])return Ia[h];if(!ri[h])return h;var g=ri[h],E;for(E in g)if(g.hasOwnProperty(E)&&E in xu)return Ia[h]=g[E];return h}var $d=Wo("animationend"),es=Wo("animationiteration"),fc=Wo("animationstart"),pc=Wo("transitionend"),$o=new Map,Kd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ba(h,g){$o.set(h,g),s(g,[h])}for(var lo=0;lo<Kd.length;lo++){var uo=Kd[lo],Zd=uo.toLowerCase(),mc=uo[0].toUpperCase()+uo.slice(1);Ba(Zd,"on"+mc)}Ba($d,"onAnimationEnd"),Ba(es,"onAnimationIteration"),Ba(fc,"onAnimationStart"),Ba("dblclick","onDoubleClick"),Ba("focusin","onFocus"),Ba("focusout","onBlur"),Ba(pc,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yd=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gs));function bu(h,g,E){var j=h.type||"unknown-event";h.currentTarget=E,eo(j,g,void 0,h),h.currentTarget=null}function gc(h,g){g=(g&4)!==0;for(var E=0;E<h.length;E++){var j=h[E],H=j.event;j=j.listeners;e:{var X=void 0;if(g)for(var oe=j.length-1;0<=oe;oe--){var we=j[oe],ke=we.instance,Be=we.currentTarget;if(we=we.listener,ke!==X&&H.isPropagationStopped())break e;bu(H,we,Be),X=ke}else for(oe=0;oe<j.length;oe++){if(we=j[oe],ke=we.instance,Be=we.currentTarget,we=we.listener,ke!==X&&H.isPropagationStopped())break e;bu(H,we,Be),X=ke}}}if(Or)throw h=Xn,Or=!1,Xn=null,h}function Mr(h,g){var E=g[Yo];E===void 0&&(E=g[Yo]=new Set);var j=h+"__bubble";E.has(j)||(Xd(g,h,2,!1),E.add(j))}function vc(h,g,E){var j=0;g&&(j|=4),Xd(E,h,j,g)}var Al="_reactListening"+Math.random().toString(36).slice(2);function co(h){if(!h[Al]){h[Al]=!0,i.forEach(function(E){E!=="selectionchange"&&(Yd.has(E)||vc(E,!1,h),vc(E,!0,h))});var g=h.nodeType===9?h:h.ownerDocument;g===null||g[Al]||(g[Al]=!0,vc("selectionchange",!1,g))}}function Xd(h,g,E,j){switch(or(g)){case 1:var H=Ya;break;case 4:H=gs;break;default:H=io}E=H.bind(null,g,E,h),H=void 0,!qr||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(H=!0),j?H!==void 0?h.addEventListener(g,E,{capture:!0,passive:H}):h.addEventListener(g,E,!0):H!==void 0?h.addEventListener(g,E,{passive:H}):h.addEventListener(g,E,!1)}function f(h,g,E,j,H){var X=j;if((g&1)===0&&(g&2)===0&&j!==null)e:for(;;){if(j===null)return;var oe=j.tag;if(oe===3||oe===4){var we=j.stateNode.containerInfo;if(we===H||we.nodeType===8&&we.parentNode===H)break;if(oe===4)for(oe=j.return;oe!==null;){var ke=oe.tag;if((ke===3||ke===4)&&(ke=oe.stateNode.containerInfo,ke===H||ke.nodeType===8&&ke.parentNode===H))return;oe=oe.return}for(;we!==null;){if(oe=ho(we),oe===null)return;if(ke=oe.tag,ke===5||ke===6){j=X=oe;continue e}we=we.parentNode}}j=j.return}pr(function(){var Be=X,Xe=Ge(E),tt=[];e:{var Ye=$o.get(h);if(Ye!==void 0){var _t=Xa,Pt=h;switch(h){case"keypress":if(zo(E)===0)break e;case"keydown":case"keyup":_t=Hd;break;case"focusin":Pt="focus",_t=gu;break;case"focusout":Pt="blur",_t=gu;break;case"beforeblur":case"afterblur":_t=gu;break;case"click":if(E.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_t=Dr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_t=la;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_t=Sl;break;case $d:case es:case fc:_t=Ud;break;case pc:_t=kl;break;case"scroll":_t=tf;break;case"wheel":_t=qd;break;case"copy":case"cut":case"paste":_t=_l;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_t=Fo}var At=(g&4)!==0,si=!At&&h==="scroll",je=At?Ye!==null?Ye+"Capture":null:Ye;At=[];for(var Ee=Be,Le;Ee!==null;){Le=Ee;var st=Le.stateNode;if(Le.tag===5&&st!==null&&(Le=st,je!==null&&(st=pn(Ee,je),st!=null&&At.push(_(Ee,st,Le)))),si)break;Ee=Ee.return}0<At.length&&(Ye=new _t(Ye,Pt,null,E,Xe),tt.push({event:Ye,listeners:At}))}}if((g&7)===0){e:{if(Ye=h==="mouseover"||h==="pointerover",_t=h==="mouseout"||h==="pointerout",Ye&&E!==Ze&&(Pt=E.relatedTarget||E.fromElement)&&(ho(Pt)||Pt[br]))break e;if((_t||Ye)&&(Ye=Xe.window===Xe?Xe:(Ye=Xe.ownerDocument)?Ye.defaultView||Ye.parentWindow:window,_t?(Pt=E.relatedTarget||E.toElement,_t=Be,Pt=Pt?ho(Pt):null,Pt!==null&&(si=ci(Pt),Pt!==si||Pt.tag!==5&&Pt.tag!==6)&&(Pt=null)):(_t=null,Pt=Be),_t!==Pt)){if(At=Dr,st="onMouseLeave",je="onMouseEnter",Ee="mouse",(h==="pointerout"||h==="pointerover")&&(At=Fo,st="onPointerLeave",je="onPointerEnter",Ee="pointer"),si=_t==null?Ye:Tn(_t),Le=Pt==null?Ye:Tn(Pt),Ye=new At(st,Ee+"leave",_t,E,Xe),Ye.target=si,Ye.relatedTarget=Le,st=null,ho(Xe)===Be&&(At=new At(je,Ee+"enter",Pt,E,Xe),At.target=Le,At.relatedTarget=si,st=At),si=st,_t&&Pt)t:{for(At=_t,je=Pt,Ee=0,Le=At;Le;Le=U(Le))Ee++;for(Le=0,st=je;st;st=U(st))Le++;for(;0<Ee-Le;)At=U(At),Ee--;for(;0<Le-Ee;)je=U(je),Le--;for(;Ee--;){if(At===je||je!==null&&At===je.alternate)break t;At=U(At),je=U(je)}At=null}else At=null;_t!==null&&ee(tt,Ye,_t,At,!1),Pt!==null&&si!==null&&ee(tt,si,Pt,At,!0)}}e:{if(Ye=Be?Tn(Be):window,_t=Ye.nodeName&&Ye.nodeName.toLowerCase(),_t==="select"||_t==="input"&&Ye.type==="file")var jt=Da;else if(Hs(Ye))if(Di)jt=yu;else{jt=Cr;var Vt=Nl}else(_t=Ye.nodeName)&&_t.toLowerCase()==="input"&&(Ye.type==="checkbox"||Ye.type==="radio")&&(jt=Go);if(jt&&(jt=jt(h,Be))){Ho(tt,jt,E,Xe);break e}Vt&&Vt(h,Ye,Be),h==="focusout"&&(Vt=Ye._wrapperState)&&Vt.controlled&&Ye.type==="number"&&Ve(Ye,"number",Ye.value)}switch(Vt=Be?Tn(Be):window,h){case"focusin":(Hs(Vt)||Vt.contentEditable==="true")&&(Pl=Vt,gn=Be,qo=null);break;case"focusout":qo=gn=Pl=null;break;case"mousedown":Ml=!0;break;case"contextmenu":case"mouseup":case"dragend":Ml=!1,hc(tt,E,Xe);break;case"selectionchange":if(oo)break;case"keydown":case"keyup":hc(tt,E,Xe)}var Ut;if(ys)e:{switch(h){case"compositionstart":var Kt="onCompositionStart";break e;case"compositionend":Kt="onCompositionEnd";break e;case"compositionupdate":Kt="onCompositionUpdate";break e}Kt=void 0}else fi?Uo(h,E)&&(Kt="onCompositionEnd"):h==="keydown"&&E.keyCode===229&&(Kt="onCompositionStart");Kt&&(ua&&E.locale!=="ko"&&(fi||Kt!=="onCompositionStart"?Kt==="onCompositionEnd"&&fi&&(Ut=bl()):(Jn=Xe,Fn="value"in Jn?Jn.value:Jn.textContent,fi=!0)),Vt=M(Be,Kt),0<Vt.length&&(Kt=new ao(Kt,h,null,E,Xe),tt.push({event:Kt,listeners:Vt}),Ut?Kt.data=Ut:(Ut=La(E),Ut!==null&&(Kt.data=Ut)))),(Ut=Oi?Wd(h,E):Us(h,E))&&(Be=M(Be,"onBeforeInput"),0<Be.length&&(Xe=new ao("onBeforeInput","beforeinput",null,E,Xe),tt.push({event:Xe,listeners:Be}),Xe.data=Ut))}gc(tt,g)})}function _(h,g,E){return{instance:h,listener:g,currentTarget:E}}function M(h,g){for(var E=g+"Capture",j=[];h!==null;){var H=h,X=H.stateNode;H.tag===5&&X!==null&&(H=X,X=pn(h,E),X!=null&&j.unshift(_(h,X,H)),X=pn(h,g),X!=null&&j.push(_(h,X,H))),h=h.return}return j}function U(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5);return h||null}function ee(h,g,E,j,H){for(var X=g._reactName,oe=[];E!==null&&E!==j;){var we=E,ke=we.alternate,Be=we.stateNode;if(ke!==null&&ke===j)break;we.tag===5&&Be!==null&&(we=Be,H?(ke=pn(E,X),ke!=null&&oe.unshift(_(E,ke,we))):H||(ke=pn(E,X),ke!=null&&oe.push(_(E,ke,we)))),E=E.return}oe.length!==0&&h.push({event:g,listeners:oe})}var ue=/\r\n?/g,_e=/\u0000|\uFFFD/g;function Ae(h){return(typeof h=="string"?h:""+h).replace(ue,`
`).replace(_e,"")}function De(h,g,E){if(g=Ae(g),Ae(h)!==g&&E)throw Error(n(425))}function $e(){}var pt=null,It=null;function Jt(h,g){return h==="textarea"||h==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var Ar=typeof setTimeout=="function"?setTimeout:void 0,Nn=typeof clearTimeout=="function"?clearTimeout:void 0,mi=typeof Promise=="function"?Promise:void 0,Ci=typeof queueMicrotask=="function"?queueMicrotask:typeof mi<"u"?function(h){return mi.resolve(null).then(h).catch(Ko)}:Ar;function Ko(h){setTimeout(function(){throw h})}function yc(h,g){var E=g,j=0;do{var H=E.nextSibling;if(h.removeChild(E),H&&H.nodeType===8)if(E=H.data,E==="/$"){if(j===0){h.removeChild(H),Sn(g);return}j--}else E!=="$"&&E!=="$?"&&E!=="$!"||j++;E=H}while(E);Sn(g)}function ws(h){for(;h!=null;h=h.nextSibling){var g=h.nodeType;if(g===1||g===3)break;if(g===8){if(g=h.data,g==="$"||g==="$!"||g==="$?")break;if(g==="/$")return null}}return h}function Zo(h){h=h.previousSibling;for(var g=0;h;){if(h.nodeType===8){var E=h.data;if(E==="$"||E==="$!"||E==="$?"){if(g===0)return h;g--}else E==="/$"&&g++}h=h.previousSibling}return null}var qs=Math.random().toString(36).slice(2),za="__reactFiber$"+qs,jl="__reactProps$"+qs,br="__reactContainer$"+qs,Yo="__reactEvents$"+qs,of="__reactListeners$"+qs,lf="__reactHandles$"+qs;function ho(h){var g=h[za];if(g)return g;for(var E=h.parentNode;E;){if(g=E[br]||E[za]){if(E=g.alternate,g.child!==null||E!==null&&E.child!==null)for(h=Zo(h);h!==null;){if(E=h[za])return E;h=Zo(h)}return g}h=E,E=h.parentNode}return null}function Xo(h){return h=h[za]||h[br],!h||h.tag!==5&&h.tag!==6&&h.tag!==13&&h.tag!==3?null:h}function Tn(h){if(h.tag===5||h.tag===6)return h.stateNode;throw Error(n(33))}function Un(h){return h[jl]||null}var uf=[],wu=-1;function Qo(h){return{current:h}}function Kr(h){0>wu||(h.current=uf[wu],uf[wu]=null,wu--)}function Ur(h,g){wu++,uf[wu]=h.current,h.current=g}var fo={},Ei=Qo(fo),zi=Qo(!1),Rl=fo;function _u(h,g){var E=h.type.contextTypes;if(!E)return fo;var j=h.stateNode;if(j&&j.__reactInternalMemoizedUnmaskedChildContext===g)return j.__reactInternalMemoizedMaskedChildContext;var H={},X;for(X in E)H[X]=g[X];return j&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=g,h.__reactInternalMemoizedMaskedChildContext=H),H}function Fi(h){return h=h.childContextTypes,h!=null}function xc(){Kr(zi),Kr(Ei)}function Dp(h,g,E){if(Ei.current!==fo)throw Error(n(168));Ur(Ei,g),Ur(zi,E)}function cf(h,g,E){var j=h.stateNode;if(g=g.childContextTypes,typeof j.getChildContext!="function")return E;j=j.getChildContext();for(var H in j)if(!(H in g))throw Error(n(108,se(h)||"Unknown",H));return ne({},E,j)}function Su(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||fo,Rl=Ei.current,Ur(Ei,h),Ur(zi,zi.current),!0}function Cv(h,g,E){var j=h.stateNode;if(!j)throw Error(n(169));E?(h=cf(h,g,Rl),j.__reactInternalMemoizedMergedChildContext=h,Kr(zi),Kr(Ei),Ur(Ei,h)):Kr(zi),Ur(zi,E)}var po=null,bc=!1,df=!1;function Qd(h){po===null?po=[h]:po.push(h)}function Jo(h){bc=!0,Qd(h)}function Ll(){if(!df&&po!==null){df=!0;var h=0,g=nr;try{var E=po;for(nr=1;h<E.length;h++){var j=E[h];do j=j(!0);while(j!==null)}po=null,bc=!1}catch(H){throw po!==null&&(po=po.slice(h+1)),lu(Bs,Ll),H}finally{nr=g,df=!1}}return null}var fa=[],ku=0,Ol=null,Dl=0,pa=[],ma=0,Il=null,ts=1,un="";function Cu(h,g){fa[ku++]=Dl,fa[ku++]=Ol,Ol=h,Dl=g}function Ev(h,g,E){pa[ma++]=ts,pa[ma++]=un,pa[ma++]=Il,Il=h;var j=ts;h=un;var H=32-lt(j)-1;j&=~(1<<H),E+=1;var X=32-lt(g)+H;if(30<X){var oe=H-H%5;X=(j&(1<<oe)-1).toString(32),j>>=oe,H-=oe,ts=1<<32-lt(g)+H|E<<H|j,un=X+h}else ts=1<<X|E<<H|j,un=h}function wc(h){h.return!==null&&(Cu(h,1),Ev(h,1,0))}function gi(h){for(;h===Ol;)Ol=fa[--ku],fa[ku]=null,Dl=fa[--ku],fa[ku]=null;for(;h===Il;)Il=pa[--ma],pa[ma]=null,un=pa[--ma],pa[ma]=null,ts=pa[--ma],pa[ma]=null}var rs=null,dt=null,jr=!1,ns=null;function Ip(h,g){var E=wo(5,null,null,0);E.elementType="DELETED",E.stateNode=g,E.return=h,g=h.deletions,g===null?(h.deletions=[E],h.flags|=16):g.push(E)}function Nv(h,g){switch(h.tag){case 5:var E=h.type;return g=g.nodeType!==1||E.toLowerCase()!==g.nodeName.toLowerCase()?null:g,g!==null?(h.stateNode=g,rs=h,dt=ws(g.firstChild),!0):!1;case 6:return g=h.pendingProps===""||g.nodeType!==3?null:g,g!==null?(h.stateNode=g,rs=h,dt=null,!0):!1;case 13:return g=g.nodeType!==8?null:g,g!==null?(E=Il!==null?{id:ts,overflow:un}:null,h.memoizedState={dehydrated:g,treeContext:E,retryLane:1073741824},E=wo(18,null,null,0),E.stateNode=g,E.return=h,h.child=E,rs=h,dt=null,!0):!1;default:return!1}}function Eu(h){return(h.mode&1)!==0&&(h.flags&128)===0}function _c(h){if(jr){var g=dt;if(g){var E=g;if(!Nv(h,g)){if(Eu(h))throw Error(n(418));g=ws(E.nextSibling);var j=rs;g&&Nv(h,g)?Ip(j,E):(h.flags=h.flags&-4097|2,jr=!1,rs=h)}}else{if(Eu(h))throw Error(n(418));h.flags=h.flags&-4097|2,jr=!1,rs=h}}}function hf(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;rs=h}function Jd(h){if(h!==rs)return!1;if(!jr)return hf(h),jr=!0,!1;var g;if((g=h.tag!==3)&&!(g=h.tag!==5)&&(g=h.type,g=g!=="head"&&g!=="body"&&!Jt(h.type,h.memoizedProps)),g&&(g=dt)){if(Eu(h))throw Bp(),Error(n(418));for(;g;)Ip(h,g),g=ws(g.nextSibling)}if(hf(h),h.tag===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(n(317));e:{for(h=h.nextSibling,g=0;h;){if(h.nodeType===8){var E=h.data;if(E==="/$"){if(g===0){dt=ws(h.nextSibling);break e}g--}else E!=="$"&&E!=="$!"&&E!=="$?"||g++}h=h.nextSibling}dt=null}}else dt=rs?ws(h.stateNode.nextSibling):null;return!0}function Bp(){for(var h=dt;h;)h=ws(h.nextSibling)}function Nu(){dt=rs=null,jr=!1}function eh(h){ns===null?ns=[h]:ns.push(h)}var zp=P.ReactCurrentBatchConfig;function In(h,g,E){if(h=E.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(E._owner){if(E=E._owner,E){if(E.tag!==1)throw Error(n(309));var j=E.stateNode}if(!j)throw Error(n(147,h));var H=j,X=""+h;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===X?g.ref:(g=function(oe){var we=H.refs;oe===null?delete we[X]:we[X]=oe},g._stringRef=X,g)}if(typeof h!="string")throw Error(n(284));if(!E._owner)throw Error(n(290,h))}return h}function Fa(h,g){throw h=Object.prototype.toString.call(g),Error(n(31,h==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":h))}function Ws(h){var g=h._init;return g(h._payload)}function ff(h){function g(je,Ee){if(h){var Le=je.deletions;Le===null?(je.deletions=[Ee],je.flags|=16):Le.push(Ee)}}function E(je,Ee){if(!h)return null;for(;Ee!==null;)g(je,Ee),Ee=Ee.sibling;return null}function j(je,Ee){for(je=new Map;Ee!==null;)Ee.key!==null?je.set(Ee.key,Ee):je.set(Ee.index,Ee),Ee=Ee.sibling;return je}function H(je,Ee){return je=Uc(je,Ee),je.index=0,je.sibling=null,je}function X(je,Ee,Le){return je.index=Le,h?(Le=je.alternate,Le!==null?(Le=Le.index,Le<Ee?(je.flags|=2,Ee):Le):(je.flags|=2,Ee)):(je.flags|=1048576,Ee)}function oe(je){return h&&je.alternate===null&&(je.flags|=2),je}function we(je,Ee,Le,st){return Ee===null||Ee.tag!==6?(Ee=y1(Le,je.mode,st),Ee.return=je,Ee):(Ee=H(Ee,Le),Ee.return=je,Ee)}function ke(je,Ee,Le,st){var jt=Le.type;return jt===B?Xe(je,Ee,Le.props.children,st,Le.key):Ee!==null&&(Ee.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Z&&Ws(jt)===Ee.type)?(st=H(Ee,Le.props),st.ref=In(je,Ee,Le),st.return=je,st):(st=Kv(Le.type,Le.key,Le.props,null,je.mode,st),st.ref=In(je,Ee,Le),st.return=je,st)}function Be(je,Ee,Le,st){return Ee===null||Ee.tag!==4||Ee.stateNode.containerInfo!==Le.containerInfo||Ee.stateNode.implementation!==Le.implementation?(Ee=x1(Le,je.mode,st),Ee.return=je,Ee):(Ee=H(Ee,Le.children||[]),Ee.return=je,Ee)}function Xe(je,Ee,Le,st,jt){return Ee===null||Ee.tag!==7?(Ee=dh(Le,je.mode,st,jt),Ee.return=je,Ee):(Ee=H(Ee,Le),Ee.return=je,Ee)}function tt(je,Ee,Le){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return Ee=y1(""+Ee,je.mode,Le),Ee.return=je,Ee;if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case R:return Le=Kv(Ee.type,Ee.key,Ee.props,null,je.mode,Le),Le.ref=In(je,null,Ee),Le.return=je,Le;case O:return Ee=x1(Ee,je.mode,Le),Ee.return=je,Ee;case Z:var st=Ee._init;return tt(je,st(Ee._payload),Le)}if(Oe(Ee)||ie(Ee))return Ee=dh(Ee,je.mode,Le,null),Ee.return=je,Ee;Fa(je,Ee)}return null}function Ye(je,Ee,Le,st){var jt=Ee!==null?Ee.key:null;if(typeof Le=="string"&&Le!==""||typeof Le=="number")return jt!==null?null:we(je,Ee,""+Le,st);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case R:return Le.key===jt?ke(je,Ee,Le,st):null;case O:return Le.key===jt?Be(je,Ee,Le,st):null;case Z:return jt=Le._init,Ye(je,Ee,jt(Le._payload),st)}if(Oe(Le)||ie(Le))return jt!==null?null:Xe(je,Ee,Le,st,null);Fa(je,Le)}return null}function _t(je,Ee,Le,st,jt){if(typeof st=="string"&&st!==""||typeof st=="number")return je=je.get(Le)||null,we(Ee,je,""+st,jt);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case R:return je=je.get(st.key===null?Le:st.key)||null,ke(Ee,je,st,jt);case O:return je=je.get(st.key===null?Le:st.key)||null,Be(Ee,je,st,jt);case Z:var Vt=st._init;return _t(je,Ee,Le,Vt(st._payload),jt)}if(Oe(st)||ie(st))return je=je.get(Le)||null,Xe(Ee,je,st,jt,null);Fa(Ee,st)}return null}function Pt(je,Ee,Le,st){for(var jt=null,Vt=null,Ut=Ee,Kt=Ee=0,Wi=null;Ut!==null&&Kt<Le.length;Kt++){Ut.index>Kt?(Wi=Ut,Ut=null):Wi=Ut.sibling;var Er=Ye(je,Ut,Le[Kt],st);if(Er===null){Ut===null&&(Ut=Wi);break}h&&Ut&&Er.alternate===null&&g(je,Ut),Ee=X(Er,Ee,Kt),Vt===null?jt=Er:Vt.sibling=Er,Vt=Er,Ut=Wi}if(Kt===Le.length)return E(je,Ut),jr&&Cu(je,Kt),jt;if(Ut===null){for(;Kt<Le.length;Kt++)Ut=tt(je,Le[Kt],st),Ut!==null&&(Ee=X(Ut,Ee,Kt),Vt===null?jt=Ut:Vt.sibling=Ut,Vt=Ut);return jr&&Cu(je,Kt),jt}for(Ut=j(je,Ut);Kt<Le.length;Kt++)Wi=_t(Ut,je,Kt,Le[Kt],st),Wi!==null&&(h&&Wi.alternate!==null&&Ut.delete(Wi.key===null?Kt:Wi.key),Ee=X(Wi,Ee,Kt),Vt===null?jt=Wi:Vt.sibling=Wi,Vt=Wi);return h&&Ut.forEach(function(Hc){return g(je,Hc)}),jr&&Cu(je,Kt),jt}function At(je,Ee,Le,st){var jt=ie(Le);if(typeof jt!="function")throw Error(n(150));if(Le=jt.call(Le),Le==null)throw Error(n(151));for(var Vt=jt=null,Ut=Ee,Kt=Ee=0,Wi=null,Er=Le.next();Ut!==null&&!Er.done;Kt++,Er=Le.next()){Ut.index>Kt?(Wi=Ut,Ut=null):Wi=Ut.sibling;var Hc=Ye(je,Ut,Er.value,st);if(Hc===null){Ut===null&&(Ut=Wi);break}h&&Ut&&Hc.alternate===null&&g(je,Ut),Ee=X(Hc,Ee,Kt),Vt===null?jt=Hc:Vt.sibling=Hc,Vt=Hc,Ut=Wi}if(Er.done)return E(je,Ut),jr&&Cu(je,Kt),jt;if(Ut===null){for(;!Er.done;Kt++,Er=Le.next())Er=tt(je,Er.value,st),Er!==null&&(Ee=X(Er,Ee,Kt),Vt===null?jt=Er:Vt.sibling=Er,Vt=Er);return jr&&Cu(je,Kt),jt}for(Ut=j(je,Ut);!Er.done;Kt++,Er=Le.next())Er=_t(Ut,je,Kt,Er.value,st),Er!==null&&(h&&Er.alternate!==null&&Ut.delete(Er.key===null?Kt:Er.key),Ee=X(Er,Ee,Kt),Vt===null?jt=Er:Vt.sibling=Er,Vt=Er);return h&&Ut.forEach(function(rR){return g(je,rR)}),jr&&Cu(je,Kt),jt}function si(je,Ee,Le,st){if(typeof Le=="object"&&Le!==null&&Le.type===B&&Le.key===null&&(Le=Le.props.children),typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case R:e:{for(var jt=Le.key,Vt=Ee;Vt!==null;){if(Vt.key===jt){if(jt=Le.type,jt===B){if(Vt.tag===7){E(je,Vt.sibling),Ee=H(Vt,Le.props.children),Ee.return=je,je=Ee;break e}}else if(Vt.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===Z&&Ws(jt)===Vt.type){E(je,Vt.sibling),Ee=H(Vt,Le.props),Ee.ref=In(je,Vt,Le),Ee.return=je,je=Ee;break e}E(je,Vt);break}else g(je,Vt);Vt=Vt.sibling}Le.type===B?(Ee=dh(Le.props.children,je.mode,st,Le.key),Ee.return=je,je=Ee):(st=Kv(Le.type,Le.key,Le.props,null,je.mode,st),st.ref=In(je,Ee,Le),st.return=je,je=st)}return oe(je);case O:e:{for(Vt=Le.key;Ee!==null;){if(Ee.key===Vt)if(Ee.tag===4&&Ee.stateNode.containerInfo===Le.containerInfo&&Ee.stateNode.implementation===Le.implementation){E(je,Ee.sibling),Ee=H(Ee,Le.children||[]),Ee.return=je,je=Ee;break e}else{E(je,Ee);break}else g(je,Ee);Ee=Ee.sibling}Ee=x1(Le,je.mode,st),Ee.return=je,je=Ee}return oe(je);case Z:return Vt=Le._init,si(je,Ee,Vt(Le._payload),st)}if(Oe(Le))return Pt(je,Ee,Le,st);if(ie(Le))return At(je,Ee,Le,st);Fa(je,Le)}return typeof Le=="string"&&Le!==""||typeof Le=="number"?(Le=""+Le,Ee!==null&&Ee.tag===6?(E(je,Ee.sibling),Ee=H(Ee,Le),Ee.return=je,je=Ee):(E(je,Ee),Ee=y1(Le,je.mode,st),Ee.return=je,je=Ee),oe(je)):E(je,Ee)}return si}var Tu=ff(!0),_s=ff(!1),th=Qo(null),is=null,Sc=null,pf=null;function mf(){pf=Sc=is=null}function gf(h){var g=th.current;Kr(th),h._currentValue=g}function vf(h,g,E){for(;h!==null;){var j=h.alternate;if((h.childLanes&g)!==g?(h.childLanes|=g,j!==null&&(j.childLanes|=g)):j!==null&&(j.childLanes&g)!==g&&(j.childLanes|=g),h===E)break;h=h.return}}function el(h,g){is=h,pf=Sc=null,h=h.dependencies,h!==null&&h.firstContext!==null&&((h.lanes&g)!==0&&(te=!0),h.firstContext=null)}function ga(h){var g=h._currentValue;if(pf!==h)if(h={context:h,memoizedValue:g,next:null},Sc===null){if(is===null)throw Error(n(308));Sc=h,is.dependencies={lanes:0,firstContext:h}}else Sc=Sc.next=h;return g}var mo=null;function kc(h){mo===null?mo=[h]:mo.push(h)}function rh(h,g,E,j){var H=g.interleaved;return H===null?(E.next=E,kc(g)):(E.next=H.next,H.next=E),g.interleaved=E,as(h,j)}function as(h,g){h.lanes|=g;var E=h.alternate;for(E!==null&&(E.lanes|=g),E=h,h=h.return;h!==null;)h.childLanes|=g,E=h.alternate,E!==null&&(E.childLanes|=g),E=h,h=h.return;return E.tag===3?E.stateNode:null}var go=!1;function nh(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yf(h,g){h=h.updateQueue,g.updateQueue===h&&(g.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function vo(h,g){return{eventTime:h,lane:g,tag:0,payload:null,callback:null,next:null}}function yo(h,g,E){var j=h.updateQueue;if(j===null)return null;if(j=j.shared,(wr&2)!==0){var H=j.pending;return H===null?g.next=g:(g.next=H.next,H.next=g),j.pending=g,as(h,E)}return H=j.interleaved,H===null?(g.next=g,kc(j)):(g.next=H.next,H.next=g),j.interleaved=g,as(h,E)}function xf(h,g,E){if(g=g.updateQueue,g!==null&&(g=g.shared,(E&4194240)!==0)){var j=g.lanes;j&=h.pendingLanes,E|=j,g.lanes=E,zs(h,E)}}function ih(h,g){var E=h.updateQueue,j=h.alternate;if(j!==null&&(j=j.updateQueue,E===j)){var H=null,X=null;if(E=E.firstBaseUpdate,E!==null){do{var oe={eventTime:E.eventTime,lane:E.lane,tag:E.tag,payload:E.payload,callback:E.callback,next:null};X===null?H=X=oe:X=X.next=oe,E=E.next}while(E!==null);X===null?H=X=g:X=X.next=g}else H=X=g;E={baseState:j.baseState,firstBaseUpdate:H,lastBaseUpdate:X,shared:j.shared,effects:j.effects},h.updateQueue=E;return}h=E.lastBaseUpdate,h===null?E.firstBaseUpdate=g:h.next=g,E.lastBaseUpdate=g}function Cc(h,g,E,j){var H=h.updateQueue;go=!1;var X=H.firstBaseUpdate,oe=H.lastBaseUpdate,we=H.shared.pending;if(we!==null){H.shared.pending=null;var ke=we,Be=ke.next;ke.next=null,oe===null?X=Be:oe.next=Be,oe=ke;var Xe=h.alternate;Xe!==null&&(Xe=Xe.updateQueue,we=Xe.lastBaseUpdate,we!==oe&&(we===null?Xe.firstBaseUpdate=Be:we.next=Be,Xe.lastBaseUpdate=ke))}if(X!==null){var tt=H.baseState;oe=0,Xe=Be=ke=null,we=X;do{var Ye=we.lane,_t=we.eventTime;if((j&Ye)===Ye){Xe!==null&&(Xe=Xe.next={eventTime:_t,lane:0,tag:we.tag,payload:we.payload,callback:we.callback,next:null});e:{var Pt=h,At=we;switch(Ye=g,_t=E,At.tag){case 1:if(Pt=At.payload,typeof Pt=="function"){tt=Pt.call(_t,tt,Ye);break e}tt=Pt;break e;case 3:Pt.flags=Pt.flags&-65537|128;case 0:if(Pt=At.payload,Ye=typeof Pt=="function"?Pt.call(_t,tt,Ye):Pt,Ye==null)break e;tt=ne({},tt,Ye);break e;case 2:go=!0}}we.callback!==null&&we.lane!==0&&(h.flags|=64,Ye=H.effects,Ye===null?H.effects=[we]:Ye.push(we))}else _t={eventTime:_t,lane:Ye,tag:we.tag,payload:we.payload,callback:we.callback,next:null},Xe===null?(Be=Xe=_t,ke=tt):Xe=Xe.next=_t,oe|=Ye;if(we=we.next,we===null){if(we=H.shared.pending,we===null)break;Ye=we,we=Ye.next,Ye.next=null,H.lastBaseUpdate=Ye,H.shared.pending=null}}while(!0);if(Xe===null&&(ke=tt),H.baseState=ke,H.firstBaseUpdate=Be,H.lastBaseUpdate=Xe,g=H.shared.interleaved,g!==null){H=g;do oe|=H.lane,H=H.next;while(H!==g)}else X===null&&(H.shared.lanes=0);oh|=oe,h.lanes=oe,h.memoizedState=tt}}function Pn(h,g,E){if(h=g.effects,g.effects=null,h!==null)for(g=0;g<h.length;g++){var j=h[g],H=j.callback;if(H!==null){if(j.callback=null,j=E,typeof H!="function")throw Error(n(191,H));H.call(j)}}}var er={},Hr=Qo(er),cn=Qo(er),Bn=Qo(er);function ni(h){if(h===er)throw Error(n(174));return h}function Bl(h,g){switch(Ur(Bn,g),Ur(cn,h),Ur(Hr,er),h=g.nodeType,h){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:Et(null,"");break;default:h=h===8?g.parentNode:g,g=h.namespaceURI||null,h=h.tagName,g=Et(g,h)}Kr(Hr),Ur(Hr,g)}function dn(){Kr(Hr),Kr(cn),Kr(Bn)}function Ec(h){ni(Bn.current);var g=ni(Hr.current),E=Et(g,h.type);g!==E&&(Ur(cn,h),Ur(Hr,E))}function tl(h){cn.current===h&&(Kr(Hr),Kr(cn))}var Zr=Qo(0);function Nc(h){for(var g=h;g!==null;){if(g.tag===13){var E=g.memoizedState;if(E!==null&&(E=E.dehydrated,E===null||E.data==="$?"||E.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var Pu=[];function Vi(){for(var h=0;h<Pu.length;h++)Pu[h]._workInProgressVersionPrimary=null;Pu.length=0}var Tc=P.ReactCurrentDispatcher,ah=P.ReactCurrentBatchConfig,va=0,Ir=null,Mn=null,Hn=null,$s=!1,zl=!1,Ss=0,bf=0;function Gn(){throw Error(n(321))}function sh(h,g){if(g===null)return!1;for(var E=0;E<g.length&&E<h.length;E++)if(!Ii(h[E],g[E]))return!1;return!0}function Pc(h,g,E,j,H,X){if(va=X,Ir=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Tc.current=h===null||h.memoizedState===null?Jx:Ul,h=E(j,H),zl){X=0;do{if(zl=!1,Ss=0,25<=X)throw Error(n(301));X+=1,Hn=Mn=null,g.updateQueue=null,Tc.current=Cf,h=E(j,H)}while(zl)}if(Tc.current=Rc,g=Mn!==null&&Mn.next!==null,va=0,Hn=Mn=Ir=null,$s=!1,g)throw Error(n(300));return h}function Mc(){var h=Ss!==0;return Ss=0,h}function Jr(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hn===null?Ir.memoizedState=Hn=h:Hn=Hn.next=h,Hn}function ii(){if(Mn===null){var h=Ir.alternate;h=h!==null?h.memoizedState:null}else h=Mn.next;var g=Hn===null?Ir.memoizedState:Hn.next;if(g!==null)Hn=g,Mn=h;else{if(h===null)throw Error(n(310));Mn=h,h={memoizedState:Mn.memoizedState,baseState:Mn.baseState,baseQueue:Mn.baseQueue,queue:Mn.queue,next:null},Hn===null?Ir.memoizedState=Hn=h:Hn=Hn.next=h}return Hn}function Ui(h,g){return typeof g=="function"?g(h):g}function Hi(h){var g=ii(),E=g.queue;if(E===null)throw Error(n(311));E.lastRenderedReducer=h;var j=Mn,H=j.baseQueue,X=E.pending;if(X!==null){if(H!==null){var oe=H.next;H.next=X.next,X.next=oe}j.baseQueue=H=X,E.pending=null}if(H!==null){X=H.next,j=j.baseState;var we=oe=null,ke=null,Be=X;do{var Xe=Be.lane;if((va&Xe)===Xe)ke!==null&&(ke=ke.next={lane:0,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null}),j=Be.hasEagerState?Be.eagerState:h(j,Be.action);else{var tt={lane:Xe,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null};ke===null?(we=ke=tt,oe=j):ke=ke.next=tt,Ir.lanes|=Xe,oh|=Xe}Be=Be.next}while(Be!==null&&Be!==X);ke===null?oe=j:ke.next=we,Ii(j,g.memoizedState)||(te=!0),g.memoizedState=j,g.baseState=oe,g.baseQueue=ke,E.lastRenderedState=j}if(h=E.interleaved,h!==null){H=h;do X=H.lane,Ir.lanes|=X,oh|=X,H=H.next;while(H!==h)}else H===null&&(E.lanes=0);return[g.memoizedState,E.dispatch]}function wf(h){var g=ii(),E=g.queue;if(E===null)throw Error(n(311));E.lastRenderedReducer=h;var j=E.dispatch,H=E.pending,X=g.memoizedState;if(H!==null){E.pending=null;var oe=H=H.next;do X=h(X,oe.action),oe=oe.next;while(oe!==H);Ii(X,g.memoizedState)||(te=!0),g.memoizedState=X,g.baseQueue===null&&(g.baseState=X),E.lastRenderedState=X}return[X,j]}function _f(){}function Sf(h,g){var E=Ir,j=ii(),H=g(),X=!Ii(j.memoizedState,H);if(X&&(j.memoizedState=H,te=!0),j=j.queue,Hp(Fp.bind(null,E,j,h),[h]),j.getSnapshot!==g||X||Hn!==null&&Hn.memoizedState.tag&1){if(E.flags|=2048,Ac(9,rl.bind(null,E,j,H,g),void 0,null),qi===null)throw Error(n(349));(va&30)!==0||Tv(E,g,H)}return H}function Tv(h,g,E){h.flags|=16384,h={getSnapshot:g,value:E},g=Ir.updateQueue,g===null?(g={lastEffect:null,stores:null},Ir.updateQueue=g,g.stores=[h]):(E=g.stores,E===null?g.stores=[h]:E.push(h))}function rl(h,g,E,j){g.value=E,g.getSnapshot=j,Vp(g)&&kf(h)}function Fp(h,g,E){return E(function(){Vp(g)&&kf(h)})}function Vp(h){var g=h.getSnapshot;h=h.value;try{var E=g();return!Ii(h,E)}catch{return!0}}function kf(h){var g=as(h,1);g!==null&&sl(g,h,1,-1)}function Fl(h){var g=Jr();return typeof h=="function"&&(h=h()),g.memoizedState=g.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ui,lastRenderedState:h},g.queue=h,h=h.dispatch=Lv.bind(null,Ir,h),[g.memoizedState,h]}function Ac(h,g,E,j){return h={tag:h,create:g,destroy:E,deps:j,next:null},g=Ir.updateQueue,g===null?(g={lastEffect:null,stores:null},Ir.updateQueue=g,g.lastEffect=h.next=h):(E=g.lastEffect,E===null?g.lastEffect=h.next=h:(j=E.next,E.next=h,h.next=j,g.lastEffect=h)),h}function Up(){return ii().memoizedState}function jc(h,g,E,j){var H=Jr();Ir.flags|=h,H.memoizedState=Ac(1|g,E,void 0,j===void 0?null:j)}function Mu(h,g,E,j){var H=ii();j=j===void 0?null:j;var X=void 0;if(Mn!==null){var oe=Mn.memoizedState;if(X=oe.destroy,j!==null&&sh(j,oe.deps)){H.memoizedState=Ac(g,E,X,j);return}}Ir.flags|=h,H.memoizedState=Ac(1|g,E,X,j)}function Pv(h,g){return jc(8390656,8,h,g)}function Hp(h,g){return Mu(2048,8,h,g)}function Gp(h,g){return Mu(4,2,h,g)}function qp(h,g){return Mu(4,4,h,g)}function Vl(h,g){if(typeof g=="function")return h=h(),g(h),function(){g(null)};if(g!=null)return h=h(),g.current=h,function(){g.current=null}}function Mv(h,g,E){return E=E!=null?E.concat([h]):null,Mu(4,4,Vl.bind(null,g,h),E)}function nl(){}function Wp(h,g){var E=ii();g=g===void 0?null:g;var j=E.memoizedState;return j!==null&&g!==null&&sh(g,j[1])?j[0]:(E.memoizedState=[h,g],h)}function en(h,g){var E=ii();g=g===void 0?null:g;var j=E.memoizedState;return j!==null&&g!==null&&sh(g,j[1])?j[0]:(h=h(),E.memoizedState=[h,g],h)}function Av(h,g,E){return(va&21)===0?(h.baseState&&(h.baseState=!1,te=!0),h.memoizedState=E):(Ii(E,g)||(E=Fd(),Ir.lanes|=E,oh|=E,h.baseState=!0),g)}function jv(h,g){var E=nr;nr=E!==0&&4>E?E:4,h(!0);var j=ah.transition;ah.transition={};try{h(!1),g()}finally{nr=E,ah.transition=j}}function Rv(){return ii().memoizedState}function Qx(h,g,E){var j=Fc(h);if(E={lane:j,action:E,hasEagerState:!1,eagerState:null,next:null},$p(h))Ov(g,E);else if(E=rh(h,g,E,j),E!==null){var H=ls();sl(E,h,j,H),ss(E,g,j)}}function Lv(h,g,E){var j=Fc(h),H={lane:j,action:E,hasEagerState:!1,eagerState:null,next:null};if($p(h))Ov(g,H);else{var X=h.alternate;if(h.lanes===0&&(X===null||X.lanes===0)&&(X=g.lastRenderedReducer,X!==null))try{var oe=g.lastRenderedState,we=X(oe,E);if(H.hasEagerState=!0,H.eagerState=we,Ii(we,oe)){var ke=g.interleaved;ke===null?(H.next=H,kc(g)):(H.next=ke.next,ke.next=H),g.interleaved=H;return}}catch{}E=rh(h,g,H,j),E!==null&&(H=ls(),sl(E,h,j,H),ss(E,g,j))}}function $p(h){var g=h.alternate;return h===Ir||g!==null&&g===Ir}function Ov(h,g){zl=$s=!0;var E=h.pending;E===null?g.next=g:(g.next=E.next,E.next=g),h.pending=g}function ss(h,g,E){if((E&4194240)!==0){var j=g.lanes;j&=h.pendingLanes,E|=j,g.lanes=E,zs(h,E)}}var Rc={readContext:ga,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useInsertionEffect:Gn,useLayoutEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useMutableSource:Gn,useSyncExternalStore:Gn,useId:Gn,unstable_isNewReconciler:!1},Jx={readContext:ga,useCallback:function(h,g){return Jr().memoizedState=[h,g===void 0?null:g],h},useContext:ga,useEffect:Pv,useImperativeHandle:function(h,g,E){return E=E!=null?E.concat([h]):null,jc(4194308,4,Vl.bind(null,g,h),E)},useLayoutEffect:function(h,g){return jc(4194308,4,h,g)},useInsertionEffect:function(h,g){return jc(4,2,h,g)},useMemo:function(h,g){var E=Jr();return g=g===void 0?null:g,h=h(),E.memoizedState=[h,g],h},useReducer:function(h,g,E){var j=Jr();return g=E!==void 0?E(g):g,j.memoizedState=j.baseState=g,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:g},j.queue=h,h=h.dispatch=Qx.bind(null,Ir,h),[j.memoizedState,h]},useRef:function(h){var g=Jr();return h={current:h},g.memoizedState=h},useState:Fl,useDebugValue:nl,useDeferredValue:function(h){return Jr().memoizedState=h},useTransition:function(){var h=Fl(!1),g=h[0];return h=jv.bind(null,h[1]),Jr().memoizedState=h,[g,h]},useMutableSource:function(){},useSyncExternalStore:function(h,g,E){var j=Ir,H=Jr();if(jr){if(E===void 0)throw Error(n(407));E=E()}else{if(E=g(),qi===null)throw Error(n(349));(va&30)!==0||Tv(j,g,E)}H.memoizedState=E;var X={value:E,getSnapshot:g};return H.queue=X,Pv(Fp.bind(null,j,X,h),[h]),j.flags|=2048,Ac(9,rl.bind(null,j,X,E,g),void 0,null),E},useId:function(){var h=Jr(),g=qi.identifierPrefix;if(jr){var E=un,j=ts;E=(j&~(1<<32-lt(j)-1)).toString(32)+E,g=":"+g+"R"+E,E=Ss++,0<E&&(g+="H"+E.toString(32)),g+=":"}else E=bf++,g=":"+g+"r"+E.toString(32)+":";return h.memoizedState=g},unstable_isNewReconciler:!1},Ul={readContext:ga,useCallback:Wp,useContext:ga,useEffect:Hp,useImperativeHandle:Mv,useInsertionEffect:Gp,useLayoutEffect:qp,useMemo:en,useReducer:Hi,useRef:Up,useState:function(){return Hi(Ui)},useDebugValue:nl,useDeferredValue:function(h){var g=ii();return Av(g,Mn.memoizedState,h)},useTransition:function(){var h=Hi(Ui)[0],g=ii().memoizedState;return[h,g]},useMutableSource:_f,useSyncExternalStore:Sf,useId:Rv,unstable_isNewReconciler:!1},Cf={readContext:ga,useCallback:Wp,useContext:ga,useEffect:Hp,useImperativeHandle:Mv,useInsertionEffect:Gp,useLayoutEffect:qp,useMemo:en,useReducer:wf,useRef:Up,useState:function(){return wf(Ui)},useDebugValue:nl,useDeferredValue:function(h){var g=ii();return Mn===null?g.memoizedState=h:Av(g,Mn.memoizedState,h)},useTransition:function(){var h=wf(Ui)[0],g=ii().memoizedState;return[h,g]},useMutableSource:_f,useSyncExternalStore:Sf,useId:Rv,unstable_isNewReconciler:!1};function Ni(h,g){if(h&&h.defaultProps){g=ne({},g),h=h.defaultProps;for(var E in h)g[E]===void 0&&(g[E]=h[E]);return g}return g}function Lc(h,g,E,j){g=h.memoizedState,E=E(j,g),E=E==null?g:ne({},g,E),h.memoizedState=E,h.lanes===0&&(h.updateQueue.baseState=E)}var Oc={isMounted:function(h){return(h=h._reactInternals)?ci(h)===h:!1},enqueueSetState:function(h,g,E){h=h._reactInternals;var j=ls(),H=Fc(h),X=vo(j,H);X.payload=g,E!=null&&(X.callback=E),g=yo(h,X,H),g!==null&&(sl(g,h,H,j),xf(g,h,H))},enqueueReplaceState:function(h,g,E){h=h._reactInternals;var j=ls(),H=Fc(h),X=vo(j,H);X.tag=1,X.payload=g,E!=null&&(X.callback=E),g=yo(h,X,H),g!==null&&(sl(g,h,H,j),xf(g,h,H))},enqueueForceUpdate:function(h,g){h=h._reactInternals;var E=ls(),j=Fc(h),H=vo(E,j);H.tag=2,g!=null&&(H.callback=g),g=yo(h,H,j),g!==null&&(sl(g,h,j,E),xf(g,h,j))}};function Ef(h,g,E,j,H,X,oe){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(j,X,oe):g.prototype&&g.prototype.isPureReactComponent?!bs(E,j)||!bs(H,X):!0}function Dv(h,g,E){var j=!1,H=fo,X=g.contextType;return typeof X=="object"&&X!==null?X=ga(X):(H=Fi(g)?Rl:Ei.current,j=g.contextTypes,X=(j=j!=null)?_u(h,H):fo),g=new g(E,X),h.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Oc,h.stateNode=g,g._reactInternals=h,j&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=H,h.__reactInternalMemoizedMaskedChildContext=X),g}function Kp(h,g,E,j){h=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(E,j),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(E,j),g.state!==h&&Oc.enqueueReplaceState(g,g.state,null)}function Nf(h,g,E,j){var H=h.stateNode;H.props=E,H.state=h.memoizedState,H.refs={},nh(h);var X=g.contextType;typeof X=="object"&&X!==null?H.context=ga(X):(X=Fi(g)?Rl:Ei.current,H.context=_u(h,X)),H.state=h.memoizedState,X=g.getDerivedStateFromProps,typeof X=="function"&&(Lc(h,g,X,E),H.state=h.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(g=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),g!==H.state&&Oc.enqueueReplaceState(H,H.state,null),Cc(h,E,H,j),H.state=h.memoizedState),typeof H.componentDidMount=="function"&&(h.flags|=4194308)}function Au(h,g){try{var E="",j=g;do E+=ve(j),j=j.return;while(j);var H=E}catch(X){H=`
Error generating stack: `+X.message+`
`+X.stack}return{value:h,source:g,stack:H,digest:null}}function Tf(h,g,E){return{value:h,source:null,stack:E??null,digest:g??null}}function Dc(h,g){try{console.error(g.value)}catch(E){setTimeout(function(){throw E})}}var e1=typeof WeakMap=="function"?WeakMap:Map;function Iv(h,g,E){E=vo(-1,E),E.tag=3,E.payload={element:null};var j=g.value;return E.callback=function(){Uv||(Uv=!0,c1=j),Dc(h,g)},E}function x(h,g,E){E=vo(-1,E),E.tag=3;var j=h.type.getDerivedStateFromError;if(typeof j=="function"){var H=g.value;E.payload=function(){return j(H)},E.callback=function(){Dc(h,g)}}var X=h.stateNode;return X!==null&&typeof X.componentDidCatch=="function"&&(E.callback=function(){Dc(h,g),typeof j!="function"&&(Bc===null?Bc=new Set([this]):Bc.add(this));var oe=g.stack;this.componentDidCatch(g.value,{componentStack:oe!==null?oe:""})}),E}function w(h,g,E){var j=h.pingCache;if(j===null){j=h.pingCache=new e1;var H=new Set;j.set(g,H)}else H=j.get(g),H===void 0&&(H=new Set,j.set(g,H));H.has(E)||(H.add(E),h=qj.bind(null,h,g,E),g.then(h,h))}function A(h){do{var g;if((g=h.tag===13)&&(g=h.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return h;h=h.return}while(h!==null);return null}function F(h,g,E,j,H){return(h.mode&1)===0?(h===g?h.flags|=65536:(h.flags|=128,E.flags|=131072,E.flags&=-52805,E.tag===1&&(E.alternate===null?E.tag=17:(g=vo(-1,1),g.tag=2,yo(E,g,1))),E.lanes|=1),h):(h.flags|=65536,h.lanes=H,h)}var K=P.ReactCurrentOwner,te=!1;function fe(h,g,E,j){g.child=h===null?_s(g,null,E,j):Tu(g,h.child,E,j)}function Pe(h,g,E,j,H){E=E.render;var X=g.ref;return el(g,H),j=Pc(h,g,E,j,X,H),E=Mc(),h!==null&&!te?(g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~H,Gi(h,g,H)):(jr&&E&&wc(g),g.flags|=1,fe(h,g,j,H),g.child)}function Fe(h,g,E,j,H){if(h===null){var X=E.type;return typeof X=="function"&&!v1(X)&&X.defaultProps===void 0&&E.compare===null&&E.defaultProps===void 0?(g.tag=15,g.type=X,it(h,g,X,j,H)):(h=Kv(E.type,null,j,g,g.mode,H),h.ref=g.ref,h.return=g,g.child=h)}if(X=h.child,(h.lanes&H)===0){var oe=X.memoizedProps;if(E=E.compare,E=E!==null?E:bs,E(oe,j)&&h.ref===g.ref)return Gi(h,g,H)}return g.flags|=1,h=Uc(X,j),h.ref=g.ref,h.return=g,g.child=h}function it(h,g,E,j,H){if(h!==null){var X=h.memoizedProps;if(bs(X,j)&&h.ref===g.ref)if(te=!1,g.pendingProps=j=X,(h.lanes&H)!==0)(h.flags&131072)!==0&&(te=!0);else return g.lanes=h.lanes,Gi(h,g,H)}return mt(h,g,E,j,H)}function Ct(h,g,E){var j=g.pendingProps,H=j.children,X=h!==null?h.memoizedState:null;if(j.mode==="hidden")if((g.mode&1)===0)g.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ur(Mf,Ks),Ks|=E;else{if((E&1073741824)===0)return h=X!==null?X.baseLanes|E:E,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:h,cachePool:null,transitions:null},g.updateQueue=null,Ur(Mf,Ks),Ks|=h,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},j=X!==null?X.baseLanes:E,Ur(Mf,Ks),Ks|=j}else X!==null?(j=X.baseLanes|E,g.memoizedState=null):j=E,Ur(Mf,Ks),Ks|=j;return fe(h,g,H,E),g.child}function Zt(h,g){var E=g.ref;(h===null&&E!==null||h!==null&&h.ref!==E)&&(g.flags|=512,g.flags|=2097152)}function mt(h,g,E,j,H){var X=Fi(E)?Rl:Ei.current;return X=_u(g,X),el(g,H),E=Pc(h,g,E,j,X,H),j=Mc(),h!==null&&!te?(g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~H,Gi(h,g,H)):(jr&&j&&wc(g),g.flags|=1,fe(h,g,E,H),g.child)}function Yr(h,g,E,j,H){if(Fi(E)){var X=!0;Su(g)}else X=!1;if(el(g,H),g.stateNode===null)mr(h,g),Dv(g,E,j),Nf(g,E,j,H),j=!0;else if(h===null){var oe=g.stateNode,we=g.memoizedProps;oe.props=we;var ke=oe.context,Be=E.contextType;typeof Be=="object"&&Be!==null?Be=ga(Be):(Be=Fi(E)?Rl:Ei.current,Be=_u(g,Be));var Xe=E.getDerivedStateFromProps,tt=typeof Xe=="function"||typeof oe.getSnapshotBeforeUpdate=="function";tt||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(we!==j||ke!==Be)&&Kp(g,oe,j,Be),go=!1;var Ye=g.memoizedState;oe.state=Ye,Cc(g,j,oe,H),ke=g.memoizedState,we!==j||Ye!==ke||zi.current||go?(typeof Xe=="function"&&(Lc(g,E,Xe,j),ke=g.memoizedState),(we=go||Ef(g,E,we,j,Ye,ke,Be))?(tt||typeof oe.UNSAFE_componentWillMount!="function"&&typeof oe.componentWillMount!="function"||(typeof oe.componentWillMount=="function"&&oe.componentWillMount(),typeof oe.UNSAFE_componentWillMount=="function"&&oe.UNSAFE_componentWillMount()),typeof oe.componentDidMount=="function"&&(g.flags|=4194308)):(typeof oe.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=j,g.memoizedState=ke),oe.props=j,oe.state=ke,oe.context=Be,j=we):(typeof oe.componentDidMount=="function"&&(g.flags|=4194308),j=!1)}else{oe=g.stateNode,yf(h,g),we=g.memoizedProps,Be=g.type===g.elementType?we:Ni(g.type,we),oe.props=Be,tt=g.pendingProps,Ye=oe.context,ke=E.contextType,typeof ke=="object"&&ke!==null?ke=ga(ke):(ke=Fi(E)?Rl:Ei.current,ke=_u(g,ke));var _t=E.getDerivedStateFromProps;(Xe=typeof _t=="function"||typeof oe.getSnapshotBeforeUpdate=="function")||typeof oe.UNSAFE_componentWillReceiveProps!="function"&&typeof oe.componentWillReceiveProps!="function"||(we!==tt||Ye!==ke)&&Kp(g,oe,j,ke),go=!1,Ye=g.memoizedState,oe.state=Ye,Cc(g,j,oe,H);var Pt=g.memoizedState;we!==tt||Ye!==Pt||zi.current||go?(typeof _t=="function"&&(Lc(g,E,_t,j),Pt=g.memoizedState),(Be=go||Ef(g,E,Be,j,Ye,Pt,ke)||!1)?(Xe||typeof oe.UNSAFE_componentWillUpdate!="function"&&typeof oe.componentWillUpdate!="function"||(typeof oe.componentWillUpdate=="function"&&oe.componentWillUpdate(j,Pt,ke),typeof oe.UNSAFE_componentWillUpdate=="function"&&oe.UNSAFE_componentWillUpdate(j,Pt,ke)),typeof oe.componentDidUpdate=="function"&&(g.flags|=4),typeof oe.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof oe.componentDidUpdate!="function"||we===h.memoizedProps&&Ye===h.memoizedState||(g.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||we===h.memoizedProps&&Ye===h.memoizedState||(g.flags|=1024),g.memoizedProps=j,g.memoizedState=Pt),oe.props=j,oe.state=Pt,oe.context=ke,j=Be):(typeof oe.componentDidUpdate!="function"||we===h.memoizedProps&&Ye===h.memoizedState||(g.flags|=4),typeof oe.getSnapshotBeforeUpdate!="function"||we===h.memoizedProps&&Ye===h.memoizedState||(g.flags|=1024),j=!1)}return Rr(h,g,E,j,X,H)}function Rr(h,g,E,j,H,X){Zt(h,g);var oe=(g.flags&128)!==0;if(!j&&!oe)return H&&Cv(g,E,!1),Gi(h,g,X);j=g.stateNode,K.current=g;var we=oe&&typeof E.getDerivedStateFromError!="function"?null:j.render();return g.flags|=1,h!==null&&oe?(g.child=Tu(g,h.child,null,X),g.child=Tu(g,null,we,X)):fe(h,g,we,X),g.memoizedState=j.state,H&&Cv(g,E,!0),g.child}function ya(h){var g=h.stateNode;g.pendingContext?Dp(h,g.pendingContext,g.pendingContext!==g.context):g.context&&Dp(h,g.context,!1),Bl(h,g.containerInfo)}function xo(h,g,E,j,H){return Nu(),eh(H),g.flags|=256,fe(h,g,E,j),g.child}var Ie={dehydrated:null,treeContext:null,retryLane:0};function Me(h){return{baseLanes:h,cachePool:null,transitions:null}}function He(h,g,E){var j=g.pendingProps,H=Zr.current,X=!1,oe=(g.flags&128)!==0,we;if((we=oe)||(we=h!==null&&h.memoizedState===null?!1:(H&2)!==0),we?(X=!0,g.flags&=-129):(h===null||h.memoizedState!==null)&&(H|=1),Ur(Zr,H&1),h===null)return _c(g),h=g.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?((g.mode&1)===0?g.lanes=1:h.data==="$!"?g.lanes=8:g.lanes=1073741824,null):(oe=j.children,h=j.fallback,X?(j=g.mode,X=g.child,oe={mode:"hidden",children:oe},(j&1)===0&&X!==null?(X.childLanes=0,X.pendingProps=oe):X=Zv(oe,j,0,null),h=dh(h,j,E,null),X.return=g,h.return=g,X.sibling=h,g.child=X,g.child.memoizedState=Me(E),g.memoizedState=Ie,h):vt(g,oe));if(H=h.memoizedState,H!==null&&(we=H.dehydrated,we!==null))return tr(h,g,oe,j,we,H,E);if(X){X=j.fallback,oe=g.mode,H=h.child,we=H.sibling;var ke={mode:"hidden",children:j.children};return(oe&1)===0&&g.child!==H?(j=g.child,j.childLanes=0,j.pendingProps=ke,g.deletions=null):(j=Uc(H,ke),j.subtreeFlags=H.subtreeFlags&14680064),we!==null?X=Uc(we,X):(X=dh(X,oe,E,null),X.flags|=2),X.return=g,j.return=g,j.sibling=X,g.child=j,j=X,X=g.child,oe=h.child.memoizedState,oe=oe===null?Me(E):{baseLanes:oe.baseLanes|E,cachePool:null,transitions:oe.transitions},X.memoizedState=oe,X.childLanes=h.childLanes&~E,g.memoizedState=Ie,j}return X=h.child,h=X.sibling,j=Uc(X,{mode:"visible",children:j.children}),(g.mode&1)===0&&(j.lanes=E),j.return=g,j.sibling=null,h!==null&&(E=g.deletions,E===null?(g.deletions=[h],g.flags|=16):E.push(h)),g.child=j,g.memoizedState=null,j}function vt(h,g){return g=Zv({mode:"visible",children:g},h.mode,0,null),g.return=h,h.child=g}function Lt(h,g,E,j){return j!==null&&eh(j),Tu(g,h.child,null,E),h=vt(g,g.pendingProps.children),h.flags|=2,g.memoizedState=null,h}function tr(h,g,E,j,H,X,oe){if(E)return g.flags&256?(g.flags&=-257,j=Tf(Error(n(422))),Lt(h,g,oe,j)):g.memoizedState!==null?(g.child=h.child,g.flags|=128,null):(X=j.fallback,H=g.mode,j=Zv({mode:"visible",children:j.children},H,0,null),X=dh(X,H,oe,null),X.flags|=2,j.return=g,X.return=g,j.sibling=X,g.child=j,(g.mode&1)!==0&&Tu(g,h.child,null,oe),g.child.memoizedState=Me(oe),g.memoizedState=Ie,X);if((g.mode&1)===0)return Lt(h,g,oe,null);if(H.data==="$!"){if(j=H.nextSibling&&H.nextSibling.dataset,j)var we=j.dgst;return j=we,X=Error(n(419)),j=Tf(X,j,void 0),Lt(h,g,oe,j)}if(we=(oe&h.childLanes)!==0,te||we){if(j=qi,j!==null){switch(oe&-oe){case 4:H=2;break;case 16:H=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:H=32;break;case 536870912:H=268435456;break;default:H=0}H=(H&(j.suspendedLanes|oe))!==0?0:H,H!==0&&H!==X.retryLane&&(X.retryLane=H,as(h,H),sl(j,h,H,-1))}return g1(),j=Tf(Error(n(421))),Lt(h,g,oe,j)}return H.data==="$?"?(g.flags|=128,g.child=h.child,g=Wj.bind(null,h),H._reactRetry=g,null):(h=X.treeContext,dt=ws(H.nextSibling),rs=g,jr=!0,ns=null,h!==null&&(pa[ma++]=ts,pa[ma++]=un,pa[ma++]=Il,ts=h.id,un=h.overflow,Il=g),g=vt(g,j.children),g.flags|=4096,g)}function Yt(h,g,E){h.lanes|=g;var j=h.alternate;j!==null&&(j.lanes|=g),vf(h.return,g,E)}function vr(h,g,E,j,H){var X=h.memoizedState;X===null?h.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:j,tail:E,tailMode:H}:(X.isBackwards=g,X.rendering=null,X.renderingStartTime=0,X.last=j,X.tail=E,X.tailMode=H)}function ai(h,g,E){var j=g.pendingProps,H=j.revealOrder,X=j.tail;if(fe(h,g,j.children,E),j=Zr.current,(j&2)!==0)j=j&1|2,g.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=g.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&Yt(h,E,g);else if(h.tag===19)Yt(h,E,g);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===g)break e;for(;h.sibling===null;){if(h.return===null||h.return===g)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}j&=1}if(Ur(Zr,j),(g.mode&1)===0)g.memoizedState=null;else switch(H){case"forwards":for(E=g.child,H=null;E!==null;)h=E.alternate,h!==null&&Nc(h)===null&&(H=E),E=E.sibling;E=H,E===null?(H=g.child,g.child=null):(H=E.sibling,E.sibling=null),vr(g,!1,H,E,X);break;case"backwards":for(E=null,H=g.child,g.child=null;H!==null;){if(h=H.alternate,h!==null&&Nc(h)===null){g.child=H;break}h=H.sibling,H.sibling=E,E=H,H=h}vr(g,!0,E,null,X);break;case"together":vr(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function mr(h,g){(g.mode&1)===0&&h!==null&&(h.alternate=null,g.alternate=null,g.flags|=2)}function Gi(h,g,E){if(h!==null&&(g.dependencies=h.dependencies),oh|=g.lanes,(E&g.childLanes)===0)return null;if(h!==null&&g.child!==h.child)throw Error(n(153));if(g.child!==null){for(h=g.child,E=Uc(h,h.pendingProps),g.child=E,E.return=g;h.sibling!==null;)h=h.sibling,E=E.sibling=Uc(h,h.pendingProps),E.return=g;E.sibling=null}return g.child}function t1(h,g,E){switch(g.tag){case 3:ya(g),Nu();break;case 5:Ec(g);break;case 1:Fi(g.type)&&Su(g);break;case 4:Bl(g,g.stateNode.containerInfo);break;case 10:var j=g.type._context,H=g.memoizedProps.value;Ur(th,j._currentValue),j._currentValue=H;break;case 13:if(j=g.memoizedState,j!==null)return j.dehydrated!==null?(Ur(Zr,Zr.current&1),g.flags|=128,null):(E&g.child.childLanes)!==0?He(h,g,E):(Ur(Zr,Zr.current&1),h=Gi(h,g,E),h!==null?h.sibling:null);Ur(Zr,Zr.current&1);break;case 19:if(j=(E&g.childLanes)!==0,(h.flags&128)!==0){if(j)return ai(h,g,E);g.flags|=128}if(H=g.memoizedState,H!==null&&(H.rendering=null,H.tail=null,H.lastEffect=null),Ur(Zr,Zr.current),j)break;return null;case 22:case 23:return g.lanes=0,Ct(h,g,E)}return Gi(h,g,E)}var ek,r1,tk,rk;ek=function(h,g){for(var E=g.child;E!==null;){if(E.tag===5||E.tag===6)h.appendChild(E.stateNode);else if(E.tag!==4&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===g)break;for(;E.sibling===null;){if(E.return===null||E.return===g)return;E=E.return}E.sibling.return=E.return,E=E.sibling}},r1=function(){},tk=function(h,g,E,j){var H=h.memoizedProps;if(H!==j){h=g.stateNode,ni(Hr.current);var X=null;switch(E){case"input":H=Ue(h,H),j=Ue(h,j),X=[];break;case"select":H=ne({},H,{value:void 0}),j=ne({},j,{value:void 0}),X=[];break;case"textarea":H=Ne(h,H),j=Ne(h,j),X=[];break;default:typeof H.onClick!="function"&&typeof j.onClick=="function"&&(h.onclick=$e)}Te(E,j);var oe;E=null;for(Be in H)if(!j.hasOwnProperty(Be)&&H.hasOwnProperty(Be)&&H[Be]!=null)if(Be==="style"){var we=H[Be];for(oe in we)we.hasOwnProperty(oe)&&(E||(E={}),E[oe]="")}else Be!=="dangerouslySetInnerHTML"&&Be!=="children"&&Be!=="suppressContentEditableWarning"&&Be!=="suppressHydrationWarning"&&Be!=="autoFocus"&&(a.hasOwnProperty(Be)?X||(X=[]):(X=X||[]).push(Be,null));for(Be in j){var ke=j[Be];if(we=H?.[Be],j.hasOwnProperty(Be)&&ke!==we&&(ke!=null||we!=null))if(Be==="style")if(we){for(oe in we)!we.hasOwnProperty(oe)||ke&&ke.hasOwnProperty(oe)||(E||(E={}),E[oe]="");for(oe in ke)ke.hasOwnProperty(oe)&&we[oe]!==ke[oe]&&(E||(E={}),E[oe]=ke[oe])}else E||(X||(X=[]),X.push(Be,E)),E=ke;else Be==="dangerouslySetInnerHTML"?(ke=ke?ke.__html:void 0,we=we?we.__html:void 0,ke!=null&&we!==ke&&(X=X||[]).push(Be,ke)):Be==="children"?typeof ke!="string"&&typeof ke!="number"||(X=X||[]).push(Be,""+ke):Be!=="suppressContentEditableWarning"&&Be!=="suppressHydrationWarning"&&(a.hasOwnProperty(Be)?(ke!=null&&Be==="onScroll"&&Mr("scroll",h),X||we===ke||(X=[])):(X=X||[]).push(Be,ke))}E&&(X=X||[]).push("style",E);var Be=X;(g.updateQueue=Be)&&(g.flags|=4)}},rk=function(h,g,E,j){E!==j&&(g.flags|=4)};function Zp(h,g){if(!jr)switch(h.tailMode){case"hidden":g=h.tail;for(var E=null;g!==null;)g.alternate!==null&&(E=g),g=g.sibling;E===null?h.tail=null:E.sibling=null;break;case"collapsed":E=h.tail;for(var j=null;E!==null;)E.alternate!==null&&(j=E),E=E.sibling;j===null?g||h.tail===null?h.tail=null:h.tail.sibling=null:j.sibling=null}}function Va(h){var g=h.alternate!==null&&h.alternate.child===h.child,E=0,j=0;if(g)for(var H=h.child;H!==null;)E|=H.lanes|H.childLanes,j|=H.subtreeFlags&14680064,j|=H.flags&14680064,H.return=h,H=H.sibling;else for(H=h.child;H!==null;)E|=H.lanes|H.childLanes,j|=H.subtreeFlags,j|=H.flags,H.return=h,H=H.sibling;return h.subtreeFlags|=j,h.childLanes=E,g}function Oj(h,g,E){var j=g.pendingProps;switch(gi(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Va(g),null;case 1:return Fi(g.type)&&xc(),Va(g),null;case 3:return j=g.stateNode,dn(),Kr(zi),Kr(Ei),Vi(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(h===null||h.child===null)&&(Jd(g)?g.flags|=4:h===null||h.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,ns!==null&&(f1(ns),ns=null))),r1(h,g),Va(g),null;case 5:tl(g);var H=ni(Bn.current);if(E=g.type,h!==null&&g.stateNode!=null)tk(h,g,E,j,H),h.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!j){if(g.stateNode===null)throw Error(n(166));return Va(g),null}if(h=ni(Hr.current),Jd(g)){j=g.stateNode,E=g.type;var X=g.memoizedProps;switch(j[za]=g,j[jl]=X,h=(g.mode&1)!==0,E){case"dialog":Mr("cancel",j),Mr("close",j);break;case"iframe":case"object":case"embed":Mr("load",j);break;case"video":case"audio":for(H=0;H<Gs.length;H++)Mr(Gs[H],j);break;case"source":Mr("error",j);break;case"img":case"image":case"link":Mr("error",j),Mr("load",j);break;case"details":Mr("toggle",j);break;case"input":We(j,X),Mr("invalid",j);break;case"select":j._wrapperState={wasMultiple:!!X.multiple},Mr("invalid",j);break;case"textarea":ze(j,X),Mr("invalid",j)}Te(E,X),H=null;for(var oe in X)if(X.hasOwnProperty(oe)){var we=X[oe];oe==="children"?typeof we=="string"?j.textContent!==we&&(X.suppressHydrationWarning!==!0&&De(j.textContent,we,h),H=["children",we]):typeof we=="number"&&j.textContent!==""+we&&(X.suppressHydrationWarning!==!0&&De(j.textContent,we,h),H=["children",""+we]):a.hasOwnProperty(oe)&&we!=null&&oe==="onScroll"&&Mr("scroll",j)}switch(E){case"input":me(j),at(j,X,!0);break;case"textarea":me(j),ft(j);break;case"select":case"option":break;default:typeof X.onClick=="function"&&(j.onclick=$e)}j=H,g.updateQueue=j,j!==null&&(g.flags|=4)}else{oe=H.nodeType===9?H:H.ownerDocument,h==="http://www.w3.org/1999/xhtml"&&(h=yt(E)),h==="http://www.w3.org/1999/xhtml"?E==="script"?(h=oe.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild)):typeof j.is=="string"?h=oe.createElement(E,{is:j.is}):(h=oe.createElement(E),E==="select"&&(oe=h,j.multiple?oe.multiple=!0:j.size&&(oe.size=j.size))):h=oe.createElementNS(h,E),h[za]=g,h[jl]=j,ek(h,g,!1,!1),g.stateNode=h;e:{switch(oe=Re(E,j),E){case"dialog":Mr("cancel",h),Mr("close",h),H=j;break;case"iframe":case"object":case"embed":Mr("load",h),H=j;break;case"video":case"audio":for(H=0;H<Gs.length;H++)Mr(Gs[H],h);H=j;break;case"source":Mr("error",h),H=j;break;case"img":case"image":case"link":Mr("error",h),Mr("load",h),H=j;break;case"details":Mr("toggle",h),H=j;break;case"input":We(h,j),H=Ue(h,j),Mr("invalid",h);break;case"option":H=j;break;case"select":h._wrapperState={wasMultiple:!!j.multiple},H=ne({},j,{value:void 0}),Mr("invalid",h);break;case"textarea":ze(h,j),H=Ne(h,j),Mr("invalid",h);break;default:H=j}Te(E,H),we=H;for(X in we)if(we.hasOwnProperty(X)){var ke=we[X];X==="style"?ye(h,ke):X==="dangerouslySetInnerHTML"?(ke=ke?ke.__html:void 0,ke!=null&&$t(h,ke)):X==="children"?typeof ke=="string"?(E!=="textarea"||ke!=="")&&wt(h,ke):typeof ke=="number"&&wt(h,""+ke):X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&X!=="autoFocus"&&(a.hasOwnProperty(X)?ke!=null&&X==="onScroll"&&Mr("scroll",h):ke!=null&&N(h,X,ke,oe))}switch(E){case"input":me(h),at(h,j,!1);break;case"textarea":me(h),ft(h);break;case"option":j.value!=null&&h.setAttribute("value",""+ge(j.value));break;case"select":h.multiple=!!j.multiple,X=j.value,X!=null?et(h,!!j.multiple,X,!1):j.defaultValue!=null&&et(h,!!j.multiple,j.defaultValue,!0);break;default:typeof H.onClick=="function"&&(h.onclick=$e)}switch(E){case"button":case"input":case"select":case"textarea":j=!!j.autoFocus;break e;case"img":j=!0;break e;default:j=!1}}j&&(g.flags|=4)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return Va(g),null;case 6:if(h&&g.stateNode!=null)rk(h,g,h.memoizedProps,j);else{if(typeof j!="string"&&g.stateNode===null)throw Error(n(166));if(E=ni(Bn.current),ni(Hr.current),Jd(g)){if(j=g.stateNode,E=g.memoizedProps,j[za]=g,(X=j.nodeValue!==E)&&(h=rs,h!==null))switch(h.tag){case 3:De(j.nodeValue,E,(h.mode&1)!==0);break;case 5:h.memoizedProps.suppressHydrationWarning!==!0&&De(j.nodeValue,E,(h.mode&1)!==0)}X&&(g.flags|=4)}else j=(E.nodeType===9?E:E.ownerDocument).createTextNode(j),j[za]=g,g.stateNode=j}return Va(g),null;case 13:if(Kr(Zr),j=g.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(jr&&dt!==null&&(g.mode&1)!==0&&(g.flags&128)===0)Bp(),Nu(),g.flags|=98560,X=!1;else if(X=Jd(g),j!==null&&j.dehydrated!==null){if(h===null){if(!X)throw Error(n(318));if(X=g.memoizedState,X=X!==null?X.dehydrated:null,!X)throw Error(n(317));X[za]=g}else Nu(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Va(g),X=!1}else ns!==null&&(f1(ns),ns=null),X=!0;if(!X)return g.flags&65536?g:null}return(g.flags&128)!==0?(g.lanes=E,g):(j=j!==null,j!==(h!==null&&h.memoizedState!==null)&&j&&(g.child.flags|=8192,(g.mode&1)!==0&&(h===null||(Zr.current&1)!==0?Ti===0&&(Ti=3):g1())),g.updateQueue!==null&&(g.flags|=4),Va(g),null);case 4:return dn(),r1(h,g),h===null&&co(g.stateNode.containerInfo),Va(g),null;case 10:return gf(g.type._context),Va(g),null;case 17:return Fi(g.type)&&xc(),Va(g),null;case 19:if(Kr(Zr),X=g.memoizedState,X===null)return Va(g),null;if(j=(g.flags&128)!==0,oe=X.rendering,oe===null)if(j)Zp(X,!1);else{if(Ti!==0||h!==null&&(h.flags&128)!==0)for(h=g.child;h!==null;){if(oe=Nc(h),oe!==null){for(g.flags|=128,Zp(X,!1),j=oe.updateQueue,j!==null&&(g.updateQueue=j,g.flags|=4),g.subtreeFlags=0,j=E,E=g.child;E!==null;)X=E,h=j,X.flags&=14680066,oe=X.alternate,oe===null?(X.childLanes=0,X.lanes=h,X.child=null,X.subtreeFlags=0,X.memoizedProps=null,X.memoizedState=null,X.updateQueue=null,X.dependencies=null,X.stateNode=null):(X.childLanes=oe.childLanes,X.lanes=oe.lanes,X.child=oe.child,X.subtreeFlags=0,X.deletions=null,X.memoizedProps=oe.memoizedProps,X.memoizedState=oe.memoizedState,X.updateQueue=oe.updateQueue,X.type=oe.type,h=oe.dependencies,X.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),E=E.sibling;return Ur(Zr,Zr.current&1|2),g.child}h=h.sibling}X.tail!==null&&Qr()>Af&&(g.flags|=128,j=!0,Zp(X,!1),g.lanes=4194304)}else{if(!j)if(h=Nc(oe),h!==null){if(g.flags|=128,j=!0,E=h.updateQueue,E!==null&&(g.updateQueue=E,g.flags|=4),Zp(X,!0),X.tail===null&&X.tailMode==="hidden"&&!oe.alternate&&!jr)return Va(g),null}else 2*Qr()-X.renderingStartTime>Af&&E!==1073741824&&(g.flags|=128,j=!0,Zp(X,!1),g.lanes=4194304);X.isBackwards?(oe.sibling=g.child,g.child=oe):(E=X.last,E!==null?E.sibling=oe:g.child=oe,X.last=oe)}return X.tail!==null?(g=X.tail,X.rendering=g,X.tail=g.sibling,X.renderingStartTime=Qr(),g.sibling=null,E=Zr.current,Ur(Zr,j?E&1|2:E&1),g):(Va(g),null);case 22:case 23:return m1(),j=g.memoizedState!==null,h!==null&&h.memoizedState!==null!==j&&(g.flags|=8192),j&&(g.mode&1)!==0?(Ks&1073741824)!==0&&(Va(g),g.subtreeFlags&6&&(g.flags|=8192)):Va(g),null;case 24:return null;case 25:return null}throw Error(n(156,g.tag))}function Dj(h,g){switch(gi(g),g.tag){case 1:return Fi(g.type)&&xc(),h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 3:return dn(),Kr(zi),Kr(Ei),Vi(),h=g.flags,(h&65536)!==0&&(h&128)===0?(g.flags=h&-65537|128,g):null;case 5:return tl(g),null;case 13:if(Kr(Zr),h=g.memoizedState,h!==null&&h.dehydrated!==null){if(g.alternate===null)throw Error(n(340));Nu()}return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 19:return Kr(Zr),null;case 4:return dn(),null;case 10:return gf(g.type._context),null;case 22:case 23:return m1(),null;case 24:return null;default:return null}}var Bv=!1,Ua=!1,Ij=typeof WeakSet=="function"?WeakSet:Set,Nt=null;function Pf(h,g){var E=h.ref;if(E!==null)if(typeof E=="function")try{E(null)}catch(j){qn(h,g,j)}else E.current=null}function n1(h,g,E){try{E()}catch(j){qn(h,g,j)}}var nk=!1;function Bj(h,g){if(pt=fu,h=En(),Tl(h)){if("selectionStart"in h)var E={start:h.selectionStart,end:h.selectionEnd};else e:{E=(E=h.ownerDocument)&&E.defaultView||window;var j=E.getSelection&&E.getSelection();if(j&&j.rangeCount!==0){E=j.anchorNode;var H=j.anchorOffset,X=j.focusNode;j=j.focusOffset;try{E.nodeType,X.nodeType}catch{E=null;break e}var oe=0,we=-1,ke=-1,Be=0,Xe=0,tt=h,Ye=null;t:for(;;){for(var _t;tt!==E||H!==0&&tt.nodeType!==3||(we=oe+H),tt!==X||j!==0&&tt.nodeType!==3||(ke=oe+j),tt.nodeType===3&&(oe+=tt.nodeValue.length),(_t=tt.firstChild)!==null;)Ye=tt,tt=_t;for(;;){if(tt===h)break t;if(Ye===E&&++Be===H&&(we=oe),Ye===X&&++Xe===j&&(ke=oe),(_t=tt.nextSibling)!==null)break;tt=Ye,Ye=tt.parentNode}tt=_t}E=we===-1||ke===-1?null:{start:we,end:ke}}else E=null}E=E||{start:0,end:0}}else E=null;for(It={focusedElem:h,selectionRange:E},fu=!1,Nt=g;Nt!==null;)if(g=Nt,h=g.child,(g.subtreeFlags&1028)!==0&&h!==null)h.return=g,Nt=h;else for(;Nt!==null;){g=Nt;try{var Pt=g.alternate;if((g.flags&1024)!==0)switch(g.tag){case 0:case 11:case 15:break;case 1:if(Pt!==null){var At=Pt.memoizedProps,si=Pt.memoizedState,je=g.stateNode,Ee=je.getSnapshotBeforeUpdate(g.elementType===g.type?At:Ni(g.type,At),si);je.__reactInternalSnapshotBeforeUpdate=Ee}break;case 3:var Le=g.stateNode.containerInfo;Le.nodeType===1?Le.textContent="":Le.nodeType===9&&Le.documentElement&&Le.removeChild(Le.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(st){qn(g,g.return,st)}if(h=g.sibling,h!==null){h.return=g.return,Nt=h;break}Nt=g.return}return Pt=nk,nk=!1,Pt}function Yp(h,g,E){var j=g.updateQueue;if(j=j!==null?j.lastEffect:null,j!==null){var H=j=j.next;do{if((H.tag&h)===h){var X=H.destroy;H.destroy=void 0,X!==void 0&&n1(g,E,X)}H=H.next}while(H!==j)}}function zv(h,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var E=g=g.next;do{if((E.tag&h)===h){var j=E.create;E.destroy=j()}E=E.next}while(E!==g)}}function i1(h){var g=h.ref;if(g!==null){var E=h.stateNode;h.tag,h=E,typeof g=="function"?g(h):g.current=h}}function ik(h){var g=h.alternate;g!==null&&(h.alternate=null,ik(g)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(g=h.stateNode,g!==null&&(delete g[za],delete g[jl],delete g[Yo],delete g[of],delete g[lf])),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function ak(h){return h.tag===5||h.tag===3||h.tag===4}function sk(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||ak(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function a1(h,g,E){var j=h.tag;if(j===5||j===6)h=h.stateNode,g?E.nodeType===8?E.parentNode.insertBefore(h,g):E.insertBefore(h,g):(E.nodeType===8?(g=E.parentNode,g.insertBefore(h,E)):(g=E,g.appendChild(h)),E=E._reactRootContainer,E!=null||g.onclick!==null||(g.onclick=$e));else if(j!==4&&(h=h.child,h!==null))for(a1(h,g,E),h=h.sibling;h!==null;)a1(h,g,E),h=h.sibling}function s1(h,g,E){var j=h.tag;if(j===5||j===6)h=h.stateNode,g?E.insertBefore(h,g):E.appendChild(h);else if(j!==4&&(h=h.child,h!==null))for(s1(h,g,E),h=h.sibling;h!==null;)s1(h,g,E),h=h.sibling}var xa=null,il=!1;function Ic(h,g,E){for(E=E.child;E!==null;)ok(h,g,E),E=E.sibling}function ok(h,g,E){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(na,E)}catch{}switch(E.tag){case 5:Ua||Pf(E,g);case 6:var j=xa,H=il;xa=null,Ic(h,g,E),xa=j,il=H,xa!==null&&(il?(h=xa,E=E.stateNode,h.nodeType===8?h.parentNode.removeChild(E):h.removeChild(E)):xa.removeChild(E.stateNode));break;case 18:xa!==null&&(il?(h=xa,E=E.stateNode,h.nodeType===8?yc(h.parentNode,E):h.nodeType===1&&yc(h,E),Sn(h)):yc(xa,E.stateNode));break;case 4:j=xa,H=il,xa=E.stateNode.containerInfo,il=!0,Ic(h,g,E),xa=j,il=H;break;case 0:case 11:case 14:case 15:if(!Ua&&(j=E.updateQueue,j!==null&&(j=j.lastEffect,j!==null))){H=j=j.next;do{var X=H,oe=X.destroy;X=X.tag,oe!==void 0&&((X&2)!==0||(X&4)!==0)&&n1(E,g,oe),H=H.next}while(H!==j)}Ic(h,g,E);break;case 1:if(!Ua&&(Pf(E,g),j=E.stateNode,typeof j.componentWillUnmount=="function"))try{j.props=E.memoizedProps,j.state=E.memoizedState,j.componentWillUnmount()}catch(we){qn(E,g,we)}Ic(h,g,E);break;case 21:Ic(h,g,E);break;case 22:E.mode&1?(Ua=(j=Ua)||E.memoizedState!==null,Ic(h,g,E),Ua=j):Ic(h,g,E);break;default:Ic(h,g,E)}}function lk(h){var g=h.updateQueue;if(g!==null){h.updateQueue=null;var E=h.stateNode;E===null&&(E=h.stateNode=new Ij),g.forEach(function(j){var H=$j.bind(null,h,j);E.has(j)||(E.add(j),j.then(H,H))})}}function al(h,g){var E=g.deletions;if(E!==null)for(var j=0;j<E.length;j++){var H=E[j];try{var X=h,oe=g,we=oe;e:for(;we!==null;){switch(we.tag){case 5:xa=we.stateNode,il=!1;break e;case 3:xa=we.stateNode.containerInfo,il=!0;break e;case 4:xa=we.stateNode.containerInfo,il=!0;break e}we=we.return}if(xa===null)throw Error(n(160));ok(X,oe,H),xa=null,il=!1;var ke=H.alternate;ke!==null&&(ke.return=null),H.return=null}catch(Be){qn(H,g,Be)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)uk(g,h),g=g.sibling}function uk(h,g){var E=h.alternate,j=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:if(al(g,h),Hl(h),j&4){try{Yp(3,h,h.return),zv(3,h)}catch(At){qn(h,h.return,At)}try{Yp(5,h,h.return)}catch(At){qn(h,h.return,At)}}break;case 1:al(g,h),Hl(h),j&512&&E!==null&&Pf(E,E.return);break;case 5:if(al(g,h),Hl(h),j&512&&E!==null&&Pf(E,E.return),h.flags&32){var H=h.stateNode;try{wt(H,"")}catch(At){qn(h,h.return,At)}}if(j&4&&(H=h.stateNode,H!=null)){var X=h.memoizedProps,oe=E!==null?E.memoizedProps:X,we=h.type,ke=h.updateQueue;if(h.updateQueue=null,ke!==null)try{we==="input"&&X.type==="radio"&&X.name!=null&&gt(H,X),Re(we,oe);var Be=Re(we,X);for(oe=0;oe<ke.length;oe+=2){var Xe=ke[oe],tt=ke[oe+1];Xe==="style"?ye(H,tt):Xe==="dangerouslySetInnerHTML"?$t(H,tt):Xe==="children"?wt(H,tt):N(H,Xe,tt,Be)}switch(we){case"input":Je(H,X);break;case"textarea":Ke(H,X);break;case"select":var Ye=H._wrapperState.wasMultiple;H._wrapperState.wasMultiple=!!X.multiple;var _t=X.value;_t!=null?et(H,!!X.multiple,_t,!1):Ye!==!!X.multiple&&(X.defaultValue!=null?et(H,!!X.multiple,X.defaultValue,!0):et(H,!!X.multiple,X.multiple?[]:"",!1))}H[jl]=X}catch(At){qn(h,h.return,At)}}break;case 6:if(al(g,h),Hl(h),j&4){if(h.stateNode===null)throw Error(n(162));H=h.stateNode,X=h.memoizedProps;try{H.nodeValue=X}catch(At){qn(h,h.return,At)}}break;case 3:if(al(g,h),Hl(h),j&4&&E!==null&&E.memoizedState.isDehydrated)try{Sn(g.containerInfo)}catch(At){qn(h,h.return,At)}break;case 4:al(g,h),Hl(h);break;case 13:al(g,h),Hl(h),H=h.child,H.flags&8192&&(X=H.memoizedState!==null,H.stateNode.isHidden=X,!X||H.alternate!==null&&H.alternate.memoizedState!==null||(u1=Qr())),j&4&&lk(h);break;case 22:if(Xe=E!==null&&E.memoizedState!==null,h.mode&1?(Ua=(Be=Ua)||Xe,al(g,h),Ua=Be):al(g,h),Hl(h),j&8192){if(Be=h.memoizedState!==null,(h.stateNode.isHidden=Be)&&!Xe&&(h.mode&1)!==0)for(Nt=h,Xe=h.child;Xe!==null;){for(tt=Nt=Xe;Nt!==null;){switch(Ye=Nt,_t=Ye.child,Ye.tag){case 0:case 11:case 14:case 15:Yp(4,Ye,Ye.return);break;case 1:Pf(Ye,Ye.return);var Pt=Ye.stateNode;if(typeof Pt.componentWillUnmount=="function"){j=Ye,E=Ye.return;try{g=j,Pt.props=g.memoizedProps,Pt.state=g.memoizedState,Pt.componentWillUnmount()}catch(At){qn(j,E,At)}}break;case 5:Pf(Ye,Ye.return);break;case 22:if(Ye.memoizedState!==null){hk(tt);continue}}_t!==null?(_t.return=Ye,Nt=_t):hk(tt)}Xe=Xe.sibling}e:for(Xe=null,tt=h;;){if(tt.tag===5){if(Xe===null){Xe=tt;try{H=tt.stateNode,Be?(X=H.style,typeof X.setProperty=="function"?X.setProperty("display","none","important"):X.display="none"):(we=tt.stateNode,ke=tt.memoizedProps.style,oe=ke!=null&&ke.hasOwnProperty("display")?ke.display:null,we.style.display=de("display",oe))}catch(At){qn(h,h.return,At)}}}else if(tt.tag===6){if(Xe===null)try{tt.stateNode.nodeValue=Be?"":tt.memoizedProps}catch(At){qn(h,h.return,At)}}else if((tt.tag!==22&&tt.tag!==23||tt.memoizedState===null||tt===h)&&tt.child!==null){tt.child.return=tt,tt=tt.child;continue}if(tt===h)break e;for(;tt.sibling===null;){if(tt.return===null||tt.return===h)break e;Xe===tt&&(Xe=null),tt=tt.return}Xe===tt&&(Xe=null),tt.sibling.return=tt.return,tt=tt.sibling}}break;case 19:al(g,h),Hl(h),j&4&&lk(h);break;case 21:break;default:al(g,h),Hl(h)}}function Hl(h){var g=h.flags;if(g&2){try{e:{for(var E=h.return;E!==null;){if(ak(E)){var j=E;break e}E=E.return}throw Error(n(160))}switch(j.tag){case 5:var H=j.stateNode;j.flags&32&&(wt(H,""),j.flags&=-33);var X=sk(h);s1(h,X,H);break;case 3:case 4:var oe=j.stateNode.containerInfo,we=sk(h);a1(h,we,oe);break;default:throw Error(n(161))}}catch(ke){qn(h,h.return,ke)}h.flags&=-3}g&4096&&(h.flags&=-4097)}function zj(h,g,E){Nt=h,ck(h)}function ck(h,g,E){for(var j=(h.mode&1)!==0;Nt!==null;){var H=Nt,X=H.child;if(H.tag===22&&j){var oe=H.memoizedState!==null||Bv;if(!oe){var we=H.alternate,ke=we!==null&&we.memoizedState!==null||Ua;we=Bv;var Be=Ua;if(Bv=oe,(Ua=ke)&&!Be)for(Nt=H;Nt!==null;)oe=Nt,ke=oe.child,oe.tag===22&&oe.memoizedState!==null?fk(H):ke!==null?(ke.return=oe,Nt=ke):fk(H);for(;X!==null;)Nt=X,ck(X),X=X.sibling;Nt=H,Bv=we,Ua=Be}dk(h)}else(H.subtreeFlags&8772)!==0&&X!==null?(X.return=H,Nt=X):dk(h)}}function dk(h){for(;Nt!==null;){var g=Nt;if((g.flags&8772)!==0){var E=g.alternate;try{if((g.flags&8772)!==0)switch(g.tag){case 0:case 11:case 15:Ua||zv(5,g);break;case 1:var j=g.stateNode;if(g.flags&4&&!Ua)if(E===null)j.componentDidMount();else{var H=g.elementType===g.type?E.memoizedProps:Ni(g.type,E.memoizedProps);j.componentDidUpdate(H,E.memoizedState,j.__reactInternalSnapshotBeforeUpdate)}var X=g.updateQueue;X!==null&&Pn(g,X,j);break;case 3:var oe=g.updateQueue;if(oe!==null){if(E=null,g.child!==null)switch(g.child.tag){case 5:E=g.child.stateNode;break;case 1:E=g.child.stateNode}Pn(g,oe,E)}break;case 5:var we=g.stateNode;if(E===null&&g.flags&4){E=we;var ke=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":ke.autoFocus&&E.focus();break;case"img":ke.src&&(E.src=ke.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(g.memoizedState===null){var Be=g.alternate;if(Be!==null){var Xe=Be.memoizedState;if(Xe!==null){var tt=Xe.dehydrated;tt!==null&&Sn(tt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Ua||g.flags&512&&i1(g)}catch(Ye){qn(g,g.return,Ye)}}if(g===h){Nt=null;break}if(E=g.sibling,E!==null){E.return=g.return,Nt=E;break}Nt=g.return}}function hk(h){for(;Nt!==null;){var g=Nt;if(g===h){Nt=null;break}var E=g.sibling;if(E!==null){E.return=g.return,Nt=E;break}Nt=g.return}}function fk(h){for(;Nt!==null;){var g=Nt;try{switch(g.tag){case 0:case 11:case 15:var E=g.return;try{zv(4,g)}catch(ke){qn(g,E,ke)}break;case 1:var j=g.stateNode;if(typeof j.componentDidMount=="function"){var H=g.return;try{j.componentDidMount()}catch(ke){qn(g,H,ke)}}var X=g.return;try{i1(g)}catch(ke){qn(g,X,ke)}break;case 5:var oe=g.return;try{i1(g)}catch(ke){qn(g,oe,ke)}}}catch(ke){qn(g,g.return,ke)}if(g===h){Nt=null;break}var we=g.sibling;if(we!==null){we.return=g.return,Nt=we;break}Nt=g.return}}var Fj=Math.ceil,Fv=P.ReactCurrentDispatcher,o1=P.ReactCurrentOwner,bo=P.ReactCurrentBatchConfig,wr=0,qi=null,vi=null,ba=0,Ks=0,Mf=Qo(0),Ti=0,Xp=null,oh=0,Vv=0,l1=0,Qp=null,ks=null,u1=0,Af=1/0,ju=null,Uv=!1,c1=null,Bc=null,Hv=!1,zc=null,Gv=0,Jp=0,d1=null,qv=-1,Wv=0;function ls(){return(wr&6)!==0?Qr():qv!==-1?qv:qv=Qr()}function Fc(h){return(h.mode&1)===0?1:(wr&2)!==0&&ba!==0?ba&-ba:zp.transition!==null?(Wv===0&&(Wv=Fd()),Wv):(h=nr,h!==0||(h=window.event,h=h===void 0?16:or(h.type)),h)}function sl(h,g,E,j){if(50<Jp)throw Jp=0,d1=null,Error(n(185));Za(h,E,j),((wr&2)===0||h!==qi)&&(h===qi&&((wr&2)===0&&(Vv|=E),Ti===4&&Vc(h,ba)),Cs(h,j),E===1&&wr===0&&(g.mode&1)===0&&(Af=Qr()+500,bc&&Ll()))}function Cs(h,g){var E=h.callbackNode;du(h,g);var j=xr(h,h===qi?ba:0);if(j===0)E!==null&&uu(E),h.callbackNode=null,h.callbackPriority=0;else if(g=j&-j,h.callbackPriority!==g){if(E!=null&&uu(E),g===1)h.tag===0?Jo(mk.bind(null,h)):Qd(mk.bind(null,h)),Ci(function(){(wr&6)===0&&Ll()}),E=null;else{switch(Fs(j)){case 1:E=Bs;break;case 4:E=ml;break;case 16:E=Aa;break;case 536870912:E=ra;break;default:E=Aa}E=Sk(E,pk.bind(null,h))}h.callbackPriority=g,h.callbackNode=E}}function pk(h,g){if(qv=-1,Wv=0,(wr&6)!==0)throw Error(n(327));var E=h.callbackNode;if(jf()&&h.callbackNode!==E)return null;var j=xr(h,h===qi?ba:0);if(j===0)return null;if((j&30)!==0||(j&h.expiredLanes)!==0||g)g=$v(h,j);else{g=j;var H=wr;wr|=2;var X=vk();(qi!==h||ba!==g)&&(ju=null,Af=Qr()+500,uh(h,g));do try{Hj();break}catch(we){gk(h,we)}while(!0);mf(),Fv.current=X,wr=H,vi!==null?g=0:(qi=null,ba=0,g=Ti)}if(g!==0){if(g===2&&(H=Qn(h),H!==0&&(j=H,g=h1(h,H))),g===1)throw E=Xp,uh(h,0),Vc(h,j),Cs(h,Qr()),E;if(g===6)Vc(h,j);else{if(H=h.current.alternate,(j&30)===0&&!Vj(H)&&(g=$v(h,j),g===2&&(X=Qn(h),X!==0&&(j=X,g=h1(h,X))),g===1))throw E=Xp,uh(h,0),Vc(h,j),Cs(h,Qr()),E;switch(h.finishedWork=H,h.finishedLanes=j,g){case 0:case 1:throw Error(n(345));case 2:ch(h,ks,ju);break;case 3:if(Vc(h,j),(j&130023424)===j&&(g=u1+500-Qr(),10<g)){if(xr(h,0)!==0)break;if(H=h.suspendedLanes,(H&j)!==j){ls(),h.pingedLanes|=h.suspendedLanes&H;break}h.timeoutHandle=Ar(ch.bind(null,h,ks,ju),g);break}ch(h,ks,ju);break;case 4:if(Vc(h,j),(j&4194240)===j)break;for(g=h.eventTimes,H=-1;0<j;){var oe=31-lt(j);X=1<<oe,oe=g[oe],oe>H&&(H=oe),j&=~X}if(j=H,j=Qr()-j,j=(120>j?120:480>j?480:1080>j?1080:1920>j?1920:3e3>j?3e3:4320>j?4320:1960*Fj(j/1960))-j,10<j){h.timeoutHandle=Ar(ch.bind(null,h,ks,ju),j);break}ch(h,ks,ju);break;case 5:ch(h,ks,ju);break;default:throw Error(n(329))}}}return Cs(h,Qr()),h.callbackNode===E?pk.bind(null,h):null}function h1(h,g){var E=Qp;return h.current.memoizedState.isDehydrated&&(uh(h,g).flags|=256),h=$v(h,g),h!==2&&(g=ks,ks=E,g!==null&&f1(g)),h}function f1(h){ks===null?ks=h:ks.push.apply(ks,h)}function Vj(h){for(var g=h;;){if(g.flags&16384){var E=g.updateQueue;if(E!==null&&(E=E.stores,E!==null))for(var j=0;j<E.length;j++){var H=E[j],X=H.getSnapshot;H=H.value;try{if(!Ii(X(),H))return!1}catch{return!1}}}if(E=g.child,g.subtreeFlags&16384&&E!==null)E.return=g,g=E;else{if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Vc(h,g){for(g&=~l1,g&=~Vv,h.suspendedLanes|=g,h.pingedLanes&=~g,h=h.expirationTimes;0<g;){var E=31-lt(g),j=1<<E;h[E]=-1,g&=~j}}function mk(h){if((wr&6)!==0)throw Error(n(327));jf();var g=xr(h,0);if((g&1)===0)return Cs(h,Qr()),null;var E=$v(h,g);if(h.tag!==0&&E===2){var j=Qn(h);j!==0&&(g=j,E=h1(h,j))}if(E===1)throw E=Xp,uh(h,0),Vc(h,g),Cs(h,Qr()),E;if(E===6)throw Error(n(345));return h.finishedWork=h.current.alternate,h.finishedLanes=g,ch(h,ks,ju),Cs(h,Qr()),null}function p1(h,g){var E=wr;wr|=1;try{return h(g)}finally{wr=E,wr===0&&(Af=Qr()+500,bc&&Ll())}}function lh(h){zc!==null&&zc.tag===0&&(wr&6)===0&&jf();var g=wr;wr|=1;var E=bo.transition,j=nr;try{if(bo.transition=null,nr=1,h)return h()}finally{nr=j,bo.transition=E,wr=g,(wr&6)===0&&Ll()}}function m1(){Ks=Mf.current,Kr(Mf)}function uh(h,g){h.finishedWork=null,h.finishedLanes=0;var E=h.timeoutHandle;if(E!==-1&&(h.timeoutHandle=-1,Nn(E)),vi!==null)for(E=vi.return;E!==null;){var j=E;switch(gi(j),j.tag){case 1:j=j.type.childContextTypes,j!=null&&xc();break;case 3:dn(),Kr(zi),Kr(Ei),Vi();break;case 5:tl(j);break;case 4:dn();break;case 13:Kr(Zr);break;case 19:Kr(Zr);break;case 10:gf(j.type._context);break;case 22:case 23:m1()}E=E.return}if(qi=h,vi=h=Uc(h.current,null),ba=Ks=g,Ti=0,Xp=null,l1=Vv=oh=0,ks=Qp=null,mo!==null){for(g=0;g<mo.length;g++)if(E=mo[g],j=E.interleaved,j!==null){E.interleaved=null;var H=j.next,X=E.pending;if(X!==null){var oe=X.next;X.next=H,j.next=oe}E.pending=j}mo=null}return h}function gk(h,g){do{var E=vi;try{if(mf(),Tc.current=Rc,$s){for(var j=Ir.memoizedState;j!==null;){var H=j.queue;H!==null&&(H.pending=null),j=j.next}$s=!1}if(va=0,Hn=Mn=Ir=null,zl=!1,Ss=0,o1.current=null,E===null||E.return===null){Ti=1,Xp=g,vi=null;break}e:{var X=h,oe=E.return,we=E,ke=g;if(g=ba,we.flags|=32768,ke!==null&&typeof ke=="object"&&typeof ke.then=="function"){var Be=ke,Xe=we,tt=Xe.tag;if((Xe.mode&1)===0&&(tt===0||tt===11||tt===15)){var Ye=Xe.alternate;Ye?(Xe.updateQueue=Ye.updateQueue,Xe.memoizedState=Ye.memoizedState,Xe.lanes=Ye.lanes):(Xe.updateQueue=null,Xe.memoizedState=null)}var _t=A(oe);if(_t!==null){_t.flags&=-257,F(_t,oe,we,X,g),_t.mode&1&&w(X,Be,g),g=_t,ke=Be;var Pt=g.updateQueue;if(Pt===null){var At=new Set;At.add(ke),g.updateQueue=At}else Pt.add(ke);break e}else{if((g&1)===0){w(X,Be,g),g1();break e}ke=Error(n(426))}}else if(jr&&we.mode&1){var si=A(oe);if(si!==null){(si.flags&65536)===0&&(si.flags|=256),F(si,oe,we,X,g),eh(Au(ke,we));break e}}X=ke=Au(ke,we),Ti!==4&&(Ti=2),Qp===null?Qp=[X]:Qp.push(X),X=oe;do{switch(X.tag){case 3:X.flags|=65536,g&=-g,X.lanes|=g;var je=Iv(X,ke,g);ih(X,je);break e;case 1:we=ke;var Ee=X.type,Le=X.stateNode;if((X.flags&128)===0&&(typeof Ee.getDerivedStateFromError=="function"||Le!==null&&typeof Le.componentDidCatch=="function"&&(Bc===null||!Bc.has(Le)))){X.flags|=65536,g&=-g,X.lanes|=g;var st=x(X,we,g);ih(X,st);break e}}X=X.return}while(X!==null)}xk(E)}catch(jt){g=jt,vi===E&&E!==null&&(vi=E=E.return);continue}break}while(!0)}function vk(){var h=Fv.current;return Fv.current=Rc,h===null?Rc:h}function g1(){(Ti===0||Ti===3||Ti===2)&&(Ti=4),qi===null||(oh&268435455)===0&&(Vv&268435455)===0||Vc(qi,ba)}function $v(h,g){var E=wr;wr|=2;var j=vk();(qi!==h||ba!==g)&&(ju=null,uh(h,g));do try{Uj();break}catch(H){gk(h,H)}while(!0);if(mf(),wr=E,Fv.current=j,vi!==null)throw Error(n(261));return qi=null,ba=0,Ti}function Uj(){for(;vi!==null;)yk(vi)}function Hj(){for(;vi!==null&&!zd();)yk(vi)}function yk(h){var g=_k(h.alternate,h,Ks);h.memoizedProps=h.pendingProps,g===null?xk(h):vi=g,o1.current=null}function xk(h){var g=h;do{var E=g.alternate;if(h=g.return,(g.flags&32768)===0){if(E=Oj(E,g,Ks),E!==null){vi=E;return}}else{if(E=Dj(E,g),E!==null){E.flags&=32767,vi=E;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{Ti=6,vi=null;return}}if(g=g.sibling,g!==null){vi=g;return}vi=g=h}while(g!==null);Ti===0&&(Ti=5)}function ch(h,g,E){var j=nr,H=bo.transition;try{bo.transition=null,nr=1,Gj(h,g,E,j)}finally{bo.transition=H,nr=j}return null}function Gj(h,g,E,j){do jf();while(zc!==null);if((wr&6)!==0)throw Error(n(327));E=h.finishedWork;var H=h.finishedLanes;if(E===null)return null;if(h.finishedWork=null,h.finishedLanes=0,E===h.current)throw Error(n(177));h.callbackNode=null,h.callbackPriority=0;var X=E.lanes|E.childLanes;if(wn(h,X),h===qi&&(vi=qi=null,ba=0),(E.subtreeFlags&2064)===0&&(E.flags&2064)===0||Hv||(Hv=!0,Sk(Aa,function(){return jf(),null})),X=(E.flags&15990)!==0,(E.subtreeFlags&15990)!==0||X){X=bo.transition,bo.transition=null;var oe=nr;nr=1;var we=wr;wr|=4,o1.current=null,Bj(h,E),uk(E,h),Bi(It),fu=!!pt,It=pt=null,h.current=E,zj(E),pl(),wr=we,nr=oe,bo.transition=X}else h.current=E;if(Hv&&(Hv=!1,zc=h,Gv=H),X=h.pendingLanes,X===0&&(Bc=null),yr(E.stateNode),Cs(h,Qr()),g!==null)for(j=h.onRecoverableError,E=0;E<g.length;E++)H=g[E],j(H.value,{componentStack:H.stack,digest:H.digest});if(Uv)throw Uv=!1,h=c1,c1=null,h;return(Gv&1)!==0&&h.tag!==0&&jf(),X=h.pendingLanes,(X&1)!==0?h===d1?Jp++:(Jp=0,d1=h):Jp=0,Ll(),null}function jf(){if(zc!==null){var h=Fs(Gv),g=bo.transition,E=nr;try{if(bo.transition=null,nr=16>h?16:h,zc===null)var j=!1;else{if(h=zc,zc=null,Gv=0,(wr&6)!==0)throw Error(n(331));var H=wr;for(wr|=4,Nt=h.current;Nt!==null;){var X=Nt,oe=X.child;if((Nt.flags&16)!==0){var we=X.deletions;if(we!==null){for(var ke=0;ke<we.length;ke++){var Be=we[ke];for(Nt=Be;Nt!==null;){var Xe=Nt;switch(Xe.tag){case 0:case 11:case 15:Yp(8,Xe,X)}var tt=Xe.child;if(tt!==null)tt.return=Xe,Nt=tt;else for(;Nt!==null;){Xe=Nt;var Ye=Xe.sibling,_t=Xe.return;if(ik(Xe),Xe===Be){Nt=null;break}if(Ye!==null){Ye.return=_t,Nt=Ye;break}Nt=_t}}}var Pt=X.alternate;if(Pt!==null){var At=Pt.child;if(At!==null){Pt.child=null;do{var si=At.sibling;At.sibling=null,At=si}while(At!==null)}}Nt=X}}if((X.subtreeFlags&2064)!==0&&oe!==null)oe.return=X,Nt=oe;else e:for(;Nt!==null;){if(X=Nt,(X.flags&2048)!==0)switch(X.tag){case 0:case 11:case 15:Yp(9,X,X.return)}var je=X.sibling;if(je!==null){je.return=X.return,Nt=je;break e}Nt=X.return}}var Ee=h.current;for(Nt=Ee;Nt!==null;){oe=Nt;var Le=oe.child;if((oe.subtreeFlags&2064)!==0&&Le!==null)Le.return=oe,Nt=Le;else e:for(oe=Ee;Nt!==null;){if(we=Nt,(we.flags&2048)!==0)try{switch(we.tag){case 0:case 11:case 15:zv(9,we)}}catch(jt){qn(we,we.return,jt)}if(we===oe){Nt=null;break e}var st=we.sibling;if(st!==null){st.return=we.return,Nt=st;break e}Nt=we.return}}if(wr=H,Ll(),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(na,h)}catch{}j=!0}return j}finally{nr=E,bo.transition=g}}return!1}function bk(h,g,E){g=Au(E,g),g=Iv(h,g,1),h=yo(h,g,1),g=ls(),h!==null&&(Za(h,1,g),Cs(h,g))}function qn(h,g,E){if(h.tag===3)bk(h,h,E);else for(;g!==null;){if(g.tag===3){bk(g,h,E);break}else if(g.tag===1){var j=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(Bc===null||!Bc.has(j))){h=Au(E,h),h=x(g,h,1),g=yo(g,h,1),h=ls(),g!==null&&(Za(g,1,h),Cs(g,h));break}}g=g.return}}function qj(h,g,E){var j=h.pingCache;j!==null&&j.delete(g),g=ls(),h.pingedLanes|=h.suspendedLanes&E,qi===h&&(ba&E)===E&&(Ti===4||Ti===3&&(ba&130023424)===ba&&500>Qr()-u1?uh(h,0):l1|=E),Cs(h,g)}function wk(h,g){g===0&&((h.mode&1)===0?g=1:(g=ia,ia<<=1,(ia&130023424)===0&&(ia=4194304)));var E=ls();h=as(h,g),h!==null&&(Za(h,g,E),Cs(h,E))}function Wj(h){var g=h.memoizedState,E=0;g!==null&&(E=g.retryLane),wk(h,E)}function $j(h,g){var E=0;switch(h.tag){case 13:var j=h.stateNode,H=h.memoizedState;H!==null&&(E=H.retryLane);break;case 19:j=h.stateNode;break;default:throw Error(n(314))}j!==null&&j.delete(g),wk(h,E)}var _k;_k=function(h,g,E){if(h!==null)if(h.memoizedProps!==g.pendingProps||zi.current)te=!0;else{if((h.lanes&E)===0&&(g.flags&128)===0)return te=!1,t1(h,g,E);te=(h.flags&131072)!==0}else te=!1,jr&&(g.flags&1048576)!==0&&Ev(g,Dl,g.index);switch(g.lanes=0,g.tag){case 2:var j=g.type;mr(h,g),h=g.pendingProps;var H=_u(g,Ei.current);el(g,E),H=Pc(null,g,j,h,H,E);var X=Mc();return g.flags|=1,typeof H=="object"&&H!==null&&typeof H.render=="function"&&H.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Fi(j)?(X=!0,Su(g)):X=!1,g.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,nh(g),H.updater=Oc,g.stateNode=H,H._reactInternals=g,Nf(g,j,h,E),g=Rr(null,g,j,!0,X,E)):(g.tag=0,jr&&X&&wc(g),fe(null,g,H,E),g=g.child),g;case 16:j=g.elementType;e:{switch(mr(h,g),h=g.pendingProps,H=j._init,j=H(j._payload),g.type=j,H=g.tag=Zj(j),h=Ni(j,h),H){case 0:g=mt(null,g,j,h,E);break e;case 1:g=Yr(null,g,j,h,E);break e;case 11:g=Pe(null,g,j,h,E);break e;case 14:g=Fe(null,g,j,Ni(j.type,h),E);break e}throw Error(n(306,j,""))}return g;case 0:return j=g.type,H=g.pendingProps,H=g.elementType===j?H:Ni(j,H),mt(h,g,j,H,E);case 1:return j=g.type,H=g.pendingProps,H=g.elementType===j?H:Ni(j,H),Yr(h,g,j,H,E);case 3:e:{if(ya(g),h===null)throw Error(n(387));j=g.pendingProps,X=g.memoizedState,H=X.element,yf(h,g),Cc(g,j,null,E);var oe=g.memoizedState;if(j=oe.element,X.isDehydrated)if(X={element:j,isDehydrated:!1,cache:oe.cache,pendingSuspenseBoundaries:oe.pendingSuspenseBoundaries,transitions:oe.transitions},g.updateQueue.baseState=X,g.memoizedState=X,g.flags&256){H=Au(Error(n(423)),g),g=xo(h,g,j,E,H);break e}else if(j!==H){H=Au(Error(n(424)),g),g=xo(h,g,j,E,H);break e}else for(dt=ws(g.stateNode.containerInfo.firstChild),rs=g,jr=!0,ns=null,E=_s(g,null,j,E),g.child=E;E;)E.flags=E.flags&-3|4096,E=E.sibling;else{if(Nu(),j===H){g=Gi(h,g,E);break e}fe(h,g,j,E)}g=g.child}return g;case 5:return Ec(g),h===null&&_c(g),j=g.type,H=g.pendingProps,X=h!==null?h.memoizedProps:null,oe=H.children,Jt(j,H)?oe=null:X!==null&&Jt(j,X)&&(g.flags|=32),Zt(h,g),fe(h,g,oe,E),g.child;case 6:return h===null&&_c(g),null;case 13:return He(h,g,E);case 4:return Bl(g,g.stateNode.containerInfo),j=g.pendingProps,h===null?g.child=Tu(g,null,j,E):fe(h,g,j,E),g.child;case 11:return j=g.type,H=g.pendingProps,H=g.elementType===j?H:Ni(j,H),Pe(h,g,j,H,E);case 7:return fe(h,g,g.pendingProps,E),g.child;case 8:return fe(h,g,g.pendingProps.children,E),g.child;case 12:return fe(h,g,g.pendingProps.children,E),g.child;case 10:e:{if(j=g.type._context,H=g.pendingProps,X=g.memoizedProps,oe=H.value,Ur(th,j._currentValue),j._currentValue=oe,X!==null)if(Ii(X.value,oe)){if(X.children===H.children&&!zi.current){g=Gi(h,g,E);break e}}else for(X=g.child,X!==null&&(X.return=g);X!==null;){var we=X.dependencies;if(we!==null){oe=X.child;for(var ke=we.firstContext;ke!==null;){if(ke.context===j){if(X.tag===1){ke=vo(-1,E&-E),ke.tag=2;var Be=X.updateQueue;if(Be!==null){Be=Be.shared;var Xe=Be.pending;Xe===null?ke.next=ke:(ke.next=Xe.next,Xe.next=ke),Be.pending=ke}}X.lanes|=E,ke=X.alternate,ke!==null&&(ke.lanes|=E),vf(X.return,E,g),we.lanes|=E;break}ke=ke.next}}else if(X.tag===10)oe=X.type===g.type?null:X.child;else if(X.tag===18){if(oe=X.return,oe===null)throw Error(n(341));oe.lanes|=E,we=oe.alternate,we!==null&&(we.lanes|=E),vf(oe,E,g),oe=X.sibling}else oe=X.child;if(oe!==null)oe.return=X;else for(oe=X;oe!==null;){if(oe===g){oe=null;break}if(X=oe.sibling,X!==null){X.return=oe.return,oe=X;break}oe=oe.return}X=oe}fe(h,g,H.children,E),g=g.child}return g;case 9:return H=g.type,j=g.pendingProps.children,el(g,E),H=ga(H),j=j(H),g.flags|=1,fe(h,g,j,E),g.child;case 14:return j=g.type,H=Ni(j,g.pendingProps),H=Ni(j.type,H),Fe(h,g,j,H,E);case 15:return it(h,g,g.type,g.pendingProps,E);case 17:return j=g.type,H=g.pendingProps,H=g.elementType===j?H:Ni(j,H),mr(h,g),g.tag=1,Fi(j)?(h=!0,Su(g)):h=!1,el(g,E),Dv(g,j,H),Nf(g,j,H,E),Rr(null,g,j,!0,h,E);case 19:return ai(h,g,E);case 22:return Ct(h,g,E)}throw Error(n(156,g.tag))};function Sk(h,g){return lu(h,g)}function Kj(h,g,E,j){this.tag=h,this.key=E,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wo(h,g,E,j){return new Kj(h,g,E,j)}function v1(h){return h=h.prototype,!(!h||!h.isReactComponent)}function Zj(h){if(typeof h=="function")return v1(h)?1:0;if(h!=null){if(h=h.$$typeof,h===Y)return 11;if(h===G)return 14}return 2}function Uc(h,g){var E=h.alternate;return E===null?(E=wo(h.tag,g,h.key,h.mode),E.elementType=h.elementType,E.type=h.type,E.stateNode=h.stateNode,E.alternate=h,h.alternate=E):(E.pendingProps=g,E.type=h.type,E.flags=0,E.subtreeFlags=0,E.deletions=null),E.flags=h.flags&14680064,E.childLanes=h.childLanes,E.lanes=h.lanes,E.child=h.child,E.memoizedProps=h.memoizedProps,E.memoizedState=h.memoizedState,E.updateQueue=h.updateQueue,g=h.dependencies,E.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},E.sibling=h.sibling,E.index=h.index,E.ref=h.ref,E}function Kv(h,g,E,j,H,X){var oe=2;if(j=h,typeof h=="function")v1(h)&&(oe=1);else if(typeof h=="string")oe=5;else e:switch(h){case B:return dh(E.children,H,X,g);case I:oe=8,H|=8;break;case z:return h=wo(12,E,g,H|2),h.elementType=z,h.lanes=X,h;case D:return h=wo(13,E,g,H),h.elementType=D,h.lanes=X,h;case q:return h=wo(19,E,g,H),h.elementType=q,h.lanes=X,h;case Q:return Zv(E,H,X,g);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case V:oe=10;break e;case $:oe=9;break e;case Y:oe=11;break e;case G:oe=14;break e;case Z:oe=16,j=null;break e}throw Error(n(130,h==null?h:typeof h,""))}return g=wo(oe,E,g,H),g.elementType=h,g.type=j,g.lanes=X,g}function dh(h,g,E,j){return h=wo(7,h,j,g),h.lanes=E,h}function Zv(h,g,E,j){return h=wo(22,h,j,g),h.elementType=Q,h.lanes=E,h.stateNode={isHidden:!1},h}function y1(h,g,E){return h=wo(6,h,null,g),h.lanes=E,h}function x1(h,g,E){return g=wo(4,h.children!==null?h.children:[],h.key,g),g.lanes=E,g.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},g}function Yj(h,g,E,j,H){this.tag=g,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hi(0),this.expirationTimes=hi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hi(0),this.identifierPrefix=j,this.onRecoverableError=H,this.mutableSourceEagerHydrationData=null}function b1(h,g,E,j,H,X,oe,we,ke){return h=new Yj(h,g,E,we,ke),g===1?(g=1,X===!0&&(g|=8)):g=0,X=wo(3,null,null,g),h.current=X,X.stateNode=h,X.memoizedState={element:j,isDehydrated:E,cache:null,transitions:null,pendingSuspenseBoundaries:null},nh(X),h}function Xj(h,g,E){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:O,key:j==null?null:""+j,children:h,containerInfo:g,implementation:E}}function kk(h){if(!h)return fo;h=h._reactInternals;e:{if(ci(h)!==h||h.tag!==1)throw Error(n(170));var g=h;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Fi(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(n(171))}if(h.tag===1){var E=h.type;if(Fi(E))return cf(h,E,g)}return g}function Ck(h,g,E,j,H,X,oe,we,ke){return h=b1(E,j,!0,h,H,X,oe,we,ke),h.context=kk(null),E=h.current,j=ls(),H=Fc(E),X=vo(j,H),X.callback=g??null,yo(E,X,H),h.current.lanes=H,Za(h,H,j),Cs(h,j),h}function Yv(h,g,E,j){var H=g.current,X=ls(),oe=Fc(H);return E=kk(E),g.context===null?g.context=E:g.pendingContext=E,g=vo(X,oe),g.payload={element:h},j=j===void 0?null:j,j!==null&&(g.callback=j),h=yo(H,g,oe),h!==null&&(sl(h,H,oe,X),xf(h,H,oe)),oe}function Xv(h){return h=h.current,h.child?(h.child.tag===5,h.child.stateNode):null}function Ek(h,g){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var E=h.retryLane;h.retryLane=E!==0&&E<g?E:g}}function w1(h,g){Ek(h,g),(h=h.alternate)&&Ek(h,g)}function Qj(){return null}var Nk=typeof reportError=="function"?reportError:function(h){console.error(h)};function _1(h){this._internalRoot=h}Qv.prototype.render=_1.prototype.render=function(h){var g=this._internalRoot;if(g===null)throw Error(n(409));Yv(h,g,null,null)},Qv.prototype.unmount=_1.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var g=h.containerInfo;lh(function(){Yv(null,h,null,null)}),g[br]=null}};function Qv(h){this._internalRoot=h}Qv.prototype.unstable_scheduleHydration=function(h){if(h){var g=nc();h={blockedOn:null,target:h,priority:g};for(var E=0;E<Dn.length&&g!==0&&g<Dn[E].priority;E++);Dn.splice(E,0,h),E===0&&vl(h)}};function S1(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function Jv(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11&&(h.nodeType!==8||h.nodeValue!==" react-mount-point-unstable "))}function Tk(){}function Jj(h,g,E,j,H){if(H){if(typeof j=="function"){var X=j;j=function(){var Be=Xv(oe);X.call(Be)}}var oe=Ck(g,j,h,0,null,!1,!1,"",Tk);return h._reactRootContainer=oe,h[br]=oe.current,co(h.nodeType===8?h.parentNode:h),lh(),oe}for(;H=h.lastChild;)h.removeChild(H);if(typeof j=="function"){var we=j;j=function(){var Be=Xv(ke);we.call(Be)}}var ke=b1(h,0,!1,null,null,!1,!1,"",Tk);return h._reactRootContainer=ke,h[br]=ke.current,co(h.nodeType===8?h.parentNode:h),lh(function(){Yv(g,ke,E,j)}),ke}function e0(h,g,E,j,H){var X=E._reactRootContainer;if(X){var oe=X;if(typeof H=="function"){var we=H;H=function(){var ke=Xv(oe);we.call(ke)}}Yv(g,oe,h,H)}else oe=Jj(E,g,h,H,j);return Xv(oe)}ro=function(h){switch(h.tag){case 3:var g=h.stateNode;if(g.current.memoizedState.isDehydrated){var E=Mt(g.pendingLanes);E!==0&&(zs(g,E|1),Cs(g,Qr()),(wr&6)===0&&(Af=Qr()+500,Ll()))}break;case 13:lh(function(){var j=as(h,1);if(j!==null){var H=ls();sl(j,h,1,H)}}),w1(h,1)}},ps=function(h){if(h.tag===13){var g=as(h,134217728);if(g!==null){var E=ls();sl(g,h,134217728,E)}w1(h,134217728)}},rc=function(h){if(h.tag===13){var g=Fc(h),E=as(h,g);if(E!==null){var j=ls();sl(E,h,g,j)}w1(h,g)}},nc=function(){return nr},Do=function(h,g){var E=nr;try{return nr=h,g()}finally{nr=E}},ct=function(h,g,E){switch(g){case"input":if(Je(h,E),g=E.name,E.type==="radio"&&g!=null){for(E=h;E.parentNode;)E=E.parentNode;for(E=E.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<E.length;g++){var j=E[g];if(j!==h&&j.form===h.form){var H=Un(j);if(!H)throw Error(n(90));be(j),Je(j,H)}}}break;case"textarea":Ke(h,E);break;case"select":g=E.value,g!=null&&et(h,!!E.multiple,g,!1)}},Gt=p1,Wt=lh;var eR={usingClientEntryPoint:!1,Events:[Xo,Tn,Un,Ft,xt,p1]},em={findFiberByHostInstance:ho,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tR={bundleType:em.bundleType,version:em.version,rendererPackageName:em.rendererPackageName,rendererConfig:em.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(h){return h=to(h),h===null?null:h.stateNode},findFiberByHostInstance:em.findFiberByHostInstance||Qj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var t0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!t0.isDisabled&&t0.supportsFiber)try{na=t0.inject(tR),mn=t0}catch{}}return Es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eR,Es.createPortal=function(h,g){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S1(g))throw Error(n(200));return Xj(h,g,null,E)},Es.createRoot=function(h,g){if(!S1(h))throw Error(n(299));var E=!1,j="",H=Nk;return g!=null&&(g.unstable_strictMode===!0&&(E=!0),g.identifierPrefix!==void 0&&(j=g.identifierPrefix),g.onRecoverableError!==void 0&&(H=g.onRecoverableError)),g=b1(h,1,!1,null,null,E,!1,j,H),h[br]=g.current,co(h.nodeType===8?h.parentNode:h),new _1(g)},Es.findDOMNode=function(h){if(h==null)return null;if(h.nodeType===1)return h;var g=h._reactInternals;if(g===void 0)throw typeof h.render=="function"?Error(n(188)):(h=Object.keys(h).join(","),Error(n(268,h)));return h=to(g),h=h===null?null:h.stateNode,h},Es.flushSync=function(h){return lh(h)},Es.hydrate=function(h,g,E){if(!Jv(g))throw Error(n(200));return e0(null,h,g,!0,E)},Es.hydrateRoot=function(h,g,E){if(!S1(h))throw Error(n(405));var j=E!=null&&E.hydratedSources||null,H=!1,X="",oe=Nk;if(E!=null&&(E.unstable_strictMode===!0&&(H=!0),E.identifierPrefix!==void 0&&(X=E.identifierPrefix),E.onRecoverableError!==void 0&&(oe=E.onRecoverableError)),g=Ck(g,null,h,1,E??null,H,!1,X,oe),h[br]=g.current,co(h),j)for(h=0;h<j.length;h++)E=j[h],H=E._getVersion,H=H(E._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[E,H]:g.mutableSourceEagerHydrationData.push(E,H);return new Qv(g)},Es.render=function(h,g,E){if(!Jv(g))throw Error(n(200));return e0(null,h,g,!1,E)},Es.unmountComponentAtNode=function(h){if(!Jv(h))throw Error(n(40));return h._reactRootContainer?(lh(function(){e0(null,null,h,!1,function(){h._reactRootContainer=null,h[br]=null})}),!0):!1},Es.unstable_batchedUpdates=p1,Es.unstable_renderSubtreeIntoContainer=function(h,g,E,j){if(!Jv(E))throw Error(n(200));if(h==null||h._reactInternals===void 0)throw Error(n(38));return e0(h,g,E,!1,j)},Es.version="18.3.1-next-f1338f8080-20240426",Es}var Ik;function t4(){if(Ik)return E1.exports;Ik=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),E1.exports=uR(),E1.exports}var Bk;function cR(){if(Bk)return r0;Bk=1;var r=t4();return r0.createRoot=r.createRoot,r0.hydrateRoot=r.hydrateRoot,r0}var dR=cR();const hR=Kh(dR);var iu=t4();const fR=Kh(iu);function jg(){return jg=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},jg.apply(this,arguments)}var ad;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(ad||(ad={}));const zk="popstate";function pR(r){r===void 0&&(r={});function e(i,a){let{pathname:s,search:o,hash:l}=i.location;return h2("",{pathname:s,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:ty(a)}return gR(e,n,null,r)}function Kn(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function S_(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function mR(){return Math.random().toString(36).substr(2,8)}function Fk(r,e){return{usr:r.state,key:r.key,idx:e}}function h2(r,e,n,i){return n===void 0&&(n=null),jg({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof e=="string"?Ep(e):e,{state:n,key:e&&e.key||i||mR()})}function ty(r){let{pathname:e="/",search:n="",hash:i=""}=r;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function Ep(r){let e={};if(r){let n=r.indexOf("#");n>=0&&(e.hash=r.substr(n),r=r.substr(0,n));let i=r.indexOf("?");i>=0&&(e.search=r.substr(i),r=r.substr(0,i)),r&&(e.pathname=r)}return e}function gR(r,e,n,i){i===void 0&&(i={});let{window:a=document.defaultView,v5Compat:s=!1}=i,o=a.history,l=ad.Pop,u=null,c=d();c==null&&(c=0,o.replaceState(jg({},o.state,{idx:c}),""));function d(){return(o.state||{idx:null}).idx}function p(){l=ad.Pop;let k=d(),T=k==null?null:k-c;c=k,u&&u({action:l,location:S.location,delta:T})}function v(k,T){l=ad.Push;let C=h2(S.location,k,T);c=d()+1;let N=Fk(C,c),P=S.createHref(C);try{o.pushState(N,"",P)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;a.location.assign(P)}s&&u&&u({action:l,location:S.location,delta:1})}function y(k,T){l=ad.Replace;let C=h2(S.location,k,T);c=d();let N=Fk(C,c),P=S.createHref(C);o.replaceState(N,"",P),s&&u&&u({action:l,location:S.location,delta:0})}function b(k){let T=a.location.origin!=="null"?a.location.origin:a.location.href,C=typeof k=="string"?k:ty(k);return C=C.replace(/ $/,"%20"),Kn(T,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,T)}let S={get action(){return l},get location(){return r(a,o)},listen(k){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(zk,p),u=k,()=>{a.removeEventListener(zk,p),u=null}},createHref(k){return e(a,k)},createURL:b,encodeLocation(k){let T=b(k);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:v,replace:y,go(k){return o.go(k)}};return S}var Vk;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(Vk||(Vk={}));function vR(r,e,n){return n===void 0&&(n="/"),yR(r,e,n)}function yR(r,e,n,i){let a=typeof e=="string"?Ep(e):e,s=cp(a.pathname||"/",n);if(s==null)return null;let o=r4(r);xR(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let c=MR(s);l=TR(o[u],c)}return l}function r4(r,e,n,i){e===void 0&&(e=[]),n===void 0&&(n=[]),i===void 0&&(i="");let a=(s,o,l)=>{let u={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};u.relativePath.startsWith("/")&&(Kn(u.relativePath.startsWith(i),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(i.length));let c=hd([i,u.relativePath]),d=n.concat(u);s.children&&s.children.length>0&&(Kn(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),r4(s.children,e,d,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:ER(c,s.index),routesMeta:d})};return r.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))a(s,o);else for(let u of n4(s.path))a(s,o,u)}),e}function n4(r){let e=r.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return a?[s,""]:[s];let o=n4(i.join("/")),l=[];return l.push(...o.map(u=>u===""?s:[s,u].join("/"))),a&&l.push(...o),l.map(u=>r.startsWith("/")&&u===""?"/":u)}function xR(r){r.sort((e,n)=>e.score!==n.score?n.score-e.score:NR(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const bR=/^:[\w-]+$/,wR=3,_R=2,SR=1,kR=10,CR=-2,Uk=r=>r==="*";function ER(r,e){let n=r.split("/"),i=n.length;return n.some(Uk)&&(i+=CR),e&&(i+=_R),n.filter(a=>!Uk(a)).reduce((a,s)=>a+(bR.test(s)?wR:s===""?SR:kR),i)}function NR(r,e){return r.length===e.length&&r.slice(0,-1).every((i,a)=>i===e[a])?r[r.length-1]-e[e.length-1]:0}function TR(r,e,n){let{routesMeta:i}=r,a={},s="/",o=[];for(let l=0;l<i.length;++l){let u=i[l],c=l===i.length-1,d=s==="/"?e:e.slice(s.length)||"/",p=f2({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},d),v=u.route;if(!p)return null;Object.assign(a,p.params),o.push({params:a,pathname:hd([s,p.pathname]),pathnameBase:OR(hd([s,p.pathnameBase])),route:v}),p.pathnameBase!=="/"&&(s=hd([s,p.pathnameBase]))}return o}function f2(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[n,i]=PR(r.path,r.caseSensitive,r.end),a=e.match(n);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:i.reduce((c,d,p)=>{let{paramName:v,isOptional:y}=d;if(v==="*"){let S=l[p]||"";o=s.slice(0,s.length-S.length).replace(/(.)\/+$/,"$1")}const b=l[p];return y&&!b?c[v]=void 0:c[v]=(b||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:o,pattern:r}}function PR(r,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),S_(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let i=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(i.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(i.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function MR(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return S_(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),r}}function cp(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=r.charAt(n);return i&&i!=="/"?null:r.slice(n)||"/"}const AR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jR=r=>AR.test(r);function RR(r,e){e===void 0&&(e="/");let{pathname:n,search:i="",hash:a=""}=typeof r=="string"?Ep(r):r,s;if(n)if(jR(n))s=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),S_(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?s=Hk(n.substring(1),"/"):s=Hk(n,e)}else s=e;return{pathname:s,search:DR(i),hash:IR(a)}}function Hk(r,e){let n=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function P1(r,e,n,i){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function LR(r){return r.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function i4(r,e){let n=LR(r);return e?n.map((i,a)=>a===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function a4(r,e,n,i){i===void 0&&(i=!1);let a;typeof r=="string"?a=Ep(r):(a=jg({},r),Kn(!a.pathname||!a.pathname.includes("?"),P1("?","pathname","search",a)),Kn(!a.pathname||!a.pathname.includes("#"),P1("#","pathname","hash",a)),Kn(!a.search||!a.search.includes("#"),P1("#","search","hash",a)));let s=r===""||a.pathname==="",o=s?"/":a.pathname,l;if(o==null)l=n;else{let p=e.length-1;if(!i&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),p-=1;a.pathname=v.join("/")}l=p>=0?e[p]:"/"}let u=RR(a,l),c=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(c||d)&&(u.pathname+="/"),u}const hd=r=>r.join("/").replace(/\/\/+/g,"/"),OR=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),DR=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,IR=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function BR(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const s4=["post","put","patch","delete"];new Set(s4);const zR=["get",...s4];new Set(zR);function Rg(){return Rg=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},Rg.apply(this,arguments)}const cx=ce.createContext(null),o4=ce.createContext(null),Td=ce.createContext(null),dx=ce.createContext(null),Yu=ce.createContext({outlet:null,matches:[],isDataRoute:!1}),l4=ce.createContext(null);function FR(r,e){let{relative:n}=e===void 0?{}:e;iv()||Kn(!1);let{basename:i,navigator:a}=ce.useContext(Td),{hash:s,pathname:o,search:l}=hx(r,{relative:n}),u=o;return i!=="/"&&(u=o==="/"?i:hd([i,o])),a.createHref({pathname:u,search:l,hash:s})}function iv(){return ce.useContext(dx)!=null}function Zh(){return iv()||Kn(!1),ce.useContext(dx).location}function u4(r){ce.useContext(Td).static||ce.useLayoutEffect(r)}function Na(){let{isDataRoute:r}=ce.useContext(Yu);return r?eL():VR()}function VR(){iv()||Kn(!1);let r=ce.useContext(cx),{basename:e,future:n,navigator:i}=ce.useContext(Td),{matches:a}=ce.useContext(Yu),{pathname:s}=Zh(),o=JSON.stringify(i4(a,n.v7_relativeSplatPath)),l=ce.useRef(!1);return u4(()=>{l.current=!0}),ce.useCallback(function(c,d){if(d===void 0&&(d={}),!l.current)return;if(typeof c=="number"){i.go(c);return}let p=a4(c,JSON.parse(o),s,d.relative==="path");r==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:hd([e,p.pathname])),(d.replace?i.replace:i.push)(p,d.state,d)},[e,i,o,s,r])}const c4=ce.createContext(null);function au(){return ce.useContext(c4)}function UR(r){let e=ce.useContext(Yu).outlet;return e&&ce.createElement(c4.Provider,{value:r},e)}function Yi(){let{matches:r}=ce.useContext(Yu),e=r[r.length-1];return e?e.params:{}}function hx(r,e){let{relative:n}=e===void 0?{}:e,{future:i}=ce.useContext(Td),{matches:a}=ce.useContext(Yu),{pathname:s}=Zh(),o=JSON.stringify(i4(a,i.v7_relativeSplatPath));return ce.useMemo(()=>a4(r,JSON.parse(o),s,n==="path"),[r,o,s,n])}function HR(r,e){return GR(r,e)}function GR(r,e,n,i){iv()||Kn(!1);let{navigator:a}=ce.useContext(Td),{matches:s}=ce.useContext(Yu),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let c=Zh(),d;if(e){var p;let k=typeof e=="string"?Ep(e):e;u==="/"||(p=k.pathname)!=null&&p.startsWith(u)||Kn(!1),d=k}else d=c;let v=d.pathname||"/",y=v;if(u!=="/"){let k=u.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(k.length).join("/")}let b=vR(r,{pathname:y}),S=ZR(b&&b.map(k=>Object.assign({},k,{params:Object.assign({},l,k.params),pathname:hd([u,a.encodeLocation?a.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?u:hd([u,a.encodeLocation?a.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),s,n,i);return e&&S?ce.createElement(dx.Provider,{value:{location:Rg({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:ad.Pop}},S):S}function qR(){let r=JR(),e=BR(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),n=r instanceof Error?r.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ce.createElement(ce.Fragment,null,ce.createElement("h2",null,"Unexpected Application Error!"),ce.createElement("h3",{style:{fontStyle:"italic"}},e),n?ce.createElement("pre",{style:a},n):null,null)}const WR=ce.createElement(qR,null);class $R extends ce.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?ce.createElement(Yu.Provider,{value:this.props.routeContext},ce.createElement(l4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function KR(r){let{routeContext:e,match:n,children:i}=r,a=ce.useContext(cx);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),ce.createElement(Yu.Provider,{value:e},i)}function ZR(r,e,n,i){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),i===void 0&&(i=null),r==null){var s;if(!n)return null;if(n.errors)r=n.matches;else if((s=i)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)r=n.matches;else return null}let o=r,l=(a=n)==null?void 0:a.errors;if(l!=null){let d=o.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);d>=0||Kn(!1),o=o.slice(0,Math.min(o.length,d+1))}let u=!1,c=-1;if(n&&i&&i.v7_partialHydration)for(let d=0;d<o.length;d++){let p=o[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(c=d),p.route.id){let{loaderData:v,errors:y}=n,b=p.route.loader&&v[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||b){u=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((d,p,v)=>{let y,b=!1,S=null,k=null;n&&(y=l&&p.route.id?l[p.route.id]:void 0,S=p.route.errorElement||WR,u&&(c<0&&v===0?(tL("route-fallback"),b=!0,k=null):c===v&&(b=!0,k=p.route.hydrateFallbackElement||null)));let T=e.concat(o.slice(0,v+1)),C=()=>{let N;return y?N=S:b?N=k:p.route.Component?N=ce.createElement(p.route.Component,null):p.route.element?N=p.route.element:N=d,ce.createElement(KR,{match:p,routeContext:{outlet:d,matches:T,isDataRoute:n!=null},children:N})};return n&&(p.route.ErrorBoundary||p.route.errorElement||v===0)?ce.createElement($R,{location:n.location,revalidation:n.revalidation,component:S,error:y,children:C(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):C()},null)}var d4=(function(r){return r.UseBlocker="useBlocker",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r})(d4||{}),h4=(function(r){return r.UseBlocker="useBlocker",r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r.UseRouteId="useRouteId",r})(h4||{});function YR(r){let e=ce.useContext(cx);return e||Kn(!1),e}function XR(r){let e=ce.useContext(o4);return e||Kn(!1),e}function QR(r){let e=ce.useContext(Yu);return e||Kn(!1),e}function f4(r){let e=QR(),n=e.matches[e.matches.length-1];return n.route.id||Kn(!1),n.route.id}function JR(){var r;let e=ce.useContext(l4),n=XR(),i=f4();return e!==void 0?e:(r=n.errors)==null?void 0:r[i]}function eL(){let{router:r}=YR(d4.UseNavigateStable),e=f4(h4.UseNavigateStable),n=ce.useRef(!1);return u4(()=>{n.current=!0}),ce.useCallback(function(a,s){s===void 0&&(s={}),n.current&&(typeof a=="number"?r.navigate(a):r.navigate(a,Rg({fromRouteId:e},s)))},[r,e])}const Gk={};function tL(r,e,n){Gk[r]||(Gk[r]=!0)}function rL(r,e){r?.v7_startTransition,r?.v7_relativeSplatPath}function k_(r){return UR(r.context)}function An(r){Kn(!1)}function nL(r){let{basename:e="/",children:n=null,location:i,navigationType:a=ad.Pop,navigator:s,static:o=!1,future:l}=r;iv()&&Kn(!1);let u=e.replace(/^\/*/,"/"),c=ce.useMemo(()=>({basename:u,navigator:s,static:o,future:Rg({v7_relativeSplatPath:!1},l)}),[u,l,s,o]);typeof i=="string"&&(i=Ep(i));let{pathname:d="/",search:p="",hash:v="",state:y=null,key:b="default"}=i,S=ce.useMemo(()=>{let k=cp(d,u);return k==null?null:{location:{pathname:k,search:p,hash:v,state:y,key:b},navigationType:a}},[u,d,p,v,y,b,a]);return S==null?null:ce.createElement(Td.Provider,{value:c},ce.createElement(dx.Provider,{children:n,value:S}))}function iL(r){let{children:e,location:n}=r;return HR(p2(e),n)}new Promise(()=>{});function p2(r,e){e===void 0&&(e=[]);let n=[];return ce.Children.forEach(r,(i,a)=>{if(!ce.isValidElement(i))return;let s=[...e,a];if(i.type===ce.Fragment){n.push.apply(n,p2(i.props.children,s));return}i.type!==An&&Kn(!1),!i.props.index||!i.props.children||Kn(!1);let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=p2(i.props.children,s)),n.push(o)}),n}function ry(){return ry=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},ry.apply(this,arguments)}function p4(r,e){if(r==null)return{};var n={},i=Object.keys(r),a,s;for(s=0;s<i.length;s++)a=i[s],!(e.indexOf(a)>=0)&&(n[a]=r[a]);return n}function aL(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function sL(r,e){return r.button===0&&(!e||e==="_self")&&!aL(r)}const oL=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],lL=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],uL="6";try{window.__reactRouterVersion=uL}catch{}const cL=ce.createContext({isTransitioning:!1}),dL="startTransition",qk=oR[dL];function hL(r){let{basename:e,children:n,future:i,window:a}=r,s=ce.useRef();s.current==null&&(s.current=pR({window:a,v5Compat:!0}));let o=s.current,[l,u]=ce.useState({action:o.action,location:o.location}),{v7_startTransition:c}=i||{},d=ce.useCallback(p=>{c&&qk?qk(()=>u(p)):u(p)},[u,c]);return ce.useLayoutEffect(()=>o.listen(d),[o,d]),ce.useEffect(()=>rL(i),[i]),ce.createElement(nL,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:i})}const fL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",pL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Oh=ce.forwardRef(function(e,n){let{onClick:i,relative:a,reloadDocument:s,replace:o,state:l,target:u,to:c,preventScrollReset:d,viewTransition:p}=e,v=p4(e,oL),{basename:y}=ce.useContext(Td),b,S=!1;if(typeof c=="string"&&pL.test(c)&&(b=c,fL))try{let N=new URL(window.location.href),P=c.startsWith("//")?new URL(N.protocol+c):new URL(c),R=cp(P.pathname,y);P.origin===N.origin&&R!=null?c=R+P.search+P.hash:S=!0}catch{}let k=FR(c,{relative:a}),T=vL(c,{replace:o,state:l,target:u,preventScrollReset:d,relative:a,viewTransition:p});function C(N){i&&i(N),N.defaultPrevented||T(N)}return ce.createElement("a",ry({},v,{href:b||k,onClick:S||s?i:C,ref:n,target:u}))}),mL=ce.forwardRef(function(e,n){let{"aria-current":i="page",caseSensitive:a=!1,className:s="",end:o=!1,style:l,to:u,viewTransition:c,children:d}=e,p=p4(e,lL),v=hx(u,{relative:p.relative}),y=Zh(),b=ce.useContext(o4),{navigator:S,basename:k}=ce.useContext(Td),T=b!=null&&yL(v)&&c===!0,C=S.encodeLocation?S.encodeLocation(v).pathname:v.pathname,N=y.pathname,P=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;a||(N=N.toLowerCase(),P=P?P.toLowerCase():null,C=C.toLowerCase()),P&&k&&(P=cp(P,k)||P);const R=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let O=N===C||!o&&N.startsWith(C)&&N.charAt(R)==="/",B=P!=null&&(P===C||!o&&P.startsWith(C)&&P.charAt(C.length)==="/"),I={isActive:O,isPending:B,isTransitioning:T},z=O?i:void 0,V;typeof s=="function"?V=s(I):V=[s,O?"active":null,B?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let $=typeof l=="function"?l(I):l;return ce.createElement(Oh,ry({},p,{"aria-current":z,className:V,ref:n,style:$,to:u,viewTransition:c}),typeof d=="function"?d(I):d)});var m2;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmit="useSubmit",r.UseSubmitFetcher="useSubmitFetcher",r.UseFetcher="useFetcher",r.useViewTransitionState="useViewTransitionState"})(m2||(m2={}));var Wk;(function(r){r.UseFetcher="useFetcher",r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(Wk||(Wk={}));function gL(r){let e=ce.useContext(cx);return e||Kn(!1),e}function vL(r,e){let{target:n,replace:i,state:a,preventScrollReset:s,relative:o,viewTransition:l}=e===void 0?{}:e,u=Na(),c=Zh(),d=hx(r,{relative:o});return ce.useCallback(p=>{if(sL(p,n)){p.preventDefault();let v=i!==void 0?i:ty(c)===ty(d);u(r,{replace:v,state:a,preventScrollReset:s,relative:o,viewTransition:l})}},[c,u,d,i,a,n,r,s,o,l])}function yL(r,e){e===void 0&&(e={});let n=ce.useContext(cL);n==null&&Kn(!1);let{basename:i}=gL(m2.useViewTransitionState),a=hx(r,{relative:e.relative});if(!n.isTransitioning)return!1;let s=cp(n.currentLocation.pathname,i)||n.currentLocation.pathname,o=cp(n.nextLocation.pathname,i)||n.nextLocation.pathname;return f2(a.pathname,o)!=null||f2(a.pathname,s)!=null}const C_="-",xL=r=>{const e=wL(r),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=r;return{getClassGroupId:o=>{const l=o.split(C_);return l[0]===""&&l.length!==1&&l.shift(),m4(l,e)||bL(o)},getConflictingClassGroupIds:(o,l)=>{const u=n[o]||[];return l&&i[o]?[...u,...i[o]]:u}}},m4=(r,e)=>{if(r.length===0)return e.classGroupId;const n=r[0],i=e.nextPart.get(n),a=i?m4(r.slice(1),i):void 0;if(a)return a;if(e.validators.length===0)return;const s=r.join(C_);return e.validators.find(({validator:o})=>o(s))?.classGroupId},$k=/^\[(.+)\]$/,bL=r=>{if($k.test(r)){const e=$k.exec(r)[1],n=e?.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},wL=r=>{const{theme:e,prefix:n}=r,i={nextPart:new Map,validators:[]};return SL(Object.entries(r.classGroups),n).forEach(([s,o])=>{g2(o,i,s,e)}),i},g2=(r,e,n,i)=>{r.forEach(a=>{if(typeof a=="string"){const s=a===""?e:Kk(e,a);s.classGroupId=n;return}if(typeof a=="function"){if(_L(a)){g2(a(i),e,n,i);return}e.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([s,o])=>{g2(o,Kk(e,s),n,i)})})},Kk=(r,e)=>{let n=r;return e.split(C_).forEach(i=>{n.nextPart.has(i)||n.nextPart.set(i,{nextPart:new Map,validators:[]}),n=n.nextPart.get(i)}),n},_L=r=>r.isThemeGetter,SL=(r,e)=>e?r.map(([n,i])=>{const a=i.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,l])=>[e+o,l])):s);return[n,a]}):r,kL=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,i=new Map;const a=(s,o)=>{n.set(s,o),e++,e>r&&(e=0,i=n,n=new Map)};return{get(s){let o=n.get(s);if(o!==void 0)return o;if((o=i.get(s))!==void 0)return a(s,o),o},set(s,o){n.has(s)?n.set(s,o):a(s,o)}}},g4="!",CL=r=>{const{separator:e,experimentalParseClassName:n}=r,i=e.length===1,a=e[0],s=e.length,o=l=>{const u=[];let c=0,d=0,p;for(let k=0;k<l.length;k++){let T=l[k];if(c===0){if(T===a&&(i||l.slice(k,k+s)===e)){u.push(l.slice(d,k)),d=k+s;continue}if(T==="/"){p=k;continue}}T==="["?c++:T==="]"&&c--}const v=u.length===0?l:l.substring(d),y=v.startsWith(g4),b=y?v.substring(1):v,S=p&&p>d?p-d:void 0;return{modifiers:u,hasImportantModifier:y,baseClassName:b,maybePostfixModifierPosition:S}};return n?l=>n({className:l,parseClassName:o}):o},EL=r=>{if(r.length<=1)return r;const e=[];let n=[];return r.forEach(i=>{i[0]==="["?(e.push(...n.sort(),i),n=[]):n.push(i)}),e.push(...n.sort()),e},NL=r=>({cache:kL(r.cacheSize),parseClassName:CL(r),...xL(r)}),TL=/\s+/,PL=(r,e)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:a}=e,s=[],o=r.trim().split(TL);let l="";for(let u=o.length-1;u>=0;u-=1){const c=o[u],{modifiers:d,hasImportantModifier:p,baseClassName:v,maybePostfixModifierPosition:y}=n(c);let b=!!y,S=i(b?v.substring(0,y):v);if(!S){if(!b){l=c+(l.length>0?" "+l:l);continue}if(S=i(v),!S){l=c+(l.length>0?" "+l:l);continue}b=!1}const k=EL(d).join(":"),T=p?k+g4:k,C=T+S;if(s.includes(C))continue;s.push(C);const N=a(S,b);for(let P=0;P<N.length;++P){const R=N[P];s.push(T+R)}l=c+(l.length>0?" "+l:l)}return l};function ML(){let r=0,e,n,i="";for(;r<arguments.length;)(e=arguments[r++])&&(n=v4(e))&&(i&&(i+=" "),i+=n);return i}const v4=r=>{if(typeof r=="string")return r;let e,n="";for(let i=0;i<r.length;i++)r[i]&&(e=v4(r[i]))&&(n&&(n+=" "),n+=e);return n};function AL(r,...e){let n,i,a,s=o;function o(u){const c=e.reduce((d,p)=>p(d),r());return n=NL(c),i=n.cache.get,a=n.cache.set,s=l,l(u)}function l(u){const c=i(u);if(c)return c;const d=PL(u,n);return a(u,d),d}return function(){return s(ML.apply(null,arguments))}}const vn=r=>{const e=n=>n[r]||[];return e.isThemeGetter=!0,e},y4=/^\[(?:([a-z-]+):)?(.+)\]$/i,jL=/^\d+\/\d+$/,RL=new Set(["px","full","screen"]),LL=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,OL=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,DL=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,IL=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,BL=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ru=r=>np(r)||RL.has(r)||jL.test(r),Gc=r=>Np(r,"length",WL),np=r=>!!r&&!Number.isNaN(Number(r)),M1=r=>Np(r,"number",np),rm=r=>!!r&&Number.isInteger(Number(r)),zL=r=>r.endsWith("%")&&np(r.slice(0,-1)),rr=r=>y4.test(r),qc=r=>LL.test(r),FL=new Set(["length","size","percentage"]),VL=r=>Np(r,FL,x4),UL=r=>Np(r,"position",x4),HL=new Set(["image","url"]),GL=r=>Np(r,HL,KL),qL=r=>Np(r,"",$L),nm=()=>!0,Np=(r,e,n)=>{const i=y4.exec(r);return i?i[1]?typeof e=="string"?i[1]===e:e.has(i[1]):n(i[2]):!1},WL=r=>OL.test(r)&&!DL.test(r),x4=()=>!1,$L=r=>IL.test(r),KL=r=>BL.test(r),ZL=()=>{const r=vn("colors"),e=vn("spacing"),n=vn("blur"),i=vn("brightness"),a=vn("borderColor"),s=vn("borderRadius"),o=vn("borderSpacing"),l=vn("borderWidth"),u=vn("contrast"),c=vn("grayscale"),d=vn("hueRotate"),p=vn("invert"),v=vn("gap"),y=vn("gradientColorStops"),b=vn("gradientColorStopPositions"),S=vn("inset"),k=vn("margin"),T=vn("opacity"),C=vn("padding"),N=vn("saturate"),P=vn("scale"),R=vn("sepia"),O=vn("skew"),B=vn("space"),I=vn("translate"),z=()=>["auto","contain","none"],V=()=>["auto","hidden","clip","visible","scroll"],$=()=>["auto",rr,e],Y=()=>[rr,e],D=()=>["",Ru,Gc],q=()=>["auto",np,rr],G=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Z=()=>["solid","dashed","dotted","double","none"],Q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],J=()=>["start","end","center","between","around","evenly","stretch"],ie=()=>["","0",rr],ne=()=>["auto","avoid","all","avoid-page","page","left","right","column"],W=()=>[np,rr];return{cacheSize:500,separator:":",theme:{colors:[nm],spacing:[Ru,Gc],blur:["none","",qc,rr],brightness:W(),borderColor:[r],borderRadius:["none","","full",qc,rr],borderSpacing:Y(),borderWidth:D(),contrast:W(),grayscale:ie(),hueRotate:W(),invert:ie(),gap:Y(),gradientColorStops:[r],gradientColorStopPositions:[zL,Gc],inset:$(),margin:$(),opacity:W(),padding:Y(),saturate:W(),scale:W(),sepia:ie(),skew:W(),space:Y(),translate:Y()},classGroups:{aspect:[{aspect:["auto","square","video",rr]}],container:["container"],columns:[{columns:[qc]}],"break-after":[{"break-after":ne()}],"break-before":[{"break-before":ne()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...G(),rr]}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:z()}],"overscroll-x":[{"overscroll-x":z()}],"overscroll-y":[{"overscroll-y":z()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[S]}],"inset-x":[{"inset-x":[S]}],"inset-y":[{"inset-y":[S]}],start:[{start:[S]}],end:[{end:[S]}],top:[{top:[S]}],right:[{right:[S]}],bottom:[{bottom:[S]}],left:[{left:[S]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",rm,rr]}],basis:[{basis:$()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",rr]}],grow:[{grow:ie()}],shrink:[{shrink:ie()}],order:[{order:["first","last","none",rm,rr]}],"grid-cols":[{"grid-cols":[nm]}],"col-start-end":[{col:["auto",{span:["full",rm,rr]},rr]}],"col-start":[{"col-start":q()}],"col-end":[{"col-end":q()}],"grid-rows":[{"grid-rows":[nm]}],"row-start-end":[{row:["auto",{span:[rm,rr]},rr]}],"row-start":[{"row-start":q()}],"row-end":[{"row-end":q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",rr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",rr]}],gap:[{gap:[v]}],"gap-x":[{"gap-x":[v]}],"gap-y":[{"gap-y":[v]}],"justify-content":[{justify:["normal",...J()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...J(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...J(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[C]}],px:[{px:[C]}],py:[{py:[C]}],ps:[{ps:[C]}],pe:[{pe:[C]}],pt:[{pt:[C]}],pr:[{pr:[C]}],pb:[{pb:[C]}],pl:[{pl:[C]}],m:[{m:[k]}],mx:[{mx:[k]}],my:[{my:[k]}],ms:[{ms:[k]}],me:[{me:[k]}],mt:[{mt:[k]}],mr:[{mr:[k]}],mb:[{mb:[k]}],ml:[{ml:[k]}],"space-x":[{"space-x":[B]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[B]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",rr,e]}],"min-w":[{"min-w":[rr,e,"min","max","fit"]}],"max-w":[{"max-w":[rr,e,"none","full","min","max","fit","prose",{screen:[qc]},qc]}],h:[{h:[rr,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[rr,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[rr,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[rr,e,"auto","min","max","fit"]}],"font-size":[{text:["base",qc,Gc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",M1]}],"font-family":[{font:[nm]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",rr]}],"line-clamp":[{"line-clamp":["none",np,M1]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ru,rr]}],"list-image":[{"list-image":["none",rr]}],"list-style-type":[{list:["none","disc","decimal",rr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[r]}],"placeholder-opacity":[{"placeholder-opacity":[T]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[r]}],"text-opacity":[{"text-opacity":[T]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ru,Gc]}],"underline-offset":[{"underline-offset":["auto",Ru,rr]}],"text-decoration-color":[{decoration:[r]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Y()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",rr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",rr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[T]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...G(),UL]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",VL]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},GL]}],"bg-color":[{bg:[r]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[y]}],"gradient-via":[{via:[y]}],"gradient-to":[{to:[y]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[T]}],"border-style":[{border:[...Z(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[T]}],"divide-style":[{divide:Z()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...Z()]}],"outline-offset":[{"outline-offset":[Ru,rr]}],"outline-w":[{outline:[Ru,Gc]}],"outline-color":[{outline:[r]}],"ring-w":[{ring:D()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[r]}],"ring-opacity":[{"ring-opacity":[T]}],"ring-offset-w":[{"ring-offset":[Ru,Gc]}],"ring-offset-color":[{"ring-offset":[r]}],shadow:[{shadow:["","inner","none",qc,qL]}],"shadow-color":[{shadow:[nm]}],opacity:[{opacity:[T]}],"mix-blend":[{"mix-blend":[...Q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Q()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[i]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",qc,rr]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[p]}],saturate:[{saturate:[N]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[T]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",rr]}],duration:[{duration:W()}],ease:[{ease:["linear","in","out","in-out",rr]}],delay:[{delay:W()}],animate:[{animate:["none","spin","ping","pulse","bounce",rr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[rm,rr]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[O]}],"skew-y":[{"skew-y":[O]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",rr]}],accent:[{accent:["auto",r]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",rr]}],"caret-color":[{caret:[r]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Y()}],"scroll-mx":[{"scroll-mx":Y()}],"scroll-my":[{"scroll-my":Y()}],"scroll-ms":[{"scroll-ms":Y()}],"scroll-me":[{"scroll-me":Y()}],"scroll-mt":[{"scroll-mt":Y()}],"scroll-mr":[{"scroll-mr":Y()}],"scroll-mb":[{"scroll-mb":Y()}],"scroll-ml":[{"scroll-ml":Y()}],"scroll-p":[{"scroll-p":Y()}],"scroll-px":[{"scroll-px":Y()}],"scroll-py":[{"scroll-py":Y()}],"scroll-ps":[{"scroll-ps":Y()}],"scroll-pe":[{"scroll-pe":Y()}],"scroll-pt":[{"scroll-pt":Y()}],"scroll-pr":[{"scroll-pr":Y()}],"scroll-pb":[{"scroll-pb":Y()}],"scroll-pl":[{"scroll-pl":Y()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",rr]}],fill:[{fill:[r,"none"]}],"stroke-w":[{stroke:[Ru,Gc,M1]}],stroke:[{stroke:[r,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},E_=AL(ZL),Lr=({children:r,className:e,...n})=>m.jsx("div",{className:E_("bg-glass backdrop-blur-xl border border-glass-border rounded-xl",e),...n,children:r}),ny=({url:r,name:e,alt:n="User",size:i="md",className:a})=>{const s={sm:"size-8 text-xs",md:"size-10 text-sm",lg:"size-16 text-lg",xl:"size-32 text-2xl"},o=e?e.charAt(0).toUpperCase():n?n.charAt(0).toUpperCase():"?";return m.jsx("div",{className:E_("rounded-full bg-surface-light border border-white/10 flex items-center justify-center overflow-hidden shrink-0 text-slate-400 font-bold select-none",s[i],a),children:r?m.jsx("img",{src:r,alt:e||n,className:"w-full h-full object-cover"}):m.jsx("span",{children:o})})},YL=()=>m.jsx("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark relative",children:m.jsx("main",{className:"flex-1 min-w-0 relative overflow-hidden flex flex-col",children:m.jsx(k_,{})})}),XL="/api",rt={async request(r,e={}){const n=`${XL}${r}`,a={...e.body instanceof FormData?{}:{"Content-Type":"application/json"},...e.headers},s=await fetch(n,{...e,headers:a,credentials:"include"});if(!s.ok){const o=await s.json().catch(()=>({}));throw new Error(o.error||`HTTP error! status: ${s.status}`)}return s.status===204||s.headers.get("content-length")==="0"?null:s.json()},get(r,e={}){return this.request(r,{method:"GET",headers:e})},post(r,e,n={}){return this.request(r,{method:"POST",body:e instanceof FormData?e:JSON.stringify(e),headers:n})},put(r,e,n={}){return this.request(r,{method:"PUT",body:e instanceof FormData?e:JSON.stringify(e),headers:n})},patch(r,e,n={}){return this.request(r,{method:"PATCH",body:e instanceof FormData?e:JSON.stringify(e),headers:n})},delete(r,e={}){return this.request(r,{method:"DELETE",headers:e})}},im={list:()=>rt.get("/workspaces"),create:(r,e,n,i)=>rt.post("/workspaces",{name:r,title:e,genre:n,imageUrl:i}),delete:r=>rt.delete("/workspaces/"+r),update:(r,e)=>rt.put("/workspaces/"+r,e),select:r=>rt.post("/workspaces/select",{projectName:r})},QL=["FANTASA","SCI-FI","HORROR","LORE","MISTERIO","HISTRICO","CYBERPUNK","STEAMPUNK"],JL=({isOpen:r,onClose:e,onCreate:n})=>{if(!r)return null;const[i,a]=ce.useState(!1),[s,o]=ce.useState({name:"",title:"",genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"}),l=c=>{const{name:d,value:p}=c.target;o(v=>({...v,[d]:p}))},u=c=>{c.preventDefault();let d=s.name;if(!d&&s.title&&(d=s.title.toLowerCase().replace(/[^a-z0-9]/g,"-")),!d){alert("Project ID/Name is required");return}n({...s,name:d}),e(),o({name:"",title:"",genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"})};return iu.createPortal(m.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[m.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),m.jsxs("div",{className:"relative w-full max-w-2xl bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex animate-in zoom-in-95 duration-200",children:[m.jsxs("div",{className:"w-1/3 bg-black relative hidden sm:block",children:[m.jsx("img",{src:s.imageUrl,onError:()=>a(!0),className:`absolute inset-0 w-full h-full object-cover opacity-60 transition-opacity duration-500 ${i?"hidden":""}`,alt:"Preview"}),m.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-6 bg-gradient-to-t from-black to-transparent",children:[m.jsx("h4",{className:"text-white font-black text-xl leading-none",children:s.title||"Untitled"}),m.jsx("span",{className:"text-[10px] font-bold text-primary uppercase tracking-widest mt-2 block",children:s.genre})]})]}),m.jsxs("div",{className:"flex-1 p-8",children:[m.jsx("h2",{className:"text-2xl font-black text-white mb-6",children:"Nuevo Cuaderno"}),m.jsxs("form",{onSubmit:u,className:"space-y-5",children:[m.jsxs("div",{className:"space-y-1.5",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Ttulo del Proyecto"}),m.jsx("input",{type:"text",name:"title",value:s.title,onChange:l,placeholder:"e.g. Las Crnicas de Etheria",className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all",autoFocus:!0})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"ID de Archivo (Slug)"}),m.jsx("input",{type:"text",name:"name",value:s.name,onChange:l,placeholder:"e.g. etheria-v1",className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white font-mono text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all placeholder:text-white/10"}),m.jsx("p",{className:"text-[10px] text-white/20",children:"Se usar como nombre del archivo .db"})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Gnero"}),m.jsx("div",{className:"grid grid-cols-2 gap-2",children:QL.slice(0,4).map(c=>m.jsx("button",{type:"button",onClick:()=>o(d=>({...d,genre:c})),className:`px-3 py-2 rounded-lg text-[10px] font-bold border transition-all ${s.genre===c?"bg-primary text-white border-primary":"bg-[#13141f] border-white/10 text-text-muted hover:border-white/20"}`,children:c},c))})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Imagen de Portada (URL)"}),m.jsx("input",{type:"text",name:"imageUrl",value:s.imageUrl,onChange:c=>{o(d=>({...d,imageUrl:c.target.value})),a(!1)},className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all truncate"})]}),m.jsxs("div",{className:"pt-4 flex gap-3",children:[m.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-[#13141f] hover:bg-white/5 border border-white/10 rounded-xl text-xs font-bold text-text-muted transition-all",children:"Cancelar"}),m.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold transition-all shadow-lg shadow-primary/20 flex items-center justify-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"rocket_launch"}),"Crear Universo"]})]})]})]})]})]}),document.body)},e8=["FANTASA","SCI-FI","HORROR","LORE","MISTERIO","HISTRICO","CYBERPUNK","STEAMPUNK"],t8=({isOpen:r,onClose:e,onUpdate:n,project:i})=>{if(!r||!i)return null;const[a,s]=ce.useState(!1),[o,l]=ce.useState({name:i,title:i,genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"});ce.useEffect(()=>{i&&l(c=>({...c,name:i,title:i}))},[i]);const u=c=>{c.preventDefault(),n(o.name,{title:o.title,genre:o.genre,imageUrl:o.imageUrl}),e()};return iu.createPortal(m.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[m.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),m.jsxs("div",{className:"relative w-full max-w-2xl bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex animate-in zoom-in-95 duration-200",children:[m.jsxs("div",{className:"w-1/3 bg-black relative hidden sm:block",children:[m.jsx("img",{src:o.imageUrl,onError:()=>s(!0),className:`absolute inset-0 w-full h-full object-cover opacity-60 transition-opacity duration-500 ${a?"hidden":""}`,alt:"Preview"}),m.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-6 bg-gradient-to-t from-black to-transparent",children:[m.jsx("h4",{className:"text-white font-black text-xl leading-none",children:o.title||"Untitled"}),m.jsx("span",{className:"text-[10px] font-bold text-primary uppercase tracking-widest mt-2 block",children:o.genre})]})]}),m.jsxs("div",{className:"flex-1 p-8",children:[m.jsx("h2",{className:"text-2xl font-black text-white mb-6",children:"Editar Cuaderno"}),m.jsxs("form",{onSubmit:u,className:"space-y-5",children:[m.jsxs("div",{className:"space-y-1.5",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Ttulo del Proyecto"}),m.jsx("input",{type:"text",name:"title",value:o.title,onChange:c=>l(d=>({...d,title:c.target.value})),className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all",autoFocus:!0})]}),m.jsxs("div",{className:"space-y-1.5 opacity-50",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"ID de Archivo (Inmutable)"}),m.jsx("input",{type:"text",value:o.name,readOnly:!0,className:"w-full bg-[#0a0a0c] border border-white/5 rounded-xl px-4 py-3 text-white/50 font-mono text-xs outline-none cursor-not-allowed"})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Gnero"}),m.jsx("div",{className:"grid grid-cols-2 gap-2",children:e8.slice(0,4).map(c=>m.jsx("button",{type:"button",onClick:()=>l(d=>({...d,genre:c})),className:`px-3 py-2 rounded-lg text-[10px] font-bold border transition-all ${o.genre===c?"bg-primary text-white border-primary":"bg-[#13141f] border-white/10 text-text-muted hover:border-white/20"}`,children:c},c))})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Imagen de Portada (URL)"}),m.jsx("input",{type:"text",value:o.imageUrl,onChange:c=>{l(d=>({...d,imageUrl:c.target.value})),s(!1)},className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all truncate"})]}),m.jsxs("div",{className:"pt-4 flex gap-3",children:[m.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-[#13141f] hover:bg-white/5 border border-white/10 rounded-xl text-xs font-bold text-text-muted transition-all",children:"Cancelar"}),m.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold transition-all shadow-lg shadow-primary/20 flex items-center justify-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar Cambios"]})]})]})]})]})]}),document.body)},nn=ce.forwardRef(({children:r,variant:e="primary",size:n="md",className:i,icon:a,isLoading:s,...o},l)=>{const u="inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed active:scale-95",c={primary:"bg-primary text-white shadow-lg shadow-primary/25 hover:bg-primary-light hover:shadow-primary/40 border border-transparent",secondary:"bg-surface-light text-slate-200 border border-white/10 hover:bg-white/5 hover:text-white hover:border-white/20",ghost:"bg-transparent text-slate-400 hover:text-white hover:bg-white/5",danger:"bg-red-500/10 text-red-500 border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/50 hover:shadow-lg hover:shadow-red-500/10",outline:"bg-transparent border border-primary/50 text-primary hover:bg-primary/10"},d={xs:"px-2.5 py-1 text-xs gap-1.5",sm:"px-3 py-1.5 text-xs gap-1.5",md:"px-4 py-2 text-sm gap-2",lg:"px-6 py-3 text-base gap-3",icon:"size-9 p-0"};return m.jsxs("button",{ref:l,className:E_(u,c[e],d[n],i),disabled:s,...o,children:[s?m.jsx("span",{className:"material-symbols-outlined animate-spin text-[18px]",children:"progress_activity"}):a?m.jsx("span",{className:"material-symbols-outlined text-[18px]",children:a}):null,r]})});nn.displayName="Button";const r8=({isOpen:r,onClose:e,onConfirm:n,title:i,message:a,confirmText:s="Confirm",cancelText:o="Cancel",isDestructive:l=!0})=>r?m.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[m.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",onClick:e}),m.jsx("div",{className:"relative z-10 w-full max-w-md animate-in zoom-in-95 duration-300",children:m.jsxs(Lr,{className:"p-6 border-red-500/20 shadow-2xl shadow-black/50",children:[m.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[m.jsx("div",{className:`
                            size-12 rounded-xl flex items-center justify-center shrink-0
                            ${l?"bg-red-500/10 text-red-500":"bg-primary/10 text-primary"}
                        `,children:m.jsx("span",{className:"material-symbols-outlined text-2xl",children:l?"warning":"help"})}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-black text-white mb-2 leading-tight",children:i}),m.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:a})]})]}),m.jsxs("div",{className:"flex items-center justify-end gap-3",children:[m.jsx(nn,{variant:"ghost",onClick:e,children:o}),m.jsx(nn,{variant:l?"danger":"primary",onClick:()=>{n(),e()},icon:l?"delete":"check",children:s})]})]})})]}):null,n8=()=>{const r=Na(),[e,n]=ce.useState([]),[i,a]=ce.useState(!0),[s,o]=ce.useState(null),[l,u]=ce.useState(""),[c,d]=ce.useState(!1),[p,v]=ce.useState(null),[y,b]=ce.useState(null);ce.useEffect(()=>{S()},[]);const S=async()=>{try{a(!0);const O=await im.list();n(O)}catch(O){console.error("Failed to load workspaces",O),o("Error al cargar cuadernos. Est el servidor encendido?")}finally{a(!1)}},k=async O=>{try{a(!0);const B=await im.select(O);B.success&&B.redirect&&(localStorage.setItem("user",JSON.stringify({username:"local",success:!0})),r(B.redirect))}catch(B){o(B.message||"Fallo al entrar al cuaderno"),a(!1)}},T=async O=>{try{a(!0),(await im.create(O.name,O.title,O.genre,O.imageUrl)).success&&await k(O.name)}catch{o("Error al crear cuaderno"),a(!1)}},C=async()=>{if(p)try{a(!0),await im.delete(p),await S(),v(null)}catch{o("Error al borrar el cuaderno"),a(!1)}},N=async(O,B)=>{try{a(!0),await im.update(O,B),await S(),b(null)}catch{o("Error al actualizar cuaderno"),a(!1)}},P=()=>{window.location.href="/api/backup/download"},R=e.filter(O=>(O.title||O.filename||"").toLowerCase().includes(l.toLowerCase()));return m.jsxs("div",{className:"h-screen w-full bg-[#0a0b14] text-white flex flex-col items-center font-sans selection:bg-indigo-500/30 overflow-hidden",children:[m.jsxs("div",{className:"w-full max-w-6xl flex-1 flex flex-col overflow-y-auto custom-scrollbar p-8",children:[m.jsxs("header",{className:"w-full mt-24 mb-12 flex flex-col lg:flex-row lg:items-end justify-between gap-8 flex-shrink-0",children:[m.jsx("div",{className:"space-y-4",children:m.jsx("div",{className:"flex items-center gap-4",children:m.jsxs("h1",{className:"text-6xl font-black tracking-tighter leading-none",children:[m.jsx("span",{className:"block text-indigo-400",children:"Mis"}),m.jsx("span",{className:"block text-white",children:"Cuadernos"})]})})}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("button",{onClick:()=>r("/settings"),className:"flex items-center gap-2 px-5 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl transition-all text-xs font-bold text-slate-400 hover:text-white group",title:"Configuracin Global",children:[m.jsx("span",{className:"material-symbols-outlined text-lg group-hover:rotate-90 transition-transform duration-500",children:"settings"}),m.jsx("span",{className:"hidden sm:inline",children:"Ajustes"})]}),m.jsxs("button",{onClick:P,className:"flex items-center gap-2 px-5 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl transition-all text-xs font-bold text-slate-400 hover:text-white group",title:"Descargar copia de seguridad de todos los universos",children:[m.jsx("span",{className:"material-symbols-outlined text-lg group-hover:scale-110 transition-transform",children:"cloud_download"}),m.jsx("span",{className:"hidden sm:inline",children:"Backup Global"})]}),m.jsxs("div",{className:"relative group min-w-[300px]",children:[m.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-white/20 text-xl group-focus-within:text-indigo-400 transition-colors pointer-events-none",children:"search"}),m.jsx("input",{type:"text",placeholder:"Buscar...",value:l,onChange:O=>u(O.target.value),className:"w-full bg-[#13141f] border border-white/5 rounded-2xl py-3 pl-12 pr-4 text-sm text-white focus:outline-none focus:border-indigo-500/50 transition-all placeholder:text-white/10"})]})]})]}),m.jsx("section",{className:"w-full max-w-6xl",children:i?m.jsxs("div",{className:"flex flex-col items-center gap-6 py-20 opacity-20",children:[m.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),m.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:"Accediendo al Sector Local..."})]}):m.jsxs("div",{className:"flex flex-wrap gap-6 justify-start pb-20",children:[m.jsxs("div",{onClick:()=>d(!0),className:"group relative h-[380px] rounded-[2.5rem] border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-6 hover:bg-white/5 hover:border-indigo-500/30 transition-all cursor-pointer overflow-hidden animate-in fade-in duration-700 w-full md:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)]",children:[m.jsx("div",{className:"w-20 h-20 rounded-full bg-[#13141f] border border-white/5 flex items-center justify-center text-4xl text-white/20 group-hover:scale-110 group-hover:text-indigo-400 transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-4xl",children:"add"})}),m.jsxs("div",{className:"text-center",children:[m.jsx("h3",{className:"text-xl font-black tracking-tight text-white/50 group-hover:text-white transition-colors",children:"Nuevo Cuaderno"}),m.jsx("p",{className:"text-[10px] font-bold text-white/20 uppercase tracking-widest mt-2 group-hover:text-white/40",children:"Inicia un nuevo universo"})]})]}),R.map(O=>{const B=O.imageUrl||"https://images.unsplash.com/photo-1451187580459-43490279c0fa?auto=format&fit=crop&q=80&w=800";return m.jsxs("div",{onClick:()=>k(O.filename),className:"group relative h-[380px] rounded-[2.5rem] bg-[#13141f] border border-white/5 overflow-hidden transition-all hover:-translate-y-2 hover:shadow-2xl hover:shadow-indigo-500/10 cursor-pointer animate-in fade-in slide-in-from-bottom-4 w-full md:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)]",children:[m.jsxs("div",{className:"absolute inset-x-0 top-0 h-2/3",children:[m.jsx("img",{src:B,className:"w-full h-full object-cover opacity-40 group-hover:opacity-60 transition-opacity",alt:""}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#13141f] via-transparent to-transparent"})]}),m.jsxs("div",{className:"absolute top-6 right-6 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20",children:[m.jsx("button",{onClick:I=>{I.stopPropagation(),b(O.filename)},className:"w-10 h-10 rounded-full bg-black/50 backdrop-blur-md border border-white/10 flex items-center justify-center text-white/70 hover:text-white hover:bg-indigo-500 hover:border-indigo-400 transition-all",title:"Editar",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),m.jsx("button",{onClick:I=>{I.stopPropagation(),v(O.filename)},className:"w-10 h-10 rounded-full bg-black/50 backdrop-blur-md border border-white/10 flex items-center justify-center text-white/70 hover:text-white hover:bg-red-500 hover:border-red-400 transition-all",title:"Eliminar",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),m.jsx("div",{className:"absolute inset-0 flex flex-col justify-end p-8",children:m.jsxs("div",{className:"mt-auto space-y-3",children:[m.jsx("span",{className:"inline-block px-3 py-1 bg-red-500/20 border border-red-500/30 text-[9px] font-black text-red-100 rounded-lg tracking-widest uppercase",children:O.tag}),m.jsx("h3",{className:"text-3xl font-black text-white tracking-tighter leading-tight group-hover:text-indigo-400 transition-colors",children:O.title}),O.title!==O.filename&&m.jsx("p",{className:"text-[10px] text-white/30 font-mono mb-1",children:O.filename}),m.jsx("p",{className:"text-xs text-white/40 line-clamp-2 leading-relaxed",children:"Una tierra dividida por la magia y la tecnologa antigua..."}),m.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-white/5 mt-4",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]"}),m.jsxs("span",{className:"text-[9px] font-black uppercase tracking-widest text-white/20",children:["ltima edicin: ",m.jsx("span",{className:"text-white/40",children:O.lastModified})]})]}),m.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-[10px] font-black text-indigo-300",children:O.initials})]})]})})]},O.filename)})]})})]}),s&&m.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 px-6 py-3 bg-red-500/20 border border-red-500/30 text-red-200 rounded-2xl text-xs font-bold shadow-2xl animate-bounce",children:s}),m.jsx(JL,{isOpen:c,onClose:()=>d(!1),onCreate:T}),m.jsx(t8,{isOpen:!!y,onClose:()=>b(null),project:y,onUpdate:N}),m.jsx(r8,{isOpen:!!p,onClose:()=>v(null),onConfirm:C,title:"Eliminar Proyecto?",message:`Ests a punto de borrar "${p}" y todo su contenido permanentemente. Esta accin no se puede deshacer.`,confirmText:"Eliminar Universo",isDestructive:!0})]})},i8={save:"Guardar",saved:"Guardado",saving:"Guardando...",cancel:"Cancelar",delete:"Borrar",edit:"Editar",create:"Crear",back:"Volver",loading:"Cargando...",search:"Buscar...",no_results:"Sin resultados",confirm_delete:"Eliminar",are_you_sure:"Ests seguro de que quieres eliminar este elemento? Esta accin no se puede deshacer.",architect:"Arquitecto",confirm_delete_btn:"S, borrar",view_all:"Ver todos",rename:"Renombrar",error_delete:"Error al eliminar el elemento"},a8={dashboard:"Panel de Control",bible:"Biblia del Mundo",atlas:"Atlas",writing:"Escritura",settings:"Ajustes",logout:"Salir al Hub",chronology:"Cronologa",graph:"Grafo"},s8={title:"Ajustes",general:"General",appearance:"Apariencia",language:"Idioma",theme:"Tema",font:"Tipografa",font_size:"Tamao del Texto",unauthorized:"No autorizado",sync:"Sincronizacin",backup:"Respaldo",edit_template:"Editar Plantilla",available_templates:"Plantillas Disponibles",no_templates:"Sin Plantillas",is_global:"Es Global?",name:"Nombre",type:"Tipo"},o8={title:"Escritura",library:"Biblioteca del Arquitecto",library_desc:"Gestiona tus Archivadores y Crnicas",new_notebook:"Nuevo Archivador",new_page:"Nueva Hoja",index:"ndice",notes:"Notas",format:"Formato",empty:"Pgina vaca...",active_notebook:"Archivador Activo",open_archivador:"Abrir Archivador",book_title:"Ttulo del Libro",placeholder_title:"Las Crnicas del Vaco...",create_and_open:"Crear y Abrir",expansion:"Expansin de la Biblioteca",delete_confirm:"Seguro que quieres borrar este archivador? Se perdern todas sus hojas."},l8={grid_system:"Sistema de Rejilla",size:"Tamao",canvas_data:"Datos del Lienzo",width:"Ancho (px)",height:"Alto (px)",background_image:"Imagen de Fondo",upload_image:"Subir Nueva Imagen",remove_image:"Eliminar Imagen",explorer:"Explorador de Mundo",not_found:"Imagen del Mapa no Encontrada",upload_desc:"Sube una imagen del mapa en el editor para comenzar",fullscreen:"Pantalla Completa",share:"Compartir",inhabitants:"Habitantes Clave",related_events:"Eventos Relacionados",open_bible:"Abrir en la Biblia",place:"Lugar",capital:"Capital",new_map:"Nuevo Mapa"},u8={explore:"Explorar",explorer:"Explorador",templates:"Plantillas",drag_attributes:"Arrastrar Atributos",search_entity:"Buscar entidad...",filter_type:"Filtrar por Tipo",all:"Todos",entities:"Entidades",maps:"Mapas",timelines:"Lneas de Tiempo",new_folder:"Nueva Carpeta",new_timeline:"Nueva Lnea de Tiempo",delete_folder:"Borrar Carpeta",delete_folder_msg:"Seguro que quieres borrar esta carpeta y todo su contenido?",delete_entity:"Borrar Entidad",delete_entity_msg:"Seguro que quieres borrar esta entidad de la Biblia?",no_favorites:"Sin favoritos an",favorites:"Favoritos",root_index:"ndice Raz",central_archive:"Archivo central de todas las entidades, cronologas y registros geogrficos del mundo.",empty_archive:"Archivo Vaco",empty_archive_desc:"Comienza creando tu primera carpeta o lnea de tiempo para organizar el conocimiento."},c8={title:"Lnea de Tiempo",add_event:"Aadir Evento",add_line:"Nueva Lnea de Tiempo",edit_event:"Editar Evento",edit_line:"Editar Lnea de Tiempo",delete_event:"Eliminar Evento",delete_line:"Eliminar Lnea de Tiempo",events_tab:"Eventos",annexes_tab:"Anexos",linked_timelines:"Lneas de Tiempo Vinculadas",available_timelines:"Lneas de Tiempo Disponibles",multiverse:"Multiverso",new_universe:"Nuevo Universo",universe_settings:"Ajustes del Universo",delete_universe_confirm:"Eliminar este universo y TODAS sus lneas de tiempo? Esta accin no se puede deshacer.",select_timeline:"Seleccionar Lnea",no_events:"Sin eventos an. Usa el panel derecho para aadir uno.",event_name:"Nombre del Evento",date_label:"Etiqueta de Fecha",order:"Orden (Sorteo)",description:"Descripcin",save_changes:"Guardar Cambios",create_event:"Crear Evento",delete_event_btn:"Eliminar Evento",annexed_desc:"Vincula otras lneas de tiempo localizadas a esta para verificar la consistencia cronolgica.",no_linked:"Sin lneas vinculadas.",available_to_link:"Disponibles para Vincular",no_available:"No hay otras lneas disponibles.",universe_name:"Nombre del Universo",universe_desc:"Contexto para este universo...",add_timeline_here:"Aadir Lnea de Tiempo aqu",no_timelines:"No hay lneas aqu"},d8={title:"Lingstica",lexicon:"Lxico",grammar:"Reglas de Gramtica",writing_system:"Sistema de Escritura",phonology:"Fonologa",translator:"Traductor",new_word:"Aadir Nueva Palabra",new_rule:"Definir Nueva Regla",open_editor:"Abrir Editor",auto_saved:"Auto-guardado",desc:"Una lengua perteneciente a {{projectName}}. Gestiona su lxico, reglas gramaticales y sistemas de escritura aqu.",stats:{words:"Palabras",rules:"Reglas",glyphs:"Glifos"},search_lexicon:"Buscar palabra o significado...",manage:"Gestionar",moon_script:"Escritura Lunar",inventory:"Inventario de Vocales",vectors:"Smbolos Vectoriales",upload_svg:"Subir SVG",live_stream:"Flujo Logogrfico en Vivo",rendered_output:"Salida Renderizada",source_text:"Texto de origen aqu..."},h8={common:i8,nav:a8,settings:s8,writing:o8,atlas:l8,bible:u8,timeline:c8,linguistics:d8},f8={save:"Save",saved:"Saved",saving:"Saving...",cancel:"Cancel",delete:"Delete",edit:"Edit",create:"Create",back:"Back",loading:"Loading...",search:"Search...",no_results:"No results",confirm_delete:"Delete",are_you_sure:"Are you sure you want to delete this item? This action cannot be undone.",architect:"Architect",confirm_delete_btn:"Yes, delete",view_all:"View All",rename:"Rename",error_delete:"Error deleting item"},p8={dashboard:"Dashboard",bible:"World Bible",atlas:"Atlas",writing:"Writing",settings:"Settings",logout:"Exit to Hub",chronology:"Chronology",graph:"Graph"},m8={title:"Settings",general:"General",appearance:"Appearance",language:"Language",theme:"Theme",font:"Typography",font_size:"Font Size",unauthorized:"Unauthorized",sync:"Synchronization",backup:"Backup",edit_template:"Edit Template",available_templates:"Available Templates",no_templates:"No Templates",is_global:"Is Global?",name:"Name",type:"Type"},g8={title:"Writing",library:"Architect's Library",library_desc:"Manage your Archives and Chronicles",new_notebook:"New Archivador",new_page:"New Page",index:"Index",notes:"Notes",format:"Format",empty:"Empty page...",active_notebook:"Active Archivador",open_archivador:"Open Archivador",book_title:"Book Title",placeholder_title:"The Chronicles of the Void...",create_and_open:"Create and Open",expansion:"Library Expansion",delete_confirm:"Are you sure you want to delete this archivador? All its pages will be lost."},v8={grid_system:"Grid System",size:"Size",canvas_data:"Canvas Data",width:"Width (px)",height:"Height (px)",background_image:"Background Image",upload_image:"Upload New Image",remove_image:"Remove Image",explorer:"World Explorer",not_found:"Map Image Not Found",upload_desc:"Upload a map image in the editor to get started",fullscreen:"Fullscreen",share:"Share",inhabitants:"Key Inhabitants",related_events:"Related Events",open_bible:"Open in Bible",place:"Place",capital:"Capital",new_map:"New Map"},y8={explore:"Explore",explorer:"Explorer",templates:"Templates",drag_attributes:"Drag Attributes",search_entity:"Search entity...",filter_type:"Filter by Type",all:"All",entities:"Entities",maps:"Maps",timelines:"Timelines",new_folder:"New Folder",new_timeline:"New Timeline",delete_folder:"Delete Folder",delete_folder_msg:"Are you sure you want to delete this folder and all its contents?",delete_entity:"Delete Entity",delete_entity_msg:"Are you sure you want to delete this entity from the Bible?",no_favorites:"No favorites yet",favorites:"Favorites",root_index:"Root Index",central_archive:"Central archive of all entities, timelines, and world geographical records.",empty_archive:"Empty Archive",empty_archive_desc:"Start by creating your first folder or timeline to organize knowledge."},x8={title:"Timeline",add_event:"Add Event",add_line:"New Timeline",edit_event:"Edit Event",edit_line:"Edit Timeline",delete_event:"Delete Event",delete_line:"Delete Timeline",events_tab:"Events",annexes_tab:"Annexes",linked_timelines:"Linked Timelines",available_timelines:"Available Timelines",multiverse:"Multiverse",new_universe:"New Universe",universe_settings:"Universe Settings",delete_universe_confirm:"Delete this universe and ALL its timelines? This cannot be undone.",select_timeline:"Select Timeline",no_events:"No events yet. Use the right panel to add one.",event_name:"Event Name",date_label:"Date Label",order:"Order (Sort)",description:"Description",save_changes:"Save Changes",create_event:"Create Event",delete_event_btn:"Delete Event",annexed_desc:"Link other localized timelines to this one to verify chronological consistency.",no_linked:"No linked timelines.",available_to_link:"Available to Link",no_available:"No other timelines available.",universe_name:"Universe Name",universe_desc:"Context for this universe...",add_timeline_here:"Add Timeline here",no_timelines:"No timelines here"},b8={title:"Linguistics",lexicon:"Lexicon",grammar:"Grammar Rules",writing_system:"Writing System",phonology:"Phonology",translator:"Translator",new_word:"Add New Word",new_rule:"Define New Rule",open_editor:"Open Editor",auto_saved:"Auto-Saved",desc:"A conlang belonging to {{projectName}}. Manage its lexicon, grammar rules, and writing systems here.",stats:{words:"Words",rules:"Rules",glyphs:"Glyphs"},search_lexicon:"Search word or meaning...",manage:"Manage",moon_script:"Moon Script",inventory:"Vowel Inventory",vectors:"Vector Symbols",upload_svg:"Upload SVG",live_stream:"Live Logographic Stream",rendered_output:"Rendered Output",source_text:"Source text here..."},w8={common:f8,nav:p8,settings:m8,writing:g8,atlas:v8,bible:y8,timeline:x8,linguistics:b8},b4=ce.createContext(),_8={es:h8,en:w8},S8=({children:r})=>{const[e,n]=ce.useState(()=>{const s=localStorage.getItem("app_settings");if(s)try{return JSON.parse(s).language||"es"}catch{return"es"}return"es"}),i=s=>{const o=s.split(".");let l=_8[e];for(const u of o)if(l&&l[u])l=l[u];else return s;return l},a=s=>{n(s);const o=localStorage.getItem("app_settings");let l={};if(o)try{l=JSON.parse(o)}catch{}localStorage.setItem("app_settings",JSON.stringify({...l,language:s}))};return m.jsx(b4.Provider,{value:{language:e,t:i,changeLanguage:a},children:r})},Xu=()=>{const r=ce.useContext(b4);if(!r)throw new Error("useLanguage must be used within a LanguageProvider");return r},Rf=({icon:r,title:e,desc:n,color:i,onClick:a})=>m.jsxs("div",{onClick:a,className:"group relative p-8 rounded-[32px] bg-surface-dark border border-white/5 hover:border-white/10 transition-all cursor-pointer flex flex-col h-full gap-6 hover:shadow-2xl hover:shadow-black/40",children:[m.jsx("div",{className:`size-14 rounded-2xl ${i} flex items-center justify-center text-white shadow-lg group-hover:scale-110 transition-all duration-500`,children:m.jsx("span",{className:"material-symbols-outlined text-3xl",children:r})}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("h3",{className:"text-2xl font-bold text-white tracking-tight",children:e}),m.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:n})]}),m.jsxs("div",{className:"mt-auto pt-6 border-t border-white/5 flex items-center justify-between text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-white transition-colors",children:[m.jsx("span",{children:t("project.explore_tool")}),m.jsx("span",{className:"material-symbols-outlined text-sm group-hover:translate-x-1 transition-transform",children:"arrow_forward"})]})]}),k8=()=>{const{projectName:r}=au(),e=Na(),{username:n}=Yi(),{t:i}=Xu(),a=`/${n}/${r}`,[s,o]=Xt.useState(null);return Xt.useEffect(()=>{const l=localStorage.getItem("user");l&&l!=="undefined"&&o(JSON.parse(l))},[]),m.jsxs("div",{className:"flex-1 flex flex-col h-screen overflow-hidden bg-background-dark",children:[m.jsxs("div",{className:"h-20 border-b border-white/5 flex items-center justify-between px-12 bg-surface-dark/20 backdrop-blur-xl shrink-0",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:"size-10 rounded-xl bg-primary/20 flex items-center justify-center text-primary shadow-lg shadow-primary/10",children:m.jsx("span",{className:"material-symbols-outlined",children:"auto_stories"})}),m.jsxs("div",{children:[m.jsx("h1",{className:"text-xl font-black text-white tracking-tight uppercase",children:r}),m.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:i("project.dashboard_desc")})]})]}),m.jsx("div",{className:"flex items-center gap-4",children:m.jsx("div",{className:"flex -space-x-2",children:m.jsx("div",{className:"size-8 rounded-full border-2 border-surface-dark bg-indigo-500 overflow-hidden flex items-center justify-center text-[10px] font-black text-white shadow-lg",children:s?.avatarUrl?m.jsx("img",{src:s.avatarUrl,alt:"Me",className:"w-full h-full object-cover"}):m.jsx("span",{children:(s?.displayName||n)?.substring(0,2).toUpperCase()})})})})]}),m.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:m.jsxs("div",{className:"max-w-7xl mx-auto p-12 space-y-16 animate-in fade-in slide-in-from-bottom-8 duration-700",children:[m.jsxs("div",{className:"space-y-4 max-w-2xl",children:[m.jsxs("h2",{className:"text-4xl font-black text-white tracking-tighter leading-tight",children:[i("project.welcome")," ",m.jsx("span",{className:"text-indigo-400",children:s?.displayName||i("common.architect")}),"."]}),m.jsx("p",{className:"text-slate-400 text-lg font-serif italic leading-relaxed opacity-80",children:"Tu mundo est esperando ser esculpido. Utiliza el Codex para documentar entidades, el Atlas para trazar geografas o las Crnicas para escribir su historia."})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[m.jsx(Rf,{icon:"menu_book",title:i("project.codex_title"),desc:i("project.codex_desc"),color:"bg-indigo-600 shadow-indigo-500/20",onClick:()=>e(`${a}/bible`)}),m.jsx(Rf,{icon:"map",title:i("project.atlas_title"),desc:i("project.atlas_desc"),color:"bg-emerald-600 shadow-emerald-500/20",onClick:()=>e(`${a}/map`)}),m.jsx(Rf,{icon:"edit_note",title:i("project.chronicles_title"),desc:i("project.chronicles_desc"),color:"bg-amber-600 shadow-amber-500/20",onClick:()=>e(`${a}/writing`)}),m.jsx(Rf,{icon:"hub",title:i("project.graph_title"),desc:i("project.graph_desc"),color:"bg-purple-600 shadow-purple-500/20",onClick:()=>e(`${a}/graph`)}),m.jsx(Rf,{icon:"calendar_month",title:i("project.timeline_title"),desc:i("project.timeline_desc"),color:"bg-rose-600 shadow-rose-500/20",onClick:()=>e(`${a}/timeline`)}),m.jsx(Rf,{icon:"translate",title:i("project.linguistics_title"),desc:i("project.linguistics_desc"),color:"bg-blue-600 shadow-blue-500/20",onClick:()=>e(`${a}/linguistics`)})]})]})})]})},C8=()=>{const r=Na(),[e,n]=ce.useState(null),[i,a]=ce.useState([]),[s,o]=ce.useState([]),[l,u]=ce.useState("general"),[c,d]=ce.useState([]),[p,v]=ce.useState({theme:"deep_space",font:"Outfit",fontSize:16});ce.useEffect(()=>{try{const I=localStorage.getItem("user");I&&I!=="undefined"&&n(JSON.parse(I));const z=localStorage.getItem("app_settings");z&&v(JSON.parse(z));const V=localStorage.getItem("sync_projects");V&&o(JSON.parse(V)),y()}catch(I){console.error("Failed to parse user settings",I)}},[]);const y=async()=>{try{const I=await rt.get("/workspaces");I&&a(I)}catch(I){console.error("Error loading projects for sync",I)}},b=(I,z="success")=>{const V=Date.now();d($=>[...$,{id:V,message:I,type:z}]),setTimeout(()=>{d($=>$.filter(Y=>Y.id!==V))},3e3)},S=(I,z)=>{const V={...p,[I]:z};v(V),localStorage.setItem("app_settings",JSON.stringify(V)),window.dispatchEvent(new Event("storage_update")),b(`Ajuste actualizado: ${I}`)},k=I=>{const z=s.includes(I),V=z?s.filter($=>$!==I):[...s,I];o(V),localStorage.setItem("sync_projects",JSON.stringify(V)),b(z?"Universo desmarcado de sincronizacin":"Universo incluido en sincronizacin")},T=()=>{b("Iniciando descarga de backup...","info");const I=document.createElement("a"),z="/api/backup/download",V=s.length>0?`?projects=${s.join(",")}`:"";I.href=z+V,I.setAttribute("download",`worldbuilding_backup_${Date.now()}.zip`),document.body.appendChild(I),I.click(),document.body.removeChild(I)},C=Xt.useRef(null),N=async I=>{const z=I.target.files[0];if(!z)return;if(!z.name.endsWith(".db")){b("Solo se permiten archivos .db","error");return}const V=new FormData;V.append("file",z),b("Importando universo...","info");try{const $=await rt.post("/import/database",V);b($.message||"Universo importado con xito"),y()}catch($){console.error("Import error",$);const Y=$.response?.data?.error||"Error al importar el archivo";b(Y,"error")}C.current&&(C.current.value="")},P=I=>{const z=I.target.files[0];if(!z)return;if(z.size>1024*1024){b("Imagen demasiado grande (mx 1MB)","error");return}const V=new FileReader;V.onload=$=>{const Y=$.target.result,D={...e||{},avatarUrl:Y};n(D);try{localStorage.setItem("user",JSON.stringify(D)),b("Foto de perfil actualizada","success")}catch(q){b("Error al guardar imagen (memoria llena)","error"),console.error("Storage error",q)}},V.readAsDataURL(z)},R=(I,z)=>{const V={...e||{},[I]:z};n(V),localStorage.setItem("user",JSON.stringify(V)),window.dispatchEvent(new Event("storage_update"))},O=[{id:"general",label:"General / Sincro",icon:"person"},{id:"appearance",label:"Apariencia y Editor",icon:"palette"}],B=[{id:"deep_space",label:"Deep Space",color:"#0f172a"},{id:"nebula",label:"Nebula",color:"#312e81"},{id:"high_contrast",label:"High Contrast",color:"#000000"}];return m.jsxs("div",{className:"flex flex-col w-full h-full bg-[#050508] text-white font-sans overflow-hidden relative",children:[m.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden opacity-50",children:[m.jsx("div",{className:"absolute -top-[10%] -left-[10%] size-[40%] bg-indigo-500/10 blur-[120px] rounded-full animate-pulse"}),m.jsx("div",{className:"absolute -bottom-[10%] -right-[10%] size-[40%] bg-purple-500/5 blur-[120px] rounded-full animate-pulse",style:{animationDelay:"1s"}})]}),m.jsx("div",{className:"fixed top-24 right-8 z-[100] flex flex-col gap-3",children:c.map(I=>m.jsxs("div",{className:"flex items-center gap-3 px-6 py-4 bg-surface-dark border border-white/10 rounded-2xl shadow-2xl animate-slide-in-right",children:[m.jsx("span",{className:`material-symbols-outlined ${I.type==="success"?"text-green-400":"text-indigo-400"}`,children:I.type==="success"?"check_circle":"info"}),m.jsx("span",{className:"text-sm font-bold",children:I.message})]},I.id))}),m.jsxs("header",{className:"h-20 flex-none flex items-center justify-between px-12 border-b border-white/5 bg-[#0a0a0e] z-30",children:[m.jsxs("div",{className:"flex items-center gap-8",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:"size-10 rounded-xl bg-indigo-500 flex items-center justify-center text-white shadow-lg shadow-indigo-500/20",children:m.jsx("span",{className:"material-symbols-outlined text-2xl",children:"settings"})}),m.jsx("h1",{className:"text-xl font-bold tracking-tight hidden sm:block",children:"Ajustes"})]}),m.jsx("nav",{className:"flex items-center gap-2 p-1 bg-white/5 rounded-2xl",children:O.map(I=>m.jsxs("button",{onClick:()=>u(I.id),className:`flex items-center gap-2 px-5 py-2.5 rounded-xl text-xs font-bold transition-all ${l===I.id?"bg-indigo-500 text-white shadow-lg shadow-indigo-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:I.icon}),I.label]},I.id))})]}),m.jsxs("button",{onClick:()=>r(-1),className:"flex items-center gap-2 px-6 py-2.5 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl transition-all text-xs font-bold text-slate-400 hover:text-white",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"}),m.jsx("span",{children:"Volver"})]})]}),m.jsx("main",{className:"flex-1 overflow-y-auto p-12 custom-scrollbar",children:m.jsxs("div",{className:"max-w-3xl mx-auto pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[l==="general"&&m.jsxs("div",{className:"space-y-6",children:[m.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8",children:[m.jsxs("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2 text-indigo-400",children:[m.jsx("span",{className:"material-symbols-outlined",children:"person"}),"Perfil de Arquitecto"]}),m.jsxs("div",{className:"flex items-center gap-6 p-6 bg-white/5 rounded-3xl border border-white/5 group relative overflow-hidden",children:[m.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"}),m.jsxs("div",{className:"relative",children:[m.jsx("div",{className:"size-20 rounded-full bg-indigo-500 flex items-center justify-center text-white text-3xl font-black shadow-2xl border-4 border-white/10 overflow-hidden",children:e?.avatarUrl?m.jsx("img",{src:e.avatarUrl,alt:"Profile",className:"w-full h-full object-cover"}):e?.displayName?.substring(0,2).toUpperCase()||e?.username?.substring(0,2).toUpperCase()||"AR"}),m.jsxs("label",{className:"absolute -bottom-1 -right-1 size-8 bg-indigo-500 rounded-full flex items-center justify-center text-white cursor-pointer hover:scale-110 transition-all border-4 border-[#0f0f13] shadow-lg",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"photo_camera"}),m.jsx("input",{type:"file",accept:"image/*",onChange:P,className:"hidden"})]})]}),m.jsxs("div",{className:"flex-1 space-y-2",children:[m.jsx("input",{type:"text",value:e?.displayName??"",onChange:I=>R("displayName",I.target.value),placeholder:e?.username||"Tu nombre de arquitecto...",className:"bg-transparent border-none text-2xl font-black text-white outline-none focus:ring-0 w-full p-0 placeholder-white/20"}),m.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:"Architect Rank  Local Session"})]})]})]}),m.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8 space-y-6",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-indigo-400",children:[m.jsx("span",{className:"material-symbols-outlined",children:"sync_lock"}),"Sincronizacin y Respaldo"]}),m.jsxs("div",{className:"flex gap-3",children:[m.jsx("input",{type:"file",ref:C,onChange:N,accept:".db",className:"hidden"}),m.jsxs("button",{onClick:()=>C.current?.click(),className:"flex items-center gap-2 px-6 py-3 border border-white/5 bg-white/5 hover:bg-white/10 text-white rounded-2xl text-xs font-black uppercase tracking-widest transition-all",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"upload_file"}),"Importar Universo"]}),m.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-6 py-3 bg-indigo-500 hover:bg-indigo-600 text-white rounded-2xl text-xs font-black uppercase tracking-widest transition-all shadow-lg shadow-indigo-500/30",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"cloud_download"}),"Descargar Backup ZIP"]})]})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 block",children:"Universos para sincronizacin"}),m.jsx("div",{className:"grid grid-cols-2 gap-3",children:i.length>0?i.map(I=>m.jsxs("button",{onClick:()=>k(I.filename),className:`flex items-center gap-3 p-4 rounded-2xl border transition-all text-left ${s.includes(I.filename)?"border-indigo-500 bg-indigo-500/10 text-white":"border-white/5 bg-black/20 text-slate-400 hover:border-white/10"}`,children:[m.jsx("span",{className:"material-symbols-outlined text-lg",children:s.includes(I.filename)?"check_circle":"circle"}),m.jsx("div",{className:"truncate",children:m.jsx("p",{className:"text-xs font-bold truncate",children:I.title})})]},I.filename)):m.jsx("div",{className:"col-span-2 p-8 border border-dashed border-white/5 rounded-2xl text-center text-slate-600 text-xs italic text-glass-muted",children:"No hay universos detectados..."})})]})]})]}),l==="appearance"&&m.jsxs("div",{className:"space-y-6",children:[m.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8",children:[m.jsxs("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2 text-indigo-400",children:[m.jsx("span",{className:"material-symbols-outlined",children:"palette"}),"Esttica del Sistema"]}),m.jsx("div",{className:"grid grid-cols-3 gap-6",children:B.map(I=>m.jsxs("button",{onClick:()=>S("theme",I.id),className:`relative flex flex-col gap-3 group text-left transition-all p-3 rounded-2xl border ${p.theme===I.id?"border-indigo-500 bg-indigo-500/5 ring-1 ring-indigo-500/50":"border-white/5 bg-black/20 hover:border-white/20"}`,children:[m.jsx("div",{className:"h-24 rounded-xl flex items-center justify-center overflow-hidden",style:{backgroundColor:I.color},children:m.jsx("div",{className:"size-10 rounded-full bg-white/10 backdrop-blur-xl border border-white/10"})}),m.jsx("span",{className:"text-xs font-bold text-center",children:I.label})]},I.id))})]}),m.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8",children:[m.jsxs("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2 text-indigo-400",children:[m.jsx("span",{className:"material-symbols-outlined",children:"text_fields"}),"Tipografa y Lectura"]}),m.jsxs("div",{className:"grid grid-cols-2 gap-12",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Fuente del Codex"}),m.jsxs("div",{className:"relative",children:[m.jsxs("select",{value:p.font,onChange:I=>S("font",I.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl px-5 py-3.5 text-sm text-white appearance-none outline-none focus:border-indigo-500 transition-all",style:{fontFamily:p.font},children:[m.jsx("option",{value:"Lexend",children:"Lexend (UI Moderna)"}),m.jsx("option",{value:"Outfit",children:"Outfit (Sleek)"}),m.jsx("option",{value:"Cormorant Garamond",children:"Cormorant (Legendaria)"}),m.jsx("option",{value:"Playfair Display",children:"Playfair (Elegante)"}),m.jsx("option",{value:"JetBrains Mono",children:"JetBrains Mono (Codex)"})]}),m.jsx("span",{className:"material-symbols-outlined absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-500",children:"expand_more"})]})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Tamao del Texto"}),m.jsxs("span",{className:"text-xs font-bold text-indigo-400",children:[p.fontSize,"px"]})]}),m.jsx("div",{className:"flex items-center gap-4 py-3",children:m.jsx("input",{type:"range",min:"12",max:"24",value:p.fontSize,onChange:I=>S("fontSize",parseInt(I.target.value)),className:"flex-1 accent-indigo-500 h-1 bg-white/10 rounded-full appearance-none cursor-pointer"})})]})]}),m.jsxs("div",{className:"mt-12 space-y-4 border-t border-white/5 pt-8",children:[m.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Preferencia de Idioma / Language"}),m.jsxs("div",{className:"flex gap-4",children:[m.jsxs("button",{onClick:()=>S("language","es"),className:`flex-1 py-4 rounded-2xl border transition-all flex items-center justify-center gap-3 font-bold text-xs ${p.language==="es"||!p.language?"border-primary bg-primary/10 text-white shadow-lg":"border-white/5 bg-black/20 text-slate-400"}`,children:[m.jsx("span",{className:"text-xl",children:""}),"Castellano"]}),m.jsxs("button",{onClick:()=>S("language","en"),className:`flex-1 py-4 rounded-2xl border transition-all flex items-center justify-center gap-3 font-bold text-xs ${p.language==="en"?"border-primary bg-primary/10 text-white shadow-lg":"border-white/5 bg-black/20 text-slate-400"}`,children:[m.jsx("span",{className:"text-xl",children:""}),"English"]})]})]}),m.jsx("div",{className:"mt-8 p-6 bg-black/40 rounded-2xl border border-white/5 text-center shadow-inner",children:m.jsx("p",{style:{fontFamily:p.font,fontSize:`${p.fontSize}px`},className:"text-slate-200 transition-all duration-300",children:'"El universo es un libro escrito en el lenguaje de las historias."'})})]})]})]})})]})},av=({isOpen:r,onClose:e,onConfirm:n,title:i,message:a,confirmText:s="Confirmar",cancelText:o="Cancelar",type:l="danger"})=>r?iu.createPortal(m.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[m.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),m.jsxs("div",{className:"relative w-full max-w-md bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl p-6 animate-in zoom-in-95 duration-200 overflow-hidden",children:[m.jsx("div",{className:"absolute top-0 left-0 right-0 h-32 bg-gradient-to-b from-white/5 to-transparent pointer-events-none"}),m.jsxs("div",{className:"relative z-10 text-center",children:[m.jsx("div",{className:`mx-auto mb-4 size-16 rounded-2xl flex items-center justify-center ${l==="danger"?"bg-red-500/10 text-red-500":"bg-yellow-500/10 text-yellow-500"}`,children:m.jsx("span",{className:"material-symbols-outlined text-3xl",children:l==="danger"?"delete_forever":"warning"})}),m.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:i}),m.jsx("p",{className:"text-text-muted text-sm mb-8 leading-relaxed",children:a}),m.jsxs("div",{className:"flex gap-3",children:[m.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 rounded-xl bg-surface-light hover:bg-white/10 text-text-muted hover:text-white text-xs font-bold transition-all border border-white/5",children:o}),m.jsx("button",{onClick:()=>{n(),e()},className:`flex-1 px-4 py-3 rounded-xl text-white text-xs font-bold transition-all shadow-lg flex items-center justify-center gap-2
                                ${l==="danger"?"bg-red-500 hover:bg-red-600 shadow-red-500/20":"bg-primary hover:bg-primary-light shadow-primary/20"}`,children:m.jsx("span",{children:s})})]})]})]})]}),document.body):null,Zk=({compact:r=!1})=>{const[e,n]=ce.useState(null),[i,a]=ce.useState([]),[s,o]=ce.useState(!1),[l,u]=ce.useState(null);ce.useEffect(()=>{c()},[]);const c=async()=>{try{const y=await rt.get("/world-bible/folders");y.length>0&&n(y[0].id),d()}catch(y){console.error("Init error:",y)}},d=async()=>{o(!0);try{const y=await rt.get("/world-bible/templates/global");a(y)}catch(y){console.error("Error loading templates:",y)}finally{o(!1)}},p=async y=>{if(e)try{await rt.post(`/world-bible/folders/${e}/templates`,{nombre:y.label,tipo:y.type,required:y.required,metadata:y.metadata?JSON.stringify(y.metadata):null,global:!0}),d()}catch(b){console.error("Error creating template:",b)}},v=async()=>{if(l)try{await rt.delete(`/world-bible/templates/${l}`),a(y=>y.filter(b=>b.id!==l))}catch(y){console.error("Error deleting template:",y)}finally{u(null)}};return m.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[m.jsxs(Lr,{className:`${r?"p-4 bg-transparent border-none shadow-none":"p-8 space-y-8"}`,children:[m.jsx("header",{className:`flex ${r?"flex-col gap-4":"justify-between items-center"}`,children:m.jsxs("div",{children:[m.jsx("h3",{className:`${r?"text-sm":"text-xl"} font-bold text-white`,children:"Atributos Globales"}),m.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Define atributos disponibles para todas las entidades."})]})}),m.jsxs("div",{className:"space-y-4",children:[s?m.jsx("div",{className:"text-center p-4 text-slate-500",children:"Cargando plantillas..."}):i.map((y,b)=>m.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-primary/50 hover:bg-white/5 transition-all cursor-grab active:cursor-grabbing group select-none",draggable:!0,onDragStart:S=>{S.dataTransfer.setData("application/reactflow/type","attribute"),S.dataTransfer.setData("templateId",y.id),S.dataTransfer.setData("templateData",JSON.stringify(y)),S.dataTransfer.effectAllowed="copy"},children:[m.jsxs("span",{className:"text-[10px] font-black text-slate-700 w-6 group-hover:text-primary transition-colors",children:["0",b+1]}),m.jsxs("div",{className:"flex-1 pointer-events-none",children:[m.jsx("div",{className:"text-sm font-bold text-white",children:y.nombre}),m.jsxs("div",{className:"text-[10px] text-slate-500 uppercase tracking-widest",children:[y.tipo," ",y.esObligatorio&&" Required"]}),y.metadata&&m.jsx("div",{className:"text-[10px] text-slate-600 font-mono mt-1 truncate",children:y.metadata})]}),m.jsx("button",{onClick:()=>u(y.id),className:"p-1.5 text-slate-500 hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",title:"Eliminar Plantilla Global",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},y.id)),m.jsx(E8,{onAdd:p})]})]}),m.jsx(av,{isOpen:!!l,onClose:()=>u(null),onConfirm:v,title:"Eliminar Plantilla",message:"Ests seguro de que quieres eliminar esta plantilla? Esta accin es irreversible.",confirmText:"Eliminar",type:"danger"})]})},E8=({onAdd:r})=>{const[e,n]=ce.useState(""),[i,a]=ce.useState("text"),[s,o]=ce.useState(!1),[l,u]=ce.useState([""]),c=()=>u([...l,""]),d=y=>u(l.filter((b,S)=>S!==y)),p=(y,b)=>{const S=[...l];S[y]=b,u(S)},v=()=>{if(!e)return;let y=null;["select","multi_select"].includes(i)&&(y={options:l.filter(b=>b.trim())}),r({label:e,type:i,required:s,metadata:y}),n(""),u([""])};return m.jsxs("div",{className:"p-4 rounded-2xl border-2 border-dashed border-white/10 bg-white/[0.01] space-y-4",children:[m.jsx("h4",{className:"text-xs font-black uppercase tracking-widest text-primary",children:"Add New Attribute"}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsx("input",{placeholder:"Field Name",value:e,onChange:y=>n(y.target.value),className:"bg-black/20 border border-white/5 rounded-xl px-4 py-2 text-xs text-white outline-none focus:border-primary/30 min-w-0"}),m.jsxs("select",{value:i,onChange:y=>a(y.target.value),className:"bg-black/20 border border-white/5 rounded-xl px-4 py-2 text-xs text-white outline-none",children:[m.jsx("option",{value:"text",children:"Text (Long)"}),m.jsx("option",{value:"short_text",children:"Text (Short)"}),m.jsx("option",{value:"number",children:"Number"}),m.jsx("option",{value:"date",children:"Date"}),m.jsx("option",{value:"select",children:"Single Selection (Dropdown)"}),m.jsx("option",{value:"multi_select",children:"Multiple Selection"}),m.jsx("option",{value:"boolean",children:"Switch (True/False)"})]})]}),["select","multi_select"].includes(i)&&m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Options"}),m.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-2 custom-scrollbar",children:l.map((y,b)=>m.jsxs("div",{className:"flex gap-2",children:[m.jsx("input",{placeholder:`Option ${b+1}`,value:y,onChange:S=>p(b,S.target.value),className:"flex-1 bg-black/20 border border-white/5 rounded-lg px-3 py-1.5 text-xs text-white outline-none focus:border-primary/30"}),m.jsx("button",{onClick:()=>d(b),className:"p-1.5 hover:bg-red-500/20 text-slate-500 hover:text-red-400 rounded-lg transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]},b))}),m.jsx("button",{onClick:c,className:"w-full py-1.5 text-[10px] font-bold uppercase tracking-widest text-primary hover:bg-primary/5 rounded-lg border border-dashed border-primary/20 transition-all",children:"+ Add Custom Option"})]}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[m.jsx("input",{type:"checkbox",checked:s,onChange:y=>o(y.target.checked),className:"size-4 rounded border-white/10 bg-white/5 accent-primary"}),m.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"Required Field"})]}),m.jsx("button",{onClick:v,className:"px-4 py-2 bg-primary/20 text-primary rounded-lg text-xs font-bold hover:bg-primary/30 transition-all",children:"+ Add Field"})]})]})},Yk=({projectName:r,storageKey:e})=>{const[n,i]=ce.useState([]),[a,s]=ce.useState(!1),[o,l]=ce.useState(null),u=()=>e||`notes_v2_${r}`;ce.useEffect(()=>{const C=u();if(!C)return;const N=localStorage.getItem(C);if(N)i(JSON.parse(N));else if(!e){const P=localStorage.getItem(`notes_${r}`);if(P){const R={id:Date.now(),title:"Nota General",content:P};i([R]),localStorage.setItem(C,JSON.stringify([R]))}}},[r,e]);const c=C=>{i(C);const N=u();N&&localStorage.setItem(N,JSON.stringify(C))},d=()=>{const C={id:Date.now(),title:"Nueva Nota",content:""};c([...n,C]),l(C.id)},[p,v]=ce.useState(null),y=C=>{v(C)},b=()=>{p&&(c(n.filter(C=>C.id!==p)),v(null))},S=(C,N,P)=>{c(n.map(R=>R.id===C?{...R,[N]:P}:R))},k=()=>s(!a),T=()=>m.jsxs("div",{className:`flex flex-col h-full bg-surface-dark/40 ${a?"":"max-h-[25vh]"}`,children:[m.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-glass-border bg-white/5",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"edit_note"}),m.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-white",children:["Notas (",n.length,")"]})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("button",{onClick:d,className:"p-1 hover:text-primary text-text-muted transition-colors",title:"Aadir Nota",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})}),m.jsx("button",{onClick:k,className:"p-1 hover:text-white text-text-muted transition-colors",title:"Pantalla Completa",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:a?"fullscreen_exit":"fullscreen"})})]})]}),m.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-2",children:n.length===0?m.jsx("div",{className:"py-8 text-center opacity-30 italic text-[10px] uppercase font-bold",children:"Sin notas"}):n.map(C=>m.jsxs("div",{className:"group bg-white/5 border border-glass-border rounded-xl overflow-hidden hover:border-primary/30 transition-all",children:[m.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white/5",children:[m.jsx("input",{className:"bg-transparent border-none text-[11px] font-bold text-white outline-none w-full",value:C.title,onChange:N=>S(C.id,"title",N.target.value),placeholder:"Ttulo..."}),m.jsx("button",{onClick:()=>y(C.id),className:"opacity-0 group-hover:opacity-100 p-1 text-text-muted hover:text-red-400 transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-xs",children:"delete"})})]}),m.jsx("textarea",{className:"w-full bg-transparent p-3 text-xs text-white/70 outline-none resize-none min-h-[80px] custom-scrollbar",value:C.content,onChange:N=>S(C.id,"content",N.target.value),placeholder:"Escribe el contenido aqu..."})]},C.id))}),m.jsx(av,{isOpen:!!p,onClose:()=>v(null),onConfirm:b,title:"Eliminar Nota",message:"Ests seguro de que quieres eliminar esta nota? No se podr recuperar.",confirmText:"Eliminar",type:"danger"})]});return a?m.jsx("div",{className:"fixed inset-0 z-[100] bg-background-dark/95 backdrop-blur-md p-8 flex flex-col items-center",children:m.jsx("div",{className:"w-full max-w-4xl h-full flex flex-col border border-glass-border rounded-3xl overflow-hidden shadow-2xl bg-surface-dark",children:m.jsx(T,{})})}):m.jsx("div",{className:"h-full border border-glass-border rounded-2xl overflow-hidden",children:m.jsx(T,{})})},hh=({to:r,icon:e,label:n,collapsed:i,end:a})=>m.jsxs(mL,{to:r,end:a,className:({isActive:s})=>`
            flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all group
            ${s?"bg-primary text-white shadow-lg shadow-primary/20":"text-text-muted hover:text-white hover:bg-white/5"}
            ${i?"justify-center":""}
        `,title:i?n:"",children:[m.jsx("span",{className:"material-symbols-outlined text-xl",children:e}),!i&&m.jsx("span",{className:"text-sm font-bold tracking-wide",children:n})]}),Xk=r=>{switch(r?.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},N8=()=>{console.log("ArchitectLayout Mounting");const{username:r,projectName:e,folderSlug:n}=Yi(),i=Na(),{t:a}=Xu(),s=Zh(),[o,l]=ce.useState(!0),[u,c]=ce.useState(!1),[d,p]=ce.useState("Loading..."),[v,y]=ce.useState(null),[b,S]=ce.useState("NOTES"),[k,T]=ce.useState(""),[C,N]=ce.useState([]),[P,R]=ce.useState(null),[O,B]=ce.useState(null),[I,z]=ce.useState({name:"",description:"",type:"regional",showGrid:!0,gridSize:50,width:800,height:600,bgImage:null}),[V,$]=ce.useState(null),[Y,D]=ce.useState("identity"),[q,G]=ce.useState("notes"),[Z,Q]=ce.useState(""),[J,ie]=ce.useState("ALL"),ne=s.pathname.includes("/bible"),W=s.pathname.includes("/writing"),[re,ae]=ce.useState("index"),[he,ve]=ce.useState(null),[xe,se]=ce.useState([]),[ge,le]=ce.useState("identity"),[pe,me]=ce.useState(null),be=(Ve,Oe)=>{Ve.stopPropagation(),me(Oe)},Se=async()=>{if(pe){try{await rt.delete(`/world-bible/templates/${pe}`),N(Ve=>Ve.filter(Oe=>Oe.id!==pe))}catch(Ve){console.error("Delete failed",Ve)}me(null)}},Ue=async Ve=>{Ve.preventDefault();try{await rt.put(`/world-bible/templates/${he.id}`,he),N(Oe=>Oe.map(et=>et.id===he.id?he:et)),ve(null)}catch(Oe){console.error("Update failed",Oe)}},We=`/${r}/${e}`;ce.useEffect(()=>{e&&gt(e);const Ve=()=>{e&&gt(e)};return window.addEventListener("focus",Ve),()=>window.removeEventListener("focus",Ve)},[e]);const gt=async Ve=>{try{const Oe=await rt.get(`/proyectos/${Ve}`);Oe&&(p(Oe.nombreProyecto),y(Oe.id))}catch(Oe){console.error("Error loading project:",Oe),p("Error"),i("/")}},[Je,at]=ce.useState(null);return ce.useEffect(()=>{const Ve=localStorage.getItem("user");Ve&&Ve!=="undefined"&&at(JSON.parse(Ve))},[]),m.jsxs("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark text-text-main font-sans selection:bg-primary/30",children:[m.jsxs("aside",{className:`
                    flex-none bg-surface-dark border-r border-glass-border transition-all duration-500 relative flex flex-col z-30
                    ${o?"w-80":"w-20"}
                `,children:[m.jsxs("div",{className:"h-16 flex items-center justify-center border-b border-glass-border relative",children:[o?m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"size-8 rounded-lg bg-surface-light flex items-center justify-center text-primary shadow-inner",children:m.jsx("span",{className:"material-symbols-outlined",children:s.pathname.includes("/writing")?"edit_note":s.pathname.includes("/graph")?"hub":s.pathname.includes("/bible")?"auto_stories":s.pathname.includes("/map")?"map":s.pathname.includes("/timeline")?"timeline":s.pathname.includes("/languages")?"translate":"auto_stories"})}),m.jsx("h2",{className:"text-sm font-black uppercase tracking-widest text-white truncate max-w-[150px]",children:d})]}):m.jsx("button",{onClick:()=>l(!0),className:"size-10 rounded-xl hover:bg-white/5 flex items-center justify-center text-text-muted hover:text-white transition-all",children:m.jsx("span",{className:"material-symbols-outlined",children:"menu"})}),o&&m.jsx("button",{onClick:()=>l(!1),className:"absolute right-4 text-text-muted hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"dock_to_left"})})]}),m.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar flex flex-col",children:m.jsxs("div",{className:"p-3 space-y-1",children:[m.jsx(hh,{to:We,icon:"home",label:a("nav.dashboard"),collapsed:!o,end:!0}),m.jsx(hh,{to:`${We}/bible`,icon:"menu_book",label:a("nav.bible"),collapsed:!o}),m.jsx(hh,{to:`${We}/map`,icon:"map",label:a("nav.atlas"),collapsed:!o}),m.jsx(hh,{to:`${We}/timeline`,icon:"calendar_month",label:a("nav.chronology"),collapsed:!o}),m.jsx(hh,{to:`${We}/graph`,icon:"hub",label:a("nav.graph"),collapsed:!o}),m.jsx("div",{className:"h-px bg-glass-border my-2 mx-2 opacity-50"}),m.jsx(hh,{to:`${We}/writing`,icon:"edit_note",label:a("nav.writing"),collapsed:!o}),m.jsx("div",{className:"h-px bg-glass-border my-2 mx-2 opacity-10"}),m.jsx(hh,{to:"/",icon:"logout",label:a("nav.logout"),collapsed:!o})]})}),m.jsx("footer",{className:"p-4 border-t border-glass-border",children:m.jsxs("div",{className:`flex items-center gap-3 ${!o&&"justify-center"}`,children:[m.jsx("div",{className:"size-10 rounded-full border border-glass-border p-1 bg-surface-light relative overflow-hidden",children:Je?.avatarUrl?m.jsx("img",{src:Je.avatarUrl,alt:"Me",className:"w-full h-full rounded-full object-cover"}):m.jsx("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-primary to-purple-500 flex items-center justify-center text-white font-black text-xs",children:(Je?.displayName||r)?.substring(0,2).toUpperCase()||"US"})}),o&&m.jsxs("div",{className:"overflow-hidden",children:[m.jsx("h4",{className:"text-xs font-bold text-white truncate",children:Je?.displayName||r||"User"}),m.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-tighter",children:a("common.architect")})]})]})})]}),m.jsxs("main",{className:"flex-1 flex flex-col min-w-0 bg-background-dark relative",children:[m.jsx("div",{className:"h-16 w-full absolute top-0 left-0 bg-gradient-to-b from-background-dark to-transparent pointer-events-none"}),m.jsx("div",{className:"flex-1 flex overflow-hidden relative",children:m.jsx(k_,{context:{setRightPanelMode:S,setRightOpen:c,setRightPanelTitle:T,projectName:d,projectId:v,availableTemplates:C,setAvailableTemplates:N,setAddAttributeHandler:R,setCreateTemplateHandler:B,mapSettings:I,setMapSettings:z,setOnMapSettingsChange:$,entityTabs:xe,setEntityTabs:se,activeEntityTab:ge,setActiveEntityTab:le,folderSearchTerm:Z,setFolderSearchTerm:Q,folderFilterType:J,setFolderFilterType:ie}})})]}),m.jsxs("aside",{className:`
                    flex-none bg-surface-dark border-l border-glass-border transition-all duration-500 relative flex flex-col z-30 shrink-0
                    ${u?"w-80":"w-20"}
                `,children:[m.jsx("header",{className:"h-16 flex items-center px-6 border-b border-glass-border justify-between shrink-0",children:u?m.jsxs(m.Fragment,{children:[b==="CUSTOM"&&!W?m.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-primary",children:k||"Panel"}):W?m.jsxs("div",{className:"flex bg-white/5 rounded-lg p-1 gap-1 w-full mr-4",children:[m.jsx("button",{onClick:()=>ae("index"),className:`flex-1 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${re==="index"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:a("writing.index")}),m.jsx("button",{onClick:()=>ae("notes"),className:`flex-1 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${re==="notes"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:a("writing.notes")})]}):ne&&b==="NOTES"?m.jsxs("div",{className:"flex bg-white/5 rounded-lg p-1 gap-1",children:[m.jsx("button",{onClick:()=>G("notes"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${q==="notes"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:a("writing.notes")}),m.jsx("button",{onClick:()=>G("templates"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${q==="templates"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:a("bible.templates")}),m.jsx("button",{onClick:()=>G("filters"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${q==="filters"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:a("bible.explore")})]}):m.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-white",children:k||a(b==="NOTES"?"settings.notes_global":"common.architect")}),m.jsx("button",{onClick:()=>c(!1),className:"text-text-muted hover:text-white transition-colors shrink-0",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"dock_to_right"})})]}):m.jsx("button",{onClick:()=>c(!0),className:"w-full h-full flex items-center justify-center text-text-muted hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined",children:b==="NOTES"||W?"edit_note":b==="MAP"?"map":b==="CUSTOM"?"build":"handyman"})})}),m.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar p-0 relative",children:[m.jsx("div",{id:"architect-right-panel-portal",className:`
                            ${(W||b==="CUSTOM")&&u?"flex flex-col h-full relative":"hidden"}
                        `}),u?W?m.jsx(m.Fragment,{children:m.jsx("div",{className:`h-full p-4 overflow-hidden ${re==="notes"?"block":"hidden"}`,children:m.jsx(Yk,{projectName:e})})}):b==="CUSTOM"?m.jsx(m.Fragment,{}):b==="NOTES"?q==="templates"&&ne?m.jsx("div",{className:"h-full overflow-y-auto no-scrollbar",children:m.jsx(Zk,{compact:!0})}):q==="filters"&&ne?m.jsxs("div",{className:"h-full p-6 space-y-6 animate-in fade-in slide-in-from-right-4",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Bsqueda"}),m.jsxs("div",{className:"bg-black/20 border border-white/10 rounded-xl p-3 flex items-center gap-2 focus-within:border-primary transition-colors",children:[m.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"search"}),m.jsx("input",{value:Z,onChange:Ve=>Q(Ve.target.value),placeholder:a("bible.search_entity"),className:"bg-transparent border-none outline-none text-sm text-white w-full placeholder-slate-600"}),Z&&m.jsx("button",{onClick:()=>Q(""),className:"text-slate-500 hover:text-white",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]})]}),m.jsx("div",{className:"h-px bg-glass-border"}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Filtrar por Tipo"}),m.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"ALL",label:a("bible.all"),icon:"grid_view"},{id:"ENTITY",label:a("bible.entities"),icon:"person"},{id:"MAP",label:a("bible.maps"),icon:"map"},{id:"TIMELINE",label:a("bible.timelines"),icon:"timeline"}].map(Ve=>m.jsxs("button",{onClick:()=>ie(Ve.id),className:`
                                                        p-3 rounded-xl border flex flex-col items-center gap-2 transition-all
                                                        ${J===Ve.id?"bg-primary text-white border-primary shadow-lg shadow-primary/20":"bg-white/5 border-transparent text-slate-500 hover:bg-white/10 hover:text-white"}
                                                    `,children:[m.jsx("span",{className:"material-symbols-outlined",children:Ve.icon}),m.jsx("span",{className:"text-[10px] font-bold uppercase",children:Ve.label})]},Ve.id))})]})]}):m.jsx("div",{className:"h-full p-4 overflow-hidden",children:m.jsx(Yk,{projectName:e})}):b==="MAP"?m.jsxs("div",{className:"p-6 space-y-8 animate-in fade-in slide-in-from-right-4",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Grid System"}),m.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[m.jsx("input",{type:"checkbox",checked:I.showGrid,onChange:Ve=>{const Oe={...I,showGrid:Ve.target.checked};z(Oe),V&&V(Oe)},className:"sr-only peer"}),m.jsx("div",{className:"w-9 h-5 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-primary"})]})]}),m.jsxs("div",{className:`space-y-2 transition-opacity ${I.showGrid?"opacity-100":"opacity-30 pointer-events-none"}`,children:[m.jsxs("div",{className:"flex justify-between text-xs font-bold text-white",children:[m.jsx("span",{children:"Size"}),m.jsxs("span",{className:"font-mono text-primary",children:[I.gridSize,"px"]})]}),m.jsx("input",{type:"range",min:"10",max:"200",step:"10",value:I.gridSize,onChange:Ve=>{const Oe={...I,gridSize:parseInt(Ve.target.value)};z(Oe),V&&V(Oe)},className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-primary"})]})]}),m.jsx("div",{className:"h-px bg-glass-border"}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:a("atlas.canvas_data")}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-1",children:[m.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:a("atlas.width")}),m.jsx("input",{type:"number",value:I.width,onChange:Ve=>{const Oe={...I,width:parseInt(Ve.target.value)};z(Oe),V&&V(Oe)},className:"w-full bg-black/20 border border-white/10 rounded-lg p-2 text-white text-right font-mono text-sm focus:border-primary outline-none"})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:a("atlas.height")}),m.jsx("input",{type:"number",value:I.height,onChange:Ve=>{const Oe={...I,height:parseInt(Ve.target.value)};z(Oe),V&&V(Oe)},className:"w-full bg-black/20 border border-white/10 rounded-lg p-2 text-white text-right font-mono text-sm focus:border-primary outline-none"})]})]})]}),m.jsx("div",{className:"h-px bg-glass-border"}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:a("atlas.background_image")}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("label",{className:"cursor-pointer bg-white/5 hover:bg-white/10 text-white rounded-lg px-3 py-2 text-xs font-bold transition-colors border border-glass-border flex items-center gap-2 flex-1",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"upload"}),m.jsx("span",{children:a("atlas.upload_image")}),m.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:Ve=>{const Oe=Ve.target.files[0];if(Oe){const et=new FileReader;et.onload=Ne=>{const ze=new Image;ze.onload=()=>{const Ke={...I,bgImage:Ne.target.result,width:ze.width,height:ze.height};z(Ke),V&&V(Ke)},ze.src=Ne.target.result},et.readAsDataURL(Oe)}}})]}),I.bgImage&&m.jsx("button",{onClick:()=>{const Ve={...I,bgImage:null};z(Ve),V&&V(Ve)},className:"p-2 bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-lg border border-red-500/20",title:"Remove Image",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),I.bgImage&&m.jsxs("div",{className:"rounded-lg overflow-hidden border border-glass-border bg-black/20 h-32 relative group",children:[m.jsx("img",{src:I.bgImage,alt:"Background",className:"w-full h-full object-cover opacity-70"}),m.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:m.jsxs("span",{className:"text-[10px] font-mono bg-black/50 px-2 py-1 rounded text-white backdrop-blur-sm",children:[I.width," x ",I.height]})})]})]})]})]}):b==="ENTITY"?m.jsxs("div",{className:"flex flex-col h-full animate-in fade-in slide-in-from-right-4",children:[m.jsx("div",{className:"p-4 border-b border-glass-border",children:m.jsx("div",{className:"bg-black/40 p-1 rounded-xl flex",children:xe.map(Ve=>{const Oe=et=>{switch(et.toLowerCase()){case"identity":return"badge";case"narrative":return"auto_stories";case"attributes":return"tune";case"notes":return"edit_note";default:return"circle"}};return m.jsxs("button",{onClick:()=>le(Ve),className:`
                                                        flex-1 py-2 rounded-lg transition-all group relative flex items-center justify-center
                                                        ${ge===Ve?"bg-primary text-white shadow-lg":"text-text-muted hover:text-white hover:bg-white/5"}
                                                    `,title:Ve,children:[m.jsx("span",{className:"material-symbols-outlined text-lg",children:Oe(Ve)}),m.jsx("span",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2 bg-black/90 text-white text-[10px] uppercase font-bold px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50",children:Ve})]},Ve)})})}),ge==="attributes"&&m.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col bg-black/20",children:[m.jsxs("div",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500 tracking-widest flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"drag_indicator"})," ",a("bible.drag_attributes")]}),m.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-2",children:m.jsx(Zk,{compact:!0,initialFolderSlug:n})})]})]}):b==="TOOLBOX"?m.jsx("div",{className:"p-4 space-y-6",children:m.jsxs("div",{className:"space-y-3",children:[m.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted px-2 flex justify-between items-center",children:[m.jsx("span",{children:a("settings.available_templates")}),m.jsx("button",{className:"text-primary hover:text-white transition-colors",title:"Crear Nueva Plantilla",onClick:()=>O&&O(),children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})]}),C.length===0?m.jsx("div",{className:"p-6 text-center border border-dashed border-glass-border rounded-2xl opacity-30",children:m.jsx("p",{className:"text-[10px] uppercase font-bold",children:a("settings.no_templates")})}):C.map(Ve=>m.jsxs("button",{className:"w-full flex items-center gap-3 p-3 rounded-2xl bg-white/5 border border-glass-border hover:border-primary/50 hover:bg-primary/5 transition-all text-left group relative",draggable:!0,onDragStart:Oe=>{Oe.dataTransfer.setData("application/reactflow/type","attribute"),Oe.dataTransfer.setData("templateId",Ve.id),Oe.dataTransfer.effectAllowed="move"},onClick:()=>P&&P(Ve.id),children:[Ve.global&&m.jsx("span",{className:"absolute top-2 right-2 flex size-2 bg-blue-500 rounded-full shadow-lg shadow-blue-500/50",title:"Global"}),m.jsx("div",{className:"size-8 rounded-lg bg-surface-light flex items-center justify-center text-primary group-hover:scale-110 transition-transform",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:Xk(Ve.tipo)})}),m.jsxs("div",{className:"overflow-hidden",children:[m.jsx("p",{className:"text-xs font-bold text-white truncate",children:Ve.nombre}),m.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-tighter",children:Ve.tipo})]}),m.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[m.jsx("div",{onClick:Oe=>{Oe.stopPropagation(),ve(Ve)},className:"p-1 hover:text-white text-text-muted hover:bg-white/10 rounded cursor-pointer",title:"Edit",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),m.jsx("div",{onClick:Oe=>be(Oe,Ve.id),className:"p-1 hover:text-red-400 text-text-muted hover:bg-white/10 rounded cursor-pointer",title:"Delete",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]},Ve.id))]})}):m.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted opacity-50",children:[m.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"dashboard"}),m.jsx("p",{className:"text-xs uppercase font-bold tracking-widest",children:"Select an item"})]}):m.jsx("div",{className:"flex flex-col items-center gap-4 py-4 w-full",children:b==="NOTES"||W?m.jsx("button",{onClick:()=>c(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Notas Globales",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"edit_note"})}):b==="MAP"?m.jsx("button",{onClick:()=>c(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Ajustes de Mapa",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"tune"})}):b==="ENTITY"?m.jsx("button",{onClick:()=>c(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Atributos",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"fact_check"})}):b==="CUSTOM"?m.jsx("button",{onClick:()=>c(!0),className:"size-10 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary hover:bg-primary/20 transition-all",title:k||"Panel",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"extension"})}):C.slice(0,5).map(Ve=>m.jsxs("button",{className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white hover:bg-primary/20 transition-all relative",draggable:!0,onDragStart:Oe=>{Oe.dataTransfer.setData("application/reactflow/type","attribute"),Oe.dataTransfer.setData("templateId",Ve.id)},title:Ve.nombre,children:[Ve.global&&m.jsx("span",{className:"absolute top-0 right-0 size-2 bg-blue-500 rounded-full border border-surface-dark"}),m.jsx("span",{className:"material-symbols-outlined text-lg",children:Xk(Ve.tipo)})]},Ve.id))})]})]}),he&&m.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:m.jsxs("div",{className:"bg-surface-dark border border-glass-border rounded-2xl p-6 w-full max-w-md shadow-2xl animate-scale-in",children:[m.jsx("h3",{className:"text-xl font-black text-white mb-4",children:a("settings.edit_template")}),m.jsxs("form",{onSubmit:Ue,className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs uppercase font-bold text-text-muted block mb-1",children:a("settings.name")}),m.jsx("input",{autoFocus:!0,className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none",value:he.nombre,onChange:Ve=>ve({...he,nombre:Ve.target.value}),required:!0})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs uppercase font-bold text-text-muted block mb-1",children:a("settings.type")}),m.jsxs("select",{className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none",value:he.tipo,onChange:Ve=>ve({...he,tipo:Ve.target.value}),children:[m.jsx("option",{value:"text",children:"Texto Largo"}),m.jsx("option",{value:"short_text",children:"Texto Corto"}),m.jsx("option",{value:"number",children:"Nmero"}),m.jsx("option",{value:"boolean",children:"Si/No"}),m.jsx("option",{value:"date",children:"Fecha"}),m.jsx("option",{value:"entity_link",children:"Vnculo Entidad"}),m.jsx("option",{value:"image",children:"Imagen URL"})]})]}),m.jsx("div",{className:"flex items-center",children:m.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-3 bg-white/5 rounded-xl w-full hover:bg-white/10 transition-colors",children:[m.jsx("input",{type:"checkbox",checked:he.global,onChange:Ve=>ve({...he,global:Ve.target.checked}),className:"accent-primary size-4"}),m.jsx("span",{className:"text-sm font-bold text-white",children:a("settings.is_global")})]})})]}),m.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[m.jsx("button",{type:"button",onClick:()=>ve(null),className:"px-4 py-2 text-text-muted hover:text-white font-bold transition-colors",children:a("common.cancel")}),m.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded-xl font-bold shadow-lg shadow-primary/20 hover:scale-105 transition-transform",children:a("common.save")})]})]})]})}),m.jsx(av,{isOpen:!!pe,onClose:()=>me(null),onConfirm:Se,title:a("settings.delete_template"),message:a("common.are_you_sure"),confirmText:a("common.confirm_delete"),type:"danger"})]})};var A1={exports:{}},j1,Qk;function T8(){if(Qk)return j1;Qk=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return j1=r,j1}var R1,Jk;function P8(){if(Jk)return R1;Jk=1;var r=T8();function e(){}function n(){}return n.resetWarningCache=e,R1=function(){function i(o,l,u,c,d,p){if(p!==r){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}i.isRequired=i;function a(){return i}var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:a,element:i,elementType:i,instanceOf:a,node:i,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s},R1}var eC;function M8(){return eC||(eC=1,A1.exports=P8()()),A1.exports}var A8=M8();const j8=Kh(A8);function v2(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,i=Array(e);n<e;n++)i[n]=r[n];return i}function R8(r){if(Array.isArray(r))return r}function L8(r){if(Array.isArray(r))return v2(r)}function Pd(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function O8(r,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,_4(i.key),i)}}function Md(r,e,n){return e&&O8(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function js(r,e){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=N_(r))||e){n&&(r=n);var i=0,a=function(){};return{s:a,n:function(){return i>=r.length?{done:!0}:{done:!1,value:r[i++]}},e:function(u){throw u},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,l=!1;return{s:function(){n=n.call(r)},n:function(){var u=n.next();return o=u.done,u},e:function(u){l=!0,s=u},f:function(){try{o||n.return==null||n.return()}finally{if(l)throw s}}}}function w4(r,e,n){return(e=_4(e))in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n,r}function D8(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function I8(r,e){var n=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(n!=null){var i,a,s,o,l=[],u=!0,c=!1;try{if(s=(n=n.call(r)).next,e===0){if(Object(n)!==n)return;u=!1}else for(;!(u=(i=s.call(n)).done)&&(l.push(i.value),l.length!==e);u=!0);}catch(d){c=!0,a=d}finally{try{if(!u&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function B8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xi(r,e){return R8(r)||I8(r,e)||N_(r,e)||B8()}function iy(r){return L8(r)||D8(r)||N_(r)||z8()}function F8(r,e){if(typeof r!="object"||!r)return r;var n=r[Symbol.toPrimitive];if(n!==void 0){var i=n.call(r,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function _4(r){var e=F8(r,"string");return typeof e=="symbol"?e:e+""}function Ai(r){"@babel/helpers - typeof";return Ai=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ai(r)}function N_(r,e){if(r){if(typeof r=="string")return v2(r,e);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v2(r,e):void 0}}var Pi=typeof window>"u"?null:window,tC=Pi?Pi.navigator:null;Pi&&Pi.document;var V8=Ai(""),S4=Ai({}),U8=Ai(function(){}),H8=typeof HTMLElement>"u"?"undefined":Ai(HTMLElement),sv=function(e){return e&&e.instanceString&&zn(e.instanceString)?e.instanceString():null},Dt=function(e){return e!=null&&Ai(e)==V8},zn=function(e){return e!=null&&Ai(e)===U8},rn=function(e){return!Xs(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},Sr=function(e){return e!=null&&Ai(e)===S4&&!rn(e)&&e.constructor===Object},G8=function(e){return e!=null&&Ai(e)===S4},ht=function(e){return e!=null&&Ai(e)===Ai(1)&&!isNaN(e)},q8=function(e){return ht(e)&&Math.floor(e)===e},ay=function(e){if(H8!=="undefined")return e!=null&&e instanceof HTMLElement},Xs=function(e){return ov(e)||k4(e)},ov=function(e){return sv(e)==="collection"&&e._private.single},k4=function(e){return sv(e)==="collection"&&!e._private.single},T_=function(e){return sv(e)==="core"},C4=function(e){return sv(e)==="stylesheet"},W8=function(e){return sv(e)==="event"},bd=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},$8=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},K8=function(e){return Sr(e)&&ht(e.x1)&&ht(e.x2)&&ht(e.y1)&&ht(e.y2)},Z8=function(e){return G8(e)&&zn(e.then)},Y8=function(){return tC&&tC.userAgent.match(/msie|trident|edge/i)},dp=function(e,n){n||(n=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var s=[],o=0;o<arguments.length;o++)s.push(arguments[o]);return s.join("$")});var i=function(){var s=this,o=arguments,l,u=n.apply(s,o),c=i.cache;return(l=c[u])||(l=c[u]=e.apply(s,o)),l};return i.cache={},i},P_=dp(function(r){return r.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),fx=dp(function(r){return r.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),E4=dp(function(r,e){return r+e[0].toUpperCase()+e.substring(1)},function(r,e){return r+"$"+e}),rC=function(e){return bd(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},sd=function(e,n){return e.slice(-1*n.length)===n},Mi="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",X8="rgb[a]?\\(("+Mi+"[%]?)\\s*,\\s*("+Mi+"[%]?)\\s*,\\s*("+Mi+"[%]?)(?:\\s*,\\s*("+Mi+"))?\\)",Q8="rgb[a]?\\((?:"+Mi+"[%]?)\\s*,\\s*(?:"+Mi+"[%]?)\\s*,\\s*(?:"+Mi+"[%]?)(?:\\s*,\\s*(?:"+Mi+"))?\\)",J8="hsl[a]?\\(("+Mi+")\\s*,\\s*("+Mi+"[%])\\s*,\\s*("+Mi+"[%])(?:\\s*,\\s*("+Mi+"))?\\)",eO="hsl[a]?\\((?:"+Mi+")\\s*,\\s*(?:"+Mi+"[%])\\s*,\\s*(?:"+Mi+"[%])(?:\\s*,\\s*(?:"+Mi+"))?\\)",tO="\\#[0-9a-fA-F]{3}",rO="\\#[0-9a-fA-F]{6}",N4=function(e,n){return e<n?-1:e>n?1:0},nO=function(e,n){return-1*N4(e,n)},Ht=Object.assign!=null?Object.assign.bind(Object):function(r){for(var e=arguments,n=1;n<e.length;n++){var i=e[n];if(i!=null)for(var a=Object.keys(i),s=0;s<a.length;s++){var o=a[s];r[o]=i[o]}}return r},iO=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var n=e.length===4,i,a,s,o=16;return n?(i=parseInt(e[1]+e[1],o),a=parseInt(e[2]+e[2],o),s=parseInt(e[3]+e[3],o)):(i=parseInt(e[1]+e[2],o),a=parseInt(e[3]+e[4],o),s=parseInt(e[5]+e[6],o)),[i,a,s]}},aO=function(e){var n,i,a,s,o,l,u,c;function d(b,S,k){return k<0&&(k+=1),k>1&&(k-=1),k<1/6?b+(S-b)*6*k:k<1/2?S:k<2/3?b+(S-b)*(2/3-k)*6:b}var p=new RegExp("^"+J8+"$").exec(e);if(p){if(i=parseInt(p[1]),i<0?i=(360- -1*i%360)%360:i>360&&(i=i%360),i/=360,a=parseFloat(p[2]),a<0||a>100||(a=a/100,s=parseFloat(p[3]),s<0||s>100)||(s=s/100,o=p[4],o!==void 0&&(o=parseFloat(o),o<0||o>1)))return;if(a===0)l=u=c=Math.round(s*255);else{var v=s<.5?s*(1+a):s+a-s*a,y=2*s-v;l=Math.round(255*d(y,v,i+1/3)),u=Math.round(255*d(y,v,i)),c=Math.round(255*d(y,v,i-1/3))}n=[l,u,c,o]}return n},sO=function(e){var n,i=new RegExp("^"+X8+"$").exec(e);if(i){n=[];for(var a=[],s=1;s<=3;s++){var o=i[s];if(o[o.length-1]==="%"&&(a[s]=!0),o=parseFloat(o),a[s]&&(o=o/100*255),o<0||o>255)return;n.push(Math.floor(o))}var l=a[1]||a[2]||a[3],u=a[1]&&a[2]&&a[3];if(l&&!u)return;var c=i[4];if(c!==void 0){if(c=parseFloat(c),c<0||c>1)return;n.push(c)}}return n},oO=function(e){return lO[e.toLowerCase()]},T4=function(e){return(rn(e)?e:null)||oO(e)||iO(e)||sO(e)||aO(e)},lO={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},P4=function(e){for(var n=e.map,i=e.keys,a=i.length,s=0;s<a;s++){var o=i[s];if(Sr(o))throw Error("Tried to set map with object key");s<i.length-1?(n[o]==null&&(n[o]={}),n=n[o]):n[o]=e.value}},M4=function(e){for(var n=e.map,i=e.keys,a=i.length,s=0;s<a;s++){var o=i[s];if(Sr(o))throw Error("Tried to get map with object key");if(n=n[o],n==null)return n}return n},n0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lv(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var L1,nC;function uv(){if(nC)return L1;nC=1;function r(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}return L1=r,L1}var O1,iC;function uO(){if(iC)return O1;iC=1;var r=typeof n0=="object"&&n0&&n0.Object===Object&&n0;return O1=r,O1}var D1,aC;function px(){if(aC)return D1;aC=1;var r=uO(),e=typeof self=="object"&&self&&self.Object===Object&&self,n=r||e||Function("return this")();return D1=n,D1}var I1,sC;function cO(){if(sC)return I1;sC=1;var r=px(),e=function(){return r.Date.now()};return I1=e,I1}var B1,oC;function dO(){if(oC)return B1;oC=1;var r=/\s/;function e(n){for(var i=n.length;i--&&r.test(n.charAt(i)););return i}return B1=e,B1}var z1,lC;function hO(){if(lC)return z1;lC=1;var r=dO(),e=/^\s+/;function n(i){return i&&i.slice(0,r(i)+1).replace(e,"")}return z1=n,z1}var F1,uC;function M_(){if(uC)return F1;uC=1;var r=px(),e=r.Symbol;return F1=e,F1}var V1,cC;function fO(){if(cC)return V1;cC=1;var r=M_(),e=Object.prototype,n=e.hasOwnProperty,i=e.toString,a=r?r.toStringTag:void 0;function s(o){var l=n.call(o,a),u=o[a];try{o[a]=void 0;var c=!0}catch{}var d=i.call(o);return c&&(l?o[a]=u:delete o[a]),d}return V1=s,V1}var U1,dC;function pO(){if(dC)return U1;dC=1;var r=Object.prototype,e=r.toString;function n(i){return e.call(i)}return U1=n,U1}var H1,hC;function A4(){if(hC)return H1;hC=1;var r=M_(),e=fO(),n=pO(),i="[object Null]",a="[object Undefined]",s=r?r.toStringTag:void 0;function o(l){return l==null?l===void 0?a:i:s&&s in Object(l)?e(l):n(l)}return H1=o,H1}var G1,fC;function mO(){if(fC)return G1;fC=1;function r(e){return e!=null&&typeof e=="object"}return G1=r,G1}var q1,pC;function cv(){if(pC)return q1;pC=1;var r=A4(),e=mO(),n="[object Symbol]";function i(a){return typeof a=="symbol"||e(a)&&r(a)==n}return q1=i,q1}var W1,mC;function gO(){if(mC)return W1;mC=1;var r=hO(),e=uv(),n=cv(),i=NaN,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt;function u(c){if(typeof c=="number")return c;if(n(c))return i;if(e(c)){var d=typeof c.valueOf=="function"?c.valueOf():c;c=e(d)?d+"":d}if(typeof c!="string")return c===0?c:+c;c=r(c);var p=s.test(c);return p||o.test(c)?l(c.slice(2),p?2:8):a.test(c)?i:+c}return W1=u,W1}var $1,gC;function vO(){if(gC)return $1;gC=1;var r=uv(),e=cO(),n=gO(),i="Expected a function",a=Math.max,s=Math.min;function o(l,u,c){var d,p,v,y,b,S,k=0,T=!1,C=!1,N=!0;if(typeof l!="function")throw new TypeError(i);u=n(u)||0,r(c)&&(T=!!c.leading,C="maxWait"in c,v=C?a(n(c.maxWait)||0,u):v,N="trailing"in c?!!c.trailing:N);function P(D){var q=d,G=p;return d=p=void 0,k=D,y=l.apply(G,q),y}function R(D){return k=D,b=setTimeout(I,u),T?P(D):y}function O(D){var q=D-S,G=D-k,Z=u-q;return C?s(Z,v-G):Z}function B(D){var q=D-S,G=D-k;return S===void 0||q>=u||q<0||C&&G>=v}function I(){var D=e();if(B(D))return z(D);b=setTimeout(I,O(D))}function z(D){return b=void 0,N&&d?P(D):(d=p=void 0,y)}function V(){b!==void 0&&clearTimeout(b),k=0,d=S=p=b=void 0}function $(){return b===void 0?y:z(e())}function Y(){var D=e(),q=B(D);if(d=arguments,p=this,S=D,q){if(b===void 0)return R(S);if(C)return clearTimeout(b),b=setTimeout(I,u),P(S)}return b===void 0&&(b=setTimeout(I,u)),y}return Y.cancel=V,Y.flush=$,Y}return $1=o,$1}var yO=vO(),dv=lv(yO),K1=Pi?Pi.performance:null,j4=K1&&K1.now?function(){return K1.now()}:function(){return Date.now()},xO=(function(){if(Pi){if(Pi.requestAnimationFrame)return function(r){Pi.requestAnimationFrame(r)};if(Pi.mozRequestAnimationFrame)return function(r){Pi.mozRequestAnimationFrame(r)};if(Pi.webkitRequestAnimationFrame)return function(r){Pi.webkitRequestAnimationFrame(r)};if(Pi.msRequestAnimationFrame)return function(r){Pi.msRequestAnimationFrame(r)}}return function(r){r&&setTimeout(function(){r(j4())},1e3/60)}})(),sy=function(e){return xO(e)},$u=j4,bh=9261,R4=65599,Wf=5381,L4=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bh,i=n,a;a=e.next(),!a.done;)i=i*R4+a.value|0;return i},Lg=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bh;return n*R4+e|0},Og=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wf;return(n<<5)+n+e|0},bO=function(e,n){return e*2097152+n},Wc=function(e){return e[0]*2097152+e[1]},i0=function(e,n){return[Lg(e[0],n[0]),Og(e[1],n[1])]},vC=function(e,n){var i={value:0,done:!1},a=0,s=e.length,o={next:function(){return a<s?i.value=e[a++]:i.done=!0,i}};return L4(o,n)},Dh=function(e,n){var i={value:0,done:!1},a=0,s=e.length,o={next:function(){return a<s?i.value=e.charCodeAt(a++):i.done=!0,i}};return L4(o,n)},O4=function(){return wO(arguments)},wO=function(e){for(var n,i=0;i<e.length;i++){var a=e[i];i===0?n=Dh(a):n=Dh(a,n)}return n};function _O(r,e,n,i,a){var s=a*Math.PI/180,o=Math.cos(s)*(r-n)-Math.sin(s)*(e-i)+n,l=Math.sin(s)*(r-n)+Math.cos(s)*(e-i)+i;return{x:o,y:l}}var SO=function(e,n,i,a,s,o){return{x:(e-i)*s+i,y:(n-a)*o+a}};function kO(r,e,n){if(n===0)return r;var i=(e.x1+e.x2)/2,a=(e.y1+e.y2)/2,s=e.w/e.h,o=1/s,l=_O(r.x,r.y,i,a,n),u=SO(l.x,l.y,i,a,s,o);return{x:u.x,y:u.y}}var yC=!0,CO=console.warn!=null,EO=console.trace!=null,A_=Number.MAX_SAFE_INTEGER||9007199254740991,D4=function(){return!0},oy=function(){return!1},xC=function(){return 0},j_=function(){},Rn=function(e){throw new Error(e)},I4=function(e){if(e!==void 0)yC=!!e;else return yC},zr=function(e){I4()&&(CO?console.warn(e):(console.log(e),EO&&console.trace()))},NO=function(e){return Ht({},e)},Ql=function(e){return e==null?e:rn(e)?e.slice():Sr(e)?NO(e):e},TO=function(e){return e.slice()},B4=function(e,n){for(n=e="";e++<36;n+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return n},PO={},z4=function(){return PO},Ta=function(e){var n=Object.keys(e);return function(i){for(var a={},s=0;s<n.length;s++){var o=n[s],l=i?.[o];a[o]=l===void 0?e[o]:l}return a}},wd=function(e,n,i){for(var a=e.length-1;a>=0;a--)e[a]===n&&e.splice(a,1)},R_=function(e){e.splice(0,e.length)},MO=function(e,n){for(var i=0;i<n.length;i++){var a=n[i];e.push(a)}},Ps=function(e,n,i){return i&&(n=E4(i,n)),e[n]},Uu=function(e,n,i,a){i&&(n=E4(i,n)),e[n]=a},AO=(function(){function r(){Pd(this,r),this._obj={}}return Md(r,[{key:"set",value:function(n,i){return this._obj[n]=i,this}},{key:"delete",value:function(n){return this._obj[n]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(n){return this._obj[n]!==void 0}},{key:"get",value:function(n){return this._obj[n]}}])})(),Hu=typeof Map<"u"?Map:AO,jO="undefined",RO=(function(){function r(e){if(Pd(this,r),this._obj=Object.create(null),this.size=0,e!=null){var n;e.instanceString!=null&&e.instanceString()===this.instanceString()?n=e.toArray():n=e;for(var i=0;i<n.length;i++)this.add(n[i])}}return Md(r,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(n){var i=this._obj;i[n]!==1&&(i[n]=1,this.size++)}},{key:"delete",value:function(n){var i=this._obj;i[n]===1&&(i[n]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(n){return this._obj[n]===1}},{key:"toArray",value:function(){var n=this;return Object.keys(this._obj).filter(function(i){return n.has(i)})}},{key:"forEach",value:function(n,i){return this.toArray().forEach(n,i)}}])})(),Tp=(typeof Set>"u"?"undefined":Ai(Set))!==jO?Set:RO,mx=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||n===void 0||!T_(e)){Rn("An element must have a core reference and parameters set");return}var a=n.group;if(a==null&&(n.data&&n.data.source!=null&&n.data.target!=null?a="edges":a="nodes"),a!=="nodes"&&a!=="edges"){Rn("An element must be of type `nodes` or `edges`; you specified `"+a+"`");return}this.length=1,this[0]=this;var s=this._private={cy:e,single:!0,data:n.data||{},position:n.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:a,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!n.selected,selectable:n.selectable===void 0?!0:!!n.selectable,locked:!!n.locked,grabbed:!1,grabbable:n.grabbable===void 0?!0:!!n.grabbable,pannable:n.pannable===void 0?a==="edges":!!n.pannable,active:!1,classes:new Tp,animation:{current:[],queue:[]},rscratch:{},scratch:n.scratch||{},edges:[],children:[],parent:n.parent&&n.parent.isNode()?n.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(s.position.x==null&&(s.position.x=0),s.position.y==null&&(s.position.y=0),n.renderedPosition){var o=n.renderedPosition,l=e.pan(),u=e.zoom();s.position={x:(o.x-l.x)/u,y:(o.y-l.y)/u}}var c=[];rn(n.classes)?c=n.classes:Dt(n.classes)&&(c=n.classes.split(/\s+/));for(var d=0,p=c.length;d<p;d++){var v=c[d];!v||v===""||s.classes.add(v)}this.createEmitter(),(i===void 0||i)&&this.restore();var y=n.style||n.css;y&&(zr("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(y))},bC=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(i,a,s){var o;Sr(i)&&!Xs(i)&&(o=i,i=o.roots||o.root,a=o.visit,s=o.directed),s=arguments.length===2&&!zn(a)?a:s,a=zn(a)?a:function(){};for(var l=this._private.cy,u=i=Dt(i)?this.filter(i):i,c=[],d=[],p={},v={},y={},b=0,S,k=this.byGroup(),T=k.nodes,C=k.edges,N=0;N<u.length;N++){var P=u[N],R=P.id();P.isNode()&&(c.unshift(P),e.bfs&&(y[R]=!0,d.push(P)),v[R]=0)}for(var O=function(){var D=e.bfs?c.shift():c.pop(),q=D.id();if(e.dfs){if(y[q])return 0;y[q]=!0,d.push(D)}var G=v[q],Z=p[q],Q=Z!=null?Z.source():null,J=Z!=null?Z.target():null,ie=Z==null?void 0:D.same(Q)?J[0]:Q[0],ne;if(ne=a(D,Z,ie,b++,G),ne===!0)return S=D,1;if(ne===!1)return 1;for(var W=D.connectedEdges().filter(function(xe){return(!s||xe.source().same(D))&&C.has(xe)}),re=0;re<W.length;re++){var ae=W[re],he=ae.connectedNodes().filter(function(xe){return!xe.same(D)&&T.has(xe)}),ve=he.id();he.length!==0&&!y[ve]&&(he=he[0],c.push(he),e.bfs&&(y[ve]=!0,d.push(he)),p[ve]=ae,v[ve]=v[q]+1)}},B;c.length!==0&&(B=O(),!(B!==0&&B===1)););for(var I=l.collection(),z=0;z<d.length;z++){var V=d[z],$=p[V.id()];$!=null&&I.push($),I.push(V)}return{path:l.collection(I),found:l.collection(S)}}},Dg={breadthFirstSearch:bC({bfs:!0}),depthFirstSearch:bC({dfs:!0})};Dg.bfs=Dg.breadthFirstSearch;Dg.dfs=Dg.depthFirstSearch;var I0={exports:{}},LO=I0.exports,wC;function OO(){return wC||(wC=1,(function(r,e){(function(){var n,i,a,s,o,l,u,c,d,p,v,y,b,S,k;a=Math.floor,p=Math.min,i=function(T,C){return T<C?-1:T>C?1:0},d=function(T,C,N,P,R){var O;if(N==null&&(N=0),R==null&&(R=i),N<0)throw new Error("lo must be non-negative");for(P==null&&(P=T.length);N<P;)O=a((N+P)/2),R(C,T[O])<0?P=O:N=O+1;return[].splice.apply(T,[N,N-N].concat(C)),C},l=function(T,C,N){return N==null&&(N=i),T.push(C),S(T,0,T.length-1,N)},o=function(T,C){var N,P;return C==null&&(C=i),N=T.pop(),T.length?(P=T[0],T[0]=N,k(T,0,C)):P=N,P},c=function(T,C,N){var P;return N==null&&(N=i),P=T[0],T[0]=C,k(T,0,N),P},u=function(T,C,N){var P;return N==null&&(N=i),T.length&&N(T[0],C)<0&&(P=[T[0],C],C=P[0],T[0]=P[1],k(T,0,N)),C},s=function(T,C){var N,P,R,O,B,I;for(C==null&&(C=i),O=(function(){I=[];for(var z=0,V=a(T.length/2);0<=V?z<V:z>V;0<=V?z++:z--)I.push(z);return I}).apply(this).reverse(),B=[],P=0,R=O.length;P<R;P++)N=O[P],B.push(k(T,N,C));return B},b=function(T,C,N){var P;if(N==null&&(N=i),P=T.indexOf(C),P!==-1)return S(T,0,P,N),k(T,P,N)},v=function(T,C,N){var P,R,O,B,I;if(N==null&&(N=i),R=T.slice(0,C),!R.length)return R;for(s(R,N),I=T.slice(C),O=0,B=I.length;O<B;O++)P=I[O],u(R,P,N);return R.sort(N).reverse()},y=function(T,C,N){var P,R,O,B,I,z,V,$,Y;if(N==null&&(N=i),C*10<=T.length){if(O=T.slice(0,C).sort(N),!O.length)return O;for(R=O[O.length-1],V=T.slice(C),B=0,z=V.length;B<z;B++)P=V[B],N(P,R)<0&&(d(O,P,0,null,N),O.pop(),R=O[O.length-1]);return O}for(s(T,N),Y=[],I=0,$=p(C,T.length);0<=$?I<$:I>$;0<=$?++I:--I)Y.push(o(T,N));return Y},S=function(T,C,N,P){var R,O,B;for(P==null&&(P=i),R=T[N];N>C;){if(B=N-1>>1,O=T[B],P(R,O)<0){T[N]=O,N=B;continue}break}return T[N]=R},k=function(T,C,N){var P,R,O,B,I;for(N==null&&(N=i),R=T.length,I=C,O=T[C],P=2*C+1;P<R;)B=P+1,B<R&&!(N(T[P],T[B])<0)&&(P=B),T[C]=T[P],C=P,P=2*C+1;return T[C]=O,S(T,I,C,N)},n=(function(){T.push=l,T.pop=o,T.replace=c,T.pushpop=u,T.heapify=s,T.updateItem=b,T.nlargest=v,T.nsmallest=y;function T(C){this.cmp=C??i,this.nodes=[]}return T.prototype.push=function(C){return l(this.nodes,C,this.cmp)},T.prototype.pop=function(){return o(this.nodes,this.cmp)},T.prototype.peek=function(){return this.nodes[0]},T.prototype.contains=function(C){return this.nodes.indexOf(C)!==-1},T.prototype.replace=function(C){return c(this.nodes,C,this.cmp)},T.prototype.pushpop=function(C){return u(this.nodes,C,this.cmp)},T.prototype.heapify=function(){return s(this.nodes,this.cmp)},T.prototype.updateItem=function(C){return b(this.nodes,C,this.cmp)},T.prototype.clear=function(){return this.nodes=[]},T.prototype.empty=function(){return this.nodes.length===0},T.prototype.size=function(){return this.nodes.length},T.prototype.clone=function(){var C;return C=new T,C.nodes=this.nodes.slice(0),C},T.prototype.toArray=function(){return this.nodes.slice(0)},T.prototype.insert=T.prototype.push,T.prototype.top=T.prototype.peek,T.prototype.front=T.prototype.peek,T.prototype.has=T.prototype.contains,T.prototype.copy=T.prototype.clone,T})(),(function(T,C){return r.exports=C()})(this,function(){return n})}).call(LO)})(I0)),I0.exports}var Z1,_C;function DO(){return _C||(_C=1,Z1=OO()),Z1}var IO=DO(),hv=lv(IO),BO=Ta({root:null,weight:function(e){return 1},directed:!1}),zO={dijkstra:function(e){if(!Sr(e)){var n=arguments;e={root:n[0],weight:n[1],directed:n[2]}}var i=BO(e),a=i.root,s=i.weight,o=i.directed,l=this,u=s,c=Dt(a)?this.filter(a)[0]:a[0],d={},p={},v={},y=this.byGroup(),b=y.nodes,S=y.edges;S.unmergeBy(function(G){return G.isLoop()});for(var k=function(Z){return d[Z.id()]},T=function(Z,Q){d[Z.id()]=Q,C.updateItem(Z)},C=new hv(function(G,Z){return k(G)-k(Z)}),N=0;N<b.length;N++){var P=b[N];d[P.id()]=P.same(c)?0:1/0,C.push(P)}for(var R=function(Z,Q){for(var J=(o?Z.edgesTo(Q):Z.edgesWith(Q)).intersect(S),ie=1/0,ne,W=0;W<J.length;W++){var re=J[W],ae=u(re);(ae<ie||!ne)&&(ie=ae,ne=re)}return{edge:ne,dist:ie}};C.size()>0;){var O=C.pop(),B=k(O),I=O.id();if(v[I]=B,B!==1/0)for(var z=O.neighborhood().intersect(b),V=0;V<z.length;V++){var $=z[V],Y=$.id(),D=R(O,$),q=B+D.dist;q<k($)&&(T($,q),p[Y]={node:O,edge:D.edge})}}return{distanceTo:function(Z){var Q=Dt(Z)?b.filter(Z)[0]:Z[0];return v[Q.id()]},pathTo:function(Z){var Q=Dt(Z)?b.filter(Z)[0]:Z[0],J=[],ie=Q,ne=ie.id();if(Q.length>0)for(J.unshift(Q);p[ne];){var W=p[ne];J.unshift(W.edge),J.unshift(W.node),ie=W.node,ne=ie.id()}return l.spawn(J)}}}},FO={kruskal:function(e){e=e||function(N){return 1};for(var n=this.byGroup(),i=n.nodes,a=n.edges,s=i.length,o=new Array(s),l=i,u=function(P){for(var R=0;R<o.length;R++){var O=o[R];if(O.has(P))return R}},c=0;c<s;c++)o[c]=this.spawn(i[c]);for(var d=a.sort(function(N,P){return e(N)-e(P)}),p=0;p<d.length;p++){var v=d[p],y=v.source()[0],b=v.target()[0],S=u(y),k=u(b),T=o[S],C=o[k];S!==k&&(l.merge(v),T.merge(C),o.splice(k,1))}return l}},VO=Ta({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),UO={aStar:function(e){var n=this.cy(),i=VO(e),a=i.root,s=i.goal,o=i.heuristic,l=i.directed,u=i.weight;a=n.collection(a)[0],s=n.collection(s)[0];var c=a.id(),d=s.id(),p={},v={},y={},b=new hv(function(ne,W){return v[ne.id()]-v[W.id()]}),S=new Tp,k={},T={},C=function(W,re){b.push(W),S.add(re)},N,P,R=function(){N=b.pop(),P=N.id(),S.delete(P)},O=function(W){return S.has(W)};C(a,c),p[c]=0,v[c]=o(a);for(var B=0;b.size()>0;){if(R(),B++,P===d){for(var I=[],z=s,V=d,$=T[V];I.unshift(z),$!=null&&I.unshift($),z=k[V],z!=null;)V=z.id(),$=T[V];return{found:!0,distance:p[P],path:this.spawn(I),steps:B}}y[P]=!0;for(var Y=N._private.edges,D=0;D<Y.length;D++){var q=Y[D];if(this.hasElementWithId(q.id())&&!(l&&q.data("source")!==P)){var G=q.source(),Z=q.target(),Q=G.id()!==P?G:Z,J=Q.id();if(this.hasElementWithId(J)&&!y[J]){var ie=p[P]+u(q);if(!O(J)){p[J]=ie,v[J]=ie+o(Q),C(Q,J),k[J]=N,T[J]=q;continue}ie<p[J]&&(p[J]=ie,v[J]=ie+o(Q),k[J]=N,T[J]=q)}}}}return{found:!1,distance:void 0,path:void 0,steps:B}}},HO=Ta({weight:function(e){return 1},directed:!1}),GO={floydWarshall:function(e){for(var n=this.cy(),i=HO(e),a=i.weight,s=i.directed,o=a,l=this.byGroup(),u=l.nodes,c=l.edges,d=u.length,p=d*d,v=function(ae){return u.indexOf(ae)},y=function(ae){return u[ae]},b=new Array(p),S=0;S<p;S++){var k=S%d,T=(S-k)/d;T===k?b[S]=0:b[S]=1/0}for(var C=new Array(p),N=new Array(p),P=0;P<c.length;P++){var R=c[P],O=R.source()[0],B=R.target()[0];if(O!==B){var I=v(O),z=v(B),V=I*d+z,$=o(R);if(b[V]>$&&(b[V]=$,C[V]=z,N[V]=R),!s){var Y=z*d+I;!s&&b[Y]>$&&(b[Y]=$,C[Y]=I,N[Y]=R)}}}for(var D=0;D<d;D++)for(var q=0;q<d;q++)for(var G=q*d+D,Z=0;Z<d;Z++){var Q=q*d+Z,J=D*d+Z;b[G]+b[J]<b[Q]&&(b[Q]=b[G]+b[J],C[Q]=C[G])}var ie=function(ae){return(Dt(ae)?n.filter(ae):ae)[0]},ne=function(ae){return v(ie(ae))},W={distance:function(ae,he){var ve=ne(ae),xe=ne(he);return b[ve*d+xe]},path:function(ae,he){var ve=ne(ae),xe=ne(he),se=y(ve);if(ve===xe)return se.collection();if(C[ve*d+xe]==null)return n.collection();var ge=n.collection(),le=ve,pe;for(ge.merge(se);ve!==xe;)le=ve,ve=C[ve*d+xe],pe=N[le*d+ve],ge.merge(pe),ge.merge(y(ve));return ge}};return W}},qO=Ta({weight:function(e){return 1},directed:!1,root:null}),WO={bellmanFord:function(e){var n=this,i=qO(e),a=i.weight,s=i.directed,o=i.root,l=a,u=this,c=this.cy(),d=this.byGroup(),p=d.edges,v=d.nodes,y=v.length,b=new Hu,S=!1,k=[];o=c.collection(o)[0],p.unmergeBy(function(Je){return Je.isLoop()});for(var T=p.length,C=function(at){var Ve=b.get(at.id());return Ve||(Ve={},b.set(at.id(),Ve)),Ve},N=function(at){return(Dt(at)?c.$(at):at)[0]},P=function(at){return C(N(at)).dist},R=function(at){for(var Ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o,Oe=N(at),et=[],Ne=Oe;;){if(Ne==null)return n.spawn();var ze=C(Ne),Ke=ze.edge,ft=ze.pred;if(et.unshift(Ne[0]),Ne.same(Ve)&&et.length>0)break;Ke!=null&&et.unshift(Ke),Ne=ft}return u.spawn(et)},O=0;O<y;O++){var B=v[O],I=C(B);B.same(o)?I.dist=0:I.dist=1/0,I.pred=null,I.edge=null}for(var z=!1,V=function(at,Ve,Oe,et,Ne,ze){var Ke=et.dist+ze;Ke<Ne.dist&&!Oe.same(et.edge)&&(Ne.dist=Ke,Ne.pred=at,Ne.edge=Oe,z=!0)},$=1;$<y;$++){z=!1;for(var Y=0;Y<T;Y++){var D=p[Y],q=D.source(),G=D.target(),Z=l(D),Q=C(q),J=C(G);V(q,G,D,Q,J,Z),s||V(G,q,D,J,Q,Z)}if(!z)break}if(z)for(var ie=[],ne=0;ne<T;ne++){var W=p[ne],re=W.source(),ae=W.target(),he=l(W),ve=C(re).dist,xe=C(ae).dist;if(ve+he<xe||!s&&xe+he<ve)if(S||(zr("Graph contains a negative weight cycle for Bellman-Ford"),S=!0),e.findNegativeWeightCycles!==!1){var se=[];ve+he<xe&&se.push(re),!s&&xe+he<ve&&se.push(ae);for(var ge=se.length,le=0;le<ge;le++){var pe=se[le],me=[pe];me.push(C(pe).edge);for(var be=C(pe).pred;me.indexOf(be)===-1;)me.push(be),me.push(C(be).edge),be=C(be).pred;me=me.slice(me.indexOf(be));for(var Se=me[0].id(),Ue=0,We=2;We<me.length;We+=2)me[We].id()<Se&&(Se=me[We].id(),Ue=We);me=me.slice(Ue).concat(me.slice(0,Ue)),me.push(me[0]);var gt=me.map(function(Je){return Je.id()}).join(",");ie.indexOf(gt)===-1&&(k.push(u.spawn(me)),ie.push(gt))}}else break}return{distanceTo:P,pathTo:R,hasNegativeWeightCycle:S,negativeWeightCycles:k}}},$O=Math.sqrt(2),KO=function(e,n,i){i.length===0&&Rn("Karger-Stein must be run on a connected (sub)graph");for(var a=i[e],s=a[1],o=a[2],l=n[s],u=n[o],c=i,d=c.length-1;d>=0;d--){var p=c[d],v=p[1],y=p[2];(n[v]===l&&n[y]===u||n[v]===u&&n[y]===l)&&c.splice(d,1)}for(var b=0;b<c.length;b++){var S=c[b];S[1]===u?(c[b]=S.slice(),c[b][1]=l):S[2]===u&&(c[b]=S.slice(),c[b][2]=l)}for(var k=0;k<n.length;k++)n[k]===u&&(n[k]=l);return c},Y1=function(e,n,i,a){for(;i>a;){var s=Math.floor(Math.random()*n.length);n=KO(s,e,n),i--}return n},ZO={kargerStein:function(){var e=this,n=this.byGroup(),i=n.nodes,a=n.edges;a.unmergeBy(function(J){return J.isLoop()});var s=i.length,o=a.length,l=Math.ceil(Math.pow(Math.log(s)/Math.LN2,2)),u=Math.floor(s/$O);if(s<2){Rn("At least 2 nodes are required for Karger-Stein algorithm");return}for(var c=[],d=0;d<o;d++){var p=a[d];c.push([d,i.indexOf(p.source()),i.indexOf(p.target())])}for(var v=1/0,y=[],b=new Array(s),S=new Array(s),k=new Array(s),T=function(ie,ne){for(var W=0;W<s;W++)ne[W]=ie[W]},C=0;C<=l;C++){for(var N=0;N<s;N++)S[N]=N;var P=Y1(S,c.slice(),s,u),R=P.slice();T(S,k);var O=Y1(S,P,u,2),B=Y1(k,R,u,2);O.length<=B.length&&O.length<v?(v=O.length,y=O,T(S,b)):B.length<=O.length&&B.length<v&&(v=B.length,y=B,T(k,b))}for(var I=this.spawn(y.map(function(J){return a[J[0]]})),z=this.spawn(),V=this.spawn(),$=b[0],Y=0;Y<b.length;Y++){var D=b[Y],q=i[Y];D===$?z.merge(q):V.merge(q)}var G=function(ie){var ne=e.spawn();return ie.forEach(function(W){ne.merge(W),W.connectedEdges().forEach(function(re){e.contains(re)&&!I.contains(re)&&ne.merge(re)})}),ne},Z=[G(z),G(V)],Q={cut:I,components:Z,partition1:z,partition2:V};return Q}},X1,YO=function(e){return{x:e.x,y:e.y}},gx=function(e,n,i){return{x:e.x*n+i.x,y:e.y*n+i.y}},F4=function(e,n,i){return{x:(e.x-i.x)/n,y:(e.y-i.y)/n}},Jf=function(e){return{x:e[0],y:e[1]}},XO=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=1/0,s=n;s<i;s++){var o=e[s];isFinite(o)&&(a=Math.min(o,a))}return a},QO=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=-1/0,s=n;s<i;s++){var o=e[s];isFinite(o)&&(a=Math.max(o,a))}return a},JO=function(e){for(var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=0,s=0,o=n;o<i;o++){var l=e[o];isFinite(l)&&(a+=l,s++)}return a/s},eD=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;a?e=e.slice(n,i):(i<e.length&&e.splice(i,e.length-i),n>0&&e.splice(0,n));for(var l=0,u=e.length-1;u>=0;u--){var c=e[u];o?isFinite(c)||(e[u]=-1/0,l++):e.splice(u,1)}s&&e.sort(function(v,y){return v-y});var d=e.length,p=Math.floor(d/2);return d%2!==0?e[p+1+l]:(e[p-1+l]+e[p+l])/2},tD=function(e){return Math.PI*e/180},a0=function(e,n){return Math.atan2(n,e)-Math.PI/2},L_=Math.log2||function(r){return Math.log(r)/Math.log(2)},O_=function(e){return e>0?1:e<0?-1:0},Ih=function(e,n){return Math.sqrt(vh(e,n))},vh=function(e,n){var i=n.x-e.x,a=n.y-e.y;return i*i+a*a},rD=function(e){for(var n=e.length,i=0,a=0;a<n;a++)i+=e[a];for(var s=0;s<n;s++)e[s]=e[s]/i;return e},$i=function(e,n,i,a){return(1-a)*(1-a)*e+2*(1-a)*a*n+a*a*i},ip=function(e,n,i,a){return{x:$i(e.x,n.x,i.x,a),y:$i(e.y,n.y,i.y,a)}},nD=function(e,n,i,a){var s={x:n.x-e.x,y:n.y-e.y},o=Ih(e,n),l={x:s.x/o,y:s.y/o};return i=i??0,a=a??i*o,{x:e.x+l.x*a,y:e.y+l.y*a}},Ig=function(e,n,i){return Math.max(e,Math.min(i,n))},cs=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},iD=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},aD=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},sD=function(e,n){e.x1=Math.min(e.x1,n.x1),e.x2=Math.max(e.x2,n.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n.y1),e.y2=Math.max(e.y2,n.y2),e.h=e.y2-e.y1},V4=function(e,n,i){e.x1=Math.min(e.x1,n),e.x2=Math.max(e.x2,n),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,i),e.y2=Math.max(e.y2,i),e.h=e.y2-e.y1},B0=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=n,e.x2+=n,e.y1-=n,e.y2+=n,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},z0=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],i,a,s,o;if(n.length===1)i=a=s=o=n[0];else if(n.length===2)i=s=n[0],o=a=n[1];else if(n.length===4){var l=xi(n,4);i=l[0],a=l[1],s=l[2],o=l[3]}return e.x1-=o,e.x2+=a,e.y1-=i,e.y2+=s,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},SC=function(e,n){e.x1=n.x1,e.y1=n.y1,e.x2=n.x2,e.y2=n.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},D_=function(e,n){return!(e.x1>n.x2||n.x1>e.x2||e.x2<n.x1||n.x2<e.x1||e.y2<n.y1||n.y2<e.y1||e.y1>n.y2||n.y1>e.y2)},od=function(e,n,i){return e.x1<=n&&n<=e.x2&&e.y1<=i&&i<=e.y2},kC=function(e,n){return od(e,n.x,n.y)},U4=function(e,n){return od(e,n.x1,n.y1)&&od(e,n.x2,n.y2)},oD=(X1=Math.hypot)!==null&&X1!==void 0?X1:function(r,e){return Math.sqrt(r*r+e*e)};function lD(r,e){if(r.length<3)throw new Error("Need at least 3 vertices");var n=function(I,z){return{x:I.x+z.x,y:I.y+z.y}},i=function(I,z){return{x:I.x-z.x,y:I.y-z.y}},a=function(I,z){return{x:I.x*z,y:I.y*z}},s=function(I,z){return I.x*z.y-I.y*z.x},o=function(I){var z=oD(I.x,I.y);return z===0?{x:0,y:0}:{x:I.x/z,y:I.y/z}},l=function(I){for(var z=0,V=0;V<I.length;V++){var $=I[V],Y=I[(V+1)%I.length];z+=$.x*Y.y-Y.x*$.y}return z/2},u=function(I,z,V,$){var Y=i(z,I),D=i($,V),q=s(Y,D);if(Math.abs(q)<1e-9)return n(I,a(Y,.5));var G=s(i(V,I),D)/q;return n(I,a(Y,G))},c=r.map(function(B){return{x:B.x,y:B.y}});l(c)<0&&c.reverse();for(var d=c.length,p=[],v=0;v<d;v++){var y=c[v],b=c[(v+1)%d],S=i(b,y),k=o({x:S.y,y:-S.x});p.push(k)}for(var T=p.map(function(B,I){var z=n(c[I],a(B,e)),V=n(c[(I+1)%d],a(B,e));return{p1:z,p2:V}}),C=[],N=0;N<d;N++){var P=T[(N-1+d)%d],R=T[N],O=u(P.p1,P.p2,R.p1,R.p2);C.push(O)}return C}function uD(r,e,n,i,a,s){var o=yD(r,e,n,i,a),l=lD(o,s),u=cs();return l.forEach(function(c){return V4(u,c.x,c.y)}),u}var H4=function(e,n,i,a,s,o,l){var u=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",c=u==="auto"?_d(s,o):u,d=s/2,p=o/2;c=Math.min(c,d,p);var v=c!==d,y=c!==p,b;if(v){var S=i-d+c-l,k=a-p-l,T=i+d-c+l,C=k;if(b=ld(e,n,i,a,S,k,T,C,!1),b.length>0)return b}if(y){var N=i+d+l,P=a-p+c-l,R=N,O=a+p-c+l;if(b=ld(e,n,i,a,N,P,R,O,!1),b.length>0)return b}if(v){var B=i-d+c-l,I=a+p+l,z=i+d-c+l,V=I;if(b=ld(e,n,i,a,B,I,z,V,!1),b.length>0)return b}if(y){var $=i-d-l,Y=a-p+c-l,D=$,q=a+p-c+l;if(b=ld(e,n,i,a,$,Y,D,q,!1),b.length>0)return b}var G;{var Z=i-d+c,Q=a-p+c;if(G=og(e,n,i,a,Z,Q,c+l),G.length>0&&G[0]<=Z&&G[1]<=Q)return[G[0],G[1]]}{var J=i+d-c,ie=a-p+c;if(G=og(e,n,i,a,J,ie,c+l),G.length>0&&G[0]>=J&&G[1]<=ie)return[G[0],G[1]]}{var ne=i+d-c,W=a+p-c;if(G=og(e,n,i,a,ne,W,c+l),G.length>0&&G[0]>=ne&&G[1]>=W)return[G[0],G[1]]}{var re=i-d+c,ae=a+p-c;if(G=og(e,n,i,a,re,ae,c+l),G.length>0&&G[0]<=re&&G[1]>=ae)return[G[0],G[1]]}return[]},cD=function(e,n,i,a,s,o,l){var u=l,c=Math.min(i,s),d=Math.max(i,s),p=Math.min(a,o),v=Math.max(a,o);return c-u<=e&&e<=d+u&&p-u<=n&&n<=v+u},dD=function(e,n,i,a,s,o,l,u,c){var d={x1:Math.min(i,l,s)-c,x2:Math.max(i,l,s)+c,y1:Math.min(a,u,o)-c,y2:Math.max(a,u,o)+c};return!(e<d.x1||e>d.x2||n<d.y1||n>d.y2)},hD=function(e,n,i,a){i-=a;var s=n*n-4*e*i;if(s<0)return[];var o=Math.sqrt(s),l=2*e,u=(-n+o)/l,c=(-n-o)/l;return[u,c]},fD=function(e,n,i,a,s){var o=1e-5;e===0&&(e=o),n/=e,i/=e,a/=e;var l,u,c,d,p,v,y,b;if(u=(3*i-n*n)/9,c=-(27*a)+n*(9*i-2*(n*n)),c/=54,l=u*u*u+c*c,s[1]=0,y=n/3,l>0){p=c+Math.sqrt(l),p=p<0?-Math.pow(-p,1/3):Math.pow(p,1/3),v=c-Math.sqrt(l),v=v<0?-Math.pow(-v,1/3):Math.pow(v,1/3),s[0]=-y+p+v,y+=(p+v)/2,s[4]=s[2]=-y,y=Math.sqrt(3)*(-v+p)/2,s[3]=y,s[5]=-y;return}if(s[5]=s[3]=0,l===0){b=c<0?-Math.pow(-c,1/3):Math.pow(c,1/3),s[0]=-y+2*b,s[4]=s[2]=-(b+y);return}u=-u,d=u*u*u,d=Math.acos(c/Math.sqrt(d)),b=2*Math.sqrt(u),s[0]=-y+b*Math.cos(d/3),s[2]=-y+b*Math.cos((d+2*Math.PI)/3),s[4]=-y+b*Math.cos((d+4*Math.PI)/3)},pD=function(e,n,i,a,s,o,l,u){var c=1*i*i-4*i*s+2*i*l+4*s*s-4*s*l+l*l+a*a-4*a*o+2*a*u+4*o*o-4*o*u+u*u,d=9*i*s-3*i*i-3*i*l-6*s*s+3*s*l+9*a*o-3*a*a-3*a*u-6*o*o+3*o*u,p=3*i*i-6*i*s+i*l-i*e+2*s*s+2*s*e-l*e+3*a*a-6*a*o+a*u-a*n+2*o*o+2*o*n-u*n,v=1*i*s-i*i+i*e-s*e+a*o-a*a+a*n-o*n,y=[];fD(c,d,p,v,y);for(var b=1e-7,S=[],k=0;k<6;k+=2)Math.abs(y[k+1])<b&&y[k]>=0&&y[k]<=1&&S.push(y[k]);S.push(1),S.push(0);for(var T=-1,C,N,P,R=0;R<S.length;R++)C=Math.pow(1-S[R],2)*i+2*(1-S[R])*S[R]*s+S[R]*S[R]*l,N=Math.pow(1-S[R],2)*a+2*(1-S[R])*S[R]*o+S[R]*S[R]*u,P=Math.pow(C-e,2)+Math.pow(N-n,2),T>=0?P<T&&(T=P):T=P;return T},mD=function(e,n,i,a,s,o){var l=[e-i,n-a],u=[s-i,o-a],c=u[0]*u[0]+u[1]*u[1],d=l[0]*l[0]+l[1]*l[1],p=l[0]*u[0]+l[1]*u[1],v=p*p/c;return p<0?d:v>c?(e-s)*(e-s)+(n-o)*(n-o):d-v},Ms=function(e,n,i){for(var a,s,o,l,u,c=0,d=0;d<i.length/2;d++)if(a=i[d*2],s=i[d*2+1],d+1<i.length/2?(o=i[(d+1)*2],l=i[(d+1)*2+1]):(o=i[(d+1-i.length/2)*2],l=i[(d+1-i.length/2)*2+1]),!(a==e&&o==e))if(a>=e&&e>=o||a<=e&&e<=o)u=(e-a)/(o-a)*(l-s)+s,u>n&&c++;else continue;return c%2!==0},Ku=function(e,n,i,a,s,o,l,u,c){var d=new Array(i.length),p;u[0]!=null?(p=Math.atan(u[1]/u[0]),u[0]<0?p=p+Math.PI/2:p=-p-Math.PI/2):p=u;for(var v=Math.cos(-p),y=Math.sin(-p),b=0;b<d.length/2;b++)d[b*2]=o/2*(i[b*2]*v-i[b*2+1]*y),d[b*2+1]=l/2*(i[b*2+1]*v+i[b*2]*y),d[b*2]+=a,d[b*2+1]+=s;var S;if(c>0){var k=uy(d,-c);S=ly(k)}else S=d;return Ms(e,n,S)},gD=function(e,n,i,a,s,o,l,u){for(var c=new Array(i.length*2),d=0;d<u.length;d++){var p=u[d];c[d*4+0]=p.startX,c[d*4+1]=p.startY,c[d*4+2]=p.stopX,c[d*4+3]=p.stopY;var v=Math.pow(p.cx-e,2)+Math.pow(p.cy-n,2);if(v<=Math.pow(p.radius,2))return!0}return Ms(e,n,c)},ly=function(e){for(var n=new Array(e.length/2),i,a,s,o,l,u,c,d,p=0;p<e.length/4;p++){i=e[p*4],a=e[p*4+1],s=e[p*4+2],o=e[p*4+3],p<e.length/4-1?(l=e[(p+1)*4],u=e[(p+1)*4+1],c=e[(p+1)*4+2],d=e[(p+1)*4+3]):(l=e[0],u=e[1],c=e[2],d=e[3]);var v=ld(i,a,s,o,l,u,c,d,!0);n[p*2]=v[0],n[p*2+1]=v[1]}return n},uy=function(e,n){for(var i=new Array(e.length*2),a,s,o,l,u=0;u<e.length/2;u++){a=e[u*2],s=e[u*2+1],u<e.length/2-1?(o=e[(u+1)*2],l=e[(u+1)*2+1]):(o=e[0],l=e[1]);var c=l-s,d=-(o-a),p=Math.sqrt(c*c+d*d),v=c/p,y=d/p;i[u*4]=a+v*n,i[u*4+1]=s+y*n,i[u*4+2]=o+v*n,i[u*4+3]=l+y*n}return i},vD=function(e,n,i,a,s,o){var l=i-e,u=a-n;l/=s,u/=o;var c=Math.sqrt(l*l+u*u),d=c-1;if(d<0)return[];var p=d/c;return[(i-e)*p+e,(a-n)*p+n]},Sh=function(e,n,i,a,s,o,l){return e-=s,n-=o,e/=i/2+l,n/=a/2+l,e*e+n*n<=1},og=function(e,n,i,a,s,o,l){var u=[i-e,a-n],c=[e-s,n-o],d=u[0]*u[0]+u[1]*u[1],p=2*(c[0]*u[0]+c[1]*u[1]),v=c[0]*c[0]+c[1]*c[1]-l*l,y=p*p-4*d*v;if(y<0)return[];var b=(-p+Math.sqrt(y))/(2*d),S=(-p-Math.sqrt(y))/(2*d),k=Math.min(b,S),T=Math.max(b,S),C=[];if(k>=0&&k<=1&&C.push(k),T>=0&&T<=1&&C.push(T),C.length===0)return[];var N=C[0]*u[0]+e,P=C[0]*u[1]+n;if(C.length>1){if(C[0]==C[1])return[N,P];var R=C[1]*u[0]+e,O=C[1]*u[1]+n;return[N,P,R,O]}else return[N,P]},Q1=function(e,n,i){return n<=e&&e<=i||i<=e&&e<=n?e:e<=n&&n<=i||i<=n&&n<=e?n:i},ld=function(e,n,i,a,s,o,l,u,c){var d=e-s,p=i-e,v=l-s,y=n-o,b=a-n,S=u-o,k=v*y-S*d,T=p*y-b*d,C=S*p-v*b;if(C!==0){var N=k/C,P=T/C,R=.001,O=0-R,B=1+R;return O<=N&&N<=B&&O<=P&&P<=B?[e+N*p,n+N*b]:c?[e+N*p,n+N*b]:[]}else return k===0||T===0?Q1(e,i,l)===l?[l,u]:Q1(e,i,s)===s?[s,o]:Q1(s,l,i)===i?[i,a]:[]:[]},yD=function(e,n,i,a,s){var o=[],l=a/2,u=s/2,c=n,d=i;o.push({x:c+l*e[0],y:d+u*e[1]});for(var p=1;p<e.length/2;p++)o.push({x:c+l*e[p*2],y:d+u*e[p*2+1]});return o},Bg=function(e,n,i,a,s,o,l,u){var c=[],d,p=new Array(i.length),v=!0;o==null&&(v=!1);var y;if(v){for(var b=0;b<p.length/2;b++)p[b*2]=i[b*2]*o+a,p[b*2+1]=i[b*2+1]*l+s;if(u>0){var S=uy(p,-u);y=ly(S)}else y=p}else y=i;for(var k,T,C,N,P=0;P<y.length/2;P++)k=y[P*2],T=y[P*2+1],P<y.length/2-1?(C=y[(P+1)*2],N=y[(P+1)*2+1]):(C=y[0],N=y[1]),d=ld(e,n,a,s,k,T,C,N),d.length!==0&&c.push(d[0],d[1]);return c},xD=function(e,n,i,a,s,o,l,u,c){var d=[],p,v=new Array(i.length*2);c.forEach(function(C,N){N===0?(v[v.length-2]=C.startX,v[v.length-1]=C.startY):(v[N*4-2]=C.startX,v[N*4-1]=C.startY),v[N*4]=C.stopX,v[N*4+1]=C.stopY,p=og(e,n,a,s,C.cx,C.cy,C.radius),p.length!==0&&d.push(p[0],p[1])});for(var y=0;y<v.length/4;y++)p=ld(e,n,a,s,v[y*4],v[y*4+1],v[y*4+2],v[y*4+3],!1),p.length!==0&&d.push(p[0],p[1]);if(d.length>2){for(var b=[d[0],d[1]],S=Math.pow(b[0]-e,2)+Math.pow(b[1]-n,2),k=1;k<d.length/2;k++){var T=Math.pow(d[k*2]-e,2)+Math.pow(d[k*2+1]-n,2);T<=S&&(b[0]=d[k*2],b[1]=d[k*2+1],S=T)}return b}return d},s0=function(e,n,i){var a=[e[0]-n[0],e[1]-n[1]],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]),o=(s-i)/s;return o<0&&(o=1e-5),[n[0]+o*a[0],n[1]+o*a[1]]},us=function(e,n){var i=y2(e,n);return i=G4(i),i},G4=function(e){for(var n,i,a=e.length/2,s=1/0,o=1/0,l=-1/0,u=-1/0,c=0;c<a;c++)n=e[2*c],i=e[2*c+1],s=Math.min(s,n),l=Math.max(l,n),o=Math.min(o,i),u=Math.max(u,i);for(var d=2/(l-s),p=2/(u-o),v=0;v<a;v++)n=e[2*v]=e[2*v]*d,i=e[2*v+1]=e[2*v+1]*p,s=Math.min(s,n),l=Math.max(l,n),o=Math.min(o,i),u=Math.max(u,i);if(o<-1)for(var y=0;y<a;y++)i=e[2*y+1]=e[2*y+1]+(-1-o);return e},y2=function(e,n){var i=1/e*2*Math.PI,a=e%2===0?Math.PI/2+i/2:Math.PI/2;a+=n;for(var s=new Array(e*2),o,l=0;l<e;l++)o=l*i+a,s[2*l]=Math.cos(o),s[2*l+1]=Math.sin(-o);return s},_d=function(e,n){return Math.min(e/4,n/4,8)},q4=function(e,n){return Math.min(e/10,n/10,8)},I_=function(){return 8},bD=function(e,n,i){return[e-2*n+i,2*(n-e),e]},x2=function(e,n){return{heightOffset:Math.min(15,.05*n),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};function J1(r,e){function n(p){for(var v=[],y=0;y<p.length;y++){var b=p[y],S=p[(y+1)%p.length],k={x:S.x-b.x,y:S.y-b.y},T={x:-k.y,y:k.x},C=Math.sqrt(T.x*T.x+T.y*T.y);v.push({x:T.x/C,y:T.y/C})}return v}function i(p,v){var y=1/0,b=-1/0,S=js(p),k;try{for(S.s();!(k=S.n()).done;){var T=k.value,C=T.x*v.x+T.y*v.y;y=Math.min(y,C),b=Math.max(b,C)}}catch(N){S.e(N)}finally{S.f()}return{min:y,max:b}}function a(p,v){return!(p.max<v.min||v.max<p.min)}var s=[].concat(iy(n(r)),iy(n(e))),o=js(s),l;try{for(o.s();!(l=o.n()).done;){var u=l.value,c=i(r,u),d=i(e,u);if(!a(c,d))return!1}}catch(p){o.e(p)}finally{o.f()}return!0}var wD=Ta({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),_D={pageRank:function(e){for(var n=wD(e),i=n.dampingFactor,a=n.precision,s=n.iterations,o=n.weight,l=this._private.cy,u=this.byGroup(),c=u.nodes,d=u.edges,p=c.length,v=p*p,y=d.length,b=new Array(v),S=new Array(p),k=(1-i)/p,T=0;T<p;T++){for(var C=0;C<p;C++){var N=T*p+C;b[N]=0}S[T]=0}for(var P=0;P<y;P++){var R=d[P],O=R.data("source"),B=R.data("target");if(O!==B){var I=c.indexOfId(O),z=c.indexOfId(B),V=o(R),$=z*p+I;b[$]+=V,S[I]+=V}}for(var Y=1/p+k,D=0;D<p;D++)if(S[D]===0)for(var q=0;q<p;q++){var G=q*p+D;b[G]=Y}else for(var Z=0;Z<p;Z++){var Q=Z*p+D;b[Q]=b[Q]/S[D]+k}for(var J=new Array(p),ie=new Array(p),ne,W=0;W<p;W++)J[W]=1;for(var re=0;re<s;re++){for(var ae=0;ae<p;ae++)ie[ae]=0;for(var he=0;he<p;he++)for(var ve=0;ve<p;ve++){var xe=he*p+ve;ie[he]+=b[xe]*J[ve]}rD(ie),ne=J,J=ie,ie=ne;for(var se=0,ge=0;ge<p;ge++){var le=ne[ge]-J[ge];se+=le*le}if(se<a)break}var pe={rank:function(be){return be=l.collection(be)[0],J[c.indexOf(be)]}};return pe}},CC=Ta({root:null,weight:function(e){return 1},directed:!1,alpha:0}),ap={degreeCentralityNormalized:function(e){e=CC(e);var n=this.cy(),i=this.nodes(),a=i.length;if(e.directed){for(var d={},p={},v=0,y=0,b=0;b<a;b++){var S=i[b],k=S.id();e.root=S;var T=this.degreeCentrality(e);v<T.indegree&&(v=T.indegree),y<T.outdegree&&(y=T.outdegree),d[k]=T.indegree,p[k]=T.outdegree}return{indegree:function(N){return v==0?0:(Dt(N)&&(N=n.filter(N)),d[N.id()]/v)},outdegree:function(N){return y===0?0:(Dt(N)&&(N=n.filter(N)),p[N.id()]/y)}}}else{for(var s={},o=0,l=0;l<a;l++){var u=i[l];e.root=u;var c=this.degreeCentrality(e);o<c.degree&&(o=c.degree),s[u.id()]=c.degree}return{degree:function(N){return o===0?0:(Dt(N)&&(N=n.filter(N)),s[N.id()]/o)}}}},degreeCentrality:function(e){e=CC(e);var n=this.cy(),i=this,a=e,s=a.root,o=a.weight,l=a.directed,u=a.alpha;if(s=n.collection(s)[0],l){for(var y=s.connectedEdges(),b=y.filter(function(O){return O.target().same(s)&&i.has(O)}),S=y.filter(function(O){return O.source().same(s)&&i.has(O)}),k=b.length,T=S.length,C=0,N=0,P=0;P<b.length;P++)C+=o(b[P]);for(var R=0;R<S.length;R++)N+=o(S[R]);return{indegree:Math.pow(k,1-u)*Math.pow(C,u),outdegree:Math.pow(T,1-u)*Math.pow(N,u)}}else{for(var c=s.connectedEdges().intersection(i),d=c.length,p=0,v=0;v<c.length;v++)p+=o(c[v]);return{degree:Math.pow(d,1-u)*Math.pow(p,u)}}}};ap.dc=ap.degreeCentrality;ap.dcn=ap.degreeCentralityNormalised=ap.degreeCentralityNormalized;var EC=Ta({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),sp={closenessCentralityNormalized:function(e){for(var n=EC(e),i=n.harmonic,a=n.weight,s=n.directed,o=this.cy(),l={},u=0,c=this.nodes(),d=this.floydWarshall({weight:a,directed:s}),p=0;p<c.length;p++){for(var v=0,y=c[p],b=0;b<c.length;b++)if(p!==b){var S=d.distance(y,c[b]);i?v+=1/S:v+=S}i||(v=1/v),u<v&&(u=v),l[y.id()]=v}return{closeness:function(T){return u==0?0:(Dt(T)?T=o.filter(T)[0].id():T=T.id(),l[T]/u)}}},closenessCentrality:function(e){var n=EC(e),i=n.root,a=n.weight,s=n.directed,o=n.harmonic;i=this.filter(i)[0];for(var l=this.dijkstra({root:i,weight:a,directed:s}),u=0,c=this.nodes(),d=0;d<c.length;d++){var p=c[d];if(!p.same(i)){var v=l.distanceTo(p);o?u+=1/v:u+=v}}return o?u:1/u}};sp.cc=sp.closenessCentrality;sp.ccn=sp.closenessCentralityNormalised=sp.closenessCentralityNormalized;var SD=Ta({weight:null,directed:!1}),b2={betweennessCentrality:function(e){for(var n=SD(e),i=n.directed,a=n.weight,s=a!=null,o=this.cy(),l=this.nodes(),u={},c={},d=0,p={set:function(N,P){c[N]=P,P>d&&(d=P)},get:function(N){return c[N]}},v=0;v<l.length;v++){var y=l[v],b=y.id();i?u[b]=y.outgoers().nodes():u[b]=y.openNeighborhood().nodes(),p.set(b,0)}for(var S=function(){for(var N=l[k].id(),P=[],R={},O={},B={},I=new hv(function(he,ve){return B[he]-B[ve]}),z=0;z<l.length;z++){var V=l[z].id();R[V]=[],O[V]=0,B[V]=1/0}for(O[N]=1,B[N]=0,I.push(N);!I.empty();){var $=I.pop();if(P.push($),s)for(var Y=0;Y<u[$].length;Y++){var D=u[$][Y],q=o.getElementById($),G=void 0;q.edgesTo(D).length>0?G=q.edgesTo(D)[0]:G=D.edgesTo(q)[0];var Z=a(G);D=D.id(),B[D]>B[$]+Z&&(B[D]=B[$]+Z,I.nodes.indexOf(D)<0?I.push(D):I.updateItem(D),O[D]=0,R[D]=[]),B[D]==B[$]+Z&&(O[D]=O[D]+O[$],R[D].push($))}else for(var Q=0;Q<u[$].length;Q++){var J=u[$][Q].id();B[J]==1/0&&(I.push(J),B[J]=B[$]+1),B[J]==B[$]+1&&(O[J]=O[J]+O[$],R[J].push($))}}for(var ie={},ne=0;ne<l.length;ne++)ie[l[ne].id()]=0;for(;P.length>0;){for(var W=P.pop(),re=0;re<R[W].length;re++){var ae=R[W][re];ie[ae]=ie[ae]+O[ae]/O[W]*(1+ie[W])}W!=l[k].id()&&p.set(W,p.get(W)+ie[W])}},k=0;k<l.length;k++)S();var T={betweenness:function(N){var P=o.collection(N).id();return p.get(P)},betweennessNormalized:function(N){if(d==0)return 0;var P=o.collection(N).id();return p.get(P)/d}};return T.betweennessNormalised=T.betweennessNormalized,T}};b2.bc=b2.betweennessCentrality;var kD=Ta({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(r){return 1}]}),CD=function(e){return kD(e)},ED=function(e,n){for(var i=0,a=0;a<n.length;a++)i+=n[a](e);return i},ND=function(e,n,i){for(var a=0;a<n;a++)e[a*n+a]=i},W4=function(e,n){for(var i,a=0;a<n;a++){i=0;for(var s=0;s<n;s++)i+=e[s*n+a];for(var o=0;o<n;o++)e[o*n+a]=e[o*n+a]/i}},TD=function(e,n,i){for(var a=new Array(i*i),s=0;s<i;s++){for(var o=0;o<i;o++)a[s*i+o]=0;for(var l=0;l<i;l++)for(var u=0;u<i;u++)a[s*i+u]+=e[s*i+l]*n[l*i+u]}return a},PD=function(e,n,i){for(var a=e.slice(0),s=1;s<i;s++)e=TD(e,a,n);return e},MD=function(e,n,i){for(var a=new Array(n*n),s=0;s<n*n;s++)a[s]=Math.pow(e[s],i);return W4(a,n),a},AD=function(e,n,i,a){for(var s=0;s<i;s++){var o=Math.round(e[s]*Math.pow(10,a))/Math.pow(10,a),l=Math.round(n[s]*Math.pow(10,a))/Math.pow(10,a);if(o!==l)return!1}return!0},jD=function(e,n,i,a){for(var s=[],o=0;o<n;o++){for(var l=[],u=0;u<n;u++)Math.round(e[o*n+u]*1e3)/1e3>0&&l.push(i[u]);l.length!==0&&s.push(a.collection(l))}return s},RD=function(e,n){for(var i=0;i<e.length;i++)if(!n[i]||e[i].id()!==n[i].id())return!1;return!0},LD=function(e){for(var n=0;n<e.length;n++)for(var i=0;i<e.length;i++)n!=i&&RD(e[n],e[i])&&e.splice(i,1);return e},NC=function(e){for(var n=this.nodes(),i=this.edges(),a=this.cy(),s=CD(e),o={},l=0;l<n.length;l++)o[n[l].id()]=l;for(var u=n.length,c=u*u,d=new Array(c),p,v=0;v<c;v++)d[v]=0;for(var y=0;y<i.length;y++){var b=i[y],S=o[b.source().id()],k=o[b.target().id()],T=ED(b,s.attributes);d[S*u+k]+=T,d[k*u+S]+=T}ND(d,u,s.multFactor),W4(d,u);for(var C=!0,N=0;C&&N<s.maxIterations;)C=!1,p=PD(d,u,s.expandFactor),d=MD(p,u,s.inflateFactor),AD(d,p,c,4)||(C=!0),N++;var P=jD(d,u,n,a);return P=LD(P),P},OD={markovClustering:NC,mcl:NC},DD=function(e){return e},$4=function(e,n){return Math.abs(n-e)},TC=function(e,n,i){return e+$4(n,i)},PC=function(e,n,i){return e+Math.pow(i-n,2)},ID=function(e){return Math.sqrt(e)},BD=function(e,n,i){return Math.max(e,$4(n,i))},am=function(e,n,i,a,s){for(var o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:DD,l=a,u,c,d=0;d<e;d++)u=n(d),c=i(d),l=s(l,u,c);return o(l)},hp={euclidean:function(e,n,i){return e>=2?am(e,n,i,0,PC,ID):am(e,n,i,0,TC)},squaredEuclidean:function(e,n,i){return am(e,n,i,0,PC)},manhattan:function(e,n,i){return am(e,n,i,0,TC)},max:function(e,n,i){return am(e,n,i,-1/0,BD)}};hp["squared-euclidean"]=hp.squaredEuclidean;hp.squaredeuclidean=hp.squaredEuclidean;function vx(r,e,n,i,a,s){var o;return zn(r)?o=r:o=hp[r]||hp.euclidean,e===0&&zn(r)?o(a,s):o(e,n,i,a,s)}var zD=Ta({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),B_=function(e){return zD(e)},cy=function(e,n,i,a,s){var o=s!=="kMedoids",l=o?function(p){return i[p]}:function(p){return a[p](i)},u=function(v){return a[v](n)},c=i,d=n;return vx(e,a.length,l,u,c,d)},eb=function(e,n,i){for(var a=i.length,s=new Array(a),o=new Array(a),l=new Array(n),u=null,c=0;c<a;c++)s[c]=e.min(i[c]).value,o[c]=e.max(i[c]).value;for(var d=0;d<n;d++){u=[];for(var p=0;p<a;p++)u[p]=Math.random()*(o[p]-s[p])+s[p];l[d]=u}return l},K4=function(e,n,i,a,s){for(var o=1/0,l=0,u=0;u<n.length;u++){var c=cy(i,e,n[u],a,s);c<o&&(o=c,l=u)}return l},Z4=function(e,n,i){for(var a=[],s=null,o=0;o<n.length;o++)s=n[o],i[s.id()]===e&&a.push(s);return a},FD=function(e,n,i){return Math.abs(n-e)<=i},VD=function(e,n,i){for(var a=0;a<e.length;a++)for(var s=0;s<e[a].length;s++){var o=Math.abs(e[a][s]-n[a][s]);if(o>i)return!1}return!0},UD=function(e,n,i){for(var a=0;a<i;a++)if(e===n[a])return!0;return!1},MC=function(e,n){var i=new Array(n);if(e.length<50)for(var a=0;a<n;a++){for(var s=e[Math.floor(Math.random()*e.length)];UD(s,i,a);)s=e[Math.floor(Math.random()*e.length)];i[a]=s}else for(var o=0;o<n;o++)i[o]=e[Math.floor(Math.random()*e.length)];return i},AC=function(e,n,i){for(var a=0,s=0;s<n.length;s++)a+=cy("manhattan",n[s],e,i,"kMedoids");return a},HD=function(e){var n=this.cy(),i=this.nodes(),a=null,s=B_(e),o=new Array(s.k),l={},u;s.testMode?typeof s.testCentroids=="number"?(s.testCentroids,u=eb(i,s.k,s.attributes)):Ai(s.testCentroids)==="object"?u=s.testCentroids:u=eb(i,s.k,s.attributes):u=eb(i,s.k,s.attributes);for(var c=!0,d=0;c&&d<s.maxIterations;){for(var p=0;p<i.length;p++)a=i[p],l[a.id()]=K4(a,u,s.distance,s.attributes,"kMeans");c=!1;for(var v=0;v<s.k;v++){var y=Z4(v,i,l);if(y.length!==0){for(var b=s.attributes.length,S=u[v],k=new Array(b),T=new Array(b),C=0;C<b;C++){T[C]=0;for(var N=0;N<y.length;N++)a=y[N],T[C]+=s.attributes[C](a);k[C]=T[C]/y.length,FD(k[C],S[C],s.sensitivityThreshold)||(c=!0)}u[v]=k,o[v]=n.collection(y)}}d++}return o},GD=function(e){var n=this.cy(),i=this.nodes(),a=null,s=B_(e),o=new Array(s.k),l,u={},c,d=new Array(s.k);s.testMode?typeof s.testCentroids=="number"||(Ai(s.testCentroids)==="object"?l=s.testCentroids:l=MC(i,s.k)):l=MC(i,s.k);for(var p=!0,v=0;p&&v<s.maxIterations;){for(var y=0;y<i.length;y++)a=i[y],u[a.id()]=K4(a,l,s.distance,s.attributes,"kMedoids");p=!1;for(var b=0;b<l.length;b++){var S=Z4(b,i,u);if(S.length!==0){d[b]=AC(l[b],S,s.attributes);for(var k=0;k<S.length;k++)c=AC(S[k],S,s.attributes),c<d[b]&&(d[b]=c,l[b]=S[k],p=!0);o[b]=n.collection(S)}}v++}return o},qD=function(e,n,i,a,s){for(var o,l,u=0;u<n.length;u++)for(var c=0;c<e.length;c++)a[u][c]=Math.pow(i[u][c],s.m);for(var d=0;d<e.length;d++)for(var p=0;p<s.attributes.length;p++){o=0,l=0;for(var v=0;v<n.length;v++)o+=a[v][d]*s.attributes[p](n[v]),l+=a[v][d];e[d][p]=o/l}},WD=function(e,n,i,a,s){for(var o=0;o<e.length;o++)n[o]=e[o].slice();for(var l,u,c,d=2/(s.m-1),p=0;p<i.length;p++)for(var v=0;v<a.length;v++){l=0;for(var y=0;y<i.length;y++)u=cy(s.distance,a[v],i[p],s.attributes,"cmeans"),c=cy(s.distance,a[v],i[y],s.attributes,"cmeans"),l+=Math.pow(u/c,d);e[v][p]=1/l}},$D=function(e,n,i,a){for(var s=new Array(i.k),o=0;o<s.length;o++)s[o]=[];for(var l,u,c=0;c<n.length;c++){l=-1/0,u=-1;for(var d=0;d<n[0].length;d++)n[c][d]>l&&(l=n[c][d],u=d);s[u].push(e[c])}for(var p=0;p<s.length;p++)s[p]=a.collection(s[p]);return s},jC=function(e){var n=this.cy(),i=this.nodes(),a=B_(e),s,o,l,u,c;u=new Array(i.length);for(var d=0;d<i.length;d++)u[d]=new Array(a.k);l=new Array(i.length);for(var p=0;p<i.length;p++)l[p]=new Array(a.k);for(var v=0;v<i.length;v++){for(var y=0,b=0;b<a.k;b++)l[v][b]=Math.random(),y+=l[v][b];for(var S=0;S<a.k;S++)l[v][S]=l[v][S]/y}o=new Array(a.k);for(var k=0;k<a.k;k++)o[k]=new Array(a.attributes.length);c=new Array(i.length);for(var T=0;T<i.length;T++)c[T]=new Array(a.k);for(var C=!0,N=0;C&&N<a.maxIterations;)C=!1,qD(o,i,l,c,a),WD(l,u,o,i,a),VD(l,u,a.sensitivityThreshold)||(C=!0),N++;return s=$D(i,l,a,n),{clusters:s,degreeOfMembership:l}},KD={kMeans:HD,kMedoids:GD,fuzzyCMeans:jC,fcm:jC},ZD=Ta({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),YD={single:"min",complete:"max"},XD=function(e){var n=ZD(e),i=YD[n.linkage];return i!=null&&(n.linkage=i),n},RC=function(e,n,i,a,s){for(var o=0,l=1/0,u,c=s.attributes,d=function(z,V){return vx(s.distance,c.length,function($){return c[$](z)},function($){return c[$](V)},z,V)},p=0;p<e.length;p++){var v=e[p].key,y=i[v][a[v]];y<l&&(o=v,l=y)}if(s.mode==="threshold"&&l>=s.threshold||s.mode==="dendrogram"&&e.length===1)return!1;var b=n[o],S=n[a[o]],k;s.mode==="dendrogram"?k={left:b,right:S,key:b.key}:k={value:b.value.concat(S.value),key:b.key},e[b.index]=k,e.splice(S.index,1),n[b.key]=k;for(var T=0;T<e.length;T++){var C=e[T];b.key===C.key?u=1/0:s.linkage==="min"?(u=i[b.key][C.key],i[b.key][C.key]>i[S.key][C.key]&&(u=i[S.key][C.key])):s.linkage==="max"?(u=i[b.key][C.key],i[b.key][C.key]<i[S.key][C.key]&&(u=i[S.key][C.key])):s.linkage==="mean"?u=(i[b.key][C.key]*b.size+i[S.key][C.key]*S.size)/(b.size+S.size):s.mode==="dendrogram"?u=d(C.value,b.value):u=d(C.value[0],b.value[0]),i[b.key][C.key]=i[C.key][b.key]=u}for(var N=0;N<e.length;N++){var P=e[N].key;if(a[P]===b.key||a[P]===S.key){for(var R=P,O=0;O<e.length;O++){var B=e[O].key;i[P][B]<i[P][R]&&(R=B)}a[P]=R}e[N].index=N}return b.key=S.key=b.index=S.index=null,!0},ep=function(e,n,i){e&&(e.value?n.push(e.value):(e.left&&ep(e.left,n),e.right&&ep(e.right,n)))},w2=function(e,n){if(!e)return"";if(e.left&&e.right){var i=w2(e.left,n),a=w2(e.right,n),s=n.add({group:"nodes",data:{id:i+","+a}});return n.add({group:"edges",data:{source:i,target:s.id()}}),n.add({group:"edges",data:{source:a,target:s.id()}}),s.id()}else if(e.value)return e.value.id()},_2=function(e,n,i){if(!e)return[];var a=[],s=[],o=[];return n===0?(e.left&&ep(e.left,a),e.right&&ep(e.right,s),o=a.concat(s),[i.collection(o)]):n===1?e.value?[i.collection(e.value)]:(e.left&&ep(e.left,a),e.right&&ep(e.right,s),[i.collection(a),i.collection(s)]):e.value?[i.collection(e.value)]:(e.left&&(a=_2(e.left,n-1,i)),e.right&&(s=_2(e.right,n-1,i)),a.concat(s))},LC=function(e){for(var n=this.cy(),i=this.nodes(),a=XD(e),s=a.attributes,o=function(N,P){return vx(a.distance,s.length,function(R){return s[R](N)},function(R){return s[R](P)},N,P)},l=[],u=[],c=[],d=[],p=0;p<i.length;p++){var v={value:a.mode==="dendrogram"?i[p]:[i[p]],key:p,index:p};l[p]=v,d[p]=v,u[p]=[],c[p]=0}for(var y=0;y<l.length;y++)for(var b=0;b<=y;b++){var S=void 0;a.mode==="dendrogram"?S=y===b?1/0:o(l[y].value,l[b].value):S=y===b?1/0:o(l[y].value[0],l[b].value[0]),u[y][b]=S,u[b][y]=S,S<u[y][c[y]]&&(c[y]=b)}for(var k=RC(l,d,u,c,a);k;)k=RC(l,d,u,c,a);var T;return a.mode==="dendrogram"?(T=_2(l[0],a.dendrogramDepth,n),a.addDendrogram&&w2(l[0],n)):(T=new Array(l.length),l.forEach(function(C,N){C.key=C.index=null,T[N]=n.collection(C.value)})),T},QD={hierarchicalClustering:LC,hca:LC},JD=Ta({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),eI=function(e){var n=e.damping,i=e.preference;.5<=n&&n<1||Rn("Damping must range on [0.5, 1).  Got: ".concat(n));var a=["median","mean","min","max"];return a.some(function(s){return s===i})||ht(i)||Rn("Preference must be one of [".concat(a.map(function(s){return"'".concat(s,"'")}).join(", "),"] or a number.  Got: ").concat(i)),JD(e)},tI=function(e,n,i,a){var s=function(l,u){return a[u](l)};return-vx(e,a.length,function(o){return s(n,o)},function(o){return s(i,o)},n,i)},rI=function(e,n){var i=null;return n==="median"?i=eD(e):n==="mean"?i=JO(e):n==="min"?i=XO(e):n==="max"?i=QO(e):i=n,i},nI=function(e,n,i){for(var a=[],s=0;s<e;s++)n[s*e+s]+i[s*e+s]>0&&a.push(s);return a},OC=function(e,n,i){for(var a=[],s=0;s<e;s++){for(var o=-1,l=-1/0,u=0;u<i.length;u++){var c=i[u];n[s*e+c]>l&&(o=c,l=n[s*e+c])}o>0&&a.push(o)}for(var d=0;d<i.length;d++)a[i[d]]=i[d];return a},iI=function(e,n,i){for(var a=OC(e,n,i),s=0;s<i.length;s++){for(var o=[],l=0;l<a.length;l++)a[l]===i[s]&&o.push(l);for(var u=-1,c=-1/0,d=0;d<o.length;d++){for(var p=0,v=0;v<o.length;v++)p+=n[o[v]*e+o[d]];p>c&&(u=d,c=p)}i[s]=o[u]}return a=OC(e,n,i),a},DC=function(e){for(var n=this.cy(),i=this.nodes(),a=eI(e),s={},o=0;o<i.length;o++)s[i[o].id()]=o;var l,u,c,d,p,v;l=i.length,u=l*l,c=new Array(u);for(var y=0;y<u;y++)c[y]=-1/0;for(var b=0;b<l;b++)for(var S=0;S<l;S++)b!==S&&(c[b*l+S]=tI(a.distance,i[b],i[S],a.attributes));d=rI(c,a.preference);for(var k=0;k<l;k++)c[k*l+k]=d;p=new Array(u);for(var T=0;T<u;T++)p[T]=0;v=new Array(u);for(var C=0;C<u;C++)v[C]=0;for(var N=new Array(l),P=new Array(l),R=new Array(l),O=0;O<l;O++)N[O]=0,P[O]=0,R[O]=0;for(var B=new Array(l*a.minIterations),I=0;I<B.length;I++)B[I]=0;var z;for(z=0;z<a.maxIterations;z++){for(var V=0;V<l;V++){for(var $=-1/0,Y=-1/0,D=-1,q=0,G=0;G<l;G++)N[G]=p[V*l+G],q=v[V*l+G]+c[V*l+G],q>=$?(Y=$,$=q,D=G):q>Y&&(Y=q);for(var Z=0;Z<l;Z++)p[V*l+Z]=(1-a.damping)*(c[V*l+Z]-$)+a.damping*N[Z];p[V*l+D]=(1-a.damping)*(c[V*l+D]-Y)+a.damping*N[D]}for(var Q=0;Q<l;Q++){for(var J=0,ie=0;ie<l;ie++)N[ie]=v[ie*l+Q],P[ie]=Math.max(0,p[ie*l+Q]),J+=P[ie];J-=P[Q],P[Q]=p[Q*l+Q],J+=P[Q];for(var ne=0;ne<l;ne++)v[ne*l+Q]=(1-a.damping)*Math.min(0,J-P[ne])+a.damping*N[ne];v[Q*l+Q]=(1-a.damping)*(J-P[Q])+a.damping*N[Q]}for(var W=0,re=0;re<l;re++){var ae=v[re*l+re]+p[re*l+re]>0?1:0;B[z%a.minIterations*l+re]=ae,W+=ae}if(W>0&&(z>=a.minIterations-1||z==a.maxIterations-1)){for(var he=0,ve=0;ve<l;ve++){R[ve]=0;for(var xe=0;xe<a.minIterations;xe++)R[ve]+=B[xe*l+ve];(R[ve]===0||R[ve]===a.minIterations)&&he++}if(he===l)break}}for(var se=nI(l,p,v),ge=iI(l,c,se),le={},pe=0;pe<se.length;pe++)le[se[pe]]=[];for(var me=0;me<i.length;me++){var be=s[i[me].id()],Se=ge[be];Se!=null&&le[Se].push(i[me])}for(var Ue=new Array(se.length),We=0;We<se.length;We++)Ue[We]=n.collection(le[se[We]]);return Ue},aI={affinityPropagation:DC,ap:DC},sI=Ta({root:void 0,directed:!1}),oI={hierholzer:function(e){if(!Sr(e)){var n=arguments;e={root:n[0],directed:n[1]}}var i=sI(e),a=i.root,s=i.directed,o=this,l=!1,u,c,d;a&&(d=Dt(a)?this.filter(a)[0].id():a[0].id());var p={},v={};s?o.forEach(function(C){var N=C.id();if(C.isNode()){var P=C.indegree(!0),R=C.outdegree(!0),O=P-R,B=R-P;O==1?u?l=!0:u=N:B==1?c?l=!0:c=N:(B>1||O>1)&&(l=!0),p[N]=[],C.outgoers().forEach(function(I){I.isEdge()&&p[N].push(I.id())})}else v[N]=[void 0,C.target().id()]}):o.forEach(function(C){var N=C.id();if(C.isNode()){var P=C.degree(!0);P%2&&(u?c?l=!0:c=N:u=N),p[N]=[],C.connectedEdges().forEach(function(R){return p[N].push(R.id())})}else v[N]=[C.source().id(),C.target().id()]});var y={found:!1,trail:void 0};if(l)return y;if(c&&u)if(s){if(d&&c!=d)return y;d=c}else{if(d&&c!=d&&u!=d)return y;d||(d=c)}else d||(d=o[0].id());var b=function(N){for(var P=N,R=[N],O,B,I;p[P].length;)O=p[P].shift(),B=v[O][0],I=v[O][1],P!=I?(p[I]=p[I].filter(function(z){return z!=O}),P=I):!s&&P!=B&&(p[B]=p[B].filter(function(z){return z!=O}),P=B),R.unshift(O),R.unshift(P);return R},S=[],k=[];for(k=b(d);k.length!=1;)p[k[0]].length==0?(S.unshift(o.getElementById(k.shift())),S.unshift(o.getElementById(k.shift()))):k=b(k.shift()).concat(k);S.unshift(o.getElementById(k.shift()));for(var T in p)if(p[T].length)return y;return y.found=!0,y.trail=this.spawn(S,!0),y}},o0=function(){var e=this,n={},i=0,a=0,s=[],o=[],l={},u=function(v,y){for(var b=o.length-1,S=[],k=e.spawn();o[b].x!=v||o[b].y!=y;)S.push(o.pop().edge),b--;S.push(o.pop().edge),S.forEach(function(T){var C=T.connectedNodes().intersection(e);k.merge(T),C.forEach(function(N){var P=N.id(),R=N.connectedEdges().intersection(e);k.merge(N),n[P].cutVertex?k.merge(R.filter(function(O){return O.isLoop()})):k.merge(R)})}),s.push(k)},c=function(v,y,b){v===b&&(a+=1),n[y]={id:i,low:i++,cutVertex:!1};var S=e.getElementById(y).connectedEdges().intersection(e);if(S.size()===0)s.push(e.spawn(e.getElementById(y)));else{var k,T,C,N;S.forEach(function(P){k=P.source().id(),T=P.target().id(),C=k===y?T:k,C!==b&&(N=P.id(),l[N]||(l[N]=!0,o.push({x:y,y:C,edge:P})),C in n?n[y].low=Math.min(n[y].low,n[C].id):(c(v,C,y),n[y].low=Math.min(n[y].low,n[C].low),n[y].id<=n[C].low&&(n[y].cutVertex=!0,u(y,C))))})}};e.forEach(function(p){if(p.isNode()){var v=p.id();v in n||(a=0,c(v,v),n[v].cutVertex=a>1)}});var d=Object.keys(n).filter(function(p){return n[p].cutVertex}).map(function(p){return e.getElementById(p)});return{cut:e.spawn(d),components:s}},lI={hopcroftTarjanBiconnected:o0,htbc:o0,htb:o0,hopcroftTarjanBiconnectedComponents:o0},l0=function(){var e=this,n={},i=0,a=[],s=[],o=e.spawn(e),l=function(c){s.push(c),n[c]={index:i,low:i++,explored:!1};var d=e.getElementById(c).connectedEdges().intersection(e);if(d.forEach(function(S){var k=S.target().id();k!==c&&(k in n||l(k),n[k].explored||(n[c].low=Math.min(n[c].low,n[k].low)))}),n[c].index===n[c].low){for(var p=e.spawn();;){var v=s.pop();if(p.merge(e.getElementById(v)),n[v].low=n[c].index,n[v].explored=!0,v===c)break}var y=p.edgesWith(p),b=p.merge(y);a.push(b),o=o.difference(b)}};return e.forEach(function(u){if(u.isNode()){var c=u.id();c in n||l(c)}}),{cut:o,components:a}},uI={tarjanStronglyConnected:l0,tsc:l0,tscc:l0,tarjanStronglyConnectedComponents:l0},Y4={};[Dg,zO,FO,UO,GO,WO,ZO,_D,ap,sp,b2,OD,KD,QD,aI,oI,lI,uI].forEach(function(r){Ht(Y4,r)});var X4=0,Q4=1,J4=2,fl=function(e){if(!(this instanceof fl))return new fl(e);this.id="Thenable/1.0.7",this.state=X4,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};fl.prototype={fulfill:function(e){return IC(this,Q4,"fulfillValue",e)},reject:function(e){return IC(this,J4,"rejectReason",e)},then:function(e,n){var i=this,a=new fl;return i.onFulfilled.push(zC(e,a,"fulfill")),i.onRejected.push(zC(n,a,"reject")),eP(i),a.proxy}};var IC=function(e,n,i,a){return e.state===X4&&(e.state=n,e[i]=a,eP(e)),e},eP=function(e){e.state===Q4?BC(e,"onFulfilled",e.fulfillValue):e.state===J4&&BC(e,"onRejected",e.rejectReason)},BC=function(e,n,i){if(e[n].length!==0){var a=e[n];e[n]=[];var s=function(){for(var l=0;l<a.length;l++)a[l](i)};typeof setImmediate=="function"?setImmediate(s):setTimeout(s,0)}},zC=function(e,n,i){return function(a){if(typeof e!="function")n[i].call(n,a);else{var s;try{s=e(a)}catch(o){n.reject(o);return}tP(n,s)}}},tP=function(e,n){if(e===n||e.proxy===n){e.reject(new TypeError("cannot resolve promise with itself"));return}var i;if(Ai(n)==="object"&&n!==null||typeof n=="function")try{i=n.then}catch(s){e.reject(s);return}if(typeof i=="function"){var a=!1;try{i.call(n,function(s){a||(a=!0,s===n?e.reject(new TypeError("circular thenable chain")):tP(e,s))},function(s){a||(a=!0,e.reject(s))})}catch(s){a||e.reject(s)}return}e.fulfill(n)};fl.all=function(r){return new fl(function(e,n){for(var i=new Array(r.length),a=0,s=function(u,c){i[u]=c,a++,a===r.length&&e(i)},o=0;o<r.length;o++)(function(l){var u=r[l],c=u!=null&&u.then!=null;if(c)u.then(function(p){s(l,p)},function(p){n(p)});else{var d=u;s(l,d)}})(o)})};fl.resolve=function(r){return new fl(function(e,n){e(r)})};fl.reject=function(r){return new fl(function(e,n){n(r)})};var Pp=typeof Promise<"u"?Promise:fl,S2=function(e,n,i){var a=T_(e),s=!a,o=this._private=Ht({duration:1e3},n,i);if(o.target=e,o.style=o.style||o.css,o.started=!1,o.playing=!1,o.hooked=!1,o.applying=!1,o.progress=0,o.completes=[],o.frames=[],o.complete&&zn(o.complete)&&o.completes.push(o.complete),s){var l=e.position();o.startPosition=o.startPosition||{x:l.x,y:l.y},o.startStyle=o.startStyle||e.cy().style().getAnimationStartStyle(e,o.style)}if(a){var u=e.pan();o.startPan={x:u.x,y:u.y},o.startZoom=e.zoom()}this.length=1,this[0]=this},Bh=S2.prototype;Ht(Bh,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var n,i=e.target._private.animation;e.queue?n=i.queue:n=i.current,n.push(this),Xs(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var n=this._private;return e===void 0?n.progress*n.duration:this.progress(e/n.duration)},progress:function(e){var n=this._private,i=n.playing;return e===void 0?n.progress:(i&&this.pause(),n.progress=e,n.started=!1,i&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,n=e.playing;n&&this.pause(),e.progress=1-e.progress,e.started=!1;var i=function(c,d){var p=e[c];p!=null&&(e[c]=e[d],e[d]=p)};if(i("zoom","startZoom"),i("pan","startPan"),i("position","startPosition"),e.style)for(var a=0;a<e.style.length;a++){var s=e.style[a],o=s.name,l=e.startStyle[o];e.startStyle[o]=s,e.style[a]=l}return n&&this.play(),this},promise:function(e){var n=this._private,i;switch(e){case"frame":i=n.frames;break;default:case"complete":case"completed":i=n.completes}return new Pp(function(a,s){i.push(function(){a()})})}});Bh.complete=Bh.completed;Bh.run=Bh.play;Bh.running=Bh.playing;var cI={animated:function(){return function(){var n=this,i=n.length!==void 0,a=i?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return!1;var o=a[0];if(o)return o._private.animation.current.length>0}},clearQueue:function(){return function(){var n=this,i=n.length!==void 0,a=i?n:[n],s=this._private.cy||this;if(!s.styleEnabled())return this;for(var o=0;o<a.length;o++){var l=a[o];l._private.animation.queue=[]}return this}},delay:function(){return function(n,i){var a=this._private.cy||this;return a.styleEnabled()?this.animate({delay:n,duration:n,complete:i}):this}},delayAnimation:function(){return function(n,i){var a=this._private.cy||this;return a.styleEnabled()?this.animation({delay:n,duration:n,complete:i}):this}},animation:function(){return function(n,i){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this,u=!s,c=!u;if(!l.styleEnabled())return this;var d=l.style();n=Ht({},n,i);var p=Object.keys(n).length===0;if(p)return new S2(o[0],n);switch(n.duration===void 0&&(n.duration=400),n.duration){case"slow":n.duration=600;break;case"fast":n.duration=200;break}if(c&&(n.style=d.getPropsList(n.style||n.css),n.css=void 0),c&&n.renderedPosition!=null){var v=n.renderedPosition,y=l.pan(),b=l.zoom();n.position=F4(v,b,y)}if(u&&n.panBy!=null){var S=n.panBy,k=l.pan();n.pan={x:k.x+S.x,y:k.y+S.y}}var T=n.center||n.centre;if(u&&T!=null){var C=l.getCenterPan(T.eles,n.zoom);C!=null&&(n.pan=C)}if(u&&n.fit!=null){var N=n.fit,P=l.getFitViewport(N.eles||N.boundingBox,N.padding);P!=null&&(n.pan=P.pan,n.zoom=P.zoom)}if(u&&Sr(n.zoom)){var R=l.getZoomedViewport(n.zoom);R!=null?(R.zoomed&&(n.zoom=R.zoom),R.panned&&(n.pan=R.pan)):n.zoom=null}return new S2(o[0],n)}},animate:function(){return function(n,i){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this;if(!l.styleEnabled())return this;i&&(n=Ht({},n,i));for(var u=0;u<o.length;u++){var c=o[u],d=c.animated()&&(n.queue===void 0||n.queue),p=c.animation(n,d?{queue:!0}:void 0);p.play()}return this}},stop:function(){return function(n,i){var a=this,s=a.length!==void 0,o=s?a:[a],l=this._private.cy||this;if(!l.styleEnabled())return this;for(var u=0;u<o.length;u++){for(var c=o[u],d=c._private,p=d.animation.current,v=0;v<p.length;v++){var y=p[v],b=y._private;i&&(b.duration=0)}n&&(d.animation.queue=[]),i||(d.animation.current=[])}return l.notify("draw"),this}}},tb,FC;function yx(){if(FC)return tb;FC=1;var r=Array.isArray;return tb=r,tb}var rb,VC;function dI(){if(VC)return rb;VC=1;var r=yx(),e=cv(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;function a(s,o){if(r(s))return!1;var l=typeof s;return l=="number"||l=="symbol"||l=="boolean"||s==null||e(s)?!0:i.test(s)||!n.test(s)||o!=null&&s in Object(o)}return rb=a,rb}var nb,UC;function hI(){if(UC)return nb;UC=1;var r=A4(),e=uv(),n="[object AsyncFunction]",i="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!e(l))return!1;var u=r(l);return u==i||u==a||u==n||u==s}return nb=o,nb}var ib,HC;function fI(){if(HC)return ib;HC=1;var r=px(),e=r["__core-js_shared__"];return ib=e,ib}var ab,GC;function pI(){if(GC)return ab;GC=1;var r=fI(),e=(function(){var i=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""})();function n(i){return!!e&&e in i}return ab=n,ab}var sb,qC;function mI(){if(qC)return sb;qC=1;var r=Function.prototype,e=r.toString;function n(i){if(i!=null){try{return e.call(i)}catch{}try{return i+""}catch{}}return""}return sb=n,sb}var ob,WC;function gI(){if(WC)return ob;WC=1;var r=hI(),e=pI(),n=uv(),i=mI(),a=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,u=o.toString,c=l.hasOwnProperty,d=RegExp("^"+u.call(c).replace(a,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function p(v){if(!n(v)||e(v))return!1;var y=r(v)?d:s;return y.test(i(v))}return ob=p,ob}var lb,$C;function vI(){if($C)return lb;$C=1;function r(e,n){return e?.[n]}return lb=r,lb}var ub,KC;function z_(){if(KC)return ub;KC=1;var r=gI(),e=vI();function n(i,a){var s=e(i,a);return r(s)?s:void 0}return ub=n,ub}var cb,ZC;function xx(){if(ZC)return cb;ZC=1;var r=z_(),e=r(Object,"create");return cb=e,cb}var db,YC;function yI(){if(YC)return db;YC=1;var r=xx();function e(){this.__data__=r?r(null):{},this.size=0}return db=e,db}var hb,XC;function xI(){if(XC)return hb;XC=1;function r(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}return hb=r,hb}var fb,QC;function bI(){if(QC)return fb;QC=1;var r=xx(),e="__lodash_hash_undefined__",n=Object.prototype,i=n.hasOwnProperty;function a(s){var o=this.__data__;if(r){var l=o[s];return l===e?void 0:l}return i.call(o,s)?o[s]:void 0}return fb=a,fb}var pb,JC;function wI(){if(JC)return pb;JC=1;var r=xx(),e=Object.prototype,n=e.hasOwnProperty;function i(a){var s=this.__data__;return r?s[a]!==void 0:n.call(s,a)}return pb=i,pb}var mb,eE;function _I(){if(eE)return mb;eE=1;var r=xx(),e="__lodash_hash_undefined__";function n(i,a){var s=this.__data__;return this.size+=this.has(i)?0:1,s[i]=r&&a===void 0?e:a,this}return mb=n,mb}var gb,tE;function SI(){if(tE)return gb;tE=1;var r=yI(),e=xI(),n=bI(),i=wI(),a=_I();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var c=o[l];this.set(c[0],c[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,gb=s,gb}var vb,rE;function kI(){if(rE)return vb;rE=1;function r(){this.__data__=[],this.size=0}return vb=r,vb}var yb,nE;function rP(){if(nE)return yb;nE=1;function r(e,n){return e===n||e!==e&&n!==n}return yb=r,yb}var xb,iE;function bx(){if(iE)return xb;iE=1;var r=rP();function e(n,i){for(var a=n.length;a--;)if(r(n[a][0],i))return a;return-1}return xb=e,xb}var bb,aE;function CI(){if(aE)return bb;aE=1;var r=bx(),e=Array.prototype,n=e.splice;function i(a){var s=this.__data__,o=r(s,a);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():n.call(s,o,1),--this.size,!0}return bb=i,bb}var wb,sE;function EI(){if(sE)return wb;sE=1;var r=bx();function e(n){var i=this.__data__,a=r(i,n);return a<0?void 0:i[a][1]}return wb=e,wb}var _b,oE;function NI(){if(oE)return _b;oE=1;var r=bx();function e(n){return r(this.__data__,n)>-1}return _b=e,_b}var Sb,lE;function TI(){if(lE)return Sb;lE=1;var r=bx();function e(n,i){var a=this.__data__,s=r(a,n);return s<0?(++this.size,a.push([n,i])):a[s][1]=i,this}return Sb=e,Sb}var kb,uE;function PI(){if(uE)return kb;uE=1;var r=kI(),e=CI(),n=EI(),i=NI(),a=TI();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var c=o[l];this.set(c[0],c[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,kb=s,kb}var Cb,cE;function MI(){if(cE)return Cb;cE=1;var r=z_(),e=px(),n=r(e,"Map");return Cb=n,Cb}var Eb,dE;function AI(){if(dE)return Eb;dE=1;var r=SI(),e=PI(),n=MI();function i(){this.size=0,this.__data__={hash:new r,map:new(n||e),string:new r}}return Eb=i,Eb}var Nb,hE;function jI(){if(hE)return Nb;hE=1;function r(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}return Nb=r,Nb}var Tb,fE;function wx(){if(fE)return Tb;fE=1;var r=jI();function e(n,i){var a=n.__data__;return r(i)?a[typeof i=="string"?"string":"hash"]:a.map}return Tb=e,Tb}var Pb,pE;function RI(){if(pE)return Pb;pE=1;var r=wx();function e(n){var i=r(this,n).delete(n);return this.size-=i?1:0,i}return Pb=e,Pb}var Mb,mE;function LI(){if(mE)return Mb;mE=1;var r=wx();function e(n){return r(this,n).get(n)}return Mb=e,Mb}var Ab,gE;function OI(){if(gE)return Ab;gE=1;var r=wx();function e(n){return r(this,n).has(n)}return Ab=e,Ab}var jb,vE;function DI(){if(vE)return jb;vE=1;var r=wx();function e(n,i){var a=r(this,n),s=a.size;return a.set(n,i),this.size+=a.size==s?0:1,this}return jb=e,jb}var Rb,yE;function II(){if(yE)return Rb;yE=1;var r=AI(),e=RI(),n=LI(),i=OI(),a=DI();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var c=o[l];this.set(c[0],c[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,Rb=s,Rb}var Lb,xE;function BI(){if(xE)return Lb;xE=1;var r=II(),e="Expected a function";function n(i,a){if(typeof i!="function"||a!=null&&typeof a!="function")throw new TypeError(e);var s=function(){var o=arguments,l=a?a.apply(this,o):o[0],u=s.cache;if(u.has(l))return u.get(l);var c=i.apply(this,o);return s.cache=u.set(l,c)||u,c};return s.cache=new(n.Cache||r),s}return n.Cache=r,Lb=n,Lb}var Ob,bE;function zI(){if(bE)return Ob;bE=1;var r=BI(),e=500;function n(i){var a=r(i,function(o){return s.size===e&&s.clear(),o}),s=a.cache;return a}return Ob=n,Ob}var Db,wE;function nP(){if(wE)return Db;wE=1;var r=zI(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,i=r(function(a){var s=[];return a.charCodeAt(0)===46&&s.push(""),a.replace(e,function(o,l,u,c){s.push(u?c.replace(n,"$1"):l||o)}),s});return Db=i,Db}var Ib,_E;function iP(){if(_E)return Ib;_E=1;function r(e,n){for(var i=-1,a=e==null?0:e.length,s=Array(a);++i<a;)s[i]=n(e[i],i,e);return s}return Ib=r,Ib}var Bb,SE;function FI(){if(SE)return Bb;SE=1;var r=M_(),e=iP(),n=yx(),i=cv(),a=r?r.prototype:void 0,s=a?a.toString:void 0;function o(l){if(typeof l=="string")return l;if(n(l))return e(l,o)+"";if(i(l))return s?s.call(l):"";var u=l+"";return u=="0"&&1/l==-1/0?"-0":u}return Bb=o,Bb}var zb,kE;function aP(){if(kE)return zb;kE=1;var r=FI();function e(n){return n==null?"":r(n)}return zb=e,zb}var Fb,CE;function sP(){if(CE)return Fb;CE=1;var r=yx(),e=dI(),n=nP(),i=aP();function a(s,o){return r(s)?s:e(s,o)?[s]:n(i(s))}return Fb=a,Fb}var Vb,EE;function F_(){if(EE)return Vb;EE=1;var r=cv();function e(n){if(typeof n=="string"||r(n))return n;var i=n+"";return i=="0"&&1/n==-1/0?"-0":i}return Vb=e,Vb}var Ub,NE;function VI(){if(NE)return Ub;NE=1;var r=sP(),e=F_();function n(i,a){a=r(a,i);for(var s=0,o=a.length;i!=null&&s<o;)i=i[e(a[s++])];return s&&s==o?i:void 0}return Ub=n,Ub}var Hb,TE;function UI(){if(TE)return Hb;TE=1;var r=VI();function e(n,i,a){var s=n==null?void 0:r(n,i);return s===void 0?a:s}return Hb=e,Hb}var HI=UI(),GI=lv(HI),Gb,PE;function qI(){if(PE)return Gb;PE=1;var r=z_(),e=(function(){try{var n=r(Object,"defineProperty");return n({},"",{}),n}catch{}})();return Gb=e,Gb}var qb,ME;function WI(){if(ME)return qb;ME=1;var r=qI();function e(n,i,a){i=="__proto__"&&r?r(n,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):n[i]=a}return qb=e,qb}var Wb,AE;function $I(){if(AE)return Wb;AE=1;var r=WI(),e=rP(),n=Object.prototype,i=n.hasOwnProperty;function a(s,o,l){var u=s[o];(!(i.call(s,o)&&e(u,l))||l===void 0&&!(o in s))&&r(s,o,l)}return Wb=a,Wb}var $b,jE;function KI(){if(jE)return $b;jE=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function n(i,a){var s=typeof i;return a=a??r,!!a&&(s=="number"||s!="symbol"&&e.test(i))&&i>-1&&i%1==0&&i<a}return $b=n,$b}var Kb,RE;function ZI(){if(RE)return Kb;RE=1;var r=$I(),e=sP(),n=KI(),i=uv(),a=F_();function s(o,l,u,c){if(!i(o))return o;l=e(l,o);for(var d=-1,p=l.length,v=p-1,y=o;y!=null&&++d<p;){var b=a(l[d]),S=u;if(b==="__proto__"||b==="constructor"||b==="prototype")return o;if(d!=v){var k=y[b];S=c?c(k,b,y):void 0,S===void 0&&(S=i(k)?k:n(l[d+1])?[]:{})}r(y,b,S),y=y[b]}return o}return Kb=s,Kb}var Zb,LE;function YI(){if(LE)return Zb;LE=1;var r=ZI();function e(n,i,a){return n==null?n:r(n,i,a)}return Zb=e,Zb}var XI=YI(),QI=lv(XI),Yb,OE;function JI(){if(OE)return Yb;OE=1;function r(e,n){var i=-1,a=e.length;for(n||(n=Array(a));++i<a;)n[i]=e[i];return n}return Yb=r,Yb}var Xb,DE;function e9(){if(DE)return Xb;DE=1;var r=iP(),e=JI(),n=yx(),i=cv(),a=nP(),s=F_(),o=aP();function l(u){return n(u)?r(u,s):i(u)?[u]:e(a(o(u)))}return Xb=l,Xb}var t9=e9(),r9=lv(t9),n9={data:function(e){var n={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(a){},beforeSet:function(a,s){},onSet:function(a){},canSet:function(a){return!0}};return e=Ht({},n,e),function(a,s){var o=e,l=this,u=l.length!==void 0,c=u?l:[l],d=u?l[0]:l;if(Dt(a)){var p=a.indexOf(".")!==-1,v=p&&r9(a);if(o.allowGetting&&s===void 0){var y;return d&&(o.beforeGet(d),v&&d._private[o.field][a]===void 0?y=GI(d._private[o.field],v):y=d._private[o.field][a]),y}else if(o.allowSetting&&s!==void 0){var b=!o.immutableKeys[a];if(b){var S=w4({},a,s);o.beforeSet(l,S);for(var k=0,T=c.length;k<T;k++){var C=c[k];o.canSet(C)&&(v&&d._private[o.field][a]===void 0?QI(C._private[o.field],v,s):C._private[o.field][a]=s)}o.updateStyle&&l.updateStyle(),o.onSet(l),o.settingTriggersEvent&&l[o.triggerFnName](o.settingEvent)}}}else if(o.allowSetting&&Sr(a)){var N=a,P,R,O=Object.keys(N);o.beforeSet(l,N);for(var B=0;B<O.length;B++){P=O[B],R=N[P];var I=!o.immutableKeys[P];if(I)for(var z=0;z<c.length;z++){var V=c[z];o.canSet(V)&&(V._private[o.field][P]=R)}}o.updateStyle&&l.updateStyle(),o.onSet(l),o.settingTriggersEvent&&l[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&zn(a)){var $=a;l.on(o.bindingEvent,$)}else if(o.allowGetting&&a===void 0){var Y;return d&&(o.beforeGet(d),Y=d._private[o.field]),Y}return l}},removeData:function(e){var n={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Ht({},n,e),function(a){var s=e,o=this,l=o.length!==void 0,u=l?o:[o];if(Dt(a)){for(var c=a.split(/\s+/),d=c.length,p=0;p<d;p++){var v=c[p];if(!bd(v)){var y=!s.immutableKeys[v];if(y)for(var b=0,S=u.length;b<S;b++)u[b]._private[s.field][v]=void 0}}s.triggerEvent&&o[s.triggerFnName](s.event)}else if(a===void 0){for(var k=0,T=u.length;k<T;k++)for(var C=u[k]._private[s.field],N=Object.keys(C),P=0;P<N.length;P++){var R=N[P],O=!s.immutableKeys[R];O&&(C[R]=void 0)}s.triggerEvent&&o[s.triggerFnName](s.event)}return o}}},i9={eventAliasesOn:function(e){var n=e;n.addListener=n.listen=n.bind=n.on,n.unlisten=n.unbind=n.off=n.removeListener,n.trigger=n.emit,n.pon=n.promiseOn=function(i,a){var s=this,o=Array.prototype.slice.call(arguments,0);return new Pp(function(l,u){var c=function(y){s.off.apply(s,p),l(y)},d=o.concat([c]),p=d.concat([]);s.on.apply(s,d)})}}},Br={};[cI,n9,i9].forEach(function(r){Ht(Br,r)});var a9={animate:Br.animate(),animation:Br.animation(),animated:Br.animated(),clearQueue:Br.clearQueue(),delay:Br.delay(),delayAnimation:Br.delayAnimation(),stop:Br.stop()},F0={classes:function(e){var n=this;if(e===void 0){var i=[];return n[0]._private.classes.forEach(function(b){return i.push(b)}),i}else rn(e)||(e=(e||"").match(/\S+/g)||[]);for(var a=[],s=new Tp(e),o=0;o<n.length;o++){for(var l=n[o],u=l._private,c=u.classes,d=!1,p=0;p<e.length;p++){var v=e[p],y=c.has(v);if(!y){d=!0;break}}d||(d=c.size!==e.length),d&&(u.classes=s,a.push(l))}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var n=this[0];return n!=null&&n._private.classes.has(e)},toggleClass:function(e,n){rn(e)||(e=e.match(/\S+/g)||[]);for(var i=this,a=n===void 0,s=[],o=0,l=i.length;o<l;o++)for(var u=i[o],c=u._private.classes,d=!1,p=0;p<e.length;p++){var v=e[p],y=c.has(v),b=!1;n||a&&!y?(c.add(v),b=!0):(!n||a&&y)&&(c.delete(v),b=!0),!d&&b&&(s.push(u),d=!0)}return s.length>0&&this.spawn(s).updateStyle().emit("class"),i},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,n){var i=this;if(n==null)n=250;else if(n===0)return i;return i.addClass(e),setTimeout(function(){i.removeClass(e)},n),i}};F0.className=F0.classNames=F0.classes;var _r={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Mi,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};_r.variable="(?:[\\w-.]|(?:\\\\"+_r.metaChar+"))+";_r.className="(?:[\\w-]|(?:\\\\"+_r.metaChar+"))+";_r.value=_r.string+"|"+_r.number;_r.id=_r.variable;(function(){var r,e,n;for(r=_r.comparatorOp.split("|"),n=0;n<r.length;n++)e=r[n],_r.comparatorOp+="|@"+e;for(r=_r.comparatorOp.split("|"),n=0;n<r.length;n++)e=r[n],!(e.indexOf("!")>=0)&&e!=="="&&(_r.comparatorOp+="|\\!"+e)})();var Xr=function(){return{checks:[]}},Tt={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},k2=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(r,e){return nO(r.selector,e.selector)}),s9=(function(){for(var r={},e,n=0;n<k2.length;n++)e=k2[n],r[e.selector]=e.matches;return r})(),o9=function(e,n){return s9[e](n)},l9="("+k2.map(function(r){return r.selector}).join("|")+")",Lf=function(e){return e.replace(new RegExp("\\\\("+_r.metaChar+")","g"),function(n,i){return i})},$c=function(e,n,i){e[e.length-1]=i},C2=[{name:"group",query:!0,regex:"("+_r.group+")",populate:function(e,n,i){var a=xi(i,1),s=a[0];n.checks.push({type:Tt.GROUP,value:s==="*"?s:s+"s"})}},{name:"state",query:!0,regex:l9,populate:function(e,n,i){var a=xi(i,1),s=a[0];n.checks.push({type:Tt.STATE,value:s})}},{name:"id",query:!0,regex:"\\#("+_r.id+")",populate:function(e,n,i){var a=xi(i,1),s=a[0];n.checks.push({type:Tt.ID,value:Lf(s)})}},{name:"className",query:!0,regex:"\\.("+_r.className+")",populate:function(e,n,i){var a=xi(i,1),s=a[0];n.checks.push({type:Tt.CLASS,value:Lf(s)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+_r.variable+")\\s*\\]",populate:function(e,n,i){var a=xi(i,1),s=a[0];n.checks.push({type:Tt.DATA_EXIST,field:Lf(s)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+_r.variable+")\\s*("+_r.comparatorOp+")\\s*("+_r.value+")\\s*\\]",populate:function(e,n,i){var a=xi(i,3),s=a[0],o=a[1],l=a[2],u=new RegExp("^"+_r.string+"$").exec(l)!=null;u?l=l.substring(1,l.length-1):l=parseFloat(l),n.checks.push({type:Tt.DATA_COMPARE,field:Lf(s),operator:o,value:l})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+_r.boolOp+")\\s*("+_r.variable+")\\s*\\]",populate:function(e,n,i){var a=xi(i,2),s=a[0],o=a[1];n.checks.push({type:Tt.DATA_BOOL,field:Lf(o),operator:s})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+_r.meta+")\\s*("+_r.comparatorOp+")\\s*("+_r.number+")\\s*\\]\\]",populate:function(e,n,i){var a=xi(i,3),s=a[0],o=a[1],l=a[2];n.checks.push({type:Tt.META_COMPARE,field:Lf(s),operator:o,value:parseFloat(l)})}},{name:"nextQuery",separator:!0,regex:_r.separator,populate:function(e,n){var i=e.currentSubject,a=e.edgeCount,s=e.compoundCount,o=e[e.length-1];i!=null&&(o.subject=i,e.currentSubject=null),o.edgeCount=a,o.compoundCount=s,e.edgeCount=0,e.compoundCount=0;var l=e[e.length++]=Xr();return l}},{name:"directedEdge",separator:!0,regex:_r.directedEdge,populate:function(e,n){if(e.currentSubject==null){var i=Xr(),a=n,s=Xr();return i.checks.push({type:Tt.DIRECTED_EDGE,source:a,target:s}),$c(e,n,i),e.edgeCount++,s}else{var o=Xr(),l=n,u=Xr();return o.checks.push({type:Tt.NODE_SOURCE,source:l,target:u}),$c(e,n,o),e.edgeCount++,u}}},{name:"undirectedEdge",separator:!0,regex:_r.undirectedEdge,populate:function(e,n){if(e.currentSubject==null){var i=Xr(),a=n,s=Xr();return i.checks.push({type:Tt.UNDIRECTED_EDGE,nodes:[a,s]}),$c(e,n,i),e.edgeCount++,s}else{var o=Xr(),l=n,u=Xr();return o.checks.push({type:Tt.NODE_NEIGHBOR,node:l,neighbor:u}),$c(e,n,o),u}}},{name:"child",separator:!0,regex:_r.child,populate:function(e,n){if(e.currentSubject==null){var i=Xr(),a=Xr(),s=e[e.length-1];return i.checks.push({type:Tt.CHILD,parent:s,child:a}),$c(e,n,i),e.compoundCount++,a}else if(e.currentSubject===n){var o=Xr(),l=e[e.length-1],u=Xr(),c=Xr(),d=Xr(),p=Xr();return o.checks.push({type:Tt.COMPOUND_SPLIT,left:l,right:u,subject:c}),c.checks=n.checks,n.checks=[{type:Tt.TRUE}],p.checks.push({type:Tt.TRUE}),u.checks.push({type:Tt.PARENT,parent:p,child:d}),$c(e,l,o),e.currentSubject=c,e.compoundCount++,d}else{var v=Xr(),y=Xr(),b=[{type:Tt.PARENT,parent:v,child:y}];return v.checks=n.checks,n.checks=b,e.compoundCount++,y}}},{name:"descendant",separator:!0,regex:_r.descendant,populate:function(e,n){if(e.currentSubject==null){var i=Xr(),a=Xr(),s=e[e.length-1];return i.checks.push({type:Tt.DESCENDANT,ancestor:s,descendant:a}),$c(e,n,i),e.compoundCount++,a}else if(e.currentSubject===n){var o=Xr(),l=e[e.length-1],u=Xr(),c=Xr(),d=Xr(),p=Xr();return o.checks.push({type:Tt.COMPOUND_SPLIT,left:l,right:u,subject:c}),c.checks=n.checks,n.checks=[{type:Tt.TRUE}],p.checks.push({type:Tt.TRUE}),u.checks.push({type:Tt.ANCESTOR,ancestor:p,descendant:d}),$c(e,l,o),e.currentSubject=c,e.compoundCount++,d}else{var v=Xr(),y=Xr(),b=[{type:Tt.ANCESTOR,ancestor:v,descendant:y}];return v.checks=n.checks,n.checks=b,e.compoundCount++,y}}},{name:"subject",modifier:!0,regex:_r.subject,populate:function(e,n){if(e.currentSubject!=null&&e.currentSubject!==n)return zr("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=n;var i=e[e.length-1],a=i.checks[0],s=a==null?null:a.type;s===Tt.DIRECTED_EDGE?a.type=Tt.NODE_TARGET:s===Tt.UNDIRECTED_EDGE&&(a.type=Tt.NODE_NEIGHBOR,a.node=a.nodes[1],a.neighbor=a.nodes[0],a.nodes=null)}}];C2.forEach(function(r){return r.regexObj=new RegExp("^"+r.regex)});var u9=function(e){for(var n,i,a,s=0;s<C2.length;s++){var o=C2[s],l=o.name,u=e.match(o.regexObj);if(u!=null){i=u,n=o,a=l;var c=u[0];e=e.substring(c.length);break}}return{expr:n,match:i,name:a,remaining:e}},c9=function(e){var n=e.match(/^\s+/);if(n){var i=n[0];e=e.substring(i.length)}return e},d9=function(e){var n=this,i=n.inputText=e,a=n[0]=Xr();for(n.length=1,i=c9(i);;){var s=u9(i);if(s.expr==null)return zr("The selector `"+e+"`is invalid"),!1;var o=s.match.slice(1),l=s.expr.populate(n,a,o);if(l===!1)return!1;if(l!=null&&(a=l),i=s.remaining,i.match(/^\s*$/))break}var u=n[n.length-1];n.currentSubject!=null&&(u.subject=n.currentSubject),u.edgeCount=n.edgeCount,u.compoundCount=n.compoundCount;for(var c=0;c<n.length;c++){var d=n[c];if(d.compoundCount>0&&d.edgeCount>0)return zr("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(d.edgeCount>1)return zr("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;d.edgeCount===1&&zr("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},h9=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(d){return d??""},n=function(d){return Dt(d)?'"'+d+'"':e(d)},i=function(d){return" "+d+" "},a=function(d,p){var v=d.type,y=d.value;switch(v){case Tt.GROUP:{var b=e(y);return b.substring(0,b.length-1)}case Tt.DATA_COMPARE:{var S=d.field,k=d.operator;return"["+S+i(e(k))+n(y)+"]"}case Tt.DATA_BOOL:{var T=d.operator,C=d.field;return"["+e(T)+C+"]"}case Tt.DATA_EXIST:{var N=d.field;return"["+N+"]"}case Tt.META_COMPARE:{var P=d.operator,R=d.field;return"[["+R+i(e(P))+n(y)+"]]"}case Tt.STATE:return y;case Tt.ID:return"#"+y;case Tt.CLASS:return"."+y;case Tt.PARENT:case Tt.CHILD:return s(d.parent,p)+i(">")+s(d.child,p);case Tt.ANCESTOR:case Tt.DESCENDANT:return s(d.ancestor,p)+" "+s(d.descendant,p);case Tt.COMPOUND_SPLIT:{var O=s(d.left,p),B=s(d.subject,p),I=s(d.right,p);return O+(O.length>0?" ":"")+B+I}case Tt.TRUE:return""}},s=function(d,p){return d.checks.reduce(function(v,y,b){return v+(p===d&&b===0?"$":"")+a(y,p)},"")},o="",l=0;l<this.length;l++){var u=this[l];o+=s(u,u.subject),this.length>1&&l<this.length-1&&(o+=", ")}return this.toStringCache=o,o},f9={parse:d9,toString:h9},oP=function(e,n,i){var a,s=Dt(e),o=ht(e),l=Dt(i),u,c,d=!1,p=!1,v=!1;switch(n.indexOf("!")>=0&&(n=n.replace("!",""),p=!0),n.indexOf("@")>=0&&(n=n.replace("@",""),d=!0),(s||l||d)&&(u=!s&&!o?"":""+e,c=""+i),d&&(e=u=u.toLowerCase(),i=c=c.toLowerCase()),n){case"*=":a=u.indexOf(c)>=0;break;case"$=":a=u.indexOf(c,u.length-c.length)>=0;break;case"^=":a=u.indexOf(c)===0;break;case"=":a=e===i;break;case">":v=!0,a=e>i;break;case">=":v=!0,a=e>=i;break;case"<":v=!0,a=e<i;break;case"<=":v=!0,a=e<=i;break;default:a=!1;break}return p&&(e!=null||!v)&&(a=!a),a},p9=function(e,n){switch(n){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},m9=function(e){return e!==void 0},V_=function(e,n){return e.data(n)},g9=function(e,n){return e[n]()},Zn=[],xn=function(e,n){return e.checks.every(function(i){return Zn[i.type](i,n)})};Zn[Tt.GROUP]=function(r,e){var n=r.value;return n==="*"||n===e.group()};Zn[Tt.STATE]=function(r,e){var n=r.value;return o9(n,e)};Zn[Tt.ID]=function(r,e){var n=r.value;return e.id()===n};Zn[Tt.CLASS]=function(r,e){var n=r.value;return e.hasClass(n)};Zn[Tt.META_COMPARE]=function(r,e){var n=r.field,i=r.operator,a=r.value;return oP(g9(e,n),i,a)};Zn[Tt.DATA_COMPARE]=function(r,e){var n=r.field,i=r.operator,a=r.value;return oP(V_(e,n),i,a)};Zn[Tt.DATA_BOOL]=function(r,e){var n=r.field,i=r.operator;return p9(V_(e,n),i)};Zn[Tt.DATA_EXIST]=function(r,e){var n=r.field;return r.operator,m9(V_(e,n))};Zn[Tt.UNDIRECTED_EDGE]=function(r,e){var n=r.nodes[0],i=r.nodes[1],a=e.source(),s=e.target();return xn(n,a)&&xn(i,s)||xn(i,a)&&xn(n,s)};Zn[Tt.NODE_NEIGHBOR]=function(r,e){return xn(r.node,e)&&e.neighborhood().some(function(n){return n.isNode()&&xn(r.neighbor,n)})};Zn[Tt.DIRECTED_EDGE]=function(r,e){return xn(r.source,e.source())&&xn(r.target,e.target())};Zn[Tt.NODE_SOURCE]=function(r,e){return xn(r.source,e)&&e.outgoers().some(function(n){return n.isNode()&&xn(r.target,n)})};Zn[Tt.NODE_TARGET]=function(r,e){return xn(r.target,e)&&e.incomers().some(function(n){return n.isNode()&&xn(r.source,n)})};Zn[Tt.CHILD]=function(r,e){return xn(r.child,e)&&xn(r.parent,e.parent())};Zn[Tt.PARENT]=function(r,e){return xn(r.parent,e)&&e.children().some(function(n){return xn(r.child,n)})};Zn[Tt.DESCENDANT]=function(r,e){return xn(r.descendant,e)&&e.ancestors().some(function(n){return xn(r.ancestor,n)})};Zn[Tt.ANCESTOR]=function(r,e){return xn(r.ancestor,e)&&e.descendants().some(function(n){return xn(r.descendant,n)})};Zn[Tt.COMPOUND_SPLIT]=function(r,e){return xn(r.subject,e)&&xn(r.left,e)&&xn(r.right,e)};Zn[Tt.TRUE]=function(){return!0};Zn[Tt.COLLECTION]=function(r,e){var n=r.value;return n.has(e)};Zn[Tt.FILTER]=function(r,e){var n=r.value;return n(e)};var v9=function(e){var n=this;if(n.length===1&&n[0].checks.length===1&&n[0].checks[0].type===Tt.ID)return e.getElementById(n[0].checks[0].value).collection();var i=function(s){for(var o=0;o<n.length;o++){var l=n[o];if(xn(l,s))return!0}return!1};return n.text()==null&&(i=function(){return!0}),e.filter(i)},y9=function(e){for(var n=this,i=0;i<n.length;i++){var a=n[i];if(xn(a,e))return!0}return!1},x9={matches:y9,filter:v9},Sd=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||Dt(e)&&e.match(/^\s*$/)||(Xs(e)?this.addQuery({checks:[{type:Tt.COLLECTION,value:e.collection()}]}):zn(e)?this.addQuery({checks:[{type:Tt.FILTER,value:e}]}):Dt(e)?this.parse(e)||(this.invalid=!0):Rn("A selector must be created from a string; found "))},kd=Sd.prototype;[f9,x9].forEach(function(r){return Ht(kd,r)});kd.text=function(){return this.inputText};kd.size=function(){return this.length};kd.eq=function(r){return this[r]};kd.sameText=function(r){return!this.invalid&&!r.invalid&&this.text()===r.text()};kd.addQuery=function(r){this[this.length++]=r};kd.selector=kd.toString;var fd={allAre:function(e){var n=new Sd(e);return this.every(function(i){return n.matches(i)})},is:function(e){var n=new Sd(e);return this.some(function(i){return n.matches(i)})},some:function(e,n){for(var i=0;i<this.length;i++){var a=n?e.apply(n,[this[i],i,this]):e(this[i],i,this);if(a)return!0}return!1},every:function(e,n){for(var i=0;i<this.length;i++){var a=n?e.apply(n,[this[i],i,this]):e(this[i],i,this);if(!a)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var n=this.length,i=e.length;return n!==i?!1:n===1?this[0]===e[0]:this.every(function(a){return e.hasElementWithId(a.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(n){return e.hasElementWithId(n.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var n=this.neighborhood();return e.every(function(i){return n.hasElementWithId(i.id())})},contains:function(e){e=this.cy().collection(e);var n=this;return e.every(function(i){return n.hasElementWithId(i.id())})}};fd.allAreNeighbours=fd.allAreNeighbors;fd.has=fd.contains;fd.equal=fd.equals=fd.same;var To=function(e,n){return function(a,s,o,l){var u=a,c=this,d;if(u==null?d="":Xs(u)&&u.length===1&&(d=u.id()),c.length===1&&d){var p=c[0]._private,v=p.traversalCache=p.traversalCache||{},y=v[n]=v[n]||[],b=Dh(d),S=y[b];return S||(y[b]=e.call(c,a,s,o,l))}else return e.call(c,a,s,o,l)}},fp={parent:function(e){var n=[];if(this.length===1){var i=this[0]._private.parent;if(i)return i}for(var a=0;a<this.length;a++){var s=this[a],o=s._private.parent;o&&n.push(o)}return this.spawn(n,!0).filter(e)},parents:function(e){for(var n=[],i=this.parent();i.nonempty();){for(var a=0;a<i.length;a++){var s=i[a];n.push(s)}i=i.parent()}return this.spawn(n,!0).filter(e)},commonAncestors:function(e){for(var n,i=0;i<this.length;i++){var a=this[i],s=a.parents();n=n||s,n=n.intersect(s)}return n.filter(e)},orphans:function(e){return this.stdFilter(function(n){return n.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(n){return n.isChild()}).filter(e)},children:To(function(r){for(var e=[],n=0;n<this.length;n++)for(var i=this[n],a=i._private.children,s=0;s<a.length;s++)e.push(a[s]);return this.spawn(e,!0).filter(r)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var n=[];function i(a){for(var s=0;s<a.length;s++){var o=a[s];n.push(o),o.children().nonempty()&&i(o.children())}}return i(this.children()),this.spawn(n,!0).filter(e)}};function U_(r,e,n,i){for(var a=[],s=new Tp,o=r.cy(),l=o.hasCompoundNodes(),u=0;u<r.length;u++){var c=r[u];n?a.push(c):l&&i(a,s,c)}for(;a.length>0;){var d=a.shift();e(d),s.add(d.id()),l&&i(a,s,d)}return r}function lP(r,e,n){if(n.isParent())for(var i=n._private.children,a=0;a<i.length;a++){var s=i[a];e.has(s.id())||r.push(s)}}fp.forEachDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return U_(this,r,e,lP)};function uP(r,e,n){if(n.isChild()){var i=n._private.parent;e.has(i.id())||r.push(i)}}fp.forEachUp=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return U_(this,r,e,uP)};function b9(r,e,n){uP(r,e,n),lP(r,e,n)}fp.forEachUpAndDown=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return U_(this,r,e,b9)};fp.ancestors=fp.parents;var zg,cP;zg=cP={data:Br.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Br.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Br.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Br.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Br.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Br.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};zg.attr=zg.data;zg.removeAttr=zg.removeData;var w9=cP,_x={};function Qb(r){return function(e){var n=this;if(e===void 0&&(e=!0),n.length!==0)if(n.isNode()&&!n.removed()){for(var i=0,a=n[0],s=a._private.edges,o=0;o<s.length;o++){var l=s[o];!e&&l.isLoop()||(i+=r(a,l))}return i}else return}}Ht(_x,{degree:Qb(function(r,e){return e.source().same(e.target())?2:1}),indegree:Qb(function(r,e){return e.target().same(r)?1:0}),outdegree:Qb(function(r,e){return e.source().same(r)?1:0})});function Of(r,e){return function(n){for(var i,a=this.nodes(),s=0;s<a.length;s++){var o=a[s],l=o[r](n);l!==void 0&&(i===void 0||e(l,i))&&(i=l)}return i}}Ht(_x,{minDegree:Of("degree",function(r,e){return r<e}),maxDegree:Of("degree",function(r,e){return r>e}),minIndegree:Of("indegree",function(r,e){return r<e}),maxIndegree:Of("indegree",function(r,e){return r>e}),minOutdegree:Of("outdegree",function(r,e){return r<e}),maxOutdegree:Of("outdegree",function(r,e){return r>e})});Ht(_x,{totalDegree:function(e){for(var n=0,i=this.nodes(),a=0;a<i.length;a++)n+=i[a].degree(e);return n}});var hl,dP,hP=function(e,n,i){for(var a=0;a<e.length;a++){var s=e[a];if(!s.locked()){var o=s._private.position,l={x:n.x!=null?n.x-o.x:0,y:n.y!=null?n.y-o.y:0};s.isParent()&&!(l.x===0&&l.y===0)&&s.children().shift(l,i),s.dirtyBoundingBoxCache()}}},IE={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,n){hP(e,n,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};hl=dP={position:Br.data(IE),silentPosition:Br.data(Ht({},IE,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,n){hP(e,n,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,n){if(Sr(e))n?this.silentPosition(e):this.position(e);else if(zn(e)){var i=e,a=this.cy();a.startBatch();for(var s=0;s<this.length;s++){var o=this[s],l=void 0;(l=i(o,s))&&(n?o.silentPosition(l):o.position(l))}a.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,n,i){var a;if(Sr(e)?(a={x:ht(e.x)?e.x:0,y:ht(e.y)?e.y:0},i=n):Dt(e)&&ht(n)&&(a={x:0,y:0},a[e]=n),a!=null){var s=this.cy();s.startBatch();for(var o=0;o<this.length;o++){var l=this[o];if(!(s.hasCompoundNodes()&&l.isChild()&&l.ancestors().anySame(this))){var u=l.position(),c={x:u.x+a.x,y:u.y+a.y};i?l.silentPosition(c):l.position(c)}}s.endBatch()}return this},silentShift:function(e,n){return Sr(e)?this.shift(e,!0):Dt(e)&&ht(n)&&this.shift(e,n,!0),this},renderedPosition:function(e,n){var i=this[0],a=this.cy(),s=a.zoom(),o=a.pan(),l=Sr(e)?e:void 0,u=l!==void 0||n!==void 0&&Dt(e);if(i&&i.isNode())if(u)for(var c=0;c<this.length;c++){var d=this[c];n!==void 0?d.position(e,(n-o[e])/s):l!==void 0&&d.position(F4(l,s,o))}else{var p=i.position();return l=gx(p,s,o),e===void 0?l:l[e]}else if(!u)return;return this},relativePosition:function(e,n){var i=this[0],a=this.cy(),s=Sr(e)?e:void 0,o=s!==void 0||n!==void 0&&Dt(e),l=a.hasCompoundNodes();if(i&&i.isNode())if(o)for(var u=0;u<this.length;u++){var c=this[u],d=l?c.parent():null,p=d&&d.length>0,v=p;p&&(d=d[0]);var y=v?d.position():{x:0,y:0};n!==void 0?c.position(e,n+y[e]):s!==void 0&&c.position({x:s.x+y.x,y:s.y+y.y})}else{var b=i.position(),S=l?i.parent():null,k=S&&S.length>0,T=k;k&&(S=S[0]);var C=T?S.position():{x:0,y:0};return s={x:b.x-C.x,y:b.y-C.y},e===void 0?s:s[e]}else if(!o)return;return this}};hl.modelPosition=hl.point=hl.position;hl.modelPositions=hl.points=hl.positions;hl.renderedPoint=hl.renderedPosition;hl.relativePoint=hl.relativePosition;var _9=dP,op,Ad;op=Ad={};Ad.renderedBoundingBox=function(r){var e=this.boundingBox(r),n=this.cy(),i=n.zoom(),a=n.pan(),s=e.x1*i+a.x,o=e.x2*i+a.x,l=e.y1*i+a.y,u=e.y2*i+a.y;return{x1:s,x2:o,y1:l,y2:u,w:o-s,h:u-l}};Ad.dirtyCompoundBoundsCache=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(n){if(n.isParent()){var i=n._private;i.compoundBoundsClean=!1,i.bbCache=null,r||n.emitAndNotify("bounds")}}),this)};Ad.updateCompoundBounds=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!r&&e.batching())return this;function n(o){if(!o.isParent())return;var l=o._private,u=o.children(),c=o.pstyle("compound-sizing-wrt-labels").value==="include",d={width:{val:o.pstyle("min-width").pfValue,left:o.pstyle("min-width-bias-left"),right:o.pstyle("min-width-bias-right")},height:{val:o.pstyle("min-height").pfValue,top:o.pstyle("min-height-bias-top"),bottom:o.pstyle("min-height-bias-bottom")}},p=u.boundingBox({includeLabels:c,includeOverlays:!1,useCache:!1}),v=l.position;(p.w===0||p.h===0)&&(p={w:o.pstyle("width").pfValue,h:o.pstyle("height").pfValue},p.x1=v.x-p.w/2,p.x2=v.x+p.w/2,p.y1=v.y-p.h/2,p.y2=v.y+p.h/2);function y(z,V,$){var Y=0,D=0,q=V+$;return z>0&&q>0&&(Y=V/q*z,D=$/q*z),{biasDiff:Y,biasComplementDiff:D}}function b(z,V,$,Y){if($.units==="%")switch(Y){case"width":return z>0?$.pfValue*z:0;case"height":return V>0?$.pfValue*V:0;case"average":return z>0&&V>0?$.pfValue*(z+V)/2:0;case"min":return z>0&&V>0?z>V?$.pfValue*V:$.pfValue*z:0;case"max":return z>0&&V>0?z>V?$.pfValue*z:$.pfValue*V:0;default:return 0}else return $.units==="px"?$.pfValue:0}var S=d.width.left.value;d.width.left.units==="px"&&d.width.val>0&&(S=S*100/d.width.val);var k=d.width.right.value;d.width.right.units==="px"&&d.width.val>0&&(k=k*100/d.width.val);var T=d.height.top.value;d.height.top.units==="px"&&d.height.val>0&&(T=T*100/d.height.val);var C=d.height.bottom.value;d.height.bottom.units==="px"&&d.height.val>0&&(C=C*100/d.height.val);var N=y(d.width.val-p.w,S,k),P=N.biasDiff,R=N.biasComplementDiff,O=y(d.height.val-p.h,T,C),B=O.biasDiff,I=O.biasComplementDiff;l.autoPadding=b(p.w,p.h,o.pstyle("padding"),o.pstyle("padding-relative-to").value),l.autoWidth=Math.max(p.w,d.width.val),v.x=(-P+p.x1+p.x2+R)/2,l.autoHeight=Math.max(p.h,d.height.val),v.y=(-B+p.y1+p.y2+I)/2}for(var i=0;i<this.length;i++){var a=this[i],s=a._private;(!s.compoundBoundsClean||r)&&(n(a),e.batching()||(s.compoundBoundsClean=!0))}return this};var Eo=function(e){return e===1/0||e===-1/0?0:e},ll=function(e,n,i,a,s){a-n===0||s-i===0||n==null||i==null||a==null||s==null||(e.x1=n<e.x1?n:e.x1,e.x2=a>e.x2?a:e.x2,e.y1=i<e.y1?i:e.y1,e.y2=s>e.y2?s:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},Qc=function(e,n){return n==null?e:ll(e,n.x1,n.y1,n.x2,n.y2)},sm=function(e,n,i){return Ps(e,n,i)},u0=function(e,n,i){if(!n.cy().headless()){var a=n._private,s=a.rstyle,o=s.arrowWidth/2,l=n.pstyle(i+"-arrow-shape").value,u,c;if(l!=="none"){i==="source"?(u=s.srcX,c=s.srcY):i==="target"?(u=s.tgtX,c=s.tgtY):(u=s.midX,c=s.midY);var d=a.arrowBounds=a.arrowBounds||{},p=d[i]=d[i]||{};p.x1=u-o,p.y1=c-o,p.x2=u+o,p.y2=c+o,p.w=p.x2-p.x1,p.h=p.y2-p.y1,B0(p,1),ll(e,p.x1,p.y1,p.x2,p.y2)}}},Jb=function(e,n,i){if(!n.cy().headless()){var a;i?a=i+"-":a="";var s=n._private,o=s.rstyle,l=n.pstyle(a+"label").strValue;if(l){var u=n.pstyle("text-halign"),c=n.pstyle("text-valign"),d=sm(o,"labelWidth",i),p=sm(o,"labelHeight",i),v=sm(o,"labelX",i),y=sm(o,"labelY",i),b=n.pstyle(a+"text-margin-x").pfValue,S=n.pstyle(a+"text-margin-y").pfValue,k=n.isEdge(),T=n.pstyle(a+"text-rotation"),C=n.pstyle("text-outline-width").pfValue,N=n.pstyle("text-border-width").pfValue,P=N/2,R=n.pstyle("text-background-padding").pfValue,O=2,B=p,I=d,z=I/2,V=B/2,$,Y,D,q;if(k)$=v-z,Y=v+z,D=y-V,q=y+V;else{switch(u.value){case"left":$=v-I,Y=v;break;case"center":$=v-z,Y=v+z;break;case"right":$=v,Y=v+I;break}switch(c.value){case"top":D=y-B,q=y;break;case"center":D=y-V,q=y+V;break;case"bottom":D=y,q=y+B;break}}var G=b-Math.max(C,P)-R-O,Z=b+Math.max(C,P)+R+O,Q=S-Math.max(C,P)-R-O,J=S+Math.max(C,P)+R+O;$+=G,Y+=Z,D+=Q,q+=J;var ie=i||"main",ne=s.labelBounds,W=ne[ie]=ne[ie]||{};W.x1=$,W.y1=D,W.x2=Y,W.y2=q,W.w=Y-$,W.h=q-D,W.leftPad=G,W.rightPad=Z,W.topPad=Q,W.botPad=J;var re=k&&T.strValue==="autorotate",ae=T.pfValue!=null&&T.pfValue!==0;if(re||ae){var he=re?sm(s.rstyle,"labelAngle",i):T.pfValue,ve=Math.cos(he),xe=Math.sin(he),se=($+Y)/2,ge=(D+q)/2;if(!k){switch(u.value){case"left":se=Y;break;case"right":se=$;break}switch(c.value){case"top":ge=q;break;case"bottom":ge=D;break}}var le=function(Je,at){return Je=Je-se,at=at-ge,{x:Je*ve-at*xe+se,y:Je*xe+at*ve+ge}},pe=le($,D),me=le($,q),be=le(Y,D),Se=le(Y,q);$=Math.min(pe.x,me.x,be.x,Se.x),Y=Math.max(pe.x,me.x,be.x,Se.x),D=Math.min(pe.y,me.y,be.y,Se.y),q=Math.max(pe.y,me.y,be.y,Se.y)}var Ue=ie+"Rot",We=ne[Ue]=ne[Ue]||{};We.x1=$,We.y1=D,We.x2=Y,We.y2=q,We.w=Y-$,We.h=q-D,ll(e,$,D,Y,q),ll(s.labelBounds.all,$,D,Y,q)}return e}},BE=function(e,n){if(!n.cy().headless()){var i=n.pstyle("outline-opacity").value,a=n.pstyle("outline-width").value,s=n.pstyle("outline-offset").value,o=a+s;fP(e,n,i,o,"outside",o/2)}},fP=function(e,n,i,a,s,o){if(!(i===0||a<=0||s==="inside")){var l=n.cy(),u=n.pstyle("shape").value,c=l.renderer().nodeShapes[u],d=n.position(),p=d.x,v=d.y,y=n.width(),b=n.height();if(c.hasMiterBounds){s==="center"&&(a/=2);var S=c.miterBounds(p,v,y,b,a);Qc(e,S)}else o!=null&&o>0&&z0(e,[o,o,o,o])}},S9=function(e,n){if(!n.cy().headless()){var i=n.pstyle("border-opacity").value,a=n.pstyle("border-width").pfValue,s=n.pstyle("border-position").value;fP(e,n,i,a,s)}},k9=function(e,n){var i=e._private.cy,a=i.styleEnabled(),s=i.headless(),o=cs(),l=e._private,u=e.isNode(),c=e.isEdge(),d,p,v,y,b,S,k=l.rstyle,T=u&&a?e.pstyle("bounds-expansion").pfValue:[0],C=function(gt){return gt.pstyle("display").value!=="none"},N=!a||C(e)&&(!c||C(e.source())&&C(e.target()));if(N){var P=0,R=0;a&&n.includeOverlays&&(P=e.pstyle("overlay-opacity").value,P!==0&&(R=e.pstyle("overlay-padding").value));var O=0,B=0;a&&n.includeUnderlays&&(O=e.pstyle("underlay-opacity").value,O!==0&&(B=e.pstyle("underlay-padding").value));var I=Math.max(R,B),z=0,V=0;if(a&&(z=e.pstyle("width").pfValue,V=z/2),u&&n.includeNodes){var $=e.position();b=$.x,S=$.y;var Y=e.outerWidth(),D=Y/2,q=e.outerHeight(),G=q/2;d=b-D,p=b+D,v=S-G,y=S+G,ll(o,d,v,p,y),a&&BE(o,e),a&&n.includeOutlines&&!s&&BE(o,e),a&&S9(o,e)}else if(c&&n.includeEdges)if(a&&!s){var Z=e.pstyle("curve-style").strValue;if(d=Math.min(k.srcX,k.midX,k.tgtX),p=Math.max(k.srcX,k.midX,k.tgtX),v=Math.min(k.srcY,k.midY,k.tgtY),y=Math.max(k.srcY,k.midY,k.tgtY),d-=V,p+=V,v-=V,y+=V,ll(o,d,v,p,y),Z==="haystack"){var Q=k.haystackPts;if(Q&&Q.length===2){if(d=Q[0].x,v=Q[0].y,p=Q[1].x,y=Q[1].y,d>p){var J=d;d=p,p=J}if(v>y){var ie=v;v=y,y=ie}ll(o,d-V,v-V,p+V,y+V)}}else if(Z==="bezier"||Z==="unbundled-bezier"||sd(Z,"segments")||sd(Z,"taxi")){var ne;switch(Z){case"bezier":case"unbundled-bezier":ne=k.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":ne=k.linePts;break}if(ne!=null)for(var W=0;W<ne.length;W++){var re=ne[W];d=re.x-V,p=re.x+V,v=re.y-V,y=re.y+V,ll(o,d,v,p,y)}}}else{var ae=e.source(),he=ae.position(),ve=e.target(),xe=ve.position();if(d=he.x,p=xe.x,v=he.y,y=xe.y,d>p){var se=d;d=p,p=se}if(v>y){var ge=v;v=y,y=ge}d-=V,p+=V,v-=V,y+=V,ll(o,d,v,p,y)}if(a&&n.includeEdges&&c&&(u0(o,e,"mid-source"),u0(o,e,"mid-target"),u0(o,e,"source"),u0(o,e,"target")),a){var le=e.pstyle("ghost").value==="yes";if(le){var pe=e.pstyle("ghost-offset-x").pfValue,me=e.pstyle("ghost-offset-y").pfValue;ll(o,o.x1+pe,o.y1+me,o.x2+pe,o.y2+me)}}var be=l.bodyBounds=l.bodyBounds||{};SC(be,o),z0(be,T),B0(be,1),a&&(d=o.x1,p=o.x2,v=o.y1,y=o.y2,ll(o,d-I,v-I,p+I,y+I));var Se=l.overlayBounds=l.overlayBounds||{};SC(Se,o),z0(Se,T),B0(Se,1);var Ue=l.labelBounds=l.labelBounds||{};Ue.all!=null?aD(Ue.all):Ue.all=cs(),a&&n.includeLabels&&(n.includeMainLabels&&Jb(o,e,null),c&&(n.includeSourceLabels&&Jb(o,e,"source"),n.includeTargetLabels&&Jb(o,e,"target")))}return o.x1=Eo(o.x1),o.y1=Eo(o.y1),o.x2=Eo(o.x2),o.y2=Eo(o.y2),o.w=Eo(o.x2-o.x1),o.h=Eo(o.y2-o.y1),o.w>0&&o.h>0&&N&&(z0(o,T),B0(o,1)),o},pP=function(e){var n=0,i=function(o){return(o?1:0)<<n++},a=0;return a+=i(e.incudeNodes),a+=i(e.includeEdges),a+=i(e.includeLabels),a+=i(e.includeMainLabels),a+=i(e.includeSourceLabels),a+=i(e.includeTargetLabels),a+=i(e.includeOverlays),a+=i(e.includeOutlines),a},mP=function(e){var n=function(l){return Math.round(l)};if(e.isEdge()){var i=e.source().position(),a=e.target().position();return vC([n(i.x),n(i.y),n(a.x),n(a.y)])}else{var s=e.position();return vC([n(s.x),n(s.y)])}},zE=function(e,n){var i=e._private,a,s=e.isEdge(),o=n==null?FE:pP(n),l=o===FE;if(i.bbCache==null?(a=k9(e,Fg),i.bbCache=a,i.bbCachePosKey=mP(e)):a=i.bbCache,!l){var u=e.isNode();a=cs(),(n.includeNodes&&u||n.includeEdges&&!u)&&(n.includeOverlays?Qc(a,i.overlayBounds):Qc(a,i.bodyBounds)),n.includeLabels&&(n.includeMainLabels&&(!s||n.includeSourceLabels&&n.includeTargetLabels)?Qc(a,i.labelBounds.all):(n.includeMainLabels&&Qc(a,i.labelBounds.mainRot),n.includeSourceLabels&&Qc(a,i.labelBounds.sourceRot),n.includeTargetLabels&&Qc(a,i.labelBounds.targetRot))),a.w=a.x2-a.x1,a.h=a.y2-a.y1}return a},Fg={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},FE=pP(Fg),VE=Ta(Fg);Ad.boundingBox=function(r){var e,n=r===void 0||r.useCache===void 0||r.useCache===!0,i=dp(function(d){var p=d._private;return p.bbCache==null||p.styleDirty||p.bbCachePosKey!==mP(d)},function(d){return d.id()});if(n&&this.length===1&&!i(this[0]))r===void 0?r=Fg:r=VE(r),e=zE(this[0],r);else{e=cs(),r=r||Fg;var a=VE(r),s=this,o=s.cy(),l=o.styleEnabled();this.edges().forEach(i),this.nodes().forEach(i),l&&this.recalculateRenderedStyle(n),this.updateCompoundBounds(!n);for(var u=0;u<s.length;u++){var c=s[u];i(c)&&c.dirtyBoundingBoxCache(),Qc(e,zE(c,a))}}return e.x1=Eo(e.x1),e.y1=Eo(e.y1),e.x2=Eo(e.x2),e.y2=Eo(e.y2),e.w=Eo(e.x2-e.x1),e.h=Eo(e.y2-e.y1),e};Ad.dirtyBoundingBoxCache=function(){for(var r=0;r<this.length;r++){var e=this[r]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Ad.boundingBoxAt=function(r){var e=this.nodes(),n=this.cy(),i=n.hasCompoundNodes(),a=n.collection();if(i&&(a=e.filter(function(c){return c.isParent()}),e=e.not(a)),Sr(r)){var s=r;r=function(){return s}}var o=function(d,p){return d._private.bbAtOldPos=r(d,p)},l=function(d){return d._private.bbAtOldPos};n.startBatch(),e.forEach(o).silentPositions(r),i&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0));var u=iD(this.boundingBox({useCache:!1}));return e.silentPositions(l),i&&(a.dirtyCompoundBoundsCache(),a.dirtyBoundingBoxCache(),a.updateCompoundBounds(!0)),n.endBatch(),u};op.boundingbox=op.bb=op.boundingBox;op.renderedBoundingbox=op.renderedBoundingBox;var C9=Ad,lg,fv;lg=fv={};var gP=function(e){e.uppercaseName=rC(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=rC(e.outerName),lg[e.name]=function(){var i=this[0],a=i._private,s=a.cy,o=s._private.styleEnabled;if(i)if(o){if(i.isParent())return i.updateCompoundBounds(),a[e.autoName]||0;var l=i.pstyle(e.name);return l.strValue==="label"?(i.recalculateRenderedStyle(),a.rstyle[e.labelName]||0):l.pfValue}else return 1},lg["outer"+e.uppercaseName]=function(){var i=this[0],a=i._private,s=a.cy,o=s._private.styleEnabled;if(i)if(o){var l=i[e.name](),u=i.pstyle("border-position").value,c;u==="center"?c=i.pstyle("border-width").pfValue:u==="outside"?c=2*i.pstyle("border-width").pfValue:c=0;var d=2*i.padding();return l+c+d}else return 1},lg["rendered"+e.uppercaseName]=function(){var i=this[0];if(i){var a=i[e.name]();return a*this.cy().zoom()}},lg["rendered"+e.uppercaseOuterName]=function(){var i=this[0];if(i){var a=i[e.outerName]();return a*this.cy().zoom()}}};gP({name:"width"});gP({name:"height"});fv.padding=function(){var r=this[0],e=r._private;return r.isParent()?(r.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:r.pstyle("padding").pfValue):r.pstyle("padding").pfValue};fv.paddedHeight=function(){var r=this[0];return r.height()+2*r.padding()};fv.paddedWidth=function(){var r=this[0];return r.width()+2*r.padding()};var E9=fv,N9=function(e,n){if(e.isEdge()&&e.takesUpSpace())return n(e)},T9=function(e,n){if(e.isEdge()&&e.takesUpSpace()){var i=e.cy();return gx(n(e),i.zoom(),i.pan())}},P9=function(e,n){if(e.isEdge()&&e.takesUpSpace()){var i=e.cy(),a=i.pan(),s=i.zoom();return n(e).map(function(o){return gx(o,s,a)})}},M9=function(e){return e.renderer().getControlPoints(e)},A9=function(e){return e.renderer().getSegmentPoints(e)},j9=function(e){return e.renderer().getSourceEndpoint(e)},R9=function(e){return e.renderer().getTargetEndpoint(e)},L9=function(e){return e.renderer().getEdgeMidpoint(e)},UE={controlPoints:{get:M9,mult:!0},segmentPoints:{get:A9,mult:!0},sourceEndpoint:{get:j9},targetEndpoint:{get:R9},midpoint:{get:L9}},O9=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},D9=Object.keys(UE).reduce(function(r,e){var n=UE[e],i=O9(e);return r[e]=function(){return N9(this,n.get)},n.mult?r[i]=function(){return P9(this,n.get)}:r[i]=function(){return T9(this,n.get)},r},{}),I9=Ht({},_9,C9,E9,D9);var vP=function(e,n){this.recycle(e,n)};function om(){return!1}function c0(){return!0}vP.prototype={instanceString:function(){return"event"},recycle:function(e,n){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=om,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?c0:om):e!=null&&e.type?n=e:this.type=e,n!=null&&(this.originalEvent=n.originalEvent,this.type=n.type!=null?n.type:this.type,this.cy=n.cy,this.target=n.target,this.position=n.position,this.renderedPosition=n.renderedPosition,this.namespace=n.namespace,this.layout=n.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var i=this.position,a=this.cy.zoom(),s=this.cy.pan();this.renderedPosition={x:i.x*a+s.x,y:i.y*a+s.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=c0;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=c0;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=c0,this.stopPropagation()},isDefaultPrevented:om,isPropagationStopped:om,isImmediatePropagationStopped:om};var yP=/^([^.]+)(\.(?:[^.]+))?$/,B9=".*",xP={qualifierCompare:function(e,n){return e===n},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},HE=Object.keys(xP),z9={};function Sx(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:z9,e=arguments.length>1?arguments[1]:void 0,n=0;n<HE.length;n++){var i=HE[n];this[i]=r[i]||xP[i]}this.context=e||this.context,this.listeners=[],this.emitting=0}var Cd=Sx.prototype,bP=function(e,n,i,a,s,o,l){zn(a)&&(s=a,a=null),l&&(o==null?o=l:o=Ht({},o,l));for(var u=rn(i)?i:i.split(/\s+/),c=0;c<u.length;c++){var d=u[c];if(!bd(d)){var p=d.match(yP);if(p){var v=p[1],y=p[2]?p[2]:null,b=n(e,d,v,y,a,s,o);if(b===!1)break}}}},GE=function(e,n){return e.addEventFields(e.context,n),new vP(n.type,n)},F9=function(e,n,i){if(W8(i)){n(e,i);return}else if(Sr(i)){n(e,GE(e,i));return}for(var a=rn(i)?i:i.split(/\s+/),s=0;s<a.length;s++){var o=a[s];if(!bd(o)){var l=o.match(yP);if(l){var u=l[1],c=l[2]?l[2]:null,d=GE(e,{type:u,namespace:c,target:e.context});n(e,d)}}}};Cd.on=Cd.addListener=function(r,e,n,i,a){return bP(this,function(s,o,l,u,c,d,p){zn(d)&&s.listeners.push({event:o,callback:d,type:l,namespace:u,qualifier:c,conf:p})},r,e,n,i,a),this};Cd.one=function(r,e,n,i){return this.on(r,e,n,i,{one:!0})};Cd.removeListener=Cd.off=function(r,e,n,i){var a=this;this.emitting!==0&&(this.listeners=TO(this.listeners));for(var s=this.listeners,o=function(c){var d=s[c];bP(a,function(p,v,y,b,S,k){if((d.type===y||r==="*")&&(!b&&d.namespace!==".*"||d.namespace===b)&&(!S||p.qualifierCompare(d.qualifier,S))&&(!k||d.callback===k))return s.splice(c,1),!1},r,e,n,i)},l=s.length-1;l>=0;l--)o(l);return this};Cd.removeAllListeners=function(){return this.removeListener("*")};Cd.emit=Cd.trigger=function(r,e,n){var i=this.listeners,a=i.length;return this.emitting++,rn(e)||(e=[e]),F9(this,function(s,o){n!=null&&(i=[{event:o.event,type:o.type,namespace:o.namespace,callback:n}],a=i.length);for(var l=function(){var d=i[u];if(d.type===o.type&&(!d.namespace||d.namespace===o.namespace||d.namespace===B9)&&s.eventMatches(s.context,d,o)){var p=[o];e!=null&&MO(p,e),s.beforeEmit(s.context,d,o),d.conf&&d.conf.one&&(s.listeners=s.listeners.filter(function(b){return b!==d}));var v=s.callbackContext(s.context,d,o),y=d.callback.apply(v,p);s.afterEmit(s.context,d,o),y===!1&&(o.stopPropagation(),o.preventDefault())}},u=0;u<a;u++)l();s.bubble(s.context)&&!o.isPropagationStopped()&&s.parent(s.context).emit(o,e)},r),this.emitting--,this};var V9={qualifierCompare:function(e,n){return e==null||n==null?e==null&&n==null:e.sameText(n)},eventMatches:function(e,n,i){var a=n.qualifier;return a!=null?e!==i.target&&ov(i.target)&&a.matches(i.target):!0},addEventFields:function(e,n){n.cy=e.cy(),n.target=e},callbackContext:function(e,n,i){return n.qualifier!=null?i.target:e},beforeEmit:function(e,n){n.conf&&n.conf.once&&n.conf.onceCollection.removeListener(n.event,n.qualifier,n.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},d0=function(e){return Dt(e)?new Sd(e):e},wP={createEmitter:function(){for(var e=0;e<this.length;e++){var n=this[e],i=n._private;i.emitter||(i.emitter=new Sx(V9,n))}return this},emitter:function(){return this._private.emitter},on:function(e,n,i){for(var a=d0(n),s=0;s<this.length;s++){var o=this[s];o.emitter().on(e,a,i)}return this},removeListener:function(e,n,i){for(var a=d0(n),s=0;s<this.length;s++){var o=this[s];o.emitter().removeListener(e,a,i)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var n=this[e];n.emitter().removeAllListeners()}return this},one:function(e,n,i){for(var a=d0(n),s=0;s<this.length;s++){var o=this[s];o.emitter().one(e,a,i)}return this},once:function(e,n,i){for(var a=d0(n),s=0;s<this.length;s++){var o=this[s];o.emitter().on(e,a,i,{once:!0,onceCollection:this})}},emit:function(e,n){for(var i=0;i<this.length;i++){var a=this[i];a.emitter().emit(e,n)}return this},emitAndNotify:function(e,n){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,n),this}};Br.eventAliasesOn(wP);var _P={nodes:function(e){return this.filter(function(n){return n.isNode()}).filter(e)},edges:function(e){return this.filter(function(n){return n.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),n=this.spawn(),i=0;i<this.length;i++){var a=this[i];a.isNode()?e.push(a):n.push(a)}return{nodes:e,edges:n}},filter:function(e,n){if(e===void 0)return this;if(Dt(e)||Xs(e))return new Sd(e).filter(this);if(zn(e)){for(var i=this.spawn(),a=this,s=0;s<a.length;s++){var o=a[s],l=n?e.apply(n,[o,s,a]):e(o,s,a);l&&i.push(o)}return i}return this.spawn()},not:function(e){if(e){Dt(e)&&(e=this.filter(e));for(var n=this.spawn(),i=0;i<this.length;i++){var a=this[i],s=e.has(a);s||n.push(a)}return n}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(Dt(e)){var n=e;return this.filter(n)}for(var i=this.spawn(),a=this,s=e,o=this.length<e.length,l=o?a:s,u=o?s:a,c=0;c<l.length;c++){var d=l[c];u.has(d)&&i.push(d)}return i},xor:function(e){var n=this._private.cy;Dt(e)&&(e=n.$(e));var i=this.spawn(),a=this,s=e,o=function(u,c){for(var d=0;d<u.length;d++){var p=u[d],v=p._private.data.id,y=c.hasElementWithId(v);y||i.push(p)}};return o(a,s),o(s,a),i},diff:function(e){var n=this._private.cy;Dt(e)&&(e=n.$(e));var i=this.spawn(),a=this.spawn(),s=this.spawn(),o=this,l=e,u=function(d,p,v){for(var y=0;y<d.length;y++){var b=d[y],S=b._private.data.id,k=p.hasElementWithId(S);k?s.merge(b):v.push(b)}};return u(o,l,i),u(l,o,a),{left:i,right:a,both:s}},add:function(e){var n=this._private.cy;if(!e)return this;if(Dt(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=this.spawnSelf(),s=0;s<e.length;s++){var o=e[s],l=!this.has(o);l&&a.push(o)}return a},merge:function(e){var n=this._private,i=n.cy;if(!e)return this;if(e&&Dt(e)){var a=e;e=i.mutableElements().filter(a)}for(var s=n.map,o=0;o<e.length;o++){var l=e[o],u=l._private.data.id,c=!s.has(u);if(c){var d=this.length++;this[d]=l,s.set(u,{ele:l,index:d})}}return this},unmergeAt:function(e){var n=this[e],i=n.id(),a=this._private,s=a.map;this[e]=void 0,s.delete(i);var o=e===this.length-1;if(this.length>1&&!o){var l=this.length-1,u=this[l],c=u._private.data.id;this[l]=void 0,this[e]=u,s.set(c,{ele:u,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var n=this._private,i=e._private.data.id,a=n.map,s=a.get(i);if(!s)return this;var o=s.index;return this.unmergeAt(o),this},unmerge:function(e){var n=this._private.cy;if(!e)return this;if(e&&Dt(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=0;a<e.length;a++)this.unmergeOne(e[a]);return this},unmergeBy:function(e){for(var n=this.length-1;n>=0;n--){var i=this[n];e(i)&&this.unmergeAt(n)}return this},map:function(e,n){for(var i=[],a=this,s=0;s<a.length;s++){var o=a[s],l=n?e.apply(n,[o,s,a]):e(o,s,a);i.push(l)}return i},reduce:function(e,n){for(var i=n,a=this,s=0;s<a.length;s++)i=e(i,a[s],s,a);return i},max:function(e,n){for(var i=-1/0,a,s=this,o=0;o<s.length;o++){var l=s[o],u=n?e.apply(n,[l,o,s]):e(l,o,s);u>i&&(i=u,a=l)}return{value:i,ele:a}},min:function(e,n){for(var i=1/0,a,s=this,o=0;o<s.length;o++){var l=s[o],u=n?e.apply(n,[l,o,s]):e(l,o,s);u<i&&(i=u,a=l)}return{value:i,ele:a}}},Nr=_P;Nr.u=Nr["|"]=Nr["+"]=Nr.union=Nr.or=Nr.add;Nr["\\"]=Nr["!"]=Nr["-"]=Nr.difference=Nr.relativeComplement=Nr.subtract=Nr.not;Nr.n=Nr["&"]=Nr["."]=Nr.and=Nr.intersection=Nr.intersect;Nr["^"]=Nr["(+)"]=Nr["(-)"]=Nr.symmetricDifference=Nr.symdiff=Nr.xor;Nr.fnFilter=Nr.filterFn=Nr.stdFilter=Nr.filter;Nr.complement=Nr.abscomp=Nr.absoluteComplement;var U9={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},SP=function(e,n){var i=e.cy(),a=i.hasCompoundNodes();function s(d){var p=d.pstyle("z-compound-depth");return p.value==="auto"?a?d.zDepth():0:p.value==="bottom"?-1:p.value==="top"?A_:0}var o=s(e)-s(n);if(o!==0)return o;function l(d){var p=d.pstyle("z-index-compare");return p.value==="auto"&&d.isNode()?1:0}var u=l(e)-l(n);if(u!==0)return u;var c=e.pstyle("z-index").value-n.pstyle("z-index").value;return c!==0?c:e.poolIndex()-n.poolIndex()},dy={forEach:function(e,n){if(zn(e))for(var i=this.length,a=0;a<i;a++){var s=this[a],o=n?e.apply(n,[s,a,this]):e(s,a,this);if(o===!1)break}return this},toArray:function(){for(var e=[],n=0;n<this.length;n++)e.push(this[n]);return e},slice:function(e,n){var i=[],a=this.length;n==null&&(n=a),e==null&&(e=0),e<0&&(e=a+e),n<0&&(n=a+n);for(var s=e;s>=0&&s<n&&s<a;s++)i.push(this[s]);return this.spawn(i)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!zn(e))return this;var n=this.toArray().sort(e);return this.spawn(n)},sortByZIndex:function(){return this.sort(SP)},zDepth:function(){var e=this[0];if(e){var n=e._private,i=n.group;if(i==="nodes"){var a=n.data.parent?e.parents().size():0;return e.isParent()?a:A_-1}else{var s=n.source,o=n.target,l=s.zDepth(),u=o.zDepth();return Math.max(l,u,0)}}}};dy.each=dy.forEach;var H9=function(){var e="undefined",n=(typeof Symbol>"u"?"undefined":Ai(Symbol))!=e&&Ai(Symbol.iterator)!=e;n&&(dy[Symbol.iterator]=function(){var i=this,a={value:void 0,done:!1},s=0,o=this.length;return w4({next:function(){return s<o?a.value=i[s++]:(a.value=void 0,a.done=!0),a}},Symbol.iterator,function(){return this})})};H9();var G9=Ta({nodeDimensionsIncludeLabels:!1}),V0={layoutDimensions:function(e){e=G9(e);var n;if(!this.takesUpSpace())n={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var i=this.boundingBox();n={w:i.w,h:i.h}}else n={w:this.outerWidth(),h:this.outerHeight()};return(n.w===0||n.h===0)&&(n.w=n.h=1),n},layoutPositions:function(e,n,i){var a=this.nodes().filter(function(R){return!R.isParent()}),s=this.cy(),o=n.eles,l=function(O){return O.id()},u=dp(i,l);e.emit({type:"layoutstart",layout:e}),e.animations=[];var c=function(O,B,I){var z={x:B.x1+B.w/2,y:B.y1+B.h/2},V={x:(I.x-z.x)*O,y:(I.y-z.y)*O};return{x:z.x+V.x,y:z.y+V.y}},d=n.spacingFactor&&n.spacingFactor!==1,p=function(){if(!d)return null;for(var O=cs(),B=0;B<a.length;B++){var I=a[B],z=u(I,B);V4(O,z.x,z.y)}return O},v=p(),y=dp(function(R,O){var B=u(R,O);if(d){var I=Math.abs(n.spacingFactor);B=c(I,v,B)}return n.transform!=null&&(B=n.transform(R,B)),B},l);if(n.animate){for(var b=0;b<a.length;b++){var S=a[b],k=y(S,b),T=n.animateFilter==null||n.animateFilter(S,b);if(T){var C=S.animation({position:k,duration:n.animationDuration,easing:n.animationEasing});e.animations.push(C)}else S.position(k)}if(n.fit){var N=s.animation({fit:{boundingBox:o.boundingBoxAt(y),padding:n.padding},duration:n.animationDuration,easing:n.animationEasing});e.animations.push(N)}else if(n.zoom!==void 0&&n.pan!==void 0){var P=s.animation({zoom:n.zoom,pan:n.pan,duration:n.animationDuration,easing:n.animationEasing});e.animations.push(P)}e.animations.forEach(function(R){return R.play()}),e.one("layoutready",n.ready),e.emit({type:"layoutready",layout:e}),Pp.all(e.animations.map(function(R){return R.promise()})).then(function(){e.one("layoutstop",n.stop),e.emit({type:"layoutstop",layout:e})})}else a.positions(y),n.fit&&s.fit(n.eles,n.padding),n.zoom!=null&&s.zoom(n.zoom),n.pan&&s.pan(n.pan),e.one("layoutready",n.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",n.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var n=this.cy();return n.makeLayout(Ht({},e,{eles:this}))}};V0.createLayout=V0.makeLayout=V0.layout;function kP(r,e,n){var i=n._private,a=i.styleCache=i.styleCache||[],s;return(s=a[r])!=null||(s=a[r]=e(n)),s}function kx(r,e){return r=Dh(r),function(i){return kP(r,e,i)}}function Cx(r,e){r=Dh(r);var n=function(a){return e.call(a)};return function(){var a=this[0];if(a)return kP(r,n,a)}}var ka={recalculateRenderedStyle:function(e){var n=this.cy(),i=n.renderer(),a=n.styleEnabled();return i&&a&&i.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),n=function(s){return s._private.styleCache=null};if(e.hasCompoundNodes()){var i;i=this.spawnSelf().merge(this.descendants()).merge(this.parents()),i.merge(i.connectedEdges()),i.forEach(n)}else this.forEach(function(a){n(a),a.connectedEdges().forEach(n)});return this},updateStyle:function(e){var n=this._private.cy;if(!n.styleEnabled())return this;if(n.batching()){var i=n._private.batchStyleEles;return i.merge(this),this}var a=n.hasCompoundNodes(),s=this;e=!!(e||e===void 0),a&&(s=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var o=s;return e?o.emitAndNotify("style"):o.emit("style"),s.forEach(function(l){return l._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var n=0;n<this.length;n++){var i=this[n];i._private.styleDirty&&(i._private.styleDirty=!1,e.style().apply(i))}},parsedStyle:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=this[0],a=i.cy();if(a.styleEnabled()&&i){i._private.styleDirty&&(i._private.styleDirty=!1,a.style().apply(i));var s=i._private.style[e];return s??(n?a.style().getDefaultProperty(e):null)}},numericStyle:function(e){var n=this[0];if(n.cy().styleEnabled()&&n){var i=n.pstyle(e);return i.pfValue!==void 0?i.pfValue:i.value}},numericStyleUnits:function(e){var n=this[0];if(n.cy().styleEnabled()&&n)return n.pstyle(e).units},renderedStyle:function(e){var n=this.cy();if(!n.styleEnabled())return this;var i=this[0];if(i)return n.style().getRenderedStyle(i,e)},style:function(e,n){var i=this.cy();if(!i.styleEnabled())return this;var a=!1,s=i.style();if(Sr(e)){var o=e;s.applyBypass(this,o,a),this.emitAndNotify("style")}else if(Dt(e))if(n===void 0){var l=this[0];return l?s.getStylePropertyValue(l,e):void 0}else s.applyBypass(this,e,n,a),this.emitAndNotify("style");else if(e===void 0){var u=this[0];return u?s.getRawStyle(u):void 0}return this},removeStyle:function(e){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style(),s=this;if(e===void 0)for(var o=0;o<s.length;o++){var l=s[o];a.removeAllBypasses(l,i)}else{e=e.split(/\s+/);for(var u=0;u<s.length;u++){var c=s[u];a.removeBypasses(c,e,i)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var n=e.hasCompoundNodes(),i=this[0];if(i){var a=i._private,s=i.pstyle("opacity").value;if(!n)return s;var o=a.data.parent?i.parents():null;if(o)for(var l=0;l<o.length;l++){var u=o[l],c=u.pstyle("opacity").value;s=c*s}return s}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var n=this[0],i=n.cy().hasCompoundNodes();if(n)return i?n.effectiveOpacity()===0:n.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var n=this[0];return!!n._private.backgrounding}};function ew(r,e){var n=r._private,i=n.data.parent?r.parents():null;if(i)for(var a=0;a<i.length;a++){var s=i[a];if(!e(s))return!1}return!0}function H_(r){var e=r.ok,n=r.edgeOkViaNode||r.ok,i=r.parentOk||r.ok;return function(){var a=this.cy();if(!a.styleEnabled())return!0;var s=this[0],o=a.hasCompoundNodes();if(s){var l=s._private;if(!e(s))return!1;if(s.isNode())return!o||ew(s,i);var u=l.source,c=l.target;return n(u)&&(!o||ew(u,n))&&(u===c||n(c)&&(!o||ew(c,n)))}}}var Mp=kx("eleTakesUpSpace",function(r){return r.pstyle("display").value==="element"&&r.width()!==0&&(r.isNode()?r.height()!==0:!0)});ka.takesUpSpace=Cx("takesUpSpace",H_({ok:Mp}));var q9=kx("eleInteractive",function(r){return r.pstyle("events").value==="yes"&&r.pstyle("visibility").value==="visible"&&Mp(r)}),W9=kx("parentInteractive",function(r){return r.pstyle("visibility").value==="visible"&&Mp(r)});ka.interactive=Cx("interactive",H_({ok:q9,parentOk:W9,edgeOkViaNode:Mp}));ka.noninteractive=function(){var r=this[0];if(r)return!r.interactive()};var $9=kx("eleVisible",function(r){return r.pstyle("visibility").value==="visible"&&r.pstyle("opacity").pfValue!==0&&Mp(r)}),K9=Mp;ka.visible=Cx("visible",H_({ok:$9,edgeOkViaNode:K9}));ka.hidden=function(){var r=this[0];if(r)return!r.visible()};ka.isBundledBezier=Cx("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});ka.bypass=ka.css=ka.style;ka.renderedCss=ka.renderedStyle;ka.removeBypass=ka.removeCss=ka.removeStyle;ka.pstyle=ka.parsedStyle;var pd={};function qE(r){return function(){var e=arguments,n=[];if(e.length===2){var i=e[0],a=e[1];this.on(r.event,i,a)}else if(e.length===1&&zn(e[0])){var s=e[0];this.on(r.event,s)}else if(e.length===0||e.length===1&&rn(e[0])){for(var o=e.length===1?e[0]:null,l=0;l<this.length;l++){var u=this[l],c=!r.ableField||u._private[r.ableField],d=u._private[r.field]!=r.value;if(r.overrideAble){var p=r.overrideAble(u);if(p!==void 0&&(c=p,!p))return this}c&&(u._private[r.field]=r.value,d&&n.push(u))}var v=this.spawn(n);v.updateStyle(),v.emit(r.event),o&&v.emit(o)}return this}}function Ap(r){pd[r.field]=function(){var e=this[0];if(e){if(r.overrideField){var n=r.overrideField(e);if(n!==void 0)return n}return e._private[r.field]}},pd[r.on]=qE({event:r.on,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!0}),pd[r.off]=qE({event:r.off,field:r.field,ableField:r.ableField,overrideAble:r.overrideAble,value:!1})}Ap({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});Ap({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});Ap({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});Ap({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});pd.deselect=pd.unselect;pd.grabbed=function(){var r=this[0];if(r)return r._private.grabbed};Ap({field:"active",on:"activate",off:"unactivate"});Ap({field:"pannable",on:"panify",off:"unpanify"});pd.inactive=function(){var r=this[0];if(r)return!r._private.active};var qa={},WE=function(e){return function(i){for(var a=this,s=[],o=0;o<a.length;o++){var l=a[o];if(l.isNode()){for(var u=!1,c=l.connectedEdges(),d=0;d<c.length;d++){var p=c[d],v=p.source(),y=p.target();if(e.noIncomingEdges&&y===l&&v!==l||e.noOutgoingEdges&&v===l&&y!==l){u=!0;break}}u||s.push(l)}}return this.spawn(s,!0).filter(i)}},$E=function(e){return function(n){for(var i=this,a=[],s=0;s<i.length;s++){var o=i[s];if(o.isNode())for(var l=o.connectedEdges(),u=0;u<l.length;u++){var c=l[u],d=c.source(),p=c.target();e.outgoing&&d===o?(a.push(c),a.push(p)):e.incoming&&p===o&&(a.push(c),a.push(d))}}return this.spawn(a,!0).filter(n)}},KE=function(e){return function(n){for(var i=this,a=[],s={};;){var o=e.outgoing?i.outgoers():i.incomers();if(o.length===0)break;for(var l=!1,u=0;u<o.length;u++){var c=o[u],d=c.id();s[d]||(s[d]=!0,a.push(c),l=!0)}if(!l)break;i=o}return this.spawn(a,!0).filter(n)}};qa.clearTraversalCache=function(){for(var r=0;r<this.length;r++)this[r]._private.traversalCache=null};Ht(qa,{roots:WE({noIncomingEdges:!0}),leaves:WE({noOutgoingEdges:!0}),outgoers:To($E({outgoing:!0}),"outgoers"),successors:KE({outgoing:!0}),incomers:To($E({incoming:!0}),"incomers"),predecessors:KE({})});Ht(qa,{neighborhood:To(function(r){for(var e=[],n=this.nodes(),i=0;i<n.length;i++)for(var a=n[i],s=a.connectedEdges(),o=0;o<s.length;o++){var l=s[o],u=l.source(),c=l.target(),d=a===u?c:u;d.length>0&&e.push(d[0]),e.push(l[0])}return this.spawn(e,!0).filter(r)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});qa.neighbourhood=qa.neighborhood;qa.closedNeighbourhood=qa.closedNeighborhood;qa.openNeighbourhood=qa.openNeighborhood;Ht(qa,{source:To(function(e){var n=this[0],i;return n&&(i=n._private.source||n.cy().collection()),i&&e?i.filter(e):i},"source"),target:To(function(e){var n=this[0],i;return n&&(i=n._private.target||n.cy().collection()),i&&e?i.filter(e):i},"target"),sources:ZE({attr:"source"}),targets:ZE({attr:"target"})});function ZE(r){return function(n){for(var i=[],a=0;a<this.length;a++){var s=this[a],o=s._private[r.attr];o&&i.push(o)}return this.spawn(i,!0).filter(n)}}Ht(qa,{edgesWith:To(YE(),"edgesWith"),edgesTo:To(YE({thisIsSrc:!0}),"edgesTo")});function YE(r){return function(n){var i=[],a=this._private.cy,s=r||{};Dt(n)&&(n=a.$(n));for(var o=0;o<n.length;o++)for(var l=n[o]._private.edges,u=0;u<l.length;u++){var c=l[u],d=c._private.data,p=this.hasElementWithId(d.source)&&n.hasElementWithId(d.target),v=n.hasElementWithId(d.source)&&this.hasElementWithId(d.target),y=p||v;y&&((s.thisIsSrc||s.thisIsTgt)&&(s.thisIsSrc&&!p||s.thisIsTgt&&!v)||i.push(c))}return this.spawn(i,!0)}}Ht(qa,{connectedEdges:To(function(r){for(var e=[],n=this,i=0;i<n.length;i++){var a=n[i];if(a.isNode())for(var s=a._private.edges,o=0;o<s.length;o++){var l=s[o];e.push(l)}}return this.spawn(e,!0).filter(r)},"connectedEdges"),connectedNodes:To(function(r){for(var e=[],n=this,i=0;i<n.length;i++){var a=n[i];a.isEdge()&&(e.push(a.source()[0]),e.push(a.target()[0]))}return this.spawn(e,!0).filter(r)},"connectedNodes"),parallelEdges:To(XE(),"parallelEdges"),codirectedEdges:To(XE({codirected:!0}),"codirectedEdges")});function XE(r){var e={codirected:!1};return r=Ht({},e,r),function(i){for(var a=[],s=this.edges(),o=r,l=0;l<s.length;l++)for(var u=s[l],c=u._private,d=c.source,p=d._private.data.id,v=c.data.target,y=d._private.edges,b=0;b<y.length;b++){var S=y[b],k=S._private.data,T=k.target,C=k.source,N=T===v&&C===p,P=p===T&&v===C;(o.codirected&&N||!o.codirected&&(N||P))&&a.push(S)}return this.spawn(a,!0).filter(i)}}Ht(qa,{components:function(e){var n=this,i=n.cy(),a=i.collection(),s=e==null?n.nodes():e.nodes(),o=[];e!=null&&s.empty()&&(s=e.sources());var l=function(d,p){a.merge(d),s.unmerge(d),p.merge(d)};if(s.empty())return n.spawn();var u=function(){var d=i.collection();o.push(d);var p=s[0];l(p,d),n.bfs({directed:!1,roots:p,visit:function(y){return l(y,d)}}),d.forEach(function(v){v.connectedEdges().forEach(function(y){n.has(y)&&d.has(y.source())&&d.has(y.target())&&d.merge(y)})})};do u();while(s.length>0);return o},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});qa.componentsOf=qa.components;var Ca=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){Rn("A collection must have a reference to the core");return}var s=new Hu,o=!1;if(!n)n=[];else if(n.length>0&&Sr(n[0])&&!ov(n[0])){o=!0;for(var l=[],u=new Tp,c=0,d=n.length;c<d;c++){var p=n[c];p.data==null&&(p.data={});var v=p.data;if(v.id==null)v.id=B4();else if(e.hasElementWithId(v.id)||u.has(v.id))continue;var y=new mx(e,p,!1);l.push(y),u.add(v.id)}n=l}this.length=0;for(var b=0,S=n.length;b<S;b++){var k=n[b][0];if(k!=null){var T=k._private.data.id;(!i||!s.has(T))&&(i&&s.set(T,{index:this.length,ele:k}),this[this.length]=k,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(C){this.lazyMap=C},rebuildMap:function(){for(var N=this.lazyMap=new Hu,P=this.eles,R=0;R<P.length;R++){var O=P[R];N.set(O.id(),{index:R,ele:O})}}},i&&(this._private.map=s),o&&!a&&this.restore()},fn=mx.prototype=Ca.prototype=Object.create(Array.prototype);fn.instanceString=function(){return"collection"};fn.spawn=function(r,e){return new Ca(this.cy(),r,e)};fn.spawnSelf=function(){return this.spawn(this)};fn.cy=function(){return this._private.cy};fn.renderer=function(){return this._private.cy.renderer()};fn.element=function(){return this[0]};fn.collection=function(){return k4(this)?this:new Ca(this._private.cy,[this])};fn.unique=function(){return new Ca(this._private.cy,this,!0)};fn.hasElementWithId=function(r){return r=""+r,this._private.map.has(r)};fn.getElementById=function(r){r=""+r;var e=this._private.cy,n=this._private.map.get(r);return n?n.ele:new Ca(e)};fn.$id=fn.getElementById;fn.poolIndex=function(){var r=this._private.cy,e=r._private.elements,n=this[0]._private.data.id;return e._private.map.get(n).index};fn.indexOf=function(r){var e=r[0]._private.data.id;return this._private.map.get(e).index};fn.indexOfId=function(r){return r=""+r,this._private.map.get(r).index};fn.json=function(r){var e=this.element(),n=this.cy();if(e==null&&r)return this;if(e!=null){var i=e._private;if(Sr(r)){if(n.startBatch(),r.data){e.data(r.data);var a=i.data;if(e.isEdge()){var s=!1,o={},l=r.data.source,u=r.data.target;l!=null&&l!=a.source&&(o.source=""+l,s=!0),u!=null&&u!=a.target&&(o.target=""+u,s=!0),s&&(e=e.move(o))}else{var c="parent"in r.data,d=r.data.parent;c&&(d!=null||a.parent!=null)&&d!=a.parent&&(d===void 0&&(d=null),d!=null&&(d=""+d),e=e.move({parent:d}))}}r.position&&e.position(r.position);var p=function(S,k,T){var C=r[S];C!=null&&C!==i[S]&&(C?e[k]():e[T]())};return p("removed","remove","restore"),p("selected","select","unselect"),p("selectable","selectify","unselectify"),p("locked","lock","unlock"),p("grabbable","grabify","ungrabify"),p("pannable","panify","unpanify"),r.classes!=null&&e.classes(r.classes),n.endBatch(),this}else if(r===void 0){var v={data:Ql(i.data),position:Ql(i.position),group:i.group,removed:i.removed,selected:i.selected,selectable:i.selectable,locked:i.locked,grabbable:i.grabbable,pannable:i.pannable,classes:null};v.classes="";var y=0;return i.classes.forEach(function(b){return v.classes+=y++===0?b:" "+b}),v}}};fn.jsons=function(){for(var r=[],e=0;e<this.length;e++){var n=this[e],i=n.json();r.push(i)}return r};fn.clone=function(){for(var r=this.cy(),e=[],n=0;n<this.length;n++){var i=this[n],a=i.json(),s=new mx(r,a,!1);e.push(s)}return new Ca(r,e)};fn.copy=fn.clone;fn.restore=function(){for(var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this,i=n.cy(),a=i._private,s=[],o=[],l,u=0,c=n.length;u<c;u++){var d=n[u];e&&!d.removed()||(d.isNode()?s.push(d):o.push(d))}l=s.concat(o);var p,v=function(){l.splice(p,1),p--};for(p=0;p<l.length;p++){var y=l[p],b=y._private,S=b.data;if(y.clearTraversalCache(),!(!e&&!b.removed)){if(S.id===void 0)S.id=B4();else if(ht(S.id))S.id=""+S.id;else if(bd(S.id)||!Dt(S.id)){Rn("Can not create element with invalid string ID `"+S.id+"`"),v();continue}else if(i.hasElementWithId(S.id)){Rn("Can not create second element with ID `"+S.id+"`"),v();continue}}var k=S.id;if(y.isNode()){var T=b.position;T.x==null&&(T.x=0),T.y==null&&(T.y=0)}if(y.isEdge()){for(var C=y,N=["source","target"],P=N.length,R=!1,O=0;O<P;O++){var B=N[O],I=S[B];ht(I)&&(I=S[B]=""+S[B]),I==null||I===""?(Rn("Can not create edge `"+k+"` with unspecified "+B),R=!0):i.hasElementWithId(I)||(Rn("Can not create edge `"+k+"` with nonexistant "+B+" `"+I+"`"),R=!0)}if(R){v();continue}var z=i.getElementById(S.source),V=i.getElementById(S.target);z.same(V)?z._private.edges.push(C):(z._private.edges.push(C),V._private.edges.push(C)),C._private.source=z,C._private.target=V}b.map=new Hu,b.map.set(k,{ele:y,index:0}),b.removed=!1,e&&i.addToPool(y)}for(var $=0;$<s.length;$++){var Y=s[$],D=Y._private.data;ht(D.parent)&&(D.parent=""+D.parent);var q=D.parent,G=q!=null;if(G||Y._private.parent){var Z=Y._private.parent?i.collection().merge(Y._private.parent):i.getElementById(q);if(Z.empty())D.parent=void 0;else if(Z[0].removed())zr("Node added with missing parent, reference to parent removed"),D.parent=void 0,Y._private.parent=null;else{for(var Q=!1,J=Z;!J.empty();){if(Y.same(J)){Q=!0,D.parent=void 0;break}J=J.parent()}Q||(Z[0]._private.children.push(Y),Y._private.parent=Z[0],a.hasCompoundNodes=!0)}}}if(l.length>0){for(var ie=l.length===n.length?n:new Ca(i,l),ne=0;ne<ie.length;ne++){var W=ie[ne];W.isNode()||(W.parallelEdges().clearTraversalCache(),W.source().clearTraversalCache(),W.target().clearTraversalCache())}var re;a.hasCompoundNodes?re=i.collection().merge(ie).merge(ie.connectedNodes()).merge(ie.parent()):re=ie,re.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(r),r?ie.emitAndNotify("add"):e&&ie.emit("add")}return n};fn.removed=function(){var r=this[0];return r&&r._private.removed};fn.inside=function(){var r=this[0];return r&&!r._private.removed};fn.remove=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this,i=[],a={},s=n._private.cy;function o(q){for(var G=q._private.edges,Z=0;Z<G.length;Z++)u(G[Z])}function l(q){for(var G=q._private.children,Z=0;Z<G.length;Z++)u(G[Z])}function u(q){var G=a[q.id()];e&&q.removed()||G||(a[q.id()]=!0,q.isNode()?(i.push(q),o(q),l(q)):i.unshift(q))}for(var c=0,d=n.length;c<d;c++){var p=n[c];u(p)}function v(q,G){var Z=q._private.edges;wd(Z,G),q.clearTraversalCache()}function y(q){q.clearTraversalCache()}var b=[];b.ids={};function S(q,G){G=G[0],q=q[0];var Z=q._private.children,Q=q.id();wd(Z,G),G._private.parent=null,b.ids[Q]||(b.ids[Q]=!0,b.push(q))}n.dirtyCompoundBoundsCache(),e&&s.removeFromPool(i);for(var k=0;k<i.length;k++){var T=i[k];if(T.isEdge()){var C=T.source()[0],N=T.target()[0];v(C,T),v(N,T);for(var P=T.parallelEdges(),R=0;R<P.length;R++){var O=P[R];y(O),O.isBundledBezier()&&O.dirtyBoundingBoxCache()}}else{var B=T.parent();B.length!==0&&S(B,T)}e&&(T._private.removed=!0)}var I=s._private.elements;s._private.hasCompoundNodes=!1;for(var z=0;z<I.length;z++){var V=I[z];if(V.isParent()){s._private.hasCompoundNodes=!0;break}}var $=new Ca(this.cy(),i);$.size()>0&&(r?$.emitAndNotify("remove"):e&&$.emit("remove"));for(var Y=0;Y<b.length;Y++){var D=b[Y];(!e||!D.removed())&&D.updateStyle()}return $};fn.move=function(r){var e=this._private.cy,n=this,i=!1,a=!1,s=function(b){return b==null?b:""+b};if(r.source!==void 0||r.target!==void 0){var o=s(r.source),l=s(r.target),u=o!=null&&e.hasElementWithId(o),c=l!=null&&e.hasElementWithId(l);(u||c)&&(e.batch(function(){n.remove(i,a),n.emitAndNotify("moveout");for(var y=0;y<n.length;y++){var b=n[y],S=b._private.data;b.isEdge()&&(u&&(S.source=o),c&&(S.target=l))}n.restore(i,a)}),n.emitAndNotify("move"))}else if(r.parent!==void 0){var d=s(r.parent),p=d===null||e.hasElementWithId(d);if(p){var v=d===null?void 0:d;e.batch(function(){var y=n.remove(i,a);y.emitAndNotify("moveout");for(var b=0;b<n.length;b++){var S=n[b],k=S._private.data;S.isNode()&&(k.parent=v)}y.restore(i,a)}),n.emitAndNotify("move")}}return this};[Y4,a9,F0,fd,fp,w9,_x,I9,wP,_P,U9,dy,V0,ka,pd,qa].forEach(function(r){Ht(fn,r)});var Z9={add:function(e){var n,i=this;if(Xs(e)){var a=e;if(a._private.cy===i)n=a.restore();else{for(var s=[],o=0;o<a.length;o++){var l=a[o];s.push(l.json())}n=new Ca(i,s)}}else if(rn(e)){var u=e;n=new Ca(i,u)}else if(Sr(e)&&(rn(e.nodes)||rn(e.edges))){for(var c=e,d=[],p=["nodes","edges"],v=0,y=p.length;v<y;v++){var b=p[v],S=c[b];if(rn(S))for(var k=0,T=S.length;k<T;k++){var C=Ht({group:b},S[k]);d.push(C)}}n=new Ca(i,d)}else{var N=e;n=new mx(i,N).collection()}return n},remove:function(e){if(!Xs(e)){if(Dt(e)){var n=e;e=this.$(n)}}return e.remove()}};function Y9(r,e,n,i){var a=4,s=.001,o=1e-7,l=10,u=11,c=1/(u-1),d=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var p=0;p<4;++p)if(typeof arguments[p]!="number"||isNaN(arguments[p])||!isFinite(arguments[p]))return!1;r=Math.min(r,1),n=Math.min(n,1),r=Math.max(r,0),n=Math.max(n,0);var v=d?new Float32Array(u):new Array(u);function y(V,$){return 1-3*$+3*V}function b(V,$){return 3*$-6*V}function S(V){return 3*V}function k(V,$,Y){return((y($,Y)*V+b($,Y))*V+S($))*V}function T(V,$,Y){return 3*y($,Y)*V*V+2*b($,Y)*V+S($)}function C(V,$){for(var Y=0;Y<a;++Y){var D=T($,r,n);if(D===0)return $;var q=k($,r,n)-V;$-=q/D}return $}function N(){for(var V=0;V<u;++V)v[V]=k(V*c,r,n)}function P(V,$,Y){var D,q,G=0;do q=$+(Y-$)/2,D=k(q,r,n)-V,D>0?Y=q:$=q;while(Math.abs(D)>o&&++G<l);return q}function R(V){for(var $=0,Y=1,D=u-1;Y!==D&&v[Y]<=V;++Y)$+=c;--Y;var q=(V-v[Y])/(v[Y+1]-v[Y]),G=$+q*c,Z=T(G,r,n);return Z>=s?C(V,G):Z===0?G:P(V,$,$+c)}var O=!1;function B(){O=!0,(r!==e||n!==i)&&N()}var I=function($){return O||B(),r===e&&n===i?$:$===0?0:$===1?1:k(R($),e,i)};I.getControlPoints=function(){return[{x:r,y:e},{x:n,y:i}]};var z="generateBezier("+[r,e,n,i]+")";return I.toString=function(){return z},I}var X9=(function(){function r(i){return-i.tension*i.x-i.friction*i.v}function e(i,a,s){var o={x:i.x+s.dx*a,v:i.v+s.dv*a,tension:i.tension,friction:i.friction};return{dx:o.v,dv:r(o)}}function n(i,a){var s={dx:i.v,dv:r(i)},o=e(i,a*.5,s),l=e(i,a*.5,o),u=e(i,a,l),c=1/6*(s.dx+2*(o.dx+l.dx)+u.dx),d=1/6*(s.dv+2*(o.dv+l.dv)+u.dv);return i.x=i.x+c*a,i.v=i.v+d*a,i}return function i(a,s,o){var l={x:-1,v:0,tension:null,friction:null},u=[0],c=0,d=1/1e4,p=16/1e3,v,y,b;for(a=parseFloat(a)||500,s=parseFloat(s)||20,o=o||null,l.tension=a,l.friction=s,v=o!==null,v?(c=i(a,s),y=c/o*p):y=p;b=n(b||l,y),u.push(1+b.x),c+=16,Math.abs(b.x)>d&&Math.abs(b.v)>d;);return v?function(S){return u[S*(u.length-1)|0]}:c}})(),hn=function(e,n,i,a){var s=Y9(e,n,i,a);return function(o,l,u){return o+(l-o)*s(u)}},U0={linear:function(e,n,i){return e+(n-e)*i},ease:hn(.25,.1,.25,1),"ease-in":hn(.42,0,1,1),"ease-out":hn(0,0,.58,1),"ease-in-out":hn(.42,0,.58,1),"ease-in-sine":hn(.47,0,.745,.715),"ease-out-sine":hn(.39,.575,.565,1),"ease-in-out-sine":hn(.445,.05,.55,.95),"ease-in-quad":hn(.55,.085,.68,.53),"ease-out-quad":hn(.25,.46,.45,.94),"ease-in-out-quad":hn(.455,.03,.515,.955),"ease-in-cubic":hn(.55,.055,.675,.19),"ease-out-cubic":hn(.215,.61,.355,1),"ease-in-out-cubic":hn(.645,.045,.355,1),"ease-in-quart":hn(.895,.03,.685,.22),"ease-out-quart":hn(.165,.84,.44,1),"ease-in-out-quart":hn(.77,0,.175,1),"ease-in-quint":hn(.755,.05,.855,.06),"ease-out-quint":hn(.23,1,.32,1),"ease-in-out-quint":hn(.86,0,.07,1),"ease-in-expo":hn(.95,.05,.795,.035),"ease-out-expo":hn(.19,1,.22,1),"ease-in-out-expo":hn(1,0,0,1),"ease-in-circ":hn(.6,.04,.98,.335),"ease-out-circ":hn(.075,.82,.165,1),"ease-in-out-circ":hn(.785,.135,.15,.86),spring:function(e,n,i){if(i===0)return U0.linear;var a=X9(e,n,i);return function(s,o,l){return s+(o-s)*a(l)}},"cubic-bezier":hn};function QE(r,e,n,i,a){if(i===1||e===n)return n;var s=a(e,n,i);return r==null||((r.roundValue||r.color)&&(s=Math.round(s)),r.min!==void 0&&(s=Math.max(s,r.min)),r.max!==void 0&&(s=Math.min(s,r.max))),s}function JE(r,e){return r.pfValue!=null||r.value!=null?r.pfValue!=null&&(e==null||e.type.units!=="%")?r.pfValue:r.value:r}function Df(r,e,n,i,a){var s=a!=null?a.type:null;n<0?n=0:n>1&&(n=1);var o=JE(r,a),l=JE(e,a);if(ht(o)&&ht(l))return QE(s,o,l,n,i);if(rn(o)&&rn(l)){for(var u=[],c=0;c<l.length;c++){var d=o[c],p=l[c];if(d!=null&&p!=null){var v=QE(s,d,p,n,i);u.push(v)}else u.push(p)}return u}}function Q9(r,e,n,i){var a=!i,s=r._private,o=e._private,l=o.easing,u=o.startTime,c=i?r:r.cy(),d=c.style();if(!o.easingImpl)if(l==null)o.easingImpl=U0.linear;else{var p;if(Dt(l)){var v=d.parse("transition-timing-function",l);p=v.value}else p=l;var y,b;Dt(p)?(y=p,b=[]):(y=p[1],b=p.slice(2).map(function(ie){return+ie})),b.length>0?(y==="spring"&&b.push(o.duration),o.easingImpl=U0[y].apply(null,b)):o.easingImpl=U0[y]}var S=o.easingImpl,k;if(o.duration===0?k=1:k=(n-u)/o.duration,o.applying&&(k=o.progress),k<0?k=0:k>1&&(k=1),o.delay==null){var T=o.startPosition,C=o.position;if(C&&a&&!r.locked()){var N={};lm(T.x,C.x)&&(N.x=Df(T.x,C.x,k,S)),lm(T.y,C.y)&&(N.y=Df(T.y,C.y,k,S)),r.position(N)}var P=o.startPan,R=o.pan,O=s.pan,B=R!=null&&i;B&&(lm(P.x,R.x)&&(O.x=Df(P.x,R.x,k,S)),lm(P.y,R.y)&&(O.y=Df(P.y,R.y,k,S)),r.emit("pan"));var I=o.startZoom,z=o.zoom,V=z!=null&&i;V&&(lm(I,z)&&(s.zoom=Ig(s.minZoom,Df(I,z,k,S),s.maxZoom)),r.emit("zoom")),(B||V)&&r.emit("viewport");var $=o.style;if($&&$.length>0&&a){for(var Y=0;Y<$.length;Y++){var D=$[Y],q=D.name,G=D,Z=o.startStyle[q],Q=d.properties[Z.name],J=Df(Z,G,k,S,Q);d.overrideBypass(r,q,J)}r.emit("style")}}return o.progress=k,k}function lm(r,e){return r==null||e==null?!1:ht(r)&&ht(e)?!0:!!(r&&e)}function J9(r,e,n,i){var a=e._private;a.started=!0,a.startTime=n-a.progress*a.duration}function eN(r,e){var n=e._private.aniEles,i=[];function a(d,p){var v=d._private,y=v.animation.current,b=v.animation.queue,S=!1;if(y.length===0){var k=b.shift();k&&y.push(k)}for(var T=function(O){for(var B=O.length-1;B>=0;B--){var I=O[B];I()}O.splice(0,O.length)},C=y.length-1;C>=0;C--){var N=y[C],P=N._private;if(P.stopped){y.splice(C,1),P.hooked=!1,P.playing=!1,P.started=!1,T(P.frames);continue}!P.playing&&!P.applying||(P.playing&&P.applying&&(P.applying=!1),P.started||J9(d,N,r),Q9(d,N,r,p),P.applying&&(P.applying=!1),T(P.frames),P.step!=null&&P.step(r),N.completed()&&(y.splice(C,1),P.hooked=!1,P.playing=!1,P.started=!1,T(P.completes)),S=!0)}return!p&&y.length===0&&b.length===0&&i.push(d),S}for(var s=!1,o=0;o<n.length;o++){var l=n[o],u=a(l);s=s||u}var c=a(e,!0);(s||c)&&(n.length>0?e.notify("draw",n):e.notify("draw")),n.unmerge(i),e.emit("step")}var e7={animate:Br.animate(),animation:Br.animation(),animated:Br.animated(),clearQueue:Br.clearQueue(),delay:Br.delay(),delayAnimation:Br.delayAnimation(),stop:Br.stop(),addToAnimationPool:function(e){var n=this;n.styleEnabled()&&n._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function n(){e._private.animationsRunning&&sy(function(s){eN(s,e),n()})}var i=e.renderer();i&&i.beforeRender?i.beforeRender(function(s,o){eN(o,e)},i.beforeRenderPriorities.animations):n()}},t7={qualifierCompare:function(e,n){return e==null||n==null?e==null&&n==null:e.sameText(n)},eventMatches:function(e,n,i){var a=n.qualifier;return a!=null?e!==i.target&&ov(i.target)&&a.matches(i.target):!0},addEventFields:function(e,n){n.cy=e,n.target=e},callbackContext:function(e,n,i){return n.qualifier!=null?i.target:e}},h0=function(e){return Dt(e)?new Sd(e):e},CP={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new Sx(t7,this)),this},emitter:function(){return this._private.emitter},on:function(e,n,i){return this.emitter().on(e,h0(n),i),this},removeListener:function(e,n,i){return this.emitter().removeListener(e,h0(n),i),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,n,i){return this.emitter().one(e,h0(n),i),this},once:function(e,n,i){return this.emitter().one(e,h0(n),i),this},emit:function(e,n){return this.emitter().emit(e,n),this},emitAndNotify:function(e,n){return this.emit(e),this.notify(e,n),this}};Br.eventAliasesOn(CP);var E2={png:function(e){var n=this._private.renderer;return e=e||{},n.png(e)},jpg:function(e){var n=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",n.jpg(e)}};E2.jpeg=E2.jpg;var H0={layout:function(e){var n=this;if(e==null){Rn("Layout options must be specified to make a layout");return}if(e.name==null){Rn("A `name` must be specified to make a layout");return}var i=e.name,a=n.extension("layout",i);if(a==null){Rn("No such layout `"+i+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var s;Dt(e.eles)?s=n.$(e.eles):s=e.eles!=null?e.eles:n.$();var o=new a(Ht({},e,{cy:n,eles:s}));return o}};H0.createLayout=H0.makeLayout=H0.layout;var r7={notify:function(e,n){var i=this._private;if(this.batching()){i.batchNotifications=i.batchNotifications||{};var a=i.batchNotifications[e]=i.batchNotifications[e]||this.collection();n!=null&&a.merge(n);return}if(i.notificationsEnabled){var s=this.renderer();this.destroyed()||!s||s.notify(e,n)}},notifications:function(e){var n=this._private;return e===void 0?n.notificationsEnabled:(n.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var n=this.renderer();Object.keys(e.batchNotifications).forEach(function(i){var a=e.batchNotifications[i];a.empty()?n.notify(i):n.notify(i,a)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var n=this;return this.batch(function(){for(var i=Object.keys(e),a=0;a<i.length;a++){var s=i[a],o=e[s],l=n.getElementById(s);l.data(o)}})}},n7=Ta({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),N2={renderTo:function(e,n,i,a){var s=this._private.renderer;return s.renderTo(e,n,i,a),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var n=this,i=n.extension("renderer",e.name);if(i==null){Rn("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&zr("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var a=n7(e);a.cy=n,n._private.renderer=new i(a),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var n=e.container();if(n)for(n._cyreg=null;n.childNodes.length>0;)n.removeChild(n.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(i){var a=i._private;a.rscratch={},a.rstyle={},a.animation.current=[],a.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};N2.invalidateDimensions=N2.resize;var G0={collection:function(e,n){return Dt(e)?this.$(e):Xs(e)?e.collection():rn(e)?(n||(n={}),new Ca(this,e,n.unique,n.removed)):new Ca(this)},nodes:function(e){var n=this.$(function(i){return i.isNode()});return e?n.filter(e):n},edges:function(e){var n=this.$(function(i){return i.isEdge()});return e?n.filter(e):n},$:function(e){var n=this._private.elements;return e?n.filter(e):n.spawnSelf()},mutableElements:function(){return this._private.elements}};G0.elements=G0.filter=G0.$;var ea={},gg="t",i7="f";ea.apply=function(r){for(var e=this,n=e._private,i=n.cy,a=i.collection(),s=0;s<r.length;s++){var o=r[s],l=e.getContextMeta(o);if(!l.empty){var u=e.getContextStyle(l),c=e.applyContextStyle(l,u,o);o._private.appliedInitStyle?e.updateTransitions(o,c.diffProps):o._private.appliedInitStyle=!0;var d=e.updateStyleHints(o);d&&a.push(o)}}return a};ea.getPropertiesDiff=function(r,e){var n=this,i=n._private.propDiffs=n._private.propDiffs||{},a=r+"-"+e,s=i[a];if(s)return s;for(var o=[],l={},u=0;u<n.length;u++){var c=n[u],d=r[u]===gg,p=e[u]===gg,v=d!==p,y=c.mappedProperties.length>0;if(v||p&&y){var b=void 0;v&&y||v?b=c.properties:y&&(b=c.mappedProperties);for(var S=0;S<b.length;S++){for(var k=b[S],T=k.name,C=!1,N=u+1;N<n.length;N++){var P=n[N],R=e[N]===gg;if(R&&(C=P.properties[k.name]!=null,C))break}!l[T]&&!C&&(l[T]=!0,o.push(T))}}}return i[a]=o,o};ea.getContextMeta=function(r){for(var e=this,n="",i,a=r._private.styleCxtKey||"",s=0;s<e.length;s++){var o=e[s],l=o.selector&&o.selector.matches(r);l?n+=gg:n+=i7}return i=e.getPropertiesDiff(a,n),r._private.styleCxtKey=n,{key:n,diffPropNames:i,empty:i.length===0}};ea.getContextStyle=function(r){var e=r.key,n=this,i=this._private.contextStyles=this._private.contextStyles||{};if(i[e])return i[e];for(var a={_private:{key:e}},s=0;s<n.length;s++){var o=n[s],l=e[s]===gg;if(l)for(var u=0;u<o.properties.length;u++){var c=o.properties[u];a[c.name]=c}}return i[e]=a,a};ea.applyContextStyle=function(r,e,n){for(var i=this,a=r.diffPropNames,s={},o=i.types,l=0;l<a.length;l++){var u=a[l],c=e[u],d=n.pstyle(u);if(!c)if(d)d.bypass?c={name:u,deleteBypassed:!0}:c={name:u,delete:!0};else continue;if(d!==c){if(c.mapped===o.fn&&d!=null&&d.mapping!=null&&d.mapping.value===c.value){var p=d.mapping,v=p.fnValue=c.value(n);if(v===p.prevFnValue)continue}var y=s[u]={prev:d};i.applyParsedProperty(n,c),y.next=n.pstyle(u),y.next&&y.next.bypass&&(y.next=y.next.bypassed)}}return{diffProps:s}};ea.updateStyleHints=function(r){var e=r._private,n=this,i=n.propertyGroupNames,a=n.propertyGroupKeys,s=function(be,Se,Ue){return n.getPropertiesHash(be,Se,Ue)},o=e.styleKey;if(r.removed())return!1;var l=e.group==="nodes",u=r._private.style;i=Object.keys(u);for(var c=0;c<a.length;c++){var d=a[c];e.styleKeys[d]=[bh,Wf]}for(var p=function(be,Se){return e.styleKeys[Se][0]=Lg(be,e.styleKeys[Se][0])},v=function(be,Se){return e.styleKeys[Se][1]=Og(be,e.styleKeys[Se][1])},y=function(be,Se){p(be,Se),v(be,Se)},b=function(be,Se){for(var Ue=0;Ue<be.length;Ue++){var We=be.charCodeAt(Ue);p(We,Se),v(We,Se)}},S=2e9,k=function(be){return-128<be&&be<128&&Math.floor(be)!==be?S-(be*1024|0):be},T=0;T<i.length;T++){var C=i[T],N=u[C];if(N!=null){var P=this.properties[C],R=P.type,O=P.groupKey,B=void 0;P.hashOverride!=null?B=P.hashOverride(r,N):N.pfValue!=null&&(B=N.pfValue);var I=P.enums==null?N.value:null,z=B!=null,V=I!=null,$=z||V,Y=N.units;if(R.number&&$&&!R.multiple){var D=z?B:I;y(k(D),O),!z&&Y!=null&&b(Y,O)}else b(N.strValue,O)}}for(var q=[bh,Wf],G=0;G<a.length;G++){var Z=a[G],Q=e.styleKeys[Z];q[0]=Lg(Q[0],q[0]),q[1]=Og(Q[1],q[1])}e.styleKey=bO(q[0],q[1]);var J=e.styleKeys;e.labelDimsKey=Wc(J.labelDimensions);var ie=s(r,["label"],J.labelDimensions);if(e.labelKey=Wc(ie),e.labelStyleKey=Wc(i0(J.commonLabel,ie)),!l){var ne=s(r,["source-label"],J.labelDimensions);e.sourceLabelKey=Wc(ne),e.sourceLabelStyleKey=Wc(i0(J.commonLabel,ne));var W=s(r,["target-label"],J.labelDimensions);e.targetLabelKey=Wc(W),e.targetLabelStyleKey=Wc(i0(J.commonLabel,W))}if(l){var re=e.styleKeys,ae=re.nodeBody,he=re.nodeBorder,ve=re.nodeOutline,xe=re.backgroundImage,se=re.compound,ge=re.pie,le=re.stripe,pe=[ae,he,ve,xe,se,ge,le].filter(function(me){return me!=null}).reduce(i0,[bh,Wf]);e.nodeKey=Wc(pe),e.hasPie=ge!=null&&ge[0]!==bh&&ge[1]!==Wf,e.hasStripe=le!=null&&le[0]!==bh&&le[1]!==Wf}return o!==e.styleKey};ea.clearStyleHints=function(r){var e=r._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null,e.hasStripe=null};ea.applyParsedProperty=function(r,e){var n=this,i=e,a=r._private.style,s,o=n.types,l=n.properties[i.name].type,u=i.bypass,c=a[i.name],d=c&&c.bypass,p=r._private,v="mapping",y=function(ae){return ae==null?null:ae.pfValue!=null?ae.pfValue:ae.value},b=function(){var ae=y(c),he=y(i);n.checkTriggers(r,i.name,ae,he)};if(e.name==="curve-style"&&r.isEdge()&&(e.value!=="bezier"&&r.isLoop()||e.value==="haystack"&&(r.source().isParent()||r.target().isParent()))&&(i=e=this.parse(e.name,"bezier",u)),i.delete)return a[i.name]=void 0,b(),!0;if(i.deleteBypassed)return c?c.bypass?(c.bypassed=void 0,b(),!0):!1:(b(),!0);if(i.deleteBypass)return c?c.bypass?(a[i.name]=c.bypassed,b(),!0):!1:(b(),!0);var S=function(){zr("Do not assign mappings to elements without corresponding data (i.e. ele `"+r.id()+"` has no mapping for property `"+i.name+"` with data field `"+i.field+"`); try a `["+i.field+"]` selector to limit scope to elements with `"+i.field+"` defined")};switch(i.mapped){case o.mapData:{for(var k=i.field.split("."),T=p.data,C=0;C<k.length&&T;C++){var N=k[C];T=T[N]}if(T==null)return S(),!1;var P;if(ht(T)){var R=i.fieldMax-i.fieldMin;R===0?P=0:P=(T-i.fieldMin)/R}else return zr("Do not use continuous mappers without specifying numeric data (i.e. `"+i.field+": "+T+"` for `"+r.id()+"` is non-numeric)"),!1;if(P<0?P=0:P>1&&(P=1),l.color){var O=i.valueMin[0],B=i.valueMax[0],I=i.valueMin[1],z=i.valueMax[1],V=i.valueMin[2],$=i.valueMax[2],Y=i.valueMin[3]==null?1:i.valueMin[3],D=i.valueMax[3]==null?1:i.valueMax[3],q=[Math.round(O+(B-O)*P),Math.round(I+(z-I)*P),Math.round(V+($-V)*P),Math.round(Y+(D-Y)*P)];s={bypass:i.bypass,name:i.name,value:q,strValue:"rgb("+q[0]+", "+q[1]+", "+q[2]+")"}}else if(l.number){var G=i.valueMin+(i.valueMax-i.valueMin)*P;s=this.parse(i.name,G,i.bypass,v)}else return!1;if(!s)return S(),!1;s.mapping=i,i=s;break}case o.data:{for(var Z=i.field.split("."),Q=p.data,J=0;J<Z.length&&Q;J++){var ie=Z[J];Q=Q[ie]}if(Q!=null&&(s=this.parse(i.name,Q,i.bypass,v)),!s)return S(),!1;s.mapping=i,i=s;break}case o.fn:{var ne=i.value,W=i.fnValue!=null?i.fnValue:ne(r);if(i.prevFnValue=W,W==null)return zr("Custom function mappers may not return null (i.e. `"+i.name+"` for ele `"+r.id()+"` is null)"),!1;if(s=this.parse(i.name,W,i.bypass,v),!s)return zr("Custom function mappers may not return invalid values for the property type (i.e. `"+i.name+"` for ele `"+r.id()+"` is invalid)"),!1;s.mapping=Ql(i),i=s;break}case void 0:break;default:return!1}return u?(d?i.bypassed=c.bypassed:i.bypassed=c,a[i.name]=i):d?c.bypassed=i:a[i.name]=i,b(),!0};ea.cleanElements=function(r,e){for(var n=0;n<r.length;n++){var i=r[n];if(this.clearStyleHints(i),i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),!e)i._private.style={};else for(var a=i._private.style,s=Object.keys(a),o=0;o<s.length;o++){var l=s[o],u=a[l];u!=null&&(u.bypass?u.bypassed=null:a[l]=null)}}};ea.update=function(){var r=this._private.cy,e=r.mutableElements();e.updateStyle()};ea.updateTransitions=function(r,e){var n=this,i=r._private,a=r.pstyle("transition-property").value,s=r.pstyle("transition-duration").pfValue,o=r.pstyle("transition-delay").pfValue;if(a.length>0&&s>0){for(var l={},u=!1,c=0;c<a.length;c++){var d=a[c],p=r.pstyle(d),v=e[d];if(v){var y=v.prev,b=y,S=v.next!=null?v.next:p,k=!1,T=void 0,C=1e-6;b&&(ht(b.pfValue)&&ht(S.pfValue)?(k=S.pfValue-b.pfValue,T=b.pfValue+C*k):ht(b.value)&&ht(S.value)?(k=S.value-b.value,T=b.value+C*k):rn(b.value)&&rn(S.value)&&(k=b.value[0]!==S.value[0]||b.value[1]!==S.value[1]||b.value[2]!==S.value[2],T=b.strValue),k&&(l[d]=S.strValue,this.applyBypass(r,d,T),u=!0))}}if(!u)return;i.transitioning=!0,new Pp(function(N){o>0?r.delayAnimation(o).play().promise().then(N):N()}).then(function(){return r.animation({style:l,duration:s,easing:r.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){n.removeBypasses(r,a),r.emitAndNotify("style"),i.transitioning=!1})}else i.transitioning&&(this.removeBypasses(r,a),r.emitAndNotify("style"),i.transitioning=!1)};ea.checkTrigger=function(r,e,n,i,a,s){var o=this.properties[e],l=a(o);r.removed()||l!=null&&l(n,i,r)&&s(o)};ea.checkZOrderTrigger=function(r,e,n,i){var a=this;this.checkTrigger(r,e,n,i,function(s){return s.triggersZOrder},function(){a._private.cy.notify("zorder",r)})};ea.checkBoundsTrigger=function(r,e,n,i){this.checkTrigger(r,e,n,i,function(a){return a.triggersBounds},function(a){r.dirtyCompoundBoundsCache(),r.dirtyBoundingBoxCache()})};ea.checkConnectedEdgesBoundsTrigger=function(r,e,n,i){this.checkTrigger(r,e,n,i,function(a){return a.triggersBoundsOfConnectedEdges},function(a){r.connectedEdges().forEach(function(s){s.dirtyBoundingBoxCache()})})};ea.checkParallelEdgesBoundsTrigger=function(r,e,n,i){this.checkTrigger(r,e,n,i,function(a){return a.triggersBoundsOfParallelEdges},function(a){r.parallelEdges().forEach(function(s){s.dirtyBoundingBoxCache()})})};ea.checkTriggers=function(r,e,n,i){r.dirtyStyleCache(),this.checkZOrderTrigger(r,e,n,i),this.checkBoundsTrigger(r,e,n,i),this.checkConnectedEdgesBoundsTrigger(r,e,n,i),this.checkParallelEdgesBoundsTrigger(r,e,n,i)};var pv={};pv.applyBypass=function(r,e,n,i){var a=this,s=[],o=!0;if(e==="*"||e==="**"){if(n!==void 0)for(var l=0;l<a.properties.length;l++){var u=a.properties[l],c=u.name,d=this.parse(c,n,!0);d&&s.push(d)}}else if(Dt(e)){var p=this.parse(e,n,!0);p&&s.push(p)}else if(Sr(e)){var v=e;i=n;for(var y=Object.keys(v),b=0;b<y.length;b++){var S=y[b],k=v[S];if(k===void 0&&(k=v[fx(S)]),k!==void 0){var T=this.parse(S,k,!0);T&&s.push(T)}}}else return!1;if(s.length===0)return!1;for(var C=!1,N=0;N<r.length;N++){for(var P=r[N],R={},O=void 0,B=0;B<s.length;B++){var I=s[B];if(i){var z=P.pstyle(I.name);O=R[I.name]={prev:z}}C=this.applyParsedProperty(P,Ql(I))||C,i&&(O.next=P.pstyle(I.name))}C&&this.updateStyleHints(P),i&&this.updateTransitions(P,R,o)}return C};pv.overrideBypass=function(r,e,n){e=P_(e);for(var i=0;i<r.length;i++){var a=r[i],s=a._private.style[e],o=this.properties[e].type,l=o.color,u=o.mutiple,c=s?s.pfValue!=null?s.pfValue:s.value:null;!s||!s.bypass?this.applyBypass(a,e,n):(s.value=n,s.pfValue!=null&&(s.pfValue=n),l?s.strValue="rgb("+n.join(",")+")":u?s.strValue=n.join(" "):s.strValue=""+n,this.updateStyleHints(a)),this.checkTriggers(a,e,c,n)}};pv.removeAllBypasses=function(r,e){return this.removeBypasses(r,this.propertyNames,e)};pv.removeBypasses=function(r,e,n){for(var i=!0,a=0;a<r.length;a++){for(var s=r[a],o={},l=0;l<e.length;l++){var u=e[l],c=this.properties[u],d=s.pstyle(c.name);if(!(!d||!d.bypass)){var p="",v=this.parse(u,p,!0),y=o[c.name]={prev:d};this.applyParsedProperty(s,v),y.next=s.pstyle(c.name)}}this.updateStyleHints(s),n&&this.updateTransitions(s,o,i)}};var G_={};G_.getEmSizeInPixels=function(){var r=this.containerCss("font-size");return r!=null?parseFloat(r):1};G_.containerCss=function(r){var e=this._private.cy,n=e.container(),i=e.window();if(i&&n&&i.getComputedStyle)return i.getComputedStyle(n).getPropertyValue(r)};var eu={};eu.getRenderedStyle=function(r,e){return e?this.getStylePropertyValue(r,e,!0):this.getRawStyle(r,!0)};eu.getRawStyle=function(r,e){var n=this;if(r=r[0],r){for(var i={},a=0;a<n.properties.length;a++){var s=n.properties[a],o=n.getStylePropertyValue(r,s.name,e);o!=null&&(i[s.name]=o,i[fx(s.name)]=o)}return i}};eu.getIndexedStyle=function(r,e,n,i){var a=r.pstyle(e)[n][i];return a??r.cy().style().getDefaultProperty(e)[n][0]};eu.getStylePropertyValue=function(r,e,n){var i=this;if(r=r[0],r){var a=i.properties[e];a.alias&&(a=a.pointsTo);var s=a.type,o=r.pstyle(a.name);if(o){var l=o.value,u=o.units,c=o.strValue;if(n&&s.number&&l!=null&&ht(l)){var d=r.cy().zoom(),p=function(k){return k*d},v=function(k,T){return p(k)+T},y=rn(l),b=y?u.every(function(S){return S!=null}):u!=null;return b?y?l.map(function(S,k){return v(S,u[k])}).join(" "):v(l,u):y?l.map(function(S){return Dt(S)?S:""+p(S)}).join(" "):""+p(l)}else if(c!=null)return c}return null}};eu.getAnimationStartStyle=function(r,e){for(var n={},i=0;i<e.length;i++){var a=e[i],s=a.name,o=r.pstyle(s);o!==void 0&&(Sr(o)?o=this.parse(s,o.strValue):o=this.parse(s,o)),o&&(n[s]=o)}return n};eu.getPropsList=function(r){var e=this,n=[],i=r,a=e.properties;if(i)for(var s=Object.keys(i),o=0;o<s.length;o++){var l=s[o],u=i[l],c=a[l]||a[P_(l)],d=this.parse(c.name,u);d&&n.push(d)}return n};eu.getNonDefaultPropertiesHash=function(r,e,n){var i=n.slice(),a,s,o,l,u,c;for(u=0;u<e.length;u++)if(a=e[u],s=r.pstyle(a,!1),s!=null)if(s.pfValue!=null)i[0]=Lg(l,i[0]),i[1]=Og(l,i[1]);else for(o=s.strValue,c=0;c<o.length;c++)l=o.charCodeAt(c),i[0]=Lg(l,i[0]),i[1]=Og(l,i[1]);return i};eu.getPropertiesHash=eu.getNonDefaultPropertiesHash;var Ex={};Ex.appendFromJson=function(r){for(var e=this,n=0;n<r.length;n++){var i=r[n],a=i.selector,s=i.style||i.css,o=Object.keys(s);e.selector(a);for(var l=0;l<o.length;l++){var u=o[l],c=s[u];e.css(u,c)}}return e};Ex.fromJson=function(r){var e=this;return e.resetToDefault(),e.appendFromJson(r),e};Ex.json=function(){for(var r=[],e=this.defaultLength;e<this.length;e++){for(var n=this[e],i=n.selector,a=n.properties,s={},o=0;o<a.length;o++){var l=a[o];s[l.name]=l.strValue}r.push({selector:i?i.toString():"core",style:s})}return r};var q_={};q_.appendFromString=function(r){var e=this,n=this,i=""+r,a,s,o;i=i.replace(/[/][*](\s|.)+?[*][/]/g,"");function l(){i.length>a.length?i=i.substr(a.length):i=""}function u(){s.length>o.length?s=s.substr(o.length):s=""}for(;;){var c=i.match(/^\s*$/);if(c)break;var d=i.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!d){zr("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+i);break}a=d[0];var p=d[1];if(p!=="core"){var v=new Sd(p);if(v.invalid){zr("Skipping parsing of block: Invalid selector found in string stylesheet: "+p),l();continue}}var y=d[2],b=!1;s=y;for(var S=[];;){var k=s.match(/^\s*$/);if(k)break;var T=s.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!T){zr("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+y),b=!0;break}o=T[0];var C=T[1],N=T[2],P=e.properties[C];if(!P){zr("Skipping property: Invalid property name in: "+o),u();continue}var R=n.parse(C,N);if(!R){zr("Skipping property: Invalid property definition in: "+o),u();continue}S.push({name:C,val:N}),u()}if(b){l();break}n.selector(p);for(var O=0;O<S.length;O++){var B=S[O];n.css(B.name,B.val)}l()}return n};q_.fromString=function(r){var e=this;return e.resetToDefault(),e.appendFromString(r),e};var yi={};(function(){var r=Mi,e=Q8,n=eO,i=tO,a=rO,s=function(me){return"^"+me+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},o=function(me){var be=r+"|\\w+|"+e+"|"+n+"|"+i+"|"+a;return"^"+me+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+r+")\\s*\\,\\s*("+r+")\\s*,\\s*("+be+")\\s*\\,\\s*("+be+")\\)$"},l=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];yi.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:s("data")},layoutData:{mapping:!0,regex:s("layoutData")},scratch:{mapping:!0,regex:s("scratch")},mapData:{mapping:!0,regex:o("mapData")},mapLayoutData:{mapping:!0,regex:o("mapLayoutData")},mapScratch:{mapping:!0,regex:o("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:l,singleRegexMatchValue:!0},urls:{regexes:l,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(me,be){switch(me.length){case 2:return be[0]!=="deg"&&be[0]!=="rad"&&be[1]!=="deg"&&be[1]!=="rad";case 1:return Dt(me[0])||be[0]==="deg"||be[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*,\\s*("+r+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(me){var be=me.length;return be===1||be===2||be===4}}};var u={zeroNonZero:function(me,be){return(me==null||be==null)&&me!==be||me==0&&be!=0?!0:me!=0&&be==0},any:function(me,be){return me!=be},emptyNonEmpty:function(me,be){var Se=bd(me),Ue=bd(be);return Se&&!Ue||!Se&&Ue}},c=yi.types,d=[{name:"label",type:c.text,triggersBounds:u.any,triggersZOrder:u.emptyNonEmpty},{name:"text-rotation",type:c.textRotation,triggersBounds:u.any},{name:"text-margin-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"text-margin-y",type:c.bidirectionalSize,triggersBounds:u.any}],p=[{name:"source-label",type:c.text,triggersBounds:u.any},{name:"source-text-rotation",type:c.textRotation,triggersBounds:u.any},{name:"source-text-margin-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"source-text-margin-y",type:c.bidirectionalSize,triggersBounds:u.any},{name:"source-text-offset",type:c.size,triggersBounds:u.any}],v=[{name:"target-label",type:c.text,triggersBounds:u.any},{name:"target-text-rotation",type:c.textRotation,triggersBounds:u.any},{name:"target-text-margin-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"target-text-margin-y",type:c.bidirectionalSize,triggersBounds:u.any},{name:"target-text-offset",type:c.size,triggersBounds:u.any}],y=[{name:"font-family",type:c.fontFamily,triggersBounds:u.any},{name:"font-style",type:c.fontStyle,triggersBounds:u.any},{name:"font-weight",type:c.fontWeight,triggersBounds:u.any},{name:"font-size",type:c.size,triggersBounds:u.any},{name:"text-transform",type:c.textTransform,triggersBounds:u.any},{name:"text-wrap",type:c.textWrap,triggersBounds:u.any},{name:"text-overflow-wrap",type:c.textOverflowWrap,triggersBounds:u.any},{name:"text-max-width",type:c.size,triggersBounds:u.any},{name:"text-outline-width",type:c.size,triggersBounds:u.any},{name:"line-height",type:c.positiveNumber,triggersBounds:u.any}],b=[{name:"text-valign",type:c.valign,triggersBounds:u.any},{name:"text-halign",type:c.halign,triggersBounds:u.any},{name:"color",type:c.color},{name:"text-outline-color",type:c.color},{name:"text-outline-opacity",type:c.zeroOneNumber},{name:"text-background-color",type:c.color},{name:"text-background-opacity",type:c.zeroOneNumber},{name:"text-background-padding",type:c.size,triggersBounds:u.any},{name:"text-border-opacity",type:c.zeroOneNumber},{name:"text-border-color",type:c.color},{name:"text-border-width",type:c.size,triggersBounds:u.any},{name:"text-border-style",type:c.borderStyle,triggersBounds:u.any},{name:"text-background-shape",type:c.textBackgroundShape,triggersBounds:u.any},{name:"text-justification",type:c.justification},{name:"box-select-labels",type:c.bool,triggersBounds:u.any}],S=[{name:"events",type:c.bool,triggersZOrder:u.any},{name:"text-events",type:c.bool,triggersZOrder:u.any},{name:"box-selection",type:c.boxSelection,triggersZOrder:u.any}],k=[{name:"display",type:c.display,triggersZOrder:u.any,triggersBounds:u.any,triggersBoundsOfConnectedEdges:u.any,triggersBoundsOfParallelEdges:function(me,be,Se){return me===be?!1:Se.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:c.visibility,triggersZOrder:u.any},{name:"opacity",type:c.zeroOneNumber,triggersZOrder:u.zeroNonZero},{name:"text-opacity",type:c.zeroOneNumber},{name:"min-zoomed-font-size",type:c.size},{name:"z-compound-depth",type:c.zCompoundDepth,triggersZOrder:u.any},{name:"z-index-compare",type:c.zIndexCompare,triggersZOrder:u.any},{name:"z-index",type:c.number,triggersZOrder:u.any}],T=[{name:"overlay-padding",type:c.size,triggersBounds:u.any},{name:"overlay-color",type:c.color},{name:"overlay-opacity",type:c.zeroOneNumber,triggersBounds:u.zeroNonZero},{name:"overlay-shape",type:c.overlayShape,triggersBounds:u.any},{name:"overlay-corner-radius",type:c.cornerRadius}],C=[{name:"underlay-padding",type:c.size,triggersBounds:u.any},{name:"underlay-color",type:c.color},{name:"underlay-opacity",type:c.zeroOneNumber,triggersBounds:u.zeroNonZero},{name:"underlay-shape",type:c.overlayShape,triggersBounds:u.any},{name:"underlay-corner-radius",type:c.cornerRadius}],N=[{name:"transition-property",type:c.propList},{name:"transition-duration",type:c.time},{name:"transition-delay",type:c.time},{name:"transition-timing-function",type:c.easing}],P=function(me,be){return be.value==="label"?-me.poolIndex():be.pfValue},R=[{name:"height",type:c.nodeSize,triggersBounds:u.any,hashOverride:P},{name:"width",type:c.nodeSize,triggersBounds:u.any,hashOverride:P},{name:"shape",type:c.nodeShape,triggersBounds:u.any},{name:"shape-polygon-points",type:c.polygonPointList,triggersBounds:u.any},{name:"corner-radius",type:c.cornerRadius},{name:"background-color",type:c.color},{name:"background-fill",type:c.fill},{name:"background-opacity",type:c.zeroOneNumber},{name:"background-blacken",type:c.nOneOneNumber},{name:"background-gradient-stop-colors",type:c.colors},{name:"background-gradient-stop-positions",type:c.percentages},{name:"background-gradient-direction",type:c.gradientDirection},{name:"padding",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"padding-relative-to",type:c.paddingRelativeTo,triggersBounds:u.any},{name:"bounds-expansion",type:c.boundsExpansion,triggersBounds:u.any}],O=[{name:"border-color",type:c.color},{name:"border-opacity",type:c.zeroOneNumber},{name:"border-width",type:c.size,triggersBounds:u.any},{name:"border-style",type:c.borderStyle},{name:"border-cap",type:c.lineCap},{name:"border-join",type:c.lineJoin},{name:"border-dash-pattern",type:c.numbers},{name:"border-dash-offset",type:c.number},{name:"border-position",type:c.linePosition}],B=[{name:"outline-color",type:c.color},{name:"outline-opacity",type:c.zeroOneNumber},{name:"outline-width",type:c.size,triggersBounds:u.any},{name:"outline-style",type:c.borderStyle},{name:"outline-offset",type:c.size,triggersBounds:u.any}],I=[{name:"background-image",type:c.urls},{name:"background-image-crossorigin",type:c.bgCrossOrigin},{name:"background-image-opacity",type:c.zeroOneNumbers},{name:"background-image-containment",type:c.bgContainment},{name:"background-image-smoothing",type:c.bools},{name:"background-position-x",type:c.bgPos},{name:"background-position-y",type:c.bgPos},{name:"background-width-relative-to",type:c.bgRelativeTo},{name:"background-height-relative-to",type:c.bgRelativeTo},{name:"background-repeat",type:c.bgRepeat},{name:"background-fit",type:c.bgFit},{name:"background-clip",type:c.bgClip},{name:"background-width",type:c.bgWH},{name:"background-height",type:c.bgWH},{name:"background-offset-x",type:c.bgPos},{name:"background-offset-y",type:c.bgPos}],z=[{name:"position",type:c.position,triggersBounds:u.any},{name:"compound-sizing-wrt-labels",type:c.compoundIncludeLabels,triggersBounds:u.any},{name:"min-width",type:c.size,triggersBounds:u.any},{name:"min-width-bias-left",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"min-width-bias-right",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"min-height",type:c.size,triggersBounds:u.any},{name:"min-height-bias-top",type:c.sizeMaybePercent,triggersBounds:u.any},{name:"min-height-bias-bottom",type:c.sizeMaybePercent,triggersBounds:u.any}],V=[{name:"line-style",type:c.lineStyle},{name:"line-color",type:c.color},{name:"line-fill",type:c.fill},{name:"line-cap",type:c.lineCap},{name:"line-opacity",type:c.zeroOneNumber},{name:"line-dash-pattern",type:c.numbers},{name:"line-dash-offset",type:c.number},{name:"line-outline-width",type:c.size},{name:"line-outline-color",type:c.color},{name:"line-gradient-stop-colors",type:c.colors},{name:"line-gradient-stop-positions",type:c.percentages},{name:"curve-style",type:c.curveStyle,triggersBounds:u.any,triggersBoundsOfParallelEdges:function(me,be){return me===be?!1:me==="bezier"||be==="bezier"}},{name:"haystack-radius",type:c.zeroOneNumber,triggersBounds:u.any},{name:"source-endpoint",type:c.edgeEndpoint,triggersBounds:u.any},{name:"target-endpoint",type:c.edgeEndpoint,triggersBounds:u.any},{name:"control-point-step-size",type:c.size,triggersBounds:u.any},{name:"control-point-distances",type:c.bidirectionalSizes,triggersBounds:u.any},{name:"control-point-weights",type:c.numbers,triggersBounds:u.any},{name:"segment-distances",type:c.bidirectionalSizes,triggersBounds:u.any},{name:"segment-weights",type:c.numbers,triggersBounds:u.any},{name:"segment-radii",type:c.numbers,triggersBounds:u.any},{name:"radius-type",type:c.radiusType,triggersBounds:u.any},{name:"taxi-turn",type:c.bidirectionalSizeMaybePercent,triggersBounds:u.any},{name:"taxi-turn-min-distance",type:c.size,triggersBounds:u.any},{name:"taxi-direction",type:c.axisDirection,triggersBounds:u.any},{name:"taxi-radius",type:c.number,triggersBounds:u.any},{name:"edge-distances",type:c.edgeDistances,triggersBounds:u.any},{name:"arrow-scale",type:c.positiveNumber,triggersBounds:u.any},{name:"loop-direction",type:c.angle,triggersBounds:u.any},{name:"loop-sweep",type:c.angle,triggersBounds:u.any},{name:"source-distance-from-node",type:c.size,triggersBounds:u.any},{name:"target-distance-from-node",type:c.size,triggersBounds:u.any}],$=[{name:"ghost",type:c.bool,triggersBounds:u.any},{name:"ghost-offset-x",type:c.bidirectionalSize,triggersBounds:u.any},{name:"ghost-offset-y",type:c.bidirectionalSize,triggersBounds:u.any},{name:"ghost-opacity",type:c.zeroOneNumber}],Y=[{name:"selection-box-color",type:c.color},{name:"selection-box-opacity",type:c.zeroOneNumber},{name:"selection-box-border-color",type:c.color},{name:"selection-box-border-width",type:c.size},{name:"active-bg-color",type:c.color},{name:"active-bg-opacity",type:c.zeroOneNumber},{name:"active-bg-size",type:c.size},{name:"outside-texture-bg-color",type:c.color},{name:"outside-texture-bg-opacity",type:c.zeroOneNumber}],D=[];yi.pieBackgroundN=16,D.push({name:"pie-size",type:c.sizeMaybePercent}),D.push({name:"pie-hole",type:c.sizeMaybePercent}),D.push({name:"pie-start-angle",type:c.angle});for(var q=1;q<=yi.pieBackgroundN;q++)D.push({name:"pie-"+q+"-background-color",type:c.color}),D.push({name:"pie-"+q+"-background-size",type:c.percent}),D.push({name:"pie-"+q+"-background-opacity",type:c.zeroOneNumber});var G=[];yi.stripeBackgroundN=16,G.push({name:"stripe-size",type:c.sizeMaybePercent}),G.push({name:"stripe-direction",type:c.axisDirectionPrimary});for(var Z=1;Z<=yi.stripeBackgroundN;Z++)G.push({name:"stripe-"+Z+"-background-color",type:c.color}),G.push({name:"stripe-"+Z+"-background-size",type:c.percent}),G.push({name:"stripe-"+Z+"-background-opacity",type:c.zeroOneNumber});var Q=[],J=yi.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:c.arrowShape,triggersBounds:u.any},{name:"arrow-color",type:c.color},{name:"arrow-fill",type:c.arrowFill},{name:"arrow-width",type:c.arrowWidth}].forEach(function(pe){J.forEach(function(me){var be=me+"-"+pe.name,Se=pe.type,Ue=pe.triggersBounds;Q.push({name:be,type:Se,triggersBounds:Ue})})},{});var ie=yi.properties=[].concat(S,N,k,T,C,$,b,y,d,p,v,R,O,B,I,D,G,z,V,Q,Y),ne=yi.propertyGroups={behavior:S,transition:N,visibility:k,overlay:T,underlay:C,ghost:$,commonLabel:b,labelDimensions:y,mainLabel:d,sourceLabel:p,targetLabel:v,nodeBody:R,nodeBorder:O,nodeOutline:B,backgroundImage:I,pie:D,stripe:G,compound:z,edgeLine:V,edgeArrow:Q,core:Y},W=yi.propertyGroupNames={},re=yi.propertyGroupKeys=Object.keys(ne);re.forEach(function(pe){W[pe]=ne[pe].map(function(me){return me.name}),ne[pe].forEach(function(me){return me.groupKey=pe})});var ae=yi.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];yi.propertyNames=ie.map(function(pe){return pe.name});for(var he=0;he<ie.length;he++){var ve=ie[he];ie[ve.name]=ve}for(var xe=0;xe<ae.length;xe++){var se=ae[xe],ge=ie[se.pointsTo],le={name:se.name,alias:!0,pointsTo:ge};ie.push(le),ie[se.name]=le}})();yi.getDefaultProperty=function(r){return this.getDefaultProperties()[r]};yi.getDefaultProperties=function(){var r=this._private;if(r.defaultProperties!=null)return r.defaultProperties;for(var e=Ht({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(u,c){for(var d=1;d<=yi.pieBackgroundN;d++){var p=c.name.replace("{{i}}",d),v=c.value;u[p]=v}return u},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(u,c){for(var d=1;d<=yi.stripeBackgroundN;d++){var p=c.name.replace("{{i}}",d),v=c.value;u[p]=v}return u},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(u,c){return yi.arrowPrefixes.forEach(function(d){var p=d+"-"+c.name,v=c.value;u[p]=v}),u},{})),n={},i=0;i<this.properties.length;i++){var a=this.properties[i];if(!a.pointsTo){var s=a.name,o=e[s],l=this.parse(s,o);n[s]=l}}return r.defaultProperties=n,r.defaultProperties};yi.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var Nx={};Nx.parse=function(r,e,n,i){var a=this;if(zn(e))return a.parseImplWarn(r,e,n,i);var s=i==="mapping"||i===!0||i===!1||i==null?"dontcare":i,o=n?"t":"f",l=""+e,u=O4(r,l,o,s),c=a.propCache=a.propCache||[],d;return(d=c[u])||(d=c[u]=a.parseImplWarn(r,e,n,i)),(n||i==="mapping")&&(d=Ql(d),d&&(d.value=Ql(d.value))),d};Nx.parseImplWarn=function(r,e,n,i){var a=this.parseImpl(r,e,n,i);return!a&&e!=null&&zr("The style property `".concat(r,": ").concat(e,"` is invalid")),a&&(a.name==="width"||a.name==="height")&&e==="label"&&zr("The style value of `label` is deprecated for `"+a.name+"`"),a};Nx.parseImpl=function(r,e,n,i){var a=this;r=P_(r);var s=a.properties[r],o=e,l=a.types;if(!s||e===void 0)return null;s.alias&&(s=s.pointsTo,r=s.name);var u=Dt(e);u&&(e=e.trim());var c=s.type;if(!c)return null;if(n&&(e===""||e===null))return{name:r,value:e,bypass:!0,deleteBypass:!0};if(zn(e))return{name:r,value:e,strValue:"fn",mapped:l.fn,bypass:n};var d,p;if(!(!u||i||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(d=new RegExp(l.data.regex).exec(e))){if(n)return!1;var v=l.data;return{name:r,value:d,strValue:""+e,mapped:v,field:d[1],bypass:n}}else if(e.length>=10&&e[0]==="m"&&(p=new RegExp(l.mapData.regex).exec(e))){if(n||c.multiple)return!1;var y=l.mapData;if(!(c.color||c.number))return!1;var b=this.parse(r,p[4]);if(!b||b.mapped)return!1;var S=this.parse(r,p[5]);if(!S||S.mapped)return!1;if(b.pfValue===S.pfValue||b.strValue===S.strValue)return zr("`"+r+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+r+": "+b.strValue+"`"),this.parse(r,b.strValue);if(c.color){var k=b.value,T=S.value,C=k[0]===T[0]&&k[1]===T[1]&&k[2]===T[2]&&(k[3]===T[3]||(k[3]==null||k[3]===1)&&(T[3]==null||T[3]===1));if(C)return!1}return{name:r,value:p,strValue:""+e,mapped:y,field:p[1],fieldMin:parseFloat(p[2]),fieldMax:parseFloat(p[3]),valueMin:b.value,valueMax:S.value,bypass:n}}}if(c.multiple&&i!=="multiple"){var N;if(u?N=e.split(/\s+/):rn(e)?N=e:N=[e],c.evenMultiple&&N.length%2!==0)return null;for(var P=[],R=[],O=[],B="",I=!1,z=0;z<N.length;z++){var V=a.parse(r,N[z],n,"multiple");I=I||Dt(V.value),P.push(V.value),O.push(V.pfValue!=null?V.pfValue:V.value),R.push(V.units),B+=(z>0?" ":"")+V.strValue}return c.validate&&!c.validate(P,R)?null:c.singleEnum&&I?P.length===1&&Dt(P[0])?{name:r,value:P[0],strValue:P[0],bypass:n}:null:{name:r,value:P,pfValue:O,strValue:B,bypass:n,units:R}}var $=function(){for(var le=0;le<c.enums.length;le++){var pe=c.enums[le];if(pe===e)return{name:r,value:e,strValue:""+e,bypass:n}}return null};if(c.number){var Y,D="px";if(c.units&&(Y=c.units),c.implicitUnits&&(D=c.implicitUnits),!c.unitless)if(u){var q="px|em"+(c.allowPercent?"|\\%":"");Y&&(q=Y);var G=e.match("^("+Mi+")("+q+")?$");G&&(e=G[1],Y=G[2]||D)}else(!Y||c.implicitUnits)&&(Y=D);if(e=parseFloat(e),isNaN(e)&&c.enums===void 0)return null;if(isNaN(e)&&c.enums!==void 0)return e=o,$();if(c.integer&&!q8(e)||c.min!==void 0&&(e<c.min||c.strictMin&&e===c.min)||c.max!==void 0&&(e>c.max||c.strictMax&&e===c.max))return null;var Z={name:r,value:e,strValue:""+e+(Y||""),units:Y,bypass:n};return c.unitless||Y!=="px"&&Y!=="em"?Z.pfValue=e:Z.pfValue=Y==="px"||!Y?e:this.getEmSizeInPixels()*e,(Y==="ms"||Y==="s")&&(Z.pfValue=Y==="ms"?e:1e3*e),(Y==="deg"||Y==="rad")&&(Z.pfValue=Y==="rad"?e:tD(e)),Y==="%"&&(Z.pfValue=e/100),Z}else if(c.propList){var Q=[],J=""+e;if(J!=="none"){for(var ie=J.split(/\s*,\s*|\s+/),ne=0;ne<ie.length;ne++){var W=ie[ne].trim();a.properties[W]?Q.push(W):zr("`"+W+"` is not a valid property name")}if(Q.length===0)return null}return{name:r,value:Q,strValue:Q.length===0?"none":Q.join(" "),bypass:n}}else if(c.color){var re=T4(e);return re?{name:r,value:re,pfValue:re,strValue:"rgb("+re[0]+","+re[1]+","+re[2]+")",bypass:n}:null}else if(c.regex||c.regexes){if(c.enums){var ae=$();if(ae)return ae}for(var he=c.regexes?c.regexes:[c.regex],ve=0;ve<he.length;ve++){var xe=new RegExp(he[ve]),se=xe.exec(e);if(se)return{name:r,value:c.singleRegexMatchValue?se[1]:se,strValue:""+e,bypass:n}}return null}else return c.string?{name:r,value:""+e,strValue:""+e,bypass:n}:c.enums?$():null};var Xi=function(e){if(!(this instanceof Xi))return new Xi(e);if(!T_(e)){Rn("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},Wa=Xi.prototype;Wa.instanceString=function(){return"style"};Wa.clear=function(){for(var r=this._private,e=r.cy,n=e.elements(),i=0;i<this.length;i++)this[i]=void 0;return this.length=0,r.contextStyles={},r.propDiffs={},this.cleanElements(n,!0),n.forEach(function(a){var s=a[0]._private;s.styleDirty=!0,s.appliedInitStyle=!1}),this};Wa.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Wa.core=function(r){return this._private.coreStyle[r]||this.getDefaultProperty(r)};Wa.selector=function(r){var e=r==="core"?null:new Sd(r),n=this.length++;return this[n]={selector:e,properties:[],mappedProperties:[],index:n},this};Wa.css=function(){var r=this,e=arguments;if(e.length===1)for(var n=e[0],i=0;i<r.properties.length;i++){var a=r.properties[i],s=n[a.name];s===void 0&&(s=n[fx(a.name)]),s!==void 0&&this.cssRule(a.name,s)}else e.length===2&&this.cssRule(e[0],e[1]);return this};Wa.style=Wa.css;Wa.cssRule=function(r,e){var n=this.parse(r,e);if(n){var i=this.length-1;this[i].properties.push(n),this[i].properties[n.name]=n,n.name.match(/pie-(\d+)-background-size/)&&n.value&&(this._private.hasPie=!0),n.name.match(/stripe-(\d+)-background-size/)&&n.value&&(this._private.hasStripe=!0),n.mapped&&this[i].mappedProperties.push(n);var a=!this[i].selector;a&&(this._private.coreStyle[n.name]=n)}return this};Wa.append=function(r){return C4(r)?r.appendToStyle(this):rn(r)?this.appendFromJson(r):Dt(r)&&this.appendFromString(r),this};Xi.fromJson=function(r,e){var n=new Xi(r);return n.fromJson(e),n};Xi.fromString=function(r,e){return new Xi(r).fromString(e)};[ea,pv,G_,eu,Ex,q_,yi,Nx].forEach(function(r){Ht(Wa,r)});Xi.types=Wa.types;Xi.properties=Wa.properties;Xi.propertyGroups=Wa.propertyGroups;Xi.propertyGroupNames=Wa.propertyGroupNames;Xi.propertyGroupKeys=Wa.propertyGroupKeys;var a7={style:function(e){if(e){var n=this.setStyle(e);n.update()}return this._private.style},setStyle:function(e){var n=this._private;return C4(e)?n.style=e.generateStyle(this):rn(e)?n.style=Xi.fromJson(this,e):Dt(e)?n.style=Xi.fromString(this,e):n.style=Xi(this),n.style},updateStyle:function(){this.mutableElements().updateStyle()}},s7="single",zh={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var n=this._private;if(n.selectionType==null&&(n.selectionType=s7),e!==void 0)(e==="additive"||e==="single")&&(n.selectionType=e);else return n.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,n=this._private.pan,i,a,s,o,l;switch(e.length){case 0:return n;case 1:if(Dt(e[0]))return i=e[0],n[i];if(Sr(e[0])){if(!this._private.panningEnabled)return this;s=e[0],o=s.x,l=s.y,ht(o)&&(n.x=o),ht(l)&&(n.y=l),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;i=e[0],a=e[1],(i==="x"||i==="y")&&ht(a)&&(n[i]=a),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,n){var i=arguments,a=this._private.pan,s,o,l,u,c;if(!this._private.panningEnabled)return this;switch(i.length){case 1:Sr(e)&&(l=i[0],u=l.x,c=l.y,ht(u)&&(a.x+=u),ht(c)&&(a.y+=c),this.emit("pan viewport"));break;case 2:s=e,o=n,(s==="x"||s==="y")&&ht(o)&&(a[s]+=o),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,n){var i=this.getFitViewport(e,n);if(i){var a=this._private;a.zoom=i.zoom,a.pan=i.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,n){if(ht(e)&&n===void 0&&(n=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var i;if(Dt(e)){var a=e;e=this.$(a)}else if(K8(e)){var s=e;i={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2},i.w=i.x2-i.x1,i.h=i.y2-i.y1}else Xs(e)||(e=this.mutableElements());if(!(Xs(e)&&e.empty())){i=i||e.boundingBox();var o=this.width(),l=this.height(),u;if(n=ht(n)?n:0,!isNaN(o)&&!isNaN(l)&&o>0&&l>0&&!isNaN(i.w)&&!isNaN(i.h)&&i.w>0&&i.h>0){u=Math.min((o-2*n)/i.w,(l-2*n)/i.h),u=u>this._private.maxZoom?this._private.maxZoom:u,u=u<this._private.minZoom?this._private.minZoom:u;var c={x:(o-u*(i.x1+i.x2))/2,y:(l-u*(i.y1+i.y2))/2};return{zoom:u,pan:c}}}}},zoomRange:function(e,n){var i=this._private;if(n==null){var a=e;e=a.min,n=a.max}return ht(e)&&ht(n)&&e<=n?(i.minZoom=e,i.maxZoom=n):ht(e)&&n===void 0&&e<=i.maxZoom?i.minZoom=e:ht(n)&&e===void 0&&n>=i.minZoom&&(i.maxZoom=n),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var n=this._private,i=n.pan,a=n.zoom,s,o,l=!1;if(n.zoomingEnabled||(l=!0),ht(e)?o=e:Sr(e)&&(o=e.level,e.position!=null?s=gx(e.position,a,i):e.renderedPosition!=null&&(s=e.renderedPosition),s!=null&&!n.panningEnabled&&(l=!0)),o=o>n.maxZoom?n.maxZoom:o,o=o<n.minZoom?n.minZoom:o,l||!ht(o)||o===a||s!=null&&(!ht(s.x)||!ht(s.y)))return null;if(s!=null){var u=i,c=a,d=o,p={x:-d/c*(s.x-u.x)+s.x,y:-d/c*(s.y-u.y)+s.y};return{zoomed:!0,panned:!0,zoom:d,pan:p}}else return{zoomed:!0,panned:!1,zoom:o,pan:i}},zoom:function(e){if(e===void 0)return this._private.zoom;var n=this.getZoomedViewport(e),i=this._private;return n==null||!n.zoomed?this:(i.zoom=n.zoom,n.panned&&(i.pan.x=n.pan.x,i.pan.y=n.pan.y),this.emit("zoom"+(n.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var n=this._private,i=!0,a=!0,s=[],o=!1,l=!1;if(!e)return this;if(ht(e.zoom)||(i=!1),Sr(e.pan)||(a=!1),!i&&!a)return this;if(i){var u=e.zoom;u<n.minZoom||u>n.maxZoom||!n.zoomingEnabled?o=!0:(n.zoom=u,s.push("zoom"))}if(a&&(!o||!e.cancelOnFailedZoom)&&n.panningEnabled){var c=e.pan;ht(c.x)&&(n.pan.x=c.x,l=!1),ht(c.y)&&(n.pan.y=c.y,l=!1),l||s.push("pan")}return s.length>0&&(s.push("viewport"),this.emit(s.join(" ")),this.notify("viewport")),this},center:function(e){var n=this.getCenterPan(e);return n&&(this._private.pan=n,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,n){if(this._private.panningEnabled){if(Dt(e)){var i=e;e=this.mutableElements().filter(i)}else Xs(e)||(e=this.mutableElements());if(e.length!==0){var a=e.boundingBox(),s=this.width(),o=this.height();n=n===void 0?this._private.zoom:n;var l={x:(s-n*(a.x1+a.x2))/2,y:(o-n*(a.y1+a.y2))/2};return l}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,n=e.container,i=this;return e.sizeCache=e.sizeCache||(n?(function(){var a=i.window().getComputedStyle(n),s=function(l){return parseFloat(a.getPropertyValue(l))};return{width:n.clientWidth-s("padding-left")-s("padding-right"),height:n.clientHeight-s("padding-top")-s("padding-bottom")}})():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,n=this._private.zoom,i=this.renderedExtent(),a={x1:(i.x1-e.x)/n,x2:(i.x2-e.x)/n,y1:(i.y1-e.y)/n,y2:(i.y2-e.y)/n};return a.w=a.x2-a.x1,a.h=a.y2-a.y1,a},renderedExtent:function(){var e=this.width(),n=this.height();return{x1:0,y1:0,x2:e,y2:n,w:e,h:n}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};zh.centre=zh.center;zh.autolockNodes=zh.autolock;zh.autoungrabifyNodes=zh.autoungrabify;var Vg={data:Br.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:Br.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:Br.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Br.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};Vg.attr=Vg.data;Vg.removeAttr=Vg.removeData;var Ug=function(e){var n=this;e=Ht({},e);var i=e.container;i&&!ay(i)&&ay(i[0])&&(i=i[0]);var a=i?i._cyreg:null;a=a||{},a&&a.cy&&(a.cy.destroy(),a={});var s=a.readies=a.readies||[];i&&(i._cyreg=a),a.cy=n;var o=Pi!==void 0&&i!==void 0&&!e.headless,l=e;l.layout=Ht({name:o?"grid":"null"},l.layout),l.renderer=Ht({name:o?"canvas":"null"},l.renderer);var u=function(b,S,k){return S!==void 0?S:k!==void 0?k:b},c=this._private={container:i,ready:!1,options:l,elements:new Ca(this),listeners:[],aniEles:new Ca(this),data:l.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:u(!0,l.zoomingEnabled),userZoomingEnabled:u(!0,l.userZoomingEnabled),panningEnabled:u(!0,l.panningEnabled),userPanningEnabled:u(!0,l.userPanningEnabled),boxSelectionEnabled:u(!0,l.boxSelectionEnabled),autolock:u(!1,l.autolock,l.autolockNodes),autoungrabify:u(!1,l.autoungrabify,l.autoungrabifyNodes),autounselectify:u(!1,l.autounselectify),styleEnabled:l.styleEnabled===void 0?o:l.styleEnabled,zoom:ht(l.zoom)?l.zoom:1,pan:{x:Sr(l.pan)&&ht(l.pan.x)?l.pan.x:0,y:Sr(l.pan)&&ht(l.pan.y)?l.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:u(250,l.multiClickDebounceTime)};this.createEmitter(),this.selectionType(l.selectionType),this.zoomRange({min:l.minZoom,max:l.maxZoom});var d=function(b,S){var k=b.some(Z8);if(k)return Pp.all(b).then(S);S(b)};c.styleEnabled&&n.setStyle([]);var p=Ht({},l,l.renderer);n.initRenderer(p);var v=function(b,S,k){n.notifications(!1);var T=n.mutableElements();T.length>0&&T.remove(),b!=null&&(Sr(b)||rn(b))&&n.add(b),n.one("layoutready",function(N){n.notifications(!0),n.emit(N),n.one("load",S),n.emitAndNotify("load")}).one("layoutstop",function(){n.one("done",k),n.emit("done")});var C=Ht({},n._private.options.layout);C.eles=n.elements(),n.layout(C).run()};d([l.style,l.elements],function(y){var b=y[0],S=y[1];c.styleEnabled&&n.style().append(b),v(S,function(){n.startAnimationLoop(),c.ready=!0,zn(l.ready)&&n.on("ready",l.ready);for(var k=0;k<s.length;k++){var T=s[k];n.on("ready",T)}a&&(a.readies=[]),n.emit("ready")},l.done)})},hy=Ug.prototype;Ht(hy,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return Pi;var n=this._private.container.ownerDocument;return n===void 0||n==null?Pi:n.defaultView||Pi},mount:function(e){if(e!=null){var n=this,i=n._private,a=i.options;return!ay(e)&&ay(e[0])&&(e=e[0]),n.stopAnimationLoop(),n.destroyRenderer(),i.container=e,i.styleEnabled=!0,n.invalidateSize(),n.initRenderer(Ht({},a,a.renderer,{name:a.renderer.name==="null"?"canvas":a.renderer.name})),n.startAnimationLoop(),n.style(a.style),n.emit("mount"),n}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return Ql(this._private.options)},json:function(e){var n=this,i=n._private,a=n.mutableElements(),s=function(P){return n.getElementById(P.id())};if(Sr(e)){if(n.startBatch(),e.elements){var o={},l=function(P,R){for(var O=[],B=[],I=0;I<P.length;I++){var z=P[I];if(!z.data.id){zr("cy.json() cannot handle elements without an ID attribute");continue}var V=""+z.data.id,$=n.getElementById(V);o[V]=!0,$.length!==0?B.push({ele:$,json:z}):(R&&(z.group=R),O.push(z))}n.add(O);for(var Y=0;Y<B.length;Y++){var D=B[Y],q=D.ele,G=D.json;q.json(G)}};if(rn(e.elements))l(e.elements);else for(var u=["nodes","edges"],c=0;c<u.length;c++){var d=u[c],p=e.elements[d];rn(p)&&l(p,d)}var v=n.collection();a.filter(function(N){return!o[N.id()]}).forEach(function(N){N.isParent()?v.merge(N):N.remove()}),v.forEach(function(N){return N.children().move({parent:null})}),v.forEach(function(N){return s(N).remove()})}e.style&&n.style(e.style),e.zoom!=null&&e.zoom!==i.zoom&&n.zoom(e.zoom),e.pan&&(e.pan.x!==i.pan.x||e.pan.y!==i.pan.y)&&n.pan(e.pan),e.data&&n.data(e.data);for(var y=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],b=0;b<y.length;b++){var S=y[b];e[S]!=null&&n[S](e[S])}return n.endBatch(),this}else{var k=!!e,T={};k?T.elements=this.elements().map(function(N){return N.json()}):(T.elements={},a.forEach(function(N){var P=N.group();T.elements[P]||(T.elements[P]=[]),T.elements[P].push(N.json())})),this._private.styleEnabled&&(T.style=n.style().json()),T.data=Ql(n.data());var C=i.options;return T.zoomingEnabled=i.zoomingEnabled,T.userZoomingEnabled=i.userZoomingEnabled,T.zoom=i.zoom,T.minZoom=i.minZoom,T.maxZoom=i.maxZoom,T.panningEnabled=i.panningEnabled,T.userPanningEnabled=i.userPanningEnabled,T.pan=Ql(i.pan),T.boxSelectionEnabled=i.boxSelectionEnabled,T.renderer=Ql(C.renderer),T.hideEdgesOnViewport=C.hideEdgesOnViewport,T.textureOnViewport=C.textureOnViewport,T.wheelSensitivity=C.wheelSensitivity,T.motionBlur=C.motionBlur,T.multiClickDebounceTime=C.multiClickDebounceTime,T}}});hy.$id=hy.getElementById;[Z9,e7,CP,E2,H0,r7,N2,G0,a7,zh,Vg].forEach(function(r){Ht(hy,r)});var o7={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}},l7={maximal:!1,acyclic:!1},If=function(e){return e.scratch("breadthfirst")},tN=function(e,n){return e.scratch("breadthfirst",n)};function EP(r){this.options=Ht({},o7,l7,r)}EP.prototype.run=function(){var r=this.options,e=r.cy,n=r.eles,i=n.nodes().filter(function(Ve){return Ve.isChildless()}),a=n,s=r.directed,o=r.acyclic||r.maximal||r.maximalAdjustments>0,l=!!r.boundingBox,u=cs(l?r.boundingBox:structuredClone(e.extent())),c;if(Xs(r.roots))c=r.roots;else if(rn(r.roots)){for(var d=[],p=0;p<r.roots.length;p++){var v=r.roots[p],y=e.getElementById(v);d.push(y)}c=e.collection(d)}else if(Dt(r.roots))c=e.$(r.roots);else if(s)c=i.roots();else{var b=n.components();c=e.collection();for(var S=function(){var Oe=b[k],et=Oe.maxDegree(!1),Ne=Oe.filter(function(ze){return ze.degree(!1)===et});c=c.add(Ne)},k=0;k<b.length;k++)S()}var T=[],C={},N=function(Oe,et){T[et]==null&&(T[et]=[]);var Ne=T[et].length;T[et].push(Oe),tN(Oe,{index:Ne,depth:et})},P=function(Oe,et){var Ne=If(Oe),ze=Ne.depth,Ke=Ne.index;T[ze][Ke]=null,Oe.isChildless()&&N(Oe,et)};a.bfs({roots:c,directed:r.directed,visit:function(Oe,et,Ne,ze,Ke){var ft=Oe[0],yt=ft.id();ft.isChildless()&&N(ft,Ke),C[yt]=!0}});for(var R=[],O=0;O<i.length;O++){var B=i[O];C[B.id()]||R.push(B)}var I=function(Oe){for(var et=T[Oe],Ne=0;Ne<et.length;Ne++){var ze=et[Ne];if(ze==null){et.splice(Ne,1),Ne--;continue}tN(ze,{depth:Oe,index:Ne})}},z=function(Oe,et){for(var Ne=If(Oe),ze=Oe.incomers().filter(function(wt){return wt.isNode()&&n.has(wt)}),Ke=-1,ft=Oe.id(),yt=0;yt<ze.length;yt++){var Et=ze[yt],Rt=If(Et);Ke=Math.max(Ke,Rt.depth)}if(Ne.depth<=Ke){if(!r.acyclic&&et[ft])return null;var $t=Ke+1;return P(Oe,$t),et[ft]=$t,!0}return!1};if(s&&o){var V=[],$={},Y=function(Oe){return V.push(Oe)},D=function(){return V.shift()};for(i.forEach(function(Ve){return V.push(Ve)});V.length>0;){var q=D(),G=z(q,$);if(G)q.outgoers().filter(function(Ve){return Ve.isNode()&&n.has(Ve)}).forEach(Y);else if(G===null){zr("Detected double maximal shift for node `"+q.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var Z=0;if(r.avoidOverlap)for(var Q=0;Q<i.length;Q++){var J=i[Q],ie=J.layoutDimensions(r),ne=ie.w,W=ie.h;Z=Math.max(Z,ne,W)}var re={},ae=function(Oe){if(re[Oe.id()])return re[Oe.id()];for(var et=If(Oe).depth,Ne=Oe.neighborhood(),ze=0,Ke=0,ft=0;ft<Ne.length;ft++){var yt=Ne[ft];if(!(yt.isEdge()||yt.isParent()||!i.has(yt))){var Et=If(yt);if(Et!=null){var Rt=Et.index,$t=Et.depth;if(!(Rt==null||$t==null)){var wt=T[$t].length;$t<et&&(ze+=Rt/wt,Ke++)}}}}return Ke=Math.max(1,Ke),ze=ze/Ke,Ke===0&&(ze=0),re[Oe.id()]=ze,ze},he=function(Oe,et){var Ne=ae(Oe),ze=ae(et),Ke=Ne-ze;return Ke===0?N4(Oe.id(),et.id()):Ke};r.depthSort!==void 0&&(he=r.depthSort);for(var ve=T.length,xe=0;xe<ve;xe++)T[xe].sort(he),I(xe);for(var se=[],ge=0;ge<R.length;ge++)se.push(R[ge]);var le=function(){for(var Oe=0;Oe<ve;Oe++)I(Oe)};se.length&&(T.unshift(se),ve=T.length,le());for(var pe=0,me=0;me<ve;me++)pe=Math.max(T[me].length,pe);var be={x:u.x1+u.w/2,y:u.y1+u.h/2},Se=i.reduce(function(Ve,Oe){return(function(et){return{w:Ve.w===-1?et.w:(Ve.w+et.w)/2,h:Ve.h===-1?et.h:(Ve.h+et.h)/2}})(Oe.boundingBox({includeLabels:r.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),Ue=Math.max(ve===1?0:l?(u.h-r.padding*2-Se.h)/(ve-1):(u.h-r.padding*2-Se.h)/(ve+1),Z),We=T.reduce(function(Ve,Oe){return Math.max(Ve,Oe.length)},0),gt=function(Oe){var et=If(Oe),Ne=et.depth,ze=et.index;if(r.circle){var Ke=Math.min(u.w/2/ve,u.h/2/ve);Ke=Math.max(Ke,Z);var ft=Ke*Ne+Ke-(ve>0&&T[0].length<=3?Ke/2:0),yt=2*Math.PI/T[Ne].length*ze;return Ne===0&&T[0].length===1&&(ft=1),{x:be.x+ft*Math.cos(yt),y:be.y+ft*Math.sin(yt)}}else{var Et=T[Ne].length,Rt=Math.max(Et===1?0:l?(u.w-r.padding*2-Se.w)/((r.grid?We:Et)-1):(u.w-r.padding*2-Se.w)/((r.grid?We:Et)+1),Z),$t={x:be.x+(ze+1-(Et+1)/2)*Rt,y:be.y+(Ne+1-(ve+1)/2)*Ue};return $t}},Je={downward:0,leftward:90,upward:180,rightward:-90};Object.keys(Je).indexOf(r.direction)===-1&&Rn("Invalid direction '".concat(r.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(Je).join(", ")));var at=function(Oe){return kO(gt(Oe),u,Je[r.direction])};return n.nodes().layoutPositions(this,r,at),this};var u7={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function NP(r){this.options=Ht({},u7,r)}NP.prototype.run=function(){var r=this.options,e=r,n=r.cy,i=e.eles,a=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,s=i.nodes().not(":parent");e.sort&&(s=s.sort(e.sort));for(var o=cs(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),l={x:o.x1+o.w/2,y:o.y1+o.h/2},u=e.sweep===void 0?2*Math.PI-2*Math.PI/s.length:e.sweep,c=u/Math.max(1,s.length-1),d,p=0,v=0;v<s.length;v++){var y=s[v],b=y.layoutDimensions(e),S=b.w,k=b.h;p=Math.max(p,S,k)}if(ht(e.radius)?d=e.radius:s.length<=1?d=0:d=Math.min(o.h,o.w)/2-p,s.length>1&&e.avoidOverlap){p*=1.75;var T=Math.cos(c)-Math.cos(0),C=Math.sin(c)-Math.sin(0),N=Math.sqrt(p*p/(T*T+C*C));d=Math.max(N,d)}var P=function(O,B){var I=e.startAngle+B*c*(a?1:-1),z=d*Math.cos(I),V=d*Math.sin(I),$={x:l.x+z,y:l.y+V};return $};return i.nodes().layoutPositions(this,e,P),this};var c7={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function TP(r){this.options=Ht({},c7,r)}TP.prototype.run=function(){for(var r=this.options,e=r,n=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,i=r.cy,a=e.eles,s=a.nodes().not(":parent"),o=cs(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:i.width(),h:i.height()}),l={x:o.x1+o.w/2,y:o.y1+o.h/2},u=[],c=0,d=0;d<s.length;d++){var p=s[d],v=void 0;v=e.concentric(p),u.push({value:v,node:p}),p._private.scratch.concentric=v}s.updateStyle();for(var y=0;y<s.length;y++){var b=s[y],S=b.layoutDimensions(e);c=Math.max(c,S.w,S.h)}u.sort(function(Ue,We){return We.value-Ue.value});for(var k=e.levelWidth(s),T=[[]],C=T[0],N=0;N<u.length;N++){var P=u[N];if(C.length>0){var R=Math.abs(C[0].value-P.value);R>=k&&(C=[],T.push(C))}C.push(P)}var O=c+e.minNodeSpacing;if(!e.avoidOverlap){var B=T.length>0&&T[0].length>1,I=Math.min(o.w,o.h)/2-O,z=I/(T.length+B?1:0);O=Math.min(O,z)}for(var V=0,$=0;$<T.length;$++){var Y=T[$],D=e.sweep===void 0?2*Math.PI-2*Math.PI/Y.length:e.sweep,q=Y.dTheta=D/Math.max(1,Y.length-1);if(Y.length>1&&e.avoidOverlap){var G=Math.cos(q)-Math.cos(0),Z=Math.sin(q)-Math.sin(0),Q=Math.sqrt(O*O/(G*G+Z*Z));V=Math.max(Q,V)}Y.r=V,V+=O}if(e.equidistant){for(var J=0,ie=0,ne=0;ne<T.length;ne++){var W=T[ne],re=W.r-ie;J=Math.max(J,re)}ie=0;for(var ae=0;ae<T.length;ae++){var he=T[ae];ae===0&&(ie=he.r),he.r=ie,ie+=J}}for(var ve={},xe=0;xe<T.length;xe++)for(var se=T[xe],ge=se.dTheta,le=se.r,pe=0;pe<se.length;pe++){var me=se[pe],be=e.startAngle+(n?1:-1)*ge*pe,Se={x:l.x+le*Math.cos(be),y:l.y+le*Math.sin(be)};ve[me.node.id()]=Se}return a.nodes().layoutPositions(this,e,function(Ue){var We=Ue.id();return ve[We]}),this};var tw,d7={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,n){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function Tx(r){this.options=Ht({},d7,r),this.options.layout=this;var e=this.options.eles.nodes(),n=this.options.eles.edges(),i=n.filter(function(a){var s=a.source().data("id"),o=a.target().data("id"),l=e.some(function(c){return c.data("id")===s}),u=e.some(function(c){return c.data("id")===o});return!l||!u});this.options.eles=this.options.eles.not(i)}Tx.prototype.run=function(){var r=this.options,e=r.cy,n=this;n.stopped=!1,(r.animate===!0||r.animate===!1)&&n.emit({type:"layoutstart",layout:n}),r.debug===!0?tw=!0:tw=!1;var i=h7(e,n,r);tw&&p7(i),r.randomize&&m7(i);var a=$u(),s=function(){g7(i,e,r),r.fit===!0&&e.fit(r.padding)},o=function(v){return!(n.stopped||v>=r.numIter||(v7(i,r),i.temperature=i.temperature*r.coolingFactor,i.temperature<r.minTemp))},l=function(){if(r.animate===!0||r.animate===!1)s(),n.one("layoutstop",r.stop),n.emit({type:"layoutstop",layout:n});else{var v=r.eles.nodes(),y=MP(i,r,v);v.layoutPositions(n,r,y)}},u=0,c=!0;if(r.animate===!0){var d=function(){for(var v=0;c&&v<r.refresh;)c=o(u),u++,v++;if(!c)nN(i,r),l();else{var y=$u();y-a>=r.animationThreshold&&s(),sy(d)}};d()}else{for(;c;)c=o(u),u++;nN(i,r),l()}return this};Tx.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};Tx.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var h7=function(e,n,i){for(var a=i.eles.edges(),s=i.eles.nodes(),o=cs(i.boundingBox?i.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),l={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:s.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:a.size(),temperature:i.initialTemp,clientWidth:o.w,clientHeight:o.h,boundingBox:o},u=i.eles.components(),c={},d=0;d<u.length;d++)for(var p=u[d],v=0;v<p.length;v++){var y=p[v];c[y.id()]=d}for(var d=0;d<l.nodeSize;d++){var b=s[d],S=b.layoutDimensions(i),k={};k.isLocked=b.locked(),k.id=b.data("id"),k.parentId=b.data("parent"),k.cmptId=c[b.id()],k.children=[],k.positionX=b.position("x"),k.positionY=b.position("y"),k.offsetX=0,k.offsetY=0,k.height=S.w,k.width=S.h,k.maxX=k.positionX+k.width/2,k.minX=k.positionX-k.width/2,k.maxY=k.positionY+k.height/2,k.minY=k.positionY-k.height/2,k.padLeft=parseFloat(b.style("padding")),k.padRight=parseFloat(b.style("padding")),k.padTop=parseFloat(b.style("padding")),k.padBottom=parseFloat(b.style("padding")),k.nodeRepulsion=zn(i.nodeRepulsion)?i.nodeRepulsion(b):i.nodeRepulsion,l.layoutNodes.push(k),l.idToIndex[k.id]=d}for(var T=[],C=0,N=-1,P=[],d=0;d<l.nodeSize;d++){var b=l.layoutNodes[d],R=b.parentId;R!=null?l.layoutNodes[l.idToIndex[R]].children.push(b.id):(T[++N]=b.id,P.push(b.id))}for(l.graphSet.push(P);C<=N;){var O=T[C++],B=l.idToIndex[O],y=l.layoutNodes[B],I=y.children;if(I.length>0){l.graphSet.push(I);for(var d=0;d<I.length;d++)T[++N]=I[d]}}for(var d=0;d<l.graphSet.length;d++)for(var z=l.graphSet[d],v=0;v<z.length;v++){var V=l.idToIndex[z[v]];l.indexToGraph[V]=d}for(var d=0;d<l.edgeSize;d++){var $=a[d],Y={};Y.id=$.data("id"),Y.sourceId=$.data("source"),Y.targetId=$.data("target");var D=zn(i.idealEdgeLength)?i.idealEdgeLength($):i.idealEdgeLength,q=zn(i.edgeElasticity)?i.edgeElasticity($):i.edgeElasticity,G=l.idToIndex[Y.sourceId],Z=l.idToIndex[Y.targetId],Q=l.indexToGraph[G],J=l.indexToGraph[Z];if(Q!=J){for(var ie=f7(Y.sourceId,Y.targetId,l),ne=l.graphSet[ie],W=0,k=l.layoutNodes[G];ne.indexOf(k.id)===-1;)k=l.layoutNodes[l.idToIndex[k.parentId]],W++;for(k=l.layoutNodes[Z];ne.indexOf(k.id)===-1;)k=l.layoutNodes[l.idToIndex[k.parentId]],W++;D*=W*i.nestingFactor}Y.idealLength=D,Y.elasticity=q,l.layoutEdges.push(Y)}return l},f7=function(e,n,i){var a=PP(e,n,0,i);return 2>a.count?0:a.graph},PP=function(e,n,i,a){var s=a.graphSet[i];if(-1<s.indexOf(e)&&-1<s.indexOf(n))return{count:2,graph:i};for(var o=0,l=0;l<s.length;l++){var u=s[l],c=a.idToIndex[u],d=a.layoutNodes[c].children;if(d.length!==0){var p=a.indexToGraph[a.idToIndex[d[0]]],v=PP(e,n,p,a);if(v.count!==0)if(v.count===1){if(o++,o===2)break}else return v}}return{count:o,graph:i}},p7,m7=function(e,n){for(var i=e.clientWidth,a=e.clientHeight,s=0;s<e.nodeSize;s++){var o=e.layoutNodes[s];o.children.length===0&&!o.isLocked&&(o.positionX=Math.random()*i,o.positionY=Math.random()*a)}},MP=function(e,n,i){var a=e.boundingBox,s={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return n.boundingBox&&(i.forEach(function(o){var l=e.layoutNodes[e.idToIndex[o.data("id")]];s.x1=Math.min(s.x1,l.positionX),s.x2=Math.max(s.x2,l.positionX),s.y1=Math.min(s.y1,l.positionY),s.y2=Math.max(s.y2,l.positionY)}),s.w=s.x2-s.x1,s.h=s.y2-s.y1),function(o,l){var u=e.layoutNodes[e.idToIndex[o.data("id")]];if(n.boundingBox){var c=s.w===0?.5:(u.positionX-s.x1)/s.w,d=s.h===0?.5:(u.positionY-s.y1)/s.h;return{x:a.x1+c*a.w,y:a.y1+d*a.h}}else return{x:u.positionX,y:u.positionY}}},g7=function(e,n,i){var a=i.layout,s=i.eles.nodes(),o=MP(e,i,s);s.positions(o),e.ready!==!0&&(e.ready=!0,a.one("layoutready",i.ready),a.emit({type:"layoutready",layout:this}))},v7=function(e,n,i){y7(e,n),w7(e),_7(e,n),S7(e),k7(e)},y7=function(e,n){for(var i=0;i<e.graphSet.length;i++)for(var a=e.graphSet[i],s=a.length,o=0;o<s;o++)for(var l=e.layoutNodes[e.idToIndex[a[o]]],u=o+1;u<s;u++){var c=e.layoutNodes[e.idToIndex[a[u]]];x7(l,c,e,n)}},rN=function(e){return-1+2*e*Math.random()},x7=function(e,n,i,a){var s=e.cmptId,o=n.cmptId;if(!(s!==o&&!i.isCompound)){var l=n.positionX-e.positionX,u=n.positionY-e.positionY,c=1;l===0&&u===0&&(l=rN(c),u=rN(c));var d=b7(e,n,l,u);if(d>0)var p=a.nodeOverlap*d,v=Math.sqrt(l*l+u*u),y=p*l/v,b=p*u/v;else var S=fy(e,l,u),k=fy(n,-1*l,-1*u),T=k.x-S.x,C=k.y-S.y,N=T*T+C*C,v=Math.sqrt(N),p=(e.nodeRepulsion+n.nodeRepulsion)/N,y=p*T/v,b=p*C/v;e.isLocked||(e.offsetX-=y,e.offsetY-=b),n.isLocked||(n.offsetX+=y,n.offsetY+=b)}},b7=function(e,n,i,a){if(i>0)var s=e.maxX-n.minX;else var s=n.maxX-e.minX;if(a>0)var o=e.maxY-n.minY;else var o=n.maxY-e.minY;return s>=0&&o>=0?Math.sqrt(s*s+o*o):0},fy=function(e,n,i){var a=e.positionX,s=e.positionY,o=e.height||1,l=e.width||1,u=i/n,c=o/l,d={};return n===0&&0<i||n===0&&0>i?(d.x=a,d.y=s+o/2,d):0<n&&-1*c<=u&&u<=c?(d.x=a+l/2,d.y=s+l*i/2/n,d):0>n&&-1*c<=u&&u<=c?(d.x=a-l/2,d.y=s-l*i/2/n,d):0<i&&(u<=-1*c||u>=c)?(d.x=a+o*n/2/i,d.y=s+o/2,d):(0>i&&(u<=-1*c||u>=c)&&(d.x=a-o*n/2/i,d.y=s-o/2),d)},w7=function(e,n){for(var i=0;i<e.edgeSize;i++){var a=e.layoutEdges[i],s=e.idToIndex[a.sourceId],o=e.layoutNodes[s],l=e.idToIndex[a.targetId],u=e.layoutNodes[l],c=u.positionX-o.positionX,d=u.positionY-o.positionY;if(!(c===0&&d===0)){var p=fy(o,c,d),v=fy(u,-1*c,-1*d),y=v.x-p.x,b=v.y-p.y,S=Math.sqrt(y*y+b*b),k=Math.pow(a.idealLength-S,2)/a.elasticity;if(S!==0)var T=k*y/S,C=k*b/S;else var T=0,C=0;o.isLocked||(o.offsetX+=T,o.offsetY+=C),u.isLocked||(u.offsetX-=T,u.offsetY-=C)}}},_7=function(e,n){if(n.gravity!==0)for(var i=1,a=0;a<e.graphSet.length;a++){var s=e.graphSet[a],o=s.length;if(a===0)var l=e.clientHeight/2,u=e.clientWidth/2;else var c=e.layoutNodes[e.idToIndex[s[0]]],d=e.layoutNodes[e.idToIndex[c.parentId]],l=d.positionX,u=d.positionY;for(var p=0;p<o;p++){var v=e.layoutNodes[e.idToIndex[s[p]]];if(!v.isLocked){var y=l-v.positionX,b=u-v.positionY,S=Math.sqrt(y*y+b*b);if(S>i){var k=n.gravity*y/S,T=n.gravity*b/S;v.offsetX+=k,v.offsetY+=T}}}}},S7=function(e,n){var i=[],a=0,s=-1;for(i.push.apply(i,e.graphSet[0]),s+=e.graphSet[0].length;a<=s;){var o=i[a++],l=e.idToIndex[o],u=e.layoutNodes[l],c=u.children;if(0<c.length&&!u.isLocked){for(var d=u.offsetX,p=u.offsetY,v=0;v<c.length;v++){var y=e.layoutNodes[e.idToIndex[c[v]]];y.offsetX+=d,y.offsetY+=p,i[++s]=c[v]}u.offsetX=0,u.offsetY=0}}},k7=function(e,n){for(var i=0;i<e.nodeSize;i++){var a=e.layoutNodes[i];0<a.children.length&&(a.maxX=void 0,a.minX=void 0,a.maxY=void 0,a.minY=void 0)}for(var i=0;i<e.nodeSize;i++){var a=e.layoutNodes[i];if(!(0<a.children.length||a.isLocked)){var s=C7(a.offsetX,a.offsetY,e.temperature);a.positionX+=s.x,a.positionY+=s.y,a.offsetX=0,a.offsetY=0,a.minX=a.positionX-a.width,a.maxX=a.positionX+a.width,a.minY=a.positionY-a.height,a.maxY=a.positionY+a.height,AP(a,e)}}for(var i=0;i<e.nodeSize;i++){var a=e.layoutNodes[i];0<a.children.length&&!a.isLocked&&(a.positionX=(a.maxX+a.minX)/2,a.positionY=(a.maxY+a.minY)/2,a.width=a.maxX-a.minX,a.height=a.maxY-a.minY)}},C7=function(e,n,i){var a=Math.sqrt(e*e+n*n);if(a>i)var s={x:i*e/a,y:i*n/a};else var s={x:e,y:n};return s},AP=function(e,n){var i=e.parentId;if(i!=null){var a=n.layoutNodes[n.idToIndex[i]],s=!1;if((a.maxX==null||e.maxX+a.padRight>a.maxX)&&(a.maxX=e.maxX+a.padRight,s=!0),(a.minX==null||e.minX-a.padLeft<a.minX)&&(a.minX=e.minX-a.padLeft,s=!0),(a.maxY==null||e.maxY+a.padBottom>a.maxY)&&(a.maxY=e.maxY+a.padBottom,s=!0),(a.minY==null||e.minY-a.padTop<a.minY)&&(a.minY=e.minY-a.padTop,s=!0),s)return AP(a,n)}},nN=function(e,n){for(var i=e.layoutNodes,a=[],s=0;s<i.length;s++){var o=i[s],l=o.cmptId,u=a[l]=a[l]||[];u.push(o)}for(var c=0,s=0;s<a.length;s++){var d=a[s];if(d){d.x1=1/0,d.x2=-1/0,d.y1=1/0,d.y2=-1/0;for(var p=0;p<d.length;p++){var v=d[p];d.x1=Math.min(d.x1,v.positionX-v.width/2),d.x2=Math.max(d.x2,v.positionX+v.width/2),d.y1=Math.min(d.y1,v.positionY-v.height/2),d.y2=Math.max(d.y2,v.positionY+v.height/2)}d.w=d.x2-d.x1,d.h=d.y2-d.y1,c+=d.w*d.h}}a.sort(function(C,N){return N.w*N.h-C.w*C.h});for(var y=0,b=0,S=0,k=0,T=Math.sqrt(c)*e.clientWidth/e.clientHeight,s=0;s<a.length;s++){var d=a[s];if(d){for(var p=0;p<d.length;p++){var v=d[p];v.isLocked||(v.positionX+=y-d.x1,v.positionY+=b-d.y1)}y+=d.w+n.componentSpacing,S+=d.w+n.componentSpacing,k=Math.max(k,d.h),S>T&&(b+=k+n.componentSpacing,y=0,S=0,k=0)}}},E7={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function jP(r){this.options=Ht({},E7,r)}jP.prototype.run=function(){var r=this.options,e=r,n=r.cy,i=e.eles,a=i.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));var s=cs(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()});if(s.h===0||s.w===0)i.nodes().layoutPositions(this,e,function(ae){return{x:s.x1,y:s.y1}});else{var o=a.size(),l=Math.sqrt(o*s.h/s.w),u=Math.round(l),c=Math.round(s.w/s.h*l),d=function(he){if(he==null)return Math.min(u,c);var ve=Math.min(u,c);ve==u?u=he:c=he},p=function(he){if(he==null)return Math.max(u,c);var ve=Math.max(u,c);ve==u?u=he:c=he},v=e.rows,y=e.cols!=null?e.cols:e.columns;if(v!=null&&y!=null)u=v,c=y;else if(v!=null&&y==null)u=v,c=Math.ceil(o/u);else if(v==null&&y!=null)c=y,u=Math.ceil(o/c);else if(c*u>o){var b=d(),S=p();(b-1)*S>=o?d(b-1):(S-1)*b>=o&&p(S-1)}else for(;c*u<o;){var k=d(),T=p();(T+1)*k>=o?p(T+1):d(k+1)}var C=s.w/c,N=s.h/u;if(e.condense&&(C=0,N=0),e.avoidOverlap)for(var P=0;P<a.length;P++){var R=a[P],O=R._private.position;(O.x==null||O.y==null)&&(O.x=0,O.y=0);var B=R.layoutDimensions(e),I=e.avoidOverlapPadding,z=B.w+I,V=B.h+I;C=Math.max(C,z),N=Math.max(N,V)}for(var $={},Y=function(he,ve){return!!$["c-"+he+"-"+ve]},D=function(he,ve){$["c-"+he+"-"+ve]=!0},q=0,G=0,Z=function(){G++,G>=c&&(G=0,q++)},Q={},J=0;J<a.length;J++){var ie=a[J],ne=e.position(ie);if(ne&&(ne.row!==void 0||ne.col!==void 0)){var W={row:ne.row,col:ne.col};if(W.col===void 0)for(W.col=0;Y(W.row,W.col);)W.col++;else if(W.row===void 0)for(W.row=0;Y(W.row,W.col);)W.row++;Q[ie.id()]=W,D(W.row,W.col)}}var re=function(he,ve){var xe,se;if(he.locked()||he.isParent())return!1;var ge=Q[he.id()];if(ge)xe=ge.col*C+C/2+s.x1,se=ge.row*N+N/2+s.y1;else{for(;Y(q,G);)Z();xe=G*C+C/2+s.x1,se=q*N+N/2+s.y1,D(q,G),Z()}return{x:xe,y:se}};a.layoutPositions(this,e,re)}return this};var N7={ready:function(){},stop:function(){}};function W_(r){this.options=Ht({},N7,r)}W_.prototype.run=function(){var r=this.options,e=r.eles,n=this;return r.cy,n.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),n.one("layoutready",r.ready),n.emit("layoutready"),n.one("layoutstop",r.stop),n.emit("layoutstop"),this};W_.prototype.stop=function(){return this};var T7={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function RP(r){this.options=Ht({},T7,r)}RP.prototype.run=function(){var r=this.options,e=r.eles,n=e.nodes(),i=zn(r.positions);function a(s){if(r.positions==null)return YO(s.position());if(i)return r.positions(s);var o=r.positions[s._private.data.id];return o??null}return n.layoutPositions(this,r,function(s,o){var l=a(s);return s.locked()||l==null?!1:l}),this};var P7={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,n){return!0},ready:void 0,stop:void 0,transform:function(e,n){return n}};function LP(r){this.options=Ht({},P7,r)}LP.prototype.run=function(){var r=this.options,e=r.cy,n=r.eles,i=cs(r.boundingBox?r.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),a=function(o,l){return{x:i.x1+Math.round(Math.random()*i.w),y:i.y1+Math.round(Math.random()*i.h)}};return n.nodes().layoutPositions(this,r,a),this};var M7=[{name:"breadthfirst",impl:EP},{name:"circle",impl:NP},{name:"concentric",impl:TP},{name:"cose",impl:Tx},{name:"grid",impl:jP},{name:"null",impl:W_},{name:"preset",impl:RP},{name:"random",impl:LP}];function OP(r){this.options=r,this.notifications=0}var iN=function(){},aN=function(){throw new Error("A headless instance can not render images")};OP.prototype={recalculateRenderedStyle:iN,notify:function(){this.notifications++},init:iN,isHeadless:function(){return!0},png:aN,jpg:aN};var $_={};$_.arrowShapeWidth=.3;$_.registerArrowShapes=function(){var r=this.arrowShapes={},e=this,n=function(c,d,p,v,y,b,S){var k=y.x-p/2-S,T=y.x+p/2+S,C=y.y-p/2-S,N=y.y+p/2+S,P=k<=c&&c<=T&&C<=d&&d<=N;return P},i=function(c,d,p,v,y){var b=c*Math.cos(v)-d*Math.sin(v),S=c*Math.sin(v)+d*Math.cos(v),k=b*p,T=S*p,C=k+y.x,N=T+y.y;return{x:C,y:N}},a=function(c,d,p,v){for(var y=[],b=0;b<c.length;b+=2){var S=c[b],k=c[b+1];y.push(i(S,k,d,p,v))}return y},s=function(c){for(var d=[],p=0;p<c.length;p++){var v=c[p];d.push(v.x,v.y)}return d},o=function(c){return c.pstyle("width").pfValue*c.pstyle("arrow-scale").pfValue*2},l=function(c,d){Dt(d)&&(d=r[d]),r[c]=Ht({name:c,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(v,y,b,S,k,T){var C=s(a(this.points,b+2*T,S,k)),N=Ms(v,y,C);return N},roughCollide:n,draw:function(v,y,b,S){var k=a(this.points,y,b,S);e.arrowShapeImpl("polygon")(v,k)},spacing:function(v){return 0},gap:o},d)};l("none",{collide:oy,roughCollide:oy,draw:j_,spacing:xC,gap:xC}),l("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),l("arrow","triangle"),l("triangle-backcurve",{points:r.triangle.points,controlPoint:[0,-.15],roughCollide:n,draw:function(c,d,p,v,y){var b=a(this.points,d,p,v),S=this.controlPoint,k=i(S[0],S[1],d,p,v);e.arrowShapeImpl(this.name)(c,b,k)},gap:function(c){return o(c)*.8}}),l("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(c,d,p,v,y,b,S){var k=s(a(this.points,p+2*S,v,y)),T=s(a(this.pointsTee,p+2*S,v,y)),C=Ms(c,d,k)||Ms(c,d,T);return C},draw:function(c,d,p,v,y){var b=a(this.points,d,p,v),S=a(this.pointsTee,d,p,v);e.arrowShapeImpl(this.name)(c,b,S)}}),l("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(c,d,p,v,y,b,S){var k=y,T=Math.pow(k.x-c,2)+Math.pow(k.y-d,2)<=Math.pow((p+2*S)*this.radius,2),C=s(a(this.points,p+2*S,v,y));return Ms(c,d,C)||T},draw:function(c,d,p,v,y){var b=a(this.pointsTr,d,p,v);e.arrowShapeImpl(this.name)(c,b,v.x,v.y,this.radius*d)},spacing:function(c){return e.getArrowWidth(c.pstyle("width").pfValue,c.pstyle("arrow-scale").value)*this.radius}}),l("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(c,d){var p=this.baseCrossLinePts.slice(),v=d/c,y=3,b=5;return p[y]=p[y]-v,p[b]=p[b]-v,p},collide:function(c,d,p,v,y,b,S){var k=s(a(this.points,p+2*S,v,y)),T=s(a(this.crossLinePts(p,b),p+2*S,v,y)),C=Ms(c,d,k)||Ms(c,d,T);return C},draw:function(c,d,p,v,y){var b=a(this.points,d,p,v),S=a(this.crossLinePts(d,y),d,p,v);e.arrowShapeImpl(this.name)(c,b,S)}}),l("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(c){return o(c)*.525}}),l("circle",{radius:.15,collide:function(c,d,p,v,y,b,S){var k=y,T=Math.pow(k.x-c,2)+Math.pow(k.y-d,2)<=Math.pow((p+2*S)*this.radius,2);return T},draw:function(c,d,p,v,y){e.arrowShapeImpl(this.name)(c,v.x,v.y,this.radius*d)},spacing:function(c){return e.getArrowWidth(c.pstyle("width").pfValue,c.pstyle("arrow-scale").value)*this.radius}}),l("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(c){return 1},gap:function(c){return 1}}),l("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),l("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(c){return c.pstyle("width").pfValue*c.pstyle("arrow-scale").value}}),l("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(c){return .95*c.pstyle("width").pfValue*c.pstyle("arrow-scale").value}})};var Yh={};Yh.projectIntoViewport=function(r,e){var n=this.cy,i=this.findContainerClientCoords(),a=i[0],s=i[1],o=i[4],l=n.pan(),u=n.zoom(),c=((r-a)/o-l.x)/u,d=((e-s)/o-l.y)/u;return[c,d]};Yh.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var r=this.container,e=r.getBoundingClientRect(),n=this.cy.window().getComputedStyle(r),i=function(T){return parseFloat(n.getPropertyValue(T))},a={left:i("padding-left"),right:i("padding-right"),top:i("padding-top"),bottom:i("padding-bottom")},s={left:i("border-left-width"),right:i("border-right-width"),top:i("border-top-width"),bottom:i("border-bottom-width")},o=r.clientWidth,l=r.clientHeight,u=a.left+a.right,c=a.top+a.bottom,d=s.left+s.right,p=e.width/(o+d),v=o-u,y=l-c,b=e.left+a.left+s.left,S=e.top+a.top+s.top;return this.containerBB=[b,S,v,y,p]};Yh.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Yh.findNearestElement=function(r,e,n,i){return this.findNearestElements(r,e,n,i)[0]};Yh.findNearestElements=function(r,e,n,i){var a=this,s=this,o=s.getCachedZSortedEles(),l=[],u=s.cy.zoom(),c=s.cy.hasCompoundNodes(),d=(i?24:8)/u,p=(i?8:2)/u,v=(i?8:2)/u,y=1/0,b,S;n&&(o=o.interactive);function k(B,I){if(B.isNode()){if(S)return;S=B,l.push(B)}if(B.isEdge()&&(I==null||I<y))if(b){if(b.pstyle("z-compound-depth").value===B.pstyle("z-compound-depth").value&&b.pstyle("z-compound-depth").value===B.pstyle("z-compound-depth").value){for(var z=0;z<l.length;z++)if(l[z].isEdge()){l[z]=B,b=B,y=I??y;break}}}else l.push(B),b=B,y=I??y}function T(B){var I=B.outerWidth()+2*p,z=B.outerHeight()+2*p,V=I/2,$=z/2,Y=B.position(),D=B.pstyle("corner-radius").value==="auto"?"auto":B.pstyle("corner-radius").pfValue,q=B._private.rscratch;if(Y.x-V<=r&&r<=Y.x+V&&Y.y-$<=e&&e<=Y.y+$){var G=s.nodeShapes[a.getNodeShape(B)];if(G.checkPoint(r,e,0,I,z,Y.x,Y.y,D,q))return k(B,0),!0}}function C(B){var I=B._private,z=I.rscratch,V=B.pstyle("width").pfValue,$=B.pstyle("arrow-scale").value,Y=V/2+d,D=Y*Y,q=Y*2,J=I.source,ie=I.target,G;if(z.edgeType==="segments"||z.edgeType==="straight"||z.edgeType==="haystack"){for(var Z=z.allpts,Q=0;Q+3<Z.length;Q+=2)if(cD(r,e,Z[Q],Z[Q+1],Z[Q+2],Z[Q+3],q)&&D>(G=mD(r,e,Z[Q],Z[Q+1],Z[Q+2],Z[Q+3])))return k(B,G),!0}else if(z.edgeType==="bezier"||z.edgeType==="multibezier"||z.edgeType==="self"||z.edgeType==="compound"){for(var Z=z.allpts,Q=0;Q+5<z.allpts.length;Q+=4)if(dD(r,e,Z[Q],Z[Q+1],Z[Q+2],Z[Q+3],Z[Q+4],Z[Q+5],q)&&D>(G=pD(r,e,Z[Q],Z[Q+1],Z[Q+2],Z[Q+3],Z[Q+4],Z[Q+5])))return k(B,G),!0}for(var J=J||I.source,ie=ie||I.target,ne=a.getArrowWidth(V,$),W=[{name:"source",x:z.arrowStartX,y:z.arrowStartY,angle:z.srcArrowAngle},{name:"target",x:z.arrowEndX,y:z.arrowEndY,angle:z.tgtArrowAngle},{name:"mid-source",x:z.midX,y:z.midY,angle:z.midsrcArrowAngle},{name:"mid-target",x:z.midX,y:z.midY,angle:z.midtgtArrowAngle}],Q=0;Q<W.length;Q++){var re=W[Q],ae=s.arrowShapes[B.pstyle(re.name+"-arrow-shape").value],he=B.pstyle("width").pfValue;if(ae.roughCollide(r,e,ne,re.angle,{x:re.x,y:re.y},he,d)&&ae.collide(r,e,ne,re.angle,{x:re.x,y:re.y},he,d))return k(B),!0}c&&l.length>0&&(T(J),T(ie))}function N(B,I,z){return Ps(B,I,z)}function P(B,I){var z=B._private,V=v,$;I?$=I+"-":$="",B.boundingBox();var Y=z.labelBounds[I||"main"],D=B.pstyle($+"label").value,q=B.pstyle("text-events").strValue==="yes";if(!(!q||!D)){var G=N(z.rscratch,"labelX",I),Z=N(z.rscratch,"labelY",I),Q=N(z.rscratch,"labelAngle",I),J=B.pstyle($+"text-margin-x").pfValue,ie=B.pstyle($+"text-margin-y").pfValue,ne=Y.x1-V-J,W=Y.x2+V-J,re=Y.y1-V-ie,ae=Y.y2+V-ie;if(Q){var he=Math.cos(Q),ve=Math.sin(Q),xe=function(Se,Ue){return Se=Se-G,Ue=Ue-Z,{x:Se*he-Ue*ve+G,y:Se*ve+Ue*he+Z}},se=xe(ne,re),ge=xe(ne,ae),le=xe(W,re),pe=xe(W,ae),me=[se.x+J,se.y+ie,le.x+J,le.y+ie,pe.x+J,pe.y+ie,ge.x+J,ge.y+ie];if(Ms(r,e,me))return k(B),!0}else if(od(Y,r,e))return k(B),!0}}for(var R=o.length-1;R>=0;R--){var O=o[R];O.isNode()?T(O)||P(O):C(O)||P(O)||P(O,"source")||P(O,"target")}return l};Yh.getAllInBox=function(r,e,n,i){var a=this.getCachedZSortedEles().interactive,s=this.cy.zoom(),o=2/s,l=[],u=Math.min(r,n),c=Math.max(r,n),d=Math.min(e,i),p=Math.max(e,i);r=u,n=c,e=d,i=p;var v=cs({x1:r,y1:e,x2:n,y2:i}),y=[{x:v.x1,y:v.y1},{x:v.x2,y:v.y1},{x:v.x2,y:v.y2},{x:v.x1,y:v.y2}],b=[[y[0],y[1]],[y[1],y[2]],[y[2],y[3]],[y[3],y[0]]];function S(Se,Ue,We){return Ps(Se,Ue,We)}function k(Se,Ue){var We=Se._private,gt=o,Je="";Se.boundingBox();var at=We.labelBounds.main;if(!at)return null;var Ve=S(We.rscratch,"labelX",Ue),Oe=S(We.rscratch,"labelY",Ue),et=S(We.rscratch,"labelAngle",Ue),Ne=Se.pstyle(Je+"text-margin-x").pfValue,ze=Se.pstyle(Je+"text-margin-y").pfValue,Ke=at.x1-gt-Ne,ft=at.x2+gt-Ne,yt=at.y1-gt-ze,Et=at.y2+gt-ze;if(et){var Rt=Math.cos(et),$t=Math.sin(et),wt=function(qe,de){return qe=qe-Ve,de=de-Oe,{x:qe*Rt-de*$t+Ve,y:qe*$t+de*Rt+Oe}};return[wt(Ke,yt),wt(ft,yt),wt(ft,Et),wt(Ke,Et)]}else return[{x:Ke,y:yt},{x:ft,y:yt},{x:ft,y:Et},{x:Ke,y:Et}]}function T(Se,Ue,We,gt){function Je(at,Ve,Oe){return(Oe.y-at.y)*(Ve.x-at.x)>(Ve.y-at.y)*(Oe.x-at.x)}return Je(Se,We,gt)!==Je(Ue,We,gt)&&Je(Se,Ue,We)!==Je(Se,Ue,gt)}for(var C=0;C<a.length;C++){var N=a[C];if(N.isNode()){var P=N,R=P.pstyle("text-events").strValue==="yes",O=P.pstyle("box-selection").strValue,B=P.pstyle("box-select-labels").strValue==="yes";if(O==="none")continue;var I=(O==="overlap"||B)&&R,z=P.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:I});if(O==="contain"){var V=!1;if(B&&R){var $=k(P);$&&J1($,y)&&(l.push(P),V=!0)}!V&&U4(v,z)&&l.push(P)}else if(O==="overlap"&&D_(v,z)){var Y=P.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1}),D=[{x:Y.x1,y:Y.y1},{x:Y.x2,y:Y.y1},{x:Y.x2,y:Y.y2},{x:Y.x1,y:Y.y2}];if(J1(D,y))l.push(P);else{var q=k(P);q&&J1(q,y)&&l.push(P)}}}else{var G=N,Z=G._private,Q=Z.rscratch,J=G.pstyle("box-selection").strValue;if(J==="none")continue;if(J==="contain"){if(Q.startX!=null&&Q.startY!=null&&!od(v,Q.startX,Q.startY)||Q.endX!=null&&Q.endY!=null&&!od(v,Q.endX,Q.endY))continue;if(Q.edgeType==="bezier"||Q.edgeType==="multibezier"||Q.edgeType==="self"||Q.edgeType==="compound"||Q.edgeType==="segments"||Q.edgeType==="haystack"){for(var ie=Z.rstyle.bezierPts||Z.rstyle.linePts||Z.rstyle.haystackPts,ne=!0,W=0;W<ie.length;W++)if(!kC(v,ie[W])){ne=!1;break}ne&&l.push(G)}else Q.edgeType==="straight"&&l.push(G)}else if(J==="overlap"){var re=!1;if(Q.startX!=null&&Q.startY!=null&&Q.endX!=null&&Q.endY!=null&&(od(v,Q.startX,Q.startY)||od(v,Q.endX,Q.endY)))l.push(G),re=!0;else if(!re&&Q.edgeType==="haystack"){for(var ae=Z.rstyle.haystackPts,he=0;he<ae.length;he++)if(kC(v,ae[he])){l.push(G),re=!0;break}}if(!re){var ve=Z.rstyle.bezierPts||Z.rstyle.linePts||Z.rstyle.haystackPts;if((!ve||ve.length<2)&&Q.edgeType==="straight"&&Q.startX!=null&&Q.startY!=null&&Q.endX!=null&&Q.endY!=null&&(ve=[{x:Q.startX,y:Q.startY},{x:Q.endX,y:Q.endY}]),!ve||ve.length<2)continue;for(var xe=0;xe<ve.length-1;xe++){for(var se=ve[xe],ge=ve[xe+1],le=0;le<b.length;le++){var pe=xi(b[le],2),me=pe[0],be=pe[1];if(T(se,ge,me,be)){l.push(G),re=!0;break}}if(re)break}}}}}return l};var py={};py.calculateArrowAngles=function(r){var e=r._private.rscratch,n=e.edgeType==="haystack",i=e.edgeType==="bezier",a=e.edgeType==="multibezier",s=e.edgeType==="segments",o=e.edgeType==="compound",l=e.edgeType==="self",u,c,d,p,v,y,T,C;if(n?(d=e.haystackPts[0],p=e.haystackPts[1],v=e.haystackPts[2],y=e.haystackPts[3]):(d=e.arrowStartX,p=e.arrowStartY,v=e.arrowEndX,y=e.arrowEndY),T=e.midX,C=e.midY,s)u=d-e.segpts[0],c=p-e.segpts[1];else if(a||o||l||i){var b=e.allpts,S=$i(b[0],b[2],b[4],.1),k=$i(b[1],b[3],b[5],.1);u=d-S,c=p-k}else u=d-T,c=p-C;e.srcArrowAngle=a0(u,c);var T=e.midX,C=e.midY;if(n&&(T=(d+v)/2,C=(p+y)/2),u=v-d,c=y-p,s){var b=e.allpts;if(b.length/2%2===0){var N=b.length/2,P=N-2;u=b[N]-b[P],c=b[N+1]-b[P+1]}else if(e.isRound)u=e.midVector[1],c=-e.midVector[0];else{var N=b.length/2-1,P=N-2;u=b[N]-b[P],c=b[N+1]-b[P+1]}}else if(a||o||l){var b=e.allpts,R=e.ctrlpts,O,B,I,z;if(R.length/2%2===0){var V=b.length/2-1,$=V+2,Y=$+2;O=$i(b[V],b[$],b[Y],0),B=$i(b[V+1],b[$+1],b[Y+1],0),I=$i(b[V],b[$],b[Y],1e-4),z=$i(b[V+1],b[$+1],b[Y+1],1e-4)}else{var $=b.length/2-1,V=$-2,Y=$+2;O=$i(b[V],b[$],b[Y],.4999),B=$i(b[V+1],b[$+1],b[Y+1],.4999),I=$i(b[V],b[$],b[Y],.5),z=$i(b[V+1],b[$+1],b[Y+1],.5)}u=I-O,c=z-B}if(e.midtgtArrowAngle=a0(u,c),e.midDispX=u,e.midDispY=c,u*=-1,c*=-1,s){var b=e.allpts;if(b.length/2%2!==0){if(!e.isRound){var N=b.length/2-1,D=N+2;u=-(b[D]-b[N]),c=-(b[D+1]-b[N+1])}}}if(e.midsrcArrowAngle=a0(u,c),s)u=v-e.segpts[e.segpts.length-2],c=y-e.segpts[e.segpts.length-1];else if(a||o||l||i){var b=e.allpts,q=b.length,S=$i(b[q-6],b[q-4],b[q-2],.9),k=$i(b[q-5],b[q-3],b[q-1],.9);u=v-S,c=y-k}else u=v-T,c=y-C;e.tgtArrowAngle=a0(u,c)};py.getArrowWidth=py.getArrowHeight=function(r,e){var n=this.arrowWidthCache=this.arrowWidthCache||{},i=n[r+", "+e];return i||(i=Math.max(Math.pow(r*13.37,.9),29)*e,n[r+", "+e]=i,i)};var T2,P2,$l={},So={},sN,oN,wh,q0,Lu,fh,yh,Gl,Bf,f0,DP,IP,M2,A2,lN,uN=function(e,n,i){i.x=n.x-e.x,i.y=n.y-e.y,i.len=Math.sqrt(i.x*i.x+i.y*i.y),i.nx=i.x/i.len,i.ny=i.y/i.len,i.ang=Math.atan2(i.ny,i.nx)},A7=function(e,n){n.x=e.x*-1,n.y=e.y*-1,n.nx=e.nx*-1,n.ny=e.ny*-1,n.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},j7=function(e,n,i,a,s){if(e!==lN?uN(n,e,$l):A7(So,$l),uN(n,i,So),sN=$l.nx*So.ny-$l.ny*So.nx,oN=$l.nx*So.nx-$l.ny*-So.ny,Lu=Math.asin(Math.max(-1,Math.min(1,sN))),Math.abs(Lu)<1e-6){T2=n.x,P2=n.y,yh=Bf=0;return}wh=1,q0=!1,oN<0?Lu<0?Lu=Math.PI+Lu:(Lu=Math.PI-Lu,wh=-1,q0=!0):Lu>0&&(wh=-1,q0=!0),n.radius!==void 0?Bf=n.radius:Bf=a,fh=Lu/2,f0=Math.min($l.len/2,So.len/2),s?(Gl=Math.abs(Math.cos(fh)*Bf/Math.sin(fh)),Gl>f0?(Gl=f0,yh=Math.abs(Gl*Math.sin(fh)/Math.cos(fh))):yh=Bf):(Gl=Math.min(f0,Bf),yh=Math.abs(Gl*Math.sin(fh)/Math.cos(fh))),M2=n.x+So.nx*Gl,A2=n.y+So.ny*Gl,T2=M2-So.ny*yh*wh,P2=A2+So.nx*yh*wh,DP=n.x+$l.nx*Gl,IP=n.y+$l.ny*Gl,lN=n};function BP(r,e){e.radius===0?r.lineTo(e.cx,e.cy):r.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function K_(r,e,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return i===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(j7(r,e,n,i,a),{cx:T2,cy:P2,radius:yh,startX:DP,startY:IP,stopX:M2,stopY:A2,startAngle:$l.ang+Math.PI/2*wh,endAngle:So.ang-Math.PI/2*wh,counterClockwise:q0})}var Hg=.01,R7=Math.sqrt(2*Hg),$a={};$a.findMidptPtsEtc=function(r,e){var n=e.posPts,i=e.intersectionPts,a=e.vectorNormInverse,s,o=r.pstyle("source-endpoint"),l=r.pstyle("target-endpoint"),u=o.units!=null&&l.units!=null,c=function(R,O,B,I){var z=I-O,V=B-R,$=Math.sqrt(V*V+z*z);return{x:-z/$,y:V/$}},d=r.pstyle("edge-distances").value;switch(d){case"node-position":s=n;break;case"intersection":s=i;break;case"endpoints":{if(u){var p=this.manualEndptToPx(r.source()[0],o),v=xi(p,2),y=v[0],b=v[1],S=this.manualEndptToPx(r.target()[0],l),k=xi(S,2),T=k[0],C=k[1],N={x1:y,y1:b,x2:T,y2:C};a=c(y,b,T,C),s=N}else zr("Edge ".concat(r.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),s=i;break}}return{midptPts:s,vectorNormInverse:a}};$a.findHaystackPoints=function(r){for(var e=0;e<r.length;e++){var n=r[e],i=n._private,a=i.rscratch;if(!a.haystack){var s=Math.random()*2*Math.PI;a.source={x:Math.cos(s),y:Math.sin(s)},s=Math.random()*2*Math.PI,a.target={x:Math.cos(s),y:Math.sin(s)}}var o=i.source,l=i.target,u=o.position(),c=l.position(),d=o.width(),p=l.width(),v=o.height(),y=l.height(),b=n.pstyle("haystack-radius").value,S=b/2;a.haystackPts=a.allpts=[a.source.x*d*S+u.x,a.source.y*v*S+u.y,a.target.x*p*S+c.x,a.target.y*y*S+c.y],a.midX=(a.allpts[0]+a.allpts[2])/2,a.midY=(a.allpts[1]+a.allpts[3])/2,a.edgeType="haystack",a.haystack=!0,this.storeEdgeProjections(n),this.calculateArrowAngles(n),this.recalculateEdgeLabelProjections(n),this.calculateLabelAngles(n)}};$a.findSegmentsPoints=function(r,e){var n=r._private.rscratch,i=r.pstyle("segment-weights"),a=r.pstyle("segment-distances"),s=r.pstyle("segment-radii"),o=r.pstyle("radius-type"),l=Math.min(i.pfValue.length,a.pfValue.length),u=s.pfValue[s.pfValue.length-1],c=o.pfValue[o.pfValue.length-1];n.edgeType="segments",n.segpts=[],n.radii=[],n.isArcRadius=[];for(var d=0;d<l;d++){var p=i.pfValue[d],v=a.pfValue[d],y=1-p,b=p,S=this.findMidptPtsEtc(r,e),k=S.midptPts,T=S.vectorNormInverse,C={x:k.x1*y+k.x2*b,y:k.y1*y+k.y2*b};n.segpts.push(C.x+T.x*v,C.y+T.y*v),n.radii.push(s.pfValue[d]!==void 0?s.pfValue[d]:u),n.isArcRadius.push((o.pfValue[d]!==void 0?o.pfValue[d]:c)==="arc-radius")}};$a.findLoopPoints=function(r,e,n,i){var a=r._private.rscratch,s=e.dirCounts,o=e.srcPos,l=r.pstyle("control-point-distances"),u=l?l.pfValue[0]:void 0,c=r.pstyle("loop-direction").pfValue,d=r.pstyle("loop-sweep").pfValue,p=r.pstyle("control-point-step-size").pfValue;a.edgeType="self";var v=n,y=p;i&&(v=0,y=u);var b=c-Math.PI/2,S=b-d/2,k=b+d/2,T=c+"_"+d;v=s[T]===void 0?s[T]=0:++s[T],a.ctrlpts=[o.x+Math.cos(S)*1.4*y*(v/3+1),o.y+Math.sin(S)*1.4*y*(v/3+1),o.x+Math.cos(k)*1.4*y*(v/3+1),o.y+Math.sin(k)*1.4*y*(v/3+1)]};$a.findCompoundLoopPoints=function(r,e,n,i){var a=r._private.rscratch;a.edgeType="compound";var s=e.srcPos,o=e.tgtPos,l=e.srcW,u=e.srcH,c=e.tgtW,d=e.tgtH,p=r.pstyle("control-point-step-size").pfValue,v=r.pstyle("control-point-distances"),y=v?v.pfValue[0]:void 0,b=n,S=p;i&&(b=0,S=y);var k=50,T={x:s.x-l/2,y:s.y-u/2},C={x:o.x-c/2,y:o.y-d/2},N={x:Math.min(T.x,C.x),y:Math.min(T.y,C.y)},P=.5,R=Math.max(P,Math.log(l*Hg)),O=Math.max(P,Math.log(c*Hg));a.ctrlpts=[N.x,N.y-(1+Math.pow(k,1.12)/100)*S*(b/3+1)*R,N.x-(1+Math.pow(k,1.12)/100)*S*(b/3+1)*O,N.y]};$a.findStraightEdgePoints=function(r){r._private.rscratch.edgeType="straight"};$a.findBezierPoints=function(r,e,n,i,a){var s=r._private.rscratch,o=r.pstyle("control-point-step-size").pfValue,l=r.pstyle("control-point-distances"),u=r.pstyle("control-point-weights"),c=l&&u?Math.min(l.value.length,u.value.length):1,d=l?l.pfValue[0]:void 0,p=u.value[0],v=i;s.edgeType=v?"multibezier":"bezier",s.ctrlpts=[];for(var y=0;y<c;y++){var b=(.5-e.eles.length/2+n)*o*(a?-1:1),S=void 0,k=O_(b);v&&(d=l?l.pfValue[y]:o,p=u.value[y]),i?S=d:S=d!==void 0?k*d:void 0;var T=S!==void 0?S:b,C=1-p,N=p,P=this.findMidptPtsEtc(r,e),R=P.midptPts,O=P.vectorNormInverse,B={x:R.x1*C+R.x2*N,y:R.y1*C+R.y2*N};s.ctrlpts.push(B.x+O.x*T,B.y+O.y*T)}};$a.findTaxiPoints=function(r,e){var n=r._private.rscratch;n.edgeType="segments";var i="vertical",a="horizontal",s="leftward",o="rightward",l="downward",u="upward",c="auto",d=e.posPts,p=e.srcW,v=e.srcH,y=e.tgtW,b=e.tgtH,S=r.pstyle("edge-distances").value,k=S!=="node-position",T=r.pstyle("taxi-direction").value,C=T,N=r.pstyle("taxi-turn"),P=N.units==="%",R=N.pfValue,O=R<0,B=r.pstyle("taxi-turn-min-distance").pfValue,I=k?(p+y)/2:0,z=k?(v+b)/2:0,V=d.x2-d.x1,$=d.y2-d.y1,Y=function(de,ye){return de>0?Math.max(de-ye,0):Math.min(de+ye,0)},D=Y(V,I),q=Y($,z),G=!1;C===c?T=Math.abs(D)>Math.abs(q)?a:i:C===u||C===l?(T=i,G=!0):(C===s||C===o)&&(T=a,G=!0);var Z=T===i,Q=Z?q:D,J=Z?$:V,ie=O_(J),ne=!1;!(G&&(P||O))&&(C===l&&J<0||C===u&&J>0||C===s&&J>0||C===o&&J<0)&&(ie*=-1,Q=ie*Math.abs(Q),ne=!0);var W;if(P){var re=R<0?1+R:R;W=re*Q}else{var ae=R<0?Q:0;W=ae+R*ie}var he=function(de){return Math.abs(de)<B||Math.abs(de)>=Math.abs(Q)},ve=he(W),xe=he(Math.abs(Q)-Math.abs(W)),se=ve||xe;if(se&&!ne)if(Z){var ge=Math.abs(J)<=v/2,le=Math.abs(V)<=y/2;if(ge){var pe=(d.x1+d.x2)/2,me=d.y1,be=d.y2;n.segpts=[pe,me,pe,be]}else if(le){var Se=(d.y1+d.y2)/2,Ue=d.x1,We=d.x2;n.segpts=[Ue,Se,We,Se]}else n.segpts=[d.x1,d.y2]}else{var gt=Math.abs(J)<=p/2,Je=Math.abs($)<=b/2;if(gt){var at=(d.y1+d.y2)/2,Ve=d.x1,Oe=d.x2;n.segpts=[Ve,at,Oe,at]}else if(Je){var et=(d.x1+d.x2)/2,Ne=d.y1,ze=d.y2;n.segpts=[et,Ne,et,ze]}else n.segpts=[d.x2,d.y1]}else if(Z){var Ke=d.y1+W+(k?v/2*ie:0),ft=d.x1,yt=d.x2;n.segpts=[ft,Ke,yt,Ke]}else{var Et=d.x1+W+(k?p/2*ie:0),Rt=d.y1,$t=d.y2;n.segpts=[Et,Rt,Et,$t]}if(n.isRound){var wt=r.pstyle("taxi-radius").value,ot=r.pstyle("radius-type").value[0]==="arc-radius";n.radii=new Array(n.segpts.length/2).fill(wt),n.isArcRadius=new Array(n.segpts.length/2).fill(ot)}};$a.tryToCorrectInvalidPoints=function(r,e){var n=r._private.rscratch;if(n.edgeType==="bezier"){var i=e.srcPos,a=e.tgtPos,s=e.srcW,o=e.srcH,l=e.tgtW,u=e.tgtH,c=e.srcShape,d=e.tgtShape,p=e.srcCornerRadius,v=e.tgtCornerRadius,y=e.srcRs,b=e.tgtRs,S=!ht(n.startX)||!ht(n.startY),k=!ht(n.arrowStartX)||!ht(n.arrowStartY),T=!ht(n.endX)||!ht(n.endY),C=!ht(n.arrowEndX)||!ht(n.arrowEndY),N=3,P=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth,R=N*P,O=Ih({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.startX,y:n.startY}),B=O<R,I=Ih({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.endX,y:n.endY}),z=I<R,V=!1;if(S||k||B){V=!0;var $={x:n.ctrlpts[0]-i.x,y:n.ctrlpts[1]-i.y},Y=Math.sqrt($.x*$.x+$.y*$.y),D={x:$.x/Y,y:$.y/Y},q=Math.max(s,o),G={x:n.ctrlpts[0]+D.x*2*q,y:n.ctrlpts[1]+D.y*2*q},Z=c.intersectLine(i.x,i.y,s,o,G.x,G.y,0,p,y);B?(n.ctrlpts[0]=n.ctrlpts[0]+D.x*(R-O),n.ctrlpts[1]=n.ctrlpts[1]+D.y*(R-O)):(n.ctrlpts[0]=Z[0]+D.x*R,n.ctrlpts[1]=Z[1]+D.y*R)}if(T||C||z){V=!0;var Q={x:n.ctrlpts[0]-a.x,y:n.ctrlpts[1]-a.y},J=Math.sqrt(Q.x*Q.x+Q.y*Q.y),ie={x:Q.x/J,y:Q.y/J},ne=Math.max(s,o),W={x:n.ctrlpts[0]+ie.x*2*ne,y:n.ctrlpts[1]+ie.y*2*ne},re=d.intersectLine(a.x,a.y,l,u,W.x,W.y,0,v,b);z?(n.ctrlpts[0]=n.ctrlpts[0]+ie.x*(R-I),n.ctrlpts[1]=n.ctrlpts[1]+ie.y*(R-I)):(n.ctrlpts[0]=re[0]+ie.x*R,n.ctrlpts[1]=re[1]+ie.y*R)}V&&this.findEndpoints(r)}};$a.storeAllpts=function(r){var e=r._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var n=0;n+1<e.ctrlpts.length;n+=2)e.allpts.push(e.ctrlpts[n],e.ctrlpts[n+1]),n+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[n]+e.ctrlpts[n+2])/2,(e.ctrlpts[n+1]+e.ctrlpts[n+3])/2);e.allpts.push(e.endX,e.endY);var i,a;e.ctrlpts.length/2%2===0?(i=e.allpts.length/2-1,e.midX=e.allpts[i],e.midY=e.allpts[i+1]):(i=e.allpts.length/2-3,a=.5,e.midX=$i(e.allpts[i],e.allpts[i+2],e.allpts[i+4],a),e.midY=$i(e.allpts[i+1],e.allpts[i+3],e.allpts[i+5],a))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var s=2;s+3<e.allpts.length;s+=2){var o=e.radii[s/2-1],l=e.isArcRadius[s/2-1];e.roundCorners.push(K_({x:e.allpts[s-2],y:e.allpts[s-1]},{x:e.allpts[s],y:e.allpts[s+1],radius:o},{x:e.allpts[s+2],y:e.allpts[s+3]},o,l))}}if(e.segpts.length%4===0){var u=e.segpts.length/2,c=u-2;e.midX=(e.segpts[c]+e.segpts[u])/2,e.midY=(e.segpts[c+1]+e.segpts[u+1])/2}else{var d=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[d],e.midY=e.segpts[d+1];else{var p={x:e.segpts[d],y:e.segpts[d+1]},v=e.roundCorners[d/2];if(v.radius===0){var y={x:e.segpts[d+2],y:e.segpts[d+3]};e.midX=p.x,e.midY=p.y,e.midVector=[p.y-y.y,y.x-p.x]}else{var b=[p.x-v.cx,p.y-v.cy],S=v.radius/Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2));b=b.map(function(k){return k*S}),e.midX=v.cx+b[0],e.midY=v.cy+b[1],e.midVector=b}}}}};$a.checkForInvalidEdgeWarning=function(r){var e=r[0]._private.rscratch;e.nodesOverlap||ht(e.startX)&&ht(e.startY)&&ht(e.endX)&&ht(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,zr("Edge `"+r.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};$a.findEdgeControlPoints=function(r){var e=this;if(!(!r||r.length===0)){for(var n=this,i=n.cy,a=i.hasCompoundNodes(),s=new Hu,o=function(z,V){return[].concat(iy(z),[V?1:0]).join("-")},l=[],u=[],c=0;c<r.length;c++){var d=r[c],p=d._private,v=d.pstyle("curve-style").value;if(!(d.removed()||!d.takesUpSpace())){if(v==="haystack"){u.push(d);continue}var y=v==="unbundled-bezier"||sd(v,"segments")||v==="straight"||v==="straight-triangle"||sd(v,"taxi"),b=v==="unbundled-bezier"||v==="bezier",S=p.source,k=p.target,T=S.poolIndex(),C=k.poolIndex(),N=[T,C].sort(),P=o(N,y),R=s.get(P);R==null&&(R={eles:[]},l.push({pairId:N,edgeIsUnbundled:y}),s.set(P,R)),R.eles.push(d),y&&(R.hasUnbundled=!0),b&&(R.hasBezier=!0)}}for(var O=function(){var z=l[B],V=z.pairId,$=z.edgeIsUnbundled,Y=o(V,$),D=s.get(Y),q;if(!D.hasUnbundled){var G=D.eles[0].parallelEdges().filter(function(ot){return ot.isBundledBezier()});R_(D.eles),G.forEach(function(ot){return D.eles.push(ot)}),D.eles.sort(function(ot,qe){return ot.poolIndex()-qe.poolIndex()})}var Z=D.eles[0],Q=Z.source(),J=Z.target();if(Q.poolIndex()>J.poolIndex()){var ie=Q;Q=J,J=ie}var ne=D.srcPos=Q.position(),W=D.tgtPos=J.position(),re=D.srcW=Q.outerWidth(),ae=D.srcH=Q.outerHeight(),he=D.tgtW=J.outerWidth(),ve=D.tgtH=J.outerHeight(),xe=D.srcShape=n.nodeShapes[e.getNodeShape(Q)],se=D.tgtShape=n.nodeShapes[e.getNodeShape(J)],ge=D.srcCornerRadius=Q.pstyle("corner-radius").value==="auto"?"auto":Q.pstyle("corner-radius").pfValue,le=D.tgtCornerRadius=J.pstyle("corner-radius").value==="auto"?"auto":J.pstyle("corner-radius").pfValue,pe=D.tgtRs=J._private.rscratch,me=D.srcRs=Q._private.rscratch;D.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var be=0;be<D.eles.length;be++){var Se=D.eles[be],Ue=Se[0]._private.rscratch,We=Se.pstyle("curve-style").value,gt=We==="unbundled-bezier"||sd(We,"segments")||sd(We,"taxi"),Je=!Q.same(Se.source());if(!D.calculatedIntersection&&Q!==J&&(D.hasBezier||D.hasUnbundled)){D.calculatedIntersection=!0;var at=xe.intersectLine(ne.x,ne.y,re,ae,W.x,W.y,0,ge,me),Ve=D.srcIntn=at,Oe=se.intersectLine(W.x,W.y,he,ve,ne.x,ne.y,0,le,pe),et=D.tgtIntn=Oe,Ne=D.intersectionPts={x1:at[0],x2:Oe[0],y1:at[1],y2:Oe[1]},ze=D.posPts={x1:ne.x,x2:W.x,y1:ne.y,y2:W.y},Ke=Oe[1]-at[1],ft=Oe[0]-at[0],yt=Math.sqrt(ft*ft+Ke*Ke);ht(yt)&&yt>=R7||(yt=Math.sqrt(Math.max(ft*ft,Hg)+Math.max(Ke*Ke,Hg)));var Et=D.vector={x:ft,y:Ke},Rt=D.vectorNorm={x:Et.x/yt,y:Et.y/yt},$t={x:-Rt.y,y:Rt.x};D.nodesOverlap=!ht(yt)||se.checkPoint(at[0],at[1],0,he,ve,W.x,W.y,le,pe)||xe.checkPoint(Oe[0],Oe[1],0,re,ae,ne.x,ne.y,ge,me),D.vectorNormInverse=$t,q={nodesOverlap:D.nodesOverlap,dirCounts:D.dirCounts,calculatedIntersection:!0,hasBezier:D.hasBezier,hasUnbundled:D.hasUnbundled,eles:D.eles,srcPos:W,srcRs:pe,tgtPos:ne,tgtRs:me,srcW:he,srcH:ve,tgtW:re,tgtH:ae,srcIntn:et,tgtIntn:Ve,srcShape:se,tgtShape:xe,posPts:{x1:ze.x2,y1:ze.y2,x2:ze.x1,y2:ze.y1},intersectionPts:{x1:Ne.x2,y1:Ne.y2,x2:Ne.x1,y2:Ne.y1},vector:{x:-Et.x,y:-Et.y},vectorNorm:{x:-Rt.x,y:-Rt.y},vectorNormInverse:{x:-$t.x,y:-$t.y}}}var wt=Je?q:D;Ue.nodesOverlap=wt.nodesOverlap,Ue.srcIntn=wt.srcIntn,Ue.tgtIntn=wt.tgtIntn,Ue.isRound=We.startsWith("round"),a&&(Q.isParent()||Q.isChild()||J.isParent()||J.isChild())&&(Q.parents().anySame(J)||J.parents().anySame(Q)||Q.same(J)&&Q.isParent())?e.findCompoundLoopPoints(Se,wt,be,gt):Q===J?e.findLoopPoints(Se,wt,be,gt):We.endsWith("segments")?e.findSegmentsPoints(Se,wt):We.endsWith("taxi")?e.findTaxiPoints(Se,wt):We==="straight"||!gt&&D.eles.length%2===1&&be===Math.floor(D.eles.length/2)?e.findStraightEdgePoints(Se):e.findBezierPoints(Se,wt,be,gt,Je),e.findEndpoints(Se),e.tryToCorrectInvalidPoints(Se,wt),e.checkForInvalidEdgeWarning(Se),e.storeAllpts(Se),e.storeEdgeProjections(Se),e.calculateArrowAngles(Se),e.recalculateEdgeLabelProjections(Se),e.calculateLabelAngles(Se)}},B=0;B<l.length;B++)O();this.findHaystackPoints(u)}};function zP(r){var e=[];if(r!=null){for(var n=0;n<r.length;n+=2){var i=r[n],a=r[n+1];e.push({x:i,y:a})}return e}}$a.getSegmentPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var n=e.edgeType;if(n==="segments")return zP(e.segpts)};$a.getControlPoints=function(r){var e=r[0]._private.rscratch;this.recalculateRenderedStyle(r);var n=e.edgeType;if(n==="bezier"||n==="multibezier"||n==="self"||n==="compound")return zP(e.ctrlpts)};$a.getEdgeMidpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),{x:e.midX,y:e.midY}};var mv={};mv.manualEndptToPx=function(r,e){var n=this,i=r.position(),a=r.outerWidth(),s=r.outerHeight(),o=r._private.rscratch;if(e.value.length===2){var l=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(l[0]=l[0]*a),e.units[1]==="%"&&(l[1]=l[1]*s),l[0]+=i.x,l[1]+=i.y,l}else{var u=e.pfValue[0];u=-Math.PI/2+u;var c=2*Math.max(a,s),d=[i.x+Math.cos(u)*c,i.y+Math.sin(u)*c];return n.nodeShapes[this.getNodeShape(r)].intersectLine(i.x,i.y,a,s,d[0],d[1],0,r.pstyle("corner-radius").value==="auto"?"auto":r.pstyle("corner-radius").pfValue,o)}};mv.findEndpoints=function(r){var e,n,i,a,s=this,o,l=r.source()[0],u=r.target()[0],c=l.position(),d=u.position(),p=r.pstyle("target-arrow-shape").value,v=r.pstyle("source-arrow-shape").value,y=r.pstyle("target-distance-from-node").pfValue,b=r.pstyle("source-distance-from-node").pfValue,S=l._private.rscratch,k=u._private.rscratch,T=r.pstyle("curve-style").value,C=r._private.rscratch,N=C.edgeType,P=sd(T,"taxi"),R=N==="self"||N==="compound",O=N==="bezier"||N==="multibezier"||R,B=N!=="bezier",I=N==="straight"||N==="segments",z=N==="segments",V=O||B||I,$=R||P,Y=r.pstyle("source-endpoint"),D=$?"outside-to-node":Y.value,q=l.pstyle("corner-radius").value==="auto"?"auto":l.pstyle("corner-radius").pfValue,G=r.pstyle("target-endpoint"),Z=$?"outside-to-node":G.value,Q=u.pstyle("corner-radius").value==="auto"?"auto":u.pstyle("corner-radius").pfValue;C.srcManEndpt=Y,C.tgtManEndpt=G;var J,ie,ne,W,re=(e=(G==null||(n=G.pfValue)===null||n===void 0?void 0:n.length)===2?G.pfValue:null)!==null&&e!==void 0?e:[0,0],ae=(i=(Y==null||(a=Y.pfValue)===null||a===void 0?void 0:a.length)===2?Y.pfValue:null)!==null&&i!==void 0?i:[0,0];if(O){var he=[C.ctrlpts[0],C.ctrlpts[1]],ve=B?[C.ctrlpts[C.ctrlpts.length-2],C.ctrlpts[C.ctrlpts.length-1]]:he;J=ve,ie=he}else if(I){var xe=z?C.segpts.slice(0,2):[d.x+re[0],d.y+re[1]],se=z?C.segpts.slice(C.segpts.length-2):[c.x+ae[0],c.y+ae[1]];J=se,ie=xe}if(Z==="inside-to-node")o=[d.x,d.y];else if(G.units)o=this.manualEndptToPx(u,G);else if(Z==="outside-to-line")o=C.tgtIntn;else if(Z==="outside-to-node"||Z==="outside-to-node-or-label"?ne=J:(Z==="outside-to-line"||Z==="outside-to-line-or-label")&&(ne=[c.x,c.y]),o=s.nodeShapes[this.getNodeShape(u)].intersectLine(d.x,d.y,u.outerWidth(),u.outerHeight(),ne[0],ne[1],0,Q,k),Z==="outside-to-node-or-label"||Z==="outside-to-line-or-label"){var ge=u._private.rscratch,le=ge.labelWidth,pe=ge.labelHeight,me=ge.labelX,be=ge.labelY,Se=le/2,Ue=pe/2,We=u.pstyle("text-valign").value;We==="top"?be-=Ue:We==="bottom"&&(be+=Ue);var gt=u.pstyle("text-halign").value;gt==="left"?me-=Se:gt==="right"&&(me+=Se);var Je=Bg(ne[0],ne[1],[me-Se,be-Ue,me+Se,be-Ue,me+Se,be+Ue,me-Se,be+Ue],d.x,d.y);if(Je.length>0){var at=c,Ve=vh(at,Jf(o)),Oe=vh(at,Jf(Je)),et=Ve;if(Oe<Ve&&(o=Je,et=Oe),Je.length>2){var Ne=vh(at,{x:Je[2],y:Je[3]});Ne<et&&(o=[Je[2],Je[3]])}}}var ze=s0(o,J,s.arrowShapes[p].spacing(r)+y),Ke=s0(o,J,s.arrowShapes[p].gap(r)+y);if(C.endX=Ke[0],C.endY=Ke[1],C.arrowEndX=ze[0],C.arrowEndY=ze[1],D==="inside-to-node")o=[c.x,c.y];else if(Y.units)o=this.manualEndptToPx(l,Y);else if(D==="outside-to-line")o=C.srcIntn;else if(D==="outside-to-node"||D==="outside-to-node-or-label"?W=ie:(D==="outside-to-line"||D==="outside-to-line-or-label")&&(W=[d.x,d.y]),o=s.nodeShapes[this.getNodeShape(l)].intersectLine(c.x,c.y,l.outerWidth(),l.outerHeight(),W[0],W[1],0,q,S),D==="outside-to-node-or-label"||D==="outside-to-line-or-label"){var ft=l._private.rscratch,yt=ft.labelWidth,Et=ft.labelHeight,Rt=ft.labelX,$t=ft.labelY,wt=yt/2,ot=Et/2,qe=l.pstyle("text-valign").value;qe==="top"?$t-=ot:qe==="bottom"&&($t+=ot);var de=l.pstyle("text-halign").value;de==="left"?Rt-=wt:de==="right"&&(Rt+=wt);var ye=Bg(W[0],W[1],[Rt-wt,$t-ot,Rt+wt,$t-ot,Rt+wt,$t+ot,Rt-wt,$t+ot],c.x,c.y);if(ye.length>0){var Ce=d,Te=vh(Ce,Jf(o)),Re=vh(Ce,Jf(ye)),Ze=Te;if(Re<Te&&(o=[ye[0],ye[1]],Ze=Re),ye.length>2){var Ge=vh(Ce,{x:ye[2],y:ye[3]});Ge<Ze&&(o=[ye[2],ye[3]])}}}var ct=s0(o,ie,s.arrowShapes[v].spacing(r)+b),ut=s0(o,ie,s.arrowShapes[v].gap(r)+b);C.startX=ut[0],C.startY=ut[1],C.arrowStartX=ct[0],C.arrowStartY=ct[1],V&&(!ht(C.startX)||!ht(C.startY)||!ht(C.endX)||!ht(C.endY)?C.badLine=!0:C.badLine=!1)};mv.getSourceEndpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),e.edgeType==="haystack"?{x:e.haystackPts[0],y:e.haystackPts[1]}:{x:e.arrowStartX,y:e.arrowStartY}};mv.getTargetEndpoint=function(r){var e=r[0]._private.rscratch;return this.recalculateRenderedStyle(r),e.edgeType==="haystack"?{x:e.haystackPts[2],y:e.haystackPts[3]}:{x:e.arrowEndX,y:e.arrowEndY}};var Z_={};function L7(r,e,n){for(var i=function(c,d,p,v){return $i(c,d,p,v)},a=e._private,s=a.rstyle.bezierPts,o=0;o<r.bezierProjPcts.length;o++){var l=r.bezierProjPcts[o];s.push({x:i(n[0],n[2],n[4],l),y:i(n[1],n[3],n[5],l)})}}Z_.storeEdgeProjections=function(r){var e=r._private,n=e.rscratch,i=n.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,i==="multibezier"||i==="bezier"||i==="self"||i==="compound"){e.rstyle.bezierPts=[];for(var a=0;a+5<n.allpts.length;a+=4)L7(this,r,n.allpts.slice(a,a+6))}else if(i==="segments")for(var s=e.rstyle.linePts=[],a=0;a+1<n.allpts.length;a+=2)s.push({x:n.allpts[a],y:n.allpts[a+1]});else if(i==="haystack"){var o=n.haystackPts;e.rstyle.haystackPts=[{x:o[0],y:o[1]},{x:o[2],y:o[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(r.pstyle("width").pfValue,r.pstyle("arrow-scale").value)*this.arrowShapeWidth};Z_.recalculateEdgeProjections=function(r){this.findEdgeControlPoints(r)};var su={};su.recalculateNodeLabelProjection=function(r){var e=r.pstyle("label").strValue;if(!bd(e)){var n,i,a=r._private,s=r.width(),o=r.height(),l=r.padding(),u=r.position(),c=r.pstyle("text-halign").strValue,d=r.pstyle("text-valign").strValue,p=a.rscratch,v=a.rstyle;switch(c){case"left":n=u.x-s/2-l;break;case"right":n=u.x+s/2+l;break;default:n=u.x}switch(d){case"top":i=u.y-o/2-l;break;case"bottom":i=u.y+o/2+l;break;default:i=u.y}p.labelX=n,p.labelY=i,v.labelX=n,v.labelY=i,this.calculateLabelAngles(r),this.applyLabelDimensions(r)}};var FP=function(e,n){var i=Math.atan(n/e);return e===0&&i<0&&(i=i*-1),i},VP=function(e,n){var i=n.x-e.x,a=n.y-e.y;return FP(i,a)},O7=function(e,n,i,a){var s=Ig(0,a-.001,1),o=Ig(0,a+.001,1),l=ip(e,n,i,s),u=ip(e,n,i,o);return VP(l,u)};su.recalculateEdgeLabelProjections=function(r){var e,n=r._private,i=n.rscratch,a=this,s={mid:r.pstyle("label").strValue,source:r.pstyle("source-label").strValue,target:r.pstyle("target-label").strValue};if(s.mid||s.source||s.target){e={x:i.midX,y:i.midY};var o=function(p,v,y){Uu(n.rscratch,p,v,y),Uu(n.rstyle,p,v,y)};o("labelX",null,e.x),o("labelY",null,e.y);var l=FP(i.midDispX,i.midDispY);o("labelAutoAngle",null,l);var u=function(){if(u.cache)return u.cache;for(var p=[],v=0;v+5<i.allpts.length;v+=4){var y={x:i.allpts[v],y:i.allpts[v+1]},b={x:i.allpts[v+2],y:i.allpts[v+3]},S={x:i.allpts[v+4],y:i.allpts[v+5]};p.push({p0:y,p1:b,p2:S,startDist:0,length:0,segments:[]})}var k=n.rstyle.bezierPts,T=a.bezierProjPcts.length;function C(B,I,z,V,$){var Y=Ih(I,z),D=B.segments[B.segments.length-1],q={p0:I,p1:z,t0:V,t1:$,startDist:D?D.startDist+D.length:0,length:Y};B.segments.push(q),B.length+=Y}for(var N=0;N<p.length;N++){var P=p[N],R=p[N-1];R&&(P.startDist=R.startDist+R.length),C(P,P.p0,k[N*T],0,a.bezierProjPcts[0]);for(var O=0;O<T-1;O++)C(P,k[N*T+O],k[N*T+O+1],a.bezierProjPcts[O],a.bezierProjPcts[O+1]);C(P,k[N*T+T-1],P.p2,a.bezierProjPcts[T-1],1)}return u.cache=p},c=function(p){var v,y=p==="source";if(s[p]){var b=r.pstyle(p+"-text-offset").pfValue;switch(i.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var S=u(),k,T=0,C=0,N=0;N<S.length;N++){for(var P=S[y?N:S.length-1-N],R=0;R<P.segments.length;R++){var O=P.segments[y?R:P.segments.length-1-R],B=N===S.length-1&&R===P.segments.length-1;if(T=C,C+=O.length,C>=b||B){k={cp:P,segment:O};break}}if(k)break}var I=k.cp,z=k.segment,V=(b-T)/z.length,$=z.t1-z.t0,Y=y?z.t0+$*V:z.t1-$*V;Y=Ig(0,Y,1),e=ip(I.p0,I.p1,I.p2,Y),v=O7(I.p0,I.p1,I.p2,Y);break}case"straight":case"segments":case"haystack":{for(var D=0,q,G,Z,Q,J=i.allpts.length,ie=0;ie+3<J&&(y?(Z={x:i.allpts[ie],y:i.allpts[ie+1]},Q={x:i.allpts[ie+2],y:i.allpts[ie+3]}):(Z={x:i.allpts[J-2-ie],y:i.allpts[J-1-ie]},Q={x:i.allpts[J-4-ie],y:i.allpts[J-3-ie]}),q=Ih(Z,Q),G=D,D+=q,!(D>=b));ie+=2);var ne=b-G,W=ne/q;W=Ig(0,W,1),e=nD(Z,Q,W),v=VP(Z,Q);break}}o("labelX",p,e.x),o("labelY",p,e.y),o("labelAutoAngle",p,v)}};c("source"),c("target"),this.applyLabelDimensions(r)}};su.applyLabelDimensions=function(r){this.applyPrefixedLabelDimensions(r),r.isEdge()&&(this.applyPrefixedLabelDimensions(r,"source"),this.applyPrefixedLabelDimensions(r,"target"))};su.applyPrefixedLabelDimensions=function(r,e){var n=r._private,i=this.getLabelText(r,e),a=Dh(i,r._private.labelDimsKey);if(Ps(n.rscratch,"prefixedLabelDimsKey",e)!==a){Uu(n.rscratch,"prefixedLabelDimsKey",e,a);var s=this.calculateLabelDimensions(r,i),o=r.pstyle("line-height").pfValue,l=r.pstyle("text-wrap").strValue,u=Ps(n.rscratch,"labelWrapCachedLines",e)||[],c=l!=="wrap"?1:Math.max(u.length,1),d=s.height/c,p=d*o,v=s.width,y=s.height+(c-1)*(o-1)*d;Uu(n.rstyle,"labelWidth",e,v),Uu(n.rscratch,"labelWidth",e,v),Uu(n.rstyle,"labelHeight",e,y),Uu(n.rscratch,"labelHeight",e,y),Uu(n.rscratch,"labelLineHeight",e,p)}};su.getLabelText=function(r,e){var n=r._private,i=e?e+"-":"",a=r.pstyle(i+"label").strValue,s=r.pstyle("text-transform").value,o=function(ae,he){return he?(Uu(n.rscratch,ae,e,he),he):Ps(n.rscratch,ae,e)};if(!a)return"";s=="none"||(s=="uppercase"?a=a.toUpperCase():s=="lowercase"&&(a=a.toLowerCase()));var l=r.pstyle("text-wrap").value;if(l==="wrap"){var u=o("labelKey");if(u!=null&&o("labelWrapKey")===u)return o("labelWrapCachedText");for(var c="",d=a.split(`
`),p=r.pstyle("text-max-width").pfValue,v=r.pstyle("text-overflow-wrap").value,y=v==="anywhere",b=[],S=/[\s\u200b]+|$/g,k=0;k<d.length;k++){var T=d[k],C=this.calculateLabelDimensions(r,T),N=C.width;if(y){var P=T.split("").join(c);T=P}if(N>p){var R=T.matchAll(S),O="",B=0,I=js(R),z;try{for(I.s();!(z=I.n()).done;){var V=z.value,$=V[0],Y=T.substring(B,V.index);B=V.index+$.length;var D=O.length===0?Y:O+Y+$,q=this.calculateLabelDimensions(r,D),G=q.width;G<=p?O+=Y+$:(O&&b.push(O),O=Y+$)}}catch(re){I.e(re)}finally{I.f()}O.match(/^[\s\u200b]+$/)||b.push(O)}else b.push(T)}o("labelWrapCachedLines",b),a=o("labelWrapCachedText",b.join(`
`)),o("labelWrapKey",u)}else if(l==="ellipsis"){var Z=r.pstyle("text-max-width").pfValue,Q="",J="",ie=!1;if(this.calculateLabelDimensions(r,a).width<Z)return a;for(var ne=0;ne<a.length;ne++){var W=this.calculateLabelDimensions(r,Q+a[ne]+J).width;if(W>Z)break;Q+=a[ne],ne===a.length-1&&(ie=!0)}return ie||(Q+=J),Q}return a};su.getLabelJustification=function(r){var e=r.pstyle("text-justification").strValue,n=r.pstyle("text-halign").strValue;if(e==="auto")if(r.isNode())switch(n){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};su.calculateLabelDimensions=function(r,e){var n=this,i=n.cy.window(),a=i.document,s=0,o=r.pstyle("font-style").strValue,l=r.pstyle("font-size").pfValue,u=r.pstyle("font-family").strValue,c=r.pstyle("font-weight").strValue,d=this.labelCalcCanvas,p=this.labelCalcCanvasContext;if(!d){d=this.labelCalcCanvas=a.createElement("canvas"),p=this.labelCalcCanvasContext=d.getContext("2d");var v=d.style;v.position="absolute",v.left="-9999px",v.top="-9999px",v.zIndex="-1",v.visibility="hidden",v.pointerEvents="none"}p.font="".concat(o," ").concat(c," ").concat(l,"px ").concat(u);for(var y=0,b=0,S=e.split(`
`),k=0;k<S.length;k++){var T=S[k],C=p.measureText(T),N=Math.ceil(C.width),P=l;y=Math.max(N,y),b+=P}return y+=s,b+=s,{width:y,height:b}};su.calculateLabelAngle=function(r,e){var n=r._private,i=n.rscratch,a=r.isEdge(),s=e?e+"-":"",o=r.pstyle(s+"text-rotation"),l=o.strValue;return l==="none"?0:a&&l==="autorotate"?i.labelAutoAngle:l==="autorotate"?0:o.pfValue};su.calculateLabelAngles=function(r){var e=this,n=r.isEdge(),i=r._private,a=i.rscratch;a.labelAngle=e.calculateLabelAngle(r),n&&(a.sourceLabelAngle=e.calculateLabelAngle(r,"source"),a.targetLabelAngle=e.calculateLabelAngle(r,"target"))};var UP={},cN=28,dN=!1;UP.getNodeShape=function(r){var e=this,n=r.pstyle("shape").value;if(n==="cutrectangle"&&(r.width()<cN||r.height()<cN))return dN||(zr("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),dN=!0),"rectangle";if(r.isParent())return n==="rectangle"||n==="roundrectangle"||n==="round-rectangle"||n==="cutrectangle"||n==="cut-rectangle"||n==="barrel"?n:"rectangle";if(n==="polygon"){var i=r.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(i).name}return n};var Px={};Px.registerCalculationListeners=function(){var r=this.cy,e=r.collection(),n=this,i=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(o),l)for(var u=0;u<o.length;u++){var c=o[u],d=c._private,p=d.rstyle;p.clean=!1,p.cleanConnected=!1}};n.binder(r).on("bounds.* dirty.*",function(o){var l=o.target;i(l)}).on("style.* background.*",function(o){var l=o.target;i(l,!1)});var a=function(o){if(o){var l=n.onUpdateEleCalcsFns;e.cleanStyle();for(var u=0;u<e.length;u++){var c=e[u],d=c._private.rstyle;c.isNode()&&!d.cleanConnected&&(i(c.connectedEdges()),d.cleanConnected=!0)}if(l)for(var p=0;p<l.length;p++){var v=l[p];v(o,e)}n.recalculateRenderedStyle(e),e=r.collection()}};n.flushRenderedStyleQueue=function(){a(!0)},n.beforeRender(a,n.beforeRenderPriorities.eleCalcs)};Px.onUpdateEleCalcs=function(r){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(r)};Px.recalculateRenderedStyle=function(r,e){var n=function(P){return P._private.rstyle.cleanConnected};if(r.length!==0){var i=[],a=[];if(!this.destroyed){e===void 0&&(e=!0);for(var s=0;s<r.length;s++){var o=r[s],l=o._private,u=l.rstyle;o.isEdge()&&(!n(o.source())||!n(o.target()))&&(u.clean=!1),o.isEdge()&&o.isBundledBezier()&&o.parallelEdges().some(function(N){return!N._private.rstyle.clean&&N.isBundledBezier()})&&(u.clean=!1),!(e&&u.clean||o.removed())&&o.pstyle("display").value!=="none"&&(l.group==="nodes"?a.push(o):i.push(o),u.clean=!0)}for(var c=0;c<a.length;c++){var d=a[c],p=d._private,v=p.rstyle,y=d.position();this.recalculateNodeLabelProjection(d),v.nodeX=y.x,v.nodeY=y.y,v.nodeW=d.pstyle("width").pfValue,v.nodeH=d.pstyle("height").pfValue}this.recalculateEdgeProjections(i);for(var b=0;b<i.length;b++){var S=i[b],k=S._private,T=k.rstyle,C=k.rscratch;T.srcX=C.arrowStartX,T.srcY=C.arrowStartY,T.tgtX=C.arrowEndX,T.tgtY=C.arrowEndY,T.midX=C.midX,T.midY=C.midY,T.labelAngle=C.labelAngle,T.sourceLabelAngle=C.sourceLabelAngle,T.targetLabelAngle=C.targetLabelAngle}}}};var Mx={};Mx.updateCachedGrabbedEles=function(){var r=this.cachedZSortedEles;if(r){r.drag=[],r.nondrag=[];for(var e=[],n=0;n<r.length;n++){var i=r[n],a=i._private.rscratch;i.grabbed()&&!i.isParent()?e.push(i):a.inDragLayer?r.drag.push(i):r.nondrag.push(i)}for(var n=0;n<e.length;n++){var i=e[n];r.drag.push(i)}}};Mx.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};Mx.getCachedZSortedEles=function(r){if(r||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(SP),e.interactive=e.filter(function(n){return n.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var HP={};[Yh,py,$a,mv,Z_,su,UP,Px,Mx].forEach(function(r){Ht(HP,r)});var GP={};GP.getCachedImage=function(r,e,n){var i=this,a=i.imageCache=i.imageCache||{},s=a[r];if(s)return s.image.complete||s.image.addEventListener("load",n),s.image;s=a[r]=a[r]||{};var o=s.image=new Image;o.addEventListener("load",n),o.addEventListener("error",function(){o.error=!0});var l="data:",u=r.substring(0,l.length).toLowerCase()===l;return u||(e=e==="null"?null:e,o.crossOrigin=e),o.src=r,o};var jp={};jp.registerBinding=function(r,e,n,i){var a=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(r)){for(var s=[],o=0;o<r.length;o++){var l=r[o];if(l!==void 0){var u=this.binder(l);s.push(u.on.apply(u,a))}}return s}var u=this.binder(r);return u.on.apply(u,a)};jp.binder=function(r){var e=this,n=e.cy.window(),i=r===n||r===n.document||r===n.document.body||$8(r);if(e.supportsPassiveEvents==null){var a=!1;try{var s=Object.defineProperty({},"passive",{get:function(){return a=!0,!0}});n.addEventListener("test",null,s)}catch{}e.supportsPassiveEvents=a}var o=function(u,c,d){var p=Array.prototype.slice.call(arguments);return i&&e.supportsPassiveEvents&&(p[2]={capture:d??!1,passive:!1,once:!1}),e.bindings.push({target:r,args:p}),(r.addEventListener||r.on).apply(r,p),this};return{on:o,addEventListener:o,addListener:o,bind:o}};jp.nodeIsDraggable=function(r){return r&&r.isNode()&&!r.locked()&&r.grabbable()};jp.nodeIsGrabbable=function(r){return this.nodeIsDraggable(r)&&r.interactive()};jp.load=function(){var r=this,e=r.cy.window(),n=function(de){return de.selected()},i=function(de){var ye=de.getRootNode();if(ye&&ye.nodeType===11&&ye.host!==void 0)return ye},a=function(de,ye,Ce,Te){de==null&&(de=r.cy);for(var Re=0;Re<ye.length;Re++){var Ze=ye[Re];de.emit({originalEvent:Ce,type:Ze,position:Te})}},s=function(de){return de.shiftKey||de.metaKey||de.ctrlKey},o=function(de,ye){var Ce=!0;if(r.cy.hasCompoundNodes()&&de&&de.pannable())for(var Te=0;ye&&Te<ye.length;Te++){var de=ye[Te];if(de.isNode()&&de.isParent()&&!de.pannable()){Ce=!1;break}}else Ce=!0;return Ce},l=function(de){de[0]._private.grabbed=!0},u=function(de){de[0]._private.grabbed=!1},c=function(de){de[0]._private.rscratch.inDragLayer=!0},d=function(de){de[0]._private.rscratch.inDragLayer=!1},p=function(de){de[0]._private.rscratch.isGrabTarget=!0},v=function(de){de[0]._private.rscratch.isGrabTarget=!1},y=function(de,ye){var Ce=ye.addToList,Te=Ce.has(de);!Te&&de.grabbable()&&!de.locked()&&(Ce.merge(de),l(de))},b=function(de,ye){if(de.cy().hasCompoundNodes()&&!(ye.inDragLayer==null&&ye.addToList==null)){var Ce=de.descendants();ye.inDragLayer&&(Ce.forEach(c),Ce.connectedEdges().forEach(c)),ye.addToList&&y(Ce,ye)}},S=function(de,ye){ye=ye||{};var Ce=de.cy().hasCompoundNodes();ye.inDragLayer&&(de.forEach(c),de.neighborhood().stdFilter(function(Te){return!Ce||Te.isEdge()}).forEach(c)),ye.addToList&&de.forEach(function(Te){y(Te,ye)}),b(de,ye),C(de,{inDragLayer:ye.inDragLayer}),r.updateCachedGrabbedEles()},k=S,T=function(de){de&&(r.getCachedZSortedEles().forEach(function(ye){u(ye),d(ye),v(ye)}),r.updateCachedGrabbedEles())},C=function(de,ye){if(!(ye.inDragLayer==null&&ye.addToList==null)&&de.cy().hasCompoundNodes()){var Ce=de.ancestors().orphans();if(!Ce.same(de)){var Te=Ce.descendants().spawnSelf().merge(Ce).unmerge(de).unmerge(de.descendants()),Re=Te.connectedEdges();ye.inDragLayer&&(Re.forEach(c),Te.forEach(c)),ye.addToList&&Te.forEach(function(Ze){y(Ze,ye)})}}},N=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},P=typeof MutationObserver<"u",R=typeof ResizeObserver<"u";P?(r.removeObserver=new MutationObserver(function(qe){for(var de=0;de<qe.length;de++){var ye=qe[de],Ce=ye.removedNodes;if(Ce)for(var Te=0;Te<Ce.length;Te++){var Re=Ce[Te];if(Re===r.container){r.destroy();break}}}}),r.container.parentNode&&r.removeObserver.observe(r.container.parentNode,{childList:!0})):r.registerBinding(r.container,"DOMNodeRemoved",function(qe){r.destroy()});var O=dv(function(){r.cy.resize()},100);P&&(r.styleObserver=new MutationObserver(O),r.styleObserver.observe(r.container,{attributes:!0})),r.registerBinding(e,"resize",O),R&&(r.resizeObserver=new ResizeObserver(O),r.resizeObserver.observe(r.container));var B=function(de,ye){for(;de!=null;)ye(de),de=de.parentNode},I=function(){r.invalidateContainerClientCoordsCache()};B(r.container,function(qe){r.registerBinding(qe,"transitionend",I),r.registerBinding(qe,"animationend",I),r.registerBinding(qe,"scroll",I)}),r.registerBinding(r.container,"contextmenu",function(qe){qe.preventDefault()});var z=function(){return r.selection[4]!==0},V=function(de){for(var ye=r.findContainerClientCoords(),Ce=ye[0],Te=ye[1],Re=ye[2],Ze=ye[3],Ge=de.touches?de.touches:[de],ct=!1,ut=0;ut<Ge.length;ut++){var kt=Ge[ut];if(Ce<=kt.clientX&&kt.clientX<=Ce+Re&&Te<=kt.clientY&&kt.clientY<=Te+Ze){ct=!0;break}}if(!ct)return!1;for(var zt=r.container,Ft=de.target,xt=Ft.parentNode,Gt=!1;xt;){if(xt===zt){Gt=!0;break}xt=xt.parentNode}return!!Gt};r.registerBinding(r.container,"mousedown",function(de){if(V(de)&&!(r.hoverData.which===1&&de.which!==1)){de.preventDefault(),N(),r.hoverData.capture=!0,r.hoverData.which=de.which;var ye=r.cy,Ce=[de.clientX,de.clientY],Te=r.projectIntoViewport(Ce[0],Ce[1]),Re=r.selection,Ze=r.findNearestElements(Te[0],Te[1],!0,!1),Ge=Ze[0],ct=r.dragData.possibleDragElements;r.hoverData.mdownPos=Te,r.hoverData.mdownGPos=Ce;var ut=function(Wt){return{originalEvent:de,type:Wt,position:{x:Te[0],y:Te[1]}}},kt=function(){r.hoverData.tapholdCancelled=!1,clearTimeout(r.hoverData.tapholdTimeout),r.hoverData.tapholdTimeout=setTimeout(function(){if(!r.hoverData.tapholdCancelled){var Wt=r.hoverData.down;Wt?Wt.emit(ut("taphold")):ye.emit(ut("taphold"))}},r.tapholdDuration)};if(de.which==3){r.hoverData.cxtStarted=!0;var zt={originalEvent:de,type:"cxttapstart",position:{x:Te[0],y:Te[1]}};Ge?(Ge.activate(),Ge.emit(zt),r.hoverData.down=Ge):ye.emit(zt),r.hoverData.downTime=new Date().getTime(),r.hoverData.cxtDragged=!1}else if(de.which==1){Ge&&Ge.activate();{if(Ge!=null&&r.nodeIsGrabbable(Ge)){var Ft=function(Wt){Wt.emit(ut("grab"))};if(p(Ge),!Ge.selected())ct=r.dragData.possibleDragElements=ye.collection(),k(Ge,{addToList:ct}),Ge.emit(ut("grabon")).emit(ut("grab"));else{ct=r.dragData.possibleDragElements=ye.collection();var xt=ye.$(function(Gt){return Gt.isNode()&&Gt.selected()&&r.nodeIsGrabbable(Gt)});S(xt,{addToList:ct}),Ge.emit(ut("grabon")),xt.forEach(Ft)}r.redrawHint("eles",!0),r.redrawHint("drag",!0)}r.hoverData.down=Ge,r.hoverData.downs=Ze,r.hoverData.downTime=new Date().getTime()}a(Ge,["mousedown","tapstart","vmousedown"],de,{x:Te[0],y:Te[1]}),Ge==null?(Re[4]=1,r.data.bgActivePosistion={x:Te[0],y:Te[1]},r.redrawHint("select",!0),r.redraw()):Ge.pannable()&&(Re[4]=1),kt()}Re[0]=Re[2]=Te[0],Re[1]=Re[3]=Te[1]}},!1);var $=i(r.container);r.registerBinding([e,$],"mousemove",function(de){var ye=r.hoverData.capture;if(!(!ye&&!V(de))){var Ce=!1,Te=r.cy,Re=Te.zoom(),Ze=[de.clientX,de.clientY],Ge=r.projectIntoViewport(Ze[0],Ze[1]),ct=r.hoverData.mdownPos,ut=r.hoverData.mdownGPos,kt=r.selection,zt=null;!r.hoverData.draggingEles&&!r.hoverData.dragging&&!r.hoverData.selecting&&(zt=r.findNearestElement(Ge[0],Ge[1],!0,!1));var Ft=r.hoverData.last,xt=r.hoverData.down,Gt=[Ge[0]-kt[2],Ge[1]-kt[3]],Wt=r.dragData.possibleDragElements,kr;if(ut){var pr=Ze[0]-ut[0],pn=pr*pr,qr=Ze[1]-ut[1],Wr=qr*qr,an=pn+Wr;r.hoverData.isOverThresholdDrag=kr=an>=r.desktopTapThreshold2}var cr=s(de);kr&&(r.hoverData.tapholdCancelled=!0);var bt=function(){var _i=r.hoverData.dragDelta=r.hoverData.dragDelta||[];_i.length===0?(_i.push(Gt[0]),_i.push(Gt[1])):(_i[0]+=Gt[0],_i[1]+=Gt[1])};Ce=!0,a(zt,["mousemove","vmousemove","tapdrag"],de,{x:Ge[0],y:Ge[1]});var Or=function(_i){return{originalEvent:de,type:_i,position:{x:Ge[0],y:Ge[1]}}},Xn=function(){r.data.bgActivePosistion=void 0,r.hoverData.selecting||Te.emit(Or("boxstart")),kt[4]=1,r.hoverData.selecting=!0,r.redrawHint("select",!0),r.redraw()};if(r.hoverData.which===3){if(kr){var Ma=Or("cxtdrag");xt?xt.emit(Ma):Te.emit(Ma),r.hoverData.cxtDragged=!0,(!r.hoverData.cxtOver||zt!==r.hoverData.cxtOver)&&(r.hoverData.cxtOver&&r.hoverData.cxtOver.emit(Or("cxtdragout")),r.hoverData.cxtOver=zt,zt&&zt.emit(Or("cxtdragover")))}}else if(r.hoverData.dragging){if(Ce=!0,Te.panningEnabled()&&Te.userPanningEnabled()){var Is;if(r.hoverData.justStartedPan){var eo=r.hoverData.mdownPos;Is={x:(Ge[0]-eo[0])*Re,y:(Ge[1]-eo[1])*Re},r.hoverData.justStartedPan=!1}else Is={x:Gt[0]*Re,y:Gt[1]*Re};Te.panBy(Is),Te.emit(Or("dragpan")),r.hoverData.dragged=!0}Ge=r.projectIntoViewport(de.clientX,de.clientY)}else if(kt[4]==1&&(xt==null||xt.pannable())){if(kr){if(!r.hoverData.dragging&&Te.boxSelectionEnabled()&&(cr||!Te.panningEnabled()||!Te.userPanningEnabled()))Xn();else if(!r.hoverData.selecting&&Te.panningEnabled()&&Te.userPanningEnabled()){var ci=o(xt,r.hoverData.downs);ci&&(r.hoverData.dragging=!0,r.hoverData.justStartedPan=!0,kt[4]=0,r.data.bgActivePosistion=Jf(ct),r.redrawHint("select",!0),r.redraw())}xt&&xt.pannable()&&xt.active()&&xt.unactivate()}}else{if(xt&&xt.pannable()&&xt.active()&&xt.unactivate(),(!xt||!xt.grabbed())&&zt!=Ft&&(Ft&&a(Ft,["mouseout","tapdragout"],de,{x:Ge[0],y:Ge[1]}),zt&&a(zt,["mouseover","tapdragover"],de,{x:Ge[0],y:Ge[1]}),r.hoverData.last=zt),xt)if(kr){if(Te.boxSelectionEnabled()&&cr)xt&&xt.grabbed()&&(T(Wt),xt.emit(Or("freeon")),Wt.emit(Or("free")),r.dragData.didDrag&&(xt.emit(Or("dragfreeon")),Wt.emit(Or("dragfree")))),Xn();else if(xt&&xt.grabbed()&&r.nodeIsDraggable(xt)){var sn=!r.dragData.didDrag;sn&&r.redrawHint("eles",!0),r.dragData.didDrag=!0,r.hoverData.draggingEles||S(Wt,{inDragLayer:!0});var bn={x:0,y:0};if(ht(Gt[0])&&ht(Gt[1])&&(bn.x+=Gt[0],bn.y+=Gt[1],sn)){var di=r.hoverData.dragDelta;di&&ht(di[0])&&ht(di[1])&&(bn.x+=di[0],bn.y+=di[1])}r.hoverData.draggingEles=!0,Wt.silentShift(bn).emit(Or("position")).emit(Or("drag")),r.redrawHint("drag",!0),r.redraw()}}else bt();Ce=!0}if(kt[2]=Ge[0],kt[3]=Ge[1],Ce)return de.stopPropagation&&de.stopPropagation(),de.preventDefault&&de.preventDefault(),!1}},!1);var Y,D,q;r.registerBinding(e,"mouseup",function(de){if(!(r.hoverData.which===1&&de.which!==1&&r.hoverData.capture)){var ye=r.hoverData.capture;if(ye){r.hoverData.capture=!1;var Ce=r.cy,Te=r.projectIntoViewport(de.clientX,de.clientY),Re=r.selection,Ze=r.findNearestElement(Te[0],Te[1],!0,!1),Ge=r.dragData.possibleDragElements,ct=r.hoverData.down,ut=s(de);r.data.bgActivePosistion&&(r.redrawHint("select",!0),r.redraw()),r.hoverData.tapholdCancelled=!0,r.data.bgActivePosistion=void 0,ct&&ct.unactivate();var kt=function(pr){return{originalEvent:de,type:pr,position:{x:Te[0],y:Te[1]}}};if(r.hoverData.which===3){var zt=kt("cxttapend");if(ct?ct.emit(zt):Ce.emit(zt),!r.hoverData.cxtDragged){var Ft=kt("cxttap");ct?ct.emit(Ft):Ce.emit(Ft)}r.hoverData.cxtDragged=!1,r.hoverData.which=null}else if(r.hoverData.which===1){if(a(Ze,["mouseup","tapend","vmouseup"],de,{x:Te[0],y:Te[1]}),!r.dragData.didDrag&&!r.hoverData.dragged&&!r.hoverData.selecting&&!r.hoverData.isOverThresholdDrag&&(a(ct,["click","tap","vclick"],de,{x:Te[0],y:Te[1]}),D=!1,de.timeStamp-q<=Ce.multiClickDebounceTime()?(Y&&clearTimeout(Y),D=!0,q=null,a(ct,["dblclick","dbltap","vdblclick"],de,{x:Te[0],y:Te[1]})):(Y=setTimeout(function(){D||a(ct,["oneclick","onetap","voneclick"],de,{x:Te[0],y:Te[1]})},Ce.multiClickDebounceTime()),q=de.timeStamp)),ct==null&&!r.dragData.didDrag&&!r.hoverData.selecting&&!r.hoverData.dragged&&!s(de)&&(Ce.$(n).unselect(["tapunselect"]),Ge.length>0&&r.redrawHint("eles",!0),r.dragData.possibleDragElements=Ge=Ce.collection()),Ze==ct&&!r.dragData.didDrag&&!r.hoverData.selecting&&Ze!=null&&Ze._private.selectable&&(r.hoverData.dragging||(Ce.selectionType()==="additive"||ut?Ze.selected()?Ze.unselect(["tapunselect"]):Ze.select(["tapselect"]):ut||(Ce.$(n).unmerge(Ze).unselect(["tapunselect"]),Ze.select(["tapselect"]))),r.redrawHint("eles",!0)),r.hoverData.selecting){var xt=Ce.collection(r.getAllInBox(Re[0],Re[1],Re[2],Re[3]));r.redrawHint("select",!0),xt.length>0&&r.redrawHint("eles",!0),Ce.emit(kt("boxend"));var Gt=function(pr){return pr.selectable()&&!pr.selected()};Ce.selectionType()==="additive"||ut||Ce.$(n).unmerge(xt).unselect(),xt.emit(kt("box")).stdFilter(Gt).select().emit(kt("boxselect")),r.redraw()}if(r.hoverData.dragging&&(r.hoverData.dragging=!1,r.redrawHint("select",!0),r.redrawHint("eles",!0),r.redraw()),!Re[4]){r.redrawHint("drag",!0),r.redrawHint("eles",!0);var Wt=ct&&ct.grabbed();T(Ge),Wt&&(ct.emit(kt("freeon")),Ge.emit(kt("free")),r.dragData.didDrag&&(ct.emit(kt("dragfreeon")),Ge.emit(kt("dragfree"))))}}Re[4]=0,r.hoverData.down=null,r.hoverData.cxtStarted=!1,r.hoverData.draggingEles=!1,r.hoverData.selecting=!1,r.hoverData.isOverThresholdDrag=!1,r.dragData.didDrag=!1,r.hoverData.dragged=!1,r.hoverData.dragDelta=[],r.hoverData.mdownPos=null,r.hoverData.mdownGPos=null,r.hoverData.which=null}}},!1);var G=[],Z=4,Q,J=1e5,ie=function(de,ye){for(var Ce=0;Ce<de.length;Ce++)if(de[Ce]%ye!==0)return!1;return!0},ne=function(de){for(var ye=Math.abs(de[0]),Ce=1;Ce<de.length;Ce++)if(Math.abs(de[Ce])!==ye)return!1;return!0},W=function(de){var ye=!1,Ce=de.deltaY;if(Ce==null&&(de.wheelDeltaY!=null?Ce=de.wheelDeltaY/4:de.wheelDelta!=null&&(Ce=de.wheelDelta/4)),Ce!==0){if(Q==null)if(G.length>=Z){var Te=G;if(Q=ie(Te,5),!Q){var Re=Math.abs(Te[0]);Q=ne(Te)&&Re>5}if(Q)for(var Ze=0;Ze<Te.length;Ze++)J=Math.min(Math.abs(Te[Ze]),J)}else G.push(Ce),ye=!0;else Q&&(J=Math.min(Math.abs(Ce),J));if(!r.scrollingPage){var Ge=r.cy,ct=Ge.zoom(),ut=Ge.pan(),kt=r.projectIntoViewport(de.clientX,de.clientY),zt=[kt[0]*ct+ut.x,kt[1]*ct+ut.y];if(r.hoverData.draggingEles||r.hoverData.dragging||r.hoverData.cxtStarted||z()){de.preventDefault();return}if(Ge.panningEnabled()&&Ge.userPanningEnabled()&&Ge.zoomingEnabled()&&Ge.userZoomingEnabled()){de.preventDefault(),r.data.wheelZooming=!0,clearTimeout(r.data.wheelTimeout),r.data.wheelTimeout=setTimeout(function(){r.data.wheelZooming=!1,r.redrawHint("eles",!0),r.redraw()},150);var Ft;ye&&Math.abs(Ce)>5&&(Ce=O_(Ce)*5),Ft=Ce/-250,Q&&(Ft/=J,Ft*=3),Ft=Ft*r.wheelSensitivity;var xt=de.deltaMode===1;xt&&(Ft*=33);var Gt=Ge.zoom()*Math.pow(10,Ft);de.type==="gesturechange"&&(Gt=r.gestureStartZoom*de.scale),Ge.zoom({level:Gt,renderedPosition:{x:zt[0],y:zt[1]}}),Ge.emit({type:de.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:de,position:{x:kt[0],y:kt[1]}})}}}};r.registerBinding(r.container,"wheel",W,!0),r.registerBinding(e,"scroll",function(de){r.scrollingPage=!0,clearTimeout(r.scrollingPageTimeout),r.scrollingPageTimeout=setTimeout(function(){r.scrollingPage=!1},250)},!0),r.registerBinding(r.container,"gesturestart",function(de){r.gestureStartZoom=r.cy.zoom(),r.hasTouchStarted||de.preventDefault()},!0),r.registerBinding(r.container,"gesturechange",function(qe){r.hasTouchStarted||W(qe)},!0),r.registerBinding(r.container,"mouseout",function(de){var ye=r.projectIntoViewport(de.clientX,de.clientY);r.cy.emit({originalEvent:de,type:"mouseout",position:{x:ye[0],y:ye[1]}})},!1),r.registerBinding(r.container,"mouseover",function(de){var ye=r.projectIntoViewport(de.clientX,de.clientY);r.cy.emit({originalEvent:de,type:"mouseover",position:{x:ye[0],y:ye[1]}})},!1);var re,ae,he,ve,xe,se,ge,le,pe,me,be,Se,Ue,We=function(de,ye,Ce,Te){return Math.sqrt((Ce-de)*(Ce-de)+(Te-ye)*(Te-ye))},gt=function(de,ye,Ce,Te){return(Ce-de)*(Ce-de)+(Te-ye)*(Te-ye)},Je;r.registerBinding(r.container,"touchstart",Je=function(de){if(r.hasTouchStarted=!0,!!V(de)){N(),r.touchData.capture=!0,r.data.bgActivePosistion=void 0;var ye=r.cy,Ce=r.touchData.now,Te=r.touchData.earlier;if(de.touches[0]){var Re=r.projectIntoViewport(de.touches[0].clientX,de.touches[0].clientY);Ce[0]=Re[0],Ce[1]=Re[1]}if(de.touches[1]){var Re=r.projectIntoViewport(de.touches[1].clientX,de.touches[1].clientY);Ce[2]=Re[0],Ce[3]=Re[1]}if(de.touches[2]){var Re=r.projectIntoViewport(de.touches[2].clientX,de.touches[2].clientY);Ce[4]=Re[0],Ce[5]=Re[1]}var Ze=function(cr){return{originalEvent:de,type:cr,position:{x:Ce[0],y:Ce[1]}}};if(de.touches[1]){r.touchData.singleTouchMoved=!0,T(r.dragData.touchDragEles);var Ge=r.findContainerClientCoords();pe=Ge[0],me=Ge[1],be=Ge[2],Se=Ge[3],re=de.touches[0].clientX-pe,ae=de.touches[0].clientY-me,he=de.touches[1].clientX-pe,ve=de.touches[1].clientY-me,Ue=0<=re&&re<=be&&0<=he&&he<=be&&0<=ae&&ae<=Se&&0<=ve&&ve<=Se;var ct=ye.pan(),ut=ye.zoom();xe=We(re,ae,he,ve),se=gt(re,ae,he,ve),ge=[(re+he)/2,(ae+ve)/2],le=[(ge[0]-ct.x)/ut,(ge[1]-ct.y)/ut];var kt=200,zt=kt*kt;if(se<zt&&!de.touches[2]){var Ft=r.findNearestElement(Ce[0],Ce[1],!0,!0),xt=r.findNearestElement(Ce[2],Ce[3],!0,!0);Ft&&Ft.isNode()?(Ft.activate().emit(Ze("cxttapstart")),r.touchData.start=Ft):xt&&xt.isNode()?(xt.activate().emit(Ze("cxttapstart")),r.touchData.start=xt):ye.emit(Ze("cxttapstart")),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!0,r.touchData.cxtDragged=!1,r.data.bgActivePosistion=void 0,r.redraw();return}}if(de.touches[2])ye.boxSelectionEnabled()&&de.preventDefault();else if(!de.touches[1]){if(de.touches[0]){var Gt=r.findNearestElements(Ce[0],Ce[1],!0,!0),Wt=Gt[0];if(Wt!=null&&(Wt.activate(),r.touchData.start=Wt,r.touchData.starts=Gt,r.nodeIsGrabbable(Wt))){var kr=r.dragData.touchDragEles=ye.collection(),pr=null;r.redrawHint("eles",!0),r.redrawHint("drag",!0),Wt.selected()?(pr=ye.$(function(an){return an.selected()&&r.nodeIsGrabbable(an)}),S(pr,{addToList:kr})):k(Wt,{addToList:kr}),p(Wt),Wt.emit(Ze("grabon")),pr?pr.forEach(function(an){an.emit(Ze("grab"))}):Wt.emit(Ze("grab"))}a(Wt,["touchstart","tapstart","vmousedown"],de,{x:Ce[0],y:Ce[1]}),Wt==null&&(r.data.bgActivePosistion={x:Re[0],y:Re[1]},r.redrawHint("select",!0),r.redraw()),r.touchData.singleTouchMoved=!1,r.touchData.singleTouchStartTime=+new Date,clearTimeout(r.touchData.tapholdTimeout),r.touchData.tapholdTimeout=setTimeout(function(){r.touchData.singleTouchMoved===!1&&!r.pinching&&!r.touchData.selecting&&a(r.touchData.start,["taphold"],de,{x:Ce[0],y:Ce[1]})},r.tapholdDuration)}}if(de.touches.length>=1){for(var pn=r.touchData.startPosition=[null,null,null,null,null,null],qr=0;qr<Ce.length;qr++)pn[qr]=Te[qr]=Ce[qr];var Wr=de.touches[0];r.touchData.startGPosition=[Wr.clientX,Wr.clientY]}}},!1);var at;r.registerBinding(e,"touchmove",at=function(de){var ye=r.touchData.capture;if(!(!ye&&!V(de))){var Ce=r.selection,Te=r.cy,Re=r.touchData.now,Ze=r.touchData.earlier,Ge=Te.zoom();if(de.touches[0]){var ct=r.projectIntoViewport(de.touches[0].clientX,de.touches[0].clientY);Re[0]=ct[0],Re[1]=ct[1]}if(de.touches[1]){var ct=r.projectIntoViewport(de.touches[1].clientX,de.touches[1].clientY);Re[2]=ct[0],Re[3]=ct[1]}if(de.touches[2]){var ct=r.projectIntoViewport(de.touches[2].clientX,de.touches[2].clientY);Re[4]=ct[0],Re[5]=ct[1]}var ut=function(xr){return{originalEvent:de,type:xr,position:{x:Re[0],y:Re[1]}}},kt=r.touchData.startGPosition,zt;if(ye&&de.touches[0]&&kt){for(var Ft=[],xt=0;xt<Re.length;xt++)Ft[xt]=Re[xt]-Ze[xt];var Gt=de.touches[0].clientX-kt[0],Wt=Gt*Gt,kr=de.touches[0].clientY-kt[1],pr=kr*kr,pn=Wt+pr;zt=pn>=r.touchTapThreshold2}if(ye&&r.touchData.cxt){de.preventDefault();var qr=de.touches[0].clientX-pe,Wr=de.touches[0].clientY-me,an=de.touches[1].clientX-pe,cr=de.touches[1].clientY-me,bt=gt(qr,Wr,an,cr),Or=bt/se,Xn=150,Ma=Xn*Xn,Is=1.5,eo=Is*Is;if(Or>=eo||bt>=Ma){r.touchData.cxt=!1,r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var ci=ut("cxttapend");r.touchData.start?(r.touchData.start.unactivate().emit(ci),r.touchData.start=null):Te.emit(ci)}}if(ye&&r.touchData.cxt){var ci=ut("cxtdrag");r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.touchData.start?r.touchData.start.emit(ci):Te.emit(ci),r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxtDragged=!0;var sn=r.findNearestElement(Re[0],Re[1],!0,!0);(!r.touchData.cxtOver||sn!==r.touchData.cxtOver)&&(r.touchData.cxtOver&&r.touchData.cxtOver.emit(ut("cxtdragout")),r.touchData.cxtOver=sn,sn&&sn.emit(ut("cxtdragover")))}else if(ye&&de.touches[2]&&Te.boxSelectionEnabled())de.preventDefault(),r.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,r.touchData.selecting||Te.emit(ut("boxstart")),r.touchData.selecting=!0,r.touchData.didSelect=!0,Ce[4]=1,!Ce||Ce.length===0||Ce[0]===void 0?(Ce[0]=(Re[0]+Re[2]+Re[4])/3,Ce[1]=(Re[1]+Re[3]+Re[5])/3,Ce[2]=(Re[0]+Re[2]+Re[4])/3+1,Ce[3]=(Re[1]+Re[3]+Re[5])/3+1):(Ce[2]=(Re[0]+Re[2]+Re[4])/3,Ce[3]=(Re[1]+Re[3]+Re[5])/3),r.redrawHint("select",!0),r.redraw();else if(ye&&de.touches[1]&&!r.touchData.didSelect&&Te.zoomingEnabled()&&Te.panningEnabled()&&Te.userZoomingEnabled()&&Te.userPanningEnabled()){de.preventDefault(),r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var bn=r.dragData.touchDragEles;if(bn){r.redrawHint("drag",!0);for(var di=0;di<bn.length;di++){var to=bn[di]._private;to.grabbed=!1,to.rscratch.inDragLayer=!1}}var _i=r.touchData.start,qr=de.touches[0].clientX-pe,Wr=de.touches[0].clientY-me,an=de.touches[1].clientX-pe,cr=de.touches[1].clientY-me,lu=We(qr,Wr,an,cr),uu=lu/xe;if(Ue){var zd=qr-re,pl=Wr-ae,Qr=an-he,cu=cr-ve,Bs=(zd+Qr)/2,ml=(pl+cu)/2,Aa=Te.zoom(),Oo=Aa*uu,ra=Te.pan(),na=le[0]*Aa+ra.x,mn=le[1]*Aa+ra.y,yr={x:-Oo/Aa*(na-ra.x-Bs)+na,y:-Oo/Aa*(mn-ra.y-ml)+mn};if(_i&&_i.active()){var bn=r.dragData.touchDragEles;T(bn),r.redrawHint("drag",!0),r.redrawHint("eles",!0),_i.unactivate().emit(ut("freeon")),bn.emit(ut("free")),r.dragData.didDrag&&(_i.emit(ut("dragfreeon")),bn.emit(ut("dragfree")))}Te.viewport({zoom:Oo,pan:yr,cancelOnFailedZoom:!0}),Te.emit(ut("pinchzoom")),xe=lu,re=qr,ae=Wr,he=an,ve=cr,r.pinching=!0}if(de.touches[0]){var ct=r.projectIntoViewport(de.touches[0].clientX,de.touches[0].clientY);Re[0]=ct[0],Re[1]=ct[1]}if(de.touches[1]){var ct=r.projectIntoViewport(de.touches[1].clientX,de.touches[1].clientY);Re[2]=ct[0],Re[3]=ct[1]}if(de.touches[2]){var ct=r.projectIntoViewport(de.touches[2].clientX,de.touches[2].clientY);Re[4]=ct[0],Re[5]=ct[1]}}else if(de.touches[0]&&!r.touchData.didSelect){var lt=r.touchData.start,dr=r.touchData.last,sn;if(!r.hoverData.draggingEles&&!r.swipePanning&&(sn=r.findNearestElement(Re[0],Re[1],!0,!0)),ye&&lt!=null&&de.preventDefault(),ye&&lt!=null&&r.nodeIsDraggable(lt))if(zt){var bn=r.dragData.touchDragEles,on=!r.dragData.didDrag;on&&S(bn,{inDragLayer:!0}),r.dragData.didDrag=!0;var Fr={x:0,y:0};if(ht(Ft[0])&&ht(Ft[1])&&(Fr.x+=Ft[0],Fr.y+=Ft[1],on)){r.redrawHint("eles",!0);var Tr=r.touchData.dragDelta;Tr&&ht(Tr[0])&&ht(Tr[1])&&(Fr.x+=Tr[0],Fr.y+=Tr[1])}r.hoverData.draggingEles=!0,bn.silentShift(Fr).emit(ut("position")).emit(ut("drag")),r.redrawHint("drag",!0),r.touchData.startPosition[0]==Ze[0]&&r.touchData.startPosition[1]==Ze[1]&&r.redrawHint("eles",!0),r.redraw()}else{var Tr=r.touchData.dragDelta=r.touchData.dragDelta||[];Tr.length===0?(Tr.push(Ft[0]),Tr.push(Ft[1])):(Tr[0]+=Ft[0],Tr[1]+=Ft[1])}if(a(lt||sn,["touchmove","tapdrag","vmousemove"],de,{x:Re[0],y:Re[1]}),(!lt||!lt.grabbed())&&sn!=dr&&(dr&&dr.emit(ut("tapdragout")),sn&&sn.emit(ut("tapdragover"))),r.touchData.last=sn,ye)for(var di=0;di<Re.length;di++)Re[di]&&r.touchData.startPosition[di]&&zt&&(r.touchData.singleTouchMoved=!0);if(ye&&(lt==null||lt.pannable())&&Te.panningEnabled()&&Te.userPanningEnabled()){var ia=o(lt,r.touchData.starts);ia&&(de.preventDefault(),r.data.bgActivePosistion||(r.data.bgActivePosistion=Jf(r.touchData.startPosition)),r.swipePanning?(Te.panBy({x:Ft[0]*Ge,y:Ft[1]*Ge}),Te.emit(ut("dragpan"))):zt&&(r.swipePanning=!0,Te.panBy({x:Gt*Ge,y:kr*Ge}),Te.emit(ut("dragpan")),lt&&(lt.unactivate(),r.redrawHint("select",!0),r.touchData.start=null)));var ct=r.projectIntoViewport(de.touches[0].clientX,de.touches[0].clientY);Re[0]=ct[0],Re[1]=ct[1]}}for(var xt=0;xt<Re.length;xt++)Ze[xt]=Re[xt];ye&&de.touches.length>0&&!r.hoverData.draggingEles&&!r.swipePanning&&r.data.bgActivePosistion!=null&&(r.data.bgActivePosistion=void 0,r.redrawHint("select",!0),r.redraw())}},!1);var Ve;r.registerBinding(e,"touchcancel",Ve=function(de){var ye=r.touchData.start;r.touchData.capture=!1,ye&&ye.unactivate()});var Oe,et,Ne,ze;if(r.registerBinding(e,"touchend",Oe=function(de){var ye=r.touchData.start,Ce=r.touchData.capture;if(Ce)de.touches.length===0&&(r.touchData.capture=!1),de.preventDefault();else return;var Te=r.selection;r.swipePanning=!1,r.hoverData.draggingEles=!1;var Re=r.cy,Ze=Re.zoom(),Ge=r.touchData.now,ct=r.touchData.earlier;if(de.touches[0]){var ut=r.projectIntoViewport(de.touches[0].clientX,de.touches[0].clientY);Ge[0]=ut[0],Ge[1]=ut[1]}if(de.touches[1]){var ut=r.projectIntoViewport(de.touches[1].clientX,de.touches[1].clientY);Ge[2]=ut[0],Ge[3]=ut[1]}if(de.touches[2]){var ut=r.projectIntoViewport(de.touches[2].clientX,de.touches[2].clientY);Ge[4]=ut[0],Ge[5]=ut[1]}var kt=function(Ma){return{originalEvent:de,type:Ma,position:{x:Ge[0],y:Ge[1]}}};ye&&ye.unactivate();var zt;if(r.touchData.cxt){if(zt=kt("cxttapend"),ye?ye.emit(zt):Re.emit(zt),!r.touchData.cxtDragged){var Ft=kt("cxttap");ye?ye.emit(Ft):Re.emit(Ft)}r.touchData.start&&(r.touchData.start._private.grabbed=!1),r.touchData.cxt=!1,r.touchData.start=null,r.redraw();return}if(!de.touches[2]&&Re.boxSelectionEnabled()&&r.touchData.selecting){r.touchData.selecting=!1;var xt=Re.collection(r.getAllInBox(Te[0],Te[1],Te[2],Te[3]));Te[0]=void 0,Te[1]=void 0,Te[2]=void 0,Te[3]=void 0,Te[4]=0,r.redrawHint("select",!0),Re.emit(kt("boxend"));var Gt=function(Ma){return Ma.selectable()&&!Ma.selected()};xt.emit(kt("box")).stdFilter(Gt).select().emit(kt("boxselect")),xt.nonempty()&&r.redrawHint("eles",!0),r.redraw()}if(ye?.unactivate(),de.touches[2])r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);else if(!de.touches[1]){if(!de.touches[0]){if(!de.touches[0]){r.data.bgActivePosistion=void 0,r.redrawHint("select",!0);var Wt=r.dragData.touchDragEles;if(ye!=null){var kr=ye._private.grabbed;T(Wt),r.redrawHint("drag",!0),r.redrawHint("eles",!0),kr&&(ye.emit(kt("freeon")),Wt.emit(kt("free")),r.dragData.didDrag&&(ye.emit(kt("dragfreeon")),Wt.emit(kt("dragfree")))),a(ye,["touchend","tapend","vmouseup","tapdragout"],de,{x:Ge[0],y:Ge[1]}),ye.unactivate(),r.touchData.start=null}else{var pr=r.findNearestElement(Ge[0],Ge[1],!0,!0);a(pr,["touchend","tapend","vmouseup","tapdragout"],de,{x:Ge[0],y:Ge[1]})}var pn=r.touchData.startPosition[0]-Ge[0],qr=pn*pn,Wr=r.touchData.startPosition[1]-Ge[1],an=Wr*Wr,cr=qr+an,bt=cr*Ze*Ze;r.touchData.singleTouchMoved||(ye||Re.$(":selected").unselect(["tapunselect"]),a(ye,["tap","vclick"],de,{x:Ge[0],y:Ge[1]}),et=!1,de.timeStamp-ze<=Re.multiClickDebounceTime()?(Ne&&clearTimeout(Ne),et=!0,ze=null,a(ye,["dbltap","vdblclick"],de,{x:Ge[0],y:Ge[1]})):(Ne=setTimeout(function(){et||a(ye,["onetap","voneclick"],de,{x:Ge[0],y:Ge[1]})},Re.multiClickDebounceTime()),ze=de.timeStamp)),ye!=null&&!r.dragData.didDrag&&ye._private.selectable&&bt<r.touchTapThreshold2&&!r.pinching&&(Re.selectionType()==="single"?(Re.$(n).unmerge(ye).unselect(["tapunselect"]),ye.select(["tapselect"])):ye.selected()?ye.unselect(["tapunselect"]):ye.select(["tapselect"]),r.redrawHint("eles",!0)),r.touchData.singleTouchMoved=!0}}}for(var Or=0;Or<Ge.length;Or++)ct[Or]=Ge[Or];r.dragData.didDrag=!1,de.touches.length===0&&(r.touchData.dragDelta=[],r.touchData.startPosition=[null,null,null,null,null,null],r.touchData.startGPosition=null,r.touchData.didSelect=!1),de.touches.length<2&&(de.touches.length===1&&(r.touchData.startGPosition=[de.touches[0].clientX,de.touches[0].clientY]),r.pinching=!1,r.redrawHint("eles",!0),r.redraw())},!1),typeof TouchEvent>"u"){var Ke=[],ft=function(de){return{clientX:de.clientX,clientY:de.clientY,force:1,identifier:de.pointerId,pageX:de.pageX,pageY:de.pageY,radiusX:de.width/2,radiusY:de.height/2,screenX:de.screenX,screenY:de.screenY,target:de.target}},yt=function(de){return{event:de,touch:ft(de)}},Et=function(de){Ke.push(yt(de))},Rt=function(de){for(var ye=0;ye<Ke.length;ye++){var Ce=Ke[ye];if(Ce.event.pointerId===de.pointerId){Ke.splice(ye,1);return}}},$t=function(de){var ye=Ke.filter(function(Ce){return Ce.event.pointerId===de.pointerId})[0];ye.event=de,ye.touch=ft(de)},wt=function(de){de.touches=Ke.map(function(ye){return ye.touch})},ot=function(de){return de.pointerType==="mouse"||de.pointerType===4};r.registerBinding(r.container,"pointerdown",function(qe){ot(qe)||(qe.preventDefault(),Et(qe),wt(qe),Je(qe))}),r.registerBinding(r.container,"pointerup",function(qe){ot(qe)||(Rt(qe),wt(qe),Oe(qe))}),r.registerBinding(r.container,"pointercancel",function(qe){ot(qe)||(Rt(qe),wt(qe),Ve(qe))}),r.registerBinding(r.container,"pointermove",function(qe){ot(qe)||(qe.preventDefault(),$t(qe),wt(qe),at(qe))})}};var Qu={};Qu.generatePolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,draw:function(i,a,s,o,l,u){this.renderer.nodeShapeImpl("polygon",i,a,s,o,l,this.points)},intersectLine:function(i,a,s,o,l,u,c,d){return Bg(l,u,this.points,i,a,s/2,o/2,c)},checkPoint:function(i,a,s,o,l,u,c,d){return Ku(i,a,this.points,u,c,o,l,[0,-1],s)},hasMiterBounds:r!=="rectangle",miterBounds:function(i,a,s,o,l,u){return uD(this.points,i,a,s,o,l)}}};Qu.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s)},intersectLine:function(e,n,i,a,s,o,l,u){return vD(s,o,e,n,i/2+l,a/2+l)},checkPoint:function(e,n,i,a,s,o,l,u){return Sh(e,n,a,s,o,l,i)}}};Qu.generateRoundPolygon=function(r,e){return this.nodeShapes[r]={renderer:this,name:r,points:e,getOrCreateCorners:function(i,a,s,o,l,u,c){if(u[c]!==void 0&&u[c+"-cx"]===i&&u[c+"-cy"]===a)return u[c];u[c]=new Array(e.length/2),u[c+"-cx"]=i,u[c+"-cy"]=a;var d=s/2,p=o/2;l=l==="auto"?q4(s,o):l;for(var v=new Array(e.length/2),y=0;y<e.length/2;y++)v[y]={x:i+d*e[y*2],y:a+p*e[y*2+1]};var b,S,k,T,C=v.length;for(S=v[C-1],b=0;b<C;b++)k=v[b%C],T=v[(b+1)%C],u[c][b]=K_(S,k,T,l),S=k,k=T;return u[c]},draw:function(i,a,s,o,l,u,c){this.renderer.nodeShapeImpl("round-polygon",i,a,s,o,l,this.points,this.getOrCreateCorners(a,s,o,l,u,c,"drawCorners"))},intersectLine:function(i,a,s,o,l,u,c,d,p){return xD(l,u,this.points,i,a,s,o,c,this.getOrCreateCorners(i,a,s,o,d,p,"corners"))},checkPoint:function(i,a,s,o,l,u,c,d,p){return gD(i,a,this.points,u,c,o,l,this.getOrCreateCorners(u,c,o,l,d,p,"corners"))}}};Qu.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:us(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s,this.points,o)},intersectLine:function(e,n,i,a,s,o,l,u){return H4(s,o,e,n,i,a,l,u)},checkPoint:function(e,n,i,a,s,o,l,u){var c=a/2,d=s/2;u=u==="auto"?_d(a,s):u,u=Math.min(c,d,u);var p=u*2;return!!(Ku(e,n,this.points,o,l,a,s-p,[0,-1],i)||Ku(e,n,this.points,o,l,a-p,s,[0,-1],i)||Sh(e,n,p,p,o-c+u,l-d+u,i)||Sh(e,n,p,p,o+c-u,l-d+u,i)||Sh(e,n,p,p,o+c-u,l+d-u,i)||Sh(e,n,p,p,o-c+u,l+d-u,i))}}};Qu.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:I_(),points:us(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s,null,o)},generateCutTrianglePts:function(e,n,i,a,s){var o=s==="auto"?this.cornerLength:s,l=n/2,u=e/2,c=i-u,d=i+u,p=a-l,v=a+l;return{topLeft:[c,p+o,c+o,p,c+o,p+o],topRight:[d-o,p,d,p+o,d-o,p+o],bottomRight:[d,v-o,d-o,v,d-o,v-o],bottomLeft:[c+o,v,c,v-o,c+o,v-o]}},intersectLine:function(e,n,i,a,s,o,l,u){var c=this.generateCutTrianglePts(i+2*l,a+2*l,e,n,u),d=[].concat.apply([],[c.topLeft.splice(0,4),c.topRight.splice(0,4),c.bottomRight.splice(0,4),c.bottomLeft.splice(0,4)]);return Bg(s,o,d,e,n)},checkPoint:function(e,n,i,a,s,o,l,u){var c=u==="auto"?this.cornerLength:u;if(Ku(e,n,this.points,o,l,a,s-2*c,[0,-1],i)||Ku(e,n,this.points,o,l,a-2*c,s,[0,-1],i))return!0;var d=this.generateCutTrianglePts(a,s,o,l);return Ms(e,n,d.topLeft)||Ms(e,n,d.topRight)||Ms(e,n,d.bottomRight)||Ms(e,n,d.bottomLeft)}}};Qu.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:us(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s)},intersectLine:function(e,n,i,a,s,o,l,u){var c=.15,d=.5,p=.85,v=this.generateBarrelBezierPts(i+2*l,a+2*l,e,n),y=function(k){var T=ip({x:k[0],y:k[1]},{x:k[2],y:k[3]},{x:k[4],y:k[5]},c),C=ip({x:k[0],y:k[1]},{x:k[2],y:k[3]},{x:k[4],y:k[5]},d),N=ip({x:k[0],y:k[1]},{x:k[2],y:k[3]},{x:k[4],y:k[5]},p);return[k[0],k[1],T.x,T.y,C.x,C.y,N.x,N.y,k[4],k[5]]},b=[].concat(y(v.topLeft),y(v.topRight),y(v.bottomRight),y(v.bottomLeft));return Bg(s,o,b,e,n)},generateBarrelBezierPts:function(e,n,i,a){var s=n/2,o=e/2,l=i-o,u=i+o,c=a-s,d=a+s,p=x2(e,n),v=p.heightOffset,y=p.widthOffset,b=p.ctrlPtOffsetPct*e,S={topLeft:[l,c+v,l+b,c,l+y,c],topRight:[u-y,c,u-b,c,u,c+v],bottomRight:[u,d-v,u-b,d,u-y,d],bottomLeft:[l+y,d,l+b,d,l,d-v]};return S.topLeft.isTop=!0,S.topRight.isTop=!0,S.bottomLeft.isBottom=!0,S.bottomRight.isBottom=!0,S},checkPoint:function(e,n,i,a,s,o,l,u){var c=x2(a,s),d=c.heightOffset,p=c.widthOffset;if(Ku(e,n,this.points,o,l,a,s-2*d,[0,-1],i)||Ku(e,n,this.points,o,l,a-2*p,s,[0,-1],i))return!0;for(var v=this.generateBarrelBezierPts(a,s,o,l),y=function(I,z,V){var $=V[4],Y=V[2],D=V[0],q=V[5],G=V[1],Z=Math.min($,D),Q=Math.max($,D),J=Math.min(q,G),ie=Math.max(q,G);if(Z<=I&&I<=Q&&J<=z&&z<=ie){var ne=bD($,Y,D),W=hD(ne[0],ne[1],ne[2],I),re=W.filter(function(ae){return 0<=ae&&ae<=1});if(re.length>0)return re[0]}return null},b=Object.keys(v),S=0;S<b.length;S++){var k=b[S],T=v[k],C=y(e,n,T);if(C!=null){var N=T[5],P=T[3],R=T[1],O=$i(N,P,R,C);if(T.isTop&&O<=n||T.isBottom&&n<=O)return!0}}return!1}}};Qu.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:us(4,0),draw:function(e,n,i,a,s,o){this.renderer.nodeShapeImpl(this.name,e,n,i,a,s,this.points,o)},intersectLine:function(e,n,i,a,s,o,l,u){var c=e-(i/2+l),d=n-(a/2+l),p=d,v=e+(i/2+l),y=ld(s,o,e,n,c,d,v,p,!1);return y.length>0?y:H4(s,o,e,n,i,a,l,u)},checkPoint:function(e,n,i,a,s,o,l,u){u=u==="auto"?_d(a,s):u;var c=2*u;if(Ku(e,n,this.points,o,l,a,s-c,[0,-1],i)||Ku(e,n,this.points,o,l,a-c,s,[0,-1],i))return!0;var d=a/2+2*i,p=s/2+2*i,v=[o-d,l-p,o-d,l,o+d,l,o+d,l-p];return!!(Ms(e,n,v)||Sh(e,n,c,c,o+a/2-u,l+s/2-u,i)||Sh(e,n,c,c,o-a/2+u,l+s/2-u,i))}}};Qu.registerNodeShapes=function(){var r=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",us(3,0)),this.generateRoundPolygon("round-triangle",us(3,0)),this.generatePolygon("rectangle",us(4,0)),r.square=r.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var n=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",n),this.generateRoundPolygon("round-diamond",n)}this.generatePolygon("pentagon",us(5,0)),this.generateRoundPolygon("round-pentagon",us(5,0)),this.generatePolygon("hexagon",us(6,0)),this.generateRoundPolygon("round-hexagon",us(6,0)),this.generatePolygon("heptagon",us(7,0)),this.generateRoundPolygon("round-heptagon",us(7,0)),this.generatePolygon("octagon",us(8,0)),this.generateRoundPolygon("round-octagon",us(8,0));var i=new Array(20);{var a=y2(5,0),s=y2(5,Math.PI/5),o=.5*(3-Math.sqrt(5));o*=1.57;for(var l=0;l<s.length/2;l++)s[l*2]*=o,s[l*2+1]*=o;for(var l=0;l<20/4;l++)i[l*4]=a[l*2],i[l*4+1]=a[l*2+1],i[l*4+2]=s[l*2],i[l*4+3]=s[l*2+1]}i=G4(i),this.generatePolygon("star",i),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var u=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",u),this.generateRoundPolygon("round-tag",u)}r.makePolygon=function(c){var d=c.join("$"),p="polygon-"+d,v;return(v=this[p])?v:e.generatePolygon(p,c)}};var gv={};gv.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};gv.redraw=function(r){r=r||z4();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=r};gv.beforeRender=function(r,e){if(!this.destroyed){e==null&&Rn("Priority is not optional for beforeRender");var n=this.beforeRenderCallbacks;n.push({fn:r,priority:e}),n.sort(function(i,a){return a.priority-i.priority})}};var hN=function(e,n,i){for(var a=e.beforeRenderCallbacks,s=0;s<a.length;s++)a[s].fn(n,i)};gv.startRenderLoop=function(){var r=this,e=r.cy;if(!r.renderLoopStarted){r.renderLoopStarted=!0;var n=function(a){if(!r.destroyed){if(!e.batching())if(r.requestedFrame&&!r.skipFrame){hN(r,!0,a);var s=$u();r.render(r.renderOptions);var o=r.lastDrawTime=$u();r.averageRedrawTime===void 0&&(r.averageRedrawTime=o-s),r.redrawCount===void 0&&(r.redrawCount=0),r.redrawCount++,r.redrawTotalTime===void 0&&(r.redrawTotalTime=0);var l=o-s;r.redrawTotalTime+=l,r.lastRedrawTime=l,r.averageRedrawTime=r.averageRedrawTime/2+l/2,r.requestedFrame=!1}else hN(r,!1,a);r.skipFrame=!1,sy(n)}};sy(n)}};var D7=function(e){this.init(e)},qP=D7,Rp=qP.prototype;Rp.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];Rp.init=function(r){var e=this;e.options=r,e.cy=r.cy;var n=e.container=r.cy.container(),i=e.cy.window();if(i){var a=i.document,s=a.head,o="__________cytoscape_stylesheet",l="__________cytoscape_container",u=a.getElementById(o)!=null;if(n.className.indexOf(l)<0&&(n.className=(n.className||"")+" "+l),!u){var c=a.createElement("style");c.id=o,c.textContent="."+l+" { position: relative; }",s.insertBefore(c,s.children[0])}var d=i.getComputedStyle(n),p=d.getPropertyValue("position");p==="static"&&zr("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=r.showFps,e.debug=r.debug,e.webgl=r.webgl,e.hideEdgesOnViewport=r.hideEdgesOnViewport,e.textureOnViewport=r.textureOnViewport,e.wheelSensitivity=r.wheelSensitivity,e.motionBlurEnabled=r.motionBlur,e.forcedPixelRatio=ht(r.pixelRatio)?r.pixelRatio:null,e.motionBlur=r.motionBlur,e.motionBlurOpacity=r.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=r.desktopTapThreshold,e.desktopTapThreshold2=r.desktopTapThreshold*r.desktopTapThreshold,e.touchTapThreshold=r.touchTapThreshold,e.touchTapThreshold2=r.touchTapThreshold*r.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};Rp.notify=function(r,e){var n=this,i=n.cy;if(!this.destroyed){if(r==="init"){n.load();return}if(r==="destroy"){n.destroy();return}(r==="add"||r==="remove"||r==="move"&&i.hasCompoundNodes()||r==="load"||r==="zorder"||r==="mount")&&n.invalidateCachedZSortedEles(),r==="viewport"&&n.redrawHint("select",!0),r==="gc"&&n.redrawHint("gc",!0),(r==="load"||r==="resize"||r==="mount")&&(n.invalidateContainerClientCoordsCache(),n.matchCanvasSize(n.container)),n.redrawHint("eles",!0),n.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};Rp.destroy=function(){var r=this;r.destroyed=!0,r.cy.stopAnimationLoop();for(var e=0;e<r.bindings.length;e++){var n=r.bindings[e],i=n,a=i.target;(a.off||a.removeEventListener).apply(a,i.args)}if(r.bindings=[],r.beforeRenderCallbacks=[],r.onUpdateEleCalcsFns=[],r.removeObserver&&r.removeObserver.disconnect(),r.styleObserver&&r.styleObserver.disconnect(),r.resizeObserver&&r.resizeObserver.disconnect(),r.labelCalcDiv)try{document.body.removeChild(r.labelCalcDiv)}catch{}};Rp.isHeadless=function(){return!1};[$_,HP,GP,jp,Qu,gv].forEach(function(r){Ht(Rp,r)});var rw=1e3/60,WP={setupDequeueing:function(e){return function(){var i=this,a=this.renderer;if(!i.dequeueingSetup){i.dequeueingSetup=!0;var s=dv(function(){a.redrawHint("eles",!0),a.redrawHint("drag",!0),a.redraw()},e.deqRedrawThreshold),o=function(c,d){var p=$u(),v=a.averageRedrawTime,y=a.lastRedrawTime,b=[],S=a.cy.extent(),k=a.getPixelRatio();for(c||a.flushRenderedStyleQueue();;){var T=$u(),C=T-p,N=T-d;if(y<rw){var P=rw-(c?v:0);if(N>=e.deqFastCost*P)break}else if(c){if(C>=e.deqCost*y||C>=e.deqAvgCost*v)break}else if(N>=e.deqNoDrawCost*rw)break;var R=e.deq(i,k,S);if(R.length>0)for(var O=0;O<R.length;O++)b.push(R[O]);else break}b.length>0&&(e.onDeqd(i,b),!c&&e.shouldRedraw(i,b,k,S)&&s())},l=e.priority||j_;a.beforeRender(o,l(i))}}}},I7=(function(){function r(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:oy;Pd(this,r),this.idsByKey=new Hu,this.keyForId=new Hu,this.cachesByLvl=new Hu,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=n}return Md(r,[{key:"getIdsFor",value:function(n){n==null&&Rn("Can not get id list for null key");var i=this.idsByKey,a=this.idsByKey.get(n);return a||(a=new Tp,i.set(n,a)),a}},{key:"addIdForKey",value:function(n,i){n!=null&&this.getIdsFor(n).add(i)}},{key:"deleteIdForKey",value:function(n,i){n!=null&&this.getIdsFor(n).delete(i)}},{key:"getNumberOfIdsForKey",value:function(n){return n==null?0:this.getIdsFor(n).size}},{key:"updateKeyMappingFor",value:function(n){var i=n.id(),a=this.keyForId.get(i),s=this.getKey(n);this.deleteIdForKey(a,i),this.addIdForKey(s,i),this.keyForId.set(i,s)}},{key:"deleteKeyMappingFor",value:function(n){var i=n.id(),a=this.keyForId.get(i);this.deleteIdForKey(a,i),this.keyForId.delete(i)}},{key:"keyHasChangedFor",value:function(n){var i=n.id(),a=this.keyForId.get(i),s=this.getKey(n);return a!==s}},{key:"isInvalid",value:function(n){return this.keyHasChangedFor(n)||this.doesEleInvalidateKey(n)}},{key:"getCachesAt",value:function(n){var i=this.cachesByLvl,a=this.lvls,s=i.get(n);return s||(s=new Hu,i.set(n,s),a.push(n)),s}},{key:"getCache",value:function(n,i){return this.getCachesAt(i).get(n)}},{key:"get",value:function(n,i){var a=this.getKey(n),s=this.getCache(a,i);return s!=null&&this.updateKeyMappingFor(n),s}},{key:"getForCachedKey",value:function(n,i){var a=this.keyForId.get(n.id()),s=this.getCache(a,i);return s}},{key:"hasCache",value:function(n,i){return this.getCachesAt(i).has(n)}},{key:"has",value:function(n,i){var a=this.getKey(n);return this.hasCache(a,i)}},{key:"setCache",value:function(n,i,a){a.key=n,this.getCachesAt(i).set(n,a)}},{key:"set",value:function(n,i,a){var s=this.getKey(n);this.setCache(s,i,a),this.updateKeyMappingFor(n)}},{key:"deleteCache",value:function(n,i){this.getCachesAt(i).delete(n)}},{key:"delete",value:function(n,i){var a=this.getKey(n);this.deleteCache(a,i)}},{key:"invalidateKey",value:function(n){var i=this;this.lvls.forEach(function(a){return i.deleteCache(n,a)})}},{key:"invalidate",value:function(n){var i=n.id(),a=this.keyForId.get(i);this.deleteKeyMappingFor(n);var s=this.doesEleInvalidateKey(n);return s&&this.invalidateKey(a),s||this.getNumberOfIdsForKey(a)===0}}])})(),fN=25,p0=50,W0=-4,j2=3,$P=7.99,B7=8,z7=1024,F7=1024,V7=1024,U7=.2,H7=.8,G7=10,q7=.15,W7=.1,$7=.9,K7=.9,Z7=100,Y7=1,tp={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},X7=Ta({getKey:null,doesEleInvalidateKey:oy,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:D4,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),ug=function(e,n){var i=this;i.renderer=e,i.onDequeues=[];var a=X7(n);Ht(i,a),i.lookup=new I7(a.getKey,a.doesEleInvalidateKey),i.setupDequeueing()},ji=ug.prototype;ji.reasons=tp;ji.getTextureQueue=function(r){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[r]=e.eleImgCaches[r]||[]};ji.getRetiredTextureQueue=function(r){var e=this,n=e.eleImgCaches.retired=e.eleImgCaches.retired||{},i=n[r]=n[r]||[];return i};ji.getElementQueue=function(){var r=this,e=r.eleCacheQueue=r.eleCacheQueue||new hv(function(n,i){return i.reqs-n.reqs});return e};ji.getElementKeyToQueue=function(){var r=this,e=r.eleKeyToCacheQueue=r.eleKeyToCacheQueue||{};return e};ji.getElement=function(r,e,n,i,a){var s=this,o=this.renderer,l=o.cy.zoom(),u=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!r.visible()||r.removed()||!s.allowEdgeTxrCaching&&r.isEdge()||!s.allowParentTxrCaching&&r.isParent())return null;if(i==null&&(i=Math.ceil(L_(l*n))),i<W0)i=W0;else if(l>=$P||i>j2)return null;var c=Math.pow(2,i),d=e.h*c,p=e.w*c,v=o.eleTextBiggerThanMin(r,c);if(!this.isVisible(r,v))return null;var y=u.get(r,i);if(y&&y.invalidated&&(y.invalidated=!1,y.texture.invalidatedWidth-=y.width),y)return y;var b;if(d<=fN?b=fN:d<=p0?b=p0:b=Math.ceil(d/p0)*p0,d>V7||p>F7)return null;var S=s.getTextureQueue(b),k=S[S.length-2],T=function(){return s.recycleTexture(b,p)||s.addTexture(b,p)};k||(k=S[S.length-1]),k||(k=T()),k.width-k.usedWidth<p&&(k=T());for(var C=function(Z){return Z&&Z.scaledLabelShown===v},N=a&&a===tp.dequeue,P=a&&a===tp.highQuality,R=a&&a===tp.downscale,O,B=i+1;B<=j2;B++){var I=u.get(r,B);if(I){O=I;break}}var z=O&&O.level===i+1?O:null,V=function(){k.context.drawImage(z.texture.canvas,z.x,0,z.width,z.height,k.usedWidth,0,p,d)};if(k.context.setTransform(1,0,0,1,0,0),k.context.clearRect(k.usedWidth,0,p,b),C(z))V();else if(C(O))if(P){for(var $=O.level;$>i;$--)z=s.getElement(r,e,n,$,tp.downscale);V()}else return s.queueElement(r,O.level-1),O;else{var Y;if(!N&&!P&&!R)for(var D=i-1;D>=W0;D--){var q=u.get(r,D);if(q){Y=q;break}}if(C(Y))return s.queueElement(r,i),Y;k.context.translate(k.usedWidth,0),k.context.scale(c,c),this.drawElement(k.context,r,e,v,!1),k.context.scale(1/c,1/c),k.context.translate(-k.usedWidth,0)}return y={x:k.usedWidth,texture:k,level:i,scale:c,width:p,height:d,scaledLabelShown:v},k.usedWidth+=Math.ceil(p+B7),k.eleCaches.push(y),u.set(r,i,y),s.checkTextureFullness(k),y};ji.invalidateElements=function(r){for(var e=0;e<r.length;e++)this.invalidateElement(r[e])};ji.invalidateElement=function(r){var e=this,n=e.lookup,i=[],a=n.isInvalid(r);if(a){for(var s=W0;s<=j2;s++){var o=n.getForCachedKey(r,s);o&&i.push(o)}var l=n.invalidate(r);if(l)for(var u=0;u<i.length;u++){var c=i[u],d=c.texture;d.invalidatedWidth+=c.width,c.invalidated=!0,e.checkTextureUtility(d)}e.removeFromQueue(r)}};ji.checkTextureUtility=function(r){r.invalidatedWidth>=U7*r.width&&this.retireTexture(r)};ji.checkTextureFullness=function(r){var e=this,n=e.getTextureQueue(r.height);r.usedWidth/r.width>H7&&r.fullnessChecks>=G7?wd(n,r):r.fullnessChecks++};ji.retireTexture=function(r){var e=this,n=r.height,i=e.getTextureQueue(n),a=this.lookup;wd(i,r),r.retired=!0;for(var s=r.eleCaches,o=0;o<s.length;o++){var l=s[o];a.deleteCache(l.key,l.level)}R_(s);var u=e.getRetiredTextureQueue(n);u.push(r)};ji.addTexture=function(r,e){var n=this,i=n.getTextureQueue(r),a={};return i.push(a),a.eleCaches=[],a.height=r,a.width=Math.max(z7,e),a.usedWidth=0,a.invalidatedWidth=0,a.fullnessChecks=0,a.canvas=n.renderer.makeOffscreenCanvas(a.width,a.height),a.context=a.canvas.getContext("2d"),a};ji.recycleTexture=function(r,e){for(var n=this,i=n.getTextureQueue(r),a=n.getRetiredTextureQueue(r),s=0;s<a.length;s++){var o=a[s];if(o.width>=e)return o.retired=!1,o.usedWidth=0,o.invalidatedWidth=0,o.fullnessChecks=0,R_(o.eleCaches),o.context.setTransform(1,0,0,1,0,0),o.context.clearRect(0,0,o.width,o.height),wd(a,o),i.push(o),o}};ji.queueElement=function(r,e){var n=this,i=n.getElementQueue(),a=n.getElementKeyToQueue(),s=this.getKey(r),o=a[s];if(o)o.level=Math.max(o.level,e),o.eles.merge(r),o.reqs++,i.updateItem(o);else{var l={eles:r.spawn().merge(r),level:e,reqs:1,key:s};i.push(l),a[s]=l}};ji.dequeue=function(r){for(var e=this,n=e.getElementQueue(),i=e.getElementKeyToQueue(),a=[],s=e.lookup,o=0;o<Y7&&n.size()>0;o++){var l=n.pop(),u=l.key,c=l.eles[0],d=s.hasCache(c,l.level);if(i[u]=null,d)continue;a.push(l);var p=e.getBoundingBox(c);e.getElement(c,p,r,l.level,tp.dequeue)}return a};ji.removeFromQueue=function(r){var e=this,n=e.getElementQueue(),i=e.getElementKeyToQueue(),a=this.getKey(r),s=i[a];s!=null&&(s.eles.length===1?(s.reqs=A_,n.updateItem(s),n.pop(),i[a]=null):s.eles.unmerge(r))};ji.onDequeue=function(r){this.onDequeues.push(r)};ji.offDequeue=function(r){wd(this.onDequeues,r)};ji.setupDequeueing=WP.setupDequeueing({deqRedrawThreshold:Z7,deqCost:q7,deqAvgCost:W7,deqNoDrawCost:$7,deqFastCost:K7,deq:function(e,n,i){return e.dequeue(n,i)},onDeqd:function(e,n){for(var i=0;i<e.onDequeues.length;i++){var a=e.onDequeues[i];a(n)}},shouldRedraw:function(e,n,i,a){for(var s=0;s<n.length;s++)for(var o=n[s].eles,l=0;l<o.length;l++){var u=o[l].boundingBox();if(D_(u,a))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var Q7=1,vg=-4,my=2,J7=3.99,eB=50,tB=50,rB=.15,nB=.1,iB=.9,aB=.9,sB=1,pN=250,oB=4e3*4e3,mN=32767,lB=!0,KP=function(e){var n=this,i=n.renderer=e,a=i.cy;n.layersByLevel={},n.firstGet=!0,n.lastInvalidationTime=$u()-2*pN,n.skipping=!1,n.eleTxrDeqs=a.collection(),n.scheduleElementRefinement=dv(function(){n.refineElementTextures(n.eleTxrDeqs),n.eleTxrDeqs.unmerge(n.eleTxrDeqs)},tB),i.beforeRender(function(o,l){l-n.lastInvalidationTime<=pN?n.skipping=!0:n.skipping=!1},i.beforeRenderPriorities.lyrTxrSkip);var s=function(l,u){return u.reqs-l.reqs};n.layersQueue=new hv(s),n.setupDequeueing()},Pa=KP.prototype,gN=0,uB=Math.pow(2,53)-1;Pa.makeLayer=function(r,e){var n=Math.pow(2,e),i=Math.ceil(r.w*n),a=Math.ceil(r.h*n),s=this.renderer.makeOffscreenCanvas(i,a),o={id:gN=++gN%uB,bb:r,level:e,width:i,height:a,canvas:s,context:s.getContext("2d"),eles:[],elesQueue:[],reqs:0},l=o.context,u=-o.bb.x1,c=-o.bb.y1;return l.scale(n,n),l.translate(u,c),o};Pa.getLayers=function(r,e,n){var i=this,a=i.renderer,s=a.cy,o=s.zoom(),l=i.firstGet;if(i.firstGet=!1,n==null){if(n=Math.ceil(L_(o*e)),n<vg)n=vg;else if(o>=J7||n>my)return null}i.validateLayersElesOrdering(n,r);var u=i.layersByLevel,c=Math.pow(2,n),d=u[n]=u[n]||[],p,v=i.levelIsComplete(n,r),y,b=function(){var V=function(G){if(i.validateLayersElesOrdering(G,r),i.levelIsComplete(G,r))return y=u[G],!0},$=function(G){if(!y)for(var Z=n+G;vg<=Z&&Z<=my&&!V(Z);Z+=G);};$(1),$(-1);for(var Y=d.length-1;Y>=0;Y--){var D=d[Y];D.invalid&&wd(d,D)}};if(!v)b();else return d;var S=function(){if(!p){p=cs();for(var V=0;V<r.length;V++)sD(p,r[V].boundingBox())}return p},k=function(V){V=V||{};var $=V.after;S();var Y=Math.ceil(p.w*c),D=Math.ceil(p.h*c);if(Y>mN||D>mN)return null;var q=Y*D;if(q>oB)return null;var G=i.makeLayer(p,n);if($!=null){var Z=d.indexOf($)+1;d.splice(Z,0,G)}else(V.insert===void 0||V.insert)&&d.unshift(G);return G};if(i.skipping&&!l)return null;for(var T=null,C=r.length/Q7,N=!l,P=0;P<r.length;P++){var R=r[P],O=R._private.rscratch,B=O.imgLayerCaches=O.imgLayerCaches||{},I=B[n];if(I){T=I;continue}if((!T||T.eles.length>=C||!U4(T.bb,R.boundingBox()))&&(T=k({insert:!0,after:T}),!T))return null;y||N?i.queueLayer(T,R):i.drawEleInLayer(T,R,n,e),T.eles.push(R),B[n]=T}return y||(N?null:d)};Pa.getEleLevelForLayerLevel=function(r,e){return r};Pa.drawEleInLayer=function(r,e,n,i){var a=this,s=this.renderer,o=r.context,l=e.boundingBox();l.w===0||l.h===0||!e.visible()||(n=a.getEleLevelForLayerLevel(n,i),s.setImgSmoothing(o,!1),s.drawCachedElement(o,e,null,null,n,lB),s.setImgSmoothing(o,!0))};Pa.levelIsComplete=function(r,e){var n=this,i=n.layersByLevel[r];if(!i||i.length===0)return!1;for(var a=0,s=0;s<i.length;s++){var o=i[s];if(o.reqs>0||o.invalid)return!1;a+=o.eles.length}return a===e.length};Pa.validateLayersElesOrdering=function(r,e){var n=this.layersByLevel[r];if(n)for(var i=0;i<n.length;i++){for(var a=n[i],s=-1,o=0;o<e.length;o++)if(a.eles[0]===e[o]){s=o;break}if(s<0){this.invalidateLayer(a);continue}for(var l=s,o=0;o<a.eles.length;o++)if(a.eles[o]!==e[l+o]){this.invalidateLayer(a);break}}};Pa.updateElementsInLayers=function(r,e){for(var n=this,i=ov(r[0]),a=0;a<r.length;a++)for(var s=i?null:r[a],o=i?r[a]:r[a].ele,l=o._private.rscratch,u=l.imgLayerCaches=l.imgLayerCaches||{},c=vg;c<=my;c++){var d=u[c];d&&(s&&n.getEleLevelForLayerLevel(d.level)!==s.level||e(d,o,s))}};Pa.haveLayers=function(){for(var r=this,e=!1,n=vg;n<=my;n++){var i=r.layersByLevel[n];if(i&&i.length>0){e=!0;break}}return e};Pa.invalidateElements=function(r){var e=this;r.length!==0&&(e.lastInvalidationTime=$u(),!(r.length===0||!e.haveLayers())&&e.updateElementsInLayers(r,function(i,a,s){e.invalidateLayer(i)}))};Pa.invalidateLayer=function(r){if(this.lastInvalidationTime=$u(),!r.invalid){var e=r.level,n=r.eles,i=this.layersByLevel[e];wd(i,r),r.elesQueue=[],r.invalid=!0,r.replacement&&(r.replacement.invalid=!0);for(var a=0;a<n.length;a++){var s=n[a]._private.rscratch.imgLayerCaches;s&&(s[e]=null)}}};Pa.refineElementTextures=function(r){var e=this;e.updateElementsInLayers(r,function(i,a,s){var o=i.replacement;if(o||(o=i.replacement=e.makeLayer(i.bb,i.level),o.replaces=i,o.eles=i.eles),!o.reqs)for(var l=0;l<o.eles.length;l++)e.queueLayer(o,o.eles[l])})};Pa.enqueueElementRefinement=function(r){this.eleTxrDeqs.merge(r),this.scheduleElementRefinement()};Pa.queueLayer=function(r,e){var n=this,i=n.layersQueue,a=r.elesQueue,s=a.hasId=a.hasId||{};if(!r.replacement){if(e){if(s[e.id()])return;a.push(e),s[e.id()]=!0}r.reqs?(r.reqs++,i.updateItem(r)):(r.reqs=1,i.push(r))}};Pa.dequeue=function(r){for(var e=this,n=e.layersQueue,i=[],a=0;a<sB&&n.size()!==0;){var s=n.peek();if(s.replacement){n.pop();continue}if(s.replaces&&s!==s.replaces.replacement){n.pop();continue}if(s.invalid){n.pop();continue}var o=s.elesQueue.shift();o&&(e.drawEleInLayer(s,o,s.level,r),a++),i.length===0&&i.push(!0),s.elesQueue.length===0&&(n.pop(),s.reqs=0,s.replaces&&e.applyLayerReplacement(s),e.requestRedraw())}return i};Pa.applyLayerReplacement=function(r){var e=this,n=e.layersByLevel[r.level],i=r.replaces,a=n.indexOf(i);if(!(a<0||i.invalid)){n[a]=r;for(var s=0;s<r.eles.length;s++){var o=r.eles[s]._private,l=o.imgLayerCaches=o.imgLayerCaches||{};l&&(l[r.level]=r)}e.requestRedraw()}};Pa.requestRedraw=dv(function(){var r=this.renderer;r.redrawHint("eles",!0),r.redrawHint("drag",!0),r.redraw()},100);Pa.setupDequeueing=WP.setupDequeueing({deqRedrawThreshold:eB,deqCost:rB,deqAvgCost:nB,deqNoDrawCost:iB,deqFastCost:aB,deq:function(e,n){return e.dequeue(n)},onDeqd:j_,shouldRedraw:D4,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var ZP={},vN;function cB(r,e){for(var n=0;n<e.length;n++){var i=e[n];r.lineTo(i.x,i.y)}}function dB(r,e,n){for(var i,a=0;a<e.length;a++){var s=e[a];a===0&&(i=s),r.lineTo(s.x,s.y)}r.quadraticCurveTo(n.x,n.y,i.x,i.y)}function yN(r,e,n){r.beginPath&&r.beginPath();for(var i=e,a=0;a<i.length;a++){var s=i[a];r.lineTo(s.x,s.y)}var o=n,l=n[0];r.moveTo(l.x,l.y);for(var a=1;a<o.length;a++){var s=o[a];r.lineTo(s.x,s.y)}r.closePath&&r.closePath()}function hB(r,e,n,i,a){r.beginPath&&r.beginPath(),r.arc(n,i,a,0,Math.PI*2,!1);var s=e,o=s[0];r.moveTo(o.x,o.y);for(var l=0;l<s.length;l++){var u=s[l];r.lineTo(u.x,u.y)}r.closePath&&r.closePath()}function fB(r,e,n,i){r.arc(e,n,i,0,Math.PI*2,!1)}ZP.arrowShapeImpl=function(r){return(vN||(vN={polygon:cB,"triangle-backcurve":dB,"triangle-tee":yN,"circle-triangle":hB,"triangle-cross":yN,circle:fB}))[r]};var ou={};ou.drawElement=function(r,e,n,i,a,s){var o=this;e.isNode()?o.drawNode(r,e,n,i,a,s):o.drawEdge(r,e,n,i,a,s)};ou.drawElementOverlay=function(r,e){var n=this;e.isNode()?n.drawNodeOverlay(r,e):n.drawEdgeOverlay(r,e)};ou.drawElementUnderlay=function(r,e){var n=this;e.isNode()?n.drawNodeUnderlay(r,e):n.drawEdgeUnderlay(r,e)};ou.drawCachedElementPortion=function(r,e,n,i,a,s,o,l){var u=this,c=n.getBoundingBox(e);if(!(c.w===0||c.h===0)){var d=n.getElement(e,c,i,a,s);if(d!=null){var p=l(u,e);if(p===0)return;var v=o(u,e),y=c.x1,b=c.y1,S=c.w,k=c.h,T,C,N,P,R;if(v!==0){var O=n.getRotationPoint(e);N=O.x,P=O.y,r.translate(N,P),r.rotate(v),R=u.getImgSmoothing(r),R||u.setImgSmoothing(r,!0);var B=n.getRotationOffset(e);T=B.x,C=B.y}else T=y,C=b;var I;p!==1&&(I=r.globalAlpha,r.globalAlpha=I*p),r.drawImage(d.texture.canvas,d.x,0,d.width,d.height,T,C,S,k),p!==1&&(r.globalAlpha=I),v!==0&&(r.rotate(-v),r.translate(-N,-P),R||u.setImgSmoothing(r,!1))}else n.drawElement(r,e)}};var pB=function(){return 0},mB=function(e,n){return e.getTextAngle(n,null)},gB=function(e,n){return e.getTextAngle(n,"source")},vB=function(e,n){return e.getTextAngle(n,"target")},yB=function(e,n){return n.effectiveOpacity()},nw=function(e,n){return n.pstyle("text-opacity").pfValue*n.effectiveOpacity()};ou.drawCachedElement=function(r,e,n,i,a,s){var o=this,l=o.data,u=l.eleTxrCache,c=l.lblTxrCache,d=l.slbTxrCache,p=l.tlbTxrCache,v=e.boundingBox(),y=s===!0?u.reasons.highQuality:null;if(!(v.w===0||v.h===0||!e.visible())&&(!i||D_(v,i))){var b=e.isEdge(),S=e.element()._private.rscratch.badLine;o.drawElementUnderlay(r,e),o.drawCachedElementPortion(r,e,u,n,a,y,pB,yB),(!b||!S)&&o.drawCachedElementPortion(r,e,c,n,a,y,mB,nw),b&&!S&&(o.drawCachedElementPortion(r,e,d,n,a,y,gB,nw),o.drawCachedElementPortion(r,e,p,n,a,y,vB,nw)),o.drawElementOverlay(r,e)}};ou.drawElements=function(r,e){for(var n=this,i=0;i<e.length;i++){var a=e[i];n.drawElement(r,a)}};ou.drawCachedElements=function(r,e,n,i){for(var a=this,s=0;s<e.length;s++){var o=e[s];a.drawCachedElement(r,o,n,i)}};ou.drawCachedNodes=function(r,e,n,i){for(var a=this,s=0;s<e.length;s++){var o=e[s];o.isNode()&&a.drawCachedElement(r,o,n,i)}};ou.drawLayeredElements=function(r,e,n,i){var a=this,s=a.data.lyrTxrCache.getLayers(e,n);if(s)for(var o=0;o<s.length;o++){var l=s[o],u=l.bb;u.w===0||u.h===0||r.drawImage(l.canvas,u.x1,u.y1,u.w,u.h)}else a.drawCachedElements(r,e,n,i)};var Ju={};Ju.drawEdge=function(r,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,l=e._private.rscratch;if(!(s&&!e.visible())&&!(l.badLine||l.allpts==null||isNaN(l.allpts[0]))){var u;n&&(u=n,r.translate(-u.x1,-u.y1));var c=s?e.pstyle("opacity").value:1,d=s?e.pstyle("line-opacity").value:1,p=e.pstyle("curve-style").value,v=e.pstyle("line-style").value,y=e.pstyle("width").pfValue,b=e.pstyle("line-cap").value,S=e.pstyle("line-outline-width").value,k=e.pstyle("line-outline-color").value,T=c*d,C=c*d,N=function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:T;p==="straight-triangle"?(o.eleStrokeStyle(r,e,G),o.drawEdgeTrianglePath(e,r,l.allpts)):(r.lineWidth=y,r.lineCap=b,o.eleStrokeStyle(r,e,G),o.drawEdgePath(e,r,l.allpts,v),r.lineCap="butt")},P=function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:T;if(r.lineWidth=y+S,r.lineCap=b,S>0)o.colorStrokeStyle(r,k[0],k[1],k[2],G);else{r.lineCap="butt";return}p==="straight-triangle"?o.drawEdgeTrianglePath(e,r,l.allpts):(o.drawEdgePath(e,r,l.allpts,v),r.lineCap="butt")},R=function(){a&&o.drawEdgeOverlay(r,e)},O=function(){a&&o.drawEdgeUnderlay(r,e)},B=function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:C;o.drawArrowheads(r,e,G)},I=function(){o.drawElementText(r,e,null,i)};r.lineJoin="round";var z=e.pstyle("ghost").value==="yes";if(z){var V=e.pstyle("ghost-offset-x").pfValue,$=e.pstyle("ghost-offset-y").pfValue,Y=e.pstyle("ghost-opacity").value,D=T*Y;r.translate(V,$),N(D),B(D),r.translate(-V,-$)}else P();O(),N(),B(),R(),I(),n&&r.translate(u.x1,u.y1)}};var YP=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(n,i){if(i.visible()){var a=i.pstyle("".concat(e,"-opacity")).value;if(a!==0){var s=this,o=s.usePaths(),l=i._private.rscratch,u=i.pstyle("".concat(e,"-padding")).pfValue,c=2*u,d=i.pstyle("".concat(e,"-color")).value;n.lineWidth=c,l.edgeType==="self"&&!o?n.lineCap="butt":n.lineCap="round",s.colorStrokeStyle(n,d[0],d[1],d[2],a),s.drawEdgePath(i,n,l.allpts,"solid")}}}};Ju.drawEdgeOverlay=YP("overlay");Ju.drawEdgeUnderlay=YP("underlay");Ju.drawEdgePath=function(r,e,n,i){var a=r._private.rscratch,s=e,o,l=!1,u=this.usePaths(),c=r.pstyle("line-dash-pattern").pfValue,d=r.pstyle("line-dash-offset").pfValue;if(u){var p=n.join("$"),v=a.pathCacheKey&&a.pathCacheKey===p;v?(o=e=a.pathCache,l=!0):(o=e=new Path2D,a.pathCacheKey=p,a.pathCache=o)}if(s.setLineDash)switch(i){case"dotted":s.setLineDash([1,1]);break;case"dashed":s.setLineDash(c),s.lineDashOffset=d;break;case"solid":s.setLineDash([]);break}if(!l&&!a.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(n[0],n[1]),a.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var y=2;y+3<n.length;y+=4)e.quadraticCurveTo(n[y],n[y+1],n[y+2],n[y+3]);break;case"straight":case"haystack":for(var b=2;b+1<n.length;b+=2)e.lineTo(n[b],n[b+1]);break;case"segments":if(a.isRound){var S=js(a.roundCorners),k;try{for(S.s();!(k=S.n()).done;){var T=k.value;BP(e,T)}}catch(N){S.e(N)}finally{S.f()}e.lineTo(n[n.length-2],n[n.length-1])}else for(var C=2;C+1<n.length;C+=2)e.lineTo(n[C],n[C+1]);break}e=s,u?e.stroke(o):e.stroke(),e.setLineDash&&e.setLineDash([])};Ju.drawEdgeTrianglePath=function(r,e,n){e.fillStyle=e.strokeStyle;for(var i=r.pstyle("width").pfValue,a=0;a+1<n.length;a+=2){var s=[n[a+2]-n[a],n[a+3]-n[a+1]],o=Math.sqrt(s[0]*s[0]+s[1]*s[1]),l=[s[1]/o,-s[0]/o],u=[l[0]*i/2,l[1]*i/2];e.beginPath(),e.moveTo(n[a]-u[0],n[a+1]-u[1]),e.lineTo(n[a]+u[0],n[a+1]+u[1]),e.lineTo(n[a+2],n[a+3]),e.closePath(),e.fill()}};Ju.drawArrowheads=function(r,e,n){var i=e._private.rscratch,a=i.edgeType==="haystack";a||this.drawArrowhead(r,e,"source",i.arrowStartX,i.arrowStartY,i.srcArrowAngle,n),this.drawArrowhead(r,e,"mid-target",i.midX,i.midY,i.midtgtArrowAngle,n),this.drawArrowhead(r,e,"mid-source",i.midX,i.midY,i.midsrcArrowAngle,n),a||this.drawArrowhead(r,e,"target",i.arrowEndX,i.arrowEndY,i.tgtArrowAngle,n)};Ju.drawArrowhead=function(r,e,n,i,a,s,o){if(!(isNaN(i)||i==null||isNaN(a)||a==null||isNaN(s)||s==null)){var l=this,u=e.pstyle(n+"-arrow-shape").value;if(u!=="none"){var c=e.pstyle(n+"-arrow-fill").value==="hollow"?"both":"filled",d=e.pstyle(n+"-arrow-fill").value,p=e.pstyle("width").pfValue,v=e.pstyle(n+"-arrow-width"),y=v.value==="match-line"?p:v.pfValue;v.units==="%"&&(y*=p);var b=e.pstyle("opacity").value;o===void 0&&(o=b);var S=r.globalCompositeOperation;(o!==1||d==="hollow")&&(r.globalCompositeOperation="destination-out",l.colorFillStyle(r,255,255,255,1),l.colorStrokeStyle(r,255,255,255,1),l.drawArrowShape(e,r,c,p,u,y,i,a,s),r.globalCompositeOperation=S);var k=e.pstyle(n+"-arrow-color").value;l.colorFillStyle(r,k[0],k[1],k[2],o),l.colorStrokeStyle(r,k[0],k[1],k[2],o),l.drawArrowShape(e,r,d,p,u,y,i,a,s)}}};Ju.drawArrowShape=function(r,e,n,i,a,s,o,l,u){var c=this,d=this.usePaths()&&a!=="triangle-cross",p=!1,v,y=e,b={x:o,y:l},S=r.pstyle("arrow-scale").value,k=this.getArrowWidth(i,S),T=c.arrowShapes[a];if(d){var C=c.arrowPathCache=c.arrowPathCache||[],N=Dh(a),P=C[N];P!=null?(v=e=P,p=!0):(v=e=new Path2D,C[N]=v)}p||(e.beginPath&&e.beginPath(),d?T.draw(e,1,0,{x:0,y:0},1):T.draw(e,k,u,b,i),e.closePath&&e.closePath()),e=y,d&&(e.translate(o,l),e.rotate(u),e.scale(k,k)),(n==="filled"||n==="both")&&(d?e.fill(v):e.fill()),(n==="hollow"||n==="both")&&(e.lineWidth=s/(d?k:1),e.lineJoin="miter",d?e.stroke(v):e.stroke()),d&&(e.scale(1/k,1/k),e.rotate(-u),e.translate(-o,-l))};var Y_={};Y_.safeDrawImage=function(r,e,n,i,a,s,o,l,u,c){if(!(a<=0||s<=0||u<=0||c<=0))try{r.drawImage(e,n,i,a,s,o,l,u,c)}catch(d){zr(d)}};Y_.drawInscribedImage=function(r,e,n,i,a){var s=this,o=n.position(),l=o.x,u=o.y,c=n.cy().style(),d=c.getIndexedStyle.bind(c),p=d(n,"background-fit","value",i),v=d(n,"background-repeat","value",i),y=n.width(),b=n.height(),S=n.padding()*2,k=y+(d(n,"background-width-relative-to","value",i)==="inner"?0:S),T=b+(d(n,"background-height-relative-to","value",i)==="inner"?0:S),C=n._private.rscratch,N=d(n,"background-clip","value",i),P=N==="node",R=d(n,"background-image-opacity","value",i)*a,O=d(n,"background-image-smoothing","value",i),B=n.pstyle("corner-radius").value;B!=="auto"&&(B=n.pstyle("corner-radius").pfValue);var I=e.width||e.cachedW,z=e.height||e.cachedH;(I==null||z==null)&&(document.body.appendChild(e),I=e.cachedW=e.width||e.offsetWidth,z=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var V=I,$=z;if(d(n,"background-width","value",i)!=="auto"&&(d(n,"background-width","units",i)==="%"?V=d(n,"background-width","pfValue",i)*k:V=d(n,"background-width","pfValue",i)),d(n,"background-height","value",i)!=="auto"&&(d(n,"background-height","units",i)==="%"?$=d(n,"background-height","pfValue",i)*T:$=d(n,"background-height","pfValue",i)),!(V===0||$===0)){if(p==="contain"){var Y=Math.min(k/V,T/$);V*=Y,$*=Y}else if(p==="cover"){var Y=Math.max(k/V,T/$);V*=Y,$*=Y}var D=l-k/2,q=d(n,"background-position-x","units",i),G=d(n,"background-position-x","pfValue",i);q==="%"?D+=(k-V)*G:D+=G;var Z=d(n,"background-offset-x","units",i),Q=d(n,"background-offset-x","pfValue",i);Z==="%"?D+=(k-V)*Q:D+=Q;var J=u-T/2,ie=d(n,"background-position-y","units",i),ne=d(n,"background-position-y","pfValue",i);ie==="%"?J+=(T-$)*ne:J+=ne;var W=d(n,"background-offset-y","units",i),re=d(n,"background-offset-y","pfValue",i);W==="%"?J+=(T-$)*re:J+=re,C.pathCache&&(D-=l,J-=u,l=0,u=0);var ae=r.globalAlpha;r.globalAlpha=R;var he=s.getImgSmoothing(r),ve=!1;if(O==="no"&&he?(s.setImgSmoothing(r,!1),ve=!0):O==="yes"&&!he&&(s.setImgSmoothing(r,!0),ve=!0),v==="no-repeat")P&&(r.save(),C.pathCache?r.clip(C.pathCache):(s.nodeShapes[s.getNodeShape(n)].draw(r,l,u,k,T,B,C),r.clip())),s.safeDrawImage(r,e,0,0,I,z,D,J,V,$),P&&r.restore();else{var xe=r.createPattern(e,v);r.fillStyle=xe,s.nodeShapes[s.getNodeShape(n)].draw(r,l,u,k,T,B,C),r.translate(D,J),r.fill(),r.translate(-D,-J)}r.globalAlpha=ae,ve&&s.setImgSmoothing(r,he)}};var Xh={};Xh.eleTextBiggerThanMin=function(r,e){if(!e){var n=r.cy().zoom(),i=this.getPixelRatio(),a=Math.ceil(L_(n*i));e=Math.pow(2,a)}var s=r.pstyle("font-size").pfValue*e,o=r.pstyle("min-zoomed-font-size").pfValue;return!(s<o)};Xh.drawElementText=function(r,e,n,i,a){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this;if(i==null){if(s&&!o.eleTextBiggerThanMin(e))return}else if(i===!1)return;if(e.isNode()){var l=e.pstyle("label");if(!l||!l.value)return;var u=o.getLabelJustification(e);r.textAlign=u,r.textBaseline="bottom"}else{var c=e.element()._private.rscratch.badLine,d=e.pstyle("label"),p=e.pstyle("source-label"),v=e.pstyle("target-label");if(c||(!d||!d.value)&&(!p||!p.value)&&(!v||!v.value))return;r.textAlign="center",r.textBaseline="bottom"}var y=!n,b;n&&(b=n,r.translate(-b.x1,-b.y1)),a==null?(o.drawText(r,e,null,y,s),e.isEdge()&&(o.drawText(r,e,"source",y,s),o.drawText(r,e,"target",y,s))):o.drawText(r,e,a,y,s),n&&r.translate(b.x1,b.y1)};Xh.getFontCache=function(r){var e;this.fontCaches=this.fontCaches||[];for(var n=0;n<this.fontCaches.length;n++)if(e=this.fontCaches[n],e.context===r)return e;return e={context:r},this.fontCaches.push(e),e};Xh.setupTextStyle=function(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=e.pstyle("font-style").strValue,a=e.pstyle("font-size").pfValue+"px",s=e.pstyle("font-family").strValue,o=e.pstyle("font-weight").strValue,l=n?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,u=e.pstyle("text-outline-opacity").value*l,c=e.pstyle("color").value,d=e.pstyle("text-outline-color").value;r.font=i+" "+o+" "+a+" "+s,r.lineJoin="round",this.colorFillStyle(r,c[0],c[1],c[2],l),this.colorStrokeStyle(r,d[0],d[1],d[2],u)};function xB(r,e,n,i,a){var s=Math.min(i,a),o=s/2,l=e+i/2,u=n+a/2;r.beginPath(),r.arc(l,u,o,0,Math.PI*2),r.closePath()}function xN(r,e,n,i,a){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,o=Math.min(s,i/2,a/2);r.beginPath(),r.moveTo(e+o,n),r.lineTo(e+i-o,n),r.quadraticCurveTo(e+i,n,e+i,n+o),r.lineTo(e+i,n+a-o),r.quadraticCurveTo(e+i,n+a,e+i-o,n+a),r.lineTo(e+o,n+a),r.quadraticCurveTo(e,n+a,e,n+a-o),r.lineTo(e,n+o),r.quadraticCurveTo(e,n,e+o,n),r.closePath()}Xh.getTextAngle=function(r,e){var n,i=r._private,a=i.rscratch,s=e?e+"-":"",o=r.pstyle(s+"text-rotation");if(o.strValue==="autorotate"){var l=Ps(a,"labelAngle",e);n=r.isEdge()?l:0}else o.strValue==="none"?n=0:n=o.pfValue;return n};Xh.drawText=function(r,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=e._private,o=s.rscratch,l=a?e.effectiveOpacity():1;if(!(a&&(l===0||e.pstyle("text-opacity").value===0))){n==="main"&&(n=null);var u=Ps(o,"labelX",n),c=Ps(o,"labelY",n),d,p,v=this.getLabelText(e,n);if(v!=null&&v!==""&&!isNaN(u)&&!isNaN(c)){this.setupTextStyle(r,e,a);var y=n?n+"-":"",b=Ps(o,"labelWidth",n),S=Ps(o,"labelHeight",n),k=e.pstyle(y+"text-margin-x").pfValue,T=e.pstyle(y+"text-margin-y").pfValue,C=e.isEdge(),N=e.pstyle("text-halign").value,P=e.pstyle("text-valign").value;C&&(N="center",P="center"),u+=k,c+=T;var R;switch(i?R=this.getTextAngle(e,n):R=0,R!==0&&(d=u,p=c,r.translate(d,p),r.rotate(R),u=0,c=0),P){case"top":break;case"center":c+=S/2;break;case"bottom":c+=S;break}var O=e.pstyle("text-background-opacity").value,B=e.pstyle("text-border-opacity").value,I=e.pstyle("text-border-width").pfValue,z=e.pstyle("text-background-padding").pfValue,V=e.pstyle("text-background-shape").strValue,$=V==="round-rectangle"||V==="roundrectangle",Y=V==="circle",D=2;if(O>0||I>0&&B>0){var q=r.fillStyle,G=r.strokeStyle,Z=r.lineWidth,Q=e.pstyle("text-background-color").value,J=e.pstyle("text-border-color").value,ie=e.pstyle("text-border-style").value,ne=O>0,W=I>0&&B>0,re=u-z;switch(N){case"left":re-=b;break;case"center":re-=b/2;break}var ae=c-S-z,he=b+2*z,ve=S+2*z;if(ne&&(r.fillStyle="rgba(".concat(Q[0],",").concat(Q[1],",").concat(Q[2],",").concat(O*l,")")),W&&(r.strokeStyle="rgba(".concat(J[0],",").concat(J[1],",").concat(J[2],",").concat(B*l,")"),r.lineWidth=I,r.setLineDash))switch(ie){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"double":r.lineWidth=I/4,r.setLineDash([]);break;default:r.setLineDash([]);break}if($?(r.beginPath(),xN(r,re,ae,he,ve,D)):Y?(r.beginPath(),xB(r,re,ae,he,ve)):(r.beginPath(),r.rect(re,ae,he,ve)),ne&&r.fill(),W&&r.stroke(),W&&ie==="double"){var xe=I/2;r.beginPath(),$?xN(r,re+xe,ae+xe,he-2*xe,ve-2*xe,D):r.rect(re+xe,ae+xe,he-2*xe,ve-2*xe),r.stroke()}r.fillStyle=q,r.strokeStyle=G,r.lineWidth=Z,r.setLineDash&&r.setLineDash([])}var se=2*e.pstyle("text-outline-width").pfValue;if(se>0&&(r.lineWidth=se),e.pstyle("text-wrap").value==="wrap"){var ge=Ps(o,"labelWrapCachedLines",n),le=Ps(o,"labelLineHeight",n),pe=b/2,me=this.getLabelJustification(e);switch(me==="auto"||(N==="left"?me==="left"?u+=-b:me==="center"&&(u+=-pe):N==="center"?me==="left"?u+=-pe:me==="right"&&(u+=pe):N==="right"&&(me==="center"?u+=pe:me==="right"&&(u+=b))),P){case"top":c-=(ge.length-1)*le;break;case"center":case"bottom":c-=(ge.length-1)*le;break}for(var be=0;be<ge.length;be++)se>0&&r.strokeText(ge[be],u,c),r.fillText(ge[be],u,c),c+=le}else se>0&&r.strokeText(v,u,c),r.fillText(v,u,c);R!==0&&(r.rotate(-R),r.translate(-d,-p))}}};var jd={};jd.drawNode=function(r,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,o=this,l,u,c=e._private,d=c.rscratch,p=e.position();if(!(!ht(p.x)||!ht(p.y))&&!(s&&!e.visible())){var v=s?e.effectiveOpacity():1,y=o.usePaths(),b,S=!1,k=e.padding();l=e.width()+2*k,u=e.height()+2*k;var T;n&&(T=n,r.translate(-T.x1,-T.y1));for(var C=e.pstyle("background-image"),N=C.value,P=new Array(N.length),R=new Array(N.length),O=0,B=0;B<N.length;B++){var I=N[B],z=P[B]=I!=null&&I!=="none";if(z){var V=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",B);O++,R[B]=o.getCachedImage(I,V,function(){c.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var $=e.pstyle("background-blacken").value,Y=e.pstyle("border-width").pfValue,D=e.pstyle("background-opacity").value*v,q=e.pstyle("border-color").value,G=e.pstyle("border-style").value,Z=e.pstyle("border-join").value,Q=e.pstyle("border-cap").value,J=e.pstyle("border-position").value,ie=e.pstyle("border-dash-pattern").pfValue,ne=e.pstyle("border-dash-offset").pfValue,W=e.pstyle("border-opacity").value*v,re=e.pstyle("outline-width").pfValue,ae=e.pstyle("outline-color").value,he=e.pstyle("outline-style").value,ve=e.pstyle("outline-opacity").value*v,xe=e.pstyle("outline-offset").value,se=e.pstyle("corner-radius").value;se!=="auto"&&(se=e.pstyle("corner-radius").pfValue);var ge=function(){var ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:D;o.eleFillStyle(r,e,ot)},le=function(){var ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:W;o.colorStrokeStyle(r,q[0],q[1],q[2],ot)},pe=function(){var ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ve;o.colorStrokeStyle(r,ae[0],ae[1],ae[2],ot)},me=function(ot,qe,de,ye){var Ce=o.nodePathCache=o.nodePathCache||[],Te=O4(de==="polygon"?de+","+ye.join(","):de,""+qe,""+ot,""+se),Re=Ce[Te],Ze,Ge=!1;return Re!=null?(Ze=Re,Ge=!0,d.pathCache=Ze):(Ze=new Path2D,Ce[Te]=d.pathCache=Ze),{path:Ze,cacheHit:Ge}},be=e.pstyle("shape").strValue,Se=e.pstyle("shape-polygon-points").pfValue;if(y){r.translate(p.x,p.y);var Ue=me(l,u,be,Se);b=Ue.path,S=Ue.cacheHit}var We=function(){if(!S){var ot=p;y&&(ot={x:0,y:0}),o.nodeShapes[o.getNodeShape(e)].draw(b||r,ot.x,ot.y,l,u,se,d)}y?r.fill(b):r.fill()},gt=function(){for(var ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v,qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,de=c.backgrounding,ye=0,Ce=0;Ce<R.length;Ce++){var Te=e.cy().style().getIndexedStyle(e,"background-image-containment","value",Ce);if(qe&&Te==="over"||!qe&&Te==="inside"){ye++;continue}P[Ce]&&R[Ce].complete&&!R[Ce].error&&(ye++,o.drawInscribedImage(r,R[Ce],e,Ce,ot))}c.backgrounding=ye!==O,de!==c.backgrounding&&e.updateStyle(!1)},Je=function(){var ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v;o.hasPie(e)&&(o.drawPie(r,e,qe),ot&&(y||o.nodeShapes[o.getNodeShape(e)].draw(r,p.x,p.y,l,u,se,d)))},at=function(){var ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,qe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v;o.hasStripe(e)&&(r.save(),y?r.clip(d.pathCache):(o.nodeShapes[o.getNodeShape(e)].draw(r,p.x,p.y,l,u,se,d),r.clip()),o.drawStripe(r,e,qe),r.restore(),ot&&(y||o.nodeShapes[o.getNodeShape(e)].draw(r,p.x,p.y,l,u,se,d)))},Ve=function(){var ot=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v,qe=($>0?$:-$)*ot,de=$>0?0:255;$!==0&&(o.colorFillStyle(r,de,de,de,qe),y?r.fill(b):r.fill())},Oe=function(){if(Y>0){if(r.lineWidth=Y,r.lineCap=Q,r.lineJoin=Z,r.setLineDash)switch(G){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash(ie),r.lineDashOffset=ne;break;case"solid":case"double":r.setLineDash([]);break}if(J!=="center"){if(r.save(),r.lineWidth*=2,J==="inside")y?r.clip(b):r.clip();else{var ot=new Path2D;ot.rect(-l/2-Y,-u/2-Y,l+2*Y,u+2*Y),ot.addPath(b),r.clip(ot,"evenodd")}y?r.stroke(b):r.stroke(),r.restore()}else y?r.stroke(b):r.stroke();if(G==="double"){r.lineWidth=Y/3;var qe=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",y?r.stroke(b):r.stroke(),r.globalCompositeOperation=qe}r.setLineDash&&r.setLineDash([])}},et=function(){if(re>0){if(r.lineWidth=re,r.lineCap="butt",r.setLineDash)switch(he){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash([4,2]);break;case"solid":case"double":r.setLineDash([]);break}var ot=p;y&&(ot={x:0,y:0});var qe=o.getNodeShape(e),de=Y;J==="inside"&&(de=0),J==="outside"&&(de*=2);var ye=(l+de+(re+xe))/l,Ce=(u+de+(re+xe))/u,Te=l*ye,Re=u*Ce,Ze=o.nodeShapes[qe].points,Ge;if(y){var ct=me(Te,Re,qe,Ze);Ge=ct.path}if(qe==="ellipse")o.drawEllipsePath(Ge||r,ot.x,ot.y,Te,Re);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(qe)){var ut=0,kt=0,zt=0;qe==="round-diamond"?ut=(de+xe+re)*1.4:qe==="round-heptagon"?(ut=(de+xe+re)*1.075,zt=-(de/2+xe+re)/35):qe==="round-hexagon"?ut=(de+xe+re)*1.12:qe==="round-pentagon"?(ut=(de+xe+re)*1.13,zt=-(de/2+xe+re)/15):qe==="round-tag"?(ut=(de+xe+re)*1.12,kt=(de/2+re+xe)*.07):qe==="round-triangle"&&(ut=(de+xe+re)*(Math.PI/2),zt=-(de+xe/2+re)/Math.PI),ut!==0&&(ye=(l+ut)/l,Te=l*ye,["round-hexagon","round-tag"].includes(qe)||(Ce=(u+ut)/u,Re=u*Ce)),se=se==="auto"?q4(Te,Re):se;for(var Ft=Te/2,xt=Re/2,Gt=se+(de+re+xe)/2,Wt=new Array(Ze.length/2),kr=new Array(Ze.length/2),pr=0;pr<Ze.length/2;pr++)Wt[pr]={x:ot.x+kt+Ft*Ze[pr*2],y:ot.y+zt+xt*Ze[pr*2+1]};var pn,qr,Wr,an,cr=Wt.length;for(qr=Wt[cr-1],pn=0;pn<cr;pn++)Wr=Wt[pn%cr],an=Wt[(pn+1)%cr],kr[pn]=K_(qr,Wr,an,Gt),qr=Wr,Wr=an;o.drawRoundPolygonPath(Ge||r,ot.x+kt,ot.y+zt,l*ye,u*Ce,Ze,kr)}else if(["roundrectangle","round-rectangle"].includes(qe))se=se==="auto"?_d(Te,Re):se,o.drawRoundRectanglePath(Ge||r,ot.x,ot.y,Te,Re,se+(de+re+xe)/2);else if(["cutrectangle","cut-rectangle"].includes(qe))se=se==="auto"?I_():se,o.drawCutRectanglePath(Ge||r,ot.x,ot.y,Te,Re,null,se+(de+re+xe)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(qe))se=se==="auto"?_d(Te,Re):se,o.drawBottomRoundRectanglePath(Ge||r,ot.x,ot.y,Te,Re,se+(de+re+xe)/2);else if(qe==="barrel")o.drawBarrelPath(Ge||r,ot.x,ot.y,Te,Re);else if(qe.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(qe)){var bt=(de+re+xe)/l;Ze=ly(uy(Ze,bt)),o.drawPolygonPath(Ge||r,ot.x,ot.y,l,u,Ze)}else{var Or=(de+re+xe)/l;Ze=ly(uy(Ze,-Or)),o.drawPolygonPath(Ge||r,ot.x,ot.y,l,u,Ze)}if(y?r.stroke(Ge):r.stroke(),he==="double"){r.lineWidth=de/3;var Xn=r.globalCompositeOperation;r.globalCompositeOperation="destination-out",y?r.stroke(Ge):r.stroke(),r.globalCompositeOperation=Xn}r.setLineDash&&r.setLineDash([])}},Ne=function(){a&&o.drawNodeOverlay(r,e,p,l,u)},ze=function(){a&&o.drawNodeUnderlay(r,e,p,l,u)},Ke=function(){o.drawElementText(r,e,null,i)},ft=e.pstyle("ghost").value==="yes";if(ft){var yt=e.pstyle("ghost-offset-x").pfValue,Et=e.pstyle("ghost-offset-y").pfValue,Rt=e.pstyle("ghost-opacity").value,$t=Rt*v;r.translate(yt,Et),pe(),et(),ge(Rt*D),We(),gt($t,!0),le(Rt*W),Oe(),Je($!==0||Y!==0),at($!==0||Y!==0),gt($t,!1),Ve($t),r.translate(-yt,-Et)}y&&r.translate(-p.x,-p.y),ze(),y&&r.translate(p.x,p.y),pe(),et(),ge(),We(),gt(v,!0),le(),Oe(),Je($!==0||Y!==0),at($!==0||Y!==0),gt(v,!1),Ve(),y&&r.translate(-p.x,-p.y),Ke(),Ne(),n&&r.translate(T.x1,T.y1)}};var XP=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(n,i,a,s,o){var l=this;if(i.visible()){var u=i.pstyle("".concat(e,"-padding")).pfValue,c=i.pstyle("".concat(e,"-opacity")).value,d=i.pstyle("".concat(e,"-color")).value,p=i.pstyle("".concat(e,"-shape")).value,v=i.pstyle("".concat(e,"-corner-radius")).value;if(c>0){if(a=a||i.position(),s==null||o==null){var y=i.padding();s=i.width()+2*y,o=i.height()+2*y}l.colorFillStyle(n,d[0],d[1],d[2],c),l.nodeShapes[p].draw(n,a.x,a.y,s+u*2,o+u*2,v),n.fill()}}}};jd.drawNodeOverlay=XP("overlay");jd.drawNodeUnderlay=XP("underlay");jd.hasPie=function(r){return r=r[0],r._private.hasPie};jd.hasStripe=function(r){return r=r[0],r._private.hasStripe};jd.drawPie=function(r,e,n,i){e=e[0],i=i||e.position();var a=e.cy().style(),s=e.pstyle("pie-size"),o=e.pstyle("pie-hole"),l=e.pstyle("pie-start-angle").pfValue,u=i.x,c=i.y,d=e.width(),p=e.height(),v=Math.min(d,p)/2,y,b=0,S=this.usePaths();if(S&&(u=0,c=0),s.units==="%"?v=v*s.pfValue:s.pfValue!==void 0&&(v=s.pfValue/2),o.units==="%"?y=v*o.pfValue:o.pfValue!==void 0&&(y=o.pfValue/2),!(y>=v))for(var k=1;k<=a.pieBackgroundN;k++){var T=e.pstyle("pie-"+k+"-background-size").value,C=e.pstyle("pie-"+k+"-background-color").value,N=e.pstyle("pie-"+k+"-background-opacity").value*n,P=T/100;P+b>1&&(P=1-b);var R=1.5*Math.PI+2*Math.PI*b;R+=l;var O=2*Math.PI*P,B=R+O;T===0||b>=1||b+P>1||(y===0?(r.beginPath(),r.moveTo(u,c),r.arc(u,c,v,R,B),r.closePath()):(r.beginPath(),r.arc(u,c,v,R,B),r.arc(u,c,y,B,R,!0),r.closePath()),this.colorFillStyle(r,C[0],C[1],C[2],N),r.fill(),b+=P)}};jd.drawStripe=function(r,e,n,i){e=e[0],i=i||e.position();var a=e.cy().style(),s=i.x,o=i.y,l=e.width(),u=e.height(),c=0,d=this.usePaths();r.save();var p=e.pstyle("stripe-direction").value,v=e.pstyle("stripe-size");switch(p){case"vertical":break;case"righward":r.rotate(-Math.PI/2);break}var y=l,b=u;v.units==="%"?(y=y*v.pfValue,b=b*v.pfValue):v.pfValue!==void 0&&(y=v.pfValue,b=v.pfValue),d&&(s=0,o=0),o-=y/2,s-=b/2;for(var S=1;S<=a.stripeBackgroundN;S++){var k=e.pstyle("stripe-"+S+"-background-size").value,T=e.pstyle("stripe-"+S+"-background-color").value,C=e.pstyle("stripe-"+S+"-background-opacity").value*n,N=k/100;N+c>1&&(N=1-c),!(k===0||c>=1||c+N>1)&&(r.beginPath(),r.rect(s,o+b*c,y,b*N),r.closePath(),this.colorFillStyle(r,T[0],T[1],T[2],C),r.fill(),c+=N)}r.restore()};var fs={},bB=100;fs.getPixelRatio=function(){var r=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),n=r.backingStorePixelRatio||r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/n};fs.paintCache=function(r){for(var e=this.paintCaches=this.paintCaches||[],n=!0,i,a=0;a<e.length;a++)if(i=e[a],i.context===r){n=!1;break}return n&&(i={context:r},e.push(i)),i};fs.createGradientStyleFor=function(r,e,n,i,a){var s,o=this.usePaths(),l=n.pstyle(e+"-gradient-stop-colors").value,u=n.pstyle(e+"-gradient-stop-positions").pfValue;if(i==="radial-gradient")if(n.isEdge()){var c=n.sourceEndpoint(),d=n.targetEndpoint(),p=n.midpoint(),v=Ih(c,p),y=Ih(d,p);s=r.createRadialGradient(p.x,p.y,0,p.x,p.y,Math.max(v,y))}else{var b=o?{x:0,y:0}:n.position(),S=n.paddedWidth(),k=n.paddedHeight();s=r.createRadialGradient(b.x,b.y,0,b.x,b.y,Math.max(S,k))}else if(n.isEdge()){var T=n.sourceEndpoint(),C=n.targetEndpoint();s=r.createLinearGradient(T.x,T.y,C.x,C.y)}else{var N=o?{x:0,y:0}:n.position(),P=n.paddedWidth(),R=n.paddedHeight(),O=P/2,B=R/2,I=n.pstyle("background-gradient-direction").value;switch(I){case"to-bottom":s=r.createLinearGradient(N.x,N.y-B,N.x,N.y+B);break;case"to-top":s=r.createLinearGradient(N.x,N.y+B,N.x,N.y-B);break;case"to-left":s=r.createLinearGradient(N.x+O,N.y,N.x-O,N.y);break;case"to-right":s=r.createLinearGradient(N.x-O,N.y,N.x+O,N.y);break;case"to-bottom-right":case"to-right-bottom":s=r.createLinearGradient(N.x-O,N.y-B,N.x+O,N.y+B);break;case"to-top-right":case"to-right-top":s=r.createLinearGradient(N.x-O,N.y+B,N.x+O,N.y-B);break;case"to-bottom-left":case"to-left-bottom":s=r.createLinearGradient(N.x+O,N.y-B,N.x-O,N.y+B);break;case"to-top-left":case"to-left-top":s=r.createLinearGradient(N.x+O,N.y+B,N.x-O,N.y-B);break}}if(!s)return null;for(var z=u.length===l.length,V=l.length,$=0;$<V;$++)s.addColorStop(z?u[$]:$/(V-1),"rgba("+l[$][0]+","+l[$][1]+","+l[$][2]+","+a+")");return s};fs.gradientFillStyle=function(r,e,n,i){var a=this.createGradientStyleFor(r,"background",e,n,i);if(!a)return null;r.fillStyle=a};fs.colorFillStyle=function(r,e,n,i,a){r.fillStyle="rgba("+e+","+n+","+i+","+a+")"};fs.eleFillStyle=function(r,e,n){var i=e.pstyle("background-fill").value;if(i==="linear-gradient"||i==="radial-gradient")this.gradientFillStyle(r,e,i,n);else{var a=e.pstyle("background-color").value;this.colorFillStyle(r,a[0],a[1],a[2],n)}};fs.gradientStrokeStyle=function(r,e,n,i){var a=this.createGradientStyleFor(r,"line",e,n,i);if(!a)return null;r.strokeStyle=a};fs.colorStrokeStyle=function(r,e,n,i,a){r.strokeStyle="rgba("+e+","+n+","+i+","+a+")"};fs.eleStrokeStyle=function(r,e,n){var i=e.pstyle("line-fill").value;if(i==="linear-gradient"||i==="radial-gradient")this.gradientStrokeStyle(r,e,i,n);else{var a=e.pstyle("line-color").value;this.colorStrokeStyle(r,a[0],a[1],a[2],n)}};fs.matchCanvasSize=function(r){var e=this,n=e.data,i=e.findContainerClientCoords(),a=i[2],s=i[3],o=e.getPixelRatio(),l=e.motionBlurPxRatio;(r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||r===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(o=l);var u=a*o,c=s*o,d;if(!(u===e.canvasWidth&&c===e.canvasHeight)){e.fontCaches=null;var p=n.canvasContainer;p.style.width=a+"px",p.style.height=s+"px";for(var v=0;v<e.CANVAS_LAYERS;v++)d=n.canvases[v],d.width=u,d.height=c,d.style.width=a+"px",d.style.height=s+"px";for(var v=0;v<e.BUFFER_COUNT;v++)d=n.bufferCanvases[v],d.width=u,d.height=c,d.style.width=a+"px",d.style.height=s+"px";e.textureMult=1,o<=1&&(d=n.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,d.width=u*e.textureMult,d.height=c*e.textureMult),e.canvasWidth=u,e.canvasHeight=c,e.pixelRatio=o}};fs.renderTo=function(r,e,n,i){this.render({forcedContext:r,forcedZoom:e,forcedPan:n,drawAllLayers:!0,forcedPxRatio:i})};fs.clearCanvas=function(){var r=this,e=r.data;function n(i){i.clearRect(0,0,r.canvasWidth,r.canvasHeight)}n(e.contexts[r.NODE]),n(e.contexts[r.DRAG])};fs.render=function(r){var e=this;r=r||z4();var n=e.cy,i=r.forcedContext,a=r.drawAllLayers,s=r.drawOnlyNodeLayer,o=r.forcedZoom,l=r.forcedPan,u=r.forcedPxRatio===void 0?this.getPixelRatio():r.forcedPxRatio,c=e.data,d=c.canvasNeedsRedraw,p=e.textureOnViewport&&!i&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),v=r.motionBlur!==void 0?r.motionBlur:e.motionBlur,y=e.motionBlurPxRatio,b=n.hasCompoundNodes(),S=e.hoverData.draggingEles,k=!!(e.hoverData.selecting||e.touchData.selecting);v=v&&!i&&e.motionBlurEnabled&&!k;var T=v;i||(e.prevPxRatio!==u&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=u),!i&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),v&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(T=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!p&&(d[e.NODE]=!0,d[e.SELECT_BOX]=!0);var C=n.style(),N=n.zoom(),P=o!==void 0?o:N,R=n.pan(),O={x:R.x,y:R.y},B={zoom:N,pan:{x:R.x,y:R.y}},I=e.prevViewport,z=I===void 0||B.zoom!==I.zoom||B.pan.x!==I.pan.x||B.pan.y!==I.pan.y;!z&&!(S&&!b)&&(e.motionBlurPxRatio=1),l&&(O=l),P*=u,O.x*=u,O.y*=u;var V=e.getCachedZSortedEles();function $(le,pe,me,be,Se){var Ue=le.globalCompositeOperation;le.globalCompositeOperation="destination-out",e.colorFillStyle(le,255,255,255,e.motionBlurTransparency),le.fillRect(pe,me,be,Se),le.globalCompositeOperation=Ue}function Y(le,pe){var me,be,Se,Ue;!e.clearingMotionBlur&&(le===c.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||le===c.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(me={x:R.x*y,y:R.y*y},be=N*y,Se=e.canvasWidth*y,Ue=e.canvasHeight*y):(me=O,be=P,Se=e.canvasWidth,Ue=e.canvasHeight),le.setTransform(1,0,0,1,0,0),pe==="motionBlur"?$(le,0,0,Se,Ue):!i&&(pe===void 0||pe)&&le.clearRect(0,0,Se,Ue),a||(le.translate(me.x,me.y),le.scale(be,be)),l&&le.translate(l.x,l.y),o&&le.scale(o,o)}if(p||(e.textureDrawLastFrame=!1),p){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=n.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var D=e.data.bufferContexts[e.TEXTURE_BUFFER];D.setTransform(1,0,0,1,0,0),D.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:D,drawOnlyNodeLayer:!0,forcedPxRatio:u*e.textureMult});var B=e.textureCache.viewport={zoom:n.zoom(),pan:n.pan(),width:e.canvasWidth,height:e.canvasHeight};B.mpan={x:(0-B.pan.x)/B.zoom,y:(0-B.pan.y)/B.zoom}}d[e.DRAG]=!1,d[e.NODE]=!1;var q=c.contexts[e.NODE],G=e.textureCache.texture,B=e.textureCache.viewport;q.setTransform(1,0,0,1,0,0),v?$(q,0,0,B.width,B.height):q.clearRect(0,0,B.width,B.height);var Z=C.core("outside-texture-bg-color").value,Q=C.core("outside-texture-bg-opacity").value;e.colorFillStyle(q,Z[0],Z[1],Z[2],Q),q.fillRect(0,0,B.width,B.height);var N=n.zoom();Y(q,!1),q.clearRect(B.mpan.x,B.mpan.y,B.width/B.zoom/u,B.height/B.zoom/u),q.drawImage(G,B.mpan.x,B.mpan.y,B.width/B.zoom/u,B.height/B.zoom/u)}else e.textureOnViewport&&!i&&(e.textureCache=null);var J=n.extent(),ie=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),ne=e.hideEdgesOnViewport&&ie,W=[];if(W[e.NODE]=!d[e.NODE]&&v&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,W[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),W[e.DRAG]=!d[e.DRAG]&&v&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,W[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),d[e.NODE]||a||s||W[e.NODE]){var re=v&&!W[e.NODE]&&y!==1,q=i||(re?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:c.contexts[e.NODE]),ae=v&&!re?"motionBlur":void 0;Y(q,ae),ne?e.drawCachedNodes(q,V.nondrag,u,J):e.drawLayeredElements(q,V.nondrag,u,J),e.debug&&e.drawDebugPoints(q,V.nondrag),!a&&!v&&(d[e.NODE]=!1)}if(!s&&(d[e.DRAG]||a||W[e.DRAG])){var re=v&&!W[e.DRAG]&&y!==1,q=i||(re?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:c.contexts[e.DRAG]);Y(q,v&&!re?"motionBlur":void 0),ne?e.drawCachedNodes(q,V.drag,u,J):e.drawCachedElements(q,V.drag,u,J),e.debug&&e.drawDebugPoints(q,V.drag),!a&&!v&&(d[e.DRAG]=!1)}if(this.drawSelectionRectangle(r,Y),v&&y!==1){var he=c.contexts[e.NODE],ve=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],xe=c.contexts[e.DRAG],se=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],ge=function(pe,me,be){pe.setTransform(1,0,0,1,0,0),be||!T?pe.clearRect(0,0,e.canvasWidth,e.canvasHeight):$(pe,0,0,e.canvasWidth,e.canvasHeight);var Se=y;pe.drawImage(me,0,0,e.canvasWidth*Se,e.canvasHeight*Se,0,0,e.canvasWidth,e.canvasHeight)};(d[e.NODE]||W[e.NODE])&&(ge(he,ve,W[e.NODE]),d[e.NODE]=!1),(d[e.DRAG]||W[e.DRAG])&&(ge(xe,se,W[e.DRAG]),d[e.DRAG]=!1)}e.prevViewport=B,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),v&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!p,e.mbFrames=0,d[e.NODE]=!0,d[e.DRAG]=!0,e.redraw()},bB)),i||n.emit("render")};var um;fs.drawSelectionRectangle=function(r,e){var n=this,i=n.cy,a=n.data,s=i.style(),o=r.drawOnlyNodeLayer,l=r.drawAllLayers,u=a.canvasNeedsRedraw,c=r.forcedContext;if(n.showFps||!o&&u[n.SELECT_BOX]&&!l){var d=c||a.contexts[n.SELECT_BOX];if(e(d),n.selection[4]==1&&(n.hoverData.selecting||n.touchData.selecting)){var p=n.cy.zoom(),v=s.core("selection-box-border-width").value/p;d.lineWidth=v,d.fillStyle="rgba("+s.core("selection-box-color").value[0]+","+s.core("selection-box-color").value[1]+","+s.core("selection-box-color").value[2]+","+s.core("selection-box-opacity").value+")",d.fillRect(n.selection[0],n.selection[1],n.selection[2]-n.selection[0],n.selection[3]-n.selection[1]),v>0&&(d.strokeStyle="rgba("+s.core("selection-box-border-color").value[0]+","+s.core("selection-box-border-color").value[1]+","+s.core("selection-box-border-color").value[2]+","+s.core("selection-box-opacity").value+")",d.strokeRect(n.selection[0],n.selection[1],n.selection[2]-n.selection[0],n.selection[3]-n.selection[1]))}if(a.bgActivePosistion&&!n.hoverData.selecting){var p=n.cy.zoom(),y=a.bgActivePosistion;d.fillStyle="rgba("+s.core("active-bg-color").value[0]+","+s.core("active-bg-color").value[1]+","+s.core("active-bg-color").value[2]+","+s.core("active-bg-opacity").value+")",d.beginPath(),d.arc(y.x,y.y,s.core("active-bg-size").pfValue/p,0,2*Math.PI),d.fill()}var b=n.lastRedrawTime;if(n.showFps&&b){b=Math.round(b);var S=Math.round(1e3/b),k="1 frame = "+b+" ms = "+S+" fps";if(d.setTransform(1,0,0,1,0,0),d.fillStyle="rgba(255, 0, 0, 0.75)",d.strokeStyle="rgba(255, 0, 0, 0.75)",d.font="30px Arial",!um){var T=d.measureText(k);um=T.actualBoundingBoxAscent}d.fillText(k,0,um);var C=60;d.strokeRect(0,um+10,250,20),d.fillRect(0,um+10,250*Math.min(S/C,1),20)}l||(u[n.SELECT_BOX]=!1)}};function bN(r,e,n){var i=r.createShader(e);if(r.shaderSource(i,n),r.compileShader(i),!r.getShaderParameter(i,r.COMPILE_STATUS))throw new Error(r.getShaderInfoLog(i));return i}function wB(r,e,n){var i=bN(r,r.VERTEX_SHADER,e),a=bN(r,r.FRAGMENT_SHADER,n),s=r.createProgram();if(r.attachShader(s,i),r.attachShader(s,a),r.linkProgram(s),!r.getProgramParameter(s,r.LINK_STATUS))throw new Error("Could not initialize shaders");return s}function _B(r,e,n){n===void 0&&(n=e);var i=r.makeOffscreenCanvas(e,n),a=i.context=i.getContext("2d");return i.clear=function(){return a.clearRect(0,0,i.width,i.height)},i.clear(),i}function X_(r){var e=r.pixelRatio,n=r.cy.zoom(),i=r.cy.pan();return{zoom:n*e,pan:{x:i.x*e,y:i.y*e}}}function SB(r){var e=r.pixelRatio,n=r.cy.zoom();return n*e}function kB(r,e,n,i,a){var s=i*n+e.x,o=a*n+e.y;return o=Math.round(r.canvasHeight-o),[s,o]}function CB(r){return r.pstyle("background-fill").value!=="solid"||r.pstyle("background-image").strValue!=="none"?!1:r.pstyle("border-width").value===0||r.pstyle("border-opacity").value===0?!0:r.pstyle("border-style").value==="solid"}function EB(r,e){if(r.length!==e.length)return!1;for(var n=0;n<r.length;n++)if(r[n]!==e[n])return!1;return!0}function ph(r,e,n){var i=r[0]/255,a=r[1]/255,s=r[2]/255,o=e,l=n||new Array(4);return l[0]=i*o,l[1]=a*o,l[2]=s*o,l[3]=o,l}function zf(r,e){var n=e||new Array(4);return n[0]=(r>>0&255)/255,n[1]=(r>>8&255)/255,n[2]=(r>>16&255)/255,n[3]=(r>>24&255)/255,n}function NB(r){return r[0]+(r[1]<<8)+(r[2]<<16)+(r[3]<<24)}function TB(r,e){var n=r.createTexture();return n.buffer=function(i){r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_NEAREST),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,i),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null)},n.deleteTexture=function(){r.deleteTexture(n)},n}function QP(r,e){switch(e){case"float":return[1,r.FLOAT,4];case"vec2":return[2,r.FLOAT,4];case"vec3":return[3,r.FLOAT,4];case"vec4":return[4,r.FLOAT,4];case"int":return[1,r.INT,4];case"ivec2":return[2,r.INT,4]}}function JP(r,e,n){switch(e){case r.FLOAT:return new Float32Array(n);case r.INT:return new Int32Array(n)}}function PB(r,e,n,i,a,s){switch(e){case r.FLOAT:return new Float32Array(n.buffer,s*i,a);case r.INT:return new Int32Array(n.buffer,s*i,a)}}function MB(r,e,n,i){var a=QP(r,e),s=xi(a,2),o=s[0],l=s[1],u=JP(r,l,i),c=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,c),r.bufferData(r.ARRAY_BUFFER,u,r.STATIC_DRAW),l===r.FLOAT?r.vertexAttribPointer(n,o,l,!1,0,0):l===r.INT&&r.vertexAttribIPointer(n,o,l,0,0),r.enableVertexAttribArray(n),r.bindBuffer(r.ARRAY_BUFFER,null),c}function ql(r,e,n,i){var a=QP(r,n),s=xi(a,3),o=s[0],l=s[1],u=s[2],c=JP(r,l,e*o),d=o*u,p=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,p),r.bufferData(r.ARRAY_BUFFER,e*d,r.DYNAMIC_DRAW),r.enableVertexAttribArray(i),l===r.FLOAT?r.vertexAttribPointer(i,o,l,!1,d,0):l===r.INT&&r.vertexAttribIPointer(i,o,l,d,0),r.vertexAttribDivisor(i,1),r.bindBuffer(r.ARRAY_BUFFER,null);for(var v=new Array(e),y=0;y<e;y++)v[y]=PB(r,l,c,d,o,y);return p.dataArray=c,p.stride=d,p.size=o,p.getView=function(b){return v[b]},p.setPoint=function(b,S,k){var T=v[b];T[0]=S,T[1]=k},p.bufferSubData=function(b){r.bindBuffer(r.ARRAY_BUFFER,p),b?r.bufferSubData(r.ARRAY_BUFFER,0,c,0,b*o):r.bufferSubData(r.ARRAY_BUFFER,0,c)},p}function AB(r,e,n){for(var i=9,a=new Float32Array(e*i),s=new Array(e),o=0;o<e;o++){var l=o*i*4;s[o]=new Float32Array(a.buffer,l,i)}var u=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,u),r.bufferData(r.ARRAY_BUFFER,a.byteLength,r.DYNAMIC_DRAW);for(var c=0;c<3;c++){var d=n+c;r.enableVertexAttribArray(d),r.vertexAttribPointer(d,3,r.FLOAT,!1,36,c*12),r.vertexAttribDivisor(d,1)}return r.bindBuffer(r.ARRAY_BUFFER,null),u.getMatrixView=function(p){return s[p]},u.setData=function(p,v){s[v].set(p,0)},u.bufferSubData=function(){r.bindBuffer(r.ARRAY_BUFFER,u),r.bufferSubData(r.ARRAY_BUFFER,0,a)},u}function jB(r){var e=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,e);var n=r.createTexture();return r.bindTexture(r.TEXTURE_2D,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0),r.bindFramebuffer(r.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(i,a){r.bindTexture(r.TEXTURE_2D,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,i,a,0,r.RGBA,r.UNSIGNED_BYTE,null)},e}var wN=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function iw(){var r=new wN(9);return wN!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function _N(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r}function RB(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],d=e[7],p=e[8],v=n[0],y=n[1],b=n[2],S=n[3],k=n[4],T=n[5],C=n[6],N=n[7],P=n[8];return r[0]=v*i+y*o+b*c,r[1]=v*a+y*l+b*d,r[2]=v*s+y*u+b*p,r[3]=S*i+k*o+T*c,r[4]=S*a+k*l+T*d,r[5]=S*s+k*u+T*p,r[6]=C*i+N*o+P*c,r[7]=C*a+N*l+P*d,r[8]=C*s+N*u+P*p,r}function $0(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],d=e[7],p=e[8],v=n[0],y=n[1];return r[0]=i,r[1]=a,r[2]=s,r[3]=o,r[4]=l,r[5]=u,r[6]=v*i+y*o+c,r[7]=v*a+y*l+d,r[8]=v*s+y*u+p,r}function SN(r,e,n){var i=e[0],a=e[1],s=e[2],o=e[3],l=e[4],u=e[5],c=e[6],d=e[7],p=e[8],v=Math.sin(n),y=Math.cos(n);return r[0]=y*i+v*o,r[1]=y*a+v*l,r[2]=y*s+v*u,r[3]=y*o-v*i,r[4]=y*l-v*a,r[5]=y*u-v*s,r[6]=c,r[7]=d,r[8]=p,r}function R2(r,e,n){var i=n[0],a=n[1];return r[0]=i*e[0],r[1]=i*e[1],r[2]=i*e[2],r[3]=a*e[3],r[4]=a*e[4],r[5]=a*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function LB(r,e,n){return r[0]=2/e,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/n,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r}var OB=(function(){function r(e,n,i,a){Pd(this,r),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.texSize=n,this.texRows=i,this.texHeight=Math.floor(n/i),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=a(e,n,n),this.scratch=a(e,n,this.texHeight,"scratch")}return Md(r,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(n){var i=n.w,a=n.h,s=this.texHeight,o=this.texSize,l=s/a,u=i*l,c=a*l;return u>o&&(l=o/i,u=i*l,c=a*l),{scale:l,texW:u,texH:c}}},{key:"draw",value:function(n,i,a){var s=this;if(this.locked)throw new Error("can't draw, atlas is locked");var o=this.texSize,l=this.texRows,u=this.texHeight,c=this.getScale(i),d=c.scale,p=c.texW,v=c.texH,y=function(N,P){if(a&&P){var R=P.context,O=N.x,B=N.row,I=O,z=u*B;R.save(),R.translate(I,z),R.scale(d,d),a(R,i),R.restore()}},b=[null,null],S=function(){y(s.freePointer,s.canvas),b[0]={x:s.freePointer.x,y:s.freePointer.row*u,w:p,h:v},b[1]={x:s.freePointer.x+p,y:s.freePointer.row*u,w:0,h:v},s.freePointer.x+=p,s.freePointer.x==o&&(s.freePointer.x=0,s.freePointer.row++)},k=function(){var N=s.scratch,P=s.canvas;N.clear(),y({x:0,row:0},N);var R=o-s.freePointer.x,O=p-R,B=u;{var I=s.freePointer.x,z=s.freePointer.row*u,V=R;P.context.drawImage(N,0,0,V,B,I,z,V,B),b[0]={x:I,y:z,w:V,h:v}}{var $=R,Y=(s.freePointer.row+1)*u,D=O;P&&P.context.drawImage(N,$,0,D,B,0,Y,D,B),b[1]={x:0,y:Y,w:D,h:v}}s.freePointer.x=O,s.freePointer.row++},T=function(){s.freePointer.x=0,s.freePointer.row++};if(this.freePointer.x+p<=o)S();else{if(this.freePointer.row>=l-1)return!1;this.freePointer.x===o?(T(),S()):this.enableWrapping?k():(T(),S())}return this.keyToLocation.set(n,b),this.needsBuffer=!0,b}},{key:"getOffsets",value:function(n){return this.keyToLocation.get(n)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(n){if(this.locked)return!1;var i=this.texSize,a=this.texRows,s=this.getScale(n),o=s.texW;return this.freePointer.x+o>i?this.freePointer.row<a-1:!0}},{key:"bufferIfNeeded",value:function(n){this.texture||(this.texture=TB(n,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])})(),DB=(function(){function r(e,n,i,a){Pd(this,r),this.r=e,this.texSize=n,this.texRows=i,this.createTextureCanvas=a,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return Md(r,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var n=this.r,i=this.texSize,a=this.texRows,s=this.createTextureCanvas;return new OB(n,i,a,s)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var n=this.r,i=this.texSize,a=this.texRows,s=this.createTextureCanvas,o=Math.floor(i/a);this.scratch=s(n,i,o,"scratch")}return this.scratch}},{key:"draw",value:function(n,i,a){var s=this.styleKeyToAtlas.get(n);return s||(s=this.atlases[this.atlases.length-1],(!s||!s.canFit(i))&&(s&&s.lock(),s=this._createAtlas(),this.atlases.push(s)),s.draw(n,i,a),this.styleKeyToAtlas.set(n,s)),s}},{key:"getAtlas",value:function(n){return this.styleKeyToAtlas.get(n)}},{key:"hasAtlas",value:function(n){return this.styleKeyToAtlas.has(n)}},{key:"markKeyForGC",value:function(n){this.markedKeys.add(n)}},{key:"gc",value:function(){var n=this,i=this.markedKeys;if(i.size===0){console.log("nothing to garbage collect");return}var a=[],s=new Map,o=null,l=js(this.atlases),u;try{var c=function(){var p=u.value,v=p.getKeys(),y=IB(i,v);if(y.size===0)return a.push(p),v.forEach(function(R){return s.set(R,p)}),1;o||(o=n._createAtlas(),a.push(o));var b=js(v),S;try{for(b.s();!(S=b.n()).done;){var k=S.value;if(!y.has(k)){var T=p.getOffsets(k),C=xi(T,2),N=C[0],P=C[1];o.canFit({w:N.w+P.w,h:N.h})||(o.lock(),o=n._createAtlas(),a.push(o)),p.canvas&&(n._copyTextureToNewAtlas(k,p,o),s.set(k,o))}}}catch(R){b.e(R)}finally{b.f()}p.dispose()};for(l.s();!(u=l.n()).done;)c()}catch(d){l.e(d)}finally{l.f()}this.atlases=a,this.styleKeyToAtlas=s,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(n,i,a){var s=i.getOffsets(n),o=xi(s,2),l=o[0],u=o[1];if(u.w===0)a.draw(n,l,function(v){v.drawImage(i.canvas,l.x,l.y,l.w,l.h,0,0,l.w,l.h)});else{var c=this._getScratchCanvas();c.clear(),c.context.drawImage(i.canvas,l.x,l.y,l.w,l.h,0,0,l.w,l.h),c.context.drawImage(i.canvas,u.x,u.y,u.w,u.h,l.w,0,u.w,u.h);var d=l.w+u.w,p=l.h;a.draw(n,{w:d,h:p},function(v){v.drawImage(c,0,0,d,p,0,0,d,p)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])})();function IB(r,e){return r.intersection?r.intersection(e):new Set(iy(r).filter(function(n){return e.has(n)}))}var BB=(function(){function r(e,n){Pd(this,r),this.r=e,this.globalOptions=n,this.atlasSize=n.webglTexSize,this.maxAtlasesPerBatch=n.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return Md(r,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(n,i){var a=this.globalOptions,s=a.webglTexSize,o=a.createTextureCanvas,l=i.texRows,u=this._cacheScratchCanvas(o),c=new DB(this.r,s,l,u);this.collections.set(n,c)}},{key:"addRenderType",value:function(n,i){var a=i.collection;if(!this.collections.has(a))throw new Error("invalid atlas collection name '".concat(a,"'"));var s=this.collections.get(a),o=Ht({type:n,atlasCollection:s},i);this.renderTypes.set(n,o)}},{key:"getRenderTypeOpts",value:function(n){return this.renderTypes.get(n)}},{key:"getAtlasCollection",value:function(n){return this.collections.get(n)}},{key:"_cacheScratchCanvas",value:function(n){var i=-1,a=-1,s=null;return function(o,l,u,c){return c?((!s||l!=i||u!=a)&&(i=l,a=u,s=n(o,l,u)),s):n(o,l,u)}}},{key:"_key",value:function(n,i){return"".concat(n,"-").concat(i)}},{key:"invalidate",value:function(n){var i=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=a.forceRedraw,o=s===void 0?!1:s,l=a.filterEle,u=l===void 0?function(){return!0}:l,c=a.filterType,d=c===void 0?function(){return!0}:c,p=!1,v=!1,y=js(n),b;try{for(y.s();!(b=y.n()).done;){var S=b.value;if(u(S)){var k=js(this.renderTypes.values()),T;try{var C=function(){var P=T.value,R=P.type;if(d(R)){var O=i.collections.get(P.collection),B=P.getKey(S),I=Array.isArray(B)?B:[B];if(o)I.forEach(function(Y){return O.markKeyForGC(Y)}),v=!0;else{var z=P.getID?P.getID(S):S.id(),V=i._key(R,z),$=i.typeAndIdToKey.get(V);$!==void 0&&!EB(I,$)&&(p=!0,i.typeAndIdToKey.delete(V),$.forEach(function(Y){return O.markKeyForGC(Y)}))}}};for(k.s();!(T=k.n()).done;)C()}catch(N){k.e(N)}finally{k.f()}}}}catch(N){y.e(N)}finally{y.f()}return v&&(this.gc(),p=!1),p}},{key:"gc",value:function(){var n=js(this.collections.values()),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;a.gc()}}catch(s){n.e(s)}finally{n.f()}}},{key:"getOrCreateAtlas",value:function(n,i,a,s){var o=this.renderTypes.get(i),l=this.collections.get(o.collection),u=!1,c=l.draw(s,a,function(v){o.drawClipped?(v.save(),v.beginPath(),v.rect(0,0,a.w,a.h),v.clip(),o.drawElement(v,n,a,!0,!0),v.restore()):o.drawElement(v,n,a,!0,!0),u=!0});if(u){var d=o.getID?o.getID(n):n.id(),p=this._key(i,d);this.typeAndIdToKey.has(p)?this.typeAndIdToKey.get(p).push(s):this.typeAndIdToKey.set(p,[s])}return c}},{key:"getAtlasInfo",value:function(n,i){var a=this,s=this.renderTypes.get(i),o=s.getKey(n),l=Array.isArray(o)?o:[o];return l.map(function(u){var c=s.getBoundingBox(n,u),d=a.getOrCreateAtlas(n,i,c,u),p=d.getOffsets(u),v=xi(p,2),y=v[0],b=v[1];return{atlas:d,tex:y,tex1:y,tex2:b,bb:c}})}},{key:"getDebugInfo",value:function(){var n=[],i=js(this.collections),a;try{for(i.s();!(a=i.n()).done;){var s=xi(a.value,2),o=s[0],l=s[1],u=l.getCounts(),c=u.keyCount,d=u.atlasCount;n.push({type:o,keyCount:c,atlasCount:d})}}catch(p){i.e(p)}finally{i.f()}return n}}])})(),zB=(function(){function r(e){Pd(this,r),this.globalOptions=e,this.atlasSize=e.webglTexSize,this.maxAtlasesPerBatch=e.webglTexPerBatch,this.batchAtlases=[]}return Md(r,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(n,i){return i})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(n){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(n):!0}},{key:"getAtlasIndexForBatch",value:function(n){var i=this.batchAtlases.indexOf(n);if(i<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(n),i=this.batchAtlases.length-1}return i}}])})(),FB=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,VB=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,UB=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,HB=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,yg={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},gy={IGNORE:1,USE_BB:2},aw=0,kN=1,CN=2,sw=3,Ff=4,m0=5,cm=6,dm=7,GB=(function(){function r(e,n,i){Pd(this,r),this.r=e,this.gl=n,this.maxInstances=i.webglBatchSize,this.atlasSize=i.webglTexSize,this.bgColor=i.bgColor,this.debug=i.webglDebug,this.batchDebugInfo=[],i.enableWrapping=!0,i.createTextureCanvas=_B,this.atlasManager=new BB(e,i),this.batchManager=new zB(i),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(yg.SCREEN),this.pickingProgram=this._createShaderProgram(yg.PICKING),this.vao=this._createVAO()}return Md(r,[{key:"addAtlasCollection",value:function(n,i){this.atlasManager.addAtlasCollection(n,i)}},{key:"addTextureAtlasRenderType",value:function(n,i){this.atlasManager.addRenderType(n,i)}},{key:"addSimpleShapeRenderType",value:function(n,i){this.simpleShapeOptions.set(n,i)}},{key:"invalidate",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.type,s=this.atlasManager;return a?s.invalidate(n,{filterType:function(l){return l===a},forceRedraw:!0}):s.invalidate(n)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(n){var i=this.gl,a=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(aw,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(Ff," || aVertType == ").concat(dm,` 
             || aVertType == `).concat(m0," || aVertType == ").concat(cm,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(kN,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(CN,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(sw,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),s=this.batchManager.getIndexArray(),o=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(s.map(function(c){return"uniform sampler2D uTexture".concat(c,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(FB,`
      `).concat(VB,`
      `).concat(UB,`
      `).concat(HB,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(aw,`) {
          // look up the texel from the texture unit
          `).concat(s.map(function(c){return"if(vAtlasId == ".concat(c,") outColor = texture(uTexture").concat(c,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(sw,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(Ff,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(Ff," || vVertType == ").concat(dm,` 
          || vVertType == `).concat(m0," || vVertType == ").concat(cm,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(Ff,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(dm,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(dm,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(n.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),l=wB(i,a,o);l.aPosition=i.getAttribLocation(l,"aPosition"),l.aIndex=i.getAttribLocation(l,"aIndex"),l.aVertType=i.getAttribLocation(l,"aVertType"),l.aTransform=i.getAttribLocation(l,"aTransform"),l.aAtlasId=i.getAttribLocation(l,"aAtlasId"),l.aTex=i.getAttribLocation(l,"aTex"),l.aPointAPointB=i.getAttribLocation(l,"aPointAPointB"),l.aPointCPointD=i.getAttribLocation(l,"aPointCPointD"),l.aLineWidth=i.getAttribLocation(l,"aLineWidth"),l.aColor=i.getAttribLocation(l,"aColor"),l.aCornerRadius=i.getAttribLocation(l,"aCornerRadius"),l.aBorderColor=i.getAttribLocation(l,"aBorderColor"),l.uPanZoomMatrix=i.getUniformLocation(l,"uPanZoomMatrix"),l.uAtlasSize=i.getUniformLocation(l,"uAtlasSize"),l.uBGColor=i.getUniformLocation(l,"uBGColor"),l.uZoom=i.getUniformLocation(l,"uZoom"),l.uTextures=[];for(var u=0;u<this.batchManager.getMaxAtlasesPerBatch();u++)l.uTextures.push(i.getUniformLocation(l,"uTexture".concat(u)));return l}},{key:"_createVAO",value:function(){var n=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=n.length/2;var i=this.maxInstances,a=this.gl,s=this.program,o=a.createVertexArray();return a.bindVertexArray(o),MB(a,"vec2",s.aPosition,n),this.transformBuffer=AB(a,i,s.aTransform),this.indexBuffer=ql(a,i,"vec4",s.aIndex),this.vertTypeBuffer=ql(a,i,"int",s.aVertType),this.atlasIdBuffer=ql(a,i,"int",s.aAtlasId),this.texBuffer=ql(a,i,"vec4",s.aTex),this.pointAPointBBuffer=ql(a,i,"vec4",s.aPointAPointB),this.pointCPointDBuffer=ql(a,i,"vec4",s.aPointCPointD),this.lineWidthBuffer=ql(a,i,"vec2",s.aLineWidth),this.colorBuffer=ql(a,i,"vec4",s.aColor),this.cornerRadiusBuffer=ql(a,i,"vec4",s.aCornerRadius),this.borderColorBuffer=ql(a,i,"vec4",s.aBorderColor),a.bindVertexArray(null),o}},{key:"buffers",get:function(){var n=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(i){return sd(i,"Buffer")}).map(function(i){return n[i]})),this._buffers}},{key:"startFrame",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yg.SCREEN;this.panZoomMatrix=n,this.renderTarget=i,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(n,i){return n.visible()?i&&i.isVisible?i.isVisible(n):!0:!1}},{key:"drawTexture",value:function(n,i,a){var s=this.atlasManager,o=this.batchManager,l=s.getRenderTypeOpts(a);if(this._isVisible(n,l)&&!(n.isEdge()&&!this._isValidEdge(n))){if(this.renderTarget.picking&&l.getTexPickingMode){var u=l.getTexPickingMode(n);if(u===gy.IGNORE)return;if(u==gy.USE_BB){this.drawPickingRectangle(n,i,a);return}}var c=s.getAtlasInfo(n,a),d=js(c),p;try{for(d.s();!(p=d.n()).done;){var v=p.value,y=v.atlas,b=v.tex1,S=v.tex2;o.canAddToCurrentBatch(y)||this.endBatch();for(var k=o.getAtlasIndexForBatch(y),T=0,C=[[b,!0],[S,!1]];T<C.length;T++){var N=xi(C[T],2),P=N[0],R=N[1];if(P.w!=0){var O=this.instanceCount;this.vertTypeBuffer.getView(O)[0]=aw;var B=this.indexBuffer.getView(O);zf(i,B);var I=this.atlasIdBuffer.getView(O);I[0]=k;var z=this.texBuffer.getView(O);z[0]=P.x,z[1]=P.y,z[2]=P.w,z[3]=P.h;var V=this.transformBuffer.getMatrixView(O);this.setTransformMatrix(n,V,l,v,R),this.instanceCount++,R||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch($){d.e($)}finally{d.f()}}}},{key:"setTransformMatrix",value:function(n,i,a,s){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,l=0;if(a.shapeProps&&a.shapeProps.padding&&(l=n.pstyle(a.shapeProps.padding).pfValue),s){var u=s.bb,c=s.tex1,d=s.tex2,p=c.w/(c.w+d.w);o||(p=1-p);var v=this._getAdjustedBB(u,l,o,p);this._applyTransformMatrix(i,v,a,n)}else{var y=a.getBoundingBox(n),b=this._getAdjustedBB(y,l,!0,1);this._applyTransformMatrix(i,b,a,n)}}},{key:"_applyTransformMatrix",value:function(n,i,a,s){var o,l;_N(n);var u=a.getRotation?a.getRotation(s):0;if(u!==0){var c=a.getRotationPoint(s),d=c.x,p=c.y;$0(n,n,[d,p]),SN(n,n,u);var v=a.getRotationOffset(s);o=v.x+(i.xOffset||0),l=v.y+(i.yOffset||0)}else o=i.x1,l=i.y1;$0(n,n,[o,l]),R2(n,n,[i.w,i.h])}},{key:"_getAdjustedBB",value:function(n,i,a,s){var o=n.x1,l=n.y1,u=n.w,c=n.h,d=n.yOffset;i&&(o-=i,l-=i,u+=2*i,c+=2*i);var p=0,v=u*s;return a&&s<1?u=v:!a&&s<1&&(p=u-v,o+=p,u=v),{x1:o,y1:l,w:u,h:c,xOffset:p,yOffset:d}}},{key:"drawPickingRectangle",value:function(n,i,a){var s=this.atlasManager.getRenderTypeOpts(a),o=this.instanceCount;this.vertTypeBuffer.getView(o)[0]=Ff;var l=this.indexBuffer.getView(o);zf(i,l);var u=this.colorBuffer.getView(o);ph([0,0,0],1,u);var c=this.transformBuffer.getMatrixView(o);this.setTransformMatrix(n,c,s),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(n,i,a){var s=this.simpleShapeOptions.get(a);if(this._isVisible(n,s)){var o=s.shapeProps,l=this._getVertTypeForShape(n,o.shape);if(l===void 0||s.isSimple&&!s.isSimple(n)){this.drawTexture(n,i,a);return}var u=this.instanceCount;if(this.vertTypeBuffer.getView(u)[0]=l,l===m0||l===cm){var c=s.getBoundingBox(n),d=this._getCornerRadius(n,o.radius,c),p=this.cornerRadiusBuffer.getView(u);p[0]=d,p[1]=d,p[2]=d,p[3]=d,l===cm&&(p[0]=0,p[2]=0)}var v=this.indexBuffer.getView(u);zf(i,v);var y=n.pstyle(o.color).value,b=n.pstyle(o.opacity).value,S=this.colorBuffer.getView(u);ph(y,b,S);var k=this.lineWidthBuffer.getView(u);if(k[0]=0,k[1]=0,o.border){var T=n.pstyle("border-width").value;if(T>0){var C=n.pstyle("border-color").value,N=n.pstyle("border-opacity").value,P=this.borderColorBuffer.getView(u);ph(C,N,P);var R=n.pstyle("border-position").value;if(R==="inside")k[0]=0,k[1]=-T;else if(R==="outside")k[0]=T,k[1]=0;else{var O=T/2;k[0]=O,k[1]=-O}}}var B=this.transformBuffer.getMatrixView(u);this.setTransformMatrix(n,B,s),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(n,i){var a=n.pstyle(i).value;switch(a){case"rectangle":return Ff;case"ellipse":return dm;case"roundrectangle":case"round-rectangle":return m0;case"bottom-round-rectangle":return cm;default:return}}},{key:"_getCornerRadius",value:function(n,i,a){var s=a.w,o=a.h;if(n.pstyle(i).value==="auto")return _d(s,o);var l=n.pstyle(i).pfValue,u=s/2,c=o/2;return Math.min(l,c,u)}},{key:"drawEdgeArrow",value:function(n,i,a){if(n.visible()){var s=n._private.rscratch,o,l,u;if(a==="source"?(o=s.arrowStartX,l=s.arrowStartY,u=s.srcArrowAngle):(o=s.arrowEndX,l=s.arrowEndY,u=s.tgtArrowAngle),!(isNaN(o)||o==null||isNaN(l)||l==null||isNaN(u)||u==null)){var c=n.pstyle(a+"-arrow-shape").value;if(c!=="none"){var d=n.pstyle(a+"-arrow-color").value,p=n.pstyle("opacity").value,v=n.pstyle("line-opacity").value,y=p*v,b=n.pstyle("width").pfValue,S=n.pstyle("arrow-scale").value,k=this.r.getArrowWidth(b,S),T=this.instanceCount,C=this.transformBuffer.getMatrixView(T);_N(C),$0(C,C,[o,l]),R2(C,C,[k,k]),SN(C,C,u),this.vertTypeBuffer.getView(T)[0]=sw;var N=this.indexBuffer.getView(T);zf(i,N);var P=this.colorBuffer.getView(T);ph(d,y,P),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(n,i){if(n.visible()){var a=this._getEdgePoints(n);if(a){var s=n.pstyle("opacity").value,o=n.pstyle("line-opacity").value,l=n.pstyle("width").pfValue,u=n.pstyle("line-color").value,c=s*o;if(a.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),a.length==4){var d=this.instanceCount;this.vertTypeBuffer.getView(d)[0]=kN;var p=this.indexBuffer.getView(d);zf(i,p);var v=this.colorBuffer.getView(d);ph(u,c,v);var y=this.lineWidthBuffer.getView(d);y[0]=l;var b=this.pointAPointBBuffer.getView(d);b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var S=0;S<a.length-2;S+=2){var k=this.instanceCount;this.vertTypeBuffer.getView(k)[0]=CN;var T=this.indexBuffer.getView(k);zf(i,T);var C=this.colorBuffer.getView(k);ph(u,c,C);var N=this.lineWidthBuffer.getView(k);N[0]=l;var P=a[S-2],R=a[S-1],O=a[S],B=a[S+1],I=a[S+2],z=a[S+3],V=a[S+4],$=a[S+5];S==0&&(P=2*O-I+.001,R=2*B-z+.001),S==a.length-4&&(V=2*I-O+.001,$=2*z-B+.001);var Y=this.pointAPointBBuffer.getView(k);Y[0]=P,Y[1]=R,Y[2]=O,Y[3]=B;var D=this.pointCPointDBuffer.getView(k);D[0]=I,D[1]=z,D[2]=V,D[3]=$,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_isValidEdge",value:function(n){var i=n._private.rscratch;return!(i.badLine||i.allpts==null||isNaN(i.allpts[0]))}},{key:"_getEdgePoints",value:function(n){var i=n._private.rscratch;if(this._isValidEdge(n)){var a=i.allpts;if(a.length==4)return a;var s=this._getNumSegments(n);return this._getCurveSegmentPoints(a,s)}}},{key:"_getNumSegments",value:function(n){var i=15;return Math.min(Math.max(i,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(n,i){if(n.length==4)return n;for(var a=Array((i+1)*2),s=0;s<=i;s++)if(s==0)a[0]=n[0],a[1]=n[1];else if(s==i)a[s*2]=n[n.length-2],a[s*2+1]=n[n.length-1];else{var o=s/i;this._setCurvePoint(n,o,a,s*2)}return a}},{key:"_setCurvePoint",value:function(n,i,a,s){if(n.length<=2)a[s]=n[0],a[s+1]=n[1];else{for(var o=Array(n.length-2),l=0;l<o.length;l+=2){var u=(1-i)*n[l]+i*n[l+2],c=(1-i)*n[l+1]+i*n[l+3];o[l]=u,o[l+1]=c}return this._setCurvePoint(o,i,a,s)}}},{key:"endBatch",value:function(){var n=this.gl,i=this.vao,a=this.vertexCount,s=this.instanceCount;if(s!==0){var o=this.renderTarget.picking?this.pickingProgram:this.program;n.useProgram(o),n.bindVertexArray(i);var l=js(this.buffers),u;try{for(l.s();!(u=l.n()).done;){var c=u.value;c.bufferSubData(s)}}catch(b){l.e(b)}finally{l.f()}for(var d=this.batchManager.getAtlases(),p=0;p<d.length;p++)d[p].bufferIfNeeded(n);for(var v=0;v<d.length;v++)n.activeTexture(n.TEXTURE0+v),n.bindTexture(n.TEXTURE_2D,d[v].texture),n.uniform1i(o.uTextures[v],v);n.uniform1f(o.uZoom,SB(this.r)),n.uniformMatrix3fv(o.uPanZoomMatrix,!1,this.panZoomMatrix),n.uniform1i(o.uAtlasSize,this.batchManager.getAtlasSize());var y=ph(this.bgColor,1);n.uniform4fv(o.uBGColor,y),n.drawArraysInstanced(n.TRIANGLES,0,a,s),n.bindVertexArray(null),n.bindTexture(n.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:s,atlasCount:d.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var n=this.atlasManager.getDebugInfo(),i=n.reduce(function(o,l){return o+l.atlasCount},0),a=this.batchDebugInfo,s=a.reduce(function(o,l){return o+l.count},0);return{atlasInfo:n,totalAtlases:i,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:a.length,batchInfo:a,totalInstances:s}}}])})(),eM={};eM.initWebgl=function(r,e){var n=this,i=n.data.contexts[n.WEBGL];r.bgColor=qB(n),r.webglTexSize=Math.min(r.webglTexSize,i.getParameter(i.MAX_TEXTURE_SIZE)),r.webglTexRows=Math.min(r.webglTexRows,54),r.webglTexRowsNodes=Math.min(r.webglTexRowsNodes,54),r.webglBatchSize=Math.min(r.webglBatchSize,16384),r.webglTexPerBatch=Math.min(r.webglTexPerBatch,i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS)),n.webglDebug=r.webglDebug,n.webglDebugShowAtlases=r.webglDebugShowAtlases,n.pickingFrameBuffer=jB(i),n.pickingFrameBuffer.needsDraw=!0,n.drawing=new GB(n,i,r);var a=function(p){return function(v){return n.getTextAngle(v,p)}},s=function(p){return function(v){var y=v.pstyle(p);return y&&y.value}},o=function(p){return function(v){return v.pstyle("".concat(p,"-opacity")).value>0}},l=function(p){var v=p.pstyle("text-events").strValue==="yes";return v?gy.USE_BB:gy.IGNORE},u=function(p){var v=p.position(),y=v.x,b=v.y,S=p.outerWidth(),k=p.outerHeight();return{w:S,h:k,x1:y-S/2,y1:b-k/2}};n.drawing.addAtlasCollection("node",{texRows:r.webglTexRowsNodes}),n.drawing.addAtlasCollection("label",{texRows:r.webglTexRows}),n.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement}),n.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:u,isSimple:CB,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),n.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:u,isVisible:o("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),n.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:u,isVisible:o("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),n.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:l,getKey:ow(e.getLabelKey,null),getBoundingBox:lw(e.getLabelBox,null),drawClipped:!0,drawElement:e.drawLabel,getRotation:a(null),getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:s("label")}),n.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:l,getKey:ow(e.getSourceLabelKey,"source"),getBoundingBox:lw(e.getSourceLabelBox,"source"),drawClipped:!0,drawElement:e.drawSourceLabel,getRotation:a("source"),getRotationPoint:e.getSourceLabelRotationPoint,getRotationOffset:e.getSourceLabelRotationOffset,isVisible:s("source-label")}),n.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:l,getKey:ow(e.getTargetLabelKey,"target"),getBoundingBox:lw(e.getTargetLabelBox,"target"),drawClipped:!0,drawElement:e.drawTargetLabel,getRotation:a("target"),getRotationPoint:e.getTargetLabelRotationPoint,getRotationOffset:e.getTargetLabelRotationOffset,isVisible:s("target-label")});var c=dv(function(){console.log("garbage collect flag set"),n.data.gc=!0},1e4);n.onUpdateEleCalcs(function(d,p){var v=!1;p&&p.length>0&&(v|=n.drawing.invalidate(p)),v&&c()}),WB(n)};function qB(r){var e=r.cy.container(),n=e&&e.style&&e.style.backgroundColor||"white";return T4(n)}function tM(r,e){var n=r._private.rscratch;return Ps(n,"labelWrapCachedLines",e)||[]}var ow=function(e,n){return function(i){var a=e(i),s=tM(i,n);return s.length>1?s.map(function(o,l){return"".concat(a,"_").concat(l)}):a}},lw=function(e,n){return function(i,a){var s=e(i);if(typeof a=="string"){var o=a.indexOf("_");if(o>0){var l=Number(a.substring(o+1)),u=tM(i,n),c=s.h/u.length,d=c*l,p=s.y1+d;return{x1:s.x1,w:s.w,y1:p,h:c,yOffset:d}}}return s}};function WB(r){{var e=r.render;r.render=function(s){s=s||{};var o=r.cy;r.webgl&&(o.zoom()>$P?($B(r),e.call(r,s)):(KB(r),nM(r,s,yg.SCREEN)))}}{var n=r.matchCanvasSize;r.matchCanvasSize=function(s){n.call(r,s),r.pickingFrameBuffer.setFramebufferAttachmentSizes(r.canvasWidth,r.canvasHeight),r.pickingFrameBuffer.needsDraw=!0}}r.findNearestElements=function(s,o,l,u){return ez(r,s,o)};{var i=r.invalidateCachedZSortedEles;r.invalidateCachedZSortedEles=function(){i.call(r),r.pickingFrameBuffer.needsDraw=!0}}{var a=r.notify;r.notify=function(s,o){a.call(r,s,o),s==="viewport"||s==="bounds"?r.pickingFrameBuffer.needsDraw=!0:s==="background"&&r.drawing.invalidate(o,{type:"node-body"})}}}function $B(r){var e=r.data.contexts[r.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function KB(r){var e=function(i){i.save(),i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,r.canvasWidth,r.canvasHeight),i.restore()};e(r.data.contexts[r.NODE]),e(r.data.contexts[r.DRAG])}function ZB(r){var e=r.canvasWidth,n=r.canvasHeight,i=X_(r),a=i.pan,s=i.zoom,o=iw();$0(o,o,[a.x,a.y]),R2(o,o,[s,s]);var l=iw();LB(l,e,n);var u=iw();return RB(u,l,o),u}function rM(r,e){var n=r.canvasWidth,i=r.canvasHeight,a=X_(r),s=a.pan,o=a.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,n,i),e.translate(s.x,s.y),e.scale(o,o)}function YB(r,e){r.drawSelectionRectangle(e,function(n){return rM(r,n)})}function XB(r){var e=r.data.contexts[r.NODE];e.save(),rM(r,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function QB(r){var e=function(a,s,o){for(var l=a.atlasManager.getAtlasCollection(s),u=r.data.contexts[r.NODE],c=l.atlases,d=0;d<c.length;d++){var p=c[d],v=p.canvas;if(v){var y=v.width,b=v.height,S=y*d,k=v.height*o,T=.4;u.save(),u.scale(T,T),u.drawImage(v,S,k),u.strokeStyle="black",u.rect(S,k,y,b),u.stroke(),u.restore()}}},n=0;e(r.drawing,"node",n++),e(r.drawing,"label",n++)}function JB(r,e,n,i,a){var s,o,l,u,c=X_(r),d=c.pan,p=c.zoom;{var v=kB(r,d,p,e,n),y=xi(v,2),b=y[0],S=y[1],k=6;s=b-k/2,o=S-k/2,l=k,u=k}if(l===0||u===0)return[];var T=r.data.contexts[r.WEBGL];T.bindFramebuffer(T.FRAMEBUFFER,r.pickingFrameBuffer),r.pickingFrameBuffer.needsDraw&&(T.viewport(0,0,T.canvas.width,T.canvas.height),nM(r,null,yg.PICKING),r.pickingFrameBuffer.needsDraw=!1);var C=l*u,N=new Uint8Array(C*4);T.readPixels(s,o,l,u,T.RGBA,T.UNSIGNED_BYTE,N),T.bindFramebuffer(T.FRAMEBUFFER,null);for(var P=new Set,R=0;R<C;R++){var O=N.slice(R*4,R*4+4),B=NB(O)-1;B>=0&&P.add(B)}return P}function ez(r,e,n){var i=JB(r,e,n),a=r.getCachedZSortedEles(),s,o,l=js(i),u;try{for(l.s();!(u=l.n()).done;){var c=u.value,d=a[c];if(!s&&d.isNode()&&(s=d),!o&&d.isEdge()&&(o=d),s&&o)break}}catch(p){l.e(p)}finally{l.f()}return[s,o].filter(Boolean)}function uw(r,e,n){var i=r.drawing;e+=1,n.isNode()?(i.drawNode(n,e,"node-underlay"),i.drawNode(n,e,"node-body"),i.drawTexture(n,e,"label"),i.drawNode(n,e,"node-overlay")):(i.drawEdgeLine(n,e),i.drawEdgeArrow(n,e,"source"),i.drawEdgeArrow(n,e,"target"),i.drawTexture(n,e,"label"),i.drawTexture(n,e,"edge-source-label"),i.drawTexture(n,e,"edge-target-label"))}function nM(r,e,n){var i;r.webglDebug&&(i=performance.now());var a=r.drawing,s=0;if(n.screen&&r.data.canvasNeedsRedraw[r.SELECT_BOX]&&YB(r,e),r.data.canvasNeedsRedraw[r.NODE]||n.picking){var o=r.data.contexts[r.WEBGL];n.screen?(o.clearColor(0,0,0,0),o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA)):o.disable(o.BLEND),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT),o.viewport(0,0,o.canvas.width,o.canvas.height);var l=ZB(r),u=r.getCachedZSortedEles();if(s=u.length,a.startFrame(l,n),n.screen){for(var c=0;c<u.nondrag.length;c++)uw(r,c,u.nondrag[c]);for(var d=0;d<u.drag.length;d++)uw(r,d,u.drag[d])}else if(n.picking)for(var p=0;p<u.length;p++)uw(r,p,u[p]);a.endFrame(),n.screen&&r.webglDebugShowAtlases&&(XB(r),QB(r)),r.data.canvasNeedsRedraw[r.NODE]=!1,r.data.canvasNeedsRedraw[r.DRAG]=!1}if(r.webglDebug){var v=performance.now(),y=!1,b=Math.ceil(v-i),S=a.getDebugInfo(),k=["".concat(s," elements"),"".concat(S.totalInstances," instances"),"".concat(S.batchCount," batches"),"".concat(S.totalAtlases," atlases"),"".concat(S.wrappedCount," wrapped textures"),"".concat(S.simpleCount," simple shapes")].join(", ");if(y)console.log("WebGL (".concat(n.name,") - time ").concat(b,"ms, ").concat(k));else{console.log("WebGL (".concat(n.name,") - frame time ").concat(b,"ms")),console.log("Totals:"),console.log("  ".concat(k)),console.log("Texture Atlases Used:");var T=S.atlasInfo,C=js(T),N;try{for(C.s();!(N=C.n()).done;){var P=N.value;console.log("  ".concat(P.type,": ").concat(P.keyCount," keys, ").concat(P.atlasCount," atlases"))}}catch(R){C.e(R)}finally{C.f()}console.log("")}}r.data.gc&&(console.log("Garbage Collect!"),r.data.gc=!1,a.gc())}var Rd={};Rd.drawPolygonPath=function(r,e,n,i,a,s){var o=i/2,l=a/2;r.beginPath&&r.beginPath(),r.moveTo(e+o*s[0],n+l*s[1]);for(var u=1;u<s.length/2;u++)r.lineTo(e+o*s[u*2],n+l*s[u*2+1]);r.closePath()};Rd.drawRoundPolygonPath=function(r,e,n,i,a,s,o){o.forEach(function(l){return BP(r,l)}),r.closePath()};Rd.drawRoundRectanglePath=function(r,e,n,i,a,s){var o=i/2,l=a/2,u=s==="auto"?_d(i,a):Math.min(s,l,o);r.beginPath&&r.beginPath(),r.moveTo(e,n-l),r.arcTo(e+o,n-l,e+o,n,u),r.arcTo(e+o,n+l,e,n+l,u),r.arcTo(e-o,n+l,e-o,n,u),r.arcTo(e-o,n-l,e,n-l,u),r.lineTo(e,n-l),r.closePath()};Rd.drawBottomRoundRectanglePath=function(r,e,n,i,a,s){var o=i/2,l=a/2,u=s==="auto"?_d(i,a):s;r.beginPath&&r.beginPath(),r.moveTo(e,n-l),r.lineTo(e+o,n-l),r.lineTo(e+o,n),r.arcTo(e+o,n+l,e,n+l,u),r.arcTo(e-o,n+l,e-o,n,u),r.lineTo(e-o,n-l),r.lineTo(e,n-l),r.closePath()};Rd.drawCutRectanglePath=function(r,e,n,i,a,s,o){var l=i/2,u=a/2,c=o==="auto"?I_():o;r.beginPath&&r.beginPath(),r.moveTo(e-l+c,n-u),r.lineTo(e+l-c,n-u),r.lineTo(e+l,n-u+c),r.lineTo(e+l,n+u-c),r.lineTo(e+l-c,n+u),r.lineTo(e-l+c,n+u),r.lineTo(e-l,n+u-c),r.lineTo(e-l,n-u+c),r.closePath()};Rd.drawBarrelPath=function(r,e,n,i,a){var s=i/2,o=a/2,l=e-s,u=e+s,c=n-o,d=n+o,p=x2(i,a),v=p.widthOffset,y=p.heightOffset,b=p.ctrlPtOffsetPct*v;r.beginPath&&r.beginPath(),r.moveTo(l,c+y),r.lineTo(l,d-y),r.quadraticCurveTo(l+b,d,l+v,d),r.lineTo(u-v,d),r.quadraticCurveTo(u-b,d,u,d-y),r.lineTo(u,c+y),r.quadraticCurveTo(u-b,c,u-v,c),r.lineTo(l+v,c),r.quadraticCurveTo(l+b,c,l,c+y),r.closePath()};var EN=Math.sin(0),NN=Math.cos(0),L2={},O2={},iM=Math.PI/40;for(var Vf=0*Math.PI;Vf<2*Math.PI;Vf+=iM)L2[Vf]=Math.sin(Vf),O2[Vf]=Math.cos(Vf);Rd.drawEllipsePath=function(r,e,n,i,a){if(r.beginPath&&r.beginPath(),r.ellipse)r.ellipse(e,n,i/2,a/2,0,0,2*Math.PI);else for(var s,o,l=i/2,u=a/2,c=0*Math.PI;c<2*Math.PI;c+=iM)s=e-l*L2[c]*EN+l*O2[c]*NN,o=n+u*O2[c]*EN+u*L2[c]*NN,c===0?r.moveTo(s,o):r.lineTo(s,o);r.closePath()};var vv={};vv.createBuffer=function(r,e){var n=document.createElement("canvas");return n.width=r,n.height=e,[n,n.getContext("2d")]};vv.bufferCanvasImage=function(r){var e=this.cy,n=e.mutableElements(),i=n.boundingBox(),a=this.findContainerClientCoords(),s=r.full?Math.ceil(i.w):a[2],o=r.full?Math.ceil(i.h):a[3],l=ht(r.maxWidth)||ht(r.maxHeight),u=this.getPixelRatio(),c=1;if(r.scale!==void 0)s*=r.scale,o*=r.scale,c=r.scale;else if(l){var d=1/0,p=1/0;ht(r.maxWidth)&&(d=c*r.maxWidth/s),ht(r.maxHeight)&&(p=c*r.maxHeight/o),c=Math.min(d,p),s*=c,o*=c}l||(s*=u,o*=u,c*=u);var v=document.createElement("canvas");v.width=s,v.height=o,v.style.width=s+"px",v.style.height=o+"px";var y=v.getContext("2d");if(s>0&&o>0){y.clearRect(0,0,s,o),y.globalCompositeOperation="source-over";var b=this.getCachedZSortedEles();if(r.full)y.translate(-i.x1*c,-i.y1*c),y.scale(c,c),this.drawElements(y,b),y.scale(1/c,1/c),y.translate(i.x1*c,i.y1*c);else{var S=e.pan(),k={x:S.x*c,y:S.y*c};c*=e.zoom(),y.translate(k.x,k.y),y.scale(c,c),this.drawElements(y,b),y.scale(1/c,1/c),y.translate(-k.x,-k.y)}r.bg&&(y.globalCompositeOperation="destination-over",y.fillStyle=r.bg,y.rect(0,0,s,o),y.fill())}return v};function tz(r,e){for(var n=atob(r),i=new ArrayBuffer(n.length),a=new Uint8Array(i),s=0;s<n.length;s++)a[s]=n.charCodeAt(s);return new Blob([i],{type:e})}function TN(r){var e=r.indexOf(",");return r.substr(e+1)}function aM(r,e,n){var i=function(){return e.toDataURL(n,r.quality)};switch(r.output){case"blob-promise":return new Pp(function(a,s){try{e.toBlob(function(o){o!=null?a(o):s(new Error("`canvas.toBlob()` sent a null value in its callback"))},n,r.quality)}catch(o){s(o)}});case"blob":return tz(TN(i()),n);case"base64":return TN(i());default:return i()}}vv.png=function(r){return aM(r,this.bufferCanvasImage(r),"image/png")};vv.jpg=function(r){return aM(r,this.bufferCanvasImage(r),"image/jpeg")};var sM={};sM.nodeShapeImpl=function(r,e,n,i,a,s,o,l){switch(r){case"ellipse":return this.drawEllipsePath(e,n,i,a,s);case"polygon":return this.drawPolygonPath(e,n,i,a,s,o);case"round-polygon":return this.drawRoundPolygonPath(e,n,i,a,s,o,l);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,n,i,a,s,l);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,n,i,a,s,o,l);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,n,i,a,s,l);case"barrel":return this.drawBarrelPath(e,n,i,a,s)}};var rz=oM,lr=oM.prototype;lr.CANVAS_LAYERS=3;lr.SELECT_BOX=0;lr.DRAG=1;lr.NODE=2;lr.WEBGL=3;lr.CANVAS_TYPES=["2d","2d","2d","webgl2"];lr.BUFFER_COUNT=3;lr.TEXTURE_BUFFER=0;lr.MOTIONBLUR_BUFFER_NODE=1;lr.MOTIONBLUR_BUFFER_DRAG=2;function oM(r){var e=this,n=e.cy.window(),i=n.document;r.webgl&&(lr.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(lr.CANVAS_LAYERS),contexts:new Array(lr.CANVAS_LAYERS),canvasNeedsRedraw:new Array(lr.CANVAS_LAYERS),bufferCanvases:new Array(lr.BUFFER_COUNT),bufferContexts:new Array(lr.CANVAS_LAYERS)};var a="-webkit-tap-highlight-color",s="rgba(0,0,0,0)";e.data.canvasContainer=i.createElement("div");var o=e.data.canvasContainer.style;e.data.canvasContainer.style[a]=s,o.position="relative",o.zIndex="0",o.overflow="hidden";var l=r.cy.container();l.appendChild(e.data.canvasContainer),l.style[a]=s;var u={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};Y8()&&(u["-ms-touch-action"]="none",u["touch-action"]="none");for(var c=0;c<lr.CANVAS_LAYERS;c++){var d=e.data.canvases[c]=i.createElement("canvas"),p=lr.CANVAS_TYPES[c];e.data.contexts[c]=d.getContext(p),e.data.contexts[c]||Rn("Could not create canvas of type "+p),Object.keys(u).forEach(function(le){d.style[le]=u[le]}),d.style.position="absolute",d.setAttribute("data-id","layer"+c),d.style.zIndex=String(lr.CANVAS_LAYERS-c),e.data.canvasContainer.appendChild(d),e.data.canvasNeedsRedraw[c]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[lr.NODE].setAttribute("data-id","layer"+lr.NODE+"-node"),e.data.canvases[lr.SELECT_BOX].setAttribute("data-id","layer"+lr.SELECT_BOX+"-selectbox"),e.data.canvases[lr.DRAG].setAttribute("data-id","layer"+lr.DRAG+"-drag"),e.data.canvases[lr.WEBGL]&&e.data.canvases[lr.WEBGL].setAttribute("data-id","layer"+lr.WEBGL+"-webgl");for(var c=0;c<lr.BUFFER_COUNT;c++)e.data.bufferCanvases[c]=i.createElement("canvas"),e.data.bufferContexts[c]=e.data.bufferCanvases[c].getContext("2d"),e.data.bufferCanvases[c].style.position="absolute",e.data.bufferCanvases[c].setAttribute("data-id","buffer"+c),e.data.bufferCanvases[c].style.zIndex=String(-c-1),e.data.bufferCanvases[c].style.visibility="hidden";e.pathsEnabled=!0;var v=cs(),y=function(pe){return{x:(pe.x1+pe.x2)/2,y:(pe.y1+pe.y2)/2}},b=function(pe){return{x:-pe.w/2,y:-pe.h/2}},S=function(pe){var me=pe[0]._private,be=me.oldBackgroundTimestamp===me.backgroundTimestamp;return!be},k=function(pe){return pe[0]._private.nodeKey},T=function(pe){return pe[0]._private.labelStyleKey},C=function(pe){return pe[0]._private.sourceLabelStyleKey},N=function(pe){return pe[0]._private.targetLabelStyleKey},P=function(pe,me,be,Se,Ue){return e.drawElement(pe,me,be,!1,!1,Ue)},R=function(pe,me,be,Se,Ue){return e.drawElementText(pe,me,be,Se,"main",Ue)},O=function(pe,me,be,Se,Ue){return e.drawElementText(pe,me,be,Se,"source",Ue)},B=function(pe,me,be,Se,Ue){return e.drawElementText(pe,me,be,Se,"target",Ue)},I=function(pe){return pe.boundingBox(),pe[0]._private.bodyBounds},z=function(pe){return pe.boundingBox(),pe[0]._private.labelBounds.main||v},V=function(pe){return pe.boundingBox(),pe[0]._private.labelBounds.source||v},$=function(pe){return pe.boundingBox(),pe[0]._private.labelBounds.target||v},Y=function(pe,me){return me},D=function(pe){return y(I(pe))},q=function(pe,me,be){var Se=pe?pe+"-":"";return{x:me.x+be.pstyle(Se+"text-margin-x").pfValue,y:me.y+be.pstyle(Se+"text-margin-y").pfValue}},G=function(pe,me,be){var Se=pe[0]._private.rscratch;return{x:Se[me],y:Se[be]}},Z=function(pe){return q("",G(pe,"labelX","labelY"),pe)},Q=function(pe){return q("source",G(pe,"sourceLabelX","sourceLabelY"),pe)},J=function(pe){return q("target",G(pe,"targetLabelX","targetLabelY"),pe)},ie=function(pe){return b(I(pe))},ne=function(pe){return b(V(pe))},W=function(pe){return b($(pe))},re=function(pe){var me=z(pe),be=b(z(pe));if(pe.isNode()){switch(pe.pstyle("text-halign").value){case"left":be.x=-me.w-(me.leftPad||0);break;case"right":be.x=-(me.rightPad||0);break}switch(pe.pstyle("text-valign").value){case"top":be.y=-me.h-(me.topPad||0);break;case"bottom":be.y=-(me.botPad||0);break}}return be},ae=e.data.eleTxrCache=new ug(e,{getKey:k,doesEleInvalidateKey:S,drawElement:P,getBoundingBox:I,getRotationPoint:D,getRotationOffset:ie,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),he=e.data.lblTxrCache=new ug(e,{getKey:T,drawElement:R,getBoundingBox:z,getRotationPoint:Z,getRotationOffset:re,isVisible:Y}),ve=e.data.slbTxrCache=new ug(e,{getKey:C,drawElement:O,getBoundingBox:V,getRotationPoint:Q,getRotationOffset:ne,isVisible:Y}),xe=e.data.tlbTxrCache=new ug(e,{getKey:N,drawElement:B,getBoundingBox:$,getRotationPoint:J,getRotationOffset:W,isVisible:Y}),se=e.data.lyrTxrCache=new KP(e);e.onUpdateEleCalcs(function(pe,me){ae.invalidateElements(me),he.invalidateElements(me),ve.invalidateElements(me),xe.invalidateElements(me),se.invalidateElements(me);for(var be=0;be<me.length;be++){var Se=me[be]._private;Se.oldBackgroundTimestamp=Se.backgroundTimestamp}});var ge=function(pe){for(var me=0;me<pe.length;me++)se.enqueueElementRefinement(pe[me].ele)};ae.onDequeue(ge),he.onDequeue(ge),ve.onDequeue(ge),xe.onDequeue(ge),r.webgl&&e.initWebgl(r,{getStyleKey:k,getLabelKey:T,getSourceLabelKey:C,getTargetLabelKey:N,drawElement:P,drawLabel:R,drawSourceLabel:O,drawTargetLabel:B,getElementBox:I,getLabelBox:z,getSourceLabelBox:V,getTargetLabelBox:$,getElementRotationPoint:D,getElementRotationOffset:ie,getLabelRotationPoint:Z,getSourceLabelRotationPoint:Q,getTargetLabelRotationPoint:J,getLabelRotationOffset:re,getSourceLabelRotationOffset:ne,getTargetLabelRotationOffset:W})}lr.redrawHint=function(r,e){var n=this;switch(r){case"eles":n.data.canvasNeedsRedraw[lr.NODE]=e;break;case"drag":n.data.canvasNeedsRedraw[lr.DRAG]=e;break;case"select":n.data.canvasNeedsRedraw[lr.SELECT_BOX]=e;break;case"gc":n.data.gc=!0;break}};var nz=typeof Path2D<"u";lr.path2dEnabled=function(r){if(r===void 0)return this.pathsEnabled;this.pathsEnabled=!!r};lr.usePaths=function(){return nz&&this.pathsEnabled};lr.setImgSmoothing=function(r,e){r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled=e:(r.webkitImageSmoothingEnabled=e,r.mozImageSmoothingEnabled=e,r.msImageSmoothingEnabled=e)};lr.getImgSmoothing=function(r){return r.imageSmoothingEnabled!=null?r.imageSmoothingEnabled:r.webkitImageSmoothingEnabled||r.mozImageSmoothingEnabled||r.msImageSmoothingEnabled};lr.makeOffscreenCanvas=function(r,e){var n;if((typeof OffscreenCanvas>"u"?"undefined":Ai(OffscreenCanvas))!=="undefined")n=new OffscreenCanvas(r,e);else{var i=this.cy.window(),a=i.document;n=a.createElement("canvas"),n.width=r,n.height=e}return n};[ZP,ou,Ju,Y_,Xh,jd,fs,eM,Rd,vv,sM].forEach(function(r){Ht(lr,r)});var iz=[{name:"null",impl:OP},{name:"base",impl:qP},{name:"canvas",impl:rz}],az=[{type:"layout",extensions:M7},{type:"renderer",extensions:iz}],lM={},uM={};function cM(r,e,n){var i=n,a=function(I){zr("Can not register `"+e+"` for `"+r+"` since `"+I+"` already exists in the prototype and can not be overridden")};if(r==="core"){if(Ug.prototype[e])return a(e);Ug.prototype[e]=n}else if(r==="collection"){if(Ca.prototype[e])return a(e);Ca.prototype[e]=n}else if(r==="layout"){for(var s=function(I){this.options=I,n.call(this,I),Sr(this._private)||(this._private={}),this._private.cy=I.cy,this._private.listeners=[],this.createEmitter()},o=s.prototype=Object.create(n.prototype),l=[],u=0;u<l.length;u++){var c=l[u];o[c]=o[c]||function(){return this}}o.start&&!o.run?o.run=function(){return this.start(),this}:!o.start&&o.run&&(o.start=function(){return this.run(),this});var d=n.prototype.stop;o.stop=function(){var B=this.options;if(B&&B.animate){var I=this.animations;if(I)for(var z=0;z<I.length;z++)I[z].stop()}return d?d.call(this):this.emit("layoutstop"),this},o.destroy||(o.destroy=function(){return this}),o.cy=function(){return this._private.cy};var p=function(I){return I._private.cy},v={addEventFields:function(I,z){z.layout=I,z.cy=p(I),z.target=I},bubble:function(){return!0},parent:function(I){return p(I)}};Ht(o,{createEmitter:function(){return this._private.emitter=new Sx(v,this),this},emitter:function(){return this._private.emitter},on:function(I,z){return this.emitter().on(I,z),this},one:function(I,z){return this.emitter().one(I,z),this},once:function(I,z){return this.emitter().one(I,z),this},removeListener:function(I,z){return this.emitter().removeListener(I,z),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(I,z){return this.emitter().emit(I,z),this}}),Br.eventAliasesOn(o),i=s}else if(r==="renderer"&&e!=="null"&&e!=="base"){var y=dM("renderer","base"),b=y.prototype,S=n,k=n.prototype,T=function(){y.apply(this,arguments),S.apply(this,arguments)},C=T.prototype;for(var N in b){var P=b[N],R=k[N]!=null;if(R)return a(N);C[N]=P}for(var O in k)C[O]=k[O];b.clientFunctions.forEach(function(B){C[B]=C[B]||function(){Rn("Renderer does not implement `renderer."+B+"()` on its prototype")}}),i=T}else if(r==="__proto__"||r==="constructor"||r==="prototype")return Rn(r+" is an illegal type to be registered, possibly lead to prototype pollutions");return P4({map:lM,keys:[r,e],value:i})}function dM(r,e){return M4({map:lM,keys:[r,e]})}function sz(r,e,n,i,a){return P4({map:uM,keys:[r,e,n,i],value:a})}function oz(r,e,n,i){return M4({map:uM,keys:[r,e,n,i]})}var D2=function(){if(arguments.length===2)return dM.apply(null,arguments);if(arguments.length===3)return cM.apply(null,arguments);if(arguments.length===4)return oz.apply(null,arguments);if(arguments.length===5)return sz.apply(null,arguments);Rn("Invalid extension access syntax")};Ug.prototype.extension=D2;az.forEach(function(r){r.extensions.forEach(function(e){cM(r.type,e.name,e.impl)})});var vy=function(){if(!(this instanceof vy))return new vy;this.length=0},Fh=vy.prototype;Fh.instanceString=function(){return"stylesheet"};Fh.selector=function(r){var e=this.length++;return this[e]={selector:r,properties:[]},this};Fh.css=function(r,e){var n=this.length-1;if(Dt(r))this[n].properties.push({name:r,value:e});else if(Sr(r))for(var i=r,a=Object.keys(i),s=0;s<a.length;s++){var o=a[s],l=i[o];if(l!=null){var u=Xi.properties[o]||Xi.properties[fx(o)];if(u!=null){var c=u.name,d=l;this[n].properties.push({name:c,value:d})}}}return this};Fh.style=Fh.css;Fh.generateStyle=function(r){var e=new Xi(r);return this.appendToStyle(e)};Fh.appendToStyle=function(r){for(var e=0;e<this.length;e++){var n=this[e],i=n.selector,a=n.properties;r.selector(i);for(var s=0;s<a.length;s++){var o=a[s];r.css(o.name,o.value)}}return r};var lz="3.33.1",Vh=function(e){if(e===void 0&&(e={}),Sr(e))return new Ug(e);if(Dt(e))return D2.apply(D2,arguments)};Vh.use=function(r){var e=Array.prototype.slice.call(arguments,1);return e.unshift(Vh),r.apply(null,e),this};Vh.warnings=function(r){return I4(r)};Vh.version=lz;Vh.stylesheet=Vh.Stylesheet=vy;const{string:g0,array:PN,object:v0,number:hm,bool:Zs,oneOfType:Uf,any:y0,func:fm}=j8,uz={id:g0,className:g0,style:Uf([g0,v0]),elements:Uf([PN,y0]),stylesheet:Uf([PN,y0]),layout:Uf([v0,y0]),pan:Uf([v0,y0]),zoom:hm,panningEnabled:Zs,userPanningEnabled:Zs,minZoom:hm,maxZoom:hm,zoomingEnabled:Zs,userZoomingEnabled:Zs,boxSelectionEnabled:Zs,autoungrabify:Zs,autolock:Zs,autounselectify:Zs,get:fm,toJson:fm,diff:fm,forEach:fm,cy:fm,headless:Zs,styleEnabled:Zs,hideEdgesOnViewport:Zs,textureOnViewport:Zs,motionBlur:Zs,motionBlurOpacity:hm,wheelSensitivity:hm,pixelRatio:Uf([g0,v0])},hM=(r,e)=>{if(((s,o)=>s==null||o==null)(r,e)&&(r!=null||e!=null))return!0;if(r===e)return!1;if(typeof r!="object"||typeof e!="object")return r!==e;const n=Object.keys(r),i=Object.keys(e),a=s=>r[s]!==e[s];return n.length!==i.length||!(!n.some(a)&&!i.some(a))},ol=(r,e)=>r!=null?r[e]:null,cz={diff:hM,get:ol,toJson:r=>r,forEach:(r,e)=>r.forEach(e),elements:[{data:{id:"a",label:"Example node A"}},{data:{id:"b",label:"Example node B"}},{data:{id:"e",source:"a",target:"b"}}],stylesheet:[{selector:"node",style:{label:"data(label)"}}],zoom:1,pan:{x:0,y:0}},x0=(r,e,n,i)=>n(ol(r,i),ol(e,i)),dz=(r,e,n,i,a,s,o)=>{r.batch(()=>{(i===hM||x0(e,n,i,"elements"))&&mz(r,ol(e,"elements"),ol(n,"elements"),a,s,o,i),x0(e,n,i,"stylesheet")&&pz(r,ol(e,"stylesheet"),ol(n,"stylesheet"),a),["zoom","minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","pan","panningEnabled","userPanningEnabled","boxSelectionEnabled","autoungrabify","autolock","autounselectify"].forEach(l=>{x0(e,n,i,l)&&hz(r,l,ol(e,l),ol(n,l),a)})}),x0(e,n,i,"layout")&&fz(r,ol(e,"layout"),ol(n,"layout"),a)},hz=(r,e,n,i,a)=>{r[e](a(i))},fz=(r,e,n,i)=>{const a=i(n);a!=null&&r.layout(a).run()},pz=(r,e,n,i)=>{const a=r.style();a?.fromJson(i(n)).update()},mz=(r,e,n,i,a,s,o)=>{const l=[],u=r.collection(),c=[],d={},p={},v=y=>a(a(y,"data"),"id");s(n,y=>{const b=v(y);p[b]=y}),e!=null&&s(e,y=>{const b=v(y);d[b]=y,(S=>p[S]!=null)(b)||u.merge(r.getElementById(b))}),s(n,y=>{const b=v(y),S=(k=>d[k])(b);(k=>d[k]!=null)(b)?c.push({ele1:S,ele2:y}):l.push(i(y))}),u.length>0&&r.remove(u),l.length>0&&r.add(l),c.forEach(({ele1:y,ele2:b})=>gz(r,y,b,i,a,o))},gz=(r,e,n,i,a,s)=>{const o=a(a(n,"data"),"id"),l=r.getElementById(o),u={};["data","position","selected","selectable","locked","grabbable","classes"].forEach(d=>{const p=a(n,d);s(p,a(e,d))&&(u[d]=i(p))});const c=a(n,"scratch");s(c,a(e,"scratch"))&&l.scratch(i(c)),Object.keys(u).length>0&&l.json(u)};class vz extends Xt.Component{static get propTypes(){return uz}static get defaultProps(){return cz}static normalizeElements(e){if(e.length!=null)return e;{let{nodes:n,edges:i}=e;return n==null&&(n=[]),i==null&&(i=[]),n.concat(i)}}constructor(e){super(e),this.displayName="CytoscapeComponent",this.containerRef=Xt.createRef()}componentDidMount(){const e=this.containerRef.current,{global:n,headless:i,styleEnabled:a,hideEdgesOnViewport:s,textureOnViewport:o,motionBlur:l,motionBlurOpacity:u,wheelSensitivity:c,pixelRatio:d}=this.props,p=this._cy=new Vh({container:e,headless:i,styleEnabled:a,hideEdgesOnViewport:s,textureOnViewport:o,motionBlur:l,motionBlurOpacity:u,wheelSensitivity:c,pixelRatio:d});n&&(window[n]=p),this.updateCytoscape(null,this.props)}updateCytoscape(e,n){const i=this._cy,{diff:a,toJson:s,get:o,forEach:l}=n;dz(i,e,n,a,s,o,l),n.cy!=null&&n.cy(i)}componentDidUpdate(e){this.updateCytoscape(e,this.props)}componentWillUnmount(){this._cy.destroy()}render(){const{id:e,className:n,style:i}=this.props;return Xt.createElement("div",{ref:this.containerRef,id:e,className:n,style:i})}}const yz=[{selector:"node",style:{"background-color":"#1f2937",label:"data(label)",color:"#cbd5e1","font-family":"Outfit, sans-serif","font-size":"12px","text-valign":"bottom","text-margin-y":8,width:40,height:40,"border-width":2,"border-color":"#475569","text-outline-width":2,"text-outline-color":"#050508","overlay-padding":6,"z-index":10}},{selector:'node[category="Individual"]',style:{"background-color":"rgba(49, 46, 129, 0.9)","border-color":"#6366f1",shape:"ellipse",width:50,height:50}},{selector:'node[category="Location"]',style:{"background-color":"rgba(6, 78, 59, 0.9)","border-color":"#10b981",shape:"hexagon",width:60,height:60}},{selector:'node[category="Group"]',style:{"background-color":"rgba(88, 28, 135, 0.9)","border-color":"#a855f7",shape:"round-rectangle"}},{selector:"edge",style:{width:2,"line-color":"#334155","target-arrow-color":"#334155","target-arrow-shape":"triangle","curve-style":"bezier"}},{selector:":selected",style:{"border-width":4,"border-color":"#fafafa","line-color":"#fafafa","target-arrow-color":"#fafafa","z-index":999}}],xz=()=>{const{username:r,projectName:e}=Yi(),{setRightPanelMode:n,setRightOpen:i,setRightPanelTitle:a}=au(),s=Na(),[o,l]=ce.useState([]),[u,c]=ce.useState(""),[d,p]=ce.useState(!0),[v,y]=ce.useState(null),b=ce.useRef(null),[S,k]=ce.useState(null);ce.useEffect(()=>{n("CUSTOM"),a("Inspector"),T()},[]),ce.useEffect(()=>{const R=setInterval(()=>{const O=document.getElementById("architect-right-panel-portal");O&&(k(O),clearInterval(R))},100);return()=>clearInterval(R)},[]);const T=async()=>{p(!0);try{const R=await rt.get("/world-bible/graph");R&&R.nodes&&l([...R.nodes,...R.edges])}catch(R){console.error("Failed to load graph data",R),s("/")}finally{p(!1)}},C=()=>{if(!b.current)return;b.current.layout({name:"cose",animate:!0,padding:50,nodeOverlap:20,componentSpacing:100}).run()};ce.useEffect(()=>{b.current&&(C(),b.current.on("select","node",R=>{const O=R.target;y(O.data()),i(!0)}),b.current.on("unselect","node",()=>{y(null)}))},[o]);const N=()=>{if(!b.current||!u)return;const R=b.current;if(R.elements().removeClass("highlighted faded"),u.length>0){const O=R.nodes().filter(B=>B.data("label").toLowerCase().includes(u.toLowerCase()));O.length>0&&(R.elements().not(O).addClass("faded"),O.addClass("highlighted"),R.animate({fit:{eles:O,padding:50}}))}},P=()=>m.jsxs("div",{className:"p-6 flex flex-col h-full animate-in fade-in slide-in-from-right-4 duration-500 space-y-8",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"size-8 rounded bg-primary flex items-center justify-center",children:m.jsx("span",{className:"material-symbols-outlined text-primary-foreground text-sm",children:"hub"})}),m.jsx("h2",{className:"font-bold text-sm tracking-tight uppercase",children:"Network Controls"})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("input",{className:"bg-white/5 border border-white/10 rounded-xl px-4 py-2 text-xs w-full outline-none focus:ring-1 focus:ring-primary placeholder:text-slate-600 text-slate-200",placeholder:"Find cosmic entity...",value:u,onChange:R=>c(R.target.value),onKeyDown:R=>R.key==="Enter"&&N()}),m.jsx("button",{onClick:N,className:"px-4 bg-primary/20 hover:bg-primary/30 border border-primary/30 rounded-xl text-primary transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-base",children:"search"})})]}),m.jsxs("div",{className:"flex items-center justify-between pt-2",children:[m.jsxs("div",{className:"flex gap-2",children:[m.jsx("button",{onClick:C,className:"p-2.5 bg-white/5 hover:bg-white/10 rounded-xl text-slate-400 hover:text-white transition-colors border border-white/5",title:"Re-simulate Gravity",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"refresh"})}),m.jsx("button",{onClick:()=>b.current?.fit(),className:"p-2.5 bg-white/5 hover:bg-white/10 rounded-xl text-slate-400 hover:text-white transition-colors border border-white/5",title:"Fit View",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"fit_screen"})})]}),m.jsxs("div",{className:"flex flex-wrap gap-2 text-[8px] uppercase font-black text-slate-500",children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("div",{className:"size-1.5 rounded-full bg-indigo-500"})," IND"]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("div",{className:"size-1.5 rounded-full bg-emerald-500"})," LOC"]}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("div",{className:"size-1.5 rounded-full bg-purple-500"})," GRP"]})]})]})]}),m.jsx("div",{className:"h-px bg-white/5"}),v?m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:`size-12 rounded-2xl flex items-center justify-center text-white shadow-xl ${v.category==="Individual"?"bg-indigo-600 shadow-indigo-500/20":v.category==="Location"?"bg-emerald-600 shadow-emerald-500/20":"bg-purple-600 shadow-purple-500/20"}`,children:m.jsx("span",{className:"material-symbols-outlined",children:v.category==="Individual"?"person":v.category==="Location"?"location_on":"groups"})}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-serif font-bold text-white leading-tight",children:v.label}),m.jsx("span",{className:"text-[10px] font-black uppercase tracking-tighter text-slate-500",children:v.category})]})]}),m.jsx("p",{className:"text-sm text-slate-400 font-serif leading-relaxed italic opacity-80",children:v.summary||"No description available for this cosmic entity."}),m.jsxs("div",{className:"pt-6 border-t border-white/5 space-y-3",children:[m.jsxs("button",{onClick:()=>s(`/${r}/${e}/entities/${v.type||"individual"}/${v.id}`),className:"w-full py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-[10px] font-black uppercase tracking-widest text-slate-300 transition-all flex items-center justify-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"}),m.jsx("span",{children:"Open Bible Entry"})]}),m.jsxs("button",{onClick:()=>{if(!b.current)return;const R=b.current.$id(v.id);b.current.animate({center:{eles:R},zoom:2})},className:"w-full py-3 bg-indigo-600/10 hover:bg-indigo-600/20 border border-indigo-500/30 rounded-xl text-[10px] font-black uppercase tracking-widest text-indigo-300 transition-all flex items-center justify-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"center_focus_strong"}),m.jsx("span",{children:"Focus on Graph"})]})]})]}):m.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-500 text-center opacity-40 py-12",children:[m.jsx("span",{className:"material-symbols-outlined text-4xl mb-4",children:"touch_app"}),m.jsxs("p",{className:"text-[10px] font-black uppercase tracking-widest leading-loose",children:["Select a node",m.jsx("br",{}),"to reveal its secrets"]})]})]});return m.jsxs("div",{className:"w-full h-full flex bg-background-dark relative overflow-hidden font-display text-foreground",children:[S&&iu.createPortal(P(),S),o.length===0&&!d&&m.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10 pointer-events-none",children:m.jsx("div",{className:"text-muted text-lg font-serif italic text-slate-600",children:"The void is empty. Document your world in the Bible."})}),m.jsx(vz,{elements:o,stylesheet:yz,style:{width:"100%",height:"100%"},cy:R=>{b.current=R},minZoom:.2,maxZoom:3,wheelSensitivity:.3,className:"bg-background-dark"})]})},bz=({id:r})=>{const{id:e}=Yi(),n=Na(),[i,a]=ce.useState("overview"),[s,o]=ce.useState(null),[l,u]=ce.useState(!0),[c,d]=ce.useState(!1);ce.useEffect(()=>{p()},[r]);const p=async()=>{u(!0);try{const S=await rt.get(`/bd/entidadindividual/${r}`);o(S)}catch(S){console.error("Error loading character:",S)}finally{u(!1)}},v=async()=>{try{await rt.patch("/bd/modificar",{...s,tipoEntidad:"entidadindividual"}),d(!1)}catch(S){console.error("Error saving:",S)}},y=async()=>{if(window.confirm("Move this character to the Trash Bin?"))try{await rt.delete(`/bd/entidadindividual/${r}`),n(`/project/${e}`)}catch(S){console.error(S)}},b=(S,k)=>{o(T=>({...T,[S]:k}))};return l?m.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Summoning entity..."}):s?m.jsxs("div",{className:"flex h-full",children:[m.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto custom-scrollbar p-8 gap-6",children:[m.jsxs("div",{className:"flex items-start gap-6",children:[m.jsx("div",{className:"relative",children:m.jsx(ny,{url:s.imagenUrl||"https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1976&auto=format&fit=crop",size:"xl",className:"rounded-2xl border-2 border-primary shadow-[0_0_30px_rgba(99,102,242,0.3)]"})}),m.jsxs("div",{className:"flex-1",children:[m.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[m.jsx("span",{className:"text-xs font-bold text-primary bg-primary/10 px-2 py-0.5 rounded border border-primary/20",children:s.estado||"ACTIVE"}),m.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:s.tipo||"Unknown"})]}),m.jsxs("h1",{className:"text-4xl font-bold text-white mb-2",children:[s.nombre," ",s.apellidos]}),m.jsx("p",{className:"text-lg text-slate-300",children:s.origen||"Traveling the void"})]}),m.jsxs("div",{className:"flex gap-2",children:[!c&&m.jsx(nn,{className:"border-red-500/30 text-red-400 hover:bg-red-500/10",icon:"delete",onClick:y,children:"Delete"}),m.jsx(nn,{variant:"secondary",icon:c?"close":"edit",onClick:()=>d(!c),children:c?"Cancel":"Edit Profile"}),c&&m.jsx(nn,{variant:"primary",icon:"save",onClick:v,children:"Save Changes"})]})]}),m.jsx("div",{className:"border-b border-glass-border flex gap-6",children:["Overview","Biography","Attributes & Stats","Relationships"].map(S=>m.jsx("button",{onClick:()=>a(S.toLowerCase()),className:`pb-4 px-2 text-sm font-bold border-b-2 transition-colors ${i===S.toLowerCase()?"text-primary border-primary":"text-slate-500 border-transparent hover:text-white"}`,children:S},S))}),m.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[m.jsx("div",{className:"col-span-1 space-y-6",children:m.jsxs(Lr,{className:"p-4",children:[m.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"fingerprint"})," Identity"]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Name"}),m.jsx("input",{type:"text",value:s.nombre,onChange:S=>b("nombre",S.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!c})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Surnames"}),m.jsx("input",{type:"text",value:s.apellidos||"",onChange:S=>b("apellidos",S.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!c})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Type / Species"}),m.jsx("input",{type:"text",value:s.tipo||"",onChange:S=>b("tipo",S.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!c})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Origin"}),m.jsx("input",{type:"text",value:s.origen||"",onChange:S=>b("origen",S.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!c})]})]})]})}),m.jsx("div",{className:"col-span-2 space-y-6",children:m.jsxs(Lr,{className:"p-6 relative overflow-hidden group",children:[m.jsxs("div",{className:"flex items-center justify-between mb-6",children:[m.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"})," Narrative & Connections"]}),!c&&m.jsx("span",{className:"text-[10px] text-slate-600 bg-white/5 px-2 py-1 rounded",children:"Read Only"})]}),m.jsxs("div",{className:"mb-8",children:[m.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mb-3 opacity-80",children:"Biography"}),m.jsx("textarea",{value:s.descripcion||"",onChange:S=>b("descripcion",S.target.value),readOnly:!c,className:`w-full bg-transparent border-none outline-none text-slate-300 text-sm leading-relaxed resize-none custom-scrollbar ${c?"min-h-[150px] placeholder-white/20":"h-auto overflow-hidden"}`,placeholder:"Write the history of this person..."}),m.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mt-6 mb-3 opacity-80",children:"Behavior & Personality"}),m.jsx("textarea",{value:s.comportamiento||"",onChange:S=>b("comportamiento",S.target.value),readOnly:!c,className:`w-full bg-transparent border-none outline-none text-slate-300 text-sm leading-relaxed resize-none custom-scrollbar ${c?"min-h-[100px]":"h-auto overflow-hidden"}`,placeholder:"How does this person act?"})]}),m.jsxs("div",{className:"pt-6 border-t border-white/5",children:[m.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mb-4 flex items-center gap-2 opacity-80",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})," Established Connections"]}),s.relaciones&&s.relaciones.length>0?m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.relaciones.map((S,k)=>m.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5 hover:border-primary/30 transition-colors",children:[m.jsx("div",{className:"size-8 rounded-full bg-white/10 flex items-center justify-center text-xs font-bold",children:S.entidadDestino?.nombre?.charAt(0)||"?"}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"text-sm font-bold text-white truncate",children:S.entidadDestino?.nombre||"Unknown"}),m.jsx("div",{className:"text-[10px] text-primary truncate",children:S.tipoRelacion||"Connected"})]})]},k))}):m.jsx("div",{className:"p-6 text-center bg-white/5 rounded-xl border border-dashed border-white/10",children:m.jsx("p",{className:"text-xs text-slate-500 italic",children:"No relationships recorded yet."})})]})]})})]})]}),m.jsxs("div",{className:"w-80 border-l border-glass-border bg-surface-dark/50 hidden xl:flex flex-col",children:[m.jsxs("div",{className:"p-4 border-b border-glass-border flex justify-between items-center",children:[m.jsx("span",{className:"text-xs font-bold text-slate-500",children:"QUICK NOTES"}),m.jsx("button",{className:"text-slate-400 hover:text-white",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"})})]}),m.jsx("div",{className:"p-4 flex-1",children:m.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none text-sm text-slate-300 placeholder-slate-600 resize-none",placeholder:"Draft a quick scene or jot down notes for Elara here..."})}),m.jsx("div",{className:"p-2 border-t border-glass-border text-right text-[10px] text-slate-600",children:"0 words"})]})]}):m.jsx("div",{className:"p-20 text-center text-red-500",children:"Character not found in the archives."})},MN=({id:r})=>{const[e,n]=ce.useState(null),[i,a]=ce.useState(!0),[s,o]=ce.useState(!1);ce.useEffect(()=>{l()},[r]);const l=async()=>{a(!0);try{const d=await rt.get(`/bd/zona/${r}`);n(d)}catch(d){console.error("Error loading location:",d)}finally{a(!1)}},u=async()=>{try{await rt.patch("/bd/modificar",{...e,tipoEntidad:"zona"}),o(!1)}catch(d){console.error("Error saving:",d)}},c=(d,p)=>{n(v=>({...v,[d]:p}))};return i?m.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Scanning terrain..."}):e?m.jsxs("div",{className:"flex h-full overflow-y-auto custom-scrollbar p-8 flex-col gap-8",children:[m.jsxs("header",{className:"flex justify-between items-end",children:[m.jsxs("div",{children:[m.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[m.jsx("span",{className:"text-xs font-bold text-emerald-400 bg-emerald-400/10 px-2 py-0.5 rounded border border-emerald-400/20",children:"LOCATION"}),m.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:e.tipo||"Wilderness"})]}),m.jsx("h1",{className:"text-5xl font-manrope font-black text-white tracking-tight",children:e.nombre}),m.jsx("p",{className:"text-slate-400 mt-2",children:e.apellidos||"Uncharted territory"})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(nn,{variant:"secondary",icon:s?"close":"edit",onClick:()=>o(!s),children:s?"Cancel":"Edit Location"}),s&&m.jsx(nn,{variant:"primary",icon:"save",onClick:u,children:"Update Records"})]})]}),m.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[m.jsxs("div",{className:"col-span-1 space-y-6",children:[m.jsxs(Lr,{className:"p-6",children:[m.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"straighten"})," Geography & Scale"]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Size / Scale"}),m.jsx("input",{type:"text",value:e.tamanno||"",onChange:d=>c("tamanno",d.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!s})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Development Level"}),m.jsx("input",{type:"text",value:e.desarrollo||"",onChange:d=>c("desarrollo",d.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!s})]})]})]}),m.jsxs(Lr,{className:"p-6",children:[m.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4",children:"Quick Stats"}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[m.jsx("span",{className:"text-[10px] text-slate-500 block",children:"Density"}),m.jsx("span",{className:"text-white font-bold",children:"Medium"})]}),m.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[m.jsx("span",{className:"text-[10px] text-slate-500 block",children:"Security"}),m.jsx("span",{className:"text-emerald-400 font-bold",children:"Stable"})]})]})]})]}),m.jsx("div",{className:"col-span-2 space-y-6",children:m.jsxs(Lr,{className:"p-8",children:[m.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"description"})," Topographic Records & Lore"]}),m.jsx("textarea",{value:e.descripcion||"",onChange:d=>c("descripcion",d.target.value),readOnly:!s,className:"w-full bg-transparent border-none outline-none text-slate-300 text-lg leading-relaxed min-h-[400px] resize-none",placeholder:"Describe the vistas, the smells, and the secrets of this place..."})]})})]})]}):m.jsx("div",{className:"p-20 text-center text-red-500",children:"Location not found in the maps."})},wz=({id:r})=>{const[e,n]=ce.useState(null),[i,a]=ce.useState(!0),[s,o]=ce.useState(!1);ce.useEffect(()=>{l()},[r]);const l=async()=>{a(!0);try{const d=await rt.get(`/bd/entidadcolectiva/${r}`);n(d)}catch(d){console.error("Error loading collective:",d)}finally{a(!1)}},u=async()=>{try{await rt.patch("/bd/modificar",{...e,tipoEntidad:"entidadcolectiva"}),o(!1)}catch(d){console.error("Error saving:",d)}},c=(d,p)=>{n(v=>({...v,[d]:p}))};return i?m.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Gathering intelligence..."}):e?m.jsxs("div",{className:"flex h-full overflow-y-auto custom-scrollbar p-8 flex-col gap-8",children:[m.jsxs("header",{className:"flex justify-between items-end",children:[m.jsxs("div",{children:[m.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[m.jsx("span",{className:"text-xs font-bold text-indigo-400 bg-indigo-400/10 px-2 py-0.5 rounded border border-indigo-400/20",children:"COLLECTIVE"}),m.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:e.tipo||"Organization"})]}),m.jsx("h1",{className:"text-5xl font-manrope font-black text-white tracking-tight",children:e.nombre}),m.jsxs("p",{className:"text-slate-400 mt-2",children:[e.cantidadMiembros||"Unknown"," members"]})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(nn,{variant:"secondary",icon:s?"close":"edit",onClick:()=>o(!s),children:s?"Cancel":"Edit Collective"}),s&&m.jsx(nn,{variant:"primary",icon:"save",onClick:u,children:"Update Dossier"})]})]}),m.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[m.jsx("div",{className:"col-span-1 space-y-6",children:m.jsxs(Lr,{className:"p-6",children:[m.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"group_work"})," Group Dynamics"]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Scale / Members"}),m.jsx("input",{type:"text",value:e.cantidadMiembros||"",onChange:d=>c("cantidadMiembros",d.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!s})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Behavior / Alignment"}),m.jsx("input",{type:"text",value:e.comportamiento||"",onChange:d=>c("comportamiento",d.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!s})]})]})]})}),m.jsx("div",{className:"col-span-2 space-y-6",children:m.jsxs(Lr,{className:"p-8",children:[m.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"history_edu"})," Mandate & History"]}),m.jsx("textarea",{value:e.descripcion||"",onChange:d=>c("descripcion",d.target.value),readOnly:!s,className:"w-full bg-transparent border-none outline-none text-slate-300 text-lg leading-relaxed min-h-[400px] resize-none",placeholder:"Detail the motives, the structure, and the legacy of this group..."})]})})]})]}):m.jsx("div",{className:"p-20 text-center text-red-500",children:"Collective not found in the records."})},_z=()=>m.jsx("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300",children:m.jsxs("main",{className:"flex-1 flex flex-col p-12 overflow-y-auto custom-scrollbar relative",children:[m.jsxs("header",{className:"mb-12 space-y-4",children:[m.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold text-[10px] tracking-widest uppercase",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"grid_view"}),m.jsx("span",{children:"Universo Alpha"}),m.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),m.jsx("span",{children:"Galaxia Andrmeda"}),m.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),m.jsx("span",{className:"text-white",children:"Sistema Solar"})]}),m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{className:"space-y-4 max-w-3xl",children:[m.jsxs("div",{className:"flex items-center gap-3 px-3 py-1 rounded bg-orange-500/10 text-orange-400 border border-orange-500/20 inline-block",children:[m.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"sunny"}),m.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Sistema Planetario"}),m.jsx("span",{className:"text-[9px] font-bold text-slate-600 tracking-widest ml-2",children:"ID: SYS-SOL-001"})]}),m.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:"Sistema Solar"}),m.jsx("p",{className:"text-slate-400 text-lg leading-relaxed",children:"Sistema planetario principal ubicado en el Brazo de Orin, hogar de la nica vida biolgica compleja confirmada en el sector galctico Alpha-9."})]}),m.jsxs("div",{className:"flex gap-3",children:[m.jsx("button",{className:"p-3 rounded-2xl bg-white/5 hover:bg-red-500/10 text-slate-500 hover:text-red-400 border border-white/5 transition-all outline-none",children:m.jsx("span",{className:"material-symbols-outlined",children:"delete"})}),m.jsx(nn,{variant:"primary",icon:"save",children:"Guardar"})]})]})]}),m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[m.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[m.jsxs("section",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"sell"}),m.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Etiquetas"}),m.jsx("span",{className:"ml-auto text-[9px] font-bold text-slate-600 px-1.5 py-0.5 rounded bg-white/5",children:"3 ACTIVAS"})]}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.jsx(cw,{label:"Estrella Tipo G",color:"amber",icon:"star"}),m.jsx(cw,{label:"Vida Confirmada",color:"emerald",icon:"tempest"}),m.jsx(cw,{label:"Rico en Agua",color:"cyan",icon:"water_drop"}),m.jsx("button",{className:"size-8 rounded-full border border-dashed border-white/10 flex items-center justify-center text-slate-600 hover:text-white hover:border-white/30 transition-all",children:"+"})]})]}),m.jsxs("section",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"analytics"}),m.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Atributos Principales"}),m.jsx("button",{className:"ml-auto text-slate-600 hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"settings"})})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsx(b0,{label:"Forma / Estructura",value:"Heliosfrica Estndar",icon:"hive"}),m.jsx(b0,{label:"Composicin",value:"Hidrgeno (74%), Helio (24%)",icon:"experiment"}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsx(b0,{label:"Edad (Aos)",value:"4.6 MM",unit:"Aos"}),m.jsx(b0,{label:"Ciclo Orbital",value:"230 MM",unit:"Aos"})]})]})]}),m.jsxs("section",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"menu_book"}),m.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Notas de Lore"})]}),m.jsx("textarea",{className:"w-full h-48 bg-white/5 border border-white/5 rounded-[2rem] p-6 text-sm text-slate-400 placeholder:text-slate-700 focus:border-primary/50 outline-none transition-all resize-none leading-relaxed italic shadow-inner",defaultValue:"El sistema contiene un cinturn de asteroides inusualmente denso entre el 4 y 5 planeta. Se teoriza que es el remanente de una colisin planetaria antigua conocida como 'El Gran Impacto' en las escrituras sagradas de los habitantes de Terra."})]})]}),m.jsx("div",{className:"lg:col-span-2",children:m.jsxs(Lr,{className:"h-full border-white/5 bg-surface-dark/40 overflow-hidden flex flex-col shadow-2xl",children:[m.jsxs("header",{className:"p-8 border-b border-white/5 flex justify-between items-center",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:"size-10 rounded-xl bg-primary/20 text-primary flex items-center justify-center",children:m.jsx("span",{className:"material-symbols-outlined",children:"hub"})}),m.jsxs("div",{children:[m.jsx("h3",{className:"font-bold text-white text-lg tracking-tight",children:"Contenido Interno (Planetas)"}),m.jsx("p",{className:"text-[10px] font-medium text-slate-500 mt-0.5",children:"Arrastra para reordenar la jerarqua orbital"})]})]}),m.jsxs("div",{className:"px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[10px] font-black uppercase tracking-widest flex items-center gap-2",children:[m.jsx("div",{className:"size-1.5 rounded-full bg-emerald-500 animate-pulse"}),"8 Entidades"]})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-3",children:[m.jsx(pm,{name:"Mercurio",type:"Rocoso",stats:"430C | 88 Das",icon:"public"}),m.jsx(pm,{name:"Venus",type:"Atmsfera",stats:"462C | 225 Das",icon:"public"}),m.jsx(pm,{name:"Tierra",type:"Habitable",stats:"8B Hab | 1 Luna",icon:"public",active:!0}),m.jsx(pm,{name:"Marte",type:"Desierto",stats:"-60C | 2 Lunas",icon:"public"}),m.jsx(pm,{name:"Cinturn Asteroides",type:"Anillo",stats:">1M Obj",icon:"grain"})]}),m.jsx("div",{className:"p-8 bg-black/20 border-t border-white/5",children:m.jsxs("button",{className:"w-full py-4 rounded-[1.5rem] border-2 border-dashed border-white/10 text-slate-500 hover:text-white hover:border-primary/50 hover:bg-primary/5 transition-all flex items-center justify-center gap-3 font-black uppercase text-[10px] tracking-[0.2em]",children:[m.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Aadir Nueva Entidad"]})})]})})]})]})}),cw=({label:r,color:e,icon:n})=>m.jsxs("div",{className:`px-4 py-1.5 rounded-xl bg-${e}-500/10 text-${e}-400 border border-${e}-500/20 flex items-center gap-2 text-[10px] font-black uppercase tracking-widest shadow-lg`,children:[m.jsx("span",{className:"material-symbols-outlined text-[14px]",children:n}),r]}),b0=({label:r,value:e,unit:n,icon:i})=>m.jsxs("div",{className:"space-y-2",children:[m.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-slate-600 ml-1",children:r}),m.jsxs("div",{className:"w-full bg-white/5 border border-white/5 rounded-2xl px-5 py-3.5 flex items-center justify-between group hover:border-white/10 transition-all",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[i&&m.jsx("span",{className:"material-symbols-outlined text-slate-500 text-lg group-hover:text-primary transition-colors",children:i}),m.jsx("span",{className:"text-sm font-bold text-slate-300",children:e})]}),n&&m.jsx("span",{className:"text-[10px] font-black text-slate-600 uppercase tracking-widest",children:n})]})]}),pm=({name:r,type:e,stats:n,icon:i,active:a})=>m.jsxs("div",{className:`group flex items-center gap-6 p-4 rounded-2xl transition-all cursor-pointer ${a?"bg-primary/10 border border-primary/20 shadow-xl":"hover:bg-white/5 border border-transparent"}`,children:[m.jsx("span",{className:"material-symbols-outlined text-slate-700 group-hover:text-slate-500",children:"drag_indicator"}),m.jsx("div",{className:`size-12 rounded-xl flex items-center justify-center ${a?"bg-primary text-white shadow-lg shadow-primary/30":"bg-surface-dark border border-white/5 text-slate-500"}`,children:m.jsx("span",{className:"material-symbols-outlined text-3xl",children:i})}),m.jsx("div",{className:"flex-1",children:m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("h4",{className:"text-sm font-bold text-white group-hover:text-primary transition-colors",children:r}),m.jsx("span",{className:`text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-widest ${a?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-white/5 text-slate-600"}`,children:e})]})}),m.jsx("div",{className:"flex flex-col items-end gap-1",children:m.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[m.jsx("span",{className:"material-symbols-outlined text-[12px]",children:"analytics"}),m.jsx("span",{className:"text-[10px] font-mono tracking-tight group-hover:text-slate-300",children:n})]})}),m.jsxs("div",{className:"flex gap-2 ml-4",children:[m.jsx("button",{className:"p-2 rounded-lg text-slate-700 hover:text-white hover:bg-white/5 transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit_note"})}),a?m.jsx("button",{className:"size-8 rounded-full bg-primary text-white flex items-center justify-center shadow-lg",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"arrow_forward"})}):m.jsx("button",{className:"p-2 rounded-lg text-slate-700 hover:text-white hover:bg-white/5 transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-xl",children:"open_in_new"})})]})]}),Sz=()=>m.jsx("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300",children:m.jsxs("main",{className:"flex-1 flex flex-col p-12 overflow-y-auto custom-scrollbar relative",children:[m.jsxs("header",{className:"mb-12 space-y-4",children:[m.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold text-[10px] tracking-widest uppercase",children:[m.jsx("span",{children:"Sistema Solar"}),m.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),m.jsx("span",{children:"Kepler-186f"}),m.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),m.jsx("span",{className:"text-white",children:"Territorios"})]}),m.jsxs("div",{className:"flex justify-between items-end",children:[m.jsxs("div",{children:[m.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[m.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:"Kepler-186f"}),m.jsx("span",{className:"material-symbols-outlined text-4xl text-primary",children:"public"})]}),m.jsx("p",{className:"text-slate-400 text-lg max-w-2xl leading-relaxed",children:"Gestin geopoltica y geogrfica de la superficie planetaria. Administra biomas, asentamientos y recursos estratgicos."})]}),m.jsxs("div",{className:"flex gap-3",children:[m.jsx(nn,{variant:"secondary",icon:"map",children:"Ver Atlas"}),m.jsx(nn,{variant:"primary",icon:"add",children:"Nuevo Territorio"})]})]})]}),m.jsxs("section",{className:"space-y-8",children:[m.jsxs(Lr,{className:"p-2 flex items-center justify-between border-white/5",children:[m.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[m.jsxs("div",{className:"relative flex-1 max-w-sm",children:[m.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm",children:"search"}),m.jsx("input",{type:"text",placeholder:"Buscar por nombre...",className:"w-full bg-transparent border-none rounded-xl py-2 pl-9 pr-4 text-xs focus:ring-1 focus:ring-primary/30 outline-none transition-all"})]}),m.jsx("div",{className:"w-px h-6 bg-white/5 mx-2"}),m.jsx(dw,{label:"Bioma: Todos"}),m.jsx(dw,{label:"Poblacin"}),m.jsx(dw,{label:"Estado"})]}),m.jsxs("div",{className:"flex items-center gap-1 p-1 bg-white/5 rounded-lg",children:[m.jsx("button",{className:"p-1.5 rounded-md text-slate-500 hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"format_list_bulleted"})}),m.jsx("button",{className:"p-1.5 rounded-md bg-white/10 text-white shadow-sm",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_view"})})]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[m.jsx(hw,{title:"Nueva Neo-Tokyo",desc:"Metrpolis vertical construida sobre las...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuAYF5Q6W3o1w1f1",badges:["Capital"],stats:["15M","Templado","Costero"],color:"cyan"}),m.jsx(hw,{title:"Mar de Dunas",desc:"Extensin rida rica en especia slica...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuBYG6R7X4p2x2g2",stats:["Hostil","rido"],color:"amber"}),m.jsx(hw,{title:"Sanctum Bio-Domo",desc:"Instalacin de investigacin...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuCZ H7S8Y5q3z3h3",badges:["Ciencia"],stats:["5K","Jungla"],color:"purple"}),m.jsxs("div",{className:"group border-2 border-dashed border-white/5 rounded-[2.5rem] flex flex-col items-center justify-center p-12 gap-4 hover:border-primary/30 hover:bg-primary/5 transition-all cursor-pointer",children:[m.jsx("div",{className:"size-16 rounded-3xl bg-white/5 flex items-center justify-center group-hover:scale-110 transition-transform",children:m.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-600 group-hover:text-primary",children:"add_location_alt"})}),m.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-slate-600 group-hover:text-white",children:"Aadir Territorio"})]})]})]})]})}),dw=({label:r})=>m.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl hover:bg-white/5 transition-all group",children:[m.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-white",children:r}),m.jsx("span",{className:"material-symbols-outlined text-slate-600 text-[14px]",children:"expand_more"})]}),hw=({title:r,desc:e,image:n,badges:i=[],stats:a=[],color:s})=>m.jsxs("div",{className:"group relative rounded-[2.5rem] overflow-hidden border border-white/5 bg-surface-dark/50 hover:border-white/10 transition-all shadow-2xl",children:[m.jsxs("div",{className:"h-48 overflow-hidden relative",children:[m.jsx("img",{src:n,alt:r,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-60 group-hover:opacity-100"}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-surface-dark via-transparent to-transparent"}),m.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:i.map(o=>m.jsxs("span",{className:`px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest bg-${s==="cyan"?"primary":s==="amber"?"amber-500":"purple-500"}/20 text-${s==="cyan"?"primary":s==="amber"?"amber-400":"purple-400"} border border-white/10 backdrop-blur-md flex items-center gap-1.5`,children:[m.jsx("span",{className:"material-symbols-outlined text-[12px]",children:o==="Capital"?"star":"science"}),o]},o))})]}),m.jsxs("div",{className:"p-8 space-y-6",children:[m.jsxs("header",{className:"flex justify-between items-start",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-2xl font-manrope font-black text-white mb-2 group-hover:text-primary transition-colors",children:r}),m.jsx("p",{className:"text-xs text-slate-500 leading-relaxed line-clamp-2",children:e})]}),m.jsx("button",{className:"p-2 text-slate-700 hover:text-white",children:m.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})]}),m.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(o=>m.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-white/5 border border-white/5 text-[9px] font-black text-slate-400 uppercase tracking-widest",children:[m.jsx("div",{className:`size-1.5 rounded-full bg-${s==="cyan"?"primary":s==="amber"?"amber-500":"purple-500"}/50`}),o]},o))}),m.jsxs("div",{className:"flex gap-3 pt-2",children:[m.jsxs("button",{className:"flex-1 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[m.jsx("span",{className:"material-symbols-outlined text-sm opacity-50",children:"edit"})," Editar"]}),m.jsxs("button",{className:"flex-1 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[m.jsx("span",{className:"material-symbols-outlined text-sm opacity-50",children:"map"})," Ubicacin"]})]})]})]}),kz=()=>{const{type:r,entityId:e}=Yi(),n=()=>{const i=r?.toLowerCase();switch(i){case"character":case"entidadindividual":return m.jsx(bz,{id:e});case"location":case"zona":return m.jsx(MN,{id:e});case"culture":case"entidadcolectiva":return m.jsx(wz,{id:e});case"universe":case"galaxy":case"system":return m.jsx(_z,{id:e,type:i});case"planet":return m.jsx(Sz,{id:e});case"construccion":return m.jsx(MN,{id:e});case"efectos":return m.jsxs("div",{className:"p-8 text-white",children:["Effect/Spell View for ID: ",e]});case"interaccion":return m.jsxs("div",{className:"p-8 text-white",children:["Interaction/Event View for ID: ",e]});case"magic":return m.jsxs("div",{className:"p-8 text-white",children:["Magic System View for ID: ",id]});default:return m.jsxs("div",{className:"p-8 text-white",children:["Unknown Entity Type: ",r]})}};return m.jsx("div",{className:"flex-1 bg-background-dark overflow-hidden",children:n()})},Cz=()=>{const{t:r}=Xu(),{setRightPanelMode:e,setRightOpen:n,setRightPanelTitle:i}=au(),[a,s]=ce.useState([]),[o,l]=ce.useState(null),[u,c]=ce.useState([]),[d,p]=ce.useState(!0),[v,y]=ce.useState(!1),[b,S]=ce.useState(!1),[k,T]=ce.useState({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0}),[C,N]=ce.useState({nombre:"",descripcion:""}),[P,R]=ce.useState(null),[O,B]=ce.useState(null),[I,z]=ce.useState("eventos"),[V,$]=ce.useState([]),[Y,D]=ce.useState([]),[q,G]=ce.useState(null),Z=Xt.useRef(!1),Q=async Ne=>{try{return(await rt.get("/bd/relacion")).filter(yt=>yt.tipoOrigen==="lineatiempo"&&yt.idOrigen===Ne||yt.tipoDestino==="lineatiempo"&&yt.idDestino===Ne).map(yt=>yt.idOrigen===Ne?yt.idDestino:yt.idOrigen)}catch(ze){return console.error(ze),[]}},J=async(Ne,ze)=>{const Ke=await Q(Ne),ft=ze.filter(Et=>Ke.includes(Et.id));$(ft);const yt=ze.filter(Et=>Et.id!==Ne&&!Ke.includes(Et.id));D(yt)},ie=async Ne=>{if(!(!o||!Ne))try{await rt.put("/bd/insertar",{tipoEntidad:"relacion",tipoOrigen:"lineatiempo",idOrigen:o,tipoDestino:"lineatiempo",idDestino:Ne,descripcion:"Anexo de lnea de tiempo"}),J(o,a)}catch(ze){console.error(ze)}},ne=async Ne=>{const Ke=(await rt.get("/bd/relacion")).find(ft=>ft.tipoOrigen==="lineatiempo"&&ft.idOrigen===o&&ft.idDestino===Ne||ft.tipoDestino==="lineatiempo"&&ft.idDestino===o&&ft.idOrigen===Ne);Ke&&(await rt.delete(`/bd/relacion/${Ke.id}`),J(o,a))};ce.useEffect(()=>{e("CUSTOM"),i(r("timeline.title"));const Ne=setInterval(()=>{const ze=document.getElementById("architect-right-panel-portal");ze&&(G(ze),clearInterval(Ne))},50);return()=>{clearInterval(Ne),e("NOTES"),i("")}},[]);const[W,re]=ce.useState([]),[ae,he]=ce.useState(null);ce.useEffect(()=>{Z.current||(Z.current=!0,xe())},[]);const ve=Ne=>{i(m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{children:r("timeline.title").toUpperCase()}),Ne&&m.jsx("span",{className:"text-[10px] text-slate-400 font-medium normal-case tracking-normal mt-0.5",children:Ne})]}))};ce.useEffect(()=>{if(I==="eventos"||I==="anexos")if(o){const ze=W.flatMap(Ke=>Ke.lineasTemporales||[]).find(Ke=>Ke.id===o);ve(ze?.nombre)}else ve(null);else I==="universo"&&i(r("timeline.multiverse"))},[o,I,W]);const xe=async()=>{try{const Ne=await rt.get("/multiverso/list");if(re(Ne),!o&&Ne.length>0){const ze=Ne[0];ze.lineasTemporales&&ze.lineasTemporales.length>0&&l(ze.lineasTemporales[0].id)}}catch(Ne){console.error("Failed to load multiverse",Ne)}},se=async Ne=>{try{const ze=await rt.get(`/timeline/linea/${Ne}/eventos`);ze.sort((Ke,ft)=>(Ke.ordenAbsoluto||0)-(ft.ordenAbsoluto||0)),c(ze)}catch(ze){console.error("Failed to load events",ze)}},ge=async()=>{if(!o||!k.nombre)return;const Ne={...k,ordenAbsoluto:parseInt(k.ordenAbsoluto)||0};try{P?await rt.put(`/timeline/evento/${P.id}`,{...Ne,lineaTiempo:{id:o}}):await rt.post("/timeline/evento",{...Ne,lineaTiempo:{id:o}}),T({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0}),R(null),se(o)}catch(ze){console.error(ze)}},le=Ne=>{R(Ne),T({nombre:Ne.nombre,descripcion:Ne.descripcion,fechaTexto:Ne.fechaTexto,ordenAbsoluto:Ne.ordenAbsoluto||0}),z("eventos"),n(!0)},pe=async()=>{if(!(!C.nombre||!C.universoId))try{const Ne=await rt.post("/timeline/linea",{...C,esRaiz:!1,universo:{id:C.universoId}});S(!1),N({nombre:"",descripcion:"",universoId:null}),await xe(),l(Ne.id)}catch(Ne){console.error("Error creating timeline:",Ne)}},[me,be]=ce.useState({nombre:"",descripcion:""}),Se=async()=>{if(me.nombre)try{const Ne=await rt.post("/multiverso/crear",me);be({nombre:"",descripcion:""}),n(!1),await xe()}catch(Ne){console.error("Error creating universe",Ne)}},Ue=async()=>{if(ae)try{await rt.put(`/multiverso/${ae}`,{nombre:me.nombre,descripcion:me.descripcion}),n(!1),await xe()}catch(Ne){console.error("Error updating universe",Ne)}},We=async()=>{if(ae&&window.confirm(r("timeline.delete_universe_confirm")))try{await rt.delete(`/multiverso/${ae}`),n(!1),he(null),await xe()}catch(Ne){console.error("Error deleting universe",Ne)}};ce.useEffect(()=>{if(I==="universe-create")be({nombre:"",descripcion:""});else if(I==="universe-edit"&&ae){const Ne=W.find(ze=>ze.id===ae);Ne&&be({nombre:Ne.nombre,descripcion:Ne.descripcion||""})}},[I,ae,W]);const[gt,Je]=ce.useState({open:!1,type:null,id:null,title:"",message:""}),at=(Ne,ze)=>{ze.stopPropagation(),Je({open:!0,type:"TIMELINE",id:Ne,title:r("timeline.delete_line"),message:r("bible.delete_folder_msg")})},Ve=(Ne,ze)=>{ze.stopPropagation(),Je({open:!0,type:"EVENT",id:Ne,title:r("timeline.delete_event"),message:r("common.are_you_sure")})},Oe=async()=>{const{type:Ne,id:ze}=gt;if(!(!Ne||!ze))try{if(Ne==="TIMELINE"){if(await rt.delete(`/timeline/linea/${ze}`),o===ze){const ft=W.flatMap(yt=>yt.lineasTemporales||[]).filter(yt=>yt.id!==ze);l(ft.length>0?ft[0].id:null)}await xe()}else Ne==="EVENT"&&(await rt.delete(`/timeline/evento/${ze}`),se(o),P&&P.id===ze&&R(null))}catch(Ke){console.error(Ke),alert(r("common.error_delete"))}},et=m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"p-4 border-b border-white/5",children:m.jsxs("div",{className:"flex bg-black/40 rounded-lg p-1 overflow-x-auto gap-1",children:[m.jsx("button",{onClick:()=>z("eventos"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${I==="eventos"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:r("timeline.events_tab")}),m.jsx("button",{onClick:()=>z("anexos"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${I==="anexos"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:r("timeline.annexes_tab")}),m.jsx("button",{onClick:()=>z("universo"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${I==="universo"?"bg-amber-600 text-white shadow-lg":"text-slate-500 hover:text-amber-500/80"}`,children:r("timeline.multiverse")})]})}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[I==="eventos"&&m.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:m.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[m.jsxs("h3",{className:"text-xs font-black uppercase text-primary mb-4 flex items-center justify-between",children:[r(P?"timeline.edit_event":"timeline.add_event"),P&&m.jsx("button",{onClick:()=>{R(null),T({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:u.length+1})},className:"text-[10px] text-slate-500 hover:text-white underline",children:r("common.cancel").toUpperCase()})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:r("timeline.event_name")}),m.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:k.nombre,onChange:Ne=>T({...k,nombre:Ne.target.value}),placeholder:r("timeline.event_name")})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:r("timeline.date_label")}),m.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:k.fechaTexto,onChange:Ne=>T({...k,fechaTexto:Ne.target.value}),placeholder:"e.g. Year 500"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:r("timeline.order")}),m.jsx("input",{type:"text",className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:k.ordenAbsoluto,onChange:Ne=>{const ze=Ne.target.value;/^[-+]?\d*$/.test(ze)&&T({...k,ordenAbsoluto:ze})},placeholder:"+/- Num"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:r("timeline.description")}),m.jsx("textarea",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary h-24 resize-none",value:k.descripcion,onChange:Ne=>T({...k,descripcion:Ne.target.value}),placeholder:r("timeline.description")})]}),m.jsx("div",{className:"pt-2",children:m.jsx(nn,{variant:"primary",onClick:ge,className:"w-full justify-center",children:r(P?"timeline.save_changes":"timeline.create_event")})}),P&&m.jsx("button",{onClick:Ne=>Ve(P.id,Ne),className:"w-full text-center text-xs text-red-500 hover:text-red-400 py-2 border border-red-500/20 rounded-lg hover:bg-red-500/10 transition-colors",children:r("timeline.delete_event_btn")})]})]})}),I==="anexos"&&m.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:m.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[m.jsx("h3",{className:"text-xs font-black uppercase text-primary mb-4",children:r("timeline.linked_timelines")}),m.jsx("p",{className:"text-xs text-slate-500 mb-4",children:r("timeline.annexed_desc")}),m.jsxs("div",{className:"space-y-2 mb-6",children:[V.map(Ne=>m.jsxs("div",{className:"flex items-center justify-between p-2 bg-white/5 rounded-lg border border-white/5",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-xs text-slate-400",children:"timeline"}),m.jsx("span",{className:"text-xs font-bold text-slate-300",children:Ne.nombre})]}),m.jsx("button",{onClick:()=>ne(Ne.id),className:"text-slate-500 hover:text-red-500",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"link_off"})})]},Ne.id)),V.length===0&&m.jsx("span",{className:"text-xs text-slate-600 italic",children:r("timeline.no_linked")})]}),m.jsx("h4",{className:"text-[10px] font-bold uppercase text-slate-400 mb-2",children:r("timeline.available_to_link")}),m.jsxs("div",{className:"space-y-1",children:[Y.map(Ne=>m.jsxs("button",{onClick:()=>ie(Ne.id),className:"w-full flex items-center gap-2 p-2 hover:bg-white/5 rounded-lg text-left transition-colors group",children:[m.jsx("span",{className:"material-symbols-outlined text-xs text-green-500/50 group-hover:text-green-500",children:"add_link"}),m.jsx("span",{className:"text-xs text-slate-400 group-hover:text-white",children:Ne.nombre})]},Ne.id)),Y.length===0&&m.jsx("span",{className:"text-xs text-slate-600 italic",children:r("timeline.no_available")})]})]})}),I==="universo"&&m.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:m.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[m.jsx("h3",{className:"text-xs font-black uppercase text-amber-500 mb-4",children:r(ae?"timeline.universe_settings":"timeline.new_universe")}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:r("timeline.universe_name")}),m.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:me.nombre,onChange:Ne=>be({...me,nombre:Ne.target.value}),placeholder:"e.g. Alternate Reality 1"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Description"}),m.jsx("textarea",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary h-24 resize-none",value:me.descripcion,onChange:Ne=>be({...me,descripcion:Ne.target.value}),placeholder:r("timeline.universe_desc")})]}),m.jsx("div",{className:"pt-2",children:m.jsx(nn,{variant:"primary",onClick:ae?Ue:Se,className:"w-full justify-center",children:r(ae?"common.save":"common.create")})}),ae&&m.jsx("button",{onClick:We,className:"w-full text-center text-xs text-red-500 hover:text-red-400 py-2 border border-red-500/20 rounded-lg hover:bg-red-500/10 transition-colors",children:r("common.delete")})]})]})})]})]});return m.jsxs("div",{className:"flex h-screen bg-background-dark text-white overflow-hidden",children:[q&&iu.createPortal(et,q),m.jsxs("aside",{className:"w-64 bg-surface-dark border-r border-white/5 flex flex-col p-4 z-20 shrink-0",children:[m.jsxs("header",{className:"flex justify-between items-center mb-6",children:[m.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-primary",children:r("timeline.multiverse")}),m.jsx("button",{onClick:()=>{e("CUSTOM"),z("universo"),he(null),be({nombre:"",descripcion:""}),n(!0)},className:"text-slate-400 hover:text-white",title:"New Universe",children:m.jsx("span",{className:"material-symbols-outlined",children:"add_circle"})})]}),m.jsx("div",{className:"space-y-6 overflow-y-auto flex-1 custom-scrollbar",children:W.map(Ne=>m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex items-center justify-between group",children:[m.jsx("h3",{className:`text-[10px] font-bold uppercase pl-2 cursor-pointer ${ae===Ne.id?"text-white":"text-slate-500"}`,onClick:()=>{he(Ne.id),be({nombre:Ne.nombre,descripcion:Ne.descripcion||""}),z("universo"),e("CUSTOM"),n(!0)},children:Ne.nombre}),m.jsx("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:m.jsx("button",{onClick:()=>{N({...C,universoId:Ne.id}),S(!0)},className:"text-slate-500 hover:text-primary",title:"Add Timeline here",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})})]}),b&&C.universoId===Ne.id&&m.jsxs("div",{className:"ml-2 mb-2 p-2 bg-black/20 rounded-lg animate-in fade-in",children:[m.jsx("input",{className:"w-full bg-transparent border-b border-white/20 text-xs p-1 outline-none focus:border-primary mb-1",placeholder:"Timeline Name",value:C.nombre,onChange:ze=>N({...C,nombre:ze.target.value}),autoFocus:!0,onKeyDown:ze=>ze.key==="Enter"&&pe()}),m.jsxs("div",{className:"flex justify-end gap-1",children:[m.jsx("button",{onClick:()=>S(!1),className:"text-[10px] text-slate-500 hover:text-white",children:r("common.cancel").toUpperCase()}),m.jsx("button",{onClick:pe,className:"text-[10px] font-bold text-primary",children:r("common.create").toUpperCase()})]})]}),m.jsxs("div",{className:"space-y-1 pl-2 border-l border-white/5 ml-1",children:[Ne.lineasTemporales&&Ne.lineasTemporales.map(ze=>m.jsxs("div",{onClick:()=>{l(ze.id),z("eventos"),e("CUSTOM"),n(!0)},className:`group flex items-center justify-between p-2 rounded-lg cursor-pointer transition-all ${o===ze.id?"bg-primary/10 text-white shadow-[0_0_10px_rgba(var(--primary-rgb),0.1)]":"text-slate-400 hover:bg-white/5"}`,children:[m.jsx("span",{className:"text-xs truncate",children:ze.nombre}),m.jsx("button",{onClick:Ke=>at(ze.id,Ke),className:"opacity-0 group-hover:opacity-100 text-slate-500 hover:text-red-500 transition-opacity",children:m.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"delete"})})]},ze.id)),(!Ne.lineasTemporales||Ne.lineasTemporales.length===0)&&m.jsx("div",{className:"p-2 text-[10px] italic text-slate-600",children:r("timeline.no_timelines")})]})]},Ne.id))})]}),m.jsxs("main",{className:"flex-1 relative flex flex-col h-full overflow-hidden bg-background-dark",children:[m.jsx("div",{className:"h-16 border-b border-white/5 bg-background-dark/80 backdrop-blur flex items-center px-8 z-10 shrink-0",children:m.jsx("div",{children:(()=>{const ze=W.flatMap(Ke=>Ke.lineasTemporales||[]).find(Ke=>Ke.id===o);return m.jsxs(m.Fragment,{children:[m.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[ze?.esRaiz&&m.jsx("span",{className:"text-amber-400 material-symbols-outlined",children:"star"}),ze?.nombre||r("timeline.select_timeline")]}),m.jsx("p",{className:"text-xs text-slate-500",children:ze?.descripcion})]})})()})}),m.jsx("div",{className:"flex-1 overflow-y-auto p-8 relative custom-scrollbar z-10",children:m.jsxs("div",{className:"max-w-2xl mx-auto relative pl-8 border-l-2 border-white/10 space-y-8 pb-32",children:[u.length===0&&m.jsx("div",{className:"text-center text-slate-600 italic py-20",children:r("timeline.no_events")}),u.map((Ne,ze)=>m.jsxs("div",{className:"relative group animate-in fade-in slide-in-from-bottom-4",style:{animationDelay:`${ze*50}ms`},children:[m.jsx("div",{className:"absolute top-6 -left-[41px] size-4 rounded-full bg-white/20 border-4 border-background-dark group-hover:bg-primary transition-colors cursor-pointer",onClick:()=>le(Ne)}),m.jsxs("div",{className:"ml-4 bg-surface-dark/50 border border-white/5 p-5 rounded-2xl hover:border-primary/30 transition-all hover:bg-surface-dark group-hover:translate-x-1 duration-300 relative group/card",children:[m.jsxs("div",{className:"absolute top-3 right-3 opacity-0 group-hover/card:opacity-100 transition-opacity flex gap-1 bg-black/50 rounded-lg backdrop-blur-sm border border-white/5 p-1",children:[m.jsx("button",{onClick:()=>le(Ne),className:"p-1.5 text-slate-400 hover:text-white hover:bg-white/10 rounded transition-colors",title:"Edit",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),m.jsx("button",{onClick:Ke=>Ve(Ne.id,Ke),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-500/10 rounded transition-colors",title:"Delete",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),m.jsx("div",{className:"flex justify-between items-start",children:m.jsxs("div",{children:[m.jsxs("div",{className:"flex flex-col mb-1",children:[m.jsx("h3",{className:"text-lg font-bold text-white",children:Ne.nombre}),m.jsx("span",{className:"text-xs font-mono font-bold text-primary opacity-80",children:Ne.fechaTexto})]}),m.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:Ne.descripcion})]})})]})]},Ne.id))]})})]}),m.jsx(av,{isOpen:gt.open,onClose:()=>Je({...gt,open:!1}),onConfirm:Oe,title:gt.title,message:gt.message,confirmText:r("common.delete"),type:"danger"})]})},Ez=({onCancel:r,onCreate:e})=>{const[n,i]=ce.useState(1),[a,s]=ce.useState("regional"),[o,l]=ce.useState("upload"),[u,c]=ce.useState(null),[d,p]=ce.useState(""),v=Xt.useRef(null),y=k=>{const T=k.target.files?.[0];T&&T.type.startsWith("image/")&&(c(T),l("upload"))},b=()=>{v.current?.click()},S=()=>{e(o,d||"Nuevo Mapa",u)};return m.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-xl animate-in fade-in duration-300",children:m.jsx("div",{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto no-scrollbar relative animate-in zoom-in-95 duration-500",children:m.jsxs(Lr,{className:"p-0 border-white/10 shadow-[0_0_100px_rgba(0,0,0,0.5)] overflow-hidden",children:[m.jsxs("header",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:"size-12 rounded-2xl bg-primary/20 text-primary flex items-center justify-center",children:m.jsx("span",{className:"material-symbols-outlined text-2xl",children:"add_location_alt"})}),m.jsxs("div",{children:[m.jsx("h1",{className:"text-2xl font-manrope font-black text-white tracking-tight",children:"Crear Nuevo Mapa / Zona"}),m.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Configura los detalles para tu nueva entrada cartogrfica."})]})]}),m.jsx("button",{onClick:r,className:"text-slate-500 hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),m.jsxs("div",{className:"p-12 space-y-12",children:[m.jsxs("section",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${n===1?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"1"}),m.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Identidad y Jerarqua"})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pl-12",children:[m.jsxs("div",{className:"space-y-1.5",children:[m.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Nombre del Mapa"}),m.jsx("input",{type:"text",placeholder:"ej. La Costa de Zafiro",value:d,onChange:k=>p(k.target.value),className:"w-full bg-white/5 border border-white/5 rounded-2xl px-4 py-3 text-sm text-white focus:border-primary/50 transition-all outline-none"})]}),m.jsxs("div",{className:"space-y-1.5 row-span-2",children:[m.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Descripcin"}),m.jsx("textarea",{placeholder:"Breve descripcin de la geografa, clima o importancia...",className:"w-full h-[120px] bg-white/5 border border-white/5 rounded-2xl p-4 text-sm text-white focus:border-primary/50 outline-none transition-all resize-none"})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Zona Padre (Opcional)"}),m.jsxs("select",{className:"w-full bg-white/5 border border-white/5 rounded-2xl px-4 py-3 text-sm text-white focus:border-primary/50 outline-none appearance-none",children:[m.jsx("option",{children:"Ninguna (Nivel Superior)"}),m.jsx("option",{children:"Reino de Aethelgard"}),m.jsx("option",{children:"Continente de Aurum"})]}),m.jsx("p",{className:"text-[9px] text-slate-500 italic mt-1 ml-1 text-primary/70",children:"Seleccionar un padre convierte esto en sub-zona."})]})]})]}),m.jsx("div",{className:"h-px w-full bg-white/5"}),m.jsxs("section",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${n===2?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"2"}),m.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Tipo de Mapa"})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 pl-12",children:[m.jsx(fw,{active:a==="world",onClick:()=>s("world"),icon:"public",label:"Mapa Mundial",desc:"Continentes, ocanos, escala global."}),m.jsx(fw,{active:a==="regional",onClick:()=>s("regional"),icon:"map",label:"Mapa Regional",desc:"Reinos, provincias, biomas."}),m.jsx(fw,{active:a==="local",onClick:()=>s("local"),icon:"location_city",label:"Ciudad / Local",desc:"Ciudades, mazmorras, mapas de batalla."})]})]}),m.jsx("div",{className:"h-px w-full bg-white/5"}),m.jsxs("section",{className:"space-y-6",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${n===3?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"3"}),m.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Fuente del Lienzo"})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pl-12",children:[m.jsx("input",{ref:v,type:"file",accept:"image/*",onChange:y,className:"hidden"}),m.jsx(AN,{active:o==="upload",onClick:b,icon:"cloud_upload",label:u?u.name:"Cargar Archivo de Imagen",desc:u?"Archivo seleccionado":"Arrastra y suelta o haz clic para buscar",subdesc:"JPG, PNG, WEBP  MAX 25MB"}),m.jsx(AN,{active:o==="blank",onClick:()=>l("blank"),icon:"brush",label:"Lienzo en Blanco",desc:"Crear un nuevo dibujo desde cero",subdesc:"4096 px x 4096 px"})]})]})]}),m.jsxs("footer",{className:"p-8 bg-white/[0.02] border-t border-white/5 flex justify-between items-center",children:[m.jsx("button",{onClick:r,className:"text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"Cancelar"}),m.jsxs("div",{className:"flex items-center gap-6",children:[m.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-600",children:"Cambios guardados localmente"}),m.jsx(nn,{variant:"primary",className:"px-10 py-3 shadow-xl",onClick:S,children:"Crear Mapa"})]})]})]})})})},fw=({active:r,onClick:e,icon:n,label:i,desc:a})=>m.jsxs("div",{onClick:e,className:`p-6 rounded-3xl border transition-all cursor-pointer group ${r?"bg-primary/10 border-primary shadow-lg shadow-primary/10":"bg-white/5 border-white/5 hover:border-white/10"}`,children:[m.jsx("div",{className:`size-10 rounded-xl mb-4 flex items-center justify-center transition-all ${r?"bg-primary text-white":"bg-white/5 text-slate-500 group-hover:text-slate-300"}`,children:m.jsx("span",{className:"material-symbols-outlined",children:n})}),m.jsx("h3",{className:`text-sm font-bold mb-1 transition-colors ${r?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:i}),m.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-medium",children:a})]}),AN=({active:r,onClick:e,icon:n,label:i,desc:a,subdesc:s})=>m.jsxs("div",{onClick:e,className:`p-10 rounded-[2.5rem] border transition-all cursor-pointer group flex flex-col items-center text-center gap-4 ${r?"bg-primary/5 border-primary shadow-lg":"bg-white/[0.02] border-white/5 hover:border-white/10 hover:bg-white/[0.04]"}`,children:[m.jsx("div",{className:`size-16 rounded-[2rem] flex items-center justify-center transition-all ${r?"bg-primary text-white shadow-xl shadow-primary/20":"bg-white/5 text-slate-600 group-hover:text-slate-400"}`,children:m.jsx("span",{className:"material-symbols-outlined text-3xl",children:n})}),m.jsxs("div",{className:"space-y-1",children:[m.jsx("h3",{className:`font-bold transition-colors ${r?"text-white":"text-slate-400"}`,children:i}),m.jsx("p",{className:"text-xs text-slate-500 font-medium",children:a})]}),m.jsx("div",{className:"flex gap-2 mt-2",children:s.split("").map((o,l)=>m.jsx("span",{className:"px-2 py-1 rounded bg-black/20 text-[8px] font-black text-slate-600 tracking-tighter uppercase whitespace-nowrap",children:o.trim()},l))})]});var K0={exports:{}},mm={},pw={},mw={},jN;function ur(){return jN||(jN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r._registerNode=r.Konva=r.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}r.glob=typeof Pk<"u"?Pk:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},r.Konva={_global:r.glob,version:"9.3.16",isBrowser:n(),isUnminified:/param/.test((function(a){}).toString()),dblClickWindow:400,getAngle(a){return r.Konva.angleDeg?a*e:a},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return r.Konva.DD.isDragging},isTransforming(){var a;return(a=r.Konva.Transformer)===null||a===void 0?void 0:a.isTransforming()},isDragReady(){return!!r.Konva.DD.node},releaseCanvasOnDestroy:!0,document:r.glob.document,_injectGlobal(a){r.glob.Konva=a}};const i=a=>{r.Konva[a.prototype.getClassName()]=a};r._registerNode=i,r.Konva._injectGlobal(r.Konva)})(mw)),mw}var gw={},RN;function Yn(){return RN||(RN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Util=r.Transform=void 0;const e=ur();class n{constructor(P=[1,0,0,1,0,0]){this.dirty=!1,this.m=P&&P.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(P){P.m[0]=this.m[0],P.m[1]=this.m[1],P.m[2]=this.m[2],P.m[3]=this.m[3],P.m[4]=this.m[4],P.m[5]=this.m[5]}point(P){const R=this.m;return{x:R[0]*P.x+R[2]*P.y+R[4],y:R[1]*P.x+R[3]*P.y+R[5]}}translate(P,R){return this.m[4]+=this.m[0]*P+this.m[2]*R,this.m[5]+=this.m[1]*P+this.m[3]*R,this}scale(P,R){return this.m[0]*=P,this.m[1]*=P,this.m[2]*=R,this.m[3]*=R,this}rotate(P){const R=Math.cos(P),O=Math.sin(P),B=this.m[0]*R+this.m[2]*O,I=this.m[1]*R+this.m[3]*O,z=this.m[0]*-O+this.m[2]*R,V=this.m[1]*-O+this.m[3]*R;return this.m[0]=B,this.m[1]=I,this.m[2]=z,this.m[3]=V,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(P,R){const O=this.m[0]+this.m[2]*R,B=this.m[1]+this.m[3]*R,I=this.m[2]+this.m[0]*P,z=this.m[3]+this.m[1]*P;return this.m[0]=O,this.m[1]=B,this.m[2]=I,this.m[3]=z,this}multiply(P){const R=this.m[0]*P.m[0]+this.m[2]*P.m[1],O=this.m[1]*P.m[0]+this.m[3]*P.m[1],B=this.m[0]*P.m[2]+this.m[2]*P.m[3],I=this.m[1]*P.m[2]+this.m[3]*P.m[3],z=this.m[0]*P.m[4]+this.m[2]*P.m[5]+this.m[4],V=this.m[1]*P.m[4]+this.m[3]*P.m[5]+this.m[5];return this.m[0]=R,this.m[1]=O,this.m[2]=B,this.m[3]=I,this.m[4]=z,this.m[5]=V,this}invert(){const P=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),R=this.m[3]*P,O=-this.m[1]*P,B=-this.m[2]*P,I=this.m[0]*P,z=P*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),V=P*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=R,this.m[1]=O,this.m[2]=B,this.m[3]=I,this.m[4]=z,this.m[5]=V,this}getMatrix(){return this.m}decompose(){const P=this.m[0],R=this.m[1],O=this.m[2],B=this.m[3],I=this.m[4],z=this.m[5],V=P*B-R*O,$={x:I,y:z,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(P!=0||R!=0){const Y=Math.sqrt(P*P+R*R);$.rotation=R>0?Math.acos(P/Y):-Math.acos(P/Y),$.scaleX=Y,$.scaleY=V/Y,$.skewX=(P*O+R*B)/V,$.skewY=0}else if(O!=0||B!=0){const Y=Math.sqrt(O*O+B*B);$.rotation=Math.PI/2-(B>0?Math.acos(-O/Y):-Math.acos(O/Y)),$.scaleX=V/Y,$.scaleY=Y,$.skewX=0,$.skewY=(P*O+R*B)/V}return $.rotation=r.Util._getRotation($.rotation),$}}r.Transform=n;let i="[object Array]",a="[object Number]",s="[object String]",o="[object Boolean]",l=Math.PI/180,u=180/Math.PI,c="#",d="",p="0",v="Konva warning: ",y="Konva error: ",b="rgb(",S={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},k=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,T=[];const C=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(N){setTimeout(N,60)};r.Util={_isElement(N){return!!(N&&N.nodeType==1)},_isFunction(N){return!!(N&&N.constructor&&N.call&&N.apply)},_isPlainObject(N){return!!N&&N.constructor===Object},_isArray(N){return Object.prototype.toString.call(N)===i},_isNumber(N){return Object.prototype.toString.call(N)===a&&!isNaN(N)&&isFinite(N)},_isString(N){return Object.prototype.toString.call(N)===s},_isBoolean(N){return Object.prototype.toString.call(N)===o},isObject(N){return N instanceof Object},isValidSelector(N){if(typeof N!="string")return!1;const P=N[0];return P==="#"||P==="."||P===P.toUpperCase()},_sign(N){return N===0||N>0?1:-1},requestAnimFrame(N){T.push(N),T.length===1&&C(function(){const P=T;T=[],P.forEach(function(R){R()})})},createCanvasElement(){const N=document.createElement("canvas");try{N.style=N.style||{}}catch{}return N},createImageElement(){return document.createElement("img")},_isInDocument(N){for(;N=N.parentNode;)if(N==document)return!0;return!1},_urlToImage(N,P){const R=r.Util.createImageElement();R.onload=function(){P(R)},R.src=N},_rgbToHex(N,P,R){return((1<<24)+(N<<16)+(P<<8)+R).toString(16).slice(1)},_hexToRgb(N){N=N.replace(c,d);const P=parseInt(N,16);return{r:P>>16&255,g:P>>8&255,b:P&255}},getRandomColor(){let N=(Math.random()*16777215<<0).toString(16);for(;N.length<6;)N=p+N;return c+N},getRGB(N){let P;return N in S?(P=S[N],{r:P[0],g:P[1],b:P[2]}):N[0]===c?this._hexToRgb(N.substring(1)):N.substr(0,4)===b?(P=k.exec(N.replace(/ /g,"")),{r:parseInt(P[1],10),g:parseInt(P[2],10),b:parseInt(P[3],10)}):{r:0,g:0,b:0}},colorToRGBA(N){return N=N||"black",r.Util._namedColorToRBA(N)||r.Util._hex3ColorToRGBA(N)||r.Util._hex4ColorToRGBA(N)||r.Util._hex6ColorToRGBA(N)||r.Util._hex8ColorToRGBA(N)||r.Util._rgbColorToRGBA(N)||r.Util._rgbaColorToRGBA(N)||r.Util._hslColorToRGBA(N)},_namedColorToRBA(N){const P=S[N.toLowerCase()];return P?{r:P[0],g:P[1],b:P[2],a:1}:null},_rgbColorToRGBA(N){if(N.indexOf("rgb(")===0){N=N.match(/rgb\(([^)]+)\)/)[1];const P=N.split(/ *, */).map(Number);return{r:P[0],g:P[1],b:P[2],a:1}}},_rgbaColorToRGBA(N){if(N.indexOf("rgba(")===0){N=N.match(/rgba\(([^)]+)\)/)[1];const P=N.split(/ *, */).map((R,O)=>R.slice(-1)==="%"?O===3?parseInt(R)/100:parseInt(R)/100*255:Number(R));return{r:P[0],g:P[1],b:P[2],a:P[3]}}},_hex8ColorToRGBA(N){if(N[0]==="#"&&N.length===9)return{r:parseInt(N.slice(1,3),16),g:parseInt(N.slice(3,5),16),b:parseInt(N.slice(5,7),16),a:parseInt(N.slice(7,9),16)/255}},_hex6ColorToRGBA(N){if(N[0]==="#"&&N.length===7)return{r:parseInt(N.slice(1,3),16),g:parseInt(N.slice(3,5),16),b:parseInt(N.slice(5,7),16),a:1}},_hex4ColorToRGBA(N){if(N[0]==="#"&&N.length===5)return{r:parseInt(N[1]+N[1],16),g:parseInt(N[2]+N[2],16),b:parseInt(N[3]+N[3],16),a:parseInt(N[4]+N[4],16)/255}},_hex3ColorToRGBA(N){if(N[0]==="#"&&N.length===4)return{r:parseInt(N[1]+N[1],16),g:parseInt(N[2]+N[2],16),b:parseInt(N[3]+N[3],16),a:1}},_hslColorToRGBA(N){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(N)){const[P,...R]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(N),O=Number(R[0])/360,B=Number(R[1])/100,I=Number(R[2])/100;let z,V,$;if(B===0)return $=I*255,{r:Math.round($),g:Math.round($),b:Math.round($),a:1};I<.5?z=I*(1+B):z=I+B-I*B;const Y=2*I-z,D=[0,0,0];for(let q=0;q<3;q++)V=O+1/3*-(q-1),V<0&&V++,V>1&&V--,6*V<1?$=Y+(z-Y)*6*V:2*V<1?$=z:3*V<2?$=Y+(z-Y)*(2/3-V)*6:$=Y,D[q]=$*255;return{r:Math.round(D[0]),g:Math.round(D[1]),b:Math.round(D[2]),a:1}}},haveIntersection(N,P){return!(P.x>N.x+N.width||P.x+P.width<N.x||P.y>N.y+N.height||P.y+P.height<N.y)},cloneObject(N){const P={};for(const R in N)this._isPlainObject(N[R])?P[R]=this.cloneObject(N[R]):this._isArray(N[R])?P[R]=this.cloneArray(N[R]):P[R]=N[R];return P},cloneArray(N){return N.slice(0)},degToRad(N){return N*l},radToDeg(N){return N*u},_degToRad(N){return r.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),r.Util.degToRad(N)},_radToDeg(N){return r.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),r.Util.radToDeg(N)},_getRotation(N){return e.Konva.angleDeg?r.Util.radToDeg(N):N},_capitalize(N){return N.charAt(0).toUpperCase()+N.slice(1)},throw(N){throw new Error(y+N)},error(N){console.error(y+N)},warn(N){e.Konva.showWarnings&&console.warn(v+N)},each(N,P){for(const R in N)P(R,N[R])},_inRange(N,P,R){return P<=N&&N<R},_getProjectionToSegment(N,P,R,O,B,I){let z,V,$;const Y=(N-R)*(N-R)+(P-O)*(P-O);if(Y==0)z=N,V=P,$=(B-R)*(B-R)+(I-O)*(I-O);else{const D=((B-N)*(R-N)+(I-P)*(O-P))/Y;D<0?(z=N,V=P,$=(N-B)*(N-B)+(P-I)*(P-I)):D>1?(z=R,V=O,$=(R-B)*(R-B)+(O-I)*(O-I)):(z=N+D*(R-N),V=P+D*(O-P),$=(z-B)*(z-B)+(V-I)*(V-I))}return[z,V,$]},_getProjectionToLine(N,P,R){const O=r.Util.cloneObject(N);let B=Number.MAX_VALUE;return P.forEach(function(I,z){if(!R&&z===P.length-1)return;const V=P[(z+1)%P.length],$=r.Util._getProjectionToSegment(I.x,I.y,V.x,V.y,N.x,N.y),Y=$[0],D=$[1],q=$[2];q<B&&(O.x=Y,O.y=D,B=q)}),O},_prepareArrayForTween(N,P,R){let O,B=[],I=[];if(N.length>P.length){const V=P;P=N,N=V}for(O=0;O<N.length;O+=2)B.push({x:N[O],y:N[O+1]});for(O=0;O<P.length;O+=2)I.push({x:P[O],y:P[O+1]});const z=[];return I.forEach(function(V){const $=r.Util._getProjectionToLine(V,B,R);z.push($.x),z.push($.y)}),z},_prepareToStringify(N){let P;N.visitedByCircularReferenceRemoval=!0;for(const R in N)if(N.hasOwnProperty(R)&&N[R]&&typeof N[R]=="object"){if(P=Object.getOwnPropertyDescriptor(N,R),N[R].visitedByCircularReferenceRemoval||r.Util._isElement(N[R]))if(P.configurable)delete N[R];else return null;else if(r.Util._prepareToStringify(N[R])===null)if(P.configurable)delete N[R];else return null}return delete N.visitedByCircularReferenceRemoval,N},_assign(N,P){for(const R in P)N[R]=P[R];return N},_getFirstPointerId(N){return N.touches?N.changedTouches[0].identifier:N.pointerId||999},releaseCanvas(...N){e.Konva.releaseCanvasOnDestroy&&N.forEach(P=>{P.width=0,P.height=0})},drawRoundedRectPath(N,P,R,O){let B=0,I=0,z=0,V=0;typeof O=="number"?B=I=z=V=Math.min(O,P/2,R/2):(B=Math.min(O[0]||0,P/2,R/2),I=Math.min(O[1]||0,P/2,R/2),V=Math.min(O[2]||0,P/2,R/2),z=Math.min(O[3]||0,P/2,R/2)),N.moveTo(B,0),N.lineTo(P-I,0),N.arc(P-I,I,I,Math.PI*3/2,0,!1),N.lineTo(P,R-V),N.arc(P-V,R-V,V,0,Math.PI/2,!1),N.lineTo(z,R),N.arc(z,R-z,z,Math.PI/2,Math.PI,!1),N.lineTo(0,B),N.arc(B,B,B,Math.PI,Math.PI*3/2,!1)}}})(gw)),gw}var gm={},vw={},Ns={},LN;function gr(){if(LN)return Ns;LN=1,Object.defineProperty(Ns,"__esModule",{value:!0}),Ns.RGBComponent=i,Ns.alphaComponent=a,Ns.getNumberValidator=s,Ns.getNumberOrArrayOfNumbersValidator=o,Ns.getNumberOrAutoValidator=l,Ns.getStringValidator=u,Ns.getStringOrGradientValidator=c,Ns.getFunctionValidator=d,Ns.getNumberArrayValidator=p,Ns.getBooleanValidator=v,Ns.getComponentValidator=y;const r=ur(),e=Yn();function n(b){return e.Util._isString(b)?'"'+b+'"':Object.prototype.toString.call(b)==="[object Number]"||e.Util._isBoolean(b)?b:Object.prototype.toString.call(b)}function i(b){return b>255?255:b<0?0:Math.round(b)}function a(b){return b>1?1:b<1e-4?1e-4:b}function s(){if(r.Konva.isUnminified)return function(b,S){return e.Util._isNumber(b)||e.Util.warn(n(b)+' is a not valid value for "'+S+'" attribute. The value should be a number.'),b}}function o(b){if(r.Konva.isUnminified)return function(S,k){const T=e.Util._isNumber(S),C=e.Util._isArray(S)&&S.length==b;return!T&&!C&&e.Util.warn(n(S)+' is a not valid value for "'+k+'" attribute. The value should be a number or Array<number>('+b+")"),S}}function l(){if(r.Konva.isUnminified)return function(b,S){return e.Util._isNumber(b)||b==="auto"||e.Util.warn(n(b)+' is a not valid value for "'+S+'" attribute. The value should be a number or "auto".'),b}}function u(){if(r.Konva.isUnminified)return function(b,S){return e.Util._isString(b)||e.Util.warn(n(b)+' is a not valid value for "'+S+'" attribute. The value should be a string.'),b}}function c(){if(r.Konva.isUnminified)return function(b,S){const k=e.Util._isString(b),T=Object.prototype.toString.call(b)==="[object CanvasGradient]"||b&&b.addColorStop;return k||T||e.Util.warn(n(b)+' is a not valid value for "'+S+'" attribute. The value should be a string or a native gradient.'),b}}function d(){if(r.Konva.isUnminified)return function(b,S){return e.Util._isFunction(b)||e.Util.warn(n(b)+' is a not valid value for "'+S+'" attribute. The value should be a function.'),b}}function p(){if(r.Konva.isUnminified)return function(b,S){const k=Int8Array?Object.getPrototypeOf(Int8Array):null;return k&&b instanceof k||(e.Util._isArray(b)?b.forEach(function(T){e.Util._isNumber(T)||e.Util.warn('"'+S+'" attribute has non numeric element '+T+". Make sure that all elements are numbers.")}):e.Util.warn(n(b)+' is a not valid value for "'+S+'" attribute. The value should be a array of numbers.')),b}}function v(){if(r.Konva.isUnminified)return function(b,S){return b===!0||b===!1||e.Util.warn(n(b)+' is a not valid value for "'+S+'" attribute. The value should be a boolean.'),b}}function y(b){if(r.Konva.isUnminified)return function(S,k){return S==null||e.Util.isObject(S)||e.Util.warn(n(S)+' is a not valid value for "'+k+'" attribute. The value should be an object with properties '+b),S}}return Ns}var ON;function fr(){return ON||(ON=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Factory=void 0;const e=Yn(),n=gr(),i="get",a="set";r.Factory={addGetterSetter(s,o,l,u,c){r.Factory.addGetter(s,o,l),r.Factory.addSetter(s,o,u,c),r.Factory.addOverloadedGetterSetter(s,o)},addGetter(s,o,l){const u=i+e.Util._capitalize(o);s.prototype[u]=s.prototype[u]||function(){const c=this.attrs[o];return c===void 0?l:c}},addSetter(s,o,l,u){const c=a+e.Util._capitalize(o);s.prototype[c]||r.Factory.overWriteSetter(s,o,l,u)},overWriteSetter(s,o,l,u){const c=a+e.Util._capitalize(o);s.prototype[c]=function(d){return l&&d!==void 0&&d!==null&&(d=l.call(this,d,o)),this._setAttr(o,d),u&&u.call(this),this}},addComponentsGetterSetter(s,o,l,u,c){let d=l.length,p=e.Util._capitalize,v=i+p(o),y=a+p(o),b,S;s.prototype[v]=function(){const T={};for(b=0;b<d;b++)S=l[b],T[S]=this.getAttr(o+p(S));return T};const k=(0,n.getComponentValidator)(l);s.prototype[y]=function(T){let C=this.attrs[o],N;u&&(T=u.call(this,T)),k&&k.call(this,T,o);for(N in T)T.hasOwnProperty(N)&&this._setAttr(o+p(N),T[N]);return T||l.forEach(P=>{this._setAttr(o+p(P),void 0)}),this._fireChangeEvent(o,C,T),c&&c.call(this),this},r.Factory.addOverloadedGetterSetter(s,o)},addOverloadedGetterSetter(s,o){const l=e.Util._capitalize(o),u=a+l,c=i+l;s.prototype[o]=function(){return arguments.length?(this[u](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(s,o,l,u){e.Util.error("Adding deprecated "+o);const c=i+e.Util._capitalize(o),d=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";s.prototype[c]=function(){e.Util.error(d);const p=this.attrs[o];return p===void 0?l:p},r.Factory.addSetter(s,o,u,function(){e.Util.error(d)}),r.Factory.addOverloadedGetterSetter(s,o)},backCompat(s,o){e.Util.each(o,function(l,u){const c=s.prototype[u],d=i+e.Util._capitalize(l),p=a+e.Util._capitalize(l);function v(){c.apply(this,arguments),e.Util.error('"'+l+'" method is deprecated and will be removed soon. Use ""'+u+'" instead.')}s.prototype[l]=v,s.prototype[d]=v,s.prototype[p]=v})},afterSetFilter(){this._filterUpToDate=!1}}})(vw)),vw}var Ou={},Du={},DN;function fM(){if(DN)return Du;DN=1,Object.defineProperty(Du,"__esModule",{value:!0}),Du.HitContext=Du.SceneContext=Du.Context=void 0;const r=Yn(),e=ur();function n(T){let C=[],N=T.length,P=r.Util,R,O;for(R=0;R<N;R++)O=T[R],P._isNumber(O)?O=Math.round(O*1e3)/1e3:P._isString(O)||(O=O+""),C.push(O);return C}const i=",",a="(",s=")",o="([",l="])",u=";",c="()",d="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],v=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],y=100;let b=class{constructor(C){this.canvas=C,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(C){C.fillEnabled()&&this._fill(C)}_fill(C){}strokeShape(C){C.hasStroke()&&this._stroke(C)}_stroke(C){}fillStrokeShape(C){C.attrs.fillAfterStrokeEnabled?(this.strokeShape(C),this.fillShape(C)):(this.fillShape(C),this.strokeShape(C))}getTrace(C,N){let P=this.traceArr,R=P.length,O="",B,I,z,V;for(B=0;B<R;B++)I=P[B],z=I.method,z?(V=I.args,O+=z,C?O+=c:r.Util._isArray(V[0])?O+=o+V.join(i)+l:(N&&(V=V.map($=>typeof $=="number"?Math.floor($):$)),O+=a+V.join(i)+s)):(O+=I.property,C||(O+=d+I.val)),O+=u;return O}clearTrace(){this.traceArr=[]}_trace(C){let N=this.traceArr,P;N.push(C),P=N.length,P>=y&&N.shift()}reset(){const C=this.getCanvas().getPixelRatio();this.setTransform(1*C,0,0,1*C,0,0)}getCanvas(){return this.canvas}clear(C){const N=this.getCanvas();C?this.clearRect(C.x||0,C.y||0,C.width||0,C.height||0):this.clearRect(0,0,N.getWidth()/N.pixelRatio,N.getHeight()/N.pixelRatio)}_applyLineCap(C){const N=C.attrs.lineCap;N&&this.setAttr("lineCap",N)}_applyOpacity(C){const N=C.getAbsoluteOpacity();N!==1&&this.setAttr("globalAlpha",N)}_applyLineJoin(C){const N=C.attrs.lineJoin;N&&this.setAttr("lineJoin",N)}setAttr(C,N){this._context[C]=N}arc(C,N,P,R,O,B){this._context.arc(C,N,P,R,O,B)}arcTo(C,N,P,R,O){this._context.arcTo(C,N,P,R,O)}beginPath(){this._context.beginPath()}bezierCurveTo(C,N,P,R,O,B){this._context.bezierCurveTo(C,N,P,R,O,B)}clearRect(C,N,P,R){this._context.clearRect(C,N,P,R)}clip(...C){this._context.clip.apply(this._context,C)}closePath(){this._context.closePath()}createImageData(C,N){const P=arguments;if(P.length===2)return this._context.createImageData(C,N);if(P.length===1)return this._context.createImageData(C)}createLinearGradient(C,N,P,R){return this._context.createLinearGradient(C,N,P,R)}createPattern(C,N){return this._context.createPattern(C,N)}createRadialGradient(C,N,P,R,O,B){return this._context.createRadialGradient(C,N,P,R,O,B)}drawImage(C,N,P,R,O,B,I,z,V){const $=arguments,Y=this._context;$.length===3?Y.drawImage(C,N,P):$.length===5?Y.drawImage(C,N,P,R,O):$.length===9&&Y.drawImage(C,N,P,R,O,B,I,z,V)}ellipse(C,N,P,R,O,B,I,z){this._context.ellipse(C,N,P,R,O,B,I,z)}isPointInPath(C,N,P,R){return P?this._context.isPointInPath(P,C,N,R):this._context.isPointInPath(C,N,R)}fill(...C){this._context.fill.apply(this._context,C)}fillRect(C,N,P,R){this._context.fillRect(C,N,P,R)}strokeRect(C,N,P,R){this._context.strokeRect(C,N,P,R)}fillText(C,N,P,R){R?this._context.fillText(C,N,P,R):this._context.fillText(C,N,P)}measureText(C){return this._context.measureText(C)}getImageData(C,N,P,R){return this._context.getImageData(C,N,P,R)}lineTo(C,N){this._context.lineTo(C,N)}moveTo(C,N){this._context.moveTo(C,N)}rect(C,N,P,R){this._context.rect(C,N,P,R)}roundRect(C,N,P,R,O){this._context.roundRect(C,N,P,R,O)}putImageData(C,N,P){this._context.putImageData(C,N,P)}quadraticCurveTo(C,N,P,R){this._context.quadraticCurveTo(C,N,P,R)}restore(){this._context.restore()}rotate(C){this._context.rotate(C)}save(){this._context.save()}scale(C,N){this._context.scale(C,N)}setLineDash(C){this._context.setLineDash?this._context.setLineDash(C):"mozDash"in this._context?this._context.mozDash=C:"webkitLineDash"in this._context&&(this._context.webkitLineDash=C)}getLineDash(){return this._context.getLineDash()}setTransform(C,N,P,R,O,B){this._context.setTransform(C,N,P,R,O,B)}stroke(C){C?this._context.stroke(C):this._context.stroke()}strokeText(C,N,P,R){this._context.strokeText(C,N,P,R)}transform(C,N,P,R,O,B){this._context.transform(C,N,P,R,O,B)}translate(C,N){this._context.translate(C,N)}_enableTrace(){let C=this,N=p.length,P=this.setAttr,R,O;const B=function(I){let z=C[I],V;C[I]=function(){return O=n(Array.prototype.slice.call(arguments,0)),V=z.apply(C,arguments),C._trace({method:I,args:O}),V}};for(R=0;R<N;R++)B(p[R]);C.setAttr=function(){P.apply(C,arguments);const I=arguments[0];let z=arguments[1];(I==="shadowOffsetX"||I==="shadowOffsetY"||I==="shadowBlur")&&(z=z/this.canvas.getPixelRatio()),C._trace({property:I,val:z})}}_applyGlobalCompositeOperation(C){const N=C.attrs.globalCompositeOperation;!N||N==="source-over"||this.setAttr("globalCompositeOperation",N)}};Du.Context=b,v.forEach(function(T){Object.defineProperty(b.prototype,T,{get(){return this._context[T]},set(C){this._context[T]=C}})});class S extends b{constructor(C,{willReadFrequently:N=!1}={}){super(C),this._context=C._canvas.getContext("2d",{willReadFrequently:N})}_fillColor(C){const N=C.fill();this.setAttr("fillStyle",N),C._fillFunc(this)}_fillPattern(C){this.setAttr("fillStyle",C._getFillPattern()),C._fillFunc(this)}_fillLinearGradient(C){const N=C._getLinearGradient();N&&(this.setAttr("fillStyle",N),C._fillFunc(this))}_fillRadialGradient(C){const N=C._getRadialGradient();N&&(this.setAttr("fillStyle",N),C._fillFunc(this))}_fill(C){const N=C.fill(),P=C.getFillPriority();if(N&&P==="color"){this._fillColor(C);return}const R=C.getFillPatternImage();if(R&&P==="pattern"){this._fillPattern(C);return}const O=C.getFillLinearGradientColorStops();if(O&&P==="linear-gradient"){this._fillLinearGradient(C);return}const B=C.getFillRadialGradientColorStops();if(B&&P==="radial-gradient"){this._fillRadialGradient(C);return}N?this._fillColor(C):R?this._fillPattern(C):O?this._fillLinearGradient(C):B&&this._fillRadialGradient(C)}_strokeLinearGradient(C){const N=C.getStrokeLinearGradientStartPoint(),P=C.getStrokeLinearGradientEndPoint(),R=C.getStrokeLinearGradientColorStops(),O=this.createLinearGradient(N.x,N.y,P.x,P.y);if(R){for(let B=0;B<R.length;B+=2)O.addColorStop(R[B],R[B+1]);this.setAttr("strokeStyle",O)}}_stroke(C){const N=C.dash(),P=C.getStrokeScaleEnabled();if(C.hasStroke()){if(!P){this.save();const O=this.getCanvas().getPixelRatio();this.setTransform(O,0,0,O,0,0)}this._applyLineCap(C),N&&C.dashEnabled()&&(this.setLineDash(N),this.setAttr("lineDashOffset",C.dashOffset())),this.setAttr("lineWidth",C.strokeWidth()),C.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),C.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(C):this.setAttr("strokeStyle",C.stroke()),C._strokeFunc(this),P||this.restore()}}_applyShadow(C){var N,P,R;const O=(N=C.getShadowRGBA())!==null&&N!==void 0?N:"black",B=(P=C.getShadowBlur())!==null&&P!==void 0?P:5,I=(R=C.getShadowOffset())!==null&&R!==void 0?R:{x:0,y:0},z=C.getAbsoluteScale(),V=this.canvas.getPixelRatio(),$=z.x*V,Y=z.y*V;this.setAttr("shadowColor",O),this.setAttr("shadowBlur",B*Math.min(Math.abs($),Math.abs(Y))),this.setAttr("shadowOffsetX",I.x*$),this.setAttr("shadowOffsetY",I.y*Y)}}Du.SceneContext=S;class k extends b{constructor(C){super(C),this._context=C._canvas.getContext("2d",{willReadFrequently:!0})}_fill(C){this.save(),this.setAttr("fillStyle",C.colorKey),C._fillFuncHit(this),this.restore()}strokeShape(C){C.hasHitStroke()&&this._stroke(C)}_stroke(C){if(C.hasHitStroke()){const N=C.getStrokeScaleEnabled();if(!N){this.save();const O=this.getCanvas().getPixelRatio();this.setTransform(O,0,0,O,0,0)}this._applyLineCap(C);const P=C.hitStrokeWidth(),R=P==="auto"?C.strokeWidth():P;this.setAttr("lineWidth",R),this.setAttr("strokeStyle",C.colorKey),C._strokeFuncHit(this),N||this.restore()}}}return Du.HitContext=k,Du}var IN;function Ax(){if(IN)return Ou;IN=1,Object.defineProperty(Ou,"__esModule",{value:!0}),Ou.HitCanvas=Ou.SceneCanvas=Ou.Canvas=void 0;const r=Yn(),e=fM(),n=ur(),i=fr(),a=gr();let s;function o(){if(s)return s;const d=r.Util.createCanvasElement(),p=d.getContext("2d");return s=(function(){const v=n.Konva._global.devicePixelRatio||1,y=p.webkitBackingStorePixelRatio||p.mozBackingStorePixelRatio||p.msBackingStorePixelRatio||p.oBackingStorePixelRatio||p.backingStorePixelRatio||1;return v/y})(),r.Util.releaseCanvas(d),s}let l=class{constructor(p){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const y=(p||{}).pixelRatio||n.Konva.pixelRatio||o();this.pixelRatio=y,this._canvas=r.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(p){const v=this.pixelRatio;this.pixelRatio=p,this.setSize(this.getWidth()/v,this.getHeight()/v)}setWidth(p){this.width=this._canvas.width=p*this.pixelRatio,this._canvas.style.width=p+"px";const v=this.pixelRatio;this.getContext()._context.scale(v,v)}setHeight(p){this.height=this._canvas.height=p*this.pixelRatio,this._canvas.style.height=p+"px";const v=this.pixelRatio;this.getContext()._context.scale(v,v)}getWidth(){return this.width}getHeight(){return this.height}setSize(p,v){this.setWidth(p||0),this.setHeight(v||0)}toDataURL(p,v){try{return this._canvas.toDataURL(p,v)}catch{try{return this._canvas.toDataURL()}catch(b){return r.Util.error("Unable to get data URL. "+b.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Ou.Canvas=l,i.Factory.addGetterSetter(l,"pixelRatio",void 0,(0,a.getNumberValidator)());class u extends l{constructor(p={width:0,height:0,willReadFrequently:!1}){super(p),this.context=new e.SceneContext(this,{willReadFrequently:p.willReadFrequently}),this.setSize(p.width,p.height)}}Ou.SceneCanvas=u;class c extends l{constructor(p={width:0,height:0}){super(p),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(p.width,p.height)}}return Ou.HitCanvas=c,Ou}var yw={},BN;function Q_(){return BN||(BN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DD=void 0;const e=ur(),n=Yn();r.DD={get isDragging(){let i=!1;return r.DD._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return r.DD._dragElements.forEach(a=>{i=a.node}),i},_dragElements:new Map,_drag(i){const a=[];r.DD._dragElements.forEach((s,o)=>{const{node:l}=s,u=l.getStage();u.setPointersPositions(i),s.pointerId===void 0&&(s.pointerId=n.Util._getFirstPointerId(i));const c=u._changedPointerPositions.find(d=>d.id===s.pointerId);if(c){if(s.dragStatus!=="dragging"){const d=l.dragDistance();if(Math.max(Math.abs(c.x-s.startPointerPos.x),Math.abs(c.y-s.startPointerPos.y))<d||(l.startDrag({evt:i}),!l.isDragging()))return}l._setDragPosition(i,s),a.push(l)}}),a.forEach(s=>{s.fire("dragmove",{type:"dragmove",target:s,evt:i},!0)})},_endDragBefore(i){const a=[];r.DD._dragElements.forEach(s=>{const{node:o}=s,l=o.getStage();if(i&&l.setPointersPositions(i),!l._changedPointerPositions.find(d=>d.id===s.pointerId))return;(s.dragStatus==="dragging"||s.dragStatus==="stopped")&&(r.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,s.dragStatus="stopped");const c=s.node.getLayer()||s.node instanceof e.Konva.Stage&&s.node;c&&a.indexOf(c)===-1&&a.push(c)}),a.forEach(s=>{s.draw()})},_endDragAfter(i){r.DD._dragElements.forEach((a,s)=>{a.dragStatus==="stopped"&&a.node.fire("dragend",{type:"dragend",target:a.node,evt:i},!0),a.dragStatus!=="dragging"&&r.DD._dragElements.delete(s)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",r.DD._endDragBefore,!0),window.addEventListener("touchend",r.DD._endDragBefore,!0),window.addEventListener("touchcancel",r.DD._endDragBefore,!0),window.addEventListener("mousemove",r.DD._drag),window.addEventListener("touchmove",r.DD._drag),window.addEventListener("mouseup",r.DD._endDragAfter,!1),window.addEventListener("touchend",r.DD._endDragAfter,!1),window.addEventListener("touchcancel",r.DD._endDragAfter,!1))})(yw)),yw}var zN;function oi(){if(zN)return gm;zN=1,Object.defineProperty(gm,"__esModule",{value:!0}),gm.Node=void 0;const r=Yn(),e=fr(),n=Ax(),i=ur(),a=Q_(),s=gr(),o="absoluteOpacity",l="allEventListeners",u="absoluteTransform",c="absoluteScale",d="canvas",p="Change",v="children",y="konva",b="listening",S="mouseenter",k="mouseleave",T="set",C="Shape",N=" ",P="stage",R="transform",O="Stage",B="visible",I=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(N);let z=1;class V{constructor(D){this._id=z++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(D),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(D){(D===R||D===u)&&this._cache.get(D)?this._cache.get(D).dirty=!0:D?this._cache.delete(D):this._cache.clear()}_getCache(D,q){let G=this._cache.get(D);return(G===void 0||(D===R||D===u)&&G.dirty===!0)&&(G=q.call(this),this._cache.set(D,G)),G}_calculate(D,q,G){if(!this._attachedDepsListeners.get(D)){const Z=q.map(Q=>Q+"Change.konva").join(N);this.on(Z,()=>{this._clearCache(D)}),this._attachedDepsListeners.set(D,!0)}return this._getCache(D,G)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(D){this._clearCache(D),D===u&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(d)){const{scene:D,filter:q,hit:G}=this._cache.get(d);r.Util.releaseCanvas(D,q,G),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(D){const q=D||{};let G={};(q.x===void 0||q.y===void 0||q.width===void 0||q.height===void 0)&&(G=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let Z=Math.ceil(q.width||G.width),Q=Math.ceil(q.height||G.height),J=q.pixelRatio,ie=q.x===void 0?Math.floor(G.x):q.x,ne=q.y===void 0?Math.floor(G.y):q.y,W=q.offset||0,re=q.drawBorder||!1,ae=q.hitCanvasPixelRatio||1;if(!Z||!Q){r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const he=Math.abs(Math.round(G.x)-ie)>.5?1:0,ve=Math.abs(Math.round(G.y)-ne)>.5?1:0;Z+=W*2+he,Q+=W*2+ve,ie-=W,ne-=W;const xe=new n.SceneCanvas({pixelRatio:J,width:Z,height:Q}),se=new n.SceneCanvas({pixelRatio:J,width:0,height:0,willReadFrequently:!0}),ge=new n.HitCanvas({pixelRatio:ae,width:Z,height:Q}),le=xe.getContext(),pe=ge.getContext();return ge.isCache=!0,xe.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,q.imageSmoothingEnabled===!1&&(xe.getContext()._context.imageSmoothingEnabled=!1,se.getContext()._context.imageSmoothingEnabled=!1),le.save(),pe.save(),le.translate(-ie,-ne),pe.translate(-ie,-ne),this._isUnderCache=!0,this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this.drawScene(xe,this),this.drawHit(ge,this),this._isUnderCache=!1,le.restore(),pe.restore(),re&&(le.save(),le.beginPath(),le.rect(0,0,Z,Q),le.closePath(),le.setAttr("strokeStyle","red"),le.setAttr("lineWidth",5),le.stroke(),le.restore()),this._cache.set(d,{scene:xe,filter:se,hit:ge,x:ie,y:ne}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(D){throw new Error('abstract "getClientRect" method call')}_transformedRect(D,q){const G=[{x:D.x,y:D.y},{x:D.x+D.width,y:D.y},{x:D.x+D.width,y:D.y+D.height},{x:D.x,y:D.y+D.height}];let Z=1/0,Q=1/0,J=-1/0,ie=-1/0;const ne=this.getAbsoluteTransform(q);return G.forEach(function(W){const re=ne.point(W);Z===void 0&&(Z=J=re.x,Q=ie=re.y),Z=Math.min(Z,re.x),Q=Math.min(Q,re.y),J=Math.max(J,re.x),ie=Math.max(ie,re.y)}),{x:Z,y:Q,width:J-Z,height:ie-Q}}_drawCachedSceneCanvas(D){D.save(),D._applyOpacity(this),D._applyGlobalCompositeOperation(this);const q=this._getCanvasCache();D.translate(q.x,q.y);const G=this._getCachedSceneCanvas(),Z=G.pixelRatio;D.drawImage(G._canvas,0,0,G.width/Z,G.height/Z),D.restore()}_drawCachedHitCanvas(D){const q=this._getCanvasCache(),G=q.hit;D.save(),D.translate(q.x,q.y),D.drawImage(G._canvas,0,0,G.width/G.pixelRatio,G.height/G.pixelRatio),D.restore()}_getCachedSceneCanvas(){let D=this.filters(),q=this._getCanvasCache(),G=q.scene,Z=q.filter,Q=Z.getContext(),J,ie,ne,W;if(D){if(!this._filterUpToDate){const re=G.pixelRatio;Z.setSize(G.width/G.pixelRatio,G.height/G.pixelRatio);try{for(J=D.length,Q.clear(),Q.drawImage(G._canvas,0,0,G.getWidth()/re,G.getHeight()/re),ie=Q.getImageData(0,0,Z.getWidth(),Z.getHeight()),ne=0;ne<J;ne++){if(W=D[ne],typeof W!="function"){r.Util.error("Filter should be type of function, but got "+typeof W+" instead. Please check correct filters");continue}W.call(this,ie),Q.putImageData(ie,0,0)}}catch(ae){r.Util.error("Unable to apply filter. "+ae.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return Z}return G}on(D,q){if(this._cache&&this._cache.delete(l),arguments.length===3)return this._delegate.apply(this,arguments);let G=D.split(N),Z=G.length,Q,J,ie,ne,W;for(Q=0;Q<Z;Q++)J=G[Q],ie=J.split("."),ne=ie[0],W=ie[1]||"",this.eventListeners[ne]||(this.eventListeners[ne]=[]),this.eventListeners[ne].push({name:W,handler:q});return this}off(D,q){let G=(D||"").split(N),Z=G.length,Q,J,ie,ne,W,re;if(this._cache&&this._cache.delete(l),!D)for(J in this.eventListeners)this._off(J);for(Q=0;Q<Z;Q++)if(ie=G[Q],ne=ie.split("."),W=ne[0],re=ne[1],W)this.eventListeners[W]&&this._off(W,re,q);else for(J in this.eventListeners)this._off(J,re,q);return this}dispatchEvent(D){const q={target:this,type:D.type,evt:D};return this.fire(D.type,q),this}addEventListener(D,q){return this.on(D,function(G){q.call(this,G.evt)}),this}removeEventListener(D){return this.off(D),this}_delegate(D,q,G){const Z=this;this.on(D,function(Q){const J=Q.target.findAncestors(q,!0,Z);for(let ie=0;ie<J.length;ie++)Q=r.Util.cloneObject(Q),Q.currentTarget=J[ie],G.call(J[ie],Q)})}remove(){return this.isDragging()&&this.stopDrag(),a.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(o),this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(P),this._clearSelfAndDescendantCache(B),this._clearSelfAndDescendantCache(b)}_remove(){this._clearCaches();const D=this.getParent();D&&D.children&&(D.children.splice(this.index,1),D._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(D){const q="get"+r.Util._capitalize(D);return r.Util._isFunction(this[q])?this[q]():this.attrs[D]}getAncestors(){let D=this.getParent(),q=[];for(;D;)q.push(D),D=D.getParent();return q}getAttrs(){return this.attrs||{}}setAttrs(D){return this._batchTransformChanges(()=>{let q,G;if(!D)return this;for(q in D)q!==v&&(G=T+r.Util._capitalize(q),r.Util._isFunction(this[G])?this[G](D[q]):this._setAttr(q,D[q]))}),this}isListening(){return this._getCache(b,this._isListening)}_isListening(D){if(!this.listening())return!1;const G=this.getParent();return G&&G!==D&&this!==D?G._isListening(D):!0}isVisible(){return this._getCache(B,this._isVisible)}_isVisible(D){if(!this.visible())return!1;const G=this.getParent();return G&&G!==D&&this!==D?G._isVisible(D):!0}shouldDrawHit(D,q=!1){if(D)return this._isVisible(D)&&this._isListening(D);const G=this.getLayer();let Z=!1;a.DD._dragElements.forEach(J=>{J.dragStatus==="dragging"&&(J.node.nodeType==="Stage"||J.node.getLayer()===G)&&(Z=!0)});const Q=!q&&!i.Konva.hitOnDragEnabled&&(Z||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!Q}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let D=this.getDepth(),q=this,G=0,Z,Q,J,ie;function ne(re){for(Z=[],Q=re.length,J=0;J<Q;J++)ie=re[J],G++,ie.nodeType!==C&&(Z=Z.concat(ie.getChildren().slice())),ie._id===q._id&&(J=Q);Z.length>0&&Z[0].getDepth()<=D&&ne(Z)}const W=this.getStage();return q.nodeType!==O&&W&&ne(W.getChildren()),G}getDepth(){let D=0,q=this.parent;for(;q;)D++,q=q.parent;return D}_batchTransformChanges(D){this._batchingTransformChange=!0,D(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(R),this._clearSelfAndDescendantCache(u)),this._needClearTransformCache=!1}setPosition(D){return this._batchTransformChanges(()=>{this.x(D.x),this.y(D.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const D=this.getStage();if(!D)return null;const q=D.getPointerPosition();if(!q)return null;const G=this.getAbsoluteTransform().copy();return G.invert(),G.point(q)}getAbsolutePosition(D){let q=!1,G=this.parent;for(;G;){if(G.isCached()){q=!0;break}G=G.parent}q&&!D&&(D=!0);const Z=this.getAbsoluteTransform(D).getMatrix(),Q=new r.Transform,J=this.offset();return Q.m=Z.slice(),Q.translate(J.x,J.y),Q.getTranslation()}setAbsolutePosition(D){const{x:q,y:G,...Z}=this._clearTransform();this.attrs.x=q,this.attrs.y=G,this._clearCache(R);const Q=this._getAbsoluteTransform().copy();return Q.invert(),Q.translate(D.x,D.y),D={x:this.attrs.x+Q.getTranslation().x,y:this.attrs.y+Q.getTranslation().y},this._setTransform(Z),this.setPosition({x:D.x,y:D.y}),this._clearCache(R),this._clearSelfAndDescendantCache(u),this}_setTransform(D){let q;for(q in D)this.attrs[q]=D[q]}_clearTransform(){const D={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,D}move(D){let q=D.x,G=D.y,Z=this.x(),Q=this.y();return q!==void 0&&(Z+=q),G!==void 0&&(Q+=G),this.setPosition({x:Z,y:Q}),this}_eachAncestorReverse(D,q){let G=[],Z=this.getParent(),Q,J;if(!(q&&q._id===this._id)){for(G.unshift(this);Z&&(!q||Z._id!==q._id);)G.unshift(Z),Z=Z.parent;for(Q=G.length,J=0;J<Q;J++)D(G[J])}}rotate(D){return this.rotation(this.rotation()+D),this}moveToTop(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const D=this.index,q=this.parent.getChildren().length;return D<q-1?(this.parent.children.splice(D,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;const D=this.index,q=this.parent.getChildren().length;return D<q-1?(this.parent.children.splice(D,1),this.parent.children.splice(D+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;const D=this.index;return D>0?(this.parent.children.splice(D,1),this.parent.children.splice(D-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const D=this.index;return D>0?(this.parent.children.splice(D,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(D){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(D<0||D>=this.parent.children.length)&&r.Util.warn("Unexpected value "+D+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const q=this.index;return this.parent.children.splice(q,1),this.parent.children.splice(D,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(o,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let D=this.opacity();const q=this.getParent();return q&&!q._isUnderCache&&(D*=q.getAbsoluteOpacity()),D}moveTo(D){return this.getParent()!==D&&(this._remove(),D.add(this)),this}toObject(){let D=this.getAttrs(),q,G,Z,Q,J;const ie={attrs:{},className:this.getClassName()};for(q in D)G=D[q],J=r.Util.isObject(G)&&!r.Util._isPlainObject(G)&&!r.Util._isArray(G),!J&&(Z=typeof this[q]=="function"&&this[q],delete D[q],Q=Z?Z.call(this):null,D[q]=G,Q!==G&&(ie.attrs[q]=G));return r.Util._prepareToStringify(ie)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(D,q,G){const Z=[];q&&this._isMatch(D)&&Z.push(this);let Q=this.parent;for(;Q;){if(Q===G)return Z;Q._isMatch(D)&&Z.push(Q),Q=Q.parent}return Z}isAncestorOf(D){return!1}findAncestor(D,q,G){return this.findAncestors(D,q,G)[0]}_isMatch(D){if(!D)return!1;if(typeof D=="function")return D(this);let q=D.replace(/ /g,"").split(","),G=q.length,Z,Q;for(Z=0;Z<G;Z++)if(Q=q[Z],r.Util.isValidSelector(Q)||(r.Util.warn('Selector "'+Q+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),Q.charAt(0)==="#"){if(this.id()===Q.slice(1))return!0}else if(Q.charAt(0)==="."){if(this.hasName(Q.slice(1)))return!0}else if(this.className===Q||this.nodeType===Q)return!0;return!1}getLayer(){const D=this.getParent();return D?D.getLayer():null}getStage(){return this._getCache(P,this._getStage)}_getStage(){const D=this.getParent();return D?D.getStage():null}fire(D,q={},G){return q.target=q.target||this,G?this._fireAndBubble(D,q):this._fire(D,q),this}getAbsoluteTransform(D){return D?this._getAbsoluteTransform(D):this._getCache(u,this._getAbsoluteTransform)}_getAbsoluteTransform(D){let q;if(D)return q=new r.Transform,this._eachAncestorReverse(function(G){const Z=G.transformsEnabled();Z==="all"?q.multiply(G.getTransform()):Z==="position"&&q.translate(G.x()-G.offsetX(),G.y()-G.offsetY())},D),q;{q=this._cache.get(u)||new r.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(q):q.reset();const G=this.transformsEnabled();if(G==="all")q.multiply(this.getTransform());else if(G==="position"){const Z=this.attrs.x||0,Q=this.attrs.y||0,J=this.attrs.offsetX||0,ie=this.attrs.offsetY||0;q.translate(Z-J,Q-ie)}return q.dirty=!1,q}}getAbsoluteScale(D){let q=this;for(;q;)q._isUnderCache&&(D=q),q=q.getParent();const Z=this.getAbsoluteTransform(D).decompose();return{x:Z.scaleX,y:Z.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(R,this._getTransform)}_getTransform(){var D,q;const G=this._cache.get(R)||new r.Transform;G.reset();const Z=this.x(),Q=this.y(),J=i.Konva.getAngle(this.rotation()),ie=(D=this.attrs.scaleX)!==null&&D!==void 0?D:1,ne=(q=this.attrs.scaleY)!==null&&q!==void 0?q:1,W=this.attrs.skewX||0,re=this.attrs.skewY||0,ae=this.attrs.offsetX||0,he=this.attrs.offsetY||0;return(Z!==0||Q!==0)&&G.translate(Z,Q),J!==0&&G.rotate(J),(W!==0||re!==0)&&G.skew(W,re),(ie!==1||ne!==1)&&G.scale(ie,ne),(ae!==0||he!==0)&&G.translate(-1*ae,-1*he),G.dirty=!1,G}clone(D){let q=r.Util.cloneObject(this.attrs),G,Z,Q,J,ie;for(G in D)q[G]=D[G];const ne=new this.constructor(q);for(G in this.eventListeners)for(Z=this.eventListeners[G],Q=Z.length,J=0;J<Q;J++)ie=Z[J],ie.name.indexOf(y)<0&&(ne.eventListeners[G]||(ne.eventListeners[G]=[]),ne.eventListeners[G].push(ie));return ne}_toKonvaCanvas(D){D=D||{};const q=this.getClientRect(),G=this.getStage(),Z=D.x!==void 0?D.x:Math.floor(q.x),Q=D.y!==void 0?D.y:Math.floor(q.y),J=D.pixelRatio||1,ie=new n.SceneCanvas({width:D.width||Math.ceil(q.width)||(G?G.width():0),height:D.height||Math.ceil(q.height)||(G?G.height():0),pixelRatio:J}),ne=ie.getContext(),W=new n.SceneCanvas({width:ie.width/ie.pixelRatio+Math.abs(Z),height:ie.height/ie.pixelRatio+Math.abs(Q),pixelRatio:ie.pixelRatio});return D.imageSmoothingEnabled===!1&&(ne._context.imageSmoothingEnabled=!1),ne.save(),(Z||Q)&&ne.translate(-1*Z,-1*Q),this.drawScene(ie,void 0,W),ne.restore(),ie}toCanvas(D){return this._toKonvaCanvas(D)._canvas}toDataURL(D){D=D||{};const q=D.mimeType||null,G=D.quality||null,Z=this._toKonvaCanvas(D).toDataURL(q,G);return D.callback&&D.callback(Z),Z}toImage(D){return new Promise((q,G)=>{try{const Z=D?.callback;Z&&delete D.callback,r.Util._urlToImage(this.toDataURL(D),function(Q){q(Q),Z?.(Q)})}catch(Z){G(Z)}})}toBlob(D){return new Promise((q,G)=>{try{const Z=D?.callback;Z&&delete D.callback,this.toCanvas(D).toBlob(Q=>{q(Q),Z?.(Q)},D?.mimeType,D?.quality)}catch(Z){G(Z)}})}setSize(D){return this.width(D.width),this.height(D.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():i.Konva.dragDistance}_off(D,q,G){let Z=this.eventListeners[D],Q,J,ie;for(Q=0;Q<Z.length;Q++)if(J=Z[Q].name,ie=Z[Q].handler,(J!=="konva"||q==="konva")&&(!q||J===q)&&(!G||G===ie)){if(Z.splice(Q,1),Z.length===0){delete this.eventListeners[D];break}Q--}}_fireChangeEvent(D,q,G){this._fire(D+p,{oldVal:q,newVal:G})}addName(D){if(!this.hasName(D)){const q=this.name(),G=q?q+" "+D:D;this.name(G)}return this}hasName(D){if(!D)return!1;const q=this.name();return q?(q||"").split(/\s/g).indexOf(D)!==-1:!1}removeName(D){const q=(this.name()||"").split(/\s/g),G=q.indexOf(D);return G!==-1&&(q.splice(G,1),this.name(q.join(" "))),this}setAttr(D,q){const G=this[T+r.Util._capitalize(D)];return r.Util._isFunction(G)?G.call(this,q):this._setAttr(D,q),this}_requestDraw(){if(i.Konva.autoDrawEnabled){const D=this.getLayer()||this.getStage();D?.batchDraw()}}_setAttr(D,q){const G=this.attrs[D];G===q&&!r.Util.isObject(q)||(q==null?delete this.attrs[D]:this.attrs[D]=q,this._shouldFireChangeEvents&&this._fireChangeEvent(D,G,q),this._requestDraw())}_setComponentAttr(D,q,G){let Z;G!==void 0&&(Z=this.attrs[D],Z||(this.attrs[D]=this.getAttr(D)),this.attrs[D][q]=G,this._fireChangeEvent(D,Z,G))}_fireAndBubble(D,q,G){if(q&&this.nodeType===C&&(q.target=this),!((D===S||D===k)&&(G&&(this===G||this.isAncestorOf&&this.isAncestorOf(G))||this.nodeType==="Stage"&&!G))){this._fire(D,q);const Q=(D===S||D===k)&&G&&G.isAncestorOf&&G.isAncestorOf(this)&&!G.isAncestorOf(this.parent);(q&&!q.cancelBubble||!q)&&this.parent&&this.parent.isListening()&&!Q&&(G&&G.parent?this._fireAndBubble.call(this.parent,D,q,G):this._fireAndBubble.call(this.parent,D,q))}}_getProtoListeners(D){var q,G,Z;const Q=(q=this._cache.get(l))!==null&&q!==void 0?q:{};let J=Q?.[D];if(J===void 0){J=[];let ie=Object.getPrototypeOf(this);for(;ie;){const ne=(Z=(G=ie.eventListeners)===null||G===void 0?void 0:G[D])!==null&&Z!==void 0?Z:[];J.push(...ne),ie=Object.getPrototypeOf(ie)}Q[D]=J,this._cache.set(l,Q)}return J}_fire(D,q){q=q||{},q.currentTarget=this,q.type=D;const G=this._getProtoListeners(D);if(G)for(var Z=0;Z<G.length;Z++)G[Z].handler.call(this,q);const Q=this.eventListeners[D];if(Q)for(var Z=0;Z<Q.length;Z++)Q[Z].handler.call(this,q)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(D){const q=D?D.pointerId:void 0,G=this.getStage(),Z=this.getAbsolutePosition();if(!G)return;const Q=G._getPointerById(q)||G._changedPointerPositions[0]||Z;a.DD._dragElements.set(this._id,{node:this,startPointerPos:Q,offset:{x:Q.x-Z.x,y:Q.y-Z.y},dragStatus:"ready",pointerId:q})}startDrag(D,q=!0){a.DD._dragElements.has(this._id)||this._createDragElement(D);const G=a.DD._dragElements.get(this._id);G.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:D&&D.evt},q)}_setDragPosition(D,q){const G=this.getStage()._getPointerById(q.pointerId);if(!G)return;let Z={x:G.x-q.offset.x,y:G.y-q.offset.y};const Q=this.dragBoundFunc();if(Q!==void 0){const J=Q.call(this,Z,D);J?Z=J:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==Z.x||this._lastPos.y!==Z.y)&&(this.setAbsolutePosition(Z),this._requestDraw()),this._lastPos=Z}stopDrag(D){const q=a.DD._dragElements.get(this._id);q&&(q.dragStatus="stopped"),a.DD._endDragBefore(D),a.DD._endDragAfter(D)}setDraggable(D){this._setAttr("draggable",D),this._dragChange()}isDragging(){const D=a.DD._dragElements.get(this._id);return D?D.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(D){if(!(!(D.evt.button!==void 0)||i.Konva.dragButtons.indexOf(D.evt.button)>=0)||this.isDragging())return;let Z=!1;a.DD._dragElements.forEach(Q=>{this.isAncestorOf(Q.node)&&(Z=!0)}),Z||this._createDragElement(D)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const q=a.DD._dragElements.get(this._id),G=q&&q.dragStatus==="dragging",Z=q&&q.dragStatus==="ready";G?this.stopDrag():Z&&a.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(D={x:0,y:0}){const q=this.getStage();if(!q)return!1;const G={x:-D.x,y:-D.y,width:q.width()+2*D.x,height:q.height()+2*D.y};return r.Util.haveIntersection(G,this.getClientRect())}static create(D,q){return r.Util._isString(D)&&(D=JSON.parse(D)),this._createNode(D,q)}static _createNode(D,q){let G=V.prototype.getClassName.call(D),Z=D.children,Q,J,ie;q&&(D.attrs.container=q),i.Konva[G]||(r.Util.warn('Can not find a node with class name "'+G+'". Fallback to "Shape".'),G="Shape");const ne=i.Konva[G];if(Q=new ne(D.attrs),Z)for(J=Z.length,ie=0;ie<J;ie++)Q.add(V._createNode(Z[ie]));return Q}}gm.Node=V,V.prototype.nodeType="Node",V.prototype._attrsAffectingSize=[],V.prototype.eventListeners={},V.prototype.on.call(V.prototype,I,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(R),this._clearSelfAndDescendantCache(u)}),V.prototype.on.call(V.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(B)}),V.prototype.on.call(V.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(b)}),V.prototype.on.call(V.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(o)});const $=e.Factory.addGetterSetter;return $(V,"zIndex"),$(V,"absolutePosition"),$(V,"position"),$(V,"x",0,(0,s.getNumberValidator)()),$(V,"y",0,(0,s.getNumberValidator)()),$(V,"globalCompositeOperation","source-over",(0,s.getStringValidator)()),$(V,"opacity",1,(0,s.getNumberValidator)()),$(V,"name","",(0,s.getStringValidator)()),$(V,"id","",(0,s.getStringValidator)()),$(V,"rotation",0,(0,s.getNumberValidator)()),e.Factory.addComponentsGetterSetter(V,"scale",["x","y"]),$(V,"scaleX",1,(0,s.getNumberValidator)()),$(V,"scaleY",1,(0,s.getNumberValidator)()),e.Factory.addComponentsGetterSetter(V,"skew",["x","y"]),$(V,"skewX",0,(0,s.getNumberValidator)()),$(V,"skewY",0,(0,s.getNumberValidator)()),e.Factory.addComponentsGetterSetter(V,"offset",["x","y"]),$(V,"offsetX",0,(0,s.getNumberValidator)()),$(V,"offsetY",0,(0,s.getNumberValidator)()),$(V,"dragDistance",null,(0,s.getNumberValidator)()),$(V,"width",0,(0,s.getNumberValidator)()),$(V,"height",0,(0,s.getNumberValidator)()),$(V,"listening",!0,(0,s.getBooleanValidator)()),$(V,"preventDefault",!0,(0,s.getBooleanValidator)()),$(V,"filters",null,function(Y){return this._filterUpToDate=!1,Y}),$(V,"visible",!0,(0,s.getBooleanValidator)()),$(V,"transformsEnabled","all",(0,s.getStringValidator)()),$(V,"size"),$(V,"dragBoundFunc"),$(V,"draggable",!1,(0,s.getBooleanValidator)()),e.Factory.backCompat(V,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),gm}var vm={},FN;function jx(){if(FN)return vm;FN=1,Object.defineProperty(vm,"__esModule",{value:!0}),vm.Container=void 0;const r=fr(),e=oi(),n=gr();let i=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(s){if(!s)return this.children||[];const o=this.children||[],l=[];return o.forEach(function(u){s(u)&&l.push(u)}),l}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(s=>{s.parent=null,s.index=0,s.destroy()}),this.children=[],this._requestDraw(),this}add(...s){if(s.length===0)return this;if(s.length>1){for(let l=0;l<s.length;l++)this.add(s[l]);return this}const o=s[0];return o.getParent()?(o.moveTo(this),this):(this._validateAdd(o),o.index=this.getChildren().length,o.parent=this,o._clearCaches(),this.getChildren().push(o),this._fire("add",{child:o}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(s){return this._generalFind(s,!1)}findOne(s){const o=this._generalFind(s,!0);return o.length>0?o[0]:void 0}_generalFind(s,o){const l=[];return this._descendants(u=>{const c=u._isMatch(s);return c&&l.push(u),!!(c&&o)}),l}_descendants(s){let o=!1;const l=this.getChildren();for(const u of l){if(o=s(u),o)return!0;if(u.hasChildren()&&(o=u._descendants(s),o))return!0}return!1}toObject(){const s=e.Node.prototype.toObject.call(this);return s.children=[],this.getChildren().forEach(o=>{s.children.push(o.toObject())}),s}isAncestorOf(s){let o=s.getParent();for(;o;){if(o._id===this._id)return!0;o=o.getParent()}return!1}clone(s){const o=e.Node.prototype.clone.call(this,s);return this.getChildren().forEach(function(l){o.add(l.clone())}),o}getAllIntersections(s){const o=[];return this.find("Shape").forEach(l=>{l.isVisible()&&l.intersects(s)&&o.push(l)}),o}_clearSelfAndDescendantCache(s){var o;super._clearSelfAndDescendantCache(s),!this.isCached()&&((o=this.children)===null||o===void 0||o.forEach(function(l){l._clearSelfAndDescendantCache(s)}))}_setChildrenIndices(){var s;(s=this.children)===null||s===void 0||s.forEach(function(o,l){o.index=l}),this._requestDraw()}drawScene(s,o,l){const u=this.getLayer(),c=s||u&&u.getCanvas(),d=c&&c.getContext(),p=this._getCanvasCache(),v=p&&p.scene,y=c&&c.isCache;if(!this.isVisible()&&!y)return this;if(v){d.save();const b=this.getAbsoluteTransform(o).getMatrix();d.transform(b[0],b[1],b[2],b[3],b[4],b[5]),this._drawCachedSceneCanvas(d),d.restore()}else this._drawChildren("drawScene",c,o,l);return this}drawHit(s,o){if(!this.shouldDrawHit(o))return this;const l=this.getLayer(),u=s||l&&l.hitCanvas,c=u&&u.getContext(),d=this._getCanvasCache();if(d&&d.hit){c.save();const v=this.getAbsoluteTransform(o).getMatrix();c.transform(v[0],v[1],v[2],v[3],v[4],v[5]),this._drawCachedHitCanvas(c),c.restore()}else this._drawChildren("drawHit",u,o);return this}_drawChildren(s,o,l,u){var c;const d=o&&o.getContext(),p=this.clipWidth(),v=this.clipHeight(),y=this.clipFunc(),b=typeof p=="number"&&typeof v=="number"||y,S=l===this;if(b){d.save();const T=this.getAbsoluteTransform(l);let C=T.getMatrix();d.transform(C[0],C[1],C[2],C[3],C[4],C[5]),d.beginPath();let N;if(y)N=y.call(this,d,this);else{const P=this.clipX(),R=this.clipY();d.rect(P||0,R||0,p,v)}d.clip.apply(d,N),C=T.copy().invert().getMatrix(),d.transform(C[0],C[1],C[2],C[3],C[4],C[5])}const k=!S&&this.globalCompositeOperation()!=="source-over"&&s==="drawScene";k&&(d.save(),d._applyGlobalCompositeOperation(this)),(c=this.children)===null||c===void 0||c.forEach(function(T){T[s](o,l,u)}),k&&d.restore(),b&&d.restore()}getClientRect(s={}){var o;const l=s.skipTransform,u=s.relativeTo;let c,d,p,v,y={x:1/0,y:1/0,width:0,height:0};const b=this;(o=this.children)===null||o===void 0||o.forEach(function(T){if(!T.visible())return;const C=T.getClientRect({relativeTo:b,skipShadow:s.skipShadow,skipStroke:s.skipStroke});C.width===0&&C.height===0||(c===void 0?(c=C.x,d=C.y,p=C.x+C.width,v=C.y+C.height):(c=Math.min(c,C.x),d=Math.min(d,C.y),p=Math.max(p,C.x+C.width),v=Math.max(v,C.y+C.height)))});const S=this.find("Shape");let k=!1;for(let T=0;T<S.length;T++)if(S[T]._isVisible(this)){k=!0;break}return k&&c!==void 0?y={x:c,y:d,width:p-c,height:v-d}:y={x:0,y:0,width:0,height:0},l?y:this._transformedRect(y,u)}};return vm.Container=i,r.Factory.addComponentsGetterSetter(i,"clip",["x","y","width","height"]),r.Factory.addGetterSetter(i,"clipX",void 0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(i,"clipY",void 0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(i,"clipWidth",void 0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(i,"clipHeight",void 0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(i,"clipFunc"),vm}var xw={},Kc={},VN;function pM(){if(VN)return Kc;VN=1,Object.defineProperty(Kc,"__esModule",{value:!0}),Kc.getCapturedShape=i,Kc.createEvent=a,Kc.hasPointerCapture=s,Kc.setPointerCapture=o,Kc.releaseCapture=l;const r=ur(),e=new Map,n=r.Konva._global.PointerEvent!==void 0;function i(u){return e.get(u)}function a(u){return{evt:u,pointerId:u.pointerId}}function s(u,c){return e.get(u)===c}function o(u,c){l(u),c.getStage()&&(e.set(u,c),n&&c._fire("gotpointercapture",a(new PointerEvent("gotpointercapture"))))}function l(u,c){const d=e.get(u);if(!d)return;const p=d.getStage();p&&p.content,e.delete(u),n&&d._fire("lostpointercapture",a(new PointerEvent("lostpointercapture")))}return Kc}var UN;function Nz(){return UN||(UN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Stage=r.stages=void 0;const e=Yn(),n=fr(),i=jx(),a=ur(),s=Ax(),o=Q_(),l=ur(),u=pM(),c="Stage",d="string",p="px",v="mouseout",y="mouseleave",b="mouseover",S="mouseenter",k="mousemove",T="mousedown",C="mouseup",N="pointermove",P="pointerdown",R="pointerup",O="pointercancel",B="lostpointercapture",I="pointerout",z="pointerleave",V="pointerover",$="pointerenter",Y="contextmenu",D="touchstart",q="touchend",G="touchmove",Z="touchcancel",Q="wheel",J=5,ie=[[S,"_pointerenter"],[T,"_pointerdown"],[k,"_pointermove"],[C,"_pointerup"],[y,"_pointerleave"],[D,"_pointerdown"],[G,"_pointermove"],[q,"_pointerup"],[Z,"_pointercancel"],[b,"_pointerover"],[Q,"_wheel"],[Y,"_contextmenu"],[P,"_pointerdown"],[N,"_pointermove"],[R,"_pointerup"],[O,"_pointercancel"],[B,"_lostpointercapture"]],ne={mouse:{[I]:v,[z]:y,[V]:b,[$]:S,[N]:k,[P]:T,[R]:C,[O]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[I]:"touchout",[z]:"touchleave",[V]:"touchover",[$]:"touchenter",[N]:G,[P]:D,[R]:q,[O]:Z,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[I]:I,[z]:z,[V]:V,[$]:$,[N]:N,[P]:P,[R]:R,[O]:O,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},W=xe=>xe.indexOf("pointer")>=0?"pointer":xe.indexOf("touch")>=0?"touch":"mouse",re=xe=>{const se=W(xe);if(se==="pointer")return a.Konva.pointerEventsEnabled&&ne.pointer;if(se==="touch")return ne.touch;if(se==="mouse")return ne.mouse};function ae(xe={}){return(xe.clipFunc||xe.clipWidth||xe.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),xe}const he="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";r.stages=[];class ve extends i.Container{constructor(se){super(ae(se)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),r.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ae(this.attrs)}),this._checkVisibility()}_validateAdd(se){const ge=se.getType()==="Layer",le=se.getType()==="FastLayer";ge||le||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const se=this.visible()?"":"none";this.content.style.display=se}setContainer(se){if(typeof se===d){if(se.charAt(0)==="."){const le=se.slice(1);se=document.getElementsByClassName(le)[0]}else{var ge;se.charAt(0)!=="#"?ge=se:ge=se.slice(1),se=document.getElementById(ge)}if(!se)throw"Can not find container in document with id "+ge}return this._setAttr("container",se),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),se.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let se=this.children,ge=se.length,le;for(le=0;le<ge;le++)se[le].clear();return this}clone(se){return se||(se={}),se.container=typeof document<"u"&&document.createElement("div"),i.Container.prototype.clone.call(this,se)}destroy(){super.destroy();const se=this.content;se&&e.Util._isInDocument(se)&&this.container().removeChild(se);const ge=r.stages.indexOf(this);return ge>-1&&r.stages.splice(ge,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const se=this._pointerPositions[0]||this._changedPointerPositions[0];return se?{x:se.x,y:se.y}:(e.Util.warn(he),null)}_getPointerById(se){return this._pointerPositions.find(ge=>ge.id===se)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(se){se=se||{},se.x=se.x||0,se.y=se.y||0,se.width=se.width||this.width(),se.height=se.height||this.height();const ge=new s.SceneCanvas({width:se.width,height:se.height,pixelRatio:se.pixelRatio||1}),le=ge.getContext()._context,pe=this.children;return(se.x||se.y)&&le.translate(-1*se.x,-1*se.y),pe.forEach(function(me){if(!me.isVisible())return;const be=me._toKonvaCanvas(se);le.drawImage(be._canvas,se.x,se.y,be.getWidth()/be.getPixelRatio(),be.getHeight()/be.getPixelRatio())}),ge}getIntersection(se){if(!se)return null;let ge=this.children,le=ge.length,pe=le-1,me;for(me=pe;me>=0;me--){const be=ge[me].getIntersection(se);if(be)return be}return null}_resizeDOM(){const se=this.width(),ge=this.height();this.content&&(this.content.style.width=se+p,this.content.style.height=ge+p),this.bufferCanvas.setSize(se,ge),this.bufferHitCanvas.setSize(se,ge),this.children.forEach(le=>{le.setSize({width:se,height:ge}),le.draw()})}add(se,...ge){if(arguments.length>1){for(let pe=0;pe<arguments.length;pe++)this.add(arguments[pe]);return this}super.add(se);const le=this.children.length;return le>J&&e.Util.warn("The stage has "+le+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),se.setSize({width:this.width(),height:this.height()}),se.draw(),a.Konva.isBrowser&&this.content.appendChild(se.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(se){return u.hasPointerCapture(se,this)}setPointerCapture(se){u.setPointerCapture(se,this)}releaseCapture(se){u.releaseCapture(se,this)}getLayers(){return this.children}_bindContentEvents(){a.Konva.isBrowser&&ie.forEach(([se,ge])=>{this.content.addEventListener(se,le=>{this[ge](le)},{passive:!1})})}_pointerenter(se){this.setPointersPositions(se);const ge=re(se.type);ge&&this._fire(ge.pointerenter,{evt:se,target:this,currentTarget:this})}_pointerover(se){this.setPointersPositions(se);const ge=re(se.type);ge&&this._fire(ge.pointerover,{evt:se,target:this,currentTarget:this})}_getTargetShape(se){let ge=this[se+"targetShape"];return ge&&!ge.getStage()&&(ge=null),ge}_pointerleave(se){const ge=re(se.type),le=W(se.type);if(!ge)return;this.setPointersPositions(se);const pe=this._getTargetShape(le),me=!(a.Konva.isDragging()||a.Konva.isTransforming())||a.Konva.hitOnDragEnabled;pe&&me?(pe._fireAndBubble(ge.pointerout,{evt:se}),pe._fireAndBubble(ge.pointerleave,{evt:se}),this._fire(ge.pointerleave,{evt:se,target:this,currentTarget:this}),this[le+"targetShape"]=null):me&&(this._fire(ge.pointerleave,{evt:se,target:this,currentTarget:this}),this._fire(ge.pointerout,{evt:se,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(se){const ge=re(se.type),le=W(se.type);if(!ge)return;this.setPointersPositions(se);let pe=!1;this._changedPointerPositions.forEach(me=>{const be=this.getIntersection(me);if(o.DD.justDragged=!1,a.Konva["_"+le+"ListenClick"]=!0,!be||!be.isListening()){this[le+"ClickStartShape"]=void 0;return}a.Konva.capturePointerEventsEnabled&&be.setPointerCapture(me.id),this[le+"ClickStartShape"]=be,be._fireAndBubble(ge.pointerdown,{evt:se,pointerId:me.id}),pe=!0;const Se=se.type.indexOf("touch")>=0;be.preventDefault()&&se.cancelable&&Se&&se.preventDefault()}),pe||this._fire(ge.pointerdown,{evt:se,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(se){const ge=re(se.type),le=W(se.type);if(!ge||(a.Konva.isDragging()&&o.DD.node.preventDefault()&&se.cancelable&&se.preventDefault(),this.setPointersPositions(se),!(!(a.Konva.isDragging()||a.Konva.isTransforming())||a.Konva.hitOnDragEnabled)))return;const me={};let be=!1;const Se=this._getTargetShape(le);this._changedPointerPositions.forEach(Ue=>{const We=u.getCapturedShape(Ue.id)||this.getIntersection(Ue),gt=Ue.id,Je={evt:se,pointerId:gt},at=Se!==We;if(at&&Se&&(Se._fireAndBubble(ge.pointerout,{...Je},We),Se._fireAndBubble(ge.pointerleave,{...Je},We)),We){if(me[We._id])return;me[We._id]=!0}We&&We.isListening()?(be=!0,at&&(We._fireAndBubble(ge.pointerover,{...Je},Se),We._fireAndBubble(ge.pointerenter,{...Je},Se),this[le+"targetShape"]=We),We._fireAndBubble(ge.pointermove,{...Je})):Se&&(this._fire(ge.pointerover,{evt:se,target:this,currentTarget:this,pointerId:gt}),this[le+"targetShape"]=null)}),be||this._fire(ge.pointermove,{evt:se,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(se){const ge=re(se.type),le=W(se.type);if(!ge)return;this.setPointersPositions(se);const pe=this[le+"ClickStartShape"],me=this[le+"ClickEndShape"],be={};let Se=!1;this._changedPointerPositions.forEach(Ue=>{const We=u.getCapturedShape(Ue.id)||this.getIntersection(Ue);if(We){if(We.releaseCapture(Ue.id),be[We._id])return;be[We._id]=!0}const gt=Ue.id,Je={evt:se,pointerId:gt};let at=!1;a.Konva["_"+le+"InDblClickWindow"]?(at=!0,clearTimeout(this[le+"DblTimeout"])):o.DD.justDragged||(a.Konva["_"+le+"InDblClickWindow"]=!0,clearTimeout(this[le+"DblTimeout"])),this[le+"DblTimeout"]=setTimeout(function(){a.Konva["_"+le+"InDblClickWindow"]=!1},a.Konva.dblClickWindow),We&&We.isListening()?(Se=!0,this[le+"ClickEndShape"]=We,We._fireAndBubble(ge.pointerup,{...Je}),a.Konva["_"+le+"ListenClick"]&&pe&&pe===We&&(We._fireAndBubble(ge.pointerclick,{...Je}),at&&me&&me===We&&We._fireAndBubble(ge.pointerdblclick,{...Je}))):(this[le+"ClickEndShape"]=null,a.Konva["_"+le+"ListenClick"]&&this._fire(ge.pointerclick,{evt:se,target:this,currentTarget:this,pointerId:gt}),at&&this._fire(ge.pointerdblclick,{evt:se,target:this,currentTarget:this,pointerId:gt}))}),Se||this._fire(ge.pointerup,{evt:se,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a.Konva["_"+le+"ListenClick"]=!1,se.cancelable&&le!=="touch"&&se.preventDefault()}_contextmenu(se){this.setPointersPositions(se);const ge=this.getIntersection(this.getPointerPosition());ge&&ge.isListening()?ge._fireAndBubble(Y,{evt:se}):this._fire(Y,{evt:se,target:this,currentTarget:this})}_wheel(se){this.setPointersPositions(se);const ge=this.getIntersection(this.getPointerPosition());ge&&ge.isListening()?ge._fireAndBubble(Q,{evt:se}):this._fire(Q,{evt:se,target:this,currentTarget:this})}_pointercancel(se){this.setPointersPositions(se);const ge=u.getCapturedShape(se.pointerId)||this.getIntersection(this.getPointerPosition());ge&&ge._fireAndBubble(R,u.createEvent(se)),u.releaseCapture(se.pointerId)}_lostpointercapture(se){u.releaseCapture(se.pointerId)}setPointersPositions(se){let ge=this._getContentPosition(),le=null,pe=null;se=se||window.event,se.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(se.touches,me=>{this._pointerPositions.push({id:me.identifier,x:(me.clientX-ge.left)/ge.scaleX,y:(me.clientY-ge.top)/ge.scaleY})}),Array.prototype.forEach.call(se.changedTouches||se.touches,me=>{this._changedPointerPositions.push({id:me.identifier,x:(me.clientX-ge.left)/ge.scaleX,y:(me.clientY-ge.top)/ge.scaleY})})):(le=(se.clientX-ge.left)/ge.scaleX,pe=(se.clientY-ge.top)/ge.scaleY,this.pointerPos={x:le,y:pe},this._pointerPositions=[{x:le,y:pe,id:e.Util._getFirstPointerId(se)}],this._changedPointerPositions=[{x:le,y:pe,id:e.Util._getFirstPointerId(se)}])}_setPointerPosition(se){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(se)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const se=this.content.getBoundingClientRect();return{top:se.top,left:se.left,scaleX:se.width/this.content.clientWidth||1,scaleY:se.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new s.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new s.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!a.Konva.isBrowser)return;const se=this.container();if(!se)throw"Stage has no container. A container is required.";se.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),se.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(se){se.batchDraw()}),this}}r.Stage=ve,ve.prototype.nodeType=c,(0,l._registerNode)(ve),n.Factory.addGetterSetter(ve,"container"),a.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{r.stages.forEach(xe=>{xe.batchDraw()})})})(xw)),xw}var ym={},bw={},HN;function ta(){return HN||(HN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Shape=r.shapes=void 0;const e=ur(),n=Yn(),i=fr(),a=oi(),s=gr(),o=ur(),l=pM(),u="hasShadow",c="shadowRGBA",d="patternImage",p="linearGradient",v="radialGradient";let y;function b(){return y||(y=n.Util.createCanvasElement().getContext("2d"),y)}r.shapes={};function S(z){const V=this.attrs.fillRule;V?z.fill(V):z.fill()}function k(z){z.stroke()}function T(z){const V=this.attrs.fillRule;V?z.fill(V):z.fill()}function C(z){z.stroke()}function N(){this._clearCache(u)}function P(){this._clearCache(c)}function R(){this._clearCache(d)}function O(){this._clearCache(p)}function B(){this._clearCache(v)}class I extends a.Node{constructor(V){super(V);let $;for(;$=n.Util.getRandomColor(),!($&&!($ in r.shapes)););this.colorKey=$,r.shapes[$]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(u,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const $=b().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if($&&$.setTransform){const Y=new n.Transform;Y.translate(this.fillPatternX(),this.fillPatternY()),Y.rotate(e.Konva.getAngle(this.fillPatternRotation())),Y.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),Y.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const D=Y.getMatrix(),q=typeof DOMMatrix>"u"?{a:D[0],b:D[1],c:D[2],d:D[3],e:D[4],f:D[5]}:new DOMMatrix(D);$.setTransform(q)}return $}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const V=this.fillLinearGradientColorStops();if(V){const $=b(),Y=this.fillLinearGradientStartPoint(),D=this.fillLinearGradientEndPoint(),q=$.createLinearGradient(Y.x,Y.y,D.x,D.y);for(let G=0;G<V.length;G+=2)q.addColorStop(V[G],V[G+1]);return q}}_getRadialGradient(){return this._getCache(v,this.__getRadialGradient)}__getRadialGradient(){const V=this.fillRadialGradientColorStops();if(V){const $=b(),Y=this.fillRadialGradientStartPoint(),D=this.fillRadialGradientEndPoint(),q=$.createRadialGradient(Y.x,Y.y,this.fillRadialGradientStartRadius(),D.x,D.y,this.fillRadialGradientEndRadius());for(let G=0;G<V.length;G+=2)q.addColorStop(V[G],V[G+1]);return q}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const V=n.Util.colorToRGBA(this.shadowColor());if(V)return"rgba("+V.r+","+V.g+","+V.b+","+V.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const V=this.hitStrokeWidth();return V==="auto"?this.hasStroke():this.strokeEnabled()&&!!V}intersects(V){const $=this.getStage();if(!$)return!1;const Y=$.bufferHitCanvas;return Y.getContext().clear(),this.drawHit(Y,void 0,!0),Y.context.getImageData(Math.round(V.x),Math.round(V.y),1,1).data[3]>0}destroy(){return a.Node.prototype.destroy.call(this),delete r.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(V){var $;if(!(($=this.attrs.perfectDrawEnabled)!==null&&$!==void 0?$:!0))return!1;const D=V||this.hasFill(),q=this.hasStroke(),G=this.getAbsoluteOpacity()!==1;if(D&&q&&G)return!0;const Z=this.hasShadow(),Q=this.shadowForStrokeEnabled();return!!(D&&q&&Z&&Q)}setStrokeHitEnabled(V){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),V?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const V=this.size();return{x:this._centroid?-V.width/2:0,y:this._centroid?-V.height/2:0,width:V.width,height:V.height}}getClientRect(V={}){let $=!1,Y=this.getParent();for(;Y;){if(Y.isCached()){$=!0;break}Y=Y.getParent()}const D=V.skipTransform,q=V.relativeTo||$&&this.getStage()||void 0,G=this.getSelfRect(),Q=!V.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,J=G.width+Q,ie=G.height+Q,ne=!V.skipShadow&&this.hasShadow(),W=ne?this.shadowOffsetX():0,re=ne?this.shadowOffsetY():0,ae=J+Math.abs(W),he=ie+Math.abs(re),ve=ne&&this.shadowBlur()||0,xe=ae+ve*2,se=he+ve*2,ge={width:xe,height:se,x:-(Q/2+ve)+Math.min(W,0)+G.x,y:-(Q/2+ve)+Math.min(re,0)+G.y};return D?ge:this._transformedRect(ge,q)}drawScene(V,$,Y){const D=this.getLayer();let q=V||D.getCanvas(),G=q.getContext(),Z=this._getCanvasCache(),Q=this.getSceneFunc(),J=this.hasShadow(),ie,ne;const W=q.isCache,re=$===this;if(!this.isVisible()&&!re)return this;if(Z){G.save();const he=this.getAbsoluteTransform($).getMatrix();return G.transform(he[0],he[1],he[2],he[3],he[4],he[5]),this._drawCachedSceneCanvas(G),G.restore(),this}if(!Q)return this;if(G.save(),this._useBufferCanvas()&&!W){ie=this.getStage();const he=Y||ie.bufferCanvas;ne=he.getContext(),ne.clear(),ne.save(),ne._applyLineJoin(this);var ae=this.getAbsoluteTransform($).getMatrix();ne.transform(ae[0],ae[1],ae[2],ae[3],ae[4],ae[5]),Q.call(this,ne,this),ne.restore();const ve=he.pixelRatio;J&&G._applyShadow(this),G._applyOpacity(this),G._applyGlobalCompositeOperation(this),G.drawImage(he._canvas,0,0,he.width/ve,he.height/ve)}else{if(G._applyLineJoin(this),!re){var ae=this.getAbsoluteTransform($).getMatrix();G.transform(ae[0],ae[1],ae[2],ae[3],ae[4],ae[5]),G._applyOpacity(this),G._applyGlobalCompositeOperation(this)}J&&G._applyShadow(this),Q.call(this,G,this)}return G.restore(),this}drawHit(V,$,Y=!1){if(!this.shouldDrawHit($,Y))return this;const D=this.getLayer(),q=V||D.hitCanvas,G=q&&q.getContext(),Z=this.hitFunc()||this.sceneFunc(),Q=this._getCanvasCache(),J=Q&&Q.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),J){G.save();const ne=this.getAbsoluteTransform($).getMatrix();return G.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]),this._drawCachedHitCanvas(G),G.restore(),this}if(!Z)return this;if(G.save(),G._applyLineJoin(this),!(this===$)){const ne=this.getAbsoluteTransform($).getMatrix();G.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5])}return Z.call(this,G,this),G.restore(),this}drawHitFromCache(V=0){let $=this._getCanvasCache(),Y=this._getCachedSceneCanvas(),D=$.hit,q=D.getContext(),G=D.getWidth(),Z=D.getHeight(),Q,J,ie,ne,W,re;q.clear(),q.drawImage(Y._canvas,0,0,G,Z);try{for(Q=q.getImageData(0,0,G,Z),J=Q.data,ie=J.length,ne=n.Util._hexToRgb(this.colorKey),W=0;W<ie;W+=4)re=J[W+3],re>V?(J[W]=ne.r,J[W+1]=ne.g,J[W+2]=ne.b,J[W+3]=255):J[W+3]=0;q.putImageData(Q,0,0)}catch(ae){n.Util.error("Unable to draw hit graph from cached scene canvas. "+ae.message)}return this}hasPointerCapture(V){return l.hasPointerCapture(V,this)}setPointerCapture(V){l.setPointerCapture(V,this)}releaseCapture(V){l.releaseCapture(V,this)}}r.Shape=I,I.prototype._fillFunc=S,I.prototype._strokeFunc=k,I.prototype._fillFuncHit=T,I.prototype._strokeFuncHit=C,I.prototype._centroid=!1,I.prototype.nodeType="Shape",(0,o._registerNode)(I),I.prototype.eventListeners={},I.prototype.on.call(I.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",N),I.prototype.on.call(I.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",P),I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",R),I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",O),I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",B),i.Factory.addGetterSetter(I,"stroke",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(I,"strokeWidth",2,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(I,"fillAfterStrokeEnabled",!1),i.Factory.addGetterSetter(I,"hitStrokeWidth","auto",(0,s.getNumberOrAutoValidator)()),i.Factory.addGetterSetter(I,"strokeHitEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(I,"perfectDrawEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(I,"shadowForStrokeEnabled",!0,(0,s.getBooleanValidator)()),i.Factory.addGetterSetter(I,"lineJoin"),i.Factory.addGetterSetter(I,"lineCap"),i.Factory.addGetterSetter(I,"sceneFunc"),i.Factory.addGetterSetter(I,"hitFunc"),i.Factory.addGetterSetter(I,"dash"),i.Factory.addGetterSetter(I,"dashOffset",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(I,"shadowColor",void 0,(0,s.getStringValidator)()),i.Factory.addGetterSetter(I,"shadowBlur",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(I,"shadowOpacity",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(I,"shadowOffset",["x","y"]),i.Factory.addGetterSetter(I,"shadowOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(I,"shadowOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(I,"fillPatternImage"),i.Factory.addGetterSetter(I,"fill",void 0,(0,s.getStringOrGradientValidator)()),i.Factory.addGetterSetter(I,"fillPatternX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(I,"fillPatternY",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(I,"fillLinearGradientColorStops"),i.Factory.addGetterSetter(I,"strokeLinearGradientColorStops"),i.Factory.addGetterSetter(I,"fillRadialGradientStartRadius",0),i.Factory.addGetterSetter(I,"fillRadialGradientEndRadius",0),i.Factory.addGetterSetter(I,"fillRadialGradientColorStops"),i.Factory.addGetterSetter(I,"fillPatternRepeat","repeat"),i.Factory.addGetterSetter(I,"fillEnabled",!0),i.Factory.addGetterSetter(I,"strokeEnabled",!0),i.Factory.addGetterSetter(I,"shadowEnabled",!0),i.Factory.addGetterSetter(I,"dashEnabled",!0),i.Factory.addGetterSetter(I,"strokeScaleEnabled",!0),i.Factory.addGetterSetter(I,"fillPriority","color"),i.Factory.addComponentsGetterSetter(I,"fillPatternOffset",["x","y"]),i.Factory.addGetterSetter(I,"fillPatternOffsetX",0,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(I,"fillPatternOffsetY",0,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(I,"fillPatternScale",["x","y"]),i.Factory.addGetterSetter(I,"fillPatternScaleX",1,(0,s.getNumberValidator)()),i.Factory.addGetterSetter(I,"fillPatternScaleY",1,(0,s.getNumberValidator)()),i.Factory.addComponentsGetterSetter(I,"fillLinearGradientStartPoint",["x","y"]),i.Factory.addComponentsGetterSetter(I,"strokeLinearGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(I,"fillLinearGradientStartPointX",0),i.Factory.addGetterSetter(I,"strokeLinearGradientStartPointX",0),i.Factory.addGetterSetter(I,"fillLinearGradientStartPointY",0),i.Factory.addGetterSetter(I,"strokeLinearGradientStartPointY",0),i.Factory.addComponentsGetterSetter(I,"fillLinearGradientEndPoint",["x","y"]),i.Factory.addComponentsGetterSetter(I,"strokeLinearGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(I,"fillLinearGradientEndPointX",0),i.Factory.addGetterSetter(I,"strokeLinearGradientEndPointX",0),i.Factory.addGetterSetter(I,"fillLinearGradientEndPointY",0),i.Factory.addGetterSetter(I,"strokeLinearGradientEndPointY",0),i.Factory.addComponentsGetterSetter(I,"fillRadialGradientStartPoint",["x","y"]),i.Factory.addGetterSetter(I,"fillRadialGradientStartPointX",0),i.Factory.addGetterSetter(I,"fillRadialGradientStartPointY",0),i.Factory.addComponentsGetterSetter(I,"fillRadialGradientEndPoint",["x","y"]),i.Factory.addGetterSetter(I,"fillRadialGradientEndPointX",0),i.Factory.addGetterSetter(I,"fillRadialGradientEndPointY",0),i.Factory.addGetterSetter(I,"fillPatternRotation",0),i.Factory.addGetterSetter(I,"fillRule",void 0,(0,s.getStringValidator)()),i.Factory.backCompat(I,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(bw)),bw}var GN;function mM(){if(GN)return ym;GN=1,Object.defineProperty(ym,"__esModule",{value:!0}),ym.Layer=void 0;const r=Yn(),e=jx(),n=oi(),i=fr(),a=Ax(),s=gr(),o=ta(),l=ur(),u="#",c="beforeDraw",d="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],v=p.length;class y extends e.Container{constructor(S){super(S),this.canvas=new a.SceneCanvas,this.hitCanvas=new a.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(S){return this.getContext().clear(S),this.getHitCanvas().getContext().clear(S),this}setZIndex(S){super.setZIndex(S);const k=this.getStage();return k&&k.content&&(k.content.removeChild(this.getNativeCanvasElement()),S<k.children.length-1?k.content.insertBefore(this.getNativeCanvasElement(),k.children[S+1].getCanvas()._canvas):k.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){n.Node.prototype.moveToTop.call(this);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!n.Node.prototype.moveUp.call(this))return!1;const k=this.getStage();return!k||!k.content?!1:(k.content.removeChild(this.getNativeCanvasElement()),this.index<k.children.length-1?k.content.insertBefore(this.getNativeCanvasElement(),k.children[this.index+1].getCanvas()._canvas):k.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(n.Node.prototype.moveDown.call(this)){const S=this.getStage();if(S){const k=S.children;S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.insertBefore(this.getNativeCanvasElement(),k[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(n.Node.prototype.moveToBottom.call(this)){const S=this.getStage();if(S){const k=S.children;S.content&&(S.content.removeChild(this.getNativeCanvasElement()),S.content.insertBefore(this.getNativeCanvasElement(),k[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const S=this.getNativeCanvasElement();return n.Node.prototype.remove.call(this),S&&S.parentNode&&r.Util._isInDocument(S)&&S.parentNode.removeChild(S),this}getStage(){return this.parent}setSize({width:S,height:k}){return this.canvas.setSize(S,k),this.hitCanvas.setSize(S,k),this._setSmoothEnabled(),this}_validateAdd(S){const k=S.getType();k!=="Group"&&k!=="Shape"&&r.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(S){return S=S||{},S.width=S.width||this.getWidth(),S.height=S.height||this.getHeight(),S.x=S.x!==void 0?S.x:this.x(),S.y=S.y!==void 0?S.y:this.y(),n.Node.prototype._toKonvaCanvas.call(this,S)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){r.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){r.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,r.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(S){if(!this.isListening()||!this.isVisible())return null;let k=1,T=!1;for(;;){for(let C=0;C<v;C++){const N=p[C],P=this._getIntersection({x:S.x+N.x*k,y:S.y+N.y*k}),R=P.shape;if(R)return R;if(T=!!P.antialiased,!P.antialiased)break}if(T)k+=1;else return null}}_getIntersection(S){const k=this.hitCanvas.pixelRatio,T=this.hitCanvas.context.getImageData(Math.round(S.x*k),Math.round(S.y*k),1,1).data,C=T[3];if(C===255){const N=r.Util._rgbToHex(T[0],T[1],T[2]),P=o.shapes[u+N];return P?{shape:P}:{antialiased:!0}}else if(C>0)return{antialiased:!0};return{}}drawScene(S,k){const T=this.getLayer(),C=S||T&&T.getCanvas();return this._fire(c,{node:this}),this.clearBeforeDraw()&&C.getContext().clear(),e.Container.prototype.drawScene.call(this,C,k),this._fire(d,{node:this}),this}drawHit(S,k){const T=this.getLayer(),C=S||T&&T.hitCanvas;return T&&T.clearBeforeDraw()&&T.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,C,k),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(S){r.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(S)}getHitGraphEnabled(S){return r.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const S=this.parent;!!this.hitCanvas._canvas.parentNode?S.content.removeChild(this.hitCanvas._canvas):S.content.appendChild(this.hitCanvas._canvas)}destroy(){return r.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return ym.Layer=y,y.prototype.nodeType="Layer",(0,l._registerNode)(y),i.Factory.addGetterSetter(y,"imageSmoothingEnabled",!0),i.Factory.addGetterSetter(y,"clearBeforeDraw",!0),i.Factory.addGetterSetter(y,"hitGraphEnabled",!0,(0,s.getBooleanValidator)()),ym}var xm={},qN;function Tz(){if(qN)return xm;qN=1,Object.defineProperty(xm,"__esModule",{value:!0}),xm.FastLayer=void 0;const r=Yn(),e=mM(),n=ur();let i=class extends e.Layer{constructor(s){super(s),this.listening(!1),r.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return xm.FastLayer=i,i.prototype.nodeType="FastLayer",(0,n._registerNode)(i),xm}var bm={},WN;function J_(){if(WN)return bm;WN=1,Object.defineProperty(bm,"__esModule",{value:!0}),bm.Group=void 0;const r=Yn(),e=jx(),n=ur();let i=class extends e.Container{_validateAdd(s){const o=s.getType();o!=="Group"&&o!=="Shape"&&r.Util.throw("You may only add groups and shapes to groups.")}};return bm.Group=i,i.prototype.nodeType="Group",(0,n._registerNode)(i),bm}var wm={},$N;function eS(){if($N)return wm;$N=1,Object.defineProperty(wm,"__esModule",{value:!0}),wm.Animation=void 0;const r=ur(),e=Yn(),n=(function(){return r.glob.performance&&r.glob.performance.now?function(){return r.glob.performance.now()}:function(){return new Date().getTime()}})();let i=class $f{constructor(s,o){this.id=$f.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n(),frameRate:0},this.func=s,this.setLayers(o)}setLayers(s){let o=[];return s&&(o=Array.isArray(s)?s:[s]),this.layers=o,this}getLayers(){return this.layers}addLayer(s){const o=this.layers,l=o.length;for(let u=0;u<l;u++)if(o[u]._id===s._id)return!1;return this.layers.push(s),!0}isRunning(){const o=$f.animations,l=o.length;for(let u=0;u<l;u++)if(o[u].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n(),$f._addAnimation(this),this}stop(){return $f._removeAnimation(this),this}_updateFrameObject(s){this.frame.timeDiff=s-this.frame.lastTime,this.frame.lastTime=s,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(s){this.animations.push(s),this._handleAnimation()}static _removeAnimation(s){const o=s.id,l=this.animations,u=l.length;for(let c=0;c<u;c++)if(l[c].id===o){this.animations.splice(c,1);break}}static _runFrames(){const s={},o=this.animations;for(let l=0;l<o.length;l++){const u=o[l],c=u.layers,d=u.func;u._updateFrameObject(n());const p=c.length;let v;if(d?v=d.call(u,u.frame)!==!1:v=!0,!!v)for(let y=0;y<p;y++){const b=c[y];b._id!==void 0&&(s[b._id]=b)}}for(const l in s)s.hasOwnProperty(l)&&s[l].batchDraw()}static _animationLoop(){const s=$f;s.animations.length?(s._runFrames(),e.Util.requestAnimFrame(s._animationLoop)):s.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return wm.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1,wm}var ww={},KN;function Pz(){return KN||(KN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Easings=r.Tween=void 0;const e=Yn(),n=eS(),i=oi(),a=ur();let s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,l=2,u=3,c=0,d=["fill","stroke","shadowColor"];class p{constructor(b,S,k,T,C,N,P){this.prop=b,this.propFunc=S,this.begin=T,this._pos=T,this.duration=N,this._change=0,this.prevPos=0,this.yoyo=P,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=k,this._change=C-this.begin,this.pause()}fire(b){const S=this[b];S&&S()}setTime(b){b>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():b<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=b,this.update())}getTime(){return this._time}setPosition(b){this.prevPos=this._pos,this.propFunc(b),this._pos=b}getPosition(b){return b===void 0&&(b=this._time),this.func(b,this.begin,this._change,this.duration)}play(){this.state=l,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=u,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(b){this.pause(),this._time=b,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const b=this.getTimer()-this._startTime;this.state===l?this.setTime(b):this.state===u&&this.setTime(this.duration-b)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class v{constructor(b){let S=this,k=b.node,T=k._id,C,N=b.easing||r.Easings.Linear,P=!!b.yoyo,R;typeof b.duration>"u"?C=.3:b.duration===0?C=.001:C=b.duration,this.node=k,this._id=c++;const O=k.getLayer()||(k instanceof a.Konva.Stage?k.getLayers():null);O||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){S.tween.onEnterFrame()},O),this.tween=new p(R,function(B){S._tweenFunc(B)},N,0,1,C*1e3,P),this._addListeners(),v.attrs[T]||(v.attrs[T]={}),v.attrs[T][this._id]||(v.attrs[T][this._id]={}),v.tweens[T]||(v.tweens[T]={});for(R in b)s[R]===void 0&&this._addAttr(R,b[R]);this.reset(),this.onFinish=b.onFinish,this.onReset=b.onReset,this.onUpdate=b.onUpdate}_addAttr(b,S){let k=this.node,T=k._id,C,N,P,R,O,B,I,z;if(P=v.tweens[T][b],P&&delete v.attrs[T][P][b],C=k.getAttr(b),e.Util._isArray(S))if(N=[],O=Math.max(S.length,C.length),b==="points"&&S.length!==C.length&&(S.length>C.length?(I=C,C=e.Util._prepareArrayForTween(C,S,k.closed())):(B=S,S=e.Util._prepareArrayForTween(S,C,k.closed()))),b.indexOf("fill")===0)for(R=0;R<O;R++)if(R%2===0)N.push(S[R]-C[R]);else{const V=e.Util.colorToRGBA(C[R]);z=e.Util.colorToRGBA(S[R]),C[R]=V,N.push({r:z.r-V.r,g:z.g-V.g,b:z.b-V.b,a:z.a-V.a})}else for(R=0;R<O;R++)N.push(S[R]-C[R]);else d.indexOf(b)!==-1?(C=e.Util.colorToRGBA(C),z=e.Util.colorToRGBA(S),N={r:z.r-C.r,g:z.g-C.g,b:z.b-C.b,a:z.a-C.a}):N=S-C;v.attrs[T][this._id][b]={start:C,diff:N,end:S,trueEnd:B,trueStart:I},v.tweens[T][b]=this._id}_tweenFunc(b){let S=this.node,k=v.attrs[S._id][this._id],T,C,N,P,R,O,B,I;for(T in k){if(C=k[T],N=C.start,P=C.diff,I=C.end,e.Util._isArray(N))if(R=[],B=Math.max(N.length,I.length),T.indexOf("fill")===0)for(O=0;O<B;O++)O%2===0?R.push((N[O]||0)+P[O]*b):R.push("rgba("+Math.round(N[O].r+P[O].r*b)+","+Math.round(N[O].g+P[O].g*b)+","+Math.round(N[O].b+P[O].b*b)+","+(N[O].a+P[O].a*b)+")");else for(O=0;O<B;O++)R.push((N[O]||0)+P[O]*b);else d.indexOf(T)!==-1?R="rgba("+Math.round(N.r+P.r*b)+","+Math.round(N.g+P.g*b)+","+Math.round(N.b+P.b*b)+","+(N.a+P.a*b)+")":R=N+P*b;S.setAttr(T,R)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const b=this.node,S=v.attrs[b._id][this._id];S.points&&S.points.trueEnd&&b.setAttr("points",S.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const b=this.node,S=v.attrs[b._id][this._id];S.points&&S.points.trueStart&&b.points(S.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(b){return this.tween.seek(b*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let b=this.node._id,S=this._id,k=v.tweens[b],T;this.pause();for(T in k)delete v.tweens[b][T];delete v.attrs[b][S]}}r.Tween=v,v.attrs={},v.tweens={},i.Node.prototype.to=function(y){const b=y.onFinish;y.node=this,y.onFinish=function(){this.destroy(),b&&b()},new v(y).play()},r.Easings={BackEaseIn(y,b,S,k){return S*(y/=k)*y*((1.70158+1)*y-1.70158)+b},BackEaseOut(y,b,S,k){return S*((y=y/k-1)*y*((1.70158+1)*y+1.70158)+1)+b},BackEaseInOut(y,b,S,k){let T=1.70158;return(y/=k/2)<1?S/2*(y*y*(((T*=1.525)+1)*y-T))+b:S/2*((y-=2)*y*(((T*=1.525)+1)*y+T)+2)+b},ElasticEaseIn(y,b,S,k,T,C){let N=0;return y===0?b:(y/=k)===1?b+S:(C||(C=k*.3),!T||T<Math.abs(S)?(T=S,N=C/4):N=C/(2*Math.PI)*Math.asin(S/T),-(T*Math.pow(2,10*(y-=1))*Math.sin((y*k-N)*(2*Math.PI)/C))+b)},ElasticEaseOut(y,b,S,k,T,C){let N=0;return y===0?b:(y/=k)===1?b+S:(C||(C=k*.3),!T||T<Math.abs(S)?(T=S,N=C/4):N=C/(2*Math.PI)*Math.asin(S/T),T*Math.pow(2,-10*y)*Math.sin((y*k-N)*(2*Math.PI)/C)+S+b)},ElasticEaseInOut(y,b,S,k,T,C){let N=0;return y===0?b:(y/=k/2)===2?b+S:(C||(C=k*(.3*1.5)),!T||T<Math.abs(S)?(T=S,N=C/4):N=C/(2*Math.PI)*Math.asin(S/T),y<1?-.5*(T*Math.pow(2,10*(y-=1))*Math.sin((y*k-N)*(2*Math.PI)/C))+b:T*Math.pow(2,-10*(y-=1))*Math.sin((y*k-N)*(2*Math.PI)/C)*.5+S+b)},BounceEaseOut(y,b,S,k){return(y/=k)<1/2.75?S*(7.5625*y*y)+b:y<2/2.75?S*(7.5625*(y-=1.5/2.75)*y+.75)+b:y<2.5/2.75?S*(7.5625*(y-=2.25/2.75)*y+.9375)+b:S*(7.5625*(y-=2.625/2.75)*y+.984375)+b},BounceEaseIn(y,b,S,k){return S-r.Easings.BounceEaseOut(k-y,0,S,k)+b},BounceEaseInOut(y,b,S,k){return y<k/2?r.Easings.BounceEaseIn(y*2,0,S,k)*.5+b:r.Easings.BounceEaseOut(y*2-k,0,S,k)*.5+S*.5+b},EaseIn(y,b,S,k){return S*(y/=k)*y+b},EaseOut(y,b,S,k){return-S*(y/=k)*(y-2)+b},EaseInOut(y,b,S,k){return(y/=k/2)<1?S/2*y*y+b:-S/2*(--y*(y-2)-1)+b},StrongEaseIn(y,b,S,k){return S*(y/=k)*y*y*y*y+b},StrongEaseOut(y,b,S,k){return S*((y=y/k-1)*y*y*y*y+1)+b},StrongEaseInOut(y,b,S,k){return(y/=k/2)<1?S/2*y*y*y*y*y+b:S/2*((y-=2)*y*y*y*y+2)+b},Linear(y,b,S,k){return S*y/k+b}}})(ww)),ww}var ZN;function I2(){return ZN||(ZN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Konva=void 0;const e=ur(),n=Yn(),i=oi(),a=jx(),s=Nz(),o=mM(),l=Tz(),u=J_(),c=Q_(),d=ta(),p=eS(),v=Pz(),y=fM(),b=Ax();r.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:i.Node,Container:a.Container,Stage:s.Stage,stages:s.stages,Layer:o.Layer,FastLayer:l.FastLayer,Group:u.Group,DD:c.DD,Shape:d.Shape,shapes:d.shapes,Animation:p.Animation,Tween:v.Tween,Easings:v.Easings,Context:y.Context,Canvas:b.Canvas}),r.default=r.Konva})(pw)),pw}var _m={},YN;function Mz(){if(YN)return _m;YN=1,Object.defineProperty(_m,"__esModule",{value:!0}),_m.Arc=void 0;const r=fr(),e=ta(),n=ur(),i=gr(),a=ur();let s=class extends e.Shape{_sceneFunc(l){const u=n.Konva.getAngle(this.angle()),c=this.clockwise();l.beginPath(),l.arc(0,0,this.outerRadius(),0,u,c),l.arc(0,0,this.innerRadius(),u,0,!c),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(l){this.outerRadius(l/2)}setHeight(l){this.outerRadius(l/2)}getSelfRect(){const l=this.innerRadius(),u=this.outerRadius(),c=this.clockwise(),d=n.Konva.getAngle(c?360-this.angle():this.angle()),p=Math.cos(Math.min(d,Math.PI)),v=1,y=Math.sin(Math.min(Math.max(Math.PI,d),3*Math.PI/2)),b=Math.sin(Math.min(d,Math.PI/2)),S=p*(p>0?l:u),k=v*u,T=y*(y>0?l:u),C=b*(b>0?u:l);return{x:S,y:c?-1*C:T,width:k-S,height:C-T}}};return _m.Arc=s,s.prototype._centroid=!0,s.prototype.className="Arc",s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,a._registerNode)(s),r.Factory.addGetterSetter(s,"innerRadius",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(s,"outerRadius",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(s,"clockwise",!1,(0,i.getBooleanValidator)()),_m}var Sm={},km={},XN;function gM(){if(XN)return km;XN=1,Object.defineProperty(km,"__esModule",{value:!0}),km.Line=void 0;const r=fr(),e=ur(),n=ta(),i=gr();function a(l,u,c,d,p,v,y){const b=Math.sqrt(Math.pow(c-l,2)+Math.pow(d-u,2)),S=Math.sqrt(Math.pow(p-c,2)+Math.pow(v-d,2)),k=y*b/(b+S),T=y*S/(b+S),C=c-k*(p-l),N=d-k*(v-u),P=c+T*(p-l),R=d+T*(v-u);return[C,N,P,R]}function s(l,u){const c=l.length,d=[];for(let p=2;p<c-2;p+=2){const v=a(l[p-2],l[p-1],l[p],l[p+1],l[p+2],l[p+3],u);isNaN(v[0])||(d.push(v[0]),d.push(v[1]),d.push(l[p]),d.push(l[p+1]),d.push(v[2]),d.push(v[3]))}return d}class o extends n.Shape{constructor(u){super(u),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(u){let c=this.points(),d=c.length,p=this.tension(),v=this.closed(),y=this.bezier(),b,S,k;if(d){if(u.beginPath(),u.moveTo(c[0],c[1]),p!==0&&d>4){for(b=this.getTensionPoints(),S=b.length,k=v?0:4,v||u.quadraticCurveTo(b[0],b[1],b[2],b[3]);k<S-2;)u.bezierCurveTo(b[k++],b[k++],b[k++],b[k++],b[k++],b[k++]);v||u.quadraticCurveTo(b[S-2],b[S-1],c[d-2],c[d-1])}else if(y)for(k=2;k<d;)u.bezierCurveTo(c[k++],c[k++],c[k++],c[k++],c[k++],c[k++]);else for(k=2;k<d;k+=2)u.lineTo(c[k],c[k+1]);v?(u.closePath(),u.fillStrokeShape(this)):u.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():s(this.points(),this.tension())}_getTensionPointsClosed(){const u=this.points(),c=u.length,d=this.tension(),p=a(u[c-2],u[c-1],u[0],u[1],u[2],u[3],d),v=a(u[c-4],u[c-3],u[c-2],u[c-1],u[0],u[1],d),y=s(u,d);return[p[2],p[3]].concat(y).concat([v[0],v[1],u[c-2],u[c-1],v[2],v[3],p[0],p[1],u[0],u[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let u=this.points();if(u.length<4)return{x:u[0]||0,y:u[1]||0,width:0,height:0};this.tension()!==0?u=[u[0],u[1],...this._getTensionPoints(),u[u.length-2],u[u.length-1]]:u=this.points();let c=u[0],d=u[0],p=u[1],v=u[1],y,b;for(let S=0;S<u.length/2;S++)y=u[S*2],b=u[S*2+1],c=Math.min(c,y),d=Math.max(d,y),p=Math.min(p,b),v=Math.max(v,b);return{x:c,y:p,width:d-c,height:v-p}}}return km.Line=o,o.prototype.className="Line",o.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(o),r.Factory.addGetterSetter(o,"closed",!1),r.Factory.addGetterSetter(o,"bezier",!1),r.Factory.addGetterSetter(o,"tension",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(o,"points",[],(0,i.getNumberArrayValidator)()),km}var Cm={},_w={},QN;function Az(){return QN||(QN=1,(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.t2length=r.getQuadraticArcLength=r.getCubicArcLength=r.binomialCoefficients=r.cValues=r.tValues=void 0,r.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],r.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],r.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,l,u)=>{let c,d;const v=u/2;c=0;for(let y=0;y<20;y++)d=v*r.tValues[20][y]+v,c+=r.cValues[20][y]*i(o,l,d);return v*c};r.getCubicArcLength=e;const n=(o,l,u)=>{u===void 0&&(u=1);const c=o[0]-2*o[1]+o[2],d=l[0]-2*l[1]+l[2],p=2*o[1]-2*o[0],v=2*l[1]-2*l[0],y=4*(c*c+d*d),b=4*(c*p+d*v),S=p*p+v*v;if(y===0)return u*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(l[2]-l[0],2));const k=b/(2*y),T=S/y,C=u+k,N=T-k*k,P=C*C+N>0?Math.sqrt(C*C+N):0,R=k*k+N>0?Math.sqrt(k*k+N):0,O=k+Math.sqrt(k*k+N)!==0?N*Math.log(Math.abs((C+P)/(k+R))):0;return Math.sqrt(y)/2*(C*P-k*R+O)};r.getQuadraticArcLength=n;function i(o,l,u){const c=a(1,u,o),d=a(1,u,l),p=c*c+d*d;return Math.sqrt(p)}const a=(o,l,u)=>{const c=u.length-1;let d,p;if(c===0)return 0;if(o===0){p=0;for(let v=0;v<=c;v++)p+=r.binomialCoefficients[c][v]*Math.pow(1-l,c-v)*Math.pow(l,v)*u[v];return p}else{d=new Array(c);for(let v=0;v<c;v++)d[v]=c*(u[v+1]-u[v]);return a(o-1,l,d)}},s=(o,l,u)=>{let c=1,d=o/l,p=(o-u(d))/l,v=0;for(;c>.001;){const y=u(d+p),b=Math.abs(o-y)/l;if(b<c)c=b,d+=p;else{const S=u(d-p),k=Math.abs(o-S)/l;k<c?(c=k,d-=p):p/=2}if(v++,v>500)break}return d};r.t2length=s})(_w)),_w}var JN;function tS(){if(JN)return Cm;JN=1,Object.defineProperty(Cm,"__esModule",{value:!0}),Cm.Path=void 0;const r=fr(),e=ta(),n=ur(),i=Az();let a=class Ts extends e.Shape{constructor(o){super(o),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Ts.parsePathData(this.data()),this.pathLength=Ts.getPathLength(this.dataArray)}_sceneFunc(o){const l=this.dataArray;o.beginPath();let u=!1;for(let P=0;P<l.length;P++){const R=l[P].command,O=l[P].points;switch(R){case"L":o.lineTo(O[0],O[1]);break;case"M":o.moveTo(O[0],O[1]);break;case"C":o.bezierCurveTo(O[0],O[1],O[2],O[3],O[4],O[5]);break;case"Q":o.quadraticCurveTo(O[0],O[1],O[2],O[3]);break;case"A":var c=O[0],d=O[1],p=O[2],v=O[3],y=O[4],b=O[5],S=O[6],k=O[7],T=p>v?p:v,C=p>v?1:p/v,N=p>v?v/p:1;o.translate(c,d),o.rotate(S),o.scale(C,N),o.arc(0,0,T,y,y+b,1-k),o.scale(1/C,1/N),o.rotate(-S),o.translate(-c,-d);break;case"z":u=!0,o.closePath();break}}!u&&!this.hasFill()?o.strokeShape(this):o.fillStrokeShape(this)}getSelfRect(){let o=[];this.dataArray.forEach(function(y){if(y.command==="A"){const b=y.points[4],S=y.points[5],k=y.points[4]+S;let T=Math.PI/180;if(Math.abs(b-k)<T&&(T=Math.abs(b-k)),S<0)for(let C=b-T;C>k;C-=T){const N=Ts.getPointOnEllipticalArc(y.points[0],y.points[1],y.points[2],y.points[3],C,0);o.push(N.x,N.y)}else for(let C=b+T;C<k;C+=T){const N=Ts.getPointOnEllipticalArc(y.points[0],y.points[1],y.points[2],y.points[3],C,0);o.push(N.x,N.y)}}else if(y.command==="C")for(let b=0;b<=1;b+=.01){const S=Ts.getPointOnCubicBezier(b,y.start.x,y.start.y,y.points[0],y.points[1],y.points[2],y.points[3],y.points[4],y.points[5]);o.push(S.x,S.y)}else o=o.concat(y.points)});let l=o[0],u=o[0],c=o[1],d=o[1],p,v;for(let y=0;y<o.length/2;y++)p=o[y*2],v=o[y*2+1],isNaN(p)||(l=Math.min(l,p),u=Math.max(u,p)),isNaN(v)||(c=Math.min(c,v),d=Math.max(d,v));return{x:l,y:c,width:u-l,height:d-c}}getLength(){return this.pathLength}getPointAtLength(o){return Ts.getPointAtLengthOfDataArray(o,this.dataArray)}static getLineLength(o,l,u,c){return Math.sqrt((u-o)*(u-o)+(c-l)*(c-l))}static getPathLength(o){let l=0;for(let u=0;u<o.length;++u)l+=o[u].pathLength;return l}static getPointAtLengthOfDataArray(o,l){let u,c=0,d=l.length;if(!d)return null;for(;c<d&&o>l[c].pathLength;)o-=l[c].pathLength,++c;if(c===d)return u=l[c-1].points.slice(-2),{x:u[0],y:u[1]};if(o<.01)return u=l[c].points.slice(0,2),{x:u[0],y:u[1]};const p=l[c],v=p.points;switch(p.command){case"L":return Ts.getPointOnLine(o,p.start.x,p.start.y,v[0],v[1]);case"C":return Ts.getPointOnCubicBezier((0,i.t2length)(o,Ts.getPathLength(l),P=>(0,i.getCubicArcLength)([p.start.x,v[0],v[2],v[4]],[p.start.y,v[1],v[3],v[5]],P)),p.start.x,p.start.y,v[0],v[1],v[2],v[3],v[4],v[5]);case"Q":return Ts.getPointOnQuadraticBezier((0,i.t2length)(o,Ts.getPathLength(l),P=>(0,i.getQuadraticArcLength)([p.start.x,v[0],v[2]],[p.start.y,v[1],v[3]],P)),p.start.x,p.start.y,v[0],v[1],v[2],v[3]);case"A":var y=v[0],b=v[1],S=v[2],k=v[3],T=v[4],C=v[5],N=v[6];return T+=C*o/p.pathLength,Ts.getPointOnEllipticalArc(y,b,S,k,T,N)}return null}static getPointOnLine(o,l,u,c,d,p,v){p=p??l,v=v??u;const y=this.getLineLength(l,u,c,d);if(y<1e-10)return{x:l,y:u};if(c===l)return{x:p,y:v+(d>u?o:-o)};const b=(d-u)/(c-l),S=Math.sqrt(o*o/(1+b*b))*(c<l?-1:1),k=b*S;if(Math.abs(v-u-b*(p-l))<1e-10)return{x:p+S,y:v+k};const T=((p-l)*(c-l)+(v-u)*(d-u))/(y*y),C=l+T*(c-l),N=u+T*(d-u),P=this.getLineLength(p,v,C,N),R=Math.sqrt(o*o-P*P),O=Math.sqrt(R*R/(1+b*b))*(c<l?-1:1),B=b*O;return{x:C+O,y:N+B}}static getPointOnCubicBezier(o,l,u,c,d,p,v,y,b){function S(R){return R*R*R}function k(R){return 3*R*R*(1-R)}function T(R){return 3*R*(1-R)*(1-R)}function C(R){return(1-R)*(1-R)*(1-R)}const N=y*S(o)+p*k(o)+c*T(o)+l*C(o),P=b*S(o)+v*k(o)+d*T(o)+u*C(o);return{x:N,y:P}}static getPointOnQuadraticBezier(o,l,u,c,d,p,v){function y(C){return C*C}function b(C){return 2*C*(1-C)}function S(C){return(1-C)*(1-C)}const k=p*y(o)+c*b(o)+l*S(o),T=v*y(o)+d*b(o)+u*S(o);return{x:k,y:T}}static getPointOnEllipticalArc(o,l,u,c,d,p){const v=Math.cos(p),y=Math.sin(p),b={x:u*Math.cos(d),y:c*Math.sin(d)};return{x:o+(b.x*v-b.y*y),y:l+(b.x*y+b.y*v)}}static parsePathData(o){if(!o)return[];let l=o;const u=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];l=l.replace(new RegExp(" ","g"),",");for(var c=0;c<u.length;c++)l=l.replace(new RegExp(u[c],"g"),"|"+u[c]);const d=l.split("|"),p=[],v=[];let y=0,b=0;const S=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let k;for(c=1;c<d.length;c++){let D=d[c],q=D.charAt(0);for(D=D.slice(1),v.length=0;k=S.exec(D);)v.push(k[0]);const G=[];for(let Z=0,Q=v.length;Z<Q;Z++){if(v[Z]==="00"){G.push(0,0);continue}const J=parseFloat(v[Z]);isNaN(J)?G.push(0):G.push(J)}for(;G.length>0&&!isNaN(G[0]);){let Z="",Q=[];const J=y,ie=b;var T,C,N,P,R,O,B,I,z,V;switch(q){case"l":y+=G.shift(),b+=G.shift(),Z="L",Q.push(y,b);break;case"L":y=G.shift(),b=G.shift(),Q.push(y,b);break;case"m":var $=G.shift(),Y=G.shift();if(y+=$,b+=Y,Z="M",p.length>2&&p[p.length-1].command==="z"){for(let ne=p.length-2;ne>=0;ne--)if(p[ne].command==="M"){y=p[ne].points[0]+$,b=p[ne].points[1]+Y;break}}Q.push(y,b),q="l";break;case"M":y=G.shift(),b=G.shift(),Z="M",Q.push(y,b),q="L";break;case"h":y+=G.shift(),Z="L",Q.push(y,b);break;case"H":y=G.shift(),Z="L",Q.push(y,b);break;case"v":b+=G.shift(),Z="L",Q.push(y,b);break;case"V":b=G.shift(),Z="L",Q.push(y,b);break;case"C":Q.push(G.shift(),G.shift(),G.shift(),G.shift()),y=G.shift(),b=G.shift(),Q.push(y,b);break;case"c":Q.push(y+G.shift(),b+G.shift(),y+G.shift(),b+G.shift()),y+=G.shift(),b+=G.shift(),Z="C",Q.push(y,b);break;case"S":C=y,N=b,T=p[p.length-1],T.command==="C"&&(C=y+(y-T.points[2]),N=b+(b-T.points[3])),Q.push(C,N,G.shift(),G.shift()),y=G.shift(),b=G.shift(),Z="C",Q.push(y,b);break;case"s":C=y,N=b,T=p[p.length-1],T.command==="C"&&(C=y+(y-T.points[2]),N=b+(b-T.points[3])),Q.push(C,N,y+G.shift(),b+G.shift()),y+=G.shift(),b+=G.shift(),Z="C",Q.push(y,b);break;case"Q":Q.push(G.shift(),G.shift()),y=G.shift(),b=G.shift(),Q.push(y,b);break;case"q":Q.push(y+G.shift(),b+G.shift()),y+=G.shift(),b+=G.shift(),Z="Q",Q.push(y,b);break;case"T":C=y,N=b,T=p[p.length-1],T.command==="Q"&&(C=y+(y-T.points[0]),N=b+(b-T.points[1])),y=G.shift(),b=G.shift(),Z="Q",Q.push(C,N,y,b);break;case"t":C=y,N=b,T=p[p.length-1],T.command==="Q"&&(C=y+(y-T.points[0]),N=b+(b-T.points[1])),y+=G.shift(),b+=G.shift(),Z="Q",Q.push(C,N,y,b);break;case"A":P=G.shift(),R=G.shift(),O=G.shift(),B=G.shift(),I=G.shift(),z=y,V=b,y=G.shift(),b=G.shift(),Z="A",Q=this.convertEndpointToCenterParameterization(z,V,y,b,B,I,P,R,O);break;case"a":P=G.shift(),R=G.shift(),O=G.shift(),B=G.shift(),I=G.shift(),z=y,V=b,y+=G.shift(),b+=G.shift(),Z="A",Q=this.convertEndpointToCenterParameterization(z,V,y,b,B,I,P,R,O);break}p.push({command:Z||q,points:Q,start:{x:J,y:ie},pathLength:this.calcLength(J,ie,Z||q,Q)})}(q==="z"||q==="Z")&&p.push({command:"z",points:[],start:void 0,pathLength:0})}return p}static calcLength(o,l,u,c){let d,p,v,y;const b=Ts;switch(u){case"L":return b.getLineLength(o,l,c[0],c[1]);case"C":return(0,i.getCubicArcLength)([o,c[0],c[2],c[4]],[l,c[1],c[3],c[5]],1);case"Q":return(0,i.getQuadraticArcLength)([o,c[0],c[2]],[l,c[1],c[3]],1);case"A":d=0;var S=c[4],k=c[5],T=c[4]+k,C=Math.PI/180;if(Math.abs(S-T)<C&&(C=Math.abs(S-T)),p=b.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],S,0),k<0)for(y=S-C;y>T;y-=C)v=b.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],y,0),d+=b.getLineLength(p.x,p.y,v.x,v.y),p=v;else for(y=S+C;y<T;y+=C)v=b.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],y,0),d+=b.getLineLength(p.x,p.y,v.x,v.y),p=v;return v=b.getPointOnEllipticalArc(c[0],c[1],c[2],c[3],T,0),d+=b.getLineLength(p.x,p.y,v.x,v.y),d}return 0}static convertEndpointToCenterParameterization(o,l,u,c,d,p,v,y,b){const S=b*(Math.PI/180),k=Math.cos(S)*(o-u)/2+Math.sin(S)*(l-c)/2,T=-1*Math.sin(S)*(o-u)/2+Math.cos(S)*(l-c)/2,C=k*k/(v*v)+T*T/(y*y);C>1&&(v*=Math.sqrt(C),y*=Math.sqrt(C));let N=Math.sqrt((v*v*(y*y)-v*v*(T*T)-y*y*(k*k))/(v*v*(T*T)+y*y*(k*k)));d===p&&(N*=-1),isNaN(N)&&(N=0);const P=N*v*T/y,R=N*-y*k/v,O=(o+u)/2+Math.cos(S)*P-Math.sin(S)*R,B=(l+c)/2+Math.sin(S)*P+Math.cos(S)*R,I=function(G){return Math.sqrt(G[0]*G[0]+G[1]*G[1])},z=function(G,Z){return(G[0]*Z[0]+G[1]*Z[1])/(I(G)*I(Z))},V=function(G,Z){return(G[0]*Z[1]<G[1]*Z[0]?-1:1)*Math.acos(z(G,Z))},$=V([1,0],[(k-P)/v,(T-R)/y]),Y=[(k-P)/v,(T-R)/y],D=[(-1*k-P)/v,(-1*T-R)/y];let q=V(Y,D);return z(Y,D)<=-1&&(q=Math.PI),z(Y,D)>=1&&(q=0),p===0&&q>0&&(q=q-2*Math.PI),p===1&&q<0&&(q=q+2*Math.PI),[O,B,v,y,$,q,S,p]}};return Cm.Path=a,a.prototype.className="Path",a.prototype._attrsAffectingSize=["data"],(0,n._registerNode)(a),r.Factory.addGetterSetter(a,"data"),Cm}var e5;function jz(){if(e5)return Sm;e5=1,Object.defineProperty(Sm,"__esModule",{value:!0}),Sm.Arrow=void 0;const r=fr(),e=gM(),n=gr(),i=ur(),a=tS();let s=class extends e.Line{_sceneFunc(l){super._sceneFunc(l);const u=Math.PI*2,c=this.points();let d=c;const p=this.tension()!==0&&c.length>4;p&&(d=this.getTensionPoints());const v=this.pointerLength(),y=c.length;let b,S;if(p){const C=[d[d.length-4],d[d.length-3],d[d.length-2],d[d.length-1],c[y-2],c[y-1]],N=a.Path.calcLength(d[d.length-4],d[d.length-3],"C",C),P=a.Path.getPointOnQuadraticBezier(Math.min(1,1-v/N),C[0],C[1],C[2],C[3],C[4],C[5]);b=c[y-2]-P.x,S=c[y-1]-P.y}else b=c[y-2]-c[y-4],S=c[y-1]-c[y-3];const k=(Math.atan2(S,b)+u)%u,T=this.pointerWidth();this.pointerAtEnding()&&(l.save(),l.beginPath(),l.translate(c[y-2],c[y-1]),l.rotate(k),l.moveTo(0,0),l.lineTo(-v,T/2),l.lineTo(-v,-T/2),l.closePath(),l.restore(),this.__fillStroke(l)),this.pointerAtBeginning()&&(l.save(),l.beginPath(),l.translate(c[0],c[1]),p?(b=(d[0]+d[2])/2-c[0],S=(d[1]+d[3])/2-c[1]):(b=c[2]-c[0],S=c[3]-c[1]),l.rotate((Math.atan2(-S,-b)+u)%u),l.moveTo(0,0),l.lineTo(-v,T/2),l.lineTo(-v,-T/2),l.closePath(),l.restore(),this.__fillStroke(l))}__fillStroke(l){const u=this.dashEnabled();u&&(this.attrs.dashEnabled=!1,l.setLineDash([])),l.fillStrokeShape(this),u&&(this.attrs.dashEnabled=!0)}getSelfRect(){const l=super.getSelfRect(),u=this.pointerWidth()/2;return{x:l.x-u,y:l.y-u,width:l.width+u*2,height:l.height+u*2}}};return Sm.Arrow=s,s.prototype.className="Arrow",(0,i._registerNode)(s),r.Factory.addGetterSetter(s,"pointerLength",10,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(s,"pointerWidth",10,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(s,"pointerAtBeginning",!1),r.Factory.addGetterSetter(s,"pointerAtEnding",!0),Sm}var Em={},t5;function Rz(){if(t5)return Em;t5=1,Object.defineProperty(Em,"__esModule",{value:!0}),Em.Circle=void 0;const r=fr(),e=ta(),n=gr(),i=ur();let a=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius()!==o/2&&this.radius(o/2)}setHeight(o){this.radius()!==o/2&&this.radius(o/2)}};return Em.Circle=a,a.prototype._centroid=!0,a.prototype.className="Circle",a.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(a),r.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),Em}var Nm={},r5;function Lz(){if(r5)return Nm;r5=1,Object.defineProperty(Nm,"__esModule",{value:!0}),Nm.Ellipse=void 0;const r=fr(),e=ta(),n=gr(),i=ur();let a=class extends e.Shape{_sceneFunc(o){const l=this.radiusX(),u=this.radiusY();o.beginPath(),o.save(),l!==u&&o.scale(1,u/l),o.arc(0,0,l,0,Math.PI*2,!1),o.restore(),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(o){this.radiusX(o/2)}setHeight(o){this.radiusY(o/2)}};return Nm.Ellipse=a,a.prototype.className="Ellipse",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,i._registerNode)(a),r.Factory.addComponentsGetterSetter(a,"radius",["x","y"]),r.Factory.addGetterSetter(a,"radiusX",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(a,"radiusY",0,(0,n.getNumberValidator)()),Nm}var Tm={},n5;function Oz(){if(n5)return Tm;n5=1,Object.defineProperty(Tm,"__esModule",{value:!0}),Tm.Image=void 0;const r=Yn(),e=fr(),n=ta(),i=ur(),a=gr();class s extends n.Shape{constructor(l){super(l),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const l=this.image();l&&l.complete||l&&l.readyState===4||l&&l.addEventListener&&l.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){const l=!!this.cornerRadius(),u=this.hasShadow();return l&&u?!0:super._useBufferCanvas(!0)}_sceneFunc(l){const u=this.getWidth(),c=this.getHeight(),d=this.cornerRadius(),p=this.attrs.image;let v;if(p){const y=this.attrs.cropWidth,b=this.attrs.cropHeight;y&&b?v=[p,this.cropX(),this.cropY(),y,b,0,0,u,c]:v=[p,0,0,u,c]}(this.hasFill()||this.hasStroke()||d)&&(l.beginPath(),d?r.Util.drawRoundedRectPath(l,u,c,d):l.rect(0,0,u,c),l.closePath(),l.fillStrokeShape(this)),p&&(d&&l.clip(),l.drawImage.apply(l,v))}_hitFunc(l){const u=this.width(),c=this.height(),d=this.cornerRadius();l.beginPath(),d?r.Util.drawRoundedRectPath(l,u,c,d):l.rect(0,0,u,c),l.closePath(),l.fillStrokeShape(this)}getWidth(){var l,u;return(l=this.attrs.width)!==null&&l!==void 0?l:(u=this.image())===null||u===void 0?void 0:u.width}getHeight(){var l,u;return(l=this.attrs.height)!==null&&l!==void 0?l:(u=this.image())===null||u===void 0?void 0:u.height}static fromURL(l,u,c=null){const d=r.Util.createImageElement();d.onload=function(){const p=new s({image:d});u(p)},d.onerror=c,d.crossOrigin="Anonymous",d.src=l}}return Tm.Image=s,s.prototype.className="Image",(0,i._registerNode)(s),e.Factory.addGetterSetter(s,"cornerRadius",0,(0,a.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(s,"image"),e.Factory.addComponentsGetterSetter(s,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(s,"cropX",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropY",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropWidth",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(s,"cropHeight",0,(0,a.getNumberValidator)()),Tm}var mh={},i5;function Dz(){if(i5)return mh;i5=1,Object.defineProperty(mh,"__esModule",{value:!0}),mh.Tag=mh.Label=void 0;const r=fr(),e=ta(),n=J_(),i=gr(),a=ur(),s=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],o="Change.konva",l="none",u="up",c="right",d="down",p="left",v=s.length;let y=class extends n.Group{constructor(k){super(k),this.on("add.konva",function(T){this._addListeners(T.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(k){let T=this,C;const N=function(){T._sync()};for(C=0;C<v;C++)k.on(s[C]+o,N)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let k=this.getText(),T=this.getTag(),C,N,P,R,O,B,I;if(k&&T){switch(C=k.width(),N=k.height(),P=T.pointerDirection(),R=T.pointerWidth(),I=T.pointerHeight(),O=0,B=0,P){case u:O=C/2,B=-1*I;break;case c:O=C+R,B=N/2;break;case d:O=C/2,B=N+I;break;case p:O=-1*R,B=N/2;break}T.setAttrs({x:-1*O,y:-1*B,width:C,height:N}),k.setAttrs({x:-1*O,y:-1*B})}}};mh.Label=y,y.prototype.className="Label",(0,a._registerNode)(y);class b extends e.Shape{_sceneFunc(k){const T=this.width(),C=this.height(),N=this.pointerDirection(),P=this.pointerWidth(),R=this.pointerHeight(),O=this.cornerRadius();let B=0,I=0,z=0,V=0;typeof O=="number"?B=I=z=V=Math.min(O,T/2,C/2):(B=Math.min(O[0]||0,T/2,C/2),I=Math.min(O[1]||0,T/2,C/2),V=Math.min(O[2]||0,T/2,C/2),z=Math.min(O[3]||0,T/2,C/2)),k.beginPath(),k.moveTo(B,0),N===u&&(k.lineTo((T-P)/2,0),k.lineTo(T/2,-1*R),k.lineTo((T+P)/2,0)),k.lineTo(T-I,0),k.arc(T-I,I,I,Math.PI*3/2,0,!1),N===c&&(k.lineTo(T,(C-R)/2),k.lineTo(T+P,C/2),k.lineTo(T,(C+R)/2)),k.lineTo(T,C-V),k.arc(T-V,C-V,V,0,Math.PI/2,!1),N===d&&(k.lineTo((T+P)/2,C),k.lineTo(T/2,C+R),k.lineTo((T-P)/2,C)),k.lineTo(z,C),k.arc(z,C-z,z,Math.PI/2,Math.PI,!1),N===p&&(k.lineTo(0,(C+R)/2),k.lineTo(-1*P,C/2),k.lineTo(0,(C-R)/2)),k.lineTo(0,B),k.arc(B,B,B,Math.PI,Math.PI*3/2,!1),k.closePath(),k.fillStrokeShape(this)}getSelfRect(){let k=0,T=0,C=this.pointerWidth(),N=this.pointerHeight(),P=this.pointerDirection(),R=this.width(),O=this.height();return P===u?(T-=N,O+=N):P===d?O+=N:P===p?(k-=C*1.5,R+=C):P===c&&(R+=C*1.5),{x:k,y:T,width:R,height:O}}}return mh.Tag=b,b.prototype.className="Tag",(0,a._registerNode)(b),r.Factory.addGetterSetter(b,"pointerDirection",l),r.Factory.addGetterSetter(b,"pointerWidth",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(b,"pointerHeight",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(b,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),mh}var Pm={},a5;function vM(){if(a5)return Pm;a5=1,Object.defineProperty(Pm,"__esModule",{value:!0}),Pm.Rect=void 0;const r=fr(),e=ta(),n=ur(),i=Yn(),a=gr();class s extends e.Shape{_sceneFunc(l){const u=this.cornerRadius(),c=this.width(),d=this.height();l.beginPath(),u?i.Util.drawRoundedRectPath(l,c,d,u):l.rect(0,0,c,d),l.closePath(),l.fillStrokeShape(this)}}return Pm.Rect=s,s.prototype.className="Rect",(0,n._registerNode)(s),r.Factory.addGetterSetter(s,"cornerRadius",0,(0,a.getNumberOrArrayOfNumbersValidator)(4)),Pm}var Mm={},s5;function Iz(){if(s5)return Mm;s5=1,Object.defineProperty(Mm,"__esModule",{value:!0}),Mm.RegularPolygon=void 0;const r=fr(),e=ta(),n=gr(),i=ur();let a=class extends e.Shape{_sceneFunc(o){const l=this._getPoints();o.beginPath(),o.moveTo(l[0].x,l[0].y);for(let u=1;u<l.length;u++)o.lineTo(l[u].x,l[u].y);o.closePath(),o.fillStrokeShape(this)}_getPoints(){const o=this.attrs.sides,l=this.attrs.radius||0,u=[];for(let c=0;c<o;c++)u.push({x:l*Math.sin(c*2*Math.PI/o),y:-1*l*Math.cos(c*2*Math.PI/o)});return u}getSelfRect(){const o=this._getPoints();let l=o[0].x,u=o[0].y,c=o[0].x,d=o[0].y;return o.forEach(p=>{l=Math.min(l,p.x),u=Math.max(u,p.x),c=Math.min(c,p.y),d=Math.max(d,p.y)}),{x:l,y:c,width:u-l,height:d-c}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return Mm.RegularPolygon=a,a.prototype.className="RegularPolygon",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(a),r.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(a,"sides",0,(0,n.getNumberValidator)()),Mm}var Am={},o5;function Bz(){if(o5)return Am;o5=1,Object.defineProperty(Am,"__esModule",{value:!0}),Am.Ring=void 0;const r=fr(),e=ta(),n=gr(),i=ur(),a=Math.PI*2;let s=class extends e.Shape{_sceneFunc(l){l.beginPath(),l.arc(0,0,this.innerRadius(),0,a,!1),l.moveTo(this.outerRadius(),0),l.arc(0,0,this.outerRadius(),a,0,!0),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(l){this.outerRadius(l/2)}setHeight(l){this.outerRadius(l/2)}};return Am.Ring=s,s.prototype.className="Ring",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(s),r.Factory.addGetterSetter(s,"innerRadius",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(s,"outerRadius",0,(0,n.getNumberValidator)()),Am}var jm={},l5;function zz(){if(l5)return jm;l5=1,Object.defineProperty(jm,"__esModule",{value:!0}),jm.Sprite=void 0;const r=fr(),e=ta(),n=eS(),i=gr(),a=ur();let s=class extends e.Shape{constructor(l){super(l),this._updated=!0,this.anim=new n.Animation(()=>{const u=this._updated;return this._updated=!1,u}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(l){const u=this.animation(),c=this.frameIndex(),d=c*4,p=this.animations()[u],v=this.frameOffsets(),y=p[d+0],b=p[d+1],S=p[d+2],k=p[d+3],T=this.image();if((this.hasFill()||this.hasStroke())&&(l.beginPath(),l.rect(0,0,S,k),l.closePath(),l.fillStrokeShape(this)),T)if(v){const C=v[u],N=c*2;l.drawImage(T,y,b,S,k,C[N+0],C[N+1],S,k)}else l.drawImage(T,y,b,S,k,0,0,S,k)}_hitFunc(l){const u=this.animation(),c=this.frameIndex(),d=c*4,p=this.animations()[u],v=this.frameOffsets(),y=p[d+2],b=p[d+3];if(l.beginPath(),v){const S=v[u],k=c*2;l.rect(S[k+0],S[k+1],y,b)}else l.rect(0,0,y,b);l.closePath(),l.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const l=this;this.interval=setInterval(function(){l._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const l=this.getLayer();this.anim.setLayers(l),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const l=this.frameIndex(),u=this.animation(),c=this.animations(),d=c[u],p=d.length/4;l<p-1?this.frameIndex(l+1):this.frameIndex(0)}};return jm.Sprite=s,s.prototype.className="Sprite",(0,a._registerNode)(s),r.Factory.addGetterSetter(s,"animation"),r.Factory.addGetterSetter(s,"animations"),r.Factory.addGetterSetter(s,"frameOffsets"),r.Factory.addGetterSetter(s,"image"),r.Factory.addGetterSetter(s,"frameIndex",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(s,"frameRate",17,(0,i.getNumberValidator)()),r.Factory.backCompat(s,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),jm}var Rm={},u5;function Fz(){if(u5)return Rm;u5=1,Object.defineProperty(Rm,"__esModule",{value:!0}),Rm.Star=void 0;const r=fr(),e=ta(),n=gr(),i=ur();let a=class extends e.Shape{_sceneFunc(o){const l=this.innerRadius(),u=this.outerRadius(),c=this.numPoints();o.beginPath(),o.moveTo(0,0-u);for(let d=1;d<c*2;d++){const p=d%2===0?u:l,v=p*Math.sin(d*Math.PI/c),y=-1*p*Math.cos(d*Math.PI/c);o.lineTo(v,y)}o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return Rm.Star=a,a.prototype.className="Star",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(a),r.Factory.addGetterSetter(a,"numPoints",5,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),r.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),Rm}var Hf={},c5;function yM(){if(c5)return Hf;c5=1,Object.defineProperty(Hf,"__esModule",{value:!0}),Hf.Text=void 0,Hf.stringToArray=o;const r=Yn(),e=fr(),n=ta(),i=ur(),a=gr(),s=ur();function o(re){return[...re].reduce((ae,he,ve,xe)=>(new RegExp("\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?(?:\\u200D\\p{Emoji_Presentation})+","u").test(he)?ae.push(he):new RegExp("\\p{Regional_Indicator}{2}","u").test(he+(xe[ve+1]||""))?ae.push(he+xe[ve+1]):ve>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(he)?ae[ae.length-1]+=he:ae.push(he),ae),[])}const l="auto",u="center",c="inherit",d="justify",p="Change.konva",v="2d",y="-",b="left",S="text",k="Text",T="top",C="bottom",N="middle",P="normal",R="px ",O=" ",B="right",I="rtl",z="word",V="char",$="none",Y="",D=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],q=D.length;function G(re){return re.split(",").map(ae=>{ae=ae.trim();const he=ae.indexOf(" ")>=0,ve=ae.indexOf('"')>=0||ae.indexOf("'")>=0;return he&&!ve&&(ae=`"${ae}"`),ae}).join(", ")}let Z;function Q(){return Z||(Z=r.Util.createCanvasElement().getContext(v),Z)}function J(re){re.fillText(this._partialText,this._partialTextX,this._partialTextY)}function ie(re){re.setAttr("miterLimit",2),re.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function ne(re){return re=re||{},!re.fillLinearGradientColorStops&&!re.fillRadialGradientColorStops&&!re.fillPatternImage&&(re.fill=re.fill||"black"),re}class W extends n.Shape{constructor(ae){super(ne(ae)),this._partialTextX=0,this._partialTextY=0;for(let he=0;he<q;he++)this.on(D[he]+p,this._setTextData);this._setTextData()}_sceneFunc(ae){const he=this.textArr,ve=he.length;if(!this.text())return;let xe=this.padding(),se=this.fontSize(),ge=this.lineHeight()*se,le=this.verticalAlign(),pe=this.direction(),me=0,be=this.align(),Se=this.getWidth(),Ue=this.letterSpacing(),We=this.fill(),gt=this.textDecoration(),Je=gt.indexOf("underline")!==-1,at=gt.indexOf("line-through")!==-1,Ve;pe=pe===c?ae.direction:pe;let Oe=ge/2,et=N;if(i.Konva._fixTextRendering){const ot=this.measureSize("M");et="alphabetic",Oe=(ot.fontBoundingBoxAscent-ot.fontBoundingBoxDescent)/2+ge/2}var Ne=0,ze=0;for(pe===I&&ae.setAttr("direction",pe),ae.setAttr("font",this._getContextFont()),ae.setAttr("textBaseline",et),ae.setAttr("textAlign",b),le===N?me=(this.getHeight()-ve*ge-xe*2)/2:le===C&&(me=this.getHeight()-ve*ge-xe*2),ae.translate(xe,me+xe),Ve=0;Ve<ve;Ve++){var Ne=0,ze=0,Ke=he[Ve],ft=Ke.text,yt=Ke.width,Et=Ke.lastInParagraph,Rt,$t,wt;if(ae.save(),be===B?Ne+=Se-yt-xe*2:be===u&&(Ne+=(Se-yt-xe*2)/2),Je){ae.save(),ae.beginPath();const de=i.Konva._fixTextRendering?Math.round(se/4):Math.round(se/2),ye=Ne,Ce=Oe+ze+de;ae.moveTo(ye,Ce),Rt=ft.split(" ").length-1,$t=Rt===0,wt=be===d&&!Et?Se-xe*2:yt,ae.lineTo(ye+Math.round(wt),Ce),ae.lineWidth=se/15;const Te=this._getLinearGradient();ae.strokeStyle=Te||We,ae.stroke(),ae.restore()}if(at){ae.save(),ae.beginPath();const de=i.Konva._fixTextRendering?-Math.round(se/4):0;ae.moveTo(Ne,Oe+ze+de),Rt=ft.split(" ").length-1,$t=Rt===0,wt=be===d&&Et&&!$t?Se-xe*2:yt,ae.lineTo(Ne+Math.round(wt),Oe+ze+de),ae.lineWidth=se/15;const ye=this._getLinearGradient();ae.strokeStyle=ye||We,ae.stroke(),ae.restore()}if(pe!==I&&(Ue!==0||be===d)){Rt=ft.split(" ").length-1;const de=o(ft);for(let ye=0;ye<de.length;ye++){const Ce=de[ye];Ce===" "&&!Et&&be===d&&(Ne+=(Se-xe*2-yt)/Rt),this._partialTextX=Ne,this._partialTextY=Oe+ze,this._partialText=Ce,ae.fillStrokeShape(this),Ne+=this.measureSize(Ce).width+Ue}}else Ue!==0&&ae.setAttr("letterSpacing",`${Ue}px`),this._partialTextX=Ne,this._partialTextY=Oe+ze,this._partialText=ft,ae.fillStrokeShape(this);ae.restore(),ve>1&&(Oe+=ge)}}_hitFunc(ae){const he=this.getWidth(),ve=this.getHeight();ae.beginPath(),ae.rect(0,0,he,ve),ae.closePath(),ae.fillStrokeShape(this)}setText(ae){const he=r.Util._isString(ae)?ae:ae==null?"":ae+"";return this._setAttr(S,he),this}getWidth(){return this.attrs.width===l||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===l||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return r.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(ae){var he,ve,xe,se,ge,le,pe,me,be,Se,Ue;let We=Q(),gt=this.fontSize(),Je;We.save(),We.font=this._getContextFont(),Je=We.measureText(ae),We.restore();const at=gt/100;return{actualBoundingBoxAscent:(he=Je.actualBoundingBoxAscent)!==null&&he!==void 0?he:71.58203125*at,actualBoundingBoxDescent:(ve=Je.actualBoundingBoxDescent)!==null&&ve!==void 0?ve:0,actualBoundingBoxLeft:(xe=Je.actualBoundingBoxLeft)!==null&&xe!==void 0?xe:-7.421875*at,actualBoundingBoxRight:(se=Je.actualBoundingBoxRight)!==null&&se!==void 0?se:75.732421875*at,alphabeticBaseline:(ge=Je.alphabeticBaseline)!==null&&ge!==void 0?ge:0,emHeightAscent:(le=Je.emHeightAscent)!==null&&le!==void 0?le:100*at,emHeightDescent:(pe=Je.emHeightDescent)!==null&&pe!==void 0?pe:-20*at,fontBoundingBoxAscent:(me=Je.fontBoundingBoxAscent)!==null&&me!==void 0?me:91*at,fontBoundingBoxDescent:(be=Je.fontBoundingBoxDescent)!==null&&be!==void 0?be:21*at,hangingBaseline:(Se=Je.hangingBaseline)!==null&&Se!==void 0?Se:72.80000305175781*at,ideographicBaseline:(Ue=Je.ideographicBaseline)!==null&&Ue!==void 0?Ue:-21*at,width:Je.width,height:gt}}_getContextFont(){return this.fontStyle()+O+this.fontVariant()+O+(this.fontSize()+R)+G(this.fontFamily())}_addTextLine(ae){this.align()===d&&(ae=ae.trim());const ve=this._getTextWidth(ae);return this.textArr.push({text:ae,width:ve,lastInParagraph:!1})}_getTextWidth(ae){const he=this.letterSpacing(),ve=ae.length;return Q().measureText(ae).width+(ve?he*(ve-1):0)}_setTextData(){let ae=this.text().split(`
`),he=+this.fontSize(),ve=0,xe=this.lineHeight()*he,se=this.attrs.width,ge=this.attrs.height,le=se!==l&&se!==void 0,pe=ge!==l&&ge!==void 0,me=this.padding(),be=se-me*2,Se=ge-me*2,Ue=0,We=this.wrap(),gt=We!==$,Je=We!==V&&gt,at=this.ellipsis();this.textArr=[],Q().font=this._getContextFont();const Ve=at?this._getTextWidth(Y):0;for(let et=0,Ne=ae.length;et<Ne;++et){let ze=ae[et],Ke=this._getTextWidth(ze);if(le&&Ke>be)for(;ze.length>0;){let ft=0,yt=ze.length,Et="",Rt=0;for(;ft<yt;){const $t=ft+yt>>>1,wt=ze.slice(0,$t+1),ot=this._getTextWidth(wt)+Ve;ot<=be?(ft=$t+1,Et=wt,Rt=ot):yt=$t}if(Et){if(Je){var Oe;const wt=ze[Et.length];(wt===O||wt===y)&&Rt<=be?Oe=Et.length:Oe=Math.max(Et.lastIndexOf(O),Et.lastIndexOf(y))+1,Oe>0&&(ft=Oe,Et=Et.slice(0,ft),Rt=this._getTextWidth(Et))}if(Et=Et.trimRight(),this._addTextLine(Et),ve=Math.max(ve,Rt),Ue+=xe,this._shouldHandleEllipsis(Ue)){this._tryToAddEllipsisToLastLine();break}if(ze=ze.slice(ft),ze=ze.trimLeft(),ze.length>0&&(Ke=this._getTextWidth(ze),Ke<=be)){this._addTextLine(ze),Ue+=xe,ve=Math.max(ve,Ke);break}}else break}else this._addTextLine(ze),Ue+=xe,ve=Math.max(ve,Ke),this._shouldHandleEllipsis(Ue)&&et<Ne-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),pe&&Ue+xe>Se)break}this.textHeight=he,this.textWidth=ve}_shouldHandleEllipsis(ae){const he=+this.fontSize(),ve=this.lineHeight()*he,xe=this.attrs.height,se=xe!==l&&xe!==void 0,ge=this.padding(),le=xe-ge*2;return!(this.wrap()!==$)||se&&ae+ve>le}_tryToAddEllipsisToLastLine(){const ae=this.attrs.width,he=ae!==l&&ae!==void 0,ve=this.padding(),xe=ae-ve*2,se=this.ellipsis(),ge=this.textArr[this.textArr.length-1];!ge||!se||(he&&(this._getTextWidth(ge.text+Y)<xe||(ge.text=ge.text.slice(0,ge.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(ge.text+Y))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const ae=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,he=this.hasShadow();return ae&&he?!0:super._useBufferCanvas()}}return Hf.Text=W,W.prototype._fillFunc=J,W.prototype._strokeFunc=ie,W.prototype.className=k,W.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,s._registerNode)(W),e.Factory.overWriteSetter(W,"width",(0,a.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(W,"height",(0,a.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(W,"direction",c),e.Factory.addGetterSetter(W,"fontFamily","Arial"),e.Factory.addGetterSetter(W,"fontSize",12,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(W,"fontStyle",P),e.Factory.addGetterSetter(W,"fontVariant",P),e.Factory.addGetterSetter(W,"padding",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(W,"align",b),e.Factory.addGetterSetter(W,"verticalAlign",T),e.Factory.addGetterSetter(W,"lineHeight",1,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(W,"wrap",z),e.Factory.addGetterSetter(W,"ellipsis",!1,(0,a.getBooleanValidator)()),e.Factory.addGetterSetter(W,"letterSpacing",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(W,"text","",(0,a.getStringValidator)()),e.Factory.addGetterSetter(W,"textDecoration",""),Hf}var Lm={},d5;function Vz(){if(d5)return Lm;d5=1,Object.defineProperty(Lm,"__esModule",{value:!0}),Lm.TextPath=void 0;const r=Yn(),e=fr(),n=ta(),i=tS(),a=yM(),s=gr(),o=ur(),l="",u="normal";function c(v){v.fillText(this.partialText,0,0)}function d(v){v.strokeText(this.partialText,0,0)}let p=class extends n.Shape{constructor(y){super(y),this.dummyCanvas=r.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(y){if(!this.attrs.data)return null;const b=this.pathLength;return y-1>b?null:i.Path.getPointAtLengthOfDataArray(y,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(y){y.setAttr("font",this._getContextFont()),y.setAttr("textBaseline",this.textBaseline()),y.setAttr("textAlign","left"),y.save();const b=this.textDecoration(),S=this.fill(),k=this.fontSize(),T=this.glyphInfo;b==="underline"&&y.beginPath();for(let C=0;C<T.length;C++){y.save();const N=T[C].p0;y.translate(N.x,N.y),y.rotate(T[C].rotation),this.partialText=T[C].text,y.fillStrokeShape(this),b==="underline"&&(C===0&&y.moveTo(0,k/2+1),y.lineTo(k,k/2+1)),y.restore()}b==="underline"&&(y.strokeStyle=S,y.lineWidth=k/20,y.stroke()),y.restore()}_hitFunc(y){y.beginPath();const b=this.glyphInfo;if(b.length>=1){const S=b[0].p0;y.moveTo(S.x,S.y)}for(let S=0;S<b.length;S++){const k=b[S].p1;y.lineTo(k.x,k.y)}y.setAttr("lineWidth",this.fontSize()),y.setAttr("strokeStyle",this.colorKey),y.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return r.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(y){return a.Text.prototype.setText.call(this,y)}_getContextFont(){return a.Text.prototype._getContextFont.call(this)}_getTextSize(y){const S=this.dummyCanvas.getContext("2d");S.save(),S.font=this._getContextFont();const k=S.measureText(y);return S.restore(),{width:k.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:y,height:b}=this._getTextSize(this.attrs.text);if(this.textWidth=y,this.textHeight=b,this.glyphInfo=[],!this.attrs.data)return null;const S=this.letterSpacing(),k=this.align(),T=this.kerningFunc(),C=Math.max(this.textWidth+((this.attrs.text||"").length-1)*S,0);let N=0;k==="center"&&(N=Math.max(0,this.pathLength/2-C/2)),k==="right"&&(N=Math.max(0,this.pathLength-C));const P=(0,a.stringToArray)(this.text());let R=N;for(let O=0;O<P.length;O++){const B=this._getPointAtLength(R);if(!B)return;let I=this._getTextSize(P[O]).width+S;if(P[O]===" "&&k==="justify"){const q=this.text().split(" ").length-1;I+=(this.pathLength-C)/q}const z=this._getPointAtLength(R+I);if(!z)return;const V=i.Path.getLineLength(B.x,B.y,z.x,z.y);let $=0;if(T)try{$=T(P[O-1],P[O])*this.fontSize()}catch{$=0}B.x+=$,z.x+=$,this.textWidth+=$;const Y=i.Path.getPointOnLine($+V/2,B.x,B.y,z.x,z.y),D=Math.atan2(z.y-B.y,z.x-B.x);this.glyphInfo.push({transposeX:Y.x,transposeY:Y.y,text:P[O],rotation:D,p0:B,p1:z}),R+=I}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const y=[];this.glyphInfo.forEach(function(R){y.push(R.p0.x),y.push(R.p0.y),y.push(R.p1.x),y.push(R.p1.y)});let b=y[0]||0,S=y[0]||0,k=y[1]||0,T=y[1]||0,C,N;for(let R=0;R<y.length/2;R++)C=y[R*2],N=y[R*2+1],b=Math.min(b,C),S=Math.max(S,C),k=Math.min(k,N),T=Math.max(T,N);const P=this.fontSize();return{x:b-P/2,y:k-P/2,width:S-b+P,height:T-k+P}}destroy(){return r.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Lm.TextPath=p,p.prototype._fillFunc=c,p.prototype._strokeFunc=d,p.prototype._fillFuncHit=c,p.prototype._strokeFuncHit=d,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,o._registerNode)(p),e.Factory.addGetterSetter(p,"data"),e.Factory.addGetterSetter(p,"fontFamily","Arial"),e.Factory.addGetterSetter(p,"fontSize",12,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(p,"fontStyle",u),e.Factory.addGetterSetter(p,"align","left"),e.Factory.addGetterSetter(p,"letterSpacing",0,(0,s.getNumberValidator)()),e.Factory.addGetterSetter(p,"textBaseline","middle"),e.Factory.addGetterSetter(p,"fontVariant",u),e.Factory.addGetterSetter(p,"text",l),e.Factory.addGetterSetter(p,"textDecoration",null),e.Factory.addGetterSetter(p,"kerningFunc",null),Lm}var Om={},h5;function Uz(){if(h5)return Om;h5=1,Object.defineProperty(Om,"__esModule",{value:!0}),Om.Transformer=void 0;const r=Yn(),e=fr(),n=oi(),i=ta(),a=vM(),s=J_(),o=ur(),l=gr(),u=ur(),c="tr-konva",d=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(I=>I+`.${c}`).join(" "),p="nodesRect",v=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],y={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},b="ontouchstart"in o.Konva._global;function S(I,z,V){if(I==="rotater")return V;z+=r.Util.degToRad(y[I]||0);const $=(r.Util.radToDeg(z)%360+360)%360;return r.Util._inRange($,315+22.5,360)||r.Util._inRange($,0,22.5)?"ns-resize":r.Util._inRange($,45-22.5,45+22.5)?"nesw-resize":r.Util._inRange($,90-22.5,90+22.5)?"ew-resize":r.Util._inRange($,135-22.5,135+22.5)?"nwse-resize":r.Util._inRange($,180-22.5,180+22.5)?"ns-resize":r.Util._inRange($,225-22.5,225+22.5)?"nesw-resize":r.Util._inRange($,270-22.5,270+22.5)?"ew-resize":r.Util._inRange($,315-22.5,315+22.5)?"nwse-resize":(r.Util.error("Transformer has unknown angle for cursor detection: "+$),"pointer")}const k=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function T(I){return{x:I.x+I.width/2*Math.cos(I.rotation)+I.height/2*Math.sin(-I.rotation),y:I.y+I.height/2*Math.cos(I.rotation)+I.width/2*Math.sin(I.rotation)}}function C(I,z,V){const $=V.x+(I.x-V.x)*Math.cos(z)-(I.y-V.y)*Math.sin(z),Y=V.y+(I.x-V.x)*Math.sin(z)+(I.y-V.y)*Math.cos(z);return{...I,rotation:I.rotation+z,x:$,y:Y}}function N(I,z){const V=T(I);return C(I,z,V)}function P(I,z,V){let $=z;for(let Y=0;Y<I.length;Y++){const D=o.Konva.getAngle(I[Y]),q=Math.abs(D-z)%(Math.PI*2);Math.min(q,Math.PI*2-q)<V&&($=D)}return $}let R=0;class O extends s.Group{constructor(z){super(z),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(z){return this.setNode(z),this}setNode(z){return r.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([z])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return c+this._id}setNodes(z=[]){this._nodes&&this._nodes.length&&this.detach();const V=z.filter(Y=>Y.isAncestorOf(this)?(r.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=z=V,z.length===1&&this.useSingleNodeRotation()?this.rotation(z[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(Y=>{const D=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},q=Y._attrsAffectingSize.map(G=>G+"Change."+this._getEventNamespace()).join(" ");Y.on(q,D),Y.on(v.map(G=>G+`.${this._getEventNamespace()}`).join(" "),D),Y.on(`absoluteTransformChange.${this._getEventNamespace()}`,D),this._proxyDrag(Y)}),this._resetTransformCache(),this.findOne(".top-left")&&this.update(),this}_proxyDrag(z){let V;z.on(`dragstart.${this._getEventNamespace()}`,$=>{V=z.getAbsolutePosition(),!this.isDragging()&&z!==this.findOne(".back")&&this.startDrag($,!1)}),z.on(`dragmove.${this._getEventNamespace()}`,$=>{if(!V)return;const Y=z.getAbsolutePosition(),D=Y.x-V.x,q=Y.y-V.y;this.nodes().forEach(G=>{if(G===z||G.isDragging())return;const Z=G.getAbsolutePosition();G.setAbsolutePosition({x:Z.x+D,y:Z.y+q}),G.startDrag($)}),V=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(z=>{z.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(z,V=this.rotation(),$){const Y=z.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),D=z.getAbsoluteScale($),q=z.getAbsolutePosition($),G=Y.x*D.x-z.offsetX()*D.x,Z=Y.y*D.y-z.offsetY()*D.y,Q=(o.Konva.getAngle(z.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),J={x:q.x+G*Math.cos(Q)+Z*Math.sin(-Q),y:q.y+Z*Math.cos(Q)+G*Math.sin(Q),width:Y.width*D.x,height:Y.height*D.y,rotation:Q};return C(J,-o.Konva.getAngle(V),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const V=[];this.nodes().map(Q=>{const J=Q.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),ie=[{x:J.x,y:J.y},{x:J.x+J.width,y:J.y},{x:J.x+J.width,y:J.y+J.height},{x:J.x,y:J.y+J.height}],ne=Q.getAbsoluteTransform();ie.forEach(function(W){const re=ne.point(W);V.push(re)})});const $=new r.Transform;$.rotate(-o.Konva.getAngle(this.rotation()));let Y=1/0,D=1/0,q=-1/0,G=-1/0;V.forEach(function(Q){const J=$.point(Q);Y===void 0&&(Y=q=J.x,D=G=J.y),Y=Math.min(Y,J.x),D=Math.min(D,J.y),q=Math.max(q,J.x),G=Math.max(G,J.y)}),$.invert();const Z=$.point({x:Y,y:D});return{x:Z.x,y:Z.y,width:q-Y,height:G-D,rotation:o.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),k.forEach(z=>{this._createAnchor(z)}),this._createAnchor("rotater")}_createAnchor(z){const V=new a.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:z+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:b?10:"auto"}),$=this;V.on("mousedown touchstart",function(Y){$._handleMouseDown(Y)}),V.on("dragstart",Y=>{V.stopDrag(),Y.cancelBubble=!0}),V.on("dragend",Y=>{Y.cancelBubble=!0}),V.on("mouseenter",()=>{const Y=o.Konva.getAngle(this.rotation()),D=this.rotateAnchorCursor(),q=S(z,Y,D);V.getStage().content&&(V.getStage().content.style.cursor=q),this._cursorChange=!0}),V.on("mouseout",()=>{V.getStage().content&&(V.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(V)}_createBack(){const z=new i.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(V,$){const Y=$.getParent(),D=Y.padding();V.beginPath(),V.rect(-D,-D,$.width()+D*2,$.height()+D*2),V.moveTo($.width()/2,-D),Y.rotateEnabled()&&Y.rotateLineVisible()&&V.lineTo($.width()/2,-Y.rotateAnchorOffset()*r.Util._sign($.height())-D),V.fillStrokeShape($)},hitFunc:(V,$)=>{if(!this.shouldOverdrawWholeArea())return;const Y=this.padding();V.beginPath(),V.rect(-Y,-Y,$.width()+Y*2,$.height()+Y*2),V.fillStrokeShape($)}});this.add(z),this._proxyDrag(z),z.on("dragstart",V=>{V.cancelBubble=!0}),z.on("dragmove",V=>{V.cancelBubble=!0}),z.on("dragend",V=>{V.cancelBubble=!0}),this.on("dragmove",V=>{this.update()})}_handleMouseDown(z){if(this._transforming)return;this._movingAnchorName=z.target.name().split(" ")[0];const V=this._getNodeRect(),$=V.width,Y=V.height,D=Math.sqrt(Math.pow($,2)+Math.pow(Y,2));this.sin=Math.abs(Y/D),this.cos=Math.abs($/D),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const q=z.target.getAbsolutePosition(),G=z.target.getStage().getPointerPosition();this._anchorDragOffset={x:G.x-q.x,y:G.y-q.y},R++,this._fire("transformstart",{evt:z.evt,target:this.getNode()}),this._nodes.forEach(Z=>{Z._fire("transformstart",{evt:z.evt,target:Z})})}_handleMouseMove(z){let V,$,Y;const D=this.findOne("."+this._movingAnchorName),q=D.getStage();q.setPointersPositions(z);const G=q.getPointerPosition();let Z={x:G.x-this._anchorDragOffset.x,y:G.y-this._anchorDragOffset.y};const Q=D.getAbsolutePosition();this.anchorDragBoundFunc()&&(Z=this.anchorDragBoundFunc()(Q,Z,z)),D.setAbsolutePosition(Z);const J=D.getAbsolutePosition();if(Q.x===J.x&&Q.y===J.y)return;if(this._movingAnchorName==="rotater"){const le=this._getNodeRect();V=D.x()-le.width/2,$=-D.y()+le.height/2;let pe=Math.atan2(-$,V)+Math.PI/2;le.height<0&&(pe-=Math.PI);const be=o.Konva.getAngle(this.rotation())+pe,Se=o.Konva.getAngle(this.rotationSnapTolerance()),We=P(this.rotationSnaps(),be,Se)-le.rotation,gt=N(le,We);this._fitNodesInto(gt,z);return}const ie=this.shiftBehavior();let ne;ie==="inverted"?ne=this.keepRatio()&&!z.shiftKey:ie==="none"?ne=this.keepRatio():ne=this.keepRatio()||z.shiftKey;var ve=this.centeredScaling()||z.altKey;if(this._movingAnchorName==="top-left"){if(ne){var W=ve?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};Y=Math.sqrt(Math.pow(W.x-D.x(),2)+Math.pow(W.y-D.y(),2));var re=this.findOne(".top-left").x()>W.x?-1:1,ae=this.findOne(".top-left").y()>W.y?-1:1;V=Y*this.cos*re,$=Y*this.sin*ae,this.findOne(".top-left").x(W.x-V),this.findOne(".top-left").y(W.y-$)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(D.y());else if(this._movingAnchorName==="top-right"){if(ne){var W=ve?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};Y=Math.sqrt(Math.pow(D.x()-W.x,2)+Math.pow(W.y-D.y(),2));var re=this.findOne(".top-right").x()<W.x?-1:1,ae=this.findOne(".top-right").y()>W.y?-1:1;V=Y*this.cos*re,$=Y*this.sin*ae,this.findOne(".top-right").x(W.x+V),this.findOne(".top-right").y(W.y-$)}var he=D.position();this.findOne(".top-left").y(he.y),this.findOne(".bottom-right").x(he.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(D.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(D.x());else if(this._movingAnchorName==="bottom-left"){if(ne){var W=ve?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};Y=Math.sqrt(Math.pow(W.x-D.x(),2)+Math.pow(D.y()-W.y,2));var re=W.x<D.x()?-1:1,ae=D.y()<W.y?-1:1;V=Y*this.cos*re,$=Y*this.sin*ae,D.x(W.x-V),D.y(W.y+$)}he=D.position(),this.findOne(".top-left").x(he.x),this.findOne(".bottom-right").y(he.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(D.y());else if(this._movingAnchorName==="bottom-right"){if(ne){var W=ve?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};Y=Math.sqrt(Math.pow(D.x()-W.x,2)+Math.pow(D.y()-W.y,2));var re=this.findOne(".bottom-right").x()<W.x?-1:1,ae=this.findOne(".bottom-right").y()<W.y?-1:1;V=Y*this.cos*re,$=Y*this.sin*ae,this.findOne(".bottom-right").x(W.x+V),this.findOne(".bottom-right").y(W.y+$)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var ve=this.centeredScaling()||z.altKey;if(ve){const le=this.findOne(".top-left"),pe=this.findOne(".bottom-right"),me=le.x(),be=le.y(),Se=this.getWidth()-pe.x(),Ue=this.getHeight()-pe.y();pe.move({x:-me,y:-be}),le.move({x:Se,y:Ue})}const xe=this.findOne(".top-left").getAbsolutePosition();V=xe.x,$=xe.y;const se=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),ge=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:V,y:$,width:se,height:ge,rotation:o.Konva.getAngle(this.rotation())},z)}_handleMouseUp(z){this._removeEvents(z)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(z){var V;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const $=this.getNode();R--,this._fire("transformend",{evt:z,target:$}),(V=this.getLayer())===null||V===void 0||V.batchDraw(),$&&this._nodes.forEach(Y=>{var D;Y._fire("transformend",{evt:z,target:Y}),(D=Y.getLayer())===null||D===void 0||D.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(z,V){const $=this._getNodeRect(),Y=1;if(r.Util._inRange(z.width,-this.padding()*2-Y,Y)){this.update();return}if(r.Util._inRange(z.height,-this.padding()*2-Y,Y)){this.update();return}const D=new r.Transform;if(D.rotate(o.Konva.getAngle(this.rotation())),this._movingAnchorName&&z.width<0&&this._movingAnchorName.indexOf("left")>=0){const ne=D.point({x:-this.padding()*2,y:0});z.x+=ne.x,z.y+=ne.y,z.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=ne.x,this._anchorDragOffset.y-=ne.y}else if(this._movingAnchorName&&z.width<0&&this._movingAnchorName.indexOf("right")>=0){const ne=D.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=ne.x,this._anchorDragOffset.y-=ne.y,z.width+=this.padding()*2}if(this._movingAnchorName&&z.height<0&&this._movingAnchorName.indexOf("top")>=0){const ne=D.point({x:0,y:-this.padding()*2});z.x+=ne.x,z.y+=ne.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=ne.x,this._anchorDragOffset.y-=ne.y,z.height+=this.padding()*2}else if(this._movingAnchorName&&z.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const ne=D.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=ne.x,this._anchorDragOffset.y-=ne.y,z.height+=this.padding()*2}if(this.boundBoxFunc()){const ne=this.boundBoxFunc()($,z);ne?z=ne:r.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const q=1e7,G=new r.Transform;G.translate($.x,$.y),G.rotate($.rotation),G.scale($.width/q,$.height/q);const Z=new r.Transform,Q=z.width/q,J=z.height/q;this.flipEnabled()===!1?(Z.translate(z.x,z.y),Z.rotate(z.rotation),Z.translate(z.width<0?z.width:0,z.height<0?z.height:0),Z.scale(Math.abs(Q),Math.abs(J))):(Z.translate(z.x,z.y),Z.rotate(z.rotation),Z.scale(Q,J));const ie=Z.multiply(G.invert());this._nodes.forEach(ne=>{var W;const re=ne.getParent().getAbsoluteTransform(),ae=ne.getTransform().copy();ae.translate(ne.offsetX(),ne.offsetY());const he=new r.Transform;he.multiply(re.copy().invert()).multiply(ie).multiply(re).multiply(ae);const ve=he.decompose();ne.setAttrs(ve),(W=ne.getLayer())===null||W===void 0||W.batchDraw()}),this.rotation(r.Util._getRotation(z.rotation)),this._nodes.forEach(ne=>{this._fire("transform",{evt:V,target:ne}),ne._fire("transform",{evt:V,target:ne})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(z,V){this.findOne(z).setAttrs(V)}update(){var z;const V=this._getNodeRect();this.rotation(r.Util._getRotation(V.rotation));const $=V.width,Y=V.height,D=this.enabledAnchors(),q=this.resizeEnabled(),G=this.padding(),Z=this.anchorSize(),Q=this.find("._anchor");Q.forEach(ie=>{ie.setAttrs({width:Z,height:Z,offsetX:Z/2,offsetY:Z/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:Z/2+G,offsetY:Z/2+G,visible:q&&D.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:$/2,y:0,offsetY:Z/2+G,visible:q&&D.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:$,y:0,offsetX:Z/2-G,offsetY:Z/2+G,visible:q&&D.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:Y/2,offsetX:Z/2+G,visible:q&&D.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:$,y:Y/2,offsetX:Z/2-G,visible:q&&D.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:Y,offsetX:Z/2+G,offsetY:Z/2-G,visible:q&&D.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:$/2,y:Y,offsetY:Z/2-G,visible:q&&D.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:$,y:Y,offsetX:Z/2-G,offsetY:Z/2-G,visible:q&&D.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:$/2,y:-this.rotateAnchorOffset()*r.Util._sign(Y)-G,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:$,height:Y,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const J=this.anchorStyleFunc();J&&Q.forEach(ie=>{J(ie)}),(z=this.getLayer())===null||z===void 0||z.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const z=this.findOne("."+this._movingAnchorName);z&&z.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),s.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return n.Node.prototype.toObject.call(this)}clone(z){return n.Node.prototype.clone.call(this,z)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Om.Transformer=O,O.isTransforming=()=>R>0;function B(I){return I instanceof Array||r.Util.warn("enabledAnchors value should be an array"),I instanceof Array&&I.forEach(function(z){k.indexOf(z)===-1&&r.Util.warn("Unknown anchor name: "+z+". Available names are: "+k.join(", "))}),I||[]}return O.prototype.className="Transformer",(0,u._registerNode)(O),e.Factory.addGetterSetter(O,"enabledAnchors",k,B),e.Factory.addGetterSetter(O,"flipEnabled",!0,(0,l.getBooleanValidator)()),e.Factory.addGetterSetter(O,"resizeEnabled",!0),e.Factory.addGetterSetter(O,"anchorSize",10,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(O,"rotateEnabled",!0),e.Factory.addGetterSetter(O,"rotateLineVisible",!0),e.Factory.addGetterSetter(O,"rotationSnaps",[]),e.Factory.addGetterSetter(O,"rotateAnchorOffset",50,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(O,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(O,"rotationSnapTolerance",5,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(O,"borderEnabled",!0),e.Factory.addGetterSetter(O,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(O,"anchorStrokeWidth",1,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(O,"anchorFill","white"),e.Factory.addGetterSetter(O,"anchorCornerRadius",0,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(O,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(O,"borderStrokeWidth",1,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(O,"borderDash"),e.Factory.addGetterSetter(O,"keepRatio",!0),e.Factory.addGetterSetter(O,"shiftBehavior","default"),e.Factory.addGetterSetter(O,"centeredScaling",!1),e.Factory.addGetterSetter(O,"ignoreStroke",!1),e.Factory.addGetterSetter(O,"padding",0,(0,l.getNumberValidator)()),e.Factory.addGetterSetter(O,"node"),e.Factory.addGetterSetter(O,"nodes"),e.Factory.addGetterSetter(O,"boundBoxFunc"),e.Factory.addGetterSetter(O,"anchorDragBoundFunc"),e.Factory.addGetterSetter(O,"anchorStyleFunc"),e.Factory.addGetterSetter(O,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(O,"useSingleNodeRotation",!0),e.Factory.backCompat(O,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Om}var Dm={},f5;function Hz(){if(f5)return Dm;f5=1,Object.defineProperty(Dm,"__esModule",{value:!0}),Dm.Wedge=void 0;const r=fr(),e=ta(),n=ur(),i=gr(),a=ur();let s=class extends e.Shape{_sceneFunc(l){l.beginPath(),l.arc(0,0,this.radius(),0,n.Konva.getAngle(this.angle()),this.clockwise()),l.lineTo(0,0),l.closePath(),l.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(l){this.radius(l/2)}setHeight(l){this.radius(l/2)}};return Dm.Wedge=s,s.prototype.className="Wedge",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,a._registerNode)(s),r.Factory.addGetterSetter(s,"radius",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(s,"angle",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(s,"clockwise",!1),r.Factory.backCompat(s,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Dm}var Im={},p5;function Gz(){if(p5)return Im;p5=1,Object.defineProperty(Im,"__esModule",{value:!0}),Im.Blur=void 0;const r=fr(),e=oi(),n=gr();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const a=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],s=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function o(u,c){const d=u.data,p=u.width,v=u.height;let y,b,S,k,T,C,N,P,R,O,B,I,z,V,$,Y,D,q,G,Z,Q,J,ie,ne,W=c+c+1,re=p-1,ae=v-1,he=c+1,ve=he*(he+1)/2,xe=new i,se=null,ge=xe,le=null,pe=null,me=a[c],be=s[c];for(S=1;S<W;S++)ge=ge.next=new i,S===he&&(se=ge);for(ge.next=xe,N=C=0,b=0;b<v;b++){for(Y=D=q=G=P=R=O=B=0,I=he*(Z=d[C]),z=he*(Q=d[C+1]),V=he*(J=d[C+2]),$=he*(ie=d[C+3]),P+=ve*Z,R+=ve*Q,O+=ve*J,B+=ve*ie,ge=xe,S=0;S<he;S++)ge.r=Z,ge.g=Q,ge.b=J,ge.a=ie,ge=ge.next;for(S=1;S<he;S++)k=C+((re<S?re:S)<<2),P+=(ge.r=Z=d[k])*(ne=he-S),R+=(ge.g=Q=d[k+1])*ne,O+=(ge.b=J=d[k+2])*ne,B+=(ge.a=ie=d[k+3])*ne,Y+=Z,D+=Q,q+=J,G+=ie,ge=ge.next;for(le=xe,pe=se,y=0;y<p;y++)d[C+3]=ie=B*me>>be,ie!==0?(ie=255/ie,d[C]=(P*me>>be)*ie,d[C+1]=(R*me>>be)*ie,d[C+2]=(O*me>>be)*ie):d[C]=d[C+1]=d[C+2]=0,P-=I,R-=z,O-=V,B-=$,I-=le.r,z-=le.g,V-=le.b,$-=le.a,k=N+((k=y+c+1)<re?k:re)<<2,Y+=le.r=d[k],D+=le.g=d[k+1],q+=le.b=d[k+2],G+=le.a=d[k+3],P+=Y,R+=D,O+=q,B+=G,le=le.next,I+=Z=pe.r,z+=Q=pe.g,V+=J=pe.b,$+=ie=pe.a,Y-=Z,D-=Q,q-=J,G-=ie,pe=pe.next,C+=4;N+=p}for(y=0;y<p;y++){for(D=q=G=Y=R=O=B=P=0,C=y<<2,I=he*(Z=d[C]),z=he*(Q=d[C+1]),V=he*(J=d[C+2]),$=he*(ie=d[C+3]),P+=ve*Z,R+=ve*Q,O+=ve*J,B+=ve*ie,ge=xe,S=0;S<he;S++)ge.r=Z,ge.g=Q,ge.b=J,ge.a=ie,ge=ge.next;for(T=p,S=1;S<=c;S++)C=T+y<<2,P+=(ge.r=Z=d[C])*(ne=he-S),R+=(ge.g=Q=d[C+1])*ne,O+=(ge.b=J=d[C+2])*ne,B+=(ge.a=ie=d[C+3])*ne,Y+=Z,D+=Q,q+=J,G+=ie,ge=ge.next,S<ae&&(T+=p);for(C=y,le=xe,pe=se,b=0;b<v;b++)k=C<<2,d[k+3]=ie=B*me>>be,ie>0?(ie=255/ie,d[k]=(P*me>>be)*ie,d[k+1]=(R*me>>be)*ie,d[k+2]=(O*me>>be)*ie):d[k]=d[k+1]=d[k+2]=0,P-=I,R-=z,O-=V,B-=$,I-=le.r,z-=le.g,V-=le.b,$-=le.a,k=y+((k=b+he)<ae?k:ae)*p<<2,P+=Y+=le.r=d[k],R+=D+=le.g=d[k+1],O+=q+=le.b=d[k+2],B+=G+=le.a=d[k+3],le=le.next,I+=Z=pe.r,z+=Q=pe.g,V+=J=pe.b,$+=ie=pe.a,Y-=Z,D-=Q,q-=J,G-=ie,pe=pe.next,C+=p}}const l=function(c){const d=Math.round(this.blurRadius());d>0&&o(c,d)};return Im.Blur=l,r.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),Im}var Bm={},m5;function qz(){if(m5)return Bm;m5=1,Object.defineProperty(Bm,"__esModule",{value:!0}),Bm.Brighten=void 0;const r=fr(),e=oi(),n=gr(),i=function(a){let s=this.brightness()*255,o=a.data,l=o.length,u;for(u=0;u<l;u+=4)o[u]+=s,o[u+1]+=s,o[u+2]+=s};return Bm.Brighten=i,r.Factory.addGetterSetter(e.Node,"brightness",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),Bm}var zm={},g5;function Wz(){if(g5)return zm;g5=1,Object.defineProperty(zm,"__esModule",{value:!0}),zm.Contrast=void 0;const r=fr(),e=oi(),n=gr(),i=function(a){const s=Math.pow((this.contrast()+100)/100,2);let o=a.data,l=o.length,u=150,c=150,d=150,p;for(p=0;p<l;p+=4)u=o[p],c=o[p+1],d=o[p+2],u/=255,u-=.5,u*=s,u+=.5,u*=255,c/=255,c-=.5,c*=s,c+=.5,c*=255,d/=255,d-=.5,d*=s,d+=.5,d*=255,u=u<0?0:u>255?255:u,c=c<0?0:c>255?255:c,d=d<0?0:d>255?255:d,o[p]=u,o[p+1]=c,o[p+2]=d};return zm.Contrast=i,r.Factory.addGetterSetter(e.Node,"contrast",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),zm}var Fm={},v5;function $z(){if(v5)return Fm;v5=1,Object.defineProperty(Fm,"__esModule",{value:!0}),Fm.Emboss=void 0;const r=fr(),e=oi(),n=Yn(),i=gr(),a=function(s){let o=this.embossStrength()*10,l=this.embossWhiteLevel()*255,u=this.embossDirection(),c=this.embossBlend(),d=0,p=0,v=s.data,y=s.width,b=s.height,S=y*4,k=b;switch(u){case"top-left":d=-1,p=-1;break;case"top":d=-1,p=0;break;case"top-right":d=-1,p=1;break;case"right":d=0,p=1;break;case"bottom-right":d=1,p=1;break;case"bottom":d=1,p=0;break;case"bottom-left":d=1,p=-1;break;case"left":d=0,p=-1;break;default:n.Util.error("Unknown emboss direction: "+u)}do{const T=(k-1)*S;let C=d;k+C<1&&(C=0),k+C>b&&(C=0);const N=(k-1+C)*y*4;let P=y;do{const R=T+(P-1)*4;let O=p;P+O<1&&(O=0),P+O>y&&(O=0);const B=N+(P-1+O)*4,I=v[R]-v[B],z=v[R+1]-v[B+1],V=v[R+2]-v[B+2];let $=I;const Y=$>0?$:-$,D=z>0?z:-z,q=V>0?V:-V;if(D>Y&&($=z),q>Y&&($=V),$*=o,c){const G=v[R]+$,Z=v[R+1]+$,Q=v[R+2]+$;v[R]=G>255?255:G<0?0:G,v[R+1]=Z>255?255:Z<0?0:Z,v[R+2]=Q>255?255:Q<0?0:Q}else{let G=l-$;G<0?G=0:G>255&&(G=255),v[R]=v[R+1]=v[R+2]=G}}while(--P)}while(--k)};return Fm.Emboss=a,r.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,i.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,i.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"embossDirection","top-left",null,r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"embossBlend",!1,null,r.Factory.afterSetFilter),Fm}var Vm={},y5;function Kz(){if(y5)return Vm;y5=1,Object.defineProperty(Vm,"__esModule",{value:!0}),Vm.Enhance=void 0;const r=fr(),e=oi(),n=gr();function i(s,o,l,u,c){let d=l-o,p=c-u,v;return d===0?u+p/2:p===0?u:(v=(s-o)/d,v=p*v+u,v)}const a=function(s){let o=s.data,l=o.length,u=o[0],c=u,d,p=o[1],v=p,y,b=o[2],S=b,k,T;const C=this.enhance();if(C===0)return;for(T=0;T<l;T+=4)d=o[T+0],d<u?u=d:d>c&&(c=d),y=o[T+1],y<p?p=y:y>v&&(v=y),k=o[T+2],k<b?b=k:k>S&&(S=k);c===u&&(c=255,u=0),v===p&&(v=255,p=0),S===b&&(S=255,b=0);let N,P,R,O,B,I,z,V,$;for(C>0?(P=c+C*(255-c),R=u-C*(u-0),B=v+C*(255-v),I=p-C*(p-0),V=S+C*(255-S),$=b-C*(b-0)):(N=(c+u)*.5,P=c+C*(c-N),R=u+C*(u-N),O=(v+p)*.5,B=v+C*(v-O),I=p+C*(p-O),z=(S+b)*.5,V=S+C*(S-z),$=b+C*(b-z)),T=0;T<l;T+=4)o[T+0]=i(o[T+0],u,c,R,P),o[T+1]=i(o[T+1],p,v,I,B),o[T+2]=i(o[T+2],b,S,$,V)};return Vm.Enhance=a,r.Factory.addGetterSetter(e.Node,"enhance",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),Vm}var Um={},x5;function Zz(){if(x5)return Um;x5=1,Object.defineProperty(Um,"__esModule",{value:!0}),Um.Grayscale=void 0;const r=function(e){let n=e.data,i=n.length,a,s;for(a=0;a<i;a+=4)s=.34*n[a]+.5*n[a+1]+.16*n[a+2],n[a]=s,n[a+1]=s,n[a+2]=s};return Um.Grayscale=r,Um}var Hm={},b5;function Yz(){if(b5)return Hm;b5=1,Object.defineProperty(Hm,"__esModule",{value:!0}),Hm.HSL=void 0;const r=fr(),e=oi(),n=gr();r.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"luminance",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter);const i=function(a){let s=a.data,o=s.length,l=1,u=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,d=this.luminance()*127,p;const v=l*u*Math.cos(c*Math.PI/180),y=l*u*Math.sin(c*Math.PI/180),b=.299*l+.701*v+.167*y,S=.587*l-.587*v+.33*y,k=.114*l-.114*v-.497*y,T=.299*l-.299*v-.328*y,C=.587*l+.413*v+.035*y,N=.114*l-.114*v+.293*y,P=.299*l-.3*v+1.25*y,R=.587*l-.586*v-1.05*y,O=.114*l+.886*v-.2*y;let B,I,z,V;for(p=0;p<o;p+=4)B=s[p+0],I=s[p+1],z=s[p+2],V=s[p+3],s[p+0]=b*B+S*I+k*z+d,s[p+1]=T*B+C*I+N*z+d,s[p+2]=P*B+R*I+O*z+d,s[p+3]=V};return Hm.HSL=i,Hm}var Gm={},w5;function Xz(){if(w5)return Gm;w5=1,Object.defineProperty(Gm,"__esModule",{value:!0}),Gm.HSV=void 0;const r=fr(),e=oi(),n=gr(),i=function(a){const s=a.data,o=s.length,l=Math.pow(2,this.value()),u=Math.pow(2,this.saturation()),c=Math.abs(this.hue()+360)%360,d=l*u*Math.cos(c*Math.PI/180),p=l*u*Math.sin(c*Math.PI/180),v=.299*l+.701*d+.167*p,y=.587*l-.587*d+.33*p,b=.114*l-.114*d-.497*p,S=.299*l-.299*d-.328*p,k=.587*l+.413*d+.035*p,T=.114*l-.114*d+.293*p,C=.299*l-.3*d+1.25*p,N=.587*l-.586*d-1.05*p,P=.114*l+.886*d-.2*p;let R,O,B,I;for(let z=0;z<o;z+=4)R=s[z+0],O=s[z+1],B=s[z+2],I=s[z+3],s[z+0]=v*R+y*O+b*B,s[z+1]=S*R+k*O+T*B,s[z+2]=C*R+N*O+P*B,s[z+3]=I};return Gm.HSV=i,r.Factory.addGetterSetter(e.Node,"hue",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"saturation",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"value",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),Gm}var qm={},_5;function Qz(){if(_5)return qm;_5=1,Object.defineProperty(qm,"__esModule",{value:!0}),qm.Invert=void 0;const r=function(e){let n=e.data,i=n.length,a;for(a=0;a<i;a+=4)n[a]=255-n[a],n[a+1]=255-n[a+1],n[a+2]=255-n[a+2]};return qm.Invert=r,qm}var Wm={},S5;function Jz(){if(S5)return Wm;S5=1,Object.defineProperty(Wm,"__esModule",{value:!0}),Wm.Kaleidoscope=void 0;const r=fr(),e=oi(),n=Yn(),i=gr(),a=function(l,u,c){let d=l.data,p=u.data,v=l.width,y=l.height,b=c.polarCenterX||v/2,S=c.polarCenterY||y/2,k,T,C,N=0,P=0,R=0,O=0,B,I=Math.sqrt(b*b+S*S);T=v-b,C=y-S,B=Math.sqrt(T*T+C*C),I=B>I?B:I;let z=y,V=v,$,Y,D=360/V*Math.PI/180,q,G;for(Y=0;Y<V;Y+=1)for(q=Math.sin(Y*D),G=Math.cos(Y*D),$=0;$<z;$+=1)T=Math.floor(b+I*$/z*G),C=Math.floor(S+I*$/z*q),k=(C*v+T)*4,N=d[k+0],P=d[k+1],R=d[k+2],O=d[k+3],k=(Y+$*v)*4,p[k+0]=N,p[k+1]=P,p[k+2]=R,p[k+3]=O},s=function(l,u,c){let d=l.data,p=u.data,v=l.width,y=l.height,b=c.polarCenterX||v/2,S=c.polarCenterY||y/2,k,T,C,N,P,R=0,O=0,B=0,I=0,z,V=Math.sqrt(b*b+S*S);T=v-b,C=y-S,z=Math.sqrt(T*T+C*C),V=z>V?z:V;let $=y,Y=v,D,q,G=0,Z,Q;for(T=0;T<v;T+=1)for(C=0;C<y;C+=1)N=T-b,P=C-S,D=Math.sqrt(N*N+P*P)*$/V,q=(Math.atan2(P,N)*180/Math.PI+360+G)%360,q=q*Y/360,Z=Math.floor(q),Q=Math.floor(D),k=(Q*v+Z)*4,R=d[k+0],O=d[k+1],B=d[k+2],I=d[k+3],k=(C*v+T)*4,p[k+0]=R,p[k+1]=O,p[k+2]=B,p[k+3]=I},o=function(l){const u=l.width,c=l.height;let d,p,v,y,b,S,k,T,C,N,P=Math.round(this.kaleidoscopePower());const R=Math.round(this.kaleidoscopeAngle()),O=Math.floor(u*(R%360)/360);if(P<1)return;const B=n.Util.createCanvasElement();B.width=u,B.height=c;const I=B.getContext("2d").getImageData(0,0,u,c);n.Util.releaseCanvas(B),a(l,I,{polarCenterX:u/2,polarCenterY:c/2});let z=u/Math.pow(2,P);for(;z<=8;)z=z*2,P-=1;z=Math.ceil(z);let V=z,$=0,Y=V,D=1;for(O+z>u&&($=V,Y=0,D=-1),p=0;p<c;p+=1)for(d=$;d!==Y;d+=D)v=Math.round(d+O)%u,C=(u*p+v)*4,b=I.data[C+0],S=I.data[C+1],k=I.data[C+2],T=I.data[C+3],N=(u*p+d)*4,I.data[N+0]=b,I.data[N+1]=S,I.data[N+2]=k,I.data[N+3]=T;for(p=0;p<c;p+=1)for(V=Math.floor(z),y=0;y<P;y+=1){for(d=0;d<V+1;d+=1)C=(u*p+d)*4,b=I.data[C+0],S=I.data[C+1],k=I.data[C+2],T=I.data[C+3],N=(u*p+V*2-d-1)*4,I.data[N+0]=b,I.data[N+1]=S,I.data[N+2]=k,I.data[N+3]=T;V*=2}s(I,l,{})};return Wm.Kaleidoscope=o,r.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,i.getNumberValidator)(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,i.getNumberValidator)(),r.Factory.afterSetFilter),Wm}var $m={},k5;function eF(){if(k5)return $m;k5=1,Object.defineProperty($m,"__esModule",{value:!0}),$m.Mask=void 0;const r=fr(),e=oi(),n=gr();function i(v,y,b){let S=(b*v.width+y)*4;const k=[];return k.push(v.data[S++],v.data[S++],v.data[S++],v.data[S++]),k}function a(v,y){return Math.sqrt(Math.pow(v[0]-y[0],2)+Math.pow(v[1]-y[1],2)+Math.pow(v[2]-y[2],2))}function s(v){const y=[0,0,0];for(let b=0;b<v.length;b++)y[0]+=v[b][0],y[1]+=v[b][1],y[2]+=v[b][2];return y[0]/=v.length,y[1]/=v.length,y[2]/=v.length,y}function o(v,y){const b=i(v,0,0),S=i(v,v.width-1,0),k=i(v,0,v.height-1),T=i(v,v.width-1,v.height-1),C=y||10;if(a(b,S)<C&&a(S,T)<C&&a(T,k)<C&&a(k,b)<C){const N=s([S,b,T,k]),P=[];for(let R=0;R<v.width*v.height;R++){const O=a(N,[v.data[R*4],v.data[R*4+1],v.data[R*4+2]]);P[R]=O<C?0:255}return P}}function l(v,y){for(let b=0;b<v.width*v.height;b++)v.data[4*b+3]=y[b]}function u(v,y,b){const S=[1,1,1,1,0,1,1,1,1],k=Math.round(Math.sqrt(S.length)),T=Math.floor(k/2),C=[];for(let N=0;N<b;N++)for(let P=0;P<y;P++){const R=N*y+P;let O=0;for(let B=0;B<k;B++)for(let I=0;I<k;I++){const z=N+B-T,V=P+I-T;if(z>=0&&z<b&&V>=0&&V<y){const $=z*y+V,Y=S[B*k+I];O+=v[$]*Y}}C[R]=O===2040?255:0}return C}function c(v,y,b){const S=[1,1,1,1,1,1,1,1,1],k=Math.round(Math.sqrt(S.length)),T=Math.floor(k/2),C=[];for(let N=0;N<b;N++)for(let P=0;P<y;P++){const R=N*y+P;let O=0;for(let B=0;B<k;B++)for(let I=0;I<k;I++){const z=N+B-T,V=P+I-T;if(z>=0&&z<b&&V>=0&&V<y){const $=z*y+V,Y=S[B*k+I];O+=v[$]*Y}}C[R]=O>=1020?255:0}return C}function d(v,y,b){const S=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],k=Math.round(Math.sqrt(S.length)),T=Math.floor(k/2),C=[];for(let N=0;N<b;N++)for(let P=0;P<y;P++){const R=N*y+P;let O=0;for(let B=0;B<k;B++)for(let I=0;I<k;I++){const z=N+B-T,V=P+I-T;if(z>=0&&z<b&&V>=0&&V<y){const $=z*y+V,Y=S[B*k+I];O+=v[$]*Y}}C[R]=O}return C}const p=function(v){let y=this.threshold(),b=o(v,y);return b&&(b=u(b,v.width,v.height),b=c(b,v.width,v.height),b=d(b,v.width,v.height),l(v,b)),v};return $m.Mask=p,r.Factory.addGetterSetter(e.Node,"threshold",0,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),$m}var Km={},C5;function tF(){if(C5)return Km;C5=1,Object.defineProperty(Km,"__esModule",{value:!0}),Km.Noise=void 0;const r=fr(),e=oi(),n=gr(),i=function(a){const s=this.noise()*255,o=a.data,l=o.length,u=s/2;for(let c=0;c<l;c+=4)o[c+0]+=u-2*u*Math.random(),o[c+1]+=u-2*u*Math.random(),o[c+2]+=u-2*u*Math.random()};return Km.Noise=i,r.Factory.addGetterSetter(e.Node,"noise",.2,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),Km}var Zm={},E5;function rF(){if(E5)return Zm;E5=1,Object.defineProperty(Zm,"__esModule",{value:!0}),Zm.Pixelate=void 0;const r=fr(),e=Yn(),n=oi(),i=gr(),a=function(s){let o=Math.ceil(this.pixelSize()),l=s.width,u=s.height,c,d,p,v,y,b,S,k=Math.ceil(l/o),T=Math.ceil(u/o),C,N,P,R,O,B,I,z=s.data;if(o<=0){e.Util.error("pixelSize value can not be <= 0");return}for(O=0;O<k;O+=1)for(B=0;B<T;B+=1){for(v=0,y=0,b=0,S=0,C=O*o,N=C+o,P=B*o,R=P+o,I=0,c=C;c<N;c+=1)if(!(c>=l))for(d=P;d<R;d+=1)d>=u||(p=(l*d+c)*4,v+=z[p+0],y+=z[p+1],b+=z[p+2],S+=z[p+3],I+=1);for(v=v/I,y=y/I,b=b/I,S=S/I,c=C;c<N;c+=1)if(!(c>=l))for(d=P;d<R;d+=1)d>=u||(p=(l*d+c)*4,z[p+0]=v,z[p+1]=y,z[p+2]=b,z[p+3]=S)}};return Zm.Pixelate=a,r.Factory.addGetterSetter(n.Node,"pixelSize",8,(0,i.getNumberValidator)(),r.Factory.afterSetFilter),Zm}var Ym={},N5;function nF(){if(N5)return Ym;N5=1,Object.defineProperty(Ym,"__esModule",{value:!0}),Ym.Posterize=void 0;const r=fr(),e=oi(),n=gr(),i=function(a){let s=Math.round(this.levels()*254)+1,o=a.data,l=o.length,u=255/s,c;for(c=0;c<l;c+=1)o[c]=Math.floor(o[c]/u)*u};return Ym.Posterize=i,r.Factory.addGetterSetter(e.Node,"levels",.5,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),Ym}var Xm={},T5;function iF(){if(T5)return Xm;T5=1,Object.defineProperty(Xm,"__esModule",{value:!0}),Xm.RGB=void 0;const r=fr(),e=oi(),n=gr(),i=function(a){let s=a.data,o=s.length,l=this.red(),u=this.green(),c=this.blue(),d,p;for(d=0;d<o;d+=4)p=(.34*s[d]+.5*s[d+1]+.16*s[d+2])/255,s[d]=p*l,s[d+1]=p*u,s[d+2]=p*c,s[d+3]=s[d+3]};return Xm.RGB=i,r.Factory.addGetterSetter(e.Node,"red",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)}),r.Factory.addGetterSetter(e.Node,"green",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)}),r.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,r.Factory.afterSetFilter),Xm}var Qm={},P5;function aF(){if(P5)return Qm;P5=1,Object.defineProperty(Qm,"__esModule",{value:!0}),Qm.RGBA=void 0;const r=fr(),e=oi(),n=gr(),i=function(a){const s=a.data,o=s.length,l=this.red(),u=this.green(),c=this.blue(),d=this.alpha();for(let p=0;p<o;p+=4){const v=1-d;s[p]=l*d+s[p]*v,s[p+1]=u*d+s[p+1]*v,s[p+2]=c*d+s[p+2]*v}};return Qm.RGBA=i,r.Factory.addGetterSetter(e.Node,"red",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)}),r.Factory.addGetterSetter(e.Node,"green",0,function(a){return this._filterUpToDate=!1,a>255?255:a<0?0:Math.round(a)}),r.Factory.addGetterSetter(e.Node,"blue",0,n.RGBComponent,r.Factory.afterSetFilter),r.Factory.addGetterSetter(e.Node,"alpha",1,function(a){return this._filterUpToDate=!1,a>1?1:a<0?0:a}),Qm}var Jm={},M5;function sF(){if(M5)return Jm;M5=1,Object.defineProperty(Jm,"__esModule",{value:!0}),Jm.Sepia=void 0;const r=function(e){let n=e.data,i=n.length,a,s,o,l;for(a=0;a<i;a+=4)s=n[a+0],o=n[a+1],l=n[a+2],n[a+0]=Math.min(255,s*.393+o*.769+l*.189),n[a+1]=Math.min(255,s*.349+o*.686+l*.168),n[a+2]=Math.min(255,s*.272+o*.534+l*.131)};return Jm.Sepia=r,Jm}var eg={},A5;function oF(){if(A5)return eg;A5=1,Object.defineProperty(eg,"__esModule",{value:!0}),eg.Solarize=void 0;const r=function(e){const n=e.data,i=e.width,a=e.height,s=i*4;let o=a;do{const l=(o-1)*s;let u=i;do{const c=l+(u-1)*4;let d=n[c],p=n[c+1],v=n[c+2];d>127&&(d=255-d),p>127&&(p=255-p),v>127&&(v=255-v),n[c]=d,n[c+1]=p,n[c+2]=v}while(--u)}while(--o)};return eg.Solarize=r,eg}var tg={},j5;function lF(){if(j5)return tg;j5=1,Object.defineProperty(tg,"__esModule",{value:!0}),tg.Threshold=void 0;const r=fr(),e=oi(),n=gr(),i=function(a){const s=this.threshold()*255,o=a.data,l=o.length;for(let u=0;u<l;u+=1)o[u]=o[u]<s?0:255};return tg.Threshold=i,r.Factory.addGetterSetter(e.Node,"threshold",.5,(0,n.getNumberValidator)(),r.Factory.afterSetFilter),tg}var R5;function uF(){if(R5)return mm;R5=1,Object.defineProperty(mm,"__esModule",{value:!0}),mm.Konva=void 0;const r=I2(),e=Mz(),n=jz(),i=Rz(),a=Lz(),s=Oz(),o=Dz(),l=gM(),u=tS(),c=vM(),d=Iz(),p=Bz(),v=zz(),y=Fz(),b=yM(),S=Vz(),k=Uz(),T=Hz(),C=Gz(),N=qz(),P=Wz(),R=$z(),O=Kz(),B=Zz(),I=Yz(),z=Xz(),V=Qz(),$=Jz(),Y=eF(),D=tF(),q=rF(),G=nF(),Z=iF(),Q=aF(),J=sF(),ie=oF(),ne=lF();return mm.Konva=r.Konva.Util._assign(r.Konva,{Arc:e.Arc,Arrow:n.Arrow,Circle:i.Circle,Ellipse:a.Ellipse,Image:s.Image,Label:o.Label,Tag:o.Tag,Line:l.Line,Path:u.Path,Rect:c.Rect,RegularPolygon:d.RegularPolygon,Ring:p.Ring,Sprite:v.Sprite,Star:y.Star,Text:b.Text,TextPath:S.TextPath,Transformer:k.Transformer,Wedge:T.Wedge,Filters:{Blur:C.Blur,Brighten:N.Brighten,Contrast:P.Contrast,Emboss:R.Emboss,Enhance:O.Enhance,Grayscale:B.Grayscale,HSL:I.HSL,HSV:z.HSV,Invert:V.Invert,Kaleidoscope:$.Kaleidoscope,Mask:Y.Mask,Noise:D.Noise,Pixelate:q.Pixelate,Posterize:G.Posterize,RGB:Z.RGB,RGBA:Q.RGBA,Sepia:J.Sepia,Solarize:ie.Solarize,Threshold:ne.Threshold}}),mm}var cF=K0.exports,L5;function dF(){if(L5)return K0.exports;L5=1,Object.defineProperty(cF,"__esModule",{value:!0});const r=uF();return K0.exports=r.Konva,K0.exports}dF();var w0={exports:{}},O5;function hF(){return O5||(O5=1,(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var n=I2();Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return n.Konva}});const i=I2();r.exports=i.Konva})(w0,w0.exports)),w0.exports}var fF=hF();const Gg=Kh(fF);var Sw={exports:{}};var kw,D5;function pF(){return D5||(D5=1,kw=function(e){var n={},i=Cp(),a=__(),s=Object.assign;function o(x){for(var w="https://reactjs.org/docs/error-decoder.html?invariant="+x,A=1;A<arguments.length;A++)w+="&args[]="+encodeURIComponent(arguments[A]);return"Minified React error #"+x+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),c=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),b=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),P=Symbol.for("react.offscreen"),R=Symbol.iterator;function O(x){return x===null||typeof x!="object"?null:(x=R&&x[R]||x["@@iterator"],typeof x=="function"?x:null)}function B(x){if(x==null)return null;if(typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case d:return"Fragment";case c:return"Portal";case v:return"Profiler";case p:return"StrictMode";case k:return"Suspense";case T:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case b:return(x.displayName||"Context")+".Consumer";case y:return(x._context.displayName||"Context")+".Provider";case S:var w=x.render;return x=x.displayName,x||(x=w.displayName||w.name||"",x=x!==""?"ForwardRef("+x+")":"ForwardRef"),x;case C:return w=x.displayName||null,w!==null?w:B(x.type)||"Memo";case N:w=x._payload,x=x._init;try{return B(x(w))}catch{}}return null}function I(x){var w=x.type;switch(x.tag){case 24:return"Cache";case 9:return(w.displayName||"Context")+".Consumer";case 10:return(w._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return x=w.render,x=x.displayName||x.name||"",w.displayName||(x!==""?"ForwardRef("+x+")":"ForwardRef");case 7:return"Fragment";case 5:return w;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(w);case 8:return w===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof w=="function")return w.displayName||w.name||null;if(typeof w=="string")return w}return null}function z(x){var w=x,A=x;if(x.alternate)for(;w.return;)w=w.return;else{x=w;do w=x,(w.flags&4098)!==0&&(A=w.return),x=w.return;while(x)}return w.tag===3?A:null}function V(x){if(z(x)!==x)throw Error(o(188))}function $(x){var w=x.alternate;if(!w){if(w=z(x),w===null)throw Error(o(188));return w!==x?null:x}for(var A=x,F=w;;){var K=A.return;if(K===null)break;var te=K.alternate;if(te===null){if(F=K.return,F!==null){A=F;continue}break}if(K.child===te.child){for(te=K.child;te;){if(te===A)return V(K),x;if(te===F)return V(K),w;te=te.sibling}throw Error(o(188))}if(A.return!==F.return)A=K,F=te;else{for(var fe=!1,Pe=K.child;Pe;){if(Pe===A){fe=!0,A=K,F=te;break}if(Pe===F){fe=!0,F=K,A=te;break}Pe=Pe.sibling}if(!fe){for(Pe=te.child;Pe;){if(Pe===A){fe=!0,A=te,F=K;break}if(Pe===F){fe=!0,F=te,A=K;break}Pe=Pe.sibling}if(!fe)throw Error(o(189))}}if(A.alternate!==F)throw Error(o(190))}if(A.tag!==3)throw Error(o(188));return A.stateNode.current===A?x:w}function Y(x){return x=$(x),x!==null?D(x):null}function D(x){if(x.tag===5||x.tag===6)return x;for(x=x.child;x!==null;){var w=D(x);if(w!==null)return w;x=x.sibling}return null}function q(x){if(x.tag===5||x.tag===6)return x;for(x=x.child;x!==null;){if(x.tag!==4){var w=q(x);if(w!==null)return w}x=x.sibling}return null}var G=Array.isArray,Z=e.getPublicInstance,Q=e.getRootHostContext,J=e.getChildHostContext,ie=e.prepareForCommit,ne=e.resetAfterCommit,W=e.createInstance,re=e.appendInitialChild,ae=e.finalizeInitialChildren,he=e.prepareUpdate,ve=e.shouldSetTextContent,xe=e.createTextInstance,se=e.scheduleTimeout,ge=e.cancelTimeout,le=e.noTimeout,pe=e.isPrimaryRenderer,me=e.supportsMutation,be=e.supportsPersistence,Se=e.supportsHydration,Ue=e.getInstanceFromNode,We=e.preparePortalMount,gt=e.getCurrentEventPriority,Je=e.detachDeletedInstance,at=e.supportsMicrotasks,Ve=e.scheduleMicrotask,Oe=e.supportsTestSelectors,et=e.findFiberRoot,Ne=e.getBoundingRect,ze=e.getTextContent,Ke=e.isHiddenSubtree,ft=e.matchAccessibilityRole,yt=e.setFocusIfFocusable,Et=e.setupIntersectionObserver,Rt=e.appendChild,$t=e.appendChildToContainer,wt=e.commitTextUpdate,ot=e.commitMount,qe=e.commitUpdate,de=e.insertBefore,ye=e.insertInContainerBefore,Ce=e.removeChild,Te=e.removeChildFromContainer,Re=e.resetTextContent,Ze=e.hideInstance,Ge=e.hideTextInstance,ct=e.unhideInstance,ut=e.unhideTextInstance,kt=e.clearContainer,zt=e.cloneInstance,Ft=e.createContainerChildSet,xt=e.appendChildToContainerChildSet,Gt=e.finalizeContainerChildren,Wt=e.replaceContainerChildren,kr=e.cloneHiddenInstance,pr=e.cloneHiddenTextInstance,pn=e.canHydrateInstance,qr=e.canHydrateTextInstance,Wr=e.canHydrateSuspenseInstance,an=e.isSuspenseInstancePending,cr=e.isSuspenseInstanceFallback,bt=e.getSuspenseInstanceFallbackErrorDetails,Or=e.registerSuspenseInstanceRetry,Xn=e.getNextHydratableSibling,Ma=e.getFirstHydratableChild,Is=e.getFirstHydratableChildWithinContainer,eo=e.getFirstHydratableChildWithinSuspenseInstance,ci=e.hydrateInstance,sn=e.hydrateTextInstance,bn=e.hydrateSuspenseInstance,di=e.getNextHydratableInstanceAfterSuspenseInstance,to=e.commitHydratedContainer,_i=e.commitHydratedSuspenseInstance,lu=e.clearSuspenseBoundary,uu=e.clearSuspenseBoundaryFromContainer,zd=e.shouldDeleteUnhydratedTailInstances,pl=e.didNotMatchHydratedContainerTextInstance,Qr=e.didNotMatchHydratedTextInstance,cu;function Bs(x){if(cu===void 0)try{throw Error()}catch(A){var w=A.stack.trim().match(/\n( *(at )?)/);cu=w&&w[1]||""}return`
`+cu+x}var ml=!1;function Aa(x,w){if(!x||ml)return"";ml=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(w)if(w=function(){throw Error()},Object.defineProperty(w.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(w,[])}catch(it){var F=it}Reflect.construct(x,[],w)}else{try{w.call()}catch(it){F=it}x.call(w.prototype)}else{try{throw Error()}catch(it){F=it}x()}}catch(it){if(it&&F&&typeof it.stack=="string"){for(var K=it.stack.split(`
`),te=F.stack.split(`
`),fe=K.length-1,Pe=te.length-1;1<=fe&&0<=Pe&&K[fe]!==te[Pe];)Pe--;for(;1<=fe&&0<=Pe;fe--,Pe--)if(K[fe]!==te[Pe]){if(fe!==1||Pe!==1)do if(fe--,Pe--,0>Pe||K[fe]!==te[Pe]){var Fe=`
`+K[fe].replace(" at new "," at ");return x.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",x.displayName)),Fe}while(1<=fe&&0<=Pe);break}}}finally{ml=!1,Error.prepareStackTrace=A}return(x=x?x.displayName||x.name:"")?Bs(x):""}var Oo=Object.prototype.hasOwnProperty,ra=[],na=-1;function mn(x){return{current:x}}function yr(x){0>na||(x.current=ra[na],ra[na]=null,na--)}function lt(x,w){na++,ra[na]=x.current,x.current=w}var dr={},on=mn(dr),Fr=mn(!1),Tr=dr;function ia(x,w){var A=x.type.contextTypes;if(!A)return dr;var F=x.stateNode;if(F&&F.__reactInternalMemoizedUnmaskedChildContext===w)return F.__reactInternalMemoizedMaskedChildContext;var K={},te;for(te in A)K[te]=w[te];return F&&(x=x.stateNode,x.__reactInternalMemoizedUnmaskedChildContext=w,x.__reactInternalMemoizedMaskedChildContext=K),K}function Mt(x){return x=x.childContextTypes,x!=null}function xr(){yr(Fr),yr(on)}function tc(x,w,A){if(on.current!==dr)throw Error(o(168));lt(on,w),lt(Fr,A)}function du(x,w,A){var F=x.stateNode;if(w=w.childContextTypes,typeof F.getChildContext!="function")return A;F=F.getChildContext();for(var K in F)if(!(K in w))throw Error(o(108,I(x)||"Unknown",K));return s({},A,F)}function Qn(x){return x=(x=x.stateNode)&&x.__reactInternalMemoizedMergedChildContext||dr,Tr=on.current,lt(on,x),lt(Fr,Fr.current),!0}function Fd(x,w,A){var F=x.stateNode;if(!F)throw Error(o(169));A?(x=du(x,w,Tr),F.__reactInternalMemoizedMergedChildContext=x,yr(Fr),yr(on),lt(on,x)):yr(Fr),lt(Fr,A)}var hi=Math.clz32?Math.clz32:zs,Za=Math.log,wn=Math.LN2;function zs(x){return x>>>=0,x===0?32:31-(Za(x)/wn|0)|0}var nr=64,Fs=4194304;function ro(x){switch(x&-x){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return x&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return x}}function ps(x,w){var A=x.pendingLanes;if(A===0)return 0;var F=0,K=x.suspendedLanes,te=x.pingedLanes,fe=A&268435455;if(fe!==0){var Pe=fe&~K;Pe!==0?F=ro(Pe):(te&=fe,te!==0&&(F=ro(te)))}else fe=A&~K,fe!==0?F=ro(fe):te!==0&&(F=ro(te));if(F===0)return 0;if(w!==0&&w!==F&&(w&K)===0&&(K=F&-F,te=w&-w,K>=te||K===16&&(te&4194240)!==0))return w;if((F&4)!==0&&(F|=A&16),w=x.entangledLanes,w!==0)for(x=x.entanglements,w&=F;0<w;)A=31-hi(w),K=1<<A,F|=x[A],w&=~K;return F}function rc(x,w){switch(x){case 1:case 2:case 4:return w+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return w+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nc(x,w){for(var A=x.suspendedLanes,F=x.pingedLanes,K=x.expirationTimes,te=x.pendingLanes;0<te;){var fe=31-hi(te),Pe=1<<fe,Fe=K[fe];Fe===-1?((Pe&A)===0||(Pe&F)!==0)&&(K[fe]=rc(Pe,w)):Fe<=w&&(x.expiredLanes|=Pe),te&=~Pe}}function Do(x){return x=x.pendingLanes&-1073741825,x!==0?x:x&1073741824?1073741824:0}function gl(){var x=nr;return nr<<=1,(nr&4194240)===0&&(nr=64),x}function no(x){for(var w=[],A=0;31>A;A++)w.push(x);return w}function Si(x,w,A){x.pendingLanes|=w,w!==536870912&&(x.suspendedLanes=0,x.pingedLanes=0),x=x.eventTimes,w=31-hi(w),x[w]=A}function Vs(x,w){var A=x.pendingLanes&~w;x.pendingLanes=w,x.suspendedLanes=0,x.pingedLanes=0,x.expiredLanes&=w,x.mutableReadLanes&=w,x.entangledLanes&=w,w=x.entanglements;var F=x.eventTimes;for(x=x.expirationTimes;0<A;){var K=31-hi(A),te=1<<K;w[K]=0,F[K]=-1,x[K]=-1,A&=~te}}function ja(x,w){var A=x.entangledLanes|=w;for(x=x.entanglements;A;){var F=31-hi(A),K=1<<F;K&w|x[F]&w&&(x[F]|=w),A&=~K}}var ir=0;function qt(x){return x&=-x,1<x?4<x?(x&268435455)!==0?16:536870912:4:1}var Dn=a.unstable_scheduleCallback,Pr=a.unstable_cancelCallback,Vd=a.unstable_shouldYield,Io=a.unstable_requestPaint,_n=a.unstable_now,vl=a.unstable_ImmediatePriority,ms=a.unstable_UserBlockingPriority,yl=a.unstable_NormalPriority,hu=a.unstable_IdlePriority,$r=null,Sn=null;function Bo(x){if(Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot($r,x,void 0,(x.current.flags&128)===128)}catch{}}function fu(x,w){return x===w&&(x!==0||1/x===1/w)||x!==x&&w!==w}var Ya=typeof Object.is=="function"?Object.is:fu,gs=null,io=!1,xl=!1;function pu(x){gs===null?gs=[x]:gs.push(x)}function or(x){io=!0,pu(x)}function Jn(){if(!xl&&gs!==null){xl=!0;var x=0,w=ir;try{var A=gs;for(ir=1;x<A.length;x++){var F=A[x];do F=F(!0);while(F!==null)}gs=null,io=!1}catch(K){throw gs!==null&&(gs=gs.slice(x+1)),Dn(vl,Jn),K}finally{ir=w,xl=!1}}return null}var Fn=[],aa=0,bl=null,zo=0,ei=[],sa=0,kn=null,Ri=1,Xa="";function oa(x,w){Fn[aa++]=zo,Fn[aa++]=bl,bl=x,zo=w}function tf(x,w,A){ei[sa++]=Ri,ei[sa++]=Xa,ei[sa++]=kn,kn=x;var F=Ri;x=Xa;var K=32-hi(F)-1;F&=~(1<<K),A+=1;var te=32-hi(w)+K;if(30<te){var fe=K-K%5;te=(F&(1<<fe)-1).toString(32),F>>=fe,K-=fe,Ri=1<<32-hi(w)+K|A<<K|F,Xa=te+x}else Ri=1<<te|A<<K|F,Xa=x}function Li(x){x.return!==null&&(oa(x,1),tf(x,1,0))}function mu(x){for(;x===bl;)bl=Fn[--aa],Fn[aa]=null,zo=Fn[--aa],Fn[aa]=null;for(;x===kn;)kn=ei[--sa],ei[sa]=null,Xa=ei[--sa],ei[sa]=null,Ri=ei[--sa],ei[sa]=null}var Vn=null,ln=null,Dr=!1,wl=!1,la=null;function rf(x,w){var A=ss(5,null,null,0);A.elementType="DELETED",A.stateNode=w,A.return=x,w=x.deletions,w===null?(x.deletions=[A],x.flags|=16):w.push(A)}function gu(x,w){switch(x.tag){case 5:return w=pn(w,x.type,x.pendingProps),w!==null?(x.stateNode=w,Vn=x,ln=Ma(w),!0):!1;case 6:return w=qr(w,x.pendingProps),w!==null?(x.stateNode=w,Vn=x,ln=null,!0):!1;case 13:if(w=Wr(w),w!==null){var A=kn!==null?{id:Ri,overflow:Xa}:null;return x.memoizedState={dehydrated:w,treeContext:A,retryLane:1073741824},A=ss(18,null,null,0),A.stateNode=w,A.return=x,x.child=A,Vn=x,ln=null,!0}return!1;default:return!1}}function ic(x){return(x.mode&1)!==0&&(x.flags&128)===0}function Ud(x){if(Dr){var w=ln;if(w){var A=w;if(!gu(x,w)){if(ic(x))throw Error(o(418));w=Xn(A);var F=Vn;w&&gu(x,w)?rf(F,A):(x.flags=x.flags&-4097|2,Dr=!1,Vn=x)}}else{if(ic(x))throw Error(o(418));x.flags=x.flags&-4097|2,Dr=!1,Vn=x}}}function nf(x){for(x=x.return;x!==null&&x.tag!==5&&x.tag!==3&&x.tag!==13;)x=x.return;Vn=x}function _l(x){if(!Se||x!==Vn)return!1;if(!Dr)return nf(x),Dr=!0,!1;if(x.tag!==3&&(x.tag!==5||zd(x.type)&&!ve(x.type,x.memoizedProps))){var w=ln;if(w){if(ic(x))throw af(),Error(o(418));for(;w;)rf(x,w),w=Xn(w)}}if(nf(x),x.tag===13){if(!Se)throw Error(o(316));if(x=x.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(o(317));ln=di(x)}else ln=Vn?Xn(x.stateNode):null;return!0}function af(){for(var x=ln;x;)x=Xn(x)}function ao(){Se&&(ln=Vn=null,wl=Dr=!1)}function ac(x){la===null?la=[x]:la.push(x)}var sc=l.ReactCurrentBatchConfig;function vs(x,w){if(Ya(x,w))return!0;if(typeof x!="object"||x===null||typeof w!="object"||w===null)return!1;var A=Object.keys(x),F=Object.keys(w);if(A.length!==F.length)return!1;for(F=0;F<A.length;F++){var K=A[F];if(!Oo.call(w,K)||!Ya(x[K],w[K]))return!1}return!0}function Op(x){switch(x.tag){case 5:return Bs(x.type);case 16:return Bs("Lazy");case 13:return Bs("Suspense");case 19:return Bs("SuspenseList");case 0:case 2:case 15:return x=Aa(x.type,!1),x;case 11:return x=Aa(x.type.render,!1),x;case 1:return x=Aa(x.type,!0),x;default:return""}}function Qa(x,w,A){if(x=A.ref,x!==null&&typeof x!="function"&&typeof x!="object"){if(A._owner){if(A=A._owner,A){if(A.tag!==1)throw Error(o(309));var F=A.stateNode}if(!F)throw Error(o(147,x));var K=F,te=""+x;return w!==null&&w.ref!==null&&typeof w.ref=="function"&&w.ref._stringRef===te?w.ref:(w=function(fe){var Pe=K.refs;fe===null?delete Pe[te]:Pe[te]=fe},w._stringRef=te,w)}if(typeof x!="string")throw Error(o(284));if(!A._owner)throw Error(o(290,x))}return x}function ki(x,w){throw x=Object.prototype.toString.call(w),Error(o(31,x==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":x))}function Hd(x){var w=x._init;return w(x._payload)}function Gd(x){function w(Ie,Me){if(x){var He=Ie.deletions;He===null?(Ie.deletions=[Me],Ie.flags|=16):He.push(Me)}}function A(Ie,Me){if(!x)return null;for(;Me!==null;)w(Ie,Me),Me=Me.sibling;return null}function F(Ie,Me){for(Ie=new Map;Me!==null;)Me.key!==null?Ie.set(Me.key,Me):Ie.set(Me.index,Me),Me=Me.sibling;return Ie}function K(Ie,Me){return Ie=Ul(Ie,Me),Ie.index=0,Ie.sibling=null,Ie}function te(Ie,Me,He){return Ie.index=He,x?(He=Ie.alternate,He!==null?(He=He.index,He<Me?(Ie.flags|=2,Me):He):(Ie.flags|=2,Me)):(Ie.flags|=1048576,Me)}function fe(Ie){return x&&Ie.alternate===null&&(Ie.flags|=2),Ie}function Pe(Ie,Me,He,vt){return Me===null||Me.tag!==6?(Me=Oc(He,Ie.mode,vt),Me.return=Ie,Me):(Me=K(Me,He),Me.return=Ie,Me)}function Fe(Ie,Me,He,vt){var Lt=He.type;return Lt===d?Ct(Ie,Me,He.props.children,vt,He.key):Me!==null&&(Me.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===N&&Hd(Lt)===Me.type)?(vt=K(Me,He.props),vt.ref=Qa(Ie,Me,He),vt.return=Ie,vt):(vt=Cf(He.type,He.key,He.props,null,Ie.mode,vt),vt.ref=Qa(Ie,Me,He),vt.return=Ie,vt)}function it(Ie,Me,He,vt){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==He.containerInfo||Me.stateNode.implementation!==He.implementation?(Me=Ef(He,Ie.mode,vt),Me.return=Ie,Me):(Me=K(Me,He.children||[]),Me.return=Ie,Me)}function Ct(Ie,Me,He,vt,Lt){return Me===null||Me.tag!==7?(Me=Ni(He,Ie.mode,vt,Lt),Me.return=Ie,Me):(Me=K(Me,He),Me.return=Ie,Me)}function Zt(Ie,Me,He){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return Me=Oc(""+Me,Ie.mode,He),Me.return=Ie,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case u:return He=Cf(Me.type,Me.key,Me.props,null,Ie.mode,He),He.ref=Qa(Ie,null,Me),He.return=Ie,He;case c:return Me=Ef(Me,Ie.mode,He),Me.return=Ie,Me;case N:var vt=Me._init;return Zt(Ie,vt(Me._payload),He)}if(G(Me)||O(Me))return Me=Ni(Me,Ie.mode,He,null),Me.return=Ie,Me;ki(Ie,Me)}return null}function mt(Ie,Me,He,vt){var Lt=Me!==null?Me.key:null;if(typeof He=="string"&&He!==""||typeof He=="number")return Lt!==null?null:Pe(Ie,Me,""+He,vt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case u:return He.key===Lt?Fe(Ie,Me,He,vt):null;case c:return He.key===Lt?it(Ie,Me,He,vt):null;case N:return Lt=He._init,mt(Ie,Me,Lt(He._payload),vt)}if(G(He)||O(He))return Lt!==null?null:Ct(Ie,Me,He,vt,null);ki(Ie,He)}return null}function Yr(Ie,Me,He,vt,Lt){if(typeof vt=="string"&&vt!==""||typeof vt=="number")return Ie=Ie.get(He)||null,Pe(Me,Ie,""+vt,Lt);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case u:return Ie=Ie.get(vt.key===null?He:vt.key)||null,Fe(Me,Ie,vt,Lt);case c:return Ie=Ie.get(vt.key===null?He:vt.key)||null,it(Me,Ie,vt,Lt);case N:var tr=vt._init;return Yr(Ie,Me,He,tr(vt._payload),Lt)}if(G(vt)||O(vt))return Ie=Ie.get(He)||null,Ct(Me,Ie,vt,Lt,null);ki(Me,vt)}return null}function Rr(Ie,Me,He,vt){for(var Lt=null,tr=null,Yt=Me,vr=Me=0,ai=null;Yt!==null&&vr<He.length;vr++){Yt.index>vr?(ai=Yt,Yt=null):ai=Yt.sibling;var mr=mt(Ie,Yt,He[vr],vt);if(mr===null){Yt===null&&(Yt=ai);break}x&&Yt&&mr.alternate===null&&w(Ie,Yt),Me=te(mr,Me,vr),tr===null?Lt=mr:tr.sibling=mr,tr=mr,Yt=ai}if(vr===He.length)return A(Ie,Yt),Dr&&oa(Ie,vr),Lt;if(Yt===null){for(;vr<He.length;vr++)Yt=Zt(Ie,He[vr],vt),Yt!==null&&(Me=te(Yt,Me,vr),tr===null?Lt=Yt:tr.sibling=Yt,tr=Yt);return Dr&&oa(Ie,vr),Lt}for(Yt=F(Ie,Yt);vr<He.length;vr++)ai=Yr(Yt,Ie,vr,He[vr],vt),ai!==null&&(x&&ai.alternate!==null&&Yt.delete(ai.key===null?vr:ai.key),Me=te(ai,Me,vr),tr===null?Lt=ai:tr.sibling=ai,tr=ai);return x&&Yt.forEach(function(Gi){return w(Ie,Gi)}),Dr&&oa(Ie,vr),Lt}function ya(Ie,Me,He,vt){var Lt=O(He);if(typeof Lt!="function")throw Error(o(150));if(He=Lt.call(He),He==null)throw Error(o(151));for(var tr=Lt=null,Yt=Me,vr=Me=0,ai=null,mr=He.next();Yt!==null&&!mr.done;vr++,mr=He.next()){Yt.index>vr?(ai=Yt,Yt=null):ai=Yt.sibling;var Gi=mt(Ie,Yt,mr.value,vt);if(Gi===null){Yt===null&&(Yt=ai);break}x&&Yt&&Gi.alternate===null&&w(Ie,Yt),Me=te(Gi,Me,vr),tr===null?Lt=Gi:tr.sibling=Gi,tr=Gi,Yt=ai}if(mr.done)return A(Ie,Yt),Dr&&oa(Ie,vr),Lt;if(Yt===null){for(;!mr.done;vr++,mr=He.next())mr=Zt(Ie,mr.value,vt),mr!==null&&(Me=te(mr,Me,vr),tr===null?Lt=mr:tr.sibling=mr,tr=mr);return Dr&&oa(Ie,vr),Lt}for(Yt=F(Ie,Yt);!mr.done;vr++,mr=He.next())mr=Yr(Yt,Ie,vr,mr.value,vt),mr!==null&&(x&&mr.alternate!==null&&Yt.delete(mr.key===null?vr:mr.key),Me=te(mr,Me,vr),tr===null?Lt=mr:tr.sibling=mr,tr=mr);return x&&Yt.forEach(function(t1){return w(Ie,t1)}),Dr&&oa(Ie,vr),Lt}function xo(Ie,Me,He,vt){if(typeof He=="object"&&He!==null&&He.type===d&&He.key===null&&(He=He.props.children),typeof He=="object"&&He!==null){switch(He.$$typeof){case u:e:{for(var Lt=He.key,tr=Me;tr!==null;){if(tr.key===Lt){if(Lt=He.type,Lt===d){if(tr.tag===7){A(Ie,tr.sibling),Me=K(tr,He.props.children),Me.return=Ie,Ie=Me;break e}}else if(tr.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===N&&Hd(Lt)===tr.type){A(Ie,tr.sibling),Me=K(tr,He.props),Me.ref=Qa(Ie,tr,He),Me.return=Ie,Ie=Me;break e}A(Ie,tr);break}else w(Ie,tr);tr=tr.sibling}He.type===d?(Me=Ni(He.props.children,Ie.mode,vt,He.key),Me.return=Ie,Ie=Me):(vt=Cf(He.type,He.key,He.props,null,Ie.mode,vt),vt.ref=Qa(Ie,Me,He),vt.return=Ie,Ie=vt)}return fe(Ie);case c:e:{for(tr=He.key;Me!==null;){if(Me.key===tr)if(Me.tag===4&&Me.stateNode.containerInfo===He.containerInfo&&Me.stateNode.implementation===He.implementation){A(Ie,Me.sibling),Me=K(Me,He.children||[]),Me.return=Ie,Ie=Me;break e}else{A(Ie,Me);break}else w(Ie,Me);Me=Me.sibling}Me=Ef(He,Ie.mode,vt),Me.return=Ie,Ie=Me}return fe(Ie);case N:return tr=He._init,xo(Ie,Me,tr(He._payload),vt)}if(G(He))return Rr(Ie,Me,He,vt);if(O(He))return ya(Ie,Me,He,vt);ki(Ie,He)}return typeof He=="string"&&He!==""||typeof He=="number"?(He=""+He,Me!==null&&Me.tag===6?(A(Ie,Me.sibling),Me=K(Me,He),Me.return=Ie,Ie=Me):(A(Ie,Me),Me=Oc(He,Ie.mode,vt),Me.return=Ie,Ie=Me),fe(Ie)):A(Ie,Me)}return xo}var Fo=Gd(!0),oc=Gd(!1),Sl=mn(null),lc=null,kl=null,uc=null;function qd(){uc=kl=lc=null}function Ra(x,w,A){pe?(lt(Sl,w._currentValue),w._currentValue=A):(lt(Sl,w._currentValue2),w._currentValue2=A)}function ys(x){var w=Sl.current;yr(Sl),pe?x._currentValue=w:x._currentValue2=w}function Vo(x,w,A){for(;x!==null;){var F=x.alternate;if((x.childLanes&w)!==w?(x.childLanes|=w,F!==null&&(F.childLanes|=w)):F!==null&&(F.childLanes&w)!==w&&(F.childLanes|=w),x===A)break;x=x.return}}function Oi(x,w){lc=x,uc=kl=null,x=x.dependencies,x!==null&&x.firstContext!==null&&((x.lanes&w)!==0&&(Tn=!0),x.firstContext=null)}function ua(x){var w=pe?x._currentValue:x._currentValue2;if(uc!==x)if(x={context:x,memoizedValue:w,next:null},kl===null){if(lc===null)throw Error(o(308));kl=x,lc.dependencies={lanes:0,firstContext:x}}else kl=kl.next=x;return w}var ca=null;function cc(x){ca===null?ca=[x]:ca.push(x)}function Uo(x,w,A,F){var K=w.interleaved;return K===null?(A.next=A,cc(w)):(A.next=K.next,K.next=A),w.interleaved=A,La(x,F)}function La(x,w){x.lanes|=w;var A=x.alternate;for(A!==null&&(A.lanes|=w),A=x,x=x.return;x!==null;)x.childLanes|=w,A=x.alternate,A!==null&&(A.childLanes|=w),A=x,x=x.return;return A.tag===3?A.stateNode:null}var fi=!1;function Wd(x){x.updateQueue={baseState:x.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Us(x,w){x=x.updateQueue,w.updateQueue===x&&(w.updateQueue={baseState:x.baseState,firstBaseUpdate:x.firstBaseUpdate,lastBaseUpdate:x.lastBaseUpdate,shared:x.shared,effects:x.effects})}function Oa(x,w){return{eventTime:x,lane:w,tag:0,payload:null,callback:null,next:null}}function Hs(x,w,A){var F=x.updateQueue;if(F===null)return null;if(F=F.shared,(er&2)!==0){var K=F.pending;return K===null?w.next=w:(w.next=K.next,K.next=w),F.pending=w,La(x,A)}return K=F.interleaved,K===null?(w.next=w,cc(F)):(w.next=K.next,K.next=w),F.interleaved=w,La(x,A)}function Ho(x,w,A){if(w=w.updateQueue,w!==null&&(w=w.shared,(A&4194240)!==0)){var F=w.lanes;F&=x.pendingLanes,A|=F,w.lanes=A,ja(x,A)}}function Cl(x,w){var A=x.updateQueue,F=x.alternate;if(F!==null&&(F=F.updateQueue,A===F)){var K=null,te=null;if(A=A.firstBaseUpdate,A!==null){do{var fe={eventTime:A.eventTime,lane:A.lane,tag:A.tag,payload:A.payload,callback:A.callback,next:null};te===null?K=te=fe:te=te.next=fe,A=A.next}while(A!==null);te===null?K=te=w:te=te.next=w}else K=te=w;A={baseState:F.baseState,firstBaseUpdate:K,lastBaseUpdate:te,shared:F.shared,effects:F.effects},x.updateQueue=A;return}x=A.lastBaseUpdate,x===null?A.firstBaseUpdate=w:x.next=w,A.lastBaseUpdate=w}function pi(x,w,A,F){var K=x.updateQueue;fi=!1;var te=K.firstBaseUpdate,fe=K.lastBaseUpdate,Pe=K.shared.pending;if(Pe!==null){K.shared.pending=null;var Fe=Pe,it=Fe.next;Fe.next=null,fe===null?te=it:fe.next=it,fe=Fe;var Ct=x.alternate;Ct!==null&&(Ct=Ct.updateQueue,Pe=Ct.lastBaseUpdate,Pe!==fe&&(Pe===null?Ct.firstBaseUpdate=it:Pe.next=it,Ct.lastBaseUpdate=Fe))}if(te!==null){var Zt=K.baseState;fe=0,Ct=it=Fe=null,Pe=te;do{var mt=Pe.lane,Yr=Pe.eventTime;if((F&mt)===mt){Ct!==null&&(Ct=Ct.next={eventTime:Yr,lane:0,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null});e:{var Rr=x,ya=Pe;switch(mt=w,Yr=A,ya.tag){case 1:if(Rr=ya.payload,typeof Rr=="function"){Zt=Rr.call(Yr,Zt,mt);break e}Zt=Rr;break e;case 3:Rr.flags=Rr.flags&-65537|128;case 0:if(Rr=ya.payload,mt=typeof Rr=="function"?Rr.call(Yr,Zt,mt):Rr,mt==null)break e;Zt=s({},Zt,mt);break e;case 2:fi=!0}}Pe.callback!==null&&Pe.lane!==0&&(x.flags|=64,mt=K.effects,mt===null?K.effects=[Pe]:mt.push(Pe))}else Yr={eventTime:Yr,lane:mt,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null},Ct===null?(it=Ct=Yr,Fe=Zt):Ct=Ct.next=Yr,fe|=mt;if(Pe=Pe.next,Pe===null){if(Pe=K.shared.pending,Pe===null)break;mt=Pe,Pe=mt.next,mt.next=null,K.lastBaseUpdate=mt,K.shared.pending=null}}while(!0);if(Ct===null&&(Fe=Zt),K.baseState=Fe,K.firstBaseUpdate=it,K.lastBaseUpdate=Ct,w=K.shared.interleaved,w!==null){K=w;do fe|=K.lane,K=K.next;while(K!==w)}else te===null&&(K.shared.lanes=0);tl|=fe,x.lanes=fe,x.memoizedState=Zt}}function sf(x,w,A){if(x=w.effects,w.effects=null,x!==null)for(w=0;w<x.length;w++){var F=x[w],K=F.callback;if(K!==null){if(F.callback=null,F=A,typeof K!="function")throw Error(o(191,K));K.call(F)}}}var da={},Da=mn(da),Di=mn(da),Ja=mn(da);function ha(x){if(x===da)throw Error(o(174));return x}function El(x,w){lt(Ja,w),lt(Di,x),lt(Da,da),x=Q(w),yr(Da),lt(Da,x)}function xs(){yr(Da),yr(Di),yr(Ja)}function vu(x){var w=ha(Ja.current),A=ha(Da.current);w=J(A,x.type,w),A!==w&&(lt(Di,x),lt(Da,w))}function Nl(x){Di.current===x&&(yr(Da),yr(Di))}var Cr=mn(0);function Go(x){for(var w=x;w!==null;){if(w.tag===13){var A=w.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||an(A)||cr(A)))return w}else if(w.tag===19&&w.memoizedProps.revealOrder!==void 0){if((w.flags&128)!==0)return w}else if(w.child!==null){w.child.return=w,w=w.child;continue}if(w===x)break;for(;w.sibling===null;){if(w.return===null||w.return===x)return null;w=w.return}w.sibling.return=w.return,w=w.sibling}return null}var yu=[];function dc(){for(var x=0;x<yu.length;x++){var w=yu[x];pe?w._workInProgressVersionPrimary=null:w._workInProgressVersionSecondary=null}yu.length=0}var Ii=l.ReactCurrentDispatcher,bs=l.ReactCurrentBatchConfig,so=0,Vr=null,Cn=null,En=null,Tl=!1,Bi=!1,oo=0,Pl=0;function gn(){throw Error(o(321))}function qo(x,w){if(w===null)return!1;for(var A=0;A<w.length&&A<x.length;A++)if(!Ya(x[A],w[A]))return!1;return!0}function Ml(x,w,A,F,K,te){if(so=te,Vr=w,w.memoizedState=null,w.updateQueue=null,w.lanes=0,Ii.current=x===null||x.memoizedState===null?pt:It,x=A(F,K),Bi){te=0;do{if(Bi=!1,oo=0,25<=te)throw Error(o(301));te+=1,En=Cn=null,w.updateQueue=null,Ii.current=Jt,x=A(F,K)}while(Bi)}if(Ii.current=$e,w=Cn!==null&&Cn.next!==null,so=0,En=Cn=Vr=null,Tl=!1,w)throw Error(o(300));return x}function hc(){var x=oo!==0;return oo=0,x}function ti(){var x={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?Vr.memoizedState=En=x:En=En.next=x,En}function ri(){if(Cn===null){var x=Vr.alternate;x=x!==null?x.memoizedState:null}else x=Cn.next;var w=En===null?Vr.memoizedState:En.next;if(w!==null)En=w,Cn=x;else{if(x===null)throw Error(o(310));Cn=x,x={memoizedState:Cn.memoizedState,baseState:Cn.baseState,baseQueue:Cn.baseQueue,queue:Cn.queue,next:null},En===null?Vr.memoizedState=En=x:En=En.next=x}return En}function Ia(x,w){return typeof w=="function"?w(x):w}function xu(x){var w=ri(),A=w.queue;if(A===null)throw Error(o(311));A.lastRenderedReducer=x;var F=Cn,K=F.baseQueue,te=A.pending;if(te!==null){if(K!==null){var fe=K.next;K.next=te.next,te.next=fe}F.baseQueue=K=te,A.pending=null}if(K!==null){te=K.next,F=F.baseState;var Pe=fe=null,Fe=null,it=te;do{var Ct=it.lane;if((so&Ct)===Ct)Fe!==null&&(Fe=Fe.next={lane:0,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),F=it.hasEagerState?it.eagerState:x(F,it.action);else{var Zt={lane:Ct,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null};Fe===null?(Pe=Fe=Zt,fe=F):Fe=Fe.next=Zt,Vr.lanes|=Ct,tl|=Ct}it=it.next}while(it!==null&&it!==te);Fe===null?fe=F:Fe.next=Pe,Ya(F,w.memoizedState)||(Tn=!0),w.memoizedState=F,w.baseState=fe,w.baseQueue=Fe,A.lastRenderedState=F}if(x=A.interleaved,x!==null){K=x;do te=K.lane,Vr.lanes|=te,tl|=te,K=K.next;while(K!==x)}else K===null&&(A.lanes=0);return[w.memoizedState,A.dispatch]}function Wo(x){var w=ri(),A=w.queue;if(A===null)throw Error(o(311));A.lastRenderedReducer=x;var F=A.dispatch,K=A.pending,te=w.memoizedState;if(K!==null){A.pending=null;var fe=K=K.next;do te=x(te,fe.action),fe=fe.next;while(fe!==K);Ya(te,w.memoizedState)||(Tn=!0),w.memoizedState=te,w.baseQueue===null&&(w.baseState=te),A.lastRenderedState=te}return[te,F]}function $d(){}function es(x,w){var A=Vr,F=ri(),K=w(),te=!Ya(F.memoizedState,K);if(te&&(F.memoizedState=K,Tn=!0),F=F.queue,bu($o.bind(null,A,F,x),[x]),F.getSnapshot!==w||te||En!==null&&En.memoizedState.tag&1){if(A.flags|=2048,uo(9,pc.bind(null,A,F,K,w),void 0,null),Hr===null)throw Error(o(349));(so&30)!==0||fc(A,w,K)}return K}function fc(x,w,A){x.flags|=16384,x={getSnapshot:w,value:A},w=Vr.updateQueue,w===null?(w={lastEffect:null,stores:null},Vr.updateQueue=w,w.stores=[x]):(A=w.stores,A===null?w.stores=[x]:A.push(x))}function pc(x,w,A,F){w.value=A,w.getSnapshot=F,Kd(w)&&Ba(x)}function $o(x,w,A){return A(function(){Kd(w)&&Ba(x)})}function Kd(x){var w=x.getSnapshot;x=x.value;try{var A=w();return!Ya(x,A)}catch{return!0}}function Ba(x){var w=La(x,1);w!==null&&Ui(w,x,1,-1)}function lo(x){var w=ti();return typeof x=="function"&&(x=x()),w.memoizedState=w.baseState=x,x={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:x},w.queue=x,x=x.dispatch=ue.bind(null,Vr,x),[w.memoizedState,x]}function uo(x,w,A,F){return x={tag:x,create:w,destroy:A,deps:F,next:null},w=Vr.updateQueue,w===null?(w={lastEffect:null,stores:null},Vr.updateQueue=w,w.lastEffect=x.next=x):(A=w.lastEffect,A===null?w.lastEffect=x.next=x:(F=A.next,A.next=x,x.next=F,w.lastEffect=x)),x}function Zd(){return ri().memoizedState}function mc(x,w,A,F){var K=ti();Vr.flags|=x,K.memoizedState=uo(1|w,A,void 0,F===void 0?null:F)}function Gs(x,w,A,F){var K=ri();F=F===void 0?null:F;var te=void 0;if(Cn!==null){var fe=Cn.memoizedState;if(te=fe.destroy,F!==null&&qo(F,fe.deps)){K.memoizedState=uo(w,A,te,F);return}}Vr.flags|=x,K.memoizedState=uo(1|w,A,te,F)}function Yd(x,w){return mc(8390656,8,x,w)}function bu(x,w){return Gs(2048,8,x,w)}function gc(x,w){return Gs(4,2,x,w)}function Mr(x,w){return Gs(4,4,x,w)}function vc(x,w){if(typeof w=="function")return x=x(),w(x),function(){w(null)};if(w!=null)return x=x(),w.current=x,function(){w.current=null}}function Al(x,w,A){return A=A!=null?A.concat([x]):null,Gs(4,4,vc.bind(null,w,x),A)}function co(){}function Xd(x,w){var A=ri();w=w===void 0?null:w;var F=A.memoizedState;return F!==null&&w!==null&&qo(w,F[1])?F[0]:(A.memoizedState=[x,w],x)}function f(x,w){var A=ri();w=w===void 0?null:w;var F=A.memoizedState;return F!==null&&w!==null&&qo(w,F[1])?F[0]:(x=x(),A.memoizedState=[x,w],x)}function _(x,w,A){return(so&21)===0?(x.baseState&&(x.baseState=!1,Tn=!0),x.memoizedState=A):(Ya(A,w)||(A=gl(),Vr.lanes|=A,tl|=A,x.baseState=!0),w)}function M(x,w){var A=ir;ir=A!==0&&4>A?A:4,x(!0);var F=bs.transition;bs.transition={};try{x(!1),w()}finally{ir=A,bs.transition=F}}function U(){return ri().memoizedState}function ee(x,w,A){var F=ii(x);if(A={lane:F,action:A,hasEagerState:!1,eagerState:null,next:null},_e(x))Ae(w,A);else if(A=Uo(x,w,A,F),A!==null){var K=Jr();Ui(A,x,F,K),De(A,w,F)}}function ue(x,w,A){var F=ii(x),K={lane:F,action:A,hasEagerState:!1,eagerState:null,next:null};if(_e(x))Ae(w,K);else{var te=x.alternate;if(x.lanes===0&&(te===null||te.lanes===0)&&(te=w.lastRenderedReducer,te!==null))try{var fe=w.lastRenderedState,Pe=te(fe,A);if(K.hasEagerState=!0,K.eagerState=Pe,Ya(Pe,fe)){var Fe=w.interleaved;Fe===null?(K.next=K,cc(w)):(K.next=Fe.next,Fe.next=K),w.interleaved=K;return}}catch{}A=Uo(x,w,K,F),A!==null&&(K=Jr(),Ui(A,x,F,K),De(A,w,F))}}function _e(x){var w=x.alternate;return x===Vr||w!==null&&w===Vr}function Ae(x,w){Bi=Tl=!0;var A=x.pending;A===null?w.next=w:(w.next=A.next,A.next=w),x.pending=w}function De(x,w,A){if((A&4194240)!==0){var F=w.lanes;F&=x.pendingLanes,A|=F,w.lanes=A,ja(x,A)}}var $e={readContext:ua,useCallback:gn,useContext:gn,useEffect:gn,useImperativeHandle:gn,useInsertionEffect:gn,useLayoutEffect:gn,useMemo:gn,useReducer:gn,useRef:gn,useState:gn,useDebugValue:gn,useDeferredValue:gn,useTransition:gn,useMutableSource:gn,useSyncExternalStore:gn,useId:gn,unstable_isNewReconciler:!1},pt={readContext:ua,useCallback:function(x,w){return ti().memoizedState=[x,w===void 0?null:w],x},useContext:ua,useEffect:Yd,useImperativeHandle:function(x,w,A){return A=A!=null?A.concat([x]):null,mc(4194308,4,vc.bind(null,w,x),A)},useLayoutEffect:function(x,w){return mc(4194308,4,x,w)},useInsertionEffect:function(x,w){return mc(4,2,x,w)},useMemo:function(x,w){var A=ti();return w=w===void 0?null:w,x=x(),A.memoizedState=[x,w],x},useReducer:function(x,w,A){var F=ti();return w=A!==void 0?A(w):w,F.memoizedState=F.baseState=w,x={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:w},F.queue=x,x=x.dispatch=ee.bind(null,Vr,x),[F.memoizedState,x]},useRef:function(x){var w=ti();return x={current:x},w.memoizedState=x},useState:lo,useDebugValue:co,useDeferredValue:function(x){return ti().memoizedState=x},useTransition:function(){var x=lo(!1),w=x[0];return x=M.bind(null,x[1]),ti().memoizedState=x,[w,x]},useMutableSource:function(){},useSyncExternalStore:function(x,w,A){var F=Vr,K=ti();if(Dr){if(A===void 0)throw Error(o(407));A=A()}else{if(A=w(),Hr===null)throw Error(o(349));(so&30)!==0||fc(F,w,A)}K.memoizedState=A;var te={value:A,getSnapshot:w};return K.queue=te,Yd($o.bind(null,F,te,x),[x]),F.flags|=2048,uo(9,pc.bind(null,F,te,A,w),void 0,null),A},useId:function(){var x=ti(),w=Hr.identifierPrefix;if(Dr){var A=Xa,F=Ri;A=(F&~(1<<32-hi(F)-1)).toString(32)+A,w=":"+w+"R"+A,A=oo++,0<A&&(w+="H"+A.toString(32)),w+=":"}else A=Pl++,w=":"+w+"r"+A.toString(32)+":";return x.memoizedState=w},unstable_isNewReconciler:!1},It={readContext:ua,useCallback:Xd,useContext:ua,useEffect:bu,useImperativeHandle:Al,useInsertionEffect:gc,useLayoutEffect:Mr,useMemo:f,useReducer:xu,useRef:Zd,useState:function(){return xu(Ia)},useDebugValue:co,useDeferredValue:function(x){var w=ri();return _(w,Cn.memoizedState,x)},useTransition:function(){var x=xu(Ia)[0],w=ri().memoizedState;return[x,w]},useMutableSource:$d,useSyncExternalStore:es,useId:U,unstable_isNewReconciler:!1},Jt={readContext:ua,useCallback:Xd,useContext:ua,useEffect:bu,useImperativeHandle:Al,useInsertionEffect:gc,useLayoutEffect:Mr,useMemo:f,useReducer:Wo,useRef:Zd,useState:function(){return Wo(Ia)},useDebugValue:co,useDeferredValue:function(x){var w=ri();return Cn===null?w.memoizedState=x:_(w,Cn.memoizedState,x)},useTransition:function(){var x=Wo(Ia)[0],w=ri().memoizedState;return[x,w]},useMutableSource:$d,useSyncExternalStore:es,useId:U,unstable_isNewReconciler:!1};function Ar(x,w){if(x&&x.defaultProps){w=s({},w),x=x.defaultProps;for(var A in x)w[A]===void 0&&(w[A]=x[A]);return w}return w}function Nn(x,w,A,F){w=x.memoizedState,A=A(F,w),A=A==null?w:s({},w,A),x.memoizedState=A,x.lanes===0&&(x.updateQueue.baseState=A)}var mi={isMounted:function(x){return(x=x._reactInternals)?z(x)===x:!1},enqueueSetState:function(x,w,A){x=x._reactInternals;var F=Jr(),K=ii(x),te=Oa(F,K);te.payload=w,A!=null&&(te.callback=A),w=Hs(x,te,K),w!==null&&(Ui(w,x,K,F),Ho(w,x,K))},enqueueReplaceState:function(x,w,A){x=x._reactInternals;var F=Jr(),K=ii(x),te=Oa(F,K);te.tag=1,te.payload=w,A!=null&&(te.callback=A),w=Hs(x,te,K),w!==null&&(Ui(w,x,K,F),Ho(w,x,K))},enqueueForceUpdate:function(x,w){x=x._reactInternals;var A=Jr(),F=ii(x),K=Oa(A,F);K.tag=2,w!=null&&(K.callback=w),w=Hs(x,K,F),w!==null&&(Ui(w,x,F,A),Ho(w,x,F))}};function Ci(x,w,A,F,K,te,fe){return x=x.stateNode,typeof x.shouldComponentUpdate=="function"?x.shouldComponentUpdate(F,te,fe):w.prototype&&w.prototype.isPureReactComponent?!vs(A,F)||!vs(K,te):!0}function Ko(x,w,A){var F=!1,K=dr,te=w.contextType;return typeof te=="object"&&te!==null?te=ua(te):(K=Mt(w)?Tr:on.current,F=w.contextTypes,te=(F=F!=null)?ia(x,K):dr),w=new w(A,te),x.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=mi,x.stateNode=w,w._reactInternals=x,F&&(x=x.stateNode,x.__reactInternalMemoizedUnmaskedChildContext=K,x.__reactInternalMemoizedMaskedChildContext=te),w}function yc(x,w,A,F){x=w.state,typeof w.componentWillReceiveProps=="function"&&w.componentWillReceiveProps(A,F),typeof w.UNSAFE_componentWillReceiveProps=="function"&&w.UNSAFE_componentWillReceiveProps(A,F),w.state!==x&&mi.enqueueReplaceState(w,w.state,null)}function ws(x,w,A,F){var K=x.stateNode;K.props=A,K.state=x.memoizedState,K.refs={},Wd(x);var te=w.contextType;typeof te=="object"&&te!==null?K.context=ua(te):(te=Mt(w)?Tr:on.current,K.context=ia(x,te)),K.state=x.memoizedState,te=w.getDerivedStateFromProps,typeof te=="function"&&(Nn(x,w,te,A),K.state=x.memoizedState),typeof w.getDerivedStateFromProps=="function"||typeof K.getSnapshotBeforeUpdate=="function"||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(w=K.state,typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount(),w!==K.state&&mi.enqueueReplaceState(K,K.state,null),pi(x,A,K,F),K.state=x.memoizedState),typeof K.componentDidMount=="function"&&(x.flags|=4194308)}function Zo(x,w){try{var A="",F=w;do A+=Op(F),F=F.return;while(F);var K=A}catch(te){K=`
Error generating stack: `+te.message+`
`+te.stack}return{value:x,source:w,stack:K,digest:null}}function qs(x,w,A){return{value:x,source:null,stack:A??null,digest:w??null}}function za(x,w){try{console.error(w.value)}catch(A){setTimeout(function(){throw A})}}var jl=typeof WeakMap=="function"?WeakMap:Map;function br(x,w,A){A=Oa(-1,A),A.tag=3,A.payload={element:null};var F=w.value;return A.callback=function(){Mn||(Mn=!0,Hn=F),za(x,w)},A}function Yo(x,w,A){A=Oa(-1,A),A.tag=3;var F=x.type.getDerivedStateFromError;if(typeof F=="function"){var K=w.value;A.payload=function(){return F(K)},A.callback=function(){za(x,w)}}var te=x.stateNode;return te!==null&&typeof te.componentDidCatch=="function"&&(A.callback=function(){za(x,w),typeof F!="function"&&($s===null?$s=new Set([this]):$s.add(this));var fe=w.stack;this.componentDidCatch(w.value,{componentStack:fe!==null?fe:""})}),A}function of(x,w,A){var F=x.pingCache;if(F===null){F=x.pingCache=new jl;var K=new Set;F.set(w,K)}else K=F.get(w),K===void 0&&(K=new Set,F.set(w,K));K.has(A)||(K.add(A),x=Av.bind(null,x,w,A),w.then(x,x))}function lf(x){do{var w;if((w=x.tag===13)&&(w=x.memoizedState,w=w!==null?w.dehydrated!==null:!0),w)return x;x=x.return}while(x!==null);return null}function ho(x,w,A,F,K){return(x.mode&1)===0?(x===w?x.flags|=65536:(x.flags|=128,A.flags|=131072,A.flags&=-52805,A.tag===1&&(A.alternate===null?A.tag=17:(w=Oa(-1,1),w.tag=2,Hs(A,w,1))),A.lanes|=1),x):(x.flags|=65536,x.lanes=K,x)}var Xo=l.ReactCurrentOwner,Tn=!1;function Un(x,w,A,F){w.child=x===null?oc(w,null,A,F):Fo(w,x.child,A,F)}function uf(x,w,A,F,K){A=A.render;var te=w.ref;return Oi(w,K),F=Ml(x,w,A,F,te,K),A=hc(),x!==null&&!Tn?(w.updateQueue=x.updateQueue,w.flags&=-2053,x.lanes&=~K,Jo(x,w,K)):(Dr&&A&&Li(w),w.flags|=1,Un(x,w,F,K),w.child)}function wu(x,w,A,F,K){if(x===null){var te=A.type;return typeof te=="function"&&!Rc(te)&&te.defaultProps===void 0&&A.compare===null&&A.defaultProps===void 0?(w.tag=15,w.type=te,Qo(x,w,te,F,K)):(x=Cf(A.type,null,F,w,w.mode,K),x.ref=w.ref,x.return=w,w.child=x)}if(te=x.child,(x.lanes&K)===0){var fe=te.memoizedProps;if(A=A.compare,A=A!==null?A:vs,A(fe,F)&&x.ref===w.ref)return Jo(x,w,K)}return w.flags|=1,x=Ul(te,F),x.ref=w.ref,x.return=w,w.child=x}function Qo(x,w,A,F,K){if(x!==null){var te=x.memoizedProps;if(vs(te,F)&&x.ref===w.ref)if(Tn=!1,w.pendingProps=F=te,(x.lanes&K)!==0)(x.flags&131072)!==0&&(Tn=!0);else return w.lanes=x.lanes,Jo(x,w,K)}return fo(x,w,A,F,K)}function Kr(x,w,A){var F=w.pendingProps,K=F.children,te=x!==null?x.memoizedState:null;if(F.mode==="hidden")if((w.mode&1)===0)w.memoizedState={baseLanes:0,cachePool:null,transitions:null},lt(Bl,ni),ni|=A;else{if((A&1073741824)===0)return x=te!==null?te.baseLanes|A:A,w.lanes=w.childLanes=1073741824,w.memoizedState={baseLanes:x,cachePool:null,transitions:null},w.updateQueue=null,lt(Bl,ni),ni|=x,null;w.memoizedState={baseLanes:0,cachePool:null,transitions:null},F=te!==null?te.baseLanes:A,lt(Bl,ni),ni|=F}else te!==null?(F=te.baseLanes|A,w.memoizedState=null):F=A,lt(Bl,ni),ni|=F;return Un(x,w,K,A),w.child}function Ur(x,w){var A=w.ref;(x===null&&A!==null||x!==null&&x.ref!==A)&&(w.flags|=512,w.flags|=2097152)}function fo(x,w,A,F,K){var te=Mt(A)?Tr:on.current;return te=ia(w,te),Oi(w,K),A=Ml(x,w,A,F,te,K),F=hc(),x!==null&&!Tn?(w.updateQueue=x.updateQueue,w.flags&=-2053,x.lanes&=~K,Jo(x,w,K)):(Dr&&F&&Li(w),w.flags|=1,Un(x,w,A,K),w.child)}function Ei(x,w,A,F,K){if(Mt(A)){var te=!0;Qn(w)}else te=!1;if(Oi(w,K),w.stateNode===null)Qd(x,w),Ko(w,A,F),ws(w,A,F,K),F=!0;else if(x===null){var fe=w.stateNode,Pe=w.memoizedProps;fe.props=Pe;var Fe=fe.context,it=A.contextType;typeof it=="object"&&it!==null?it=ua(it):(it=Mt(A)?Tr:on.current,it=ia(w,it));var Ct=A.getDerivedStateFromProps,Zt=typeof Ct=="function"||typeof fe.getSnapshotBeforeUpdate=="function";Zt||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(Pe!==F||Fe!==it)&&yc(w,fe,F,it),fi=!1;var mt=w.memoizedState;fe.state=mt,pi(w,F,fe,K),Fe=w.memoizedState,Pe!==F||mt!==Fe||Fr.current||fi?(typeof Ct=="function"&&(Nn(w,A,Ct,F),Fe=w.memoizedState),(Pe=fi||Ci(w,A,Pe,F,mt,Fe,it))?(Zt||typeof fe.UNSAFE_componentWillMount!="function"&&typeof fe.componentWillMount!="function"||(typeof fe.componentWillMount=="function"&&fe.componentWillMount(),typeof fe.UNSAFE_componentWillMount=="function"&&fe.UNSAFE_componentWillMount()),typeof fe.componentDidMount=="function"&&(w.flags|=4194308)):(typeof fe.componentDidMount=="function"&&(w.flags|=4194308),w.memoizedProps=F,w.memoizedState=Fe),fe.props=F,fe.state=Fe,fe.context=it,F=Pe):(typeof fe.componentDidMount=="function"&&(w.flags|=4194308),F=!1)}else{fe=w.stateNode,Us(x,w),Pe=w.memoizedProps,it=w.type===w.elementType?Pe:Ar(w.type,Pe),fe.props=it,Zt=w.pendingProps,mt=fe.context,Fe=A.contextType,typeof Fe=="object"&&Fe!==null?Fe=ua(Fe):(Fe=Mt(A)?Tr:on.current,Fe=ia(w,Fe));var Yr=A.getDerivedStateFromProps;(Ct=typeof Yr=="function"||typeof fe.getSnapshotBeforeUpdate=="function")||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(Pe!==Zt||mt!==Fe)&&yc(w,fe,F,Fe),fi=!1,mt=w.memoizedState,fe.state=mt,pi(w,F,fe,K);var Rr=w.memoizedState;Pe!==Zt||mt!==Rr||Fr.current||fi?(typeof Yr=="function"&&(Nn(w,A,Yr,F),Rr=w.memoizedState),(it=fi||Ci(w,A,it,F,mt,Rr,Fe)||!1)?(Ct||typeof fe.UNSAFE_componentWillUpdate!="function"&&typeof fe.componentWillUpdate!="function"||(typeof fe.componentWillUpdate=="function"&&fe.componentWillUpdate(F,Rr,Fe),typeof fe.UNSAFE_componentWillUpdate=="function"&&fe.UNSAFE_componentWillUpdate(F,Rr,Fe)),typeof fe.componentDidUpdate=="function"&&(w.flags|=4),typeof fe.getSnapshotBeforeUpdate=="function"&&(w.flags|=1024)):(typeof fe.componentDidUpdate!="function"||Pe===x.memoizedProps&&mt===x.memoizedState||(w.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||Pe===x.memoizedProps&&mt===x.memoizedState||(w.flags|=1024),w.memoizedProps=F,w.memoizedState=Rr),fe.props=F,fe.state=Rr,fe.context=Fe,F=it):(typeof fe.componentDidUpdate!="function"||Pe===x.memoizedProps&&mt===x.memoizedState||(w.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||Pe===x.memoizedProps&&mt===x.memoizedState||(w.flags|=1024),F=!1)}return zi(x,w,A,F,te,K)}function zi(x,w,A,F,K,te){Ur(x,w);var fe=(w.flags&128)!==0;if(!F&&!fe)return K&&Fd(w,A,!1),Jo(x,w,te);F=w.stateNode,Xo.current=w;var Pe=fe&&typeof A.getDerivedStateFromError!="function"?null:F.render();return w.flags|=1,x!==null&&fe?(w.child=Fo(w,x.child,null,te),w.child=Fo(w,null,Pe,te)):Un(x,w,Pe,te),w.memoizedState=F.state,K&&Fd(w,A,!0),w.child}function Rl(x){var w=x.stateNode;w.pendingContext?tc(x,w.pendingContext,w.pendingContext!==w.context):w.context&&tc(x,w.context,!1),El(x,w.containerInfo)}function _u(x,w,A,F,K){return ao(),ac(K),w.flags|=256,Un(x,w,A,F),w.child}var Fi={dehydrated:null,treeContext:null,retryLane:0};function xc(x){return{baseLanes:x,cachePool:null,transitions:null}}function Dp(x,w,A){var F=w.pendingProps,K=Cr.current,te=!1,fe=(w.flags&128)!==0,Pe;if((Pe=fe)||(Pe=x!==null&&x.memoizedState===null?!1:(K&2)!==0),Pe?(te=!0,w.flags&=-129):(x===null||x.memoizedState!==null)&&(K|=1),lt(Cr,K&1),x===null)return Ud(w),x=w.memoizedState,x!==null&&(x=x.dehydrated,x!==null)?((w.mode&1)===0?w.lanes=1:cr(x)?w.lanes=8:w.lanes=1073741824,null):(fe=F.children,x=F.fallback,te?(F=w.mode,te=w.child,fe={mode:"hidden",children:fe},(F&1)===0&&te!==null?(te.childLanes=0,te.pendingProps=fe):te=Lc(fe,F,0,null),x=Ni(x,F,A,null),te.return=w,x.return=w,te.sibling=x,w.child=te,w.child.memoizedState=xc(A),w.memoizedState=Fi,x):cf(w,fe));if(K=x.memoizedState,K!==null&&(Pe=K.dehydrated,Pe!==null))return Cv(x,w,fe,F,Pe,K,A);if(te){te=F.fallback,fe=w.mode,K=x.child,Pe=K.sibling;var Fe={mode:"hidden",children:F.children};return(fe&1)===0&&w.child!==K?(F=w.child,F.childLanes=0,F.pendingProps=Fe,w.deletions=null):(F=Ul(K,Fe),F.subtreeFlags=K.subtreeFlags&14680064),Pe!==null?te=Ul(Pe,te):(te=Ni(te,fe,A,null),te.flags|=2),te.return=w,F.return=w,F.sibling=te,w.child=F,F=te,te=w.child,fe=x.child.memoizedState,fe=fe===null?xc(A):{baseLanes:fe.baseLanes|A,cachePool:null,transitions:fe.transitions},te.memoizedState=fe,te.childLanes=x.childLanes&~A,w.memoizedState=Fi,F}return te=x.child,x=te.sibling,F=Ul(te,{mode:"visible",children:F.children}),(w.mode&1)===0&&(F.lanes=A),F.return=w,F.sibling=null,x!==null&&(A=w.deletions,A===null?(w.deletions=[x],w.flags|=16):A.push(x)),w.child=F,w.memoizedState=null,F}function cf(x,w){return w=Lc({mode:"visible",children:w},x.mode,0,null),w.return=x,x.child=w}function Su(x,w,A,F){return F!==null&&ac(F),Fo(w,x.child,null,A),x=cf(w,w.pendingProps.children),x.flags|=2,w.memoizedState=null,x}function Cv(x,w,A,F,K,te,fe){if(A)return w.flags&256?(w.flags&=-257,F=qs(Error(o(422))),Su(x,w,fe,F)):w.memoizedState!==null?(w.child=x.child,w.flags|=128,null):(te=F.fallback,K=w.mode,F=Lc({mode:"visible",children:F.children},K,0,null),te=Ni(te,K,fe,null),te.flags|=2,F.return=w,te.return=w,F.sibling=te,w.child=F,(w.mode&1)!==0&&Fo(w,x.child,null,fe),w.child.memoizedState=xc(fe),w.memoizedState=Fi,te);if((w.mode&1)===0)return Su(x,w,fe,null);if(cr(K))return F=bt(K).digest,te=Error(o(419)),F=qs(te,F,void 0),Su(x,w,fe,F);if(A=(fe&x.childLanes)!==0,Tn||A){if(F=Hr,F!==null){switch(fe&-fe){case 4:K=2;break;case 16:K=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:K=32;break;case 536870912:K=268435456;break;default:K=0}K=(K&(F.suspendedLanes|fe))!==0?0:K,K!==0&&K!==te.retryLane&&(te.retryLane=K,La(x,K),Ui(F,x,K,-1))}return jc(),F=qs(Error(o(421))),Su(x,w,fe,F)}return an(K)?(w.flags|=128,w.child=x.child,w=Rv.bind(null,x),Or(K,w),null):(x=te.treeContext,Se&&(ln=eo(K),Vn=w,Dr=!0,la=null,wl=!1,x!==null&&(ei[sa++]=Ri,ei[sa++]=Xa,ei[sa++]=kn,Ri=x.id,Xa=x.overflow,kn=w)),w=cf(w,F.children),w.flags|=4096,w)}function po(x,w,A){x.lanes|=w;var F=x.alternate;F!==null&&(F.lanes|=w),Vo(x.return,w,A)}function bc(x,w,A,F,K){var te=x.memoizedState;te===null?x.memoizedState={isBackwards:w,rendering:null,renderingStartTime:0,last:F,tail:A,tailMode:K}:(te.isBackwards=w,te.rendering=null,te.renderingStartTime=0,te.last=F,te.tail=A,te.tailMode=K)}function df(x,w,A){var F=w.pendingProps,K=F.revealOrder,te=F.tail;if(Un(x,w,F.children,A),F=Cr.current,(F&2)!==0)F=F&1|2,w.flags|=128;else{if(x!==null&&(x.flags&128)!==0)e:for(x=w.child;x!==null;){if(x.tag===13)x.memoizedState!==null&&po(x,A,w);else if(x.tag===19)po(x,A,w);else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===w)break e;for(;x.sibling===null;){if(x.return===null||x.return===w)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}F&=1}if(lt(Cr,F),(w.mode&1)===0)w.memoizedState=null;else switch(K){case"forwards":for(A=w.child,K=null;A!==null;)x=A.alternate,x!==null&&Go(x)===null&&(K=A),A=A.sibling;A=K,A===null?(K=w.child,w.child=null):(K=A.sibling,A.sibling=null),bc(w,!1,K,A,te);break;case"backwards":for(A=null,K=w.child,w.child=null;K!==null;){if(x=K.alternate,x!==null&&Go(x)===null){w.child=K;break}x=K.sibling,K.sibling=A,A=K,K=x}bc(w,!0,A,null,te);break;case"together":bc(w,!1,null,null,void 0);break;default:w.memoizedState=null}return w.child}function Qd(x,w){(w.mode&1)===0&&x!==null&&(x.alternate=null,w.alternate=null,w.flags|=2)}function Jo(x,w,A){if(x!==null&&(w.dependencies=x.dependencies),tl|=w.lanes,(A&w.childLanes)===0)return null;if(x!==null&&w.child!==x.child)throw Error(o(153));if(w.child!==null){for(x=w.child,A=Ul(x,x.pendingProps),w.child=A,A.return=w;x.sibling!==null;)x=x.sibling,A=A.sibling=Ul(x,x.pendingProps),A.return=w;A.sibling=null}return w.child}function Ll(x,w,A){switch(w.tag){case 3:Rl(w),ao();break;case 5:vu(w);break;case 1:Mt(w.type)&&Qn(w);break;case 4:El(w,w.stateNode.containerInfo);break;case 10:Ra(w,w.type._context,w.memoizedProps.value);break;case 13:var F=w.memoizedState;if(F!==null)return F.dehydrated!==null?(lt(Cr,Cr.current&1),w.flags|=128,null):(A&w.child.childLanes)!==0?Dp(x,w,A):(lt(Cr,Cr.current&1),x=Jo(x,w,A),x!==null?x.sibling:null);lt(Cr,Cr.current&1);break;case 19:if(F=(A&w.childLanes)!==0,(x.flags&128)!==0){if(F)return df(x,w,A);w.flags|=128}var K=w.memoizedState;if(K!==null&&(K.rendering=null,K.tail=null,K.lastEffect=null),lt(Cr,Cr.current),F)break;return null;case 22:case 23:return w.lanes=0,Kr(x,w,A)}return Jo(x,w,A)}function fa(x){x.flags|=4}function ku(x,w){if(x!==null&&x.child===w.child)return!0;if((w.flags&16)!==0)return!1;for(x=w.child;x!==null;){if((x.flags&12854)!==0||(x.subtreeFlags&12854)!==0)return!1;x=x.sibling}return!0}var Ol,Dl,pa,ma;if(me)Ol=function(x,w){for(var A=w.child;A!==null;){if(A.tag===5||A.tag===6)re(x,A.stateNode);else if(A.tag!==4&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===w)break;for(;A.sibling===null;){if(A.return===null||A.return===w)return;A=A.return}A.sibling.return=A.return,A=A.sibling}},Dl=function(){},pa=function(x,w,A,F,K){if(x=x.memoizedProps,x!==F){var te=w.stateNode,fe=ha(Da.current);A=he(te,A,x,F,K,fe),(w.updateQueue=A)&&fa(w)}},ma=function(x,w,A,F){A!==F&&fa(w)};else if(be){Ol=function(x,w,A,F){for(var K=w.child;K!==null;){if(K.tag===5){var te=K.stateNode;A&&F&&(te=kr(te,K.type,K.memoizedProps,K)),re(x,te)}else if(K.tag===6)te=K.stateNode,A&&F&&(te=pr(te,K.memoizedProps,K)),re(x,te);else if(K.tag!==4){if(K.tag===22&&K.memoizedState!==null)te=K.child,te!==null&&(te.return=K),Ol(x,K,!0,!0);else if(K.child!==null){K.child.return=K,K=K.child;continue}}if(K===w)break;for(;K.sibling===null;){if(K.return===null||K.return===w)return;K=K.return}K.sibling.return=K.return,K=K.sibling}};var Il=function(x,w,A,F){for(var K=w.child;K!==null;){if(K.tag===5){var te=K.stateNode;A&&F&&(te=kr(te,K.type,K.memoizedProps,K)),xt(x,te)}else if(K.tag===6)te=K.stateNode,A&&F&&(te=pr(te,K.memoizedProps,K)),xt(x,te);else if(K.tag!==4){if(K.tag===22&&K.memoizedState!==null)te=K.child,te!==null&&(te.return=K),Il(x,K,!0,!0);else if(K.child!==null){K.child.return=K,K=K.child;continue}}if(K===w)break;for(;K.sibling===null;){if(K.return===null||K.return===w)return;K=K.return}K.sibling.return=K.return,K=K.sibling}};Dl=function(x,w){var A=w.stateNode;if(!ku(x,w)){x=A.containerInfo;var F=Ft(x);Il(F,w,!1,!1),A.pendingChildren=F,fa(w),Gt(x,F)}},pa=function(x,w,A,F,K){var te=x.stateNode,fe=x.memoizedProps;if((x=ku(x,w))&&fe===F)w.stateNode=te;else{var Pe=w.stateNode,Fe=ha(Da.current),it=null;fe!==F&&(it=he(Pe,A,fe,F,K,Fe)),x&&it===null?w.stateNode=te:(te=zt(te,it,A,fe,F,w,x,Pe),ae(te,A,F,K,Fe)&&fa(w),w.stateNode=te,x?fa(w):Ol(te,w,!1,!1))}},ma=function(x,w,A,F){A!==F?(x=ha(Ja.current),A=ha(Da.current),w.stateNode=xe(F,x,A,w),fa(w)):w.stateNode=x.stateNode}}else Dl=function(){},pa=function(){},ma=function(){};function ts(x,w){if(!Dr)switch(x.tailMode){case"hidden":w=x.tail;for(var A=null;w!==null;)w.alternate!==null&&(A=w),w=w.sibling;A===null?x.tail=null:A.sibling=null;break;case"collapsed":A=x.tail;for(var F=null;A!==null;)A.alternate!==null&&(F=A),A=A.sibling;F===null?w||x.tail===null?x.tail=null:x.tail.sibling=null:F.sibling=null}}function un(x){var w=x.alternate!==null&&x.alternate.child===x.child,A=0,F=0;if(w)for(var K=x.child;K!==null;)A|=K.lanes|K.childLanes,F|=K.subtreeFlags&14680064,F|=K.flags&14680064,K.return=x,K=K.sibling;else for(K=x.child;K!==null;)A|=K.lanes|K.childLanes,F|=K.subtreeFlags,F|=K.flags,K.return=x,K=K.sibling;return x.subtreeFlags|=F,x.childLanes=A,w}function Cu(x,w,A){var F=w.pendingProps;switch(mu(w),w.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return un(w),null;case 1:return Mt(w.type)&&xr(),un(w),null;case 3:return A=w.stateNode,xs(),yr(Fr),yr(on),dc(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(x===null||x.child===null)&&(_l(w)?fa(w):x===null||x.memoizedState.isDehydrated&&(w.flags&256)===0||(w.flags|=1024,la!==null&&(Sf(la),la=null))),Dl(x,w),un(w),null;case 5:Nl(w),A=ha(Ja.current);var K=w.type;if(x!==null&&w.stateNode!=null)pa(x,w,K,F,A),x.ref!==w.ref&&(w.flags|=512,w.flags|=2097152);else{if(!F){if(w.stateNode===null)throw Error(o(166));return un(w),null}if(x=ha(Da.current),_l(w)){if(!Se)throw Error(o(175));x=ci(w.stateNode,w.type,w.memoizedProps,A,x,w,!wl),w.updateQueue=x,x!==null&&fa(w)}else{var te=W(K,F,A,x,w);Ol(te,w,!1,!1),w.stateNode=te,ae(te,K,F,A,x)&&fa(w)}w.ref!==null&&(w.flags|=512,w.flags|=2097152)}return un(w),null;case 6:if(x&&w.stateNode!=null)ma(x,w,x.memoizedProps,F);else{if(typeof F!="string"&&w.stateNode===null)throw Error(o(166));if(x=ha(Ja.current),A=ha(Da.current),_l(w)){if(!Se)throw Error(o(176));if(x=w.stateNode,A=w.memoizedProps,(F=sn(x,A,w,!wl))&&(K=Vn,K!==null))switch(K.tag){case 3:pl(K.stateNode.containerInfo,x,A,(K.mode&1)!==0);break;case 5:Qr(K.type,K.memoizedProps,K.stateNode,x,A,(K.mode&1)!==0)}F&&fa(w)}else w.stateNode=xe(F,x,A,w)}return un(w),null;case 13:if(yr(Cr),F=w.memoizedState,x===null||x.memoizedState!==null&&x.memoizedState.dehydrated!==null){if(Dr&&ln!==null&&(w.mode&1)!==0&&(w.flags&128)===0)af(),ao(),w.flags|=98560,K=!1;else if(K=_l(w),F!==null&&F.dehydrated!==null){if(x===null){if(!K)throw Error(o(318));if(!Se)throw Error(o(344));if(K=w.memoizedState,K=K!==null?K.dehydrated:null,!K)throw Error(o(317));bn(K,w)}else ao(),(w.flags&128)===0&&(w.memoizedState=null),w.flags|=4;un(w),K=!1}else la!==null&&(Sf(la),la=null),K=!0;if(!K)return w.flags&65536?w:null}return(w.flags&128)!==0?(w.lanes=A,w):(A=F!==null,A!==(x!==null&&x.memoizedState!==null)&&A&&(w.child.flags|=8192,(w.mode&1)!==0&&(x===null||(Cr.current&1)!==0?dn===0&&(dn=3):jc())),w.updateQueue!==null&&(w.flags|=4),un(w),null);case 4:return xs(),Dl(x,w),x===null&&We(w.stateNode.containerInfo),un(w),null;case 10:return ys(w.type._context),un(w),null;case 17:return Mt(w.type)&&xr(),un(w),null;case 19:if(yr(Cr),K=w.memoizedState,K===null)return un(w),null;if(F=(w.flags&128)!==0,te=K.rendering,te===null)if(F)ts(K,!1);else{if(dn!==0||x!==null&&(x.flags&128)!==0)for(x=w.child;x!==null;){if(te=Go(x),te!==null){for(w.flags|=128,ts(K,!1),x=te.updateQueue,x!==null&&(w.updateQueue=x,w.flags|=4),w.subtreeFlags=0,x=A,A=w.child;A!==null;)F=A,K=x,F.flags&=14680066,te=F.alternate,te===null?(F.childLanes=0,F.lanes=K,F.child=null,F.subtreeFlags=0,F.memoizedProps=null,F.memoizedState=null,F.updateQueue=null,F.dependencies=null,F.stateNode=null):(F.childLanes=te.childLanes,F.lanes=te.lanes,F.child=te.child,F.subtreeFlags=0,F.deletions=null,F.memoizedProps=te.memoizedProps,F.memoizedState=te.memoizedState,F.updateQueue=te.updateQueue,F.type=te.type,K=te.dependencies,F.dependencies=K===null?null:{lanes:K.lanes,firstContext:K.firstContext}),A=A.sibling;return lt(Cr,Cr.current&1|2),w.child}x=x.sibling}K.tail!==null&&_n()>ah&&(w.flags|=128,F=!0,ts(K,!1),w.lanes=4194304)}else{if(!F)if(x=Go(te),x!==null){if(w.flags|=128,F=!0,x=x.updateQueue,x!==null&&(w.updateQueue=x,w.flags|=4),ts(K,!0),K.tail===null&&K.tailMode==="hidden"&&!te.alternate&&!Dr)return un(w),null}else 2*_n()-K.renderingStartTime>ah&&A!==1073741824&&(w.flags|=128,F=!0,ts(K,!1),w.lanes=4194304);K.isBackwards?(te.sibling=w.child,w.child=te):(x=K.last,x!==null?x.sibling=te:w.child=te,K.last=te)}return K.tail!==null?(w=K.tail,K.rendering=w,K.tail=w.sibling,K.renderingStartTime=_n(),w.sibling=null,x=Cr.current,lt(Cr,F?x&1|2:x&1),w):(un(w),null);case 22:case 23:return kf(),A=w.memoizedState!==null,x!==null&&x.memoizedState!==null!==A&&(w.flags|=8192),A&&(w.mode&1)!==0?(ni&1073741824)!==0&&(un(w),me&&w.subtreeFlags&6&&(w.flags|=8192)):un(w),null;case 24:return null;case 25:return null}throw Error(o(156,w.tag))}function Ev(x,w){switch(mu(w),w.tag){case 1:return Mt(w.type)&&xr(),x=w.flags,x&65536?(w.flags=x&-65537|128,w):null;case 3:return xs(),yr(Fr),yr(on),dc(),x=w.flags,(x&65536)!==0&&(x&128)===0?(w.flags=x&-65537|128,w):null;case 5:return Nl(w),null;case 13:if(yr(Cr),x=w.memoizedState,x!==null&&x.dehydrated!==null){if(w.alternate===null)throw Error(o(340));ao()}return x=w.flags,x&65536?(w.flags=x&-65537|128,w):null;case 19:return yr(Cr),null;case 4:return xs(),null;case 10:return ys(w.type._context),null;case 22:case 23:return kf(),null;case 24:return null;default:return null}}var wc=!1,gi=!1,rs=typeof WeakSet=="function"?WeakSet:Set,dt=null;function jr(x,w){var A=x.ref;if(A!==null)if(typeof A=="function")try{A(null)}catch(F){en(x,w,F)}else A.current=null}function ns(x,w,A){try{A()}catch(F){en(x,w,F)}}var Ip=!1;function Nv(x,w){for(ie(x.containerInfo),dt=w;dt!==null;)if(x=dt,w=x.child,(x.subtreeFlags&1028)!==0&&w!==null)w.return=x,dt=w;else for(;dt!==null;){x=dt;try{var A=x.alternate;if((x.flags&1024)!==0)switch(x.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var F=A.memoizedProps,K=A.memoizedState,te=x.stateNode,fe=te.getSnapshotBeforeUpdate(x.elementType===x.type?F:Ar(x.type,F),K);te.__reactInternalSnapshotBeforeUpdate=fe}break;case 3:me&&kt(x.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Pe){en(x,x.return,Pe)}if(w=x.sibling,w!==null){w.return=x.return,dt=w;break}dt=x.return}return A=Ip,Ip=!1,A}function Eu(x,w,A){var F=w.updateQueue;if(F=F!==null?F.lastEffect:null,F!==null){var K=F=F.next;do{if((K.tag&x)===x){var te=K.destroy;K.destroy=void 0,te!==void 0&&ns(w,A,te)}K=K.next}while(K!==F)}}function _c(x,w){if(w=w.updateQueue,w=w!==null?w.lastEffect:null,w!==null){var A=w=w.next;do{if((A.tag&x)===x){var F=A.create;A.destroy=F()}A=A.next}while(A!==w)}}function hf(x){var w=x.ref;if(w!==null){var A=x.stateNode;x.tag===5?x=Z(A):x=A,typeof w=="function"?w(x):w.current=x}}function Jd(x){var w=x.alternate;w!==null&&(x.alternate=null,Jd(w)),x.child=null,x.deletions=null,x.sibling=null,x.tag===5&&(w=x.stateNode,w!==null&&Je(w)),x.stateNode=null,x.return=null,x.dependencies=null,x.memoizedProps=null,x.memoizedState=null,x.pendingProps=null,x.stateNode=null,x.updateQueue=null}function Bp(x){return x.tag===5||x.tag===3||x.tag===4}function Nu(x){e:for(;;){for(;x.sibling===null;){if(x.return===null||Bp(x.return))return null;x=x.return}for(x.sibling.return=x.return,x=x.sibling;x.tag!==5&&x.tag!==6&&x.tag!==18;){if(x.flags&2||x.child===null||x.tag===4)continue e;x.child.return=x,x=x.child}if(!(x.flags&2))return x.stateNode}}function eh(x,w,A){var F=x.tag;if(F===5||F===6)x=x.stateNode,w?ye(A,x,w):$t(A,x);else if(F!==4&&(x=x.child,x!==null))for(eh(x,w,A),x=x.sibling;x!==null;)eh(x,w,A),x=x.sibling}function zp(x,w,A){var F=x.tag;if(F===5||F===6)x=x.stateNode,w?de(A,x,w):Rt(A,x);else if(F!==4&&(x=x.child,x!==null))for(zp(x,w,A),x=x.sibling;x!==null;)zp(x,w,A),x=x.sibling}var In=null,Fa=!1;function Ws(x,w,A){for(A=A.child;A!==null;)ff(x,w,A),A=A.sibling}function ff(x,w,A){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount($r,A)}catch{}switch(A.tag){case 5:gi||jr(A,w);case 6:if(me){var F=In,K=Fa;In=null,Ws(x,w,A),In=F,Fa=K,In!==null&&(Fa?Te(In,A.stateNode):Ce(In,A.stateNode))}else Ws(x,w,A);break;case 18:me&&In!==null&&(Fa?uu(In,A.stateNode):lu(In,A.stateNode));break;case 4:me?(F=In,K=Fa,In=A.stateNode.containerInfo,Fa=!0,Ws(x,w,A),In=F,Fa=K):(be&&(F=A.stateNode.containerInfo,K=Ft(F),Wt(F,K)),Ws(x,w,A));break;case 0:case 11:case 14:case 15:if(!gi&&(F=A.updateQueue,F!==null&&(F=F.lastEffect,F!==null))){K=F=F.next;do{var te=K,fe=te.destroy;te=te.tag,fe!==void 0&&((te&2)!==0||(te&4)!==0)&&ns(A,w,fe),K=K.next}while(K!==F)}Ws(x,w,A);break;case 1:if(!gi&&(jr(A,w),F=A.stateNode,typeof F.componentWillUnmount=="function"))try{F.props=A.memoizedProps,F.state=A.memoizedState,F.componentWillUnmount()}catch(Pe){en(A,w,Pe)}Ws(x,w,A);break;case 21:Ws(x,w,A);break;case 22:A.mode&1?(gi=(F=gi)||A.memoizedState!==null,Ws(x,w,A),gi=F):Ws(x,w,A);break;default:Ws(x,w,A)}}function Tu(x){var w=x.updateQueue;if(w!==null){x.updateQueue=null;var A=x.stateNode;A===null&&(A=x.stateNode=new rs),w.forEach(function(F){var K=Qx.bind(null,x,F);A.has(F)||(A.add(F),F.then(K,K))})}}function _s(x,w){var A=w.deletions;if(A!==null)for(var F=0;F<A.length;F++){var K=A[F];try{var te=x,fe=w;if(me){var Pe=fe;e:for(;Pe!==null;){switch(Pe.tag){case 5:In=Pe.stateNode,Fa=!1;break e;case 3:In=Pe.stateNode.containerInfo,Fa=!0;break e;case 4:In=Pe.stateNode.containerInfo,Fa=!0;break e}Pe=Pe.return}if(In===null)throw Error(o(160));ff(te,fe,K),In=null,Fa=!1}else ff(te,fe,K);var Fe=K.alternate;Fe!==null&&(Fe.return=null),K.return=null}catch(it){en(K,w,it)}}if(w.subtreeFlags&12854)for(w=w.child;w!==null;)th(w,x),w=w.sibling}function th(x,w){var A=x.alternate,F=x.flags;switch(x.tag){case 0:case 11:case 14:case 15:if(_s(w,x),is(x),F&4){try{Eu(3,x,x.return),_c(3,x)}catch(mt){en(x,x.return,mt)}try{Eu(5,x,x.return)}catch(mt){en(x,x.return,mt)}}break;case 1:_s(w,x),is(x),F&512&&A!==null&&jr(A,A.return);break;case 5:if(_s(w,x),is(x),F&512&&A!==null&&jr(A,A.return),me){if(x.flags&32){var K=x.stateNode;try{Re(K)}catch(mt){en(x,x.return,mt)}}if(F&4&&(K=x.stateNode,K!=null)){var te=x.memoizedProps;if(A=A!==null?A.memoizedProps:te,F=x.type,w=x.updateQueue,x.updateQueue=null,w!==null)try{qe(K,w,F,A,te,x)}catch(mt){en(x,x.return,mt)}}}break;case 6:if(_s(w,x),is(x),F&4&&me){if(x.stateNode===null)throw Error(o(162));K=x.stateNode,te=x.memoizedProps,A=A!==null?A.memoizedProps:te;try{wt(K,A,te)}catch(mt){en(x,x.return,mt)}}break;case 3:if(_s(w,x),is(x),F&4){if(me&&Se&&A!==null&&A.memoizedState.isDehydrated)try{to(w.containerInfo)}catch(mt){en(x,x.return,mt)}if(be){K=w.containerInfo,te=w.pendingChildren;try{Wt(K,te)}catch(mt){en(x,x.return,mt)}}}break;case 4:if(_s(w,x),is(x),F&4&&be){te=x.stateNode,K=te.containerInfo,te=te.pendingChildren;try{Wt(K,te)}catch(mt){en(x,x.return,mt)}}break;case 13:_s(w,x),is(x),K=x.child,K.flags&8192&&(te=K.memoizedState!==null,K.stateNode.isHidden=te,!te||K.alternate!==null&&K.alternate.memoizedState!==null||(Tc=_n())),F&4&&Tu(x);break;case 22:var fe=A!==null&&A.memoizedState!==null;if(x.mode&1?(gi=(A=gi)||fe,_s(w,x),gi=A):_s(w,x),is(x),F&8192){if(A=x.memoizedState!==null,(x.stateNode.isHidden=A)&&!fe&&(x.mode&1)!==0)for(dt=x,F=x.child;F!==null;){for(w=dt=F;dt!==null;){fe=dt;var Pe=fe.child;switch(fe.tag){case 0:case 11:case 14:case 15:Eu(4,fe,fe.return);break;case 1:jr(fe,fe.return);var Fe=fe.stateNode;if(typeof Fe.componentWillUnmount=="function"){var it=fe,Ct=fe.return;try{var Zt=it;Fe.props=Zt.memoizedProps,Fe.state=Zt.memoizedState,Fe.componentWillUnmount()}catch(mt){en(it,Ct,mt)}}break;case 5:jr(fe,fe.return);break;case 22:if(fe.memoizedState!==null){gf(w);continue}}Pe!==null?(Pe.return=fe,dt=Pe):gf(w)}F=F.sibling}if(me){e:if(F=null,me)for(w=x;;){if(w.tag===5){if(F===null){F=w;try{K=w.stateNode,A?Ze(K):ct(w.stateNode,w.memoizedProps)}catch(mt){en(x,x.return,mt)}}}else if(w.tag===6){if(F===null)try{te=w.stateNode,A?Ge(te):ut(te,w.memoizedProps)}catch(mt){en(x,x.return,mt)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===x)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===x)break e;for(;w.sibling===null;){if(w.return===null||w.return===x)break e;F===w&&(F=null),w=w.return}F===w&&(F=null),w.sibling.return=w.return,w=w.sibling}}}break;case 19:_s(w,x),is(x),F&4&&Tu(x);break;case 21:break;default:_s(w,x),is(x)}}function is(x){var w=x.flags;if(w&2){try{if(me){e:{for(var A=x.return;A!==null;){if(Bp(A)){var F=A;break e}A=A.return}throw Error(o(160))}switch(F.tag){case 5:var K=F.stateNode;F.flags&32&&(Re(K),F.flags&=-33);var te=Nu(x);zp(x,te,K);break;case 3:case 4:var fe=F.stateNode.containerInfo,Pe=Nu(x);eh(x,Pe,fe);break;default:throw Error(o(161))}}}catch(Fe){en(x,x.return,Fe)}x.flags&=-3}w&4096&&(x.flags&=-4097)}function Sc(x,w,A){dt=x,pf(x)}function pf(x,w,A){for(var F=(x.mode&1)!==0;dt!==null;){var K=dt,te=K.child;if(K.tag===22&&F){var fe=K.memoizedState!==null||wc;if(!fe){var Pe=K.alternate,Fe=Pe!==null&&Pe.memoizedState!==null||gi;Pe=wc;var it=gi;if(wc=fe,(gi=Fe)&&!it)for(dt=K;dt!==null;)fe=dt,Fe=fe.child,fe.tag===22&&fe.memoizedState!==null?vf(K):Fe!==null?(Fe.return=fe,dt=Fe):vf(K);for(;te!==null;)dt=te,pf(te),te=te.sibling;dt=K,wc=Pe,gi=it}mf(x)}else(K.subtreeFlags&8772)!==0&&te!==null?(te.return=K,dt=te):mf(x)}}function mf(x){for(;dt!==null;){var w=dt;if((w.flags&8772)!==0){var A=w.alternate;try{if((w.flags&8772)!==0)switch(w.tag){case 0:case 11:case 15:gi||_c(5,w);break;case 1:var F=w.stateNode;if(w.flags&4&&!gi)if(A===null)F.componentDidMount();else{var K=w.elementType===w.type?A.memoizedProps:Ar(w.type,A.memoizedProps);F.componentDidUpdate(K,A.memoizedState,F.__reactInternalSnapshotBeforeUpdate)}var te=w.updateQueue;te!==null&&sf(w,te,F);break;case 3:var fe=w.updateQueue;if(fe!==null){if(A=null,w.child!==null)switch(w.child.tag){case 5:A=Z(w.child.stateNode);break;case 1:A=w.child.stateNode}sf(w,fe,A)}break;case 5:var Pe=w.stateNode;A===null&&w.flags&4&&ot(Pe,w.type,w.memoizedProps,w);break;case 6:break;case 4:break;case 12:break;case 13:if(Se&&w.memoizedState===null){var Fe=w.alternate;if(Fe!==null){var it=Fe.memoizedState;if(it!==null){var Ct=it.dehydrated;Ct!==null&&_i(Ct)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}gi||w.flags&512&&hf(w)}catch(Zt){en(w,w.return,Zt)}}if(w===x){dt=null;break}if(A=w.sibling,A!==null){A.return=w.return,dt=A;break}dt=w.return}}function gf(x){for(;dt!==null;){var w=dt;if(w===x){dt=null;break}var A=w.sibling;if(A!==null){A.return=w.return,dt=A;break}dt=w.return}}function vf(x){for(;dt!==null;){var w=dt;try{switch(w.tag){case 0:case 11:case 15:var A=w.return;try{_c(4,w)}catch(Fe){en(w,A,Fe)}break;case 1:var F=w.stateNode;if(typeof F.componentDidMount=="function"){var K=w.return;try{F.componentDidMount()}catch(Fe){en(w,K,Fe)}}var te=w.return;try{hf(w)}catch(Fe){en(w,te,Fe)}break;case 5:var fe=w.return;try{hf(w)}catch(Fe){en(w,fe,Fe)}}}catch(Fe){en(w,w.return,Fe)}if(w===x){dt=null;break}var Pe=w.sibling;if(Pe!==null){Pe.return=w.return,dt=Pe;break}dt=w.return}}var el=0,ga=1,mo=2,kc=3,rh=4;if(typeof Symbol=="function"&&Symbol.for){var as=Symbol.for;el=as("selector.component"),ga=as("selector.has_pseudo_class"),mo=as("selector.role"),kc=as("selector.test_id"),rh=as("selector.text")}function go(x){var w=Ue(x);if(w!=null){if(typeof w.memoizedProps["data-testname"]!="string")throw Error(o(364));return w}if(x=et(x),x===null)throw Error(o(362));return x.stateNode.current}function nh(x,w){switch(w.$$typeof){case el:if(x.type===w.value)return!0;break;case ga:e:{w=w.value,x=[x,0];for(var A=0;A<x.length;){var F=x[A++],K=x[A++],te=w[K];if(F.tag!==5||!Ke(F)){for(;te!=null&&nh(F,te);)K++,te=w[K];if(K===w.length){w=!0;break e}else for(F=F.child;F!==null;)x.push(F,K),F=F.sibling}}w=!1}return w;case mo:if(x.tag===5&&ft(x.stateNode,w.value))return!0;break;case rh:if((x.tag===5||x.tag===6)&&(x=ze(x),x!==null&&0<=x.indexOf(w.value)))return!0;break;case kc:if(x.tag===5&&(x=x.memoizedProps["data-testname"],typeof x=="string"&&x.toLowerCase()===w.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function yf(x){switch(x.$$typeof){case el:return"<"+(B(x.value)||"Unknown")+">";case ga:return":has("+(yf(x)||"")+")";case mo:return'[role="'+x.value+'"]';case rh:return'"'+x.value+'"';case kc:return'[data-testname="'+x.value+'"]';default:throw Error(o(365))}}function vo(x,w){var A=[];x=[x,0];for(var F=0;F<x.length;){var K=x[F++],te=x[F++],fe=w[te];if(K.tag!==5||!Ke(K)){for(;fe!=null&&nh(K,fe);)te++,fe=w[te];if(te===w.length)A.push(K);else for(K=K.child;K!==null;)x.push(K,te),K=K.sibling}}return A}function yo(x,w){if(!Oe)throw Error(o(363));x=go(x),x=vo(x,w),w=[],x=Array.from(x);for(var A=0;A<x.length;){var F=x[A++];if(F.tag===5)Ke(F)||w.push(F.stateNode);else for(F=F.child;F!==null;)x.push(F),F=F.sibling}return w}var xf=Math.ceil,ih=l.ReactCurrentDispatcher,Cc=l.ReactCurrentOwner,Pn=l.ReactCurrentBatchConfig,er=0,Hr=null,cn=null,Bn=0,ni=0,Bl=mn(0),dn=0,Ec=null,tl=0,Zr=0,Nc=0,Pu=null,Vi=null,Tc=0,ah=1/0,va=null;function Ir(){ah=_n()+500}var Mn=!1,Hn=null,$s=null,zl=!1,Ss=null,bf=0,Gn=0,sh=null,Pc=-1,Mc=0;function Jr(){return(er&6)!==0?_n():Pc!==-1?Pc:Pc=_n()}function ii(x){return(x.mode&1)===0?1:(er&2)!==0&&Bn!==0?Bn&-Bn:sc.transition!==null?(Mc===0&&(Mc=gl()),Mc):(x=ir,x!==0?x:gt())}function Ui(x,w,A,F){if(50<Gn)throw Gn=0,sh=null,Error(o(185));Si(x,A,F),((er&2)===0||x!==Hr)&&(x===Hr&&((er&2)===0&&(Zr|=A),dn===4&&rl(x,Bn)),Hi(x,F),A===1&&er===0&&(w.mode&1)===0&&(Ir(),io&&Jn()))}function Hi(x,w){var A=x.callbackNode;nc(x,w);var F=ps(x,x===Hr?Bn:0);if(F===0)A!==null&&Pr(A),x.callbackNode=null,x.callbackPriority=0;else if(w=F&-F,x.callbackPriority!==w){if(A!=null&&Pr(A),w===1)x.tag===0?or(Fp.bind(null,x)):pu(Fp.bind(null,x)),at?Ve(function(){(er&6)===0&&Jn()}):Dn(vl,Jn),A=null;else{switch(qt(F)){case 1:A=vl;break;case 4:A=ms;break;case 16:A=yl;break;case 536870912:A=hu;break;default:A=yl}A=$p(A,wf.bind(null,x))}x.callbackPriority=w,x.callbackNode=A}}function wf(x,w){if(Pc=-1,Mc=0,(er&6)!==0)throw Error(o(327));var A=x.callbackNode;if(nl()&&x.callbackNode!==A)return null;var F=ps(x,x===Hr?Bn:0);if(F===0)return null;if((F&30)!==0||(F&x.expiredLanes)!==0||w)w=Mu(x,F);else{w=F;var K=er;er|=2;var te=Up();(Hr!==x||Bn!==w)&&(va=null,Ir(),Fl(x,w));do try{Hp();break}catch(Pe){Ac(x,Pe)}while(!0);qd(),ih.current=te,er=K,cn!==null?w=0:(Hr=null,Bn=0,w=dn)}if(w!==0){if(w===2&&(K=Do(x),K!==0&&(F=K,w=_f(x,K))),w===1)throw A=Ec,Fl(x,0),rl(x,F),Hi(x,_n()),A;if(w===6)rl(x,F);else{if(K=x.current.alternate,(F&30)===0&&!Tv(K)&&(w=Mu(x,F),w===2&&(te=Do(x),te!==0&&(F=te,w=_f(x,te))),w===1))throw A=Ec,Fl(x,0),rl(x,F),Hi(x,_n()),A;switch(x.finishedWork=K,x.finishedLanes=F,w){case 0:case 1:throw Error(o(345));case 2:Vl(x,Vi,va);break;case 3:if(rl(x,F),(F&130023424)===F&&(w=Tc+500-_n(),10<w)){if(ps(x,0)!==0)break;if(K=x.suspendedLanes,(K&F)!==F){Jr(),x.pingedLanes|=x.suspendedLanes&K;break}x.timeoutHandle=se(Vl.bind(null,x,Vi,va),w);break}Vl(x,Vi,va);break;case 4:if(rl(x,F),(F&4194240)===F)break;for(w=x.eventTimes,K=-1;0<F;){var fe=31-hi(F);te=1<<fe,fe=w[fe],fe>K&&(K=fe),F&=~te}if(F=K,F=_n()-F,F=(120>F?120:480>F?480:1080>F?1080:1920>F?1920:3e3>F?3e3:4320>F?4320:1960*xf(F/1960))-F,10<F){x.timeoutHandle=se(Vl.bind(null,x,Vi,va),F);break}Vl(x,Vi,va);break;case 5:Vl(x,Vi,va);break;default:throw Error(o(329))}}}return Hi(x,_n()),x.callbackNode===A?wf.bind(null,x):null}function _f(x,w){var A=Pu;return x.current.memoizedState.isDehydrated&&(Fl(x,w).flags|=256),x=Mu(x,w),x!==2&&(w=Vi,Vi=A,w!==null&&Sf(w)),x}function Sf(x){Vi===null?Vi=x:Vi.push.apply(Vi,x)}function Tv(x){for(var w=x;;){if(w.flags&16384){var A=w.updateQueue;if(A!==null&&(A=A.stores,A!==null))for(var F=0;F<A.length;F++){var K=A[F],te=K.getSnapshot;K=K.value;try{if(!Ya(te(),K))return!1}catch{return!1}}}if(A=w.child,w.subtreeFlags&16384&&A!==null)A.return=w,w=A;else{if(w===x)break;for(;w.sibling===null;){if(w.return===null||w.return===x)return!0;w=w.return}w.sibling.return=w.return,w=w.sibling}}return!0}function rl(x,w){for(w&=~Nc,w&=~Zr,x.suspendedLanes|=w,x.pingedLanes&=~w,x=x.expirationTimes;0<w;){var A=31-hi(w),F=1<<A;x[A]=-1,w&=~F}}function Fp(x){if((er&6)!==0)throw Error(o(327));nl();var w=ps(x,0);if((w&1)===0)return Hi(x,_n()),null;var A=Mu(x,w);if(x.tag!==0&&A===2){var F=Do(x);F!==0&&(w=F,A=_f(x,F))}if(A===1)throw A=Ec,Fl(x,0),rl(x,w),Hi(x,_n()),A;if(A===6)throw Error(o(345));return x.finishedWork=x.current.alternate,x.finishedLanes=w,Vl(x,Vi,va),Hi(x,_n()),null}function Vp(x){Ss!==null&&Ss.tag===0&&(er&6)===0&&nl();var w=er;er|=1;var A=Pn.transition,F=ir;try{if(Pn.transition=null,ir=1,x)return x()}finally{ir=F,Pn.transition=A,er=w,(er&6)===0&&Jn()}}function kf(){ni=Bl.current,yr(Bl)}function Fl(x,w){x.finishedWork=null,x.finishedLanes=0;var A=x.timeoutHandle;if(A!==le&&(x.timeoutHandle=le,ge(A)),cn!==null)for(A=cn.return;A!==null;){var F=A;switch(mu(F),F.tag){case 1:F=F.type.childContextTypes,F!=null&&xr();break;case 3:xs(),yr(Fr),yr(on),dc();break;case 5:Nl(F);break;case 4:xs();break;case 13:yr(Cr);break;case 19:yr(Cr);break;case 10:ys(F.type._context);break;case 22:case 23:kf()}A=A.return}if(Hr=x,cn=x=Ul(x.current,null),Bn=ni=w,dn=0,Ec=null,Nc=Zr=tl=0,Vi=Pu=null,ca!==null){for(w=0;w<ca.length;w++)if(A=ca[w],F=A.interleaved,F!==null){A.interleaved=null;var K=F.next,te=A.pending;if(te!==null){var fe=te.next;te.next=K,F.next=fe}A.pending=F}ca=null}return x}function Ac(x,w){do{var A=cn;try{if(qd(),Ii.current=$e,Tl){for(var F=Vr.memoizedState;F!==null;){var K=F.queue;K!==null&&(K.pending=null),F=F.next}Tl=!1}if(so=0,En=Cn=Vr=null,Bi=!1,oo=0,Cc.current=null,A===null||A.return===null){dn=1,Ec=w,cn=null;break}e:{var te=x,fe=A.return,Pe=A,Fe=w;if(w=Bn,Pe.flags|=32768,Fe!==null&&typeof Fe=="object"&&typeof Fe.then=="function"){var it=Fe,Ct=Pe,Zt=Ct.tag;if((Ct.mode&1)===0&&(Zt===0||Zt===11||Zt===15)){var mt=Ct.alternate;mt?(Ct.updateQueue=mt.updateQueue,Ct.memoizedState=mt.memoizedState,Ct.lanes=mt.lanes):(Ct.updateQueue=null,Ct.memoizedState=null)}var Yr=lf(fe);if(Yr!==null){Yr.flags&=-257,ho(Yr,fe,Pe,te,w),Yr.mode&1&&of(te,it,w),w=Yr,Fe=it;var Rr=w.updateQueue;if(Rr===null){var ya=new Set;ya.add(Fe),w.updateQueue=ya}else Rr.add(Fe);break e}else{if((w&1)===0){of(te,it,w),jc();break e}Fe=Error(o(426))}}else if(Dr&&Pe.mode&1){var xo=lf(fe);if(xo!==null){(xo.flags&65536)===0&&(xo.flags|=256),ho(xo,fe,Pe,te,w),ac(Zo(Fe,Pe));break e}}te=Fe=Zo(Fe,Pe),dn!==4&&(dn=2),Pu===null?Pu=[te]:Pu.push(te),te=fe;do{switch(te.tag){case 3:te.flags|=65536,w&=-w,te.lanes|=w;var Ie=br(te,Fe,w);Cl(te,Ie);break e;case 1:Pe=Fe;var Me=te.type,He=te.stateNode;if((te.flags&128)===0&&(typeof Me.getDerivedStateFromError=="function"||He!==null&&typeof He.componentDidCatch=="function"&&($s===null||!$s.has(He)))){te.flags|=65536,w&=-w,te.lanes|=w;var vt=Yo(te,Pe,w);Cl(te,vt);break e}}te=te.return}while(te!==null)}qp(A)}catch(Lt){w=Lt,cn===A&&A!==null&&(cn=A=A.return);continue}break}while(!0)}function Up(){var x=ih.current;return ih.current=$e,x===null?$e:x}function jc(){(dn===0||dn===3||dn===2)&&(dn=4),Hr===null||(tl&268435455)===0&&(Zr&268435455)===0||rl(Hr,Bn)}function Mu(x,w){var A=er;er|=2;var F=Up();(Hr!==x||Bn!==w)&&(va=null,Fl(x,w));do try{Pv();break}catch(K){Ac(x,K)}while(!0);if(qd(),er=A,ih.current=F,cn!==null)throw Error(o(261));return Hr=null,Bn=0,dn}function Pv(){for(;cn!==null;)Gp(cn)}function Hp(){for(;cn!==null&&!Vd();)Gp(cn)}function Gp(x){var w=Lv(x.alternate,x,ni);x.memoizedProps=x.pendingProps,w===null?qp(x):cn=w,Cc.current=null}function qp(x){var w=x;do{var A=w.alternate;if(x=w.return,(w.flags&32768)===0){if(A=Cu(A,w,ni),A!==null){cn=A;return}}else{if(A=Ev(A,w),A!==null){A.flags&=32767,cn=A;return}if(x!==null)x.flags|=32768,x.subtreeFlags=0,x.deletions=null;else{dn=6,cn=null;return}}if(w=w.sibling,w!==null){cn=w;return}cn=w=x}while(w!==null);dn===0&&(dn=5)}function Vl(x,w,A){var F=ir,K=Pn.transition;try{Pn.transition=null,ir=1,Mv(x,w,A,F)}finally{Pn.transition=K,ir=F}return null}function Mv(x,w,A,F){do nl();while(Ss!==null);if((er&6)!==0)throw Error(o(327));A=x.finishedWork;var K=x.finishedLanes;if(A===null)return null;if(x.finishedWork=null,x.finishedLanes=0,A===x.current)throw Error(o(177));x.callbackNode=null,x.callbackPriority=0;var te=A.lanes|A.childLanes;if(Vs(x,te),x===Hr&&(cn=Hr=null,Bn=0),(A.subtreeFlags&2064)===0&&(A.flags&2064)===0||zl||(zl=!0,$p(yl,function(){return nl(),null})),te=(A.flags&15990)!==0,(A.subtreeFlags&15990)!==0||te){te=Pn.transition,Pn.transition=null;var fe=ir;ir=1;var Pe=er;er|=4,Cc.current=null,Nv(x,A),th(A,x),ne(x.containerInfo),x.current=A,Sc(A),Io(),er=Pe,ir=fe,Pn.transition=te}else x.current=A;if(zl&&(zl=!1,Ss=x,bf=K),te=x.pendingLanes,te===0&&($s=null),Bo(A.stateNode),Hi(x,_n()),w!==null)for(F=x.onRecoverableError,A=0;A<w.length;A++)K=w[A],F(K.value,{componentStack:K.stack,digest:K.digest});if(Mn)throw Mn=!1,x=Hn,Hn=null,x;return(bf&1)!==0&&x.tag!==0&&nl(),te=x.pendingLanes,(te&1)!==0?x===sh?Gn++:(Gn=0,sh=x):Gn=0,Jn(),null}function nl(){if(Ss!==null){var x=qt(bf),w=Pn.transition,A=ir;try{if(Pn.transition=null,ir=16>x?16:x,Ss===null)var F=!1;else{if(x=Ss,Ss=null,bf=0,(er&6)!==0)throw Error(o(331));var K=er;for(er|=4,dt=x.current;dt!==null;){var te=dt,fe=te.child;if((dt.flags&16)!==0){var Pe=te.deletions;if(Pe!==null){for(var Fe=0;Fe<Pe.length;Fe++){var it=Pe[Fe];for(dt=it;dt!==null;){var Ct=dt;switch(Ct.tag){case 0:case 11:case 15:Eu(8,Ct,te)}var Zt=Ct.child;if(Zt!==null)Zt.return=Ct,dt=Zt;else for(;dt!==null;){Ct=dt;var mt=Ct.sibling,Yr=Ct.return;if(Jd(Ct),Ct===it){dt=null;break}if(mt!==null){mt.return=Yr,dt=mt;break}dt=Yr}}}var Rr=te.alternate;if(Rr!==null){var ya=Rr.child;if(ya!==null){Rr.child=null;do{var xo=ya.sibling;ya.sibling=null,ya=xo}while(ya!==null)}}dt=te}}if((te.subtreeFlags&2064)!==0&&fe!==null)fe.return=te,dt=fe;else e:for(;dt!==null;){if(te=dt,(te.flags&2048)!==0)switch(te.tag){case 0:case 11:case 15:Eu(9,te,te.return)}var Ie=te.sibling;if(Ie!==null){Ie.return=te.return,dt=Ie;break e}dt=te.return}}var Me=x.current;for(dt=Me;dt!==null;){fe=dt;var He=fe.child;if((fe.subtreeFlags&2064)!==0&&He!==null)He.return=fe,dt=He;else e:for(fe=Me;dt!==null;){if(Pe=dt,(Pe.flags&2048)!==0)try{switch(Pe.tag){case 0:case 11:case 15:_c(9,Pe)}}catch(Lt){en(Pe,Pe.return,Lt)}if(Pe===fe){dt=null;break e}var vt=Pe.sibling;if(vt!==null){vt.return=Pe.return,dt=vt;break e}dt=Pe.return}}if(er=K,Jn(),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot($r,x)}catch{}F=!0}return F}finally{ir=A,Pn.transition=w}}return!1}function Wp(x,w,A){w=Zo(A,w),w=br(x,w,1),x=Hs(x,w,1),w=Jr(),x!==null&&(Si(x,1,w),Hi(x,w))}function en(x,w,A){if(x.tag===3)Wp(x,x,A);else for(;w!==null;){if(w.tag===3){Wp(w,x,A);break}else if(w.tag===1){var F=w.stateNode;if(typeof w.type.getDerivedStateFromError=="function"||typeof F.componentDidCatch=="function"&&($s===null||!$s.has(F))){x=Zo(A,x),x=Yo(w,x,1),w=Hs(w,x,1),x=Jr(),w!==null&&(Si(w,1,x),Hi(w,x));break}}w=w.return}}function Av(x,w,A){var F=x.pingCache;F!==null&&F.delete(w),w=Jr(),x.pingedLanes|=x.suspendedLanes&A,Hr===x&&(Bn&A)===A&&(dn===4||dn===3&&(Bn&130023424)===Bn&&500>_n()-Tc?Fl(x,0):Nc|=A),Hi(x,w)}function jv(x,w){w===0&&((x.mode&1)===0?w=1:(w=Fs,Fs<<=1,(Fs&130023424)===0&&(Fs=4194304)));var A=Jr();x=La(x,w),x!==null&&(Si(x,w,A),Hi(x,A))}function Rv(x){var w=x.memoizedState,A=0;w!==null&&(A=w.retryLane),jv(x,A)}function Qx(x,w){var A=0;switch(x.tag){case 13:var F=x.stateNode,K=x.memoizedState;K!==null&&(A=K.retryLane);break;case 19:F=x.stateNode;break;default:throw Error(o(314))}F!==null&&F.delete(w),jv(x,A)}var Lv;Lv=function(x,w,A){if(x!==null)if(x.memoizedProps!==w.pendingProps||Fr.current)Tn=!0;else{if((x.lanes&A)===0&&(w.flags&128)===0)return Tn=!1,Ll(x,w,A);Tn=(x.flags&131072)!==0}else Tn=!1,Dr&&(w.flags&1048576)!==0&&tf(w,zo,w.index);switch(w.lanes=0,w.tag){case 2:var F=w.type;Qd(x,w),x=w.pendingProps;var K=ia(w,on.current);Oi(w,A),K=Ml(null,w,F,x,K,A);var te=hc();return w.flags|=1,typeof K=="object"&&K!==null&&typeof K.render=="function"&&K.$$typeof===void 0?(w.tag=1,w.memoizedState=null,w.updateQueue=null,Mt(F)?(te=!0,Qn(w)):te=!1,w.memoizedState=K.state!==null&&K.state!==void 0?K.state:null,Wd(w),K.updater=mi,w.stateNode=K,K._reactInternals=w,ws(w,F,x,A),w=zi(null,w,F,!0,te,A)):(w.tag=0,Dr&&te&&Li(w),Un(null,w,K,A),w=w.child),w;case 16:F=w.elementType;e:{switch(Qd(x,w),x=w.pendingProps,K=F._init,F=K(F._payload),w.type=F,K=w.tag=Jx(F),x=Ar(F,x),K){case 0:w=fo(null,w,F,x,A);break e;case 1:w=Ei(null,w,F,x,A);break e;case 11:w=uf(null,w,F,x,A);break e;case 14:w=wu(null,w,F,Ar(F.type,x),A);break e}throw Error(o(306,F,""))}return w;case 0:return F=w.type,K=w.pendingProps,K=w.elementType===F?K:Ar(F,K),fo(x,w,F,K,A);case 1:return F=w.type,K=w.pendingProps,K=w.elementType===F?K:Ar(F,K),Ei(x,w,F,K,A);case 3:e:{if(Rl(w),x===null)throw Error(o(387));F=w.pendingProps,te=w.memoizedState,K=te.element,Us(x,w),pi(w,F,null,A);var fe=w.memoizedState;if(F=fe.element,Se&&te.isDehydrated)if(te={element:F,isDehydrated:!1,cache:fe.cache,pendingSuspenseBoundaries:fe.pendingSuspenseBoundaries,transitions:fe.transitions},w.updateQueue.baseState=te,w.memoizedState=te,w.flags&256){K=Zo(Error(o(423)),w),w=_u(x,w,F,A,K);break e}else if(F!==K){K=Zo(Error(o(424)),w),w=_u(x,w,F,A,K);break e}else for(Se&&(ln=Is(w.stateNode.containerInfo),Vn=w,Dr=!0,la=null,wl=!1),A=oc(w,null,F,A),w.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling;else{if(ao(),F===K){w=Jo(x,w,A);break e}Un(x,w,F,A)}w=w.child}return w;case 5:return vu(w),x===null&&Ud(w),F=w.type,K=w.pendingProps,te=x!==null?x.memoizedProps:null,fe=K.children,ve(F,K)?fe=null:te!==null&&ve(F,te)&&(w.flags|=32),Ur(x,w),Un(x,w,fe,A),w.child;case 6:return x===null&&Ud(w),null;case 13:return Dp(x,w,A);case 4:return El(w,w.stateNode.containerInfo),F=w.pendingProps,x===null?w.child=Fo(w,null,F,A):Un(x,w,F,A),w.child;case 11:return F=w.type,K=w.pendingProps,K=w.elementType===F?K:Ar(F,K),uf(x,w,F,K,A);case 7:return Un(x,w,w.pendingProps,A),w.child;case 8:return Un(x,w,w.pendingProps.children,A),w.child;case 12:return Un(x,w,w.pendingProps.children,A),w.child;case 10:e:{if(F=w.type._context,K=w.pendingProps,te=w.memoizedProps,fe=K.value,Ra(w,F,fe),te!==null)if(Ya(te.value,fe)){if(te.children===K.children&&!Fr.current){w=Jo(x,w,A);break e}}else for(te=w.child,te!==null&&(te.return=w);te!==null;){var Pe=te.dependencies;if(Pe!==null){fe=te.child;for(var Fe=Pe.firstContext;Fe!==null;){if(Fe.context===F){if(te.tag===1){Fe=Oa(-1,A&-A),Fe.tag=2;var it=te.updateQueue;if(it!==null){it=it.shared;var Ct=it.pending;Ct===null?Fe.next=Fe:(Fe.next=Ct.next,Ct.next=Fe),it.pending=Fe}}te.lanes|=A,Fe=te.alternate,Fe!==null&&(Fe.lanes|=A),Vo(te.return,A,w),Pe.lanes|=A;break}Fe=Fe.next}}else if(te.tag===10)fe=te.type===w.type?null:te.child;else if(te.tag===18){if(fe=te.return,fe===null)throw Error(o(341));fe.lanes|=A,Pe=fe.alternate,Pe!==null&&(Pe.lanes|=A),Vo(fe,A,w),fe=te.sibling}else fe=te.child;if(fe!==null)fe.return=te;else for(fe=te;fe!==null;){if(fe===w){fe=null;break}if(te=fe.sibling,te!==null){te.return=fe.return,fe=te;break}fe=fe.return}te=fe}Un(x,w,K.children,A),w=w.child}return w;case 9:return K=w.type,F=w.pendingProps.children,Oi(w,A),K=ua(K),F=F(K),w.flags|=1,Un(x,w,F,A),w.child;case 14:return F=w.type,K=Ar(F,w.pendingProps),K=Ar(F.type,K),wu(x,w,F,K,A);case 15:return Qo(x,w,w.type,w.pendingProps,A);case 17:return F=w.type,K=w.pendingProps,K=w.elementType===F?K:Ar(F,K),Qd(x,w),w.tag=1,Mt(F)?(x=!0,Qn(w)):x=!1,Oi(w,A),Ko(w,F,K),ws(w,F,K,A),zi(null,w,F,!0,x,A);case 19:return df(x,w,A);case 22:return Kr(x,w,A)}throw Error(o(156,w.tag))};function $p(x,w){return Dn(x,w)}function Ov(x,w,A,F){this.tag=x,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=w,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=F,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ss(x,w,A,F){return new Ov(x,w,A,F)}function Rc(x){return x=x.prototype,!(!x||!x.isReactComponent)}function Jx(x){if(typeof x=="function")return Rc(x)?1:0;if(x!=null){if(x=x.$$typeof,x===S)return 11;if(x===C)return 14}return 2}function Ul(x,w){var A=x.alternate;return A===null?(A=ss(x.tag,w,x.key,x.mode),A.elementType=x.elementType,A.type=x.type,A.stateNode=x.stateNode,A.alternate=x,x.alternate=A):(A.pendingProps=w,A.type=x.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=x.flags&14680064,A.childLanes=x.childLanes,A.lanes=x.lanes,A.child=x.child,A.memoizedProps=x.memoizedProps,A.memoizedState=x.memoizedState,A.updateQueue=x.updateQueue,w=x.dependencies,A.dependencies=w===null?null:{lanes:w.lanes,firstContext:w.firstContext},A.sibling=x.sibling,A.index=x.index,A.ref=x.ref,A}function Cf(x,w,A,F,K,te){var fe=2;if(F=x,typeof x=="function")Rc(x)&&(fe=1);else if(typeof x=="string")fe=5;else e:switch(x){case d:return Ni(A.children,K,te,w);case p:fe=8,K|=8;break;case v:return x=ss(12,A,w,K|2),x.elementType=v,x.lanes=te,x;case k:return x=ss(13,A,w,K),x.elementType=k,x.lanes=te,x;case T:return x=ss(19,A,w,K),x.elementType=T,x.lanes=te,x;case P:return Lc(A,K,te,w);default:if(typeof x=="object"&&x!==null)switch(x.$$typeof){case y:fe=10;break e;case b:fe=9;break e;case S:fe=11;break e;case C:fe=14;break e;case N:fe=16,F=null;break e}throw Error(o(130,x==null?x:typeof x,""))}return w=ss(fe,A,w,K),w.elementType=x,w.type=F,w.lanes=te,w}function Ni(x,w,A,F){return x=ss(7,x,F,w),x.lanes=A,x}function Lc(x,w,A,F){return x=ss(22,x,F,w),x.elementType=P,x.lanes=A,x.stateNode={isHidden:!1},x}function Oc(x,w,A){return x=ss(6,x,null,w),x.lanes=A,x}function Ef(x,w,A){return w=ss(4,x.children!==null?x.children:[],x.key,w),w.lanes=A,w.stateNode={containerInfo:x.containerInfo,pendingChildren:null,implementation:x.implementation},w}function Dv(x,w,A,F,K){this.tag=w,this.containerInfo=x,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=le,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=no(0),this.expirationTimes=no(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=no(0),this.identifierPrefix=F,this.onRecoverableError=K,Se&&(this.mutableSourceEagerHydrationData=null)}function Kp(x,w,A,F,K,te,fe,Pe,Fe){return x=new Dv(x,w,A,Pe,Fe),w===1?(w=1,te===!0&&(w|=8)):w=0,te=ss(3,null,null,w),x.current=te,te.stateNode=x,te.memoizedState={element:F,isDehydrated:A,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wd(te),x}function Nf(x){if(!x)return dr;x=x._reactInternals;e:{if(z(x)!==x||x.tag!==1)throw Error(o(170));var w=x;do{switch(w.tag){case 3:w=w.stateNode.context;break e;case 1:if(Mt(w.type)){w=w.stateNode.__reactInternalMemoizedMergedChildContext;break e}}w=w.return}while(w!==null);throw Error(o(171))}if(x.tag===1){var A=x.type;if(Mt(A))return du(x,A,w)}return w}function Au(x){var w=x._reactInternals;if(w===void 0)throw typeof x.render=="function"?Error(o(188)):(x=Object.keys(x).join(","),Error(o(268,x)));return x=Y(w),x===null?null:x.stateNode}function Tf(x,w){if(x=x.memoizedState,x!==null&&x.dehydrated!==null){var A=x.retryLane;x.retryLane=A!==0&&A<w?A:w}}function Dc(x,w){Tf(x,w),(x=x.alternate)&&Tf(x,w)}function e1(x){return x=Y(x),x===null?null:x.stateNode}function Iv(){return null}return n.attemptContinuousHydration=function(x){if(x.tag===13){var w=La(x,134217728);if(w!==null){var A=Jr();Ui(w,x,134217728,A)}Dc(x,134217728)}},n.attemptDiscreteHydration=function(x){if(x.tag===13){var w=La(x,1);if(w!==null){var A=Jr();Ui(w,x,1,A)}Dc(x,1)}},n.attemptHydrationAtCurrentPriority=function(x){if(x.tag===13){var w=ii(x),A=La(x,w);if(A!==null){var F=Jr();Ui(A,x,w,F)}Dc(x,w)}},n.attemptSynchronousHydration=function(x){switch(x.tag){case 3:var w=x.stateNode;if(w.current.memoizedState.isDehydrated){var A=ro(w.pendingLanes);A!==0&&(ja(w,A|1),Hi(w,_n()),(er&6)===0&&(Ir(),Jn()))}break;case 13:Vp(function(){var F=La(x,1);if(F!==null){var K=Jr();Ui(F,x,1,K)}}),Dc(x,1)}},n.batchedUpdates=function(x,w){var A=er;er|=1;try{return x(w)}finally{er=A,er===0&&(Ir(),io&&Jn())}},n.createComponentSelector=function(x){return{$$typeof:el,value:x}},n.createContainer=function(x,w,A,F,K,te,fe){return Kp(x,w,!1,null,A,F,K,te,fe)},n.createHasPseudoClassSelector=function(x){return{$$typeof:ga,value:x}},n.createHydrationContainer=function(x,w,A,F,K,te,fe,Pe,Fe){return x=Kp(A,F,!0,x,K,te,fe,Pe,Fe),x.context=Nf(null),A=x.current,F=Jr(),K=ii(A),te=Oa(F,K),te.callback=w??null,Hs(A,te,K),x.current.lanes=K,Si(x,K,F),Hi(x,F),x},n.createPortal=function(x,w,A){var F=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:F==null?null:""+F,children:x,containerInfo:w,implementation:A}},n.createRoleSelector=function(x){return{$$typeof:mo,value:x}},n.createTestNameSelector=function(x){return{$$typeof:kc,value:x}},n.createTextSelector=function(x){return{$$typeof:rh,value:x}},n.deferredUpdates=function(x){var w=ir,A=Pn.transition;try{return Pn.transition=null,ir=16,x()}finally{ir=w,Pn.transition=A}},n.discreteUpdates=function(x,w,A,F,K){var te=ir,fe=Pn.transition;try{return Pn.transition=null,ir=1,x(w,A,F,K)}finally{ir=te,Pn.transition=fe,er===0&&Ir()}},n.findAllNodes=yo,n.findBoundingRects=function(x,w){if(!Oe)throw Error(o(363));w=yo(x,w),x=[];for(var A=0;A<w.length;A++)x.push(Ne(w[A]));for(w=x.length-1;0<w;w--){A=x[w];for(var F=A.x,K=F+A.width,te=A.y,fe=te+A.height,Pe=w-1;0<=Pe;Pe--)if(w!==Pe){var Fe=x[Pe],it=Fe.x,Ct=it+Fe.width,Zt=Fe.y,mt=Zt+Fe.height;if(F>=it&&te>=Zt&&K<=Ct&&fe<=mt){x.splice(w,1);break}else if(F!==it||A.width!==Fe.width||mt<te||Zt>fe){if(!(te!==Zt||A.height!==Fe.height||Ct<F||it>K)){it>F&&(Fe.width+=it-F,Fe.x=F),Ct<K&&(Fe.width=K-it),x.splice(w,1);break}}else{Zt>te&&(Fe.height+=Zt-te,Fe.y=te),mt<fe&&(Fe.height=fe-Zt),x.splice(w,1);break}}}return x},n.findHostInstance=Au,n.findHostInstanceWithNoPortals=function(x){return x=$(x),x=x!==null?q(x):null,x===null?null:x.stateNode},n.findHostInstanceWithWarning=function(x){return Au(x)},n.flushControlled=function(x){var w=er;er|=1;var A=Pn.transition,F=ir;try{Pn.transition=null,ir=1,x()}finally{ir=F,Pn.transition=A,er=w,er===0&&(Ir(),Jn())}},n.flushPassiveEffects=nl,n.flushSync=Vp,n.focusWithin=function(x,w){if(!Oe)throw Error(o(363));for(x=go(x),w=vo(x,w),w=Array.from(w),x=0;x<w.length;){var A=w[x++];if(!Ke(A)){if(A.tag===5&&yt(A.stateNode))return!0;for(A=A.child;A!==null;)w.push(A),A=A.sibling}}return!1},n.getCurrentUpdatePriority=function(){return ir},n.getFindAllNodesFailureDescription=function(x,w){if(!Oe)throw Error(o(363));var A=0,F=[];x=[go(x),0];for(var K=0;K<x.length;){var te=x[K++],fe=x[K++],Pe=w[fe];if((te.tag!==5||!Ke(te))&&(nh(te,Pe)&&(F.push(yf(Pe)),fe++,fe>A&&(A=fe)),fe<w.length))for(te=te.child;te!==null;)x.push(te,fe),te=te.sibling}if(A<w.length){for(x=[];A<w.length;A++)x.push(yf(w[A]));return`findAllNodes was able to match part of the selector:
  `+(F.join(" > ")+`

No matching component was found for:
  `)+x.join(" > ")}return null},n.getPublicRootInstance=function(x){return x=x.current,x.child?x.child.tag===5?Z(x.child.stateNode):x.child.stateNode:null},n.injectIntoDevTools=function(x){if(x={bundleType:x.bundleType,version:x.version,rendererPackageName:x.rendererPackageName,rendererConfig:x.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:l.ReactCurrentDispatcher,findHostInstanceByFiber:e1,findFiberByHostInstance:x.findFiberByHostInstance||Iv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")x=!1;else{var w=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(w.isDisabled||!w.supportsFiber)x=!0;else{try{$r=w.inject(x),Sn=w}catch{}x=!!w.checkDCE}}return x},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(x,w,A,F){if(!Oe)throw Error(o(363));x=yo(x,w);var K=Et(x,A,F).disconnect;return{disconnect:function(){K()}}},n.registerMutableSourceForHydration=function(x,w){var A=w._getVersion;A=A(w._source),x.mutableSourceEagerHydrationData==null?x.mutableSourceEagerHydrationData=[w,A]:x.mutableSourceEagerHydrationData.push(w,A)},n.runWithPriority=function(x,w){var A=ir;try{return ir=x,w()}finally{ir=A}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(x,w,A,F){var K=w.current,te=Jr(),fe=ii(K);return A=Nf(A),w.context===null?w.context=A:w.pendingContext=A,w=Oa(te,fe),w.payload={element:x},F=F===void 0?null:F,F!==null&&(w.callback=F),x=Hs(K,w,fe),x!==null&&(Ui(x,K,fe,te),Ho(x,K,fe)),fe},n}),kw}var I5;function mF(){return I5||(I5=1,Sw.exports=pF()),Sw.exports}var gF=mF();const vF=Kh(gF);var Cw={exports:{}},Zc={};var B5;function yF(){return B5||(B5=1,Zc.ConcurrentRoot=1,Zc.ContinuousEventPriority=4,Zc.DefaultEventPriority=16,Zc.DiscreteEventPriority=1,Zc.IdleEventPriority=536870912,Zc.LegacyRoot=0),Zc}var z5;function xF(){return z5||(z5=1,Cw.exports=yF()),Cw.exports}var xM=xF(),bF=ur();const F5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let V5=!1,U5=!1;const rS=".react-konva-event",wF=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,_F=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,SF={};function Rx(r,e,n=SF){if(!V5&&"zIndex"in e&&(console.warn(_F),V5=!0),!U5&&e.draggable){var i=e.x!==void 0||e.y!==void 0,a=e.onDragEnd||e.onDragMove;i&&!a&&(console.warn(wF),U5=!0)}for(var s in n)if(!F5[s]){var o=s.slice(0,2)==="on",l=n[s]!==e[s];if(o&&l){var u=s.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),r.off(u,n[s])}var c=!e.hasOwnProperty(s);c&&r.setAttr(s,void 0)}var d=e._useStrictMode,p={},v=!1;const y={};for(var s in e)if(!F5[s]){var o=s.slice(0,2)==="on",b=n[s]!==e[s];if(o&&b){var u=s.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),e[s]&&(y[u]=e[s])}!o&&(e[s]!==n[s]||d&&e[s]!==r.getAttr(s))&&(v=!0,p[s]=e[s])}v&&(r.setAttrs(p),Ld(r));for(var u in y)r.on(u+rS,y[u])}function Ld(r){if(!bF.Konva.autoDrawEnabled){var e=r.getLayer()||r.getStage();e&&e.batchDraw()}}var Ew=__();const bM={},kF={};Gg.Node.prototype._applyProps=Rx;function CF(r,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}r.add(e),Ld(r)}function EF(r,e,n){let i=Gg[r];i||(console.error(`Konva has no node with the type ${r}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${r}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),i=Gg.Group);const a={},s={};for(var o in e){var l=o.slice(0,2)==="on";l?s[o]=e[o]:a[o]=e[o]}const u=new i(a);return Rx(u,s),u}function NF(r,e,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${r}"`)}function TF(r,e,n){return!1}function PF(r){return r}function MF(){return null}function AF(){return null}function jF(r,e,n,i){return kF}function RF(){}function LF(r){}function OF(r,e){return!1}function DF(){return bM}function IF(){return bM}const BF=setTimeout,zF=clearTimeout,FF=-1;function VF(r,e){return!1}const UF=!1,HF=!0,GF=!0;function qF(r,e){e.parent===r?e.moveToTop():r.add(e),Ld(r)}function WF(r,e){e.parent===r?e.moveToTop():r.add(e),Ld(r)}function wM(r,e,n){e._remove(),r.add(e),e.setZIndex(n.getZIndex()),Ld(r)}function $F(r,e,n){wM(r,e,n)}function KF(r,e){e.destroy(),e.off(rS),Ld(r)}function ZF(r,e){e.destroy(),e.off(rS),Ld(r)}function YF(r,e,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function XF(r,e,n){}function QF(r,e,n,i,a){Rx(r,a,i)}function JF(r){r.hide(),Ld(r)}function eV(r){}function tV(r,e){(e.visible==null||e.visible)&&r.show()}function rV(r,e){}function nV(r){}function iV(){}const aV=()=>xM.DefaultEventPriority,sV=Object.freeze(Object.defineProperty({__proto__:null,appendChild:qF,appendChildToContainer:WF,appendInitialChild:CF,cancelTimeout:zF,clearContainer:nV,commitMount:XF,commitTextUpdate:YF,commitUpdate:QF,createInstance:EF,createTextInstance:NF,detachDeletedInstance:iV,finalizeInitialChildren:TF,getChildHostContext:IF,getCurrentEventPriority:aV,getPublicInstance:PF,getRootHostContext:DF,hideInstance:JF,hideTextInstance:eV,idlePriority:Ew.unstable_IdlePriority,insertBefore:wM,insertInContainerBefore:$F,isPrimaryRenderer:UF,noTimeout:FF,now:Ew.unstable_now,prepareForCommit:MF,preparePortalMount:AF,prepareUpdate:jF,removeChild:KF,removeChildFromContainer:ZF,resetAfterCommit:RF,resetTextContent:LF,run:Ew.unstable_runWithPriority,scheduleTimeout:BF,shouldDeprioritizeSubtree:OF,shouldSetTextContent:VF,supportsMutation:GF,unhideInstance:tV,unhideTextInstance:rV,warnsIfNotActing:HF},Symbol.toStringTag,{value:"Module"}));var oV=Object.defineProperty,lV=Object.defineProperties,uV=Object.getOwnPropertyDescriptors,H5=Object.getOwnPropertySymbols,cV=Object.prototype.hasOwnProperty,dV=Object.prototype.propertyIsEnumerable,G5=(r,e,n)=>e in r?oV(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n,q5=(r,e)=>{for(var n in e||(e={}))cV.call(e,n)&&G5(r,n,e[n]);if(H5)for(var n of H5(e))dV.call(e,n)&&G5(r,n,e[n]);return r},hV=(r,e)=>lV(r,uV(e)),W5,$5;typeof window<"u"&&((W5=window.document)!=null&&W5.createElement||(($5=window.navigator)==null?void 0:$5.product)==="ReactNative")?ce.useLayoutEffect:ce.useEffect;function _M(r,e,n){if(!r)return;if(n(r)===!0)return r;let i=r.child;for(;i;){const a=_M(i,e,n);if(a)return a;i=i.sibling}}function SM(r){try{return Object.defineProperties(r,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return r}}const K5=console.error;console.error=function(){const r=[...arguments].join("");if(r?.startsWith("Warning:")&&r.includes("useContext")){console.error=K5;return}return K5.apply(this,arguments)};const nS=SM(ce.createContext(null));class kM extends ce.Component{render(){return ce.createElement(nS.Provider,{value:this._reactInternals},this.props.children)}}function fV(){const r=ce.useContext(nS);if(r===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ce.useId();return ce.useMemo(()=>{for(const i of[r,r?.alternate]){if(!i)continue;const a=_M(i,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(a)return a}},[r,e])}function pV(){const r=fV(),[e]=ce.useState(()=>new Map);e.clear();let n=r;for(;n;){if(n.type&&typeof n.type=="object"){const a=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;a&&a!==nS&&!e.has(a)&&e.set(a,ce.useContext(SM(a)))}n=n.return}return e}function mV(){const r=pV();return ce.useMemo(()=>Array.from(r.keys()).reduce((e,n)=>i=>ce.createElement(e,null,ce.createElement(n.Provider,hV(q5({},i),{value:r.get(n)}))),e=>ce.createElement(kM,q5({},e))),[r])}function gV(r){const e=Xt.useRef({});return Xt.useLayoutEffect(()=>{e.current=r}),Xt.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const vV=r=>{const e=Xt.useRef(),n=Xt.useRef(),i=Xt.useRef(),a=gV(r),s=mV(),o=l=>{const{forwardedRef:u}=r;u&&(typeof u=="function"?u(l):u.current=l)};return Xt.useLayoutEffect(()=>(n.current=new Gg.Stage({width:r.width,height:r.height,container:e.current}),o(n.current),i.current=cg.createContainer(n.current,xM.LegacyRoot,!1,null),cg.updateContainer(Xt.createElement(s,{},r.children),i.current),()=>{Gg.isBrowser&&(o(null),cg.updateContainer(null,i.current,null),n.current.destroy())}),[]),Xt.useLayoutEffect(()=>{o(n.current),Rx(n.current,r,a),cg.updateContainer(Xt.createElement(s,{},r.children),i.current,null)}),Xt.createElement("div",{ref:e,id:r.id,accessKey:r.accessKey,className:r.className,role:r.role,style:r.style,tabIndex:r.tabIndex,title:r.title})},Z5="Layer",Y5="Rect",yV="Line",xV="Image",bV="Text",wV="Transformer",cg=vF(sV);cg.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Xt.version,rendererPackageName:"react-konva"});const _V=Xt.forwardRef((r,e)=>Xt.createElement(kM,{},Xt.createElement(vV,{...r,forwardedRef:e}))),SV=({isOpen:r,onClose:e,onConfirm:n,title:i,message:a,initialValue:s="",placeholder:o="",confirmText:l="Confirmar",cancelText:u="Cancelar"})=>{const[c,d]=ce.useState(s),p=ce.useRef(null);if(ce.useEffect(()=>{d(s)},[s,r]),ce.useEffect(()=>{r&&p.current&&setTimeout(()=>p.current.focus(),50)},[r]),!r)return null;const v=y=>{y.preventDefault(),n(c),e()};return iu.createPortal(m.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-md animate-in fade-in duration-300",children:m.jsxs("div",{className:"bg-[#0f0f13] border border-white/10 rounded-2xl p-6 shadow-2xl shadow-black/50 w-full max-w-md space-y-5 animate-in zoom-in-95 slide-in-from-bottom-2 duration-300 relative overflow-hidden ring-1 ring-white/5",onClick:y=>y.stopPropagation(),children:[m.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary to-transparent opacity-70"}),m.jsx("div",{className:"absolute -top-10 -right-10 size-40 bg-primary/5 rounded-full blur-3xl pointer-events-none"}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:i}),a&&m.jsx("p",{className:"text-sm text-slate-400 leading-relaxed mt-2",children:a})]}),m.jsxs("form",{onSubmit:v,className:"space-y-6",children:[m.jsx("input",{ref:p,type:"text",value:c,onChange:y=>d(y.target.value),placeholder:o,className:"w-full bg-black/30 border border-white/10 rounded-xl px-4 py-3.5 text-white placeholder-slate-600 focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all font-sans text-sm shadow-inner"}),m.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[m.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors",children:u}),m.jsx(nn,{type:"submit",variant:"primary",disabled:!c.trim(),children:l})]})]})]})}),document.body)},Nw=({stepNumber:r,title:e,isOpen:n,onClick:i,children:a})=>m.jsxs("div",{className:`border border-white/10 rounded-2xl bg-[#13141f] overflow-hidden transition-all duration-300 ${n?"ring-1 ring-primary/50":"opacity-80"}`,children:[m.jsxs("button",{onClick:i,className:"w-full flex items-center justify-between p-6 hover:bg-white/5 transition-colors",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:`size-8 rounded-full flex items-center justify-center font-black text-sm ${n?"bg-primary text-white":"bg-white/10 text-slate-400"}`,children:r}),m.jsx("h3",{className:`text-lg font-bold ${n?"text-white":"text-slate-400"}`,children:e})]}),m.jsx("span",{className:`material-symbols-outlined transition-transform duration-300 ${n?"rotate-180 text-primary":"text-slate-500"}`,children:"expand_more"})]}),n&&m.jsx("div",{className:"p-6 pt-0 border-t border-white/5 animate-in fade-in slide-in-from-top-2",children:a})]}),Tw=({icon:r,title:e,desc:n,selected:i,onClick:a})=>m.jsxs("div",{onClick:a,className:`p-6 rounded-xl border cursor-pointer transition-all relative group h-full flex flex-col justify-between ${i?"bg-primary/20 border-primary shadow-[0_0_30px_rgba(var(--color-primary),0.3)]":"bg-[#0a0a0c] border-white/10 hover:border-white/30"}`,children:[m.jsxs("div",{className:"mb-4",children:[m.jsx("div",{className:`size-12 rounded-lg flex items-center justify-center mb-4 ${i?"bg-primary text-white":"bg-white/10 text-slate-400 group-hover:text-white group-hover:bg-white/20"}`,children:m.jsx("span",{className:"material-symbols-outlined text-2xl",children:r})}),m.jsx("h4",{className:"font-bold text-white mb-1",children:e}),m.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:n})]}),i&&m.jsx("div",{className:"absolute top-4 right-4 size-3 bg-primary rounded-full shadow-glow"})]}),kV=({src:r,x:e,y:n,width:i,height:a})=>{const[s,o]=ce.useState(null);return ce.useEffect(()=>{if(!r)return;const l=new window.Image;l.src=r,l.crossOrigin="Anonymous",l.onload=()=>{o(l)}},[r]),m.jsx(xV,{image:s,x:e,y:n,width:i,height:a})},CV=({selectedId:r})=>{const e=Xt.useRef();return Xt.useEffect(()=>{if(r){const n=e.current.getStage().findOne("#"+r);n&&(e.current.nodes([n]),e.current.getLayer().batchDraw())}else e.current.nodes([])},[r]),m.jsx(wV,{ref:e})},B2=({mode:r})=>{const{username:e,projectName:n,folderId:i,entityId:a}=Yi(),s=Na(),o=Zh(),{setRightOpen:l,setRightPanelMode:u,setAvailableTemplates:c,mapSettings:d,setMapSettings:p,setOnMapSettingsChange:v}=au(),[y,b]=ce.useState(r==="create"?"setup":"editor");ce.useEffect(()=>{b(r==="create"?"setup":"editor")},[r]);const[S,k]=ce.useState(o.state?.folderId||null),[T,C]=ce.useState(1),[N,P]=ce.useState({name:"New Map",description:"",parentZone:null,type:"regional",sourceType:"blank",dims:{width:800,height:600},bgImage:null}),[R,O]=ce.useState(!1),[B,I]=ce.useState("brush"),[z,V]=ce.useState([]),[$,Y]=ce.useState([]),[D,q]=ce.useState([]),[G,Z]=ce.useState(null),Q=Xt.useRef(!1),[J,ie]=ce.useState({isOpen:!1,id:null,text:""}),ne=le=>{le.target===le.target.getStage()&&Z(null)},W=le=>{ne(le);const me=le.target.getStage().getPointerPosition();B!=="select"&&(Q.current=!0,B==="brush"||B==="eraser"?V([...z,{id:`line-${Date.now()}`,tool:B,points:[me.x,me.y],color:B==="eraser"?"#ffffff":"#df4b26",size:B==="eraser"?20:5}]):B==="rect"?Y([...$,{id:`rect-${Date.now()}`,x:me.x,y:me.y,width:0,height:0,color:"#df4b26"}]):B==="text"&&(q([...D,{id:`text-${Date.now()}`,x:me.x,y:me.y,text:"Double click to edit",fontSize:20,color:"#ffffff"}]),Q.current=!1))},re=le=>{if(!Q.current)return;const me=le.target.getStage().getPointerPosition();B==="brush"||B==="eraser"?V(be=>{const Se=[...be],Ue={...Se[Se.length-1]};return Ue.points=Ue.points.concat([me.x,me.y]),Se[Se.length-1]=Ue,Se}):B==="rect"&&Y(be=>{const Se=[...be],Ue={...Se[Se.length-1]};return Ue.width=me.x-Ue.x,Ue.height=me.y-Ue.y,Se[Se.length-1]=Ue,Se})},ae=()=>{Q.current=!1};ce.useEffect(()=>{if(l(y==="editor"),y==="editor"){u("MAP");const le={showGrid:!0,gridSize:50,width:N.dims.width,height:N.dims.height};p(le),v(pe=>{pe&&P(me=>({...me,dims:{width:pe.width,height:pe.height},bgImage:pe.bgImage||me.bgImage}))})}},[y]),ce.useEffect(()=>{r==="create"&&!S&&i&&(console.log("Resolving folder ID for slug:",i),rt.get(`/world-bible/folders/${i}`).then(le=>k(le.id)).catch(le=>console.error("Could not resolve folder ID",le)))},[r,i,S]);const he=le=>{const pe=le.target.files[0];if(pe){const me=new FileReader;me.onload=be=>{const Se=new Image;Se.onload=()=>{P(Ue=>({...Ue,bgImage:be.target.result,dims:{width:Se.width,height:Se.height},sourceType:"upload"}))},Se.src=be.target.result},me.readAsDataURL(pe)}},ve=Xt.useRef(null),xe=async()=>{if(!S){alert("Folder context missing. Please start from the folder view again.");return}O(!0);try{let le=N.bgImage;if(ve.current){const be=ve.current.findOne("Transformer");if(be&&be.nodes([]),le=ve.current.toDataURL({pixelRatio:.5}),be&&G){const Se=ve.current.findOne("#"+G);Se&&be.nodes([Se])}}const pe={nombre:N.name,tipoEspecial:"map",carpetaId:S,descripcion:N.description,attributes:{type:N.type,width:N.dims.width,height:N.dims.height,bgImage:N.bgImage,layers:{lines:z,rectangles:$,texts:D},snapshotUrl:le},iconUrl:le},me=await rt.post("/world-bible/entities",pe);window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:S}})),s(`/${e}/${n}/map-editor/edit/${me.id}`,{replace:!0})}catch(le){console.error(le),alert("Error creating map. Check console.")}finally{O(!1)}},se=Xt.useRef(null);ce.useEffect(()=>{(!r||r==="edit")&&a&&rt.get(`/world-bible/entities/${a}`).then(le=>{k(le.carpetaId),se.current=le.iconUrl,b("editor");let pe=le.attributes||{},me={};const be=pe.layers||pe.bgImage;if(!be&&le.descripcion&&le.descripcion.trim().startsWith("{"))try{me=JSON.parse(le.descripcion)}catch(We){console.error("Error parsing legacy map data",We)}const Se=be?pe:me;let Ue=le.descripcion;le.descripcion&&le.descripcion.trim().startsWith("{")&&(Ue=me.description||""),P({name:le.nombre,description:Ue||"",parentZone:null,type:Se.type||"regional",sourceType:Se.bgImage?"upload":"blank",dims:{width:Se.width||800,height:Se.height||600},bgImage:Se.bgImage}),Se.layers&&(V(Se.layers.lines||[]),Y(Se.layers.rectangles||[]),q(Se.layers.texts||[])),p({name:le.nombre,description:Ue||"",type:Se.type||"regional",showGrid:!0,gridSize:50,width:Se.width||800,height:Se.height||600,bgImage:Se.bgImage})}).catch(le=>console.error("Error loading entity",le))},[r,a]);const ge=async()=>{O(!0);try{let le=N.bgImage;if(ve.current){Z(null);const me=ve.current.findOne("Transformer");me&&me.nodes([]),le=ve.current.toDataURL({pixelRatio:.5})}const pe={id:a,nombre:N.name,tipoEspecial:"map",carpetaId:S,descripcion:N.description,attributes:{type:N.type,width:N.dims.width,height:N.dims.height,bgImage:N.bgImage,layers:{lines:z,rectangles:$,texts:D},snapshotUrl:le},iconUrl:se.current};await rt.put(`/world-bible/entities/${a}`,pe),s(S?`/${e}/${n}/bible/folder/${S}`:`/${e}/${n}/bible`)}catch(le){console.error("Save failed",le),alert("Error saving map")}finally{O(!1)}};return y==="setup"?m.jsxs("div",{className:"flex-1 flex flex-col h-screen bg-[#060608] text-white",children:[m.jsxs("div",{className:"h-16 border-b border-white/5 flex items-center justify-between px-8 bg-[#0a0a0c]",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"p-2 bg-primary/20 rounded-lg text-primary",children:m.jsx("span",{className:"material-symbols-outlined",children:"add_circle"})}),m.jsxs("div",{children:[m.jsx("h1",{className:"text-lg font-bold leading-tight",children:"Create New Map / Zone"}),m.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-bold tracking-wider",children:"Configure details for your new cartography entry"})]})]}),m.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-white/5 rounded-full text-slate-500 hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),m.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-8",children:m.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[m.jsx(Nw,{stepNumber:"1",title:"Identity & Hierarchy",isOpen:T===1,onClick:()=>C(1),children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Map Name"}),m.jsx("input",{autoFocus:!0,value:N.name,onChange:le=>P({...N,name:le.target.value}),className:"w-full bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-white focus:border-primary outline-none transition-colors",placeholder:"e.g. The Sapphire Coast"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Parent Zone (Optional)"}),m.jsxs("div",{className:"w-full bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-slate-400 flex items-center justify-between cursor-pointer hover:border-white/20",children:[m.jsx("span",{children:"Current Folder (Default)"}),m.jsx("span",{className:"material-symbols-outlined text-sm",children:"expand_more"})]}),m.jsx("p",{className:"text-[10px] text-slate-600 mt-2",children:"Selecting a parent makes this a sub-zone."})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Description"}),m.jsx("textarea",{value:N.description,onChange:le=>P({...N,description:le.target.value}),className:"w-full h-40 bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-white resize-none focus:border-primary outline-none transition-colors leading-relaxed",placeholder:"Brief description of geography, climate, or importance..."})]})]})}),m.jsx(Nw,{stepNumber:"2",title:"Map Type",isOpen:T===2,onClick:()=>C(2),children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsx(Tw,{icon:"public",title:"World Map",desc:"Continents, oceans, global scale.",selected:N.type==="world",onClick:()=>P({...N,type:"world"})}),m.jsx(Tw,{icon:"map",title:"Regional Map",desc:"Kingdoms, provinces, biomes.",selected:N.type==="regional",onClick:()=>P({...N,type:"regional"})}),m.jsx(Tw,{icon:"location_city",title:"City / Local",desc:"Cities, dungeons, battlemaps.",selected:N.type==="local",onClick:()=>P({...N,type:"local"})})]})}),m.jsx(Nw,{stepNumber:"3",title:"Canvas Source",isOpen:T===3,onClick:()=>C(3),children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m.jsxs("div",{onClick:()=>document.getElementById("map-upload-input").click(),className:`relative p-8 rounded-xl border-2 border-dashed flex flex-col items-center justify-center text-center cursor-pointer transition-all group min-h-[200px] ${N.sourceType==="upload"?"border-primary bg-primary/5":"border-white/10 hover:border-white/30 bg-[#0a0a0c]"}`,children:[m.jsx("input",{id:"map-upload-input",type:"file",accept:"image/*",className:"hidden",onChange:he}),N.bgImage?m.jsx("img",{src:N.bgImage,alt:"Preview",className:"absolute inset-0 w-full h-full object-cover rounded-xl opacity-50 group-hover:opacity-70"}):m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"size-16 bg-white/5 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:m.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"cloud_upload"})}),m.jsx("h4",{className:"font-bold text-white",children:"Upload Image File"}),m.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Drag & drop or click to browse"}),m.jsx("p",{className:"text-[10px] text-slate-600 mt-1 uppercase font-bold",children:"JPG, PNG, WEBP  Max 20MB"})]}),N.sourceType==="upload"&&m.jsx("div",{className:"absolute top-4 right-4 size-3 bg-primary rounded-full shadow-glow z-10"})]}),m.jsxs("div",{onClick:()=>P({...N,sourceType:"blank",bgImage:null}),className:`p-8 rounded-xl border flex flex-col items-center justify-center text-center cursor-pointer transition-all min-h-[200px] ${N.sourceType==="blank"?"border-primary bg-primary/5":"border-white/10 hover:border-white/30 bg-[#0a0a0c]"}`,children:[m.jsx("div",{className:"size-16 bg-white/5 rounded-full flex items-center justify-center mb-4",children:m.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"check_box_outline_blank"})}),m.jsx("h4",{className:"font-bold text-white",children:"Blank Canvas"}),m.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Start a new drawing from scratch"}),N.sourceType==="blank"&&m.jsxs("div",{className:"mt-6 flex items-center gap-2 bg-black/50 p-1 rounded-lg border border-white/10",children:[m.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 px-2",children:"Size"}),m.jsx("span",{className:"text-xs font-mono text-white",children:"4096 px"}),m.jsx("span",{className:"text-xs text-slate-500",children:"x"}),m.jsx("span",{className:"text-xs font-mono text-white",children:"4096 px"})]})]})]})})]})}),m.jsxs("div",{className:"h-20 border-t border-white/5 bg-[#0a0a0c] flex items-center justify-between px-8 z-20",children:[m.jsx("button",{onClick:()=>s(-1),className:"text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"Cancel"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("span",{className:"text-xs text-slate-600 italic",children:"Changes saved locally"}),m.jsx(nn,{variant:"primary",size:"lg",icon:"check",onClick:xe,disabled:!N.name||R,className:"bg-primary hover:bg-primary-light text-white shadow-lg shadow-primary/25 px-8",children:R?"Creating...":"Create Map"})]})]})]}):m.jsxs("div",{className:"flex flex-col h-screen w-full bg-[#0f0f13] text-white overflow-hidden",children:[m.jsxs("header",{className:"h-14 border-b border-white/5 flex items-center justify-between px-4 bg-[#1a1a20] shrink-0",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-white/5 rounded-full",title:"Back to Collection",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"})}),m.jsxs("div",{className:"flex flex-col",children:[m.jsx("input",{value:N.name,onChange:le=>P({...N,name:le.target.value}),className:"bg-transparent font-bold text-sm outline-none focus:bg-white/5 rounded px-2 -ml-2"}),m.jsxs("span",{className:"text-[10px] text-text-muted px-2",children:[N.dims.width," x ",N.dims.height,"  ",d?.gridSize||50,"px Grid"]})]})]}),m.jsx("div",{className:"flex items-center gap-2",children:m.jsx(nn,{variant:"primary",size:"sm",icon:"save",onClick:ge,disabled:R,children:R?"Saving...":"Save Changes"})})]}),m.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[m.jsx("div",{className:"w-14 bg-[#1a1a20] border-r border-white/5 flex flex-col items-center py-4 gap-4 z-10",children:[{id:"select",icon:"near_me"},{id:"brush",icon:"brush"},{id:"eraser",icon:"ink_eraser"},{id:"rect",icon:"check_box_outline_blank"},{id:"text",icon:"title"}].map(le=>m.jsx("button",{onClick:()=>I(le.id),className:`p-2 rounded-lg transition-colors ${B===le.id?"bg-primary text-white shadow-lg shadow-primary/30":"hover:bg-white/5 text-slate-400 hover:text-white"}`,children:m.jsx("span",{className:"material-symbols-outlined",children:le.icon})},le.id))}),m.jsx("div",{className:"flex-1 overflow-auto bg-[#0f0f13] relative flex items-center justify-center p-8 custom-scrollbar",children:m.jsx("div",{className:"bg-[#1a1a20] shadow-[0_0_50px_rgba(0,0,0,0.5)] flex-none",children:m.jsxs(_V,{ref:ve,width:N.dims.width,height:N.dims.height,onMouseDown:W,onMouseMove:re,onMouseUp:ae,className:"bg-white",children:[m.jsxs(Z5,{children:[N.bgImage&&m.jsx(kV,{src:N.bgImage,x:0,y:0,width:N.dims.width,height:N.dims.height,onMouseDown:W,onTouchStart:W}),d?.showGrid&&m.jsx(Y5,{width:N.dims.width,height:N.dims.height,fillPatternImage:(()=>{const le=document.createElement("canvas");le.width=d.gridSize||50,le.height=d.gridSize||50;const pe=le.getContext("2d");return pe.strokeStyle="rgba(0,0,0,0.2)",pe.lineWidth=1,pe.strokeRect(0,0,le.width,le.height),le})(),listening:!1})]}),m.jsxs(Z5,{children:[z.map((le,pe)=>m.jsx(yV,{points:le.points,stroke:le.color,strokeWidth:le.size,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:le.tool==="eraser"?"destination-out":"source-over"},pe)),$.map((le,pe)=>m.jsx(Y5,{id:le.id,x:le.x,y:le.y,width:le.width,height:le.height,stroke:le.color,strokeWidth:2,draggable:B==="select",onClick:()=>B==="select"&&Z(le.id),onTap:()=>B==="select"&&Z(le.id)},le.id)),D.map((le,pe)=>m.jsx(bV,{id:le.id,x:le.x,y:le.y,text:le.text,fontSize:le.fontSize,fill:le.color,draggable:B==="select",onClick:()=>B==="select"&&Z(le.id),onTap:()=>B==="select"&&Z(le.id),onDblClick:me=>{ie({isOpen:!0,id:le.id,text:le.text})}},le.id)),m.jsx(CV,{selectedId:G})]})]})})})]}),m.jsx(SV,{isOpen:J.isOpen,onClose:()=>ie(le=>({...le,isOpen:!1})),title:"Edit Map Text",initialValue:J.text,onConfirm:le=>{q(pe=>pe.map(me=>me.id===J.id?{...me,text:le}:me))},confirmText:"Save Text"})]})};function CM(r,e){const n=ce.useRef(e);ce.useEffect(function(){e!==n.current&&r.attributionControl!=null&&(n.current!=null&&r.attributionControl.removeAttribution(n.current),e!=null&&r.attributionControl.addAttribution(e)),n.current=e},[r,e])}const EV=1;function NV(r){return Object.freeze({__version:EV,map:r})}function EM(r,e){return Object.freeze({...r,...e})}const NM=ce.createContext(null),TM=NM.Provider;function iS(){const r=ce.useContext(NM);if(r==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return r}function TV(r){function e(n,i){const{instance:a,context:s}=r(n).current;return ce.useImperativeHandle(i,()=>a),n.children==null?null:Xt.createElement(TM,{value:s},n.children)}return ce.forwardRef(e)}function PV(r){function e(n,i){const[a,s]=ce.useState(!1),{instance:o}=r(n,s).current;ce.useImperativeHandle(i,()=>o),ce.useEffect(function(){a&&o.update()},[o,a,n.children]);const l=o._contentNode;return l?iu.createPortal(n.children,l):null}return ce.forwardRef(e)}function PM(r,e){const n=ce.useRef();ce.useEffect(function(){return e!=null&&r.instance.on(e),n.current=e,function(){n.current!=null&&r.instance.off(n.current),n.current=null}},[r,e])}function MM(r,e){const n=r.pane??e.pane;return n?{...r,pane:n}:r}function MV(r,e){return function(i,a){const s=iS(),o=r(MM(i,s),s);return CM(s.map,i.attribution),PM(o.current,i.eventHandlers),e(o.current,s,i,a),o}}var dg={exports:{}};var AV=dg.exports,X5;function jV(){return X5||(X5=1,(function(r,e){(function(n,i){i(e)})(AV,(function(n){var i="1.9.4";function a(f){var _,M,U,ee;for(M=1,U=arguments.length;M<U;M++){ee=arguments[M];for(_ in ee)f[_]=ee[_]}return f}var s=Object.create||(function(){function f(){}return function(_){return f.prototype=_,new f}})();function o(f,_){var M=Array.prototype.slice;if(f.bind)return f.bind.apply(f,M.call(arguments,1));var U=M.call(arguments,2);return function(){return f.apply(_,U.length?U.concat(M.call(arguments)):arguments)}}var l=0;function u(f){return"_leaflet_id"in f||(f._leaflet_id=++l),f._leaflet_id}function c(f,_,M){var U,ee,ue,_e;return _e=function(){U=!1,ee&&(ue.apply(M,ee),ee=!1)},ue=function(){U?ee=arguments:(f.apply(M,arguments),setTimeout(_e,_),U=!0)},ue}function d(f,_,M){var U=_[1],ee=_[0],ue=U-ee;return f===U&&M?f:((f-ee)%ue+ue)%ue+ee}function p(){return!1}function v(f,_){if(_===!1)return f;var M=Math.pow(10,_===void 0?6:_);return Math.round(f*M)/M}function y(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function b(f){return y(f).split(/\s+/)}function S(f,_){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?s(f.options):{});for(var M in _)f.options[M]=_[M];return f.options}function k(f,_,M){var U=[];for(var ee in f)U.push(encodeURIComponent(M?ee.toUpperCase():ee)+"="+encodeURIComponent(f[ee]));return(!_||_.indexOf("?")===-1?"?":"&")+U.join("&")}var T=/\{ *([\w_ -]+) *\}/g;function C(f,_){return f.replace(T,function(M,U){var ee=_[U];if(ee===void 0)throw new Error("No value provided for variable "+M);return typeof ee=="function"&&(ee=ee(_)),ee})}var N=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function P(f,_){for(var M=0;M<f.length;M++)if(f[M]===_)return M;return-1}var R="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function O(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var B=0;function I(f){var _=+new Date,M=Math.max(0,16-(_-B));return B=_+M,window.setTimeout(f,M)}var z=window.requestAnimationFrame||O("RequestAnimationFrame")||I,V=window.cancelAnimationFrame||O("CancelAnimationFrame")||O("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function $(f,_,M){if(M&&z===I)f.call(_);else return z.call(window,o(f,_))}function Y(f){f&&V.call(window,f)}var D={__proto__:null,extend:a,create:s,bind:o,get lastId(){return l},stamp:u,throttle:c,wrapNum:d,falseFn:p,formatNum:v,trim:y,splitWords:b,setOptions:S,getParamString:k,template:C,isArray:N,indexOf:P,emptyImageUrl:R,requestFn:z,cancelFn:V,requestAnimFrame:$,cancelAnimFrame:Y};function q(){}q.extend=function(f){var _=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},M=_.__super__=this.prototype,U=s(M);U.constructor=_,_.prototype=U;for(var ee in this)Object.prototype.hasOwnProperty.call(this,ee)&&ee!=="prototype"&&ee!=="__super__"&&(_[ee]=this[ee]);return f.statics&&a(_,f.statics),f.includes&&(G(f.includes),a.apply(null,[U].concat(f.includes))),a(U,f),delete U.statics,delete U.includes,U.options&&(U.options=M.options?s(M.options):{},a(U.options,f.options)),U._initHooks=[],U.callInitHooks=function(){if(!this._initHooksCalled){M.callInitHooks&&M.callInitHooks.call(this),this._initHooksCalled=!0;for(var ue=0,_e=U._initHooks.length;ue<_e;ue++)U._initHooks[ue].call(this)}},_},q.include=function(f){var _=this.prototype.options;return a(this.prototype,f),f.options&&(this.prototype.options=_,this.mergeOptions(f.options)),this},q.mergeOptions=function(f){return a(this.prototype.options,f),this},q.addInitHook=function(f){var _=Array.prototype.slice.call(arguments,1),M=typeof f=="function"?f:function(){this[f].apply(this,_)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(M),this};function G(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=N(f)?f:[f];for(var _=0;_<f.length;_++)f[_]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Z={on:function(f,_,M){if(typeof f=="object")for(var U in f)this._on(U,f[U],_);else{f=b(f);for(var ee=0,ue=f.length;ee<ue;ee++)this._on(f[ee],_,M)}return this},off:function(f,_,M){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var U in f)this._off(U,f[U],_);else{f=b(f);for(var ee=arguments.length===1,ue=0,_e=f.length;ue<_e;ue++)ee?this._off(f[ue]):this._off(f[ue],_,M)}return this},_on:function(f,_,M,U){if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}if(this._listens(f,_,M)===!1){M===this&&(M=void 0);var ee={fn:_,ctx:M};U&&(ee.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(ee)}},_off:function(f,_,M){var U,ee,ue;if(this._events&&(U=this._events[f],!!U)){if(arguments.length===1){if(this._firingCount)for(ee=0,ue=U.length;ee<ue;ee++)U[ee].fn=p;delete this._events[f];return}if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}var _e=this._listens(f,_,M);if(_e!==!1){var Ae=U[_e];this._firingCount&&(Ae.fn=p,this._events[f]=U=U.slice()),U.splice(_e,1)}}},fire:function(f,_,M){if(!this.listens(f,M))return this;var U=a({},_,{type:f,target:this,sourceTarget:_&&_.sourceTarget||this});if(this._events){var ee=this._events[f];if(ee){this._firingCount=this._firingCount+1||1;for(var ue=0,_e=ee.length;ue<_e;ue++){var Ae=ee[ue],De=Ae.fn;Ae.once&&this.off(f,De,Ae.ctx),De.call(Ae.ctx||this,U)}this._firingCount--}}return M&&this._propagateEvent(U),this},listens:function(f,_,M,U){typeof f!="string"&&console.warn('"string" type argument expected');var ee=_;typeof _!="function"&&(U=!!_,ee=void 0,M=void 0);var ue=this._events&&this._events[f];if(ue&&ue.length&&this._listens(f,ee,M)!==!1)return!0;if(U){for(var _e in this._eventParents)if(this._eventParents[_e].listens(f,_,M,U))return!0}return!1},_listens:function(f,_,M){if(!this._events)return!1;var U=this._events[f]||[];if(!_)return!!U.length;M===this&&(M=void 0);for(var ee=0,ue=U.length;ee<ue;ee++)if(U[ee].fn===_&&U[ee].ctx===M)return ee;return!1},once:function(f,_,M){if(typeof f=="object")for(var U in f)this._on(U,f[U],_,!0);else{f=b(f);for(var ee=0,ue=f.length;ee<ue;ee++)this._on(f[ee],_,M,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[u(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[u(f)],this},_propagateEvent:function(f){for(var _ in this._eventParents)this._eventParents[_].fire(f.type,a({layer:f.target,propagatedFrom:f.target},f),!0)}};Z.addEventListener=Z.on,Z.removeEventListener=Z.clearAllEventListeners=Z.off,Z.addOneTimeEventListener=Z.once,Z.fireEvent=Z.fire,Z.hasEventListeners=Z.listens;var Q=q.extend(Z);function J(f,_,M){this.x=M?Math.round(f):f,this.y=M?Math.round(_):_}var ie=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};J.prototype={clone:function(){return new J(this.x,this.y)},add:function(f){return this.clone()._add(ne(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(ne(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new J(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new J(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ie(this.x),this.y=ie(this.y),this},distanceTo:function(f){f=ne(f);var _=f.x-this.x,M=f.y-this.y;return Math.sqrt(_*_+M*M)},equals:function(f){return f=ne(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=ne(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+v(this.x)+", "+v(this.y)+")"}};function ne(f,_,M){return f instanceof J?f:N(f)?new J(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new J(f.x,f.y):new J(f,_,M)}function W(f,_){if(f)for(var M=_?[f,_]:f,U=0,ee=M.length;U<ee;U++)this.extend(M[U])}W.prototype={extend:function(f){var _,M;if(!f)return this;if(f instanceof J||typeof f[0]=="number"||"x"in f)_=M=ne(f);else if(f=re(f),_=f.min,M=f.max,!_||!M)return this;return!this.min&&!this.max?(this.min=_.clone(),this.max=M.clone()):(this.min.x=Math.min(_.x,this.min.x),this.max.x=Math.max(M.x,this.max.x),this.min.y=Math.min(_.y,this.min.y),this.max.y=Math.max(M.y,this.max.y)),this},getCenter:function(f){return ne((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return ne(this.min.x,this.max.y)},getTopRight:function(){return ne(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var _,M;return typeof f[0]=="number"||f instanceof J?f=ne(f):f=re(f),f instanceof W?(_=f.min,M=f.max):_=M=f,_.x>=this.min.x&&M.x<=this.max.x&&_.y>=this.min.y&&M.y<=this.max.y},intersects:function(f){f=re(f);var _=this.min,M=this.max,U=f.min,ee=f.max,ue=ee.x>=_.x&&U.x<=M.x,_e=ee.y>=_.y&&U.y<=M.y;return ue&&_e},overlaps:function(f){f=re(f);var _=this.min,M=this.max,U=f.min,ee=f.max,ue=ee.x>_.x&&U.x<M.x,_e=ee.y>_.y&&U.y<M.y;return ue&&_e},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var _=this.min,M=this.max,U=Math.abs(_.x-M.x)*f,ee=Math.abs(_.y-M.y)*f;return re(ne(_.x-U,_.y-ee),ne(M.x+U,M.y+ee))},equals:function(f){return f?(f=re(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function re(f,_){return!f||f instanceof W?f:new W(f,_)}function ae(f,_){if(f)for(var M=_?[f,_]:f,U=0,ee=M.length;U<ee;U++)this.extend(M[U])}ae.prototype={extend:function(f){var _=this._southWest,M=this._northEast,U,ee;if(f instanceof ve)U=f,ee=f;else if(f instanceof ae){if(U=f._southWest,ee=f._northEast,!U||!ee)return this}else return f?this.extend(xe(f)||he(f)):this;return!_&&!M?(this._southWest=new ve(U.lat,U.lng),this._northEast=new ve(ee.lat,ee.lng)):(_.lat=Math.min(U.lat,_.lat),_.lng=Math.min(U.lng,_.lng),M.lat=Math.max(ee.lat,M.lat),M.lng=Math.max(ee.lng,M.lng)),this},pad:function(f){var _=this._southWest,M=this._northEast,U=Math.abs(_.lat-M.lat)*f,ee=Math.abs(_.lng-M.lng)*f;return new ae(new ve(_.lat-U,_.lng-ee),new ve(M.lat+U,M.lng+ee))},getCenter:function(){return new ve((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ve(this.getNorth(),this.getWest())},getSouthEast:function(){return new ve(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof ve||"lat"in f?f=xe(f):f=he(f);var _=this._southWest,M=this._northEast,U,ee;return f instanceof ae?(U=f.getSouthWest(),ee=f.getNorthEast()):U=ee=f,U.lat>=_.lat&&ee.lat<=M.lat&&U.lng>=_.lng&&ee.lng<=M.lng},intersects:function(f){f=he(f);var _=this._southWest,M=this._northEast,U=f.getSouthWest(),ee=f.getNorthEast(),ue=ee.lat>=_.lat&&U.lat<=M.lat,_e=ee.lng>=_.lng&&U.lng<=M.lng;return ue&&_e},overlaps:function(f){f=he(f);var _=this._southWest,M=this._northEast,U=f.getSouthWest(),ee=f.getNorthEast(),ue=ee.lat>_.lat&&U.lat<M.lat,_e=ee.lng>_.lng&&U.lng<M.lng;return ue&&_e},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,_){return f?(f=he(f),this._southWest.equals(f.getSouthWest(),_)&&this._northEast.equals(f.getNorthEast(),_)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function he(f,_){return f instanceof ae?f:new ae(f,_)}function ve(f,_,M){if(isNaN(f)||isNaN(_))throw new Error("Invalid LatLng object: ("+f+", "+_+")");this.lat=+f,this.lng=+_,M!==void 0&&(this.alt=+M)}ve.prototype={equals:function(f,_){if(!f)return!1;f=xe(f);var M=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return M<=(_===void 0?1e-9:_)},toString:function(f){return"LatLng("+v(this.lat,f)+", "+v(this.lng,f)+")"},distanceTo:function(f){return ge.distance(this,xe(f))},wrap:function(){return ge.wrapLatLng(this)},toBounds:function(f){var _=180*f/40075017,M=_/Math.cos(Math.PI/180*this.lat);return he([this.lat-_,this.lng-M],[this.lat+_,this.lng+M])},clone:function(){return new ve(this.lat,this.lng,this.alt)}};function xe(f,_,M){return f instanceof ve?f:N(f)&&typeof f[0]!="object"?f.length===3?new ve(f[0],f[1],f[2]):f.length===2?new ve(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new ve(f.lat,"lng"in f?f.lng:f.lon,f.alt):_===void 0?null:new ve(f,_,M)}var se={latLngToPoint:function(f,_){var M=this.projection.project(f),U=this.scale(_);return this.transformation._transform(M,U)},pointToLatLng:function(f,_){var M=this.scale(_),U=this.transformation.untransform(f,M);return this.projection.unproject(U)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var _=this.projection.bounds,M=this.scale(f),U=this.transformation.transform(_.min,M),ee=this.transformation.transform(_.max,M);return new W(U,ee)},infinite:!1,wrapLatLng:function(f){var _=this.wrapLng?d(f.lng,this.wrapLng,!0):f.lng,M=this.wrapLat?d(f.lat,this.wrapLat,!0):f.lat,U=f.alt;return new ve(M,_,U)},wrapLatLngBounds:function(f){var _=f.getCenter(),M=this.wrapLatLng(_),U=_.lat-M.lat,ee=_.lng-M.lng;if(U===0&&ee===0)return f;var ue=f.getSouthWest(),_e=f.getNorthEast(),Ae=new ve(ue.lat-U,ue.lng-ee),De=new ve(_e.lat-U,_e.lng-ee);return new ae(Ae,De)}},ge=a({},se,{wrapLng:[-180,180],R:6371e3,distance:function(f,_){var M=Math.PI/180,U=f.lat*M,ee=_.lat*M,ue=Math.sin((_.lat-f.lat)*M/2),_e=Math.sin((_.lng-f.lng)*M/2),Ae=ue*ue+Math.cos(U)*Math.cos(ee)*_e*_e,De=2*Math.atan2(Math.sqrt(Ae),Math.sqrt(1-Ae));return this.R*De}}),le=6378137,pe={R:le,MAX_LATITUDE:85.0511287798,project:function(f){var _=Math.PI/180,M=this.MAX_LATITUDE,U=Math.max(Math.min(M,f.lat),-M),ee=Math.sin(U*_);return new J(this.R*f.lng*_,this.R*Math.log((1+ee)/(1-ee))/2)},unproject:function(f){var _=180/Math.PI;return new ve((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*_,f.x*_/this.R)},bounds:(function(){var f=le*Math.PI;return new W([-f,-f],[f,f])})()};function me(f,_,M,U){if(N(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=_,this._c=M,this._d=U}me.prototype={transform:function(f,_){return this._transform(f.clone(),_)},_transform:function(f,_){return _=_||1,f.x=_*(this._a*f.x+this._b),f.y=_*(this._c*f.y+this._d),f},untransform:function(f,_){return _=_||1,new J((f.x/_-this._b)/this._a,(f.y/_-this._d)/this._c)}};function be(f,_,M,U){return new me(f,_,M,U)}var Se=a({},ge,{code:"EPSG:3857",projection:pe,transformation:(function(){var f=.5/(Math.PI*pe.R);return be(f,.5,-f,.5)})()}),Ue=a({},Se,{code:"EPSG:900913"});function We(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function gt(f,_){var M="",U,ee,ue,_e,Ae,De;for(U=0,ue=f.length;U<ue;U++){for(Ae=f[U],ee=0,_e=Ae.length;ee<_e;ee++)De=Ae[ee],M+=(ee?"L":"M")+De.x+" "+De.y;M+=_?bt.svg?"z":"x":""}return M||"M0 0"}var Je=document.documentElement.style,at="ActiveXObject"in window,Ve=at&&!document.addEventListener,Oe="msLaunchUri"in navigator&&!("documentMode"in document),et=cr("webkit"),Ne=cr("android"),ze=cr("android 2")||cr("android 3"),Ke=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ft=Ne&&cr("Google")&&Ke<537&&!("AudioNode"in window),yt=!!window.opera,Et=!Oe&&cr("chrome"),Rt=cr("gecko")&&!et&&!yt&&!at,$t=!Et&&cr("safari"),wt=cr("phantom"),ot="OTransition"in Je,qe=navigator.platform.indexOf("Win")===0,de=at&&"transition"in Je,ye="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ze,Ce="MozPerspective"in Je,Te=!window.L_DISABLE_3D&&(de||ye||Ce)&&!ot&&!wt,Re=typeof orientation<"u"||cr("mobile"),Ze=Re&&et,Ge=Re&&ye,ct=!window.PointerEvent&&window.MSPointerEvent,ut=!!(window.PointerEvent||ct),kt="ontouchstart"in window||!!window.TouchEvent,zt=!window.L_NO_TOUCH&&(kt||ut),Ft=Re&&yt,xt=Re&&Rt,Gt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Wt=(function(){var f=!1;try{var _=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",p,_),window.removeEventListener("testPassiveEventSupport",p,_)}catch{}return f})(),kr=(function(){return!!document.createElement("canvas").getContext})(),pr=!!(document.createElementNS&&We("svg").createSVGRect),pn=!!pr&&(function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),qr=!pr&&(function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var _=f.firstChild;return _.style.behavior="url(#default#VML)",_&&typeof _.adj=="object"}catch{return!1}})(),Wr=navigator.platform.indexOf("Mac")===0,an=navigator.platform.indexOf("Linux")===0;function cr(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var bt={ie:at,ielt9:Ve,edge:Oe,webkit:et,android:Ne,android23:ze,androidStock:ft,opera:yt,chrome:Et,gecko:Rt,safari:$t,phantom:wt,opera12:ot,win:qe,ie3d:de,webkit3d:ye,gecko3d:Ce,any3d:Te,mobile:Re,mobileWebkit:Ze,mobileWebkit3d:Ge,msPointer:ct,pointer:ut,touch:zt,touchNative:kt,mobileOpera:Ft,mobileGecko:xt,retina:Gt,passiveEvents:Wt,canvas:kr,svg:pr,vml:qr,inlineSvg:pn,mac:Wr,linux:an},Or=bt.msPointer?"MSPointerDown":"pointerdown",Xn=bt.msPointer?"MSPointerMove":"pointermove",Ma=bt.msPointer?"MSPointerUp":"pointerup",Is=bt.msPointer?"MSPointerCancel":"pointercancel",eo={touchstart:Or,touchmove:Xn,touchend:Ma,touchcancel:Is},ci={touchstart:Qr,touchmove:pl,touchend:pl,touchcancel:pl},sn={},bn=!1;function di(f,_,M){return _==="touchstart"&&zd(),ci[_]?(M=ci[_].bind(this,M),f.addEventListener(eo[_],M,!1),M):(console.warn("wrong event specified:",_),p)}function to(f,_,M){if(!eo[_]){console.warn("wrong event specified:",_);return}f.removeEventListener(eo[_],M,!1)}function _i(f){sn[f.pointerId]=f}function lu(f){sn[f.pointerId]&&(sn[f.pointerId]=f)}function uu(f){delete sn[f.pointerId]}function zd(){bn||(document.addEventListener(Or,_i,!0),document.addEventListener(Xn,lu,!0),document.addEventListener(Ma,uu,!0),document.addEventListener(Is,uu,!0),bn=!0)}function pl(f,_){if(_.pointerType!==(_.MSPOINTER_TYPE_MOUSE||"mouse")){_.touches=[];for(var M in sn)_.touches.push(sn[M]);_.changedTouches=[_],f(_)}}function Qr(f,_){_.MSPOINTER_TYPE_TOUCH&&_.pointerType===_.MSPOINTER_TYPE_TOUCH&&$r(_),pl(f,_)}function cu(f){var _={},M,U;for(U in f)M=f[U],_[U]=M&&M.bind?M.bind(f):M;return f=_,_.type="dblclick",_.detail=2,_.isTrusted=!1,_._simulated=!0,_}var Bs=200;function ml(f,_){f.addEventListener("dblclick",_);var M=0,U;function ee(ue){if(ue.detail!==1){U=ue.detail;return}if(!(ue.pointerType==="mouse"||ue.sourceCapabilities&&!ue.sourceCapabilities.firesTouchEvents)){var _e=Bo(ue);if(!(_e.some(function(De){return De instanceof HTMLLabelElement&&De.attributes.for})&&!_e.some(function(De){return De instanceof HTMLInputElement||De instanceof HTMLSelectElement}))){var Ae=Date.now();Ae-M<=Bs?(U++,U===2&&_(cu(ue))):U=1,M=Ae}}}return f.addEventListener("click",ee),{dblclick:_,simDblclick:ee}}function Aa(f,_){f.removeEventListener("dblclick",_.dblclick),f.removeEventListener("click",_.simDblclick)}var Oo=hi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ra=hi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),na=ra==="webkitTransition"||ra==="OTransition"?ra+"End":"transitionend";function mn(f){return typeof f=="string"?document.getElementById(f):f}function yr(f,_){var M=f.style[_]||f.currentStyle&&f.currentStyle[_];if((!M||M==="auto")&&document.defaultView){var U=document.defaultView.getComputedStyle(f,null);M=U?U[_]:null}return M==="auto"?null:M}function lt(f,_,M){var U=document.createElement(f);return U.className=_||"",M&&M.appendChild(U),U}function dr(f){var _=f.parentNode;_&&_.removeChild(f)}function on(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function Fr(f){var _=f.parentNode;_&&_.lastChild!==f&&_.appendChild(f)}function Tr(f){var _=f.parentNode;_&&_.firstChild!==f&&_.insertBefore(f,_.firstChild)}function ia(f,_){if(f.classList!==void 0)return f.classList.contains(_);var M=du(f);return M.length>0&&new RegExp("(^|\\s)"+_+"(\\s|$)").test(M)}function Mt(f,_){if(f.classList!==void 0)for(var M=b(_),U=0,ee=M.length;U<ee;U++)f.classList.add(M[U]);else if(!ia(f,_)){var ue=du(f);tc(f,(ue?ue+" ":"")+_)}}function xr(f,_){f.classList!==void 0?f.classList.remove(_):tc(f,y((" "+du(f)+" ").replace(" "+_+" "," ")))}function tc(f,_){f.className.baseVal===void 0?f.className=_:f.className.baseVal=_}function du(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function Qn(f,_){"opacity"in f.style?f.style.opacity=_:"filter"in f.style&&Fd(f,_)}function Fd(f,_){var M=!1,U="DXImageTransform.Microsoft.Alpha";try{M=f.filters.item(U)}catch{if(_===1)return}_=Math.round(_*100),M?(M.Enabled=_!==100,M.Opacity=_):f.style.filter+=" progid:"+U+"(opacity="+_+")"}function hi(f){for(var _=document.documentElement.style,M=0;M<f.length;M++)if(f[M]in _)return f[M];return!1}function Za(f,_,M){var U=_||new J(0,0);f.style[Oo]=(bt.ie3d?"translate("+U.x+"px,"+U.y+"px)":"translate3d("+U.x+"px,"+U.y+"px,0)")+(M?" scale("+M+")":"")}function wn(f,_){f._leaflet_pos=_,bt.any3d?Za(f,_):(f.style.left=_.x+"px",f.style.top=_.y+"px")}function zs(f){return f._leaflet_pos||new J(0,0)}var nr,Fs,ro;if("onselectstart"in document)nr=function(){qt(window,"selectstart",$r)},Fs=function(){Pr(window,"selectstart",$r)};else{var ps=hi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);nr=function(){if(ps){var f=document.documentElement.style;ro=f[ps],f[ps]="none"}},Fs=function(){ps&&(document.documentElement.style[ps]=ro,ro=void 0)}}function rc(){qt(window,"dragstart",$r)}function nc(){Pr(window,"dragstart",$r)}var Do,gl;function no(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(Si(),Do=f,gl=f.style.outlineStyle,f.style.outlineStyle="none",qt(window,"keydown",Si))}function Si(){Do&&(Do.style.outlineStyle=gl,Do=void 0,gl=void 0,Pr(window,"keydown",Si))}function Vs(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function ja(f){var _=f.getBoundingClientRect();return{x:_.width/f.offsetWidth||1,y:_.height/f.offsetHeight||1,boundingClientRect:_}}var ir={__proto__:null,TRANSFORM:Oo,TRANSITION:ra,TRANSITION_END:na,get:mn,getStyle:yr,create:lt,remove:dr,empty:on,toFront:Fr,toBack:Tr,hasClass:ia,addClass:Mt,removeClass:xr,setClass:tc,getClass:du,setOpacity:Qn,testProp:hi,setTransform:Za,setPosition:wn,getPosition:zs,get disableTextSelection(){return nr},get enableTextSelection(){return Fs},disableImageDrag:rc,enableImageDrag:nc,preventOutline:no,restoreOutline:Si,getSizedParentNode:Vs,getScale:ja};function qt(f,_,M,U){if(_&&typeof _=="object")for(var ee in _)_n(f,ee,_[ee],M);else{_=b(_);for(var ue=0,_e=_.length;ue<_e;ue++)_n(f,_[ue],M,U)}return this}var Dn="_leaflet_events";function Pr(f,_,M,U){if(arguments.length===1)Vd(f),delete f[Dn];else if(_&&typeof _=="object")for(var ee in _)vl(f,ee,_[ee],M);else if(_=b(_),arguments.length===2)Vd(f,function(Ae){return P(_,Ae)!==-1});else for(var ue=0,_e=_.length;ue<_e;ue++)vl(f,_[ue],M,U);return this}function Vd(f,_){for(var M in f[Dn]){var U=M.split(/\d/)[0];(!_||_(U))&&vl(f,U,null,null,M)}}var Io={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function _n(f,_,M,U){var ee=_+u(M)+(U?"_"+u(U):"");if(f[Dn]&&f[Dn][ee])return this;var ue=function(Ae){return M.call(U||f,Ae||window.event)},_e=ue;!bt.touchNative&&bt.pointer&&_.indexOf("touch")===0?ue=di(f,_,ue):bt.touch&&_==="dblclick"?ue=ml(f,ue):"addEventListener"in f?_==="touchstart"||_==="touchmove"||_==="wheel"||_==="mousewheel"?f.addEventListener(Io[_]||_,ue,bt.passiveEvents?{passive:!1}:!1):_==="mouseenter"||_==="mouseleave"?(ue=function(Ae){Ae=Ae||window.event,io(f,Ae)&&_e(Ae)},f.addEventListener(Io[_],ue,!1)):f.addEventListener(_,_e,!1):f.attachEvent("on"+_,ue),f[Dn]=f[Dn]||{},f[Dn][ee]=ue}function vl(f,_,M,U,ee){ee=ee||_+u(M)+(U?"_"+u(U):"");var ue=f[Dn]&&f[Dn][ee];if(!ue)return this;!bt.touchNative&&bt.pointer&&_.indexOf("touch")===0?to(f,_,ue):bt.touch&&_==="dblclick"?Aa(f,ue):"removeEventListener"in f?f.removeEventListener(Io[_]||_,ue,!1):f.detachEvent("on"+_,ue),f[Dn][ee]=null}function ms(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function yl(f){return _n(f,"wheel",ms),this}function hu(f){return qt(f,"mousedown touchstart dblclick contextmenu",ms),f._leaflet_disable_click=!0,this}function $r(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function Sn(f){return $r(f),ms(f),this}function Bo(f){if(f.composedPath)return f.composedPath();for(var _=[],M=f.target;M;)_.push(M),M=M.parentNode;return _}function fu(f,_){if(!_)return new J(f.clientX,f.clientY);var M=ja(_),U=M.boundingClientRect;return new J((f.clientX-U.left)/M.x-_.clientLeft,(f.clientY-U.top)/M.y-_.clientTop)}var Ya=bt.linux&&bt.chrome?window.devicePixelRatio:bt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function gs(f){return bt.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/Ya:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function io(f,_){var M=_.relatedTarget;if(!M)return!0;try{for(;M&&M!==f;)M=M.parentNode}catch{return!1}return M!==f}var xl={__proto__:null,on:qt,off:Pr,stopPropagation:ms,disableScrollPropagation:yl,disableClickPropagation:hu,preventDefault:$r,stop:Sn,getPropagationPath:Bo,getMousePosition:fu,getWheelDelta:gs,isExternalTarget:io,addListener:qt,removeListener:Pr},pu=Q.extend({run:function(f,_,M,U){this.stop(),this._el=f,this._inProgress=!0,this._duration=M||.25,this._easeOutPower=1/Math.max(U||.5,.2),this._startPos=zs(f),this._offset=_.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=$(this._animate,this),this._step()},_step:function(f){var _=+new Date-this._startTime,M=this._duration*1e3;_<M?this._runFrame(this._easeOut(_/M),f):(this._runFrame(1),this._complete())},_runFrame:function(f,_){var M=this._startPos.add(this._offset.multiplyBy(f));_&&M._round(),wn(this._el,M),this.fire("step")},_complete:function(){Y(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),or=Q.extend({options:{crs:Se,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,_){_=S(this,_),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),_.maxBounds&&this.setMaxBounds(_.maxBounds),_.zoom!==void 0&&(this._zoom=this._limitZoom(_.zoom)),_.center&&_.zoom!==void 0&&this.setView(xe(_.center),_.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ra&&bt.any3d&&!bt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),qt(this._proxy,na,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,_,M){if(_=_===void 0?this._zoom:this._limitZoom(_),f=this._limitCenter(xe(f),_,this.options.maxBounds),M=M||{},this._stop(),this._loaded&&!M.reset&&M!==!0){M.animate!==void 0&&(M.zoom=a({animate:M.animate},M.zoom),M.pan=a({animate:M.animate,duration:M.duration},M.pan));var U=this._zoom!==_?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,_,M.zoom):this._tryAnimatedPan(f,M.pan);if(U)return clearTimeout(this._sizeTimer),this}return this._resetView(f,_,M.pan&&M.pan.noMoveStart),this},setZoom:function(f,_){return this._loaded?this.setView(this.getCenter(),f,{zoom:_}):(this._zoom=f,this)},zoomIn:function(f,_){return f=f||(bt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,_)},zoomOut:function(f,_){return f=f||(bt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,_)},setZoomAround:function(f,_,M){var U=this.getZoomScale(_),ee=this.getSize().divideBy(2),ue=f instanceof J?f:this.latLngToContainerPoint(f),_e=ue.subtract(ee).multiplyBy(1-1/U),Ae=this.containerPointToLatLng(ee.add(_e));return this.setView(Ae,_,{zoom:M})},_getBoundsCenterZoom:function(f,_){_=_||{},f=f.getBounds?f.getBounds():he(f);var M=ne(_.paddingTopLeft||_.padding||[0,0]),U=ne(_.paddingBottomRight||_.padding||[0,0]),ee=this.getBoundsZoom(f,!1,M.add(U));if(ee=typeof _.maxZoom=="number"?Math.min(_.maxZoom,ee):ee,ee===1/0)return{center:f.getCenter(),zoom:ee};var ue=U.subtract(M).divideBy(2),_e=this.project(f.getSouthWest(),ee),Ae=this.project(f.getNorthEast(),ee),De=this.unproject(_e.add(Ae).divideBy(2).add(ue),ee);return{center:De,zoom:ee}},fitBounds:function(f,_){if(f=he(f),!f.isValid())throw new Error("Bounds are not valid.");var M=this._getBoundsCenterZoom(f,_);return this.setView(M.center,M.zoom,_)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,_){return this.setView(f,this._zoom,{pan:_})},panBy:function(f,_){if(f=ne(f).round(),_=_||{},!f.x&&!f.y)return this.fire("moveend");if(_.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new pu,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),_.noMoveStart||this.fire("movestart"),_.animate!==!1){Mt(this._mapPane,"leaflet-pan-anim");var M=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,M,_.duration||.25,_.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,_,M){if(M=M||{},M.animate===!1||!bt.any3d)return this.setView(f,_,M);this._stop();var U=this.project(this.getCenter()),ee=this.project(f),ue=this.getSize(),_e=this._zoom;f=xe(f),_=_===void 0?_e:_;var Ae=Math.max(ue.x,ue.y),De=Ae*this.getZoomScale(_e,_),$e=ee.distanceTo(U)||1,pt=1.42,It=pt*pt;function Jt(br){var Yo=br?-1:1,of=br?De:Ae,lf=De*De-Ae*Ae+Yo*It*It*$e*$e,ho=2*of*It*$e,Xo=lf/ho,Tn=Math.sqrt(Xo*Xo+1)-Xo,Un=Tn<1e-9?-18:Math.log(Tn);return Un}function Ar(br){return(Math.exp(br)-Math.exp(-br))/2}function Nn(br){return(Math.exp(br)+Math.exp(-br))/2}function mi(br){return Ar(br)/Nn(br)}var Ci=Jt(0);function Ko(br){return Ae*(Nn(Ci)/Nn(Ci+pt*br))}function yc(br){return Ae*(Nn(Ci)*mi(Ci+pt*br)-Ar(Ci))/It}function ws(br){return 1-Math.pow(1-br,1.5)}var Zo=Date.now(),qs=(Jt(1)-Ci)/pt,za=M.duration?1e3*M.duration:1e3*qs*.8;function jl(){var br=(Date.now()-Zo)/za,Yo=ws(br)*qs;br<=1?(this._flyToFrame=$(jl,this),this._move(this.unproject(U.add(ee.subtract(U).multiplyBy(yc(Yo)/$e)),_e),this.getScaleZoom(Ae/Ko(Yo),_e),{flyTo:!0})):this._move(f,_)._moveEnd(!0)}return this._moveStart(!0,M.noMoveStart),jl.call(this),this},flyToBounds:function(f,_){var M=this._getBoundsCenterZoom(f,_);return this.flyTo(M.center,M.zoom,_)},setMaxBounds:function(f){return f=he(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var _=this.options.minZoom;return this.options.minZoom=f,this._loaded&&_!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var _=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&_!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,_){this._enforcingBounds=!0;var M=this.getCenter(),U=this._limitCenter(M,this._zoom,he(f));return M.equals(U)||this.panTo(U,_),this._enforcingBounds=!1,this},panInside:function(f,_){_=_||{};var M=ne(_.paddingTopLeft||_.padding||[0,0]),U=ne(_.paddingBottomRight||_.padding||[0,0]),ee=this.project(this.getCenter()),ue=this.project(f),_e=this.getPixelBounds(),Ae=re([_e.min.add(M),_e.max.subtract(U)]),De=Ae.getSize();if(!Ae.contains(ue)){this._enforcingBounds=!0;var $e=ue.subtract(Ae.getCenter()),pt=Ae.extend(ue).getSize().subtract(De);ee.x+=$e.x<0?-pt.x:pt.x,ee.y+=$e.y<0?-pt.y:pt.y,this.panTo(this.unproject(ee),_),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=a({animate:!1,pan:!0},f===!0?{animate:!0}:f);var _=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var M=this.getSize(),U=_.divideBy(2).round(),ee=M.divideBy(2).round(),ue=U.subtract(ee);return!ue.x&&!ue.y?this:(f.animate&&f.pan?this.panBy(ue):(f.pan&&this._rawPanBy(ue),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:_,newSize:M}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=a({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var _=o(this._handleGeolocationResponse,this),M=o(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(_,M,f):navigator.geolocation.getCurrentPosition(_,M,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var _=f.code,M=f.message||(_===1?"permission denied":_===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:_,message:"Geolocation error: "+M+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var _=f.coords.latitude,M=f.coords.longitude,U=new ve(_,M),ee=U.toBounds(f.coords.accuracy*2),ue=this._locateOptions;if(ue.setView){var _e=this.getBoundsZoom(ee);this.setView(U,ue.maxZoom?Math.min(_e,ue.maxZoom):_e)}var Ae={latlng:U,bounds:ee,timestamp:f.timestamp};for(var De in f.coords)typeof f.coords[De]=="number"&&(Ae[De]=f.coords[De]);this.fire("locationfound",Ae)}},addHandler:function(f,_){if(!_)return this;var M=this[f]=new _(this);return this._handlers.push(M),this.options[f]&&M.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),dr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Y(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)dr(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,_){var M="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),U=lt("div",M,_||this._mapPane);return f&&(this._panes[f]=U),U},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),_=this.unproject(f.getBottomLeft()),M=this.unproject(f.getTopRight());return new ae(_,M)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,_,M){f=he(f),M=ne(M||[0,0]);var U=this.getZoom()||0,ee=this.getMinZoom(),ue=this.getMaxZoom(),_e=f.getNorthWest(),Ae=f.getSouthEast(),De=this.getSize().subtract(M),$e=re(this.project(Ae,U),this.project(_e,U)).getSize(),pt=bt.any3d?this.options.zoomSnap:1,It=De.x/$e.x,Jt=De.y/$e.y,Ar=_?Math.max(It,Jt):Math.min(It,Jt);return U=this.getScaleZoom(Ar,U),pt&&(U=Math.round(U/(pt/100))*(pt/100),U=_?Math.ceil(U/pt)*pt:Math.floor(U/pt)*pt),Math.max(ee,Math.min(ue,U))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new J(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,_){var M=this._getTopLeftPoint(f,_);return new W(M,M.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,_){var M=this.options.crs;return _=_===void 0?this._zoom:_,M.scale(f)/M.scale(_)},getScaleZoom:function(f,_){var M=this.options.crs;_=_===void 0?this._zoom:_;var U=M.zoom(f*M.scale(_));return isNaN(U)?1/0:U},project:function(f,_){return _=_===void 0?this._zoom:_,this.options.crs.latLngToPoint(xe(f),_)},unproject:function(f,_){return _=_===void 0?this._zoom:_,this.options.crs.pointToLatLng(ne(f),_)},layerPointToLatLng:function(f){var _=ne(f).add(this.getPixelOrigin());return this.unproject(_)},latLngToLayerPoint:function(f){var _=this.project(xe(f))._round();return _._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(xe(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(he(f))},distance:function(f,_){return this.options.crs.distance(xe(f),xe(_))},containerPointToLayerPoint:function(f){return ne(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return ne(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var _=this.containerPointToLayerPoint(ne(f));return this.layerPointToLatLng(_)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(xe(f)))},mouseEventToContainerPoint:function(f){return fu(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var _=this._container=mn(f);if(_){if(_._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");qt(_,"scroll",this._onScroll,this),this._containerId=u(_)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&bt.any3d,Mt(f,"leaflet-container"+(bt.touch?" leaflet-touch":"")+(bt.retina?" leaflet-retina":"")+(bt.ielt9?" leaflet-oldie":"")+(bt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var _=yr(f,"position");_!=="absolute"&&_!=="relative"&&_!=="fixed"&&_!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),wn(this._mapPane,new J(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Mt(f.markerPane,"leaflet-zoom-hide"),Mt(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,_,M){wn(this._mapPane,new J(0,0));var U=!this._loaded;this._loaded=!0,_=this._limitZoom(_),this.fire("viewprereset");var ee=this._zoom!==_;this._moveStart(ee,M)._move(f,_)._moveEnd(ee),this.fire("viewreset"),U&&this.fire("load")},_moveStart:function(f,_){return f&&this.fire("zoomstart"),_||this.fire("movestart"),this},_move:function(f,_,M,U){_===void 0&&(_=this._zoom);var ee=this._zoom!==_;return this._zoom=_,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),U?M&&M.pinch&&this.fire("zoom",M):((ee||M&&M.pinch)&&this.fire("zoom",M),this.fire("move",M)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Y(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){wn(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[u(this._container)]=this;var _=f?Pr:qt;_(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&_(window,"resize",this._onResize,this),bt.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Y(this._resizeRequest),this._resizeRequest=$(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,_){for(var M=[],U,ee=_==="mouseout"||_==="mouseover",ue=f.target||f.srcElement,_e=!1;ue;){if(U=this._targets[u(ue)],U&&(_==="click"||_==="preclick")&&this._draggableMoved(U)){_e=!0;break}if(U&&U.listens(_,!0)&&(ee&&!io(ue,f)||(M.push(U),ee))||ue===this._container)break;ue=ue.parentNode}return!M.length&&!_e&&!ee&&this.listens(_,!0)&&(M=[this]),M},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var _=f.target||f.srcElement;if(!(!this._loaded||_._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(_))){var M=f.type;M==="mousedown"&&no(_),this._fireDOMEvent(f,M)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,_,M){if(f.type==="click"){var U=a({},f);U.type="preclick",this._fireDOMEvent(U,U.type,M)}var ee=this._findEventTargets(f,_);if(M){for(var ue=[],_e=0;_e<M.length;_e++)M[_e].listens(_,!0)&&ue.push(M[_e]);ee=ue.concat(ee)}if(ee.length){_==="contextmenu"&&$r(f);var Ae=ee[0],De={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var $e=Ae.getLatLng&&(!Ae._radius||Ae._radius<=10);De.containerPoint=$e?this.latLngToContainerPoint(Ae.getLatLng()):this.mouseEventToContainerPoint(f),De.layerPoint=this.containerPointToLayerPoint(De.containerPoint),De.latlng=$e?Ae.getLatLng():this.layerPointToLatLng(De.layerPoint)}for(_e=0;_e<ee.length;_e++)if(ee[_e].fire(_,De,!0),De.originalEvent._stopped||ee[_e].options.bubblingMouseEvents===!1&&P(this._mouseEvents,_)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,_=this._handlers.length;f<_;f++)this._handlers[f].disable()},whenReady:function(f,_){return this._loaded?f.call(_||this,{target:this}):this.on("load",f,_),this},_getMapPanePos:function(){return zs(this._mapPane)||new J(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,_){var M=f&&_!==void 0?this._getNewPixelOrigin(f,_):this.getPixelOrigin();return M.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,_){var M=this.getSize()._divideBy(2);return this.project(f,_)._subtract(M)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,_,M){var U=this._getNewPixelOrigin(M,_);return this.project(f,_)._subtract(U)},_latLngBoundsToNewLayerBounds:function(f,_,M){var U=this._getNewPixelOrigin(M,_);return re([this.project(f.getSouthWest(),_)._subtract(U),this.project(f.getNorthWest(),_)._subtract(U),this.project(f.getSouthEast(),_)._subtract(U),this.project(f.getNorthEast(),_)._subtract(U)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,_,M){if(!M)return f;var U=this.project(f,_),ee=this.getSize().divideBy(2),ue=new W(U.subtract(ee),U.add(ee)),_e=this._getBoundsOffset(ue,M,_);return Math.abs(_e.x)<=1&&Math.abs(_e.y)<=1?f:this.unproject(U.add(_e),_)},_limitOffset:function(f,_){if(!_)return f;var M=this.getPixelBounds(),U=new W(M.min.add(f),M.max.add(f));return f.add(this._getBoundsOffset(U,_))},_getBoundsOffset:function(f,_,M){var U=re(this.project(_.getNorthEast(),M),this.project(_.getSouthWest(),M)),ee=U.min.subtract(f.min),ue=U.max.subtract(f.max),_e=this._rebound(ee.x,-ue.x),Ae=this._rebound(ee.y,-ue.y);return new J(_e,Ae)},_rebound:function(f,_){return f+_>0?Math.round(f-_)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(_))},_limitZoom:function(f){var _=this.getMinZoom(),M=this.getMaxZoom(),U=bt.any3d?this.options.zoomSnap:1;return U&&(f=Math.round(f/U)*U),Math.max(_,Math.min(M,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){xr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,_){var M=this._getCenterOffset(f)._trunc();return(_&&_.animate)!==!0&&!this.getSize().contains(M)?!1:(this.panBy(M,_),!0)},_createAnimProxy:function(){var f=this._proxy=lt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(_){var M=Oo,U=this._proxy.style[M];Za(this._proxy,this.project(_.center,_.zoom),this.getZoomScale(_.zoom,1)),U===this._proxy.style[M]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){dr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),_=this.getZoom();Za(this._proxy,this.project(f,_),this.getZoomScale(_,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,_,M){if(this._animatingZoom)return!0;if(M=M||{},!this._zoomAnimated||M.animate===!1||this._nothingToAnimate()||Math.abs(_-this._zoom)>this.options.zoomAnimationThreshold)return!1;var U=this.getZoomScale(_),ee=this._getCenterOffset(f)._divideBy(1-1/U);return M.animate!==!0&&!this.getSize().contains(ee)?!1:($(function(){this._moveStart(!0,M.noMoveStart||!1)._animateZoom(f,_,!0)},this),!0)},_animateZoom:function(f,_,M,U){this._mapPane&&(M&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=_,Mt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:_,noUpdate:U}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&xr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Jn(f,_){return new or(f,_)}var Fn=q.extend({options:{position:"topright"},initialize:function(f){S(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var _=this._map;return _&&_.removeControl(this),this.options.position=f,_&&_.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var _=this._container=this.onAdd(f),M=this.getPosition(),U=f._controlCorners[M];return Mt(_,"leaflet-control"),M.indexOf("bottom")!==-1?U.insertBefore(_,U.firstChild):U.appendChild(_),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(dr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),aa=function(f){return new Fn(f)};or.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},_="leaflet-",M=this._controlContainer=lt("div",_+"control-container",this._container);function U(ee,ue){var _e=_+ee+" "+_+ue;f[ee+ue]=lt("div",_e,M)}U("top","left"),U("top","right"),U("bottom","left"),U("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)dr(this._controlCorners[f]);dr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var bl=Fn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,_,M,U){return M<U?-1:U<M?1:0}},initialize:function(f,_,M){S(this,M),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var U in f)this._addLayer(f[U],U);for(U in _)this._addLayer(_[U],U,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var _=0;_<this._layers.length;_++)this._layers[_].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return Fn.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,_){return this._addLayer(f,_),this._map?this._update():this},addOverlay:function(f,_){return this._addLayer(f,_,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var _=this._getLayer(u(f));return _&&this._layers.splice(this._layers.indexOf(_),1),this._map?this._update():this},expand:function(){Mt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(Mt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):xr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return xr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",_=this._container=lt("div",f),M=this.options.collapsed;_.setAttribute("aria-haspopup",!0),hu(_),yl(_);var U=this._section=lt("section",f+"-list");M&&(this._map.on("click",this.collapse,this),qt(_,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var ee=this._layersLink=lt("a",f+"-toggle",_);ee.href="#",ee.title="Layers",ee.setAttribute("role","button"),qt(ee,{keydown:function(ue){ue.keyCode===13&&this._expandSafely()},click:function(ue){$r(ue),this._expandSafely()}},this),M||this.expand(),this._baseLayersList=lt("div",f+"-base",U),this._separator=lt("div",f+"-separator",U),this._overlaysList=lt("div",f+"-overlays",U),_.appendChild(U)},_getLayer:function(f){for(var _=0;_<this._layers.length;_++)if(this._layers[_]&&u(this._layers[_].layer)===f)return this._layers[_]},_addLayer:function(f,_,M){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:_,overlay:M}),this.options.sortLayers&&this._layers.sort(o(function(U,ee){return this.options.sortFunction(U.layer,ee.layer,U.name,ee.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;on(this._baseLayersList),on(this._overlaysList),this._layerControlInputs=[];var f,_,M,U,ee=0;for(M=0;M<this._layers.length;M++)U=this._layers[M],this._addItem(U),_=_||U.overlay,f=f||!U.overlay,ee+=U.overlay?0:1;return this.options.hideSingleBase&&(f=f&&ee>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=_&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var _=this._getLayer(u(f.target)),M=_.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;M&&this._map.fire(M,_)},_createRadioElement:function(f,_){var M='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(_?' checked="checked"':"")+"/>",U=document.createElement("div");return U.innerHTML=M,U.firstChild},_addItem:function(f){var _=document.createElement("label"),M=this._map.hasLayer(f.layer),U;f.overlay?(U=document.createElement("input"),U.type="checkbox",U.className="leaflet-control-layers-selector",U.defaultChecked=M):U=this._createRadioElement("leaflet-base-layers_"+u(this),M),this._layerControlInputs.push(U),U.layerId=u(f.layer),qt(U,"click",this._onInputClick,this);var ee=document.createElement("span");ee.innerHTML=" "+f.name;var ue=document.createElement("span");_.appendChild(ue),ue.appendChild(U),ue.appendChild(ee);var _e=f.overlay?this._overlaysList:this._baseLayersList;return _e.appendChild(_),this._checkDisabledLayers(),_},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,_,M,U=[],ee=[];this._handlingClick=!0;for(var ue=f.length-1;ue>=0;ue--)_=f[ue],M=this._getLayer(_.layerId).layer,_.checked?U.push(M):_.checked||ee.push(M);for(ue=0;ue<ee.length;ue++)this._map.hasLayer(ee[ue])&&this._map.removeLayer(ee[ue]);for(ue=0;ue<U.length;ue++)this._map.hasLayer(U[ue])||this._map.addLayer(U[ue]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,_,M,U=this._map.getZoom(),ee=f.length-1;ee>=0;ee--)_=f[ee],M=this._getLayer(_.layerId).layer,_.disabled=M.options.minZoom!==void 0&&U<M.options.minZoom||M.options.maxZoom!==void 0&&U>M.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,qt(f,"click",$r),this.expand();var _=this;setTimeout(function(){Pr(f,"click",$r),_._preventClick=!1})}}),zo=function(f,_,M){return new bl(f,_,M)},ei=Fn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var _="leaflet-control-zoom",M=lt("div",_+" leaflet-bar"),U=this.options;return this._zoomInButton=this._createButton(U.zoomInText,U.zoomInTitle,_+"-in",M,this._zoomIn),this._zoomOutButton=this._createButton(U.zoomOutText,U.zoomOutTitle,_+"-out",M,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),M},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,_,M,U,ee){var ue=lt("a",M,U);return ue.innerHTML=f,ue.href="#",ue.title=_,ue.setAttribute("role","button"),ue.setAttribute("aria-label",_),hu(ue),qt(ue,"click",Sn),qt(ue,"click",ee,this),qt(ue,"click",this._refocusOnMap,this),ue},_updateDisabled:function(){var f=this._map,_="leaflet-disabled";xr(this._zoomInButton,_),xr(this._zoomOutButton,_),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(Mt(this._zoomOutButton,_),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(Mt(this._zoomInButton,_),this._zoomInButton.setAttribute("aria-disabled","true"))}});or.mergeOptions({zoomControl:!0}),or.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ei,this.addControl(this.zoomControl))});var sa=function(f){return new ei(f)},kn=Fn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var _="leaflet-control-scale",M=lt("div",_),U=this.options;return this._addScales(U,_+"-line",M),f.on(U.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),M},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,_,M){f.metric&&(this._mScale=lt("div",_,M)),f.imperial&&(this._iScale=lt("div",_,M))},_update:function(){var f=this._map,_=f.getSize().y/2,M=f.distance(f.containerPointToLatLng([0,_]),f.containerPointToLatLng([this.options.maxWidth,_]));this._updateScales(M)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var _=this._getRoundNum(f),M=_<1e3?_+" m":_/1e3+" km";this._updateScale(this._mScale,M,_/f)},_updateImperial:function(f){var _=f*3.2808399,M,U,ee;_>5280?(M=_/5280,U=this._getRoundNum(M),this._updateScale(this._iScale,U+" mi",U/M)):(ee=this._getRoundNum(_),this._updateScale(this._iScale,ee+" ft",ee/_))},_updateScale:function(f,_,M){f.style.width=Math.round(this.options.maxWidth*M)+"px",f.innerHTML=_},_getRoundNum:function(f){var _=Math.pow(10,(Math.floor(f)+"").length-1),M=f/_;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:1,_*M}}),Ri=function(f){return new kn(f)},Xa='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',oa=Fn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(bt.inlineSvg?Xa+" ":"")+"Leaflet</a>"},initialize:function(f){S(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=lt("div","leaflet-control-attribution"),hu(this._container);for(var _ in f._layers)f._layers[_].getAttribution&&this.addAttribution(f._layers[_].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var _ in this._attributions)this._attributions[_]&&f.push(_);var M=[];this.options.prefix&&M.push(this.options.prefix),f.length&&M.push(f.join(", ")),this._container.innerHTML=M.join(' <span aria-hidden="true">|</span> ')}}});or.mergeOptions({attributionControl:!0}),or.addInitHook(function(){this.options.attributionControl&&new oa().addTo(this)});var tf=function(f){return new oa(f)};Fn.Layers=bl,Fn.Zoom=ei,Fn.Scale=kn,Fn.Attribution=oa,aa.layers=zo,aa.zoom=sa,aa.scale=Ri,aa.attribution=tf;var Li=q.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Li.addTo=function(f,_){return f.addHandler(_,this),this};var mu={Events:Z},Vn=bt.touch?"touchstart mousedown":"mousedown",ln=Q.extend({options:{clickTolerance:3},initialize:function(f,_,M,U){S(this,U),this._element=f,this._dragStartTarget=_||f,this._preventOutline=M},enable:function(){this._enabled||(qt(this._dragStartTarget,Vn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ln._dragging===this&&this.finishDrag(!0),Pr(this._dragStartTarget,Vn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!ia(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){ln._dragging===this&&this.finishDrag();return}if(!(ln._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(ln._dragging=this,this._preventOutline&&no(this._element),rc(),nr(),!this._moving)){this.fire("down");var _=f.touches?f.touches[0]:f,M=Vs(this._element);this._startPoint=new J(_.clientX,_.clientY),this._startPos=zs(this._element),this._parentScale=ja(M);var U=f.type==="mousedown";qt(document,U?"mousemove":"touchmove",this._onMove,this),qt(document,U?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var _=f.touches&&f.touches.length===1?f.touches[0]:f,M=new J(_.clientX,_.clientY)._subtract(this._startPoint);!M.x&&!M.y||Math.abs(M.x)+Math.abs(M.y)<this.options.clickTolerance||(M.x/=this._parentScale.x,M.y/=this._parentScale.y,$r(f),this._moved||(this.fire("dragstart"),this._moved=!0,Mt(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Mt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(M),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),wn(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){xr(document.body,"leaflet-dragging"),this._lastTarget&&(xr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Pr(document,"mousemove touchmove",this._onMove,this),Pr(document,"mouseup touchend touchcancel",this._onUp,this),nc(),Fs();var _=this._moved&&this._moving;this._moving=!1,ln._dragging=!1,_&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function Dr(f,_,M){var U,ee=[1,4,2,8],ue,_e,Ae,De,$e,pt,It,Jt;for(ue=0,pt=f.length;ue<pt;ue++)f[ue]._code=vs(f[ue],_);for(Ae=0;Ae<4;Ae++){for(It=ee[Ae],U=[],ue=0,pt=f.length,_e=pt-1;ue<pt;_e=ue++)De=f[ue],$e=f[_e],De._code&It?$e._code&It||(Jt=sc($e,De,It,_,M),Jt._code=vs(Jt,_),U.push(Jt)):($e._code&It&&(Jt=sc($e,De,It,_,M),Jt._code=vs(Jt,_),U.push(Jt)),U.push(De));f=U}return f}function wl(f,_){var M,U,ee,ue,_e,Ae,De,$e,pt;if(!f||f.length===0)throw new Error("latlngs not passed");ki(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var It=xe([0,0]),Jt=he(f),Ar=Jt.getNorthWest().distanceTo(Jt.getSouthWest())*Jt.getNorthEast().distanceTo(Jt.getNorthWest());Ar<1700&&(It=la(f));var Nn=f.length,mi=[];for(M=0;M<Nn;M++){var Ci=xe(f[M]);mi.push(_.project(xe([Ci.lat-It.lat,Ci.lng-It.lng])))}for(Ae=De=$e=0,M=0,U=Nn-1;M<Nn;U=M++)ee=mi[M],ue=mi[U],_e=ee.y*ue.x-ue.y*ee.x,De+=(ee.x+ue.x)*_e,$e+=(ee.y+ue.y)*_e,Ae+=_e*3;Ae===0?pt=mi[0]:pt=[De/Ae,$e/Ae];var Ko=_.unproject(ne(pt));return xe([Ko.lat+It.lat,Ko.lng+It.lng])}function la(f){for(var _=0,M=0,U=0,ee=0;ee<f.length;ee++){var ue=xe(f[ee]);_+=ue.lat,M+=ue.lng,U++}return xe([_/U,M/U])}var rf={__proto__:null,clipPolygon:Dr,polygonCenter:wl,centroid:la};function gu(f,_){if(!_||!f.length)return f.slice();var M=_*_;return f=af(f,M),f=nf(f,M),f}function ic(f,_,M){return Math.sqrt(Qa(f,_,M,!0))}function Ud(f,_,M){return Qa(f,_,M)}function nf(f,_){var M=f.length,U=typeof Uint8Array<"u"?Uint8Array:Array,ee=new U(M);ee[0]=ee[M-1]=1,_l(f,ee,_,0,M-1);var ue,_e=[];for(ue=0;ue<M;ue++)ee[ue]&&_e.push(f[ue]);return _e}function _l(f,_,M,U,ee){var ue=0,_e,Ae,De;for(Ae=U+1;Ae<=ee-1;Ae++)De=Qa(f[Ae],f[U],f[ee],!0),De>ue&&(_e=Ae,ue=De);ue>M&&(_[_e]=1,_l(f,_,M,U,_e),_l(f,_,M,_e,ee))}function af(f,_){for(var M=[f[0]],U=1,ee=0,ue=f.length;U<ue;U++)Op(f[U],f[ee])>_&&(M.push(f[U]),ee=U);return ee<ue-1&&M.push(f[ue-1]),M}var ao;function ac(f,_,M,U,ee){var ue=U?ao:vs(f,M),_e=vs(_,M),Ae,De,$e;for(ao=_e;;){if(!(ue|_e))return[f,_];if(ue&_e)return!1;Ae=ue||_e,De=sc(f,_,Ae,M,ee),$e=vs(De,M),Ae===ue?(f=De,ue=$e):(_=De,_e=$e)}}function sc(f,_,M,U,ee){var ue=_.x-f.x,_e=_.y-f.y,Ae=U.min,De=U.max,$e,pt;return M&8?($e=f.x+ue*(De.y-f.y)/_e,pt=De.y):M&4?($e=f.x+ue*(Ae.y-f.y)/_e,pt=Ae.y):M&2?($e=De.x,pt=f.y+_e*(De.x-f.x)/ue):M&1&&($e=Ae.x,pt=f.y+_e*(Ae.x-f.x)/ue),new J($e,pt,ee)}function vs(f,_){var M=0;return f.x<_.min.x?M|=1:f.x>_.max.x&&(M|=2),f.y<_.min.y?M|=4:f.y>_.max.y&&(M|=8),M}function Op(f,_){var M=_.x-f.x,U=_.y-f.y;return M*M+U*U}function Qa(f,_,M,U){var ee=_.x,ue=_.y,_e=M.x-ee,Ae=M.y-ue,De=_e*_e+Ae*Ae,$e;return De>0&&($e=((f.x-ee)*_e+(f.y-ue)*Ae)/De,$e>1?(ee=M.x,ue=M.y):$e>0&&(ee+=_e*$e,ue+=Ae*$e)),_e=f.x-ee,Ae=f.y-ue,U?_e*_e+Ae*Ae:new J(ee,ue)}function ki(f){return!N(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function Hd(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ki(f)}function Gd(f,_){var M,U,ee,ue,_e,Ae,De,$e;if(!f||f.length===0)throw new Error("latlngs not passed");ki(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var pt=xe([0,0]),It=he(f),Jt=It.getNorthWest().distanceTo(It.getSouthWest())*It.getNorthEast().distanceTo(It.getNorthWest());Jt<1700&&(pt=la(f));var Ar=f.length,Nn=[];for(M=0;M<Ar;M++){var mi=xe(f[M]);Nn.push(_.project(xe([mi.lat-pt.lat,mi.lng-pt.lng])))}for(M=0,U=0;M<Ar-1;M++)U+=Nn[M].distanceTo(Nn[M+1])/2;if(U===0)$e=Nn[0];else for(M=0,ue=0;M<Ar-1;M++)if(_e=Nn[M],Ae=Nn[M+1],ee=_e.distanceTo(Ae),ue+=ee,ue>U){De=(ue-U)/ee,$e=[Ae.x-De*(Ae.x-_e.x),Ae.y-De*(Ae.y-_e.y)];break}var Ci=_.unproject(ne($e));return xe([Ci.lat+pt.lat,Ci.lng+pt.lng])}var Fo={__proto__:null,simplify:gu,pointToSegmentDistance:ic,closestPointOnSegment:Ud,clipSegment:ac,_getEdgeIntersection:sc,_getBitCode:vs,_sqClosestPointOnSegment:Qa,isFlat:ki,_flat:Hd,polylineCenter:Gd},oc={project:function(f){return new J(f.lng,f.lat)},unproject:function(f){return new ve(f.y,f.x)},bounds:new W([-180,-90],[180,90])},Sl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new W([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var _=Math.PI/180,M=this.R,U=f.lat*_,ee=this.R_MINOR/M,ue=Math.sqrt(1-ee*ee),_e=ue*Math.sin(U),Ae=Math.tan(Math.PI/4-U/2)/Math.pow((1-_e)/(1+_e),ue/2);return U=-M*Math.log(Math.max(Ae,1e-10)),new J(f.lng*_*M,U)},unproject:function(f){for(var _=180/Math.PI,M=this.R,U=this.R_MINOR/M,ee=Math.sqrt(1-U*U),ue=Math.exp(-f.y/M),_e=Math.PI/2-2*Math.atan(ue),Ae=0,De=.1,$e;Ae<15&&Math.abs(De)>1e-7;Ae++)$e=ee*Math.sin(_e),$e=Math.pow((1-$e)/(1+$e),ee/2),De=Math.PI/2-2*Math.atan(ue*$e)-_e,_e+=De;return new ve(_e*_,f.x*_/M)}},lc={__proto__:null,LonLat:oc,Mercator:Sl,SphericalMercator:pe},kl=a({},ge,{code:"EPSG:3395",projection:Sl,transformation:(function(){var f=.5/(Math.PI*Sl.R);return be(f,.5,-f,.5)})()}),uc=a({},ge,{code:"EPSG:4326",projection:oc,transformation:be(1/180,1,-1/180,.5)}),qd=a({},se,{projection:oc,transformation:be(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,_){var M=_.lng-f.lng,U=_.lat-f.lat;return Math.sqrt(M*M+U*U)},infinite:!0});se.Earth=ge,se.EPSG3395=kl,se.EPSG3857=Se,se.EPSG900913=Ue,se.EPSG4326=uc,se.Simple=qd;var Ra=Q.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[u(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[u(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var _=f.target;if(_.hasLayer(this)){if(this._map=_,this._zoomAnimated=_._zoomAnimated,this.getEvents){var M=this.getEvents();_.on(M,this),this.once("remove",function(){_.off(M,this)},this)}this.onAdd(_),this.fire("add"),_.fire("layeradd",{layer:this})}}});or.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var _=u(f);return this._layers[_]?this:(this._layers[_]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var _=u(f);return this._layers[_]?(this._loaded&&f.onRemove(this),delete this._layers[_],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return u(f)in this._layers},eachLayer:function(f,_){for(var M in this._layers)f.call(_,this._layers[M]);return this},_addLayers:function(f){f=f?N(f)?f:[f]:[];for(var _=0,M=f.length;_<M;_++)this.addLayer(f[_])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[u(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var _=u(f);this._zoomBoundLayers[_]&&(delete this._zoomBoundLayers[_],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,_=-1/0,M=this._getZoomSpan();for(var U in this._zoomBoundLayers){var ee=this._zoomBoundLayers[U].options;f=ee.minZoom===void 0?f:Math.min(f,ee.minZoom),_=ee.maxZoom===void 0?_:Math.max(_,ee.maxZoom)}this._layersMaxZoom=_===-1/0?void 0:_,this._layersMinZoom=f===1/0?void 0:f,M!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ys=Ra.extend({initialize:function(f,_){S(this,_),this._layers={};var M,U;if(f)for(M=0,U=f.length;M<U;M++)this.addLayer(f[M])},addLayer:function(f){var _=this.getLayerId(f);return this._layers[_]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var _=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[_]&&this._map.removeLayer(this._layers[_]),delete this._layers[_],this},hasLayer:function(f){var _=typeof f=="number"?f:this.getLayerId(f);return _ in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var _=Array.prototype.slice.call(arguments,1),M,U;for(M in this._layers)U=this._layers[M],U[f]&&U[f].apply(U,_);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,_){for(var M in this._layers)f.call(_,this._layers[M]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return u(f)}}),Vo=function(f,_){return new ys(f,_)},Oi=ys.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),ys.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),ys.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new ae;for(var _ in this._layers){var M=this._layers[_];f.extend(M.getBounds?M.getBounds():M.getLatLng())}return f}}),ua=function(f,_){return new Oi(f,_)},ca=q.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){S(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,_){var M=this._getIconUrl(f);if(!M){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var U=this._createImg(M,_&&_.tagName==="IMG"?_:null);return this._setIconStyles(U,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(U.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),U},_setIconStyles:function(f,_){var M=this.options,U=M[_+"Size"];typeof U=="number"&&(U=[U,U]);var ee=ne(U),ue=ne(_==="shadow"&&M.shadowAnchor||M.iconAnchor||ee&&ee.divideBy(2,!0));f.className="leaflet-marker-"+_+" "+(M.className||""),ue&&(f.style.marginLeft=-ue.x+"px",f.style.marginTop=-ue.y+"px"),ee&&(f.style.width=ee.x+"px",f.style.height=ee.y+"px")},_createImg:function(f,_){return _=_||document.createElement("img"),_.src=f,_},_getIconUrl:function(f){return bt.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function cc(f){return new ca(f)}var Uo=ca.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof Uo.imagePath!="string"&&(Uo.imagePath=this._detectIconPath()),(this.options.imagePath||Uo.imagePath)+ca.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var _=function(M,U,ee){var ue=U.exec(M);return ue&&ue[ee]};return f=_(f,/^url\((['"])?(.+)\1\)$/,2),f&&_(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=lt("div","leaflet-default-icon-path",document.body),_=yr(f,"background-image")||yr(f,"backgroundImage");if(document.body.removeChild(f),_=this._stripUrl(_),_)return _;var M=document.querySelector('link[href$="leaflet.css"]');return M?M.href.substring(0,M.href.length-11-1):""}}),La=Li.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new ln(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Mt(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&xr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var _=this._marker,M=_._map,U=this._marker.options.autoPanSpeed,ee=this._marker.options.autoPanPadding,ue=zs(_._icon),_e=M.getPixelBounds(),Ae=M.getPixelOrigin(),De=re(_e.min._subtract(Ae).add(ee),_e.max._subtract(Ae).subtract(ee));if(!De.contains(ue)){var $e=ne((Math.max(De.max.x,ue.x)-De.max.x)/(_e.max.x-De.max.x)-(Math.min(De.min.x,ue.x)-De.min.x)/(_e.min.x-De.min.x),(Math.max(De.max.y,ue.y)-De.max.y)/(_e.max.y-De.max.y)-(Math.min(De.min.y,ue.y)-De.min.y)/(_e.min.y-De.min.y)).multiplyBy(U);M.panBy($e,{animate:!1}),this._draggable._newPos._add($e),this._draggable._startPos._add($e),wn(_._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=$(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(Y(this._panRequest),this._panRequest=$(this._adjustPan.bind(this,f)))},_onDrag:function(f){var _=this._marker,M=_._shadow,U=zs(_._icon),ee=_._map.layerPointToLatLng(U);M&&wn(M,U),_._latlng=ee,f.latlng=ee,f.oldLatLng=this._oldLatLng,_.fire("move",f).fire("drag",f)},_onDragEnd:function(f){Y(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),fi=Ra.extend({options:{icon:new Uo,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,_){S(this,_),this._latlng=xe(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var _=this._latlng;return this._latlng=xe(f),this.update(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,_="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),M=f.icon.createIcon(this._icon),U=!1;M!==this._icon&&(this._icon&&this._removeIcon(),U=!0,f.title&&(M.title=f.title),M.tagName==="IMG"&&(M.alt=f.alt||"")),Mt(M,_),f.keyboard&&(M.tabIndex="0",M.setAttribute("role","button")),this._icon=M,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&qt(M,"focus",this._panOnFocus,this);var ee=f.icon.createShadow(this._shadow),ue=!1;ee!==this._shadow&&(this._removeShadow(),ue=!0),ee&&(Mt(ee,_),ee.alt=""),this._shadow=ee,f.opacity<1&&this._updateOpacity(),U&&this.getPane().appendChild(this._icon),this._initInteraction(),ee&&ue&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Pr(this._icon,"focus",this._panOnFocus,this),dr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&dr(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&wn(this._icon,f),this._shadow&&wn(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var _=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(_)},_initInteraction:function(){if(this.options.interactive&&(Mt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),La)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new La(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&Qn(this._icon,f),this._shadow&&Qn(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var _=this.options.icon.options,M=_.iconSize?ne(_.iconSize):ne(0,0),U=_.iconAnchor?ne(_.iconAnchor):ne(0,0);f.panInside(this._latlng,{paddingTopLeft:U,paddingBottomRight:M.subtract(U)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Wd(f,_){return new fi(f,_)}var Us=Ra.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return S(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Oa=Us.extend({options:{fill:!0,radius:10},initialize:function(f,_){S(this,_),this._latlng=xe(f),this._radius=this.options.radius},setLatLng:function(f){var _=this._latlng;return this._latlng=xe(f),this.redraw(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var _=f&&f.radius||this._radius;return Us.prototype.setStyle.call(this,f),this.setRadius(_),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,_=this._radiusY||f,M=this._clickTolerance(),U=[f+M,_+M];this._pxBounds=new W(this._point.subtract(U),this._point.add(U))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Hs(f,_){return new Oa(f,_)}var Ho=Oa.extend({initialize:function(f,_,M){if(typeof _=="number"&&(_=a({},M,{radius:_})),S(this,_),this._latlng=xe(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new ae(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:Us.prototype.setStyle,_project:function(){var f=this._latlng.lng,_=this._latlng.lat,M=this._map,U=M.options.crs;if(U.distance===ge.distance){var ee=Math.PI/180,ue=this._mRadius/ge.R/ee,_e=M.project([_+ue,f]),Ae=M.project([_-ue,f]),De=_e.add(Ae).divideBy(2),$e=M.unproject(De).lat,pt=Math.acos((Math.cos(ue*ee)-Math.sin(_*ee)*Math.sin($e*ee))/(Math.cos(_*ee)*Math.cos($e*ee)))/ee;(isNaN(pt)||pt===0)&&(pt=ue/Math.cos(Math.PI/180*_)),this._point=De.subtract(M.getPixelOrigin()),this._radius=isNaN(pt)?0:De.x-M.project([$e,f-pt]).x,this._radiusY=De.y-_e.y}else{var It=U.unproject(U.project(this._latlng).subtract([this._mRadius,0]));this._point=M.latLngToLayerPoint(this._latlng),this._radius=this._point.x-M.latLngToLayerPoint(It).x}this._updateBounds()}});function Cl(f,_,M){return new Ho(f,_,M)}var pi=Us.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,_){S(this,_),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var _=1/0,M=null,U=Qa,ee,ue,_e=0,Ae=this._parts.length;_e<Ae;_e++)for(var De=this._parts[_e],$e=1,pt=De.length;$e<pt;$e++){ee=De[$e-1],ue=De[$e];var It=U(f,ee,ue,!0);It<_&&(_=It,M=U(f,ee,ue))}return M&&(M.distance=Math.sqrt(_)),M},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Gd(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,_){return _=_||this._defaultShape(),f=xe(f),_.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new ae,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return ki(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var _=[],M=ki(f),U=0,ee=f.length;U<ee;U++)M?(_[U]=xe(f[U]),this._bounds.extend(_[U])):_[U]=this._convertLatLngs(f[U]);return _},_project:function(){var f=new W;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),_=new J(f,f);this._rawPxBounds&&(this._pxBounds=new W([this._rawPxBounds.min.subtract(_),this._rawPxBounds.max.add(_)]))},_projectLatlngs:function(f,_,M){var U=f[0]instanceof ve,ee=f.length,ue,_e;if(U){for(_e=[],ue=0;ue<ee;ue++)_e[ue]=this._map.latLngToLayerPoint(f[ue]),M.extend(_e[ue]);_.push(_e)}else for(ue=0;ue<ee;ue++)this._projectLatlngs(f[ue],_,M)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var _=this._parts,M,U,ee,ue,_e,Ae,De;for(M=0,ee=0,ue=this._rings.length;M<ue;M++)for(De=this._rings[M],U=0,_e=De.length;U<_e-1;U++)Ae=ac(De[U],De[U+1],f,U,!0),Ae&&(_[ee]=_[ee]||[],_[ee].push(Ae[0]),(Ae[1]!==De[U+1]||U===_e-2)&&(_[ee].push(Ae[1]),ee++))}},_simplifyPoints:function(){for(var f=this._parts,_=this.options.smoothFactor,M=0,U=f.length;M<U;M++)f[M]=gu(f[M],_)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,_){var M,U,ee,ue,_e,Ae,De=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(M=0,ue=this._parts.length;M<ue;M++)for(Ae=this._parts[M],U=0,_e=Ae.length,ee=_e-1;U<_e;ee=U++)if(!(!_&&U===0)&&ic(f,Ae[ee],Ae[U])<=De)return!0;return!1}});function sf(f,_){return new pi(f,_)}pi._flat=Hd;var da=pi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return wl(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var _=pi.prototype._convertLatLngs.call(this,f),M=_.length;return M>=2&&_[0]instanceof ve&&_[0].equals(_[M-1])&&_.pop(),_},_setLatLngs:function(f){pi.prototype._setLatLngs.call(this,f),ki(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ki(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,_=this.options.weight,M=new J(_,_);if(f=new W(f.min.subtract(M),f.max.add(M)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var U=0,ee=this._rings.length,ue;U<ee;U++)ue=Dr(this._rings[U],f,!0),ue.length&&this._parts.push(ue)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var _=!1,M,U,ee,ue,_e,Ae,De,$e;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(ue=0,De=this._parts.length;ue<De;ue++)for(M=this._parts[ue],_e=0,$e=M.length,Ae=$e-1;_e<$e;Ae=_e++)U=M[_e],ee=M[Ae],U.y>f.y!=ee.y>f.y&&f.x<(ee.x-U.x)*(f.y-U.y)/(ee.y-U.y)+U.x&&(_=!_);return _||pi.prototype._containsPoint.call(this,f,!0)}});function Da(f,_){return new da(f,_)}var Di=Oi.extend({initialize:function(f,_){S(this,_),this._layers={},f&&this.addData(f)},addData:function(f){var _=N(f)?f:f.features,M,U,ee;if(_){for(M=0,U=_.length;M<U;M++)ee=_[M],(ee.geometries||ee.geometry||ee.features||ee.coordinates)&&this.addData(ee);return this}var ue=this.options;if(ue.filter&&!ue.filter(f))return this;var _e=Ja(f,ue);return _e?(_e.feature=Go(f),_e.defaultOptions=_e.options,this.resetStyle(_e),ue.onEachFeature&&ue.onEachFeature(f,_e),this.addLayer(_e)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=a({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(_){this._setLayerStyle(_,f)},this)},_setLayerStyle:function(f,_){f.setStyle&&(typeof _=="function"&&(_=_(f.feature)),f.setStyle(_))}});function Ja(f,_){var M=f.type==="Feature"?f.geometry:f,U=M?M.coordinates:null,ee=[],ue=_&&_.pointToLayer,_e=_&&_.coordsToLatLng||El,Ae,De,$e,pt;if(!U&&!M)return null;switch(M.type){case"Point":return Ae=_e(U),ha(ue,f,Ae,_);case"MultiPoint":for($e=0,pt=U.length;$e<pt;$e++)Ae=_e(U[$e]),ee.push(ha(ue,f,Ae,_));return new Oi(ee);case"LineString":case"MultiLineString":return De=xs(U,M.type==="LineString"?0:1,_e),new pi(De,_);case"Polygon":case"MultiPolygon":return De=xs(U,M.type==="Polygon"?1:2,_e),new da(De,_);case"GeometryCollection":for($e=0,pt=M.geometries.length;$e<pt;$e++){var It=Ja({geometry:M.geometries[$e],type:"Feature",properties:f.properties},_);It&&ee.push(It)}return new Oi(ee);case"FeatureCollection":for($e=0,pt=M.features.length;$e<pt;$e++){var Jt=Ja(M.features[$e],_);Jt&&ee.push(Jt)}return new Oi(ee);default:throw new Error("Invalid GeoJSON object.")}}function ha(f,_,M,U){return f?f(_,M):new fi(M,U&&U.markersInheritOptions&&U)}function El(f){return new ve(f[1],f[0],f[2])}function xs(f,_,M){for(var U=[],ee=0,ue=f.length,_e;ee<ue;ee++)_e=_?xs(f[ee],_-1,M):(M||El)(f[ee]),U.push(_e);return U}function vu(f,_){return f=xe(f),f.alt!==void 0?[v(f.lng,_),v(f.lat,_),v(f.alt,_)]:[v(f.lng,_),v(f.lat,_)]}function Nl(f,_,M,U){for(var ee=[],ue=0,_e=f.length;ue<_e;ue++)ee.push(_?Nl(f[ue],ki(f[ue])?0:_-1,M,U):vu(f[ue],U));return!_&&M&&ee.length>0&&ee.push(ee[0].slice()),ee}function Cr(f,_){return f.feature?a({},f.feature,{geometry:_}):Go(_)}function Go(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var yu={toGeoJSON:function(f){return Cr(this,{type:"Point",coordinates:vu(this.getLatLng(),f)})}};fi.include(yu),Ho.include(yu),Oa.include(yu),pi.include({toGeoJSON:function(f){var _=!ki(this._latlngs),M=Nl(this._latlngs,_?1:0,!1,f);return Cr(this,{type:(_?"Multi":"")+"LineString",coordinates:M})}}),da.include({toGeoJSON:function(f){var _=!ki(this._latlngs),M=_&&!ki(this._latlngs[0]),U=Nl(this._latlngs,M?2:_?1:0,!0,f);return _||(U=[U]),Cr(this,{type:(M?"Multi":"")+"Polygon",coordinates:U})}}),ys.include({toMultiPoint:function(f){var _=[];return this.eachLayer(function(M){_.push(M.toGeoJSON(f).geometry.coordinates)}),Cr(this,{type:"MultiPoint",coordinates:_})},toGeoJSON:function(f){var _=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(_==="MultiPoint")return this.toMultiPoint(f);var M=_==="GeometryCollection",U=[];return this.eachLayer(function(ee){if(ee.toGeoJSON){var ue=ee.toGeoJSON(f);if(M)U.push(ue.geometry);else{var _e=Go(ue);_e.type==="FeatureCollection"?U.push.apply(U,_e.features):U.push(_e)}}}),M?Cr(this,{geometries:U,type:"GeometryCollection"}):{type:"FeatureCollection",features:U}}});function dc(f,_){return new Di(f,_)}var Ii=dc,bs=Ra.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,_,M){this._url=f,this._bounds=he(_),S(this,M)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Mt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){dr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&Fr(this._image),this},bringToBack:function(){return this._map&&Tr(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=he(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",_=this._image=f?this._url:lt("img");if(Mt(_,"leaflet-image-layer"),this._zoomAnimated&&Mt(_,"leaflet-zoom-animated"),this.options.className&&Mt(_,this.options.className),_.onselectstart=p,_.onmousemove=p,_.onload=o(this.fire,this,"load"),_.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=_.src;return}_.src=this._url,_.alt=this.options.alt},_animateZoom:function(f){var _=this._map.getZoomScale(f.zoom),M=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;Za(this._image,M,_)},_reset:function(){var f=this._image,_=new W(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),M=_.getSize();wn(f,_.min),f.style.width=M.x+"px",f.style.height=M.y+"px"},_updateOpacity:function(){Qn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),so=function(f,_,M){return new bs(f,_,M)},Vr=bs.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",_=this._image=f?this._url:lt("video");if(Mt(_,"leaflet-image-layer"),this._zoomAnimated&&Mt(_,"leaflet-zoom-animated"),this.options.className&&Mt(_,this.options.className),_.onselectstart=p,_.onmousemove=p,_.onloadeddata=o(this.fire,this,"load"),f){for(var M=_.getElementsByTagName("source"),U=[],ee=0;ee<M.length;ee++)U.push(M[ee].src);this._url=M.length>0?U:[_.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(_.style,"objectFit")&&(_.style.objectFit="fill"),_.autoplay=!!this.options.autoplay,_.loop=!!this.options.loop,_.muted=!!this.options.muted,_.playsInline=!!this.options.playsInline;for(var ue=0;ue<this._url.length;ue++){var _e=lt("source");_e.src=this._url[ue],_.appendChild(_e)}}});function Cn(f,_,M){return new Vr(f,_,M)}var En=bs.extend({_initImage:function(){var f=this._image=this._url;Mt(f,"leaflet-image-layer"),this._zoomAnimated&&Mt(f,"leaflet-zoom-animated"),this.options.className&&Mt(f,this.options.className),f.onselectstart=p,f.onmousemove=p}});function Tl(f,_,M){return new En(f,_,M)}var Bi=Ra.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,_){f&&(f instanceof ve||N(f))?(this._latlng=xe(f),S(this,_)):(S(this,f),this._source=_),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&Qn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&Qn(this._container,1),this.bringToFront(),this.options.interactive&&(Mt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(Qn(this._container,0),this._removeTimeout=setTimeout(o(dr,void 0,this._container),200)):dr(this._container),this.options.interactive&&(xr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=xe(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Fr(this._container),this},bringToBack:function(){return this._map&&Tr(this._container),this},_prepareOpen:function(f){var _=this._source;if(!_._map)return!1;if(_ instanceof Oi){_=null;var M=this._source._layers;for(var U in M)if(M[U]._map){_=M[U];break}if(!_)return!1;this._source=_}if(!f)if(_.getCenter)f=_.getCenter();else if(_.getLatLng)f=_.getLatLng();else if(_.getBounds)f=_.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,_=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof _=="string")f.innerHTML=_;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(_)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),_=ne(this.options.offset),M=this._getAnchor();this._zoomAnimated?wn(this._container,f.add(M)):_=_.add(f).add(M);var U=this._containerBottom=-_.y,ee=this._containerLeft=-Math.round(this._containerWidth/2)+_.x;this._container.style.bottom=U+"px",this._container.style.left=ee+"px"}},_getAnchor:function(){return[0,0]}});or.include({_initOverlay:function(f,_,M,U){var ee=_;return ee instanceof f||(ee=new f(U).setContent(_)),M&&ee.setLatLng(M),ee}}),Ra.include({_initOverlay:function(f,_,M,U){var ee=M;return ee instanceof f?(S(ee,U),ee._source=this):(ee=_&&!U?_:new f(U,this),ee.setContent(M)),ee}});var oo=Bi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,Bi.prototype.openOn.call(this,f)},onAdd:function(f){Bi.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Us||this._source.on("preclick",ms))},onRemove:function(f){Bi.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Us||this._source.off("preclick",ms))},getEvents:function(){var f=Bi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",_=this._container=lt("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),M=this._wrapper=lt("div",f+"-content-wrapper",_);if(this._contentNode=lt("div",f+"-content",M),hu(_),yl(this._contentNode),qt(_,"contextmenu",ms),this._tipContainer=lt("div",f+"-tip-container",_),this._tip=lt("div",f+"-tip",this._tipContainer),this.options.closeButton){var U=this._closeButton=lt("a",f+"-close-button",_);U.setAttribute("role","button"),U.setAttribute("aria-label","Close popup"),U.href="#close",U.innerHTML='<span aria-hidden="true">&#215;</span>',qt(U,"click",function(ee){$r(ee),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,_=f.style;_.width="",_.whiteSpace="nowrap";var M=f.offsetWidth;M=Math.min(M,this.options.maxWidth),M=Math.max(M,this.options.minWidth),_.width=M+1+"px",_.whiteSpace="",_.height="";var U=f.offsetHeight,ee=this.options.maxHeight,ue="leaflet-popup-scrolled";ee&&U>ee?(_.height=ee+"px",Mt(f,ue)):xr(f,ue),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var _=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),M=this._getAnchor();wn(this._container,_.add(M))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,_=parseInt(yr(this._container,"marginBottom"),10)||0,M=this._container.offsetHeight+_,U=this._containerWidth,ee=new J(this._containerLeft,-M-this._containerBottom);ee._add(zs(this._container));var ue=f.layerPointToContainerPoint(ee),_e=ne(this.options.autoPanPadding),Ae=ne(this.options.autoPanPaddingTopLeft||_e),De=ne(this.options.autoPanPaddingBottomRight||_e),$e=f.getSize(),pt=0,It=0;ue.x+U+De.x>$e.x&&(pt=ue.x+U-$e.x+De.x),ue.x-pt-Ae.x<0&&(pt=ue.x-Ae.x),ue.y+M+De.y>$e.y&&(It=ue.y+M-$e.y+De.y),ue.y-It-Ae.y<0&&(It=ue.y-Ae.y),(pt||It)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([pt,It]))}},_getAnchor:function(){return ne(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Pl=function(f,_){return new oo(f,_)};or.mergeOptions({closePopupOnClick:!0}),or.include({openPopup:function(f,_,M){return this._initOverlay(oo,f,_,M).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),Ra.include({bindPopup:function(f,_){return this._popup=this._initOverlay(oo,this._popup,f,_),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof Oi||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){Sn(f);var _=f.layer||f.target;if(this._popup._source===_&&!(_ instanceof Us)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=_,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var gn=Bi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){Bi.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){Bi.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=Bi.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",_=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=lt("div",_),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var _,M,U=this._map,ee=this._container,ue=U.latLngToContainerPoint(U.getCenter()),_e=U.layerPointToContainerPoint(f),Ae=this.options.direction,De=ee.offsetWidth,$e=ee.offsetHeight,pt=ne(this.options.offset),It=this._getAnchor();Ae==="top"?(_=De/2,M=$e):Ae==="bottom"?(_=De/2,M=0):Ae==="center"?(_=De/2,M=$e/2):Ae==="right"?(_=0,M=$e/2):Ae==="left"?(_=De,M=$e/2):_e.x<ue.x?(Ae="right",_=0,M=$e/2):(Ae="left",_=De+(pt.x+It.x)*2,M=$e/2),f=f.subtract(ne(_,M,!0)).add(pt).add(It),xr(ee,"leaflet-tooltip-right"),xr(ee,"leaflet-tooltip-left"),xr(ee,"leaflet-tooltip-top"),xr(ee,"leaflet-tooltip-bottom"),Mt(ee,"leaflet-tooltip-"+Ae),wn(ee,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&Qn(this._container,f)},_animateZoom:function(f){var _=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(_)},_getAnchor:function(){return ne(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),qo=function(f,_){return new gn(f,_)};or.include({openTooltip:function(f,_,M){return this._initOverlay(gn,f,_,M).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),Ra.include({bindTooltip:function(f,_){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(gn,this._tooltip,f,_),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var _=f?"off":"on",M={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?M.add=this._openTooltip:(M.mouseover=this._openTooltip,M.mouseout=this.closeTooltip,M.click=this._openTooltip,this._map?this._addFocusListeners():M.add=this._addFocusListeners),this._tooltip.options.sticky&&(M.mousemove=this._moveTooltip),this[_](M),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof Oi||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var _=typeof f.getElement=="function"&&f.getElement();_&&(qt(_,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),qt(_,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var _=typeof f.getElement=="function"&&f.getElement();_&&_.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var _=this;this._map.once("moveend",function(){_._openOnceFlag=!1,_._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var _=f.latlng,M,U;this._tooltip.options.sticky&&f.originalEvent&&(M=this._map.mouseEventToContainerPoint(f.originalEvent),U=this._map.containerPointToLayerPoint(M),_=this._map.layerPointToLatLng(U)),this._tooltip.setLatLng(_)}});var Ml=ca.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var _=f&&f.tagName==="DIV"?f:document.createElement("div"),M=this.options;if(M.html instanceof Element?(on(_),_.appendChild(M.html)):_.innerHTML=M.html!==!1?M.html:"",M.bgPos){var U=ne(M.bgPos);_.style.backgroundPosition=-U.x+"px "+-U.y+"px"}return this._setIconStyles(_,"icon"),_},createShadow:function(){return null}});function hc(f){return new Ml(f)}ca.Default=Uo;var ti=Ra.extend({options:{tileSize:256,opacity:1,updateWhenIdle:bt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){S(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),dr(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Fr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Tr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=c(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof J?f:new J(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var _=this.getPane().children,M=-f(-1/0,1/0),U=0,ee=_.length,ue;U<ee;U++)ue=_[U].style.zIndex,_[U]!==this._container&&ue&&(M=f(M,+ue));isFinite(M)&&(this.options.zIndex=M+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!bt.ielt9){Qn(this._container,this.options.opacity);var f=+new Date,_=!1,M=!1;for(var U in this._tiles){var ee=this._tiles[U];if(!(!ee.current||!ee.loaded)){var ue=Math.min(1,(f-ee.loaded)/200);Qn(ee.el,ue),ue<1?_=!0:(ee.active?M=!0:this._onOpaqueTile(ee),ee.active=!0)}}M&&!this._noPrune&&this._pruneTiles(),_&&(Y(this._fadeFrame),this._fadeFrame=$(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=lt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,_=this.options.maxZoom;if(f!==void 0){for(var M in this._levels)M=Number(M),this._levels[M].el.children.length||M===f?(this._levels[M].el.style.zIndex=_-Math.abs(f-M),this._onUpdateLevel(M)):(dr(this._levels[M].el),this._removeTilesAtZoom(M),this._onRemoveLevel(M),delete this._levels[M]);var U=this._levels[f],ee=this._map;return U||(U=this._levels[f]={},U.el=lt("div","leaflet-tile-container leaflet-zoom-animated",this._container),U.el.style.zIndex=_,U.origin=ee.project(ee.unproject(ee.getPixelOrigin()),f).round(),U.zoom=f,this._setZoomTransform(U,ee.getCenter(),ee.getZoom()),p(U.el.offsetWidth),this._onCreateLevel(U)),this._level=U,U}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var f,_,M=this._map.getZoom();if(M>this.options.maxZoom||M<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)_=this._tiles[f],_.retain=_.current;for(f in this._tiles)if(_=this._tiles[f],_.current&&!_.active){var U=_.coords;this._retainParent(U.x,U.y,U.z,U.z-5)||this._retainChildren(U.x,U.y,U.z,U.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var _ in this._tiles)this._tiles[_].coords.z===f&&this._removeTile(_)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)dr(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,_,M,U){var ee=Math.floor(f/2),ue=Math.floor(_/2),_e=M-1,Ae=new J(+ee,+ue);Ae.z=+_e;var De=this._tileCoordsToKey(Ae),$e=this._tiles[De];return $e&&$e.active?($e.retain=!0,!0):($e&&$e.loaded&&($e.retain=!0),_e>U?this._retainParent(ee,ue,_e,U):!1)},_retainChildren:function(f,_,M,U){for(var ee=2*f;ee<2*f+2;ee++)for(var ue=2*_;ue<2*_+2;ue++){var _e=new J(ee,ue);_e.z=M+1;var Ae=this._tileCoordsToKey(_e),De=this._tiles[Ae];if(De&&De.active){De.retain=!0;continue}else De&&De.loaded&&(De.retain=!0);M+1<U&&this._retainChildren(ee,ue,M+1,U)}},_resetView:function(f){var _=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),_,_)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var _=this.options;return _.minNativeZoom!==void 0&&f<_.minNativeZoom?_.minNativeZoom:_.maxNativeZoom!==void 0&&_.maxNativeZoom<f?_.maxNativeZoom:f},_setView:function(f,_,M,U){var ee=Math.round(_);this.options.maxZoom!==void 0&&ee>this.options.maxZoom||this.options.minZoom!==void 0&&ee<this.options.minZoom?ee=void 0:ee=this._clampZoom(ee);var ue=this.options.updateWhenZooming&&ee!==this._tileZoom;(!U||ue)&&(this._tileZoom=ee,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),ee!==void 0&&this._update(f),M||this._pruneTiles(),this._noPrune=!!M),this._setZoomTransforms(f,_)},_setZoomTransforms:function(f,_){for(var M in this._levels)this._setZoomTransform(this._levels[M],f,_)},_setZoomTransform:function(f,_,M){var U=this._map.getZoomScale(M,f.zoom),ee=f.origin.multiplyBy(U).subtract(this._map._getNewPixelOrigin(_,M)).round();bt.any3d?Za(f.el,ee,U):wn(f.el,ee)},_resetGrid:function(){var f=this._map,_=f.options.crs,M=this._tileSize=this.getTileSize(),U=this._tileZoom,ee=this._map.getPixelWorldBounds(this._tileZoom);ee&&(this._globalTileRange=this._pxBoundsToTileRange(ee)),this._wrapX=_.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,_.wrapLng[0]],U).x/M.x),Math.ceil(f.project([0,_.wrapLng[1]],U).x/M.y)],this._wrapY=_.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([_.wrapLat[0],0],U).y/M.x),Math.ceil(f.project([_.wrapLat[1],0],U).y/M.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var _=this._map,M=_._animatingZoom?Math.max(_._animateToZoom,_.getZoom()):_.getZoom(),U=_.getZoomScale(M,this._tileZoom),ee=_.project(f,this._tileZoom).floor(),ue=_.getSize().divideBy(U*2);return new W(ee.subtract(ue),ee.add(ue))},_update:function(f){var _=this._map;if(_){var M=this._clampZoom(_.getZoom());if(f===void 0&&(f=_.getCenter()),this._tileZoom!==void 0){var U=this._getTiledPixelBounds(f),ee=this._pxBoundsToTileRange(U),ue=ee.getCenter(),_e=[],Ae=this.options.keepBuffer,De=new W(ee.getBottomLeft().subtract([Ae,-Ae]),ee.getTopRight().add([Ae,-Ae]));if(!(isFinite(ee.min.x)&&isFinite(ee.min.y)&&isFinite(ee.max.x)&&isFinite(ee.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var $e in this._tiles){var pt=this._tiles[$e].coords;(pt.z!==this._tileZoom||!De.contains(new J(pt.x,pt.y)))&&(this._tiles[$e].current=!1)}if(Math.abs(M-this._tileZoom)>1){this._setView(f,M);return}for(var It=ee.min.y;It<=ee.max.y;It++)for(var Jt=ee.min.x;Jt<=ee.max.x;Jt++){var Ar=new J(Jt,It);if(Ar.z=this._tileZoom,!!this._isValidTile(Ar)){var Nn=this._tiles[this._tileCoordsToKey(Ar)];Nn?Nn.current=!0:_e.push(Ar)}}if(_e.sort(function(Ci,Ko){return Ci.distanceTo(ue)-Ko.distanceTo(ue)}),_e.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var mi=document.createDocumentFragment();for(Jt=0;Jt<_e.length;Jt++)this._addTile(_e[Jt],mi);this._level.el.appendChild(mi)}}}},_isValidTile:function(f){var _=this._map.options.crs;if(!_.infinite){var M=this._globalTileRange;if(!_.wrapLng&&(f.x<M.min.x||f.x>M.max.x)||!_.wrapLat&&(f.y<M.min.y||f.y>M.max.y))return!1}if(!this.options.bounds)return!0;var U=this._tileCoordsToBounds(f);return he(this.options.bounds).overlaps(U)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var _=this._map,M=this.getTileSize(),U=f.scaleBy(M),ee=U.add(M),ue=_.unproject(U,f.z),_e=_.unproject(ee,f.z);return[ue,_e]},_tileCoordsToBounds:function(f){var _=this._tileCoordsToNwSe(f),M=new ae(_[0],_[1]);return this.options.noWrap||(M=this._map.wrapLatLngBounds(M)),M},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var _=f.split(":"),M=new J(+_[0],+_[1]);return M.z=+_[2],M},_removeTile:function(f){var _=this._tiles[f];_&&(dr(_.el),delete this._tiles[f],this.fire("tileunload",{tile:_.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){Mt(f,"leaflet-tile");var _=this.getTileSize();f.style.width=_.x+"px",f.style.height=_.y+"px",f.onselectstart=p,f.onmousemove=p,bt.ielt9&&this.options.opacity<1&&Qn(f,this.options.opacity)},_addTile:function(f,_){var M=this._getTilePos(f),U=this._tileCoordsToKey(f),ee=this.createTile(this._wrapCoords(f),o(this._tileReady,this,f));this._initTile(ee),this.createTile.length<2&&$(o(this._tileReady,this,f,null,ee)),wn(ee,M),this._tiles[U]={el:ee,coords:f,current:!0},_.appendChild(ee),this.fire("tileloadstart",{tile:ee,coords:f})},_tileReady:function(f,_,M){_&&this.fire("tileerror",{error:_,tile:M,coords:f});var U=this._tileCoordsToKey(f);M=this._tiles[U],M&&(M.loaded=+new Date,this._map._fadeAnimated?(Qn(M.el,0),Y(this._fadeFrame),this._fadeFrame=$(this._updateOpacity,this)):(M.active=!0,this._pruneTiles()),_||(Mt(M.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:M.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),bt.ielt9||!this._map._fadeAnimated?$(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var _=new J(this._wrapX?d(f.x,this._wrapX):f.x,this._wrapY?d(f.y,this._wrapY):f.y);return _.z=f.z,_},_pxBoundsToTileRange:function(f){var _=this.getTileSize();return new W(f.min.unscaleBy(_).floor(),f.max.unscaleBy(_).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function ri(f){return new ti(f)}var Ia=ti.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,_){this._url=f,_=S(this,_),_.detectRetina&&bt.retina&&_.maxZoom>0?(_.tileSize=Math.floor(_.tileSize/2),_.zoomReverse?(_.zoomOffset--,_.minZoom=Math.min(_.maxZoom,_.minZoom+1)):(_.zoomOffset++,_.maxZoom=Math.max(_.minZoom,_.maxZoom-1)),_.minZoom=Math.max(0,_.minZoom)):_.zoomReverse?_.minZoom=Math.min(_.maxZoom,_.minZoom):_.maxZoom=Math.max(_.minZoom,_.maxZoom),typeof _.subdomains=="string"&&(_.subdomains=_.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,_){return this._url===f&&_===void 0&&(_=!0),this._url=f,_||this.redraw(),this},createTile:function(f,_){var M=document.createElement("img");return qt(M,"load",o(this._tileOnLoad,this,_,M)),qt(M,"error",o(this._tileOnError,this,_,M)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(M.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(M.referrerPolicy=this.options.referrerPolicy),M.alt="",M.src=this.getTileUrl(f),M},getTileUrl:function(f){var _={r:bt.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var M=this._globalTileRange.max.y-f.y;this.options.tms&&(_.y=M),_["-y"]=M}return C(this._url,a(_,this.options))},_tileOnLoad:function(f,_){bt.ielt9?setTimeout(o(f,this,null,_),0):f(null,_)},_tileOnError:function(f,_,M){var U=this.options.errorTileUrl;U&&_.getAttribute("src")!==U&&(_.src=U),f(M,_)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,_=this.options.maxZoom,M=this.options.zoomReverse,U=this.options.zoomOffset;return M&&(f=_-f),f+U},_getSubdomain:function(f){var _=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[_]},_abortLoading:function(){var f,_;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(_=this._tiles[f].el,_.onload=p,_.onerror=p,!_.complete)){_.src=R;var M=this._tiles[f].coords;dr(_),delete this._tiles[f],this.fire("tileabort",{tile:_,coords:M})}},_removeTile:function(f){var _=this._tiles[f];if(_)return _.el.setAttribute("src",R),ti.prototype._removeTile.call(this,f)},_tileReady:function(f,_,M){if(!(!this._map||M&&M.getAttribute("src")===R))return ti.prototype._tileReady.call(this,f,_,M)}});function xu(f,_){return new Ia(f,_)}var Wo=Ia.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,_){this._url=f;var M=a({},this.defaultWmsParams);for(var U in _)U in this.options||(M[U]=_[U]);_=S(this,_);var ee=_.detectRetina&&bt.retina?2:1,ue=this.getTileSize();M.width=ue.x*ee,M.height=ue.y*ee,this.wmsParams=M},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var _=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[_]=this._crs.code,Ia.prototype.onAdd.call(this,f)},getTileUrl:function(f){var _=this._tileCoordsToNwSe(f),M=this._crs,U=re(M.project(_[0]),M.project(_[1])),ee=U.min,ue=U.max,_e=(this._wmsVersion>=1.3&&this._crs===uc?[ee.y,ee.x,ue.y,ue.x]:[ee.x,ee.y,ue.x,ue.y]).join(","),Ae=Ia.prototype.getTileUrl.call(this,f);return Ae+k(this.wmsParams,Ae,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+_e},setParams:function(f,_){return a(this.wmsParams,f),_||this.redraw(),this}});function $d(f,_){return new Wo(f,_)}Ia.WMS=Wo,xu.wms=$d;var es=Ra.extend({options:{padding:.1},initialize:function(f){S(this,f),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Mt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,_){var M=this._map.getZoomScale(_,this._zoom),U=this._map.getSize().multiplyBy(.5+this.options.padding),ee=this._map.project(this._center,_),ue=U.multiplyBy(-M).add(ee).subtract(this._map._getNewPixelOrigin(f,_));bt.any3d?Za(this._container,ue,M):wn(this._container,ue)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,_=this._map.getSize(),M=this._map.containerPointToLayerPoint(_.multiplyBy(-f)).round();this._bounds=new W(M,M.add(_.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),fc=es.extend({options:{tolerance:0},getEvents:function(){var f=es.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){es.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");qt(f,"mousemove",this._onMouseMove,this),qt(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),qt(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){Y(this._redrawRequest),delete this._ctx,dr(this._container),Pr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var _ in this._layers)f=this._layers[_],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){es.prototype._update.call(this);var f=this._bounds,_=this._container,M=f.getSize(),U=bt.retina?2:1;wn(_,f.min),_.width=U*M.x,_.height=U*M.y,_.style.width=M.x+"px",_.style.height=M.y+"px",bt.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){es.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[u(f)]=f;var _=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=_),this._drawLast=_,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var _=f._order,M=_.next,U=_.prev;M?M.prev=U:this._drawLast=U,U?U.next=M:this._drawFirst=M,delete f._order,delete this._layers[u(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var _=f.options.dashArray.split(/[, ]+/),M=[],U,ee;for(ee=0;ee<_.length;ee++){if(U=Number(_[ee]),isNaN(U))return;M.push(U)}f.options._dashArray=M}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||$(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var _=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new W,this._redrawBounds.extend(f._pxBounds.min.subtract([_,_])),this._redrawBounds.extend(f._pxBounds.max.add([_,_]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var _=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,_.x,_.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,_=this._redrawBounds;if(this._ctx.save(),_){var M=_.getSize();this._ctx.beginPath(),this._ctx.rect(_.min.x,_.min.y,M.x,M.y),this._ctx.clip()}this._drawing=!0;for(var U=this._drawFirst;U;U=U.next)f=U.layer,(!_||f._pxBounds&&f._pxBounds.intersects(_))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,_){if(this._drawing){var M,U,ee,ue,_e=f._parts,Ae=_e.length,De=this._ctx;if(Ae){for(De.beginPath(),M=0;M<Ae;M++){for(U=0,ee=_e[M].length;U<ee;U++)ue=_e[M][U],De[U?"lineTo":"moveTo"](ue.x,ue.y);_&&De.closePath()}this._fillStroke(De,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var _=f._point,M=this._ctx,U=Math.max(Math.round(f._radius),1),ee=(Math.max(Math.round(f._radiusY),1)||U)/U;ee!==1&&(M.save(),M.scale(1,ee)),M.beginPath(),M.arc(_.x,_.y/ee,U,0,Math.PI*2,!1),ee!==1&&M.restore(),this._fillStroke(M,f)}},_fillStroke:function(f,_){var M=_.options;M.fill&&(f.globalAlpha=M.fillOpacity,f.fillStyle=M.fillColor||M.color,f.fill(M.fillRule||"evenodd")),M.stroke&&M.weight!==0&&(f.setLineDash&&f.setLineDash(_.options&&_.options._dashArray||[]),f.globalAlpha=M.opacity,f.lineWidth=M.weight,f.strokeStyle=M.color,f.lineCap=M.lineCap,f.lineJoin=M.lineJoin,f.stroke())},_onClick:function(f){for(var _=this._map.mouseEventToLayerPoint(f),M,U,ee=this._drawFirst;ee;ee=ee.next)M=ee.layer,M.options.interactive&&M._containsPoint(_)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(M))&&(U=M);this._fireEvent(U?[U]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var _=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,_)}},_handleMouseOut:function(f){var _=this._hoveredLayer;_&&(xr(this._container,"leaflet-interactive"),this._fireEvent([_],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,_){if(!this._mouseHoverThrottled){for(var M,U,ee=this._drawFirst;ee;ee=ee.next)M=ee.layer,M.options.interactive&&M._containsPoint(_)&&(U=M);U!==this._hoveredLayer&&(this._handleMouseOut(f),U&&(Mt(this._container,"leaflet-interactive"),this._fireEvent([U],f,"mouseover"),this._hoveredLayer=U)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,_,M){this._map._fireDOMEvent(_,M||_.type,f)},_bringToFront:function(f){var _=f._order;if(_){var M=_.next,U=_.prev;if(M)M.prev=U;else return;U?U.next=M:M&&(this._drawFirst=M),_.prev=this._drawLast,this._drawLast.next=_,_.next=null,this._drawLast=_,this._requestRedraw(f)}},_bringToBack:function(f){var _=f._order;if(_){var M=_.next,U=_.prev;if(U)U.next=M;else return;M?M.prev=U:U&&(this._drawLast=U),_.prev=null,_.next=this._drawFirst,this._drawFirst.prev=_,this._drawFirst=_,this._requestRedraw(f)}}});function pc(f){return bt.canvas?new fc(f):null}var $o=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Kd={_initContainer:function(){this._container=lt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(es.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var _=f._container=$o("shape");Mt(_,"leaflet-vml-shape "+(this.options.className||"")),_.coordsize="1 1",f._path=$o("path"),_.appendChild(f._path),this._updateStyle(f),this._layers[u(f)]=f},_addPath:function(f){var _=f._container;this._container.appendChild(_),f.options.interactive&&f.addInteractiveTarget(_)},_removePath:function(f){var _=f._container;dr(_),f.removeInteractiveTarget(_),delete this._layers[u(f)]},_updateStyle:function(f){var _=f._stroke,M=f._fill,U=f.options,ee=f._container;ee.stroked=!!U.stroke,ee.filled=!!U.fill,U.stroke?(_||(_=f._stroke=$o("stroke")),ee.appendChild(_),_.weight=U.weight+"px",_.color=U.color,_.opacity=U.opacity,U.dashArray?_.dashStyle=N(U.dashArray)?U.dashArray.join(" "):U.dashArray.replace(/( *, *)/g," "):_.dashStyle="",_.endcap=U.lineCap.replace("butt","flat"),_.joinstyle=U.lineJoin):_&&(ee.removeChild(_),f._stroke=null),U.fill?(M||(M=f._fill=$o("fill")),ee.appendChild(M),M.color=U.fillColor||U.color,M.opacity=U.fillOpacity):M&&(ee.removeChild(M),f._fill=null)},_updateCircle:function(f){var _=f._point.round(),M=Math.round(f._radius),U=Math.round(f._radiusY||M);this._setPath(f,f._empty()?"M0 0":"AL "+_.x+","+_.y+" "+M+","+U+" 0,"+65535*360)},_setPath:function(f,_){f._path.v=_},_bringToFront:function(f){Fr(f._container)},_bringToBack:function(f){Tr(f._container)}},Ba=bt.vml?$o:We,lo=es.extend({_initContainer:function(){this._container=Ba("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ba("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){dr(this._container),Pr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){es.prototype._update.call(this);var f=this._bounds,_=f.getSize(),M=this._container;(!this._svgSize||!this._svgSize.equals(_))&&(this._svgSize=_,M.setAttribute("width",_.x),M.setAttribute("height",_.y)),wn(M,f.min),M.setAttribute("viewBox",[f.min.x,f.min.y,_.x,_.y].join(" ")),this.fire("update")}},_initPath:function(f){var _=f._path=Ba("path");f.options.className&&Mt(_,f.options.className),f.options.interactive&&Mt(_,"leaflet-interactive"),this._updateStyle(f),this._layers[u(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){dr(f._path),f.removeInteractiveTarget(f._path),delete this._layers[u(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var _=f._path,M=f.options;_&&(M.stroke?(_.setAttribute("stroke",M.color),_.setAttribute("stroke-opacity",M.opacity),_.setAttribute("stroke-width",M.weight),_.setAttribute("stroke-linecap",M.lineCap),_.setAttribute("stroke-linejoin",M.lineJoin),M.dashArray?_.setAttribute("stroke-dasharray",M.dashArray):_.removeAttribute("stroke-dasharray"),M.dashOffset?_.setAttribute("stroke-dashoffset",M.dashOffset):_.removeAttribute("stroke-dashoffset")):_.setAttribute("stroke","none"),M.fill?(_.setAttribute("fill",M.fillColor||M.color),_.setAttribute("fill-opacity",M.fillOpacity),_.setAttribute("fill-rule",M.fillRule||"evenodd")):_.setAttribute("fill","none"))},_updatePoly:function(f,_){this._setPath(f,gt(f._parts,_))},_updateCircle:function(f){var _=f._point,M=Math.max(Math.round(f._radius),1),U=Math.max(Math.round(f._radiusY),1)||M,ee="a"+M+","+U+" 0 1,0 ",ue=f._empty()?"M0 0":"M"+(_.x-M)+","+_.y+ee+M*2+",0 "+ee+-M*2+",0 ";this._setPath(f,ue)},_setPath:function(f,_){f._path.setAttribute("d",_)},_bringToFront:function(f){Fr(f._path)},_bringToBack:function(f){Tr(f._path)}});bt.vml&&lo.include(Kd);function uo(f){return bt.svg||bt.vml?new lo(f):null}or.include({getRenderer:function(f){var _=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return _||(_=this._renderer=this._createRenderer()),this.hasLayer(_)||this.addLayer(_),_},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var _=this._paneRenderers[f];return _===void 0&&(_=this._createRenderer({pane:f}),this._paneRenderers[f]=_),_},_createRenderer:function(f){return this.options.preferCanvas&&pc(f)||uo(f)}});var Zd=da.extend({initialize:function(f,_){da.prototype.initialize.call(this,this._boundsToLatLngs(f),_)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=he(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function mc(f,_){return new Zd(f,_)}lo.create=Ba,lo.pointsToPath=gt,Di.geometryToLayer=Ja,Di.coordsToLatLng=El,Di.coordsToLatLngs=xs,Di.latLngToCoords=vu,Di.latLngsToCoords=Nl,Di.getFeature=Cr,Di.asFeature=Go,or.mergeOptions({boxZoom:!0});var Gs=Li.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){qt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Pr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){dr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),nr(),rc(),this._startPoint=this._map.mouseEventToContainerPoint(f),qt(document,{contextmenu:Sn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=lt("div","leaflet-zoom-box",this._container),Mt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var _=new W(this._point,this._startPoint),M=_.getSize();wn(this._box,_.min),this._box.style.width=M.x+"px",this._box.style.height=M.y+"px"},_finish:function(){this._moved&&(dr(this._box),xr(this._container,"leaflet-crosshair")),Fs(),nc(),Pr(document,{contextmenu:Sn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var _=new ae(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(_).fire("boxzoomend",{boxZoomBounds:_})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});or.addInitHook("addHandler","boxZoom",Gs),or.mergeOptions({doubleClickZoom:!0});var Yd=Li.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var _=this._map,M=_.getZoom(),U=_.options.zoomDelta,ee=f.originalEvent.shiftKey?M-U:M+U;_.options.doubleClickZoom==="center"?_.setZoom(ee):_.setZoomAround(f.containerPoint,ee)}});or.addInitHook("addHandler","doubleClickZoom",Yd),or.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var bu=Li.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new ln(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}Mt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){xr(this._map._container,"leaflet-grab"),xr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var _=he(this._map.options.maxBounds);this._offsetLimit=re(this._map.latLngToContainerPoint(_.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(_.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var _=this._lastTime=+new Date,M=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(M),this._times.push(_),this._prunePositions(_)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),_=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=_.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,_){return f-(f-_)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),_=this._offsetLimit;f.x<_.min.x&&(f.x=this._viscousLimit(f.x,_.min.x)),f.y<_.min.y&&(f.y=this._viscousLimit(f.y,_.min.y)),f.x>_.max.x&&(f.x=this._viscousLimit(f.x,_.max.x)),f.y>_.max.y&&(f.y=this._viscousLimit(f.y,_.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,_=Math.round(f/2),M=this._initialWorldOffset,U=this._draggable._newPos.x,ee=(U-_+M)%f+_-M,ue=(U+_+M)%f-_-M,_e=Math.abs(ee+M)<Math.abs(ue+M)?ee:ue;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=_e},_onDragEnd:function(f){var _=this._map,M=_.options,U=!M.inertia||f.noInertia||this._times.length<2;if(_.fire("dragend",f),U)_.fire("moveend");else{this._prunePositions(+new Date);var ee=this._lastPos.subtract(this._positions[0]),ue=(this._lastTime-this._times[0])/1e3,_e=M.easeLinearity,Ae=ee.multiplyBy(_e/ue),De=Ae.distanceTo([0,0]),$e=Math.min(M.inertiaMaxSpeed,De),pt=Ae.multiplyBy($e/De),It=$e/(M.inertiaDeceleration*_e),Jt=pt.multiplyBy(-It/2).round();!Jt.x&&!Jt.y?_.fire("moveend"):(Jt=_._limitOffset(Jt,_.options.maxBounds),$(function(){_.panBy(Jt,{duration:It,easeLinearity:_e,noMoveStart:!0,animate:!0})}))}}});or.addInitHook("addHandler","dragging",bu),or.mergeOptions({keyboard:!0,keyboardPanDelta:80});var gc=Li.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),qt(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Pr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,_=document.documentElement,M=f.scrollTop||_.scrollTop,U=f.scrollLeft||_.scrollLeft;this._map._container.focus(),window.scrollTo(U,M)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var _=this._panKeys={},M=this.keyCodes,U,ee;for(U=0,ee=M.left.length;U<ee;U++)_[M.left[U]]=[-1*f,0];for(U=0,ee=M.right.length;U<ee;U++)_[M.right[U]]=[f,0];for(U=0,ee=M.down.length;U<ee;U++)_[M.down[U]]=[0,f];for(U=0,ee=M.up.length;U<ee;U++)_[M.up[U]]=[0,-1*f]},_setZoomDelta:function(f){var _=this._zoomKeys={},M=this.keyCodes,U,ee;for(U=0,ee=M.zoomIn.length;U<ee;U++)_[M.zoomIn[U]]=f;for(U=0,ee=M.zoomOut.length;U<ee;U++)_[M.zoomOut[U]]=-f},_addHooks:function(){qt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Pr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var _=f.keyCode,M=this._map,U;if(_ in this._panKeys){if(!M._panAnim||!M._panAnim._inProgress)if(U=this._panKeys[_],f.shiftKey&&(U=ne(U).multiplyBy(3)),M.options.maxBounds&&(U=M._limitOffset(ne(U),M.options.maxBounds)),M.options.worldCopyJump){var ee=M.wrapLatLng(M.unproject(M.project(M.getCenter()).add(U)));M.panTo(ee)}else M.panBy(U)}else if(_ in this._zoomKeys)M.setZoom(M.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[_]);else if(_===27&&M._popup&&M._popup.options.closeOnEscapeKey)M.closePopup();else return;Sn(f)}}});or.addInitHook("addHandler","keyboard",gc),or.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Mr=Li.extend({addHooks:function(){qt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Pr(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var _=gs(f),M=this._map.options.wheelDebounceTime;this._delta+=_,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var U=Math.max(M-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),U),Sn(f)},_performZoom:function(){var f=this._map,_=f.getZoom(),M=this._map.options.zoomSnap||0;f._stop();var U=this._delta/(this._map.options.wheelPxPerZoomLevel*4),ee=4*Math.log(2/(1+Math.exp(-Math.abs(U))))/Math.LN2,ue=M?Math.ceil(ee/M)*M:ee,_e=f._limitZoom(_+(this._delta>0?ue:-ue))-_;this._delta=0,this._startTime=null,_e&&(f.options.scrollWheelZoom==="center"?f.setZoom(_+_e):f.setZoomAround(this._lastMousePos,_+_e))}});or.addInitHook("addHandler","scrollWheelZoom",Mr);var vc=600;or.mergeOptions({tapHold:bt.touchNative&&bt.safari&&bt.mobile,tapTolerance:15});var Al=Li.extend({addHooks:function(){qt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Pr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var _=f.touches[0];this._startPos=this._newPos=new J(_.clientX,_.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(qt(document,"touchend",$r),qt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",_))},this),vc),qt(document,"touchend touchcancel contextmenu",this._cancel,this),qt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){Pr(document,"touchend",$r),Pr(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),Pr(document,"touchend touchcancel contextmenu",this._cancel,this),Pr(document,"touchmove",this._onMove,this)},_onMove:function(f){var _=f.touches[0];this._newPos=new J(_.clientX,_.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,_){var M=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:_.screenX,screenY:_.screenY,clientX:_.clientX,clientY:_.clientY});M._simulated=!0,_.target.dispatchEvent(M)}});or.addInitHook("addHandler","tapHold",Al),or.mergeOptions({touchZoom:bt.touch,bounceAtZoomLimits:!0});var co=Li.extend({addHooks:function(){Mt(this._map._container,"leaflet-touch-zoom"),qt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){xr(this._map._container,"leaflet-touch-zoom"),Pr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var _=this._map;if(!(!f.touches||f.touches.length!==2||_._animatingZoom||this._zooming)){var M=_.mouseEventToContainerPoint(f.touches[0]),U=_.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=_.getSize()._divideBy(2),this._startLatLng=_.containerPointToLatLng(this._centerPoint),_.options.touchZoom!=="center"&&(this._pinchStartLatLng=_.containerPointToLatLng(M.add(U)._divideBy(2))),this._startDist=M.distanceTo(U),this._startZoom=_.getZoom(),this._moved=!1,this._zooming=!0,_._stop(),qt(document,"touchmove",this._onTouchMove,this),qt(document,"touchend touchcancel",this._onTouchEnd,this),$r(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var _=this._map,M=_.mouseEventToContainerPoint(f.touches[0]),U=_.mouseEventToContainerPoint(f.touches[1]),ee=M.distanceTo(U)/this._startDist;if(this._zoom=_.getScaleZoom(ee,this._startZoom),!_.options.bounceAtZoomLimits&&(this._zoom<_.getMinZoom()&&ee<1||this._zoom>_.getMaxZoom()&&ee>1)&&(this._zoom=_._limitZoom(this._zoom)),_.options.touchZoom==="center"){if(this._center=this._startLatLng,ee===1)return}else{var ue=M._add(U)._divideBy(2)._subtract(this._centerPoint);if(ee===1&&ue.x===0&&ue.y===0)return;this._center=_.unproject(_.project(this._pinchStartLatLng,this._zoom).subtract(ue),this._zoom)}this._moved||(_._moveStart(!0,!1),this._moved=!0),Y(this._animRequest);var _e=o(_._move,_,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=$(_e,this,!0),$r(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Y(this._animRequest),Pr(document,"touchmove",this._onTouchMove,this),Pr(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});or.addInitHook("addHandler","touchZoom",co),or.BoxZoom=Gs,or.DoubleClickZoom=Yd,or.Drag=bu,or.Keyboard=gc,or.ScrollWheelZoom=Mr,or.TapHold=Al,or.TouchZoom=co,n.Bounds=W,n.Browser=bt,n.CRS=se,n.Canvas=fc,n.Circle=Ho,n.CircleMarker=Oa,n.Class=q,n.Control=Fn,n.DivIcon=Ml,n.DivOverlay=Bi,n.DomEvent=xl,n.DomUtil=ir,n.Draggable=ln,n.Evented=Q,n.FeatureGroup=Oi,n.GeoJSON=Di,n.GridLayer=ti,n.Handler=Li,n.Icon=ca,n.ImageOverlay=bs,n.LatLng=ve,n.LatLngBounds=ae,n.Layer=Ra,n.LayerGroup=ys,n.LineUtil=Fo,n.Map=or,n.Marker=fi,n.Mixin=mu,n.Path=Us,n.Point=J,n.PolyUtil=rf,n.Polygon=da,n.Polyline=pi,n.Popup=oo,n.PosAnimation=pu,n.Projection=lc,n.Rectangle=Zd,n.Renderer=es,n.SVG=lo,n.SVGOverlay=En,n.TileLayer=Ia,n.Tooltip=gn,n.Transformation=me,n.Util=D,n.VideoOverlay=Vr,n.bind=o,n.bounds=re,n.canvas=pc,n.circle=Cl,n.circleMarker=Hs,n.control=aa,n.divIcon=hc,n.extend=a,n.featureGroup=ua,n.geoJSON=dc,n.geoJson=Ii,n.gridLayer=ri,n.icon=cc,n.imageOverlay=so,n.latLng=xe,n.latLngBounds=he,n.layerGroup=Vo,n.map=Jn,n.marker=Wd,n.point=ne,n.polygon=Da,n.polyline=sf,n.popup=Pl,n.rectangle=mc,n.setOptions=S,n.stamp=u,n.svg=uo,n.svgOverlay=Tl,n.tileLayer=xu,n.tooltip=qo,n.transformation=be,n.version=i,n.videoOverlay=Cn;var Xd=window.L;n.noConflict=function(){return window.L=Xd,this},window.L=n}))})(dg,dg.exports)),dg.exports}var md=jV();const Lx=Kh(md);function aS(r,e,n){return Object.freeze({instance:r,context:e,container:n})}function AM(r,e){return e==null?function(i,a){const s=ce.useRef();return s.current||(s.current=r(i,a)),s}:function(i,a){const s=ce.useRef();s.current||(s.current=r(i,a));const o=ce.useRef(i),{instance:l}=s.current;return ce.useEffect(function(){o.current!==i&&(e(l,i,o.current),o.current=i)},[l,i,a]),s}}function RV(r,e){ce.useEffect(function(){return(e.layerContainer??e.map).addLayer(r.instance),function(){e.layerContainer?.removeLayer(r.instance),e.map.removeLayer(r.instance)}},[e,r])}function LV(r){return function(n){const i=iS(),a=r(MM(n,i),i);return CM(i.map,n.attribution),PM(a.current,n.eventHandlers),RV(a.current,i),a}}function jM(r,e){const n=AM(r,e),i=LV(n);return TV(i)}function OV(r,e){const n=AM(r),i=MV(n,e);return PV(i)}function DV(r,e,n){e.bounds instanceof md.LatLngBounds&&e.bounds!==n.bounds&&r.setBounds(e.bounds),e.opacity!=null&&e.opacity!==n.opacity&&r.setOpacity(e.opacity),e.zIndex!=null&&e.zIndex!==n.zIndex&&r.setZIndex(e.zIndex)}function IV(){return iS().map}const BV=jM(function({bounds:e,url:n,...i},a){const s=new md.ImageOverlay(n,e,i);return aS(s,EM(a,{overlayContainer:s}))},function(e,n,i){if(DV(e,n,i),n.bounds!==i.bounds){const a=n.bounds instanceof md.LatLngBounds?n.bounds:new md.LatLngBounds(n.bounds);e.setBounds(a)}n.url!==i.url&&e.setUrl(n.url)});function z2(){return z2=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},z2.apply(this,arguments)}function zV({bounds:r,boundsOptions:e,center:n,children:i,className:a,id:s,placeholder:o,style:l,whenReady:u,zoom:c,...d},p){const[v]=ce.useState({className:a,id:s,style:l}),[y,b]=ce.useState(null);ce.useImperativeHandle(p,()=>y?.map??null,[y]);const S=ce.useCallback(T=>{if(T!==null&&y===null){const C=new md.Map(T,d);n!=null&&c!=null?C.setView(n,c):r!=null&&C.fitBounds(r,e),u!=null&&C.whenReady(u),b(NV(C))}},[]);ce.useEffect(()=>()=>{y?.map.remove()},[y]);const k=y?Xt.createElement(TM,{value:y},i):o??null;return Xt.createElement("div",z2({},v,{ref:S}),k)}const FV=ce.forwardRef(zV),VV=jM(function({position:e,...n},i){const a=new md.Marker(e,n);return aS(a,EM(i,{overlayContainer:a}))},function(e,n,i){n.position!==i.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==i.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==i.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==i.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==i.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),UV=OV(function(e,n){const i=new md.Popup(e,n.overlayContainer);return aS(i,n)},function(e,n,{position:i},a){ce.useEffect(function(){const{instance:o}=e;function l(c){c.popup===o&&(o.update(),a(!0))}function u(c){c.popup===o&&a(!1)}return n.map.on({popupopen:l,popupclose:u}),n.overlayContainer==null?(i!=null&&o.setLatLng(i),o.openOn(n.map)):n.overlayContainer.bindPopup(o),function(){n.map.off({popupopen:l,popupclose:u}),n.overlayContainer?.unbindPopup(),n.map.removeLayer(o)}},[e,n,a,i])});delete Lx.Icon.Default.prototype._getIconUrl;Lx.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const HV=(r="default")=>{const e=`
        <div class="custom-marker-icon marker-${r}">
            <span class="material-symbols-outlined" style="font-size: 18px; color: white;">
                ${GV(r)}
            </span>
        </div>
    `;return Lx.divIcon({html:e,className:"custom-leaflet-marker",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]})},GV=r=>{const e={city:"location_city",dungeon:"castle",landmark:"place",battle:"swords",default:"location_on"};return e[r]||e.default},qV=({bounds:r})=>{const e=IV();return Xt.useEffect(()=>{r&&e.fitBounds(r)},[e,r]),null},WV=({mapImage:r,markers:e=[],onMarkerClick:n,imageWidth:i=1920,imageHeight:a=1080})=>{const s=ce.useMemo(()=>[[0,0],[a,i]],[i,a]),o=ce.useMemo(()=>[a/2,i/2],[i,a]),l=e.length>0?e:[];return m.jsxs("div",{className:"w-full h-full relative",children:[m.jsxs(FV,{center:o,zoom:0,minZoom:-2,maxZoom:3,crs:Lx.CRS.Simple,style:{height:"100%",width:"100%",background:"#0a0a0c"},zoomControl:!0,attributionControl:!1,children:[r&&m.jsx(BV,{url:r,bounds:s,opacity:1}),m.jsx(qV,{bounds:s}),l.map((u,c)=>{const d=u.position||[a/2,i/2];return m.jsx(VV,{position:d,icon:HV(u.type),eventHandlers:{click:()=>{n&&n(u)}},children:m.jsx(UV,{children:m.jsxs("div",{className:"space-y-2",children:[m.jsx("h3",{className:"text-white font-bold",children:u.label||"Unnamed Location"}),u.description&&m.jsx("p",{className:"text-slate-400 text-sm",children:u.description}),u.entityId&&m.jsxs("a",{href:`#/entity/${u.entityId}`,className:"text-primary hover:underline text-sm inline-flex items-center gap-1",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"}),"View Details"]})]})})},u.id||c)})]}),l.length>0&&m.jsxs("div",{className:"absolute bottom-4 left-4 bg-surface-dark/90 backdrop-blur-xl border border-white/10 rounded-2xl p-4 max-w-xs z-[1000]",children:[m.jsxs("h4",{className:"text-white font-bold text-sm mb-2 flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-primary",children:"map"}),"Locations (",l.length,")"]}),m.jsxs("div",{className:"space-y-1 max-h-40 overflow-y-auto no-scrollbar",children:[l.slice(0,10).map((u,c)=>m.jsxs("div",{className:"text-xs text-slate-400 flex items-center gap-2 hover:text-white cursor-pointer transition-colors",onClick:()=>n&&n(u),children:[m.jsx("span",{className:"w-2 h-2 rounded-full bg-primary"}),u.label||`Location ${c+1}`]},u.id||c)),l.length>10&&m.jsxs("p",{className:"text-xs text-slate-500 italic",children:["+",l.length-10," more..."]})]})]})]})},$V=({map:r})=>{const{t:e}=Xu(),[n,i]=ce.useState(null),a=r?.nombre||e("maps.explorer"),s=r?.attributes||{};let o={};if(!s.bgImage&&r?.descripcion&&r?.descripcion.startsWith("{"))try{o=JSON.parse(r.descripcion)}catch{}const l=s.bgImage||o.bgImage||r?.iconUrl||null,u=s.markers||[],c=s.imageWidth||1920,d=s.imageHeight||1080,p=v=>{i(v),console.log("Marker clicked:",v)};return m.jsxs("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300 relative",children:[m.jsxs("main",{className:"flex-1 overflow-hidden relative group",children:[m.jsx("div",{className:"absolute inset-4 rounded-[2.5rem] overflow-hidden border border-white/5 shadow-2xl bg-surface-dark",children:l?m.jsx(WV,{mapImage:l,markers:u,onMarkerClick:p,imageWidth:c,imageHeight:d}):m.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500",children:m.jsxs("div",{className:"text-center space-y-4",children:[m.jsx("span",{className:"material-symbols-outlined text-6xl opacity-20",children:"map"}),m.jsx("p",{children:e("maps.not_found")}),m.jsx("p",{className:"text-xs text-slate-600",children:e("maps.upload_desc")})]})})}),m.jsx("div",{className:"absolute top-8 left-8 z-[1000]",children:m.jsx(Lr,{className:"px-6 py-3 border-white/10",children:m.jsxs("h1",{className:"text-2xl font-black text-white tracking-tight flex items-center gap-3",children:[m.jsx("span",{className:"material-symbols-outlined text-primary",children:"public"}),a]})})}),m.jsxs("div",{className:"absolute top-8 right-8 z-[1000] flex gap-3",children:[m.jsx("button",{className:"size-12 rounded-xl bg-surface-dark/90 backdrop-blur-xl border border-white/10 flex items-center justify-center text-slate-400 hover:text-white hover:border-primary/50 transition-all shadow-lg",title:e("maps.fullscreen"),children:m.jsx("span",{className:"material-symbols-outlined",children:"fullscreen"})}),m.jsx("button",{className:"size-12 rounded-xl bg-surface-dark/90 backdrop-blur-xl border border-white/10 flex items-center justify-center text-slate-400 hover:text-white hover:border-primary/50 transition-all shadow-lg",title:e("maps.share"),children:m.jsx("span",{className:"material-symbols-outlined",children:"share"})})]})]}),m.jsx("aside",{className:`flex-none bg-surface-dark border-l border-white/5 transition-all duration-700 relative z-30 ${n?"w-96 p-8 opacity-100":"w-0 p-0 opacity-0 overflow-hidden"}`,children:n&&m.jsxs("div",{className:"flex flex-col h-full gap-8 animate-in slide-in-from-right-8 duration-500",children:[m.jsxs("header",{className:"space-y-6",children:[m.jsxs("div",{className:"relative aspect-[4/3] rounded-3xl overflow-hidden border border-white/10 shadow-xl group",children:[m.jsx("img",{src:"https://images.unsplash.com/photo-1533154683836-84ea7a0bc310?auto=format&fit=crop&w=500&q=80",alt:"Detail",className:"w-full h-full object-cover grayscale-[0.4] group-hover:grayscale-0 transition-all duration-700"}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background-dark via-transparent to-transparent"}),m.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:m.jsx("button",{onClick:()=>i(null),className:"size-8 rounded-lg bg-black/40 border border-white/10 backdrop-blur-md text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})}),m.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[m.jsx("span",{className:"px-3 py-1 rounded bg-primary/20 text-primary border border-primary/20 text-[8px] font-black uppercase tracking-widest backdrop-blur-md",children:e("maps.place")}),m.jsx("span",{className:"px-3 py-1 rounded bg-emerald-500/20 text-emerald-400 border border-emerald-500/20 text-[8px] font-black uppercase tracking-widest backdrop-blur-md",children:e("maps.capital")})]})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsx("h2",{className:"text-3xl font-manrope font-black text-white tracking-tight leading-none",children:n.label||n.name}),m.jsx("button",{className:"text-slate-500 hover:text-white transition-colors p-2 rounded-xl hover:bg-white/5",children:m.jsx("span",{className:"material-symbols-outlined",children:"edit"})})]}),m.jsx("p",{className:"text-sm text-slate-400 leading-relaxed font-manrope",children:n.description||"No description available"})]})]}),m.jsxs("div",{className:"space-y-8 flex-1 overflow-y-auto no-scrollbar",children:[m.jsxs("section",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-center px-1",children:[m.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:e("maps.inhabitants")}),m.jsx("button",{className:"text-[10px] font-bold text-primary hover:underline transition-all",children:e("maps.view_all")})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsx(Q5,{name:"Lyra Ignis",role:"Gran Maga"}),m.jsx(Q5,{name:"Kaelen",role:"Capitn de la Guardia"})]})]}),m.jsxs("section",{className:"space-y-4",children:[m.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 px-1",children:e("maps.related_events")}),m.jsx(Lr,{className:"p-4 border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:m.jsxs("div",{className:"flex gap-4 items-center",children:[m.jsx("div",{className:"size-10 rounded-xl bg-amber-500/10 text-amber-500 border border-amber-500/20 flex items-center justify-center",children:m.jsx("span",{className:"material-symbols-outlined text-xl",children:"history_edu"})}),m.jsxs("div",{children:[m.jsx("h4",{className:"text-xs font-bold text-white group-hover:text-primary transition-colors",children:"El Asedio de Ceniza"}),m.jsx("p",{className:"text-[10px] text-slate-500 font-medium",children:"Hace 300 aos"})]})]})})]})]}),m.jsx("footer",{className:"pt-6 border-t border-white/5",children:m.jsx(nn,{variant:"primary",icon:"auto_stories",className:"w-full py-4 rounded-2xl shadow-xl shadow-primary/20",children:e("maps.open_bible")})})]})})]})},Q5=({name:r,role:e})=>m.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:[m.jsx(ny,{name:r,size:"sm",className:"border-white/10 group-hover:border-primary/50 transition-all"}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("h4",{className:"text-xs font-bold text-white truncate",children:r}),m.jsx("p",{className:"text-[10px] text-slate-500 font-medium truncate",children:e})]}),m.jsx("span",{className:"material-symbols-outlined text-slate-700 text-sm group-hover:text-white transition-colors",children:"chevron_right"})]}),KV=({maps:r,onSelect:e,onCreateNew:n,onClose:i})=>m.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-xl animate-in fade-in duration-300",children:m.jsx("div",{className:"w-full max-w-3xl animate-in zoom-in-95 duration-500",children:m.jsxs(Lr,{className:"overflow-hidden border-white/10 shadow-2xl",children:[m.jsxs("header",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("span",{className:"material-symbols-outlined text-primary",children:"map"}),m.jsx("h2",{className:"text-xl font-manrope font-black text-white",children:"Cartografa del Proyecto"})]}),m.jsx("button",{onClick:i,className:"text-slate-500 hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),m.jsxs("div",{className:"p-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[60vh] overflow-y-auto custom-scrollbar",children:[m.jsxs("div",{onClick:n,className:"group p-6 rounded-2xl border-2 border-dashed border-white/5 hover:border-primary/50 hover:bg-primary/5 transition-all cursor-pointer flex flex-col items-center justify-center text-center gap-3",children:[m.jsx("div",{className:"size-12 rounded-full bg-primary/10 text-primary flex items-center justify-center group-hover:scale-110 transition-transform",children:m.jsx("span",{className:"material-symbols-outlined",children:"add"})}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-bold text-white",children:"Nuevo Mapa"}),m.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-tighter",children:"Crear desde cero"})]})]}),r.map(a=>{const s=a.attributes?.snapshotUrl||a.attributes?.bgImage||a.iconUrl;return m.jsxs("div",{onClick:()=>e(a),className:"group p-4 rounded-2xl bg-white/5 border border-white/5 hover:border-primary/50 hover:bg-white/10 transition-all cursor-pointer space-y-3",children:[m.jsx("div",{className:"aspect-video rounded-xl bg-surface-light border border-white/5 flex items-center justify-center overflow-hidden",children:s?m.jsx("img",{src:s,alt:a.nombre,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}):m.jsx("span",{className:"material-symbols-outlined text-4xl opacity-20 group-hover:opacity-40 transition-opacity",children:"image"})}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-bold text-white truncate",children:a.nombre}),m.jsxs("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-tighter",children:[a.attributes?.layers?.length||0," capas"]})]})]},a.id)})]}),m.jsx("footer",{className:"p-6 bg-white/[0.02] border-t border-white/5 flex justify-end",children:m.jsx("p",{className:"text-[10px] text-slate-600 font-bold uppercase tracking-widest",children:"Selecciona un mapa para cargar el visor"})})]})})}),ZV=()=>{const{username:r,projectName:e}=Yi(),n=Na(),[i,a]=ce.useState("viewer"),[s,o]=ce.useState([]),[l,u]=ce.useState(null),[c,d]=ce.useState(!1),[p,v]=ce.useState(null);Xt.useEffect(()=>{y()},[]);const y=async()=>{try{const k=(await rt.get("/world-bible/entities")).filter(T=>T.tipoEspecial==="map");o(k),k.length>0&&!l&&u(k[0])}catch(S){console.error("Error loading maps",S)}},b=async(S,k,T)=>{try{const C=await rt.get("/world-bible/folders"),N=C.find(R=>R.nombre.toLowerCase().includes("map"))||C[0];if(!N){console.error("No folders available to create map");return}const P=await rt.post("/world-bible/entities",{nombre:k,carpetaId:N.id,tipoEspecial:"map",categoria:"Location",descripcion:"",iconUrl:"",attributes:{mapType:"regional",layers:[]}});v(P.id),a("wizard"),d(!1),await y(),setTimeout(()=>{a("editor")},100)}catch(C){console.error("Error creating map:",C)}};return m.jsxs("div",{className:"flex-1 flex flex-col h-full bg-background-dark overflow-hidden",children:[i==="viewer"&&m.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[m.jsx("button",{onClick:()=>d(!0),className:"absolute right-12 bottom-12 z-50 size-16 rounded-3xl bg-primary text-white flex items-center justify-center shadow-2xl shadow-primary/40 hover:scale-110 active:scale-95 transition-all group",children:m.jsx("span",{className:"material-symbols-outlined text-3xl group-hover:rotate-90 transition-transform duration-300",children:"add"})}),m.jsx($V,{map:l}),c&&m.jsx(KV,{maps:s,onSelect:S=>{u(S),d(!1)},onCreateNew:()=>{d(!1),a("wizard")},onClose:()=>d(!1)})]}),i==="wizard"&&m.jsx(Ez,{onCancel:()=>a("viewer"),onCreate:b}),i==="editor"&&m.jsx(B2,{mode:p?"create":"edit",entityId:p,onBack:()=>{a("viewer"),v(null)},onSave:async()=>{await y(),p?n(`/local/${e}/entity/${p}`):a("viewer"),v(null)}})]})},YV=()=>{const{t:r}=Xu(),[e,n]=ce.useState("Loading..."),[i,a]=ce.useState({words:0,rules:0,glyphs:0}),[s,o]=ce.useState("Standard Tongue");ce.useEffect(()=>{l()},[]);const l=async()=>{try{const u=await rt.get("/bd/proyecto-activo");n(u.nombreProyecto);const c=await rt.get("/conlang/stats");a(c);const d=await rt.get("/conlang/lenguas");d&&d.length>0&&o(d[0].nombre)}catch(u){console.error("Error loading conlang data:",u),n("Default Project")}};return m.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#0a0a0f] text-slate-300 font-sans overflow-y-auto no-scrollbar p-12 lg:p-16 gap-16",children:[m.jsxs("header",{className:"space-y-6",children:[m.jsxs("nav",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-slate-500",children:[m.jsx("span",{children:e}),m.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),m.jsxs("span",{className:"text-white",children:[r("linguistics.title"),": ",s]})]}),m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{className:"space-y-4 max-w-2xl",children:[m.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:s}),m.jsx("p",{className:"text-lg text-slate-400 leading-relaxed",children:r("linguistics.desc",{projectName:e})}),m.jsxs("div",{className:"flex gap-4 pt-2",children:[m.jsx("span",{className:"px-3 py-1 rounded bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[9px] font-black uppercase tracking-widest",children:"Complete: 45%"}),m.jsx("span",{className:"px-3 py-1 rounded bg-primary/10 text-primary border border-primary/20 text-[9px] font-black uppercase tracking-widest",children:"Type: Agglutinative"})]})]}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("div",{className:"flex items-center gap-3 text-slate-500 border-r border-white/5 pr-6 mr-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm animate-pulse text-emerald-500",children:"save"}),m.jsx("span",{className:"text-[10px] font-bold",children:r("linguistics.auto_saved")}),m.jsx("span",{className:"material-symbols-outlined hover:text-white transition-colors cursor-pointer",children:"dark_mode"})]}),m.jsx(nn,{variant:"primary",icon:"add",size:"md",children:r("common.create")})]})]})]}),m.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-12",children:[m.jsxs("section",{className:"xl:col-span-2 space-y-8",children:[m.jsxs("div",{className:"flex justify-between items-center px-2",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"menu_book"}),m.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:r("linguistics.lexicon")})]}),m.jsxs("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest hover:text-primary transition-all cursor-pointer",children:[r("common.view_all")," (",i.words,")"]})]}),m.jsxs(Lr,{className:"p-0 border-white/5 bg-surface-dark/40 overflow-hidden shadow-2xl",children:[m.jsxs("div",{className:"p-4 border-b border-white/5 flex items-center gap-4",children:[m.jsxs("div",{className:"flex-1 relative",children:[m.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 text-lg",children:"search"}),m.jsx("input",{type:"text",placeholder:r("linguistics.search_lexicon"),className:"w-full bg-white/5 border border-white/5 rounded-2xl py-3 pl-12 pr-4 text-xs focus:ring-1 focus:ring-primary/30 outline-none transition-all"})]}),m.jsx("button",{className:"size-10 rounded-xl bg-white/5 border border-white/5 flex items-center justify-center text-slate-500 hover:text-white transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-xl",children:"tune"})})]}),m.jsxs("div",{className:"p-6 space-y-4",children:[m.jsx(Pw,{word:"Ael'or",type:"noun",gender:"neutral",def:"Starlight; specifically the light from the twin moons."}),m.jsx(Pw,{word:"Vexi",type:"verb",gender:"transitive",def:"To weave magic; to create something from nothing."}),m.jsx(Pw,{word:"Dra'kan",type:"adj",gender:"",def:"Ancient; belonging to the era of dragons."})]}),m.jsx("div",{className:"p-6 bg-black/20 border-t border-white/5",children:m.jsxs("button",{className:"w-full py-4 rounded-3xl border-2 border-dashed border-white/5 text-slate-600 hover:text-white hover:border-primary/50 hover:bg-primary/5 transition-all text-[10px] font-black uppercase tracking-[0.2em] flex items-center justify-center gap-3",children:[m.jsx("span",{className:"material-symbols-outlined",children:"add"}),r("linguistics.new_word")]})})]})]}),m.jsxs("section",{className:"space-y-8",children:[m.jsxs("div",{className:"flex justify-between items-center px-2",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"architecture"}),m.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:r("linguistics.grammar")})]}),m.jsx("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest hover:text-primary transition-all cursor-pointer",children:r("linguistics.manage")})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsx(J5,{title:"Sentence Structure",status:"active",statusColor:"emerald",desc:"Standard order is SOV (Subject-Object-Verb), but poetry uses VSO for emphasis on action.",tags:["Syntax","Basic"]}),m.jsx(J5,{title:"Noun Declensions",status:"pending",statusColor:"amber",desc:"Seven cases marked by suffixes. Pluralization shifts the stress to the final syllable.",tags:["Morphology"]}),m.jsxs("button",{className:"w-full h-32 rounded-[2.5rem] border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-2 text-slate-600 hover:text-white hover:border-primary/30 hover:bg-primary/5 transition-all",children:[m.jsx("span",{className:"material-symbols-outlined",children:"add_circle"}),m.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:r("linguistics.new_rule")})]})]})]})]}),m.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-12",children:[m.jsxs("section",{className:"space-y-8",children:[m.jsxs("div",{className:"flex justify-between items-center px-2",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"draw"}),m.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:r("linguistics.writing_system")})]}),m.jsxs("div",{className:"flex gap-2 text-slate-600",children:[m.jsx("button",{className:"p-1 rounded hover:bg-white/5 hover:text-white",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_view"})}),m.jsx("button",{className:"p-1 rounded hover:bg-white/5 hover:text-white",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"title"})})]})]}),m.jsxs(Lr,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-8 shadow-2xl",children:[m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{children:[m.jsx("h4",{className:"text-2xl font-black text-white tracking-tight mb-1",children:r("linguistics.moon_script")}),m.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Abugida  Left-to-Right"})]}),m.jsx(nn,{variant:"secondary",size:"sm",className:"bg-primary/10 border-primary/20 text-primary",children:r("linguistics.open_editor")})]}),m.jsxs("div",{className:"grid grid-cols-6 gap-3",children:[["","","","",""].map(u=>m.jsx("div",{className:"aspect-square rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-3xl font-serif text-white hover:bg-white/10 transition-all cursor-pointer",children:u},u)),m.jsx("div",{className:"aspect-square rounded-2xl border-2 border-dashed border-white/5 flex items-center justify-center text-slate-600 hover:border-primary/50 hover:text-white transition-all cursor-pointer",children:m.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between text-[8px] font-black uppercase tracking-widest text-slate-600",children:[m.jsx("span",{children:"Glyph Set"}),m.jsx("span",{children:"24/32 Completed"})]}),m.jsx("div",{className:"h-1.5 w-full bg-white/5 rounded-full overflow-hidden",children:m.jsx("div",{className:"h-full bg-primary w-[75%] rounded-full shadow-[0_0_10px_rgba(99,102,242,0.5)]"})})]})]})]}),m.jsxs("section",{className:"space-y-8",children:[m.jsxs("div",{className:"flex items-center gap-3 px-2",children:[m.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"graphic_eq"}),m.jsxs("h3",{className:"text-xl font-bold text-white tracking-tight",children:[r("linguistics.translator")," & ",r("linguistics.phonology")]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[m.jsxs(Lr,{className:"p-8 border-primary/20 bg-primary/5 rounded-[3rem] space-y-6 shadow-2xl shadow-primary/10",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary",children:r("linguistics.live_stream")}),m.jsx("span",{className:"material-symbols-outlined text-primary animate-pulse",children:"sync_alt"})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("input",{type:"text",placeholder:r("linguistics.source_text"),className:"w-full bg-black/40 border border-white/10 rounded-2xl p-4 text-xs font-bold text-white focus:border-primary/50 outline-none transition-all"}),m.jsxs("div",{className:"h-24 rounded-2xl bg-black/60 border border-white/5 flex items-center justify-center relative overflow-hidden group",children:[m.jsx("span",{className:"text-5xl font-serif text-white opacity-40 group-hover:opacity-100 transition-opacity",children:"   "}),m.jsx("div",{className:"absolute top-2 right-4 text-[7px] font-black uppercase tracking-widest text-slate-700",children:r("linguistics.rendered_output")})]})]})]}),m.jsxs(Lr,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-6",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:r("linguistics.inventory")}),m.jsx("button",{className:"text-primary text-lg",children:m.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),m.jsx("div",{className:"flex flex-wrap gap-2",children:["/a/","/e/","/i/","/o/","/u/","/y/"].map(u=>m.jsx("div",{className:"px-3 py-1.5 rounded-xl bg-white/5 border border-white/5 text-[11px] font-mono font-bold text-slate-300 hover:text-white transition-colors cursor-pointer",children:u},u))})]}),m.jsxs(Lr,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-6",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:r("linguistics.vectors")}),m.jsx("button",{className:"text-[8px] font-bold text-primary hover:underline transition-all",children:r("linguistics.upload_svg")})]}),m.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[[{id:1,icon:"filter_vintage"},{id:2,icon:"auto_awesome"},{id:3,icon:"infinite"}].map(u=>m.jsx("div",{className:"aspect-square rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-slate-400 hover:text-white transition-all cursor-pointer",children:m.jsx("span",{className:"material-symbols-outlined text-2xl",children:u.icon})},u.id)),m.jsxs("div",{className:"aspect-square rounded-2xl border-2 border-dashed border-white/5 flex flex-col items-center justify-center text-slate-700 hover:border-primary/50 hover:text-white transition-all cursor-pointer",children:[m.jsx("span",{className:"material-symbols-outlined text-lg",children:"cloud_upload"}),m.jsx("span",{className:"text-[7px] font-bold uppercase mt-1",children:r("common.create")})]})]})]})]})]})]})]})},Pw=({word:r,type:e,gender:n,def:i})=>m.jsxs("div",{className:"p-4 rounded-2xl border border-transparent hover:bg-white/5 hover:border-white/5 transition-all group cursor-pointer relative",children:[m.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[m.jsx("h4",{className:"text-xl font-manrope font-black text-white group-hover:text-primary transition-colors",children:r}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("span",{className:"text-[9px] font-bold text-slate-600 italic",children:e}),n&&m.jsxs("span",{className:"text-[9px] font-bold text-slate-700 uppercase",children:["(",n,")"]})]})]}),m.jsx("p",{className:"text-sm text-slate-400 leading-relaxed font-manrope",children:i}),m.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity p-2 text-slate-600 hover:text-white",children:m.jsx("span",{className:"material-symbols-outlined",children:"edit_note"})})]}),J5=({title:r,status:e,statusColor:n,desc:i,tags:a})=>m.jsxs(Lr,{className:"p-8 border-white/5 hover:border-white/10 transition-all cursor-pointer group space-y-4",children:[m.jsxs("header",{className:"flex justify-between items-start",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:`size-2 rounded-full bg-${n}-500 shadow-[0_0_10px_rgba(var(--${n}-rgb),0.5)]`}),m.jsx("h4",{className:"font-bold text-white group-hover:text-primary transition-colors",children:r})]}),m.jsx("button",{className:"text-slate-700 hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})]}),m.jsx("p",{className:"text-[11px] text-slate-500 leading-relaxed font-manrope",children:i}),m.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(s=>m.jsx("span",{className:"px-2 py-0.5 rounded bg-white/5 border border-white/5 text-[8px] font-black uppercase tracking-widest text-slate-600",children:s},s))})]}),XV=()=>m.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#050B0D] text-[#00E5FF] font-mono overflow-hidden",children:[m.jsxs("header",{className:"h-20 border-b border-[#00E5FF]/20 flex items-center justify-between px-10 bg-black/40 backdrop-blur-xl",children:[m.jsxs("div",{className:"flex items-center gap-10",children:[m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"text-[10px] opacity-40 uppercase tracking-[0.4em] font-bold",children:"Datastream_Nav"}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("span",{className:"material-symbols-outlined text-2xl",children:"language"}),m.jsx("span",{className:"text-2xl font-black italic tracking-tighter",children:"Chronos Atlas"})]})]}),m.jsxs("div",{className:"flex items-center gap-4 border-l border-[#00E5FF]/20 pl-10",children:[m.jsx("span",{className:"text-3xl font-black tracking-[0.2em] italic opacity-80",children:"DIGITAL RUNE COMPILER"}),m.jsx("div",{className:"px-3 py-1 rounded-sm bg-[#00E5FF]/10 border border-[#00E5FF]/30 text-[10px] font-black uppercase tracking-widest animate-pulse",children:"Data Ready"})]})]}),m.jsxs("div",{className:"flex items-center gap-8",children:[m.jsxs("div",{className:"flex items-center gap-2 opacity-60 hover:opacity-100 transition-opacity cursor-pointer",children:[m.jsx("span",{className:"material-symbols-outlined text-lg",children:"help"}),m.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Protocol"})]}),m.jsxs("button",{className:"flex items-center gap-3 px-6 py-2.5 bg-[#00E5FF] text-black font-black uppercase text-xs tracking-widest rounded-sm hover:shadow-[0_0_20px_rgba(0,229,255,0.4)] transition-all",children:[m.jsx("span",{className:"material-symbols-outlined",children:"save"}),"Commit Data"]}),m.jsx("div",{className:"size-10 rounded-full bg-gradient-to-tr from-[#00E5FF] to-blue-600 border border-white/20 shadow-lg"})]})]}),m.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[m.jsxs("main",{className:"flex-1 flex flex-col p-12 gap-12 overflow-y-auto no-scrollbar relative",children:[m.jsx("div",{className:"absolute top-0 left-0 w-full h-[2px] bg-white/5 overflow-hidden",children:m.jsx("div",{className:"h-full bg-[#00E5FF] w-[64%] shadow-[0_0_10px_#00E5FF]"})}),m.jsxs("section",{className:"space-y-6",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:"size-2 bg-[#00E5FF] rounded-full shadow-[0_0_10px_#00E5FF]"}),m.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.4em]",children:"Glyph Set (Scan)"})]}),m.jsxs("div",{className:"flex gap-4 opacity-40",children:[m.jsx("span",{className:"material-symbols-outlined text-xl",children:"grid_view"}),m.jsx("span",{className:"material-symbols-outlined text-xl",children:"view_list"})]})]}),m.jsxs("div",{className:"p-10 rounded-sm border border-[#00E5FF]/10 bg-[#00E5FF]/[0.02] grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-6",children:[m.jsx(Wl,{symbol:"",keyLabel:"A"}),m.jsx(Wl,{symbol:"",keyLabel:"B"}),m.jsx(Wl,{symbol:"",keyLabel:"C"}),m.jsx(Wl,{symbol:"",keyLabel:"D",active:!0}),m.jsx(Wl,{}),m.jsx(Wl,{}),m.jsx(Wl,{}),m.jsx(Wl,{}),m.jsx(Wl,{}),m.jsx(Wl,{}),m.jsx("div",{className:"aspect-square rounded shadow-inner border border-dashed border-[#00E5FF]/20 flex items-center justify-center hover:bg-[#00E5FF]/5 transition-colors cursor-pointer group",children:m.jsx("span",{className:"material-symbols-outlined opacity-20 group-hover:opacity-100 transition-opacity",children:"add"})})]}),m.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-[0.2em] opacity-40",children:[m.jsx("span",{children:"26 Glyphs Mapped"}),m.jsxs("div",{className:"flex gap-10",children:[m.jsxs("button",{className:"hover:text-[#00E5FF] flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"tune"})," Manage"]}),m.jsxs("button",{className:"hover:text-[#00E5FF] flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"settings_input_component"})," Ranges"]})]})]})]}),m.jsxs("section",{className:"flex-1 flex flex-col gap-6",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:"size-2 bg-[#00E5FF] rounded-full shadow-[0_0_10px_#00E5FF] opacity-40"}),m.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.4em] opacity-40",children:"Live Preview Stream"})]}),m.jsxs("div",{className:"flex-1 rounded-sm border border-[#00E5FF]/10 bg-black/40 flex flex-col p-12 items-center justify-center relative group min-h-[300px]",children:[m.jsx("div",{className:"absolute top-4 left-4 text-[8px] opacity-20 uppercase tracking-widest font-black",children:"Buffer Status: Active"}),m.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none text-center text-7xl font-bold tracking-widest text-[#00E5FF]/10 group-hover:text-[#00E5FF]/40 transition-all placeholder:text-[#00E5FF]/5 resize-none italic",placeholder:"Input your data stream here..."}),m.jsxs("div",{className:"absolute bottom-6 right-8 flex gap-6 text-[8px] font-black uppercase tracking-widest opacity-20",children:[m.jsx("span",{children:"48px"}),m.jsx("span",{children:"Regular"}),m.jsx("span",{children:"UTF-8"})]}),m.jsx("div",{className:"absolute inset-x-12 top-1/2 h-px bg-[#00E5FF]/10 -translate-y-1/2 pointer-events-none"})]})]})]}),m.jsxs("aside",{className:"w-[450px] border-l border-[#00E5FF]/10 p-10 flex flex-col gap-10 bg-black/40 backdrop-blur-xl relative z-20",children:[m.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.4em] opacity-60 mb-2",children:"Configuration Matrix"}),m.jsxs(Lr,{className:"p-8 border-[#00E5FF]/20 bg-[#00E5FF]/[0.02] space-y-8 rounded-sm",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Font Name"}),m.jsx("input",{type:"text",defaultValue:"NEURALINK CIPHER",className:"w-full bg-black/60 border border-[#00E5FF]/30 px-6 py-4 text-xs font-black text-[#00E5FF] focus:border-[#00E5FF] outline-none transition-all tracking-widest uppercase italic"})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Author / Metadata"}),m.jsx("input",{type:"text",placeholder:"YOUR SYNTHETIC ID",className:"w-full bg-black/60 border border-[#00E5FF]/30 px-6 py-4 text-xs font-black text-[#00E5FF] focus:border-[#00E5FF] outline-none transition-all tracking-widest uppercase italic"})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Format"}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsx("button",{className:"py-4 border border-[#00E5FF] bg-[#00E5FF]/10 text-[#00E5FF] text-xs font-black tracking-widest shadow-[0_0_15px_rgba(0,229,255,0.2)]",children:".TTF"}),m.jsx("button",{className:"py-4 border border-[#00E5FF]/20 text-[#00E5FF]/40 text-xs font-black tracking-widest hover:border-[#00E5FF]/40 transition-all",children:".OTF"})]})]}),m.jsxs("div",{className:"pt-4 space-y-6",children:[m.jsx(eT,{label:"Ligatures",active:!0}),m.jsx(eT,{label:"Kerning",active:!0})]}),m.jsxs("button",{className:"w-full py-6 mt-6 bg-gradient-to-r from-blue-600 to-fuchsia-500 text-white font-black uppercase text-xs tracking-[0.3em] flex items-center justify-center gap-4 hover:shadow-[0_0_30px_rgba(255,0,255,0.3)] transition-all animate-pulse",children:[m.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Compile & Download"]})]}),m.jsxs("div",{className:"flex-1 flex flex-col gap-6 opacity-30 pointer-events-none",children:[m.jsxs("div",{className:"flex justify-between text-[10px] uppercase font-black",children:[m.jsx("span",{children:"Compiler Logs"}),m.jsx("span",{children:"V2.0.4"})]}),m.jsxs("div",{className:"flex-1 border border-[#00E5FF]/10 bg-black/20 p-6 flex flex-col font-mono text-[9px] gap-2 overflow-hidden",children:[m.jsx("p",{children:"[SCN] Initializing Glyph Buffer..."}),m.jsx("p",{children:"[MAP] Vector data detected for U+0394"}),m.jsx("p",{children:"[SYS] Memory allocation optimized"}),m.jsx("p",{className:"animate-pulse",children:"_"})]})]})]})]})]}),Wl=({symbol:r,keyLabel:e,active:n})=>m.jsxs("div",{className:`aspect-square rounded border transition-all cursor-pointer flex items-center justify-center relative group ${n?"bg-[#00E5FF]/20 border-[#00E5FF] shadow-[0_0_20px_rgba(0,229,255,0.3)]":"bg-black/40 border-[#00E5FF]/10 hover:border-[#00E5FF]/40"}`,children:[m.jsx("span",{className:`text-3xl font-serif ${n?"text-white":"opacity-20 group-hover:opacity-60"}`,children:r||"..."}),e&&m.jsx("span",{className:`absolute top-1 right-1 text-[8px] font-black uppercase ${n?"text-[#00E5FF]/80":"opacity-20"}`,children:e})]}),eT=({label:r,active:e})=>m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-60",children:r}),m.jsx("button",{className:`w-12 h-6 rounded-full p-1 transition-colors relative ${e?"bg-[#00E5FF]/40":"bg-white/5"}`,children:m.jsx("div",{className:`size-4 rounded-full bg-[#00E5FF] shadow-[0_0_10px_#00E5FF] transition-transform ${e?"translate-x-6":"translate-x-0"}`})})]}),QV=({onBack:r,onSave:e})=>{const[n,i]=ce.useState(4),[a,s]=ce.useState("curve"),[o,l]=ce.useState(1),u=[{id:"select",icon:"near_me"},{id:"curve",icon:"gesture"},{id:"eraser",icon:"ink_eraser"},{id:"line",icon:"horizontal_rule"},{id:"shape",icon:"pentagon"},{id:"text",icon:"title"}],c=[{id:1,name:"Trazo Principal",type:"Vector",locked:!0,visible:!0},{id:2,name:"Detalles Secundarios",type:"Vector",locked:!0,visible:!0},{id:3,name:"Boceto Ref.",type:"Imagen (Raster)",locked:!0,visible:!1}];return m.jsxs("div",{className:"flex-1 flex flex-col bg-[#0a0a0f] text-slate-300 font-sans h-full overflow-hidden relative",children:[m.jsxs("header",{className:"h-20 flex-none border-b border-white/5 flex items-center justify-between px-8 bg-surface-dark/80 backdrop-blur-md z-30",children:[m.jsxs("div",{className:"flex items-center gap-6",children:[m.jsx("button",{onClick:r,className:"p-2 rounded-xl bg-white/5 hover:bg-white/10 transition-colors",children:m.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),m.jsx("div",{className:"w-px h-8 bg-white/10"}),m.jsxs("div",{children:[m.jsxs("nav",{className:"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-slate-500 mb-0.5",children:[m.jsx("span",{children:"Idiomas"}),m.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),m.jsx("span",{className:"text-white",children:"Editor Grfico"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("div",{className:"flex items-center gap-4 text-slate-500",children:[m.jsx("button",{className:"hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-xl",children:"undo"})}),m.jsx("button",{className:"hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-xl",children:"redo"})})]}),m.jsx("div",{className:"w-px h-4 bg-white/10 mx-2"}),m.jsxs("div",{className:"flex gap-1",children:[m.jsx("button",{className:"p-1 rounded hover:bg-white/5 text-slate-500 hover:text-white",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_on"})}),m.jsx("button",{className:"p-1 rounded bg-white/10 text-primary",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})})]})]})]})]}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("button",{className:"flex items-center gap-2 px-6 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 transition-all text-xs font-black uppercase tracking-widest text-slate-400",children:[m.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Exportar SVG"]}),m.jsx(nn,{variant:"primary",icon:"save",className:"px-8 py-3 shadow-xl shadow-primary/30",onClick:e,children:"Guardar Glifo"}),m.jsx("div",{className:"size-10 rounded-full bg-gradient-to-br from-primary to-orange-400 border-2 border-white/10 shadow-lg ml-2"})]})]}),m.jsxs("div",{className:"flex-1 flex relative overflow-hidden",children:[m.jsxs("aside",{className:"h-full w-20 flex-none border-r border-white/5 bg-surface-dark/40 backdrop-blur-xl flex flex-col items-center py-6 gap-2 z-40",children:[u.map(d=>m.jsx("button",{onClick:()=>s(d.id),className:`size-12 rounded-2xl flex items-center justify-center transition-all ${a===d.id?"bg-primary text-white shadow-lg shadow-primary/30":"text-slate-600 hover:text-white hover:bg-white/5"}`,children:m.jsx("span",{className:"material-symbols-outlined text-2xl",children:d.icon})},d.id)),m.jsx("div",{className:"flex-1"}),m.jsx("button",{className:"size-12 rounded-2xl flex items-center justify-center text-slate-600 hover:text-white transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-2xl",children:"add_photo_alternate"})}),m.jsx("button",{className:"size-12 rounded-2xl flex items-center justify-center text-slate-600 hover:text-white transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-2xl",children:"settings"})})]}),m.jsxs("main",{className:"flex-1 bg-[#050508] relative overflow-hidden flex items-center justify-center no-scrollbar",children:[m.jsx("div",{className:"absolute inset-x-20 top-1/2 h-px bg-red-500/20 pointer-events-none"}),m.jsxs("div",{className:"relative group animate-in zoom-in-95 duration-700",children:[m.jsx("div",{className:"absolute inset-x-0 top-10 h-px bg-white/10"}),m.jsx("div",{className:"absolute inset-x-0 bottom-10 h-px bg-white/10"}),m.jsxs("div",{className:"w-[600px] h-[600px] border border-white/5 rounded-3xl bg-black/40 flex items-center justify-center relative overflow-hidden",children:[m.jsxs("svg",{width:"400",height:"400",className:"drop-shadow-[0_0_20px_rgba(99,102,242,0.5)] scale-125",children:[m.jsx("circle",{cx:"200",cy:"230",r:"100",fill:"none",stroke:"#6366f1",strokeWidth:"6",strokeLinecap:"round"}),m.jsx("line",{x1:"200",y1:"230",x2:"200",y2:"380",stroke:"#6366f1",strokeWidth:"6",strokeLinecap:"round"}),m.jsx("circle",{cx:"200",cy:"230",r:"4",fill:"white"}),m.jsx("rect",{x:"196",y:"376",width:"8",height:"8",fill:"white"}),m.jsx("rect",{x:"96",y:"226",width:"8",height:"8",fill:"#6366f1"}),m.jsx("rect",{x:"296",y:"226",width:"8",height:"8",fill:"#6366f1"}),m.jsx("rect",{x:"136",y:"160",width:"6",height:"6",fill:"#6366f1",className:"opacity-40"}),m.jsx("rect",{x:"256",y:"160",width:"6",height:"6",fill:"#6366f1",className:"opacity-40"})]}),m.jsx("div",{className:"absolute top-[160px] left-[136px] size-1 border border-primary/40 border-dashed w-[20px] h-[100px] pointer-events-none"}),m.jsx("div",{className:"absolute top-[160px] right-[136px] size-1 border border-primary/40 border-dashed w-[20px] h-[100px] pointer-events-none"})]})]}),m.jsx("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2",children:m.jsxs(Lr,{className:"px-6 py-2.5 flex items-center gap-6 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[m.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"remove"})}),m.jsx("span",{className:"text-[10px] font-black text-white w-12 text-center uppercase tracking-widest",children:"120%"}),m.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-lg",children:"add"})})]})})]}),m.jsxs("aside",{className:"w-96 flex-none flex flex-col p-10 gap-10 bg-surface-dark/20 backdrop-blur-xl border-l border-white/5 z-40 overflow-y-auto no-scrollbar",children:[m.jsxs("section",{className:"space-y-6",children:[m.jsxs("header",{className:"flex justify-between items-center group cursor-pointer",children:[m.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Propiedades"}),m.jsx("span",{className:"material-symbols-outlined text-slate-700 text-sm",children:"more_horiz"})]}),m.jsxs(Lr,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[2rem] space-y-8",children:[m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Grosor de Trazo"}),m.jsxs("span",{className:"px-2 py-0.5 rounded bg-white/5 text-[10px] font-black text-white",children:[n,"px"]})]}),m.jsx("input",{type:"range",min:"1",max:"20",value:n,onChange:d=>i(d.target.value),className:"w-full accent-primary h-1 bg-white/5 rounded-full appearance-none cursor-pointer"})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 block ml-1",children:"Color / Relleno"}),m.jsxs("div",{className:"flex items-center gap-4 bg-black/40 rounded-2xl p-4 border border-white/5",children:[m.jsx("div",{className:"size-10 rounded-full bg-primary shadow-[0_0_15px_rgba(99,102,242,0.4)] border-2 border-white/20"}),m.jsx("input",{type:"text",defaultValue:"#2F2CED",className:"bg-transparent border-none outline-none text-xs font-mono text-slate-300 w-full"})]})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 block ml-1",children:"Terminacin (Cap)"}),m.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[m.jsx(Mw,{icon:"square"}),m.jsx(Mw,{icon:"circle",active:!0}),m.jsx(Mw,{icon:"rectangle"})]})]}),m.jsxs("button",{className:"w-full py-4 rounded-2xl bg-white/5 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-3 hover:bg-white/10 transition-all",children:[m.jsx("span",{className:"material-symbols-outlined text-lg",children:"gesture"}),"Suavizar Trazo"]})]})]}),m.jsxs("section",{className:"flex-1 flex flex-col gap-6",children:[m.jsxs("header",{className:"flex justify-between items-center",children:[m.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Capas"}),m.jsx("button",{className:"p-1 rounded bg-white/5 text-slate-500 hover:text-white transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})]}),m.jsx("div",{className:"space-y-3 overflow-y-auto no-scrollbar flex-1",children:c.map(d=>m.jsxs("div",{onClick:()=>l(d.id),className:`flex items-center gap-4 p-4 rounded-2xl transition-all cursor-pointer group ${o===d.id?"bg-primary/10 border border-primary/20":"bg-white/[0.02] border border-white/5 opacity-60 hover:opacity-100 hover:border-white/10"}`,children:[m.jsx("button",{className:"material-symbols-outlined text-sm text-slate-500 hover:text-white",children:d.visible?"visibility":"visibility_off"}),m.jsx("div",{className:"size-10 rounded-xl bg-black border border-white/10 flex items-center justify-center",children:m.jsx("span",{className:"material-symbols-outlined text-slate-600 group-hover:text-primary transition-colors text-xl",children:d.type.includes("Vector")?"timeline":"image"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("h4",{className:"text-xs font-bold text-white truncate",children:d.name}),m.jsx("p",{className:"text-[9px] text-slate-600 font-bold uppercase tracking-widest",children:d.type})]}),m.jsx("button",{className:"material-symbols-outlined text-slate-700 text-sm",children:"lock"})]},d.id))}),m.jsxs("div",{className:"flex gap-4 p-3 rounded-2xl bg-black/20 border border-white/5",children:[m.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})}),m.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-xl",children:"content_copy"})}),m.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-xl",children:"folder"})})]})]}),m.jsxs("div",{className:"p-6 rounded-[2rem] bg-gradient-to-br from-primary/20 to-orange-500/20 border border-white/10 space-y-4",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("span",{className:"material-symbols-outlined text-primary",children:"auto_fix_high"}),m.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-white",children:"Vectorizacin Inteligente"})]}),m.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-manrope",children:"Arrastra una imagen para convertirla automticamente en nodos editables."}),m.jsx(nn,{variant:"primary",size:"sm",className:"w-full text-[9px] py-3 rounded-xl shadow-lg",children:"Importar y Procesar"})]})]})]})]})},Mw=({icon:r,active:e})=>m.jsx("button",{className:`py-4 rounded-xl border transition-all flex items-center justify-center ${e?"bg-primary/20 border-primary shadow-lg shadow-primary/20":"bg-white/5 border-white/5 hover:border-white/10"}`,children:m.jsx("span",{className:`material-symbols-outlined text-lg ${e?"text-white":"text-slate-600"}`,children:r})}),JV=()=>{const[r,e]=ce.useState("hub");return m.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#050508] overflow-hidden",children:[r==="hub"&&m.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[m.jsx("button",{onClick:()=>e("foundry"),className:"absolute right-12 bottom-12 z-50 size-16 rounded-3xl bg-primary text-white flex items-center justify-center shadow-2xl shadow-primary/40 hover:scale-110 active:scale-95 transition-all group",title:"Glyph Foundry",children:m.jsx("span",{className:"material-symbols-outlined text-3xl group-hover:rotate-12 transition-transform duration-300",children:"font_download"})}),m.jsx(YV,{onOpenEditor:()=>e("editor")})]}),r==="foundry"&&m.jsx(XV,{onBack:()=>e("hub")}),r==="editor"&&m.jsx(QV,{onBack:()=>e("hub"),onSave:()=>e("hub")})]})};var Aw={exports:{}},jw={};var tT;function eU(){if(tT)return jw;tT=1;var r=Cp();function e(p,v){return p===v&&(p!==0||1/p===1/v)||p!==p&&v!==v}var n=typeof Object.is=="function"?Object.is:e,i=r.useState,a=r.useEffect,s=r.useLayoutEffect,o=r.useDebugValue;function l(p,v){var y=v(),b=i({inst:{value:y,getSnapshot:v}}),S=b[0].inst,k=b[1];return s(function(){S.value=y,S.getSnapshot=v,u(S)&&k({inst:S})},[p,y,v]),a(function(){return u(S)&&k({inst:S}),p(function(){u(S)&&k({inst:S})})},[p]),o(y),y}function u(p){var v=p.getSnapshot;p=p.value;try{var y=v();return!n(p,y)}catch{return!0}}function c(p,v){return v()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:l;return jw.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:d,jw}var rT;function RM(){return rT||(rT=1,Aw.exports=eU()),Aw.exports}var LM=RM();function wa(r){this.content=r}wa.prototype={constructor:wa,find:function(r){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===r)return e;return-1},get:function(r){var e=this.find(r);return e==-1?void 0:this.content[e+1]},update:function(r,e,n){var i=n&&n!=r?this.remove(n):this,a=i.find(r),s=i.content.slice();return a==-1?s.push(n||r,e):(s[a+1]=e,n&&(s[a]=n)),new wa(s)},remove:function(r){var e=this.find(r);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new wa(n)},addToStart:function(r,e){return new wa([r,e].concat(this.remove(r).content))},addToEnd:function(r,e){var n=this.remove(r).content.slice();return n.push(r,e),new wa(n)},addBefore:function(r,e,n){var i=this.remove(e),a=i.content.slice(),s=i.find(r);return a.splice(s==-1?a.length:s,0,e,n),new wa(a)},forEach:function(r){for(var e=0;e<this.content.length;e+=2)r(this.content[e],this.content[e+1])},prepend:function(r){return r=wa.from(r),r.size?new wa(r.content.concat(this.subtract(r).content)):this},append:function(r){return r=wa.from(r),r.size?new wa(this.subtract(r).content.concat(r.content)):this},subtract:function(r){var e=this;r=wa.from(r);for(var n=0;n<r.content.length;n+=2)e=e.remove(r.content[n]);return e},toObject:function(){var r={};return this.forEach(function(e,n){r[e]=n}),r},get size(){return this.content.length>>1}};wa.from=function(r){if(r instanceof wa)return r;var e=[];if(r)for(var n in r)e.push(n,r[n]);return new wa(e)};function OM(r,e,n){for(let i=0;;i++){if(i==r.childCount||i==e.childCount)return r.childCount==e.childCount?null:n;let a=r.child(i),s=e.child(i);if(a==s){n+=a.nodeSize;continue}if(!a.sameMarkup(s))return n;if(a.isText&&a.text!=s.text){for(let o=0;a.text[o]==s.text[o];o++)n++;return n}if(a.content.size||s.content.size){let o=OM(a.content,s.content,n+1);if(o!=null)return o}n+=a.nodeSize}}function DM(r,e,n,i){for(let a=r.childCount,s=e.childCount;;){if(a==0||s==0)return a==s?null:{a:n,b:i};let o=r.child(--a),l=e.child(--s),u=o.nodeSize;if(o==l){n-=u,i-=u;continue}if(!o.sameMarkup(l))return{a:n,b:i};if(o.isText&&o.text!=l.text){let c=0,d=Math.min(o.text.length,l.text.length);for(;c<d&&o.text[o.text.length-c-1]==l.text[l.text.length-c-1];)c++,n--,i--;return{a:n,b:i}}if(o.content.size||l.content.size){let c=DM(o.content,l.content,n-1,i-1);if(c)return c}n-=u,i-=u}}class Qe{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let i=0;i<e.length;i++)this.size+=e[i].nodeSize}nodesBetween(e,n,i,a=0,s){for(let o=0,l=0;l<n;o++){let u=this.content[o],c=l+u.nodeSize;if(c>e&&i(u,a+l,s||null,o)!==!1&&u.content.size){let d=l+1;u.nodesBetween(Math.max(0,e-d),Math.min(u.content.size,n-d),i,a+d)}l=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,i,a){let s="",o=!0;return this.nodesBetween(e,n,(l,u)=>{let c=l.isText?l.text.slice(Math.max(e,u)-u,n-u):l.isLeaf?a?typeof a=="function"?a(l):a:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&c||l.isTextblock)&&i&&(o?o=!1:s+=i),s+=c},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,i=e.firstChild,a=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(i)&&(a[a.length-1]=n.withText(n.text+i.text),s=1);s<e.content.length;s++)a.push(e.content[s]);return new Qe(a,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let i=[],a=0;if(n>e)for(let s=0,o=0;o<n;s++){let l=this.content[s],u=o+l.nodeSize;u>e&&((o<e||u>n)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,n-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,n-o-1))),i.push(l),a+=l.nodeSize),o=u}return new Qe(i,a)}cutByIndex(e,n){return e==n?Qe.empty:e==0&&n==this.content.length?this:new Qe(this.content.slice(e,n))}replaceChild(e,n){let i=this.content[e];if(i==n)return this;let a=this.content.slice(),s=this.size+n.nodeSize-i.nodeSize;return a[e]=n,new Qe(a,s)}addToStart(e){return new Qe([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Qe(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,i=0;n<this.content.length;n++){let a=this.content[n];e(a,i,n),i+=a.nodeSize}}findDiffStart(e,n=0){return OM(this,e,n)}findDiffEnd(e,n=this.size,i=e.size){return DM(this,e,n,i)}findIndex(e){if(e==0)return _0(0,e);if(e==this.size)return _0(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,i=0;;n++){let a=this.child(n),s=i+a.nodeSize;if(s>=e)return s==e?_0(n+1,s):_0(n,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return Qe.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new Qe(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Qe.empty;let n,i=0;for(let a=0;a<e.length;a++){let s=e[a];i+=s.nodeSize,a&&s.isText&&e[a-1].sameMarkup(s)?(n||(n=e.slice(0,a)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new Qe(n||e,i)}static from(e){if(!e)return Qe.empty;if(e instanceof Qe)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Qe([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Qe.empty=new Qe([],0);const Rw={index:0,offset:0};function _0(r,e){return Rw.index=r,Rw.offset=e,Rw}function yy(r,e){if(r===e)return!0;if(!(r&&typeof r=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(r);if(Array.isArray(e)!=n)return!1;if(n){if(r.length!=e.length)return!1;for(let i=0;i<r.length;i++)if(!yy(r[i],e[i]))return!1}else{for(let i in r)if(!(i in e)||!yy(r[i],e[i]))return!1;for(let i in e)if(!(i in r))return!1}return!0}let tn=class F2{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,i=!1;for(let a=0;a<e.length;a++){let s=e[a];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,a));else{if(s.type.excludes(this.type))return e;!i&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,a)),n.push(this),i=!0),n&&n.push(s)}}return n||(n=e.slice()),i||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&yy(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let i=e.marks[n.type];if(!i)throw new RangeError(`There is no mark type ${n.type} in this schema`);let a=i.create(n.attrs);return i.checkAttrs(a.attrs),a}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].eq(n[i]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return F2.none;if(e instanceof F2)return[e];let n=e.slice();return n.sort((i,a)=>i.type.rank-a.type.rank),n}};tn.none=[];class xy extends Error{}class St{constructor(e,n,i){this.content=e,this.openStart=n,this.openEnd=i}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let i=BM(this.content,e+this.openStart,n);return i&&new St(i,this.openStart,this.openEnd)}removeBetween(e,n){return new St(IM(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return St.empty;let i=n.openStart||0,a=n.openEnd||0;if(typeof i!="number"||typeof a!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new St(Qe.fromJSON(e,n.content),i,a)}static maxOpen(e,n=!0){let i=0,a=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)i++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)a++;return new St(e,i,a)}}St.empty=new St(Qe.empty,0,0);function IM(r,e,n){let{index:i,offset:a}=r.findIndex(e),s=r.maybeChild(i),{index:o,offset:l}=r.findIndex(n);if(a==e||s.isText){if(l!=n&&!r.child(o).isText)throw new RangeError("Removing non-flat range");return r.cut(0,e).append(r.cut(n))}if(i!=o)throw new RangeError("Removing non-flat range");return r.replaceChild(i,s.copy(IM(s.content,e-a-1,n-a-1)))}function BM(r,e,n,i){let{index:a,offset:s}=r.findIndex(e),o=r.maybeChild(a);if(s==e||o.isText)return i&&!i.canReplace(a,a,n)?null:r.cut(0,e).append(n).append(r.cut(e));let l=BM(o.content,e-s-1,n,o);return l&&r.replaceChild(a,o.copy(l))}function tU(r,e,n){if(n.openStart>r.depth)throw new xy("Inserted content deeper than insertion position");if(r.depth-n.openStart!=e.depth-n.openEnd)throw new xy("Inconsistent open depths");return zM(r,e,n,0)}function zM(r,e,n,i){let a=r.index(i),s=r.node(i);if(a==e.index(i)&&i<r.depth-n.openStart){let o=zM(r,e,n,i+1);return s.copy(s.content.replaceChild(a,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&r.depth==i&&e.depth==i){let o=r.parent,l=o.content;return Mh(o,l.cut(0,r.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=rU(n,r);return Mh(s,VM(r,o,l,e,i))}else return Mh(s,by(r,e,i))}function FM(r,e){if(!e.type.compatibleContent(r.type))throw new xy("Cannot join "+e.type.name+" onto "+r.type.name)}function V2(r,e,n){let i=r.node(n);return FM(i,e.node(n)),i}function Ph(r,e){let n=e.length-1;n>=0&&r.isText&&r.sameMarkup(e[n])?e[n]=r.withText(e[n].text+r.text):e.push(r)}function xg(r,e,n,i){let a=(e||r).node(n),s=0,o=e?e.index(n):a.childCount;r&&(s=r.index(n),r.depth>n?s++:r.textOffset&&(Ph(r.nodeAfter,i),s++));for(let l=s;l<o;l++)Ph(a.child(l),i);e&&e.depth==n&&e.textOffset&&Ph(e.nodeBefore,i)}function Mh(r,e){return r.type.checkContent(e),r.copy(e)}function VM(r,e,n,i,a){let s=r.depth>a&&V2(r,e,a+1),o=i.depth>a&&V2(n,i,a+1),l=[];return xg(null,r,a,l),s&&o&&e.index(a)==n.index(a)?(FM(s,o),Ph(Mh(s,VM(r,e,n,i,a+1)),l)):(s&&Ph(Mh(s,by(r,e,a+1)),l),xg(e,n,a,l),o&&Ph(Mh(o,by(n,i,a+1)),l)),xg(i,null,a,l),new Qe(l)}function by(r,e,n){let i=[];if(xg(null,r,n,i),r.depth>n){let a=V2(r,e,n+1);Ph(Mh(a,by(r,e,n+1)),i)}return xg(e,null,n,i),new Qe(i)}function rU(r,e){let n=e.depth-r.openStart,a=e.node(n).copy(r.content);for(let s=n-1;s>=0;s--)a=e.node(s).copy(Qe.from(a));return{start:a.resolveNoCache(r.openStart+n),end:a.resolveNoCache(a.content.size-r.openEnd-n)}}class qg{constructor(e,n,i){this.pos=e,this.path=n,this.parentOffset=i,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let i=this.pos-this.path[this.path.length-1],a=e.child(n);return i?e.child(n).cut(i):a}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let i=this.path[n*3],a=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)a+=i.child(s).nodeSize;return a}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return tn.none;if(this.textOffset)return e.child(n).marks;let i=e.maybeChild(n-1),a=e.maybeChild(n);if(!i){let l=i;i=a,a=l}let s=i.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!a||!s[o].isInSet(a.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let i=n.marks,a=e.parent.maybeChild(e.index());for(var s=0;s<i.length;s++)i[s].type.spec.inclusive===!1&&(!a||!i[s].isInSet(a.marks))&&(i=i[s--].removeFromSet(i));return i}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let i=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);i>=0;i--)if(e.pos<=this.end(i)&&(!n||n(this.node(i))))return new wy(this,e,i);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let i=[],a=0,s=n;for(let o=e;;){let{index:l,offset:u}=o.content.findIndex(s),c=s-u;if(i.push(o,l,a+u),!c||(o=o.child(l),o.isText))break;s=c-1,a+=u+1}return new qg(n,i,s)}static resolveCached(e,n){let i=nT.get(e);if(i)for(let s=0;s<i.elts.length;s++){let o=i.elts[s];if(o.pos==n)return o}else nT.set(e,i=new nU);let a=i.elts[i.i]=qg.resolve(e,n);return i.i=(i.i+1)%iU,a}}class nU{constructor(){this.elts=[],this.i=0}}const iU=12,nT=new WeakMap;class wy{constructor(e,n,i){this.$from=e,this.$to=n,this.depth=i}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const aU=Object.create(null);class Po{constructor(e,n,i,a=tn.none){this.type=e,this.attrs=n,this.marks=a,this.content=i||Qe.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,i,a=0){this.content.nodesBetween(e,n,i,a,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,i,a){return this.content.textBetween(e,n,i,a)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,i){return this.type==e&&yy(this.attrs,n||e.defaultAttrs||aU)&&tn.sameSet(this.marks,i||tn.none)}copy(e=null){return e==this.content?this:new Po(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Po(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,i=!1){if(e==n)return St.empty;let a=this.resolve(e),s=this.resolve(n),o=i?0:a.sharedDepth(n),l=a.start(o),c=a.node(o).content.cut(a.pos-l,s.pos-l);return new St(c,a.depth-o,s.depth-o)}replace(e,n,i){return tU(this.resolve(e),this.resolve(n),i)}nodeAt(e){for(let n=this;;){let{index:i,offset:a}=n.content.findIndex(e);if(n=n.maybeChild(i),!n)return null;if(a==e||n.isText)return n;e-=a+1}}childAfter(e){let{index:n,offset:i}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:i}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:i}=this.content.findIndex(e);if(i<e)return{node:this.content.child(n),index:n,offset:i};let a=this.content.child(n-1);return{node:a,index:n-1,offset:i-a.nodeSize}}resolve(e){return qg.resolveCached(this,e)}resolveNoCache(e){return qg.resolve(this,e)}rangeHasMark(e,n,i){let a=!1;return n>e&&this.nodesBetween(e,n,s=>(i.isInSet(s.marks)&&(a=!0),!a)),a}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),UM(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,i=Qe.empty,a=0,s=i.childCount){let o=this.contentMatchAt(e).matchFragment(i,a,s),l=o&&o.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(let u=a;u<s;u++)if(!this.type.allowsMarks(i.child(u).marks))return!1;return!0}canReplaceWith(e,n,i,a){if(a&&!this.type.allowsMarks(a))return!1;let s=this.contentMatchAt(e).matchType(i),o=s&&s.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=tn.none;for(let n=0;n<this.marks.length;n++){let i=this.marks[n];i.type.checkAttrs(i.attrs),e=i.addToSet(e)}if(!tn.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let i;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");i=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,i)}let a=Qe.fromJSON(e,n.content),s=e.nodeType(n.type).create(n.attrs,a,i);return s.type.checkAttrs(s.attrs),s}}Po.prototype.text=void 0;class _y extends Po{constructor(e,n,i,a){if(super(e,n,null,a),!i)throw new RangeError("Empty text nodes are not allowed");this.text=i}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):UM(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new _y(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new _y(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function UM(r,e){for(let n=r.length-1;n>=0;n--)e=r[n].type.name+"("+e+")";return e}class Uh{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let i=new sU(e,n);if(i.next==null)return Uh.empty;let a=HM(i);i.next&&i.err("Unexpected trailing text");let s=fU(hU(a));return pU(s,i),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,i=e.childCount){let a=this;for(let s=n;a&&s<i;s++)a=a.matchType(e.child(s).type);return a}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let i=0;i<e.next.length;i++)if(this.next[n].type==e.next[i].type)return!0;return!1}fillBefore(e,n=!1,i=0){let a=[this];function s(o,l){let u=o.matchFragment(e,i);if(u&&(!n||u.validEnd))return Qe.from(l.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:d,next:p}=o.next[c];if(!(d.isText||d.hasRequiredAttrs())&&a.indexOf(p)==-1){a.push(p);let v=s(p,l.concat(d));if(v)return v}}return null}return s(this,[])}findWrapping(e){for(let i=0;i<this.wrapCache.length;i+=2)if(this.wrapCache[i]==e)return this.wrapCache[i+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),i=[{match:this,type:null,via:null}];for(;i.length;){let a=i.shift(),s=a.match;if(s.matchType(e)){let o=[];for(let l=a;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:u}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!a.type||u.validEnd)&&(i.push({match:l.contentMatch,type:l,via:a}),n[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(i){e.push(i);for(let a=0;a<i.next.length;a++)e.indexOf(i.next[a].next)==-1&&n(i.next[a].next)}return n(this),e.map((i,a)=>{let s=a+(i.validEnd?"*":" ")+" ";for(let o=0;o<i.next.length;o++)s+=(o?", ":"")+i.next[o].type.name+"->"+e.indexOf(i.next[o].next);return s}).join(`
`)}}Uh.empty=new Uh(!0);class sU{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function HM(r){let e=[];do e.push(oU(r));while(r.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function oU(r){let e=[];do e.push(lU(r));while(r.next&&r.next!=")"&&r.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function lU(r){let e=dU(r);for(;;)if(r.eat("+"))e={type:"plus",expr:e};else if(r.eat("*"))e={type:"star",expr:e};else if(r.eat("?"))e={type:"opt",expr:e};else if(r.eat("{"))e=uU(r,e);else break;return e}function iT(r){/\D/.test(r.next)&&r.err("Expected number, got '"+r.next+"'");let e=Number(r.next);return r.pos++,e}function uU(r,e){let n=iT(r),i=n;return r.eat(",")&&(r.next!="}"?i=iT(r):i=-1),r.eat("}")||r.err("Unclosed braced range"),{type:"range",min:n,max:i,expr:e}}function cU(r,e){let n=r.nodeTypes,i=n[e];if(i)return[i];let a=[];for(let s in n){let o=n[s];o.isInGroup(e)&&a.push(o)}return a.length==0&&r.err("No node type or group '"+e+"' found"),a}function dU(r){if(r.eat("(")){let e=HM(r);return r.eat(")")||r.err("Missing closing paren"),e}else if(/\W/.test(r.next))r.err("Unexpected token '"+r.next+"'");else{let e=cU(r,r.next).map(n=>(r.inline==null?r.inline=n.isInline:r.inline!=n.isInline&&r.err("Mixing inline and block content"),{type:"name",value:n}));return r.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function hU(r){let e=[[]];return a(s(r,0),n()),e;function n(){return e.push([])-1}function i(o,l,u){let c={term:u,to:l};return e[o].push(c),c}function a(o,l){o.forEach(u=>u.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((u,c)=>u.concat(s(c,l)),[]);if(o.type=="seq")for(let u=0;;u++){let c=s(o.exprs[u],l);if(u==o.exprs.length-1)return c;a(c,l=n())}else if(o.type=="star"){let u=n();return i(l,u),a(s(o.expr,u),u),[i(u)]}else if(o.type=="plus"){let u=n();return a(s(o.expr,l),u),a(s(o.expr,u),u),[i(u)]}else{if(o.type=="opt")return[i(l)].concat(s(o.expr,l));if(o.type=="range"){let u=l;for(let c=0;c<o.min;c++){let d=n();a(s(o.expr,u),d),u=d}if(o.max==-1)a(s(o.expr,u),u);else for(let c=o.min;c<o.max;c++){let d=n();i(u,d),a(s(o.expr,u),d),u=d}return[i(u)]}else{if(o.type=="name")return[i(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function GM(r,e){return e-r}function aT(r,e){let n=[];return i(e),n.sort(GM);function i(a){let s=r[a];if(s.length==1&&!s[0].term)return i(s[0].to);n.push(a);for(let o=0;o<s.length;o++){let{term:l,to:u}=s[o];!l&&n.indexOf(u)==-1&&i(u)}}}function fU(r){let e=Object.create(null);return n(aT(r,0));function n(i){let a=[];i.forEach(o=>{r[o].forEach(({term:l,to:u})=>{if(!l)return;let c;for(let d=0;d<a.length;d++)a[d][0]==l&&(c=a[d][1]);aT(r,u).forEach(d=>{c||a.push([l,c=[]]),c.indexOf(d)==-1&&c.push(d)})})});let s=e[i.join(",")]=new Uh(i.indexOf(r.length-1)>-1);for(let o=0;o<a.length;o++){let l=a[o][1].sort(GM);s.next.push({type:a[o][0],next:e[l.join(",")]||n(l)})}return s}}function pU(r,e){for(let n=0,i=[r];n<i.length;n++){let a=i[n],s=!a.validEnd,o=[];for(let l=0;l<a.next.length;l++){let{type:u,next:c}=a.next[l];o.push(u.name),s&&!(u.isText||u.hasRequiredAttrs())&&(s=!1),i.indexOf(c)==-1&&i.push(c)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function qM(r){let e=Object.create(null);for(let n in r){let i=r[n];if(!i.hasDefault)return null;e[n]=i.default}return e}function WM(r,e){let n=Object.create(null);for(let i in r){let a=e&&e[i];if(a===void 0){let s=r[i];if(s.hasDefault)a=s.default;else throw new RangeError("No value supplied for attribute "+i)}n[i]=a}return n}function $M(r,e,n,i){for(let a in e)if(!(a in r))throw new RangeError(`Unsupported attribute ${a} for ${n} of type ${a}`);for(let a in r){let s=r[a];s.validate&&s.validate(e[a])}}function KM(r,e){let n=Object.create(null);if(e)for(let i in e)n[i]=new gU(r,i,e[i]);return n}let sT=class ZM{constructor(e,n,i){this.name=e,this.schema=n,this.spec=i,this.markSet=null,this.groups=i.group?i.group.split(" "):[],this.attrs=KM(e,i.attrs),this.defaultAttrs=qM(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(i.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Uh.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:WM(this.attrs,e)}create(e=null,n,i){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Po(this,this.computeAttrs(e),Qe.from(n),tn.setFrom(i))}createChecked(e=null,n,i){return n=Qe.from(n),this.checkContent(n),new Po(this,this.computeAttrs(e),n,tn.setFrom(i))}createAndFill(e=null,n,i){if(e=this.computeAttrs(e),n=Qe.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let a=this.contentMatch.matchFragment(n),s=a&&a.fillBefore(Qe.empty,!0);return s?new Po(this,e,n.append(s),tn.setFrom(i)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let i=0;i<e.childCount;i++)if(!this.allowsMarks(e.child(i).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){$M(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let i=0;i<e.length;i++)this.allowsMarkType(e[i].type)?n&&n.push(e[i]):n||(n=e.slice(0,i));return n?n.length?n:tn.none:e}static compile(e,n){let i=Object.create(null);e.forEach((s,o)=>i[s]=new ZM(s,n,o));let a=n.spec.topNode||"doc";if(!i[a])throw new RangeError("Schema is missing its top node type ('"+a+"')");if(!i.text)throw new RangeError("Every schema needs a 'text' type");for(let s in i.text.attrs)throw new RangeError("The text node type should not have attributes");return i}};function mU(r,e,n){let i=n.split("|");return a=>{let s=a===null?"null":typeof a;if(i.indexOf(s)<0)throw new RangeError(`Expected value of type ${i} for attribute ${e} on type ${r}, got ${s}`)}}class gU{constructor(e,n,i){this.hasDefault=Object.prototype.hasOwnProperty.call(i,"default"),this.default=i.default,this.validate=typeof i.validate=="string"?mU(e,n,i.validate):i.validate}get isRequired(){return!this.hasDefault}}class Ox{constructor(e,n,i,a){this.name=e,this.rank=n,this.schema=i,this.spec=a,this.attrs=KM(e,a.attrs),this.excluded=null;let s=qM(this.attrs);this.instance=s?new tn(this,s):null}create(e=null){return!e&&this.instance?this.instance:new tn(this,WM(this.attrs,e))}static compile(e,n){let i=Object.create(null),a=0;return e.forEach((s,o)=>i[s]=new Ox(s,a++,n,o)),i}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){$M(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class YM{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let a in e)n[a]=e[a];n.nodes=wa.from(e.nodes),n.marks=wa.from(e.marks||{}),this.nodes=sT.compile(this.spec.nodes,this),this.marks=Ox.compile(this.spec.marks,this);let i=Object.create(null);for(let a in this.nodes){if(a in this.marks)throw new RangeError(a+" can not be both a node and a mark");let s=this.nodes[a],o=s.spec.content||"",l=s.spec.marks;if(s.contentMatch=i[o]||(i[o]=Uh.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=l=="_"?null:l?oT(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let a in this.marks){let s=this.marks[a],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:oT(this,o.split(" "))}this.nodeFromJSON=a=>Po.fromJSON(this,a),this.markFromJSON=a=>tn.fromJSON(this,a),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,i,a){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof sT){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,i,a)}text(e,n){let i=this.nodes.text;return new _y(i,i.defaultAttrs,e,tn.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function oT(r,e){let n=[];for(let i=0;i<e.length;i++){let a=e[i],s=r.marks[a],o=s;if(s)n.push(s);else for(let l in r.marks){let u=r.marks[l];(a=="_"||u.spec.group&&u.spec.group.split(" ").indexOf(a)>-1)&&n.push(o=u)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[i]+"'")}return n}function vU(r){return r.tag!=null}function yU(r){return r.style!=null}class gd{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let i=this.matchedStyles=[];n.forEach(a=>{if(vU(a))this.tags.push(a);else if(yU(a)){let s=/[^=]*/.exec(a.style)[0];i.indexOf(s)<0&&i.push(s),this.styles.push(a)}}),this.normalizeLists=!this.tags.some(a=>{if(!/^(ul|ol)\b/.test(a.tag)||!a.node)return!1;let s=e.nodes[a.node];return s.contentMatch.matchType(s)})}parse(e,n={}){let i=new uT(this,n,!1);return i.addAll(e,tn.none,n.from,n.to),i.finish()}parseSlice(e,n={}){let i=new uT(this,n,!0);return i.addAll(e,tn.none,n.from,n.to),St.maxOpen(i.finish())}matchTag(e,n,i){for(let a=i?this.tags.indexOf(i)+1:0;a<this.tags.length;a++){let s=this.tags[a];if(wU(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,n,i,a){for(let s=a?this.styles.indexOf(a)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!i.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=n))){if(o.getAttrs){let u=o.getAttrs(n);if(u===!1)continue;o.attrs=u||void 0}return o}}}static schemaRules(e){let n=[];function i(a){let s=a.priority==null?50:a.priority,o=0;for(;o<n.length;o++){let l=n[o];if((l.priority==null?50:l.priority)<s)break}n.splice(o,0,a)}for(let a in e.marks){let s=e.marks[a].spec.parseDOM;s&&s.forEach(o=>{i(o=cT(o)),o.mark||o.ignore||o.clearMark||(o.mark=a)})}for(let a in e.nodes){let s=e.nodes[a].spec.parseDOM;s&&s.forEach(o=>{i(o=cT(o)),o.node||o.ignore||o.mark||(o.node=a)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new gd(e,gd.schemaRules(e)))}}const XM={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},xU={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},QM={ol:!0,ul:!0},Wg=1,U2=2,bg=4;function lT(r,e,n){return e!=null?(e?Wg:0)|(e==="full"?U2:0):r&&r.whitespace=="pre"?Wg|U2:n&~bg}class S0{constructor(e,n,i,a,s,o){this.type=e,this.attrs=n,this.marks=i,this.solid=a,this.options=o,this.content=[],this.activeMarks=tn.none,this.match=s||(o&bg?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(Qe.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let i=this.type.contentMatch,a;return(a=i.findWrapping(e.type))?(this.match=i,a):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Wg)){let i=this.content[this.content.length-1],a;if(i&&i.isText&&(a=/[ \t\r\n\u000c]+$/.exec(i.text))){let s=i;i.text.length==a[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-a[0].length))}}let n=Qe.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(Qe.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!XM.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class uT{constructor(e,n,i){this.parser=e,this.options=n,this.isOpen=i,this.open=0,this.localPreserveWS=!1;let a=n.topNode,s,o=lT(null,n.preserveWhitespace,0)|(i?bg:0);a?s=new S0(a.type,a.attrs,tn.none,!0,n.topMatch||a.type.contentMatch,o):i?s=new S0(null,null,tn.none,!0,null,o):s=new S0(e.schema.topNodeType,null,tn.none,!0,null,o),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let i=e.nodeValue,a=this.top,s=a.options&U2?"full":this.localPreserveWS||(a.options&Wg)>0,{schema:o}=this.parser;if(s==="full"||a.inlineContext(e)||/[^ \t\r\n\u000c]/.test(i)){if(s)if(s==="full")i=i.replace(/\r\n?/g,`
`);else if(o.linebreakReplacement&&/[\r\n]/.test(i)&&this.top.findWrapping(o.linebreakReplacement.create())){let l=i.split(/\r?\n|\r/);for(let u=0;u<l.length;u++)u&&this.insertNode(o.linebreakReplacement.create(),n,!0),l[u]&&this.insertNode(o.text(l[u]),n,!/\S/.test(l[u]));i=""}else i=i.replace(/\r?\n|\r/g," ");else if(i=i.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(i)&&this.open==this.nodes.length-1){let l=a.content[a.content.length-1],u=e.previousSibling;(!l||u&&u.nodeName=="BR"||l.isText&&/[ \t\r\n\u000c]$/.test(l.text))&&(i=i.slice(1))}i&&this.insertNode(o.text(i),n,!/\S/.test(i)),this.findInText(e)}else this.findInside(e)}addElement(e,n,i){let a=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),l;QM.hasOwnProperty(o)&&this.parser.normalizeLists&&bU(e);let u=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,i));e:if(u?u.ignore:xU.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,n);else if(!u||u.skip||u.closeParent){u&&u.closeParent?this.open=Math.max(0,this.open-1):u&&u.skip.nodeType&&(e=u.skip);let c,d=this.needsBlock;if(XM.hasOwnProperty(o))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),c=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let p=u&&u.skip?n:this.readStyles(e,n);p&&this.addAll(e,p),c&&this.sync(s),this.needsBlock=d}else{let c=this.readStyles(e,n);c&&this.addElementByRule(e,u,c,u.consuming===!1?l:void 0)}this.localPreserveWS=a}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let i=e.style;if(i&&i.length)for(let a=0;a<this.parser.matchedStyles.length;a++){let s=this.parser.matchedStyles[a],o=i.getPropertyValue(s);if(o)for(let l=void 0;;){let u=this.parser.matchStyle(s,o,this,l);if(!u)break;if(u.ignore)return null;if(u.clearMark?n=n.filter(c=>!u.clearMark(c)):n=n.concat(this.parser.schema.marks[u.mark].create(u.attrs)),u.consuming===!1)l=u;else break}}return n}addElementByRule(e,n,i,a){let s,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),i,e.nodeName=="BR")||this.leafFallback(e,i);else{let u=this.enter(o,n.attrs||null,i,n.preserveWhitespace);u&&(s=!0,i=u)}else{let u=this.parser.schema.marks[n.mark];i=i.concat(u.create(n.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(e);else if(a)this.addElement(e,i,a);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(u=>this.insertNode(u,i,!1));else{let u=e;typeof n.contentElement=="string"?u=e.querySelector(n.contentElement):typeof n.contentElement=="function"?u=n.contentElement(e):n.contentElement&&(u=n.contentElement),this.findAround(e,u,!0),this.addAll(u,i),this.findAround(e,u,!1)}s&&this.sync(l)&&this.open--}addAll(e,n,i,a){let s=i||0;for(let o=i?e.childNodes[i]:e.firstChild,l=a==null?null:e.childNodes[a];o!=l;o=o.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(o,n);this.findAtPoint(e,s)}findPlace(e,n,i){let a,s;for(let o=this.open,l=0;o>=0;o--){let u=this.nodes[o],c=u.findWrapping(e);if(c&&(!a||a.length>c.length+l)&&(a=c,s=u,!c.length))break;if(u.solid){if(i)break;l+=2}}if(!a)return null;this.sync(s);for(let o=0;o<a.length;o++)n=this.enterInner(a[o],null,n,!1);return n}insertNode(e,n,i){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(n=this.enterInner(s,null,n))}let a=this.findPlace(e,n,i);if(a){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let o=tn.none;for(let l of a.concat(e.marks))(s.type?s.type.allowsMarkType(l.type):dT(l.type,e.type))&&(o=l.addToSet(o));return s.content.push(e.mark(o)),!0}return!1}enter(e,n,i,a){let s=this.findPlace(e.create(n),i,!1);return s&&(s=this.enterInner(e,n,i,!0,a)),s}enterInner(e,n,i,a=!1,s){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let l=lT(e,s,o.options);o.options&bg&&o.content.length==0&&(l|=bg);let u=tn.none;return i=i.filter(c=>(o.type?o.type.allowsMarkType(c.type):dT(c.type,e))?(u=c.addToSet(u),!1):!0),this.nodes.push(new S0(e,n,u,a,null,l)),this.open++,i}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Wg)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let i=this.nodes[n].content;for(let a=i.length-1;a>=0;a--)e+=i[a].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==e&&this.find[i].offset==n&&(this.find[i].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,i){if(e!=n&&this.find)for(let a=0;a<this.find.length;a++)this.find[a].pos==null&&e.nodeType==1&&e.contains(this.find[a].node)&&n.compareDocumentPosition(this.find[a].node)&(i?2:4)&&(this.find[a].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),i=this.options.context,a=!this.isOpen&&(!i||i.parent.type==this.nodes[0].type),s=-(i?i.depth+1:0)+(a?0:1),o=(l,u)=>{for(;l>=0;l--){let c=n[l];if(c==""){if(l==n.length-1||l==0)continue;for(;u>=s;u--)if(o(l-1,u))return!0;return!1}else{let d=u>0||u==0&&a?this.nodes[u].type:i&&u>=s?i.node(u-s).type:null;if(!d||d.name!=c&&!d.isInGroup(c))return!1;u--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(i&&i.isTextblock&&i.defaultAttrs)return i}for(let n in this.parser.schema.nodes){let i=this.parser.schema.nodes[n];if(i.isTextblock&&i.defaultAttrs)return i}}}function bU(r){for(let e=r.firstChild,n=null;e;e=e.nextSibling){let i=e.nodeType==1?e.nodeName.toLowerCase():null;i&&QM.hasOwnProperty(i)&&n?(n.appendChild(e),e=n):i=="li"?n=e:i&&(n=null)}}function wU(r,e){return(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,e)}function cT(r){let e={};for(let n in r)e[n]=r[n];return e}function dT(r,e){let n=e.schema.nodes;for(let i in n){let a=n[i];if(!a.allowsMarkType(r))continue;let s=[],o=l=>{s.push(l);for(let u=0;u<l.edgeCount;u++){let{type:c,next:d}=l.edge(u);if(c==e||s.indexOf(d)<0&&o(d))return!0}};if(o(a.contentMatch))return!0}}class Qh{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},i){i||(i=Lw(n).createDocumentFragment());let a=i,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let l=0,u=0;for(;l<s.length&&u<o.marks.length;){let c=o.marks[u];if(!this.marks[c.type.name]){u++;continue}if(!c.eq(s[l][0])||c.type.spec.spanning===!1)break;l++,u++}for(;l<s.length;)a=s.pop()[1];for(;u<o.marks.length;){let c=o.marks[u++],d=this.serializeMark(c,o.isInline,n);d&&(s.push([c,a]),a.appendChild(d.dom),a=d.contentDOM||d.dom)}}a.appendChild(this.serializeNodeInner(o,n))}),i}serializeNodeInner(e,n){let{dom:i,contentDOM:a}=Z0(Lw(n),this.nodes[e.type.name](e),null,e.attrs);if(a){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,a)}return i}serializeNode(e,n={}){let i=this.serializeNodeInner(e,n);for(let a=e.marks.length-1;a>=0;a--){let s=this.serializeMark(e.marks[a],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(i),i=s.dom)}return i}serializeMark(e,n,i={}){let a=this.marks[e.type.name];return a&&Z0(Lw(i),a(e,n),null,e.attrs)}static renderSpec(e,n,i=null,a){return Z0(e,n,i,a)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Qh(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=hT(e.nodes);return n.text||(n.text=i=>i.text),n}static marksFromSchema(e){return hT(e.marks)}}function hT(r){let e={};for(let n in r){let i=r[n].spec.toDOM;i&&(e[n]=i)}return e}function Lw(r){return r.document||window.document}const fT=new WeakMap;function _U(r){let e=fT.get(r);return e===void 0&&fT.set(r,e=SU(r)),e}function SU(r){let e=null;function n(i){if(i&&typeof i=="object")if(Array.isArray(i))if(typeof i[0]=="string")e||(e=[]),e.push(i);else for(let a=0;a<i.length;a++)n(i[a]);else for(let a in i)n(i[a])}return n(r),e}function Z0(r,e,n,i){if(typeof e=="string")return{dom:r.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let a=e[0],s;if(typeof a!="string")throw new RangeError("Invalid array passed to renderSpec");if(i&&(s=_U(i))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=a.indexOf(" ");o>0&&(n=a.slice(0,o),a=a.slice(o+1));let l,u=n?r.createElementNS(n,a):r.createElement(a),c=e[1],d=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){d=2;for(let p in c)if(c[p]!=null){let v=p.indexOf(" ");v>0?u.setAttributeNS(p.slice(0,v),p.slice(v+1),c[p]):p=="style"&&u.style?u.style.cssText=c[p]:u.setAttribute(p,c[p])}}for(let p=d;p<e.length;p++){let v=e[p];if(v===0){if(p<e.length-1||p>d)throw new RangeError("Content hole must be the only child of its parent node");return{dom:u,contentDOM:u}}else{let{dom:y,contentDOM:b}=Z0(r,v,n,i);if(u.appendChild(y),b){if(l)throw new RangeError("Multiple content holes");l=b}}}return{dom:u,contentDOM:l}}const JM=65535,e6=Math.pow(2,16);function kU(r,e){return r+e*e6}function pT(r){return r&JM}function CU(r){return(r-(r&JM))/e6}const t6=1,r6=2,Y0=4,n6=8;class H2{constructor(e,n,i){this.pos=e,this.delInfo=n,this.recover=i}get deleted(){return(this.delInfo&n6)>0}get deletedBefore(){return(this.delInfo&(t6|Y0))>0}get deletedAfter(){return(this.delInfo&(r6|Y0))>0}get deletedAcross(){return(this.delInfo&Y0)>0}}class Ys{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Ys.empty)return Ys.empty}recover(e){let n=0,i=pT(e);if(!this.inverted)for(let a=0;a<i;a++)n+=this.ranges[a*3+2]-this.ranges[a*3+1];return this.ranges[i*3]+n+CU(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,i){let a=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let u=this.ranges[l]-(this.inverted?a:0);if(u>e)break;let c=this.ranges[l+s],d=this.ranges[l+o],p=u+c;if(e<=p){let v=c?e==u?-1:e==p?1:n:n,y=u+a+(v<0?0:d);if(i)return y;let b=e==(n<0?u:p)?null:kU(l/3,e-u),S=e==u?r6:e==p?t6:Y0;return(n<0?e!=u:e!=p)&&(S|=n6),new H2(y,S,b)}a+=d-c}return i?e+a:new H2(e+a,0,null)}touches(e,n){let i=0,a=pT(n),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let u=this.ranges[l]-(this.inverted?i:0);if(u>e)break;let c=this.ranges[l+s],d=u+c;if(e<=d&&l==a*3)return!0;i+=this.ranges[l+o]-c}return!1}forEach(e){let n=this.inverted?2:1,i=this.inverted?1:2;for(let a=0,s=0;a<this.ranges.length;a+=3){let o=this.ranges[a],l=o-(this.inverted?s:0),u=o+(this.inverted?0:s),c=this.ranges[a+n],d=this.ranges[a+i];e(l,l+c,u,u+d),s+=d-c}}invert(){return new Ys(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ys.empty:new Ys(e<0?[0,-e,0]:[0,0,e])}}Ys.empty=new Ys([]);class $g{constructor(e,n,i=0,a=e?e.length:0){this.mirror=n,this.from=i,this.to=a,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new $g(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,i=this._maps.length;n<e._maps.length;n++){let a=e.getMirror(n);this.appendMap(e._maps[n],a!=null&&a<n?i+a:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,i=this._maps.length+e._maps.length;n>=0;n--){let a=e.getMirror(n);this.appendMap(e._maps[n].invert(),a!=null&&a>n?i-a-1:void 0)}}invert(){let e=new $g;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let i=this.from;i<this.to;i++)e=this._maps[i].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,i){let a=0;for(let s=this.from;s<this.to;s++){let o=this._maps[s],l=o.mapResult(e,n);if(l.recover!=null){let u=this.getMirror(s);if(u!=null&&u>s&&u<this.to){s=u,e=this._maps[u].recover(l.recover);continue}}a|=l.delInfo,e=l.pos}return i?e:new H2(e,a,null)}}const Ow=Object.create(null);class Ka{getMap(){return Ys.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let i=Ow[n.stepType];if(!i)throw new RangeError(`No step type ${n.stepType} defined`);return i.fromJSON(e,n)}static jsonID(e,n){if(e in Ow)throw new RangeError("Duplicate use of step JSON ID "+e);return Ow[e]=n,n.prototype.jsonID=e,n}}class bi{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new bi(e,null)}static fail(e){return new bi(null,e)}static fromReplace(e,n,i,a){try{return bi.ok(e.replace(n,i,a))}catch(s){if(s instanceof xy)return bi.fail(s.message);throw s}}}function sS(r,e,n){let i=[];for(let a=0;a<r.childCount;a++){let s=r.child(a);s.content.size&&(s=s.copy(sS(s.content,e,s))),s.isInline&&(s=e(s,n,a)),i.push(s)}return Qe.fromArray(i)}class ud extends Ka{constructor(e,n,i){super(),this.from=e,this.to=n,this.mark=i}apply(e){let n=e.slice(this.from,this.to),i=e.resolve(this.from),a=i.node(i.sharedDepth(this.to)),s=new St(sS(n.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),a),n.openStart,n.openEnd);return bi.fromReplace(e,this.from,this.to,s)}invert(){return new cl(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deleted&&i.deleted||n.pos>=i.pos?null:new ud(n.pos,i.pos,this.mark)}merge(e){return e instanceof ud&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ud(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ud(n.from,n.to,e.markFromJSON(n.mark))}}Ka.jsonID("addMark",ud);class cl extends Ka{constructor(e,n,i){super(),this.from=e,this.to=n,this.mark=i}apply(e){let n=e.slice(this.from,this.to),i=new St(sS(n.content,a=>a.mark(this.mark.removeFromSet(a.marks)),e),n.openStart,n.openEnd);return bi.fromReplace(e,this.from,this.to,i)}invert(){return new ud(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deleted&&i.deleted||n.pos>=i.pos?null:new cl(n.pos,i.pos,this.mark)}merge(e){return e instanceof cl&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new cl(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new cl(n.from,n.to,e.markFromJSON(n.mark))}}Ka.jsonID("removeMark",cl);class cd extends Ka{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return bi.fail("No node at mark step's position");let i=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return bi.fromReplace(e,this.pos,this.pos+1,new St(Qe.from(i),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let i=this.mark.addToSet(n.marks);if(i.length==n.marks.length){for(let a=0;a<n.marks.length;a++)if(!n.marks[a].isInSet(i))return new cd(this.pos,n.marks[a]);return new cd(this.pos,this.mark)}}return new Hh(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new cd(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new cd(n.pos,e.markFromJSON(n.mark))}}Ka.jsonID("addNodeMark",cd);class Hh extends Ka{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return bi.fail("No node at mark step's position");let i=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return bi.fromReplace(e,this.pos,this.pos+1,new St(Qe.from(i),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new cd(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Hh(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Hh(n.pos,e.markFromJSON(n.mark))}}Ka.jsonID("removeNodeMark",Hh);class Ki extends Ka{constructor(e,n,i,a=!1){super(),this.from=e,this.to=n,this.slice=i,this.structure=a}apply(e){return this.structure&&G2(e,this.from,this.to)?bi.fail("Structure replace would overwrite content"):bi.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Ys([this.from,this.to-this.from,this.slice.size])}invert(e){return new Ki(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return n.deletedAcross&&i.deletedAcross?null:new Ki(n.pos,Math.max(n.pos,i.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Ki)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?St.empty:new St(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Ki(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?St.empty:new St(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Ki(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ki(n.from,n.to,St.fromJSON(e,n.slice),!!n.structure)}}Ka.jsonID("replace",Ki);class Qi extends Ka{constructor(e,n,i,a,s,o,l=!1){super(),this.from=e,this.to=n,this.gapFrom=i,this.gapTo=a,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(G2(e,this.from,this.gapFrom)||G2(e,this.gapTo,this.to)))return bi.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return bi.fail("Gap is not a flat range");let i=this.slice.insertAt(this.insert,n.content);return i?bi.fromReplace(e,this.from,this.to,i):bi.fail("Content does not fit in gap")}getMap(){return new Ys([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Qi(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),i=e.mapResult(this.to,-1),a=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?i.pos:e.map(this.gapTo,1);return n.deletedAcross&&i.deletedAcross||a<n.pos||s>i.pos?null:new Qi(n.pos,i.pos,a,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Qi(n.from,n.to,n.gapFrom,n.gapTo,St.fromJSON(e,n.slice),n.insert,!!n.structure)}}Ka.jsonID("replaceAround",Qi);function G2(r,e,n){let i=r.resolve(e),a=n-e,s=i.depth;for(;a>0&&s>0&&i.indexAfter(s)==i.node(s).childCount;)s--,a--;if(a>0){let o=i.node(s).maybeChild(i.indexAfter(s));for(;a>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,a--}}return!1}function EU(r,e,n,i){let a=[],s=[],o,l;r.doc.nodesBetween(e,n,(u,c,d)=>{if(!u.isInline)return;let p=u.marks;if(!i.isInSet(p)&&d.type.allowsMarkType(i.type)){let v=Math.max(c,e),y=Math.min(c+u.nodeSize,n),b=i.addToSet(p);for(let S=0;S<p.length;S++)p[S].isInSet(b)||(o&&o.to==v&&o.mark.eq(p[S])?o.to=y:a.push(o=new cl(v,y,p[S])));l&&l.to==v?l.to=y:s.push(l=new ud(v,y,i))}}),a.forEach(u=>r.step(u)),s.forEach(u=>r.step(u))}function NU(r,e,n,i){let a=[],s=0;r.doc.nodesBetween(e,n,(o,l)=>{if(!o.isInline)return;s++;let u=null;if(i instanceof Ox){let c=o.marks,d;for(;d=i.isInSet(c);)(u||(u=[])).push(d),c=d.removeFromSet(c)}else i?i.isInSet(o.marks)&&(u=[i]):u=o.marks;if(u&&u.length){let c=Math.min(l+o.nodeSize,n);for(let d=0;d<u.length;d++){let p=u[d],v;for(let y=0;y<a.length;y++){let b=a[y];b.step==s-1&&p.eq(a[y].style)&&(v=b)}v?(v.to=c,v.step=s):a.push({style:p,from:Math.max(l,e),to:c,step:s})}}}),a.forEach(o=>r.step(new cl(o.from,o.to,o.style)))}function oS(r,e,n,i=n.contentMatch,a=!0){let s=r.doc.nodeAt(e),o=[],l=e+1;for(let u=0;u<s.childCount;u++){let c=s.child(u),d=l+c.nodeSize,p=i.matchType(c.type);if(!p)o.push(new Ki(l,d,St.empty));else{i=p;for(let v=0;v<c.marks.length;v++)n.allowsMarkType(c.marks[v].type)||r.step(new cl(l,d,c.marks[v]));if(a&&c.isText&&n.whitespace!="pre"){let v,y=/\r?\n|\r/g,b;for(;v=y.exec(c.text);)b||(b=new St(Qe.from(n.schema.text(" ",n.allowedMarks(c.marks))),0,0)),o.push(new Ki(l+v.index,l+v.index+v[0].length,b))}}l=d}if(!i.validEnd){let u=i.fillBefore(Qe.empty,!0);r.replace(l,l,new St(u,0,0))}for(let u=o.length-1;u>=0;u--)r.step(o[u])}function TU(r,e,n){return(e==0||r.canReplace(e,r.childCount))&&(n==r.childCount||r.canReplace(0,n))}function Lp(r){let n=r.parent.content.cutByIndex(r.startIndex,r.endIndex);for(let i=r.depth,a=0,s=0;;--i){let o=r.$from.node(i),l=r.$from.index(i)+a,u=r.$to.indexAfter(i)-s;if(i<r.depth&&o.canReplace(l,u,n))return i;if(i==0||o.type.spec.isolating||!TU(o,l,u))break;l&&(a=1),u<o.childCount&&(s=1)}return null}function PU(r,e,n){let{$from:i,$to:a,depth:s}=e,o=i.before(s+1),l=a.after(s+1),u=o,c=l,d=Qe.empty,p=0;for(let b=s,S=!1;b>n;b--)S||i.index(b)>0?(S=!0,d=Qe.from(i.node(b).copy(d)),p++):u--;let v=Qe.empty,y=0;for(let b=s,S=!1;b>n;b--)S||a.after(b+1)<a.end(b)?(S=!0,v=Qe.from(a.node(b).copy(v)),y++):c++;r.step(new Qi(u,c,o,l,new St(d.append(v),p,y),d.size-p,!0))}function lS(r,e,n=null,i=r){let a=MU(r,e),s=a&&AU(i,e);return s?a.map(mT).concat({type:e,attrs:n}).concat(s.map(mT)):null}function mT(r){return{type:r,attrs:null}}function MU(r,e){let{parent:n,startIndex:i,endIndex:a}=r,s=n.contentMatchAt(i).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return n.canReplaceWith(i,a,o)?s:null}function AU(r,e){let{parent:n,startIndex:i,endIndex:a}=r,s=n.child(i),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let u=(o.length?o[o.length-1]:e).contentMatch;for(let c=i;u&&c<a;c++)u=u.matchType(n.child(c).type);return!u||!u.validEnd?null:o}function jU(r,e,n){let i=Qe.empty;for(let o=n.length-1;o>=0;o--){if(i.size){let l=n[o].type.contentMatch.matchFragment(i);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}i=Qe.from(n[o].type.create(n[o].attrs,i))}let a=e.start,s=e.end;r.step(new Qi(a,s,a,s,new St(i,0,0),n.length,!0))}function RU(r,e,n,i,a){if(!i.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=r.steps.length;r.doc.nodesBetween(e,n,(o,l)=>{let u=typeof a=="function"?a(o):a;if(o.isTextblock&&!o.hasMarkup(i,u)&&LU(r.doc,r.mapping.slice(s).map(l),i)){let c=null;if(i.schema.linebreakReplacement){let y=i.whitespace=="pre",b=!!i.contentMatch.matchType(i.schema.linebreakReplacement);y&&!b?c=!1:!y&&b&&(c=!0)}c===!1&&a6(r,o,l,s),oS(r,r.mapping.slice(s).map(l,1),i,void 0,c===null);let d=r.mapping.slice(s),p=d.map(l,1),v=d.map(l+o.nodeSize,1);return r.step(new Qi(p,v,p+1,v-1,new St(Qe.from(i.create(u,null,o.marks)),0,0),1,!0)),c===!0&&i6(r,o,l,s),!1}})}function i6(r,e,n,i){e.forEach((a,s)=>{if(a.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(a.text);){let u=r.mapping.slice(i).map(n+1+s+o.index);r.replaceWith(u,u+1,e.type.schema.linebreakReplacement.create())}}})}function a6(r,e,n,i){e.forEach((a,s)=>{if(a.type==a.type.schema.linebreakReplacement){let o=r.mapping.slice(i).map(n+1+s);r.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function LU(r,e,n){let i=r.resolve(e),a=i.index();return i.parent.canReplaceWith(a,a+1,n)}function OU(r,e,n,i,a){let s=r.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(i,null,a||s.marks);if(s.isLeaf)return r.replaceWith(e,e+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);r.step(new Qi(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new St(Qe.from(o),0,0),1,!0))}function qu(r,e,n=1,i){let a=r.resolve(e),s=a.depth-n,o=i&&i[i.length-1]||a.parent;if(s<0||a.parent.type.spec.isolating||!a.parent.canReplace(a.index(),a.parent.childCount)||!o.type.validContent(a.parent.content.cutByIndex(a.index(),a.parent.childCount)))return!1;for(let c=a.depth-1,d=n-2;c>s;c--,d--){let p=a.node(c),v=a.index(c);if(p.type.spec.isolating)return!1;let y=p.content.cutByIndex(v,p.childCount),b=i&&i[d+1];b&&(y=y.replaceChild(0,b.type.create(b.attrs)));let S=i&&i[d]||p;if(!p.canReplace(v+1,p.childCount)||!S.type.validContent(y))return!1}let l=a.indexAfter(s),u=i&&i[0];return a.node(s).canReplaceWith(l,l,u?u.type:a.node(s+1).type)}function DU(r,e,n=1,i){let a=r.doc.resolve(e),s=Qe.empty,o=Qe.empty;for(let l=a.depth,u=a.depth-n,c=n-1;l>u;l--,c--){s=Qe.from(a.node(l).copy(s));let d=i&&i[c];o=Qe.from(d?d.type.create(d.attrs,o):a.node(l).copy(o))}r.step(new Ki(e,e,new St(s.append(o),n,n),!0))}function Od(r,e){let n=r.resolve(e),i=n.index();return s6(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(i,i+1)}function IU(r,e){e.content.size||r.type.compatibleContent(e.type);let n=r.contentMatchAt(r.childCount),{linebreakReplacement:i}=r.type.schema;for(let a=0;a<e.childCount;a++){let s=e.child(a),o=s.type==i?r.type.schema.nodes.text:s.type;if(n=n.matchType(o),!n||!r.type.allowsMarks(s.marks))return!1}return n.validEnd}function s6(r,e){return!!(r&&e&&!r.isLeaf&&IU(r,e))}function Dx(r,e,n=-1){let i=r.resolve(e);for(let a=i.depth;;a--){let s,o,l=i.index(a);if(a==i.depth?(s=i.nodeBefore,o=i.nodeAfter):n>0?(s=i.node(a+1),l++,o=i.node(a).maybeChild(l)):(s=i.node(a).maybeChild(l-1),o=i.node(a+1)),s&&!s.isTextblock&&s6(s,o)&&i.node(a).canReplace(l,l+1))return e;if(a==0)break;e=n<0?i.before(a):i.after(a)}}function BU(r,e,n){let i=null,{linebreakReplacement:a}=r.doc.type.schema,s=r.doc.resolve(e-n),o=s.node().type;if(a&&o.inlineContent){let d=o.whitespace=="pre",p=!!o.contentMatch.matchType(a);d&&!p?i=!1:!d&&p&&(i=!0)}let l=r.steps.length;if(i===!1){let d=r.doc.resolve(e+n);a6(r,d.node(),d.before(),l)}o.inlineContent&&oS(r,e+n-1,o,s.node().contentMatchAt(s.index()),i==null);let u=r.mapping.slice(l),c=u.map(e-n);if(r.step(new Ki(c,u.map(e+n,-1),St.empty,!0)),i===!0){let d=r.doc.resolve(c);i6(r,d.node(),d.before(),r.steps.length)}return r}function zU(r,e,n){let i=r.resolve(e);if(i.parent.canReplaceWith(i.index(),i.index(),n))return e;if(i.parentOffset==0)for(let a=i.depth-1;a>=0;a--){let s=i.index(a);if(i.node(a).canReplaceWith(s,s,n))return i.before(a+1);if(s>0)return null}if(i.parentOffset==i.parent.content.size)for(let a=i.depth-1;a>=0;a--){let s=i.indexAfter(a);if(i.node(a).canReplaceWith(s,s,n))return i.after(a+1);if(s<i.node(a).childCount)return null}return null}function o6(r,e,n){let i=r.resolve(e);if(!n.content.size)return e;let a=n.content;for(let s=0;s<n.openStart;s++)a=a.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let o=i.depth;o>=0;o--){let l=o==i.depth?0:i.pos<=(i.start(o+1)+i.end(o+1))/2?-1:1,u=i.index(o)+(l>0?1:0),c=i.node(o),d=!1;if(s==1)d=c.canReplace(u,u,a);else{let p=c.contentMatchAt(u).findWrapping(a.firstChild.type);d=p&&c.canReplaceWith(u,u,p[0])}if(d)return l==0?i.pos:l<0?i.before(o+1):i.after(o+1)}return null}function Ix(r,e,n=e,i=St.empty){if(e==n&&!i.size)return null;let a=r.resolve(e),s=r.resolve(n);return l6(a,s,i)?new Ki(e,n,i):new FU(a,s,i).fit()}function l6(r,e,n){return!n.openStart&&!n.openEnd&&r.start()==e.start()&&r.parent.canReplace(r.index(),e.index(),n.content)}class FU{constructor(e,n,i){this.$from=e,this.$to=n,this.unplaced=i,this.frontier=[],this.placed=Qe.empty;for(let a=0;a<=e.depth;a++){let s=e.node(a);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(a))})}for(let a=e.depth;a>0;a--)this.placed=Qe.from(e.node(a).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,i=this.$from,a=this.close(e<0?this.$to:i.doc.resolve(e));if(!a)return null;let s=this.placed,o=i.depth,l=a.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let u=new St(s,o,l);return e>-1?new Qi(i.pos,e,this.$to.pos,this.$to.end(),u,n):u.size||i.pos!=this.$to.pos?new Ki(i.pos,a.pos,u):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,i=0,a=this.unplaced.openEnd;i<e;i++){let s=n.firstChild;if(n.childCount>1&&(a=0),s.type.spec.isolating&&a<=i){e=i;break}n=s.content}for(let n=1;n<=2;n++)for(let i=n==1?e:this.unplaced.openStart;i>=0;i--){let a,s=null;i?(s=Dw(this.unplaced.content,i-1).firstChild,a=s.content):a=this.unplaced.content;let o=a.firstChild;for(let l=this.depth;l>=0;l--){let{type:u,match:c}=this.frontier[l],d,p=null;if(n==1&&(o?c.matchType(o.type)||(p=c.fillBefore(Qe.from(o),!1)):s&&u.compatibleContent(s.type)))return{sliceDepth:i,frontierDepth:l,parent:s,inject:p};if(n==2&&o&&(d=c.findWrapping(o.type)))return{sliceDepth:i,frontierDepth:l,parent:s,wrap:d};if(s&&c.matchType(s.type))break}}}openMore(){let{content:e,openStart:n,openEnd:i}=this.unplaced,a=Dw(e,n);return!a.childCount||a.firstChild.isLeaf?!1:(this.unplaced=new St(e,n+1,Math.max(i,a.size+n>=e.size-i?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:i}=this.unplaced,a=Dw(e,n);if(a.childCount<=1&&n>0){let s=e.size-n<=n+a.size;this.unplaced=new St(hg(e,n-1,1),n-1,s?n-1:i)}else this.unplaced=new St(hg(e,n,1),n,i)}placeNodes({sliceDepth:e,frontierDepth:n,parent:i,inject:a,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let S=0;S<s.length;S++)this.openFrontierNode(s[S]);let o=this.unplaced,l=i?i.content:o.content,u=o.openStart-e,c=0,d=[],{match:p,type:v}=this.frontier[n];if(a){for(let S=0;S<a.childCount;S++)d.push(a.child(S));p=p.matchFragment(a)}let y=l.size+e-(o.content.size-o.openEnd);for(;c<l.childCount;){let S=l.child(c),k=p.matchType(S.type);if(!k)break;c++,(c>1||u==0||S.content.size)&&(p=k,d.push(u6(S.mark(v.allowedMarks(S.marks)),c==1?u:0,c==l.childCount?y:-1)))}let b=c==l.childCount;b||(y=-1),this.placed=fg(this.placed,n,Qe.from(d)),this.frontier[n].match=p,b&&y<0&&i&&i.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let S=0,k=l;S<y;S++){let T=k.lastChild;this.frontier.push({type:T.type,match:T.contentMatchAt(T.childCount)}),k=T.content}this.unplaced=b?e==0?St.empty:new St(hg(o.content,e-1,1),e-1,y<0?o.openEnd:e-1):new St(hg(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Iw(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:i}=this.$to,a=this.$to.after(i);for(;i>1&&a==this.$to.end(--i);)++a;return a}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:i,type:a}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=Iw(e,n,a,i,s);if(o){for(let l=n-1;l>=0;l--){let{match:u,type:c}=this.frontier[l],d=Iw(e,l,c,u,!0);if(!d||d.childCount)continue e}return{depth:n,fit:o,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=fg(this.placed,n.depth,n.fit)),e=n.move;for(let i=n.depth+1;i<=e.depth;i++){let a=e.node(i),s=a.type.contentMatch.fillBefore(a.content,!0,e.index(i));this.openFrontierNode(a.type,a.attrs,s)}return e}openFrontierNode(e,n=null,i){let a=this.frontier[this.depth];a.match=a.match.matchType(e),this.placed=fg(this.placed,this.depth,Qe.from(e.create(n,i))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(Qe.empty,!0);n.childCount&&(this.placed=fg(this.placed,this.frontier.length,n))}}function hg(r,e,n){return e==0?r.cutByIndex(n,r.childCount):r.replaceChild(0,r.firstChild.copy(hg(r.firstChild.content,e-1,n)))}function fg(r,e,n){return e==0?r.append(n):r.replaceChild(r.childCount-1,r.lastChild.copy(fg(r.lastChild.content,e-1,n)))}function Dw(r,e){for(let n=0;n<e;n++)r=r.firstChild.content;return r}function u6(r,e,n){if(e<=0)return r;let i=r.content;return e>1&&(i=i.replaceChild(0,u6(i.firstChild,e-1,i.childCount==1?n-1:0))),e>0&&(i=r.type.contentMatch.fillBefore(i).append(i),n<=0&&(i=i.append(r.type.contentMatch.matchFragment(i).fillBefore(Qe.empty,!0)))),r.copy(i)}function Iw(r,e,n,i,a){let s=r.node(e),o=a?r.indexAfter(e):r.index(e);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let l=i.fillBefore(s.content,!0,o);return l&&!VU(n,s.content,o)?l:null}function VU(r,e,n){for(let i=n;i<e.childCount;i++)if(!r.allowsMarks(e.child(i).marks))return!0;return!1}function UU(r){return r.spec.defining||r.spec.definingForContent}function HU(r,e,n,i){if(!i.size)return r.deleteRange(e,n);let a=r.doc.resolve(e),s=r.doc.resolve(n);if(l6(a,s,i))return r.step(new Ki(e,n,i));let o=d6(a,s);o[o.length-1]==0&&o.pop();let l=-(a.depth+1);o.unshift(l);for(let v=a.depth,y=a.pos-1;v>0;v--,y--){let b=a.node(v).type.spec;if(b.defining||b.definingAsContext||b.isolating)break;o.indexOf(v)>-1?l=v:a.before(v)==y&&o.splice(1,0,-v)}let u=o.indexOf(l),c=[],d=i.openStart;for(let v=i.content,y=0;;y++){let b=v.firstChild;if(c.push(b),y==i.openStart)break;v=b.content}for(let v=d-1;v>=0;v--){let y=c[v],b=UU(y.type);if(b&&!y.sameMarkup(a.node(Math.abs(l)-1)))d=v;else if(b||!y.type.isTextblock)break}for(let v=i.openStart;v>=0;v--){let y=(v+d+1)%(i.openStart+1),b=c[y];if(b)for(let S=0;S<o.length;S++){let k=o[(S+u)%o.length],T=!0;k<0&&(T=!1,k=-k);let C=a.node(k-1),N=a.index(k-1);if(C.canReplaceWith(N,N,b.type,b.marks))return r.replace(a.before(k),T?s.after(k):n,new St(c6(i.content,0,i.openStart,y),y,i.openEnd))}}let p=r.steps.length;for(let v=o.length-1;v>=0&&(r.replace(e,n,i),!(r.steps.length>p));v--){let y=o[v];y<0||(e=a.before(y),n=s.after(y))}}function c6(r,e,n,i,a){if(e<n){let s=r.firstChild;r=r.replaceChild(0,s.copy(c6(s.content,e+1,n,i,s)))}if(e>i){let s=a.contentMatchAt(0),o=s.fillBefore(r).append(r);r=o.append(s.matchFragment(o).fillBefore(Qe.empty,!0))}return r}function GU(r,e,n,i){if(!i.isInline&&e==n&&r.doc.resolve(e).parent.content.size){let a=zU(r.doc,e,i.type);a!=null&&(e=n=a)}r.replaceRange(e,n,new St(Qe.from(i),0,0))}function qU(r,e,n){let i=r.doc.resolve(e),a=r.doc.resolve(n),s=d6(i,a);for(let o=0;o<s.length;o++){let l=s[o],u=o==s.length-1;if(u&&l==0||i.node(l).type.contentMatch.validEnd)return r.delete(i.start(l),a.end(l));if(l>0&&(u||i.node(l-1).canReplace(i.index(l-1),a.indexAfter(l-1))))return r.delete(i.before(l),a.after(l))}for(let o=1;o<=i.depth&&o<=a.depth;o++)if(e-i.start(o)==i.depth-o&&n>i.end(o)&&a.end(o)-n!=a.depth-o&&i.start(o-1)==a.start(o-1)&&i.node(o-1).canReplace(i.index(o-1),a.index(o-1)))return r.delete(i.before(o),n);r.delete(e,n)}function d6(r,e){let n=[],i=Math.min(r.depth,e.depth);for(let a=i;a>=0;a--){let s=r.start(a);if(s<r.pos-(r.depth-a)||e.end(a)>e.pos+(e.depth-a)||r.node(a).type.spec.isolating||e.node(a).type.spec.isolating)break;(s==e.start(a)||a==r.depth&&a==e.depth&&r.parent.inlineContent&&e.parent.inlineContent&&a&&e.start(a-1)==s-1)&&n.push(a)}return n}class lp extends Ka{constructor(e,n,i){super(),this.pos=e,this.attr=n,this.value=i}apply(e){let n=e.nodeAt(this.pos);if(!n)return bi.fail("No node at attribute step's position");let i=Object.create(null);for(let s in n.attrs)i[s]=n.attrs[s];i[this.attr]=this.value;let a=n.type.create(i,null,n.marks);return bi.fromReplace(e,this.pos,this.pos+1,new St(Qe.from(a),0,n.isLeaf?0:1))}getMap(){return Ys.empty}invert(e){return new lp(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new lp(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new lp(n.pos,n.attr,n.value)}}Ka.jsonID("attr",lp);class Kg extends Ka{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let a in e.attrs)n[a]=e.attrs[a];n[this.attr]=this.value;let i=e.type.create(n,e.content,e.marks);return bi.ok(i)}getMap(){return Ys.empty}invert(e){return new Kg(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Kg(n.attr,n.value)}}Ka.jsonID("docAttr",Kg);let pp=class extends Error{};pp=function r(e){let n=Error.call(this,e);return n.__proto__=r.prototype,n};pp.prototype=Object.create(Error.prototype);pp.prototype.constructor=pp;pp.prototype.name="TransformError";class h6{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new $g}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new pp(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,n=-1e9;for(let i=0;i<this.mapping.maps.length;i++){let a=this.mapping.maps[i];i&&(e=a.map(e,1),n=a.map(n,-1)),a.forEach((s,o,l,u)=>{e=Math.min(e,l),n=Math.max(n,u)})}return e==1e9?null:{from:e,to:n}}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,i=St.empty){let a=Ix(this.doc,e,n,i);return a&&this.step(a),this}replaceWith(e,n,i){return this.replace(e,n,new St(Qe.from(i),0,0))}delete(e,n){return this.replace(e,n,St.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,i){return HU(this,e,n,i),this}replaceRangeWith(e,n,i){return GU(this,e,n,i),this}deleteRange(e,n){return qU(this,e,n),this}lift(e,n){return PU(this,e,n),this}join(e,n=1){return BU(this,e,n),this}wrap(e,n){return jU(this,e,n),this}setBlockType(e,n=e,i,a=null){return RU(this,e,n,i,a),this}setNodeMarkup(e,n,i=null,a){return OU(this,e,n,i,a),this}setNodeAttribute(e,n,i){return this.step(new lp(e,n,i)),this}setDocAttribute(e,n){return this.step(new Kg(e,n)),this}addNodeMark(e,n){return this.step(new cd(e,n)),this}removeNodeMark(e,n){let i=this.doc.nodeAt(e);if(!i)throw new RangeError("No node at position "+e);if(n instanceof tn)n.isInSet(i.marks)&&this.step(new Hh(e,n));else{let a=i.marks,s,o=[];for(;s=n.isInSet(a);)o.push(new Hh(e,s)),a=s.removeFromSet(a);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(e,n=1,i){return DU(this,e,n,i),this}addMark(e,n,i){return EU(this,e,n,i),this}removeMark(e,n,i){return NU(this,e,n,i),this}clearIncompatible(e,n,i){return oS(this,e,n,i),this}}const Bw=Object.create(null);class sr{constructor(e,n,i){this.$anchor=e,this.$head=n,this.ranges=i||[new WU(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=St.empty){let i=n.content.lastChild,a=null;for(let l=0;l<n.openEnd;l++)a=i,i=i.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:u,$to:c}=o[l],d=e.mapping.slice(s);e.replaceRange(d.map(u.pos),d.map(c.pos),l?St.empty:n),l==0&&yT(e,s,(i?i.isInline:a&&a.isTextblock)?-1:1)}}replaceWith(e,n){let i=e.steps.length,a=this.ranges;for(let s=0;s<a.length;s++){let{$from:o,$to:l}=a[s],u=e.mapping.slice(i),c=u.map(o.pos),d=u.map(l.pos);s?e.deleteRange(c,d):(e.replaceRangeWith(c,d,n),yT(e,i,n.isInline?-1:1))}}static findFrom(e,n,i=!1){let a=e.parent.inlineContent?new Qt(e):Kf(e.node(0),e.parent,e.pos,e.index(),n,i);if(a)return a;for(let s=e.depth-1;s>=0;s--){let o=n<0?Kf(e.node(0),e.node(s),e.before(s+1),e.index(s),n,i):Kf(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,i);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new Qs(e.node(0))}static atStart(e){return Kf(e,e,0,0,1)||new Qs(e)}static atEnd(e){return Kf(e,e,e.content.size,e.childCount,-1)||new Qs(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let i=Bw[n.type];if(!i)throw new RangeError(`No selection type ${n.type} defined`);return i.fromJSON(e,n)}static jsonID(e,n){if(e in Bw)throw new RangeError("Duplicate use of selection JSON ID "+e);return Bw[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Qt.between(this.$anchor,this.$head).getBookmark()}}sr.prototype.visible=!0;class WU{constructor(e,n){this.$from=e,this.$to=n}}let gT=!1;function vT(r){!gT&&!r.parent.inlineContent&&(gT=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+r.parent.type.name+")"))}class Qt extends sr{constructor(e,n=e){vT(e),vT(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let i=e.resolve(n.map(this.head));if(!i.parent.inlineContent)return sr.near(i);let a=e.resolve(n.map(this.anchor));return new Qt(a.parent.inlineContent?a:i,i)}replace(e,n=St.empty){if(super.replace(e,n),n==St.empty){let i=this.$from.marksAcross(this.$to);i&&e.ensureMarks(i)}}eq(e){return e instanceof Qt&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Bx(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Qt(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,i=n){let a=e.resolve(n);return new this(a,i==n?a:e.resolve(i))}static between(e,n,i){let a=e.pos-n.pos;if((!i||a)&&(i=a>=0?1:-1),!n.parent.inlineContent){let s=sr.findFrom(n,i,!0)||sr.findFrom(n,-i,!0);if(s)n=s.$head;else return sr.near(n,i)}return e.parent.inlineContent||(a==0?e=n:(e=(sr.findFrom(e,-i,!0)||sr.findFrom(e,i,!0)).$anchor,e.pos<n.pos!=a<0&&(e=n))),new Qt(e,n)}}sr.jsonID("text",Qt);class Bx{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Bx(e.map(this.anchor),e.map(this.head))}resolve(e){return Qt.between(e.resolve(this.anchor),e.resolve(this.head))}}class Bt extends sr{constructor(e){let n=e.nodeAfter,i=e.node(0).resolve(e.pos+n.nodeSize);super(e,i),this.node=n}map(e,n){let{deleted:i,pos:a}=n.mapResult(this.anchor),s=e.resolve(a);return i?sr.near(s):new Bt(s)}content(){return new St(Qe.from(this.node),0,0)}eq(e){return e instanceof Bt&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new uS(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Bt(e.resolve(n.anchor))}static create(e,n){return new Bt(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Bt.prototype.visible=!1;sr.jsonID("node",Bt);class uS{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:i}=e.mapResult(this.anchor);return n?new Bx(i,i):new uS(i)}resolve(e){let n=e.resolve(this.anchor),i=n.nodeAfter;return i&&Bt.isSelectable(i)?new Bt(n):sr.near(n)}}class Qs extends sr{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=St.empty){if(n==St.empty){e.delete(0,e.doc.content.size);let i=sr.atStart(e.doc);i.eq(e.selection)||e.setSelection(i)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new Qs(e)}map(e){return new Qs(e)}eq(e){return e instanceof Qs}getBookmark(){return $U}}sr.jsonID("all",Qs);const $U={map(){return this},resolve(r){return new Qs(r)}};function Kf(r,e,n,i,a,s=!1){if(e.inlineContent)return Qt.create(r,n);for(let o=i-(a>0?0:1);a>0?o<e.childCount:o>=0;o+=a){let l=e.child(o);if(l.isAtom){if(!s&&Bt.isSelectable(l))return Bt.create(r,n-(a<0?l.nodeSize:0))}else{let u=Kf(r,l,n+a,a<0?l.childCount:0,a,s);if(u)return u}n+=l.nodeSize*a}return null}function yT(r,e,n){let i=r.steps.length-1;if(i<e)return;let a=r.steps[i];if(!(a instanceof Ki||a instanceof Qi))return;let s=r.mapping.maps[i],o;s.forEach((l,u,c,d)=>{o==null&&(o=d)}),r.setSelection(sr.near(r.doc.resolve(o),n))}const xT=1,k0=2,bT=4;class KU extends h6{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|xT)&~k0,this.storedMarks=null,this}get selectionSet(){return(this.updated&xT)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=k0,this}ensureMarks(e){return tn.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&k0)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~k0,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let i=this.selection;return n&&(e=e.mark(this.storedMarks||(i.empty?i.$from.marks():i.$from.marksAcross(i.$to)||tn.none))),i.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,i){let a=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(a.text(e),!0):this.deleteSelection();{if(i==null&&(i=n),!e)return this.deleteRange(n,i);let s=this.storedMarks;if(!s){let o=this.doc.resolve(n);s=i==n?o.marks():o.marksAcross(this.doc.resolve(i))}return this.replaceRangeWith(n,i,a.text(e,s)),!this.selection.empty&&this.selection.to==n+e.length&&this.setSelection(sr.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=bT,this}get scrolledIntoView(){return(this.updated&bT)>0}}function wT(r,e){return!e||!r?r:r.bind(e)}class pg{constructor(e,n,i){this.name=e,this.init=wT(n.init,i),this.apply=wT(n.apply,i)}}const ZU=[new pg("doc",{init(r){return r.doc||r.schema.topNodeType.createAndFill()},apply(r){return r.doc}}),new pg("selection",{init(r,e){return r.selection||sr.atStart(e.doc)},apply(r){return r.selection}}),new pg("storedMarks",{init(r){return r.storedMarks||null},apply(r,e,n,i){return i.selection.$cursor?r.storedMarks:null}}),new pg("scrollToSelection",{init(){return 0},apply(r,e){return r.scrolledIntoView?e+1:e}})];class zw{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ZU.slice(),n&&n.forEach(i=>{if(this.pluginsByKey[i.key])throw new RangeError("Adding different instances of a keyed plugin ("+i.key+")");this.plugins.push(i),this.pluginsByKey[i.key]=i,i.spec.state&&this.fields.push(new pg(i.key,i.spec.state,i))})}}class rp{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let i=0;i<this.config.plugins.length;i++)if(i!=n){let a=this.config.plugins[i];if(a.spec.filterTransaction&&!a.spec.filterTransaction.call(a,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],i=this.applyInner(e),a=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let u=a?a[o].n:0,c=a?a[o].state:this,d=u<n.length&&l.spec.appendTransaction.call(l,u?n.slice(u):n,c,i);if(d&&i.filterTransaction(d,o)){if(d.setMeta("appendedTransaction",e),!a){a=[];for(let p=0;p<this.config.plugins.length;p++)a.push(p<o?{state:i,n:n.length}:{state:this,n:0})}n.push(d),i=i.applyInner(d),s=!0}a&&(a[o]={state:i,n:n.length})}}if(!s)return{state:i,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new rp(this.config),i=this.config.fields;for(let a=0;a<i.length;a++){let s=i[a];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new KU(this)}static create(e){let n=new zw(e.doc?e.doc.type.schema:e.schema,e.plugins),i=new rp(n);for(let a=0;a<n.fields.length;a++)i[n.fields[a].name]=n.fields[a].init(e,i);return i}reconfigure(e){let n=new zw(this.schema,e.plugins),i=n.fields,a=new rp(n);for(let s=0;s<i.length;s++){let o=i[s].name;a[o]=this.hasOwnProperty(o)?this[o]:i[s].init(e,a)}return a}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(i=>i.toJSON())),e&&typeof e=="object")for(let i in e){if(i=="doc"||i=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let a=e[i],s=a.spec.state;s&&s.toJSON&&(n[i]=s.toJSON.call(a,this[a.key]))}return n}static fromJSON(e,n,i){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let a=new zw(e.schema,e.plugins),s=new rp(a);return a.fields.forEach(o=>{if(o.name=="doc")s.doc=Po.fromJSON(e.schema,n.doc);else if(o.name=="selection")s.selection=sr.fromJSON(s.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(i)for(let l in i){let u=i[l],c=u.spec.state;if(u.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){s[o.name]=c.fromJSON.call(u,e,n[l],s);return}}s[o.name]=o.init(e,s)}}),s}}function f6(r,e,n){for(let i in r){let a=r[i];a instanceof Function?a=a.bind(e):i=="handleDOMEvents"&&(a=f6(a,e,{})),n[i]=a}return n}class On{constructor(e){this.spec=e,this.props={},e.props&&f6(e.props,this,this.props),this.key=e.key?e.key.key:p6("plugin")}getState(e){return e[this.key]}}const Fw=Object.create(null);function p6(r){return r in Fw?r+"$"+ ++Fw[r]:(Fw[r]=0,r+"$")}class li{constructor(e="key"){this.key=p6(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const cS=(r,e)=>r.selection.empty?!1:(e&&e(r.tr.deleteSelection().scrollIntoView()),!0);function m6(r,e){let{$cursor:n}=r.selection;return!n||(e?!e.endOfTextblock("backward",r):n.parentOffset>0)?null:n}const g6=(r,e,n)=>{let i=m6(r,n);if(!i)return!1;let a=dS(i);if(!a){let o=i.blockRange(),l=o&&Lp(o);return l==null?!1:(e&&e(r.tr.lift(o,l).scrollIntoView()),!0)}let s=a.nodeBefore;if(C6(r,a,e,-1))return!0;if(i.parent.content.size==0&&(mp(s,"end")||Bt.isSelectable(s)))for(let o=i.depth;;o--){let l=Ix(r.doc,i.before(o),i.after(o),St.empty);if(l&&l.slice.size<l.to-l.from){if(e){let u=r.tr.step(l);u.setSelection(mp(s,"end")?sr.findFrom(u.doc.resolve(u.mapping.map(a.pos,-1)),-1):Bt.create(u.doc,a.pos-s.nodeSize)),e(u.scrollIntoView())}return!0}if(o==1||i.node(o-1).childCount>1)break}return s.isAtom&&a.depth==i.depth-1?(e&&e(r.tr.delete(a.pos-s.nodeSize,a.pos).scrollIntoView()),!0):!1},YU=(r,e,n)=>{let i=m6(r,n);if(!i)return!1;let a=dS(i);return a?v6(r,a,e):!1},XU=(r,e,n)=>{let i=x6(r,n);if(!i)return!1;let a=hS(i);return a?v6(r,a,e):!1};function v6(r,e,n){let i=e.nodeBefore,a=i,s=e.pos-1;for(;!a.isTextblock;s--){if(a.type.spec.isolating)return!1;let d=a.lastChild;if(!d)return!1;a=d}let o=e.nodeAfter,l=o,u=e.pos+1;for(;!l.isTextblock;u++){if(l.type.spec.isolating)return!1;let d=l.firstChild;if(!d)return!1;l=d}let c=Ix(r.doc,s,u,St.empty);if(!c||c.from!=s||c instanceof Ki&&c.slice.size>=u-s)return!1;if(n){let d=r.tr.step(c);d.setSelection(Qt.create(d.doc,s)),n(d.scrollIntoView())}return!0}function mp(r,e,n=!1){for(let i=r;i;i=e=="start"?i.firstChild:i.lastChild){if(i.isTextblock)return!0;if(n&&i.childCount!=1)return!1}return!1}const y6=(r,e,n)=>{let{$head:i,empty:a}=r.selection,s=i;if(!a)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("backward",r):i.parentOffset>0)return!1;s=dS(i)}let o=s&&s.nodeBefore;return!o||!Bt.isSelectable(o)?!1:(e&&e(r.tr.setSelection(Bt.create(r.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function dS(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){if(r.index(e)>0)return r.doc.resolve(r.before(e+1));if(r.node(e).type.spec.isolating)break}return null}function x6(r,e){let{$cursor:n}=r.selection;return!n||(e?!e.endOfTextblock("forward",r):n.parentOffset<n.parent.content.size)?null:n}const b6=(r,e,n)=>{let i=x6(r,n);if(!i)return!1;let a=hS(i);if(!a)return!1;let s=a.nodeAfter;if(C6(r,a,e,1))return!0;if(i.parent.content.size==0&&(mp(s,"start")||Bt.isSelectable(s))){let o=Ix(r.doc,i.before(),i.after(),St.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=r.tr.step(o);l.setSelection(mp(s,"start")?sr.findFrom(l.doc.resolve(l.mapping.map(a.pos)),1):Bt.create(l.doc,l.mapping.map(a.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&a.depth==i.depth-1?(e&&e(r.tr.delete(a.pos,a.pos+s.nodeSize).scrollIntoView()),!0):!1},w6=(r,e,n)=>{let{$head:i,empty:a}=r.selection,s=i;if(!a)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("forward",r):i.parentOffset<i.parent.content.size)return!1;s=hS(i)}let o=s&&s.nodeAfter;return!o||!Bt.isSelectable(o)?!1:(e&&e(r.tr.setSelection(Bt.create(r.doc,s.pos)).scrollIntoView()),!0)};function hS(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){let n=r.node(e);if(r.index(e)+1<n.childCount)return r.doc.resolve(r.after(e+1));if(n.type.spec.isolating)break}return null}const QU=(r,e)=>{let n=r.selection,i=n instanceof Bt,a;if(i){if(n.node.isTextblock||!Od(r.doc,n.from))return!1;a=n.from}else if(a=Dx(r.doc,n.from,-1),a==null)return!1;if(e){let s=r.tr.join(a);i&&s.setSelection(Bt.create(s.doc,a-r.doc.resolve(a).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},JU=(r,e)=>{let n=r.selection,i;if(n instanceof Bt){if(n.node.isTextblock||!Od(r.doc,n.to))return!1;i=n.to}else if(i=Dx(r.doc,n.to,1),i==null)return!1;return e&&e(r.tr.join(i).scrollIntoView()),!0},eH=(r,e)=>{let{$from:n,$to:i}=r.selection,a=n.blockRange(i),s=a&&Lp(a);return s==null?!1:(e&&e(r.tr.lift(a,s).scrollIntoView()),!0)},_6=(r,e)=>{let{$head:n,$anchor:i}=r.selection;return!n.parent.type.spec.code||!n.sameParent(i)?!1:(e&&e(r.tr.insertText(`
`).scrollIntoView()),!0)};function fS(r){for(let e=0;e<r.edgeCount;e++){let{type:n}=r.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const tH=(r,e)=>{let{$head:n,$anchor:i}=r.selection;if(!n.parent.type.spec.code||!n.sameParent(i))return!1;let a=n.node(-1),s=n.indexAfter(-1),o=fS(a.contentMatchAt(s));if(!o||!a.canReplaceWith(s,s,o))return!1;if(e){let l=n.after(),u=r.tr.replaceWith(l,l,o.createAndFill());u.setSelection(sr.near(u.doc.resolve(l),1)),e(u.scrollIntoView())}return!0},S6=(r,e)=>{let n=r.selection,{$from:i,$to:a}=n;if(n instanceof Qs||i.parent.inlineContent||a.parent.inlineContent)return!1;let s=fS(a.parent.contentMatchAt(a.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!i.parentOffset&&a.index()<a.parent.childCount?i:a).pos,l=r.tr.insert(o,s.createAndFill());l.setSelection(Qt.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},k6=(r,e)=>{let{$cursor:n}=r.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(qu(r.doc,s))return e&&e(r.tr.split(s).scrollIntoView()),!0}let i=n.blockRange(),a=i&&Lp(i);return a==null?!1:(e&&e(r.tr.lift(i,a).scrollIntoView()),!0)};function rH(r){return(e,n)=>{let{$from:i,$to:a}=e.selection;if(e.selection instanceof Bt&&e.selection.node.isBlock)return!i.parentOffset||!qu(e.doc,i.pos)?!1:(n&&n(e.tr.split(i.pos).scrollIntoView()),!0);if(!i.depth)return!1;let s=[],o,l,u=!1,c=!1;for(let y=i.depth;;y--)if(i.node(y).isBlock){u=i.end(y)==i.pos+(i.depth-y),c=i.start(y)==i.pos-(i.depth-y),l=fS(i.node(y-1).contentMatchAt(i.indexAfter(y-1))),s.unshift(u&&l?{type:l}:null),o=y;break}else{if(y==1)return!1;s.unshift(null)}let d=e.tr;(e.selection instanceof Qt||e.selection instanceof Qs)&&d.deleteSelection();let p=d.mapping.map(i.pos),v=qu(d.doc,p,s.length,s);if(v||(s[0]=l?{type:l}:null,v=qu(d.doc,p,s.length,s)),!v)return!1;if(d.split(p,s.length,s),!u&&c&&i.node(o).type!=l){let y=d.mapping.map(i.before(o)),b=d.doc.resolve(y);l&&i.node(o-1).canReplaceWith(b.index(),b.index()+1,l)&&d.setNodeMarkup(d.mapping.map(i.before(o)),l)}return n&&n(d.scrollIntoView()),!0}}const nH=rH(),iH=(r,e)=>{let{$from:n,to:i}=r.selection,a,s=n.sharedDepth(i);return s==0?!1:(a=n.before(s),e&&e(r.tr.setSelection(Bt.create(r.doc,a))),!0)};function aH(r,e,n){let i=e.nodeBefore,a=e.nodeAfter,s=e.index();return!i||!a||!i.type.compatibleContent(a.type)?!1:!i.content.size&&e.parent.canReplace(s-1,s)?(n&&n(r.tr.delete(e.pos-i.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(a.isTextblock||Od(r.doc,e.pos))?!1:(n&&n(r.tr.join(e.pos).scrollIntoView()),!0)}function C6(r,e,n,i){let a=e.nodeBefore,s=e.nodeAfter,o,l,u=a.type.spec.isolating||s.type.spec.isolating;if(!u&&aH(r,e,n))return!0;let c=!u&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(o=(l=a.contentMatchAt(a.childCount)).findWrapping(s.type))&&l.matchType(o[0]||s.type).validEnd){if(n){let y=e.pos+s.nodeSize,b=Qe.empty;for(let T=o.length-1;T>=0;T--)b=Qe.from(o[T].create(null,b));b=Qe.from(a.copy(b));let S=r.tr.step(new Qi(e.pos-1,y,e.pos,y,new St(b,1,0),o.length,!0)),k=S.doc.resolve(y+2*o.length);k.nodeAfter&&k.nodeAfter.type==a.type&&Od(S.doc,k.pos)&&S.join(k.pos),n(S.scrollIntoView())}return!0}let d=s.type.spec.isolating||i>0&&u?null:sr.findFrom(e,1),p=d&&d.$from.blockRange(d.$to),v=p&&Lp(p);if(v!=null&&v>=e.depth)return n&&n(r.tr.lift(p,v).scrollIntoView()),!0;if(c&&mp(s,"start",!0)&&mp(a,"end")){let y=a,b=[];for(;b.push(y),!y.isTextblock;)y=y.lastChild;let S=s,k=1;for(;!S.isTextblock;S=S.firstChild)k++;if(y.canReplace(y.childCount,y.childCount,S.content)){if(n){let T=Qe.empty;for(let N=b.length-1;N>=0;N--)T=Qe.from(b[N].copy(T));let C=r.tr.step(new Qi(e.pos-b.length,e.pos+s.nodeSize,e.pos+k,e.pos+s.nodeSize-k,new St(T,b.length,0),0,!0));n(C.scrollIntoView())}return!0}}return!1}function E6(r){return function(e,n){let i=e.selection,a=r<0?i.$from:i.$to,s=a.depth;for(;a.node(s).isInline;){if(!s)return!1;s--}return a.node(s).isTextblock?(n&&n(e.tr.setSelection(Qt.create(e.doc,r<0?a.start(s):a.end(s)))),!0):!1}}const sH=E6(-1),oH=E6(1);function lH(r,e=null){return function(n,i){let{$from:a,$to:s}=n.selection,o=a.blockRange(s),l=o&&lS(o,r,e);return l?(i&&i(n.tr.wrap(o,l).scrollIntoView()),!0):!1}}function _T(r,e=null){return function(n,i){let a=!1;for(let s=0;s<n.selection.ranges.length&&!a;s++){let{$from:{pos:o},$to:{pos:l}}=n.selection.ranges[s];n.doc.nodesBetween(o,l,(u,c)=>{if(a)return!1;if(!(!u.isTextblock||u.hasMarkup(r,e)))if(u.type==r)a=!0;else{let d=n.doc.resolve(c),p=d.index();a=d.parent.canReplaceWith(p,p+1,r)}})}if(!a)return!1;if(i){let s=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:u}}=n.selection.ranges[o];s.setBlockType(l,u,r,e)}i(s.scrollIntoView())}return!0}}function pS(...r){return function(e,n,i){for(let a=0;a<r.length;a++)if(r[a](e,n,i))return!0;return!1}}pS(cS,g6,y6);pS(cS,b6,w6);pS(_6,S6,k6,nH);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function uH(r,e=null){return function(n,i){let{$from:a,$to:s}=n.selection,o=a.blockRange(s);if(!o)return!1;let l=i?n.tr:null;return cH(l,o,r,e)?(i&&i(l.scrollIntoView()),!0):!1}}function cH(r,e,n,i=null){let a=!1,s=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let u=o.resolve(e.start-2);s=new wy(u,u,e.depth),e.endIndex<e.parent.childCount&&(e=new wy(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),a=!0}let l=lS(s,n,i,e);return l?(r&&dH(r,e,l,a,n),!0):!1}function dH(r,e,n,i,a){let s=Qe.empty;for(let d=n.length-1;d>=0;d--)s=Qe.from(n[d].type.create(n[d].attrs,s));r.step(new Qi(e.start-(i?2:0),e.end,e.start,e.end,new St(s,0,0),n.length,!0));let o=0;for(let d=0;d<n.length;d++)n[d].type==a&&(o=d+1);let l=n.length-o,u=e.start+n.length-(i?2:0),c=e.parent;for(let d=e.startIndex,p=e.endIndex,v=!0;d<p;d++,v=!1)!v&&qu(r.doc,u,l)&&(r.split(u,l),u+=2*l),u+=c.child(d).nodeSize;return r}function hH(r){return function(e,n){let{$from:i,$to:a}=e.selection,s=i.blockRange(a,o=>o.childCount>0&&o.firstChild.type==r);return s?n?i.node(s.depth-1).type==r?fH(e,n,r,s):pH(e,n,s):!0:!1}}function fH(r,e,n,i){let a=r.tr,s=i.end,o=i.$to.end(i.depth);s<o&&(a.step(new Qi(s-1,o,s,o,new St(Qe.from(n.create(null,i.parent.copy())),1,0),1,!0)),i=new wy(a.doc.resolve(i.$from.pos),a.doc.resolve(o),i.depth));const l=Lp(i);if(l==null)return!1;a.lift(i,l);let u=a.doc.resolve(a.mapping.map(s,-1)-1);return Od(a.doc,u.pos)&&u.nodeBefore.type==u.nodeAfter.type&&a.join(u.pos),e(a.scrollIntoView()),!0}function pH(r,e,n){let i=r.tr,a=n.parent;for(let y=n.end,b=n.endIndex-1,S=n.startIndex;b>S;b--)y-=a.child(b).nodeSize,i.delete(y-1,y+1);let s=i.doc.resolve(n.start),o=s.nodeAfter;if(i.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let l=n.startIndex==0,u=n.endIndex==a.childCount,c=s.node(-1),d=s.index(-1);if(!c.canReplace(d+(l?0:1),d+1,o.content.append(u?Qe.empty:Qe.from(a))))return!1;let p=s.pos,v=p+o.nodeSize;return i.step(new Qi(p-(l?1:0),v+(u?1:0),p+1,v-1,new St((l?Qe.empty:Qe.from(a.copy(Qe.empty))).append(u?Qe.empty:Qe.from(a.copy(Qe.empty))),l?0:1,u?0:1),l?0:1)),e(i.scrollIntoView()),!0}function mH(r){return function(e,n){let{$from:i,$to:a}=e.selection,s=i.blockRange(a,c=>c.childCount>0&&c.firstChild.type==r);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,u=l.child(o-1);if(u.type!=r)return!1;if(n){let c=u.lastChild&&u.lastChild.type==l.type,d=Qe.from(c?r.create():null),p=new St(Qe.from(r.create(null,Qe.from(l.type.create(null,d)))),c?3:1,0),v=s.start,y=s.end;n(e.tr.step(new Qi(v-(c?3:1),y,v,y,p,1,!0)).scrollIntoView())}return!0}}const _a=function(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e},gp=function(r){let e=r.assignedSlot||r.parentNode;return e&&e.nodeType==11?e.host:e};let q2=null;const Vu=function(r,e,n){let i=q2||(q2=document.createRange());return i.setEnd(r,n??r.nodeValue.length),i.setStart(r,e||0),i},gH=function(){q2=null},Gh=function(r,e,n,i){return n&&(ST(r,e,n,i,-1)||ST(r,e,n,i,1))},vH=/^(img|br|input|textarea|hr)$/i;function ST(r,e,n,i,a){for(var s;;){if(r==n&&e==i)return!0;if(e==(a<0?0:No(r))){let o=r.parentNode;if(!o||o.nodeType!=1||yv(r)||vH.test(r.nodeName)||r.contentEditable=="false")return!1;e=_a(r)+(a<0?0:1),r=o}else if(r.nodeType==1){let o=r.childNodes[e+(a<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((s=o.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=a;else return!1;else r=o,e=a<0?No(r):0}else return!1}}function No(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function yH(r,e){for(;;){if(r.nodeType==3&&e)return r;if(r.nodeType==1&&e>0){if(r.contentEditable=="false")return null;r=r.childNodes[e-1],e=No(r)}else if(r.parentNode&&!yv(r))e=_a(r),r=r.parentNode;else return null}}function xH(r,e){for(;;){if(r.nodeType==3&&e<r.nodeValue.length)return r;if(r.nodeType==1&&e<r.childNodes.length){if(r.contentEditable=="false")return null;r=r.childNodes[e],e=0}else if(r.parentNode&&!yv(r))e=_a(r)+1,r=r.parentNode;else return null}}function bH(r,e,n){for(let i=e==0,a=e==No(r);i||a;){if(r==n)return!0;let s=_a(r);if(r=r.parentNode,!r)return!1;i=i&&s==0,a=a&&s==No(r)}}function yv(r){let e;for(let n=r;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==r||e.contentDOM==r)}const zx=function(r){return r.focusNode&&Gh(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)};function _h(r,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=r,n.key=n.code=e,n}function wH(r){let e=r.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function _H(r,e,n){if(r.caretPositionFromPoint)try{let i=r.caretPositionFromPoint(e,n);if(i)return{node:i.offsetNode,offset:Math.min(No(i.offsetNode),i.offset)}}catch{}if(r.caretRangeFromPoint){let i=r.caretRangeFromPoint(e,n);if(i)return{node:i.startContainer,offset:Math.min(No(i.startContainer),i.startOffset)}}}const tu=typeof navigator<"u"?navigator:null,kT=typeof document<"u"?document:null,Dd=tu&&tu.userAgent||"",W2=/Edge\/(\d+)/.exec(Dd),N6=/MSIE \d/.exec(Dd),$2=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Dd),Rs=!!(N6||$2||W2),vd=N6?document.documentMode:$2?+$2[1]:W2?+W2[1]:0,Mo=!Rs&&/gecko\/(\d+)/i.test(Dd);Mo&&+(/Firefox\/(\d+)/.exec(Dd)||[0,0])[1];const K2=!Rs&&/Chrome\/(\d+)/.exec(Dd),Zi=!!K2,T6=K2?+K2[1]:0,Ea=!Rs&&!!tu&&/Apple Computer/.test(tu.vendor),vp=Ea&&(/Mobile\/\w+/.test(Dd)||!!tu&&tu.maxTouchPoints>2),Co=vp||(tu?/Mac/.test(tu.platform):!1),P6=tu?/Win/.test(tu.platform):!1,Gu=/Android \d/.test(Dd),xv=!!kT&&"webkitFontSmoothing"in kT.documentElement.style,SH=xv?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function kH(r){let e=r.defaultView&&r.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.documentElement.clientWidth,top:0,bottom:r.documentElement.clientHeight}}function Iu(r,e){return typeof r=="number"?r:r[e]}function CH(r){let e=r.getBoundingClientRect(),n=e.width/r.offsetWidth||1,i=e.height/r.offsetHeight||1;return{left:e.left,right:e.left+r.clientWidth*n,top:e.top,bottom:e.top+r.clientHeight*i}}function CT(r,e,n){let i=r.someProp("scrollThreshold")||0,a=r.someProp("scrollMargin")||5,s=r.dom.ownerDocument;for(let o=n||r.dom;o;){if(o.nodeType!=1){o=gp(o);continue}let l=o,u=l==s.body,c=u?kH(s):CH(l),d=0,p=0;if(e.top<c.top+Iu(i,"top")?p=-(c.top-e.top+Iu(a,"top")):e.bottom>c.bottom-Iu(i,"bottom")&&(p=e.bottom-e.top>c.bottom-c.top?e.top+Iu(a,"top")-c.top:e.bottom-c.bottom+Iu(a,"bottom")),e.left<c.left+Iu(i,"left")?d=-(c.left-e.left+Iu(a,"left")):e.right>c.right-Iu(i,"right")&&(d=e.right-c.right+Iu(a,"right")),d||p)if(u)s.defaultView.scrollBy(d,p);else{let y=l.scrollLeft,b=l.scrollTop;p&&(l.scrollTop+=p),d&&(l.scrollLeft+=d);let S=l.scrollLeft-y,k=l.scrollTop-b;e={left:e.left-S,top:e.top-k,right:e.right-S,bottom:e.bottom-k}}let v=u?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(v))break;o=v=="absolute"?o.offsetParent:gp(o)}}function EH(r){let e=r.dom.getBoundingClientRect(),n=Math.max(0,e.top),i,a;for(let s=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=r.root.elementFromPoint(s,o);if(!l||l==r.dom||!r.dom.contains(l))continue;let u=l.getBoundingClientRect();if(u.top>=n-20){i=l,a=u.top;break}}return{refDOM:i,refTop:a,stack:M6(r.dom)}}function M6(r){let e=[],n=r.ownerDocument;for(let i=r;i&&(e.push({dom:i,top:i.scrollTop,left:i.scrollLeft}),r!=n);i=gp(i));return e}function NH({refDOM:r,refTop:e,stack:n}){let i=r?r.getBoundingClientRect().top:0;A6(n,i==0?0:i-e)}function A6(r,e){for(let n=0;n<r.length;n++){let{dom:i,top:a,left:s}=r[n];i.scrollTop!=a+e&&(i.scrollTop=a+e),i.scrollLeft!=s&&(i.scrollLeft=s)}}let Gf=null;function TH(r){if(r.setActive)return r.setActive();if(Gf)return r.focus(Gf);let e=M6(r);r.focus(Gf==null?{get preventScroll(){return Gf={preventScroll:!0},!0}}:void 0),Gf||(Gf=!1,A6(e,0))}function j6(r,e){let n,i=2e8,a,s=0,o=e.top,l=e.top,u,c;for(let d=r.firstChild,p=0;d;d=d.nextSibling,p++){let v;if(d.nodeType==1)v=d.getClientRects();else if(d.nodeType==3)v=Vu(d).getClientRects();else continue;for(let y=0;y<v.length;y++){let b=v[y];if(b.top<=o&&b.bottom>=l){o=Math.max(b.bottom,o),l=Math.min(b.top,l);let S=b.left>e.left?b.left-e.left:b.right<e.left?e.left-b.right:0;if(S<i){n=d,i=S,a=S&&n.nodeType==3?{left:b.right<e.left?b.right:b.left,top:e.top}:e,d.nodeType==1&&S&&(s=p+(e.left>=(b.left+b.right)/2?1:0));continue}}else b.top>e.top&&!u&&b.left<=e.left&&b.right>=e.left&&(u=d,c={left:Math.max(b.left,Math.min(b.right,e.left)),top:b.top});!n&&(e.left>=b.right&&e.top>=b.top||e.left>=b.left&&e.top>=b.bottom)&&(s=p+1)}}return!n&&u&&(n=u,a=c,i=0),n&&n.nodeType==3?PH(n,a):!n||i&&n.nodeType==1?{node:r,offset:s}:j6(n,a)}function PH(r,e){let n=r.nodeValue.length,i=document.createRange(),a;for(let s=0;s<n;s++){i.setEnd(r,s+1),i.setStart(r,s);let o=Xc(i,1);if(o.top!=o.bottom&&mS(e,o)){a={node:r,offset:s+(e.left>=(o.left+o.right)/2?1:0)};break}}return i.detach(),a||{node:r,offset:0}}function mS(r,e){return r.left>=e.left-1&&r.left<=e.right+1&&r.top>=e.top-1&&r.top<=e.bottom+1}function MH(r,e){let n=r.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<r.getBoundingClientRect().left?n:r}function AH(r,e,n){let{node:i,offset:a}=j6(e,n),s=-1;if(i.nodeType==1&&!i.firstChild){let o=i.getBoundingClientRect();s=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return r.docView.posFromDOM(i,a,s)}function jH(r,e,n,i){let a=-1;for(let s=e,o=!1;s!=r.dom;){let l=r.docView.nearestDesc(s,!0),u;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((u=l.dom.getBoundingClientRect()).width||u.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!o&&u.left>i.left||u.top>i.top?a=l.posBefore:(!o&&u.right<i.left||u.bottom<i.top)&&(a=l.posAfter),o=!0),!l.contentDOM&&a<0&&!l.node.isText))return(l.node.isBlock?i.top<(u.top+u.bottom)/2:i.left<(u.left+u.right)/2)?l.posBefore:l.posAfter;s=l.dom.parentNode}return a>-1?a:r.docView.posFromDOM(e,n,-1)}function R6(r,e,n){let i=r.childNodes.length;if(i&&n.top<n.bottom)for(let a=Math.max(0,Math.min(i-1,Math.floor(i*(e.top-n.top)/(n.bottom-n.top))-2)),s=a;;){let o=r.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let u=0;u<l.length;u++){let c=l[u];if(mS(e,c))return R6(o,e,c)}}if((s=(s+1)%i)==a)break}return r}function RH(r,e){let n=r.dom.ownerDocument,i,a=0,s=_H(n,e.left,e.top);s&&({node:i,offset:a}=s);let o=(r.root.elementFromPoint?r.root:n).elementFromPoint(e.left,e.top),l;if(!o||!r.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=r.dom.getBoundingClientRect();if(!mS(e,c)||(o=R6(r.dom,e,c),!o))return null}if(Ea)for(let c=o;i&&c;c=gp(c))c.draggable&&(i=void 0);if(o=MH(o,e),i){if(Mo&&i.nodeType==1&&(a=Math.min(a,i.childNodes.length),a<i.childNodes.length)){let d=i.childNodes[a],p;d.nodeName=="IMG"&&(p=d.getBoundingClientRect()).right<=e.left&&p.bottom>e.top&&a++}let c;xv&&a&&i.nodeType==1&&(c=i.childNodes[a-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&a--,i==r.dom&&a==i.childNodes.length-1&&i.lastChild.nodeType==1&&e.top>i.lastChild.getBoundingClientRect().bottom?l=r.state.doc.content.size:(a==0||i.nodeType!=1||i.childNodes[a-1].nodeName!="BR")&&(l=jH(r,i,a,e))}l==null&&(l=AH(r,o,e));let u=r.docView.nearestDesc(o,!0);return{pos:l,inside:u?u.posAtStart-u.border:-1}}function ET(r){return r.top<r.bottom||r.left<r.right}function Xc(r,e){let n=r.getClientRects();if(n.length){let i=n[e<0?0:n.length-1];if(ET(i))return i}return Array.prototype.find.call(n,ET)||r.getBoundingClientRect()}const LH=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function L6(r,e,n){let{node:i,offset:a,atom:s}=r.docView.domFromPos(e,n<0?-1:1),o=xv||Mo;if(i.nodeType==3)if(o&&(LH.test(i.nodeValue)||(n<0?!a:a==i.nodeValue.length))){let u=Xc(Vu(i,a,a),n);if(Mo&&a&&/\s/.test(i.nodeValue[a-1])&&a<i.nodeValue.length){let c=Xc(Vu(i,a-1,a-1),-1);if(c.top==u.top){let d=Xc(Vu(i,a,a+1),-1);if(d.top!=u.top)return rg(d,d.left<c.left)}}return u}else{let u=a,c=a,d=n<0?1:-1;return n<0&&!a?(c++,d=-1):n>=0&&a==i.nodeValue.length?(u--,d=1):n<0?u--:c++,rg(Xc(Vu(i,u,c),d),d<0)}if(!r.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&a&&(n<0||a==No(i))){let u=i.childNodes[a-1];if(u.nodeType==1)return Vw(u.getBoundingClientRect(),!1)}if(s==null&&a<No(i)){let u=i.childNodes[a];if(u.nodeType==1)return Vw(u.getBoundingClientRect(),!0)}return Vw(i.getBoundingClientRect(),n>=0)}if(s==null&&a&&(n<0||a==No(i))){let u=i.childNodes[a-1],c=u.nodeType==3?Vu(u,No(u)-(o?0:1)):u.nodeType==1&&(u.nodeName!="BR"||!u.nextSibling)?u:null;if(c)return rg(Xc(c,1),!1)}if(s==null&&a<No(i)){let u=i.childNodes[a];for(;u.pmViewDesc&&u.pmViewDesc.ignoreForCoords;)u=u.nextSibling;let c=u?u.nodeType==3?Vu(u,0,o?0:1):u.nodeType==1?u:null:null;if(c)return rg(Xc(c,-1),!0)}return rg(Xc(i.nodeType==3?Vu(i):i,-n),n>=0)}function rg(r,e){if(r.width==0)return r;let n=e?r.left:r.right;return{top:r.top,bottom:r.bottom,left:n,right:n}}function Vw(r,e){if(r.height==0)return r;let n=e?r.top:r.bottom;return{top:n,bottom:n,left:r.left,right:r.right}}function O6(r,e,n){let i=r.state,a=r.root.activeElement;i!=e&&r.updateState(e),a!=r.dom&&r.focus();try{return n()}finally{i!=e&&r.updateState(i),a!=r.dom&&a&&a.focus()}}function OH(r,e,n){let i=e.selection,a=n=="up"?i.$from:i.$to;return O6(r,e,()=>{let{node:s}=r.docView.domFromPos(a.pos,n=="up"?-1:1);for(;;){let l=r.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=L6(r,a.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let u;if(l.nodeType==1)u=l.getClientRects();else if(l.nodeType==3)u=Vu(l,0,l.nodeValue.length).getClientRects();else continue;for(let c=0;c<u.length;c++){let d=u[c];if(d.bottom>d.top+1&&(n=="up"?o.top-d.top>(d.bottom-o.top)*2:d.bottom-o.bottom>(o.bottom-d.top)*2))return!1}}return!0})}const DH=/[\u0590-\u08ac]/;function IH(r,e,n){let{$head:i}=e.selection;if(!i.parent.isTextblock)return!1;let a=i.parentOffset,s=!a,o=a==i.parent.content.size,l=r.domSelection();return l?!DH.test(i.parent.textContent)||!l.modify?n=="left"||n=="backward"?s:o:O6(r,e,()=>{let{focusNode:u,focusOffset:c,anchorNode:d,anchorOffset:p}=r.domSelectionRange(),v=l.caretBidiLevel;l.modify("move",n,"character");let y=i.depth?r.docView.domAfterPos(i.before()):r.dom,{focusNode:b,focusOffset:S}=r.domSelectionRange(),k=b&&!y.contains(b.nodeType==1?b:b.parentNode)||u==b&&c==S;try{l.collapse(d,p),u&&(u!=d||c!=p)&&l.extend&&l.extend(u,c)}catch{}return v!=null&&(l.caretBidiLevel=v),k}):i.pos==i.start()||i.pos==i.end()}let NT=null,TT=null,PT=!1;function BH(r,e,n){return NT==e&&TT==n?PT:(NT=e,TT=n,PT=n=="up"||n=="down"?OH(r,e,n):IH(r,e,n))}const Ao=0,MT=1,kh=2,ru=3;class bv{constructor(e,n,i,a){this.parent=e,this.children=n,this.dom=i,this.contentDOM=a,this.dirty=Ao,i.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,i){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,i=this.posAtStart;;n++){let a=this.children[n];if(a==e)return i;i+=a.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,i){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(i<0){let s,o;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let a;if(e==this.dom&&this.contentDOM)a=n>_a(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))a=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let s=e;;s=s.parentNode){if(s==this.dom){a=!1;break}if(s.previousSibling)break}if(a==null&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){a=!0;break}if(s.nextSibling)break}}return a??i>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let i=!0,a=e;a;a=a.parentNode){let s=this.getDesc(a),o;if(s&&(!n||s.node))if(i&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))i=!1;else return s}}getDesc(e){let n=e.pmViewDesc;for(let i=n;i;i=i.parent)if(i==this)return n}posFromDOM(e,n,i){for(let a=e;a;a=a.parentNode){let s=this.getDesc(a);if(s)return s.localPosFromDOM(e,n,i)}return-1}descAt(e){for(let n=0,i=0;n<this.children.length;n++){let a=this.children[n],s=i+a.size;if(i==e&&s!=i){for(;!a.border&&a.children.length;)for(let o=0;o<a.children.length;o++){let l=a.children[o];if(l.size){a=l;break}}return a}if(e<s)return a.descAt(e-i-a.border);i=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let i=0,a=0;for(let s=0;i<this.children.length;i++){let o=this.children[i],l=s+o.size;if(l>e||o instanceof I6){a=e-s;break}s=l}if(a)return this.children[i].domFromPos(a-this.children[i].border,n);for(let s;i&&!(s=this.children[i-1]).size&&s instanceof D6&&s.side>=0;i--);if(n<=0){let s,o=!0;for(;s=i?this.children[i-1]:null,!(!s||s.dom.parentNode==this.contentDOM);i--,o=!1);return s&&n&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?_a(s.dom)+1:0}}else{let s,o=!0;for(;s=i<this.children.length?this.children[i]:null,!(!s||s.dom.parentNode==this.contentDOM);i++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?_a(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,i=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let a=-1,s=-1;for(let o=i,l=0;;l++){let u=this.children[l],c=o+u.size;if(a==-1&&e<=c){let d=o+u.border;if(e>=d&&n<=c-u.border&&u.node&&u.contentDOM&&this.contentDOM.contains(u.contentDOM))return u.parseRange(e,n,d);e=o;for(let p=l;p>0;p--){let v=this.children[p-1];if(v.size&&v.dom.parentNode==this.contentDOM&&!v.emptyChildAt(1)){a=_a(v.dom)+1;break}e-=v.size}a==-1&&(a=0)}if(a>-1&&(c>n||l==this.children.length-1)){n=c;for(let d=l+1;d<this.children.length;d++){let p=this.children[d];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){s=_a(p.dom);break}n+=p.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:n,fromOffset:a,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:i}=this.domFromPos(e,0);if(n.nodeType!=1||i==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[i]}setSelection(e,n,i,a=!1){let s=Math.min(e,n),o=Math.max(e,n);for(let y=0,b=0;y<this.children.length;y++){let S=this.children[y],k=b+S.size;if(s>b&&o<k)return S.setSelection(e-b-S.border,n-b-S.border,i,a);b=k}let l=this.domFromPos(e,e?-1:1),u=n==e?l:this.domFromPos(n,n?-1:1),c=i.root.getSelection(),d=i.domSelectionRange(),p=!1;if((Mo||Ea)&&e==n){let{node:y,offset:b}=l;if(y.nodeType==3){if(p=!!(b&&y.nodeValue[b-1]==`
`),p&&b==y.nodeValue.length)for(let S=y,k;S;S=S.parentNode){if(k=S.nextSibling){k.nodeName=="BR"&&(l=u={node:k.parentNode,offset:_a(k)+1});break}let T=S.pmViewDesc;if(T&&T.node&&T.node.isBlock)break}}else{let S=y.childNodes[b-1];p=S&&(S.nodeName=="BR"||S.contentEditable=="false")}}if(Mo&&d.focusNode&&d.focusNode!=u.node&&d.focusNode.nodeType==1){let y=d.focusNode.childNodes[d.focusOffset];y&&y.contentEditable=="false"&&(a=!0)}if(!(a||p&&Ea)&&Gh(l.node,l.offset,d.anchorNode,d.anchorOffset)&&Gh(u.node,u.offset,d.focusNode,d.focusOffset))return;let v=!1;if((c.extend||e==n)&&!(p&&Mo)){c.collapse(l.node,l.offset);try{e!=n&&c.extend(u.node,u.offset),v=!0}catch{}}if(!v){if(e>n){let b=l;l=u,u=b}let y=document.createRange();y.setEnd(u.node,u.offset),y.setStart(l.node,l.offset),c.removeAllRanges(),c.addRange(y)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let i=0,a=0;a<this.children.length;a++){let s=this.children[a],o=i+s.size;if(i==o?e<=o&&n>=i:e<o&&n>i){let l=i+s.border,u=o-s.border;if(e>=l&&n<=u){this.dirty=e==i||n==o?kh:MT,e==l&&n==u&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=ru:s.markDirty(e-l,n-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?kh:ru}i=o}this.dirty=kh}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let i=e==1?kh:MT;n.dirty<i&&(n.dirty=i)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class D6 extends bv{constructor(e,n,i,a){let s,o=n.type.toDOM;if(typeof o=="function"&&(o=o(i,()=>{if(!s)return a;if(s.parent)return s.parent.posBeforeChild(s)})),!n.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return this.dirty==Ao&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class zH extends bv{constructor(e,n,i,a){super(e,[],n,null),this.textDOM=i,this.text=a}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class qh extends bv{constructor(e,n,i,a,s){super(e,[],i,a),this.mark=n,this.spec=s}static create(e,n,i,a){let s=a.nodeViews[n.type.name],o=s&&s(n,a,i);return(!o||!o.dom)&&(o=Qh.renderSpec(document,n.type.spec.toDOM(n,i),null,n.attrs)),new qh(e,n,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&ru||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=ru&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Ao){let i=this.parent;for(;!i.node;)i=i.parent;i.dirty<this.dirty&&(i.dirty=this.dirty),this.dirty=Ao}}slice(e,n,i){let a=qh.create(this.parent,this.mark,!0,i),s=this.children,o=this.size;n<o&&(s=Y2(s,n,o,i)),e>0&&(s=Y2(s,0,e,i));for(let l=0;l<s.length;l++)s[l].parent=a;return a.children=s,a}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class yd extends bv{constructor(e,n,i,a,s,o,l,u,c){super(e,[],s,o),this.node=n,this.outerDeco=i,this.innerDeco=a,this.nodeDOM=l}static create(e,n,i,a,s,o){let l=s.nodeViews[n.type.name],u,c=l&&l(n,s,()=>{if(!u)return o;if(u.parent)return u.parent.posBeforeChild(u)},i,a),d=c&&c.dom,p=c&&c.contentDOM;if(n.isText){if(!d)d=document.createTextNode(n.text);else if(d.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else d||({dom:d,contentDOM:p}=Qh.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!p&&!n.isText&&d.nodeName!="BR"&&(d.hasAttribute("contenteditable")||(d.contentEditable="false"),n.type.spec.draggable&&(d.draggable=!0));let v=d;return d=F6(d,i,n),c?u=new FH(e,n,i,a,d,p||null,v,c,s,o+1):n.isText?new Fx(e,n,i,a,d,v,s):new yd(e,n,i,a,d,p||null,v,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let i=this.children[n];if(this.dom.contains(i.dom.parentNode)){e.contentElement=i.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Qe.empty)}return e}matchesNode(e,n,i){return this.dirty==Ao&&e.eq(this.node)&&Sy(n,this.outerDeco)&&i.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let i=this.node.inlineContent,a=n,s=e.composing?this.localCompositionInfo(e,n):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,u=new UH(this,o&&o.node,e);qH(this.node,this.innerDeco,(c,d,p)=>{c.spec.marks?u.syncToMarks(c.spec.marks,i,e,d):c.type.side>=0&&!p&&u.syncToMarks(d==this.node.childCount?tn.none:this.node.child(d).marks,i,e,d),u.placeWidget(c,e,a)},(c,d,p,v)=>{u.syncToMarks(c.marks,i,e,v);let y;u.findNodeMatch(c,d,p,v)||l&&e.state.selection.from>a&&e.state.selection.to<a+c.nodeSize&&(y=u.findIndexWithChild(s.node))>-1&&u.updateNodeAt(c,d,p,y,e)||u.updateNextNode(c,d,p,e,v,a)||u.addNode(c,d,p,e,a),a+=c.nodeSize}),u.syncToMarks([],i,e,0),this.node.isTextblock&&u.addTextblockHacks(),u.destroyRest(),(u.changed||this.dirty==kh)&&(o&&this.protectLocalComposition(e,o),B6(this.contentDOM,this.children,e),vp&&WH(this.dom))}localCompositionInfo(e,n){let{from:i,to:a}=e.state.selection;if(!(e.state.selection instanceof Qt)||i<n||a>n+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,l=$H(this.node.content,o,i-n,a-n);return l<0?null:{node:s,pos:l,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:i,text:a}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new zH(this,s,n,a);e.input.compositionNodes.push(o),this.children=Y2(this.children,i,i+a.length,e,o)}update(e,n,i,a){return this.dirty==ru||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,i,a),!0)}updateInner(e,n,i,a){this.updateOuterDeco(n),this.node=e,this.innerDeco=i,this.contentDOM&&this.updateChildren(a,this.posAtStart),this.dirty=Ao}updateOuterDeco(e){if(Sy(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,i=this.dom;this.dom=z6(this.dom,this.nodeDOM,Z2(this.outerDeco,this.node,n),Z2(e,this.node,n)),this.dom!=i&&(i.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function AT(r,e,n,i,a){F6(i,e,r);let s=new yd(void 0,r,e,n,i,i,i,a,0);return s.contentDOM&&s.updateChildren(a,0),s}class Fx extends yd{constructor(e,n,i,a,s,o,l){super(e,n,i,a,s,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,i,a){return this.dirty==ru||this.dirty!=Ao&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Ao||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,a.trackWrites==this.nodeDOM&&(a.trackWrites=null)),this.node=e,this.dirty=Ao,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,i){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,i)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,i){let a=this.node.cut(e,n),s=document.createTextNode(a.text);return new Fx(this.parent,a,this.outerDeco,this.innerDeco,s,s,i)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=ru)}get domAtom(){return!1}isText(e){return this.node.text==e}}class I6 extends bv{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Ao&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class FH extends yd{constructor(e,n,i,a,s,o,l,u,c,d){super(e,n,i,a,s,o,l,c,d),this.spec=u}update(e,n,i,a){if(this.dirty==ru)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,n,i);return s&&this.updateInner(e,n,i,a),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,i,a)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,i,a){this.spec.setSelection?this.spec.setSelection(e,n,i.root):super.setSelection(e,n,i,a)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function B6(r,e,n){let i=r.firstChild,a=!1;for(let s=0;s<e.length;s++){let o=e[s],l=o.dom;if(l.parentNode==r){for(;l!=i;)i=jT(i),a=!0;i=i.nextSibling}else a=!0,r.insertBefore(l,i);if(o instanceof qh){let u=i?i.previousSibling:r.lastChild;B6(o.contentDOM,o.children,n),i=u?u.nextSibling:r.firstChild}}for(;i;)i=jT(i),a=!0;a&&n.trackWrites==r&&(n.trackWrites=null)}const wg=function(r){r&&(this.nodeName=r)};wg.prototype=Object.create(null);const Ch=[new wg];function Z2(r,e,n){if(r.length==0)return Ch;let i=n?Ch[0]:new wg,a=[i];for(let s=0;s<r.length;s++){let o=r[s].type.attrs;if(o){o.nodeName&&a.push(i=new wg(o.nodeName));for(let l in o){let u=o[l];u!=null&&(n&&a.length==1&&a.push(i=new wg(e.isInline?"span":"div")),l=="class"?i.class=(i.class?i.class+" ":"")+u:l=="style"?i.style=(i.style?i.style+";":"")+u:l!="nodeName"&&(i[l]=u))}}}return a}function z6(r,e,n,i){if(n==Ch&&i==Ch)return e;let a=e;for(let s=0;s<i.length;s++){let o=i[s],l=n[s];if(s){let u;l&&l.nodeName==o.nodeName&&a!=r&&(u=a.parentNode)&&u.nodeName.toLowerCase()==o.nodeName||(u=document.createElement(o.nodeName),u.pmIsDeco=!0,u.appendChild(a),l=Ch[0]),a=u}VH(a,l||Ch[0],o)}return a}function VH(r,e,n){for(let i in e)i!="class"&&i!="style"&&i!="nodeName"&&!(i in n)&&r.removeAttribute(i);for(let i in n)i!="class"&&i!="style"&&i!="nodeName"&&n[i]!=e[i]&&r.setAttribute(i,n[i]);if(e.class!=n.class){let i=e.class?e.class.split(" ").filter(Boolean):[],a=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<i.length;s++)a.indexOf(i[s])==-1&&r.classList.remove(i[s]);for(let s=0;s<a.length;s++)i.indexOf(a[s])==-1&&r.classList.add(a[s]);r.classList.length==0&&r.removeAttribute("class")}if(e.style!=n.style){if(e.style){let i=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,a;for(;a=i.exec(e.style);)r.style.removeProperty(a[1])}n.style&&(r.style.cssText+=n.style)}}function F6(r,e,n){return z6(r,r,Ch,Z2(e,n,r.nodeType!=1))}function Sy(r,e){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!r[n].type.eq(e[n].type))return!1;return!0}function jT(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class UH{constructor(e,n,i){this.lock=n,this.view=i,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=HH(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let i=e;i<n;i++)this.top.children[i].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,i,a){let s=0,o=this.stack.length>>1,l=Math.min(o,e.length);for(;s<l&&(s==o-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<o;)this.destroyRest(),this.top.dirty=Ao,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let u=-1,c=this.top.children.length;a<this.preMatch.index&&(c=Math.min(this.index+3,c));for(let d=this.index;d<c;d++){let p=this.top.children[d];if(p.matchesMark(e[o])&&!this.isLocked(p.dom)){u=d;break}}if(u>-1)u>this.index&&(this.changed=!0,this.destroyBetween(this.index,u)),this.top=this.top.children[this.index];else{let d=qh.create(this.top,e[o],n,i);this.top.children.splice(this.index,0,d),this.top=d,this.changed=!0}this.index=0,o++}}findNodeMatch(e,n,i,a){let s=-1,o;if(a>=this.preMatch.index&&(o=this.preMatch.matches[a-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,i))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,u=Math.min(this.top.children.length,l+5);l<u;l++){let c=this.top.children[l];if(c.matchesNode(e,n,i)&&!this.preMatch.matched.has(c)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,n,i,a,s){let o=this.top.children[a];return o.dirty==ru&&o.dom==o.contentDOM&&(o.dirty=kh),o.update(e,n,i,s)?(this.destroyBetween(this.index,a),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let i=e.pmViewDesc;if(i){for(let a=this.index;a<this.top.children.length;a++)if(this.top.children[a]==i)return a}return-1}e=n}}updateNextNode(e,n,i,a,s,o){for(let l=this.index;l<this.top.children.length;l++){let u=this.top.children[l];if(u instanceof yd){let c=this.preMatch.matched.get(u);if(c!=null&&c!=s)return!1;let d=u.dom,p,v=this.isLocked(d)&&!(e.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==e.text&&u.dirty!=ru&&Sy(n,u.outerDeco));if(!v&&u.update(e,n,i,a))return this.destroyBetween(this.index,l),u.dom!=d&&(this.changed=!0),this.index++,!0;if(!v&&(p=this.recreateWrapper(u,e,n,i,a,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=p,p.contentDOM&&(p.dirty=kh,p.updateChildren(a,o+1),p.dirty=Ao),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,i,a,s,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!Sy(i,e.outerDeco)||!a.eq(e.innerDeco))return null;let l=yd.create(this.top,n,i,a,s,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let u of l.children)u.parent=l}return e.destroy(),l}addNode(e,n,i,a,s){let o=yd.create(this.top,e,n,i,a,s);o.contentDOM&&o.updateChildren(a,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,i){let a=this.index<this.top.children.length?this.top.children[this.index]:null;if(a&&a.matchesWidget(e)&&(e==a.widget||!a.widget.type.toDOM.parentNode))this.index++;else{let s=new D6(this.top,e,n,i);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof qh;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Fx)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Ea||Zi)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let i=document.createElement(e);e=="IMG"&&(i.className="ProseMirror-separator",i.alt=""),e=="BR"&&(i.className="ProseMirror-trailingBreak");let a=new I6(this.top,[],i,null);n!=this.top?n.children.push(a):n.children.splice(this.index++,0,a),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function HH(r,e){let n=e,i=n.children.length,a=r.childCount,s=new Map,o=[];e:for(;a>0;){let l;for(;;)if(i){let c=n.children[i-1];if(c instanceof qh)n=c,i=c.children.length;else{l=c,i--;break}}else{if(n==e)break e;i=n.parent.children.indexOf(n),n=n.parent}let u=l.node;if(u){if(u!=r.child(a-1))break;--a,s.set(l,a),o.push(l)}}return{index:a,matched:s,matches:o.reverse()}}function GH(r,e){return r.type.side-e.type.side}function qH(r,e,n,i){let a=e.locals(r),s=0;if(a.length==0){for(let c=0;c<r.childCount;c++){let d=r.child(c);i(d,a,e.forChild(s,d),c),s+=d.nodeSize}return}let o=0,l=[],u=null;for(let c=0;;){let d,p;for(;o<a.length&&a[o].to==s;){let k=a[o++];k.widget&&(d?(p||(p=[d])).push(k):d=k)}if(d)if(p){p.sort(GH);for(let k=0;k<p.length;k++)n(p[k],c,!!u)}else n(d,c,!!u);let v,y;if(u)y=-1,v=u,u=null;else if(c<r.childCount)y=c,v=r.child(c++);else break;for(let k=0;k<l.length;k++)l[k].to<=s&&l.splice(k--,1);for(;o<a.length&&a[o].from<=s&&a[o].to>s;)l.push(a[o++]);let b=s+v.nodeSize;if(v.isText){let k=b;o<a.length&&a[o].from<k&&(k=a[o].from);for(let T=0;T<l.length;T++)l[T].to<k&&(k=l[T].to);k<b&&(u=v.cut(k-s),v=v.cut(0,k-s),b=k,y=-1)}else for(;o<a.length&&a[o].to<b;)o++;let S=v.isInline&&!v.isLeaf?l.filter(k=>!k.inline):l.slice();i(v,S,e.forChild(s,v),y),s=b}}function WH(r){if(r.nodeName=="UL"||r.nodeName=="OL"){let e=r.style.cssText;r.style.cssText=e+"; list-style: square !important",window.getComputedStyle(r).listStyle,r.style.cssText=e}}function $H(r,e,n,i){for(let a=0,s=0;a<r.childCount&&s<=i;){let o=r.child(a++),l=s;if(s+=o.nodeSize,!o.isText)continue;let u=o.text;for(;a<r.childCount;){let c=r.child(a++);if(s+=c.nodeSize,!c.isText)break;u+=c.text}if(s>=n){if(s>=i&&u.slice(i-e.length-l,i-l)==e)return i-e.length;let c=l<i?u.lastIndexOf(e,i-l-1):-1;if(c>=0&&c+e.length+l>=n)return l+c;if(n==i&&u.length>=i+e.length-l&&u.slice(i-l,i-l+e.length)==e)return i}}return-1}function Y2(r,e,n,i,a){let s=[];for(let o=0,l=0;o<r.length;o++){let u=r[o],c=l,d=l+=u.size;c>=n||d<=e?s.push(u):(c<e&&s.push(u.slice(0,e-c,i)),a&&(s.push(a),a=void 0),d>n&&s.push(u.slice(n-c,u.size,i)))}return s}function gS(r,e=null){let n=r.domSelectionRange(),i=r.state.doc;if(!n.focusNode)return null;let a=r.docView.nearestDesc(n.focusNode),s=a&&a.size==0,o=r.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let l=i.resolve(o),u,c;if(zx(n)){for(u=o;a&&!a.node;)a=a.parent;let p=a.node;if(a&&p.isAtom&&Bt.isSelectable(p)&&a.parent&&!(p.isInline&&bH(n.focusNode,n.focusOffset,a.dom))){let v=a.posBefore;c=new Bt(o==v?l:i.resolve(v))}}else{if(n instanceof r.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let p=o,v=o;for(let y=0;y<n.rangeCount;y++){let b=n.getRangeAt(y);p=Math.min(p,r.docView.posFromDOM(b.startContainer,b.startOffset,1)),v=Math.max(v,r.docView.posFromDOM(b.endContainer,b.endOffset,-1))}if(p<0)return null;[u,o]=v==r.state.selection.anchor?[v,p]:[p,v],l=i.resolve(o)}else u=r.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(u<0)return null}let d=i.resolve(u);if(!c){let p=e=="pointer"||r.state.selection.head<l.pos&&!s?1:-1;c=vS(r,d,l,p)}return c}function V6(r){return r.editable?r.hasFocus():H6(r)&&document.activeElement&&document.activeElement.contains(r.dom)}function Wu(r,e=!1){let n=r.state.selection;if(U6(r,n),!!V6(r)){if(!e&&r.input.mouseDown&&r.input.mouseDown.allowDefault&&Zi){let i=r.domSelectionRange(),a=r.domObserver.currentSelection;if(i.anchorNode&&a.anchorNode&&Gh(i.anchorNode,i.anchorOffset,a.anchorNode,a.anchorOffset)){r.input.mouseDown.delayedSelectionSync=!0,r.domObserver.setCurSelection();return}}if(r.domObserver.disconnectSelection(),r.cursorWrapper)ZH(r);else{let{anchor:i,head:a}=n,s,o;RT&&!(n instanceof Qt)&&(n.$from.parent.inlineContent||(s=LT(r,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=LT(r,n.to))),r.docView.setSelection(i,a,r,e),RT&&(s&&OT(s),o&&OT(o)),n.visible?r.dom.classList.remove("ProseMirror-hideselection"):(r.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&KH(r))}r.domObserver.setCurSelection(),r.domObserver.connectSelection()}}const RT=Ea||Zi&&T6<63;function LT(r,e){let{node:n,offset:i}=r.docView.domFromPos(e,0),a=i<n.childNodes.length?n.childNodes[i]:null,s=i?n.childNodes[i-1]:null;if(Ea&&a&&a.contentEditable=="false")return Uw(a);if((!a||a.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(a)return Uw(a);if(s)return Uw(s)}}function Uw(r){return r.contentEditable="true",Ea&&r.draggable&&(r.draggable=!1,r.wasDraggable=!0),r}function OT(r){r.contentEditable="false",r.wasDraggable&&(r.draggable=!0,r.wasDraggable=null)}function KH(r){let e=r.dom.ownerDocument;e.removeEventListener("selectionchange",r.input.hideSelectionGuard);let n=r.domSelectionRange(),i=n.anchorNode,a=n.anchorOffset;e.addEventListener("selectionchange",r.input.hideSelectionGuard=()=>{(n.anchorNode!=i||n.anchorOffset!=a)&&(e.removeEventListener("selectionchange",r.input.hideSelectionGuard),setTimeout(()=>{(!V6(r)||r.state.selection.visible)&&r.dom.classList.remove("ProseMirror-hideselection")},20))})}function ZH(r){let e=r.domSelection();if(!e)return;let n=r.cursorWrapper.dom,i=n.nodeName=="IMG";i?e.collapse(n.parentNode,_a(n)+1):e.collapse(n,0),!i&&!r.state.selection.visible&&Rs&&vd<=11&&(n.disabled=!0,n.disabled=!1)}function U6(r,e){if(e instanceof Bt){let n=r.docView.descAt(e.from);n!=r.lastSelectedViewDesc&&(DT(r),n&&n.selectNode(),r.lastSelectedViewDesc=n)}else DT(r)}function DT(r){r.lastSelectedViewDesc&&(r.lastSelectedViewDesc.parent&&r.lastSelectedViewDesc.deselectNode(),r.lastSelectedViewDesc=void 0)}function vS(r,e,n,i){return r.someProp("createSelectionBetween",a=>a(r,e,n))||Qt.between(e,n,i)}function IT(r){return r.editable&&!r.hasFocus()?!1:H6(r)}function H6(r){let e=r.domSelectionRange();if(!e.anchorNode)return!1;try{return r.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(r.editable||r.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function YH(r){let e=r.docView.domFromPos(r.state.selection.anchor,0),n=r.domSelectionRange();return Gh(e.node,e.offset,n.anchorNode,n.anchorOffset)}function X2(r,e){let{$anchor:n,$head:i}=r.selection,a=e>0?n.max(i):n.min(i),s=a.parent.inlineContent?a.depth?r.doc.resolve(e>0?a.after():a.before()):null:a;return s&&sr.findFrom(s,e)}function Jc(r,e){return r.dispatch(r.state.tr.setSelection(e).scrollIntoView()),!0}function BT(r,e,n){let i=r.state.selection;if(i instanceof Qt)if(n.indexOf("s")>-1){let{$head:a}=i,s=a.textOffset?null:e<0?a.nodeBefore:a.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=r.state.doc.resolve(a.pos+s.nodeSize*(e<0?-1:1));return Jc(r,new Qt(i.$anchor,o))}else if(i.empty){if(r.endOfTextblock(e>0?"forward":"backward")){let a=X2(r.state,e);return a&&a instanceof Bt?Jc(r,a):!1}else if(!(Co&&n.indexOf("m")>-1)){let a=i.$head,s=a.textOffset?null:e<0?a.nodeBefore:a.nodeAfter,o;if(!s||s.isText)return!1;let l=e<0?a.pos-s.nodeSize:a.pos;return s.isAtom||(o=r.docView.descAt(l))&&!o.contentDOM?Bt.isSelectable(s)?Jc(r,new Bt(e<0?r.state.doc.resolve(a.pos-s.nodeSize):a)):xv?Jc(r,new Qt(r.state.doc.resolve(e<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(i instanceof Bt&&i.node.isInline)return Jc(r,new Qt(e>0?i.$to:i.$from));{let a=X2(r.state,e);return a?Jc(r,a):!1}}}function ky(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function _g(r,e){let n=r.pmViewDesc;return n&&n.size==0&&(e<0||r.nextSibling||r.nodeName!="BR")}function qf(r,e){return e<0?XH(r):QH(r)}function XH(r){let e=r.domSelectionRange(),n=e.focusNode,i=e.focusOffset;if(!n)return;let a,s,o=!1;for(Mo&&n.nodeType==1&&i<ky(n)&&_g(n.childNodes[i],-1)&&(o=!0);;)if(i>0){if(n.nodeType!=1)break;{let l=n.childNodes[i-1];if(_g(l,-1))a=n,s=--i;else if(l.nodeType==3)n=l,i=n.nodeValue.length;else break}}else{if(G6(n))break;{let l=n.previousSibling;for(;l&&_g(l,-1);)a=n.parentNode,s=_a(l),l=l.previousSibling;if(l)n=l,i=ky(n);else{if(n=n.parentNode,n==r.dom)break;i=0}}}o?Q2(r,n,i):a&&Q2(r,a,s)}function QH(r){let e=r.domSelectionRange(),n=e.focusNode,i=e.focusOffset;if(!n)return;let a=ky(n),s,o;for(;;)if(i<a){if(n.nodeType!=1)break;let l=n.childNodes[i];if(_g(l,1))s=n,o=++i;else break}else{if(G6(n))break;{let l=n.nextSibling;for(;l&&_g(l,1);)s=l.parentNode,o=_a(l)+1,l=l.nextSibling;if(l)n=l,i=0,a=ky(n);else{if(n=n.parentNode,n==r.dom)break;i=a=0}}}s&&Q2(r,s,o)}function G6(r){let e=r.pmViewDesc;return e&&e.node&&e.node.isBlock}function JH(r,e){for(;r&&e==r.childNodes.length&&!yv(r);)e=_a(r)+1,r=r.parentNode;for(;r&&e<r.childNodes.length;){let n=r.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;r=n,e=0}}function eG(r,e){for(;r&&!e&&!yv(r);)e=_a(r),r=r.parentNode;for(;r&&e;){let n=r.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;r=n,e=r.childNodes.length}}function Q2(r,e,n){if(e.nodeType!=3){let s,o;(o=JH(e,n))?(e=o,n=0):(s=eG(e,n))&&(e=s,n=s.nodeValue.length)}let i=r.domSelection();if(!i)return;if(zx(i)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),i.removeAllRanges(),i.addRange(s)}else i.extend&&i.extend(e,n);r.domObserver.setCurSelection();let{state:a}=r;setTimeout(()=>{r.state==a&&Wu(r)},50)}function zT(r,e){let n=r.state.doc.resolve(e);if(!(Zi||P6)&&n.parent.inlineContent){let a=r.coordsAtPos(e);if(e>n.start()){let s=r.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>a.top&&o<a.bottom&&Math.abs(s.left-a.left)>1)return s.left<a.left?"ltr":"rtl"}if(e<n.end()){let s=r.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>a.top&&o<a.bottom&&Math.abs(s.left-a.left)>1)return s.left>a.left?"ltr":"rtl"}}return getComputedStyle(r.dom).direction=="rtl"?"rtl":"ltr"}function FT(r,e,n){let i=r.state.selection;if(i instanceof Qt&&!i.empty||n.indexOf("s")>-1||Co&&n.indexOf("m")>-1)return!1;let{$from:a,$to:s}=i;if(!a.parent.inlineContent||r.endOfTextblock(e<0?"up":"down")){let o=X2(r.state,e);if(o&&o instanceof Bt)return Jc(r,o)}if(!a.parent.inlineContent){let o=e<0?a:s,l=i instanceof Qs?sr.near(o,e):sr.findFrom(o,e);return l?Jc(r,l):!1}return!1}function VT(r,e){if(!(r.state.selection instanceof Qt))return!0;let{$head:n,$anchor:i,empty:a}=r.state.selection;if(!n.sameParent(i))return!0;if(!a)return!1;if(r.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let o=r.state.tr;return e<0?o.delete(n.pos-s.nodeSize,n.pos):o.delete(n.pos,n.pos+s.nodeSize),r.dispatch(o),!0}return!1}function UT(r,e,n){r.domObserver.stop(),e.contentEditable=n,r.domObserver.start()}function tG(r){if(!Ea||r.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=r.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let i=e.firstChild;UT(r,i,"true"),setTimeout(()=>UT(r,i,"false"),20)}return!1}function rG(r){let e="";return r.ctrlKey&&(e+="c"),r.metaKey&&(e+="m"),r.altKey&&(e+="a"),r.shiftKey&&(e+="s"),e}function nG(r,e){let n=e.keyCode,i=rG(e);if(n==8||Co&&n==72&&i=="c")return VT(r,-1)||qf(r,-1);if(n==46&&!e.shiftKey||Co&&n==68&&i=="c")return VT(r,1)||qf(r,1);if(n==13||n==27)return!0;if(n==37||Co&&n==66&&i=="c"){let a=n==37?zT(r,r.state.selection.from)=="ltr"?-1:1:-1;return BT(r,a,i)||qf(r,a)}else if(n==39||Co&&n==70&&i=="c"){let a=n==39?zT(r,r.state.selection.from)=="ltr"?1:-1:1;return BT(r,a,i)||qf(r,a)}else{if(n==38||Co&&n==80&&i=="c")return FT(r,-1,i)||qf(r,-1);if(n==40||Co&&n==78&&i=="c")return tG(r)||FT(r,1,i)||qf(r,1);if(i==(Co?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function yS(r,e){r.someProp("transformCopied",y=>{e=y(e,r)});let n=[],{content:i,openStart:a,openEnd:s}=e;for(;a>1&&s>1&&i.childCount==1&&i.firstChild.childCount==1;){a--,s--;let y=i.firstChild;n.push(y.type.name,y.attrs!=y.type.defaultAttrs?y.attrs:null),i=y.content}let o=r.someProp("clipboardSerializer")||Qh.fromSchema(r.state.schema),l=Y6(),u=l.createElement("div");u.appendChild(o.serializeFragment(i,{document:l}));let c=u.firstChild,d,p=0;for(;c&&c.nodeType==1&&(d=Z6[c.nodeName.toLowerCase()]);){for(let y=d.length-1;y>=0;y--){let b=l.createElement(d[y]);for(;u.firstChild;)b.appendChild(u.firstChild);u.appendChild(b),p++}c=u.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${a} ${s}${p?` -${p}`:""} ${JSON.stringify(n)}`);let v=r.someProp("clipboardTextSerializer",y=>y(e,r))||e.content.textBetween(0,e.content.size,`

`);return{dom:u,text:v,slice:e}}function q6(r,e,n,i,a){let s=a.parent.type.spec.code,o,l;if(!n&&!e)return null;let u=!!e&&(i||s||!n);if(u){if(r.someProp("transformPastedText",v=>{e=v(e,s||i,r)}),s)return l=new St(Qe.from(r.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),r.someProp("transformPasted",v=>{l=v(l,r,!0)}),l;let p=r.someProp("clipboardTextParser",v=>v(e,a,i,r));if(p)l=p;else{let v=a.marks(),{schema:y}=r.state,b=Qh.fromSchema(y);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(S=>{let k=o.appendChild(document.createElement("p"));S&&k.appendChild(b.serializeNode(y.text(S,v)))})}}else r.someProp("transformPastedHTML",p=>{n=p(n,r)}),o=oG(n),xv&&lG(o);let c=o&&o.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let p=+d[3];p>0;p--){let v=o.firstChild;for(;v&&v.nodeType!=1;)v=v.nextSibling;if(!v)break;o=v}if(l||(l=(r.someProp("clipboardParser")||r.someProp("domParser")||gd.fromSchema(r.state.schema)).parseSlice(o,{preserveWhitespace:!!(u||d),context:a,ruleFromNode(v){return v.nodeName=="BR"&&!v.nextSibling&&v.parentNode&&!iG.test(v.parentNode.nodeName)?{ignore:!0}:null}})),d)l=uG(HT(l,+d[1],+d[2]),d[4]);else if(l=St.maxOpen(aG(l.content,a),!0),l.openStart||l.openEnd){let p=0,v=0;for(let y=l.content.firstChild;p<l.openStart&&!y.type.spec.isolating;p++,y=y.firstChild);for(let y=l.content.lastChild;v<l.openEnd&&!y.type.spec.isolating;v++,y=y.lastChild);l=HT(l,p,v)}return r.someProp("transformPasted",p=>{l=p(l,r,u)}),l}const iG=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function aG(r,e){if(r.childCount<2)return r;for(let n=e.depth;n>=0;n--){let a=e.node(n).contentMatchAt(e.index(n)),s,o=[];if(r.forEach(l=>{if(!o)return;let u=a.findWrapping(l.type),c;if(!u)return o=null;if(c=o.length&&s.length&&$6(u,s,l,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=K6(o[o.length-1],s.length));let d=W6(l,u);o.push(d),a=a.matchType(d.type),s=u}}),o)return Qe.from(o)}return r}function W6(r,e,n=0){for(let i=e.length-1;i>=n;i--)r=e[i].create(null,Qe.from(r));return r}function $6(r,e,n,i,a){if(a<r.length&&a<e.length&&r[a]==e[a]){let s=$6(r,e,n,i.lastChild,a+1);if(s)return i.copy(i.content.replaceChild(i.childCount-1,s));if(i.contentMatchAt(i.childCount).matchType(a==r.length-1?n.type:r[a+1]))return i.copy(i.content.append(Qe.from(W6(n,r,a+1))))}}function K6(r,e){if(e==0)return r;let n=r.content.replaceChild(r.childCount-1,K6(r.lastChild,e-1)),i=r.contentMatchAt(r.childCount).fillBefore(Qe.empty,!0);return r.copy(n.append(i))}function J2(r,e,n,i,a,s){let o=e<0?r.firstChild:r.lastChild,l=o.content;return r.childCount>1&&(s=0),a<i-1&&(l=J2(l,e,n,i,a+1,s)),a>=n&&(l=e<0?o.contentMatchAt(0).fillBefore(l,s<=a).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(Qe.empty,!0))),r.replaceChild(e<0?0:r.childCount-1,o.copy(l))}function HT(r,e,n){return e<r.openStart&&(r=new St(J2(r.content,-1,e,r.openStart,0,r.openEnd),e,r.openEnd)),n<r.openEnd&&(r=new St(J2(r.content,1,n,r.openEnd,0,0),r.openStart,n)),r}const Z6={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let GT=null;function Y6(){return GT||(GT=document.implementation.createHTMLDocument("title"))}let Hw=null;function sG(r){let e=window.trustedTypes;return e?(Hw||(Hw=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),Hw.createHTML(r)):r}function oG(r){let e=/^(\s*<meta [^>]*>)*/.exec(r);e&&(r=r.slice(e[0].length));let n=Y6().createElement("div"),i=/<([a-z][^>\s]+)/i.exec(r),a;if((a=i&&Z6[i[1].toLowerCase()])&&(r=a.map(s=>"<"+s+">").join("")+r+a.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=sG(r),a)for(let s=0;s<a.length;s++)n=n.querySelector(a[s])||n;return n}function lG(r){let e=r.querySelectorAll(Zi?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let i=e[n];i.childNodes.length==1&&i.textContent==""&&i.parentNode&&i.parentNode.replaceChild(r.ownerDocument.createTextNode(" "),i)}}function uG(r,e){if(!r.size)return r;let n=r.content.firstChild.type.schema,i;try{i=JSON.parse(e)}catch{return r}let{content:a,openStart:s,openEnd:o}=r;for(let l=i.length-2;l>=0;l-=2){let u=n.nodes[i[l]];if(!u||u.hasRequiredAttrs())break;a=Qe.from(u.create(i[l+1],a)),s++,o++}return new St(a,s,o)}const ds={},hs={},cG={touchstart:!0,touchmove:!0};class dG{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function hG(r){for(let e in ds){let n=ds[e];r.dom.addEventListener(e,r.input.eventHandlers[e]=i=>{pG(r,i)&&!xS(r,i)&&(r.editable||!(i.type in hs))&&n(r,i)},cG[e]?{passive:!0}:void 0)}Ea&&r.dom.addEventListener("input",()=>null),e_(r)}function dd(r,e){r.input.lastSelectionOrigin=e,r.input.lastSelectionTime=Date.now()}function fG(r){r.domObserver.stop();for(let e in r.input.eventHandlers)r.dom.removeEventListener(e,r.input.eventHandlers[e]);clearTimeout(r.input.composingTimeout),clearTimeout(r.input.lastIOSEnterFallbackTimeout)}function e_(r){r.someProp("handleDOMEvents",e=>{for(let n in e)r.input.eventHandlers[n]||r.dom.addEventListener(n,r.input.eventHandlers[n]=i=>xS(r,i))})}function xS(r,e){return r.someProp("handleDOMEvents",n=>{let i=n[e.type];return i?i(r,e)||e.defaultPrevented:!1})}function pG(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=r.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function mG(r,e){!xS(r,e)&&ds[e.type]&&(r.editable||!(e.type in hs))&&ds[e.type](r,e)}hs.keydown=(r,e)=>{let n=e;if(r.input.shiftKey=n.keyCode==16||n.shiftKey,!Q6(r,n)&&(r.input.lastKeyCode=n.keyCode,r.input.lastKeyCodeTime=Date.now(),!(Gu&&Zi&&n.keyCode==13)))if(n.keyCode!=229&&r.domObserver.forceFlush(),vp&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let i=Date.now();r.input.lastIOSEnter=i,r.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{r.input.lastIOSEnter==i&&(r.someProp("handleKeyDown",a=>a(r,_h(13,"Enter"))),r.input.lastIOSEnter=0)},200)}else r.someProp("handleKeyDown",i=>i(r,n))||nG(r,n)?n.preventDefault():dd(r,"key")};hs.keyup=(r,e)=>{e.keyCode==16&&(r.input.shiftKey=!1)};hs.keypress=(r,e)=>{let n=e;if(Q6(r,n)||!n.charCode||n.ctrlKey&&!n.altKey||Co&&n.metaKey)return;if(r.someProp("handleKeyPress",a=>a(r,n))){n.preventDefault();return}let i=r.state.selection;if(!(i instanceof Qt)||!i.$from.sameParent(i.$to)){let a=String.fromCharCode(n.charCode),s=()=>r.state.tr.insertText(a).scrollIntoView();!/[\r\n]/.test(a)&&!r.someProp("handleTextInput",o=>o(r,i.$from.pos,i.$to.pos,a,s))&&r.dispatch(s()),n.preventDefault()}};function Vx(r){return{left:r.clientX,top:r.clientY}}function gG(r,e){let n=e.x-r.clientX,i=e.y-r.clientY;return n*n+i*i<100}function bS(r,e,n,i,a){if(i==-1)return!1;let s=r.state.doc.resolve(i);for(let o=s.depth+1;o>0;o--)if(r.someProp(e,l=>o>s.depth?l(r,n,s.nodeAfter,s.before(o),a,!0):l(r,n,s.node(o),s.before(o),a,!1)))return!0;return!1}function up(r,e,n){if(r.focused||r.focus(),r.state.selection.eq(e))return;let i=r.state.tr.setSelection(e);i.setMeta("pointer",!0),r.dispatch(i)}function vG(r,e){if(e==-1)return!1;let n=r.state.doc.resolve(e),i=n.nodeAfter;return i&&i.isAtom&&Bt.isSelectable(i)?(up(r,new Bt(n)),!0):!1}function yG(r,e){if(e==-1)return!1;let n=r.state.selection,i,a;n instanceof Bt&&(i=n.node);let s=r.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(Bt.isSelectable(l)){i&&n.$from.depth>0&&o>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?a=s.before(n.$from.depth):a=s.before(o);break}}return a!=null?(up(r,Bt.create(r.state.doc,a)),!0):!1}function xG(r,e,n,i,a){return bS(r,"handleClickOn",e,n,i)||r.someProp("handleClick",s=>s(r,e,i))||(a?yG(r,n):vG(r,n))}function bG(r,e,n,i){return bS(r,"handleDoubleClickOn",e,n,i)||r.someProp("handleDoubleClick",a=>a(r,e,i))}function wG(r,e,n,i){return bS(r,"handleTripleClickOn",e,n,i)||r.someProp("handleTripleClick",a=>a(r,e,i))||_G(r,n,i)}function _G(r,e,n){if(n.button!=0)return!1;let i=r.state.doc;if(e==-1)return i.inlineContent?(up(r,Qt.create(i,0,i.content.size)),!0):!1;let a=i.resolve(e);for(let s=a.depth+1;s>0;s--){let o=s>a.depth?a.nodeAfter:a.node(s),l=a.before(s);if(o.inlineContent)up(r,Qt.create(i,l+1,l+1+o.content.size));else if(Bt.isSelectable(o))up(r,Bt.create(i,l));else continue;return!0}}function wS(r){return Cy(r)}const X6=Co?"metaKey":"ctrlKey";ds.mousedown=(r,e)=>{let n=e;r.input.shiftKey=n.shiftKey;let i=wS(r),a=Date.now(),s="singleClick";a-r.input.lastClick.time<500&&gG(n,r.input.lastClick)&&!n[X6]&&r.input.lastClick.button==n.button&&(r.input.lastClick.type=="singleClick"?s="doubleClick":r.input.lastClick.type=="doubleClick"&&(s="tripleClick")),r.input.lastClick={time:a,x:n.clientX,y:n.clientY,type:s,button:n.button};let o=r.posAtCoords(Vx(n));o&&(s=="singleClick"?(r.input.mouseDown&&r.input.mouseDown.done(),r.input.mouseDown=new SG(r,o,n,!!i)):(s=="doubleClick"?bG:wG)(r,o.pos,o.inside,n)?n.preventDefault():dd(r,"pointer"))};class SG{constructor(e,n,i,a){this.view=e,this.pos=n,this.event=i,this.flushed=a,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!i[X6],this.allowDefault=i.shiftKey;let s,o;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),o=n.inside;else{let d=e.state.doc.resolve(n.pos);s=d.parent,o=d.depth?d.before():0}const l=a?null:i.target,u=l?e.docView.nearestDesc(l,!0):null;this.target=u&&u.nodeDOM.nodeType==1?u.nodeDOM:null;let{selection:c}=e.state;(i.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof Bt&&c.from<=o&&c.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Mo&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),dd(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Wu(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Vx(e))),this.updateAllowDefault(e),this.allowDefault||!n?dd(this.view,"pointer"):xG(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Ea&&this.mightDrag&&!this.mightDrag.node.isAtom||Zi&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(up(this.view,sr.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):dd(this.view,"pointer")}move(e){this.updateAllowDefault(e),dd(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}ds.touchstart=r=>{r.input.lastTouch=Date.now(),wS(r),dd(r,"pointer")};ds.touchmove=r=>{r.input.lastTouch=Date.now(),dd(r,"pointer")};ds.contextmenu=r=>wS(r);function Q6(r,e){return r.composing?!0:Ea&&Math.abs(e.timeStamp-r.input.compositionEndedAt)<500?(r.input.compositionEndedAt=-2e8,!0):!1}const kG=Gu?5e3:-1;hs.compositionstart=hs.compositionupdate=r=>{if(!r.composing){r.domObserver.flush();let{state:e}=r,n=e.selection.$to;if(e.selection instanceof Qt&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(i=>i.type.spec.inclusive===!1)||Zi&&P6&&CG(r)))r.markCursor=r.state.storedMarks||n.marks(),Cy(r,!0),r.markCursor=null;else if(Cy(r,!e.selection.empty),Mo&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let i=r.domSelectionRange();for(let a=i.focusNode,s=i.focusOffset;a&&a.nodeType==1&&s!=0;){let o=s<0?a.lastChild:a.childNodes[s-1];if(!o)break;if(o.nodeType==3){let l=r.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else a=o,s=-1}}r.input.composing=!0}J6(r,kG)};function CG(r){let{focusNode:e,focusOffset:n}=r.domSelectionRange();if(!e||e.nodeType!=1||n>=e.childNodes.length)return!1;let i=e.childNodes[n];return i.nodeType==1&&i.contentEditable=="false"}hs.compositionend=(r,e)=>{r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=e.timeStamp,r.input.compositionPendingChanges=r.domObserver.pendingRecords().length?r.input.compositionID:0,r.input.compositionNode=null,r.input.badSafariComposition?r.domObserver.forceFlush():r.input.compositionPendingChanges&&Promise.resolve().then(()=>r.domObserver.flush()),r.input.compositionID++,J6(r,20))};function J6(r,e){clearTimeout(r.input.composingTimeout),e>-1&&(r.input.composingTimeout=setTimeout(()=>Cy(r),e))}function eA(r){for(r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=NG());r.input.compositionNodes.length>0;)r.input.compositionNodes.pop().markParentsDirty()}function EG(r){let e=r.domSelectionRange();if(!e.focusNode)return null;let n=yH(e.focusNode,e.focusOffset),i=xH(e.focusNode,e.focusOffset);if(n&&i&&n!=i){let a=i.pmViewDesc,s=r.domObserver.lastChangedTextNode;if(n==s||i==s)return s;if(!a||!a.isText(i.nodeValue))return i;if(r.input.compositionNode==i){let o=n.pmViewDesc;if(!(!o||!o.isText(n.nodeValue)))return i}}return n||i}function NG(){let r=document.createEvent("Event");return r.initEvent("event",!0,!0),r.timeStamp}function Cy(r,e=!1){if(!(Gu&&r.domObserver.flushingSoon>=0)){if(r.domObserver.forceFlush(),eA(r),e||r.docView&&r.docView.dirty){let n=gS(r),i=r.state.selection;return n&&!n.eq(i)?r.dispatch(r.state.tr.setSelection(n)):(r.markCursor||e)&&!i.$from.node(i.$from.sharedDepth(i.to)).inlineContent?r.dispatch(r.state.tr.deleteSelection()):r.updateState(r.state),!0}return!1}}function TG(r,e){if(!r.dom.parentNode)return;let n=r.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let i=getSelection(),a=document.createRange();a.selectNodeContents(e),r.dom.blur(),i.removeAllRanges(),i.addRange(a),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),r.focus()},50)}const Zg=Rs&&vd<15||vp&&SH<604;ds.copy=hs.cut=(r,e)=>{let n=e,i=r.state.selection,a=n.type=="cut";if(i.empty)return;let s=Zg?null:n.clipboardData,o=i.content(),{dom:l,text:u}=yS(r,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",u)):TG(r,l),a&&r.dispatch(r.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function PG(r){return r.openStart==0&&r.openEnd==0&&r.content.childCount==1?r.content.firstChild:null}function MG(r,e){if(!r.dom.parentNode)return;let n=r.input.shiftKey||r.state.selection.$from.parent.type.spec.code,i=r.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(i.contentEditable="true"),i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus();let a=r.input.shiftKey&&r.input.lastKeyCode!=45;setTimeout(()=>{r.focus(),i.parentNode&&i.parentNode.removeChild(i),n?Yg(r,i.value,null,a,e):Yg(r,i.textContent,i.innerHTML,a,e)},50)}function Yg(r,e,n,i,a){let s=q6(r,e,n,i,r.state.selection.$from);if(r.someProp("handlePaste",u=>u(r,a,s||St.empty)))return!0;if(!s)return!1;let o=PG(s),l=o?r.state.tr.replaceSelectionWith(o,i):r.state.tr.replaceSelection(s);return r.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function tA(r){let e=r.getData("text/plain")||r.getData("Text");if(e)return e;let n=r.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}hs.paste=(r,e)=>{let n=e;if(r.composing&&!Gu)return;let i=Zg?null:n.clipboardData,a=r.input.shiftKey&&r.input.lastKeyCode!=45;i&&Yg(r,tA(i),i.getData("text/html"),a,n)?n.preventDefault():MG(r,n)};class rA{constructor(e,n,i){this.slice=e,this.move=n,this.node=i}}const AG=Co?"altKey":"ctrlKey";function nA(r,e){let n=r.someProp("dragCopies",i=>!i(e));return n??!e[AG]}ds.dragstart=(r,e)=>{let n=e,i=r.input.mouseDown;if(i&&i.done(),!n.dataTransfer)return;let a=r.state.selection,s=a.empty?null:r.posAtCoords(Vx(n)),o;if(!(s&&s.pos>=a.from&&s.pos<=(a instanceof Bt?a.to-1:a.to))){if(i&&i.mightDrag)o=Bt.create(r.state.doc,i.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let p=r.docView.nearestDesc(n.target,!0);p&&p.node.type.spec.draggable&&p!=r.docView&&(o=Bt.create(r.state.doc,p.posBefore))}}let l=(o||r.state.selection).content(),{dom:u,text:c,slice:d}=yS(r,l);(!n.dataTransfer.files.length||!Zi||T6>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Zg?"Text":"text/html",u.innerHTML),n.dataTransfer.effectAllowed="copyMove",Zg||n.dataTransfer.setData("text/plain",c),r.dragging=new rA(d,nA(r,n),o)};ds.dragend=r=>{let e=r.dragging;window.setTimeout(()=>{r.dragging==e&&(r.dragging=null)},50)};hs.dragover=hs.dragenter=(r,e)=>e.preventDefault();hs.drop=(r,e)=>{try{jG(r,e,r.dragging)}finally{r.dragging=null}};function jG(r,e,n){if(!e.dataTransfer)return;let i=r.posAtCoords(Vx(e));if(!i)return;let a=r.state.doc.resolve(i.pos),s=n&&n.slice;s?r.someProp("transformPasted",y=>{s=y(s,r,!1)}):s=q6(r,tA(e.dataTransfer),Zg?null:e.dataTransfer.getData("text/html"),!1,a);let o=!!(n&&nA(r,e));if(r.someProp("handleDrop",y=>y(r,e,s||St.empty,o))){e.preventDefault();return}if(!s)return;e.preventDefault();let l=s?o6(r.state.doc,a.pos,s):a.pos;l==null&&(l=a.pos);let u=r.state.tr;if(o){let{node:y}=n;y?y.replace(u):u.deleteSelection()}let c=u.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,p=u.doc;if(d?u.replaceRangeWith(c,c,s.content.firstChild):u.replaceRange(c,c,s),u.doc.eq(p))return;let v=u.doc.resolve(c);if(d&&Bt.isSelectable(s.content.firstChild)&&v.nodeAfter&&v.nodeAfter.sameMarkup(s.content.firstChild))u.setSelection(new Bt(v));else{let y=u.mapping.map(l);u.mapping.maps[u.mapping.maps.length-1].forEach((b,S,k,T)=>y=T),u.setSelection(vS(r,v,u.doc.resolve(y)))}r.focus(),r.dispatch(u.setMeta("uiEvent","drop"))}ds.focus=r=>{r.input.lastFocus=Date.now(),r.focused||(r.domObserver.stop(),r.dom.classList.add("ProseMirror-focused"),r.domObserver.start(),r.focused=!0,setTimeout(()=>{r.docView&&r.hasFocus()&&!r.domObserver.currentSelection.eq(r.domSelectionRange())&&Wu(r)},20))};ds.blur=(r,e)=>{let n=e;r.focused&&(r.domObserver.stop(),r.dom.classList.remove("ProseMirror-focused"),r.domObserver.start(),n.relatedTarget&&r.dom.contains(n.relatedTarget)&&r.domObserver.currentSelection.clear(),r.focused=!1)};ds.beforeinput=(r,e)=>{if(Zi&&Gu&&e.inputType=="deleteContentBackward"){r.domObserver.flushSoon();let{domChangeCount:i}=r.input;setTimeout(()=>{if(r.input.domChangeCount!=i||(r.dom.blur(),r.focus(),r.someProp("handleKeyDown",s=>s(r,_h(8,"Backspace")))))return;let{$cursor:a}=r.state.selection;a&&a.pos>0&&r.dispatch(r.state.tr.delete(a.pos-1,a.pos).scrollIntoView())},50)}};for(let r in hs)ds[r]=hs[r];function Xg(r,e){if(r==e)return!0;for(let n in r)if(r[n]!==e[n])return!1;for(let n in e)if(!(n in r))return!1;return!0}class Ey{constructor(e,n){this.toDOM=e,this.spec=n||Ah,this.side=this.spec.side||0}map(e,n,i,a){let{pos:s,deleted:o}=e.mapResult(n.from+a,this.side<0?-1:1);return o?null:new Ga(s-i,s-i,this)}valid(){return!0}eq(e){return this==e||e instanceof Ey&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Xg(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class xd{constructor(e,n){this.attrs=e,this.spec=n||Ah}map(e,n,i,a){let s=e.map(n.from+a,this.spec.inclusiveStart?-1:1)-i,o=e.map(n.to+a,this.spec.inclusiveEnd?1:-1)-i;return s>=o?null:new Ga(s,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof xd&&Xg(this.attrs,e.attrs)&&Xg(this.spec,e.spec)}static is(e){return e.type instanceof xd}destroy(){}}class _S{constructor(e,n){this.attrs=e,this.spec=n||Ah}map(e,n,i,a){let s=e.mapResult(n.from+a,1);if(s.deleted)return null;let o=e.mapResult(n.to+a,-1);return o.deleted||o.pos<=s.pos?null:new Ga(s.pos-i,o.pos-i,this)}valid(e,n){let{index:i,offset:a}=e.content.findIndex(n.from),s;return a==n.from&&!(s=e.child(i)).isText&&a+s.nodeSize==n.to}eq(e){return this==e||e instanceof _S&&Xg(this.attrs,e.attrs)&&Xg(this.spec,e.spec)}destroy(){}}class Ga{constructor(e,n,i){this.from=e,this.to=n,this.type=i}copy(e,n){return new Ga(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,i){return this.type.map(e,this,n,i)}static widget(e,n,i){return new Ga(e,e,new Ey(n,i))}static inline(e,n,i,a){return new Ga(e,n,new xd(i,a))}static node(e,n,i,a){return new Ga(e,n,new _S(i,a))}get spec(){return this.type.spec}get inline(){return this.type instanceof xd}get widget(){return this.type instanceof Ey}}const Zf=[],Ah={};class jn{constructor(e,n){this.local=e.length?e:Zf,this.children=n.length?n:Zf}static create(e,n){return n.length?Ny(n,e,0,Ah):Ha}find(e,n,i){let a=[];return this.findInner(e??0,n??1e9,a,0,i),a}findInner(e,n,i,a,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=n&&l.to>=e&&(!s||s(l.spec))&&i.push(l.copy(l.from+a,l.to+a))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,n-l,i,a+l,s)}}map(e,n,i){return this==Ha||e.maps.length==0?this:this.mapInner(e,n,0,0,i||Ah)}mapInner(e,n,i,a,s){let o;for(let l=0;l<this.local.length;l++){let u=this.local[l].map(e,i,a);u&&u.type.valid(n,u)?(o||(o=[])).push(u):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?RG(this.children,o||[],e,n,i,a,s):o?new jn(o.sort(jh),Zf):Ha}add(e,n){return n.length?this==Ha?jn.create(e,n):this.addInner(e,n,0):this}addInner(e,n,i){let a,s=0;e.forEach((l,u)=>{let c=u+i,d;if(d=aA(n,l,c)){for(a||(a=this.children.slice());s<a.length&&a[s]<u;)s+=3;a[s]==u?a[s+2]=a[s+2].addInner(l,d,c+1):a.splice(s,0,u,u+l.nodeSize,Ny(d,l,c+1,Ah)),s+=3}});let o=iA(s?sA(n):n,-i);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new jn(o.length?this.local.concat(o).sort(jh):this.local,a||this.children)}remove(e){return e.length==0||this==Ha?this:this.removeInner(e,0)}removeInner(e,n){let i=this.children,a=this.local;for(let s=0;s<i.length;s+=3){let o,l=i[s]+n,u=i[s+1]+n;for(let d=0,p;d<e.length;d++)(p=e[d])&&p.from>l&&p.to<u&&(e[d]=null,(o||(o=[])).push(p));if(!o)continue;i==this.children&&(i=this.children.slice());let c=i[s+2].removeInner(o,l+1);c!=Ha?i[s+2]=c:(i.splice(s,3),s-=3)}if(a.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let l=0;l<a.length;l++)a[l].eq(o,n)&&(a==this.local&&(a=this.local.slice()),a.splice(l--,1))}return i==this.children&&a==this.local?this:a.length||i.length?new jn(a,i):Ha}forChild(e,n){if(this==Ha)return this;if(n.isLeaf)return jn.empty;let i,a;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(i=this.children[l+2]);break}let s=e+1,o=s+n.content.size;for(let l=0;l<this.local.length;l++){let u=this.local[l];if(u.from<o&&u.to>s&&u.type instanceof xd){let c=Math.max(s,u.from)-s,d=Math.min(o,u.to)-s;c<d&&(a||(a=[])).push(u.copy(c,d))}}if(a){let l=new jn(a.sort(jh),Zf);return i?new rd([l,i]):l}return i||Ha}eq(e){if(this==e)return!0;if(!(e instanceof jn)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return SS(this.localsInner(e))}localsInner(e){if(this==Ha)return Zf;if(e.inlineContent||!this.local.some(xd.is))return this.local;let n=[];for(let i=0;i<this.local.length;i++)this.local[i].type instanceof xd||n.push(this.local[i]);return n}forEachSet(e){e(this)}}jn.empty=new jn([],[]);jn.removeOverlap=SS;const Ha=jn.empty;class rd{constructor(e){this.members=e}map(e,n){const i=this.members.map(a=>a.map(e,n,Ah));return rd.from(i)}forChild(e,n){if(n.isLeaf)return jn.empty;let i=[];for(let a=0;a<this.members.length;a++){let s=this.members[a].forChild(e,n);s!=Ha&&(s instanceof rd?i=i.concat(s.members):i.push(s))}return rd.from(i)}eq(e){if(!(e instanceof rd)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,i=!0;for(let a=0;a<this.members.length;a++){let s=this.members[a].localsInner(e);if(s.length)if(!n)n=s;else{i&&(n=n.slice(),i=!1);for(let o=0;o<s.length;o++)n.push(s[o])}}return n?SS(i?n:n.sort(jh)):Zf}static from(e){switch(e.length){case 0:return Ha;case 1:return e[0];default:return new rd(e.every(n=>n instanceof jn)?e:e.reduce((n,i)=>n.concat(i instanceof jn?i:i.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function RG(r,e,n,i,a,s,o){let l=r.slice();for(let c=0,d=s;c<n.maps.length;c++){let p=0;n.maps[c].forEach((v,y,b,S)=>{let k=S-b-(y-v);for(let T=0;T<l.length;T+=3){let C=l[T+1];if(C<0||v>C+d-p)continue;let N=l[T]+d-p;y>=N?l[T+1]=v<=N?-2:-1:v>=d&&k&&(l[T]+=k,l[T+1]+=k)}p+=k}),d=n.maps[c].map(d,-1)}let u=!1;for(let c=0;c<l.length;c+=3)if(l[c+1]<0){if(l[c+1]==-2){u=!0,l[c+1]=-1;continue}let d=n.map(r[c]+s),p=d-a;if(p<0||p>=i.content.size){u=!0;continue}let v=n.map(r[c+1]+s,-1),y=v-a,{index:b,offset:S}=i.content.findIndex(p),k=i.maybeChild(b);if(k&&S==p&&S+k.nodeSize==y){let T=l[c+2].mapInner(n,k,d+1,r[c]+s+1,o);T!=Ha?(l[c]=p,l[c+1]=y,l[c+2]=T):(l[c+1]=-2,u=!0)}else u=!0}if(u){let c=LG(l,r,e,n,a,s,o),d=Ny(c,i,0,o);e=d.local;for(let p=0;p<l.length;p+=3)l[p+1]<0&&(l.splice(p,3),p-=3);for(let p=0,v=0;p<d.children.length;p+=3){let y=d.children[p];for(;v<l.length&&l[v]<y;)v+=3;l.splice(v,0,d.children[p],d.children[p+1],d.children[p+2])}}return new jn(e.sort(jh),l)}function iA(r,e){if(!e||!r.length)return r;let n=[];for(let i=0;i<r.length;i++){let a=r[i];n.push(new Ga(a.from+e,a.to+e,a.type))}return n}function LG(r,e,n,i,a,s,o){function l(u,c){for(let d=0;d<u.local.length;d++){let p=u.local[d].map(i,a,c);p?n.push(p):o.onRemove&&o.onRemove(u.local[d].spec)}for(let d=0;d<u.children.length;d+=3)l(u.children[d+2],u.children[d]+c+1)}for(let u=0;u<r.length;u+=3)r[u+1]==-1&&l(r[u+2],e[u]+s+1);return n}function aA(r,e,n){if(e.isLeaf)return null;let i=n+e.nodeSize,a=null;for(let s=0,o;s<r.length;s++)(o=r[s])&&o.from>n&&o.to<i&&((a||(a=[])).push(o),r[s]=null);return a}function sA(r){let e=[];for(let n=0;n<r.length;n++)r[n]!=null&&e.push(r[n]);return e}function Ny(r,e,n,i){let a=[],s=!1;e.forEach((l,u)=>{let c=aA(r,l,u+n);if(c){s=!0;let d=Ny(c,l,n+u+1,i);d!=Ha&&a.push(u,u+l.nodeSize,d)}});let o=iA(s?sA(r):r,-n).sort(jh);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(i.onRemove&&i.onRemove(o[l].spec),o.splice(l--,1));return o.length||a.length?new jn(o,a):Ha}function jh(r,e){return r.from-e.from||r.to-e.to}function SS(r){let e=r;for(let n=0;n<e.length-1;n++){let i=e[n];if(i.from!=i.to)for(let a=n+1;a<e.length;a++){let s=e[a];if(s.from==i.from){s.to!=i.to&&(e==r&&(e=r.slice()),e[a]=s.copy(s.from,i.to),qT(e,a+1,s.copy(i.to,s.to)));continue}else{s.from<i.to&&(e==r&&(e=r.slice()),e[n]=i.copy(i.from,s.from),qT(e,a,i.copy(s.from,i.to)));break}}}return e}function qT(r,e,n){for(;e<r.length&&jh(n,r[e])>0;)e++;r.splice(e,0,n)}function Gw(r){let e=[];return r.someProp("decorations",n=>{let i=n(r.state);i&&i!=Ha&&e.push(i)}),r.cursorWrapper&&e.push(jn.create(r.state.doc,[r.cursorWrapper.deco])),rd.from(e)}const OG={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},DG=Rs&&vd<=11;class IG{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class BG{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new IG,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(i=>{for(let a=0;a<i.length;a++)this.queue.push(i[a]);Rs&&vd<=11&&i.some(a=>a.type=="childList"&&a.removedNodes.length||a.type=="characterData"&&a.oldValue.length>a.target.nodeValue.length)?this.flushSoon():Ea&&e.composing&&i.some(a=>a.type=="childList"&&a.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),DG&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,OG)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(IT(this.view)){if(this.suppressingSelectionUpdates)return Wu(this.view);if(Rs&&vd<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Gh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,i;for(let s=e.focusNode;s;s=gp(s))n.add(s);for(let s=e.anchorNode;s;s=gp(s))if(n.has(s)){i=s;break}let a=i&&this.view.docView.nearestDesc(i);if(a&&a.ignoreMutation({type:"selection",target:i.nodeType==3?i.parentNode:i}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let i=e.domSelectionRange(),a=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(i)&&IT(e)&&!this.ignoreSelectionChange(i),s=-1,o=-1,l=!1,u=[];if(e.editable)for(let d=0;d<n.length;d++){let p=this.registerMutation(n[d],u);p&&(s=s<0?p.from:Math.min(p.from,s),o=o<0?p.to:Math.max(p.to,o),p.typeOver&&(l=!0))}if(Mo&&u.length){let d=u.filter(p=>p.nodeName=="BR");if(d.length==2){let[p,v]=d;p.parentNode&&p.parentNode.parentNode==v.parentNode?v.remove():p.remove()}else{let{focusNode:p}=this.currentSelection;for(let v of d){let y=v.parentNode;y&&y.nodeName=="LI"&&(!p||VG(e,p)!=y)&&v.remove()}}}else if((Zi||Ea)&&u.some(d=>d.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let d of u)if(d.nodeName=="BR"&&d.parentNode){let p=d.nextSibling;p&&p.nodeType==1&&p.contentEditable=="false"&&d.parentNode.removeChild(d)}}let c=null;s<0&&a&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&zx(i)&&(c=gS(e))&&c.eq(sr.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Wu(e),this.currentSelection.set(i),e.scrollToSelection()):(s>-1||a)&&(s>-1&&(e.docView.markDirty(s,o),zG(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,UG(e,u)),this.handleDOMChange(s,o,l,u),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(i)||Wu(e),this.currentSelection.set(i))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let i=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(i==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!i||i.ignoreMutation(e))return null;if(e.type=="childList"){for(let d=0;d<e.addedNodes.length;d++){let p=e.addedNodes[d];n.push(p),p.nodeType==3&&(this.lastChangedTextNode=p)}if(i.contentDOM&&i.contentDOM!=i.dom&&!i.contentDOM.contains(e.target))return{from:i.posBefore,to:i.posAfter};let a=e.previousSibling,s=e.nextSibling;if(Rs&&vd<=11&&e.addedNodes.length)for(let d=0;d<e.addedNodes.length;d++){let{previousSibling:p,nextSibling:v}=e.addedNodes[d];(!p||Array.prototype.indexOf.call(e.addedNodes,p)<0)&&(a=p),(!v||Array.prototype.indexOf.call(e.addedNodes,v)<0)&&(s=v)}let o=a&&a.parentNode==e.target?_a(a)+1:0,l=i.localPosFromDOM(e.target,o,-1),u=s&&s.parentNode==e.target?_a(s):e.target.childNodes.length,c=i.localPosFromDOM(e.target,u,1);return{from:l,to:c}}else return e.type=="attributes"?{from:i.posAtStart-i.border,to:i.posAtEnd+i.border}:(this.lastChangedTextNode=e.target,{from:i.posAtStart,to:i.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let WT=new WeakMap,$T=!1;function zG(r){if(!WT.has(r)&&(WT.set(r,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(r.dom).whiteSpace)!==-1)){if(r.requiresGeckoHackNode=Mo,$T)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),$T=!0}}function KT(r,e){let n=e.startContainer,i=e.startOffset,a=e.endContainer,s=e.endOffset,o=r.domAtPos(r.state.selection.anchor);return Gh(o.node,o.offset,a,s)&&([n,i,a,s]=[a,s,n,i]),{anchorNode:n,anchorOffset:i,focusNode:a,focusOffset:s}}function FG(r,e){if(e.getComposedRanges){let a=e.getComposedRanges(r.root)[0];if(a)return KT(r,a)}let n;function i(a){a.preventDefault(),a.stopImmediatePropagation(),n=a.getTargetRanges()[0]}return r.dom.addEventListener("beforeinput",i,!0),document.execCommand("indent"),r.dom.removeEventListener("beforeinput",i,!0),n?KT(r,n):null}function VG(r,e){for(let n=e.parentNode;n&&n!=r.dom;n=n.parentNode){let i=r.docView.nearestDesc(n,!0);if(i&&i.node.isBlock)return n}return null}function UG(r,e){var n;let{focusNode:i,focusOffset:a}=r.domSelectionRange();for(let s of e)if(((n=s.parentNode)===null||n===void 0?void 0:n.nodeName)=="TR"){let o=s.nextSibling;for(;o&&o.nodeName!="TD"&&o.nodeName!="TH";)o=o.nextSibling;if(o){let l=o;for(;;){let u=l.firstChild;if(!u||u.nodeType!=1||u.contentEditable=="false"||/^(BR|IMG)$/.test(u.nodeName))break;l=u}l.insertBefore(s,l.firstChild),i==s&&r.domSelection().collapse(s,a)}else s.parentNode.removeChild(s)}}function HG(r,e,n){let{node:i,fromOffset:a,toOffset:s,from:o,to:l}=r.docView.parseRange(e,n),u=r.domSelectionRange(),c,d=u.anchorNode;if(d&&r.dom.contains(d.nodeType==1?d:d.parentNode)&&(c=[{node:d,offset:u.anchorOffset}],zx(u)||c.push({node:u.focusNode,offset:u.focusOffset})),Zi&&r.input.lastKeyCode===8)for(let k=s;k>a;k--){let T=i.childNodes[k-1],C=T.pmViewDesc;if(T.nodeName=="BR"&&!C){s=k;break}if(!C||C.size)break}let p=r.state.doc,v=r.someProp("domParser")||gd.fromSchema(r.state.schema),y=p.resolve(o),b=null,S=v.parse(i,{topNode:y.parent,topMatch:y.parent.contentMatchAt(y.index()),topOpen:!0,from:a,to:s,preserveWhitespace:y.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:GG,context:y});if(c&&c[0].pos!=null){let k=c[0].pos,T=c[1]&&c[1].pos;T==null&&(T=k),b={anchor:k+o,head:T+o}}return{doc:S,sel:b,from:o,to:l}}function GG(r){let e=r.pmViewDesc;if(e)return e.parseRule();if(r.nodeName=="BR"&&r.parentNode){if(Ea&&/^(ul|ol)$/i.test(r.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(r.parentNode.lastChild==r||Ea&&/^(tr|table)$/i.test(r.parentNode.nodeName))return{ignore:!0}}else if(r.nodeName=="IMG"&&r.getAttribute("mark-placeholder"))return{ignore:!0};return null}const qG=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function WG(r,e,n,i,a){let s=r.input.compositionPendingChanges||(r.composing?r.input.compositionID:0);if(r.input.compositionPendingChanges=0,e<0){let B=r.input.lastSelectionTime>Date.now()-50?r.input.lastSelectionOrigin:null,I=gS(r,B);if(I&&!r.state.selection.eq(I)){if(Zi&&Gu&&r.input.lastKeyCode===13&&Date.now()-100<r.input.lastKeyCodeTime&&r.someProp("handleKeyDown",V=>V(r,_h(13,"Enter"))))return;let z=r.state.tr.setSelection(I);B=="pointer"?z.setMeta("pointer",!0):B=="key"&&z.scrollIntoView(),s&&z.setMeta("composition",s),r.dispatch(z)}return}let o=r.state.doc.resolve(e),l=o.sharedDepth(n);e=o.before(l+1),n=r.state.doc.resolve(n).after(l+1);let u=r.state.selection,c=HG(r,e,n),d=r.state.doc,p=d.slice(c.from,c.to),v,y;r.input.lastKeyCode===8&&Date.now()-100<r.input.lastKeyCodeTime?(v=r.state.selection.to,y="end"):(v=r.state.selection.from,y="start"),r.input.lastKeyCode=null;let b=ZG(p.content,c.doc.content,c.from,v,y);if(b&&r.input.domChangeCount++,(vp&&r.input.lastIOSEnter>Date.now()-225||Gu)&&a.some(B=>B.nodeType==1&&!qG.test(B.nodeName))&&(!b||b.endA>=b.endB)&&r.someProp("handleKeyDown",B=>B(r,_h(13,"Enter")))){r.input.lastIOSEnter=0;return}if(!b)if(i&&u instanceof Qt&&!u.empty&&u.$head.sameParent(u.$anchor)&&!r.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))b={start:u.from,endA:u.to,endB:u.to};else{if(c.sel){let B=ZT(r,r.state.doc,c.sel);if(B&&!B.eq(r.state.selection)){let I=r.state.tr.setSelection(B);s&&I.setMeta("composition",s),r.dispatch(I)}}return}r.state.selection.from<r.state.selection.to&&b.start==b.endB&&r.state.selection instanceof Qt&&(b.start>r.state.selection.from&&b.start<=r.state.selection.from+2&&r.state.selection.from>=c.from?b.start=r.state.selection.from:b.endA<r.state.selection.to&&b.endA>=r.state.selection.to-2&&r.state.selection.to<=c.to&&(b.endB+=r.state.selection.to-b.endA,b.endA=r.state.selection.to)),Rs&&vd<=11&&b.endB==b.start+1&&b.endA==b.start&&b.start>c.from&&c.doc.textBetween(b.start-c.from-1,b.start-c.from+1)==" "&&(b.start--,b.endA--,b.endB--);let S=c.doc.resolveNoCache(b.start-c.from),k=c.doc.resolveNoCache(b.endB-c.from),T=d.resolve(b.start),C=S.sameParent(k)&&S.parent.inlineContent&&T.end()>=b.endA;if((vp&&r.input.lastIOSEnter>Date.now()-225&&(!C||a.some(B=>B.nodeName=="DIV"||B.nodeName=="P"))||!C&&S.pos<c.doc.content.size&&(!S.sameParent(k)||!S.parent.inlineContent)&&S.pos<k.pos&&!/\S/.test(c.doc.textBetween(S.pos,k.pos,"","")))&&r.someProp("handleKeyDown",B=>B(r,_h(13,"Enter")))){r.input.lastIOSEnter=0;return}if(r.state.selection.anchor>b.start&&KG(d,b.start,b.endA,S,k)&&r.someProp("handleKeyDown",B=>B(r,_h(8,"Backspace")))){Gu&&Zi&&r.domObserver.suppressSelectionUpdates();return}Zi&&b.endB==b.start&&(r.input.lastChromeDelete=Date.now()),Gu&&!C&&S.start()!=k.start()&&k.parentOffset==0&&S.depth==k.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==b.endA&&(b.endB-=2,k=c.doc.resolveNoCache(b.endB-c.from),setTimeout(()=>{r.someProp("handleKeyDown",function(B){return B(r,_h(13,"Enter"))})},20));let N=b.start,P=b.endA,R=B=>{let I=B||r.state.tr.replace(N,P,c.doc.slice(b.start-c.from,b.endB-c.from));if(c.sel){let z=ZT(r,I.doc,c.sel);z&&!(Zi&&r.composing&&z.empty&&(b.start!=b.endB||r.input.lastChromeDelete<Date.now()-100)&&(z.head==N||z.head==I.mapping.map(P)-1)||Rs&&z.empty&&z.head==N)&&I.setSelection(z)}return s&&I.setMeta("composition",s),I.scrollIntoView()},O;if(C)if(S.pos==k.pos){Rs&&vd<=11&&S.parentOffset==0&&(r.domObserver.suppressSelectionUpdates(),setTimeout(()=>Wu(r),20));let B=R(r.state.tr.delete(N,P)),I=d.resolve(b.start).marksAcross(d.resolve(b.endA));I&&B.ensureMarks(I),r.dispatch(B)}else if(b.endA==b.endB&&(O=$G(S.parent.content.cut(S.parentOffset,k.parentOffset),T.parent.content.cut(T.parentOffset,b.endA-T.start())))){let B=R(r.state.tr);O.type=="add"?B.addMark(N,P,O.mark):B.removeMark(N,P,O.mark),r.dispatch(B)}else if(S.parent.child(S.index()).isText&&S.index()==k.index()-(k.textOffset?0:1)){let B=S.parent.textBetween(S.parentOffset,k.parentOffset),I=()=>R(r.state.tr.insertText(B,N,P));r.someProp("handleTextInput",z=>z(r,N,P,B,I))||r.dispatch(I())}else r.dispatch(R());else r.dispatch(R())}function ZT(r,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:vS(r,e.resolve(n.anchor),e.resolve(n.head))}function $G(r,e){let n=r.firstChild.marks,i=e.firstChild.marks,a=n,s=i,o,l,u;for(let d=0;d<i.length;d++)a=i[d].removeFromSet(a);for(let d=0;d<n.length;d++)s=n[d].removeFromSet(s);if(a.length==1&&s.length==0)l=a[0],o="add",u=d=>d.mark(l.addToSet(d.marks));else if(a.length==0&&s.length==1)l=s[0],o="remove",u=d=>d.mark(l.removeFromSet(d.marks));else return null;let c=[];for(let d=0;d<e.childCount;d++)c.push(u(e.child(d)));if(Qe.from(c).eq(r))return{mark:l,type:o}}function KG(r,e,n,i,a){if(n-e<=a.pos-i.pos||qw(i,!0,!1)<a.pos)return!1;let s=r.resolve(e);if(!i.parent.isTextblock){let l=s.nodeAfter;return l!=null&&n==e+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=r.resolve(qw(s,!0,!0));return!o.parent.isTextblock||o.pos>n||qw(o,!0,!1)<n?!1:i.parent.content.cut(i.parentOffset).eq(o.parent.content)}function qw(r,e,n){let i=r.depth,a=e?r.end():r.pos;for(;i>0&&(e||r.indexAfter(i)==r.node(i).childCount);)i--,a++,e=!1;if(n){let s=r.node(i).maybeChild(r.indexAfter(i));for(;s&&!s.isLeaf;)s=s.firstChild,a++}return a}function ZG(r,e,n,i,a){let s=r.findDiffStart(e,n);if(s==null)return null;let{a:o,b:l}=r.findDiffEnd(e,n+r.size,n+e.size);if(a=="end"){let u=Math.max(0,s-Math.min(o,l));i-=o+u-s}if(o<s&&r.size<e.size){let u=i<=s&&i>=o?s-i:0;s-=u,s&&s<e.size&&YT(e.textBetween(s-1,s+1))&&(s+=u?1:-1),l=s+(l-o),o=s}else if(l<s){let u=i<=s&&i>=l?s-i:0;s-=u,s&&s<r.size&&YT(r.textBetween(s-1,s+1))&&(s+=u?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function YT(r){if(r.length!=2)return!1;let e=r.charCodeAt(0),n=r.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class oA{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new dG,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(t3),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=JT(this),QT(this),this.nodeViews=e3(this),this.docView=AT(this.state.doc,XT(this),Gw(this),this.dom,this),this.domObserver=new BG(this,(i,a,s,o)=>WG(this,i,a,s,o)),this.domObserver.start(),hG(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&e_(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(t3),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let i in this._props)n[i]=this._props[i];n.state=this.state;for(let i in e)n[i]=e[i];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var i;let a=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(eA(this),o=!0),this.state=e;let l=a.plugins!=e.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let y=e3(this);XG(y,this.nodeViews)&&(this.nodeViews=y,s=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&e_(this),this.editable=JT(this),QT(this);let u=Gw(this),c=XT(this),d=a.plugins!=e.plugins&&!a.doc.eq(e.doc)?"reset":e.scrollToSelection>a.scrollToSelection?"to selection":"preserve",p=s||!this.docView.matchesNode(e.doc,c,u);(p||!e.selection.eq(a.selection))&&(o=!0);let v=d=="preserve"&&o&&this.dom.style.overflowAnchor==null&&EH(this);if(o){this.domObserver.stop();let y=p&&(Rs||Zi)&&!this.composing&&!a.selection.empty&&!e.selection.empty&&YG(a.selection,e.selection);if(p){let b=Zi?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=EG(this)),(s||!this.docView.update(e.doc,c,u,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=AT(e.doc,c,u,this.dom,this)),b&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(y=!0)}y||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&YH(this))?Wu(this,y):(U6(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(a),!((i=this.dragging)===null||i===void 0)&&i.node&&!a.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,a),d=="reset"?this.dom.scrollTop=0:d=="to selection"?this.scrollToSelection():v&&NH(v)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof Bt){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&CT(this,n.getBoundingClientRect(),e)}else CT(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let i=this.directPlugins[n];i.spec.view&&this.pluginViews.push(i.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let i=this.state.plugins[n];i.spec.view&&this.pluginViews.push(i.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let i=this.pluginViews[n];i.update&&i.update(this,e)}}updateDraggedNode(e,n){let i=e.node,a=-1;if(this.state.doc.nodeAt(i.from)==i.node)a=i.from;else{let s=i.from+(this.state.doc.content.size-n.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==i.node&&(a=s)}this.dragging=new rA(e.slice,e.move,a<0?void 0:Bt.create(this.state.doc,a))}someProp(e,n){let i=this._props&&this._props[e],a;if(i!=null&&(a=n?n(i):i))return a;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(a=n?n(l):l))return a}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[e];if(l!=null&&(a=n?n(l):l))return a}}hasFocus(){if(Rs){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&TH(this.dom),Wu(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return RH(this,e)}coordsAtPos(e,n=1){return L6(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,i=-1){let a=this.docView.posFromDOM(e,n,i);if(a==null)throw new RangeError("DOM position not inside the editor");return a}endOfTextblock(e,n){return BH(this,n||this.state,e)}pasteHTML(e,n){return Yg(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Yg(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return yS(this,e)}destroy(){this.docView&&(fG(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Gw(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,gH())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return mG(this,e)}domSelectionRange(){let e=this.domSelection();return e?Ea&&this.root.nodeType===11&&wH(this.dom.ownerDocument)==this.dom&&FG(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}oA.prototype.dispatch=function(r){let e=this._props.dispatchTransaction;e?e.call(this,r):this.updateState(this.state.apply(r))};function XT(r){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(r.editable),r.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(r.state)),n)for(let i in n)i=="class"?e.class+=" "+n[i]:i=="style"?e.style=(e.style?e.style+";":"")+n[i]:!e[i]&&i!="contenteditable"&&i!="nodeName"&&(e[i]=String(n[i]))}),e.translate||(e.translate="no"),[Ga.node(0,r.state.doc.content.size,e)]}function QT(r){if(r.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),r.cursorWrapper={dom:e,deco:Ga.widget(r.state.selection.from,e,{raw:!0,marks:r.markCursor})}}else r.cursorWrapper=null}function JT(r){return!r.someProp("editable",e=>e(r.state)===!1)}function YG(r,e){let n=Math.min(r.$anchor.sharedDepth(r.head),e.$anchor.sharedDepth(e.head));return r.$anchor.start(n)!=e.$anchor.start(n)}function e3(r){let e=Object.create(null);function n(i){for(let a in i)Object.prototype.hasOwnProperty.call(e,a)||(e[a]=i[a])}return r.someProp("nodeViews",n),r.someProp("markViews",n),e}function XG(r,e){let n=0,i=0;for(let a in r){if(r[a]!=e[a])return!0;n++}for(let a in e)i++;return n!=i}function t3(r){if(r.spec.state||r.spec.filterTransaction||r.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Ed={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ty={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},QG=typeof navigator<"u"&&/Mac/.test(navigator.platform),JG=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Sa=0;Sa<10;Sa++)Ed[48+Sa]=Ed[96+Sa]=String(Sa);for(var Sa=1;Sa<=24;Sa++)Ed[Sa+111]="F"+Sa;for(var Sa=65;Sa<=90;Sa++)Ed[Sa]=String.fromCharCode(Sa+32),Ty[Sa]=String.fromCharCode(Sa);for(var Ww in Ed)Ty.hasOwnProperty(Ww)||(Ty[Ww]=Ed[Ww]);function eq(r){var e=QG&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||JG&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",n=!e&&r.key||(r.shiftKey?Ty:Ed)[r.keyCode]||r.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const tq=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),rq=typeof navigator<"u"&&/Win/.test(navigator.platform);function nq(r){let e=r.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let i,a,s,o;for(let l=0;l<e.length-1;l++){let u=e[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))i=!0;else if(/^(c|ctrl|control)$/i.test(u))a=!0;else if(/^s(hift)?$/i.test(u))s=!0;else if(/^mod$/i.test(u))tq?o=!0:a=!0;else throw new Error("Unrecognized modifier name: "+u)}return i&&(n="Alt-"+n),a&&(n="Ctrl-"+n),o&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function iq(r){let e=Object.create(null);for(let n in r)e[nq(n)]=r[n];return e}function $w(r,e,n=!0){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),n&&e.shiftKey&&(r="Shift-"+r),r}function aq(r){return new On({props:{handleKeyDown:lA(r)}})}function lA(r){let e=iq(r);return function(n,i){let a=eq(i),s,o=e[$w(a,i)];if(o&&o(n.state,n.dispatch,n))return!0;if(a.length==1&&a!=" "){if(i.shiftKey){let l=e[$w(a,i,!1)];if(l&&l(n.state,n.dispatch,n))return!0}if((i.altKey||i.metaKey||i.ctrlKey)&&!(rq&&i.ctrlKey&&i.altKey)&&(s=Ed[i.keyCode])&&s!=a){let l=e[$w(s,i)];if(l&&l(n.state,n.dispatch,n))return!0}}return!1}}var sq=Object.defineProperty,kS=(r,e)=>{for(var n in e)sq(r,n,{get:e[n],enumerable:!0})};function Ux(r){const{state:e,transaction:n}=r;let{selection:i}=n,{doc:a}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return i},get doc(){return a},get tr(){return i=n.selection,a=n.doc,s=n.storedMarks,n}}}var Hx=class{constructor(r){this.editor=r.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=r.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:r,editor:e,state:n}=this,{view:i}=e,{tr:a}=n,s=this.buildProps(a);return Object.fromEntries(Object.entries(r).map(([o,l])=>[o,(...c)=>{const d=l(...c)(s);return!a.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(a),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(r,e=!0){const{rawCommands:n,editor:i,state:a}=this,{view:s}=i,o=[],l=!!r,u=r||a.tr,c=()=>(!l&&e&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(u),o.every(p=>p===!0)),d={...Object.fromEntries(Object.entries(n).map(([p,v])=>[p,(...b)=>{const S=this.buildProps(u,e),k=v(...b)(S);return o.push(k),d}])),run:c};return d}createCan(r){const{rawCommands:e,state:n}=this,i=!1,a=r||n.tr,s=this.buildProps(a,i);return{...Object.fromEntries(Object.entries(e).map(([l,u])=>[l,(...c)=>u(...c)({...s,dispatch:void 0})])),chain:()=>this.createChain(a,i)}}buildProps(r,e=!0){const{rawCommands:n,editor:i,state:a}=this,{view:s}=i,o={tr:r,editor:i,view:s,state:Ux({state:a,transaction:r}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(r,e),can:()=>this.createCan(r),get commands(){return Object.fromEntries(Object.entries(n).map(([l,u])=>[l,(...c)=>u(...c)(o)]))}};return o}},uA={};kS(uA,{blur:()=>oq,clearContent:()=>lq,clearNodes:()=>uq,command:()=>cq,createParagraphNear:()=>dq,cut:()=>hq,deleteCurrentNode:()=>fq,deleteNode:()=>pq,deleteRange:()=>mq,deleteSelection:()=>gq,enter:()=>vq,exitCode:()=>yq,extendMarkRange:()=>xq,first:()=>bq,focus:()=>_q,forEach:()=>Sq,insertContent:()=>kq,insertContentAt:()=>Nq,joinBackward:()=>Mq,joinDown:()=>Pq,joinForward:()=>Aq,joinItemBackward:()=>jq,joinItemForward:()=>Rq,joinTextblockBackward:()=>Lq,joinTextblockForward:()=>Oq,joinUp:()=>Tq,keyboardShortcut:()=>Iq,lift:()=>Bq,liftEmptyBlock:()=>zq,liftListItem:()=>Fq,newlineInCode:()=>Vq,resetAttributes:()=>Uq,scrollIntoView:()=>Hq,selectAll:()=>Gq,selectNodeBackward:()=>qq,selectNodeForward:()=>Wq,selectParentNode:()=>$q,selectTextblockEnd:()=>Kq,selectTextblockStart:()=>Zq,setContent:()=>Yq,setMark:()=>gW,setMeta:()=>vW,setNode:()=>yW,setNodeSelection:()=>xW,setTextDirection:()=>bW,setTextSelection:()=>wW,sinkListItem:()=>_W,splitBlock:()=>SW,splitListItem:()=>kW,toggleList:()=>CW,toggleMark:()=>EW,toggleNode:()=>NW,toggleWrap:()=>TW,undoInputRule:()=>PW,unsetAllMarks:()=>MW,unsetMark:()=>AW,unsetTextDirection:()=>jW,updateAttributes:()=>RW,wrapIn:()=>LW,wrapInList:()=>OW});var oq=()=>({editor:r,view:e})=>(requestAnimationFrame(()=>{var n;r.isDestroyed||(e.dom.blur(),(n=window?.getSelection())==null||n.removeAllRanges())}),!0),lq=(r=!0)=>({commands:e})=>e.setContent("",{emitUpdate:r}),uq=()=>({state:r,tr:e,dispatch:n})=>{const{selection:i}=e,{ranges:a}=i;return n&&a.forEach(({$from:s,$to:o})=>{r.doc.nodesBetween(s.pos,o.pos,(l,u)=>{if(l.type.isText)return;const{doc:c,mapping:d}=e,p=c.resolve(d.map(u)),v=c.resolve(d.map(u+l.nodeSize)),y=p.blockRange(v);if(!y)return;const b=Lp(y);if(l.type.isTextblock){const{defaultType:S}=p.parent.contentMatchAt(p.index());e.setNodeMarkup(y.start,S)}(b||b===0)&&e.lift(y,b)})}),!0},cq=r=>e=>r(e),dq=()=>({state:r,dispatch:e})=>S6(r,e),hq=(r,e)=>({editor:n,tr:i})=>{const{state:a}=n,s=a.doc.slice(r.from,r.to);i.deleteRange(r.from,r.to);const o=i.mapping.map(e);return i.insert(o,s.content),i.setSelection(new Qt(i.doc.resolve(Math.max(o-1,0)))),!0},fq=()=>({tr:r,dispatch:e})=>{const{selection:n}=r,i=n.$anchor.node();if(i.content.size>0)return!1;const a=r.selection.$anchor;for(let s=a.depth;s>0;s-=1)if(a.node(s).type===i.type){if(e){const l=a.before(s),u=a.after(s);r.delete(l,u).scrollIntoView()}return!0}return!1};function wi(r,e){if(typeof r=="string"){if(!e.nodes[r])throw Error(`There is no node type named '${r}'. Maybe you forgot to add the extension?`);return e.nodes[r]}return r}var pq=r=>({tr:e,state:n,dispatch:i})=>{const a=wi(r,n.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===a){if(i){const u=s.before(o),c=s.after(o);e.delete(u,c).scrollIntoView()}return!0}return!1},mq=r=>({tr:e,dispatch:n})=>{const{from:i,to:a}=r;return n&&e.delete(i,a),!0},gq=()=>({state:r,dispatch:e})=>cS(r,e),vq=()=>({commands:r})=>r.keyboardShortcut("Enter"),yq=()=>({state:r,dispatch:e})=>tH(r,e);function CS(r){return Object.prototype.toString.call(r)==="[object RegExp]"}function Py(r,e,n={strict:!0}){const i=Object.keys(e);return i.length?i.every(a=>n.strict?e[a]===r[a]:CS(e[a])?e[a].test(r[a]):e[a]===r[a]):!0}function cA(r,e,n={}){return r.find(i=>i.type===e&&Py(Object.fromEntries(Object.keys(n).map(a=>[a,i.attrs[a]])),n))}function r3(r,e,n={}){return!!cA(r,e,n)}function ES(r,e,n){var i;if(!r||!e)return;let a=r.parent.childAfter(r.parentOffset);if((!a.node||!a.node.marks.some(d=>d.type===e))&&(a=r.parent.childBefore(r.parentOffset)),!a.node||!a.node.marks.some(d=>d.type===e)||(n=n||((i=a.node.marks[0])==null?void 0:i.attrs),!cA([...a.node.marks],e,n)))return;let o=a.index,l=r.start()+a.offset,u=o+1,c=l+a.node.nodeSize;for(;o>0&&r3([...r.parent.child(o-1).marks],e,n);)o-=1,l-=r.parent.child(o).nodeSize;for(;u<r.parent.childCount&&r3([...r.parent.child(u).marks],e,n);)c+=r.parent.child(u).nodeSize,u+=1;return{from:l,to:c}}function ec(r,e){if(typeof r=="string"){if(!e.marks[r])throw Error(`There is no mark type named '${r}'. Maybe you forgot to add the extension?`);return e.marks[r]}return r}var xq=(r,e={})=>({tr:n,state:i,dispatch:a})=>{const s=ec(r,i.schema),{doc:o,selection:l}=n,{$from:u,from:c,to:d}=l;if(a){const p=ES(u,s,e);if(p&&p.from<=c&&p.to>=d){const v=Qt.create(o,p.from,p.to);n.setSelection(v)}}return!0},bq=r=>e=>{const n=typeof r=="function"?r(e):r;for(let i=0;i<n.length;i+=1)if(n[i](e))return!0;return!1};function dA(r){return r instanceof Qt}function Eh(r=0,e=0,n=0){return Math.min(Math.max(r,e),n)}function hA(r,e=null){if(!e)return null;const n=sr.atStart(r),i=sr.atEnd(r);if(e==="start"||e===!0)return n;if(e==="end")return i;const a=n.from,s=i.to;return e==="all"?Qt.create(r,Eh(0,a,s),Eh(r.content.size,a,s)):Qt.create(r,Eh(e,a,s),Eh(e,a,s))}function n3(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function My(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function wq(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var _q=(r=null,e={})=>({editor:n,view:i,tr:a,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{(My()||n3())&&i.dom.focus(),wq()&&!My()&&!n3()&&i.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{n.isDestroyed||(i.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};if(i.hasFocus()&&r===null||r===!1)return!0;if(s&&r===null&&!dA(n.state.selection))return o(),!0;const l=hA(a.doc,r)||n.state.selection,u=n.state.selection.eq(l);return s&&(u||a.setSelection(l),u&&a.storedMarks&&a.setStoredMarks(a.storedMarks),o()),!0},Sq=(r,e)=>n=>r.every((i,a)=>e(i,{...n,index:a})),kq=(r,e)=>({tr:n,commands:i})=>i.insertContentAt({from:n.selection.from,to:n.selection.to},r,e),fA=r=>{const e=r.childNodes;for(let n=e.length-1;n>=0;n-=1){const i=e[n];i.nodeType===3&&i.nodeValue&&/^(\n\s\s|\n)$/.test(i.nodeValue)?r.removeChild(i):i.nodeType===1&&fA(i)}return r};function C0(r){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${r}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return fA(n)}function Qg(r,e,n){if(r instanceof Po||r instanceof Qe)return r;n={slice:!0,parseOptions:{},...n};const i=typeof r=="object"&&r!==null,a=typeof r=="string";if(i)try{if(Array.isArray(r)&&r.length>0)return Qe.fromArray(r.map(l=>e.nodeFromJSON(l)));const o=e.nodeFromJSON(r);return n.errorOnInvalidContent&&o.check(),o}catch(s){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",r,"Error:",s),Qg("",e,n)}if(a){if(n.errorOnInvalidContent){let o=!1,l="";const u=new YM({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(o=!0,l=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?gd.fromSchema(u).parseSlice(C0(r),n.parseOptions):gd.fromSchema(u).parse(C0(r),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const s=gd.fromSchema(e);return n.slice?s.parseSlice(C0(r),n.parseOptions).content:s.parse(C0(r),n.parseOptions)}return Qg("",e,n)}function Cq(r,e,n){const i=r.steps.length-1;if(i<e)return;const a=r.steps[i];if(!(a instanceof Ki||a instanceof Qi))return;const s=r.mapping.maps[i];let o=0;s.forEach((l,u,c,d)=>{o===0&&(o=d)}),r.setSelection(sr.near(r.doc.resolve(o),n))}var Eq=r=>!("type"in r),Nq=(r,e,n)=>({tr:i,dispatch:a,editor:s})=>{var o;if(a){n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l;const u=k=>{s.emit("contentError",{editor:s,error:k,disableCollaboration:()=>{"collaboration"in s.storage&&typeof s.storage.collaboration=="object"&&s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Qg(e,s.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(k){u(k)}try{l=Qg(e,s.schema,{parseOptions:c,errorOnInvalidContent:(o=n.errorOnInvalidContent)!=null?o:s.options.enableContentCheck})}catch(k){return u(k),!1}let{from:d,to:p}=typeof r=="number"?{from:r,to:r}:{from:r.from,to:r.to},v=!0,y=!0;if((Eq(l)?l:[l]).forEach(k=>{k.check(),v=v?k.isText&&k.marks.length===0:!1,y=y?k.isBlock:!1}),d===p&&y){const{parent:k}=i.doc.resolve(d);k.isTextblock&&!k.type.spec.code&&!k.childCount&&(d-=1,p+=1)}let S;if(v){if(Array.isArray(e))S=e.map(k=>k.text||"").join("");else if(e instanceof Qe){let k="";e.forEach(T=>{T.text&&(k+=T.text)}),S=k}else typeof e=="object"&&e&&e.text?S=e.text:S=e;i.insertText(S,d,p)}else{S=l;const k=i.doc.resolve(d),T=k.node(),C=k.parentOffset===0,N=T.isText||T.isTextblock,P=T.content.size>0;C&&N&&P&&(d=Math.max(0,d-1)),i.replaceWith(d,p,S)}n.updateSelection&&Cq(i,i.steps.length-1,-1),n.applyInputRules&&i.setMeta("applyInputRules",{from:d,text:S}),n.applyPasteRules&&i.setMeta("applyPasteRules",{from:d,text:S})}return!0},Tq=()=>({state:r,dispatch:e})=>QU(r,e),Pq=()=>({state:r,dispatch:e})=>JU(r,e),Mq=()=>({state:r,dispatch:e})=>g6(r,e),Aq=()=>({state:r,dispatch:e})=>b6(r,e),jq=()=>({state:r,dispatch:e,tr:n})=>{try{const i=Dx(r.doc,r.selection.$from.pos,-1);return i==null?!1:(n.join(i,2),e&&e(n),!0)}catch{return!1}},Rq=()=>({state:r,dispatch:e,tr:n})=>{try{const i=Dx(r.doc,r.selection.$from.pos,1);return i==null?!1:(n.join(i,2),e&&e(n),!0)}catch{return!1}},Lq=()=>({state:r,dispatch:e})=>YU(r,e),Oq=()=>({state:r,dispatch:e})=>XU(r,e);function pA(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Dq(r){const e=r.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let i,a,s,o;for(let l=0;l<e.length-1;l+=1){const u=e[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))i=!0;else if(/^(c|ctrl|control)$/i.test(u))a=!0;else if(/^s(hift)?$/i.test(u))s=!0;else if(/^mod$/i.test(u))My()||pA()?o=!0:a=!0;else throw new Error(`Unrecognized modifier name: ${u}`)}return i&&(n=`Alt-${n}`),a&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),s&&(n=`Shift-${n}`),n}var Iq=r=>({editor:e,view:n,tr:i,dispatch:a})=>{const s=Dq(r).split(/-(?!$)/),o=s.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),u=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,l))});return u?.steps.forEach(c=>{const d=c.map(i.mapping);d&&a&&i.maybeStep(d)}),!0};function Nd(r,e,n={}){const{from:i,to:a,empty:s}=r.selection,o=e?wi(e,r.schema):null,l=[];r.doc.nodesBetween(i,a,(p,v)=>{if(p.isText)return;const y=Math.max(i,v),b=Math.min(a,v+p.nodeSize);l.push({node:p,from:y,to:b})});const u=a-i,c=l.filter(p=>o?o.name===p.node.type.name:!0).filter(p=>Py(p.node.attrs,n,{strict:!1}));return s?!!c.length:c.reduce((p,v)=>p+v.to-v.from,0)>=u}var Bq=(r,e={})=>({state:n,dispatch:i})=>{const a=wi(r,n.schema);return Nd(n,a,e)?eH(n,i):!1},zq=()=>({state:r,dispatch:e})=>k6(r,e),Fq=r=>({state:e,dispatch:n})=>{const i=wi(r,e.schema);return hH(i)(e,n)},Vq=()=>({state:r,dispatch:e})=>_6(r,e);function Gx(r,e){return e.nodes[r]?"node":e.marks[r]?"mark":null}function i3(r,e){const n=typeof e=="string"?[e]:e;return Object.keys(r).reduce((i,a)=>(n.includes(a)||(i[a]=r[a]),i),{})}var Uq=(r,e)=>({tr:n,state:i,dispatch:a})=>{let s=null,o=null;const l=Gx(typeof r=="string"?r:r.name,i.schema);if(!l)return!1;l==="node"&&(s=wi(r,i.schema)),l==="mark"&&(o=ec(r,i.schema));let u=!1;return n.selection.ranges.forEach(c=>{i.doc.nodesBetween(c.$from.pos,c.$to.pos,(d,p)=>{s&&s===d.type&&(u=!0,a&&n.setNodeMarkup(p,void 0,i3(d.attrs,e))),o&&d.marks.length&&d.marks.forEach(v=>{o===v.type&&(u=!0,a&&n.addMark(p,p+d.nodeSize,o.create(i3(v.attrs,e))))})})}),u},Hq=()=>({tr:r,dispatch:e})=>(e&&r.scrollIntoView(),!0),Gq=()=>({tr:r,dispatch:e})=>{if(e){const n=new Qs(r.doc);r.setSelection(n)}return!0},qq=()=>({state:r,dispatch:e})=>y6(r,e),Wq=()=>({state:r,dispatch:e})=>w6(r,e),$q=()=>({state:r,dispatch:e})=>iH(r,e),Kq=()=>({state:r,dispatch:e})=>oH(r,e),Zq=()=>({state:r,dispatch:e})=>sH(r,e);function t_(r,e,n={},i={}){return Qg(r,e,{slice:!1,parseOptions:n,errorOnInvalidContent:i.errorOnInvalidContent})}var Yq=(r,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:i={}}={})=>({editor:a,tr:s,dispatch:o,commands:l})=>{const{doc:u}=s;if(i.preserveWhitespace!=="full"){const c=t_(r,a.schema,i,{errorOnInvalidContent:e??a.options.enableContentCheck});return o&&s.replaceWith(0,u.content.size,c).setMeta("preventUpdate",!n),!0}return o&&s.setMeta("preventUpdate",!n),l.insertContentAt({from:0,to:u.content.size},r,{parseOptions:i,errorOnInvalidContent:e??a.options.enableContentCheck})};function mA(r,e){const n=ec(e,r.schema),{from:i,to:a,empty:s}=r.selection,o=[];s?(r.storedMarks&&o.push(...r.storedMarks),o.push(...r.selection.$head.marks())):r.doc.nodesBetween(i,a,u=>{o.push(...u.marks)});const l=o.find(u=>u.type.name===n.name);return l?{...l.attrs}:{}}function gA(r,e){const n=new h6(r);return e.forEach(i=>{i.steps.forEach(a=>{n.step(a)})}),n}function Xq(r){for(let e=0;e<r.edgeCount;e+=1){const{type:n}=r.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function Qq(r,e,n){const i=[];return r.nodesBetween(e.from,e.to,(a,s)=>{n(a)&&i.push({node:a,pos:s})}),i}function Jq(r,e){for(let n=r.depth;n>0;n-=1){const i=r.node(n);if(e(i))return{pos:n>0?r.before(n):0,start:r.start(n),depth:n,node:i}}}function qx(r){return e=>Jq(e.$from,r)}function Ot(r,e,n){return r.config[e]===void 0&&r.parent?Ot(r.parent,e,n):typeof r.config[e]=="function"?r.config[e].bind({...n,parent:r.parent?Ot(r.parent,e,n):null}):r.config[e]}function NS(r){return r.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},i=Ot(e,"addExtensions",n);return i?[e,...NS(i())]:e}).flat(10)}function TS(r,e){const n=Qh.fromSchema(e).serializeFragment(r),a=document.implementation.createHTMLDocument().createElement("div");return a.appendChild(n),a.innerHTML}function vA(r){return typeof r=="function"}function Gr(r,e=void 0,...n){return vA(r)?e?r.bind(e)(...n):r(...n):r}function eW(r={}){return Object.keys(r).length===0&&r.constructor===Object}function yp(r){const e=r.filter(a=>a.type==="extension"),n=r.filter(a=>a.type==="node"),i=r.filter(a=>a.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:i}}function yA(r){const e=[],{nodeExtensions:n,markExtensions:i}=yp(r),a=[...n,...i],s={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return r.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage,extensions:a},u=Ot(o,"addGlobalAttributes",l);if(!u)return;u().forEach(d=>{d.types.forEach(p=>{Object.entries(d.attributes).forEach(([v,y])=>{e.push({type:p,name:v,attribute:{...s,...y}})})})})}),a.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},u=Ot(o,"addAttributes",l);if(!u)return;const c=u();Object.entries(c).forEach(([d,p])=>{const v={...s,...p};typeof v?.default=="function"&&(v.default=v.default()),v?.isRequired&&v?.default===void 0&&delete v.default,e.push({type:o.name,name:d,attribute:v})})}),e}function Ln(...r){return r.filter(e=>!!e).reduce((e,n)=>{const i={...e};return Object.entries(n).forEach(([a,s])=>{if(!i[a]){i[a]=s;return}if(a==="class"){const l=s?String(s).split(" "):[],u=i[a]?i[a].split(" "):[],c=l.filter(d=>!u.includes(d));i[a]=[...u,...c].join(" ")}else if(a==="style"){const l=s?s.split(";").map(d=>d.trim()).filter(Boolean):[],u=i[a]?i[a].split(";").map(d=>d.trim()).filter(Boolean):[],c=new Map;u.forEach(d=>{const[p,v]=d.split(":").map(y=>y.trim());c.set(p,v)}),l.forEach(d=>{const[p,v]=d.split(":").map(y=>y.trim());c.set(p,v)}),i[a]=Array.from(c.entries()).map(([d,p])=>`${d}: ${p}`).join("; ")}else i[a]=s}),i},{})}function Jg(r,e){return e.filter(n=>n.type===r.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(r.attrs)||{}:{[n.name]:r.attrs[n.name]}).reduce((n,i)=>Ln(n,i),{})}function tW(r){return typeof r!="string"?r:r.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(r):r==="true"?!0:r==="false"?!1:r}function a3(r,e){return"style"in r?r:{...r,getAttrs:n=>{const i=r.getAttrs?r.getAttrs(n):r.attrs;if(i===!1)return!1;const a=e.reduce((s,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(n):tW(n.getAttribute(o.name));return l==null?s:{...s,[o.name]:l}},{});return{...i,...a}}}}function s3(r){return Object.fromEntries(Object.entries(r).filter(([e,n])=>e==="attrs"&&eW(n)?!1:n!=null))}function o3(r){var e,n;const i={};return!((e=r?.attribute)!=null&&e.isRequired)&&"default"in(r?.attribute||{})&&(i.default=r.attribute.default),((n=r?.attribute)==null?void 0:n.validate)!==void 0&&(i.validate=r.attribute.validate),[r.name,i]}function rW(r,e){var n;const i=yA(r),{nodeExtensions:a,markExtensions:s}=yp(r),o=(n=a.find(c=>Ot(c,"topNode")))==null?void 0:n.name,l=Object.fromEntries(a.map(c=>{const d=i.filter(T=>T.type===c.name),p={name:c.name,options:c.options,storage:c.storage,editor:e},v=r.reduce((T,C)=>{const N=Ot(C,"extendNodeSchema",p);return{...T,...N?N(c):{}}},{}),y=s3({...v,content:Gr(Ot(c,"content",p)),marks:Gr(Ot(c,"marks",p)),group:Gr(Ot(c,"group",p)),inline:Gr(Ot(c,"inline",p)),atom:Gr(Ot(c,"atom",p)),selectable:Gr(Ot(c,"selectable",p)),draggable:Gr(Ot(c,"draggable",p)),code:Gr(Ot(c,"code",p)),whitespace:Gr(Ot(c,"whitespace",p)),linebreakReplacement:Gr(Ot(c,"linebreakReplacement",p)),defining:Gr(Ot(c,"defining",p)),isolating:Gr(Ot(c,"isolating",p)),attrs:Object.fromEntries(d.map(o3))}),b=Gr(Ot(c,"parseHTML",p));b&&(y.parseDOM=b.map(T=>a3(T,d)));const S=Ot(c,"renderHTML",p);S&&(y.toDOM=T=>S({node:T,HTMLAttributes:Jg(T,d)}));const k=Ot(c,"renderText",p);return k&&(y.toText=k),[c.name,y]})),u=Object.fromEntries(s.map(c=>{const d=i.filter(k=>k.type===c.name),p={name:c.name,options:c.options,storage:c.storage,editor:e},v=r.reduce((k,T)=>{const C=Ot(T,"extendMarkSchema",p);return{...k,...C?C(c):{}}},{}),y=s3({...v,inclusive:Gr(Ot(c,"inclusive",p)),excludes:Gr(Ot(c,"excludes",p)),group:Gr(Ot(c,"group",p)),spanning:Gr(Ot(c,"spanning",p)),code:Gr(Ot(c,"code",p)),attrs:Object.fromEntries(d.map(o3))}),b=Gr(Ot(c,"parseHTML",p));b&&(y.parseDOM=b.map(k=>a3(k,d)));const S=Ot(c,"renderHTML",p);return S&&(y.toDOM=k=>S({mark:k,HTMLAttributes:Jg(k,d)})),[c.name,y]}));return new YM({topNode:o,nodes:l,marks:u})}function nW(r){const e=r.filter((n,i)=>r.indexOf(n)!==i);return Array.from(new Set(e))}function Ay(r){return r.sort((n,i)=>{const a=Ot(n,"priority")||100,s=Ot(i,"priority")||100;return a>s?-1:a<s?1:0})}function xA(r){const e=Ay(NS(r)),n=nW(e.map(i=>i.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),e}function bA(r,e,n){const{from:i,to:a}=e,{blockSeparator:s=`

`,textSerializers:o={}}=n||{};let l="";return r.nodesBetween(i,a,(u,c,d,p)=>{var v;u.isBlock&&c>i&&(l+=s);const y=o?.[u.type.name];if(y)return d&&(l+=y({node:u,pos:c,parent:d,index:p,range:e})),!1;u.isText&&(l+=(v=u?.text)==null?void 0:v.slice(Math.max(i,c)-c,a-c))}),l}function iW(r,e){const n={from:0,to:r.content.size};return bA(r,n,e)}function wA(r){return Object.fromEntries(Object.entries(r.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function aW(r,e){const n=wi(e,r.schema),{from:i,to:a}=r.selection,s=[];r.doc.nodesBetween(i,a,l=>{s.push(l)});const o=s.reverse().find(l=>l.type.name===n.name);return o?{...o.attrs}:{}}function _A(r,e){const n=Gx(typeof e=="string"?e:e.name,r.schema);return n==="node"?aW(r,e):n==="mark"?mA(r,e):{}}function sW(r,e=JSON.stringify){const n={};return r.filter(i=>{const a=e(i);return Object.prototype.hasOwnProperty.call(n,a)?!1:n[a]=!0})}function oW(r){const e=sW(r);return e.length===1?e:e.filter((n,i)=>!e.filter((s,o)=>o!==i).some(s=>n.oldRange.from>=s.oldRange.from&&n.oldRange.to<=s.oldRange.to&&n.newRange.from>=s.newRange.from&&n.newRange.to<=s.newRange.to))}function SA(r){const{mapping:e,steps:n}=r,i=[];return e.maps.forEach((a,s)=>{const o=[];if(a.ranges.length)a.forEach((l,u)=>{o.push({from:l,to:u})});else{const{from:l,to:u}=n[s];if(l===void 0||u===void 0)return;o.push({from:l,to:u})}o.forEach(({from:l,to:u})=>{const c=e.slice(s).map(l,-1),d=e.slice(s).map(u),p=e.invert().map(c,-1),v=e.invert().map(d);i.push({oldRange:{from:p,to:v},newRange:{from:c,to:d}})})}),oW(i)}function PS(r,e,n){const i=[];return r===e?n.resolve(r).marks().forEach(a=>{const s=n.resolve(r),o=ES(s,a.type);o&&i.push({mark:a,...o})}):n.nodesBetween(r,e,(a,s)=>{!a||a?.nodeSize===void 0||i.push(...a.marks.map(o=>({from:s,to:s+a.nodeSize,mark:o})))}),i}var lW=(r,e,n,i=20)=>{const a=r.doc.resolve(n);let s=i,o=null;for(;s>0&&o===null;){const l=a.node(s);l?.type.name===e?o=l:s-=1}return[o,s]};function E0(r,e){return e.nodes[r]||e.marks[r]||null}function X0(r,e,n){return Object.fromEntries(Object.entries(n).filter(([i])=>{const a=r.find(s=>s.type===e&&s.name===i);return a?a.attribute.keepOnSplit:!1}))}var uW=(r,e=500)=>{let n="";const i=r.parentOffset;return r.parent.nodesBetween(Math.max(0,i-e),i,(a,s,o,l)=>{var u,c;const d=((c=(u=a.type.spec).toText)==null?void 0:c.call(u,{node:a,pos:s,parent:o,index:l}))||a.textContent||"%leaf%";n+=a.isAtom&&!a.isText?d:d.slice(0,Math.max(0,i-s))}),n};function r_(r,e,n={}){const{empty:i,ranges:a}=r.selection,s=e?ec(e,r.schema):null;if(i)return!!(r.storedMarks||r.selection.$from.marks()).filter(p=>s?s.name===p.type.name:!0).find(p=>Py(p.attrs,n,{strict:!1}));let o=0;const l=[];if(a.forEach(({$from:p,$to:v})=>{const y=p.pos,b=v.pos;r.doc.nodesBetween(y,b,(S,k)=>{if(!S.isText&&!S.marks.length)return;const T=Math.max(y,k),C=Math.min(b,k+S.nodeSize),N=C-T;o+=N,l.push(...S.marks.map(P=>({mark:P,from:T,to:C})))})}),o===0)return!1;const u=l.filter(p=>s?s.name===p.mark.type.name:!0).filter(p=>Py(p.mark.attrs,n,{strict:!1})).reduce((p,v)=>p+v.to-v.from,0),c=l.filter(p=>s?p.mark.type!==s&&p.mark.type.excludes(s):!0).reduce((p,v)=>p+v.to-v.from,0);return(u>0?u+c:u)>=o}function cW(r,e,n={}){if(!e)return Nd(r,null,n)||r_(r,null,n);const i=Gx(e,r.schema);return i==="node"?Nd(r,e,n):i==="mark"?r_(r,e,n):!1}var dW=(r,e)=>{const{$from:n,$to:i,$anchor:a}=r.selection;if(e){const s=qx(l=>l.type.name===e)(r.selection);if(!s)return!1;const o=r.doc.resolve(s.pos+1);return a.pos+1===o.end()}return!(i.parentOffset<i.parent.nodeSize-2||n.pos!==i.pos)},hW=r=>{const{$from:e,$to:n}=r.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function l3(r,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===r.name):e}function u3(r,e){const{nodeExtensions:n}=yp(e),i=n.find(o=>o.name===r);if(!i)return!1;const a={name:i.name,options:i.options,storage:i.storage},s=Gr(Ot(i,"group",a));return typeof s!="string"?!1:s.split(" ").includes("list")}function Wx(r,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var i;if(n){if(r.type.name==="hardBreak")return!0;if(r.isText)return/^\s*$/m.test((i=r.text)!=null?i:"")}if(r.isText)return!r.text;if(r.isAtom||r.isLeaf)return!1;if(r.content.childCount===0)return!0;if(e){let a=!0;return r.content.forEach(s=>{a!==!1&&(Wx(s,{ignoreWhitespace:n,checkChildren:e})||(a=!1))}),a}return!1}function kA(r){return r instanceof Bt}var CA=class EA{constructor(e){this.position=e}static fromJSON(e){return new EA(e.position)}toJSON(){return{position:this.position}}};function fW(r,e){const n=e.mapping.mapResult(r.position);return{position:new CA(n.pos),mapResult:n}}function pW(r){return new CA(r)}function mW(r,e,n){var i;const{selection:a}=e;let s=null;if(dA(a)&&(s=a.$cursor),s){const l=(i=r.storedMarks)!=null?i:s.marks();return s.parent.type.allowsMarkType(n)&&(!!n.isInSet(l)||!l.some(c=>c.type.excludes(n)))}const{ranges:o}=a;return o.some(({$from:l,$to:u})=>{let c=l.depth===0?r.doc.inlineContent&&r.doc.type.allowsMarkType(n):!1;return r.doc.nodesBetween(l.pos,u.pos,(d,p,v)=>{if(c)return!1;if(d.isInline){const y=!v||v.type.allowsMarkType(n),b=!!n.isInSet(d.marks)||!d.marks.some(S=>S.type.excludes(n));c=y&&b}return!c}),c})}var gW=(r,e={})=>({tr:n,state:i,dispatch:a})=>{const{selection:s}=n,{empty:o,ranges:l}=s,u=ec(r,i.schema);if(a)if(o){const c=mA(i,u);n.addStoredMark(u.create({...c,...e}))}else l.forEach(c=>{const d=c.$from.pos,p=c.$to.pos;i.doc.nodesBetween(d,p,(v,y)=>{const b=Math.max(y,d),S=Math.min(y+v.nodeSize,p);v.marks.find(T=>T.type===u)?v.marks.forEach(T=>{u===T.type&&n.addMark(b,S,u.create({...T.attrs,...e}))}):n.addMark(b,S,u.create(e))})});return mW(i,n,u)},vW=(r,e)=>({tr:n})=>(n.setMeta(r,e),!0),yW=(r,e={})=>({state:n,dispatch:i,chain:a})=>{const s=wi(r,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),s.isTextblock?a().command(({commands:l})=>_T(s,{...o,...e})(n)?!0:l.clearNodes()).command(({state:l})=>_T(s,{...o,...e})(l,i)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},xW=r=>({tr:e,dispatch:n})=>{if(n){const{doc:i}=e,a=Eh(r,0,i.content.size),s=Bt.create(i,a);e.setSelection(s)}return!0},bW=(r,e)=>({tr:n,state:i,dispatch:a})=>{const{selection:s}=i;let o,l;return typeof e=="number"?(o=e,l=e):e&&"from"in e&&"to"in e?(o=e.from,l=e.to):(o=s.from,l=s.to),a&&n.doc.nodesBetween(o,l,(u,c)=>{u.isText||n.setNodeMarkup(c,void 0,{...u.attrs,dir:r})}),!0},wW=r=>({tr:e,dispatch:n})=>{if(n){const{doc:i}=e,{from:a,to:s}=typeof r=="number"?{from:r,to:r}:r,o=Qt.atStart(i).from,l=Qt.atEnd(i).to,u=Eh(a,o,l),c=Eh(s,o,l),d=Qt.create(i,u,c);e.setSelection(d)}return!0},_W=r=>({state:e,dispatch:n})=>{const i=wi(r,e.schema);return mH(i)(e,n)};function c3(r,e){const n=r.storedMarks||r.selection.$to.parentOffset&&r.selection.$from.marks();if(n){const i=n.filter(a=>e?.includes(a.type.name));r.tr.ensureMarks(i)}}var SW=({keepMarks:r=!0}={})=>({tr:e,state:n,dispatch:i,editor:a})=>{const{selection:s,doc:o}=e,{$from:l,$to:u}=s,c=a.extensionManager.attributes,d=X0(c,l.node().type.name,l.node().attrs);if(s instanceof Bt&&s.node.isBlock)return!l.parentOffset||!qu(o,l.pos)?!1:(i&&(r&&c3(n,a.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const p=u.parentOffset===u.parent.content.size,v=l.depth===0?void 0:Xq(l.node(-1).contentMatchAt(l.indexAfter(-1)));let y=p&&v?[{type:v,attrs:d}]:void 0,b=qu(e.doc,e.mapping.map(l.pos),1,y);if(!y&&!b&&qu(e.doc,e.mapping.map(l.pos),1,v?[{type:v}]:void 0)&&(b=!0,y=v?[{type:v,attrs:d}]:void 0),i){if(b&&(s instanceof Qt&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,y),v&&!p&&!l.parentOffset&&l.parent.type!==v)){const S=e.mapping.map(l.before()),k=e.doc.resolve(S);l.node(-1).canReplaceWith(k.index(),k.index()+1,v)&&e.setNodeMarkup(e.mapping.map(l.before()),v)}r&&c3(n,a.extensionManager.splittableMarks),e.scrollIntoView()}return b},kW=(r,e={})=>({tr:n,state:i,dispatch:a,editor:s})=>{var o;const l=wi(r,i.schema),{$from:u,$to:c}=i.selection,d=i.selection.node;if(d&&d.isBlock||u.depth<2||!u.sameParent(c))return!1;const p=u.node(-1);if(p.type!==l)return!1;const v=s.extensionManager.attributes;if(u.parent.content.size===0&&u.node(-1).childCount===u.indexAfter(-1)){if(u.depth===2||u.node(-3).type!==l||u.index(-2)!==u.node(-2).childCount-1)return!1;if(a){let T=Qe.empty;const C=u.index(-1)?1:u.index(-2)?2:3;for(let I=u.depth-C;I>=u.depth-3;I-=1)T=Qe.from(u.node(I).copy(T));const N=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,P={...X0(v,u.node().type.name,u.node().attrs),...e},R=((o=l.contentMatch.defaultType)==null?void 0:o.createAndFill(P))||void 0;T=T.append(Qe.from(l.createAndFill(null,R)||void 0));const O=u.before(u.depth-(C-1));n.replace(O,u.after(-N),new St(T,4-C,0));let B=-1;n.doc.nodesBetween(O,n.doc.content.size,(I,z)=>{if(B>-1)return!1;I.isTextblock&&I.content.size===0&&(B=z+1)}),B>-1&&n.setSelection(Qt.near(n.doc.resolve(B))),n.scrollIntoView()}return!0}const y=c.pos===u.end()?p.contentMatchAt(0).defaultType:null,b={...X0(v,p.type.name,p.attrs),...e},S={...X0(v,u.node().type.name,u.node().attrs),...e};n.delete(u.pos,c.pos);const k=y?[{type:l,attrs:b},{type:y,attrs:S}]:[{type:l,attrs:b}];if(!qu(n.doc,u.pos,2))return!1;if(a){const{selection:T,storedMarks:C}=i,{splittableMarks:N}=s.extensionManager,P=C||T.$to.parentOffset&&T.$from.marks();if(n.split(u.pos,2,k).scrollIntoView(),!P||!a)return!0;const R=P.filter(O=>N.includes(O.type.name));n.ensureMarks(R)}return!0},Kw=(r,e)=>{const n=qx(o=>o.type===e)(r.selection);if(!n)return!0;const i=r.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(i===void 0)return!0;const a=r.doc.nodeAt(i);return n.node.type===a?.type&&Od(r.doc,n.pos)&&r.join(n.pos),!0},Zw=(r,e)=>{const n=qx(o=>o.type===e)(r.selection);if(!n)return!0;const i=r.doc.resolve(n.start).after(n.depth);if(i===void 0)return!0;const a=r.doc.nodeAt(i);return n.node.type===a?.type&&Od(r.doc,i)&&r.join(i),!0},CW=(r,e,n,i={})=>({editor:a,tr:s,state:o,dispatch:l,chain:u,commands:c,can:d})=>{const{extensions:p,splittableMarks:v}=a.extensionManager,y=wi(r,o.schema),b=wi(e,o.schema),{selection:S,storedMarks:k}=o,{$from:T,$to:C}=S,N=T.blockRange(C),P=k||S.$to.parentOffset&&S.$from.marks();if(!N)return!1;const R=qx(O=>u3(O.type.name,p))(S);if(N.depth>=1&&R&&N.depth-R.depth<=1){if(R.node.type===y)return c.liftListItem(b);if(u3(R.node.type.name,p)&&y.validContent(R.node.content)&&l)return u().command(()=>(s.setNodeMarkup(R.pos,y),!0)).command(()=>Kw(s,y)).command(()=>Zw(s,y)).run()}return!n||!P||!l?u().command(()=>d().wrapInList(y,i)?!0:c.clearNodes()).wrapInList(y,i).command(()=>Kw(s,y)).command(()=>Zw(s,y)).run():u().command(()=>{const O=d().wrapInList(y,i),B=P.filter(I=>v.includes(I.type.name));return s.ensureMarks(B),O?!0:c.clearNodes()}).wrapInList(y,i).command(()=>Kw(s,y)).command(()=>Zw(s,y)).run()},EW=(r,e={},n={})=>({state:i,commands:a})=>{const{extendEmptyMarkRange:s=!1}=n,o=ec(r,i.schema);return r_(i,o,e)?a.unsetMark(o,{extendEmptyMarkRange:s}):a.setMark(o,e)},NW=(r,e,n={})=>({state:i,commands:a})=>{const s=wi(r,i.schema),o=wi(e,i.schema),l=Nd(i,s,n);let u;return i.selection.$anchor.sameParent(i.selection.$head)&&(u=i.selection.$anchor.parent.attrs),l?a.setNode(o,u):a.setNode(s,{...u,...n})},TW=(r,e={})=>({state:n,commands:i})=>{const a=wi(r,n.schema);return Nd(n,a,e)?i.lift(a):i.wrapIn(a,e)},PW=()=>({state:r,dispatch:e})=>{const n=r.plugins;for(let i=0;i<n.length;i+=1){const a=n[i];let s;if(a.spec.isInputRules&&(s=a.getState(r))){if(e){const o=r.tr,l=s.transform;for(let u=l.steps.length-1;u>=0;u-=1)o.step(l.steps[u].invert(l.docs[u]));if(s.text){const u=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,r.schema.text(s.text,u))}else o.delete(s.from,s.to)}return!0}}return!1},MW=()=>({tr:r,dispatch:e})=>{const{selection:n}=r,{empty:i,ranges:a}=n;return i||e&&a.forEach(s=>{r.removeMark(s.$from.pos,s.$to.pos)}),!0},AW=(r,e={})=>({tr:n,state:i,dispatch:a})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:l}=n,u=ec(r,i.schema),{$from:c,empty:d,ranges:p}=l;if(!a)return!0;if(d&&o){let{from:v,to:y}=l;const b=(s=c.marks().find(k=>k.type===u))==null?void 0:s.attrs,S=ES(c,u,b);S&&(v=S.from,y=S.to),n.removeMark(v,y,u)}else p.forEach(v=>{n.removeMark(v.$from.pos,v.$to.pos,u)});return n.removeStoredMark(u),!0},jW=r=>({tr:e,state:n,dispatch:i})=>{const{selection:a}=n;let s,o;return typeof r=="number"?(s=r,o=r):r&&"from"in r&&"to"in r?(s=r.from,o=r.to):(s=a.from,o=a.to),i&&e.doc.nodesBetween(s,o,(l,u)=>{if(l.isText)return;const c={...l.attrs};delete c.dir,e.setNodeMarkup(u,void 0,c)}),!0},RW=(r,e={})=>({tr:n,state:i,dispatch:a})=>{let s=null,o=null;const l=Gx(typeof r=="string"?r:r.name,i.schema);if(!l)return!1;l==="node"&&(s=wi(r,i.schema)),l==="mark"&&(o=ec(r,i.schema));let u=!1;return n.selection.ranges.forEach(c=>{const d=c.$from.pos,p=c.$to.pos;let v,y,b,S;n.selection.empty?i.doc.nodesBetween(d,p,(k,T)=>{s&&s===k.type&&(u=!0,b=Math.max(T,d),S=Math.min(T+k.nodeSize,p),v=T,y=k)}):i.doc.nodesBetween(d,p,(k,T)=>{T<d&&s&&s===k.type&&(u=!0,b=Math.max(T,d),S=Math.min(T+k.nodeSize,p),v=T,y=k),T>=d&&T<=p&&(s&&s===k.type&&(u=!0,a&&n.setNodeMarkup(T,void 0,{...k.attrs,...e})),o&&k.marks.length&&k.marks.forEach(C=>{if(o===C.type&&(u=!0,a)){const N=Math.max(T,d),P=Math.min(T+k.nodeSize,p);n.addMark(N,P,o.create({...C.attrs,...e}))}}))}),y&&(v!==void 0&&a&&n.setNodeMarkup(v,void 0,{...y.attrs,...e}),o&&y.marks.length&&y.marks.forEach(k=>{o===k.type&&a&&n.addMark(b,S,o.create({...k.attrs,...e}))}))}),u},LW=(r,e={})=>({state:n,dispatch:i})=>{const a=wi(r,n.schema);return lH(a,e)(n,i)},OW=(r,e={})=>({state:n,dispatch:i})=>{const a=wi(r,n.schema);return uH(a,e)(n,i)},DW=class{constructor(){this.callbacks={}}on(r,e){return this.callbacks[r]||(this.callbacks[r]=[]),this.callbacks[r].push(e),this}emit(r,...e){const n=this.callbacks[r];return n&&n.forEach(i=>i.apply(this,e)),this}off(r,e){const n=this.callbacks[r];return n&&(e?this.callbacks[r]=n.filter(i=>i!==e):delete this.callbacks[r]),this}once(r,e){const n=(...i)=>{this.off(r,n),e.apply(this,i)};return this.on(r,n)}removeAllListeners(){this.callbacks={}}},$x=class{constructor(r){var e;this.find=r.find,this.handler=r.handler,this.undoable=(e=r.undoable)!=null?e:!0}},IW=(r,e)=>{if(CS(e))return e.exec(r);const n=e(r);if(!n)return null;const i=[n.text];return i.index=n.index,i.input=r,i.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),i.push(n.replaceWith)),i};function N0(r){var e;const{editor:n,from:i,to:a,text:s,rules:o,plugin:l}=r,{view:u}=n;if(u.composing)return!1;const c=u.state.doc.resolve(i);if(c.parent.type.spec.code||(e=c.nodeBefore||c.nodeAfter)!=null&&e.marks.find(v=>v.type.spec.code))return!1;let d=!1;const p=uW(c)+s;return o.forEach(v=>{if(d)return;const y=IW(p,v.find);if(!y)return;const b=u.state.tr,S=Ux({state:u.state,transaction:b}),k={from:i-(y[0].length-s.length),to:a},{commands:T,chain:C,can:N}=new Hx({editor:n,state:S});v.handler({state:S,range:k,match:y,commands:T,chain:C,can:N})===null||!b.steps.length||(v.undoable&&b.setMeta(l,{transform:b,from:i,to:a,text:s}),u.dispatch(b),d=!0)}),d}function BW(r){const{editor:e,rules:n}=r,i=new On({state:{init(){return null},apply(a,s,o){const l=a.getMeta(i);if(l)return l;const u=a.getMeta("applyInputRules");return u&&setTimeout(()=>{let{text:d}=u;typeof d=="string"?d=d:d=TS(Qe.from(d),o.schema);const{from:p}=u,v=p+d.length;N0({editor:e,from:p,to:v,text:d,rules:n,plugin:i})}),a.selectionSet||a.docChanged?null:s}},props:{handleTextInput(a,s,o,l){return N0({editor:e,from:s,to:o,text:l,rules:n,plugin:i})},handleDOMEvents:{compositionend:a=>(setTimeout(()=>{const{$cursor:s}=a.state.selection;s&&N0({editor:e,from:s.pos,to:s.pos,text:"",rules:n,plugin:i})}),!1)},handleKeyDown(a,s){if(s.key!=="Enter")return!1;const{$cursor:o}=a.state.selection;return o?N0({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:i}):!1}},isInputRules:!0});return i}function zW(r){return Object.prototype.toString.call(r).slice(8,-1)}function T0(r){return zW(r)!=="Object"?!1:r.constructor===Object&&Object.getPrototypeOf(r)===Object.prototype}function NA(r,e){const n={...r};return T0(r)&&T0(e)&&Object.keys(e).forEach(i=>{T0(e[i])&&T0(r[i])?n[i]=NA(r[i],e[i]):n[i]=e[i]}),n}var MS=class{constructor(r={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...r},this.name=this.config.name}get options(){return{...Gr(Ot(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Gr(Ot(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(r={}){const e=this.extend({...this.config,addOptions:()=>NA(this.options,r)});return e.name=this.name,e.parent=this.parent,e}extend(r={}){const e=new this.constructor({...this.config,...r});return e.parent=this,this.child=e,e.name="name"in r?r.name:e.parent.name,e}},Jh=class TA extends MS{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new TA(n)}static handleExit({editor:e,mark:n}){const{tr:i}=e.state,a=e.state.selection.$from;if(a.pos===a.end()){const o=a.marks();if(!!!o.find(c=>c?.type.name===n.name))return!1;const u=o.find(c=>c?.type.name===n.name);return u&&i.removeStoredMark(u),i.insertText(" ",a.pos),e.view.dispatch(i),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function FW(r){return typeof r=="number"}var VW=class{constructor(r){this.find=r.find,this.handler=r.handler}},UW=(r,e,n)=>{if(CS(e))return[...r.matchAll(e)];const i=e(r,n);return i?i.map(a=>{const s=[a.text];return s.index=a.index,s.input=r,s.data=a.data,a.replaceWith&&(a.text.includes(a.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(a.replaceWith)),s}):[]};function HW(r){const{editor:e,state:n,from:i,to:a,rule:s,pasteEvent:o,dropEvent:l}=r,{commands:u,chain:c,can:d}=new Hx({editor:e,state:n}),p=[];return n.doc.nodesBetween(i,a,(y,b)=>{var S,k,T,C,N;if((k=(S=y.type)==null?void 0:S.spec)!=null&&k.code||!(y.isText||y.isTextblock||y.isInline))return;const P=(N=(C=(T=y.content)==null?void 0:T.size)!=null?C:y.nodeSize)!=null?N:0,R=Math.max(i,b),O=Math.min(a,b+P);if(R>=O)return;const B=y.isText?y.text||"":y.textBetween(R-b,O-b,void 0,"");UW(B,s.find,o).forEach(z=>{if(z.index===void 0)return;const V=R+z.index+1,$=V+z[0].length,Y={from:n.tr.mapping.map(V),to:n.tr.mapping.map($)},D=s.handler({state:n,range:Y,match:z,commands:u,chain:c,can:d,pasteEvent:o,dropEvent:l});p.push(D)})}),p.every(y=>y!==null)}var P0=null,GW=r=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",r),n};function qW(r){const{editor:e,rules:n}=r;let i=null,a=!1,s=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const u=({state:d,from:p,to:v,rule:y,pasteEvt:b})=>{const S=d.tr,k=Ux({state:d,transaction:S});if(!(!HW({editor:e,state:k,from:Math.max(p-1,0),to:v.b-1,rule:y,pasteEvent:b,dropEvent:l})||!S.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,S}};return n.map(d=>new On({view(p){const v=b=>{var S;i=(S=p.dom.parentElement)!=null&&S.contains(b.target)?p.dom.parentElement:null,i&&(P0=e)},y=()=>{P0&&(P0=null)};return window.addEventListener("dragstart",v),window.addEventListener("dragend",y),{destroy(){window.removeEventListener("dragstart",v),window.removeEventListener("dragend",y)}}},props:{handleDOMEvents:{drop:(p,v)=>{if(s=i===p.dom.parentElement,l=v,!s){const y=P0;y?.isEditable&&setTimeout(()=>{const b=y.state.selection;b&&y.commands.deleteRange({from:b.from,to:b.to})},10)}return!1},paste:(p,v)=>{var y;const b=(y=v.clipboardData)==null?void 0:y.getData("text/html");return o=v,a=!!b?.includes("data-pm-slice"),!1}}},appendTransaction:(p,v,y)=>{const b=p[0],S=b.getMeta("uiEvent")==="paste"&&!a,k=b.getMeta("uiEvent")==="drop"&&!s,T=b.getMeta("applyPasteRules"),C=!!T;if(!S&&!k&&!C)return;if(C){let{text:R}=T;typeof R=="string"?R=R:R=TS(Qe.from(R),y.schema);const{from:O}=T,B=O+R.length,I=GW(R);return u({rule:d,state:y,from:O,to:{b:B},pasteEvt:I})}const N=v.doc.content.findDiffStart(y.doc.content),P=v.doc.content.findDiffEnd(y.doc.content);if(!(!FW(N)||!P||N===P.b))return u({rule:d,state:y,from:N,to:P,pasteEvt:o})}}))}var Kx=class{constructor(r,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=r,this.extensions=xA(r),this.schema=rW(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((r,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:E0(e.name,this.schema)},i=Ot(e,"addCommands",n);return i?{...r,...i()}:r},{})}get plugins(){const{editor:r}=this;return Ay([...this.extensions].reverse()).flatMap(i=>{const a={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:r,type:E0(i.name,this.schema)},s=[],o=Ot(i,"addKeyboardShortcuts",a);let l={};if(i.type==="mark"&&Ot(i,"exitable",a)&&(l.ArrowRight=()=>Jh.handleExit({editor:r,mark:i})),o){const v=Object.fromEntries(Object.entries(o()).map(([y,b])=>[y,()=>b({editor:r})]));l={...l,...v}}const u=aq(l);s.push(u);const c=Ot(i,"addInputRules",a);if(l3(i,r.options.enableInputRules)&&c){const v=c();if(v&&v.length){const y=BW({editor:r,rules:v}),b=Array.isArray(y)?y:[y];s.push(...b)}}const d=Ot(i,"addPasteRules",a);if(l3(i,r.options.enablePasteRules)&&d){const v=d();if(v&&v.length){const y=qW({editor:r,rules:v});s.push(...y)}}const p=Ot(i,"addProseMirrorPlugins",a);if(p){const v=p();s.push(...v)}return s})}get attributes(){return yA(this.extensions)}get nodeViews(){const{editor:r}=this,{nodeExtensions:e}=yp(this.extensions);return Object.fromEntries(e.filter(n=>!!Ot(n,"addNodeView")).map(n=>{const i=this.attributes.filter(u=>u.type===n.name),a={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:r,type:wi(n.name,this.schema)},s=Ot(n,"addNodeView",a);if(!s)return[];const o=s();if(!o)return[];const l=(u,c,d,p,v)=>{const y=Jg(u,i);return o({node:u,view:c,getPos:d,decorations:p,innerDecorations:v,editor:r,extension:n,HTMLAttributes:y})};return[n.name,l]}))}dispatchTransaction(r){const{editor:e}=this;return Ay([...this.extensions].reverse()).reduceRight((i,a)=>{const s={name:a.name,options:a.options,storage:this.editor.extensionStorage[a.name],editor:e,type:E0(a.name,this.schema)},o=Ot(a,"dispatchTransaction",s);return o?l=>{o.call(s,{transaction:l,next:i})}:i},r)}get markViews(){const{editor:r}=this,{markExtensions:e}=yp(this.extensions);return Object.fromEntries(e.filter(n=>!!Ot(n,"addMarkView")).map(n=>{const i=this.attributes.filter(l=>l.type===n.name),a={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:r,type:ec(n.name,this.schema)},s=Ot(n,"addMarkView",a);if(!s)return[];const o=(l,u,c)=>{const d=Jg(l,i);return s()({mark:l,view:u,inline:c,editor:r,extension:n,HTMLAttributes:d,updateAttributes:p=>{a$(l,r,p)}})};return[n.name,o]}))}setupExtensions(){const r=this.extensions;this.editor.extensionStorage=Object.fromEntries(r.map(e=>[e.name,e.storage])),r.forEach(e=>{var n;const i={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:E0(e.name,this.schema)};e.type==="mark"&&((n=Gr(Ot(e,"keepOnSplit",i)))==null||n)&&this.splittableMarks.push(e.name);const a=Ot(e,"onBeforeCreate",i),s=Ot(e,"onCreate",i),o=Ot(e,"onUpdate",i),l=Ot(e,"onSelectionUpdate",i),u=Ot(e,"onTransaction",i),c=Ot(e,"onFocus",i),d=Ot(e,"onBlur",i),p=Ot(e,"onDestroy",i);a&&this.editor.on("beforeCreate",a),s&&this.editor.on("create",s),o&&this.editor.on("update",o),l&&this.editor.on("selectionUpdate",l),u&&this.editor.on("transaction",u),c&&this.editor.on("focus",c),d&&this.editor.on("blur",d),p&&this.editor.on("destroy",p)})}};Kx.resolve=xA;Kx.sort=Ay;Kx.flatten=NS;var WW={};kS(WW,{ClipboardTextSerializer:()=>MA,Commands:()=>AA,Delete:()=>jA,Drop:()=>RA,Editable:()=>LA,FocusEvents:()=>DA,Keymap:()=>IA,Paste:()=>BA,Tabindex:()=>zA,TextDirection:()=>FA,focusEventsPluginKey:()=>OA});var ui=class PA extends MS{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new PA(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},MA=ui.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new On({key:new li("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:r}=this,{state:e,schema:n}=r,{doc:i,selection:a}=e,{ranges:s}=a,o=Math.min(...s.map(d=>d.$from.pos)),l=Math.max(...s.map(d=>d.$to.pos)),u=wA(n);return bA(i,{from:o,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:u})}}})]}}),AA=ui.create({name:"commands",addCommands(){return{...uA}}}),jA=ui.create({name:"delete",onUpdate({transaction:r,appendedTransactions:e}){var n,i,a;const s=()=>{var o,l,u,c;if((c=(u=(l=(o=this.editor.options.coreExtensionOptions)==null?void 0:o.delete)==null?void 0:l.filterTransaction)==null?void 0:u.call(l,r))!=null?c:r.getMeta("y-sync$"))return;const d=gA(r.before,[r,...e]);SA(d).forEach(y=>{d.mapping.mapResult(y.oldRange.from).deletedAfter&&d.mapping.mapResult(y.oldRange.to).deletedBefore&&d.before.nodesBetween(y.oldRange.from,y.oldRange.to,(b,S)=>{const k=S+b.nodeSize-2,T=y.oldRange.from<=S&&k<=y.oldRange.to;this.editor.emit("delete",{type:"node",node:b,from:S,to:k,newFrom:d.mapping.map(S),newTo:d.mapping.map(k),deletedRange:y.oldRange,newRange:y.newRange,partial:!T,editor:this.editor,transaction:r,combinedTransform:d})})});const v=d.mapping;d.steps.forEach((y,b)=>{var S,k;if(y instanceof cl){const T=v.slice(b).map(y.from,-1),C=v.slice(b).map(y.to),N=v.invert().map(T,-1),P=v.invert().map(C),R=(S=d.doc.nodeAt(T-1))==null?void 0:S.marks.some(B=>B.eq(y.mark)),O=(k=d.doc.nodeAt(C))==null?void 0:k.marks.some(B=>B.eq(y.mark));this.editor.emit("delete",{type:"mark",mark:y.mark,from:y.from,to:y.to,deletedRange:{from:N,to:P},newRange:{from:T,to:C},partial:!!(O||R),editor:this.editor,transaction:r,combinedTransform:d})}})};(a=(i=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:i.async)==null||a?setTimeout(s,0):s()}}),RA=ui.create({name:"drop",addProseMirrorPlugins(){return[new On({key:new li("tiptapDrop"),props:{handleDrop:(r,e,n,i)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:i})}}})]}}),LA=ui.create({name:"editable",addProseMirrorPlugins(){return[new On({key:new li("editable"),props:{editable:()=>this.editor.options.editable}})]}}),OA=new li("focusEvents"),DA=ui.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:r}=this;return[new On({key:OA,props:{handleDOMEvents:{focus:(e,n)=>{r.isFocused=!0;const i=r.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(i),!1},blur:(e,n)=>{r.isFocused=!1;const i=r.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(i),!1}}}})]}}),IA=ui.create({name:"keymap",addKeyboardShortcuts(){const r=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:u,doc:c}=l,{empty:d,$anchor:p}=u,{pos:v,parent:y}=p,b=p.parent.isTextblock&&v>0?l.doc.resolve(v-1):p,S=b.parent.type.spec.isolating,k=p.pos-p.parentOffset,T=S&&b.parent.childCount===1?k===p.pos:sr.atStart(c).from===v;return!d||!y.type.isTextblock||y.textContent.length||!T||T&&p.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),i={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:r,"Mod-Backspace":r,"Shift-Backspace":r,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},a={...i},s={...i,"Ctrl-h":r,"Alt-Backspace":r,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return My()||pA()?s:a},addProseMirrorPlugins(){return[new On({key:new li("clearDocument"),appendTransaction:(r,e,n)=>{if(r.some(S=>S.getMeta("composition")))return;const i=r.some(S=>S.docChanged)&&!e.doc.eq(n.doc),a=r.some(S=>S.getMeta("preventClearDocument"));if(!i||a)return;const{empty:s,from:o,to:l}=e.selection,u=sr.atStart(e.doc).from,c=sr.atEnd(e.doc).to;if(s||!(o===u&&l===c)||!Wx(n.doc))return;const v=n.tr,y=Ux({state:n,transaction:v}),{commands:b}=new Hx({editor:this.editor,state:y});if(b.clearNodes(),!!v.steps.length)return v}})]}}),BA=ui.create({name:"paste",addProseMirrorPlugins(){return[new On({key:new li("tiptapPaste"),props:{handlePaste:(r,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),zA=ui.create({name:"tabindex",addProseMirrorPlugins(){return[new On({key:new li("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),FA=ui.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:r}=yp(this.extensions);return[{types:r.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const n=e.getAttribute("dir");return n&&(n==="ltr"||n==="rtl"||n==="auto")?n:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new On({key:new li("textDirection"),props:{attributes:()=>{const r=this.options.direction;return r?{dir:r}:{}}}})]}}),$W=class Yf{constructor(e,n,i=!1,a=null){this.currentNode=null,this.actualDepth=null,this.isBlock=i,this.resolvedPos=e,this.editor=n,this.currentNode=a}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,i=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,i=this.to-1}this.editor.commands.insertContentAt({from:n,to:i},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new Yf(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Yf(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Yf(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,i)=>{const a=n.isBlock&&!n.isTextblock,s=n.isAtom&&!n.isText,o=this.pos+i+(s?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(o);if(!a&&l.depth<=this.depth)return;const u=new Yf(l,this.editor,a,a?n:null);a&&(u.actualDepth=this.depth+1),e.push(new Yf(l,this.editor,a,a?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let i=null,a=this.parent;for(;a&&!i;){if(a.node.type.name===e)if(Object.keys(n).length>0){const s=a.node.attrs,o=Object.keys(n);for(let l=0;l<o.length;l+=1){const u=o[l];if(s[u]!==n[u])break}}else i=a;a=a.parent}return i}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},i=!1){let a=[];if(!this.children||this.children.length===0)return a;const s=Object.keys(n);return this.children.forEach(o=>{i&&a.length>0||(o.node.type.name===e&&s.every(u=>n[u]===o.node.attrs[u])&&a.push(o),!(i&&a.length>0)&&(a=a.concat(o.querySelectorAll(e,n,i))))}),a}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},KW=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function ZW(r,e,n){const i=document.querySelector("style[data-tiptap-style]");if(i!==null)return i;const a=document.createElement("style");return e&&a.setAttribute("nonce",e),a.setAttribute("data-tiptap-style",""),a.innerHTML=r,document.getElementsByTagName("head")[0].appendChild(a),a}var YW=class extends DW{constructor(r={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:i})=>{throw i},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:fW,createMappablePosition:pW},this.setOptions(r),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:i,slice:a,moved:s})=>this.options.onDrop(i,a,s)),this.on("paste",({event:i,slice:a})=>this.options.onPaste(i,a)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=hA(e,this.options.autofocus);this.editorState=rp.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(r){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(r),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const r=this.editorView.dom;r?.editor&&delete r.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(r){console.warn("Failed to remove CSS element:",r)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=ZW(KW,this.options.injectNonce))}setOptions(r={}){this.options={...this.options,...r},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(r,e=!0){this.setOptions({editable:r}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:r=>{this.editorState=r},dispatch:r=>{this.dispatchTransaction(r)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(r,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in r)return Reflect.get(r,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(r,e){const n=vA(e)?e(r,[...this.state.plugins]):[...this.state.plugins,r],i=this.state.reconfigure({plugins:n});return this.view.updateState(i),i}unregisterPlugin(r){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(r).forEach(a=>{const s=typeof a=="string"?`${a}$`:a.key;n=n.filter(o=>!o.key.startsWith(s))}),e.length===n.length)return;const i=this.state.reconfigure({plugins:n});return this.view.updateState(i),i}createExtensionManager(){var r,e;const i=[...this.options.enableCoreExtensions?[LA,MA.configure({blockSeparator:(e=(r=this.options.coreExtensionOptions)==null?void 0:r.clipboardTextSerializer)==null?void 0:e.blockSeparator}),AA,DA,IA,zA,RA,BA,jA,FA.configure({direction:this.options.textDirection})].filter(a=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[a.name]!==!1:!0):[],...this.options.extensions].filter(a=>["extension","node","mark"].includes(a?.type));this.extensionManager=new Kx(i,this)}createCommandManager(){this.commandManager=new Hx({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let r;try{r=t_(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),r=t_(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return r}createView(r){const{editorProps:e,enableExtensionDispatchTransaction:n}=this.options,i=e.dispatchTransaction||this.dispatchTransaction.bind(this),a=n?this.extensionManager.dispatchTransaction(i):i;this.editorView=new oA(r,{...e,attributes:{role:"textbox",...e?.attributes},dispatchTransaction:a,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.prependClass(),this.injectCSS();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(r){this.isCapturingTransaction=!0,r(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(r){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=r;return}r.steps.forEach(c=>{var d;return(d=this.capturedTransaction)==null?void 0:d.step(c)});return}const{state:e,transactions:n}=this.state.applyTransaction(r),i=!this.state.selection.eq(e.selection),a=n.includes(r),s=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:r,nextState:e}),!a)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:r,appendedTransactions:n.slice(1)}),i&&this.emit("selectionUpdate",{editor:this,transaction:r});const o=n.findLast(c=>c.getMeta("focus")||c.getMeta("blur")),l=o?.getMeta("focus"),u=o?.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:o}),u&&this.emit("blur",{editor:this,event:u.event,transaction:o}),!(r.getMeta("preventUpdate")||!n.some(c=>c.docChanged)||s.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:r,appendedTransactions:n.slice(1)})}getAttributes(r){return _A(this.state,r)}isActive(r,e){const n=typeof r=="string"?r:null,i=typeof r=="string"?e:r;return cW(this.state,n,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return TS(this.state.doc.content,this.schema)}getText(r){const{blockSeparator:e=`

`,textSerializers:n={}}=r||{};return iW(this.state.doc,{blockSeparator:e,textSerializers:{...wA(this.schema),...n}})}get isEmpty(){return Wx(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var r,e;return(e=(r=this.editorView)==null?void 0:r.isDestroyed)!=null?e:!0}$node(r,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(r,e))||null}$nodes(r,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(r,e))||null}$pos(r){const e=this.state.doc.resolve(r);return new $W(e,this)}get $doc(){return this.$pos(0)}};function xp(r){return new $x({find:r.find,handler:({state:e,range:n,match:i})=>{const a=Gr(r.getAttributes,void 0,i);if(a===!1||a===null)return null;const{tr:s}=e,o=i[i.length-1],l=i[0];if(o){const u=l.search(/\S/),c=n.from+l.indexOf(o),d=c+o.length;if(PS(n.from,n.to,e.doc).filter(y=>y.mark.type.excluded.find(S=>S===r.type&&S!==y.mark.type)).filter(y=>y.to>c).length)return null;d<n.to&&s.delete(d,n.to),c>n.from&&s.delete(n.from+u,c);const v=n.from+u+o.length;s.addMark(n.from+u,v,r.type.create(a||{})),s.removeStoredMark(r.type)}},undoable:r.undoable})}function XW(r){return new $x({find:r.find,handler:({state:e,range:n,match:i})=>{const a=Gr(r.getAttributes,void 0,i)||{},{tr:s}=e,o=n.from;let l=n.to;const u=r.type.create(a);if(i[1]){const c=i[0].lastIndexOf(i[1]);let d=o+c;d>l?d=l:l=d+i[1].length;const p=i[0][i[0].length-1];s.insertText(p,o+i[0].length-1),s.replaceWith(d,l,u)}else if(i[0]){const c=r.type.isInline?o:o-1;s.insert(c,r.type.create(a)).delete(s.mapping.map(o),s.mapping.map(l))}s.scrollIntoView()},undoable:r.undoable})}function n_(r){return new $x({find:r.find,handler:({state:e,range:n,match:i})=>{const a=e.doc.resolve(n.from),s=Gr(r.getAttributes,void 0,i)||{};if(!a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),r.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,r.type,s)},undoable:r.undoable})}function bp(r){return new $x({find:r.find,handler:({state:e,range:n,match:i,chain:a})=>{const s=Gr(r.getAttributes,void 0,i)||{},o=e.tr.delete(n.from,n.to),u=o.doc.resolve(n.from).blockRange(),c=u&&lS(u,r.type,s);if(!c)return null;if(o.wrap(u,c),r.keepMarks&&r.editor){const{selection:p,storedMarks:v}=e,{splittableMarks:y}=r.editor.extensionManager,b=v||p.$to.parentOffset&&p.$from.marks();if(b){const S=b.filter(k=>y.includes(k.type.name));o.ensureMarks(S)}}if(r.keepAttributes){const p=r.type.name==="bulletList"||r.type.name==="orderedList"?"listItem":"taskList";a().updateAttributes(p,s).run()}const d=o.doc.resolve(n.from-1).nodeBefore;d&&d.type===r.type&&Od(o.doc,n.from-1)&&(!r.joinPredicate||r.joinPredicate(i,d))&&o.join(n.from-1)},undoable:r.undoable})}function QW(r,e){const{selection:n}=r,{$from:i}=n;if(n instanceof Bt){const s=i.index();return i.parent.canReplaceWith(s,s+1,e)}let a=i.depth;for(;a>=0;){const s=i.index(a);if(i.node(a).contentMatchAt(s).matchType(e))return!0;a-=1}return!1}function JW(r){return r.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var e$={};kS(e$,{createAtomBlockMarkdownSpec:()=>t$,createBlockMarkdownSpec:()=>r$,createInlineMarkdownSpec:()=>VA,parseAttributes:()=>AS,parseIndentedBlocks:()=>i_,renderNestedMarkdownContent:()=>RS,serializeAttributes:()=>jS});function AS(r){if(!r?.trim())return{};const e={},n=[],i=r.replace(/["']([^"']*)["']/g,c=>(n.push(c),`__QUOTED_${n.length-1}__`)),a=i.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(a){const c=a.map(d=>d.trim().slice(1));e.class=c.join(" ")}const s=i.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);s&&(e.id=s[1]);const o=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(i.matchAll(o)).forEach(([,c,d])=>{var p;const v=parseInt(((p=d.match(/__QUOTED_(\d+)__/))==null?void 0:p[1])||"0",10),y=n[v];y&&(e[c]=y.slice(1,-1))});const u=i.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return u&&u.split(/\s+/).filter(Boolean).forEach(d=>{d.match(/^[a-zA-Z][\w-]*$/)&&(e[d]=!0)}),e}function jS(r){if(!r||Object.keys(r).length===0)return"";const e=[];return r.class&&String(r.class).split(/\s+/).filter(Boolean).forEach(i=>e.push(`.${i}`)),r.id&&e.push(`#${r.id}`),Object.entries(r).forEach(([n,i])=>{n==="class"||n==="id"||(i===!0?e.push(n):i!==!1&&i!=null&&e.push(`${n}="${String(i)}"`))}),e.join(" ")}function t$(r){const{nodeName:e,name:n,parseAttributes:i=AS,serializeAttributes:a=jS,defaultAttributes:s={},requiredAttributes:o=[],allowedAttributes:l}=r,u=n||e,c=d=>{if(!l)return d;const p={};return l.forEach(v=>{v in d&&(p[v]=d[v])}),p};return{parseMarkdown:(d,p)=>{const v={...s,...d.attributes};return p.createNode(e,v,[])},markdownTokenizer:{name:e,level:"block",start(d){var p;const v=new RegExp(`^:::${u}(?:\\s|$)`,"m"),y=(p=d.match(v))==null?void 0:p.index;return y!==void 0?y:-1},tokenize(d,p,v){const y=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),b=d.match(y);if(!b)return;const S=b[1]||"",k=i(S);if(!o.find(C=>!(C in k)))return{type:e,raw:b[0],attributes:k}}},renderMarkdown:d=>{const p=c(d.attrs||{}),v=a(p),y=v?` {${v}}`:"";return`:::${u}${y} :::`}}}function r$(r){const{nodeName:e,name:n,getContent:i,parseAttributes:a=AS,serializeAttributes:s=jS,defaultAttributes:o={},content:l="block",allowedAttributes:u}=r,c=n||e,d=p=>{if(!u)return p;const v={};return u.forEach(y=>{y in p&&(v[y]=p[y])}),v};return{parseMarkdown:(p,v)=>{let y;if(i){const S=i(p);y=typeof S=="string"?[{type:"text",text:S}]:S}else l==="block"?y=v.parseChildren(p.tokens||[]):y=v.parseInline(p.tokens||[]);const b={...o,...p.attributes};return v.createNode(e,b,y)},markdownTokenizer:{name:e,level:"block",start(p){var v;const y=new RegExp(`^:::${c}`,"m"),b=(v=p.match(y))==null?void 0:v.index;return b!==void 0?b:-1},tokenize(p,v,y){var b;const S=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),k=p.match(S);if(!k)return;const[T,C=""]=k,N=a(C);let P=1;const R=T.length;let O="";const B=/^:::([\w-]*)(\s.*)?/gm,I=p.slice(R);for(B.lastIndex=0;;){const z=B.exec(I);if(z===null)break;const V=z.index,$=z[1];if(!((b=z[2])!=null&&b.endsWith(":::"))){if($)P+=1;else if(P-=1,P===0){const Y=I.slice(0,V);O=Y.trim();const D=p.slice(0,R+V+z[0].length);let q=[];if(O)if(l==="block")for(q=y.blockTokens(Y),q.forEach(G=>{G.text&&(!G.tokens||G.tokens.length===0)&&(G.tokens=y.inlineTokens(G.text))});q.length>0;){const G=q[q.length-1];if(G.type==="paragraph"&&(!G.text||G.text.trim()===""))q.pop();else break}else q=y.inlineTokens(O);return{type:e,raw:D,attributes:N,content:O,tokens:q}}}}}},renderMarkdown:(p,v)=>{const y=d(p.attrs||{}),b=s(y),S=b?` {${b}}`:"",k=v.renderChildren(p.content||[],`

`);return`:::${c}${S}

${k}

:::`}}}function n$(r){if(!r.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let i=n.exec(r);for(;i!==null;){const[,a,s,o]=i;e[a]=s||o,i=n.exec(r)}return e}function i$(r){return Object.entries(r).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function VA(r){const{nodeName:e,name:n,getContent:i,parseAttributes:a=n$,serializeAttributes:s=i$,defaultAttributes:o={},selfClosing:l=!1,allowedAttributes:u}=r,c=n||e,d=v=>{if(!u)return v;const y={};return u.forEach(b=>{const S=typeof b=="string"?b:b.name,k=typeof b=="string"?void 0:b.skipIfDefault;if(S in v){const T=v[S];if(k!==void 0&&T===k)return;y[S]=T}}),y},p=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(v,y)=>{const b={...o,...v.attributes};if(l)return y.createNode(e,b);const S=i?i(v):v.content||"";return S?y.createNode(e,b,[y.createTextNode(S)]):y.createNode(e,b,[])},markdownTokenizer:{name:e,level:"inline",start(v){const y=l?new RegExp(`\\[${p}\\s*[^\\]]*\\]`):new RegExp(`\\[${p}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${p}\\]`),b=v.match(y),S=b?.index;return S!==void 0?S:-1},tokenize(v,y,b){const S=l?new RegExp(`^\\[${p}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${p}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${p}\\]`),k=v.match(S);if(!k)return;let T="",C="";if(l){const[,P]=k;C=P}else{const[,P,R]=k;C=P,T=R||""}const N=a(C.trim());return{type:e,raw:k[0],content:T.trim(),attributes:N}}},renderMarkdown:v=>{let y="";i?y=i(v):v.content&&v.content.length>0&&(y=v.content.filter(T=>T.type==="text").map(T=>T.text).join(""));const b=d(v.attrs||{}),S=s(b),k=S?` ${S}`:"";return l?`[${c}${k}]`:`[${c}${k}]${y}[/${c}]`}}}function i_(r,e,n){var i,a,s,o;const l=r.split(`
`),u=[];let c="",d=0;const p=e.baseIndentSize||2;for(;d<l.length;){const v=l[d],y=v.match(e.itemPattern);if(!y){if(u.length>0)break;if(v.trim()===""){d+=1,c=`${c}${v}
`;continue}else return}const b=e.extractItemData(y),{indentLevel:S,mainContent:k}=b;c=`${c}${v}
`;const T=[k];for(d+=1;d<l.length;){const R=l[d];if(R.trim()===""){const B=l.slice(d+1).findIndex(V=>V.trim()!=="");if(B===-1)break;if((((a=(i=l[d+1+B].match(/^(\s*)/))==null?void 0:i[1])==null?void 0:a.length)||0)>S){T.push(R),c=`${c}${R}
`,d+=1;continue}else break}if((((o=(s=R.match(/^(\s*)/))==null?void 0:s[1])==null?void 0:o.length)||0)>S)T.push(R),c=`${c}${R}
`,d+=1;else break}let C;const N=T.slice(1);if(N.length>0){const R=N.map(O=>O.slice(S+p)).join(`
`);R.trim()&&(e.customNestedParser?C=e.customNestedParser(R):C=n.blockTokens(R))}const P=e.createToken(b,C);u.push(P)}if(u.length!==0)return{items:u,raw:c}}function RS(r,e,n,i){if(!r||!Array.isArray(r.content))return"";const a=typeof n=="function"?n(i):n,[s,...o]=r.content,l=e.renderChildren([s]),u=[`${a}${l}`];return o&&o.length>0&&o.forEach(c=>{const d=e.renderChildren([c]);if(d){const p=d.split(`
`).map(v=>v?e.indent(v):"").join(`
`);u.push(p)}}),u.join(`
`)}function a$(r,e,n={}){const{state:i}=e,{doc:a,tr:s}=i,o=r;a.descendants((l,u)=>{const c=s.mapping.map(u),d=s.mapping.map(u)+l.nodeSize;let p=null;if(l.marks.forEach(y=>{if(y!==o)return!1;p=y}),!p)return;let v=!1;if(Object.keys(n).forEach(y=>{n[y]!==p.attrs[y]&&(v=!0)}),v){const y=r.type.create({...r.attrs,...n});s.removeMark(c,d,r.type),s.addMark(c,d,y)}}),s.docChanged&&e.view.dispatch(s)}var Ds=class UA extends MS{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new UA(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function Wh(r){return new VW({find:r.find,handler:({state:e,range:n,match:i,pasteEvent:a})=>{const s=Gr(r.getAttributes,void 0,i,a);if(s===!1||s===null)return null;const{tr:o}=e,l=i[i.length-1],u=i[0];let c=n.to;if(l){const d=u.search(/\S/),p=n.from+u.indexOf(l),v=p+l.length;if(PS(n.from,n.to,e.doc).filter(b=>b.mark.type.excluded.find(k=>k===r.type&&k!==b.mark.type)).filter(b=>b.to>p).length)return null;v<n.to&&o.delete(v,n.to),p>n.from&&o.delete(n.from+d,p),c=n.from+d+l.length,o.addMark(n.from+d,c,r.type.create(s||{})),o.removeStoredMark(r.type)}}})}const{getOwnPropertyNames:s$,getOwnPropertySymbols:o$}=Object,{hasOwnProperty:l$}=Object.prototype;function Yw(r,e){return function(i,a,s){return r(i,a,s)&&e(i,a,s)}}function M0(r){return function(n,i,a){if(!n||!i||typeof n!="object"||typeof i!="object")return r(n,i,a);const{cache:s}=a,o=s.get(n),l=s.get(i);if(o&&l)return o===i&&l===n;s.set(n,i),s.set(i,n);const u=r(n,i,a);return s.delete(n),s.delete(i),u}}function u$(r){return r?.[Symbol.toStringTag]}function d3(r){return s$(r).concat(o$(r))}const c$=Object.hasOwn||((r,e)=>l$.call(r,e));function ef(r,e){return r===e||!r&&!e&&r!==r&&e!==e}const d$="__v",h$="__o",f$="_owner",{getOwnPropertyDescriptor:h3,keys:f3}=Object;function p$(r,e){return r.byteLength===e.byteLength&&jy(new Uint8Array(r),new Uint8Array(e))}function m$(r,e,n){let i=r.length;if(e.length!==i)return!1;for(;i-- >0;)if(!n.equals(r[i],e[i],i,i,r,e,n))return!1;return!0}function g$(r,e){return r.byteLength===e.byteLength&&jy(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function v$(r,e){return ef(r.getTime(),e.getTime())}function y$(r,e){return r.name===e.name&&r.message===e.message&&r.cause===e.cause&&r.stack===e.stack}function x$(r,e){return r===e}function p3(r,e,n){const i=r.size;if(i!==e.size)return!1;if(!i)return!0;const a=new Array(i),s=r.entries();let o,l,u=0;for(;(o=s.next())&&!o.done;){const c=e.entries();let d=!1,p=0;for(;(l=c.next())&&!l.done;){if(a[p]){p++;continue}const v=o.value,y=l.value;if(n.equals(v[0],y[0],u,p,r,e,n)&&n.equals(v[1],y[1],v[0],y[0],r,e,n)){d=a[p]=!0;break}p++}if(!d)return!1;u++}return!0}const b$=ef;function w$(r,e,n){const i=f3(r);let a=i.length;if(f3(e).length!==a)return!1;for(;a-- >0;)if(!HA(r,e,n,i[a]))return!1;return!0}function ng(r,e,n){const i=d3(r);let a=i.length;if(d3(e).length!==a)return!1;let s,o,l;for(;a-- >0;)if(s=i[a],!HA(r,e,n,s)||(o=h3(r,s),l=h3(e,s),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function _$(r,e){return ef(r.valueOf(),e.valueOf())}function S$(r,e){return r.source===e.source&&r.flags===e.flags}function m3(r,e,n){const i=r.size;if(i!==e.size)return!1;if(!i)return!0;const a=new Array(i),s=r.values();let o,l;for(;(o=s.next())&&!o.done;){const u=e.values();let c=!1,d=0;for(;(l=u.next())&&!l.done;){if(!a[d]&&n.equals(o.value,l.value,o.value,l.value,r,e,n)){c=a[d]=!0;break}d++}if(!c)return!1}return!0}function jy(r,e){let n=r.byteLength;if(e.byteLength!==n||r.byteOffset!==e.byteOffset)return!1;for(;n-- >0;)if(r[n]!==e[n])return!1;return!0}function k$(r,e){return r.hostname===e.hostname&&r.pathname===e.pathname&&r.protocol===e.protocol&&r.port===e.port&&r.hash===e.hash&&r.username===e.username&&r.password===e.password}function HA(r,e,n,i){return(i===f$||i===h$||i===d$)&&(r.$$typeof||e.$$typeof)?!0:c$(e,i)&&n.equals(r[i],e[i],i,i,r,e,n)}const C$="[object ArrayBuffer]",E$="[object Arguments]",N$="[object Boolean]",T$="[object DataView]",P$="[object Date]",M$="[object Error]",A$="[object Map]",j$="[object Number]",R$="[object Object]",L$="[object RegExp]",O$="[object Set]",D$="[object String]",I$={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},B$="[object URL]",z$=Object.prototype.toString;function F$({areArrayBuffersEqual:r,areArraysEqual:e,areDataViewsEqual:n,areDatesEqual:i,areErrorsEqual:a,areFunctionsEqual:s,areMapsEqual:o,areNumbersEqual:l,areObjectsEqual:u,arePrimitiveWrappersEqual:c,areRegExpsEqual:d,areSetsEqual:p,areTypedArraysEqual:v,areUrlsEqual:y,unknownTagComparators:b}){return function(k,T,C){if(k===T)return!0;if(k==null||T==null)return!1;const N=typeof k;if(N!==typeof T)return!1;if(N!=="object")return N==="number"?l(k,T,C):N==="function"?s(k,T,C):!1;const P=k.constructor;if(P!==T.constructor)return!1;if(P===Object)return u(k,T,C);if(Array.isArray(k))return e(k,T,C);if(P===Date)return i(k,T,C);if(P===RegExp)return d(k,T,C);if(P===Map)return o(k,T,C);if(P===Set)return p(k,T,C);const R=z$.call(k);if(R===P$)return i(k,T,C);if(R===L$)return d(k,T,C);if(R===A$)return o(k,T,C);if(R===O$)return p(k,T,C);if(R===R$)return typeof k.then!="function"&&typeof T.then!="function"&&u(k,T,C);if(R===B$)return y(k,T,C);if(R===M$)return a(k,T,C);if(R===E$)return u(k,T,C);if(I$[R])return v(k,T,C);if(R===C$)return r(k,T,C);if(R===T$)return n(k,T,C);if(R===N$||R===j$||R===D$)return c(k,T,C);if(b){let O=b[R];if(!O){const B=u$(k);B&&(O=b[B])}if(O)return O(k,T,C)}return!1}}function V$({circular:r,createCustomConfig:e,strict:n}){let i={areArrayBuffersEqual:p$,areArraysEqual:n?ng:m$,areDataViewsEqual:g$,areDatesEqual:v$,areErrorsEqual:y$,areFunctionsEqual:x$,areMapsEqual:n?Yw(p3,ng):p3,areNumbersEqual:b$,areObjectsEqual:n?ng:w$,arePrimitiveWrappersEqual:_$,areRegExpsEqual:S$,areSetsEqual:n?Yw(m3,ng):m3,areTypedArraysEqual:n?Yw(jy,ng):jy,areUrlsEqual:k$,unknownTagComparators:void 0};if(e&&(i=Object.assign({},i,e(i))),r){const a=M0(i.areArraysEqual),s=M0(i.areMapsEqual),o=M0(i.areObjectsEqual),l=M0(i.areSetsEqual);i=Object.assign({},i,{areArraysEqual:a,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:l})}return i}function U$(r){return function(e,n,i,a,s,o,l){return r(e,n,l)}}function H$({circular:r,comparator:e,createState:n,equals:i,strict:a}){if(n)return function(l,u){const{cache:c=r?new WeakMap:void 0,meta:d}=n();return e(l,u,{cache:c,equals:i,meta:d,strict:a})};if(r)return function(l,u){return e(l,u,{cache:new WeakMap,equals:i,meta:void 0,strict:a})};const s={cache:void 0,equals:i,meta:void 0,strict:a};return function(l,u){return e(l,u,s)}}const G$=Id();Id({strict:!0});Id({circular:!0});Id({circular:!0,strict:!0});Id({createInternalComparator:()=>ef});Id({strict:!0,createInternalComparator:()=>ef});Id({circular:!0,createInternalComparator:()=>ef});Id({circular:!0,createInternalComparator:()=>ef,strict:!0});function Id(r={}){const{circular:e=!1,createInternalComparator:n,createState:i,strict:a=!1}=r,s=V$(r),o=F$(s),l=n?n(o):U$(o);return H$({circular:e,comparator:o,createState:i,equals:l,strict:a})}var Xw={exports:{}},Qw={};var g3;function q$(){if(g3)return Qw;g3=1;var r=Cp(),e=RM();function n(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var i=typeof Object.is=="function"?Object.is:n,a=e.useSyncExternalStore,s=r.useRef,o=r.useEffect,l=r.useMemo,u=r.useDebugValue;return Qw.useSyncExternalStoreWithSelector=function(c,d,p,v,y){var b=s(null);if(b.current===null){var S={hasValue:!1,value:null};b.current=S}else S=b.current;b=l(function(){function T(O){if(!C){if(C=!0,N=O,O=v(O),y!==void 0&&S.hasValue){var B=S.value;if(y(B,O))return P=B}return P=O}if(B=P,i(N,O))return B;var I=v(O);return y!==void 0&&y(B,I)?(N=O,B):(N=O,P=I)}var C=!1,N,P,R=p===void 0?null:p;return[function(){return T(d())},R===null?void 0:function(){return T(R())}]},[d,p,v,y]);var k=a(c,b[0],b[1]);return o(function(){S.hasValue=!0,S.value=k},[k]),u(k),k},Qw}var v3;function W$(){return v3||(v3=1,Xw.exports=q$()),Xw.exports}var $$=W$(),K$=(...r)=>e=>{r.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},Z$=({contentComponent:r})=>{const e=LM.useSyncExternalStore(r.subscribe,r.getSnapshot,r.getServerSnapshot);return m.jsx(m.Fragment,{children:Object.values(e)})};function Y$(){const r=new Set;let e={};return{subscribe(n){return r.add(n),()=>{r.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,i){e={...e,[n]:fR.createPortal(i.reactElement,i.element,n)},r.forEach(a=>a())},removeRenderer(n){const i={...e};delete i[n],e=i,r.forEach(a=>a())}}}var X$=class extends Xt.Component{constructor(r){var e;super(r),this.editorContentRef=Xt.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=r.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var r;const e=this.props.editor;if(e&&!e.isDestroyed&&((r=e.view.dom)!=null&&r.parentNode)){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n}),e.contentComponent=Y$(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(i=>i.hasContentComponentInitialized?i:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var r;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((r=e.view.dom)!=null&&r.parentNode))return;const n=document.createElement("div");n.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:n})}catch{}}}render(){const{editor:r,innerRef:e,...n}=this.props;return m.jsxs(m.Fragment,{children:[m.jsx("div",{ref:K$(e,this.editorContentRef),...n}),r?.contentComponent&&m.jsx(Z$,{contentComponent:r.contentComponent})]})}},Q$=ce.forwardRef((r,e)=>{const n=Xt.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[r.editor]);return Xt.createElement(X$,{key:n,innerRef:e,...r})}),J$=Xt.memo(Q$),eK=typeof window<"u"?ce.useLayoutEffect:ce.useEffect,tK=class{constructor(r){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=r,this.lastSnapshot={editor:r,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(r){return this.subscribers.add(r),()=>{this.subscribers.delete(r)}}watch(r){if(this.editor=r,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function rK(r){var e;const[n]=ce.useState(()=>new tK(r.editor)),i=$$.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,r.selector,(e=r.equalityFn)!=null?e:G$);return eK(()=>n.watch(r.editor),[r.editor,n]),ce.useDebugValue(i),i}var nK=!1,a_=typeof window>"u",iK=a_||!!(typeof window<"u"&&window.next),aK=class GA{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?a_||iK?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...i)=>{var a,s;return(s=(a=this.options.current).onBeforeCreate)==null?void 0:s.call(a,...i)},onBlur:(...i)=>{var a,s;return(s=(a=this.options.current).onBlur)==null?void 0:s.call(a,...i)},onCreate:(...i)=>{var a,s;return(s=(a=this.options.current).onCreate)==null?void 0:s.call(a,...i)},onDestroy:(...i)=>{var a,s;return(s=(a=this.options.current).onDestroy)==null?void 0:s.call(a,...i)},onFocus:(...i)=>{var a,s;return(s=(a=this.options.current).onFocus)==null?void 0:s.call(a,...i)},onSelectionUpdate:(...i)=>{var a,s;return(s=(a=this.options.current).onSelectionUpdate)==null?void 0:s.call(a,...i)},onTransaction:(...i)=>{var a,s;return(s=(a=this.options.current).onTransaction)==null?void 0:s.call(a,...i)},onUpdate:(...i)=>{var a,s;return(s=(a=this.options.current).onUpdate)==null?void 0:s.call(a,...i)},onContentError:(...i)=>{var a,s;return(s=(a=this.options.current).onContentError)==null?void 0:s.call(a,...i)},onDrop:(...i)=>{var a,s;return(s=(a=this.options.current).onDrop)==null?void 0:s.call(a,...i)},onPaste:(...i)=>{var a,s;return(s=(a=this.options.current).onPaste)==null?void 0:s.call(a,...i)},onDelete:(...i)=>{var a,s;return(s=(a=this.options.current).onDelete)==null?void 0:s.call(a,...i)}};return new YW(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(i=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(i)?!0:i==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((a,s)=>{var o;return a===((o=n.extensions)==null?void 0:o[s])}):e[i]===n[i])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?GA.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((i,a)=>i===e[a]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function sK(r={},e=[]){const n=ce.useRef(r);n.current=r;const[i]=ce.useState(()=>new aK(n)),a=LM.useSyncExternalStore(i.subscribe,i.getEditor,i.getServerSnapshot);return ce.useDebugValue(a),ce.useEffect(i.onRender(e)),rK({editor:a,selector:({transactionNumber:s})=>r.shouldRerenderOnTransaction===!1||r.shouldRerenderOnTransaction===void 0?null:r.immediatelyRender&&s===0?0:s+1}),a}var oK=ce.createContext({editor:null});oK.Consumer;var lK=ce.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),uK=()=>ce.useContext(lK);Xt.forwardRef((r,e)=>{const{onDragStart:n}=uK(),i=r.as||"div";return m.jsx(i,{...r,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...r.style}})});function y3(r){return!!(typeof r=="function"&&r.prototype&&r.prototype.isReactComponent)}function x3(r){return!!(typeof r=="object"&&r.$$typeof&&(r.$$typeof.toString()==="Symbol(react.forward_ref)"||r.$$typeof.description==="react.forward_ref"))}function cK(r){return!!(typeof r=="object"&&r.$$typeof&&(r.$$typeof.toString()==="Symbol(react.memo)"||r.$$typeof.description==="react.memo"))}function dK(r){if(y3(r)||x3(r))return!0;if(cK(r)){const e=r.type;if(e)return y3(e)||x3(e)}return!1}function hK(){try{if(ce.version)return parseInt(ce.version.split(".")[0],10)>=19}catch{}return!1}var fK=class{constructor(r,{editor:e,props:n={},as:i="div",className:a=""}){this.ref=null,this.destroyed=!1,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=r,this.editor=e,this.props=n,this.element=document.createElement(i),this.element.classList.add("react-renderer"),a&&this.element.classList.add(...a.split(" ")),this.editor.isInitialized?iu.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.destroyed||this.render()})}render(){var r;if(this.destroyed)return;const e=this.component,n=this.props,i=this.editor,a=hK(),s=dK(e),o={...n};o.ref&&!(a||s)&&delete o.ref,!o.ref&&(a||s)&&(o.ref=l=>{this.ref=l}),this.reactElement=m.jsx(e,{...o}),(r=i?.contentComponent)==null||r.setRenderer(this.id,this)}updateProps(r={}){this.destroyed||(this.props={...this.props,...r},this.render())}destroy(){var r;this.destroyed=!0;const e=this.editor;(r=e?.contentComponent)==null||r.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(r){Object.keys(r).forEach(e=>{this.element.setAttribute(e,r[e])})}};Xt.createContext({markViewContentRef:()=>{}});var Ry=(r,e)=>{if(r==="slot")return 0;if(r instanceof Function)return r(e);const{children:n,...i}=e??{};if(r==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[r,i,n]},pK=/^\s*>\s$/,mK=Ds.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:r}){return Ry("blockquote",{...Ln(this.options.HTMLAttributes,r),children:Ry("slot",{})})},parseMarkdown:(r,e)=>e.createNode("blockquote",void 0,e.parseChildren(r.tokens||[])),renderMarkdown:(r,e)=>{if(!r.content)return"";const n=">",i=[];return r.content.forEach(a=>{const l=e.renderChildren([a]).split(`
`).map(u=>u.trim()===""?n:`${n} ${u}`);i.push(l.join(`
`))}),i.join(`
${n}
`)},addCommands(){return{setBlockquote:()=>({commands:r})=>r.wrapIn(this.name),toggleBlockquote:()=>({commands:r})=>r.toggleWrap(this.name),unsetBlockquote:()=>({commands:r})=>r.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[bp({find:pK,type:this.type})]}}),gK=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,vK=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,yK=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,xK=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,bK=Jh.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:r=>r.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:r=>r.type.name===this.name},{style:"font-weight",getAttrs:r=>/^(bold(er)?|[5-9]\d{2,})$/.test(r)&&null}]},renderHTML({HTMLAttributes:r}){return Ry("strong",{...Ln(this.options.HTMLAttributes,r),children:Ry("slot",{})})},markdownTokenName:"strong",parseMarkdown:(r,e)=>e.applyMark("bold",e.parseInline(r.tokens||[])),renderMarkdown:(r,e)=>`**${e.renderChildren(r)}**`,addCommands(){return{setBold:()=>({commands:r})=>r.setMark(this.name),toggleBold:()=>({commands:r})=>r.toggleMark(this.name),unsetBold:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[xp({find:gK,type:this.type}),xp({find:yK,type:this.type})]},addPasteRules(){return[Wh({find:vK,type:this.type}),Wh({find:xK,type:this.type})]}}),wK=/(^|[^`])`([^`]+)`(?!`)$/,_K=/(^|[^`])`([^`]+)`(?!`)/g,SK=Jh.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:r}){return["code",Ln(this.options.HTMLAttributes,r),0]},markdownTokenName:"codespan",parseMarkdown:(r,e)=>e.applyMark("code",[{type:"text",text:r.text||""}]),renderMarkdown:(r,e)=>r.content?`\`${e.renderChildren(r.content)}\``:"",addCommands(){return{setCode:()=>({commands:r})=>r.setMark(this.name),toggleCode:()=>({commands:r})=>r.toggleMark(this.name),unsetCode:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[xp({find:wK,type:this.type})]},addPasteRules(){return[Wh({find:_K,type:this.type})]}}),Jw=4,kK=/^```([a-z]+)?[\s\n]$/,CK=/^~~~([a-z]+)?[\s\n]$/,EK=Ds.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Jw,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:r=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const s=[...((e=r.firstElementChild)==null?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:r,HTMLAttributes:e}){return["pre",Ln(this.options.HTMLAttributes,e),["code",{class:r.attrs.language?this.options.languageClassPrefix+r.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(r,e)=>{var n;return((n=r.raw)==null?void 0:n.startsWith("```"))===!1&&r.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:r.lang||null},r.text?[e.createTextNode(r.text)]:[])},renderMarkdown:(r,e)=>{var n;let i="";const a=((n=r.attrs)==null?void 0:n.language)||"";return r.content?i=[`\`\`\`${a}`,e.renderChildren(r.content),"```"].join(`
`):i=`\`\`\`${a}

\`\`\``,i},addCommands(){return{setCodeBlock:r=>({commands:e})=>e.setNode(this.name,r),toggleCodeBlock:r=>({commands:e})=>e.toggleNode(this.name,"paragraph",r)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:r,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!r||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:r})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:Jw,{state:i}=r,{selection:a}=i,{$from:s,empty:o}=a;if(s.parent.type!==this.type)return!1;const l=" ".repeat(n);return o?r.commands.insertContent(l):r.commands.command(({tr:u})=>{const{from:c,to:d}=a,y=i.doc.textBetween(c,d,`
`,`
`).split(`
`).map(b=>l+b).join(`
`);return u.replaceWith(c,d,i.schema.text(y)),!0})},"Shift-Tab":({editor:r})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:Jw,{state:i}=r,{selection:a}=i,{$from:s,empty:o}=a;return s.parent.type!==this.type?!1:o?r.commands.command(({tr:l})=>{var u;const{pos:c}=s,d=s.start(),p=s.end(),y=i.doc.textBetween(d,p,`
`,`
`).split(`
`);let b=0,S=0;const k=c-d;for(let O=0;O<y.length;O+=1){if(S+y[O].length>=k){b=O;break}S+=y[O].length+1}const C=((u=y[b].match(/^ */))==null?void 0:u[0])||"",N=Math.min(C.length,n);if(N===0)return!0;let P=d;for(let O=0;O<b;O+=1)P+=y[O].length+1;return l.delete(P,P+N),c-P<=N&&l.setSelection(Qt.create(l.doc,P)),!0}):r.commands.command(({tr:l})=>{const{from:u,to:c}=a,v=i.doc.textBetween(u,c,`
`,`
`).split(`
`).map(y=>{var b;const S=((b=y.match(/^ */))==null?void 0:b[0])||"",k=Math.min(S.length,n);return y.slice(k)}).join(`
`);return l.replaceWith(u,c,i.schema.text(v)),!0})},Enter:({editor:r})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=r,{selection:n}=e,{$from:i,empty:a}=n;if(!a||i.parent.type!==this.type)return!1;const s=i.parentOffset===i.parent.nodeSize-2,o=i.parent.textContent.endsWith(`

`);return!s||!o?!1:r.chain().command(({tr:l})=>(l.delete(i.pos-2,i.pos),!0)).exitCode().run()},ArrowDown:({editor:r})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=r,{selection:n,doc:i}=e,{$from:a,empty:s}=n;if(!s||a.parent.type!==this.type||!(a.parentOffset===a.parent.nodeSize-2))return!1;const l=a.after();return l===void 0?!1:i.nodeAt(l)?r.commands.command(({tr:c})=>(c.setSelection(sr.near(i.resolve(l))),!0)):r.commands.exitCode()}}},addInputRules(){return[n_({find:kK,type:this.type,getAttributes:r=>({language:r[1]})}),n_({find:CK,type:this.type,getAttributes:r=>({language:r[1]})})]},addProseMirrorPlugins(){return[new On({key:new li("codeBlockVSCodeHandler"),props:{handlePaste:(r,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),i=e.clipboardData.getData("vscode-editor-data"),a=i?JSON.parse(i):void 0,s=a?.mode;if(!n||!s)return!1;const{tr:o,schema:l}=r.state,u=l.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:s},u)),o.selection.$from.parent.type!==this.type&&o.setSelection(Qt.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),r.dispatch(o),!0}}})]}}),NK=Ds.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(r,e)=>r.content?e.renderChildren(r.content,`

`):""}),TK=Ds.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:r}){return["br",Ln(this.options.HTMLAttributes,r)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:r,chain:e,state:n,editor:i})=>r.first([()=>r.exitCode(),()=>r.command(()=>{const{selection:a,storedMarks:s}=n;if(a.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=i.extensionManager,u=s||a.$to.parentOffset&&a.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:d})=>{if(d&&u&&o){const p=u.filter(v=>l.includes(v.type.name));c.ensureMarks(p)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),PK=Ds.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(r=>({tag:`h${r}`,attrs:{level:r}}))},renderHTML({node:r,HTMLAttributes:e}){return[`h${this.options.levels.includes(r.attrs.level)?r.attrs.level:this.options.levels[0]}`,Ln(this.options.HTMLAttributes,e),0]},parseMarkdown:(r,e)=>e.createNode("heading",{level:r.depth||1},e.parseInline(r.tokens||[])),renderMarkdown:(r,e)=>{var n;const i=(n=r.attrs)!=null&&n.level?parseInt(r.attrs.level,10):1,a="#".repeat(i);return r.content?`${a} ${e.renderChildren(r.content)}`:""},addCommands(){return{setHeading:r=>({commands:e})=>this.options.levels.includes(r.level)?e.setNode(this.name,r):!1,toggleHeading:r=>({commands:e})=>this.options.levels.includes(r.level)?e.toggleNode(this.name,"paragraph",r):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((r,e)=>({...r,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(r=>n_({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${r}})\\s$`),type:this.type,getAttributes:{level:r}}))}}),MK=Ds.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:r}){return["hr",Ln(this.options.HTMLAttributes,r)]},markdownTokenName:"hr",parseMarkdown:(r,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:r,state:e})=>{if(!QW(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:i}=n,a=r();return kA(n)?a.insertContentAt(i.pos,{type:this.name}):a.insertContent({type:this.name}),a.command(({state:s,tr:o,dispatch:l})=>{if(l){const{$to:u}=o.selection,c=u.end();if(u.nodeAfter)u.nodeAfter.isTextblock?o.setSelection(Qt.create(o.doc,u.pos+1)):u.nodeAfter.isBlock?o.setSelection(Bt.create(o.doc,u.pos)):o.setSelection(Qt.create(o.doc,u.pos));else{const d=s.schema.nodes[this.options.nextNodeType]||u.parent.type.contentMatch.defaultType,p=d?.create();p&&(o.insert(c,p),o.setSelection(Qt.create(o.doc,c+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[XW({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),AK=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,jK=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,RK=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,LK=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,OK=Jh.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:r=>r.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:r=>r.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:r}){return["em",Ln(this.options.HTMLAttributes,r),0]},addCommands(){return{setItalic:()=>({commands:r})=>r.setMark(this.name),toggleItalic:()=>({commands:r})=>r.toggleMark(this.name),unsetItalic:()=>({commands:r})=>r.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(r,e)=>e.applyMark("italic",e.parseInline(r.tokens||[])),renderMarkdown:(r,e)=>`*${e.renderChildren(r)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[xp({find:AK,type:this.type}),xp({find:RK,type:this.type})]},addPasteRules(){return[Wh({find:jK,type:this.type}),Wh({find:LK,type:this.type})]}});const DK="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",IK="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",s_="numeric",o_="ascii",l_="alpha",Sg="asciinumeric",mg="alphanumeric",u_="domain",qA="emoji",BK="scheme",zK="slashscheme",e2="whitespace";function FK(r,e){return r in e||(e[r]=[]),e[r]}function Nh(r,e,n){e[s_]&&(e[Sg]=!0,e[mg]=!0),e[o_]&&(e[Sg]=!0,e[l_]=!0),e[Sg]&&(e[mg]=!0),e[l_]&&(e[mg]=!0),e[mg]&&(e[u_]=!0),e[qA]&&(e[u_]=!0);for(const i in e){const a=FK(i,n);a.indexOf(r)<0&&a.push(r)}}function VK(r,e){const n={};for(const i in e)e[i].indexOf(r)>=0&&(n[i]=!0);return n}function As(r=null){this.j={},this.jr=[],this.jd=null,this.t=r}As.groups={};As.prototype={accepts(){return!!this.t},go(r){const e=this,n=e.j[r];if(n)return n;for(let i=0;i<e.jr.length;i++){const a=e.jr[i][0],s=e.jr[i][1];if(s&&a.test(r))return s}return e.jd},has(r,e=!1){return e?r in this.j:!!this.go(r)},ta(r,e,n,i){for(let a=0;a<r.length;a++)this.tt(r[a],e,n,i)},tr(r,e,n,i){i=i||As.groups;let a;return e&&e.j?a=e:(a=new As(e),n&&i&&Nh(e,n,i)),this.jr.push([r,a]),a},ts(r,e,n,i){let a=this;const s=r.length;if(!s)return a;for(let o=0;o<s-1;o++)a=a.tt(r[o]);return a.tt(r[s-1],e,n,i)},tt(r,e,n,i){i=i||As.groups;const a=this;if(e&&e.j)return a.j[r]=e,e;const s=e;let o,l=a.go(r);if(l?(o=new As,Object.assign(o.j,l.j),o.jr.push.apply(o.jr,l.jr),o.jd=l.jd,o.t=l.t):o=new As,s){if(i)if(o.t&&typeof o.t=="string"){const u=Object.assign(VK(o.t,i),n);Nh(s,u,i)}else n&&Nh(s,n,i);o.t=s}return a.j[r]=o,o}};const ar=(r,e,n,i,a)=>r.ta(e,n,i,a),Wn=(r,e,n,i,a)=>r.tr(e,n,i,a),b3=(r,e,n,i,a)=>r.ts(e,n,i,a),nt=(r,e,n,i,a)=>r.tt(e,n,i,a),Fu="WORD",c_="UWORD",WA="ASCIINUMERICAL",$A="ALPHANUMERICAL",ev="LOCALHOST",d_="TLD",h_="UTLD",Q0="SCHEME",Xf="SLASH_SCHEME",LS="NUM",f_="WS",OS="NL",kg="OPENBRACE",Cg="CLOSEBRACE",Ly="OPENBRACKET",Oy="CLOSEBRACKET",Dy="OPENPAREN",Iy="CLOSEPAREN",By="OPENANGLEBRACKET",zy="CLOSEANGLEBRACKET",Fy="FULLWIDTHLEFTPAREN",Vy="FULLWIDTHRIGHTPAREN",Uy="LEFTCORNERBRACKET",Hy="RIGHTCORNERBRACKET",Gy="LEFTWHITECORNERBRACKET",qy="RIGHTWHITECORNERBRACKET",Wy="FULLWIDTHLESSTHAN",$y="FULLWIDTHGREATERTHAN",Ky="AMPERSAND",Zy="APOSTROPHE",Yy="ASTERISK",ed="AT",Xy="BACKSLASH",Qy="BACKTICK",Jy="CARET",nd="COLON",DS="COMMA",ex="DOLLAR",Kl="DOT",tx="EQUALS",IS="EXCLAMATION",ko="HYPHEN",Eg="PERCENT",rx="PIPE",nx="PLUS",ix="POUND",Ng="QUERY",BS="QUOTE",KA="FULLWIDTHMIDDLEDOT",zS="SEMI",Zl="SLASH",Tg="TILDE",ax="UNDERSCORE",ZA="EMOJI",sx="SYM";var YA=Object.freeze({__proto__:null,ALPHANUMERICAL:$A,AMPERSAND:Ky,APOSTROPHE:Zy,ASCIINUMERICAL:WA,ASTERISK:Yy,AT:ed,BACKSLASH:Xy,BACKTICK:Qy,CARET:Jy,CLOSEANGLEBRACKET:zy,CLOSEBRACE:Cg,CLOSEBRACKET:Oy,CLOSEPAREN:Iy,COLON:nd,COMMA:DS,DOLLAR:ex,DOT:Kl,EMOJI:ZA,EQUALS:tx,EXCLAMATION:IS,FULLWIDTHGREATERTHAN:$y,FULLWIDTHLEFTPAREN:Fy,FULLWIDTHLESSTHAN:Wy,FULLWIDTHMIDDLEDOT:KA,FULLWIDTHRIGHTPAREN:Vy,HYPHEN:ko,LEFTCORNERBRACKET:Uy,LEFTWHITECORNERBRACKET:Gy,LOCALHOST:ev,NL:OS,NUM:LS,OPENANGLEBRACKET:By,OPENBRACE:kg,OPENBRACKET:Ly,OPENPAREN:Dy,PERCENT:Eg,PIPE:rx,PLUS:nx,POUND:ix,QUERY:Ng,QUOTE:BS,RIGHTCORNERBRACKET:Hy,RIGHTWHITECORNERBRACKET:qy,SCHEME:Q0,SEMI:zS,SLASH:Zl,SLASH_SCHEME:Xf,SYM:sx,TILDE:Tg,TLD:d_,UNDERSCORE:ax,UTLD:h_,UWORD:c_,WORD:Fu,WS:f_});const Bu=/[a-z]/,ig=new RegExp("\\p{L}","u"),t2=new RegExp("\\p{Emoji}","u"),zu=/\d/,r2=/\s/,w3="\r",n2=`
`,UK="",HK="",i2="";let A0=null,j0=null;function GK(r=[]){const e={};As.groups=e;const n=new As;A0==null&&(A0=_3(DK)),j0==null&&(j0=_3(IK)),nt(n,"'",Zy),nt(n,"{",kg),nt(n,"}",Cg),nt(n,"[",Ly),nt(n,"]",Oy),nt(n,"(",Dy),nt(n,")",Iy),nt(n,"<",By),nt(n,">",zy),nt(n,"",Fy),nt(n,"",Vy),nt(n,"",Uy),nt(n,"",Hy),nt(n,"",Gy),nt(n,"",qy),nt(n,"",Wy),nt(n,"",$y),nt(n,"&",Ky),nt(n,"*",Yy),nt(n,"@",ed),nt(n,"`",Qy),nt(n,"^",Jy),nt(n,":",nd),nt(n,",",DS),nt(n,"$",ex),nt(n,".",Kl),nt(n,"=",tx),nt(n,"!",IS),nt(n,"-",ko),nt(n,"%",Eg),nt(n,"|",rx),nt(n,"+",nx),nt(n,"#",ix),nt(n,"?",Ng),nt(n,'"',BS),nt(n,"/",Zl),nt(n,";",zS),nt(n,"~",Tg),nt(n,"_",ax),nt(n,"\\",Xy),nt(n,"",KA);const i=Wn(n,zu,LS,{[s_]:!0});Wn(i,zu,i);const a=Wn(i,Bu,WA,{[Sg]:!0}),s=Wn(i,ig,$A,{[mg]:!0}),o=Wn(n,Bu,Fu,{[o_]:!0});Wn(o,zu,a),Wn(o,Bu,o),Wn(a,zu,a),Wn(a,Bu,a);const l=Wn(n,ig,c_,{[l_]:!0});Wn(l,Bu),Wn(l,zu,s),Wn(l,ig,l),Wn(s,zu,s),Wn(s,Bu),Wn(s,ig,s);const u=nt(n,n2,OS,{[e2]:!0}),c=nt(n,w3,f_,{[e2]:!0}),d=Wn(n,r2,f_,{[e2]:!0});nt(n,i2,d),nt(c,n2,u),nt(c,i2,d),Wn(c,r2,d),nt(d,w3),nt(d,n2),Wn(d,r2,d),nt(d,i2,d);const p=Wn(n,t2,ZA,{[qA]:!0});nt(p,"#"),Wn(p,t2,p),nt(p,UK,p);const v=nt(p,HK);nt(v,"#"),Wn(v,t2,p);const y=[[Bu,o],[zu,a]],b=[[Bu,null],[ig,l],[zu,s]];for(let S=0;S<A0.length;S++)Yc(n,A0[S],d_,Fu,y);for(let S=0;S<j0.length;S++)Yc(n,j0[S],h_,c_,b);Nh(d_,{tld:!0,ascii:!0},e),Nh(h_,{utld:!0,alpha:!0},e),Yc(n,"file",Q0,Fu,y),Yc(n,"mailto",Q0,Fu,y),Yc(n,"http",Xf,Fu,y),Yc(n,"https",Xf,Fu,y),Yc(n,"ftp",Xf,Fu,y),Yc(n,"ftps",Xf,Fu,y),Nh(Q0,{scheme:!0,ascii:!0},e),Nh(Xf,{slashscheme:!0,ascii:!0},e),r=r.sort((S,k)=>S[0]>k[0]?1:-1);for(let S=0;S<r.length;S++){const k=r[S][0],C=r[S][1]?{[BK]:!0}:{[zK]:!0};k.indexOf("-")>=0?C[u_]=!0:Bu.test(k)?zu.test(k)?C[Sg]=!0:C[o_]=!0:C[s_]=!0,b3(n,k,k,C)}return b3(n,"localhost",ev,{ascii:!0}),n.jd=new As(sx),{start:n,tokens:Object.assign({groups:e},YA)}}function XA(r,e){const n=qK(e.replace(/[A-Z]/g,l=>l.toLowerCase())),i=n.length,a=[];let s=0,o=0;for(;o<i;){let l=r,u=null,c=0,d=null,p=-1,v=-1;for(;o<i&&(u=l.go(n[o]));)l=u,l.accepts()?(p=0,v=0,d=l):p>=0&&(p+=n[o].length,v++),c+=n[o].length,s+=n[o].length,o++;s-=p,o-=v,c-=p,a.push({t:d.t,v:e.slice(s-c,s),s:s-c,e:s})}return a}function qK(r){const e=[],n=r.length;let i=0;for(;i<n;){let a=r.charCodeAt(i),s,o=a<55296||a>56319||i+1===n||(s=r.charCodeAt(i+1))<56320||s>57343?r[i]:r.slice(i,i+2);e.push(o),i+=o.length}return e}function Yc(r,e,n,i,a){let s;const o=e.length;for(let l=0;l<o-1;l++){const u=e[l];r.j[u]?s=r.j[u]:(s=new As(i),s.jr=a.slice(),r.j[u]=s),r=s}return s=new As(n),s.jr=a.slice(),r.j[e[o-1]]=s,s}function _3(r){const e=[],n=[];let i=0,a="0123456789";for(;i<r.length;){let s=0;for(;a.indexOf(r[i+s])>=0;)s++;if(s>0){e.push(n.join(""));for(let o=parseInt(r.substring(i,i+s),10);o>0;o--)n.pop();i+=s}else n.push(r[i]),i++}return e}const tv={defaultProtocol:"http",events:null,format:S3,formatHref:S3,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function FS(r,e=null){let n=Object.assign({},tv);r&&(n=Object.assign(n,r instanceof FS?r.o:r));const i=n.ignoreTags,a=[];for(let s=0;s<i.length;s++)a.push(i[s].toUpperCase());this.o=n,e&&(this.defaultRender=e),this.ignoreTags=a}FS.prototype={o:tv,ignoreTags:[],defaultRender(r){return r},check(r){return this.get("validate",r.toString(),r)},get(r,e,n){const i=e!=null;let a=this.o[r];return a&&(typeof a=="object"?(a=n.t in a?a[n.t]:tv[r],typeof a=="function"&&i&&(a=a(e,n))):typeof a=="function"&&i&&(a=a(e,n.t,n)),a)},getObj(r,e,n){let i=this.o[r];return typeof i=="function"&&e!=null&&(i=i(e,n.t,n)),i},render(r){const e=r.render(this);return(this.get("render",null,r)||this.defaultRender)(e,r.t,r)}};function S3(r){return r}function QA(r,e){this.t="token",this.v=r,this.tk=e}QA.prototype={isLink:!1,toString(){return this.v},toHref(r){return this.toString()},toFormattedString(r){const e=this.toString(),n=r.get("truncate",e,this),i=r.get("format",e,this);return n&&i.length>n?i.substring(0,n)+"":i},toFormattedHref(r){return r.get("formatHref",this.toHref(r.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(r=tv.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(r),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(r){return{type:this.t,value:this.toFormattedString(r),isLink:this.isLink,href:this.toFormattedHref(r),start:this.startIndex(),end:this.endIndex()}},validate(r){return r.get("validate",this.toString(),this)},render(r){const e=this,n=this.toHref(r.get("defaultProtocol")),i=r.get("formatHref",n,this),a=r.get("tagName",n,e),s=this.toFormattedString(r),o={},l=r.get("className",n,e),u=r.get("target",n,e),c=r.get("rel",n,e),d=r.getObj("attributes",n,e),p=r.getObj("events",n,e);return o.href=i,l&&(o.class=l),u&&(o.target=u),c&&(o.rel=c),d&&Object.assign(o,d),{tagName:a,attributes:o,content:s,eventListeners:p}}};function Zx(r,e){class n extends QA{constructor(a,s){super(a,s),this.t=r}}for(const i in e)n.prototype[i]=e[i];return n.t=r,n}const k3=Zx("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),C3=Zx("text"),WK=Zx("nl"),R0=Zx("url",{isLink:!0,toHref(r=tv.defaultProtocol){return this.hasProtocol()?this.v:`${r}://${this.v}`},hasProtocol(){const r=this.tk;return r.length>=2&&r[0].t!==ev&&r[1].t===nd}}),_o=r=>new As(r);function $K({groups:r}){const e=r.domain.concat([Ky,Yy,ed,Xy,Qy,Jy,ex,tx,ko,LS,Eg,rx,nx,ix,Zl,sx,Tg,ax]),n=[Zy,nd,DS,Kl,IS,Eg,Ng,BS,zS,By,zy,kg,Cg,Oy,Ly,Dy,Iy,Fy,Vy,Uy,Hy,Gy,qy,Wy,$y],i=[Ky,Zy,Yy,Xy,Qy,Jy,ex,tx,ko,kg,Cg,Eg,rx,nx,ix,Ng,Zl,sx,Tg,ax],a=_o(),s=nt(a,Tg);ar(s,i,s),ar(s,r.domain,s);const o=_o(),l=_o(),u=_o();ar(a,r.domain,o),ar(a,r.scheme,l),ar(a,r.slashscheme,u),ar(o,i,s),ar(o,r.domain,o);const c=nt(o,ed);nt(s,ed,c),nt(l,ed,c),nt(u,ed,c);const d=nt(s,Kl);ar(d,i,s),ar(d,r.domain,s);const p=_o();ar(c,r.domain,p),ar(p,r.domain,p);const v=nt(p,Kl);ar(v,r.domain,p);const y=_o(k3);ar(v,r.tld,y),ar(v,r.utld,y),nt(c,ev,y);const b=nt(p,ko);nt(b,ko,b),ar(b,r.domain,p),ar(y,r.domain,p),nt(y,Kl,v),nt(y,ko,b);const S=nt(y,nd);ar(S,r.numeric,k3);const k=nt(o,ko),T=nt(o,Kl);nt(k,ko,k),ar(k,r.domain,o),ar(T,i,s),ar(T,r.domain,o);const C=_o(R0);ar(T,r.tld,C),ar(T,r.utld,C),ar(C,r.domain,o),ar(C,i,s),nt(C,Kl,T),nt(C,ko,k),nt(C,ed,c);const N=nt(C,nd),P=_o(R0);ar(N,r.numeric,P);const R=_o(R0),O=_o();ar(R,e,R),ar(R,n,O),ar(O,e,R),ar(O,n,O),nt(C,Zl,R),nt(P,Zl,R);const B=nt(l,nd),I=nt(u,nd),z=nt(I,Zl),V=nt(z,Zl);ar(l,r.domain,o),nt(l,Kl,T),nt(l,ko,k),ar(u,r.domain,o),nt(u,Kl,T),nt(u,ko,k),ar(B,r.domain,R),nt(B,Zl,R),nt(B,Ng,R),ar(V,r.domain,R),ar(V,e,R),nt(V,Zl,R);const $=[[kg,Cg],[Ly,Oy],[Dy,Iy],[By,zy],[Fy,Vy],[Uy,Hy],[Gy,qy],[Wy,$y]];for(let Y=0;Y<$.length;Y++){const[D,q]=$[Y],G=nt(R,D);nt(O,D,G),nt(G,q,R);const Z=_o(R0);ar(G,e,Z);const Q=_o();ar(G,n),ar(Z,e,Z),ar(Z,n,Q),ar(Q,e,Z),ar(Q,n,Q),nt(Z,q,R),nt(Q,q,R)}return nt(a,ev,C),nt(a,OS,WK),{start:a,tokens:YA}}function KK(r,e,n){let i=n.length,a=0,s=[],o=[];for(;a<i;){let l=r,u=null,c=null,d=0,p=null,v=-1;for(;a<i&&!(u=l.go(n[a].t));)o.push(n[a++]);for(;a<i&&(c=u||l.go(n[a].t));)u=null,l=c,l.accepts()?(v=0,p=l):v>=0&&v++,a++,d++;if(v<0)a-=d,a<i&&(o.push(n[a]),a++);else{o.length>0&&(s.push(a2(C3,e,o)),o=[]),a-=v,d-=v;const y=p.t,b=n.slice(a-d,a);s.push(a2(y,e,b))}}return o.length>0&&s.push(a2(C3,e,o)),s}function a2(r,e,n){const i=n[0].s,a=n[n.length-1].e,s=e.slice(i,a);return new r(s,n)}const ZK=typeof console<"u"&&console&&console.warn||(()=>{}),YK="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",yn={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function XK(){return As.groups={},yn.scanner=null,yn.parser=null,yn.tokenQueue=[],yn.pluginQueue=[],yn.customSchemes=[],yn.initialized=!1,yn}function E3(r,e=!1){if(yn.initialized&&ZK(`linkifyjs: already initialized - will not register custom scheme "${r}" ${YK}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(r))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);yn.customSchemes.push([r,e])}function QK(){yn.scanner=GK(yn.customSchemes);for(let r=0;r<yn.tokenQueue.length;r++)yn.tokenQueue[r][1]({scanner:yn.scanner});yn.parser=$K(yn.scanner.tokens);for(let r=0;r<yn.pluginQueue.length;r++)yn.pluginQueue[r][1]({scanner:yn.scanner,parser:yn.parser});return yn.initialized=!0,yn}function VS(r){return yn.initialized||QK(),KK(yn.parser.start,r,XA(yn.scanner.start,r))}VS.scan=XA;function JA(r,e=null,n=null){if(e&&typeof e=="object"){if(n)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);n=e,e=null}const i=new FS(n),a=VS(r),s=[];for(let o=0;o<a.length;o++){const l=a[o];l.isLink&&(!e||l.t===e)&&i.check(l)&&s.push(l.toFormattedObject(i))}return s}var US="[\0- -\u2029]",JK=new RegExp(US),eZ=new RegExp(`${US}$`),tZ=new RegExp(US,"g");function rZ(r){return r.length===1?r[0].isLink:r.length===3&&r[1].isLink?["()","[]"].includes(r[0].value+r[2].value):!1}function nZ(r){return new On({key:new li("autolink"),appendTransaction:(e,n,i)=>{const a=e.some(c=>c.docChanged)&&!n.doc.eq(i.doc),s=e.some(c=>c.getMeta("preventAutolink"));if(!a||s)return;const{tr:o}=i,l=gA(n.doc,[...e]);if(SA(l).forEach(({newRange:c})=>{const d=Qq(i.doc,c,y=>y.isTextblock);let p,v;if(d.length>1)p=d[0],v=i.doc.textBetween(p.pos,p.pos+p.node.nodeSize,void 0," ");else if(d.length){const y=i.doc.textBetween(c.from,c.to," "," ");if(!eZ.test(y))return;p=d[0],v=i.doc.textBetween(p.pos,c.to,void 0," ")}if(p&&v){const y=v.split(JK).filter(Boolean);if(y.length<=0)return!1;const b=y[y.length-1],S=p.pos+v.lastIndexOf(b);if(!b)return!1;const k=VS(b).map(T=>T.toObject(r.defaultProtocol));if(!rZ(k))return!1;k.filter(T=>T.isLink).map(T=>({...T,from:S+T.start+1,to:S+T.end+1})).filter(T=>i.schema.marks.code?!i.doc.rangeHasMark(T.from,T.to,i.schema.marks.code):!0).filter(T=>r.validate(T.value)).filter(T=>r.shouldAutoLink(T.value)).forEach(T=>{PS(T.from,T.to,i.doc).some(C=>C.mark.type===r.type)||o.addMark(T.from,T.to,r.type.create({href:T.href}))})}}),!!o.steps.length)return o}})}function iZ(r){return new On({key:new li("handleClickLink"),props:{handleClick:(e,n,i)=>{var a,s;if(i.button!==0||!e.editable)return!1;let o=null;if(i.target instanceof HTMLAnchorElement)o=i.target;else{const u=i.target;if(!u)return!1;const c=r.editor.view.dom;o=u.closest("a"),o&&!c.contains(o)&&(o=null)}if(!o)return!1;let l=!1;if(r.enableClickSelection&&(l=r.editor.commands.extendMarkRange(r.type.name)),r.openOnClick){const u=_A(e.state,r.type.name),c=(a=o.href)!=null?a:u.href,d=(s=o.target)!=null?s:u.target;c&&(window.open(c,d),l=!0)}return l}}})}function aZ(r){return new On({key:new li("handlePasteLink"),props:{handlePaste:(e,n,i)=>{const{shouldAutoLink:a}=r,{state:s}=e,{selection:o}=s,{empty:l}=o;if(l)return!1;let u="";i.content.forEach(d=>{u+=d.textContent});const c=JA(u,{defaultProtocol:r.defaultProtocol}).find(d=>d.isLink&&d.value===u);return!u||!c||a!==void 0&&!a(c.value)?!1:r.editor.commands.setMark(r.type,{href:c.href})}}})}function gh(r,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(i=>{const a=typeof i=="string"?i:i.scheme;a&&n.push(a)}),!r||r.replace(tZ,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var sZ=Jh.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(r=>{if(typeof r=="string"){E3(r);return}E3(r.scheme,r.optionalSlashes)})},onDestroy(){XK()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(r,e)=>!!gh(r,e.protocols),validate:r=>!!r,shouldAutoLink:r=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(r),n=/^[a-z][a-z0-9+.-]*:/i.test(r);if(e||n&&!r.includes("@"))return!0;const a=(r.includes("@")?r.split("@").pop():r).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(a)||!/\./.test(a))}}},addAttributes(){return{href:{default:null,parseHTML(r){return r.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:r=>{const e=r.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!gh(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:r}){return this.options.isAllowedUri(r.href,{defaultValidate:e=>!!gh(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Ln(this.options.HTMLAttributes,r),0]:["a",Ln(this.options.HTMLAttributes,{...r,href:""}),0]},markdownTokenName:"link",parseMarkdown:(r,e)=>e.applyMark("link",e.parseInline(r.tokens||[]),{href:r.href,title:r.title||null}),renderMarkdown:(r,e)=>{var n;const i=((n=r.attrs)==null?void 0:n.href)||"";return`[${e.renderChildren(r)}](${i})`},addCommands(){return{setLink:r=>({chain:e})=>{const{href:n}=r;return this.options.isAllowedUri(n,{defaultValidate:i=>!!gh(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,r).setMeta("preventAutolink",!0).run():!1},toggleLink:r=>({chain:e})=>{const{href:n}=r||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:i=>!!gh(i,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,r,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:r})=>r().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Wh({find:r=>{const e=[];if(r){const{protocols:n,defaultProtocol:i}=this.options,a=JA(r).filter(s=>s.isLink&&this.options.isAllowedUri(s.value,{defaultValidate:o=>!!gh(o,n),protocols:n,defaultProtocol:i}));a.length&&a.forEach(s=>{this.options.shouldAutoLink(s.value)&&e.push({text:s.value,data:{href:s.href},index:s.start})})}return e},type:this.type,getAttributes:r=>{var e;return{href:(e=r.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const r=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&r.push(nZ({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:i=>this.options.isAllowedUri(i,{defaultValidate:a=>!!gh(a,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),r.push(iZ({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&r.push(aZ({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),r}}),oZ=Object.defineProperty,lZ=(r,e)=>{for(var n in e)oZ(r,n,{get:e[n],enumerable:!0})},uZ="listItem",N3="textStyle",T3=/^\s*([-+*])\s$/,ej=Ds.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:r}){return["ul",Ln(this.options.HTMLAttributes,r),0]},markdownTokenName:"list",parseMarkdown:(r,e)=>r.type!=="list"||r.ordered?[]:{type:"bulletList",content:r.items?e.parseChildren(r.items):[]},renderMarkdown:(r,e)=>r.content?e.renderChildren(r.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:r,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(uZ,this.editor.getAttributes(N3)).run():r.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let r=bp({find:T3,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(r=bp({find:T3,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(N3),editor:this.editor})),[r]}}),tj=Ds.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:r}){return["li",Ln(this.options.HTMLAttributes,r),0]},markdownTokenName:"list_item",parseMarkdown:(r,e)=>{if(r.type!=="list_item")return[];let n=[];if(r.tokens&&r.tokens.length>0)if(r.tokens.some(a=>a.type==="paragraph"))n=e.parseChildren(r.tokens);else{const a=r.tokens[0];if(a&&a.type==="text"&&a.tokens&&a.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(a.tokens)}],r.tokens.length>1){const o=r.tokens.slice(1),l=e.parseChildren(o);n.push(...l)}}else n=e.parseChildren(r.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(r,e,n)=>RS(r,e,i=>i.parentType==="bulletList"?"- ":i.parentType==="orderedList"?`${i.index+1}. `:"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),cZ={};lZ(cZ,{findListItemPos:()=>wv,getNextListDepth:()=>HS,handleBackspace:()=>p_,handleDelete:()=>m_,hasListBefore:()=>rj,hasListItemAfter:()=>dZ,hasListItemBefore:()=>nj,listItemHasSubList:()=>ij,nextListIsDeeper:()=>aj,nextListIsHigher:()=>sj});var wv=(r,e)=>{const{$from:n}=e.selection,i=wi(r,e.schema);let a=null,s=n.depth,o=n.pos,l=null;for(;s>0&&l===null;)a=n.node(s),a.type===i?l=s:(s-=1,o-=1);return l===null?null:{$pos:e.doc.resolve(o),depth:l}},HS=(r,e)=>{const n=wv(r,e);if(!n)return!1;const[,i]=lW(e,r,n.$pos.pos+4);return i},rj=(r,e,n)=>{const{$anchor:i}=r.selection,a=Math.max(0,i.pos-2),s=r.doc.resolve(a).node();return!(!s||!n.includes(s.type.name))},nj=(r,e)=>{var n;const{$anchor:i}=e.selection,a=e.doc.resolve(i.pos-2);return!(a.index()===0||((n=a.nodeBefore)==null?void 0:n.type.name)!==r)},ij=(r,e,n)=>{if(!n)return!1;const i=wi(r,e.schema);let a=!1;return n.descendants(s=>{s.type===i&&(a=!0)}),a},p_=(r,e,n)=>{if(r.commands.undoInputRule())return!0;if(r.state.selection.from!==r.state.selection.to)return!1;if(!Nd(r.state,e)&&rj(r.state,e,n)){const{$anchor:l}=r.state.selection,u=r.state.doc.resolve(l.before()-1),c=[];u.node().descendants((v,y)=>{v.type.name===e&&c.push({node:v,pos:y})});const d=c.at(-1);if(!d)return!1;const p=r.state.doc.resolve(u.start()+d.pos+1);return r.chain().cut({from:l.start()-1,to:l.end()+1},p.end()).joinForward().run()}if(!Nd(r.state,e)||!hW(r.state))return!1;const i=wv(e,r.state);if(!i)return!1;const s=r.state.doc.resolve(i.$pos.pos-2).node(i.depth),o=ij(e,r.state,s);return nj(e,r.state)&&!o?r.commands.joinItemBackward():r.chain().liftListItem(e).run()},aj=(r,e)=>{const n=HS(r,e),i=wv(r,e);return!i||!n?!1:n>i.depth},sj=(r,e)=>{const n=HS(r,e),i=wv(r,e);return!i||!n?!1:n<i.depth},m_=(r,e)=>{if(!Nd(r.state,e)||!dW(r.state,e))return!1;const{selection:n}=r.state,{$from:i,$to:a}=n;return!n.empty&&i.sameParent(a)?!1:aj(e,r.state)?r.chain().focus(r.state.selection.from+4).lift(e).joinBackward().run():sj(e,r.state)?r.chain().joinForward().joinBackward().run():r.commands.joinItemForward()},dZ=(r,e)=>{var n;const{$anchor:i}=e.selection,a=e.doc.resolve(i.pos-i.parentOffset-2);return!(a.index()===a.parent.childCount-1||((n=a.nodeAfter)==null?void 0:n.type.name)!==r)},oj=ui.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:r})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{r.state.schema.nodes[n]!==void 0&&m_(r,n)&&(e=!0)}),e},"Mod-Delete":({editor:r})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{r.state.schema.nodes[n]!==void 0&&m_(r,n)&&(e=!0)}),e},Backspace:({editor:r})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:i})=>{r.state.schema.nodes[n]!==void 0&&p_(r,n,i)&&(e=!0)}),e},"Mod-Backspace":({editor:r})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:i})=>{r.state.schema.nodes[n]!==void 0&&p_(r,n,i)&&(e=!0)}),e}}}}),P3=/^(\s*)(\d+)\.\s+(.*)$/,hZ=/^\s/;function fZ(r){const e=[];let n=0,i=0;for(;n<r.length;){const a=r[n],s=a.match(P3);if(!s)break;const[,o,l,u]=s,c=o.length;let d=u,p=n+1;const v=[a];for(;p<r.length;){const y=r[p];if(y.match(P3))break;if(y.trim()==="")v.push(y),d+=`
`,p+=1;else if(y.match(hZ))v.push(y),d+=`
${y.slice(c+2)}`,p+=1;else break}e.push({indent:c,number:parseInt(l,10),content:d.trim(),raw:v.join(`
`)}),i=p,n=p}return[e,i]}function lj(r,e,n){var i;const a=[];let s=0;for(;s<r.length;){const o=r[s];if(o.indent===e){const l=o.content.split(`
`),u=((i=l[0])==null?void 0:i.trim())||"",c=[];u&&c.push({type:"paragraph",raw:u,tokens:n.inlineTokens(u)});const d=l.slice(1).join(`
`).trim();if(d){const y=n.blockTokens(d);c.push(...y)}let p=s+1;const v=[];for(;p<r.length&&r[p].indent>e;)v.push(r[p]),p+=1;if(v.length>0){const y=Math.min(...v.map(S=>S.indent)),b=lj(v,y,n);c.push({type:"list",ordered:!0,start:v[0].number,items:b,raw:v.map(S=>S.raw).join(`
`)})}a.push({type:"list_item",raw:o.raw,tokens:c}),s=p}else s+=1}return a}function pZ(r,e){return r.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const i=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(a=>{if(a.type==="paragraph"||a.type==="list"||a.type==="blockquote"||a.type==="code")i.push(...e.parseChildren([a]));else if(a.type==="text"&&a.tokens){const s=e.parseChildren([a]);i.push({type:"paragraph",content:s})}else{const s=e.parseChildren([a]);s.length>0&&i.push(...s)}}),{type:"listItem",content:i}})}var mZ="listItem",M3="textStyle",A3=/^(\d+)\.\s$/,uj=Ds.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:r=>r.hasAttribute("start")?parseInt(r.getAttribute("start")||"",10):1},type:{default:null,parseHTML:r=>r.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:r}){const{start:e,...n}=r;return e===1?["ol",Ln(this.options.HTMLAttributes,n),0]:["ol",Ln(this.options.HTMLAttributes,r),0]},markdownTokenName:"list",parseMarkdown:(r,e)=>{if(r.type!=="list"||!r.ordered)return[];const n=r.start||1,i=r.items?pZ(r.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:i}:{type:"orderedList",content:i}},renderMarkdown:(r,e)=>r.content?e.renderChildren(r.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:r=>{const e=r.match(/^(\s*)(\d+)\.\s+/),n=e?.index;return n!==void 0?n:-1},tokenize:(r,e,n)=>{var i;const a=r.split(`
`),[s,o]=fZ(a);if(s.length===0)return;const l=lj(s,0,n);return l.length===0?void 0:{type:"list",ordered:!0,start:((i=s[0])==null?void 0:i.number)||1,items:l,raw:a.slice(0,o).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:r,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(mZ,this.editor.getAttributes(M3)).run():r.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let r=bp({find:A3,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(r=bp({find:A3,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(M3)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[r]}}),gZ=/^\s*(\[([( |x])?\])\s$/,vZ=Ds.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:r=>{const e=r.getAttribute("data-checked");return e===""||e==="true"},renderHTML:r=>({"data-checked":r.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:r,HTMLAttributes:e}){return["li",Ln(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:r.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(r,e)=>{const n=[];if(r.tokens&&r.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(r.tokens))):r.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:r.text})])):n.push(e.createNode("paragraph",{},[])),r.nestedTokens&&r.nestedTokens.length>0){const i=e.parseChildren(r.nestedTokens);n.push(...i)}return e.createNode("taskItem",{checked:r.checked||!1},n)},renderMarkdown:(r,e)=>{var n;const a=`- [${(n=r.attrs)!=null&&n.checked?"x":" "}] `;return RS(r,e,a)},addKeyboardShortcuts(){const r={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...r,Tab:()=>this.editor.commands.sinkListItem(this.name)}:r},addNodeView(){return({node:r,HTMLAttributes:e,getPos:n,editor:i})=>{const a=document.createElement("li"),s=document.createElement("label"),o=document.createElement("span"),l=document.createElement("input"),u=document.createElement("div"),c=p=>{var v,y;l.ariaLabel=((y=(v=this.options.a11y)==null?void 0:v.checkboxLabel)==null?void 0:y.call(v,p,l.checked))||`Task item checkbox for ${p.textContent||"empty task item"}`};c(r),s.contentEditable="false",l.type="checkbox",l.addEventListener("mousedown",p=>p.preventDefault()),l.addEventListener("change",p=>{if(!i.isEditable&&!this.options.onReadOnlyChecked){l.checked=!l.checked;return}const{checked:v}=p.target;i.isEditable&&typeof n=="function"&&i.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:y})=>{const b=n();if(typeof b!="number")return!1;const S=y.doc.nodeAt(b);return y.setNodeMarkup(b,void 0,{...S?.attrs,checked:v}),!0}).run(),!i.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(r,v)||(l.checked=!l.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([p,v])=>{a.setAttribute(p,v)}),a.dataset.checked=r.attrs.checked,l.checked=r.attrs.checked,s.append(l,o),a.append(s,u),Object.entries(e).forEach(([p,v])=>{a.setAttribute(p,v)});let d=new Set(Object.keys(e));return{dom:a,contentDOM:u,update:p=>{if(p.type!==this.type)return!1;a.dataset.checked=p.attrs.checked,l.checked=p.attrs.checked,c(p);const v=i.extensionManager.attributes,y=Jg(p,v),b=new Set(Object.keys(y)),S=this.options.HTMLAttributes;return d.forEach(k=>{b.has(k)||(k in S?a.setAttribute(k,S[k]):a.removeAttribute(k))}),Object.entries(y).forEach(([k,T])=>{T==null?k in S?a.setAttribute(k,S[k]):a.removeAttribute(k):a.setAttribute(k,T)}),d=b,!0}}}},addInputRules(){return[bp({find:gZ,type:this.type,getAttributes:r=>({checked:r[r.length-1]==="x"})})]}}),yZ=Ds.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:r}){return["ul",Ln(this.options.HTMLAttributes,r,{"data-type":this.name}),0]},parseMarkdown:(r,e)=>e.createNode("taskList",{},e.parseChildren(r.items||[])),renderMarkdown:(r,e)=>r.content?e.renderChildren(r.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(r){var e;const n=(e=r.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(r,e,n){const i=s=>{const o=i_(s,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:l=>({indentLevel:l[1].length,mainContent:l[4],checked:l[3].toLowerCase()==="x"}),createToken:(l,u)=>({type:"taskItem",raw:"",mainContent:l.mainContent,indentLevel:l.indentLevel,checked:l.checked,text:l.mainContent,tokens:n.inlineTokens(l.mainContent),nestedTokens:u}),customNestedParser:i},n);return o?[{type:"taskList",raw:o.raw,items:o.items}]:n.blockTokens(s)},a=i_(r,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:s=>({indentLevel:s[1].length,mainContent:s[4],checked:s[3].toLowerCase()==="x"}),createToken:(s,o)=>({type:"taskItem",raw:"",mainContent:s.mainContent,indentLevel:s.indentLevel,checked:s.checked,text:s.mainContent,tokens:n.inlineTokens(s.mainContent),nestedTokens:o}),customNestedParser:i},n);if(a)return{type:"taskList",raw:a.raw,items:a.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:r})=>r.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});ui.create({name:"listKit",addExtensions(){const r=[];return this.options.bulletList!==!1&&r.push(ej.configure(this.options.bulletList)),this.options.listItem!==!1&&r.push(tj.configure(this.options.listItem)),this.options.listKeymap!==!1&&r.push(oj.configure(this.options.listKeymap)),this.options.orderedList!==!1&&r.push(uj.configure(this.options.orderedList)),this.options.taskItem!==!1&&r.push(vZ.configure(this.options.taskItem)),this.options.taskList!==!1&&r.push(yZ.configure(this.options.taskList)),r}});var xZ=Ds.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:r}){return["p",Ln(this.options.HTMLAttributes,r),0]},parseMarkdown:(r,e)=>{const n=r.tokens||[];return n.length===1&&n[0].type==="image"?e.parseChildren([n[0]]):e.createNode("paragraph",void 0,e.parseInline(n))},renderMarkdown:(r,e)=>!r||!Array.isArray(r.content)?"":e.renderChildren(r.content),addCommands(){return{setParagraph:()=>({commands:r})=>r.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),bZ=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,wZ=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,_Z=Jh.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:r=>r.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:r}){return["s",Ln(this.options.HTMLAttributes,r),0]},markdownTokenName:"del",parseMarkdown:(r,e)=>e.applyMark("strike",e.parseInline(r.tokens||[])),renderMarkdown:(r,e)=>`~~${e.renderChildren(r)}~~`,addCommands(){return{setStrike:()=>({commands:r})=>r.setMark(this.name),toggleStrike:()=>({commands:r})=>r.toggleMark(this.name),unsetStrike:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[xp({find:bZ,type:this.type})]},addPasteRules(){return[Wh({find:wZ,type:this.type})]}}),SZ=Ds.create({name:"text",group:"inline",parseMarkdown:r=>({type:"text",text:r.text||""}),renderMarkdown:r=>r.text||""}),kZ=Jh.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:r=>r.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:r}){return["u",Ln(this.options.HTMLAttributes,r),0]},parseMarkdown(r,e){return e.applyMark(this.name||"underline",e.parseInline(r.tokens||[]))},renderMarkdown(r,e){return`++${e.renderChildren(r)}++`},markdownTokenizer:{name:"underline",level:"inline",start(r){return r.indexOf("++")},tokenize(r,e,n){const a=/^(\+\+)([\s\S]+?)(\+\+)/.exec(r);if(!a)return;const s=a[2].trim();return{type:"underline",raw:a[0],text:s,tokens:n.inlineTokens(s)}}},addCommands(){return{setUnderline:()=>({commands:r})=>r.setMark(this.name),toggleUnderline:()=>({commands:r})=>r.toggleMark(this.name),unsetUnderline:()=>({commands:r})=>r.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function CZ(r={}){return new On({view(e){return new EZ(e,r)}})}class EZ{constructor(e,n){var i;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(i=n.width)!==null&&i!==void 0?i:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(a=>{let s=o=>{this[a](o)};return e.dom.addEventListener(a,s),{name:a,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,i,a=this.editorView.dom,s=a.getBoundingClientRect(),o=s.width/a.offsetWidth,l=s.height/a.offsetHeight;if(n){let p=e.nodeBefore,v=e.nodeAfter;if(p||v){let y=this.editorView.nodeDOM(this.cursorPos-(p?p.nodeSize:0));if(y){let b=y.getBoundingClientRect(),S=p?b.bottom:b.top;p&&v&&(S=(S+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let k=this.width/2*l;i={left:b.left,right:b.right,top:S-k,bottom:S+k}}}}if(!i){let p=this.editorView.coordsAtPos(this.cursorPos),v=this.width/2*o;i={left:p.left-v,right:p.left+v,top:p.top,bottom:p.bottom}}let u=this.editorView.dom.offsetParent;this.element||(this.element=u.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let c,d;if(!u||u==document.body&&getComputedStyle(u).position=="static")c=-pageXOffset,d=-pageYOffset;else{let p=u.getBoundingClientRect(),v=p.width/u.offsetWidth,y=p.height/u.offsetHeight;c=p.left-u.scrollLeft*v,d=p.top-u.scrollTop*y}this.element.style.left=(i.left-c)/o+"px",this.element.style.top=(i.top-d)/l+"px",this.element.style.width=(i.right-i.left)/o+"px",this.element.style.height=(i.bottom-i.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),i=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),a=i&&i.type.spec.disableDropCursor,s=typeof a=="function"?a(this.editorView,n,e):a;if(n&&!s){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=o6(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class $n extends sr{constructor(e){super(e,e)}map(e,n){let i=e.resolve(n.map(this.head));return $n.valid(i)?new $n(i):sr.near(i)}content(){return St.empty}eq(e){return e instanceof $n&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new $n(e.resolve(n.pos))}getBookmark(){return new GS(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!NZ(e)||!TZ(e))return!1;let i=n.type.spec.allowGapCursor;if(i!=null)return i;let a=n.contentMatchAt(e.index()).defaultType;return a&&a.isTextblock}static findGapCursorFrom(e,n,i=!1){e:for(;;){if(!i&&$n.valid(e))return e;let a=e.pos,s=null;for(let o=e.depth;;o--){let l=e.node(o);if(n>0?e.indexAfter(o)<l.childCount:e.index(o)>0){s=l.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;a+=n;let u=e.doc.resolve(a);if($n.valid(u))return u}for(;;){let o=n>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!Bt.isSelectable(s)){e=e.doc.resolve(a+s.nodeSize*n),i=!1;continue e}break}s=o,a+=n;let l=e.doc.resolve(a);if($n.valid(l))return l}return null}}}$n.prototype.visible=!1;$n.findFrom=$n.findGapCursorFrom;sr.jsonID("gapcursor",$n);class GS{constructor(e){this.pos=e}map(e){return new GS(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return $n.valid(n)?new $n(n):sr.near(n)}}function cj(r){return r.isAtom||r.spec.isolating||r.spec.createGapCursor}function NZ(r){for(let e=r.depth;e>=0;e--){let n=r.index(e),i=r.node(e);if(n==0){if(i.type.spec.isolating)return!0;continue}for(let a=i.child(n-1);;a=a.lastChild){if(a.childCount==0&&!a.inlineContent||cj(a.type))return!0;if(a.inlineContent)return!1}}return!0}function TZ(r){for(let e=r.depth;e>=0;e--){let n=r.indexAfter(e),i=r.node(e);if(n==i.childCount){if(i.type.spec.isolating)return!0;continue}for(let a=i.child(n);;a=a.firstChild){if(a.childCount==0&&!a.inlineContent||cj(a.type))return!0;if(a.inlineContent)return!1}}return!0}function PZ(){return new On({props:{decorations:RZ,createSelectionBetween(r,e,n){return e.pos==n.pos&&$n.valid(n)?new $n(n):null},handleClick:AZ,handleKeyDown:MZ,handleDOMEvents:{beforeinput:jZ}}})}const MZ=lA({ArrowLeft:L0("horiz",-1),ArrowRight:L0("horiz",1),ArrowUp:L0("vert",-1),ArrowDown:L0("vert",1)});function L0(r,e){const n=r=="vert"?e>0?"down":"up":e>0?"right":"left";return function(i,a,s){let o=i.selection,l=e>0?o.$to:o.$from,u=o.empty;if(o instanceof Qt){if(!s.endOfTextblock(n)||l.depth==0)return!1;u=!1,l=i.doc.resolve(e>0?l.after():l.before())}let c=$n.findGapCursorFrom(l,e,u);return c?(a&&a(i.tr.setSelection(new $n(c))),!0):!1}}function AZ(r,e,n){if(!r||!r.editable)return!1;let i=r.state.doc.resolve(e);if(!$n.valid(i))return!1;let a=r.posAtCoords({left:n.clientX,top:n.clientY});return a&&a.inside>-1&&Bt.isSelectable(r.state.doc.nodeAt(a.inside))?!1:(r.dispatch(r.state.tr.setSelection(new $n(i))),!0)}function jZ(r,e){if(e.inputType!="insertCompositionText"||!(r.state.selection instanceof $n))return!1;let{$from:n}=r.state.selection,i=n.parent.contentMatchAt(n.index()).findWrapping(r.state.schema.nodes.text);if(!i)return!1;let a=Qe.empty;for(let o=i.length-1;o>=0;o--)a=Qe.from(i[o].createAndFill(null,a));let s=r.state.tr.replace(n.pos,n.pos,new St(a,0,0));return s.setSelection(Qt.near(s.doc.resolve(n.pos+1))),r.dispatch(s),!1}function RZ(r){if(!(r.selection instanceof $n))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",jn.create(r.doc,[Ga.widget(r.selection.head,e,{key:"gapcursor"})])}var ox=200,Ji=function(){};Ji.prototype.append=function(e){return e.length?(e=Ji.from(e),!this.length&&e||e.length<ox&&this.leafAppend(e)||this.length<ox&&e.leafPrepend(this)||this.appendInner(e)):this};Ji.prototype.prepend=function(e){return e.length?Ji.from(e).append(this):this};Ji.prototype.appendInner=function(e){return new LZ(this,e)};Ji.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?Ji.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};Ji.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Ji.prototype.forEach=function(e,n,i){n===void 0&&(n=0),i===void 0&&(i=this.length),n<=i?this.forEachInner(e,n,i,0):this.forEachInvertedInner(e,n,i,0)};Ji.prototype.map=function(e,n,i){n===void 0&&(n=0),i===void 0&&(i=this.length);var a=[];return this.forEach(function(s,o){return a.push(e(s,o))},n,i),a};Ji.from=function(e){return e instanceof Ji?e:e&&e.length?new dj(e):Ji.empty};var dj=(function(r){function e(i){r.call(this),this.values=i}r&&(e.__proto__=r),e.prototype=Object.create(r&&r.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(a,s){return a==0&&s==this.length?this:new e(this.values.slice(a,s))},e.prototype.getInner=function(a){return this.values[a]},e.prototype.forEachInner=function(a,s,o,l){for(var u=s;u<o;u++)if(a(this.values[u],l+u)===!1)return!1},e.prototype.forEachInvertedInner=function(a,s,o,l){for(var u=s-1;u>=o;u--)if(a(this.values[u],l+u)===!1)return!1},e.prototype.leafAppend=function(a){if(this.length+a.length<=ox)return new e(this.values.concat(a.flatten()))},e.prototype.leafPrepend=function(a){if(this.length+a.length<=ox)return new e(a.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e})(Ji);Ji.empty=new dj([]);var LZ=(function(r){function e(n,i){r.call(this),this.left=n,this.right=i,this.length=n.length+i.length,this.depth=Math.max(n.depth,i.depth)+1}return r&&(e.__proto__=r),e.prototype=Object.create(r&&r.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(i){return i<this.left.length?this.left.get(i):this.right.get(i-this.left.length)},e.prototype.forEachInner=function(i,a,s,o){var l=this.left.length;if(a<l&&this.left.forEachInner(i,a,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(i,Math.max(a-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,a,s,o){var l=this.left.length;if(a>l&&this.right.forEachInvertedInner(i,a-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(i,Math.min(a,l),s,o)===!1)return!1},e.prototype.sliceInner=function(i,a){if(i==0&&a==this.length)return this;var s=this.left.length;return a<=s?this.left.slice(i,a):i>=s?this.right.slice(i-s,a-s):this.left.slice(i,s).append(this.right.slice(0,a-s))},e.prototype.leafAppend=function(i){var a=this.right.leafAppend(i);if(a)return new e(this.left,a)},e.prototype.leafPrepend=function(i){var a=this.left.leafPrepend(i);if(a)return new e(a,this.right)},e.prototype.appendInner=function(i){return this.left.depth>=Math.max(this.right.depth,i.depth)+1?new e(this.left,new e(this.right,i)):new e(this,i)},e})(Ji);const OZ=500;class ul{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let i=this.items.length;for(;;i--)if(this.items.get(i-1).selection){--i;break}let a,s;n&&(a=this.remapping(i,this.items.length),s=a.maps.length);let o=e.tr,l,u,c=[],d=[];return this.items.forEach((p,v)=>{if(!p.step){a||(a=this.remapping(i,v+1),s=a.maps.length),s--,d.push(p);return}if(a){d.push(new Yl(p.map));let y=p.step.map(a.slice(s)),b;y&&o.maybeStep(y).doc&&(b=o.mapping.maps[o.mapping.maps.length-1],c.push(new Yl(b,void 0,void 0,c.length+d.length))),s--,b&&a.appendMap(b,s)}else o.maybeStep(p.step);if(p.selection)return l=a?p.selection.map(a.slice(s)):p.selection,u=new ul(this.items.slice(0,i).append(d.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:u,transform:o,selection:l}}addTransform(e,n,i,a){let s=[],o=this.eventCount,l=this.items,u=!a&&l.length?l.get(l.length-1):null;for(let d=0;d<e.steps.length;d++){let p=e.steps[d].invert(e.docs[d]),v=new Yl(e.mapping.maps[d],p,n),y;(y=u&&u.merge(v))&&(v=y,d?s.pop():l=l.slice(0,l.length-1)),s.push(v),n&&(o++,n=void 0),a||(u=v)}let c=o-i.depth;return c>IZ&&(l=DZ(l,c),o-=c),new ul(l.append(s),o)}remapping(e,n){let i=new $g;return this.items.forEach((a,s)=>{let o=a.mirrorOffset!=null&&s-a.mirrorOffset>=e?i.maps.length-a.mirrorOffset:void 0;i.appendMap(a.map,o)},e,n),i}addMaps(e){return this.eventCount==0?this:new ul(this.items.append(e.map(n=>new Yl(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let i=[],a=Math.max(0,this.items.length-n),s=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(v=>{v.selection&&l--},a);let u=n;this.items.forEach(v=>{let y=s.getMirror(--u);if(y==null)return;o=Math.min(o,y);let b=s.maps[y];if(v.step){let S=e.steps[y].invert(e.docs[y]),k=v.selection&&v.selection.map(s.slice(u+1,y));k&&l++,i.push(new Yl(b,S,k))}else i.push(new Yl(b))},a);let c=[];for(let v=n;v<o;v++)c.push(new Yl(s.maps[v]));let d=this.items.slice(0,a).append(c).append(i),p=new ul(d,l);return p.emptyItemCount()>OZ&&(p=p.compress(this.items.length-i.length)),p}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),i=n.maps.length,a=[],s=0;return this.items.forEach((o,l)=>{if(l>=e)a.push(o),o.selection&&s++;else if(o.step){let u=o.step.map(n.slice(i)),c=u&&u.getMap();if(i--,c&&n.appendMap(c,i),u){let d=o.selection&&o.selection.map(n.slice(i));d&&s++;let p=new Yl(c.invert(),u,d),v,y=a.length-1;(v=a.length&&a[y].merge(p))?a[y]=v:a.push(p)}}else o.map&&i--},this.items.length,0),new ul(Ji.from(a.reverse()),s)}}ul.empty=new ul(Ji.empty,0);function DZ(r,e){let n;return r.forEach((i,a)=>{if(i.selection&&e--==0)return n=a,!1}),r.slice(n)}class Yl{constructor(e,n,i,a){this.map=e,this.step=n,this.selection=i,this.mirrorOffset=a}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new Yl(n.getMap().invert(),n,this.selection)}}}class td{constructor(e,n,i,a,s){this.done=e,this.undone=n,this.prevRanges=i,this.prevTime=a,this.prevComposition=s}}const IZ=20;function BZ(r,e,n,i){let a=n.getMeta(Rh),s;if(a)return a.historyState;n.getMeta(VZ)&&(r=new td(r.done,r.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return r;if(o&&o.getMeta(Rh))return o.getMeta(Rh).redo?new td(r.done.addTransform(n,void 0,i,J0(e)),r.undone,j3(n.mapping.maps),r.prevTime,r.prevComposition):new td(r.done,r.undone.addTransform(n,void 0,i,J0(e)),null,r.prevTime,r.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),u=r.prevTime==0||!o&&r.prevComposition!=l&&(r.prevTime<(n.time||0)-i.newGroupDelay||!zZ(n,r.prevRanges)),c=o?s2(r.prevRanges,n.mapping):j3(n.mapping.maps);return new td(r.done.addTransform(n,u?e.selection.getBookmark():void 0,i,J0(e)),ul.empty,c,n.time,l??r.prevComposition)}else return(s=n.getMeta("rebased"))?new td(r.done.rebased(n,s),r.undone.rebased(n,s),s2(r.prevRanges,n.mapping),r.prevTime,r.prevComposition):new td(r.done.addMaps(n.mapping.maps),r.undone.addMaps(n.mapping.maps),s2(r.prevRanges,n.mapping),r.prevTime,r.prevComposition)}function zZ(r,e){if(!e)return!1;if(!r.docChanged)return!0;let n=!1;return r.mapping.maps[0].forEach((i,a)=>{for(let s=0;s<e.length;s+=2)i<=e[s+1]&&a>=e[s]&&(n=!0)}),n}function j3(r){let e=[];for(let n=r.length-1;n>=0&&e.length==0;n--)r[n].forEach((i,a,s,o)=>e.push(s,o));return e}function s2(r,e){if(!r)return null;let n=[];for(let i=0;i<r.length;i+=2){let a=e.map(r[i],1),s=e.map(r[i+1],-1);a<=s&&n.push(a,s)}return n}function FZ(r,e,n){let i=J0(e),a=Rh.get(e).spec.config,s=(n?r.undone:r.done).popEvent(e,i);if(!s)return null;let o=s.selection.resolve(s.transform.doc),l=(n?r.done:r.undone).addTransform(s.transform,e.selection.getBookmark(),a,i),u=new td(n?l:s.remaining,n?s.remaining:l,null,0,-1);return s.transform.setSelection(o).setMeta(Rh,{redo:n,historyState:u})}let o2=!1,R3=null;function J0(r){let e=r.plugins;if(R3!=e){o2=!1,R3=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){o2=!0;break}}return o2}const Rh=new li("history"),VZ=new li("closeHistory");function UZ(r={}){return r={depth:r.depth||100,newGroupDelay:r.newGroupDelay||500},new On({key:Rh,state:{init(){return new td(ul.empty,ul.empty,null,0,-1)},apply(e,n,i){return BZ(n,i,e,r)}},config:r,props:{handleDOMEvents:{beforeinput(e,n){let i=n.inputType,a=i=="historyUndo"?fj:i=="historyRedo"?pj:null;return!a||!e.editable?!1:(n.preventDefault(),a(e.state,e.dispatch))}}}})}function hj(r,e){return(n,i)=>{let a=Rh.getState(n);if(!a||(r?a.undone:a.done).eventCount==0)return!1;if(i){let s=FZ(a,n,r);s&&i(e?s.scrollIntoView():s)}return!0}}const fj=hj(!1,!0),pj=hj(!0,!0);ui.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:r=>r.length,wordCounter:r=>r.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=r=>{const e=r?.node||this.editor.state.doc;if((r?.mode||this.options.mode)==="textSize"){const i=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(i)}return e.nodeSize},this.storage.words=r=>{const e=r?.node||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let r=!1;return[new On({key:new li("characterCount"),appendTransaction:(e,n,i)=>{if(r)return;const a=this.options.limit;if(a==null||a===0){r=!0;return}const s=this.storage.characters({node:i.doc});if(s>a){const o=s-a,l=0,u=o;console.warn(`[CharacterCount] Initial content exceeded limit of ${a} characters. Content was automatically trimmed.`);const c=i.tr.deleteRange(l,u);return r=!0,c}r=!0},filterTransaction:(e,n)=>{const i=this.options.limit;if(!e.docChanged||i===0||i===null||i===void 0)return!0;const a=this.storage.characters({node:n.doc}),s=this.storage.characters({node:e.doc});if(s<=i||a>i&&s>i&&s<=a)return!0;if(a>i&&s>i&&s>a||!e.getMeta("paste"))return!1;const l=e.selection.$head.pos,u=s-i,c=l-u,d=l;return e.deleteRange(c,d),!(this.storage.characters({node:e.doc})>i)}})]}});var HZ=ui.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[CZ(this.options)]}});ui.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new On({key:new li("focus"),props:{decorations:({doc:r,selection:e})=>{const{isEditable:n,isFocused:i}=this.editor,{anchor:a}=e,s=[];if(!n||!i)return jn.create(r,[]);let o=0;this.options.mode==="deepest"&&r.descendants((u,c)=>{if(u.isText)return;if(!(a>=c&&a<=c+u.nodeSize-1))return!1;o+=1});let l=0;return r.descendants((u,c)=>{if(u.isText||!(a>=c&&a<=c+u.nodeSize-1))return!1;if(l+=1,this.options.mode==="deepest"&&o-l>0||this.options.mode==="shallowest"&&l>1)return this.options.mode==="deepest";s.push(Ga.node(c,c+u.nodeSize,{class:this.options.className}))}),jn.create(r,s)}}})]}});var GZ=ui.create({name:"gapCursor",addProseMirrorPlugins(){return[PZ()]},extendNodeSchema(r){var e;const n={name:r.name,options:r.options,storage:r.storage};return{allowGapCursor:(e=Gr(Ot(r,"allowGapCursor",n)))!=null?e:null}}}),qZ=ui.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new On({key:new li("placeholder"),props:{decorations:({doc:r,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:i}=e,a=[];if(!n)return null;const s=this.editor.isEmpty;return r.descendants((o,l)=>{const u=i>=l&&i<=l+o.nodeSize,c=!o.isLeaf&&Wx(o);if((u||!this.options.showOnlyCurrent)&&c){const d=[this.options.emptyNodeClass];s&&d.push(this.options.emptyEditorClass);const p=Ga.node(l,l+o.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:o,pos:l,hasAnchor:u}):this.options.placeholder});a.push(p)}return this.options.includeChildren}),jn.create(r,a)}}})]}});ui.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:r,options:e}=this;return[new On({key:new li("selection"),props:{decorations(n){return n.selection.empty||r.isFocused||!r.isEditable||kA(n.selection)||r.view.dragging?null:jn.create(n.doc,[Ga.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function L3({types:r,node:e}){return e&&Array.isArray(r)&&r.includes(e.type)||e?.type===r}var WZ=ui.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var r;const e=new li(this.name),n=this.options.node||((r=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:r.name)||"paragraph",i=Object.entries(this.editor.schema.nodes).map(([,a])=>a).filter(a=>(this.options.notAfter||[]).concat(n).includes(a.name));return[new On({key:e,appendTransaction:(a,s,o)=>{const{doc:l,tr:u,schema:c}=o,d=e.getState(o),p=l.content.size,v=c.nodes[n];if(d)return u.insert(p,v.create())},state:{init:(a,s)=>{const o=s.tr.doc.lastChild;return!L3({node:o,types:i})},apply:(a,s)=>{if(!a.docChanged||a.getMeta("__uniqueIDTransaction"))return s;const o=a.doc.lastChild;return!L3({node:o,types:i})}}})]}}),$Z=ui.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:r,dispatch:e})=>fj(r,e),redo:()=>({state:r,dispatch:e})=>pj(r,e)}},addProseMirrorPlugins(){return[UZ(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),KZ=ui.create({name:"starterKit",addExtensions(){var r,e,n,i;const a=[];return this.options.bold!==!1&&a.push(bK.configure(this.options.bold)),this.options.blockquote!==!1&&a.push(mK.configure(this.options.blockquote)),this.options.bulletList!==!1&&a.push(ej.configure(this.options.bulletList)),this.options.code!==!1&&a.push(SK.configure(this.options.code)),this.options.codeBlock!==!1&&a.push(EK.configure(this.options.codeBlock)),this.options.document!==!1&&a.push(NK.configure(this.options.document)),this.options.dropcursor!==!1&&a.push(HZ.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&a.push(GZ.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&a.push(TK.configure(this.options.hardBreak)),this.options.heading!==!1&&a.push(PK.configure(this.options.heading)),this.options.undoRedo!==!1&&a.push($Z.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&a.push(MK.configure(this.options.horizontalRule)),this.options.italic!==!1&&a.push(OK.configure(this.options.italic)),this.options.listItem!==!1&&a.push(tj.configure(this.options.listItem)),this.options.listKeymap!==!1&&a.push(oj.configure((r=this.options)==null?void 0:r.listKeymap)),this.options.link!==!1&&a.push(sZ.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&a.push(uj.configure(this.options.orderedList)),this.options.paragraph!==!1&&a.push(xZ.configure(this.options.paragraph)),this.options.strike!==!1&&a.push(_Z.configure(this.options.strike)),this.options.text!==!1&&a.push(SZ.configure(this.options.text)),this.options.underline!==!1&&a.push(kZ.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&a.push(WZ.configure((i=this.options)==null?void 0:i.trailingNode)),a}}),ZZ=KZ,YZ=qZ;function XZ(r){var e;const{char:n,allowSpaces:i,allowToIncludeChar:a,allowedPrefixes:s,startOfLine:o,$position:l}=r,u=i&&!a,c=JW(n),d=new RegExp(`\\s${c}$`),p=o?"^":"",v=a?"":c,y=u?new RegExp(`${p}${c}.*?(?=\\s${v}|$)`,"gm"):new RegExp(`${p}(?:^)?${c}[^\\s${v}]*`,"gm"),b=((e=l.nodeBefore)==null?void 0:e.isText)&&l.nodeBefore.text;if(!b)return null;const S=l.pos-b.length,k=Array.from(b.matchAll(y)).pop();if(!k||k.input===void 0||k.index===void 0)return null;const T=k.input.slice(Math.max(0,k.index-1),k.index),C=new RegExp(`^[${s?.join("")}\0]?$`).test(T);if(s!==null&&!C)return null;const N=S+k.index;let P=N+k[0].length;return u&&d.test(b.slice(P-1,P+1))&&(k[0]+=" ",P+=1),N<l.pos&&P>=l.pos?{range:{from:N,to:P},query:k[0].slice(n.length),text:k[0]}:null}var QZ=new li("suggestion");function JZ({pluginKey:r=QZ,editor:e,char:n="@",allowSpaces:i=!1,allowToIncludeChar:a=!1,allowedPrefixes:s=[" "],startOfLine:o=!1,decorationTag:l="span",decorationClass:u="suggestion",decorationContent:c="",decorationEmptyClass:d="is-empty",command:p=()=>null,items:v=()=>[],render:y=()=>({}),allow:b=()=>!0,findSuggestionMatch:S=XZ,shouldShow:k}){let T;const C=y?.(),N=()=>{const B=e.state.selection.$anchor.pos,I=e.view.coordsAtPos(B),{top:z,right:V,bottom:$,left:Y}=I;try{return new DOMRect(Y,z,V-Y,$-z)}catch{return null}},P=(B,I)=>I?()=>{const z=r.getState(e.state),V=z?.decorationId,$=B.dom.querySelector(`[data-decoration-id="${V}"]`);return $?.getBoundingClientRect()||null}:N;function R(B,I){var z;try{const $=r.getState(B.state),Y=$?.decorationId?B.dom.querySelector(`[data-decoration-id="${$.decorationId}"]`):null,D={editor:e,range:$?.range||{from:0,to:0},query:$?.query||null,text:$?.text||null,items:[],command:q=>p({editor:e,range:$?.range||{from:0,to:0},props:q}),decorationNode:Y,clientRect:P(B,Y)};(z=C?.onExit)==null||z.call(C,D)}catch{}const V=B.state.tr.setMeta(I,{exit:!0});B.dispatch(V)}const O=new On({key:r,view(){return{update:async(B,I)=>{var z,V,$,Y,D,q,G;const Z=(z=this.key)==null?void 0:z.getState(I),Q=(V=this.key)==null?void 0:V.getState(B.state),J=Z.active&&Q.active&&Z.range.from!==Q.range.from,ie=!Z.active&&Q.active,ne=Z.active&&!Q.active,W=!ie&&!ne&&Z.query!==Q.query,re=ie||J&&W,ae=W||J,he=ne||J&&W;if(!re&&!ae&&!he)return;const ve=he&&!re?Z:Q,xe=B.dom.querySelector(`[data-decoration-id="${ve.decorationId}"]`);T={editor:e,range:ve.range,query:ve.query,text:ve.text,items:[],command:se=>p({editor:e,range:ve.range,props:se}),decorationNode:xe,clientRect:P(B,xe)},re&&(($=C?.onBeforeStart)==null||$.call(C,T)),ae&&((Y=C?.onBeforeUpdate)==null||Y.call(C,T)),(ae||re)&&(T.items=await v({editor:e,query:ve.query})),he&&((D=C?.onExit)==null||D.call(C,T)),ae&&((q=C?.onUpdate)==null||q.call(C,T)),re&&((G=C?.onStart)==null||G.call(C,T))},destroy:()=>{var B;T&&((B=C?.onExit)==null||B.call(C,T))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(B,I,z,V){const{isEditable:$}=e,{composing:Y}=e.view,{selection:D}=B,{empty:q,from:G}=D,Z={...I},Q=B.getMeta(r);if(Q&&Q.exit)return Z.active=!1,Z.decorationId=null,Z.range={from:0,to:0},Z.query=null,Z.text=null,Z;if(Z.composing=Y,$&&(q||e.view.composing)){(G<I.range.from||G>I.range.to)&&!Y&&!I.composing&&(Z.active=!1);const J=S({char:n,allowSpaces:i,allowToIncludeChar:a,allowedPrefixes:s,startOfLine:o,$position:D.$from}),ie=`id_${Math.floor(Math.random()*4294967295)}`;J&&b({editor:e,state:V,range:J.range,isActive:I.active})&&(!k||k({editor:e,range:J.range,query:J.query,text:J.text,transaction:B}))?(Z.active=!0,Z.decorationId=I.decorationId?I.decorationId:ie,Z.range=J.range,Z.query=J.query,Z.text=J.text):Z.active=!1}else Z.active=!1;return Z.active||(Z.decorationId=null,Z.range={from:0,to:0},Z.query=null,Z.text=null),Z}},props:{handleKeyDown(B,I){var z,V,$,Y;const{active:D,range:q}=O.getState(B.state);if(!D)return!1;if(I.key==="Escape"||I.key==="Esc"){const Z=O.getState(B.state),Q=(z=T?.decorationNode)!=null?z:null,J=Q??(Z?.decorationId?B.dom.querySelector(`[data-decoration-id="${Z.decorationId}"]`):null);if(((V=C?.onKeyDown)==null?void 0:V.call(C,{view:B,event:I,range:Z.range}))||!1)return!0;const ne={editor:e,range:Z.range,query:Z.query,text:Z.text,items:[],command:W=>p({editor:e,range:Z.range,props:W}),decorationNode:J,clientRect:J?()=>J.getBoundingClientRect()||null:null};return($=C?.onExit)==null||$.call(C,ne),R(B,r),!0}return((Y=C?.onKeyDown)==null?void 0:Y.call(C,{view:B,event:I,range:q}))||!1},decorations(B){const{active:I,range:z,decorationId:V,query:$}=O.getState(B);if(!I)return null;const Y=!$?.length,D=[u];return Y&&D.push(d),jn.create(B.doc,[Ga.inline(z.from,z.to,{nodeName:l,class:D.join(" "),"data-decoration-id":V,"data-decoration-content":c})])}}});return O}function eY({editor:r,overrideSuggestionOptions:e,extensionName:n,char:i="@"}){const a=new li;return{editor:r,char:i,pluginKey:a,command:({editor:s,range:o,props:l})=>{var u,c,d;const p=s.view.state.selection.$to.nodeAfter;(u=p?.text)!=null&&u.startsWith(" ")&&(o.to+=1),s.chain().focus().insertContentAt(o,[{type:n,attrs:{...l,mentionSuggestionChar:i}},{type:"text",text:" "}]).run(),(d=(c=s.view.dom.ownerDocument.defaultView)==null?void 0:c.getSelection())==null||d.collapseToEnd()},allow:({state:s,range:o})=>{const l=s.doc.resolve(o.from),u=s.schema.nodes[n];return!!l.parent.type.contentMatch.matchType(u)},...e}}function mj(r){return(r.options.suggestions.length?r.options.suggestions:[r.options.suggestion]).map(e=>eY({editor:r.editor,overrideSuggestionOptions:e,extensionName:r.name,char:e.char}))}function O3(r,e){const n=mj(r),i=n.find(a=>a.char===e);return i||(n.length?n[0]:null)}var tY=Ds.create({name:"mention",priority:101,addOptions(){return{HTMLAttributes:{},renderText({node:r,suggestion:e}){var n,i;return`${(n=e?.char)!=null?n:"@"}${(i=r.attrs.label)!=null?i:r.attrs.id}`},deleteTriggerWithBackspace:!1,renderHTML({options:r,node:e,suggestion:n}){var i,a;return["span",Ln(this.HTMLAttributes,r.HTMLAttributes),`${(i=n?.char)!=null?i:"@"}${(a=e.attrs.label)!=null?a:e.attrs.id}`]},suggestions:[],suggestion:{}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:r=>r.getAttribute("data-id"),renderHTML:r=>r.id?{"data-id":r.id}:{}},label:{default:null,parseHTML:r=>r.getAttribute("data-label"),renderHTML:r=>r.label?{"data-label":r.label}:{}},mentionSuggestionChar:{default:"@",parseHTML:r=>r.getAttribute("data-mention-suggestion-char"),renderHTML:r=>({"data-mention-suggestion-char":r.mentionSuggestionChar})}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:r,HTMLAttributes:e}){const n=O3(this,r.attrs.mentionSuggestionChar);if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",Ln({"data-type":this.name},this.options.HTMLAttributes,e),this.options.renderLabel({options:this.options,node:r,suggestion:n})];const i={...this.options};i.HTMLAttributes=Ln({"data-type":this.name},this.options.HTMLAttributes,e);const a=this.options.renderHTML({options:i,node:r,suggestion:n});return typeof a=="string"?["span",Ln({"data-type":this.name},this.options.HTMLAttributes,e),a]:a},...VA({nodeName:"mention",name:"@",selfClosing:!0,allowedAttributes:["id","label",{name:"mentionSuggestionChar",skipIfDefault:"@"}],parseAttributes:r=>{const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let i=n.exec(r);for(;i!==null;){const[,a,s,o]=i,l=s??o;e[a==="char"?"mentionSuggestionChar":a]=l,i=n.exec(r)}return e},serializeAttributes:r=>Object.entries(r).filter(([,e])=>e!=null).map(([e,n])=>`${e==="mentionSuggestionChar"?"char":e}="${n}"`).join(" ")}),renderText({node:r}){const e={options:this.options,node:r,suggestion:O3(this,r.attrs.mentionSuggestionChar)};return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel(e)):this.options.renderText(e)},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:r,state:e})=>{let n=!1;const{selection:i}=e,{empty:a,anchor:s}=i;if(!a)return!1;let o=new Po,l=0;return e.doc.nodesBetween(s-1,s,(u,c)=>{if(u.type.name===this.name)return n=!0,o=u,l=c,!1}),n&&r.insertText(this.options.deleteTriggerWithBackspace?"":o.attrs.mentionSuggestionChar,l,l+o.nodeSize),n})}},addProseMirrorPlugins(){return mj(this).map(JZ)}}),rY=tY,Ls="top",Ro="bottom",Lo="right",Os="left",qS="auto",_v=[Ls,Ro,Lo,Os],wp="start",rv="end",nY="clippingParents",gj="viewport",ag="popper",iY="reference",D3=_v.reduce(function(r,e){return r.concat([e+"-"+wp,e+"-"+rv])},[]),vj=[].concat(_v,[qS]).reduce(function(r,e){return r.concat([e,e+"-"+wp,e+"-"+rv])},[]),aY="beforeRead",sY="read",oY="afterRead",lY="beforeMain",uY="main",cY="afterMain",dY="beforeWrite",hY="write",fY="afterWrite",pY=[aY,sY,oY,lY,uY,cY,dY,hY,fY];function nu(r){return r?(r.nodeName||"").toLowerCase():null}function Js(r){if(r==null)return window;if(r.toString()!=="[object Window]"){var e=r.ownerDocument;return e&&e.defaultView||window}return r}function $h(r){var e=Js(r).Element;return r instanceof e||r instanceof Element}function jo(r){var e=Js(r).HTMLElement;return r instanceof e||r instanceof HTMLElement}function WS(r){if(typeof ShadowRoot>"u")return!1;var e=Js(r).ShadowRoot;return r instanceof e||r instanceof ShadowRoot}function mY(r){var e=r.state;Object.keys(e.elements).forEach(function(n){var i=e.styles[n]||{},a=e.attributes[n]||{},s=e.elements[n];!jo(s)||!nu(s)||(Object.assign(s.style,i),Object.keys(a).forEach(function(o){var l=a[o];l===!1?s.removeAttribute(o):s.setAttribute(o,l===!0?"":l)}))})}function gY(r){var e=r.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(i){var a=e.elements[i],s=e.attributes[i]||{},o=Object.keys(e.styles.hasOwnProperty(i)?e.styles[i]:n[i]),l=o.reduce(function(u,c){return u[c]="",u},{});!jo(a)||!nu(a)||(Object.assign(a.style,l),Object.keys(s).forEach(function(u){a.removeAttribute(u)}))})}}const yj={name:"applyStyles",enabled:!0,phase:"write",fn:mY,effect:gY,requires:["computeStyles"]};function Jl(r){return r.split("-")[0]}var Lh=Math.max,lx=Math.min,_p=Math.round;function g_(){var r=navigator.userAgentData;return r!=null&&r.brands&&Array.isArray(r.brands)?r.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function xj(){return!/^((?!chrome|android).)*safari/i.test(g_())}function Sp(r,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var i=r.getBoundingClientRect(),a=1,s=1;e&&jo(r)&&(a=r.offsetWidth>0&&_p(i.width)/r.offsetWidth||1,s=r.offsetHeight>0&&_p(i.height)/r.offsetHeight||1);var o=$h(r)?Js(r):window,l=o.visualViewport,u=!xj()&&n,c=(i.left+(u&&l?l.offsetLeft:0))/a,d=(i.top+(u&&l?l.offsetTop:0))/s,p=i.width/a,v=i.height/s;return{width:p,height:v,top:d,right:c+p,bottom:d+v,left:c,x:c,y:d}}function $S(r){var e=Sp(r),n=r.offsetWidth,i=r.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:r.offsetLeft,y:r.offsetTop,width:n,height:i}}function bj(r,e){var n=e.getRootNode&&e.getRootNode();if(r.contains(e))return!0;if(n&&WS(n)){var i=e;do{if(i&&r.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function Zu(r){return Js(r).getComputedStyle(r)}function vY(r){return["table","td","th"].indexOf(nu(r))>=0}function Bd(r){return(($h(r)?r.ownerDocument:r.document)||window.document).documentElement}function Yx(r){return nu(r)==="html"?r:r.assignedSlot||r.parentNode||(WS(r)?r.host:null)||Bd(r)}function I3(r){return!jo(r)||Zu(r).position==="fixed"?null:r.offsetParent}function yY(r){var e=/firefox/i.test(g_()),n=/Trident/i.test(g_());if(n&&jo(r)){var i=Zu(r);if(i.position==="fixed")return null}var a=Yx(r);for(WS(a)&&(a=a.host);jo(a)&&["html","body"].indexOf(nu(a))<0;){var s=Zu(a);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return a;a=a.parentNode}return null}function Sv(r){for(var e=Js(r),n=I3(r);n&&vY(n)&&Zu(n).position==="static";)n=I3(n);return n&&(nu(n)==="html"||nu(n)==="body"&&Zu(n).position==="static")?e:n||yY(r)||e}function KS(r){return["top","bottom"].indexOf(r)>=0?"x":"y"}function Pg(r,e,n){return Lh(r,lx(e,n))}function xY(r,e,n){var i=Pg(r,e,n);return i>n?n:i}function wj(){return{top:0,right:0,bottom:0,left:0}}function _j(r){return Object.assign({},wj(),r)}function Sj(r,e){return e.reduce(function(n,i){return n[i]=r,n},{})}var bY=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,_j(typeof e!="number"?e:Sj(e,_v))};function wY(r){var e,n=r.state,i=r.name,a=r.options,s=n.elements.arrow,o=n.modifiersData.popperOffsets,l=Jl(n.placement),u=KS(l),c=[Os,Lo].indexOf(l)>=0,d=c?"height":"width";if(!(!s||!o)){var p=bY(a.padding,n),v=$S(s),y=u==="y"?Ls:Os,b=u==="y"?Ro:Lo,S=n.rects.reference[d]+n.rects.reference[u]-o[u]-n.rects.popper[d],k=o[u]-n.rects.reference[u],T=Sv(s),C=T?u==="y"?T.clientHeight||0:T.clientWidth||0:0,N=S/2-k/2,P=p[y],R=C-v[d]-p[b],O=C/2-v[d]/2+N,B=Pg(P,O,R),I=u;n.modifiersData[i]=(e={},e[I]=B,e.centerOffset=B-O,e)}}function _Y(r){var e=r.state,n=r.options,i=n.element,a=i===void 0?"[data-popper-arrow]":i;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||bj(e.elements.popper,a)&&(e.elements.arrow=a))}const SY={name:"arrow",enabled:!0,phase:"main",fn:wY,effect:_Y,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function kp(r){return r.split("-")[1]}var kY={top:"auto",right:"auto",bottom:"auto",left:"auto"};function CY(r,e){var n=r.x,i=r.y,a=e.devicePixelRatio||1;return{x:_p(n*a)/a||0,y:_p(i*a)/a||0}}function B3(r){var e,n=r.popper,i=r.popperRect,a=r.placement,s=r.variation,o=r.offsets,l=r.position,u=r.gpuAcceleration,c=r.adaptive,d=r.roundOffsets,p=r.isFixed,v=o.x,y=v===void 0?0:v,b=o.y,S=b===void 0?0:b,k=typeof d=="function"?d({x:y,y:S}):{x:y,y:S};y=k.x,S=k.y;var T=o.hasOwnProperty("x"),C=o.hasOwnProperty("y"),N=Os,P=Ls,R=window;if(c){var O=Sv(n),B="clientHeight",I="clientWidth";if(O===Js(n)&&(O=Bd(n),Zu(O).position!=="static"&&l==="absolute"&&(B="scrollHeight",I="scrollWidth")),O=O,a===Ls||(a===Os||a===Lo)&&s===rv){P=Ro;var z=p&&O===R&&R.visualViewport?R.visualViewport.height:O[B];S-=z-i.height,S*=u?1:-1}if(a===Os||(a===Ls||a===Ro)&&s===rv){N=Lo;var V=p&&O===R&&R.visualViewport?R.visualViewport.width:O[I];y-=V-i.width,y*=u?1:-1}}var $=Object.assign({position:l},c&&kY),Y=d===!0?CY({x:y,y:S},Js(n)):{x:y,y:S};if(y=Y.x,S=Y.y,u){var D;return Object.assign({},$,(D={},D[P]=C?"0":"",D[N]=T?"0":"",D.transform=(R.devicePixelRatio||1)<=1?"translate("+y+"px, "+S+"px)":"translate3d("+y+"px, "+S+"px, 0)",D))}return Object.assign({},$,(e={},e[P]=C?S+"px":"",e[N]=T?y+"px":"",e.transform="",e))}function EY(r){var e=r.state,n=r.options,i=n.gpuAcceleration,a=i===void 0?!0:i,s=n.adaptive,o=s===void 0?!0:s,l=n.roundOffsets,u=l===void 0?!0:l,c={placement:Jl(e.placement),variation:kp(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,B3(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:u})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,B3(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const NY={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:EY,data:{}};var O0={passive:!0};function TY(r){var e=r.state,n=r.instance,i=r.options,a=i.scroll,s=a===void 0?!0:a,o=i.resize,l=o===void 0?!0:o,u=Js(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(d){d.addEventListener("scroll",n.update,O0)}),l&&u.addEventListener("resize",n.update,O0),function(){s&&c.forEach(function(d){d.removeEventListener("scroll",n.update,O0)}),l&&u.removeEventListener("resize",n.update,O0)}}const PY={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:TY,data:{}};var MY={left:"right",right:"left",bottom:"top",top:"bottom"};function ey(r){return r.replace(/left|right|bottom|top/g,function(e){return MY[e]})}var AY={start:"end",end:"start"};function z3(r){return r.replace(/start|end/g,function(e){return AY[e]})}function ZS(r){var e=Js(r),n=e.pageXOffset,i=e.pageYOffset;return{scrollLeft:n,scrollTop:i}}function YS(r){return Sp(Bd(r)).left+ZS(r).scrollLeft}function jY(r,e){var n=Js(r),i=Bd(r),a=n.visualViewport,s=i.clientWidth,o=i.clientHeight,l=0,u=0;if(a){s=a.width,o=a.height;var c=xj();(c||!c&&e==="fixed")&&(l=a.offsetLeft,u=a.offsetTop)}return{width:s,height:o,x:l+YS(r),y:u}}function RY(r){var e,n=Bd(r),i=ZS(r),a=(e=r.ownerDocument)==null?void 0:e.body,s=Lh(n.scrollWidth,n.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),o=Lh(n.scrollHeight,n.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),l=-i.scrollLeft+YS(r),u=-i.scrollTop;return Zu(a||n).direction==="rtl"&&(l+=Lh(n.clientWidth,a?a.clientWidth:0)-s),{width:s,height:o,x:l,y:u}}function XS(r){var e=Zu(r),n=e.overflow,i=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+a+i)}function kj(r){return["html","body","#document"].indexOf(nu(r))>=0?r.ownerDocument.body:jo(r)&&XS(r)?r:kj(Yx(r))}function Mg(r,e){var n;e===void 0&&(e=[]);var i=kj(r),a=i===((n=r.ownerDocument)==null?void 0:n.body),s=Js(i),o=a?[s].concat(s.visualViewport||[],XS(i)?i:[]):i,l=e.concat(o);return a?l:l.concat(Mg(Yx(o)))}function v_(r){return Object.assign({},r,{left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height})}function LY(r,e){var n=Sp(r,!1,e==="fixed");return n.top=n.top+r.clientTop,n.left=n.left+r.clientLeft,n.bottom=n.top+r.clientHeight,n.right=n.left+r.clientWidth,n.width=r.clientWidth,n.height=r.clientHeight,n.x=n.left,n.y=n.top,n}function F3(r,e,n){return e===gj?v_(jY(r,n)):$h(e)?LY(e,n):v_(RY(Bd(r)))}function OY(r){var e=Mg(Yx(r)),n=["absolute","fixed"].indexOf(Zu(r).position)>=0,i=n&&jo(r)?Sv(r):r;return $h(i)?e.filter(function(a){return $h(a)&&bj(a,i)&&nu(a)!=="body"}):[]}function DY(r,e,n,i){var a=e==="clippingParents"?OY(r):[].concat(e),s=[].concat(a,[n]),o=s[0],l=s.reduce(function(u,c){var d=F3(r,c,i);return u.top=Lh(d.top,u.top),u.right=lx(d.right,u.right),u.bottom=lx(d.bottom,u.bottom),u.left=Lh(d.left,u.left),u},F3(r,o,i));return l.width=l.right-l.left,l.height=l.bottom-l.top,l.x=l.left,l.y=l.top,l}function Cj(r){var e=r.reference,n=r.element,i=r.placement,a=i?Jl(i):null,s=i?kp(i):null,o=e.x+e.width/2-n.width/2,l=e.y+e.height/2-n.height/2,u;switch(a){case Ls:u={x:o,y:e.y-n.height};break;case Ro:u={x:o,y:e.y+e.height};break;case Lo:u={x:e.x+e.width,y:l};break;case Os:u={x:e.x-n.width,y:l};break;default:u={x:e.x,y:e.y}}var c=a?KS(a):null;if(c!=null){var d=c==="y"?"height":"width";switch(s){case wp:u[c]=u[c]-(e[d]/2-n[d]/2);break;case rv:u[c]=u[c]+(e[d]/2-n[d]/2);break}}return u}function nv(r,e){e===void 0&&(e={});var n=e,i=n.placement,a=i===void 0?r.placement:i,s=n.strategy,o=s===void 0?r.strategy:s,l=n.boundary,u=l===void 0?nY:l,c=n.rootBoundary,d=c===void 0?gj:c,p=n.elementContext,v=p===void 0?ag:p,y=n.altBoundary,b=y===void 0?!1:y,S=n.padding,k=S===void 0?0:S,T=_j(typeof k!="number"?k:Sj(k,_v)),C=v===ag?iY:ag,N=r.rects.popper,P=r.elements[b?C:v],R=DY($h(P)?P:P.contextElement||Bd(r.elements.popper),u,d,o),O=Sp(r.elements.reference),B=Cj({reference:O,element:N,placement:a}),I=v_(Object.assign({},N,B)),z=v===ag?I:O,V={top:R.top-z.top+T.top,bottom:z.bottom-R.bottom+T.bottom,left:R.left-z.left+T.left,right:z.right-R.right+T.right},$=r.modifiersData.offset;if(v===ag&&$){var Y=$[a];Object.keys(V).forEach(function(D){var q=[Lo,Ro].indexOf(D)>=0?1:-1,G=[Ls,Ro].indexOf(D)>=0?"y":"x";V[D]+=Y[G]*q})}return V}function IY(r,e){e===void 0&&(e={});var n=e,i=n.placement,a=n.boundary,s=n.rootBoundary,o=n.padding,l=n.flipVariations,u=n.allowedAutoPlacements,c=u===void 0?vj:u,d=kp(i),p=d?l?D3:D3.filter(function(b){return kp(b)===d}):_v,v=p.filter(function(b){return c.indexOf(b)>=0});v.length===0&&(v=p);var y=v.reduce(function(b,S){return b[S]=nv(r,{placement:S,boundary:a,rootBoundary:s,padding:o})[Jl(S)],b},{});return Object.keys(y).sort(function(b,S){return y[b]-y[S]})}function BY(r){if(Jl(r)===qS)return[];var e=ey(r);return[z3(r),e,z3(e)]}function zY(r){var e=r.state,n=r.options,i=r.name;if(!e.modifiersData[i]._skip){for(var a=n.mainAxis,s=a===void 0?!0:a,o=n.altAxis,l=o===void 0?!0:o,u=n.fallbackPlacements,c=n.padding,d=n.boundary,p=n.rootBoundary,v=n.altBoundary,y=n.flipVariations,b=y===void 0?!0:y,S=n.allowedAutoPlacements,k=e.options.placement,T=Jl(k),C=T===k,N=u||(C||!b?[ey(k)]:BY(k)),P=[k].concat(N).reduce(function(he,ve){return he.concat(Jl(ve)===qS?IY(e,{placement:ve,boundary:d,rootBoundary:p,padding:c,flipVariations:b,allowedAutoPlacements:S}):ve)},[]),R=e.rects.reference,O=e.rects.popper,B=new Map,I=!0,z=P[0],V=0;V<P.length;V++){var $=P[V],Y=Jl($),D=kp($)===wp,q=[Ls,Ro].indexOf(Y)>=0,G=q?"width":"height",Z=nv(e,{placement:$,boundary:d,rootBoundary:p,altBoundary:v,padding:c}),Q=q?D?Lo:Os:D?Ro:Ls;R[G]>O[G]&&(Q=ey(Q));var J=ey(Q),ie=[];if(s&&ie.push(Z[Y]<=0),l&&ie.push(Z[Q]<=0,Z[J]<=0),ie.every(function(he){return he})){z=$,I=!1;break}B.set($,ie)}if(I)for(var ne=b?3:1,W=function(ve){var xe=P.find(function(se){var ge=B.get(se);if(ge)return ge.slice(0,ve).every(function(le){return le})});if(xe)return z=xe,"break"},re=ne;re>0;re--){var ae=W(re);if(ae==="break")break}e.placement!==z&&(e.modifiersData[i]._skip=!0,e.placement=z,e.reset=!0)}}const FY={name:"flip",enabled:!0,phase:"main",fn:zY,requiresIfExists:["offset"],data:{_skip:!1}};function V3(r,e,n){return n===void 0&&(n={x:0,y:0}),{top:r.top-e.height-n.y,right:r.right-e.width+n.x,bottom:r.bottom-e.height+n.y,left:r.left-e.width-n.x}}function U3(r){return[Ls,Lo,Ro,Os].some(function(e){return r[e]>=0})}function VY(r){var e=r.state,n=r.name,i=e.rects.reference,a=e.rects.popper,s=e.modifiersData.preventOverflow,o=nv(e,{elementContext:"reference"}),l=nv(e,{altBoundary:!0}),u=V3(o,i),c=V3(l,a,s),d=U3(u),p=U3(c);e.modifiersData[n]={referenceClippingOffsets:u,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:p},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":p})}const UY={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:VY};function HY(r,e,n){var i=Jl(r),a=[Os,Ls].indexOf(i)>=0?-1:1,s=typeof n=="function"?n(Object.assign({},e,{placement:r})):n,o=s[0],l=s[1];return o=o||0,l=(l||0)*a,[Os,Lo].indexOf(i)>=0?{x:l,y:o}:{x:o,y:l}}function GY(r){var e=r.state,n=r.options,i=r.name,a=n.offset,s=a===void 0?[0,0]:a,o=vj.reduce(function(d,p){return d[p]=HY(p,e.rects,s),d},{}),l=o[e.placement],u=l.x,c=l.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=u,e.modifiersData.popperOffsets.y+=c),e.modifiersData[i]=o}const qY={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:GY};function WY(r){var e=r.state,n=r.name;e.modifiersData[n]=Cj({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const $Y={name:"popperOffsets",enabled:!0,phase:"read",fn:WY,data:{}};function KY(r){return r==="x"?"y":"x"}function ZY(r){var e=r.state,n=r.options,i=r.name,a=n.mainAxis,s=a===void 0?!0:a,o=n.altAxis,l=o===void 0?!1:o,u=n.boundary,c=n.rootBoundary,d=n.altBoundary,p=n.padding,v=n.tether,y=v===void 0?!0:v,b=n.tetherOffset,S=b===void 0?0:b,k=nv(e,{boundary:u,rootBoundary:c,padding:p,altBoundary:d}),T=Jl(e.placement),C=kp(e.placement),N=!C,P=KS(T),R=KY(P),O=e.modifiersData.popperOffsets,B=e.rects.reference,I=e.rects.popper,z=typeof S=="function"?S(Object.assign({},e.rects,{placement:e.placement})):S,V=typeof z=="number"?{mainAxis:z,altAxis:z}:Object.assign({mainAxis:0,altAxis:0},z),$=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Y={x:0,y:0};if(O){if(s){var D,q=P==="y"?Ls:Os,G=P==="y"?Ro:Lo,Z=P==="y"?"height":"width",Q=O[P],J=Q+k[q],ie=Q-k[G],ne=y?-I[Z]/2:0,W=C===wp?B[Z]:I[Z],re=C===wp?-I[Z]:-B[Z],ae=e.elements.arrow,he=y&&ae?$S(ae):{width:0,height:0},ve=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:wj(),xe=ve[q],se=ve[G],ge=Pg(0,B[Z],he[Z]),le=N?B[Z]/2-ne-ge-xe-V.mainAxis:W-ge-xe-V.mainAxis,pe=N?-B[Z]/2+ne+ge+se+V.mainAxis:re+ge+se+V.mainAxis,me=e.elements.arrow&&Sv(e.elements.arrow),be=me?P==="y"?me.clientTop||0:me.clientLeft||0:0,Se=(D=$?.[P])!=null?D:0,Ue=Q+le-Se-be,We=Q+pe-Se,gt=Pg(y?lx(J,Ue):J,Q,y?Lh(ie,We):ie);O[P]=gt,Y[P]=gt-Q}if(l){var Je,at=P==="x"?Ls:Os,Ve=P==="x"?Ro:Lo,Oe=O[R],et=R==="y"?"height":"width",Ne=Oe+k[at],ze=Oe-k[Ve],Ke=[Ls,Os].indexOf(T)!==-1,ft=(Je=$?.[R])!=null?Je:0,yt=Ke?Ne:Oe-B[et]-I[et]-ft+V.altAxis,Et=Ke?Oe+B[et]+I[et]-ft-V.altAxis:ze,Rt=y&&Ke?xY(yt,Oe,Et):Pg(y?yt:Ne,Oe,y?Et:ze);O[R]=Rt,Y[R]=Rt-Oe}e.modifiersData[i]=Y}}const YY={name:"preventOverflow",enabled:!0,phase:"main",fn:ZY,requiresIfExists:["offset"]};function XY(r){return{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}}function QY(r){return r===Js(r)||!jo(r)?ZS(r):XY(r)}function JY(r){var e=r.getBoundingClientRect(),n=_p(e.width)/r.offsetWidth||1,i=_p(e.height)/r.offsetHeight||1;return n!==1||i!==1}function eX(r,e,n){n===void 0&&(n=!1);var i=jo(e),a=jo(e)&&JY(e),s=Bd(e),o=Sp(r,a,n),l={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!n)&&((nu(e)!=="body"||XS(s))&&(l=QY(e)),jo(e)?(u=Sp(e,!0),u.x+=e.clientLeft,u.y+=e.clientTop):s&&(u.x=YS(s))),{x:o.left+l.scrollLeft-u.x,y:o.top+l.scrollTop-u.y,width:o.width,height:o.height}}function tX(r){var e=new Map,n=new Set,i=[];r.forEach(function(s){e.set(s.name,s)});function a(s){n.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(l){if(!n.has(l)){var u=e.get(l);u&&a(u)}}),i.push(s)}return r.forEach(function(s){n.has(s.name)||a(s)}),i}function rX(r){var e=tX(r);return pY.reduce(function(n,i){return n.concat(e.filter(function(a){return a.phase===i}))},[])}function nX(r){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(r())})})),e}}function iX(r){var e=r.reduce(function(n,i){var a=n[i.name];return n[i.name]=a?Object.assign({},a,i,{options:Object.assign({},a.options,i.options),data:Object.assign({},a.data,i.data)}):i,n},{});return Object.keys(e).map(function(n){return e[n]})}var H3={placement:"bottom",modifiers:[],strategy:"absolute"};function G3(){for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];return!e.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function aX(r){r===void 0&&(r={});var e=r,n=e.defaultModifiers,i=n===void 0?[]:n,a=e.defaultOptions,s=a===void 0?H3:a;return function(l,u,c){c===void 0&&(c=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},H3,s),modifiersData:{},elements:{reference:l,popper:u},attributes:{},styles:{}},p=[],v=!1,y={state:d,setOptions:function(T){var C=typeof T=="function"?T(d.options):T;S(),d.options=Object.assign({},s,d.options,C),d.scrollParents={reference:$h(l)?Mg(l):l.contextElement?Mg(l.contextElement):[],popper:Mg(u)};var N=rX(iX([].concat(i,d.options.modifiers)));return d.orderedModifiers=N.filter(function(P){return P.enabled}),b(),y.update()},forceUpdate:function(){if(!v){var T=d.elements,C=T.reference,N=T.popper;if(G3(C,N)){d.rects={reference:eX(C,Sv(N),d.options.strategy==="fixed"),popper:$S(N)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(V){return d.modifiersData[V.name]=Object.assign({},V.data)});for(var P=0;P<d.orderedModifiers.length;P++){if(d.reset===!0){d.reset=!1,P=-1;continue}var R=d.orderedModifiers[P],O=R.fn,B=R.options,I=B===void 0?{}:B,z=R.name;typeof O=="function"&&(d=O({state:d,options:I,name:z,instance:y})||d)}}}},update:nX(function(){return new Promise(function(k){y.forceUpdate(),k(d)})}),destroy:function(){S(),v=!0}};if(!G3(l,u))return y;y.setOptions(c).then(function(k){!v&&c.onFirstUpdate&&c.onFirstUpdate(k)});function b(){d.orderedModifiers.forEach(function(k){var T=k.name,C=k.options,N=C===void 0?{}:C,P=k.effect;if(typeof P=="function"){var R=P({state:d,name:T,instance:y,options:N}),O=function(){};p.push(R||O)}})}function S(){p.forEach(function(k){return k()}),p=[]}return y}}var sX=[PY,$Y,NY,yj,qY,FY,YY,SY,UY],oX=aX({defaultModifiers:sX}),lX="tippy-box",Ej="tippy-content",uX="tippy-backdrop",Nj="tippy-arrow",Tj="tippy-svg-arrow",xh={passive:!0,capture:!0},Pj=function(){return document.body};function l2(r,e,n){if(Array.isArray(r)){var i=r[e];return i??(Array.isArray(n)?n[e]:n)}return r}function QS(r,e){var n={}.toString.call(r);return n.indexOf("[object")===0&&n.indexOf(e+"]")>-1}function Mj(r,e){return typeof r=="function"?r.apply(void 0,e):r}function q3(r,e){if(e===0)return r;var n;return function(i){clearTimeout(n),n=setTimeout(function(){r(i)},e)}}function cX(r){return r.split(/\s+/).filter(Boolean)}function Qf(r){return[].concat(r)}function W3(r,e){r.indexOf(e)===-1&&r.push(e)}function dX(r){return r.filter(function(e,n){return r.indexOf(e)===n})}function hX(r){return r.split("-")[0]}function ux(r){return[].slice.call(r)}function $3(r){return Object.keys(r).reduce(function(e,n){return r[n]!==void 0&&(e[n]=r[n]),e},{})}function Ag(){return document.createElement("div")}function Xx(r){return["Element","Fragment"].some(function(e){return QS(r,e)})}function fX(r){return QS(r,"NodeList")}function pX(r){return QS(r,"MouseEvent")}function mX(r){return!!(r&&r._tippy&&r._tippy.reference===r)}function gX(r){return Xx(r)?[r]:fX(r)?ux(r):Array.isArray(r)?r:ux(document.querySelectorAll(r))}function u2(r,e){r.forEach(function(n){n&&(n.style.transitionDuration=e+"ms")})}function K3(r,e){r.forEach(function(n){n&&n.setAttribute("data-state",e)})}function vX(r){var e,n=Qf(r),i=n[0];return i!=null&&(e=i.ownerDocument)!=null&&e.body?i.ownerDocument:document}function yX(r,e){var n=e.clientX,i=e.clientY;return r.every(function(a){var s=a.popperRect,o=a.popperState,l=a.props,u=l.interactiveBorder,c=hX(o.placement),d=o.modifiersData.offset;if(!d)return!0;var p=c==="bottom"?d.top.y:0,v=c==="top"?d.bottom.y:0,y=c==="right"?d.left.x:0,b=c==="left"?d.right.x:0,S=s.top-i+p>u,k=i-s.bottom-v>u,T=s.left-n+y>u,C=n-s.right-b>u;return S||k||T||C})}function c2(r,e,n){var i=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(a){r[i](a,n)})}function Z3(r,e){for(var n=e;n;){var i;if(r.contains(n))return!0;n=n.getRootNode==null||(i=n.getRootNode())==null?void 0:i.host}return!1}var Xl={isTouch:!1},Y3=0;function xX(){Xl.isTouch||(Xl.isTouch=!0,window.performance&&document.addEventListener("mousemove",Aj))}function Aj(){var r=performance.now();r-Y3<20&&(Xl.isTouch=!1,document.removeEventListener("mousemove",Aj)),Y3=r}function bX(){var r=document.activeElement;if(mX(r)){var e=r._tippy;r.blur&&!e.state.isVisible&&r.blur()}}function wX(){document.addEventListener("touchstart",xX,xh),window.addEventListener("blur",bX)}var _X=typeof window<"u"&&typeof document<"u",SX=_X?!!window.msCrypto:!1,kX={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},CX={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},dl=Object.assign({appendTo:Pj,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},kX,CX),EX=Object.keys(dl),NX=function(e){var n=Object.keys(e);n.forEach(function(i){dl[i]=e[i]})};function jj(r){var e=r.plugins||[],n=e.reduce(function(i,a){var s=a.name,o=a.defaultValue;if(s){var l;i[s]=r[s]!==void 0?r[s]:(l=dl[s])!=null?l:o}return i},{});return Object.assign({},r,n)}function TX(r,e){var n=e?Object.keys(jj(Object.assign({},dl,{plugins:e}))):EX,i=n.reduce(function(a,s){var o=(r.getAttribute("data-tippy-"+s)||"").trim();if(!o)return a;if(s==="content")a[s]=o;else try{a[s]=JSON.parse(o)}catch{a[s]=o}return a},{});return i}function X3(r,e){var n=Object.assign({},e,{content:Mj(e.content,[r])},e.ignoreAttributes?{}:TX(r,e.plugins));return n.aria=Object.assign({},dl.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?e.interactive:n.aria.expanded,content:n.aria.content==="auto"?e.interactive?null:"describedby":n.aria.content},n}var PX=function(){return"innerHTML"};function y_(r,e){r[PX()]=e}function Q3(r){var e=Ag();return r===!0?e.className=Nj:(e.className=Tj,Xx(r)?e.appendChild(r):y_(e,r)),e}function J3(r,e){Xx(e.content)?(y_(r,""),r.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?y_(r,e.content):r.textContent=e.content)}function x_(r){var e=r.firstElementChild,n=ux(e.children);return{box:e,content:n.find(function(i){return i.classList.contains(Ej)}),arrow:n.find(function(i){return i.classList.contains(Nj)||i.classList.contains(Tj)}),backdrop:n.find(function(i){return i.classList.contains(uX)})}}function Rj(r){var e=Ag(),n=Ag();n.className=lX,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var i=Ag();i.className=Ej,i.setAttribute("data-state","hidden"),J3(i,r.props),e.appendChild(n),n.appendChild(i),a(r.props,r.props);function a(s,o){var l=x_(e),u=l.box,c=l.content,d=l.arrow;o.theme?u.setAttribute("data-theme",o.theme):u.removeAttribute("data-theme"),typeof o.animation=="string"?u.setAttribute("data-animation",o.animation):u.removeAttribute("data-animation"),o.inertia?u.setAttribute("data-inertia",""):u.removeAttribute("data-inertia"),u.style.maxWidth=typeof o.maxWidth=="number"?o.maxWidth+"px":o.maxWidth,o.role?u.setAttribute("role",o.role):u.removeAttribute("role"),(s.content!==o.content||s.allowHTML!==o.allowHTML)&&J3(c,r.props),o.arrow?d?s.arrow!==o.arrow&&(u.removeChild(d),u.appendChild(Q3(o.arrow))):u.appendChild(Q3(o.arrow)):d&&u.removeChild(d)}return{popper:e,onUpdate:a}}Rj.$$tippy=!0;var MX=1,D0=[],d2=[];function AX(r,e){var n=X3(r,Object.assign({},dl,jj($3(e)))),i,a,s,o=!1,l=!1,u=!1,c=!1,d,p,v,y=[],b=q3(Ue,n.interactiveDebounce),S,k=MX++,T=null,C=dX(n.plugins),N={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},P={id:k,reference:r,popper:Ag(),popperInstance:T,props:n,state:N,plugins:C,clearDelayTimeouts:yt,setProps:Et,setContent:Rt,show:$t,hide:wt,hideWithInteractivity:ot,enable:Ke,disable:ft,unmount:qe,destroy:de};if(!n.render)return P;var R=n.render(P),O=R.popper,B=R.onUpdate;O.setAttribute("data-tippy-root",""),O.id="tippy-"+P.id,P.popper=O,r._tippy=P,O._tippy=P;var I=C.map(function(ye){return ye.fn(P)}),z=r.hasAttribute("aria-expanded");return me(),ne(),Q(),J("onCreate",[P]),n.showOnCreate&&Ne(),O.addEventListener("mouseenter",function(){P.props.interactive&&P.state.isVisible&&P.clearDelayTimeouts()}),O.addEventListener("mouseleave",function(){P.props.interactive&&P.props.trigger.indexOf("mouseenter")>=0&&q().addEventListener("mousemove",b)}),P;function V(){var ye=P.props.touch;return Array.isArray(ye)?ye:[ye,0]}function $(){return V()[0]==="hold"}function Y(){var ye;return!!((ye=P.props.render)!=null&&ye.$$tippy)}function D(){return S||r}function q(){var ye=D().parentNode;return ye?vX(ye):document}function G(){return x_(O)}function Z(ye){return P.state.isMounted&&!P.state.isVisible||Xl.isTouch||d&&d.type==="focus"?0:l2(P.props.delay,ye?0:1,dl.delay)}function Q(ye){ye===void 0&&(ye=!1),O.style.pointerEvents=P.props.interactive&&!ye?"":"none",O.style.zIndex=""+P.props.zIndex}function J(ye,Ce,Te){if(Te===void 0&&(Te=!0),I.forEach(function(Ze){Ze[ye]&&Ze[ye].apply(Ze,Ce)}),Te){var Re;(Re=P.props)[ye].apply(Re,Ce)}}function ie(){var ye=P.props.aria;if(ye.content){var Ce="aria-"+ye.content,Te=O.id,Re=Qf(P.props.triggerTarget||r);Re.forEach(function(Ze){var Ge=Ze.getAttribute(Ce);if(P.state.isVisible)Ze.setAttribute(Ce,Ge?Ge+" "+Te:Te);else{var ct=Ge&&Ge.replace(Te,"").trim();ct?Ze.setAttribute(Ce,ct):Ze.removeAttribute(Ce)}})}}function ne(){if(!(z||!P.props.aria.expanded)){var ye=Qf(P.props.triggerTarget||r);ye.forEach(function(Ce){P.props.interactive?Ce.setAttribute("aria-expanded",P.state.isVisible&&Ce===D()?"true":"false"):Ce.removeAttribute("aria-expanded")})}}function W(){q().removeEventListener("mousemove",b),D0=D0.filter(function(ye){return ye!==b})}function re(ye){if(!(Xl.isTouch&&(u||ye.type==="mousedown"))){var Ce=ye.composedPath&&ye.composedPath()[0]||ye.target;if(!(P.props.interactive&&Z3(O,Ce))){if(Qf(P.props.triggerTarget||r).some(function(Te){return Z3(Te,Ce)})){if(Xl.isTouch||P.state.isVisible&&P.props.trigger.indexOf("click")>=0)return}else J("onClickOutside",[P,ye]);P.props.hideOnClick===!0&&(P.clearDelayTimeouts(),P.hide(),l=!0,setTimeout(function(){l=!1}),P.state.isMounted||xe())}}}function ae(){u=!0}function he(){u=!1}function ve(){var ye=q();ye.addEventListener("mousedown",re,!0),ye.addEventListener("touchend",re,xh),ye.addEventListener("touchstart",he,xh),ye.addEventListener("touchmove",ae,xh)}function xe(){var ye=q();ye.removeEventListener("mousedown",re,!0),ye.removeEventListener("touchend",re,xh),ye.removeEventListener("touchstart",he,xh),ye.removeEventListener("touchmove",ae,xh)}function se(ye,Ce){le(ye,function(){!P.state.isVisible&&O.parentNode&&O.parentNode.contains(O)&&Ce()})}function ge(ye,Ce){le(ye,Ce)}function le(ye,Ce){var Te=G().box;function Re(Ze){Ze.target===Te&&(c2(Te,"remove",Re),Ce())}if(ye===0)return Ce();c2(Te,"remove",p),c2(Te,"add",Re),p=Re}function pe(ye,Ce,Te){Te===void 0&&(Te=!1);var Re=Qf(P.props.triggerTarget||r);Re.forEach(function(Ze){Ze.addEventListener(ye,Ce,Te),y.push({node:Ze,eventType:ye,handler:Ce,options:Te})})}function me(){$()&&(pe("touchstart",Se,{passive:!0}),pe("touchend",We,{passive:!0})),cX(P.props.trigger).forEach(function(ye){if(ye!=="manual")switch(pe(ye,Se),ye){case"mouseenter":pe("mouseleave",We);break;case"focus":pe(SX?"focusout":"blur",gt);break;case"focusin":pe("focusout",gt);break}})}function be(){y.forEach(function(ye){var Ce=ye.node,Te=ye.eventType,Re=ye.handler,Ze=ye.options;Ce.removeEventListener(Te,Re,Ze)}),y=[]}function Se(ye){var Ce,Te=!1;if(!(!P.state.isEnabled||Je(ye)||l)){var Re=((Ce=d)==null?void 0:Ce.type)==="focus";d=ye,S=ye.currentTarget,ne(),!P.state.isVisible&&pX(ye)&&D0.forEach(function(Ze){return Ze(ye)}),ye.type==="click"&&(P.props.trigger.indexOf("mouseenter")<0||o)&&P.props.hideOnClick!==!1&&P.state.isVisible?Te=!0:Ne(ye),ye.type==="click"&&(o=!Te),Te&&!Re&&ze(ye)}}function Ue(ye){var Ce=ye.target,Te=D().contains(Ce)||O.contains(Ce);if(!(ye.type==="mousemove"&&Te)){var Re=et().concat(O).map(function(Ze){var Ge,ct=Ze._tippy,ut=(Ge=ct.popperInstance)==null?void 0:Ge.state;return ut?{popperRect:Ze.getBoundingClientRect(),popperState:ut,props:n}:null}).filter(Boolean);yX(Re,ye)&&(W(),ze(ye))}}function We(ye){var Ce=Je(ye)||P.props.trigger.indexOf("click")>=0&&o;if(!Ce){if(P.props.interactive){P.hideWithInteractivity(ye);return}ze(ye)}}function gt(ye){P.props.trigger.indexOf("focusin")<0&&ye.target!==D()||P.props.interactive&&ye.relatedTarget&&O.contains(ye.relatedTarget)||ze(ye)}function Je(ye){return Xl.isTouch?$()!==ye.type.indexOf("touch")>=0:!1}function at(){Ve();var ye=P.props,Ce=ye.popperOptions,Te=ye.placement,Re=ye.offset,Ze=ye.getReferenceClientRect,Ge=ye.moveTransition,ct=Y()?x_(O).arrow:null,ut=Ze?{getBoundingClientRect:Ze,contextElement:Ze.contextElement||D()}:r,kt={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(xt){var Gt=xt.state;if(Y()){var Wt=G(),kr=Wt.box;["placement","reference-hidden","escaped"].forEach(function(pr){pr==="placement"?kr.setAttribute("data-placement",Gt.placement):Gt.attributes.popper["data-popper-"+pr]?kr.setAttribute("data-"+pr,""):kr.removeAttribute("data-"+pr)}),Gt.attributes.popper={}}}},zt=[{name:"offset",options:{offset:Re}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Ge}},kt];Y()&&ct&&zt.push({name:"arrow",options:{element:ct,padding:3}}),zt.push.apply(zt,Ce?.modifiers||[]),P.popperInstance=oX(ut,O,Object.assign({},Ce,{placement:Te,onFirstUpdate:v,modifiers:zt}))}function Ve(){P.popperInstance&&(P.popperInstance.destroy(),P.popperInstance=null)}function Oe(){var ye=P.props.appendTo,Ce,Te=D();P.props.interactive&&ye===Pj||ye==="parent"?Ce=Te.parentNode:Ce=Mj(ye,[Te]),Ce.contains(O)||Ce.appendChild(O),P.state.isMounted=!0,at()}function et(){return ux(O.querySelectorAll("[data-tippy-root]"))}function Ne(ye){P.clearDelayTimeouts(),ye&&J("onTrigger",[P,ye]),ve();var Ce=Z(!0),Te=V(),Re=Te[0],Ze=Te[1];Xl.isTouch&&Re==="hold"&&Ze&&(Ce=Ze),Ce?i=setTimeout(function(){P.show()},Ce):P.show()}function ze(ye){if(P.clearDelayTimeouts(),J("onUntrigger",[P,ye]),!P.state.isVisible){xe();return}if(!(P.props.trigger.indexOf("mouseenter")>=0&&P.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(ye.type)>=0&&o)){var Ce=Z(!1);Ce?a=setTimeout(function(){P.state.isVisible&&P.hide()},Ce):s=requestAnimationFrame(function(){P.hide()})}}function Ke(){P.state.isEnabled=!0}function ft(){P.hide(),P.state.isEnabled=!1}function yt(){clearTimeout(i),clearTimeout(a),cancelAnimationFrame(s)}function Et(ye){if(!P.state.isDestroyed){J("onBeforeUpdate",[P,ye]),be();var Ce=P.props,Te=X3(r,Object.assign({},Ce,$3(ye),{ignoreAttributes:!0}));P.props=Te,me(),Ce.interactiveDebounce!==Te.interactiveDebounce&&(W(),b=q3(Ue,Te.interactiveDebounce)),Ce.triggerTarget&&!Te.triggerTarget?Qf(Ce.triggerTarget).forEach(function(Re){Re.removeAttribute("aria-expanded")}):Te.triggerTarget&&r.removeAttribute("aria-expanded"),ne(),Q(),B&&B(Ce,Te),P.popperInstance&&(at(),et().forEach(function(Re){requestAnimationFrame(Re._tippy.popperInstance.forceUpdate)})),J("onAfterUpdate",[P,ye])}}function Rt(ye){P.setProps({content:ye})}function $t(){var ye=P.state.isVisible,Ce=P.state.isDestroyed,Te=!P.state.isEnabled,Re=Xl.isTouch&&!P.props.touch,Ze=l2(P.props.duration,0,dl.duration);if(!(ye||Ce||Te||Re)&&!D().hasAttribute("disabled")&&(J("onShow",[P],!1),P.props.onShow(P)!==!1)){if(P.state.isVisible=!0,Y()&&(O.style.visibility="visible"),Q(),ve(),P.state.isMounted||(O.style.transition="none"),Y()){var Ge=G(),ct=Ge.box,ut=Ge.content;u2([ct,ut],0)}v=function(){var zt;if(!(!P.state.isVisible||c)){if(c=!0,O.offsetHeight,O.style.transition=P.props.moveTransition,Y()&&P.props.animation){var Ft=G(),xt=Ft.box,Gt=Ft.content;u2([xt,Gt],Ze),K3([xt,Gt],"visible")}ie(),ne(),W3(d2,P),(zt=P.popperInstance)==null||zt.forceUpdate(),J("onMount",[P]),P.props.animation&&Y()&&ge(Ze,function(){P.state.isShown=!0,J("onShown",[P])})}},Oe()}}function wt(){var ye=!P.state.isVisible,Ce=P.state.isDestroyed,Te=!P.state.isEnabled,Re=l2(P.props.duration,1,dl.duration);if(!(ye||Ce||Te)&&(J("onHide",[P],!1),P.props.onHide(P)!==!1)){if(P.state.isVisible=!1,P.state.isShown=!1,c=!1,o=!1,Y()&&(O.style.visibility="hidden"),W(),xe(),Q(!0),Y()){var Ze=G(),Ge=Ze.box,ct=Ze.content;P.props.animation&&(u2([Ge,ct],Re),K3([Ge,ct],"hidden"))}ie(),ne(),P.props.animation?Y()&&se(Re,P.unmount):P.unmount()}}function ot(ye){q().addEventListener("mousemove",b),W3(D0,b),b(ye)}function qe(){P.state.isVisible&&P.hide(),P.state.isMounted&&(Ve(),et().forEach(function(ye){ye._tippy.unmount()}),O.parentNode&&O.parentNode.removeChild(O),d2=d2.filter(function(ye){return ye!==P}),P.state.isMounted=!1,J("onHidden",[P]))}function de(){P.state.isDestroyed||(P.clearDelayTimeouts(),P.unmount(),be(),delete r._tippy,P.state.isDestroyed=!0,J("onDestroy",[P]))}}function kv(r,e){e===void 0&&(e={});var n=dl.plugins.concat(e.plugins||[]);wX();var i=Object.assign({},e,{plugins:n}),a=gX(r),s=a.reduce(function(o,l){var u=l&&AX(l,i);return u&&o.push(u),o},[]);return Xx(r)?s[0]:s}kv.defaultProps=dl;kv.setDefaultProps=NX;kv.currentInput=Xl;Object.assign({},yj,{effect:function(e){var n=e.state,i={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,i.popper),n.styles=i,n.elements.arrow&&Object.assign(n.elements.arrow.style,i.arrow)}});kv.setDefaultProps({render:Rj});const jX=ce.forwardRef((r,e)=>{const[n,i]=ce.useState(0),a=u=>{const c=r.items[u];c&&r.command({id:c.id,label:c.label})},s=()=>{i((n+r.items.length-1)%r.items.length)},o=()=>{i((n+1)%r.items.length)},l=()=>{a(n)};return ce.useEffect(()=>i(0),[r.items]),ce.useImperativeHandle(e,()=>({onKeyDown:({event:u})=>u.key==="ArrowUp"?(s(),!0):u.key==="ArrowDown"?(o(),!0):u.key==="Enter"?(l(),!0):!1})),m.jsx("div",{className:"items bg-white border border-slate-200 rounded-xl shadow-2xl overflow-hidden min-w-[200px] p-2 animate-in zoom-in-95 duration-200",children:r.items.length?r.items.map((u,c)=>m.jsxs("button",{className:`flex w-full items-center text-xs px-4 py-2.5 rounded-lg outline-none text-left transition-all ${c===n?"bg-primary text-white shadow-lg":"text-slate-700 hover:bg-slate-50"}`,onClick:()=>a(c),children:[m.jsx("span",{className:"material-symbols-outlined text-[14px] mr-2 opacity-50",children:"auto_stories"}),m.jsx("span",{className:"font-serif font-bold",children:u.label})]},c)):m.jsx("div",{className:"item text-sm px-2 py-1.5 text-muted-foreground",children:"No result"})})}),RX={items:async({query:r})=>{try{return(await rt.get("/world-bible/entities")).filter(n=>n.nombre.toLowerCase().startsWith(r.toLowerCase())).slice(0,5).map(n=>({id:n.id,label:n.nombre}))}catch(e){return console.error(e),[]}},render:()=>{let r,e;return{onStart:n=>{r=new fK(jX,{props:n,editor:n.editor}),n.clientRect&&(e=kv("body",{getReferenceClientRect:n.clientRect,appendTo:()=>document.body,content:r.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(n){r.updateProps(n),n.clientRect&&e[0].setProps({getReferenceClientRect:n.clientRect})},onKeyDown(n){return n.event.key==="Escape"?(e[0].hide(),!0):r.ref?.onKeyDown(n)},onExit(){e[0].destroy(),r.destroy()}}}},LX=({content:r,onUpdate:e,editable:n=!0,paperMode:i=!1})=>{const[a,s]=Xt.useState({font:"Cormorant Garamond",fontSize:18});Xt.useEffect(()=>{const l=localStorage.getItem("app_settings");l&&s(JSON.parse(l))},[]);const o=sK({extensions:[ZZ,YZ.configure({placeholder:"Escribe tu historia aqu... Usa @ para mencionar entidades."}),rY.configure({HTMLAttributes:{class:"mention"},suggestion:RX})],content:r,editable:n,onUpdate:({editor:l})=>{e(l.getHTML())},editorProps:{attributes:{class:`prose ${i?"prose-slate":"prose-invert"} max-w-none focus:outline-none min-h-[300px] p-8 ${i?"text-slate-900":"text-foreground/90"} leading-relaxed text-lg transition-all`,style:`font-family: "${a.font}", serif; font-size: ${a.fontSize}px;`}}});return ce.useEffect(()=>{o&&r!==o.getHTML()&&o.commands.setContent(r)},[r,o]),o?m.jsx("div",{className:`zen-editor-container w-full h-full overflow-y-auto no-scrollbar ${i?"bg-transparent border-none shadow-none":"bg-card/20 rounded-lg border border-border/50"}`,children:m.jsx(J$,{editor:o,className:"h-full"})}):null},OX=()=>{const{notebookId:r}=Yi(),e=Na(),{setRightPanelMode:n,setRightOpen:i,setRightPanelTitle:a}=au(),{t:s}=Xu(),[o,l]=ce.useState(null),[u,c]=ce.useState([]),[d,p]=ce.useState(0),[v,y]=ce.useState(!1),[b,S]=ce.useState(!0),k=ce.useRef(null),[T,C]=ce.useState(null),[N,P]=ce.useState("index");ce.useEffect(()=>{n("CUSTOM"),i(!0),a(s("writing.tools")),r&&R(r)},[r]),ce.useEffect(()=>{const D=setInterval(()=>{const q=document.getElementById("architect-right-panel-portal");q&&(C(q),clearInterval(D))},100);return()=>clearInterval(D)},[]);const R=async D=>{try{S(!0);const q=await rt.get(`/escritura/cuaderno/${D}`);l(q);const G=await rt.get(`/escritura/cuaderno/${D}/hojas`);if(G&&G.length>0)c(G),p(0);else{const Z=await rt.post(`/escritura/cuaderno/${D}/hoja`,{});c([Z]),p(0)}}catch(q){console.error("Error loading notebook/pages:",q),e(-1)}finally{S(!1)}},O=D=>{if(!u[d])return;const q=[...u];q[d].contenido=D,c(q),k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{B(q[d])},1500)},B=async D=>{y(!0);try{await rt.put(`/escritura/hoja/${D.id}`,{contenido:D.contenido})}catch(q){console.error("Error saving page:",q)}finally{y(!1)}},I=async()=>{if(o)try{const D=await rt.post(`/escritura/cuaderno/${o.id}/hoja`,{});c([...u,D]),p(u.length)}catch(D){console.error("Error creating page:",D)}},z=D=>{p(D)},V=async(D,q,G)=>{if(D.stopPropagation(),u.length<=1){alert(s("writing.one_page_error"));return}if(window.confirm(s("writing.delete_page_confirm")))try{await rt.delete(`/escritura/hoja/${q}`);const Z=u.filter(Q=>Q.id!==q);c(Z),d===G?p(Math.max(0,G-1)):d>G&&p(d-1)}catch(Z){console.error("Error deleting page:",Z)}},$=()=>m.jsxs("div",{className:"flex flex-col h-full bg-surface-dark/95",children:[m.jsxs("div",{className:"p-4 border-b border-white/5 flex items-center justify-between bg-black/40",children:[m.jsxs("button",{onClick:()=>e(`/${Yi().username}/${Yi().projectName}/writing`),className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"}),m.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:s("nav.writing")})]}),m.jsx("div",{className:`w-2 h-2 rounded-full ${v?"bg-amber-500 animate-pulse":"bg-emerald-500/50"}`,title:s(v?"common.saving":"common.saved")})]}),m.jsxs("div",{className:"flex p-2 gap-2 border-b border-white/5 bg-black/20",children:[m.jsx("button",{onClick:()=>P("index"),className:`flex-1 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${N==="index"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:s("writing.index")}),m.jsx("button",{onClick:()=>P("format"),className:`flex-1 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${N==="format"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-white"}`,children:s("writing.format")})]}),m.jsx("div",{className:"flex-1 overflow-hidden",children:N==="index"?m.jsxs("div",{className:"flex flex-col h-full",children:[m.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2 custom-scrollbar",children:u.map((D,q)=>m.jsxs("div",{className:"group relative",children:[m.jsxs("button",{onClick:()=>z(q),className:`w-full text-left p-4 rounded-2xl border transition-all ${q===d?"bg-primary/10 border-primary/30 text-primary":"bg-white/5 border-transparent hover:bg-white/10 text-slate-400"}`,children:[m.jsxs("div",{className:"flex justify-between items-center mb-1",children:[m.jsxs("span",{className:"font-serif font-bold text-sm truncate",children:[s("writing.page")," ",q+1]}),q===d&&m.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-primary shrink-0 ml-2"})]}),m.jsx("p",{className:"text-[10px] line-clamp-2 opacity-50 font-mono break-words leading-relaxed",children:D.contenido?.replace(/<[^>]+>/g,"").substring(0,40)||s("writing.empty")})]}),m.jsx("button",{onClick:G=>V(G,D.id,q),className:"absolute top-2 right-2 p-1.5 rounded-lg text-slate-600 hover:text-red-400 hover:bg-red-400/10 transition-all opacity-0 group-hover:opacity-100",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},D.id))}),m.jsx("div",{className:"p-4 bg-black/20 border-t border-white/5",children:m.jsxs("button",{onClick:I,className:"w-full py-3 bg-primary text-white rounded-2xl text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-all hover:scale-[1.02] shadow-xl shadow-primary/20",children:[m.jsx("span",{className:"material-symbols-outlined text-base",children:"add"}),m.jsx("span",{children:s("writing.new_page")})]})})]}):m.jsx("div",{className:"p-6 space-y-8 animate-in fade-in slide-in-from-right-4",children:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"format_size"})," ",s("writing.typography")]}),m.jsx("div",{className:"grid grid-cols-1 gap-2",children:m.jsx("p",{className:"text-[9px] text-slate-600 uppercase font-bold italic",children:s("writing.typography_desc")})})]})})})]}),Y=u[d];return b?m.jsx("div",{className:"flex-1 flex items-center justify-center bg-background-dark",children:m.jsx("div",{className:"animate-pulse text-slate-500 font-serif text-2xl italic tracking-widest",children:s("writing.opening_chronicle")})}):m.jsxs("div",{className:"flex-1 flex w-full h-full bg-background-dark relative overflow-hidden font-sans",children:[T&&iu.createPortal($(),T),m.jsx("div",{className:"flex-1 flex flex-col relative z-10 overflow-hidden",children:m.jsx("main",{className:"flex-1 overflow-y-auto custom-scrollbar flex justify-center bg-transparent relative no-scrollbar",children:Y&&m.jsx("div",{className:"w-full min-h-full flex flex-col animate-in slide-in-from-bottom-8 duration-700",children:m.jsxs("div",{className:"flex-1 bg-white overflow-hidden flex flex-col transition-all duration-500 group",children:[m.jsx("div",{className:"h-24 flex items-end px-16 pb-4 border-b border-slate-50",children:m.jsx("input",{type:"text",className:"w-full bg-transparent text-4xl font-serif font-black text-slate-800 placeholder:text-slate-100 border-none outline-none",defaultValue:`${s("writing.chapter")} ${d+1}`,placeholder:s("writing.title_placeholder")})}),m.jsx("div",{className:"flex-1 px-16 py-12 text-slate-900",children:m.jsx(LX,{content:Y.contenido,onUpdate:O,paperMode:!0})}),m.jsxs("footer",{className:"h-16 border-t border-slate-100 flex items-center justify-between px-16 text-[10px] font-mono text-slate-400 select-none",children:[m.jsxs("span",{children:[s("writing.page").toUpperCase()," ",d+1," ",s("writing.of")," ",u.length]}),m.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity uppercase font-black tracking-widest",children:o?.titulo||s("common.no_results")})]})]})})})})]})},DX=()=>{const{username:r,projectName:e}=Yi(),n=Na(),{t:i}=Xu(),{setRightPanelMode:a,setRightOpen:s,setRightPanelTitle:o}=au(),[l,u]=ce.useState([]),[c,d]=ce.useState(!0),[p,v]=ce.useState(!1),[y,b]=ce.useState("");ce.useEffect(()=>{a("NOTES"),s(!1),o(i("writing.library")),S()},[]);const S=async()=>{try{d(!0);const C=await rt.get("/escritura/cuadernos");u(C||[])}catch(C){console.error("Error loading notebooks:",C)}finally{d(!1)}},k=async C=>{C.preventDefault();try{const N=await rt.post("/escritura/cuaderno",{titulo:y||i("writing.new_notebook")});u([...l,N]),v(!1),b(""),n(`/${r}/${e}/writing/${N.id}`)}catch(N){console.error("Error creating notebook:",N)}},T=async(C,N)=>{if(C.stopPropagation(),!!window.confirm(i("writing.delete_confirm")))try{await rt.delete(`/escritura/cuaderno/${N}`),u(l.filter(P=>P.id!==N))}catch(P){console.error("Error deleting notebook:",P)}};return c?m.jsx("div",{className:"flex-1 flex items-center justify-center bg-background-dark",children:m.jsx("div",{className:"animate-spin text-primary material-symbols-outlined text-4xl",children:"sync"})}):m.jsxs("div",{className:"flex-1 flex flex-col bg-background-dark overflow-y-auto no-scrollbar p-12",children:[m.jsxs("header",{className:"mb-12 flex justify-between items-end",children:[m.jsxs("div",{children:[m.jsx("h1",{className:"text-4xl font-serif font-bold text-white mb-2",children:i("writing.library")}),m.jsx("p",{className:"text-slate-500 uppercase text-[10px] font-black tracking-[0.2em]",children:i("writing.library_desc")})]}),m.jsx("button",{onClick:()=>v(!0),className:"group relative px-6 py-3 bg-primary/10 hover:bg-primary/20 border border-primary/30 rounded-2xl transition-all overflow-hidden",children:m.jsxs("div",{className:"flex items-center gap-2 text-primary",children:[m.jsx("span",{className:"material-symbols-outlined text-sm transition-transform group-hover:rotate-90",children:"add"}),m.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:i("writing.new_notebook")})]})})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:l.map(C=>m.jsxs("div",{onClick:()=>n(`/${r}/${e}/writing/${C.id}`),className:"group relative h-64 bg-surface-dark border border-white/5 rounded-3xl p-6 cursor-pointer hover:border-primary/50 hover:bg-white/[0.02] transition-all hover:-translate-y-2 flex flex-col justify-between overflow-hidden shadow-2xl",children:[m.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1.5 bg-primary/40 group-hover:bg-primary transition-colors"}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsx("div",{className:"size-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary group-hover:scale-110 transition-transform",children:m.jsx("span",{className:"material-symbols-outlined",children:"folder_open"})}),m.jsx("button",{onClick:N=>T(N,C.id),className:"p-1.5 rounded-lg text-slate-600 hover:text-red-400 hover:bg-red-400/10 transition-all opacity-0 group-hover:opacity-100",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-serif font-bold text-slate-100 group-hover:text-primary transition-colors line-clamp-2",children:C.titulo||i("common.no_results")}),m.jsxs("p",{className:"text-[10px] text-slate-500 font-mono mt-1",children:["ID: #",C.id]})]})]}),m.jsxs("div",{className:"flex items-center gap-2 pt-4 border-t border-white/5 opacity-50 group-hover:opacity-100 transition-opacity",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"auto_stories"}),m.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:i("writing.open_archivador")})]})]},C.id))}),p&&m.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",children:m.jsxs("div",{className:"bg-surface-dark border border-white/10 rounded-[2rem] p-10 w-full max-w-lg shadow-2xl animate-in zoom-in-95 duration-300",children:[m.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[m.jsx("div",{className:"size-12 rounded-2xl bg-primary flex items-center justify-center text-white shadow-xl shadow-primary/30",children:m.jsx("span",{className:"material-symbols-outlined",children:"create_new_folder"})}),m.jsxs("div",{children:[m.jsx("h2",{className:"text-2xl font-serif font-bold text-white",children:"New Archivador"}),m.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-widest",children:"Library Expansion"})]})]}),m.jsxs("form",{onSubmit:k,className:"space-y-6",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"text-[10px] uppercase font-black text-slate-500 tracking-[0.2em] ml-2",children:"Book Title"}),m.jsx("input",{autoFocus:!0,className:"w-full bg-white/5 border border-white/10 rounded-2xl px-6 py-4 text-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all placeholder:text-slate-700",placeholder:"The Chronicles of Void...",value:y,onChange:C=>b(C.target.value),required:!0})]}),m.jsxs("div",{className:"flex gap-4 pt-4",children:[m.jsx("button",{type:"button",onClick:()=>v(!1),className:"flex-1 py-4 text-slate-400 hover:text-white font-black uppercase text-[10px] tracking-widest transition-colors",children:"Cancel"}),m.jsx("button",{type:"submit",className:"flex-[2] py-4 bg-primary hover:bg-primary-dark text-white rounded-2xl font-black uppercase text-[10px] tracking-widest shadow-xl shadow-primary/20 hover:scale-[1.02] active:scale-95 transition-all",children:"Create and Open"})]})]})]})})]})};function IX(){const{id:r}=Yi();Na();const[e,n]=ce.useState([]),[i,a]=ce.useState(!0),[s,o]=ce.useState(null);ce.useEffect(()=>{l()},[r]);const l=async()=>{try{a(!0);const d=await rt.get("/api/papelera/items");n(d),o(null)}catch(d){console.error("Error loading trash:",d),o("Failed to load trash items.")}finally{a(!1)}},u=async(d,p)=>{try{await rt.post(`/api/papelera/restaurar/${d}/${p}`),l()}catch(v){console.error("Restoration failed",v)}},c=async(d,p)=>{if(window.confirm("Are you sure you want to PERMANENTLY delete this item? This cannot be undone."))try{await rt.delete(`/api/papelera/eliminar/${d}/${p}`),l()}catch(v){console.error("Deletion failed",v)}};return i?m.jsx("div",{className:"text-white p-8",children:"Loading Trash Bin..."}):m.jsxs("div",{className:"flex flex-col h-full bg-[#09090b] text-white p-8 overflow-y-auto",children:[m.jsx("h1",{className:"text-3xl font-light mb-2 text-white/90",children:"Trash Bin"}),m.jsx("p",{className:"text-white/50 mb-8 font-light text-sm",children:"Items are automatically deleted after 30 days."}),s&&m.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 p-4 rounded mb-6",children:s}),e.length===0?m.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-50 border border-dashed border-white/10 rounded-xl",children:[m.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"delete_outline"}),m.jsx("p",{children:"Trash is empty"})]}):m.jsx("div",{className:"bg-zinc-900/50 rounded-xl border border-white/5 overflow-hidden",children:m.jsxs("table",{className:"w-full text-left border-collapse",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"border-b border-white/5 text-xs text-white/40 uppercase tracking-wider",children:[m.jsx("th",{className:"p-4 font-normal",children:"Name"}),m.jsx("th",{className:"p-4 font-normal",children:"Type"}),m.jsx("th",{className:"p-4 font-normal",children:"Deleted Date"}),m.jsx("th",{className:"p-4 font-normal text-right",children:"Actions"})]})}),m.jsx("tbody",{className:"divide-y divide-white/5",children:e.map(d=>m.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[m.jsx("td",{className:"p-4 text-white/80 font-medium",children:d.nombre||"Untitled"}),m.jsx("td",{className:"p-4 text-white/50 text-sm",children:d.tipo}),m.jsx("td",{className:"p-4 text-white/50 text-sm font-mono",children:d.deleted_date?new Date(d.deleted_date).toLocaleDateString():"-"}),m.jsxs("td",{className:"p-4 text-right space-x-2",children:[m.jsx("button",{onClick:()=>u(d.tipo,d.id),className:"px-3 py-1.5 text-xs bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20 rounded-md transition-colors border border-emerald-500/20",children:"RESTORE"}),m.jsx("button",{onClick:()=>c(d.tipo,d.id),className:"px-3 py-1.5 text-xs bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-md transition-colors border border-red-500/20",children:"DELETE"})]})]},`${d.tipo}-${d.id}`))})]})})]})}const BX=({attribute:r,value:e,onChange:n,onRemove:i,linkableEntities:a=[]})=>{const s=r.plantilla||r,o=()=>{switch(s.tipo){case"text":return m.jsx("textarea",{className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none resize-none no-scrollbar h-auto min-h-[100px]",value:e||"",onChange:v=>n(v.target.value),placeholder:"..."});case"short_text":return m.jsx("input",{type:"text",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none",value:e||"",onChange:v=>n(v.target.value),placeholder:"..."});case"number":return m.jsx("input",{type:"number",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none",value:e||"",onChange:v=>n(v.target.value)});case"boolean":return m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("button",{onClick:()=>n(e==="true"?"false":"true"),className:`size-6 rounded-lg border flex items-center justify-center transition-all ${e==="true"?"bg-primary border-primary text-white":"border-glass-border text-transparent hover:border-primary/50"}`,children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"check"})}),m.jsx("span",{className:"text-xs text-text-muted",children:e==="true"?"Enabled":"Disabled"})]});case"select":let l=[];try{l=(typeof s.metadata=="string"?JSON.parse(s.metadata||"{}"):s.metadata||{}).options||[]}catch{}return m.jsxs("div",{className:"relative",children:[m.jsxs("select",{className:"w-full bg-black/30 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-primary/50 appearance-none cursor-pointer",value:e||"",onChange:v=>n(v.target.value),children:[m.jsx("option",{value:"",children:"Select an option..."}),l.map((v,y)=>m.jsx("option",{value:v,className:"bg-surface-dark text-white p-2",children:v},y))]}),m.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/50",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"unfold_more"})})]});case"multi_select":let u=[];try{u=(typeof s.metadata=="string"?JSON.parse(s.metadata||"{}"):s.metadata||{}).options||[]}catch{}let c=[];try{c=e?JSON.parse(e):[],Array.isArray(c)||(c=[])}catch(v){console.error("Error parsing select values",v)}const d=v=>{const y=c.includes(v)?c.filter(b=>b!==v):[...c,v];n(JSON.stringify(y))};return m.jsxs("div",{className:"bg-black/20 border border-white/5 rounded-xl p-2 space-y-1 max-h-40 overflow-y-auto custom-scrollbar",children:[u.map((v,y)=>m.jsxs("label",{onClick:b=>{b.preventDefault(),d(v)},className:"flex items-center gap-3 p-2 hover:bg-white/5 rounded-lg cursor-pointer group transition-colors",children:[m.jsx("div",{className:`size-4 rounded border flex items-center justify-center transition-all ${c.includes(v)?"bg-primary border-primary":"border-white/10 group-hover:border-white/30"}`,children:c.includes(v)&&m.jsx("span",{className:"material-symbols-outlined text-[10px] text-white",children:"check"})}),m.jsx("span",{className:`text-xs font-medium ${c.includes(v)?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:v})]},y)),u.length===0&&m.jsx("div",{className:"text-xs text-slate-500 p-2 italic",children:"No options defined."})]});case"date":return m.jsx("input",{type:"date",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none [color-scheme:dark]",value:e||"",onChange:v=>n(v.target.value)});case"entity_link":return m.jsxs("div",{className:"relative",children:[m.jsxs("select",{className:"w-full bg-black/30 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-primary/50 appearance-none cursor-pointer",value:e||"",onChange:v=>n(v.target.value),children:[m.jsx("option",{value:"",children:"Select an Entity Link..."}),a.map(v=>m.jsx("option",{value:v.id,className:"bg-surface-dark text-white p-2",children:v.nombre},v.id))]}),m.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/50",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"link"})})]});case"image":return m.jsxs("div",{className:"space-y-2",children:[m.jsx("div",{className:"flex gap-2",children:m.jsx("input",{type:"text",className:"flex-1 bg-black/30 border border-white/5 rounded-xl px-4 py-2 text-xs text-text-muted focus:text-white focus:outline-none",placeholder:"Image URL...",value:e||"",onChange:v=>n(v.target.value)})}),e&&m.jsx("div",{className:"w-full aspect-video rounded-xl bg-black/40 border border-white/5 overflow-hidden relative group",children:m.jsx("img",{src:e,alt:"Preview",className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"})}),!e&&m.jsx("div",{className:"w-full h-20 rounded-xl bg-white/5 border border-dashed border-white/10 flex items-center justify-center text-text-muted/30",children:m.jsx("span",{className:"material-symbols-outlined",children:"image"})})]});case"table":const p=e||"[]";return m.jsxs("div",{className:"space-y-2",children:[m.jsx("textarea",{className:"w-full h-32 bg-black/30 border border-white/5 rounded-xl p-3 text-xs font-mono text-white/70 focus:outline-none focus:border-primary/50",value:p,onChange:v=>n(v.target.value),placeholder:'[{"Item": "Sword", "Qty": 1}, ...]'}),m.jsxs("div",{className:"text-[10px] text-text-muted flex justify-between",children:[m.jsx("span",{children:"JSON Format supported"}),m.jsx("span",{className:"material-symbols-outlined text-xs",children:"data_array"})]})]});default:return m.jsxs("div",{className:"text-sm font-medium text-white/70 italic p-2 rounded-lg bg-white/5 border border-white/5",children:[m.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 mr-2",children:s.tipo}),e]})}};return m.jsxs("div",{className:"p-4 border border-white/5 rounded-2xl bg-surface-dark/50 backdrop-blur-sm relative overflow-hidden h-full flex flex-col group hover:border-primary/20 transition-all",children:[m.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted mb-3 flex items-center justify-between gap-2",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-xs opacity-50",children:"label"}),s.nombre]}),i&&m.jsx("button",{onClick:l=>{l.preventDefault(),i()},className:"text-white/20 hover:text-red-400 transition-colors",title:"Remove Attribute",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]}),m.jsx("div",{className:"flex-1 nodrag",children:o()}),m.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"})]})},zX=[{value:"Individual",label:"Personaje"},{value:"Group",label:"Grupo/Faccin"},{value:"Location",label:"Lugar"},{value:"Item",label:"Objeto"},{value:"Event",label:"Evento"},{value:"Timeline",label:"Lnea de Tiempo"},{value:"Map",label:"Mapa"},{value:"Structure",label:"Construccin"},{value:"Creature",label:"Criatura"},{value:"Plant",label:"Flora"}],FX=({entityId:r,entityType:e})=>{console.log(">>> RELATIONSHIP MANAGER V2 LOADED");const[n,i]=ce.useState([]),[a,s]=ce.useState(!1),[o,l]=ce.useState(!1),[u,c]=ce.useState("Individual"),[d,p]=ce.useState([]),[v,y]=ce.useState(""),[b,S]=ce.useState(""),[k,T]=ce.useState(""),[C,N]=ce.useState(!1);ce.useEffect(()=>{r&&P()},[r,e]),ce.useEffect(()=>{o&&u&&R(u)},[o,u]);const P=async()=>{s(!0);try{const V=(await rt.get("/bd/relacion")).filter(Y=>Y.nodoOrigenId===parseInt(r)&&(Y.tipoOrigen===e||Y.tipoOrigen==="GenericEntity")||Y.nodoDestinoId===parseInt(r)&&(Y.tipoDestino===e||Y.tipoDestino==="GenericEntity")),$=await Promise.all(V.map(async Y=>{const D=Y.nodoOrigenId===parseInt(r),q=D?Y.nodoDestinoId:Y.nodoOrigenId,G=await rt.get(`/world-bible/entities/${q}`);if(!G)throw new Error(`Entity ${q} not found`);return{...Y,otherName:G.nombre,otherType:G.categoria||"Entity",isOutgoing:D}}));i($)}catch(z){console.error("Failed to load relationships",z)}finally{s(!1)}},R=async z=>{N(!0);try{const $=(await rt.get("/world-bible/entities")).filter(Y=>(Y.categoria||"Generic").toLowerCase()===z.toLowerCase()||Y.tipoEspecial&&Y.tipoEspecial.toLowerCase()===z.toLowerCase());p($||[])}catch(V){console.error("Failed to fetch targets",V),p([])}finally{N(!1)}},O=async()=>{if(!(!v||!b))try{const z={nodoOrigenId:parseInt(r),tipoOrigen:e,nodoDestinoId:parseInt(v),tipoDestino:"GenericEntity",tipoRelacion:b,descripcion:k,metadata:JSON.stringify({originalCategory:u}),tipoEntidad:"relacion"};await rt.put("/bd/insertar",z),l(!1),I(),P()}catch(z){console.error("Failed to save relationship",z),alert("Error saving relationship")}},B=async z=>{if(confirm("Are you sure?"))try{await rt.delete(`/bd/relacion/${z}`),P()}catch(V){console.error("Failed to delete",V)}},I=()=>{c("Individual"),y(""),S(""),T("")};return m.jsxs("div",{className:"p-6 space-y-6",children:[m.jsxs("header",{className:"flex justify-between items-center",children:[m.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-widest",children:"Relationships"}),m.jsx(nn,{variant:"secondary",icon:"add_link",onClick:()=>l(!o),children:o?"Cancel":"Connect"})]}),o&&m.jsxs("div",{className:"p-4 rounded-2xl bg-white/5 border border-white/10 space-y-4 animate-in fade-in slide-in-from-top-4",children:[m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{className:"space-y-1",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Target Type"}),m.jsx("select",{className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:u,onChange:z=>c(z.target.value),children:zX.map(z=>m.jsx("option",{value:z.value,children:z.label},z.value))})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Target Entity"}),m.jsxs("select",{className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:v,onChange:z=>y(z.target.value),disabled:C,children:[m.jsx("option",{value:"",children:"Select Target..."}),d.map(z=>m.jsx("option",{value:z.id,children:z.nombre},z.id))]})]})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Relationship Type"}),m.jsx("input",{type:"text",placeholder:"e.g. Father of, Located in, Enemy of...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:b,onChange:z=>S(z.target.value)})]}),m.jsxs("div",{className:"space-y-1",children:[m.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Description (The Why)"}),m.jsx("textarea",{placeholder:"Explain the nature of this connection...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary h-20 resize-none",value:k,onChange:z=>T(z.target.value)})]}),m.jsx("div",{className:"flex justify-end pt-2",children:m.jsx(nn,{variant:"primary",icon:"save",onClick:O,disabled:!v||!b,children:"Save Connection"})})]}),m.jsx("div",{className:"space-y-3",children:a?m.jsx("div",{className:"text-center text-slate-500 py-8",children:"Scanning connections..."}):n.length===0?m.jsx("div",{className:"text-center text-slate-500 py-8 italic border border-dashed border-white/10 rounded-2xl",children:"No connections established"}):n.map((z,V)=>m.jsxs("div",{className:"group relative p-4 rounded-2xl bg-surface-dark border border-white/5 hover:border-primary/50 transition-all flex items-start gap-4",children:[m.jsx("div",{className:"mt-1",children:m.jsx("span",{className:"material-symbols-outlined text-slate-500",children:z.isOutgoing?"arrow_outward":"arrow_inward"})}),m.jsxs("div",{className:"flex-1",children:[m.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[m.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:z.isOutgoing?"To:":"From:"}),m.jsx("span",{className:"text-sm font-bold text-white",children:z.otherName}),m.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-white/10 text-slate-400 font-bold uppercase tracking-wider",children:z.otherType})]}),m.jsx("div",{className:"text-primary text-xs font-black uppercase tracking-widest mb-2",children:z.tipoRelacion}),z.descripcion&&m.jsxs("p",{className:"text-xs text-slate-400 leading-relaxed bg-black/20 p-2 rounded-lg border border-white/5",children:['"',z.descripcion,'"']})]}),m.jsx("button",{onClick:()=>B(z.id),className:"opacity-0 group-hover:opacity-100 p-2 text-slate-600 hover:text-red-400 transition-all",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},z.id||V))})]})},sg=({mode:r})=>{const{username:e,projectName:n,entitySlug:i,folderSlug:a,type:s}=Yi(),o=Na(),l=r==="creation",{setRightOpen:u,setAvailableTemplates:c,setRightPanelMode:d,setAddAttributeHandler:p,setEntityTabs:v,activeEntityTab:y,setActiveEntityTab:b}=au(),[S,k]=ce.useState({nombre:"",tipo:"entidadindividual",descripcion:"",color:"#6366f1",apariencia:"",notas:"",iconUrl:null,tipoEspecial:s||null,carpeta:null,categoria:"Individual"}),[T,C]=ce.useState([]),[N,P]=ce.useState(!0),[R,O]=ce.useState(!1),[B,I]=ce.useState([]),[z,V]=ce.useState([]),[$,Y]=ce.useState(!1);ce.useEffect(()=>(u(!0),d("ENTITY"),v(["identity","narrative","attributes"]),b("identity"),()=>{d("NOTES"),v([])}),[]),ce.useEffect(()=>{l?q():G()},[i,a,l]);const D=W=>{c(W),V(W),p(re=>{const ae=W.find(he=>he.id===re);ae&&C(he=>[...he,{id:`temp-${ae.id}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,attribute:ae,value:ae.valorDefecto||"",isTemp:!0}])})},q=async()=>{P(!0);try{const W=await rt.get(`/world-bible/folders/${a}`),re=await rt.get(`/world-bible/folders/${a}/templates`);D(re),k(he=>({...he,nombre:`Nuevo ${s==="map"?"Mapa":s==="timeline"?"Cronograma":"Ente"}`,carpeta:W,tipoEspecial:s||"entidadindividual",tipo:s||"entidadindividual"}));const ae=re.filter(he=>he.esObligatorio).map(he=>({id:`temp-${he.id}-${Math.random().toString(36).substr(2,9)}`,attribute:he,value:he.valorDefecto||"",isTemp:!0}));C(ae)}catch(W){console.error("Error creating draft:",W)}finally{P(!1)}},G=async()=>{P(!0);try{const W=await rt.get(`/world-bible/entities/${i}`);if(k({...W,apariencia:W.apariencia||"",notas:W.notas||"",iconUrl:W.iconUrl||null,tags:W.tags||"",tipo:W.tipoEspecial||getHierarchyType(W.tipo).id,color:W.color||"#6366f1",categoria:W.categoria||"Individual",attributes:W.attributes||{}}),W.carpeta?.id){const ae=await rt.get(`/world-bible/folders/${W.carpeta.id}/templates`);D(ae)}const re=(W.valores||[]).filter(ae=>ae.plantilla).map(ae=>({id:ae.id.toString(),attribute:ae.plantilla,value:ae.valor,isTemp:!1}));C(re)}catch(W){console.error("Error loading entity:",W)}finally{P(!1)}},Z=(W,re)=>{k(ae=>({...ae,[W]:re}))},Q=W=>{const re=W.target.files[0];if(re){const ae=new FileReader;ae.onloadend=()=>{Z("iconUrl",ae.result)},ae.readAsDataURL(re)}},J=(W,re)=>{C(ae=>ae.map(he=>he.id===W?{...he,value:re}:he))},ie=W=>{W.toString().startsWith("temp-")||I(re=>[...re,W]),C(re=>re.filter(ae=>ae.id!==W))},ne=async(W=!0)=>{O(!0);try{const re={nombre:S.nombre,descripcion:S.descripcion,tags:S.tags,apariencia:S.apariencia,notas:S.notas,iconUrl:S.iconUrl,tipoEspecial:S.tipoEspecial||"entidadindividual",color:S.color,categoria:S.categoria,attributes:S.attributes};let ae=S.id;if(l){if(!S.carpeta&&!a){alert("Error: Missing context (no folder). Redirecting."),o(`/${e}/${n}/bible`);return}if(re.carpetaId=S.carpeta?.id,!re.carpetaId&&a)try{const le=await rt.get(`/world-bible/folders/${a}`);re.carpetaId=le.id}catch(le){console.error("Could not resolve folder",le)}const se=await rt.post("/world-bible/entities",re);ae=se.id;const ge=[...T];for(let le=0;le<ge.length;le++){const pe=ge[le];if(pe.isTemp)try{const me=await rt.post(`/world-bible/entities/${se.id}/attributes`,{plantillaId:pe.attribute.id});await rt.patch(`/world-bible/entities/${se.id}/values`,[{valorId:me.id,nuevoValor:pe.value}]),ge[le]={...pe,id:me.id.toString(),isTemp:!1}}catch(me){console.error("Attr save failed",me)}}if(C(ge),O(!1),W){const le=se.carpeta?se.carpeta.slug||se.carpeta.id:a;o(`/${e}/${n}/bible/folder/${le}`)}else{const le=se.carpeta?se.carpeta.slug||se.carpeta.id:a;o(`/${e}/${n}/bible/folder/${le}/entity/${se.slug||se.id}`,{replace:!0})}return}await rt.put(`/world-bible/entities/${ae}`,{nombre:re.nombre,color:re.color,iconUrl:re.iconUrl}),await rt.patch(`/world-bible/entities/${ae}/details`,{descripcion:re.descripcion,tags:re.tags,apariencia:re.apariencia,notas:re.notas,iconUrl:re.iconUrl,attributes:re.attributes}),B.length>0&&(await Promise.all(B.map(se=>rt.delete(`/world-bible/values/${se}`))),I([]));const he=T.filter(se=>!se.isTemp).map(se=>({valorId:parseInt(se.id),nuevoValor:se.value}));he.length>0&&await rt.patch(`/world-bible/entities/${ae}/values`,he);let ve=!1;const xe=[...T];for(let se=0;se<xe.length;se++){const ge=xe[se];if(ge.isTemp)try{const le=await rt.post(`/world-bible/entities/${ae}/attributes`,{plantillaId:ge.attribute.id});await rt.patch(`/world-bible/entities/${ae}/values`,[{valorId:le.id,nuevoValor:ge.value}]),xe[se]={...ge,id:le.id.toString(),isTemp:!1},ve=!0}catch(le){console.error("Error saving field:",ge,le)}}if(ve&&C(xe),O(!1),W){const ge=a||(S.carpeta?S.carpeta.slug||S.carpeta.id:"root")||"root";o(`/${e}/${n}/bible/folder/${ge}`)}}catch(re){console.error("Save error",re),O(!1)}};return N?m.jsx("div",{className:"p-20 text-center animate-pulse",children:"Loading Builder..."}):m.jsx("div",{className:"flex h-full w-full bg-background-dark overflow-hidden",children:m.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-y-auto custom-scrollbar relative",children:[m.jsxs("div",{className:"border-b border-white/5 p-4 flex justify-between items-center bg-background-dark/80 backdrop-blur sticky top-0 z-30",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx(ny,{url:S.iconUrl,name:S.nombre,className:"size-10 rounded-lg border border-white/10"}),m.jsxs("div",{children:[m.jsx("h1",{className:"text-lg font-bold text-white leading-tight",children:S.nombre||"Sin Nombre"}),m.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest text-slate-500",children:l?"Creando Nueva Entidad":"Editando Entidad"})]})]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("button",{onClick:()=>o(`/${e}/${n}/bible/folder/${a}`),className:"px-4 py-2 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 text-xs font-bold uppercase tracking-widest transition-all",children:"Cancelar"}),m.jsxs("div",{className:"flex bg-white/5 rounded-xl p-1 gap-1 border border-white/10",children:[m.jsxs("button",{onClick:()=>ne(!0),disabled:R,className:"h-9 px-4 rounded-lg bg-primary hover:bg-primary-light text-white text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 disabled:opacity-50",children:[R?m.jsx("span",{className:"material-symbols-outlined animate-spin text-sm",children:"refresh"}):m.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar"]}),m.jsx("div",{className:"w-px bg-white/10 my-1"}),m.jsx("button",{onClick:()=>ne(!1),disabled:R,className:"h-9 px-3 rounded-lg bg-transparent hover:bg-white/10 text-white transition-all flex items-center justify-center disabled:opacity-50",title:"Guardar y Seguir Editando",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit_document"})})]})]})]}),m.jsxs("div",{className:"p-8 pb-32 max-w-5xl mx-auto w-full",children:[y==="identity"&&m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[m.jsxs(Lr,{className:`p-6 space-y-6 ${S.tipoEspecial==="map"?"lg:col-span-2":""}`,children:[m.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"badge"})," Identity"]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Full Name"}),m.jsx("input",{value:S.nombre,onChange:W=>Z("nombre",W.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none transition-colors",placeholder:"E.g. King Alaric"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Entity Type / Category"}),m.jsxs("select",{value:S.categoria||"Individual",onChange:W=>Z("categoria",W.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none transition-colors appearance-none",children:[m.jsx("option",{value:"Individual",children:"Individual (Character/Person)"}),m.jsx("option",{value:"Group",children:"Group / Faction"}),m.jsx("option",{value:"Location",children:"Location"}),m.jsx("option",{value:"Event",children:"Event"}),m.jsx("option",{value:"Object",children:"Object / Item"}),m.jsx("option",{value:"Concept",children:"Concept / Magic"})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Tags (comma separated)"}),m.jsx("input",{value:S.tags,onChange:W=>Z("tags",W.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-slate-300 focus:border-primary/50 outline-none transition-colors",placeholder:"Warrior, Leader, Human..."})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Icon / Portrait"}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx(ny,{url:S.iconUrl,name:S.nombre,size:"lg",className:"rounded-xl"}),m.jsxs("label",{className:"cursor-pointer px-4 py-2 bg-white/5 hover:bg-white/10 rounded-lg border border-white/10 text-xs font-bold text-slate-300 transition-colors",children:["Upload Image",m.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:Q})]}),S.iconUrl&&m.jsx("button",{onClick:()=>Z("iconUrl",""),className:"p-2 hover:text-red-400 transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]})]})]}),S.tipoEspecial!=="map"&&m.jsxs(Lr,{className:"p-6 space-y-6",children:[m.jsxs("div",{className:"flex justify-between items-center mb-6",children:[m.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"palette"})," Appearance"]}),m.jsx("div",{className:"flex gap-2",children:m.jsxs("label",{className:"cursor-pointer text-[10px] font-bold uppercase tracking-wider text-slate-500 hover:text-white transition-colors flex items-center gap-1",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"add_photo_alternate"}),"Insert Image",m.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:W=>{const re=W.target.files[0];if(re){const ae=new FileReader;ae.onloadend=()=>{const he=`

![${re.name}](${ae.result})
`;Z("apariencia",(S.apariencia||"")+he)},ae.readAsDataURL(re)}}})]})})]}),m.jsx("textarea",{value:S.apariencia,onChange:W=>Z("apariencia",W.target.value),className:"w-full h-80 bg-black/30 border border-white/10 rounded-xl p-4 text-sm text-slate-300 leading-relaxed focus:border-primary/50 outline-none transition-colors custom-scrollbar font-mono",placeholder:"Describe their physical appearance, clothing, distinct marks... (Markdown Supported)"})]}),S.tipoEspecial==="map"&&m.jsxs(Lr,{className:"p-6 lg:col-span-2 space-y-6",children:[m.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Cartography"]}),m.jsx("div",{onClick:()=>{Y(!0)},className:"w-full aspect-[21/9] bg-black/30 border border-white/10 rounded-xl overflow-hidden cursor-pointer group relative",children:(()=>{let W=S.attributes?.snapshotUrl||S.attributes?.bgImage||S.iconUrl;if(!W)try{const re=JSON.parse(S.descripcion||"{}");re.snapshotUrl&&(W=re.snapshotUrl)}catch{}return W?m.jsxs(m.Fragment,{children:[m.jsx("img",{src:W,alt:"Map Preview",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),m.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:m.jsx("span",{className:"material-symbols-outlined text-white text-3xl",children:"zoom_in"})})]}):m.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-xs italic",children:"No map preview available"})})()}),m.jsx("div",{className:"flex justify-end",children:m.jsx(nn,{variant:"secondary",size:"sm",icon:"edit",onClick:()=>window.open(`/${e}/${n}/map-editor/edit/${S.id}`,"_self"),children:"Open Editor"})})]}),S.tipoEspecial!=="map"&&m.jsxs(Lr,{className:"p-6 lg:col-span-2",children:[m.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"sticky_note_2"})," Quick Notes"]}),m.jsx("textarea",{className:"w-full h-40 bg-black/30 border border-white/10 rounded-xl p-4 text-sm text-slate-300 leading-relaxed resize-none focus:border-primary/50 outline-none transition-colors custom-scrollbar font-mono placeholder:text-slate-600",placeholder:"Quick notes about this entity...",value:S.notas||"",onChange:W=>Z("notas",W.target.value)})]})]}),y==="narrative"&&m.jsxs("div",{className:"animate-in fade-in duration-500 space-y-8",children:[m.jsxs(Lr,{className:"min-h-[40vh] flex flex-col p-8",children:[m.jsxs("div",{className:"flex items-center justify-between mb-6",children:[m.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"history_edu"})," Biography"]}),m.jsx("span",{className:"text-[10px] text-slate-500 bg-white/5 px-2 py-1 rounded",children:"Markdown Supported"})]}),m.jsx("textarea",{className:"flex-1 w-full bg-transparent border-none outline-none text-slate-300 leading-relaxed resize-none focus:ring-0 placeholder:text-slate-600 custom-scrollbar text-base min-h-[300px]",placeholder:"Write the origin story...",value:S.descripcion||"",onChange:W=>Z("descripcion",W.target.value)})]}),m.jsxs(Lr,{className:"min-h-[40vh]",children:[m.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary p-6 pb-0 flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})," Relationships"]}),l?m.jsxs("div",{className:"p-12 text-center text-slate-500",children:[m.jsx("span",{className:"material-symbols-outlined text-4xl mb-4",children:"save_as"}),m.jsx("p",{className:"text-sm font-bold",children:"Please save the entity first to manage relationships."})]}):m.jsx(FX,{entityId:S.id,entityType:S.tipo||"entidadindividual"})]})]}),y==="attributes"&&m.jsxs("div",{className:`animate-in fade-in duration-500 space-y-6 min-h-[50vh] transition-colors rounded-2xl p-4 ${window.isDraggingOver?"bg-primary/10 border-2 border-dashed border-primary":""}`,onDragOver:W=>{W.preventDefault(),W.dataTransfer.dropEffect="copy",W.currentTarget.classList.add("bg-primary/10","border-primary","border-dashed","border-2")},onDragLeave:W=>{W.preventDefault(),W.currentTarget.classList.remove("bg-primary/10","border-primary","border-dashed","border-2")},onDrop:W=>{if(W.preventDefault(),W.currentTarget.classList.remove("bg-primary/10","border-primary","border-dashed","border-2"),W.dataTransfer.getData("application/reactflow/type")!=="attribute")return;let ae=null;try{const he=W.dataTransfer.getData("templateData");if(he)ae=JSON.parse(he);else{const ve=parseInt(W.dataTransfer.getData("templateId"));ae=z.find(xe=>xe.id===ve)}}catch(he){console.error("Drop error",he)}ae&&C(he=>[...he,{id:`temp-${ae.id}-${Date.now()}`,attribute:ae,value:ae.valorDefecto||"",isTemp:!0}])},children:[m.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary border-b border-white/5 pb-4 flex items-center justify-between",children:[m.jsx("span",{children:"Atributos especiales"}),m.jsx("span",{className:"text-[10px] text-slate-500 font-normal normal-case opacity-50 hidden md:block",children:"Arraste atributos desde el panel derecho"})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 border-2 border-dashed border-white/5 rounded-2xl hover:border-primary/20 transition-colors bg-white/[0.01]",children:[T.length===0&&m.jsxs("div",{className:"col-span-full py-12 text-center text-slate-500 text-sm pointer-events-none",children:[m.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"drag_indicator"}),m.jsx("p",{children:"Arrastra plantillas aqu para aadir atributos"})]}),T.filter(W=>W.attribute).map(W=>m.jsx(BX,{attribute:W.attribute,value:W.value,onChange:re=>J(W.id,re),onRemove:()=>ie(W.id)},W.id))]})]})]}),$&&S.iconUrl&&m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-300",onClick:()=>Y(!1),children:m.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] p-2",children:[m.jsx("button",{onClick:()=>Y(!1),className:"absolute -top-12 right-0 p-2 text-white hover:text-primary transition-colors",children:m.jsx("span",{className:"material-symbols-outlined text-3xl",children:"close"})}),m.jsx("img",{src:S.iconUrl,alt:S.nombre,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl border border-white/10",onClick:W=>W.stopPropagation()})]})})]})})},VX=r=>{switch(r?.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},b_=({item:r,type:e,linkTo:n,onContextMenu:i,onDelete:a})=>{const s=e==="folder";return m.jsxs(Oh,{to:n,onContextMenu:i,className:"group relative flex flex-col p-4 rounded-3xl bg-surface-dark border border-glass-border hover:border-primary/50 hover:bg-white/5 transition-all duration-300 backdrop-blur-sm overflow-hidden",children:[r.iconUrl&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"absolute inset-0 z-0",children:m.jsx("img",{src:r.iconUrl,alt:"",className:"w-full h-full object-cover opacity-60 group-hover:scale-105 transition-transform duration-700"})}),m.jsx("div",{className:"absolute inset-0 z-0 bg-gradient-to-t from-[#0a0a0c] via-[#0a0a0c]/80 to-transparent"})]}),m.jsxs("div",{className:"relative z-10 flex items-start justify-between mb-4",children:[m.jsx("div",{className:`
                    size-12 rounded-2xl flex items-center justify-center text-xl transition-transform group-hover:scale-110 
                    ${s?"bg-primary/20 text-primary":"bg-white/5 text-text-muted group-hover:text-white backdrop-blur-md border border-white/5"}
                `,children:m.jsx("span",{className:"material-symbols-outlined",children:s?"folder":VX(r.tipoEspecial)})}),s&&m.jsx("div",{className:"px-2 py-1 rounded-lg bg-surface-light/50 border border-glass-border text-[10px] font-black text-white shadow-sm backdrop-blur-md",children:r.itemCount||0})]}),m.jsxs("div",{className:"relative z-10 mt-auto",children:[m.jsx("h3",{className:"text-sm font-bold text-white truncate group-hover:text-primary transition-colors drop-shadow-md",children:r.nombre}),m.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted mt-1 opacity-70 group-hover:opacity-100 transition-opacity",children:s?"Folder":r.tipoEspecial||"Entity"})]}),m.jsxs("div",{className:"absolute top-4 right-4 z-20 flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[a&&m.jsx("button",{onClick:o=>{o.preventDefault(),o.stopPropagation(),a(r)},className:"p-1.5 rounded-lg bg-red-500/10 hover:bg-red-500 text-red-500 hover:text-white transition-all border border-red-500/20 shadow-lg shadow-red-500/5 group/del backdrop-blur-md",children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})}),m.jsx("span",{className:"material-symbols-outlined text-primary text-sm transform group-hover:translate-x-1 transition-transform drop-shadow-md",children:"arrow_forward"})]})]})},UX=({path:r,currentFolder:e})=>{const{username:n,projectName:i}=Yi(),a=`/${n}/${i}/bible`;return!r&&!e?null:m.jsxs("nav",{className:"flex items-center gap-2 text-[10px] uppercase font-bold tracking-wider text-slate-500 mb-4 overflow-x-auto no-scrollbar whitespace-nowrap",children:[m.jsxs(Oh,{to:a,className:"hover:text-primary transition-colors flex items-center gap-1",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"home"}),"Bible"]}),r&&r.map((s,o)=>m.jsxs(Xt.Fragment,{children:[m.jsx("span",{className:"text-slate-700",children:"/"}),m.jsx(Oh,{to:`${a}/folder/${s.slug||s.id}`,className:"hover:text-primary transition-colors",children:s.nombre})]},s.id)),e&&m.jsxs(m.Fragment,{children:[m.jsx("span",{className:"text-slate-700",children:"/"}),m.jsx("span",{className:"text-white bg-white/5 px-2 py-0.5 rounded",children:e.nombre})]})]})},HX=({entities:r=[],onAddEvent:e})=>{const n=[...r].sort((i,a)=>i.id-a.id);return m.jsx("div",{className:"w-full max-w-3xl mx-auto p-4 animate-slide-up",children:m.jsxs("div",{className:"relative border-l-2 border-white/10 ml-6 space-y-12 py-8",children:[n.length===0&&m.jsx("div",{className:"pl-12 opacity-50",children:m.jsx("p",{className:"text-white text-sm",children:"No events recorded in this timeline yet."})}),n.map((i,a)=>m.jsxs("div",{className:"relative pl-12 group",children:[m.jsx("div",{className:"absolute left-[-9px] top-0 size-4 rounded-full bg-background-dark border-2 border-primary group-hover:scale-125 group-hover:bg-primary transition-all shadow-[0_0_10px_rgba(99,102,241,0.3)]"}),m.jsxs(Lr,{className:"p-6 border-white/5 hover:border-primary/30 transition-all hover:-translate-y-1 cursor-pointer",children:[m.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:i.nombre}),m.jsx("p",{className:"text-sm text-text-muted leading-relaxed line-clamp-3",children:i.descripcion||"No description provided."})]})]},i.id)),m.jsxs("div",{onClick:e,className:"relative pl-12 group cursor-pointer opacity-50 hover:opacity-100 transition-opacity",children:[m.jsx("div",{className:"absolute left-[-9px] top-2 size-4 rounded-full bg-background-dark border-2 border-dashed border-white/30"}),m.jsxs("div",{className:"p-4 border-2 border-dashed border-white/10 rounded-2xl flex items-center justify-center text-text-muted hover:border-primary/50 hover:text-white transition-all",children:[m.jsx("span",{className:"material-symbols-outlined mr-2",children:"add_circle"}),m.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Add Historical Event"})]})]})]})})},Th={UNIVERSE:{id:"UNIVERSE",label:"Universo / Multiverso",description:"Contenedor supremo de realidades.",icon:"public",color:"text-purple-400",bgColor:"bg-purple-900/20"},GALAXY:{id:"GALAXY",label:"Galaxia",description:"Agrupacin masiva de sistemas estelares.",icon:"auto_awesome",color:"text-indigo-400",bgColor:"bg-indigo-900/20"},SYSTEM:{id:"SYSTEM",label:"Sistema Solar",description:"Estrella central y sus cuerpos orbitales.",icon:"wb_sunny",color:"text-yellow-400",bgColor:"bg-yellow-900/20"},PLANET:{id:"PLANET",label:"Planeta / Mundo",description:"Cuerpo celeste o plano de existencia principal.",icon:"public",color:"text-emerald-400",bgColor:"bg-emerald-900/20"},GEOGRAPHY:{id:"GEOGRAPHY",label:"Geografa",icon:"map",color:"text-green-300"},ENTITIES:{id:"ENTITIES",label:"Entidades",icon:"groups",color:"text-blue-300"},MAGIC:{id:"MAGIC",label:"Magia",icon:"auto_fix_high",color:"text-pink-300"},TIMELINE:{id:"TIMELINE",label:"Cronologa",icon:"history",color:"text-orange-300"},FACTIONS:{id:"FACTIONS",label:"Facciones",icon:"security",color:"text-red-300"},ITEMS:{id:"ITEMS",label:"Objetos",icon:"inventory_2",color:"text-gray-300"},FOLDER:{id:"FOLDER",label:"Carpeta",icon:"folder",color:"text-gray-400"}},w_=r=>Th[r]||Th.FOLDER,GX=()=>{const{username:r,projectName:e,folderSlug:n}=Yi(),i=Na(),{handleCreateEntity:a,handleDeleteEntity:s,handleCreateSimpleFolder:o,folderSearchTerm:l,folderFilterType:u}=au(),[c,d]=ce.useState([]),[p,v]=ce.useState(null),[y,b]=ce.useState([]),[S,k]=ce.useState(!0),[T,C]=ce.useState(!1),N=c.filter(B=>{const I=B.nombre.toLowerCase().includes(l||""),z=u==="ALL"||u==="MAP"&&B.tipoEspecial==="map"||u==="TIMELINE"&&B.tipoEspecial==="timeline"||u==="ENTITY"&&(!B.tipoEspecial||B.tipoEspecial==="entidadindividual");return I&&z});ce.useEffect(()=>{const B=I=>{const{folderId:z,removeId:V,type:$,item:Y,expand:D}=I.detail||{};z===(p?.id||n)&&(V?d(q=>q.filter(G=>G.id!==V)):Y&&Y.slug&&Y.slug!==n?i(`/${r}/${e}/bible/folder/${Y.slug}`,{replace:!0}):P())};return window.addEventListener("folder-update",B),()=>window.removeEventListener("folder-update",B)},[n,p?.id]),ce.useEffect(()=>{P()},[n]);const P=async()=>{k(!0);try{const[B,I]=await Promise.all([rt.get(`/world-bible/folders/${n}/entities`),rt.get(`/world-bible/folders/${n}`)]);d(B),I.folder?(v(I.folder),b(I.path||[])):(v(I||{name:"Folder"}),b([]))}catch(B){console.error("Error loading folder content:",B),v(null),b([])}finally{k(!1)}};if(S)return m.jsx("div",{className:"p-20 text-center animate-pulse text-text-muted",children:"Loading sector..."});if(!p)return m.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-20 text-text-muted",children:[m.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-20",children:"folder_off"}),m.jsx("h2",{className:"text-xl font-bold opacity-50",children:"Folder Not Found"}),m.jsx("p",{className:"text-sm opacity-30 mt-2",children:"The sector you are looking for does not exist or has been moved."}),m.jsx(Oh,{to:`/${r}/${e}/bible`,className:"mt-6 px-6 py-2 bg-white/5 hover:bg-white/10 rounded-full text-xs font-bold transition-colors",children:"Return to Root"})]});const R=p&&p.tipo&&(["UNIVERSE","GALAXY","SYSTEM","PLANET"].includes(p.tipo)||p.tipo==="MAGIC"),O=p?w_(p.tipo):Th.FOLDER;return R?m.jsxs("div",{className:"flex-1 overflow-y-auto bg-[#0a0a0c] text-white w-full h-full relative",children:[m.jsxs("div",{className:`w-full min-h-[300px] ${O.bgColor} relative flex items-end p-10 border-b border-white/5`,children:[m.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0c] to-transparent opacity-80 pointer-events-none"}),m.jsx("div",{className:"absolute top-6 left-10 z-20",children:m.jsx(UX,{path:y,currentFolder:p})}),m.jsxs("div",{className:"relative z-10 flex gap-8 items-end w-full max-w-7xl mx-auto",children:[m.jsx("div",{className:`w-32 h-32 rounded-3xl ${O.bgColor} border border-white/10 flex items-center justify-center shadow-2xl`,children:m.jsx("span",{className:`material-symbols-outlined text-6xl ${O.color}`,children:O.icon})}),m.jsxs("div",{className:"flex-1 mb-2",children:[m.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[m.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border border-white/10 ${O.bgColor} ${O.color}`,children:O.label}),m.jsxs("span",{className:"text-white/30 text-xs font-mono tracking-widest uppercase",children:["ID: ",p.id]})]}),m.jsx("h1",{className:"text-6xl font-black tracking-tighter text-white mb-2",children:p.nombre}),m.jsx("p",{className:"text-lg text-white/50 max-w-2xl font-light leading-relaxed",children:p.descripcion||"Sin descripcin definida para este sector cosmolgico."})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("button",{onClick:()=>i(`/${r}/${e}/bible/folder/${n}/entity/new/entidadindividual`),className:"px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"person_add"})," Nueva Entidad"]}),m.jsxs("button",{onClick:()=>i(`/${r}/${e}/map-editor/create/${n}`,{state:{folderId:p?.id}}),className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all border border-glass-border",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Mapa"]})]})]})]}),m.jsxs("div",{className:"max-w-7xl mx-auto p-10 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"bg-[#13141f] border border-white/5 rounded-2xl p-6",children:[m.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Estadsticas"}),m.jsx("div",{className:"grid grid-cols-2 gap-4",children:m.jsxs("div",{children:[m.jsx("div",{className:"text-2xl font-black text-white",children:c.length}),m.jsx("div",{className:"text-[10px] text-white/40 uppercase",children:"Entidades"})]})})]}),m.jsxs("div",{className:"bg-[#13141f] border border-white/5 rounded-2xl p-6 h-64 flex flex-col",children:[m.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Notas Rpidas"}),m.jsx("textarea",{className:"flex-1 bg-transparent resize-none outline-none text-sm text-white/70 placeholder-white/20",placeholder:"Escribir notas de la zona..."})]})]}),m.jsxs("div",{className:"lg:col-span-2",children:[m.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Contenido Interno"}),c.length===0&&m.jsxs("div",{className:"p-12 border border-dashed border-white/10 rounded-2xl text-center",children:[m.jsx("span",{className:"material-symbols-outlined text-4xl text-white/20 mb-2",children:"folder_open"}),m.jsx("p",{className:"text-white/30 text-sm",children:"Este sector est vaco."})]}),m.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:c.map(B=>m.jsx(b_,{item:B,type:"entity",linkTo:`/${r}/${e}/bible/folder/${p.slug||n}/entity/${B.slug||B.id}`,onDelete:()=>s(B.id,p?.id||n)},B.id))})]})]})]}):m.jsxs("div",{className:"flex-1 p-8 max-w-[1600px] mx-auto w-full h-full overflow-y-auto",children:[m.jsxs("header",{className:"mb-8 flex items-end justify-between",children:[m.jsxs("div",{children:[m.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[m.jsxs(Oh,{to:`/${r}/${e}/bible`,className:"text-xs font-bold text-text-muted hover:text-primary transition-colors flex items-center gap-1",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"})," Root"]}),p&&m.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] bg-white/5 border border-white/10 ${O.color}`,children:O.label})]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("span",{className:`material-symbols-outlined text-3xl ${O.color}`,children:O.icon}),m.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter",children:p?.nombre||"Unnamed Folder"})]}),m.jsx("p",{className:"text-white/50 text-sm mt-2 max-w-xl",children:p?.descripcion})]}),m.jsxs("div",{className:"flex items-center gap-3 relative",children:[m.jsxs("button",{onClick:()=>C(!T),className:"h-10 px-6 rounded-xl bg-primary hover:bg-primary-light transition flex items-center gap-2 text-xs font-bold text-white shadow-lg shadow-primary/20",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"}),m.jsx("span",{children:"Aadir Elemento"})]}),T&&m.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-surface-dark border border-glass-border rounded-2xl shadow-2xl py-2 z-50 animate-in fade-in slide-in-from-top-2",children:[m.jsxs("button",{onClick:()=>{i(`/${r}/${e}/bible/folder/${n}/entity/new/entidadindividual`),C(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"person"})," Personaje"]}),m.jsxs("button",{onClick:()=>{i(`/${r}/${e}/bible/folder/${n}/entity/new/entidadcolectiva`),C(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-blue-400",children:"groups"})," Cultura / Grupo"]}),m.jsxs("button",{onClick:()=>{i(`/${r}/${e}/bible/folder/${n}/entity/new/zona`),C(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-green-400",children:"location_on"})," Lugar / Geografa"]}),m.jsxs("button",{onClick:()=>{i(`/${r}/${e}/bible/folder/${n}/entity/new/interaccion`),C(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-amber-400",children:"history_edu"})," Lore / Interaccin"]}),m.jsxs("button",{onClick:()=>{i(`/${r}/${e}/bible/folder/${n}/entity/new/efectos`),C(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-purple-400",children:"magic_button"})," Objeto / Efecto"]}),m.jsx("div",{className:"h-px bg-white/5 my-1"}),m.jsxs("button",{onClick:()=>{i(`/${r}/${e}/map-editor/create/${n}`,{state:{folderId:p?.id}}),C(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-red-400",children:"map"})," Nuevo Mapa"]}),m.jsxs("button",{onClick:()=>{o(p,"TIMELINE"),C(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-cyan-400",children:"timeline"})," Timeline"]})]})]})]}),p?.tipo==="TIMELINE"?m.jsx(HX,{entities:N,folderId:n,onAddEvent:()=>i(`/${r}/${e}/bible/folder/${n}/entity/new/evento`)}):m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:N.map(B=>{const I=B.tipoEspecial==="map"||B.tipoEspecial==="timeline"?B.tipoEspecial:"entity";return m.jsx(b_,{item:B,type:"entity",linkTo:`/${r}/${e}/bible/folder/${p?.slug||n}/${I}/${B.slug||B.id}`,onDelete:()=>s(B.id,p?.id||n)},B.id)})}),c.length===0&&m.jsx("div",{className:"p-20 text-center border-2 border-dashed border-glass-border rounded-[3rem] opacity-30 mt-8",children:m.jsx("p",{className:"text-text-muted font-bold uppercase tracking-widest",children:"Empty Folder"})})]})},qX=r=>{switch(r?.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},WX=(r,e,n,i)=>{const a=n.slug||n.id;return`/${r}/${e}/bible/folder/${i||"root"}/entity/${a}`},Lj=({folder:r,onCreateSubfolder:e,onRename:n,onDeleteFolder:i,onDeleteEntity:a,onCreateTemplate:s,onMoveEntity:o,onCreateEntity:l,onConfirmCreate:u,className:c})=>{const{username:d,projectName:p}=Yi(),v=Na(),[y,b]=ce.useState(!1),[S,k]=ce.useState({folders:[],entities:[]}),[T,C]=ce.useState(!1),[N,P]=ce.useState(null),[R,O]=ce.useState(r.nombre),[B,I]=ce.useState(!1),[z,V]=ce.useState(null);ce.useEffect(()=>{O(r.nombre)},[r.nombre]),ce.useEffect(()=>{const W=re=>{const{folderId:ae,optimisticType:he,confirmedType:ve,removeId:xe,item:se,oldId:ge,expand:le,type:pe}=re.detail||{};if(ae===r.id){if(le&&(b(!0),T||$()),T)if(he){const me=he==="folder"?"folders":"entities";k(be=>({...be,[me]:[...be[me].filter(Se=>Se.id!==se.id),se]}))}else if(ve){const me=ve==="folder"?"folders":"entities";k(be=>({...be,[me]:be[me].map(Se=>Se.id===ge?se:Se)}))}else if(xe){const me=pe==="folder"?"folders":"entities";k(be=>({...be,[me]:be[me].filter(Se=>Se.id!==xe)}))}else!he&&!ve&&!xe&&$()}else re.detail?.targetFolderId===r.id&&re.detail?.type==="move-in"?T&&$():re.detail?.sourceFolderId===r.id&&re.detail?.type==="move-out"&&T&&k(me=>({...me,entities:me.entities.filter(be=>be.id!==be.detail.entityId)}))};return window.addEventListener("folder-update",W),()=>window.removeEventListener("folder-update",W)},[r.id,T]);const $=async()=>{try{console.log("Loading content for folder:",r.id,"Slug:",r.slug);const[W,re]=await Promise.all([rt.get(`/world-bible/folders/${r.id}/subfolders`),rt.get(`/world-bible/folders/${r.id}/entities`)]);k({folders:W,entities:re}),C(!0)}catch(W){console.error("Error reloading folder content:",W),W.message&&W.message.includes("404")&&console.error(`404 for folder ${r.id} (${r.nombre})`)}},Y=W=>{W.stopPropagation(),b(!y),!T&&!y&&$()},D=()=>v(`/${d}/${p}/bible/folder/${r.slug||r.id}`),q=(W,re,ae,he)=>{W.preventDefault(),W.stopPropagation(),P({x:W.clientX,y:W.clientY,type:re,id:ae,name:he})},G=()=>P(null);ce.useEffect(()=>{if(N)return window.addEventListener("click",G),()=>window.removeEventListener("click",G)},[N]);const Z=W=>{if(W.key==="Enter"){W.preventDefault();const re=W.target.value.trim();re?u(r.id,re,"folder",r.parentId,r.tipoEspecial):r.isNew&&a(r.id,r.parentId)}};if(r.isNew)return m.jsx("div",{className:"px-3 py-1 animate-in fade-in zoom-in-95 duration-200",children:m.jsx("input",{autoFocus:!0,type:"text",className:"w-full bg-surface-light border border-primary/50 rounded px-2 py-1 text-xs text-white outline-none",placeholder:"Folder Name...",onKeyDown:Z,onBlur:W=>{const re=W.target.value.trim();re?u(r.id,re,"folder",r.parentId):a(r.id,r.parentId)}})});const Q=({item:W,type:re})=>m.jsx("div",{className:"px-3 py-1 animate-in fade-in zoom-in-95 duration-200",children:m.jsx("input",{autoFocus:!0,type:"text",defaultValue:W.nombre||"",className:"w-full bg-surface-light border border-primary/50 rounded px-2 py-1 text-xs text-white outline-none",placeholder:"Name...",onKeyDown:ae=>{if(ae.key==="Enter"){ae.preventDefault();const he=ae.target.value.trim();he?u(W.id,he,re,r.id,W.tipoEspecial):W.isNew&&a(W.id,r.id),V(null)}else ae.key==="Escape"&&(V(null),W.isNew&&a(W.id,r.id))},onBlur:ae=>{const he=ae.target.value.trim();he?u(W.id,he,re,r.id,W.tipoEspecial):W.isNew&&a(W.id,r.id),V(null)}})}),J=W=>{W.preventDefault(),W.stopPropagation(),W.currentTarget.classList.add("bg-primary/20")},ie=W=>{W.preventDefault(),W.stopPropagation(),W.currentTarget.classList.remove("bg-primary/20")},ne=W=>{W.preventDefault(),W.stopPropagation(),W.currentTarget.classList.remove("bg-primary/20");const re=W.dataTransfer.getData("entityId"),ae=W.dataTransfer.getData("sourceFolderId");re&&ae&&ae!==String(r.id)&&o(re,r.id,ae)};return m.jsxs("div",{className:`space-y-1 select-none ${c||""}`,children:[m.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 rounded-xl text-xs font-bold text-text-muted hover:text-white hover:bg-white/5 cursor-pointer transition-all group relative",onClick:D,onContextMenu:W=>q(W,"folder",r.id,r.nombre),onDragOver:J,onDragLeave:ie,onDrop:ne,children:[m.jsx("span",{onClick:Y,className:`material-symbols-outlined text-lg transition-transform hover:text-primary ${y?"rotate-90 text-primary":"opacity-50"}`,children:"chevron_right"}),m.jsx("span",{className:`material-symbols-outlined text-lg ${w_(r.tipo).color}`,children:w_(r.tipo).icon}),B?m.jsx("input",{autoFocus:!0,className:"bg-surface-light border border-primary/50 rounded px-2 py-0.5 text-xs text-white outline-none flex-1 min-w-0",defaultValue:R,onKeyDown:async W=>{if(W.key==="Enter"){W.preventDefault(),W.stopPropagation();const re=W.target.value.trim();if(re&&re!==R)try{await n(r.id,re),O(re)}catch(ae){console.error("Rename failed",ae)}I(!1)}else W.key==="Escape"&&(W.preventDefault(),W.stopPropagation(),I(!1))},onBlur:()=>I(!1),onClick:W=>W.stopPropagation()}):m.jsx("span",{className:"truncate flex-1",children:R})]}),N&&m.jsxs("div",{className:"fixed bg-surface-dark border border-glass-border shadow-2xl rounded-xl py-2 z-50 w-48 text-xs font-medium flex flex-col",style:{top:N.y,left:N.x},onClick:W=>W.stopPropagation(),children:[m.jsx("div",{className:"px-4 py-2 border-b border-white/5 font-bold text-text-muted truncate",children:N.name}),N.type==="folder"?m.jsxs(m.Fragment,{children:[m.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{l(r.id,"entidadindividual"),G()},children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"person"})," Add Character"]}),m.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{v(`/${d}/${p}/map-editor/create/${r.id}`),G()},children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Add Map"]}),m.jsx("div",{className:"h-px bg-white/5 my-1"}),m.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{I(!0),G()},children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Rename Folder"]}),m.jsxs("button",{className:"px-4 py-2 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-2",onClick:()=>{i(r.id,r.parentId),G()},children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Delete Folder"]})]}):m.jsxs(m.Fragment,{children:[m.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2 cursor-pointer",onClick:()=>{V(N.id),G()},children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Rename"]}),m.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2 cursor-pointer",onClick:async()=>{try{await rt.entityService.toggleFavorite(N.id),window.dispatchEvent(new CustomEvent("favorites-update")),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:r.id}}))}catch(W){console.error(W)}G()},children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-500",children:"star"})," Toggle Favorite"]}),m.jsxs("button",{className:"px-4 py-2 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-2",onClick:()=>{a(N.id,r.id),G()},children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Delete Entity"]})]})]}),y&&m.jsxs("div",{className:"ml-6 pl-4 border-l border-glass-border space-y-1 animate-slide-in",children:[S.folders.map(W=>m.jsx(Lj,{folder:W,onCreateSubfolder:e,onRename:n,onDeleteFolder:i,onDeleteEntity:a,onCreateTemplate:s,onMoveEntity:o,onCreateEntity:l,onConfirmCreate:u},W.id)),S.entities.map(W=>W.isNew||W.id===z?m.jsx(Q,{item:W,type:"entity"},W.id):m.jsxs(Oh,{to:WX(d,p,W,r.slug||r.id),onContextMenu:re=>q(re,"entity",W.id,W.nombre),className:`flex items-center gap-3 px-3 py-2 rounded-xl text-[11px] font-medium text-text-muted hover:text-white hover:bg-primary/10 transition-all group cursor-grab active:cursor-grabbing ${W.pending?"opacity-50 pointer-events-none":""}`,draggable:!W.pending,onDragStart:re=>{re.dataTransfer.setData("entityId",W.id),re.dataTransfer.setData("sourceFolderId",r.id)},children:[m.jsx("span",{className:"material-symbols-outlined text-sm opacity-70 group-hover:text-primary transition-colors",children:qX(W.tipoEspecial)}),m.jsx("span",{className:"truncate flex-1",children:W.nombre}),W.favorite&&m.jsx("span",{className:"material-symbols-outlined text-[10px] text-yellow-500",title:"Favorito",children:"star"})]},W.id)),T&&S.folders.length===0&&S.entities.length===0&&m.jsx("div",{className:"px-3 py-2 text-[10px] text-text-muted/30 uppercase font-black italic tracking-tighter",children:"Empty Sector"})]})]})},$X=({isOpen:r,onClose:e,onCreate:n,parentFolder:i})=>{const[a,s]=ce.useState({nombre:"",descripcion:"",tipo:"FOLDER",canvasType:"BLANK"});if(!r)return null;const o=()=>{n(a),e(),s({nombre:"",descripcion:"",tipo:"FOLDER",canvasType:"BLANK"})},l=[Th.UNIVERSE,Th.GALAXY,Th.SYSTEM,Th.PLANET];return m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:m.jsxs("div",{className:"bg-[#1a1b26] w-full max-w-4xl rounded-2xl shadow-2xl border border-white/10 overflow-hidden flex flex-col max-h-[90vh]",children:[m.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-[#1f202e]",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:m.jsx("span",{className:"material-icons text-sm",children:"add"})}),m.jsx("h2",{className:"text-xl font-semibold text-white",children:i?"Crear Nuevo Espacio":"Crear Nuevo Mapa"})]}),m.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition",children:m.jsx("span",{className:"material-icons",children:"close"})})]}),m.jsx("div",{className:"p-8 overflow-y-auto flex-1",children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[m.jsxs("div",{className:"space-y-6",children:[m.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-indigo-400",children:"Identidad"}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-2",children:"Nombre del Espacio"}),m.jsx("input",{autoFocus:!0,type:"text",value:a.nombre,onChange:u=>s({...a,nombre:u.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-indigo-500/50 transition-all shadow-inner",placeholder:"ej. Sistema Solar"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-2",children:"Descripcin"}),m.jsx("textarea",{value:a.descripcion,onChange:u=>s({...a,descripcion:u.target.value}),className:"w-full h-32 bg-black/40 border border-white/5 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-indigo-500/50 resize-none transition-all",placeholder:"Detalles sobre este nivel jerrquico..."})]})]}),m.jsxs("div",{className:"space-y-6",children:[m.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-indigo-400",children:"Configuracin"}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-1",children:"Tipo de Jerarqua"}),m.jsx("div",{className:"grid grid-cols-2 gap-2",children:l.concat([{id:"FOLDER",label:"Carpeta",icon:"folder",color:"text-white/50"}]).map(u=>m.jsxs("div",{onClick:()=>s({...a,tipo:u.id}),className:`flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all ${a.tipo===u.id?"bg-indigo-500/10 border-indigo-500/50":"bg-white/5 border-white/5 hover:bg-white/10"}`,children:[m.jsx("span",{className:`material-icons text-lg ${u.color||""}`,children:u.icon}),m.jsx("span",{className:"text-xs font-bold text-white/80",children:u.label})]},u.id||"FOLDER"))})]}),m.jsx("div",{className:"p-4 rounded-2xl bg-indigo-500/5 border border-indigo-500/10",children:m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:m.jsx("span",{className:"material-icons",children:"info"})}),m.jsxs("div",{children:[m.jsx("p",{className:"text-[10px] uppercase font-black text-indigo-300",children:"Ubicacin Actual"}),m.jsx("p",{className:"text-xs text-indigo-100/50",children:i?i.nombre:"Raz del Mundo"})]})]})})]})]})}),m.jsxs("div",{className:"p-6 border-t border-white/5 flex justify-end gap-3 bg-[#1f202e]",children:[m.jsx("button",{onClick:e,className:"px-6 py-3 rounded-xl text-xs font-black uppercase tracking-widest text-text-muted hover:text-white transition",children:"Cancelar"}),m.jsx("button",{onClick:o,disabled:!a.nombre,className:"px-8 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-black uppercase tracking-widest shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-30 disabled:pointer-events-none",children:"Confirmar y Crear"})]})]})})},KX=()=>{const{username:r,projectName:e}=Yi(),n=Na(),{handleCreateEntity:i,...a}=au()||{},{t:s}=Xu(),[o,l]=ce.useState([]),[u,c]=ce.useState([]),[d,p]=ce.useState(!1),[v,y]=ce.useState(!1),[b,S]=ce.useState(null),[k,T]=ce.useState(!1),[C,N]=ce.useState(null),P=`/${r}/${e}/bible`;ce.useEffect(()=>{R(),O();const Z=()=>O();return window.addEventListener("favorites-update",Z),()=>window.removeEventListener("favorites-update",Z)},[e]);const R=async()=>{try{const Z=await rt.get("/world-bible/folders");l(Z)}catch(Z){console.error("Error loading folders:",Z)}},O=async()=>{try{const Z=await rt.get("/world-bible/favorites");c(Z)}catch(Z){console.error("Error loading favorites:",Z)}},B=(Z=null)=>{S(Z),y(!0),p(!1)},I=async(Z=null,Q="FOLDER")=>{try{const J=Z?typeof Z=="object"?Z.id:Z:null,ie=await rt.post("/world-bible/folders",{nombre:s(Q==="TIMELINE"?"bible.new_timeline":"bible.new_folder"),padreId:J,tipo:Q});if(J===null){const ne=await rt.get("/world-bible/folders");l(ne),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:null}}))}else window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:J,optimisticType:"folder",item:ie,expand:!0}}))}catch(J){console.error("Error creating simple folder:",J)}},z=async Z=>{try{const Q=b?b.id:null,J=await rt.post("/world-bible/folders",{nombre:Z.nombre,descripcion:Z.descripcion,padreId:Q,tipo:Z.tipo});if(Q===null){const ie=await rt.get("/world-bible/folders");l(ie),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:null}}))}else J.id||console.error("CRITICAL: Created folder has no ID!",J),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:Q,optimisticType:"folder",item:J,expand:!0}}))}catch(Q){console.error(Q),alert("Error creating folder/zone.")}},V=async(Z,Q="entidadindividual")=>{const J=typeof Z=="object"?Z.slug||Z.id:Z;n(`${P}/folder/${J}/entity/new/${Q}`)},$=async(Z,Q)=>{try{await rt.put(`/world-bible/folders/${Z}`,{nombre:Q}),l(J=>J.map(ie=>ie.id===Z?{...ie,nombre:Q}:ie))}catch(J){throw J}},Y=(Z,Q=null)=>{N({id:Z,parentId:Q,type:"folder"}),T(!0)},D=async()=>{if(!C)return;const{id:Z,parentId:Q,type:J,folderId:ie}=C;try{J==="folder"?(await rt.delete(`/world-bible/folders/${Z}`),Q===null&&l(ne=>ne.filter(W=>W.id!==Z)),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:Q,removeId:Z,type:"folder"}}))):J==="entity"&&(await rt.delete(`/world-bible/entities/${Z}`),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:ie,removeId:Z,type:"entity"}})))}catch(ne){console.error("Deletion failed:",ne),alert("Error trying to delete item.")}finally{N(null)}},q=(Z,Q)=>{N({id:Z,folderId:Q,type:"entity"}),T(!0)},G=async(Z,Q,J,ie,ne)=>{try{if(J==="folder")typeof Z=="number"&&!Z.toString().startsWith("temp")&&(await rt.put(`/world-bible/folders/${Z}`,{nombre:Q}),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:ie,confirmedType:"folder",oldId:Z,item:{id:Z,nombre:Q,parentId:ie,tipo:ne,uiKey:Date.now()}}})),ie||l(W=>W.map(re=>re.id===Z?{...re,nombre:Q}:re)));else if(J==="entity")if(typeof Z=="string"&&Z.startsWith("new-")){const W=await rt.post("/world-bible/entities",{nombre:Q,carpetaId:ie,tipoEspecial:ne||"entidadindividual"});window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:ie,confirmedType:"entity",oldId:Z,item:W}}))}else await rt.put(`/world-bible/entities/${Z}`,{nombre:Q}),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:ie,confirmedType:"entity",oldId:Z,item:{id:Z,nombre:Q,carpeta:{id:ie},tipoEspecial:ne,slug:Z}}})),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:ie}}))}catch(W){console.error("Creation/Rename failed",W),J==="folder"&&Y(Z,ie)}};return m.jsxs("div",{className:"flex h-full w-full bg-background-dark max-w-[1920px] mx-auto",children:[m.jsxs("aside",{className:"w-80 flex-none flex flex-col border-r border-glass-border bg-surface-dark/50 z-10",children:[m.jsx("div",{className:"p-4 border-b border-glass-border",children:m.jsxs("div",{className:"relative group mb-3",children:[m.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-text-muted text-sm group-focus-within:text-primary transition-colors",children:"search"}),m.jsx("input",{type:"text",placeholder:s("bible.search_placeholder"),className:"w-full bg-surface-light/50 border border-glass-border rounded-xl py-2 pl-9 pr-3 text-xs focus:border-primary/50 outline-none transition-all text-white placeholder:text-text-muted/50"})]})}),m.jsxs("div",{className:"px-2 pt-2",children:[m.jsx("div",{className:"flex items-center justify-between px-2 mb-1",children:m.jsx("h2",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted",children:s("bible.favorites")})}),u.length>0?m.jsx("div",{className:"space-y-0.5",children:u.map(Z=>m.jsxs("div",{onClick:()=>n(`${P}/folder/${Z.carpeta.slug||Z.carpeta.id}/entity/${Z.slug||Z.id}`),className:"flex items-center gap-3 px-3 py-1.5 rounded-lg text-[11px] font-medium text-text-muted hover:text-white hover:bg-white/5 cursor-pointer transition-all group",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-500/70 group-hover:text-yellow-400",children:"star"}),m.jsx("span",{className:"truncate",children:Z.nombre})]},Z.id))}):m.jsx("div",{className:"px-4 py-2 text-[10px] text-text-muted/30 italic",children:s("bible.no_favorites")}),m.jsx("div",{className:"h-px bg-glass-border my-2 opacity-50"})]}),m.jsx("div",{className:"p-4 border-b border-glass-border pt-0",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h2",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted",children:s("bible.explorer")}),m.jsx("div",{className:"relative",children:m.jsx("button",{className:"transition-colors hover:text-white text-primary",onClick:()=>I(null),title:s("bible.new_folder"),children:m.jsx("span",{className:"material-symbols-outlined text-sm",children:"create_new_folder"})})})]})}),m.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar p-2 space-y-0.5",children:o.length===0?m.jsxs("div",{className:"p-8 text-center opacity-30",children:[m.jsx("span",{className:"material-symbols-outlined text-3xl mb-2",children:"folder_off"}),m.jsx("p",{className:"text-[10px] uppercase font-bold",children:s("bible.empty_bible")})]}):o.map(Z=>m.jsx(Lj,{folder:Z,onCreateSubfolder:()=>{},onRename:$,onDeleteFolder:Y,onDeleteEntity:Y,onCreateTemplate:()=>{},onMoveEntity:(Q,J,ie)=>console.log("move",Q,J,ie),onCreateEntity:V,onConfirmCreate:G},Z.uiKey||Z.id))})]}),m.jsx("main",{className:"flex-1 overflow-hidden relative bg-gradient-to-br from-background-dark to-surface-dark/20",children:m.jsx(k_,{context:{...a,folders:o,handleCreateEntity:V,handleOpenCreateModal:B,handleDeleteFolder:Y,handleDeleteEntity:q,handleCreateSimpleFolder:I}})}),m.jsx($X,{isOpen:v,onClose:()=>y(!1),onCreate:z,parentFolder:b}),m.jsx(av,{isOpen:k,onClose:()=>T(!1),onConfirm:D,title:C?.type==="folder"?s("bible.delete_folder"):s("bible.delete_entity"),message:C?.type==="folder"?s("bible.delete_folder_msg"):s("bible.delete_entity_msg"),confirmText:s("common.confirm_delete")})]})},ZX=()=>{const{username:r,projectName:e}=Yi();Na();const{handleOpenCreateModal:n,handleDeleteFolder:i,handleCreateSimpleFolder:a,handleRenameFolder:s,folders:o=[]}=au(),{t:l}=Xu(),[u,c]=ce.useState(null),[d,p]=ce.useState(null),[v,y]=ce.useState(""),b=(T,C)=>{T.preventDefault(),T.stopPropagation(),c({x:T.clientX,y:T.clientY,folder:C})},S=()=>c(null);ce.useEffect(()=>{if(u){const T=()=>S();return window.addEventListener("click",T),()=>window.removeEventListener("click",T)}},[u]);const k=async(T,C)=>{C.trim()&&s&&await s(T,C.trim()),p(null),y("")};return o===void 0?m.jsx("div",{className:"p-20 text-center animate-pulse text-text-muted",children:l("bible.loading_bible")}):m.jsxs("div",{className:"flex-1 p-8 max-w-[1600px] mx-auto w-full h-full overflow-y-auto",children:[m.jsxs("header",{className:"mb-8 flex items-end justify-between",children:[m.jsxs("div",{children:[m.jsxs("div",{className:"flex items-center gap-3 text-xs font-black uppercase tracking-widest text-primary italic mb-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"}),l("nav.bible")]}),m.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter",children:l("bible.root_index")}),m.jsx("p",{className:"text-text-muted mt-2 max-w-lg text-sm",children:l("bible.central_archive")})]}),m.jsx("div",{className:"flex items-center gap-2",children:m.jsxs("button",{onClick:()=>a(null,"FOLDER"),className:"px-6 py-2 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold flex items-center gap-2 transition-all shadow-lg shadow-primary/20",children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"create_new_folder"})," ",l("bible.new_folder")]})})]}),m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:o.map(T=>d===T.id?m.jsx("div",{className:"p-4 rounded-3xl bg-surface-dark border border-primary/50",children:m.jsx("input",{autoFocus:!0,type:"text",value:v,onChange:C=>y(C.target.value),onKeyDown:C=>{C.key==="Enter"&&k(T.id,v),C.key==="Escape"&&(p(null),y(""))},onBlur:()=>k(T.id,v),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none",placeholder:l("bible.rename")})},T.id):m.jsx(b_,{item:T,type:"folder",linkTo:`/${r}/${e}/bible/folder/${T.slug||T.id}`,onDelete:()=>i(T.id),onContextMenu:C=>b(C,T)},T.id))}),o.length===0&&m.jsxs("div",{className:"p-20 text-center border-2 border-dashed border-glass-border rounded-[3rem] opacity-30 mt-8",children:[m.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 text-text-muted",children:"library_books"}),m.jsx("h3",{className:"text-xl font-bold text-white uppercase tracking-widest",children:l("bible.empty_archive")}),m.jsx("p",{className:"text-text-muted mt-2",children:l("bible.empty_archive_desc")})]}),u&&m.jsxs("div",{className:"fixed bg-surface-dark border border-glass-border shadow-2xl rounded-xl py-2 z-50 w-52 text-xs font-medium flex flex-col animate-in fade-in zoom-in-95 duration-150",style:{top:u.y,left:u.x},onClick:T=>T.stopPropagation(),children:[m.jsxs("div",{className:"px-4 py-2 border-b border-white/5 font-bold text-text-muted truncate flex items-center gap-2",children:[m.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"folder"}),u.folder.nombre]}),m.jsxs("button",{className:"px-4 py-2.5 hover:bg-white/5 text-left flex items-center gap-3 text-white/80 hover:text-white transition-colors",onClick:()=>{p(u.folder.id),y(u.folder.nombre),S()},children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," ",l("bible.rename")]}),m.jsxs("button",{className:"px-4 py-2.5 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-3 transition-colors",onClick:()=>{i(u.folder.id),S()},children:[m.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," ",l("bible.delete_folder")]})]})]})};function YX(){const[r,e]=ce.useState("deep_space"),[n,i]=ce.useState(null);return ce.useEffect(()=>{const a=localStorage.getItem("app_settings");if(a){const l=JSON.parse(a);l.theme&&e(l.theme)}const s=localStorage.getItem("user");s&&s!=="undefined"&&i(JSON.parse(s));const o=()=>{const l=localStorage.getItem("app_settings");if(l){const c=JSON.parse(l);c.theme&&e(c.theme)}const u=localStorage.getItem("user");u&&u!=="undefined"&&i(JSON.parse(u))};return window.addEventListener("storage_update",o),()=>window.removeEventListener("storage_update",o)},[]),ce.useEffect(()=>{document.body.classList.forEach(a=>{a.startsWith("theme-")&&document.body.classList.remove(a)}),document.body.classList.add(`theme-${r}`)},[r]),m.jsx(S8,{children:m.jsx("div",{className:`app-container theme-${r} h-screen w-screen overflow-hidden`,children:m.jsx(hL,{children:m.jsxs(iL,{children:[m.jsx(An,{path:"/",element:m.jsx(n8,{})}),m.jsxs(An,{element:m.jsx(YL,{}),children:[m.jsx(An,{path:"/settings",element:m.jsx(C8,{})}),m.jsxs(An,{path:"/:username/:projectName",element:m.jsx(N8,{}),children:[m.jsx(An,{index:!0,element:m.jsx(k8,{})}),m.jsx(An,{path:"writing",element:m.jsx(DX,{})}),m.jsx(An,{path:"writing/:notebookId",element:m.jsx(OX,{})}),m.jsx(An,{path:"entities/:type/:entityId",element:m.jsx(kz,{})}),m.jsx(An,{path:"map-editor/create/:folderId",element:m.jsx(B2,{mode:"create"})}),m.jsx(An,{path:"map-editor/edit/:entityId",element:m.jsx(B2,{mode:"edit"})}),m.jsxs(An,{path:"bible",element:m.jsx(KX,{}),children:[m.jsx(An,{index:!0,element:m.jsx(ZX,{})}),m.jsx(An,{path:"folder/:folderSlug/entity/new/:type",element:m.jsx(sg,{mode:"creation"})}),m.jsx(An,{path:"folder/:folderSlug",element:m.jsx(GX,{})}),m.jsx(An,{path:"entity/:entitySlug",element:m.jsx(sg,{})}),m.jsx(An,{path:"folder/:folderSlug/entity/:entitySlug",element:m.jsx(sg,{})}),m.jsx(An,{path:"folder/:folderSlug/map/:entitySlug",element:m.jsx(sg,{})}),m.jsx(An,{path:"folder/:folderSlug/timeline/:entitySlug",element:m.jsx(sg,{})})]}),m.jsx(An,{path:"map",element:m.jsx(ZV,{})}),m.jsx(An,{path:"timeline",element:m.jsx(Cz,{})}),m.jsx(An,{path:"languages",element:m.jsx(JV,{})}),m.jsx(An,{path:"trash",element:m.jsx(IX,{})}),m.jsx(An,{path:"graph",element:m.jsx(xz,{})})]})]})]})})})})}const JS=(r,e,n,i="")=>{fetch("/api/logs/error",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:r,message:e,stack:n,componentStack:i})}).catch(a=>console.error("Failed to send error log:",a))};window.onerror=(r,e,n,i,a)=>{JS("Global Window Error",r,a?a.stack:`${e}:${n}:${i}`)};window.onunhandledrejection=r=>{JS("Unhandled Promise Rejection",r.reason?r.reason.message:"Unknown reason",r.reason?r.reason.stack:"")};class XX extends Xt.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,n){this.setState({error:e,errorInfo:n}),console.error("Uncaught Error:",e,n),JS("React ErrorBoundary",e.message,e.stack,n.componentStack)}render(){return this.state.hasError?m.jsxs("div",{style:{padding:20,background:"#222",color:"red",height:"100vh"},children:[m.jsx("h1",{children:"Something went wrong."}),m.jsxs("details",{style:{whiteSpace:"pre-wrap"},children:[this.state.error&&this.state.error.toString(),m.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}):this.props.children}}const e4=document.getElementById("root");e4?hR.createRoot(e4).render(m.jsx(Xt.StrictMode,{children:m.jsx(XX,{children:m.jsx(YX,{})})})):console.error("React root element not found (looked for #root)");

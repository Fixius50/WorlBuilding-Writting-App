function rB(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var sE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Up(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var JM={exports:{}},_y={},ZM={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gp=Symbol.for("react.element"),nB=Symbol.for("react.portal"),iB=Symbol.for("react.fragment"),aB=Symbol.for("react.strict_mode"),sB=Symbol.for("react.profiler"),oB=Symbol.for("react.provider"),lB=Symbol.for("react.context"),uB=Symbol.for("react.forward_ref"),cB=Symbol.for("react.suspense"),dB=Symbol.for("react.memo"),fB=Symbol.for("react.lazy"),oE=Symbol.iterator;function hB(t){return t===null||typeof t!="object"?null:(t=oE&&t[oE]||t["@@iterator"],typeof t=="function"?t:null)}var eP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},tP=Object.assign,rP={};function Qd(t,e,r){this.props=t,this.context=e,this.refs=rP,this.updater=r||eP}Qd.prototype.isReactComponent={};Qd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Qd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function nP(){}nP.prototype=Qd.prototype;function Yk(t,e,r){this.props=t,this.context=e,this.refs=rP,this.updater=r||eP}var Xk=Yk.prototype=new nP;Xk.constructor=Yk;tP(Xk,Qd.prototype);Xk.isPureReactComponent=!0;var lE=Array.isArray,iP=Object.prototype.hasOwnProperty,Qk={current:null},aP={key:!0,ref:!0,__self:!0,__source:!0};function sP(t,e,r){var n,i={},a=null,s=null;if(e!=null)for(n in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(a=""+e.key),e)iP.call(e,n)&&!aP.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Gp,type:t,key:a,ref:s,props:i,_owner:Qk.current}}function pB(t,e){return{$$typeof:Gp,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Jk(t){return typeof t=="object"&&t!==null&&t.$$typeof===Gp}function mB(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var uE=/\/+/g;function Lb(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mB(""+t.key):e.toString(36)}function pv(t,e,r,n,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Gp:case nB:s=!0}}if(s)return s=t,i=i(s),t=n===""?"."+Lb(s,0):n,lE(i)?(r="",t!=null&&(r=t.replace(uE,"$&/")+"/"),pv(i,e,r,"",function(u){return u})):i!=null&&(Jk(i)&&(i=pB(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(uE,"$&/")+"/")+t)),e.push(i)),1;if(s=0,n=n===""?".":n+":",lE(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+Lb(a,o);s+=pv(a,e,r,l,i)}else if(l=hB(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+Lb(a,o++),s+=pv(a,e,r,l,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function fg(t,e,r){if(t==null)return t;var n=[],i=0;return pv(t,n,"","",function(a){return e.call(r,a,i++)}),n}function gB(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ni={current:null},mv={transition:null},vB={ReactCurrentDispatcher:ni,ReactCurrentBatchConfig:mv,ReactCurrentOwner:Qk};function oP(){throw Error("act(...) is not supported in production builds of React.")}wt.Children={map:fg,forEach:function(t,e,r){fg(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return fg(t,function(){e++}),e},toArray:function(t){return fg(t,function(e){return e})||[]},only:function(t){if(!Jk(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};wt.Component=Qd;wt.Fragment=iB;wt.Profiler=sB;wt.PureComponent=Yk;wt.StrictMode=aB;wt.Suspense=cB;wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vB;wt.act=oP;wt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=tP({},t.props),i=t.key,a=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,s=Qk.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)iP.call(e,l)&&!aP.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Gp,type:t.type,key:i,ref:a,props:n,_owner:s}};wt.createContext=function(t){return t={$$typeof:lB,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:oB,_context:t},t.Consumer=t};wt.createElement=sP;wt.createFactory=function(t){var e=sP.bind(null,t);return e.type=t,e};wt.createRef=function(){return{current:null}};wt.forwardRef=function(t){return{$$typeof:uB,render:t}};wt.isValidElement=Jk;wt.lazy=function(t){return{$$typeof:fB,_payload:{_status:-1,_result:t},_init:gB}};wt.memo=function(t,e){return{$$typeof:dB,type:t,compare:e===void 0?null:e}};wt.startTransition=function(t){var e=mv.transition;mv.transition={};try{t()}finally{mv.transition=e}};wt.unstable_act=oP;wt.useCallback=function(t,e){return ni.current.useCallback(t,e)};wt.useContext=function(t){return ni.current.useContext(t)};wt.useDebugValue=function(){};wt.useDeferredValue=function(t){return ni.current.useDeferredValue(t)};wt.useEffect=function(t,e){return ni.current.useEffect(t,e)};wt.useId=function(){return ni.current.useId()};wt.useImperativeHandle=function(t,e,r){return ni.current.useImperativeHandle(t,e,r)};wt.useInsertionEffect=function(t,e){return ni.current.useInsertionEffect(t,e)};wt.useLayoutEffect=function(t,e){return ni.current.useLayoutEffect(t,e)};wt.useMemo=function(t,e){return ni.current.useMemo(t,e)};wt.useReducer=function(t,e,r){return ni.current.useReducer(t,e,r)};wt.useRef=function(t){return ni.current.useRef(t)};wt.useState=function(t){return ni.current.useState(t)};wt.useSyncExternalStore=function(t,e,r){return ni.current.useSyncExternalStore(t,e,r)};wt.useTransition=function(){return ni.current.useTransition()};wt.version="18.3.1";ZM.exports=wt;var K=ZM.exports;const kt=Up(K),yB=rB({__proto__:null,default:kt},[K]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xB=K,bB=Symbol.for("react.element"),wB=Symbol.for("react.fragment"),SB=Object.prototype.hasOwnProperty,kB=xB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,CB={key:!0,ref:!0,__self:!0,__source:!0};function lP(t,e,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(s=e.ref);for(n in e)SB.call(e,n)&&!CB.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:bB,type:t,key:a,ref:s,props:i,_owner:kB.current}}_y.Fragment=wB;_y.jsx=lP;_y.jsxs=lP;JM.exports=_y;var f=JM.exports,FS={},uP={exports:{}},Oi={},cP={exports:{}},dP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,J){var Y=V.length;V.push(J);e:for(;0<Y;){var L=Y-1>>>1,G=V[L];if(0<i(G,J))V[L]=J,V[Y]=G,Y=L;else break e}}function r(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var J=V[0],Y=V.pop();if(Y!==J){V[0]=Y;e:for(var L=0,G=V.length,ee=G>>>1;L<ee;){var re=2*(L+1)-1,se=V[re],de=re+1,W=V[de];if(0>i(se,Y))de<G&&0>i(W,se)?(V[L]=W,V[de]=Y,L=de):(V[L]=se,V[re]=Y,L=re);else if(de<G&&0>i(W,Y))V[L]=W,V[de]=Y,L=de;else break e}}return J}function i(V,J){var Y=V.sortIndex-J.sortIndex;return Y!==0?Y:V.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();t.unstable_now=function(){return s.now()-o}}var l=[],u=[],c=1,d=null,h=3,m=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(V){for(var J=r(u);J!==null;){if(J.callback===null)n(u);else if(J.startTime<=V)n(u),J.sortIndex=J.expirationTime,e(l,J);else break;J=r(u)}}function k(V){if(x=!1,w(V),!v)if(r(l)!==null)v=!0,z(N);else{var J=r(u);J!==null&&F(k,J.startTime-V)}}function N(V,J){v=!1,x&&(x=!1,b(M),M=-1),m=!0;var Y=h;try{for(w(J),d=r(l);d!==null&&(!(d.expirationTime>J)||V&&!D());){var L=d.callback;if(typeof L=="function"){d.callback=null,h=d.priorityLevel;var G=L(d.expirationTime<=J);J=t.unstable_now(),typeof G=="function"?d.callback=G:d===r(l)&&n(l),w(J)}else n(l);d=r(l)}if(d!==null)var ee=!0;else{var re=r(u);re!==null&&F(k,re.startTime-J),ee=!1}return ee}finally{d=null,h=Y,m=!1}}var T=!1,j=null,M=-1,A=5,P=-1;function D(){return!(t.unstable_now()-P<A)}function R(){if(j!==null){var V=t.unstable_now();P=V;var J=!0;try{J=j(!0,V)}finally{J?I():(T=!1,j=null)}}else T=!1}var I;if(typeof S=="function")I=function(){S(R)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,B=U.port2;U.port1.onmessage=R,I=function(){B.postMessage(null)}}else I=function(){y(R,0)};function z(V){j=V,T||(T=!0,I())}function F(V,J){M=y(function(){V(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,z(N))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(V){switch(h){case 1:case 2:case 3:var J=3;break;default:J=h}var Y=h;h=J;try{return V()}finally{h=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,J){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Y=h;h=V;try{return J()}finally{h=Y}},t.unstable_scheduleCallback=function(V,J,Y){var L=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?L+Y:L):Y=L,V){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=Y+G,V={id:c++,callback:J,priorityLevel:V,startTime:Y,expirationTime:G,sortIndex:-1},Y>L?(V.sortIndex=Y,e(u,V),r(l)===null&&V===r(u)&&(x?(b(M),M=-1):x=!0,F(k,Y-L))):(V.sortIndex=G,e(l,V),v||m||(v=!0,z(N))),V},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(V){var J=h;return function(){var Y=h;h=J;try{return V.apply(this,arguments)}finally{h=Y}}}})(dP);cP.exports=dP;var Eh=cP.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NB=K,Ri=Eh;function Se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fP=new Set,Jh={};function Xu(t,e){Nd(t,e),Nd(t+"Capture",e)}function Nd(t,e){for(Jh[t]=e,t=0;t<e.length;t++)fP.add(e[t])}var Ys=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zS=Object.prototype.hasOwnProperty,EB=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cE={},dE={};function TB(t){return zS.call(dE,t)?!0:zS.call(cE,t)?!1:EB.test(t)?dE[t]=!0:(cE[t]=!0,!1)}function jB(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function MB(t,e,r,n){if(e===null||typeof e>"u"||jB(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ii(t,e,r,n,i,a,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=s}var jn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){jn[t]=new ii(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];jn[e]=new ii(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){jn[t]=new ii(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){jn[t]=new ii(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){jn[t]=new ii(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){jn[t]=new ii(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){jn[t]=new ii(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){jn[t]=new ii(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){jn[t]=new ii(t,5,!1,t.toLowerCase(),null,!1,!1)});var Zk=/[\-:]([a-z])/g;function eC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Zk,eC);jn[e]=new ii(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Zk,eC);jn[e]=new ii(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Zk,eC);jn[e]=new ii(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){jn[t]=new ii(t,1,!1,t.toLowerCase(),null,!1,!1)});jn.xlinkHref=new ii("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){jn[t]=new ii(t,1,!1,t.toLowerCase(),null,!0,!0)});function tC(t,e,r,n){var i=jn.hasOwnProperty(e)?jn[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(MB(e,r,i,n)&&(r=null),n||i===null?TB(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var no=NB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hg=Symbol.for("react.element"),Kc=Symbol.for("react.portal"),Yc=Symbol.for("react.fragment"),rC=Symbol.for("react.strict_mode"),VS=Symbol.for("react.profiler"),hP=Symbol.for("react.provider"),pP=Symbol.for("react.context"),nC=Symbol.for("react.forward_ref"),$S=Symbol.for("react.suspense"),US=Symbol.for("react.suspense_list"),iC=Symbol.for("react.memo"),Ro=Symbol.for("react.lazy"),mP=Symbol.for("react.offscreen"),fE=Symbol.iterator;function Bf(t){return t===null||typeof t!="object"?null:(t=fE&&t[fE]||t["@@iterator"],typeof t=="function"?t:null)}var yr=Object.assign,Bb;function ph(t){if(Bb===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Bb=e&&e[1]||""}return`
`+Bb+t}var Fb=!1;function zb(t,e){if(!t||Fb)return"";Fb=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=o);break}}}finally{Fb=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ph(t):""}function PB(t){switch(t.tag){case 5:return ph(t.type);case 16:return ph("Lazy");case 13:return ph("Suspense");case 19:return ph("SuspenseList");case 0:case 2:case 15:return t=zb(t.type,!1),t;case 11:return t=zb(t.type.render,!1),t;case 1:return t=zb(t.type,!0),t;default:return""}}function GS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Yc:return"Fragment";case Kc:return"Portal";case VS:return"Profiler";case rC:return"StrictMode";case $S:return"Suspense";case US:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case pP:return(t.displayName||"Context")+".Consumer";case hP:return(t._context.displayName||"Context")+".Provider";case nC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case iC:return e=t.displayName||null,e!==null?e:GS(t.type)||"Memo";case Ro:e=t._payload,t=t._init;try{return GS(t(e))}catch{}}return null}function _B(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return GS(e);case 8:return e===rC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function gP(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function AB(t){var e=gP(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function pg(t){t._valueTracker||(t._valueTracker=AB(t))}function vP(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=gP(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Hv(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function HS(t,e){var r=e.checked;return yr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function hE(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=hl(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function yP(t,e){e=e.checked,e!=null&&tC(t,"checked",e,!1)}function WS(t,e){yP(t,e);var r=hl(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?qS(t,e.type,r):e.hasOwnProperty("defaultValue")&&qS(t,e.type,hl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function pE(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function qS(t,e,r){(e!=="number"||Hv(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var mh=Array.isArray;function dd(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+hl(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function KS(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Se(91));return yr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function mE(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Se(92));if(mh(r)){if(1<r.length)throw Error(Se(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:hl(r)}}function xP(t,e){var r=hl(e.value),n=hl(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function gE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function bP(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function YS(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?bP(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var mg,wP=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(mg=mg||document.createElement("div"),mg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Zh(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Th={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},RB=["Webkit","ms","Moz","O"];Object.keys(Th).forEach(function(t){RB.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Th[e]=Th[t]})});function SP(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Th.hasOwnProperty(t)&&Th[t]?(""+e).trim():e+"px"}function kP(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=SP(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var DB=yr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function XS(t,e){if(e){if(DB[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Se(62))}}function QS(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JS=null;function aC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ZS=null,fd=null,hd=null;function vE(t){if(t=qp(t)){if(typeof ZS!="function")throw Error(Se(280));var e=t.stateNode;e&&(e=Iy(e),ZS(t.stateNode,t.type,e))}}function CP(t){fd?hd?hd.push(t):hd=[t]:fd=t}function NP(){if(fd){var t=fd,e=hd;if(hd=fd=null,vE(t),e)for(t=0;t<e.length;t++)vE(e[t])}}function EP(t,e){return t(e)}function TP(){}var Vb=!1;function jP(t,e,r){if(Vb)return t(e,r);Vb=!0;try{return EP(t,e,r)}finally{Vb=!1,(fd!==null||hd!==null)&&(TP(),NP())}}function ep(t,e){var r=t.stateNode;if(r===null)return null;var n=Iy(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Se(231,e,typeof r));return r}var e5=!1;if(Ys)try{var Ff={};Object.defineProperty(Ff,"passive",{get:function(){e5=!0}}),window.addEventListener("test",Ff,Ff),window.removeEventListener("test",Ff,Ff)}catch{e5=!1}function OB(t,e,r,n,i,a,s,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(c){this.onError(c)}}var jh=!1,Wv=null,qv=!1,t5=null,IB={onError:function(t){jh=!0,Wv=t}};function LB(t,e,r,n,i,a,s,o,l){jh=!1,Wv=null,OB.apply(IB,arguments)}function BB(t,e,r,n,i,a,s,o,l){if(LB.apply(this,arguments),jh){if(jh){var u=Wv;jh=!1,Wv=null}else throw Error(Se(198));qv||(qv=!0,t5=u)}}function Qu(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function MP(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function yE(t){if(Qu(t)!==t)throw Error(Se(188))}function FB(t){var e=t.alternate;if(!e){if(e=Qu(t),e===null)throw Error(Se(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return yE(i),t;if(a===n)return yE(i),e;a=a.sibling}throw Error(Se(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(Se(189))}}if(r.alternate!==n)throw Error(Se(190))}if(r.tag!==3)throw Error(Se(188));return r.stateNode.current===r?t:e}function PP(t){return t=FB(t),t!==null?_P(t):null}function _P(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=_P(t);if(e!==null)return e;t=t.sibling}return null}var AP=Ri.unstable_scheduleCallback,xE=Ri.unstable_cancelCallback,zB=Ri.unstable_shouldYield,VB=Ri.unstable_requestPaint,Ar=Ri.unstable_now,$B=Ri.unstable_getCurrentPriorityLevel,sC=Ri.unstable_ImmediatePriority,RP=Ri.unstable_UserBlockingPriority,Kv=Ri.unstable_NormalPriority,UB=Ri.unstable_LowPriority,DP=Ri.unstable_IdlePriority,Ay=null,ls=null;function GB(t){if(ls&&typeof ls.onCommitFiberRoot=="function")try{ls.onCommitFiberRoot(Ay,t,void 0,(t.current.flags&128)===128)}catch{}}var Aa=Math.clz32?Math.clz32:qB,HB=Math.log,WB=Math.LN2;function qB(t){return t>>>=0,t===0?32:31-(HB(t)/WB|0)|0}var gg=64,vg=4194304;function gh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Yv(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,a=t.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=gh(o):(a&=s,a!==0&&(n=gh(a)))}else s=r&~i,s!==0?n=gh(s):a!==0&&(n=gh(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Aa(e),i=1<<r,n|=t[r],e&=~i;return n}function KB(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function YB(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var s=31-Aa(a),o=1<<s,l=i[s];l===-1?(!(o&r)||o&n)&&(i[s]=KB(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function r5(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function OP(){var t=gg;return gg<<=1,!(gg&4194240)&&(gg=64),t}function $b(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Hp(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Aa(e),t[e]=r}function XB(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Aa(r),a=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~a}}function oC(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Aa(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Ft=0;function IP(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var LP,lC,BP,FP,zP,n5=!1,yg=[],Jo=null,Zo=null,el=null,tp=new Map,rp=new Map,Fo=[],QB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bE(t,e){switch(t){case"focusin":case"focusout":Jo=null;break;case"dragenter":case"dragleave":Zo=null;break;case"mouseover":case"mouseout":el=null;break;case"pointerover":case"pointerout":tp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rp.delete(e.pointerId)}}function zf(t,e,r,n,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},e!==null&&(e=qp(e),e!==null&&lC(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function JB(t,e,r,n,i){switch(e){case"focusin":return Jo=zf(Jo,t,e,r,n,i),!0;case"dragenter":return Zo=zf(Zo,t,e,r,n,i),!0;case"mouseover":return el=zf(el,t,e,r,n,i),!0;case"pointerover":var a=i.pointerId;return tp.set(a,zf(tp.get(a)||null,t,e,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,rp.set(a,zf(rp.get(a)||null,t,e,r,n,i)),!0}return!1}function VP(t){var e=mu(t.target);if(e!==null){var r=Qu(e);if(r!==null){if(e=r.tag,e===13){if(e=MP(r),e!==null){t.blockedOn=e,zP(t.priority,function(){BP(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function gv(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=i5(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);JS=n,r.target.dispatchEvent(n),JS=null}else return e=qp(r),e!==null&&lC(e),t.blockedOn=r,!1;e.shift()}return!0}function wE(t,e,r){gv(t)&&r.delete(e)}function ZB(){n5=!1,Jo!==null&&gv(Jo)&&(Jo=null),Zo!==null&&gv(Zo)&&(Zo=null),el!==null&&gv(el)&&(el=null),tp.forEach(wE),rp.forEach(wE)}function Vf(t,e){t.blockedOn===e&&(t.blockedOn=null,n5||(n5=!0,Ri.unstable_scheduleCallback(Ri.unstable_NormalPriority,ZB)))}function np(t){function e(i){return Vf(i,t)}if(0<yg.length){Vf(yg[0],t);for(var r=1;r<yg.length;r++){var n=yg[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Jo!==null&&Vf(Jo,t),Zo!==null&&Vf(Zo,t),el!==null&&Vf(el,t),tp.forEach(e),rp.forEach(e),r=0;r<Fo.length;r++)n=Fo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Fo.length&&(r=Fo[0],r.blockedOn===null);)VP(r),r.blockedOn===null&&Fo.shift()}var pd=no.ReactCurrentBatchConfig,Xv=!0;function eF(t,e,r,n){var i=Ft,a=pd.transition;pd.transition=null;try{Ft=1,uC(t,e,r,n)}finally{Ft=i,pd.transition=a}}function tF(t,e,r,n){var i=Ft,a=pd.transition;pd.transition=null;try{Ft=4,uC(t,e,r,n)}finally{Ft=i,pd.transition=a}}function uC(t,e,r,n){if(Xv){var i=i5(t,e,r,n);if(i===null)Jb(t,e,n,Qv,r),bE(t,n);else if(JB(i,t,e,r,n))n.stopPropagation();else if(bE(t,n),e&4&&-1<QB.indexOf(t)){for(;i!==null;){var a=qp(i);if(a!==null&&LP(a),a=i5(t,e,r,n),a===null&&Jb(t,e,n,Qv,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else Jb(t,e,n,null,r)}}var Qv=null;function i5(t,e,r,n){if(Qv=null,t=aC(n),t=mu(t),t!==null)if(e=Qu(t),e===null)t=null;else if(r=e.tag,r===13){if(t=MP(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Qv=t,null}function $P(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($B()){case sC:return 1;case RP:return 4;case Kv:case UB:return 16;case DP:return 536870912;default:return 16}default:return 16}}var Uo=null,cC=null,vv=null;function UP(){if(vv)return vv;var t,e=cC,r=e.length,n,i="value"in Uo?Uo.value:Uo.textContent,a=i.length;for(t=0;t<r&&e[t]===i[t];t++);var s=r-t;for(n=1;n<=s&&e[r-n]===i[a-n];n++);return vv=i.slice(t,1<n?1-n:void 0)}function yv(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function xg(){return!0}function SE(){return!1}function Ii(t){function e(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?xg:SE,this.isPropagationStopped=SE,this}return yr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=xg)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=xg)},persist:function(){},isPersistent:xg}),e}var Jd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dC=Ii(Jd),Wp=yr({},Jd,{view:0,detail:0}),rF=Ii(Wp),Ub,Gb,$f,Ry=yr({},Wp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fC,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$f&&($f&&t.type==="mousemove"?(Ub=t.screenX-$f.screenX,Gb=t.screenY-$f.screenY):Gb=Ub=0,$f=t),Ub)},movementY:function(t){return"movementY"in t?t.movementY:Gb}}),kE=Ii(Ry),nF=yr({},Ry,{dataTransfer:0}),iF=Ii(nF),aF=yr({},Wp,{relatedTarget:0}),Hb=Ii(aF),sF=yr({},Jd,{animationName:0,elapsedTime:0,pseudoElement:0}),oF=Ii(sF),lF=yr({},Jd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uF=Ii(lF),cF=yr({},Jd,{data:0}),CE=Ii(cF),dF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pF(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=hF[t])?!!e[t]:!1}function fC(){return pF}var mF=yr({},Wp,{key:function(t){if(t.key){var e=dF[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=yv(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fF[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fC,charCode:function(t){return t.type==="keypress"?yv(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yv(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),gF=Ii(mF),vF=yr({},Ry,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),NE=Ii(vF),yF=yr({},Wp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fC}),xF=Ii(yF),bF=yr({},Jd,{propertyName:0,elapsedTime:0,pseudoElement:0}),wF=Ii(bF),SF=yr({},Ry,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),kF=Ii(SF),CF=[9,13,27,32],hC=Ys&&"CompositionEvent"in window,Mh=null;Ys&&"documentMode"in document&&(Mh=document.documentMode);var NF=Ys&&"TextEvent"in window&&!Mh,GP=Ys&&(!hC||Mh&&8<Mh&&11>=Mh),EE=String.fromCharCode(32),TE=!1;function HP(t,e){switch(t){case"keyup":return CF.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function WP(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Xc=!1;function EF(t,e){switch(t){case"compositionend":return WP(e);case"keypress":return e.which!==32?null:(TE=!0,EE);case"textInput":return t=e.data,t===EE&&TE?null:t;default:return null}}function TF(t,e){if(Xc)return t==="compositionend"||!hC&&HP(t,e)?(t=UP(),vv=cC=Uo=null,Xc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return GP&&e.locale!=="ko"?null:e.data;default:return null}}var jF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!jF[t.type]:e==="textarea"}function qP(t,e,r,n){CP(n),e=Jv(e,"onChange"),0<e.length&&(r=new dC("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ph=null,ip=null;function MF(t){i_(t,0)}function Dy(t){var e=Zc(t);if(vP(e))return t}function PF(t,e){if(t==="change")return e}var KP=!1;if(Ys){var Wb;if(Ys){var qb="oninput"in document;if(!qb){var ME=document.createElement("div");ME.setAttribute("oninput","return;"),qb=typeof ME.oninput=="function"}Wb=qb}else Wb=!1;KP=Wb&&(!document.documentMode||9<document.documentMode)}function PE(){Ph&&(Ph.detachEvent("onpropertychange",YP),ip=Ph=null)}function YP(t){if(t.propertyName==="value"&&Dy(ip)){var e=[];qP(e,ip,t,aC(t)),jP(MF,e)}}function _F(t,e,r){t==="focusin"?(PE(),Ph=e,ip=r,Ph.attachEvent("onpropertychange",YP)):t==="focusout"&&PE()}function AF(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Dy(ip)}function RF(t,e){if(t==="click")return Dy(e)}function DF(t,e){if(t==="input"||t==="change")return Dy(e)}function OF(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ia=typeof Object.is=="function"?Object.is:OF;function ap(t,e){if(Ia(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!zS.call(e,i)||!Ia(t[i],e[i]))return!1}return!0}function _E(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function AE(t,e){var r=_E(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=_E(r)}}function XP(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?XP(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function QP(){for(var t=window,e=Hv();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Hv(t.document)}return e}function pC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function IF(t){var e=QP(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&XP(r.ownerDocument.documentElement,r)){if(n!==null&&pC(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!t.extend&&a>n&&(i=n,n=a,a=i),i=AE(r,a);var s=AE(r,n);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var LF=Ys&&"documentMode"in document&&11>=document.documentMode,Qc=null,a5=null,_h=null,s5=!1;function RE(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;s5||Qc==null||Qc!==Hv(n)||(n=Qc,"selectionStart"in n&&pC(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),_h&&ap(_h,n)||(_h=n,n=Jv(a5,"onSelect"),0<n.length&&(e=new dC("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Qc)))}function bg(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Jc={animationend:bg("Animation","AnimationEnd"),animationiteration:bg("Animation","AnimationIteration"),animationstart:bg("Animation","AnimationStart"),transitionend:bg("Transition","TransitionEnd")},Kb={},JP={};Ys&&(JP=document.createElement("div").style,"AnimationEvent"in window||(delete Jc.animationend.animation,delete Jc.animationiteration.animation,delete Jc.animationstart.animation),"TransitionEvent"in window||delete Jc.transitionend.transition);function Oy(t){if(Kb[t])return Kb[t];if(!Jc[t])return t;var e=Jc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in JP)return Kb[t]=e[r];return t}var ZP=Oy("animationend"),e_=Oy("animationiteration"),t_=Oy("animationstart"),r_=Oy("transitionend"),n_=new Map,DE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cl(t,e){n_.set(t,e),Xu(e,[t])}for(var Yb=0;Yb<DE.length;Yb++){var Xb=DE[Yb],BF=Xb.toLowerCase(),FF=Xb[0].toUpperCase()+Xb.slice(1);Cl(BF,"on"+FF)}Cl(ZP,"onAnimationEnd");Cl(e_,"onAnimationIteration");Cl(t_,"onAnimationStart");Cl("dblclick","onDoubleClick");Cl("focusin","onFocus");Cl("focusout","onBlur");Cl(r_,"onTransitionEnd");Nd("onMouseEnter",["mouseout","mouseover"]);Nd("onMouseLeave",["mouseout","mouseover"]);Nd("onPointerEnter",["pointerout","pointerover"]);Nd("onPointerLeave",["pointerout","pointerover"]);Xu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zF=new Set("cancel close invalid load scroll toggle".split(" ").concat(vh));function OE(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,BB(n,e,void 0,t),t.currentTarget=null}function i_(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;OE(i,o,u),a=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;OE(i,o,u),a=l}}}if(qv)throw t=t5,qv=!1,t5=null,t}function er(t,e){var r=e[d5];r===void 0&&(r=e[d5]=new Set);var n=t+"__bubble";r.has(n)||(a_(e,t,2,!1),r.add(n))}function Qb(t,e,r){var n=0;e&&(n|=4),a_(r,t,n,e)}var wg="_reactListening"+Math.random().toString(36).slice(2);function sp(t){if(!t[wg]){t[wg]=!0,fP.forEach(function(r){r!=="selectionchange"&&(zF.has(r)||Qb(r,!1,t),Qb(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[wg]||(e[wg]=!0,Qb("selectionchange",!1,e))}}function a_(t,e,r,n){switch($P(e)){case 1:var i=eF;break;case 4:i=tF;break;default:i=uC}r=i.bind(null,e,r,t),i=void 0,!e5||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Jb(t,e,r,n,i){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;o!==null;){if(s=mu(o),s===null)return;if(l=s.tag,l===5||l===6){n=a=s;continue e}o=o.parentNode}}n=n.return}jP(function(){var u=a,c=aC(r),d=[];e:{var h=n_.get(t);if(h!==void 0){var m=dC,v=t;switch(t){case"keypress":if(yv(r)===0)break e;case"keydown":case"keyup":m=gF;break;case"focusin":v="focus",m=Hb;break;case"focusout":v="blur",m=Hb;break;case"beforeblur":case"afterblur":m=Hb;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=kE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=iF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=xF;break;case ZP:case e_:case t_:m=oF;break;case r_:m=wF;break;case"scroll":m=rF;break;case"wheel":m=kF;break;case"copy":case"cut":case"paste":m=uF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=NE}var x=(e&4)!==0,y=!x&&t==="scroll",b=x?h!==null?h+"Capture":null:h;x=[];for(var S=u,w;S!==null;){w=S;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,b!==null&&(k=ep(S,b),k!=null&&x.push(op(S,k,w)))),y)break;S=S.return}0<x.length&&(h=new m(h,v,null,r,c),d.push({event:h,listeners:x}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&r!==JS&&(v=r.relatedTarget||r.fromElement)&&(mu(v)||v[Xs]))break e;if((m||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=u,v=v?mu(v):null,v!==null&&(y=Qu(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=u),m!==v)){if(x=kE,k="onMouseLeave",b="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(x=NE,k="onPointerLeave",b="onPointerEnter",S="pointer"),y=m==null?h:Zc(m),w=v==null?h:Zc(v),h=new x(k,S+"leave",m,r,c),h.target=y,h.relatedTarget=w,k=null,mu(c)===u&&(x=new x(b,S+"enter",v,r,c),x.target=w,x.relatedTarget=y,k=x),y=k,m&&v)t:{for(x=m,b=v,S=0,w=x;w;w=Tc(w))S++;for(w=0,k=b;k;k=Tc(k))w++;for(;0<S-w;)x=Tc(x),S--;for(;0<w-S;)b=Tc(b),w--;for(;S--;){if(x===b||b!==null&&x===b.alternate)break t;x=Tc(x),b=Tc(b)}x=null}else x=null;m!==null&&IE(d,h,m,x,!1),v!==null&&y!==null&&IE(d,y,v,x,!0)}}e:{if(h=u?Zc(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var N=PF;else if(jE(h))if(KP)N=DF;else{N=AF;var T=_F}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=RF);if(N&&(N=N(t,u))){qP(d,N,r,c);break e}T&&T(t,h,u),t==="focusout"&&(T=h._wrapperState)&&T.controlled&&h.type==="number"&&qS(h,"number",h.value)}switch(T=u?Zc(u):window,t){case"focusin":(jE(T)||T.contentEditable==="true")&&(Qc=T,a5=u,_h=null);break;case"focusout":_h=a5=Qc=null;break;case"mousedown":s5=!0;break;case"contextmenu":case"mouseup":case"dragend":s5=!1,RE(d,r,c);break;case"selectionchange":if(LF)break;case"keydown":case"keyup":RE(d,r,c)}var j;if(hC)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Xc?HP(t,r)&&(M="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(M="onCompositionStart");M&&(GP&&r.locale!=="ko"&&(Xc||M!=="onCompositionStart"?M==="onCompositionEnd"&&Xc&&(j=UP()):(Uo=c,cC="value"in Uo?Uo.value:Uo.textContent,Xc=!0)),T=Jv(u,M),0<T.length&&(M=new CE(M,t,null,r,c),d.push({event:M,listeners:T}),j?M.data=j:(j=WP(r),j!==null&&(M.data=j)))),(j=NF?EF(t,r):TF(t,r))&&(u=Jv(u,"onBeforeInput"),0<u.length&&(c=new CE("onBeforeInput","beforeinput",null,r,c),d.push({event:c,listeners:u}),c.data=j))}i_(d,e)})}function op(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Jv(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=ep(t,r),a!=null&&n.unshift(op(t,a,i)),a=ep(t,e),a!=null&&n.push(op(t,a,i))),t=t.return}return n}function Tc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function IE(t,e,r,n,i){for(var a=e._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=ep(r,a),l!=null&&s.unshift(op(r,l,o))):i||(l=ep(r,a),l!=null&&s.push(op(r,l,o)))),r=r.return}s.length!==0&&t.push({event:e,listeners:s})}var VF=/\r\n?/g,$F=/\u0000|\uFFFD/g;function LE(t){return(typeof t=="string"?t:""+t).replace(VF,`
`).replace($F,"")}function Sg(t,e,r){if(e=LE(e),LE(t)!==e&&r)throw Error(Se(425))}function Zv(){}var o5=null,l5=null;function u5(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var c5=typeof setTimeout=="function"?setTimeout:void 0,UF=typeof clearTimeout=="function"?clearTimeout:void 0,BE=typeof Promise=="function"?Promise:void 0,GF=typeof queueMicrotask=="function"?queueMicrotask:typeof BE<"u"?function(t){return BE.resolve(null).then(t).catch(HF)}:c5;function HF(t){setTimeout(function(){throw t})}function Zb(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),np(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);np(e)}function tl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function FE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Zd=Math.random().toString(36).slice(2),is="__reactFiber$"+Zd,lp="__reactProps$"+Zd,Xs="__reactContainer$"+Zd,d5="__reactEvents$"+Zd,WF="__reactListeners$"+Zd,qF="__reactHandles$"+Zd;function mu(t){var e=t[is];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Xs]||r[is]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=FE(t);t!==null;){if(r=t[is])return r;t=FE(t)}return e}t=r,r=t.parentNode}return null}function qp(t){return t=t[is]||t[Xs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Se(33))}function Iy(t){return t[lp]||null}var f5=[],ed=-1;function Nl(t){return{current:t}}function rr(t){0>ed||(t.current=f5[ed],f5[ed]=null,ed--)}function Xt(t,e){ed++,f5[ed]=t.current,t.current=e}var pl={},Un=Nl(pl),yi=Nl(!1),Au=pl;function Ed(t,e){var r=t.type.contextTypes;if(!r)return pl;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function xi(t){return t=t.childContextTypes,t!=null}function e0(){rr(yi),rr(Un)}function zE(t,e,r){if(Un.current!==pl)throw Error(Se(168));Xt(Un,e),Xt(yi,r)}function s_(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Se(108,_B(t)||"Unknown",i));return yr({},r,n)}function t0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||pl,Au=Un.current,Xt(Un,t),Xt(yi,yi.current),!0}function VE(t,e,r){var n=t.stateNode;if(!n)throw Error(Se(169));r?(t=s_(t,e,Au),n.__reactInternalMemoizedMergedChildContext=t,rr(yi),rr(Un),Xt(Un,t)):rr(yi),Xt(yi,r)}var Fs=null,Ly=!1,ew=!1;function o_(t){Fs===null?Fs=[t]:Fs.push(t)}function KF(t){Ly=!0,o_(t)}function El(){if(!ew&&Fs!==null){ew=!0;var t=0,e=Ft;try{var r=Fs;for(Ft=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Fs=null,Ly=!1}catch(i){throw Fs!==null&&(Fs=Fs.slice(t+1)),AP(sC,El),i}finally{Ft=e,ew=!1}}return null}var td=[],rd=0,r0=null,n0=0,Zi=[],ea=0,Ru=null,Vs=1,$s="";function ou(t,e){td[rd++]=n0,td[rd++]=r0,r0=t,n0=e}function l_(t,e,r){Zi[ea++]=Vs,Zi[ea++]=$s,Zi[ea++]=Ru,Ru=t;var n=Vs;t=$s;var i=32-Aa(n)-1;n&=~(1<<i),r+=1;var a=32-Aa(e)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,Vs=1<<32-Aa(e)+i|r<<i|n,$s=a+t}else Vs=1<<a|r<<i|n,$s=t}function mC(t){t.return!==null&&(ou(t,1),l_(t,1,0))}function gC(t){for(;t===r0;)r0=td[--rd],td[rd]=null,n0=td[--rd],td[rd]=null;for(;t===Ru;)Ru=Zi[--ea],Zi[ea]=null,$s=Zi[--ea],Zi[ea]=null,Vs=Zi[--ea],Zi[ea]=null}var _i=null,Pi=null,or=!1,ja=null;function u_(t,e){var r=na(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function $E(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,_i=t,Pi=tl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,_i=t,Pi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ru!==null?{id:Vs,overflow:$s}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=na(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,_i=t,Pi=null,!0):!1;default:return!1}}function h5(t){return(t.mode&1)!==0&&(t.flags&128)===0}function p5(t){if(or){var e=Pi;if(e){var r=e;if(!$E(t,e)){if(h5(t))throw Error(Se(418));e=tl(r.nextSibling);var n=_i;e&&$E(t,e)?u_(n,r):(t.flags=t.flags&-4097|2,or=!1,_i=t)}}else{if(h5(t))throw Error(Se(418));t.flags=t.flags&-4097|2,or=!1,_i=t}}}function UE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;_i=t}function kg(t){if(t!==_i)return!1;if(!or)return UE(t),or=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!u5(t.type,t.memoizedProps)),e&&(e=Pi)){if(h5(t))throw c_(),Error(Se(418));for(;e;)u_(t,e),e=tl(e.nextSibling)}if(UE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Pi=tl(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Pi=null}}else Pi=_i?tl(t.stateNode.nextSibling):null;return!0}function c_(){for(var t=Pi;t;)t=tl(t.nextSibling)}function Td(){Pi=_i=null,or=!1}function vC(t){ja===null?ja=[t]:ja.push(t)}var YF=no.ReactCurrentBatchConfig;function Uf(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Se(309));var n=r.stateNode}if(!n)throw Error(Se(147,t));var i=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},e._stringRef=a,e)}if(typeof t!="string")throw Error(Se(284));if(!r._owner)throw Error(Se(290,t))}return t}function Cg(t,e){throw t=Object.prototype.toString.call(e),Error(Se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function GE(t){var e=t._init;return e(t._payload)}function d_(t){function e(b,S){if(t){var w=b.deletions;w===null?(b.deletions=[S],b.flags|=16):w.push(S)}}function r(b,S){if(!t)return null;for(;S!==null;)e(b,S),S=S.sibling;return null}function n(b,S){for(b=new Map;S!==null;)S.key!==null?b.set(S.key,S):b.set(S.index,S),S=S.sibling;return b}function i(b,S){return b=al(b,S),b.index=0,b.sibling=null,b}function a(b,S,w){return b.index=w,t?(w=b.alternate,w!==null?(w=w.index,w<S?(b.flags|=2,S):w):(b.flags|=2,S)):(b.flags|=1048576,S)}function s(b){return t&&b.alternate===null&&(b.flags|=2),b}function o(b,S,w,k){return S===null||S.tag!==6?(S=ow(w,b.mode,k),S.return=b,S):(S=i(S,w),S.return=b,S)}function l(b,S,w,k){var N=w.type;return N===Yc?c(b,S,w.props.children,k,w.key):S!==null&&(S.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ro&&GE(N)===S.type)?(k=i(S,w.props),k.ref=Uf(b,S,w),k.return=b,k):(k=Nv(w.type,w.key,w.props,null,b.mode,k),k.ref=Uf(b,S,w),k.return=b,k)}function u(b,S,w,k){return S===null||S.tag!==4||S.stateNode.containerInfo!==w.containerInfo||S.stateNode.implementation!==w.implementation?(S=lw(w,b.mode,k),S.return=b,S):(S=i(S,w.children||[]),S.return=b,S)}function c(b,S,w,k,N){return S===null||S.tag!==7?(S=Nu(w,b.mode,k,N),S.return=b,S):(S=i(S,w),S.return=b,S)}function d(b,S,w){if(typeof S=="string"&&S!==""||typeof S=="number")return S=ow(""+S,b.mode,w),S.return=b,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case hg:return w=Nv(S.type,S.key,S.props,null,b.mode,w),w.ref=Uf(b,null,S),w.return=b,w;case Kc:return S=lw(S,b.mode,w),S.return=b,S;case Ro:var k=S._init;return d(b,k(S._payload),w)}if(mh(S)||Bf(S))return S=Nu(S,b.mode,w,null),S.return=b,S;Cg(b,S)}return null}function h(b,S,w,k){var N=S!==null?S.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return N!==null?null:o(b,S,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case hg:return w.key===N?l(b,S,w,k):null;case Kc:return w.key===N?u(b,S,w,k):null;case Ro:return N=w._init,h(b,S,N(w._payload),k)}if(mh(w)||Bf(w))return N!==null?null:c(b,S,w,k,null);Cg(b,w)}return null}function m(b,S,w,k,N){if(typeof k=="string"&&k!==""||typeof k=="number")return b=b.get(w)||null,o(S,b,""+k,N);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case hg:return b=b.get(k.key===null?w:k.key)||null,l(S,b,k,N);case Kc:return b=b.get(k.key===null?w:k.key)||null,u(S,b,k,N);case Ro:var T=k._init;return m(b,S,w,T(k._payload),N)}if(mh(k)||Bf(k))return b=b.get(w)||null,c(S,b,k,N,null);Cg(S,k)}return null}function v(b,S,w,k){for(var N=null,T=null,j=S,M=S=0,A=null;j!==null&&M<w.length;M++){j.index>M?(A=j,j=null):A=j.sibling;var P=h(b,j,w[M],k);if(P===null){j===null&&(j=A);break}t&&j&&P.alternate===null&&e(b,j),S=a(P,S,M),T===null?N=P:T.sibling=P,T=P,j=A}if(M===w.length)return r(b,j),or&&ou(b,M),N;if(j===null){for(;M<w.length;M++)j=d(b,w[M],k),j!==null&&(S=a(j,S,M),T===null?N=j:T.sibling=j,T=j);return or&&ou(b,M),N}for(j=n(b,j);M<w.length;M++)A=m(j,b,M,w[M],k),A!==null&&(t&&A.alternate!==null&&j.delete(A.key===null?M:A.key),S=a(A,S,M),T===null?N=A:T.sibling=A,T=A);return t&&j.forEach(function(D){return e(b,D)}),or&&ou(b,M),N}function x(b,S,w,k){var N=Bf(w);if(typeof N!="function")throw Error(Se(150));if(w=N.call(w),w==null)throw Error(Se(151));for(var T=N=null,j=S,M=S=0,A=null,P=w.next();j!==null&&!P.done;M++,P=w.next()){j.index>M?(A=j,j=null):A=j.sibling;var D=h(b,j,P.value,k);if(D===null){j===null&&(j=A);break}t&&j&&D.alternate===null&&e(b,j),S=a(D,S,M),T===null?N=D:T.sibling=D,T=D,j=A}if(P.done)return r(b,j),or&&ou(b,M),N;if(j===null){for(;!P.done;M++,P=w.next())P=d(b,P.value,k),P!==null&&(S=a(P,S,M),T===null?N=P:T.sibling=P,T=P);return or&&ou(b,M),N}for(j=n(b,j);!P.done;M++,P=w.next())P=m(j,b,M,P.value,k),P!==null&&(t&&P.alternate!==null&&j.delete(P.key===null?M:P.key),S=a(P,S,M),T===null?N=P:T.sibling=P,T=P);return t&&j.forEach(function(R){return e(b,R)}),or&&ou(b,M),N}function y(b,S,w,k){if(typeof w=="object"&&w!==null&&w.type===Yc&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case hg:e:{for(var N=w.key,T=S;T!==null;){if(T.key===N){if(N=w.type,N===Yc){if(T.tag===7){r(b,T.sibling),S=i(T,w.props.children),S.return=b,b=S;break e}}else if(T.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ro&&GE(N)===T.type){r(b,T.sibling),S=i(T,w.props),S.ref=Uf(b,T,w),S.return=b,b=S;break e}r(b,T);break}else e(b,T);T=T.sibling}w.type===Yc?(S=Nu(w.props.children,b.mode,k,w.key),S.return=b,b=S):(k=Nv(w.type,w.key,w.props,null,b.mode,k),k.ref=Uf(b,S,w),k.return=b,b=k)}return s(b);case Kc:e:{for(T=w.key;S!==null;){if(S.key===T)if(S.tag===4&&S.stateNode.containerInfo===w.containerInfo&&S.stateNode.implementation===w.implementation){r(b,S.sibling),S=i(S,w.children||[]),S.return=b,b=S;break e}else{r(b,S);break}else e(b,S);S=S.sibling}S=lw(w,b.mode,k),S.return=b,b=S}return s(b);case Ro:return T=w._init,y(b,S,T(w._payload),k)}if(mh(w))return v(b,S,w,k);if(Bf(w))return x(b,S,w,k);Cg(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,S!==null&&S.tag===6?(r(b,S.sibling),S=i(S,w),S.return=b,b=S):(r(b,S),S=ow(w,b.mode,k),S.return=b,b=S),s(b)):r(b,S)}return y}var jd=d_(!0),f_=d_(!1),i0=Nl(null),a0=null,nd=null,yC=null;function xC(){yC=nd=a0=null}function bC(t){var e=i0.current;rr(i0),t._currentValue=e}function m5(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function md(t,e){a0=t,yC=nd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(gi=!0),t.firstContext=null)}function ca(t){var e=t._currentValue;if(yC!==t)if(t={context:t,memoizedValue:e,next:null},nd===null){if(a0===null)throw Error(Se(308));nd=t,a0.dependencies={lanes:0,firstContext:t}}else nd=nd.next=t;return e}var gu=null;function wC(t){gu===null?gu=[t]:gu.push(t)}function h_(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,wC(e)):(r.next=i.next,i.next=r),e.interleaved=r,Qs(t,n)}function Qs(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Do=!1;function SC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function p_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function rl(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,jt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Qs(t,r)}return i=n.interleaved,i===null?(e.next=e,wC(n)):(e.next=i.next,i.next=e),n.interleaved=e,Qs(t,r)}function xv(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,oC(t,r)}}function HE(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=e:a=a.next=e}else i=a=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function s0(t,e,r,n){var i=t.updateQueue;Do=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,s===null?a=u:s.next=u,s=l;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==s&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(a!==null){var d=i.baseState;s=0,c=u=l=null,o=a;do{var h=o.lane,m=o.eventTime;if((n&h)===h){c!==null&&(c=c.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=t,x=o;switch(h=e,m=r,x.tag){case 1:if(v=x.payload,typeof v=="function"){d=v.call(m,d,h);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,h=typeof v=="function"?v.call(m,d,h):v,h==null)break e;d=yr({},d,h);break e;case 2:Do=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=m,l=d):c=c.next=m,s|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(c===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Ou|=s,t.lanes=s,t.memoizedState=d}}function WE(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Se(191,i));i.call(n)}}}var Kp={},us=Nl(Kp),up=Nl(Kp),cp=Nl(Kp);function vu(t){if(t===Kp)throw Error(Se(174));return t}function kC(t,e){switch(Xt(cp,e),Xt(up,t),Xt(us,Kp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:YS(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=YS(e,t)}rr(us),Xt(us,e)}function Md(){rr(us),rr(up),rr(cp)}function m_(t){vu(cp.current);var e=vu(us.current),r=YS(e,t.type);e!==r&&(Xt(up,t),Xt(us,r))}function CC(t){up.current===t&&(rr(us),rr(up))}var mr=Nl(0);function o0(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var tw=[];function NC(){for(var t=0;t<tw.length;t++)tw[t]._workInProgressVersionPrimary=null;tw.length=0}var bv=no.ReactCurrentDispatcher,rw=no.ReactCurrentBatchConfig,Du=0,gr=null,Xr=null,cn=null,l0=!1,Ah=!1,dp=0,XF=0;function Bn(){throw Error(Se(321))}function EC(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ia(t[r],e[r]))return!1;return!0}function TC(t,e,r,n,i,a){if(Du=a,gr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,bv.current=t===null||t.memoizedState===null?ez:tz,t=r(n,i),Ah){a=0;do{if(Ah=!1,dp=0,25<=a)throw Error(Se(301));a+=1,cn=Xr=null,e.updateQueue=null,bv.current=rz,t=r(n,i)}while(Ah)}if(bv.current=u0,e=Xr!==null&&Xr.next!==null,Du=0,cn=Xr=gr=null,l0=!1,e)throw Error(Se(300));return t}function jC(){var t=dp!==0;return dp=0,t}function Za(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cn===null?gr.memoizedState=cn=t:cn=cn.next=t,cn}function da(){if(Xr===null){var t=gr.alternate;t=t!==null?t.memoizedState:null}else t=Xr.next;var e=cn===null?gr.memoizedState:cn.next;if(e!==null)cn=e,Xr=t;else{if(t===null)throw Error(Se(310));Xr=t,t={memoizedState:Xr.memoizedState,baseState:Xr.baseState,baseQueue:Xr.baseQueue,queue:Xr.queue,next:null},cn===null?gr.memoizedState=cn=t:cn=cn.next=t}return cn}function fp(t,e){return typeof e=="function"?e(t):e}function nw(t){var e=da(),r=e.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=t;var n=Xr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,l=null,u=a;do{var c=u.lane;if((Du&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,s=n):l=l.next=d,gr.lanes|=c,Ou|=c}u=u.next}while(u!==null&&u!==a);l===null?s=n:l.next=o,Ia(n,e.memoizedState)||(gi=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do a=i.lane,gr.lanes|=a,Ou|=a,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function iw(t){var e=da(),r=e.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,a=e.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=t(a,s.action),s=s.next;while(s!==i);Ia(a,e.memoizedState)||(gi=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function g_(){}function v_(t,e){var r=gr,n=da(),i=e(),a=!Ia(n.memoizedState,i);if(a&&(n.memoizedState=i,gi=!0),n=n.queue,MC(b_.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||cn!==null&&cn.memoizedState.tag&1){if(r.flags|=2048,hp(9,x_.bind(null,r,n,i,e),void 0,null),hn===null)throw Error(Se(349));Du&30||y_(r,e,i)}return i}function y_(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=gr.updateQueue,e===null?(e={lastEffect:null,stores:null},gr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function x_(t,e,r,n){e.value=r,e.getSnapshot=n,w_(e)&&S_(t)}function b_(t,e,r){return r(function(){w_(e)&&S_(t)})}function w_(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ia(t,r)}catch{return!0}}function S_(t){var e=Qs(t,1);e!==null&&Ra(e,t,1,-1)}function qE(t){var e=Za();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:fp,lastRenderedState:t},e.queue=t,t=t.dispatch=ZF.bind(null,gr,t),[e.memoizedState,t]}function hp(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=gr.updateQueue,e===null?(e={lastEffect:null,stores:null},gr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function k_(){return da().memoizedState}function wv(t,e,r,n){var i=Za();gr.flags|=t,i.memoizedState=hp(1|e,r,void 0,n===void 0?null:n)}function By(t,e,r,n){var i=da();n=n===void 0?null:n;var a=void 0;if(Xr!==null){var s=Xr.memoizedState;if(a=s.destroy,n!==null&&EC(n,s.deps)){i.memoizedState=hp(e,r,a,n);return}}gr.flags|=t,i.memoizedState=hp(1|e,r,a,n)}function KE(t,e){return wv(8390656,8,t,e)}function MC(t,e){return By(2048,8,t,e)}function C_(t,e){return By(4,2,t,e)}function N_(t,e){return By(4,4,t,e)}function E_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function T_(t,e,r){return r=r!=null?r.concat([t]):null,By(4,4,E_.bind(null,e,t),r)}function PC(){}function j_(t,e){var r=da();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&EC(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function M_(t,e){var r=da();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&EC(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function P_(t,e,r){return Du&21?(Ia(r,e)||(r=OP(),gr.lanes|=r,Ou|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,gi=!0),t.memoizedState=r)}function QF(t,e){var r=Ft;Ft=r!==0&&4>r?r:4,t(!0);var n=rw.transition;rw.transition={};try{t(!1),e()}finally{Ft=r,rw.transition=n}}function __(){return da().memoizedState}function JF(t,e,r){var n=il(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},A_(t))R_(e,r);else if(r=h_(t,e,r,n),r!==null){var i=Zn();Ra(r,t,n,i),D_(r,e,n)}}function ZF(t,e,r){var n=il(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(A_(t))R_(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var s=e.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,Ia(o,s)){var l=e.interleaved;l===null?(i.next=i,wC(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=h_(t,e,i,n),r!==null&&(i=Zn(),Ra(r,t,n,i),D_(r,e,n))}}function A_(t){var e=t.alternate;return t===gr||e!==null&&e===gr}function R_(t,e){Ah=l0=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function D_(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,oC(t,r)}}var u0={readContext:ca,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useInsertionEffect:Bn,useLayoutEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useMutableSource:Bn,useSyncExternalStore:Bn,useId:Bn,unstable_isNewReconciler:!1},ez={readContext:ca,useCallback:function(t,e){return Za().memoizedState=[t,e===void 0?null:e],t},useContext:ca,useEffect:KE,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,wv(4194308,4,E_.bind(null,e,t),r)},useLayoutEffect:function(t,e){return wv(4194308,4,t,e)},useInsertionEffect:function(t,e){return wv(4,2,t,e)},useMemo:function(t,e){var r=Za();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Za();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=JF.bind(null,gr,t),[n.memoizedState,t]},useRef:function(t){var e=Za();return t={current:t},e.memoizedState=t},useState:qE,useDebugValue:PC,useDeferredValue:function(t){return Za().memoizedState=t},useTransition:function(){var t=qE(!1),e=t[0];return t=QF.bind(null,t[1]),Za().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=gr,i=Za();if(or){if(r===void 0)throw Error(Se(407));r=r()}else{if(r=e(),hn===null)throw Error(Se(349));Du&30||y_(n,e,r)}i.memoizedState=r;var a={value:r,getSnapshot:e};return i.queue=a,KE(b_.bind(null,n,a,t),[t]),n.flags|=2048,hp(9,x_.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=Za(),e=hn.identifierPrefix;if(or){var r=$s,n=Vs;r=(n&~(1<<32-Aa(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=dp++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=XF++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},tz={readContext:ca,useCallback:j_,useContext:ca,useEffect:MC,useImperativeHandle:T_,useInsertionEffect:C_,useLayoutEffect:N_,useMemo:M_,useReducer:nw,useRef:k_,useState:function(){return nw(fp)},useDebugValue:PC,useDeferredValue:function(t){var e=da();return P_(e,Xr.memoizedState,t)},useTransition:function(){var t=nw(fp)[0],e=da().memoizedState;return[t,e]},useMutableSource:g_,useSyncExternalStore:v_,useId:__,unstable_isNewReconciler:!1},rz={readContext:ca,useCallback:j_,useContext:ca,useEffect:MC,useImperativeHandle:T_,useInsertionEffect:C_,useLayoutEffect:N_,useMemo:M_,useReducer:iw,useRef:k_,useState:function(){return iw(fp)},useDebugValue:PC,useDeferredValue:function(t){var e=da();return Xr===null?e.memoizedState=t:P_(e,Xr.memoizedState,t)},useTransition:function(){var t=iw(fp)[0],e=da().memoizedState;return[t,e]},useMutableSource:g_,useSyncExternalStore:v_,useId:__,unstable_isNewReconciler:!1};function Ca(t,e){if(t&&t.defaultProps){e=yr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function g5(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:yr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Fy={isMounted:function(t){return(t=t._reactInternals)?Qu(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Zn(),i=il(t),a=Hs(n,i);a.payload=e,r!=null&&(a.callback=r),e=rl(t,a,i),e!==null&&(Ra(e,t,i,n),xv(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Zn(),i=il(t),a=Hs(n,i);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=rl(t,a,i),e!==null&&(Ra(e,t,i,n),xv(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Zn(),n=il(t),i=Hs(r,n);i.tag=2,e!=null&&(i.callback=e),e=rl(t,i,n),e!==null&&(Ra(e,t,n,r),xv(e,t,n))}};function YE(t,e,r,n,i,a,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,s):e.prototype&&e.prototype.isPureReactComponent?!ap(r,n)||!ap(i,a):!0}function O_(t,e,r){var n=!1,i=pl,a=e.contextType;return typeof a=="object"&&a!==null?a=ca(a):(i=xi(e)?Au:Un.current,n=e.contextTypes,a=(n=n!=null)?Ed(t,i):pl),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Fy,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function XE(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Fy.enqueueReplaceState(e,e.state,null)}function v5(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},SC(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=ca(a):(a=xi(e)?Au:Un.current,i.context=Ed(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(g5(t,e,a,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Fy.enqueueReplaceState(i,i.state,null),s0(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Pd(t,e){try{var r="",n=e;do r+=PB(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function aw(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function y5(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var nz=typeof WeakMap=="function"?WeakMap:Map;function I_(t,e,r){r=Hs(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){d0||(d0=!0,j5=n),y5(t,e)},r}function L_(t,e,r){r=Hs(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){y5(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){y5(t,e),typeof n!="function"&&(nl===null?nl=new Set([this]):nl.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),r}function QE(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new nz;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=vz.bind(null,t,e,r),e.then(t,t))}function JE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ZE(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Hs(-1,1),e.tag=2,rl(r,e,1))),r.lanes|=1),t)}var iz=no.ReactCurrentOwner,gi=!1;function Jn(t,e,r,n){e.child=t===null?f_(e,null,r,n):jd(e,t.child,r,n)}function eT(t,e,r,n,i){r=r.render;var a=e.ref;return md(e,i),n=TC(t,e,r,n,a,i),r=jC(),t!==null&&!gi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Js(t,e,i)):(or&&r&&mC(e),e.flags|=1,Jn(t,e,n,i),e.child)}function tT(t,e,r,n,i){if(t===null){var a=r.type;return typeof a=="function"&&!BC(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,B_(t,e,a,n,i)):(t=Nv(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:ap,r(s,n)&&t.ref===e.ref)return Js(t,e,i)}return e.flags|=1,t=al(a,n),t.ref=e.ref,t.return=e,e.child=t}function B_(t,e,r,n,i){if(t!==null){var a=t.memoizedProps;if(ap(a,n)&&t.ref===e.ref)if(gi=!1,e.pendingProps=n=a,(t.lanes&i)!==0)t.flags&131072&&(gi=!0);else return e.lanes=t.lanes,Js(t,e,i)}return x5(t,e,r,n,i)}function F_(t,e,r){var n=e.pendingProps,i=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xt(sd,ji),ji|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Xt(sd,ji),ji|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Xt(sd,ji),ji|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Xt(sd,ji),ji|=n;return Jn(t,e,i,r),e.child}function z_(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function x5(t,e,r,n,i){var a=xi(r)?Au:Un.current;return a=Ed(e,a),md(e,i),r=TC(t,e,r,n,a,i),n=jC(),t!==null&&!gi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Js(t,e,i)):(or&&n&&mC(e),e.flags|=1,Jn(t,e,r,i),e.child)}function rT(t,e,r,n,i){if(xi(r)){var a=!0;t0(e)}else a=!1;if(md(e,i),e.stateNode===null)Sv(t,e),O_(e,r,n),v5(e,r,n,i),n=!0;else if(t===null){var s=e.stateNode,o=e.memoizedProps;s.props=o;var l=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=ca(u):(u=xi(r)?Au:Un.current,u=Ed(e,u));var c=r.getDerivedStateFromProps,d=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==u)&&XE(e,s,n,u),Do=!1;var h=e.memoizedState;s.state=h,s0(e,n,s,i),l=e.memoizedState,o!==n||h!==l||yi.current||Do?(typeof c=="function"&&(g5(e,r,c,n),l=e.memoizedState),(o=Do||YE(e,r,o,n,h,l,u))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),s.props=n,s.state=l,s.context=u,n=o):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{s=e.stateNode,p_(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Ca(e.type,o),s.props=u,d=e.pendingProps,h=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=ca(l):(l=xi(r)?Au:Un.current,l=Ed(e,l));var m=r.getDerivedStateFromProps;(c=typeof m=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==d||h!==l)&&XE(e,s,n,l),Do=!1,h=e.memoizedState,s.state=h,s0(e,n,s,i);var v=e.memoizedState;o!==d||h!==v||yi.current||Do?(typeof m=="function"&&(g5(e,r,m,n),v=e.memoizedState),(u=Do||YE(e,r,u,n,h,v,l)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,v,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,v,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=v),s.props=n,s.state=v,s.context=l,n=u):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return b5(t,e,r,n,a,i)}function b5(t,e,r,n,i,a){z_(t,e);var s=(e.flags&128)!==0;if(!n&&!s)return i&&VE(e,r,!1),Js(t,e,a);n=e.stateNode,iz.current=e;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&s?(e.child=jd(e,t.child,null,a),e.child=jd(e,null,o,a)):Jn(t,e,o,a),e.memoizedState=n.state,i&&VE(e,r,!0),e.child}function V_(t){var e=t.stateNode;e.pendingContext?zE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&zE(t,e.context,!1),kC(t,e.containerInfo)}function nT(t,e,r,n,i){return Td(),vC(i),e.flags|=256,Jn(t,e,r,n),e.child}var w5={dehydrated:null,treeContext:null,retryLane:0};function S5(t){return{baseLanes:t,cachePool:null,transitions:null}}function $_(t,e,r){var n=e.pendingProps,i=mr.current,a=!1,s=(e.flags&128)!==0,o;if((o=s)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Xt(mr,i&1),t===null)return p5(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=n.children,t=n.fallback,a?(n=e.mode,a=e.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=$y(s,n,0,null),t=Nu(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=S5(r),e.memoizedState=w5,t):_C(e,s));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return az(t,e,s,n,o,i,r);if(a){a=n.fallback,s=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=al(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=al(o,a):(a=Nu(a,s,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,s=t.child.memoizedState,s=s===null?S5(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=t.childLanes&~r,e.memoizedState=w5,n}return a=t.child,t=a.sibling,n=al(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function _C(t,e){return e=$y({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ng(t,e,r,n){return n!==null&&vC(n),jd(e,t.child,null,r),t=_C(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function az(t,e,r,n,i,a,s){if(r)return e.flags&256?(e.flags&=-257,n=aw(Error(Se(422))),Ng(t,e,s,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,i=e.mode,n=$y({mode:"visible",children:n.children},i,0,null),a=Nu(a,i,s,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&jd(e,t.child,null,s),e.child.memoizedState=S5(s),e.memoizedState=w5,a);if(!(e.mode&1))return Ng(t,e,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Se(419)),n=aw(a,n,void 0),Ng(t,e,s,n)}if(o=(s&t.childLanes)!==0,gi||o){if(n=hn,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Qs(t,i),Ra(n,t,i,-1))}return LC(),n=aw(Error(Se(421))),Ng(t,e,s,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=yz.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,Pi=tl(i.nextSibling),_i=e,or=!0,ja=null,t!==null&&(Zi[ea++]=Vs,Zi[ea++]=$s,Zi[ea++]=Ru,Vs=t.id,$s=t.overflow,Ru=e),e=_C(e,n.children),e.flags|=4096,e)}function iT(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),m5(t.return,e,r)}function sw(t,e,r,n,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function U_(t,e,r){var n=e.pendingProps,i=n.revealOrder,a=n.tail;if(Jn(t,e,n.children,r),n=mr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&iT(t,r,e);else if(t.tag===19)iT(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Xt(mr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&o0(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),sw(e,!1,i,r,a);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&o0(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}sw(e,!0,r,null,a);break;case"together":sw(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sv(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Js(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ou|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Se(153));if(e.child!==null){for(t=e.child,r=al(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=al(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function sz(t,e,r){switch(e.tag){case 3:V_(e),Td();break;case 5:m_(e);break;case 1:xi(e.type)&&t0(e);break;case 4:kC(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Xt(i0,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Xt(mr,mr.current&1),e.flags|=128,null):r&e.child.childLanes?$_(t,e,r):(Xt(mr,mr.current&1),t=Js(t,e,r),t!==null?t.sibling:null);Xt(mr,mr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return U_(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Xt(mr,mr.current),n)break;return null;case 22:case 23:return e.lanes=0,F_(t,e,r)}return Js(t,e,r)}var G_,k5,H_,W_;G_=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};k5=function(){};H_=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,vu(us.current);var a=null;switch(r){case"input":i=HS(t,i),n=HS(t,n),a=[];break;case"select":i=yr({},i,{value:void 0}),n=yr({},n,{value:void 0}),a=[];break;case"textarea":i=KS(t,i),n=KS(t,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Zv)}XS(r,n);var s;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Jh.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(a||(a=[]),a.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Jh.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&er("scroll",t),a||o===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};W_=function(t,e,r,n){r!==n&&(e.flags|=4)};function Gf(t,e){if(!or)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Fn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function oz(t,e,r){var n=e.pendingProps;switch(gC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fn(e),null;case 1:return xi(e.type)&&e0(),Fn(e),null;case 3:return n=e.stateNode,Md(),rr(yi),rr(Un),NC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(kg(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ja!==null&&(_5(ja),ja=null))),k5(t,e),Fn(e),null;case 5:CC(e);var i=vu(cp.current);if(r=e.type,t!==null&&e.stateNode!=null)H_(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Se(166));return Fn(e),null}if(t=vu(us.current),kg(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[is]=e,n[lp]=a,t=(e.mode&1)!==0,r){case"dialog":er("cancel",n),er("close",n);break;case"iframe":case"object":case"embed":er("load",n);break;case"video":case"audio":for(i=0;i<vh.length;i++)er(vh[i],n);break;case"source":er("error",n);break;case"img":case"image":case"link":er("error",n),er("load",n);break;case"details":er("toggle",n);break;case"input":hE(n,a),er("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},er("invalid",n);break;case"textarea":mE(n,a),er("invalid",n)}XS(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Sg(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Sg(n.textContent,o,t),i=["children",""+o]):Jh.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&er("scroll",n)}switch(r){case"input":pg(n),pE(n,a,!0);break;case"textarea":pg(n),gE(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Zv)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=bP(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=s.createElement(r,{is:n.is}):(t=s.createElement(r),r==="select"&&(s=t,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):t=s.createElementNS(t,r),t[is]=e,t[lp]=n,G_(t,e,!1,!1),e.stateNode=t;e:{switch(s=QS(r,n),r){case"dialog":er("cancel",t),er("close",t),i=n;break;case"iframe":case"object":case"embed":er("load",t),i=n;break;case"video":case"audio":for(i=0;i<vh.length;i++)er(vh[i],t);i=n;break;case"source":er("error",t),i=n;break;case"img":case"image":case"link":er("error",t),er("load",t),i=n;break;case"details":er("toggle",t),i=n;break;case"input":hE(t,n),i=HS(t,n),er("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=yr({},n,{value:void 0}),er("invalid",t);break;case"textarea":mE(t,n),i=KS(t,n),er("invalid",t);break;default:i=n}XS(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?kP(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&wP(t,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Zh(t,l):typeof l=="number"&&Zh(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Jh.hasOwnProperty(a)?l!=null&&a==="onScroll"&&er("scroll",t):l!=null&&tC(t,a,l,s))}switch(r){case"input":pg(t),pE(t,n,!1);break;case"textarea":pg(t),gE(t);break;case"option":n.value!=null&&t.setAttribute("value",""+hl(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?dd(t,!!n.multiple,a,!1):n.defaultValue!=null&&dd(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Zv)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Fn(e),null;case 6:if(t&&e.stateNode!=null)W_(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Se(166));if(r=vu(cp.current),vu(us.current),kg(e)){if(n=e.stateNode,r=e.memoizedProps,n[is]=e,(a=n.nodeValue!==r)&&(t=_i,t!==null))switch(t.tag){case 3:Sg(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Sg(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[is]=e,e.stateNode=n}return Fn(e),null;case 13:if(rr(mr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(or&&Pi!==null&&e.mode&1&&!(e.flags&128))c_(),Td(),e.flags|=98560,a=!1;else if(a=kg(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(Se(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Se(317));a[is]=e}else Td(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Fn(e),a=!1}else ja!==null&&(_5(ja),ja=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||mr.current&1?Qr===0&&(Qr=3):LC())),e.updateQueue!==null&&(e.flags|=4),Fn(e),null);case 4:return Md(),k5(t,e),t===null&&sp(e.stateNode.containerInfo),Fn(e),null;case 10:return bC(e.type._context),Fn(e),null;case 17:return xi(e.type)&&e0(),Fn(e),null;case 19:if(rr(mr),a=e.memoizedState,a===null)return Fn(e),null;if(n=(e.flags&128)!==0,s=a.rendering,s===null)if(n)Gf(a,!1);else{if(Qr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=o0(t),s!==null){for(e.flags|=128,Gf(a,!1),n=s.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,t=s.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Xt(mr,mr.current&1|2),e.child}t=t.sibling}a.tail!==null&&Ar()>_d&&(e.flags|=128,n=!0,Gf(a,!1),e.lanes=4194304)}else{if(!n)if(t=o0(s),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Gf(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!or)return Fn(e),null}else 2*Ar()-a.renderingStartTime>_d&&r!==1073741824&&(e.flags|=128,n=!0,Gf(a,!1),e.lanes=4194304);a.isBackwards?(s.sibling=e.child,e.child=s):(r=a.last,r!==null?r.sibling=s:e.child=s,a.last=s)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Ar(),e.sibling=null,r=mr.current,Xt(mr,n?r&1|2:r&1),e):(Fn(e),null);case 22:case 23:return IC(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?ji&1073741824&&(Fn(e),e.subtreeFlags&6&&(e.flags|=8192)):Fn(e),null;case 24:return null;case 25:return null}throw Error(Se(156,e.tag))}function lz(t,e){switch(gC(e),e.tag){case 1:return xi(e.type)&&e0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Md(),rr(yi),rr(Un),NC(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return CC(e),null;case 13:if(rr(mr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Se(340));Td()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rr(mr),null;case 4:return Md(),null;case 10:return bC(e.type._context),null;case 22:case 23:return IC(),null;case 24:return null;default:return null}}var Eg=!1,Vn=!1,uz=typeof WeakSet=="function"?WeakSet:Set,Fe=null;function ad(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Cr(t,e,n)}else r.current=null}function C5(t,e,r){try{r()}catch(n){Cr(t,e,n)}}var aT=!1;function cz(t,e){if(o5=Xv,t=QP(),pC(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,u=0,c=0,d=t,h=null;t:for(;;){for(var m;d!==r||i!==0&&d.nodeType!==3||(o=s+i),d!==a||n!==0&&d.nodeType!==3||(l=s+n),d.nodeType===3&&(s+=d.nodeValue.length),(m=d.firstChild)!==null;)h=d,d=m;for(;;){if(d===t)break t;if(h===r&&++u===i&&(o=s),h===a&&++c===n&&(l=s),(m=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(l5={focusedElem:t,selectionRange:r},Xv=!1,Fe=e;Fe!==null;)if(e=Fe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Fe=t;else for(;Fe!==null;){e=Fe;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,y=v.memoizedState,b=e.stateNode,S=b.getSnapshotBeforeUpdate(e.elementType===e.type?x:Ca(e.type,x),y);b.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch(k){Cr(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Fe=t;break}Fe=e.return}return v=aT,aT=!1,v}function Rh(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&C5(e,r,a)}i=i.next}while(i!==n)}}function zy(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function N5(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function q_(t){var e=t.alternate;e!==null&&(t.alternate=null,q_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[is],delete e[lp],delete e[d5],delete e[WF],delete e[qF])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function K_(t){return t.tag===5||t.tag===3||t.tag===4}function sT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||K_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function E5(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Zv));else if(n!==4&&(t=t.child,t!==null))for(E5(t,e,r),t=t.sibling;t!==null;)E5(t,e,r),t=t.sibling}function T5(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(T5(t,e,r),t=t.sibling;t!==null;)T5(t,e,r),t=t.sibling}var wn=null,Ea=!1;function Co(t,e,r){for(r=r.child;r!==null;)Y_(t,e,r),r=r.sibling}function Y_(t,e,r){if(ls&&typeof ls.onCommitFiberUnmount=="function")try{ls.onCommitFiberUnmount(Ay,r)}catch{}switch(r.tag){case 5:Vn||ad(r,e);case 6:var n=wn,i=Ea;wn=null,Co(t,e,r),wn=n,Ea=i,wn!==null&&(Ea?(t=wn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):wn.removeChild(r.stateNode));break;case 18:wn!==null&&(Ea?(t=wn,r=r.stateNode,t.nodeType===8?Zb(t.parentNode,r):t.nodeType===1&&Zb(t,r),np(t)):Zb(wn,r.stateNode));break;case 4:n=wn,i=Ea,wn=r.stateNode.containerInfo,Ea=!0,Co(t,e,r),wn=n,Ea=i;break;case 0:case 11:case 14:case 15:if(!Vn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&C5(r,e,s),i=i.next}while(i!==n)}Co(t,e,r);break;case 1:if(!Vn&&(ad(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Cr(r,e,o)}Co(t,e,r);break;case 21:Co(t,e,r);break;case 22:r.mode&1?(Vn=(n=Vn)||r.memoizedState!==null,Co(t,e,r),Vn=n):Co(t,e,r);break;default:Co(t,e,r)}}function oT(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new uz),e.forEach(function(n){var i=xz.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Sa(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=t,s=e,o=s;e:for(;o!==null;){switch(o.tag){case 5:wn=o.stateNode,Ea=!1;break e;case 3:wn=o.stateNode.containerInfo,Ea=!0;break e;case 4:wn=o.stateNode.containerInfo,Ea=!0;break e}o=o.return}if(wn===null)throw Error(Se(160));Y_(a,s,i),wn=null,Ea=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Cr(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)X_(e,t),e=e.sibling}function X_(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Sa(e,t),Ka(t),n&4){try{Rh(3,t,t.return),zy(3,t)}catch(x){Cr(t,t.return,x)}try{Rh(5,t,t.return)}catch(x){Cr(t,t.return,x)}}break;case 1:Sa(e,t),Ka(t),n&512&&r!==null&&ad(r,r.return);break;case 5:if(Sa(e,t),Ka(t),n&512&&r!==null&&ad(r,r.return),t.flags&32){var i=t.stateNode;try{Zh(i,"")}catch(x){Cr(t,t.return,x)}}if(n&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,s=r!==null?r.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&yP(i,a),QS(o,s);var u=QS(o,a);for(s=0;s<l.length;s+=2){var c=l[s],d=l[s+1];c==="style"?kP(i,d):c==="dangerouslySetInnerHTML"?wP(i,d):c==="children"?Zh(i,d):tC(i,c,d,u)}switch(o){case"input":WS(i,a);break;case"textarea":xP(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?dd(i,!!a.multiple,m,!1):h!==!!a.multiple&&(a.defaultValue!=null?dd(i,!!a.multiple,a.defaultValue,!0):dd(i,!!a.multiple,a.multiple?[]:"",!1))}i[lp]=a}catch(x){Cr(t,t.return,x)}}break;case 6:if(Sa(e,t),Ka(t),n&4){if(t.stateNode===null)throw Error(Se(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(x){Cr(t,t.return,x)}}break;case 3:if(Sa(e,t),Ka(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{np(e.containerInfo)}catch(x){Cr(t,t.return,x)}break;case 4:Sa(e,t),Ka(t);break;case 13:Sa(e,t),Ka(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(DC=Ar())),n&4&&oT(t);break;case 22:if(c=r!==null&&r.memoizedState!==null,t.mode&1?(Vn=(u=Vn)||c,Sa(e,t),Vn=u):Sa(e,t),Ka(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(Fe=t,c=t.child;c!==null;){for(d=Fe=c;Fe!==null;){switch(h=Fe,m=h.child,h.tag){case 0:case 11:case 14:case 15:Rh(4,h,h.return);break;case 1:ad(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{e=n,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(x){Cr(n,r,x)}}break;case 5:ad(h,h.return);break;case 22:if(h.memoizedState!==null){uT(d);continue}}m!==null?(m.return=h,Fe=m):uT(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=SP("display",s))}catch(x){Cr(t,t.return,x)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(x){Cr(t,t.return,x)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Sa(e,t),Ka(t),n&4&&oT(t);break;case 21:break;default:Sa(e,t),Ka(t)}}function Ka(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(K_(r)){var n=r;break e}r=r.return}throw Error(Se(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Zh(i,""),n.flags&=-33);var a=sT(t);T5(t,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=sT(t);E5(t,o,s);break;default:throw Error(Se(161))}}catch(l){Cr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function dz(t,e,r){Fe=t,Q_(t)}function Q_(t,e,r){for(var n=(t.mode&1)!==0;Fe!==null;){var i=Fe,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||Eg;if(!s){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Vn;o=Eg;var u=Vn;if(Eg=s,(Vn=l)&&!u)for(Fe=i;Fe!==null;)s=Fe,l=s.child,s.tag===22&&s.memoizedState!==null?cT(i):l!==null?(l.return=s,Fe=l):cT(i);for(;a!==null;)Fe=a,Q_(a),a=a.sibling;Fe=i,Eg=o,Vn=u}lT(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Fe=a):lT(t)}}function lT(t){for(;Fe!==null;){var e=Fe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Vn||zy(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Vn)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Ca(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&WE(e,a,n);break;case 3:var s=e.updateQueue;if(s!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}WE(e,s,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&np(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}Vn||e.flags&512&&N5(e)}catch(h){Cr(e,e.return,h)}}if(e===t){Fe=null;break}if(r=e.sibling,r!==null){r.return=e.return,Fe=r;break}Fe=e.return}}function uT(t){for(;Fe!==null;){var e=Fe;if(e===t){Fe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Fe=r;break}Fe=e.return}}function cT(t){for(;Fe!==null;){var e=Fe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{zy(4,e)}catch(l){Cr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Cr(e,i,l)}}var a=e.return;try{N5(e)}catch(l){Cr(e,a,l)}break;case 5:var s=e.return;try{N5(e)}catch(l){Cr(e,s,l)}}}catch(l){Cr(e,e.return,l)}if(e===t){Fe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Fe=o;break}Fe=e.return}}var fz=Math.ceil,c0=no.ReactCurrentDispatcher,AC=no.ReactCurrentOwner,aa=no.ReactCurrentBatchConfig,jt=0,hn=null,Vr=null,Nn=0,ji=0,sd=Nl(0),Qr=0,pp=null,Ou=0,Vy=0,RC=0,Dh=null,fi=null,DC=0,_d=1/0,Ls=null,d0=!1,j5=null,nl=null,Tg=!1,Go=null,f0=0,Oh=0,M5=null,kv=-1,Cv=0;function Zn(){return jt&6?Ar():kv!==-1?kv:kv=Ar()}function il(t){return t.mode&1?jt&2&&Nn!==0?Nn&-Nn:YF.transition!==null?(Cv===0&&(Cv=OP()),Cv):(t=Ft,t!==0||(t=window.event,t=t===void 0?16:$P(t.type)),t):1}function Ra(t,e,r,n){if(50<Oh)throw Oh=0,M5=null,Error(Se(185));Hp(t,r,n),(!(jt&2)||t!==hn)&&(t===hn&&(!(jt&2)&&(Vy|=r),Qr===4&&zo(t,Nn)),bi(t,n),r===1&&jt===0&&!(e.mode&1)&&(_d=Ar()+500,Ly&&El()))}function bi(t,e){var r=t.callbackNode;YB(t,e);var n=Yv(t,t===hn?Nn:0);if(n===0)r!==null&&xE(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&xE(r),e===1)t.tag===0?KF(dT.bind(null,t)):o_(dT.bind(null,t)),GF(function(){!(jt&6)&&El()}),r=null;else{switch(IP(n)){case 1:r=sC;break;case 4:r=RP;break;case 16:r=Kv;break;case 536870912:r=DP;break;default:r=Kv}r=aA(r,J_.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function J_(t,e){if(kv=-1,Cv=0,jt&6)throw Error(Se(327));var r=t.callbackNode;if(gd()&&t.callbackNode!==r)return null;var n=Yv(t,t===hn?Nn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=h0(t,n);else{e=n;var i=jt;jt|=2;var a=eA();(hn!==t||Nn!==e)&&(Ls=null,_d=Ar()+500,Cu(t,e));do try{mz();break}catch(o){Z_(t,o)}while(1);xC(),c0.current=a,jt=i,Vr!==null?e=0:(hn=null,Nn=0,e=Qr)}if(e!==0){if(e===2&&(i=r5(t),i!==0&&(n=i,e=P5(t,i))),e===1)throw r=pp,Cu(t,0),zo(t,n),bi(t,Ar()),r;if(e===6)zo(t,n);else{if(i=t.current.alternate,!(n&30)&&!hz(i)&&(e=h0(t,n),e===2&&(a=r5(t),a!==0&&(n=a,e=P5(t,a))),e===1))throw r=pp,Cu(t,0),zo(t,n),bi(t,Ar()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Se(345));case 2:lu(t,fi,Ls);break;case 3:if(zo(t,n),(n&130023424)===n&&(e=DC+500-Ar(),10<e)){if(Yv(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Zn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=c5(lu.bind(null,t,fi,Ls),e);break}lu(t,fi,Ls);break;case 4:if(zo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var s=31-Aa(n);a=1<<s,s=e[s],s>i&&(i=s),n&=~a}if(n=i,n=Ar()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*fz(n/1960))-n,10<n){t.timeoutHandle=c5(lu.bind(null,t,fi,Ls),n);break}lu(t,fi,Ls);break;case 5:lu(t,fi,Ls);break;default:throw Error(Se(329))}}}return bi(t,Ar()),t.callbackNode===r?J_.bind(null,t):null}function P5(t,e){var r=Dh;return t.current.memoizedState.isDehydrated&&(Cu(t,e).flags|=256),t=h0(t,e),t!==2&&(e=fi,fi=r,e!==null&&_5(e)),t}function _5(t){fi===null?fi=t:fi.push.apply(fi,t)}function hz(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Ia(a(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zo(t,e){for(e&=~RC,e&=~Vy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Aa(e),n=1<<r;t[r]=-1,e&=~n}}function dT(t){if(jt&6)throw Error(Se(327));gd();var e=Yv(t,0);if(!(e&1))return bi(t,Ar()),null;var r=h0(t,e);if(t.tag!==0&&r===2){var n=r5(t);n!==0&&(e=n,r=P5(t,n))}if(r===1)throw r=pp,Cu(t,0),zo(t,e),bi(t,Ar()),r;if(r===6)throw Error(Se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,lu(t,fi,Ls),bi(t,Ar()),null}function OC(t,e){var r=jt;jt|=1;try{return t(e)}finally{jt=r,jt===0&&(_d=Ar()+500,Ly&&El())}}function Iu(t){Go!==null&&Go.tag===0&&!(jt&6)&&gd();var e=jt;jt|=1;var r=aa.transition,n=Ft;try{if(aa.transition=null,Ft=1,t)return t()}finally{Ft=n,aa.transition=r,jt=e,!(jt&6)&&El()}}function IC(){ji=sd.current,rr(sd)}function Cu(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,UF(r)),Vr!==null)for(r=Vr.return;r!==null;){var n=r;switch(gC(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&e0();break;case 3:Md(),rr(yi),rr(Un),NC();break;case 5:CC(n);break;case 4:Md();break;case 13:rr(mr);break;case 19:rr(mr);break;case 10:bC(n.type._context);break;case 22:case 23:IC()}r=r.return}if(hn=t,Vr=t=al(t.current,null),Nn=ji=e,Qr=0,pp=null,RC=Vy=Ou=0,fi=Dh=null,gu!==null){for(e=0;e<gu.length;e++)if(r=gu[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}gu=null}return t}function Z_(t,e){do{var r=Vr;try{if(xC(),bv.current=u0,l0){for(var n=gr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}l0=!1}if(Du=0,cn=Xr=gr=null,Ah=!1,dp=0,AC.current=null,r===null||r.return===null){Qr=1,pp=e,Vr=null;break}e:{var a=t,s=r.return,o=r,l=e;if(e=Nn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=JE(s);if(m!==null){m.flags&=-257,ZE(m,s,o,a,e),m.mode&1&&QE(a,u,e),e=m,l=u;var v=e.updateQueue;if(v===null){var x=new Set;x.add(l),e.updateQueue=x}else v.add(l);break e}else{if(!(e&1)){QE(a,u,e),LC();break e}l=Error(Se(426))}}else if(or&&o.mode&1){var y=JE(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),ZE(y,s,o,a,e),vC(Pd(l,o));break e}}a=l=Pd(l,o),Qr!==4&&(Qr=2),Dh===null?Dh=[a]:Dh.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var b=I_(a,l,e);HE(a,b);break e;case 1:o=l;var S=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof S.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(nl===null||!nl.has(w)))){a.flags|=65536,e&=-e,a.lanes|=e;var k=L_(a,o,e);HE(a,k);break e}}a=a.return}while(a!==null)}rA(r)}catch(N){e=N,Vr===r&&r!==null&&(Vr=r=r.return);continue}break}while(1)}function eA(){var t=c0.current;return c0.current=u0,t===null?u0:t}function LC(){(Qr===0||Qr===3||Qr===2)&&(Qr=4),hn===null||!(Ou&268435455)&&!(Vy&268435455)||zo(hn,Nn)}function h0(t,e){var r=jt;jt|=2;var n=eA();(hn!==t||Nn!==e)&&(Ls=null,Cu(t,e));do try{pz();break}catch(i){Z_(t,i)}while(1);if(xC(),jt=r,c0.current=n,Vr!==null)throw Error(Se(261));return hn=null,Nn=0,Qr}function pz(){for(;Vr!==null;)tA(Vr)}function mz(){for(;Vr!==null&&!zB();)tA(Vr)}function tA(t){var e=iA(t.alternate,t,ji);t.memoizedProps=t.pendingProps,e===null?rA(t):Vr=e,AC.current=null}function rA(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=lz(r,e),r!==null){r.flags&=32767,Vr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qr=6,Vr=null;return}}else if(r=oz(r,e,ji),r!==null){Vr=r;return}if(e=e.sibling,e!==null){Vr=e;return}Vr=e=t}while(e!==null);Qr===0&&(Qr=5)}function lu(t,e,r){var n=Ft,i=aa.transition;try{aa.transition=null,Ft=1,gz(t,e,r,n)}finally{aa.transition=i,Ft=n}return null}function gz(t,e,r,n){do gd();while(Go!==null);if(jt&6)throw Error(Se(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Se(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(XB(t,a),t===hn&&(Vr=hn=null,Nn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Tg||(Tg=!0,aA(Kv,function(){return gd(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=aa.transition,aa.transition=null;var s=Ft;Ft=1;var o=jt;jt|=4,AC.current=null,cz(t,r),X_(r,t),IF(l5),Xv=!!o5,l5=o5=null,t.current=r,dz(r),VB(),jt=o,Ft=s,aa.transition=a}else t.current=r;if(Tg&&(Tg=!1,Go=t,f0=i),a=t.pendingLanes,a===0&&(nl=null),GB(r.stateNode),bi(t,Ar()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(d0)throw d0=!1,t=j5,j5=null,t;return f0&1&&t.tag!==0&&gd(),a=t.pendingLanes,a&1?t===M5?Oh++:(Oh=0,M5=t):Oh=0,El(),null}function gd(){if(Go!==null){var t=IP(f0),e=aa.transition,r=Ft;try{if(aa.transition=null,Ft=16>t?16:t,Go===null)var n=!1;else{if(t=Go,Go=null,f0=0,jt&6)throw Error(Se(331));var i=jt;for(jt|=4,Fe=t.current;Fe!==null;){var a=Fe,s=a.child;if(Fe.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Fe=u;Fe!==null;){var c=Fe;switch(c.tag){case 0:case 11:case 15:Rh(8,c,a)}var d=c.child;if(d!==null)d.return=c,Fe=d;else for(;Fe!==null;){c=Fe;var h=c.sibling,m=c.return;if(q_(c),c===u){Fe=null;break}if(h!==null){h.return=m,Fe=h;break}Fe=m}}}var v=a.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}Fe=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,Fe=s;else e:for(;Fe!==null;){if(a=Fe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Rh(9,a,a.return)}var b=a.sibling;if(b!==null){b.return=a.return,Fe=b;break e}Fe=a.return}}var S=t.current;for(Fe=S;Fe!==null;){s=Fe;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,Fe=w;else e:for(s=S;Fe!==null;){if(o=Fe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:zy(9,o)}}catch(N){Cr(o,o.return,N)}if(o===s){Fe=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,Fe=k;break e}Fe=o.return}}if(jt=i,El(),ls&&typeof ls.onPostCommitFiberRoot=="function")try{ls.onPostCommitFiberRoot(Ay,t)}catch{}n=!0}return n}finally{Ft=r,aa.transition=e}}return!1}function fT(t,e,r){e=Pd(r,e),e=I_(t,e,1),t=rl(t,e,1),e=Zn(),t!==null&&(Hp(t,1,e),bi(t,e))}function Cr(t,e,r){if(t.tag===3)fT(t,t,r);else for(;e!==null;){if(e.tag===3){fT(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(nl===null||!nl.has(n))){t=Pd(r,t),t=L_(e,t,1),e=rl(e,t,1),t=Zn(),e!==null&&(Hp(e,1,t),bi(e,t));break}}e=e.return}}function vz(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Zn(),t.pingedLanes|=t.suspendedLanes&r,hn===t&&(Nn&r)===r&&(Qr===4||Qr===3&&(Nn&130023424)===Nn&&500>Ar()-DC?Cu(t,0):RC|=r),bi(t,e)}function nA(t,e){e===0&&(t.mode&1?(e=vg,vg<<=1,!(vg&130023424)&&(vg=4194304)):e=1);var r=Zn();t=Qs(t,e),t!==null&&(Hp(t,e,r),bi(t,r))}function yz(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),nA(t,r)}function xz(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Se(314))}n!==null&&n.delete(e),nA(t,r)}var iA;iA=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||yi.current)gi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return gi=!1,sz(t,e,r);gi=!!(t.flags&131072)}else gi=!1,or&&e.flags&1048576&&l_(e,n0,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Sv(t,e),t=e.pendingProps;var i=Ed(e,Un.current);md(e,r),i=TC(null,e,n,t,i,r);var a=jC();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,xi(n)?(a=!0,t0(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,SC(e),i.updater=Fy,e.stateNode=i,i._reactInternals=e,v5(e,n,t,r),e=b5(null,e,n,!0,a,r)):(e.tag=0,or&&a&&mC(e),Jn(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Sv(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=wz(n),t=Ca(n,t),i){case 0:e=x5(null,e,n,t,r);break e;case 1:e=rT(null,e,n,t,r);break e;case 11:e=eT(null,e,n,t,r);break e;case 14:e=tT(null,e,n,Ca(n.type,t),r);break e}throw Error(Se(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ca(n,i),x5(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ca(n,i),rT(t,e,n,i,r);case 3:e:{if(V_(e),t===null)throw Error(Se(387));n=e.pendingProps,a=e.memoizedState,i=a.element,p_(t,e),s0(e,n,null,r);var s=e.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=Pd(Error(Se(423)),e),e=nT(t,e,n,r,i);break e}else if(n!==i){i=Pd(Error(Se(424)),e),e=nT(t,e,n,r,i);break e}else for(Pi=tl(e.stateNode.containerInfo.firstChild),_i=e,or=!0,ja=null,r=f_(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Td(),n===i){e=Js(t,e,r);break e}Jn(t,e,n,r)}e=e.child}return e;case 5:return m_(e),t===null&&p5(e),n=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,s=i.children,u5(n,i)?s=null:a!==null&&u5(n,a)&&(e.flags|=32),z_(t,e),Jn(t,e,s,r),e.child;case 6:return t===null&&p5(e),null;case 13:return $_(t,e,r);case 4:return kC(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=jd(e,null,n,r):Jn(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ca(n,i),eT(t,e,n,i,r);case 7:return Jn(t,e,e.pendingProps,r),e.child;case 8:return Jn(t,e,e.pendingProps.children,r),e.child;case 12:return Jn(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,a=e.memoizedProps,s=i.value,Xt(i0,n._currentValue),n._currentValue=s,a!==null)if(Ia(a.value,s)){if(a.children===i.children&&!yi.current){e=Js(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Hs(-1,r&-r),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),m5(a.return,r,e),o.lanes|=r;break}l=l.next}}else if(a.tag===10)s=a.type===e.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(Se(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),m5(s,r,e),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===e){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}Jn(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,md(e,r),i=ca(i),n=n(i),e.flags|=1,Jn(t,e,n,r),e.child;case 14:return n=e.type,i=Ca(n,e.pendingProps),i=Ca(n.type,i),tT(t,e,n,i,r);case 15:return B_(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ca(n,i),Sv(t,e),e.tag=1,xi(n)?(t=!0,t0(e)):t=!1,md(e,r),O_(e,n,i),v5(e,n,i,r),b5(null,e,n,!0,t,r);case 19:return U_(t,e,r);case 22:return F_(t,e,r)}throw Error(Se(156,e.tag))};function aA(t,e){return AP(t,e)}function bz(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function na(t,e,r,n){return new bz(t,e,r,n)}function BC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wz(t){if(typeof t=="function")return BC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===nC)return 11;if(t===iC)return 14}return 2}function al(t,e){var r=t.alternate;return r===null?(r=na(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Nv(t,e,r,n,i,a){var s=2;if(n=t,typeof t=="function")BC(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Yc:return Nu(r.children,i,a,e);case rC:s=8,i|=8;break;case VS:return t=na(12,r,e,i|2),t.elementType=VS,t.lanes=a,t;case $S:return t=na(13,r,e,i),t.elementType=$S,t.lanes=a,t;case US:return t=na(19,r,e,i),t.elementType=US,t.lanes=a,t;case mP:return $y(r,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hP:s=10;break e;case pP:s=9;break e;case nC:s=11;break e;case iC:s=14;break e;case Ro:s=16,n=null;break e}throw Error(Se(130,t==null?t:typeof t,""))}return e=na(s,r,e,i),e.elementType=t,e.type=n,e.lanes=a,e}function Nu(t,e,r,n){return t=na(7,t,n,e),t.lanes=r,t}function $y(t,e,r,n){return t=na(22,t,n,e),t.elementType=mP,t.lanes=r,t.stateNode={isHidden:!1},t}function ow(t,e,r){return t=na(6,t,null,e),t.lanes=r,t}function lw(t,e,r){return e=na(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Sz(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$b(0),this.expirationTimes=$b(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$b(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function FC(t,e,r,n,i,a,s,o,l){return t=new Sz(t,e,r,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=na(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},SC(a),t}function kz(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Kc,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function sA(t){if(!t)return pl;t=t._reactInternals;e:{if(Qu(t)!==t||t.tag!==1)throw Error(Se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(xi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Se(171))}if(t.tag===1){var r=t.type;if(xi(r))return s_(t,r,e)}return e}function oA(t,e,r,n,i,a,s,o,l){return t=FC(r,n,!0,t,i,a,s,o,l),t.context=sA(null),r=t.current,n=Zn(),i=il(r),a=Hs(n,i),a.callback=e??null,rl(r,a,i),t.current.lanes=i,Hp(t,i,n),bi(t,n),t}function Uy(t,e,r,n){var i=e.current,a=Zn(),s=il(i);return r=sA(r),e.context===null?e.context=r:e.pendingContext=r,e=Hs(a,s),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=rl(i,e,s),t!==null&&(Ra(t,i,s,a),xv(t,i,s)),s}function p0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function hT(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function zC(t,e){hT(t,e),(t=t.alternate)&&hT(t,e)}function Cz(){return null}var lA=typeof reportError=="function"?reportError:function(t){console.error(t)};function VC(t){this._internalRoot=t}Gy.prototype.render=VC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Se(409));Uy(t,e,null,null)};Gy.prototype.unmount=VC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Iu(function(){Uy(null,t,null,null)}),e[Xs]=null}};function Gy(t){this._internalRoot=t}Gy.prototype.unstable_scheduleHydration=function(t){if(t){var e=FP();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Fo.length&&e!==0&&e<Fo[r].priority;r++);Fo.splice(r,0,t),r===0&&VP(t)}};function $C(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pT(){}function Nz(t,e,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var u=p0(s);a.call(u)}}var s=oA(e,n,t,0,null,!1,!1,"",pT);return t._reactRootContainer=s,t[Xs]=s.current,sp(t.nodeType===8?t.parentNode:t),Iu(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=p0(l);o.call(u)}}var l=FC(t,0,!1,null,null,!1,!1,"",pT);return t._reactRootContainer=l,t[Xs]=l.current,sp(t.nodeType===8?t.parentNode:t),Iu(function(){Uy(e,l,r,n)}),l}function Wy(t,e,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var l=p0(s);o.call(l)}}Uy(e,s,t,i)}else s=Nz(r,e,t,i,n);return p0(s)}LP=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=gh(e.pendingLanes);r!==0&&(oC(e,r|1),bi(e,Ar()),!(jt&6)&&(_d=Ar()+500,El()))}break;case 13:Iu(function(){var n=Qs(t,1);if(n!==null){var i=Zn();Ra(n,t,1,i)}}),zC(t,1)}};lC=function(t){if(t.tag===13){var e=Qs(t,134217728);if(e!==null){var r=Zn();Ra(e,t,134217728,r)}zC(t,134217728)}};BP=function(t){if(t.tag===13){var e=il(t),r=Qs(t,e);if(r!==null){var n=Zn();Ra(r,t,e,n)}zC(t,e)}};FP=function(){return Ft};zP=function(t,e){var r=Ft;try{return Ft=t,e()}finally{Ft=r}};ZS=function(t,e,r){switch(e){case"input":if(WS(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Iy(n);if(!i)throw Error(Se(90));vP(n),WS(n,i)}}}break;case"textarea":xP(t,r);break;case"select":e=r.value,e!=null&&dd(t,!!r.multiple,e,!1)}};EP=OC;TP=Iu;var Ez={usingClientEntryPoint:!1,Events:[qp,Zc,Iy,CP,NP,OC]},Hf={findFiberByHostInstance:mu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Tz={bundleType:Hf.bundleType,version:Hf.version,rendererPackageName:Hf.rendererPackageName,rendererConfig:Hf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:no.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=PP(t),t===null?null:t.stateNode},findFiberByHostInstance:Hf.findFiberByHostInstance||Cz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jg.isDisabled&&jg.supportsFiber)try{Ay=jg.inject(Tz),ls=jg}catch{}}Oi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ez;Oi.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!$C(e))throw Error(Se(200));return kz(t,e,null,r)};Oi.createRoot=function(t,e){if(!$C(t))throw Error(Se(299));var r=!1,n="",i=lA;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=FC(t,1,!1,null,null,r,!1,n,i),t[Xs]=e.current,sp(t.nodeType===8?t.parentNode:t),new VC(e)};Oi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Se(188)):(t=Object.keys(t).join(","),Error(Se(268,t)));return t=PP(e),t=t===null?null:t.stateNode,t};Oi.flushSync=function(t){return Iu(t)};Oi.hydrate=function(t,e,r){if(!Hy(e))throw Error(Se(200));return Wy(null,t,e,!0,r)};Oi.hydrateRoot=function(t,e,r){if(!$C(t))throw Error(Se(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=lA;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),e=oA(e,null,t,1,r??null,i,!1,a,s),t[Xs]=e.current,sp(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Gy(e)};Oi.render=function(t,e,r){if(!Hy(e))throw Error(Se(200));return Wy(null,t,e,!1,r)};Oi.unmountComponentAtNode=function(t){if(!Hy(t))throw Error(Se(40));return t._reactRootContainer?(Iu(function(){Wy(null,null,t,!1,function(){t._reactRootContainer=null,t[Xs]=null})}),!0):!1};Oi.unstable_batchedUpdates=OC;Oi.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Hy(r))throw Error(Se(200));if(t==null||t._reactInternals===void 0)throw Error(Se(38));return Wy(t,e,r,!1,n)};Oi.version="18.3.1-next-f1338f8080-20240426";function uA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uA)}catch(t){console.error(t)}}uA(),uP.exports=Oi;var Zs=uP.exports;const jz=Up(Zs);var mT=Zs;FS.createRoot=mT.createRoot,FS.hydrateRoot=mT.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function mp(){return mp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},mp.apply(this,arguments)}var Ho;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ho||(Ho={}));const gT="popstate";function Mz(t){t===void 0&&(t={});function e(n,i){let{pathname:a,search:s,hash:o}=n.location;return A5("",{pathname:a,search:s,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:m0(i)}return _z(e,r,null,t)}function Tr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function UC(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Pz(){return Math.random().toString(36).substr(2,8)}function vT(t,e){return{usr:t.state,key:t.key,idx:e}}function A5(t,e,r,n){return r===void 0&&(r=null),mp({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ef(e):e,{state:r,key:e&&e.key||n||Pz()})}function m0(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ef(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function _z(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,s=i.history,o=Ho.Pop,l=null,u=c();u==null&&(u=0,s.replaceState(mp({},s.state,{idx:u}),""));function c(){return(s.state||{idx:null}).idx}function d(){o=Ho.Pop;let y=c(),b=y==null?null:y-u;u=y,l&&l({action:o,location:x.location,delta:b})}function h(y,b){o=Ho.Push;let S=A5(x.location,y,b);r&&r(S,y),u=c()+1;let w=vT(S,u),k=x.createHref(S);try{s.pushState(w,"",k)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(k)}a&&l&&l({action:o,location:x.location,delta:1})}function m(y,b){o=Ho.Replace;let S=A5(x.location,y,b);r&&r(S,y),u=c();let w=vT(S,u),k=x.createHref(S);s.replaceState(w,"",k),a&&l&&l({action:o,location:x.location,delta:0})}function v(y){let b=i.location.origin!=="null"?i.location.origin:i.location.href,S=typeof y=="string"?y:m0(y);return S=S.replace(/ $/,"%20"),Tr(b,"No window.location.(origin|href) available to create URL for href: "+S),new URL(S,b)}let x={get action(){return o},get location(){return t(i,s)},listen(y){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(gT,d),l=y,()=>{i.removeEventListener(gT,d),l=null}},createHref(y){return e(i,y)},createURL:v,encodeLocation(y){let b=v(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:h,replace:m,go(y){return s.go(y)}};return x}var yT;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(yT||(yT={}));function Az(t,e,r){return r===void 0&&(r="/"),Rz(t,e,r,!1)}function Rz(t,e,r,n){let i=typeof e=="string"?ef(e):e,a=Ad(i.pathname||"/",r);if(a==null)return null;let s=cA(t);Dz(s);let o=null;for(let l=0;o==null&&l<s.length;++l){let u=Hz(a);o=Uz(s[l],u,n)}return o}function cA(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,s,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:s,route:a};l.relativePath.startsWith("/")&&(Tr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=sl([n,l.relativePath]),c=r.concat(l);a.children&&a.children.length>0&&(Tr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),cA(a.children,e,c,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:Vz(u,a.index),routesMeta:c})};return t.forEach((a,s)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))i(a,s);else for(let l of dA(a.path))i(a,s,l)}),e}function dA(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let s=dA(n.join("/")),o=[];return o.push(...s.map(l=>l===""?a:[a,l].join("/"))),i&&o.push(...s),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function Dz(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:$z(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Oz=/^:[\w-]+$/,Iz=3,Lz=2,Bz=1,Fz=10,zz=-2,xT=t=>t==="*";function Vz(t,e){let r=t.split("/"),n=r.length;return r.some(xT)&&(n+=zz),e&&(n+=Lz),r.filter(i=>!xT(i)).reduce((i,a)=>i+(Oz.test(a)?Iz:a===""?Bz:Fz),n)}function $z(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function Uz(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,i={},a="/",s=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,c=a==="/"?e:e.slice(a.length)||"/",d=g0({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),h=l.route;if(!d&&u&&r&&!n[n.length-1].route.index&&(d=g0({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!d)return null;Object.assign(i,d.params),s.push({params:i,pathname:sl([a,d.pathname]),pathnameBase:Xz(sl([a,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(a=sl([a,d.pathnameBase]))}return s}function g0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=Gz(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((u,c,d)=>{let{paramName:h,isOptional:m}=c;if(h==="*"){let x=o[d]||"";s=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const v=o[d];return m&&!v?u[h]=void 0:u[h]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:s,pattern:t}}function Gz(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),UC(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function Hz(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return UC(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ad(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const Wz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qz=t=>Wz.test(t);function Kz(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?ef(t):t,a;if(r)if(qz(r))a=r;else{if(r.includes("//")){let s=r;r=r.replace(/\/\/+/g,"/"),UC(!1,"Pathnames cannot have embedded double slashes - normalizing "+(s+" -> "+r))}r.startsWith("/")?a=bT(r.substring(1),"/"):a=bT(r,e)}else a=e;return{pathname:a,search:Qz(n),hash:Jz(i)}}function bT(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function uw(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Yz(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function fA(t,e){let r=Yz(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function hA(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=ef(t):(i=mp({},t),Tr(!i.pathname||!i.pathname.includes("?"),uw("?","pathname","search",i)),Tr(!i.pathname||!i.pathname.includes("#"),uw("#","pathname","hash",i)),Tr(!i.search||!i.search.includes("#"),uw("#","search","hash",i)));let a=t===""||i.pathname==="",s=a?"/":i.pathname,o;if(s==null)o=r;else{let d=e.length-1;if(!n&&s.startsWith("..")){let h=s.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}o=d>=0?e[d]:"/"}let l=Kz(i,o),u=s&&s!=="/"&&s.endsWith("/"),c=(a||s===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const sl=t=>t.join("/").replace(/\/\/+/g,"/"),Xz=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Qz=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Jz=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Zz(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const pA=["post","put","patch","delete"];new Set(pA);const eV=["get",...pA];new Set(eV);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gp(){return gp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gp.apply(this,arguments)}const qy=K.createContext(null),mA=K.createContext(null),Tl=K.createContext(null),Ky=K.createContext(null),io=K.createContext({outlet:null,matches:[],isDataRoute:!1}),gA=K.createContext(null);function tV(t,e){let{relative:r}=e===void 0?{}:e;Yp()||Tr(!1);let{basename:n,navigator:i}=K.useContext(Tl),{hash:a,pathname:s,search:o}=Yy(t,{relative:r}),l=s;return n!=="/"&&(l=s==="/"?n:sl([n,s])),i.createHref({pathname:l,search:o,hash:a})}function Yp(){return K.useContext(Ky)!=null}function Ju(){return Yp()||Tr(!1),K.useContext(Ky).location}function vA(t){K.useContext(Tl).static||K.useLayoutEffect(t)}function Li(){let{isDataRoute:t}=K.useContext(io);return t?mV():rV()}function rV(){Yp()||Tr(!1);let t=K.useContext(qy),{basename:e,future:r,navigator:n}=K.useContext(Tl),{matches:i}=K.useContext(io),{pathname:a}=Ju(),s=JSON.stringify(fA(i,r.v7_relativeSplatPath)),o=K.useRef(!1);return vA(()=>{o.current=!0}),K.useCallback(function(u,c){if(c===void 0&&(c={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let d=hA(u,JSON.parse(s),a,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:sl([e,d.pathname])),(c.replace?n.replace:n.push)(d,c.state,c)},[e,n,s,a,t])}const yA=K.createContext(null);function jl(){return K.useContext(yA)}function nV(t){let e=K.useContext(io).outlet;return e&&K.createElement(yA.Provider,{value:t},e)}function Bi(){let{matches:t}=K.useContext(io),e=t[t.length-1];return e?e.params:{}}function Yy(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=K.useContext(Tl),{matches:i}=K.useContext(io),{pathname:a}=Ju(),s=JSON.stringify(fA(i,n.v7_relativeSplatPath));return K.useMemo(()=>hA(t,JSON.parse(s),a,r==="path"),[t,s,a,r])}function iV(t,e){return aV(t,e)}function aV(t,e,r,n){Yp()||Tr(!1);let{navigator:i}=K.useContext(Tl),{matches:a}=K.useContext(io),s=a[a.length-1],o=s?s.params:{};s&&s.pathname;let l=s?s.pathnameBase:"/";s&&s.route;let u=Ju(),c;if(e){var d;let y=typeof e=="string"?ef(e):e;l==="/"||(d=y.pathname)!=null&&d.startsWith(l)||Tr(!1),c=y}else c=u;let h=c.pathname||"/",m=h;if(l!=="/"){let y=l.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=Az(t,{pathname:m}),x=cV(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:sl([l,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:sl([l,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),a,r,n);return e&&x?K.createElement(Ky.Provider,{value:{location:gp({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Ho.Pop}},x):x}function sV(){let t=pV(),e=Zz(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},a=null;return K.createElement(K.Fragment,null,K.createElement("h2",null,"Unexpected Application Error!"),K.createElement("h3",{style:{fontStyle:"italic"}},e),r?K.createElement("pre",{style:i},r):null,a)}const oV=K.createElement(sV,null);class lV extends K.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?K.createElement(io.Provider,{value:this.props.routeContext},K.createElement(gA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uV(t){let{routeContext:e,match:r,children:n}=t,i=K.useContext(qy);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),K.createElement(io.Provider,{value:e},n)}function cV(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,o=(i=r)==null?void 0:i.errors;if(o!=null){let c=s.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);c>=0||Tr(!1),s=s.slice(0,Math.min(s.length,c+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let c=0;c<s.length;c++){let d=s[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:h,errors:m}=r,v=d.route.loader&&h[d.route.id]===void 0&&(!m||m[d.route.id]===void 0);if(d.route.lazy||v){l=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}return s.reduceRight((c,d,h)=>{let m,v=!1,x=null,y=null;r&&(m=o&&d.route.id?o[d.route.id]:void 0,x=d.route.errorElement||oV,l&&(u<0&&h===0?(gV("route-fallback",!1),v=!0,y=null):u===h&&(v=!0,y=d.route.hydrateFallbackElement||null)));let b=e.concat(s.slice(0,h+1)),S=()=>{let w;return m?w=x:v?w=y:d.route.Component?w=K.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=c,K.createElement(uV,{match:d,routeContext:{outlet:c,matches:b,isDataRoute:r!=null},children:w})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?K.createElement(lV,{location:r.location,revalidation:r.revalidation,component:x,error:m,children:S(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):S()},null)}var xA=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(xA||{}),v0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(v0||{});function dV(t){let e=K.useContext(qy);return e||Tr(!1),e}function fV(t){let e=K.useContext(mA);return e||Tr(!1),e}function hV(t){let e=K.useContext(io);return e||Tr(!1),e}function bA(t){let e=hV(),r=e.matches[e.matches.length-1];return r.route.id||Tr(!1),r.route.id}function pV(){var t;let e=K.useContext(gA),r=fV(v0.UseRouteError),n=bA(v0.UseRouteError);return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function mV(){let{router:t}=dV(xA.UseNavigateStable),e=bA(v0.UseNavigateStable),r=K.useRef(!1);return vA(()=>{r.current=!0}),K.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,gp({fromRouteId:e},a)))},[t,e])}const wT={};function gV(t,e,r){!e&&!wT[t]&&(wT[t]=!0)}function vV(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function GC(t){return nV(t.context)}function pr(t){Tr(!1)}function yV(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Ho.Pop,navigator:a,static:s=!1,future:o}=t;Yp()&&Tr(!1);let l=e.replace(/^\/*/,"/"),u=K.useMemo(()=>({basename:l,navigator:a,static:s,future:gp({v7_relativeSplatPath:!1},o)}),[l,o,a,s]);typeof n=="string"&&(n=ef(n));let{pathname:c="/",search:d="",hash:h="",state:m=null,key:v="default"}=n,x=K.useMemo(()=>{let y=Ad(c,l);return y==null?null:{location:{pathname:y,search:d,hash:h,state:m,key:v},navigationType:i}},[l,c,d,h,m,v,i]);return x==null?null:K.createElement(Tl.Provider,{value:u},K.createElement(Ky.Provider,{children:r,value:x}))}function xV(t){let{children:e,location:r}=t;return iV(R5(e),r)}new Promise(()=>{});function R5(t,e){e===void 0&&(e=[]);let r=[];return K.Children.forEach(t,(n,i)=>{if(!K.isValidElement(n))return;let a=[...e,i];if(n.type===K.Fragment){r.push.apply(r,R5(n.props.children,a));return}n.type!==pr&&Tr(!1),!n.props.index||!n.props.children||Tr(!1);let s={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=R5(n.props.children,a)),r.push(s)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function y0(){return y0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},y0.apply(this,arguments)}function wA(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function bV(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function wV(t,e){return t.button===0&&(!e||e==="_self")&&!bV(t)}const SV=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],kV=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],CV="6";try{window.__reactRouterVersion=CV}catch{}const NV=K.createContext({isTransitioning:!1}),EV="startTransition",ST=yB[EV];function TV(t){let{basename:e,children:r,future:n,window:i}=t,a=K.useRef();a.current==null&&(a.current=Mz({window:i,v5Compat:!0}));let s=a.current,[o,l]=K.useState({action:s.action,location:s.location}),{v7_startTransition:u}=n||{},c=K.useCallback(d=>{u&&ST?ST(()=>l(d)):l(d)},[l,u]);return K.useLayoutEffect(()=>s.listen(c),[s,c]),K.useEffect(()=>vV(n),[n]),K.createElement(yV,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:s,future:n})}const jV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",MV=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Lu=K.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:a,replace:s,state:o,target:l,to:u,preventScrollReset:c,viewTransition:d}=e,h=wA(e,SV),{basename:m}=K.useContext(Tl),v,x=!1;if(typeof u=="string"&&MV.test(u)&&(v=u,jV))try{let w=new URL(window.location.href),k=u.startsWith("//")?new URL(w.protocol+u):new URL(u),N=Ad(k.pathname,m);k.origin===w.origin&&N!=null?u=N+k.search+k.hash:x=!0}catch{}let y=tV(u,{relative:i}),b=AV(u,{replace:s,state:o,target:l,preventScrollReset:c,relative:i,viewTransition:d});function S(w){n&&n(w),w.defaultPrevented||b(w)}return K.createElement("a",y0({},h,{href:v||y,onClick:x||a?n:S,ref:r,target:l}))}),PV=K.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:a="",end:s=!1,style:o,to:l,viewTransition:u,children:c}=e,d=wA(e,kV),h=Yy(l,{relative:d.relative}),m=Ju(),v=K.useContext(mA),{navigator:x,basename:y}=K.useContext(Tl),b=v!=null&&RV(h)&&u===!0,S=x.encodeLocation?x.encodeLocation(h).pathname:h.pathname,w=m.pathname,k=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;i||(w=w.toLowerCase(),k=k?k.toLowerCase():null,S=S.toLowerCase()),k&&y&&(k=Ad(k,y)||k);const N=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let T=w===S||!s&&w.startsWith(S)&&w.charAt(N)==="/",j=k!=null&&(k===S||!s&&k.startsWith(S)&&k.charAt(S.length)==="/"),M={isActive:T,isPending:j,isTransitioning:b},A=T?n:void 0,P;typeof a=="function"?P=a(M):P=[a,T?"active":null,j?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let D=typeof o=="function"?o(M):o;return K.createElement(Lu,y0({},d,{"aria-current":A,className:P,ref:r,style:D,to:l,viewTransition:u}),typeof c=="function"?c(M):c)});var D5;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(D5||(D5={}));var kT;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(kT||(kT={}));function _V(t){let e=K.useContext(qy);return e||Tr(!1),e}function AV(t,e){let{target:r,replace:n,state:i,preventScrollReset:a,relative:s,viewTransition:o}=e===void 0?{}:e,l=Li(),u=Ju(),c=Yy(t,{relative:s});return K.useCallback(d=>{if(wV(d,r)){d.preventDefault();let h=n!==void 0?n:m0(u)===m0(c);l(t,{replace:h,state:i,preventScrollReset:a,relative:s,viewTransition:o})}},[u,l,c,n,i,r,t,a,s,o])}function RV(t,e){e===void 0&&(e={});let r=K.useContext(NV);r==null&&Tr(!1);let{basename:n}=_V(D5.useViewTransitionState),i=Yy(t,{relative:e.relative});if(!r.isTransitioning)return!1;let a=Ad(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=Ad(r.nextLocation.pathname,n)||r.nextLocation.pathname;return g0(i.pathname,s)!=null||g0(i.pathname,a)!=null}const HC="-",DV=t=>{const e=IV(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const o=s.split(HC);return o[0]===""&&o.length!==1&&o.shift(),SA(o,e)||OV(s)},getConflictingClassGroupIds:(s,o)=>{const l=r[s]||[];return o&&n[s]?[...l,...n[s]]:l}}},SA=(t,e)=>{var s;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?SA(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(HC);return(s=e.validators.find(({validator:o})=>o(a)))==null?void 0:s.classGroupId},CT=/^\[(.+)\]$/,OV=t=>{if(CT.test(t)){const e=CT.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},IV=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return BV(Object.entries(t.classGroups),r).forEach(([a,s])=>{O5(s,n,a,e)}),n},O5=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:NT(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(LV(i)){O5(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{O5(s,NT(e,a),r,n)})})},NT=(t,e)=>{let r=t;return e.split(HC).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},LV=t=>t.isThemeGetter,BV=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,o])=>[e+s,o])):a);return[r,i]}):t,FV=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},kA="!",zV=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,s=o=>{const l=[];let u=0,c=0,d;for(let y=0;y<o.length;y++){let b=o[y];if(u===0){if(b===i&&(n||o.slice(y,y+a)===e)){l.push(o.slice(c,y)),c=y+a;continue}if(b==="/"){d=y;continue}}b==="["?u++:b==="]"&&u--}const h=l.length===0?o:o.substring(c),m=h.startsWith(kA),v=m?h.substring(1):h,x=d&&d>c?d-c:void 0;return{modifiers:l,hasImportantModifier:m,baseClassName:v,maybePostfixModifierPosition:x}};return r?o=>r({className:o,parseClassName:s}):s},VV=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},$V=t=>({cache:FV(t.cacheSize),parseClassName:zV(t),...DV(t)}),UV=/\s+/,GV=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],s=t.trim().split(UV);let o="";for(let l=s.length-1;l>=0;l-=1){const u=s[l],{modifiers:c,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:m}=r(u);let v=!!m,x=n(v?h.substring(0,m):h);if(!x){if(!v){o=u+(o.length>0?" "+o:o);continue}if(x=n(h),!x){o=u+(o.length>0?" "+o:o);continue}v=!1}const y=VV(c).join(":"),b=d?y+kA:y,S=b+x;if(a.includes(S))continue;a.push(S);const w=i(x,v);for(let k=0;k<w.length;++k){const N=w[k];a.push(b+N)}o=u+(o.length>0?" "+o:o)}return o};function HV(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=CA(e))&&(n&&(n+=" "),n+=r);return n}const CA=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=CA(t[n]))&&(r&&(r+=" "),r+=e);return r};function WV(t,...e){let r,n,i,a=s;function s(l){const u=e.reduce((c,d)=>d(c),t());return r=$V(u),n=r.cache.get,i=r.cache.set,a=o,o(l)}function o(l){const u=n(l);if(u)return u;const c=GV(l,r);return i(l,c),c}return function(){return a(HV.apply(null,arguments))}}const Zt=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},NA=/^\[(?:([a-z-]+):)?(.+)\]$/i,qV=/^\d+\/\d+$/,KV=new Set(["px","full","screen"]),YV=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,XV=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,QV=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,JV=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,ZV=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ms=t=>vd(t)||KV.has(t)||qV.test(t),No=t=>tf(t,"length",o$),vd=t=>!!t&&!Number.isNaN(Number(t)),cw=t=>tf(t,"number",vd),Wf=t=>!!t&&Number.isInteger(Number(t)),e$=t=>t.endsWith("%")&&vd(t.slice(0,-1)),ct=t=>NA.test(t),Eo=t=>YV.test(t),t$=new Set(["length","size","percentage"]),r$=t=>tf(t,t$,EA),n$=t=>tf(t,"position",EA),i$=new Set(["image","url"]),a$=t=>tf(t,i$,u$),s$=t=>tf(t,"",l$),qf=()=>!0,tf=(t,e,r)=>{const n=NA.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},o$=t=>XV.test(t)&&!QV.test(t),EA=()=>!1,l$=t=>JV.test(t),u$=t=>ZV.test(t),c$=()=>{const t=Zt("colors"),e=Zt("spacing"),r=Zt("blur"),n=Zt("brightness"),i=Zt("borderColor"),a=Zt("borderRadius"),s=Zt("borderSpacing"),o=Zt("borderWidth"),l=Zt("contrast"),u=Zt("grayscale"),c=Zt("hueRotate"),d=Zt("invert"),h=Zt("gap"),m=Zt("gradientColorStops"),v=Zt("gradientColorStopPositions"),x=Zt("inset"),y=Zt("margin"),b=Zt("opacity"),S=Zt("padding"),w=Zt("saturate"),k=Zt("scale"),N=Zt("sepia"),T=Zt("skew"),j=Zt("space"),M=Zt("translate"),A=()=>["auto","contain","none"],P=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",ct,e],R=()=>[ct,e],I=()=>["",Ms,No],U=()=>["auto",vd,ct],B=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],F=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],V=()=>["start","end","center","between","around","evenly","stretch"],J=()=>["","0",ct],Y=()=>["auto","avoid","all","avoid-page","page","left","right","column"],L=()=>[vd,ct];return{cacheSize:500,separator:":",theme:{colors:[qf],spacing:[Ms,No],blur:["none","",Eo,ct],brightness:L(),borderColor:[t],borderRadius:["none","","full",Eo,ct],borderSpacing:R(),borderWidth:I(),contrast:L(),grayscale:J(),hueRotate:L(),invert:J(),gap:R(),gradientColorStops:[t],gradientColorStopPositions:[e$,No],inset:D(),margin:D(),opacity:L(),padding:R(),saturate:L(),scale:L(),sepia:J(),skew:L(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",ct]}],container:["container"],columns:[{columns:[Eo]}],"break-after":[{"break-after":Y()}],"break-before":[{"break-before":Y()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...B(),ct]}],overflow:[{overflow:P()}],"overflow-x":[{"overflow-x":P()}],"overflow-y":[{"overflow-y":P()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Wf,ct]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ct]}],grow:[{grow:J()}],shrink:[{shrink:J()}],order:[{order:["first","last","none",Wf,ct]}],"grid-cols":[{"grid-cols":[qf]}],"col-start-end":[{col:["auto",{span:["full",Wf,ct]},ct]}],"col-start":[{"col-start":U()}],"col-end":[{"col-end":U()}],"grid-rows":[{"grid-rows":[qf]}],"row-start-end":[{row:["auto",{span:[Wf,ct]},ct]}],"row-start":[{"row-start":U()}],"row-end":[{"row-end":U()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ct]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ct]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...V()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...V(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...V(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[S]}],px:[{px:[S]}],py:[{py:[S]}],ps:[{ps:[S]}],pe:[{pe:[S]}],pt:[{pt:[S]}],pr:[{pr:[S]}],pb:[{pb:[S]}],pl:[{pl:[S]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[j]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[j]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ct,e]}],"min-w":[{"min-w":[ct,e,"min","max","fit"]}],"max-w":[{"max-w":[ct,e,"none","full","min","max","fit","prose",{screen:[Eo]},Eo]}],h:[{h:[ct,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ct,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ct,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ct,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Eo,No]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",cw]}],"font-family":[{font:[qf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ct]}],"line-clamp":[{"line-clamp":["none",vd,cw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ms,ct]}],"list-image":[{"list-image":["none",ct]}],"list-style-type":[{list:["none","disc","decimal",ct]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ms,No]}],"underline-offset":[{"underline-offset":["auto",Ms,ct]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ct]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ct]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...B(),n$]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",r$]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},a$]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:z()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[Ms,ct]}],"outline-w":[{outline:[Ms,No]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[Ms,No]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Eo,s$]}],"shadow-color":[{shadow:[qf]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...F(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":F()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Eo,ct]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[w]}],sepia:[{sepia:[N]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[N]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ct]}],duration:[{duration:L()}],ease:[{ease:["linear","in","out","in-out",ct]}],delay:[{delay:L()}],animate:[{animate:["none","spin","ping","pulse","bounce",ct]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[Wf,ct]}],"translate-x":[{"translate-x":[M]}],"translate-y":[{"translate-y":[M]}],"skew-x":[{"skew-x":[T]}],"skew-y":[{"skew-y":[T]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ct]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ct]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ct]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ms,No,cw]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},WC=WV(c$),Et=({children:t,className:e,...r})=>f.jsx("div",{className:WC("bg-glass backdrop-blur-xl border border-glass-border rounded-xl",e),...r,children:t}),x0=({url:t,name:e,alt:r="User",size:n="md",className:i})=>{const a={sm:"size-8 text-xs",md:"size-10 text-sm",lg:"size-16 text-lg",xl:"size-32 text-2xl"},s=e?e.charAt(0).toUpperCase():r?r.charAt(0).toUpperCase():"?";return f.jsx("div",{className:WC("rounded-full bg-surface-light border border-white/10 flex items-center justify-center overflow-hidden shrink-0 text-slate-400 font-bold select-none",a[n],i),children:t?f.jsx("img",{src:t,alt:e||r,className:"w-full h-full object-cover"}):f.jsx("span",{children:s})})},d$=()=>f.jsx("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark relative",children:f.jsx("main",{className:"flex-1 min-w-0 relative overflow-hidden flex flex-col",children:f.jsx(GC,{})})}),f$="/api",Ne={async request(t,e={}){const r=`${f$}${t}`,n={"Content-Type":"application/json",...e.headers},i=await fetch(r,{...e,headers:n,credentials:"include"});if(!i.ok){const a=await i.json().catch(()=>({}));throw new Error(a.error||`HTTP error! status: ${i.status}`)}return i.status===204||i.headers.get("content-length")==="0"?null:i.json()},get(t,e={}){return this.request(t,{method:"GET",headers:e})},post(t,e,r={}){return this.request(t,{method:"POST",body:JSON.stringify(e),headers:r})},put(t,e,r={}){return this.request(t,{method:"PUT",body:JSON.stringify(e),headers:r})},patch(t,e,r={}){return this.request(t,{method:"PATCH",body:JSON.stringify(e),headers:r})},delete(t,e={}){return this.request(t,{method:"DELETE",headers:e})}},dw={list:()=>Ne.get("/workspaces"),create:(t,e,r,n)=>Ne.post("/workspaces",{name:t,title:e,genre:r,imageUrl:n}),delete:t=>Ne.delete("/workspaces/"+t),select:t=>Ne.post("/workspaces/select",{projectName:t})},h$=["FANTASA","SCI-FI","HORROR","LORE","MISTERIO","HISTRICO","CYBERPUNK","STEAMPUNK"],p$=({isOpen:t,onClose:e,onCreate:r})=>{if(!t)return null;const[n,i]=K.useState(!1),[a,s]=K.useState({name:"",title:"",genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"}),o=u=>{const{name:c,value:d}=u.target;s(h=>({...h,[c]:d}))},l=u=>{u.preventDefault();let c=a.name;if(!c&&a.title&&(c=a.title.toLowerCase().replace(/[^a-z0-9]/g,"-")),!c){alert("Project ID/Name is required");return}r({...a,name:c}),e(),s({name:"",title:"",genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"})};return Zs.createPortal(f.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[f.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),f.jsxs("div",{className:"relative w-full max-w-2xl bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex animate-in zoom-in-95 duration-200",children:[f.jsxs("div",{className:"w-1/3 bg-black relative hidden sm:block",children:[f.jsx("img",{src:a.imageUrl,onError:()=>i(!0),className:`absolute inset-0 w-full h-full object-cover opacity-60 transition-opacity duration-500 ${n?"hidden":""}`,alt:"Preview"}),f.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-6 bg-gradient-to-t from-black to-transparent",children:[f.jsx("h4",{className:"text-white font-black text-xl leading-none",children:a.title||"Untitled"}),f.jsx("span",{className:"text-[10px] font-bold text-primary uppercase tracking-widest mt-2 block",children:a.genre})]})]}),f.jsxs("div",{className:"flex-1 p-8",children:[f.jsx("h2",{className:"text-2xl font-black text-white mb-6",children:"Nuevo Cuaderno"}),f.jsxs("form",{onSubmit:l,className:"space-y-5",children:[f.jsxs("div",{className:"space-y-1.5",children:[f.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Ttulo del Proyecto"}),f.jsx("input",{type:"text",name:"title",value:a.title,onChange:o,placeholder:"e.g. Las Crnicas de Etheria",className:"w-full bg-surface-dark border border-glass-border rounded-xl px-4 py-3 text-white text-sm focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all",autoFocus:!0})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"ID de Archivo (Slug)"}),f.jsx("input",{type:"text",name:"name",value:a.name,onChange:o,placeholder:"e.g. etheria-v1",className:"w-full bg-surface-dark border border-glass-border rounded-xl px-4 py-3 text-white font-mono text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all placeholder:text-white/10"}),f.jsx("p",{className:"text-[10px] text-white/20",children:"Se usar como nombre del archivo .db"})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Gnero"}),f.jsx("div",{className:"grid grid-cols-2 gap-2",children:h$.slice(0,4).map(u=>f.jsx("button",{type:"button",onClick:()=>s(c=>({...c,genre:u})),className:`px-3 py-2 rounded-lg text-[10px] font-bold border transition-all ${a.genre===u?"bg-primary text-white border-primary":"bg-surface-dark border-glass-border text-text-muted hover:border-white/20"}`,children:u},u))})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Imagen de Portada (URL)"}),f.jsx("input",{type:"text",name:"imageUrl",value:a.imageUrl,onChange:u=>{s(c=>({...c,imageUrl:u.target.value})),i(!1)},className:"w-full bg-surface-dark border border-glass-border rounded-xl px-4 py-3 text-white text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all truncate"})]}),f.jsxs("div",{className:"pt-4 flex gap-3",children:[f.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-surface-dark hover:bg-white/5 border border-glass-border rounded-xl text-xs font-bold text-text-muted transition-all",children:"Cancelar"}),f.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold transition-all shadow-lg shadow-primary/20 flex items-center justify-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"rocket_launch"}),"Crear Universo"]})]})]})]})]})]}),document.body)},m$=()=>{const t=Li(),[e,r]=K.useState([]),[n,i]=K.useState(!0),[a,s]=K.useState(null),[o,l]=K.useState(""),[u,c]=K.useState(!1);K.useEffect(()=>{d()},[]);const d=async()=>{try{i(!0);const y=await dw.list();r(y)}catch(y){console.error("Failed to load workspaces",y),s("Error al cargar cuadernos. Est el servidor encendido?")}finally{i(!1)}},h=async y=>{try{i(!0);const b=await dw.select(y);b.success&&b.redirect&&(localStorage.setItem("user",JSON.stringify({username:"local",success:!0})),t(b.redirect))}catch(b){s(b.message||"Fallo al entrar al cuaderno"),i(!1)}},m=async y=>{try{i(!0),(await dw.create(y.name,y.title,y.genre,y.imageUrl)).success&&await h(y.name)}catch{s("Error al crear cuaderno"),i(!1)}},v=y=>{const b=y.split("").reduce((k,N)=>k+N.charCodeAt(0),0),S=["FANTASA","SCI-FI","HORROR","LORE","MISTERIO"],w=["https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800","https://images.unsplash.com/photo-1451187580459-43490279c0fa?auto=format&fit=crop&q=80&w=800","https://images.unsplash.com/photo-1505634467193-785724601157?auto=format&fit=crop&q=80&w=800","https://images.unsplash.com/photo-1478720568477-152d9b164e26?auto=format&fit=crop&q=80&w=800"];return{tag:S[b%S.length],img:w[b%w.length],desc:"Una tierra dividida por la magia y la tecnologa antigua...",initials:y.substring(0,2).toUpperCase(),time:"hace 2h"}},x=e.filter(y=>y.toLowerCase().includes(o.toLowerCase()));return f.jsxs("div",{className:"h-screen w-full bg-[#0a0b14] text-white flex flex-col items-center font-sans selection:bg-indigo-500/30 overflow-hidden",children:[f.jsxs("div",{className:"w-full max-w-6xl flex-1 flex flex-col overflow-y-auto custom-scrollbar p-8",children:[f.jsxs("header",{className:"w-full mt-24 mb-12 flex flex-col lg:flex-row lg:items-end justify-between gap-8 flex-shrink-0",children:[f.jsx("div",{className:"space-y-4",children:f.jsx("div",{className:"flex items-center gap-4",children:f.jsxs("h1",{className:"text-6xl font-black tracking-tighter leading-none",children:[f.jsx("span",{className:"block text-indigo-400",children:"Mis"}),f.jsx("span",{className:"block text-white",children:"Cuadernos"})]})})}),f.jsx("div",{className:"flex items-center gap-4",children:f.jsxs("div",{className:"relative group min-w-[300px]",children:[f.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-white/20 text-xl group-focus-within:text-indigo-400 transition-colors pointer-events-none",children:"search"}),f.jsx("input",{type:"text",placeholder:"Buscar...",value:o,onChange:y=>l(y.target.value),className:"w-full bg-[#13141f] border border-white/5 rounded-2xl py-3 pl-12 pr-4 text-sm text-white focus:outline-none focus:border-indigo-500/50 transition-all placeholder:text-white/10"})]})})]}),f.jsx("section",{className:"w-full max-w-6xl",children:n?f.jsxs("div",{className:"flex flex-col items-center gap-6 py-20 opacity-20",children:[f.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),f.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:"Accediendo al Sector Local..."})]}):f.jsxs("div",{className:"flex flex-wrap gap-6 justify-start pb-20",children:[f.jsxs("div",{onClick:()=>c(!0),className:"group relative h-[380px] rounded-[2.5rem] border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-6 hover:bg-white/5 hover:border-indigo-500/30 transition-all cursor-pointer overflow-hidden animate-in fade-in duration-700 w-full md:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)]",children:[f.jsx("div",{className:"w-20 h-20 rounded-full bg-[#13141f] border border-white/5 flex items-center justify-center text-4xl text-white/20 group-hover:scale-110 group-hover:text-indigo-400 transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-4xl",children:"add"})}),f.jsxs("div",{className:"text-center",children:[f.jsx("h3",{className:"text-xl font-black tracking-tight text-white/50 group-hover:text-white transition-colors",children:"Nuevo Cuaderno"}),f.jsx("p",{className:"text-[10px] font-bold text-white/20 uppercase tracking-widest mt-2 group-hover:text-white/40",children:"Inicia un nuevo universo"})]})]}),x.map(y=>{const b=v(y);return f.jsxs("div",{onClick:()=>h(y),className:"group relative h-[380px] rounded-[2.5rem] bg-[#13141f] border border-white/5 overflow-hidden transition-all hover:-translate-y-2 hover:shadow-2xl hover:shadow-indigo-500/10 cursor-pointer animate-in fade-in slide-in-from-bottom-4 w-full md:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)]",children:[f.jsxs("div",{className:"absolute inset-x-0 top-0 h-2/3",children:[f.jsx("img",{src:b.img,className:"w-full h-full object-cover opacity-40 group-hover:opacity-60 transition-opacity",alt:""}),f.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#13141f] via-transparent to-transparent"})]}),f.jsx("div",{className:"absolute inset-0 flex flex-col justify-end p-8",children:f.jsxs("div",{className:"mt-auto space-y-3",children:[f.jsx("span",{className:"inline-block px-3 py-1 bg-red-500/20 border border-red-500/30 text-[9px] font-black text-red-100 rounded-lg tracking-widest uppercase",children:b.tag}),f.jsx("h3",{className:"text-3xl font-black text-white tracking-tighter leading-tight group-hover:text-indigo-400 transition-colors",children:y}),f.jsx("p",{className:"text-xs text-white/40 line-clamp-2 leading-relaxed",children:b.desc}),f.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-white/5 mt-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]"}),f.jsxs("span",{className:"text-[9px] font-black uppercase tracking-widest text-white/20",children:["ltima edicin: ",f.jsx("span",{className:"text-white/40",children:b.time})]})]}),f.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-[10px] font-black text-indigo-300",children:b.initials})]})]})})]},y)})]})})]}),a&&f.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 px-6 py-3 bg-red-500/20 border border-red-500/30 text-red-200 rounded-2xl text-xs font-bold shadow-2xl animate-bounce",children:a}),f.jsx(p$,{isOpen:u,onClose:()=>c(!1),onCreate:m})]})},Mg=({icon:t,title:e,desc:r,color:n})=>f.jsxs("div",{className:"group relative p-8 rounded-[32px] bg-surface-dark border border-white/5 hover:border-white/10 transition-all cursor-pointer flex flex-col h-full gap-6 hover:shadow-2xl hover:shadow-black/40",children:[f.jsx("div",{className:`size-14 rounded-2xl ${n} flex items-center justify-center text-white shadow-lg group-hover:scale-110 transition-all duration-500`,children:f.jsx("span",{className:"material-symbols-outlined text-3xl",children:t})}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-2xl font-bold text-white tracking-tight",children:e}),f.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:r})]}),f.jsxs("div",{className:"mt-auto pt-4 border-t border-white/5 flex items-center justify-between text-slate-500 group-hover:text-white transition-colors",children:[f.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Architect Tool"}),f.jsx("span",{className:"material-symbols-outlined text-xl group-hover:translate-x-1 transition-transform",children:"arrow_forward"})]})]}),g$=()=>{const{projectName:t,handleCreateEntity:e}=jl(),r=Li();return Bi(),f.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 gap-16 max-w-6xl mx-auto w-full",children:[f.jsxs("div",{className:"flex flex-col items-center text-center gap-8 max-w-2xl animate-in fade-in slide-in-from-bottom-8 duration-700",children:[f.jsx("div",{className:"size-20 rounded-full bg-white text-background-dark flex items-center justify-center shadow-2xl shadow-white/20",children:f.jsx("span",{className:"material-symbols-outlined text-4xl font-bold",children:"explore"})}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tighter leading-tight",children:"Bienvenido de nuevo, Viajero."}),f.jsxs("p",{className:"text-xl text-slate-400 font-medium leading-relaxed",children:["Tu mundo ",f.jsx("span",{className:"text-primary font-bold",children:t||"Cargando..."})," espera ser descubierto. El lienzo est vaco, pero tu imaginacin no tiene lmites. Cmo empezamos hoy?"]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 w-full items-stretch animate-in fade-in slide-in-from-bottom-12 duration-1000 delay-300",children:[f.jsx("div",{onClick:()=>e(null,"default"),children:f.jsx(Mg,{icon:"person_add",title:"Aadir Entidad",desc:"Agrega un personaje, lugar o item importante a tu base de datos.",color:"bg-indigo-600"})}),f.jsx("div",{onClick:()=>e(null,"map"),children:f.jsx(Mg,{icon:"map",title:"Crear Mapa",desc:"Dibuja una representacin cartogrfica de una regin.",color:"bg-purple-600"})}),f.jsx("div",{onClick:()=>r("writing"),children:f.jsx(Mg,{icon:"edit_note",title:"Empezar a Escribir",desc:"Abre el editor de texto y comienza un nuevo captulo.",color:"bg-emerald-600"})}),f.jsx("div",{onClick:()=>alert("WIP: Notas Rpidas"),children:f.jsx(Mg,{icon:"lightbulb",title:"Ver Ideas Rpidas",desc:"Revisa tus notas y fragmentos de inspiracin guardados.",color:"bg-amber-600"})})]})]})},v$=()=>{var c,d;const t=Li(),[e,r]=K.useState(null),[n,i]=K.useState("appearance"),[a,s]=K.useState({theme:"deep_space",font:"Manrope",fontSize:16,focusMode:!1,transparencyEffects:!0,vaultPath:"./data"});K.useEffect(()=>{console.log("Settings Page Mounted");try{const h=localStorage.getItem("user");h&&h!=="undefined"&&r(JSON.parse(h))}catch(h){console.error("Failed to parse user settings",h)}},[]);const o=async()=>{try{await Ne.post("/auth/logout",{})}catch(h){console.error("Logout error",h)}finally{localStorage.removeItem("user"),sessionStorage.clear(),t("/")}},l=[{id:"general",label:"General",icon:"settings"},{id:"appearance",label:"Apariencia",icon:"palette"},{id:"editor",label:"Editor",icon:"edit_note"},{id:"sync",label:"Sincronizacin",icon:"sync_lock"},{id:"notifications",label:"Notificaciones",icon:"notifications"}],u=[{id:"deep_space",label:"Deep Space",color:"#0f172a"},{id:"nebula",label:"Nebula",color:"#312e81"},{id:"high_contrast",label:"High Contrast",color:"#000000"}];return f.jsxs("div",{className:"flex w-full h-full bg-[#050508] text-white font-sans overflow-hidden",children:[f.jsxs("aside",{className:"w-64 flex-none flex flex-col border-r border-white/5 bg-[#0a0a0e]",children:[f.jsxs("div",{className:"p-8 pb-4",children:[f.jsx("div",{className:"size-10 rounded-full bg-white flex items-center justify-center text-black mb-4",children:f.jsx("span",{className:"material-symbols-outlined text-2xl",children:"settings"})}),f.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"Ajustes"}),f.jsx("p",{className:"text-xs text-slate-500 font-mono mt-1",children:"v2.4.0 Local-Build"})]}),f.jsx("nav",{className:"flex-1 px-4 py-4 space-y-1",children:l.map(h=>f.jsxs("button",{onClick:()=>i(h.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold transition-all ${n===h.id?"bg-indigo-500/10 text-indigo-400":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[f.jsx("span",{className:"material-symbols-outlined text-lg",children:h.icon}),h.label]},h.id))}),f.jsx("div",{className:"p-4 border-t border-white/5",children:f.jsxs("button",{onClick:o,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold text-red-400 hover:bg-red-500/10 transition-colors",children:[f.jsx("span",{className:"material-symbols-outlined text-lg",children:"logout"}),"Cerrar Sesin"]})})]}),f.jsx("main",{className:"flex-1 overflow-y-auto p-12 custom-scrollbar",children:f.jsxs("div",{className:"max-w-3xl mx-auto space-y-12",children:[f.jsxs("header",{children:[f.jsx("h2",{className:"text-3xl font-bold mb-2",children:(c=l.find(h=>h.id===n))==null?void 0:c.label}),f.jsx("p",{className:"text-slate-500",children:"Personaliza la interfaz visual y tu entorno de escritura para maximizar tu creatividad y concentracin."})]}),n==="appearance"&&f.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4",children:[f.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8",children:[f.jsx("h3",{className:"text-lg font-bold mb-1",children:"Tema de la Interfaz"}),f.jsx("p",{className:"text-xs text-slate-500 mb-6",children:"Selecciona el esquema de colores que prefieras."}),f.jsx("div",{className:"grid grid-cols-3 gap-6",children:u.map(h=>f.jsxs("button",{onClick:()=>s({...a,theme:h.id}),className:`relative group text-left transition-all ${a.theme===h.id?"ring-2 ring-indigo-500":"hover:ring-1 hover:ring-white/20"} rounded-2xl overflow-hidden`,children:[f.jsx("div",{className:"h-32 bg-black/20 relative p-4 flex items-center justify-center",children:f.jsx("div",{className:"w-full h-full rounded-xl flex items-center justify-center",style:{backgroundColor:h.color},children:f.jsx("div",{className:"size-8 rounded-full bg-white/10 backdrop-blur-md"})})}),f.jsx("div",{className:"p-4 bg-[#18181b]",children:f.jsx("span",{className:"text-xs font-bold text-slate-300 group-hover:text-white",children:h.label})})]},h.id))})]}),f.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8 space-y-8",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("span",{className:"material-symbols-outlined text-indigo-400",children:"text_fields"}),f.jsx("h3",{className:"text-lg font-bold",children:"Configuracin del Editor"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-12 border-b border-white/5 pb-8",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Tipografa"}),f.jsxs("div",{className:"relative",children:[f.jsxs("select",{value:a.font,onChange:h=>s({...a,font:h.target.value}),className:"w-full bg-[#18181b] border border-white/10 rounded-xl px-4 py-3 text-sm text-white appearance-none outline-none focus:border-indigo-500 transition-colors",children:[f.jsx("option",{value:"Manrope",children:"Manrope (Sans-serif)"}),f.jsx("option",{value:"Inter",children:"Inter"}),f.jsx("option",{value:"Merriweather",children:"Merriweather (Serif)"})]}),f.jsx("span",{className:"material-symbols-outlined absolute right-4 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-sm",children:"expand_more"})]}),f.jsx("p",{className:"text-[10px] text-slate-600",children:"La fuente utilizada en el lienzo de escritura."})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Tamao de Fuente"}),f.jsxs("span",{className:"text-xs font-bold text-indigo-400",children:[a.fontSize,"px"]})]}),f.jsx("input",{type:"range",min:"12",max:"24",value:a.fontSize,onChange:h=>s({...a,fontSize:parseInt(h.target.value)}),className:"w-full accent-indigo-500 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer"}),f.jsxs("div",{className:"flex justify-between text-[10px] text-slate-600 font-bold uppercase",children:[f.jsx("span",{children:"Aa"}),f.jsx("span",{children:"Aa"})]})]})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"size-10 rounded-full bg-white/5 flex items-center justify-center text-slate-400",children:f.jsx("span",{className:"material-symbols-outlined",children:"center_focus_strong"})}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-bold text-white",children:"Modo Enfoque"}),f.jsx("p",{className:"text-xs text-slate-500",children:"Oculta todos los paneles laterales al escribir."})]})]}),f.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:a.focusMode,onChange:h=>s({...a,focusMode:h.target.checked}),className:"sr-only peer"}),f.jsx("div",{className:"w-11 h-6 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-slate-400 after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-500 peer-checked:after:bg-white"})]})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsx("div",{className:"size-10 rounded-full bg-white/5 flex items-center justify-center text-slate-400",children:f.jsx("span",{className:"material-symbols-outlined",children:"blur_on"})}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-bold text-white",children:"Efectos de Transparencia"}),f.jsx("p",{className:"text-xs text-slate-500",children:"Desactivar para mejorar el rendimiento."})]})]}),f.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:a.transparencyEffects,onChange:h=>s({...a,transparencyEffects:h.target.checked}),className:"sr-only peer"}),f.jsx("div",{className:"w-11 h-6 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-slate-400 after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-500 peer-checked:after:bg-white"})]})]})]})]}),f.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-1 relative overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-indigo-500 rounded-l-3xl"}),f.jsxs("div",{className:"p-8",children:[f.jsxs("div",{className:"flex justify-between items-start mb-6",children:[f.jsxs("div",{className:"flex gap-4",children:[f.jsx("span",{className:"material-symbols-outlined text-indigo-400 text-2xl",children:"folder_special"}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-bold text-white",children:"Almacenamiento Local"}),f.jsx("p",{className:"text-xs text-slate-500",children:"Tus datos viven en tu dispositivo. Gestiona tus copias de seguridad."})]})]}),f.jsxs("span",{className:"px-3 py-1 bg-green-500/10 text-green-400 rounded-full text-[10px] font-bold uppercase border border-green-500/20 flex items-center gap-2",children:[f.jsx("span",{className:"size-1.5 rounded-full bg-green-500 animate-pulse"})," Sincronizado"]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs font-bold text-slate-500 block mb-2",children:"Ruta de la Bveda"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("div",{className:"flex-1 bg-[#18181b] border border-white/10 rounded-xl px-4 py-3 text-xs font-mono text-slate-300 truncate",children:a.vaultPath}),f.jsx("button",{className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-xl text-xs font-bold transition-colors",children:"Cambiar"})]})]}),f.jsxs("div",{className:"bg-[#18181b] rounded-xl p-4 flex items-center justify-between border border-white/5",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"size-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:f.jsx("span",{className:"material-symbols-outlined",children:"history"})}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-bold text-white",children:"Copia de Seguridad Automtica"}),f.jsx("p",{className:"text-[10px] text-slate-500",children:"Ultima copia: Hace 12 minutos"})]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-lg text-xs font-bold transition-colors",children:"Restaurar"}),f.jsx("button",{className:"px-4 py-2 bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg text-xs font-bold transition-colors shadow-lg shadow-indigo-500/20",children:"Respaldar Ahora"})]})]})]})]})]}),f.jsx("div",{className:"flex justify-end pt-8 pb-20",children:f.jsx("button",{className:"px-8 py-3 bg-white text-black font-bold rounded-full hover:scale-105 transition-transform shadow-xl",children:"Guardar Cambios"})})]}),n!=="appearance"&&f.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] text-slate-600",children:[f.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-20",children:"construction"}),f.jsx("h3",{className:"text-xl font-bold text-slate-500",children:"En Construccin"}),f.jsxs("p",{className:"text-sm",children:["El mdulo ",(d=l.find(h=>h.id===n))==null?void 0:d.label," estar disponible pronto."]})]})]})})]})},Wt=K.forwardRef(({children:t,variant:e="primary",size:r="md",className:n,icon:i,isLoading:a,...s},o)=>{const l="inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed active:scale-95",u={primary:"bg-primary text-white shadow-lg shadow-primary/25 hover:bg-primary-light hover:shadow-primary/40 border border-transparent",secondary:"bg-surface-light text-slate-200 border border-white/10 hover:bg-white/5 hover:text-white hover:border-white/20",ghost:"bg-transparent text-slate-400 hover:text-white hover:bg-white/5",danger:"bg-red-500/10 text-red-500 border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/50 hover:shadow-lg hover:shadow-red-500/10",outline:"bg-transparent border border-primary/50 text-primary hover:bg-primary/10"},c={xs:"px-2.5 py-1 text-xs gap-1.5",sm:"px-3 py-1.5 text-xs gap-1.5",md:"px-4 py-2 text-sm gap-2",lg:"px-6 py-3 text-base gap-3",icon:"size-9 p-0"};return f.jsxs("button",{ref:o,className:WC(l,u[e],c[r],n),disabled:a,...s,children:[a?f.jsx("span",{className:"material-symbols-outlined animate-spin text-[18px]",children:"progress_activity"}):i?f.jsx("span",{className:"material-symbols-outlined text-[18px]",children:i}):null,t]})});Wt.displayName="Button";const Xp=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirmar",cancelText:s="Cancelar",type:o="danger"})=>t?Zs.createPortal(f.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[f.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),f.jsxs("div",{className:"relative w-full max-w-md bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl p-6 animate-in zoom-in-95 duration-200 overflow-hidden",children:[f.jsx("div",{className:"absolute top-0 left-0 right-0 h-32 bg-gradient-to-b from-white/5 to-transparent pointer-events-none"}),f.jsxs("div",{className:"relative z-10 text-center",children:[f.jsx("div",{className:`mx-auto mb-4 size-16 rounded-2xl flex items-center justify-center ${o==="danger"?"bg-red-500/10 text-red-500":"bg-yellow-500/10 text-yellow-500"}`,children:f.jsx("span",{className:"material-symbols-outlined text-3xl",children:o==="danger"?"delete_forever":"warning"})}),f.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),f.jsx("p",{className:"text-text-muted text-sm mb-8 leading-relaxed",children:i}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 rounded-xl bg-surface-light hover:bg-white/10 text-text-muted hover:text-white text-xs font-bold transition-all border border-white/5",children:s}),f.jsx("button",{onClick:()=>{r(),e()},className:`flex-1 px-4 py-3 rounded-xl text-white text-xs font-bold transition-all shadow-lg flex items-center justify-center gap-2
                                ${o==="danger"?"bg-red-500 hover:bg-red-600 shadow-red-500/20":"bg-primary hover:bg-primary-light shadow-primary/20"}`,children:f.jsx("span",{children:a})})]})]})]})]}),document.body):null,ET=({compact:t=!1})=>{const[e,r]=K.useState(null),[n,i]=K.useState([]),[a,s]=K.useState(!1),[o,l]=K.useState(null);K.useEffect(()=>{u()},[]);const u=async()=>{try{const m=await Ne.get("/world-bible/folders");m.length>0&&r(m[0].id),c()}catch(m){console.error("Init error:",m)}},c=async()=>{s(!0);try{const m=await Ne.get("/world-bible/templates/global");i(m)}catch(m){console.error("Error loading templates:",m)}finally{s(!1)}},d=async m=>{if(e)try{await Ne.post(`/world-bible/folders/${e}/templates`,{nombre:m.label,tipo:m.type,required:m.required,metadata:m.metadata?JSON.stringify(m.metadata):null,global:!0}),c()}catch(v){console.error("Error creating template:",v)}},h=async()=>{if(o)try{await Ne.delete(`/world-bible/templates/${o}`),i(m=>m.filter(v=>v.id!==o))}catch(m){console.error("Error deleting template:",m)}finally{l(null)}};return f.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[f.jsxs(Et,{className:`${t?"p-4 bg-transparent border-none shadow-none":"p-8 space-y-8"}`,children:[f.jsx("header",{className:`flex ${t?"flex-col gap-4":"justify-between items-center"}`,children:f.jsxs("div",{children:[f.jsx("h3",{className:`${t?"text-sm":"text-xl"} font-bold text-white`,children:"Atributos Globales"}),f.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Define atributos disponibles para todas las entidades."})]})}),f.jsxs("div",{className:"space-y-4",children:[a?f.jsx("div",{className:"text-center p-4 text-slate-500",children:"Cargando plantillas..."}):n.map((m,v)=>f.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-primary/50 hover:bg-white/5 transition-all cursor-grab active:cursor-grabbing group select-none",draggable:!0,onDragStart:x=>{x.dataTransfer.setData("application/reactflow/type","attribute"),x.dataTransfer.setData("templateId",m.id),x.dataTransfer.setData("templateData",JSON.stringify(m)),x.dataTransfer.effectAllowed="copy"},children:[f.jsxs("span",{className:"text-[10px] font-black text-slate-700 w-6 group-hover:text-primary transition-colors",children:["0",v+1]}),f.jsxs("div",{className:"flex-1 pointer-events-none",children:[f.jsx("div",{className:"text-sm font-bold text-white",children:m.nombre}),f.jsxs("div",{className:"text-[10px] text-slate-500 uppercase tracking-widest",children:[m.tipo," ",m.esObligatorio&&" Required"]}),m.metadata&&f.jsx("div",{className:"text-[10px] text-slate-600 font-mono mt-1 truncate",children:m.metadata})]}),f.jsx("button",{onClick:()=>l(m.id),className:"p-1.5 text-slate-500 hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",title:"Eliminar Plantilla Global",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},m.id)),f.jsx(y$,{onAdd:d})]})]}),f.jsx(Xp,{isOpen:!!o,onClose:()=>l(null),onConfirm:h,title:"Eliminar Plantilla",message:"Ests seguro de que quieres eliminar esta plantilla? Esta accin es irreversible.",confirmText:"Eliminar",type:"danger"})]})},y$=({onAdd:t})=>{const[e,r]=K.useState(""),[n,i]=K.useState("text"),[a,s]=K.useState(!1),[o,l]=K.useState([""]),u=()=>l([...o,""]),c=m=>l(o.filter((v,x)=>x!==m)),d=(m,v)=>{const x=[...o];x[m]=v,l(x)},h=()=>{if(!e)return;let m=null;["select","multi_select"].includes(n)&&(m={options:o.filter(v=>v.trim())}),t({label:e,type:n,required:a,metadata:m}),r(""),l([""])};return f.jsxs("div",{className:"p-4 rounded-2xl border-2 border-dashed border-white/10 bg-white/[0.01] space-y-4",children:[f.jsx("h4",{className:"text-xs font-black uppercase tracking-widest text-primary",children:"Add New Attribute"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsx("input",{placeholder:"Field Name",value:e,onChange:m=>r(m.target.value),className:"bg-black/20 border border-white/5 rounded-xl px-4 py-2 text-xs text-white outline-none focus:border-primary/30 min-w-0"}),f.jsxs("select",{value:n,onChange:m=>i(m.target.value),className:"bg-black/20 border border-white/5 rounded-xl px-4 py-2 text-xs text-white outline-none",children:[f.jsx("option",{value:"text",children:"Text (Long)"}),f.jsx("option",{value:"short_text",children:"Text (Short)"}),f.jsx("option",{value:"number",children:"Number"}),f.jsx("option",{value:"date",children:"Date"}),f.jsx("option",{value:"select",children:"Single Selection (Dropdown)"}),f.jsx("option",{value:"multi_select",children:"Multiple Selection"}),f.jsx("option",{value:"boolean",children:"Switch (True/False)"})]})]}),["select","multi_select"].includes(n)&&f.jsxs("div",{className:"space-y-2",children:[f.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Options"}),f.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-2 custom-scrollbar",children:o.map((m,v)=>f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{placeholder:`Option ${v+1}`,value:m,onChange:x=>d(v,x.target.value),className:"flex-1 bg-black/20 border border-white/5 rounded-lg px-3 py-1.5 text-xs text-white outline-none focus:border-primary/30"}),f.jsx("button",{onClick:()=>c(v),className:"p-1.5 hover:bg-red-500/20 text-slate-500 hover:text-red-400 rounded-lg transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]},v))}),f.jsx("button",{onClick:u,className:"w-full py-1.5 text-[10px] font-bold uppercase tracking-widest text-primary hover:bg-primary/5 rounded-lg border border-dashed border-primary/20 transition-all",children:"+ Add Custom Option"})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:a,onChange:m=>s(m.target.checked),className:"size-4 rounded border-white/10 bg-white/5 accent-primary"}),f.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"Required Field"})]}),f.jsx("button",{onClick:h,className:"px-4 py-2 bg-primary/20 text-primary rounded-lg text-xs font-bold hover:bg-primary/30 transition-all",children:"+ Add Field"})]})]})},TT=({projectName:t,storageKey:e})=>{const[r,n]=K.useState([]),[i,a]=K.useState(!1),[s,o]=K.useState(null),l=()=>e||`notes_v2_${t}`;K.useEffect(()=>{const S=l();if(!S)return;const w=localStorage.getItem(S);if(w)n(JSON.parse(w));else if(!e){const k=localStorage.getItem(`notes_${t}`);if(k){const N={id:Date.now(),title:"Nota General",content:k};n([N]),localStorage.setItem(S,JSON.stringify([N]))}}},[t,e]);const u=S=>{n(S);const w=l();w&&localStorage.setItem(w,JSON.stringify(S))},c=()=>{const S={id:Date.now(),title:"Nueva Nota",content:""};u([...r,S]),o(S.id)},[d,h]=K.useState(null),m=S=>{h(S)},v=()=>{d&&(u(r.filter(S=>S.id!==d)),h(null))},x=(S,w,k)=>{u(r.map(N=>N.id===S?{...N,[w]:k}:N))},y=()=>a(!i),b=()=>f.jsxs("div",{className:`flex flex-col h-full bg-surface-dark/40 ${i?"":"max-h-[25vh]"}`,children:[f.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-glass-border bg-white/5",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"edit_note"}),f.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-white",children:["Notas (",r.length,")"]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:c,className:"p-1 hover:text-primary text-text-muted transition-colors",title:"Aadir Nota",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})}),f.jsx("button",{onClick:y,className:"p-1 hover:text-white text-text-muted transition-colors",title:"Pantalla Completa",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:i?"fullscreen_exit":"fullscreen"})})]})]}),f.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-2",children:r.length===0?f.jsx("div",{className:"py-8 text-center opacity-30 italic text-[10px] uppercase font-bold",children:"Sin notas"}):r.map(S=>f.jsxs("div",{className:"group bg-white/5 border border-glass-border rounded-xl overflow-hidden hover:border-primary/30 transition-all",children:[f.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white/5",children:[f.jsx("input",{className:"bg-transparent border-none text-[11px] font-bold text-white outline-none w-full",value:S.title,onChange:w=>x(S.id,"title",w.target.value),placeholder:"Ttulo..."}),f.jsx("button",{onClick:()=>m(S.id),className:"opacity-0 group-hover:opacity-100 p-1 text-text-muted hover:text-red-400 transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-xs",children:"delete"})})]}),f.jsx("textarea",{className:"w-full bg-transparent p-3 text-xs text-white/70 outline-none resize-none min-h-[80px] custom-scrollbar",value:S.content,onChange:w=>x(S.id,"content",w.target.value),placeholder:"Escribe el contenido aqu..."})]},S.id))}),f.jsx(Xp,{isOpen:!!d,onClose:()=>h(null),onConfirm:v,title:"Eliminar Nota",message:"Ests seguro de que quieres eliminar esta nota? No se podr recuperar.",confirmText:"Eliminar",type:"danger"})]});return i?f.jsx("div",{className:"fixed inset-0 z-[100] bg-background-dark/95 backdrop-blur-md p-8 flex flex-col items-center",children:f.jsx("div",{className:"w-full max-w-4xl h-full flex flex-col border border-glass-border rounded-3xl overflow-hidden shadow-2xl bg-surface-dark",children:f.jsx(b,{})})}):f.jsx("div",{className:"h-full border border-glass-border rounded-2xl overflow-hidden",children:f.jsx(b,{})})},ru=({to:t,icon:e,label:r,collapsed:n,end:i})=>f.jsxs(PV,{to:t,end:i,className:({isActive:a})=>`
            flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all group
            ${a?"bg-primary text-white shadow-lg shadow-primary/20":"text-text-muted hover:text-white hover:bg-white/5"}
            ${n?"justify-center":""}
        `,title:n?r:"",children:[f.jsx("span",{className:"material-symbols-outlined text-xl",children:e}),!n&&f.jsx("span",{className:"text-sm font-bold tracking-wide",children:r})]}),jT=t=>{switch(t==null?void 0:t.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},x$=()=>{console.log("ArchitectLayout Mounting");const{username:t,projectName:e,folderSlug:r}=Bi();Li();const n=Ju(),[i,a]=K.useState(!0),[s,o]=K.useState(!1),[l,u]=K.useState("Loading..."),[c,d]=K.useState(null),[h,m]=K.useState("NOTES"),[v,x]=K.useState(""),[y,b]=K.useState([]),[S,w]=K.useState(null),[k,N]=K.useState(null),[T,j]=K.useState({name:"",description:"",type:"regional",showGrid:!0,gridSize:50,width:800,height:600,bgImage:null}),[M,A]=K.useState(null);K.useState("identity");const[P,D]=K.useState("notes"),[R,I]=K.useState(""),[U,B]=K.useState("ALL"),z=n.pathname.includes("/bible"),F=n.pathname.includes("/writing"),[V,J]=K.useState("index"),[Y,L]=K.useState(null),[G,ee]=K.useState([]),[re,se]=K.useState("identity"),[de,W]=K.useState(null),ne=(Z,le)=>{Z.stopPropagation(),W(le)},ie=async()=>{if(de){try{await Ne.delete(`/world-bible/templates/${de}`),b(Z=>Z.filter(le=>le.id!==de))}catch(Z){console.error("Delete failed",Z)}W(null)}},$=async Z=>{Z.preventDefault();try{await Ne.put(`/world-bible/templates/${Y.id}`,Y),b(le=>le.map(ge=>ge.id===Y.id?Y:ge)),L(null)}catch(le){console.error("Update failed",le)}},q=`/${t}/${e}`;K.useEffect(()=>{e&&te(e);const Z=()=>{e&&te(e)};return window.addEventListener("focus",Z),()=>window.removeEventListener("focus",Z)},[e]);const te=async Z=>{try{const le=await Ne.get(`/proyectos/${Z}`);le&&(u(le.nombreProyecto),d(le.id))}catch(le){console.error("Error loading project:",le)}};return f.jsxs("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark text-text-main font-sans selection:bg-primary/30",children:[f.jsxs("aside",{className:`
                    flex-none bg-surface-dark border-r border-glass-border transition-all duration-500 relative flex flex-col z-30
                    ${i?"w-80":"w-20"}
                `,children:[f.jsxs("div",{className:"h-16 flex items-center justify-center border-b border-glass-border relative",children:[i?f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"size-8 rounded-lg bg-surface-light flex items-center justify-center text-primary shadow-inner",children:f.jsx("span",{className:"material-symbols-outlined",children:"auto_stories"})}),f.jsx("h2",{className:"text-sm font-black uppercase tracking-widest text-white truncate max-w-[150px]",children:l})]}):f.jsx("button",{onClick:()=>a(!0),className:"size-10 rounded-xl hover:bg-white/5 flex items-center justify-center text-text-muted hover:text-white transition-all",children:f.jsx("span",{className:"material-symbols-outlined",children:"menu"})}),i&&f.jsx("button",{onClick:()=>a(!1),className:"absolute right-4 text-text-muted hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"dock_to_left"})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar flex flex-col",children:f.jsxs("div",{className:"p-3 space-y-1",children:[f.jsx(ru,{to:q,icon:"home",label:"Dashboard",collapsed:!i,end:!0}),f.jsx(ru,{to:`${q}/bible`,icon:"menu_book",label:"World Bible",collapsed:!i}),f.jsx(ru,{to:`${q}/map`,icon:"map",label:"Atlas",collapsed:!i}),f.jsx(ru,{to:`${q}/timeline`,icon:"calendar_month",label:"Chronology",collapsed:!i}),f.jsx(ru,{to:`${q}/graph`,icon:"hub",label:"Graph",collapsed:!i}),f.jsx("div",{className:"h-px bg-glass-border my-2 mx-2 opacity-50"}),f.jsx(ru,{to:`${q}/writing`,icon:"edit_note",label:"Writing",collapsed:!i}),f.jsx(ru,{to:`${q}/settings`,icon:"settings",label:"Settings",collapsed:!i})]})}),f.jsx("footer",{className:"p-4 border-t border-glass-border",children:f.jsxs("div",{className:`flex items-center gap-3 ${!i&&"justify-center"}`,children:[f.jsx("div",{className:"size-10 rounded-full border border-glass-border p-1 bg-surface-light relative",children:f.jsx("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-primary to-purple-500 flex items-center justify-center text-white font-black text-xs",children:t?t.substring(0,2).toUpperCase():"US"})}),i&&f.jsxs("div",{className:"overflow-hidden",children:[f.jsx("h4",{className:"text-xs font-bold text-white truncate",children:t||"User"}),f.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-tighter",children:"Architect"})]})]})})]}),f.jsxs("main",{className:"flex-1 flex flex-col min-w-0 bg-background-dark relative",children:[f.jsx("div",{className:"h-16 w-full absolute top-0 left-0 bg-gradient-to-b from-background-dark to-transparent pointer-events-none"}),f.jsx("div",{className:"flex-1 flex overflow-hidden relative",children:f.jsx(GC,{context:{setRightPanelMode:m,setRightOpen:o,setRightPanelTitle:x,projectName:l,projectId:c,availableTemplates:y,setAvailableTemplates:b,setAddAttributeHandler:w,setCreateTemplateHandler:N,mapSettings:T,setMapSettings:j,setOnMapSettingsChange:A,entityTabs:G,setEntityTabs:ee,activeEntityTab:re,setActiveEntityTab:se,folderSearchTerm:R,setFolderSearchTerm:I,folderFilterType:U,setFolderFilterType:B}})})]}),f.jsxs("aside",{className:`
                    flex-none bg-surface-dark border-l border-glass-border transition-all duration-500 relative flex flex-col z-30
                    ${s?"w-80":"w-20"}
                `,children:[f.jsx("header",{className:"h-16 flex items-center px-6 border-b border-glass-border justify-between shrink-0",children:s?f.jsxs(f.Fragment,{children:[h==="CUSTOM"&&!F?f.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-primary",children:v||"Panel"}):F?f.jsxs("div",{className:"flex bg-white/5 rounded-lg p-1 gap-1 w-full mr-4",children:[f.jsx("button",{onClick:()=>J("index"),className:`flex-1 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${V==="index"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"ndice"}),f.jsx("button",{onClick:()=>J("notes"),className:`flex-1 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${V==="notes"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Notas"})]}):z&&h==="NOTES"?f.jsxs("div",{className:"flex bg-white/5 rounded-lg p-1 gap-1",children:[f.jsx("button",{onClick:()=>D("notes"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${P==="notes"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Notas"}),f.jsx("button",{onClick:()=>D("templates"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${P==="templates"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Plantillas"}),f.jsx("button",{onClick:()=>D("filters"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${P==="filters"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Explorar"})]}):f.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-white",children:v||(h==="NOTES"?"Notas Globales":"Constructor")}),f.jsx("button",{onClick:()=>o(!1),className:"text-text-muted hover:text-white transition-colors shrink-0",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"dock_to_right"})})]}):f.jsx("button",{onClick:()=>o(!0),className:"w-full h-full flex items-center justify-center text-text-muted hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined",children:h==="NOTES"||F?"edit_note":h==="MAP"?"map":h==="CUSTOM"?"build":"handyman"})})}),f.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar p-0",children:s?F?f.jsxs(f.Fragment,{children:[f.jsx("div",{id:"architect-right-panel-portal",className:`h-full relative flex flex-col ${V==="index"?"block":"hidden"}`}),f.jsx("div",{className:`h-full p-4 overflow-hidden ${V==="notes"?"block":"hidden"}`,children:f.jsx(TT,{projectName:e})})]}):h==="CUSTOM"?f.jsx("div",{id:"architect-right-panel-portal",className:"h-full relative flex flex-col"}):h==="NOTES"?P==="templates"&&z?f.jsx("div",{className:"h-full overflow-y-auto no-scrollbar",children:f.jsx(ET,{compact:!0})}):P==="filters"&&z?f.jsxs("div",{className:"h-full p-6 space-y-6 animate-in fade-in slide-in-from-right-4",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Bsqueda"}),f.jsxs("div",{className:"bg-black/20 border border-white/10 rounded-xl p-3 flex items-center gap-2 focus-within:border-primary transition-colors",children:[f.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"search"}),f.jsx("input",{value:R,onChange:Z=>I(Z.target.value),placeholder:"Buscar entidad...",className:"bg-transparent border-none outline-none text-sm text-white w-full placeholder-slate-600"}),R&&f.jsx("button",{onClick:()=>I(""),className:"text-slate-500 hover:text-white",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]})]}),f.jsx("div",{className:"h-px bg-glass-border"}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Filtrar por Tipo"}),f.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"ALL",label:"Todos",icon:"grid_view"},{id:"ENTITY",label:"Entidades",icon:"person"},{id:"MAP",label:"Mapas",icon:"map"},{id:"TIMELINE",label:"Timelines",icon:"timeline"}].map(Z=>f.jsxs("button",{onClick:()=>B(Z.id),className:`
                                                        p-3 rounded-xl border flex flex-col items-center gap-2 transition-all
                                                        ${U===Z.id?"bg-primary text-white border-primary shadow-lg shadow-primary/20":"bg-white/5 border-transparent text-slate-500 hover:bg-white/10 hover:text-white"}
                                                    `,children:[f.jsx("span",{className:"material-symbols-outlined",children:Z.icon}),f.jsx("span",{className:"text-[10px] font-bold uppercase",children:Z.label})]},Z.id))})]})]}):f.jsx("div",{className:"h-full p-4 overflow-hidden",children:f.jsx(TT,{projectName:e})}):h==="MAP"?f.jsxs("div",{className:"p-6 space-y-8 animate-in fade-in slide-in-from-right-4",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Grid System"}),f.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[f.jsx("input",{type:"checkbox",checked:T.showGrid,onChange:Z=>{const le={...T,showGrid:Z.target.checked};j(le),M&&M(le)},className:"sr-only peer"}),f.jsx("div",{className:"w-9 h-5 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-primary"})]})]}),f.jsxs("div",{className:`space-y-2 transition-opacity ${T.showGrid?"opacity-100":"opacity-30 pointer-events-none"}`,children:[f.jsxs("div",{className:"flex justify-between text-xs font-bold text-white",children:[f.jsx("span",{children:"Size"}),f.jsxs("span",{className:"font-mono text-primary",children:[T.gridSize,"px"]})]}),f.jsx("input",{type:"range",min:"10",max:"200",step:"10",value:T.gridSize,onChange:Z=>{const le={...T,gridSize:parseInt(Z.target.value)};j(le),M&&M(le)},className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-primary"})]})]}),f.jsx("div",{className:"h-px bg-glass-border"}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Canvas Data"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Width (px)"}),f.jsx("input",{type:"number",value:T.width,onChange:Z=>{const le={...T,width:parseInt(Z.target.value)};j(le),M&&M(le)},className:"w-full bg-black/20 border border-white/10 rounded-lg p-2 text-white text-right font-mono text-sm focus:border-primary outline-none"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Height (px)"}),f.jsx("input",{type:"number",value:T.height,onChange:Z=>{const le={...T,height:parseInt(Z.target.value)};j(le),M&&M(le)},className:"w-full bg-black/20 border border-white/10 rounded-lg p-2 text-white text-right font-mono text-sm focus:border-primary outline-none"})]})]})]})]}):h==="ENTITY"?f.jsxs("div",{className:"flex flex-col h-full animate-in fade-in slide-in-from-right-4",children:[f.jsx("div",{className:"p-4 border-b border-glass-border",children:f.jsx("div",{className:"bg-black/40 p-1 rounded-xl flex",children:G.map(Z=>{const le=ge=>{switch(ge.toLowerCase()){case"identity":return"badge";case"narrative":return"auto_stories";case"attributes":return"tune";case"notes":return"edit_note";default:return"circle"}};return f.jsxs("button",{onClick:()=>se(Z),className:`
                                                        flex-1 py-2 rounded-lg transition-all group relative flex items-center justify-center
                                                        ${re===Z?"bg-primary text-white shadow-lg":"text-text-muted hover:text-white hover:bg-white/5"}
                                                    `,title:Z,children:[f.jsx("span",{className:"material-symbols-outlined text-lg",children:le(Z)}),f.jsx("span",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2 bg-black/90 text-white text-[10px] uppercase font-bold px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50",children:Z})]},Z)})})}),re==="attributes"&&f.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col bg-black/20",children:[f.jsxs("div",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500 tracking-widest flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"drag_indicator"})," Drag Attributes"]}),f.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-2",children:f.jsx(ET,{compact:!0,initialFolderSlug:r})})]})]}):h==="TOOLBOX"?f.jsx("div",{className:"p-4 space-y-6",children:f.jsxs("div",{className:"space-y-3",children:[f.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted px-2 flex justify-between items-center",children:[f.jsx("span",{children:"Plantillas Disponibles"}),f.jsx("button",{className:"text-primary hover:text-white transition-colors",title:"Crear Nueva Plantilla",onClick:()=>k&&k(),children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})]}),y.length===0?f.jsx("div",{className:"p-6 text-center border border-dashed border-glass-border rounded-2xl opacity-30",children:f.jsx("p",{className:"text-[10px] uppercase font-bold",children:"Sin Plantillas"})}):y.map(Z=>f.jsxs("button",{className:"w-full flex items-center gap-3 p-3 rounded-2xl bg-white/5 border border-glass-border hover:border-primary/50 hover:bg-primary/5 transition-all text-left group relative",draggable:!0,onDragStart:le=>{le.dataTransfer.setData("application/reactflow/type","attribute"),le.dataTransfer.setData("templateId",Z.id),le.dataTransfer.effectAllowed="move"},onClick:()=>S&&S(Z.id),children:[Z.global&&f.jsx("span",{className:"absolute top-2 right-2 flex size-2 bg-blue-500 rounded-full shadow-lg shadow-blue-500/50",title:"Global"}),f.jsx("div",{className:"size-8 rounded-lg bg-surface-light flex items-center justify-center text-primary group-hover:scale-110 transition-transform",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:jT(Z.tipo)})}),f.jsxs("div",{className:"overflow-hidden",children:[f.jsx("p",{className:"text-xs font-bold text-white truncate",children:Z.nombre}),f.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-tighter",children:Z.tipo})]}),f.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[f.jsx("div",{onClick:le=>{le.stopPropagation(),L(Z)},className:"p-1 hover:text-white text-text-muted hover:bg-white/10 rounded cursor-pointer",title:"Edit",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),f.jsx("div",{onClick:le=>ne(le,Z.id),className:"p-1 hover:text-red-400 text-text-muted hover:bg-white/10 rounded cursor-pointer",title:"Delete",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]},Z.id))]})}):f.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted opacity-50",children:[f.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"dashboard"}),f.jsx("p",{className:"text-xs uppercase font-bold tracking-widest",children:"Select an item"})]}):f.jsx("div",{className:"flex flex-col items-center gap-4 py-4",children:h==="NOTES"?f.jsx("button",{className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted",title:"Notes",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"edit_note"})}):y.slice(0,5).map(Z=>f.jsxs("button",{className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white hover:bg-primary/20 transition-all relative",draggable:!0,onDragStart:le=>{le.dataTransfer.setData("application/reactflow/type","attribute"),le.dataTransfer.setData("templateId",Z.id)},children:[Z.global&&f.jsx("span",{className:"absolute top-0 right-0 size-2 bg-blue-500 rounded-full border border-surface-dark"}),f.jsx("span",{className:"material-symbols-outlined text-lg",children:jT(Z.tipo)})]},Z.id))})})]}),Y&&f.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-surface-dark border border-glass-border rounded-2xl p-6 w-full max-w-md shadow-2xl animate-scale-in",children:[f.jsx("h3",{className:"text-xl font-black text-white mb-4",children:"Editar Plantilla"}),f.jsxs("form",{onSubmit:$,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs uppercase font-bold text-text-muted block mb-1",children:"Nombre"}),f.jsx("input",{autoFocus:!0,className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none",value:Y.nombre,onChange:Z=>L({...Y,nombre:Z.target.value}),required:!0})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs uppercase font-bold text-text-muted block mb-1",children:"Tipo"}),f.jsxs("select",{className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none",value:Y.tipo,onChange:Z=>L({...Y,tipo:Z.target.value}),children:[f.jsx("option",{value:"text",children:"Texto Largo"}),f.jsx("option",{value:"short_text",children:"Texto Corto"}),f.jsx("option",{value:"number",children:"Nmero"}),f.jsx("option",{value:"boolean",children:"Si/No"}),f.jsx("option",{value:"date",children:"Fecha"}),f.jsx("option",{value:"entity_link",children:"Vnculo Entidad"}),f.jsx("option",{value:"image",children:"Imagen URL"})]})]}),f.jsx("div",{className:"flex items-center",children:f.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-3 bg-white/5 rounded-xl w-full hover:bg-white/10 transition-colors",children:[f.jsx("input",{type:"checkbox",checked:Y.global,onChange:Z=>L({...Y,global:Z.target.checked}),className:"accent-primary size-4"}),f.jsx("span",{className:"text-sm font-bold text-white",children:"Es Global?"})]})})]}),f.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[f.jsx("button",{type:"button",onClick:()=>L(null),className:"px-4 py-2 text-text-muted hover:text-white font-bold transition-colors",children:"Cancelar"}),f.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded-xl font-bold shadow-lg shadow-primary/20 hover:scale-105 transition-transform",children:"Guardar"})]})]})]})}),f.jsx(Xp,{isOpen:!!de,onClose:()=>W(null),onConfirm:ie,title:"Eliminar Plantilla",message:"Ests seguro de que quieres eliminar esta plantilla? Esta accin no se puede deshacer.",confirmText:"Eliminar",type:"danger"})]})};var TA={exports:{}},b$="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",w$=b$,S$=w$;function jA(){}function MA(){}MA.resetWarningCache=jA;var k$=function(){function t(n,i,a,s,o,l){if(l!==S$){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:MA,resetWarningCache:jA};return r.PropTypes=r,r};TA.exports=k$();var C$=TA.exports;const N$=Up(C$);function I5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function E$(t){if(Array.isArray(t))return t}function T$(t){if(Array.isArray(t))return I5(t)}function Ml(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_A(n.key),n)}}function Pl(t,e,r){return e&&j$(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function vi(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=qC(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,o=!1;return{s:function(){r=r.call(t)},n:function(){var l=r.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{s||r.return==null||r.return()}finally{if(o)throw a}}}}function PA(t,e,r){return(e=_A(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M$(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function P$(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}function _$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zr(t,e){return E$(t)||P$(t,e)||qC(t,e)||_$()}function b0(t){return T$(t)||M$(t)||qC(t)||A$()}function R$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function _A(t){var e=R$(t,"string");return typeof e=="symbol"?e:e+""}function Zr(t){"@babel/helpers - typeof";return Zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(t)}function qC(t,e){if(t){if(typeof t=="string")return I5(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I5(t,e):void 0}}var Yr=typeof window>"u"?null:window,MT=Yr?Yr.navigator:null;Yr&&Yr.document;var D$=Zr(""),AA=Zr({}),O$=Zr(function(){}),I$=typeof HTMLElement>"u"?"undefined":Zr(HTMLElement),Qp=function(e){return e&&e.instanceString&&vr(e.instanceString)?e.instanceString():null},Ke=function(e){return e!=null&&Zr(e)==D$},vr=function(e){return e!=null&&Zr(e)===O$},Ht=function(e){return!Ai(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},Mt=function(e){return e!=null&&Zr(e)===AA&&!Ht(e)&&e.constructor===Object},L$=function(e){return e!=null&&Zr(e)===AA},Ee=function(e){return e!=null&&Zr(e)===Zr(1)&&!isNaN(e)},B$=function(e){return Ee(e)&&Math.floor(e)===e},w0=function(e){if(I$!=="undefined")return e!=null&&e instanceof HTMLElement},Ai=function(e){return Jp(e)||RA(e)},Jp=function(e){return Qp(e)==="collection"&&e._private.single},RA=function(e){return Qp(e)==="collection"&&!e._private.single},KC=function(e){return Qp(e)==="core"},DA=function(e){return Qp(e)==="stylesheet"},F$=function(e){return Qp(e)==="event"},ml=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},z$=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},V$=function(e){return Mt(e)&&Ee(e.x1)&&Ee(e.x2)&&Ee(e.y1)&&Ee(e.y2)},$$=function(e){return L$(e)&&vr(e.then)},U$=function(){return MT&&MT.userAgent.match(/msie|trident|edge/i)},Rd=function(e,r){r||(r=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var a=[],s=0;s<arguments.length;s++)a.push(arguments[s]);return a.join("$")});var n=function(){var a=this,s=arguments,o,l=r.apply(a,s),u=n.cache;return(o=u[l])||(o=u[l]=e.apply(a,s)),o};return n.cache={},n},YC=Rd(function(t){return t.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),Xy=Rd(function(t){return t.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),OA=Rd(function(t,e){return t+e[0].toUpperCase()+e.substring(1)},function(t,e){return t+"$"+e}),PT=function(e){return ml(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},Wo=function(e,r){return e.slice(-1*r.length)===r},Jr="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",G$="rgb[a]?\\(("+Jr+"[%]?)\\s*,\\s*("+Jr+"[%]?)\\s*,\\s*("+Jr+"[%]?)(?:\\s*,\\s*("+Jr+"))?\\)",H$="rgb[a]?\\((?:"+Jr+"[%]?)\\s*,\\s*(?:"+Jr+"[%]?)\\s*,\\s*(?:"+Jr+"[%]?)(?:\\s*,\\s*(?:"+Jr+"))?\\)",W$="hsl[a]?\\(("+Jr+")\\s*,\\s*("+Jr+"[%])\\s*,\\s*("+Jr+"[%])(?:\\s*,\\s*("+Jr+"))?\\)",q$="hsl[a]?\\((?:"+Jr+")\\s*,\\s*(?:"+Jr+"[%])\\s*,\\s*(?:"+Jr+"[%])(?:\\s*,\\s*(?:"+Jr+"))?\\)",K$="\\#[0-9a-fA-F]{3}",Y$="\\#[0-9a-fA-F]{6}",IA=function(e,r){return e<r?-1:e>r?1:0},X$=function(e,r){return-1*IA(e,r)},Qe=Object.assign!=null?Object.assign.bind(Object):function(t){for(var e=arguments,r=1;r<e.length;r++){var n=e[r];if(n!=null)for(var i=Object.keys(n),a=0;a<i.length;a++){var s=i[a];t[s]=n[s]}}return t},Q$=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var r=e.length===4,n,i,a,s=16;return r?(n=parseInt(e[1]+e[1],s),i=parseInt(e[2]+e[2],s),a=parseInt(e[3]+e[3],s)):(n=parseInt(e[1]+e[2],s),i=parseInt(e[3]+e[4],s),a=parseInt(e[5]+e[6],s)),[n,i,a]}},J$=function(e){var r,n,i,a,s,o,l,u;function c(v,x,y){return y<0&&(y+=1),y>1&&(y-=1),y<1/6?v+(x-v)*6*y:y<1/2?x:y<2/3?v+(x-v)*(2/3-y)*6:v}var d=new RegExp("^"+W$+"$").exec(e);if(d){if(n=parseInt(d[1]),n<0?n=(360- -1*n%360)%360:n>360&&(n=n%360),n/=360,i=parseFloat(d[2]),i<0||i>100||(i=i/100,a=parseFloat(d[3]),a<0||a>100)||(a=a/100,s=d[4],s!==void 0&&(s=parseFloat(s),s<0||s>1)))return;if(i===0)o=l=u=Math.round(a*255);else{var h=a<.5?a*(1+i):a+i-a*i,m=2*a-h;o=Math.round(255*c(m,h,n+1/3)),l=Math.round(255*c(m,h,n)),u=Math.round(255*c(m,h,n-1/3))}r=[o,l,u,s]}return r},Z$=function(e){var r,n=new RegExp("^"+G$+"$").exec(e);if(n){r=[];for(var i=[],a=1;a<=3;a++){var s=n[a];if(s[s.length-1]==="%"&&(i[a]=!0),s=parseFloat(s),i[a]&&(s=s/100*255),s<0||s>255)return;r.push(Math.floor(s))}var o=i[1]||i[2]||i[3],l=i[1]&&i[2]&&i[3];if(o&&!l)return;var u=n[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;r.push(u)}}return r},eU=function(e){return tU[e.toLowerCase()]},LA=function(e){return(Ht(e)?e:null)||eU(e)||Q$(e)||Z$(e)||J$(e)},tU={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},BA=function(e){for(var r=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var s=n[a];if(Mt(s))throw Error("Tried to set map with object key");a<n.length-1?(r[s]==null&&(r[s]={}),r=r[s]):r[s]=e.value}},FA=function(e){for(var r=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var s=n[a];if(Mt(s))throw Error("Tried to get map with object key");if(r=r[s],r==null)return r}return r},Pg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fw,_T;function em(){if(_T)return fw;_T=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return fw=t,fw}var hw,AT;function rU(){if(AT)return hw;AT=1;var t=typeof Pg=="object"&&Pg&&Pg.Object===Object&&Pg;return hw=t,hw}var pw,RT;function Qy(){if(RT)return pw;RT=1;var t=rU(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return pw=r,pw}var mw,DT;function nU(){if(DT)return mw;DT=1;var t=Qy(),e=function(){return t.Date.now()};return mw=e,mw}var gw,OT;function iU(){if(OT)return gw;OT=1;var t=/\s/;function e(r){for(var n=r.length;n--&&t.test(r.charAt(n)););return n}return gw=e,gw}var vw,IT;function aU(){if(IT)return vw;IT=1;var t=iU(),e=/^\s+/;function r(n){return n&&n.slice(0,t(n)+1).replace(e,"")}return vw=r,vw}var yw,LT;function XC(){if(LT)return yw;LT=1;var t=Qy(),e=t.Symbol;return yw=e,yw}var xw,BT;function sU(){if(BT)return xw;BT=1;var t=XC(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function a(s){var o=r.call(s,i),l=s[i];try{s[i]=void 0;var u=!0}catch{}var c=n.call(s);return u&&(o?s[i]=l:delete s[i]),c}return xw=a,xw}var bw,FT;function oU(){if(FT)return bw;FT=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return bw=r,bw}var ww,zT;function zA(){if(zT)return ww;zT=1;var t=XC(),e=sU(),r=oU(),n="[object Null]",i="[object Undefined]",a=t?t.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):r(o)}return ww=s,ww}var Sw,VT;function lU(){if(VT)return Sw;VT=1;function t(e){return e!=null&&typeof e=="object"}return Sw=t,Sw}var kw,$T;function tm(){if($T)return kw;$T=1;var t=zA(),e=lU(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return kw=n,kw}var Cw,UT;function uU(){if(UT)return Cw;UT=1;var t=aU(),e=em(),r=tm(),n=0/0,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(u){if(typeof u=="number")return u;if(r(u))return n;if(e(u)){var c=typeof u.valueOf=="function"?u.valueOf():u;u=e(c)?c+"":c}if(typeof u!="string")return u===0?u:+u;u=t(u);var d=a.test(u);return d||s.test(u)?o(u.slice(2),d?2:8):i.test(u)?n:+u}return Cw=l,Cw}var Nw,GT;function cU(){if(GT)return Nw;GT=1;var t=em(),e=nU(),r=uU(),n="Expected a function",i=Math.max,a=Math.min;function s(o,l,u){var c,d,h,m,v,x,y=0,b=!1,S=!1,w=!0;if(typeof o!="function")throw new TypeError(n);l=r(l)||0,t(u)&&(b=!!u.leading,S="maxWait"in u,h=S?i(r(u.maxWait)||0,l):h,w="trailing"in u?!!u.trailing:w);function k(I){var U=c,B=d;return c=d=void 0,y=I,m=o.apply(B,U),m}function N(I){return y=I,v=setTimeout(M,l),b?k(I):m}function T(I){var U=I-x,B=I-y,z=l-U;return S?a(z,h-B):z}function j(I){var U=I-x,B=I-y;return x===void 0||U>=l||U<0||S&&B>=h}function M(){var I=e();if(j(I))return A(I);v=setTimeout(M,T(I))}function A(I){return v=void 0,w&&c?k(I):(c=d=void 0,m)}function P(){v!==void 0&&clearTimeout(v),y=0,c=x=d=v=void 0}function D(){return v===void 0?m:A(e())}function R(){var I=e(),U=j(I);if(c=arguments,d=this,x=I,U){if(v===void 0)return N(x);if(S)return clearTimeout(v),v=setTimeout(M,l),k(x)}return v===void 0&&(v=setTimeout(M,l)),m}return R.cancel=P,R.flush=D,R}return Nw=s,Nw}var dU=cU(),rm=Zp(dU),Ew=Yr?Yr.performance:null,VA=Ew&&Ew.now?function(){return Ew.now()}:function(){return Date.now()},fU=function(){if(Yr){if(Yr.requestAnimationFrame)return function(t){Yr.requestAnimationFrame(t)};if(Yr.mozRequestAnimationFrame)return function(t){Yr.mozRequestAnimationFrame(t)};if(Yr.webkitRequestAnimationFrame)return function(t){Yr.webkitRequestAnimationFrame(t)};if(Yr.msRequestAnimationFrame)return function(t){Yr.msRequestAnimationFrame(t)}}return function(t){t&&setTimeout(function(){t(VA())},1e3/60)}}(),S0=function(e){return fU(e)},eo=VA,fu=9261,$A=65599,$c=5381,UA=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fu,n=r,i;i=e.next(),!i.done;)n=n*$A+i.value|0;return n},vp=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fu;return r*$A+e|0},yp=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$c;return(r<<5)+r+e|0},hU=function(e,r){return e*2097152+r},To=function(e){return e[0]*2097152+e[1]},_g=function(e,r){return[vp(e[0],r[0]),yp(e[1],r[1])]},HT=function(e,r){var n={value:0,done:!1},i=0,a=e.length,s={next:function(){return i<a?n.value=e[i++]:n.done=!0,n}};return UA(s,r)},Bu=function(e,r){var n={value:0,done:!1},i=0,a=e.length,s={next:function(){return i<a?n.value=e.charCodeAt(i++):n.done=!0,n}};return UA(s,r)},GA=function(){return pU(arguments)},pU=function(e){for(var r,n=0;n<e.length;n++){var i=e[n];n===0?r=Bu(i):r=Bu(i,r)}return r};function mU(t,e,r,n,i){var a=i*Math.PI/180,s=Math.cos(a)*(t-r)-Math.sin(a)*(e-n)+r,o=Math.sin(a)*(t-r)+Math.cos(a)*(e-n)+n;return{x:s,y:o}}var gU=function(e,r,n,i,a,s){return{x:(e-n)*a+n,y:(r-i)*s+i}};function vU(t,e,r){if(r===0)return t;var n=(e.x1+e.x2)/2,i=(e.y1+e.y2)/2,a=e.w/e.h,s=1/a,o=mU(t.x,t.y,n,i,r),l=gU(o.x,o.y,n,i,a,s);return{x:l.x,y:l.y}}var WT=!0,yU=console.warn!=null,xU=console.trace!=null,QC=Number.MAX_SAFE_INTEGER||9007199254740991,HA=function(){return!0},k0=function(){return!1},qT=function(){return 0},JC=function(){},lr=function(e){throw new Error(e)},WA=function(e){if(e!==void 0)WT=!!e;else return WT},Lt=function(e){WA()&&(yU?console.warn(e):(console.log(e),xU&&console.trace()))},bU=function(e){return Qe({},e)},ss=function(e){return e==null?e:Ht(e)?e.slice():Mt(e)?bU(e):e},wU=function(e){return e.slice()},qA=function(e,r){for(r=e="";e++<36;r+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return r},SU={},KA=function(){return SU},Pn=function(e){var r=Object.keys(e);return function(n){for(var i={},a=0;a<r.length;a++){var s=r[a],o=n==null?void 0:n[s];i[s]=o===void 0?e[s]:o}return i}},gl=function(e,r,n){for(var i=e.length-1;i>=0;i--)e[i]===r&&e.splice(i,1)},ZC=function(e){e.splice(0,e.length)},kU=function(e,r){for(var n=0;n<r.length;n++){var i=r[n];e.push(i)}},hi=function(e,r,n){return n&&(r=OA(n,r)),e[r]},zs=function(e,r,n,i){n&&(r=OA(n,r)),e[r]=i},CU=function(){function t(){Ml(this,t),this._obj={}}return Pl(t,[{key:"set",value:function(r,n){return this._obj[r]=n,this}},{key:"delete",value:function(r){return this._obj[r]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(r){return this._obj[r]!==void 0}},{key:"get",value:function(r){return this._obj[r]}}])}(),Us=typeof Map<"u"?Map:CU,NU="undefined",EU=function(){function t(e){if(Ml(this,t),this._obj=Object.create(null),this.size=0,e!=null){var r;e.instanceString!=null&&e.instanceString()===this.instanceString()?r=e.toArray():r=e;for(var n=0;n<r.length;n++)this.add(r[n])}}return Pl(t,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(r){var n=this._obj;n[r]!==1&&(n[r]=1,this.size++)}},{key:"delete",value:function(r){var n=this._obj;n[r]===1&&(n[r]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(r){return this._obj[r]===1}},{key:"toArray",value:function(){var r=this;return Object.keys(this._obj).filter(function(n){return r.has(n)})}},{key:"forEach",value:function(r,n){return this.toArray().forEach(r,n)}}])}(),rf=(typeof Set>"u"?"undefined":Zr(Set))!==NU?Set:EU,Jy=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||r===void 0||!KC(e)){lr("An element must have a core reference and parameters set");return}var i=r.group;if(i==null&&(r.data&&r.data.source!=null&&r.data.target!=null?i="edges":i="nodes"),i!=="nodes"&&i!=="edges"){lr("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1,this[0]=this;var a=this._private={cy:e,single:!0,data:r.data||{},position:r.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!r.selected,selectable:r.selectable===void 0?!0:!!r.selectable,locked:!!r.locked,grabbed:!1,grabbable:r.grabbable===void 0?!0:!!r.grabbable,pannable:r.pannable===void 0?i==="edges":!!r.pannable,active:!1,classes:new rf,animation:{current:[],queue:[]},rscratch:{},scratch:r.scratch||{},edges:[],children:[],parent:r.parent&&r.parent.isNode()?r.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(a.position.x==null&&(a.position.x=0),a.position.y==null&&(a.position.y=0),r.renderedPosition){var s=r.renderedPosition,o=e.pan(),l=e.zoom();a.position={x:(s.x-o.x)/l,y:(s.y-o.y)/l}}var u=[];Ht(r.classes)?u=r.classes:Ke(r.classes)&&(u=r.classes.split(/\s+/));for(var c=0,d=u.length;c<d;c++){var h=u[c];!h||h===""||a.classes.add(h)}this.createEmitter(),(n===void 0||n)&&this.restore();var m=r.style||r.css;m&&(Lt("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(m))},KT=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(n,i,a){var s;Mt(n)&&!Ai(n)&&(s=n,n=s.roots||s.root,i=s.visit,a=s.directed),a=arguments.length===2&&!vr(i)?i:a,i=vr(i)?i:function(){};for(var o=this._private.cy,l=n=Ke(n)?this.filter(n):n,u=[],c=[],d={},h={},m={},v=0,x,y=this.byGroup(),b=y.nodes,S=y.edges,w=0;w<l.length;w++){var k=l[w],N=k.id();k.isNode()&&(u.unshift(k),e.bfs&&(m[N]=!0,c.push(k)),h[N]=0)}for(var T=function(){var I=e.bfs?u.shift():u.pop(),U=I.id();if(e.dfs){if(m[U])return 0;m[U]=!0,c.push(I)}var B=h[U],z=d[U],F=z!=null?z.source():null,V=z!=null?z.target():null,J=z==null?void 0:I.same(F)?V[0]:F[0],Y;if(Y=i(I,z,J,v++,B),Y===!0)return x=I,1;if(Y===!1)return 1;for(var L=I.connectedEdges().filter(function(de){return(!a||de.source().same(I))&&S.has(de)}),G=0;G<L.length;G++){var ee=L[G],re=ee.connectedNodes().filter(function(de){return!de.same(I)&&b.has(de)}),se=re.id();re.length!==0&&!m[se]&&(re=re[0],u.push(re),e.bfs&&(m[se]=!0,c.push(re)),d[se]=ee,h[se]=h[U]+1)}},j;u.length!==0&&(j=T(),!(j!==0&&j===1)););for(var M=o.collection(),A=0;A<c.length;A++){var P=c[A],D=d[P.id()];D!=null&&M.push(D),M.push(P)}return{path:o.collection(M),found:o.collection(x)}}},xp={breadthFirstSearch:KT({bfs:!0}),depthFirstSearch:KT({dfs:!0})};xp.bfs=xp.breadthFirstSearch;xp.dfs=xp.depthFirstSearch;var Ev={exports:{}},TU=Ev.exports,YT;function jU(){return YT||(YT=1,function(t,e){(function(){var r,n,i,a,s,o,l,u,c,d,h,m,v,x,y;i=Math.floor,d=Math.min,n=function(b,S){return b<S?-1:b>S?1:0},c=function(b,S,w,k,N){var T;if(w==null&&(w=0),N==null&&(N=n),w<0)throw new Error("lo must be non-negative");for(k==null&&(k=b.length);w<k;)T=i((w+k)/2),N(S,b[T])<0?k=T:w=T+1;return[].splice.apply(b,[w,w-w].concat(S)),S},o=function(b,S,w){return w==null&&(w=n),b.push(S),x(b,0,b.length-1,w)},s=function(b,S){var w,k;return S==null&&(S=n),w=b.pop(),b.length?(k=b[0],b[0]=w,y(b,0,S)):k=w,k},u=function(b,S,w){var k;return w==null&&(w=n),k=b[0],b[0]=S,y(b,0,w),k},l=function(b,S,w){var k;return w==null&&(w=n),b.length&&w(b[0],S)<0&&(k=[b[0],S],S=k[0],b[0]=k[1],y(b,0,w)),S},a=function(b,S){var w,k,N,T,j,M;for(S==null&&(S=n),T=(function(){M=[];for(var A=0,P=i(b.length/2);0<=P?A<P:A>P;0<=P?A++:A--)M.push(A);return M}).apply(this).reverse(),j=[],k=0,N=T.length;k<N;k++)w=T[k],j.push(y(b,w,S));return j},v=function(b,S,w){var k;if(w==null&&(w=n),k=b.indexOf(S),k!==-1)return x(b,0,k,w),y(b,k,w)},h=function(b,S,w){var k,N,T,j,M;if(w==null&&(w=n),N=b.slice(0,S),!N.length)return N;for(a(N,w),M=b.slice(S),T=0,j=M.length;T<j;T++)k=M[T],l(N,k,w);return N.sort(w).reverse()},m=function(b,S,w){var k,N,T,j,M,A,P,D,R;if(w==null&&(w=n),S*10<=b.length){if(T=b.slice(0,S).sort(w),!T.length)return T;for(N=T[T.length-1],P=b.slice(S),j=0,A=P.length;j<A;j++)k=P[j],w(k,N)<0&&(c(T,k,0,null,w),T.pop(),N=T[T.length-1]);return T}for(a(b,w),R=[],M=0,D=d(S,b.length);0<=D?M<D:M>D;0<=D?++M:--M)R.push(s(b,w));return R},x=function(b,S,w,k){var N,T,j;for(k==null&&(k=n),N=b[w];w>S;){if(j=w-1>>1,T=b[j],k(N,T)<0){b[w]=T,w=j;continue}break}return b[w]=N},y=function(b,S,w){var k,N,T,j,M;for(w==null&&(w=n),N=b.length,M=S,T=b[S],k=2*S+1;k<N;)j=k+1,j<N&&!(w(b[k],b[j])<0)&&(k=j),b[S]=b[k],S=k,k=2*S+1;return b[S]=T,x(b,M,S,w)},r=function(){b.push=o,b.pop=s,b.replace=u,b.pushpop=l,b.heapify=a,b.updateItem=v,b.nlargest=h,b.nsmallest=m;function b(S){this.cmp=S??n,this.nodes=[]}return b.prototype.push=function(S){return o(this.nodes,S,this.cmp)},b.prototype.pop=function(){return s(this.nodes,this.cmp)},b.prototype.peek=function(){return this.nodes[0]},b.prototype.contains=function(S){return this.nodes.indexOf(S)!==-1},b.prototype.replace=function(S){return u(this.nodes,S,this.cmp)},b.prototype.pushpop=function(S){return l(this.nodes,S,this.cmp)},b.prototype.heapify=function(){return a(this.nodes,this.cmp)},b.prototype.updateItem=function(S){return v(this.nodes,S,this.cmp)},b.prototype.clear=function(){return this.nodes=[]},b.prototype.empty=function(){return this.nodes.length===0},b.prototype.size=function(){return this.nodes.length},b.prototype.clone=function(){var S;return S=new b,S.nodes=this.nodes.slice(0),S},b.prototype.toArray=function(){return this.nodes.slice(0)},b.prototype.insert=b.prototype.push,b.prototype.top=b.prototype.peek,b.prototype.front=b.prototype.peek,b.prototype.has=b.prototype.contains,b.prototype.copy=b.prototype.clone,b}(),function(b,S){return t.exports=S()}(this,function(){return r})}).call(TU)}(Ev)),Ev.exports}var Tw,XT;function MU(){return XT||(XT=1,Tw=jU()),Tw}var PU=MU(),nm=Zp(PU),_U=Pn({root:null,weight:function(e){return 1},directed:!1}),AU={dijkstra:function(e){if(!Mt(e)){var r=arguments;e={root:r[0],weight:r[1],directed:r[2]}}var n=_U(e),i=n.root,a=n.weight,s=n.directed,o=this,l=a,u=Ke(i)?this.filter(i)[0]:i[0],c={},d={},h={},m=this.byGroup(),v=m.nodes,x=m.edges;x.unmergeBy(function(B){return B.isLoop()});for(var y=function(z){return c[z.id()]},b=function(z,F){c[z.id()]=F,S.updateItem(z)},S=new nm(function(B,z){return y(B)-y(z)}),w=0;w<v.length;w++){var k=v[w];c[k.id()]=k.same(u)?0:1/0,S.push(k)}for(var N=function(z,F){for(var V=(s?z.edgesTo(F):z.edgesWith(F)).intersect(x),J=1/0,Y,L=0;L<V.length;L++){var G=V[L],ee=l(G);(ee<J||!Y)&&(J=ee,Y=G)}return{edge:Y,dist:J}};S.size()>0;){var T=S.pop(),j=y(T),M=T.id();if(h[M]=j,j!==1/0)for(var A=T.neighborhood().intersect(v),P=0;P<A.length;P++){var D=A[P],R=D.id(),I=N(T,D),U=j+I.dist;U<y(D)&&(b(D,U),d[R]={node:T,edge:I.edge})}}return{distanceTo:function(z){var F=Ke(z)?v.filter(z)[0]:z[0];return h[F.id()]},pathTo:function(z){var F=Ke(z)?v.filter(z)[0]:z[0],V=[],J=F,Y=J.id();if(F.length>0)for(V.unshift(F);d[Y];){var L=d[Y];V.unshift(L.edge),V.unshift(L.node),J=L.node,Y=J.id()}return o.spawn(V)}}}},RU={kruskal:function(e){e=e||function(w){return 1};for(var r=this.byGroup(),n=r.nodes,i=r.edges,a=n.length,s=new Array(a),o=n,l=function(k){for(var N=0;N<s.length;N++){var T=s[N];if(T.has(k))return N}},u=0;u<a;u++)s[u]=this.spawn(n[u]);for(var c=i.sort(function(w,k){return e(w)-e(k)}),d=0;d<c.length;d++){var h=c[d],m=h.source()[0],v=h.target()[0],x=l(m),y=l(v),b=s[x],S=s[y];x!==y&&(o.merge(h),b.merge(S),s.splice(y,1))}return o}},DU=Pn({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),OU={aStar:function(e){var r=this.cy(),n=DU(e),i=n.root,a=n.goal,s=n.heuristic,o=n.directed,l=n.weight;i=r.collection(i)[0],a=r.collection(a)[0];var u=i.id(),c=a.id(),d={},h={},m={},v=new nm(function(Y,L){return h[Y.id()]-h[L.id()]}),x=new rf,y={},b={},S=function(L,G){v.push(L),x.add(G)},w,k,N=function(){w=v.pop(),k=w.id(),x.delete(k)},T=function(L){return x.has(L)};S(i,u),d[u]=0,h[u]=s(i);for(var j=0;v.size()>0;){if(N(),j++,k===c){for(var M=[],A=a,P=c,D=b[P];M.unshift(A),D!=null&&M.unshift(D),A=y[P],A!=null;)P=A.id(),D=b[P];return{found:!0,distance:d[k],path:this.spawn(M),steps:j}}m[k]=!0;for(var R=w._private.edges,I=0;I<R.length;I++){var U=R[I];if(this.hasElementWithId(U.id())&&!(o&&U.data("source")!==k)){var B=U.source(),z=U.target(),F=B.id()!==k?B:z,V=F.id();if(this.hasElementWithId(V)&&!m[V]){var J=d[k]+l(U);if(!T(V)){d[V]=J,h[V]=J+s(F),S(F,V),y[V]=w,b[V]=U;continue}J<d[V]&&(d[V]=J,h[V]=J+s(F),y[V]=w,b[V]=U)}}}}return{found:!1,distance:void 0,path:void 0,steps:j}}},IU=Pn({weight:function(e){return 1},directed:!1}),LU={floydWarshall:function(e){for(var r=this.cy(),n=IU(e),i=n.weight,a=n.directed,s=i,o=this.byGroup(),l=o.nodes,u=o.edges,c=l.length,d=c*c,h=function(ee){return l.indexOf(ee)},m=function(ee){return l[ee]},v=new Array(d),x=0;x<d;x++){var y=x%c,b=(x-y)/c;b===y?v[x]=0:v[x]=1/0}for(var S=new Array(d),w=new Array(d),k=0;k<u.length;k++){var N=u[k],T=N.source()[0],j=N.target()[0];if(T!==j){var M=h(T),A=h(j),P=M*c+A,D=s(N);if(v[P]>D&&(v[P]=D,S[P]=A,w[P]=N),!a){var R=A*c+M;!a&&v[R]>D&&(v[R]=D,S[R]=M,w[R]=N)}}}for(var I=0;I<c;I++)for(var U=0;U<c;U++)for(var B=U*c+I,z=0;z<c;z++){var F=U*c+z,V=I*c+z;v[B]+v[V]<v[F]&&(v[F]=v[B]+v[V],S[F]=S[B])}var J=function(ee){return(Ke(ee)?r.filter(ee):ee)[0]},Y=function(ee){return h(J(ee))},L={distance:function(ee,re){var se=Y(ee),de=Y(re);return v[se*c+de]},path:function(ee,re){var se=Y(ee),de=Y(re),W=m(se);if(se===de)return W.collection();if(S[se*c+de]==null)return r.collection();var ne=r.collection(),ie=se,$;for(ne.merge(W);se!==de;)ie=se,se=S[se*c+de],$=w[ie*c+se],ne.merge($),ne.merge(m(se));return ne}};return L}},BU=Pn({weight:function(e){return 1},directed:!1,root:null}),FU={bellmanFord:function(e){var r=this,n=BU(e),i=n.weight,a=n.directed,s=n.root,o=i,l=this,u=this.cy(),c=this.byGroup(),d=c.edges,h=c.nodes,m=h.length,v=new Us,x=!1,y=[];s=u.collection(s)[0],d.unmergeBy(function(Te){return Te.isLoop()});for(var b=d.length,S=function(Re){var Ge=v.get(Re.id());return Ge||(Ge={},v.set(Re.id(),Ge)),Ge},w=function(Re){return(Ke(Re)?u.$(Re):Re)[0]},k=function(Re){return S(w(Re)).dist},N=function(Re){for(var Ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,Ce=w(Re),De=[],Ve=Ce;;){if(Ve==null)return r.spawn();var We=S(Ve),Ie=We.edge,rt=We.pred;if(De.unshift(Ve[0]),Ve.same(Ge)&&De.length>0)break;Ie!=null&&De.unshift(Ie),Ve=rt}return l.spawn(De)},T=0;T<m;T++){var j=h[T],M=S(j);j.same(s)?M.dist=0:M.dist=1/0,M.pred=null,M.edge=null}for(var A=!1,P=function(Re,Ge,Ce,De,Ve,We){var Ie=De.dist+We;Ie<Ve.dist&&!Ce.same(De.edge)&&(Ve.dist=Ie,Ve.pred=Re,Ve.edge=Ce,A=!0)},D=1;D<m;D++){A=!1;for(var R=0;R<b;R++){var I=d[R],U=I.source(),B=I.target(),z=o(I),F=S(U),V=S(B);P(U,B,I,F,V,z),a||P(B,U,I,V,F,z)}if(!A)break}if(A)for(var J=[],Y=0;Y<b;Y++){var L=d[Y],G=L.source(),ee=L.target(),re=o(L),se=S(G).dist,de=S(ee).dist;if(se+re<de||!a&&de+re<se)if(x||(Lt("Graph contains a negative weight cycle for Bellman-Ford"),x=!0),e.findNegativeWeightCycles!==!1){var W=[];se+re<de&&W.push(G),!a&&de+re<se&&W.push(ee);for(var ne=W.length,ie=0;ie<ne;ie++){var $=W[ie],q=[$];q.push(S($).edge);for(var te=S($).pred;q.indexOf(te)===-1;)q.push(te),q.push(S(te).edge),te=S(te).pred;q=q.slice(q.indexOf(te));for(var Z=q[0].id(),le=0,ge=2;ge<q.length;ge+=2)q[ge].id()<Z&&(Z=q[ge].id(),le=ge);q=q.slice(le).concat(q.slice(0,le)),q.push(q[0]);var Ue=q.map(function(Te){return Te.id()}).join(",");J.indexOf(Ue)===-1&&(y.push(l.spawn(q)),J.push(Ue))}}else break}return{distanceTo:k,pathTo:N,hasNegativeWeightCycle:x,negativeWeightCycles:y}}},zU=Math.sqrt(2),VU=function(e,r,n){n.length===0&&lr("Karger-Stein must be run on a connected (sub)graph");for(var i=n[e],a=i[1],s=i[2],o=r[a],l=r[s],u=n,c=u.length-1;c>=0;c--){var d=u[c],h=d[1],m=d[2];(r[h]===o&&r[m]===l||r[h]===l&&r[m]===o)&&u.splice(c,1)}for(var v=0;v<u.length;v++){var x=u[v];x[1]===l?(u[v]=x.slice(),u[v][1]=o):x[2]===l&&(u[v]=x.slice(),u[v][2]=o)}for(var y=0;y<r.length;y++)r[y]===l&&(r[y]=o);return u},jw=function(e,r,n,i){for(;n>i;){var a=Math.floor(Math.random()*r.length);r=VU(a,e,r),n--}return r},$U={kargerStein:function(){var e=this,r=this.byGroup(),n=r.nodes,i=r.edges;i.unmergeBy(function(V){return V.isLoop()});var a=n.length,s=i.length,o=Math.ceil(Math.pow(Math.log(a)/Math.LN2,2)),l=Math.floor(a/zU);if(a<2){lr("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],c=0;c<s;c++){var d=i[c];u.push([c,n.indexOf(d.source()),n.indexOf(d.target())])}for(var h=1/0,m=[],v=new Array(a),x=new Array(a),y=new Array(a),b=function(J,Y){for(var L=0;L<a;L++)Y[L]=J[L]},S=0;S<=o;S++){for(var w=0;w<a;w++)x[w]=w;var k=jw(x,u.slice(),a,l),N=k.slice();b(x,y);var T=jw(x,k,l,2),j=jw(y,N,l,2);T.length<=j.length&&T.length<h?(h=T.length,m=T,b(x,v)):j.length<=T.length&&j.length<h&&(h=j.length,m=j,b(y,v))}for(var M=this.spawn(m.map(function(V){return i[V[0]]})),A=this.spawn(),P=this.spawn(),D=v[0],R=0;R<v.length;R++){var I=v[R],U=n[R];I===D?A.merge(U):P.merge(U)}var B=function(J){var Y=e.spawn();return J.forEach(function(L){Y.merge(L),L.connectedEdges().forEach(function(G){e.contains(G)&&!M.contains(G)&&Y.merge(G)})}),Y},z=[B(A),B(P)],F={cut:M,components:z,partition1:A,partition2:P};return F}},Mw,UU=function(e){return{x:e.x,y:e.y}},Zy=function(e,r,n){return{x:e.x*r+n.x,y:e.y*r+n.y}},YA=function(e,r,n){return{x:(e.x-n.x)/r,y:(e.y-n.y)/r}},od=function(e){return{x:e[0],y:e[1]}},GU=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=1/0,a=r;a<n;a++){var s=e[a];isFinite(s)&&(i=Math.min(s,i))}return i},HU=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=-1/0,a=r;a<n;a++){var s=e[a];isFinite(s)&&(i=Math.max(s,i))}return i},WU=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=0,a=0,s=r;s<n;s++){var o=e[s];isFinite(o)&&(i+=o,a++)}return i/a},qU=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;i?e=e.slice(r,n):(n<e.length&&e.splice(n,e.length-n),r>0&&e.splice(0,r));for(var o=0,l=e.length-1;l>=0;l--){var u=e[l];s?isFinite(u)||(e[l]=-1/0,o++):e.splice(l,1)}a&&e.sort(function(h,m){return h-m});var c=e.length,d=Math.floor(c/2);return c%2!==0?e[d+1+o]:(e[d-1+o]+e[d+o])/2},KU=function(e){return Math.PI*e/180},Ag=function(e,r){return Math.atan2(r,e)-Math.PI/2},e3=Math.log2||function(t){return Math.log(t)/Math.log(2)},t3=function(e){return e>0?1:e<0?-1:0},Fu=function(e,r){return Math.sqrt(uu(e,r))},uu=function(e,r){var n=r.x-e.x,i=r.y-e.y;return n*n+i*i},YU=function(e){for(var r=e.length,n=0,i=0;i<r;i++)n+=e[i];for(var a=0;a<r;a++)e[a]=e[a]/n;return e},un=function(e,r,n,i){return(1-i)*(1-i)*e+2*(1-i)*i*r+i*i*n},yd=function(e,r,n,i){return{x:un(e.x,r.x,n.x,i),y:un(e.y,r.y,n.y,i)}},XU=function(e,r,n,i){var a={x:r.x-e.x,y:r.y-e.y},s=Fu(e,r),o={x:a.x/s,y:a.y/s};return n=n??0,i=i??n*s,{x:e.x+o.x*i,y:e.y+o.y*i}},bp=function(e,r,n){return Math.max(e,Math.min(n,r))},ei=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},QU=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},JU=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},ZU=function(e,r){e.x1=Math.min(e.x1,r.x1),e.x2=Math.max(e.x2,r.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,r.y1),e.y2=Math.max(e.y2,r.y2),e.h=e.y2-e.y1},XA=function(e,r,n){e.x1=Math.min(e.x1,r),e.x2=Math.max(e.x2,r),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},Tv=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=r,e.x2+=r,e.y1-=r,e.y2+=r,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},jv=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],n,i,a,s;if(r.length===1)n=i=a=s=r[0];else if(r.length===2)n=a=r[0],s=i=r[1];else if(r.length===4){var o=zr(r,4);n=o[0],i=o[1],a=o[2],s=o[3]}return e.x1-=s,e.x2+=i,e.y1-=n,e.y2+=a,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},QT=function(e,r){e.x1=r.x1,e.y1=r.y1,e.x2=r.x2,e.y2=r.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},r3=function(e,r){return!(e.x1>r.x2||r.x1>e.x2||e.x2<r.x1||r.x2<e.x1||e.y2<r.y1||r.y2<e.y1||e.y1>r.y2||r.y1>e.y2)},qo=function(e,r,n){return e.x1<=r&&r<=e.x2&&e.y1<=n&&n<=e.y2},JT=function(e,r){return qo(e,r.x,r.y)},QA=function(e,r){return qo(e,r.x1,r.y1)&&qo(e,r.x2,r.y2)},eG=(Mw=Math.hypot)!==null&&Mw!==void 0?Mw:function(t,e){return Math.sqrt(t*t+e*e)};function tG(t,e){if(t.length<3)throw new Error("Need at least 3 vertices");var r=function(M,A){return{x:M.x+A.x,y:M.y+A.y}},n=function(M,A){return{x:M.x-A.x,y:M.y-A.y}},i=function(M,A){return{x:M.x*A,y:M.y*A}},a=function(M,A){return M.x*A.y-M.y*A.x},s=function(M){var A=eG(M.x,M.y);return A===0?{x:0,y:0}:{x:M.x/A,y:M.y/A}},o=function(M){for(var A=0,P=0;P<M.length;P++){var D=M[P],R=M[(P+1)%M.length];A+=D.x*R.y-R.x*D.y}return A/2},l=function(M,A,P,D){var R=n(A,M),I=n(D,P),U=a(R,I);if(Math.abs(U)<1e-9)return r(M,i(R,.5));var B=a(n(P,M),I)/U;return r(M,i(R,B))},u=t.map(function(j){return{x:j.x,y:j.y}});o(u)<0&&u.reverse();for(var c=u.length,d=[],h=0;h<c;h++){var m=u[h],v=u[(h+1)%c],x=n(v,m),y=s({x:x.y,y:-x.x});d.push(y)}for(var b=d.map(function(j,M){var A=r(u[M],i(j,e)),P=r(u[(M+1)%c],i(j,e));return{p1:A,p2:P}}),S=[],w=0;w<c;w++){var k=b[(w-1+c)%c],N=b[w],T=l(k.p1,k.p2,N.p1,N.p2);S.push(T)}return S}function rG(t,e,r,n,i,a){var s=dG(t,e,r,n,i),o=tG(s,a),l=ei();return o.forEach(function(u){return XA(l,u.x,u.y)}),l}var JA=function(e,r,n,i,a,s,o){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",u=l==="auto"?vl(a,s):l,c=a/2,d=s/2;u=Math.min(u,c,d);var h=u!==c,m=u!==d,v;if(h){var x=n-c+u-o,y=i-d-o,b=n+c-u+o,S=y;if(v=Ko(e,r,n,i,x,y,b,S,!1),v.length>0)return v}if(m){var w=n+c+o,k=i-d+u-o,N=w,T=i+d-u+o;if(v=Ko(e,r,n,i,w,k,N,T,!1),v.length>0)return v}if(h){var j=n-c+u-o,M=i+d+o,A=n+c-u+o,P=M;if(v=Ko(e,r,n,i,j,M,A,P,!1),v.length>0)return v}if(m){var D=n-c-o,R=i-d+u-o,I=D,U=i+d-u+o;if(v=Ko(e,r,n,i,D,R,I,U,!1),v.length>0)return v}var B;{var z=n-c+u,F=i-d+u;if(B=yh(e,r,n,i,z,F,u+o),B.length>0&&B[0]<=z&&B[1]<=F)return[B[0],B[1]]}{var V=n+c-u,J=i-d+u;if(B=yh(e,r,n,i,V,J,u+o),B.length>0&&B[0]>=V&&B[1]<=J)return[B[0],B[1]]}{var Y=n+c-u,L=i+d-u;if(B=yh(e,r,n,i,Y,L,u+o),B.length>0&&B[0]>=Y&&B[1]>=L)return[B[0],B[1]]}{var G=n-c+u,ee=i+d-u;if(B=yh(e,r,n,i,G,ee,u+o),B.length>0&&B[0]<=G&&B[1]>=ee)return[B[0],B[1]]}return[]},nG=function(e,r,n,i,a,s,o){var l=o,u=Math.min(n,a),c=Math.max(n,a),d=Math.min(i,s),h=Math.max(i,s);return u-l<=e&&e<=c+l&&d-l<=r&&r<=h+l},iG=function(e,r,n,i,a,s,o,l,u){var c={x1:Math.min(n,o,a)-u,x2:Math.max(n,o,a)+u,y1:Math.min(i,l,s)-u,y2:Math.max(i,l,s)+u};return!(e<c.x1||e>c.x2||r<c.y1||r>c.y2)},aG=function(e,r,n,i){n-=i;var a=r*r-4*e*n;if(a<0)return[];var s=Math.sqrt(a),o=2*e,l=(-r+s)/o,u=(-r-s)/o;return[l,u]},sG=function(e,r,n,i,a){var s=1e-5;e===0&&(e=s),r/=e,n/=e,i/=e;var o,l,u,c,d,h,m,v;if(l=(3*n-r*r)/9,u=-(27*i)+r*(9*n-2*(r*r)),u/=54,o=l*l*l+u*u,a[1]=0,m=r/3,o>0){d=u+Math.sqrt(o),d=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3),h=u-Math.sqrt(o),h=h<0?-Math.pow(-h,1/3):Math.pow(h,1/3),a[0]=-m+d+h,m+=(d+h)/2,a[4]=a[2]=-m,m=Math.sqrt(3)*(-h+d)/2,a[3]=m,a[5]=-m;return}if(a[5]=a[3]=0,o===0){v=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),a[0]=-m+2*v,a[4]=a[2]=-(v+m);return}l=-l,c=l*l*l,c=Math.acos(u/Math.sqrt(c)),v=2*Math.sqrt(l),a[0]=-m+v*Math.cos(c/3),a[2]=-m+v*Math.cos((c+2*Math.PI)/3),a[4]=-m+v*Math.cos((c+4*Math.PI)/3)},oG=function(e,r,n,i,a,s,o,l){var u=1*n*n-4*n*a+2*n*o+4*a*a-4*a*o+o*o+i*i-4*i*s+2*i*l+4*s*s-4*s*l+l*l,c=1*9*n*a-3*n*n-3*n*o-6*a*a+3*a*o+9*i*s-3*i*i-3*i*l-6*s*s+3*s*l,d=1*3*n*n-6*n*a+n*o-n*e+2*a*a+2*a*e-o*e+3*i*i-6*i*s+i*l-i*r+2*s*s+2*s*r-l*r,h=1*n*a-n*n+n*e-a*e+i*s-i*i+i*r-s*r,m=[];sG(u,c,d,h,m);for(var v=1e-7,x=[],y=0;y<6;y+=2)Math.abs(m[y+1])<v&&m[y]>=0&&m[y]<=1&&x.push(m[y]);x.push(1),x.push(0);for(var b=-1,S,w,k,N=0;N<x.length;N++)S=Math.pow(1-x[N],2)*n+2*(1-x[N])*x[N]*a+x[N]*x[N]*o,w=Math.pow(1-x[N],2)*i+2*(1-x[N])*x[N]*s+x[N]*x[N]*l,k=Math.pow(S-e,2)+Math.pow(w-r,2),b>=0?k<b&&(b=k):b=k;return b},lG=function(e,r,n,i,a,s){var o=[e-n,r-i],l=[a-n,s-i],u=l[0]*l[0]+l[1]*l[1],c=o[0]*o[0]+o[1]*o[1],d=o[0]*l[0]+o[1]*l[1],h=d*d/u;return d<0?c:h>u?(e-a)*(e-a)+(r-s)*(r-s):c-h},pi=function(e,r,n){for(var i,a,s,o,l,u=0,c=0;c<n.length/2;c++)if(i=n[c*2],a=n[c*2+1],c+1<n.length/2?(s=n[(c+1)*2],o=n[(c+1)*2+1]):(s=n[(c+1-n.length/2)*2],o=n[(c+1-n.length/2)*2+1]),!(i==e&&s==e))if(i>=e&&e>=s||i<=e&&e<=s)l=(e-i)/(s-i)*(o-a)+a,l>r&&u++;else continue;return u%2!==0},to=function(e,r,n,i,a,s,o,l,u){var c=new Array(n.length),d;l[0]!=null?(d=Math.atan(l[1]/l[0]),l[0]<0?d=d+Math.PI/2:d=-d-Math.PI/2):d=l;for(var h=Math.cos(-d),m=Math.sin(-d),v=0;v<c.length/2;v++)c[v*2]=s/2*(n[v*2]*h-n[v*2+1]*m),c[v*2+1]=o/2*(n[v*2+1]*h+n[v*2]*m),c[v*2]+=i,c[v*2+1]+=a;var x;if(u>0){var y=N0(c,-u);x=C0(y)}else x=c;return pi(e,r,x)},uG=function(e,r,n,i,a,s,o,l){for(var u=new Array(n.length*2),c=0;c<l.length;c++){var d=l[c];u[c*4+0]=d.startX,u[c*4+1]=d.startY,u[c*4+2]=d.stopX,u[c*4+3]=d.stopY;var h=Math.pow(d.cx-e,2)+Math.pow(d.cy-r,2);if(h<=Math.pow(d.radius,2))return!0}return pi(e,r,u)},C0=function(e){for(var r=new Array(e.length/2),n,i,a,s,o,l,u,c,d=0;d<e.length/4;d++){n=e[d*4],i=e[d*4+1],a=e[d*4+2],s=e[d*4+3],d<e.length/4-1?(o=e[(d+1)*4],l=e[(d+1)*4+1],u=e[(d+1)*4+2],c=e[(d+1)*4+3]):(o=e[0],l=e[1],u=e[2],c=e[3]);var h=Ko(n,i,a,s,o,l,u,c,!0);r[d*2]=h[0],r[d*2+1]=h[1]}return r},N0=function(e,r){for(var n=new Array(e.length*2),i,a,s,o,l=0;l<e.length/2;l++){i=e[l*2],a=e[l*2+1],l<e.length/2-1?(s=e[(l+1)*2],o=e[(l+1)*2+1]):(s=e[0],o=e[1]);var u=o-a,c=-(s-i),d=Math.sqrt(u*u+c*c),h=u/d,m=c/d;n[l*4]=i+h*r,n[l*4+1]=a+m*r,n[l*4+2]=s+h*r,n[l*4+3]=o+m*r}return n},cG=function(e,r,n,i,a,s){var o=n-e,l=i-r;o/=a,l/=s;var u=Math.sqrt(o*o+l*l),c=u-1;if(c<0)return[];var d=c/u;return[(n-e)*d+e,(i-r)*d+r]},yu=function(e,r,n,i,a,s,o){return e-=a,r-=s,e/=n/2+o,r/=i/2+o,e*e+r*r<=1},yh=function(e,r,n,i,a,s,o){var l=[n-e,i-r],u=[e-a,r-s],c=l[0]*l[0]+l[1]*l[1],d=2*(u[0]*l[0]+u[1]*l[1]),h=u[0]*u[0]+u[1]*u[1]-o*o,m=d*d-4*c*h;if(m<0)return[];var v=(-d+Math.sqrt(m))/(2*c),x=(-d-Math.sqrt(m))/(2*c),y=Math.min(v,x),b=Math.max(v,x),S=[];if(y>=0&&y<=1&&S.push(y),b>=0&&b<=1&&S.push(b),S.length===0)return[];var w=S[0]*l[0]+e,k=S[0]*l[1]+r;if(S.length>1){if(S[0]==S[1])return[w,k];var N=S[1]*l[0]+e,T=S[1]*l[1]+r;return[w,k,N,T]}else return[w,k]},Pw=function(e,r,n){return r<=e&&e<=n||n<=e&&e<=r?e:e<=r&&r<=n||n<=r&&r<=e?r:n},Ko=function(e,r,n,i,a,s,o,l,u){var c=e-a,d=n-e,h=o-a,m=r-s,v=i-r,x=l-s,y=h*m-x*c,b=d*m-v*c,S=x*d-h*v;if(S!==0){var w=y/S,k=b/S,N=.001,T=0-N,j=1+N;return T<=w&&w<=j&&T<=k&&k<=j?[e+w*d,r+w*v]:u?[e+w*d,r+w*v]:[]}else return y===0||b===0?Pw(e,n,o)===o?[o,l]:Pw(e,n,a)===a?[a,s]:Pw(a,o,n)===n?[n,i]:[]:[]},dG=function(e,r,n,i,a){var s=[],o=i/2,l=a/2,u=r,c=n;s.push({x:u+o*e[0],y:c+l*e[1]});for(var d=1;d<e.length/2;d++)s.push({x:u+o*e[d*2],y:c+l*e[d*2+1]});return s},wp=function(e,r,n,i,a,s,o,l){var u=[],c,d=new Array(n.length),h=!0;s==null&&(h=!1);var m;if(h){for(var v=0;v<d.length/2;v++)d[v*2]=n[v*2]*s+i,d[v*2+1]=n[v*2+1]*o+a;if(l>0){var x=N0(d,-l);m=C0(x)}else m=d}else m=n;for(var y,b,S,w,k=0;k<m.length/2;k++)y=m[k*2],b=m[k*2+1],k<m.length/2-1?(S=m[(k+1)*2],w=m[(k+1)*2+1]):(S=m[0],w=m[1]),c=Ko(e,r,i,a,y,b,S,w),c.length!==0&&u.push(c[0],c[1]);return u},fG=function(e,r,n,i,a,s,o,l,u){var c=[],d,h=new Array(n.length*2);u.forEach(function(S,w){w===0?(h[h.length-2]=S.startX,h[h.length-1]=S.startY):(h[w*4-2]=S.startX,h[w*4-1]=S.startY),h[w*4]=S.stopX,h[w*4+1]=S.stopY,d=yh(e,r,i,a,S.cx,S.cy,S.radius),d.length!==0&&c.push(d[0],d[1])});for(var m=0;m<h.length/4;m++)d=Ko(e,r,i,a,h[m*4],h[m*4+1],h[m*4+2],h[m*4+3],!1),d.length!==0&&c.push(d[0],d[1]);if(c.length>2){for(var v=[c[0],c[1]],x=Math.pow(v[0]-e,2)+Math.pow(v[1]-r,2),y=1;y<c.length/2;y++){var b=Math.pow(c[y*2]-e,2)+Math.pow(c[y*2+1]-r,2);b<=x&&(v[0]=c[y*2],v[1]=c[y*2+1],x=b)}return v}return c},Rg=function(e,r,n){var i=[e[0]-r[0],e[1]-r[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=(a-n)/a;return s<0&&(s=1e-5),[r[0]+s*i[0],r[1]+s*i[1]]},Qn=function(e,r){var n=L5(e,r);return n=ZA(n),n},ZA=function(e){for(var r,n,i=e.length/2,a=1/0,s=1/0,o=-1/0,l=-1/0,u=0;u<i;u++)r=e[2*u],n=e[2*u+1],a=Math.min(a,r),o=Math.max(o,r),s=Math.min(s,n),l=Math.max(l,n);for(var c=2/(o-a),d=2/(l-s),h=0;h<i;h++)r=e[2*h]=e[2*h]*c,n=e[2*h+1]=e[2*h+1]*d,a=Math.min(a,r),o=Math.max(o,r),s=Math.min(s,n),l=Math.max(l,n);if(s<-1)for(var m=0;m<i;m++)n=e[2*m+1]=e[2*m+1]+(-1-s);return e},L5=function(e,r){var n=1/e*2*Math.PI,i=e%2===0?Math.PI/2+n/2:Math.PI/2;i+=r;for(var a=new Array(e*2),s,o=0;o<e;o++)s=o*n+i,a[2*o]=Math.cos(s),a[2*o+1]=Math.sin(-s);return a},vl=function(e,r){return Math.min(e/4,r/4,8)},eR=function(e,r){return Math.min(e/10,r/10,8)},n3=function(){return 8},hG=function(e,r,n){return[e-2*r+n,2*(r-e),e]},B5=function(e,r){return{heightOffset:Math.min(15,.05*r),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};function _w(t,e){function r(d){for(var h=[],m=0;m<d.length;m++){var v=d[m],x=d[(m+1)%d.length],y={x:x.x-v.x,y:x.y-v.y},b={x:-y.y,y:y.x},S=Math.sqrt(b.x*b.x+b.y*b.y);h.push({x:b.x/S,y:b.y/S})}return h}function n(d,h){var m=1/0,v=-1/0,x=vi(d),y;try{for(x.s();!(y=x.n()).done;){var b=y.value,S=b.x*h.x+b.y*h.y;m=Math.min(m,S),v=Math.max(v,S)}}catch(w){x.e(w)}finally{x.f()}return{min:m,max:v}}function i(d,h){return!(d.max<h.min||h.max<d.min)}var a=[].concat(b0(r(t)),b0(r(e))),s=vi(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,u=n(t,l),c=n(e,l);if(!i(u,c))return!1}}catch(d){s.e(d)}finally{s.f()}return!0}var pG=Pn({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),mG={pageRank:function(e){for(var r=pG(e),n=r.dampingFactor,i=r.precision,a=r.iterations,s=r.weight,o=this._private.cy,l=this.byGroup(),u=l.nodes,c=l.edges,d=u.length,h=d*d,m=c.length,v=new Array(h),x=new Array(d),y=(1-n)/d,b=0;b<d;b++){for(var S=0;S<d;S++){var w=b*d+S;v[w]=0}x[b]=0}for(var k=0;k<m;k++){var N=c[k],T=N.data("source"),j=N.data("target");if(T!==j){var M=u.indexOfId(T),A=u.indexOfId(j),P=s(N),D=A*d+M;v[D]+=P,x[M]+=P}}for(var R=1/d+y,I=0;I<d;I++)if(x[I]===0)for(var U=0;U<d;U++){var B=U*d+I;v[B]=R}else for(var z=0;z<d;z++){var F=z*d+I;v[F]=v[F]/x[I]+y}for(var V=new Array(d),J=new Array(d),Y,L=0;L<d;L++)V[L]=1;for(var G=0;G<a;G++){for(var ee=0;ee<d;ee++)J[ee]=0;for(var re=0;re<d;re++)for(var se=0;se<d;se++){var de=re*d+se;J[re]+=v[de]*V[se]}YU(J),Y=V,V=J,J=Y;for(var W=0,ne=0;ne<d;ne++){var ie=Y[ne]-V[ne];W+=ie*ie}if(W<i)break}var $={rank:function(te){return te=o.collection(te)[0],V[u.indexOf(te)]}};return $}},ZT=Pn({root:null,weight:function(e){return 1},directed:!1,alpha:0}),xd={degreeCentralityNormalized:function(e){e=ZT(e);var r=this.cy(),n=this.nodes(),i=n.length;if(e.directed){for(var c={},d={},h=0,m=0,v=0;v<i;v++){var x=n[v],y=x.id();e.root=x;var b=this.degreeCentrality(e);h<b.indegree&&(h=b.indegree),m<b.outdegree&&(m=b.outdegree),c[y]=b.indegree,d[y]=b.outdegree}return{indegree:function(w){return h==0?0:(Ke(w)&&(w=r.filter(w)),c[w.id()]/h)},outdegree:function(w){return m===0?0:(Ke(w)&&(w=r.filter(w)),d[w.id()]/m)}}}else{for(var a={},s=0,o=0;o<i;o++){var l=n[o];e.root=l;var u=this.degreeCentrality(e);s<u.degree&&(s=u.degree),a[l.id()]=u.degree}return{degree:function(w){return s===0?0:(Ke(w)&&(w=r.filter(w)),a[w.id()]/s)}}}},degreeCentrality:function(e){e=ZT(e);var r=this.cy(),n=this,i=e,a=i.root,s=i.weight,o=i.directed,l=i.alpha;if(a=r.collection(a)[0],o){for(var m=a.connectedEdges(),v=m.filter(function(T){return T.target().same(a)&&n.has(T)}),x=m.filter(function(T){return T.source().same(a)&&n.has(T)}),y=v.length,b=x.length,S=0,w=0,k=0;k<v.length;k++)S+=s(v[k]);for(var N=0;N<x.length;N++)w+=s(x[N]);return{indegree:Math.pow(y,1-l)*Math.pow(S,l),outdegree:Math.pow(b,1-l)*Math.pow(w,l)}}else{for(var u=a.connectedEdges().intersection(n),c=u.length,d=0,h=0;h<u.length;h++)d+=s(u[h]);return{degree:Math.pow(c,1-l)*Math.pow(d,l)}}}};xd.dc=xd.degreeCentrality;xd.dcn=xd.degreeCentralityNormalised=xd.degreeCentralityNormalized;var e6=Pn({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),bd={closenessCentralityNormalized:function(e){for(var r=e6(e),n=r.harmonic,i=r.weight,a=r.directed,s=this.cy(),o={},l=0,u=this.nodes(),c=this.floydWarshall({weight:i,directed:a}),d=0;d<u.length;d++){for(var h=0,m=u[d],v=0;v<u.length;v++)if(d!==v){var x=c.distance(m,u[v]);n?h+=1/x:h+=x}n||(h=1/h),l<h&&(l=h),o[m.id()]=h}return{closeness:function(b){return l==0?0:(Ke(b)?b=s.filter(b)[0].id():b=b.id(),o[b]/l)}}},closenessCentrality:function(e){var r=e6(e),n=r.root,i=r.weight,a=r.directed,s=r.harmonic;n=this.filter(n)[0];for(var o=this.dijkstra({root:n,weight:i,directed:a}),l=0,u=this.nodes(),c=0;c<u.length;c++){var d=u[c];if(!d.same(n)){var h=o.distanceTo(d);s?l+=1/h:l+=h}}return s?l:1/l}};bd.cc=bd.closenessCentrality;bd.ccn=bd.closenessCentralityNormalised=bd.closenessCentralityNormalized;var gG=Pn({weight:null,directed:!1}),F5={betweennessCentrality:function(e){for(var r=gG(e),n=r.directed,i=r.weight,a=i!=null,s=this.cy(),o=this.nodes(),l={},u={},c=0,d={set:function(w,k){u[w]=k,k>c&&(c=k)},get:function(w){return u[w]}},h=0;h<o.length;h++){var m=o[h],v=m.id();n?l[v]=m.outgoers().nodes():l[v]=m.openNeighborhood().nodes(),d.set(v,0)}for(var x=function(){for(var w=o[y].id(),k=[],N={},T={},j={},M=new nm(function(re,se){return j[re]-j[se]}),A=0;A<o.length;A++){var P=o[A].id();N[P]=[],T[P]=0,j[P]=1/0}for(T[w]=1,j[w]=0,M.push(w);!M.empty();){var D=M.pop();if(k.push(D),a)for(var R=0;R<l[D].length;R++){var I=l[D][R],U=s.getElementById(D),B=void 0;U.edgesTo(I).length>0?B=U.edgesTo(I)[0]:B=I.edgesTo(U)[0];var z=i(B);I=I.id(),j[I]>j[D]+z&&(j[I]=j[D]+z,M.nodes.indexOf(I)<0?M.push(I):M.updateItem(I),T[I]=0,N[I]=[]),j[I]==j[D]+z&&(T[I]=T[I]+T[D],N[I].push(D))}else for(var F=0;F<l[D].length;F++){var V=l[D][F].id();j[V]==1/0&&(M.push(V),j[V]=j[D]+1),j[V]==j[D]+1&&(T[V]=T[V]+T[D],N[V].push(D))}}for(var J={},Y=0;Y<o.length;Y++)J[o[Y].id()]=0;for(;k.length>0;){for(var L=k.pop(),G=0;G<N[L].length;G++){var ee=N[L][G];J[ee]=J[ee]+T[ee]/T[L]*(1+J[L])}L!=o[y].id()&&d.set(L,d.get(L)+J[L])}},y=0;y<o.length;y++)x();var b={betweenness:function(w){var k=s.collection(w).id();return d.get(k)},betweennessNormalized:function(w){if(c==0)return 0;var k=s.collection(w).id();return d.get(k)/c}};return b.betweennessNormalised=b.betweennessNormalized,b}};F5.bc=F5.betweennessCentrality;var vG=Pn({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(t){return 1}]}),yG=function(e){return vG(e)},xG=function(e,r){for(var n=0,i=0;i<r.length;i++)n+=r[i](e);return n},bG=function(e,r,n){for(var i=0;i<r;i++)e[i*r+i]=n},tR=function(e,r){for(var n,i=0;i<r;i++){n=0;for(var a=0;a<r;a++)n+=e[a*r+i];for(var s=0;s<r;s++)e[s*r+i]=e[s*r+i]/n}},wG=function(e,r,n){for(var i=new Array(n*n),a=0;a<n;a++){for(var s=0;s<n;s++)i[a*n+s]=0;for(var o=0;o<n;o++)for(var l=0;l<n;l++)i[a*n+l]+=e[a*n+o]*r[o*n+l]}return i},SG=function(e,r,n){for(var i=e.slice(0),a=1;a<n;a++)e=wG(e,i,r);return e},kG=function(e,r,n){for(var i=new Array(r*r),a=0;a<r*r;a++)i[a]=Math.pow(e[a],n);return tR(i,r),i},CG=function(e,r,n,i){for(var a=0;a<n;a++){var s=Math.round(e[a]*Math.pow(10,i))/Math.pow(10,i),o=Math.round(r[a]*Math.pow(10,i))/Math.pow(10,i);if(s!==o)return!1}return!0},NG=function(e,r,n,i){for(var a=[],s=0;s<r;s++){for(var o=[],l=0;l<r;l++)Math.round(e[s*r+l]*1e3)/1e3>0&&o.push(n[l]);o.length!==0&&a.push(i.collection(o))}return a},EG=function(e,r){for(var n=0;n<e.length;n++)if(!r[n]||e[n].id()!==r[n].id())return!1;return!0},TG=function(e){for(var r=0;r<e.length;r++)for(var n=0;n<e.length;n++)r!=n&&EG(e[r],e[n])&&e.splice(n,1);return e},t6=function(e){for(var r=this.nodes(),n=this.edges(),i=this.cy(),a=yG(e),s={},o=0;o<r.length;o++)s[r[o].id()]=o;for(var l=r.length,u=l*l,c=new Array(u),d,h=0;h<u;h++)c[h]=0;for(var m=0;m<n.length;m++){var v=n[m],x=s[v.source().id()],y=s[v.target().id()],b=xG(v,a.attributes);c[x*l+y]+=b,c[y*l+x]+=b}bG(c,l,a.multFactor),tR(c,l);for(var S=!0,w=0;S&&w<a.maxIterations;)S=!1,d=SG(c,l,a.expandFactor),c=kG(d,l,a.inflateFactor),CG(c,d,u,4)||(S=!0),w++;var k=NG(c,l,r,i);return k=TG(k),k},jG={markovClustering:t6,mcl:t6},MG=function(e){return e},rR=function(e,r){return Math.abs(r-e)},r6=function(e,r,n){return e+rR(r,n)},n6=function(e,r,n){return e+Math.pow(n-r,2)},PG=function(e){return Math.sqrt(e)},_G=function(e,r,n){return Math.max(e,rR(r,n))},Kf=function(e,r,n,i,a){for(var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:MG,o=i,l,u,c=0;c<e;c++)l=r(c),u=n(c),o=a(o,l,u);return s(o)},Dd={euclidean:function(e,r,n){return e>=2?Kf(e,r,n,0,n6,PG):Kf(e,r,n,0,r6)},squaredEuclidean:function(e,r,n){return Kf(e,r,n,0,n6)},manhattan:function(e,r,n){return Kf(e,r,n,0,r6)},max:function(e,r,n){return Kf(e,r,n,-1/0,_G)}};Dd["squared-euclidean"]=Dd.squaredEuclidean;Dd.squaredeuclidean=Dd.squaredEuclidean;function ex(t,e,r,n,i,a){var s;return vr(t)?s=t:s=Dd[t]||Dd.euclidean,e===0&&vr(t)?s(i,a):s(e,r,n,i,a)}var AG=Pn({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),i3=function(e){return AG(e)},E0=function(e,r,n,i,a){var s=a!=="kMedoids",o=s?function(d){return n[d]}:function(d){return i[d](n)},l=function(h){return i[h](r)},u=n,c=r;return ex(e,i.length,o,l,u,c)},Aw=function(e,r,n){for(var i=n.length,a=new Array(i),s=new Array(i),o=new Array(r),l=null,u=0;u<i;u++)a[u]=e.min(n[u]).value,s[u]=e.max(n[u]).value;for(var c=0;c<r;c++){l=[];for(var d=0;d<i;d++)l[d]=Math.random()*(s[d]-a[d])+a[d];o[c]=l}return o},nR=function(e,r,n,i,a){for(var s=1/0,o=0,l=0;l<r.length;l++){var u=E0(n,e,r[l],i,a);u<s&&(s=u,o=l)}return o},iR=function(e,r,n){for(var i=[],a=null,s=0;s<r.length;s++)a=r[s],n[a.id()]===e&&i.push(a);return i},RG=function(e,r,n){return Math.abs(r-e)<=n},DG=function(e,r,n){for(var i=0;i<e.length;i++)for(var a=0;a<e[i].length;a++){var s=Math.abs(e[i][a]-r[i][a]);if(s>n)return!1}return!0},OG=function(e,r,n){for(var i=0;i<n;i++)if(e===r[i])return!0;return!1},i6=function(e,r){var n=new Array(r);if(e.length<50)for(var i=0;i<r;i++){for(var a=e[Math.floor(Math.random()*e.length)];OG(a,n,i);)a=e[Math.floor(Math.random()*e.length)];n[i]=a}else for(var s=0;s<r;s++)n[s]=e[Math.floor(Math.random()*e.length)];return n},a6=function(e,r,n){for(var i=0,a=0;a<r.length;a++)i+=E0("manhattan",r[a],e,n,"kMedoids");return i},IG=function(e){var r=this.cy(),n=this.nodes(),i=null,a=i3(e),s=new Array(a.k),o={},l;a.testMode?typeof a.testCentroids=="number"?(a.testCentroids,l=Aw(n,a.k,a.attributes)):Zr(a.testCentroids)==="object"?l=a.testCentroids:l=Aw(n,a.k,a.attributes):l=Aw(n,a.k,a.attributes);for(var u=!0,c=0;u&&c<a.maxIterations;){for(var d=0;d<n.length;d++)i=n[d],o[i.id()]=nR(i,l,a.distance,a.attributes,"kMeans");u=!1;for(var h=0;h<a.k;h++){var m=iR(h,n,o);if(m.length!==0){for(var v=a.attributes.length,x=l[h],y=new Array(v),b=new Array(v),S=0;S<v;S++){b[S]=0;for(var w=0;w<m.length;w++)i=m[w],b[S]+=a.attributes[S](i);y[S]=b[S]/m.length,RG(y[S],x[S],a.sensitivityThreshold)||(u=!0)}l[h]=y,s[h]=r.collection(m)}}c++}return s},LG=function(e){var r=this.cy(),n=this.nodes(),i=null,a=i3(e),s=new Array(a.k),o,l={},u,c=new Array(a.k);a.testMode?typeof a.testCentroids=="number"||(Zr(a.testCentroids)==="object"?o=a.testCentroids:o=i6(n,a.k)):o=i6(n,a.k);for(var d=!0,h=0;d&&h<a.maxIterations;){for(var m=0;m<n.length;m++)i=n[m],l[i.id()]=nR(i,o,a.distance,a.attributes,"kMedoids");d=!1;for(var v=0;v<o.length;v++){var x=iR(v,n,l);if(x.length!==0){c[v]=a6(o[v],x,a.attributes);for(var y=0;y<x.length;y++)u=a6(x[y],x,a.attributes),u<c[v]&&(c[v]=u,o[v]=x[y],d=!0);s[v]=r.collection(x)}}h++}return s},BG=function(e,r,n,i,a){for(var s,o,l=0;l<r.length;l++)for(var u=0;u<e.length;u++)i[l][u]=Math.pow(n[l][u],a.m);for(var c=0;c<e.length;c++)for(var d=0;d<a.attributes.length;d++){s=0,o=0;for(var h=0;h<r.length;h++)s+=i[h][c]*a.attributes[d](r[h]),o+=i[h][c];e[c][d]=s/o}},FG=function(e,r,n,i,a){for(var s=0;s<e.length;s++)r[s]=e[s].slice();for(var o,l,u,c=2/(a.m-1),d=0;d<n.length;d++)for(var h=0;h<i.length;h++){o=0;for(var m=0;m<n.length;m++)l=E0(a.distance,i[h],n[d],a.attributes,"cmeans"),u=E0(a.distance,i[h],n[m],a.attributes,"cmeans"),o+=Math.pow(l/u,c);e[h][d]=1/o}},zG=function(e,r,n,i){for(var a=new Array(n.k),s=0;s<a.length;s++)a[s]=[];for(var o,l,u=0;u<r.length;u++){o=-1/0,l=-1;for(var c=0;c<r[0].length;c++)r[u][c]>o&&(o=r[u][c],l=c);a[l].push(e[u])}for(var d=0;d<a.length;d++)a[d]=i.collection(a[d]);return a},s6=function(e){var r=this.cy(),n=this.nodes(),i=i3(e),a,s,o,l,u;l=new Array(n.length);for(var c=0;c<n.length;c++)l[c]=new Array(i.k);o=new Array(n.length);for(var d=0;d<n.length;d++)o[d]=new Array(i.k);for(var h=0;h<n.length;h++){for(var m=0,v=0;v<i.k;v++)o[h][v]=Math.random(),m+=o[h][v];for(var x=0;x<i.k;x++)o[h][x]=o[h][x]/m}s=new Array(i.k);for(var y=0;y<i.k;y++)s[y]=new Array(i.attributes.length);u=new Array(n.length);for(var b=0;b<n.length;b++)u[b]=new Array(i.k);for(var S=!0,w=0;S&&w<i.maxIterations;)S=!1,BG(s,n,o,u,i),FG(o,l,s,n,i),DG(o,l,i.sensitivityThreshold)||(S=!0),w++;return a=zG(n,o,i,r),{clusters:a,degreeOfMembership:o}},VG={kMeans:IG,kMedoids:LG,fuzzyCMeans:s6,fcm:s6},$G=Pn({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),UG={single:"min",complete:"max"},GG=function(e){var r=$G(e),n=UG[r.linkage];return n!=null&&(r.linkage=n),r},o6=function(e,r,n,i,a){for(var s=0,o=1/0,l,u=a.attributes,c=function(A,P){return ex(a.distance,u.length,function(D){return u[D](A)},function(D){return u[D](P)},A,P)},d=0;d<e.length;d++){var h=e[d].key,m=n[h][i[h]];m<o&&(s=h,o=m)}if(a.mode==="threshold"&&o>=a.threshold||a.mode==="dendrogram"&&e.length===1)return!1;var v=r[s],x=r[i[s]],y;a.mode==="dendrogram"?y={left:v,right:x,key:v.key}:y={value:v.value.concat(x.value),key:v.key},e[v.index]=y,e.splice(x.index,1),r[v.key]=y;for(var b=0;b<e.length;b++){var S=e[b];v.key===S.key?l=1/0:a.linkage==="min"?(l=n[v.key][S.key],n[v.key][S.key]>n[x.key][S.key]&&(l=n[x.key][S.key])):a.linkage==="max"?(l=n[v.key][S.key],n[v.key][S.key]<n[x.key][S.key]&&(l=n[x.key][S.key])):a.linkage==="mean"?l=(n[v.key][S.key]*v.size+n[x.key][S.key]*x.size)/(v.size+x.size):a.mode==="dendrogram"?l=c(S.value,v.value):l=c(S.value[0],v.value[0]),n[v.key][S.key]=n[S.key][v.key]=l}for(var w=0;w<e.length;w++){var k=e[w].key;if(i[k]===v.key||i[k]===x.key){for(var N=k,T=0;T<e.length;T++){var j=e[T].key;n[k][j]<n[k][N]&&(N=j)}i[k]=N}e[w].index=w}return v.key=x.key=v.index=x.index=null,!0},ld=function(e,r,n){e&&(e.value?r.push(e.value):(e.left&&ld(e.left,r),e.right&&ld(e.right,r)))},z5=function(e,r){if(!e)return"";if(e.left&&e.right){var n=z5(e.left,r),i=z5(e.right,r),a=r.add({group:"nodes",data:{id:n+","+i}});return r.add({group:"edges",data:{source:n,target:a.id()}}),r.add({group:"edges",data:{source:i,target:a.id()}}),a.id()}else if(e.value)return e.value.id()},V5=function(e,r,n){if(!e)return[];var i=[],a=[],s=[];return r===0?(e.left&&ld(e.left,i),e.right&&ld(e.right,a),s=i.concat(a),[n.collection(s)]):r===1?e.value?[n.collection(e.value)]:(e.left&&ld(e.left,i),e.right&&ld(e.right,a),[n.collection(i),n.collection(a)]):e.value?[n.collection(e.value)]:(e.left&&(i=V5(e.left,r-1,n)),e.right&&(a=V5(e.right,r-1,n)),i.concat(a))},l6=function(e){for(var r=this.cy(),n=this.nodes(),i=GG(e),a=i.attributes,s=function(w,k){return ex(i.distance,a.length,function(N){return a[N](w)},function(N){return a[N](k)},w,k)},o=[],l=[],u=[],c=[],d=0;d<n.length;d++){var h={value:i.mode==="dendrogram"?n[d]:[n[d]],key:d,index:d};o[d]=h,c[d]=h,l[d]=[],u[d]=0}for(var m=0;m<o.length;m++)for(var v=0;v<=m;v++){var x=void 0;i.mode==="dendrogram"?x=m===v?1/0:s(o[m].value,o[v].value):x=m===v?1/0:s(o[m].value[0],o[v].value[0]),l[m][v]=x,l[v][m]=x,x<l[m][u[m]]&&(u[m]=v)}for(var y=o6(o,c,l,u,i);y;)y=o6(o,c,l,u,i);var b;return i.mode==="dendrogram"?(b=V5(o[0],i.dendrogramDepth,r),i.addDendrogram&&z5(o[0],r)):(b=new Array(o.length),o.forEach(function(S,w){S.key=S.index=null,b[w]=r.collection(S.value)})),b},HG={hierarchicalClustering:l6,hca:l6},WG=Pn({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),qG=function(e){var r=e.damping,n=e.preference;.5<=r&&r<1||lr("Damping must range on [0.5, 1).  Got: ".concat(r));var i=["median","mean","min","max"];return i.some(function(a){return a===n})||Ee(n)||lr("Preference must be one of [".concat(i.map(function(a){return"'".concat(a,"'")}).join(", "),"] or a number.  Got: ").concat(n)),WG(e)},KG=function(e,r,n,i){var a=function(o,l){return i[l](o)};return-ex(e,i.length,function(s){return a(r,s)},function(s){return a(n,s)},r,n)},YG=function(e,r){var n=null;return r==="median"?n=qU(e):r==="mean"?n=WU(e):r==="min"?n=GU(e):r==="max"?n=HU(e):n=r,n},XG=function(e,r,n){for(var i=[],a=0;a<e;a++)r[a*e+a]+n[a*e+a]>0&&i.push(a);return i},u6=function(e,r,n){for(var i=[],a=0;a<e;a++){for(var s=-1,o=-1/0,l=0;l<n.length;l++){var u=n[l];r[a*e+u]>o&&(s=u,o=r[a*e+u])}s>0&&i.push(s)}for(var c=0;c<n.length;c++)i[n[c]]=n[c];return i},QG=function(e,r,n){for(var i=u6(e,r,n),a=0;a<n.length;a++){for(var s=[],o=0;o<i.length;o++)i[o]===n[a]&&s.push(o);for(var l=-1,u=-1/0,c=0;c<s.length;c++){for(var d=0,h=0;h<s.length;h++)d+=r[s[h]*e+s[c]];d>u&&(l=c,u=d)}n[a]=s[l]}return i=u6(e,r,n),i},c6=function(e){for(var r=this.cy(),n=this.nodes(),i=qG(e),a={},s=0;s<n.length;s++)a[n[s].id()]=s;var o,l,u,c,d,h;o=n.length,l=o*o,u=new Array(l);for(var m=0;m<l;m++)u[m]=-1/0;for(var v=0;v<o;v++)for(var x=0;x<o;x++)v!==x&&(u[v*o+x]=KG(i.distance,n[v],n[x],i.attributes));c=YG(u,i.preference);for(var y=0;y<o;y++)u[y*o+y]=c;d=new Array(l);for(var b=0;b<l;b++)d[b]=0;h=new Array(l);for(var S=0;S<l;S++)h[S]=0;for(var w=new Array(o),k=new Array(o),N=new Array(o),T=0;T<o;T++)w[T]=0,k[T]=0,N[T]=0;for(var j=new Array(o*i.minIterations),M=0;M<j.length;M++)j[M]=0;var A;for(A=0;A<i.maxIterations;A++){for(var P=0;P<o;P++){for(var D=-1/0,R=-1/0,I=-1,U=0,B=0;B<o;B++)w[B]=d[P*o+B],U=h[P*o+B]+u[P*o+B],U>=D?(R=D,D=U,I=B):U>R&&(R=U);for(var z=0;z<o;z++)d[P*o+z]=(1-i.damping)*(u[P*o+z]-D)+i.damping*w[z];d[P*o+I]=(1-i.damping)*(u[P*o+I]-R)+i.damping*w[I]}for(var F=0;F<o;F++){for(var V=0,J=0;J<o;J++)w[J]=h[J*o+F],k[J]=Math.max(0,d[J*o+F]),V+=k[J];V-=k[F],k[F]=d[F*o+F],V+=k[F];for(var Y=0;Y<o;Y++)h[Y*o+F]=(1-i.damping)*Math.min(0,V-k[Y])+i.damping*w[Y];h[F*o+F]=(1-i.damping)*(V-k[F])+i.damping*w[F]}for(var L=0,G=0;G<o;G++){var ee=h[G*o+G]+d[G*o+G]>0?1:0;j[A%i.minIterations*o+G]=ee,L+=ee}if(L>0&&(A>=i.minIterations-1||A==i.maxIterations-1)){for(var re=0,se=0;se<o;se++){N[se]=0;for(var de=0;de<i.minIterations;de++)N[se]+=j[de*o+se];(N[se]===0||N[se]===i.minIterations)&&re++}if(re===o)break}}for(var W=XG(o,d,h),ne=QG(o,u,W),ie={},$=0;$<W.length;$++)ie[W[$]]=[];for(var q=0;q<n.length;q++){var te=a[n[q].id()],Z=ne[te];Z!=null&&ie[Z].push(n[q])}for(var le=new Array(W.length),ge=0;ge<W.length;ge++)le[ge]=r.collection(ie[W[ge]]);return le},JG={affinityPropagation:c6,ap:c6},ZG=Pn({root:void 0,directed:!1}),eH={hierholzer:function(e){if(!Mt(e)){var r=arguments;e={root:r[0],directed:r[1]}}var n=ZG(e),i=n.root,a=n.directed,s=this,o=!1,l,u,c;i&&(c=Ke(i)?this.filter(i)[0].id():i[0].id());var d={},h={};a?s.forEach(function(S){var w=S.id();if(S.isNode()){var k=S.indegree(!0),N=S.outdegree(!0),T=k-N,j=N-k;T==1?l?o=!0:l=w:j==1?u?o=!0:u=w:(j>1||T>1)&&(o=!0),d[w]=[],S.outgoers().forEach(function(M){M.isEdge()&&d[w].push(M.id())})}else h[w]=[void 0,S.target().id()]}):s.forEach(function(S){var w=S.id();if(S.isNode()){var k=S.degree(!0);k%2&&(l?u?o=!0:u=w:l=w),d[w]=[],S.connectedEdges().forEach(function(N){return d[w].push(N.id())})}else h[w]=[S.source().id(),S.target().id()]});var m={found:!1,trail:void 0};if(o)return m;if(u&&l)if(a){if(c&&u!=c)return m;c=u}else{if(c&&u!=c&&l!=c)return m;c||(c=u)}else c||(c=s[0].id());var v=function(w){for(var k=w,N=[w],T,j,M;d[k].length;)T=d[k].shift(),j=h[T][0],M=h[T][1],k!=M?(d[M]=d[M].filter(function(A){return A!=T}),k=M):!a&&k!=j&&(d[j]=d[j].filter(function(A){return A!=T}),k=j),N.unshift(T),N.unshift(k);return N},x=[],y=[];for(y=v(c);y.length!=1;)d[y[0]].length==0?(x.unshift(s.getElementById(y.shift())),x.unshift(s.getElementById(y.shift()))):y=v(y.shift()).concat(y);x.unshift(s.getElementById(y.shift()));for(var b in d)if(d[b].length)return m;return m.found=!0,m.trail=this.spawn(x,!0),m}},Dg=function(){var e=this,r={},n=0,i=0,a=[],s=[],o={},l=function(h,m){for(var v=s.length-1,x=[],y=e.spawn();s[v].x!=h||s[v].y!=m;)x.push(s.pop().edge),v--;x.push(s.pop().edge),x.forEach(function(b){var S=b.connectedNodes().intersection(e);y.merge(b),S.forEach(function(w){var k=w.id(),N=w.connectedEdges().intersection(e);y.merge(w),r[k].cutVertex?y.merge(N.filter(function(T){return T.isLoop()})):y.merge(N)})}),a.push(y)},u=function(h,m,v){h===v&&(i+=1),r[m]={id:n,low:n++,cutVertex:!1};var x=e.getElementById(m).connectedEdges().intersection(e);if(x.size()===0)a.push(e.spawn(e.getElementById(m)));else{var y,b,S,w;x.forEach(function(k){y=k.source().id(),b=k.target().id(),S=y===m?b:y,S!==v&&(w=k.id(),o[w]||(o[w]=!0,s.push({x:m,y:S,edge:k})),S in r?r[m].low=Math.min(r[m].low,r[S].id):(u(h,S,m),r[m].low=Math.min(r[m].low,r[S].low),r[m].id<=r[S].low&&(r[m].cutVertex=!0,l(m,S))))})}};e.forEach(function(d){if(d.isNode()){var h=d.id();h in r||(i=0,u(h,h),r[h].cutVertex=i>1)}});var c=Object.keys(r).filter(function(d){return r[d].cutVertex}).map(function(d){return e.getElementById(d)});return{cut:e.spawn(c),components:a}},tH={hopcroftTarjanBiconnected:Dg,htbc:Dg,htb:Dg,hopcroftTarjanBiconnectedComponents:Dg},Og=function(){var e=this,r={},n=0,i=[],a=[],s=e.spawn(e),o=function(u){a.push(u),r[u]={index:n,low:n++,explored:!1};var c=e.getElementById(u).connectedEdges().intersection(e);if(c.forEach(function(x){var y=x.target().id();y!==u&&(y in r||o(y),r[y].explored||(r[u].low=Math.min(r[u].low,r[y].low)))}),r[u].index===r[u].low){for(var d=e.spawn();;){var h=a.pop();if(d.merge(e.getElementById(h)),r[h].low=r[u].index,r[h].explored=!0,h===u)break}var m=d.edgesWith(d),v=d.merge(m);i.push(v),s=s.difference(v)}};return e.forEach(function(l){if(l.isNode()){var u=l.id();u in r||o(u)}}),{cut:s,components:i}},rH={tarjanStronglyConnected:Og,tsc:Og,tscc:Og,tarjanStronglyConnectedComponents:Og},aR={};[xp,AU,RU,OU,LU,FU,$U,mG,xd,bd,F5,jG,VG,HG,JG,eH,tH,rH].forEach(function(t){Qe(aR,t)});/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/var sR=0,oR=1,lR=2,La=function(e){if(!(this instanceof La))return new La(e);this.id="Thenable/1.0.7",this.state=sR,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};La.prototype={fulfill:function(e){return d6(this,oR,"fulfillValue",e)},reject:function(e){return d6(this,lR,"rejectReason",e)},then:function(e,r){var n=this,i=new La;return n.onFulfilled.push(h6(e,i,"fulfill")),n.onRejected.push(h6(r,i,"reject")),uR(n),i.proxy}};var d6=function(e,r,n,i){return e.state===sR&&(e.state=r,e[n]=i,uR(e)),e},uR=function(e){e.state===oR?f6(e,"onFulfilled",e.fulfillValue):e.state===lR&&f6(e,"onRejected",e.rejectReason)},f6=function(e,r,n){if(e[r].length!==0){var i=e[r];e[r]=[];var a=function(){for(var o=0;o<i.length;o++)i[o](n)};typeof setImmediate=="function"?setImmediate(a):setTimeout(a,0)}},h6=function(e,r,n){return function(i){if(typeof e!="function")r[n].call(r,i);else{var a;try{a=e(i)}catch(s){r.reject(s);return}cR(r,a)}}},cR=function(e,r){if(e===r||e.proxy===r){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(Zr(r)==="object"&&r!==null||typeof r=="function")try{n=r.then}catch(a){e.reject(a);return}if(typeof n=="function"){var i=!1;try{n.call(r,function(a){i||(i=!0,a===r?e.reject(new TypeError("circular thenable chain")):cR(e,a))},function(a){i||(i=!0,e.reject(a))})}catch(a){i||e.reject(a)}return}e.fulfill(r)};La.all=function(t){return new La(function(e,r){for(var n=new Array(t.length),i=0,a=function(l,u){n[l]=u,i++,i===t.length&&e(n)},s=0;s<t.length;s++)(function(o){var l=t[o],u=l!=null&&l.then!=null;if(u)l.then(function(d){a(o,d)},function(d){r(d)});else{var c=l;a(o,c)}})(s)})};La.resolve=function(t){return new La(function(e,r){e(t)})};La.reject=function(t){return new La(function(e,r){r(t)})};var nf=typeof Promise<"u"?Promise:La,$5=function(e,r,n){var i=KC(e),a=!i,s=this._private=Qe({duration:1e3},r,n);if(s.target=e,s.style=s.style||s.css,s.started=!1,s.playing=!1,s.hooked=!1,s.applying=!1,s.progress=0,s.completes=[],s.frames=[],s.complete&&vr(s.complete)&&s.completes.push(s.complete),a){var o=e.position();s.startPosition=s.startPosition||{x:o.x,y:o.y},s.startStyle=s.startStyle||e.cy().style().getAnimationStartStyle(e,s.style)}if(i){var l=e.pan();s.startPan={x:l.x,y:l.y},s.startZoom=e.zoom()}this.length=1,this[0]=this},zu=$5.prototype;Qe(zu,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var r,n=e.target._private.animation;e.queue?r=n.queue:r=n.current,r.push(this),Ai(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var r=this._private;return e===void 0?r.progress*r.duration:this.progress(e/r.duration)},progress:function(e){var r=this._private,n=r.playing;return e===void 0?r.progress:(n&&this.pause(),r.progress=e,r.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,r=e.playing;r&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(u,c){var d=e[u];d!=null&&(e[u]=e[c],e[c]=d)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var i=0;i<e.style.length;i++){var a=e.style[i],s=a.name,o=e.startStyle[s];e.startStyle[s]=a,e.style[i]=o}return r&&this.play(),this},promise:function(e){var r=this._private,n;switch(e){case"frame":n=r.frames;break;default:case"complete":case"completed":n=r.completes}return new nf(function(i,a){n.push(function(){i()})})}});zu.complete=zu.completed;zu.run=zu.play;zu.running=zu.playing;var nH={animated:function(){return function(){var r=this,n=r.length!==void 0,i=n?r:[r],a=this._private.cy||this;if(!a.styleEnabled())return!1;var s=i[0];if(s)return s._private.animation.current.length>0}},clearQueue:function(){return function(){var r=this,n=r.length!==void 0,i=n?r:[r],a=this._private.cy||this;if(!a.styleEnabled())return this;for(var s=0;s<i.length;s++){var o=i[s];o._private.animation.queue=[]}return this}},delay:function(){return function(r,n){var i=this._private.cy||this;return i.styleEnabled()?this.animate({delay:r,duration:r,complete:n}):this}},delayAnimation:function(){return function(r,n){var i=this._private.cy||this;return i.styleEnabled()?this.animation({delay:r,duration:r,complete:n}):this}},animation:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this,l=!a,u=!l;if(!o.styleEnabled())return this;var c=o.style();r=Qe({},r,n);var d=Object.keys(r).length===0;if(d)return new $5(s[0],r);switch(r.duration===void 0&&(r.duration=400),r.duration){case"slow":r.duration=600;break;case"fast":r.duration=200;break}if(u&&(r.style=c.getPropsList(r.style||r.css),r.css=void 0),u&&r.renderedPosition!=null){var h=r.renderedPosition,m=o.pan(),v=o.zoom();r.position=YA(h,v,m)}if(l&&r.panBy!=null){var x=r.panBy,y=o.pan();r.pan={x:y.x+x.x,y:y.y+x.y}}var b=r.center||r.centre;if(l&&b!=null){var S=o.getCenterPan(b.eles,r.zoom);S!=null&&(r.pan=S)}if(l&&r.fit!=null){var w=r.fit,k=o.getFitViewport(w.eles||w.boundingBox,w.padding);k!=null&&(r.pan=k.pan,r.zoom=k.zoom)}if(l&&Mt(r.zoom)){var N=o.getZoomedViewport(r.zoom);N!=null?(N.zoomed&&(r.zoom=N.zoom),N.panned&&(r.pan=N.pan)):r.zoom=null}return new $5(s[0],r)}},animate:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;n&&(r=Qe({},r,n));for(var l=0;l<s.length;l++){var u=s[l],c=u.animated()&&(r.queue===void 0||r.queue),d=u.animation(r,c?{queue:!0}:void 0);d.play()}return this}},stop:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;for(var l=0;l<s.length;l++){for(var u=s[l],c=u._private,d=c.animation.current,h=0;h<d.length;h++){var m=d[h],v=m._private;n&&(v.duration=0)}r&&(c.animation.queue=[]),n||(c.animation.current=[])}return o.notify("draw"),this}}},Rw,p6;function tx(){if(p6)return Rw;p6=1;var t=Array.isArray;return Rw=t,Rw}var Dw,m6;function iH(){if(m6)return Dw;m6=1;var t=tx(),e=tm(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(t(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return Dw=i,Dw}var Ow,g6;function aH(){if(g6)return Ow;g6=1;var t=zA(),e=em(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var l=t(o);return l==n||l==i||l==r||l==a}return Ow=s,Ow}var Iw,v6;function sH(){if(v6)return Iw;v6=1;var t=Qy(),e=t["__core-js_shared__"];return Iw=e,Iw}var Lw,y6;function oH(){if(y6)return Lw;y6=1;var t=sH(),e=function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!e&&e in n}return Lw=r,Lw}var Bw,x6;function lH(){if(x6)return Bw;x6=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return Bw=r,Bw}var Fw,b6;function uH(){if(b6)return Fw;b6=1;var t=aH(),e=oH(),r=em(),n=lH(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,u=o.hasOwnProperty,c=RegExp("^"+l.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function d(h){if(!r(h)||e(h))return!1;var m=t(h)?c:a;return m.test(n(h))}return Fw=d,Fw}var zw,w6;function cH(){if(w6)return zw;w6=1;function t(e,r){return e==null?void 0:e[r]}return zw=t,zw}var Vw,S6;function a3(){if(S6)return Vw;S6=1;var t=uH(),e=cH();function r(n,i){var a=e(n,i);return t(a)?a:void 0}return Vw=r,Vw}var $w,k6;function rx(){if(k6)return $w;k6=1;var t=a3(),e=t(Object,"create");return $w=e,$w}var Uw,C6;function dH(){if(C6)return Uw;C6=1;var t=rx();function e(){this.__data__=t?t(null):{},this.size=0}return Uw=e,Uw}var Gw,N6;function fH(){if(N6)return Gw;N6=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return Gw=t,Gw}var Hw,E6;function hH(){if(E6)return Hw;E6=1;var t=rx(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(t){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return Hw=i,Hw}var Ww,T6;function pH(){if(T6)return Ww;T6=1;var t=rx(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var a=this.__data__;return t?a[i]!==void 0:r.call(a,i)}return Ww=n,Ww}var qw,j6;function mH(){if(j6)return qw;j6=1;var t=rx(),e="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=t&&i===void 0?e:i,this}return qw=r,qw}var Kw,M6;function gH(){if(M6)return Kw;M6=1;var t=dH(),e=fH(),r=hH(),n=pH(),i=mH();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,Kw=a,Kw}var Yw,P6;function vH(){if(P6)return Yw;P6=1;function t(){this.__data__=[],this.size=0}return Yw=t,Yw}var Xw,_6;function dR(){if(_6)return Xw;_6=1;function t(e,r){return e===r||e!==e&&r!==r}return Xw=t,Xw}var Qw,A6;function nx(){if(A6)return Qw;A6=1;var t=dR();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return Qw=e,Qw}var Jw,R6;function yH(){if(R6)return Jw;R6=1;var t=nx(),e=Array.prototype,r=e.splice;function n(i){var a=this.__data__,s=t(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return Jw=n,Jw}var Zw,D6;function xH(){if(D6)return Zw;D6=1;var t=nx();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return Zw=e,Zw}var e2,O6;function bH(){if(O6)return e2;O6=1;var t=nx();function e(r){return t(this.__data__,r)>-1}return e2=e,e2}var t2,I6;function wH(){if(I6)return t2;I6=1;var t=nx();function e(r,n){var i=this.__data__,a=t(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return t2=e,t2}var r2,L6;function SH(){if(L6)return r2;L6=1;var t=vH(),e=yH(),r=xH(),n=bH(),i=wH();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,r2=a,r2}var n2,B6;function kH(){if(B6)return n2;B6=1;var t=a3(),e=Qy(),r=t(e,"Map");return n2=r,n2}var i2,F6;function CH(){if(F6)return i2;F6=1;var t=gH(),e=SH(),r=kH();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return i2=n,i2}var a2,z6;function NH(){if(z6)return a2;z6=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return a2=t,a2}var s2,V6;function ix(){if(V6)return s2;V6=1;var t=NH();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return s2=e,s2}var o2,$6;function EH(){if($6)return o2;$6=1;var t=ix();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return o2=e,o2}var l2,U6;function TH(){if(U6)return l2;U6=1;var t=ix();function e(r){return t(this,r).get(r)}return l2=e,l2}var u2,G6;function jH(){if(G6)return u2;G6=1;var t=ix();function e(r){return t(this,r).has(r)}return u2=e,u2}var c2,H6;function MH(){if(H6)return c2;H6=1;var t=ix();function e(r,n){var i=t(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return c2=e,c2}var d2,W6;function PH(){if(W6)return d2;W6=1;var t=CH(),e=EH(),r=TH(),n=jH(),i=MH();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,d2=a,d2}var f2,q6;function _H(){if(q6)return f2;q6=1;var t=PH(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],l=a.cache;if(l.has(o))return l.get(o);var u=n.apply(this,s);return a.cache=l.set(o,u)||l,u};return a.cache=new(r.Cache||t),a}return r.Cache=t,f2=r,f2}var h2,K6;function AH(){if(K6)return h2;K6=1;var t=_H(),e=500;function r(n){var i=t(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return h2=r,h2}var p2,Y6;function fR(){if(Y6)return p2;Y6=1;var t=AH(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,l,u){a.push(l?u.replace(r,"$1"):o||s)}),a});return p2=n,p2}var m2,X6;function hR(){if(X6)return m2;X6=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=r(e[n],n,e);return a}return m2=t,m2}var g2,Q6;function RH(){if(Q6)return g2;Q6=1;var t=XC(),e=hR(),r=tx(),n=tm(),i=t?t.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return g2=s,g2}var v2,J6;function pR(){if(J6)return v2;J6=1;var t=RH();function e(r){return r==null?"":t(r)}return v2=e,v2}var y2,Z6;function mR(){if(Z6)return y2;Z6=1;var t=tx(),e=iH(),r=fR(),n=pR();function i(a,s){return t(a)?a:e(a,s)?[a]:r(n(a))}return y2=i,y2}var x2,e8;function s3(){if(e8)return x2;e8=1;var t=tm();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return x2=e,x2}var b2,t8;function DH(){if(t8)return b2;t8=1;var t=mR(),e=s3();function r(n,i){i=t(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return b2=r,b2}var w2,r8;function OH(){if(r8)return w2;r8=1;var t=DH();function e(r,n,i){var a=r==null?void 0:t(r,n);return a===void 0?i:a}return w2=e,w2}var IH=OH(),LH=Zp(IH),S2,n8;function BH(){if(n8)return S2;n8=1;var t=a3(),e=function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}}();return S2=e,S2}var k2,i8;function FH(){if(i8)return k2;i8=1;var t=BH();function e(r,n,i){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return k2=e,k2}var C2,a8;function zH(){if(a8)return C2;a8=1;var t=FH(),e=dR(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o){var l=a[s];(!(n.call(a,s)&&e(l,o))||o===void 0&&!(s in a))&&t(a,s,o)}return C2=i,C2}var N2,s8;function VH(){if(s8)return N2;s8=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??t,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return N2=r,N2}var E2,o8;function $H(){if(o8)return E2;o8=1;var t=zH(),e=mR(),r=VH(),n=em(),i=s3();function a(s,o,l,u){if(!n(s))return s;o=e(o,s);for(var c=-1,d=o.length,h=d-1,m=s;m!=null&&++c<d;){var v=i(o[c]),x=l;if(v==="__proto__"||v==="constructor"||v==="prototype")return s;if(c!=h){var y=m[v];x=u?u(y,v,m):void 0,x===void 0&&(x=n(y)?y:r(o[c+1])?[]:{})}t(m,v,x),m=m[v]}return s}return E2=a,E2}var T2,l8;function UH(){if(l8)return T2;l8=1;var t=$H();function e(r,n,i){return r==null?r:t(r,n,i)}return T2=e,T2}var GH=UH(),HH=Zp(GH),j2,u8;function WH(){if(u8)return j2;u8=1;function t(e,r){var n=-1,i=e.length;for(r||(r=Array(i));++n<i;)r[n]=e[n];return r}return j2=t,j2}var M2,c8;function qH(){if(c8)return M2;c8=1;var t=hR(),e=WH(),r=tx(),n=tm(),i=fR(),a=s3(),s=pR();function o(l){return r(l)?t(l,a):n(l)?[l]:e(i(s(l)))}return M2=o,M2}var KH=qH(),YH=Zp(KH),XH={data:function(e){var r={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(i){},beforeSet:function(i,a){},onSet:function(i){},canSet:function(i){return!0}};return e=Qe({},r,e),function(i,a){var s=e,o=this,l=o.length!==void 0,u=l?o:[o],c=l?o[0]:o;if(Ke(i)){var d=i.indexOf(".")!==-1,h=d&&YH(i);if(s.allowGetting&&a===void 0){var m;return c&&(s.beforeGet(c),h&&c._private[s.field][i]===void 0?m=LH(c._private[s.field],h):m=c._private[s.field][i]),m}else if(s.allowSetting&&a!==void 0){var v=!s.immutableKeys[i];if(v){var x=PA({},i,a);s.beforeSet(o,x);for(var y=0,b=u.length;y<b;y++){var S=u[y];s.canSet(S)&&(h&&c._private[s.field][i]===void 0?HH(S._private[s.field],h,a):S._private[s.field][i]=a)}s.updateStyle&&o.updateStyle(),s.onSet(o),s.settingTriggersEvent&&o[s.triggerFnName](s.settingEvent)}}}else if(s.allowSetting&&Mt(i)){var w=i,k,N,T=Object.keys(w);s.beforeSet(o,w);for(var j=0;j<T.length;j++){k=T[j],N=w[k];var M=!s.immutableKeys[k];if(M)for(var A=0;A<u.length;A++){var P=u[A];s.canSet(P)&&(P._private[s.field][k]=N)}}s.updateStyle&&o.updateStyle(),s.onSet(o),s.settingTriggersEvent&&o[s.triggerFnName](s.settingEvent)}else if(s.allowBinding&&vr(i)){var D=i;o.on(s.bindingEvent,D)}else if(s.allowGetting&&i===void 0){var R;return c&&(s.beforeGet(c),R=c._private[s.field]),R}return o}},removeData:function(e){var r={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Qe({},r,e),function(i){var a=e,s=this,o=s.length!==void 0,l=o?s:[s];if(Ke(i)){for(var u=i.split(/\s+/),c=u.length,d=0;d<c;d++){var h=u[d];if(!ml(h)){var m=!a.immutableKeys[h];if(m)for(var v=0,x=l.length;v<x;v++)l[v]._private[a.field][h]=void 0}}a.triggerEvent&&s[a.triggerFnName](a.event)}else if(i===void 0){for(var y=0,b=l.length;y<b;y++)for(var S=l[y]._private[a.field],w=Object.keys(S),k=0;k<w.length;k++){var N=w[k],T=!a.immutableKeys[N];T&&(S[N]=void 0)}a.triggerEvent&&s[a.triggerFnName](a.event)}return s}}},QH={eventAliasesOn:function(e){var r=e;r.addListener=r.listen=r.bind=r.on,r.unlisten=r.unbind=r.off=r.removeListener,r.trigger=r.emit,r.pon=r.promiseOn=function(n,i){var a=this,s=Array.prototype.slice.call(arguments,0);return new nf(function(o,l){var u=function(m){a.off.apply(a,d),o(m)},c=s.concat([u]),d=c.concat([]);a.on.apply(a,c)})}}},It={};[nH,XH,QH].forEach(function(t){Qe(It,t)});var JH={animate:It.animate(),animation:It.animation(),animated:It.animated(),clearQueue:It.clearQueue(),delay:It.delay(),delayAnimation:It.delayAnimation(),stop:It.stop()},Mv={classes:function(e){var r=this;if(e===void 0){var n=[];return r[0]._private.classes.forEach(function(v){return n.push(v)}),n}else Ht(e)||(e=(e||"").match(/\S+/g)||[]);for(var i=[],a=new rf(e),s=0;s<r.length;s++){for(var o=r[s],l=o._private,u=l.classes,c=!1,d=0;d<e.length;d++){var h=e[d],m=u.has(h);if(!m){c=!0;break}}c||(c=u.size!==e.length),c&&(l.classes=a,i.push(o))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),r},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var r=this[0];return r!=null&&r._private.classes.has(e)},toggleClass:function(e,r){Ht(e)||(e=e.match(/\S+/g)||[]);for(var n=this,i=r===void 0,a=[],s=0,o=n.length;s<o;s++)for(var l=n[s],u=l._private.classes,c=!1,d=0;d<e.length;d++){var h=e[d],m=u.has(h),v=!1;r||i&&!m?(u.add(h),v=!0):(!r||i&&m)&&(u.delete(h),v=!0),!c&&v&&(a.push(l),c=!0)}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,r){var n=this;if(r==null)r=250;else if(r===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},r),n}};Mv.className=Mv.classNames=Mv.classes;var Tt={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Jr,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};Tt.variable="(?:[\\w-.]|(?:\\\\"+Tt.metaChar+"))+";Tt.className="(?:[\\w-]|(?:\\\\"+Tt.metaChar+"))+";Tt.value=Tt.string+"|"+Tt.number;Tt.id=Tt.variable;(function(){var t,e,r;for(t=Tt.comparatorOp.split("|"),r=0;r<t.length;r++)e=t[r],Tt.comparatorOp+="|@"+e;for(t=Tt.comparatorOp.split("|"),r=0;r<t.length;r++)e=t[r],!(e.indexOf("!")>=0)&&e!=="="&&(Tt.comparatorOp+="|\\!"+e)})();var zt=function(){return{checks:[]}},ze={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},U5=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(t,e){return X$(t.selector,e.selector)}),ZH=function(){for(var t={},e,r=0;r<U5.length;r++)e=U5[r],t[e.selector]=e.matches;return t}(),eW=function(e,r){return ZH[e](r)},tW="("+U5.map(function(t){return t.selector}).join("|")+")",jc=function(e){return e.replace(new RegExp("\\\\("+Tt.metaChar+")","g"),function(r,n){return n})},jo=function(e,r,n){e[e.length-1]=n},G5=[{name:"group",query:!0,regex:"("+Tt.group+")",populate:function(e,r,n){var i=zr(n,1),a=i[0];r.checks.push({type:ze.GROUP,value:a==="*"?a:a+"s"})}},{name:"state",query:!0,regex:tW,populate:function(e,r,n){var i=zr(n,1),a=i[0];r.checks.push({type:ze.STATE,value:a})}},{name:"id",query:!0,regex:"\\#("+Tt.id+")",populate:function(e,r,n){var i=zr(n,1),a=i[0];r.checks.push({type:ze.ID,value:jc(a)})}},{name:"className",query:!0,regex:"\\.("+Tt.className+")",populate:function(e,r,n){var i=zr(n,1),a=i[0];r.checks.push({type:ze.CLASS,value:jc(a)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+Tt.variable+")\\s*\\]",populate:function(e,r,n){var i=zr(n,1),a=i[0];r.checks.push({type:ze.DATA_EXIST,field:jc(a)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+Tt.variable+")\\s*("+Tt.comparatorOp+")\\s*("+Tt.value+")\\s*\\]",populate:function(e,r,n){var i=zr(n,3),a=i[0],s=i[1],o=i[2],l=new RegExp("^"+Tt.string+"$").exec(o)!=null;l?o=o.substring(1,o.length-1):o=parseFloat(o),r.checks.push({type:ze.DATA_COMPARE,field:jc(a),operator:s,value:o})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+Tt.boolOp+")\\s*("+Tt.variable+")\\s*\\]",populate:function(e,r,n){var i=zr(n,2),a=i[0],s=i[1];r.checks.push({type:ze.DATA_BOOL,field:jc(s),operator:a})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+Tt.meta+")\\s*("+Tt.comparatorOp+")\\s*("+Tt.number+")\\s*\\]\\]",populate:function(e,r,n){var i=zr(n,3),a=i[0],s=i[1],o=i[2];r.checks.push({type:ze.META_COMPARE,field:jc(a),operator:s,value:parseFloat(o)})}},{name:"nextQuery",separator:!0,regex:Tt.separator,populate:function(e,r){var n=e.currentSubject,i=e.edgeCount,a=e.compoundCount,s=e[e.length-1];n!=null&&(s.subject=n,e.currentSubject=null),s.edgeCount=i,s.compoundCount=a,e.edgeCount=0,e.compoundCount=0;var o=e[e.length++]=zt();return o}},{name:"directedEdge",separator:!0,regex:Tt.directedEdge,populate:function(e,r){if(e.currentSubject==null){var n=zt(),i=r,a=zt();return n.checks.push({type:ze.DIRECTED_EDGE,source:i,target:a}),jo(e,r,n),e.edgeCount++,a}else{var s=zt(),o=r,l=zt();return s.checks.push({type:ze.NODE_SOURCE,source:o,target:l}),jo(e,r,s),e.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:Tt.undirectedEdge,populate:function(e,r){if(e.currentSubject==null){var n=zt(),i=r,a=zt();return n.checks.push({type:ze.UNDIRECTED_EDGE,nodes:[i,a]}),jo(e,r,n),e.edgeCount++,a}else{var s=zt(),o=r,l=zt();return s.checks.push({type:ze.NODE_NEIGHBOR,node:o,neighbor:l}),jo(e,r,s),l}}},{name:"child",separator:!0,regex:Tt.child,populate:function(e,r){if(e.currentSubject==null){var n=zt(),i=zt(),a=e[e.length-1];return n.checks.push({type:ze.CHILD,parent:a,child:i}),jo(e,r,n),e.compoundCount++,i}else if(e.currentSubject===r){var s=zt(),o=e[e.length-1],l=zt(),u=zt(),c=zt(),d=zt();return s.checks.push({type:ze.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=r.checks,r.checks=[{type:ze.TRUE}],d.checks.push({type:ze.TRUE}),l.checks.push({type:ze.PARENT,parent:d,child:c}),jo(e,o,s),e.currentSubject=u,e.compoundCount++,c}else{var h=zt(),m=zt(),v=[{type:ze.PARENT,parent:h,child:m}];return h.checks=r.checks,r.checks=v,e.compoundCount++,m}}},{name:"descendant",separator:!0,regex:Tt.descendant,populate:function(e,r){if(e.currentSubject==null){var n=zt(),i=zt(),a=e[e.length-1];return n.checks.push({type:ze.DESCENDANT,ancestor:a,descendant:i}),jo(e,r,n),e.compoundCount++,i}else if(e.currentSubject===r){var s=zt(),o=e[e.length-1],l=zt(),u=zt(),c=zt(),d=zt();return s.checks.push({type:ze.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=r.checks,r.checks=[{type:ze.TRUE}],d.checks.push({type:ze.TRUE}),l.checks.push({type:ze.ANCESTOR,ancestor:d,descendant:c}),jo(e,o,s),e.currentSubject=u,e.compoundCount++,c}else{var h=zt(),m=zt(),v=[{type:ze.ANCESTOR,ancestor:h,descendant:m}];return h.checks=r.checks,r.checks=v,e.compoundCount++,m}}},{name:"subject",modifier:!0,regex:Tt.subject,populate:function(e,r){if(e.currentSubject!=null&&e.currentSubject!==r)return Lt("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=r;var n=e[e.length-1],i=n.checks[0],a=i==null?null:i.type;a===ze.DIRECTED_EDGE?i.type=ze.NODE_TARGET:a===ze.UNDIRECTED_EDGE&&(i.type=ze.NODE_NEIGHBOR,i.node=i.nodes[1],i.neighbor=i.nodes[0],i.nodes=null)}}];G5.forEach(function(t){return t.regexObj=new RegExp("^"+t.regex)});var rW=function(e){for(var r,n,i,a=0;a<G5.length;a++){var s=G5[a],o=s.name,l=e.match(s.regexObj);if(l!=null){n=l,r=s,i=o;var u=l[0];e=e.substring(u.length);break}}return{expr:r,match:n,name:i,remaining:e}},nW=function(e){var r=e.match(/^\s+/);if(r){var n=r[0];e=e.substring(n.length)}return e},iW=function(e){var r=this,n=r.inputText=e,i=r[0]=zt();for(r.length=1,n=nW(n);;){var a=rW(n);if(a.expr==null)return Lt("The selector `"+e+"`is invalid"),!1;var s=a.match.slice(1),o=a.expr.populate(r,i,s);if(o===!1)return!1;if(o!=null&&(i=o),n=a.remaining,n.match(/^\s*$/))break}var l=r[r.length-1];r.currentSubject!=null&&(l.subject=r.currentSubject),l.edgeCount=r.edgeCount,l.compoundCount=r.compoundCount;for(var u=0;u<r.length;u++){var c=r[u];if(c.compoundCount>0&&c.edgeCount>0)return Lt("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return Lt("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;c.edgeCount===1&&Lt("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},aW=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(c){return c??""},r=function(c){return Ke(c)?'"'+c+'"':e(c)},n=function(c){return" "+c+" "},i=function(c,d){var h=c.type,m=c.value;switch(h){case ze.GROUP:{var v=e(m);return v.substring(0,v.length-1)}case ze.DATA_COMPARE:{var x=c.field,y=c.operator;return"["+x+n(e(y))+r(m)+"]"}case ze.DATA_BOOL:{var b=c.operator,S=c.field;return"["+e(b)+S+"]"}case ze.DATA_EXIST:{var w=c.field;return"["+w+"]"}case ze.META_COMPARE:{var k=c.operator,N=c.field;return"[["+N+n(e(k))+r(m)+"]]"}case ze.STATE:return m;case ze.ID:return"#"+m;case ze.CLASS:return"."+m;case ze.PARENT:case ze.CHILD:return a(c.parent,d)+n(">")+a(c.child,d);case ze.ANCESTOR:case ze.DESCENDANT:return a(c.ancestor,d)+" "+a(c.descendant,d);case ze.COMPOUND_SPLIT:{var T=a(c.left,d),j=a(c.subject,d),M=a(c.right,d);return T+(T.length>0?" ":"")+j+M}case ze.TRUE:return""}},a=function(c,d){return c.checks.reduce(function(h,m,v){return h+(d===c&&v===0?"$":"")+i(m,d)},"")},s="",o=0;o<this.length;o++){var l=this[o];s+=a(l,l.subject),this.length>1&&o<this.length-1&&(s+=", ")}return this.toStringCache=s,s},sW={parse:iW,toString:aW},gR=function(e,r,n){var i,a=Ke(e),s=Ee(e),o=Ke(n),l,u,c=!1,d=!1,h=!1;switch(r.indexOf("!")>=0&&(r=r.replace("!",""),d=!0),r.indexOf("@")>=0&&(r=r.replace("@",""),c=!0),(a||o||c)&&(l=!a&&!s?"":""+e,u=""+n),c&&(e=l=l.toLowerCase(),n=u=u.toLowerCase()),r){case"*=":i=l.indexOf(u)>=0;break;case"$=":i=l.indexOf(u,l.length-u.length)>=0;break;case"^=":i=l.indexOf(u)===0;break;case"=":i=e===n;break;case">":h=!0,i=e>n;break;case">=":h=!0,i=e>=n;break;case"<":h=!0,i=e<n;break;case"<=":h=!0,i=e<=n;break;default:i=!1;break}return d&&(e!=null||!h)&&(i=!i),i},oW=function(e,r){switch(r){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},lW=function(e){return e!==void 0},o3=function(e,r){return e.data(r)},uW=function(e,r){return e[r]()},jr=[],nr=function(e,r){return e.checks.every(function(n){return jr[n.type](n,r)})};jr[ze.GROUP]=function(t,e){var r=t.value;return r==="*"||r===e.group()};jr[ze.STATE]=function(t,e){var r=t.value;return eW(r,e)};jr[ze.ID]=function(t,e){var r=t.value;return e.id()===r};jr[ze.CLASS]=function(t,e){var r=t.value;return e.hasClass(r)};jr[ze.META_COMPARE]=function(t,e){var r=t.field,n=t.operator,i=t.value;return gR(uW(e,r),n,i)};jr[ze.DATA_COMPARE]=function(t,e){var r=t.field,n=t.operator,i=t.value;return gR(o3(e,r),n,i)};jr[ze.DATA_BOOL]=function(t,e){var r=t.field,n=t.operator;return oW(o3(e,r),n)};jr[ze.DATA_EXIST]=function(t,e){var r=t.field;return t.operator,lW(o3(e,r))};jr[ze.UNDIRECTED_EDGE]=function(t,e){var r=t.nodes[0],n=t.nodes[1],i=e.source(),a=e.target();return nr(r,i)&&nr(n,a)||nr(n,i)&&nr(r,a)};jr[ze.NODE_NEIGHBOR]=function(t,e){return nr(t.node,e)&&e.neighborhood().some(function(r){return r.isNode()&&nr(t.neighbor,r)})};jr[ze.DIRECTED_EDGE]=function(t,e){return nr(t.source,e.source())&&nr(t.target,e.target())};jr[ze.NODE_SOURCE]=function(t,e){return nr(t.source,e)&&e.outgoers().some(function(r){return r.isNode()&&nr(t.target,r)})};jr[ze.NODE_TARGET]=function(t,e){return nr(t.target,e)&&e.incomers().some(function(r){return r.isNode()&&nr(t.source,r)})};jr[ze.CHILD]=function(t,e){return nr(t.child,e)&&nr(t.parent,e.parent())};jr[ze.PARENT]=function(t,e){return nr(t.parent,e)&&e.children().some(function(r){return nr(t.child,r)})};jr[ze.DESCENDANT]=function(t,e){return nr(t.descendant,e)&&e.ancestors().some(function(r){return nr(t.ancestor,r)})};jr[ze.ANCESTOR]=function(t,e){return nr(t.ancestor,e)&&e.descendants().some(function(r){return nr(t.descendant,r)})};jr[ze.COMPOUND_SPLIT]=function(t,e){return nr(t.subject,e)&&nr(t.left,e)&&nr(t.right,e)};jr[ze.TRUE]=function(){return!0};jr[ze.COLLECTION]=function(t,e){var r=t.value;return r.has(e)};jr[ze.FILTER]=function(t,e){var r=t.value;return r(e)};var cW=function(e){var r=this;if(r.length===1&&r[0].checks.length===1&&r[0].checks[0].type===ze.ID)return e.getElementById(r[0].checks[0].value).collection();var n=function(a){for(var s=0;s<r.length;s++){var o=r[s];if(nr(o,a))return!0}return!1};return r.text()==null&&(n=function(){return!0}),e.filter(n)},dW=function(e){for(var r=this,n=0;n<r.length;n++){var i=r[n];if(nr(i,e))return!0}return!1},fW={matches:dW,filter:cW},yl=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||Ke(e)&&e.match(/^\s*$/)||(Ai(e)?this.addQuery({checks:[{type:ze.COLLECTION,value:e.collection()}]}):vr(e)?this.addQuery({checks:[{type:ze.FILTER,value:e}]}):Ke(e)?this.parse(e)||(this.invalid=!0):lr("A selector must be created from a string; found "))},xl=yl.prototype;[sW,fW].forEach(function(t){return Qe(xl,t)});xl.text=function(){return this.inputText};xl.size=function(){return this.length};xl.eq=function(t){return this[t]};xl.sameText=function(t){return!this.invalid&&!t.invalid&&this.text()===t.text()};xl.addQuery=function(t){this[this.length++]=t};xl.selector=xl.toString;var ol={allAre:function(e){var r=new yl(e);return this.every(function(n){return r.matches(n)})},is:function(e){var r=new yl(e);return this.some(function(n){return r.matches(n)})},some:function(e,r){for(var n=0;n<this.length;n++){var i=r?e.apply(r,[this[n],n,this]):e(this[n],n,this);if(i)return!0}return!1},every:function(e,r){for(var n=0;n<this.length;n++){var i=r?e.apply(r,[this[n],n,this]):e(this[n],n,this);if(!i)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var r=this.length,n=e.length;return r!==n?!1:r===1?this[0]===e[0]:this.every(function(i){return e.hasElementWithId(i.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(r){return e.hasElementWithId(r.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var r=this.neighborhood();return e.every(function(n){return r.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var r=this;return e.every(function(n){return r.hasElementWithId(n.id())})}};ol.allAreNeighbours=ol.allAreNeighbors;ol.has=ol.contains;ol.equal=ol.equals=ol.same;var ia=function(e,r){return function(i,a,s,o){var l=i,u=this,c;if(l==null?c="":Ai(l)&&l.length===1&&(c=l.id()),u.length===1&&c){var d=u[0]._private,h=d.traversalCache=d.traversalCache||{},m=h[r]=h[r]||[],v=Bu(c),x=m[v];return x||(m[v]=e.call(u,i,a,s,o))}else return e.call(u,i,a,s,o)}},Od={parent:function(e){var r=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var i=0;i<this.length;i++){var a=this[i],s=a._private.parent;s&&r.push(s)}return this.spawn(r,!0).filter(e)},parents:function(e){for(var r=[],n=this.parent();n.nonempty();){for(var i=0;i<n.length;i++){var a=n[i];r.push(a)}n=n.parent()}return this.spawn(r,!0).filter(e)},commonAncestors:function(e){for(var r,n=0;n<this.length;n++){var i=this[n],a=i.parents();r=r||a,r=r.intersect(a)}return r.filter(e)},orphans:function(e){return this.stdFilter(function(r){return r.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(r){return r.isChild()}).filter(e)},children:ia(function(t){for(var e=[],r=0;r<this.length;r++)for(var n=this[r],i=n._private.children,a=0;a<i.length;a++)e.push(i[a]);return this.spawn(e,!0).filter(t)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var r=[];function n(i){for(var a=0;a<i.length;a++){var s=i[a];r.push(s),s.children().nonempty()&&n(s.children())}}return n(this.children()),this.spawn(r,!0).filter(e)}};function l3(t,e,r,n){for(var i=[],a=new rf,s=t.cy(),o=s.hasCompoundNodes(),l=0;l<t.length;l++){var u=t[l];r?i.push(u):o&&n(i,a,u)}for(;i.length>0;){var c=i.shift();e(c),a.add(c.id()),o&&n(i,a,c)}return t}function vR(t,e,r){if(r.isParent())for(var n=r._private.children,i=0;i<n.length;i++){var a=n[i];e.has(a.id())||t.push(a)}}Od.forEachDown=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return l3(this,t,e,vR)};function yR(t,e,r){if(r.isChild()){var n=r._private.parent;e.has(n.id())||t.push(n)}}Od.forEachUp=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return l3(this,t,e,yR)};function hW(t,e,r){yR(t,e,r),vR(t,e,r)}Od.forEachUpAndDown=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return l3(this,t,e,hW)};Od.ancestors=Od.parents;var Sp,xR;Sp=xR={data:It.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:It.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:It.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:It.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:It.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:It.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};Sp.attr=Sp.data;Sp.removeAttr=Sp.removeData;var pW=xR,ax={};function P2(t){return function(e){var r=this;if(e===void 0&&(e=!0),r.length!==0)if(r.isNode()&&!r.removed()){for(var n=0,i=r[0],a=i._private.edges,s=0;s<a.length;s++){var o=a[s];!e&&o.isLoop()||(n+=t(i,o))}return n}else return}}Qe(ax,{degree:P2(function(t,e){return e.source().same(e.target())?2:1}),indegree:P2(function(t,e){return e.target().same(t)?1:0}),outdegree:P2(function(t,e){return e.source().same(t)?1:0})});function Mc(t,e){return function(r){for(var n,i=this.nodes(),a=0;a<i.length;a++){var s=i[a],o=s[t](r);o!==void 0&&(n===void 0||e(o,n))&&(n=o)}return n}}Qe(ax,{minDegree:Mc("degree",function(t,e){return t<e}),maxDegree:Mc("degree",function(t,e){return t>e}),minIndegree:Mc("indegree",function(t,e){return t<e}),maxIndegree:Mc("indegree",function(t,e){return t>e}),minOutdegree:Mc("outdegree",function(t,e){return t<e}),maxOutdegree:Mc("outdegree",function(t,e){return t>e})});Qe(ax,{totalDegree:function(e){for(var r=0,n=this.nodes(),i=0;i<n.length;i++)r+=n[i].degree(e);return r}});var Da,bR,wR=function(e,r,n){for(var i=0;i<e.length;i++){var a=e[i];if(!a.locked()){var s=a._private.position,o={x:r.x!=null?r.x-s.x:0,y:r.y!=null?r.y-s.y:0};a.isParent()&&!(o.x===0&&o.y===0)&&a.children().shift(o,n),a.dirtyBoundingBoxCache()}}},d8={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,r){wR(e,r,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};Da=bR={position:It.data(d8),silentPosition:It.data(Qe({},d8,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,r){wR(e,r,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,r){if(Mt(e))r?this.silentPosition(e):this.position(e);else if(vr(e)){var n=e,i=this.cy();i.startBatch();for(var a=0;a<this.length;a++){var s=this[a],o=void 0;(o=n(s,a))&&(r?s.silentPosition(o):s.position(o))}i.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,r,n){var i;if(Mt(e)?(i={x:Ee(e.x)?e.x:0,y:Ee(e.y)?e.y:0},n=r):Ke(e)&&Ee(r)&&(i={x:0,y:0},i[e]=r),i!=null){var a=this.cy();a.startBatch();for(var s=0;s<this.length;s++){var o=this[s];if(!(a.hasCompoundNodes()&&o.isChild()&&o.ancestors().anySame(this))){var l=o.position(),u={x:l.x+i.x,y:l.y+i.y};n?o.silentPosition(u):o.position(u)}}a.endBatch()}return this},silentShift:function(e,r){return Mt(e)?this.shift(e,!0):Ke(e)&&Ee(r)&&this.shift(e,r,!0),this},renderedPosition:function(e,r){var n=this[0],i=this.cy(),a=i.zoom(),s=i.pan(),o=Mt(e)?e:void 0,l=o!==void 0||r!==void 0&&Ke(e);if(n&&n.isNode())if(l)for(var u=0;u<this.length;u++){var c=this[u];r!==void 0?c.position(e,(r-s[e])/a):o!==void 0&&c.position(YA(o,a,s))}else{var d=n.position();return o=Zy(d,a,s),e===void 0?o:o[e]}else if(!l)return;return this},relativePosition:function(e,r){var n=this[0],i=this.cy(),a=Mt(e)?e:void 0,s=a!==void 0||r!==void 0&&Ke(e),o=i.hasCompoundNodes();if(n&&n.isNode())if(s)for(var l=0;l<this.length;l++){var u=this[l],c=o?u.parent():null,d=c&&c.length>0,h=d;d&&(c=c[0]);var m=h?c.position():{x:0,y:0};r!==void 0?u.position(e,r+m[e]):a!==void 0&&u.position({x:a.x+m.x,y:a.y+m.y})}else{var v=n.position(),x=o?n.parent():null,y=x&&x.length>0,b=y;y&&(x=x[0]);var S=b?x.position():{x:0,y:0};return a={x:v.x-S.x,y:v.y-S.y},e===void 0?a:a[e]}else if(!s)return;return this}};Da.modelPosition=Da.point=Da.position;Da.modelPositions=Da.points=Da.positions;Da.renderedPoint=Da.renderedPosition;Da.relativePoint=Da.relativePosition;var mW=bR,wd,_l;wd=_l={};_l.renderedBoundingBox=function(t){var e=this.boundingBox(t),r=this.cy(),n=r.zoom(),i=r.pan(),a=e.x1*n+i.x,s=e.x2*n+i.x,o=e.y1*n+i.y,l=e.y2*n+i.y;return{x1:a,x2:s,y1:o,y2:l,w:s-a,h:l-o}};_l.dirtyCompoundBoundsCache=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(r){if(r.isParent()){var n=r._private;n.compoundBoundsClean=!1,n.bbCache=null,t||r.emitAndNotify("bounds")}}),this)};_l.updateCompoundBounds=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!t&&e.batching())return this;function r(s){if(!s.isParent())return;var o=s._private,l=s.children(),u=s.pstyle("compound-sizing-wrt-labels").value==="include",c={width:{val:s.pstyle("min-width").pfValue,left:s.pstyle("min-width-bias-left"),right:s.pstyle("min-width-bias-right")},height:{val:s.pstyle("min-height").pfValue,top:s.pstyle("min-height-bias-top"),bottom:s.pstyle("min-height-bias-bottom")}},d=l.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),h=o.position;(d.w===0||d.h===0)&&(d={w:s.pstyle("width").pfValue,h:s.pstyle("height").pfValue},d.x1=h.x-d.w/2,d.x2=h.x+d.w/2,d.y1=h.y-d.h/2,d.y2=h.y+d.h/2);function m(A,P,D){var R=0,I=0,U=P+D;return A>0&&U>0&&(R=P/U*A,I=D/U*A),{biasDiff:R,biasComplementDiff:I}}function v(A,P,D,R){if(D.units==="%")switch(R){case"width":return A>0?D.pfValue*A:0;case"height":return P>0?D.pfValue*P:0;case"average":return A>0&&P>0?D.pfValue*(A+P)/2:0;case"min":return A>0&&P>0?A>P?D.pfValue*P:D.pfValue*A:0;case"max":return A>0&&P>0?A>P?D.pfValue*A:D.pfValue*P:0;default:return 0}else return D.units==="px"?D.pfValue:0}var x=c.width.left.value;c.width.left.units==="px"&&c.width.val>0&&(x=x*100/c.width.val);var y=c.width.right.value;c.width.right.units==="px"&&c.width.val>0&&(y=y*100/c.width.val);var b=c.height.top.value;c.height.top.units==="px"&&c.height.val>0&&(b=b*100/c.height.val);var S=c.height.bottom.value;c.height.bottom.units==="px"&&c.height.val>0&&(S=S*100/c.height.val);var w=m(c.width.val-d.w,x,y),k=w.biasDiff,N=w.biasComplementDiff,T=m(c.height.val-d.h,b,S),j=T.biasDiff,M=T.biasComplementDiff;o.autoPadding=v(d.w,d.h,s.pstyle("padding"),s.pstyle("padding-relative-to").value),o.autoWidth=Math.max(d.w,c.width.val),h.x=(-k+d.x1+d.x2+N)/2,o.autoHeight=Math.max(d.h,c.height.val),h.y=(-j+d.y1+d.y2+M)/2}for(var n=0;n<this.length;n++){var i=this[n],a=i._private;(!a.compoundBoundsClean||t)&&(r(i),e.batching()||(a.compoundBoundsClean=!0))}return this};var ta=function(e){return e===1/0||e===-1/0?0:e},Ta=function(e,r,n,i,a){i-r===0||a-n===0||r==null||n==null||i==null||a==null||(e.x1=r<e.x1?r:e.x1,e.x2=i>e.x2?i:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=a>e.y2?a:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},Oo=function(e,r){return r==null?e:Ta(e,r.x1,r.y1,r.x2,r.y2)},Yf=function(e,r,n){return hi(e,r,n)},Ig=function(e,r,n){if(!r.cy().headless()){var i=r._private,a=i.rstyle,s=a.arrowWidth/2,o=r.pstyle(n+"-arrow-shape").value,l,u;if(o!=="none"){n==="source"?(l=a.srcX,u=a.srcY):n==="target"?(l=a.tgtX,u=a.tgtY):(l=a.midX,u=a.midY);var c=i.arrowBounds=i.arrowBounds||{},d=c[n]=c[n]||{};d.x1=l-s,d.y1=u-s,d.x2=l+s,d.y2=u+s,d.w=d.x2-d.x1,d.h=d.y2-d.y1,Tv(d,1),Ta(e,d.x1,d.y1,d.x2,d.y2)}}},_2=function(e,r,n){if(!r.cy().headless()){var i;n?i=n+"-":i="";var a=r._private,s=a.rstyle,o=r.pstyle(i+"label").strValue;if(o){var l=r.pstyle("text-halign"),u=r.pstyle("text-valign"),c=Yf(s,"labelWidth",n),d=Yf(s,"labelHeight",n),h=Yf(s,"labelX",n),m=Yf(s,"labelY",n),v=r.pstyle(i+"text-margin-x").pfValue,x=r.pstyle(i+"text-margin-y").pfValue,y=r.isEdge(),b=r.pstyle(i+"text-rotation"),S=r.pstyle("text-outline-width").pfValue,w=r.pstyle("text-border-width").pfValue,k=w/2,N=r.pstyle("text-background-padding").pfValue,T=2,j=d,M=c,A=M/2,P=j/2,D,R,I,U;if(y)D=h-A,R=h+A,I=m-P,U=m+P;else{switch(l.value){case"left":D=h-M,R=h;break;case"center":D=h-A,R=h+A;break;case"right":D=h,R=h+M;break}switch(u.value){case"top":I=m-j,U=m;break;case"center":I=m-P,U=m+P;break;case"bottom":I=m,U=m+j;break}}var B=v-Math.max(S,k)-N-T,z=v+Math.max(S,k)+N+T,F=x-Math.max(S,k)-N-T,V=x+Math.max(S,k)+N+T;D+=B,R+=z,I+=F,U+=V;var J=n||"main",Y=a.labelBounds,L=Y[J]=Y[J]||{};L.x1=D,L.y1=I,L.x2=R,L.y2=U,L.w=R-D,L.h=U-I,L.leftPad=B,L.rightPad=z,L.topPad=F,L.botPad=V;var G=y&&b.strValue==="autorotate",ee=b.pfValue!=null&&b.pfValue!==0;if(G||ee){var re=G?Yf(a.rstyle,"labelAngle",n):b.pfValue,se=Math.cos(re),de=Math.sin(re),W=(D+R)/2,ne=(I+U)/2;if(!y){switch(l.value){case"left":W=R;break;case"right":W=D;break}switch(u.value){case"top":ne=U;break;case"bottom":ne=I;break}}var ie=function(Te,Re){return Te=Te-W,Re=Re-ne,{x:Te*se-Re*de+W,y:Te*de+Re*se+ne}},$=ie(D,I),q=ie(D,U),te=ie(R,I),Z=ie(R,U);D=Math.min($.x,q.x,te.x,Z.x),R=Math.max($.x,q.x,te.x,Z.x),I=Math.min($.y,q.y,te.y,Z.y),U=Math.max($.y,q.y,te.y,Z.y)}var le=J+"Rot",ge=Y[le]=Y[le]||{};ge.x1=D,ge.y1=I,ge.x2=R,ge.y2=U,ge.w=R-D,ge.h=U-I,Ta(e,D,I,R,U),Ta(a.labelBounds.all,D,I,R,U)}return e}},f8=function(e,r){if(!r.cy().headless()){var n=r.pstyle("outline-opacity").value,i=r.pstyle("outline-width").value,a=r.pstyle("outline-offset").value,s=i+a;SR(e,r,n,s,"outside",s/2)}},SR=function(e,r,n,i,a,s){if(!(n===0||i<=0||a==="inside")){var o=r.cy(),l=r.pstyle("shape").value,u=o.renderer().nodeShapes[l],c=r.position(),d=c.x,h=c.y,m=r.width(),v=r.height();if(u.hasMiterBounds){a==="center"&&(i/=2);var x=u.miterBounds(d,h,m,v,i);Oo(e,x)}else s!=null&&s>0&&jv(e,[s,s,s,s])}},gW=function(e,r){if(!r.cy().headless()){var n=r.pstyle("border-opacity").value,i=r.pstyle("border-width").pfValue,a=r.pstyle("border-position").value;SR(e,r,n,i,a)}},vW=function(e,r){var n=e._private.cy,i=n.styleEnabled(),a=n.headless(),s=ei(),o=e._private,l=e.isNode(),u=e.isEdge(),c,d,h,m,v,x,y=o.rstyle,b=l&&i?e.pstyle("bounds-expansion").pfValue:[0],S=function(Ue){return Ue.pstyle("display").value!=="none"},w=!i||S(e)&&(!u||S(e.source())&&S(e.target()));if(w){var k=0,N=0;i&&r.includeOverlays&&(k=e.pstyle("overlay-opacity").value,k!==0&&(N=e.pstyle("overlay-padding").value));var T=0,j=0;i&&r.includeUnderlays&&(T=e.pstyle("underlay-opacity").value,T!==0&&(j=e.pstyle("underlay-padding").value));var M=Math.max(N,j),A=0,P=0;if(i&&(A=e.pstyle("width").pfValue,P=A/2),l&&r.includeNodes){var D=e.position();v=D.x,x=D.y;var R=e.outerWidth(),I=R/2,U=e.outerHeight(),B=U/2;c=v-I,d=v+I,h=x-B,m=x+B,Ta(s,c,h,d,m),i&&f8(s,e),i&&r.includeOutlines&&!a&&f8(s,e),i&&gW(s,e)}else if(u&&r.includeEdges)if(i&&!a){var z=e.pstyle("curve-style").strValue;if(c=Math.min(y.srcX,y.midX,y.tgtX),d=Math.max(y.srcX,y.midX,y.tgtX),h=Math.min(y.srcY,y.midY,y.tgtY),m=Math.max(y.srcY,y.midY,y.tgtY),c-=P,d+=P,h-=P,m+=P,Ta(s,c,h,d,m),z==="haystack"){var F=y.haystackPts;if(F&&F.length===2){if(c=F[0].x,h=F[0].y,d=F[1].x,m=F[1].y,c>d){var V=c;c=d,d=V}if(h>m){var J=h;h=m,m=J}Ta(s,c-P,h-P,d+P,m+P)}}else if(z==="bezier"||z==="unbundled-bezier"||Wo(z,"segments")||Wo(z,"taxi")){var Y;switch(z){case"bezier":case"unbundled-bezier":Y=y.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":Y=y.linePts;break}if(Y!=null)for(var L=0;L<Y.length;L++){var G=Y[L];c=G.x-P,d=G.x+P,h=G.y-P,m=G.y+P,Ta(s,c,h,d,m)}}}else{var ee=e.source(),re=ee.position(),se=e.target(),de=se.position();if(c=re.x,d=de.x,h=re.y,m=de.y,c>d){var W=c;c=d,d=W}if(h>m){var ne=h;h=m,m=ne}c-=P,d+=P,h-=P,m+=P,Ta(s,c,h,d,m)}if(i&&r.includeEdges&&u&&(Ig(s,e,"mid-source"),Ig(s,e,"mid-target"),Ig(s,e,"source"),Ig(s,e,"target")),i){var ie=e.pstyle("ghost").value==="yes";if(ie){var $=e.pstyle("ghost-offset-x").pfValue,q=e.pstyle("ghost-offset-y").pfValue;Ta(s,s.x1+$,s.y1+q,s.x2+$,s.y2+q)}}var te=o.bodyBounds=o.bodyBounds||{};QT(te,s),jv(te,b),Tv(te,1),i&&(c=s.x1,d=s.x2,h=s.y1,m=s.y2,Ta(s,c-M,h-M,d+M,m+M));var Z=o.overlayBounds=o.overlayBounds||{};QT(Z,s),jv(Z,b),Tv(Z,1);var le=o.labelBounds=o.labelBounds||{};le.all!=null?JU(le.all):le.all=ei(),i&&r.includeLabels&&(r.includeMainLabels&&_2(s,e,null),u&&(r.includeSourceLabels&&_2(s,e,"source"),r.includeTargetLabels&&_2(s,e,"target")))}return s.x1=ta(s.x1),s.y1=ta(s.y1),s.x2=ta(s.x2),s.y2=ta(s.y2),s.w=ta(s.x2-s.x1),s.h=ta(s.y2-s.y1),s.w>0&&s.h>0&&w&&(jv(s,b),Tv(s,1)),s},kR=function(e){var r=0,n=function(s){return(s?1:0)<<r++},i=0;return i+=n(e.incudeNodes),i+=n(e.includeEdges),i+=n(e.includeLabels),i+=n(e.includeMainLabels),i+=n(e.includeSourceLabels),i+=n(e.includeTargetLabels),i+=n(e.includeOverlays),i+=n(e.includeOutlines),i},CR=function(e){var r=function(o){return Math.round(o)};if(e.isEdge()){var n=e.source().position(),i=e.target().position();return HT([r(n.x),r(n.y),r(i.x),r(i.y)])}else{var a=e.position();return HT([r(a.x),r(a.y)])}},h8=function(e,r){var n=e._private,i,a=e.isEdge(),s=r==null?p8:kR(r),o=s===p8;if(n.bbCache==null?(i=vW(e,kp),n.bbCache=i,n.bbCachePosKey=CR(e)):i=n.bbCache,!o){var l=e.isNode();i=ei(),(r.includeNodes&&l||r.includeEdges&&!l)&&(r.includeOverlays?Oo(i,n.overlayBounds):Oo(i,n.bodyBounds)),r.includeLabels&&(r.includeMainLabels&&(!a||r.includeSourceLabels&&r.includeTargetLabels)?Oo(i,n.labelBounds.all):(r.includeMainLabels&&Oo(i,n.labelBounds.mainRot),r.includeSourceLabels&&Oo(i,n.labelBounds.sourceRot),r.includeTargetLabels&&Oo(i,n.labelBounds.targetRot))),i.w=i.x2-i.x1,i.h=i.y2-i.y1}return i},kp={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},p8=kR(kp),m8=Pn(kp);_l.boundingBox=function(t){var e,r=t===void 0||t.useCache===void 0||t.useCache===!0,n=Rd(function(c){var d=c._private;return d.bbCache==null||d.styleDirty||d.bbCachePosKey!==CR(c)},function(c){return c.id()});if(r&&this.length===1&&!n(this[0]))t===void 0?t=kp:t=m8(t),e=h8(this[0],t);else{e=ei(),t=t||kp;var i=m8(t),a=this,s=a.cy(),o=s.styleEnabled();this.edges().forEach(n),this.nodes().forEach(n),o&&this.recalculateRenderedStyle(r),this.updateCompoundBounds(!r);for(var l=0;l<a.length;l++){var u=a[l];n(u)&&u.dirtyBoundingBoxCache(),Oo(e,h8(u,i))}}return e.x1=ta(e.x1),e.y1=ta(e.y1),e.x2=ta(e.x2),e.y2=ta(e.y2),e.w=ta(e.x2-e.x1),e.h=ta(e.y2-e.y1),e};_l.dirtyBoundingBoxCache=function(){for(var t=0;t<this.length;t++){var e=this[t]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};_l.boundingBoxAt=function(t){var e=this.nodes(),r=this.cy(),n=r.hasCompoundNodes(),i=r.collection();if(n&&(i=e.filter(function(u){return u.isParent()}),e=e.not(i)),Mt(t)){var a=t;t=function(){return a}}var s=function(c,d){return c._private.bbAtOldPos=t(c,d)},o=function(c){return c._private.bbAtOldPos};r.startBatch(),e.forEach(s).silentPositions(t),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0));var l=QU(this.boundingBox({useCache:!1}));return e.silentPositions(o),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0)),r.endBatch(),l};wd.boundingbox=wd.bb=wd.boundingBox;wd.renderedBoundingbox=wd.renderedBoundingBox;var yW=_l,xh,im;xh=im={};var NR=function(e){e.uppercaseName=PT(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=PT(e.outerName),xh[e.name]=function(){var n=this[0],i=n._private,a=i.cy,s=a._private.styleEnabled;if(n)if(s){if(n.isParent())return n.updateCompoundBounds(),i[e.autoName]||0;var o=n.pstyle(e.name);switch(o.strValue){case"label":return n.recalculateRenderedStyle(),i.rstyle[e.labelName]||0;default:return o.pfValue}}else return 1},xh["outer"+e.uppercaseName]=function(){var n=this[0],i=n._private,a=i.cy,s=a._private.styleEnabled;if(n)if(s){var o=n[e.name](),l=n.pstyle("border-position").value,u;l==="center"?u=n.pstyle("border-width").pfValue:l==="outside"?u=2*n.pstyle("border-width").pfValue:u=0;var c=2*n.padding();return o+u+c}else return 1},xh["rendered"+e.uppercaseName]=function(){var n=this[0];if(n){var i=n[e.name]();return i*this.cy().zoom()}},xh["rendered"+e.uppercaseOuterName]=function(){var n=this[0];if(n){var i=n[e.outerName]();return i*this.cy().zoom()}}};NR({name:"width"});NR({name:"height"});im.padding=function(){var t=this[0],e=t._private;return t.isParent()?(t.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:t.pstyle("padding").pfValue):t.pstyle("padding").pfValue};im.paddedHeight=function(){var t=this[0];return t.height()+2*t.padding()};im.paddedWidth=function(){var t=this[0];return t.width()+2*t.padding()};var xW=im,bW=function(e,r){if(e.isEdge()&&e.takesUpSpace())return r(e)},wW=function(e,r){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy();return Zy(r(e),n.zoom(),n.pan())}},SW=function(e,r){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy(),i=n.pan(),a=n.zoom();return r(e).map(function(s){return Zy(s,a,i)})}},kW=function(e){return e.renderer().getControlPoints(e)},CW=function(e){return e.renderer().getSegmentPoints(e)},NW=function(e){return e.renderer().getSourceEndpoint(e)},EW=function(e){return e.renderer().getTargetEndpoint(e)},TW=function(e){return e.renderer().getEdgeMidpoint(e)},g8={controlPoints:{get:kW,mult:!0},segmentPoints:{get:CW,mult:!0},sourceEndpoint:{get:NW},targetEndpoint:{get:EW},midpoint:{get:TW}},jW=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},MW=Object.keys(g8).reduce(function(t,e){var r=g8[e],n=jW(e);return t[e]=function(){return bW(this,r.get)},r.mult?t[n]=function(){return SW(this,r.get)}:t[n]=function(){return wW(this,r.get)},t},{}),PW=Qe({},mW,yW,xW,MW);/*!
Event object based on jQuery events, MIT license

https://jquery.org/license/
https://tldrlegal.com/license/mit-license
https://github.com/jquery/jquery/blob/master/src/event.js
*/var ER=function(e,r){this.recycle(e,r)};function Xf(){return!1}function Lg(){return!0}ER.prototype={instanceString:function(){return"event"},recycle:function(e,r){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Xf,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?Lg:Xf):e!=null&&e.type?r=e:this.type=e,r!=null&&(this.originalEvent=r.originalEvent,this.type=r.type!=null?r.type:this.type,this.cy=r.cy,this.target=r.target,this.position=r.position,this.renderedPosition=r.renderedPosition,this.namespace=r.namespace,this.layout=r.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,i=this.cy.zoom(),a=this.cy.pan();this.renderedPosition={x:n.x*i+a.x,y:n.y*i+a.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=Lg;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=Lg;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Lg,this.stopPropagation()},isDefaultPrevented:Xf,isPropagationStopped:Xf,isImmediatePropagationStopped:Xf};var TR=/^([^.]+)(\.(?:[^.]+))?$/,_W=".*",jR={qualifierCompare:function(e,r){return e===r},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},v8=Object.keys(jR),AW={};function sx(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:AW,e=arguments.length>1?arguments[1]:void 0,r=0;r<v8.length;r++){var n=v8[r];this[n]=t[n]||jR[n]}this.context=e||this.context,this.listeners=[],this.emitting=0}var bl=sx.prototype,MR=function(e,r,n,i,a,s,o){vr(i)&&(a=i,i=null),o&&(s==null?s=o:s=Qe({},s,o));for(var l=Ht(n)?n:n.split(/\s+/),u=0;u<l.length;u++){var c=l[u];if(!ml(c)){var d=c.match(TR);if(d){var h=d[1],m=d[2]?d[2]:null,v=r(e,c,h,m,i,a,s);if(v===!1)break}}}},y8=function(e,r){return e.addEventFields(e.context,r),new ER(r.type,r)},RW=function(e,r,n){if(F$(n)){r(e,n);return}else if(Mt(n)){r(e,y8(e,n));return}for(var i=Ht(n)?n:n.split(/\s+/),a=0;a<i.length;a++){var s=i[a];if(!ml(s)){var o=s.match(TR);if(o){var l=o[1],u=o[2]?o[2]:null,c=y8(e,{type:l,namespace:u,target:e.context});r(e,c)}}}};bl.on=bl.addListener=function(t,e,r,n,i){return MR(this,function(a,s,o,l,u,c,d){vr(c)&&a.listeners.push({event:s,callback:c,type:o,namespace:l,qualifier:u,conf:d})},t,e,r,n,i),this};bl.one=function(t,e,r,n){return this.on(t,e,r,n,{one:!0})};bl.removeListener=bl.off=function(t,e,r,n){var i=this;this.emitting!==0&&(this.listeners=wU(this.listeners));for(var a=this.listeners,s=function(u){var c=a[u];MR(i,function(d,h,m,v,x,y){if((c.type===m||t==="*")&&(!v&&c.namespace!==".*"||c.namespace===v)&&(!x||d.qualifierCompare(c.qualifier,x))&&(!y||c.callback===y))return a.splice(u,1),!1},t,e,r,n)},o=a.length-1;o>=0;o--)s(o);return this};bl.removeAllListeners=function(){return this.removeListener("*")};bl.emit=bl.trigger=function(t,e,r){var n=this.listeners,i=n.length;return this.emitting++,Ht(e)||(e=[e]),RW(this,function(a,s){r!=null&&(n=[{event:s.event,type:s.type,namespace:s.namespace,callback:r}],i=n.length);for(var o=function(){var c=n[l];if(c.type===s.type&&(!c.namespace||c.namespace===s.namespace||c.namespace===_W)&&a.eventMatches(a.context,c,s)){var d=[s];e!=null&&kU(d,e),a.beforeEmit(a.context,c,s),c.conf&&c.conf.one&&(a.listeners=a.listeners.filter(function(v){return v!==c}));var h=a.callbackContext(a.context,c,s),m=c.callback.apply(h,d);a.afterEmit(a.context,c,s),m===!1&&(s.stopPropagation(),s.preventDefault())}},l=0;l<i;l++)o();a.bubble(a.context)&&!s.isPropagationStopped()&&a.parent(a.context).emit(s,e)},t),this.emitting--,this};var DW={qualifierCompare:function(e,r){return e==null||r==null?e==null&&r==null:e.sameText(r)},eventMatches:function(e,r,n){var i=r.qualifier;return i!=null?e!==n.target&&Jp(n.target)&&i.matches(n.target):!0},addEventFields:function(e,r){r.cy=e.cy(),r.target=e},callbackContext:function(e,r,n){return r.qualifier!=null?n.target:e},beforeEmit:function(e,r){r.conf&&r.conf.once&&r.conf.onceCollection.removeListener(r.event,r.qualifier,r.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},Bg=function(e){return Ke(e)?new yl(e):e},PR={createEmitter:function(){for(var e=0;e<this.length;e++){var r=this[e],n=r._private;n.emitter||(n.emitter=new sx(DW,r))}return this},emitter:function(){return this._private.emitter},on:function(e,r,n){for(var i=Bg(r),a=0;a<this.length;a++){var s=this[a];s.emitter().on(e,i,n)}return this},removeListener:function(e,r,n){for(var i=Bg(r),a=0;a<this.length;a++){var s=this[a];s.emitter().removeListener(e,i,n)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var r=this[e];r.emitter().removeAllListeners()}return this},one:function(e,r,n){for(var i=Bg(r),a=0;a<this.length;a++){var s=this[a];s.emitter().one(e,i,n)}return this},once:function(e,r,n){for(var i=Bg(r),a=0;a<this.length;a++){var s=this[a];s.emitter().on(e,i,n,{once:!0,onceCollection:this})}},emit:function(e,r){for(var n=0;n<this.length;n++){var i=this[n];i.emitter().emit(e,r)}return this},emitAndNotify:function(e,r){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,r),this}};It.eventAliasesOn(PR);var _R={nodes:function(e){return this.filter(function(r){return r.isNode()}).filter(e)},edges:function(e){return this.filter(function(r){return r.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),r=this.spawn(),n=0;n<this.length;n++){var i=this[n];i.isNode()?e.push(i):r.push(i)}return{nodes:e,edges:r}},filter:function(e,r){if(e===void 0)return this;if(Ke(e)||Ai(e))return new yl(e).filter(this);if(vr(e)){for(var n=this.spawn(),i=this,a=0;a<i.length;a++){var s=i[a],o=r?e.apply(r,[s,a,i]):e(s,a,i);o&&n.push(s)}return n}return this.spawn()},not:function(e){if(e){Ke(e)&&(e=this.filter(e));for(var r=this.spawn(),n=0;n<this.length;n++){var i=this[n],a=e.has(i);a||r.push(i)}return r}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(Ke(e)){var r=e;return this.filter(r)}for(var n=this.spawn(),i=this,a=e,s=this.length<e.length,o=s?i:a,l=s?a:i,u=0;u<o.length;u++){var c=o[u];l.has(c)&&n.push(c)}return n},xor:function(e){var r=this._private.cy;Ke(e)&&(e=r.$(e));var n=this.spawn(),i=this,a=e,s=function(l,u){for(var c=0;c<l.length;c++){var d=l[c],h=d._private.data.id,m=u.hasElementWithId(h);m||n.push(d)}};return s(i,a),s(a,i),n},diff:function(e){var r=this._private.cy;Ke(e)&&(e=r.$(e));var n=this.spawn(),i=this.spawn(),a=this.spawn(),s=this,o=e,l=function(c,d,h){for(var m=0;m<c.length;m++){var v=c[m],x=v._private.data.id,y=d.hasElementWithId(x);y?a.merge(v):h.push(v)}};return l(s,o,n),l(o,s,i),{left:n,right:i,both:a}},add:function(e){var r=this._private.cy;if(!e)return this;if(Ke(e)){var n=e;e=r.mutableElements().filter(n)}for(var i=this.spawnSelf(),a=0;a<e.length;a++){var s=e[a],o=!this.has(s);o&&i.push(s)}return i},merge:function(e){var r=this._private,n=r.cy;if(!e)return this;if(e&&Ke(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=r.map,s=0;s<e.length;s++){var o=e[s],l=o._private.data.id,u=!a.has(l);if(u){var c=this.length++;this[c]=o,a.set(l,{ele:o,index:c})}}return this},unmergeAt:function(e){var r=this[e],n=r.id(),i=this._private,a=i.map;this[e]=void 0,a.delete(n);var s=e===this.length-1;if(this.length>1&&!s){var o=this.length-1,l=this[o],u=l._private.data.id;this[o]=void 0,this[e]=l,a.set(u,{ele:l,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var r=this._private,n=e._private.data.id,i=r.map,a=i.get(n);if(!a)return this;var s=a.index;return this.unmergeAt(s),this},unmerge:function(e){var r=this._private.cy;if(!e)return this;if(e&&Ke(e)){var n=e;e=r.mutableElements().filter(n)}for(var i=0;i<e.length;i++)this.unmergeOne(e[i]);return this},unmergeBy:function(e){for(var r=this.length-1;r>=0;r--){var n=this[r];e(n)&&this.unmergeAt(r)}return this},map:function(e,r){for(var n=[],i=this,a=0;a<i.length;a++){var s=i[a],o=r?e.apply(r,[s,a,i]):e(s,a,i);n.push(o)}return n},reduce:function(e,r){for(var n=r,i=this,a=0;a<i.length;a++)n=e(n,i[a],a,i);return n},max:function(e,r){for(var n=-1/0,i,a=this,s=0;s<a.length;s++){var o=a[s],l=r?e.apply(r,[o,s,a]):e(o,s,a);l>n&&(n=l,i=o)}return{value:n,ele:i}},min:function(e,r){for(var n=1/0,i,a=this,s=0;s<a.length;s++){var o=a[s],l=r?e.apply(r,[o,s,a]):e(o,s,a);l<n&&(n=l,i=o)}return{value:n,ele:i}}},Rt=_R;Rt.u=Rt["|"]=Rt["+"]=Rt.union=Rt.or=Rt.add;Rt["\\"]=Rt["!"]=Rt["-"]=Rt.difference=Rt.relativeComplement=Rt.subtract=Rt.not;Rt.n=Rt["&"]=Rt["."]=Rt.and=Rt.intersection=Rt.intersect;Rt["^"]=Rt["(+)"]=Rt["(-)"]=Rt.symmetricDifference=Rt.symdiff=Rt.xor;Rt.fnFilter=Rt.filterFn=Rt.stdFilter=Rt.filter;Rt.complement=Rt.abscomp=Rt.absoluteComplement;var OW={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},AR=function(e,r){var n=e.cy(),i=n.hasCompoundNodes();function a(c){var d=c.pstyle("z-compound-depth");return d.value==="auto"?i?c.zDepth():0:d.value==="bottom"?-1:d.value==="top"?QC:0}var s=a(e)-a(r);if(s!==0)return s;function o(c){var d=c.pstyle("z-index-compare");return d.value==="auto"&&c.isNode()?1:0}var l=o(e)-o(r);if(l!==0)return l;var u=e.pstyle("z-index").value-r.pstyle("z-index").value;return u!==0?u:e.poolIndex()-r.poolIndex()},T0={forEach:function(e,r){if(vr(e))for(var n=this.length,i=0;i<n;i++){var a=this[i],s=r?e.apply(r,[a,i,this]):e(a,i,this);if(s===!1)break}return this},toArray:function(){for(var e=[],r=0;r<this.length;r++)e.push(this[r]);return e},slice:function(e,r){var n=[],i=this.length;r==null&&(r=i),e==null&&(e=0),e<0&&(e=i+e),r<0&&(r=i+r);for(var a=e;a>=0&&a<r&&a<i;a++)n.push(this[a]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!vr(e))return this;var r=this.toArray().sort(e);return this.spawn(r)},sortByZIndex:function(){return this.sort(AR)},zDepth:function(){var e=this[0];if(e){var r=e._private,n=r.group;if(n==="nodes"){var i=r.data.parent?e.parents().size():0;return e.isParent()?i:QC-1}else{var a=r.source,s=r.target,o=a.zDepth(),l=s.zDepth();return Math.max(o,l,0)}}}};T0.each=T0.forEach;var IW=function(){var e="undefined",r=(typeof Symbol>"u"?"undefined":Zr(Symbol))!=e&&Zr(Symbol.iterator)!=e;r&&(T0[Symbol.iterator]=function(){var n=this,i={value:void 0,done:!1},a=0,s=this.length;return PA({next:function(){return a<s?i.value=n[a++]:(i.value=void 0,i.done=!0),i}},Symbol.iterator,function(){return this})})};IW();var LW=Pn({nodeDimensionsIncludeLabels:!1}),Pv={layoutDimensions:function(e){e=LW(e);var r;if(!this.takesUpSpace())r={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();r={w:n.w,h:n.h}}else r={w:this.outerWidth(),h:this.outerHeight()};return(r.w===0||r.h===0)&&(r.w=r.h=1),r},layoutPositions:function(e,r,n){var i=this.nodes().filter(function(N){return!N.isParent()}),a=this.cy(),s=r.eles,o=function(T){return T.id()},l=Rd(n,o);e.emit({type:"layoutstart",layout:e}),e.animations=[];var u=function(T,j,M){var A={x:j.x1+j.w/2,y:j.y1+j.h/2},P={x:(M.x-A.x)*T,y:(M.y-A.y)*T};return{x:A.x+P.x,y:A.y+P.y}},c=r.spacingFactor&&r.spacingFactor!==1,d=function(){if(!c)return null;for(var T=ei(),j=0;j<i.length;j++){var M=i[j],A=l(M,j);XA(T,A.x,A.y)}return T},h=d(),m=Rd(function(N,T){var j=l(N,T);if(c){var M=Math.abs(r.spacingFactor);j=u(M,h,j)}return r.transform!=null&&(j=r.transform(N,j)),j},o);if(r.animate){for(var v=0;v<i.length;v++){var x=i[v],y=m(x,v),b=r.animateFilter==null||r.animateFilter(x,v);if(b){var S=x.animation({position:y,duration:r.animationDuration,easing:r.animationEasing});e.animations.push(S)}else x.position(y)}if(r.fit){var w=a.animation({fit:{boundingBox:s.boundingBoxAt(m),padding:r.padding},duration:r.animationDuration,easing:r.animationEasing});e.animations.push(w)}else if(r.zoom!==void 0&&r.pan!==void 0){var k=a.animation({zoom:r.zoom,pan:r.pan,duration:r.animationDuration,easing:r.animationEasing});e.animations.push(k)}e.animations.forEach(function(N){return N.play()}),e.one("layoutready",r.ready),e.emit({type:"layoutready",layout:e}),nf.all(e.animations.map(function(N){return N.promise()})).then(function(){e.one("layoutstop",r.stop),e.emit({type:"layoutstop",layout:e})})}else i.positions(m),r.fit&&a.fit(r.eles,r.padding),r.zoom!=null&&a.zoom(r.zoom),r.pan&&a.pan(r.pan),e.one("layoutready",r.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",r.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var r=this.cy();return r.makeLayout(Qe({},e,{eles:this}))}};Pv.createLayout=Pv.makeLayout=Pv.layout;function RR(t,e,r){var n=r._private,i=n.styleCache=n.styleCache||[],a;return(a=i[t])!=null||(a=i[t]=e(r)),a}function ox(t,e){return t=Bu(t),function(n){return RR(t,e,n)}}function lx(t,e){t=Bu(t);var r=function(i){return e.call(i)};return function(){var i=this[0];if(i)return RR(t,r,i)}}var En={recalculateRenderedStyle:function(e){var r=this.cy(),n=r.renderer(),i=r.styleEnabled();return n&&i&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),r=function(a){return a._private.styleCache=null};if(e.hasCompoundNodes()){var n;n=this.spawnSelf().merge(this.descendants()).merge(this.parents()),n.merge(n.connectedEdges()),n.forEach(r)}else this.forEach(function(i){r(i),i.connectedEdges().forEach(r)});return this},updateStyle:function(e){var r=this._private.cy;if(!r.styleEnabled())return this;if(r.batching()){var n=r._private.batchStyleEles;return n.merge(this),this}var i=r.hasCompoundNodes(),a=this;e=!!(e||e===void 0),i&&(a=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var s=a;return e?s.emitAndNotify("style"):s.emit("style"),a.forEach(function(o){return o._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var r=0;r<this.length;r++){var n=this[r];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this[0],i=n.cy();if(i.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,i.style().apply(n));var a=n._private.style[e];return a??(r?i.style().getDefaultProperty(e):null)}},numericStyle:function(e){var r=this[0];if(r.cy().styleEnabled()&&r){var n=r.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var r=this[0];if(r.cy().styleEnabled()&&r)return r.pstyle(e).units},renderedStyle:function(e){var r=this.cy();if(!r.styleEnabled())return this;var n=this[0];if(n)return r.style().getRenderedStyle(n,e)},style:function(e,r){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style();if(Mt(e)){var s=e;a.applyBypass(this,s,i),this.emitAndNotify("style")}else if(Ke(e))if(r===void 0){var o=this[0];return o?a.getStylePropertyValue(o,e):void 0}else a.applyBypass(this,e,r,i),this.emitAndNotify("style");else if(e===void 0){var l=this[0];return l?a.getRawStyle(l):void 0}return this},removeStyle:function(e){var r=this.cy();if(!r.styleEnabled())return this;var n=!1,i=r.style(),a=this;if(e===void 0)for(var s=0;s<a.length;s++){var o=a[s];i.removeAllBypasses(o,n)}else{e=e.split(/\s+/);for(var l=0;l<a.length;l++){var u=a[l];i.removeBypasses(u,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var r=e.hasCompoundNodes(),n=this[0];if(n){var i=n._private,a=n.pstyle("opacity").value;if(!r)return a;var s=i.data.parent?n.parents():null;if(s)for(var o=0;o<s.length;o++){var l=s[o],u=l.pstyle("opacity").value;a=u*a}return a}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var r=this[0],n=r.cy().hasCompoundNodes();if(r)return n?r.effectiveOpacity()===0:r.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var r=this[0];return!!r._private.backgrounding}};function A2(t,e){var r=t._private,n=r.data.parent?t.parents():null;if(n)for(var i=0;i<n.length;i++){var a=n[i];if(!e(a))return!1}return!0}function u3(t){var e=t.ok,r=t.edgeOkViaNode||t.ok,n=t.parentOk||t.ok;return function(){var i=this.cy();if(!i.styleEnabled())return!0;var a=this[0],s=i.hasCompoundNodes();if(a){var o=a._private;if(!e(a))return!1;if(a.isNode())return!s||A2(a,n);var l=o.source,u=o.target;return r(l)&&(!s||A2(l,r))&&(l===u||r(u)&&(!s||A2(u,r)))}}}var af=ox("eleTakesUpSpace",function(t){return t.pstyle("display").value==="element"&&t.width()!==0&&(t.isNode()?t.height()!==0:!0)});En.takesUpSpace=lx("takesUpSpace",u3({ok:af}));var BW=ox("eleInteractive",function(t){return t.pstyle("events").value==="yes"&&t.pstyle("visibility").value==="visible"&&af(t)}),FW=ox("parentInteractive",function(t){return t.pstyle("visibility").value==="visible"&&af(t)});En.interactive=lx("interactive",u3({ok:BW,parentOk:FW,edgeOkViaNode:af}));En.noninteractive=function(){var t=this[0];if(t)return!t.interactive()};var zW=ox("eleVisible",function(t){return t.pstyle("visibility").value==="visible"&&t.pstyle("opacity").pfValue!==0&&af(t)}),VW=af;En.visible=lx("visible",u3({ok:zW,edgeOkViaNode:VW}));En.hidden=function(){var t=this[0];if(t)return!t.visible()};En.isBundledBezier=lx("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});En.bypass=En.css=En.style;En.renderedCss=En.renderedStyle;En.removeBypass=En.removeCss=En.removeStyle;En.pstyle=En.parsedStyle;var ll={};function x8(t){return function(){var e=arguments,r=[];if(e.length===2){var n=e[0],i=e[1];this.on(t.event,n,i)}else if(e.length===1&&vr(e[0])){var a=e[0];this.on(t.event,a)}else if(e.length===0||e.length===1&&Ht(e[0])){for(var s=e.length===1?e[0]:null,o=0;o<this.length;o++){var l=this[o],u=!t.ableField||l._private[t.ableField],c=l._private[t.field]!=t.value;if(t.overrideAble){var d=t.overrideAble(l);if(d!==void 0&&(u=d,!d))return this}u&&(l._private[t.field]=t.value,c&&r.push(l))}var h=this.spawn(r);h.updateStyle(),h.emit(t.event),s&&h.emit(s)}return this}}function sf(t){ll[t.field]=function(){var e=this[0];if(e){if(t.overrideField){var r=t.overrideField(e);if(r!==void 0)return r}return e._private[t.field]}},ll[t.on]=x8({event:t.on,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!0}),ll[t.off]=x8({event:t.off,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!1})}sf({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});sf({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});sf({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});sf({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});ll.deselect=ll.unselect;ll.grabbed=function(){var t=this[0];if(t)return t._private.grabbed};sf({field:"active",on:"activate",off:"unactivate"});sf({field:"pannable",on:"panify",off:"unpanify"});ll.inactive=function(){var t=this[0];if(t)return!t._private.active};var Gn={},b8=function(e){return function(n){for(var i=this,a=[],s=0;s<i.length;s++){var o=i[s];if(o.isNode()){for(var l=!1,u=o.connectedEdges(),c=0;c<u.length;c++){var d=u[c],h=d.source(),m=d.target();if(e.noIncomingEdges&&m===o&&h!==o||e.noOutgoingEdges&&h===o&&m!==o){l=!0;break}}l||a.push(o)}}return this.spawn(a,!0).filter(n)}},w8=function(e){return function(r){for(var n=this,i=[],a=0;a<n.length;a++){var s=n[a];if(s.isNode())for(var o=s.connectedEdges(),l=0;l<o.length;l++){var u=o[l],c=u.source(),d=u.target();e.outgoing&&c===s?(i.push(u),i.push(d)):e.incoming&&d===s&&(i.push(u),i.push(c))}}return this.spawn(i,!0).filter(r)}},S8=function(e){return function(r){for(var n=this,i=[],a={};;){var s=e.outgoing?n.outgoers():n.incomers();if(s.length===0)break;for(var o=!1,l=0;l<s.length;l++){var u=s[l],c=u.id();a[c]||(a[c]=!0,i.push(u),o=!0)}if(!o)break;n=s}return this.spawn(i,!0).filter(r)}};Gn.clearTraversalCache=function(){for(var t=0;t<this.length;t++)this[t]._private.traversalCache=null};Qe(Gn,{roots:b8({noIncomingEdges:!0}),leaves:b8({noOutgoingEdges:!0}),outgoers:ia(w8({outgoing:!0}),"outgoers"),successors:S8({outgoing:!0}),incomers:ia(w8({incoming:!0}),"incomers"),predecessors:S8({})});Qe(Gn,{neighborhood:ia(function(t){for(var e=[],r=this.nodes(),n=0;n<r.length;n++)for(var i=r[n],a=i.connectedEdges(),s=0;s<a.length;s++){var o=a[s],l=o.source(),u=o.target(),c=i===l?u:l;c.length>0&&e.push(c[0]),e.push(o[0])}return this.spawn(e,!0).filter(t)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});Gn.neighbourhood=Gn.neighborhood;Gn.closedNeighbourhood=Gn.closedNeighborhood;Gn.openNeighbourhood=Gn.openNeighborhood;Qe(Gn,{source:ia(function(e){var r=this[0],n;return r&&(n=r._private.source||r.cy().collection()),n&&e?n.filter(e):n},"source"),target:ia(function(e){var r=this[0],n;return r&&(n=r._private.target||r.cy().collection()),n&&e?n.filter(e):n},"target"),sources:k8({attr:"source"}),targets:k8({attr:"target"})});function k8(t){return function(r){for(var n=[],i=0;i<this.length;i++){var a=this[i],s=a._private[t.attr];s&&n.push(s)}return this.spawn(n,!0).filter(r)}}Qe(Gn,{edgesWith:ia(C8(),"edgesWith"),edgesTo:ia(C8({thisIsSrc:!0}),"edgesTo")});function C8(t){return function(r){var n=[],i=this._private.cy,a=t||{};Ke(r)&&(r=i.$(r));for(var s=0;s<r.length;s++)for(var o=r[s]._private.edges,l=0;l<o.length;l++){var u=o[l],c=u._private.data,d=this.hasElementWithId(c.source)&&r.hasElementWithId(c.target),h=r.hasElementWithId(c.source)&&this.hasElementWithId(c.target),m=d||h;m&&((a.thisIsSrc||a.thisIsTgt)&&(a.thisIsSrc&&!d||a.thisIsTgt&&!h)||n.push(u))}return this.spawn(n,!0)}}Qe(Gn,{connectedEdges:ia(function(t){for(var e=[],r=this,n=0;n<r.length;n++){var i=r[n];if(i.isNode())for(var a=i._private.edges,s=0;s<a.length;s++){var o=a[s];e.push(o)}}return this.spawn(e,!0).filter(t)},"connectedEdges"),connectedNodes:ia(function(t){for(var e=[],r=this,n=0;n<r.length;n++){var i=r[n];i.isEdge()&&(e.push(i.source()[0]),e.push(i.target()[0]))}return this.spawn(e,!0).filter(t)},"connectedNodes"),parallelEdges:ia(N8(),"parallelEdges"),codirectedEdges:ia(N8({codirected:!0}),"codirectedEdges")});function N8(t){var e={codirected:!1};return t=Qe({},e,t),function(n){for(var i=[],a=this.edges(),s=t,o=0;o<a.length;o++)for(var l=a[o],u=l._private,c=u.source,d=c._private.data.id,h=u.data.target,m=c._private.edges,v=0;v<m.length;v++){var x=m[v],y=x._private.data,b=y.target,S=y.source,w=b===h&&S===d,k=d===b&&h===S;(s.codirected&&w||!s.codirected&&(w||k))&&i.push(x)}return this.spawn(i,!0).filter(n)}}Qe(Gn,{components:function(e){var r=this,n=r.cy(),i=n.collection(),a=e==null?r.nodes():e.nodes(),s=[];e!=null&&a.empty()&&(a=e.sources());var o=function(c,d){i.merge(c),a.unmerge(c),d.merge(c)};if(a.empty())return r.spawn();var l=function(){var c=n.collection();s.push(c);var d=a[0];o(d,c),r.bfs({directed:!1,roots:d,visit:function(m){return o(m,c)}}),c.forEach(function(h){h.connectedEdges().forEach(function(m){r.has(m)&&c.has(m.source())&&c.has(m.target())&&c.merge(m)})})};do l();while(a.length>0);return s},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});Gn.componentsOf=Gn.components;var Tn=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){lr("A collection must have a reference to the core");return}var a=new Us,s=!1;if(!r)r=[];else if(r.length>0&&Mt(r[0])&&!Jp(r[0])){s=!0;for(var o=[],l=new rf,u=0,c=r.length;u<c;u++){var d=r[u];d.data==null&&(d.data={});var h=d.data;if(h.id==null)h.id=qA();else if(e.hasElementWithId(h.id)||l.has(h.id))continue;var m=new Jy(e,d,!1);o.push(m),l.add(h.id)}r=o}this.length=0;for(var v=0,x=r.length;v<x;v++){var y=r[v][0];if(y!=null){var b=y._private.data.id;(!n||!a.has(b))&&(n&&a.set(b,{index:this.length,ele:y}),this[this.length]=y,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(S){this.lazyMap=S},rebuildMap:function(){for(var w=this.lazyMap=new Us,k=this.eles,N=0;N<k.length;N++){var T=k[N];w.set(T.id(),{index:N,ele:T})}}},n&&(this._private.map=a),s&&!i&&this.restore()},Qt=Jy.prototype=Tn.prototype=Object.create(Array.prototype);Qt.instanceString=function(){return"collection"};Qt.spawn=function(t,e){return new Tn(this.cy(),t,e)};Qt.spawnSelf=function(){return this.spawn(this)};Qt.cy=function(){return this._private.cy};Qt.renderer=function(){return this._private.cy.renderer()};Qt.element=function(){return this[0]};Qt.collection=function(){return RA(this)?this:new Tn(this._private.cy,[this])};Qt.unique=function(){return new Tn(this._private.cy,this,!0)};Qt.hasElementWithId=function(t){return t=""+t,this._private.map.has(t)};Qt.getElementById=function(t){t=""+t;var e=this._private.cy,r=this._private.map.get(t);return r?r.ele:new Tn(e)};Qt.$id=Qt.getElementById;Qt.poolIndex=function(){var t=this._private.cy,e=t._private.elements,r=this[0]._private.data.id;return e._private.map.get(r).index};Qt.indexOf=function(t){var e=t[0]._private.data.id;return this._private.map.get(e).index};Qt.indexOfId=function(t){return t=""+t,this._private.map.get(t).index};Qt.json=function(t){var e=this.element(),r=this.cy();if(e==null&&t)return this;if(e!=null){var n=e._private;if(Mt(t)){if(r.startBatch(),t.data){e.data(t.data);var i=n.data;if(e.isEdge()){var a=!1,s={},o=t.data.source,l=t.data.target;o!=null&&o!=i.source&&(s.source=""+o,a=!0),l!=null&&l!=i.target&&(s.target=""+l,a=!0),a&&(e=e.move(s))}else{var u="parent"in t.data,c=t.data.parent;u&&(c!=null||i.parent!=null)&&c!=i.parent&&(c===void 0&&(c=null),c!=null&&(c=""+c),e=e.move({parent:c}))}}t.position&&e.position(t.position);var d=function(x,y,b){var S=t[x];S!=null&&S!==n[x]&&(S?e[y]():e[b]())};return d("removed","remove","restore"),d("selected","select","unselect"),d("selectable","selectify","unselectify"),d("locked","lock","unlock"),d("grabbable","grabify","ungrabify"),d("pannable","panify","unpanify"),t.classes!=null&&e.classes(t.classes),r.endBatch(),this}else if(t===void 0){var h={data:ss(n.data),position:ss(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};h.classes="";var m=0;return n.classes.forEach(function(v){return h.classes+=m++===0?v:" "+v}),h}}};Qt.jsons=function(){for(var t=[],e=0;e<this.length;e++){var r=this[e],n=r.json();t.push(n)}return t};Qt.clone=function(){for(var t=this.cy(),e=[],r=0;r<this.length;r++){var n=this[r],i=n.json(),a=new Jy(t,i,!1);e.push(a)}return new Tn(t,e)};Qt.copy=Qt.clone;Qt.restore=function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,n=r.cy(),i=n._private,a=[],s=[],o,l=0,u=r.length;l<u;l++){var c=r[l];e&&!c.removed()||(c.isNode()?a.push(c):s.push(c))}o=a.concat(s);var d,h=function(){o.splice(d,1),d--};for(d=0;d<o.length;d++){var m=o[d],v=m._private,x=v.data;if(m.clearTraversalCache(),!(!e&&!v.removed)){if(x.id===void 0)x.id=qA();else if(Ee(x.id))x.id=""+x.id;else if(ml(x.id)||!Ke(x.id)){lr("Can not create element with invalid string ID `"+x.id+"`"),h();continue}else if(n.hasElementWithId(x.id)){lr("Can not create second element with ID `"+x.id+"`"),h();continue}}var y=x.id;if(m.isNode()){var b=v.position;b.x==null&&(b.x=0),b.y==null&&(b.y=0)}if(m.isEdge()){for(var S=m,w=["source","target"],k=w.length,N=!1,T=0;T<k;T++){var j=w[T],M=x[j];Ee(M)&&(M=x[j]=""+x[j]),M==null||M===""?(lr("Can not create edge `"+y+"` with unspecified "+j),N=!0):n.hasElementWithId(M)||(lr("Can not create edge `"+y+"` with nonexistant "+j+" `"+M+"`"),N=!0)}if(N){h();continue}var A=n.getElementById(x.source),P=n.getElementById(x.target);A.same(P)?A._private.edges.push(S):(A._private.edges.push(S),P._private.edges.push(S)),S._private.source=A,S._private.target=P}v.map=new Us,v.map.set(y,{ele:m,index:0}),v.removed=!1,e&&n.addToPool(m)}for(var D=0;D<a.length;D++){var R=a[D],I=R._private.data;Ee(I.parent)&&(I.parent=""+I.parent);var U=I.parent,B=U!=null;if(B||R._private.parent){var z=R._private.parent?n.collection().merge(R._private.parent):n.getElementById(U);if(z.empty())I.parent=void 0;else if(z[0].removed())Lt("Node added with missing parent, reference to parent removed"),I.parent=void 0,R._private.parent=null;else{for(var F=!1,V=z;!V.empty();){if(R.same(V)){F=!0,I.parent=void 0;break}V=V.parent()}F||(z[0]._private.children.push(R),R._private.parent=z[0],i.hasCompoundNodes=!0)}}}if(o.length>0){for(var J=o.length===r.length?r:new Tn(n,o),Y=0;Y<J.length;Y++){var L=J[Y];L.isNode()||(L.parallelEdges().clearTraversalCache(),L.source().clearTraversalCache(),L.target().clearTraversalCache())}var G;i.hasCompoundNodes?G=n.collection().merge(J).merge(J.connectedNodes()).merge(J.parent()):G=J,G.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(t),t?J.emitAndNotify("add"):e&&J.emit("add")}return r};Qt.removed=function(){var t=this[0];return t&&t._private.removed};Qt.inside=function(){var t=this[0];return t&&!t._private.removed};Qt.remove=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,n=[],i={},a=r._private.cy;function s(U){for(var B=U._private.edges,z=0;z<B.length;z++)l(B[z])}function o(U){for(var B=U._private.children,z=0;z<B.length;z++)l(B[z])}function l(U){var B=i[U.id()];e&&U.removed()||B||(i[U.id()]=!0,U.isNode()?(n.push(U),s(U),o(U)):n.unshift(U))}for(var u=0,c=r.length;u<c;u++){var d=r[u];l(d)}function h(U,B){var z=U._private.edges;gl(z,B),U.clearTraversalCache()}function m(U){U.clearTraversalCache()}var v=[];v.ids={};function x(U,B){B=B[0],U=U[0];var z=U._private.children,F=U.id();gl(z,B),B._private.parent=null,v.ids[F]||(v.ids[F]=!0,v.push(U))}r.dirtyCompoundBoundsCache(),e&&a.removeFromPool(n);for(var y=0;y<n.length;y++){var b=n[y];if(b.isEdge()){var S=b.source()[0],w=b.target()[0];h(S,b),h(w,b);for(var k=b.parallelEdges(),N=0;N<k.length;N++){var T=k[N];m(T),T.isBundledBezier()&&T.dirtyBoundingBoxCache()}}else{var j=b.parent();j.length!==0&&x(j,b)}e&&(b._private.removed=!0)}var M=a._private.elements;a._private.hasCompoundNodes=!1;for(var A=0;A<M.length;A++){var P=M[A];if(P.isParent()){a._private.hasCompoundNodes=!0;break}}var D=new Tn(this.cy(),n);D.size()>0&&(t?D.emitAndNotify("remove"):e&&D.emit("remove"));for(var R=0;R<v.length;R++){var I=v[R];(!e||!I.removed())&&I.updateStyle()}return D};Qt.move=function(t){var e=this._private.cy,r=this,n=!1,i=!1,a=function(v){return v==null?v:""+v};if(t.source!==void 0||t.target!==void 0){var s=a(t.source),o=a(t.target),l=s!=null&&e.hasElementWithId(s),u=o!=null&&e.hasElementWithId(o);(l||u)&&(e.batch(function(){r.remove(n,i),r.emitAndNotify("moveout");for(var m=0;m<r.length;m++){var v=r[m],x=v._private.data;v.isEdge()&&(l&&(x.source=s),u&&(x.target=o))}r.restore(n,i)}),r.emitAndNotify("move"))}else if(t.parent!==void 0){var c=a(t.parent),d=c===null||e.hasElementWithId(c);if(d){var h=c===null?void 0:c;e.batch(function(){var m=r.remove(n,i);m.emitAndNotify("moveout");for(var v=0;v<r.length;v++){var x=r[v],y=x._private.data;x.isNode()&&(y.parent=h)}m.restore(n,i)}),r.emitAndNotify("move")}}return this};[aR,JH,Mv,ol,Od,pW,ax,PW,PR,_R,OW,T0,Pv,En,ll,Gn].forEach(function(t){Qe(Qt,t)});var $W={add:function(e){var r,n=this;if(Ai(e)){var i=e;if(i._private.cy===n)r=i.restore();else{for(var a=[],s=0;s<i.length;s++){var o=i[s];a.push(o.json())}r=new Tn(n,a)}}else if(Ht(e)){var l=e;r=new Tn(n,l)}else if(Mt(e)&&(Ht(e.nodes)||Ht(e.edges))){for(var u=e,c=[],d=["nodes","edges"],h=0,m=d.length;h<m;h++){var v=d[h],x=u[v];if(Ht(x))for(var y=0,b=x.length;y<b;y++){var S=Qe({group:v},x[y]);c.push(S)}}r=new Tn(n,c)}else{var w=e;r=new Jy(n,w).collection()}return r},remove:function(e){if(!Ai(e)){if(Ke(e)){var r=e;e=this.$(r)}}return e.remove()}};/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */function UW(t,e,r,n){var i=4,a=.001,s=1e-7,o=10,l=11,u=1/(l-1),c=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var d=0;d<4;++d)if(typeof arguments[d]!="number"||isNaN(arguments[d])||!isFinite(arguments[d]))return!1;t=Math.min(t,1),r=Math.min(r,1),t=Math.max(t,0),r=Math.max(r,0);var h=c?new Float32Array(l):new Array(l);function m(P,D){return 1-3*D+3*P}function v(P,D){return 3*D-6*P}function x(P){return 3*P}function y(P,D,R){return((m(D,R)*P+v(D,R))*P+x(D))*P}function b(P,D,R){return 3*m(D,R)*P*P+2*v(D,R)*P+x(D)}function S(P,D){for(var R=0;R<i;++R){var I=b(D,t,r);if(I===0)return D;var U=y(D,t,r)-P;D-=U/I}return D}function w(){for(var P=0;P<l;++P)h[P]=y(P*u,t,r)}function k(P,D,R){var I,U,B=0;do U=D+(R-D)/2,I=y(U,t,r)-P,I>0?R=U:D=U;while(Math.abs(I)>s&&++B<o);return U}function N(P){for(var D=0,R=1,I=l-1;R!==I&&h[R]<=P;++R)D+=u;--R;var U=(P-h[R])/(h[R+1]-h[R]),B=D+U*u,z=b(B,t,r);return z>=a?S(P,B):z===0?B:k(P,D,D+u)}var T=!1;function j(){T=!0,(t!==e||r!==n)&&w()}var M=function(D){return T||j(),t===e&&r===n?D:D===0?0:D===1?1:y(N(D),e,n)};M.getControlPoints=function(){return[{x:t,y:e},{x:r,y:n}]};var A="generateBezier("+[t,e,r,n]+")";return M.toString=function(){return A},M}/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */var GW=function(){function t(n){return-n.tension*n.x-n.friction*n.v}function e(n,i,a){var s={x:n.x+a.dx*i,v:n.v+a.dv*i,tension:n.tension,friction:n.friction};return{dx:s.v,dv:t(s)}}function r(n,i){var a={dx:n.v,dv:t(n)},s=e(n,i*.5,a),o=e(n,i*.5,s),l=e(n,i,o),u=1/6*(a.dx+2*(s.dx+o.dx)+l.dx),c=1/6*(a.dv+2*(s.dv+o.dv)+l.dv);return n.x=n.x+u*i,n.v=n.v+c*i,n}return function n(i,a,s){var o={x:-1,v:0,tension:null,friction:null},l=[0],u=0,c=1/1e4,d=16/1e3,h,m,v;for(i=parseFloat(i)||500,a=parseFloat(a)||20,s=s||null,o.tension=i,o.friction=a,h=s!==null,h?(u=n(i,a),m=u/s*d):m=d;v=r(v||o,m),l.push(1+v.x),u+=16,Math.abs(v.x)>c&&Math.abs(v.v)>c;);return h?function(x){return l[x*(l.length-1)|0]}:u}}(),Yt=function(e,r,n,i){var a=UW(e,r,n,i);return function(s,o,l){return s+(o-s)*a(l)}},_v={linear:function(e,r,n){return e+(r-e)*n},ease:Yt(.25,.1,.25,1),"ease-in":Yt(.42,0,1,1),"ease-out":Yt(0,0,.58,1),"ease-in-out":Yt(.42,0,.58,1),"ease-in-sine":Yt(.47,0,.745,.715),"ease-out-sine":Yt(.39,.575,.565,1),"ease-in-out-sine":Yt(.445,.05,.55,.95),"ease-in-quad":Yt(.55,.085,.68,.53),"ease-out-quad":Yt(.25,.46,.45,.94),"ease-in-out-quad":Yt(.455,.03,.515,.955),"ease-in-cubic":Yt(.55,.055,.675,.19),"ease-out-cubic":Yt(.215,.61,.355,1),"ease-in-out-cubic":Yt(.645,.045,.355,1),"ease-in-quart":Yt(.895,.03,.685,.22),"ease-out-quart":Yt(.165,.84,.44,1),"ease-in-out-quart":Yt(.77,0,.175,1),"ease-in-quint":Yt(.755,.05,.855,.06),"ease-out-quint":Yt(.23,1,.32,1),"ease-in-out-quint":Yt(.86,0,.07,1),"ease-in-expo":Yt(.95,.05,.795,.035),"ease-out-expo":Yt(.19,1,.22,1),"ease-in-out-expo":Yt(1,0,0,1),"ease-in-circ":Yt(.6,.04,.98,.335),"ease-out-circ":Yt(.075,.82,.165,1),"ease-in-out-circ":Yt(.785,.135,.15,.86),spring:function(e,r,n){if(n===0)return _v.linear;var i=GW(e,r,n);return function(a,s,o){return a+(s-a)*i(o)}},"cubic-bezier":Yt};function E8(t,e,r,n,i){if(n===1||e===r)return r;var a=i(e,r,n);return t==null||((t.roundValue||t.color)&&(a=Math.round(a)),t.min!==void 0&&(a=Math.max(a,t.min)),t.max!==void 0&&(a=Math.min(a,t.max))),a}function T8(t,e){return t.pfValue!=null||t.value!=null?t.pfValue!=null&&(e==null||e.type.units!=="%")?t.pfValue:t.value:t}function Pc(t,e,r,n,i){var a=i!=null?i.type:null;r<0?r=0:r>1&&(r=1);var s=T8(t,i),o=T8(e,i);if(Ee(s)&&Ee(o))return E8(a,s,o,r,n);if(Ht(s)&&Ht(o)){for(var l=[],u=0;u<o.length;u++){var c=s[u],d=o[u];if(c!=null&&d!=null){var h=E8(a,c,d,r,n);l.push(h)}else l.push(d)}return l}}function HW(t,e,r,n){var i=!n,a=t._private,s=e._private,o=s.easing,l=s.startTime,u=n?t:t.cy(),c=u.style();if(!s.easingImpl)if(o==null)s.easingImpl=_v.linear;else{var d;if(Ke(o)){var h=c.parse("transition-timing-function",o);d=h.value}else d=o;var m,v;Ke(d)?(m=d,v=[]):(m=d[1],v=d.slice(2).map(function(J){return+J})),v.length>0?(m==="spring"&&v.push(s.duration),s.easingImpl=_v[m].apply(null,v)):s.easingImpl=_v[m]}var x=s.easingImpl,y;if(s.duration===0?y=1:y=(r-l)/s.duration,s.applying&&(y=s.progress),y<0?y=0:y>1&&(y=1),s.delay==null){var b=s.startPosition,S=s.position;if(S&&i&&!t.locked()){var w={};Qf(b.x,S.x)&&(w.x=Pc(b.x,S.x,y,x)),Qf(b.y,S.y)&&(w.y=Pc(b.y,S.y,y,x)),t.position(w)}var k=s.startPan,N=s.pan,T=a.pan,j=N!=null&&n;j&&(Qf(k.x,N.x)&&(T.x=Pc(k.x,N.x,y,x)),Qf(k.y,N.y)&&(T.y=Pc(k.y,N.y,y,x)),t.emit("pan"));var M=s.startZoom,A=s.zoom,P=A!=null&&n;P&&(Qf(M,A)&&(a.zoom=bp(a.minZoom,Pc(M,A,y,x),a.maxZoom)),t.emit("zoom")),(j||P)&&t.emit("viewport");var D=s.style;if(D&&D.length>0&&i){for(var R=0;R<D.length;R++){var I=D[R],U=I.name,B=I,z=s.startStyle[U],F=c.properties[z.name],V=Pc(z,B,y,x,F);c.overrideBypass(t,U,V)}t.emit("style")}}return s.progress=y,y}function Qf(t,e){return t==null||e==null?!1:Ee(t)&&Ee(e)?!0:!!(t&&e)}function WW(t,e,r,n){var i=e._private;i.started=!0,i.startTime=r-i.progress*i.duration}function j8(t,e){var r=e._private.aniEles,n=[];function i(c,d){var h=c._private,m=h.animation.current,v=h.animation.queue,x=!1;if(m.length===0){var y=v.shift();y&&m.push(y)}for(var b=function(T){for(var j=T.length-1;j>=0;j--){var M=T[j];M()}T.splice(0,T.length)},S=m.length-1;S>=0;S--){var w=m[S],k=w._private;if(k.stopped){m.splice(S,1),k.hooked=!1,k.playing=!1,k.started=!1,b(k.frames);continue}!k.playing&&!k.applying||(k.playing&&k.applying&&(k.applying=!1),k.started||WW(c,w,t),HW(c,w,t,d),k.applying&&(k.applying=!1),b(k.frames),k.step!=null&&k.step(t),w.completed()&&(m.splice(S,1),k.hooked=!1,k.playing=!1,k.started=!1,b(k.completes)),x=!0)}return!d&&m.length===0&&v.length===0&&n.push(c),x}for(var a=!1,s=0;s<r.length;s++){var o=r[s],l=i(o);a=a||l}var u=i(e,!0);(a||u)&&(r.length>0?e.notify("draw",r):e.notify("draw")),r.unmerge(n),e.emit("step")}var qW={animate:It.animate(),animation:It.animation(),animated:It.animated(),clearQueue:It.clearQueue(),delay:It.delay(),delayAnimation:It.delayAnimation(),stop:It.stop(),addToAnimationPool:function(e){var r=this;r.styleEnabled()&&r._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function r(){e._private.animationsRunning&&S0(function(a){j8(a,e),r()})}var n=e.renderer();n&&n.beforeRender?n.beforeRender(function(a,s){j8(s,e)},n.beforeRenderPriorities.animations):r()}},KW={qualifierCompare:function(e,r){return e==null||r==null?e==null&&r==null:e.sameText(r)},eventMatches:function(e,r,n){var i=r.qualifier;return i!=null?e!==n.target&&Jp(n.target)&&i.matches(n.target):!0},addEventFields:function(e,r){r.cy=e,r.target=e},callbackContext:function(e,r,n){return r.qualifier!=null?n.target:e}},Fg=function(e){return Ke(e)?new yl(e):e},DR={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new sx(KW,this)),this},emitter:function(){return this._private.emitter},on:function(e,r,n){return this.emitter().on(e,Fg(r),n),this},removeListener:function(e,r,n){return this.emitter().removeListener(e,Fg(r),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,r,n){return this.emitter().one(e,Fg(r),n),this},once:function(e,r,n){return this.emitter().one(e,Fg(r),n),this},emit:function(e,r){return this.emitter().emit(e,r),this},emitAndNotify:function(e,r){return this.emit(e),this.notify(e,r),this}};It.eventAliasesOn(DR);var H5={png:function(e){var r=this._private.renderer;return e=e||{},r.png(e)},jpg:function(e){var r=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",r.jpg(e)}};H5.jpeg=H5.jpg;var Av={layout:function(e){var r=this;if(e==null){lr("Layout options must be specified to make a layout");return}if(e.name==null){lr("A `name` must be specified to make a layout");return}var n=e.name,i=r.extension("layout",n);if(i==null){lr("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var a;Ke(e.eles)?a=r.$(e.eles):a=e.eles!=null?e.eles:r.$();var s=new i(Qe({},e,{cy:r,eles:a}));return s}};Av.createLayout=Av.makeLayout=Av.layout;var YW={notify:function(e,r){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var i=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();r!=null&&i.merge(r);return}if(n.notificationsEnabled){var a=this.renderer();this.destroyed()||!a||a.notify(e,r)}},notifications:function(e){var r=this._private;return e===void 0?r.notificationsEnabled:(r.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var r=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var i=e.batchNotifications[n];i.empty()?r.notify(n):r.notify(n,i)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var r=this;return this.batch(function(){for(var n=Object.keys(e),i=0;i<n.length;i++){var a=n[i],s=e[a],o=r.getElementById(a);o.data(s)}})}},XW=Pn({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),W5={renderTo:function(e,r,n,i){var a=this._private.renderer;return a.renderTo(e,r,n,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var r=this,n=r.extension("renderer",e.name);if(n==null){lr("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&Lt("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=XW(e);i.cy=r,r._private.renderer=new n(i),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var r=e.container();if(r)for(r._cyreg=null;r.childNodes.length>0;)r.removeChild(r.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var i=n._private;i.rscratch={},i.rstyle={},i.animation.current=[],i.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};W5.invalidateDimensions=W5.resize;var Rv={collection:function(e,r){return Ke(e)?this.$(e):Ai(e)?e.collection():Ht(e)?(r||(r={}),new Tn(this,e,r.unique,r.removed)):new Tn(this)},nodes:function(e){var r=this.$(function(n){return n.isNode()});return e?r.filter(e):r},edges:function(e){var r=this.$(function(n){return n.isEdge()});return e?r.filter(e):r},$:function(e){var r=this._private.elements;return e?r.filter(e):r.spawnSelf()},mutableElements:function(){return this._private.elements}};Rv.elements=Rv.filter=Rv.$;var vn={},Ih="t",QW="f";vn.apply=function(t){for(var e=this,r=e._private,n=r.cy,i=n.collection(),a=0;a<t.length;a++){var s=t[a],o=e.getContextMeta(s);if(!o.empty){var l=e.getContextStyle(o),u=e.applyContextStyle(o,l,s);s._private.appliedInitStyle?e.updateTransitions(s,u.diffProps):s._private.appliedInitStyle=!0;var c=e.updateStyleHints(s);c&&i.push(s)}}return i};vn.getPropertiesDiff=function(t,e){var r=this,n=r._private.propDiffs=r._private.propDiffs||{},i=t+"-"+e,a=n[i];if(a)return a;for(var s=[],o={},l=0;l<r.length;l++){var u=r[l],c=t[l]===Ih,d=e[l]===Ih,h=c!==d,m=u.mappedProperties.length>0;if(h||d&&m){var v=void 0;h&&m||h?v=u.properties:m&&(v=u.mappedProperties);for(var x=0;x<v.length;x++){for(var y=v[x],b=y.name,S=!1,w=l+1;w<r.length;w++){var k=r[w],N=e[w]===Ih;if(N&&(S=k.properties[y.name]!=null,S))break}!o[b]&&!S&&(o[b]=!0,s.push(b))}}}return n[i]=s,s};vn.getContextMeta=function(t){for(var e=this,r="",n,i=t._private.styleCxtKey||"",a=0;a<e.length;a++){var s=e[a],o=s.selector&&s.selector.matches(t);o?r+=Ih:r+=QW}return n=e.getPropertiesDiff(i,r),t._private.styleCxtKey=r,{key:r,diffPropNames:n,empty:n.length===0}};vn.getContextStyle=function(t){var e=t.key,r=this,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var i={_private:{key:e}},a=0;a<r.length;a++){var s=r[a],o=e[a]===Ih;if(o)for(var l=0;l<s.properties.length;l++){var u=s.properties[l];i[u.name]=u}}return n[e]=i,i};vn.applyContextStyle=function(t,e,r){for(var n=this,i=t.diffPropNames,a={},s=n.types,o=0;o<i.length;o++){var l=i[o],u=e[l],c=r.pstyle(l);if(!u)if(c)c.bypass?u={name:l,deleteBypassed:!0}:u={name:l,delete:!0};else continue;if(c!==u){if(u.mapped===s.fn&&c!=null&&c.mapping!=null&&c.mapping.value===u.value){var d=c.mapping,h=d.fnValue=u.value(r);if(h===d.prevFnValue)continue}var m=a[l]={prev:c};n.applyParsedProperty(r,u),m.next=r.pstyle(l),m.next&&m.next.bypass&&(m.next=m.next.bypassed)}}return{diffProps:a}};vn.updateStyleHints=function(t){var e=t._private,r=this,n=r.propertyGroupNames,i=r.propertyGroupKeys,a=function(te,Z,le){return r.getPropertiesHash(te,Z,le)},s=e.styleKey;if(t.removed())return!1;var o=e.group==="nodes",l=t._private.style;n=Object.keys(l);for(var u=0;u<i.length;u++){var c=i[u];e.styleKeys[c]=[fu,$c]}for(var d=function(te,Z){return e.styleKeys[Z][0]=vp(te,e.styleKeys[Z][0])},h=function(te,Z){return e.styleKeys[Z][1]=yp(te,e.styleKeys[Z][1])},m=function(te,Z){d(te,Z),h(te,Z)},v=function(te,Z){for(var le=0;le<te.length;le++){var ge=te.charCodeAt(le);d(ge,Z),h(ge,Z)}},x=2e9,y=function(te){return-128<te&&te<128&&Math.floor(te)!==te?x-(te*1024|0):te},b=0;b<n.length;b++){var S=n[b],w=l[S];if(w!=null){var k=this.properties[S],N=k.type,T=k.groupKey,j=void 0;k.hashOverride!=null?j=k.hashOverride(t,w):w.pfValue!=null&&(j=w.pfValue);var M=k.enums==null?w.value:null,A=j!=null,P=M!=null,D=A||P,R=w.units;if(N.number&&D&&!N.multiple){var I=A?j:M;m(y(I),T),!A&&R!=null&&v(R,T)}else v(w.strValue,T)}}for(var U=[fu,$c],B=0;B<i.length;B++){var z=i[B],F=e.styleKeys[z];U[0]=vp(F[0],U[0]),U[1]=yp(F[1],U[1])}e.styleKey=hU(U[0],U[1]);var V=e.styleKeys;e.labelDimsKey=To(V.labelDimensions);var J=a(t,["label"],V.labelDimensions);if(e.labelKey=To(J),e.labelStyleKey=To(_g(V.commonLabel,J)),!o){var Y=a(t,["source-label"],V.labelDimensions);e.sourceLabelKey=To(Y),e.sourceLabelStyleKey=To(_g(V.commonLabel,Y));var L=a(t,["target-label"],V.labelDimensions);e.targetLabelKey=To(L),e.targetLabelStyleKey=To(_g(V.commonLabel,L))}if(o){var G=e.styleKeys,ee=G.nodeBody,re=G.nodeBorder,se=G.nodeOutline,de=G.backgroundImage,W=G.compound,ne=G.pie,ie=G.stripe,$=[ee,re,se,de,W,ne,ie].filter(function(q){return q!=null}).reduce(_g,[fu,$c]);e.nodeKey=To($),e.hasPie=ne!=null&&ne[0]!==fu&&ne[1]!==$c,e.hasStripe=ie!=null&&ie[0]!==fu&&ie[1]!==$c}return s!==e.styleKey};vn.clearStyleHints=function(t){var e=t._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null,e.hasStripe=null};vn.applyParsedProperty=function(t,e){var r=this,n=e,i=t._private.style,a,s=r.types,o=r.properties[n.name].type,l=n.bypass,u=i[n.name],c=u&&u.bypass,d=t._private,h="mapping",m=function(ee){return ee==null?null:ee.pfValue!=null?ee.pfValue:ee.value},v=function(){var ee=m(u),re=m(n);r.checkTriggers(t,n.name,ee,re)};if(e.name==="curve-style"&&t.isEdge()&&(e.value!=="bezier"&&t.isLoop()||e.value==="haystack"&&(t.source().isParent()||t.target().isParent()))&&(n=e=this.parse(e.name,"bezier",l)),n.delete)return i[n.name]=void 0,v(),!0;if(n.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,v(),!0):!1:(v(),!0);if(n.deleteBypass)return u?u.bypass?(i[n.name]=u.bypassed,v(),!0):!1:(v(),!0);var x=function(){Lt("Do not assign mappings to elements without corresponding data (i.e. ele `"+t.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case s.mapData:{for(var y=n.field.split("."),b=d.data,S=0;S<y.length&&b;S++){var w=y[S];b=b[w]}if(b==null)return x(),!1;var k;if(Ee(b)){var N=n.fieldMax-n.fieldMin;N===0?k=0:k=(b-n.fieldMin)/N}else return Lt("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+b+"` for `"+t.id()+"` is non-numeric)"),!1;if(k<0?k=0:k>1&&(k=1),o.color){var T=n.valueMin[0],j=n.valueMax[0],M=n.valueMin[1],A=n.valueMax[1],P=n.valueMin[2],D=n.valueMax[2],R=n.valueMin[3]==null?1:n.valueMin[3],I=n.valueMax[3]==null?1:n.valueMax[3],U=[Math.round(T+(j-T)*k),Math.round(M+(A-M)*k),Math.round(P+(D-P)*k),Math.round(R+(I-R)*k)];a={bypass:n.bypass,name:n.name,value:U,strValue:"rgb("+U[0]+", "+U[1]+", "+U[2]+")"}}else if(o.number){var B=n.valueMin+(n.valueMax-n.valueMin)*k;a=this.parse(n.name,B,n.bypass,h)}else return!1;if(!a)return x(),!1;a.mapping=n,n=a;break}case s.data:{for(var z=n.field.split("."),F=d.data,V=0;V<z.length&&F;V++){var J=z[V];F=F[J]}if(F!=null&&(a=this.parse(n.name,F,n.bypass,h)),!a)return x(),!1;a.mapping=n,n=a;break}case s.fn:{var Y=n.value,L=n.fnValue!=null?n.fnValue:Y(t);if(n.prevFnValue=L,L==null)return Lt("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+t.id()+"` is null)"),!1;if(a=this.parse(n.name,L,n.bypass,h),!a)return Lt("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+t.id()+"` is invalid)"),!1;a.mapping=ss(n),n=a;break}case void 0:break;default:return!1}return l?(c?n.bypassed=u.bypassed:n.bypassed=u,i[n.name]=n):c?u.bypassed=n:i[n.name]=n,v(),!0};vn.cleanElements=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),!e)n._private.style={};else for(var i=n._private.style,a=Object.keys(i),s=0;s<a.length;s++){var o=a[s],l=i[o];l!=null&&(l.bypass?l.bypassed=null:i[o]=null)}}};vn.update=function(){var t=this._private.cy,e=t.mutableElements();e.updateStyle()};vn.updateTransitions=function(t,e){var r=this,n=t._private,i=t.pstyle("transition-property").value,a=t.pstyle("transition-duration").pfValue,s=t.pstyle("transition-delay").pfValue;if(i.length>0&&a>0){for(var o={},l=!1,u=0;u<i.length;u++){var c=i[u],d=t.pstyle(c),h=e[c];if(h){var m=h.prev,v=m,x=h.next!=null?h.next:d,y=!1,b=void 0,S=1e-6;v&&(Ee(v.pfValue)&&Ee(x.pfValue)?(y=x.pfValue-v.pfValue,b=v.pfValue+S*y):Ee(v.value)&&Ee(x.value)?(y=x.value-v.value,b=v.value+S*y):Ht(v.value)&&Ht(x.value)&&(y=v.value[0]!==x.value[0]||v.value[1]!==x.value[1]||v.value[2]!==x.value[2],b=v.strValue),y&&(o[c]=x.strValue,this.applyBypass(t,c,b),l=!0))}}if(!l)return;n.transitioning=!0,new nf(function(w){s>0?t.delayAnimation(s).play().promise().then(w):w()}).then(function(){return t.animation({style:o,duration:a,easing:t.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){r.removeBypasses(t,i),t.emitAndNotify("style"),n.transitioning=!1})}else n.transitioning&&(this.removeBypasses(t,i),t.emitAndNotify("style"),n.transitioning=!1)};vn.checkTrigger=function(t,e,r,n,i,a){var s=this.properties[e],o=i(s);t.removed()||o!=null&&o(r,n,t)&&a(s)};vn.checkZOrderTrigger=function(t,e,r,n){var i=this;this.checkTrigger(t,e,r,n,function(a){return a.triggersZOrder},function(){i._private.cy.notify("zorder",t)})};vn.checkBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBounds},function(i){t.dirtyCompoundBoundsCache(),t.dirtyBoundingBoxCache()})};vn.checkConnectedEdgesBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBoundsOfConnectedEdges},function(i){t.connectedEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};vn.checkParallelEdgesBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBoundsOfParallelEdges},function(i){t.parallelEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};vn.checkTriggers=function(t,e,r,n){t.dirtyStyleCache(),this.checkZOrderTrigger(t,e,r,n),this.checkBoundsTrigger(t,e,r,n),this.checkConnectedEdgesBoundsTrigger(t,e,r,n),this.checkParallelEdgesBoundsTrigger(t,e,r,n)};var am={};am.applyBypass=function(t,e,r,n){var i=this,a=[],s=!0;if(e==="*"||e==="**"){if(r!==void 0)for(var o=0;o<i.properties.length;o++){var l=i.properties[o],u=l.name,c=this.parse(u,r,!0);c&&a.push(c)}}else if(Ke(e)){var d=this.parse(e,r,!0);d&&a.push(d)}else if(Mt(e)){var h=e;n=r;for(var m=Object.keys(h),v=0;v<m.length;v++){var x=m[v],y=h[x];if(y===void 0&&(y=h[Xy(x)]),y!==void 0){var b=this.parse(x,y,!0);b&&a.push(b)}}}else return!1;if(a.length===0)return!1;for(var S=!1,w=0;w<t.length;w++){for(var k=t[w],N={},T=void 0,j=0;j<a.length;j++){var M=a[j];if(n){var A=k.pstyle(M.name);T=N[M.name]={prev:A}}S=this.applyParsedProperty(k,ss(M))||S,n&&(T.next=k.pstyle(M.name))}S&&this.updateStyleHints(k),n&&this.updateTransitions(k,N,s)}return S};am.overrideBypass=function(t,e,r){e=YC(e);for(var n=0;n<t.length;n++){var i=t[n],a=i._private.style[e],s=this.properties[e].type,o=s.color,l=s.mutiple,u=a?a.pfValue!=null?a.pfValue:a.value:null;!a||!a.bypass?this.applyBypass(i,e,r):(a.value=r,a.pfValue!=null&&(a.pfValue=r),o?a.strValue="rgb("+r.join(",")+")":l?a.strValue=r.join(" "):a.strValue=""+r,this.updateStyleHints(i)),this.checkTriggers(i,e,u,r)}};am.removeAllBypasses=function(t,e){return this.removeBypasses(t,this.propertyNames,e)};am.removeBypasses=function(t,e,r){for(var n=!0,i=0;i<t.length;i++){for(var a=t[i],s={},o=0;o<e.length;o++){var l=e[o],u=this.properties[l],c=a.pstyle(u.name);if(!(!c||!c.bypass)){var d="",h=this.parse(l,d,!0),m=s[u.name]={prev:c};this.applyParsedProperty(a,h),m.next=a.pstyle(u.name)}}this.updateStyleHints(a),r&&this.updateTransitions(a,s,n)}};var c3={};c3.getEmSizeInPixels=function(){var t=this.containerCss("font-size");return t!=null?parseFloat(t):1};c3.containerCss=function(t){var e=this._private.cy,r=e.container(),n=e.window();if(n&&r&&n.getComputedStyle)return n.getComputedStyle(r).getPropertyValue(t)};var ds={};ds.getRenderedStyle=function(t,e){return e?this.getStylePropertyValue(t,e,!0):this.getRawStyle(t,!0)};ds.getRawStyle=function(t,e){var r=this;if(t=t[0],t){for(var n={},i=0;i<r.properties.length;i++){var a=r.properties[i],s=r.getStylePropertyValue(t,a.name,e);s!=null&&(n[a.name]=s,n[Xy(a.name)]=s)}return n}};ds.getIndexedStyle=function(t,e,r,n){var i=t.pstyle(e)[r][n];return i??t.cy().style().getDefaultProperty(e)[r][0]};ds.getStylePropertyValue=function(t,e,r){var n=this;if(t=t[0],t){var i=n.properties[e];i.alias&&(i=i.pointsTo);var a=i.type,s=t.pstyle(i.name);if(s){var o=s.value,l=s.units,u=s.strValue;if(r&&a.number&&o!=null&&Ee(o)){var c=t.cy().zoom(),d=function(y){return y*c},h=function(y,b){return d(y)+b},m=Ht(o),v=m?l.every(function(x){return x!=null}):l!=null;return v?m?o.map(function(x,y){return h(x,l[y])}).join(" "):h(o,l):m?o.map(function(x){return Ke(x)?x:""+d(x)}).join(" "):""+d(o)}else if(u!=null)return u}return null}};ds.getAnimationStartStyle=function(t,e){for(var r={},n=0;n<e.length;n++){var i=e[n],a=i.name,s=t.pstyle(a);s!==void 0&&(Mt(s)?s=this.parse(a,s.strValue):s=this.parse(a,s)),s&&(r[a]=s)}return r};ds.getPropsList=function(t){var e=this,r=[],n=t,i=e.properties;if(n)for(var a=Object.keys(n),s=0;s<a.length;s++){var o=a[s],l=n[o],u=i[o]||i[YC(o)],c=this.parse(u.name,l);c&&r.push(c)}return r};ds.getNonDefaultPropertiesHash=function(t,e,r){var n=r.slice(),i,a,s,o,l,u;for(l=0;l<e.length;l++)if(i=e[l],a=t.pstyle(i,!1),a!=null)if(a.pfValue!=null)n[0]=vp(o,n[0]),n[1]=yp(o,n[1]);else for(s=a.strValue,u=0;u<s.length;u++)o=s.charCodeAt(u),n[0]=vp(o,n[0]),n[1]=yp(o,n[1]);return n};ds.getPropertiesHash=ds.getNonDefaultPropertiesHash;var ux={};ux.appendFromJson=function(t){for(var e=this,r=0;r<t.length;r++){var n=t[r],i=n.selector,a=n.style||n.css,s=Object.keys(a);e.selector(i);for(var o=0;o<s.length;o++){var l=s[o],u=a[l];e.css(l,u)}}return e};ux.fromJson=function(t){var e=this;return e.resetToDefault(),e.appendFromJson(t),e};ux.json=function(){for(var t=[],e=this.defaultLength;e<this.length;e++){for(var r=this[e],n=r.selector,i=r.properties,a={},s=0;s<i.length;s++){var o=i[s];a[o.name]=o.strValue}t.push({selector:n?n.toString():"core",style:a})}return t};var d3={};d3.appendFromString=function(t){var e=this,r=this,n=""+t,i,a,s;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function o(){n.length>i.length?n=n.substr(i.length):n=""}function l(){a.length>s.length?a=a.substr(s.length):a=""}for(;;){var u=n.match(/^\s*$/);if(u)break;var c=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!c){Lt("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}i=c[0];var d=c[1];if(d!=="core"){var h=new yl(d);if(h.invalid){Lt("Skipping parsing of block: Invalid selector found in string stylesheet: "+d),o();continue}}var m=c[2],v=!1;a=m;for(var x=[];;){var y=a.match(/^\s*$/);if(y)break;var b=a.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!b){Lt("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+m),v=!0;break}s=b[0];var S=b[1],w=b[2],k=e.properties[S];if(!k){Lt("Skipping property: Invalid property name in: "+s),l();continue}var N=r.parse(S,w);if(!N){Lt("Skipping property: Invalid property definition in: "+s),l();continue}x.push({name:S,val:w}),l()}if(v){o();break}r.selector(d);for(var T=0;T<x.length;T++){var j=x[T];r.css(j.name,j.val)}o()}return r};d3.fromString=function(t){var e=this;return e.resetToDefault(),e.appendFromString(t),e};var Fr={};(function(){var t=Jr,e=H$,r=q$,n=K$,i=Y$,a=function(q){return"^"+q+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},s=function(q){var te=t+"|\\w+|"+e+"|"+r+"|"+n+"|"+i;return"^"+q+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+t+")\\s*\\,\\s*("+t+")\\s*,\\s*("+te+")\\s*\\,\\s*("+te+")\\)$"},o=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Fr.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},scratch:{mapping:!0,regex:a("scratch")},mapData:{mapping:!0,regex:s("mapData")},mapLayoutData:{mapping:!0,regex:s("mapLayoutData")},mapScratch:{mapping:!0,regex:s("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:o,singleRegexMatchValue:!0},urls:{regexes:o,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(q,te){switch(q.length){case 2:return te[0]!=="deg"&&te[0]!=="rad"&&te[1]!=="deg"&&te[1]!=="rad";case 1:return Ke(q[0])||te[0]==="deg"||te[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(q){var te=q.length;return te===1||te===2||te===4}}};var l={zeroNonZero:function(q,te){return(q==null||te==null)&&q!==te||q==0&&te!=0?!0:q!=0&&te==0},any:function(q,te){return q!=te},emptyNonEmpty:function(q,te){var Z=ml(q),le=ml(te);return Z&&!le||!Z&&le}},u=Fr.types,c=[{name:"label",type:u.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any}],d=[{name:"source-label",type:u.text,triggersBounds:l.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:u.size,triggersBounds:l.any}],h=[{name:"target-label",type:u.text,triggersBounds:l.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:u.size,triggersBounds:l.any}],m=[{name:"font-family",type:u.fontFamily,triggersBounds:l.any},{name:"font-style",type:u.fontStyle,triggersBounds:l.any},{name:"font-weight",type:u.fontWeight,triggersBounds:l.any},{name:"font-size",type:u.size,triggersBounds:l.any},{name:"text-transform",type:u.textTransform,triggersBounds:l.any},{name:"text-wrap",type:u.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:u.size,triggersBounds:l.any},{name:"text-outline-width",type:u.size,triggersBounds:l.any},{name:"line-height",type:u.positiveNumber,triggersBounds:l.any}],v=[{name:"text-valign",type:u.valign,triggersBounds:l.any},{name:"text-halign",type:u.halign,triggersBounds:l.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:l.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:l.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:u.justification},{name:"box-select-labels",type:u.bool,triggersBounds:l.any}],x=[{name:"events",type:u.bool,triggersZOrder:l.any},{name:"text-events",type:u.bool,triggersZOrder:l.any},{name:"box-selection",type:u.boxSelection,triggersZOrder:l.any}],y=[{name:"display",type:u.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfConnectedEdges:l.any,triggersBoundsOfParallelEdges:function(q,te,Z){return q===te?!1:Z.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:u.visibility,triggersZOrder:l.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:u.number,triggersZOrder:l.any}],b=[{name:"overlay-padding",type:u.size,triggersBounds:l.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"overlay-corner-radius",type:u.cornerRadius}],S=[{name:"underlay-padding",type:u.size,triggersBounds:l.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"underlay-corner-radius",type:u.cornerRadius}],w=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],k=function(q,te){return te.value==="label"?-q.poolIndex():te.pfValue},N=[{name:"height",type:u.nodeSize,triggersBounds:l.any,hashOverride:k},{name:"width",type:u.nodeSize,triggersBounds:l.any,hashOverride:k},{name:"shape",type:u.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:l.any},{name:"corner-radius",type:u.cornerRadius},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:l.any}],T=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:l.any},{name:"border-style",type:u.borderStyle},{name:"border-cap",type:u.lineCap},{name:"border-join",type:u.lineJoin},{name:"border-dash-pattern",type:u.numbers},{name:"border-dash-offset",type:u.number},{name:"border-position",type:u.linePosition}],j=[{name:"outline-color",type:u.color},{name:"outline-opacity",type:u.zeroOneNumber},{name:"outline-width",type:u.size,triggersBounds:l.any},{name:"outline-style",type:u.borderStyle},{name:"outline-offset",type:u.size,triggersBounds:l.any}],M=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],A=[{name:"position",type:u.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:u.size,triggersBounds:l.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:u.size,triggersBounds:l.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:l.any}],P=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-outline-width",type:u.size},{name:"line-outline-color",type:u.color},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelEdges:function(q,te){return q===te?!1:q==="bezier"||te==="bezier"}},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:u.size,triggersBounds:l.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-radii",type:u.numbers,triggersBounds:l.any},{name:"radius-type",type:u.radiusType,triggersBounds:l.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:l.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:l.any},{name:"taxi-radius",type:u.number,triggersBounds:l.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:u.angle,triggersBounds:l.any},{name:"loop-sweep",type:u.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:u.size,triggersBounds:l.any},{name:"target-distance-from-node",type:u.size,triggersBounds:l.any}],D=[{name:"ghost",type:u.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:u.zeroOneNumber}],R=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],I=[];Fr.pieBackgroundN=16,I.push({name:"pie-size",type:u.sizeMaybePercent}),I.push({name:"pie-hole",type:u.sizeMaybePercent}),I.push({name:"pie-start-angle",type:u.angle});for(var U=1;U<=Fr.pieBackgroundN;U++)I.push({name:"pie-"+U+"-background-color",type:u.color}),I.push({name:"pie-"+U+"-background-size",type:u.percent}),I.push({name:"pie-"+U+"-background-opacity",type:u.zeroOneNumber});var B=[];Fr.stripeBackgroundN=16,B.push({name:"stripe-size",type:u.sizeMaybePercent}),B.push({name:"stripe-direction",type:u.axisDirectionPrimary});for(var z=1;z<=Fr.stripeBackgroundN;z++)B.push({name:"stripe-"+z+"-background-color",type:u.color}),B.push({name:"stripe-"+z+"-background-size",type:u.percent}),B.push({name:"stripe-"+z+"-background-opacity",type:u.zeroOneNumber});var F=[],V=Fr.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill},{name:"arrow-width",type:u.arrowWidth}].forEach(function($){V.forEach(function(q){var te=q+"-"+$.name,Z=$.type,le=$.triggersBounds;F.push({name:te,type:Z,triggersBounds:le})})},{});var J=Fr.properties=[].concat(x,w,y,b,S,D,v,m,c,d,h,N,T,j,M,I,B,A,P,F,R),Y=Fr.propertyGroups={behavior:x,transition:w,visibility:y,overlay:b,underlay:S,ghost:D,commonLabel:v,labelDimensions:m,mainLabel:c,sourceLabel:d,targetLabel:h,nodeBody:N,nodeBorder:T,nodeOutline:j,backgroundImage:M,pie:I,stripe:B,compound:A,edgeLine:P,edgeArrow:F,core:R},L=Fr.propertyGroupNames={},G=Fr.propertyGroupKeys=Object.keys(Y);G.forEach(function($){L[$]=Y[$].map(function(q){return q.name}),Y[$].forEach(function(q){return q.groupKey=$})});var ee=Fr.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Fr.propertyNames=J.map(function($){return $.name});for(var re=0;re<J.length;re++){var se=J[re];J[se.name]=se}for(var de=0;de<ee.length;de++){var W=ee[de],ne=J[W.pointsTo],ie={name:W.name,alias:!0,pointsTo:ne};J.push(ie),J[W.name]=ie}})();Fr.getDefaultProperty=function(t){return this.getDefaultProperties()[t]};Fr.getDefaultProperties=function(){var t=this._private;if(t.defaultProperties!=null)return t.defaultProperties;for(var e=Qe({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=Fr.pieBackgroundN;c++){var d=u.name.replace("{{i}}",c),h=u.value;l[d]=h}return l},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=Fr.stripeBackgroundN;c++){var d=u.name.replace("{{i}}",c),h=u.value;l[d]=h}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(l,u){return Fr.arrowPrefixes.forEach(function(c){var d=c+"-"+u.name,h=u.value;l[d]=h}),l},{})),r={},n=0;n<this.properties.length;n++){var i=this.properties[n];if(!i.pointsTo){var a=i.name,s=e[a],o=this.parse(a,s);r[a]=o}}return t.defaultProperties=r,t.defaultProperties};Fr.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var cx={};cx.parse=function(t,e,r,n){var i=this;if(vr(e))return i.parseImplWarn(t,e,r,n);var a=n==="mapping"||n===!0||n===!1||n==null?"dontcare":n,s=r?"t":"f",o=""+e,l=GA(t,o,s,a),u=i.propCache=i.propCache||[],c;return(c=u[l])||(c=u[l]=i.parseImplWarn(t,e,r,n)),(r||n==="mapping")&&(c=ss(c),c&&(c.value=ss(c.value))),c};cx.parseImplWarn=function(t,e,r,n){var i=this.parseImpl(t,e,r,n);return!i&&e!=null&&Lt("The style property `".concat(t,": ").concat(e,"` is invalid")),i&&(i.name==="width"||i.name==="height")&&e==="label"&&Lt("The style value of `label` is deprecated for `"+i.name+"`"),i};cx.parseImpl=function(t,e,r,n){var i=this;t=YC(t);var a=i.properties[t],s=e,o=i.types;if(!a||e===void 0)return null;a.alias&&(a=a.pointsTo,t=a.name);var l=Ke(e);l&&(e=e.trim());var u=a.type;if(!u)return null;if(r&&(e===""||e===null))return{name:t,value:e,bypass:!0,deleteBypass:!0};if(vr(e))return{name:t,value:e,strValue:"fn",mapped:o.fn,bypass:r};var c,d;if(!(!l||n||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(c=new RegExp(o.data.regex).exec(e))){if(r)return!1;var h=o.data;return{name:t,value:c,strValue:""+e,mapped:h,field:c[1],bypass:r}}else if(e.length>=10&&e[0]==="m"&&(d=new RegExp(o.mapData.regex).exec(e))){if(r||u.multiple)return!1;var m=o.mapData;if(!(u.color||u.number))return!1;var v=this.parse(t,d[4]);if(!v||v.mapped)return!1;var x=this.parse(t,d[5]);if(!x||x.mapped)return!1;if(v.pfValue===x.pfValue||v.strValue===x.strValue)return Lt("`"+t+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+t+": "+v.strValue+"`"),this.parse(t,v.strValue);if(u.color){var y=v.value,b=x.value,S=y[0]===b[0]&&y[1]===b[1]&&y[2]===b[2]&&(y[3]===b[3]||(y[3]==null||y[3]===1)&&(b[3]==null||b[3]===1));if(S)return!1}return{name:t,value:d,strValue:""+e,mapped:m,field:d[1],fieldMin:parseFloat(d[2]),fieldMax:parseFloat(d[3]),valueMin:v.value,valueMax:x.value,bypass:r}}}if(u.multiple&&n!=="multiple"){var w;if(l?w=e.split(/\s+/):Ht(e)?w=e:w=[e],u.evenMultiple&&w.length%2!==0)return null;for(var k=[],N=[],T=[],j="",M=!1,A=0;A<w.length;A++){var P=i.parse(t,w[A],r,"multiple");M=M||Ke(P.value),k.push(P.value),T.push(P.pfValue!=null?P.pfValue:P.value),N.push(P.units),j+=(A>0?" ":"")+P.strValue}return u.validate&&!u.validate(k,N)?null:u.singleEnum&&M?k.length===1&&Ke(k[0])?{name:t,value:k[0],strValue:k[0],bypass:r}:null:{name:t,value:k,pfValue:T,strValue:j,bypass:r,units:N}}var D=function(){for(var ie=0;ie<u.enums.length;ie++){var $=u.enums[ie];if($===e)return{name:t,value:e,strValue:""+e,bypass:r}}return null};if(u.number){var R,I="px";if(u.units&&(R=u.units),u.implicitUnits&&(I=u.implicitUnits),!u.unitless)if(l){var U="px|em"+(u.allowPercent?"|\\%":"");R&&(U=R);var B=e.match("^("+Jr+")("+U+")?$");B&&(e=B[1],R=B[2]||I)}else(!R||u.implicitUnits)&&(R=I);if(e=parseFloat(e),isNaN(e)&&u.enums===void 0)return null;if(isNaN(e)&&u.enums!==void 0)return e=s,D();if(u.integer&&!B$(e)||u.min!==void 0&&(e<u.min||u.strictMin&&e===u.min)||u.max!==void 0&&(e>u.max||u.strictMax&&e===u.max))return null;var z={name:t,value:e,strValue:""+e+(R||""),units:R,bypass:r};return u.unitless||R!=="px"&&R!=="em"?z.pfValue=e:z.pfValue=R==="px"||!R?e:this.getEmSizeInPixels()*e,(R==="ms"||R==="s")&&(z.pfValue=R==="ms"?e:1e3*e),(R==="deg"||R==="rad")&&(z.pfValue=R==="rad"?e:KU(e)),R==="%"&&(z.pfValue=e/100),z}else if(u.propList){var F=[],V=""+e;if(V!=="none"){for(var J=V.split(/\s*,\s*|\s+/),Y=0;Y<J.length;Y++){var L=J[Y].trim();i.properties[L]?F.push(L):Lt("`"+L+"` is not a valid property name")}if(F.length===0)return null}return{name:t,value:F,strValue:F.length===0?"none":F.join(" "),bypass:r}}else if(u.color){var G=LA(e);return G?{name:t,value:G,pfValue:G,strValue:"rgb("+G[0]+","+G[1]+","+G[2]+")",bypass:r}:null}else if(u.regex||u.regexes){if(u.enums){var ee=D();if(ee)return ee}for(var re=u.regexes?u.regexes:[u.regex],se=0;se<re.length;se++){var de=new RegExp(re[se]),W=de.exec(e);if(W)return{name:t,value:u.singleRegexMatchValue?W[1]:W,strValue:""+e,bypass:r}}return null}else return u.string?{name:t,value:""+e,strValue:""+e,bypass:r}:u.enums?D():null};var pn=function(e){if(!(this instanceof pn))return new pn(e);if(!KC(e)){lr("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},Hn=pn.prototype;Hn.instanceString=function(){return"style"};Hn.clear=function(){for(var t=this._private,e=t.cy,r=e.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,t.contextStyles={},t.propDiffs={},this.cleanElements(r,!0),r.forEach(function(i){var a=i[0]._private;a.styleDirty=!0,a.appliedInitStyle=!1}),this};Hn.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Hn.core=function(t){return this._private.coreStyle[t]||this.getDefaultProperty(t)};Hn.selector=function(t){var e=t==="core"?null:new yl(t),r=this.length++;return this[r]={selector:e,properties:[],mappedProperties:[],index:r},this};Hn.css=function(){var t=this,e=arguments;if(e.length===1)for(var r=e[0],n=0;n<t.properties.length;n++){var i=t.properties[n],a=r[i.name];a===void 0&&(a=r[Xy(i.name)]),a!==void 0&&this.cssRule(i.name,a)}else e.length===2&&this.cssRule(e[0],e[1]);return this};Hn.style=Hn.css;Hn.cssRule=function(t,e){var r=this.parse(t,e);if(r){var n=this.length-1;this[n].properties.push(r),this[n].properties[r.name]=r,r.name.match(/pie-(\d+)-background-size/)&&r.value&&(this._private.hasPie=!0),r.name.match(/stripe-(\d+)-background-size/)&&r.value&&(this._private.hasStripe=!0),r.mapped&&this[n].mappedProperties.push(r);var i=!this[n].selector;i&&(this._private.coreStyle[r.name]=r)}return this};Hn.append=function(t){return DA(t)?t.appendToStyle(this):Ht(t)?this.appendFromJson(t):Ke(t)&&this.appendFromString(t),this};pn.fromJson=function(t,e){var r=new pn(t);return r.fromJson(e),r};pn.fromString=function(t,e){return new pn(t).fromString(e)};[vn,am,c3,ds,ux,d3,Fr,cx].forEach(function(t){Qe(Hn,t)});pn.types=Hn.types;pn.properties=Hn.properties;pn.propertyGroups=Hn.propertyGroups;pn.propertyGroupNames=Hn.propertyGroupNames;pn.propertyGroupKeys=Hn.propertyGroupKeys;var JW={style:function(e){if(e){var r=this.setStyle(e);r.update()}return this._private.style},setStyle:function(e){var r=this._private;return DA(e)?r.style=e.generateStyle(this):Ht(e)?r.style=pn.fromJson(this,e):Ke(e)?r.style=pn.fromString(this,e):r.style=pn(this),r.style},updateStyle:function(){this.mutableElements().updateStyle()}},ZW="single",Vu={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var r=this._private;if(r.selectionType==null&&(r.selectionType=ZW),e!==void 0)(e==="additive"||e==="single")&&(r.selectionType=e);else return r.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,r=this._private.pan,n,i,a,s,o;switch(e.length){case 0:return r;case 1:if(Ke(e[0]))return n=e[0],r[n];if(Mt(e[0])){if(!this._private.panningEnabled)return this;a=e[0],s=a.x,o=a.y,Ee(s)&&(r.x=s),Ee(o)&&(r.y=o),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;n=e[0],i=e[1],(n==="x"||n==="y")&&Ee(i)&&(r[n]=i),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,r){var n=arguments,i=this._private.pan,a,s,o,l,u;if(!this._private.panningEnabled)return this;switch(n.length){case 1:Mt(e)&&(o=n[0],l=o.x,u=o.y,Ee(l)&&(i.x+=l),Ee(u)&&(i.y+=u),this.emit("pan viewport"));break;case 2:a=e,s=r,(a==="x"||a==="y")&&Ee(s)&&(i[a]+=s),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,r){var n=this.getFitViewport(e,r);if(n){var i=this._private;i.zoom=n.zoom,i.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,r){if(Ee(e)&&r===void 0&&(r=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var n;if(Ke(e)){var i=e;e=this.$(i)}else if(V$(e)){var a=e;n={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},n.w=n.x2-n.x1,n.h=n.y2-n.y1}else Ai(e)||(e=this.mutableElements());if(!(Ai(e)&&e.empty())){n=n||e.boundingBox();var s=this.width(),o=this.height(),l;if(r=Ee(r)?r:0,!isNaN(s)&&!isNaN(o)&&s>0&&o>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){l=Math.min((s-2*r)/n.w,(o-2*r)/n.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var u={x:(s-l*(n.x1+n.x2))/2,y:(o-l*(n.y1+n.y2))/2};return{zoom:l,pan:u}}}}},zoomRange:function(e,r){var n=this._private;if(r==null){var i=e;e=i.min,r=i.max}return Ee(e)&&Ee(r)&&e<=r?(n.minZoom=e,n.maxZoom=r):Ee(e)&&r===void 0&&e<=n.maxZoom?n.minZoom=e:Ee(r)&&e===void 0&&r>=n.minZoom&&(n.maxZoom=r),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var r=this._private,n=r.pan,i=r.zoom,a,s,o=!1;if(r.zoomingEnabled||(o=!0),Ee(e)?s=e:Mt(e)&&(s=e.level,e.position!=null?a=Zy(e.position,i,n):e.renderedPosition!=null&&(a=e.renderedPosition),a!=null&&!r.panningEnabled&&(o=!0)),s=s>r.maxZoom?r.maxZoom:s,s=s<r.minZoom?r.minZoom:s,o||!Ee(s)||s===i||a!=null&&(!Ee(a.x)||!Ee(a.y)))return null;if(a!=null){var l=n,u=i,c=s,d={x:-c/u*(a.x-l.x)+a.x,y:-c/u*(a.y-l.y)+a.y};return{zoomed:!0,panned:!0,zoom:c,pan:d}}else return{zoomed:!0,panned:!1,zoom:s,pan:n}},zoom:function(e){if(e===void 0)return this._private.zoom;var r=this.getZoomedViewport(e),n=this._private;return r==null||!r.zoomed?this:(n.zoom=r.zoom,r.panned&&(n.pan.x=r.pan.x,n.pan.y=r.pan.y),this.emit("zoom"+(r.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var r=this._private,n=!0,i=!0,a=[],s=!1,o=!1;if(!e)return this;if(Ee(e.zoom)||(n=!1),Mt(e.pan)||(i=!1),!n&&!i)return this;if(n){var l=e.zoom;l<r.minZoom||l>r.maxZoom||!r.zoomingEnabled?s=!0:(r.zoom=l,a.push("zoom"))}if(i&&(!s||!e.cancelOnFailedZoom)&&r.panningEnabled){var u=e.pan;Ee(u.x)&&(r.pan.x=u.x,o=!1),Ee(u.y)&&(r.pan.y=u.y,o=!1),o||a.push("pan")}return a.length>0&&(a.push("viewport"),this.emit(a.join(" ")),this.notify("viewport")),this},center:function(e){var r=this.getCenterPan(e);return r&&(this._private.pan=r,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,r){if(this._private.panningEnabled){if(Ke(e)){var n=e;e=this.mutableElements().filter(n)}else Ai(e)||(e=this.mutableElements());if(e.length!==0){var i=e.boundingBox(),a=this.width(),s=this.height();r=r===void 0?this._private.zoom:r;var o={x:(a-r*(i.x1+i.x2))/2,y:(s-r*(i.y1+i.y2))/2};return o}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,r=e.container,n=this;return e.sizeCache=e.sizeCache||(r?function(){var i=n.window().getComputedStyle(r),a=function(o){return parseFloat(i.getPropertyValue(o))};return{width:r.clientWidth-a("padding-left")-a("padding-right"),height:r.clientHeight-a("padding-top")-a("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,r=this._private.zoom,n=this.renderedExtent(),i={x1:(n.x1-e.x)/r,x2:(n.x2-e.x)/r,y1:(n.y1-e.y)/r,y2:(n.y2-e.y)/r};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var e=this.width(),r=this.height();return{x1:0,y1:0,x2:e,y2:r,w:e,h:r}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};Vu.centre=Vu.center;Vu.autolockNodes=Vu.autolock;Vu.autoungrabifyNodes=Vu.autoungrabify;var Cp={data:It.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:It.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:It.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:It.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};Cp.attr=Cp.data;Cp.removeAttr=Cp.removeData;var Np=function(e){var r=this;e=Qe({},e);var n=e.container;n&&!w0(n)&&w0(n[0])&&(n=n[0]);var i=n?n._cyreg:null;i=i||{},i&&i.cy&&(i.cy.destroy(),i={});var a=i.readies=i.readies||[];n&&(n._cyreg=i),i.cy=r;var s=Yr!==void 0&&n!==void 0&&!e.headless,o=e;o.layout=Qe({name:s?"grid":"null"},o.layout),o.renderer=Qe({name:s?"canvas":"null"},o.renderer);var l=function(v,x,y){return x!==void 0?x:y!==void 0?y:v},u=this._private={container:n,ready:!1,options:o,elements:new Tn(this),listeners:[],aniEles:new Tn(this),data:o.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,o.zoomingEnabled),userZoomingEnabled:l(!0,o.userZoomingEnabled),panningEnabled:l(!0,o.panningEnabled),userPanningEnabled:l(!0,o.userPanningEnabled),boxSelectionEnabled:l(!0,o.boxSelectionEnabled),autolock:l(!1,o.autolock,o.autolockNodes),autoungrabify:l(!1,o.autoungrabify,o.autoungrabifyNodes),autounselectify:l(!1,o.autounselectify),styleEnabled:o.styleEnabled===void 0?s:o.styleEnabled,zoom:Ee(o.zoom)?o.zoom:1,pan:{x:Mt(o.pan)&&Ee(o.pan.x)?o.pan.x:0,y:Mt(o.pan)&&Ee(o.pan.y)?o.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,o.multiClickDebounceTime)};this.createEmitter(),this.selectionType(o.selectionType),this.zoomRange({min:o.minZoom,max:o.maxZoom});var c=function(v,x){var y=v.some($$);if(y)return nf.all(v).then(x);x(v)};u.styleEnabled&&r.setStyle([]);var d=Qe({},o,o.renderer);r.initRenderer(d);var h=function(v,x,y){r.notifications(!1);var b=r.mutableElements();b.length>0&&b.remove(),v!=null&&(Mt(v)||Ht(v))&&r.add(v),r.one("layoutready",function(w){r.notifications(!0),r.emit(w),r.one("load",x),r.emitAndNotify("load")}).one("layoutstop",function(){r.one("done",y),r.emit("done")});var S=Qe({},r._private.options.layout);S.eles=r.elements(),r.layout(S).run()};c([o.style,o.elements],function(m){var v=m[0],x=m[1];u.styleEnabled&&r.style().append(v),h(x,function(){r.startAnimationLoop(),u.ready=!0,vr(o.ready)&&r.on("ready",o.ready);for(var y=0;y<a.length;y++){var b=a[y];r.on("ready",b)}i&&(i.readies=[]),r.emit("ready")},o.done)})},j0=Np.prototype;Qe(j0,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return Yr;var r=this._private.container.ownerDocument;return r===void 0||r==null?Yr:r.defaultView||Yr},mount:function(e){if(e!=null){var r=this,n=r._private,i=n.options;return!w0(e)&&w0(e[0])&&(e=e[0]),r.stopAnimationLoop(),r.destroyRenderer(),n.container=e,n.styleEnabled=!0,r.invalidateSize(),r.initRenderer(Qe({},i,i.renderer,{name:i.renderer.name==="null"?"canvas":i.renderer.name})),r.startAnimationLoop(),r.style(i.style),r.emit("mount"),r}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return ss(this._private.options)},json:function(e){var r=this,n=r._private,i=r.mutableElements(),a=function(k){return r.getElementById(k.id())};if(Mt(e)){if(r.startBatch(),e.elements){var s={},o=function(k,N){for(var T=[],j=[],M=0;M<k.length;M++){var A=k[M];if(!A.data.id){Lt("cy.json() cannot handle elements without an ID attribute");continue}var P=""+A.data.id,D=r.getElementById(P);s[P]=!0,D.length!==0?j.push({ele:D,json:A}):(N&&(A.group=N),T.push(A))}r.add(T);for(var R=0;R<j.length;R++){var I=j[R],U=I.ele,B=I.json;U.json(B)}};if(Ht(e.elements))o(e.elements);else for(var l=["nodes","edges"],u=0;u<l.length;u++){var c=l[u],d=e.elements[c];Ht(d)&&o(d,c)}var h=r.collection();i.filter(function(w){return!s[w.id()]}).forEach(function(w){w.isParent()?h.merge(w):w.remove()}),h.forEach(function(w){return w.children().move({parent:null})}),h.forEach(function(w){return a(w).remove()})}e.style&&r.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&r.zoom(e.zoom),e.pan&&(e.pan.x!==n.pan.x||e.pan.y!==n.pan.y)&&r.pan(e.pan),e.data&&r.data(e.data);for(var m=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],v=0;v<m.length;v++){var x=m[v];e[x]!=null&&r[x](e[x])}return r.endBatch(),this}else{var y=!!e,b={};y?b.elements=this.elements().map(function(w){return w.json()}):(b.elements={},i.forEach(function(w){var k=w.group();b.elements[k]||(b.elements[k]=[]),b.elements[k].push(w.json())})),this._private.styleEnabled&&(b.style=r.style().json()),b.data=ss(r.data());var S=n.options;return b.zoomingEnabled=n.zoomingEnabled,b.userZoomingEnabled=n.userZoomingEnabled,b.zoom=n.zoom,b.minZoom=n.minZoom,b.maxZoom=n.maxZoom,b.panningEnabled=n.panningEnabled,b.userPanningEnabled=n.userPanningEnabled,b.pan=ss(n.pan),b.boxSelectionEnabled=n.boxSelectionEnabled,b.renderer=ss(S.renderer),b.hideEdgesOnViewport=S.hideEdgesOnViewport,b.textureOnViewport=S.textureOnViewport,b.wheelSensitivity=S.wheelSensitivity,b.motionBlur=S.motionBlur,b.multiClickDebounceTime=S.multiClickDebounceTime,b}}});j0.$id=j0.getElementById;[$W,qW,DR,H5,Av,YW,W5,Rv,JW,Vu,Cp].forEach(function(t){Qe(j0,t)});var eq={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}},tq={maximal:!1,acyclic:!1},_c=function(e){return e.scratch("breadthfirst")},M8=function(e,r){return e.scratch("breadthfirst",r)};function OR(t){this.options=Qe({},eq,tq,t)}OR.prototype.run=function(){var t=this.options,e=t.cy,r=t.eles,n=r.nodes().filter(function(Ge){return Ge.isChildless()}),i=r,a=t.directed,s=t.acyclic||t.maximal||t.maximalAdjustments>0,o=!!t.boundingBox,l=ei(o?t.boundingBox:structuredClone(e.extent())),u;if(Ai(t.roots))u=t.roots;else if(Ht(t.roots)){for(var c=[],d=0;d<t.roots.length;d++){var h=t.roots[d],m=e.getElementById(h);c.push(m)}u=e.collection(c)}else if(Ke(t.roots))u=e.$(t.roots);else if(a)u=n.roots();else{var v=r.components();u=e.collection();for(var x=function(){var Ce=v[y],De=Ce.maxDegree(!1),Ve=Ce.filter(function(We){return We.degree(!1)===De});u=u.add(Ve)},y=0;y<v.length;y++)x()}var b=[],S={},w=function(Ce,De){b[De]==null&&(b[De]=[]);var Ve=b[De].length;b[De].push(Ce),M8(Ce,{index:Ve,depth:De})},k=function(Ce,De){var Ve=_c(Ce),We=Ve.depth,Ie=Ve.index;b[We][Ie]=null,Ce.isChildless()&&w(Ce,De)};i.bfs({roots:u,directed:t.directed,visit:function(Ce,De,Ve,We,Ie){var rt=Ce[0],ut=rt.id();rt.isChildless()&&w(rt,Ie),S[ut]=!0}});for(var N=[],T=0;T<n.length;T++){var j=n[T];S[j.id()]||N.push(j)}var M=function(Ce){for(var De=b[Ce],Ve=0;Ve<De.length;Ve++){var We=De[Ve];if(We==null){De.splice(Ve,1),Ve--;continue}M8(We,{depth:Ce,index:Ve})}},A=function(Ce,De){for(var Ve=_c(Ce),We=Ce.incomers().filter(function(Je){return Je.isNode()&&r.has(Je)}),Ie=-1,rt=Ce.id(),ut=0;ut<We.length;ut++){var xt=We[ut],bt=_c(xt);Ie=Math.max(Ie,bt.depth)}if(Ve.depth<=Ie){if(!t.acyclic&&De[rt])return null;var Nt=Ie+1;return k(Ce,Nt),De[rt]=Nt,!0}return!1};if(a&&s){var P=[],D={},R=function(Ce){return P.push(Ce)},I=function(){return P.shift()};for(n.forEach(function(Ge){return P.push(Ge)});P.length>0;){var U=I(),B=A(U,D);if(B)U.outgoers().filter(function(Ge){return Ge.isNode()&&r.has(Ge)}).forEach(R);else if(B===null){Lt("Detected double maximal shift for node `"+U.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var z=0;if(t.avoidOverlap)for(var F=0;F<n.length;F++){var V=n[F],J=V.layoutDimensions(t),Y=J.w,L=J.h;z=Math.max(z,Y,L)}var G={},ee=function(Ce){if(G[Ce.id()])return G[Ce.id()];for(var De=_c(Ce).depth,Ve=Ce.neighborhood(),We=0,Ie=0,rt=0;rt<Ve.length;rt++){var ut=Ve[rt];if(!(ut.isEdge()||ut.isParent()||!n.has(ut))){var xt=_c(ut);if(xt!=null){var bt=xt.index,Nt=xt.depth;if(!(bt==null||Nt==null)){var Je=b[Nt].length;Nt<De&&(We+=bt/Je,Ie++)}}}}return Ie=Math.max(1,Ie),We=We/Ie,Ie===0&&(We=0),G[Ce.id()]=We,We},re=function(Ce,De){var Ve=ee(Ce),We=ee(De),Ie=Ve-We;return Ie===0?IA(Ce.id(),De.id()):Ie};t.depthSort!==void 0&&(re=t.depthSort);for(var se=b.length,de=0;de<se;de++)b[de].sort(re),M(de);for(var W=[],ne=0;ne<N.length;ne++)W.push(N[ne]);var ie=function(){for(var Ce=0;Ce<se;Ce++)M(Ce)};W.length&&(b.unshift(W),se=b.length,ie());for(var $=0,q=0;q<se;q++)$=Math.max(b[q].length,$);var te={x:l.x1+l.w/2,y:l.y1+l.h/2},Z=n.reduce(function(Ge,Ce){return function(De){return{w:Ge.w===-1?De.w:(Ge.w+De.w)/2,h:Ge.h===-1?De.h:(Ge.h+De.h)/2}}(Ce.boundingBox({includeLabels:t.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),le=Math.max(se===1?0:o?(l.h-t.padding*2-Z.h)/(se-1):(l.h-t.padding*2-Z.h)/(se+1),z),ge=b.reduce(function(Ge,Ce){return Math.max(Ge,Ce.length)},0),Ue=function(Ce){var De=_c(Ce),Ve=De.depth,We=De.index;if(t.circle){var Ie=Math.min(l.w/2/se,l.h/2/se);Ie=Math.max(Ie,z);var rt=Ie*Ve+Ie-(se>0&&b[0].length<=3?Ie/2:0),ut=2*Math.PI/b[Ve].length*We;return Ve===0&&b[0].length===1&&(rt=1),{x:te.x+rt*Math.cos(ut),y:te.y+rt*Math.sin(ut)}}else{var xt=b[Ve].length,bt=Math.max(xt===1?0:o?(l.w-t.padding*2-Z.w)/((t.grid?ge:xt)-1):(l.w-t.padding*2-Z.w)/((t.grid?ge:xt)+1),z),Nt={x:te.x+(We+1-(xt+1)/2)*bt,y:te.y+(Ve+1-(se+1)/2)*le};return Nt}},Te={downward:0,leftward:90,upward:180,rightward:-90};Object.keys(Te).indexOf(t.direction)===-1&&lr("Invalid direction '".concat(t.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(Te).join(", ")));var Re=function(Ce){return vU(Ue(Ce),l,Te[t.direction])};return r.nodes().layoutPositions(this,t,Re),this};var rq={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function IR(t){this.options=Qe({},rq,t)}IR.prototype.run=function(){var t=this.options,e=t,r=t.cy,n=e.eles,i=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,a=n.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));for(var s=ei(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()}),o={x:s.x1+s.w/2,y:s.y1+s.h/2},l=e.sweep===void 0?2*Math.PI-2*Math.PI/a.length:e.sweep,u=l/Math.max(1,a.length-1),c,d=0,h=0;h<a.length;h++){var m=a[h],v=m.layoutDimensions(e),x=v.w,y=v.h;d=Math.max(d,x,y)}if(Ee(e.radius)?c=e.radius:a.length<=1?c=0:c=Math.min(s.h,s.w)/2-d,a.length>1&&e.avoidOverlap){d*=1.75;var b=Math.cos(u)-Math.cos(0),S=Math.sin(u)-Math.sin(0),w=Math.sqrt(d*d/(b*b+S*S));c=Math.max(w,c)}var k=function(T,j){var M=e.startAngle+j*u*(i?1:-1),A=c*Math.cos(M),P=c*Math.sin(M),D={x:o.x+A,y:o.y+P};return D};return n.nodes().layoutPositions(this,e,k),this};var nq={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function LR(t){this.options=Qe({},nq,t)}LR.prototype.run=function(){for(var t=this.options,e=t,r=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,n=t.cy,i=e.eles,a=i.nodes().not(":parent"),s=ei(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),o={x:s.x1+s.w/2,y:s.y1+s.h/2},l=[],u=0,c=0;c<a.length;c++){var d=a[c],h=void 0;h=e.concentric(d),l.push({value:h,node:d}),d._private.scratch.concentric=h}a.updateStyle();for(var m=0;m<a.length;m++){var v=a[m],x=v.layoutDimensions(e);u=Math.max(u,x.w,x.h)}l.sort(function(le,ge){return ge.value-le.value});for(var y=e.levelWidth(a),b=[[]],S=b[0],w=0;w<l.length;w++){var k=l[w];if(S.length>0){var N=Math.abs(S[0].value-k.value);N>=y&&(S=[],b.push(S))}S.push(k)}var T=u+e.minNodeSpacing;if(!e.avoidOverlap){var j=b.length>0&&b[0].length>1,M=Math.min(s.w,s.h)/2-T,A=M/(b.length+j?1:0);T=Math.min(T,A)}for(var P=0,D=0;D<b.length;D++){var R=b[D],I=e.sweep===void 0?2*Math.PI-2*Math.PI/R.length:e.sweep,U=R.dTheta=I/Math.max(1,R.length-1);if(R.length>1&&e.avoidOverlap){var B=Math.cos(U)-Math.cos(0),z=Math.sin(U)-Math.sin(0),F=Math.sqrt(T*T/(B*B+z*z));P=Math.max(F,P)}R.r=P,P+=T}if(e.equidistant){for(var V=0,J=0,Y=0;Y<b.length;Y++){var L=b[Y],G=L.r-J;V=Math.max(V,G)}J=0;for(var ee=0;ee<b.length;ee++){var re=b[ee];ee===0&&(J=re.r),re.r=J,J+=V}}for(var se={},de=0;de<b.length;de++)for(var W=b[de],ne=W.dTheta,ie=W.r,$=0;$<W.length;$++){var q=W[$],te=e.startAngle+(r?1:-1)*ne*$,Z={x:o.x+ie*Math.cos(te),y:o.y+ie*Math.sin(te)};se[q.node.id()]=Z}return i.nodes().layoutPositions(this,e,function(le){var ge=le.id();return se[ge]}),this};var R2,iq={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,r){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function dx(t){this.options=Qe({},iq,t),this.options.layout=this;var e=this.options.eles.nodes(),r=this.options.eles.edges(),n=r.filter(function(i){var a=i.source().data("id"),s=i.target().data("id"),o=e.some(function(u){return u.data("id")===a}),l=e.some(function(u){return u.data("id")===s});return!o||!l});this.options.eles=this.options.eles.not(n)}dx.prototype.run=function(){var t=this.options,e=t.cy,r=this;r.stopped=!1,(t.animate===!0||t.animate===!1)&&r.emit({type:"layoutstart",layout:r}),t.debug===!0?R2=!0:R2=!1;var n=aq(e,r,t);R2&&oq(n),t.randomize&&lq(n);var i=eo(),a=function(){uq(n,e,t),t.fit===!0&&e.fit(t.padding)},s=function(h){return!(r.stopped||h>=t.numIter||(cq(n,t),n.temperature=n.temperature*t.coolingFactor,n.temperature<t.minTemp))},o=function(){if(t.animate===!0||t.animate===!1)a(),r.one("layoutstop",t.stop),r.emit({type:"layoutstop",layout:r});else{var h=t.eles.nodes(),m=FR(n,t,h);h.layoutPositions(r,t,m)}},l=0,u=!0;if(t.animate===!0){var c=function(){for(var h=0;u&&h<t.refresh;)u=s(l),l++,h++;if(!u)_8(n,t),o();else{var m=eo();m-i>=t.animationThreshold&&a(),S0(c)}};c()}else{for(;u;)u=s(l),l++;_8(n,t),o()}return this};dx.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};dx.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var aq=function(e,r,n){for(var i=n.eles.edges(),a=n.eles.nodes(),s=ei(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),o={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:n.initialTemp,clientWidth:s.w,clientHeight:s.h,boundingBox:s},l=n.eles.components(),u={},c=0;c<l.length;c++)for(var d=l[c],h=0;h<d.length;h++){var m=d[h];u[m.id()]=c}for(var c=0;c<o.nodeSize;c++){var v=a[c],x=v.layoutDimensions(n),y={};y.isLocked=v.locked(),y.id=v.data("id"),y.parentId=v.data("parent"),y.cmptId=u[v.id()],y.children=[],y.positionX=v.position("x"),y.positionY=v.position("y"),y.offsetX=0,y.offsetY=0,y.height=x.w,y.width=x.h,y.maxX=y.positionX+y.width/2,y.minX=y.positionX-y.width/2,y.maxY=y.positionY+y.height/2,y.minY=y.positionY-y.height/2,y.padLeft=parseFloat(v.style("padding")),y.padRight=parseFloat(v.style("padding")),y.padTop=parseFloat(v.style("padding")),y.padBottom=parseFloat(v.style("padding")),y.nodeRepulsion=vr(n.nodeRepulsion)?n.nodeRepulsion(v):n.nodeRepulsion,o.layoutNodes.push(y),o.idToIndex[y.id]=c}for(var b=[],S=0,w=-1,k=[],c=0;c<o.nodeSize;c++){var v=o.layoutNodes[c],N=v.parentId;N!=null?o.layoutNodes[o.idToIndex[N]].children.push(v.id):(b[++w]=v.id,k.push(v.id))}for(o.graphSet.push(k);S<=w;){var T=b[S++],j=o.idToIndex[T],m=o.layoutNodes[j],M=m.children;if(M.length>0){o.graphSet.push(M);for(var c=0;c<M.length;c++)b[++w]=M[c]}}for(var c=0;c<o.graphSet.length;c++)for(var A=o.graphSet[c],h=0;h<A.length;h++){var P=o.idToIndex[A[h]];o.indexToGraph[P]=c}for(var c=0;c<o.edgeSize;c++){var D=i[c],R={};R.id=D.data("id"),R.sourceId=D.data("source"),R.targetId=D.data("target");var I=vr(n.idealEdgeLength)?n.idealEdgeLength(D):n.idealEdgeLength,U=vr(n.edgeElasticity)?n.edgeElasticity(D):n.edgeElasticity,B=o.idToIndex[R.sourceId],z=o.idToIndex[R.targetId],F=o.indexToGraph[B],V=o.indexToGraph[z];if(F!=V){for(var J=sq(R.sourceId,R.targetId,o),Y=o.graphSet[J],L=0,y=o.layoutNodes[B];Y.indexOf(y.id)===-1;)y=o.layoutNodes[o.idToIndex[y.parentId]],L++;for(y=o.layoutNodes[z];Y.indexOf(y.id)===-1;)y=o.layoutNodes[o.idToIndex[y.parentId]],L++;I*=L*n.nestingFactor}R.idealLength=I,R.elasticity=U,o.layoutEdges.push(R)}return o},sq=function(e,r,n){var i=BR(e,r,0,n);return 2>i.count?0:i.graph},BR=function(e,r,n,i){var a=i.graphSet[n];if(-1<a.indexOf(e)&&-1<a.indexOf(r))return{count:2,graph:n};for(var s=0,o=0;o<a.length;o++){var l=a[o],u=i.idToIndex[l],c=i.layoutNodes[u].children;if(c.length!==0){var d=i.indexToGraph[i.idToIndex[c[0]]],h=BR(e,r,d,i);if(h.count!==0)if(h.count===1){if(s++,s===2)break}else return h}}return{count:s,graph:n}},oq,lq=function(e,r){for(var n=e.clientWidth,i=e.clientHeight,a=0;a<e.nodeSize;a++){var s=e.layoutNodes[a];s.children.length===0&&!s.isLocked&&(s.positionX=Math.random()*n,s.positionY=Math.random()*i)}},FR=function(e,r,n){var i=e.boundingBox,a={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return r.boundingBox&&(n.forEach(function(s){var o=e.layoutNodes[e.idToIndex[s.data("id")]];a.x1=Math.min(a.x1,o.positionX),a.x2=Math.max(a.x2,o.positionX),a.y1=Math.min(a.y1,o.positionY),a.y2=Math.max(a.y2,o.positionY)}),a.w=a.x2-a.x1,a.h=a.y2-a.y1),function(s,o){var l=e.layoutNodes[e.idToIndex[s.data("id")]];if(r.boundingBox){var u=a.w===0?.5:(l.positionX-a.x1)/a.w,c=a.h===0?.5:(l.positionY-a.y1)/a.h;return{x:i.x1+u*i.w,y:i.y1+c*i.h}}else return{x:l.positionX,y:l.positionY}}},uq=function(e,r,n){var i=n.layout,a=n.eles.nodes(),s=FR(e,n,a);a.positions(s),e.ready!==!0&&(e.ready=!0,i.one("layoutready",n.ready),i.emit({type:"layoutready",layout:this}))},cq=function(e,r,n){dq(e,r),pq(e),mq(e,r),gq(e),vq(e)},dq=function(e,r){for(var n=0;n<e.graphSet.length;n++)for(var i=e.graphSet[n],a=i.length,s=0;s<a;s++)for(var o=e.layoutNodes[e.idToIndex[i[s]]],l=s+1;l<a;l++){var u=e.layoutNodes[e.idToIndex[i[l]]];fq(o,u,e,r)}},P8=function(e){return-1+2*e*Math.random()},fq=function(e,r,n,i){var a=e.cmptId,s=r.cmptId;if(!(a!==s&&!n.isCompound)){var o=r.positionX-e.positionX,l=r.positionY-e.positionY,u=1;o===0&&l===0&&(o=P8(u),l=P8(u));var c=hq(e,r,o,l);if(c>0)var d=i.nodeOverlap*c,h=Math.sqrt(o*o+l*l),m=d*o/h,v=d*l/h;else var x=M0(e,o,l),y=M0(r,-1*o,-1*l),b=y.x-x.x,S=y.y-x.y,w=b*b+S*S,h=Math.sqrt(w),d=(e.nodeRepulsion+r.nodeRepulsion)/w,m=d*b/h,v=d*S/h;e.isLocked||(e.offsetX-=m,e.offsetY-=v),r.isLocked||(r.offsetX+=m,r.offsetY+=v)}},hq=function(e,r,n,i){if(n>0)var a=e.maxX-r.minX;else var a=r.maxX-e.minX;if(i>0)var s=e.maxY-r.minY;else var s=r.maxY-e.minY;return a>=0&&s>=0?Math.sqrt(a*a+s*s):0},M0=function(e,r,n){var i=e.positionX,a=e.positionY,s=e.height||1,o=e.width||1,l=n/r,u=s/o,c={};return r===0&&0<n||r===0&&0>n?(c.x=i,c.y=a+s/2,c):0<r&&-1*u<=l&&l<=u?(c.x=i+o/2,c.y=a+o*n/2/r,c):0>r&&-1*u<=l&&l<=u?(c.x=i-o/2,c.y=a-o*n/2/r,c):0<n&&(l<=-1*u||l>=u)?(c.x=i+s*r/2/n,c.y=a+s/2,c):(0>n&&(l<=-1*u||l>=u)&&(c.x=i-s*r/2/n,c.y=a-s/2),c)},pq=function(e,r){for(var n=0;n<e.edgeSize;n++){var i=e.layoutEdges[n],a=e.idToIndex[i.sourceId],s=e.layoutNodes[a],o=e.idToIndex[i.targetId],l=e.layoutNodes[o],u=l.positionX-s.positionX,c=l.positionY-s.positionY;if(!(u===0&&c===0)){var d=M0(s,u,c),h=M0(l,-1*u,-1*c),m=h.x-d.x,v=h.y-d.y,x=Math.sqrt(m*m+v*v),y=Math.pow(i.idealLength-x,2)/i.elasticity;if(x!==0)var b=y*m/x,S=y*v/x;else var b=0,S=0;s.isLocked||(s.offsetX+=b,s.offsetY+=S),l.isLocked||(l.offsetX-=b,l.offsetY-=S)}}},mq=function(e,r){if(r.gravity!==0)for(var n=1,i=0;i<e.graphSet.length;i++){var a=e.graphSet[i],s=a.length;if(i===0)var o=e.clientHeight/2,l=e.clientWidth/2;else var u=e.layoutNodes[e.idToIndex[a[0]]],c=e.layoutNodes[e.idToIndex[u.parentId]],o=c.positionX,l=c.positionY;for(var d=0;d<s;d++){var h=e.layoutNodes[e.idToIndex[a[d]]];if(!h.isLocked){var m=o-h.positionX,v=l-h.positionY,x=Math.sqrt(m*m+v*v);if(x>n){var y=r.gravity*m/x,b=r.gravity*v/x;h.offsetX+=y,h.offsetY+=b}}}}},gq=function(e,r){var n=[],i=0,a=-1;for(n.push.apply(n,e.graphSet[0]),a+=e.graphSet[0].length;i<=a;){var s=n[i++],o=e.idToIndex[s],l=e.layoutNodes[o],u=l.children;if(0<u.length&&!l.isLocked){for(var c=l.offsetX,d=l.offsetY,h=0;h<u.length;h++){var m=e.layoutNodes[e.idToIndex[u[h]]];m.offsetX+=c,m.offsetY+=d,n[++a]=u[h]}l.offsetX=0,l.offsetY=0}}},vq=function(e,r){for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];if(!(0<i.children.length||i.isLocked)){var a=yq(i.offsetX,i.offsetY,e.temperature);i.positionX+=a.x,i.positionY+=a.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,zR(i,e)}}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},yq=function(e,r,n){var i=Math.sqrt(e*e+r*r);if(i>n)var a={x:n*e/i,y:n*r/i};else var a={x:e,y:r};return a},zR=function(e,r){var n=e.parentId;if(n!=null){var i=r.layoutNodes[r.idToIndex[n]],a=!1;if((i.maxX==null||e.maxX+i.padRight>i.maxX)&&(i.maxX=e.maxX+i.padRight,a=!0),(i.minX==null||e.minX-i.padLeft<i.minX)&&(i.minX=e.minX-i.padLeft,a=!0),(i.maxY==null||e.maxY+i.padBottom>i.maxY)&&(i.maxY=e.maxY+i.padBottom,a=!0),(i.minY==null||e.minY-i.padTop<i.minY)&&(i.minY=e.minY-i.padTop,a=!0),a)return zR(i,r)}},_8=function(e,r){for(var n=e.layoutNodes,i=[],a=0;a<n.length;a++){var s=n[a],o=s.cmptId,l=i[o]=i[o]||[];l.push(s)}for(var u=0,a=0;a<i.length;a++){var c=i[a];if(c){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var d=0;d<c.length;d++){var h=c[d];c.x1=Math.min(c.x1,h.positionX-h.width/2),c.x2=Math.max(c.x2,h.positionX+h.width/2),c.y1=Math.min(c.y1,h.positionY-h.height/2),c.y2=Math.max(c.y2,h.positionY+h.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,u+=c.w*c.h}}i.sort(function(S,w){return w.w*w.h-S.w*S.h});for(var m=0,v=0,x=0,y=0,b=Math.sqrt(u)*e.clientWidth/e.clientHeight,a=0;a<i.length;a++){var c=i[a];if(c){for(var d=0;d<c.length;d++){var h=c[d];h.isLocked||(h.positionX+=m-c.x1,h.positionY+=v-c.y1)}m+=c.w+r.componentSpacing,x+=c.w+r.componentSpacing,y=Math.max(y,c.h),x>b&&(v+=y+r.componentSpacing,m=0,x=0,y=0)}}},xq={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function VR(t){this.options=Qe({},xq,t)}VR.prototype.run=function(){var t=this.options,e=t,r=t.cy,n=e.eles,i=n.nodes().not(":parent");e.sort&&(i=i.sort(e.sort));var a=ei(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()});if(a.h===0||a.w===0)n.nodes().layoutPositions(this,e,function(ee){return{x:a.x1,y:a.y1}});else{var s=i.size(),o=Math.sqrt(s*a.h/a.w),l=Math.round(o),u=Math.round(a.w/a.h*o),c=function(re){if(re==null)return Math.min(l,u);var se=Math.min(l,u);se==l?l=re:u=re},d=function(re){if(re==null)return Math.max(l,u);var se=Math.max(l,u);se==l?l=re:u=re},h=e.rows,m=e.cols!=null?e.cols:e.columns;if(h!=null&&m!=null)l=h,u=m;else if(h!=null&&m==null)l=h,u=Math.ceil(s/l);else if(h==null&&m!=null)u=m,l=Math.ceil(s/u);else if(u*l>s){var v=c(),x=d();(v-1)*x>=s?c(v-1):(x-1)*v>=s&&d(x-1)}else for(;u*l<s;){var y=c(),b=d();(b+1)*y>=s?d(b+1):c(y+1)}var S=a.w/u,w=a.h/l;if(e.condense&&(S=0,w=0),e.avoidOverlap)for(var k=0;k<i.length;k++){var N=i[k],T=N._private.position;(T.x==null||T.y==null)&&(T.x=0,T.y=0);var j=N.layoutDimensions(e),M=e.avoidOverlapPadding,A=j.w+M,P=j.h+M;S=Math.max(S,A),w=Math.max(w,P)}for(var D={},R=function(re,se){return!!D["c-"+re+"-"+se]},I=function(re,se){D["c-"+re+"-"+se]=!0},U=0,B=0,z=function(){B++,B>=u&&(B=0,U++)},F={},V=0;V<i.length;V++){var J=i[V],Y=e.position(J);if(Y&&(Y.row!==void 0||Y.col!==void 0)){var L={row:Y.row,col:Y.col};if(L.col===void 0)for(L.col=0;R(L.row,L.col);)L.col++;else if(L.row===void 0)for(L.row=0;R(L.row,L.col);)L.row++;F[J.id()]=L,I(L.row,L.col)}}var G=function(re,se){var de,W;if(re.locked()||re.isParent())return!1;var ne=F[re.id()];if(ne)de=ne.col*S+S/2+a.x1,W=ne.row*w+w/2+a.y1;else{for(;R(U,B);)z();de=B*S+S/2+a.x1,W=U*w+w/2+a.y1,I(U,B),z()}return{x:de,y:W}};i.layoutPositions(this,e,G)}return this};var bq={ready:function(){},stop:function(){}};function f3(t){this.options=Qe({},bq,t)}f3.prototype.run=function(){var t=this.options,e=t.eles,r=this;return t.cy,r.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),r.one("layoutready",t.ready),r.emit("layoutready"),r.one("layoutstop",t.stop),r.emit("layoutstop"),this};f3.prototype.stop=function(){return this};var wq={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function $R(t){this.options=Qe({},wq,t)}$R.prototype.run=function(){var t=this.options,e=t.eles,r=e.nodes(),n=vr(t.positions);function i(a){if(t.positions==null)return UU(a.position());if(n)return t.positions(a);var s=t.positions[a._private.data.id];return s??null}return r.layoutPositions(this,t,function(a,s){var o=i(a);return a.locked()||o==null?!1:o}),this};var Sq={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function UR(t){this.options=Qe({},Sq,t)}UR.prototype.run=function(){var t=this.options,e=t.cy,r=t.eles,n=ei(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),i=function(s,o){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};return r.nodes().layoutPositions(this,t,i),this};var kq=[{name:"breadthfirst",impl:OR},{name:"circle",impl:IR},{name:"concentric",impl:LR},{name:"cose",impl:dx},{name:"grid",impl:VR},{name:"null",impl:f3},{name:"preset",impl:$R},{name:"random",impl:UR}];function GR(t){this.options=t,this.notifications=0}var A8=function(){},R8=function(){throw new Error("A headless instance can not render images")};GR.prototype={recalculateRenderedStyle:A8,notify:function(){this.notifications++},init:A8,isHeadless:function(){return!0},png:R8,jpg:R8};var h3={};h3.arrowShapeWidth=.3;h3.registerArrowShapes=function(){var t=this.arrowShapes={},e=this,r=function(u,c,d,h,m,v,x){var y=m.x-d/2-x,b=m.x+d/2+x,S=m.y-d/2-x,w=m.y+d/2+x,k=y<=u&&u<=b&&S<=c&&c<=w;return k},n=function(u,c,d,h,m){var v=u*Math.cos(h)-c*Math.sin(h),x=u*Math.sin(h)+c*Math.cos(h),y=v*d,b=x*d,S=y+m.x,w=b+m.y;return{x:S,y:w}},i=function(u,c,d,h){for(var m=[],v=0;v<u.length;v+=2){var x=u[v],y=u[v+1];m.push(n(x,y,c,d,h))}return m},a=function(u){for(var c=[],d=0;d<u.length;d++){var h=u[d];c.push(h.x,h.y)}return c},s=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},o=function(u,c){Ke(c)&&(c=t[c]),t[u]=Qe({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(h,m,v,x,y,b){var S=a(i(this.points,v+2*b,x,y)),w=pi(h,m,S);return w},roughCollide:r,draw:function(h,m,v,x){var y=i(this.points,m,v,x);e.arrowShapeImpl("polygon")(h,y)},spacing:function(h){return 0},gap:s},c)};o("none",{collide:k0,roughCollide:k0,draw:JC,spacing:qT,gap:qT}),o("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),o("arrow","triangle"),o("triangle-backcurve",{points:t.triangle.points,controlPoint:[0,-.15],roughCollide:r,draw:function(u,c,d,h,m){var v=i(this.points,c,d,h),x=this.controlPoint,y=n(x[0],x[1],c,d,h);e.arrowShapeImpl(this.name)(u,v,y)},gap:function(u){return s(u)*.8}}),o("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,c,d,h,m,v,x){var y=a(i(this.points,d+2*x,h,m)),b=a(i(this.pointsTee,d+2*x,h,m)),S=pi(u,c,y)||pi(u,c,b);return S},draw:function(u,c,d,h,m){var v=i(this.points,c,d,h),x=i(this.pointsTee,c,d,h);e.arrowShapeImpl(this.name)(u,v,x)}}),o("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,c,d,h,m,v,x){var y=m,b=Math.pow(y.x-u,2)+Math.pow(y.y-c,2)<=Math.pow((d+2*x)*this.radius,2),S=a(i(this.points,d+2*x,h,m));return pi(u,c,S)||b},draw:function(u,c,d,h,m){var v=i(this.pointsTr,c,d,h);e.arrowShapeImpl(this.name)(u,v,h.x,h.y,this.radius*c)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,c){var d=this.baseCrossLinePts.slice(),h=c/u,m=3,v=5;return d[m]=d[m]-h,d[v]=d[v]-h,d},collide:function(u,c,d,h,m,v,x){var y=a(i(this.points,d+2*x,h,m)),b=a(i(this.crossLinePts(d,v),d+2*x,h,m)),S=pi(u,c,y)||pi(u,c,b);return S},draw:function(u,c,d,h,m){var v=i(this.points,c,d,h),x=i(this.crossLinePts(c,m),c,d,h);e.arrowShapeImpl(this.name)(u,v,x)}}),o("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return s(u)*.525}}),o("circle",{radius:.15,collide:function(u,c,d,h,m,v,x){var y=m,b=Math.pow(y.x-u,2)+Math.pow(y.y-c,2)<=Math.pow((d+2*x)*this.radius,2);return b},draw:function(u,c,d,h,m){e.arrowShapeImpl(this.name)(u,h.x,h.y,this.radius*c)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),o("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),o("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),o("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};var Zu={};Zu.projectIntoViewport=function(t,e){var r=this.cy,n=this.findContainerClientCoords(),i=n[0],a=n[1],s=n[4],o=r.pan(),l=r.zoom(),u=((t-i)/s-o.x)/l,c=((e-a)/s-o.y)/l;return[u,c]};Zu.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var t=this.container,e=t.getBoundingClientRect(),r=this.cy.window().getComputedStyle(t),n=function(b){return parseFloat(r.getPropertyValue(b))},i={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")},a={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")},s=t.clientWidth,o=t.clientHeight,l=i.left+i.right,u=i.top+i.bottom,c=a.left+a.right,d=e.width/(s+c),h=s-l,m=o-u,v=e.left+i.left+a.left,x=e.top+i.top+a.top;return this.containerBB=[v,x,h,m,d]};Zu.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Zu.findNearestElement=function(t,e,r,n){return this.findNearestElements(t,e,r,n)[0]};Zu.findNearestElements=function(t,e,r,n){var i=this,a=this,s=a.getCachedZSortedEles(),o=[],l=a.cy.zoom(),u=a.cy.hasCompoundNodes(),c=(n?24:8)/l,d=(n?8:2)/l,h=(n?8:2)/l,m=1/0,v,x;r&&(s=s.interactive);function y(j,M){if(j.isNode()){if(x)return;x=j,o.push(j)}if(j.isEdge()&&(M==null||M<m))if(v){if(v.pstyle("z-compound-depth").value===j.pstyle("z-compound-depth").value&&v.pstyle("z-compound-depth").value===j.pstyle("z-compound-depth").value){for(var A=0;A<o.length;A++)if(o[A].isEdge()){o[A]=j,v=j,m=M??m;break}}}else o.push(j),v=j,m=M??m}function b(j){var M=j.outerWidth()+2*d,A=j.outerHeight()+2*d,P=M/2,D=A/2,R=j.position(),I=j.pstyle("corner-radius").value==="auto"?"auto":j.pstyle("corner-radius").pfValue,U=j._private.rscratch;if(R.x-P<=t&&t<=R.x+P&&R.y-D<=e&&e<=R.y+D){var B=a.nodeShapes[i.getNodeShape(j)];if(B.checkPoint(t,e,0,M,A,R.x,R.y,I,U))return y(j,0),!0}}function S(j){var M=j._private,A=M.rscratch,P=j.pstyle("width").pfValue,D=j.pstyle("arrow-scale").value,R=P/2+c,I=R*R,U=R*2,V=M.source,J=M.target,B;if(A.edgeType==="segments"||A.edgeType==="straight"||A.edgeType==="haystack"){for(var z=A.allpts,F=0;F+3<z.length;F+=2)if(nG(t,e,z[F],z[F+1],z[F+2],z[F+3],U)&&I>(B=lG(t,e,z[F],z[F+1],z[F+2],z[F+3])))return y(j,B),!0}else if(A.edgeType==="bezier"||A.edgeType==="multibezier"||A.edgeType==="self"||A.edgeType==="compound"){for(var z=A.allpts,F=0;F+5<A.allpts.length;F+=4)if(iG(t,e,z[F],z[F+1],z[F+2],z[F+3],z[F+4],z[F+5],U)&&I>(B=oG(t,e,z[F],z[F+1],z[F+2],z[F+3],z[F+4],z[F+5])))return y(j,B),!0}for(var V=V||M.source,J=J||M.target,Y=i.getArrowWidth(P,D),L=[{name:"source",x:A.arrowStartX,y:A.arrowStartY,angle:A.srcArrowAngle},{name:"target",x:A.arrowEndX,y:A.arrowEndY,angle:A.tgtArrowAngle},{name:"mid-source",x:A.midX,y:A.midY,angle:A.midsrcArrowAngle},{name:"mid-target",x:A.midX,y:A.midY,angle:A.midtgtArrowAngle}],F=0;F<L.length;F++){var G=L[F],ee=a.arrowShapes[j.pstyle(G.name+"-arrow-shape").value],re=j.pstyle("width").pfValue;if(ee.roughCollide(t,e,Y,G.angle,{x:G.x,y:G.y},re,c)&&ee.collide(t,e,Y,G.angle,{x:G.x,y:G.y},re,c))return y(j),!0}u&&o.length>0&&(b(V),b(J))}function w(j,M,A){return hi(j,M,A)}function k(j,M){var A=j._private,P=h,D;M?D=M+"-":D="",j.boundingBox();var R=A.labelBounds[M||"main"],I=j.pstyle(D+"label").value,U=j.pstyle("text-events").strValue==="yes";if(!(!U||!I)){var B=w(A.rscratch,"labelX",M),z=w(A.rscratch,"labelY",M),F=w(A.rscratch,"labelAngle",M),V=j.pstyle(D+"text-margin-x").pfValue,J=j.pstyle(D+"text-margin-y").pfValue,Y=R.x1-P-V,L=R.x2+P-V,G=R.y1-P-J,ee=R.y2+P-J;if(F){var re=Math.cos(F),se=Math.sin(F),de=function(Z,le){return Z=Z-B,le=le-z,{x:Z*re-le*se+B,y:Z*se+le*re+z}},W=de(Y,G),ne=de(Y,ee),ie=de(L,G),$=de(L,ee),q=[W.x+V,W.y+J,ie.x+V,ie.y+J,$.x+V,$.y+J,ne.x+V,ne.y+J];if(pi(t,e,q))return y(j),!0}else if(qo(R,t,e))return y(j),!0}}for(var N=s.length-1;N>=0;N--){var T=s[N];T.isNode()?b(T)||k(T):S(T)||k(T)||k(T,"source")||k(T,"target")}return o};Zu.getAllInBox=function(t,e,r,n){var i=this.getCachedZSortedEles().interactive,a=this.cy.zoom(),s=2/a,o=[],l=Math.min(t,r),u=Math.max(t,r),c=Math.min(e,n),d=Math.max(e,n);t=l,r=u,e=c,n=d;var h=ei({x1:t,y1:e,x2:r,y2:n}),m=[{x:h.x1,y:h.y1},{x:h.x2,y:h.y1},{x:h.x2,y:h.y2},{x:h.x1,y:h.y2}],v=[[m[0],m[1]],[m[1],m[2]],[m[2],m[3]],[m[3],m[0]]];function x(Z,le,ge){return hi(Z,le,ge)}function y(Z,le){var ge=Z._private,Ue=s,Te="";Z.boundingBox();var Re=ge.labelBounds.main;if(!Re)return null;var Ge=x(ge.rscratch,"labelX",le),Ce=x(ge.rscratch,"labelY",le),De=x(ge.rscratch,"labelAngle",le),Ve=Z.pstyle(Te+"text-margin-x").pfValue,We=Z.pstyle(Te+"text-margin-y").pfValue,Ie=Re.x1-Ue-Ve,rt=Re.x2+Ue-Ve,ut=Re.y1-Ue-We,xt=Re.y2+Ue-We;if(De){var bt=Math.cos(De),Nt=Math.sin(De),Je=function(ve,H){return ve=ve-Ge,H=H-Ce,{x:ve*bt-H*Nt+Ge,y:ve*Nt+H*bt+Ce}};return[Je(Ie,ut),Je(rt,ut),Je(rt,xt),Je(Ie,xt)]}else return[{x:Ie,y:ut},{x:rt,y:ut},{x:rt,y:xt},{x:Ie,y:xt}]}function b(Z,le,ge,Ue){function Te(Re,Ge,Ce){return(Ce.y-Re.y)*(Ge.x-Re.x)>(Ge.y-Re.y)*(Ce.x-Re.x)}return Te(Z,ge,Ue)!==Te(le,ge,Ue)&&Te(Z,le,ge)!==Te(Z,le,Ue)}for(var S=0;S<i.length;S++){var w=i[S];if(w.isNode()){var k=w,N=k.pstyle("text-events").strValue==="yes",T=k.pstyle("box-selection").strValue,j=k.pstyle("box-select-labels").strValue==="yes";if(T==="none")continue;var M=(T==="overlap"||j)&&N,A=k.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:M});if(T==="contain"){var P=!1;if(j&&N){var D=y(k);D&&_w(D,m)&&(o.push(k),P=!0)}!P&&QA(h,A)&&o.push(k)}else if(T==="overlap"&&r3(h,A)){var R=k.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1}),I=[{x:R.x1,y:R.y1},{x:R.x2,y:R.y1},{x:R.x2,y:R.y2},{x:R.x1,y:R.y2}];if(_w(I,m))o.push(k);else{var U=y(k);U&&_w(U,m)&&o.push(k)}}}else{var B=w,z=B._private,F=z.rscratch,V=B.pstyle("box-selection").strValue;if(V==="none")continue;if(V==="contain"){if(F.startX!=null&&F.startY!=null&&!qo(h,F.startX,F.startY)||F.endX!=null&&F.endY!=null&&!qo(h,F.endX,F.endY))continue;if(F.edgeType==="bezier"||F.edgeType==="multibezier"||F.edgeType==="self"||F.edgeType==="compound"||F.edgeType==="segments"||F.edgeType==="haystack"){for(var J=z.rstyle.bezierPts||z.rstyle.linePts||z.rstyle.haystackPts,Y=!0,L=0;L<J.length;L++)if(!JT(h,J[L])){Y=!1;break}Y&&o.push(B)}else F.edgeType==="straight"&&o.push(B)}else if(V==="overlap"){var G=!1;if(F.startX!=null&&F.startY!=null&&F.endX!=null&&F.endY!=null&&(qo(h,F.startX,F.startY)||qo(h,F.endX,F.endY)))o.push(B),G=!0;else if(!G&&F.edgeType==="haystack"){for(var ee=z.rstyle.haystackPts,re=0;re<ee.length;re++)if(JT(h,ee[re])){o.push(B),G=!0;break}}if(!G){var se=z.rstyle.bezierPts||z.rstyle.linePts||z.rstyle.haystackPts;if((!se||se.length<2)&&F.edgeType==="straight"&&F.startX!=null&&F.startY!=null&&F.endX!=null&&F.endY!=null&&(se=[{x:F.startX,y:F.startY},{x:F.endX,y:F.endY}]),!se||se.length<2)continue;for(var de=0;de<se.length-1;de++){for(var W=se[de],ne=se[de+1],ie=0;ie<v.length;ie++){var $=zr(v[ie],2),q=$[0],te=$[1];if(b(W,ne,q,te)){o.push(B),G=!0;break}}if(G)break}}}}}return o};var P0={};P0.calculateArrowAngles=function(t){var e=t._private.rscratch,r=e.edgeType==="haystack",n=e.edgeType==="bezier",i=e.edgeType==="multibezier",a=e.edgeType==="segments",s=e.edgeType==="compound",o=e.edgeType==="self",l,u,c,d,h,m,b,S;if(r?(c=e.haystackPts[0],d=e.haystackPts[1],h=e.haystackPts[2],m=e.haystackPts[3]):(c=e.arrowStartX,d=e.arrowStartY,h=e.arrowEndX,m=e.arrowEndY),b=e.midX,S=e.midY,a)l=c-e.segpts[0],u=d-e.segpts[1];else if(i||s||o||n){var v=e.allpts,x=un(v[0],v[2],v[4],.1),y=un(v[1],v[3],v[5],.1);l=c-x,u=d-y}else l=c-b,u=d-S;e.srcArrowAngle=Ag(l,u);var b=e.midX,S=e.midY;if(r&&(b=(c+h)/2,S=(d+m)/2),l=h-c,u=m-d,a){var v=e.allpts;if(v.length/2%2===0){var w=v.length/2,k=w-2;l=v[w]-v[k],u=v[w+1]-v[k+1]}else if(e.isRound)l=e.midVector[1],u=-e.midVector[0];else{var w=v.length/2-1,k=w-2;l=v[w]-v[k],u=v[w+1]-v[k+1]}}else if(i||s||o){var v=e.allpts,N=e.ctrlpts,T,j,M,A;if(N.length/2%2===0){var P=v.length/2-1,D=P+2,R=D+2;T=un(v[P],v[D],v[R],0),j=un(v[P+1],v[D+1],v[R+1],0),M=un(v[P],v[D],v[R],1e-4),A=un(v[P+1],v[D+1],v[R+1],1e-4)}else{var D=v.length/2-1,P=D-2,R=D+2;T=un(v[P],v[D],v[R],.4999),j=un(v[P+1],v[D+1],v[R+1],.4999),M=un(v[P],v[D],v[R],.5),A=un(v[P+1],v[D+1],v[R+1],.5)}l=M-T,u=A-j}if(e.midtgtArrowAngle=Ag(l,u),e.midDispX=l,e.midDispY=u,l*=-1,u*=-1,a){var v=e.allpts;if(v.length/2%2!==0){if(!e.isRound){var w=v.length/2-1,I=w+2;l=-(v[I]-v[w]),u=-(v[I+1]-v[w+1])}}}if(e.midsrcArrowAngle=Ag(l,u),a)l=h-e.segpts[e.segpts.length-2],u=m-e.segpts[e.segpts.length-1];else if(i||s||o||n){var v=e.allpts,U=v.length,x=un(v[U-6],v[U-4],v[U-2],.9),y=un(v[U-5],v[U-3],v[U-1],.9);l=h-x,u=m-y}else l=h-b,u=m-S;e.tgtArrowAngle=Ag(l,u)};P0.getArrowWidth=P0.getArrowHeight=function(t,e){var r=this.arrowWidthCache=this.arrowWidthCache||{},n=r[t+", "+e];return n||(n=Math.max(Math.pow(t*13.37,.9),29)*e,r[t+", "+e]=n,n)};var q5,K5,Ja={},Xi={},D8,O8,hu,Dv,Ps,nu,cu,Ya,Ac,zg,HR,WR,Y5,X5,I8,L8=function(e,r,n){n.x=r.x-e.x,n.y=r.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},Cq=function(e,r){r.x=e.x*-1,r.y=e.y*-1,r.nx=e.nx*-1,r.ny=e.ny*-1,r.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},Nq=function(e,r,n,i,a){if(e!==I8?L8(r,e,Ja):Cq(Xi,Ja),L8(r,n,Xi),D8=Ja.nx*Xi.ny-Ja.ny*Xi.nx,O8=Ja.nx*Xi.nx-Ja.ny*-Xi.ny,Ps=Math.asin(Math.max(-1,Math.min(1,D8))),Math.abs(Ps)<1e-6){q5=r.x,K5=r.y,cu=Ac=0;return}hu=1,Dv=!1,O8<0?Ps<0?Ps=Math.PI+Ps:(Ps=Math.PI-Ps,hu=-1,Dv=!0):Ps>0&&(hu=-1,Dv=!0),r.radius!==void 0?Ac=r.radius:Ac=i,nu=Ps/2,zg=Math.min(Ja.len/2,Xi.len/2),a?(Ya=Math.abs(Math.cos(nu)*Ac/Math.sin(nu)),Ya>zg?(Ya=zg,cu=Math.abs(Ya*Math.sin(nu)/Math.cos(nu))):cu=Ac):(Ya=Math.min(zg,Ac),cu=Math.abs(Ya*Math.sin(nu)/Math.cos(nu))),Y5=r.x+Xi.nx*Ya,X5=r.y+Xi.ny*Ya,q5=Y5-Xi.ny*cu*hu,K5=X5+Xi.nx*cu*hu,HR=r.x+Ja.nx*Ya,WR=r.y+Ja.ny*Ya,I8=r};function qR(t,e){e.radius===0?t.lineTo(e.cx,e.cy):t.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function p3(t,e,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return n===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(Nq(t,e,r,n,i),{cx:q5,cy:K5,radius:cu,startX:HR,startY:WR,stopX:Y5,stopY:X5,startAngle:Ja.ang+Math.PI/2*hu,endAngle:Xi.ang-Math.PI/2*hu,counterClockwise:Dv})}var Ep=.01,Eq=Math.sqrt(2*Ep),Wn={};Wn.findMidptPtsEtc=function(t,e){var r=e.posPts,n=e.intersectionPts,i=e.vectorNormInverse,a,s=t.pstyle("source-endpoint"),o=t.pstyle("target-endpoint"),l=s.units!=null&&o.units!=null,u=function(N,T,j,M){var A=M-T,P=j-N,D=Math.sqrt(P*P+A*A);return{x:-A/D,y:P/D}},c=t.pstyle("edge-distances").value;switch(c){case"node-position":a=r;break;case"intersection":a=n;break;case"endpoints":{if(l){var d=this.manualEndptToPx(t.source()[0],s),h=zr(d,2),m=h[0],v=h[1],x=this.manualEndptToPx(t.target()[0],o),y=zr(x,2),b=y[0],S=y[1],w={x1:m,y1:v,x2:b,y2:S};i=u(m,v,b,S),a=w}else Lt("Edge ".concat(t.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),a=n;break}}return{midptPts:a,vectorNormInverse:i}};Wn.findHaystackPoints=function(t){for(var e=0;e<t.length;e++){var r=t[e],n=r._private,i=n.rscratch;if(!i.haystack){var a=Math.random()*2*Math.PI;i.source={x:Math.cos(a),y:Math.sin(a)},a=Math.random()*2*Math.PI,i.target={x:Math.cos(a),y:Math.sin(a)}}var s=n.source,o=n.target,l=s.position(),u=o.position(),c=s.width(),d=o.width(),h=s.height(),m=o.height(),v=r.pstyle("haystack-radius").value,x=v/2;i.haystackPts=i.allpts=[i.source.x*c*x+l.x,i.source.y*h*x+l.y,i.target.x*d*x+u.x,i.target.y*m*x+u.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(r),this.calculateArrowAngles(r),this.recalculateEdgeLabelProjections(r),this.calculateLabelAngles(r)}};Wn.findSegmentsPoints=function(t,e){var r=t._private.rscratch,n=t.pstyle("segment-weights"),i=t.pstyle("segment-distances"),a=t.pstyle("segment-radii"),s=t.pstyle("radius-type"),o=Math.min(n.pfValue.length,i.pfValue.length),l=a.pfValue[a.pfValue.length-1],u=s.pfValue[s.pfValue.length-1];r.edgeType="segments",r.segpts=[],r.radii=[],r.isArcRadius=[];for(var c=0;c<o;c++){var d=n.pfValue[c],h=i.pfValue[c],m=1-d,v=d,x=this.findMidptPtsEtc(t,e),y=x.midptPts,b=x.vectorNormInverse,S={x:y.x1*m+y.x2*v,y:y.y1*m+y.y2*v};r.segpts.push(S.x+b.x*h,S.y+b.y*h),r.radii.push(a.pfValue[c]!==void 0?a.pfValue[c]:l),r.isArcRadius.push((s.pfValue[c]!==void 0?s.pfValue[c]:u)==="arc-radius")}};Wn.findLoopPoints=function(t,e,r,n){var i=t._private.rscratch,a=e.dirCounts,s=e.srcPos,o=t.pstyle("control-point-distances"),l=o?o.pfValue[0]:void 0,u=t.pstyle("loop-direction").pfValue,c=t.pstyle("loop-sweep").pfValue,d=t.pstyle("control-point-step-size").pfValue;i.edgeType="self";var h=r,m=d;n&&(h=0,m=l);var v=u-Math.PI/2,x=v-c/2,y=v+c/2,b=u+"_"+c;h=a[b]===void 0?a[b]=0:++a[b],i.ctrlpts=[s.x+Math.cos(x)*1.4*m*(h/3+1),s.y+Math.sin(x)*1.4*m*(h/3+1),s.x+Math.cos(y)*1.4*m*(h/3+1),s.y+Math.sin(y)*1.4*m*(h/3+1)]};Wn.findCompoundLoopPoints=function(t,e,r,n){var i=t._private.rscratch;i.edgeType="compound";var a=e.srcPos,s=e.tgtPos,o=e.srcW,l=e.srcH,u=e.tgtW,c=e.tgtH,d=t.pstyle("control-point-step-size").pfValue,h=t.pstyle("control-point-distances"),m=h?h.pfValue[0]:void 0,v=r,x=d;n&&(v=0,x=m);var y=50,b={x:a.x-o/2,y:a.y-l/2},S={x:s.x-u/2,y:s.y-c/2},w={x:Math.min(b.x,S.x),y:Math.min(b.y,S.y)},k=.5,N=Math.max(k,Math.log(o*Ep)),T=Math.max(k,Math.log(u*Ep));i.ctrlpts=[w.x,w.y-(1+Math.pow(y,1.12)/100)*x*(v/3+1)*N,w.x-(1+Math.pow(y,1.12)/100)*x*(v/3+1)*T,w.y]};Wn.findStraightEdgePoints=function(t){t._private.rscratch.edgeType="straight"};Wn.findBezierPoints=function(t,e,r,n,i){var a=t._private.rscratch,s=t.pstyle("control-point-step-size").pfValue,o=t.pstyle("control-point-distances"),l=t.pstyle("control-point-weights"),u=o&&l?Math.min(o.value.length,l.value.length):1,c=o?o.pfValue[0]:void 0,d=l.value[0],h=n;a.edgeType=h?"multibezier":"bezier",a.ctrlpts=[];for(var m=0;m<u;m++){var v=(.5-e.eles.length/2+r)*s*(i?-1:1),x=void 0,y=t3(v);h&&(c=o?o.pfValue[m]:s,d=l.value[m]),n?x=c:x=c!==void 0?y*c:void 0;var b=x!==void 0?x:v,S=1-d,w=d,k=this.findMidptPtsEtc(t,e),N=k.midptPts,T=k.vectorNormInverse,j={x:N.x1*S+N.x2*w,y:N.y1*S+N.y2*w};a.ctrlpts.push(j.x+T.x*b,j.y+T.y*b)}};Wn.findTaxiPoints=function(t,e){var r=t._private.rscratch;r.edgeType="segments";var n="vertical",i="horizontal",a="leftward",s="rightward",o="downward",l="upward",u="auto",c=e.posPts,d=e.srcW,h=e.srcH,m=e.tgtW,v=e.tgtH,x=t.pstyle("edge-distances").value,y=x!=="node-position",b=t.pstyle("taxi-direction").value,S=b,w=t.pstyle("taxi-turn"),k=w.units==="%",N=w.pfValue,T=N<0,j=t.pstyle("taxi-turn-min-distance").pfValue,M=y?(d+m)/2:0,A=y?(h+v)/2:0,P=c.x2-c.x1,D=c.y2-c.y1,R=function(H,Q){return H>0?Math.max(H-Q,0):Math.min(H+Q,0)},I=R(P,M),U=R(D,A),B=!1;S===u?b=Math.abs(I)>Math.abs(U)?i:n:S===l||S===o?(b=n,B=!0):(S===a||S===s)&&(b=i,B=!0);var z=b===n,F=z?U:I,V=z?D:P,J=t3(V),Y=!1;!(B&&(k||T))&&(S===o&&V<0||S===l&&V>0||S===a&&V>0||S===s&&V<0)&&(J*=-1,F=J*Math.abs(F),Y=!0);var L;if(k){var G=N<0?1+N:N;L=G*F}else{var ee=N<0?F:0;L=ee+N*J}var re=function(H){return Math.abs(H)<j||Math.abs(H)>=Math.abs(F)},se=re(L),de=re(Math.abs(F)-Math.abs(L)),W=se||de;if(W&&!Y)if(z){var ne=Math.abs(V)<=h/2,ie=Math.abs(P)<=m/2;if(ne){var $=(c.x1+c.x2)/2,q=c.y1,te=c.y2;r.segpts=[$,q,$,te]}else if(ie){var Z=(c.y1+c.y2)/2,le=c.x1,ge=c.x2;r.segpts=[le,Z,ge,Z]}else r.segpts=[c.x1,c.y2]}else{var Ue=Math.abs(V)<=d/2,Te=Math.abs(D)<=v/2;if(Ue){var Re=(c.y1+c.y2)/2,Ge=c.x1,Ce=c.x2;r.segpts=[Ge,Re,Ce,Re]}else if(Te){var De=(c.x1+c.x2)/2,Ve=c.y1,We=c.y2;r.segpts=[De,Ve,De,We]}else r.segpts=[c.x2,c.y1]}else if(z){var Ie=c.y1+L+(y?h/2*J:0),rt=c.x1,ut=c.x2;r.segpts=[rt,Ie,ut,Ie]}else{var xt=c.x1+L+(y?d/2*J:0),bt=c.y1,Nt=c.y2;r.segpts=[xt,bt,xt,Nt]}if(r.isRound){var Je=t.pstyle("taxi-radius").value,Oe=t.pstyle("radius-type").value[0]==="arc-radius";r.radii=new Array(r.segpts.length/2).fill(Je),r.isArcRadius=new Array(r.segpts.length/2).fill(Oe)}};Wn.tryToCorrectInvalidPoints=function(t,e){var r=t._private.rscratch;if(r.edgeType==="bezier"){var n=e.srcPos,i=e.tgtPos,a=e.srcW,s=e.srcH,o=e.tgtW,l=e.tgtH,u=e.srcShape,c=e.tgtShape,d=e.srcCornerRadius,h=e.tgtCornerRadius,m=e.srcRs,v=e.tgtRs,x=!Ee(r.startX)||!Ee(r.startY),y=!Ee(r.arrowStartX)||!Ee(r.arrowStartY),b=!Ee(r.endX)||!Ee(r.endY),S=!Ee(r.arrowEndX)||!Ee(r.arrowEndY),w=3,k=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth,N=w*k,T=Fu({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.startX,y:r.startY}),j=T<N,M=Fu({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.endX,y:r.endY}),A=M<N,P=!1;if(x||y||j){P=!0;var D={x:r.ctrlpts[0]-n.x,y:r.ctrlpts[1]-n.y},R=Math.sqrt(D.x*D.x+D.y*D.y),I={x:D.x/R,y:D.y/R},U=Math.max(a,s),B={x:r.ctrlpts[0]+I.x*2*U,y:r.ctrlpts[1]+I.y*2*U},z=u.intersectLine(n.x,n.y,a,s,B.x,B.y,0,d,m);j?(r.ctrlpts[0]=r.ctrlpts[0]+I.x*(N-T),r.ctrlpts[1]=r.ctrlpts[1]+I.y*(N-T)):(r.ctrlpts[0]=z[0]+I.x*N,r.ctrlpts[1]=z[1]+I.y*N)}if(b||S||A){P=!0;var F={x:r.ctrlpts[0]-i.x,y:r.ctrlpts[1]-i.y},V=Math.sqrt(F.x*F.x+F.y*F.y),J={x:F.x/V,y:F.y/V},Y=Math.max(a,s),L={x:r.ctrlpts[0]+J.x*2*Y,y:r.ctrlpts[1]+J.y*2*Y},G=c.intersectLine(i.x,i.y,o,l,L.x,L.y,0,h,v);A?(r.ctrlpts[0]=r.ctrlpts[0]+J.x*(N-M),r.ctrlpts[1]=r.ctrlpts[1]+J.y*(N-M)):(r.ctrlpts[0]=G[0]+J.x*N,r.ctrlpts[1]=G[1]+J.y*N)}P&&this.findEndpoints(t)}};Wn.storeAllpts=function(t){var e=t._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var r=0;r+1<e.ctrlpts.length;r+=2)e.allpts.push(e.ctrlpts[r],e.ctrlpts[r+1]),r+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[r]+e.ctrlpts[r+2])/2,(e.ctrlpts[r+1]+e.ctrlpts[r+3])/2);e.allpts.push(e.endX,e.endY);var n,i;e.ctrlpts.length/2%2===0?(n=e.allpts.length/2-1,e.midX=e.allpts[n],e.midY=e.allpts[n+1]):(n=e.allpts.length/2-3,i=.5,e.midX=un(e.allpts[n],e.allpts[n+2],e.allpts[n+4],i),e.midY=un(e.allpts[n+1],e.allpts[n+3],e.allpts[n+5],i))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var a=2;a+3<e.allpts.length;a+=2){var s=e.radii[a/2-1],o=e.isArcRadius[a/2-1];e.roundCorners.push(p3({x:e.allpts[a-2],y:e.allpts[a-1]},{x:e.allpts[a],y:e.allpts[a+1],radius:s},{x:e.allpts[a+2],y:e.allpts[a+3]},s,o))}}if(e.segpts.length%4===0){var l=e.segpts.length/2,u=l-2;e.midX=(e.segpts[u]+e.segpts[l])/2,e.midY=(e.segpts[u+1]+e.segpts[l+1])/2}else{var c=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[c],e.midY=e.segpts[c+1];else{var d={x:e.segpts[c],y:e.segpts[c+1]},h=e.roundCorners[c/2];if(h.radius===0){var m={x:e.segpts[c+2],y:e.segpts[c+3]};e.midX=d.x,e.midY=d.y,e.midVector=[d.y-m.y,m.x-d.x]}else{var v=[d.x-h.cx,d.y-h.cy],x=h.radius/Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2));v=v.map(function(y){return y*x}),e.midX=h.cx+v[0],e.midY=h.cy+v[1],e.midVector=v}}}}};Wn.checkForInvalidEdgeWarning=function(t){var e=t[0]._private.rscratch;e.nodesOverlap||Ee(e.startX)&&Ee(e.startY)&&Ee(e.endX)&&Ee(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,Lt("Edge `"+t.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};Wn.findEdgeControlPoints=function(t){var e=this;if(!(!t||t.length===0)){for(var r=this,n=r.cy,i=n.hasCompoundNodes(),a=new Us,s=function(A,P){return[].concat(b0(A),[P?1:0]).join("-")},o=[],l=[],u=0;u<t.length;u++){var c=t[u],d=c._private,h=c.pstyle("curve-style").value;if(!(c.removed()||!c.takesUpSpace())){if(h==="haystack"){l.push(c);continue}var m=h==="unbundled-bezier"||Wo(h,"segments")||h==="straight"||h==="straight-triangle"||Wo(h,"taxi"),v=h==="unbundled-bezier"||h==="bezier",x=d.source,y=d.target,b=x.poolIndex(),S=y.poolIndex(),w=[b,S].sort(),k=s(w,m),N=a.get(k);N==null&&(N={eles:[]},o.push({pairId:w,edgeIsUnbundled:m}),a.set(k,N)),N.eles.push(c),m&&(N.hasUnbundled=!0),v&&(N.hasBezier=!0)}}for(var T=function(){var A=o[j],P=A.pairId,D=A.edgeIsUnbundled,R=s(P,D),I=a.get(R),U;if(!I.hasUnbundled){var B=I.eles[0].parallelEdges().filter(function(Oe){return Oe.isBundledBezier()});ZC(I.eles),B.forEach(function(Oe){return I.eles.push(Oe)}),I.eles.sort(function(Oe,ve){return Oe.poolIndex()-ve.poolIndex()})}var z=I.eles[0],F=z.source(),V=z.target();if(F.poolIndex()>V.poolIndex()){var J=F;F=V,V=J}var Y=I.srcPos=F.position(),L=I.tgtPos=V.position(),G=I.srcW=F.outerWidth(),ee=I.srcH=F.outerHeight(),re=I.tgtW=V.outerWidth(),se=I.tgtH=V.outerHeight(),de=I.srcShape=r.nodeShapes[e.getNodeShape(F)],W=I.tgtShape=r.nodeShapes[e.getNodeShape(V)],ne=I.srcCornerRadius=F.pstyle("corner-radius").value==="auto"?"auto":F.pstyle("corner-radius").pfValue,ie=I.tgtCornerRadius=V.pstyle("corner-radius").value==="auto"?"auto":V.pstyle("corner-radius").pfValue,$=I.tgtRs=V._private.rscratch,q=I.srcRs=F._private.rscratch;I.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var te=0;te<I.eles.length;te++){var Z=I.eles[te],le=Z[0]._private.rscratch,ge=Z.pstyle("curve-style").value,Ue=ge==="unbundled-bezier"||Wo(ge,"segments")||Wo(ge,"taxi"),Te=!F.same(Z.source());if(!I.calculatedIntersection&&F!==V&&(I.hasBezier||I.hasUnbundled)){I.calculatedIntersection=!0;var Re=de.intersectLine(Y.x,Y.y,G,ee,L.x,L.y,0,ne,q),Ge=I.srcIntn=Re,Ce=W.intersectLine(L.x,L.y,re,se,Y.x,Y.y,0,ie,$),De=I.tgtIntn=Ce,Ve=I.intersectionPts={x1:Re[0],x2:Ce[0],y1:Re[1],y2:Ce[1]},We=I.posPts={x1:Y.x,x2:L.x,y1:Y.y,y2:L.y},Ie=Ce[1]-Re[1],rt=Ce[0]-Re[0],ut=Math.sqrt(rt*rt+Ie*Ie);Ee(ut)&&ut>=Eq||(ut=Math.sqrt(Math.max(rt*rt,Ep)+Math.max(Ie*Ie,Ep)));var xt=I.vector={x:rt,y:Ie},bt=I.vectorNorm={x:xt.x/ut,y:xt.y/ut},Nt={x:-bt.y,y:bt.x};I.nodesOverlap=!Ee(ut)||W.checkPoint(Re[0],Re[1],0,re,se,L.x,L.y,ie,$)||de.checkPoint(Ce[0],Ce[1],0,G,ee,Y.x,Y.y,ne,q),I.vectorNormInverse=Nt,U={nodesOverlap:I.nodesOverlap,dirCounts:I.dirCounts,calculatedIntersection:!0,hasBezier:I.hasBezier,hasUnbundled:I.hasUnbundled,eles:I.eles,srcPos:L,srcRs:$,tgtPos:Y,tgtRs:q,srcW:re,srcH:se,tgtW:G,tgtH:ee,srcIntn:De,tgtIntn:Ge,srcShape:W,tgtShape:de,posPts:{x1:We.x2,y1:We.y2,x2:We.x1,y2:We.y1},intersectionPts:{x1:Ve.x2,y1:Ve.y2,x2:Ve.x1,y2:Ve.y1},vector:{x:-xt.x,y:-xt.y},vectorNorm:{x:-bt.x,y:-bt.y},vectorNormInverse:{x:-Nt.x,y:-Nt.y}}}var Je=Te?U:I;le.nodesOverlap=Je.nodesOverlap,le.srcIntn=Je.srcIntn,le.tgtIntn=Je.tgtIntn,le.isRound=ge.startsWith("round"),i&&(F.isParent()||F.isChild()||V.isParent()||V.isChild())&&(F.parents().anySame(V)||V.parents().anySame(F)||F.same(V)&&F.isParent())?e.findCompoundLoopPoints(Z,Je,te,Ue):F===V?e.findLoopPoints(Z,Je,te,Ue):ge.endsWith("segments")?e.findSegmentsPoints(Z,Je):ge.endsWith("taxi")?e.findTaxiPoints(Z,Je):ge==="straight"||!Ue&&I.eles.length%2===1&&te===Math.floor(I.eles.length/2)?e.findStraightEdgePoints(Z):e.findBezierPoints(Z,Je,te,Ue,Te),e.findEndpoints(Z),e.tryToCorrectInvalidPoints(Z,Je),e.checkForInvalidEdgeWarning(Z),e.storeAllpts(Z),e.storeEdgeProjections(Z),e.calculateArrowAngles(Z),e.recalculateEdgeLabelProjections(Z),e.calculateLabelAngles(Z)}},j=0;j<o.length;j++)T();this.findHaystackPoints(l)}};function KR(t){var e=[];if(t!=null){for(var r=0;r<t.length;r+=2){var n=t[r],i=t[r+1];e.push({x:n,y:i})}return e}}Wn.getSegmentPoints=function(t){var e=t[0]._private.rscratch;this.recalculateRenderedStyle(t);var r=e.edgeType;if(r==="segments")return KR(e.segpts)};Wn.getControlPoints=function(t){var e=t[0]._private.rscratch;this.recalculateRenderedStyle(t);var r=e.edgeType;if(r==="bezier"||r==="multibezier"||r==="self"||r==="compound")return KR(e.ctrlpts)};Wn.getEdgeMidpoint=function(t){var e=t[0]._private.rscratch;return this.recalculateRenderedStyle(t),{x:e.midX,y:e.midY}};var sm={};sm.manualEndptToPx=function(t,e){var r=this,n=t.position(),i=t.outerWidth(),a=t.outerHeight(),s=t._private.rscratch;if(e.value.length===2){var o=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(o[0]=o[0]*i),e.units[1]==="%"&&(o[1]=o[1]*a),o[0]+=n.x,o[1]+=n.y,o}else{var l=e.pfValue[0];l=-Math.PI/2+l;var u=2*Math.max(i,a),c=[n.x+Math.cos(l)*u,n.y+Math.sin(l)*u];return r.nodeShapes[this.getNodeShape(t)].intersectLine(n.x,n.y,i,a,c[0],c[1],0,t.pstyle("corner-radius").value==="auto"?"auto":t.pstyle("corner-radius").pfValue,s)}};sm.findEndpoints=function(t){var e,r,n,i,a=this,s,o=t.source()[0],l=t.target()[0],u=o.position(),c=l.position(),d=t.pstyle("target-arrow-shape").value,h=t.pstyle("source-arrow-shape").value,m=t.pstyle("target-distance-from-node").pfValue,v=t.pstyle("source-distance-from-node").pfValue,x=o._private.rscratch,y=l._private.rscratch,b=t.pstyle("curve-style").value,S=t._private.rscratch,w=S.edgeType,k=Wo(b,"taxi"),N=w==="self"||w==="compound",T=w==="bezier"||w==="multibezier"||N,j=w!=="bezier",M=w==="straight"||w==="segments",A=w==="segments",P=T||j||M,D=N||k,R=t.pstyle("source-endpoint"),I=D?"outside-to-node":R.value,U=o.pstyle("corner-radius").value==="auto"?"auto":o.pstyle("corner-radius").pfValue,B=t.pstyle("target-endpoint"),z=D?"outside-to-node":B.value,F=l.pstyle("corner-radius").value==="auto"?"auto":l.pstyle("corner-radius").pfValue;S.srcManEndpt=R,S.tgtManEndpt=B;var V,J,Y,L,G=(e=(B==null||(r=B.pfValue)===null||r===void 0?void 0:r.length)===2?B.pfValue:null)!==null&&e!==void 0?e:[0,0],ee=(n=(R==null||(i=R.pfValue)===null||i===void 0?void 0:i.length)===2?R.pfValue:null)!==null&&n!==void 0?n:[0,0];if(T){var re=[S.ctrlpts[0],S.ctrlpts[1]],se=j?[S.ctrlpts[S.ctrlpts.length-2],S.ctrlpts[S.ctrlpts.length-1]]:re;V=se,J=re}else if(M){var de=A?S.segpts.slice(0,2):[c.x+G[0],c.y+G[1]],W=A?S.segpts.slice(S.segpts.length-2):[u.x+ee[0],u.y+ee[1]];V=W,J=de}if(z==="inside-to-node")s=[c.x,c.y];else if(B.units)s=this.manualEndptToPx(l,B);else if(z==="outside-to-line")s=S.tgtIntn;else if(z==="outside-to-node"||z==="outside-to-node-or-label"?Y=V:(z==="outside-to-line"||z==="outside-to-line-or-label")&&(Y=[u.x,u.y]),s=a.nodeShapes[this.getNodeShape(l)].intersectLine(c.x,c.y,l.outerWidth(),l.outerHeight(),Y[0],Y[1],0,F,y),z==="outside-to-node-or-label"||z==="outside-to-line-or-label"){var ne=l._private.rscratch,ie=ne.labelWidth,$=ne.labelHeight,q=ne.labelX,te=ne.labelY,Z=ie/2,le=$/2,ge=l.pstyle("text-valign").value;ge==="top"?te-=le:ge==="bottom"&&(te+=le);var Ue=l.pstyle("text-halign").value;Ue==="left"?q-=Z:Ue==="right"&&(q+=Z);var Te=wp(Y[0],Y[1],[q-Z,te-le,q+Z,te-le,q+Z,te+le,q-Z,te+le],c.x,c.y);if(Te.length>0){var Re=u,Ge=uu(Re,od(s)),Ce=uu(Re,od(Te)),De=Ge;if(Ce<Ge&&(s=Te,De=Ce),Te.length>2){var Ve=uu(Re,{x:Te[2],y:Te[3]});Ve<De&&(s=[Te[2],Te[3]])}}}var We=Rg(s,V,a.arrowShapes[d].spacing(t)+m),Ie=Rg(s,V,a.arrowShapes[d].gap(t)+m);if(S.endX=Ie[0],S.endY=Ie[1],S.arrowEndX=We[0],S.arrowEndY=We[1],I==="inside-to-node")s=[u.x,u.y];else if(R.units)s=this.manualEndptToPx(o,R);else if(I==="outside-to-line")s=S.srcIntn;else if(I==="outside-to-node"||I==="outside-to-node-or-label"?L=J:(I==="outside-to-line"||I==="outside-to-line-or-label")&&(L=[c.x,c.y]),s=a.nodeShapes[this.getNodeShape(o)].intersectLine(u.x,u.y,o.outerWidth(),o.outerHeight(),L[0],L[1],0,U,x),I==="outside-to-node-or-label"||I==="outside-to-line-or-label"){var rt=o._private.rscratch,ut=rt.labelWidth,xt=rt.labelHeight,bt=rt.labelX,Nt=rt.labelY,Je=ut/2,Oe=xt/2,ve=o.pstyle("text-valign").value;ve==="top"?Nt-=Oe:ve==="bottom"&&(Nt+=Oe);var H=o.pstyle("text-halign").value;H==="left"?bt-=Je:H==="right"&&(bt+=Je);var Q=wp(L[0],L[1],[bt-Je,Nt-Oe,bt+Je,Nt-Oe,bt+Je,Nt+Oe,bt-Je,Nt+Oe],u.x,u.y);if(Q.length>0){var ae=c,ue=uu(ae,od(s)),fe=uu(ae,od(Q)),xe=ue;if(fe<ue&&(s=[Q[0],Q[1]],xe=fe),Q.length>2){var ye=uu(ae,{x:Q[2],y:Q[3]});ye<xe&&(s=[Q[2],Q[3]])}}}var je=Rg(s,J,a.arrowShapes[h].spacing(t)+v),Me=Rg(s,J,a.arrowShapes[h].gap(t)+v);S.startX=Me[0],S.startY=Me[1],S.arrowStartX=je[0],S.arrowStartY=je[1],P&&(!Ee(S.startX)||!Ee(S.startY)||!Ee(S.endX)||!Ee(S.endY)?S.badLine=!0:S.badLine=!1)};sm.getSourceEndpoint=function(t){var e=t[0]._private.rscratch;switch(this.recalculateRenderedStyle(t),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};sm.getTargetEndpoint=function(t){var e=t[0]._private.rscratch;switch(this.recalculateRenderedStyle(t),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var m3={};function Tq(t,e,r){for(var n=function(u,c,d,h){return un(u,c,d,h)},i=e._private,a=i.rstyle.bezierPts,s=0;s<t.bezierProjPcts.length;s++){var o=t.bezierProjPcts[s];a.push({x:n(r[0],r[2],r[4],o),y:n(r[1],r[3],r[5],o)})}}m3.storeEdgeProjections=function(t){var e=t._private,r=e.rscratch,n=r.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){e.rstyle.bezierPts=[];for(var i=0;i+5<r.allpts.length;i+=4)Tq(this,t,r.allpts.slice(i,i+6))}else if(n==="segments")for(var a=e.rstyle.linePts=[],i=0;i+1<r.allpts.length;i+=2)a.push({x:r.allpts[i],y:r.allpts[i+1]});else if(n==="haystack"){var s=r.haystackPts;e.rstyle.haystackPts=[{x:s[0],y:s[1]},{x:s[2],y:s[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth};m3.recalculateEdgeProjections=function(t){this.findEdgeControlPoints(t)};var ms={};ms.recalculateNodeLabelProjection=function(t){var e=t.pstyle("label").strValue;if(!ml(e)){var r,n,i=t._private,a=t.width(),s=t.height(),o=t.padding(),l=t.position(),u=t.pstyle("text-halign").strValue,c=t.pstyle("text-valign").strValue,d=i.rscratch,h=i.rstyle;switch(u){case"left":r=l.x-a/2-o;break;case"right":r=l.x+a/2+o;break;default:r=l.x}switch(c){case"top":n=l.y-s/2-o;break;case"bottom":n=l.y+s/2+o;break;default:n=l.y}d.labelX=r,d.labelY=n,h.labelX=r,h.labelY=n,this.calculateLabelAngles(t),this.applyLabelDimensions(t)}};var YR=function(e,r){var n=Math.atan(r/e);return e===0&&n<0&&(n=n*-1),n},XR=function(e,r){var n=r.x-e.x,i=r.y-e.y;return YR(n,i)},jq=function(e,r,n,i){var a=bp(0,i-.001,1),s=bp(0,i+.001,1),o=yd(e,r,n,a),l=yd(e,r,n,s);return XR(o,l)};ms.recalculateEdgeLabelProjections=function(t){var e,r=t._private,n=r.rscratch,i=this,a={mid:t.pstyle("label").strValue,source:t.pstyle("source-label").strValue,target:t.pstyle("target-label").strValue};if(a.mid||a.source||a.target){e={x:n.midX,y:n.midY};var s=function(d,h,m){zs(r.rscratch,d,h,m),zs(r.rstyle,d,h,m)};s("labelX",null,e.x),s("labelY",null,e.y);var o=YR(n.midDispX,n.midDispY);s("labelAutoAngle",null,o);var l=function(){if(l.cache)return l.cache;for(var d=[],h=0;h+5<n.allpts.length;h+=4){var m={x:n.allpts[h],y:n.allpts[h+1]},v={x:n.allpts[h+2],y:n.allpts[h+3]},x={x:n.allpts[h+4],y:n.allpts[h+5]};d.push({p0:m,p1:v,p2:x,startDist:0,length:0,segments:[]})}var y=r.rstyle.bezierPts,b=i.bezierProjPcts.length;function S(j,M,A,P,D){var R=Fu(M,A),I=j.segments[j.segments.length-1],U={p0:M,p1:A,t0:P,t1:D,startDist:I?I.startDist+I.length:0,length:R};j.segments.push(U),j.length+=R}for(var w=0;w<d.length;w++){var k=d[w],N=d[w-1];N&&(k.startDist=N.startDist+N.length),S(k,k.p0,y[w*b],0,i.bezierProjPcts[0]);for(var T=0;T<b-1;T++)S(k,y[w*b+T],y[w*b+T+1],i.bezierProjPcts[T],i.bezierProjPcts[T+1]);S(k,y[w*b+b-1],k.p2,i.bezierProjPcts[b-1],1)}return l.cache=d},u=function(d){var h,m=d==="source";if(a[d]){var v=t.pstyle(d+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var x=l(),y,b=0,S=0,w=0;w<x.length;w++){for(var k=x[m?w:x.length-1-w],N=0;N<k.segments.length;N++){var T=k.segments[m?N:k.segments.length-1-N],j=w===x.length-1&&N===k.segments.length-1;if(b=S,S+=T.length,S>=v||j){y={cp:k,segment:T};break}}if(y)break}var M=y.cp,A=y.segment,P=(v-b)/A.length,D=A.t1-A.t0,R=m?A.t0+D*P:A.t1-D*P;R=bp(0,R,1),e=yd(M.p0,M.p1,M.p2,R),h=jq(M.p0,M.p1,M.p2,R);break}case"straight":case"segments":case"haystack":{for(var I=0,U,B,z,F,V=n.allpts.length,J=0;J+3<V&&(m?(z={x:n.allpts[J],y:n.allpts[J+1]},F={x:n.allpts[J+2],y:n.allpts[J+3]}):(z={x:n.allpts[V-2-J],y:n.allpts[V-1-J]},F={x:n.allpts[V-4-J],y:n.allpts[V-3-J]}),U=Fu(z,F),B=I,I+=U,!(I>=v));J+=2);var Y=v-B,L=Y/U;L=bp(0,L,1),e=XU(z,F,L),h=XR(z,F);break}}s("labelX",d,e.x),s("labelY",d,e.y),s("labelAutoAngle",d,h)}};u("source"),u("target"),this.applyLabelDimensions(t)}};ms.applyLabelDimensions=function(t){this.applyPrefixedLabelDimensions(t),t.isEdge()&&(this.applyPrefixedLabelDimensions(t,"source"),this.applyPrefixedLabelDimensions(t,"target"))};ms.applyPrefixedLabelDimensions=function(t,e){var r=t._private,n=this.getLabelText(t,e),i=Bu(n,t._private.labelDimsKey);if(hi(r.rscratch,"prefixedLabelDimsKey",e)!==i){zs(r.rscratch,"prefixedLabelDimsKey",e,i);var a=this.calculateLabelDimensions(t,n),s=t.pstyle("line-height").pfValue,o=t.pstyle("text-wrap").strValue,l=hi(r.rscratch,"labelWrapCachedLines",e)||[],u=o!=="wrap"?1:Math.max(l.length,1),c=a.height/u,d=c*s,h=a.width,m=a.height+(u-1)*(s-1)*c;zs(r.rstyle,"labelWidth",e,h),zs(r.rscratch,"labelWidth",e,h),zs(r.rstyle,"labelHeight",e,m),zs(r.rscratch,"labelHeight",e,m),zs(r.rscratch,"labelLineHeight",e,d)}};ms.getLabelText=function(t,e){var r=t._private,n=e?e+"-":"",i=t.pstyle(n+"label").strValue,a=t.pstyle("text-transform").value,s=function(ee,re){return re?(zs(r.rscratch,ee,e,re),re):hi(r.rscratch,ee,e)};if(!i)return"";a=="none"||(a=="uppercase"?i=i.toUpperCase():a=="lowercase"&&(i=i.toLowerCase()));var o=t.pstyle("text-wrap").value;if(o==="wrap"){var l=s("labelKey");if(l!=null&&s("labelWrapKey")===l)return s("labelWrapCachedText");for(var u="",c=i.split(`
`),d=t.pstyle("text-max-width").pfValue,h=t.pstyle("text-overflow-wrap").value,m=h==="anywhere",v=[],x=/[\s\u200b]+|$/g,y=0;y<c.length;y++){var b=c[y],S=this.calculateLabelDimensions(t,b),w=S.width;if(m){var k=b.split("").join(u);b=k}if(w>d){var N=b.matchAll(x),T="",j=0,M=vi(N),A;try{for(M.s();!(A=M.n()).done;){var P=A.value,D=P[0],R=b.substring(j,P.index);j=P.index+D.length;var I=T.length===0?R:T+R+D,U=this.calculateLabelDimensions(t,I),B=U.width;B<=d?T+=R+D:(T&&v.push(T),T=R+D)}}catch(G){M.e(G)}finally{M.f()}T.match(/^[\s\u200b]+$/)||v.push(T)}else v.push(b)}s("labelWrapCachedLines",v),i=s("labelWrapCachedText",v.join(`
`)),s("labelWrapKey",l)}else if(o==="ellipsis"){var z=t.pstyle("text-max-width").pfValue,F="",V="",J=!1;if(this.calculateLabelDimensions(t,i).width<z)return i;for(var Y=0;Y<i.length;Y++){var L=this.calculateLabelDimensions(t,F+i[Y]+V).width;if(L>z)break;F+=i[Y],Y===i.length-1&&(J=!0)}return J||(F+=V),F}return i};ms.getLabelJustification=function(t){var e=t.pstyle("text-justification").strValue,r=t.pstyle("text-halign").strValue;if(e==="auto")if(t.isNode())switch(r){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};ms.calculateLabelDimensions=function(t,e){var r=this,n=r.cy.window(),i=n.document,a=0,s=t.pstyle("font-style").strValue,o=t.pstyle("font-size").pfValue,l=t.pstyle("font-family").strValue,u=t.pstyle("font-weight").strValue,c=this.labelCalcCanvas,d=this.labelCalcCanvasContext;if(!c){c=this.labelCalcCanvas=i.createElement("canvas"),d=this.labelCalcCanvasContext=c.getContext("2d");var h=c.style;h.position="absolute",h.left="-9999px",h.top="-9999px",h.zIndex="-1",h.visibility="hidden",h.pointerEvents="none"}d.font="".concat(s," ").concat(u," ").concat(o,"px ").concat(l);for(var m=0,v=0,x=e.split(`
`),y=0;y<x.length;y++){var b=x[y],S=d.measureText(b),w=Math.ceil(S.width),k=o;m=Math.max(w,m),v+=k}return m+=a,v+=a,{width:m,height:v}};ms.calculateLabelAngle=function(t,e){var r=t._private,n=r.rscratch,i=t.isEdge(),a=e?e+"-":"",s=t.pstyle(a+"text-rotation"),o=s.strValue;return o==="none"?0:i&&o==="autorotate"?n.labelAutoAngle:o==="autorotate"?0:s.pfValue};ms.calculateLabelAngles=function(t){var e=this,r=t.isEdge(),n=t._private,i=n.rscratch;i.labelAngle=e.calculateLabelAngle(t),r&&(i.sourceLabelAngle=e.calculateLabelAngle(t,"source"),i.targetLabelAngle=e.calculateLabelAngle(t,"target"))};var QR={},B8=28,F8=!1;QR.getNodeShape=function(t){var e=this,r=t.pstyle("shape").value;if(r==="cutrectangle"&&(t.width()<B8||t.height()<B8))return F8||(Lt("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),F8=!0),"rectangle";if(t.isParent())return r==="rectangle"||r==="roundrectangle"||r==="round-rectangle"||r==="cutrectangle"||r==="cut-rectangle"||r==="barrel"?r:"rectangle";if(r==="polygon"){var n=t.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(n).name}return r};var fx={};fx.registerCalculationListeners=function(){var t=this.cy,e=t.collection(),r=this,n=function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(s),o)for(var l=0;l<s.length;l++){var u=s[l],c=u._private,d=c.rstyle;d.clean=!1,d.cleanConnected=!1}};r.binder(t).on("bounds.* dirty.*",function(s){var o=s.target;n(o)}).on("style.* background.*",function(s){var o=s.target;n(o,!1)});var i=function(s){if(s){var o=r.onUpdateEleCalcsFns;e.cleanStyle();for(var l=0;l<e.length;l++){var u=e[l],c=u._private.rstyle;u.isNode()&&!c.cleanConnected&&(n(u.connectedEdges()),c.cleanConnected=!0)}if(o)for(var d=0;d<o.length;d++){var h=o[d];h(s,e)}r.recalculateRenderedStyle(e),e=t.collection()}};r.flushRenderedStyleQueue=function(){i(!0)},r.beforeRender(i,r.beforeRenderPriorities.eleCalcs)};fx.onUpdateEleCalcs=function(t){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(t)};fx.recalculateRenderedStyle=function(t,e){var r=function(k){return k._private.rstyle.cleanConnected};if(t.length!==0){var n=[],i=[];if(!this.destroyed){e===void 0&&(e=!0);for(var a=0;a<t.length;a++){var s=t[a],o=s._private,l=o.rstyle;s.isEdge()&&(!r(s.source())||!r(s.target()))&&(l.clean=!1),s.isEdge()&&s.isBundledBezier()&&s.parallelEdges().some(function(w){return!w._private.rstyle.clean&&w.isBundledBezier()})&&(l.clean=!1),!(e&&l.clean||s.removed())&&s.pstyle("display").value!=="none"&&(o.group==="nodes"?i.push(s):n.push(s),l.clean=!0)}for(var u=0;u<i.length;u++){var c=i[u],d=c._private,h=d.rstyle,m=c.position();this.recalculateNodeLabelProjection(c),h.nodeX=m.x,h.nodeY=m.y,h.nodeW=c.pstyle("width").pfValue,h.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var v=0;v<n.length;v++){var x=n[v],y=x._private,b=y.rstyle,S=y.rscratch;b.srcX=S.arrowStartX,b.srcY=S.arrowStartY,b.tgtX=S.arrowEndX,b.tgtY=S.arrowEndY,b.midX=S.midX,b.midY=S.midY,b.labelAngle=S.labelAngle,b.sourceLabelAngle=S.sourceLabelAngle,b.targetLabelAngle=S.targetLabelAngle}}}};var hx={};hx.updateCachedGrabbedEles=function(){var t=this.cachedZSortedEles;if(t){t.drag=[],t.nondrag=[];for(var e=[],r=0;r<t.length;r++){var n=t[r],i=n._private.rscratch;n.grabbed()&&!n.isParent()?e.push(n):i.inDragLayer?t.drag.push(n):t.nondrag.push(n)}for(var r=0;r<e.length;r++){var n=e[r];t.drag.push(n)}}};hx.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};hx.getCachedZSortedEles=function(t){if(t||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(AR),e.interactive=e.filter(function(r){return r.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var JR={};[Zu,P0,Wn,sm,m3,ms,QR,fx,hx].forEach(function(t){Qe(JR,t)});var ZR={};ZR.getCachedImage=function(t,e,r){var n=this,i=n.imageCache=n.imageCache||{},a=i[t];if(a)return a.image.complete||a.image.addEventListener("load",r),a.image;a=i[t]=i[t]||{};var s=a.image=new Image;s.addEventListener("load",r),s.addEventListener("error",function(){s.error=!0});var o="data:",l=t.substring(0,o.length).toLowerCase()===o;return l||(e=e==="null"?null:e,s.crossOrigin=e),s.src=t,s};var of={};of.registerBinding=function(t,e,r,n){var i=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(t)){for(var a=[],s=0;s<t.length;s++){var o=t[s];if(o!==void 0){var l=this.binder(o);a.push(l.on.apply(l,i))}}return a}var l=this.binder(t);return l.on.apply(l,i)};of.binder=function(t){var e=this,r=e.cy.window(),n=t===r||t===r.document||t===r.document.body||z$(t);if(e.supportsPassiveEvents==null){var i=!1;try{var a=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});r.addEventListener("test",null,a)}catch{}e.supportsPassiveEvents=i}var s=function(l,u,c){var d=Array.prototype.slice.call(arguments);return n&&e.supportsPassiveEvents&&(d[2]={capture:c??!1,passive:!1,once:!1}),e.bindings.push({target:t,args:d}),(t.addEventListener||t.on).apply(t,d),this};return{on:s,addEventListener:s,addListener:s,bind:s}};of.nodeIsDraggable=function(t){return t&&t.isNode()&&!t.locked()&&t.grabbable()};of.nodeIsGrabbable=function(t){return this.nodeIsDraggable(t)&&t.interactive()};of.load=function(){var t=this,e=t.cy.window(),r=function(H){return H.selected()},n=function(H){var Q=H.getRootNode();if(Q&&Q.nodeType===11&&Q.host!==void 0)return Q},i=function(H,Q,ae,ue){H==null&&(H=t.cy);for(var fe=0;fe<Q.length;fe++){var xe=Q[fe];H.emit({originalEvent:ae,type:xe,position:ue})}},a=function(H){return H.shiftKey||H.metaKey||H.ctrlKey},s=function(H,Q){var ae=!0;if(t.cy.hasCompoundNodes()&&H&&H.pannable())for(var ue=0;Q&&ue<Q.length;ue++){var H=Q[ue];if(H.isNode()&&H.isParent()&&!H.pannable()){ae=!1;break}}else ae=!0;return ae},o=function(H){H[0]._private.grabbed=!0},l=function(H){H[0]._private.grabbed=!1},u=function(H){H[0]._private.rscratch.inDragLayer=!0},c=function(H){H[0]._private.rscratch.inDragLayer=!1},d=function(H){H[0]._private.rscratch.isGrabTarget=!0},h=function(H){H[0]._private.rscratch.isGrabTarget=!1},m=function(H,Q){var ae=Q.addToList,ue=ae.has(H);!ue&&H.grabbable()&&!H.locked()&&(ae.merge(H),o(H))},v=function(H,Q){if(H.cy().hasCompoundNodes()&&!(Q.inDragLayer==null&&Q.addToList==null)){var ae=H.descendants();Q.inDragLayer&&(ae.forEach(u),ae.connectedEdges().forEach(u)),Q.addToList&&m(ae,Q)}},x=function(H,Q){Q=Q||{};var ae=H.cy().hasCompoundNodes();Q.inDragLayer&&(H.forEach(u),H.neighborhood().stdFilter(function(ue){return!ae||ue.isEdge()}).forEach(u)),Q.addToList&&H.forEach(function(ue){m(ue,Q)}),v(H,Q),S(H,{inDragLayer:Q.inDragLayer}),t.updateCachedGrabbedEles()},y=x,b=function(H){H&&(t.getCachedZSortedEles().forEach(function(Q){l(Q),c(Q),h(Q)}),t.updateCachedGrabbedEles())},S=function(H,Q){if(!(Q.inDragLayer==null&&Q.addToList==null)&&H.cy().hasCompoundNodes()){var ae=H.ancestors().orphans();if(!ae.same(H)){var ue=ae.descendants().spawnSelf().merge(ae).unmerge(H).unmerge(H.descendants()),fe=ue.connectedEdges();Q.inDragLayer&&(fe.forEach(u),ue.forEach(u)),Q.addToList&&ue.forEach(function(xe){m(xe,Q)})}}},w=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},k=typeof MutationObserver<"u",N=typeof ResizeObserver<"u";k?(t.removeObserver=new MutationObserver(function(ve){for(var H=0;H<ve.length;H++){var Q=ve[H],ae=Q.removedNodes;if(ae)for(var ue=0;ue<ae.length;ue++){var fe=ae[ue];if(fe===t.container){t.destroy();break}}}}),t.container.parentNode&&t.removeObserver.observe(t.container.parentNode,{childList:!0})):t.registerBinding(t.container,"DOMNodeRemoved",function(ve){t.destroy()});var T=rm(function(){t.cy.resize()},100);k&&(t.styleObserver=new MutationObserver(T),t.styleObserver.observe(t.container,{attributes:!0})),t.registerBinding(e,"resize",T),N&&(t.resizeObserver=new ResizeObserver(T),t.resizeObserver.observe(t.container));var j=function(H,Q){for(;H!=null;)Q(H),H=H.parentNode},M=function(){t.invalidateContainerClientCoordsCache()};j(t.container,function(ve){t.registerBinding(ve,"transitionend",M),t.registerBinding(ve,"animationend",M),t.registerBinding(ve,"scroll",M)}),t.registerBinding(t.container,"contextmenu",function(ve){ve.preventDefault()});var A=function(){return t.selection[4]!==0},P=function(H){for(var Q=t.findContainerClientCoords(),ae=Q[0],ue=Q[1],fe=Q[2],xe=Q[3],ye=H.touches?H.touches:[H],je=!1,Me=0;Me<ye.length;Me++){var He=ye[Me];if(ae<=He.clientX&&He.clientX<=ae+fe&&ue<=He.clientY&&He.clientY<=ue+xe){je=!0;break}}if(!je)return!1;for(var et=t.container,tt=H.target,Le=tt.parentNode,nt=!1;Le;){if(Le===et){nt=!0;break}Le=Le.parentNode}return!!nt};t.registerBinding(t.container,"mousedown",function(H){if(P(H)&&!(t.hoverData.which===1&&H.which!==1)){H.preventDefault(),w(),t.hoverData.capture=!0,t.hoverData.which=H.which;var Q=t.cy,ae=[H.clientX,H.clientY],ue=t.projectIntoViewport(ae[0],ae[1]),fe=t.selection,xe=t.findNearestElements(ue[0],ue[1],!0,!1),ye=xe[0],je=t.dragData.possibleDragElements;t.hoverData.mdownPos=ue,t.hoverData.mdownGPos=ae;var Me=function(st){return{originalEvent:H,type:st,position:{x:ue[0],y:ue[1]}}},He=function(){t.hoverData.tapholdCancelled=!1,clearTimeout(t.hoverData.tapholdTimeout),t.hoverData.tapholdTimeout=setTimeout(function(){if(!t.hoverData.tapholdCancelled){var st=t.hoverData.down;st?st.emit(Me("taphold")):Q.emit(Me("taphold"))}},t.tapholdDuration)};if(H.which==3){t.hoverData.cxtStarted=!0;var et={originalEvent:H,type:"cxttapstart",position:{x:ue[0],y:ue[1]}};ye?(ye.activate(),ye.emit(et),t.hoverData.down=ye):Q.emit(et),t.hoverData.downTime=new Date().getTime(),t.hoverData.cxtDragged=!1}else if(H.which==1){ye&&ye.activate();{if(ye!=null&&t.nodeIsGrabbable(ye)){var tt=function(st){st.emit(Me("grab"))};if(d(ye),!ye.selected())je=t.dragData.possibleDragElements=Q.collection(),y(ye,{addToList:je}),ye.emit(Me("grabon")).emit(Me("grab"));else{je=t.dragData.possibleDragElements=Q.collection();var Le=Q.$(function(nt){return nt.isNode()&&nt.selected()&&t.nodeIsGrabbable(nt)});x(Le,{addToList:je}),ye.emit(Me("grabon")),Le.forEach(tt)}t.redrawHint("eles",!0),t.redrawHint("drag",!0)}t.hoverData.down=ye,t.hoverData.downs=xe,t.hoverData.downTime=new Date().getTime()}i(ye,["mousedown","tapstart","vmousedown"],H,{x:ue[0],y:ue[1]}),ye==null?(fe[4]=1,t.data.bgActivePosistion={x:ue[0],y:ue[1]},t.redrawHint("select",!0),t.redraw()):ye.pannable()&&(fe[4]=1),He()}fe[0]=fe[2]=ue[0],fe[1]=fe[3]=ue[1]}},!1);var D=n(t.container);t.registerBinding([e,D],"mousemove",function(H){var Q=t.hoverData.capture;if(!(!Q&&!P(H))){var ae=!1,ue=t.cy,fe=ue.zoom(),xe=[H.clientX,H.clientY],ye=t.projectIntoViewport(xe[0],xe[1]),je=t.hoverData.mdownPos,Me=t.hoverData.mdownGPos,He=t.selection,et=null;!t.hoverData.draggingEles&&!t.hoverData.dragging&&!t.hoverData.selecting&&(et=t.findNearestElement(ye[0],ye[1],!0,!1));var tt=t.hoverData.last,Le=t.hoverData.down,nt=[ye[0]-He[2],ye[1]-He[3]],st=t.dragData.possibleDragElements,Kt;if(Me){var Ot=xe[0]-Me[0],yn=Ot*Ot,br=xe[1]-Me[1],Ir=br*br,wr=yn+Ir;t.hoverData.isOverThresholdDrag=Kt=wr>=t.desktopTapThreshold2}var Pr=a(H);Kt&&(t.hoverData.tapholdCancelled=!0);var Fa=function(){var oi=t.hoverData.dragDelta=t.hoverData.dragDelta||[];oi.length===0?(oi.push(nt[0]),oi.push(nt[1])):(oi[0]+=nt[0],oi[1]+=nt[1])};ae=!0,i(et,["mousemove","vmousemove","tapdrag"],H,{x:ye[0],y:ye[1]});var Sr=function(oi){return{originalEvent:H,type:oi,position:{x:ye[0],y:ye[1]}}},si=function(){t.data.bgActivePosistion=void 0,t.hoverData.selecting||ue.emit(Sr("boxstart")),He[4]=1,t.hoverData.selecting=!0,t.redrawHint("select",!0),t.redraw()};if(t.hoverData.which===3){if(Kt){var pa=Sr("cxtdrag");Le?Le.emit(pa):ue.emit(pa),t.hoverData.cxtDragged=!0,(!t.hoverData.cxtOver||et!==t.hoverData.cxtOver)&&(t.hoverData.cxtOver&&t.hoverData.cxtOver.emit(Sr("cxtdragout")),t.hoverData.cxtOver=et,et&&et.emit(Sr("cxtdragover")))}}else if(t.hoverData.dragging){if(ae=!0,ue.panningEnabled()&&ue.userPanningEnabled()){var ho;if(t.hoverData.justStartedPan){var hc=t.hoverData.mdownPos;ho={x:(ye[0]-hc[0])*fe,y:(ye[1]-hc[1])*fe},t.hoverData.justStartedPan=!1}else ho={x:nt[0]*fe,y:nt[1]*fe};ue.panBy(ho),ue.emit(Sr("dragpan")),t.hoverData.dragged=!0}ye=t.projectIntoViewport(H.clientX,H.clientY)}else if(He[4]==1&&(Le==null||Le.pannable())){if(Kt){if(!t.hoverData.dragging&&ue.boxSelectionEnabled()&&(Pr||!ue.panningEnabled()||!ue.userPanningEnabled()))si();else if(!t.hoverData.selecting&&ue.panningEnabled()&&ue.userPanningEnabled()){var xs=s(Le,t.hoverData.downs);xs&&(t.hoverData.dragging=!0,t.hoverData.justStartedPan=!0,He[4]=0,t.data.bgActivePosistion=od(je),t.redrawHint("select",!0),t.redraw())}Le&&Le.pannable()&&Le.active()&&Le.unactivate()}}else{if(Le&&Le.pannable()&&Le.active()&&Le.unactivate(),(!Le||!Le.grabbed())&&et!=tt&&(tt&&i(tt,["mouseout","tapdragout"],H,{x:ye[0],y:ye[1]}),et&&i(et,["mouseover","tapdragover"],H,{x:ye[0],y:ye[1]}),t.hoverData.last=et),Le)if(Kt){if(ue.boxSelectionEnabled()&&Pr)Le&&Le.grabbed()&&(b(st),Le.emit(Sr("freeon")),st.emit(Sr("free")),t.dragData.didDrag&&(Le.emit(Sr("dragfreeon")),st.emit(Sr("dragfree")))),si();else if(Le&&Le.grabbed()&&t.nodeIsDraggable(Le)){var An=!t.dragData.didDrag;An&&t.redrawHint("eles",!0),t.dragData.didDrag=!0,t.hoverData.draggingEles||x(st,{inDragLayer:!0});var nn={x:0,y:0};if(Ee(nt[0])&&Ee(nt[1])&&(nn.x+=nt[0],nn.y+=nt[1],An)){var Rn=t.hoverData.dragDelta;Rn&&Ee(Rn[0])&&Ee(Rn[1])&&(nn.x+=Rn[0],nn.y+=Rn[1])}t.hoverData.draggingEles=!0,st.silentShift(nn).emit(Sr("position")).emit(Sr("drag")),t.redrawHint("drag",!0),t.redraw()}}else Fa();ae=!0}if(He[2]=ye[0],He[3]=ye[1],ae)return H.stopPropagation&&H.stopPropagation(),H.preventDefault&&H.preventDefault(),!1}},!1);var R,I,U;t.registerBinding(e,"mouseup",function(H){if(!(t.hoverData.which===1&&H.which!==1&&t.hoverData.capture)){var Q=t.hoverData.capture;if(Q){t.hoverData.capture=!1;var ae=t.cy,ue=t.projectIntoViewport(H.clientX,H.clientY),fe=t.selection,xe=t.findNearestElement(ue[0],ue[1],!0,!1),ye=t.dragData.possibleDragElements,je=t.hoverData.down,Me=a(H);t.data.bgActivePosistion&&(t.redrawHint("select",!0),t.redraw()),t.hoverData.tapholdCancelled=!0,t.data.bgActivePosistion=void 0,je&&je.unactivate();var He=function(Ot){return{originalEvent:H,type:Ot,position:{x:ue[0],y:ue[1]}}};if(t.hoverData.which===3){var et=He("cxttapend");if(je?je.emit(et):ae.emit(et),!t.hoverData.cxtDragged){var tt=He("cxttap");je?je.emit(tt):ae.emit(tt)}t.hoverData.cxtDragged=!1,t.hoverData.which=null}else if(t.hoverData.which===1){if(i(xe,["mouseup","tapend","vmouseup"],H,{x:ue[0],y:ue[1]}),!t.dragData.didDrag&&!t.hoverData.dragged&&!t.hoverData.selecting&&!t.hoverData.isOverThresholdDrag&&(i(je,["click","tap","vclick"],H,{x:ue[0],y:ue[1]}),I=!1,H.timeStamp-U<=ae.multiClickDebounceTime()?(R&&clearTimeout(R),I=!0,U=null,i(je,["dblclick","dbltap","vdblclick"],H,{x:ue[0],y:ue[1]})):(R=setTimeout(function(){I||i(je,["oneclick","onetap","voneclick"],H,{x:ue[0],y:ue[1]})},ae.multiClickDebounceTime()),U=H.timeStamp)),je==null&&!t.dragData.didDrag&&!t.hoverData.selecting&&!t.hoverData.dragged&&!a(H)&&(ae.$(r).unselect(["tapunselect"]),ye.length>0&&t.redrawHint("eles",!0),t.dragData.possibleDragElements=ye=ae.collection()),xe==je&&!t.dragData.didDrag&&!t.hoverData.selecting&&xe!=null&&xe._private.selectable&&(t.hoverData.dragging||(ae.selectionType()==="additive"||Me?xe.selected()?xe.unselect(["tapunselect"]):xe.select(["tapselect"]):Me||(ae.$(r).unmerge(xe).unselect(["tapunselect"]),xe.select(["tapselect"]))),t.redrawHint("eles",!0)),t.hoverData.selecting){var Le=ae.collection(t.getAllInBox(fe[0],fe[1],fe[2],fe[3]));t.redrawHint("select",!0),Le.length>0&&t.redrawHint("eles",!0),ae.emit(He("boxend"));var nt=function(Ot){return Ot.selectable()&&!Ot.selected()};ae.selectionType()==="additive"||Me||ae.$(r).unmerge(Le).unselect(),Le.emit(He("box")).stdFilter(nt).select().emit(He("boxselect")),t.redraw()}if(t.hoverData.dragging&&(t.hoverData.dragging=!1,t.redrawHint("select",!0),t.redrawHint("eles",!0),t.redraw()),!fe[4]){t.redrawHint("drag",!0),t.redrawHint("eles",!0);var st=je&&je.grabbed();b(ye),st&&(je.emit(He("freeon")),ye.emit(He("free")),t.dragData.didDrag&&(je.emit(He("dragfreeon")),ye.emit(He("dragfree"))))}}fe[4]=0,t.hoverData.down=null,t.hoverData.cxtStarted=!1,t.hoverData.draggingEles=!1,t.hoverData.selecting=!1,t.hoverData.isOverThresholdDrag=!1,t.dragData.didDrag=!1,t.hoverData.dragged=!1,t.hoverData.dragDelta=[],t.hoverData.mdownPos=null,t.hoverData.mdownGPos=null,t.hoverData.which=null}}},!1);var B=[],z=4,F,V=1e5,J=function(H,Q){for(var ae=0;ae<H.length;ae++)if(H[ae]%Q!==0)return!1;return!0},Y=function(H){for(var Q=Math.abs(H[0]),ae=1;ae<H.length;ae++)if(Math.abs(H[ae])!==Q)return!1;return!0},L=function(H){var Q=!1,ae=H.deltaY;if(ae==null&&(H.wheelDeltaY!=null?ae=H.wheelDeltaY/4:H.wheelDelta!=null&&(ae=H.wheelDelta/4)),ae!==0){if(F==null)if(B.length>=z){var ue=B;if(F=J(ue,5),!F){var fe=Math.abs(ue[0]);F=Y(ue)&&fe>5}if(F)for(var xe=0;xe<ue.length;xe++)V=Math.min(Math.abs(ue[xe]),V)}else B.push(ae),Q=!0;else F&&(V=Math.min(Math.abs(ae),V));if(!t.scrollingPage){var ye=t.cy,je=ye.zoom(),Me=ye.pan(),He=t.projectIntoViewport(H.clientX,H.clientY),et=[He[0]*je+Me.x,He[1]*je+Me.y];if(t.hoverData.draggingEles||t.hoverData.dragging||t.hoverData.cxtStarted||A()){H.preventDefault();return}if(ye.panningEnabled()&&ye.userPanningEnabled()&&ye.zoomingEnabled()&&ye.userZoomingEnabled()){H.preventDefault(),t.data.wheelZooming=!0,clearTimeout(t.data.wheelTimeout),t.data.wheelTimeout=setTimeout(function(){t.data.wheelZooming=!1,t.redrawHint("eles",!0),t.redraw()},150);var tt;Q&&Math.abs(ae)>5&&(ae=t3(ae)*5),tt=ae/-250,F&&(tt/=V,tt*=3),tt=tt*t.wheelSensitivity;var Le=H.deltaMode===1;Le&&(tt*=33);var nt=ye.zoom()*Math.pow(10,tt);H.type==="gesturechange"&&(nt=t.gestureStartZoom*H.scale),ye.zoom({level:nt,renderedPosition:{x:et[0],y:et[1]}}),ye.emit({type:H.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:H,position:{x:He[0],y:He[1]}})}}}};t.registerBinding(t.container,"wheel",L,!0),t.registerBinding(e,"scroll",function(H){t.scrollingPage=!0,clearTimeout(t.scrollingPageTimeout),t.scrollingPageTimeout=setTimeout(function(){t.scrollingPage=!1},250)},!0),t.registerBinding(t.container,"gesturestart",function(H){t.gestureStartZoom=t.cy.zoom(),t.hasTouchStarted||H.preventDefault()},!0),t.registerBinding(t.container,"gesturechange",function(ve){t.hasTouchStarted||L(ve)},!0),t.registerBinding(t.container,"mouseout",function(H){var Q=t.projectIntoViewport(H.clientX,H.clientY);t.cy.emit({originalEvent:H,type:"mouseout",position:{x:Q[0],y:Q[1]}})},!1),t.registerBinding(t.container,"mouseover",function(H){var Q=t.projectIntoViewport(H.clientX,H.clientY);t.cy.emit({originalEvent:H,type:"mouseover",position:{x:Q[0],y:Q[1]}})},!1);var G,ee,re,se,de,W,ne,ie,$,q,te,Z,le,ge=function(H,Q,ae,ue){return Math.sqrt((ae-H)*(ae-H)+(ue-Q)*(ue-Q))},Ue=function(H,Q,ae,ue){return(ae-H)*(ae-H)+(ue-Q)*(ue-Q)},Te;t.registerBinding(t.container,"touchstart",Te=function(H){if(t.hasTouchStarted=!0,!!P(H)){w(),t.touchData.capture=!0,t.data.bgActivePosistion=void 0;var Q=t.cy,ae=t.touchData.now,ue=t.touchData.earlier;if(H.touches[0]){var fe=t.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);ae[0]=fe[0],ae[1]=fe[1]}if(H.touches[1]){var fe=t.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);ae[2]=fe[0],ae[3]=fe[1]}if(H.touches[2]){var fe=t.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);ae[4]=fe[0],ae[5]=fe[1]}var xe=function(Pr){return{originalEvent:H,type:Pr,position:{x:ae[0],y:ae[1]}}};if(H.touches[1]){t.touchData.singleTouchMoved=!0,b(t.dragData.touchDragEles);var ye=t.findContainerClientCoords();$=ye[0],q=ye[1],te=ye[2],Z=ye[3],G=H.touches[0].clientX-$,ee=H.touches[0].clientY-q,re=H.touches[1].clientX-$,se=H.touches[1].clientY-q,le=0<=G&&G<=te&&0<=re&&re<=te&&0<=ee&&ee<=Z&&0<=se&&se<=Z;var je=Q.pan(),Me=Q.zoom();de=ge(G,ee,re,se),W=Ue(G,ee,re,se),ne=[(G+re)/2,(ee+se)/2],ie=[(ne[0]-je.x)/Me,(ne[1]-je.y)/Me];var He=200,et=He*He;if(W<et&&!H.touches[2]){var tt=t.findNearestElement(ae[0],ae[1],!0,!0),Le=t.findNearestElement(ae[2],ae[3],!0,!0);tt&&tt.isNode()?(tt.activate().emit(xe("cxttapstart")),t.touchData.start=tt):Le&&Le.isNode()?(Le.activate().emit(xe("cxttapstart")),t.touchData.start=Le):Q.emit(xe("cxttapstart")),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!0,t.touchData.cxtDragged=!1,t.data.bgActivePosistion=void 0,t.redraw();return}}if(H.touches[2])Q.boxSelectionEnabled()&&H.preventDefault();else if(!H.touches[1]){if(H.touches[0]){var nt=t.findNearestElements(ae[0],ae[1],!0,!0),st=nt[0];if(st!=null&&(st.activate(),t.touchData.start=st,t.touchData.starts=nt,t.nodeIsGrabbable(st))){var Kt=t.dragData.touchDragEles=Q.collection(),Ot=null;t.redrawHint("eles",!0),t.redrawHint("drag",!0),st.selected()?(Ot=Q.$(function(wr){return wr.selected()&&t.nodeIsGrabbable(wr)}),x(Ot,{addToList:Kt})):y(st,{addToList:Kt}),d(st),st.emit(xe("grabon")),Ot?Ot.forEach(function(wr){wr.emit(xe("grab"))}):st.emit(xe("grab"))}i(st,["touchstart","tapstart","vmousedown"],H,{x:ae[0],y:ae[1]}),st==null&&(t.data.bgActivePosistion={x:fe[0],y:fe[1]},t.redrawHint("select",!0),t.redraw()),t.touchData.singleTouchMoved=!1,t.touchData.singleTouchStartTime=+new Date,clearTimeout(t.touchData.tapholdTimeout),t.touchData.tapholdTimeout=setTimeout(function(){t.touchData.singleTouchMoved===!1&&!t.pinching&&!t.touchData.selecting&&i(t.touchData.start,["taphold"],H,{x:ae[0],y:ae[1]})},t.tapholdDuration)}}if(H.touches.length>=1){for(var yn=t.touchData.startPosition=[null,null,null,null,null,null],br=0;br<ae.length;br++)yn[br]=ue[br]=ae[br];var Ir=H.touches[0];t.touchData.startGPosition=[Ir.clientX,Ir.clientY]}}},!1);var Re;t.registerBinding(e,"touchmove",Re=function(H){var Q=t.touchData.capture;if(!(!Q&&!P(H))){var ae=t.selection,ue=t.cy,fe=t.touchData.now,xe=t.touchData.earlier,ye=ue.zoom();if(H.touches[0]){var je=t.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);fe[0]=je[0],fe[1]=je[1]}if(H.touches[1]){var je=t.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);fe[2]=je[0],fe[3]=je[1]}if(H.touches[2]){var je=t.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);fe[4]=je[0],fe[5]=je[1]}var Me=function(pc){return{originalEvent:H,type:pc,position:{x:fe[0],y:fe[1]}}},He=t.touchData.startGPosition,et;if(Q&&H.touches[0]&&He){for(var tt=[],Le=0;Le<fe.length;Le++)tt[Le]=fe[Le]-xe[Le];var nt=H.touches[0].clientX-He[0],st=nt*nt,Kt=H.touches[0].clientY-He[1],Ot=Kt*Kt,yn=st+Ot;et=yn>=t.touchTapThreshold2}if(Q&&t.touchData.cxt){H.preventDefault();var br=H.touches[0].clientX-$,Ir=H.touches[0].clientY-q,wr=H.touches[1].clientX-$,Pr=H.touches[1].clientY-q,Fa=Ue(br,Ir,wr,Pr),Sr=Fa/W,si=150,pa=si*si,ho=1.5,hc=ho*ho;if(Sr>=hc||Fa>=pa){t.touchData.cxt=!1,t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var xs=Me("cxttapend");t.touchData.start?(t.touchData.start.unactivate().emit(xs),t.touchData.start=null):ue.emit(xs)}}if(Q&&t.touchData.cxt){var xs=Me("cxtdrag");t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.touchData.start?t.touchData.start.emit(xs):ue.emit(xs),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxtDragged=!0;var An=t.findNearestElement(fe[0],fe[1],!0,!0);(!t.touchData.cxtOver||An!==t.touchData.cxtOver)&&(t.touchData.cxtOver&&t.touchData.cxtOver.emit(Me("cxtdragout")),t.touchData.cxtOver=An,An&&An.emit(Me("cxtdragover")))}else if(Q&&H.touches[2]&&ue.boxSelectionEnabled())H.preventDefault(),t.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,t.touchData.selecting||ue.emit(Me("boxstart")),t.touchData.selecting=!0,t.touchData.didSelect=!0,ae[4]=1,!ae||ae.length===0||ae[0]===void 0?(ae[0]=(fe[0]+fe[2]+fe[4])/3,ae[1]=(fe[1]+fe[3]+fe[5])/3,ae[2]=(fe[0]+fe[2]+fe[4])/3+1,ae[3]=(fe[1]+fe[3]+fe[5])/3+1):(ae[2]=(fe[0]+fe[2]+fe[4])/3,ae[3]=(fe[1]+fe[3]+fe[5])/3),t.redrawHint("select",!0),t.redraw();else if(Q&&H.touches[1]&&!t.touchData.didSelect&&ue.zoomingEnabled()&&ue.panningEnabled()&&ue.userZoomingEnabled()&&ue.userPanningEnabled()){H.preventDefault(),t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var nn=t.dragData.touchDragEles;if(nn){t.redrawHint("drag",!0);for(var Rn=0;Rn<nn.length;Rn++){var Hl=nn[Rn]._private;Hl.grabbed=!1,Hl.rscratch.inDragLayer=!1}}var oi=t.touchData.start,br=H.touches[0].clientX-$,Ir=H.touches[0].clientY-q,wr=H.touches[1].clientX-$,Pr=H.touches[1].clientY-q,wm=ge(br,Ir,wr,Pr),N1=wm/de;if(le){var E1=br-G,T1=Ir-ee,j1=wr-re,vf=Pr-se,Wl=(E1+j1)/2,yf=(T1+vf)/2,bs=ue.zoom(),xf=bs*N1,po=ue.pan(),ws=ie[0]*bs+po.x,ma=ie[1]*bs+po.y,$t={x:-xf/bs*(ws-po.x-Wl)+ws,y:-xf/bs*(ma-po.y-yf)+ma};if(oi&&oi.active()){var nn=t.dragData.touchDragEles;b(nn),t.redrawHint("drag",!0),t.redrawHint("eles",!0),oi.unactivate().emit(Me("freeon")),nn.emit(Me("free")),t.dragData.didDrag&&(oi.emit(Me("dragfreeon")),nn.emit(Me("dragfree")))}ue.viewport({zoom:xf,pan:$t,cancelOnFailedZoom:!0}),ue.emit(Me("pinchzoom")),de=wm,G=br,ee=Ir,re=wr,se=Pr,t.pinching=!0}if(H.touches[0]){var je=t.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);fe[0]=je[0],fe[1]=je[1]}if(H.touches[1]){var je=t.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);fe[2]=je[0],fe[3]=je[1]}if(H.touches[2]){var je=t.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);fe[4]=je[0],fe[5]=je[1]}}else if(H.touches[0]&&!t.touchData.didSelect){var vt=t.touchData.start,Fi=t.touchData.last,An;if(!t.hoverData.draggingEles&&!t.swipePanning&&(An=t.findNearestElement(fe[0],fe[1],!0,!0)),Q&&vt!=null&&H.preventDefault(),Q&&vt!=null&&t.nodeIsDraggable(vt))if(et){var nn=t.dragData.touchDragEles,Gr=!t.dragData.didDrag;Gr&&x(nn,{inDragLayer:!0}),t.dragData.didDrag=!0;var Lr={x:0,y:0};if(Ee(tt[0])&&Ee(tt[1])&&(Lr.x+=tt[0],Lr.y+=tt[1],Gr)){t.redrawHint("eles",!0);var Hr=t.touchData.dragDelta;Hr&&Ee(Hr[0])&&Ee(Hr[1])&&(Lr.x+=Hr[0],Lr.y+=Hr[1])}t.hoverData.draggingEles=!0,nn.silentShift(Lr).emit(Me("position")).emit(Me("drag")),t.redrawHint("drag",!0),t.touchData.startPosition[0]==xe[0]&&t.touchData.startPosition[1]==xe[1]&&t.redrawHint("eles",!0),t.redraw()}else{var Hr=t.touchData.dragDelta=t.touchData.dragDelta||[];Hr.length===0?(Hr.push(tt[0]),Hr.push(tt[1])):(Hr[0]+=tt[0],Hr[1]+=tt[1])}if(i(vt||An,["touchmove","tapdrag","vmousemove"],H,{x:fe[0],y:fe[1]}),(!vt||!vt.grabbed())&&An!=Fi&&(Fi&&Fi.emit(Me("tapdragout")),An&&An.emit(Me("tapdragover"))),t.touchData.last=An,Q)for(var Rn=0;Rn<fe.length;Rn++)fe[Rn]&&t.touchData.startPosition[Rn]&&et&&(t.touchData.singleTouchMoved=!0);if(Q&&(vt==null||vt.pannable())&&ue.panningEnabled()&&ue.userPanningEnabled()){var mo=s(vt,t.touchData.starts);mo&&(H.preventDefault(),t.data.bgActivePosistion||(t.data.bgActivePosistion=od(t.touchData.startPosition)),t.swipePanning?(ue.panBy({x:tt[0]*ye,y:tt[1]*ye}),ue.emit(Me("dragpan"))):et&&(t.swipePanning=!0,ue.panBy({x:nt*ye,y:Kt*ye}),ue.emit(Me("dragpan")),vt&&(vt.unactivate(),t.redrawHint("select",!0),t.touchData.start=null)));var je=t.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);fe[0]=je[0],fe[1]=je[1]}}for(var Le=0;Le<fe.length;Le++)xe[Le]=fe[Le];Q&&H.touches.length>0&&!t.hoverData.draggingEles&&!t.swipePanning&&t.data.bgActivePosistion!=null&&(t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.redraw())}},!1);var Ge;t.registerBinding(e,"touchcancel",Ge=function(H){var Q=t.touchData.start;t.touchData.capture=!1,Q&&Q.unactivate()});var Ce,De,Ve,We;if(t.registerBinding(e,"touchend",Ce=function(H){var Q=t.touchData.start,ae=t.touchData.capture;if(ae)H.touches.length===0&&(t.touchData.capture=!1),H.preventDefault();else return;var ue=t.selection;t.swipePanning=!1,t.hoverData.draggingEles=!1;var fe=t.cy,xe=fe.zoom(),ye=t.touchData.now,je=t.touchData.earlier;if(H.touches[0]){var Me=t.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);ye[0]=Me[0],ye[1]=Me[1]}if(H.touches[1]){var Me=t.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);ye[2]=Me[0],ye[3]=Me[1]}if(H.touches[2]){var Me=t.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);ye[4]=Me[0],ye[5]=Me[1]}var He=function(pa){return{originalEvent:H,type:pa,position:{x:ye[0],y:ye[1]}}};Q&&Q.unactivate();var et;if(t.touchData.cxt){if(et=He("cxttapend"),Q?Q.emit(et):fe.emit(et),!t.touchData.cxtDragged){var tt=He("cxttap");Q?Q.emit(tt):fe.emit(tt)}t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!1,t.touchData.start=null,t.redraw();return}if(!H.touches[2]&&fe.boxSelectionEnabled()&&t.touchData.selecting){t.touchData.selecting=!1;var Le=fe.collection(t.getAllInBox(ue[0],ue[1],ue[2],ue[3]));ue[0]=void 0,ue[1]=void 0,ue[2]=void 0,ue[3]=void 0,ue[4]=0,t.redrawHint("select",!0),fe.emit(He("boxend"));var nt=function(pa){return pa.selectable()&&!pa.selected()};Le.emit(He("box")).stdFilter(nt).select().emit(He("boxselect")),Le.nonempty()&&t.redrawHint("eles",!0),t.redraw()}if(Q!=null&&Q.unactivate(),H.touches[2])t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);else if(!H.touches[1]){if(!H.touches[0]){if(!H.touches[0]){t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var st=t.dragData.touchDragEles;if(Q!=null){var Kt=Q._private.grabbed;b(st),t.redrawHint("drag",!0),t.redrawHint("eles",!0),Kt&&(Q.emit(He("freeon")),st.emit(He("free")),t.dragData.didDrag&&(Q.emit(He("dragfreeon")),st.emit(He("dragfree")))),i(Q,["touchend","tapend","vmouseup","tapdragout"],H,{x:ye[0],y:ye[1]}),Q.unactivate(),t.touchData.start=null}else{var Ot=t.findNearestElement(ye[0],ye[1],!0,!0);i(Ot,["touchend","tapend","vmouseup","tapdragout"],H,{x:ye[0],y:ye[1]})}var yn=t.touchData.startPosition[0]-ye[0],br=yn*yn,Ir=t.touchData.startPosition[1]-ye[1],wr=Ir*Ir,Pr=br+wr,Fa=Pr*xe*xe;t.touchData.singleTouchMoved||(Q||fe.$(":selected").unselect(["tapunselect"]),i(Q,["tap","vclick"],H,{x:ye[0],y:ye[1]}),De=!1,H.timeStamp-We<=fe.multiClickDebounceTime()?(Ve&&clearTimeout(Ve),De=!0,We=null,i(Q,["dbltap","vdblclick"],H,{x:ye[0],y:ye[1]})):(Ve=setTimeout(function(){De||i(Q,["onetap","voneclick"],H,{x:ye[0],y:ye[1]})},fe.multiClickDebounceTime()),We=H.timeStamp)),Q!=null&&!t.dragData.didDrag&&Q._private.selectable&&Fa<t.touchTapThreshold2&&!t.pinching&&(fe.selectionType()==="single"?(fe.$(r).unmerge(Q).unselect(["tapunselect"]),Q.select(["tapselect"])):Q.selected()?Q.unselect(["tapunselect"]):Q.select(["tapselect"]),t.redrawHint("eles",!0)),t.touchData.singleTouchMoved=!0}}}for(var Sr=0;Sr<ye.length;Sr++)je[Sr]=ye[Sr];t.dragData.didDrag=!1,H.touches.length===0&&(t.touchData.dragDelta=[],t.touchData.startPosition=[null,null,null,null,null,null],t.touchData.startGPosition=null,t.touchData.didSelect=!1),H.touches.length<2&&(H.touches.length===1&&(t.touchData.startGPosition=[H.touches[0].clientX,H.touches[0].clientY]),t.pinching=!1,t.redrawHint("eles",!0),t.redraw())},!1),typeof TouchEvent>"u"){var Ie=[],rt=function(H){return{clientX:H.clientX,clientY:H.clientY,force:1,identifier:H.pointerId,pageX:H.pageX,pageY:H.pageY,radiusX:H.width/2,radiusY:H.height/2,screenX:H.screenX,screenY:H.screenY,target:H.target}},ut=function(H){return{event:H,touch:rt(H)}},xt=function(H){Ie.push(ut(H))},bt=function(H){for(var Q=0;Q<Ie.length;Q++){var ae=Ie[Q];if(ae.event.pointerId===H.pointerId){Ie.splice(Q,1);return}}},Nt=function(H){var Q=Ie.filter(function(ae){return ae.event.pointerId===H.pointerId})[0];Q.event=H,Q.touch=rt(H)},Je=function(H){H.touches=Ie.map(function(Q){return Q.touch})},Oe=function(H){return H.pointerType==="mouse"||H.pointerType===4};t.registerBinding(t.container,"pointerdown",function(ve){Oe(ve)||(ve.preventDefault(),xt(ve),Je(ve),Te(ve))}),t.registerBinding(t.container,"pointerup",function(ve){Oe(ve)||(bt(ve),Je(ve),Ce(ve))}),t.registerBinding(t.container,"pointercancel",function(ve){Oe(ve)||(bt(ve),Je(ve),Ge(ve))}),t.registerBinding(t.container,"pointermove",function(ve){Oe(ve)||(ve.preventDefault(),Nt(ve),Je(ve),Re(ve))})}};var ao={};ao.generatePolygon=function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,draw:function(n,i,a,s,o,l){this.renderer.nodeShapeImpl("polygon",n,i,a,s,o,this.points)},intersectLine:function(n,i,a,s,o,l,u,c){return wp(o,l,this.points,n,i,a/2,s/2,u)},checkPoint:function(n,i,a,s,o,l,u,c){return to(n,i,this.points,l,u,s,o,[0,-1],a)},hasMiterBounds:t!=="rectangle",miterBounds:function(n,i,a,s,o,l){return rG(this.points,n,i,a,s,o)}}};ao.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a)},intersectLine:function(e,r,n,i,a,s,o,l){return cG(a,s,e,r,n/2+o,i/2+o)},checkPoint:function(e,r,n,i,a,s,o,l){return yu(e,r,i,a,s,o,n)}}};ao.generateRoundPolygon=function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,getOrCreateCorners:function(n,i,a,s,o,l,u){if(l[u]!==void 0&&l[u+"-cx"]===n&&l[u+"-cy"]===i)return l[u];l[u]=new Array(e.length/2),l[u+"-cx"]=n,l[u+"-cy"]=i;var c=a/2,d=s/2;o=o==="auto"?eR(a,s):o;for(var h=new Array(e.length/2),m=0;m<e.length/2;m++)h[m]={x:n+c*e[m*2],y:i+d*e[m*2+1]};var v,x,y,b,S=h.length;for(x=h[S-1],v=0;v<S;v++)y=h[v%S],b=h[(v+1)%S],l[u][v]=p3(x,y,b,o),x=y,y=b;return l[u]},draw:function(n,i,a,s,o,l,u){this.renderer.nodeShapeImpl("round-polygon",n,i,a,s,o,this.points,this.getOrCreateCorners(i,a,s,o,l,u,"drawCorners"))},intersectLine:function(n,i,a,s,o,l,u,c,d){return fG(o,l,this.points,n,i,a,s,u,this.getOrCreateCorners(n,i,a,s,c,d,"corners"))},checkPoint:function(n,i,a,s,o,l,u,c,d){return uG(n,i,this.points,l,u,s,o,this.getOrCreateCorners(l,u,s,o,c,d,"corners"))}}};ao.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Qn(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,this.points,s)},intersectLine:function(e,r,n,i,a,s,o,l){return JA(a,s,e,r,n,i,o,l)},checkPoint:function(e,r,n,i,a,s,o,l){var u=i/2,c=a/2;l=l==="auto"?vl(i,a):l,l=Math.min(u,c,l);var d=l*2;return!!(to(e,r,this.points,s,o,i,a-d,[0,-1],n)||to(e,r,this.points,s,o,i-d,a,[0,-1],n)||yu(e,r,d,d,s-u+l,o-c+l,n)||yu(e,r,d,d,s+u-l,o-c+l,n)||yu(e,r,d,d,s+u-l,o+c-l,n)||yu(e,r,d,d,s-u+l,o+c-l,n))}}};ao.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:n3(),points:Qn(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,null,s)},generateCutTrianglePts:function(e,r,n,i,a){var s=a==="auto"?this.cornerLength:a,o=r/2,l=e/2,u=n-l,c=n+l,d=i-o,h=i+o;return{topLeft:[u,d+s,u+s,d,u+s,d+s],topRight:[c-s,d,c,d+s,c-s,d+s],bottomRight:[c,h-s,c-s,h,c-s,h-s],bottomLeft:[u+s,h,u,h-s,u+s,h-s]}},intersectLine:function(e,r,n,i,a,s,o,l){var u=this.generateCutTrianglePts(n+2*o,i+2*o,e,r,l),c=[].concat.apply([],[u.topLeft.splice(0,4),u.topRight.splice(0,4),u.bottomRight.splice(0,4),u.bottomLeft.splice(0,4)]);return wp(a,s,c,e,r)},checkPoint:function(e,r,n,i,a,s,o,l){var u=l==="auto"?this.cornerLength:l;if(to(e,r,this.points,s,o,i,a-2*u,[0,-1],n)||to(e,r,this.points,s,o,i-2*u,a,[0,-1],n))return!0;var c=this.generateCutTrianglePts(i,a,s,o);return pi(e,r,c.topLeft)||pi(e,r,c.topRight)||pi(e,r,c.bottomRight)||pi(e,r,c.bottomLeft)}}};ao.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Qn(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a)},intersectLine:function(e,r,n,i,a,s,o,l){var u=.15,c=.5,d=.85,h=this.generateBarrelBezierPts(n+2*o,i+2*o,e,r),m=function(y){var b=yd({x:y[0],y:y[1]},{x:y[2],y:y[3]},{x:y[4],y:y[5]},u),S=yd({x:y[0],y:y[1]},{x:y[2],y:y[3]},{x:y[4],y:y[5]},c),w=yd({x:y[0],y:y[1]},{x:y[2],y:y[3]},{x:y[4],y:y[5]},d);return[y[0],y[1],b.x,b.y,S.x,S.y,w.x,w.y,y[4],y[5]]},v=[].concat(m(h.topLeft),m(h.topRight),m(h.bottomRight),m(h.bottomLeft));return wp(a,s,v,e,r)},generateBarrelBezierPts:function(e,r,n,i){var a=r/2,s=e/2,o=n-s,l=n+s,u=i-a,c=i+a,d=B5(e,r),h=d.heightOffset,m=d.widthOffset,v=d.ctrlPtOffsetPct*e,x={topLeft:[o,u+h,o+v,u,o+m,u],topRight:[l-m,u,l-v,u,l,u+h],bottomRight:[l,c-h,l-v,c,l-m,c],bottomLeft:[o+m,c,o+v,c,o,c-h]};return x.topLeft.isTop=!0,x.topRight.isTop=!0,x.bottomLeft.isBottom=!0,x.bottomRight.isBottom=!0,x},checkPoint:function(e,r,n,i,a,s,o,l){var u=B5(i,a),c=u.heightOffset,d=u.widthOffset;if(to(e,r,this.points,s,o,i,a-2*c,[0,-1],n)||to(e,r,this.points,s,o,i-2*d,a,[0,-1],n))return!0;for(var h=this.generateBarrelBezierPts(i,a,s,o),m=function(M,A,P){var D=P[4],R=P[2],I=P[0],U=P[5],B=P[1],z=Math.min(D,I),F=Math.max(D,I),V=Math.min(U,B),J=Math.max(U,B);if(z<=M&&M<=F&&V<=A&&A<=J){var Y=hG(D,R,I),L=aG(Y[0],Y[1],Y[2],M),G=L.filter(function(ee){return 0<=ee&&ee<=1});if(G.length>0)return G[0]}return null},v=Object.keys(h),x=0;x<v.length;x++){var y=v[x],b=h[y],S=m(e,r,b);if(S!=null){var w=b[5],k=b[3],N=b[1],T=un(w,k,N,S);if(b.isTop&&T<=r||b.isBottom&&r<=T)return!0}}return!1}}};ao.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Qn(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,this.points,s)},intersectLine:function(e,r,n,i,a,s,o,l){var u=e-(n/2+o),c=r-(i/2+o),d=c,h=e+(n/2+o),m=Ko(a,s,e,r,u,c,h,d,!1);return m.length>0?m:JA(a,s,e,r,n,i,o,l)},checkPoint:function(e,r,n,i,a,s,o,l){l=l==="auto"?vl(i,a):l;var u=2*l;if(to(e,r,this.points,s,o,i,a-u,[0,-1],n)||to(e,r,this.points,s,o,i-u,a,[0,-1],n))return!0;var c=i/2+2*n,d=a/2+2*n,h=[s-c,o-d,s-c,o,s+c,o,s+c,o-d];return!!(pi(e,r,h)||yu(e,r,u,u,s+i/2-l,o+a/2-l,n)||yu(e,r,u,u,s-i/2+l,o+a/2-l,n))}}};ao.registerNodeShapes=function(){var t=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",Qn(3,0)),this.generateRoundPolygon("round-triangle",Qn(3,0)),this.generatePolygon("rectangle",Qn(4,0)),t.square=t.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var r=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",r),this.generateRoundPolygon("round-diamond",r)}this.generatePolygon("pentagon",Qn(5,0)),this.generateRoundPolygon("round-pentagon",Qn(5,0)),this.generatePolygon("hexagon",Qn(6,0)),this.generateRoundPolygon("round-hexagon",Qn(6,0)),this.generatePolygon("heptagon",Qn(7,0)),this.generateRoundPolygon("round-heptagon",Qn(7,0)),this.generatePolygon("octagon",Qn(8,0)),this.generateRoundPolygon("round-octagon",Qn(8,0));var n=new Array(20);{var i=L5(5,0),a=L5(5,Math.PI/5),s=.5*(3-Math.sqrt(5));s*=1.57;for(var o=0;o<a.length/2;o++)a[o*2]*=s,a[o*2+1]*=s;for(var o=0;o<20/4;o++)n[o*4]=i[o*2],n[o*4+1]=i[o*2+1],n[o*4+2]=a[o*2],n[o*4+3]=a[o*2+1]}n=ZA(n),this.generatePolygon("star",n),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}t.makePolygon=function(u){var c=u.join("$"),d="polygon-"+c,h;return(h=this[d])?h:e.generatePolygon(d,u)}};var om={};om.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};om.redraw=function(t){t=t||KA();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=t};om.beforeRender=function(t,e){if(!this.destroyed){e==null&&lr("Priority is not optional for beforeRender");var r=this.beforeRenderCallbacks;r.push({fn:t,priority:e}),r.sort(function(n,i){return i.priority-n.priority})}};var z8=function(e,r,n){for(var i=e.beforeRenderCallbacks,a=0;a<i.length;a++)i[a].fn(r,n)};om.startRenderLoop=function(){var t=this,e=t.cy;if(!t.renderLoopStarted){t.renderLoopStarted=!0;var r=function(i){if(!t.destroyed){if(!e.batching())if(t.requestedFrame&&!t.skipFrame){z8(t,!0,i);var a=eo();t.render(t.renderOptions);var s=t.lastDrawTime=eo();t.averageRedrawTime===void 0&&(t.averageRedrawTime=s-a),t.redrawCount===void 0&&(t.redrawCount=0),t.redrawCount++,t.redrawTotalTime===void 0&&(t.redrawTotalTime=0);var o=s-a;t.redrawTotalTime+=o,t.lastRedrawTime=o,t.averageRedrawTime=t.averageRedrawTime/2+o/2,t.requestedFrame=!1}else z8(t,!1,i);t.skipFrame=!1,S0(r)}};S0(r)}};var Mq=function(e){this.init(e)},e7=Mq,lf=e7.prototype;lf.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];lf.init=function(t){var e=this;e.options=t,e.cy=t.cy;var r=e.container=t.cy.container(),n=e.cy.window();if(n){var i=n.document,a=i.head,s="__________cytoscape_stylesheet",o="__________cytoscape_container",l=i.getElementById(s)!=null;if(r.className.indexOf(o)<0&&(r.className=(r.className||"")+" "+o),!l){var u=i.createElement("style");u.id=s,u.textContent="."+o+" { position: relative; }",a.insertBefore(u,a.children[0])}var c=n.getComputedStyle(r),d=c.getPropertyValue("position");d==="static"&&Lt("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=t.showFps,e.debug=t.debug,e.webgl=t.webgl,e.hideEdgesOnViewport=t.hideEdgesOnViewport,e.textureOnViewport=t.textureOnViewport,e.wheelSensitivity=t.wheelSensitivity,e.motionBlurEnabled=t.motionBlur,e.forcedPixelRatio=Ee(t.pixelRatio)?t.pixelRatio:null,e.motionBlur=t.motionBlur,e.motionBlurOpacity=t.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=t.desktopTapThreshold,e.desktopTapThreshold2=t.desktopTapThreshold*t.desktopTapThreshold,e.touchTapThreshold=t.touchTapThreshold,e.touchTapThreshold2=t.touchTapThreshold*t.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};lf.notify=function(t,e){var r=this,n=r.cy;if(!this.destroyed){if(t==="init"){r.load();return}if(t==="destroy"){r.destroy();return}(t==="add"||t==="remove"||t==="move"&&n.hasCompoundNodes()||t==="load"||t==="zorder"||t==="mount")&&r.invalidateCachedZSortedEles(),t==="viewport"&&r.redrawHint("select",!0),t==="gc"&&r.redrawHint("gc",!0),(t==="load"||t==="resize"||t==="mount")&&(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container)),r.redrawHint("eles",!0),r.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};lf.destroy=function(){var t=this;t.destroyed=!0,t.cy.stopAnimationLoop();for(var e=0;e<t.bindings.length;e++){var r=t.bindings[e],n=r,i=n.target;(i.off||i.removeEventListener).apply(i,n.args)}if(t.bindings=[],t.beforeRenderCallbacks=[],t.onUpdateEleCalcsFns=[],t.removeObserver&&t.removeObserver.disconnect(),t.styleObserver&&t.styleObserver.disconnect(),t.resizeObserver&&t.resizeObserver.disconnect(),t.labelCalcDiv)try{document.body.removeChild(t.labelCalcDiv)}catch{}};lf.isHeadless=function(){return!1};[h3,JR,ZR,of,ao,om].forEach(function(t){Qe(lf,t)});var D2=1e3/60,t7={setupDequeueing:function(e){return function(){var n=this,i=this.renderer;if(!n.dequeueingSetup){n.dequeueingSetup=!0;var a=rm(function(){i.redrawHint("eles",!0),i.redrawHint("drag",!0),i.redraw()},e.deqRedrawThreshold),s=function(u,c){var d=eo(),h=i.averageRedrawTime,m=i.lastRedrawTime,v=[],x=i.cy.extent(),y=i.getPixelRatio();for(u||i.flushRenderedStyleQueue();;){var b=eo(),S=b-d,w=b-c;if(m<D2){var k=D2-(u?h:0);if(w>=e.deqFastCost*k)break}else if(u){if(S>=e.deqCost*m||S>=e.deqAvgCost*h)break}else if(w>=e.deqNoDrawCost*D2)break;var N=e.deq(n,y,x);if(N.length>0)for(var T=0;T<N.length;T++)v.push(N[T]);else break}v.length>0&&(e.onDeqd(n,v),!u&&e.shouldRedraw(n,v,y,x)&&a())},o=e.priority||JC;i.beforeRender(s,o(n))}}}},Pq=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:k0;Ml(this,t),this.idsByKey=new Us,this.keyForId=new Us,this.cachesByLvl=new Us,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=r}return Pl(t,[{key:"getIdsFor",value:function(r){r==null&&lr("Can not get id list for null key");var n=this.idsByKey,i=this.idsByKey.get(r);return i||(i=new rf,n.set(r,i)),i}},{key:"addIdForKey",value:function(r,n){r!=null&&this.getIdsFor(r).add(n)}},{key:"deleteIdForKey",value:function(r,n){r!=null&&this.getIdsFor(r).delete(n)}},{key:"getNumberOfIdsForKey",value:function(r){return r==null?0:this.getIdsFor(r).size}},{key:"updateKeyMappingFor",value:function(r){var n=r.id(),i=this.keyForId.get(n),a=this.getKey(r);this.deleteIdForKey(i,n),this.addIdForKey(a,n),this.keyForId.set(n,a)}},{key:"deleteKeyMappingFor",value:function(r){var n=r.id(),i=this.keyForId.get(n);this.deleteIdForKey(i,n),this.keyForId.delete(n)}},{key:"keyHasChangedFor",value:function(r){var n=r.id(),i=this.keyForId.get(n),a=this.getKey(r);return i!==a}},{key:"isInvalid",value:function(r){return this.keyHasChangedFor(r)||this.doesEleInvalidateKey(r)}},{key:"getCachesAt",value:function(r){var n=this.cachesByLvl,i=this.lvls,a=n.get(r);return a||(a=new Us,n.set(r,a),i.push(r)),a}},{key:"getCache",value:function(r,n){return this.getCachesAt(n).get(r)}},{key:"get",value:function(r,n){var i=this.getKey(r),a=this.getCache(i,n);return a!=null&&this.updateKeyMappingFor(r),a}},{key:"getForCachedKey",value:function(r,n){var i=this.keyForId.get(r.id()),a=this.getCache(i,n);return a}},{key:"hasCache",value:function(r,n){return this.getCachesAt(n).has(r)}},{key:"has",value:function(r,n){var i=this.getKey(r);return this.hasCache(i,n)}},{key:"setCache",value:function(r,n,i){i.key=r,this.getCachesAt(n).set(r,i)}},{key:"set",value:function(r,n,i){var a=this.getKey(r);this.setCache(a,n,i),this.updateKeyMappingFor(r)}},{key:"deleteCache",value:function(r,n){this.getCachesAt(n).delete(r)}},{key:"delete",value:function(r,n){var i=this.getKey(r);this.deleteCache(i,n)}},{key:"invalidateKey",value:function(r){var n=this;this.lvls.forEach(function(i){return n.deleteCache(r,i)})}},{key:"invalidate",value:function(r){var n=r.id(),i=this.keyForId.get(n);this.deleteKeyMappingFor(r);var a=this.doesEleInvalidateKey(r);return a&&this.invalidateKey(i),a||this.getNumberOfIdsForKey(i)===0}}])}(),V8=25,Vg=50,Ov=-4,Q5=3,r7=7.99,_q=8,Aq=1024,Rq=1024,Dq=1024,Oq=.2,Iq=.8,Lq=10,Bq=.15,Fq=.1,zq=.9,Vq=.9,$q=100,Uq=1,ud={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},Gq=Pn({getKey:null,doesEleInvalidateKey:k0,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:HA,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),bh=function(e,r){var n=this;n.renderer=e,n.onDequeues=[];var i=Gq(r);Qe(n,i),n.lookup=new Pq(i.getKey,i.doesEleInvalidateKey),n.setupDequeueing()},en=bh.prototype;en.reasons=ud;en.getTextureQueue=function(t){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[t]=e.eleImgCaches[t]||[]};en.getRetiredTextureQueue=function(t){var e=this,r=e.eleImgCaches.retired=e.eleImgCaches.retired||{},n=r[t]=r[t]||[];return n};en.getElementQueue=function(){var t=this,e=t.eleCacheQueue=t.eleCacheQueue||new nm(function(r,n){return n.reqs-r.reqs});return e};en.getElementKeyToQueue=function(){var t=this,e=t.eleKeyToCacheQueue=t.eleKeyToCacheQueue||{};return e};en.getElement=function(t,e,r,n,i){var a=this,s=this.renderer,o=s.cy.zoom(),l=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!t.visible()||t.removed()||!a.allowEdgeTxrCaching&&t.isEdge()||!a.allowParentTxrCaching&&t.isParent())return null;if(n==null&&(n=Math.ceil(e3(o*r))),n<Ov)n=Ov;else if(o>=r7||n>Q5)return null;var u=Math.pow(2,n),c=e.h*u,d=e.w*u,h=s.eleTextBiggerThanMin(t,u);if(!this.isVisible(t,h))return null;var m=l.get(t,n);if(m&&m.invalidated&&(m.invalidated=!1,m.texture.invalidatedWidth-=m.width),m)return m;var v;if(c<=V8?v=V8:c<=Vg?v=Vg:v=Math.ceil(c/Vg)*Vg,c>Dq||d>Rq)return null;var x=a.getTextureQueue(v),y=x[x.length-2],b=function(){return a.recycleTexture(v,d)||a.addTexture(v,d)};y||(y=x[x.length-1]),y||(y=b()),y.width-y.usedWidth<d&&(y=b());for(var S=function(z){return z&&z.scaledLabelShown===h},w=i&&i===ud.dequeue,k=i&&i===ud.highQuality,N=i&&i===ud.downscale,T,j=n+1;j<=Q5;j++){var M=l.get(t,j);if(M){T=M;break}}var A=T&&T.level===n+1?T:null,P=function(){y.context.drawImage(A.texture.canvas,A.x,0,A.width,A.height,y.usedWidth,0,d,c)};if(y.context.setTransform(1,0,0,1,0,0),y.context.clearRect(y.usedWidth,0,d,v),S(A))P();else if(S(T))if(k){for(var D=T.level;D>n;D--)A=a.getElement(t,e,r,D,ud.downscale);P()}else return a.queueElement(t,T.level-1),T;else{var R;if(!w&&!k&&!N)for(var I=n-1;I>=Ov;I--){var U=l.get(t,I);if(U){R=U;break}}if(S(R))return a.queueElement(t,n),R;y.context.translate(y.usedWidth,0),y.context.scale(u,u),this.drawElement(y.context,t,e,h,!1),y.context.scale(1/u,1/u),y.context.translate(-y.usedWidth,0)}return m={x:y.usedWidth,texture:y,level:n,scale:u,width:d,height:c,scaledLabelShown:h},y.usedWidth+=Math.ceil(d+_q),y.eleCaches.push(m),l.set(t,n,m),a.checkTextureFullness(y),m};en.invalidateElements=function(t){for(var e=0;e<t.length;e++)this.invalidateElement(t[e])};en.invalidateElement=function(t){var e=this,r=e.lookup,n=[],i=r.isInvalid(t);if(i){for(var a=Ov;a<=Q5;a++){var s=r.getForCachedKey(t,a);s&&n.push(s)}var o=r.invalidate(t);if(o)for(var l=0;l<n.length;l++){var u=n[l],c=u.texture;c.invalidatedWidth+=u.width,u.invalidated=!0,e.checkTextureUtility(c)}e.removeFromQueue(t)}};en.checkTextureUtility=function(t){t.invalidatedWidth>=Oq*t.width&&this.retireTexture(t)};en.checkTextureFullness=function(t){var e=this,r=e.getTextureQueue(t.height);t.usedWidth/t.width>Iq&&t.fullnessChecks>=Lq?gl(r,t):t.fullnessChecks++};en.retireTexture=function(t){var e=this,r=t.height,n=e.getTextureQueue(r),i=this.lookup;gl(n,t),t.retired=!0;for(var a=t.eleCaches,s=0;s<a.length;s++){var o=a[s];i.deleteCache(o.key,o.level)}ZC(a);var l=e.getRetiredTextureQueue(r);l.push(t)};en.addTexture=function(t,e){var r=this,n=r.getTextureQueue(t),i={};return n.push(i),i.eleCaches=[],i.height=t,i.width=Math.max(Aq,e),i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,i.canvas=r.renderer.makeOffscreenCanvas(i.width,i.height),i.context=i.canvas.getContext("2d"),i};en.recycleTexture=function(t,e){for(var r=this,n=r.getTextureQueue(t),i=r.getRetiredTextureQueue(t),a=0;a<i.length;a++){var s=i[a];if(s.width>=e)return s.retired=!1,s.usedWidth=0,s.invalidatedWidth=0,s.fullnessChecks=0,ZC(s.eleCaches),s.context.setTransform(1,0,0,1,0,0),s.context.clearRect(0,0,s.width,s.height),gl(i,s),n.push(s),s}};en.queueElement=function(t,e){var r=this,n=r.getElementQueue(),i=r.getElementKeyToQueue(),a=this.getKey(t),s=i[a];if(s)s.level=Math.max(s.level,e),s.eles.merge(t),s.reqs++,n.updateItem(s);else{var o={eles:t.spawn().merge(t),level:e,reqs:1,key:a};n.push(o),i[a]=o}};en.dequeue=function(t){for(var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),i=[],a=e.lookup,s=0;s<Uq&&r.size()>0;s++){var o=r.pop(),l=o.key,u=o.eles[0],c=a.hasCache(u,o.level);if(n[l]=null,c)continue;i.push(o);var d=e.getBoundingBox(u);e.getElement(u,d,t,o.level,ud.dequeue)}return i};en.removeFromQueue=function(t){var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),i=this.getKey(t),a=n[i];a!=null&&(a.eles.length===1?(a.reqs=QC,r.updateItem(a),r.pop(),n[i]=null):a.eles.unmerge(t))};en.onDequeue=function(t){this.onDequeues.push(t)};en.offDequeue=function(t){gl(this.onDequeues,t)};en.setupDequeueing=t7.setupDequeueing({deqRedrawThreshold:$q,deqCost:Bq,deqAvgCost:Fq,deqNoDrawCost:zq,deqFastCost:Vq,deq:function(e,r,n){return e.dequeue(r,n)},onDeqd:function(e,r){for(var n=0;n<e.onDequeues.length;n++){var i=e.onDequeues[n];i(r)}},shouldRedraw:function(e,r,n,i){for(var a=0;a<r.length;a++)for(var s=r[a].eles,o=0;o<s.length;o++){var l=s[o].boundingBox();if(r3(l,i))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var Hq=1,Lh=-4,_0=2,Wq=3.99,qq=50,Kq=50,Yq=.15,Xq=.1,Qq=.9,Jq=.9,Zq=1,$8=250,eK=4e3*4e3,U8=32767,tK=!0,n7=function(e){var r=this,n=r.renderer=e,i=n.cy;r.layersByLevel={},r.firstGet=!0,r.lastInvalidationTime=eo()-2*$8,r.skipping=!1,r.eleTxrDeqs=i.collection(),r.scheduleElementRefinement=rm(function(){r.refineElementTextures(r.eleTxrDeqs),r.eleTxrDeqs.unmerge(r.eleTxrDeqs)},Kq),n.beforeRender(function(s,o){o-r.lastInvalidationTime<=$8?r.skipping=!0:r.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip);var a=function(o,l){return l.reqs-o.reqs};r.layersQueue=new nm(a),r.setupDequeueing()},_n=n7.prototype,G8=0,rK=Math.pow(2,53)-1;_n.makeLayer=function(t,e){var r=Math.pow(2,e),n=Math.ceil(t.w*r),i=Math.ceil(t.h*r),a=this.renderer.makeOffscreenCanvas(n,i),s={id:G8=++G8%rK,bb:t,level:e,width:n,height:i,canvas:a,context:a.getContext("2d"),eles:[],elesQueue:[],reqs:0},o=s.context,l=-s.bb.x1,u=-s.bb.y1;return o.scale(r,r),o.translate(l,u),s};_n.getLayers=function(t,e,r){var n=this,i=n.renderer,a=i.cy,s=a.zoom(),o=n.firstGet;if(n.firstGet=!1,r==null){if(r=Math.ceil(e3(s*e)),r<Lh)r=Lh;else if(s>=Wq||r>_0)return null}n.validateLayersElesOrdering(r,t);var l=n.layersByLevel,u=Math.pow(2,r),c=l[r]=l[r]||[],d,h=n.levelIsComplete(r,t),m,v=function(){var P=function(B){if(n.validateLayersElesOrdering(B,t),n.levelIsComplete(B,t))return m=l[B],!0},D=function(B){if(!m)for(var z=r+B;Lh<=z&&z<=_0&&!P(z);z+=B);};D(1),D(-1);for(var R=c.length-1;R>=0;R--){var I=c[R];I.invalid&&gl(c,I)}};if(!h)v();else return c;var x=function(){if(!d){d=ei();for(var P=0;P<t.length;P++)ZU(d,t[P].boundingBox())}return d},y=function(P){P=P||{};var D=P.after;x();var R=Math.ceil(d.w*u),I=Math.ceil(d.h*u);if(R>U8||I>U8)return null;var U=R*I;if(U>eK)return null;var B=n.makeLayer(d,r);if(D!=null){var z=c.indexOf(D)+1;c.splice(z,0,B)}else(P.insert===void 0||P.insert)&&c.unshift(B);return B};if(n.skipping&&!o)return null;for(var b=null,S=t.length/Hq,w=!o,k=0;k<t.length;k++){var N=t[k],T=N._private.rscratch,j=T.imgLayerCaches=T.imgLayerCaches||{},M=j[r];if(M){b=M;continue}if((!b||b.eles.length>=S||!QA(b.bb,N.boundingBox()))&&(b=y({insert:!0,after:b}),!b))return null;m||w?n.queueLayer(b,N):n.drawEleInLayer(b,N,r,e),b.eles.push(N),j[r]=b}return m||(w?null:c)};_n.getEleLevelForLayerLevel=function(t,e){return t};_n.drawEleInLayer=function(t,e,r,n){var i=this,a=this.renderer,s=t.context,o=e.boundingBox();o.w===0||o.h===0||!e.visible()||(r=i.getEleLevelForLayerLevel(r,n),a.setImgSmoothing(s,!1),a.drawCachedElement(s,e,null,null,r,tK),a.setImgSmoothing(s,!0))};_n.levelIsComplete=function(t,e){var r=this,n=r.layersByLevel[t];if(!n||n.length===0)return!1;for(var i=0,a=0;a<n.length;a++){var s=n[a];if(s.reqs>0||s.invalid)return!1;i+=s.eles.length}return i===e.length};_n.validateLayersElesOrdering=function(t,e){var r=this.layersByLevel[t];if(r)for(var n=0;n<r.length;n++){for(var i=r[n],a=-1,s=0;s<e.length;s++)if(i.eles[0]===e[s]){a=s;break}if(a<0){this.invalidateLayer(i);continue}for(var o=a,s=0;s<i.eles.length;s++)if(i.eles[s]!==e[o+s]){this.invalidateLayer(i);break}}};_n.updateElementsInLayers=function(t,e){for(var r=this,n=Jp(t[0]),i=0;i<t.length;i++)for(var a=n?null:t[i],s=n?t[i]:t[i].ele,o=s._private.rscratch,l=o.imgLayerCaches=o.imgLayerCaches||{},u=Lh;u<=_0;u++){var c=l[u];c&&(a&&r.getEleLevelForLayerLevel(c.level)!==a.level||e(c,s,a))}};_n.haveLayers=function(){for(var t=this,e=!1,r=Lh;r<=_0;r++){var n=t.layersByLevel[r];if(n&&n.length>0){e=!0;break}}return e};_n.invalidateElements=function(t){var e=this;t.length!==0&&(e.lastInvalidationTime=eo(),!(t.length===0||!e.haveLayers())&&e.updateElementsInLayers(t,function(n,i,a){e.invalidateLayer(n)}))};_n.invalidateLayer=function(t){if(this.lastInvalidationTime=eo(),!t.invalid){var e=t.level,r=t.eles,n=this.layersByLevel[e];gl(n,t),t.elesQueue=[],t.invalid=!0,t.replacement&&(t.replacement.invalid=!0);for(var i=0;i<r.length;i++){var a=r[i]._private.rscratch.imgLayerCaches;a&&(a[e]=null)}}};_n.refineElementTextures=function(t){var e=this;e.updateElementsInLayers(t,function(n,i,a){var s=n.replacement;if(s||(s=n.replacement=e.makeLayer(n.bb,n.level),s.replaces=n,s.eles=n.eles),!s.reqs)for(var o=0;o<s.eles.length;o++)e.queueLayer(s,s.eles[o])})};_n.enqueueElementRefinement=function(t){this.eleTxrDeqs.merge(t),this.scheduleElementRefinement()};_n.queueLayer=function(t,e){var r=this,n=r.layersQueue,i=t.elesQueue,a=i.hasId=i.hasId||{};if(!t.replacement){if(e){if(a[e.id()])return;i.push(e),a[e.id()]=!0}t.reqs?(t.reqs++,n.updateItem(t)):(t.reqs=1,n.push(t))}};_n.dequeue=function(t){for(var e=this,r=e.layersQueue,n=[],i=0;i<Zq&&r.size()!==0;){var a=r.peek();if(a.replacement){r.pop();continue}if(a.replaces&&a!==a.replaces.replacement){r.pop();continue}if(a.invalid){r.pop();continue}var s=a.elesQueue.shift();s&&(e.drawEleInLayer(a,s,a.level,t),i++),n.length===0&&n.push(!0),a.elesQueue.length===0&&(r.pop(),a.reqs=0,a.replaces&&e.applyLayerReplacement(a),e.requestRedraw())}return n};_n.applyLayerReplacement=function(t){var e=this,r=e.layersByLevel[t.level],n=t.replaces,i=r.indexOf(n);if(!(i<0||n.invalid)){r[i]=t;for(var a=0;a<t.eles.length;a++){var s=t.eles[a]._private,o=s.imgLayerCaches=s.imgLayerCaches||{};o&&(o[t.level]=t)}e.requestRedraw()}};_n.requestRedraw=rm(function(){var t=this.renderer;t.redrawHint("eles",!0),t.redrawHint("drag",!0),t.redraw()},100);_n.setupDequeueing=t7.setupDequeueing({deqRedrawThreshold:qq,deqCost:Yq,deqAvgCost:Xq,deqNoDrawCost:Qq,deqFastCost:Jq,deq:function(e,r){return e.dequeue(r)},onDeqd:JC,shouldRedraw:HA,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var i7={},H8;function nK(t,e){for(var r=0;r<e.length;r++){var n=e[r];t.lineTo(n.x,n.y)}}function iK(t,e,r){for(var n,i=0;i<e.length;i++){var a=e[i];i===0&&(n=a),t.lineTo(a.x,a.y)}t.quadraticCurveTo(r.x,r.y,n.x,n.y)}function W8(t,e,r){t.beginPath&&t.beginPath();for(var n=e,i=0;i<n.length;i++){var a=n[i];t.lineTo(a.x,a.y)}var s=r,o=r[0];t.moveTo(o.x,o.y);for(var i=1;i<s.length;i++){var a=s[i];t.lineTo(a.x,a.y)}t.closePath&&t.closePath()}function aK(t,e,r,n,i){t.beginPath&&t.beginPath(),t.arc(r,n,i,0,Math.PI*2,!1);var a=e,s=a[0];t.moveTo(s.x,s.y);for(var o=0;o<a.length;o++){var l=a[o];t.lineTo(l.x,l.y)}t.closePath&&t.closePath()}function sK(t,e,r,n){t.arc(e,r,n,0,Math.PI*2,!1)}i7.arrowShapeImpl=function(t){return(H8||(H8={polygon:nK,"triangle-backcurve":iK,"triangle-tee":W8,"circle-triangle":aK,"triangle-cross":W8,circle:sK}))[t]};var gs={};gs.drawElement=function(t,e,r,n,i,a){var s=this;e.isNode()?s.drawNode(t,e,r,n,i,a):s.drawEdge(t,e,r,n,i,a)};gs.drawElementOverlay=function(t,e){var r=this;e.isNode()?r.drawNodeOverlay(t,e):r.drawEdgeOverlay(t,e)};gs.drawElementUnderlay=function(t,e){var r=this;e.isNode()?r.drawNodeUnderlay(t,e):r.drawEdgeUnderlay(t,e)};gs.drawCachedElementPortion=function(t,e,r,n,i,a,s,o){var l=this,u=r.getBoundingBox(e);if(!(u.w===0||u.h===0)){var c=r.getElement(e,u,n,i,a);if(c!=null){var d=o(l,e);if(d===0)return;var h=s(l,e),m=u.x1,v=u.y1,x=u.w,y=u.h,b,S,w,k,N;if(h!==0){var T=r.getRotationPoint(e);w=T.x,k=T.y,t.translate(w,k),t.rotate(h),N=l.getImgSmoothing(t),N||l.setImgSmoothing(t,!0);var j=r.getRotationOffset(e);b=j.x,S=j.y}else b=m,S=v;var M;d!==1&&(M=t.globalAlpha,t.globalAlpha=M*d),t.drawImage(c.texture.canvas,c.x,0,c.width,c.height,b,S,x,y),d!==1&&(t.globalAlpha=M),h!==0&&(t.rotate(-h),t.translate(-w,-k),N||l.setImgSmoothing(t,!1))}else r.drawElement(t,e)}};var oK=function(){return 0},lK=function(e,r){return e.getTextAngle(r,null)},uK=function(e,r){return e.getTextAngle(r,"source")},cK=function(e,r){return e.getTextAngle(r,"target")},dK=function(e,r){return r.effectiveOpacity()},O2=function(e,r){return r.pstyle("text-opacity").pfValue*r.effectiveOpacity()};gs.drawCachedElement=function(t,e,r,n,i,a){var s=this,o=s.data,l=o.eleTxrCache,u=o.lblTxrCache,c=o.slbTxrCache,d=o.tlbTxrCache,h=e.boundingBox(),m=a===!0?l.reasons.highQuality:null;if(!(h.w===0||h.h===0||!e.visible())&&(!n||r3(h,n))){var v=e.isEdge(),x=e.element()._private.rscratch.badLine;s.drawElementUnderlay(t,e),s.drawCachedElementPortion(t,e,l,r,i,m,oK,dK),(!v||!x)&&s.drawCachedElementPortion(t,e,u,r,i,m,lK,O2),v&&!x&&(s.drawCachedElementPortion(t,e,c,r,i,m,uK,O2),s.drawCachedElementPortion(t,e,d,r,i,m,cK,O2)),s.drawElementOverlay(t,e)}};gs.drawElements=function(t,e){for(var r=this,n=0;n<e.length;n++){var i=e[n];r.drawElement(t,i)}};gs.drawCachedElements=function(t,e,r,n){for(var i=this,a=0;a<e.length;a++){var s=e[a];i.drawCachedElement(t,s,r,n)}};gs.drawCachedNodes=function(t,e,r,n){for(var i=this,a=0;a<e.length;a++){var s=e[a];s.isNode()&&i.drawCachedElement(t,s,r,n)}};gs.drawLayeredElements=function(t,e,r,n){var i=this,a=i.data.lyrTxrCache.getLayers(e,r);if(a)for(var s=0;s<a.length;s++){var o=a[s],l=o.bb;l.w===0||l.h===0||t.drawImage(o.canvas,l.x1,l.y1,l.w,l.h)}else i.drawCachedElements(t,e,r,n)};var so={};so.drawEdge=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,o=e._private.rscratch;if(!(a&&!e.visible())&&!(o.badLine||o.allpts==null||isNaN(o.allpts[0]))){var l;r&&(l=r,t.translate(-l.x1,-l.y1));var u=a?e.pstyle("opacity").value:1,c=a?e.pstyle("line-opacity").value:1,d=e.pstyle("curve-style").value,h=e.pstyle("line-style").value,m=e.pstyle("width").pfValue,v=e.pstyle("line-cap").value,x=e.pstyle("line-outline-width").value,y=e.pstyle("line-outline-color").value,b=u*c,S=u*c,w=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b;d==="straight-triangle"?(s.eleStrokeStyle(t,e,B),s.drawEdgeTrianglePath(e,t,o.allpts)):(t.lineWidth=m,t.lineCap=v,s.eleStrokeStyle(t,e,B),s.drawEdgePath(e,t,o.allpts,h),t.lineCap="butt")},k=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b;if(t.lineWidth=m+x,t.lineCap=v,x>0)s.colorStrokeStyle(t,y[0],y[1],y[2],B);else{t.lineCap="butt";return}d==="straight-triangle"?s.drawEdgeTrianglePath(e,t,o.allpts):(s.drawEdgePath(e,t,o.allpts,h),t.lineCap="butt")},N=function(){i&&s.drawEdgeOverlay(t,e)},T=function(){i&&s.drawEdgeUnderlay(t,e)},j=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:S;s.drawArrowheads(t,e,B)},M=function(){s.drawElementText(t,e,null,n)};t.lineJoin="round";var A=e.pstyle("ghost").value==="yes";if(A){var P=e.pstyle("ghost-offset-x").pfValue,D=e.pstyle("ghost-offset-y").pfValue,R=e.pstyle("ghost-opacity").value,I=b*R;t.translate(P,D),w(I),j(I),t.translate(-P,-D)}else k();T(),w(),j(),N(),M(),r&&t.translate(l.x1,l.y1)}};var a7=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(r,n){if(n.visible()){var i=n.pstyle("".concat(e,"-opacity")).value;if(i!==0){var a=this,s=a.usePaths(),o=n._private.rscratch,l=n.pstyle("".concat(e,"-padding")).pfValue,u=2*l,c=n.pstyle("".concat(e,"-color")).value;r.lineWidth=u,o.edgeType==="self"&&!s?r.lineCap="butt":r.lineCap="round",a.colorStrokeStyle(r,c[0],c[1],c[2],i),a.drawEdgePath(n,r,o.allpts,"solid")}}}};so.drawEdgeOverlay=a7("overlay");so.drawEdgeUnderlay=a7("underlay");so.drawEdgePath=function(t,e,r,n){var i=t._private.rscratch,a=e,s,o=!1,l=this.usePaths(),u=t.pstyle("line-dash-pattern").pfValue,c=t.pstyle("line-dash-offset").pfValue;if(l){var d=r.join("$"),h=i.pathCacheKey&&i.pathCacheKey===d;h?(s=e=i.pathCache,o=!0):(s=e=new Path2D,i.pathCacheKey=d,i.pathCache=s)}if(a.setLineDash)switch(n){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash(u),a.lineDashOffset=c;break;case"solid":a.setLineDash([]);break}if(!o&&!i.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(r[0],r[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var m=2;m+3<r.length;m+=4)e.quadraticCurveTo(r[m],r[m+1],r[m+2],r[m+3]);break;case"straight":case"haystack":for(var v=2;v+1<r.length;v+=2)e.lineTo(r[v],r[v+1]);break;case"segments":if(i.isRound){var x=vi(i.roundCorners),y;try{for(x.s();!(y=x.n()).done;){var b=y.value;qR(e,b)}}catch(w){x.e(w)}finally{x.f()}e.lineTo(r[r.length-2],r[r.length-1])}else for(var S=2;S+1<r.length;S+=2)e.lineTo(r[S],r[S+1]);break}e=a,l?e.stroke(s):e.stroke(),e.setLineDash&&e.setLineDash([])};so.drawEdgeTrianglePath=function(t,e,r){e.fillStyle=e.strokeStyle;for(var n=t.pstyle("width").pfValue,i=0;i+1<r.length;i+=2){var a=[r[i+2]-r[i],r[i+3]-r[i+1]],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]),o=[a[1]/s,-a[0]/s],l=[o[0]*n/2,o[1]*n/2];e.beginPath(),e.moveTo(r[i]-l[0],r[i+1]-l[1]),e.lineTo(r[i]+l[0],r[i+1]+l[1]),e.lineTo(r[i+2],r[i+3]),e.closePath(),e.fill()}};so.drawArrowheads=function(t,e,r){var n=e._private.rscratch,i=n.edgeType==="haystack";i||this.drawArrowhead(t,e,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,r),this.drawArrowhead(t,e,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,r),this.drawArrowhead(t,e,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,r),i||this.drawArrowhead(t,e,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,r)};so.drawArrowhead=function(t,e,r,n,i,a,s){if(!(isNaN(n)||n==null||isNaN(i)||i==null||isNaN(a)||a==null)){var o=this,l=e.pstyle(r+"-arrow-shape").value;if(l!=="none"){var u=e.pstyle(r+"-arrow-fill").value==="hollow"?"both":"filled",c=e.pstyle(r+"-arrow-fill").value,d=e.pstyle("width").pfValue,h=e.pstyle(r+"-arrow-width"),m=h.value==="match-line"?d:h.pfValue;h.units==="%"&&(m*=d);var v=e.pstyle("opacity").value;s===void 0&&(s=v);var x=t.globalCompositeOperation;(s!==1||c==="hollow")&&(t.globalCompositeOperation="destination-out",o.colorFillStyle(t,255,255,255,1),o.colorStrokeStyle(t,255,255,255,1),o.drawArrowShape(e,t,u,d,l,m,n,i,a),t.globalCompositeOperation=x);var y=e.pstyle(r+"-arrow-color").value;o.colorFillStyle(t,y[0],y[1],y[2],s),o.colorStrokeStyle(t,y[0],y[1],y[2],s),o.drawArrowShape(e,t,c,d,l,m,n,i,a)}}};so.drawArrowShape=function(t,e,r,n,i,a,s,o,l){var u=this,c=this.usePaths()&&i!=="triangle-cross",d=!1,h,m=e,v={x:s,y:o},x=t.pstyle("arrow-scale").value,y=this.getArrowWidth(n,x),b=u.arrowShapes[i];if(c){var S=u.arrowPathCache=u.arrowPathCache||[],w=Bu(i),k=S[w];k!=null?(h=e=k,d=!0):(h=e=new Path2D,S[w]=h)}d||(e.beginPath&&e.beginPath(),c?b.draw(e,1,0,{x:0,y:0},1):b.draw(e,y,l,v,n),e.closePath&&e.closePath()),e=m,c&&(e.translate(s,o),e.rotate(l),e.scale(y,y)),(r==="filled"||r==="both")&&(c?e.fill(h):e.fill()),(r==="hollow"||r==="both")&&(e.lineWidth=a/(c?y:1),e.lineJoin="miter",c?e.stroke(h):e.stroke()),c&&(e.scale(1/y,1/y),e.rotate(-l),e.translate(-s,-o))};var g3={};g3.safeDrawImage=function(t,e,r,n,i,a,s,o,l,u){if(!(i<=0||a<=0||l<=0||u<=0))try{t.drawImage(e,r,n,i,a,s,o,l,u)}catch(c){Lt(c)}};g3.drawInscribedImage=function(t,e,r,n,i){var a=this,s=r.position(),o=s.x,l=s.y,u=r.cy().style(),c=u.getIndexedStyle.bind(u),d=c(r,"background-fit","value",n),h=c(r,"background-repeat","value",n),m=r.width(),v=r.height(),x=r.padding()*2,y=m+(c(r,"background-width-relative-to","value",n)==="inner"?0:x),b=v+(c(r,"background-height-relative-to","value",n)==="inner"?0:x),S=r._private.rscratch,w=c(r,"background-clip","value",n),k=w==="node",N=c(r,"background-image-opacity","value",n)*i,T=c(r,"background-image-smoothing","value",n),j=r.pstyle("corner-radius").value;j!=="auto"&&(j=r.pstyle("corner-radius").pfValue);var M=e.width||e.cachedW,A=e.height||e.cachedH;(M==null||A==null)&&(document.body.appendChild(e),M=e.cachedW=e.width||e.offsetWidth,A=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var P=M,D=A;if(c(r,"background-width","value",n)!=="auto"&&(c(r,"background-width","units",n)==="%"?P=c(r,"background-width","pfValue",n)*y:P=c(r,"background-width","pfValue",n)),c(r,"background-height","value",n)!=="auto"&&(c(r,"background-height","units",n)==="%"?D=c(r,"background-height","pfValue",n)*b:D=c(r,"background-height","pfValue",n)),!(P===0||D===0)){if(d==="contain"){var R=Math.min(y/P,b/D);P*=R,D*=R}else if(d==="cover"){var R=Math.max(y/P,b/D);P*=R,D*=R}var I=o-y/2,U=c(r,"background-position-x","units",n),B=c(r,"background-position-x","pfValue",n);U==="%"?I+=(y-P)*B:I+=B;var z=c(r,"background-offset-x","units",n),F=c(r,"background-offset-x","pfValue",n);z==="%"?I+=(y-P)*F:I+=F;var V=l-b/2,J=c(r,"background-position-y","units",n),Y=c(r,"background-position-y","pfValue",n);J==="%"?V+=(b-D)*Y:V+=Y;var L=c(r,"background-offset-y","units",n),G=c(r,"background-offset-y","pfValue",n);L==="%"?V+=(b-D)*G:V+=G,S.pathCache&&(I-=o,V-=l,o=0,l=0);var ee=t.globalAlpha;t.globalAlpha=N;var re=a.getImgSmoothing(t),se=!1;if(T==="no"&&re?(a.setImgSmoothing(t,!1),se=!0):T==="yes"&&!re&&(a.setImgSmoothing(t,!0),se=!0),h==="no-repeat")k&&(t.save(),S.pathCache?t.clip(S.pathCache):(a.nodeShapes[a.getNodeShape(r)].draw(t,o,l,y,b,j,S),t.clip())),a.safeDrawImage(t,e,0,0,M,A,I,V,P,D),k&&t.restore();else{var de=t.createPattern(e,h);t.fillStyle=de,a.nodeShapes[a.getNodeShape(r)].draw(t,o,l,y,b,j,S),t.translate(I,V),t.fill(),t.translate(-I,-V)}t.globalAlpha=ee,se&&a.setImgSmoothing(t,re)}};var ec={};ec.eleTextBiggerThanMin=function(t,e){if(!e){var r=t.cy().zoom(),n=this.getPixelRatio(),i=Math.ceil(e3(r*n));e=Math.pow(2,i)}var a=t.pstyle("font-size").pfValue*e,s=t.pstyle("min-zoomed-font-size").pfValue;return!(a<s)};ec.drawElementText=function(t,e,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this;if(n==null){if(a&&!s.eleTextBiggerThanMin(e))return}else if(n===!1)return;if(e.isNode()){var o=e.pstyle("label");if(!o||!o.value)return;var l=s.getLabelJustification(e);t.textAlign=l,t.textBaseline="bottom"}else{var u=e.element()._private.rscratch.badLine,c=e.pstyle("label"),d=e.pstyle("source-label"),h=e.pstyle("target-label");if(u||(!c||!c.value)&&(!d||!d.value)&&(!h||!h.value))return;t.textAlign="center",t.textBaseline="bottom"}var m=!r,v;r&&(v=r,t.translate(-v.x1,-v.y1)),i==null?(s.drawText(t,e,null,m,a),e.isEdge()&&(s.drawText(t,e,"source",m,a),s.drawText(t,e,"target",m,a))):s.drawText(t,e,i,m,a),r&&t.translate(v.x1,v.y1)};ec.getFontCache=function(t){var e;this.fontCaches=this.fontCaches||[];for(var r=0;r<this.fontCaches.length;r++)if(e=this.fontCaches[r],e.context===t)return e;return e={context:t},this.fontCaches.push(e),e};ec.setupTextStyle=function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=e.pstyle("font-style").strValue,i=e.pstyle("font-size").pfValue+"px",a=e.pstyle("font-family").strValue,s=e.pstyle("font-weight").strValue,o=r?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,l=e.pstyle("text-outline-opacity").value*o,u=e.pstyle("color").value,c=e.pstyle("text-outline-color").value;t.font=n+" "+s+" "+i+" "+a,t.lineJoin="round",this.colorFillStyle(t,u[0],u[1],u[2],o),this.colorStrokeStyle(t,c[0],c[1],c[2],l)};function fK(t,e,r,n,i){var a=Math.min(n,i),s=a/2,o=e+n/2,l=r+i/2;t.beginPath(),t.arc(o,l,s,0,Math.PI*2),t.closePath()}function q8(t,e,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,s=Math.min(a,n/2,i/2);t.beginPath(),t.moveTo(e+s,r),t.lineTo(e+n-s,r),t.quadraticCurveTo(e+n,r,e+n,r+s),t.lineTo(e+n,r+i-s),t.quadraticCurveTo(e+n,r+i,e+n-s,r+i),t.lineTo(e+s,r+i),t.quadraticCurveTo(e,r+i,e,r+i-s),t.lineTo(e,r+s),t.quadraticCurveTo(e,r,e+s,r),t.closePath()}ec.getTextAngle=function(t,e){var r,n=t._private,i=n.rscratch,a=e?e+"-":"",s=t.pstyle(a+"text-rotation");if(s.strValue==="autorotate"){var o=hi(i,"labelAngle",e);r=t.isEdge()?o:0}else s.strValue==="none"?r=0:r=s.pfValue;return r};ec.drawText=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=e._private,s=a.rscratch,o=i?e.effectiveOpacity():1;if(!(i&&(o===0||e.pstyle("text-opacity").value===0))){r==="main"&&(r=null);var l=hi(s,"labelX",r),u=hi(s,"labelY",r),c,d,h=this.getLabelText(e,r);if(h!=null&&h!==""&&!isNaN(l)&&!isNaN(u)){this.setupTextStyle(t,e,i);var m=r?r+"-":"",v=hi(s,"labelWidth",r),x=hi(s,"labelHeight",r),y=e.pstyle(m+"text-margin-x").pfValue,b=e.pstyle(m+"text-margin-y").pfValue,S=e.isEdge(),w=e.pstyle("text-halign").value,k=e.pstyle("text-valign").value;S&&(w="center",k="center"),l+=y,u+=b;var N;switch(n?N=this.getTextAngle(e,r):N=0,N!==0&&(c=l,d=u,t.translate(c,d),t.rotate(N),l=0,u=0),k){case"top":break;case"center":u+=x/2;break;case"bottom":u+=x;break}var T=e.pstyle("text-background-opacity").value,j=e.pstyle("text-border-opacity").value,M=e.pstyle("text-border-width").pfValue,A=e.pstyle("text-background-padding").pfValue,P=e.pstyle("text-background-shape").strValue,D=P==="round-rectangle"||P==="roundrectangle",R=P==="circle",I=2;if(T>0||M>0&&j>0){var U=t.fillStyle,B=t.strokeStyle,z=t.lineWidth,F=e.pstyle("text-background-color").value,V=e.pstyle("text-border-color").value,J=e.pstyle("text-border-style").value,Y=T>0,L=M>0&&j>0,G=l-A;switch(w){case"left":G-=v;break;case"center":G-=v/2;break}var ee=u-x-A,re=v+2*A,se=x+2*A;if(Y&&(t.fillStyle="rgba(".concat(F[0],",").concat(F[1],",").concat(F[2],",").concat(T*o,")")),L&&(t.strokeStyle="rgba(".concat(V[0],",").concat(V[1],",").concat(V[2],",").concat(j*o,")"),t.lineWidth=M,t.setLineDash))switch(J){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"double":t.lineWidth=M/4,t.setLineDash([]);break;case"solid":default:t.setLineDash([]);break}if(D?(t.beginPath(),q8(t,G,ee,re,se,I)):R?(t.beginPath(),fK(t,G,ee,re,se)):(t.beginPath(),t.rect(G,ee,re,se)),Y&&t.fill(),L&&t.stroke(),L&&J==="double"){var de=M/2;t.beginPath(),D?q8(t,G+de,ee+de,re-2*de,se-2*de,I):t.rect(G+de,ee+de,re-2*de,se-2*de),t.stroke()}t.fillStyle=U,t.strokeStyle=B,t.lineWidth=z,t.setLineDash&&t.setLineDash([])}var W=2*e.pstyle("text-outline-width").pfValue;if(W>0&&(t.lineWidth=W),e.pstyle("text-wrap").value==="wrap"){var ne=hi(s,"labelWrapCachedLines",r),ie=hi(s,"labelLineHeight",r),$=v/2,q=this.getLabelJustification(e);switch(q==="auto"||(w==="left"?q==="left"?l+=-v:q==="center"&&(l+=-$):w==="center"?q==="left"?l+=-$:q==="right"&&(l+=$):w==="right"&&(q==="center"?l+=$:q==="right"&&(l+=v))),k){case"top":u-=(ne.length-1)*ie;break;case"center":case"bottom":u-=(ne.length-1)*ie;break}for(var te=0;te<ne.length;te++)W>0&&t.strokeText(ne[te],l,u),t.fillText(ne[te],l,u),u+=ie}else W>0&&t.strokeText(h,l,u),t.fillText(h,l,u);N!==0&&(t.rotate(-N),t.translate(-c,-d))}}};var Al={};Al.drawNode=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,o,l,u=e._private,c=u.rscratch,d=e.position();if(!(!Ee(d.x)||!Ee(d.y))&&!(a&&!e.visible())){var h=a?e.effectiveOpacity():1,m=s.usePaths(),v,x=!1,y=e.padding();o=e.width()+2*y,l=e.height()+2*y;var b;r&&(b=r,t.translate(-b.x1,-b.y1));for(var S=e.pstyle("background-image"),w=S.value,k=new Array(w.length),N=new Array(w.length),T=0,j=0;j<w.length;j++){var M=w[j],A=k[j]=M!=null&&M!=="none";if(A){var P=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",j);T++,N[j]=s.getCachedImage(M,P,function(){u.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var D=e.pstyle("background-blacken").value,R=e.pstyle("border-width").pfValue,I=e.pstyle("background-opacity").value*h,U=e.pstyle("border-color").value,B=e.pstyle("border-style").value,z=e.pstyle("border-join").value,F=e.pstyle("border-cap").value,V=e.pstyle("border-position").value,J=e.pstyle("border-dash-pattern").pfValue,Y=e.pstyle("border-dash-offset").pfValue,L=e.pstyle("border-opacity").value*h,G=e.pstyle("outline-width").pfValue,ee=e.pstyle("outline-color").value,re=e.pstyle("outline-style").value,se=e.pstyle("outline-opacity").value*h,de=e.pstyle("outline-offset").value,W=e.pstyle("corner-radius").value;W!=="auto"&&(W=e.pstyle("corner-radius").pfValue);var ne=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I;s.eleFillStyle(t,e,Oe)},ie=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:L;s.colorStrokeStyle(t,U[0],U[1],U[2],Oe)},$=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:se;s.colorStrokeStyle(t,ee[0],ee[1],ee[2],Oe)},q=function(Oe,ve,H,Q){var ae=s.nodePathCache=s.nodePathCache||[],ue=GA(H==="polygon"?H+","+Q.join(","):H,""+ve,""+Oe,""+W),fe=ae[ue],xe,ye=!1;return fe!=null?(xe=fe,ye=!0,c.pathCache=xe):(xe=new Path2D,ae[ue]=c.pathCache=xe),{path:xe,cacheHit:ye}},te=e.pstyle("shape").strValue,Z=e.pstyle("shape-polygon-points").pfValue;if(m){t.translate(d.x,d.y);var le=q(o,l,te,Z);v=le.path,x=le.cacheHit}var ge=function(){if(!x){var Oe=d;m&&(Oe={x:0,y:0}),s.nodeShapes[s.getNodeShape(e)].draw(v||t,Oe.x,Oe.y,o,l,W,c)}m?t.fill(v):t.fill()},Ue=function(){for(var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h,ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,H=u.backgrounding,Q=0,ae=0;ae<N.length;ae++){var ue=e.cy().style().getIndexedStyle(e,"background-image-containment","value",ae);if(ve&&ue==="over"||!ve&&ue==="inside"){Q++;continue}k[ae]&&N[ae].complete&&!N[ae].error&&(Q++,s.drawInscribedImage(t,N[ae],e,ae,Oe))}u.backgrounding=Q!==T,H!==u.backgrounding&&e.updateStyle(!1)},Te=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;s.hasPie(e)&&(s.drawPie(t,e,ve),Oe&&(m||s.nodeShapes[s.getNodeShape(e)].draw(t,d.x,d.y,o,l,W,c)))},Re=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;s.hasStripe(e)&&(t.save(),m?t.clip(c.pathCache):(s.nodeShapes[s.getNodeShape(e)].draw(t,d.x,d.y,o,l,W,c),t.clip()),s.drawStripe(t,e,ve),t.restore(),Oe&&(m||s.nodeShapes[s.getNodeShape(e)].draw(t,d.x,d.y,o,l,W,c)))},Ge=function(){var Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h,ve=(D>0?D:-D)*Oe,H=D>0?0:255;D!==0&&(s.colorFillStyle(t,H,H,H,ve),m?t.fill(v):t.fill())},Ce=function(){if(R>0){if(t.lineWidth=R,t.lineCap=F,t.lineJoin=z,t.setLineDash)switch(B){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash(J),t.lineDashOffset=Y;break;case"solid":case"double":t.setLineDash([]);break}if(V!=="center"){if(t.save(),t.lineWidth*=2,V==="inside")m?t.clip(v):t.clip();else{var Oe=new Path2D;Oe.rect(-o/2-R,-l/2-R,o+2*R,l+2*R),Oe.addPath(v),t.clip(Oe,"evenodd")}m?t.stroke(v):t.stroke(),t.restore()}else m?t.stroke(v):t.stroke();if(B==="double"){t.lineWidth=R/3;var ve=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",m?t.stroke(v):t.stroke(),t.globalCompositeOperation=ve}t.setLineDash&&t.setLineDash([])}},De=function(){if(G>0){if(t.lineWidth=G,t.lineCap="butt",t.setLineDash)switch(re){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"solid":case"double":t.setLineDash([]);break}var Oe=d;m&&(Oe={x:0,y:0});var ve=s.getNodeShape(e),H=R;V==="inside"&&(H=0),V==="outside"&&(H*=2);var Q=(o+H+(G+de))/o,ae=(l+H+(G+de))/l,ue=o*Q,fe=l*ae,xe=s.nodeShapes[ve].points,ye;if(m){var je=q(ue,fe,ve,xe);ye=je.path}if(ve==="ellipse")s.drawEllipsePath(ye||t,Oe.x,Oe.y,ue,fe);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(ve)){var Me=0,He=0,et=0;ve==="round-diamond"?Me=(H+de+G)*1.4:ve==="round-heptagon"?(Me=(H+de+G)*1.075,et=-(H/2+de+G)/35):ve==="round-hexagon"?Me=(H+de+G)*1.12:ve==="round-pentagon"?(Me=(H+de+G)*1.13,et=-(H/2+de+G)/15):ve==="round-tag"?(Me=(H+de+G)*1.12,He=(H/2+G+de)*.07):ve==="round-triangle"&&(Me=(H+de+G)*(Math.PI/2),et=-(H+de/2+G)/Math.PI),Me!==0&&(Q=(o+Me)/o,ue=o*Q,["round-hexagon","round-tag"].includes(ve)||(ae=(l+Me)/l,fe=l*ae)),W=W==="auto"?eR(ue,fe):W;for(var tt=ue/2,Le=fe/2,nt=W+(H+G+de)/2,st=new Array(xe.length/2),Kt=new Array(xe.length/2),Ot=0;Ot<xe.length/2;Ot++)st[Ot]={x:Oe.x+He+tt*xe[Ot*2],y:Oe.y+et+Le*xe[Ot*2+1]};var yn,br,Ir,wr,Pr=st.length;for(br=st[Pr-1],yn=0;yn<Pr;yn++)Ir=st[yn%Pr],wr=st[(yn+1)%Pr],Kt[yn]=p3(br,Ir,wr,nt),br=Ir,Ir=wr;s.drawRoundPolygonPath(ye||t,Oe.x+He,Oe.y+et,o*Q,l*ae,xe,Kt)}else if(["roundrectangle","round-rectangle"].includes(ve))W=W==="auto"?vl(ue,fe):W,s.drawRoundRectanglePath(ye||t,Oe.x,Oe.y,ue,fe,W+(H+G+de)/2);else if(["cutrectangle","cut-rectangle"].includes(ve))W=W==="auto"?n3():W,s.drawCutRectanglePath(ye||t,Oe.x,Oe.y,ue,fe,null,W+(H+G+de)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(ve))W=W==="auto"?vl(ue,fe):W,s.drawBottomRoundRectanglePath(ye||t,Oe.x,Oe.y,ue,fe,W+(H+G+de)/2);else if(ve==="barrel")s.drawBarrelPath(ye||t,Oe.x,Oe.y,ue,fe);else if(ve.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(ve)){var Fa=(H+G+de)/o;xe=C0(N0(xe,Fa)),s.drawPolygonPath(ye||t,Oe.x,Oe.y,o,l,xe)}else{var Sr=(H+G+de)/o;xe=C0(N0(xe,-Sr)),s.drawPolygonPath(ye||t,Oe.x,Oe.y,o,l,xe)}if(m?t.stroke(ye):t.stroke(),re==="double"){t.lineWidth=H/3;var si=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",m?t.stroke(ye):t.stroke(),t.globalCompositeOperation=si}t.setLineDash&&t.setLineDash([])}},Ve=function(){i&&s.drawNodeOverlay(t,e,d,o,l)},We=function(){i&&s.drawNodeUnderlay(t,e,d,o,l)},Ie=function(){s.drawElementText(t,e,null,n)},rt=e.pstyle("ghost").value==="yes";if(rt){var ut=e.pstyle("ghost-offset-x").pfValue,xt=e.pstyle("ghost-offset-y").pfValue,bt=e.pstyle("ghost-opacity").value,Nt=bt*h;t.translate(ut,xt),$(),De(),ne(bt*I),ge(),Ue(Nt,!0),ie(bt*L),Ce(),Te(D!==0||R!==0),Re(D!==0||R!==0),Ue(Nt,!1),Ge(Nt),t.translate(-ut,-xt)}m&&t.translate(-d.x,-d.y),We(),m&&t.translate(d.x,d.y),$(),De(),ne(),ge(),Ue(h,!0),ie(),Ce(),Te(D!==0||R!==0),Re(D!==0||R!==0),Ue(h,!1),Ge(),m&&t.translate(-d.x,-d.y),Ie(),Ve(),r&&t.translate(b.x1,b.y1)}};var s7=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(r,n,i,a,s){var o=this;if(n.visible()){var l=n.pstyle("".concat(e,"-padding")).pfValue,u=n.pstyle("".concat(e,"-opacity")).value,c=n.pstyle("".concat(e,"-color")).value,d=n.pstyle("".concat(e,"-shape")).value,h=n.pstyle("".concat(e,"-corner-radius")).value;if(u>0){if(i=i||n.position(),a==null||s==null){var m=n.padding();a=n.width()+2*m,s=n.height()+2*m}o.colorFillStyle(r,c[0],c[1],c[2],u),o.nodeShapes[d].draw(r,i.x,i.y,a+l*2,s+l*2,h),r.fill()}}}};Al.drawNodeOverlay=s7("overlay");Al.drawNodeUnderlay=s7("underlay");Al.hasPie=function(t){return t=t[0],t._private.hasPie};Al.hasStripe=function(t){return t=t[0],t._private.hasStripe};Al.drawPie=function(t,e,r,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=e.pstyle("pie-size"),s=e.pstyle("pie-hole"),o=e.pstyle("pie-start-angle").pfValue,l=n.x,u=n.y,c=e.width(),d=e.height(),h=Math.min(c,d)/2,m,v=0,x=this.usePaths();if(x&&(l=0,u=0),a.units==="%"?h=h*a.pfValue:a.pfValue!==void 0&&(h=a.pfValue/2),s.units==="%"?m=h*s.pfValue:s.pfValue!==void 0&&(m=s.pfValue/2),!(m>=h))for(var y=1;y<=i.pieBackgroundN;y++){var b=e.pstyle("pie-"+y+"-background-size").value,S=e.pstyle("pie-"+y+"-background-color").value,w=e.pstyle("pie-"+y+"-background-opacity").value*r,k=b/100;k+v>1&&(k=1-v);var N=1.5*Math.PI+2*Math.PI*v;N+=o;var T=2*Math.PI*k,j=N+T;b===0||v>=1||v+k>1||(m===0?(t.beginPath(),t.moveTo(l,u),t.arc(l,u,h,N,j),t.closePath()):(t.beginPath(),t.arc(l,u,h,N,j),t.arc(l,u,m,j,N,!0),t.closePath()),this.colorFillStyle(t,S[0],S[1],S[2],w),t.fill(),v+=k)}};Al.drawStripe=function(t,e,r,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=n.x,s=n.y,o=e.width(),l=e.height(),u=0,c=this.usePaths();t.save();var d=e.pstyle("stripe-direction").value,h=e.pstyle("stripe-size");switch(d){case"vertical":break;case"righward":t.rotate(-Math.PI/2);break}var m=o,v=l;h.units==="%"?(m=m*h.pfValue,v=v*h.pfValue):h.pfValue!==void 0&&(m=h.pfValue,v=h.pfValue),c&&(a=0,s=0),s-=m/2,a-=v/2;for(var x=1;x<=i.stripeBackgroundN;x++){var y=e.pstyle("stripe-"+x+"-background-size").value,b=e.pstyle("stripe-"+x+"-background-color").value,S=e.pstyle("stripe-"+x+"-background-opacity").value*r,w=y/100;w+u>1&&(w=1-u),!(y===0||u>=1||u+w>1)&&(t.beginPath(),t.rect(a,s+v*u,m,v*w),t.closePath(),this.colorFillStyle(t,b[0],b[1],b[2],S),t.fill(),u+=w)}t.restore()};var ai={},hK=100;ai.getPixelRatio=function(){var t=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),r=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/r};ai.paintCache=function(t){for(var e=this.paintCaches=this.paintCaches||[],r=!0,n,i=0;i<e.length;i++)if(n=e[i],n.context===t){r=!1;break}return r&&(n={context:t},e.push(n)),n};ai.createGradientStyleFor=function(t,e,r,n,i){var a,s=this.usePaths(),o=r.pstyle(e+"-gradient-stop-colors").value,l=r.pstyle(e+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(r.isEdge()){var u=r.sourceEndpoint(),c=r.targetEndpoint(),d=r.midpoint(),h=Fu(u,d),m=Fu(c,d);a=t.createRadialGradient(d.x,d.y,0,d.x,d.y,Math.max(h,m))}else{var v=s?{x:0,y:0}:r.position(),x=r.paddedWidth(),y=r.paddedHeight();a=t.createRadialGradient(v.x,v.y,0,v.x,v.y,Math.max(x,y))}else if(r.isEdge()){var b=r.sourceEndpoint(),S=r.targetEndpoint();a=t.createLinearGradient(b.x,b.y,S.x,S.y)}else{var w=s?{x:0,y:0}:r.position(),k=r.paddedWidth(),N=r.paddedHeight(),T=k/2,j=N/2,M=r.pstyle("background-gradient-direction").value;switch(M){case"to-bottom":a=t.createLinearGradient(w.x,w.y-j,w.x,w.y+j);break;case"to-top":a=t.createLinearGradient(w.x,w.y+j,w.x,w.y-j);break;case"to-left":a=t.createLinearGradient(w.x+T,w.y,w.x-T,w.y);break;case"to-right":a=t.createLinearGradient(w.x-T,w.y,w.x+T,w.y);break;case"to-bottom-right":case"to-right-bottom":a=t.createLinearGradient(w.x-T,w.y-j,w.x+T,w.y+j);break;case"to-top-right":case"to-right-top":a=t.createLinearGradient(w.x-T,w.y+j,w.x+T,w.y-j);break;case"to-bottom-left":case"to-left-bottom":a=t.createLinearGradient(w.x+T,w.y-j,w.x-T,w.y+j);break;case"to-top-left":case"to-left-top":a=t.createLinearGradient(w.x+T,w.y+j,w.x-T,w.y-j);break}}if(!a)return null;for(var A=l.length===o.length,P=o.length,D=0;D<P;D++)a.addColorStop(A?l[D]:D/(P-1),"rgba("+o[D][0]+","+o[D][1]+","+o[D][2]+","+i+")");return a};ai.gradientFillStyle=function(t,e,r,n){var i=this.createGradientStyleFor(t,"background",e,r,n);if(!i)return null;t.fillStyle=i};ai.colorFillStyle=function(t,e,r,n,i){t.fillStyle="rgba("+e+","+r+","+n+","+i+")"};ai.eleFillStyle=function(t,e,r){var n=e.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(t,e,n,r);else{var i=e.pstyle("background-color").value;this.colorFillStyle(t,i[0],i[1],i[2],r)}};ai.gradientStrokeStyle=function(t,e,r,n){var i=this.createGradientStyleFor(t,"line",e,r,n);if(!i)return null;t.strokeStyle=i};ai.colorStrokeStyle=function(t,e,r,n,i){t.strokeStyle="rgba("+e+","+r+","+n+","+i+")"};ai.eleStrokeStyle=function(t,e,r){var n=e.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(t,e,n,r);else{var i=e.pstyle("line-color").value;this.colorStrokeStyle(t,i[0],i[1],i[2],r)}};ai.matchCanvasSize=function(t){var e=this,r=e.data,n=e.findContainerClientCoords(),i=n[2],a=n[3],s=e.getPixelRatio(),o=e.motionBlurPxRatio;(t===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||t===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(s=o);var l=i*s,u=a*s,c;if(!(l===e.canvasWidth&&u===e.canvasHeight)){e.fontCaches=null;var d=r.canvasContainer;d.style.width=i+"px",d.style.height=a+"px";for(var h=0;h<e.CANVAS_LAYERS;h++)c=r.canvases[h],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=a+"px";for(var h=0;h<e.BUFFER_COUNT;h++)c=r.bufferCanvases[h],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=a+"px";e.textureMult=1,s<=1&&(c=r.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,c.width=l*e.textureMult,c.height=u*e.textureMult),e.canvasWidth=l,e.canvasHeight=u,e.pixelRatio=s}};ai.renderTo=function(t,e,r,n){this.render({forcedContext:t,forcedZoom:e,forcedPan:r,drawAllLayers:!0,forcedPxRatio:n})};ai.clearCanvas=function(){var t=this,e=t.data;function r(n){n.clearRect(0,0,t.canvasWidth,t.canvasHeight)}r(e.contexts[t.NODE]),r(e.contexts[t.DRAG])};ai.render=function(t){var e=this;t=t||KA();var r=e.cy,n=t.forcedContext,i=t.drawAllLayers,a=t.drawOnlyNodeLayer,s=t.forcedZoom,o=t.forcedPan,l=t.forcedPxRatio===void 0?this.getPixelRatio():t.forcedPxRatio,u=e.data,c=u.canvasNeedsRedraw,d=e.textureOnViewport&&!n&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),h=t.motionBlur!==void 0?t.motionBlur:e.motionBlur,m=e.motionBlurPxRatio,v=r.hasCompoundNodes(),x=e.hoverData.draggingEles,y=!!(e.hoverData.selecting||e.touchData.selecting);h=h&&!n&&e.motionBlurEnabled&&!y;var b=h;n||(e.prevPxRatio!==l&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=l),!n&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),h&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(b=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!d&&(c[e.NODE]=!0,c[e.SELECT_BOX]=!0);var S=r.style(),w=r.zoom(),k=s!==void 0?s:w,N=r.pan(),T={x:N.x,y:N.y},j={zoom:w,pan:{x:N.x,y:N.y}},M=e.prevViewport,A=M===void 0||j.zoom!==M.zoom||j.pan.x!==M.pan.x||j.pan.y!==M.pan.y;!A&&!(x&&!v)&&(e.motionBlurPxRatio=1),o&&(T=o),k*=l,T.x*=l,T.y*=l;var P=e.getCachedZSortedEles();function D(ie,$,q,te,Z){var le=ie.globalCompositeOperation;ie.globalCompositeOperation="destination-out",e.colorFillStyle(ie,255,255,255,e.motionBlurTransparency),ie.fillRect($,q,te,Z),ie.globalCompositeOperation=le}function R(ie,$){var q,te,Z,le;!e.clearingMotionBlur&&(ie===u.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||ie===u.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(q={x:N.x*m,y:N.y*m},te=w*m,Z=e.canvasWidth*m,le=e.canvasHeight*m):(q=T,te=k,Z=e.canvasWidth,le=e.canvasHeight),ie.setTransform(1,0,0,1,0,0),$==="motionBlur"?D(ie,0,0,Z,le):!n&&($===void 0||$)&&ie.clearRect(0,0,Z,le),i||(ie.translate(q.x,q.y),ie.scale(te,te)),o&&ie.translate(o.x,o.y),s&&ie.scale(s,s)}if(d||(e.textureDrawLastFrame=!1),d){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=r.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var I=e.data.bufferContexts[e.TEXTURE_BUFFER];I.setTransform(1,0,0,1,0,0),I.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:I,drawOnlyNodeLayer:!0,forcedPxRatio:l*e.textureMult});var j=e.textureCache.viewport={zoom:r.zoom(),pan:r.pan(),width:e.canvasWidth,height:e.canvasHeight};j.mpan={x:(0-j.pan.x)/j.zoom,y:(0-j.pan.y)/j.zoom}}c[e.DRAG]=!1,c[e.NODE]=!1;var U=u.contexts[e.NODE],B=e.textureCache.texture,j=e.textureCache.viewport;U.setTransform(1,0,0,1,0,0),h?D(U,0,0,j.width,j.height):U.clearRect(0,0,j.width,j.height);var z=S.core("outside-texture-bg-color").value,F=S.core("outside-texture-bg-opacity").value;e.colorFillStyle(U,z[0],z[1],z[2],F),U.fillRect(0,0,j.width,j.height);var w=r.zoom();R(U,!1),U.clearRect(j.mpan.x,j.mpan.y,j.width/j.zoom/l,j.height/j.zoom/l),U.drawImage(B,j.mpan.x,j.mpan.y,j.width/j.zoom/l,j.height/j.zoom/l)}else e.textureOnViewport&&!n&&(e.textureCache=null);var V=r.extent(),J=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),Y=e.hideEdgesOnViewport&&J,L=[];if(L[e.NODE]=!c[e.NODE]&&h&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,L[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),L[e.DRAG]=!c[e.DRAG]&&h&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,L[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),c[e.NODE]||i||a||L[e.NODE]){var G=h&&!L[e.NODE]&&m!==1,U=n||(G?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:u.contexts[e.NODE]),ee=h&&!G?"motionBlur":void 0;R(U,ee),Y?e.drawCachedNodes(U,P.nondrag,l,V):e.drawLayeredElements(U,P.nondrag,l,V),e.debug&&e.drawDebugPoints(U,P.nondrag),!i&&!h&&(c[e.NODE]=!1)}if(!a&&(c[e.DRAG]||i||L[e.DRAG])){var G=h&&!L[e.DRAG]&&m!==1,U=n||(G?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:u.contexts[e.DRAG]);R(U,h&&!G?"motionBlur":void 0),Y?e.drawCachedNodes(U,P.drag,l,V):e.drawCachedElements(U,P.drag,l,V),e.debug&&e.drawDebugPoints(U,P.drag),!i&&!h&&(c[e.DRAG]=!1)}if(this.drawSelectionRectangle(t,R),h&&m!==1){var re=u.contexts[e.NODE],se=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],de=u.contexts[e.DRAG],W=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],ne=function($,q,te){$.setTransform(1,0,0,1,0,0),te||!b?$.clearRect(0,0,e.canvasWidth,e.canvasHeight):D($,0,0,e.canvasWidth,e.canvasHeight);var Z=m;$.drawImage(q,0,0,e.canvasWidth*Z,e.canvasHeight*Z,0,0,e.canvasWidth,e.canvasHeight)};(c[e.NODE]||L[e.NODE])&&(ne(re,se,L[e.NODE]),c[e.NODE]=!1),(c[e.DRAG]||L[e.DRAG])&&(ne(de,W,L[e.DRAG]),c[e.DRAG]=!1)}e.prevViewport=j,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),h&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!d,e.mbFrames=0,c[e.NODE]=!0,c[e.DRAG]=!0,e.redraw()},hK)),n||r.emit("render")};var Jf;ai.drawSelectionRectangle=function(t,e){var r=this,n=r.cy,i=r.data,a=n.style(),s=t.drawOnlyNodeLayer,o=t.drawAllLayers,l=i.canvasNeedsRedraw,u=t.forcedContext;if(r.showFps||!s&&l[r.SELECT_BOX]&&!o){var c=u||i.contexts[r.SELECT_BOX];if(e(c),r.selection[4]==1&&(r.hoverData.selecting||r.touchData.selecting)){var d=r.cy.zoom(),h=a.core("selection-box-border-width").value/d;c.lineWidth=h,c.fillStyle="rgba("+a.core("selection-box-color").value[0]+","+a.core("selection-box-color").value[1]+","+a.core("selection-box-color").value[2]+","+a.core("selection-box-opacity").value+")",c.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]),h>0&&(c.strokeStyle="rgba("+a.core("selection-box-border-color").value[0]+","+a.core("selection-box-border-color").value[1]+","+a.core("selection-box-border-color").value[2]+","+a.core("selection-box-opacity").value+")",c.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]))}if(i.bgActivePosistion&&!r.hoverData.selecting){var d=r.cy.zoom(),m=i.bgActivePosistion;c.fillStyle="rgba("+a.core("active-bg-color").value[0]+","+a.core("active-bg-color").value[1]+","+a.core("active-bg-color").value[2]+","+a.core("active-bg-opacity").value+")",c.beginPath(),c.arc(m.x,m.y,a.core("active-bg-size").pfValue/d,0,2*Math.PI),c.fill()}var v=r.lastRedrawTime;if(r.showFps&&v){v=Math.round(v);var x=Math.round(1e3/v),y="1 frame = "+v+" ms = "+x+" fps";if(c.setTransform(1,0,0,1,0,0),c.fillStyle="rgba(255, 0, 0, 0.75)",c.strokeStyle="rgba(255, 0, 0, 0.75)",c.font="30px Arial",!Jf){var b=c.measureText(y);Jf=b.actualBoundingBoxAscent}c.fillText(y,0,Jf);var S=60;c.strokeRect(0,Jf+10,250,20),c.fillRect(0,Jf+10,250*Math.min(x/S,1),20)}o||(l[r.SELECT_BOX]=!1)}};function K8(t,e,r){var n=t.createShader(e);if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n));return n}function pK(t,e,r){var n=K8(t,t.VERTEX_SHADER,e),i=K8(t,t.FRAGMENT_SHADER,r),a=t.createProgram();if(t.attachShader(a,n),t.attachShader(a,i),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new Error("Could not initialize shaders");return a}function mK(t,e,r){r===void 0&&(r=e);var n=t.makeOffscreenCanvas(e,r),i=n.context=n.getContext("2d");return n.clear=function(){return i.clearRect(0,0,n.width,n.height)},n.clear(),n}function v3(t){var e=t.pixelRatio,r=t.cy.zoom(),n=t.cy.pan();return{zoom:r*e,pan:{x:n.x*e,y:n.y*e}}}function gK(t){var e=t.pixelRatio,r=t.cy.zoom();return r*e}function vK(t,e,r,n,i){var a=n*r+e.x,s=i*r+e.y;return s=Math.round(t.canvasHeight-s),[a,s]}function yK(t){return t.pstyle("background-fill").value!=="solid"||t.pstyle("background-image").strValue!=="none"?!1:t.pstyle("border-width").value===0||t.pstyle("border-opacity").value===0?!0:t.pstyle("border-style").value==="solid"}function xK(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function iu(t,e,r){var n=t[0]/255,i=t[1]/255,a=t[2]/255,s=e,o=r||new Array(4);return o[0]=n*s,o[1]=i*s,o[2]=a*s,o[3]=s,o}function Rc(t,e){var r=e||new Array(4);return r[0]=(t>>0&255)/255,r[1]=(t>>8&255)/255,r[2]=(t>>16&255)/255,r[3]=(t>>24&255)/255,r}function bK(t){return t[0]+(t[1]<<8)+(t[2]<<16)+(t[3]<<24)}function wK(t,e){var r=t.createTexture();return r.buffer=function(n){t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)},r.deleteTexture=function(){t.deleteTexture(r)},r}function o7(t,e){switch(e){case"float":return[1,t.FLOAT,4];case"vec2":return[2,t.FLOAT,4];case"vec3":return[3,t.FLOAT,4];case"vec4":return[4,t.FLOAT,4];case"int":return[1,t.INT,4];case"ivec2":return[2,t.INT,4]}}function l7(t,e,r){switch(e){case t.FLOAT:return new Float32Array(r);case t.INT:return new Int32Array(r)}}function SK(t,e,r,n,i,a){switch(e){case t.FLOAT:return new Float32Array(r.buffer,a*n,i);case t.INT:return new Int32Array(r.buffer,a*n,i)}}function kK(t,e,r,n){var i=o7(t,e),a=zr(i,2),s=a[0],o=a[1],l=l7(t,o,n),u=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,l,t.STATIC_DRAW),o===t.FLOAT?t.vertexAttribPointer(r,s,o,!1,0,0):o===t.INT&&t.vertexAttribIPointer(r,s,o,0,0),t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,null),u}function Xa(t,e,r,n){var i=o7(t,r),a=zr(i,3),s=a[0],o=a[1],l=a[2],u=l7(t,o,e*s),c=s*l,d=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,d),t.bufferData(t.ARRAY_BUFFER,e*c,t.DYNAMIC_DRAW),t.enableVertexAttribArray(n),o===t.FLOAT?t.vertexAttribPointer(n,s,o,!1,c,0):o===t.INT&&t.vertexAttribIPointer(n,s,o,c,0),t.vertexAttribDivisor(n,1),t.bindBuffer(t.ARRAY_BUFFER,null);for(var h=new Array(e),m=0;m<e;m++)h[m]=SK(t,o,u,c,s,m);return d.dataArray=u,d.stride=c,d.size=s,d.getView=function(v){return h[v]},d.setPoint=function(v,x,y){var b=h[v];b[0]=x,b[1]=y},d.bufferSubData=function(v){t.bindBuffer(t.ARRAY_BUFFER,d),v?t.bufferSubData(t.ARRAY_BUFFER,0,u,0,v*s):t.bufferSubData(t.ARRAY_BUFFER,0,u)},d}function CK(t,e,r){for(var n=9,i=new Float32Array(e*n),a=new Array(e),s=0;s<e;s++){var o=s*n*4;a[s]=new Float32Array(i.buffer,o,n)}var l=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferData(t.ARRAY_BUFFER,i.byteLength,t.DYNAMIC_DRAW);for(var u=0;u<3;u++){var c=r+u;t.enableVertexAttribArray(c),t.vertexAttribPointer(c,3,t.FLOAT,!1,3*12,u*12),t.vertexAttribDivisor(c,1)}return t.bindBuffer(t.ARRAY_BUFFER,null),l.getMatrixView=function(d){return a[d]},l.setData=function(d,h){a[h].set(d,0)},l.bufferSubData=function(){t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferSubData(t.ARRAY_BUFFER,0,i)},l}function NK(t){var e=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.bindFramebuffer(t.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(n,i){t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,i,0,t.RGBA,t.UNSIGNED_BYTE,null)},e}var Y8=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function I2(){var t=new Y8(9);return Y8!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function X8(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function EK(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=r[0],m=r[1],v=r[2],x=r[3],y=r[4],b=r[5],S=r[6],w=r[7],k=r[8];return t[0]=h*n+m*s+v*u,t[1]=h*i+m*o+v*c,t[2]=h*a+m*l+v*d,t[3]=x*n+y*s+b*u,t[4]=x*i+y*o+b*c,t[5]=x*a+y*l+b*d,t[6]=S*n+w*s+k*u,t[7]=S*i+w*o+k*c,t[8]=S*a+w*l+k*d,t}function Iv(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=r[0],m=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=s,t[4]=o,t[5]=l,t[6]=h*n+m*s+u,t[7]=h*i+m*o+c,t[8]=h*a+m*l+d,t}function Q8(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=Math.sin(r),m=Math.cos(r);return t[0]=m*n+h*s,t[1]=m*i+h*o,t[2]=m*a+h*l,t[3]=m*s-h*n,t[4]=m*o-h*i,t[5]=m*l-h*a,t[6]=u,t[7]=c,t[8]=d,t}function J5(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function TK(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}var jK=function(){function t(e,r,n,i){Ml(this,t),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.texSize=r,this.texRows=n,this.texHeight=Math.floor(r/n),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=i(e,r,r),this.scratch=i(e,r,this.texHeight,"scratch")}return Pl(t,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(r){var n=r.w,i=r.h,a=this.texHeight,s=this.texSize,o=a/i,l=n*o,u=i*o;return l>s&&(o=s/n,l=n*o,u=i*o),{scale:o,texW:l,texH:u}}},{key:"draw",value:function(r,n,i){var a=this;if(this.locked)throw new Error("can't draw, atlas is locked");var s=this.texSize,o=this.texRows,l=this.texHeight,u=this.getScale(n),c=u.scale,d=u.texW,h=u.texH,m=function(w,k){if(i&&k){var N=k.context,T=w.x,j=w.row,M=T,A=l*j;N.save(),N.translate(M,A),N.scale(c,c),i(N,n),N.restore()}},v=[null,null],x=function(){m(a.freePointer,a.canvas),v[0]={x:a.freePointer.x,y:a.freePointer.row*l,w:d,h},v[1]={x:a.freePointer.x+d,y:a.freePointer.row*l,w:0,h},a.freePointer.x+=d,a.freePointer.x==s&&(a.freePointer.x=0,a.freePointer.row++)},y=function(){var w=a.scratch,k=a.canvas;w.clear(),m({x:0,row:0},w);var N=s-a.freePointer.x,T=d-N,j=l;{var M=a.freePointer.x,A=a.freePointer.row*l,P=N;k.context.drawImage(w,0,0,P,j,M,A,P,j),v[0]={x:M,y:A,w:P,h}}{var D=N,R=(a.freePointer.row+1)*l,I=T;k&&k.context.drawImage(w,D,0,I,j,0,R,I,j),v[1]={x:0,y:R,w:I,h}}a.freePointer.x=T,a.freePointer.row++},b=function(){a.freePointer.x=0,a.freePointer.row++};if(this.freePointer.x+d<=s)x();else{if(this.freePointer.row>=o-1)return!1;this.freePointer.x===s?(b(),x()):this.enableWrapping?y():(b(),x())}return this.keyToLocation.set(r,v),this.needsBuffer=!0,v}},{key:"getOffsets",value:function(r){return this.keyToLocation.get(r)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(r){if(this.locked)return!1;var n=this.texSize,i=this.texRows,a=this.getScale(r),s=a.texW;return this.freePointer.x+s>n?this.freePointer.row<i-1:!0}},{key:"bufferIfNeeded",value:function(r){this.texture||(this.texture=wK(r,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])}(),MK=function(){function t(e,r,n,i){Ml(this,t),this.r=e,this.texSize=r,this.texRows=n,this.createTextureCanvas=i,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return Pl(t,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var r=this.r,n=this.texSize,i=this.texRows,a=this.createTextureCanvas;return new jK(r,n,i,a)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var r=this.r,n=this.texSize,i=this.texRows,a=this.createTextureCanvas,s=Math.floor(n/i);this.scratch=a(r,n,s,"scratch")}return this.scratch}},{key:"draw",value:function(r,n,i){var a=this.styleKeyToAtlas.get(r);return a||(a=this.atlases[this.atlases.length-1],(!a||!a.canFit(n))&&(a&&a.lock(),a=this._createAtlas(),this.atlases.push(a)),a.draw(r,n,i),this.styleKeyToAtlas.set(r,a)),a}},{key:"getAtlas",value:function(r){return this.styleKeyToAtlas.get(r)}},{key:"hasAtlas",value:function(r){return this.styleKeyToAtlas.has(r)}},{key:"markKeyForGC",value:function(r){this.markedKeys.add(r)}},{key:"gc",value:function(){var r=this,n=this.markedKeys;if(n.size===0){console.log("nothing to garbage collect");return}var i=[],a=new Map,s=null,o=vi(this.atlases),l;try{var u=function(){var d=l.value,h=d.getKeys(),m=PK(n,h);if(m.size===0)return i.push(d),h.forEach(function(N){return a.set(N,d)}),1;s||(s=r._createAtlas(),i.push(s));var v=vi(h),x;try{for(v.s();!(x=v.n()).done;){var y=x.value;if(!m.has(y)){var b=d.getOffsets(y),S=zr(b,2),w=S[0],k=S[1];s.canFit({w:w.w+k.w,h:w.h})||(s.lock(),s=r._createAtlas(),i.push(s)),d.canvas&&(r._copyTextureToNewAtlas(y,d,s),a.set(y,s))}}}catch(N){v.e(N)}finally{v.f()}d.dispose()};for(o.s();!(l=o.n()).done;)u()}catch(c){o.e(c)}finally{o.f()}this.atlases=i,this.styleKeyToAtlas=a,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(r,n,i){var a=n.getOffsets(r),s=zr(a,2),o=s[0],l=s[1];if(l.w===0)i.draw(r,o,function(h){h.drawImage(n.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h)});else{var u=this._getScratchCanvas();u.clear(),u.context.drawImage(n.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h),u.context.drawImage(n.canvas,l.x,l.y,l.w,l.h,o.w,0,l.w,l.h);var c=o.w+l.w,d=o.h;i.draw(r,{w:c,h:d},function(h){h.drawImage(u,0,0,c,d,0,0,c,d)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])}();function PK(t,e){return t.intersection?t.intersection(e):new Set(b0(t).filter(function(r){return e.has(r)}))}var _K=function(){function t(e,r){Ml(this,t),this.r=e,this.globalOptions=r,this.atlasSize=r.webglTexSize,this.maxAtlasesPerBatch=r.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return Pl(t,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(r,n){var i=this.globalOptions,a=i.webglTexSize,s=i.createTextureCanvas,o=n.texRows,l=this._cacheScratchCanvas(s),u=new MK(this.r,a,o,l);this.collections.set(r,u)}},{key:"addRenderType",value:function(r,n){var i=n.collection;if(!this.collections.has(i))throw new Error("invalid atlas collection name '".concat(i,"'"));var a=this.collections.get(i),s=Qe({type:r,atlasCollection:a},n);this.renderTypes.set(r,s)}},{key:"getRenderTypeOpts",value:function(r){return this.renderTypes.get(r)}},{key:"getAtlasCollection",value:function(r){return this.collections.get(r)}},{key:"_cacheScratchCanvas",value:function(r){var n=-1,i=-1,a=null;return function(s,o,l,u){return u?((!a||o!=n||l!=i)&&(n=o,i=l,a=r(s,o,l)),a):r(s,o,l)}}},{key:"_key",value:function(r,n){return"".concat(r,"-").concat(n)}},{key:"invalidate",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.forceRedraw,s=a===void 0?!1:a,o=i.filterEle,l=o===void 0?function(){return!0}:o,u=i.filterType,c=u===void 0?function(){return!0}:u,d=!1,h=!1,m=vi(r),v;try{for(m.s();!(v=m.n()).done;){var x=v.value;if(l(x)){var y=vi(this.renderTypes.values()),b;try{var S=function(){var k=b.value,N=k.type;if(c(N)){var T=n.collections.get(k.collection),j=k.getKey(x),M=Array.isArray(j)?j:[j];if(s)M.forEach(function(R){return T.markKeyForGC(R)}),h=!0;else{var A=k.getID?k.getID(x):x.id(),P=n._key(N,A),D=n.typeAndIdToKey.get(P);D!==void 0&&!xK(M,D)&&(d=!0,n.typeAndIdToKey.delete(P),D.forEach(function(R){return T.markKeyForGC(R)}))}}};for(y.s();!(b=y.n()).done;)S()}catch(w){y.e(w)}finally{y.f()}}}}catch(w){m.e(w)}finally{m.f()}return h&&(this.gc(),d=!1),d}},{key:"gc",value:function(){var r=vi(this.collections.values()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;i.gc()}}catch(a){r.e(a)}finally{r.f()}}},{key:"getOrCreateAtlas",value:function(r,n,i,a){var s=this.renderTypes.get(n),o=this.collections.get(s.collection),l=!1,u=o.draw(a,i,function(h){s.drawClipped?(h.save(),h.beginPath(),h.rect(0,0,i.w,i.h),h.clip(),s.drawElement(h,r,i,!0,!0),h.restore()):s.drawElement(h,r,i,!0,!0),l=!0});if(l){var c=s.getID?s.getID(r):r.id(),d=this._key(n,c);this.typeAndIdToKey.has(d)?this.typeAndIdToKey.get(d).push(a):this.typeAndIdToKey.set(d,[a])}return u}},{key:"getAtlasInfo",value:function(r,n){var i=this,a=this.renderTypes.get(n),s=a.getKey(r),o=Array.isArray(s)?s:[s];return o.map(function(l){var u=a.getBoundingBox(r,l),c=i.getOrCreateAtlas(r,n,u,l),d=c.getOffsets(l),h=zr(d,2),m=h[0],v=h[1];return{atlas:c,tex:m,tex1:m,tex2:v,bb:u}})}},{key:"getDebugInfo",value:function(){var r=[],n=vi(this.collections),i;try{for(n.s();!(i=n.n()).done;){var a=zr(i.value,2),s=a[0],o=a[1],l=o.getCounts(),u=l.keyCount,c=l.atlasCount;r.push({type:s,keyCount:u,atlasCount:c})}}catch(d){n.e(d)}finally{n.f()}return r}}])}(),AK=function(){function t(e){Ml(this,t),this.globalOptions=e,this.atlasSize=e.webglTexSize,this.maxAtlasesPerBatch=e.webglTexPerBatch,this.batchAtlases=[]}return Pl(t,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(r,n){return n})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(r){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(r):!0}},{key:"getAtlasIndexForBatch",value:function(r){var n=this.batchAtlases.indexOf(r);if(n<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(r),n=this.batchAtlases.length-1}return n}}])}(),RK=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,DK=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,OK=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,IK=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,Bh={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},A0={IGNORE:1,USE_BB:2},L2=0,J8=1,Z8=2,B2=3,Dc=4,$g=5,Zf=6,eh=7,LK=function(){function t(e,r,n){Ml(this,t),this.r=e,this.gl=r,this.maxInstances=n.webglBatchSize,this.atlasSize=n.webglTexSize,this.bgColor=n.bgColor,this.debug=n.webglDebug,this.batchDebugInfo=[],n.enableWrapping=!0,n.createTextureCanvas=mK,this.atlasManager=new _K(e,n),this.batchManager=new AK(n),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(Bh.SCREEN),this.pickingProgram=this._createShaderProgram(Bh.PICKING),this.vao=this._createVAO()}return Pl(t,[{key:"addAtlasCollection",value:function(r,n){this.atlasManager.addAtlasCollection(r,n)}},{key:"addTextureAtlasRenderType",value:function(r,n){this.atlasManager.addRenderType(r,n)}},{key:"addSimpleShapeRenderType",value:function(r,n){this.simpleShapeOptions.set(r,n)}},{key:"invalidate",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.type,a=this.atlasManager;return i?a.invalidate(r,{filterType:function(o){return o===i},forceRedraw:!0}):a.invalidate(r)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(r){var n=this.gl,i=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(L2,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(Dc," || aVertType == ").concat(eh,` 
             || aVertType == `).concat($g," || aVertType == ").concat(Zf,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(J8,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(Z8,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(B2,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),a=this.batchManager.getIndexArray(),s=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(a.map(function(u){return"uniform sampler2D uTexture".concat(u,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(RK,`
      `).concat(DK,`
      `).concat(OK,`
      `).concat(IK,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(L2,`) {
          // look up the texel from the texture unit
          `).concat(a.map(function(u){return"if(vAtlasId == ".concat(u,") outColor = texture(uTexture").concat(u,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(B2,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(Dc,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(Dc," || vVertType == ").concat(eh,` 
          || vVertType == `).concat($g," || vVertType == ").concat(Zf,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(Dc,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(eh,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(eh,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(r.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),o=pK(n,i,s);o.aPosition=n.getAttribLocation(o,"aPosition"),o.aIndex=n.getAttribLocation(o,"aIndex"),o.aVertType=n.getAttribLocation(o,"aVertType"),o.aTransform=n.getAttribLocation(o,"aTransform"),o.aAtlasId=n.getAttribLocation(o,"aAtlasId"),o.aTex=n.getAttribLocation(o,"aTex"),o.aPointAPointB=n.getAttribLocation(o,"aPointAPointB"),o.aPointCPointD=n.getAttribLocation(o,"aPointCPointD"),o.aLineWidth=n.getAttribLocation(o,"aLineWidth"),o.aColor=n.getAttribLocation(o,"aColor"),o.aCornerRadius=n.getAttribLocation(o,"aCornerRadius"),o.aBorderColor=n.getAttribLocation(o,"aBorderColor"),o.uPanZoomMatrix=n.getUniformLocation(o,"uPanZoomMatrix"),o.uAtlasSize=n.getUniformLocation(o,"uAtlasSize"),o.uBGColor=n.getUniformLocation(o,"uBGColor"),o.uZoom=n.getUniformLocation(o,"uZoom"),o.uTextures=[];for(var l=0;l<this.batchManager.getMaxAtlasesPerBatch();l++)o.uTextures.push(n.getUniformLocation(o,"uTexture".concat(l)));return o}},{key:"_createVAO",value:function(){var r=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=r.length/2;var n=this.maxInstances,i=this.gl,a=this.program,s=i.createVertexArray();return i.bindVertexArray(s),kK(i,"vec2",a.aPosition,r),this.transformBuffer=CK(i,n,a.aTransform),this.indexBuffer=Xa(i,n,"vec4",a.aIndex),this.vertTypeBuffer=Xa(i,n,"int",a.aVertType),this.atlasIdBuffer=Xa(i,n,"int",a.aAtlasId),this.texBuffer=Xa(i,n,"vec4",a.aTex),this.pointAPointBBuffer=Xa(i,n,"vec4",a.aPointAPointB),this.pointCPointDBuffer=Xa(i,n,"vec4",a.aPointCPointD),this.lineWidthBuffer=Xa(i,n,"vec2",a.aLineWidth),this.colorBuffer=Xa(i,n,"vec4",a.aColor),this.cornerRadiusBuffer=Xa(i,n,"vec4",a.aCornerRadius),this.borderColorBuffer=Xa(i,n,"vec4",a.aBorderColor),i.bindVertexArray(null),s}},{key:"buffers",get:function(){var r=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(n){return Wo(n,"Buffer")}).map(function(n){return r[n]})),this._buffers}},{key:"startFrame",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bh.SCREEN;this.panZoomMatrix=r,this.renderTarget=n,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(r,n){return r.visible()?n&&n.isVisible?n.isVisible(r):!0:!1}},{key:"drawTexture",value:function(r,n,i){var a=this.atlasManager,s=this.batchManager,o=a.getRenderTypeOpts(i);if(this._isVisible(r,o)&&!(r.isEdge()&&!this._isValidEdge(r))){if(this.renderTarget.picking&&o.getTexPickingMode){var l=o.getTexPickingMode(r);if(l===A0.IGNORE)return;if(l==A0.USE_BB){this.drawPickingRectangle(r,n,i);return}}var u=a.getAtlasInfo(r,i),c=vi(u),d;try{for(c.s();!(d=c.n()).done;){var h=d.value,m=h.atlas,v=h.tex1,x=h.tex2;s.canAddToCurrentBatch(m)||this.endBatch();for(var y=s.getAtlasIndexForBatch(m),b=0,S=[[v,!0],[x,!1]];b<S.length;b++){var w=zr(S[b],2),k=w[0],N=w[1];if(k.w!=0){var T=this.instanceCount;this.vertTypeBuffer.getView(T)[0]=L2;var j=this.indexBuffer.getView(T);Rc(n,j);var M=this.atlasIdBuffer.getView(T);M[0]=y;var A=this.texBuffer.getView(T);A[0]=k.x,A[1]=k.y,A[2]=k.w,A[3]=k.h;var P=this.transformBuffer.getMatrixView(T);this.setTransformMatrix(r,P,o,h,N),this.instanceCount++,N||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(D){c.e(D)}finally{c.f()}}}},{key:"setTransformMatrix",value:function(r,n,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=0;if(i.shapeProps&&i.shapeProps.padding&&(o=r.pstyle(i.shapeProps.padding).pfValue),a){var l=a.bb,u=a.tex1,c=a.tex2,d=u.w/(u.w+c.w);s||(d=1-d);var h=this._getAdjustedBB(l,o,s,d);this._applyTransformMatrix(n,h,i,r)}else{var m=i.getBoundingBox(r),v=this._getAdjustedBB(m,o,!0,1);this._applyTransformMatrix(n,v,i,r)}}},{key:"_applyTransformMatrix",value:function(r,n,i,a){var s,o;X8(r);var l=i.getRotation?i.getRotation(a):0;if(l!==0){var u=i.getRotationPoint(a),c=u.x,d=u.y;Iv(r,r,[c,d]),Q8(r,r,l);var h=i.getRotationOffset(a);s=h.x+(n.xOffset||0),o=h.y+(n.yOffset||0)}else s=n.x1,o=n.y1;Iv(r,r,[s,o]),J5(r,r,[n.w,n.h])}},{key:"_getAdjustedBB",value:function(r,n,i,a){var s=r.x1,o=r.y1,l=r.w,u=r.h,c=r.yOffset;n&&(s-=n,o-=n,l+=2*n,u+=2*n);var d=0,h=l*a;return i&&a<1?l=h:!i&&a<1&&(d=l-h,s+=d,l=h),{x1:s,y1:o,w:l,h:u,xOffset:d,yOffset:c}}},{key:"drawPickingRectangle",value:function(r,n,i){var a=this.atlasManager.getRenderTypeOpts(i),s=this.instanceCount;this.vertTypeBuffer.getView(s)[0]=Dc;var o=this.indexBuffer.getView(s);Rc(n,o);var l=this.colorBuffer.getView(s);iu([0,0,0],1,l);var u=this.transformBuffer.getMatrixView(s);this.setTransformMatrix(r,u,a),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(r,n,i){var a=this.simpleShapeOptions.get(i);if(this._isVisible(r,a)){var s=a.shapeProps,o=this._getVertTypeForShape(r,s.shape);if(o===void 0||a.isSimple&&!a.isSimple(r)){this.drawTexture(r,n,i);return}var l=this.instanceCount;if(this.vertTypeBuffer.getView(l)[0]=o,o===$g||o===Zf){var u=a.getBoundingBox(r),c=this._getCornerRadius(r,s.radius,u),d=this.cornerRadiusBuffer.getView(l);d[0]=c,d[1]=c,d[2]=c,d[3]=c,o===Zf&&(d[0]=0,d[2]=0)}var h=this.indexBuffer.getView(l);Rc(n,h);var m=r.pstyle(s.color).value,v=r.pstyle(s.opacity).value,x=this.colorBuffer.getView(l);iu(m,v,x);var y=this.lineWidthBuffer.getView(l);if(y[0]=0,y[1]=0,s.border){var b=r.pstyle("border-width").value;if(b>0){var S=r.pstyle("border-color").value,w=r.pstyle("border-opacity").value,k=this.borderColorBuffer.getView(l);iu(S,w,k);var N=r.pstyle("border-position").value;if(N==="inside")y[0]=0,y[1]=-b;else if(N==="outside")y[0]=b,y[1]=0;else{var T=b/2;y[0]=T,y[1]=-T}}}var j=this.transformBuffer.getMatrixView(l);this.setTransformMatrix(r,j,a),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(r,n){var i=r.pstyle(n).value;switch(i){case"rectangle":return Dc;case"ellipse":return eh;case"roundrectangle":case"round-rectangle":return $g;case"bottom-round-rectangle":return Zf;default:return}}},{key:"_getCornerRadius",value:function(r,n,i){var a=i.w,s=i.h;if(r.pstyle(n).value==="auto")return vl(a,s);var o=r.pstyle(n).pfValue,l=a/2,u=s/2;return Math.min(o,u,l)}},{key:"drawEdgeArrow",value:function(r,n,i){if(r.visible()){var a=r._private.rscratch,s,o,l;if(i==="source"?(s=a.arrowStartX,o=a.arrowStartY,l=a.srcArrowAngle):(s=a.arrowEndX,o=a.arrowEndY,l=a.tgtArrowAngle),!(isNaN(s)||s==null||isNaN(o)||o==null||isNaN(l)||l==null)){var u=r.pstyle(i+"-arrow-shape").value;if(u!=="none"){var c=r.pstyle(i+"-arrow-color").value,d=r.pstyle("opacity").value,h=r.pstyle("line-opacity").value,m=d*h,v=r.pstyle("width").pfValue,x=r.pstyle("arrow-scale").value,y=this.r.getArrowWidth(v,x),b=this.instanceCount,S=this.transformBuffer.getMatrixView(b);X8(S),Iv(S,S,[s,o]),J5(S,S,[y,y]),Q8(S,S,l),this.vertTypeBuffer.getView(b)[0]=B2;var w=this.indexBuffer.getView(b);Rc(n,w);var k=this.colorBuffer.getView(b);iu(c,m,k),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(r,n){if(r.visible()){var i=this._getEdgePoints(r);if(i){var a=r.pstyle("opacity").value,s=r.pstyle("line-opacity").value,o=r.pstyle("width").pfValue,l=r.pstyle("line-color").value,u=a*s;if(i.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),i.length==4){var c=this.instanceCount;this.vertTypeBuffer.getView(c)[0]=J8;var d=this.indexBuffer.getView(c);Rc(n,d);var h=this.colorBuffer.getView(c);iu(l,u,h);var m=this.lineWidthBuffer.getView(c);m[0]=o;var v=this.pointAPointBBuffer.getView(c);v[0]=i[0],v[1]=i[1],v[2]=i[2],v[3]=i[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var x=0;x<i.length-2;x+=2){var y=this.instanceCount;this.vertTypeBuffer.getView(y)[0]=Z8;var b=this.indexBuffer.getView(y);Rc(n,b);var S=this.colorBuffer.getView(y);iu(l,u,S);var w=this.lineWidthBuffer.getView(y);w[0]=o;var k=i[x-2],N=i[x-1],T=i[x],j=i[x+1],M=i[x+2],A=i[x+3],P=i[x+4],D=i[x+5];x==0&&(k=2*T-M+.001,N=2*j-A+.001),x==i.length-4&&(P=2*M-T+.001,D=2*A-j+.001);var R=this.pointAPointBBuffer.getView(y);R[0]=k,R[1]=N,R[2]=T,R[3]=j;var I=this.pointCPointDBuffer.getView(y);I[0]=M,I[1]=A,I[2]=P,I[3]=D,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_isValidEdge",value:function(r){var n=r._private.rscratch;return!(n.badLine||n.allpts==null||isNaN(n.allpts[0]))}},{key:"_getEdgePoints",value:function(r){var n=r._private.rscratch;if(this._isValidEdge(r)){var i=n.allpts;if(i.length==4)return i;var a=this._getNumSegments(r);return this._getCurveSegmentPoints(i,a)}}},{key:"_getNumSegments",value:function(r){var n=15;return Math.min(Math.max(n,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(r,n){if(r.length==4)return r;for(var i=Array((n+1)*2),a=0;a<=n;a++)if(a==0)i[0]=r[0],i[1]=r[1];else if(a==n)i[a*2]=r[r.length-2],i[a*2+1]=r[r.length-1];else{var s=a/n;this._setCurvePoint(r,s,i,a*2)}return i}},{key:"_setCurvePoint",value:function(r,n,i,a){if(r.length<=2)i[a]=r[0],i[a+1]=r[1];else{for(var s=Array(r.length-2),o=0;o<s.length;o+=2){var l=(1-n)*r[o]+n*r[o+2],u=(1-n)*r[o+1]+n*r[o+3];s[o]=l,s[o+1]=u}return this._setCurvePoint(s,n,i,a)}}},{key:"endBatch",value:function(){var r=this.gl,n=this.vao,i=this.vertexCount,a=this.instanceCount;if(a!==0){var s=this.renderTarget.picking?this.pickingProgram:this.program;r.useProgram(s),r.bindVertexArray(n);var o=vi(this.buffers),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;u.bufferSubData(a)}}catch(v){o.e(v)}finally{o.f()}for(var c=this.batchManager.getAtlases(),d=0;d<c.length;d++)c[d].bufferIfNeeded(r);for(var h=0;h<c.length;h++)r.activeTexture(r.TEXTURE0+h),r.bindTexture(r.TEXTURE_2D,c[h].texture),r.uniform1i(s.uTextures[h],h);r.uniform1f(s.uZoom,gK(this.r)),r.uniformMatrix3fv(s.uPanZoomMatrix,!1,this.panZoomMatrix),r.uniform1i(s.uAtlasSize,this.batchManager.getAtlasSize());var m=iu(this.bgColor,1);r.uniform4fv(s.uBGColor,m),r.drawArraysInstanced(r.TRIANGLES,0,i,a),r.bindVertexArray(null),r.bindTexture(r.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:a,atlasCount:c.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var r=this.atlasManager.getDebugInfo(),n=r.reduce(function(s,o){return s+o.atlasCount},0),i=this.batchDebugInfo,a=i.reduce(function(s,o){return s+o.count},0);return{atlasInfo:r,totalAtlases:n,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:i.length,batchInfo:i,totalInstances:a}}}])}(),u7={};u7.initWebgl=function(t,e){var r=this,n=r.data.contexts[r.WEBGL];t.bgColor=BK(r),t.webglTexSize=Math.min(t.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE)),t.webglTexRows=Math.min(t.webglTexRows,54),t.webglTexRowsNodes=Math.min(t.webglTexRowsNodes,54),t.webglBatchSize=Math.min(t.webglBatchSize,16384),t.webglTexPerBatch=Math.min(t.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),r.webglDebug=t.webglDebug,r.webglDebugShowAtlases=t.webglDebugShowAtlases,r.pickingFrameBuffer=NK(n),r.pickingFrameBuffer.needsDraw=!0,r.drawing=new LK(r,n,t);var i=function(d){return function(h){return r.getTextAngle(h,d)}},a=function(d){return function(h){var m=h.pstyle(d);return m&&m.value}},s=function(d){return function(h){return h.pstyle("".concat(d,"-opacity")).value>0}},o=function(d){var h=d.pstyle("text-events").strValue==="yes";return h?A0.USE_BB:A0.IGNORE},l=function(d){var h=d.position(),m=h.x,v=h.y,x=d.outerWidth(),y=d.outerHeight();return{w:x,h:y,x1:m-x/2,y1:v-y/2}};r.drawing.addAtlasCollection("node",{texRows:t.webglTexRowsNodes}),r.drawing.addAtlasCollection("label",{texRows:t.webglTexRows}),r.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement}),r.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:l,isSimple:yK,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),r.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:l,isVisible:s("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),r.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:l,isVisible:s("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),r.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:o,getKey:F2(e.getLabelKey,null),getBoundingBox:z2(e.getLabelBox,null),drawClipped:!0,drawElement:e.drawLabel,getRotation:i(null),getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:a("label")}),r.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:o,getKey:F2(e.getSourceLabelKey,"source"),getBoundingBox:z2(e.getSourceLabelBox,"source"),drawClipped:!0,drawElement:e.drawSourceLabel,getRotation:i("source"),getRotationPoint:e.getSourceLabelRotationPoint,getRotationOffset:e.getSourceLabelRotationOffset,isVisible:a("source-label")}),r.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:o,getKey:F2(e.getTargetLabelKey,"target"),getBoundingBox:z2(e.getTargetLabelBox,"target"),drawClipped:!0,drawElement:e.drawTargetLabel,getRotation:i("target"),getRotationPoint:e.getTargetLabelRotationPoint,getRotationOffset:e.getTargetLabelRotationOffset,isVisible:a("target-label")});var u=rm(function(){console.log("garbage collect flag set"),r.data.gc=!0},1e4);r.onUpdateEleCalcs(function(c,d){var h=!1;d&&d.length>0&&(h|=r.drawing.invalidate(d)),h&&u()}),FK(r)};function BK(t){var e=t.cy.container(),r=e&&e.style&&e.style.backgroundColor||"white";return LA(r)}function c7(t,e){var r=t._private.rscratch;return hi(r,"labelWrapCachedLines",e)||[]}var F2=function(e,r){return function(n){var i=e(n),a=c7(n,r);return a.length>1?a.map(function(s,o){return"".concat(i,"_").concat(o)}):i}},z2=function(e,r){return function(n,i){var a=e(n);if(typeof i=="string"){var s=i.indexOf("_");if(s>0){var o=Number(i.substring(s+1)),l=c7(n,r),u=a.h/l.length,c=u*o,d=a.y1+c;return{x1:a.x1,w:a.w,y1:d,h:u,yOffset:c}}}return a}};function FK(t){{var e=t.render;t.render=function(a){a=a||{};var s=t.cy;t.webgl&&(s.zoom()>r7?(zK(t),e.call(t,a)):(VK(t),f7(t,a,Bh.SCREEN)))}}{var r=t.matchCanvasSize;t.matchCanvasSize=function(a){r.call(t,a),t.pickingFrameBuffer.setFramebufferAttachmentSizes(t.canvasWidth,t.canvasHeight),t.pickingFrameBuffer.needsDraw=!0}}t.findNearestElements=function(a,s,o,l){return qK(t,a,s)};{var n=t.invalidateCachedZSortedEles;t.invalidateCachedZSortedEles=function(){n.call(t),t.pickingFrameBuffer.needsDraw=!0}}{var i=t.notify;t.notify=function(a,s){i.call(t,a,s),a==="viewport"||a==="bounds"?t.pickingFrameBuffer.needsDraw=!0:a==="background"&&t.drawing.invalidate(s,{type:"node-body"})}}}function zK(t){var e=t.data.contexts[t.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function VK(t){var e=function(n){n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.canvasWidth,t.canvasHeight),n.restore()};e(t.data.contexts[t.NODE]),e(t.data.contexts[t.DRAG])}function $K(t){var e=t.canvasWidth,r=t.canvasHeight,n=v3(t),i=n.pan,a=n.zoom,s=I2();Iv(s,s,[i.x,i.y]),J5(s,s,[a,a]);var o=I2();TK(o,e,r);var l=I2();return EK(l,o,s),l}function d7(t,e){var r=t.canvasWidth,n=t.canvasHeight,i=v3(t),a=i.pan,s=i.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,r,n),e.translate(a.x,a.y),e.scale(s,s)}function UK(t,e){t.drawSelectionRectangle(e,function(r){return d7(t,r)})}function GK(t){var e=t.data.contexts[t.NODE];e.save(),d7(t,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function HK(t){var e=function(i,a,s){for(var o=i.atlasManager.getAtlasCollection(a),l=t.data.contexts[t.NODE],u=o.atlases,c=0;c<u.length;c++){var d=u[c],h=d.canvas;if(h){var m=h.width,v=h.height,x=m*c,y=h.height*s,b=.4;l.save(),l.scale(b,b),l.drawImage(h,x,y),l.strokeStyle="black",l.rect(x,y,m,v),l.stroke(),l.restore()}}},r=0;e(t.drawing,"node",r++),e(t.drawing,"label",r++)}function WK(t,e,r,n,i){var a,s,o,l,u=v3(t),c=u.pan,d=u.zoom;{var h=vK(t,c,d,e,r),m=zr(h,2),v=m[0],x=m[1],y=6;a=v-y/2,s=x-y/2,o=y,l=y}if(o===0||l===0)return[];var b=t.data.contexts[t.WEBGL];b.bindFramebuffer(b.FRAMEBUFFER,t.pickingFrameBuffer),t.pickingFrameBuffer.needsDraw&&(b.viewport(0,0,b.canvas.width,b.canvas.height),f7(t,null,Bh.PICKING),t.pickingFrameBuffer.needsDraw=!1);var S=o*l,w=new Uint8Array(S*4);b.readPixels(a,s,o,l,b.RGBA,b.UNSIGNED_BYTE,w),b.bindFramebuffer(b.FRAMEBUFFER,null);for(var k=new Set,N=0;N<S;N++){var T=w.slice(N*4,N*4+4),j=bK(T)-1;j>=0&&k.add(j)}return k}function qK(t,e,r){var n=WK(t,e,r),i=t.getCachedZSortedEles(),a,s,o=vi(n),l;try{for(o.s();!(l=o.n()).done;){var u=l.value,c=i[u];if(!a&&c.isNode()&&(a=c),!s&&c.isEdge()&&(s=c),a&&s)break}}catch(d){o.e(d)}finally{o.f()}return[a,s].filter(Boolean)}function V2(t,e,r){var n=t.drawing;e+=1,r.isNode()?(n.drawNode(r,e,"node-underlay"),n.drawNode(r,e,"node-body"),n.drawTexture(r,e,"label"),n.drawNode(r,e,"node-overlay")):(n.drawEdgeLine(r,e),n.drawEdgeArrow(r,e,"source"),n.drawEdgeArrow(r,e,"target"),n.drawTexture(r,e,"label"),n.drawTexture(r,e,"edge-source-label"),n.drawTexture(r,e,"edge-target-label"))}function f7(t,e,r){var n;t.webglDebug&&(n=performance.now());var i=t.drawing,a=0;if(r.screen&&t.data.canvasNeedsRedraw[t.SELECT_BOX]&&UK(t,e),t.data.canvasNeedsRedraw[t.NODE]||r.picking){var s=t.data.contexts[t.WEBGL];r.screen?(s.clearColor(0,0,0,0),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA)):s.disable(s.BLEND),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.viewport(0,0,s.canvas.width,s.canvas.height);var o=$K(t),l=t.getCachedZSortedEles();if(a=l.length,i.startFrame(o,r),r.screen){for(var u=0;u<l.nondrag.length;u++)V2(t,u,l.nondrag[u]);for(var c=0;c<l.drag.length;c++)V2(t,c,l.drag[c])}else if(r.picking)for(var d=0;d<l.length;d++)V2(t,d,l[d]);i.endFrame(),r.screen&&t.webglDebugShowAtlases&&(GK(t),HK(t)),t.data.canvasNeedsRedraw[t.NODE]=!1,t.data.canvasNeedsRedraw[t.DRAG]=!1}if(t.webglDebug){var h=performance.now(),m=!1,v=Math.ceil(h-n),x=i.getDebugInfo(),y=["".concat(a," elements"),"".concat(x.totalInstances," instances"),"".concat(x.batchCount," batches"),"".concat(x.totalAtlases," atlases"),"".concat(x.wrappedCount," wrapped textures"),"".concat(x.simpleCount," simple shapes")].join(", ");if(m)console.log("WebGL (".concat(r.name,") - time ").concat(v,"ms, ").concat(y));else{console.log("WebGL (".concat(r.name,") - frame time ").concat(v,"ms")),console.log("Totals:"),console.log("  ".concat(y)),console.log("Texture Atlases Used:");var b=x.atlasInfo,S=vi(b),w;try{for(S.s();!(w=S.n()).done;){var k=w.value;console.log("  ".concat(k.type,": ").concat(k.keyCount," keys, ").concat(k.atlasCount," atlases"))}}catch(N){S.e(N)}finally{S.f()}console.log("")}}t.data.gc&&(console.log("Garbage Collect!"),t.data.gc=!1,i.gc())}var Rl={};Rl.drawPolygonPath=function(t,e,r,n,i,a){var s=n/2,o=i/2;t.beginPath&&t.beginPath(),t.moveTo(e+s*a[0],r+o*a[1]);for(var l=1;l<a.length/2;l++)t.lineTo(e+s*a[l*2],r+o*a[l*2+1]);t.closePath()};Rl.drawRoundPolygonPath=function(t,e,r,n,i,a,s){s.forEach(function(o){return qR(t,o)}),t.closePath()};Rl.drawRoundRectanglePath=function(t,e,r,n,i,a){var s=n/2,o=i/2,l=a==="auto"?vl(n,i):Math.min(a,o,s);t.beginPath&&t.beginPath(),t.moveTo(e,r-o),t.arcTo(e+s,r-o,e+s,r,l),t.arcTo(e+s,r+o,e,r+o,l),t.arcTo(e-s,r+o,e-s,r,l),t.arcTo(e-s,r-o,e,r-o,l),t.lineTo(e,r-o),t.closePath()};Rl.drawBottomRoundRectanglePath=function(t,e,r,n,i,a){var s=n/2,o=i/2,l=a==="auto"?vl(n,i):a;t.beginPath&&t.beginPath(),t.moveTo(e,r-o),t.lineTo(e+s,r-o),t.lineTo(e+s,r),t.arcTo(e+s,r+o,e,r+o,l),t.arcTo(e-s,r+o,e-s,r,l),t.lineTo(e-s,r-o),t.lineTo(e,r-o),t.closePath()};Rl.drawCutRectanglePath=function(t,e,r,n,i,a,s){var o=n/2,l=i/2,u=s==="auto"?n3():s;t.beginPath&&t.beginPath(),t.moveTo(e-o+u,r-l),t.lineTo(e+o-u,r-l),t.lineTo(e+o,r-l+u),t.lineTo(e+o,r+l-u),t.lineTo(e+o-u,r+l),t.lineTo(e-o+u,r+l),t.lineTo(e-o,r+l-u),t.lineTo(e-o,r-l+u),t.closePath()};Rl.drawBarrelPath=function(t,e,r,n,i){var a=n/2,s=i/2,o=e-a,l=e+a,u=r-s,c=r+s,d=B5(n,i),h=d.widthOffset,m=d.heightOffset,v=d.ctrlPtOffsetPct*h;t.beginPath&&t.beginPath(),t.moveTo(o,u+m),t.lineTo(o,c-m),t.quadraticCurveTo(o+v,c,o+h,c),t.lineTo(l-h,c),t.quadraticCurveTo(l-v,c,l,c-m),t.lineTo(l,u+m),t.quadraticCurveTo(l-v,u,l-h,u),t.lineTo(o+h,u),t.quadraticCurveTo(o+v,u,o,u+m),t.closePath()};var e9=Math.sin(0),t9=Math.cos(0),Z5={},ek={},h7=Math.PI/40;for(var Oc=0*Math.PI;Oc<2*Math.PI;Oc+=h7)Z5[Oc]=Math.sin(Oc),ek[Oc]=Math.cos(Oc);Rl.drawEllipsePath=function(t,e,r,n,i){if(t.beginPath&&t.beginPath(),t.ellipse)t.ellipse(e,r,n/2,i/2,0,0,2*Math.PI);else for(var a,s,o=n/2,l=i/2,u=0*Math.PI;u<2*Math.PI;u+=h7)a=e-o*Z5[u]*e9+o*ek[u]*t9,s=r+l*ek[u]*e9+l*Z5[u]*t9,u===0?t.moveTo(a,s):t.lineTo(a,s);t.closePath()};var lm={};lm.createBuffer=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,[r,r.getContext("2d")]};lm.bufferCanvasImage=function(t){var e=this.cy,r=e.mutableElements(),n=r.boundingBox(),i=this.findContainerClientCoords(),a=t.full?Math.ceil(n.w):i[2],s=t.full?Math.ceil(n.h):i[3],o=Ee(t.maxWidth)||Ee(t.maxHeight),l=this.getPixelRatio(),u=1;if(t.scale!==void 0)a*=t.scale,s*=t.scale,u=t.scale;else if(o){var c=1/0,d=1/0;Ee(t.maxWidth)&&(c=u*t.maxWidth/a),Ee(t.maxHeight)&&(d=u*t.maxHeight/s),u=Math.min(c,d),a*=u,s*=u}o||(a*=l,s*=l,u*=l);var h=document.createElement("canvas");h.width=a,h.height=s,h.style.width=a+"px",h.style.height=s+"px";var m=h.getContext("2d");if(a>0&&s>0){m.clearRect(0,0,a,s),m.globalCompositeOperation="source-over";var v=this.getCachedZSortedEles();if(t.full)m.translate(-n.x1*u,-n.y1*u),m.scale(u,u),this.drawElements(m,v),m.scale(1/u,1/u),m.translate(n.x1*u,n.y1*u);else{var x=e.pan(),y={x:x.x*u,y:x.y*u};u*=e.zoom(),m.translate(y.x,y.y),m.scale(u,u),this.drawElements(m,v),m.scale(1/u,1/u),m.translate(-y.x,-y.y)}t.bg&&(m.globalCompositeOperation="destination-over",m.fillStyle=t.bg,m.rect(0,0,a,s),m.fill())}return h};function KK(t,e){for(var r=atob(t),n=new ArrayBuffer(r.length),i=new Uint8Array(n),a=0;a<r.length;a++)i[a]=r.charCodeAt(a);return new Blob([n],{type:e})}function r9(t){var e=t.indexOf(",");return t.substr(e+1)}function p7(t,e,r){var n=function(){return e.toDataURL(r,t.quality)};switch(t.output){case"blob-promise":return new nf(function(i,a){try{e.toBlob(function(s){s!=null?i(s):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},r,t.quality)}catch(s){a(s)}});case"blob":return KK(r9(n()),r);case"base64":return r9(n());case"base64uri":default:return n()}}lm.png=function(t){return p7(t,this.bufferCanvasImage(t),"image/png")};lm.jpg=function(t){return p7(t,this.bufferCanvasImage(t),"image/jpeg")};var m7={};m7.nodeShapeImpl=function(t,e,r,n,i,a,s,o){switch(t){case"ellipse":return this.drawEllipsePath(e,r,n,i,a);case"polygon":return this.drawPolygonPath(e,r,n,i,a,s);case"round-polygon":return this.drawRoundPolygonPath(e,r,n,i,a,s,o);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,r,n,i,a,o);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,r,n,i,a,s,o);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,r,n,i,a,o);case"barrel":return this.drawBarrelPath(e,r,n,i,a)}};var YK=g7,mt=g7.prototype;mt.CANVAS_LAYERS=3;mt.SELECT_BOX=0;mt.DRAG=1;mt.NODE=2;mt.WEBGL=3;mt.CANVAS_TYPES=["2d","2d","2d","webgl2"];mt.BUFFER_COUNT=3;mt.TEXTURE_BUFFER=0;mt.MOTIONBLUR_BUFFER_NODE=1;mt.MOTIONBLUR_BUFFER_DRAG=2;function g7(t){var e=this,r=e.cy.window(),n=r.document;t.webgl&&(mt.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(mt.CANVAS_LAYERS),contexts:new Array(mt.CANVAS_LAYERS),canvasNeedsRedraw:new Array(mt.CANVAS_LAYERS),bufferCanvases:new Array(mt.BUFFER_COUNT),bufferContexts:new Array(mt.CANVAS_LAYERS)};var i="-webkit-tap-highlight-color",a="rgba(0,0,0,0)";e.data.canvasContainer=n.createElement("div");var s=e.data.canvasContainer.style;e.data.canvasContainer.style[i]=a,s.position="relative",s.zIndex="0",s.overflow="hidden";var o=t.cy.container();o.appendChild(e.data.canvasContainer),o.style[i]=a;var l={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};U$()&&(l["-ms-touch-action"]="none",l["touch-action"]="none");for(var u=0;u<mt.CANVAS_LAYERS;u++){var c=e.data.canvases[u]=n.createElement("canvas"),d=mt.CANVAS_TYPES[u];e.data.contexts[u]=c.getContext(d),e.data.contexts[u]||lr("Could not create canvas of type "+d),Object.keys(l).forEach(function(ie){c.style[ie]=l[ie]}),c.style.position="absolute",c.setAttribute("data-id","layer"+u),c.style.zIndex=String(mt.CANVAS_LAYERS-u),e.data.canvasContainer.appendChild(c),e.data.canvasNeedsRedraw[u]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[mt.NODE].setAttribute("data-id","layer"+mt.NODE+"-node"),e.data.canvases[mt.SELECT_BOX].setAttribute("data-id","layer"+mt.SELECT_BOX+"-selectbox"),e.data.canvases[mt.DRAG].setAttribute("data-id","layer"+mt.DRAG+"-drag"),e.data.canvases[mt.WEBGL]&&e.data.canvases[mt.WEBGL].setAttribute("data-id","layer"+mt.WEBGL+"-webgl");for(var u=0;u<mt.BUFFER_COUNT;u++)e.data.bufferCanvases[u]=n.createElement("canvas"),e.data.bufferContexts[u]=e.data.bufferCanvases[u].getContext("2d"),e.data.bufferCanvases[u].style.position="absolute",e.data.bufferCanvases[u].setAttribute("data-id","buffer"+u),e.data.bufferCanvases[u].style.zIndex=String(-u-1),e.data.bufferCanvases[u].style.visibility="hidden";e.pathsEnabled=!0;var h=ei(),m=function($){return{x:($.x1+$.x2)/2,y:($.y1+$.y2)/2}},v=function($){return{x:-$.w/2,y:-$.h/2}},x=function($){var q=$[0]._private,te=q.oldBackgroundTimestamp===q.backgroundTimestamp;return!te},y=function($){return $[0]._private.nodeKey},b=function($){return $[0]._private.labelStyleKey},S=function($){return $[0]._private.sourceLabelStyleKey},w=function($){return $[0]._private.targetLabelStyleKey},k=function($,q,te,Z,le){return e.drawElement($,q,te,!1,!1,le)},N=function($,q,te,Z,le){return e.drawElementText($,q,te,Z,"main",le)},T=function($,q,te,Z,le){return e.drawElementText($,q,te,Z,"source",le)},j=function($,q,te,Z,le){return e.drawElementText($,q,te,Z,"target",le)},M=function($){return $.boundingBox(),$[0]._private.bodyBounds},A=function($){return $.boundingBox(),$[0]._private.labelBounds.main||h},P=function($){return $.boundingBox(),$[0]._private.labelBounds.source||h},D=function($){return $.boundingBox(),$[0]._private.labelBounds.target||h},R=function($,q){return q},I=function($){return m(M($))},U=function($,q,te){var Z=$?$+"-":"";return{x:q.x+te.pstyle(Z+"text-margin-x").pfValue,y:q.y+te.pstyle(Z+"text-margin-y").pfValue}},B=function($,q,te){var Z=$[0]._private.rscratch;return{x:Z[q],y:Z[te]}},z=function($){return U("",B($,"labelX","labelY"),$)},F=function($){return U("source",B($,"sourceLabelX","sourceLabelY"),$)},V=function($){return U("target",B($,"targetLabelX","targetLabelY"),$)},J=function($){return v(M($))},Y=function($){return v(P($))},L=function($){return v(D($))},G=function($){var q=A($),te=v(A($));if($.isNode()){switch($.pstyle("text-halign").value){case"left":te.x=-q.w-(q.leftPad||0);break;case"right":te.x=-(q.rightPad||0);break}switch($.pstyle("text-valign").value){case"top":te.y=-q.h-(q.topPad||0);break;case"bottom":te.y=-(q.botPad||0);break}}return te},ee=e.data.eleTxrCache=new bh(e,{getKey:y,doesEleInvalidateKey:x,drawElement:k,getBoundingBox:M,getRotationPoint:I,getRotationOffset:J,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),re=e.data.lblTxrCache=new bh(e,{getKey:b,drawElement:N,getBoundingBox:A,getRotationPoint:z,getRotationOffset:G,isVisible:R}),se=e.data.slbTxrCache=new bh(e,{getKey:S,drawElement:T,getBoundingBox:P,getRotationPoint:F,getRotationOffset:Y,isVisible:R}),de=e.data.tlbTxrCache=new bh(e,{getKey:w,drawElement:j,getBoundingBox:D,getRotationPoint:V,getRotationOffset:L,isVisible:R}),W=e.data.lyrTxrCache=new n7(e);e.onUpdateEleCalcs(function($,q){ee.invalidateElements(q),re.invalidateElements(q),se.invalidateElements(q),de.invalidateElements(q),W.invalidateElements(q);for(var te=0;te<q.length;te++){var Z=q[te]._private;Z.oldBackgroundTimestamp=Z.backgroundTimestamp}});var ne=function($){for(var q=0;q<$.length;q++)W.enqueueElementRefinement($[q].ele)};ee.onDequeue(ne),re.onDequeue(ne),se.onDequeue(ne),de.onDequeue(ne),t.webgl&&e.initWebgl(t,{getStyleKey:y,getLabelKey:b,getSourceLabelKey:S,getTargetLabelKey:w,drawElement:k,drawLabel:N,drawSourceLabel:T,drawTargetLabel:j,getElementBox:M,getLabelBox:A,getSourceLabelBox:P,getTargetLabelBox:D,getElementRotationPoint:I,getElementRotationOffset:J,getLabelRotationPoint:z,getSourceLabelRotationPoint:F,getTargetLabelRotationPoint:V,getLabelRotationOffset:G,getSourceLabelRotationOffset:Y,getTargetLabelRotationOffset:L})}mt.redrawHint=function(t,e){var r=this;switch(t){case"eles":r.data.canvasNeedsRedraw[mt.NODE]=e;break;case"drag":r.data.canvasNeedsRedraw[mt.DRAG]=e;break;case"select":r.data.canvasNeedsRedraw[mt.SELECT_BOX]=e;break;case"gc":r.data.gc=!0;break}};var XK=typeof Path2D<"u";mt.path2dEnabled=function(t){if(t===void 0)return this.pathsEnabled;this.pathsEnabled=!!t};mt.usePaths=function(){return XK&&this.pathsEnabled};mt.setImgSmoothing=function(t,e){t.imageSmoothingEnabled!=null?t.imageSmoothingEnabled=e:(t.webkitImageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e)};mt.getImgSmoothing=function(t){return t.imageSmoothingEnabled!=null?t.imageSmoothingEnabled:t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled};mt.makeOffscreenCanvas=function(t,e){var r;if((typeof OffscreenCanvas>"u"?"undefined":Zr(OffscreenCanvas))!=="undefined")r=new OffscreenCanvas(t,e);else{var n=this.cy.window(),i=n.document;r=i.createElement("canvas"),r.width=t,r.height=e}return r};[i7,gs,so,g3,ec,Al,ai,u7,Rl,lm,m7].forEach(function(t){Qe(mt,t)});var QK=[{name:"null",impl:GR},{name:"base",impl:e7},{name:"canvas",impl:YK}],JK=[{type:"layout",extensions:kq},{type:"renderer",extensions:QK}],v7={},y7={};function x7(t,e,r){var n=r,i=function(M){Lt("Can not register `"+e+"` for `"+t+"` since `"+M+"` already exists in the prototype and can not be overridden")};if(t==="core"){if(Np.prototype[e])return i(e);Np.prototype[e]=r}else if(t==="collection"){if(Tn.prototype[e])return i(e);Tn.prototype[e]=r}else if(t==="layout"){for(var a=function(M){this.options=M,r.call(this,M),Mt(this._private)||(this._private={}),this._private.cy=M.cy,this._private.listeners=[],this.createEmitter()},s=a.prototype=Object.create(r.prototype),o=[],l=0;l<o.length;l++){var u=o[l];s[u]=s[u]||function(){return this}}s.start&&!s.run?s.run=function(){return this.start(),this}:!s.start&&s.run&&(s.start=function(){return this.run(),this});var c=r.prototype.stop;s.stop=function(){var j=this.options;if(j&&j.animate){var M=this.animations;if(M)for(var A=0;A<M.length;A++)M[A].stop()}return c?c.call(this):this.emit("layoutstop"),this},s.destroy||(s.destroy=function(){return this}),s.cy=function(){return this._private.cy};var d=function(M){return M._private.cy},h={addEventFields:function(M,A){A.layout=M,A.cy=d(M),A.target=M},bubble:function(){return!0},parent:function(M){return d(M)}};Qe(s,{createEmitter:function(){return this._private.emitter=new sx(h,this),this},emitter:function(){return this._private.emitter},on:function(M,A){return this.emitter().on(M,A),this},one:function(M,A){return this.emitter().one(M,A),this},once:function(M,A){return this.emitter().one(M,A),this},removeListener:function(M,A){return this.emitter().removeListener(M,A),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(M,A){return this.emitter().emit(M,A),this}}),It.eventAliasesOn(s),n=a}else if(t==="renderer"&&e!=="null"&&e!=="base"){var m=b7("renderer","base"),v=m.prototype,x=r,y=r.prototype,b=function(){m.apply(this,arguments),x.apply(this,arguments)},S=b.prototype;for(var w in v){var k=v[w],N=y[w]!=null;if(N)return i(w);S[w]=k}for(var T in y)S[T]=y[T];v.clientFunctions.forEach(function(j){S[j]=S[j]||function(){lr("Renderer does not implement `renderer."+j+"()` on its prototype")}}),n=b}else if(t==="__proto__"||t==="constructor"||t==="prototype")return lr(t+" is an illegal type to be registered, possibly lead to prototype pollutions");return BA({map:v7,keys:[t,e],value:n})}function b7(t,e){return FA({map:v7,keys:[t,e]})}function ZK(t,e,r,n,i){return BA({map:y7,keys:[t,e,r,n],value:i})}function eY(t,e,r,n){return FA({map:y7,keys:[t,e,r,n]})}var tk=function(){if(arguments.length===2)return b7.apply(null,arguments);if(arguments.length===3)return x7.apply(null,arguments);if(arguments.length===4)return eY.apply(null,arguments);if(arguments.length===5)return ZK.apply(null,arguments);lr("Invalid extension access syntax")};Np.prototype.extension=tk;JK.forEach(function(t){t.extensions.forEach(function(e){x7(t.type,e.name,e.impl)})});var R0=function(){if(!(this instanceof R0))return new R0;this.length=0},$u=R0.prototype;$u.instanceString=function(){return"stylesheet"};$u.selector=function(t){var e=this.length++;return this[e]={selector:t,properties:[]},this};$u.css=function(t,e){var r=this.length-1;if(Ke(t))this[r].properties.push({name:t,value:e});else if(Mt(t))for(var n=t,i=Object.keys(n),a=0;a<i.length;a++){var s=i[a],o=n[s];if(o!=null){var l=pn.properties[s]||pn.properties[Xy(s)];if(l!=null){var u=l.name,c=o;this[r].properties.push({name:u,value:c})}}}return this};$u.style=$u.css;$u.generateStyle=function(t){var e=new pn(t);return this.appendToStyle(e)};$u.appendToStyle=function(t){for(var e=0;e<this.length;e++){var r=this[e],n=r.selector,i=r.properties;t.selector(n);for(var a=0;a<i.length;a++){var s=i[a];t.css(s.name,s.value)}}return t};var tY="3.33.1",Uu=function(e){if(e===void 0&&(e={}),Mt(e))return new Np(e);if(Ke(e))return tk.apply(tk,arguments)};Uu.use=function(t){var e=Array.prototype.slice.call(arguments,1);return e.unshift(Uu),t.apply(null,e),this};Uu.warnings=function(t){return WA(t)};Uu.version=tY;Uu.stylesheet=Uu.Stylesheet=R0;const{string:Ug,array:n9,object:Gg,number:th,bool:Ti,oneOfType:Ic,any:Hg,func:rh}=N$,rY={id:Ug,className:Ug,style:Ic([Ug,Gg]),elements:Ic([n9,Hg]),stylesheet:Ic([n9,Hg]),layout:Ic([Gg,Hg]),pan:Ic([Gg,Hg]),zoom:th,panningEnabled:Ti,userPanningEnabled:Ti,minZoom:th,maxZoom:th,zoomingEnabled:Ti,userZoomingEnabled:Ti,boxSelectionEnabled:Ti,autoungrabify:Ti,autolock:Ti,autounselectify:Ti,get:rh,toJson:rh,diff:rh,forEach:rh,cy:rh,headless:Ti,styleEnabled:Ti,hideEdgesOnViewport:Ti,textureOnViewport:Ti,motionBlur:Ti,motionBlurOpacity:th,wheelSensitivity:th,pixelRatio:Ic([Ug,Gg])},w7=(t,e)=>{if(((a,s)=>a==null||s==null)(t,e)&&(t!=null||e!=null))return!0;if(t===e)return!1;if(typeof t!="object"||typeof e!="object")return t!==e;const r=Object.keys(t),n=Object.keys(e),i=a=>t[a]!==e[a];return r.length!==n.length||!(!r.some(i)&&!n.some(i))},Na=(t,e)=>t!=null?t[e]:null,nY={diff:w7,get:Na,toJson:t=>t,forEach:(t,e)=>t.forEach(e),elements:[{data:{id:"a",label:"Example node A"}},{data:{id:"b",label:"Example node B"}},{data:{id:"e",source:"a",target:"b"}}],stylesheet:[{selector:"node",style:{label:"data(label)"}}],zoom:1,pan:{x:0,y:0}},Wg=(t,e,r,n)=>r(Na(t,n),Na(e,n)),iY=(t,e,r,n,i,a,s)=>{t.batch(()=>{(n===w7||Wg(e,r,n,"elements"))&&lY(t,Na(e,"elements"),Na(r,"elements"),i,a,s,n),Wg(e,r,n,"stylesheet")&&oY(t,Na(e,"stylesheet"),Na(r,"stylesheet"),i),["zoom","minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","pan","panningEnabled","userPanningEnabled","boxSelectionEnabled","autoungrabify","autolock","autounselectify"].forEach(o=>{Wg(e,r,n,o)&&aY(t,o,Na(e,o),Na(r,o),i)})}),Wg(e,r,n,"layout")&&sY(t,Na(e,"layout"),Na(r,"layout"),i)},aY=(t,e,r,n,i)=>{t[e](i(n))},sY=(t,e,r,n)=>{const i=n(r);i!=null&&t.layout(i).run()},oY=(t,e,r,n)=>{const i=t.style();i!=null&&i.fromJson(n(r)).update()},lY=(t,e,r,n,i,a,s)=>{const o=[],l=t.collection(),u=[],c={},d={},h=m=>i(i(m,"data"),"id");a(r,m=>{const v=h(m);d[v]=m}),e!=null&&a(e,m=>{const v=h(m);c[v]=m,(x=>d[x]!=null)(v)||l.merge(t.getElementById(v))}),a(r,m=>{const v=h(m),x=(y=>c[y])(v);(y=>c[y]!=null)(v)?u.push({ele1:x,ele2:m}):o.push(n(m))}),l.length>0&&t.remove(l),o.length>0&&t.add(o),u.forEach(({ele1:m,ele2:v})=>uY(t,m,v,n,i,s))},uY=(t,e,r,n,i,a)=>{const s=i(i(r,"data"),"id"),o=t.getElementById(s),l={};["data","position","selected","selectable","locked","grabbable","classes"].forEach(c=>{const d=i(r,c);a(d,i(e,c))&&(l[c]=n(d))});const u=i(r,"scratch");a(u,i(e,"scratch"))&&o.scratch(n(u)),Object.keys(l).length>0&&o.json(l)};class cY extends kt.Component{static get propTypes(){return rY}static get defaultProps(){return nY}static normalizeElements(e){if(e.length!=null)return e;{let{nodes:r,edges:n}=e;return r==null&&(r=[]),n==null&&(n=[]),r.concat(n)}}constructor(e){super(e),this.displayName="CytoscapeComponent",this.containerRef=kt.createRef()}componentDidMount(){const e=this.containerRef.current,{global:r,headless:n,styleEnabled:i,hideEdgesOnViewport:a,textureOnViewport:s,motionBlur:o,motionBlurOpacity:l,wheelSensitivity:u,pixelRatio:c}=this.props,d=this._cy=new Uu({container:e,headless:n,styleEnabled:i,hideEdgesOnViewport:a,textureOnViewport:s,motionBlur:o,motionBlurOpacity:l,wheelSensitivity:u,pixelRatio:c});r&&(window[r]=d),this.updateCytoscape(null,this.props)}updateCytoscape(e,r){const n=this._cy,{diff:i,toJson:a,get:s,forEach:o}=r;iY(n,e,r,i,a,s,o),r.cy!=null&&r.cy(n)}componentDidUpdate(e){this.updateCytoscape(e,this.props)}componentWillUnmount(){this._cy.destroy()}render(){const{id:e,className:r,style:n}=this.props;return kt.createElement("div",{ref:this.containerRef,id:e,className:r,style:n})}}const dY=[{selector:"node",style:{"background-color":"#1f2937",label:"data(label)",color:"#cbd5e1","font-family":"Outfit, sans-serif","font-size":"12px","text-valign":"bottom","text-margin-y":8,width:40,height:40,"border-width":2,"border-color":"#475569","text-outline-width":2,"text-outline-color":"#050508","overlay-padding":6,"z-index":10}},{selector:'node[category="Individual"]',style:{"background-color":"rgba(49, 46, 129, 0.9)","border-color":"#6366f1",shape:"ellipse",width:50,height:50}},{selector:'node[category="Location"]',style:{"background-color":"rgba(6, 78, 59, 0.9)","border-color":"#10b981",shape:"hexagon",width:60,height:60}},{selector:'node[category="Group"]',style:{"background-color":"rgba(88, 28, 135, 0.9)","border-color":"#a855f7",shape:"round-rectangle"}},{selector:"edge",style:{width:2,"line-color":"#334155","target-arrow-color":"#334155","target-arrow-shape":"triangle","curve-style":"bezier"}},{selector:":selected",style:{"border-width":4,"border-color":"#fafafa","line-color":"#fafafa","target-arrow-color":"#fafafa","z-index":999}}],fY=()=>{Bi();const[t,e]=K.useState([]),[r,n]=K.useState([]),[i,a]=K.useState(""),[s,o]=K.useState(!0),l=K.useRef(null);K.useEffect(()=>{u()},[]);const u=async()=>{o(!0);try{const m=await Ne.get("/world-bible/entities");n(m),c(m)}catch(m){console.error("Failed to load graph data",m)}finally{o(!1)}},c=m=>{const v=m.map(y=>({data:{id:y.id.toString(),label:y.nombre,category:y.categoria||"Generic",type:y.tipoEspecial}})),x=[];m.forEach(y=>{y.valores&&Array.isArray(y.valores)&&y.valores.forEach(b=>{var S;((S=b.plantilla)==null?void 0:S.tipo)==="entity_link"&&b.valor&&x.push({data:{source:y.id.toString(),target:b.valor.toString()}})})}),e([...v,...x])},d=()=>{if(!l.current)return;l.current.layout({name:"cose",animate:!0,padding:50,nodeOverlap:20,componentSpacing:100}).run()};K.useEffect(()=>{l.current&&d()},[t]);const h=()=>{if(!l.current||!i)return;const m=l.current;if(m.elements().removeClass("highlighted faded"),i.length>0){const v=m.nodes().filter(x=>x.data("label").toLowerCase().includes(i.toLowerCase()));v.length>0&&(m.elements().not(v).addClass("faded"),v.addClass("highlighted"),m.animate({fit:{eles:v,padding:50}}))}};return f.jsxs("div",{className:"w-full h-full flex bg-background-dark relative overflow-hidden font-display text-foreground",children:[f.jsx("div",{className:"absolute top-4 left-4 z-20 w-80 pointer-events-none",children:f.jsxs("div",{className:"bg-card/90 backdrop-blur-md border border-border/50 rounded-xl p-4 shadow-2xl pointer-events-auto space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("div",{className:"size-8 rounded bg-primary flex items-center justify-center",children:f.jsx("span",{className:"material-symbols-outlined text-primary-foreground",children:"hub"})}),f.jsx("h2",{className:"font-bold text-lg tracking-tight",children:"Graph View"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{className:"bg-accent/50 border border-input rounded-md px-3 py-2 text-sm w-full outline-none focus:ring-1 focus:ring-primary",placeholder:"Find node...",value:i,onChange:m=>a(m.target.value),onKeyDown:m=>m.key==="Enter"&&h()}),f.jsx("button",{onClick:h,className:"bg-primary/20 hover:bg-primary/30 text-primary border border-primary/50 rounded-md px-3 transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"search"})})]}),f.jsxs("div",{className:"flex flex-wrap gap-2 text-[10px] uppercase font-bold text-muted-foreground pt-2 border-t border-border/50",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"size-2 rounded-full bg-indigo-500"})," Individual"]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"size-2 rounded-full bg-emerald-500"})," Location"]}),f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"size-2 rounded-full bg-purple-500"})," Group"]})]}),f.jsx("div",{className:"pt-2",children:f.jsxs(Wt,{onClick:d,size:"sm",variant:"outline",className:"w-full text-xs",children:[f.jsx("span",{className:"material-symbols-outlined text-sm mr-2",children:"refresh"}),"Re-Layout"]})})]})}),t.length===0&&!s&&f.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10 pointer-events-none",children:f.jsx("div",{className:"text-muted text-lg",children:"No entities found. Create some in the Bible!"})}),f.jsx(cY,{elements:t,stylesheet:dY,style:{width:"100%",height:"100%"},cy:m=>{l.current=m},minZoom:.2,maxZoom:3,wheelSensitivity:.3,className:"bg-background-dark"})]})},hY=({id:t})=>{const{id:e}=Bi(),r=Li(),[n,i]=K.useState("overview"),[a,s]=K.useState(null),[o,l]=K.useState(!0),[u,c]=K.useState(!1);K.useEffect(()=>{d()},[t]);const d=async()=>{l(!0);try{const x=await Ne.get(`/bd/entidadindividual/${t}`);s(x)}catch(x){console.error("Error loading character:",x)}finally{l(!1)}},h=async()=>{try{await Ne.patch("/bd/modificar",{...a,tipoEntidad:"entidadindividual"}),c(!1)}catch(x){console.error("Error saving:",x)}},m=async()=>{if(window.confirm("Move this character to the Trash Bin?"))try{await Ne.delete(`/bd/entidadindividual/${t}`),r(`/project/${e}`)}catch(x){console.error(x)}},v=(x,y)=>{s(b=>({...b,[x]:y}))};return o?f.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Summoning entity..."}):a?f.jsxs("div",{className:"flex h-full",children:[f.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto custom-scrollbar p-8 gap-6",children:[f.jsxs("div",{className:"flex items-start gap-6",children:[f.jsx("div",{className:"relative",children:f.jsx(x0,{url:a.imagenUrl||"https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1976&auto=format&fit=crop",size:"xl",className:"rounded-2xl border-2 border-primary shadow-[0_0_30px_rgba(99,102,242,0.3)]"})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[f.jsx("span",{className:"text-xs font-bold text-primary bg-primary/10 px-2 py-0.5 rounded border border-primary/20",children:a.estado||"ACTIVE"}),f.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:a.tipo||"Unknown"})]}),f.jsxs("h1",{className:"text-4xl font-bold text-white mb-2",children:[a.nombre," ",a.apellidos]}),f.jsx("p",{className:"text-lg text-slate-300",children:a.origen||"Traveling the void"})]}),f.jsxs("div",{className:"flex gap-2",children:[!u&&f.jsx(Wt,{className:"border-red-500/30 text-red-400 hover:bg-red-500/10",icon:"delete",onClick:m,children:"Delete"}),f.jsx(Wt,{variant:"secondary",icon:u?"close":"edit",onClick:()=>c(!u),children:u?"Cancel":"Edit Profile"}),u&&f.jsx(Wt,{variant:"primary",icon:"save",onClick:h,children:"Save Changes"})]})]}),f.jsx("div",{className:"border-b border-glass-border flex gap-6",children:["Overview","Biography","Attributes & Stats","Relationships"].map(x=>f.jsx("button",{onClick:()=>i(x.toLowerCase()),className:`pb-4 px-2 text-sm font-bold border-b-2 transition-colors ${n===x.toLowerCase()?"text-primary border-primary":"text-slate-500 border-transparent hover:text-white"}`,children:x},x))}),f.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[f.jsx("div",{className:"col-span-1 space-y-6",children:f.jsxs(Et,{className:"p-4",children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"fingerprint"})," Identity"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Name"}),f.jsx("input",{type:"text",value:a.nombre,onChange:x=>v("nombre",x.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Surnames"}),f.jsx("input",{type:"text",value:a.apellidos||"",onChange:x=>v("apellidos",x.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Type / Species"}),f.jsx("input",{type:"text",value:a.tipo||"",onChange:x=>v("tipo",x.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Origin"}),f.jsx("input",{type:"text",value:a.origen||"",onChange:x=>v("origen",x.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]})]})]})}),f.jsx("div",{className:"col-span-2 space-y-6",children:f.jsxs(Et,{className:"p-6 relative overflow-hidden group",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"})," Narrative & Connections"]}),!u&&f.jsx("span",{className:"text-[10px] text-slate-600 bg-white/5 px-2 py-1 rounded",children:"Read Only"})]}),f.jsxs("div",{className:"mb-8",children:[f.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mb-3 opacity-80",children:"Biography"}),f.jsx("textarea",{value:a.descripcion||"",onChange:x=>v("descripcion",x.target.value),readOnly:!u,className:`w-full bg-transparent border-none outline-none text-slate-300 text-sm leading-relaxed resize-none custom-scrollbar ${u?"min-h-[150px] placeholder-white/20":"h-auto overflow-hidden"}`,placeholder:"Write the history of this person..."}),f.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mt-6 mb-3 opacity-80",children:"Behavior & Personality"}),f.jsx("textarea",{value:a.comportamiento||"",onChange:x=>v("comportamiento",x.target.value),readOnly:!u,className:`w-full bg-transparent border-none outline-none text-slate-300 text-sm leading-relaxed resize-none custom-scrollbar ${u?"min-h-[100px]":"h-auto overflow-hidden"}`,placeholder:"How does this person act?"})]}),f.jsxs("div",{className:"pt-6 border-t border-white/5",children:[f.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mb-4 flex items-center gap-2 opacity-80",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})," Established Connections"]}),a.relaciones&&a.relaciones.length>0?f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.relaciones.map((x,y)=>{var b,S,w;return f.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5 hover:border-primary/30 transition-colors",children:[f.jsx("div",{className:"size-8 rounded-full bg-white/10 flex items-center justify-center text-xs font-bold",children:((S=(b=x.entidadDestino)==null?void 0:b.nombre)==null?void 0:S.charAt(0))||"?"}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"text-sm font-bold text-white truncate",children:((w=x.entidadDestino)==null?void 0:w.nombre)||"Unknown"}),f.jsx("div",{className:"text-[10px] text-primary truncate",children:x.tipoRelacion||"Connected"})]})]},y)})}):f.jsx("div",{className:"p-6 text-center bg-white/5 rounded-xl border border-dashed border-white/10",children:f.jsx("p",{className:"text-xs text-slate-500 italic",children:"No relationships recorded yet."})})]})]})})]})]}),f.jsxs("div",{className:"w-80 border-l border-glass-border bg-surface-dark/50 hidden xl:flex flex-col",children:[f.jsxs("div",{className:"p-4 border-b border-glass-border flex justify-between items-center",children:[f.jsx("span",{className:"text-xs font-bold text-slate-500",children:"QUICK NOTES"}),f.jsx("button",{className:"text-slate-400 hover:text-white",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"})})]}),f.jsx("div",{className:"p-4 flex-1",children:f.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none text-sm text-slate-300 placeholder-slate-600 resize-none",placeholder:"Draft a quick scene or jot down notes for Elara here..."})}),f.jsx("div",{className:"p-2 border-t border-glass-border text-right text-[10px] text-slate-600",children:"0 words"})]})]}):f.jsx("div",{className:"p-20 text-center text-red-500",children:"Character not found in the archives."})},i9=({id:t})=>{const[e,r]=K.useState(null),[n,i]=K.useState(!0),[a,s]=K.useState(!1);K.useEffect(()=>{o()},[t]);const o=async()=>{i(!0);try{const c=await Ne.get(`/bd/zona/${t}`);r(c)}catch(c){console.error("Error loading location:",c)}finally{i(!1)}},l=async()=>{try{await Ne.patch("/bd/modificar",{...e,tipoEntidad:"zona"}),s(!1)}catch(c){console.error("Error saving:",c)}},u=(c,d)=>{r(h=>({...h,[c]:d}))};return n?f.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Scanning terrain..."}):e?f.jsxs("div",{className:"flex h-full overflow-y-auto custom-scrollbar p-8 flex-col gap-8",children:[f.jsxs("header",{className:"flex justify-between items-end",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("span",{className:"text-xs font-bold text-emerald-400 bg-emerald-400/10 px-2 py-0.5 rounded border border-emerald-400/20",children:"LOCATION"}),f.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:e.tipo||"Wilderness"})]}),f.jsx("h1",{className:"text-5xl font-manrope font-black text-white tracking-tight",children:e.nombre}),f.jsx("p",{className:"text-slate-400 mt-2",children:e.apellidos||"Uncharted territory"})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(Wt,{variant:"secondary",icon:a?"close":"edit",onClick:()=>s(!a),children:a?"Cancel":"Edit Location"}),a&&f.jsx(Wt,{variant:"primary",icon:"save",onClick:l,children:"Update Records"})]})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[f.jsxs("div",{className:"col-span-1 space-y-6",children:[f.jsxs(Et,{className:"p-6",children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"straighten"})," Geography & Scale"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Size / Scale"}),f.jsx("input",{type:"text",value:e.tamanno||"",onChange:c=>u("tamanno",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Development Level"}),f.jsx("input",{type:"text",value:e.desarrollo||"",onChange:c=>u("desarrollo",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]})]})]}),f.jsxs(Et,{className:"p-6",children:[f.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4",children:"Quick Stats"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[f.jsx("span",{className:"text-[10px] text-slate-500 block",children:"Density"}),f.jsx("span",{className:"text-white font-bold",children:"Medium"})]}),f.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[f.jsx("span",{className:"text-[10px] text-slate-500 block",children:"Security"}),f.jsx("span",{className:"text-emerald-400 font-bold",children:"Stable"})]})]})]})]}),f.jsx("div",{className:"col-span-2 space-y-6",children:f.jsxs(Et,{className:"p-8",children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"description"})," Topographic Records & Lore"]}),f.jsx("textarea",{value:e.descripcion||"",onChange:c=>u("descripcion",c.target.value),readOnly:!a,className:"w-full bg-transparent border-none outline-none text-slate-300 text-lg leading-relaxed min-h-[400px] resize-none",placeholder:"Describe the vistas, the smells, and the secrets of this place..."})]})})]})]}):f.jsx("div",{className:"p-20 text-center text-red-500",children:"Location not found in the maps."})},pY=({id:t})=>{const[e,r]=K.useState(null),[n,i]=K.useState(!0),[a,s]=K.useState(!1);K.useEffect(()=>{o()},[t]);const o=async()=>{i(!0);try{const c=await Ne.get(`/bd/entidadcolectiva/${t}`);r(c)}catch(c){console.error("Error loading collective:",c)}finally{i(!1)}},l=async()=>{try{await Ne.patch("/bd/modificar",{...e,tipoEntidad:"entidadcolectiva"}),s(!1)}catch(c){console.error("Error saving:",c)}},u=(c,d)=>{r(h=>({...h,[c]:d}))};return n?f.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Gathering intelligence..."}):e?f.jsxs("div",{className:"flex h-full overflow-y-auto custom-scrollbar p-8 flex-col gap-8",children:[f.jsxs("header",{className:"flex justify-between items-end",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("span",{className:"text-xs font-bold text-indigo-400 bg-indigo-400/10 px-2 py-0.5 rounded border border-indigo-400/20",children:"COLLECTIVE"}),f.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:e.tipo||"Organization"})]}),f.jsx("h1",{className:"text-5xl font-manrope font-black text-white tracking-tight",children:e.nombre}),f.jsxs("p",{className:"text-slate-400 mt-2",children:[e.cantidadMiembros||"Unknown"," members"]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(Wt,{variant:"secondary",icon:a?"close":"edit",onClick:()=>s(!a),children:a?"Cancel":"Edit Collective"}),a&&f.jsx(Wt,{variant:"primary",icon:"save",onClick:l,children:"Update Dossier"})]})]}),f.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[f.jsx("div",{className:"col-span-1 space-y-6",children:f.jsxs(Et,{className:"p-6",children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"group_work"})," Group Dynamics"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Scale / Members"}),f.jsx("input",{type:"text",value:e.cantidadMiembros||"",onChange:c=>u("cantidadMiembros",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Behavior / Alignment"}),f.jsx("input",{type:"text",value:e.comportamiento||"",onChange:c=>u("comportamiento",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]})]})]})}),f.jsx("div",{className:"col-span-2 space-y-6",children:f.jsxs(Et,{className:"p-8",children:[f.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"history_edu"})," Mandate & History"]}),f.jsx("textarea",{value:e.descripcion||"",onChange:c=>u("descripcion",c.target.value),readOnly:!a,className:"w-full bg-transparent border-none outline-none text-slate-300 text-lg leading-relaxed min-h-[400px] resize-none",placeholder:"Detail the motives, the structure, and the legacy of this group..."})]})})]})]}):f.jsx("div",{className:"p-20 text-center text-red-500",children:"Collective not found in the records."})},mY=()=>f.jsx("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300",children:f.jsxs("main",{className:"flex-1 flex flex-col p-12 overflow-y-auto custom-scrollbar relative",children:[f.jsxs("header",{className:"mb-12 space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold text-[10px] tracking-widest uppercase",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"grid_view"}),f.jsx("span",{children:"Universo Alpha"}),f.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),f.jsx("span",{children:"Galaxia Andrmeda"}),f.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),f.jsx("span",{className:"text-white",children:"Sistema Solar"})]}),f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{className:"space-y-4 max-w-3xl",children:[f.jsxs("div",{className:"flex items-center gap-3 px-3 py-1 rounded bg-orange-500/10 text-orange-400 border border-orange-500/20 inline-block",children:[f.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"sunny"}),f.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Sistema Planetario"}),f.jsx("span",{className:"text-[9px] font-bold text-slate-600 tracking-widest ml-2",children:"ID: SYS-SOL-001"})]}),f.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:"Sistema Solar"}),f.jsx("p",{className:"text-slate-400 text-lg leading-relaxed",children:"Sistema planetario principal ubicado en el Brazo de Orin, hogar de la nica vida biolgica compleja confirmada en el sector galctico Alpha-9."})]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{className:"p-3 rounded-2xl bg-white/5 hover:bg-red-500/10 text-slate-500 hover:text-red-400 border border-white/5 transition-all outline-none",children:f.jsx("span",{className:"material-symbols-outlined",children:"delete"})}),f.jsx(Wt,{variant:"primary",icon:"save",children:"Guardar"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[f.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[f.jsxs("section",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"sell"}),f.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Etiquetas"}),f.jsx("span",{className:"ml-auto text-[9px] font-bold text-slate-600 px-1.5 py-0.5 rounded bg-white/5",children:"3 ACTIVAS"})]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsx($2,{label:"Estrella Tipo G",color:"amber",icon:"star"}),f.jsx($2,{label:"Vida Confirmada",color:"emerald",icon:"tempest"}),f.jsx($2,{label:"Rico en Agua",color:"cyan",icon:"water_drop"}),f.jsx("button",{className:"size-8 rounded-full border border-dashed border-white/10 flex items-center justify-center text-slate-600 hover:text-white hover:border-white/30 transition-all",children:"+"})]})]}),f.jsxs("section",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"analytics"}),f.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Atributos Principales"}),f.jsx("button",{className:"ml-auto text-slate-600 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"settings"})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx(qg,{label:"Forma / Estructura",value:"Heliosfrica Estndar",icon:"hive"}),f.jsx(qg,{label:"Composicin",value:"Hidrgeno (74%), Helio (24%)",icon:"experiment"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsx(qg,{label:"Edad (Aos)",value:"4.6 MM",unit:"Aos"}),f.jsx(qg,{label:"Ciclo Orbital",value:"230 MM",unit:"Aos"})]})]})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"menu_book"}),f.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Notas de Lore"})]}),f.jsx("textarea",{className:"w-full h-48 bg-white/5 border border-white/5 rounded-[2rem] p-6 text-sm text-slate-400 placeholder:text-slate-700 focus:border-primary/50 outline-none transition-all resize-none leading-relaxed italic shadow-inner",defaultValue:"El sistema contiene un cinturn de asteroides inusualmente denso entre el 4 y 5 planeta. Se teoriza que es el remanente de una colisin planetaria antigua conocida como 'El Gran Impacto' en las escrituras sagradas de los habitantes de Terra."})]})]}),f.jsx("div",{className:"lg:col-span-2",children:f.jsxs(Et,{className:"h-full border-white/5 bg-surface-dark/40 overflow-hidden flex flex-col shadow-2xl",children:[f.jsxs("header",{className:"p-8 border-b border-white/5 flex justify-between items-center",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"size-10 rounded-xl bg-primary/20 text-primary flex items-center justify-center",children:f.jsx("span",{className:"material-symbols-outlined",children:"hub"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-bold text-white text-lg tracking-tight",children:"Contenido Interno (Planetas)"}),f.jsx("p",{className:"text-[10px] font-medium text-slate-500 mt-0.5",children:"Arrastra para reordenar la jerarqua orbital"})]})]}),f.jsxs("div",{className:"px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[10px] font-black uppercase tracking-widest flex items-center gap-2",children:[f.jsx("div",{className:"size-1.5 rounded-full bg-emerald-500 animate-pulse"}),"8 Entidades"]})]}),f.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-3",children:[f.jsx(nh,{name:"Mercurio",type:"Rocoso",stats:"430C | 88 Das",icon:"public"}),f.jsx(nh,{name:"Venus",type:"Atmsfera",stats:"462C | 225 Das",icon:"public"}),f.jsx(nh,{name:"Tierra",type:"Habitable",stats:"8B Hab | 1 Luna",icon:"public",active:!0}),f.jsx(nh,{name:"Marte",type:"Desierto",stats:"-60C | 2 Lunas",icon:"public"}),f.jsx(nh,{name:"Cinturn Asteroides",type:"Anillo",stats:">1M Obj",icon:"grain"})]}),f.jsx("div",{className:"p-8 bg-black/20 border-t border-white/5",children:f.jsxs("button",{className:"w-full py-4 rounded-[1.5rem] border-2 border-dashed border-white/10 text-slate-500 hover:text-white hover:border-primary/50 hover:bg-primary/5 transition-all flex items-center justify-center gap-3 font-black uppercase text-[10px] tracking-[0.2em]",children:[f.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Aadir Nueva Entidad"]})})]})})]})]})}),$2=({label:t,color:e,icon:r})=>f.jsxs("div",{className:`px-4 py-1.5 rounded-xl bg-${e}-500/10 text-${e}-400 border border-${e}-500/20 flex items-center gap-2 text-[10px] font-black uppercase tracking-widest shadow-lg`,children:[f.jsx("span",{className:"material-symbols-outlined text-[14px]",children:r}),t]}),qg=({label:t,value:e,unit:r,icon:n})=>f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-slate-600 ml-1",children:t}),f.jsxs("div",{className:"w-full bg-white/5 border border-white/5 rounded-2xl px-5 py-3.5 flex items-center justify-between group hover:border-white/10 transition-all",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[n&&f.jsx("span",{className:"material-symbols-outlined text-slate-500 text-lg group-hover:text-primary transition-colors",children:n}),f.jsx("span",{className:"text-sm font-bold text-slate-300",children:e})]}),r&&f.jsx("span",{className:"text-[10px] font-black text-slate-600 uppercase tracking-widest",children:r})]})]}),nh=({name:t,type:e,stats:r,icon:n,active:i})=>f.jsxs("div",{className:`group flex items-center gap-6 p-4 rounded-2xl transition-all cursor-pointer ${i?"bg-primary/10 border border-primary/20 shadow-xl":"hover:bg-white/5 border border-transparent"}`,children:[f.jsx("span",{className:"material-symbols-outlined text-slate-700 group-hover:text-slate-500",children:"drag_indicator"}),f.jsx("div",{className:`size-12 rounded-xl flex items-center justify-center ${i?"bg-primary text-white shadow-lg shadow-primary/30":"bg-surface-dark border border-white/5 text-slate-500"}`,children:f.jsx("span",{className:"material-symbols-outlined text-3xl",children:n})}),f.jsx("div",{className:"flex-1",children:f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("h4",{className:"text-sm font-bold text-white group-hover:text-primary transition-colors",children:t}),f.jsx("span",{className:`text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-widest ${i?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-white/5 text-slate-600"}`,children:e})]})}),f.jsx("div",{className:"flex flex-col items-end gap-1",children:f.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[f.jsx("span",{className:"material-symbols-outlined text-[12px]",children:"analytics"}),f.jsx("span",{className:"text-[10px] font-mono tracking-tight group-hover:text-slate-300",children:r})]})}),f.jsxs("div",{className:"flex gap-2 ml-4",children:[f.jsx("button",{className:"p-2 rounded-lg text-slate-700 hover:text-white hover:bg-white/5 transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit_note"})}),i?f.jsx("button",{className:"size-8 rounded-full bg-primary text-white flex items-center justify-center shadow-lg",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"arrow_forward"})}):f.jsx("button",{className:"p-2 rounded-lg text-slate-700 hover:text-white hover:bg-white/5 transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:"open_in_new"})})]})]}),gY=()=>f.jsx("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300",children:f.jsxs("main",{className:"flex-1 flex flex-col p-12 overflow-y-auto custom-scrollbar relative",children:[f.jsxs("header",{className:"mb-12 space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold text-[10px] tracking-widest uppercase",children:[f.jsx("span",{children:"Sistema Solar"}),f.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),f.jsx("span",{children:"Kepler-186f"}),f.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),f.jsx("span",{className:"text-white",children:"Territorios"})]}),f.jsxs("div",{className:"flex justify-between items-end",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[f.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:"Kepler-186f"}),f.jsx("span",{className:"material-symbols-outlined text-4xl text-primary",children:"public"})]}),f.jsx("p",{className:"text-slate-400 text-lg max-w-2xl leading-relaxed",children:"Gestin geopoltica y geogrfica de la superficie planetaria. Administra biomas, asentamientos y recursos estratgicos."})]}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx(Wt,{variant:"secondary",icon:"map",children:"Ver Atlas"}),f.jsx(Wt,{variant:"primary",icon:"add",children:"Nuevo Territorio"})]})]})]}),f.jsxs("section",{className:"space-y-8",children:[f.jsxs(Et,{className:"p-2 flex items-center justify-between border-white/5",children:[f.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[f.jsxs("div",{className:"relative flex-1 max-w-sm",children:[f.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm",children:"search"}),f.jsx("input",{type:"text",placeholder:"Buscar por nombre...",className:"w-full bg-transparent border-none rounded-xl py-2 pl-9 pr-4 text-xs focus:ring-1 focus:ring-primary/30 outline-none transition-all"})]}),f.jsx("div",{className:"w-px h-6 bg-white/5 mx-2"}),f.jsx(U2,{label:"Bioma: Todos"}),f.jsx(U2,{label:"Poblacin"}),f.jsx(U2,{label:"Estado"})]}),f.jsxs("div",{className:"flex items-center gap-1 p-1 bg-white/5 rounded-lg",children:[f.jsx("button",{className:"p-1.5 rounded-md text-slate-500 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"format_list_bulleted"})}),f.jsx("button",{className:"p-1.5 rounded-md bg-white/10 text-white shadow-sm",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_view"})})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[f.jsx(G2,{title:"Nueva Neo-Tokyo",desc:"Metrpolis vertical construida sobre las...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuAYF5Q6W3o1w1f1",badges:["Capital"],stats:["15M","Templado","Costero"],color:"cyan"}),f.jsx(G2,{title:"Mar de Dunas",desc:"Extensin rida rica en especia slica...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuBYG6R7X4p2x2g2",stats:["Hostil","rido"],color:"amber"}),f.jsx(G2,{title:"Sanctum Bio-Domo",desc:"Instalacin de investigacin...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuCZ H7S8Y5q3z3h3",badges:["Ciencia"],stats:["5K","Jungla"],color:"purple"}),f.jsxs("div",{className:"group border-2 border-dashed border-white/5 rounded-[2.5rem] flex flex-col items-center justify-center p-12 gap-4 hover:border-primary/30 hover:bg-primary/5 transition-all cursor-pointer",children:[f.jsx("div",{className:"size-16 rounded-3xl bg-white/5 flex items-center justify-center group-hover:scale-110 transition-transform",children:f.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-600 group-hover:text-primary",children:"add_location_alt"})}),f.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-slate-600 group-hover:text-white",children:"Aadir Territorio"})]})]})]})]})}),U2=({label:t})=>f.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl hover:bg-white/5 transition-all group",children:[f.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-white",children:t}),f.jsx("span",{className:"material-symbols-outlined text-slate-600 text-[14px]",children:"expand_more"})]}),G2=({title:t,desc:e,image:r,badges:n=[],stats:i=[],color:a})=>f.jsxs("div",{className:"group relative rounded-[2.5rem] overflow-hidden border border-white/5 bg-surface-dark/50 hover:border-white/10 transition-all shadow-2xl",children:[f.jsxs("div",{className:"h-48 overflow-hidden relative",children:[f.jsx("img",{src:r,alt:t,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-60 group-hover:opacity-100"}),f.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-surface-dark via-transparent to-transparent"}),f.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:n.map(s=>f.jsxs("span",{className:`px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest bg-${a==="cyan"?"primary":a==="amber"?"amber-500":"purple-500"}/20 text-${a==="cyan"?"primary":a==="amber"?"amber-400":"purple-400"} border border-white/10 backdrop-blur-md flex items-center gap-1.5`,children:[f.jsx("span",{className:"material-symbols-outlined text-[12px]",children:s==="Capital"?"star":"science"}),s]},s))})]}),f.jsxs("div",{className:"p-8 space-y-6",children:[f.jsxs("header",{className:"flex justify-between items-start",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-2xl font-manrope font-black text-white mb-2 group-hover:text-primary transition-colors",children:t}),f.jsx("p",{className:"text-xs text-slate-500 leading-relaxed line-clamp-2",children:e})]}),f.jsx("button",{className:"p-2 text-slate-700 hover:text-white",children:f.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})]}),f.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(s=>f.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-white/5 border border-white/5 text-[9px] font-black text-slate-400 uppercase tracking-widest",children:[f.jsx("div",{className:`size-1.5 rounded-full bg-${a==="cyan"?"primary":a==="amber"?"amber-500":"purple-500"}/50`}),s]},s))}),f.jsxs("div",{className:"flex gap-3 pt-2",children:[f.jsxs("button",{className:"flex-1 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[f.jsx("span",{className:"material-symbols-outlined text-sm opacity-50",children:"edit"})," Editar"]}),f.jsxs("button",{className:"flex-1 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[f.jsx("span",{className:"material-symbols-outlined text-sm opacity-50",children:"map"})," Ubicacin"]})]})]})]}),vY=()=>{const{type:t,entityId:e}=Bi(),r=()=>{const n=t==null?void 0:t.toLowerCase();switch(n){case"character":case"entidadindividual":return f.jsx(hY,{id:e});case"location":case"zona":return f.jsx(i9,{id:e});case"culture":case"entidadcolectiva":return f.jsx(pY,{id:e});case"universe":case"galaxy":case"system":return f.jsx(mY,{id:e,type:n});case"planet":return f.jsx(gY,{id:e});case"construccion":return f.jsx(i9,{id:e});case"efectos":return f.jsxs("div",{className:"p-8 text-white",children:["Effect/Spell View for ID: ",id]});case"interaccion":return f.jsxs("div",{className:"p-8 text-white",children:["Interaction/Event View for ID: ",id]});case"magic":return f.jsxs("div",{className:"p-8 text-white",children:["Magic System View for ID: ",id]});default:return f.jsxs("div",{className:"p-8 text-white",children:["Unknown Entity Type: ",t]})}};return f.jsx("div",{className:"flex-1 bg-background-dark overflow-hidden",children:r()})},yY=()=>{var W,ne,ie;const{setRightPanelMode:t,setRightOpen:e,setRightPanelTitle:r}=jl(),[n,i]=K.useState([]),[a,s]=K.useState(null),[o,l]=K.useState([]),[u,c]=K.useState(!0);K.useState(!1);const[d,h]=K.useState(!1),[m,v]=K.useState({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0}),[x,y]=K.useState({nombre:"",descripcion:""}),[b,S]=K.useState(null);K.useState(null);const[w,k]=K.useState("eventos"),[N,T]=K.useState([]),[j,M]=K.useState([]),[A,P]=K.useState(null),D=kt.useRef(!1),R=async $=>{try{return(await Ne.get("/bd/relacion")).filter(le=>le.tipoOrigen==="lineatiempo"&&le.idOrigen===$||le.tipoDestino==="lineatiempo"&&le.idDestino===$).map(le=>le.idOrigen===$?le.idDestino:le.idOrigen)}catch(q){return console.error(q),[]}},I=async($,q)=>{const te=await R($),Z=q.filter(ge=>te.includes(ge.id));T(Z);const le=q.filter(ge=>ge.id!==$&&!te.includes(ge.id));M(le)},U=async $=>{if(!(!a||!$))try{await Ne.put("/bd/insertar",{tipoEntidad:"relacion",tipoOrigen:"lineatiempo",idOrigen:a,tipoDestino:"lineatiempo",idDestino:$,descripcion:"Anexo de lnea de tiempo"}),I(a,n)}catch(q){console.error(q)}},B=async $=>{const te=(await Ne.get("/bd/relacion")).find(Z=>Z.tipoOrigen==="lineatiempo"&&Z.idOrigen===a&&Z.idDestino===$||Z.tipoDestino==="lineatiempo"&&Z.idDestino===a&&Z.idOrigen===$);te&&(await Ne.delete(`/bd/relacion/${te.id}`),I(a,n))};K.useEffect(()=>{t("CUSTOM"),r("Lnea de Tiempo"),e(!0);const $=setInterval(()=>{const q=document.getElementById("architect-right-panel-portal");q&&(P(q),clearInterval($))},50);return()=>{clearInterval($),t("NOTES"),r("")}},[]),K.useEffect(()=>{D.current||(D.current=!0,z())},[]),K.useEffect(()=>{a?(F(a),I(a,n),S(null),v({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0})):l([])},[a]),K.useEffect(()=>{if(w==="eventos"&&!b){const $=o.length>0?Math.max(...o.map(q=>q.ordenAbsoluto||0)):0;v(q=>({...q,ordenAbsoluto:$+1}))}},[w,o,b]);const z=async()=>{c(!0);try{const $=await Ne.get("/bd/lineatiempo"),q=[...new Map($.map(le=>[le.id,le])).values()],te=q.find(le=>le.esRaiz);q.length===0?(i([]),s(null)):(i(q),a||s(te?te.id:q[0].id));const Z=q.filter(le=>le.esRaiz);if(Z.length>1){Z.sort((Te,Re)=>Te.id-Re.id);const le=Z[0],ge=Z.slice(1);ge.forEach(Te=>Ne.delete(`/bd/lineatiempo/${Te.id}`).catch(console.error));const Ue=q.filter(Te=>Te.id===le.id||!ge.find(Re=>Re.id===Te.id));i(Ue),a||s(le.id)}}catch($){console.error("Failed to load timelines",$)}finally{c(!1)}},F=async $=>{try{const q=await Ne.get(`/timeline/linea/${$}/eventos`);q.sort((te,Z)=>(te.ordenAbsoluto||0)-(Z.ordenAbsoluto||0)),l(q)}catch(q){console.error("Failed to load events",q)}},V=async()=>{if(!a||!m.nombre)return;const $={...m,ordenAbsoluto:parseInt(m.ordenAbsoluto)||0};try{b?await Ne.put(`/timeline/evento/${b.id}`,{...$,lineaTiempo:{id:a}}):await Ne.post("/timeline/evento",{...$,lineaTiempo:{id:a}}),v({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0}),S(null),F(a)}catch(q){console.error(q)}},J=$=>{S($),v({nombre:$.nombre,descripcion:$.descripcion,fechaTexto:$.fechaTexto,ordenAbsoluto:$.ordenAbsoluto||0}),k("eventos"),e(!0)},Y=async()=>{if(x.nombre)try{const $=await Ne.post("/timeline/linea",{...x,esRaiz:!1});h(!1),y({nombre:"",descripcion:""}),z(),$&&$.id&&s($.id)}catch($){console.error($)}},[L,G]=K.useState({open:!1,type:null,id:null,title:"",message:""}),ee=($,q)=>{q.stopPropagation(),G({open:!0,type:"TIMELINE",id:$,title:"Delete Timeline",message:"Are you sure you want to delete this timeline? All events will be lost."})},re=($,q)=>{q.stopPropagation(),G({open:!0,type:"EVENT",id:$,title:"Delete Event",message:"Are you sure you want to delete this event?"})},se=async()=>{const{type:$,id:q}=L;if(!(!$||!q))try{if($==="TIMELINE"){if(await Ne.delete(`/timeline/linea/${q}`),a===q){const te=n.filter(Z=>Z.id!==q);s(te.length>0?te[0].id:null)}z()}else $==="EVENT"&&(await Ne.delete(`/timeline/evento/${q}`),F(a),b&&b.id===q&&S(null))}catch(te){console.error(te),alert("Error deleting item")}},de=f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"p-4 border-b border-white/5",children:f.jsxs("div",{className:"flex bg-black/40 rounded-lg p-1",children:[f.jsx("button",{onClick:()=>k("eventos"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${w==="eventos"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Eventos"}),f.jsx("button",{onClick:()=>k("anexos"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${w==="anexos"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Anexos"})]})}),f.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[w==="eventos"&&f.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:f.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[f.jsxs("h3",{className:"text-xs font-black uppercase text-primary mb-4 flex items-center justify-between",children:[b?"Edit Event":"New Event",b&&f.jsx("button",{onClick:()=>{S(null),v({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:o.length+1})},className:"text-[10px] text-slate-500 hover:text-white underline",children:"CANCEL"})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Title"}),f.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:m.nombre,onChange:$=>v({...m,nombre:$.target.value}),placeholder:"Event Name"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Date Label"}),f.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:m.fechaTexto,onChange:$=>v({...m,fechaTexto:$.target.value}),placeholder:"e.g. Year 500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Order (Sort)"}),f.jsx("input",{type:"text",className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:m.ordenAbsoluto,onChange:$=>{const q=$.target.value;/^[-+]?\d*$/.test(q)&&v({...m,ordenAbsoluto:q})},placeholder:"+/- Num"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Description"}),f.jsx("textarea",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary h-24 resize-none",value:m.descripcion,onChange:$=>v({...m,descripcion:$.target.value}),placeholder:"Describe what happened..."})]}),f.jsx("div",{className:"pt-2",children:f.jsx(Wt,{variant:"primary",onClick:V,className:"w-full justify-center",children:b?"Save Changes":"Create Event"})}),b&&f.jsx("button",{onClick:$=>re(b.id,$),className:"w-full text-center text-xs text-red-500 hover:text-red-400 py-2 border border-red-500/20 rounded-lg hover:bg-red-500/10 transition-colors",children:"Delete Event"})]})]})}),w==="anexos"&&f.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:f.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[f.jsx("h3",{className:"text-xs font-black uppercase text-primary mb-4",children:"Annexed Timelines"}),f.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Link other localized timelines to this one to verify chronological consistency."}),f.jsxs("div",{className:"space-y-2 mb-6",children:[N.map($=>f.jsxs("div",{className:"flex items-center justify-between p-2 bg-white/5 rounded-lg border border-white/5",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-xs text-slate-400",children:"timeline"}),f.jsx("span",{className:"text-xs font-bold text-slate-300",children:$.nombre})]}),f.jsx("button",{onClick:()=>B($.id),className:"text-slate-500 hover:text-red-500",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"link_off"})})]},$.id)),N.length===0&&f.jsx("span",{className:"text-xs text-slate-600 italic",children:"No linked timelines."})]}),f.jsx("h4",{className:"text-[10px] font-bold uppercase text-slate-400 mb-2",children:"Available to Link"}),f.jsxs("div",{className:"space-y-1",children:[j.map($=>f.jsxs("button",{onClick:()=>U($.id),className:"w-full flex items-center gap-2 p-2 hover:bg-white/5 rounded-lg text-left transition-colors group",children:[f.jsx("span",{className:"material-symbols-outlined text-xs text-green-500/50 group-hover:text-green-500",children:"add_link"}),f.jsx("span",{className:"text-xs text-slate-400 group-hover:text-white",children:$.nombre})]},$.id)),j.length===0&&f.jsx("span",{className:"text-xs text-slate-600 italic",children:"No other timelines available."})]})]})})]})]});return f.jsxs("div",{className:"flex h-screen bg-background-dark text-white overflow-hidden",children:[A&&Zs.createPortal(de,A),f.jsxs("aside",{className:"w-64 bg-surface-dark border-r border-white/5 flex flex-col p-4 z-20 shrink-0",children:[f.jsxs("header",{className:"flex justify-between items-center mb-6",children:[f.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-primary",children:"Timelines"}),f.jsx("button",{onClick:()=>h(!d),className:"text-slate-400 hover:text-white",children:f.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),d&&f.jsxs("div",{className:"mb-4 p-3 bg-black/20 rounded-xl space-y-2 border border-white/10 animate-in fade-in slide-in-from-left-2",children:[f.jsx("input",{className:"w-full bg-transparent border-b border-white/20 text-sm p-1 outline-none focus:border-primary",placeholder:"Name",value:x.nombre,onChange:$=>y({...x,nombre:$.target.value})}),f.jsx("div",{className:"flex justify-end",children:f.jsx("button",{onClick:Y,className:"text-xs font-bold text-primary",children:"CREATE"})})]}),f.jsx("div",{className:"space-y-2 overflow-y-auto flex-1 custom-scrollbar",children:n.map($=>f.jsxs("div",{onClick:()=>s($.id),className:`group flex items-center justify-between p-3 rounded-xl cursor-pointer transition-all border ${a===$.id?"bg-primary/10 border-primary text-white shadow-[0_0_15px_rgba(var(--primary-rgb),0.1)]":"bg-transparent border-transparent hover:bg-white/5 text-slate-400"}`,children:[f.jsxs("div",{className:"flex items-center gap-2 truncate",children:[f.jsx("span",{className:`material-symbols-outlined text-sm shrink-0 ${$.esRaiz?"text-amber-400":""}`,children:$.esRaiz?"public":"timeline"}),f.jsx("span",{className:"text-xs font-bold uppercase tracking-wide truncate",children:$.nombre})]}),f.jsx("button",{onClick:q=>ee($.id,q),className:"opacity-0 group-hover:opacity-100 text-slate-500 hover:text-red-500 transition-opacity",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},$.id))})]}),f.jsxs("main",{className:"flex-1 relative flex flex-col h-full overflow-hidden bg-background-dark",children:[f.jsx("div",{className:"h-16 border-b border-white/5 bg-background-dark/80 backdrop-blur flex items-center px-8 z-10 shrink-0",children:f.jsxs("div",{children:[f.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[((W=n.find($=>$.id===a))==null?void 0:W.esRaiz)&&f.jsx("span",{className:"text-amber-400 material-symbols-outlined",children:"star"}),((ne=n.find($=>$.id===a))==null?void 0:ne.nombre)||"Select Timeline"]}),f.jsx("p",{className:"text-xs text-slate-500",children:(ie=n.find($=>$.id===a))==null?void 0:ie.descripcion})]})}),f.jsx("div",{className:"flex-1 overflow-y-auto p-8 relative custom-scrollbar z-10",children:f.jsxs("div",{className:"max-w-2xl mx-auto relative pl-8 border-l-2 border-white/10 space-y-8 pb-32",children:[o.length===0&&f.jsx("div",{className:"text-center text-slate-600 italic py-20",children:"No events yet. Use the right panel to add one."}),o.map(($,q)=>f.jsxs("div",{className:"relative group animate-in fade-in slide-in-from-bottom-4",style:{animationDelay:`${q*50}ms`},children:[f.jsx("div",{className:"absolute top-6 -left-[41px] size-4 rounded-full bg-white/20 border-4 border-background-dark group-hover:bg-primary transition-colors cursor-pointer",onClick:()=>J($)}),f.jsxs("div",{className:"ml-4 bg-surface-dark/50 border border-white/5 p-5 rounded-2xl hover:border-primary/30 transition-all hover:bg-surface-dark group-hover:translate-x-1 duration-300 relative group/card",children:[f.jsxs("div",{className:"absolute top-3 right-3 opacity-0 group-hover/card:opacity-100 transition-opacity flex gap-1 bg-black/50 rounded-lg backdrop-blur-sm border border-white/5 p-1",children:[f.jsx("button",{onClick:()=>J($),className:"p-1.5 text-slate-400 hover:text-white hover:bg-white/10 rounded transition-colors",title:"Edit",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),f.jsx("button",{onClick:te=>re($.id,te),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-500/10 rounded transition-colors",title:"Delete",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),f.jsx("div",{className:"flex justify-between items-start",children:f.jsxs("div",{children:[f.jsxs("div",{className:"flex flex-col mb-1",children:[f.jsx("h3",{className:"text-lg font-bold text-white",children:$.nombre}),f.jsx("span",{className:"text-xs font-mono font-bold text-primary opacity-80",children:$.fechaTexto})]}),f.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:$.descripcion})]})})]})]},$.id))]})})]}),f.jsx(Xp,{isOpen:L.open,onClose:()=>G({...L,open:!1}),onConfirm:se,title:L.title,message:L.message,confirmText:"Delete",type:"danger"})]})},xY=({onCancel:t,onCreate:e})=>{const[r,n]=K.useState(1),[i,a]=K.useState("regional"),[s,o]=K.useState("upload");return f.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-xl animate-in fade-in duration-300",children:f.jsx("div",{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto no-scrollbar relative animate-in zoom-in-95 duration-500",children:f.jsxs(Et,{className:"p-0 border-white/10 shadow-[0_0_100px_rgba(0,0,0,0.5)] overflow-hidden",children:[f.jsxs("header",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"size-12 rounded-2xl bg-primary/20 text-primary flex items-center justify-center",children:f.jsx("span",{className:"material-symbols-outlined text-2xl",children:"add_location_alt"})}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-manrope font-black text-white tracking-tight",children:"Crear Nuevo Mapa / Zona"}),f.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Configura los detalles para tu nueva entrada cartogrfica."})]})]}),f.jsx("button",{onClick:t,className:"text-slate-500 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),f.jsxs("div",{className:"p-12 space-y-12",children:[f.jsxs("section",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===1?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"1"}),f.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Identidad y Jerarqua"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pl-12",children:[f.jsx(bY,{label:"Nombre del Mapa",placeholder:"ej. La Costa de Zafiro"}),f.jsxs("div",{className:"space-y-1.5 row-span-2",children:[f.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Descripcin"}),f.jsx("textarea",{placeholder:"Breve descripcin de la geografa, clima o importancia...",className:"w-full h-[120px] bg-white/5 border border-white/5 rounded-2xl p-4 text-sm text-white focus:border-primary/50 outline-none transition-all resize-none"})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Zona Padre (Opcional)"}),f.jsxs("select",{className:"w-full bg-white/5 border border-white/5 rounded-2xl px-4 py-3 text-sm text-white focus:border-primary/50 outline-none appearance-none",children:[f.jsx("option",{children:"Ninguna (Nivel Superior)"}),f.jsx("option",{children:"Reino de Aethelgard"}),f.jsx("option",{children:"Continente de Aurum"})]}),f.jsx("p",{className:"text-[9px] text-slate-500 italic mt-1 ml-1 text-primary/70",children:"Seleccionar un padre convierte esto en sub-zona."})]})]})]}),f.jsx("div",{className:"h-px w-full bg-white/5"}),f.jsxs("section",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===2?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"2"}),f.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Tipo de Mapa"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 pl-12",children:[f.jsx(H2,{active:i==="world",onClick:()=>a("world"),icon:"public",label:"Mapa Mundial",desc:"Continentes, ocanos, escala global."}),f.jsx(H2,{active:i==="regional",onClick:()=>a("regional"),icon:"map",label:"Mapa Regional",desc:"Reinos, provincias, biomas."}),f.jsx(H2,{active:i==="local",onClick:()=>a("local"),icon:"location_city",label:"Ciudad / Local",desc:"Ciudades, mazmorras, mapas de batalla."})]})]}),f.jsx("div",{className:"h-px w-full bg-white/5"}),f.jsxs("section",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===3?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"3"}),f.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Fuente del Lienzo"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pl-12",children:[f.jsx(a9,{active:s==="upload",onClick:()=>o("upload"),icon:"cloud_upload",label:"Cargar Archivo de Imagen",desc:"Arrastra y suelta o haz clic para buscar",subdesc:"JPG, PNG, WEBP  MAX 25MB"}),f.jsx(a9,{active:s==="blank",onClick:()=>o("blank"),icon:"brush",label:"Lienzo en Blanco",desc:"Crear un nuevo dibujo desde cero",subdesc:"4096 px x 4096 px"})]})]})]}),f.jsxs("footer",{className:"p-8 bg-white/[0.02] border-t border-white/5 flex justify-between items-center",children:[f.jsx("button",{onClick:t,className:"text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"Cancelar"}),f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-600",children:"Cambios guardados localmente"}),f.jsx(Wt,{variant:"primary",className:"px-10 py-3 shadow-xl",onClick:()=>e(s),children:"Crear Mapa"})]})]})]})})})},bY=({label:t,placeholder:e})=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:t}),f.jsx("input",{type:"text",placeholder:e,className:"w-full bg-white/5 border border-white/5 rounded-2xl px-4 py-3 text-sm text-white focus:border-primary/50 transition-all outline-none"})]}),H2=({active:t,onClick:e,icon:r,label:n,desc:i})=>f.jsxs("div",{onClick:e,className:`p-6 rounded-3xl border transition-all cursor-pointer group ${t?"bg-primary/10 border-primary shadow-lg shadow-primary/10":"bg-white/5 border-white/5 hover:border-white/10"}`,children:[f.jsx("div",{className:`size-10 rounded-xl mb-4 flex items-center justify-center transition-all ${t?"bg-primary text-white":"bg-white/5 text-slate-500 group-hover:text-slate-300"}`,children:f.jsx("span",{className:"material-symbols-outlined",children:r})}),f.jsx("h3",{className:`text-sm font-bold mb-1 transition-colors ${t?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:n}),f.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-medium",children:i})]}),a9=({active:t,onClick:e,icon:r,label:n,desc:i,subdesc:a})=>f.jsxs("div",{onClick:e,className:`p-10 rounded-[2.5rem] border transition-all cursor-pointer group flex flex-col items-center text-center gap-4 ${t?"bg-primary/5 border-primary shadow-lg":"bg-white/[0.02] border-white/5 hover:border-white/10 hover:bg-white/[0.04]"}`,children:[f.jsx("div",{className:`size-16 rounded-[2rem] flex items-center justify-center transition-all ${t?"bg-primary text-white shadow-xl shadow-primary/20":"bg-white/5 text-slate-600 group-hover:text-slate-400"}`,children:f.jsx("span",{className:"material-symbols-outlined text-3xl",children:r})}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("h3",{className:`font-bold transition-colors ${t?"text-white":"text-slate-400"}`,children:n}),f.jsx("p",{className:"text-xs text-slate-500 font-medium",children:i})]}),f.jsx("div",{className:"flex gap-2 mt-2",children:a.split("").map((s,o)=>f.jsx("span",{className:"px-2 py-1 rounded bg-black/20 text-[8px] font-black text-slate-600 tracking-tighter uppercase whitespace-nowrap",children:s.trim()},o))})]}),wY=({mapTitle:t="Reino de Aethelgard",onSave:e,onBack:r})=>{const[n,i]=K.useState(100),[a,s]=K.useState(24),[o,l]=K.useState("#000000"),[u,c]=K.useState("brush"),[d,h]=K.useState(1),[m,v]=K.useState([{id:1,name:"Terreno Base",visible:!0,locked:!1,type:"raster"},{id:2,name:"Ros y Lagos",visible:!0,locked:!1,type:"vector"}]),x=kt.useRef(null),[y,b]=K.useState(!1),S=[{id:"select",icon:"near_me"},{id:"brush",icon:"brush"},{id:"eraser",icon:"ink_eraser"},{id:"fill",icon:"format_color_fill"},{id:"measure",icon:"straighten"},{id:"text",icon:"title"}],w=()=>{var R;return(R=x.current)==null?void 0:R.getContext("2d")},k=R=>{const I=m.find(B=>B.id===d);if(!I||!I.visible||I.locked)return;const U=w();U&&(b(!0),U.beginPath(),U.moveTo(R.nativeEvent.offsetX,R.nativeEvent.offsetY),U.lineWidth=a,U.lineCap="round",U.lineJoin="round",U.globalAlpha=n/100,u==="eraser"?U.globalCompositeOperation="destination-out":(U.globalCompositeOperation="source-over",U.strokeStyle=o))},N=R=>{if(!y)return;const I=w();I&&(I.lineTo(R.nativeEvent.offsetX,R.nativeEvent.offsetY),I.stroke())},T=()=>{var R;y&&(b(!1),(R=w())==null||R.closePath())},j=R=>{v(I=>I.map(U=>U.id===R?{...U,visible:!U.visible}:U))},M=R=>{v(I=>I.map(U=>U.id===R?{...U,locked:!U.locked}:U))},A=()=>{const R={id:Date.now(),name:`Capa ${m.length+1}`,visible:!0,locked:!1,type:"raster"};v([R,...m]),h(R.id)},P=R=>{m.length<=1||(v(I=>I.filter(U=>U.id!==R)),d===R&&h(m[0].id))},D=(R=!0)=>{var U;const I=(U=x.current)==null?void 0:U.toDataURL();console.log("Saving Map Data:",I?"Data present":"Empty"),R&&e&&e(I)};return f.jsxs("div",{className:"flex-1 flex flex-col bg-[#050508] text-slate-300 font-sans h-full overflow-hidden relative",children:[f.jsxs("header",{className:"h-20 flex-none border-b border-white/5 flex items-center justify-between px-8 bg-surface-dark/80 backdrop-blur-md z-30",children:[f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsx("button",{onClick:r,className:"p-2 rounded-xl bg-white/5 hover:bg-white/10 transition-colors",children:f.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),f.jsx("div",{className:"w-px h-8 bg-white/10"}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-xl font-bold text-white tracking-tight",children:t}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("div",{className:"size-1.5 rounded-full bg-primary"}),f.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Guardado localmente"})]})]})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("button",{onClick:r,className:"px-4 py-2 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 text-xs font-bold uppercase tracking-widest transition-all",children:"Cancelar"}),f.jsxs("div",{className:"flex bg-white/5 rounded-xl p-1 gap-1 border border-white/10",children:[f.jsxs("button",{onClick:()=>D(!0),className:"h-9 px-4 rounded-lg bg-primary hover:bg-primary-light text-white text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar"]}),f.jsx("div",{className:"w-px bg-white/10 my-1"}),f.jsx("button",{onClick:()=>D(!1),className:"h-9 px-3 rounded-lg bg-transparent hover:bg-white/10 text-white transition-all flex items-center justify-center",title:"Guardar y Seguir Editando",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit_document"})})]})]})]}),f.jsxs("div",{className:"flex-1 flex relative overflow-hidden",children:[f.jsx("aside",{className:"absolute left-8 top-1/2 -translate-y-1/2 z-40",children:f.jsxs(Et,{className:"p-2 flex flex-col gap-2 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[S.map(R=>f.jsx("button",{onClick:()=>c(R.id),className:`size-12 rounded-xl flex items-center justify-center transition-all ${u===R.id?"bg-primary text-white shadow-lg shadow-primary/30":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:R.icon})},R.id)),f.jsx("div",{className:"w-8 h-px bg-white/10 mx-auto my-1"}),f.jsxs("div",{className:"relative group",children:[f.jsx("input",{type:"color",value:o,onChange:R=>l(R.target.value),className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full"}),f.jsx("div",{className:"size-12 rounded-xl flex items-center justify-center cursor-pointer",children:f.jsx("div",{className:"size-7 rounded-full border-2 border-white/20 shadow-inner group-hover:scale-110 transition-transform",style:{backgroundColor:o}})})]})]})}),f.jsxs("main",{className:"flex-1 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-repeat relative overflow-hidden flex items-center justify-center p-20 no-scrollbar",children:[f.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:"radial-gradient(circle, white 1px, transparent 1px)",backgroundSize:"30px 30px"}}),f.jsxs("div",{className:"relative group animate-in zoom-in-95 duration-700",children:[f.jsx("p",{className:"absolute -top-10 left-0 text-[10px] font-black uppercase tracking-[0.2em] text-slate-600",children:"Lienzo: 800x600px  RGB"}),f.jsx("div",{className:"relative bg-white rounded shadow-[0_0_100px_rgba(0,0,0,0.5)] overflow-hidden border border-white/10 cursor-crosshair",children:f.jsx("canvas",{ref:x,width:800,height:600,onMouseDown:k,onMouseMove:N,onMouseUp:T,onMouseLeave:T})})]})]}),f.jsxs("aside",{className:"absolute right-8 top-1/2 -translate-y-1/2 z-40 flex flex-col gap-6 w-80",children:[f.jsxs(Et,{className:"p-6 space-y-6 rounded-3xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[f.jsxs("header",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Propiedades"}),f.jsx("button",{className:"text-slate-600 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"settings_input_component"})})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Tamao del Pincel"}),f.jsxs("span",{className:"text-xs font-black text-white",children:[a,"px"]})]}),f.jsx("input",{type:"range",min:"1",max:"100",value:a,onChange:R=>s(R.target.value),className:"w-full accent-primary h-1 bg-white/5 rounded-full appearance-none cursor-pointer"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Opacidad"}),f.jsxs("span",{className:"text-xs font-black text-white",children:[n,"%"]})]}),f.jsx("input",{type:"range",min:"0",max:"100",value:n,onChange:R=>i(R.target.value),className:"w-full accent-primary h-1 bg-white/5 rounded-full appearance-none cursor-pointer"})]})]})]}),f.jsxs(Et,{className:"p-6 space-y-6 rounded-3xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl flex-1 max-h-[400px] overflow-hidden flex flex-col",children:[f.jsxs("header",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Capas"}),f.jsx("div",{className:"flex gap-2 text-slate-600",children:f.jsx("button",{onClick:A,className:"hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar space-y-2",children:m.map(R=>f.jsxs("div",{onClick:()=>h(R.id),className:`flex items-center gap-3 p-3 rounded-2xl transition-all cursor-pointer group select-none ${d===R.id?"bg-primary/10 border border-primary/20":"bg-transparent border border-transparent hover:bg-white/5"}`,children:[f.jsx("button",{onClick:I=>{I.stopPropagation(),j(R.id)},className:`material-symbols-outlined text-lg ${R.visible?"text-slate-500 hover:text-white":"text-slate-700"}`,children:R.locked?"lock":R.visible?"visibility":"visibility_off"}),f.jsx("div",{className:"size-10 rounded-lg bg-surface-light border border-white/5 flex items-center justify-center overflow-hidden",children:f.jsx("span",{className:"material-symbols-outlined opacity-30 text-xl",children:R.type==="raster"?"texture":"water_drop"})}),f.jsx("div",{className:"flex-1 min-w-0",children:f.jsx("p",{className:`text-xs font-bold truncate ${d===R.id?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:R.name})}),f.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:I=>{I.stopPropagation(),M(R.id)},className:"material-symbols-outlined text-sm text-slate-700 hover:text-white transition-colors",children:R.locked?"lock_open":"lock"}),f.jsx("button",{onClick:I=>{I.stopPropagation(),P(R.id)},className:"material-symbols-outlined text-sm text-red-900/50 hover:text-red-400 transition-colors",children:"delete"})]})]},R.id))})]})]}),f.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-40",children:f.jsxs(Et,{className:"px-6 py-3 flex items-center gap-8 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[f.jsxs("div",{className:"flex items-center gap-4 text-slate-500 border-r border-white/10 pr-6",children:[f.jsx("button",{className:"hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined",children:"undo"})}),f.jsx("button",{className:"hover:text-white transition-colors opacity-30 cursor-not-allowed",children:f.jsx("span",{className:"material-symbols-outlined",children:"redo"})})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined",children:"remove"})}),f.jsx("span",{className:"text-[10px] font-black text-white w-10 text-center",children:"100%"}),f.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined",children:"add"})})]})]})})]})]})},SY=({map:t})=>{const[e,r]=K.useState(null);t!=null&&t.nombre;const n=[{id:1,name:"Torre Carmes",type:"location",x:"45%",y:"42%",color:"bg-primary"},{id:2,name:"Costa de Zafiro",type:"region",x:"55%",y:"35%",color:"bg-cyan-500"},{id:3,name:"Pramos de Hierro",type:"danger",x:"62%",y:"58%",color:"bg-amber-500"}];return f.jsxs("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300 relative",children:[f.jsxs("main",{className:"flex-1 overflow-hidden relative group",children:[f.jsxs("div",{className:"absolute inset-4 rounded-[2.5rem] overflow-hidden border border-white/5 shadow-2xl bg-surface-dark",children:[f.jsx("img",{src:"https://images.unsplash.com/photo-1521295121783-8a321d551ad2?auto=format&fit=crop&w=2000&q=80",alt:"Background Map",className:"w-full h-full object-cover opacity-60 mix-blend-luminosity grayscale-[0.2]"}),f.jsx("div",{className:"absolute inset-0",children:n.map(i=>f.jsx("div",{onClick:()=>r(i),className:`absolute size-10 -translate-x-1/2 -translate-y-1/2 cursor-pointer transition-all hover:scale-125 z-10 ${(e==null?void 0:e.id)===i.id?"scale-125":""}`,style:{left:i.x,top:i.y},children:f.jsxs("div",{className:`size-full rounded-2xl ${i.color} border-4 border-background-dark shadow-[0_0_20px_rgba(0,0,0,0.5)] flex items-center justify-center text-white relative group/marker`,children:[f.jsx("span",{className:"material-symbols-outlined text-lg",children:i.type==="location"?"fort":i.type==="region"?"terrain":"skull"}),f.jsx("div",{className:"absolute top-12 left-1/2 -translate-x-1/2 px-3 py-1.5 rounded-lg bg-surface-dark border border-white/10 text-[9px] font-black uppercase tracking-widest text-white whitespace-nowrap opacity-0 group-hover/marker:opacity-100 transition-opacity",children:i.name}),f.jsx("div",{className:`absolute -inset-2 rounded-[1.5rem] opacity-20 animate-ping -z-10 ${i.color}`})]})},i.id))})]}),f.jsx("aside",{className:"absolute left-12 top-1/2 -translate-y-1/2 z-20 flex flex-col gap-4",children:f.jsxs(Et,{className:"p-2 flex flex-col gap-2 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[f.jsx(ih,{icon:"near_me",active:!0}),f.jsx(ih,{icon:"location_on"}),f.jsx(ih,{icon:"brush"}),f.jsx(ih,{icon:"layers"}),f.jsx("div",{className:"w-8 h-px bg-white/10 mx-auto my-1"}),f.jsx(ih,{icon:"tune"})]})}),f.jsx("div",{className:"absolute bottom-12 left-12 z-20 px-4 py-2 rounded-xl bg-black/40 border border-white/10 backdrop-blur-md text-[10px] font-black tracking-widest text-slate-400",children:"125%"})]}),f.jsx("aside",{className:`flex-none bg-surface-dark border-l border-white/5 transition-all duration-700 relative z-30 ${e?"w-96 p-8 opacity-100":"w-0 p-0 opacity-0 overflow-hidden"}`,children:e&&f.jsxs("div",{className:"flex flex-col h-full gap-8 animate-in slide-in-from-right-8 duration-500",children:[f.jsxs("header",{className:"space-y-6",children:[f.jsxs("div",{className:"relative aspect-[4/3] rounded-3xl overflow-hidden border border-white/10 shadow-xl group",children:[f.jsx("img",{src:"https://images.unsplash.com/photo-1533154683836-84ea7a0bc310?auto=format&fit=crop&w=500&q=80",alt:"Detail",className:"w-full h-full object-cover grayscale-[0.4] group-hover:grayscale-0 transition-all duration-700"}),f.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background-dark via-transparent to-transparent"}),f.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:f.jsx("button",{onClick:()=>r(null),className:"size-8 rounded-lg bg-black/40 border border-white/10 backdrop-blur-md text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})}),f.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[f.jsx("span",{className:"px-3 py-1 rounded bg-primary/20 text-primary border border-primary/20 text-[8px] font-black uppercase tracking-widest backdrop-blur-md",children:"Lugar"}),f.jsx("span",{className:"px-3 py-1 rounded bg-emerald-500/20 text-emerald-400 border border-emerald-500/20 text-[8px] font-black uppercase tracking-widest backdrop-blur-md",children:"Capital"})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsx("h2",{className:"text-3xl font-manrope font-black text-white tracking-tight leading-none",children:e.name}),f.jsx("button",{className:"text-slate-500 hover:text-white transition-colors p-2 rounded-xl hover:bg-white/5",children:f.jsx("span",{className:"material-symbols-outlined",children:"edit"})})]}),f.jsx("p",{className:"text-sm text-slate-400 leading-relaxed font-manrope",children:"La antigua sede de los Magos de Fuego, erigida sobre la caldera inactiva del Monte Ignis. Sus muros estn imbuidos de magia protectora."})]})]}),f.jsxs("div",{className:"space-y-8 flex-1 overflow-y-auto no-scrollbar",children:[f.jsxs("section",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center px-1",children:[f.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Habitantes Clave"}),f.jsx("button",{className:"text-[10px] font-bold text-primary hover:underline transition-all",children:"Ver todos"})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx(s9,{name:"Lyra Ignis",role:"Gran Maga"}),f.jsx(s9,{name:"Kaelen",role:"Capitn de la Guardia"})]})]}),f.jsxs("section",{className:"space-y-4",children:[f.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 px-1",children:"Eventos Relacionados"}),f.jsx(Et,{className:"p-4 border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:f.jsxs("div",{className:"flex gap-4 items-center",children:[f.jsx("div",{className:"size-10 rounded-xl bg-amber-500/10 text-amber-500 border border-amber-500/20 flex items-center justify-center",children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:"history_edu"})}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-xs font-bold text-white group-hover:text-primary transition-colors",children:"El Asedio de Ceniza"}),f.jsx("p",{className:"text-[10px] text-slate-500 font-medium",children:"Hace 300 aos"})]})]})})]})]}),f.jsx("footer",{className:"pt-6 border-t border-white/5",children:f.jsx(Wt,{variant:"primary",icon:"auto_stories",className:"w-full py-4 rounded-2xl shadow-xl shadow-primary/20",children:"Abrir en la Biblia"})})]})})]})},ih=({icon:t,active:e})=>f.jsx("button",{className:`size-12 rounded-xl flex items-center justify-center transition-all ${e?"bg-primary text-white shadow-lg shadow-primary/30":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:t})}),s9=({name:t,role:e})=>f.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:[f.jsx(x0,{name:t,size:"sm",className:"border-white/10 group-hover:border-primary/50 transition-all"}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("h4",{className:"text-xs font-bold text-white truncate",children:t}),f.jsx("p",{className:"text-[10px] text-slate-500 font-medium truncate",children:e})]}),f.jsx("span",{className:"material-symbols-outlined text-slate-700 text-sm group-hover:text-white transition-colors",children:"chevron_right"})]}),kY=({maps:t,onSelect:e,onCreateNew:r,onClose:n})=>f.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-xl animate-in fade-in duration-300",children:f.jsx("div",{className:"w-full max-w-3xl animate-in zoom-in-95 duration-500",children:f.jsxs(Et,{className:"overflow-hidden border-white/10 shadow-2xl",children:[f.jsxs("header",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"material-symbols-outlined text-primary",children:"map"}),f.jsx("h2",{className:"text-xl font-manrope font-black text-white",children:"Cartografa del Proyecto"})]}),f.jsx("button",{onClick:n,className:"text-slate-500 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),f.jsxs("div",{className:"p-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[60vh] overflow-y-auto custom-scrollbar",children:[f.jsxs("div",{onClick:r,className:"group p-6 rounded-2xl border-2 border-dashed border-white/5 hover:border-primary/50 hover:bg-primary/5 transition-all cursor-pointer flex flex-col items-center justify-center text-center gap-3",children:[f.jsx("div",{className:"size-12 rounded-full bg-primary/10 text-primary flex items-center justify-center group-hover:scale-110 transition-transform",children:f.jsx("span",{className:"material-symbols-outlined",children:"add"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-bold text-white",children:"Nuevo Mapa"}),f.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-tighter",children:"Crear desde cero"})]})]}),t.map(i=>f.jsxs("div",{onClick:()=>e(i),className:"group p-4 rounded-2xl bg-white/5 border border-white/5 hover:border-primary/50 hover:bg-white/10 transition-all cursor-pointer space-y-3",children:[f.jsx("div",{className:"aspect-video rounded-xl bg-surface-light border border-white/5 flex items-center justify-center overflow-hidden",children:f.jsx("span",{className:"material-symbols-outlined text-4xl opacity-20 group-hover:opacity-40 transition-opacity",children:"image"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-bold text-white truncate",children:i.nombre}),f.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-tighter",children:"ltima edicin: Reciente"})]})]},i.id))]}),f.jsx("footer",{className:"p-6 bg-white/[0.02] border-t border-white/5 flex justify-end",children:f.jsx("p",{className:"text-[10px] text-slate-600 font-bold uppercase tracking-widest",children:"Selecciona un mapa para cargar el visor"})})]})})}),CY=()=>{const[t,e]=K.useState("viewer"),[r,n]=K.useState([]),[i,a]=K.useState(null),[s,o]=K.useState(!1);K.useEffect(()=>{l()},[]);const l=async()=>{try{const d=(await Ne.get("/world-bible/entities")).filter(h=>h.tipoEspecial==="map");n(d),d.length>0&&!i&&a(d[0])}catch(c){console.error("Error loading maps",c)}},u=c=>{c==="blank"?e("editor"):(l(),e("viewer"))};return f.jsxs("div",{className:"flex-1 flex flex-col h-full bg-background-dark overflow-hidden",children:[t==="viewer"&&f.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[f.jsx("button",{onClick:()=>o(!0),className:"absolute right-12 bottom-12 z-50 size-16 rounded-3xl bg-primary text-white flex items-center justify-center shadow-2xl shadow-primary/40 hover:scale-110 active:scale-95 transition-all group",children:f.jsx("span",{className:"material-symbols-outlined text-3xl group-hover:rotate-90 transition-transform duration-300",children:"add"})}),f.jsx(SY,{map:i}),s&&f.jsx(kY,{maps:r,onSelect:c=>{a(c),o(!1)},onCreateNew:()=>{o(!1),e("wizard")},onClose:()=>o(!1)})]}),t==="wizard"&&f.jsx(xY,{onCancel:()=>e("viewer"),onCreate:u}),t==="editor"&&f.jsx(wY,{onBack:()=>e("viewer"),onSave:()=>e("viewer")})]})},NY=()=>{const[t,e]=K.useState("Loading..."),[r,n]=K.useState({words:0,rules:0,glyphs:0}),[i,a]=K.useState("Standard Tongue");K.useEffect(()=>{s()},[]);const s=async()=>{try{const o=await Ne.get("/bd/proyecto-activo");e(o.nombreProyecto);const l=await Ne.get("/conlang/stats");n(l);const u=await Ne.get("/conlang/lenguas");u&&u.length>0&&a(u[0].nombre)}catch(o){console.error("Error loading conlang data:",o),e("Default Project")}};return f.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#0a0a0f] text-slate-300 font-sans overflow-y-auto no-scrollbar p-12 lg:p-16 gap-16",children:[f.jsxs("header",{className:"space-y-6",children:[f.jsxs("nav",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-slate-500",children:[f.jsx("span",{children:t}),f.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),f.jsxs("span",{className:"text-white",children:["Conlang: ",i]})]}),f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{className:"space-y-4 max-w-2xl",children:[f.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:i}),f.jsxs("p",{className:"text-lg text-slate-400 leading-relaxed",children:["A conlang belonging to ",t,". Manage its lexicon, grammar rules, and writing systems here."]}),f.jsxs("div",{className:"flex gap-4 pt-2",children:[f.jsx("span",{className:"px-3 py-1 rounded bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[9px] font-black uppercase tracking-widest",children:"Complete: 45%"}),f.jsx("span",{className:"px-3 py-1 rounded bg-primary/10 text-primary border border-primary/20 text-[9px] font-black uppercase tracking-widest",children:"Type: Agglutinative"})]})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("div",{className:"flex items-center gap-3 text-slate-500 border-r border-white/5 pr-6 mr-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm animate-pulse text-emerald-500",children:"save"}),f.jsx("span",{className:"text-[10px] font-bold",children:"Auto-Saved"}),f.jsx("span",{className:"material-symbols-outlined hover:text-white transition-colors cursor-pointer",children:"dark_mode"})]}),f.jsx(Wt,{variant:"primary",icon:"add",size:"md",children:"Create Element"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-12",children:[f.jsxs("section",{className:"xl:col-span-2 space-y-8",children:[f.jsxs("div",{className:"flex justify-between items-center px-2",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"menu_book"}),f.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Lexicon"})]}),f.jsxs("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest hover:text-primary transition-all cursor-pointer",children:["View All (",r.words,")"]})]}),f.jsxs(Et,{className:"p-0 border-white/5 bg-surface-dark/40 overflow-hidden shadow-2xl",children:[f.jsxs("div",{className:"p-4 border-b border-white/5 flex items-center gap-4",children:[f.jsxs("div",{className:"flex-1 relative",children:[f.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 text-lg",children:"search"}),f.jsx("input",{type:"text",placeholder:"Search word or meaning...",className:"w-full bg-white/5 border border-white/5 rounded-2xl py-3 pl-12 pr-4 text-xs focus:ring-1 focus:ring-primary/30 outline-none transition-all"})]}),f.jsx("button",{className:"size-10 rounded-xl bg-white/5 border border-white/5 flex items-center justify-center text-slate-500 hover:text-white transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:"tune"})})]}),f.jsxs("div",{className:"p-6 space-y-4",children:[f.jsx(W2,{word:"Ael'or",type:"noun",gender:"neutral",def:"Starlight; specifically the light from the twin moons."}),f.jsx(W2,{word:"Vexi",type:"verb",gender:"transitive",def:"To weave magic; to create something from nothing."}),f.jsx(W2,{word:"Dra'kan",type:"adj",gender:"",def:"Ancient; belonging to the era of dragons."})]}),f.jsx("div",{className:"p-6 bg-black/20 border-t border-white/5",children:f.jsxs("button",{className:"w-full py-4 rounded-3xl border-2 border-dashed border-white/5 text-slate-600 hover:text-white hover:border-primary/50 hover:bg-primary/5 transition-all text-[10px] font-black uppercase tracking-[0.2em] flex items-center justify-center gap-3",children:[f.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Add New Word"]})})]})]}),f.jsxs("section",{className:"space-y-8",children:[f.jsxs("div",{className:"flex justify-between items-center px-2",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"architecture"}),f.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Grammar Rules"})]}),f.jsx("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest hover:text-primary transition-all cursor-pointer",children:"Manage"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx(o9,{title:"Sentence Structure",status:"active",statusColor:"emerald",desc:"Standard order is SOV (Subject-Object-Verb), but poetry uses VSO for emphasis on action.",tags:["Syntax","Basic"]}),f.jsx(o9,{title:"Noun Declensions",status:"pending",statusColor:"amber",desc:"Seven cases marked by suffixes. Pluralization shifts the stress to the final syllable.",tags:["Morphology"]}),f.jsxs("button",{className:"w-full h-32 rounded-[2.5rem] border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-2 text-slate-600 hover:text-white hover:border-primary/30 hover:bg-primary/5 transition-all",children:[f.jsx("span",{className:"material-symbols-outlined",children:"add_circle"}),f.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Define New Rule"})]})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-12",children:[f.jsxs("section",{className:"space-y-8",children:[f.jsxs("div",{className:"flex justify-between items-center px-2",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"draw"}),f.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Writing System"})]}),f.jsxs("div",{className:"flex gap-2 text-slate-600",children:[f.jsx("button",{className:"p-1 rounded hover:bg-white/5 hover:text-white",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_view"})}),f.jsx("button",{className:"p-1 rounded hover:bg-white/5 hover:text-white",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"title"})})]})]}),f.jsxs(Et,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-8 shadow-2xl",children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"text-2xl font-black text-white tracking-tight mb-1",children:"Moon Script"}),f.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Abugida  Left-to-Right"})]}),f.jsx(Wt,{variant:"secondary",size:"sm",className:"bg-primary/10 border-primary/20 text-primary",children:"Open Editor"})]}),f.jsxs("div",{className:"grid grid-cols-6 gap-3",children:[["","","","",""].map(o=>f.jsx("div",{className:"aspect-square rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-3xl font-serif text-white hover:bg-white/10 transition-all cursor-pointer",children:o},o)),f.jsx("div",{className:"aspect-square rounded-2xl border-2 border-dashed border-white/5 flex items-center justify-center text-slate-600 hover:border-primary/50 hover:text-white transition-all cursor-pointer",children:f.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-[8px] font-black uppercase tracking-widest text-slate-600",children:[f.jsx("span",{children:"Glyph Set"}),f.jsx("span",{children:"24/32 Completed"})]}),f.jsx("div",{className:"h-1.5 w-full bg-white/5 rounded-full overflow-hidden",children:f.jsx("div",{className:"h-full bg-primary w-[75%] rounded-full shadow-[0_0_10px_rgba(99,102,242,0.5)]"})})]})]})]}),f.jsxs("section",{className:"space-y-8",children:[f.jsxs("div",{className:"flex items-center gap-3 px-2",children:[f.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"graphic_eq"}),f.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Translator & Phonology"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[f.jsxs(Et,{className:"p-8 border-primary/20 bg-primary/5 rounded-[3rem] space-y-6 shadow-2xl shadow-primary/10",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary",children:"Live Logographic Stream"}),f.jsx("span",{className:"material-symbols-outlined text-primary animate-pulse",children:"sync_alt"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("input",{type:"text",placeholder:"Source text here...",className:"w-full bg-black/40 border border-white/10 rounded-2xl p-4 text-xs font-bold text-white focus:border-primary/50 outline-none transition-all"}),f.jsxs("div",{className:"h-24 rounded-2xl bg-black/60 border border-white/5 flex items-center justify-center relative overflow-hidden group",children:[f.jsx("span",{className:"text-5xl font-serif text-white opacity-40 group-hover:opacity-100 transition-opacity",children:"   "}),f.jsx("div",{className:"absolute top-2 right-4 text-[7px] font-black uppercase tracking-widest text-slate-700",children:"Rendered Output"})]})]})]}),f.jsxs(Et,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-6",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Vowel Inventory"}),f.jsx("button",{className:"text-primary text-lg",children:f.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),f.jsx("div",{className:"flex flex-wrap gap-2",children:["/a/","/e/","/i/","/o/","/u/","/y/"].map(o=>f.jsx("div",{className:"px-3 py-1.5 rounded-xl bg-white/5 border border-white/5 text-[11px] font-mono font-bold text-slate-300 hover:text-white transition-colors cursor-pointer",children:o},o))})]}),f.jsxs(Et,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-6",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Vector Symbols"}),f.jsx("button",{className:"text-[8px] font-bold text-primary hover:underline transition-all",children:"Upload SVG"})]}),f.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[[{id:1,icon:"filter_vintage"},{id:2,icon:"auto_awesome"},{id:3,icon:"infinite"}].map(o=>f.jsx("div",{className:"aspect-square rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-slate-400 hover:text-white transition-all cursor-pointer",children:f.jsx("span",{className:"material-symbols-outlined text-2xl",children:o.icon})},o.id)),f.jsxs("div",{className:"aspect-square rounded-2xl border-2 border-dashed border-white/5 flex flex-col items-center justify-center text-slate-700 hover:border-primary/50 hover:text-white transition-all cursor-pointer",children:[f.jsx("span",{className:"material-symbols-outlined text-lg",children:"cloud_upload"}),f.jsx("span",{className:"text-[7px] font-bold uppercase mt-1",children:"Add"})]})]})]})]})]})]})]})},W2=({word:t,type:e,gender:r,def:n})=>f.jsxs("div",{className:"p-4 rounded-2xl border border-transparent hover:bg-white/5 hover:border-white/5 transition-all group cursor-pointer relative",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[f.jsx("h4",{className:"text-xl font-manrope font-black text-white group-hover:text-primary transition-colors",children:t}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("span",{className:"text-[9px] font-bold text-slate-600 italic",children:e}),r&&f.jsxs("span",{className:"text-[9px] font-bold text-slate-700 uppercase",children:["(",r,")"]})]})]}),f.jsx("p",{className:"text-sm text-slate-400 leading-relaxed font-manrope",children:n}),f.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity p-2 text-slate-600 hover:text-white",children:f.jsx("span",{className:"material-symbols-outlined",children:"edit_note"})})]}),o9=({title:t,status:e,statusColor:r,desc:n,tags:i})=>f.jsxs(Et,{className:"p-8 border-white/5 hover:border-white/10 transition-all cursor-pointer group space-y-4",children:[f.jsxs("header",{className:"flex justify-between items-start",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:`size-2 rounded-full bg-${r}-500 shadow-[0_0_10px_rgba(var(--${r}-rgb),0.5)]`}),f.jsx("h4",{className:"font-bold text-white group-hover:text-primary transition-colors",children:t})]}),f.jsx("button",{className:"text-slate-700 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})]}),f.jsx("p",{className:"text-[11px] text-slate-500 leading-relaxed font-manrope",children:n}),f.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(a=>f.jsx("span",{className:"px-2 py-0.5 rounded bg-white/5 border border-white/5 text-[8px] font-black uppercase tracking-widest text-slate-600",children:a},a))})]}),EY=()=>f.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#050B0D] text-[#00E5FF] font-mono overflow-hidden",children:[f.jsxs("header",{className:"h-20 border-b border-[#00E5FF]/20 flex items-center justify-between px-10 bg-black/40 backdrop-blur-xl",children:[f.jsxs("div",{className:"flex items-center gap-10",children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsx("span",{className:"text-[10px] opacity-40 uppercase tracking-[0.4em] font-bold",children:"Datastream_Nav"}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"material-symbols-outlined text-2xl",children:"language"}),f.jsx("span",{className:"text-2xl font-black italic tracking-tighter",children:"Chronos Atlas"})]})]}),f.jsxs("div",{className:"flex items-center gap-4 border-l border-[#00E5FF]/20 pl-10",children:[f.jsx("span",{className:"text-3xl font-black tracking-[0.2em] italic opacity-80",children:"DIGITAL RUNE COMPILER"}),f.jsx("div",{className:"px-3 py-1 rounded-sm bg-[#00E5FF]/10 border border-[#00E5FF]/30 text-[10px] font-black uppercase tracking-widest animate-pulse",children:"Data Ready"})]})]}),f.jsxs("div",{className:"flex items-center gap-8",children:[f.jsxs("div",{className:"flex items-center gap-2 opacity-60 hover:opacity-100 transition-opacity cursor-pointer",children:[f.jsx("span",{className:"material-symbols-outlined text-lg",children:"help"}),f.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Protocol"})]}),f.jsxs("button",{className:"flex items-center gap-3 px-6 py-2.5 bg-[#00E5FF] text-black font-black uppercase text-xs tracking-widest rounded-sm hover:shadow-[0_0_20px_rgba(0,229,255,0.4)] transition-all",children:[f.jsx("span",{className:"material-symbols-outlined",children:"save"}),"Commit Data"]}),f.jsx("div",{className:"size-10 rounded-full bg-gradient-to-tr from-[#00E5FF] to-blue-600 border border-white/20 shadow-lg"})]})]}),f.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[f.jsxs("main",{className:"flex-1 flex flex-col p-12 gap-12 overflow-y-auto no-scrollbar relative",children:[f.jsx("div",{className:"absolute top-0 left-0 w-full h-[2px] bg-white/5 overflow-hidden",children:f.jsx("div",{className:"h-full bg-[#00E5FF] w-[64%] shadow-[0_0_10px_#00E5FF]"})}),f.jsxs("section",{className:"space-y-6",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"size-2 bg-[#00E5FF] rounded-full shadow-[0_0_10px_#00E5FF]"}),f.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.4em]",children:"Glyph Set (Scan)"})]}),f.jsxs("div",{className:"flex gap-4 opacity-40",children:[f.jsx("span",{className:"material-symbols-outlined text-xl",children:"grid_view"}),f.jsx("span",{className:"material-symbols-outlined text-xl",children:"view_list"})]})]}),f.jsxs("div",{className:"p-10 rounded-sm border border-[#00E5FF]/10 bg-[#00E5FF]/[0.02] grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-6",children:[f.jsx(Qa,{symbol:"",keyLabel:"A"}),f.jsx(Qa,{symbol:"",keyLabel:"B"}),f.jsx(Qa,{symbol:"",keyLabel:"C"}),f.jsx(Qa,{symbol:"",keyLabel:"D",active:!0}),f.jsx(Qa,{}),f.jsx(Qa,{}),f.jsx(Qa,{}),f.jsx(Qa,{}),f.jsx(Qa,{}),f.jsx(Qa,{}),f.jsx("div",{className:"aspect-square rounded shadow-inner border border-dashed border-[#00E5FF]/20 flex items-center justify-center hover:bg-[#00E5FF]/5 transition-colors cursor-pointer group",children:f.jsx("span",{className:"material-symbols-outlined opacity-20 group-hover:opacity-100 transition-opacity",children:"add"})})]}),f.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-[0.2em] opacity-40",children:[f.jsx("span",{children:"26 Glyphs Mapped"}),f.jsxs("div",{className:"flex gap-10",children:[f.jsxs("button",{className:"hover:text-[#00E5FF] flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"tune"})," Manage"]}),f.jsxs("button",{className:"hover:text-[#00E5FF] flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"settings_input_component"})," Ranges"]})]})]})]}),f.jsxs("section",{className:"flex-1 flex flex-col gap-6",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"size-2 bg-[#00E5FF] rounded-full shadow-[0_0_10px_#00E5FF] opacity-40"}),f.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.4em] opacity-40",children:"Live Preview Stream"})]}),f.jsxs("div",{className:"flex-1 rounded-sm border border-[#00E5FF]/10 bg-black/40 flex flex-col p-12 items-center justify-center relative group min-h-[300px]",children:[f.jsx("div",{className:"absolute top-4 left-4 text-[8px] opacity-20 uppercase tracking-widest font-black",children:"Buffer Status: Active"}),f.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none text-center text-7xl font-bold tracking-widest text-[#00E5FF]/10 group-hover:text-[#00E5FF]/40 transition-all placeholder:text-[#00E5FF]/5 resize-none italic",placeholder:"Input your data stream here..."}),f.jsxs("div",{className:"absolute bottom-6 right-8 flex gap-6 text-[8px] font-black uppercase tracking-widest opacity-20",children:[f.jsx("span",{children:"48px"}),f.jsx("span",{children:"Regular"}),f.jsx("span",{children:"UTF-8"})]}),f.jsx("div",{className:"absolute inset-x-12 top-1/2 h-px bg-[#00E5FF]/10 -translate-y-1/2 pointer-events-none"})]})]})]}),f.jsxs("aside",{className:"w-[450px] border-l border-[#00E5FF]/10 p-10 flex flex-col gap-10 bg-black/40 backdrop-blur-xl relative z-20",children:[f.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.4em] opacity-60 mb-2",children:"Configuration Matrix"}),f.jsxs(Et,{className:"p-8 border-[#00E5FF]/20 bg-[#00E5FF]/[0.02] space-y-8 rounded-sm",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Font Name"}),f.jsx("input",{type:"text",defaultValue:"NEURALINK CIPHER",className:"w-full bg-black/60 border border-[#00E5FF]/30 px-6 py-4 text-xs font-black text-[#00E5FF] focus:border-[#00E5FF] outline-none transition-all tracking-widest uppercase italic"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Author / Metadata"}),f.jsx("input",{type:"text",placeholder:"YOUR SYNTHETIC ID",className:"w-full bg-black/60 border border-[#00E5FF]/30 px-6 py-4 text-xs font-black text-[#00E5FF] focus:border-[#00E5FF] outline-none transition-all tracking-widest uppercase italic"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Format"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsx("button",{className:"py-4 border border-[#00E5FF] bg-[#00E5FF]/10 text-[#00E5FF] text-xs font-black tracking-widest shadow-[0_0_15px_rgba(0,229,255,0.2)]",children:".TTF"}),f.jsx("button",{className:"py-4 border border-[#00E5FF]/20 text-[#00E5FF]/40 text-xs font-black tracking-widest hover:border-[#00E5FF]/40 transition-all",children:".OTF"})]})]}),f.jsxs("div",{className:"pt-4 space-y-6",children:[f.jsx(l9,{label:"Ligatures",active:!0}),f.jsx(l9,{label:"Kerning",active:!0})]}),f.jsxs("button",{className:"w-full py-6 mt-6 bg-gradient-to-r from-blue-600 to-fuchsia-500 text-white font-black uppercase text-xs tracking-[0.3em] flex items-center justify-center gap-4 hover:shadow-[0_0_30px_rgba(255,0,255,0.3)] transition-all animate-pulse",children:[f.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Compile & Download"]})]}),f.jsxs("div",{className:"flex-1 flex flex-col gap-6 opacity-30 pointer-events-none",children:[f.jsxs("div",{className:"flex justify-between text-[10px] uppercase font-black",children:[f.jsx("span",{children:"Compiler Logs"}),f.jsx("span",{children:"V2.0.4"})]}),f.jsxs("div",{className:"flex-1 border border-[#00E5FF]/10 bg-black/20 p-6 flex flex-col font-mono text-[9px] gap-2 overflow-hidden",children:[f.jsx("p",{children:"[SCN] Initializing Glyph Buffer..."}),f.jsx("p",{children:"[MAP] Vector data detected for U+0394"}),f.jsx("p",{children:"[SYS] Memory allocation optimized"}),f.jsx("p",{className:"animate-pulse",children:"_"})]})]})]})]})]}),Qa=({symbol:t,keyLabel:e,active:r})=>f.jsxs("div",{className:`aspect-square rounded border transition-all cursor-pointer flex items-center justify-center relative group ${r?"bg-[#00E5FF]/20 border-[#00E5FF] shadow-[0_0_20px_rgba(0,229,255,0.3)]":"bg-black/40 border-[#00E5FF]/10 hover:border-[#00E5FF]/40"}`,children:[f.jsx("span",{className:`text-3xl font-serif ${r?"text-white":"opacity-20 group-hover:opacity-60"}`,children:t||"..."}),e&&f.jsx("span",{className:`absolute top-1 right-1 text-[8px] font-black uppercase ${r?"text-[#00E5FF]/80":"opacity-20"}`,children:e})]}),l9=({label:t,active:e})=>f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-60",children:t}),f.jsx("button",{className:`w-12 h-6 rounded-full p-1 transition-colors relative ${e?"bg-[#00E5FF]/40":"bg-white/5"}`,children:f.jsx("div",{className:`size-4 rounded-full bg-[#00E5FF] shadow-[0_0_10px_#00E5FF] transition-transform ${e?"translate-x-6":"translate-x-0"}`})})]}),TY=({onBack:t,onSave:e})=>{const[r,n]=K.useState(4),[i,a]=K.useState("curve"),[s,o]=K.useState(1),l=[{id:"select",icon:"near_me"},{id:"curve",icon:"gesture"},{id:"eraser",icon:"ink_eraser"},{id:"line",icon:"horizontal_rule"},{id:"shape",icon:"pentagon"},{id:"text",icon:"title"}],u=[{id:1,name:"Trazo Principal",type:"Vector",locked:!0,visible:!0},{id:2,name:"Detalles Secundarios",type:"Vector",locked:!0,visible:!0},{id:3,name:"Boceto Ref.",type:"Imagen (Raster)",locked:!0,visible:!1}];return f.jsxs("div",{className:"flex-1 flex flex-col bg-[#0a0a0f] text-slate-300 font-sans h-full overflow-hidden relative",children:[f.jsxs("header",{className:"h-20 flex-none border-b border-white/5 flex items-center justify-between px-8 bg-surface-dark/80 backdrop-blur-md z-30",children:[f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsx("button",{onClick:t,className:"p-2 rounded-xl bg-white/5 hover:bg-white/10 transition-colors",children:f.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),f.jsx("div",{className:"w-px h-8 bg-white/10"}),f.jsxs("div",{children:[f.jsxs("nav",{className:"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-slate-500 mb-0.5",children:[f.jsx("span",{children:"Idiomas"}),f.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),f.jsx("span",{className:"text-white",children:"Editor Grfico"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex items-center gap-4 text-slate-500",children:[f.jsx("button",{className:"hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:"undo"})}),f.jsx("button",{className:"hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:"redo"})})]}),f.jsx("div",{className:"w-px h-4 bg-white/10 mx-2"}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx("button",{className:"p-1 rounded hover:bg-white/5 text-slate-500 hover:text-white",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_on"})}),f.jsx("button",{className:"p-1 rounded bg-white/10 text-primary",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})})]})]})]})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("button",{className:"flex items-center gap-2 px-6 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 transition-all text-xs font-black uppercase tracking-widest text-slate-400",children:[f.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Exportar SVG"]}),f.jsx(Wt,{variant:"primary",icon:"save",className:"px-8 py-3 shadow-xl shadow-primary/30",onClick:e,children:"Guardar Glifo"}),f.jsx("div",{className:"size-10 rounded-full bg-gradient-to-br from-primary to-orange-400 border-2 border-white/10 shadow-lg ml-2"})]})]}),f.jsxs("div",{className:"flex-1 flex relative overflow-hidden",children:[f.jsxs("aside",{className:"h-full w-20 flex-none border-r border-white/5 bg-surface-dark/40 backdrop-blur-xl flex flex-col items-center py-6 gap-2 z-40",children:[l.map(c=>f.jsx("button",{onClick:()=>a(c.id),className:`size-12 rounded-2xl flex items-center justify-center transition-all ${i===c.id?"bg-primary text-white shadow-lg shadow-primary/30":"text-slate-600 hover:text-white hover:bg-white/5"}`,children:f.jsx("span",{className:"material-symbols-outlined text-2xl",children:c.icon})},c.id)),f.jsx("div",{className:"flex-1"}),f.jsx("button",{className:"size-12 rounded-2xl flex items-center justify-center text-slate-600 hover:text-white transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-2xl",children:"add_photo_alternate"})}),f.jsx("button",{className:"size-12 rounded-2xl flex items-center justify-center text-slate-600 hover:text-white transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-2xl",children:"settings"})})]}),f.jsxs("main",{className:"flex-1 bg-[#050508] relative overflow-hidden flex items-center justify-center no-scrollbar",children:[f.jsx("div",{className:"absolute inset-x-20 top-1/2 h-px bg-red-500/20 pointer-events-none"}),f.jsxs("div",{className:"relative group animate-in zoom-in-95 duration-700",children:[f.jsx("div",{className:"absolute inset-x-0 top-10 h-px bg-white/10"}),f.jsx("div",{className:"absolute inset-x-0 bottom-10 h-px bg-white/10"}),f.jsxs("div",{className:"w-[600px] h-[600px] border border-white/5 rounded-3xl bg-black/40 flex items-center justify-center relative overflow-hidden",children:[f.jsxs("svg",{width:"400",height:"400",className:"drop-shadow-[0_0_20px_rgba(99,102,242,0.5)] scale-125",children:[f.jsx("circle",{cx:"200",cy:"230",r:"100",fill:"none",stroke:"#6366f1",strokeWidth:"6",strokeLinecap:"round"}),f.jsx("line",{x1:"200",y1:"230",x2:"200",y2:"380",stroke:"#6366f1",strokeWidth:"6",strokeLinecap:"round"}),f.jsx("circle",{cx:"200",cy:"230",r:"4",fill:"white"}),f.jsx("rect",{x:"196",y:"376",width:"8",height:"8",fill:"white"}),f.jsx("rect",{x:"96",y:"226",width:"8",height:"8",fill:"#6366f1"}),f.jsx("rect",{x:"296",y:"226",width:"8",height:"8",fill:"#6366f1"}),f.jsx("rect",{x:"136",y:"160",width:"6",height:"6",fill:"#6366f1",className:"opacity-40"}),f.jsx("rect",{x:"256",y:"160",width:"6",height:"6",fill:"#6366f1",className:"opacity-40"})]}),f.jsx("div",{className:"absolute top-[160px] left-[136px] size-1 border border-primary/40 border-dashed w-[20px] h-[100px] pointer-events-none"}),f.jsx("div",{className:"absolute top-[160px] right-[136px] size-1 border border-primary/40 border-dashed w-[20px] h-[100px] pointer-events-none"})]})]}),f.jsx("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2",children:f.jsxs(Et,{className:"px-6 py-2.5 flex items-center gap-6 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[f.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"remove"})}),f.jsx("span",{className:"text-[10px] font-black text-white w-12 text-center uppercase tracking-widest",children:"120%"}),f.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"add"})})]})})]}),f.jsxs("aside",{className:"w-96 flex-none flex flex-col p-10 gap-10 bg-surface-dark/20 backdrop-blur-xl border-l border-white/5 z-40 overflow-y-auto no-scrollbar",children:[f.jsxs("section",{className:"space-y-6",children:[f.jsxs("header",{className:"flex justify-between items-center group cursor-pointer",children:[f.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Propiedades"}),f.jsx("span",{className:"material-symbols-outlined text-slate-700 text-sm",children:"more_horiz"})]}),f.jsxs(Et,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[2rem] space-y-8",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Grosor de Trazo"}),f.jsxs("span",{className:"px-2 py-0.5 rounded bg-white/5 text-[10px] font-black text-white",children:[r,"px"]})]}),f.jsx("input",{type:"range",min:"1",max:"20",value:r,onChange:c=>n(c.target.value),className:"w-full accent-primary h-1 bg-white/5 rounded-full appearance-none cursor-pointer"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 block ml-1",children:"Color / Relleno"}),f.jsxs("div",{className:"flex items-center gap-4 bg-black/40 rounded-2xl p-4 border border-white/5",children:[f.jsx("div",{className:"size-10 rounded-full bg-primary shadow-[0_0_15px_rgba(99,102,242,0.4)] border-2 border-white/20"}),f.jsx("input",{type:"text",defaultValue:"#2F2CED",className:"bg-transparent border-none outline-none text-xs font-mono text-slate-300 w-full"})]})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 block ml-1",children:"Terminacin (Cap)"}),f.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[f.jsx(q2,{icon:"square"}),f.jsx(q2,{icon:"circle",active:!0}),f.jsx(q2,{icon:"rectangle"})]})]}),f.jsxs("button",{className:"w-full py-4 rounded-2xl bg-white/5 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-3 hover:bg-white/10 transition-all",children:[f.jsx("span",{className:"material-symbols-outlined text-lg",children:"gesture"}),"Suavizar Trazo"]})]})]}),f.jsxs("section",{className:"flex-1 flex flex-col gap-6",children:[f.jsxs("header",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Capas"}),f.jsx("button",{className:"p-1 rounded bg-white/5 text-slate-500 hover:text-white transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})]}),f.jsx("div",{className:"space-y-3 overflow-y-auto no-scrollbar flex-1",children:u.map(c=>f.jsxs("div",{onClick:()=>o(c.id),className:`flex items-center gap-4 p-4 rounded-2xl transition-all cursor-pointer group ${s===c.id?"bg-primary/10 border border-primary/20":"bg-white/[0.02] border border-white/5 opacity-60 hover:opacity-100 hover:border-white/10"}`,children:[f.jsx("button",{className:"material-symbols-outlined text-sm text-slate-500 hover:text-white",children:c.visible?"visibility":"visibility_off"}),f.jsx("div",{className:"size-10 rounded-xl bg-black border border-white/10 flex items-center justify-center",children:f.jsx("span",{className:"material-symbols-outlined text-slate-600 group-hover:text-primary transition-colors text-xl",children:c.type.includes("Vector")?"timeline":"image"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("h4",{className:"text-xs font-bold text-white truncate",children:c.name}),f.jsx("p",{className:"text-[9px] text-slate-600 font-bold uppercase tracking-widest",children:c.type})]}),f.jsx("button",{className:"material-symbols-outlined text-slate-700 text-sm",children:"lock"})]},c.id))}),f.jsxs("div",{className:"flex gap-4 p-3 rounded-2xl bg-black/20 border border-white/5",children:[f.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})}),f.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:"content_copy"})}),f.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:"folder"})})]})]}),f.jsxs("div",{className:"p-6 rounded-[2rem] bg-gradient-to-br from-primary/20 to-orange-500/20 border border-white/10 space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:"material-symbols-outlined text-primary",children:"auto_fix_high"}),f.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-white",children:"Vectorizacin Inteligente"})]}),f.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-manrope",children:"Arrastra una imagen para convertirla automticamente en nodos editables."}),f.jsx(Wt,{variant:"primary",size:"sm",className:"w-full text-[9px] py-3 rounded-xl shadow-lg",children:"Importar y Procesar"})]})]})]})]})},q2=({icon:t,active:e})=>f.jsx("button",{className:`py-4 rounded-xl border transition-all flex items-center justify-center ${e?"bg-primary/20 border-primary shadow-lg shadow-primary/20":"bg-white/5 border-white/5 hover:border-white/10"}`,children:f.jsx("span",{className:`material-symbols-outlined text-lg ${e?"text-white":"text-slate-600"}`,children:t})}),jY=()=>{const[t,e]=K.useState("hub");return f.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#050508] overflow-hidden",children:[t==="hub"&&f.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[f.jsx("button",{onClick:()=>e("foundry"),className:"absolute right-12 bottom-12 z-50 size-16 rounded-3xl bg-primary text-white flex items-center justify-center shadow-2xl shadow-primary/40 hover:scale-110 active:scale-95 transition-all group",title:"Glyph Foundry",children:f.jsx("span",{className:"material-symbols-outlined text-3xl group-hover:rotate-12 transition-transform duration-300",children:"font_download"})}),f.jsx(NY,{onOpenEditor:()=>e("editor")})]}),t==="foundry"&&f.jsx(EY,{onBack:()=>e("hub")}),t==="editor"&&f.jsx(TY,{onBack:()=>e("hub"),onSave:()=>e("hub")})]})};var S7={exports:{}},k7={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Id=K;function MY(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var PY=typeof Object.is=="function"?Object.is:MY,_Y=Id.useState,AY=Id.useEffect,RY=Id.useLayoutEffect,DY=Id.useDebugValue;function OY(t,e){var r=e(),n=_Y({inst:{value:r,getSnapshot:e}}),i=n[0].inst,a=n[1];return RY(function(){i.value=r,i.getSnapshot=e,K2(i)&&a({inst:i})},[t,r,e]),AY(function(){return K2(i)&&a({inst:i}),t(function(){K2(i)&&a({inst:i})})},[t]),DY(r),r}function K2(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!PY(t,r)}catch{return!0}}function IY(t,e){return e()}var LY=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?IY:OY;k7.useSyncExternalStore=Id.useSyncExternalStore!==void 0?Id.useSyncExternalStore:LY;S7.exports=k7;var y3=S7.exports;function Sn(t){this.content=t}Sn.prototype={constructor:Sn,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,r){var n=r&&r!=t?this.remove(r):this,i=n.find(t),a=n.content.slice();return i==-1?a.push(r||t,e):(a[i+1]=e,r&&(a[i]=r)),new Sn(a)},remove:function(t){var e=this.find(t);if(e==-1)return this;var r=this.content.slice();return r.splice(e,2),new Sn(r)},addToStart:function(t,e){return new Sn([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var r=this.remove(t).content.slice();return r.push(t,e),new Sn(r)},addBefore:function(t,e,r){var n=this.remove(e),i=n.content.slice(),a=n.find(t);return i.splice(a==-1?i.length:a,0,e,r),new Sn(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Sn.from(t),t.size?new Sn(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Sn.from(t),t.size?new Sn(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Sn.from(t);for(var r=0;r<t.content.length;r+=2)e=e.remove(t.content[r]);return e},toObject:function(){var t={};return this.forEach(function(e,r){t[e]=r}),t},get size(){return this.content.length>>1}};Sn.from=function(t){if(t instanceof Sn)return t;var e=[];if(t)for(var r in t)e.push(r,t[r]);return new Sn(e)};function C7(t,e,r){for(let n=0;;n++){if(n==t.childCount||n==e.childCount)return t.childCount==e.childCount?null:r;let i=t.child(n),a=e.child(n);if(i==a){r+=i.nodeSize;continue}if(!i.sameMarkup(a))return r;if(i.isText&&i.text!=a.text){for(let s=0;i.text[s]==a.text[s];s++)r++;return r}if(i.content.size||a.content.size){let s=C7(i.content,a.content,r+1);if(s!=null)return s}r+=i.nodeSize}}function N7(t,e,r,n){for(let i=t.childCount,a=e.childCount;;){if(i==0||a==0)return i==a?null:{a:r,b:n};let s=t.child(--i),o=e.child(--a),l=s.nodeSize;if(s==o){r-=l,n-=l;continue}if(!s.sameMarkup(o))return{a:r,b:n};if(s.isText&&s.text!=o.text){let u=0,c=Math.min(s.text.length,o.text.length);for(;u<c&&s.text[s.text.length-u-1]==o.text[o.text.length-u-1];)u++,r--,n--;return{a:r,b:n}}if(s.content.size||o.content.size){let u=N7(s.content,o.content,r-1,n-1);if(u)return u}r-=l,n-=l}}class be{constructor(e,r){if(this.content=e,this.size=r||0,r==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,r,n,i=0,a){for(let s=0,o=0;o<r;s++){let l=this.content[s],u=o+l.nodeSize;if(u>e&&n(l,i+o,a||null,s)!==!1&&l.content.size){let c=o+1;l.nodesBetween(Math.max(0,e-c),Math.min(l.content.size,r-c),n,i+c)}o=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,r,n,i){let a="",s=!0;return this.nodesBetween(e,r,(o,l)=>{let u=o.isText?o.text.slice(Math.max(e,l)-l,r-l):o.isLeaf?i?typeof i=="function"?i(o):i:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&u||o.isTextblock)&&n&&(s?s=!1:a+=n),a+=u},0),a}append(e){if(!e.size)return this;if(!this.size)return e;let r=this.lastChild,n=e.firstChild,i=this.content.slice(),a=0;for(r.isText&&r.sameMarkup(n)&&(i[i.length-1]=r.withText(r.text+n.text),a=1);a<e.content.length;a++)i.push(e.content[a]);return new be(i,this.size+e.size)}cut(e,r=this.size){if(e==0&&r==this.size)return this;let n=[],i=0;if(r>e)for(let a=0,s=0;s<r;a++){let o=this.content[a],l=s+o.nodeSize;l>e&&((s<e||l>r)&&(o.isText?o=o.cut(Math.max(0,e-s),Math.min(o.text.length,r-s)):o=o.cut(Math.max(0,e-s-1),Math.min(o.content.size,r-s-1))),n.push(o),i+=o.nodeSize),s=l}return new be(n,i)}cutByIndex(e,r){return e==r?be.empty:e==0&&r==this.content.length?this:new be(this.content.slice(e,r))}replaceChild(e,r){let n=this.content[e];if(n==r)return this;let i=this.content.slice(),a=this.size+r.nodeSize-n.nodeSize;return i[e]=r,new be(i,a)}addToStart(e){return new be([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new be(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(e.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let r=this.content[e];if(!r)throw new RangeError("Index "+e+" out of range for "+this);return r}maybeChild(e){return this.content[e]||null}forEach(e){for(let r=0,n=0;r<this.content.length;r++){let i=this.content[r];e(i,n,r),n+=i.nodeSize}}findDiffStart(e,r=0){return C7(this,e,r)}findDiffEnd(e,r=this.size,n=e.size){return N7(this,e,r,n)}findIndex(e){if(e==0)return Kg(0,e);if(e==this.size)return Kg(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,n=0;;r++){let i=this.child(r),a=n+i.nodeSize;if(a>=e)return a==e?Kg(r+1,a):Kg(r,n);n=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,r){if(!r)return be.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new be(r.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return be.empty;let r,n=0;for(let i=0;i<e.length;i++){let a=e[i];n+=a.nodeSize,i&&a.isText&&e[i-1].sameMarkup(a)?(r||(r=e.slice(0,i)),r[r.length-1]=a.withText(r[r.length-1].text+a.text)):r&&r.push(a)}return new be(r||e,n)}static from(e){if(!e)return be.empty;if(e instanceof be)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new be([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}be.empty=new be([],0);const Y2={index:0,offset:0};function Kg(t,e){return Y2.index=t,Y2.offset=e,Y2}function D0(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let r=Array.isArray(t);if(Array.isArray(e)!=r)return!1;if(r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!D0(t[n],e[n]))return!1}else{for(let n in t)if(!(n in e)||!D0(t[n],e[n]))return!1;for(let n in e)if(!(n in t))return!1}return!0}let Gt=class rk{constructor(e,r){this.type=e,this.attrs=r}addToSet(e){let r,n=!1;for(let i=0;i<e.length;i++){let a=e[i];if(this.eq(a))return e;if(this.type.excludes(a.type))r||(r=e.slice(0,i));else{if(a.type.excludes(this.type))return e;!n&&a.type.rank>this.type.rank&&(r||(r=e.slice(0,i)),r.push(this),n=!0),r&&r.push(a)}}return r||(r=e.slice()),n||r.push(this),r}removeFromSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return e.slice(0,r).concat(e.slice(r+1));return e}isInSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return!0;return!1}eq(e){return this==e||this.type==e.type&&D0(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[r.type];if(!n)throw new RangeError(`There is no mark type ${r.type} in this schema`);let i=n.create(r.attrs);return n.checkAttrs(i.attrs),i}static sameSet(e,r){if(e==r)return!0;if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(r[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return rk.none;if(e instanceof rk)return[e];let r=e.slice();return r.sort((n,i)=>n.type.rank-i.type.rank),r}};Gt.none=[];class O0 extends Error{}class Ae{constructor(e,r,n){this.content=e,this.openStart=r,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,r){let n=T7(this.content,e+this.openStart,r);return n&&new Ae(n,this.openStart,this.openEnd)}removeBetween(e,r){return new Ae(E7(this.content,e+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,r){if(!r)return Ae.empty;let n=r.openStart||0,i=r.openEnd||0;if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Ae(be.fromJSON(e,r.content),n,i)}static maxOpen(e,r=!0){let n=0,i=0;for(let a=e.firstChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.firstChild)n++;for(let a=e.lastChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.lastChild)i++;return new Ae(e,n,i)}}Ae.empty=new Ae(be.empty,0,0);function E7(t,e,r){let{index:n,offset:i}=t.findIndex(e),a=t.maybeChild(n),{index:s,offset:o}=t.findIndex(r);if(i==e||a.isText){if(o!=r&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(r))}if(n!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(n,a.copy(E7(a.content,e-i-1,r-i-1)))}function T7(t,e,r,n){let{index:i,offset:a}=t.findIndex(e),s=t.maybeChild(i);if(a==e||s.isText)return n&&!n.canReplace(i,i,r)?null:t.cut(0,e).append(r).append(t.cut(e));let o=T7(s.content,e-a-1,r,s);return o&&t.replaceChild(i,s.copy(o))}function BY(t,e,r){if(r.openStart>t.depth)throw new O0("Inserted content deeper than insertion position");if(t.depth-r.openStart!=e.depth-r.openEnd)throw new O0("Inconsistent open depths");return j7(t,e,r,0)}function j7(t,e,r,n){let i=t.index(n),a=t.node(n);if(i==e.index(n)&&n<t.depth-r.openStart){let s=j7(t,e,r,n+1);return a.copy(a.content.replaceChild(i,s))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&t.depth==n&&e.depth==n){let s=t.parent,o=s.content;return Tu(s,o.cut(0,t.parentOffset).append(r.content).append(o.cut(e.parentOffset)))}else{let{start:s,end:o}=FY(r,t);return Tu(a,P7(t,s,o,e,n))}else return Tu(a,I0(t,e,n))}function M7(t,e){if(!e.type.compatibleContent(t.type))throw new O0("Cannot join "+e.type.name+" onto "+t.type.name)}function nk(t,e,r){let n=t.node(r);return M7(n,e.node(r)),n}function Eu(t,e){let r=e.length-1;r>=0&&t.isText&&t.sameMarkup(e[r])?e[r]=t.withText(e[r].text+t.text):e.push(t)}function Fh(t,e,r,n){let i=(e||t).node(r),a=0,s=e?e.index(r):i.childCount;t&&(a=t.index(r),t.depth>r?a++:t.textOffset&&(Eu(t.nodeAfter,n),a++));for(let o=a;o<s;o++)Eu(i.child(o),n);e&&e.depth==r&&e.textOffset&&Eu(e.nodeBefore,n)}function Tu(t,e){return t.type.checkContent(e),t.copy(e)}function P7(t,e,r,n,i){let a=t.depth>i&&nk(t,e,i+1),s=n.depth>i&&nk(r,n,i+1),o=[];return Fh(null,t,i,o),a&&s&&e.index(i)==r.index(i)?(M7(a,s),Eu(Tu(a,P7(t,e,r,n,i+1)),o)):(a&&Eu(Tu(a,I0(t,e,i+1)),o),Fh(e,r,i,o),s&&Eu(Tu(s,I0(r,n,i+1)),o)),Fh(n,null,i,o),new be(o)}function I0(t,e,r){let n=[];if(Fh(null,t,r,n),t.depth>r){let i=nk(t,e,r+1);Eu(Tu(i,I0(t,e,r+1)),n)}return Fh(e,null,r,n),new be(n)}function FY(t,e){let r=e.depth-t.openStart,i=e.node(r).copy(t.content);for(let a=r-1;a>=0;a--)i=e.node(a).copy(be.from(i));return{start:i.resolveNoCache(t.openStart+r),end:i.resolveNoCache(i.content.size-t.openEnd-r)}}class Tp{constructor(e,r,n){this.pos=e,this.path=r,this.parentOffset=n,this.depth=r.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,r=this.index(this.depth);if(r==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(r);return n?e.child(r).cut(n):i}get nodeBefore(){let e=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(e).cut(0,r):e==0?null:this.parent.child(e-1)}posAtIndex(e,r){r=this.resolveDepth(r);let n=this.path[r*3],i=r==0?0:this.path[r*3-1]+1;for(let a=0;a<e;a++)i+=n.child(a).nodeSize;return i}marks(){let e=this.parent,r=this.index();if(e.content.size==0)return Gt.none;if(this.textOffset)return e.child(r).marks;let n=e.maybeChild(r-1),i=e.maybeChild(r);if(!n){let o=n;n=i,i=o}let a=n.marks;for(var s=0;s<a.length;s++)a[s].type.spec.inclusive===!1&&(!i||!a[s].isInSet(i.marks))&&(a=a[s--].removeFromSet(a));return a}marksAcross(e){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let n=r.marks,i=e.parent.maybeChild(e.index());for(var a=0;a<n.length;a++)n[a].type.spec.inclusive===!1&&(!i||!n[a].isInSet(i.marks))&&(n=n[a--].removeFromSet(n));return n}sharedDepth(e){for(let r=this.depth;r>0;r--)if(this.start(r)<=e&&this.end(r)>=e)return r;return 0}blockRange(e=this,r){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!r||r(this.node(n))))return new L0(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let r=1;r<=this.depth;r++)e+=(e?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return e+":"+this.parentOffset}static resolve(e,r){if(!(r>=0&&r<=e.content.size))throw new RangeError("Position "+r+" out of range");let n=[],i=0,a=r;for(let s=e;;){let{index:o,offset:l}=s.content.findIndex(a),u=a-l;if(n.push(s,o,i+l),!u||(s=s.child(o),s.isText))break;a=u-1,i+=l+1}return new Tp(r,n,a)}static resolveCached(e,r){let n=u9.get(e);if(n)for(let a=0;a<n.elts.length;a++){let s=n.elts[a];if(s.pos==r)return s}else u9.set(e,n=new zY);let i=n.elts[n.i]=Tp.resolve(e,r);return n.i=(n.i+1)%VY,i}}class zY{constructor(){this.elts=[],this.i=0}}const VY=12,u9=new WeakMap;class L0{constructor(e,r,n){this.$from=e,this.$to=r,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const $Y=Object.create(null);let Ws=class ik{constructor(e,r,n,i=Gt.none){this.type=e,this.attrs=r,this.marks=i,this.content=n||be.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,r,n,i=0){this.content.nodesBetween(e,r,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,r,n,i){return this.content.textBetween(e,r,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,r,n){return this.type==e&&D0(this.attrs,r||e.defaultAttrs||$Y)&&Gt.sameSet(this.marks,n||Gt.none)}copy(e=null){return e==this.content?this:new ik(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new ik(this.type,this.attrs,this.content,e)}cut(e,r=this.content.size){return e==0&&r==this.content.size?this:this.copy(this.content.cut(e,r))}slice(e,r=this.content.size,n=!1){if(e==r)return Ae.empty;let i=this.resolve(e),a=this.resolve(r),s=n?0:i.sharedDepth(r),o=i.start(s),u=i.node(s).content.cut(i.pos-o,a.pos-o);return new Ae(u,i.depth-s,a.depth-s)}replace(e,r,n){return BY(this.resolve(e),this.resolve(r),n)}nodeAt(e){for(let r=this;;){let{index:n,offset:i}=r.content.findIndex(e);if(r=r.maybeChild(n),!r)return null;if(i==e||r.isText)return r;e-=i+1}}childAfter(e){let{index:r,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(r),index:r,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:r,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(r),index:r,offset:n};let i=this.content.child(r-1);return{node:i,index:r-1,offset:n-i.nodeSize}}resolve(e){return Tp.resolveCached(this,e)}resolveNoCache(e){return Tp.resolve(this,e)}rangeHasMark(e,r,n){let i=!1;return r>e&&this.nodesBetween(e,r,a=>(n.isInSet(a.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),_7(this.marks,e)}contentMatchAt(e){let r=this.type.contentMatch.matchFragment(this.content,0,e);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(e,r,n=be.empty,i=0,a=n.childCount){let s=this.contentMatchAt(e).matchFragment(n,i,a),o=s&&s.matchFragment(this.content,r);if(!o||!o.validEnd)return!1;for(let l=i;l<a;l++)if(!this.type.allowsMarks(n.child(l).marks))return!1;return!0}canReplaceWith(e,r,n,i){if(i&&!this.type.allowsMarks(i))return!1;let a=this.contentMatchAt(e).matchType(n),s=a&&a.matchFragment(this.content,r);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Gt.none;for(let r=0;r<this.marks.length;r++){let n=this.marks[r];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!Gt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(r=>r.toJSON())),e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let n;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=r.marks.map(e.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(r.text,n)}let i=be.fromJSON(e,r.content),a=e.nodeType(r.type).create(r.attrs,i,n);return a.type.checkAttrs(a.attrs),a}};Ws.prototype.text=void 0;class B0 extends Ws{constructor(e,r,n,i){if(super(e,r,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):_7(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,r){return this.text.slice(e,r)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new B0(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new B0(this.type,this.attrs,e,this.marks)}cut(e=0,r=this.text.length){return e==0&&r==this.text.length?this:this.withText(this.text.slice(e,r))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function _7(t,e){for(let r=t.length-1;r>=0;r--)e=t[r].type.name+"("+e+")";return e}class Gu{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,r){let n=new UY(e,r);if(n.next==null)return Gu.empty;let i=A7(n);n.next&&n.err("Unexpected trailing text");let a=XY(YY(i));return QY(a,n),a}matchType(e){for(let r=0;r<this.next.length;r++)if(this.next[r].type==e)return this.next[r].next;return null}matchFragment(e,r=0,n=e.childCount){let i=this;for(let a=r;i&&a<n;a++)i=i.matchType(e.child(a).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:r}=this.next[e];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(e){for(let r=0;r<this.next.length;r++)for(let n=0;n<e.next.length;n++)if(this.next[r].type==e.next[n].type)return!0;return!1}fillBefore(e,r=!1,n=0){let i=[this];function a(s,o){let l=s.matchFragment(e,n);if(l&&(!r||l.validEnd))return be.from(o.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:c,next:d}=s.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let h=a(d,o.concat(c));if(h)return h}}return null}return a(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let r=this.computeWrapping(e);return this.wrapCache.push(e,r),r}computeWrapping(e){let r=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),a=i.match;if(a.matchType(e)){let s=[];for(let o=i;o.type;o=o.via)s.push(o.type);return s.reverse()}for(let s=0;s<a.next.length;s++){let{type:o,next:l}=a.next[s];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in r)&&(!i.type||l.validEnd)&&(n.push({match:o.contentMatch,type:o,via:i}),r[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function r(n){e.push(n);for(let i=0;i<n.next.length;i++)e.indexOf(n.next[i].next)==-1&&r(n.next[i].next)}return r(this),e.map((n,i)=>{let a=i+(n.validEnd?"*":" ")+" ";for(let s=0;s<n.next.length;s++)a+=(s?", ":"")+n.next[s].type.name+"->"+e.indexOf(n.next[s].next);return a}).join(`
`)}}Gu.empty=new Gu(!0);class UY{constructor(e,r){this.string=e,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function A7(t){let e=[];do e.push(GY(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function GY(t){let e=[];do e.push(HY(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function HY(t){let e=KY(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=WY(t,e);else break;return e}function c9(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function WY(t,e){let r=c9(t),n=r;return t.eat(",")&&(t.next!="}"?n=c9(t):n=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:e}}function qY(t,e){let r=t.nodeTypes,n=r[e];if(n)return[n];let i=[];for(let a in r){let s=r[a];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function KY(t){if(t.eat("(")){let e=A7(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=qY(t,t.next).map(r=>(t.inline==null?t.inline=r.isInline:t.inline!=r.isInline&&t.err("Mixing inline and block content"),{type:"name",value:r}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function YY(t){let e=[[]];return i(a(t,0),r()),e;function r(){return e.push([])-1}function n(s,o,l){let u={term:l,to:o};return e[s].push(u),u}function i(s,o){s.forEach(l=>l.to=o)}function a(s,o){if(s.type=="choice")return s.exprs.reduce((l,u)=>l.concat(a(u,o)),[]);if(s.type=="seq")for(let l=0;;l++){let u=a(s.exprs[l],o);if(l==s.exprs.length-1)return u;i(u,o=r())}else if(s.type=="star"){let l=r();return n(o,l),i(a(s.expr,l),l),[n(l)]}else if(s.type=="plus"){let l=r();return i(a(s.expr,o),l),i(a(s.expr,l),l),[n(l)]}else{if(s.type=="opt")return[n(o)].concat(a(s.expr,o));if(s.type=="range"){let l=o;for(let u=0;u<s.min;u++){let c=r();i(a(s.expr,l),c),l=c}if(s.max==-1)i(a(s.expr,l),l);else for(let u=s.min;u<s.max;u++){let c=r();n(l,c),i(a(s.expr,l),c),l=c}return[n(l)]}else{if(s.type=="name")return[n(o,void 0,s.value)];throw new Error("Unknown expr type")}}}}function R7(t,e){return e-t}function d9(t,e){let r=[];return n(e),r.sort(R7);function n(i){let a=t[i];if(a.length==1&&!a[0].term)return n(a[0].to);r.push(i);for(let s=0;s<a.length;s++){let{term:o,to:l}=a[s];!o&&r.indexOf(l)==-1&&n(l)}}}function XY(t){let e=Object.create(null);return r(d9(t,0));function r(n){let i=[];n.forEach(s=>{t[s].forEach(({term:o,to:l})=>{if(!o)return;let u;for(let c=0;c<i.length;c++)i[c][0]==o&&(u=i[c][1]);d9(t,l).forEach(c=>{u||i.push([o,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let a=e[n.join(",")]=new Gu(n.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let o=i[s][1].sort(R7);a.next.push({type:i[s][0],next:e[o.join(",")]||r(o)})}return a}}function QY(t,e){for(let r=0,n=[t];r<n.length;r++){let i=n[r],a=!i.validEnd,s=[];for(let o=0;o<i.next.length;o++){let{type:l,next:u}=i.next[o];s.push(l.name),a&&!(l.isText||l.hasRequiredAttrs())&&(a=!1),n.indexOf(u)==-1&&n.push(u)}a&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function D7(t){let e=Object.create(null);for(let r in t){let n=t[r];if(!n.hasDefault)return null;e[r]=n.default}return e}function O7(t,e){let r=Object.create(null);for(let n in t){let i=e&&e[n];if(i===void 0){let a=t[n];if(a.hasDefault)i=a.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=i}return r}function I7(t,e,r,n){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${r} of type ${i}`);for(let i in t){let a=t[i];a.validate&&a.validate(e[i])}}function L7(t,e){let r=Object.create(null);if(e)for(let n in e)r[n]=new ZY(t,n,e[n]);return r}let f9=class B7{constructor(e,r,n){this.name=e,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=L7(e,n.attrs),this.defaultAttrs=D7(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Gu.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:O7(this.attrs,e)}create(e=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Ws(this,this.computeAttrs(e),be.from(r),Gt.setFrom(n))}createChecked(e=null,r,n){return r=be.from(r),this.checkContent(r),new Ws(this,this.computeAttrs(e),r,Gt.setFrom(n))}createAndFill(e=null,r,n){if(e=this.computeAttrs(e),r=be.from(r),r.size){let s=this.contentMatch.fillBefore(r);if(!s)return null;r=s.append(r)}let i=this.contentMatch.matchFragment(r),a=i&&i.fillBefore(be.empty,!0);return a?new Ws(this,e,r.append(a),Gt.setFrom(n)):null}validContent(e){let r=this.contentMatch.matchFragment(e);if(!r||!r.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){I7(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let r=0;r<e.length;r++)if(!this.allowsMarkType(e[r].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let r;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?r&&r.push(e[n]):r||(r=e.slice(0,n));return r?r.length?r:Gt.none:e}static compile(e,r){let n=Object.create(null);e.forEach((a,s)=>n[a]=new B7(a,r,s));let i=r.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let a in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function JY(t,e,r){let n=r.split("|");return i=>{let a=i===null?"null":typeof i;if(n.indexOf(a)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${t}, got ${a}`)}}class ZY{constructor(e,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?JY(e,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class px{constructor(e,r,n,i){this.name=e,this.rank=r,this.schema=n,this.spec=i,this.attrs=L7(e,i.attrs),this.excluded=null;let a=D7(this.attrs);this.instance=a?new Gt(this,a):null}create(e=null){return!e&&this.instance?this.instance:new Gt(this,O7(this.attrs,e))}static compile(e,r){let n=Object.create(null),i=0;return e.forEach((a,s)=>n[a]=new px(a,i++,r,s)),n}removeFromSet(e){for(var r=0;r<e.length;r++)e[r].type==this&&(e=e.slice(0,r).concat(e.slice(r+1)),r--);return e}isInSet(e){for(let r=0;r<e.length;r++)if(e[r].type==this)return e[r]}checkAttrs(e){I7(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class F7{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let i in e)r[i]=e[i];r.nodes=Sn.from(e.nodes),r.marks=Sn.from(e.marks||{}),this.nodes=f9.compile(this.spec.nodes,this),this.marks=px.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let a=this.nodes[i],s=a.spec.content||"",o=a.spec.marks;if(a.contentMatch=n[s]||(n[s]=Gu.parse(s,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=o=="_"?null:o?h9(this,o.split(" ")):o==""||!a.inlineContent?[]:null}for(let i in this.marks){let a=this.marks[i],s=a.spec.excludes;a.excluded=s==null?[a]:s==""?[]:h9(this,s.split(" "))}this.nodeFromJSON=i=>Ws.fromJSON(this,i),this.markFromJSON=i=>Gt.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,r=null,n,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof f9){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(r,n,i)}text(e,r){let n=this.nodes.text;return new B0(n,n.defaultAttrs,e,Gt.setFrom(r))}mark(e,r){return typeof e=="string"&&(e=this.marks[e]),e.create(r)}nodeType(e){let r=this.nodes[e];if(!r)throw new RangeError("Unknown node type: "+e);return r}}function h9(t,e){let r=[];for(let n=0;n<e.length;n++){let i=e[n],a=t.marks[i],s=a;if(a)r.push(a);else for(let o in t.marks){let l=t.marks[o];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&r.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return r}function eX(t){return t.tag!=null}function tX(t){return t.style!=null}class ul{constructor(e,r){this.schema=e,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(i=>{if(eX(i))this.tags.push(i);else if(tX(i)){let a=/[^=]*/.exec(i.style)[0];n.indexOf(a)<0&&n.push(a),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let a=e.nodes[i.node];return a.contentMatch.matchType(a)})}parse(e,r={}){let n=new m9(this,r,!1);return n.addAll(e,Gt.none,r.from,r.to),n.finish()}parseSlice(e,r={}){let n=new m9(this,r,!0);return n.addAll(e,Gt.none,r.from,r.to),Ae.maxOpen(n.finish())}matchTag(e,r,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let a=this.tags[i];if(iX(e,a.tag)&&(a.namespace===void 0||e.namespaceURI==a.namespace)&&(!a.context||r.matchesContext(a.context))){if(a.getAttrs){let s=a.getAttrs(e);if(s===!1)continue;a.attrs=s||void 0}return a}}}matchStyle(e,r,n,i){for(let a=i?this.styles.indexOf(i)+1:0;a<this.styles.length;a++){let s=this.styles[a],o=s.style;if(!(o.indexOf(e)!=0||s.context&&!n.matchesContext(s.context)||o.length>e.length&&(o.charCodeAt(e.length)!=61||o.slice(e.length+1)!=r))){if(s.getAttrs){let l=s.getAttrs(r);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let r=[];function n(i){let a=i.priority==null?50:i.priority,s=0;for(;s<r.length;s++){let o=r[s];if((o.priority==null?50:o.priority)<a)break}r.splice(s,0,i)}for(let i in e.marks){let a=e.marks[i].spec.parseDOM;a&&a.forEach(s=>{n(s=g9(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let a=e.nodes[i].spec.parseDOM;a&&a.forEach(s=>{n(s=g9(s)),s.node||s.ignore||s.mark||(s.node=i)})}return r}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new ul(e,ul.schemaRules(e)))}}const z7={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},rX={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},V7={ol:!0,ul:!0},jp=1,ak=2,zh=4;function p9(t,e,r){return e!=null?(e?jp:0)|(e==="full"?ak:0):t&&t.whitespace=="pre"?jp|ak:r&~zh}class Yg{constructor(e,r,n,i,a,s){this.type=e,this.attrs=r,this.marks=n,this.solid=i,this.options=s,this.content=[],this.activeMarks=Gt.none,this.match=a||(s&zh?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(be.from(e));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&jp)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let a=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-i[0].length))}}let r=be.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(be.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!z7.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class m9{constructor(e,r,n){this.parser=e,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let i=r.topNode,a,s=p9(null,r.preserveWhitespace,0)|(n?zh:0);i?a=new Yg(i.type,i.attrs,Gt.none,!0,r.topMatch||i.type.contentMatch,s):n?a=new Yg(null,null,Gt.none,!0,null,s):a=new Yg(e.schema.topNodeType,null,Gt.none,!0,null,s),this.nodes=[a],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,r){e.nodeType==3?this.addTextNode(e,r):e.nodeType==1&&this.addElement(e,r)}addTextNode(e,r){let n=e.nodeValue,i=this.top,a=i.options&ak?"full":this.localPreserveWS||(i.options&jp)>0,{schema:s}=this.parser;if(a==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(a)if(a==="full")n=n.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(s.linebreakReplacement.create())){let o=n.split(/\r?\n|\r/);for(let l=0;l<o.length;l++)l&&this.insertNode(s.linebreakReplacement.create(),r,!0),o[l]&&this.insertNode(s.text(o[l]),r,!/\S/.test(o[l]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let o=i.content[i.content.length-1],l=e.previousSibling;(!o||l&&l.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(n=n.slice(1))}n&&this.insertNode(s.text(n),r,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,r,n){let i=this.localPreserveWS,a=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),o;V7.hasOwnProperty(s)&&this.parser.normalizeLists&&nX(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,n));e:if(l?l.ignore:rX.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,r);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let u,c=this.needsBlock;if(z7.hasOwnProperty(s))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),u=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,r);break e}let d=l&&l.skip?r:this.readStyles(e,r);d&&this.addAll(e,d),u&&this.sync(a),this.needsBlock=c}else{let u=this.readStyles(e,r);u&&this.addElementByRule(e,l,u,l.consuming===!1?o:void 0)}this.localPreserveWS=i}leafFallback(e,r){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),r)}ignoreFallback(e,r){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(e,r){let n=e.style;if(n&&n.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let a=this.parser.matchedStyles[i],s=n.getPropertyValue(a);if(s)for(let o=void 0;;){let l=this.parser.matchStyle(a,s,this,o);if(!l)break;if(l.ignore)return null;if(l.clearMark?r=r.filter(u=>!l.clearMark(u)):r=r.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)o=l;else break}}return r}addElementByRule(e,r,n,i){let a,s;if(r.node)if(s=this.parser.schema.nodes[r.node],s.isLeaf)this.insertNode(s.create(r.attrs),n,e.nodeName=="BR")||this.leafFallback(e,n);else{let l=this.enter(s,r.attrs||null,n,r.preserveWhitespace);l&&(a=!0,n=l)}else{let l=this.parser.schema.marks[r.mark];n=n.concat(l.create(r.attrs))}let o=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,n,i);else if(r.getContent)this.findInside(e),r.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,n,!1));else{let l=e;typeof r.contentElement=="string"?l=e.querySelector(r.contentElement):typeof r.contentElement=="function"?l=r.contentElement(e):r.contentElement&&(l=r.contentElement),this.findAround(e,l,!0),this.addAll(l,n),this.findAround(e,l,!1)}a&&this.sync(o)&&this.open--}addAll(e,r,n,i){let a=n||0;for(let s=n?e.childNodes[n]:e.firstChild,o=i==null?null:e.childNodes[i];s!=o;s=s.nextSibling,++a)this.findAtPoint(e,a),this.addDOM(s,r);this.findAtPoint(e,a)}findPlace(e,r,n){let i,a;for(let s=this.open,o=0;s>=0;s--){let l=this.nodes[s],u=l.findWrapping(e);if(u&&(!i||i.length>u.length+o)&&(i=u,a=l,!u.length))break;if(l.solid){if(n)break;o+=2}}if(!i)return null;this.sync(a);for(let s=0;s<i.length;s++)r=this.enterInner(i[s],null,r,!1);return r}insertNode(e,r,n){if(e.isInline&&this.needsBlock&&!this.top.type){let a=this.textblockFromContext();a&&(r=this.enterInner(a,null,r))}let i=this.findPlace(e,r,n);if(i){this.closeExtra();let a=this.top;a.match&&(a.match=a.match.matchType(e.type));let s=Gt.none;for(let o of i.concat(e.marks))(a.type?a.type.allowsMarkType(o.type):v9(o.type,e.type))&&(s=o.addToSet(s));return a.content.push(e.mark(s)),!0}return!1}enter(e,r,n,i){let a=this.findPlace(e.create(r),n,!1);return a&&(a=this.enterInner(e,r,n,!0,i)),a}enterInner(e,r,n,i=!1,a){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let o=p9(e,a,s.options);s.options&zh&&s.content.length==0&&(o|=zh);let l=Gt.none;return n=n.filter(u=>(s.type?s.type.allowsMarkType(u.type):v9(u.type,e))?(l=u.addToSet(l),!1):!0),this.nodes.push(new Yg(e,r,l,i,null,o)),this.open++,n}closeExtra(e=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let r=this.open;r>=0;r--){if(this.nodes[r]==e)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=jp)}return!1}get currentPos(){this.closeExtra();let e=0;for(let r=this.open;r>=0;r--){let n=this.nodes[r].content;for(let i=n.length-1;i>=0;i--)e+=n[i].nodeSize;r&&e++}return e}findAtPoint(e,r){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==r&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(e,r,n){if(e!=r&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&r.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&(this.find[r].pos=this.currentPos-(e.nodeValue.length-this.find[r].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let r=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),a=-(n?n.depth+1:0)+(i?0:1),s=(o,l)=>{for(;o>=0;o--){let u=r[o];if(u==""){if(o==r.length-1||o==0)continue;for(;l>=a;l--)if(s(o-1,l))return!0;return!1}else{let c=l>0||l==0&&i?this.nodes[l].type:n&&l>=a?n.node(l-a).type:null;if(!c||c.name!=u&&!c.isInGroup(u))return!1;l--}}return!0};return s(r.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let r=e.depth;r>=0;r--){let n=e.node(r).contentMatchAt(e.indexAfter(r)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let r in this.parser.schema.nodes){let n=this.parser.schema.nodes[r];if(n.isTextblock&&n.defaultAttrs)return n}}}function nX(t){for(let e=t.firstChild,r=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&V7.hasOwnProperty(n)&&r?(r.appendChild(e),e=r):n=="li"?r=e:n&&(r=null)}}function iX(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function g9(t){let e={};for(let r in t)e[r]=t[r];return e}function v9(t,e){let r=e.schema.nodes;for(let n in r){let i=r[n];if(!i.allowsMarkType(t))continue;let a=[],s=o=>{a.push(o);for(let l=0;l<o.edgeCount;l++){let{type:u,next:c}=o.edge(l);if(u==e||a.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}class tc{constructor(e,r){this.nodes=e,this.marks=r}serializeFragment(e,r={},n){n||(n=X2(r).createDocumentFragment());let i=n,a=[];return e.forEach(s=>{if(a.length||s.marks.length){let o=0,l=0;for(;o<a.length&&l<s.marks.length;){let u=s.marks[l];if(!this.marks[u.type.name]){l++;continue}if(!u.eq(a[o][0])||u.type.spec.spanning===!1)break;o++,l++}for(;o<a.length;)i=a.pop()[1];for(;l<s.marks.length;){let u=s.marks[l++],c=this.serializeMark(u,s.isInline,r);c&&(a.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,r))}),n}serializeNodeInner(e,r){let{dom:n,contentDOM:i}=Lv(X2(r),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,r,i)}return n}serializeNode(e,r={}){let n=this.serializeNodeInner(e,r);for(let i=e.marks.length-1;i>=0;i--){let a=this.serializeMark(e.marks[i],e.isInline,r);a&&((a.contentDOM||a.dom).appendChild(n),n=a.dom)}return n}serializeMark(e,r,n={}){let i=this.marks[e.type.name];return i&&Lv(X2(n),i(e,r),null,e.attrs)}static renderSpec(e,r,n=null,i){return Lv(e,r,n,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new tc(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let r=y9(e.nodes);return r.text||(r.text=n=>n.text),r}static marksFromSchema(e){return y9(e.marks)}}function y9(t){let e={};for(let r in t){let n=t[r].spec.toDOM;n&&(e[r]=n)}return e}function X2(t){return t.document||window.document}const x9=new WeakMap;function aX(t){let e=x9.get(t);return e===void 0&&x9.set(t,e=sX(t)),e}function sX(t){let e=null;function r(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")e||(e=[]),e.push(n);else for(let i=0;i<n.length;i++)r(n[i]);else for(let i in n)r(n[i])}return r(t),e}function Lv(t,e,r,n){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],a;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(a=aX(n))&&a.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,l=r?t.createElementNS(r,i):t.createElement(i),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let d in u)if(u[d]!=null){let h=d.indexOf(" ");h>0?l.setAttributeNS(d.slice(0,h),d.slice(h+1),u[d]):d=="style"&&l.style?l.style.cssText=u[d]:l.setAttribute(d,u[d])}}for(let d=c;d<e.length;d++){let h=e[d];if(h===0){if(d<e.length-1||d>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:m,contentDOM:v}=Lv(t,h,r,n);if(l.appendChild(m),v){if(o)throw new RangeError("Multiple content holes");o=v}}}return{dom:l,contentDOM:o}}const $7=65535,U7=Math.pow(2,16);function oX(t,e){return t+e*U7}function b9(t){return t&$7}function lX(t){return(t-(t&$7))/U7}const G7=1,H7=2,Bv=4,W7=8;class sk{constructor(e,r,n){this.pos=e,this.delInfo=r,this.recover=n}get deleted(){return(this.delInfo&W7)>0}get deletedBefore(){return(this.delInfo&(G7|Bv))>0}get deletedAfter(){return(this.delInfo&(H7|Bv))>0}get deletedAcross(){return(this.delInfo&Bv)>0}}class Mi{constructor(e,r=!1){if(this.ranges=e,this.inverted=r,!e.length&&Mi.empty)return Mi.empty}recover(e){let r=0,n=b9(e);if(!this.inverted)for(let i=0;i<n;i++)r+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[n*3]+r+lX(e)}mapResult(e,r=1){return this._map(e,r,!1)}map(e,r=1){return this._map(e,r,!0)}_map(e,r,n){let i=0,a=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?i:0);if(l>e)break;let u=this.ranges[o+a],c=this.ranges[o+s],d=l+u;if(e<=d){let h=u?e==l?-1:e==d?1:r:r,m=l+i+(h<0?0:c);if(n)return m;let v=e==(r<0?l:d)?null:oX(o/3,e-l),x=e==l?H7:e==d?G7:Bv;return(r<0?e!=l:e!=d)&&(x|=W7),new sk(m,x,v)}i+=c-u}return n?e+i:new sk(e+i,0,null)}touches(e,r){let n=0,i=b9(r),a=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?n:0);if(l>e)break;let u=this.ranges[o+a],c=l+u;if(e<=c&&o==i*3)return!0;n+=this.ranges[o+s]-u}return!1}forEach(e){let r=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,a=0;i<this.ranges.length;i+=3){let s=this.ranges[i],o=s-(this.inverted?a:0),l=s+(this.inverted?0:a),u=this.ranges[i+r],c=this.ranges[i+n];e(o,o+u,l,l+c),a+=c-u}}invert(){return new Mi(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Mi.empty:new Mi(e<0?[0,-e,0]:[0,0,e])}}Mi.empty=new Mi([]);class Mp{constructor(e,r,n=0,i=e?e.length:0){this.mirror=r,this.from=n,this.to=i,this._maps=e||[],this.ownData=!(e||r)}get maps(){return this._maps}slice(e=0,r=this.maps.length){return new Mp(this._maps,this.mirror,e,r)}appendMap(e,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(e){for(let r=0,n=this._maps.length;r<e._maps.length;r++){let i=e.getMirror(r);this.appendMap(e._maps[r],i!=null&&i<r?n+i:void 0)}}getMirror(e){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==e)return this.mirror[r+(r%2?-1:1)]}}setMirror(e,r){this.mirror||(this.mirror=[]),this.mirror.push(e,r)}appendMappingInverted(e){for(let r=e.maps.length-1,n=this._maps.length+e._maps.length;r>=0;r--){let i=e.getMirror(r);this.appendMap(e._maps[r].invert(),i!=null&&i>r?n-i-1:void 0)}}invert(){let e=new Mp;return e.appendMappingInverted(this),e}map(e,r=1){if(this.mirror)return this._map(e,r,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,r);return e}mapResult(e,r=1){return this._map(e,r,!1)}_map(e,r,n){let i=0;for(let a=this.from;a<this.to;a++){let s=this._maps[a],o=s.mapResult(e,r);if(o.recover!=null){let l=this.getMirror(a);if(l!=null&&l>a&&l<this.to){a=l,e=this._maps[l].recover(o.recover);continue}}i|=o.delInfo,e=o.pos}return n?e:new sk(e,i,null)}}const Q2=Object.create(null);class qn{getMap(){return Mi.empty}merge(e){return null}static fromJSON(e,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Q2[r.stepType];if(!n)throw new RangeError(`No step type ${r.stepType} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in Q2)throw new RangeError("Duplicate use of step JSON ID "+e);return Q2[e]=r,r.prototype.jsonID=e,r}}class $r{constructor(e,r){this.doc=e,this.failed=r}static ok(e){return new $r(e,null)}static fail(e){return new $r(null,e)}static fromReplace(e,r,n,i){try{return $r.ok(e.replace(r,n,i))}catch(a){if(a instanceof O0)return $r.fail(a.message);throw a}}}function x3(t,e,r){let n=[];for(let i=0;i<t.childCount;i++){let a=t.child(i);a.content.size&&(a=a.copy(x3(a.content,e,a))),a.isInline&&(a=e(a,r,i)),n.push(a)}return be.fromArray(n)}class Yo extends qn{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),a=new Ae(x3(r.content,(s,o)=>!s.isAtom||!o.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),r.openStart,r.openEnd);return $r.fromReplace(e,this.from,this.to,a)}invert(){return new Pa(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new Yo(r.pos,n.pos,this.mark)}merge(e){return e instanceof Yo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Yo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Yo(r.from,r.to,e.markFromJSON(r.mark))}}qn.jsonID("addMark",Yo);class Pa extends qn{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=new Ae(x3(r.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),r.openStart,r.openEnd);return $r.fromReplace(e,this.from,this.to,n)}invert(){return new Yo(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new Pa(r.pos,n.pos,this.mark)}merge(e){return e instanceof Pa&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Pa(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Pa(r.from,r.to,e.markFromJSON(r.mark))}}qn.jsonID("removeMark",Pa);class Xo extends qn{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return $r.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return $r.fromReplace(e,this.pos,this.pos+1,new Ae(be.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);if(r){let n=this.mark.addToSet(r.marks);if(n.length==r.marks.length){for(let i=0;i<r.marks.length;i++)if(!r.marks[i].isInSet(n))return new Xo(this.pos,r.marks[i]);return new Xo(this.pos,this.mark)}}return new Hu(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new Xo(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Xo(r.pos,e.markFromJSON(r.mark))}}qn.jsonID("addNodeMark",Xo);class Hu extends qn{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return $r.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return $r.fromReplace(e,this.pos,this.pos+1,new Ae(be.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new Xo(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new Hu(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Hu(r.pos,e.markFromJSON(r.mark))}}qn.jsonID("removeNodeMark",Hu);class dn extends qn{constructor(e,r,n,i=!1){super(),this.from=e,this.to=r,this.slice=n,this.structure=i}apply(e){return this.structure&&ok(e,this.from,this.to)?$r.fail("Structure replace would overwrite content"):$r.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Mi([this.from,this.to-this.from,this.slice.size])}invert(e){return new dn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deletedAcross&&n.deletedAcross?null:new dn(r.pos,Math.max(r.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof dn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let r=this.slice.size+e.slice.size==0?Ae.empty:new Ae(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new dn(this.from,this.to+(e.to-e.from),r,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let r=this.slice.size+e.slice.size==0?Ae.empty:new Ae(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new dn(e.from,this.to,r,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new dn(r.from,r.to,Ae.fromJSON(e,r.slice),!!r.structure)}}qn.jsonID("replace",dn);class mn extends qn{constructor(e,r,n,i,a,s,o=!1){super(),this.from=e,this.to=r,this.gapFrom=n,this.gapTo=i,this.slice=a,this.insert=s,this.structure=o}apply(e){if(this.structure&&(ok(e,this.from,this.gapFrom)||ok(e,this.gapTo,this.to)))return $r.fail("Structure gap-replace would overwrite content");let r=e.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return $r.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,r.content);return n?$r.fromReplace(e,this.from,this.to,n):$r.fail("Content does not fit in gap")}getMap(){return new Mi([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let r=this.gapTo-this.gapFrom;return new mn(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=this.from==this.gapFrom?r.pos:e.map(this.gapFrom,-1),a=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return r.deletedAcross&&n.deletedAcross||i<r.pos||a>n.pos?null:new mn(r.pos,n.pos,i,a,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new mn(r.from,r.to,r.gapFrom,r.gapTo,Ae.fromJSON(e,r.slice),r.insert,!!r.structure)}}qn.jsonID("replaceAround",mn);function ok(t,e,r){let n=t.resolve(e),i=r-e,a=n.depth;for(;i>0&&a>0&&n.indexAfter(a)==n.node(a).childCount;)a--,i--;if(i>0){let s=n.node(a).maybeChild(n.indexAfter(a));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function uX(t,e,r,n){let i=[],a=[],s,o;t.doc.nodesBetween(e,r,(l,u,c)=>{if(!l.isInline)return;let d=l.marks;if(!n.isInSet(d)&&c.type.allowsMarkType(n.type)){let h=Math.max(u,e),m=Math.min(u+l.nodeSize,r),v=n.addToSet(d);for(let x=0;x<d.length;x++)d[x].isInSet(v)||(s&&s.to==h&&s.mark.eq(d[x])?s.to=m:i.push(s=new Pa(h,m,d[x])));o&&o.to==h?o.to=m:a.push(o=new Yo(h,m,n))}}),i.forEach(l=>t.step(l)),a.forEach(l=>t.step(l))}function cX(t,e,r,n){let i=[],a=0;t.doc.nodesBetween(e,r,(s,o)=>{if(!s.isInline)return;a++;let l=null;if(n instanceof px){let u=s.marks,c;for(;c=n.isInSet(u);)(l||(l=[])).push(c),u=c.removeFromSet(u)}else n?n.isInSet(s.marks)&&(l=[n]):l=s.marks;if(l&&l.length){let u=Math.min(o+s.nodeSize,r);for(let c=0;c<l.length;c++){let d=l[c],h;for(let m=0;m<i.length;m++){let v=i[m];v.step==a-1&&d.eq(i[m].style)&&(h=v)}h?(h.to=u,h.step=a):i.push({style:d,from:Math.max(o,e),to:u,step:a})}}}),i.forEach(s=>t.step(new Pa(s.from,s.to,s.style)))}function b3(t,e,r,n=r.contentMatch,i=!0){let a=t.doc.nodeAt(e),s=[],o=e+1;for(let l=0;l<a.childCount;l++){let u=a.child(l),c=o+u.nodeSize,d=n.matchType(u.type);if(!d)s.push(new dn(o,c,Ae.empty));else{n=d;for(let h=0;h<u.marks.length;h++)r.allowsMarkType(u.marks[h].type)||t.step(new Pa(o,c,u.marks[h]));if(i&&u.isText&&r.whitespace!="pre"){let h,m=/\r?\n|\r/g,v;for(;h=m.exec(u.text);)v||(v=new Ae(be.from(r.schema.text(" ",r.allowedMarks(u.marks))),0,0)),s.push(new dn(o+h.index,o+h.index+h[0].length,v))}}o=c}if(!n.validEnd){let l=n.fillBefore(be.empty,!0);t.replace(o,o,new Ae(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function dX(t,e,r){return(e==0||t.canReplace(e,t.childCount))&&(r==t.childCount||t.canReplace(0,r))}function uf(t){let r=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth,i=0,a=0;;--n){let s=t.$from.node(n),o=t.$from.index(n)+i,l=t.$to.indexAfter(n)-a;if(n<t.depth&&s.canReplace(o,l,r))return n;if(n==0||s.type.spec.isolating||!dX(s,o,l))break;o&&(i=1),l<s.childCount&&(a=1)}return null}function fX(t,e,r){let{$from:n,$to:i,depth:a}=e,s=n.before(a+1),o=i.after(a+1),l=s,u=o,c=be.empty,d=0;for(let v=a,x=!1;v>r;v--)x||n.index(v)>0?(x=!0,c=be.from(n.node(v).copy(c)),d++):l--;let h=be.empty,m=0;for(let v=a,x=!1;v>r;v--)x||i.after(v+1)<i.end(v)?(x=!0,h=be.from(i.node(v).copy(h)),m++):u++;t.step(new mn(l,u,s,o,new Ae(c.append(h),d,m),c.size-d,!0))}function w3(t,e,r=null,n=t){let i=hX(t,e),a=i&&pX(n,e);return a?i.map(w9).concat({type:e,attrs:r}).concat(a.map(w9)):null}function w9(t){return{type:t,attrs:null}}function hX(t,e){let{parent:r,startIndex:n,endIndex:i}=t,a=r.contentMatchAt(n).findWrapping(e);if(!a)return null;let s=a.length?a[0]:e;return r.canReplaceWith(n,i,s)?a:null}function pX(t,e){let{parent:r,startIndex:n,endIndex:i}=t,a=r.child(n),s=e.contentMatch.findWrapping(a.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let u=n;l&&u<i;u++)l=l.matchType(r.child(u).type);return!l||!l.validEnd?null:s}function mX(t,e,r){let n=be.empty;for(let s=r.length-1;s>=0;s--){if(n.size){let o=r[s].type.contentMatch.matchFragment(n);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=be.from(r[s].type.create(r[s].attrs,n))}let i=e.start,a=e.end;t.step(new mn(i,a,i,a,new Ae(n,0,0),r.length,!0))}function gX(t,e,r,n,i){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=t.steps.length;t.doc.nodesBetween(e,r,(s,o)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(n,l)&&vX(t.doc,t.mapping.slice(a).map(o),n)){let u=null;if(n.schema.linebreakReplacement){let m=n.whitespace=="pre",v=!!n.contentMatch.matchType(n.schema.linebreakReplacement);m&&!v?u=!1:!m&&v&&(u=!0)}u===!1&&K7(t,s,o,a),b3(t,t.mapping.slice(a).map(o,1),n,void 0,u===null);let c=t.mapping.slice(a),d=c.map(o,1),h=c.map(o+s.nodeSize,1);return t.step(new mn(d,h,d+1,h-1,new Ae(be.from(n.create(l,null,s.marks)),0,0),1,!0)),u===!0&&q7(t,s,o,a),!1}})}function q7(t,e,r,n){e.forEach((i,a)=>{if(i.isText){let s,o=/\r?\n|\r/g;for(;s=o.exec(i.text);){let l=t.mapping.slice(n).map(r+1+a+s.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function K7(t,e,r,n){e.forEach((i,a)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(n).map(r+1+a);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function vX(t,e,r){let n=t.resolve(e),i=n.index();return n.parent.canReplaceWith(i,i+1,r)}function yX(t,e,r,n,i){let a=t.doc.nodeAt(e);if(!a)throw new RangeError("No node at given position");r||(r=a.type);let s=r.create(n,null,i||a.marks);if(a.isLeaf)return t.replaceWith(e,e+a.nodeSize,s);if(!r.validContent(a.content))throw new RangeError("Invalid content for node type "+r.name);t.step(new mn(e,e+a.nodeSize,e+1,e+a.nodeSize-1,new Ae(be.from(s),0,0),1,!0))}function Sd(t,e,r=1,n){let i=t.resolve(e),a=i.depth-r,s=n&&n[n.length-1]||i.parent;if(a<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=r-2;u>a;u--,c--){let d=i.node(u),h=i.index(u);if(d.type.spec.isolating)return!1;let m=d.content.cutByIndex(h,d.childCount),v=n&&n[c+1];v&&(m=m.replaceChild(0,v.type.create(v.attrs)));let x=n&&n[c]||d;if(!d.canReplace(h+1,d.childCount)||!x.type.validContent(m))return!1}let o=i.indexAfter(a),l=n&&n[0];return i.node(a).canReplaceWith(o,o,l?l.type:i.node(a+1).type)}function xX(t,e,r=1,n){let i=t.doc.resolve(e),a=be.empty,s=be.empty;for(let o=i.depth,l=i.depth-r,u=r-1;o>l;o--,u--){a=be.from(i.node(o).copy(a));let c=n&&n[u];s=be.from(c?c.type.create(c.attrs,s):i.node(o).copy(s))}t.step(new dn(e,e,new Ae(a.append(s),r,r),!0))}function Dl(t,e){let r=t.resolve(e),n=r.index();return Y7(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function bX(t,e){e.content.size||t.type.compatibleContent(e.type);let r=t.contentMatchAt(t.childCount),{linebreakReplacement:n}=t.type.schema;for(let i=0;i<e.childCount;i++){let a=e.child(i),s=a.type==n?t.type.schema.nodes.text:a.type;if(r=r.matchType(s),!r||!t.type.allowsMarks(a.marks))return!1}return r.validEnd}function Y7(t,e){return!!(t&&e&&!t.isLeaf&&bX(t,e))}function mx(t,e,r=-1){let n=t.resolve(e);for(let i=n.depth;;i--){let a,s,o=n.index(i);if(i==n.depth?(a=n.nodeBefore,s=n.nodeAfter):r>0?(a=n.node(i+1),o++,s=n.node(i).maybeChild(o)):(a=n.node(i).maybeChild(o-1),s=n.node(i+1)),a&&!a.isTextblock&&Y7(a,s)&&n.node(i).canReplace(o,o+1))return e;if(i==0)break;e=r<0?n.before(i):n.after(i)}}function wX(t,e,r){let n=null,{linebreakReplacement:i}=t.doc.type.schema,a=t.doc.resolve(e-r),s=a.node().type;if(i&&s.inlineContent){let c=s.whitespace=="pre",d=!!s.contentMatch.matchType(i);c&&!d?n=!1:!c&&d&&(n=!0)}let o=t.steps.length;if(n===!1){let c=t.doc.resolve(e+r);K7(t,c.node(),c.before(),o)}s.inlineContent&&b3(t,e+r-1,s,a.node().contentMatchAt(a.index()),n==null);let l=t.mapping.slice(o),u=l.map(e-r);if(t.step(new dn(u,l.map(e+r,-1),Ae.empty,!0)),n===!0){let c=t.doc.resolve(u);q7(t,c.node(),c.before(),t.steps.length)}return t}function SX(t,e,r){let n=t.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),r))return e;if(n.parentOffset==0)for(let i=n.depth-1;i>=0;i--){let a=n.index(i);if(n.node(i).canReplaceWith(a,a,r))return n.before(i+1);if(a>0)return null}if(n.parentOffset==n.parent.content.size)for(let i=n.depth-1;i>=0;i--){let a=n.indexAfter(i);if(n.node(i).canReplaceWith(a,a,r))return n.after(i+1);if(a<n.node(i).childCount)return null}return null}function X7(t,e,r){let n=t.resolve(e);if(!r.content.size)return e;let i=r.content;for(let a=0;a<r.openStart;a++)i=i.firstChild.content;for(let a=1;a<=(r.openStart==0&&r.size?2:1);a++)for(let s=n.depth;s>=0;s--){let o=s==n.depth?0:n.pos<=(n.start(s+1)+n.end(s+1))/2?-1:1,l=n.index(s)+(o>0?1:0),u=n.node(s),c=!1;if(a==1)c=u.canReplace(l,l,i);else{let d=u.contentMatchAt(l).findWrapping(i.firstChild.type);c=d&&u.canReplaceWith(l,l,d[0])}if(c)return o==0?n.pos:o<0?n.before(s+1):n.after(s+1)}return null}function gx(t,e,r=e,n=Ae.empty){if(e==r&&!n.size)return null;let i=t.resolve(e),a=t.resolve(r);return Q7(i,a,n)?new dn(e,r,n):new kX(i,a,n).fit()}function Q7(t,e,r){return!r.openStart&&!r.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),r.content)}class kX{constructor(e,r,n){this.$from=e,this.$to=r,this.unplaced=n,this.frontier=[],this.placed=be.empty;for(let i=0;i<=e.depth;i++){let a=e.node(i);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=be.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let a=this.placed,s=n.depth,o=i.depth;for(;s&&o&&a.childCount==1;)a=a.firstChild.content,s--,o--;let l=new Ae(a,s,o);return e>-1?new mn(n.pos,e,this.$to.pos,this.$to.end(),l,r):l.size||n.pos!=this.$to.pos?new dn(n.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let r=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let a=r.firstChild;if(r.childCount>1&&(i=0),a.type.spec.isolating&&i<=n){e=n;break}r=a.content}for(let r=1;r<=2;r++)for(let n=r==1?e:this.unplaced.openStart;n>=0;n--){let i,a=null;n?(a=J2(this.unplaced.content,n-1).firstChild,i=a.content):i=this.unplaced.content;let s=i.firstChild;for(let o=this.depth;o>=0;o--){let{type:l,match:u}=this.frontier[o],c,d=null;if(r==1&&(s?u.matchType(s.type)||(d=u.fillBefore(be.from(s),!1)):a&&l.compatibleContent(a.type)))return{sliceDepth:n,frontierDepth:o,parent:a,inject:d};if(r==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:o,parent:a,wrap:c};if(a&&u.matchType(a.type))break}}}openMore(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=J2(e,r);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new Ae(e,r+1,Math.max(n,i.size+r>=e.size-n?r+1:0)),!0)}dropNode(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=J2(e,r);if(i.childCount<=1&&r>0){let a=e.size-r<=r+i.size;this.unplaced=new Ae(wh(e,r-1,1),r-1,a?r-1:n)}else this.unplaced=new Ae(wh(e,r,1),r,n)}placeNodes({sliceDepth:e,frontierDepth:r,parent:n,inject:i,wrap:a}){for(;this.depth>r;)this.closeFrontierNode();if(a)for(let x=0;x<a.length;x++)this.openFrontierNode(a[x]);let s=this.unplaced,o=n?n.content:s.content,l=s.openStart-e,u=0,c=[],{match:d,type:h}=this.frontier[r];if(i){for(let x=0;x<i.childCount;x++)c.push(i.child(x));d=d.matchFragment(i)}let m=o.size+e-(s.content.size-s.openEnd);for(;u<o.childCount;){let x=o.child(u),y=d.matchType(x.type);if(!y)break;u++,(u>1||l==0||x.content.size)&&(d=y,c.push(J7(x.mark(h.allowedMarks(x.marks)),u==1?l:0,u==o.childCount?m:-1)))}let v=u==o.childCount;v||(m=-1),this.placed=Sh(this.placed,r,be.from(c)),this.frontier[r].match=d,v&&m<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let x=0,y=o;x<m;x++){let b=y.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),y=b.content}this.unplaced=v?e==0?Ae.empty:new Ae(wh(s.content,e-1,1),e-1,m<0?s.openEnd:e-1):new Ae(wh(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],r;if(!e.type.isTextblock||!Z2(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let r=Math.min(this.depth,e.depth);r>=0;r--){let{match:n,type:i}=this.frontier[r],a=r<e.depth&&e.end(r+1)==e.pos+(e.depth-(r+1)),s=Z2(e,r,i,n,a);if(s){for(let o=r-1;o>=0;o--){let{match:l,type:u}=this.frontier[o],c=Z2(e,o,u,l,!0);if(!c||c.childCount)continue e}return{depth:r,fit:s,move:a?e.doc.resolve(e.after(r+1)):e}}}}close(e){let r=this.findCloseLevel(e);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=Sh(this.placed,r.depth,r.fit)),e=r.move;for(let n=r.depth+1;n<=e.depth;n++){let i=e.node(n),a=i.type.contentMatch.fillBefore(i.content,!0,e.index(n));this.openFrontierNode(i.type,i.attrs,a)}return e}openFrontierNode(e,r=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Sh(this.placed,this.depth,be.from(e.create(r,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(be.empty,!0);r.childCount&&(this.placed=Sh(this.placed,this.frontier.length,r))}}function wh(t,e,r){return e==0?t.cutByIndex(r,t.childCount):t.replaceChild(0,t.firstChild.copy(wh(t.firstChild.content,e-1,r)))}function Sh(t,e,r){return e==0?t.append(r):t.replaceChild(t.childCount-1,t.lastChild.copy(Sh(t.lastChild.content,e-1,r)))}function J2(t,e){for(let r=0;r<e;r++)t=t.firstChild.content;return t}function J7(t,e,r){if(e<=0)return t;let n=t.content;return e>1&&(n=n.replaceChild(0,J7(n.firstChild,e-1,n.childCount==1?r-1:0))),e>0&&(n=t.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(t.type.contentMatch.matchFragment(n).fillBefore(be.empty,!0)))),t.copy(n)}function Z2(t,e,r,n,i){let a=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==a.childCount&&!r.compatibleContent(a.type))return null;let o=n.fillBefore(a.content,!0,s);return o&&!CX(r,a.content,s)?o:null}function CX(t,e,r){for(let n=r;n<e.childCount;n++)if(!t.allowsMarks(e.child(n).marks))return!0;return!1}function NX(t){return t.spec.defining||t.spec.definingForContent}function EX(t,e,r,n){if(!n.size)return t.deleteRange(e,r);let i=t.doc.resolve(e),a=t.doc.resolve(r);if(Q7(i,a,n))return t.step(new dn(e,r,n));let s=eD(i,a);s[s.length-1]==0&&s.pop();let o=-(i.depth+1);s.unshift(o);for(let h=i.depth,m=i.pos-1;h>0;h--,m--){let v=i.node(h).type.spec;if(v.defining||v.definingAsContext||v.isolating)break;s.indexOf(h)>-1?o=h:i.before(h)==m&&s.splice(1,0,-h)}let l=s.indexOf(o),u=[],c=n.openStart;for(let h=n.content,m=0;;m++){let v=h.firstChild;if(u.push(v),m==n.openStart)break;h=v.content}for(let h=c-1;h>=0;h--){let m=u[h],v=NX(m.type);if(v&&!m.sameMarkup(i.node(Math.abs(o)-1)))c=h;else if(v||!m.type.isTextblock)break}for(let h=n.openStart;h>=0;h--){let m=(h+c+1)%(n.openStart+1),v=u[m];if(v)for(let x=0;x<s.length;x++){let y=s[(x+l)%s.length],b=!0;y<0&&(b=!1,y=-y);let S=i.node(y-1),w=i.index(y-1);if(S.canReplaceWith(w,w,v.type,v.marks))return t.replace(i.before(y),b?a.after(y):r,new Ae(Z7(n.content,0,n.openStart,m),m,n.openEnd))}}let d=t.steps.length;for(let h=s.length-1;h>=0&&(t.replace(e,r,n),!(t.steps.length>d));h--){let m=s[h];m<0||(e=i.before(m),r=a.after(m))}}function Z7(t,e,r,n,i){if(e<r){let a=t.firstChild;t=t.replaceChild(0,a.copy(Z7(a.content,e+1,r,n,a)))}if(e>n){let a=i.contentMatchAt(0),s=a.fillBefore(t).append(t);t=s.append(a.matchFragment(s).fillBefore(be.empty,!0))}return t}function TX(t,e,r,n){if(!n.isInline&&e==r&&t.doc.resolve(e).parent.content.size){let i=SX(t.doc,e,n.type);i!=null&&(e=r=i)}t.replaceRange(e,r,new Ae(be.from(n),0,0))}function jX(t,e,r){let n=t.doc.resolve(e),i=t.doc.resolve(r),a=eD(n,i);for(let s=0;s<a.length;s++){let o=a[s],l=s==a.length-1;if(l&&o==0||n.node(o).type.contentMatch.validEnd)return t.delete(n.start(o),i.end(o));if(o>0&&(l||n.node(o-1).canReplace(n.index(o-1),i.indexAfter(o-1))))return t.delete(n.before(o),i.after(o))}for(let s=1;s<=n.depth&&s<=i.depth;s++)if(e-n.start(s)==n.depth-s&&r>n.end(s)&&i.end(s)-r!=i.depth-s&&n.start(s-1)==i.start(s-1)&&n.node(s-1).canReplace(n.index(s-1),i.index(s-1)))return t.delete(n.before(s),r);t.delete(e,r)}function eD(t,e){let r=[],n=Math.min(t.depth,e.depth);for(let i=n;i>=0;i--){let a=t.start(i);if(a<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(a==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==a-1)&&r.push(i)}return r}class kd extends qn{constructor(e,r,n){super(),this.pos=e,this.attr=r,this.value=n}apply(e){let r=e.nodeAt(this.pos);if(!r)return $r.fail("No node at attribute step's position");let n=Object.create(null);for(let a in r.attrs)n[a]=r.attrs[a];n[this.attr]=this.value;let i=r.type.create(n,null,r.marks);return $r.fromReplace(e,this.pos,this.pos+1,new Ae(be.from(i),0,r.isLeaf?0:1))}getMap(){return Mi.empty}invert(e){return new kd(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new kd(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new kd(r.pos,r.attr,r.value)}}qn.jsonID("attr",kd);class Pp extends qn{constructor(e,r){super(),this.attr=e,this.value=r}apply(e){let r=Object.create(null);for(let i in e.attrs)r[i]=e.attrs[i];r[this.attr]=this.value;let n=e.type.create(r,e.content,e.marks);return $r.ok(n)}getMap(){return Mi.empty}invert(e){return new Pp(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Pp(r.attr,r.value)}}qn.jsonID("docAttr",Pp);let Ld=class extends Error{};Ld=function t(e){let r=Error.call(this,e);return r.__proto__=t.prototype,r};Ld.prototype=Object.create(Error.prototype);Ld.prototype.constructor=Ld;Ld.prototype.name="TransformError";class tD{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Mp}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let r=this.maybeStep(e);if(r.failed)throw new Ld(r.failed);return this}maybeStep(e){let r=e.apply(this.doc);return r.failed||this.addStep(e,r.doc),r}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,r=-1e9;for(let n=0;n<this.mapping.maps.length;n++){let i=this.mapping.maps[n];n&&(e=i.map(e,1),r=i.map(r,-1)),i.forEach((a,s,o,l)=>{e=Math.min(e,o),r=Math.max(r,l)})}return e==1e9?null:{from:e,to:r}}addStep(e,r){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=r}replace(e,r=e,n=Ae.empty){let i=gx(this.doc,e,r,n);return i&&this.step(i),this}replaceWith(e,r,n){return this.replace(e,r,new Ae(be.from(n),0,0))}delete(e,r){return this.replace(e,r,Ae.empty)}insert(e,r){return this.replaceWith(e,e,r)}replaceRange(e,r,n){return EX(this,e,r,n),this}replaceRangeWith(e,r,n){return TX(this,e,r,n),this}deleteRange(e,r){return jX(this,e,r),this}lift(e,r){return fX(this,e,r),this}join(e,r=1){return wX(this,e,r),this}wrap(e,r){return mX(this,e,r),this}setBlockType(e,r=e,n,i=null){return gX(this,e,r,n,i),this}setNodeMarkup(e,r,n=null,i){return yX(this,e,r,n,i),this}setNodeAttribute(e,r,n){return this.step(new kd(e,r,n)),this}setDocAttribute(e,r){return this.step(new Pp(e,r)),this}addNodeMark(e,r){return this.step(new Xo(e,r)),this}removeNodeMark(e,r){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(r instanceof Gt)r.isInSet(n.marks)&&this.step(new Hu(e,r));else{let i=n.marks,a,s=[];for(;a=r.isInSet(i);)s.push(new Hu(e,a)),i=a.removeFromSet(i);for(let o=s.length-1;o>=0;o--)this.step(s[o])}return this}split(e,r=1,n){return xX(this,e,r,n),this}addMark(e,r,n){return uX(this,e,r,n),this}removeMark(e,r,n){return cX(this,e,r,n),this}clearIncompatible(e,r,n){return b3(this,e,r,n),this}}const eS=Object.create(null);class ht{constructor(e,r,n){this.$anchor=e,this.$head=r,this.ranges=n||[new MX(e.min(r),e.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let r=0;r<e.length;r++)if(e[r].$from.pos!=e[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,r=Ae.empty){let n=r.content.lastChild,i=null;for(let o=0;o<r.openEnd;o++)i=n,n=n.lastChild;let a=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:l,$to:u}=s[o],c=e.mapping.slice(a);e.replaceRange(c.map(l.pos),c.map(u.pos),o?Ae.empty:r),o==0&&C9(e,a,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,r){let n=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:s,$to:o}=i[a],l=e.mapping.slice(n),u=l.map(s.pos),c=l.map(o.pos);a?e.deleteRange(u,c):(e.replaceRangeWith(u,c,r),C9(e,n,r.isInline?-1:1))}}static findFrom(e,r,n=!1){let i=e.parent.inlineContent?new at(e):Uc(e.node(0),e.parent,e.pos,e.index(),r,n);if(i)return i;for(let a=e.depth-1;a>=0;a--){let s=r<0?Uc(e.node(0),e.node(a),e.before(a+1),e.index(a),r,n):Uc(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,r,n);if(s)return s}return null}static near(e,r=1){return this.findFrom(e,r)||this.findFrom(e,-r)||new sa(e.node(0))}static atStart(e){return Uc(e,e,0,0,1)||new sa(e)}static atEnd(e){return Uc(e,e,e.content.size,e.childCount,-1)||new sa(e)}static fromJSON(e,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=eS[r.type];if(!n)throw new RangeError(`No selection type ${r.type} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in eS)throw new RangeError("Duplicate use of selection JSON ID "+e);return eS[e]=r,r.prototype.jsonID=e,r}getBookmark(){return at.between(this.$anchor,this.$head).getBookmark()}}ht.prototype.visible=!0;class MX{constructor(e,r){this.$from=e,this.$to=r}}let S9=!1;function k9(t){!S9&&!t.parent.inlineContent&&(S9=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class at extends ht{constructor(e,r=e){k9(e),k9(r),super(e,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,r){let n=e.resolve(r.map(this.head));if(!n.parent.inlineContent)return ht.near(n);let i=e.resolve(r.map(this.anchor));return new at(i.parent.inlineContent?i:n,n)}replace(e,r=Ae.empty){if(super.replace(e,r),r==Ae.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof at&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new vx(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new at(e.resolve(r.anchor),e.resolve(r.head))}static create(e,r,n=r){let i=e.resolve(r);return new this(i,n==r?i:e.resolve(n))}static between(e,r,n){let i=e.pos-r.pos;if((!n||i)&&(n=i>=0?1:-1),!r.parent.inlineContent){let a=ht.findFrom(r,n,!0)||ht.findFrom(r,-n,!0);if(a)r=a.$head;else return ht.near(r,n)}return e.parent.inlineContent||(i==0?e=r:(e=(ht.findFrom(e,-n,!0)||ht.findFrom(e,n,!0)).$anchor,e.pos<r.pos!=i<0&&(e=r))),new at(e,r)}}ht.jsonID("text",at);class vx{constructor(e,r){this.anchor=e,this.head=r}map(e){return new vx(e.map(this.anchor),e.map(this.head))}resolve(e){return at.between(e.resolve(this.anchor),e.resolve(this.head))}}class Ye extends ht{constructor(e){let r=e.nodeAfter,n=e.node(0).resolve(e.pos+r.nodeSize);super(e,n),this.node=r}map(e,r){let{deleted:n,pos:i}=r.mapResult(this.anchor),a=e.resolve(i);return n?ht.near(a):new Ye(a)}content(){return new Ae(be.from(this.node),0,0)}eq(e){return e instanceof Ye&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new S3(this.anchor)}static fromJSON(e,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ye(e.resolve(r.anchor))}static create(e,r){return new Ye(e.resolve(r))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Ye.prototype.visible=!1;ht.jsonID("node",Ye);class S3{constructor(e){this.anchor=e}map(e){let{deleted:r,pos:n}=e.mapResult(this.anchor);return r?new vx(n,n):new S3(n)}resolve(e){let r=e.resolve(this.anchor),n=r.nodeAfter;return n&&Ye.isSelectable(n)?new Ye(r):ht.near(r)}}class sa extends ht{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,r=Ae.empty){if(r==Ae.empty){e.delete(0,e.doc.content.size);let n=ht.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,r)}toJSON(){return{type:"all"}}static fromJSON(e){return new sa(e)}map(e){return new sa(e)}eq(e){return e instanceof sa}getBookmark(){return PX}}ht.jsonID("all",sa);const PX={map(){return this},resolve(t){return new sa(t)}};function Uc(t,e,r,n,i,a=!1){if(e.inlineContent)return at.create(t,r);for(let s=n-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let o=e.child(s);if(o.isAtom){if(!a&&Ye.isSelectable(o))return Ye.create(t,r-(i<0?o.nodeSize:0))}else{let l=Uc(t,o,r+i,i<0?o.childCount:0,i,a);if(l)return l}r+=o.nodeSize*i}return null}function C9(t,e,r){let n=t.steps.length-1;if(n<e)return;let i=t.steps[n];if(!(i instanceof dn||i instanceof mn))return;let a=t.mapping.maps[n],s;a.forEach((o,l,u,c)=>{s==null&&(s=c)}),t.setSelection(ht.near(t.doc.resolve(s),r))}const N9=1,Xg=2,E9=4;class _X extends tD{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|N9)&~Xg,this.storedMarks=null,this}get selectionSet(){return(this.updated&N9)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Xg,this}ensureMarks(e){return Gt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Xg)>0}addStep(e,r){super.addStep(e,r),this.updated=this.updated&~Xg,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,r=!0){let n=this.selection;return r&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Gt.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,r,n){let i=this.doc.type.schema;if(r==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(n==null&&(n=r),!e)return this.deleteRange(r,n);let a=this.storedMarks;if(!a){let s=this.doc.resolve(r);a=n==r?s.marks():s.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(r,n,i.text(e,a)),!this.selection.empty&&this.selection.to==r+e.length&&this.setSelection(ht.near(this.selection.$to)),this}}setMeta(e,r){return this.meta[typeof e=="string"?e:e.key]=r,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=E9,this}get scrolledIntoView(){return(this.updated&E9)>0}}function T9(t,e){return!e||!t?t:t.bind(e)}class kh{constructor(e,r,n){this.name=e,this.init=T9(r.init,n),this.apply=T9(r.apply,n)}}const AX=[new kh("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new kh("selection",{init(t,e){return t.selection||ht.atStart(e.doc)},apply(t){return t.selection}}),new kh("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,r,n){return n.selection.$cursor?t.storedMarks:null}}),new kh("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class tS{constructor(e,r){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=AX.slice(),r&&r.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new kh(n.key,n.spec.state,n))})}}class cd{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,r=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=r){let i=this.config.plugins[n];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let r=[e],n=this.applyInner(e),i=null;for(;;){let a=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let l=i?i[s].n:0,u=i?i[s].state:this,c=l<r.length&&o.spec.appendTransaction.call(o,l?r.slice(l):r,u,n);if(c&&n.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<s?{state:n,n:r.length}:{state:this,n:0})}r.push(c),n=n.applyInner(c),a=!0}i&&(i[s]={state:n,n:r.length})}}if(!a)return{state:n,transactions:r}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let r=new cd(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let a=n[i];r[a.name]=a.apply(e,this[a.name],this,r)}return r}get tr(){return new _X(this)}static create(e){let r=new tS(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new cd(r);for(let i=0;i<r.fields.length;i++)n[r.fields[i].name]=r.fields[i].init(e,n);return n}reconfigure(e){let r=new tS(this.schema,e.plugins),n=r.fields,i=new cd(r);for(let a=0;a<n.length;a++){let s=n[a].name;i[s]=this.hasOwnProperty(s)?this[s]:n[a].init(e,i)}return i}toJSON(e){let r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(n=>n.toJSON())),e&&typeof e=="object")for(let n in e){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[n],a=i.spec.state;a&&a.toJSON&&(r[n]=a.toJSON.call(i,this[i.key]))}return r}static fromJSON(e,r,n){if(!r)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new tS(e.schema,e.plugins),a=new cd(i);return i.fields.forEach(s=>{if(s.name=="doc")a.doc=Ws.fromJSON(e.schema,r.doc);else if(s.name=="selection")a.selection=ht.fromJSON(a.doc,r.selection);else if(s.name=="storedMarks")r.storedMarks&&(a.storedMarks=r.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let o in n){let l=n[o],u=l.spec.state;if(l.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(r,o)){a[s.name]=u.fromJSON.call(l,e,r[o],a);return}}a[s.name]=s.init(e,a)}}),a}}function rD(t,e,r){for(let n in t){let i=t[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=rD(i,e,{})),r[n]=i}return r}class cr{constructor(e){this.spec=e,this.props={},e.props&&rD(e.props,this,this.props),this.key=e.key?e.key.key:nD("plugin")}getState(e){return e[this.key]}}const rS=Object.create(null);function nD(t){return t in rS?t+"$"+ ++rS[t]:(rS[t]=0,t+"$")}class Rr{constructor(e="key"){this.key=nD(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const RX=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function iD(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("backward",t):r.parentOffset>0)?null:r}const DX=(t,e,r)=>{let n=iD(t,r);if(!n)return!1;let i=k3(n);if(!i){let s=n.blockRange(),o=s&&uf(s);return o==null?!1:(e&&e(t.tr.lift(s,o).scrollIntoView()),!0)}let a=i.nodeBefore;if(lD(t,i,e,-1))return!0;if(n.parent.content.size==0&&(Bd(a,"end")||Ye.isSelectable(a)))for(let s=n.depth;;s--){let o=gx(t.doc,n.before(s),n.after(s),Ae.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Bd(a,"end")?ht.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):Ye.create(l.doc,i.pos-a.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||n.node(s-1).childCount>1)break}return a.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos-a.nodeSize,i.pos).scrollIntoView()),!0):!1},OX=(t,e,r)=>{let n=iD(t,r);if(!n)return!1;let i=k3(n);return i?aD(t,i,e):!1},IX=(t,e,r)=>{let n=sD(t,r);if(!n)return!1;let i=C3(n);return i?aD(t,i,e):!1};function aD(t,e,r){let n=e.nodeBefore,i=n,a=e.pos-1;for(;!i.isTextblock;a--){if(i.type.spec.isolating)return!1;let c=i.lastChild;if(!c)return!1;i=c}let s=e.nodeAfter,o=s,l=e.pos+1;for(;!o.isTextblock;l++){if(o.type.spec.isolating)return!1;let c=o.firstChild;if(!c)return!1;o=c}let u=gx(t.doc,a,l,Ae.empty);if(!u||u.from!=a||u instanceof dn&&u.slice.size>=l-a)return!1;if(r){let c=t.tr.step(u);c.setSelection(at.create(c.doc,a)),r(c.scrollIntoView())}return!0}function Bd(t,e,r=!1){for(let n=t;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const LX=(t,e,r)=>{let{$head:n,empty:i}=t.selection,a=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",t):n.parentOffset>0)return!1;a=k3(n)}let s=a&&a.nodeBefore;return!s||!Ye.isSelectable(s)?!1:(e&&e(t.tr.setSelection(Ye.create(t.doc,a.pos-s.nodeSize)).scrollIntoView()),!0)};function k3(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function sD(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)?null:r}const BX=(t,e,r)=>{let n=sD(t,r);if(!n)return!1;let i=C3(n);if(!i)return!1;let a=i.nodeAfter;if(lD(t,i,e,1))return!0;if(n.parent.content.size==0&&(Bd(a,"start")||Ye.isSelectable(a))){let s=gx(t.doc,n.before(),n.after(),Ae.empty);if(s&&s.slice.size<s.to-s.from){if(e){let o=t.tr.step(s);o.setSelection(Bd(a,"start")?ht.findFrom(o.doc.resolve(o.mapping.map(i.pos)),1):Ye.create(o.doc,o.mapping.map(i.pos))),e(o.scrollIntoView())}return!0}}return a.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+a.nodeSize).scrollIntoView()),!0):!1},FX=(t,e,r)=>{let{$head:n,empty:i}=t.selection,a=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)return!1;a=C3(n)}let s=a&&a.nodeAfter;return!s||!Ye.isSelectable(s)?!1:(e&&e(t.tr.setSelection(Ye.create(t.doc,a.pos)).scrollIntoView()),!0)};function C3(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let r=t.node(e);if(t.index(e)+1<r.childCount)return t.doc.resolve(t.after(e+1));if(r.type.spec.isolating)break}return null}const zX=(t,e)=>{let r=t.selection,n=r instanceof Ye,i;if(n){if(r.node.isTextblock||!Dl(t.doc,r.from))return!1;i=r.from}else if(i=mx(t.doc,r.from,-1),i==null)return!1;if(e){let a=t.tr.join(i);n&&a.setSelection(Ye.create(a.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(a.scrollIntoView())}return!0},VX=(t,e)=>{let r=t.selection,n;if(r instanceof Ye){if(r.node.isTextblock||!Dl(t.doc,r.to))return!1;n=r.to}else if(n=mx(t.doc,r.to,1),n==null)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0},$X=(t,e)=>{let{$from:r,$to:n}=t.selection,i=r.blockRange(n),a=i&&uf(i);return a==null?!1:(e&&e(t.tr.lift(i,a).scrollIntoView()),!0)},UX=(t,e)=>{let{$head:r,$anchor:n}=t.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function oD(t){for(let e=0;e<t.edgeCount;e++){let{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const GX=(t,e)=>{let{$head:r,$anchor:n}=t.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let i=r.node(-1),a=r.indexAfter(-1),s=oD(i.contentMatchAt(a));if(!s||!i.canReplaceWith(a,a,s))return!1;if(e){let o=r.after(),l=t.tr.replaceWith(o,o,s.createAndFill());l.setSelection(ht.near(l.doc.resolve(o),1)),e(l.scrollIntoView())}return!0},HX=(t,e)=>{let r=t.selection,{$from:n,$to:i}=r;if(r instanceof sa||n.parent.inlineContent||i.parent.inlineContent)return!1;let a=oD(i.parent.contentMatchAt(i.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){let s=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,o=t.tr.insert(s,a.createAndFill());o.setSelection(at.create(o.doc,s+1)),e(o.scrollIntoView())}return!0},WX=(t,e)=>{let{$cursor:r}=t.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let a=r.before();if(Sd(t.doc,a))return e&&e(t.tr.split(a).scrollIntoView()),!0}let n=r.blockRange(),i=n&&uf(n);return i==null?!1:(e&&e(t.tr.lift(n,i).scrollIntoView()),!0)},qX=(t,e)=>{let{$from:r,to:n}=t.selection,i,a=r.sharedDepth(n);return a==0?!1:(i=r.before(a),e&&e(t.tr.setSelection(Ye.create(t.doc,i))),!0)};function KX(t,e,r){let n=e.nodeBefore,i=e.nodeAfter,a=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(a-1,a)?(r&&r(t.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(a,a+1)||!(i.isTextblock||Dl(t.doc,e.pos))?!1:(r&&r(t.tr.join(e.pos).scrollIntoView()),!0)}function lD(t,e,r,n){let i=e.nodeBefore,a=e.nodeAfter,s,o,l=i.type.spec.isolating||a.type.spec.isolating;if(!l&&KX(t,e,r))return!0;let u=!l&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(s=(o=i.contentMatchAt(i.childCount)).findWrapping(a.type))&&o.matchType(s[0]||a.type).validEnd){if(r){let m=e.pos+a.nodeSize,v=be.empty;for(let b=s.length-1;b>=0;b--)v=be.from(s[b].create(null,v));v=be.from(i.copy(v));let x=t.tr.step(new mn(e.pos-1,m,e.pos,m,new Ae(v,1,0),s.length,!0)),y=x.doc.resolve(m+2*s.length);y.nodeAfter&&y.nodeAfter.type==i.type&&Dl(x.doc,y.pos)&&x.join(y.pos),r(x.scrollIntoView())}return!0}let c=a.type.spec.isolating||n>0&&l?null:ht.findFrom(e,1),d=c&&c.$from.blockRange(c.$to),h=d&&uf(d);if(h!=null&&h>=e.depth)return r&&r(t.tr.lift(d,h).scrollIntoView()),!0;if(u&&Bd(a,"start",!0)&&Bd(i,"end")){let m=i,v=[];for(;v.push(m),!m.isTextblock;)m=m.lastChild;let x=a,y=1;for(;!x.isTextblock;x=x.firstChild)y++;if(m.canReplace(m.childCount,m.childCount,x.content)){if(r){let b=be.empty;for(let w=v.length-1;w>=0;w--)b=be.from(v[w].copy(b));let S=t.tr.step(new mn(e.pos-v.length,e.pos+a.nodeSize,e.pos+y,e.pos+a.nodeSize-y,new Ae(b,v.length,0),0,!0));r(S.scrollIntoView())}return!0}}return!1}function uD(t){return function(e,r){let n=e.selection,i=t<0?n.$from:n.$to,a=i.depth;for(;i.node(a).isInline;){if(!a)return!1;a--}return i.node(a).isTextblock?(r&&r(e.tr.setSelection(at.create(e.doc,t<0?i.start(a):i.end(a)))),!0):!1}}const YX=uD(-1),XX=uD(1);function QX(t,e=null){return function(r,n){let{$from:i,$to:a}=r.selection,s=i.blockRange(a),o=s&&w3(s,t,e);return o?(n&&n(r.tr.wrap(s,o).scrollIntoView()),!0):!1}}function j9(t,e=null){return function(r,n){let i=!1;for(let a=0;a<r.selection.ranges.length&&!i;a++){let{$from:{pos:s},$to:{pos:o}}=r.selection.ranges[a];r.doc.nodesBetween(s,o,(l,u)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)i=!0;else{let c=r.doc.resolve(u),d=c.index();i=c.parent.canReplaceWith(d,d+1,t)}})}if(!i)return!1;if(n){let a=r.tr;for(let s=0;s<r.selection.ranges.length;s++){let{$from:{pos:o},$to:{pos:l}}=r.selection.ranges[s];a.setBlockType(o,l,t,e)}n(a.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function JX(t,e=null){return function(r,n){let{$from:i,$to:a}=r.selection,s=i.blockRange(a);if(!s)return!1;let o=n?r.tr:null;return ZX(o,s,t,e)?(n&&n(o.scrollIntoView()),!0):!1}}function ZX(t,e,r,n=null){let i=!1,a=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(r)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);a=new L0(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new L0(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let o=w3(a,r,n,e);return o?(t&&eQ(t,e,o,i,r),!0):!1}function eQ(t,e,r,n,i){let a=be.empty;for(let c=r.length-1;c>=0;c--)a=be.from(r[c].type.create(r[c].attrs,a));t.step(new mn(e.start-(n?2:0),e.end,e.start,e.end,new Ae(a,0,0),r.length,!0));let s=0;for(let c=0;c<r.length;c++)r[c].type==i&&(s=c+1);let o=r.length-s,l=e.start+r.length-(n?2:0),u=e.parent;for(let c=e.startIndex,d=e.endIndex,h=!0;c<d;c++,h=!1)!h&&Sd(t.doc,l,o)&&(t.split(l,o),l+=2*o),l+=u.child(c).nodeSize;return t}function tQ(t){return function(e,r){let{$from:n,$to:i}=e.selection,a=n.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return a?r?n.node(a.depth-1).type==t?rQ(e,r,t,a):nQ(e,r,a):!0:!1}}function rQ(t,e,r,n){let i=t.tr,a=n.end,s=n.$to.end(n.depth);a<s&&(i.step(new mn(a-1,s,a,s,new Ae(be.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new L0(i.doc.resolve(n.$from.pos),i.doc.resolve(s),n.depth));const o=uf(n);if(o==null)return!1;i.lift(n,o);let l=i.doc.resolve(i.mapping.map(a,-1)-1);return Dl(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function nQ(t,e,r){let n=t.tr,i=r.parent;for(let m=r.end,v=r.endIndex-1,x=r.startIndex;v>x;v--)m-=i.child(v).nodeSize,n.delete(m-1,m+1);let a=n.doc.resolve(r.start),s=a.nodeAfter;if(n.mapping.map(r.end)!=r.start+a.nodeAfter.nodeSize)return!1;let o=r.startIndex==0,l=r.endIndex==i.childCount,u=a.node(-1),c=a.index(-1);if(!u.canReplace(c+(o?0:1),c+1,s.content.append(l?be.empty:be.from(i))))return!1;let d=a.pos,h=d+s.nodeSize;return n.step(new mn(d-(o?1:0),h+(l?1:0),d+1,h-1,new Ae((o?be.empty:be.from(i.copy(be.empty))).append(l?be.empty:be.from(i.copy(be.empty))),o?0:1,l?0:1),o?0:1)),e(n.scrollIntoView()),!0}function iQ(t){return function(e,r){let{$from:n,$to:i}=e.selection,a=n.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!a)return!1;let s=a.startIndex;if(s==0)return!1;let o=a.parent,l=o.child(s-1);if(l.type!=t)return!1;if(r){let u=l.lastChild&&l.lastChild.type==o.type,c=be.from(u?t.create():null),d=new Ae(be.from(t.create(null,be.from(o.type.create(null,c)))),u?3:1,0),h=a.start,m=a.end;r(e.tr.step(new mn(h-(u?3:1),m,h,m,d,1,!0)).scrollIntoView())}return!0}}const kn=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Fd=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let lk=null;const Bs=function(t,e,r){let n=lk||(lk=document.createRange());return n.setEnd(t,r??t.nodeValue.length),n.setStart(t,e||0),n},aQ=function(){lk=null},Wu=function(t,e,r,n){return r&&(M9(t,e,r,n,-1)||M9(t,e,r,n,1))},sQ=/^(img|br|input|textarea|hr)$/i;function M9(t,e,r,n,i){for(var a;;){if(t==r&&e==n)return!0;if(e==(i<0?0:ra(t))){let s=t.parentNode;if(!s||s.nodeType!=1||um(t)||sQ.test(t.nodeName)||t.contentEditable=="false")return!1;e=kn(t)+(i<0?0:1),t=s}else if(t.nodeType==1){let s=t.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((a=s.pmViewDesc)===null||a===void 0)&&a.ignoreForSelection)e+=i;else return!1;else t=s,e=i<0?ra(t):0}else return!1}}function ra(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function oQ(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=ra(t)}else if(t.parentNode&&!um(t))e=kn(t),t=t.parentNode;else return null}}function lQ(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!um(t))e=kn(t)+1,t=t.parentNode;else return null}}function uQ(t,e,r){for(let n=e==0,i=e==ra(t);n||i;){if(t==r)return!0;let a=kn(t);if(t=t.parentNode,!t)return!1;n=n&&a==0,i=i&&a==ra(t)}}function um(t){let e;for(let r=t;r&&!(e=r.pmViewDesc);r=r.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const yx=function(t){return t.focusNode&&Wu(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function pu(t,e){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=t,r.key=r.code=e,r}function cQ(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function dQ(t,e,r){if(t.caretPositionFromPoint)try{let n=t.caretPositionFromPoint(e,r);if(n)return{node:n.offsetNode,offset:Math.min(ra(n.offsetNode),n.offset)}}catch{}if(t.caretRangeFromPoint){let n=t.caretRangeFromPoint(e,r);if(n)return{node:n.startContainer,offset:Math.min(ra(n.startContainer),n.startOffset)}}}const fs=typeof navigator<"u"?navigator:null,P9=typeof document<"u"?document:null,Ol=fs&&fs.userAgent||"",uk=/Edge\/(\d+)/.exec(Ol),cD=/MSIE \d/.exec(Ol),ck=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ol),wi=!!(cD||ck||uk),cl=cD?document.documentMode:ck?+ck[1]:uk?+uk[1]:0,oa=!wi&&/gecko\/(\d+)/i.test(Ol);oa&&+(/Firefox\/(\d+)/.exec(Ol)||[0,0])[1];const dk=!wi&&/Chrome\/(\d+)/.exec(Ol),fn=!!dk,dD=dk?+dk[1]:0,Mn=!wi&&!!fs&&/Apple Computer/.test(fs.vendor),zd=Mn&&(/Mobile\/\w+/.test(Ol)||!!fs&&fs.maxTouchPoints>2),Ji=zd||(fs?/Mac/.test(fs.platform):!1),fD=fs?/Win/.test(fs.platform):!1,Gs=/Android \d/.test(Ol),cm=!!P9&&"webkitFontSmoothing"in P9.documentElement.style,fQ=cm?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function hQ(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function _s(t,e){return typeof t=="number"?t:t[e]}function pQ(t){let e=t.getBoundingClientRect(),r=e.width/t.offsetWidth||1,n=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*r,top:e.top,bottom:e.top+t.clientHeight*n}}function _9(t,e,r){let n=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,a=t.dom.ownerDocument;for(let s=r||t.dom;s;){if(s.nodeType!=1){s=Fd(s);continue}let o=s,l=o==a.body,u=l?hQ(a):pQ(o),c=0,d=0;if(e.top<u.top+_s(n,"top")?d=-(u.top-e.top+_s(i,"top")):e.bottom>u.bottom-_s(n,"bottom")&&(d=e.bottom-e.top>u.bottom-u.top?e.top+_s(i,"top")-u.top:e.bottom-u.bottom+_s(i,"bottom")),e.left<u.left+_s(n,"left")?c=-(u.left-e.left+_s(i,"left")):e.right>u.right-_s(n,"right")&&(c=e.right-u.right+_s(i,"right")),c||d)if(l)a.defaultView.scrollBy(c,d);else{let m=o.scrollLeft,v=o.scrollTop;d&&(o.scrollTop+=d),c&&(o.scrollLeft+=c);let x=o.scrollLeft-m,y=o.scrollTop-v;e={left:e.left-x,top:e.top-y,right:e.right-x,bottom:e.bottom-y}}let h=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(h))break;s=h=="absolute"?s.offsetParent:Fd(s)}}function mQ(t){let e=t.dom.getBoundingClientRect(),r=Math.max(0,e.top),n,i;for(let a=(e.left+e.right)/2,s=r+1;s<Math.min(innerHeight,e.bottom);s+=5){let o=t.root.elementFromPoint(a,s);if(!o||o==t.dom||!t.dom.contains(o))continue;let l=o.getBoundingClientRect();if(l.top>=r-20){n=o,i=l.top;break}}return{refDOM:n,refTop:i,stack:hD(t.dom)}}function hD(t){let e=[],r=t.ownerDocument;for(let n=t;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),t!=r);n=Fd(n));return e}function gQ({refDOM:t,refTop:e,stack:r}){let n=t?t.getBoundingClientRect().top:0;pD(r,n==0?0:n-e)}function pD(t,e){for(let r=0;r<t.length;r++){let{dom:n,top:i,left:a}=t[r];n.scrollTop!=i+e&&(n.scrollTop=i+e),n.scrollLeft!=a&&(n.scrollLeft=a)}}let Lc=null;function vQ(t){if(t.setActive)return t.setActive();if(Lc)return t.focus(Lc);let e=hD(t);t.focus(Lc==null?{get preventScroll(){return Lc={preventScroll:!0},!0}}:void 0),Lc||(Lc=!1,pD(e,0))}function mD(t,e){let r,n=2e8,i,a=0,s=e.top,o=e.top,l,u;for(let c=t.firstChild,d=0;c;c=c.nextSibling,d++){let h;if(c.nodeType==1)h=c.getClientRects();else if(c.nodeType==3)h=Bs(c).getClientRects();else continue;for(let m=0;m<h.length;m++){let v=h[m];if(v.top<=s&&v.bottom>=o){s=Math.max(v.bottom,s),o=Math.min(v.top,o);let x=v.left>e.left?v.left-e.left:v.right<e.left?e.left-v.right:0;if(x<n){r=c,n=x,i=x&&r.nodeType==3?{left:v.right<e.left?v.right:v.left,top:e.top}:e,c.nodeType==1&&x&&(a=d+(e.left>=(v.left+v.right)/2?1:0));continue}}else v.top>e.top&&!l&&v.left<=e.left&&v.right>=e.left&&(l=c,u={left:Math.max(v.left,Math.min(v.right,e.left)),top:v.top});!r&&(e.left>=v.right&&e.top>=v.top||e.left>=v.left&&e.top>=v.bottom)&&(a=d+1)}}return!r&&l&&(r=l,i=u,n=0),r&&r.nodeType==3?yQ(r,i):!r||n&&r.nodeType==1?{node:t,offset:a}:mD(r,i)}function yQ(t,e){let r=t.nodeValue.length,n=document.createRange(),i;for(let a=0;a<r;a++){n.setEnd(t,a+1),n.setStart(t,a);let s=_o(n,1);if(s.top!=s.bottom&&N3(e,s)){i={node:t,offset:a+(e.left>=(s.left+s.right)/2?1:0)};break}}return n.detach(),i||{node:t,offset:0}}function N3(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function xQ(t,e){let r=t.parentNode;return r&&/^li$/i.test(r.nodeName)&&e.left<t.getBoundingClientRect().left?r:t}function bQ(t,e,r){let{node:n,offset:i}=mD(e,r),a=-1;if(n.nodeType==1&&!n.firstChild){let s=n.getBoundingClientRect();a=s.left!=s.right&&r.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(n,i,a)}function wQ(t,e,r,n){let i=-1;for(let a=e,s=!1;a!=t.dom;){let o=t.docView.nearestDesc(a,!0),l;if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((l=o.dom.getBoundingClientRect()).width||l.height)&&(o.node.isBlock&&o.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(o.dom.nodeName)&&(!s&&l.left>n.left||l.top>n.top?i=o.posBefore:(!s&&l.right<n.left||l.bottom<n.top)&&(i=o.posAfter),s=!0),!o.contentDOM&&i<0&&!o.node.isText))return(o.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2)?o.posBefore:o.posAfter;a=o.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,r,-1)}function gD(t,e,r){let n=t.childNodes.length;if(n&&r.top<r.bottom)for(let i=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-r.top)/(r.bottom-r.top))-2)),a=i;;){let s=t.childNodes[a];if(s.nodeType==1){let o=s.getClientRects();for(let l=0;l<o.length;l++){let u=o[l];if(N3(e,u))return gD(s,e,u)}}if((a=(a+1)%n)==i)break}return t}function SQ(t,e){let r=t.dom.ownerDocument,n,i=0,a=dQ(r,e.left,e.top);a&&({node:n,offset:i}=a);let s=(t.root.elementFromPoint?t.root:r).elementFromPoint(e.left,e.top),o;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=t.dom.getBoundingClientRect();if(!N3(e,u)||(s=gD(t.dom,e,u),!s))return null}if(Mn)for(let u=s;n&&u;u=Fd(u))u.draggable&&(n=void 0);if(s=xQ(s,e),n){if(oa&&n.nodeType==1&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){let c=n.childNodes[i],d;c.nodeName=="IMG"&&(d=c.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let u;cm&&i&&n.nodeType==1&&(u=n.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,n==t.dom&&i==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?o=t.state.doc.content.size:(i==0||n.nodeType!=1||n.childNodes[i-1].nodeName!="BR")&&(o=wQ(t,n,i,e))}o==null&&(o=bQ(t,s,e));let l=t.docView.nearestDesc(s,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function A9(t){return t.top<t.bottom||t.left<t.right}function _o(t,e){let r=t.getClientRects();if(r.length){let n=r[e<0?0:r.length-1];if(A9(n))return n}return Array.prototype.find.call(r,A9)||t.getBoundingClientRect()}const kQ=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function vD(t,e,r){let{node:n,offset:i,atom:a}=t.docView.domFromPos(e,r<0?-1:1),s=cm||oa;if(n.nodeType==3)if(s&&(kQ.test(n.nodeValue)||(r<0?!i:i==n.nodeValue.length))){let l=_o(Bs(n,i,i),r);if(oa&&i&&/\s/.test(n.nodeValue[i-1])&&i<n.nodeValue.length){let u=_o(Bs(n,i-1,i-1),-1);if(u.top==l.top){let c=_o(Bs(n,i,i+1),-1);if(c.top!=l.top)return ah(c,c.left<u.left)}}return l}else{let l=i,u=i,c=r<0?1:-1;return r<0&&!i?(u++,c=-1):r>=0&&i==n.nodeValue.length?(l--,c=1):r<0?l--:u++,ah(_o(Bs(n,l,u),c),c<0)}if(!t.state.doc.resolve(e-(a||0)).parent.inlineContent){if(a==null&&i&&(r<0||i==ra(n))){let l=n.childNodes[i-1];if(l.nodeType==1)return nS(l.getBoundingClientRect(),!1)}if(a==null&&i<ra(n)){let l=n.childNodes[i];if(l.nodeType==1)return nS(l.getBoundingClientRect(),!0)}return nS(n.getBoundingClientRect(),r>=0)}if(a==null&&i&&(r<0||i==ra(n))){let l=n.childNodes[i-1],u=l.nodeType==3?Bs(l,ra(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(u)return ah(_o(u,1),!1)}if(a==null&&i<ra(n)){let l=n.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let u=l?l.nodeType==3?Bs(l,0,s?0:1):l.nodeType==1?l:null:null;if(u)return ah(_o(u,-1),!0)}return ah(_o(n.nodeType==3?Bs(n):n,-r),r>=0)}function ah(t,e){if(t.width==0)return t;let r=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:r,right:r}}function nS(t,e){if(t.height==0)return t;let r=e?t.top:t.bottom;return{top:r,bottom:r,left:t.left,right:t.right}}function yD(t,e,r){let n=t.state,i=t.root.activeElement;n!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return r()}finally{n!=e&&t.updateState(n),i!=t.dom&&i&&i.focus()}}function CQ(t,e,r){let n=e.selection,i=r=="up"?n.$from:n.$to;return yD(t,e,()=>{let{node:a}=t.docView.domFromPos(i.pos,r=="up"?-1:1);for(;;){let o=t.docView.nearestDesc(a,!0);if(!o)break;if(o.node.isBlock){a=o.contentDOM||o.dom;break}a=o.dom.parentNode}let s=vD(t,i.pos,1);for(let o=a.firstChild;o;o=o.nextSibling){let l;if(o.nodeType==1)l=o.getClientRects();else if(o.nodeType==3)l=Bs(o,0,o.nodeValue.length).getClientRects();else continue;for(let u=0;u<l.length;u++){let c=l[u];if(c.bottom>c.top+1&&(r=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const NQ=/[\u0590-\u08ac]/;function EQ(t,e,r){let{$head:n}=e.selection;if(!n.parent.isTextblock)return!1;let i=n.parentOffset,a=!i,s=i==n.parent.content.size,o=t.domSelection();return o?!NQ.test(n.parent.textContent)||!o.modify?r=="left"||r=="backward"?a:s:yD(t,e,()=>{let{focusNode:l,focusOffset:u,anchorNode:c,anchorOffset:d}=t.domSelectionRange(),h=o.caretBidiLevel;o.modify("move",r,"character");let m=n.depth?t.docView.domAfterPos(n.before()):t.dom,{focusNode:v,focusOffset:x}=t.domSelectionRange(),y=v&&!m.contains(v.nodeType==1?v:v.parentNode)||l==v&&u==x;try{o.collapse(c,d),l&&(l!=c||u!=d)&&o.extend&&o.extend(l,u)}catch{}return h!=null&&(o.caretBidiLevel=h),y}):n.pos==n.start()||n.pos==n.end()}let R9=null,D9=null,O9=!1;function TQ(t,e,r){return R9==e&&D9==r?O9:(R9=e,D9=r,O9=r=="up"||r=="down"?CQ(t,e,r):EQ(t,e,r))}const la=0,I9=1,xu=2,hs=3;class dm{constructor(e,r,n,i){this.parent=e,this.children=r,this.dom=n,this.contentDOM=i,this.dirty=la,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,r,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let r=0;r<this.children.length;r++)e+=this.children[r].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let r=0,n=this.posAtStart;;r++){let i=this.children[r];if(i==e)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,r,n){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(n<0){let a,s;if(e==this.contentDOM)a=e.childNodes[r-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.previousSibling}for(;a&&!((s=a.pmViewDesc)&&s.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(s)+s.size:this.posAtStart}else{let a,s;if(e==this.contentDOM)a=e.childNodes[r];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.nextSibling}for(;a&&!((s=a.pmViewDesc)&&s.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=r>kn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(r==0)for(let a=e;;a=a.parentNode){if(a==this.dom){i=!1;break}if(a.previousSibling)break}if(i==null&&r==e.childNodes.length)for(let a=e;;a=a.parentNode){if(a==this.dom){i=!0;break}if(a.nextSibling)break}}return i??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,r=!1){for(let n=!0,i=e;i;i=i.parentNode){let a=this.getDesc(i),s;if(a&&(!r||a.node))if(n&&(s=a.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))n=!1;else return a}}getDesc(e){let r=e.pmViewDesc;for(let n=r;n;n=n.parent)if(n==this)return r}posFromDOM(e,r,n){for(let i=e;i;i=i.parentNode){let a=this.getDesc(i);if(a)return a.localPosFromDOM(e,r,n)}return-1}descAt(e){for(let r=0,n=0;r<this.children.length;r++){let i=this.children[r],a=n+i.size;if(n==e&&a!=n){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let o=i.children[s];if(o.size){i=o;break}}return i}if(e<a)return i.descAt(e-n-i.border);n=a}}domFromPos(e,r){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,i=0;for(let a=0;n<this.children.length;n++){let s=this.children[n],o=a+s.size;if(o>e||s instanceof bD){i=e-a;break}a=o}if(i)return this.children[n].domFromPos(i-this.children[n].border,r);for(let a;n&&!(a=this.children[n-1]).size&&a instanceof xD&&a.side>=0;n--);if(r<=0){let a,s=!0;for(;a=n?this.children[n-1]:null,!(!a||a.dom.parentNode==this.contentDOM);n--,s=!1);return a&&r&&s&&!a.border&&!a.domAtom?a.domFromPos(a.size,r):{node:this.contentDOM,offset:a?kn(a.dom)+1:0}}else{let a,s=!0;for(;a=n<this.children.length?this.children[n]:null,!(!a||a.dom.parentNode==this.contentDOM);n++,s=!1);return a&&s&&!a.border&&!a.domAtom?a.domFromPos(0,r):{node:this.contentDOM,offset:a?kn(a.dom):this.contentDOM.childNodes.length}}}parseRange(e,r,n=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:r,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,a=-1;for(let s=n,o=0;;o++){let l=this.children[o],u=s+l.size;if(i==-1&&e<=u){let c=s+l.border;if(e>=c&&r<=u-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,r,c);e=s;for(let d=o;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){i=kn(h.dom)+1;break}e-=h.size}i==-1&&(i=0)}if(i>-1&&(u>r||o==this.children.length-1)){r=u;for(let c=o+1;c<this.children.length;c++){let d=this.children[c];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){a=kn(d.dom);break}r+=d.size}a==-1&&(a=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:r,fromOffset:i,toOffset:a}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let r=this.children[e<0?0:this.children.length-1];return r.size==0||r.emptyChildAt(e)}domAfterPos(e){let{node:r,offset:n}=this.domFromPos(e,0);if(r.nodeType!=1||n==r.childNodes.length)throw new RangeError("No node after pos "+e);return r.childNodes[n]}setSelection(e,r,n,i=!1){let a=Math.min(e,r),s=Math.max(e,r);for(let m=0,v=0;m<this.children.length;m++){let x=this.children[m],y=v+x.size;if(a>v&&s<y)return x.setSelection(e-v-x.border,r-v-x.border,n,i);v=y}let o=this.domFromPos(e,e?-1:1),l=r==e?o:this.domFromPos(r,r?-1:1),u=n.root.getSelection(),c=n.domSelectionRange(),d=!1;if((oa||Mn)&&e==r){let{node:m,offset:v}=o;if(m.nodeType==3){if(d=!!(v&&m.nodeValue[v-1]==`
`),d&&v==m.nodeValue.length)for(let x=m,y;x;x=x.parentNode){if(y=x.nextSibling){y.nodeName=="BR"&&(o=l={node:y.parentNode,offset:kn(y)+1});break}let b=x.pmViewDesc;if(b&&b.node&&b.node.isBlock)break}}else{let x=m.childNodes[v-1];d=x&&(x.nodeName=="BR"||x.contentEditable=="false")}}if(oa&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let m=c.focusNode.childNodes[c.focusOffset];m&&m.contentEditable=="false"&&(i=!0)}if(!(i||d&&Mn)&&Wu(o.node,o.offset,c.anchorNode,c.anchorOffset)&&Wu(l.node,l.offset,c.focusNode,c.focusOffset))return;let h=!1;if((u.extend||e==r)&&!(d&&oa)){u.collapse(o.node,o.offset);try{e!=r&&u.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>r){let v=o;o=l,l=v}let m=document.createRange();m.setEnd(l.node,l.offset),m.setStart(o.node,o.offset),u.removeAllRanges(),u.addRange(m)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,r){for(let n=0,i=0;i<this.children.length;i++){let a=this.children[i],s=n+a.size;if(n==s?e<=s&&r>=n:e<s&&r>n){let o=n+a.border,l=s-a.border;if(e>=o&&r<=l){this.dirty=e==n||r==s?xu:I9,e==o&&r==l&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=hs:a.markDirty(e-o,r-o);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?xu:hs}n=s}this.dirty=xu}markParentsDirty(){let e=1;for(let r=this.parent;r;r=r.parent,e++){let n=e==1?xu:I9;r.dirty<n&&(r.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class xD extends dm{constructor(e,r,n,i){let a,s=r.type.toDOM;if(typeof s=="function"&&(s=s(n,()=>{if(!a)return i;if(a.parent)return a.parent.posBeforeChild(a)})),!r.type.spec.raw){if(s.nodeType!=1){let o=document.createElement("span");o.appendChild(s),s=o}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=r,this.widget=r,a=this}matchesWidget(e){return this.dirty==la&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let r=this.widget.spec.stopEvent;return r?r(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class jQ extends dm{constructor(e,r,n,i){super(e,[],r,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(e,r){return e!=this.textDOM?this.posAtStart+(r?this.size:0):this.posAtStart+r}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class qu extends dm{constructor(e,r,n,i,a){super(e,[],n,i),this.mark=r,this.spec=a}static create(e,r,n,i){let a=i.nodeViews[r.type.name],s=a&&a(r,i,n);return(!s||!s.dom)&&(s=tc.renderSpec(document,r.type.spec.toDOM(r,n),null,r.attrs)),new qu(e,r,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&hs||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=hs&&this.mark.eq(e)}markDirty(e,r){if(super.markDirty(e,r),this.dirty!=la){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=la}}slice(e,r,n){let i=qu.create(this.parent,this.mark,!0,n),a=this.children,s=this.size;r<s&&(a=hk(a,r,s,n)),e>0&&(a=hk(a,0,e,n));for(let o=0;o<a.length;o++)a[o].parent=i;return i.children=a,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class dl extends dm{constructor(e,r,n,i,a,s,o,l,u){super(e,[],a,s),this.node=r,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=o}static create(e,r,n,i,a,s){let o=a.nodeViews[r.type.name],l,u=o&&o(r,a,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},n,i),c=u&&u.dom,d=u&&u.contentDOM;if(r.isText){if(!c)c=document.createTextNode(r.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:d}=tc.renderSpec(document,r.type.spec.toDOM(r),null,r.attrs));!d&&!r.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),r.type.spec.draggable&&(c.draggable=!0));let h=c;return c=kD(c,n,r),u?l=new MQ(e,r,n,i,c,d||null,h,u,a,s+1):r.isText?new xx(e,r,n,i,c,h,a):new dl(e,r,n,i,c,d||null,h,a,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let r=this.children.length-1;r>=0;r--){let n=this.children[r];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>be.empty)}return e}matchesNode(e,r,n){return this.dirty==la&&e.eq(this.node)&&F0(r,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,r){let n=this.node.inlineContent,i=r,a=e.composing?this.localCompositionInfo(e,r):null,s=a&&a.pos>-1?a:null,o=a&&a.pos<0,l=new _Q(this,s&&s.node,e);DQ(this.node,this.innerDeco,(u,c,d)=>{u.spec.marks?l.syncToMarks(u.spec.marks,n,e,c):u.type.side>=0&&!d&&l.syncToMarks(c==this.node.childCount?Gt.none:this.node.child(c).marks,n,e,c),l.placeWidget(u,e,i)},(u,c,d,h)=>{l.syncToMarks(u.marks,n,e,h);let m;l.findNodeMatch(u,c,d,h)||o&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(m=l.findIndexWithChild(a.node))>-1&&l.updateNodeAt(u,c,d,m,e)||l.updateNextNode(u,c,d,e,h,i)||l.addNode(u,c,d,e,i),i+=u.nodeSize}),l.syncToMarks([],n,e,0),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==xu)&&(s&&this.protectLocalComposition(e,s),wD(this.contentDOM,this.children,e),zd&&OQ(this.dom))}localCompositionInfo(e,r){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof at)||n<r||i>r+this.node.content.size)return null;let a=e.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let s=a.nodeValue,o=IQ(this.node.content,s,n-r,i-r);return o<0?null:{node:a,pos:o,text:s}}else return{node:a,pos:-1,text:""}}protectLocalComposition(e,{node:r,pos:n,text:i}){if(this.getDesc(r))return;let a=r;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let s=new jQ(this,a,r,i);e.input.compositionNodes.push(s),this.children=hk(this.children,n,n+i.length,e,s)}update(e,r,n,i){return this.dirty==hs||!e.sameMarkup(this.node)?!1:(this.updateInner(e,r,n,i),!0)}updateInner(e,r,n,i){this.updateOuterDeco(r),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=la}updateOuterDeco(e){if(F0(e,this.outerDeco))return;let r=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=SD(this.dom,this.nodeDOM,fk(this.outerDeco,this.node,r),fk(e,this.node,r)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function L9(t,e,r,n,i){kD(n,e,t);let a=new dl(void 0,t,e,r,n,n,n,i,0);return a.contentDOM&&a.updateChildren(i,0),a}class xx extends dl{constructor(e,r,n,i,a,s,o){super(e,r,n,i,a,null,s,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,r,n,i){return this.dirty==hs||this.dirty!=la&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(r),(this.dirty!=la||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=la,!0)}inParent(){let e=this.parent.contentDOM;for(let r=this.nodeDOM;r;r=r.parentNode)if(r==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,r,n){return e==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):super.localPosFromDOM(e,r,n)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,r,n){let i=this.node.cut(e,r),a=document.createTextNode(i.text);return new xx(this.parent,i,this.outerDeco,this.innerDeco,a,a,n)}markDirty(e,r){super.markDirty(e,r),this.dom!=this.nodeDOM&&(e==0||r==this.nodeDOM.nodeValue.length)&&(this.dirty=hs)}get domAtom(){return!1}isText(e){return this.node.text==e}}class bD extends dm{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==la&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class MQ extends dl{constructor(e,r,n,i,a,s,o,l,u,c){super(e,r,n,i,a,s,o,u,c),this.spec=l}update(e,r,n,i){if(this.dirty==hs)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let a=this.spec.update(e,r,n);return a&&this.updateInner(e,r,n,i),a}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,r,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,r,n,i){this.spec.setSelection?this.spec.setSelection(e,r,n.root):super.setSelection(e,r,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function wD(t,e,r){let n=t.firstChild,i=!1;for(let a=0;a<e.length;a++){let s=e[a],o=s.dom;if(o.parentNode==t){for(;o!=n;)n=B9(n),i=!0;n=n.nextSibling}else i=!0,t.insertBefore(o,n);if(s instanceof qu){let l=n?n.previousSibling:t.lastChild;wD(s.contentDOM,s.children,r),n=l?l.nextSibling:t.firstChild}}for(;n;)n=B9(n),i=!0;i&&r.trackWrites==t&&(r.trackWrites=null)}const Vh=function(t){t&&(this.nodeName=t)};Vh.prototype=Object.create(null);const bu=[new Vh];function fk(t,e,r){if(t.length==0)return bu;let n=r?bu[0]:new Vh,i=[n];for(let a=0;a<t.length;a++){let s=t[a].type.attrs;if(s){s.nodeName&&i.push(n=new Vh(s.nodeName));for(let o in s){let l=s[o];l!=null&&(r&&i.length==1&&i.push(n=new Vh(e.isInline?"span":"div")),o=="class"?n.class=(n.class?n.class+" ":"")+l:o=="style"?n.style=(n.style?n.style+";":"")+l:o!="nodeName"&&(n[o]=l))}}}return i}function SD(t,e,r,n){if(r==bu&&n==bu)return e;let i=e;for(let a=0;a<n.length;a++){let s=n[a],o=r[a];if(a){let l;o&&o.nodeName==s.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),o=bu[0]),i=l}PQ(i,o||bu[0],s)}return i}function PQ(t,e,r){for(let n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in r)&&t.removeAttribute(n);for(let n in r)n!="class"&&n!="style"&&n!="nodeName"&&r[n]!=e[n]&&t.setAttribute(n,r[n]);if(e.class!=r.class){let n=e.class?e.class.split(" ").filter(Boolean):[],i=r.class?r.class.split(" ").filter(Boolean):[];for(let a=0;a<n.length;a++)i.indexOf(n[a])==-1&&t.classList.remove(n[a]);for(let a=0;a<i.length;a++)n.indexOf(i[a])==-1&&t.classList.add(i[a]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=r.style){if(e.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=n.exec(e.style);)t.style.removeProperty(i[1])}r.style&&(t.style.cssText+=r.style)}}function kD(t,e,r){return SD(t,t,bu,fk(e,r,t.nodeType!=1))}function F0(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].type.eq(e[r].type))return!1;return!0}function B9(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class _Q{constructor(e,r,n){this.lock=r,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=AQ(e.node.content,e)}destroyBetween(e,r){if(e!=r){for(let n=e;n<r;n++)this.top.children[n].destroy();this.top.children.splice(e,r-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,r,n,i){let a=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;a<o&&(a==s-1?this.top:this.stack[a+1<<1]).matchesMark(e[a])&&e[a].type.spec.spanning!==!1;)a++;for(;a<s;)this.destroyRest(),this.top.dirty=la,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1,u=this.top.children.length;i<this.preMatch.index&&(u=Math.min(this.index+3,u));for(let c=this.index;c<u;c++){let d=this.top.children[c];if(d.matchesMark(e[s])&&!this.isLocked(d.dom)){l=c;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let c=qu.create(this.top,e[s],r,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,s++}}findNodeMatch(e,r,n,i){let a=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,r,n))a=this.top.children.indexOf(s,this.index);else for(let o=this.index,l=Math.min(this.top.children.length,o+5);o<l;o++){let u=this.top.children[o];if(u.matchesNode(e,r,n)&&!this.preMatch.matched.has(u)){a=o;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(e,r,n,i,a){let s=this.top.children[i];return s.dirty==hs&&s.dom==s.contentDOM&&(s.dirty=xu),s.update(e,r,n,a)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let r=e.parentNode;if(!r)return-1;if(r==this.top.contentDOM){let n=e.pmViewDesc;if(n){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==n)return i}return-1}e=r}}updateNextNode(e,r,n,i,a,s){for(let o=this.index;o<this.top.children.length;o++){let l=this.top.children[o];if(l instanceof dl){let u=this.preMatch.matched.get(l);if(u!=null&&u!=a)return!1;let c=l.dom,d,h=this.isLocked(c)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=hs&&F0(r,l.outerDeco));if(!h&&l.update(e,r,n,i))return this.destroyBetween(this.index,o),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(l,e,r,n,i,s)))return this.destroyBetween(this.index,o),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=xu,d.updateChildren(i,s+1),d.dirty=la),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,r,n,i,a,s){if(e.dirty||r.isAtom||!e.children.length||!e.node.content.eq(r.content)||!F0(n,e.outerDeco)||!i.eq(e.innerDeco))return null;let o=dl.create(this.top,r,n,i,a,s);if(o.contentDOM){o.children=e.children,e.children=[];for(let l of o.children)l.parent=o}return e.destroy(),o}addNode(e,r,n,i,a){let s=dl.create(this.top,e,r,n,i,a);s.contentDOM&&s.updateChildren(i,a+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,r,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let a=new xD(this.top,e,r,n);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],r=this.top;for(;e instanceof qu;)r=e,e=r.children[r.children.length-1];(!e||!(e instanceof xx)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Mn||fn)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",r),this.addHackNode("BR",this.top))}addHackNode(e,r){if(r==this.top&&this.index<r.children.length&&r.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);e=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),e=="BR"&&(n.className="ProseMirror-trailingBreak");let i=new bD(this.top,[],n,null);r!=this.top?r.children.push(i):r.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function AQ(t,e){let r=e,n=r.children.length,i=t.childCount,a=new Map,s=[];e:for(;i>0;){let o;for(;;)if(n){let u=r.children[n-1];if(u instanceof qu)r=u,n=u.children.length;else{o=u,n--;break}}else{if(r==e)break e;n=r.parent.children.indexOf(r),r=r.parent}let l=o.node;if(l){if(l!=t.child(i-1))break;--i,a.set(o,i),s.push(o)}}return{index:i,matched:a,matches:s.reverse()}}function RQ(t,e){return t.type.side-e.type.side}function DQ(t,e,r,n){let i=e.locals(t),a=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let c=t.child(u);n(c,i,e.forChild(a,c),u),a+=c.nodeSize}return}let s=0,o=[],l=null;for(let u=0;;){let c,d;for(;s<i.length&&i[s].to==a;){let y=i[s++];y.widget&&(c?(d||(d=[c])).push(y):c=y)}if(c)if(d){d.sort(RQ);for(let y=0;y<d.length;y++)r(d[y],u,!!l)}else r(c,u,!!l);let h,m;if(l)m=-1,h=l,l=null;else if(u<t.childCount)m=u,h=t.child(u++);else break;for(let y=0;y<o.length;y++)o[y].to<=a&&o.splice(y--,1);for(;s<i.length&&i[s].from<=a&&i[s].to>a;)o.push(i[s++]);let v=a+h.nodeSize;if(h.isText){let y=v;s<i.length&&i[s].from<y&&(y=i[s].from);for(let b=0;b<o.length;b++)o[b].to<y&&(y=o[b].to);y<v&&(l=h.cut(y-a),h=h.cut(0,y-a),v=y,m=-1)}else for(;s<i.length&&i[s].to<v;)s++;let x=h.isInline&&!h.isLeaf?o.filter(y=>!y.inline):o.slice();n(h,x,e.forChild(a,h),m),a=v}}function OQ(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function IQ(t,e,r,n){for(let i=0,a=0;i<t.childCount&&a<=n;){let s=t.child(i++),o=a;if(a+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<t.childCount;){let u=t.child(i++);if(a+=u.nodeSize,!u.isText)break;l+=u.text}if(a>=r){if(a>=n&&l.slice(n-e.length-o,n-o)==e)return n-e.length;let u=o<n?l.lastIndexOf(e,n-o-1):-1;if(u>=0&&u+e.length+o>=r)return o+u;if(r==n&&l.length>=n+e.length-o&&l.slice(n-o,n-o+e.length)==e)return n}}return-1}function hk(t,e,r,n,i){let a=[];for(let s=0,o=0;s<t.length;s++){let l=t[s],u=o,c=o+=l.size;u>=r||c<=e?a.push(l):(u<e&&a.push(l.slice(0,e-u,n)),i&&(a.push(i),i=void 0),c>r&&a.push(l.slice(r-u,l.size,n)))}return a}function E3(t,e=null){let r=t.domSelectionRange(),n=t.state.doc;if(!r.focusNode)return null;let i=t.docView.nearestDesc(r.focusNode),a=i&&i.size==0,s=t.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(s<0)return null;let o=n.resolve(s),l,u;if(yx(r)){for(l=s;i&&!i.node;)i=i.parent;let d=i.node;if(i&&d.isAtom&&Ye.isSelectable(d)&&i.parent&&!(d.isInline&&uQ(r.focusNode,r.focusOffset,i.dom))){let h=i.posBefore;u=new Ye(s==h?o:n.resolve(h))}}else{if(r instanceof t.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let d=s,h=s;for(let m=0;m<r.rangeCount;m++){let v=r.getRangeAt(m);d=Math.min(d,t.docView.posFromDOM(v.startContainer,v.startOffset,1)),h=Math.max(h,t.docView.posFromDOM(v.endContainer,v.endOffset,-1))}if(d<0)return null;[l,s]=h==t.state.selection.anchor?[h,d]:[d,h],o=n.resolve(s)}else l=t.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(l<0)return null}let c=n.resolve(l);if(!u){let d=e=="pointer"||t.state.selection.head<o.pos&&!a?1:-1;u=T3(t,c,o,d)}return u}function CD(t){return t.editable?t.hasFocus():ED(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function qs(t,e=!1){let r=t.state.selection;if(ND(t,r),!!CD(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&fn){let n=t.domSelectionRange(),i=t.domObserver.currentSelection;if(n.anchorNode&&i.anchorNode&&Wu(n.anchorNode,n.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)BQ(t);else{let{anchor:n,head:i}=r,a,s;F9&&!(r instanceof at)&&(r.$from.parent.inlineContent||(a=z9(t,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(s=z9(t,r.to))),t.docView.setSelection(n,i,t,e),F9&&(a&&V9(a),s&&V9(s)),r.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&LQ(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const F9=Mn||fn&&dD<63;function z9(t,e){let{node:r,offset:n}=t.docView.domFromPos(e,0),i=n<r.childNodes.length?r.childNodes[n]:null,a=n?r.childNodes[n-1]:null;if(Mn&&i&&i.contentEditable=="false")return iS(i);if((!i||i.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(i)return iS(i);if(a)return iS(a)}}function iS(t){return t.contentEditable="true",Mn&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function V9(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function LQ(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let r=t.domSelectionRange(),n=r.anchorNode,i=r.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(r.anchorNode!=n||r.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!CD(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function BQ(t){let e=t.domSelection();if(!e)return;let r=t.cursorWrapper.dom,n=r.nodeName=="IMG";n?e.collapse(r.parentNode,kn(r)+1):e.collapse(r,0),!n&&!t.state.selection.visible&&wi&&cl<=11&&(r.disabled=!0,r.disabled=!1)}function ND(t,e){if(e instanceof Ye){let r=t.docView.descAt(e.from);r!=t.lastSelectedViewDesc&&($9(t),r&&r.selectNode(),t.lastSelectedViewDesc=r)}else $9(t)}function $9(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function T3(t,e,r,n){return t.someProp("createSelectionBetween",i=>i(t,e,r))||at.between(e,r,n)}function U9(t){return t.editable&&!t.hasFocus()?!1:ED(t)}function ED(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function FQ(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),r=t.domSelectionRange();return Wu(e.node,e.offset,r.anchorNode,r.anchorOffset)}function pk(t,e){let{$anchor:r,$head:n}=t.selection,i=e>0?r.max(n):r.min(n),a=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return a&&ht.findFrom(a,e)}function Io(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function G9(t,e,r){let n=t.state.selection;if(n instanceof at)if(r.indexOf("s")>-1){let{$head:i}=n,a=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+a.nodeSize*(e<0?-1:1));return Io(t,new at(n.$anchor,s))}else if(n.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=pk(t.state,e);return i&&i instanceof Ye?Io(t,i):!1}else if(!(Ji&&r.indexOf("m")>-1)){let i=n.$head,a=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!a||a.isText)return!1;let o=e<0?i.pos-a.nodeSize:i.pos;return a.isAtom||(s=t.docView.descAt(o))&&!s.contentDOM?Ye.isSelectable(a)?Io(t,new Ye(e<0?t.state.doc.resolve(i.pos-a.nodeSize):i)):cm?Io(t,new at(t.state.doc.resolve(e<0?o:o+a.nodeSize))):!1:!1}}else return!1;else{if(n instanceof Ye&&n.node.isInline)return Io(t,new at(e>0?n.$to:n.$from));{let i=pk(t.state,e);return i?Io(t,i):!1}}}function z0(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function $h(t,e){let r=t.pmViewDesc;return r&&r.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Bc(t,e){return e<0?zQ(t):VQ(t)}function zQ(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i,a,s=!1;for(oa&&r.nodeType==1&&n<z0(r)&&$h(r.childNodes[n],-1)&&(s=!0);;)if(n>0){if(r.nodeType!=1)break;{let o=r.childNodes[n-1];if($h(o,-1))i=r,a=--n;else if(o.nodeType==3)r=o,n=r.nodeValue.length;else break}}else{if(TD(r))break;{let o=r.previousSibling;for(;o&&$h(o,-1);)i=r.parentNode,a=kn(o),o=o.previousSibling;if(o)r=o,n=z0(r);else{if(r=r.parentNode,r==t.dom)break;n=0}}}s?mk(t,r,n):i&&mk(t,i,a)}function VQ(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i=z0(r),a,s;for(;;)if(n<i){if(r.nodeType!=1)break;let o=r.childNodes[n];if($h(o,1))a=r,s=++n;else break}else{if(TD(r))break;{let o=r.nextSibling;for(;o&&$h(o,1);)a=o.parentNode,s=kn(o)+1,o=o.nextSibling;if(o)r=o,n=0,i=z0(r);else{if(r=r.parentNode,r==t.dom)break;n=i=0}}}a&&mk(t,a,s)}function TD(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function $Q(t,e){for(;t&&e==t.childNodes.length&&!um(t);)e=kn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let r=t.childNodes[e];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=0}}function UQ(t,e){for(;t&&!e&&!um(t);)e=kn(t),t=t.parentNode;for(;t&&e;){let r=t.childNodes[e-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=t.childNodes.length}}function mk(t,e,r){if(e.nodeType!=3){let a,s;(s=$Q(e,r))?(e=s,r=0):(a=UQ(e,r))&&(e=a,r=a.nodeValue.length)}let n=t.domSelection();if(!n)return;if(yx(n)){let a=document.createRange();a.setEnd(e,r),a.setStart(e,r),n.removeAllRanges(),n.addRange(a)}else n.extend&&n.extend(e,r);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&qs(t)},50)}function H9(t,e){let r=t.state.doc.resolve(e);if(!(fn||fD)&&r.parent.inlineContent){let i=t.coordsAtPos(e);if(e>r.start()){let a=t.coordsAtPos(e-1),s=(a.top+a.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(a.left-i.left)>1)return a.left<i.left?"ltr":"rtl"}if(e<r.end()){let a=t.coordsAtPos(e+1),s=(a.top+a.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(a.left-i.left)>1)return a.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function W9(t,e,r){let n=t.state.selection;if(n instanceof at&&!n.empty||r.indexOf("s")>-1||Ji&&r.indexOf("m")>-1)return!1;let{$from:i,$to:a}=n;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=pk(t.state,e);if(s&&s instanceof Ye)return Io(t,s)}if(!i.parent.inlineContent){let s=e<0?i:a,o=n instanceof sa?ht.near(s,e):ht.findFrom(s,e);return o?Io(t,o):!1}return!1}function q9(t,e){if(!(t.state.selection instanceof at))return!0;let{$head:r,$anchor:n,empty:i}=t.state.selection;if(!r.sameParent(n))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let a=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(a&&!a.isText){let s=t.state.tr;return e<0?s.delete(r.pos-a.nodeSize,r.pos):s.delete(r.pos,r.pos+a.nodeSize),t.dispatch(s),!0}return!1}function K9(t,e,r){t.domObserver.stop(),e.contentEditable=r,t.domObserver.start()}function GQ(t){if(!Mn||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:r}=t.domSelectionRange();if(e&&e.nodeType==1&&r==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let n=e.firstChild;K9(t,n,"true"),setTimeout(()=>K9(t,n,"false"),20)}return!1}function HQ(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function WQ(t,e){let r=e.keyCode,n=HQ(e);if(r==8||Ji&&r==72&&n=="c")return q9(t,-1)||Bc(t,-1);if(r==46&&!e.shiftKey||Ji&&r==68&&n=="c")return q9(t,1)||Bc(t,1);if(r==13||r==27)return!0;if(r==37||Ji&&r==66&&n=="c"){let i=r==37?H9(t,t.state.selection.from)=="ltr"?-1:1:-1;return G9(t,i,n)||Bc(t,i)}else if(r==39||Ji&&r==70&&n=="c"){let i=r==39?H9(t,t.state.selection.from)=="ltr"?1:-1:1;return G9(t,i,n)||Bc(t,i)}else{if(r==38||Ji&&r==80&&n=="c")return W9(t,-1,n)||Bc(t,-1);if(r==40||Ji&&r==78&&n=="c")return GQ(t)||W9(t,1,n)||Bc(t,1);if(n==(Ji?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function j3(t,e){t.someProp("transformCopied",m=>{e=m(e,t)});let r=[],{content:n,openStart:i,openEnd:a}=e;for(;i>1&&a>1&&n.childCount==1&&n.firstChild.childCount==1;){i--,a--;let m=n.firstChild;r.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),n=m.content}let s=t.someProp("clipboardSerializer")||tc.fromSchema(t.state.schema),o=RD(),l=o.createElement("div");l.appendChild(s.serializeFragment(n,{document:o}));let u=l.firstChild,c,d=0;for(;u&&u.nodeType==1&&(c=AD[u.nodeName.toLowerCase()]);){for(let m=c.length-1;m>=0;m--){let v=o.createElement(c[m]);for(;l.firstChild;)v.appendChild(l.firstChild);l.appendChild(v),d++}u=l.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${a}${d?` -${d}`:""} ${JSON.stringify(r)}`);let h=t.someProp("clipboardTextSerializer",m=>m(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function jD(t,e,r,n,i){let a=i.parent.type.spec.code,s,o;if(!r&&!e)return null;let l=!!e&&(n||a||!r);if(l){if(t.someProp("transformPastedText",h=>{e=h(e,a||n,t)}),a)return o=new Ae(be.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",h=>{o=h(o,t,!0)}),o;let d=t.someProp("clipboardTextParser",h=>h(e,i,n,t));if(d)o=d;else{let h=i.marks(),{schema:m}=t.state,v=tc.fromSchema(m);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(x=>{let y=s.appendChild(document.createElement("p"));x&&y.appendChild(v.serializeNode(m.text(x,h)))})}}else t.someProp("transformPastedHTML",d=>{r=d(r,t)}),s=XQ(r),cm&&QQ(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let d=+c[3];d>0;d--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(o||(o=(t.someProp("clipboardParser")||t.someProp("domParser")||ul.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||c),context:i,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!qQ.test(h.parentNode.nodeName)?{ignore:!0}:null}})),c)o=JQ(Y9(o,+c[1],+c[2]),c[4]);else if(o=Ae.maxOpen(KQ(o.content,i),!0),o.openStart||o.openEnd){let d=0,h=0;for(let m=o.content.firstChild;d<o.openStart&&!m.type.spec.isolating;d++,m=m.firstChild);for(let m=o.content.lastChild;h<o.openEnd&&!m.type.spec.isolating;h++,m=m.lastChild);o=Y9(o,d,h)}return t.someProp("transformPasted",d=>{o=d(o,t,l)}),o}const qQ=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function KQ(t,e){if(t.childCount<2)return t;for(let r=e.depth;r>=0;r--){let i=e.node(r).contentMatchAt(e.index(r)),a,s=[];if(t.forEach(o=>{if(!s)return;let l=i.findWrapping(o.type),u;if(!l)return s=null;if(u=s.length&&a.length&&PD(l,a,o,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=_D(s[s.length-1],a.length));let c=MD(o,l);s.push(c),i=i.matchType(c.type),a=l}}),s)return be.from(s)}return t}function MD(t,e,r=0){for(let n=e.length-1;n>=r;n--)t=e[n].create(null,be.from(t));return t}function PD(t,e,r,n,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let a=PD(t,e,r,n.lastChild,i+1);if(a)return n.copy(n.content.replaceChild(n.childCount-1,a));if(n.contentMatchAt(n.childCount).matchType(i==t.length-1?r.type:t[i+1]))return n.copy(n.content.append(be.from(MD(r,t,i+1))))}}function _D(t,e){if(e==0)return t;let r=t.content.replaceChild(t.childCount-1,_D(t.lastChild,e-1)),n=t.contentMatchAt(t.childCount).fillBefore(be.empty,!0);return t.copy(r.append(n))}function gk(t,e,r,n,i,a){let s=e<0?t.firstChild:t.lastChild,o=s.content;return t.childCount>1&&(a=0),i<n-1&&(o=gk(o,e,r,n,i+1,a)),i>=r&&(o=e<0?s.contentMatchAt(0).fillBefore(o,a<=i).append(o):o.append(s.contentMatchAt(s.childCount).fillBefore(be.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(o))}function Y9(t,e,r){return e<t.openStart&&(t=new Ae(gk(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),r<t.openEnd&&(t=new Ae(gk(t.content,1,r,t.openEnd,0,0),t.openStart,r)),t}const AD={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let X9=null;function RD(){return X9||(X9=document.implementation.createHTMLDocument("title"))}let aS=null;function YQ(t){let e=window.trustedTypes;return e?(aS||(aS=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),aS.createHTML(t)):t}function XQ(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let r=RD().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(t),i;if((i=n&&AD[n[1].toLowerCase()])&&(t=i.map(a=>"<"+a+">").join("")+t+i.map(a=>"</"+a+">").reverse().join("")),r.innerHTML=YQ(t),i)for(let a=0;a<i.length;a++)r=r.querySelector(i[a])||r;return r}function QQ(t){let e=t.querySelectorAll(fn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<e.length;r++){let n=e[r];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),n)}}function JQ(t,e){if(!t.size)return t;let r=t.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return t}let{content:i,openStart:a,openEnd:s}=t;for(let o=n.length-2;o>=0;o-=2){let l=r.nodes[n[o]];if(!l||l.hasRequiredAttrs())break;i=be.from(l.create(n[o+1],i)),a++,s++}return new Ae(i,a,s)}const ti={},ri={},ZQ={touchstart:!0,touchmove:!0};class eJ{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function tJ(t){for(let e in ti){let r=ti[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=n=>{nJ(t,n)&&!M3(t,n)&&(t.editable||!(n.type in ri))&&r(t,n)},ZQ[e]?{passive:!0}:void 0)}Mn&&t.dom.addEventListener("input",()=>null),vk(t)}function Qo(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function rJ(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function vk(t){t.someProp("handleDOMEvents",e=>{for(let r in e)t.input.eventHandlers[r]||t.dom.addEventListener(r,t.input.eventHandlers[r]=n=>M3(t,n))})}function M3(t,e){return t.someProp("handleDOMEvents",r=>{let n=r[e.type];return n?n(t,e)||e.defaultPrevented:!1})}function nJ(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target;r!=t.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(e))return!1;return!0}function iJ(t,e){!M3(t,e)&&ti[e.type]&&(t.editable||!(e.type in ri))&&ti[e.type](t,e)}ri.keydown=(t,e)=>{let r=e;if(t.input.shiftKey=r.keyCode==16||r.shiftKey,!OD(t,r)&&(t.input.lastKeyCode=r.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Gs&&fn&&r.keyCode==13)))if(r.keyCode!=229&&t.domObserver.forceFlush(),zd&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();t.input.lastIOSEnter=n,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==n&&(t.someProp("handleKeyDown",i=>i(t,pu(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",n=>n(t,r))||WQ(t,r)?r.preventDefault():Qo(t,"key")};ri.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};ri.keypress=(t,e)=>{let r=e;if(OD(t,r)||!r.charCode||r.ctrlKey&&!r.altKey||Ji&&r.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,r))){r.preventDefault();return}let n=t.state.selection;if(!(n instanceof at)||!n.$from.sameParent(n.$to)){let i=String.fromCharCode(r.charCode),a=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",s=>s(t,n.$from.pos,n.$to.pos,i,a))&&t.dispatch(a()),r.preventDefault()}};function bx(t){return{left:t.clientX,top:t.clientY}}function aJ(t,e){let r=e.x-t.clientX,n=e.y-t.clientY;return r*r+n*n<100}function P3(t,e,r,n,i){if(n==-1)return!1;let a=t.state.doc.resolve(n);for(let s=a.depth+1;s>0;s--)if(t.someProp(e,o=>s>a.depth?o(t,r,a.nodeAfter,a.before(s),i,!0):o(t,r,a.node(s),a.before(s),i,!1)))return!0;return!1}function Cd(t,e,r){if(t.focused||t.focus(),t.state.selection.eq(e))return;let n=t.state.tr.setSelection(e);r=="pointer"&&n.setMeta("pointer",!0),t.dispatch(n)}function sJ(t,e){if(e==-1)return!1;let r=t.state.doc.resolve(e),n=r.nodeAfter;return n&&n.isAtom&&Ye.isSelectable(n)?(Cd(t,new Ye(r),"pointer"),!0):!1}function oJ(t,e){if(e==-1)return!1;let r=t.state.selection,n,i;r instanceof Ye&&(n=r.node);let a=t.state.doc.resolve(e);for(let s=a.depth+1;s>0;s--){let o=s>a.depth?a.nodeAfter:a.node(s);if(Ye.isSelectable(o)){n&&r.$from.depth>0&&s>=r.$from.depth&&a.before(r.$from.depth+1)==r.$from.pos?i=a.before(r.$from.depth):i=a.before(s);break}}return i!=null?(Cd(t,Ye.create(t.state.doc,i),"pointer"),!0):!1}function lJ(t,e,r,n,i){return P3(t,"handleClickOn",e,r,n)||t.someProp("handleClick",a=>a(t,e,n))||(i?oJ(t,r):sJ(t,r))}function uJ(t,e,r,n){return P3(t,"handleDoubleClickOn",e,r,n)||t.someProp("handleDoubleClick",i=>i(t,e,n))}function cJ(t,e,r,n){return P3(t,"handleTripleClickOn",e,r,n)||t.someProp("handleTripleClick",i=>i(t,e,n))||dJ(t,r,n)}function dJ(t,e,r){if(r.button!=0)return!1;let n=t.state.doc;if(e==-1)return n.inlineContent?(Cd(t,at.create(n,0,n.content.size),"pointer"),!0):!1;let i=n.resolve(e);for(let a=i.depth+1;a>0;a--){let s=a>i.depth?i.nodeAfter:i.node(a),o=i.before(a);if(s.inlineContent)Cd(t,at.create(n,o+1,o+1+s.content.size),"pointer");else if(Ye.isSelectable(s))Cd(t,Ye.create(n,o),"pointer");else continue;return!0}}function _3(t){return V0(t)}const DD=Ji?"metaKey":"ctrlKey";ti.mousedown=(t,e)=>{let r=e;t.input.shiftKey=r.shiftKey;let n=_3(t),i=Date.now(),a="singleClick";i-t.input.lastClick.time<500&&aJ(r,t.input.lastClick)&&!r[DD]&&t.input.lastClick.button==r.button&&(t.input.lastClick.type=="singleClick"?a="doubleClick":t.input.lastClick.type=="doubleClick"&&(a="tripleClick")),t.input.lastClick={time:i,x:r.clientX,y:r.clientY,type:a,button:r.button};let s=t.posAtCoords(bx(r));s&&(a=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new fJ(t,s,r,!!n)):(a=="doubleClick"?uJ:cJ)(t,s.pos,s.inside,r)?r.preventDefault():Qo(t,"pointer"))};class fJ{constructor(e,r,n,i){this.view=e,this.pos=r,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[DD],this.allowDefault=n.shiftKey;let a,s;if(r.inside>-1)a=e.state.doc.nodeAt(r.inside),s=r.inside;else{let c=e.state.doc.resolve(r.pos);a=c.parent,s=c.depth?c.before():0}const o=i?null:n.target,l=o?e.docView.nearestDesc(o,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:u}=e.state;(n.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||u instanceof Ye&&u.from<=s&&u.to>s)&&(this.mightDrag={node:a,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&oa&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Qo(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>qs(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(bx(e))),this.updateAllowDefault(e),this.allowDefault||!r?Qo(this.view,"pointer"):lJ(this.view,r.pos,r.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Mn&&this.mightDrag&&!this.mightDrag.node.isAtom||fn&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?(Cd(this.view,ht.near(this.view.state.doc.resolve(r.pos)),"pointer"),e.preventDefault()):Qo(this.view,"pointer")}move(e){this.updateAllowDefault(e),Qo(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}ti.touchstart=t=>{t.input.lastTouch=Date.now(),_3(t),Qo(t,"pointer")};ti.touchmove=t=>{t.input.lastTouch=Date.now(),Qo(t,"pointer")};ti.contextmenu=t=>_3(t);function OD(t,e){return t.composing?!0:Mn&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const hJ=Gs?5e3:-1;ri.compositionstart=ri.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,r=e.selection.$to;if(e.selection instanceof at&&(e.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)||fn&&fD&&pJ(t)))t.markCursor=t.state.storedMarks||r.marks(),V0(t,!0),t.markCursor=null;else if(V0(t,!e.selection.empty),oa&&e.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=t.domSelectionRange();for(let i=n.focusNode,a=n.focusOffset;i&&i.nodeType==1&&a!=0;){let s=a<0?i.lastChild:i.childNodes[a-1];if(!s)break;if(s.nodeType==3){let o=t.domSelection();o&&o.collapse(s,s.nodeValue.length);break}else i=s,a=-1}}t.input.composing=!0}ID(t,hJ)};function pJ(t){let{focusNode:e,focusOffset:r}=t.domSelectionRange();if(!e||e.nodeType!=1||r>=e.childNodes.length)return!1;let n=e.childNodes[r];return n.nodeType==1&&n.contentEditable=="false"}ri.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,ID(t,20))};function ID(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>V0(t),e))}function LD(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=gJ());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function mJ(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let r=oQ(e.focusNode,e.focusOffset),n=lQ(e.focusNode,e.focusOffset);if(r&&n&&r!=n){let i=n.pmViewDesc,a=t.domObserver.lastChangedTextNode;if(r==a||n==a)return a;if(!i||!i.isText(n.nodeValue))return n;if(t.input.compositionNode==n){let s=r.pmViewDesc;if(!(!s||!s.isText(r.nodeValue)))return n}}return r||n}function gJ(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function V0(t,e=!1){if(!(Gs&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),LD(t),e||t.docView&&t.docView.dirty){let r=E3(t),n=t.state.selection;return r&&!r.eq(n)?t.dispatch(t.state.tr.setSelection(r)):(t.markCursor||e)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function vJ(t,e){if(!t.dom.parentNode)return;let r=t.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(e),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),t.focus()},50)}const _p=wi&&cl<15||zd&&fQ<604;ti.copy=ri.cut=(t,e)=>{let r=e,n=t.state.selection,i=r.type=="cut";if(n.empty)return;let a=_p?null:r.clipboardData,s=n.content(),{dom:o,text:l}=j3(t,s);a?(r.preventDefault(),a.clearData(),a.setData("text/html",o.innerHTML),a.setData("text/plain",l)):vJ(t,o),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function yJ(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function xJ(t,e){if(!t.dom.parentNode)return;let r=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,n=t.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),n.parentNode&&n.parentNode.removeChild(n),r?Ap(t,n.value,null,i,e):Ap(t,n.textContent,n.innerHTML,i,e)},50)}function Ap(t,e,r,n,i){let a=jD(t,e,r,n,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,i,a||Ae.empty)))return!0;if(!a)return!1;let s=yJ(a),o=s?t.state.tr.replaceSelectionWith(s,n):t.state.tr.replaceSelection(a);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function BD(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let r=t.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}ri.paste=(t,e)=>{let r=e;if(t.composing&&!Gs)return;let n=_p?null:r.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;n&&Ap(t,BD(n),n.getData("text/html"),i,r)?r.preventDefault():xJ(t,r)};class FD{constructor(e,r,n){this.slice=e,this.move=r,this.node=n}}const bJ=Ji?"altKey":"ctrlKey";function zD(t,e){let r=t.someProp("dragCopies",n=>!n(e));return r??!e[bJ]}ti.dragstart=(t,e)=>{let r=e,n=t.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let i=t.state.selection,a=i.empty?null:t.posAtCoords(bx(r)),s;if(!(a&&a.pos>=i.from&&a.pos<=(i instanceof Ye?i.to-1:i.to))){if(n&&n.mightDrag)s=Ye.create(t.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let d=t.docView.nearestDesc(r.target,!0);d&&d.node.type.spec.draggable&&d!=t.docView&&(s=Ye.create(t.state.doc,d.posBefore))}}let o=(s||t.state.selection).content(),{dom:l,text:u,slice:c}=j3(t,o);(!r.dataTransfer.files.length||!fn||dD>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData(_p?"Text":"text/html",l.innerHTML),r.dataTransfer.effectAllowed="copyMove",_p||r.dataTransfer.setData("text/plain",u),t.dragging=new FD(c,zD(t,r),s)};ti.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};ri.dragover=ri.dragenter=(t,e)=>e.preventDefault();ri.drop=(t,e)=>{try{wJ(t,e,t.dragging)}finally{t.dragging=null}};function wJ(t,e,r){if(!e.dataTransfer)return;let n=t.posAtCoords(bx(e));if(!n)return;let i=t.state.doc.resolve(n.pos),a=r&&r.slice;a?t.someProp("transformPasted",m=>{a=m(a,t,!1)}):a=jD(t,BD(e.dataTransfer),_p?null:e.dataTransfer.getData("text/html"),!1,i);let s=!!(r&&zD(t,e));if(t.someProp("handleDrop",m=>m(t,e,a||Ae.empty,s))){e.preventDefault();return}if(!a)return;e.preventDefault();let o=a?X7(t.state.doc,i.pos,a):i.pos;o==null&&(o=i.pos);let l=t.state.tr;if(s){let{node:m}=r;m?m.replace(l):l.deleteSelection()}let u=l.mapping.map(o),c=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,d=l.doc;if(c?l.replaceRangeWith(u,u,a.content.firstChild):l.replaceRange(u,u,a),l.doc.eq(d))return;let h=l.doc.resolve(u);if(c&&Ye.isSelectable(a.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(a.content.firstChild))l.setSelection(new Ye(h));else{let m=l.mapping.map(o);l.mapping.maps[l.mapping.maps.length-1].forEach((v,x,y,b)=>m=b),l.setSelection(T3(t,h,l.doc.resolve(m)))}t.focus(),t.dispatch(l.setMeta("uiEvent","drop"))}ti.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&qs(t)},20))};ti.blur=(t,e)=>{let r=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),r.relatedTarget&&t.dom.contains(r.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};ti.beforeinput=(t,e)=>{if(fn&&Gs&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:n}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=n||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",a=>a(t,pu(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in ri)ti[t]=ri[t];function Rp(t,e){if(t==e)return!0;for(let r in t)if(t[r]!==e[r])return!1;for(let r in e)if(!(r in t))return!1;return!0}class $0{constructor(e,r){this.toDOM=e,this.spec=r||ju,this.side=this.spec.side||0}map(e,r,n,i){let{pos:a,deleted:s}=e.mapResult(r.from+i,this.side<0?-1:1);return s?null:new $n(a-n,a-n,this)}valid(){return!0}eq(e){return this==e||e instanceof $0&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Rp(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class fl{constructor(e,r){this.attrs=e,this.spec=r||ju}map(e,r,n,i){let a=e.map(r.from+i,this.spec.inclusiveStart?-1:1)-n,s=e.map(r.to+i,this.spec.inclusiveEnd?1:-1)-n;return a>=s?null:new $n(a,s,this)}valid(e,r){return r.from<r.to}eq(e){return this==e||e instanceof fl&&Rp(this.attrs,e.attrs)&&Rp(this.spec,e.spec)}static is(e){return e.type instanceof fl}destroy(){}}class A3{constructor(e,r){this.attrs=e,this.spec=r||ju}map(e,r,n,i){let a=e.mapResult(r.from+i,1);if(a.deleted)return null;let s=e.mapResult(r.to+i,-1);return s.deleted||s.pos<=a.pos?null:new $n(a.pos-n,s.pos-n,this)}valid(e,r){let{index:n,offset:i}=e.content.findIndex(r.from),a;return i==r.from&&!(a=e.child(n)).isText&&i+a.nodeSize==r.to}eq(e){return this==e||e instanceof A3&&Rp(this.attrs,e.attrs)&&Rp(this.spec,e.spec)}destroy(){}}class $n{constructor(e,r,n){this.from=e,this.to=r,this.type=n}copy(e,r){return new $n(e,r,this.type)}eq(e,r=0){return this.type.eq(e.type)&&this.from+r==e.from&&this.to+r==e.to}map(e,r,n){return this.type.map(e,this,r,n)}static widget(e,r,n){return new $n(e,e,new $0(r,n))}static inline(e,r,n,i){return new $n(e,r,new fl(n,i))}static node(e,r,n,i){return new $n(e,r,new A3(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof fl}get widget(){return this.type instanceof $0}}const Gc=[],ju={};class sr{constructor(e,r){this.local=e.length?e:Gc,this.children=r.length?r:Gc}static create(e,r){return r.length?U0(r,e,0,ju):zn}find(e,r,n){let i=[];return this.findInner(e??0,r??1e9,i,0,n),i}findInner(e,r,n,i,a){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=r&&o.to>=e&&(!a||a(o.spec))&&n.push(o.copy(o.from+i,o.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<r&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,r-o,n,i+o,a)}}map(e,r,n){return this==zn||e.maps.length==0?this:this.mapInner(e,r,0,0,n||ju)}mapInner(e,r,n,i,a){let s;for(let o=0;o<this.local.length;o++){let l=this.local[o].map(e,n,i);l&&l.type.valid(r,l)?(s||(s=[])).push(l):a.onRemove&&a.onRemove(this.local[o].spec)}return this.children.length?SJ(this.children,s||[],e,r,n,i,a):s?new sr(s.sort(Mu),Gc):zn}add(e,r){return r.length?this==zn?sr.create(e,r):this.addInner(e,r,0):this}addInner(e,r,n){let i,a=0;e.forEach((o,l)=>{let u=l+n,c;if(c=$D(r,o,u)){for(i||(i=this.children.slice());a<i.length&&i[a]<l;)a+=3;i[a]==l?i[a+2]=i[a+2].addInner(o,c,u+1):i.splice(a,0,l,l+o.nodeSize,U0(c,o,u+1,ju)),a+=3}});let s=VD(a?UD(r):r,-n);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||s.splice(o--,1);return new sr(s.length?this.local.concat(s).sort(Mu):this.local,i||this.children)}remove(e){return e.length==0||this==zn?this:this.removeInner(e,0)}removeInner(e,r){let n=this.children,i=this.local;for(let a=0;a<n.length;a+=3){let s,o=n[a]+r,l=n[a+1]+r;for(let c=0,d;c<e.length;c++)(d=e[c])&&d.from>o&&d.to<l&&(e[c]=null,(s||(s=[])).push(d));if(!s)continue;n==this.children&&(n=this.children.slice());let u=n[a+2].removeInner(s,o+1);u!=zn?n[a+2]=u:(n.splice(a,3),a-=3)}if(i.length){for(let a=0,s;a<e.length;a++)if(s=e[a])for(let o=0;o<i.length;o++)i[o].eq(s,r)&&(i==this.local&&(i=this.local.slice()),i.splice(o--,1))}return n==this.children&&i==this.local?this:i.length||n.length?new sr(i,n):zn}forChild(e,r){if(this==zn)return this;if(r.isLeaf)return sr.empty;let n,i;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}let a=e+1,s=a+r.content.size;for(let o=0;o<this.local.length;o++){let l=this.local[o];if(l.from<s&&l.to>a&&l.type instanceof fl){let u=Math.max(a,l.from)-a,c=Math.min(s,l.to)-a;u<c&&(i||(i=[])).push(l.copy(u,c))}}if(i){let o=new sr(i.sort(Mu),Gc);return n?new Vo([o,n]):o}return n||zn}eq(e){if(this==e)return!0;if(!(e instanceof sr)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(e.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=e.children[r]||this.children[r+1]!=e.children[r+1]||!this.children[r+2].eq(e.children[r+2]))return!1;return!0}locals(e){return R3(this.localsInner(e))}localsInner(e){if(this==zn)return Gc;if(e.inlineContent||!this.local.some(fl.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof fl||r.push(this.local[n]);return r}forEachSet(e){e(this)}}sr.empty=new sr([],[]);sr.removeOverlap=R3;const zn=sr.empty;class Vo{constructor(e){this.members=e}map(e,r){const n=this.members.map(i=>i.map(e,r,ju));return Vo.from(n)}forChild(e,r){if(r.isLeaf)return sr.empty;let n=[];for(let i=0;i<this.members.length;i++){let a=this.members[i].forChild(e,r);a!=zn&&(a instanceof Vo?n=n.concat(a.members):n.push(a))}return Vo.from(n)}eq(e){if(!(e instanceof Vo)||e.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(e.members[r]))return!1;return!0}locals(e){let r,n=!0;for(let i=0;i<this.members.length;i++){let a=this.members[i].localsInner(e);if(a.length)if(!r)r=a;else{n&&(r=r.slice(),n=!1);for(let s=0;s<a.length;s++)r.push(a[s])}}return r?R3(n?r:r.sort(Mu)):Gc}static from(e){switch(e.length){case 0:return zn;case 1:return e[0];default:return new Vo(e.every(r=>r instanceof sr)?e:e.reduce((r,n)=>r.concat(n instanceof sr?n:n.members),[]))}}forEachSet(e){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(e)}}function SJ(t,e,r,n,i,a,s){let o=t.slice();for(let u=0,c=a;u<r.maps.length;u++){let d=0;r.maps[u].forEach((h,m,v,x)=>{let y=x-v-(m-h);for(let b=0;b<o.length;b+=3){let S=o[b+1];if(S<0||h>S+c-d)continue;let w=o[b]+c-d;m>=w?o[b+1]=h<=w?-2:-1:h>=c&&y&&(o[b]+=y,o[b+1]+=y)}d+=y}),c=r.maps[u].map(c,-1)}let l=!1;for(let u=0;u<o.length;u+=3)if(o[u+1]<0){if(o[u+1]==-2){l=!0,o[u+1]=-1;continue}let c=r.map(t[u]+a),d=c-i;if(d<0||d>=n.content.size){l=!0;continue}let h=r.map(t[u+1]+a,-1),m=h-i,{index:v,offset:x}=n.content.findIndex(d),y=n.maybeChild(v);if(y&&x==d&&x+y.nodeSize==m){let b=o[u+2].mapInner(r,y,c+1,t[u]+a+1,s);b!=zn?(o[u]=d,o[u+1]=m,o[u+2]=b):(o[u+1]=-2,l=!0)}else l=!0}if(l){let u=kJ(o,t,e,r,i,a,s),c=U0(u,n,0,s);e=c.local;for(let d=0;d<o.length;d+=3)o[d+1]<0&&(o.splice(d,3),d-=3);for(let d=0,h=0;d<c.children.length;d+=3){let m=c.children[d];for(;h<o.length&&o[h]<m;)h+=3;o.splice(h,0,c.children[d],c.children[d+1],c.children[d+2])}}return new sr(e.sort(Mu),o)}function VD(t,e){if(!e||!t.length)return t;let r=[];for(let n=0;n<t.length;n++){let i=t[n];r.push(new $n(i.from+e,i.to+e,i.type))}return r}function kJ(t,e,r,n,i,a,s){function o(l,u){for(let c=0;c<l.local.length;c++){let d=l.local[c].map(n,i,u);d?r.push(d):s.onRemove&&s.onRemove(l.local[c].spec)}for(let c=0;c<l.children.length;c+=3)o(l.children[c+2],l.children[c]+u+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&o(t[l+2],e[l]+a+1);return r}function $D(t,e,r){if(e.isLeaf)return null;let n=r+e.nodeSize,i=null;for(let a=0,s;a<t.length;a++)(s=t[a])&&s.from>r&&s.to<n&&((i||(i=[])).push(s),t[a]=null);return i}function UD(t){let e=[];for(let r=0;r<t.length;r++)t[r]!=null&&e.push(t[r]);return e}function U0(t,e,r,n){let i=[],a=!1;e.forEach((o,l)=>{let u=$D(t,o,l+r);if(u){a=!0;let c=U0(u,o,r+l+1,n);c!=zn&&i.push(l,l+o.nodeSize,c)}});let s=VD(a?UD(t):t,-r).sort(Mu);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||(n.onRemove&&n.onRemove(s[o].spec),s.splice(o--,1));return s.length||i.length?new sr(s,i):zn}function Mu(t,e){return t.from-e.from||t.to-e.to}function R3(t){let e=t;for(let r=0;r<e.length-1;r++){let n=e[r];if(n.from!=n.to)for(let i=r+1;i<e.length;i++){let a=e[i];if(a.from==n.from){a.to!=n.to&&(e==t&&(e=t.slice()),e[i]=a.copy(a.from,n.to),Q9(e,i+1,a.copy(n.to,a.to)));continue}else{a.from<n.to&&(e==t&&(e=t.slice()),e[r]=n.copy(n.from,a.from),Q9(e,i,n.copy(a.from,n.to)));break}}}return e}function Q9(t,e,r){for(;e<t.length&&Mu(r,t[e])>0;)e++;t.splice(e,0,r)}function sS(t){let e=[];return t.someProp("decorations",r=>{let n=r(t.state);n&&n!=zn&&e.push(n)}),t.cursorWrapper&&e.push(sr.create(t.state.doc,[t.cursorWrapper.deco])),Vo.from(e)}const CJ={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},NJ=wi&&cl<=11;class EJ{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class TJ{constructor(e,r){this.view=e,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new EJ,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let i=0;i<n.length;i++)this.queue.push(n[i]);wi&&cl<=11&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():Mn&&e.composing&&n.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),NJ&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,CJ)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let r=0;r<e.length;r++)this.queue.push(e[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(U9(this.view)){if(this.suppressingSelectionUpdates)return qs(this.view);if(wi&&cl<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Wu(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let r=new Set,n;for(let a=e.focusNode;a;a=Fd(a))r.add(a);for(let a=e.anchorNode;a;a=Fd(a))if(r.has(a)){n=a;break}let i=n&&this.view.docView.nearestDesc(n);if(i&&i.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&U9(e)&&!this.ignoreSelectionChange(n),a=-1,s=-1,o=!1,l=[];if(e.editable)for(let c=0;c<r.length;c++){let d=this.registerMutation(r[c],l);d&&(a=a<0?d.from:Math.min(d.from,a),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(o=!0))}if(oa&&l.length){let c=l.filter(d=>d.nodeName=="BR");if(c.length==2){let[d,h]=c;d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let h of c){let m=h.parentNode;m&&m.nodeName=="LI"&&(!d||PJ(e,d)!=m)&&h.remove()}}}else if((fn||Mn)&&l.some(c=>c.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let c of l)if(c.nodeName=="BR"&&c.parentNode){let d=c.nextSibling;d&&d.nodeType==1&&d.contentEditable=="false"&&c.parentNode.removeChild(c)}}let u=null;a<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&yx(n)&&(u=E3(e))&&u.eq(ht.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,qs(e),this.currentSelection.set(n),e.scrollToSelection()):(a>-1||i)&&(a>-1&&(e.docView.markDirty(a,s),jJ(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,_J(e,l)),this.handleDOMChange(a,s,o,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||qs(e),this.currentSelection.set(n))}registerMutation(e,r){if(r.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let d=e.addedNodes[c];r.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,a=e.nextSibling;if(wi&&cl<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:d,nextSibling:h}=e.addedNodes[c];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(a=h)}let s=i&&i.parentNode==e.target?kn(i)+1:0,o=n.localPosFromDOM(e.target,s,-1),l=a&&a.parentNode==e.target?kn(a):e.target.childNodes.length,u=n.localPosFromDOM(e.target,l,1);return{from:o,to:u}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let J9=new WeakMap,Z9=!1;function jJ(t){if(!J9.has(t)&&(J9.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=oa,Z9)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Z9=!0}}function ej(t,e){let r=e.startContainer,n=e.startOffset,i=e.endContainer,a=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return Wu(s.node,s.offset,i,a)&&([r,n,i,a]=[i,a,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:a}}function MJ(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return ej(t,i)}let r;function n(i){i.preventDefault(),i.stopImmediatePropagation(),r=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0),r?ej(t,r):null}function PJ(t,e){for(let r=e.parentNode;r&&r!=t.dom;r=r.parentNode){let n=t.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function _J(t,e){var r;let{focusNode:n,focusOffset:i}=t.domSelectionRange();for(let a of e)if(((r=a.parentNode)===null||r===void 0?void 0:r.nodeName)=="TR"){let s=a.nextSibling;for(;s&&s.nodeName!="TD"&&s.nodeName!="TH";)s=s.nextSibling;if(s){let o=s;for(;;){let l=o.firstChild;if(!l||l.nodeType!=1||l.contentEditable=="false"||/^(BR|IMG)$/.test(l.nodeName))break;o=l}o.insertBefore(a,o.firstChild),n==a&&t.domSelection().collapse(a,i)}else a.parentNode.removeChild(a)}}function AJ(t,e,r){let{node:n,fromOffset:i,toOffset:a,from:s,to:o}=t.docView.parseRange(e,r),l=t.domSelectionRange(),u,c=l.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:l.anchorOffset}],yx(l)||u.push({node:l.focusNode,offset:l.focusOffset})),fn&&t.input.lastKeyCode===8)for(let y=a;y>i;y--){let b=n.childNodes[y-1],S=b.pmViewDesc;if(b.nodeName=="BR"&&!S){a=y;break}if(!S||S.size)break}let d=t.state.doc,h=t.someProp("domParser")||ul.fromSchema(t.state.schema),m=d.resolve(s),v=null,x=h.parse(n,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:i,to:a,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:RJ,context:m});if(u&&u[0].pos!=null){let y=u[0].pos,b=u[1]&&u[1].pos;b==null&&(b=y),v={anchor:y+s,head:b+s}}return{doc:x,sel:v,from:s,to:o}}function RJ(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Mn&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(t.parentNode.lastChild==t||Mn&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const DJ=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function OJ(t,e,r,n,i){let a=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let j=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,M=E3(t,j);if(M&&!t.state.selection.eq(M)){if(fn&&Gs&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",P=>P(t,pu(13,"Enter"))))return;let A=t.state.tr.setSelection(M);j=="pointer"?A.setMeta("pointer",!0):j=="key"&&A.scrollIntoView(),a&&A.setMeta("composition",a),t.dispatch(A)}return}let s=t.state.doc.resolve(e),o=s.sharedDepth(r);e=s.before(o+1),r=t.state.doc.resolve(r).after(o+1);let l=t.state.selection,u=AJ(t,e,r),c=t.state.doc,d=c.slice(u.from,u.to),h,m;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(h=t.state.selection.to,m="end"):(h=t.state.selection.from,m="start"),t.input.lastKeyCode=null;let v=BJ(d.content,u.doc.content,u.from,h,m);if(v&&t.input.domChangeCount++,(zd&&t.input.lastIOSEnter>Date.now()-225||Gs)&&i.some(j=>j.nodeType==1&&!DJ.test(j.nodeName))&&(!v||v.endA>=v.endB)&&t.someProp("handleKeyDown",j=>j(t,pu(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!v)if(n&&l instanceof at&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))v={start:l.from,endA:l.to,endB:l.to};else{if(u.sel){let j=tj(t,t.state.doc,u.sel);if(j&&!j.eq(t.state.selection)){let M=t.state.tr.setSelection(j);a&&M.setMeta("composition",a),t.dispatch(M)}}return}t.state.selection.from<t.state.selection.to&&v.start==v.endB&&t.state.selection instanceof at&&(v.start>t.state.selection.from&&v.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?v.start=t.state.selection.from:v.endA<t.state.selection.to&&v.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(v.endB+=t.state.selection.to-v.endA,v.endA=t.state.selection.to)),wi&&cl<=11&&v.endB==v.start+1&&v.endA==v.start&&v.start>u.from&&u.doc.textBetween(v.start-u.from-1,v.start-u.from+1)==" "&&(v.start--,v.endA--,v.endB--);let x=u.doc.resolveNoCache(v.start-u.from),y=u.doc.resolveNoCache(v.endB-u.from),b=c.resolve(v.start),S=x.sameParent(y)&&x.parent.inlineContent&&b.end()>=v.endA;if((zd&&t.input.lastIOSEnter>Date.now()-225&&(!S||i.some(j=>j.nodeName=="DIV"||j.nodeName=="P"))||!S&&x.pos<u.doc.content.size&&(!x.sameParent(y)||!x.parent.inlineContent)&&x.pos<y.pos&&!/\S/.test(u.doc.textBetween(x.pos,y.pos,"","")))&&t.someProp("handleKeyDown",j=>j(t,pu(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>v.start&&LJ(c,v.start,v.endA,x,y)&&t.someProp("handleKeyDown",j=>j(t,pu(8,"Backspace")))){Gs&&fn&&t.domObserver.suppressSelectionUpdates();return}fn&&v.endB==v.start&&(t.input.lastChromeDelete=Date.now()),Gs&&!S&&x.start()!=y.start()&&y.parentOffset==0&&x.depth==y.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==v.endA&&(v.endB-=2,y=u.doc.resolveNoCache(v.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(j){return j(t,pu(13,"Enter"))})},20));let w=v.start,k=v.endA,N=j=>{let M=j||t.state.tr.replace(w,k,u.doc.slice(v.start-u.from,v.endB-u.from));if(u.sel){let A=tj(t,M.doc,u.sel);A&&!(fn&&t.composing&&A.empty&&(v.start!=v.endB||t.input.lastChromeDelete<Date.now()-100)&&(A.head==w||A.head==M.mapping.map(k)-1)||wi&&A.empty&&A.head==w)&&M.setSelection(A)}return a&&M.setMeta("composition",a),M.scrollIntoView()},T;if(S)if(x.pos==y.pos){wi&&cl<=11&&x.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>qs(t),20));let j=N(t.state.tr.delete(w,k)),M=c.resolve(v.start).marksAcross(c.resolve(v.endA));M&&j.ensureMarks(M),t.dispatch(j)}else if(v.endA==v.endB&&(T=IJ(x.parent.content.cut(x.parentOffset,y.parentOffset),b.parent.content.cut(b.parentOffset,v.endA-b.start())))){let j=N(t.state.tr);T.type=="add"?j.addMark(w,k,T.mark):j.removeMark(w,k,T.mark),t.dispatch(j)}else if(x.parent.child(x.index()).isText&&x.index()==y.index()-(y.textOffset?0:1)){let j=x.parent.textBetween(x.parentOffset,y.parentOffset),M=()=>N(t.state.tr.insertText(j,w,k));t.someProp("handleTextInput",A=>A(t,w,k,j,M))||t.dispatch(M())}else t.dispatch(N());else t.dispatch(N())}function tj(t,e,r){return Math.max(r.anchor,r.head)>e.content.size?null:T3(t,e.resolve(r.anchor),e.resolve(r.head))}function IJ(t,e){let r=t.firstChild.marks,n=e.firstChild.marks,i=r,a=n,s,o,l;for(let c=0;c<n.length;c++)i=n[c].removeFromSet(i);for(let c=0;c<r.length;c++)a=r[c].removeFromSet(a);if(i.length==1&&a.length==0)o=i[0],s="add",l=c=>c.mark(o.addToSet(c.marks));else if(i.length==0&&a.length==1)o=a[0],s="remove",l=c=>c.mark(o.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(l(e.child(c)));if(be.from(u).eq(t))return{mark:o,type:s}}function LJ(t,e,r,n,i){if(r-e<=i.pos-n.pos||oS(n,!0,!1)<i.pos)return!1;let a=t.resolve(e);if(!n.parent.isTextblock){let o=a.nodeAfter;return o!=null&&r==e+o.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let s=t.resolve(oS(a,!0,!0));return!s.parent.isTextblock||s.pos>r||oS(s,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(s.parent.content)}function oS(t,e,r){let n=t.depth,i=e?t.end():t.pos;for(;n>0&&(e||t.indexAfter(n)==t.node(n).childCount);)n--,i++,e=!1;if(r){let a=t.node(n).maybeChild(t.indexAfter(n));for(;a&&!a.isLeaf;)a=a.firstChild,i++}return i}function BJ(t,e,r,n,i){let a=t.findDiffStart(e,r);if(a==null)return null;let{a:s,b:o}=t.findDiffEnd(e,r+t.size,r+e.size);if(i=="end"){let l=Math.max(0,a-Math.min(s,o));n-=s+l-a}if(s<a&&t.size<e.size){let l=n<=a&&n>=s?a-n:0;a-=l,a&&a<e.size&&rj(e.textBetween(a-1,a+1))&&(a+=l?1:-1),o=a+(o-s),s=a}else if(o<a){let l=n<=a&&n>=o?a-n:0;a-=l,a&&a<t.size&&rj(t.textBetween(a-1,a+1))&&(a+=l?1:-1),s=a+(s-o),o=a}return{start:a,endA:s,endB:o}}function rj(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),r=t.charCodeAt(1);return e>=56320&&e<=57343&&r>=55296&&r<=56319}class GD{constructor(e,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new eJ,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach(oj),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=aj(this),ij(this),this.nodeViews=sj(this),this.docView=L9(this.state.doc,nj(this),sS(this),this.dom,this),this.domObserver=new TJ(this,(n,i,a,s)=>OJ(this,n,i,a,s)),this.domObserver.start(),tJ(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let r in e)this._props[r]=e[r];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&vk(this);let r=this._props;this._props=e,e.plugins&&(e.plugins.forEach(oj),this.directPlugins=e.plugins),this.updateStateInner(e.state,r)}setProps(e){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in e)r[n]=e[n];this.update(r)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,r){var n;let i=this.state,a=!1,s=!1;e.storedMarks&&this.composing&&(LD(this),s=!0),this.state=e;let o=i.plugins!=e.plugins||this._props.plugins!=r.plugins;if(o||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let m=sj(this);zJ(m,this.nodeViews)&&(this.nodeViews=m,a=!0)}(o||r.handleDOMEvents!=this._props.handleDOMEvents)&&vk(this),this.editable=aj(this),ij(this);let l=sS(this),u=nj(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=a||!this.docView.matchesNode(e.doc,u,l);(d||!e.selection.eq(i.selection))&&(s=!0);let h=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&mQ(this);if(s){this.domObserver.stop();let m=d&&(wi||fn)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&FJ(i.selection,e.selection);if(d){let v=fn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=mJ(this)),(a||!this.docView.update(e.doc,u,l,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=L9(e.doc,u,l,this.dom,this)),v&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&FQ(this))?qs(this,m):(ND(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((n=this.dragging)===null||n===void 0)&&n.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():h&&gQ(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof Ye){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&_9(this,r.getBoundingClientRect(),e)}else _9(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,e)}}updateDraggedNode(e,r){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let a=n.from+(this.state.doc.content.size-r.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==n.node&&(i=a)}this.dragging=new FD(e.slice,e.move,i<0?void 0:Ye.create(this.state.doc,i))}someProp(e,r){let n=this._props&&this._props[e],i;if(n!=null&&(i=r?r(n):n))return i;for(let s=0;s<this.directPlugins.length;s++){let o=this.directPlugins[s].props[e];if(o!=null&&(i=r?r(o):o))return i}let a=this.state.plugins;if(a)for(let s=0;s<a.length;s++){let o=a[s].props[e];if(o!=null&&(i=r?r(o):o))return i}}hasFocus(){if(wi){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&vQ(this.dom),qs(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return e||document}updateRoot(){this._root=null}posAtCoords(e){return SQ(this,e)}coordsAtPos(e,r=1){return vD(this,e,r)}domAtPos(e,r=0){return this.docView.domFromPos(e,r)}nodeDOM(e){let r=this.docView.descAt(e);return r?r.nodeDOM:null}posAtDOM(e,r,n=-1){let i=this.docView.posFromDOM(e,r,n);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,r){return TQ(this,r||this.state,e)}pasteHTML(e,r){return Ap(this,"",e,!1,r||new ClipboardEvent("paste"))}pasteText(e,r){return Ap(this,e,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(e){return j3(this,e)}destroy(){this.docView&&(rJ(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],sS(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,aQ())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return iJ(this,e)}domSelectionRange(){let e=this.domSelection();return e?Mn&&this.root.nodeType===11&&cQ(this.dom.ownerDocument)==this.dom&&MJ(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}GD.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function nj(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(t.state)),r)for(let n in r)n=="class"?e.class+=" "+r[n]:n=="style"?e.style=(e.style?e.style+";":"")+r[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(r[n]))}),e.translate||(e.translate="no"),[$n.node(0,t.state.doc.content.size,e)]}function ij(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:$n.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function aj(t){return!t.someProp("editable",e=>e(t.state)===!1)}function FJ(t,e){let r=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(r)!=e.$anchor.start(r)}function sj(t){let e=Object.create(null);function r(n){for(let i in n)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n[i])}return t.someProp("nodeViews",r),t.someProp("markViews",r),e}function zJ(t,e){let r=0,n=0;for(let i in t){if(t[i]!=e[i])return!0;r++}for(let i in e)n++;return r!=n}function oj(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var wl={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},G0={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},VJ=typeof navigator<"u"&&/Mac/.test(navigator.platform),$J=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Cn=0;Cn<10;Cn++)wl[48+Cn]=wl[96+Cn]=String(Cn);for(var Cn=1;Cn<=24;Cn++)wl[Cn+111]="F"+Cn;for(var Cn=65;Cn<=90;Cn++)wl[Cn]=String.fromCharCode(Cn+32),G0[Cn]=String.fromCharCode(Cn);for(var lS in wl)G0.hasOwnProperty(lS)||(G0[lS]=wl[lS]);function UJ(t){var e=VJ&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||$J&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?G0:wl)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const GJ=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),HJ=typeof navigator<"u"&&/Win/.test(navigator.platform);function WJ(t){let e=t.split(/-(?!$)/),r=e[e.length-1];r=="Space"&&(r=" ");let n,i,a,s;for(let o=0;o<e.length-1;o++){let l=e[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))GJ?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(r="Alt-"+r),i&&(r="Ctrl-"+r),s&&(r="Meta-"+r),a&&(r="Shift-"+r),r}function qJ(t){let e=Object.create(null);for(let r in t)e[WJ(r)]=t[r];return e}function uS(t,e,r=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r&&e.shiftKey&&(t="Shift-"+t),t}function KJ(t){return new cr({props:{handleKeyDown:HD(t)}})}function HD(t){let e=qJ(t);return function(r,n){let i=UJ(n),a,s=e[uS(i,n)];if(s&&s(r.state,r.dispatch,r))return!0;if(i.length==1&&i!=" "){if(n.shiftKey){let o=e[uS(i,n,!1)];if(o&&o(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(HJ&&n.ctrlKey&&n.altKey)&&(a=wl[n.keyCode])&&a!=i){let o=e[uS(a,n)];if(o&&o(r.state,r.dispatch,r))return!0}}return!1}}var YJ=Object.defineProperty,D3=(t,e)=>{for(var r in e)YJ(t,r,{get:e[r],enumerable:!0})};function wx(t){const{state:e,transaction:r}=t;let{selection:n}=r,{doc:i}=r,{storedMarks:a}=r;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return n},get doc(){return i},get tr(){return n=r.selection,i=r.doc,a=r.storedMarks,r}}}var Sx=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:r}=this,{view:n}=e,{tr:i}=r,a=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([s,o])=>[s,(...u)=>{const c=o(...u)(a);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(i),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:r,editor:n,state:i}=this,{view:a}=n,s=[],o=!!t,l=t||i.tr,u=()=>(!o&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(l),s.every(d=>d===!0)),c={...Object.fromEntries(Object.entries(r).map(([d,h])=>[d,(...v)=>{const x=this.buildProps(l,e),y=h(...v)(x);return s.push(y),c}])),run:u};return c}createCan(t){const{rawCommands:e,state:r}=this,n=!1,i=t||r.tr,a=this.buildProps(i,n);return{...Object.fromEntries(Object.entries(e).map(([o,l])=>[o,(...u)=>l(...u)({...a,dispatch:void 0})])),chain:()=>this.createChain(i,n)}}buildProps(t,e=!0){const{rawCommands:r,editor:n,state:i}=this,{view:a}=n,s={tr:t,editor:n,view:a,state:wx({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([o,l])=>[o,(...u)=>l(...u)(s)]))}};return s}},WD={};D3(WD,{blur:()=>XJ,clearContent:()=>QJ,clearNodes:()=>JJ,command:()=>ZJ,createParagraphNear:()=>eZ,cut:()=>tZ,deleteCurrentNode:()=>rZ,deleteNode:()=>nZ,deleteRange:()=>iZ,deleteSelection:()=>aZ,enter:()=>sZ,exitCode:()=>oZ,extendMarkRange:()=>lZ,first:()=>uZ,focus:()=>dZ,forEach:()=>fZ,insertContent:()=>hZ,insertContentAt:()=>gZ,joinBackward:()=>xZ,joinDown:()=>yZ,joinForward:()=>bZ,joinItemBackward:()=>wZ,joinItemForward:()=>SZ,joinTextblockBackward:()=>kZ,joinTextblockForward:()=>CZ,joinUp:()=>vZ,keyboardShortcut:()=>EZ,lift:()=>TZ,liftEmptyBlock:()=>jZ,liftListItem:()=>MZ,newlineInCode:()=>PZ,resetAttributes:()=>_Z,scrollIntoView:()=>AZ,selectAll:()=>RZ,selectNodeBackward:()=>DZ,selectNodeForward:()=>OZ,selectParentNode:()=>IZ,selectTextblockEnd:()=>LZ,selectTextblockStart:()=>BZ,setContent:()=>FZ,setMark:()=>aee,setMeta:()=>see,setNode:()=>oee,setNodeSelection:()=>lee,setTextDirection:()=>uee,setTextSelection:()=>cee,sinkListItem:()=>dee,splitBlock:()=>fee,splitListItem:()=>hee,toggleList:()=>pee,toggleMark:()=>mee,toggleNode:()=>gee,toggleWrap:()=>vee,undoInputRule:()=>yee,unsetAllMarks:()=>xee,unsetMark:()=>bee,unsetTextDirection:()=>wee,updateAttributes:()=>See,wrapIn:()=>kee,wrapInList:()=>Cee});var XJ=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var r;t.isDestroyed||(e.dom.blur(),(r=window==null?void 0:window.getSelection())==null||r.removeAllRanges())}),!0),QJ=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),JJ=()=>({state:t,tr:e,dispatch:r})=>{const{selection:n}=e,{ranges:i}=n;return r&&i.forEach(({$from:a,$to:s})=>{t.doc.nodesBetween(a.pos,s.pos,(o,l)=>{if(o.type.isText)return;const{doc:u,mapping:c}=e,d=u.resolve(c.map(l)),h=u.resolve(c.map(l+o.nodeSize)),m=d.blockRange(h);if(!m)return;const v=uf(m);if(o.type.isTextblock){const{defaultType:x}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(m.start,x)}(v||v===0)&&e.lift(m,v)})}),!0},ZJ=t=>e=>t(e),eZ=()=>({state:t,dispatch:e})=>HX(t,e),tZ=(t,e)=>({editor:r,tr:n})=>{const{state:i}=r,a=i.doc.slice(t.from,t.to);n.deleteRange(t.from,t.to);const s=n.mapping.map(e);return n.insert(s,a.content),n.setSelection(new at(n.doc.resolve(Math.max(s-1,0)))),!0},rZ=()=>({tr:t,dispatch:e})=>{const{selection:r}=t,n=r.$anchor.node();if(n.content.size>0)return!1;const i=t.selection.$anchor;for(let a=i.depth;a>0;a-=1)if(i.node(a).type===n.type){if(e){const o=i.before(a),l=i.after(a);t.delete(o,l).scrollIntoView()}return!0}return!1};function Ur(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var nZ=t=>({tr:e,state:r,dispatch:n})=>{const i=Ur(t,r.schema),a=e.selection.$anchor;for(let s=a.depth;s>0;s-=1)if(a.node(s).type===i){if(n){const l=a.before(s),u=a.after(s);e.delete(l,u).scrollIntoView()}return!0}return!1},iZ=t=>({tr:e,dispatch:r})=>{const{from:n,to:i}=t;return r&&e.delete(n,i),!0},aZ=()=>({state:t,dispatch:e})=>RX(t,e),sZ=()=>({commands:t})=>t.keyboardShortcut("Enter"),oZ=()=>({state:t,dispatch:e})=>GX(t,e);function O3(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function H0(t,e,r={strict:!0}){const n=Object.keys(e);return n.length?n.every(i=>r.strict?e[i]===t[i]:O3(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function qD(t,e,r={}){return t.find(n=>n.type===e&&H0(Object.fromEntries(Object.keys(r).map(i=>[i,n.attrs[i]])),r))}function lj(t,e,r={}){return!!qD(t,e,r)}function I3(t,e,r){var n;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(c=>c.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(c=>c.type===e)||(r=r||((n=i.node.marks[0])==null?void 0:n.attrs),!qD([...i.node.marks],e,r)))return;let s=i.index,o=t.start()+i.offset,l=s+1,u=o+i.node.nodeSize;for(;s>0&&lj([...t.parent.child(s-1).marks],e,r);)s-=1,o-=t.parent.child(s).nodeSize;for(;l<t.parent.childCount&&lj([...t.parent.child(l).marks],e,r);)u+=t.parent.child(l).nodeSize,l+=1;return{from:o,to:u}}function oo(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var lZ=(t,e={})=>({tr:r,state:n,dispatch:i})=>{const a=oo(t,n.schema),{doc:s,selection:o}=r,{$from:l,from:u,to:c}=o;if(i){const d=I3(l,a,e);if(d&&d.from<=u&&d.to>=c){const h=at.create(s,d.from,d.to);r.setSelection(h)}}return!0},uZ=t=>e=>{const r=typeof t=="function"?t(e):t;for(let n=0;n<r.length;n+=1)if(r[n](e))return!0;return!1};function KD(t){return t instanceof at}function wu(t=0,e=0,r=0){return Math.min(Math.max(t,e),r)}function YD(t,e=null){if(!e)return null;const r=ht.atStart(t),n=ht.atEnd(t);if(e==="start"||e===!0)return r;if(e==="end")return n;const i=r.from,a=n.to;return e==="all"?at.create(t,wu(0,i,a),wu(t.content.size,i,a)):at.create(t,wu(e,i,a),wu(e,i,a))}function uj(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function W0(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function cZ(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var dZ=(t=null,e={})=>({editor:r,view:n,tr:i,dispatch:a})=>{e={scrollIntoView:!0,...e};const s=()=>{(W0()||uj())&&n.dom.focus(),cZ()&&!W0()&&!uj()&&n.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{r.isDestroyed||(n.focus(),e!=null&&e.scrollIntoView&&r.commands.scrollIntoView())})};if(n.hasFocus()&&t===null||t===!1)return!0;if(a&&t===null&&!KD(r.state.selection))return s(),!0;const o=YD(i.doc,t)||r.state.selection,l=r.state.selection.eq(o);return a&&(l||i.setSelection(o),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},fZ=(t,e)=>r=>t.every((n,i)=>e(n,{...r,index:i})),hZ=(t,e)=>({tr:r,commands:n})=>n.insertContentAt({from:r.selection.from,to:r.selection.to},t,e),XD=t=>{const e=t.childNodes;for(let r=e.length-1;r>=0;r-=1){const n=e[r];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?t.removeChild(n):n.nodeType===1&&XD(n)}return t};function Qg(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,r=new window.DOMParser().parseFromString(e,"text/html").body;return XD(r)}function Dp(t,e,r){if(t instanceof Ws||t instanceof be)return t;r={slice:!0,parseOptions:{},...r};const n=typeof t=="object"&&t!==null,i=typeof t=="string";if(n)try{if(Array.isArray(t)&&t.length>0)return be.fromArray(t.map(o=>e.nodeFromJSON(o)));const s=e.nodeFromJSON(t);return r.errorOnInvalidContent&&s.check(),s}catch(a){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",a),Dp("",e,r)}if(i){if(r.errorOnInvalidContent){let s=!1,o="";const l=new F7({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(s=!0,o=typeof u=="string"?u:u.outerHTML,null)}]}})});if(r.slice?ul.fromSchema(l).parseSlice(Qg(t),r.parseOptions):ul.fromSchema(l).parse(Qg(t),r.parseOptions),r.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const a=ul.fromSchema(e);return r.slice?a.parseSlice(Qg(t),r.parseOptions).content:a.parse(Qg(t),r.parseOptions)}return Dp("",e,r)}function pZ(t,e,r){const n=t.steps.length-1;if(n<e)return;const i=t.steps[n];if(!(i instanceof dn||i instanceof mn))return;const a=t.mapping.maps[n];let s=0;a.forEach((o,l,u,c)=>{s===0&&(s=c)}),t.setSelection(ht.near(t.doc.resolve(s),r))}var mZ=t=>!("type"in t),gZ=(t,e,r)=>({tr:n,dispatch:i,editor:a})=>{var s;if(i){r={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let o;const l=y=>{a.emit("contentError",{editor:a,error:y,disableCollaboration:()=>{"collaboration"in a.storage&&typeof a.storage.collaboration=="object"&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{Dp(e,a.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(y){l(y)}try{o=Dp(e,a.schema,{parseOptions:u,errorOnInvalidContent:(s=r.errorOnInvalidContent)!=null?s:a.options.enableContentCheck})}catch(y){return l(y),!1}let{from:c,to:d}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},h=!0,m=!0;if((mZ(o)?o:[o]).forEach(y=>{y.check(),h=h?y.isText&&y.marks.length===0:!1,m=m?y.isBlock:!1}),c===d&&m){const{parent:y}=n.doc.resolve(c);y.isTextblock&&!y.type.spec.code&&!y.childCount&&(c-=1,d+=1)}let x;if(h){if(Array.isArray(e))x=e.map(y=>y.text||"").join("");else if(e instanceof be){let y="";e.forEach(b=>{b.text&&(y+=b.text)}),x=y}else typeof e=="object"&&e&&e.text?x=e.text:x=e;n.insertText(x,c,d)}else{x=o;const y=n.doc.resolve(c),b=y.node(),S=y.parentOffset===0,w=b.isText||b.isTextblock,k=b.content.size>0;S&&w&&k&&(c=Math.max(0,c-1)),n.replaceWith(c,d,x)}r.updateSelection&&pZ(n,n.steps.length-1,-1),r.applyInputRules&&n.setMeta("applyInputRules",{from:c,text:x}),r.applyPasteRules&&n.setMeta("applyPasteRules",{from:c,text:x})}return!0},vZ=()=>({state:t,dispatch:e})=>zX(t,e),yZ=()=>({state:t,dispatch:e})=>VX(t,e),xZ=()=>({state:t,dispatch:e})=>DX(t,e),bZ=()=>({state:t,dispatch:e})=>BX(t,e),wZ=()=>({state:t,dispatch:e,tr:r})=>{try{const n=mx(t.doc,t.selection.$from.pos,-1);return n==null?!1:(r.join(n,2),e&&e(r),!0)}catch{return!1}},SZ=()=>({state:t,dispatch:e,tr:r})=>{try{const n=mx(t.doc,t.selection.$from.pos,1);return n==null?!1:(r.join(n,2),e&&e(r),!0)}catch{return!1}},kZ=()=>({state:t,dispatch:e})=>OX(t,e),CZ=()=>({state:t,dispatch:e})=>IX(t,e);function QD(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function NZ(t){const e=t.split(/-(?!$)/);let r=e[e.length-1];r==="Space"&&(r=" ");let n,i,a,s;for(let o=0;o<e.length-1;o+=1){const l=e[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))W0()||QD()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(r=`Alt-${r}`),i&&(r=`Ctrl-${r}`),s&&(r=`Meta-${r}`),a&&(r=`Shift-${r}`),r}var EZ=t=>({editor:e,view:r,tr:n,dispatch:i})=>{const a=NZ(t).split(/-(?!$)/),s=a.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),o=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{r.someProp("handleKeyDown",u=>u(r,o))});return l==null||l.steps.forEach(u=>{const c=u.map(n.mapping);c&&i&&n.maybeStep(c)}),!0};function Sl(t,e,r={}){const{from:n,to:i,empty:a}=t.selection,s=e?Ur(e,t.schema):null,o=[];t.doc.nodesBetween(n,i,(d,h)=>{if(d.isText)return;const m=Math.max(n,h),v=Math.min(i,h+d.nodeSize);o.push({node:d,from:m,to:v})});const l=i-n,u=o.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>H0(d.node.attrs,r,{strict:!1}));return a?!!u.length:u.reduce((d,h)=>d+h.to-h.from,0)>=l}var TZ=(t,e={})=>({state:r,dispatch:n})=>{const i=Ur(t,r.schema);return Sl(r,i,e)?$X(r,n):!1},jZ=()=>({state:t,dispatch:e})=>WX(t,e),MZ=t=>({state:e,dispatch:r})=>{const n=Ur(t,e.schema);return tQ(n)(e,r)},PZ=()=>({state:t,dispatch:e})=>UX(t,e);function kx(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function cj(t,e){const r=typeof e=="string"?[e]:e;return Object.keys(t).reduce((n,i)=>(r.includes(i)||(n[i]=t[i]),n),{})}var _Z=(t,e)=>({tr:r,state:n,dispatch:i})=>{let a=null,s=null;const o=kx(typeof t=="string"?t:t.name,n.schema);if(!o)return!1;o==="node"&&(a=Ur(t,n.schema)),o==="mark"&&(s=oo(t,n.schema));let l=!1;return r.selection.ranges.forEach(u=>{n.doc.nodesBetween(u.$from.pos,u.$to.pos,(c,d)=>{a&&a===c.type&&(l=!0,i&&r.setNodeMarkup(d,void 0,cj(c.attrs,e))),s&&c.marks.length&&c.marks.forEach(h=>{s===h.type&&(l=!0,i&&r.addMark(d,d+c.nodeSize,s.create(cj(h.attrs,e))))})})}),l},AZ=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),RZ=()=>({tr:t,dispatch:e})=>{if(e){const r=new sa(t.doc);t.setSelection(r)}return!0},DZ=()=>({state:t,dispatch:e})=>LX(t,e),OZ=()=>({state:t,dispatch:e})=>FX(t,e),IZ=()=>({state:t,dispatch:e})=>qX(t,e),LZ=()=>({state:t,dispatch:e})=>XX(t,e),BZ=()=>({state:t,dispatch:e})=>YX(t,e);function yk(t,e,r={},n={}){return Dp(t,e,{slice:!1,parseOptions:r,errorOnInvalidContent:n.errorOnInvalidContent})}var FZ=(t,{errorOnInvalidContent:e,emitUpdate:r=!0,parseOptions:n={}}={})=>({editor:i,tr:a,dispatch:s,commands:o})=>{const{doc:l}=a;if(n.preserveWhitespace!=="full"){const u=yk(t,i.schema,n,{errorOnInvalidContent:e??i.options.enableContentCheck});return s&&a.replaceWith(0,l.content.size,u).setMeta("preventUpdate",!r),!0}return s&&a.setMeta("preventUpdate",!r),o.insertContentAt({from:0,to:l.content.size},t,{parseOptions:n,errorOnInvalidContent:e??i.options.enableContentCheck})};function JD(t,e){const r=oo(e,t.schema),{from:n,to:i,empty:a}=t.selection,s=[];a?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(n,i,l=>{s.push(...l.marks)});const o=s.find(l=>l.type.name===r.name);return o?{...o.attrs}:{}}function ZD(t,e){const r=new tD(t);return e.forEach(n=>{n.steps.forEach(i=>{r.step(i)})}),r}function zZ(t){for(let e=0;e<t.edgeCount;e+=1){const{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function VZ(t,e,r){const n=[];return t.nodesBetween(e.from,e.to,(i,a)=>{r(i)&&n.push({node:i,pos:a})}),n}function $Z(t,e){for(let r=t.depth;r>0;r-=1){const n=t.node(r);if(e(n))return{pos:r>0?t.before(r):0,start:t.start(r),depth:r,node:n}}}function Cx(t){return e=>$Z(e.$from,t)}function qe(t,e,r){return t.config[e]===void 0&&t.parent?qe(t.parent,e,r):typeof t.config[e]=="function"?t.config[e].bind({...r,parent:t.parent?qe(t.parent,e,r):null}):t.config[e]}function L3(t){return t.map(e=>{const r={name:e.name,options:e.options,storage:e.storage},n=qe(e,"addExtensions",r);return n?[e,...L3(n())]:e}).flat(10)}function B3(t,e){const r=tc.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(r),i.innerHTML}function eO(t){return typeof t=="function"}function Bt(t,e=void 0,...r){return eO(t)?e?t.bind(e)(...r):t(...r):t}function UZ(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Vd(t){const e=t.filter(i=>i.type==="extension"),r=t.filter(i=>i.type==="node"),n=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:r,markExtensions:n}}function tO(t){const e=[],{nodeExtensions:r,markExtensions:n}=Vd(t),i=[...r,...n],a={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage,extensions:i},l=qe(s,"addGlobalAttributes",o);if(!l)return;l().forEach(c=>{c.types.forEach(d=>{Object.entries(c.attributes).forEach(([h,m])=>{e.push({type:d,name:h,attribute:{...a,...m}})})})})}),i.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage},l=qe(s,"addAttributes",o);if(!l)return;const u=l();Object.entries(u).forEach(([c,d])=>{const h={...a,...d};typeof(h==null?void 0:h.default)=="function"&&(h.default=h.default()),h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete h.default,e.push({type:s.name,name:c,attribute:h})})}),e}function ur(...t){return t.filter(e=>!!e).reduce((e,r)=>{const n={...e};return Object.entries(r).forEach(([i,a])=>{if(!n[i]){n[i]=a;return}if(i==="class"){const o=a?String(a).split(" "):[],l=n[i]?n[i].split(" "):[],u=o.filter(c=>!l.includes(c));n[i]=[...l,...u].join(" ")}else if(i==="style"){const o=a?a.split(";").map(c=>c.trim()).filter(Boolean):[],l=n[i]?n[i].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;l.forEach(c=>{const[d,h]=c.split(":").map(m=>m.trim());u.set(d,h)}),o.forEach(c=>{const[d,h]=c.split(":").map(m=>m.trim());u.set(d,h)}),n[i]=Array.from(u.entries()).map(([c,d])=>`${c}: ${d}`).join("; ")}else n[i]=a}),n},{})}function Op(t,e){return e.filter(r=>r.type===t.type.name).filter(r=>r.attribute.rendered).map(r=>r.attribute.renderHTML?r.attribute.renderHTML(t.attrs)||{}:{[r.name]:t.attrs[r.name]}).reduce((r,n)=>ur(r,n),{})}function GZ(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function dj(t,e){return"style"in t?t:{...t,getAttrs:r=>{const n=t.getAttrs?t.getAttrs(r):t.attrs;if(n===!1)return!1;const i=e.reduce((a,s)=>{const o=s.attribute.parseHTML?s.attribute.parseHTML(r):GZ(r.getAttribute(s.name));return o==null?a:{...a,[s.name]:o}},{});return{...n,...i}}}}function fj(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>e==="attrs"&&UZ(r)?!1:r!=null))}function hj(t){var e,r;const n={};return!((e=t==null?void 0:t.attribute)!=null&&e.isRequired)&&"default"in((t==null?void 0:t.attribute)||{})&&(n.default=t.attribute.default),((r=t==null?void 0:t.attribute)==null?void 0:r.validate)!==void 0&&(n.validate=t.attribute.validate),[t.name,n]}function HZ(t,e){var r;const n=tO(t),{nodeExtensions:i,markExtensions:a}=Vd(t),s=(r=i.find(u=>qe(u,"topNode")))==null?void 0:r.name,o=Object.fromEntries(i.map(u=>{const c=n.filter(b=>b.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:e},h=t.reduce((b,S)=>{const w=qe(S,"extendNodeSchema",d);return{...b,...w?w(u):{}}},{}),m=fj({...h,content:Bt(qe(u,"content",d)),marks:Bt(qe(u,"marks",d)),group:Bt(qe(u,"group",d)),inline:Bt(qe(u,"inline",d)),atom:Bt(qe(u,"atom",d)),selectable:Bt(qe(u,"selectable",d)),draggable:Bt(qe(u,"draggable",d)),code:Bt(qe(u,"code",d)),whitespace:Bt(qe(u,"whitespace",d)),linebreakReplacement:Bt(qe(u,"linebreakReplacement",d)),defining:Bt(qe(u,"defining",d)),isolating:Bt(qe(u,"isolating",d)),attrs:Object.fromEntries(c.map(hj))}),v=Bt(qe(u,"parseHTML",d));v&&(m.parseDOM=v.map(b=>dj(b,c)));const x=qe(u,"renderHTML",d);x&&(m.toDOM=b=>x({node:b,HTMLAttributes:Op(b,c)}));const y=qe(u,"renderText",d);return y&&(m.toText=y),[u.name,m]})),l=Object.fromEntries(a.map(u=>{const c=n.filter(y=>y.type===u.name),d={name:u.name,options:u.options,storage:u.storage,editor:e},h=t.reduce((y,b)=>{const S=qe(b,"extendMarkSchema",d);return{...y,...S?S(u):{}}},{}),m=fj({...h,inclusive:Bt(qe(u,"inclusive",d)),excludes:Bt(qe(u,"excludes",d)),group:Bt(qe(u,"group",d)),spanning:Bt(qe(u,"spanning",d)),code:Bt(qe(u,"code",d)),attrs:Object.fromEntries(c.map(hj))}),v=Bt(qe(u,"parseHTML",d));v&&(m.parseDOM=v.map(y=>dj(y,c)));const x=qe(u,"renderHTML",d);return x&&(m.toDOM=y=>x({mark:y,HTMLAttributes:Op(y,c)})),[u.name,m]}));return new F7({topNode:s,nodes:o,marks:l})}function WZ(t){const e=t.filter((r,n)=>t.indexOf(r)!==n);return Array.from(new Set(e))}function q0(t){return t.sort((r,n)=>{const i=qe(r,"priority")||100,a=qe(n,"priority")||100;return i>a?-1:i<a?1:0})}function rO(t){const e=q0(L3(t)),r=WZ(e.map(n=>n.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),e}function nO(t,e,r){const{from:n,to:i}=e,{blockSeparator:a=`

`,textSerializers:s={}}=r||{};let o="";return t.nodesBetween(n,i,(l,u,c,d)=>{var h;l.isBlock&&u>n&&(o+=a);const m=s==null?void 0:s[l.type.name];if(m)return c&&(o+=m({node:l,pos:u,parent:c,index:d,range:e})),!1;l.isText&&(o+=(h=l==null?void 0:l.text)==null?void 0:h.slice(Math.max(n,u)-u,i-u))}),o}function qZ(t,e){const r={from:0,to:t.content.size};return nO(t,r,e)}function iO(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,r])=>[e,r.spec.toText]))}function KZ(t,e){const r=Ur(e,t.schema),{from:n,to:i}=t.selection,a=[];t.doc.nodesBetween(n,i,o=>{a.push(o)});const s=a.reverse().find(o=>o.type.name===r.name);return s?{...s.attrs}:{}}function aO(t,e){const r=kx(typeof e=="string"?e:e.name,t.schema);return r==="node"?KZ(t,e):r==="mark"?JD(t,e):{}}function YZ(t,e=JSON.stringify){const r={};return t.filter(n=>{const i=e(n);return Object.prototype.hasOwnProperty.call(r,i)?!1:r[i]=!0})}function XZ(t){const e=YZ(t);return e.length===1?e:e.filter((r,n)=>!e.filter((a,s)=>s!==n).some(a=>r.oldRange.from>=a.oldRange.from&&r.oldRange.to<=a.oldRange.to&&r.newRange.from>=a.newRange.from&&r.newRange.to<=a.newRange.to))}function sO(t){const{mapping:e,steps:r}=t,n=[];return e.maps.forEach((i,a)=>{const s=[];if(i.ranges.length)i.forEach((o,l)=>{s.push({from:o,to:l})});else{const{from:o,to:l}=r[a];if(o===void 0||l===void 0)return;s.push({from:o,to:l})}s.forEach(({from:o,to:l})=>{const u=e.slice(a).map(o,-1),c=e.slice(a).map(l),d=e.invert().map(u,-1),h=e.invert().map(c);n.push({oldRange:{from:d,to:h},newRange:{from:u,to:c}})})}),XZ(n)}function F3(t,e,r){const n=[];return t===e?r.resolve(t).marks().forEach(i=>{const a=r.resolve(t),s=I3(a,i.type);s&&n.push({mark:i,...s})}):r.nodesBetween(t,e,(i,a)=>{!i||(i==null?void 0:i.nodeSize)===void 0||n.push(...i.marks.map(s=>({from:a,to:a+i.nodeSize,mark:s})))}),n}var QZ=(t,e,r,n=20)=>{const i=t.doc.resolve(r);let a=n,s=null;for(;a>0&&s===null;){const o=i.node(a);(o==null?void 0:o.type.name)===e?s=o:a-=1}return[s,a]};function Jg(t,e){return e.nodes[t]||e.marks[t]||null}function Fv(t,e,r){return Object.fromEntries(Object.entries(r).filter(([n])=>{const i=t.find(a=>a.type===e&&a.name===n);return i?i.attribute.keepOnSplit:!1}))}var JZ=(t,e=500)=>{let r="";const n=t.parentOffset;return t.parent.nodesBetween(Math.max(0,n-e),n,(i,a,s,o)=>{var l,u;const c=((u=(l=i.type.spec).toText)==null?void 0:u.call(l,{node:i,pos:a,parent:s,index:o}))||i.textContent||"%leaf%";r+=i.isAtom&&!i.isText?c:c.slice(0,Math.max(0,n-a))}),r};function xk(t,e,r={}){const{empty:n,ranges:i}=t.selection,a=e?oo(e,t.schema):null;if(n)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>a?a.name===d.type.name:!0).find(d=>H0(d.attrs,r,{strict:!1}));let s=0;const o=[];if(i.forEach(({$from:d,$to:h})=>{const m=d.pos,v=h.pos;t.doc.nodesBetween(m,v,(x,y)=>{if(!x.isText&&!x.marks.length)return;const b=Math.max(m,y),S=Math.min(v,y+x.nodeSize),w=S-b;s+=w,o.push(...x.marks.map(k=>({mark:k,from:b,to:S})))})}),s===0)return!1;const l=o.filter(d=>a?a.name===d.mark.type.name:!0).filter(d=>H0(d.mark.attrs,r,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),u=o.filter(d=>a?d.mark.type!==a&&d.mark.type.excludes(a):!0).reduce((d,h)=>d+h.to-h.from,0);return(l>0?l+u:l)>=s}function ZZ(t,e,r={}){if(!e)return Sl(t,null,r)||xk(t,null,r);const n=kx(e,t.schema);return n==="node"?Sl(t,e,r):n==="mark"?xk(t,e,r):!1}var eee=(t,e)=>{const{$from:r,$to:n,$anchor:i}=t.selection;if(e){const a=Cx(o=>o.type.name===e)(t.selection);if(!a)return!1;const s=t.doc.resolve(a.pos+1);return i.pos+1===s.end()}return!(n.parentOffset<n.parent.nodeSize-2||r.pos!==n.pos)},tee=t=>{const{$from:e,$to:r}=t.selection;return!(e.parentOffset>0||e.pos!==r.pos)};function pj(t,e){return Array.isArray(e)?e.some(r=>(typeof r=="string"?r:r.name)===t.name):e}function mj(t,e){const{nodeExtensions:r}=Vd(e),n=r.find(s=>s.name===t);if(!n)return!1;const i={name:n.name,options:n.options,storage:n.storage},a=Bt(qe(n,"group",i));return typeof a!="string"?!1:a.split(" ").includes("list")}function Nx(t,{checkChildren:e=!0,ignoreWhitespace:r=!1}={}){var n;if(r){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((n=t.text)!=null?n:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(a=>{i!==!1&&(Nx(a,{ignoreWhitespace:r,checkChildren:e})||(i=!1))}),i}return!1}function oO(t){return t instanceof Ye}var lO=class uO{constructor(e){this.position=e}static fromJSON(e){return new uO(e.position)}toJSON(){return{position:this.position}}};function ree(t,e){const r=e.mapping.mapResult(t.position);return{position:new lO(r.pos),mapResult:r}}function nee(t){return new lO(t)}function iee(t,e,r){var n;const{selection:i}=e;let a=null;if(KD(i)&&(a=i.$cursor),a){const o=(n=t.storedMarks)!=null?n:a.marks();return a.parent.type.allowsMarkType(r)&&(!!r.isInSet(o)||!o.some(u=>u.type.excludes(r)))}const{ranges:s}=i;return s.some(({$from:o,$to:l})=>{let u=o.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(r):!1;return t.doc.nodesBetween(o.pos,l.pos,(c,d,h)=>{if(u)return!1;if(c.isInline){const m=!h||h.type.allowsMarkType(r),v=!!r.isInSet(c.marks)||!c.marks.some(x=>x.type.excludes(r));u=m&&v}return!u}),u})}var aee=(t,e={})=>({tr:r,state:n,dispatch:i})=>{const{selection:a}=r,{empty:s,ranges:o}=a,l=oo(t,n.schema);if(i)if(s){const u=JD(n,l);r.addStoredMark(l.create({...u,...e}))}else o.forEach(u=>{const c=u.$from.pos,d=u.$to.pos;n.doc.nodesBetween(c,d,(h,m)=>{const v=Math.max(m,c),x=Math.min(m+h.nodeSize,d);h.marks.find(b=>b.type===l)?h.marks.forEach(b=>{l===b.type&&r.addMark(v,x,l.create({...b.attrs,...e}))}):r.addMark(v,x,l.create(e))})});return iee(n,r,l)},see=(t,e)=>({tr:r})=>(r.setMeta(t,e),!0),oee=(t,e={})=>({state:r,dispatch:n,chain:i})=>{const a=Ur(t,r.schema);let s;return r.selection.$anchor.sameParent(r.selection.$head)&&(s=r.selection.$anchor.parent.attrs),a.isTextblock?i().command(({commands:o})=>j9(a,{...s,...e})(r)?!0:o.clearNodes()).command(({state:o})=>j9(a,{...s,...e})(o,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},lee=t=>({tr:e,dispatch:r})=>{if(r){const{doc:n}=e,i=wu(t,0,n.content.size),a=Ye.create(n,i);e.setSelection(a)}return!0},uee=(t,e)=>({tr:r,state:n,dispatch:i})=>{const{selection:a}=n;let s,o;return typeof e=="number"?(s=e,o=e):e&&"from"in e&&"to"in e?(s=e.from,o=e.to):(s=a.from,o=a.to),i&&r.doc.nodesBetween(s,o,(l,u)=>{l.isText||r.setNodeMarkup(u,void 0,{...l.attrs,dir:t})}),!0},cee=t=>({tr:e,dispatch:r})=>{if(r){const{doc:n}=e,{from:i,to:a}=typeof t=="number"?{from:t,to:t}:t,s=at.atStart(n).from,o=at.atEnd(n).to,l=wu(i,s,o),u=wu(a,s,o),c=at.create(n,l,u);e.setSelection(c)}return!0},dee=t=>({state:e,dispatch:r})=>{const n=Ur(t,e.schema);return iQ(n)(e,r)};function gj(t,e){const r=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(r){const n=r.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(n)}}var fee=({keepMarks:t=!0}={})=>({tr:e,state:r,dispatch:n,editor:i})=>{const{selection:a,doc:s}=e,{$from:o,$to:l}=a,u=i.extensionManager.attributes,c=Fv(u,o.node().type.name,o.node().attrs);if(a instanceof Ye&&a.node.isBlock)return!o.parentOffset||!Sd(s,o.pos)?!1:(n&&(t&&gj(r,i.extensionManager.splittableMarks),e.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,h=o.depth===0?void 0:zZ(o.node(-1).contentMatchAt(o.indexAfter(-1)));let m=d&&h?[{type:h,attrs:c}]:void 0,v=Sd(e.doc,e.mapping.map(o.pos),1,m);if(!m&&!v&&Sd(e.doc,e.mapping.map(o.pos),1,h?[{type:h}]:void 0)&&(v=!0,m=h?[{type:h,attrs:c}]:void 0),n){if(v&&(a instanceof at&&e.deleteSelection(),e.split(e.mapping.map(o.pos),1,m),h&&!d&&!o.parentOffset&&o.parent.type!==h)){const x=e.mapping.map(o.before()),y=e.doc.resolve(x);o.node(-1).canReplaceWith(y.index(),y.index()+1,h)&&e.setNodeMarkup(e.mapping.map(o.before()),h)}t&&gj(r,i.extensionManager.splittableMarks),e.scrollIntoView()}return v},hee=(t,e={})=>({tr:r,state:n,dispatch:i,editor:a})=>{var s;const o=Ur(t,n.schema),{$from:l,$to:u}=n.selection,c=n.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(u))return!1;const d=l.node(-1);if(d.type!==o)return!1;const h=a.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==o||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let b=be.empty;const S=l.index(-1)?1:l.index(-2)?2:3;for(let M=l.depth-S;M>=l.depth-3;M-=1)b=be.from(l.node(M).copy(b));const w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,k={...Fv(h,l.node().type.name,l.node().attrs),...e},N=((s=o.contentMatch.defaultType)==null?void 0:s.createAndFill(k))||void 0;b=b.append(be.from(o.createAndFill(null,N)||void 0));const T=l.before(l.depth-(S-1));r.replace(T,l.after(-w),new Ae(b,4-S,0));let j=-1;r.doc.nodesBetween(T,r.doc.content.size,(M,A)=>{if(j>-1)return!1;M.isTextblock&&M.content.size===0&&(j=A+1)}),j>-1&&r.setSelection(at.near(r.doc.resolve(j))),r.scrollIntoView()}return!0}const m=u.pos===l.end()?d.contentMatchAt(0).defaultType:null,v={...Fv(h,d.type.name,d.attrs),...e},x={...Fv(h,l.node().type.name,l.node().attrs),...e};r.delete(l.pos,u.pos);const y=m?[{type:o,attrs:v},{type:m,attrs:x}]:[{type:o,attrs:v}];if(!Sd(r.doc,l.pos,2))return!1;if(i){const{selection:b,storedMarks:S}=n,{splittableMarks:w}=a.extensionManager,k=S||b.$to.parentOffset&&b.$from.marks();if(r.split(l.pos,2,y).scrollIntoView(),!k||!i)return!0;const N=k.filter(T=>w.includes(T.type.name));r.ensureMarks(N)}return!0},cS=(t,e)=>{const r=Cx(s=>s.type===e)(t.selection);if(!r)return!0;const n=t.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(n===void 0)return!0;const i=t.doc.nodeAt(n);return r.node.type===(i==null?void 0:i.type)&&Dl(t.doc,r.pos)&&t.join(r.pos),!0},dS=(t,e)=>{const r=Cx(s=>s.type===e)(t.selection);if(!r)return!0;const n=t.doc.resolve(r.start).after(r.depth);if(n===void 0)return!0;const i=t.doc.nodeAt(n);return r.node.type===(i==null?void 0:i.type)&&Dl(t.doc,n)&&t.join(n),!0},pee=(t,e,r,n={})=>({editor:i,tr:a,state:s,dispatch:o,chain:l,commands:u,can:c})=>{const{extensions:d,splittableMarks:h}=i.extensionManager,m=Ur(t,s.schema),v=Ur(e,s.schema),{selection:x,storedMarks:y}=s,{$from:b,$to:S}=x,w=b.blockRange(S),k=y||x.$to.parentOffset&&x.$from.marks();if(!w)return!1;const N=Cx(T=>mj(T.type.name,d))(x);if(w.depth>=1&&N&&w.depth-N.depth<=1){if(N.node.type===m)return u.liftListItem(v);if(mj(N.node.type.name,d)&&m.validContent(N.node.content)&&o)return l().command(()=>(a.setNodeMarkup(N.pos,m),!0)).command(()=>cS(a,m)).command(()=>dS(a,m)).run()}return!r||!k||!o?l().command(()=>c().wrapInList(m,n)?!0:u.clearNodes()).wrapInList(m,n).command(()=>cS(a,m)).command(()=>dS(a,m)).run():l().command(()=>{const T=c().wrapInList(m,n),j=k.filter(M=>h.includes(M.type.name));return a.ensureMarks(j),T?!0:u.clearNodes()}).wrapInList(m,n).command(()=>cS(a,m)).command(()=>dS(a,m)).run()},mee=(t,e={},r={})=>({state:n,commands:i})=>{const{extendEmptyMarkRange:a=!1}=r,s=oo(t,n.schema);return xk(n,s,e)?i.unsetMark(s,{extendEmptyMarkRange:a}):i.setMark(s,e)},gee=(t,e,r={})=>({state:n,commands:i})=>{const a=Ur(t,n.schema),s=Ur(e,n.schema),o=Sl(n,a,r);let l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),o?i.setNode(s,l):i.setNode(a,{...l,...r})},vee=(t,e={})=>({state:r,commands:n})=>{const i=Ur(t,r.schema);return Sl(r,i,e)?n.lift(i):n.wrapIn(i,e)},yee=()=>({state:t,dispatch:e})=>{const r=t.plugins;for(let n=0;n<r.length;n+=1){const i=r[n];let a;if(i.spec.isInputRules&&(a=i.getState(t))){if(e){const s=t.tr,o=a.transform;for(let l=o.steps.length-1;l>=0;l-=1)s.step(o.steps[l].invert(o.docs[l]));if(a.text){const l=s.doc.resolve(a.from).marks();s.replaceWith(a.from,a.to,t.schema.text(a.text,l))}else s.delete(a.from,a.to)}return!0}}return!1},xee=()=>({tr:t,dispatch:e})=>{const{selection:r}=t,{empty:n,ranges:i}=r;return n||e&&i.forEach(a=>{t.removeMark(a.$from.pos,a.$to.pos)}),!0},bee=(t,e={})=>({tr:r,state:n,dispatch:i})=>{var a;const{extendEmptyMarkRange:s=!1}=e,{selection:o}=r,l=oo(t,n.schema),{$from:u,empty:c,ranges:d}=o;if(!i)return!0;if(c&&s){let{from:h,to:m}=o;const v=(a=u.marks().find(y=>y.type===l))==null?void 0:a.attrs,x=I3(u,l,v);x&&(h=x.from,m=x.to),r.removeMark(h,m,l)}else d.forEach(h=>{r.removeMark(h.$from.pos,h.$to.pos,l)});return r.removeStoredMark(l),!0},wee=t=>({tr:e,state:r,dispatch:n})=>{const{selection:i}=r;let a,s;return typeof t=="number"?(a=t,s=t):t&&"from"in t&&"to"in t?(a=t.from,s=t.to):(a=i.from,s=i.to),n&&e.doc.nodesBetween(a,s,(o,l)=>{if(o.isText)return;const u={...o.attrs};delete u.dir,e.setNodeMarkup(l,void 0,u)}),!0},See=(t,e={})=>({tr:r,state:n,dispatch:i})=>{let a=null,s=null;const o=kx(typeof t=="string"?t:t.name,n.schema);if(!o)return!1;o==="node"&&(a=Ur(t,n.schema)),o==="mark"&&(s=oo(t,n.schema));let l=!1;return r.selection.ranges.forEach(u=>{const c=u.$from.pos,d=u.$to.pos;let h,m,v,x;r.selection.empty?n.doc.nodesBetween(c,d,(y,b)=>{a&&a===y.type&&(l=!0,v=Math.max(b,c),x=Math.min(b+y.nodeSize,d),h=b,m=y)}):n.doc.nodesBetween(c,d,(y,b)=>{b<c&&a&&a===y.type&&(l=!0,v=Math.max(b,c),x=Math.min(b+y.nodeSize,d),h=b,m=y),b>=c&&b<=d&&(a&&a===y.type&&(l=!0,i&&r.setNodeMarkup(b,void 0,{...y.attrs,...e})),s&&y.marks.length&&y.marks.forEach(S=>{if(s===S.type&&(l=!0,i)){const w=Math.max(b,c),k=Math.min(b+y.nodeSize,d);r.addMark(w,k,s.create({...S.attrs,...e}))}}))}),m&&(h!==void 0&&i&&r.setNodeMarkup(h,void 0,{...m.attrs,...e}),s&&m.marks.length&&m.marks.forEach(y=>{s===y.type&&i&&r.addMark(v,x,s.create({...y.attrs,...e}))}))}),l},kee=(t,e={})=>({state:r,dispatch:n})=>{const i=Ur(t,r.schema);return QX(i,e)(r,n)},Cee=(t,e={})=>({state:r,dispatch:n})=>{const i=Ur(t,r.schema);return JX(i,e)(r,n)},Nee=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const r=this.callbacks[t];return r&&r.forEach(n=>n.apply(this,e)),this}off(t,e){const r=this.callbacks[t];return r&&(e?this.callbacks[t]=r.filter(n=>n!==e):delete this.callbacks[t]),this}once(t,e){const r=(...n)=>{this.off(t,r),e.apply(this,n)};return this.on(t,r)}removeAllListeners(){this.callbacks={}}},Ex=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},Eee=(t,e)=>{if(O3(e))return e.exec(t);const r=e(t);if(!r)return null;const n=[r.text];return n.index=r.index,n.input=t,n.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(r.replaceWith)),n};function Zg(t){var e;const{editor:r,from:n,to:i,text:a,rules:s,plugin:o}=t,{view:l}=r;if(l.composing)return!1;const u=l.state.doc.resolve(n);if(u.parent.type.spec.code||(e=u.nodeBefore||u.nodeAfter)!=null&&e.marks.find(h=>h.type.spec.code))return!1;let c=!1;const d=JZ(u)+a;return s.forEach(h=>{if(c)return;const m=Eee(d,h.find);if(!m)return;const v=l.state.tr,x=wx({state:l.state,transaction:v}),y={from:n-(m[0].length-a.length),to:i},{commands:b,chain:S,can:w}=new Sx({editor:r,state:x});h.handler({state:x,range:y,match:m,commands:b,chain:S,can:w})===null||!v.steps.length||(h.undoable&&v.setMeta(o,{transform:v,from:n,to:i,text:a}),l.dispatch(v),c=!0)}),c}function Tee(t){const{editor:e,rules:r}=t,n=new cr({state:{init(){return null},apply(i,a,s){const o=i.getMeta(n);if(o)return o;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:c}=l;typeof c=="string"?c=c:c=B3(be.from(c),s.schema);const{from:d}=l,h=d+c.length;Zg({editor:e,from:d,to:h,text:c,rules:r,plugin:n})}),i.selectionSet||i.docChanged?null:a}},props:{handleTextInput(i,a,s,o){return Zg({editor:e,from:a,to:s,text:o,rules:r,plugin:n})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:a}=i.state.selection;a&&Zg({editor:e,from:a.pos,to:a.pos,text:"",rules:r,plugin:n})}),!1)},handleKeyDown(i,a){if(a.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?Zg({editor:e,from:s.pos,to:s.pos,text:`
`,rules:r,plugin:n}):!1}},isInputRules:!0});return n}function jee(t){return Object.prototype.toString.call(t).slice(8,-1)}function ev(t){return jee(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function cO(t,e){const r={...t};return ev(t)&&ev(e)&&Object.keys(e).forEach(n=>{ev(e[n])&&ev(t[n])?r[n]=cO(t[n],e[n]):r[n]=e[n]}),r}var z3=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...Bt(qe(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Bt(qe(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>cO(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},rc=class dO extends z3{constructor(){super(...arguments),this.type="mark"}static create(e={}){const r=typeof e=="function"?e():e;return new dO(r)}static handleExit({editor:e,mark:r}){const{tr:n}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(u=>(u==null?void 0:u.type.name)===r.name))return!1;const l=s.find(u=>(u==null?void 0:u.type.name)===r.name);return l&&n.removeStoredMark(l),n.insertText(" ",i.pos),e.view.dispatch(n),!0}return!1}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}};function Mee(t){return typeof t=="number"}var Pee=class{constructor(t){this.find=t.find,this.handler=t.handler}},_ee=(t,e,r)=>{if(O3(e))return[...t.matchAll(e)];const n=e(t,r);return n?n.map(i=>{const a=[i.text];return a.index=i.index,a.input=t,a.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(i.replaceWith)),a}):[]};function Aee(t){const{editor:e,state:r,from:n,to:i,rule:a,pasteEvent:s,dropEvent:o}=t,{commands:l,chain:u,can:c}=new Sx({editor:e,state:r}),d=[];return r.doc.nodesBetween(n,i,(m,v)=>{var x,y,b,S,w;if((y=(x=m.type)==null?void 0:x.spec)!=null&&y.code||!(m.isText||m.isTextblock||m.isInline))return;const k=(w=(S=(b=m.content)==null?void 0:b.size)!=null?S:m.nodeSize)!=null?w:0,N=Math.max(n,v),T=Math.min(i,v+k);if(N>=T)return;const j=m.isText?m.text||"":m.textBetween(N-v,T-v,void 0,"");_ee(j,a.find,s).forEach(A=>{if(A.index===void 0)return;const P=N+A.index+1,D=P+A[0].length,R={from:r.tr.mapping.map(P),to:r.tr.mapping.map(D)},I=a.handler({state:r,range:R,match:A,commands:l,chain:u,can:c,pasteEvent:s,dropEvent:o});d.push(I)})}),d.every(m=>m!==null)}var tv=null,Ree=t=>{var e;const r=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=r.clipboardData)==null||e.setData("text/html",t),r};function Dee(t){const{editor:e,rules:r}=t;let n=null,i=!1,a=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o;try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}const l=({state:c,from:d,to:h,rule:m,pasteEvt:v})=>{const x=c.tr,y=wx({state:c,transaction:x});if(!(!Aee({editor:e,state:y,from:Math.max(d-1,0),to:h.b-1,rule:m,pasteEvent:v,dropEvent:o})||!x.steps.length)){try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,x}};return r.map(c=>new cr({view(d){const h=v=>{var x;n=(x=d.dom.parentElement)!=null&&x.contains(v.target)?d.dom.parentElement:null,n&&(tv=e)},m=()=>{tv&&(tv=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",m),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",m)}}},props:{handleDOMEvents:{drop:(d,h)=>{if(a=n===d.dom.parentElement,o=h,!a){const m=tv;m!=null&&m.isEditable&&setTimeout(()=>{const v=m.state.selection;v&&m.commands.deleteRange({from:v.from,to:v.to})},10)}return!1},paste:(d,h)=>{var m;const v=(m=h.clipboardData)==null?void 0:m.getData("text/html");return s=h,i=!!(v!=null&&v.includes("data-pm-slice")),!1}}},appendTransaction:(d,h,m)=>{const v=d[0],x=v.getMeta("uiEvent")==="paste"&&!i,y=v.getMeta("uiEvent")==="drop"&&!a,b=v.getMeta("applyPasteRules"),S=!!b;if(!x&&!y&&!S)return;if(S){let{text:N}=b;typeof N=="string"?N=N:N=B3(be.from(N),m.schema);const{from:T}=b,j=T+N.length,M=Ree(N);return l({rule:c,state:m,from:T,to:{b:j},pasteEvt:M})}const w=h.doc.content.findDiffStart(m.doc.content),k=h.doc.content.findDiffEnd(m.doc.content);if(!(!Mee(w)||!k||w===k.b))return l({rule:c,state:m,from:w,to:k,pasteEvt:s})}}))}var Tx=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=rO(t),this.schema=HZ(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Jg(e.name,this.schema)},n=qe(e,"addCommands",r);return n?{...t,...n()}:t},{})}get plugins(){const{editor:t}=this;return q0([...this.extensions].reverse()).flatMap(n=>{const i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Jg(n.name,this.schema)},a=[],s=qe(n,"addKeyboardShortcuts",i);let o={};if(n.type==="mark"&&qe(n,"exitable",i)&&(o.ArrowRight=()=>rc.handleExit({editor:t,mark:n})),s){const h=Object.fromEntries(Object.entries(s()).map(([m,v])=>[m,()=>v({editor:t})]));o={...o,...h}}const l=KJ(o);a.push(l);const u=qe(n,"addInputRules",i);if(pj(n,t.options.enableInputRules)&&u){const h=u();if(h&&h.length){const m=Tee({editor:t,rules:h}),v=Array.isArray(m)?m:[m];a.push(...v)}}const c=qe(n,"addPasteRules",i);if(pj(n,t.options.enablePasteRules)&&c){const h=c();if(h&&h.length){const m=Dee({editor:t,rules:h});a.push(...m)}}const d=qe(n,"addProseMirrorPlugins",i);if(d){const h=d();a.push(...h)}return a})}get attributes(){return tO(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Vd(this.extensions);return Object.fromEntries(e.filter(r=>!!qe(r,"addNodeView")).map(r=>{const n=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:Ur(r.name,this.schema)},a=qe(r,"addNodeView",i);if(!a)return[];const s=a();if(!s)return[];const o=(l,u,c,d,h)=>{const m=Op(l,n);return s({node:l,view:u,getPos:c,decorations:d,innerDecorations:h,editor:t,extension:r,HTMLAttributes:m})};return[r.name,o]}))}dispatchTransaction(t){const{editor:e}=this;return q0([...this.extensions].reverse()).reduceRight((n,i)=>{const a={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:e,type:Jg(i.name,this.schema)},s=qe(i,"dispatchTransaction",a);return s?o=>{s.call(a,{transaction:o,next:n})}:n},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=Vd(this.extensions);return Object.fromEntries(e.filter(r=>!!qe(r,"addMarkView")).map(r=>{const n=this.attributes.filter(o=>o.type===r.name),i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:oo(r.name,this.schema)},a=qe(r,"addMarkView",i);if(!a)return[];const s=(o,l,u)=>{const c=Op(o,n);return a()({mark:o,view:l,inline:u,editor:t,extension:r,HTMLAttributes:c,updateAttributes:d=>{Kee(o,t,d)}})};return[r.name,s]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var r;const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Jg(e.name,this.schema)};e.type==="mark"&&((r=Bt(qe(e,"keepOnSplit",n)))==null||r)&&this.splittableMarks.push(e.name);const i=qe(e,"onBeforeCreate",n),a=qe(e,"onCreate",n),s=qe(e,"onUpdate",n),o=qe(e,"onSelectionUpdate",n),l=qe(e,"onTransaction",n),u=qe(e,"onFocus",n),c=qe(e,"onBlur",n),d=qe(e,"onDestroy",n);i&&this.editor.on("beforeCreate",i),a&&this.editor.on("create",a),s&&this.editor.on("update",s),o&&this.editor.on("selectionUpdate",o),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}};Tx.resolve=rO;Tx.sort=q0;Tx.flatten=L3;var Oee={};D3(Oee,{ClipboardTextSerializer:()=>hO,Commands:()=>pO,Delete:()=>mO,Drop:()=>gO,Editable:()=>vO,FocusEvents:()=>xO,Keymap:()=>bO,Paste:()=>wO,Tabindex:()=>SO,TextDirection:()=>kO,focusEventsPluginKey:()=>yO});var Dr=class fO extends z3{constructor(){super(...arguments),this.type="extension"}static create(e={}){const r=typeof e=="function"?e():e;return new fO(r)}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}},hO=Dr.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new cr({key:new Rr("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:r}=t,{doc:n,selection:i}=e,{ranges:a}=i,s=Math.min(...a.map(c=>c.$from.pos)),o=Math.max(...a.map(c=>c.$to.pos)),l=iO(r);return nO(n,{from:s,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),pO=Dr.create({name:"commands",addCommands(){return{...WD}}}),mO=Dr.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var r,n,i;const a=()=>{var s,o,l,u;if((u=(l=(o=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:o.filterTransaction)==null?void 0:l.call(o,t))!=null?u:t.getMeta("y-sync$"))return;const c=ZD(t.before,[t,...e]);sO(c).forEach(m=>{c.mapping.mapResult(m.oldRange.from).deletedAfter&&c.mapping.mapResult(m.oldRange.to).deletedBefore&&c.before.nodesBetween(m.oldRange.from,m.oldRange.to,(v,x)=>{const y=x+v.nodeSize-2,b=m.oldRange.from<=x&&y<=m.oldRange.to;this.editor.emit("delete",{type:"node",node:v,from:x,to:y,newFrom:c.mapping.map(x),newTo:c.mapping.map(y),deletedRange:m.oldRange,newRange:m.newRange,partial:!b,editor:this.editor,transaction:t,combinedTransform:c})})});const h=c.mapping;c.steps.forEach((m,v)=>{var x,y;if(m instanceof Pa){const b=h.slice(v).map(m.from,-1),S=h.slice(v).map(m.to),w=h.invert().map(b,-1),k=h.invert().map(S),N=(x=c.doc.nodeAt(b-1))==null?void 0:x.marks.some(j=>j.eq(m.mark)),T=(y=c.doc.nodeAt(S))==null?void 0:y.marks.some(j=>j.eq(m.mark));this.editor.emit("delete",{type:"mark",mark:m.mark,from:m.from,to:m.to,deletedRange:{from:w,to:k},newRange:{from:b,to:S},partial:!!(T||N),editor:this.editor,transaction:t,combinedTransform:c})}})};(i=(n=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:n.async)==null||i?setTimeout(a,0):a()}}),gO=Dr.create({name:"drop",addProseMirrorPlugins(){return[new cr({key:new Rr("tiptapDrop"),props:{handleDrop:(t,e,r,n)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:r,moved:n})}}})]}}),vO=Dr.create({name:"editable",addProseMirrorPlugins(){return[new cr({key:new Rr("editable"),props:{editable:()=>this.editor.options.editable}})]}}),yO=new Rr("focusEvents"),xO=Dr.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new cr({key:yO,props:{handleDOMEvents:{focus:(e,r)=>{t.isFocused=!0;const n=t.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,r)=>{t.isFocused=!1;const n=t.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}}),bO=Dr.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:o})=>{const{selection:l,doc:u}=o,{empty:c,$anchor:d}=l,{pos:h,parent:m}=d,v=d.parent.isTextblock&&h>0?o.doc.resolve(h-1):d,x=v.parent.type.spec.isolating,y=d.pos-d.parentOffset,b=x&&v.parent.childCount===1?y===d.pos:ht.atStart(u).from===h;return!c||!m.type.isTextblock||m.textContent.length||!b||b&&d.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},a={...n,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return W0()||QD()?a:i},addProseMirrorPlugins(){return[new cr({key:new Rr("clearDocument"),appendTransaction:(t,e,r)=>{if(t.some(x=>x.getMeta("composition")))return;const n=t.some(x=>x.docChanged)&&!e.doc.eq(r.doc),i=t.some(x=>x.getMeta("preventClearDocument"));if(!n||i)return;const{empty:a,from:s,to:o}=e.selection,l=ht.atStart(e.doc).from,u=ht.atEnd(e.doc).to;if(a||!(s===l&&o===u)||!Nx(r.doc))return;const h=r.tr,m=wx({state:r,transaction:h}),{commands:v}=new Sx({editor:this.editor,state:m});if(v.clearNodes(),!!h.steps.length)return h}})]}}),wO=Dr.create({name:"paste",addProseMirrorPlugins(){return[new cr({key:new Rr("tiptapPaste"),props:{handlePaste:(t,e,r)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:r})}}})]}}),SO=Dr.create({name:"tabindex",addProseMirrorPlugins(){return[new cr({key:new Rr("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),kO=Dr.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=Vd(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const r=e.getAttribute("dir");return r&&(r==="ltr"||r==="rtl"||r==="auto")?r:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new cr({key:new Rr("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),Iee=class Hc{constructor(e,r,n=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=r,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let r=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}r=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:r,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),r=this.resolvedPos.doc.resolve(e);return new Hc(r,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Hc(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Hc(e,this.editor)}get children(){const e=[];return this.node.content.forEach((r,n)=>{const i=r.isBlock&&!r.isTextblock,a=r.isAtom&&!r.isText,s=this.pos+n+(a?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const o=this.resolvedPos.doc.resolve(s);if(!i&&o.depth<=this.depth)return;const l=new Hc(o,this.editor,i,i?r:null);i&&(l.actualDepth=this.depth+1),e.push(new Hc(o,this.editor,i,i?r:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,r={}){let n=null,i=this.parent;for(;i&&!n;){if(i.node.type.name===e)if(Object.keys(r).length>0){const a=i.node.attrs,s=Object.keys(r);for(let o=0;o<s.length;o+=1){const l=s[o];if(a[l]!==r[l])break}}else n=i;i=i.parent}return n}querySelector(e,r={}){return this.querySelectorAll(e,r,!0)[0]||null}querySelectorAll(e,r={},n=!1){let i=[];if(!this.children||this.children.length===0)return i;const a=Object.keys(r);return this.children.forEach(s=>{n&&i.length>0||(s.node.type.name===e&&a.every(l=>r[l]===s.node.attrs[l])&&i.push(s),!(n&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,r,n))))}),i}setAttribute(e){const{tr:r}=this.editor.state;r.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(r)}},Lee=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function Bee(t,e,r){const n=document.querySelector(`style[data-tiptap-style${r?`-${r}`:""}]`);if(n!==null)return n;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute(`data-tiptap-style${r?`-${r}`:""}`,""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}var Fee=class extends Nee{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:ree,createMappablePosition:nee},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:i,moved:a})=>this.options.onDrop(n,i,a)),this.on("paste",({event:n,slice:i})=>this.options.onPaste(n,i)),this.on("delete",this.options.onDelete);const e=this.createDoc(),r=YD(e,this.options.autofocus);this.editorState=cd.create({doc:e,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t!=null&&t.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=Bee(Lee,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const r=eO(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let r=e;if([].concat(t).forEach(i=>{const a=typeof i=="string"?`${i}$`:i.key;r=r.filter(s=>!s.key.startsWith(a))}),e.length===r.length)return;const n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}createExtensionManager(){var t,e;const n=[...this.options.enableCoreExtensions?[vO,hO.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),pO,xO,bO,SO,gO,wO,mO,kO.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new Tx(n,this)}createCommandManager(){this.commandManager=new Sx({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=yk(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),t=yk(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:r}=this.options,n=e.dispatchTransaction||this.dispatchTransaction.bind(this),i=r?this.extensionManager.dispatchTransaction(n):n;this.editorView=new GD(t,{...e,attributes:{role:"textbox",...e==null?void 0:e.attributes},dispatchTransaction:i,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const a=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(a),this.prependClass(),this.injectCSS();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(u=>{var c;return(c=this.capturedTransaction)==null?void 0:c.step(u)});return}const{state:e,transactions:r}=this.state.applyTransaction(t),n=!this.state.selection.eq(e.selection),i=r.includes(t),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:r.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=r.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),o=s==null?void 0:s.getMeta("focus"),l=s==null?void 0:s.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),!(t.getMeta("preventUpdate")||!r.some(u=>u.docChanged)||a.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:r.slice(1)})}getAttributes(t){return aO(this.state,t)}isActive(t,e){const r=typeof t=="string"?t:null,n=typeof t=="string"?e:t;return ZZ(this.state,r,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return B3(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:r={}}=t||{};return qZ(this.state.doc,{blockSeparator:e,textSerializers:{...iO(this.schema),...r}})}get isEmpty(){return Nx(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var r;return((r=this.$doc)==null?void 0:r.querySelector(t,e))||null}$nodes(t,e){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new Iee(e,this)}get $doc(){return this.$pos(0)}};function $d(t){return new Ex({find:t.find,handler:({state:e,range:r,match:n})=>{const i=Bt(t.getAttributes,void 0,n);if(i===!1||i===null)return null;const{tr:a}=e,s=n[n.length-1],o=n[0];if(s){const l=o.search(/\S/),u=r.from+o.indexOf(s),c=u+s.length;if(F3(r.from,r.to,e.doc).filter(m=>m.mark.type.excluded.find(x=>x===t.type&&x!==m.mark.type)).filter(m=>m.to>u).length)return null;c<r.to&&a.delete(c,r.to),u>r.from&&a.delete(r.from+l,u);const h=r.from+l+s.length;a.addMark(r.from+l,h,t.type.create(i||{})),a.removeStoredMark(t.type)}},undoable:t.undoable})}function zee(t){return new Ex({find:t.find,handler:({state:e,range:r,match:n})=>{const i=Bt(t.getAttributes,void 0,n)||{},{tr:a}=e,s=r.from;let o=r.to;const l=t.type.create(i);if(n[1]){const u=n[0].lastIndexOf(n[1]);let c=s+u;c>o?c=o:o=c+n[1].length;const d=n[0][n[0].length-1];a.insertText(d,s+n[0].length-1),a.replaceWith(c,o,l)}else if(n[0]){const u=t.type.isInline?s:s-1;a.insert(u,t.type.create(i)).delete(a.mapping.map(s),a.mapping.map(o))}a.scrollIntoView()},undoable:t.undoable})}function bk(t){return new Ex({find:t.find,handler:({state:e,range:r,match:n})=>{const i=e.doc.resolve(r.from),a=Bt(t.getAttributes,void 0,n)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(r.from,r.to).setBlockType(r.from,r.from,t.type,a)},undoable:t.undoable})}function Ud(t){return new Ex({find:t.find,handler:({state:e,range:r,match:n,chain:i})=>{const a=Bt(t.getAttributes,void 0,n)||{},s=e.tr.delete(r.from,r.to),l=s.doc.resolve(r.from).blockRange(),u=l&&w3(l,t.type,a);if(!u)return null;if(s.wrap(l,u),t.keepMarks&&t.editor){const{selection:d,storedMarks:h}=e,{splittableMarks:m}=t.editor.extensionManager,v=h||d.$to.parentOffset&&d.$from.marks();if(v){const x=v.filter(y=>m.includes(y.type.name));s.ensureMarks(x)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,a).run()}const c=s.doc.resolve(r.from-1).nodeBefore;c&&c.type===t.type&&Dl(s.doc,r.from-1)&&(!t.joinPredicate||t.joinPredicate(n,c))&&s.join(r.from-1)},undoable:t.undoable})}function Vee(t,e){const{selection:r}=t,{$from:n}=r;if(r instanceof Ye){const a=n.index();return n.parent.canReplaceWith(a,a+1,e)}let i=n.depth;for(;i>=0;){const a=n.index(i);if(n.node(i).contentMatchAt(a).matchType(e))return!0;i-=1}return!1}function $ee(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var Uee={};D3(Uee,{createAtomBlockMarkdownSpec:()=>Gee,createBlockMarkdownSpec:()=>Hee,createInlineMarkdownSpec:()=>CO,parseAttributes:()=>V3,parseIndentedBlocks:()=>wk,renderNestedMarkdownContent:()=>U3,serializeAttributes:()=>$3});function V3(t){if(!(t!=null&&t.trim()))return{};const e={},r=[],n=t.replace(/["']([^"']*)["']/g,u=>(r.push(u),`__QUOTED_${r.length-1}__`)),i=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const u=i.map(c=>c.trim().slice(1));e.class=u.join(" ")}const a=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);a&&(e.id=a[1]);const s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(s)).forEach(([,u,c])=>{var d;const h=parseInt(((d=c.match(/__QUOTED_(\d+)__/))==null?void 0:d[1])||"0",10),m=r[h];m&&(e[u]=m.slice(1,-1))});const l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(c=>{c.match(/^[a-zA-Z][\w-]*$/)&&(e[c]=!0)}),e}function $3(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(n=>e.push(`.${n}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([r,n])=>{r==="class"||r==="id"||(n===!0?e.push(r):n!==!1&&n!=null&&e.push(`${r}="${String(n)}"`))}),e.join(" ")}function Gee(t){const{nodeName:e,name:r,parseAttributes:n=V3,serializeAttributes:i=$3,defaultAttributes:a={},requiredAttributes:s=[],allowedAttributes:o}=t,l=r||e,u=c=>{if(!o)return c;const d={};return o.forEach(h=>{h in c&&(d[h]=c[h])}),d};return{parseMarkdown:(c,d)=>{const h={...a,...c.attributes};return d.createNode(e,h,[])},markdownTokenizer:{name:e,level:"block",start(c){var d;const h=new RegExp(`^:::${l}(?:\\s|$)`,"m"),m=(d=c.match(h))==null?void 0:d.index;return m!==void 0?m:-1},tokenize(c,d,h){const m=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),v=c.match(m);if(!v)return;const x=v[1]||"",y=n(x);if(!s.find(S=>!(S in y)))return{type:e,raw:v[0],attributes:y}}},renderMarkdown:c=>{const d=u(c.attrs||{}),h=i(d),m=h?` {${h}}`:"";return`:::${l}${m} :::`}}}function Hee(t){const{nodeName:e,name:r,getContent:n,parseAttributes:i=V3,serializeAttributes:a=$3,defaultAttributes:s={},content:o="block",allowedAttributes:l}=t,u=r||e,c=d=>{if(!l)return d;const h={};return l.forEach(m=>{m in d&&(h[m]=d[m])}),h};return{parseMarkdown:(d,h)=>{let m;if(n){const x=n(d);m=typeof x=="string"?[{type:"text",text:x}]:x}else o==="block"?m=h.parseChildren(d.tokens||[]):m=h.parseInline(d.tokens||[]);const v={...s,...d.attributes};return h.createNode(e,v,m)},markdownTokenizer:{name:e,level:"block",start(d){var h;const m=new RegExp(`^:::${u}`,"m"),v=(h=d.match(m))==null?void 0:h.index;return v!==void 0?v:-1},tokenize(d,h,m){var v;const x=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),y=d.match(x);if(!y)return;const[b,S=""]=y,w=i(S);let k=1;const N=b.length;let T="";const j=/^:::([\w-]*)(\s.*)?/gm,M=d.slice(N);for(j.lastIndex=0;;){const A=j.exec(M);if(A===null)break;const P=A.index,D=A[1];if(!((v=A[2])!=null&&v.endsWith(":::"))){if(D)k+=1;else if(k-=1,k===0){const R=M.slice(0,P);T=R.trim();const I=d.slice(0,N+P+A[0].length);let U=[];if(T)if(o==="block")for(U=m.blockTokens(R),U.forEach(B=>{B.text&&(!B.tokens||B.tokens.length===0)&&(B.tokens=m.inlineTokens(B.text))});U.length>0;){const B=U[U.length-1];if(B.type==="paragraph"&&(!B.text||B.text.trim()===""))U.pop();else break}else U=m.inlineTokens(T);return{type:e,raw:I,attributes:w,content:T,tokens:U}}}}}},renderMarkdown:(d,h)=>{const m=c(d.attrs||{}),v=a(m),x=v?` {${v}}`:"",y=h.renderChildren(d.content||[],`

`);return`:::${u}${x}

${y}

:::`}}}function Wee(t){if(!t.trim())return{};const e={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(t);for(;n!==null;){const[,i,a,s]=n;e[i]=a||s,n=r.exec(t)}return e}function qee(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e}="${r}"`).join(" ")}function CO(t){const{nodeName:e,name:r,getContent:n,parseAttributes:i=Wee,serializeAttributes:a=qee,defaultAttributes:s={},selfClosing:o=!1,allowedAttributes:l}=t,u=r||e,c=h=>{if(!l)return h;const m={};return l.forEach(v=>{const x=typeof v=="string"?v:v.name,y=typeof v=="string"?void 0:v.skipIfDefault;if(x in h){const b=h[x];if(y!==void 0&&b===y)return;m[x]=b}}),m},d=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(h,m)=>{const v={...s,...h.attributes};if(o)return m.createNode(e,v);const x=n?n(h):h.content||"";return x?m.createNode(e,v,[m.createTextNode(x)]):m.createNode(e,v,[])},markdownTokenizer:{name:e,level:"inline",start(h){const m=o?new RegExp(`\\[${d}\\s*[^\\]]*\\]`):new RegExp(`\\[${d}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${d}\\]`),v=h.match(m),x=v==null?void 0:v.index;return x!==void 0?x:-1},tokenize(h,m,v){const x=o?new RegExp(`^\\[${d}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${d}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${d}\\]`),y=h.match(x);if(!y)return;let b="",S="";if(o){const[,k]=y;S=k}else{const[,k,N]=y;S=k,b=N||""}const w=i(S.trim());return{type:e,raw:y[0],content:b.trim(),attributes:w}}},renderMarkdown:h=>{let m="";n?m=n(h):h.content&&h.content.length>0&&(m=h.content.filter(b=>b.type==="text").map(b=>b.text).join(""));const v=c(h.attrs||{}),x=a(v),y=x?` ${x}`:"";return o?`[${u}${y}]`:`[${u}${y}]${m}[/${u}]`}}}function wk(t,e,r){var n,i,a,s;const o=t.split(`
`),l=[];let u="",c=0;const d=e.baseIndentSize||2;for(;c<o.length;){const h=o[c],m=h.match(e.itemPattern);if(!m){if(l.length>0)break;if(h.trim()===""){c+=1,u=`${u}${h}
`;continue}else return}const v=e.extractItemData(m),{indentLevel:x,mainContent:y}=v;u=`${u}${h}
`;const b=[y];for(c+=1;c<o.length;){const N=o[c];if(N.trim()===""){const j=o.slice(c+1).findIndex(P=>P.trim()!=="");if(j===-1)break;if((((i=(n=o[c+1+j].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:i.length)||0)>x){b.push(N),u=`${u}${N}
`,c+=1;continue}else break}if((((s=(a=N.match(/^(\s*)/))==null?void 0:a[1])==null?void 0:s.length)||0)>x)b.push(N),u=`${u}${N}
`,c+=1;else break}let S;const w=b.slice(1);if(w.length>0){const N=w.map(T=>T.slice(x+d)).join(`
`);N.trim()&&(e.customNestedParser?S=e.customNestedParser(N):S=r.blockTokens(N))}const k=e.createToken(v,S);l.push(k)}if(l.length!==0)return{items:l,raw:u}}function U3(t,e,r,n){if(!t||!Array.isArray(t.content))return"";const i=typeof r=="function"?r(n):r,[a,...s]=t.content,o=e.renderChildren([a]),l=[`${i}${o}`];return s&&s.length>0&&s.forEach(u=>{const c=e.renderChildren([u]);if(c){const d=c.split(`
`).map(h=>h?e.indent(h):"").join(`
`);l.push(d)}}),l.join(`
`)}function Kee(t,e,r={}){const{state:n}=e,{doc:i,tr:a}=n,s=t;i.descendants((o,l)=>{const u=a.mapping.map(l),c=a.mapping.map(l)+o.nodeSize;let d=null;if(o.marks.forEach(m=>{if(m!==s)return!1;d=m}),!d)return;let h=!1;if(Object.keys(r).forEach(m=>{r[m]!==d.attrs[m]&&(h=!0)}),h){const m=t.type.create({...t.attrs,...r});a.removeMark(u,c,t.type),a.addMark(u,c,m)}}),a.docChanged&&e.view.dispatch(a)}var Ci=class NO extends z3{constructor(){super(...arguments),this.type="node"}static create(e={}){const r=typeof e=="function"?e():e;return new NO(r)}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}};function Ku(t){return new Pee({find:t.find,handler:({state:e,range:r,match:n,pasteEvent:i})=>{const a=Bt(t.getAttributes,void 0,n,i);if(a===!1||a===null)return null;const{tr:s}=e,o=n[n.length-1],l=n[0];let u=r.to;if(o){const c=l.search(/\S/),d=r.from+l.indexOf(o),h=d+o.length;if(F3(r.from,r.to,e.doc).filter(v=>v.mark.type.excluded.find(y=>y===t.type&&y!==v.mark.type)).filter(v=>v.to>d).length)return null;h<r.to&&s.delete(h,r.to),d>r.from&&s.delete(r.from+c,d),u=r.from+c+o.length,s.addMark(r.from+c,u,t.type.create(a||{})),s.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:Yee,getOwnPropertySymbols:Xee}=Object,{hasOwnProperty:Qee}=Object.prototype;function fS(t,e){return function(n,i,a){return t(n,i,a)&&e(n,i,a)}}function rv(t){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return t(r,n,i);const{cache:a}=i,s=a.get(r),o=a.get(n);if(s&&o)return s===n&&o===r;a.set(r,n),a.set(n,r);const l=t(r,n,i);return a.delete(r),a.delete(n),l}}function Jee(t){return t!=null?t[Symbol.toStringTag]:void 0}function vj(t){return Yee(t).concat(Xee(t))}const Zee=Object.hasOwn||((t,e)=>Qee.call(t,e));function nc(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const ete="__v",tte="__o",rte="_owner",{getOwnPropertyDescriptor:yj,keys:xj}=Object;function nte(t,e){return t.byteLength===e.byteLength&&K0(new Uint8Array(t),new Uint8Array(e))}function ite(t,e,r){let n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!r.equals(t[n],e[n],n,n,t,e,r))return!1;return!0}function ate(t,e){return t.byteLength===e.byteLength&&K0(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function ste(t,e){return nc(t.getTime(),e.getTime())}function ote(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function lte(t,e){return t===e}function bj(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const i=new Array(n),a=t.entries();let s,o,l=0;for(;(s=a.next())&&!s.done;){const u=e.entries();let c=!1,d=0;for(;(o=u.next())&&!o.done;){if(i[d]){d++;continue}const h=s.value,m=o.value;if(r.equals(h[0],m[0],l,d,t,e,r)&&r.equals(h[1],m[1],h[0],m[0],t,e,r)){c=i[d]=!0;break}d++}if(!c)return!1;l++}return!0}const ute=nc;function cte(t,e,r){const n=xj(t);let i=n.length;if(xj(e).length!==i)return!1;for(;i-- >0;)if(!EO(t,e,r,n[i]))return!1;return!0}function sh(t,e,r){const n=vj(t);let i=n.length;if(vj(e).length!==i)return!1;let a,s,o;for(;i-- >0;)if(a=n[i],!EO(t,e,r,a)||(s=yj(t,a),o=yj(e,a),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function dte(t,e){return nc(t.valueOf(),e.valueOf())}function fte(t,e){return t.source===e.source&&t.flags===e.flags}function wj(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const i=new Array(n),a=t.values();let s,o;for(;(s=a.next())&&!s.done;){const l=e.values();let u=!1,c=0;for(;(o=l.next())&&!o.done;){if(!i[c]&&r.equals(s.value,o.value,s.value,o.value,t,e,r)){u=i[c]=!0;break}c++}if(!u)return!1}return!0}function K0(t,e){let r=t.byteLength;if(e.byteLength!==r||t.byteOffset!==e.byteOffset)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}function hte(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function EO(t,e,r,n){return(n===rte||n===tte||n===ete)&&(t.$$typeof||e.$$typeof)?!0:Zee(e,n)&&r.equals(t[n],e[n],n,n,t,e,r)}const pte="[object ArrayBuffer]",mte="[object Arguments]",gte="[object Boolean]",vte="[object DataView]",yte="[object Date]",xte="[object Error]",bte="[object Map]",wte="[object Number]",Ste="[object Object]",kte="[object RegExp]",Cte="[object Set]",Nte="[object String]",Ete={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},Tte="[object URL]",jte=Object.prototype.toString;function Mte({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:i,areFunctionsEqual:a,areMapsEqual:s,areNumbersEqual:o,areObjectsEqual:l,arePrimitiveWrappersEqual:u,areRegExpsEqual:c,areSetsEqual:d,areTypedArraysEqual:h,areUrlsEqual:m,unknownTagComparators:v}){return function(y,b,S){if(y===b)return!0;if(y==null||b==null)return!1;const w=typeof y;if(w!==typeof b)return!1;if(w!=="object")return w==="number"?o(y,b,S):w==="function"?a(y,b,S):!1;const k=y.constructor;if(k!==b.constructor)return!1;if(k===Object)return l(y,b,S);if(Array.isArray(y))return e(y,b,S);if(k===Date)return n(y,b,S);if(k===RegExp)return c(y,b,S);if(k===Map)return s(y,b,S);if(k===Set)return d(y,b,S);const N=jte.call(y);if(N===yte)return n(y,b,S);if(N===kte)return c(y,b,S);if(N===bte)return s(y,b,S);if(N===Cte)return d(y,b,S);if(N===Ste)return typeof y.then!="function"&&typeof b.then!="function"&&l(y,b,S);if(N===Tte)return m(y,b,S);if(N===xte)return i(y,b,S);if(N===mte)return l(y,b,S);if(Ete[N])return h(y,b,S);if(N===pte)return t(y,b,S);if(N===vte)return r(y,b,S);if(N===gte||N===wte||N===Nte)return u(y,b,S);if(v){let T=v[N];if(!T){const j=Jee(y);j&&(T=v[j])}if(T)return T(y,b,S)}return!1}}function Pte({circular:t,createCustomConfig:e,strict:r}){let n={areArrayBuffersEqual:nte,areArraysEqual:r?sh:ite,areDataViewsEqual:ate,areDatesEqual:ste,areErrorsEqual:ote,areFunctionsEqual:lte,areMapsEqual:r?fS(bj,sh):bj,areNumbersEqual:ute,areObjectsEqual:r?sh:cte,arePrimitiveWrappersEqual:dte,areRegExpsEqual:fte,areSetsEqual:r?fS(wj,sh):wj,areTypedArraysEqual:r?fS(K0,sh):K0,areUrlsEqual:hte,unknownTagComparators:void 0};if(e&&(n=Object.assign({},n,e(n))),t){const i=rv(n.areArraysEqual),a=rv(n.areMapsEqual),s=rv(n.areObjectsEqual),o=rv(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:i,areMapsEqual:a,areObjectsEqual:s,areSetsEqual:o})}return n}function _te(t){return function(e,r,n,i,a,s,o){return t(e,r,o)}}function Ate({circular:t,comparator:e,createState:r,equals:n,strict:i}){if(r)return function(o,l){const{cache:u=t?new WeakMap:void 0,meta:c}=r();return e(o,l,{cache:u,equals:n,meta:c,strict:i})};if(t)return function(o,l){return e(o,l,{cache:new WeakMap,equals:n,meta:void 0,strict:i})};const a={cache:void 0,equals:n,meta:void 0,strict:i};return function(o,l){return e(o,l,a)}}const Rte=Il();Il({strict:!0});Il({circular:!0});Il({circular:!0,strict:!0});Il({createInternalComparator:()=>nc});Il({strict:!0,createInternalComparator:()=>nc});Il({circular:!0,createInternalComparator:()=>nc});Il({circular:!0,createInternalComparator:()=>nc,strict:!0});function Il(t={}){const{circular:e=!1,createInternalComparator:r,createState:n,strict:i=!1}=t,a=Pte(t),s=Mte(a),o=r?r(s):_te(s);return Ate({circular:e,comparator:s,createState:n,equals:o,strict:i})}var TO={exports:{}},jO={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jx=K,Dte=y3;function Ote(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ite=typeof Object.is=="function"?Object.is:Ote,Lte=Dte.useSyncExternalStore,Bte=jx.useRef,Fte=jx.useEffect,zte=jx.useMemo,Vte=jx.useDebugValue;jO.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=Bte(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=zte(function(){function l(m){if(!u){if(u=!0,c=m,m=n(m),i!==void 0&&s.hasValue){var v=s.value;if(i(v,m))return d=v}return d=m}if(v=d,Ite(c,m))return v;var x=n(m);return i!==void 0&&i(v,x)?(c=m,v):(c=m,d=x)}var u=!1,c,d,h=r===void 0?null:r;return[function(){return l(e())},h===null?void 0:function(){return l(h())}]},[e,r,n,i]);var o=Lte(t,a[0],a[1]);return Fte(function(){s.hasValue=!0,s.value=o},[o]),Vte(o),o};TO.exports=jO;var $te=TO.exports,Ute=(...t)=>e=>{t.forEach(r=>{typeof r=="function"?r(e):r&&(r.current=e)})},Gte=({contentComponent:t})=>{const e=y3.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return f.jsx(f.Fragment,{children:Object.values(e)})};function Hte(){const t=new Set;let e={};return{subscribe(r){return t.add(r),()=>{t.delete(r)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(r,n){e={...e,[r]:jz.createPortal(n.reactElement,n.element,r)},t.forEach(i=>i())},removeRenderer(r){const n={...e};delete n[r],e=n,t.forEach(i=>i())}}}var Wte=class extends kt.Component{constructor(t){var e;super(t),this.editorContentRef=kt.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const r=this.editorContentRef.current;r.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:r}),e.contentComponent=Hte(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const r=document.createElement("div");r.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:r})}catch{}}}render(){const{editor:t,innerRef:e,...r}=this.props;return f.jsxs(f.Fragment,{children:[f.jsx("div",{ref:Ute(e,this.editorContentRef),...r}),(t==null?void 0:t.contentComponent)&&f.jsx(Gte,{contentComponent:t.contentComponent})]})}},qte=K.forwardRef((t,e)=>{const r=kt.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return kt.createElement(Wte,{key:r,innerRef:e,...t})}),Kte=kt.memo(qte),Yte=typeof window<"u"?K.useLayoutEffect:K.useEffect,Xte=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(n=>n())},r=this.editor;return r.on("transaction",e),()=>{r.off("transaction",e)}}}};function Qte(t){var e;const[r]=K.useState(()=>new Xte(t.editor)),n=$te.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:Rte);return Yte(()=>r.watch(t.editor),[t.editor,r]),K.useDebugValue(n),n}var Jte=!1,Sk=typeof window>"u",Zte=Sk||!!(typeof window<"u"&&window.next),ere=class MO{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(r=>r())}getInitialEditor(){if(this.options.current.immediatelyRender===void 0)return Sk||Zte?null:this.createEditor();if(this.options.current.immediatelyRender&&Sk&&Jte)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return this.options.current.immediatelyRender?this.createEditor():null}createEditor(){const e={...this.options.current,onBeforeCreate:(...n)=>{var i,a;return(a=(i=this.options.current).onBeforeCreate)==null?void 0:a.call(i,...n)},onBlur:(...n)=>{var i,a;return(a=(i=this.options.current).onBlur)==null?void 0:a.call(i,...n)},onCreate:(...n)=>{var i,a;return(a=(i=this.options.current).onCreate)==null?void 0:a.call(i,...n)},onDestroy:(...n)=>{var i,a;return(a=(i=this.options.current).onDestroy)==null?void 0:a.call(i,...n)},onFocus:(...n)=>{var i,a;return(a=(i=this.options.current).onFocus)==null?void 0:a.call(i,...n)},onSelectionUpdate:(...n)=>{var i,a;return(a=(i=this.options.current).onSelectionUpdate)==null?void 0:a.call(i,...n)},onTransaction:(...n)=>{var i,a;return(a=(i=this.options.current).onTransaction)==null?void 0:a.call(i,...n)},onUpdate:(...n)=>{var i,a;return(a=(i=this.options.current).onUpdate)==null?void 0:a.call(i,...n)},onContentError:(...n)=>{var i,a;return(a=(i=this.options.current).onContentError)==null?void 0:a.call(i,...n)},onDrop:(...n)=>{var i,a;return(a=(i=this.options.current).onDrop)==null?void 0:a.call(i,...n)},onPaste:(...n)=>{var i,a;return(a=(i=this.options.current).onPaste)==null?void 0:a.call(i,...n)},onDelete:(...n)=>{var i,a;return(a=(i=this.options.current).onDelete)==null?void 0:a.call(i,...n)}};return new Fee(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,r){return Object.keys(e).every(n=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)?!0:n==="extensions"&&e.extensions&&r.extensions?e.extensions.length!==r.extensions.length?!1:e.extensions.every((i,a)=>{var s;return i===((s=r.extensions)==null?void 0:s[a])}):e[n]===r[n])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?MO.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((n,i)=>n===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,r=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){r&&r.setOptions(this.options.current);return}r&&!r.isDestroyed&&(r.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function tre(t={},e=[]){const r=K.useRef(t);r.current=t;const[n]=K.useState(()=>new ere(r)),i=y3.useSyncExternalStore(n.subscribe,n.getEditor,n.getServerSnapshot);return K.useDebugValue(i),K.useEffect(n.onRender(e)),Qte({editor:i,selector:({transactionNumber:a})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&a===0?0:a+1}),i}var rre=K.createContext({editor:null});rre.Consumer;var nre=K.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),ire=()=>K.useContext(nre);kt.forwardRef((t,e)=>{const{onDragStart:r}=ire(),n=t.as||"div";return f.jsx(n,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...t.style}})});function Sj(t){return!!(typeof t=="function"&&t.prototype&&t.prototype.isReactComponent)}function kj(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.forward_ref)"||t.$$typeof.description==="react.forward_ref"))}function are(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.memo)"||t.$$typeof.description==="react.memo"))}function sre(t){if(Sj(t)||kj(t))return!0;if(are(t)){const e=t.type;if(e)return Sj(e)||kj(e)}return!1}function ore(){try{if(K.version)return parseInt(K.version.split(".")[0],10)>=19}catch{}return!1}var lre=class{constructor(t,{editor:e,props:r={},as:n="div",className:i=""}){this.ref=null,this.destroyed=!1,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=t,this.editor=e,this.props=r,this.element=document.createElement(n),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?Zs.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.destroyed||this.render()})}render(){var t;if(this.destroyed)return;const e=this.component,r=this.props,n=this.editor,i=ore(),a=sre(e),s={...r};s.ref&&!(i||a)&&delete s.ref,!s.ref&&(i||a)&&(s.ref=o=>{this.ref=o}),this.reactElement=f.jsx(e,{...s}),(t=n==null?void 0:n.contentComponent)==null||t.setRenderer(this.id,this)}updateProps(t={}){this.destroyed||(this.props={...this.props,...t},this.render())}destroy(){var t;this.destroyed=!0;const e=this.editor;(t=e==null?void 0:e.contentComponent)==null||t.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(t){Object.keys(t).forEach(e=>{this.element.setAttribute(e,t[e])})}};kt.createContext({markViewContentRef:()=>{}});var Y0=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:r,...n}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,n,r]},ure=/^\s*>\s$/,cre=Ci.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return Y0("blockquote",{...ur(this.options.HTMLAttributes,t),children:Y0("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const r=">",n=[];return t.content.forEach(i=>{const o=e.renderChildren([i]).split(`
`).map(l=>l.trim()===""?r:`${r} ${l}`);n.push(o.join(`
`))}),n.join(`
${r}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Ud({find:ure,type:this.type})]}}),dre=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,fre=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,hre=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,pre=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,mre=rc.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return Y0("strong",{...ur(this.options.HTMLAttributes,t),children:Y0("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[$d({find:dre,type:this.type}),$d({find:hre,type:this.type})]},addPasteRules(){return[Ku({find:fre,type:this.type}),Ku({find:pre,type:this.type})]}}),gre=/(^|[^`])`([^`]+)`(?!`)$/,vre=/(^|[^`])`([^`]+)`(?!`)/g,yre=rc.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",ur(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[$d({find:gre,type:this.type})]},addPasteRules(){return[Ku({find:vre,type:this.type})]}}),hS=4,xre=/^```([a-z]+)?[\s\n]$/,bre=/^~~~([a-z]+)?[\s\n]$/,wre=Ci.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:hS,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:r}=this.options;if(!r)return null;const a=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(s=>s.startsWith(r)).map(s=>s.replace(r,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",ur(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var r;return((r=t.raw)==null?void 0:r.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var r;let n="";const i=((r=t.attrs)==null?void 0:r.language)||"";return t.content?n=[`\`\`\`${i}`,e.renderChildren(t.content),"```"].join(`
`):n=`\`\`\`${i}

\`\`\``,n},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,r=e.pos===1;return!t||e.parent.type.name!==this.name?!1:r||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const r=(e=this.options.tabSize)!=null?e:hS,{state:n}=t,{selection:i}=n,{$from:a,empty:s}=i;if(a.parent.type!==this.type)return!1;const o=" ".repeat(r);return s?t.commands.insertContent(o):t.commands.command(({tr:l})=>{const{from:u,to:c}=i,m=n.doc.textBetween(u,c,`
`,`
`).split(`
`).map(v=>o+v).join(`
`);return l.replaceWith(u,c,n.schema.text(m)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const r=(e=this.options.tabSize)!=null?e:hS,{state:n}=t,{selection:i}=n,{$from:a,empty:s}=i;return a.parent.type!==this.type?!1:s?t.commands.command(({tr:o})=>{var l;const{pos:u}=a,c=a.start(),d=a.end(),m=n.doc.textBetween(c,d,`
`,`
`).split(`
`);let v=0,x=0;const y=u-c;for(let T=0;T<m.length;T+=1){if(x+m[T].length>=y){v=T;break}x+=m[T].length+1}const S=((l=m[v].match(/^ */))==null?void 0:l[0])||"",w=Math.min(S.length,r);if(w===0)return!0;let k=c;for(let T=0;T<v;T+=1)k+=m[T].length+1;return o.delete(k,k+w),u-k<=w&&o.setSelection(at.create(o.doc,k)),!0}):t.commands.command(({tr:o})=>{const{from:l,to:u}=i,h=n.doc.textBetween(l,u,`
`,`
`).split(`
`).map(m=>{var v;const x=((v=m.match(/^ */))==null?void 0:v[0])||"",y=Math.min(x.length,r);return m.slice(y)}).join(`
`);return o.replaceWith(l,u,n.schema.text(h)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:r}=e,{$from:n,empty:i}=r;if(!i||n.parent.type!==this.type)return!1;const a=n.parentOffset===n.parent.nodeSize-2,s=n.parent.textContent.endsWith(`

`);return!a||!s?!1:t.chain().command(({tr:o})=>(o.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:r,doc:n}=e,{$from:i,empty:a}=r;if(!a||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const o=i.after();return o===void 0?!1:n.nodeAt(o)?t.commands.command(({tr:u})=>(u.setSelection(ht.near(n.resolve(o))),!0)):t.commands.exitCode()}}},addInputRules(){return[bk({find:xre,type:this.type,getAttributes:t=>({language:t[1]})}),bk({find:bre,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new cr({key:new Rr("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const r=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("vscode-editor-data"),i=n?JSON.parse(n):void 0,a=i==null?void 0:i.mode;if(!r||!a)return!1;const{tr:s,schema:o}=t.state,l=o.text(r.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:a},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(at.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),Sre=Ci.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),kre=Ci.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",ur(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:r,editor:n})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:a}=r;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=n.extensionManager,l=a||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&l&&s){const d=l.filter(h=>o.includes(h.type.name));u.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Cre=Ci.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,ur(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var r;const n=(r=t.attrs)!=null&&r.level?parseInt(t.attrs.level,10):1,i="#".repeat(n);return t.content?`${i} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>bk({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),Nre=Ci.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",ur(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!Vee(e,e.schema.nodes[this.name]))return!1;const{selection:r}=e,{$to:n}=r,i=t();return oO(r)?i.insertContentAt(n.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:a,tr:s,dispatch:o})=>{if(o){const{$to:l}=s.selection,u=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection(at.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(Ye.create(s.doc,l.pos)):s.setSelection(at.create(s.doc,l.pos));else{const c=a.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,d=c==null?void 0:c.create();d&&(s.insert(u,d),s.setSelection(at.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[zee({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),Ere=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,Tre=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,jre=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Mre=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Pre=rc.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",ur(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[$d({find:Ere,type:this.type}),$d({find:jre,type:this.type})]},addPasteRules(){return[Ku({find:Tre,type:this.type}),Ku({find:Mre,type:this.type})]}});const _re="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",Are="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",kk="numeric",Ck="ascii",Nk="alpha",Uh="asciinumeric",Ch="alphanumeric",Ek="domain",PO="emoji",Rre="scheme",Dre="slashscheme",pS="whitespace";function Ore(t,e){return t in e||(e[t]=[]),e[t]}function Su(t,e,r){e[kk]&&(e[Uh]=!0,e[Ch]=!0),e[Ck]&&(e[Uh]=!0,e[Nk]=!0),e[Uh]&&(e[Ch]=!0),e[Nk]&&(e[Ch]=!0),e[Ch]&&(e[Ek]=!0),e[PO]&&(e[Ek]=!0);for(const n in e){const i=Ore(n,r);i.indexOf(t)<0&&i.push(t)}}function Ire(t,e){const r={};for(const n in e)e[n].indexOf(t)>=0&&(r[n]=!0);return r}function mi(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}mi.groups={};mi.prototype={accepts(){return!!this.t},go(t){const e=this,r=e.j[t];if(r)return r;for(let n=0;n<e.jr.length;n++){const i=e.jr[n][0],a=e.jr[n][1];if(a&&i.test(t))return a}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,r,n){for(let i=0;i<t.length;i++)this.tt(t[i],e,r,n)},tr(t,e,r,n){n=n||mi.groups;let i;return e&&e.j?i=e:(i=new mi(e),r&&n&&Su(e,r,n)),this.jr.push([t,i]),i},ts(t,e,r,n){let i=this;const a=t.length;if(!a)return i;for(let s=0;s<a-1;s++)i=i.tt(t[s]);return i.tt(t[a-1],e,r,n)},tt(t,e,r,n){n=n||mi.groups;const i=this;if(e&&e.j)return i.j[t]=e,e;const a=e;let s,o=i.go(t);if(o?(s=new mi,Object.assign(s.j,o.j),s.jr.push.apply(s.jr,o.jr),s.jd=o.jd,s.t=o.t):s=new mi,a){if(n)if(s.t&&typeof s.t=="string"){const l=Object.assign(Ire(s.t,n),r);Su(a,l,n)}else r&&Su(a,r,n);s.t=a}return i.j[t]=s,s}};const ft=(t,e,r,n,i)=>t.ta(e,r,n,i),kr=(t,e,r,n,i)=>t.tr(e,r,n,i),Cj=(t,e,r,n,i)=>t.ts(e,r,n,i),we=(t,e,r,n,i)=>t.tt(e,r,n,i),Os="WORD",Tk="UWORD",_O="ASCIINUMERICAL",AO="ALPHANUMERICAL",Ip="LOCALHOST",jk="TLD",Mk="UTLD",zv="SCHEME",Wc="SLASH_SCHEME",G3="NUM",Pk="WS",H3="NL",Gh="OPENBRACE",Hh="CLOSEBRACE",X0="OPENBRACKET",Q0="CLOSEBRACKET",J0="OPENPAREN",Z0="CLOSEPAREN",ey="OPENANGLEBRACKET",ty="CLOSEANGLEBRACKET",ry="FULLWIDTHLEFTPAREN",ny="FULLWIDTHRIGHTPAREN",iy="LEFTCORNERBRACKET",ay="RIGHTCORNERBRACKET",sy="LEFTWHITECORNERBRACKET",oy="RIGHTWHITECORNERBRACKET",ly="FULLWIDTHLESSTHAN",uy="FULLWIDTHGREATERTHAN",cy="AMPERSAND",dy="APOSTROPHE",fy="ASTERISK",Lo="AT",hy="BACKSLASH",py="BACKTICK",my="CARET",$o="COLON",W3="COMMA",gy="DOLLAR",es="DOT",vy="EQUALS",q3="EXCLAMATION",Qi="HYPHEN",Wh="PERCENT",yy="PIPE",xy="PLUS",by="POUND",qh="QUERY",K3="QUOTE",RO="FULLWIDTHMIDDLEDOT",Y3="SEMI",ts="SLASH",Kh="TILDE",wy="UNDERSCORE",DO="EMOJI",Sy="SYM";var OO=Object.freeze({__proto__:null,ALPHANUMERICAL:AO,AMPERSAND:cy,APOSTROPHE:dy,ASCIINUMERICAL:_O,ASTERISK:fy,AT:Lo,BACKSLASH:hy,BACKTICK:py,CARET:my,CLOSEANGLEBRACKET:ty,CLOSEBRACE:Hh,CLOSEBRACKET:Q0,CLOSEPAREN:Z0,COLON:$o,COMMA:W3,DOLLAR:gy,DOT:es,EMOJI:DO,EQUALS:vy,EXCLAMATION:q3,FULLWIDTHGREATERTHAN:uy,FULLWIDTHLEFTPAREN:ry,FULLWIDTHLESSTHAN:ly,FULLWIDTHMIDDLEDOT:RO,FULLWIDTHRIGHTPAREN:ny,HYPHEN:Qi,LEFTCORNERBRACKET:iy,LEFTWHITECORNERBRACKET:sy,LOCALHOST:Ip,NL:H3,NUM:G3,OPENANGLEBRACKET:ey,OPENBRACE:Gh,OPENBRACKET:X0,OPENPAREN:J0,PERCENT:Wh,PIPE:yy,PLUS:xy,POUND:by,QUERY:qh,QUOTE:K3,RIGHTCORNERBRACKET:ay,RIGHTWHITECORNERBRACKET:oy,SCHEME:zv,SEMI:Y3,SLASH:ts,SLASH_SCHEME:Wc,SYM:Sy,TILDE:Kh,TLD:jk,UNDERSCORE:wy,UTLD:Mk,UWORD:Tk,WORD:Os,WS:Pk});const As=/[a-z]/,oh=/\p{L}/u,mS=/\p{Emoji}/u,Rs=/\d/,gS=/\s/,Nj="\r",vS=`
`,Lre="",Bre="",yS="";let nv=null,iv=null;function Fre(t=[]){const e={};mi.groups=e;const r=new mi;nv==null&&(nv=Ej(_re)),iv==null&&(iv=Ej(Are)),we(r,"'",dy),we(r,"{",Gh),we(r,"}",Hh),we(r,"[",X0),we(r,"]",Q0),we(r,"(",J0),we(r,")",Z0),we(r,"<",ey),we(r,">",ty),we(r,"",ry),we(r,"",ny),we(r,"",iy),we(r,"",ay),we(r,"",sy),we(r,"",oy),we(r,"",ly),we(r,"",uy),we(r,"&",cy),we(r,"*",fy),we(r,"@",Lo),we(r,"`",py),we(r,"^",my),we(r,":",$o),we(r,",",W3),we(r,"$",gy),we(r,".",es),we(r,"=",vy),we(r,"!",q3),we(r,"-",Qi),we(r,"%",Wh),we(r,"|",yy),we(r,"+",xy),we(r,"#",by),we(r,"?",qh),we(r,'"',K3),we(r,"/",ts),we(r,";",Y3),we(r,"~",Kh),we(r,"_",wy),we(r,"\\",hy),we(r,"",RO);const n=kr(r,Rs,G3,{[kk]:!0});kr(n,Rs,n);const i=kr(n,As,_O,{[Uh]:!0}),a=kr(n,oh,AO,{[Ch]:!0}),s=kr(r,As,Os,{[Ck]:!0});kr(s,Rs,i),kr(s,As,s),kr(i,Rs,i),kr(i,As,i);const o=kr(r,oh,Tk,{[Nk]:!0});kr(o,As),kr(o,Rs,a),kr(o,oh,o),kr(a,Rs,a),kr(a,As),kr(a,oh,a);const l=we(r,vS,H3,{[pS]:!0}),u=we(r,Nj,Pk,{[pS]:!0}),c=kr(r,gS,Pk,{[pS]:!0});we(r,yS,c),we(u,vS,l),we(u,yS,c),kr(u,gS,c),we(c,Nj),we(c,vS),kr(c,gS,c),we(c,yS,c);const d=kr(r,mS,DO,{[PO]:!0});we(d,"#"),kr(d,mS,d),we(d,Lre,d);const h=we(d,Bre);we(h,"#"),kr(h,mS,d);const m=[[As,s],[Rs,i]],v=[[As,null],[oh,o],[Rs,a]];for(let x=0;x<nv.length;x++)Mo(r,nv[x],jk,Os,m);for(let x=0;x<iv.length;x++)Mo(r,iv[x],Mk,Tk,v);Su(jk,{tld:!0,ascii:!0},e),Su(Mk,{utld:!0,alpha:!0},e),Mo(r,"file",zv,Os,m),Mo(r,"mailto",zv,Os,m),Mo(r,"http",Wc,Os,m),Mo(r,"https",Wc,Os,m),Mo(r,"ftp",Wc,Os,m),Mo(r,"ftps",Wc,Os,m),Su(zv,{scheme:!0,ascii:!0},e),Su(Wc,{slashscheme:!0,ascii:!0},e),t=t.sort((x,y)=>x[0]>y[0]?1:-1);for(let x=0;x<t.length;x++){const y=t[x][0],S=t[x][1]?{[Rre]:!0}:{[Dre]:!0};y.indexOf("-")>=0?S[Ek]=!0:As.test(y)?Rs.test(y)?S[Uh]=!0:S[Ck]=!0:S[kk]=!0,Cj(r,y,y,S)}return Cj(r,"localhost",Ip,{ascii:!0}),r.jd=new mi(Sy),{start:r,tokens:Object.assign({groups:e},OO)}}function IO(t,e){const r=zre(e.replace(/[A-Z]/g,o=>o.toLowerCase())),n=r.length,i=[];let a=0,s=0;for(;s<n;){let o=t,l=null,u=0,c=null,d=-1,h=-1;for(;s<n&&(l=o.go(r[s]));)o=l,o.accepts()?(d=0,h=0,c=o):d>=0&&(d+=r[s].length,h++),u+=r[s].length,a+=r[s].length,s++;a-=d,s-=h,u-=d,i.push({t:c.t,v:e.slice(a-u,a),s:a-u,e:a})}return i}function zre(t){const e=[],r=t.length;let n=0;for(;n<r;){let i=t.charCodeAt(n),a,s=i<55296||i>56319||n+1===r||(a=t.charCodeAt(n+1))<56320||a>57343?t[n]:t.slice(n,n+2);e.push(s),n+=s.length}return e}function Mo(t,e,r,n,i){let a;const s=e.length;for(let o=0;o<s-1;o++){const l=e[o];t.j[l]?a=t.j[l]:(a=new mi(n),a.jr=i.slice(),t.j[l]=a),t=a}return a=new mi(r),a.jr=i.slice(),t.j[e[s-1]]=a,a}function Ej(t){const e=[],r=[];let n=0,i="0123456789";for(;n<t.length;){let a=0;for(;i.indexOf(t[n+a])>=0;)a++;if(a>0){e.push(r.join(""));for(let s=parseInt(t.substring(n,n+a),10);s>0;s--)r.pop();n+=a}else r.push(t[n]),n++}return e}const Lp={defaultProtocol:"http",events:null,format:Tj,formatHref:Tj,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function X3(t,e=null){let r=Object.assign({},Lp);t&&(r=Object.assign(r,t instanceof X3?t.o:t));const n=r.ignoreTags,i=[];for(let a=0;a<n.length;a++)i.push(n[a].toUpperCase());this.o=r,e&&(this.defaultRender=e),this.ignoreTags=i}X3.prototype={o:Lp,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,r){const n=e!=null;let i=this.o[t];return i&&(typeof i=="object"?(i=r.t in i?i[r.t]:Lp[t],typeof i=="function"&&n&&(i=i(e,r))):typeof i=="function"&&n&&(i=i(e,r.t,r)),i)},getObj(t,e,r){let n=this.o[t];return typeof n=="function"&&e!=null&&(n=n(e,r.t,r)),n},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function Tj(t){return t}function LO(t,e){this.t="token",this.v=t,this.tk=e}LO.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),r=t.get("truncate",e,this),n=t.get("format",e,this);return r&&n.length>r?n.substring(0,r)+"":n},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Lp.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,r=this.toHref(t.get("defaultProtocol")),n=t.get("formatHref",r,this),i=t.get("tagName",r,e),a=this.toFormattedString(t),s={},o=t.get("className",r,e),l=t.get("target",r,e),u=t.get("rel",r,e),c=t.getObj("attributes",r,e),d=t.getObj("events",r,e);return s.href=n,o&&(s.class=o),l&&(s.target=l),u&&(s.rel=u),c&&Object.assign(s,c),{tagName:i,attributes:s,content:a,eventListeners:d}}};function Mx(t,e){class r extends LO{constructor(i,a){super(i,a),this.t=t}}for(const n in e)r.prototype[n]=e[n];return r.t=t,r}const jj=Mx("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),Mj=Mx("text"),Vre=Mx("nl"),av=Mx("url",{isLink:!0,toHref(t=Lp.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Ip&&t[1].t===$o}}),Ki=t=>new mi(t);function $re({groups:t}){const e=t.domain.concat([cy,fy,Lo,hy,py,my,gy,vy,Qi,G3,Wh,yy,xy,by,ts,Sy,Kh,wy]),r=[dy,$o,W3,es,q3,Wh,qh,K3,Y3,ey,ty,Gh,Hh,Q0,X0,J0,Z0,ry,ny,iy,ay,sy,oy,ly,uy],n=[cy,dy,fy,hy,py,my,gy,vy,Qi,Gh,Hh,Wh,yy,xy,by,qh,ts,Sy,Kh,wy],i=Ki(),a=we(i,Kh);ft(a,n,a),ft(a,t.domain,a);const s=Ki(),o=Ki(),l=Ki();ft(i,t.domain,s),ft(i,t.scheme,o),ft(i,t.slashscheme,l),ft(s,n,a),ft(s,t.domain,s);const u=we(s,Lo);we(a,Lo,u),we(o,Lo,u),we(l,Lo,u);const c=we(a,es);ft(c,n,a),ft(c,t.domain,a);const d=Ki();ft(u,t.domain,d),ft(d,t.domain,d);const h=we(d,es);ft(h,t.domain,d);const m=Ki(jj);ft(h,t.tld,m),ft(h,t.utld,m),we(u,Ip,m);const v=we(d,Qi);we(v,Qi,v),ft(v,t.domain,d),ft(m,t.domain,d),we(m,es,h),we(m,Qi,v);const x=we(m,$o);ft(x,t.numeric,jj);const y=we(s,Qi),b=we(s,es);we(y,Qi,y),ft(y,t.domain,s),ft(b,n,a),ft(b,t.domain,s);const S=Ki(av);ft(b,t.tld,S),ft(b,t.utld,S),ft(S,t.domain,s),ft(S,n,a),we(S,es,b),we(S,Qi,y),we(S,Lo,u);const w=we(S,$o),k=Ki(av);ft(w,t.numeric,k);const N=Ki(av),T=Ki();ft(N,e,N),ft(N,r,T),ft(T,e,N),ft(T,r,T),we(S,ts,N),we(k,ts,N);const j=we(o,$o),M=we(l,$o),A=we(M,ts),P=we(A,ts);ft(o,t.domain,s),we(o,es,b),we(o,Qi,y),ft(l,t.domain,s),we(l,es,b),we(l,Qi,y),ft(j,t.domain,N),we(j,ts,N),we(j,qh,N),ft(P,t.domain,N),ft(P,e,N),we(P,ts,N);const D=[[Gh,Hh],[X0,Q0],[J0,Z0],[ey,ty],[ry,ny],[iy,ay],[sy,oy],[ly,uy]];for(let R=0;R<D.length;R++){const[I,U]=D[R],B=we(N,I);we(T,I,B),we(B,U,N);const z=Ki(av);ft(B,e,z);const F=Ki();ft(B,r),ft(z,e,z),ft(z,r,F),ft(F,e,z),ft(F,r,F),we(z,U,N),we(F,U,N)}return we(i,Ip,S),we(i,H3,Vre),{start:i,tokens:OO}}function Ure(t,e,r){let n=r.length,i=0,a=[],s=[];for(;i<n;){let o=t,l=null,u=null,c=0,d=null,h=-1;for(;i<n&&!(l=o.go(r[i].t));)s.push(r[i++]);for(;i<n&&(u=l||o.go(r[i].t));)l=null,o=u,o.accepts()?(h=0,d=o):h>=0&&h++,i++,c++;if(h<0)i-=c,i<n&&(s.push(r[i]),i++);else{s.length>0&&(a.push(xS(Mj,e,s)),s=[]),i-=h,c-=h;const m=d.t,v=r.slice(i-c,i);a.push(xS(m,e,v))}}return s.length>0&&a.push(xS(Mj,e,s)),a}function xS(t,e,r){const n=r[0].s,i=r[r.length-1].e,a=e.slice(n,i);return new t(a,r)}const Gre=typeof console<"u"&&console&&console.warn||(()=>{}),Hre="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",tr={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Wre(){return mi.groups={},tr.scanner=null,tr.parser=null,tr.tokenQueue=[],tr.pluginQueue=[],tr.customSchemes=[],tr.initialized=!1,tr}function Pj(t,e=!1){if(tr.initialized&&Gre(`linkifyjs: already initialized - will not register custom scheme "${t}" ${Hre}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);tr.customSchemes.push([t,e])}function qre(){tr.scanner=Fre(tr.customSchemes);for(let t=0;t<tr.tokenQueue.length;t++)tr.tokenQueue[t][1]({scanner:tr.scanner});tr.parser=$re(tr.scanner.tokens);for(let t=0;t<tr.pluginQueue.length;t++)tr.pluginQueue[t][1]({scanner:tr.scanner,parser:tr.parser});return tr.initialized=!0,tr}function Q3(t){return tr.initialized||qre(),Ure(tr.parser.start,t,IO(tr.scanner.start,t))}Q3.scan=IO;function BO(t,e=null,r=null){if(e&&typeof e=="object"){if(r)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);r=e,e=null}const n=new X3(r),i=Q3(t),a=[];for(let s=0;s<i.length;s++){const o=i[s];o.isLink&&(!e||o.t===e)&&n.check(o)&&a.push(o.toFormattedObject(n))}return a}var J3="[\0- -\u2029]",Kre=new RegExp(J3),Yre=new RegExp(`${J3}$`),Xre=new RegExp(J3,"g");function Qre(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function Jre(t){return new cr({key:new Rr("autolink"),appendTransaction:(e,r,n)=>{const i=e.some(u=>u.docChanged)&&!r.doc.eq(n.doc),a=e.some(u=>u.getMeta("preventAutolink"));if(!i||a)return;const{tr:s}=n,o=ZD(r.doc,[...e]);if(sO(o).forEach(({newRange:u})=>{const c=VZ(n.doc,u,m=>m.isTextblock);let d,h;if(c.length>1)d=c[0],h=n.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ");else if(c.length){const m=n.doc.textBetween(u.from,u.to," "," ");if(!Yre.test(m))return;d=c[0],h=n.doc.textBetween(d.pos,u.to,void 0," ")}if(d&&h){const m=h.split(Kre).filter(Boolean);if(m.length<=0)return!1;const v=m[m.length-1],x=d.pos+h.lastIndexOf(v);if(!v)return!1;const y=Q3(v).map(b=>b.toObject(t.defaultProtocol));if(!Qre(y))return!1;y.filter(b=>b.isLink).map(b=>({...b,from:x+b.start+1,to:x+b.end+1})).filter(b=>n.schema.marks.code?!n.doc.rangeHasMark(b.from,b.to,n.schema.marks.code):!0).filter(b=>t.validate(b.value)).filter(b=>t.shouldAutoLink(b.value)).forEach(b=>{F3(b.from,b.to,n.doc).some(S=>S.mark.type===t.type)||s.addMark(b.from,b.to,t.type.create({href:b.href}))})}}),!!s.steps.length)return s}})}function Zre(t){return new cr({key:new Rr("handleClickLink"),props:{handleClick:(e,r,n)=>{var i,a;if(n.button!==0||!e.editable)return!1;let s=null;if(n.target instanceof HTMLAnchorElement)s=n.target;else{const l=n.target;if(!l)return!1;const u=t.editor.view.dom;s=l.closest("a"),s&&!u.contains(s)&&(s=null)}if(!s)return!1;let o=!1;if(t.enableClickSelection&&(o=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){const l=aO(e.state,t.type.name),u=(i=s.href)!=null?i:l.href,c=(a=s.target)!=null?a:l.target;u&&(window.open(u,c),o=!0)}return o}}})}function ene(t){return new cr({key:new Rr("handlePasteLink"),props:{handlePaste:(e,r,n)=>{const{shouldAutoLink:i}=t,{state:a}=e,{selection:s}=a,{empty:o}=s;if(o)return!1;let l="";n.content.forEach(c=>{l+=c.textContent});const u=BO(l,{defaultProtocol:t.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!u||i!==void 0&&!i(u.value)?!1:t.editor.commands.setMark(t.type,{href:u.href})}}})}function au(t,e){const r=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(n=>{const i=typeof n=="string"?n:n.scheme;i&&r.push(i)}),!t||t.replace(Xre,"").match(new RegExp(`^(?:(?:${r.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var tne=rc.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){Pj(t);return}Pj(t.scheme,t.optionalSlashes)})},onDestroy(){Wre()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!au(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),r=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||r&&!t.includes("@"))return!0;const i=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:r=>!!au(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!au(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",ur(this.options.HTMLAttributes,t),0]:["a",ur(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var r;const n=((r=t.attrs)==null?void 0:r.href)||"";return`[${e.renderChildren(t)}](${n})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:r}=t;return this.options.isAllowedUri(r,{defaultValidate:n=>!!au(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:r}=t||{};return r&&!this.options.isAllowedUri(r,{defaultValidate:n=>!!au(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Ku({find:t=>{const e=[];if(t){const{protocols:r,defaultProtocol:n}=this.options,i=BO(t).filter(a=>a.isLink&&this.options.isAllowedUri(a.value,{defaultValidate:s=>!!au(s,r),protocols:r,defaultProtocol:n}));i.length&&i.forEach(a=>{this.options.shouldAutoLink(a.value)&&e.push({text:a.value,data:{href:a.href},index:a.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:r}=this.options;return this.options.autolink&&t.push(Jre({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:i=>!!au(i,e),protocols:e,defaultProtocol:r}),shouldAutoLink:this.options.shouldAutoLink})),t.push(Zre({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(ene({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),rne=Object.defineProperty,nne=(t,e)=>{for(var r in e)rne(t,r,{get:e[r],enumerable:!0})},ine="listItem",_j="textStyle",Aj=/^\s*([-+*])\s$/,FO=Ci.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",ur(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ine,this.editor.getAttributes(_j)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Ud({find:Aj,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ud({find:Aj,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(_j),editor:this.editor})),[t]}}),zO=Ci.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",ur(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let r=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(i=>i.type==="paragraph"))r=e.parseChildren(t.tokens);else{const i=t.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(r=[{type:"paragraph",content:e.parseInline(i.tokens)}],t.tokens.length>1){const s=t.tokens.slice(1),o=e.parseChildren(s);r.push(...o)}}else r=e.parseChildren(t.tokens)}return r.length===0&&(r=[{type:"paragraph",content:[]}]),{type:"listItem",content:r}},renderMarkdown:(t,e,r)=>U3(t,e,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",r),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),ane={};nne(ane,{findListItemPos:()=>fm,getNextListDepth:()=>Z3,handleBackspace:()=>_k,handleDelete:()=>Ak,hasListBefore:()=>VO,hasListItemAfter:()=>sne,hasListItemBefore:()=>$O,listItemHasSubList:()=>UO,nextListIsDeeper:()=>GO,nextListIsHigher:()=>HO});var fm=(t,e)=>{const{$from:r}=e.selection,n=Ur(t,e.schema);let i=null,a=r.depth,s=r.pos,o=null;for(;a>0&&o===null;)i=r.node(a),i.type===n?o=a:(a-=1,s-=1);return o===null?null:{$pos:e.doc.resolve(s),depth:o}},Z3=(t,e)=>{const r=fm(t,e);if(!r)return!1;const[,n]=QZ(e,t,r.$pos.pos+4);return n},VO=(t,e,r)=>{const{$anchor:n}=t.selection,i=Math.max(0,n.pos-2),a=t.doc.resolve(i).node();return!(!a||!r.includes(a.type.name))},$O=(t,e)=>{var r;const{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-2);return!(i.index()===0||((r=i.nodeBefore)==null?void 0:r.type.name)!==t)},UO=(t,e,r)=>{if(!r)return!1;const n=Ur(t,e.schema);let i=!1;return r.descendants(a=>{a.type===n&&(i=!0)}),i},_k=(t,e,r)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!Sl(t.state,e)&&VO(t.state,e,r)){const{$anchor:o}=t.state.selection,l=t.state.doc.resolve(o.before()-1),u=[];l.node().descendants((h,m)=>{h.type.name===e&&u.push({node:h,pos:m})});const c=u.at(-1);if(!c)return!1;const d=t.state.doc.resolve(l.start()+c.pos+1);return t.chain().cut({from:o.start()-1,to:o.end()+1},d.end()).joinForward().run()}if(!Sl(t.state,e)||!tee(t.state))return!1;const n=fm(e,t.state);if(!n)return!1;const a=t.state.doc.resolve(n.$pos.pos-2).node(n.depth),s=UO(e,t.state,a);return $O(e,t.state)&&!s?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},GO=(t,e)=>{const r=Z3(t,e),n=fm(t,e);return!n||!r?!1:r>n.depth},HO=(t,e)=>{const r=Z3(t,e),n=fm(t,e);return!n||!r?!1:r<n.depth},Ak=(t,e)=>{if(!Sl(t.state,e)||!eee(t.state,e))return!1;const{selection:r}=t.state,{$from:n,$to:i}=r;return!r.empty&&n.sameParent(i)?!1:GO(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():HO(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},sne=(t,e)=>{var r;const{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-n.parentOffset-2);return!(i.index()===i.parent.childCount-1||((r=i.nodeAfter)==null?void 0:r.type.name)!==t)},WO=Dr.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r})=>{t.state.schema.nodes[r]!==void 0&&Ak(t,r)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r})=>{t.state.schema.nodes[r]!==void 0&&Ak(t,r)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{t.state.schema.nodes[r]!==void 0&&_k(t,r,n)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{t.state.schema.nodes[r]!==void 0&&_k(t,r,n)&&(e=!0)}),e}}}}),Rj=/^(\s*)(\d+)\.\s+(.*)$/,one=/^\s/;function lne(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r],a=i.match(Rj);if(!a)break;const[,s,o,l]=a,u=s.length;let c=l,d=r+1;const h=[i];for(;d<t.length;){const m=t[d];if(m.match(Rj))break;if(m.trim()==="")h.push(m),c+=`
`,d+=1;else if(m.match(one))h.push(m),c+=`
${m.slice(u+2)}`,d+=1;else break}e.push({indent:u,number:parseInt(o,10),content:c.trim(),raw:h.join(`
`)}),n=d,r=d}return[e,n]}function qO(t,e,r){var n;const i=[];let a=0;for(;a<t.length;){const s=t[a];if(s.indent===e){const o=s.content.split(`
`),l=((n=o[0])==null?void 0:n.trim())||"",u=[];l&&u.push({type:"paragraph",raw:l,tokens:r.inlineTokens(l)});const c=o.slice(1).join(`
`).trim();if(c){const m=r.blockTokens(c);u.push(...m)}let d=a+1;const h=[];for(;d<t.length&&t[d].indent>e;)h.push(t[d]),d+=1;if(h.length>0){const m=Math.min(...h.map(x=>x.indent)),v=qO(h,m,r);u.push({type:"list",ordered:!0,start:h[0].number,items:v,raw:h.map(x=>x.raw).join(`
`)})}i.push({type:"list_item",raw:s.raw,tokens:u}),a=d}else a+=1}return i}function une(t,e){return t.map(r=>{if(r.type!=="list_item")return e.parseChildren([r])[0];const n=[];return r.tokens&&r.tokens.length>0&&r.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")n.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){const a=e.parseChildren([i]);n.push({type:"paragraph",content:a})}else{const a=e.parseChildren([i]);a.length>0&&n.push(...a)}}),{type:"listItem",content:n}})}var cne="listItem",Dj="textStyle",Oj=/^(\d+)\.\s$/,KO=Ci.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...r}=t;return e===1?["ol",ur(this.options.HTMLAttributes,r),0]:["ol",ur(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const r=t.start||1,n=t.items?une(t.items,e):[];return r!==1?{type:"orderedList",attrs:{start:r},content:n}:{type:"orderedList",content:n}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),r=e==null?void 0:e.index;return r!==void 0?r:-1},tokenize:(t,e,r)=>{var n;const i=t.split(`
`),[a,s]=lne(i);if(a.length===0)return;const o=qO(a,0,r);return o.length===0?void 0:{type:"list",ordered:!0,start:((n=a[0])==null?void 0:n.number)||1,items:o,raw:i.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(cne,this.editor.getAttributes(Dj)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Ud({find:Oj,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ud({find:Oj,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Dj)}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1],editor:this.editor})),[t]}}),dne=/^\s*(\[([( |x])?\])\s$/,fne=Ci.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",ur(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const r=[];if(t.tokens&&t.tokens.length>0?r.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?r.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):r.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const n=e.parseChildren(t.nestedTokens);r.push(...n)}return e.createNode("taskItem",{checked:t.checked||!1},r)},renderMarkdown:(t,e)=>{var r;const i=`- [${(r=t.attrs)!=null&&r.checked?"x":" "}] `;return U3(t,e,i)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:r,editor:n})=>{const i=document.createElement("li"),a=document.createElement("label"),s=document.createElement("span"),o=document.createElement("input"),l=document.createElement("div"),u=d=>{var h,m;o.ariaLabel=((m=(h=this.options.a11y)==null?void 0:h.checkboxLabel)==null?void 0:m.call(h,d,o.checked))||`Task item checkbox for ${d.textContent||"empty task item"}`};u(t),a.contentEditable="false",o.type="checkbox",o.addEventListener("mousedown",d=>d.preventDefault()),o.addEventListener("change",d=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){o.checked=!o.checked;return}const{checked:h}=d.target;n.isEditable&&typeof r=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:m})=>{const v=r();if(typeof v!="number")return!1;const x=m.doc.nodeAt(v);return m.setNodeMarkup(v,void 0,{...x==null?void 0:x.attrs,checked:h}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,h)||(o.checked=!o.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([d,h])=>{i.setAttribute(d,h)}),i.dataset.checked=t.attrs.checked,o.checked=t.attrs.checked,a.append(o,s),i.append(a,l),Object.entries(e).forEach(([d,h])=>{i.setAttribute(d,h)});let c=new Set(Object.keys(e));return{dom:i,contentDOM:l,update:d=>{if(d.type!==this.type)return!1;i.dataset.checked=d.attrs.checked,o.checked=d.attrs.checked,u(d);const h=n.extensionManager.attributes,m=Op(d,h),v=new Set(Object.keys(m)),x=this.options.HTMLAttributes;return c.forEach(y=>{v.has(y)||(y in x?i.setAttribute(y,x[y]):i.removeAttribute(y))}),Object.entries(m).forEach(([y,b])=>{b==null?y in x?i.setAttribute(y,x[y]):i.removeAttribute(y):i.setAttribute(y,b)}),c=v,!0}}}},addInputRules(){return[Ud({find:dne,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),hne=Ci.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",ur(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const r=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return r!==void 0?r:-1},tokenize(t,e,r){const n=a=>{const s=wk(a,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,l)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:r.inlineTokens(o.mainContent),nestedTokens:l}),customNestedParser:n},r);return s?[{type:"taskList",raw:s.raw,items:s.items}]:r.blockTokens(a)},i=wk(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,s)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:r.inlineTokens(a.mainContent),nestedTokens:s}),customNestedParser:n},r);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Dr.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(FO.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(zO.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(WO.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(KO.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(fne.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(hne.configure(this.options.taskList)),t}});var pne=Ci.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",ur(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const r=t.tokens||[];return r.length===1&&r[0].type==="image"?e.parseChildren([r[0]]):e.createNode("paragraph",void 0,e.parseInline(r))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),mne=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,gne=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,vne=rc.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",ur(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[$d({find:mne,type:this.type})]},addPasteRules(){return[Ku({find:gne,type:this.type})]}}),yne=Ci.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),xne=rc.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",ur(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,r){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const a=i[2].trim();return{type:"underline",raw:i[0],text:a,tokens:r.inlineTokens(a)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function bne(t={}){return new cr({view(e){return new wne(e,t)}})}class wne{constructor(e,r){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=r.width)!==null&&n!==void 0?n:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let a=s=>{this[i](s)};return e.dom.addEventListener(i,a),{name:i,handler:a}})}destroy(){this.handlers.forEach(({name:e,handler:r})=>this.editorView.dom.removeEventListener(e,r))}update(e,r){this.cursorPos!=null&&r.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),r=!e.parent.inlineContent,n,i=this.editorView.dom,a=i.getBoundingClientRect(),s=a.width/i.offsetWidth,o=a.height/i.offsetHeight;if(r){let d=e.nodeBefore,h=e.nodeAfter;if(d||h){let m=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(m){let v=m.getBoundingClientRect(),x=d?v.bottom:v.top;d&&h&&(x=(x+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let y=this.width/2*o;n={left:v.left,right:v.right,top:x-y,bottom:x+y}}}}if(!n){let d=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*s;n={left:d.left-h,right:d.left+h,top:d.top,bottom:d.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let u,c;if(!l||l==document.body&&getComputedStyle(l).position=="static")u=-pageXOffset,c=-pageYOffset;else{let d=l.getBoundingClientRect(),h=d.width/l.offsetWidth,m=d.height/l.offsetHeight;u=d.left-l.scrollLeft*h,c=d.top-l.scrollTop*m}this.element.style.left=(n.left-u)/s+"px",this.element.style.top=(n.top-c)/o+"px",this.element.style.width=(n.right-n.left)/s+"px",this.element.style.height=(n.bottom-n.top)/o+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),i=n&&n.type.spec.disableDropCursor,a=typeof i=="function"?i(this.editorView,r,e):i;if(r&&!a){let s=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=X7(this.editorView.state.doc,s,this.editorView.dragging.slice);o!=null&&(s=o)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class Nr extends ht{constructor(e){super(e,e)}map(e,r){let n=e.resolve(r.map(this.head));return Nr.valid(n)?new Nr(n):ht.near(n)}content(){return Ae.empty}eq(e){return e instanceof Nr&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Nr(e.resolve(r.pos))}getBookmark(){return new e4(this.anchor)}static valid(e){let r=e.parent;if(r.isTextblock||!Sne(e)||!kne(e))return!1;let n=r.type.spec.allowGapCursor;if(n!=null)return n;let i=r.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,r,n=!1){e:for(;;){if(!n&&Nr.valid(e))return e;let i=e.pos,a=null;for(let s=e.depth;;s--){let o=e.node(s);if(r>0?e.indexAfter(s)<o.childCount:e.index(s)>0){a=o.child(r>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=r;let l=e.doc.resolve(i);if(Nr.valid(l))return l}for(;;){let s=r>0?a.firstChild:a.lastChild;if(!s){if(a.isAtom&&!a.isText&&!Ye.isSelectable(a)){e=e.doc.resolve(i+a.nodeSize*r),n=!1;continue e}break}a=s,i+=r;let o=e.doc.resolve(i);if(Nr.valid(o))return o}return null}}}Nr.prototype.visible=!1;Nr.findFrom=Nr.findGapCursorFrom;ht.jsonID("gapcursor",Nr);class e4{constructor(e){this.pos=e}map(e){return new e4(e.map(this.pos))}resolve(e){let r=e.resolve(this.pos);return Nr.valid(r)?new Nr(r):ht.near(r)}}function YO(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function Sne(t){for(let e=t.depth;e>=0;e--){let r=t.index(e),n=t.node(e);if(r==0){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||YO(i.type))return!0;if(i.inlineContent)return!1}}return!0}function kne(t){for(let e=t.depth;e>=0;e--){let r=t.indexAfter(e),n=t.node(e);if(r==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||YO(i.type))return!0;if(i.inlineContent)return!1}}return!0}function Cne(){return new cr({props:{decorations:jne,createSelectionBetween(t,e,r){return e.pos==r.pos&&Nr.valid(r)?new Nr(r):null},handleClick:Ene,handleKeyDown:Nne,handleDOMEvents:{beforeinput:Tne}}})}const Nne=HD({ArrowLeft:sv("horiz",-1),ArrowRight:sv("horiz",1),ArrowUp:sv("vert",-1),ArrowDown:sv("vert",1)});function sv(t,e){const r=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,i,a){let s=n.selection,o=e>0?s.$to:s.$from,l=s.empty;if(s instanceof at){if(!a.endOfTextblock(r)||o.depth==0)return!1;l=!1,o=n.doc.resolve(e>0?o.after():o.before())}let u=Nr.findGapCursorFrom(o,e,l);return u?(i&&i(n.tr.setSelection(new Nr(u))),!0):!1}}function Ene(t,e,r){if(!t||!t.editable)return!1;let n=t.state.doc.resolve(e);if(!Nr.valid(n))return!1;let i=t.posAtCoords({left:r.clientX,top:r.clientY});return i&&i.inside>-1&&Ye.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Nr(n))),!0)}function Tne(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Nr))return!1;let{$from:r}=t.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(t.state.schema.nodes.text);if(!n)return!1;let i=be.empty;for(let s=n.length-1;s>=0;s--)i=be.from(n[s].createAndFill(null,i));let a=t.state.tr.replace(r.pos,r.pos,new Ae(i,0,0));return a.setSelection(at.near(a.doc.resolve(r.pos+1))),t.dispatch(a),!1}function jne(t){if(!(t.selection instanceof Nr))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",sr.create(t.doc,[$n.widget(t.selection.head,e,{key:"gapcursor"})])}var ky=200,gn=function(){};gn.prototype.append=function(e){return e.length?(e=gn.from(e),!this.length&&e||e.length<ky&&this.leafAppend(e)||this.length<ky&&e.leafPrepend(this)||this.appendInner(e)):this};gn.prototype.prepend=function(e){return e.length?gn.from(e).append(this):this};gn.prototype.appendInner=function(e){return new Mne(this,e)};gn.prototype.slice=function(e,r){return e===void 0&&(e=0),r===void 0&&(r=this.length),e>=r?gn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,r))};gn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};gn.prototype.forEach=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length),r<=n?this.forEachInner(e,r,n,0):this.forEachInvertedInner(e,r,n,0)};gn.prototype.map=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length);var i=[];return this.forEach(function(a,s){return i.push(e(a,s))},r,n),i};gn.from=function(e){return e instanceof gn?e:e&&e.length?new XO(e):gn.empty};var XO=function(t){function e(n){t.call(this),this.values=n}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,a){return i==0&&a==this.length?this:new e(this.values.slice(i,a))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,a,s,o){for(var l=a;l<s;l++)if(i(this.values[l],o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,a,s,o){for(var l=a-1;l>=s;l--)if(i(this.values[l],o+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=ky)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=ky)return new e(i.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(e.prototype,r),e}(gn);gn.empty=new XO([]);var Mne=function(t){function e(r,n){t.call(this),this.left=r,this.right=n,this.length=r.length+n.length,this.depth=Math.max(r.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,i,a,s){var o=this.left.length;if(i<o&&this.left.forEachInner(n,i,Math.min(a,o),s)===!1||a>o&&this.right.forEachInner(n,Math.max(i-o,0),Math.min(this.length,a)-o,s+o)===!1)return!1},e.prototype.forEachInvertedInner=function(n,i,a,s){var o=this.left.length;if(i>o&&this.right.forEachInvertedInner(n,i-o,Math.max(a,o)-o,s+o)===!1||a<o&&this.left.forEachInvertedInner(n,Math.min(i,o),a,s)===!1)return!1},e.prototype.sliceInner=function(n,i){if(n==0&&i==this.length)return this;var a=this.left.length;return i<=a?this.left.slice(n,i):n>=a?this.right.slice(n-a,i-a):this.left.slice(n,a).append(this.right.slice(0,i-a))},e.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new e(i,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e}(gn);const Pne=500;class Ma{constructor(e,r){this.items=e,this.eventCount=r}popEvent(e,r){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let i,a;r&&(i=this.remapping(n,this.items.length),a=i.maps.length);let s=e.tr,o,l,u=[],c=[];return this.items.forEach((d,h)=>{if(!d.step){i||(i=this.remapping(n,h+1),a=i.maps.length),a--,c.push(d);return}if(i){c.push(new rs(d.map));let m=d.step.map(i.slice(a)),v;m&&s.maybeStep(m).doc&&(v=s.mapping.maps[s.mapping.maps.length-1],u.push(new rs(v,void 0,void 0,u.length+c.length))),a--,v&&i.appendMap(v,a)}else s.maybeStep(d.step);if(d.selection)return o=i?d.selection.map(i.slice(a)):d.selection,l=new Ma(this.items.slice(0,n).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:o}}addTransform(e,r,n,i){let a=[],s=this.eventCount,o=this.items,l=!i&&o.length?o.get(o.length-1):null;for(let c=0;c<e.steps.length;c++){let d=e.steps[c].invert(e.docs[c]),h=new rs(e.mapping.maps[c],d,r),m;(m=l&&l.merge(h))&&(h=m,c?a.pop():o=o.slice(0,o.length-1)),a.push(h),r&&(s++,r=void 0),i||(l=h)}let u=s-n.depth;return u>Ane&&(o=_ne(o,u),s-=u),new Ma(o.append(a),s)}remapping(e,r){let n=new Mp;return this.items.forEach((i,a)=>{let s=i.mirrorOffset!=null&&a-i.mirrorOffset>=e?n.maps.length-i.mirrorOffset:void 0;n.appendMap(i.map,s)},e,r),n}addMaps(e){return this.eventCount==0?this:new Ma(this.items.append(e.map(r=>new rs(r))),this.eventCount)}rebased(e,r){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-r),a=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach(h=>{h.selection&&o--},i);let l=r;this.items.forEach(h=>{let m=a.getMirror(--l);if(m==null)return;s=Math.min(s,m);let v=a.maps[m];if(h.step){let x=e.steps[m].invert(e.docs[m]),y=h.selection&&h.selection.map(a.slice(l+1,m));y&&o++,n.push(new rs(v,x,y))}else n.push(new rs(v))},i);let u=[];for(let h=r;h<s;h++)u.push(new rs(a.maps[h]));let c=this.items.slice(0,i).append(u).append(n),d=new Ma(c,o);return d.emptyItemCount()>Pne&&(d=d.compress(this.items.length-n.length)),d}emptyItemCount(){let e=0;return this.items.forEach(r=>{r.step||e++}),e}compress(e=this.items.length){let r=this.remapping(0,e),n=r.maps.length,i=[],a=0;return this.items.forEach((s,o)=>{if(o>=e)i.push(s),s.selection&&a++;else if(s.step){let l=s.step.map(r.slice(n)),u=l&&l.getMap();if(n--,u&&r.appendMap(u,n),l){let c=s.selection&&s.selection.map(r.slice(n));c&&a++;let d=new rs(u.invert(),l,c),h,m=i.length-1;(h=i.length&&i[m].merge(d))?i[m]=h:i.push(d)}}else s.map&&n--},this.items.length,0),new Ma(gn.from(i.reverse()),a)}}Ma.empty=new Ma(gn.empty,0);function _ne(t,e){let r;return t.forEach((n,i)=>{if(n.selection&&e--==0)return r=i,!1}),t.slice(r)}class rs{constructor(e,r,n,i){this.map=e,this.step=r,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let r=e.step.merge(this.step);if(r)return new rs(r.getMap().invert(),r,this.selection)}}}class Bo{constructor(e,r,n,i,a){this.done=e,this.undone=r,this.prevRanges=n,this.prevTime=i,this.prevComposition=a}}const Ane=20;function Rne(t,e,r,n){let i=r.getMeta(Pu),a;if(i)return i.historyState;r.getMeta(Ine)&&(t=new Bo(t.done,t.undone,null,0,-1));let s=r.getMeta("appendedTransaction");if(r.steps.length==0)return t;if(s&&s.getMeta(Pu))return s.getMeta(Pu).redo?new Bo(t.done.addTransform(r,void 0,n,Vv(e)),t.undone,Ij(r.mapping.maps),t.prevTime,t.prevComposition):new Bo(t.done,t.undone.addTransform(r,void 0,n,Vv(e)),null,t.prevTime,t.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let o=r.getMeta("composition"),l=t.prevTime==0||!s&&t.prevComposition!=o&&(t.prevTime<(r.time||0)-n.newGroupDelay||!Dne(r,t.prevRanges)),u=s?bS(t.prevRanges,r.mapping):Ij(r.mapping.maps);return new Bo(t.done.addTransform(r,l?e.selection.getBookmark():void 0,n,Vv(e)),Ma.empty,u,r.time,o??t.prevComposition)}else return(a=r.getMeta("rebased"))?new Bo(t.done.rebased(r,a),t.undone.rebased(r,a),bS(t.prevRanges,r.mapping),t.prevTime,t.prevComposition):new Bo(t.done.addMaps(r.mapping.maps),t.undone.addMaps(r.mapping.maps),bS(t.prevRanges,r.mapping),t.prevTime,t.prevComposition)}function Dne(t,e){if(!e)return!1;if(!t.docChanged)return!0;let r=!1;return t.mapping.maps[0].forEach((n,i)=>{for(let a=0;a<e.length;a+=2)n<=e[a+1]&&i>=e[a]&&(r=!0)}),r}function Ij(t){let e=[];for(let r=t.length-1;r>=0&&e.length==0;r--)t[r].forEach((n,i,a,s)=>e.push(a,s));return e}function bS(t,e){if(!t)return null;let r=[];for(let n=0;n<t.length;n+=2){let i=e.map(t[n],1),a=e.map(t[n+1],-1);i<=a&&r.push(i,a)}return r}function One(t,e,r){let n=Vv(e),i=Pu.get(e).spec.config,a=(r?t.undone:t.done).popEvent(e,n);if(!a)return null;let s=a.selection.resolve(a.transform.doc),o=(r?t.done:t.undone).addTransform(a.transform,e.selection.getBookmark(),i,n),l=new Bo(r?o:a.remaining,r?a.remaining:o,null,0,-1);return a.transform.setSelection(s).setMeta(Pu,{redo:r,historyState:l})}let wS=!1,Lj=null;function Vv(t){let e=t.plugins;if(Lj!=e){wS=!1,Lj=e;for(let r=0;r<e.length;r++)if(e[r].spec.historyPreserveItems){wS=!0;break}}return wS}const Pu=new Rr("history"),Ine=new Rr("closeHistory");function Lne(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new cr({key:Pu,state:{init(){return new Bo(Ma.empty,Ma.empty,null,0,-1)},apply(e,r,n){return Rne(r,n,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,r){let n=r.inputType,i=n=="historyUndo"?JO:n=="historyRedo"?ZO:null;return!i||!e.editable?!1:(r.preventDefault(),i(e.state,e.dispatch))}}}})}function QO(t,e){return(r,n)=>{let i=Pu.getState(r);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(n){let a=One(i,r,t);a&&n(e?a.scrollIntoView():a)}return!0}}const JO=QO(!1,!0),ZO=QO(!0,!0);Dr.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc;if(((t==null?void 0:t.mode)||this.options.mode)==="textSize"){const n=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(n)}return e.nodeSize},this.storage.words=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc,r=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let t=!1;return[new cr({key:new Rr("characterCount"),appendTransaction:(e,r,n)=>{if(t)return;const i=this.options.limit;if(i==null||i===0){t=!0;return}const a=this.storage.characters({node:n.doc});if(a>i){const s=a-i,o=0,l=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const u=n.tr.deleteRange(o,l);return t=!0,u}t=!0},filterTransaction:(e,r)=>{const n=this.options.limit;if(!e.docChanged||n===0||n===null||n===void 0)return!0;const i=this.storage.characters({node:r.doc}),a=this.storage.characters({node:e.doc});if(a<=n||i>n&&a>n&&a<=i)return!0;if(i>n&&a>n&&a>i||!e.getMeta("paste"))return!1;const o=e.selection.$head.pos,l=a-n,u=o-l,c=o;return e.deleteRange(u,c),!(this.storage.characters({node:e.doc})>n)}})]}});var Bne=Dr.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[bne(this.options)]}});Dr.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new cr({key:new Rr("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:i}=e,a=[];if(!r||!n)return sr.create(t,[]);let s=0;this.options.mode==="deepest"&&t.descendants((l,u)=>{if(l.isText)return;if(!(i>=u&&i<=u+l.nodeSize-1))return!1;s+=1});let o=0;return t.descendants((l,u)=>{if(l.isText||!(i>=u&&i<=u+l.nodeSize-1))return!1;if(o+=1,this.options.mode==="deepest"&&s-o>0||this.options.mode==="shallowest"&&o>1)return this.options.mode==="deepest";a.push($n.node(u,u+l.nodeSize,{class:this.options.className}))}),sr.create(t,a)}}})]}});var Fne=Dr.create({name:"gapCursor",addProseMirrorPlugins(){return[Cne()]},extendNodeSchema(t){var e;const r={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Bt(qe(t,"allowGapCursor",r)))!=null?e:null}}}),zne=Dr.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new cr({key:new Rr("placeholder"),props:{decorations:({doc:t,selection:e})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=e,i=[];if(!r)return null;const a=this.editor.isEmpty;return t.descendants((s,o)=>{const l=n>=o&&n<=o+s.nodeSize,u=!s.isLeaf&&Nx(s);if((l||!this.options.showOnlyCurrent)&&u){const c=[this.options.emptyNodeClass];a&&c.push(this.options.emptyEditorClass);const d=$n.node(o,o+s.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:o,hasAnchor:l}):this.options.placeholder});i.push(d)}return this.options.includeChildren}),sr.create(t,i)}}})]}});Dr.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new cr({key:new Rr("selection"),props:{decorations(r){return r.selection.empty||t.isFocused||!t.isEditable||oO(r.selection)||t.view.dragging?null:sr.create(r.doc,[$n.inline(r.selection.from,r.selection.to,{class:e.className})])}}})]}});function Bj({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||(e==null?void 0:e.type)===t}var Vne=Dr.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new Rr(this.name),r=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(r).includes(i.name));return[new cr({key:e,appendTransaction:(i,a,s)=>{const{doc:o,tr:l,schema:u}=s,c=e.getState(s),d=o.content.size,h=u.nodes[r];if(c)return l.insert(d,h.create())},state:{init:(i,a)=>{const s=a.tr.doc.lastChild;return!Bj({node:s,types:n})},apply:(i,a)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return a;const s=i.doc.lastChild;return!Bj({node:s,types:n})}}})]}}),$ne=Dr.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>JO(t,e),redo:()=>({state:t,dispatch:e})=>ZO(t,e)}},addProseMirrorPlugins(){return[Lne(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),Une=Dr.create({name:"starterKit",addExtensions(){var t,e,r,n;const i=[];return this.options.bold!==!1&&i.push(mre.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(cre.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(FO.configure(this.options.bulletList)),this.options.code!==!1&&i.push(yre.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(wre.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(Sre.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(Bne.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(Fne.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(kre.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(Cre.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push($ne.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(Nre.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(Pre.configure(this.options.italic)),this.options.listItem!==!1&&i.push(zO.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(WO.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&i.push(tne.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(KO.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(pne.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(vne.configure(this.options.strike)),this.options.text!==!1&&i.push(yne.configure(this.options.text)),this.options.underline!==!1&&i.push(xne.configure((r=this.options)==null?void 0:r.underline)),this.options.trailingNode!==!1&&i.push(Vne.configure((n=this.options)==null?void 0:n.trailingNode)),i}}),Gne=Une,Hne=zne;function Wne(t){var e;const{char:r,allowSpaces:n,allowToIncludeChar:i,allowedPrefixes:a,startOfLine:s,$position:o}=t,l=n&&!i,u=$ee(r),c=new RegExp(`\\s${u}$`),d=s?"^":"",h=i?"":u,m=l?new RegExp(`${d}${u}.*?(?=\\s${h}|$)`,"gm"):new RegExp(`${d}(?:^)?${u}[^\\s${h}]*`,"gm"),v=((e=o.nodeBefore)==null?void 0:e.isText)&&o.nodeBefore.text;if(!v)return null;const x=o.pos-v.length,y=Array.from(v.matchAll(m)).pop();if(!y||y.input===void 0||y.index===void 0)return null;const b=y.input.slice(Math.max(0,y.index-1),y.index),S=new RegExp(`^[${a==null?void 0:a.join("")}\0]?$`).test(b);if(a!==null&&!S)return null;const w=x+y.index;let k=w+y[0].length;return l&&c.test(v.slice(k-1,k+1))&&(y[0]+=" ",k+=1),w<o.pos&&k>=o.pos?{range:{from:w,to:k},query:y[0].slice(r.length),text:y[0]}:null}var qne=new Rr("suggestion");function Kne({pluginKey:t=qne,editor:e,char:r="@",allowSpaces:n=!1,allowToIncludeChar:i=!1,allowedPrefixes:a=[" "],startOfLine:s=!1,decorationTag:o="span",decorationClass:l="suggestion",decorationContent:u="",decorationEmptyClass:c="is-empty",command:d=()=>null,items:h=()=>[],render:m=()=>({}),allow:v=()=>!0,findSuggestionMatch:x=Wne,shouldShow:y}){let b;const S=m==null?void 0:m(),w=()=>{const j=e.state.selection.$anchor.pos,M=e.view.coordsAtPos(j),{top:A,right:P,bottom:D,left:R}=M;try{return new DOMRect(R,A,P-R,D-A)}catch{return null}},k=(j,M)=>M?()=>{const A=t.getState(e.state),P=A==null?void 0:A.decorationId,D=j.dom.querySelector(`[data-decoration-id="${P}"]`);return(D==null?void 0:D.getBoundingClientRect())||null}:w;function N(j,M){var A;try{const D=t.getState(j.state),R=D!=null&&D.decorationId?j.dom.querySelector(`[data-decoration-id="${D.decorationId}"]`):null,I={editor:e,range:(D==null?void 0:D.range)||{from:0,to:0},query:(D==null?void 0:D.query)||null,text:(D==null?void 0:D.text)||null,items:[],command:U=>d({editor:e,range:(D==null?void 0:D.range)||{from:0,to:0},props:U}),decorationNode:R,clientRect:k(j,R)};(A=S==null?void 0:S.onExit)==null||A.call(S,I)}catch{}const P=j.state.tr.setMeta(M,{exit:!0});j.dispatch(P)}const T=new cr({key:t,view(){return{update:async(j,M)=>{var A,P,D,R,I,U,B;const z=(A=this.key)==null?void 0:A.getState(M),F=(P=this.key)==null?void 0:P.getState(j.state),V=z.active&&F.active&&z.range.from!==F.range.from,J=!z.active&&F.active,Y=z.active&&!F.active,L=!J&&!Y&&z.query!==F.query,G=J||V&&L,ee=L||V,re=Y||V&&L;if(!G&&!ee&&!re)return;const se=re&&!G?z:F,de=j.dom.querySelector(`[data-decoration-id="${se.decorationId}"]`);b={editor:e,range:se.range,query:se.query,text:se.text,items:[],command:W=>d({editor:e,range:se.range,props:W}),decorationNode:de,clientRect:k(j,de)},G&&((D=S==null?void 0:S.onBeforeStart)==null||D.call(S,b)),ee&&((R=S==null?void 0:S.onBeforeUpdate)==null||R.call(S,b)),(ee||G)&&(b.items=await h({editor:e,query:se.query})),re&&((I=S==null?void 0:S.onExit)==null||I.call(S,b)),ee&&((U=S==null?void 0:S.onUpdate)==null||U.call(S,b)),G&&((B=S==null?void 0:S.onStart)==null||B.call(S,b))},destroy:()=>{var j;b&&((j=S==null?void 0:S.onExit)==null||j.call(S,b))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(j,M,A,P){const{isEditable:D}=e,{composing:R}=e.view,{selection:I}=j,{empty:U,from:B}=I,z={...M},F=j.getMeta(t);if(F&&F.exit)return z.active=!1,z.decorationId=null,z.range={from:0,to:0},z.query=null,z.text=null,z;if(z.composing=R,D&&(U||e.view.composing)){(B<M.range.from||B>M.range.to)&&!R&&!M.composing&&(z.active=!1);const V=x({char:r,allowSpaces:n,allowToIncludeChar:i,allowedPrefixes:a,startOfLine:s,$position:I.$from}),J=`id_${Math.floor(Math.random()*4294967295)}`;V&&v({editor:e,state:P,range:V.range,isActive:M.active})&&(!y||y({editor:e,range:V.range,query:V.query,text:V.text,transaction:j}))?(z.active=!0,z.decorationId=M.decorationId?M.decorationId:J,z.range=V.range,z.query=V.query,z.text=V.text):z.active=!1}else z.active=!1;return z.active||(z.decorationId=null,z.range={from:0,to:0},z.query=null,z.text=null),z}},props:{handleKeyDown(j,M){var A,P,D,R;const{active:I,range:U}=T.getState(j.state);if(!I)return!1;if(M.key==="Escape"||M.key==="Esc"){const z=T.getState(j.state),F=(A=b==null?void 0:b.decorationNode)!=null?A:null,V=F??(z!=null&&z.decorationId?j.dom.querySelector(`[data-decoration-id="${z.decorationId}"]`):null);if(((P=S==null?void 0:S.onKeyDown)==null?void 0:P.call(S,{view:j,event:M,range:z.range}))||!1)return!0;const Y={editor:e,range:z.range,query:z.query,text:z.text,items:[],command:L=>d({editor:e,range:z.range,props:L}),decorationNode:V,clientRect:V?()=>V.getBoundingClientRect()||null:null};return(D=S==null?void 0:S.onExit)==null||D.call(S,Y),N(j,t),!0}return((R=S==null?void 0:S.onKeyDown)==null?void 0:R.call(S,{view:j,event:M,range:U}))||!1},decorations(j){const{active:M,range:A,decorationId:P,query:D}=T.getState(j);if(!M)return null;const R=!(D!=null&&D.length),I=[l];return R&&I.push(c),sr.create(j.doc,[$n.inline(A.from,A.to,{nodeName:o,class:I.join(" "),"data-decoration-id":P,"data-decoration-content":u})])}}});return T}function Yne({editor:t,overrideSuggestionOptions:e,extensionName:r,char:n="@"}){const i=new Rr;return{editor:t,char:n,pluginKey:i,command:({editor:a,range:s,props:o})=>{var l,u,c;const d=a.view.state.selection.$to.nodeAfter;((l=d==null?void 0:d.text)==null?void 0:l.startsWith(" "))&&(s.to+=1),a.chain().focus().insertContentAt(s,[{type:r,attrs:{...o,mentionSuggestionChar:n}},{type:"text",text:" "}]).run(),(c=(u=a.view.dom.ownerDocument.defaultView)==null?void 0:u.getSelection())==null||c.collapseToEnd()},allow:({state:a,range:s})=>{const o=a.doc.resolve(s.from),l=a.schema.nodes[r];return!!o.parent.type.contentMatch.matchType(l)},...e}}function eI(t){return(t.options.suggestions.length?t.options.suggestions:[t.options.suggestion]).map(e=>Yne({editor:t.editor,overrideSuggestionOptions:e,extensionName:t.name,char:e.char}))}function Fj(t,e){const r=eI(t),n=r.find(i=>i.char===e);return n||(r.length?r[0]:null)}var Xne=Ci.create({name:"mention",priority:101,addOptions(){return{HTMLAttributes:{},renderText({node:t,suggestion:e}){var r,n;return`${(r=e==null?void 0:e.char)!=null?r:"@"}${(n=t.attrs.label)!=null?n:t.attrs.id}`},deleteTriggerWithBackspace:!1,renderHTML({options:t,node:e,suggestion:r}){var n,i;return["span",ur(this.HTMLAttributes,t.HTMLAttributes),`${(n=r==null?void 0:r.char)!=null?n:"@"}${(i=e.attrs.label)!=null?i:e.attrs.id}`]},suggestions:[],suggestion:{}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:t=>t.getAttribute("data-id"),renderHTML:t=>t.id?{"data-id":t.id}:{}},label:{default:null,parseHTML:t=>t.getAttribute("data-label"),renderHTML:t=>t.label?{"data-label":t.label}:{}},mentionSuggestionChar:{default:"@",parseHTML:t=>t.getAttribute("data-mention-suggestion-char"),renderHTML:t=>({"data-mention-suggestion-char":t.mentionSuggestionChar})}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:t,HTMLAttributes:e}){const r=Fj(this,t.attrs.mentionSuggestionChar);if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",ur({"data-type":this.name},this.options.HTMLAttributes,e),this.options.renderLabel({options:this.options,node:t,suggestion:r})];const n={...this.options};n.HTMLAttributes=ur({"data-type":this.name},this.options.HTMLAttributes,e);const i=this.options.renderHTML({options:n,node:t,suggestion:r});return typeof i=="string"?["span",ur({"data-type":this.name},this.options.HTMLAttributes,e),i]:i},...CO({nodeName:"mention",name:"@",selfClosing:!0,allowedAttributes:["id","label",{name:"mentionSuggestionChar",skipIfDefault:"@"}],parseAttributes:t=>{const e={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(t);for(;n!==null;){const[,i,a,s]=n,o=a??s;e[i==="char"?"mentionSuggestionChar":i]=o,n=r.exec(t)}return e},serializeAttributes:t=>Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e==="mentionSuggestionChar"?"char":e}="${r}"`).join(" ")}),renderText({node:t}){const e={options:this.options,node:t,suggestion:Fj(this,t.attrs.mentionSuggestionChar)};return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel(e)):this.options.renderText(e)},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:t,state:e})=>{let r=!1;const{selection:n}=e,{empty:i,anchor:a}=n;if(!i)return!1;let s=new Ws,o=0;return e.doc.nodesBetween(a-1,a,(l,u)=>{if(l.type.name===this.name)return r=!0,s=l,o=u,!1}),r&&t.insertText(this.options.deleteTriggerWithBackspace?"":s.attrs.mentionSuggestionChar,o,o+s.nodeSize),r})}},addProseMirrorPlugins(){return eI(this).map(Kne)}}),Qne=Xne,Si="top",fa="bottom",ha="right",ki="left",t4="auto",hm=[Si,fa,ha,ki],Gd="start",Bp="end",Jne="clippingParents",tI="viewport",lh="popper",Zne="reference",zj=hm.reduce(function(t,e){return t.concat([e+"-"+Gd,e+"-"+Bp])},[]),rI=[].concat(hm,[t4]).reduce(function(t,e){return t.concat([e,e+"-"+Gd,e+"-"+Bp])},[]),eie="beforeRead",tie="read",rie="afterRead",nie="beforeMain",iie="main",aie="afterMain",sie="beforeWrite",oie="write",lie="afterWrite",uie=[eie,tie,rie,nie,iie,aie,sie,oie,lie];function ps(t){return t?(t.nodeName||"").toLowerCase():null}function Di(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Yu(t){var e=Di(t).Element;return t instanceof e||t instanceof Element}function ua(t){var e=Di(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function r4(t){if(typeof ShadowRoot>"u")return!1;var e=Di(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function cie(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},a=e.elements[r];!ua(a)||!ps(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function die(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},s=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=s.reduce(function(l,u){return l[u]="",l},{});!ua(i)||!ps(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}const nI={name:"applyStyles",enabled:!0,phase:"write",fn:cie,effect:die,requires:["computeStyles"]};function cs(t){return t.split("-")[0]}var _u=Math.max,Cy=Math.min,Hd=Math.round;function Rk(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function iI(){return!/^((?!chrome|android).)*safari/i.test(Rk())}function Wd(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&ua(t)&&(i=t.offsetWidth>0&&Hd(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&Hd(n.height)/t.offsetHeight||1);var s=Yu(t)?Di(t):window,o=s.visualViewport,l=!iI()&&r,u=(n.left+(l&&o?o.offsetLeft:0))/i,c=(n.top+(l&&o?o.offsetTop:0))/a,d=n.width/i,h=n.height/a;return{width:d,height:h,top:c,right:u+d,bottom:c+h,left:u,x:u,y:c}}function n4(t){var e=Wd(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function aI(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&r4(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function ro(t){return Di(t).getComputedStyle(t)}function fie(t){return["table","td","th"].indexOf(ps(t))>=0}function Ll(t){return((Yu(t)?t.ownerDocument:t.document)||window.document).documentElement}function Px(t){return ps(t)==="html"?t:t.assignedSlot||t.parentNode||(r4(t)?t.host:null)||Ll(t)}function Vj(t){return!ua(t)||ro(t).position==="fixed"?null:t.offsetParent}function hie(t){var e=/firefox/i.test(Rk()),r=/Trident/i.test(Rk());if(r&&ua(t)){var n=ro(t);if(n.position==="fixed")return null}var i=Px(t);for(r4(i)&&(i=i.host);ua(i)&&["html","body"].indexOf(ps(i))<0;){var a=ro(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function pm(t){for(var e=Di(t),r=Vj(t);r&&fie(r)&&ro(r).position==="static";)r=Vj(r);return r&&(ps(r)==="html"||ps(r)==="body"&&ro(r).position==="static")?e:r||hie(t)||e}function i4(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Yh(t,e,r){return _u(t,Cy(e,r))}function pie(t,e,r){var n=Yh(t,e,r);return n>r?r:n}function sI(){return{top:0,right:0,bottom:0,left:0}}function oI(t){return Object.assign({},sI(),t)}function lI(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var mie=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,oI(typeof e!="number"?e:lI(e,hm))};function gie(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,s=r.modifiersData.popperOffsets,o=cs(r.placement),l=i4(o),u=[ki,ha].indexOf(o)>=0,c=u?"height":"width";if(!(!a||!s)){var d=mie(i.padding,r),h=n4(a),m=l==="y"?Si:ki,v=l==="y"?fa:ha,x=r.rects.reference[c]+r.rects.reference[l]-s[l]-r.rects.popper[c],y=s[l]-r.rects.reference[l],b=pm(a),S=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,w=x/2-y/2,k=d[m],N=S-h[c]-d[v],T=S/2-h[c]/2+w,j=Yh(k,T,N),M=l;r.modifiersData[n]=(e={},e[M]=j,e.centerOffset=j-T,e)}}function vie(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||aI(e.elements.popper,i)&&(e.elements.arrow=i))}const yie={name:"arrow",enabled:!0,phase:"main",fn:gie,effect:vie,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function qd(t){return t.split("-")[1]}var xie={top:"auto",right:"auto",bottom:"auto",left:"auto"};function bie(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:Hd(r*i)/i||0,y:Hd(n*i)/i||0}}function $j(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,s=t.offsets,o=t.position,l=t.gpuAcceleration,u=t.adaptive,c=t.roundOffsets,d=t.isFixed,h=s.x,m=h===void 0?0:h,v=s.y,x=v===void 0?0:v,y=typeof c=="function"?c({x:m,y:x}):{x:m,y:x};m=y.x,x=y.y;var b=s.hasOwnProperty("x"),S=s.hasOwnProperty("y"),w=ki,k=Si,N=window;if(u){var T=pm(r),j="clientHeight",M="clientWidth";if(T===Di(r)&&(T=Ll(r),ro(T).position!=="static"&&o==="absolute"&&(j="scrollHeight",M="scrollWidth")),T=T,i===Si||(i===ki||i===ha)&&a===Bp){k=fa;var A=d&&T===N&&N.visualViewport?N.visualViewport.height:T[j];x-=A-n.height,x*=l?1:-1}if(i===ki||(i===Si||i===fa)&&a===Bp){w=ha;var P=d&&T===N&&N.visualViewport?N.visualViewport.width:T[M];m-=P-n.width,m*=l?1:-1}}var D=Object.assign({position:o},u&&xie),R=c===!0?bie({x:m,y:x},Di(r)):{x:m,y:x};if(m=R.x,x=R.y,l){var I;return Object.assign({},D,(I={},I[k]=S?"0":"",I[w]=b?"0":"",I.transform=(N.devicePixelRatio||1)<=1?"translate("+m+"px, "+x+"px)":"translate3d("+m+"px, "+x+"px, 0)",I))}return Object.assign({},D,(e={},e[k]=S?x+"px":"",e[w]=b?m+"px":"",e.transform="",e))}function wie(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,s=a===void 0?!0:a,o=r.roundOffsets,l=o===void 0?!0:o,u={placement:cs(e.placement),variation:qd(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,$j(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,$j(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Sie={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:wie,data:{}};var ov={passive:!0};function kie(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,s=n.resize,o=s===void 0?!0:s,l=Di(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&u.forEach(function(c){c.addEventListener("scroll",r.update,ov)}),o&&l.addEventListener("resize",r.update,ov),function(){a&&u.forEach(function(c){c.removeEventListener("scroll",r.update,ov)}),o&&l.removeEventListener("resize",r.update,ov)}}const Cie={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:kie,data:{}};var Nie={left:"right",right:"left",bottom:"top",top:"bottom"};function $v(t){return t.replace(/left|right|bottom|top/g,function(e){return Nie[e]})}var Eie={start:"end",end:"start"};function Uj(t){return t.replace(/start|end/g,function(e){return Eie[e]})}function a4(t){var e=Di(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function s4(t){return Wd(Ll(t)).left+a4(t).scrollLeft}function Tie(t,e){var r=Di(t),n=Ll(t),i=r.visualViewport,a=n.clientWidth,s=n.clientHeight,o=0,l=0;if(i){a=i.width,s=i.height;var u=iI();(u||!u&&e==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:a,height:s,x:o+s4(t),y:l}}function jie(t){var e,r=Ll(t),n=a4(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=_u(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=_u(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+s4(t),l=-n.scrollTop;return ro(i||r).direction==="rtl"&&(o+=_u(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:l}}function o4(t){var e=ro(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function uI(t){return["html","body","#document"].indexOf(ps(t))>=0?t.ownerDocument.body:ua(t)&&o4(t)?t:uI(Px(t))}function Xh(t,e){var r;e===void 0&&(e=[]);var n=uI(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=Di(n),s=i?[a].concat(a.visualViewport||[],o4(n)?n:[]):n,o=e.concat(s);return i?o:o.concat(Xh(Px(s)))}function Dk(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Mie(t,e){var r=Wd(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function Gj(t,e,r){return e===tI?Dk(Tie(t,r)):Yu(e)?Mie(e,r):Dk(jie(Ll(t)))}function Pie(t){var e=Xh(Px(t)),r=["absolute","fixed"].indexOf(ro(t).position)>=0,n=r&&ua(t)?pm(t):t;return Yu(n)?e.filter(function(i){return Yu(i)&&aI(i,n)&&ps(i)!=="body"}):[]}function _ie(t,e,r,n){var i=e==="clippingParents"?Pie(t):[].concat(e),a=[].concat(i,[r]),s=a[0],o=a.reduce(function(l,u){var c=Gj(t,u,n);return l.top=_u(c.top,l.top),l.right=Cy(c.right,l.right),l.bottom=Cy(c.bottom,l.bottom),l.left=_u(c.left,l.left),l},Gj(t,s,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function cI(t){var e=t.reference,r=t.element,n=t.placement,i=n?cs(n):null,a=n?qd(n):null,s=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,l;switch(i){case Si:l={x:s,y:e.y-r.height};break;case fa:l={x:s,y:e.y+e.height};break;case ha:l={x:e.x+e.width,y:o};break;case ki:l={x:e.x-r.width,y:o};break;default:l={x:e.x,y:e.y}}var u=i?i4(i):null;if(u!=null){var c=u==="y"?"height":"width";switch(a){case Gd:l[u]=l[u]-(e[c]/2-r[c]/2);break;case Bp:l[u]=l[u]+(e[c]/2-r[c]/2);break}}return l}function Fp(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.strategy,s=a===void 0?t.strategy:a,o=r.boundary,l=o===void 0?Jne:o,u=r.rootBoundary,c=u===void 0?tI:u,d=r.elementContext,h=d===void 0?lh:d,m=r.altBoundary,v=m===void 0?!1:m,x=r.padding,y=x===void 0?0:x,b=oI(typeof y!="number"?y:lI(y,hm)),S=h===lh?Zne:lh,w=t.rects.popper,k=t.elements[v?S:h],N=_ie(Yu(k)?k:k.contextElement||Ll(t.elements.popper),l,c,s),T=Wd(t.elements.reference),j=cI({reference:T,element:w,strategy:"absolute",placement:i}),M=Dk(Object.assign({},w,j)),A=h===lh?M:T,P={top:N.top-A.top+b.top,bottom:A.bottom-N.bottom+b.bottom,left:N.left-A.left+b.left,right:A.right-N.right+b.right},D=t.modifiersData.offset;if(h===lh&&D){var R=D[i];Object.keys(P).forEach(function(I){var U=[ha,fa].indexOf(I)>=0?1:-1,B=[Si,fa].indexOf(I)>=0?"y":"x";P[I]+=R[B]*U})}return P}function Aie(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,s=r.padding,o=r.flipVariations,l=r.allowedAutoPlacements,u=l===void 0?rI:l,c=qd(n),d=c?o?zj:zj.filter(function(v){return qd(v)===c}):hm,h=d.filter(function(v){return u.indexOf(v)>=0});h.length===0&&(h=d);var m=h.reduce(function(v,x){return v[x]=Fp(t,{placement:x,boundary:i,rootBoundary:a,padding:s})[cs(x)],v},{});return Object.keys(m).sort(function(v,x){return m[v]-m[x]})}function Rie(t){if(cs(t)===t4)return[];var e=$v(t);return[Uj(t),e,Uj(e)]}function Die(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!0:s,l=r.fallbackPlacements,u=r.padding,c=r.boundary,d=r.rootBoundary,h=r.altBoundary,m=r.flipVariations,v=m===void 0?!0:m,x=r.allowedAutoPlacements,y=e.options.placement,b=cs(y),S=b===y,w=l||(S||!v?[$v(y)]:Rie(y)),k=[y].concat(w).reduce(function(re,se){return re.concat(cs(se)===t4?Aie(e,{placement:se,boundary:c,rootBoundary:d,padding:u,flipVariations:v,allowedAutoPlacements:x}):se)},[]),N=e.rects.reference,T=e.rects.popper,j=new Map,M=!0,A=k[0],P=0;P<k.length;P++){var D=k[P],R=cs(D),I=qd(D)===Gd,U=[Si,fa].indexOf(R)>=0,B=U?"width":"height",z=Fp(e,{placement:D,boundary:c,rootBoundary:d,altBoundary:h,padding:u}),F=U?I?ha:ki:I?fa:Si;N[B]>T[B]&&(F=$v(F));var V=$v(F),J=[];if(a&&J.push(z[R]<=0),o&&J.push(z[F]<=0,z[V]<=0),J.every(function(re){return re})){A=D,M=!1;break}j.set(D,J)}if(M)for(var Y=v?3:1,L=function(se){var de=k.find(function(W){var ne=j.get(W);if(ne)return ne.slice(0,se).every(function(ie){return ie})});if(de)return A=de,"break"},G=Y;G>0;G--){var ee=L(G);if(ee==="break")break}e.placement!==A&&(e.modifiersData[n]._skip=!0,e.placement=A,e.reset=!0)}}const Oie={name:"flip",enabled:!0,phase:"main",fn:Die,requiresIfExists:["offset"],data:{_skip:!1}};function Hj(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function Wj(t){return[Si,ha,fa,ki].some(function(e){return t[e]>=0})}function Iie(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=Fp(e,{elementContext:"reference"}),o=Fp(e,{altBoundary:!0}),l=Hj(s,n),u=Hj(o,i,a),c=Wj(l),d=Wj(u);e.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":d})}const Lie={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Iie};function Bie(t,e,r){var n=cs(t),i=[ki,Si].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[ki,ha].indexOf(n)>=0?{x:o,y:s}:{x:s,y:o}}function Fie(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,s=rI.reduce(function(c,d){return c[d]=Bie(d,e.rects,a),c},{}),o=s[e.placement],l=o.x,u=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[n]=s}const zie={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Fie};function Vie(t){var e=t.state,r=t.name;e.modifiersData[r]=cI({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const $ie={name:"popperOffsets",enabled:!0,phase:"read",fn:Vie,data:{}};function Uie(t){return t==="x"?"y":"x"}function Gie(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!1:s,l=r.boundary,u=r.rootBoundary,c=r.altBoundary,d=r.padding,h=r.tether,m=h===void 0?!0:h,v=r.tetherOffset,x=v===void 0?0:v,y=Fp(e,{boundary:l,rootBoundary:u,padding:d,altBoundary:c}),b=cs(e.placement),S=qd(e.placement),w=!S,k=i4(b),N=Uie(k),T=e.modifiersData.popperOffsets,j=e.rects.reference,M=e.rects.popper,A=typeof x=="function"?x(Object.assign({},e.rects,{placement:e.placement})):x,P=typeof A=="number"?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),D=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,R={x:0,y:0};if(T){if(a){var I,U=k==="y"?Si:ki,B=k==="y"?fa:ha,z=k==="y"?"height":"width",F=T[k],V=F+y[U],J=F-y[B],Y=m?-M[z]/2:0,L=S===Gd?j[z]:M[z],G=S===Gd?-M[z]:-j[z],ee=e.elements.arrow,re=m&&ee?n4(ee):{width:0,height:0},se=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:sI(),de=se[U],W=se[B],ne=Yh(0,j[z],re[z]),ie=w?j[z]/2-Y-ne-de-P.mainAxis:L-ne-de-P.mainAxis,$=w?-j[z]/2+Y+ne+W+P.mainAxis:G+ne+W+P.mainAxis,q=e.elements.arrow&&pm(e.elements.arrow),te=q?k==="y"?q.clientTop||0:q.clientLeft||0:0,Z=(I=D==null?void 0:D[k])!=null?I:0,le=F+ie-Z-te,ge=F+$-Z,Ue=Yh(m?Cy(V,le):V,F,m?_u(J,ge):J);T[k]=Ue,R[k]=Ue-F}if(o){var Te,Re=k==="x"?Si:ki,Ge=k==="x"?fa:ha,Ce=T[N],De=N==="y"?"height":"width",Ve=Ce+y[Re],We=Ce-y[Ge],Ie=[Si,ki].indexOf(b)!==-1,rt=(Te=D==null?void 0:D[N])!=null?Te:0,ut=Ie?Ve:Ce-j[De]-M[De]-rt+P.altAxis,xt=Ie?Ce+j[De]+M[De]-rt-P.altAxis:We,bt=m&&Ie?pie(ut,Ce,xt):Yh(m?ut:Ve,Ce,m?xt:We);T[N]=bt,R[N]=bt-Ce}e.modifiersData[n]=R}}const Hie={name:"preventOverflow",enabled:!0,phase:"main",fn:Gie,requiresIfExists:["offset"]};function Wie(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function qie(t){return t===Di(t)||!ua(t)?a4(t):Wie(t)}function Kie(t){var e=t.getBoundingClientRect(),r=Hd(e.width)/t.offsetWidth||1,n=Hd(e.height)/t.offsetHeight||1;return r!==1||n!==1}function Yie(t,e,r){r===void 0&&(r=!1);var n=ua(e),i=ua(e)&&Kie(e),a=Ll(e),s=Wd(t,i,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&((ps(e)!=="body"||o4(a))&&(o=qie(e)),ua(e)?(l=Wd(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=s4(a))),{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}function Xie(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!r.has(o)){var l=e.get(o);l&&i(l)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function Qie(t){var e=Xie(t);return uie.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function Jie(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function Zie(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var qj={placement:"bottom",modifiers:[],strategy:"absolute"};function Kj(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function eae(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?qj:i;return function(o,l,u){u===void 0&&(u=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},qj,a),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},d=[],h=!1,m={state:c,setOptions:function(b){var S=typeof b=="function"?b(c.options):b;x(),c.options=Object.assign({},a,c.options,S),c.scrollParents={reference:Yu(o)?Xh(o):o.contextElement?Xh(o.contextElement):[],popper:Xh(l)};var w=Qie(Zie([].concat(n,c.options.modifiers)));return c.orderedModifiers=w.filter(function(k){return k.enabled}),v(),m.update()},forceUpdate:function(){if(!h){var b=c.elements,S=b.reference,w=b.popper;if(Kj(S,w)){c.rects={reference:Yie(S,pm(w),c.options.strategy==="fixed"),popper:n4(w)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(P){return c.modifiersData[P.name]=Object.assign({},P.data)});for(var k=0;k<c.orderedModifiers.length;k++){if(c.reset===!0){c.reset=!1,k=-1;continue}var N=c.orderedModifiers[k],T=N.fn,j=N.options,M=j===void 0?{}:j,A=N.name;typeof T=="function"&&(c=T({state:c,options:M,name:A,instance:m})||c)}}}},update:Jie(function(){return new Promise(function(y){m.forceUpdate(),y(c)})}),destroy:function(){x(),h=!0}};if(!Kj(o,l))return m;m.setOptions(u).then(function(y){!h&&u.onFirstUpdate&&u.onFirstUpdate(y)});function v(){c.orderedModifiers.forEach(function(y){var b=y.name,S=y.options,w=S===void 0?{}:S,k=y.effect;if(typeof k=="function"){var N=k({state:c,name:b,instance:m,options:w}),T=function(){};d.push(N||T)}})}function x(){d.forEach(function(y){return y()}),d=[]}return m}}var tae=[Cie,$ie,Sie,nI,zie,Oie,Hie,yie,Lie],rae=eae({defaultModifiers:tae}),nae="tippy-box",dI="tippy-content",iae="tippy-backdrop",fI="tippy-arrow",hI="tippy-svg-arrow",du={passive:!0,capture:!0},pI=function(){return document.body};function SS(t,e,r){if(Array.isArray(t)){var n=t[e];return n??(Array.isArray(r)?r[e]:r)}return t}function l4(t,e){var r={}.toString.call(t);return r.indexOf("[object")===0&&r.indexOf(e+"]")>-1}function mI(t,e){return typeof t=="function"?t.apply(void 0,e):t}function Yj(t,e){if(e===0)return t;var r;return function(n){clearTimeout(r),r=setTimeout(function(){t(n)},e)}}function aae(t){return t.split(/\s+/).filter(Boolean)}function qc(t){return[].concat(t)}function Xj(t,e){t.indexOf(e)===-1&&t.push(e)}function sae(t){return t.filter(function(e,r){return t.indexOf(e)===r})}function oae(t){return t.split("-")[0]}function Ny(t){return[].slice.call(t)}function Qj(t){return Object.keys(t).reduce(function(e,r){return t[r]!==void 0&&(e[r]=t[r]),e},{})}function Qh(){return document.createElement("div")}function _x(t){return["Element","Fragment"].some(function(e){return l4(t,e)})}function lae(t){return l4(t,"NodeList")}function uae(t){return l4(t,"MouseEvent")}function cae(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function dae(t){return _x(t)?[t]:lae(t)?Ny(t):Array.isArray(t)?t:Ny(document.querySelectorAll(t))}function kS(t,e){t.forEach(function(r){r&&(r.style.transitionDuration=e+"ms")})}function Jj(t,e){t.forEach(function(r){r&&r.setAttribute("data-state",e)})}function fae(t){var e,r=qc(t),n=r[0];return n!=null&&(e=n.ownerDocument)!=null&&e.body?n.ownerDocument:document}function hae(t,e){var r=e.clientX,n=e.clientY;return t.every(function(i){var a=i.popperRect,s=i.popperState,o=i.props,l=o.interactiveBorder,u=oae(s.placement),c=s.modifiersData.offset;if(!c)return!0;var d=u==="bottom"?c.top.y:0,h=u==="top"?c.bottom.y:0,m=u==="right"?c.left.x:0,v=u==="left"?c.right.x:0,x=a.top-n+d>l,y=n-a.bottom-h>l,b=a.left-r+m>l,S=r-a.right-v>l;return x||y||b||S})}function CS(t,e,r){var n=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[n](i,r)})}function Zj(t,e){for(var r=e;r;){var n;if(t.contains(r))return!0;r=r.getRootNode==null||(n=r.getRootNode())==null?void 0:n.host}return!1}var ns={isTouch:!1},eM=0;function pae(){ns.isTouch||(ns.isTouch=!0,window.performance&&document.addEventListener("mousemove",gI))}function gI(){var t=performance.now();t-eM<20&&(ns.isTouch=!1,document.removeEventListener("mousemove",gI)),eM=t}function mae(){var t=document.activeElement;if(cae(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function gae(){document.addEventListener("touchstart",pae,du),window.addEventListener("blur",mae)}var vae=typeof window<"u"&&typeof document<"u",yae=vae?!!window.msCrypto:!1,xae={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},bae={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},_a=Object.assign({appendTo:pI,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},xae,bae),wae=Object.keys(_a),Sae=function(e){var r=Object.keys(e);r.forEach(function(n){_a[n]=e[n]})};function vI(t){var e=t.plugins||[],r=e.reduce(function(n,i){var a=i.name,s=i.defaultValue;if(a){var o;n[a]=t[a]!==void 0?t[a]:(o=_a[a])!=null?o:s}return n},{});return Object.assign({},t,r)}function kae(t,e){var r=e?Object.keys(vI(Object.assign({},_a,{plugins:e}))):wae,n=r.reduce(function(i,a){var s=(t.getAttribute("data-tippy-"+a)||"").trim();if(!s)return i;if(a==="content")i[a]=s;else try{i[a]=JSON.parse(s)}catch{i[a]=s}return i},{});return n}function tM(t,e){var r=Object.assign({},e,{content:mI(e.content,[t])},e.ignoreAttributes?{}:kae(t,e.plugins));return r.aria=Object.assign({},_a.aria,r.aria),r.aria={expanded:r.aria.expanded==="auto"?e.interactive:r.aria.expanded,content:r.aria.content==="auto"?e.interactive?null:"describedby":r.aria.content},r}var Cae=function(){return"innerHTML"};function Ok(t,e){t[Cae()]=e}function rM(t){var e=Qh();return t===!0?e.className=fI:(e.className=hI,_x(t)?e.appendChild(t):Ok(e,t)),e}function nM(t,e){_x(e.content)?(Ok(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?Ok(t,e.content):t.textContent=e.content)}function Ik(t){var e=t.firstElementChild,r=Ny(e.children);return{box:e,content:r.find(function(n){return n.classList.contains(dI)}),arrow:r.find(function(n){return n.classList.contains(fI)||n.classList.contains(hI)}),backdrop:r.find(function(n){return n.classList.contains(iae)})}}function yI(t){var e=Qh(),r=Qh();r.className=nae,r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1");var n=Qh();n.className=dI,n.setAttribute("data-state","hidden"),nM(n,t.props),e.appendChild(r),r.appendChild(n),i(t.props,t.props);function i(a,s){var o=Ik(e),l=o.box,u=o.content,c=o.arrow;s.theme?l.setAttribute("data-theme",s.theme):l.removeAttribute("data-theme"),typeof s.animation=="string"?l.setAttribute("data-animation",s.animation):l.removeAttribute("data-animation"),s.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?l.setAttribute("role",s.role):l.removeAttribute("role"),(a.content!==s.content||a.allowHTML!==s.allowHTML)&&nM(u,t.props),s.arrow?c?a.arrow!==s.arrow&&(l.removeChild(c),l.appendChild(rM(s.arrow))):l.appendChild(rM(s.arrow)):c&&l.removeChild(c)}return{popper:e,onUpdate:i}}yI.$$tippy=!0;var Nae=1,lv=[],NS=[];function Eae(t,e){var r=tM(t,Object.assign({},_a,vI(Qj(e)))),n,i,a,s=!1,o=!1,l=!1,u=!1,c,d,h,m=[],v=Yj(le,r.interactiveDebounce),x,y=Nae++,b=null,S=sae(r.plugins),w={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},k={id:y,reference:t,popper:Qh(),popperInstance:b,props:r,state:w,plugins:S,clearDelayTimeouts:ut,setProps:xt,setContent:bt,show:Nt,hide:Je,hideWithInteractivity:Oe,enable:Ie,disable:rt,unmount:ve,destroy:H};if(!r.render)return k;var N=r.render(k),T=N.popper,j=N.onUpdate;T.setAttribute("data-tippy-root",""),T.id="tippy-"+k.id,k.popper=T,t._tippy=k,T._tippy=k;var M=S.map(function(Q){return Q.fn(k)}),A=t.hasAttribute("aria-expanded");return q(),Y(),F(),V("onCreate",[k]),r.showOnCreate&&Ve(),T.addEventListener("mouseenter",function(){k.props.interactive&&k.state.isVisible&&k.clearDelayTimeouts()}),T.addEventListener("mouseleave",function(){k.props.interactive&&k.props.trigger.indexOf("mouseenter")>=0&&U().addEventListener("mousemove",v)}),k;function P(){var Q=k.props.touch;return Array.isArray(Q)?Q:[Q,0]}function D(){return P()[0]==="hold"}function R(){var Q;return!!((Q=k.props.render)!=null&&Q.$$tippy)}function I(){return x||t}function U(){var Q=I().parentNode;return Q?fae(Q):document}function B(){return Ik(T)}function z(Q){return k.state.isMounted&&!k.state.isVisible||ns.isTouch||c&&c.type==="focus"?0:SS(k.props.delay,Q?0:1,_a.delay)}function F(Q){Q===void 0&&(Q=!1),T.style.pointerEvents=k.props.interactive&&!Q?"":"none",T.style.zIndex=""+k.props.zIndex}function V(Q,ae,ue){if(ue===void 0&&(ue=!0),M.forEach(function(xe){xe[Q]&&xe[Q].apply(xe,ae)}),ue){var fe;(fe=k.props)[Q].apply(fe,ae)}}function J(){var Q=k.props.aria;if(Q.content){var ae="aria-"+Q.content,ue=T.id,fe=qc(k.props.triggerTarget||t);fe.forEach(function(xe){var ye=xe.getAttribute(ae);if(k.state.isVisible)xe.setAttribute(ae,ye?ye+" "+ue:ue);else{var je=ye&&ye.replace(ue,"").trim();je?xe.setAttribute(ae,je):xe.removeAttribute(ae)}})}}function Y(){if(!(A||!k.props.aria.expanded)){var Q=qc(k.props.triggerTarget||t);Q.forEach(function(ae){k.props.interactive?ae.setAttribute("aria-expanded",k.state.isVisible&&ae===I()?"true":"false"):ae.removeAttribute("aria-expanded")})}}function L(){U().removeEventListener("mousemove",v),lv=lv.filter(function(Q){return Q!==v})}function G(Q){if(!(ns.isTouch&&(l||Q.type==="mousedown"))){var ae=Q.composedPath&&Q.composedPath()[0]||Q.target;if(!(k.props.interactive&&Zj(T,ae))){if(qc(k.props.triggerTarget||t).some(function(ue){return Zj(ue,ae)})){if(ns.isTouch||k.state.isVisible&&k.props.trigger.indexOf("click")>=0)return}else V("onClickOutside",[k,Q]);k.props.hideOnClick===!0&&(k.clearDelayTimeouts(),k.hide(),o=!0,setTimeout(function(){o=!1}),k.state.isMounted||de())}}}function ee(){l=!0}function re(){l=!1}function se(){var Q=U();Q.addEventListener("mousedown",G,!0),Q.addEventListener("touchend",G,du),Q.addEventListener("touchstart",re,du),Q.addEventListener("touchmove",ee,du)}function de(){var Q=U();Q.removeEventListener("mousedown",G,!0),Q.removeEventListener("touchend",G,du),Q.removeEventListener("touchstart",re,du),Q.removeEventListener("touchmove",ee,du)}function W(Q,ae){ie(Q,function(){!k.state.isVisible&&T.parentNode&&T.parentNode.contains(T)&&ae()})}function ne(Q,ae){ie(Q,ae)}function ie(Q,ae){var ue=B().box;function fe(xe){xe.target===ue&&(CS(ue,"remove",fe),ae())}if(Q===0)return ae();CS(ue,"remove",d),CS(ue,"add",fe),d=fe}function $(Q,ae,ue){ue===void 0&&(ue=!1);var fe=qc(k.props.triggerTarget||t);fe.forEach(function(xe){xe.addEventListener(Q,ae,ue),m.push({node:xe,eventType:Q,handler:ae,options:ue})})}function q(){D()&&($("touchstart",Z,{passive:!0}),$("touchend",ge,{passive:!0})),aae(k.props.trigger).forEach(function(Q){if(Q!=="manual")switch($(Q,Z),Q){case"mouseenter":$("mouseleave",ge);break;case"focus":$(yae?"focusout":"blur",Ue);break;case"focusin":$("focusout",Ue);break}})}function te(){m.forEach(function(Q){var ae=Q.node,ue=Q.eventType,fe=Q.handler,xe=Q.options;ae.removeEventListener(ue,fe,xe)}),m=[]}function Z(Q){var ae,ue=!1;if(!(!k.state.isEnabled||Te(Q)||o)){var fe=((ae=c)==null?void 0:ae.type)==="focus";c=Q,x=Q.currentTarget,Y(),!k.state.isVisible&&uae(Q)&&lv.forEach(function(xe){return xe(Q)}),Q.type==="click"&&(k.props.trigger.indexOf("mouseenter")<0||s)&&k.props.hideOnClick!==!1&&k.state.isVisible?ue=!0:Ve(Q),Q.type==="click"&&(s=!ue),ue&&!fe&&We(Q)}}function le(Q){var ae=Q.target,ue=I().contains(ae)||T.contains(ae);if(!(Q.type==="mousemove"&&ue)){var fe=De().concat(T).map(function(xe){var ye,je=xe._tippy,Me=(ye=je.popperInstance)==null?void 0:ye.state;return Me?{popperRect:xe.getBoundingClientRect(),popperState:Me,props:r}:null}).filter(Boolean);hae(fe,Q)&&(L(),We(Q))}}function ge(Q){var ae=Te(Q)||k.props.trigger.indexOf("click")>=0&&s;if(!ae){if(k.props.interactive){k.hideWithInteractivity(Q);return}We(Q)}}function Ue(Q){k.props.trigger.indexOf("focusin")<0&&Q.target!==I()||k.props.interactive&&Q.relatedTarget&&T.contains(Q.relatedTarget)||We(Q)}function Te(Q){return ns.isTouch?D()!==Q.type.indexOf("touch")>=0:!1}function Re(){Ge();var Q=k.props,ae=Q.popperOptions,ue=Q.placement,fe=Q.offset,xe=Q.getReferenceClientRect,ye=Q.moveTransition,je=R()?Ik(T).arrow:null,Me=xe?{getBoundingClientRect:xe,contextElement:xe.contextElement||I()}:t,He={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Le){var nt=Le.state;if(R()){var st=B(),Kt=st.box;["placement","reference-hidden","escaped"].forEach(function(Ot){Ot==="placement"?Kt.setAttribute("data-placement",nt.placement):nt.attributes.popper["data-popper-"+Ot]?Kt.setAttribute("data-"+Ot,""):Kt.removeAttribute("data-"+Ot)}),nt.attributes.popper={}}}},et=[{name:"offset",options:{offset:fe}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!ye}},He];R()&&je&&et.push({name:"arrow",options:{element:je,padding:3}}),et.push.apply(et,(ae==null?void 0:ae.modifiers)||[]),k.popperInstance=rae(Me,T,Object.assign({},ae,{placement:ue,onFirstUpdate:h,modifiers:et}))}function Ge(){k.popperInstance&&(k.popperInstance.destroy(),k.popperInstance=null)}function Ce(){var Q=k.props.appendTo,ae,ue=I();k.props.interactive&&Q===pI||Q==="parent"?ae=ue.parentNode:ae=mI(Q,[ue]),ae.contains(T)||ae.appendChild(T),k.state.isMounted=!0,Re()}function De(){return Ny(T.querySelectorAll("[data-tippy-root]"))}function Ve(Q){k.clearDelayTimeouts(),Q&&V("onTrigger",[k,Q]),se();var ae=z(!0),ue=P(),fe=ue[0],xe=ue[1];ns.isTouch&&fe==="hold"&&xe&&(ae=xe),ae?n=setTimeout(function(){k.show()},ae):k.show()}function We(Q){if(k.clearDelayTimeouts(),V("onUntrigger",[k,Q]),!k.state.isVisible){de();return}if(!(k.props.trigger.indexOf("mouseenter")>=0&&k.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(Q.type)>=0&&s)){var ae=z(!1);ae?i=setTimeout(function(){k.state.isVisible&&k.hide()},ae):a=requestAnimationFrame(function(){k.hide()})}}function Ie(){k.state.isEnabled=!0}function rt(){k.hide(),k.state.isEnabled=!1}function ut(){clearTimeout(n),clearTimeout(i),cancelAnimationFrame(a)}function xt(Q){if(!k.state.isDestroyed){V("onBeforeUpdate",[k,Q]),te();var ae=k.props,ue=tM(t,Object.assign({},ae,Qj(Q),{ignoreAttributes:!0}));k.props=ue,q(),ae.interactiveDebounce!==ue.interactiveDebounce&&(L(),v=Yj(le,ue.interactiveDebounce)),ae.triggerTarget&&!ue.triggerTarget?qc(ae.triggerTarget).forEach(function(fe){fe.removeAttribute("aria-expanded")}):ue.triggerTarget&&t.removeAttribute("aria-expanded"),Y(),F(),j&&j(ae,ue),k.popperInstance&&(Re(),De().forEach(function(fe){requestAnimationFrame(fe._tippy.popperInstance.forceUpdate)})),V("onAfterUpdate",[k,Q])}}function bt(Q){k.setProps({content:Q})}function Nt(){var Q=k.state.isVisible,ae=k.state.isDestroyed,ue=!k.state.isEnabled,fe=ns.isTouch&&!k.props.touch,xe=SS(k.props.duration,0,_a.duration);if(!(Q||ae||ue||fe)&&!I().hasAttribute("disabled")&&(V("onShow",[k],!1),k.props.onShow(k)!==!1)){if(k.state.isVisible=!0,R()&&(T.style.visibility="visible"),F(),se(),k.state.isMounted||(T.style.transition="none"),R()){var ye=B(),je=ye.box,Me=ye.content;kS([je,Me],0)}h=function(){var et;if(!(!k.state.isVisible||u)){if(u=!0,T.offsetHeight,T.style.transition=k.props.moveTransition,R()&&k.props.animation){var tt=B(),Le=tt.box,nt=tt.content;kS([Le,nt],xe),Jj([Le,nt],"visible")}J(),Y(),Xj(NS,k),(et=k.popperInstance)==null||et.forceUpdate(),V("onMount",[k]),k.props.animation&&R()&&ne(xe,function(){k.state.isShown=!0,V("onShown",[k])})}},Ce()}}function Je(){var Q=!k.state.isVisible,ae=k.state.isDestroyed,ue=!k.state.isEnabled,fe=SS(k.props.duration,1,_a.duration);if(!(Q||ae||ue)&&(V("onHide",[k],!1),k.props.onHide(k)!==!1)){if(k.state.isVisible=!1,k.state.isShown=!1,u=!1,s=!1,R()&&(T.style.visibility="hidden"),L(),de(),F(!0),R()){var xe=B(),ye=xe.box,je=xe.content;k.props.animation&&(kS([ye,je],fe),Jj([ye,je],"hidden"))}J(),Y(),k.props.animation?R()&&W(fe,k.unmount):k.unmount()}}function Oe(Q){U().addEventListener("mousemove",v),Xj(lv,v),v(Q)}function ve(){k.state.isVisible&&k.hide(),k.state.isMounted&&(Ge(),De().forEach(function(Q){Q._tippy.unmount()}),T.parentNode&&T.parentNode.removeChild(T),NS=NS.filter(function(Q){return Q!==k}),k.state.isMounted=!1,V("onHidden",[k]))}function H(){k.state.isDestroyed||(k.clearDelayTimeouts(),k.unmount(),te(),delete t._tippy,k.state.isDestroyed=!0,V("onDestroy",[k]))}}function mm(t,e){e===void 0&&(e={});var r=_a.plugins.concat(e.plugins||[]);gae();var n=Object.assign({},e,{plugins:r}),i=dae(t),a=i.reduce(function(s,o){var l=o&&Eae(o,n);return l&&s.push(l),s},[]);return _x(t)?a[0]:a}mm.defaultProps=_a;mm.setDefaultProps=Sae;mm.currentInput=ns;Object.assign({},nI,{effect:function(e){var r=e.state,n={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(r.elements.popper.style,n.popper),r.styles=n,r.elements.arrow&&Object.assign(r.elements.arrow.style,n.arrow)}});mm.setDefaultProps({render:yI});const Tae=K.forwardRef((t,e)=>{const[r,n]=K.useState(0),i=l=>{const u=t.items[l];u&&t.command({id:u.id,label:u.label})},a=()=>{n((r+t.items.length-1)%t.items.length)},s=()=>{n((r+1)%t.items.length)},o=()=>{i(r)};return K.useEffect(()=>n(0),[t.items]),K.useImperativeHandle(e,()=>({onKeyDown:({event:l})=>l.key==="ArrowUp"?(a(),!0):l.key==="ArrowDown"?(s(),!0):l.key==="Enter"?(o(),!0):!1})),f.jsx("div",{className:"items bg-popover border border-border rounded-md shadow-lg overflow-hidden min-w-[200px] p-1",children:t.items.length?t.items.map((l,u)=>f.jsx("button",{className:`flex w-full items-center text-sm px-2 py-1.5 rounded-sm outline-none text-left ${u===r?"bg-accent text-accent-foreground":"text-popover-foreground"}`,onClick:()=>i(u),children:l.label},u)):f.jsx("div",{className:"item text-sm px-2 py-1.5 text-muted-foreground",children:"No result"})})}),jae={items:async({query:t})=>{try{return(await Ne.get("/world-bible/entities")).filter(r=>r.nombre.toLowerCase().startsWith(t.toLowerCase())).slice(0,5).map(r=>({id:r.id,label:r.nombre}))}catch(e){return console.error(e),[]}},render:()=>{let t,e;return{onStart:r=>{t=new lre(Tae,{props:r,editor:r.editor}),r.clientRect&&(e=mm("body",{getReferenceClientRect:r.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(r){t.updateProps(r),r.clientRect&&e[0].setProps({getReferenceClientRect:r.clientRect})},onKeyDown(r){var n;return r.event.key==="Escape"?(e[0].hide(),!0):(n=t.ref)==null?void 0:n.onKeyDown(r)},onExit(){e[0].destroy(),t.destroy()}}}},Mae=({content:t,onUpdate:e,editable:r=!0})=>{const n=tre({extensions:[Gne,Hne.configure({placeholder:"Escribe tu historia aqu... Usa @ para mencionar entidades."}),Qne.configure({HTMLAttributes:{class:"mention"},suggestion:jae})],content:t,editable:r,onUpdate:({editor:i})=>{e(i.getHTML())},editorProps:{attributes:{class:"prose prose-invert max-w-none focus:outline-none min-h-[300px] p-4 text-foreground/90 leading-relaxed font-serif text-lg"}}});return K.useEffect(()=>{n&&t!==n.getHTML()&&n.commands.setContent(t)},[t,n]),n?f.jsxs("div",{className:"zen-editor-container w-full h-full overflow-y-auto no-scrollbar bg-card/20 rounded-lg border border-border/50",children:[f.jsx(Kte,{editor:n,className:"h-full"}),f.jsx("style",{jsx:!0,global:!0,children:`
        .mention {
          @apply bg-primary/20 text-primary-light font-medium rounded-sm px-1 py-0.5 cursor-pointer hover:bg-primary/30 decoration-clone;
        }
        .tiptap p.is-editor-empty:first-child::before {
          color: #6b7280;
          content: attr(data-placeholder);
          float: left;
          height: 0;
          pointer-events: none;
        }
      `})]}):null},Pae=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirm",cancelText:s="Cancel",isDestructive:o=!0})=>t?f.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[f.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",onClick:e}),f.jsx("div",{className:"relative z-10 w-full max-w-md animate-in zoom-in-95 duration-300",children:f.jsxs(Et,{className:"p-6 border-red-500/20 shadow-2xl shadow-black/50",children:[f.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[f.jsx("div",{className:`
                            size-12 rounded-xl flex items-center justify-center shrink-0
                            ${o?"bg-red-500/10 text-red-500":"bg-primary/10 text-primary"}
                        `,children:f.jsx("span",{className:"material-symbols-outlined text-2xl",children:o?"warning":"help"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-black text-white mb-2 leading-tight",children:n}),f.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:i})]})]}),f.jsxs("div",{className:"flex items-center justify-end gap-3",children:[f.jsx(Wt,{variant:"ghost",onClick:e,children:s}),f.jsx(Wt,{variant:o?"danger":"primary",onClick:()=>{r(),e()},icon:o?"delete":"check",children:a})]})]})})]}):null,xI=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,initialValue:a="",placeholder:s="",confirmText:o="Confirmar",cancelText:l="Cancelar"})=>{const[u,c]=K.useState(a),d=K.useRef(null);if(K.useEffect(()=>{c(a)},[a,t]),K.useEffect(()=>{t&&d.current&&setTimeout(()=>d.current.focus(),50)},[t]),!t)return null;const h=m=>{m.preventDefault(),r(u),e()};return Zs.createPortal(f.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-md animate-in fade-in duration-300",children:f.jsxs("div",{className:"bg-[#0f0f13] border border-white/10 rounded-2xl p-6 shadow-2xl shadow-black/50 w-full max-w-md space-y-5 animate-in zoom-in-95 slide-in-from-bottom-2 duration-300 relative overflow-hidden ring-1 ring-white/5",onClick:m=>m.stopPropagation(),children:[f.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary to-transparent opacity-70"}),f.jsx("div",{className:"absolute -top-10 -right-10 size-40 bg-primary/5 rounded-full blur-3xl pointer-events-none"}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:n}),i&&f.jsx("p",{className:"text-sm text-slate-400 leading-relaxed mt-2",children:i})]}),f.jsxs("form",{onSubmit:h,className:"space-y-6",children:[f.jsx("input",{ref:d,type:"text",value:u,onChange:m=>c(m.target.value),placeholder:s,className:"w-full bg-black/30 border border-white/10 rounded-xl px-4 py-3.5 text-white placeholder-slate-600 focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all font-sans text-sm shadow-inner"}),f.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[f.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors",children:l}),f.jsx(Wt,{type:"submit",variant:"primary",disabled:!u.trim(),children:o})]})]})]})}),document.body)},_ae=({notebooks:t,loading:e,onSelectNotebook:r,onCreateNotebook:n,onDeleteNotebook:i})=>{const[a,s]=K.useState(!1),[o,l]=K.useState(null),u=d=>{n(d)},c=()=>{o&&(i(o.id),l(null))};return f.jsxs("div",{className:"p-8 w-full h-full overflow-y-auto",children:[f.jsxs("div",{className:"max-w-7xl mx-auto",children:[f.jsxs("header",{className:"flex justify-between items-center mb-12",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-4xl font-serif text-slate-200 mb-2",children:"Your Notebooks"}),f.jsx("p",{className:"text-slate-500 font-mono text-sm",children:"Select a chronicle to begin writing"})]}),f.jsxs("button",{onClick:()=>s(!0),className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all shadow-lg shadow-indigo-500/20",children:[f.jsx("span",{className:"material-symbols-outlined",children:"add"}),f.jsx("span",{className:"font-bold tracking-wide text-sm",children:"NEW NOTEBOOK"})]})]}),e?f.jsx("div",{className:"text-slate-500",children:"Loading chronicles..."}):f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.map(d=>f.jsxs("div",{onClick:()=>r(d),className:"group relative bg-[#050508] border border-white/10 rounded-2xl p-6 cursor-pointer hover:border-indigo-500/50 hover:shadow-2xl hover:shadow-indigo-900/10 transition-all duration-300 h-64 flex flex-col",children:[f.jsxs("div",{className:"flex-1 relative",children:[f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/5 flex items-center justify-center text-slate-400 group-hover:bg-indigo-500/10 group-hover:text-indigo-400 transition-colors mb-6",children:f.jsx("span",{className:"material-symbols-outlined text-2xl",children:"menu_book"})}),f.jsx("button",{onClick:h=>{h.stopPropagation(),l(d)},className:"opacity-0 group-hover:opacity-100 p-2 text-slate-500 hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-all",title:"Delete Notebook",children:f.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})})]}),f.jsx("h3",{className:"text-xl font-serif text-slate-200 group-hover:text-white mb-2 line-clamp-2",children:d.titulo}),f.jsx("p",{className:"text-slate-500 text-sm line-clamp-3",children:d.descripcion||"No description"})]}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 flex justify-between items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[f.jsx("span",{className:"text-xs font-mono text-slate-500",children:"OPEN CHRONICLE"}),f.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"arrow_forward"})]})]},d.id)),f.jsxs("button",{onClick:()=>s(!0),className:"border-2 border-dashed border-white/5 rounded-2xl p-6 h-64 flex flex-col items-center justify-center gap-4 text-slate-600 hover:text-slate-400 hover:border-white/10 transition-all",children:[f.jsx("span",{className:"material-symbols-outlined text-4xl",children:"add"}),f.jsx("span",{className:"font-mono text-xs uppercase tracking-widest",children:"Create New"})]})]})]}),f.jsx(xI,{isOpen:a,onClose:()=>s(!1),onConfirm:u,title:"New Notebook",message:"Give a title to your new chronicle.",placeholder:"Ex: The Lost Kingdom",confirmText:"Create Notebook"}),f.jsx(Pae,{isOpen:!!o,onClose:()=>l(null),onConfirm:c,title:"Delete Notebook?",message:`Are you sure you want to delete "${o==null?void 0:o.titulo}"? This action cannot be undone and will delete all pages inside.`,confirmText:"Delete Forever",isDestructive:!0})]})},Aae=()=>{const{setRightPanelMode:t,setRightOpen:e,setRightPanelTitle:r}=jl(),[n,i]=K.useState("dashboard"),[a,s]=K.useState(null),[o,l]=K.useState([]),[u,c]=K.useState(0),[d,h]=K.useState(!1),m=K.useRef(null),[v,x]=K.useState([]),[y,b]=K.useState(!0),[S,w]=K.useState(null);K.useEffect(()=>{t("NOTES"),k()},[]),K.useEffect(()=>{const F=setInterval(()=>{const V=document.getElementById("architect-right-panel-portal");V&&(w(V),clearInterval(F))},100);return()=>clearInterval(F)},[n]);const k=async()=>{try{b(!0);const F=await Ne.get("/escritura/cuadernos");x(F)}catch(F){console.error("Error loading notebooks:",F)}finally{b(!1)}},N=async F=>{try{const V=await Ne.post("/escritura/cuaderno",{titulo:F});x([...v,V])}catch(V){console.error(V),alert("Error creating notebook")}},T=async F=>{try{await Ne.delete(`/escritura/cuaderno/${F}`),x(v.filter(V=>V.id!==F))}catch(V){console.error(V),alert("Error deleting notebook")}},j=async F=>{s(F),await A(F.id),i("editor")},M=()=>{i("dashboard"),s(null),l([])},A=async F=>{try{const V=await Ne.get(`/escritura/cuaderno/${F}/hojas`);if(V&&V.length>0)l(V),c(0);else{const J=await Ne.post(`/escritura/cuaderno/${F}/hoja`,{});l([J]),c(0)}}catch(V){console.error("Error loading pages:",V),l([])}},P=F=>{if(!o[u])return;const V=[...o];V[u].contenido=F,l(V),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{D(V[u])},1500)},D=async F=>{h(!0);try{await Ne.put(`/escritura/hoja/${F.id}`,{contenido:F.contenido})}catch(V){console.error("Error saving page:",V)}finally{h(!1)}},R=async()=>{if(a)try{const F=await Ne.post(`/escritura/cuaderno/${a.id}/hoja`,{});l([...o,F]),c(o.length)}catch(F){console.error("Error creating page:",F)}},I=F=>{c(F)},U=()=>f.jsxs("div",{className:"flex flex-col h-full bg-[#08080A]",children:[f.jsxs("div",{className:"h-12 border-b border-white/5 flex items-center px-4 font-mono text-[10px] uppercase tracking-widest text-slate-500 whitespace-nowrap overflow-hidden text-ellipsis",children:["Library  ",v.length," Notebooks"]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:v.map(F=>f.jsx("button",{onClick:()=>j(F),className:"w-full text-left p-3 rounded-lg border-b border-white/5 hover:bg-white/5 transition-all group",children:f.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[f.jsx("div",{className:"text-slate-500 group-hover:text-indigo-400 transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-lg",children:"book"})}),f.jsx("span",{className:"font-serif font-bold text-sm text-slate-300 group-hover:text-white truncate",children:F.titulo})]})},F.id))})]}),B=()=>f.jsxs("div",{className:"flex flex-col h-full bg-[#08080A]",children:[f.jsxs("div",{className:"h-12 border-b border-white/5 flex items-center px-4 font-mono text-[10px] uppercase tracking-widest text-slate-500 whitespace-nowrap overflow-hidden text-ellipsis",children:["Index  ",o.length," Pages"]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:o.map((F,V)=>{var J;return f.jsxs("button",{onClick:()=>I(V),className:`w-full text-left p-3 rounded-lg border transition-all group ${V===u?"bg-indigo-500/10 border-indigo-500/30 text-indigo-200":"bg-transparent border-transparent hover:bg-white/5 text-slate-400"}`,children:[f.jsxs("div",{className:"flex justify-between items-center mb-1",children:[f.jsxs("span",{className:"font-serif font-bold text-sm truncate",children:["Page ",F.numeroPagina]}),V===u&&f.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 shrink-0 ml-2"})]}),f.jsx("p",{className:"text-[10px] line-clamp-2 opacity-50 font-mono break-words",children:((J=F.contenido)==null?void 0:J.replace(/<[^>]+>/g,"").substring(0,50))||"Empty page..."})]},F.id)})}),f.jsx("div",{className:"p-4 border-t border-white/5",children:f.jsxs("button",{onClick:R,className:"w-full py-2 bg-white/5 hover:bg-white/10 border border-white/5 rounded-lg text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[f.jsx("span",{className:"material-symbols-outlined text-base",children:"add"}),f.jsx("span",{children:"New Page"})]})})]}),z=o[u];return n==="dashboard"?f.jsxs(f.Fragment,{children:[S&&Zs.createPortal(U(),S),f.jsx(_ae,{notebooks:v,loading:y,onSelectNotebook:j,onCreateNotebook:N,onDeleteNotebook:T})]}):f.jsxs("div",{className:"flex-1 flex w-full h-full bg-[#050508] relative overflow-hidden",children:[S&&Zs.createPortal(B(),S),f.jsxs("div",{className:"flex-1 flex flex-col relative z-10 transition-all duration-300",children:[f.jsxs("header",{className:"h-12 border-b border-white/5 bg-surface-dark/40 backdrop-blur-md flex items-center justify-between px-6 select-none",children:[f.jsxs("div",{className:"flex items-center gap-4 text-xs font-serif text-slate-400",children:[f.jsxs("button",{onClick:M,className:"hover:text-white transition-colors flex items-center gap-1",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"}),"Dashboard"]}),f.jsx("span",{className:"opacity-20",children:"|"}),f.jsx("span",{className:"text-slate-300 font-bold tracking-wide",children:a==null?void 0:a.titulo}),f.jsx("span",{className:"opacity-20",children:"|"}),f.jsx("span",{children:new Date().toLocaleDateString()})]}),f.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-slate-500",children:[f.jsx("span",{children:(a==null?void 0:a.nombreProyecto)||"Workspace"}),f.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${d?"bg-amber-500 animate-pulse":"bg-emerald-500/50"}`})]})]}),f.jsx("main",{className:"flex-1 overflow-y-auto custom-scrollbar flex justify-center bg-[#101012] relative",children:z&&f.jsxs("div",{className:"w-full max-w-3xl py-12 px-8 min-h-full flex flex-col",children:[f.jsx("input",{type:"text",placeholder:"Untitled Page",className:"w-full bg-transparent text-4xl font-serif font-bold text-slate-200 placeholder:text-slate-700 border-none outline-none mb-8 text-center",defaultValue:`Page ${z.numeroPagina}`,readOnly:!0}),f.jsx("div",{className:"flex-1 bg-white/5 border border-white/5 rounded-sm shadow-2xl shadow-black/50 overflow-hidden relative",children:f.jsx(Mae,{content:z.contenido,onUpdate:P})})]})})]})]})};function Rae(){const{id:t}=Bi();Li();const[e,r]=K.useState([]),[n,i]=K.useState(!0),[a,s]=K.useState(null);K.useEffect(()=>{o()},[t]);const o=async()=>{try{i(!0);const c=await Ne.get("/api/papelera/items");r(c),s(null)}catch(c){console.error("Error loading trash:",c),s("Failed to load trash items.")}finally{i(!1)}},l=async(c,d)=>{try{await Ne.post(`/api/papelera/restaurar/${c}/${d}`),o()}catch(h){console.error("Restoration failed",h)}},u=async(c,d)=>{if(window.confirm("Are you sure you want to PERMANENTLY delete this item? This cannot be undone."))try{await Ne.delete(`/api/papelera/eliminar/${c}/${d}`),o()}catch(h){console.error("Deletion failed",h)}};return n?f.jsx("div",{className:"text-white p-8",children:"Loading Trash Bin..."}):f.jsxs("div",{className:"flex flex-col h-full bg-[#09090b] text-white p-8 overflow-y-auto",children:[f.jsx("h1",{className:"text-3xl font-light mb-2 text-white/90",children:"Trash Bin"}),f.jsx("p",{className:"text-white/50 mb-8 font-light text-sm",children:"Items are automatically deleted after 30 days."}),a&&f.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 p-4 rounded mb-6",children:a}),e.length===0?f.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-50 border border-dashed border-white/10 rounded-xl",children:[f.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"delete_outline"}),f.jsx("p",{children:"Trash is empty"})]}):f.jsx("div",{className:"bg-zinc-900/50 rounded-xl border border-white/5 overflow-hidden",children:f.jsxs("table",{className:"w-full text-left border-collapse",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"border-b border-white/5 text-xs text-white/40 uppercase tracking-wider",children:[f.jsx("th",{className:"p-4 font-normal",children:"Name"}),f.jsx("th",{className:"p-4 font-normal",children:"Type"}),f.jsx("th",{className:"p-4 font-normal",children:"Deleted Date"}),f.jsx("th",{className:"p-4 font-normal text-right",children:"Actions"})]})}),f.jsx("tbody",{className:"divide-y divide-white/5",children:e.map(c=>f.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[f.jsx("td",{className:"p-4 text-white/80 font-medium",children:c.nombre||"Untitled"}),f.jsx("td",{className:"p-4 text-white/50 text-sm",children:c.tipo}),f.jsx("td",{className:"p-4 text-white/50 text-sm font-mono",children:c.deleted_date?new Date(c.deleted_date).toLocaleDateString():"-"}),f.jsxs("td",{className:"p-4 text-right space-x-2",children:[f.jsx("button",{onClick:()=>l(c.tipo,c.id),className:"px-3 py-1.5 text-xs bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20 rounded-md transition-colors border border-emerald-500/20",children:"RESTORE"}),f.jsx("button",{onClick:()=>u(c.tipo,c.id),className:"px-3 py-1.5 text-xs bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-md transition-colors border border-red-500/20",children:"DELETE"})]})]},`${c.tipo}-${c.id}`))})]})})]})}const Dae=({attribute:t,value:e,onChange:r,onRemove:n,linkableEntities:i=[]})=>{const a=t.plantilla||t,s=()=>{switch(a.tipo){case"text":return f.jsx("textarea",{className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none resize-none no-scrollbar h-auto min-h-[100px]",value:e||"",onChange:h=>r(h.target.value),placeholder:"..."});case"short_text":return f.jsx("input",{type:"text",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none",value:e||"",onChange:h=>r(h.target.value),placeholder:"..."});case"number":return f.jsx("input",{type:"number",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none",value:e||"",onChange:h=>r(h.target.value)});case"boolean":return f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("button",{onClick:()=>r(e==="true"?"false":"true"),className:`size-6 rounded-lg border flex items-center justify-center transition-all ${e==="true"?"bg-primary border-primary text-white":"border-glass-border text-transparent hover:border-primary/50"}`,children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"check"})}),f.jsx("span",{className:"text-xs text-text-muted",children:e==="true"?"Enabled":"Disabled"})]});case"select":let o=[];try{o=(typeof a.metadata=="string"?JSON.parse(a.metadata||"{}"):a.metadata||{}).options||[]}catch{}return f.jsxs("div",{className:"relative",children:[f.jsxs("select",{className:"w-full bg-black/30 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-primary/50 appearance-none cursor-pointer",value:e||"",onChange:h=>r(h.target.value),children:[f.jsx("option",{value:"",children:"Select an option..."}),o.map((h,m)=>f.jsx("option",{value:h,className:"bg-surface-dark text-white p-2",children:h},m))]}),f.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/50",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"unfold_more"})})]});case"multi_select":let l=[];try{l=(typeof a.metadata=="string"?JSON.parse(a.metadata||"{}"):a.metadata||{}).options||[]}catch{}let u=[];try{u=e?JSON.parse(e):[],Array.isArray(u)||(u=[])}catch(h){console.error("Error parsing select values",h)}const c=h=>{const m=u.includes(h)?u.filter(v=>v!==h):[...u,h];r(JSON.stringify(m))};return f.jsxs("div",{className:"bg-black/20 border border-white/5 rounded-xl p-2 space-y-1 max-h-40 overflow-y-auto custom-scrollbar",children:[l.map((h,m)=>f.jsxs("label",{onClick:v=>{v.preventDefault(),c(h)},className:"flex items-center gap-3 p-2 hover:bg-white/5 rounded-lg cursor-pointer group transition-colors",children:[f.jsx("div",{className:`size-4 rounded border flex items-center justify-center transition-all ${u.includes(h)?"bg-primary border-primary":"border-white/10 group-hover:border-white/30"}`,children:u.includes(h)&&f.jsx("span",{className:"material-symbols-outlined text-[10px] text-white",children:"check"})}),f.jsx("span",{className:`text-xs font-medium ${u.includes(h)?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:h})]},m)),l.length===0&&f.jsx("div",{className:"text-xs text-slate-500 p-2 italic",children:"No options defined."})]});case"date":return f.jsx("input",{type:"date",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none [color-scheme:dark]",value:e||"",onChange:h=>r(h.target.value)});case"entity_link":return f.jsxs("div",{className:"relative",children:[f.jsxs("select",{className:"w-full bg-black/30 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-primary/50 appearance-none cursor-pointer",value:e||"",onChange:h=>r(h.target.value),children:[f.jsx("option",{value:"",children:"Select an Entity Link..."}),i.map(h=>f.jsx("option",{value:h.id,className:"bg-surface-dark text-white p-2",children:h.nombre},h.id))]}),f.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/50",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"link"})})]});case"image":return f.jsxs("div",{className:"space-y-2",children:[f.jsx("div",{className:"flex gap-2",children:f.jsx("input",{type:"text",className:"flex-1 bg-black/30 border border-white/5 rounded-xl px-4 py-2 text-xs text-text-muted focus:text-white focus:outline-none",placeholder:"Image URL...",value:e||"",onChange:h=>r(h.target.value)})}),e&&f.jsx("div",{className:"w-full aspect-video rounded-xl bg-black/40 border border-white/5 overflow-hidden relative group",children:f.jsx("img",{src:e,alt:"Preview",className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"})}),!e&&f.jsx("div",{className:"w-full h-20 rounded-xl bg-white/5 border border-dashed border-white/10 flex items-center justify-center text-text-muted/30",children:f.jsx("span",{className:"material-symbols-outlined",children:"image"})})]});case"table":const d=e||"[]";return f.jsxs("div",{className:"space-y-2",children:[f.jsx("textarea",{className:"w-full h-32 bg-black/30 border border-white/5 rounded-xl p-3 text-xs font-mono text-white/70 focus:outline-none focus:border-primary/50",value:d,onChange:h=>r(h.target.value),placeholder:'[{"Item": "Sword", "Qty": 1}, ...]'}),f.jsxs("div",{className:"text-[10px] text-text-muted flex justify-between",children:[f.jsx("span",{children:"JSON Format supported"}),f.jsx("span",{className:"material-symbols-outlined text-xs",children:"data_array"})]})]});default:return f.jsxs("div",{className:"text-sm font-medium text-white/70 italic p-2 rounded-lg bg-white/5 border border-white/5",children:[f.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 mr-2",children:a.tipo}),e]})}};return f.jsxs("div",{className:"p-4 border border-white/5 rounded-2xl bg-surface-dark/50 backdrop-blur-sm relative overflow-hidden h-full flex flex-col group hover:border-primary/20 transition-all",children:[f.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted mb-3 flex items-center justify-between gap-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-xs opacity-50",children:"label"}),a.nombre]}),n&&f.jsx("button",{onClick:o=>{o.preventDefault(),n()},className:"text-white/20 hover:text-red-400 transition-colors",title:"Remove Attribute",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]}),f.jsx("div",{className:"flex-1 nodrag",children:s()}),f.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"})]})},Oae=[{value:"entidadIndividual",label:"Character"},{value:"entidadColectiva",label:"Group"},{value:"zona",label:"Location"},{value:"construccion",label:"Building"},{value:"efectos",label:"Effect"},{value:"interaccion",label:"Interaction"},{value:"lineatiempo",label:"Timeline"},{value:"eventotiempo",label:"Event"},{value:"mapa",label:"Map"}],Iae=({entityId:t,entityType:e})=>{const[r,n]=K.useState([]),[i,a]=K.useState(!1),[s,o]=K.useState(!1),[l,u]=K.useState("entidadIndividual"),[c,d]=K.useState([]),[h,m]=K.useState(""),[v,x]=K.useState(""),[y,b]=K.useState(""),[S,w]=K.useState(!1);K.useEffect(()=>{t&&k()},[t,e]),K.useEffect(()=>{s&&l&&N(l)},[s,l]);const k=async()=>{a(!0);try{const P=(await Ne.get("/bd/relacion")).filter(R=>R.nodoOrigenId===parseInt(t)&&R.tipoOrigen===e||R.nodoDestinoId===parseInt(t)&&R.tipoDestino===e),D=await Promise.all(P.map(async R=>{const I=R.nodoOrigenId===parseInt(t),U=I?R.nodoDestinoId:R.nodoOrigenId,B=I?R.tipoDestino:R.tipoOrigen;try{const z=await Ne.get(`/bd/${B}/${U}`);return{...R,otherName:z.nombre,otherType:B,isOutgoing:I}}catch{return{...R,otherName:"Unknown/Deleted",otherType:B,isOutgoing:I}}}));n(D)}catch(A){console.error("Failed to load relationships",A)}finally{a(!1)}},N=async A=>{w(!0);try{const P=await Ne.get(`/bd/${A}`);d(P||[])}catch(P){console.error("Failed to fetch targets",P),d([])}finally{w(!1)}},T=async()=>{if(!(!h||!v))try{const A={nodoOrigenId:parseInt(t),tipoOrigen:e,nodoDestinoId:parseInt(h),tipoDestino:l,tipoRelacion:v,descripcion:y,tipoEntidad:"relacion"};await Ne.put("/bd/insertar",A),o(!1),M(),k()}catch(A){console.error("Failed to save relationship",A),alert("Error saving relationship")}},j=async A=>{if(confirm("Are you sure?"))try{await Ne.delete(`/bd/relacion/${A}`),k()}catch(P){console.error("Failed to delete",P)}},M=()=>{u("entidadIndividual"),m(""),x(""),b("")};return f.jsxs("div",{className:"p-6 space-y-6",children:[f.jsxs("header",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-widest",children:"Relationships"}),f.jsx(Wt,{variant:"secondary",icon:"add_link",onClick:()=>o(!s),children:s?"Cancel":"Connect"})]}),s&&f.jsxs("div",{className:"p-4 rounded-2xl bg-white/5 border border-white/10 space-y-4 animate-in fade-in slide-in-from-top-4",children:[f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Target Type"}),f.jsx("select",{className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:l,onChange:A=>u(A.target.value),children:Oae.map(A=>f.jsx("option",{value:A.value,children:A.label},A.value))})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Target Entity"}),f.jsxs("select",{className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:h,onChange:A=>m(A.target.value),disabled:S,children:[f.jsx("option",{value:"",children:"Select Target..."}),c.map(A=>f.jsx("option",{value:A.id,children:A.nombre},A.id))]})]})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Relationship Type"}),f.jsx("input",{type:"text",placeholder:"e.g. Father of, Located in, Enemy of...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:v,onChange:A=>x(A.target.value)})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Description (The Why)"}),f.jsx("textarea",{placeholder:"Explain the nature of this connection...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary h-20 resize-none",value:y,onChange:A=>b(A.target.value)})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(Wt,{variant:"primary",icon:"save",onClick:T,disabled:!h||!v,children:"Save Connection"})})]}),f.jsx("div",{className:"space-y-3",children:i?f.jsx("div",{className:"text-center text-slate-500 py-8",children:"Scanning connections..."}):r.length===0?f.jsx("div",{className:"text-center text-slate-500 py-8 italic border border-dashed border-white/10 rounded-2xl",children:"No connections established"}):r.map((A,P)=>f.jsxs("div",{className:"group relative p-4 rounded-2xl bg-surface-dark border border-white/5 hover:border-primary/50 transition-all flex items-start gap-4",children:[f.jsx("div",{className:"mt-1",children:f.jsx("span",{className:"material-symbols-outlined text-slate-500",children:A.isOutgoing?"arrow_outward":"arrow_inward"})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[f.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:A.isOutgoing?"To:":"From:"}),f.jsx("span",{className:"text-sm font-bold text-white",children:A.otherName}),f.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-white/10 text-slate-400 font-bold uppercase tracking-wider",children:A.otherType})]}),f.jsx("div",{className:"text-primary text-xs font-black uppercase tracking-widest mb-2",children:A.tipoRelacion}),A.descripcion&&f.jsxs("p",{className:"text-xs text-slate-400 leading-relaxed bg-black/20 p-2 rounded-lg border border-white/5",children:['"',A.descripcion,'"']})]}),f.jsx("button",{onClick:()=>j(A.id),className:"opacity-0 group-hover:opacity-100 p-2 text-slate-600 hover:text-red-400 transition-all",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},A.id||P))})]})},uh=({mode:t})=>{const{username:e,projectName:r,entitySlug:n,folderSlug:i,type:a}=Bi(),s=Li(),o=t==="creation",{setRightOpen:l,setAvailableTemplates:u,setRightPanelMode:c,setAddAttributeHandler:d,setEntityTabs:h,activeEntityTab:m,setActiveEntityTab:v}=jl(),[x,y]=K.useState({nombre:"",tipo:"entidadindividual",descripcion:"",color:"#6366f1",apariencia:"",notas:"",iconUrl:null,tipoEspecial:a||null,carpeta:null,categoria:"Individual"}),[b,S]=K.useState([]),[w,k]=K.useState(!0),[N,T]=K.useState(!1),[j,M]=K.useState([]),[A,P]=K.useState([]),[D,R]=K.useState(!1);K.useEffect(()=>(l(!0),c("ENTITY"),h(["identity","narrative","attributes"]),v("identity"),()=>{c("NOTES"),h([])}),[]),K.useEffect(()=>{o?U():B()},[n,i,o]);const I=L=>{u(L),P(L),d(G=>{const ee=L.find(re=>re.id===G);ee&&S(re=>[...re,{id:`temp-${ee.id}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,attribute:ee,value:ee.valorDefecto||"",isTemp:!0}])})},U=async()=>{k(!0);try{const L=await Ne.get(`/world-bible/folders/${i}`),G=await Ne.get(`/world-bible/folders/${i}/templates`);I(G),y(re=>({...re,nombre:`Nuevo ${a==="map"?"Mapa":a==="timeline"?"Cronograma":"Ente"}`,carpeta:L,tipoEspecial:a||"entidadindividual",tipo:a||"entidadindividual"}));const ee=G.filter(re=>re.esObligatorio).map(re=>({id:`temp-${re.id}-${Math.random().toString(36).substr(2,9)}`,attribute:re,value:re.valorDefecto||"",isTemp:!0}));S(ee)}catch(L){console.error("Error creating draft:",L)}finally{k(!1)}},B=async()=>{var L;k(!0);try{const G=await Ne.get(`/world-bible/entities/${n}`);if(y({...G,apariencia:G.apariencia||"",notas:G.notas||"",iconUrl:G.iconUrl||null,tags:G.tags||"",tipo:G.tipoEspecial||getHierarchyType(G.tipo).id,color:G.color||"#6366f1",categoria:G.categoria||"Individual"}),(L=G.carpeta)!=null&&L.id){const re=await Ne.get(`/world-bible/folders/${G.carpeta.id}/templates`);I(re)}const ee=(G.valores||[]).filter(re=>re.plantilla).map(re=>({id:re.id.toString(),attribute:re.plantilla,value:re.valor,isTemp:!1}));S(ee)}catch(G){console.error("Error loading entity:",G)}finally{k(!1)}},z=(L,G)=>{y(ee=>({...ee,[L]:G}))},F=L=>{const G=L.target.files[0];if(G){const ee=new FileReader;ee.onloadend=()=>{z("iconUrl",ee.result)},ee.readAsDataURL(G)}},V=(L,G)=>{S(ee=>ee.map(re=>re.id===L?{...re,value:G}:re))},J=L=>{L.toString().startsWith("temp-")||M(G=>[...G,L]),S(G=>G.filter(ee=>ee.id!==L))},Y=async(L=!0)=>{T(!0);try{const G={nombre:x.nombre,descripcion:x.descripcion,tags:x.tags,apariencia:x.apariencia,notas:x.notas,iconUrl:x.iconUrl,tipoEspecial:x.tipoEspecial||"entidadindividual",color:x.color,categoria:x.categoria};let ee=x.id;if(o){if(!x.carpeta||!x.carpeta.id){alert("Error: No folder selected or folder not found."),T(!1);return}G.carpetaId=x.carpeta.id;const W=await Ne.post("/world-bible/entities",G);ee=W.id;const ne=[...b];for(let ie=0;ie<ne.length;ie++){const $=ne[ie];if($.isTemp){const q=await Ne.post(`/world-bible/entities/${W.id}/attributes`,{plantillaId:$.attribute.id});await Ne.patch(`/world-bible/entities/${W.id}/values`,[{valorId:q.id,nuevoValor:$.value}]),ne[ie]={...$,id:q.id.toString(),isTemp:!1}}}S(ne),T(!1),L?s(`/${e}/${r}/bible/folder/${i}`):s(`/${e}/${r}/bible/folder/${i}/entity/${W.slug||W.id}`,{replace:!0});return}await Ne.put(`/world-bible/entities/${ee}`,{nombre:G.nombre,color:G.color,iconUrl:G.iconUrl}),await Ne.patch(`/world-bible/entities/${ee}/details`,{descripcion:G.descripcion,tags:G.tags,apariencia:G.apariencia,notas:G.notas,iconUrl:G.iconUrl}),j.length>0&&(await Promise.all(j.map(W=>Ne.delete(`/world-bible/values/${W}`))),M([]));const re=b.filter(W=>!W.isTemp).map(W=>({valorId:parseInt(W.id),nuevoValor:W.value}));re.length>0&&await Ne.patch(`/world-bible/entities/${ee}/values`,re);let se=!1;const de=[...b];console.log("Saving fields...",b);for(let W=0;W<de.length;W++){const ne=de[W];if(ne.isTemp){console.log("Processing temp field:",ne);try{const ie=await Ne.post(`/world-bible/entities/${ee}/attributes`,{plantillaId:ne.attribute.id});console.log("Created attribute value:",ie),await Ne.patch(`/world-bible/entities/${ee}/values`,[{valorId:ie.id,nuevoValor:ne.value}]),de[W]={...ne,id:ie.id.toString(),isTemp:!1},se=!0}catch(ie){console.error("Error saving field:",ne,ie)}}}se&&S(de),T(!1)}catch(G){console.error("Save error",G),T(!1)}};return w?f.jsx("div",{className:"p-20 text-center animate-pulse",children:"Loading Builder..."}):f.jsx("div",{className:"flex h-full w-full bg-background-dark overflow-hidden",children:f.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-y-auto custom-scrollbar relative",children:[f.jsxs("div",{className:"border-b border-white/5 p-4 flex justify-between items-center bg-background-dark/80 backdrop-blur sticky top-0 z-30",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx(x0,{url:x.iconUrl,name:x.nombre,className:"size-10 rounded-lg border border-white/10"}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-lg font-bold text-white leading-tight",children:x.nombre||"Sin Nombre"}),f.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest text-slate-500",children:o?"Creando Nueva Entidad":"Editando Entidad"})]})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("button",{onClick:()=>s(`/${e}/${r}/bible/folder/${i}`),className:"px-4 py-2 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 text-xs font-bold uppercase tracking-widest transition-all",children:"Cancelar"}),f.jsxs("div",{className:"flex bg-white/5 rounded-xl p-1 gap-1 border border-white/10",children:[f.jsxs("button",{onClick:()=>Y(!0),disabled:N,className:"h-9 px-4 rounded-lg bg-primary hover:bg-primary-light text-white text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 disabled:opacity-50",children:[N?f.jsx("span",{className:"material-symbols-outlined animate-spin text-sm",children:"refresh"}):f.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar"]}),f.jsx("div",{className:"w-px bg-white/10 my-1"}),f.jsx("button",{onClick:()=>Y(!1),disabled:N,className:"h-9 px-3 rounded-lg bg-transparent hover:bg-white/10 text-white transition-all flex items-center justify-center disabled:opacity-50",title:"Guardar y Seguir Editando",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit_document"})})]})]})]}),f.jsxs("div",{className:"p-8 pb-32 max-w-5xl mx-auto w-full",children:[m==="identity"&&f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[f.jsxs(Et,{className:`p-6 space-y-6 ${x.tipoEspecial==="map"?"lg:col-span-2":""}`,children:[f.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"badge"})," Identity"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Full Name"}),f.jsx("input",{value:x.nombre,onChange:L=>z("nombre",L.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none transition-colors",placeholder:"E.g. King Alaric"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Entity Type / Category"}),f.jsxs("select",{value:x.categoria||"Individual",onChange:L=>z("categoria",L.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none transition-colors appearance-none",children:[f.jsx("option",{value:"Individual",children:"Individual (Character/Person)"}),f.jsx("option",{value:"Group",children:"Group / Faction"}),f.jsx("option",{value:"Location",children:"Location"}),f.jsx("option",{value:"Event",children:"Event"}),f.jsx("option",{value:"Object",children:"Object / Item"}),f.jsx("option",{value:"Concept",children:"Concept / Magic"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Tags (comma separated)"}),f.jsx("input",{value:x.tags,onChange:L=>z("tags",L.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-slate-300 focus:border-primary/50 outline-none transition-colors",placeholder:"Warrior, Leader, Human..."})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Icon / Portrait"}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx(x0,{url:x.iconUrl,name:x.nombre,size:"lg",className:"rounded-xl"}),f.jsxs("label",{className:"cursor-pointer px-4 py-2 bg-white/5 hover:bg-white/10 rounded-lg border border-white/10 text-xs font-bold text-slate-300 transition-colors",children:["Upload Image",f.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:F})]}),x.iconUrl&&f.jsx("button",{onClick:()=>z("iconUrl",""),className:"p-2 hover:text-red-400 transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]})]})]}),x.tipoEspecial!=="map"&&f.jsxs(Et,{className:"p-6 space-y-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"palette"})," Appearance"]}),f.jsx("div",{className:"flex gap-2",children:f.jsxs("label",{className:"cursor-pointer text-[10px] font-bold uppercase tracking-wider text-slate-500 hover:text-white transition-colors flex items-center gap-1",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"add_photo_alternate"}),"Insert Image",f.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:L=>{const G=L.target.files[0];if(G){const ee=new FileReader;ee.onloadend=()=>{const re=`

![${G.name}](${ee.result})
`;z("apariencia",(x.apariencia||"")+re)},ee.readAsDataURL(G)}}})]})})]}),f.jsx("textarea",{value:x.apariencia,onChange:L=>z("apariencia",L.target.value),className:"w-full h-80 bg-black/30 border border-white/10 rounded-xl p-4 text-sm text-slate-300 leading-relaxed focus:border-primary/50 outline-none transition-colors custom-scrollbar font-mono",placeholder:"Describe their physical appearance, clothing, distinct marks... (Markdown Supported)"})]}),x.tipoEspecial==="map"?f.jsxs(Et,{className:"p-6 lg:col-span-2 space-y-6",children:[f.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Cartography"]}),f.jsx("div",{onClick:()=>{let L=x.iconUrl;try{const G=JSON.parse(x.descripcion||"{}");G.snapshotUrl&&(L=G.snapshotUrl)}catch{}R(!0)},className:"w-full aspect-[21/9] bg-black/30 border border-white/10 rounded-xl overflow-hidden cursor-pointer group relative",children:(()=>{let L=x.iconUrl;try{const G=JSON.parse(x.descripcion||"{}");G.snapshotUrl&&(L=G.snapshotUrl)}catch{}return L?f.jsxs(f.Fragment,{children:[f.jsx("img",{src:L,alt:"Map Preview",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),f.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:f.jsx("span",{className:"material-symbols-outlined text-white text-3xl",children:"zoom_in"})})]}):f.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-xs italic",children:"No map preview available"})})()}),f.jsx("div",{className:"flex justify-end",children:f.jsx(Wt,{variant:"secondary",size:"sm",icon:"edit",onClick:()=>window.open(`/${e}/${r}/map-editor/edit/${x.id}`,"_self"),children:"Open Editor"})})]}):f.jsxs(Et,{className:"p-6 lg:col-span-2",children:[f.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"sticky_note_2"})," Quick Notes"]}),f.jsx("textarea",{className:"w-full h-40 bg-black/30 border border-white/10 rounded-xl p-4 text-sm text-slate-300 leading-relaxed resize-none focus:border-primary/50 outline-none transition-colors custom-scrollbar font-mono placeholder:text-slate-600",placeholder:"Quick notes about this entity...",value:x.notas||"",onChange:L=>z("notas",L.target.value)})]})]}),m==="narrative"&&f.jsxs("div",{className:"animate-in fade-in duration-500 space-y-8",children:[f.jsxs(Et,{className:"min-h-[40vh] flex flex-col p-8",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"history_edu"})," Biography"]}),f.jsx("span",{className:"text-[10px] text-slate-500 bg-white/5 px-2 py-1 rounded",children:"Markdown Supported"})]}),f.jsx("textarea",{className:"flex-1 w-full bg-transparent border-none outline-none text-slate-300 leading-relaxed resize-none focus:ring-0 placeholder:text-slate-600 custom-scrollbar text-base min-h-[300px]",placeholder:"Write the origin story...",value:x.descripcion||"",onChange:L=>z("descripcion",L.target.value)})]}),f.jsxs(Et,{className:"min-h-[40vh]",children:[f.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary p-6 pb-0 flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})," Relationships"]}),o?f.jsxs("div",{className:"p-12 text-center text-slate-500",children:[f.jsx("span",{className:"material-symbols-outlined text-4xl mb-4",children:"save_as"}),f.jsx("p",{className:"text-sm font-bold",children:"Please save the entity first to manage relationships."})]}):f.jsx(Iae,{entityId:x.id,entityType:x.tipo||"entidadindividual"})]})]}),m==="attributes"&&f.jsxs("div",{className:`animate-in fade-in duration-500 space-y-6 min-h-[50vh] transition-colors rounded-2xl p-4 ${window.isDraggingOver?"bg-primary/10 border-2 border-dashed border-primary":""}`,onDragOver:L=>{L.preventDefault(),L.dataTransfer.dropEffect="copy",L.currentTarget.classList.add("bg-primary/10","border-primary","border-dashed","border-2")},onDragLeave:L=>{L.preventDefault(),L.currentTarget.classList.remove("bg-primary/10","border-primary","border-dashed","border-2")},onDrop:L=>{if(L.preventDefault(),L.currentTarget.classList.remove("bg-primary/10","border-primary","border-dashed","border-2"),L.dataTransfer.getData("application/reactflow/type")!=="attribute")return;let ee=null;try{const re=L.dataTransfer.getData("templateData");if(re)ee=JSON.parse(re);else{const se=parseInt(L.dataTransfer.getData("templateId"));ee=A.find(de=>de.id===se)}}catch(re){console.error("Drop error",re)}ee&&S(re=>[...re,{id:`temp-${ee.id}-${Date.now()}`,attribute:ee,value:ee.valorDefecto||"",isTemp:!0}])},children:[f.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary border-b border-white/5 pb-4 flex items-center justify-between",children:[f.jsx("span",{children:"Atributos especiales"}),f.jsx("span",{className:"text-[10px] text-slate-500 font-normal normal-case opacity-50 hidden md:block",children:"Arraste atributos desde el panel derecho"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 border-2 border-dashed border-white/5 rounded-2xl hover:border-primary/20 transition-colors bg-white/[0.01]",children:[b.length===0&&f.jsxs("div",{className:"col-span-full py-12 text-center text-slate-500 text-sm pointer-events-none",children:[f.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"drag_indicator"}),f.jsx("p",{children:"Arrastra plantillas aqu para aadir atributos"})]}),b.filter(L=>L.attribute).map(L=>f.jsx(Dae,{attribute:L.attribute,value:L.value,onChange:G=>V(L.id,G),onRemove:()=>J(L.id)},L.id))]})]})]}),D&&x.iconUrl&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-300",onClick:()=>R(!1),children:f.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] p-2",children:[f.jsx("button",{onClick:()=>R(!1),className:"absolute -top-12 right-0 p-2 text-white hover:text-primary transition-colors",children:f.jsx("span",{className:"material-symbols-outlined text-3xl",children:"close"})}),f.jsx("img",{src:x.iconUrl,alt:x.nombre,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl border border-white/10",onClick:L=>L.stopPropagation()})]})})]})})},Lae=t=>{switch(t==null?void 0:t.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},Lk=({item:t,type:e,linkTo:r,onContextMenu:n,onDelete:i})=>{const a=e==="folder";return f.jsxs(Lu,{to:r,onContextMenu:n,className:"group relative flex flex-col p-4 rounded-3xl bg-surface-dark border border-glass-border hover:border-primary/50 hover:bg-white/5 transition-all duration-300 backdrop-blur-sm overflow-hidden",children:[t.iconUrl&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"absolute inset-0 z-0",children:f.jsx("img",{src:t.iconUrl,alt:"",className:"w-full h-full object-cover opacity-60 group-hover:scale-105 transition-transform duration-700"})}),f.jsx("div",{className:"absolute inset-0 z-0 bg-gradient-to-t from-[#0a0a0c] via-[#0a0a0c]/80 to-transparent"})]}),f.jsxs("div",{className:"relative z-10 flex items-start justify-between mb-4",children:[f.jsx("div",{className:`
                    size-12 rounded-2xl flex items-center justify-center text-xl transition-transform group-hover:scale-110 
                    ${a?"bg-primary/20 text-primary":"bg-white/5 text-text-muted group-hover:text-white backdrop-blur-md border border-white/5"}
                `,children:f.jsx("span",{className:"material-symbols-outlined",children:a?"folder":Lae(t.tipoEspecial)})}),a&&f.jsx("div",{className:"px-2 py-1 rounded-lg bg-surface-light/50 border border-glass-border text-[10px] font-black text-white shadow-sm backdrop-blur-md",children:t.itemCount||0})]}),f.jsxs("div",{className:"relative z-10 mt-auto",children:[f.jsx("h3",{className:"text-sm font-bold text-white truncate group-hover:text-primary transition-colors drop-shadow-md",children:t.nombre}),f.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted mt-1 opacity-70 group-hover:opacity-100 transition-opacity",children:a?"Folder":t.tipoEspecial||"Entity"})]}),f.jsxs("div",{className:"absolute top-4 right-4 z-20 flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[i&&f.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),i(t)},className:"p-1.5 rounded-lg bg-red-500/10 hover:bg-red-500 text-red-500 hover:text-white transition-all border border-red-500/20 shadow-lg shadow-red-500/5 group/del backdrop-blur-md",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})}),f.jsx("span",{className:"material-symbols-outlined text-primary text-sm transform group-hover:translate-x-1 transition-transform drop-shadow-md",children:"arrow_forward"})]})]})},Bae=({path:t,currentFolder:e})=>{const{username:r,projectName:n}=Bi(),i=`/${r}/${n}/bible`;return!t&&!e?null:f.jsxs("nav",{className:"flex items-center gap-2 text-[10px] uppercase font-bold tracking-wider text-slate-500 mb-4 overflow-x-auto no-scrollbar whitespace-nowrap",children:[f.jsxs(Lu,{to:i,className:"hover:text-primary transition-colors flex items-center gap-1",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"home"}),"Bible"]}),t&&t.map((a,s)=>f.jsxs(kt.Fragment,{children:[f.jsx("span",{className:"text-slate-700",children:"/"}),f.jsx(Lu,{to:`${i}/folder/${a.slug||a.id}`,className:"hover:text-primary transition-colors",children:a.nombre})]},a.id)),e&&f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"text-slate-700",children:"/"}),f.jsx("span",{className:"text-white bg-white/5 px-2 py-0.5 rounded",children:e.nombre})]})]})},ku={UNIVERSE:{id:"UNIVERSE",label:"Universo / Multiverso",description:"Contenedor supremo de realidades.",icon:"public",color:"text-purple-400",bgColor:"bg-purple-900/20"},GALAXY:{id:"GALAXY",label:"Galaxia",description:"Agrupacin masiva de sistemas estelares.",icon:"auto_awesome",color:"text-indigo-400",bgColor:"bg-indigo-900/20"},SYSTEM:{id:"SYSTEM",label:"Sistema Solar",description:"Estrella central y sus cuerpos orbitales.",icon:"wb_sunny",color:"text-yellow-400",bgColor:"bg-yellow-900/20"},PLANET:{id:"PLANET",label:"Planeta / Mundo",description:"Cuerpo celeste o plano de existencia principal.",icon:"public",color:"text-emerald-400",bgColor:"bg-emerald-900/20"},GEOGRAPHY:{id:"GEOGRAPHY",label:"Geografa",icon:"map",color:"text-green-300"},ENTITIES:{id:"ENTITIES",label:"Entidades",icon:"groups",color:"text-blue-300"},MAGIC:{id:"MAGIC",label:"Magia",icon:"auto_fix_high",color:"text-pink-300"},TIMELINE:{id:"TIMELINE",label:"Cronologa",icon:"history",color:"text-orange-300"},FACTIONS:{id:"FACTIONS",label:"Facciones",icon:"security",color:"text-red-300"},ITEMS:{id:"ITEMS",label:"Objetos",icon:"inventory_2",color:"text-gray-300"},FOLDER:{id:"FOLDER",label:"Carpeta",icon:"folder",color:"text-gray-400"}},Bk=t=>ku[t]||ku.FOLDER,Fae=()=>{const{username:t,projectName:e,folderSlug:r}=Bi(),n=Li(),{handleCreateEntity:i,handleDeleteEntity:a,handleCreateSimpleFolder:s,folderSearchTerm:o,folderFilterType:l}=jl(),[u,c]=K.useState([]),[d,h]=K.useState(null),[m,v]=K.useState([]),[x,y]=K.useState(!0),b=u.filter(N=>{const T=N.nombre.toLowerCase().includes(o.toLowerCase()),j=l==="ALL"||l==="MAP"&&N.tipoEspecial==="map"||l==="TIMELINE"&&N.tipoEspecial==="timeline"||l==="ENTITY"&&(!N.tipoEspecial||N.tipoEspecial==="entidadindividual");return T&&j});K.useEffect(()=>{const N=T=>{const{folderId:j,removeId:M,type:A,item:P,expand:D}=T.detail||{};j===((d==null?void 0:d.id)||r)&&(M?c(R=>R.filter(I=>I.id!==M)):P&&P.slug&&P.slug!==r?n(`/${t}/${e}/bible/folder/${P.slug}`,{replace:!0}):S())};return window.addEventListener("folder-update",N),()=>window.removeEventListener("folder-update",N)},[r,d==null?void 0:d.id]),K.useEffect(()=>{S()},[r]);const S=async()=>{y(!0);try{const[N,T]=await Promise.all([Ne.get(`/world-bible/folders/${r}/entities`),Ne.get(`/world-bible/folders/${r}`)]);c(N),T.folder?(h(T.folder),v(T.path||[])):(h(T||{name:"Folder"}),v([]))}catch(N){console.error("Error loading folder content:",N),h(null),v([])}finally{y(!1)}};if(x)return f.jsx("div",{className:"p-20 text-center animate-pulse text-text-muted",children:"Loading sector..."});if(!d)return f.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-20 text-text-muted",children:[f.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-20",children:"folder_off"}),f.jsx("h2",{className:"text-xl font-bold opacity-50",children:"Folder Not Found"}),f.jsx("p",{className:"text-sm opacity-30 mt-2",children:"The sector you are looking for does not exist or has been moved."}),f.jsx(Lu,{to:`/${t}/${e}/bible`,className:"mt-6 px-6 py-2 bg-white/5 hover:bg-white/10 rounded-full text-xs font-bold transition-colors",children:"Return to Root"})]});const w=d&&d.tipo&&(["UNIVERSE","GALAXY","SYSTEM","PLANET"].includes(d.tipo)||d.tipo==="MAGIC"),k=d?Bk(d.tipo):ku.FOLDER;return w?f.jsxs("div",{className:"flex-1 overflow-y-auto bg-[#0a0a0c] text-white w-full h-full relative",children:[f.jsxs("div",{className:`w-full min-h-[300px] ${k.bgColor} relative flex items-end p-10 border-b border-white/5`,children:[f.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0c] to-transparent opacity-80 pointer-events-none"}),f.jsx("div",{className:"absolute top-6 left-10 z-20",children:f.jsx(Bae,{path:m,currentFolder:d})}),f.jsxs("div",{className:"relative z-10 flex gap-8 items-end w-full max-w-7xl mx-auto",children:[f.jsx("div",{className:`w-32 h-32 rounded-3xl ${k.bgColor} border border-white/10 flex items-center justify-center shadow-2xl`,children:f.jsx("span",{className:`material-symbols-outlined text-6xl ${k.color}`,children:k.icon})}),f.jsxs("div",{className:"flex-1 mb-2",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[f.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border border-white/10 ${k.bgColor} ${k.color}`,children:k.label}),f.jsxs("span",{className:"text-white/30 text-xs font-mono tracking-widest uppercase",children:["ID: ",d.id]})]}),f.jsx("h1",{className:"text-6xl font-black tracking-tighter text-white mb-2",children:d.nombre}),f.jsx("p",{className:"text-lg text-white/50 max-w-2xl font-light leading-relaxed",children:d.descripcion||"Sin descripcin definida para este sector cosmolgico."})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("button",{onClick:()=>n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadindividual`),className:"px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"person_add"})," Nueva Entidad"]}),f.jsxs("button",{onClick:()=>n(`/${t}/${e}/map-editor/create/${r}`,{state:{folderId:d==null?void 0:d.id}}),className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all border border-glass-border",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Mapa"]})]})]})]}),f.jsxs("div",{className:"max-w-7xl mx-auto p-10 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-[#13141f] border border-white/5 rounded-2xl p-6",children:[f.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Estadsticas"}),f.jsx("div",{className:"grid grid-cols-2 gap-4",children:f.jsxs("div",{children:[f.jsx("div",{className:"text-2xl font-black text-white",children:u.length}),f.jsx("div",{className:"text-[10px] text-white/40 uppercase",children:"Entidades"})]})})]}),f.jsxs("div",{className:"bg-[#13141f] border border-white/5 rounded-2xl p-6 h-64 flex flex-col",children:[f.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Notas Rpidas"}),f.jsx("textarea",{className:"flex-1 bg-transparent resize-none outline-none text-sm text-white/70 placeholder-white/20",placeholder:"Escribir notas de la zona..."})]})]}),f.jsxs("div",{className:"lg:col-span-2",children:[f.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Contenido Interno"}),u.length===0&&f.jsxs("div",{className:"p-12 border border-dashed border-white/10 rounded-2xl text-center",children:[f.jsx("span",{className:"material-symbols-outlined text-4xl text-white/20 mb-2",children:"folder_open"}),f.jsx("p",{className:"text-white/30 text-sm",children:"Este sector est vaco."})]}),f.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:u.map(N=>f.jsx(Lk,{item:N,type:"entity",linkTo:`/${t}/${e}/bible/folder/${d.slug||r}/entity/${N.slug||N.id}`,onDelete:()=>a(N.id,(d==null?void 0:d.id)||r)},N.id))})]})]})]}):f.jsxs("div",{className:"flex-1 p-8 max-w-[1600px] mx-auto w-full h-full overflow-y-auto",children:[f.jsxs("header",{className:"mb-8 flex items-end justify-between",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsxs(Lu,{to:`/${t}/${e}/bible`,className:"text-xs font-bold text-text-muted hover:text-primary transition-colors flex items-center gap-1",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"})," Root"]}),d&&f.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] bg-white/5 border border-white/10 ${k.color}`,children:k.label})]}),f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("span",{className:`material-symbols-outlined text-3xl ${k.color}`,children:k.icon}),f.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter",children:(d==null?void 0:d.nombre)||"Unnamed Folder"})]}),f.jsx("p",{className:"text-white/50 text-sm mt-2 max-w-xl",children:d==null?void 0:d.descripcion})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("button",{onClick:()=>n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadindividual`),className:"h-10 px-4 rounded-xl bg-primary hover:bg-primary-light transition flex items-center gap-2 text-xs font-bold text-white shadow-lg shadow-primary/20",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"person"}),f.jsx("span",{children:"Nueva Entidad"})]}),f.jsxs("button",{onClick:()=>n(`/${t}/${e}/map-editor/create/${r}`,{state:{folderId:d==null?void 0:d.id}}),className:"h-10 px-4 rounded-xl bg-surface-light border border-white/5 hover:bg-white/10 transition flex items-center gap-2 text-xs font-bold text-white shadow-lg",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"}),f.jsx("span",{children:"Mapa"})]}),f.jsxs("button",{onClick:()=>s(d,"TIMELINE"),className:"h-10 px-4 rounded-xl bg-surface-light border border-white/5 hover:bg-white/10 transition flex items-center gap-2 text-xs font-bold text-white",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"timeline"}),f.jsx("span",{children:"Timeline"})]})]})]}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:b.map(N=>f.jsx(Lk,{item:N,type:"entity",linkTo:`/${t}/${e}/bible/folder/${(d==null?void 0:d.slug)||r}/entity/${N.slug||N.id}`,onDelete:()=>a(N.id,(d==null?void 0:d.id)||r)},N.id))}),u.length===0&&f.jsx("div",{className:"p-20 text-center border-2 border-dashed border-glass-border rounded-[3rem] opacity-30 mt-8",children:f.jsx("p",{className:"text-text-muted font-bold uppercase tracking-widest",children:"Empty Folder"})})]})},zae=t=>{switch(t==null?void 0:t.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},Vae=(t,e,r,n)=>{const i=r.slug||r.id;return`/${t}/${e}/bible/folder/${n||"root"}/entity/${i}`},bI=({folder:t,onCreateSubfolder:e,onRename:r,onDeleteFolder:n,onDeleteEntity:i,onCreateTemplate:a,onMoveEntity:s,onCreateEntity:o,onConfirmCreate:l,className:u})=>{const{username:c,projectName:d}=Bi(),h=Li(),[m,v]=K.useState(!1),[x,y]=K.useState({folders:[],entities:[]}),[b,S]=K.useState(!1),[w,k]=K.useState(null),[N,T]=K.useState(t.nombre),[j,M]=K.useState(!1),[A,P]=K.useState(null);K.useEffect(()=>{T(t.nombre)},[t.nombre]),K.useEffect(()=>{const L=G=>{var q,te,Z,le;const{folderId:ee,optimisticType:re,confirmedType:se,removeId:de,item:W,oldId:ne,expand:ie,type:$}=G.detail||{};if(ee===t.id){if(ie&&(v(!0),b||D()),b)if(re){const ge=re==="folder"?"folders":"entities";y(Ue=>({...Ue,[ge]:[...Ue[ge].filter(Te=>Te.id!==W.id),W]}))}else if(se){const ge=se==="folder"?"folders":"entities";y(Ue=>({...Ue,[ge]:Ue[ge].map(Te=>Te.id===ne?W:Te)}))}else if(de){const ge=$==="folder"?"folders":"entities";y(Ue=>({...Ue,[ge]:Ue[ge].filter(Te=>Te.id!==de)}))}else!re&&!se&&!de&&D()}else((q=G.detail)==null?void 0:q.targetFolderId)===t.id&&((te=G.detail)==null?void 0:te.type)==="move-in"?b&&D():((Z=G.detail)==null?void 0:Z.sourceFolderId)===t.id&&((le=G.detail)==null?void 0:le.type)==="move-out"&&b&&y(ge=>({...ge,entities:ge.entities.filter(Ue=>Ue.id!==Ue.detail.entityId)}))};return window.addEventListener("folder-update",L),()=>window.removeEventListener("folder-update",L)},[t.id,b]);const D=async()=>{try{console.log("Loading content for folder:",t.id,"Slug:",t.slug);const[L,G]=await Promise.all([Ne.get(`/world-bible/folders/${t.id}/subfolders`),Ne.get(`/world-bible/folders/${t.id}/entities`)]);y({folders:L,entities:G}),S(!0)}catch(L){console.error("Error reloading folder content:",L),L.message&&L.message.includes("404")&&console.error(`404 for folder ${t.id} (${t.nombre})`)}},R=L=>{L.stopPropagation(),v(!m),!b&&!m&&D()},I=()=>h(`/${c}/${d}/bible/folder/${t.slug||t.id}`),U=(L,G,ee,re)=>{L.preventDefault(),L.stopPropagation(),k({x:L.clientX,y:L.clientY,type:G,id:ee,name:re})},B=()=>k(null);K.useEffect(()=>{if(w)return window.addEventListener("click",B),()=>window.removeEventListener("click",B)},[w]);const z=L=>{if(L.key==="Enter"){L.preventDefault();const G=L.target.value.trim();G?l(t.id,G,"folder",t.parentId,t.tipoEspecial):t.isNew&&i(t.id,t.parentId)}};if(t.isNew)return f.jsx("div",{className:"px-3 py-1 animate-in fade-in zoom-in-95 duration-200",children:f.jsx("input",{autoFocus:!0,type:"text",className:"w-full bg-surface-light border border-primary/50 rounded px-2 py-1 text-xs text-white outline-none",placeholder:"Folder Name...",onKeyDown:z,onBlur:L=>{const G=L.target.value.trim();G?l(t.id,G,"folder",t.parentId):i(t.id,t.parentId)}})});const F=({item:L,type:G})=>f.jsx("div",{className:"px-3 py-1 animate-in fade-in zoom-in-95 duration-200",children:f.jsx("input",{autoFocus:!0,type:"text",defaultValue:L.nombre||"",className:"w-full bg-surface-light border border-primary/50 rounded px-2 py-1 text-xs text-white outline-none",placeholder:"Name...",onKeyDown:ee=>{if(ee.key==="Enter"){ee.preventDefault();const re=ee.target.value.trim();re?l(L.id,re,G,t.id,L.tipoEspecial):L.isNew&&i(L.id,t.id),P(null)}else ee.key==="Escape"&&(P(null),L.isNew&&i(L.id,t.id))},onBlur:ee=>{const re=ee.target.value.trim();re?l(L.id,re,G,t.id,L.tipoEspecial):L.isNew&&i(L.id,t.id),P(null)}})}),V=L=>{L.preventDefault(),L.stopPropagation(),L.currentTarget.classList.add("bg-primary/20")},J=L=>{L.preventDefault(),L.stopPropagation(),L.currentTarget.classList.remove("bg-primary/20")},Y=L=>{L.preventDefault(),L.stopPropagation(),L.currentTarget.classList.remove("bg-primary/20");const G=L.dataTransfer.getData("entityId"),ee=L.dataTransfer.getData("sourceFolderId");G&&ee&&ee!==String(t.id)&&s(G,t.id,ee)};return f.jsxs("div",{className:`space-y-1 select-none ${u||""}`,children:[f.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 rounded-xl text-xs font-bold text-text-muted hover:text-white hover:bg-white/5 cursor-pointer transition-all group relative",onClick:I,onContextMenu:L=>U(L,"folder",t.id,t.nombre),onDragOver:V,onDragLeave:J,onDrop:Y,children:[f.jsx("span",{onClick:R,className:`material-symbols-outlined text-lg transition-transform hover:text-primary ${m?"rotate-90 text-primary":"opacity-50"}`,children:"chevron_right"}),f.jsx("span",{className:`material-symbols-outlined text-lg ${Bk(t.tipo).color}`,children:Bk(t.tipo).icon}),j?f.jsx("input",{autoFocus:!0,className:"bg-surface-light border border-primary/50 rounded px-2 py-0.5 text-xs text-white outline-none flex-1 min-w-0",defaultValue:N,onKeyDown:async L=>{if(L.key==="Enter"){const G=L.target.value.trim();if(G&&G!==N)try{await r(t.id,G),T(G)}catch(ee){console.error(ee)}M(!1)}else L.key==="Escape"&&M(!1)},onBlur:()=>M(!1),onClick:L=>L.stopPropagation()}):f.jsx("span",{className:"truncate flex-1",children:N})]}),w&&f.jsxs("div",{className:"fixed bg-surface-dark border border-glass-border shadow-2xl rounded-xl py-2 z-50 w-48 text-xs font-medium flex flex-col",style:{top:w.y,left:w.x},onClick:L=>L.stopPropagation(),children:[f.jsx("div",{className:"px-4 py-2 border-b border-white/5 font-bold text-text-muted truncate",children:w.name}),w.type==="folder"?f.jsxs(f.Fragment,{children:[f.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{o(t.id,"entidadindividual"),B()},children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"person"})," New Character"]}),f.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{h(`/${c}/${d}/map-editor/create/${t.id}`),B()},children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," New Map"]}),f.jsx("div",{className:"h-px bg-white/5 my-1"}),f.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{M(!0),B()},children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Rename Folder"]}),f.jsxs("button",{className:"px-4 py-2 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-2",onClick:()=>{n(t.id,t.parentId),B()},children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Delete Folder"]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2 cursor-pointer",onClick:()=>{P(w.id),B()},children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Rename"]}),f.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2 cursor-pointer",onClick:async()=>{try{await Ne.entityService.toggleFavorite(w.id),window.dispatchEvent(new CustomEvent("favorites-update")),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:t.id}}))}catch(L){console.error(L)}B()},children:[f.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-500",children:"star"})," Toggle Favorite"]}),f.jsxs("button",{className:"px-4 py-2 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-2",onClick:()=>{i(w.id,t.id),B()},children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Delete Entity"]})]})]}),m&&f.jsxs("div",{className:"ml-6 pl-4 border-l border-glass-border space-y-1 animate-slide-in",children:[x.folders.map(L=>f.jsx(bI,{folder:L,onCreateSubfolder:e,onRename:r,onDeleteFolder:n,onDeleteEntity:i,onCreateTemplate:a,onMoveEntity:s,onCreateEntity:o,onConfirmCreate:l},L.id)),x.entities.map(L=>L.isNew||L.id===A?f.jsx(F,{item:L,type:"entity"},L.id):f.jsxs(Lu,{to:Vae(c,d,L,t.slug||t.id),onContextMenu:G=>U(G,"entity",L.id,L.nombre),className:`flex items-center gap-3 px-3 py-2 rounded-xl text-[11px] font-medium text-text-muted hover:text-white hover:bg-primary/10 transition-all group cursor-grab active:cursor-grabbing ${L.pending?"opacity-50 pointer-events-none":""}`,draggable:!L.pending,onDragStart:G=>{G.dataTransfer.setData("entityId",L.id),G.dataTransfer.setData("sourceFolderId",t.id)},children:[f.jsx("span",{className:"material-symbols-outlined text-sm opacity-70 group-hover:text-primary transition-colors",children:zae(L.tipoEspecial)}),f.jsx("span",{className:"truncate flex-1",children:L.nombre}),L.favorite&&f.jsx("span",{className:"material-symbols-outlined text-[10px] text-yellow-500",title:"Favorito",children:"star"})]},L.id)),b&&x.folders.length===0&&x.entities.length===0&&f.jsx("div",{className:"px-3 py-2 text-[10px] text-text-muted/30 uppercase font-black italic tracking-tighter",children:"Empty Sector"})]})]})},$ae=({isOpen:t,onClose:e,onCreate:r,parentFolder:n})=>{const[i,a]=K.useState({nombre:"",descripcion:"",tipo:"FOLDER",canvasType:"BLANK"});if(!t)return null;const s=()=>{r(i),e(),a({nombre:"",descripcion:"",tipo:"FOLDER",canvasType:"BLANK"})},o=[ku.UNIVERSE,ku.GALAXY,ku.SYSTEM,ku.PLANET];return f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:f.jsxs("div",{className:"bg-[#1a1b26] w-full max-w-4xl rounded-2xl shadow-2xl border border-white/10 overflow-hidden flex flex-col max-h-[90vh]",children:[f.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-[#1f202e]",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:f.jsx("span",{className:"material-icons text-sm",children:"add"})}),f.jsx("h2",{className:"text-xl font-semibold text-white",children:n?"Crear Nuevo Espacio":"Crear Nuevo Mapa"})]}),f.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition",children:f.jsx("span",{className:"material-icons",children:"close"})})]}),f.jsx("div",{className:"p-8 overflow-y-auto flex-1",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-indigo-400",children:"Identidad"}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-2",children:"Nombre del Espacio"}),f.jsx("input",{autoFocus:!0,type:"text",value:i.nombre,onChange:l=>a({...i,nombre:l.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-indigo-500/50 transition-all shadow-inner",placeholder:"ej. Sistema Solar"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-2",children:"Descripcin"}),f.jsx("textarea",{value:i.descripcion,onChange:l=>a({...i,descripcion:l.target.value}),className:"w-full h-32 bg-black/40 border border-white/5 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-indigo-500/50 resize-none transition-all",placeholder:"Detalles sobre este nivel jerrquico..."})]})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-indigo-400",children:"Configuracin"}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-1",children:"Tipo de Jerarqua"}),f.jsx("div",{className:"grid grid-cols-2 gap-2",children:o.concat([{id:"FOLDER",label:"Carpeta",icon:"folder",color:"text-white/50"}]).map(l=>f.jsxs("div",{onClick:()=>a({...i,tipo:l.id}),className:`flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all ${i.tipo===l.id?"bg-indigo-500/10 border-indigo-500/50":"bg-white/5 border-white/5 hover:bg-white/10"}`,children:[f.jsx("span",{className:`material-icons text-lg ${l.color||""}`,children:l.icon}),f.jsx("span",{className:"text-xs font-bold text-white/80",children:l.label})]},l.id||"FOLDER"))})]}),f.jsx("div",{className:"p-4 rounded-2xl bg-indigo-500/5 border border-indigo-500/10",children:f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:f.jsx("span",{className:"material-icons",children:"info"})}),f.jsxs("div",{children:[f.jsx("p",{className:"text-[10px] uppercase font-black text-indigo-300",children:"Ubicacin Actual"}),f.jsx("p",{className:"text-xs text-indigo-100/50",children:n?n.nombre:"Raz del Mundo"})]})]})})]})]})}),f.jsxs("div",{className:"p-6 border-t border-white/5 flex justify-end gap-3 bg-[#1f202e]",children:[f.jsx("button",{onClick:e,className:"px-6 py-3 rounded-xl text-xs font-black uppercase tracking-widest text-text-muted hover:text-white transition",children:"Cancelar"}),f.jsx("button",{onClick:s,disabled:!i.nombre,className:"px-8 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-black uppercase tracking-widest shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-30 disabled:pointer-events-none",children:"Confirmar y Crear"})]})]})})},Uae=()=>{const{username:t,projectName:e}=Bi(),r=Li(),{handleCreateEntity:n,...i}=jl()||{},[a,s]=K.useState([]),[o,l]=K.useState([]),[u,c]=K.useState(!1),[d,h]=K.useState(!1),[m,v]=K.useState(null),[x,y]=K.useState(!1),[b,S]=K.useState(null),w=`/${t}/${e}/bible`;K.useEffect(()=>{k(),N();const B=()=>N();return window.addEventListener("favorites-update",B),()=>window.removeEventListener("favorites-update",B)},[e]);const k=async()=>{try{const B=await Ne.get("/world-bible/folders");s(B)}catch(B){console.error("Error loading folders:",B)}},N=async()=>{try{const B=await Ne.get("/world-bible/favorites");l(B)}catch(B){console.error("Error loading favorites:",B)}},T=(B=null)=>{v(B),h(!0),c(!1)},j=async(B=null,z="FOLDER")=>{try{const F=B?typeof B=="object"?B.id:B:null,V=await Ne.post("/world-bible/folders",{nombre:z==="TIMELINE"?"Nueva Lnea de Tiempo":"Nueva Carpeta",padreId:F,tipo:z});if(F===null){const J=await Ne.get("/world-bible/folders");s(J),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:null}}))}else window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:F,optimisticType:"folder",item:V,expand:!0}}))}catch(F){console.error("Error creating simple folder:",F)}},M=async B=>{try{const z=m?m.id:null,F=await Ne.post("/world-bible/folders",{nombre:B.nombre,descripcion:B.descripcion,padreId:z,tipo:B.tipo});if(z===null){const V=await Ne.get("/world-bible/folders");s(V),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:null}}))}else F.id||console.error("CRITICAL: Created folder has no ID!",F),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:z,optimisticType:"folder",item:F,expand:!0}}))}catch(z){console.error(z),alert("Error creating folder/zone.")}},A=async(B,z="entidadindividual")=>{const F=typeof B=="object"?B.slug||B.id:B;r(`${w}/folder/${F}/entity/new/${z}`)},P=async(B,z)=>{try{await Ne.put(`/world-bible/folders/${B}`,{nombre:z}),s(F=>F.map(V=>V.id===B?{...V,nombre:z}:V))}catch(F){throw F}},D=(B,z=null)=>{S({id:B,parentId:z,type:"folder"}),y(!0)},R=async()=>{if(!b)return;const{id:B,parentId:z,type:F,folderId:V}=b;try{F==="folder"?(await Ne.delete(`/world-bible/folders/${B}`),z===null&&s(J=>J.filter(Y=>Y.id!==B)),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:z,removeId:B,type:"folder"}}))):F==="entity"&&(await Ne.delete(`/world-bible/entities/${B}`),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:V,removeId:B,type:"entity"}})))}catch(J){console.error("Deletion failed:",J),alert("Error trying to delete item.")}finally{S(null)}},I=(B,z)=>{S({id:B,folderId:z,type:"entity"}),y(!0)},U=async(B,z,F,V,J)=>{try{if(F==="folder")typeof B=="number"&&!B.toString().startsWith("temp")&&(await Ne.put(`/world-bible/folders/${B}`,{nombre:z}),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:V,confirmedType:"folder",oldId:B,item:{id:B,nombre:z,parentId:V,tipo:J,uiKey:Date.now()}}})),V||s(Y=>Y.map(L=>L.id===B?{...L,nombre:z}:L)));else if(F==="entity")if(typeof B=="string"&&B.startsWith("new-")){const Y=await Ne.post("/world-bible/entities",{nombre:z,carpetaId:V,tipoEspecial:J||"entidadindividual"});window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:V,confirmedType:"entity",oldId:B,item:Y}}))}else await Ne.put(`/world-bible/entities/${B}`,{nombre:z}),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:V,confirmedType:"entity",oldId:B,item:{id:B,nombre:z,carpeta:{id:V},tipoEspecial:J,slug:B}}})),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:V}}))}catch(Y){console.error("Creation/Rename failed",Y),F==="folder"&&D(B,V)}};return f.jsxs("div",{className:"flex h-full w-full bg-background-dark max-w-[1920px] mx-auto",children:[f.jsxs("aside",{className:"w-80 flex-none flex flex-col border-r border-glass-border bg-surface-dark/50 z-10",children:[f.jsx("div",{className:"p-4 border-b border-glass-border",children:f.jsxs("div",{className:"relative group mb-3",children:[f.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-text-muted text-sm group-focus-within:text-primary transition-colors",children:"search"}),f.jsx("input",{type:"text",placeholder:"Buscar en Biblia...",className:"w-full bg-surface-light/50 border border-glass-border rounded-xl py-2 pl-9 pr-3 text-xs focus:border-primary/50 outline-none transition-all text-white placeholder:text-text-muted/50"})]})}),f.jsxs("div",{className:"px-2 pt-2",children:[f.jsx("div",{className:"flex items-center justify-between px-2 mb-1",children:f.jsx("h2",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted",children:"Favoritos"})}),o.length>0?f.jsx("div",{className:"space-y-0.5",children:o.map(B=>f.jsxs("div",{onClick:()=>r(`${w}/folder/${B.carpeta.slug||B.carpeta.id}/entity/${B.slug||B.id}`),className:"flex items-center gap-3 px-3 py-1.5 rounded-lg text-[11px] font-medium text-text-muted hover:text-white hover:bg-white/5 cursor-pointer transition-all group",children:[f.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-500/70 group-hover:text-yellow-400",children:"star"}),f.jsx("span",{className:"truncate",children:B.nombre})]},B.id))}):f.jsx("div",{className:"px-4 py-2 text-[10px] text-text-muted/30 italic",children:"Sin favoritos"}),f.jsx("div",{className:"h-px bg-glass-border my-2 opacity-50"})]}),f.jsx("div",{className:"p-4 border-b border-glass-border pt-0",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h2",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted",children:"Explorador"}),f.jsx("div",{className:"relative",children:f.jsx("button",{className:"transition-colors hover:text-white text-primary",onClick:()=>j(null),title:"Crear Carpeta",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"create_new_folder"})})})]})}),f.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar p-2 space-y-0.5",children:a.length===0?f.jsxs("div",{className:"p-8 text-center opacity-30",children:[f.jsx("span",{className:"material-symbols-outlined text-3xl mb-2",children:"folder_off"}),f.jsx("p",{className:"text-[10px] uppercase font-bold",children:"Biblia Vaca"})]}):a.map(B=>f.jsx(bI,{folder:B,onCreateSubfolder:j,onRename:P,onDeleteFolder:D,onDeleteEntity:D,onCreateTemplate:()=>{},onMoveEntity:(z,F,V)=>console.log("move",z,F,V),onCreateEntity:A,onConfirmCreate:U},B.uiKey||B.id))})]}),f.jsx("main",{className:"flex-1 overflow-hidden relative bg-gradient-to-br from-background-dark to-surface-dark/20",children:f.jsx(GC,{context:{...i,folders:a,handleCreateEntity:A,handleOpenCreateModal:T,handleDeleteFolder:D,handleDeleteEntity:I,handleCreateSimpleFolder:j}})}),f.jsx($ae,{isOpen:d,onClose:()=>h(!1),onCreate:M,parentFolder:m}),f.jsx(Xp,{isOpen:x,onClose:()=>y(!1),onConfirm:R,title:(b==null?void 0:b.type)==="folder"?"Borrar Carpeta":"Borrar Entidad",message:(b==null?void 0:b.type)==="folder"?"Esta accin eliminar la carpeta y todo su contenido. Ests seguro?":"Ests seguro de querer eliminar esta entidad de tu mundo?",confirmText:"S, borrar"})]})},Gae=()=>{const{username:t,projectName:e}=Bi();Li();const{handleOpenCreateModal:r,handleDeleteFolder:n,handleCreateSimpleFolder:i,handleRenameFolder:a,folders:s=[]}=jl(),[o,l]=K.useState(null),[u,c]=K.useState(null),[d,h]=K.useState(""),m=(y,b)=>{y.preventDefault(),y.stopPropagation(),l({x:y.clientX,y:y.clientY,folder:b})},v=()=>l(null);K.useEffect(()=>{if(o){const y=()=>v();return window.addEventListener("click",y),()=>window.removeEventListener("click",y)}},[o]);const x=async(y,b)=>{b.trim()&&a&&await a(y,b.trim()),c(null),h("")};return s===void 0?f.jsx("div",{className:"p-20 text-center animate-pulse text-text-muted",children:"Loading World Bible..."}):f.jsxs("div",{className:"flex-1 p-8 max-w-[1600px] mx-auto w-full h-full overflow-y-auto",children:[f.jsxs("header",{className:"mb-8 flex items-end justify-between",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center gap-3 text-xs font-black uppercase tracking-widest text-primary italic mb-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"}),"World Bible"]}),f.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter",children:"Root Index"}),f.jsx("p",{className:"text-text-muted mt-2 max-w-lg text-sm",children:"The central archive of your world. Organize characters, locations, timelines, and maps."})]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsxs("button",{onClick:()=>i(null,"FOLDER"),className:"px-6 py-2 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold flex items-center gap-2 transition-all shadow-lg shadow-primary/20",children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"create_new_folder"})," Nueva Carpeta"]})})]}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:s.map(y=>u===y.id?f.jsx("div",{className:"p-4 rounded-3xl bg-surface-dark border border-primary/50",children:f.jsx("input",{autoFocus:!0,type:"text",value:d,onChange:b=>h(b.target.value),onKeyDown:b=>{b.key==="Enter"&&x(y.id,d),b.key==="Escape"&&(c(null),h(""))},onBlur:()=>x(y.id,d),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none",placeholder:"Folder name..."})},y.id):f.jsx(Lk,{item:y,type:"folder",linkTo:`/${t}/${e}/bible/folder/${y.slug||y.id}`,onDelete:()=>n(y.id),onContextMenu:b=>m(b,y)},y.id))}),s.length===0&&f.jsxs("div",{className:"p-20 text-center border-2 border-dashed border-glass-border rounded-[3rem] opacity-30 mt-8",children:[f.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 text-text-muted",children:"library_books"}),f.jsx("h3",{className:"text-xl font-bold text-white uppercase tracking-widest",children:"Archivo Vaco"}),f.jsx("p",{className:"text-text-muted mt-2",children:"Comienza creando espacios para organizar tu mundo."})]}),o&&f.jsxs("div",{className:"fixed bg-surface-dark border border-glass-border shadow-2xl rounded-xl py-2 z-50 w-52 text-xs font-medium flex flex-col animate-in fade-in zoom-in-95 duration-150",style:{top:o.y,left:o.x},onClick:y=>y.stopPropagation(),children:[f.jsxs("div",{className:"px-4 py-2 border-b border-white/5 font-bold text-text-muted truncate flex items-center gap-2",children:[f.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"folder"}),o.folder.nombre]}),f.jsxs("button",{className:"px-4 py-2.5 hover:bg-white/5 text-left flex items-center gap-3 text-white/80 hover:text-white transition-colors",onClick:()=>{c(o.folder.id),h(o.folder.nombre),v()},children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Renombrar"]}),f.jsxs("button",{className:"px-4 py-2.5 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-3 transition-colors",onClick:()=>{n(o.folder.id),v()},children:[f.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Eliminar Carpeta"]})]})]})};var wI={exports:{}},Ax={},Ey={},pt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof sE<"u"?sE:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.16",isBrowser:r(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return t.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var i;return(i=t.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(i){t.glob.Konva=i}};const n=i=>{t.Konva[i.prototype.getClassName()]=i};t._registerNode=n,t.Konva._injectGlobal(t.Konva)})(pt);var xr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=pt;class r{constructor(k=[1,0,0,1,0,0]){this.dirty=!1,this.m=k&&k.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(k){k.m[0]=this.m[0],k.m[1]=this.m[1],k.m[2]=this.m[2],k.m[3]=this.m[3],k.m[4]=this.m[4],k.m[5]=this.m[5]}point(k){const N=this.m;return{x:N[0]*k.x+N[2]*k.y+N[4],y:N[1]*k.x+N[3]*k.y+N[5]}}translate(k,N){return this.m[4]+=this.m[0]*k+this.m[2]*N,this.m[5]+=this.m[1]*k+this.m[3]*N,this}scale(k,N){return this.m[0]*=k,this.m[1]*=k,this.m[2]*=N,this.m[3]*=N,this}rotate(k){const N=Math.cos(k),T=Math.sin(k),j=this.m[0]*N+this.m[2]*T,M=this.m[1]*N+this.m[3]*T,A=this.m[0]*-T+this.m[2]*N,P=this.m[1]*-T+this.m[3]*N;return this.m[0]=j,this.m[1]=M,this.m[2]=A,this.m[3]=P,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(k,N){const T=this.m[0]+this.m[2]*N,j=this.m[1]+this.m[3]*N,M=this.m[2]+this.m[0]*k,A=this.m[3]+this.m[1]*k;return this.m[0]=T,this.m[1]=j,this.m[2]=M,this.m[3]=A,this}multiply(k){const N=this.m[0]*k.m[0]+this.m[2]*k.m[1],T=this.m[1]*k.m[0]+this.m[3]*k.m[1],j=this.m[0]*k.m[2]+this.m[2]*k.m[3],M=this.m[1]*k.m[2]+this.m[3]*k.m[3],A=this.m[0]*k.m[4]+this.m[2]*k.m[5]+this.m[4],P=this.m[1]*k.m[4]+this.m[3]*k.m[5]+this.m[5];return this.m[0]=N,this.m[1]=T,this.m[2]=j,this.m[3]=M,this.m[4]=A,this.m[5]=P,this}invert(){const k=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),N=this.m[3]*k,T=-this.m[1]*k,j=-this.m[2]*k,M=this.m[0]*k,A=k*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),P=k*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=N,this.m[1]=T,this.m[2]=j,this.m[3]=M,this.m[4]=A,this.m[5]=P,this}getMatrix(){return this.m}decompose(){const k=this.m[0],N=this.m[1],T=this.m[2],j=this.m[3],M=this.m[4],A=this.m[5],P=k*j-N*T,D={x:M,y:A,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(k!=0||N!=0){const R=Math.sqrt(k*k+N*N);D.rotation=N>0?Math.acos(k/R):-Math.acos(k/R),D.scaleX=R,D.scaleY=P/R,D.skewX=(k*T+N*j)/P,D.skewY=0}else if(T!=0||j!=0){const R=Math.sqrt(T*T+j*j);D.rotation=Math.PI/2-(j>0?Math.acos(-T/R):-Math.acos(T/R)),D.scaleX=P/R,D.scaleY=R,D.skewX=0,D.skewY=(k*T+N*j)/P}return D.rotation=t.Util._getRotation(D.rotation),D}}t.Transform=r;let n="[object Array]",i="[object Number]",a="[object String]",s="[object Boolean]",o=Math.PI/180,l=180/Math.PI,u="#",c="",d="0",h="Konva warning: ",m="Konva error: ",v="rgb(",x={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},y=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,b=[];const S=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(w){setTimeout(w,60)};t.Util={_isElement(w){return!!(w&&w.nodeType==1)},_isFunction(w){return!!(w&&w.constructor&&w.call&&w.apply)},_isPlainObject(w){return!!w&&w.constructor===Object},_isArray(w){return Object.prototype.toString.call(w)===n},_isNumber(w){return Object.prototype.toString.call(w)===i&&!isNaN(w)&&isFinite(w)},_isString(w){return Object.prototype.toString.call(w)===a},_isBoolean(w){return Object.prototype.toString.call(w)===s},isObject(w){return w instanceof Object},isValidSelector(w){if(typeof w!="string")return!1;const k=w[0];return k==="#"||k==="."||k===k.toUpperCase()},_sign(w){return w===0||w>0?1:-1},requestAnimFrame(w){b.push(w),b.length===1&&S(function(){const k=b;b=[],k.forEach(function(N){N()})})},createCanvasElement(){const w=document.createElement("canvas");try{w.style=w.style||{}}catch{}return w},createImageElement(){return document.createElement("img")},_isInDocument(w){for(;w=w.parentNode;)if(w==document)return!0;return!1},_urlToImage(w,k){const N=t.Util.createImageElement();N.onload=function(){k(N)},N.src=w},_rgbToHex(w,k,N){return((1<<24)+(w<<16)+(k<<8)+N).toString(16).slice(1)},_hexToRgb(w){w=w.replace(u,c);const k=parseInt(w,16);return{r:k>>16&255,g:k>>8&255,b:k&255}},getRandomColor(){let w=(Math.random()*16777215<<0).toString(16);for(;w.length<6;)w=d+w;return u+w},getRGB(w){let k;return w in x?(k=x[w],{r:k[0],g:k[1],b:k[2]}):w[0]===u?this._hexToRgb(w.substring(1)):w.substr(0,4)===v?(k=y.exec(w.replace(/ /g,"")),{r:parseInt(k[1],10),g:parseInt(k[2],10),b:parseInt(k[3],10)}):{r:0,g:0,b:0}},colorToRGBA(w){return w=w||"black",t.Util._namedColorToRBA(w)||t.Util._hex3ColorToRGBA(w)||t.Util._hex4ColorToRGBA(w)||t.Util._hex6ColorToRGBA(w)||t.Util._hex8ColorToRGBA(w)||t.Util._rgbColorToRGBA(w)||t.Util._rgbaColorToRGBA(w)||t.Util._hslColorToRGBA(w)},_namedColorToRBA(w){const k=x[w.toLowerCase()];return k?{r:k[0],g:k[1],b:k[2],a:1}:null},_rgbColorToRGBA(w){if(w.indexOf("rgb(")===0){w=w.match(/rgb\(([^)]+)\)/)[1];const k=w.split(/ *, */).map(Number);return{r:k[0],g:k[1],b:k[2],a:1}}},_rgbaColorToRGBA(w){if(w.indexOf("rgba(")===0){w=w.match(/rgba\(([^)]+)\)/)[1];const k=w.split(/ *, */).map((N,T)=>N.slice(-1)==="%"?T===3?parseInt(N)/100:parseInt(N)/100*255:Number(N));return{r:k[0],g:k[1],b:k[2],a:k[3]}}},_hex8ColorToRGBA(w){if(w[0]==="#"&&w.length===9)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:parseInt(w.slice(7,9),16)/255}},_hex6ColorToRGBA(w){if(w[0]==="#"&&w.length===7)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:1}},_hex4ColorToRGBA(w){if(w[0]==="#"&&w.length===5)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:parseInt(w[4]+w[4],16)/255}},_hex3ColorToRGBA(w){if(w[0]==="#"&&w.length===4)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:1}},_hslColorToRGBA(w){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(w)){const[k,...N]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(w),T=Number(N[0])/360,j=Number(N[1])/100,M=Number(N[2])/100;let A,P,D;if(j===0)return D=M*255,{r:Math.round(D),g:Math.round(D),b:Math.round(D),a:1};M<.5?A=M*(1+j):A=M+j-M*j;const R=2*M-A,I=[0,0,0];for(let U=0;U<3;U++)P=T+1/3*-(U-1),P<0&&P++,P>1&&P--,6*P<1?D=R+(A-R)*6*P:2*P<1?D=A:3*P<2?D=R+(A-R)*(2/3-P)*6:D=R,I[U]=D*255;return{r:Math.round(I[0]),g:Math.round(I[1]),b:Math.round(I[2]),a:1}}},haveIntersection(w,k){return!(k.x>w.x+w.width||k.x+k.width<w.x||k.y>w.y+w.height||k.y+k.height<w.y)},cloneObject(w){const k={};for(const N in w)this._isPlainObject(w[N])?k[N]=this.cloneObject(w[N]):this._isArray(w[N])?k[N]=this.cloneArray(w[N]):k[N]=w[N];return k},cloneArray(w){return w.slice(0)},degToRad(w){return w*o},radToDeg(w){return w*l},_degToRad(w){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(w)},_radToDeg(w){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(w)},_getRotation(w){return e.Konva.angleDeg?t.Util.radToDeg(w):w},_capitalize(w){return w.charAt(0).toUpperCase()+w.slice(1)},throw(w){throw new Error(m+w)},error(w){console.error(m+w)},warn(w){e.Konva.showWarnings&&console.warn(h+w)},each(w,k){for(const N in w)k(N,w[N])},_inRange(w,k,N){return k<=w&&w<N},_getProjectionToSegment(w,k,N,T,j,M){let A,P,D;const R=(w-N)*(w-N)+(k-T)*(k-T);if(R==0)A=w,P=k,D=(j-N)*(j-N)+(M-T)*(M-T);else{const I=((j-w)*(N-w)+(M-k)*(T-k))/R;I<0?(A=w,P=k,D=(w-j)*(w-j)+(k-M)*(k-M)):I>1?(A=N,P=T,D=(N-j)*(N-j)+(T-M)*(T-M)):(A=w+I*(N-w),P=k+I*(T-k),D=(A-j)*(A-j)+(P-M)*(P-M))}return[A,P,D]},_getProjectionToLine(w,k,N){const T=t.Util.cloneObject(w);let j=Number.MAX_VALUE;return k.forEach(function(M,A){if(!N&&A===k.length-1)return;const P=k[(A+1)%k.length],D=t.Util._getProjectionToSegment(M.x,M.y,P.x,P.y,w.x,w.y),R=D[0],I=D[1],U=D[2];U<j&&(T.x=R,T.y=I,j=U)}),T},_prepareArrayForTween(w,k,N){let T,j=[],M=[];if(w.length>k.length){const P=k;k=w,w=P}for(T=0;T<w.length;T+=2)j.push({x:w[T],y:w[T+1]});for(T=0;T<k.length;T+=2)M.push({x:k[T],y:k[T+1]});const A=[];return M.forEach(function(P){const D=t.Util._getProjectionToLine(P,j,N);A.push(D.x),A.push(D.y)}),A},_prepareToStringify(w){let k;w.visitedByCircularReferenceRemoval=!0;for(const N in w)if(w.hasOwnProperty(N)&&w[N]&&typeof w[N]=="object"){if(k=Object.getOwnPropertyDescriptor(w,N),w[N].visitedByCircularReferenceRemoval||t.Util._isElement(w[N]))if(k.configurable)delete w[N];else return null;else if(t.Util._prepareToStringify(w[N])===null)if(k.configurable)delete w[N];else return null}return delete w.visitedByCircularReferenceRemoval,w},_assign(w,k){for(const N in k)w[N]=k[N];return w},_getFirstPointerId(w){return w.touches?w.changedTouches[0].identifier:w.pointerId||999},releaseCanvas(...w){e.Konva.releaseCanvasOnDestroy&&w.forEach(k=>{k.width=0,k.height=0})},drawRoundedRectPath(w,k,N,T){let j=0,M=0,A=0,P=0;typeof T=="number"?j=M=A=P=Math.min(T,k/2,N/2):(j=Math.min(T[0]||0,k/2,N/2),M=Math.min(T[1]||0,k/2,N/2),P=Math.min(T[2]||0,k/2,N/2),A=Math.min(T[3]||0,k/2,N/2)),w.moveTo(j,0),w.lineTo(k-M,0),w.arc(k-M,M,M,Math.PI*3/2,0,!1),w.lineTo(k,N-P),w.arc(k-P,N-P,P,0,Math.PI/2,!1),w.lineTo(A,N),w.arc(A,N-A,A,Math.PI/2,Math.PI,!1),w.lineTo(0,j),w.arc(j,j,j,Math.PI,Math.PI*3/2,!1)}}})(xr);var dr={},gt={},Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.RGBComponent=Hae;Ze.alphaComponent=Wae;Ze.getNumberValidator=qae;Ze.getNumberOrArrayOfNumbersValidator=Kae;Ze.getNumberOrAutoValidator=Yae;Ze.getStringValidator=Xae;Ze.getStringOrGradientValidator=Qae;Ze.getFunctionValidator=Jae;Ze.getNumberArrayValidator=Zae;Ze.getBooleanValidator=ese;Ze.getComponentValidator=tse;const lo=pt,Er=xr;function uo(t){return Er.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||Er.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function Hae(t){return t>255?255:t<0?0:Math.round(t)}function Wae(t){return t>1?1:t<1e-4?1e-4:t}function qae(){if(lo.Konva.isUnminified)return function(t,e){return Er.Util._isNumber(t)||Er.Util.warn(uo(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function Kae(t){if(lo.Konva.isUnminified)return function(e,r){const n=Er.Util._isNumber(e),i=Er.Util._isArray(e)&&e.length==t;return!n&&!i&&Er.Util.warn(uo(e)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function Yae(){if(lo.Konva.isUnminified)return function(t,e){return Er.Util._isNumber(t)||t==="auto"||Er.Util.warn(uo(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function Xae(){if(lo.Konva.isUnminified)return function(t,e){return Er.Util._isString(t)||Er.Util.warn(uo(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function Qae(){if(lo.Konva.isUnminified)return function(t,e){const r=Er.Util._isString(t),n=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return r||n||Er.Util.warn(uo(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function Jae(){if(lo.Konva.isUnminified)return function(t,e){return Er.Util._isFunction(t)||Er.Util.warn(uo(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function Zae(){if(lo.Konva.isUnminified)return function(t,e){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&t instanceof r||(Er.Util._isArray(t)?t.forEach(function(n){Er.Util._isNumber(n)||Er.Util.warn('"'+e+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):Er.Util.warn(uo(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function ese(){if(lo.Konva.isUnminified)return function(t,e){return t===!0||t===!1||Er.Util.warn(uo(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function tse(t){if(lo.Konva.isUnminified)return function(e,r){return e==null||Er.Util.isObject(e)||Er.Util.warn(uo(e)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+t),e}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=xr,r=Ze,n="get",i="set";t.Factory={addGetterSetter(a,s,o,l,u){t.Factory.addGetter(a,s,o),t.Factory.addSetter(a,s,l,u),t.Factory.addOverloadedGetterSetter(a,s)},addGetter(a,s,o){const l=n+e.Util._capitalize(s);a.prototype[l]=a.prototype[l]||function(){const u=this.attrs[s];return u===void 0?o:u}},addSetter(a,s,o,l){const u=i+e.Util._capitalize(s);a.prototype[u]||t.Factory.overWriteSetter(a,s,o,l)},overWriteSetter(a,s,o,l){const u=i+e.Util._capitalize(s);a.prototype[u]=function(c){return o&&c!==void 0&&c!==null&&(c=o.call(this,c,s)),this._setAttr(s,c),l&&l.call(this),this}},addComponentsGetterSetter(a,s,o,l,u){let c=o.length,d=e.Util._capitalize,h=n+d(s),m=i+d(s),v,x;a.prototype[h]=function(){const b={};for(v=0;v<c;v++)x=o[v],b[x]=this.getAttr(s+d(x));return b};const y=(0,r.getComponentValidator)(o);a.prototype[m]=function(b){let S=this.attrs[s],w;l&&(b=l.call(this,b)),y&&y.call(this,b,s);for(w in b)b.hasOwnProperty(w)&&this._setAttr(s+d(w),b[w]);return b||o.forEach(k=>{this._setAttr(s+d(k),void 0)}),this._fireChangeEvent(s,S,b),u&&u.call(this),this},t.Factory.addOverloadedGetterSetter(a,s)},addOverloadedGetterSetter(a,s){const o=e.Util._capitalize(s),l=i+o,u=n+o;a.prototype[s]=function(){return arguments.length?(this[l](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,s,o,l){e.Util.error("Adding deprecated "+s);const u=n+e.Util._capitalize(s),c=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){e.Util.error(c);const d=this.attrs[s];return d===void 0?o:d},t.Factory.addSetter(a,s,l,function(){e.Util.error(c)}),t.Factory.addOverloadedGetterSetter(a,s)},backCompat(a,s){e.Util.each(s,function(o,l){const u=a.prototype[l],c=n+e.Util._capitalize(o),d=i+e.Util._capitalize(o);function h(){u.apply(this,arguments),e.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}a.prototype[o]=h,a.prototype[c]=h,a.prototype[d]=h})},afterSetFilter(){this._filterUpToDate=!1}}})(gt);var Oa={},Ks={};Object.defineProperty(Ks,"__esModule",{value:!0});Ks.HitContext=Ks.SceneContext=Ks.Context=void 0;const SI=xr,rse=pt;function nse(t){let e=[],r=t.length,n=SI.Util,i,a;for(i=0;i<r;i++)a=t[i],n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),e.push(a);return e}const iM=",",ise="(",ase=")",sse="([",ose="])",lse=";",use="()",cse="=",aM=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],dse=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],fse=100;class Rx{constructor(e){this.canvas=e,rse.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,r){let n=this.traceArr,i=n.length,a="",s,o,l,u;for(s=0;s<i;s++)o=n[s],l=o.method,l?(u=o.args,a+=l,e?a+=use:SI.Util._isArray(u[0])?a+=sse+u.join(iM)+ose:(r&&(u=u.map(c=>typeof c=="number"?Math.floor(c):c)),a+=ise+u.join(iM)+ase)):(a+=o.property,e||(a+=cse+o.val)),a+=lse;return a}clearTrace(){this.traceArr=[]}_trace(e){let r=this.traceArr,n;r.push(e),n=r.length,n>=fse&&r.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const r=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(e){const r=e.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(e){const r=e.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(e){const r=e.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(e,r){this._context[e]=r}arc(e,r,n,i,a,s){this._context.arc(e,r,n,i,a,s)}arcTo(e,r,n,i,a){this._context.arcTo(e,r,n,i,a)}beginPath(){this._context.beginPath()}bezierCurveTo(e,r,n,i,a,s){this._context.bezierCurveTo(e,r,n,i,a,s)}clearRect(e,r,n,i){this._context.clearRect(e,r,n,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,r){const n=arguments;if(n.length===2)return this._context.createImageData(e,r);if(n.length===1)return this._context.createImageData(e)}createLinearGradient(e,r,n,i){return this._context.createLinearGradient(e,r,n,i)}createPattern(e,r){return this._context.createPattern(e,r)}createRadialGradient(e,r,n,i,a,s){return this._context.createRadialGradient(e,r,n,i,a,s)}drawImage(e,r,n,i,a,s,o,l,u){const c=arguments,d=this._context;c.length===3?d.drawImage(e,r,n):c.length===5?d.drawImage(e,r,n,i,a):c.length===9&&d.drawImage(e,r,n,i,a,s,o,l,u)}ellipse(e,r,n,i,a,s,o,l){this._context.ellipse(e,r,n,i,a,s,o,l)}isPointInPath(e,r,n,i){return n?this._context.isPointInPath(n,e,r,i):this._context.isPointInPath(e,r,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,r,n,i){this._context.fillRect(e,r,n,i)}strokeRect(e,r,n,i){this._context.strokeRect(e,r,n,i)}fillText(e,r,n,i){i?this._context.fillText(e,r,n,i):this._context.fillText(e,r,n)}measureText(e){return this._context.measureText(e)}getImageData(e,r,n,i){return this._context.getImageData(e,r,n,i)}lineTo(e,r){this._context.lineTo(e,r)}moveTo(e,r){this._context.moveTo(e,r)}rect(e,r,n,i){this._context.rect(e,r,n,i)}roundRect(e,r,n,i,a){this._context.roundRect(e,r,n,i,a)}putImageData(e,r,n){this._context.putImageData(e,r,n)}quadraticCurveTo(e,r,n,i){this._context.quadraticCurveTo(e,r,n,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,r){this._context.scale(e,r)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,r,n,i,a,s){this._context.setTransform(e,r,n,i,a,s)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,r,n,i){this._context.strokeText(e,r,n,i)}transform(e,r,n,i,a,s){this._context.transform(e,r,n,i,a,s)}translate(e,r){this._context.translate(e,r)}_enableTrace(){let e=this,r=aM.length,n=this.setAttr,i,a;const s=function(o){let l=e[o],u;e[o]=function(){return a=nse(Array.prototype.slice.call(arguments,0)),u=l.apply(e,arguments),e._trace({method:o,args:a}),u}};for(i=0;i<r;i++)s(aM[i]);e.setAttr=function(){n.apply(e,arguments);const o=arguments[0];let l=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),e._trace({property:o,val:l})}}_applyGlobalCompositeOperation(e){const r=e.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}Ks.Context=Rx;dse.forEach(function(t){Object.defineProperty(Rx.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class hse extends Rx{constructor(e,{willReadFrequently:r=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(e){const r=e.fill();this.setAttr("fillStyle",r),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const r=e._getLinearGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fillRadialGradient(e){const r=e._getRadialGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fill(e){const r=e.fill(),n=e.getFillPriority();if(r&&n==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&n==="pattern"){this._fillPattern(e);return}const a=e.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(e);return}const s=e.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(e);return}r?this._fillColor(e):i?this._fillPattern(e):a?this._fillLinearGradient(e):s&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const r=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(i){for(let s=0;s<i.length;s+=2)a.addColorStop(i[s],i[s+1]);this.setAttr("strokeStyle",a)}}_stroke(e){const r=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e),r&&e.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var r,n,i;const a=(r=e.getShadowRGBA())!==null&&r!==void 0?r:"black",s=(n=e.getShadowBlur())!==null&&n!==void 0?n:5,o=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},l=e.getAbsoluteScale(),u=this.canvas.getPixelRatio(),c=l.x*u,d=l.y*u;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",s*Math.min(Math.abs(c),Math.abs(d))),this.setAttr("shadowOffsetX",o.x*c),this.setAttr("shadowOffsetY",o.y*d)}}Ks.SceneContext=hse;class pse extends Rx{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const r=e.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e);const n=e.hitStrokeWidth(),i=n==="auto"?e.strokeWidth():n;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),r||this.restore()}}}Ks.HitContext=pse;Object.defineProperty(Oa,"__esModule",{value:!0});Oa.HitCanvas=Oa.SceneCanvas=Oa.Canvas=void 0;const Ty=xr,kI=Ks,CI=pt,mse=gt,gse=Ze;let uv;function vse(){if(uv)return uv;const t=Ty.Util.createCanvasElement(),e=t.getContext("2d");return uv=function(){const r=CI.Konva._global.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return r/n}(),Ty.Util.releaseCanvas(t),uv}class Dx{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(e||{}).pixelRatio||CI.Konva.pixelRatio||vse();this.pixelRatio=n,this._canvas=Ty.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const r=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,r){this.setWidth(e||0),this.setHeight(r||0)}toDataURL(e,r){try{return this._canvas.toDataURL(e,r)}catch{try{return this._canvas.toDataURL()}catch(i){return Ty.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Oa.Canvas=Dx;mse.Factory.addGetterSetter(Dx,"pixelRatio",void 0,(0,gse.getNumberValidator)());class yse extends Dx{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new kI.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}Oa.SceneCanvas=yse;class xse extends Dx{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new kI.HitContext(this),this.setSize(e.width,e.height)}}Oa.HitCanvas=xse;var Ox={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=pt,r=xr;t.DD={get isDragging(){let n=!1;return t.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return t.DD._dragElements.forEach(i=>{n=i.node}),n},_dragElements:new Map,_drag(n){const i=[];t.DD._dragElements.forEach((a,s)=>{const{node:o}=a,l=o.getStage();l.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=l._changedPointerPositions.find(c=>c.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const c=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<c||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),i.push(o)}}),i.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const i=[];t.DD._dragElements.forEach(a=>{const{node:s}=a,o=s.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(c=>c.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof e.Konva.Stage&&a.node;u&&i.indexOf(u)===-1&&i.push(u)}),i.forEach(a=>{a.draw()})},_endDragAfter(n){t.DD._dragElements.forEach((i,a)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:n},!0),i.dragStatus!=="dragging"&&t.DD._dragElements.delete(a)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(Ox);Object.defineProperty(dr,"__esModule",{value:!0});dr.Node=void 0;const St=xr,gm=gt,ch=Oa,Po=pt,Yi=Ox,Or=Ze,Uv="absoluteOpacity",cv="allEventListeners",Is="absoluteTransform",sM="absoluteScale",su="canvas",bse="Change",wse="children",Sse="konva",Fk="listening",oM="mouseenter",lM="mouseleave",uM="set",cM="Shape",Gv=" ",dM="stage",Ao="transform",kse="Stage",zk="visible",Cse=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Gv);let Nse=1;class it{constructor(e){this._id=Nse++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Ao||e===Is)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,r){let n=this._cache.get(e);return(n===void 0||(e===Ao||e===Is)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(e,n)),n}_calculate(e,r,n){if(!this._attachedDepsListeners.get(e)){const i=r.map(a=>a+"Change.konva").join(Gv);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(su)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Is&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(su)){const{scene:e,filter:r,hit:n}=this._cache.get(su);St.Util.releaseCanvas(e,r,n),this._cache.delete(su)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const r=e||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),s=r.pixelRatio,o=r.x===void 0?Math.floor(n.x):r.x,l=r.y===void 0?Math.floor(n.y):r.y,u=r.offset||0,c=r.drawBorder||!1,d=r.hitCanvasPixelRatio||1;if(!i||!a){St.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const h=Math.abs(Math.round(n.x)-o)>.5?1:0,m=Math.abs(Math.round(n.y)-l)>.5?1:0;i+=u*2+h,a+=u*2+m,o-=u,l-=u;const v=new ch.SceneCanvas({pixelRatio:s,width:i,height:a}),x=new ch.SceneCanvas({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),y=new ch.HitCanvas({pixelRatio:d,width:i,height:a}),b=v.getContext(),S=y.getContext();return y.isCache=!0,v.isCache=!0,this._cache.delete(su),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,x.getContext()._context.imageSmoothingEnabled=!1),b.save(),S.save(),b.translate(-o,-l),S.translate(-o,-l),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Uv),this._clearSelfAndDescendantCache(sM),this.drawScene(v,this),this.drawHit(y,this),this._isUnderCache=!1,b.restore(),S.restore(),c&&(b.save(),b.beginPath(),b.rect(0,0,i,a),b.closePath(),b.setAttr("strokeStyle","red"),b.setAttr("lineWidth",5),b.stroke(),b.restore()),this._cache.set(su,{scene:v,filter:x,hit:y,x:o,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(su)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,r){const n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,a=1/0,s=-1/0,o=-1/0;const l=this.getAbsoluteTransform(r);return n.forEach(function(u){const c=l.point(u);i===void 0&&(i=s=c.x,a=o=c.y),i=Math.min(i,c.x),a=Math.min(a,c.y),s=Math.max(s,c.x),o=Math.max(o,c.y)}),{x:i,y:a,width:s-i,height:o-a}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();e.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),i=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/i,n.height/i),e.restore()}_drawCachedHitCanvas(e){const r=this._getCanvasCache(),n=r.hit;e.save(),e.translate(r.x,r.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),r=this._getCanvasCache(),n=r.scene,i=r.filter,a=i.getContext(),s,o,l,u;if(e){if(!this._filterUpToDate){const c=n.pixelRatio;i.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(s=e.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/c,n.getHeight()/c),o=a.getImageData(0,0,i.getWidth(),i.getHeight()),l=0;l<s;l++){if(u=e[l],typeof u!="function"){St.Util.error("Filter should be type of function, but got "+typeof u+" instead. Please check correct filters");continue}u.call(this,o),a.putImageData(o,0,0)}}catch(d){St.Util.error("Unable to apply filter. "+d.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return n}on(e,r){if(this._cache&&this._cache.delete(cv),arguments.length===3)return this._delegate.apply(this,arguments);let n=e.split(Gv),i=n.length,a,s,o,l,u;for(a=0;a<i;a++)s=n[a],o=s.split("."),l=o[0],u=o[1]||"",this.eventListeners[l]||(this.eventListeners[l]=[]),this.eventListeners[l].push({name:u,handler:r});return this}off(e,r){let n=(e||"").split(Gv),i=n.length,a,s,o,l,u,c;if(this._cache&&this._cache.delete(cv),!e)for(s in this.eventListeners)this._off(s);for(a=0;a<i;a++)if(o=n[a],l=o.split("."),u=l[0],c=l[1],u)this.eventListeners[u]&&this._off(u,c,r);else for(s in this.eventListeners)this._off(s,c,r);return this}dispatchEvent(e){const r={target:this,type:e.type,evt:e};return this.fire(e.type,r),this}addEventListener(e,r){return this.on(e,function(n){r.call(this,n.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,r,n){const i=this;this.on(e,function(a){const s=a.target.findAncestors(r,!0,i);for(let o=0;o<s.length;o++)a=St.Util.cloneObject(a),a.currentTarget=s[o],n.call(s[o],a)})}remove(){return this.isDragging()&&this.stopDrag(),Yi.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Is),this._clearSelfAndDescendantCache(Uv),this._clearSelfAndDescendantCache(sM),this._clearSelfAndDescendantCache(dM),this._clearSelfAndDescendantCache(zk),this._clearSelfAndDescendantCache(Fk)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const r="get"+St.Util._capitalize(e);return St.Util._isFunction(this[r])?this[r]():this.attrs[e]}getAncestors(){let e=this.getParent(),r=[];for(;e;)r.push(e),e=e.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let r,n;if(!e)return this;for(r in e)r!==wse&&(n=uM+St.Util._capitalize(r),St.Util._isFunction(this[n])?this[n](e[r]):this._setAttr(r,e[r]))}),this}isListening(){return this._getCache(Fk,this._isListening)}_isListening(e){if(!this.listening())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(zk,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,r=!1){if(e)return this._isVisible(e)&&this._isListening(e);const n=this.getLayer();let i=!1;Yi.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(i=!0)});const a=!r&&!Po.Konva.hitOnDragEnabled&&(i||Po.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),r=this,n=0,i,a,s,o;function l(c){for(i=[],a=c.length,s=0;s<a;s++)o=c[s],n++,o.nodeType!==cM&&(i=i.concat(o.getChildren().slice())),o._id===r._id&&(s=a);i.length>0&&i[0].getDepth()<=e&&l(i)}const u=this.getStage();return r.nodeType!==kse&&u&&l(u.getChildren()),n}getDepth(){let e=0,r=this.parent;for(;r;)e++,r=r.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Ao),this._clearSelfAndDescendantCache(Is)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const r=e.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(e){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),a=new St.Transform,s=this.offset();return a.m=i.slice(),a.translate(s.x,s.y),a.getTranslation()}setAbsolutePosition(e){const{x:r,y:n,...i}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(Ao);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(e.x,e.y),e={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(Ao),this._clearSelfAndDescendantCache(Is),this}_setTransform(e){let r;for(r in e)this.attrs[r]=e[r]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let r=e.x,n=e.y,i=this.x(),a=this.y();return r!==void 0&&(i+=r),n!==void 0&&(a+=n),this.setPosition({x:i,y:a}),this}_eachAncestorReverse(e,r){let n=[],i=this.getParent(),a,s;if(!(r&&r._id===this._id)){for(n.unshift(this);i&&(!r||i._id!==r._id);)n.unshift(i),i=i.parent;for(a=n.length,s=0;s<a;s++)e(n[s])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return St.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return St.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return St.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return St.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return St.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&St.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Uv,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(e*=r.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),r,n,i,a,s;const o={attrs:{},className:this.getClassName()};for(r in e)n=e[r],s=St.Util.isObject(n)&&!St.Util._isPlainObject(n)&&!St.Util._isArray(n),!s&&(i=typeof this[r]=="function"&&this[r],delete e[r],a=i?i.call(this):null,e[r]=n,a!==n&&(o.attrs[r]=n));return St.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,r,n){const i=[];r&&this._isMatch(e)&&i.push(this);let a=this.parent;for(;a;){if(a===n)return i;a._isMatch(e)&&i.push(a),a=a.parent}return i}isAncestorOf(e){return!1}findAncestor(e,r,n){return this.findAncestors(e,r,n)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let r=e.replace(/ /g,"").split(","),n=r.length,i,a;for(i=0;i<n;i++)if(a=r[i],St.Util.isValidSelector(a)||(St.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),St.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),St.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(dM,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,r={},n){return r.target=r.target||this,n?this._fireAndBubble(e,r):this._fire(e,r),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Is,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let r;if(e)return r=new St.Transform,this._eachAncestorReverse(function(n){const i=n.transformsEnabled();i==="all"?r.multiply(n.getTransform()):i==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},e),r;{r=this._cache.get(Is)||new St.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const i=this.attrs.x||0,a=this.attrs.y||0,s=this.attrs.offsetX||0,o=this.attrs.offsetY||0;r.translate(i-s,a-o)}return r.dirty=!1,r}}getAbsoluteScale(e){let r=this;for(;r;)r._isUnderCache&&(e=r),r=r.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Ao,this._getTransform)}_getTransform(){var e,r;const n=this._cache.get(Ao)||new St.Transform;n.reset();const i=this.x(),a=this.y(),s=Po.Konva.getAngle(this.rotation()),o=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,l=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,u=this.attrs.skewX||0,c=this.attrs.skewY||0,d=this.attrs.offsetX||0,h=this.attrs.offsetY||0;return(i!==0||a!==0)&&n.translate(i,a),s!==0&&n.rotate(s),(u!==0||c!==0)&&n.skew(u,c),(o!==1||l!==1)&&n.scale(o,l),(d!==0||h!==0)&&n.translate(-1*d,-1*h),n.dirty=!1,n}clone(e){let r=St.Util.cloneObject(this.attrs),n,i,a,s,o;for(n in e)r[n]=e[n];const l=new this.constructor(r);for(n in this.eventListeners)for(i=this.eventListeners[n],a=i.length,s=0;s<a;s++)o=i[s],o.name.indexOf(Sse)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(o));return l}_toKonvaCanvas(e){e=e||{};const r=this.getClientRect(),n=this.getStage(),i=e.x!==void 0?e.x:Math.floor(r.x),a=e.y!==void 0?e.y:Math.floor(r.y),s=e.pixelRatio||1,o=new ch.SceneCanvas({width:e.width||Math.ceil(r.width)||(n?n.width():0),height:e.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:s}),l=o.getContext(),u=new ch.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(i),height:o.height/o.pixelRatio+Math.abs(a),pixelRatio:o.pixelRatio});return e.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(i||a)&&l.translate(-1*i,-1*a),this.drawScene(o,void 0,u),l.restore(),o}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const r=e.mimeType||null,n=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(r,n);return e.callback&&e.callback(i),i}toImage(e){return new Promise((r,n)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,St.Util._urlToImage(this.toDataURL(e),function(a){r(a),i==null||i(a)})}catch(i){n(i)}})}toBlob(e){return new Promise((r,n)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(a=>{r(a),i==null||i(a)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){n(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Po.Konva.dragDistance}_off(e,r,n){let i=this.eventListeners[e],a,s,o;for(a=0;a<i.length;a++)if(s=i[a].name,o=i[a].handler,(s!=="konva"||r==="konva")&&(!r||s===r)&&(!n||n===o)){if(i.splice(a,1),i.length===0){delete this.eventListeners[e];break}a--}}_fireChangeEvent(e,r,n){this._fire(e+bse,{oldVal:r,newVal:n})}addName(e){if(!this.hasName(e)){const r=this.name(),n=r?r+" "+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const r=(this.name()||"").split(/\s/g),n=r.indexOf(e);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(e,r){const n=this[uM+St.Util._capitalize(e)];return St.Util._isFunction(n)?n.call(this,r):this._setAttr(e,r),this}_requestDraw(){if(Po.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,r){const n=this.attrs[e];n===r&&!St.Util.isObject(r)||(r==null?delete this.attrs[e]:this.attrs[e]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,r),this._requestDraw())}_setComponentAttr(e,r,n){let i;n!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][r]=n,this._fireChangeEvent(e,i,n))}_fireAndBubble(e,r,n){if(r&&this.nodeType===cM&&(r.target=this),!((e===oM||e===lM)&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(e,r);const a=(e===oM||e===lM)&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!a&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,r,n):this._fireAndBubble.call(this.parent,e,r))}}_getProtoListeners(e){var r,n,i;const a=(r=this._cache.get(cv))!==null&&r!==void 0?r:{};let s=a==null?void 0:a[e];if(s===void 0){s=[];let o=Object.getPrototypeOf(this);for(;o;){const l=(i=(n=o.eventListeners)===null||n===void 0?void 0:n[e])!==null&&i!==void 0?i:[];s.push(...l),o=Object.getPrototypeOf(o)}a[e]=s,this._cache.set(cv,a)}return s}_fire(e,r){r=r||{},r.currentTarget=this,r.type=e;const n=this._getProtoListeners(e);if(n)for(var i=0;i<n.length;i++)n[i].handler.call(this,r);const a=this.eventListeners[e];if(a)for(var i=0;i<a.length;i++)a[i].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const r=e?e.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||i;Yi.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-i.x,y:a.y-i.y},dragStatus:"ready",pointerId:r})}startDrag(e,r=!0){Yi.DD._dragElements.has(this._id)||this._createDragElement(e);const n=Yi.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},r)}_setDragPosition(e,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let i={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const s=a.call(this,i,e);s?i=s:St.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const r=Yi.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),Yi.DD._endDragBefore(e),Yi.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Yi.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||Po.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;Yi.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=Yi.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",i=r&&r.dragStatus==="ready";n?this.stopDrag():i&&Yi.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-e.x,y:-e.y,width:r.width()+2*e.x,height:r.height()+2*e.y};return St.Util.haveIntersection(n,this.getClientRect())}static create(e,r){return St.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,r)}static _createNode(e,r){let n=it.prototype.getClassName.call(e),i=e.children,a,s,o;r&&(e.attrs.container=r),Po.Konva[n]||(St.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const l=Po.Konva[n];if(a=new l(e.attrs),i)for(s=i.length,o=0;o<s;o++)a.add(it._createNode(i[o]));return a}}dr.Node=it;it.prototype.nodeType="Node";it.prototype._attrsAffectingSize=[];it.prototype.eventListeners={};it.prototype.on.call(it.prototype,Cse,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Ao),this._clearSelfAndDescendantCache(Is)});it.prototype.on.call(it.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(zk)});it.prototype.on.call(it.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Fk)});it.prototype.on.call(it.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Uv)});const qt=gm.Factory.addGetterSetter;qt(it,"zIndex");qt(it,"absolutePosition");qt(it,"position");qt(it,"x",0,(0,Or.getNumberValidator)());qt(it,"y",0,(0,Or.getNumberValidator)());qt(it,"globalCompositeOperation","source-over",(0,Or.getStringValidator)());qt(it,"opacity",1,(0,Or.getNumberValidator)());qt(it,"name","",(0,Or.getStringValidator)());qt(it,"id","",(0,Or.getStringValidator)());qt(it,"rotation",0,(0,Or.getNumberValidator)());gm.Factory.addComponentsGetterSetter(it,"scale",["x","y"]);qt(it,"scaleX",1,(0,Or.getNumberValidator)());qt(it,"scaleY",1,(0,Or.getNumberValidator)());gm.Factory.addComponentsGetterSetter(it,"skew",["x","y"]);qt(it,"skewX",0,(0,Or.getNumberValidator)());qt(it,"skewY",0,(0,Or.getNumberValidator)());gm.Factory.addComponentsGetterSetter(it,"offset",["x","y"]);qt(it,"offsetX",0,(0,Or.getNumberValidator)());qt(it,"offsetY",0,(0,Or.getNumberValidator)());qt(it,"dragDistance",null,(0,Or.getNumberValidator)());qt(it,"width",0,(0,Or.getNumberValidator)());qt(it,"height",0,(0,Or.getNumberValidator)());qt(it,"listening",!0,(0,Or.getBooleanValidator)());qt(it,"preventDefault",!0,(0,Or.getBooleanValidator)());qt(it,"filters",null,function(t){return this._filterUpToDate=!1,t});qt(it,"visible",!0,(0,Or.getBooleanValidator)());qt(it,"transformsEnabled","all",(0,Or.getStringValidator)());qt(it,"size");qt(it,"dragBoundFunc");qt(it,"draggable",!1,(0,Or.getBooleanValidator)());gm.Factory.backCompat(it,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var ic={};Object.defineProperty(ic,"__esModule",{value:!0});ic.Container=void 0;const cf=gt,ES=dr,Ix=Ze;class ac extends ES.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const r=this.children||[],n=[];return r.forEach(function(i){e(i)&&n.push(i)}),n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let n=0;n<e.length;n++)this.add(e[n]);return this}const r=e[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const r=this._generalFind(e,!0);return r.length>0?r[0]:void 0}_generalFind(e,r){const n=[];return this._descendants(i=>{const a=i._isMatch(e);return a&&n.push(i),!!(a&&r)}),n}_descendants(e){let r=!1;const n=this.getChildren();for(const i of n){if(r=e(i),r)return!0;if(i.hasChildren()&&(r=i._descendants(e),r))return!0}return!1}toObject(){const e=ES.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(r=>{e.children.push(r.toObject())}),e}isAncestorOf(e){let r=e.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(e){const r=ES.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(e){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(e)&&r.push(n)}),r}_clearSelfAndDescendantCache(e){var r;super._clearSelfAndDescendantCache(e),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(e,r,n){const i=this.getLayer(),a=e||i&&i.getCanvas(),s=a&&a.getContext(),o=this._getCanvasCache(),l=o&&o.scene,u=a&&a.isCache;if(!this.isVisible()&&!u)return this;if(l){s.save();const c=this.getAbsoluteTransform(r).getMatrix();s.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(e,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),i=e||n&&n.hitCanvas,a=i&&i.getContext(),s=this._getCanvasCache();if(s&&s.hit){a.save();const l=this.getAbsoluteTransform(r).getMatrix();a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",i,r);return this}_drawChildren(e,r,n,i){var a;const s=r&&r.getContext(),o=this.clipWidth(),l=this.clipHeight(),u=this.clipFunc(),c=typeof o=="number"&&typeof l=="number"||u,d=n===this;if(c){s.save();const m=this.getAbsoluteTransform(n);let v=m.getMatrix();s.transform(v[0],v[1],v[2],v[3],v[4],v[5]),s.beginPath();let x;if(u)x=u.call(this,s,this);else{const y=this.clipX(),b=this.clipY();s.rect(y||0,b||0,o,l)}s.clip.apply(s,x),v=m.copy().invert().getMatrix(),s.transform(v[0],v[1],v[2],v[3],v[4],v[5])}const h=!d&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";h&&(s.save(),s._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(m){m[e](r,n,i)}),h&&s.restore(),c&&s.restore()}getClientRect(e={}){var r;const n=e.skipTransform,i=e.relativeTo;let a,s,o,l,u={x:1/0,y:1/0,width:0,height:0};const c=this;(r=this.children)===null||r===void 0||r.forEach(function(m){if(!m.visible())return;const v=m.getClientRect({relativeTo:c,skipShadow:e.skipShadow,skipStroke:e.skipStroke});v.width===0&&v.height===0||(a===void 0?(a=v.x,s=v.y,o=v.x+v.width,l=v.y+v.height):(a=Math.min(a,v.x),s=Math.min(s,v.y),o=Math.max(o,v.x+v.width),l=Math.max(l,v.y+v.height)))});const d=this.find("Shape");let h=!1;for(let m=0;m<d.length;m++)if(d[m]._isVisible(this)){h=!0;break}return h&&a!==void 0?u={x:a,y:s,width:o-a,height:l-s}:u={x:0,y:0,width:0,height:0},n?u:this._transformedRect(u,i)}}ic.Container=ac;cf.Factory.addComponentsGetterSetter(ac,"clip",["x","y","width","height"]);cf.Factory.addGetterSetter(ac,"clipX",void 0,(0,Ix.getNumberValidator)());cf.Factory.addGetterSetter(ac,"clipY",void 0,(0,Ix.getNumberValidator)());cf.Factory.addGetterSetter(ac,"clipWidth",void 0,(0,Ix.getNumberValidator)());cf.Factory.addGetterSetter(ac,"clipHeight",void 0,(0,Ix.getNumberValidator)());cf.Factory.addGetterSetter(ac,"clipFunc");var NI={},Bl={};Object.defineProperty(Bl,"__esModule",{value:!0});Bl.getCapturedShape=Tse;Bl.createEvent=u4;Bl.hasPointerCapture=jse;Bl.setPointerCapture=Mse;Bl.releaseCapture=TI;const Ese=pt,zp=new Map,EI=Ese.Konva._global.PointerEvent!==void 0;function Tse(t){return zp.get(t)}function u4(t){return{evt:t,pointerId:t.pointerId}}function jse(t,e){return zp.get(t)===e}function Mse(t,e){TI(t),e.getStage()&&(zp.set(t,e),EI&&e._fire("gotpointercapture",u4(new PointerEvent("gotpointercapture"))))}function TI(t,e){const r=zp.get(t);if(!r)return;const n=r.getStage();n&&n.content,zp.delete(t),EI&&r._fire("lostpointercapture",u4(new PointerEvent("lostpointercapture")))}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=xr,r=gt,n=ic,i=pt,a=Oa,s=Ox,o=pt,l=Bl,u="Stage",c="string",d="px",h="mouseout",m="mouseleave",v="mouseover",x="mouseenter",y="mousemove",b="mousedown",S="mouseup",w="pointermove",k="pointerdown",N="pointerup",T="pointercancel",j="lostpointercapture",M="pointerout",A="pointerleave",P="pointerover",D="pointerenter",R="contextmenu",I="touchstart",U="touchend",B="touchmove",z="touchcancel",F="wheel",V=5,J=[[x,"_pointerenter"],[b,"_pointerdown"],[y,"_pointermove"],[S,"_pointerup"],[m,"_pointerleave"],[I,"_pointerdown"],[B,"_pointermove"],[U,"_pointerup"],[z,"_pointercancel"],[v,"_pointerover"],[F,"_wheel"],[R,"_contextmenu"],[k,"_pointerdown"],[w,"_pointermove"],[N,"_pointerup"],[T,"_pointercancel"],[j,"_lostpointercapture"]],Y={mouse:{[M]:h,[A]:m,[P]:v,[D]:x,[w]:y,[k]:b,[N]:S,[T]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[M]:"touchout",[A]:"touchleave",[P]:"touchover",[D]:"touchenter",[w]:B,[k]:I,[N]:U,[T]:z,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[M]:M,[A]:A,[P]:P,[D]:D,[w]:w,[k]:k,[N]:N,[T]:T,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},L=de=>de.indexOf("pointer")>=0?"pointer":de.indexOf("touch")>=0?"touch":"mouse",G=de=>{const W=L(de);if(W==="pointer")return i.Konva.pointerEventsEnabled&&Y.pointer;if(W==="touch")return Y.touch;if(W==="mouse")return Y.mouse};function ee(de={}){return(de.clipFunc||de.clipWidth||de.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),de}const re="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class se extends n.Container{constructor(W){super(ee(W)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ee(this.attrs)}),this._checkVisibility()}_validateAdd(W){const ne=W.getType()==="Layer",ie=W.getType()==="FastLayer";ne||ie||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const W=this.visible()?"":"none";this.content.style.display=W}setContainer(W){if(typeof W===c){if(W.charAt(0)==="."){const ie=W.slice(1);W=document.getElementsByClassName(ie)[0]}else{var ne;W.charAt(0)!=="#"?ne=W:ne=W.slice(1),W=document.getElementById(ne)}if(!W)throw"Can not find container in document with id "+ne}return this._setAttr("container",W),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),W.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let W=this.children,ne=W.length,ie;for(ie=0;ie<ne;ie++)W[ie].clear();return this}clone(W){return W||(W={}),W.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,W)}destroy(){super.destroy();const W=this.content;W&&e.Util._isInDocument(W)&&this.container().removeChild(W);const ne=t.stages.indexOf(this);return ne>-1&&t.stages.splice(ne,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const W=this._pointerPositions[0]||this._changedPointerPositions[0];return W?{x:W.x,y:W.y}:(e.Util.warn(re),null)}_getPointerById(W){return this._pointerPositions.find(ne=>ne.id===W)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(W){W=W||{},W.x=W.x||0,W.y=W.y||0,W.width=W.width||this.width(),W.height=W.height||this.height();const ne=new a.SceneCanvas({width:W.width,height:W.height,pixelRatio:W.pixelRatio||1}),ie=ne.getContext()._context,$=this.children;return(W.x||W.y)&&ie.translate(-1*W.x,-1*W.y),$.forEach(function(q){if(!q.isVisible())return;const te=q._toKonvaCanvas(W);ie.drawImage(te._canvas,W.x,W.y,te.getWidth()/te.getPixelRatio(),te.getHeight()/te.getPixelRatio())}),ne}getIntersection(W){if(!W)return null;let ne=this.children,ie=ne.length,$=ie-1,q;for(q=$;q>=0;q--){const te=ne[q].getIntersection(W);if(te)return te}return null}_resizeDOM(){const W=this.width(),ne=this.height();this.content&&(this.content.style.width=W+d,this.content.style.height=ne+d),this.bufferCanvas.setSize(W,ne),this.bufferHitCanvas.setSize(W,ne),this.children.forEach(ie=>{ie.setSize({width:W,height:ne}),ie.draw()})}add(W,...ne){if(arguments.length>1){for(let $=0;$<arguments.length;$++)this.add(arguments[$]);return this}super.add(W);const ie=this.children.length;return ie>V&&e.Util.warn("The stage has "+ie+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),W.setSize({width:this.width(),height:this.height()}),W.draw(),i.Konva.isBrowser&&this.content.appendChild(W.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(W){return l.hasPointerCapture(W,this)}setPointerCapture(W){l.setPointerCapture(W,this)}releaseCapture(W){l.releaseCapture(W,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&J.forEach(([W,ne])=>{this.content.addEventListener(W,ie=>{this[ne](ie)},{passive:!1})})}_pointerenter(W){this.setPointersPositions(W);const ne=G(W.type);ne&&this._fire(ne.pointerenter,{evt:W,target:this,currentTarget:this})}_pointerover(W){this.setPointersPositions(W);const ne=G(W.type);ne&&this._fire(ne.pointerover,{evt:W,target:this,currentTarget:this})}_getTargetShape(W){let ne=this[W+"targetShape"];return ne&&!ne.getStage()&&(ne=null),ne}_pointerleave(W){const ne=G(W.type),ie=L(W.type);if(!ne)return;this.setPointersPositions(W);const $=this._getTargetShape(ie),q=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;$&&q?($._fireAndBubble(ne.pointerout,{evt:W}),$._fireAndBubble(ne.pointerleave,{evt:W}),this._fire(ne.pointerleave,{evt:W,target:this,currentTarget:this}),this[ie+"targetShape"]=null):q&&(this._fire(ne.pointerleave,{evt:W,target:this,currentTarget:this}),this._fire(ne.pointerout,{evt:W,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(W){const ne=G(W.type),ie=L(W.type);if(!ne)return;this.setPointersPositions(W);let $=!1;this._changedPointerPositions.forEach(q=>{const te=this.getIntersection(q);if(s.DD.justDragged=!1,i.Konva["_"+ie+"ListenClick"]=!0,!te||!te.isListening()){this[ie+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&te.setPointerCapture(q.id),this[ie+"ClickStartShape"]=te,te._fireAndBubble(ne.pointerdown,{evt:W,pointerId:q.id}),$=!0;const Z=W.type.indexOf("touch")>=0;te.preventDefault()&&W.cancelable&&Z&&W.preventDefault()}),$||this._fire(ne.pointerdown,{evt:W,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(W){const ne=G(W.type),ie=L(W.type);if(!ne||(i.Konva.isDragging()&&s.DD.node.preventDefault()&&W.cancelable&&W.preventDefault(),this.setPointersPositions(W),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const q={};let te=!1;const Z=this._getTargetShape(ie);this._changedPointerPositions.forEach(le=>{const ge=l.getCapturedShape(le.id)||this.getIntersection(le),Ue=le.id,Te={evt:W,pointerId:Ue},Re=Z!==ge;if(Re&&Z&&(Z._fireAndBubble(ne.pointerout,{...Te},ge),Z._fireAndBubble(ne.pointerleave,{...Te},ge)),ge){if(q[ge._id])return;q[ge._id]=!0}ge&&ge.isListening()?(te=!0,Re&&(ge._fireAndBubble(ne.pointerover,{...Te},Z),ge._fireAndBubble(ne.pointerenter,{...Te},Z),this[ie+"targetShape"]=ge),ge._fireAndBubble(ne.pointermove,{...Te})):Z&&(this._fire(ne.pointerover,{evt:W,target:this,currentTarget:this,pointerId:Ue}),this[ie+"targetShape"]=null)}),te||this._fire(ne.pointermove,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(W){const ne=G(W.type),ie=L(W.type);if(!ne)return;this.setPointersPositions(W);const $=this[ie+"ClickStartShape"],q=this[ie+"ClickEndShape"],te={};let Z=!1;this._changedPointerPositions.forEach(le=>{const ge=l.getCapturedShape(le.id)||this.getIntersection(le);if(ge){if(ge.releaseCapture(le.id),te[ge._id])return;te[ge._id]=!0}const Ue=le.id,Te={evt:W,pointerId:Ue};let Re=!1;i.Konva["_"+ie+"InDblClickWindow"]?(Re=!0,clearTimeout(this[ie+"DblTimeout"])):s.DD.justDragged||(i.Konva["_"+ie+"InDblClickWindow"]=!0,clearTimeout(this[ie+"DblTimeout"])),this[ie+"DblTimeout"]=setTimeout(function(){i.Konva["_"+ie+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),ge&&ge.isListening()?(Z=!0,this[ie+"ClickEndShape"]=ge,ge._fireAndBubble(ne.pointerup,{...Te}),i.Konva["_"+ie+"ListenClick"]&&$&&$===ge&&(ge._fireAndBubble(ne.pointerclick,{...Te}),Re&&q&&q===ge&&ge._fireAndBubble(ne.pointerdblclick,{...Te}))):(this[ie+"ClickEndShape"]=null,i.Konva["_"+ie+"ListenClick"]&&this._fire(ne.pointerclick,{evt:W,target:this,currentTarget:this,pointerId:Ue}),Re&&this._fire(ne.pointerdblclick,{evt:W,target:this,currentTarget:this,pointerId:Ue}))}),Z||this._fire(ne.pointerup,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+ie+"ListenClick"]=!1,W.cancelable&&ie!=="touch"&&W.preventDefault()}_contextmenu(W){this.setPointersPositions(W);const ne=this.getIntersection(this.getPointerPosition());ne&&ne.isListening()?ne._fireAndBubble(R,{evt:W}):this._fire(R,{evt:W,target:this,currentTarget:this})}_wheel(W){this.setPointersPositions(W);const ne=this.getIntersection(this.getPointerPosition());ne&&ne.isListening()?ne._fireAndBubble(F,{evt:W}):this._fire(F,{evt:W,target:this,currentTarget:this})}_pointercancel(W){this.setPointersPositions(W);const ne=l.getCapturedShape(W.pointerId)||this.getIntersection(this.getPointerPosition());ne&&ne._fireAndBubble(N,l.createEvent(W)),l.releaseCapture(W.pointerId)}_lostpointercapture(W){l.releaseCapture(W.pointerId)}setPointersPositions(W){let ne=this._getContentPosition(),ie=null,$=null;W=W||window.event,W.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(W.touches,q=>{this._pointerPositions.push({id:q.identifier,x:(q.clientX-ne.left)/ne.scaleX,y:(q.clientY-ne.top)/ne.scaleY})}),Array.prototype.forEach.call(W.changedTouches||W.touches,q=>{this._changedPointerPositions.push({id:q.identifier,x:(q.clientX-ne.left)/ne.scaleX,y:(q.clientY-ne.top)/ne.scaleY})})):(ie=(W.clientX-ne.left)/ne.scaleX,$=(W.clientY-ne.top)/ne.scaleY,this.pointerPos={x:ie,y:$},this._pointerPositions=[{x:ie,y:$,id:e.Util._getFirstPointerId(W)}],this._changedPointerPositions=[{x:ie,y:$,id:e.Util._getFirstPointerId(W)}])}_setPointerPosition(W){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(W)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const W=this.content.getBoundingClientRect();return{top:W.top,left:W.left,scaleX:W.width/this.content.clientWidth||1,scaleY:W.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const W=this.container();if(!W)throw"Stage has no container. A container is required.";W.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),W.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(W){W.batchDraw()}),this}}t.Stage=se,se.prototype.nodeType=u,(0,o._registerNode)(se),r.Factory.addGetterSetter(se,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(de=>{de.batchDraw()})})})(NI);var vm={},tn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=pt,r=xr,n=gt,i=dr,a=Ze,s=pt,o=Bl,l="hasShadow",u="shadowRGBA",c="patternImage",d="linearGradient",h="radialGradient";let m;function v(){return m||(m=r.Util.createCanvasElement().getContext("2d"),m)}t.shapes={};function x(A){const P=this.attrs.fillRule;P?A.fill(P):A.fill()}function y(A){A.stroke()}function b(A){const P=this.attrs.fillRule;P?A.fill(P):A.fill()}function S(A){A.stroke()}function w(){this._clearCache(l)}function k(){this._clearCache(u)}function N(){this._clearCache(c)}function T(){this._clearCache(d)}function j(){this._clearCache(h)}class M extends i.Node{constructor(P){super(P);let D;for(;D=r.Util.getRandomColor(),!(D&&!(D in t.shapes)););this.colorKey=D,t.shapes[D]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(c,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const D=v().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(D&&D.setTransform){const R=new r.Transform;R.translate(this.fillPatternX(),this.fillPatternY()),R.rotate(e.Konva.getAngle(this.fillPatternRotation())),R.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),R.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const I=R.getMatrix(),U=typeof DOMMatrix>"u"?{a:I[0],b:I[1],c:I[2],d:I[3],e:I[4],f:I[5]}:new DOMMatrix(I);D.setTransform(U)}return D}}_getLinearGradient(){return this._getCache(d,this.__getLinearGradient)}__getLinearGradient(){const P=this.fillLinearGradientColorStops();if(P){const D=v(),R=this.fillLinearGradientStartPoint(),I=this.fillLinearGradientEndPoint(),U=D.createLinearGradient(R.x,R.y,I.x,I.y);for(let B=0;B<P.length;B+=2)U.addColorStop(P[B],P[B+1]);return U}}_getRadialGradient(){return this._getCache(h,this.__getRadialGradient)}__getRadialGradient(){const P=this.fillRadialGradientColorStops();if(P){const D=v(),R=this.fillRadialGradientStartPoint(),I=this.fillRadialGradientEndPoint(),U=D.createRadialGradient(R.x,R.y,this.fillRadialGradientStartRadius(),I.x,I.y,this.fillRadialGradientEndRadius());for(let B=0;B<P.length;B+=2)U.addColorStop(P[B],P[B+1]);return U}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const P=r.Util.colorToRGBA(this.shadowColor());if(P)return"rgba("+P.r+","+P.g+","+P.b+","+P.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const P=this.hitStrokeWidth();return P==="auto"?this.hasStroke():this.strokeEnabled()&&!!P}intersects(P){const D=this.getStage();if(!D)return!1;const R=D.bufferHitCanvas;return R.getContext().clear(),this.drawHit(R,void 0,!0),R.context.getImageData(Math.round(P.x),Math.round(P.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(P){var D;if(!((D=this.attrs.perfectDrawEnabled)!==null&&D!==void 0?D:!0))return!1;const I=P||this.hasFill(),U=this.hasStroke(),B=this.getAbsoluteOpacity()!==1;if(I&&U&&B)return!0;const z=this.hasShadow(),F=this.shadowForStrokeEnabled();return!!(I&&U&&z&&F)}setStrokeHitEnabled(P){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),P?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const P=this.size();return{x:this._centroid?-P.width/2:0,y:this._centroid?-P.height/2:0,width:P.width,height:P.height}}getClientRect(P={}){let D=!1,R=this.getParent();for(;R;){if(R.isCached()){D=!0;break}R=R.getParent()}const I=P.skipTransform,U=P.relativeTo||D&&this.getStage()||void 0,B=this.getSelfRect(),F=!P.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,V=B.width+F,J=B.height+F,Y=!P.skipShadow&&this.hasShadow(),L=Y?this.shadowOffsetX():0,G=Y?this.shadowOffsetY():0,ee=V+Math.abs(L),re=J+Math.abs(G),se=Y&&this.shadowBlur()||0,de=ee+se*2,W=re+se*2,ne={width:de,height:W,x:-(F/2+se)+Math.min(L,0)+B.x,y:-(F/2+se)+Math.min(G,0)+B.y};return I?ne:this._transformedRect(ne,U)}drawScene(P,D,R){const I=this.getLayer();let U=P||I.getCanvas(),B=U.getContext(),z=this._getCanvasCache(),F=this.getSceneFunc(),V=this.hasShadow(),J,Y;const L=U.isCache,G=D===this;if(!this.isVisible()&&!G)return this;if(z){B.save();const re=this.getAbsoluteTransform(D).getMatrix();return B.transform(re[0],re[1],re[2],re[3],re[4],re[5]),this._drawCachedSceneCanvas(B),B.restore(),this}if(!F)return this;if(B.save(),this._useBufferCanvas()&&!L){J=this.getStage();const re=R||J.bufferCanvas;Y=re.getContext(),Y.clear(),Y.save(),Y._applyLineJoin(this);var ee=this.getAbsoluteTransform(D).getMatrix();Y.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]),F.call(this,Y,this),Y.restore();const se=re.pixelRatio;V&&B._applyShadow(this),B._applyOpacity(this),B._applyGlobalCompositeOperation(this),B.drawImage(re._canvas,0,0,re.width/se,re.height/se)}else{if(B._applyLineJoin(this),!G){var ee=this.getAbsoluteTransform(D).getMatrix();B.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]),B._applyOpacity(this),B._applyGlobalCompositeOperation(this)}V&&B._applyShadow(this),F.call(this,B,this)}return B.restore(),this}drawHit(P,D,R=!1){if(!this.shouldDrawHit(D,R))return this;const I=this.getLayer(),U=P||I.hitCanvas,B=U&&U.getContext(),z=this.hitFunc()||this.sceneFunc(),F=this._getCanvasCache(),V=F&&F.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),V){B.save();const Y=this.getAbsoluteTransform(D).getMatrix();return B.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),this._drawCachedHitCanvas(B),B.restore(),this}if(!z)return this;if(B.save(),B._applyLineJoin(this),!(this===D)){const Y=this.getAbsoluteTransform(D).getMatrix();B.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5])}return z.call(this,B,this),B.restore(),this}drawHitFromCache(P=0){let D=this._getCanvasCache(),R=this._getCachedSceneCanvas(),I=D.hit,U=I.getContext(),B=I.getWidth(),z=I.getHeight(),F,V,J,Y,L,G;U.clear(),U.drawImage(R._canvas,0,0,B,z);try{for(F=U.getImageData(0,0,B,z),V=F.data,J=V.length,Y=r.Util._hexToRgb(this.colorKey),L=0;L<J;L+=4)G=V[L+3],G>P?(V[L]=Y.r,V[L+1]=Y.g,V[L+2]=Y.b,V[L+3]=255):V[L+3]=0;U.putImageData(F,0,0)}catch(ee){r.Util.error("Unable to draw hit graph from cached scene canvas. "+ee.message)}return this}hasPointerCapture(P){return o.hasPointerCapture(P,this)}setPointerCapture(P){o.setPointerCapture(P,this)}releaseCapture(P){o.releaseCapture(P,this)}}t.Shape=M,M.prototype._fillFunc=x,M.prototype._strokeFunc=y,M.prototype._fillFuncHit=b,M.prototype._strokeFuncHit=S,M.prototype._centroid=!1,M.prototype.nodeType="Shape",(0,s._registerNode)(M),M.prototype.eventListeners={},M.prototype.on.call(M.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),M.prototype.on.call(M.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",k),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",N),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",T),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",j),n.Factory.addGetterSetter(M,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(M,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(M,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(M,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(M,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(M,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(M,"lineJoin"),n.Factory.addGetterSetter(M,"lineCap"),n.Factory.addGetterSetter(M,"sceneFunc"),n.Factory.addGetterSetter(M,"hitFunc"),n.Factory.addGetterSetter(M,"dash"),n.Factory.addGetterSetter(M,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(M,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(M,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(M,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillPatternImage"),n.Factory.addGetterSetter(M,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(M,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(M,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(M,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(M,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(M,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(M,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(M,"fillEnabled",!0),n.Factory.addGetterSetter(M,"strokeEnabled",!0),n.Factory.addGetterSetter(M,"shadowEnabled",!0),n.Factory.addGetterSetter(M,"dashEnabled",!0),n.Factory.addGetterSetter(M,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(M,"fillPriority","color"),n.Factory.addComponentsGetterSetter(M,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(M,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(M,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(M,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(M,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(M,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(M,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(M,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(M,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(M,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(M,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(M,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(M,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(M,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(M,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(M,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(M,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(M,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(M,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(M,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(M,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(M,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(M,"fillPatternRotation",0),n.Factory.addGetterSetter(M,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(M,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(tn);Object.defineProperty(vm,"__esModule",{value:!0});vm.Layer=void 0;const Ds=xr,TS=ic,Fc=dr,c4=gt,fM=Oa,Pse=Ze,_se=tn,Ase=pt,Rse="#",Dse="beforeDraw",Ose="draw",jI=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Ise=jI.length;let df=class extends TS.Container{constructor(e){super(e),this.canvas=new fM.SceneCanvas,this.hitCanvas=new fM.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),e<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[e+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Fc.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Fc.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Fc.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Fc.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return Fc.Node.prototype.remove.call(this),e&&e.parentNode&&Ds.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:r}){return this.canvas.setSize(e,r),this.hitCanvas.setSize(e,r),this._setSmoothEnabled(),this}_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&Ds.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),Fc.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Ds.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Ds.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Ds.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let i=0;i<Ise;i++){const a=jI[i],s=this._getIntersection({x:e.x+a.x*r,y:e.y+a.y*r}),o=s.shape;if(o)return o;if(n=!!s.antialiased,!s.antialiased)break}if(n)r+=1;else return null}}_getIntersection(e){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(e.x*r),Math.round(e.y*r),1,1).data,i=n[3];if(i===255){const a=Ds.Util._rgbToHex(n[0],n[1],n[2]),s=_se.shapes[Rse+a];return s?{shape:s}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,r){const n=this.getLayer(),i=e||n&&n.getCanvas();return this._fire(Dse,{node:this}),this.clearBeforeDraw()&&i.getContext().clear(),TS.Container.prototype.drawScene.call(this,i,r),this._fire(Ose,{node:this}),this}drawHit(e,r){const n=this.getLayer(),i=e||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),TS.Container.prototype.drawHit.call(this,i,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Ds.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Ds.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Ds.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};vm.Layer=df;df.prototype.nodeType="Layer";(0,Ase._registerNode)(df);c4.Factory.addGetterSetter(df,"imageSmoothingEnabled",!0);c4.Factory.addGetterSetter(df,"clearBeforeDraw",!0);c4.Factory.addGetterSetter(df,"hitGraphEnabled",!0,(0,Pse.getBooleanValidator)());var Lx={};Object.defineProperty(Lx,"__esModule",{value:!0});Lx.FastLayer=void 0;const Lse=xr,Bse=vm,Fse=pt;class d4 extends Bse.Layer{constructor(e){super(e),this.listening(!1),Lse.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Lx.FastLayer=d4;d4.prototype.nodeType="FastLayer";(0,Fse._registerNode)(d4);var ff={};Object.defineProperty(ff,"__esModule",{value:!0});ff.Group=void 0;const zse=xr,Vse=ic,$se=pt;class f4 extends Vse.Container{_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&zse.Util.throw("You may only add groups and shapes to groups.")}}ff.Group=f4;f4.prototype.nodeType="Group";(0,$se._registerNode)(f4);var hf={};Object.defineProperty(hf,"__esModule",{value:!0});hf.Animation=void 0;const jS=pt,hM=xr,MS=function(){return jS.glob.performance&&jS.glob.performance.now?function(){return jS.glob.performance.now()}:function(){return new Date().getTime()}}();class as{constructor(e,r){this.id=as.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:MS(),frameRate:0},this.func=e,this.setLayers(r)}setLayers(e){let r=[];return e&&(r=Array.isArray(e)?e:[e]),this.layers=r,this}getLayers(){return this.layers}addLayer(e){const r=this.layers,n=r.length;for(let i=0;i<n;i++)if(r[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const r=as.animations,n=r.length;for(let i=0;i<n;i++)if(r[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=MS(),as._addAnimation(this),this}stop(){return as._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const r=e.id,n=this.animations,i=n.length;for(let a=0;a<i;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const e={},r=this.animations;for(let n=0;n<r.length;n++){const i=r[n],a=i.layers,s=i.func;i._updateFrameObject(MS());const o=a.length;let l;if(s?l=s.call(i,i.frame)!==!1:l=!0,!!l)for(let u=0;u<o;u++){const c=a[u];c._id!==void 0&&(e[c._id]=c)}}for(const n in e)e.hasOwnProperty(n)&&e[n].batchDraw()}static _animationLoop(){const e=as;e.animations.length?(e._runFrames(),hM.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,hM.Util.requestAnimFrame(this._animationLoop))}}hf.Animation=as;as.animations=[];as.animIdCounter=0;as.animRunning=!1;var MI={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=xr,r=hf,n=dr,i=pt;let a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,o=2,l=3,u=0,c=["fill","stroke","shadowColor"];class d{constructor(v,x,y,b,S,w,k){this.prop=v,this.propFunc=x,this.begin=b,this._pos=b,this.duration=w,this._change=0,this.prevPos=0,this.yoyo=k,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=y,this._change=S-this.begin,this.pause()}fire(v){const x=this[v];x&&x()}setTime(v){v>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():v<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=v,this.update())}getTime(){return this._time}setPosition(v){this.prevPos=this._pos,this.propFunc(v),this._pos=v}getPosition(v){return v===void 0&&(v=this._time),this.func(v,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(v){this.pause(),this._time=v,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const v=this.getTimer()-this._startTime;this.state===o?this.setTime(v):this.state===l&&this.setTime(this.duration-v)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class h{constructor(v){let x=this,y=v.node,b=y._id,S,w=v.easing||t.Easings.Linear,k=!!v.yoyo,N;typeof v.duration>"u"?S=.3:v.duration===0?S=.001:S=v.duration,this.node=y,this._id=u++;const T=y.getLayer()||(y instanceof i.Konva.Stage?y.getLayers():null);T||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){x.tween.onEnterFrame()},T),this.tween=new d(N,function(j){x._tweenFunc(j)},w,0,1,S*1e3,k),this._addListeners(),h.attrs[b]||(h.attrs[b]={}),h.attrs[b][this._id]||(h.attrs[b][this._id]={}),h.tweens[b]||(h.tweens[b]={});for(N in v)a[N]===void 0&&this._addAttr(N,v[N]);this.reset(),this.onFinish=v.onFinish,this.onReset=v.onReset,this.onUpdate=v.onUpdate}_addAttr(v,x){let y=this.node,b=y._id,S,w,k,N,T,j,M,A;if(k=h.tweens[b][v],k&&delete h.attrs[b][k][v],S=y.getAttr(v),e.Util._isArray(x))if(w=[],T=Math.max(x.length,S.length),v==="points"&&x.length!==S.length&&(x.length>S.length?(M=S,S=e.Util._prepareArrayForTween(S,x,y.closed())):(j=x,x=e.Util._prepareArrayForTween(x,S,y.closed()))),v.indexOf("fill")===0)for(N=0;N<T;N++)if(N%2===0)w.push(x[N]-S[N]);else{const P=e.Util.colorToRGBA(S[N]);A=e.Util.colorToRGBA(x[N]),S[N]=P,w.push({r:A.r-P.r,g:A.g-P.g,b:A.b-P.b,a:A.a-P.a})}else for(N=0;N<T;N++)w.push(x[N]-S[N]);else c.indexOf(v)!==-1?(S=e.Util.colorToRGBA(S),A=e.Util.colorToRGBA(x),w={r:A.r-S.r,g:A.g-S.g,b:A.b-S.b,a:A.a-S.a}):w=x-S;h.attrs[b][this._id][v]={start:S,diff:w,end:x,trueEnd:j,trueStart:M},h.tweens[b][v]=this._id}_tweenFunc(v){let x=this.node,y=h.attrs[x._id][this._id],b,S,w,k,N,T,j,M;for(b in y){if(S=y[b],w=S.start,k=S.diff,M=S.end,e.Util._isArray(w))if(N=[],j=Math.max(w.length,M.length),b.indexOf("fill")===0)for(T=0;T<j;T++)T%2===0?N.push((w[T]||0)+k[T]*v):N.push("rgba("+Math.round(w[T].r+k[T].r*v)+","+Math.round(w[T].g+k[T].g*v)+","+Math.round(w[T].b+k[T].b*v)+","+(w[T].a+k[T].a*v)+")");else for(T=0;T<j;T++)N.push((w[T]||0)+k[T]*v);else c.indexOf(b)!==-1?N="rgba("+Math.round(w.r+k.r*v)+","+Math.round(w.g+k.g*v)+","+Math.round(w.b+k.b*v)+","+(w.a+k.a*v)+")":N=w+k*v;x.setAttr(b,N)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const v=this.node,x=h.attrs[v._id][this._id];x.points&&x.points.trueEnd&&v.setAttr("points",x.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const v=this.node,x=h.attrs[v._id][this._id];x.points&&x.points.trueStart&&v.points(x.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(v){return this.tween.seek(v*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let v=this.node._id,x=this._id,y=h.tweens[v],b;this.pause();for(b in y)delete h.tweens[v][b];delete h.attrs[v][x]}}t.Tween=h,h.attrs={},h.tweens={},n.Node.prototype.to=function(m){const v=m.onFinish;m.node=this,m.onFinish=function(){this.destroy(),v&&v()},new h(m).play()},t.Easings={BackEaseIn(m,v,x,y){return x*(m/=y)*m*((1.70158+1)*m-1.70158)+v},BackEaseOut(m,v,x,y){return x*((m=m/y-1)*m*((1.70158+1)*m+1.70158)+1)+v},BackEaseInOut(m,v,x,y){let b=1.70158;return(m/=y/2)<1?x/2*(m*m*(((b*=1.525)+1)*m-b))+v:x/2*((m-=2)*m*(((b*=1.525)+1)*m+b)+2)+v},ElasticEaseIn(m,v,x,y,b,S){let w=0;return m===0?v:(m/=y)===1?v+x:(S||(S=y*.3),!b||b<Math.abs(x)?(b=x,w=S/4):w=S/(2*Math.PI)*Math.asin(x/b),-(b*Math.pow(2,10*(m-=1))*Math.sin((m*y-w)*(2*Math.PI)/S))+v)},ElasticEaseOut(m,v,x,y,b,S){let w=0;return m===0?v:(m/=y)===1?v+x:(S||(S=y*.3),!b||b<Math.abs(x)?(b=x,w=S/4):w=S/(2*Math.PI)*Math.asin(x/b),b*Math.pow(2,-10*m)*Math.sin((m*y-w)*(2*Math.PI)/S)+x+v)},ElasticEaseInOut(m,v,x,y,b,S){let w=0;return m===0?v:(m/=y/2)===2?v+x:(S||(S=y*(.3*1.5)),!b||b<Math.abs(x)?(b=x,w=S/4):w=S/(2*Math.PI)*Math.asin(x/b),m<1?-.5*(b*Math.pow(2,10*(m-=1))*Math.sin((m*y-w)*(2*Math.PI)/S))+v:b*Math.pow(2,-10*(m-=1))*Math.sin((m*y-w)*(2*Math.PI)/S)*.5+x+v)},BounceEaseOut(m,v,x,y){return(m/=y)<1/2.75?x*(7.5625*m*m)+v:m<2/2.75?x*(7.5625*(m-=1.5/2.75)*m+.75)+v:m<2.5/2.75?x*(7.5625*(m-=2.25/2.75)*m+.9375)+v:x*(7.5625*(m-=2.625/2.75)*m+.984375)+v},BounceEaseIn(m,v,x,y){return x-t.Easings.BounceEaseOut(y-m,0,x,y)+v},BounceEaseInOut(m,v,x,y){return m<y/2?t.Easings.BounceEaseIn(m*2,0,x,y)*.5+v:t.Easings.BounceEaseOut(m*2-y,0,x,y)*.5+x*.5+v},EaseIn(m,v,x,y){return x*(m/=y)*m+v},EaseOut(m,v,x,y){return-x*(m/=y)*(m-2)+v},EaseInOut(m,v,x,y){return(m/=y/2)<1?x/2*m*m+v:-x/2*(--m*(m-2)-1)+v},StrongEaseIn(m,v,x,y){return x*(m/=y)*m*m*m*m+v},StrongEaseOut(m,v,x,y){return x*((m=m/y-1)*m*m*m*m+1)+v},StrongEaseInOut(m,v,x,y){return(m/=y/2)<1?x/2*m*m*m*m*m+v:x/2*((m-=2)*m*m*m*m+2)+v},Linear(m,v,x,y){return x*m/y+v}}})(MI);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=pt,r=xr,n=dr,i=ic,a=NI,s=vm,o=Lx,l=ff,u=Ox,c=tn,d=hf,h=MI,m=Ks,v=Oa;t.Konva=r.Util._assign(e.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:s.Layer,FastLayer:o.FastLayer,Group:l.Group,DD:u.DD,Shape:c.Shape,shapes:c.shapes,Animation:d.Animation,Tween:h.Tween,Easings:h.Easings,Context:m.Context,Canvas:v.Canvas}),t.default=t.Konva})(Ey);var Bx={};Object.defineProperty(Bx,"__esModule",{value:!0});Bx.Arc=void 0;const Fx=gt,Use=tn,pM=pt,zx=Ze,Gse=pt;class co extends Use.Shape{_sceneFunc(e){const r=pM.Konva.getAngle(this.angle()),n=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,r,n),e.arc(0,0,this.innerRadius(),r,0,!n),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),i=pM.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(i,Math.PI)),s=1,o=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),l=Math.sin(Math.min(i,Math.PI/2)),u=a*(a>0?e:r),c=s*r,d=o*(o>0?e:r),h=l*(l>0?r:e);return{x:u,y:n?-1*h:d,width:c-u,height:h-d}}}Bx.Arc=co;co.prototype._centroid=!0;co.prototype.className="Arc";co.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Gse._registerNode)(co);Fx.Factory.addGetterSetter(co,"innerRadius",0,(0,zx.getNumberValidator)());Fx.Factory.addGetterSetter(co,"outerRadius",0,(0,zx.getNumberValidator)());Fx.Factory.addGetterSetter(co,"angle",0,(0,zx.getNumberValidator)());Fx.Factory.addGetterSetter(co,"clockwise",!1,(0,zx.getBooleanValidator)());var Vx={},ym={};Object.defineProperty(ym,"__esModule",{value:!0});ym.Line=void 0;const $x=gt,Hse=pt,Wse=tn,PI=Ze;function Vk(t,e,r,n,i,a,s){const o=Math.sqrt(Math.pow(r-t,2)+Math.pow(n-e,2)),l=Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2)),u=s*o/(o+l),c=s*l/(o+l),d=r-u*(i-t),h=n-u*(a-e),m=r+c*(i-t),v=n+c*(a-e);return[d,h,m,v]}function mM(t,e){const r=t.length,n=[];for(let i=2;i<r-2;i+=2){const a=Vk(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(t[i]),n.push(t[i+1]),n.push(a[2]),n.push(a[3]))}return n}let Fl=class extends Wse.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){let r=this.points(),n=r.length,i=this.tension(),a=this.closed(),s=this.bezier(),o,l,u;if(n){if(e.beginPath(),e.moveTo(r[0],r[1]),i!==0&&n>4){for(o=this.getTensionPoints(),l=o.length,u=a?0:4,a||e.quadraticCurveTo(o[0],o[1],o[2],o[3]);u<l-2;)e.bezierCurveTo(o[u++],o[u++],o[u++],o[u++],o[u++],o[u++]);a||e.quadraticCurveTo(o[l-2],o[l-1],r[n-2],r[n-1])}else if(s)for(u=2;u<n;)e.bezierCurveTo(r[u++],r[u++],r[u++],r[u++],r[u++],r[u++]);else for(u=2;u<n;u+=2)e.lineTo(r[u],r[u+1]);a?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():mM(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),r=e.length,n=this.tension(),i=Vk(e[r-2],e[r-1],e[0],e[1],e[2],e[3],n),a=Vk(e[r-4],e[r-3],e[r-2],e[r-1],e[0],e[1],n),s=mM(e,n);return[i[2],i[3]].concat(s).concat([a[0],a[1],e[r-2],e[r-1],a[2],a[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let r=e[0],n=e[0],i=e[1],a=e[1],s,o;for(let l=0;l<e.length/2;l++)s=e[l*2],o=e[l*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);return{x:r,y:i,width:n-r,height:a-i}}};ym.Line=Fl;Fl.prototype.className="Line";Fl.prototype._attrsAffectingSize=["points","bezier","tension"];(0,Hse._registerNode)(Fl);$x.Factory.addGetterSetter(Fl,"closed",!1);$x.Factory.addGetterSetter(Fl,"bezier",!1);$x.Factory.addGetterSetter(Fl,"tension",0,(0,PI.getNumberValidator)());$x.Factory.addGetterSetter(Fl,"points",[],(0,PI.getNumberArrayValidator)());var pf={},_I={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(s,o,l)=>{let u,c;const h=l/2;u=0;for(let m=0;m<20;m++)c=h*t.tValues[20][m]+h,u+=t.cValues[20][m]*n(s,o,c);return h*u};t.getCubicArcLength=e;const r=(s,o,l)=>{l===void 0&&(l=1);const u=s[0]-2*s[1]+s[2],c=o[0]-2*o[1]+o[2],d=2*s[1]-2*s[0],h=2*o[1]-2*o[0],m=4*(u*u+c*c),v=4*(u*d+c*h),x=d*d+h*h;if(m===0)return l*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(o[2]-o[0],2));const y=v/(2*m),b=x/m,S=l+y,w=b-y*y,k=S*S+w>0?Math.sqrt(S*S+w):0,N=y*y+w>0?Math.sqrt(y*y+w):0,T=y+Math.sqrt(y*y+w)!==0?w*Math.log(Math.abs((S+k)/(y+N))):0;return Math.sqrt(m)/2*(S*k-y*N+T)};t.getQuadraticArcLength=r;function n(s,o,l){const u=i(1,l,s),c=i(1,l,o),d=u*u+c*c;return Math.sqrt(d)}const i=(s,o,l)=>{const u=l.length-1;let c,d;if(u===0)return 0;if(s===0){d=0;for(let h=0;h<=u;h++)d+=t.binomialCoefficients[u][h]*Math.pow(1-o,u-h)*Math.pow(o,h)*l[h];return d}else{c=new Array(u);for(let h=0;h<u;h++)c[h]=u*(l[h+1]-l[h]);return i(s-1,o,c)}},a=(s,o,l)=>{let u=1,c=s/o,d=(s-l(c))/o,h=0;for(;u>.001;){const m=l(c+d),v=Math.abs(s-m)/o;if(v<u)u=v,c+=d;else{const x=l(c-d),y=Math.abs(s-x)/o;y<u?(u=y,c-=d):d/=2}if(h++,h>500)break}return c};t.t2length=a})(_I);Object.defineProperty(pf,"__esModule",{value:!0});pf.Path=void 0;const qse=gt,Kse=tn,Yse=pt,zc=_I;class Kr extends Kse.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Kr.parsePathData(this.data()),this.pathLength=Kr.getPathLength(this.dataArray)}_sceneFunc(e){const r=this.dataArray;e.beginPath();let n=!1;for(let x=0;x<r.length;x++){const y=r[x].command,b=r[x].points;switch(y){case"L":e.lineTo(b[0],b[1]);break;case"M":e.moveTo(b[0],b[1]);break;case"C":e.bezierCurveTo(b[0],b[1],b[2],b[3],b[4],b[5]);break;case"Q":e.quadraticCurveTo(b[0],b[1],b[2],b[3]);break;case"A":var i=b[0],a=b[1],s=b[2],o=b[3],l=b[4],u=b[5],c=b[6],d=b[7],h=s>o?s:o,m=s>o?1:s/o,v=s>o?o/s:1;e.translate(i,a),e.rotate(c),e.scale(m,v),e.arc(0,0,h,l,l+u,1-d),e.scale(1/m,1/v),e.rotate(-c),e.translate(-i,-a);break;case"z":n=!0,e.closePath();break}}!n&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(l){if(l.command==="A"){const u=l.points[4],c=l.points[5],d=l.points[4]+c;let h=Math.PI/180;if(Math.abs(u-d)<h&&(h=Math.abs(u-d)),c<0)for(let m=u-h;m>d;m-=h){const v=Kr.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],m,0);e.push(v.x,v.y)}else for(let m=u+h;m<d;m+=h){const v=Kr.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],m,0);e.push(v.x,v.y)}}else if(l.command==="C")for(let u=0;u<=1;u+=.01){const c=Kr.getPointOnCubicBezier(u,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);e.push(c.x,c.y)}else e=e.concat(l.points)});let r=e[0],n=e[0],i=e[1],a=e[1],s,o;for(let l=0;l<e.length/2;l++)s=e[l*2],o=e[l*2+1],isNaN(s)||(r=Math.min(r,s),n=Math.max(n,s)),isNaN(o)||(i=Math.min(i,o),a=Math.max(a,o));return{x:r,y:i,width:n-r,height:a-i}}getLength(){return this.pathLength}getPointAtLength(e){return Kr.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,r,n,i){return Math.sqrt((n-e)*(n-e)+(i-r)*(i-r))}static getPathLength(e){let r=0;for(let n=0;n<e.length;++n)r+=e[n].pathLength;return r}static getPointAtLengthOfDataArray(e,r){let n,i=0,a=r.length;if(!a)return null;for(;i<a&&e>r[i].pathLength;)e-=r[i].pathLength,++i;if(i===a)return n=r[i-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return n=r[i].points.slice(0,2),{x:n[0],y:n[1]};const s=r[i],o=s.points;switch(s.command){case"L":return Kr.getPointOnLine(e,s.start.x,s.start.y,o[0],o[1]);case"C":return Kr.getPointOnCubicBezier((0,zc.t2length)(e,Kr.getPathLength(r),x=>(0,zc.getCubicArcLength)([s.start.x,o[0],o[2],o[4]],[s.start.y,o[1],o[3],o[5]],x)),s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Kr.getPointOnQuadraticBezier((0,zc.t2length)(e,Kr.getPathLength(r),x=>(0,zc.getQuadraticArcLength)([s.start.x,o[0],o[2]],[s.start.y,o[1],o[3]],x)),s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":var l=o[0],u=o[1],c=o[2],d=o[3],h=o[4],m=o[5],v=o[6];return h+=m*e/s.pathLength,Kr.getPointOnEllipticalArc(l,u,c,d,h,v)}return null}static getPointOnLine(e,r,n,i,a,s,o){s=s??r,o=o??n;const l=this.getLineLength(r,n,i,a);if(l<1e-10)return{x:r,y:n};if(i===r)return{x:s,y:o+(a>n?e:-e)};const u=(a-n)/(i-r),c=Math.sqrt(e*e/(1+u*u))*(i<r?-1:1),d=u*c;if(Math.abs(o-n-u*(s-r))<1e-10)return{x:s+c,y:o+d};const h=((s-r)*(i-r)+(o-n)*(a-n))/(l*l),m=r+h*(i-r),v=n+h*(a-n),x=this.getLineLength(s,o,m,v),y=Math.sqrt(e*e-x*x),b=Math.sqrt(y*y/(1+u*u))*(i<r?-1:1),S=u*b;return{x:m+b,y:v+S}}static getPointOnCubicBezier(e,r,n,i,a,s,o,l,u){function c(y){return y*y*y}function d(y){return 3*y*y*(1-y)}function h(y){return 3*y*(1-y)*(1-y)}function m(y){return(1-y)*(1-y)*(1-y)}const v=l*c(e)+s*d(e)+i*h(e)+r*m(e),x=u*c(e)+o*d(e)+a*h(e)+n*m(e);return{x:v,y:x}}static getPointOnQuadraticBezier(e,r,n,i,a,s,o){function l(m){return m*m}function u(m){return 2*m*(1-m)}function c(m){return(1-m)*(1-m)}const d=s*l(e)+i*u(e)+r*c(e),h=o*l(e)+a*u(e)+n*c(e);return{x:d,y:h}}static getPointOnEllipticalArc(e,r,n,i,a,s){const o=Math.cos(s),l=Math.sin(s),u={x:n*Math.cos(a),y:i*Math.sin(a)};return{x:e+(u.x*o-u.y*l),y:r+(u.x*l+u.y*o)}}static parsePathData(e){if(!e)return[];let r=e;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(var i=0;i<n.length;i++)r=r.replace(new RegExp(n[i],"g"),"|"+n[i]);const a=r.split("|"),s=[],o=[];let l=0,u=0;const c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(i=1;i<a.length;i++){let M=a[i],A=M.charAt(0);for(M=M.slice(1),o.length=0;d=c.exec(M);)o.push(d[0]);const P=[];for(let D=0,R=o.length;D<R;D++){if(o[D]==="00"){P.push(0,0);continue}const I=parseFloat(o[D]);isNaN(I)?P.push(0):P.push(I)}for(;P.length>0&&!isNaN(P[0]);){let D="",R=[];const I=l,U=u;var h,m,v,x,y,b,S,w,k,N;switch(A){case"l":l+=P.shift(),u+=P.shift(),D="L",R.push(l,u);break;case"L":l=P.shift(),u=P.shift(),R.push(l,u);break;case"m":var T=P.shift(),j=P.shift();if(l+=T,u+=j,D="M",s.length>2&&s[s.length-1].command==="z"){for(let B=s.length-2;B>=0;B--)if(s[B].command==="M"){l=s[B].points[0]+T,u=s[B].points[1]+j;break}}R.push(l,u),A="l";break;case"M":l=P.shift(),u=P.shift(),D="M",R.push(l,u),A="L";break;case"h":l+=P.shift(),D="L",R.push(l,u);break;case"H":l=P.shift(),D="L",R.push(l,u);break;case"v":u+=P.shift(),D="L",R.push(l,u);break;case"V":u=P.shift(),D="L",R.push(l,u);break;case"C":R.push(P.shift(),P.shift(),P.shift(),P.shift()),l=P.shift(),u=P.shift(),R.push(l,u);break;case"c":R.push(l+P.shift(),u+P.shift(),l+P.shift(),u+P.shift()),l+=P.shift(),u+=P.shift(),D="C",R.push(l,u);break;case"S":m=l,v=u,h=s[s.length-1],h.command==="C"&&(m=l+(l-h.points[2]),v=u+(u-h.points[3])),R.push(m,v,P.shift(),P.shift()),l=P.shift(),u=P.shift(),D="C",R.push(l,u);break;case"s":m=l,v=u,h=s[s.length-1],h.command==="C"&&(m=l+(l-h.points[2]),v=u+(u-h.points[3])),R.push(m,v,l+P.shift(),u+P.shift()),l+=P.shift(),u+=P.shift(),D="C",R.push(l,u);break;case"Q":R.push(P.shift(),P.shift()),l=P.shift(),u=P.shift(),R.push(l,u);break;case"q":R.push(l+P.shift(),u+P.shift()),l+=P.shift(),u+=P.shift(),D="Q",R.push(l,u);break;case"T":m=l,v=u,h=s[s.length-1],h.command==="Q"&&(m=l+(l-h.points[0]),v=u+(u-h.points[1])),l=P.shift(),u=P.shift(),D="Q",R.push(m,v,l,u);break;case"t":m=l,v=u,h=s[s.length-1],h.command==="Q"&&(m=l+(l-h.points[0]),v=u+(u-h.points[1])),l+=P.shift(),u+=P.shift(),D="Q",R.push(m,v,l,u);break;case"A":x=P.shift(),y=P.shift(),b=P.shift(),S=P.shift(),w=P.shift(),k=l,N=u,l=P.shift(),u=P.shift(),D="A",R=this.convertEndpointToCenterParameterization(k,N,l,u,S,w,x,y,b);break;case"a":x=P.shift(),y=P.shift(),b=P.shift(),S=P.shift(),w=P.shift(),k=l,N=u,l+=P.shift(),u+=P.shift(),D="A",R=this.convertEndpointToCenterParameterization(k,N,l,u,S,w,x,y,b);break}s.push({command:D||A,points:R,start:{x:I,y:U},pathLength:this.calcLength(I,U,D||A,R)})}(A==="z"||A==="Z")&&s.push({command:"z",points:[],start:void 0,pathLength:0})}return s}static calcLength(e,r,n,i){let a,s,o,l;const u=Kr;switch(n){case"L":return u.getLineLength(e,r,i[0],i[1]);case"C":return(0,zc.getCubicArcLength)([e,i[0],i[2],i[4]],[r,i[1],i[3],i[5]],1);case"Q":return(0,zc.getQuadraticArcLength)([e,i[0],i[2]],[r,i[1],i[3]],1);case"A":a=0;var c=i[4],d=i[5],h=i[4]+d,m=Math.PI/180;if(Math.abs(c-h)<m&&(m=Math.abs(c-h)),s=u.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],c,0),d<0)for(l=c-m;l>h;l-=m)o=u.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],l,0),a+=u.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(l=c+m;l<h;l+=m)o=u.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],l,0),a+=u.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=u.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],h,0),a+=u.getLineLength(s.x,s.y,o.x,o.y),a}return 0}static convertEndpointToCenterParameterization(e,r,n,i,a,s,o,l,u){const c=u*(Math.PI/180),d=Math.cos(c)*(e-n)/2+Math.sin(c)*(r-i)/2,h=-1*Math.sin(c)*(e-n)/2+Math.cos(c)*(r-i)/2,m=d*d/(o*o)+h*h/(l*l);m>1&&(o*=Math.sqrt(m),l*=Math.sqrt(m));let v=Math.sqrt((o*o*(l*l)-o*o*(h*h)-l*l*(d*d))/(o*o*(h*h)+l*l*(d*d)));a===s&&(v*=-1),isNaN(v)&&(v=0);const x=v*o*h/l,y=v*-l*d/o,b=(e+n)/2+Math.cos(c)*x-Math.sin(c)*y,S=(r+i)/2+Math.sin(c)*x+Math.cos(c)*y,w=function(P){return Math.sqrt(P[0]*P[0]+P[1]*P[1])},k=function(P,D){return(P[0]*D[0]+P[1]*D[1])/(w(P)*w(D))},N=function(P,D){return(P[0]*D[1]<P[1]*D[0]?-1:1)*Math.acos(k(P,D))},T=N([1,0],[(d-x)/o,(h-y)/l]),j=[(d-x)/o,(h-y)/l],M=[(-1*d-x)/o,(-1*h-y)/l];let A=N(j,M);return k(j,M)<=-1&&(A=Math.PI),k(j,M)>=1&&(A=0),s===0&&A>0&&(A=A-2*Math.PI),s===1&&A<0&&(A=A+2*Math.PI),[b,S,o,l,T,A,c,s]}}pf.Path=Kr;Kr.prototype.className="Path";Kr.prototype._attrsAffectingSize=["data"];(0,Yse._registerNode)(Kr);qse.Factory.addGetterSetter(Kr,"data");Object.defineProperty(Vx,"__esModule",{value:!0});Vx.Arrow=void 0;const Ux=gt,Xse=ym,AI=Ze,Qse=pt,gM=pf;class sc extends Xse.Line{_sceneFunc(e){super._sceneFunc(e);const r=Math.PI*2,n=this.points();let i=n;const a=this.tension()!==0&&n.length>4;a&&(i=this.getTensionPoints());const s=this.pointerLength(),o=n.length;let l,u;if(a){const h=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],n[o-2],n[o-1]],m=gM.Path.calcLength(i[i.length-4],i[i.length-3],"C",h),v=gM.Path.getPointOnQuadraticBezier(Math.min(1,1-s/m),h[0],h[1],h[2],h[3],h[4],h[5]);l=n[o-2]-v.x,u=n[o-1]-v.y}else l=n[o-2]-n[o-4],u=n[o-1]-n[o-3];const c=(Math.atan2(u,l)+r)%r,d=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(n[o-2],n[o-1]),e.rotate(c),e.moveTo(0,0),e.lineTo(-s,d/2),e.lineTo(-s,-d/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(n[0],n[1]),a?(l=(i[0]+i[2])/2-n[0],u=(i[1]+i[3])/2-n[1]):(l=n[2]-n[0],u=n[3]-n[1]),e.rotate((Math.atan2(-u,-l)+r)%r),e.moveTo(0,0),e.lineTo(-s,d/2),e.lineTo(-s,-d/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),r=this.pointerWidth()/2;return{x:e.x-r,y:e.y-r,width:e.width+r*2,height:e.height+r*2}}}Vx.Arrow=sc;sc.prototype.className="Arrow";(0,Qse._registerNode)(sc);Ux.Factory.addGetterSetter(sc,"pointerLength",10,(0,AI.getNumberValidator)());Ux.Factory.addGetterSetter(sc,"pointerWidth",10,(0,AI.getNumberValidator)());Ux.Factory.addGetterSetter(sc,"pointerAtBeginning",!1);Ux.Factory.addGetterSetter(sc,"pointerAtEnding",!0);var Gx={};Object.defineProperty(Gx,"__esModule",{value:!0});Gx.Circle=void 0;const Jse=gt,Zse=tn,eoe=Ze,toe=pt;class mf extends Zse.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}Gx.Circle=mf;mf.prototype._centroid=!0;mf.prototype.className="Circle";mf.prototype._attrsAffectingSize=["radius"];(0,toe._registerNode)(mf);Jse.Factory.addGetterSetter(mf,"radius",0,(0,eoe.getNumberValidator)());var Hx={};Object.defineProperty(Hx,"__esModule",{value:!0});Hx.Ellipse=void 0;const h4=gt,roe=tn,RI=Ze,noe=pt;class zl extends roe.Shape{_sceneFunc(e){const r=this.radiusX(),n=this.radiusY();e.beginPath(),e.save(),r!==n&&e.scale(1,n/r),e.arc(0,0,r,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}Hx.Ellipse=zl;zl.prototype.className="Ellipse";zl.prototype._centroid=!0;zl.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,noe._registerNode)(zl);h4.Factory.addComponentsGetterSetter(zl,"radius",["x","y"]);h4.Factory.addGetterSetter(zl,"radiusX",0,(0,RI.getNumberValidator)());h4.Factory.addGetterSetter(zl,"radiusY",0,(0,RI.getNumberValidator)());var Wx={};Object.defineProperty(Wx,"__esModule",{value:!0});Wx.Image=void 0;const PS=xr,oc=gt,ioe=tn,aoe=pt,xm=Ze;let vs=class DI extends ioe.Shape{constructor(e){super(e),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){const e=!!this.cornerRadius(),r=this.hasShadow();return e&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const r=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;let s;if(a){const o=this.attrs.cropWidth,l=this.attrs.cropHeight;o&&l?s=[a,this.cropX(),this.cropY(),o,l,0,0,r,n]:s=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?PS.Util.drawRoundedRectPath(e,r,n,i):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)),a&&(i&&e.clip(),e.drawImage.apply(e,s))}_hitFunc(e){const r=this.width(),n=this.height(),i=this.cornerRadius();e.beginPath(),i?PS.Util.drawRoundedRectPath(e,r,n,i):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,r;return(e=this.attrs.width)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var e,r;return(e=this.attrs.height)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(e,r,n=null){const i=PS.Util.createImageElement();i.onload=function(){const a=new DI({image:i});r(a)},i.onerror=n,i.crossOrigin="Anonymous",i.src=e}};Wx.Image=vs;vs.prototype.className="Image";(0,aoe._registerNode)(vs);oc.Factory.addGetterSetter(vs,"cornerRadius",0,(0,xm.getNumberOrArrayOfNumbersValidator)(4));oc.Factory.addGetterSetter(vs,"image");oc.Factory.addComponentsGetterSetter(vs,"crop",["x","y","width","height"]);oc.Factory.addGetterSetter(vs,"cropX",0,(0,xm.getNumberValidator)());oc.Factory.addGetterSetter(vs,"cropY",0,(0,xm.getNumberValidator)());oc.Factory.addGetterSetter(vs,"cropWidth",0,(0,xm.getNumberValidator)());oc.Factory.addGetterSetter(vs,"cropHeight",0,(0,xm.getNumberValidator)());var Kd={};Object.defineProperty(Kd,"__esModule",{value:!0});Kd.Tag=Kd.Label=void 0;const qx=gt,soe=tn,ooe=ff,p4=Ze,OI=pt,II=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],loe="Change.konva",uoe="none",$k="up",Uk="right",Gk="down",Hk="left",coe=II.length;class m4 extends ooe.Group{constructor(e){super(e),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let r=this,n;const i=function(){r._sync()};for(n=0;n<coe;n++)e.on(II[n]+loe,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),r=this.getTag(),n,i,a,s,o,l,u;if(e&&r){switch(n=e.width(),i=e.height(),a=r.pointerDirection(),s=r.pointerWidth(),u=r.pointerHeight(),o=0,l=0,a){case $k:o=n/2,l=-1*u;break;case Uk:o=n+s,l=i/2;break;case Gk:o=n/2,l=i+u;break;case Hk:o=-1*s,l=i/2;break}r.setAttrs({x:-1*o,y:-1*l,width:n,height:i}),e.setAttrs({x:-1*o,y:-1*l})}}}Kd.Label=m4;m4.prototype.className="Label";(0,OI._registerNode)(m4);class lc extends soe.Shape{_sceneFunc(e){const r=this.width(),n=this.height(),i=this.pointerDirection(),a=this.pointerWidth(),s=this.pointerHeight(),o=this.cornerRadius();let l=0,u=0,c=0,d=0;typeof o=="number"?l=u=c=d=Math.min(o,r/2,n/2):(l=Math.min(o[0]||0,r/2,n/2),u=Math.min(o[1]||0,r/2,n/2),d=Math.min(o[2]||0,r/2,n/2),c=Math.min(o[3]||0,r/2,n/2)),e.beginPath(),e.moveTo(l,0),i===$k&&(e.lineTo((r-a)/2,0),e.lineTo(r/2,-1*s),e.lineTo((r+a)/2,0)),e.lineTo(r-u,0),e.arc(r-u,u,u,Math.PI*3/2,0,!1),i===Uk&&(e.lineTo(r,(n-s)/2),e.lineTo(r+a,n/2),e.lineTo(r,(n+s)/2)),e.lineTo(r,n-d),e.arc(r-d,n-d,d,0,Math.PI/2,!1),i===Gk&&(e.lineTo((r+a)/2,n),e.lineTo(r/2,n+s),e.lineTo((r-a)/2,n)),e.lineTo(c,n),e.arc(c,n-c,c,Math.PI/2,Math.PI,!1),i===Hk&&(e.lineTo(0,(n+s)/2),e.lineTo(-1*a,n/2),e.lineTo(0,(n-s)/2)),e.lineTo(0,l),e.arc(l,l,l,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,r=0,n=this.pointerWidth(),i=this.pointerHeight(),a=this.pointerDirection(),s=this.width(),o=this.height();return a===$k?(r-=i,o+=i):a===Gk?o+=i:a===Hk?(e-=n*1.5,s+=n):a===Uk&&(s+=n*1.5),{x:e,y:r,width:s,height:o}}}Kd.Tag=lc;lc.prototype.className="Tag";(0,OI._registerNode)(lc);qx.Factory.addGetterSetter(lc,"pointerDirection",uoe);qx.Factory.addGetterSetter(lc,"pointerWidth",0,(0,p4.getNumberValidator)());qx.Factory.addGetterSetter(lc,"pointerHeight",0,(0,p4.getNumberValidator)());qx.Factory.addGetterSetter(lc,"cornerRadius",0,(0,p4.getNumberOrArrayOfNumbersValidator)(4));var bm={};Object.defineProperty(bm,"__esModule",{value:!0});bm.Rect=void 0;const doe=gt,foe=tn,hoe=pt,poe=xr,moe=Ze;let Kx=class extends foe.Shape{_sceneFunc(e){const r=this.cornerRadius(),n=this.width(),i=this.height();e.beginPath(),r?poe.Util.drawRoundedRectPath(e,n,i,r):e.rect(0,0,n,i),e.closePath(),e.fillStrokeShape(this)}};bm.Rect=Kx;Kx.prototype.className="Rect";(0,hoe._registerNode)(Kx);doe.Factory.addGetterSetter(Kx,"cornerRadius",0,(0,moe.getNumberOrArrayOfNumbersValidator)(4));var Yx={};Object.defineProperty(Yx,"__esModule",{value:!0});Yx.RegularPolygon=void 0;const LI=gt,goe=tn,BI=Ze,voe=pt;class uc extends goe.Shape{_sceneFunc(e){const r=this._getPoints();e.beginPath(),e.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)e.lineTo(r[n].x,r[n].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let i=0;i<e;i++)n.push({x:r*Math.sin(i*2*Math.PI/e),y:-1*r*Math.cos(i*2*Math.PI/e)});return n}getSelfRect(){const e=this._getPoints();let r=e[0].x,n=e[0].y,i=e[0].x,a=e[0].y;return e.forEach(s=>{r=Math.min(r,s.x),n=Math.max(n,s.x),i=Math.min(i,s.y),a=Math.max(a,s.y)}),{x:r,y:i,width:n-r,height:a-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Yx.RegularPolygon=uc;uc.prototype.className="RegularPolygon";uc.prototype._centroid=!0;uc.prototype._attrsAffectingSize=["radius"];(0,voe._registerNode)(uc);LI.Factory.addGetterSetter(uc,"radius",0,(0,BI.getNumberValidator)());LI.Factory.addGetterSetter(uc,"sides",0,(0,BI.getNumberValidator)());var Xx={};Object.defineProperty(Xx,"__esModule",{value:!0});Xx.Ring=void 0;const FI=gt,yoe=tn,zI=Ze,xoe=pt,vM=Math.PI*2;class cc extends yoe.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,vM,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),vM,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Xx.Ring=cc;cc.prototype.className="Ring";cc.prototype._centroid=!0;cc.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,xoe._registerNode)(cc);FI.Factory.addGetterSetter(cc,"innerRadius",0,(0,zI.getNumberValidator)());FI.Factory.addGetterSetter(cc,"outerRadius",0,(0,zI.getNumberValidator)());var Qx={};Object.defineProperty(Qx,"__esModule",{value:!0});Qx.Sprite=void 0;const dc=gt,boe=tn,woe=hf,VI=Ze,Soe=pt;class ys extends boe.Shape{constructor(e){super(e),this._updated=!0,this.anim=new woe.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+0],l=a[i+1],u=a[i+2],c=a[i+3],d=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,u,c),e.closePath(),e.fillStrokeShape(this)),d)if(s){const h=s[r],m=n*2;e.drawImage(d,o,l,u,c,h[m+0],h[m+1],u,c)}else e.drawImage(d,o,l,u,c,0,0,u,c)}_hitFunc(e){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+2],l=a[i+3];if(e.beginPath(),s){const u=s[r],c=n*2;e.rect(u[c+0],u[c+1],o,l)}else e.rect(0,0,o,l);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),r=this.animation(),n=this.animations(),i=n[r],a=i.length/4;e<a-1?this.frameIndex(e+1):this.frameIndex(0)}}Qx.Sprite=ys;ys.prototype.className="Sprite";(0,Soe._registerNode)(ys);dc.Factory.addGetterSetter(ys,"animation");dc.Factory.addGetterSetter(ys,"animations");dc.Factory.addGetterSetter(ys,"frameOffsets");dc.Factory.addGetterSetter(ys,"image");dc.Factory.addGetterSetter(ys,"frameIndex",0,(0,VI.getNumberValidator)());dc.Factory.addGetterSetter(ys,"frameRate",17,(0,VI.getNumberValidator)());dc.Factory.backCompat(ys,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Jx={};Object.defineProperty(Jx,"__esModule",{value:!0});Jx.Star=void 0;const g4=gt,koe=tn,v4=Ze,Coe=pt;class Vl extends koe.Shape{_sceneFunc(e){const r=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-n);for(let a=1;a<i*2;a++){const s=a%2===0?n:r,o=s*Math.sin(a*Math.PI/i),l=-1*s*Math.cos(a*Math.PI/i);e.lineTo(o,l)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Jx.Star=Vl;Vl.prototype.className="Star";Vl.prototype._centroid=!0;Vl.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Coe._registerNode)(Vl);g4.Factory.addGetterSetter(Vl,"numPoints",5,(0,v4.getNumberValidator)());g4.Factory.addGetterSetter(Vl,"innerRadius",0,(0,v4.getNumberValidator)());g4.Factory.addGetterSetter(Vl,"outerRadius",0,(0,v4.getNumberValidator)());var gf={};Object.defineProperty(gf,"__esModule",{value:!0});gf.Text=void 0;gf.stringToArray=$I;const Wk=xr,Kn=gt,Noe=tn,_S=pt,$l=Ze,Eoe=pt;function $I(t){return[...t].reduce((e,r,n,i)=>(/\p{Emoji_Modifier_Base}\p{Emoji_Modifier}?(?:\u200D\p{Emoji_Presentation})+/u.test(r)?e.push(r):/\p{Regional_Indicator}{2}/u.test(r+(i[n+1]||""))?e.push(r+i[n+1]):n>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(r)?e[e.length-1]+=r:e.push(r),e),[])}const Vc="auto",Toe="center",UI="inherit",dh="justify",joe="Change.konva",Moe="2d",yM="-",GI="left",Poe="text",_oe="Text",Aoe="top",Roe="bottom",xM="middle",HI="normal",Doe="px ",dv=" ",Ooe="right",bM="rtl",Ioe="word",Loe="char",wM="none",AS="",WI=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],Boe=WI.length;function Foe(t){return t.split(",").map(e=>{e=e.trim();const r=e.indexOf(" ")>=0,n=e.indexOf('"')>=0||e.indexOf("'")>=0;return r&&!n&&(e=`"${e}"`),e}).join(", ")}let fv;function RS(){return fv||(fv=Wk.Util.createCanvasElement().getContext(Moe),fv)}function zoe(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function Voe(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function $oe(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}let Mr=class extends Noe.Shape{constructor(e){super($oe(e)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<Boe;r++)this.on(WI[r]+joe,this._setTextData);this._setTextData()}_sceneFunc(e){const r=this.textArr,n=r.length;if(!this.text())return;let i=this.padding(),a=this.fontSize(),s=this.lineHeight()*a,o=this.verticalAlign(),l=this.direction(),u=0,c=this.align(),d=this.getWidth(),h=this.letterSpacing(),m=this.fill(),v=this.textDecoration(),x=v.indexOf("underline")!==-1,y=v.indexOf("line-through")!==-1,b;l=l===UI?e.direction:l;let S=s/2,w=xM;if(_S.Konva._fixTextRendering){const I=this.measureSize("M");w="alphabetic",S=(I.fontBoundingBoxAscent-I.fontBoundingBoxDescent)/2+s/2}var k=0,N=0;for(l===bM&&e.setAttr("direction",l),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",w),e.setAttr("textAlign",GI),o===xM?u=(this.getHeight()-n*s-i*2)/2:o===Roe&&(u=this.getHeight()-n*s-i*2),e.translate(i,u+i),b=0;b<n;b++){var k=0,N=0,T=r[b],j=T.text,M=T.width,A=T.lastInParagraph,P,D,R;if(e.save(),c===Ooe?k+=d-M-i*2:c===Toe&&(k+=(d-M-i*2)/2),x){e.save(),e.beginPath();const B=_S.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),z=k,F=S+N+B;e.moveTo(z,F),P=j.split(" ").length-1,D=P===0,R=c===dh&&!A?d-i*2:M,e.lineTo(z+Math.round(R),F),e.lineWidth=a/15;const V=this._getLinearGradient();e.strokeStyle=V||m,e.stroke(),e.restore()}if(y){e.save(),e.beginPath();const B=_S.Konva._fixTextRendering?-Math.round(a/4):0;e.moveTo(k,S+N+B),P=j.split(" ").length-1,D=P===0,R=c===dh&&A&&!D?d-i*2:M,e.lineTo(k+Math.round(R),S+N+B),e.lineWidth=a/15;const z=this._getLinearGradient();e.strokeStyle=z||m,e.stroke(),e.restore()}if(l!==bM&&(h!==0||c===dh)){P=j.split(" ").length-1;const B=$I(j);for(let z=0;z<B.length;z++){const F=B[z];F===" "&&!A&&c===dh&&(k+=(d-i*2-M)/P),this._partialTextX=k,this._partialTextY=S+N,this._partialText=F,e.fillStrokeShape(this),k+=this.measureSize(F).width+h}}else h!==0&&e.setAttr("letterSpacing",`${h}px`),this._partialTextX=k,this._partialTextY=S+N,this._partialText=j,e.fillStrokeShape(this);e.restore(),n>1&&(S+=s)}}_hitFunc(e){const r=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}setText(e){const r=Wk.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(Poe,r),this}getWidth(){return this.attrs.width===Vc||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Vc||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return Wk.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var r,n,i,a,s,o,l,u,c,d,h;let m=RS(),v=this.fontSize(),x;m.save(),m.font=this._getContextFont(),x=m.measureText(e),m.restore();const y=v/100;return{actualBoundingBoxAscent:(r=x.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*y,actualBoundingBoxDescent:(n=x.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(i=x.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*y,actualBoundingBoxRight:(a=x.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*y,alphabeticBaseline:(s=x.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(o=x.emHeightAscent)!==null&&o!==void 0?o:100*y,emHeightDescent:(l=x.emHeightDescent)!==null&&l!==void 0?l:-20*y,fontBoundingBoxAscent:(u=x.fontBoundingBoxAscent)!==null&&u!==void 0?u:91*y,fontBoundingBoxDescent:(c=x.fontBoundingBoxDescent)!==null&&c!==void 0?c:21*y,hangingBaseline:(d=x.hangingBaseline)!==null&&d!==void 0?d:72.80000305175781*y,ideographicBaseline:(h=x.ideographicBaseline)!==null&&h!==void 0?h:-21*y,width:x.width,height:v}}_getContextFont(){return this.fontStyle()+dv+this.fontVariant()+dv+(this.fontSize()+Doe)+Foe(this.fontFamily())}_addTextLine(e){this.align()===dh&&(e=e.trim());const n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){const r=this.letterSpacing(),n=e.length;return RS().measureText(e).width+(n?r*(n-1):0)}_setTextData(){let e=this.text().split(`
`),r=+this.fontSize(),n=0,i=this.lineHeight()*r,a=this.attrs.width,s=this.attrs.height,o=a!==Vc&&a!==void 0,l=s!==Vc&&s!==void 0,u=this.padding(),c=a-u*2,d=s-u*2,h=0,m=this.wrap(),v=m!==wM,x=m!==Loe&&v,y=this.ellipsis();this.textArr=[],RS().font=this._getContextFont();const b=y?this._getTextWidth(AS):0;for(let w=0,k=e.length;w<k;++w){let N=e[w],T=this._getTextWidth(N);if(o&&T>c)for(;N.length>0;){let j=0,M=N.length,A="",P=0;for(;j<M;){const D=j+M>>>1,R=N.slice(0,D+1),I=this._getTextWidth(R)+b;I<=c?(j=D+1,A=R,P=I):M=D}if(A){if(x){var S;const R=N[A.length];(R===dv||R===yM)&&P<=c?S=A.length:S=Math.max(A.lastIndexOf(dv),A.lastIndexOf(yM))+1,S>0&&(j=S,A=A.slice(0,j),P=this._getTextWidth(A))}if(A=A.trimRight(),this._addTextLine(A),n=Math.max(n,P),h+=i,this._shouldHandleEllipsis(h)){this._tryToAddEllipsisToLastLine();break}if(N=N.slice(j),N=N.trimLeft(),N.length>0&&(T=this._getTextWidth(N),T<=c)){this._addTextLine(N),h+=i,n=Math.max(n,T);break}}else break}else this._addTextLine(N),h+=i,n=Math.max(n,T),this._shouldHandleEllipsis(h)&&w<k-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&h+i>d)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(e){const r=+this.fontSize(),n=this.lineHeight()*r,i=this.attrs.height,a=i!==Vc&&i!==void 0,s=this.padding(),o=i-s*2;return!(this.wrap()!==wM)||a&&e+n>o}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,r=e!==Vc&&e!==void 0,n=this.padding(),i=e-n*2,a=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!a||(r&&(this._getTextWidth(s.text+AS)<i||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+AS))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return e&&r?!0:super._useBufferCanvas()}};gf.Text=Mr;Mr.prototype._fillFunc=zoe;Mr.prototype._strokeFunc=Voe;Mr.prototype.className=_oe;Mr.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,Eoe._registerNode)(Mr);Kn.Factory.overWriteSetter(Mr,"width",(0,$l.getNumberOrAutoValidator)());Kn.Factory.overWriteSetter(Mr,"height",(0,$l.getNumberOrAutoValidator)());Kn.Factory.addGetterSetter(Mr,"direction",UI);Kn.Factory.addGetterSetter(Mr,"fontFamily","Arial");Kn.Factory.addGetterSetter(Mr,"fontSize",12,(0,$l.getNumberValidator)());Kn.Factory.addGetterSetter(Mr,"fontStyle",HI);Kn.Factory.addGetterSetter(Mr,"fontVariant",HI);Kn.Factory.addGetterSetter(Mr,"padding",0,(0,$l.getNumberValidator)());Kn.Factory.addGetterSetter(Mr,"align",GI);Kn.Factory.addGetterSetter(Mr,"verticalAlign",Aoe);Kn.Factory.addGetterSetter(Mr,"lineHeight",1,(0,$l.getNumberValidator)());Kn.Factory.addGetterSetter(Mr,"wrap",Ioe);Kn.Factory.addGetterSetter(Mr,"ellipsis",!1,(0,$l.getBooleanValidator)());Kn.Factory.addGetterSetter(Mr,"letterSpacing",0,(0,$l.getNumberValidator)());Kn.Factory.addGetterSetter(Mr,"text","",(0,$l.getStringValidator)());Kn.Factory.addGetterSetter(Mr,"textDecoration","");var Zx={};Object.defineProperty(Zx,"__esModule",{value:!0});Zx.TextPath=void 0;const DS=xr,Ba=gt,Uoe=tn,fh=pf,OS=gf,qI=Ze,Goe=pt,Hoe="",KI="normal";function YI(t){t.fillText(this.partialText,0,0)}function XI(t){t.strokeText(this.partialText,0,0)}class rn extends Uoe.Shape{constructor(e){super(e),this.dummyCanvas=DS.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return fh.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const r=this.pathLength;return e-1>r?null:fh.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=fh.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const r=this.textDecoration(),n=this.fill(),i=this.fontSize(),a=this.glyphInfo;r==="underline"&&e.beginPath();for(let s=0;s<a.length;s++){e.save();const o=a[s].p0;e.translate(o.x,o.y),e.rotate(a[s].rotation),this.partialText=a[s].text,e.fillStrokeShape(this),r==="underline"&&(s===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}r==="underline"&&(e.strokeStyle=n,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;e.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const i=r[n].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return DS.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return OS.Text.prototype.setText.call(this,e)}_getContextFont(){return OS.Text.prototype._getContextFont.call(this)}_getTextSize(e){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const i=n.measureText(e);return n.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),i=this.align(),a=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let o=0;i==="center"&&(o=Math.max(0,this.pathLength/2-s/2)),i==="right"&&(o=Math.max(0,this.pathLength-s));const l=(0,OS.stringToArray)(this.text());let u=o;for(let c=0;c<l.length;c++){const d=this._getPointAtLength(u);if(!d)return;let h=this._getTextSize(l[c]).width+n;if(l[c]===" "&&i==="justify"){const S=this.text().split(" ").length-1;h+=(this.pathLength-s)/S}const m=this._getPointAtLength(u+h);if(!m)return;const v=fh.Path.getLineLength(d.x,d.y,m.x,m.y);let x=0;if(a)try{x=a(l[c-1],l[c])*this.fontSize()}catch{x=0}d.x+=x,m.x+=x,this.textWidth+=x;const y=fh.Path.getPointOnLine(x+v/2,d.x,d.y,m.x,m.y),b=Math.atan2(m.y-d.y,m.x-d.x);this.glyphInfo.push({transposeX:y.x,transposeY:y.y,text:l[c],rotation:b,p0:d,p1:m}),u+=h}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(u){e.push(u.p0.x),e.push(u.p0.y),e.push(u.p1.x),e.push(u.p1.y)});let r=e[0]||0,n=e[0]||0,i=e[1]||0,a=e[1]||0,s,o;for(let u=0;u<e.length/2;u++)s=e[u*2],o=e[u*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);const l=this.fontSize();return{x:r-l/2,y:i-l/2,width:n-r+l,height:a-i+l}}destroy(){return DS.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Zx.TextPath=rn;rn.prototype._fillFunc=YI;rn.prototype._strokeFunc=XI;rn.prototype._fillFuncHit=YI;rn.prototype._strokeFuncHit=XI;rn.prototype.className="TextPath";rn.prototype._attrsAffectingSize=["text","fontSize","data"];(0,Goe._registerNode)(rn);Ba.Factory.addGetterSetter(rn,"data");Ba.Factory.addGetterSetter(rn,"fontFamily","Arial");Ba.Factory.addGetterSetter(rn,"fontSize",12,(0,qI.getNumberValidator)());Ba.Factory.addGetterSetter(rn,"fontStyle",KI);Ba.Factory.addGetterSetter(rn,"align","left");Ba.Factory.addGetterSetter(rn,"letterSpacing",0,(0,qI.getNumberValidator)());Ba.Factory.addGetterSetter(rn,"textBaseline","middle");Ba.Factory.addGetterSetter(rn,"fontVariant",KI);Ba.Factory.addGetterSetter(rn,"text",Hoe);Ba.Factory.addGetterSetter(rn,"textDecoration",null);Ba.Factory.addGetterSetter(rn,"kerningFunc",null);var e1={};Object.defineProperty(e1,"__esModule",{value:!0});e1.Transformer=void 0;const Vt=xr,Dt=gt,SM=dr,Woe=tn,qoe=bm,kM=ff,ka=pt,Ul=Ze,Koe=pt,QI="tr-konva",Yoe=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${QI}`).join(" "),CM="nodesRect",Xoe=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],Qoe={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},Joe="ontouchstart"in ka.Konva._global;function Zoe(t,e,r){if(t==="rotater")return r;e+=Vt.Util.degToRad(Qoe[t]||0);const n=(Vt.Util.radToDeg(e)%360+360)%360;return Vt.Util._inRange(n,315+22.5,360)||Vt.Util._inRange(n,0,22.5)?"ns-resize":Vt.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":Vt.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":Vt.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":Vt.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":Vt.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":Vt.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":Vt.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(Vt.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const jy=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],NM=1e8;function ele(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function JI(t,e,r){const n=r.x+(t.x-r.x)*Math.cos(e)-(t.y-r.y)*Math.sin(e),i=r.y+(t.x-r.x)*Math.sin(e)+(t.y-r.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:n,y:i}}function tle(t,e){const r=ele(t);return JI(t,e,r)}function rle(t,e,r){let n=e;for(let i=0;i<t.length;i++){const a=ka.Konva.getAngle(t[i]),s=Math.abs(a-e)%(Math.PI*2);Math.min(s,Math.PI*2-s)<r&&(n=a)}return n}let qk=0,Ct=class extends kM.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Yoe,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return Vt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return QI+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const r=e.filter(i=>i.isAncestorOf(this)?(Vt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=r,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},s=i._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");i.on(s,a),i.on(Xoe.map(o=>o+`.${this._getEventNamespace()}`).join(" "),a),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let r;e.on(`dragstart.${this._getEventNamespace()}`,n=>{r=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(n,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const i=e.getAbsolutePosition(),a=i.x-r.x,s=i.y-r.y;this.nodes().forEach(o=>{if(o===e||o.isDragging())return;const l=o.getAbsolutePosition();o.setAbsolutePosition({x:l.x+a,y:l.y+s}),o.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(CM),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(CM,this.__getNodeRect)}__getNodeShape(e,r=this.rotation(),n){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=e.getAbsoluteScale(n),s=e.getAbsolutePosition(n),o=i.x*a.x-e.offsetX()*a.x,l=i.y*a.y-e.offsetY()*a.y,u=(ka.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),c={x:s.x+o*Math.cos(u)+l*Math.sin(-u),y:s.y+l*Math.cos(u)+o*Math.sin(u),width:i.width*a.x,height:i.height*a.y,rotation:u};return JI(c,-ka.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-NM,y:-NM,width:0,height:0,rotation:0};const r=[];this.nodes().map(u=>{const c=u.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),d=[{x:c.x,y:c.y},{x:c.x+c.width,y:c.y},{x:c.x+c.width,y:c.y+c.height},{x:c.x,y:c.y+c.height}],h=u.getAbsoluteTransform();d.forEach(function(m){const v=h.point(m);r.push(v)})});const n=new Vt.Transform;n.rotate(-ka.Konva.getAngle(this.rotation()));let i=1/0,a=1/0,s=-1/0,o=-1/0;r.forEach(function(u){const c=n.point(u);i===void 0&&(i=s=c.x,a=o=c.y),i=Math.min(i,c.x),a=Math.min(a,c.y),s=Math.max(s,c.x),o=Math.max(o,c.y)}),n.invert();const l=n.point({x:i,y:a});return{x:l.x,y:l.y,width:s-i,height:o-a,rotation:ka.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),jy.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const r=new qoe.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Joe?10:"auto"}),n=this;r.on("mousedown touchstart",function(i){n._handleMouseDown(i)}),r.on("dragstart",i=>{r.stopDrag(),i.cancelBubble=!0}),r.on("dragend",i=>{i.cancelBubble=!0}),r.on("mouseenter",()=>{const i=ka.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),s=Zoe(e,i,a);r.getStage().content&&(r.getStage().content.style.cursor=s),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const e=new Woe.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const i=n.getParent(),a=i.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),i.rotateEnabled()&&i.rotateLineVisible()&&r.lineTo(n.width()/2,-i.rotateAnchorOffset()*Vt.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();r.beginPath(),r.rect(-i,-i,n.width()+i*2,n.height()+i*2),r.fillStrokeShape(n)}});this.add(e),this._proxyDrag(e),e.on("dragstart",r=>{r.cancelBubble=!0}),e.on("dragmove",r=>{r.cancelBubble=!0}),e.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,i=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.sin=Math.abs(i/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const s=e.target.getAbsolutePosition(),o=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-s.x,y:o.y-s.y},qk++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:e.evt,target:l})})}_handleMouseMove(e){let r,n,i;const a=this.findOne("."+this._movingAnchorName),s=a.getStage();s.setPointersPositions(e);const o=s.getPointerPosition();let l={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const u=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(u,l,e)),a.setAbsolutePosition(l);const c=a.getAbsolutePosition();if(u.x===c.x&&u.y===c.y)return;if(this._movingAnchorName==="rotater"){const N=this._getNodeRect();r=a.x()-N.width/2,n=-a.y()+N.height/2;let T=Math.atan2(-n,r)+Math.PI/2;N.height<0&&(T-=Math.PI);const M=ka.Konva.getAngle(this.rotation())+T,A=ka.Konva.getAngle(this.rotationSnapTolerance()),D=rle(this.rotationSnaps(),M,A)-N.rotation,R=tle(N,D);this._fitNodesInto(R,e);return}const d=this.shiftBehavior();let h;d==="inverted"?h=this.keepRatio()&&!e.shiftKey:d==="none"?h=this.keepRatio():h=this.keepRatio()||e.shiftKey;var b=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(h){var m=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(m.x-a.x(),2)+Math.pow(m.y-a.y(),2));var v=this.findOne(".top-left").x()>m.x?-1:1,x=this.findOne(".top-left").y()>m.y?-1:1;r=i*this.cos*v,n=i*this.sin*x,this.findOne(".top-left").x(m.x-r),this.findOne(".top-left").y(m.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(h){var m=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(a.x()-m.x,2)+Math.pow(m.y-a.y(),2));var v=this.findOne(".top-right").x()<m.x?-1:1,x=this.findOne(".top-right").y()>m.y?-1:1;r=i*this.cos*v,n=i*this.sin*x,this.findOne(".top-right").x(m.x+r),this.findOne(".top-right").y(m.y-n)}var y=a.position();this.findOne(".top-left").y(y.y),this.findOne(".bottom-right").x(y.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(h){var m=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(m.x-a.x(),2)+Math.pow(a.y()-m.y,2));var v=m.x<a.x()?-1:1,x=a.y()<m.y?-1:1;r=i*this.cos*v,n=i*this.sin*x,a.x(m.x-r),a.y(m.y+n)}y=a.position(),this.findOne(".top-left").x(y.x),this.findOne(".bottom-right").y(y.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(h){var m=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(a.x()-m.x,2)+Math.pow(a.y()-m.y,2));var v=this.findOne(".bottom-right").x()<m.x?-1:1,x=this.findOne(".bottom-right").y()<m.y?-1:1;r=i*this.cos*v,n=i*this.sin*x,this.findOne(".bottom-right").x(m.x+r),this.findOne(".bottom-right").y(m.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var b=this.centeredScaling()||e.altKey;if(b){const N=this.findOne(".top-left"),T=this.findOne(".bottom-right"),j=N.x(),M=N.y(),A=this.getWidth()-T.x(),P=this.getHeight()-T.y();T.move({x:-j,y:-M}),N.move({x:A,y:P})}const S=this.findOne(".top-left").getAbsolutePosition();r=S.x,n=S.y;const w=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),k=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:w,height:k,rotation:ka.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();qk--,this._fire("transformend",{evt:e,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(i=>{var a;i._fire("transformend",{evt:e,target:i}),(a=i.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,r){const n=this._getNodeRect(),i=1;if(Vt.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(Vt.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const a=new Vt.Transform;if(a.rotate(ka.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const h=a.point({x:-this.padding()*2,y:0});e.x+=h.x,e.y+=h.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const h=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const h=a.point({x:0,y:-this.padding()*2});e.x+=h.x,e.y+=h.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const h=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const h=this.boundBoxFunc()(n,e);h?e=h:Vt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const s=1e7,o=new Vt.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/s,n.height/s);const l=new Vt.Transform,u=e.width/s,c=e.height/s;this.flipEnabled()===!1?(l.translate(e.x,e.y),l.rotate(e.rotation),l.translate(e.width<0?e.width:0,e.height<0?e.height:0),l.scale(Math.abs(u),Math.abs(c))):(l.translate(e.x,e.y),l.rotate(e.rotation),l.scale(u,c));const d=l.multiply(o.invert());this._nodes.forEach(h=>{var m;const v=h.getParent().getAbsoluteTransform(),x=h.getTransform().copy();x.translate(h.offsetX(),h.offsetY());const y=new Vt.Transform;y.multiply(v.copy().invert()).multiply(d).multiply(v).multiply(x);const b=y.decompose();h.setAttrs(b),(m=h.getLayer())===null||m===void 0||m.batchDraw()}),this.rotation(Vt.Util._getRotation(e.rotation)),this._nodes.forEach(h=>{this._fire("transform",{evt:r,target:h}),h._fire("transform",{evt:r,target:h})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,r){this.findOne(e).setAttrs(r)}update(){var e;const r=this._getNodeRect();this.rotation(Vt.Util._getRotation(r.rotation));const n=r.width,i=r.height,a=this.enabledAnchors(),s=this.resizeEnabled(),o=this.padding(),l=this.anchorSize(),u=this.find("._anchor");u.forEach(d=>{d.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+o,offsetY:l/2+o,visible:s&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+o,visible:s&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-o,offsetY:l/2+o,visible:s&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:l/2+o,visible:s&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:i/2,offsetX:l/2-o,visible:s&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:l/2+o,offsetY:l/2-o,visible:s&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:i,offsetY:l/2-o,visible:s&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:i,offsetX:l/2-o,offsetY:l/2-o,visible:s&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*Vt.Util._sign(i)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const c=this.anchorStyleFunc();c&&u.forEach(d=>{c(d)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),kM.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return SM.Node.prototype.toObject.call(this)}clone(e){return SM.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};e1.Transformer=Ct;Ct.isTransforming=()=>qk>0;function nle(t){return t instanceof Array||Vt.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){jy.indexOf(e)===-1&&Vt.Util.warn("Unknown anchor name: "+e+". Available names are: "+jy.join(", "))}),t||[]}Ct.prototype.className="Transformer";(0,Koe._registerNode)(Ct);Dt.Factory.addGetterSetter(Ct,"enabledAnchors",jy,nle);Dt.Factory.addGetterSetter(Ct,"flipEnabled",!0,(0,Ul.getBooleanValidator)());Dt.Factory.addGetterSetter(Ct,"resizeEnabled",!0);Dt.Factory.addGetterSetter(Ct,"anchorSize",10,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Ct,"rotateEnabled",!0);Dt.Factory.addGetterSetter(Ct,"rotateLineVisible",!0);Dt.Factory.addGetterSetter(Ct,"rotationSnaps",[]);Dt.Factory.addGetterSetter(Ct,"rotateAnchorOffset",50,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Ct,"rotateAnchorCursor","crosshair");Dt.Factory.addGetterSetter(Ct,"rotationSnapTolerance",5,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Ct,"borderEnabled",!0);Dt.Factory.addGetterSetter(Ct,"anchorStroke","rgb(0, 161, 255)");Dt.Factory.addGetterSetter(Ct,"anchorStrokeWidth",1,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Ct,"anchorFill","white");Dt.Factory.addGetterSetter(Ct,"anchorCornerRadius",0,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Ct,"borderStroke","rgb(0, 161, 255)");Dt.Factory.addGetterSetter(Ct,"borderStrokeWidth",1,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Ct,"borderDash");Dt.Factory.addGetterSetter(Ct,"keepRatio",!0);Dt.Factory.addGetterSetter(Ct,"shiftBehavior","default");Dt.Factory.addGetterSetter(Ct,"centeredScaling",!1);Dt.Factory.addGetterSetter(Ct,"ignoreStroke",!1);Dt.Factory.addGetterSetter(Ct,"padding",0,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Ct,"node");Dt.Factory.addGetterSetter(Ct,"nodes");Dt.Factory.addGetterSetter(Ct,"boundBoxFunc");Dt.Factory.addGetterSetter(Ct,"anchorDragBoundFunc");Dt.Factory.addGetterSetter(Ct,"anchorStyleFunc");Dt.Factory.addGetterSetter(Ct,"shouldOverdrawWholeArea",!1);Dt.Factory.addGetterSetter(Ct,"useSingleNodeRotation",!0);Dt.Factory.backCompat(Ct,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var t1={};Object.defineProperty(t1,"__esModule",{value:!0});t1.Wedge=void 0;const r1=gt,ile=tn,ale=pt,ZI=Ze,sle=pt;class fo extends ile.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,ale.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}t1.Wedge=fo;fo.prototype.className="Wedge";fo.prototype._centroid=!0;fo.prototype._attrsAffectingSize=["radius"];(0,sle._registerNode)(fo);r1.Factory.addGetterSetter(fo,"radius",0,(0,ZI.getNumberValidator)());r1.Factory.addGetterSetter(fo,"angle",0,(0,ZI.getNumberValidator)());r1.Factory.addGetterSetter(fo,"clockwise",!1);r1.Factory.backCompat(fo,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var n1={};Object.defineProperty(n1,"__esModule",{value:!0});n1.Blur=void 0;const EM=gt,ole=dr,lle=Ze;function TM(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const ule=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],cle=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function dle(t,e){const r=t.data,n=t.width,i=t.height;let a,s,o,l,u,c,d,h,m,v,x,y,b,S,w,k,N,T,j,M,A,P,D,R,I=e+e+1,U=n-1,B=i-1,z=e+1,F=z*(z+1)/2,V=new TM,J=null,Y=V,L=null,G=null,ee=ule[e],re=cle[e];for(o=1;o<I;o++)Y=Y.next=new TM,o===z&&(J=Y);for(Y.next=V,d=c=0,s=0;s<i;s++){for(k=N=T=j=h=m=v=x=0,y=z*(M=r[c]),b=z*(A=r[c+1]),S=z*(P=r[c+2]),w=z*(D=r[c+3]),h+=F*M,m+=F*A,v+=F*P,x+=F*D,Y=V,o=0;o<z;o++)Y.r=M,Y.g=A,Y.b=P,Y.a=D,Y=Y.next;for(o=1;o<z;o++)l=c+((U<o?U:o)<<2),h+=(Y.r=M=r[l])*(R=z-o),m+=(Y.g=A=r[l+1])*R,v+=(Y.b=P=r[l+2])*R,x+=(Y.a=D=r[l+3])*R,k+=M,N+=A,T+=P,j+=D,Y=Y.next;for(L=V,G=J,a=0;a<n;a++)r[c+3]=D=x*ee>>re,D!==0?(D=255/D,r[c]=(h*ee>>re)*D,r[c+1]=(m*ee>>re)*D,r[c+2]=(v*ee>>re)*D):r[c]=r[c+1]=r[c+2]=0,h-=y,m-=b,v-=S,x-=w,y-=L.r,b-=L.g,S-=L.b,w-=L.a,l=d+((l=a+e+1)<U?l:U)<<2,k+=L.r=r[l],N+=L.g=r[l+1],T+=L.b=r[l+2],j+=L.a=r[l+3],h+=k,m+=N,v+=T,x+=j,L=L.next,y+=M=G.r,b+=A=G.g,S+=P=G.b,w+=D=G.a,k-=M,N-=A,T-=P,j-=D,G=G.next,c+=4;d+=n}for(a=0;a<n;a++){for(N=T=j=k=m=v=x=h=0,c=a<<2,y=z*(M=r[c]),b=z*(A=r[c+1]),S=z*(P=r[c+2]),w=z*(D=r[c+3]),h+=F*M,m+=F*A,v+=F*P,x+=F*D,Y=V,o=0;o<z;o++)Y.r=M,Y.g=A,Y.b=P,Y.a=D,Y=Y.next;for(u=n,o=1;o<=e;o++)c=u+a<<2,h+=(Y.r=M=r[c])*(R=z-o),m+=(Y.g=A=r[c+1])*R,v+=(Y.b=P=r[c+2])*R,x+=(Y.a=D=r[c+3])*R,k+=M,N+=A,T+=P,j+=D,Y=Y.next,o<B&&(u+=n);for(c=a,L=V,G=J,s=0;s<i;s++)l=c<<2,r[l+3]=D=x*ee>>re,D>0?(D=255/D,r[l]=(h*ee>>re)*D,r[l+1]=(m*ee>>re)*D,r[l+2]=(v*ee>>re)*D):r[l]=r[l+1]=r[l+2]=0,h-=y,m-=b,v-=S,x-=w,y-=L.r,b-=L.g,S-=L.b,w-=L.a,l=a+((l=s+z)<B?l:B)*n<<2,h+=k+=L.r=r[l],m+=N+=L.g=r[l+1],v+=T+=L.b=r[l+2],x+=j+=L.a=r[l+3],L=L.next,y+=M=G.r,b+=A=G.g,S+=P=G.b,w+=D=G.a,k-=M,N-=A,T-=P,j-=D,G=G.next,c+=n}}const fle=function(e){const r=Math.round(this.blurRadius());r>0&&dle(e,r)};n1.Blur=fle;EM.Factory.addGetterSetter(ole.Node,"blurRadius",0,(0,lle.getNumberValidator)(),EM.Factory.afterSetFilter);var i1={};Object.defineProperty(i1,"__esModule",{value:!0});i1.Brighten=void 0;const jM=gt,hle=dr,ple=Ze,mle=function(t){let e=this.brightness()*255,r=t.data,n=r.length,i;for(i=0;i<n;i+=4)r[i]+=e,r[i+1]+=e,r[i+2]+=e};i1.Brighten=mle;jM.Factory.addGetterSetter(hle.Node,"brightness",0,(0,ple.getNumberValidator)(),jM.Factory.afterSetFilter);var a1={};Object.defineProperty(a1,"__esModule",{value:!0});a1.Contrast=void 0;const MM=gt,gle=dr,vle=Ze,yle=function(t){const e=Math.pow((this.contrast()+100)/100,2);let r=t.data,n=r.length,i=150,a=150,s=150,o;for(o=0;o<n;o+=4)i=r[o],a=r[o+1],s=r[o+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,s=s<0?0:s>255?255:s,r[o]=i,r[o+1]=a,r[o+2]=s};a1.Contrast=yle;MM.Factory.addGetterSetter(gle.Node,"contrast",0,(0,vle.getNumberValidator)(),MM.Factory.afterSetFilter);var s1={};Object.defineProperty(s1,"__esModule",{value:!0});s1.Emboss=void 0;const kl=gt,o1=dr,xle=xr,eL=Ze,ble=function(t){let e=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),i=this.embossBlend(),a=0,s=0,o=t.data,l=t.width,u=t.height,c=l*4,d=u;switch(n){case"top-left":a=-1,s=-1;break;case"top":a=-1,s=0;break;case"top-right":a=-1,s=1;break;case"right":a=0,s=1;break;case"bottom-right":a=1,s=1;break;case"bottom":a=1,s=0;break;case"bottom-left":a=1,s=-1;break;case"left":a=0,s=-1;break;default:xle.Util.error("Unknown emboss direction: "+n)}do{const h=(d-1)*c;let m=a;d+m<1&&(m=0),d+m>u&&(m=0);const v=(d-1+m)*l*4;let x=l;do{const y=h+(x-1)*4;let b=s;x+b<1&&(b=0),x+b>l&&(b=0);const S=v+(x-1+b)*4,w=o[y]-o[S],k=o[y+1]-o[S+1],N=o[y+2]-o[S+2];let T=w;const j=T>0?T:-T,M=k>0?k:-k,A=N>0?N:-N;if(M>j&&(T=k),A>j&&(T=N),T*=e,i){const P=o[y]+T,D=o[y+1]+T,R=o[y+2]+T;o[y]=P>255?255:P<0?0:P,o[y+1]=D>255?255:D<0?0:D,o[y+2]=R>255?255:R<0?0:R}else{let P=r-T;P<0?P=0:P>255&&(P=255),o[y]=o[y+1]=o[y+2]=P}}while(--x)}while(--d)};s1.Emboss=ble;kl.Factory.addGetterSetter(o1.Node,"embossStrength",.5,(0,eL.getNumberValidator)(),kl.Factory.afterSetFilter);kl.Factory.addGetterSetter(o1.Node,"embossWhiteLevel",.5,(0,eL.getNumberValidator)(),kl.Factory.afterSetFilter);kl.Factory.addGetterSetter(o1.Node,"embossDirection","top-left",null,kl.Factory.afterSetFilter);kl.Factory.addGetterSetter(o1.Node,"embossBlend",!1,null,kl.Factory.afterSetFilter);var l1={};Object.defineProperty(l1,"__esModule",{value:!0});l1.Enhance=void 0;const PM=gt,wle=dr,Sle=Ze;function IS(t,e,r,n,i){let a=r-e,s=i-n,o;return a===0?n+s/2:s===0?n:(o=(t-e)/a,o=s*o+n,o)}const kle=function(t){let e=t.data,r=e.length,n=e[0],i=n,a,s=e[1],o=s,l,u=e[2],c=u,d,h;const m=this.enhance();if(m===0)return;for(h=0;h<r;h+=4)a=e[h+0],a<n?n=a:a>i&&(i=a),l=e[h+1],l<s?s=l:l>o&&(o=l),d=e[h+2],d<u?u=d:d>c&&(c=d);i===n&&(i=255,n=0),o===s&&(o=255,s=0),c===u&&(c=255,u=0);let v,x,y,b,S,w,k,N,T;for(m>0?(x=i+m*(255-i),y=n-m*(n-0),S=o+m*(255-o),w=s-m*(s-0),N=c+m*(255-c),T=u-m*(u-0)):(v=(i+n)*.5,x=i+m*(i-v),y=n+m*(n-v),b=(o+s)*.5,S=o+m*(o-b),w=s+m*(s-b),k=(c+u)*.5,N=c+m*(c-k),T=u+m*(u-k)),h=0;h<r;h+=4)e[h+0]=IS(e[h+0],n,i,y,x),e[h+1]=IS(e[h+1],s,o,w,S),e[h+2]=IS(e[h+2],u,c,T,N)};l1.Enhance=kle;PM.Factory.addGetterSetter(wle.Node,"enhance",0,(0,Sle.getNumberValidator)(),PM.Factory.afterSetFilter);var u1={};Object.defineProperty(u1,"__esModule",{value:!0});u1.Grayscale=void 0;const Cle=function(t){let e=t.data,r=e.length,n,i;for(n=0;n<r;n+=4)i=.34*e[n]+.5*e[n+1]+.16*e[n+2],e[n]=i,e[n+1]=i,e[n+2]=i};u1.Grayscale=Cle;var c1={};Object.defineProperty(c1,"__esModule",{value:!0});c1.HSL=void 0;const Yd=gt,y4=dr,x4=Ze;Yd.Factory.addGetterSetter(y4.Node,"hue",0,(0,x4.getNumberValidator)(),Yd.Factory.afterSetFilter);Yd.Factory.addGetterSetter(y4.Node,"saturation",0,(0,x4.getNumberValidator)(),Yd.Factory.afterSetFilter);Yd.Factory.addGetterSetter(y4.Node,"luminance",0,(0,x4.getNumberValidator)(),Yd.Factory.afterSetFilter);const Nle=function(t){let e=t.data,r=e.length,n=1,i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=this.luminance()*127,o;const l=n*i*Math.cos(a*Math.PI/180),u=n*i*Math.sin(a*Math.PI/180),c=.299*n+.701*l+.167*u,d=.587*n-.587*l+.33*u,h=.114*n-.114*l-.497*u,m=.299*n-.299*l-.328*u,v=.587*n+.413*l+.035*u,x=.114*n-.114*l+.293*u,y=.299*n-.3*l+1.25*u,b=.587*n-.586*l-1.05*u,S=.114*n+.886*l-.2*u;let w,k,N,T;for(o=0;o<r;o+=4)w=e[o+0],k=e[o+1],N=e[o+2],T=e[o+3],e[o+0]=c*w+d*k+h*N+s,e[o+1]=m*w+v*k+x*N+s,e[o+2]=y*w+b*k+S*N+s,e[o+3]=T};c1.HSL=Nle;var d1={};Object.defineProperty(d1,"__esModule",{value:!0});d1.HSV=void 0;const Xd=gt,b4=dr,w4=Ze,Ele=function(t){const e=t.data,r=e.length,n=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=n*i*Math.cos(a*Math.PI/180),o=n*i*Math.sin(a*Math.PI/180),l=.299*n+.701*s+.167*o,u=.587*n-.587*s+.33*o,c=.114*n-.114*s-.497*o,d=.299*n-.299*s-.328*o,h=.587*n+.413*s+.035*o,m=.114*n-.114*s+.293*o,v=.299*n-.3*s+1.25*o,x=.587*n-.586*s-1.05*o,y=.114*n+.886*s-.2*o;let b,S,w,k;for(let N=0;N<r;N+=4)b=e[N+0],S=e[N+1],w=e[N+2],k=e[N+3],e[N+0]=l*b+u*S+c*w,e[N+1]=d*b+h*S+m*w,e[N+2]=v*b+x*S+y*w,e[N+3]=k};d1.HSV=Ele;Xd.Factory.addGetterSetter(b4.Node,"hue",0,(0,w4.getNumberValidator)(),Xd.Factory.afterSetFilter);Xd.Factory.addGetterSetter(b4.Node,"saturation",0,(0,w4.getNumberValidator)(),Xd.Factory.afterSetFilter);Xd.Factory.addGetterSetter(b4.Node,"value",0,(0,w4.getNumberValidator)(),Xd.Factory.afterSetFilter);var f1={};Object.defineProperty(f1,"__esModule",{value:!0});f1.Invert=void 0;const Tle=function(t){let e=t.data,r=e.length,n;for(n=0;n<r;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]};f1.Invert=Tle;var h1={};Object.defineProperty(h1,"__esModule",{value:!0});h1.Kaleidoscope=void 0;const My=gt,tL=dr,_M=xr,rL=Ze,jle=function(t,e,r){let n=t.data,i=e.data,a=t.width,s=t.height,o=r.polarCenterX||a/2,l=r.polarCenterY||s/2,u,c,d,h=0,m=0,v=0,x=0,y,b=Math.sqrt(o*o+l*l);c=a-o,d=s-l,y=Math.sqrt(c*c+d*d),b=y>b?y:b;let S=s,w=a,k,N,T=360/w*Math.PI/180,j,M;for(N=0;N<w;N+=1)for(j=Math.sin(N*T),M=Math.cos(N*T),k=0;k<S;k+=1)c=Math.floor(o+b*k/S*M),d=Math.floor(l+b*k/S*j),u=(d*a+c)*4,h=n[u+0],m=n[u+1],v=n[u+2],x=n[u+3],u=(N+k*a)*4,i[u+0]=h,i[u+1]=m,i[u+2]=v,i[u+3]=x},Mle=function(t,e,r){let n=t.data,i=e.data,a=t.width,s=t.height,o=r.polarCenterX||a/2,l=r.polarCenterY||s/2,u,c,d,h,m,v=0,x=0,y=0,b=0,S,w=Math.sqrt(o*o+l*l);c=a-o,d=s-l,S=Math.sqrt(c*c+d*d),w=S>w?S:w;let k=s,N=a,T,j,M=r.polarRotation||0,A,P;for(c=0;c<a;c+=1)for(d=0;d<s;d+=1)h=c-o,m=d-l,T=Math.sqrt(h*h+m*m)*k/w,j=(Math.atan2(m,h)*180/Math.PI+360+M)%360,j=j*N/360,A=Math.floor(j),P=Math.floor(T),u=(P*a+A)*4,v=n[u+0],x=n[u+1],y=n[u+2],b=n[u+3],u=(d*a+c)*4,i[u+0]=v,i[u+1]=x,i[u+2]=y,i[u+3]=b},Ple=function(t){const e=t.width,r=t.height;let n,i,a,s,o,l,u,c,d,h,m=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),x=Math.floor(e*(v%360)/360);if(m<1)return;const y=_M.Util.createCanvasElement();y.width=e,y.height=r;const b=y.getContext("2d").getImageData(0,0,e,r);_M.Util.releaseCanvas(y),jle(t,b,{polarCenterX:e/2,polarCenterY:r/2});let S=e/Math.pow(2,m);for(;S<=8;)S=S*2,m-=1;S=Math.ceil(S);let w=S,k=0,N=w,T=1;for(x+S>e&&(k=w,N=0,T=-1),i=0;i<r;i+=1)for(n=k;n!==N;n+=T)a=Math.round(n+x)%e,d=(e*i+a)*4,o=b.data[d+0],l=b.data[d+1],u=b.data[d+2],c=b.data[d+3],h=(e*i+n)*4,b.data[h+0]=o,b.data[h+1]=l,b.data[h+2]=u,b.data[h+3]=c;for(i=0;i<r;i+=1)for(w=Math.floor(S),s=0;s<m;s+=1){for(n=0;n<w+1;n+=1)d=(e*i+n)*4,o=b.data[d+0],l=b.data[d+1],u=b.data[d+2],c=b.data[d+3],h=(e*i+w*2-n-1)*4,b.data[h+0]=o,b.data[h+1]=l,b.data[h+2]=u,b.data[h+3]=c;w*=2}Mle(b,t,{polarRotation:0})};h1.Kaleidoscope=Ple;My.Factory.addGetterSetter(tL.Node,"kaleidoscopePower",2,(0,rL.getNumberValidator)(),My.Factory.afterSetFilter);My.Factory.addGetterSetter(tL.Node,"kaleidoscopeAngle",0,(0,rL.getNumberValidator)(),My.Factory.afterSetFilter);var p1={};Object.defineProperty(p1,"__esModule",{value:!0});p1.Mask=void 0;const AM=gt,_le=dr,Ale=Ze;function hv(t,e,r){let n=(r*t.width+e)*4;const i=[];return i.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),i}function hh(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function Rle(t){const e=[0,0,0];for(let r=0;r<t.length;r++)e[0]+=t[r][0],e[1]+=t[r][1],e[2]+=t[r][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function Dle(t,e){const r=hv(t,0,0),n=hv(t,t.width-1,0),i=hv(t,0,t.height-1),a=hv(t,t.width-1,t.height-1),s=e||10;if(hh(r,n)<s&&hh(n,a)<s&&hh(a,i)<s&&hh(i,r)<s){const o=Rle([n,r,a,i]),l=[];for(let u=0;u<t.width*t.height;u++){const c=hh(o,[t.data[u*4],t.data[u*4+1],t.data[u*4+2]]);l[u]=c<s?0:255}return l}}function Ole(t,e){for(let r=0;r<t.width*t.height;r++)t.data[4*r+3]=e[r]}function Ile(t,e,r){const n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let c=0;for(let d=0;d<i;d++)for(let h=0;h<i;h++){const m=o+d-a,v=l+h-a;if(m>=0&&m<r&&v>=0&&v<e){const x=m*e+v,y=n[d*i+h];c+=t[x]*y}}s[u]=c===255*8?255:0}return s}function Lle(t,e,r){const n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let c=0;for(let d=0;d<i;d++)for(let h=0;h<i;h++){const m=o+d-a,v=l+h-a;if(m>=0&&m<r&&v>=0&&v<e){const x=m*e+v,y=n[d*i+h];c+=t[x]*y}}s[u]=c>=255*4?255:0}return s}function Ble(t,e,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let c=0;for(let d=0;d<i;d++)for(let h=0;h<i;h++){const m=o+d-a,v=l+h-a;if(m>=0&&m<r&&v>=0&&v<e){const x=m*e+v,y=n[d*i+h];c+=t[x]*y}}s[u]=c}return s}const Fle=function(t){let e=this.threshold(),r=Dle(t,e);return r&&(r=Ile(r,t.width,t.height),r=Lle(r,t.width,t.height),r=Ble(r,t.width,t.height),Ole(t,r)),t};p1.Mask=Fle;AM.Factory.addGetterSetter(_le.Node,"threshold",0,(0,Ale.getNumberValidator)(),AM.Factory.afterSetFilter);var m1={};Object.defineProperty(m1,"__esModule",{value:!0});m1.Noise=void 0;const RM=gt,zle=dr,Vle=Ze,$le=function(t){const e=this.noise()*255,r=t.data,n=r.length,i=e/2;for(let a=0;a<n;a+=4)r[a+0]+=i-2*i*Math.random(),r[a+1]+=i-2*i*Math.random(),r[a+2]+=i-2*i*Math.random()};m1.Noise=$le;RM.Factory.addGetterSetter(zle.Node,"noise",.2,(0,Vle.getNumberValidator)(),RM.Factory.afterSetFilter);var g1={};Object.defineProperty(g1,"__esModule",{value:!0});g1.Pixelate=void 0;const DM=gt,Ule=xr,Gle=dr,Hle=Ze,Wle=function(t){let e=Math.ceil(this.pixelSize()),r=t.width,n=t.height,i,a,s,o,l,u,c,d=Math.ceil(r/e),h=Math.ceil(n/e),m,v,x,y,b,S,w,k=t.data;if(e<=0){Ule.Util.error("pixelSize value can not be <= 0");return}for(b=0;b<d;b+=1)for(S=0;S<h;S+=1){for(o=0,l=0,u=0,c=0,m=b*e,v=m+e,x=S*e,y=x+e,w=0,i=m;i<v;i+=1)if(!(i>=r))for(a=x;a<y;a+=1)a>=n||(s=(r*a+i)*4,o+=k[s+0],l+=k[s+1],u+=k[s+2],c+=k[s+3],w+=1);for(o=o/w,l=l/w,u=u/w,c=c/w,i=m;i<v;i+=1)if(!(i>=r))for(a=x;a<y;a+=1)a>=n||(s=(r*a+i)*4,k[s+0]=o,k[s+1]=l,k[s+2]=u,k[s+3]=c)}};g1.Pixelate=Wle;DM.Factory.addGetterSetter(Gle.Node,"pixelSize",8,(0,Hle.getNumberValidator)(),DM.Factory.afterSetFilter);var v1={};Object.defineProperty(v1,"__esModule",{value:!0});v1.Posterize=void 0;const OM=gt,qle=dr,Kle=Ze,Yle=function(t){let e=Math.round(this.levels()*254)+1,r=t.data,n=r.length,i=255/e,a;for(a=0;a<n;a+=1)r[a]=Math.floor(r[a]/i)*i};v1.Posterize=Yle;OM.Factory.addGetterSetter(qle.Node,"levels",.5,(0,Kle.getNumberValidator)(),OM.Factory.afterSetFilter);var y1={};Object.defineProperty(y1,"__esModule",{value:!0});y1.RGB=void 0;const Py=gt,S4=dr,Xle=Ze,Qle=function(t){let e=t.data,r=e.length,n=this.red(),i=this.green(),a=this.blue(),s,o;for(s=0;s<r;s+=4)o=(.34*e[s]+.5*e[s+1]+.16*e[s+2])/255,e[s]=o*n,e[s+1]=o*i,e[s+2]=o*a,e[s+3]=e[s+3]};y1.RGB=Qle;Py.Factory.addGetterSetter(S4.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Py.Factory.addGetterSetter(S4.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Py.Factory.addGetterSetter(S4.Node,"blue",0,Xle.RGBComponent,Py.Factory.afterSetFilter);var x1={};Object.defineProperty(x1,"__esModule",{value:!0});x1.RGBA=void 0;const Vp=gt,b1=dr,Jle=Ze,Zle=function(t){const e=t.data,r=e.length,n=this.red(),i=this.green(),a=this.blue(),s=this.alpha();for(let o=0;o<r;o+=4){const l=1-s;e[o]=n*s+e[o]*l,e[o+1]=i*s+e[o+1]*l,e[o+2]=a*s+e[o+2]*l}};x1.RGBA=Zle;Vp.Factory.addGetterSetter(b1.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Vp.Factory.addGetterSetter(b1.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Vp.Factory.addGetterSetter(b1.Node,"blue",0,Jle.RGBComponent,Vp.Factory.afterSetFilter);Vp.Factory.addGetterSetter(b1.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var w1={};Object.defineProperty(w1,"__esModule",{value:!0});w1.Sepia=void 0;const eue=function(t){let e=t.data,r=e.length,n,i,a,s;for(n=0;n<r;n+=4)i=e[n+0],a=e[n+1],s=e[n+2],e[n+0]=Math.min(255,i*.393+a*.769+s*.189),e[n+1]=Math.min(255,i*.349+a*.686+s*.168),e[n+2]=Math.min(255,i*.272+a*.534+s*.131)};w1.Sepia=eue;var S1={};Object.defineProperty(S1,"__esModule",{value:!0});S1.Solarize=void 0;const tue=function(t){const e=t.data,r=t.width,n=t.height,i=r*4;let a=n;do{const s=(a-1)*i;let o=r;do{const l=s+(o-1)*4;let u=e[l],c=e[l+1],d=e[l+2];u>127&&(u=255-u),c>127&&(c=255-c),d>127&&(d=255-d),e[l]=u,e[l+1]=c,e[l+2]=d}while(--o)}while(--a)};S1.Solarize=tue;var k1={};Object.defineProperty(k1,"__esModule",{value:!0});k1.Threshold=void 0;const IM=gt,rue=dr,nue=Ze,iue=function(t){const e=this.threshold()*255,r=t.data,n=r.length;for(let i=0;i<n;i+=1)r[i]=r[i]<e?0:255};k1.Threshold=iue;IM.Factory.addGetterSetter(rue.Node,"threshold",.5,(0,nue.getNumberValidator)(),IM.Factory.afterSetFilter);Object.defineProperty(Ax,"__esModule",{value:!0});Ax.Konva=void 0;const LM=Ey,aue=Bx,sue=Vx,oue=Gx,lue=Hx,uue=Wx,BM=Kd,cue=ym,due=pf,fue=bm,hue=Yx,pue=Xx,mue=Qx,gue=Jx,vue=gf,yue=Zx,xue=e1,bue=t1,wue=n1,Sue=i1,kue=a1,Cue=s1,Nue=l1,Eue=u1,Tue=c1,jue=d1,Mue=f1,Pue=h1,_ue=p1,Aue=m1,Rue=g1,Due=v1,Oue=y1,Iue=x1,Lue=w1,Bue=S1,Fue=k1;Ax.Konva=LM.Konva.Util._assign(LM.Konva,{Arc:aue.Arc,Arrow:sue.Arrow,Circle:oue.Circle,Ellipse:lue.Ellipse,Image:uue.Image,Label:BM.Label,Tag:BM.Tag,Line:cue.Line,Path:due.Path,Rect:fue.Rect,RegularPolygon:hue.RegularPolygon,Ring:pue.Ring,Sprite:mue.Sprite,Star:gue.Star,Text:vue.Text,TextPath:yue.TextPath,Transformer:xue.Transformer,Wedge:bue.Wedge,Filters:{Blur:wue.Blur,Brighten:Sue.Brighten,Contrast:kue.Contrast,Emboss:Cue.Emboss,Enhance:Nue.Enhance,Grayscale:Eue.Grayscale,HSL:Tue.HSL,HSV:jue.HSV,Invert:Mue.Invert,Kaleidoscope:Pue.Kaleidoscope,Mask:_ue.Mask,Noise:Aue.Noise,Pixelate:Rue.Pixelate,Posterize:Due.Posterize,RGB:Oue.RGB,RGBA:Iue.RGBA,Sepia:Lue.Sepia,Solarize:Bue.Solarize,Threshold:Fue.Threshold}});var zue=wI.exports;Object.defineProperty(zue,"__esModule",{value:!0});const Vue=Ax;wI.exports=Vue.Konva;var Kk={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var r=Ey;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=Ey;t.exports=n.Konva})(Kk,Kk.exports);var $ue=Kk.exports;const $p=Up($ue);var nL={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uue=function(e){var r={},n=K,i=Eh,a=Object.assign;function s(p){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+p,C=1;C<arguments.length;C++)g+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),v=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),b=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),k=Symbol.for("react.offscreen"),N=Symbol.iterator;function T(p){return p===null||typeof p!="object"?null:(p=N&&p[N]||p["@@iterator"],typeof p=="function"?p:null)}function j(p){if(p==null)return null;if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case c:return"Fragment";case u:return"Portal";case h:return"Profiler";case d:return"StrictMode";case y:return"Suspense";case b:return"SuspenseList"}if(typeof p=="object")switch(p.$$typeof){case v:return(p.displayName||"Context")+".Consumer";case m:return(p._context.displayName||"Context")+".Provider";case x:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case S:return g=p.displayName||null,g!==null?g:j(p.type)||"Memo";case w:g=p._payload,p=p._init;try{return j(p(g))}catch{}}return null}function M(p){var g=p.type;switch(p.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return p=g.render,p=p.displayName||p.name||"",g.displayName||(p!==""?"ForwardRef("+p+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(g);case 8:return g===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function A(p){var g=p,C=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,g.flags&4098&&(C=g.return),p=g.return;while(p)}return g.tag===3?C:null}function P(p){if(A(p)!==p)throw Error(s(188))}function D(p){var g=p.alternate;if(!g){if(g=A(p),g===null)throw Error(s(188));return g!==p?null:p}for(var C=p,E=g;;){var _=C.return;if(_===null)break;var O=_.alternate;if(O===null){if(E=_.return,E!==null){C=E;continue}break}if(_.child===O.child){for(O=_.child;O;){if(O===C)return P(_),p;if(O===E)return P(_),g;O=O.sibling}throw Error(s(188))}if(C.return!==E.return)C=_,E=O;else{for(var X=!1,oe=_.child;oe;){if(oe===C){X=!0,C=_,E=O;break}if(oe===E){X=!0,E=_,C=O;break}oe=oe.sibling}if(!X){for(oe=O.child;oe;){if(oe===C){X=!0,C=O,E=_;break}if(oe===E){X=!0,E=O,C=_;break}oe=oe.sibling}if(!X)throw Error(s(189))}}if(C.alternate!==E)throw Error(s(190))}if(C.tag!==3)throw Error(s(188));return C.stateNode.current===C?p:g}function R(p){return p=D(p),p!==null?I(p):null}function I(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){var g=I(p);if(g!==null)return g;p=p.sibling}return null}function U(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){if(p.tag!==4){var g=U(p);if(g!==null)return g}p=p.sibling}return null}var B=Array.isArray,z=e.getPublicInstance,F=e.getRootHostContext,V=e.getChildHostContext,J=e.prepareForCommit,Y=e.resetAfterCommit,L=e.createInstance,G=e.appendInitialChild,ee=e.finalizeInitialChildren,re=e.prepareUpdate,se=e.shouldSetTextContent,de=e.createTextInstance,W=e.scheduleTimeout,ne=e.cancelTimeout,ie=e.noTimeout,$=e.isPrimaryRenderer,q=e.supportsMutation,te=e.supportsPersistence,Z=e.supportsHydration,le=e.getInstanceFromNode,ge=e.preparePortalMount,Ue=e.getCurrentEventPriority,Te=e.detachDeletedInstance,Re=e.supportsMicrotasks,Ge=e.scheduleMicrotask,Ce=e.supportsTestSelectors,De=e.findFiberRoot,Ve=e.getBoundingRect,We=e.getTextContent,Ie=e.isHiddenSubtree,rt=e.matchAccessibilityRole,ut=e.setFocusIfFocusable,xt=e.setupIntersectionObserver,bt=e.appendChild,Nt=e.appendChildToContainer,Je=e.commitTextUpdate,Oe=e.commitMount,ve=e.commitUpdate,H=e.insertBefore,Q=e.insertInContainerBefore,ae=e.removeChild,ue=e.removeChildFromContainer,fe=e.resetTextContent,xe=e.hideInstance,ye=e.hideTextInstance,je=e.unhideInstance,Me=e.unhideTextInstance,He=e.clearContainer,et=e.cloneInstance,tt=e.createContainerChildSet,Le=e.appendChildToContainerChildSet,nt=e.finalizeContainerChildren,st=e.replaceContainerChildren,Kt=e.cloneHiddenInstance,Ot=e.cloneHiddenTextInstance,yn=e.canHydrateInstance,br=e.canHydrateTextInstance,Ir=e.canHydrateSuspenseInstance,wr=e.isSuspenseInstancePending,Pr=e.isSuspenseInstanceFallback,Fa=e.getSuspenseInstanceFallbackErrorDetails,Sr=e.registerSuspenseInstanceRetry,si=e.getNextHydratableSibling,pa=e.getFirstHydratableChild,ho=e.getFirstHydratableChildWithinContainer,hc=e.getFirstHydratableChildWithinSuspenseInstance,xs=e.hydrateInstance,An=e.hydrateTextInstance,nn=e.hydrateSuspenseInstance,Rn=e.getNextHydratableInstanceAfterSuspenseInstance,Hl=e.commitHydratedContainer,oi=e.commitHydratedSuspenseInstance,wm=e.clearSuspenseBoundary,N1=e.clearSuspenseBoundaryFromContainer,E1=e.shouldDeleteUnhydratedTailInstances,T1=e.didNotMatchHydratedContainerTextInstance,j1=e.didNotMatchHydratedTextInstance,vf;function Wl(p){if(vf===void 0)try{throw Error()}catch(C){var g=C.stack.trim().match(/\n( *(at )?)/);vf=g&&g[1]||""}return`
`+vf+p}var yf=!1;function bs(p,g){if(!p||yf)return"";yf=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(ke){var E=ke}Reflect.construct(p,[],g)}else{try{g.call()}catch(ke){E=ke}p.call(g.prototype)}else{try{throw Error()}catch(ke){E=ke}p()}}catch(ke){if(ke&&E&&typeof ke.stack=="string"){for(var _=ke.stack.split(`
`),O=E.stack.split(`
`),X=_.length-1,oe=O.length-1;1<=X&&0<=oe&&_[X]!==O[oe];)oe--;for(;1<=X&&0<=oe;X--,oe--)if(_[X]!==O[oe]){if(X!==1||oe!==1)do if(X--,oe--,0>oe||_[X]!==O[oe]){var pe=`
`+_[X].replace(" at new "," at ");return p.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",p.displayName)),pe}while(1<=X&&0<=oe);break}}}finally{yf=!1,Error.prepareStackTrace=C}return(p=p?p.displayName||p.name:"")?Wl(p):""}var xf=Object.prototype.hasOwnProperty,po=[],ws=-1;function ma(p){return{current:p}}function $t(p){0>ws||(p.current=po[ws],po[ws]=null,ws--)}function vt(p,g){ws++,po[ws]=p.current,p.current=g}var Fi={},Gr=ma(Fi),Lr=ma(!1),Hr=Fi;function mo(p,g){var C=p.type.contextTypes;if(!C)return Fi;var E=p.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===g)return E.__reactInternalMemoizedMaskedChildContext;var _={},O;for(O in C)_[O]=g[O];return E&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=g,p.__reactInternalMemoizedMaskedChildContext=_),_}function Yn(p){return p=p.childContextTypes,p!=null}function pc(){$t(Lr),$t(Gr)}function N4(p,g,C){if(Gr.current!==Fi)throw Error(s(168));vt(Gr,g),vt(Lr,C)}function E4(p,g,C){var E=p.stateNode;if(g=g.childContextTypes,typeof E.getChildContext!="function")return C;E=E.getChildContext();for(var _ in E)if(!(_ in g))throw Error(s(108,M(p)||"Unknown",_));return a({},C,E)}function Sm(p){return p=(p=p.stateNode)&&p.__reactInternalMemoizedMergedChildContext||Fi,Hr=Gr.current,vt(Gr,p),vt(Lr,Lr.current),!0}function T4(p,g,C){var E=p.stateNode;if(!E)throw Error(s(169));C?(p=E4(p,g,Hr),E.__reactInternalMemoizedMergedChildContext=p,$t(Lr),$t(Gr),vt(Gr,p)):$t(Lr),vt(Lr,C)}var ga=Math.clz32?Math.clz32:hL,dL=Math.log,fL=Math.LN2;function hL(p){return p>>>=0,p===0?32:31-(dL(p)/fL|0)|0}var km=64,Cm=4194304;function bf(p){switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return p&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return p}}function Nm(p,g){var C=p.pendingLanes;if(C===0)return 0;var E=0,_=p.suspendedLanes,O=p.pingedLanes,X=C&268435455;if(X!==0){var oe=X&~_;oe!==0?E=bf(oe):(O&=X,O!==0&&(E=bf(O)))}else X=C&~_,X!==0?E=bf(X):O!==0&&(E=bf(O));if(E===0)return 0;if(g!==0&&g!==E&&!(g&_)&&(_=E&-E,O=g&-g,_>=O||_===16&&(O&4194240)!==0))return g;if(E&4&&(E|=C&16),g=p.entangledLanes,g!==0)for(p=p.entanglements,g&=E;0<g;)C=31-ga(g),_=1<<C,E|=p[C],g&=~_;return E}function pL(p,g){switch(p){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mL(p,g){for(var C=p.suspendedLanes,E=p.pingedLanes,_=p.expirationTimes,O=p.pendingLanes;0<O;){var X=31-ga(O),oe=1<<X,pe=_[X];pe===-1?(!(oe&C)||oe&E)&&(_[X]=pL(oe,g)):pe<=g&&(p.expiredLanes|=oe),O&=~oe}}function M1(p){return p=p.pendingLanes&-1073741825,p!==0?p:p&1073741824?1073741824:0}function j4(){var p=km;return km<<=1,!(km&4194240)&&(km=64),p}function P1(p){for(var g=[],C=0;31>C;C++)g.push(p);return g}function wf(p,g,C){p.pendingLanes|=g,g!==536870912&&(p.suspendedLanes=0,p.pingedLanes=0),p=p.eventTimes,g=31-ga(g),p[g]=C}function gL(p,g){var C=p.pendingLanes&~g;p.pendingLanes=g,p.suspendedLanes=0,p.pingedLanes=0,p.expiredLanes&=g,p.mutableReadLanes&=g,p.entangledLanes&=g,g=p.entanglements;var E=p.eventTimes;for(p=p.expirationTimes;0<C;){var _=31-ga(C),O=1<<_;g[_]=0,E[_]=-1,p[_]=-1,C&=~O}}function _1(p,g){var C=p.entangledLanes|=g;for(p=p.entanglements;C;){var E=31-ga(C),_=1<<E;_&g|p[E]&g&&(p[E]|=g),C&=~_}}var Pt=0;function M4(p){return p&=-p,1<p?4<p?p&268435455?16:536870912:4:1}var A1=i.unstable_scheduleCallback,P4=i.unstable_cancelCallback,vL=i.unstable_shouldYield,yL=i.unstable_requestPaint,an=i.unstable_now,R1=i.unstable_ImmediatePriority,xL=i.unstable_UserBlockingPriority,D1=i.unstable_NormalPriority,bL=i.unstable_IdlePriority,Em=null,za=null;function wL(p){if(za&&typeof za.onCommitFiberRoot=="function")try{za.onCommitFiberRoot(Em,p,void 0,(p.current.flags&128)===128)}catch{}}function SL(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var va=typeof Object.is=="function"?Object.is:SL,Ss=null,Tm=!1,O1=!1;function _4(p){Ss===null?Ss=[p]:Ss.push(p)}function kL(p){Tm=!0,_4(p)}function Va(){if(!O1&&Ss!==null){O1=!0;var p=0,g=Pt;try{var C=Ss;for(Pt=1;p<C.length;p++){var E=C[p];do E=E(!0);while(E!==null)}Ss=null,Tm=!1}catch(_){throw Ss!==null&&(Ss=Ss.slice(p+1)),A1(R1,Va),_}finally{Pt=g,O1=!1}}return null}var mc=[],gc=0,jm=null,Mm=0,zi=[],Vi=0,ql=null,ks=1,Cs="";function Kl(p,g){mc[gc++]=Mm,mc[gc++]=jm,jm=p,Mm=g}function A4(p,g,C){zi[Vi++]=ks,zi[Vi++]=Cs,zi[Vi++]=ql,ql=p;var E=ks;p=Cs;var _=32-ga(E)-1;E&=~(1<<_),C+=1;var O=32-ga(g)+_;if(30<O){var X=_-_%5;O=(E&(1<<X)-1).toString(32),E>>=X,_-=X,ks=1<<32-ga(g)+_|C<<_|E,Cs=O+p}else ks=1<<O|C<<_|E,Cs=p}function I1(p){p.return!==null&&(Kl(p,1),A4(p,1,0))}function L1(p){for(;p===jm;)jm=mc[--gc],mc[gc]=null,Mm=mc[--gc],mc[gc]=null;for(;p===ql;)ql=zi[--Vi],zi[Vi]=null,Cs=zi[--Vi],zi[Vi]=null,ks=zi[--Vi],zi[Vi]=null}var Ni=null,$i=null,ir=!1,Sf=!1,ya=null;function R4(p,g){var C=qi(5,null,null,0);C.elementType="DELETED",C.stateNode=g,C.return=p,g=p.deletions,g===null?(p.deletions=[C],p.flags|=16):g.push(C)}function D4(p,g){switch(p.tag){case 5:return g=yn(g,p.type,p.pendingProps),g!==null?(p.stateNode=g,Ni=p,$i=pa(g),!0):!1;case 6:return g=br(g,p.pendingProps),g!==null?(p.stateNode=g,Ni=p,$i=null,!0):!1;case 13:if(g=Ir(g),g!==null){var C=ql!==null?{id:ks,overflow:Cs}:null;return p.memoizedState={dehydrated:g,treeContext:C,retryLane:1073741824},C=qi(18,null,null,0),C.stateNode=g,C.return=p,p.child=C,Ni=p,$i=null,!0}return!1;default:return!1}}function B1(p){return(p.mode&1)!==0&&(p.flags&128)===0}function F1(p){if(ir){var g=$i;if(g){var C=g;if(!D4(p,g)){if(B1(p))throw Error(s(418));g=si(C);var E=Ni;g&&D4(p,g)?R4(E,C):(p.flags=p.flags&-4097|2,ir=!1,Ni=p)}}else{if(B1(p))throw Error(s(418));p.flags=p.flags&-4097|2,ir=!1,Ni=p}}}function O4(p){for(p=p.return;p!==null&&p.tag!==5&&p.tag!==3&&p.tag!==13;)p=p.return;Ni=p}function Pm(p){if(!Z||p!==Ni)return!1;if(!ir)return O4(p),ir=!0,!1;if(p.tag!==3&&(p.tag!==5||E1(p.type)&&!se(p.type,p.memoizedProps))){var g=$i;if(g){if(B1(p))throw I4(),Error(s(418));for(;g;)R4(p,g),g=si(g)}}if(O4(p),p.tag===13){if(!Z)throw Error(s(316));if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(s(317));$i=Rn(p)}else $i=Ni?si(p.stateNode):null;return!0}function I4(){for(var p=$i;p;)p=si(p)}function vc(){Z&&($i=Ni=null,Sf=ir=!1)}function z1(p){ya===null?ya=[p]:ya.push(p)}var CL=o.ReactCurrentBatchConfig;function _m(p,g){if(va(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var C=Object.keys(p),E=Object.keys(g);if(C.length!==E.length)return!1;for(E=0;E<C.length;E++){var _=C[E];if(!xf.call(g,_)||!va(p[_],g[_]))return!1}return!0}function NL(p){switch(p.tag){case 5:return Wl(p.type);case 16:return Wl("Lazy");case 13:return Wl("Suspense");case 19:return Wl("SuspenseList");case 0:case 2:case 15:return p=bs(p.type,!1),p;case 11:return p=bs(p.type.render,!1),p;case 1:return p=bs(p.type,!0),p;default:return""}}function kf(p,g,C){if(p=C.ref,p!==null&&typeof p!="function"&&typeof p!="object"){if(C._owner){if(C=C._owner,C){if(C.tag!==1)throw Error(s(309));var E=C.stateNode}if(!E)throw Error(s(147,p));var _=E,O=""+p;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===O?g.ref:(g=function(X){var oe=_.refs;X===null?delete oe[O]:oe[O]=X},g._stringRef=O,g)}if(typeof p!="string")throw Error(s(284));if(!C._owner)throw Error(s(290,p))}return p}function Am(p,g){throw p=Object.prototype.toString.call(g),Error(s(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p))}function L4(p){var g=p._init;return g(p._payload)}function B4(p){function g(he,ce){if(p){var me=he.deletions;me===null?(he.deletions=[ce],he.flags|=16):me.push(ce)}}function C(he,ce){if(!p)return null;for(;ce!==null;)g(he,ce),ce=ce.sibling;return null}function E(he,ce){for(he=new Map;ce!==null;)ce.key!==null?he.set(ce.key,ce):he.set(ce.index,ce),ce=ce.sibling;return he}function _(he,ce){return he=So(he,ce),he.index=0,he.sibling=null,he}function O(he,ce,me){return he.index=me,p?(me=he.alternate,me!==null?(me=me.index,me<ce?(he.flags|=2,ce):me):(he.flags|=2,ce)):(he.flags|=1048576,ce)}function X(he){return p&&he.alternate===null&&(he.flags|=2),he}function oe(he,ce,me,_e){return ce===null||ce.tag!==6?(ce=Ob(me,he.mode,_e),ce.return=he,ce):(ce=_(ce,me),ce.return=he,ce)}function pe(he,ce,me,_e){var Xe=me.type;return Xe===c?$e(he,ce,me.props.children,_e,me.key):ce!==null&&(ce.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===w&&L4(Xe)===ce.type)?(_e=_(ce,me.props),_e.ref=kf(he,ce,me),_e.return=he,_e):(_e=ug(me.type,me.key,me.props,null,he.mode,_e),_e.ref=kf(he,ce,me),_e.return=he,_e)}function ke(he,ce,me,_e){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==me.containerInfo||ce.stateNode.implementation!==me.implementation?(ce=Ib(me,he.mode,_e),ce.return=he,ce):(ce=_(ce,me.children||[]),ce.return=he,ce)}function $e(he,ce,me,_e,Xe){return ce===null||ce.tag!==7?(ce=tu(me,he.mode,_e,Xe),ce.return=he,ce):(ce=_(ce,me),ce.return=he,ce)}function ot(he,ce,me){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return ce=Ob(""+ce,he.mode,me),ce.return=he,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case l:return me=ug(ce.type,ce.key,ce.props,null,he.mode,me),me.ref=kf(he,null,ce),me.return=he,me;case u:return ce=Ib(ce,he.mode,me),ce.return=he,ce;case w:var _e=ce._init;return ot(he,_e(ce._payload),me)}if(B(ce)||T(ce))return ce=tu(ce,he.mode,me,null),ce.return=he,ce;Am(he,ce)}return null}function Pe(he,ce,me,_e){var Xe=ce!==null?ce.key:null;if(typeof me=="string"&&me!==""||typeof me=="number")return Xe!==null?null:oe(he,ce,""+me,_e);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case l:return me.key===Xe?pe(he,ce,me,_e):null;case u:return me.key===Xe?ke(he,ce,me,_e):null;case w:return Xe=me._init,Pe(he,ce,Xe(me._payload),_e)}if(B(me)||T(me))return Xe!==null?null:$e(he,ce,me,_e,null);Am(he,me)}return null}function Jt(he,ce,me,_e,Xe){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return he=he.get(me)||null,oe(ce,he,""+_e,Xe);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case l:return he=he.get(_e.key===null?me:_e.key)||null,pe(ce,he,_e,Xe);case u:return he=he.get(_e.key===null?me:_e.key)||null,ke(ce,he,_e,Xe);case w:var dt=_e._init;return Jt(he,ce,me,dt(_e._payload),Xe)}if(B(_e)||T(_e))return he=he.get(me)||null,$e(ce,he,_e,Xe,null);Am(ce,_e)}return null}function Ut(he,ce,me,_e){for(var Xe=null,dt=null,lt=ce,_t=ce=0,ln=null;lt!==null&&_t<me.length;_t++){lt.index>_t?(ln=lt,lt=null):ln=lt.sibling;var At=Pe(he,lt,me[_t],_e);if(At===null){lt===null&&(lt=ln);break}p&&lt&&At.alternate===null&&g(he,lt),ce=O(At,ce,_t),dt===null?Xe=At:dt.sibling=At,dt=At,lt=ln}if(_t===me.length)return C(he,lt),ir&&Kl(he,_t),Xe;if(lt===null){for(;_t<me.length;_t++)lt=ot(he,me[_t],_e),lt!==null&&(ce=O(lt,ce,_t),dt===null?Xe=lt:dt.sibling=lt,dt=lt);return ir&&Kl(he,_t),Xe}for(lt=E(he,lt);_t<me.length;_t++)ln=Jt(lt,he,_t,me[_t],_e),ln!==null&&(p&&ln.alternate!==null&&lt.delete(ln.key===null?_t:ln.key),ce=O(ln,ce,_t),dt===null?Xe=ln:dt.sibling=ln,dt=ln);return p&&lt.forEach(function(ko){return g(he,ko)}),ir&&Kl(he,_t),Xe}function di(he,ce,me,_e){var Xe=T(me);if(typeof Xe!="function")throw Error(s(150));if(me=Xe.call(me),me==null)throw Error(s(151));for(var dt=Xe=null,lt=ce,_t=ce=0,ln=null,At=me.next();lt!==null&&!At.done;_t++,At=me.next()){lt.index>_t?(ln=lt,lt=null):ln=lt.sibling;var ko=Pe(he,lt,At.value,_e);if(ko===null){lt===null&&(lt=ln);break}p&&lt&&ko.alternate===null&&g(he,lt),ce=O(ko,ce,_t),dt===null?Xe=ko:dt.sibling=ko,dt=ko,lt=ln}if(At.done)return C(he,lt),ir&&Kl(he,_t),Xe;if(lt===null){for(;!At.done;_t++,At=me.next())At=ot(he,At.value,_e),At!==null&&(ce=O(At,ce,_t),dt===null?Xe=At:dt.sibling=At,dt=At);return ir&&Kl(he,_t),Xe}for(lt=E(he,lt);!At.done;_t++,At=me.next())At=Jt(lt,he,_t,At.value,_e),At!==null&&(p&&At.alternate!==null&&lt.delete(At.key===null?_t:At.key),ce=O(At,ce,_t),dt===null?Xe=At:dt.sibling=At,dt=At);return p&&lt.forEach(function(tB){return g(he,tB)}),ir&&Kl(he,_t),Xe}function js(he,ce,me,_e){if(typeof me=="object"&&me!==null&&me.type===c&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case l:e:{for(var Xe=me.key,dt=ce;dt!==null;){if(dt.key===Xe){if(Xe=me.type,Xe===c){if(dt.tag===7){C(he,dt.sibling),ce=_(dt,me.props.children),ce.return=he,he=ce;break e}}else if(dt.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===w&&L4(Xe)===dt.type){C(he,dt.sibling),ce=_(dt,me.props),ce.ref=kf(he,dt,me),ce.return=he,he=ce;break e}C(he,dt);break}else g(he,dt);dt=dt.sibling}me.type===c?(ce=tu(me.props.children,he.mode,_e,me.key),ce.return=he,he=ce):(_e=ug(me.type,me.key,me.props,null,he.mode,_e),_e.ref=kf(he,ce,me),_e.return=he,he=_e)}return X(he);case u:e:{for(dt=me.key;ce!==null;){if(ce.key===dt)if(ce.tag===4&&ce.stateNode.containerInfo===me.containerInfo&&ce.stateNode.implementation===me.implementation){C(he,ce.sibling),ce=_(ce,me.children||[]),ce.return=he,he=ce;break e}else{C(he,ce);break}else g(he,ce);ce=ce.sibling}ce=Ib(me,he.mode,_e),ce.return=he,he=ce}return X(he);case w:return dt=me._init,js(he,ce,dt(me._payload),_e)}if(B(me))return Ut(he,ce,me,_e);if(T(me))return di(he,ce,me,_e);Am(he,me)}return typeof me=="string"&&me!==""||typeof me=="number"?(me=""+me,ce!==null&&ce.tag===6?(C(he,ce.sibling),ce=_(ce,me),ce.return=he,he=ce):(C(he,ce),ce=Ob(me,he.mode,_e),ce.return=he,he=ce),X(he)):C(he,ce)}return js}var yc=B4(!0),F4=B4(!1),Rm=ma(null),Dm=null,xc=null,V1=null;function $1(){V1=xc=Dm=null}function z4(p,g,C){$?(vt(Rm,g._currentValue),g._currentValue=C):(vt(Rm,g._currentValue2),g._currentValue2=C)}function U1(p){var g=Rm.current;$t(Rm),$?p._currentValue=g:p._currentValue2=g}function G1(p,g,C){for(;p!==null;){var E=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,E!==null&&(E.childLanes|=g)):E!==null&&(E.childLanes&g)!==g&&(E.childLanes|=g),p===C)break;p=p.return}}function bc(p,g){Dm=p,V1=xc=null,p=p.dependencies,p!==null&&p.firstContext!==null&&(p.lanes&g&&(li=!0),p.firstContext=null)}function Ui(p){var g=$?p._currentValue:p._currentValue2;if(V1!==p)if(p={context:p,memoizedValue:g,next:null},xc===null){if(Dm===null)throw Error(s(308));xc=p,Dm.dependencies={lanes:0,firstContext:p}}else xc=xc.next=p;return g}var Yl=null;function H1(p){Yl===null?Yl=[p]:Yl.push(p)}function V4(p,g,C,E){var _=g.interleaved;return _===null?(C.next=C,H1(g)):(C.next=_.next,_.next=C),g.interleaved=C,$a(p,E)}function $a(p,g){p.lanes|=g;var C=p.alternate;for(C!==null&&(C.lanes|=g),C=p,p=p.return;p!==null;)p.childLanes|=g,C=p.alternate,C!==null&&(C.childLanes|=g),C=p,p=p.return;return C.tag===3?C.stateNode:null}var go=!1;function W1(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $4(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,effects:p.effects})}function Ns(p,g){return{eventTime:p,lane:g,tag:0,payload:null,callback:null,next:null}}function vo(p,g,C){var E=p.updateQueue;if(E===null)return null;if(E=E.shared,yt&2){var _=E.pending;return _===null?g.next=g:(g.next=_.next,_.next=g),E.pending=g,$a(p,C)}return _=E.interleaved,_===null?(g.next=g,H1(E)):(g.next=_.next,_.next=g),E.interleaved=g,$a(p,C)}function Om(p,g,C){if(g=g.updateQueue,g!==null&&(g=g.shared,(C&4194240)!==0)){var E=g.lanes;E&=p.pendingLanes,C|=E,g.lanes=C,_1(p,C)}}function U4(p,g){var C=p.updateQueue,E=p.alternate;if(E!==null&&(E=E.updateQueue,C===E)){var _=null,O=null;if(C=C.firstBaseUpdate,C!==null){do{var X={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};O===null?_=O=X:O=O.next=X,C=C.next}while(C!==null);O===null?_=O=g:O=O.next=g}else _=O=g;C={baseState:E.baseState,firstBaseUpdate:_,lastBaseUpdate:O,shared:E.shared,effects:E.effects},p.updateQueue=C;return}p=C.lastBaseUpdate,p===null?C.firstBaseUpdate=g:p.next=g,C.lastBaseUpdate=g}function Im(p,g,C,E){var _=p.updateQueue;go=!1;var O=_.firstBaseUpdate,X=_.lastBaseUpdate,oe=_.shared.pending;if(oe!==null){_.shared.pending=null;var pe=oe,ke=pe.next;pe.next=null,X===null?O=ke:X.next=ke,X=pe;var $e=p.alternate;$e!==null&&($e=$e.updateQueue,oe=$e.lastBaseUpdate,oe!==X&&(oe===null?$e.firstBaseUpdate=ke:oe.next=ke,$e.lastBaseUpdate=pe))}if(O!==null){var ot=_.baseState;X=0,$e=ke=pe=null,oe=O;do{var Pe=oe.lane,Jt=oe.eventTime;if((E&Pe)===Pe){$e!==null&&($e=$e.next={eventTime:Jt,lane:0,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null});e:{var Ut=p,di=oe;switch(Pe=g,Jt=C,di.tag){case 1:if(Ut=di.payload,typeof Ut=="function"){ot=Ut.call(Jt,ot,Pe);break e}ot=Ut;break e;case 3:Ut.flags=Ut.flags&-65537|128;case 0:if(Ut=di.payload,Pe=typeof Ut=="function"?Ut.call(Jt,ot,Pe):Ut,Pe==null)break e;ot=a({},ot,Pe);break e;case 2:go=!0}}oe.callback!==null&&oe.lane!==0&&(p.flags|=64,Pe=_.effects,Pe===null?_.effects=[oe]:Pe.push(oe))}else Jt={eventTime:Jt,lane:Pe,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null},$e===null?(ke=$e=Jt,pe=ot):$e=$e.next=Jt,X|=Pe;if(oe=oe.next,oe===null){if(oe=_.shared.pending,oe===null)break;Pe=oe,oe=Pe.next,Pe.next=null,_.lastBaseUpdate=Pe,_.shared.pending=null}}while(1);if($e===null&&(pe=ot),_.baseState=pe,_.firstBaseUpdate=ke,_.lastBaseUpdate=$e,g=_.shared.interleaved,g!==null){_=g;do X|=_.lane,_=_.next;while(_!==g)}else O===null&&(_.shared.lanes=0);Ql|=X,p.lanes=X,p.memoizedState=ot}}function G4(p,g,C){if(p=g.effects,g.effects=null,p!==null)for(g=0;g<p.length;g++){var E=p[g],_=E.callback;if(_!==null){if(E.callback=null,E=C,typeof _!="function")throw Error(s(191,_));_.call(E)}}}var Cf={},Gi=ma(Cf),Nf=ma(Cf),wc=ma(Cf);function Ua(p){if(p===Cf)throw Error(s(174));return p}function q1(p,g){vt(wc,g),vt(Nf,p),vt(Gi,Cf),p=F(g),$t(Gi),vt(Gi,p)}function Sc(){$t(Gi),$t(Nf),$t(wc)}function H4(p){var g=Ua(wc.current),C=Ua(Gi.current);g=V(C,p.type,g),C!==g&&(vt(Nf,p),vt(Gi,g))}function K1(p){Nf.current===p&&($t(Gi),$t(Nf))}var fr=ma(0);function Lm(p){for(var g=p;g!==null;){if(g.tag===13){var C=g.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||wr(C)||Pr(C)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var Y1=[];function X1(){for(var p=0;p<Y1.length;p++){var g=Y1[p];$?g._workInProgressVersionPrimary=null:g._workInProgressVersionSecondary=null}Y1.length=0}var Bm=o.ReactCurrentDispatcher,Q1=o.ReactCurrentBatchConfig,Xl=0,hr=null,Wr=null,sn=null,Fm=!1,Ef=!1,Tf=0,EL=0;function Dn(){throw Error(s(321))}function J1(p,g){if(g===null)return!1;for(var C=0;C<g.length&&C<p.length;C++)if(!va(p[C],g[C]))return!1;return!0}function Z1(p,g,C,E,_,O){if(Xl=O,hr=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Bm.current=p===null||p.memoizedState===null?PL:_L,p=C(E,_),Ef){O=0;do{if(Ef=!1,Tf=0,25<=O)throw Error(s(301));O+=1,sn=Wr=null,g.updateQueue=null,Bm.current=AL,p=C(E,_)}while(Ef)}if(Bm.current=$m,g=Wr!==null&&Wr.next!==null,Xl=0,sn=Wr=hr=null,Fm=!1,g)throw Error(s(300));return p}function eb(){var p=Tf!==0;return Tf=0,p}function Ga(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?hr.memoizedState=sn=p:sn=sn.next=p,sn}function Hi(){if(Wr===null){var p=hr.alternate;p=p!==null?p.memoizedState:null}else p=Wr.next;var g=sn===null?hr.memoizedState:sn.next;if(g!==null)sn=g,Wr=p;else{if(p===null)throw Error(s(310));Wr=p,p={memoizedState:Wr.memoizedState,baseState:Wr.baseState,baseQueue:Wr.baseQueue,queue:Wr.queue,next:null},sn===null?hr.memoizedState=sn=p:sn=sn.next=p}return sn}function jf(p,g){return typeof g=="function"?g(p):g}function tb(p){var g=Hi(),C=g.queue;if(C===null)throw Error(s(311));C.lastRenderedReducer=p;var E=Wr,_=E.baseQueue,O=C.pending;if(O!==null){if(_!==null){var X=_.next;_.next=O.next,O.next=X}E.baseQueue=_=O,C.pending=null}if(_!==null){O=_.next,E=E.baseState;var oe=X=null,pe=null,ke=O;do{var $e=ke.lane;if((Xl&$e)===$e)pe!==null&&(pe=pe.next={lane:0,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),E=ke.hasEagerState?ke.eagerState:p(E,ke.action);else{var ot={lane:$e,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null};pe===null?(oe=pe=ot,X=E):pe=pe.next=ot,hr.lanes|=$e,Ql|=$e}ke=ke.next}while(ke!==null&&ke!==O);pe===null?X=E:pe.next=oe,va(E,g.memoizedState)||(li=!0),g.memoizedState=E,g.baseState=X,g.baseQueue=pe,C.lastRenderedState=E}if(p=C.interleaved,p!==null){_=p;do O=_.lane,hr.lanes|=O,Ql|=O,_=_.next;while(_!==p)}else _===null&&(C.lanes=0);return[g.memoizedState,C.dispatch]}function rb(p){var g=Hi(),C=g.queue;if(C===null)throw Error(s(311));C.lastRenderedReducer=p;var E=C.dispatch,_=C.pending,O=g.memoizedState;if(_!==null){C.pending=null;var X=_=_.next;do O=p(O,X.action),X=X.next;while(X!==_);va(O,g.memoizedState)||(li=!0),g.memoizedState=O,g.baseQueue===null&&(g.baseState=O),C.lastRenderedState=O}return[O,E]}function W4(){}function q4(p,g){var C=hr,E=Hi(),_=g(),O=!va(E.memoizedState,_);if(O&&(E.memoizedState=_,li=!0),E=E.queue,nb(X4.bind(null,C,E,p),[p]),E.getSnapshot!==g||O||sn!==null&&sn.memoizedState.tag&1){if(C.flags|=2048,Mf(9,Y4.bind(null,C,E,_,g),void 0,null),on===null)throw Error(s(349));Xl&30||K4(C,g,_)}return _}function K4(p,g,C){p.flags|=16384,p={getSnapshot:g,value:C},g=hr.updateQueue,g===null?(g={lastEffect:null,stores:null},hr.updateQueue=g,g.stores=[p]):(C=g.stores,C===null?g.stores=[p]:C.push(p))}function Y4(p,g,C,E){g.value=C,g.getSnapshot=E,Q4(g)&&J4(p)}function X4(p,g,C){return C(function(){Q4(g)&&J4(p)})}function Q4(p){var g=p.getSnapshot;p=p.value;try{var C=g();return!va(p,C)}catch{return!0}}function J4(p){var g=$a(p,1);g!==null&&Wi(g,p,1,-1)}function Z4(p){var g=Ga();return typeof p=="function"&&(p=p()),g.memoizedState=g.baseState=p,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jf,lastRenderedState:p},g.queue=p,p=p.dispatch=ML.bind(null,hr,p),[g.memoizedState,p]}function Mf(p,g,C,E){return p={tag:p,create:g,destroy:C,deps:E,next:null},g=hr.updateQueue,g===null?(g={lastEffect:null,stores:null},hr.updateQueue=g,g.lastEffect=p.next=p):(C=g.lastEffect,C===null?g.lastEffect=p.next=p:(E=C.next,C.next=p,p.next=E,g.lastEffect=p)),p}function eN(){return Hi().memoizedState}function zm(p,g,C,E){var _=Ga();hr.flags|=p,_.memoizedState=Mf(1|g,C,void 0,E===void 0?null:E)}function Vm(p,g,C,E){var _=Hi();E=E===void 0?null:E;var O=void 0;if(Wr!==null){var X=Wr.memoizedState;if(O=X.destroy,E!==null&&J1(E,X.deps)){_.memoizedState=Mf(g,C,O,E);return}}hr.flags|=p,_.memoizedState=Mf(1|g,C,O,E)}function tN(p,g){return zm(8390656,8,p,g)}function nb(p,g){return Vm(2048,8,p,g)}function rN(p,g){return Vm(4,2,p,g)}function nN(p,g){return Vm(4,4,p,g)}function iN(p,g){if(typeof g=="function")return p=p(),g(p),function(){g(null)};if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function aN(p,g,C){return C=C!=null?C.concat([p]):null,Vm(4,4,iN.bind(null,g,p),C)}function ib(){}function sN(p,g){var C=Hi();g=g===void 0?null:g;var E=C.memoizedState;return E!==null&&g!==null&&J1(g,E[1])?E[0]:(C.memoizedState=[p,g],p)}function oN(p,g){var C=Hi();g=g===void 0?null:g;var E=C.memoizedState;return E!==null&&g!==null&&J1(g,E[1])?E[0]:(p=p(),C.memoizedState=[p,g],p)}function lN(p,g,C){return Xl&21?(va(C,g)||(C=j4(),hr.lanes|=C,Ql|=C,p.baseState=!0),g):(p.baseState&&(p.baseState=!1,li=!0),p.memoizedState=C)}function TL(p,g){var C=Pt;Pt=C!==0&&4>C?C:4,p(!0);var E=Q1.transition;Q1.transition={};try{p(!1),g()}finally{Pt=C,Q1.transition=E}}function uN(){return Hi().memoizedState}function jL(p,g,C){var E=bo(p);if(C={lane:E,action:C,hasEagerState:!1,eagerState:null,next:null},cN(p))dN(g,C);else if(C=V4(p,g,C,E),C!==null){var _=Ln();Wi(C,p,E,_),fN(C,g,E)}}function ML(p,g,C){var E=bo(p),_={lane:E,action:C,hasEagerState:!1,eagerState:null,next:null};if(cN(p))dN(g,_);else{var O=p.alternate;if(p.lanes===0&&(O===null||O.lanes===0)&&(O=g.lastRenderedReducer,O!==null))try{var X=g.lastRenderedState,oe=O(X,C);if(_.hasEagerState=!0,_.eagerState=oe,va(oe,X)){var pe=g.interleaved;pe===null?(_.next=_,H1(g)):(_.next=pe.next,pe.next=_),g.interleaved=_;return}}catch{}finally{}C=V4(p,g,_,E),C!==null&&(_=Ln(),Wi(C,p,E,_),fN(C,g,E))}}function cN(p){var g=p.alternate;return p===hr||g!==null&&g===hr}function dN(p,g){Ef=Fm=!0;var C=p.pending;C===null?g.next=g:(g.next=C.next,C.next=g),p.pending=g}function fN(p,g,C){if(C&4194240){var E=g.lanes;E&=p.pendingLanes,C|=E,g.lanes=C,_1(p,C)}}var $m={readContext:Ui,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useInsertionEffect:Dn,useLayoutEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useMutableSource:Dn,useSyncExternalStore:Dn,useId:Dn,unstable_isNewReconciler:!1},PL={readContext:Ui,useCallback:function(p,g){return Ga().memoizedState=[p,g===void 0?null:g],p},useContext:Ui,useEffect:tN,useImperativeHandle:function(p,g,C){return C=C!=null?C.concat([p]):null,zm(4194308,4,iN.bind(null,g,p),C)},useLayoutEffect:function(p,g){return zm(4194308,4,p,g)},useInsertionEffect:function(p,g){return zm(4,2,p,g)},useMemo:function(p,g){var C=Ga();return g=g===void 0?null:g,p=p(),C.memoizedState=[p,g],p},useReducer:function(p,g,C){var E=Ga();return g=C!==void 0?C(g):g,E.memoizedState=E.baseState=g,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:g},E.queue=p,p=p.dispatch=jL.bind(null,hr,p),[E.memoizedState,p]},useRef:function(p){var g=Ga();return p={current:p},g.memoizedState=p},useState:Z4,useDebugValue:ib,useDeferredValue:function(p){return Ga().memoizedState=p},useTransition:function(){var p=Z4(!1),g=p[0];return p=TL.bind(null,p[1]),Ga().memoizedState=p,[g,p]},useMutableSource:function(){},useSyncExternalStore:function(p,g,C){var E=hr,_=Ga();if(ir){if(C===void 0)throw Error(s(407));C=C()}else{if(C=g(),on===null)throw Error(s(349));Xl&30||K4(E,g,C)}_.memoizedState=C;var O={value:C,getSnapshot:g};return _.queue=O,tN(X4.bind(null,E,O,p),[p]),E.flags|=2048,Mf(9,Y4.bind(null,E,O,C,g),void 0,null),C},useId:function(){var p=Ga(),g=on.identifierPrefix;if(ir){var C=Cs,E=ks;C=(E&~(1<<32-ga(E)-1)).toString(32)+C,g=":"+g+"R"+C,C=Tf++,0<C&&(g+="H"+C.toString(32)),g+=":"}else C=EL++,g=":"+g+"r"+C.toString(32)+":";return p.memoizedState=g},unstable_isNewReconciler:!1},_L={readContext:Ui,useCallback:sN,useContext:Ui,useEffect:nb,useImperativeHandle:aN,useInsertionEffect:rN,useLayoutEffect:nN,useMemo:oN,useReducer:tb,useRef:eN,useState:function(){return tb(jf)},useDebugValue:ib,useDeferredValue:function(p){var g=Hi();return lN(g,Wr.memoizedState,p)},useTransition:function(){var p=tb(jf)[0],g=Hi().memoizedState;return[p,g]},useMutableSource:W4,useSyncExternalStore:q4,useId:uN,unstable_isNewReconciler:!1},AL={readContext:Ui,useCallback:sN,useContext:Ui,useEffect:nb,useImperativeHandle:aN,useInsertionEffect:rN,useLayoutEffect:nN,useMemo:oN,useReducer:rb,useRef:eN,useState:function(){return rb(jf)},useDebugValue:ib,useDeferredValue:function(p){var g=Hi();return Wr===null?g.memoizedState=p:lN(g,Wr.memoizedState,p)},useTransition:function(){var p=rb(jf)[0],g=Hi().memoizedState;return[p,g]},useMutableSource:W4,useSyncExternalStore:q4,useId:uN,unstable_isNewReconciler:!1};function xa(p,g){if(p&&p.defaultProps){g=a({},g),p=p.defaultProps;for(var C in p)g[C]===void 0&&(g[C]=p[C]);return g}return g}function ab(p,g,C,E){g=p.memoizedState,C=C(E,g),C=C==null?g:a({},g,C),p.memoizedState=C,p.lanes===0&&(p.updateQueue.baseState=C)}var Um={isMounted:function(p){return(p=p._reactInternals)?A(p)===p:!1},enqueueSetState:function(p,g,C){p=p._reactInternals;var E=Ln(),_=bo(p),O=Ns(E,_);O.payload=g,C!=null&&(O.callback=C),g=vo(p,O,_),g!==null&&(Wi(g,p,_,E),Om(g,p,_))},enqueueReplaceState:function(p,g,C){p=p._reactInternals;var E=Ln(),_=bo(p),O=Ns(E,_);O.tag=1,O.payload=g,C!=null&&(O.callback=C),g=vo(p,O,_),g!==null&&(Wi(g,p,_,E),Om(g,p,_))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var C=Ln(),E=bo(p),_=Ns(C,E);_.tag=2,g!=null&&(_.callback=g),g=vo(p,_,E),g!==null&&(Wi(g,p,E,C),Om(g,p,E))}};function hN(p,g,C,E,_,O,X){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(E,O,X):g.prototype&&g.prototype.isPureReactComponent?!_m(C,E)||!_m(_,O):!0}function pN(p,g,C){var E=!1,_=Fi,O=g.contextType;return typeof O=="object"&&O!==null?O=Ui(O):(_=Yn(g)?Hr:Gr.current,E=g.contextTypes,O=(E=E!=null)?mo(p,_):Fi),g=new g(C,O),p.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Um,p.stateNode=g,g._reactInternals=p,E&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=_,p.__reactInternalMemoizedMaskedChildContext=O),g}function mN(p,g,C,E){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(C,E),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(C,E),g.state!==p&&Um.enqueueReplaceState(g,g.state,null)}function sb(p,g,C,E){var _=p.stateNode;_.props=C,_.state=p.memoizedState,_.refs={},W1(p);var O=g.contextType;typeof O=="object"&&O!==null?_.context=Ui(O):(O=Yn(g)?Hr:Gr.current,_.context=mo(p,O)),_.state=p.memoizedState,O=g.getDerivedStateFromProps,typeof O=="function"&&(ab(p,g,O,C),_.state=p.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(g=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),g!==_.state&&Um.enqueueReplaceState(_,_.state,null),Im(p,C,_,E),_.state=p.memoizedState),typeof _.componentDidMount=="function"&&(p.flags|=4194308)}function kc(p,g){try{var C="",E=g;do C+=NL(E),E=E.return;while(E);var _=C}catch(O){_=`
Error generating stack: `+O.message+`
`+O.stack}return{value:p,source:g,stack:_,digest:null}}function ob(p,g,C){return{value:p,source:null,stack:C??null,digest:g??null}}function lb(p,g){try{console.error(g.value)}catch(C){setTimeout(function(){throw C})}}var RL=typeof WeakMap=="function"?WeakMap:Map;function gN(p,g,C){C=Ns(-1,C),C.tag=3,C.payload={element:null};var E=g.value;return C.callback=function(){ng||(ng=!0,jb=E),lb(p,g)},C}function vN(p,g,C){C=Ns(-1,C),C.tag=3;var E=p.type.getDerivedStateFromError;if(typeof E=="function"){var _=g.value;C.payload=function(){return E(_)},C.callback=function(){lb(p,g)}}var O=p.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(C.callback=function(){lb(p,g),typeof E!="function"&&(yo===null?yo=new Set([this]):yo.add(this));var X=g.stack;this.componentDidCatch(g.value,{componentStack:X!==null?X:""})}),C}function yN(p,g,C){var E=p.pingCache;if(E===null){E=p.pingCache=new RL;var _=new Set;E.set(g,_)}else _=E.get(g),_===void 0&&(_=new Set,E.set(g,_));_.has(C)||(_.add(C),p=qL.bind(null,p,g,C),g.then(p,p))}function xN(p){do{var g;if((g=p.tag===13)&&(g=p.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return p;p=p.return}while(p!==null);return null}function bN(p,g,C,E,_){return p.mode&1?(p.flags|=65536,p.lanes=_,p):(p===g?p.flags|=65536:(p.flags|=128,C.flags|=131072,C.flags&=-52805,C.tag===1&&(C.alternate===null?C.tag=17:(g=Ns(-1,1),g.tag=2,vo(C,g,1))),C.lanes|=1),p)}var DL=o.ReactCurrentOwner,li=!1;function Xn(p,g,C,E){g.child=p===null?F4(g,null,C,E):yc(g,p.child,C,E)}function wN(p,g,C,E,_){C=C.render;var O=g.ref;return bc(g,_),E=Z1(p,g,C,E,O,_),C=eb(),p!==null&&!li?(g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~_,Es(p,g,_)):(ir&&C&&I1(g),g.flags|=1,Xn(p,g,E,_),g.child)}function SN(p,g,C,E,_){if(p===null){var O=C.type;return typeof O=="function"&&!Db(O)&&O.defaultProps===void 0&&C.compare===null&&C.defaultProps===void 0?(g.tag=15,g.type=O,kN(p,g,O,E,_)):(p=ug(C.type,null,E,g,g.mode,_),p.ref=g.ref,p.return=g,g.child=p)}if(O=p.child,!(p.lanes&_)){var X=O.memoizedProps;if(C=C.compare,C=C!==null?C:_m,C(X,E)&&p.ref===g.ref)return Es(p,g,_)}return g.flags|=1,p=So(O,E),p.ref=g.ref,p.return=g,g.child=p}function kN(p,g,C,E,_){if(p!==null){var O=p.memoizedProps;if(_m(O,E)&&p.ref===g.ref)if(li=!1,g.pendingProps=E=O,(p.lanes&_)!==0)p.flags&131072&&(li=!0);else return g.lanes=p.lanes,Es(p,g,_)}return ub(p,g,C,E,_)}function CN(p,g,C){var E=g.pendingProps,_=E.children,O=p!==null?p.memoizedState:null;if(E.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(Nc,Ei),Ei|=C;else{if(!(C&1073741824))return p=O!==null?O.baseLanes|C:C,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:p,cachePool:null,transitions:null},g.updateQueue=null,vt(Nc,Ei),Ei|=p,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=O!==null?O.baseLanes:C,vt(Nc,Ei),Ei|=E}else O!==null?(E=O.baseLanes|C,g.memoizedState=null):E=C,vt(Nc,Ei),Ei|=E;return Xn(p,g,_,C),g.child}function NN(p,g){var C=g.ref;(p===null&&C!==null||p!==null&&p.ref!==C)&&(g.flags|=512,g.flags|=2097152)}function ub(p,g,C,E,_){var O=Yn(C)?Hr:Gr.current;return O=mo(g,O),bc(g,_),C=Z1(p,g,C,E,O,_),E=eb(),p!==null&&!li?(g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~_,Es(p,g,_)):(ir&&E&&I1(g),g.flags|=1,Xn(p,g,C,_),g.child)}function EN(p,g,C,E,_){if(Yn(C)){var O=!0;Sm(g)}else O=!1;if(bc(g,_),g.stateNode===null)Hm(p,g),pN(g,C,E),sb(g,C,E,_),E=!0;else if(p===null){var X=g.stateNode,oe=g.memoizedProps;X.props=oe;var pe=X.context,ke=C.contextType;typeof ke=="object"&&ke!==null?ke=Ui(ke):(ke=Yn(C)?Hr:Gr.current,ke=mo(g,ke));var $e=C.getDerivedStateFromProps,ot=typeof $e=="function"||typeof X.getSnapshotBeforeUpdate=="function";ot||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(oe!==E||pe!==ke)&&mN(g,X,E,ke),go=!1;var Pe=g.memoizedState;X.state=Pe,Im(g,E,X,_),pe=g.memoizedState,oe!==E||Pe!==pe||Lr.current||go?(typeof $e=="function"&&(ab(g,C,$e,E),pe=g.memoizedState),(oe=go||hN(g,C,oe,E,Pe,pe,ke))?(ot||typeof X.UNSAFE_componentWillMount!="function"&&typeof X.componentWillMount!="function"||(typeof X.componentWillMount=="function"&&X.componentWillMount(),typeof X.UNSAFE_componentWillMount=="function"&&X.UNSAFE_componentWillMount()),typeof X.componentDidMount=="function"&&(g.flags|=4194308)):(typeof X.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=E,g.memoizedState=pe),X.props=E,X.state=pe,X.context=ke,E=oe):(typeof X.componentDidMount=="function"&&(g.flags|=4194308),E=!1)}else{X=g.stateNode,$4(p,g),oe=g.memoizedProps,ke=g.type===g.elementType?oe:xa(g.type,oe),X.props=ke,ot=g.pendingProps,Pe=X.context,pe=C.contextType,typeof pe=="object"&&pe!==null?pe=Ui(pe):(pe=Yn(C)?Hr:Gr.current,pe=mo(g,pe));var Jt=C.getDerivedStateFromProps;($e=typeof Jt=="function"||typeof X.getSnapshotBeforeUpdate=="function")||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(oe!==ot||Pe!==pe)&&mN(g,X,E,pe),go=!1,Pe=g.memoizedState,X.state=Pe,Im(g,E,X,_);var Ut=g.memoizedState;oe!==ot||Pe!==Ut||Lr.current||go?(typeof Jt=="function"&&(ab(g,C,Jt,E),Ut=g.memoizedState),(ke=go||hN(g,C,ke,E,Pe,Ut,pe)||!1)?($e||typeof X.UNSAFE_componentWillUpdate!="function"&&typeof X.componentWillUpdate!="function"||(typeof X.componentWillUpdate=="function"&&X.componentWillUpdate(E,Ut,pe),typeof X.UNSAFE_componentWillUpdate=="function"&&X.UNSAFE_componentWillUpdate(E,Ut,pe)),typeof X.componentDidUpdate=="function"&&(g.flags|=4),typeof X.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof X.componentDidUpdate!="function"||oe===p.memoizedProps&&Pe===p.memoizedState||(g.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||oe===p.memoizedProps&&Pe===p.memoizedState||(g.flags|=1024),g.memoizedProps=E,g.memoizedState=Ut),X.props=E,X.state=Ut,X.context=pe,E=ke):(typeof X.componentDidUpdate!="function"||oe===p.memoizedProps&&Pe===p.memoizedState||(g.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||oe===p.memoizedProps&&Pe===p.memoizedState||(g.flags|=1024),E=!1)}return cb(p,g,C,E,O,_)}function cb(p,g,C,E,_,O){NN(p,g);var X=(g.flags&128)!==0;if(!E&&!X)return _&&T4(g,C,!1),Es(p,g,O);E=g.stateNode,DL.current=g;var oe=X&&typeof C.getDerivedStateFromError!="function"?null:E.render();return g.flags|=1,p!==null&&X?(g.child=yc(g,p.child,null,O),g.child=yc(g,null,oe,O)):Xn(p,g,oe,O),g.memoizedState=E.state,_&&T4(g,C,!0),g.child}function TN(p){var g=p.stateNode;g.pendingContext?N4(p,g.pendingContext,g.pendingContext!==g.context):g.context&&N4(p,g.context,!1),q1(p,g.containerInfo)}function jN(p,g,C,E,_){return vc(),z1(_),g.flags|=256,Xn(p,g,C,E),g.child}var db={dehydrated:null,treeContext:null,retryLane:0};function fb(p){return{baseLanes:p,cachePool:null,transitions:null}}function MN(p,g,C){var E=g.pendingProps,_=fr.current,O=!1,X=(g.flags&128)!==0,oe;if((oe=X)||(oe=p!==null&&p.memoizedState===null?!1:(_&2)!==0),oe?(O=!0,g.flags&=-129):(p===null||p.memoizedState!==null)&&(_|=1),vt(fr,_&1),p===null)return F1(g),p=g.memoizedState,p!==null&&(p=p.dehydrated,p!==null)?(g.mode&1?Pr(p)?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(X=E.children,p=E.fallback,O?(E=g.mode,O=g.child,X={mode:"hidden",children:X},!(E&1)&&O!==null?(O.childLanes=0,O.pendingProps=X):O=cg(X,E,0,null),p=tu(p,E,C,null),O.return=g,p.return=g,O.sibling=p,g.child=O,g.child.memoizedState=fb(C),g.memoizedState=db,p):hb(g,X));if(_=p.memoizedState,_!==null&&(oe=_.dehydrated,oe!==null))return OL(p,g,X,E,oe,_,C);if(O){O=E.fallback,X=g.mode,_=p.child,oe=_.sibling;var pe={mode:"hidden",children:E.children};return!(X&1)&&g.child!==_?(E=g.child,E.childLanes=0,E.pendingProps=pe,g.deletions=null):(E=So(_,pe),E.subtreeFlags=_.subtreeFlags&14680064),oe!==null?O=So(oe,O):(O=tu(O,X,C,null),O.flags|=2),O.return=g,E.return=g,E.sibling=O,g.child=E,E=O,O=g.child,X=p.child.memoizedState,X=X===null?fb(C):{baseLanes:X.baseLanes|C,cachePool:null,transitions:X.transitions},O.memoizedState=X,O.childLanes=p.childLanes&~C,g.memoizedState=db,E}return O=p.child,p=O.sibling,E=So(O,{mode:"visible",children:E.children}),!(g.mode&1)&&(E.lanes=C),E.return=g,E.sibling=null,p!==null&&(C=g.deletions,C===null?(g.deletions=[p],g.flags|=16):C.push(p)),g.child=E,g.memoizedState=null,E}function hb(p,g){return g=cg({mode:"visible",children:g},p.mode,0,null),g.return=p,p.child=g}function Gm(p,g,C,E){return E!==null&&z1(E),yc(g,p.child,null,C),p=hb(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function OL(p,g,C,E,_,O,X){if(C)return g.flags&256?(g.flags&=-257,E=ob(Error(s(422))),Gm(p,g,X,E)):g.memoizedState!==null?(g.child=p.child,g.flags|=128,null):(O=E.fallback,_=g.mode,E=cg({mode:"visible",children:E.children},_,0,null),O=tu(O,_,X,null),O.flags|=2,E.return=g,O.return=g,E.sibling=O,g.child=E,g.mode&1&&yc(g,p.child,null,X),g.child.memoizedState=fb(X),g.memoizedState=db,O);if(!(g.mode&1))return Gm(p,g,X,null);if(Pr(_))return E=Fa(_).digest,O=Error(s(419)),E=ob(O,E,void 0),Gm(p,g,X,E);if(C=(X&p.childLanes)!==0,li||C){if(E=on,E!==null){switch(X&-X){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(E.suspendedLanes|X)?0:_,_!==0&&_!==O.retryLane&&(O.retryLane=_,$a(p,_),Wi(E,p,_,-1))}return Rb(),E=ob(Error(s(421))),Gm(p,g,X,E)}return wr(_)?(g.flags|=128,g.child=p.child,g=KL.bind(null,p),Sr(_,g),null):(p=O.treeContext,Z&&($i=hc(_),Ni=g,ir=!0,ya=null,Sf=!1,p!==null&&(zi[Vi++]=ks,zi[Vi++]=Cs,zi[Vi++]=ql,ks=p.id,Cs=p.overflow,ql=g)),g=hb(g,E.children),g.flags|=4096,g)}function PN(p,g,C){p.lanes|=g;var E=p.alternate;E!==null&&(E.lanes|=g),G1(p.return,g,C)}function pb(p,g,C,E,_){var O=p.memoizedState;O===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:E,tail:C,tailMode:_}:(O.isBackwards=g,O.rendering=null,O.renderingStartTime=0,O.last=E,O.tail=C,O.tailMode=_)}function _N(p,g,C){var E=g.pendingProps,_=E.revealOrder,O=E.tail;if(Xn(p,g,E.children,C),E=fr.current,E&2)E=E&1|2,g.flags|=128;else{if(p!==null&&p.flags&128)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&PN(p,C,g);else if(p.tag===19)PN(p,C,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}E&=1}if(vt(fr,E),!(g.mode&1))g.memoizedState=null;else switch(_){case"forwards":for(C=g.child,_=null;C!==null;)p=C.alternate,p!==null&&Lm(p)===null&&(_=C),C=C.sibling;C=_,C===null?(_=g.child,g.child=null):(_=C.sibling,C.sibling=null),pb(g,!1,_,C,O);break;case"backwards":for(C=null,_=g.child,g.child=null;_!==null;){if(p=_.alternate,p!==null&&Lm(p)===null){g.child=_;break}p=_.sibling,_.sibling=C,C=_,_=p}pb(g,!0,C,null,O);break;case"together":pb(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Hm(p,g){!(g.mode&1)&&p!==null&&(p.alternate=null,g.alternate=null,g.flags|=2)}function Es(p,g,C){if(p!==null&&(g.dependencies=p.dependencies),Ql|=g.lanes,!(C&g.childLanes))return null;if(p!==null&&g.child!==p.child)throw Error(s(153));if(g.child!==null){for(p=g.child,C=So(p,p.pendingProps),g.child=C,C.return=g;p.sibling!==null;)p=p.sibling,C=C.sibling=So(p,p.pendingProps),C.return=g;C.sibling=null}return g.child}function IL(p,g,C){switch(g.tag){case 3:TN(g),vc();break;case 5:H4(g);break;case 1:Yn(g.type)&&Sm(g);break;case 4:q1(g,g.stateNode.containerInfo);break;case 10:z4(g,g.type._context,g.memoizedProps.value);break;case 13:var E=g.memoizedState;if(E!==null)return E.dehydrated!==null?(vt(fr,fr.current&1),g.flags|=128,null):C&g.child.childLanes?MN(p,g,C):(vt(fr,fr.current&1),p=Es(p,g,C),p!==null?p.sibling:null);vt(fr,fr.current&1);break;case 19:if(E=(C&g.childLanes)!==0,p.flags&128){if(E)return _N(p,g,C);g.flags|=128}var _=g.memoizedState;if(_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),vt(fr,fr.current),E)break;return null;case 22:case 23:return g.lanes=0,CN(p,g,C)}return Es(p,g,C)}function Ha(p){p.flags|=4}function AN(p,g){if(p!==null&&p.child===g.child)return!0;if(g.flags&16)return!1;for(p=g.child;p!==null;){if(p.flags&12854||p.subtreeFlags&12854)return!1;p=p.sibling}return!0}var Pf,_f,Wm,qm;if(q)Pf=function(p,g){for(var C=g.child;C!==null;){if(C.tag===5||C.tag===6)G(p,C.stateNode);else if(C.tag!==4&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===g)break;for(;C.sibling===null;){if(C.return===null||C.return===g)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},_f=function(){},Wm=function(p,g,C,E,_){if(p=p.memoizedProps,p!==E){var O=g.stateNode,X=Ua(Gi.current);C=re(O,C,p,E,_,X),(g.updateQueue=C)&&Ha(g)}},qm=function(p,g,C,E){C!==E&&Ha(g)};else if(te){Pf=function(p,g,C,E){for(var _=g.child;_!==null;){if(_.tag===5){var O=_.stateNode;C&&E&&(O=Kt(O,_.type,_.memoizedProps,_)),G(p,O)}else if(_.tag===6)O=_.stateNode,C&&E&&(O=Ot(O,_.memoizedProps,_)),G(p,O);else if(_.tag!==4){if(_.tag===22&&_.memoizedState!==null)O=_.child,O!==null&&(O.return=_),Pf(p,_,!0,!0);else if(_.child!==null){_.child.return=_,_=_.child;continue}}if(_===g)break;for(;_.sibling===null;){if(_.return===null||_.return===g)return;_=_.return}_.sibling.return=_.return,_=_.sibling}};var RN=function(p,g,C,E){for(var _=g.child;_!==null;){if(_.tag===5){var O=_.stateNode;C&&E&&(O=Kt(O,_.type,_.memoizedProps,_)),Le(p,O)}else if(_.tag===6)O=_.stateNode,C&&E&&(O=Ot(O,_.memoizedProps,_)),Le(p,O);else if(_.tag!==4){if(_.tag===22&&_.memoizedState!==null)O=_.child,O!==null&&(O.return=_),RN(p,_,!0,!0);else if(_.child!==null){_.child.return=_,_=_.child;continue}}if(_===g)break;for(;_.sibling===null;){if(_.return===null||_.return===g)return;_=_.return}_.sibling.return=_.return,_=_.sibling}};_f=function(p,g){var C=g.stateNode;if(!AN(p,g)){p=C.containerInfo;var E=tt(p);RN(E,g,!1,!1),C.pendingChildren=E,Ha(g),nt(p,E)}},Wm=function(p,g,C,E,_){var O=p.stateNode,X=p.memoizedProps;if((p=AN(p,g))&&X===E)g.stateNode=O;else{var oe=g.stateNode,pe=Ua(Gi.current),ke=null;X!==E&&(ke=re(oe,C,X,E,_,pe)),p&&ke===null?g.stateNode=O:(O=et(O,ke,C,X,E,g,p,oe),ee(O,C,E,_,pe)&&Ha(g),g.stateNode=O,p?Ha(g):Pf(O,g,!1,!1))}},qm=function(p,g,C,E){C!==E?(p=Ua(wc.current),C=Ua(Gi.current),g.stateNode=de(E,p,C,g),Ha(g)):g.stateNode=p.stateNode}}else _f=function(){},Wm=function(){},qm=function(){};function Af(p,g){if(!ir)switch(p.tailMode){case"hidden":g=p.tail;for(var C=null;g!==null;)g.alternate!==null&&(C=g),g=g.sibling;C===null?p.tail=null:C.sibling=null;break;case"collapsed":C=p.tail;for(var E=null;C!==null;)C.alternate!==null&&(E=C),C=C.sibling;E===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:E.sibling=null}}function On(p){var g=p.alternate!==null&&p.alternate.child===p.child,C=0,E=0;if(g)for(var _=p.child;_!==null;)C|=_.lanes|_.childLanes,E|=_.subtreeFlags&14680064,E|=_.flags&14680064,_.return=p,_=_.sibling;else for(_=p.child;_!==null;)C|=_.lanes|_.childLanes,E|=_.subtreeFlags,E|=_.flags,_.return=p,_=_.sibling;return p.subtreeFlags|=E,p.childLanes=C,g}function LL(p,g,C){var E=g.pendingProps;switch(L1(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return On(g),null;case 1:return Yn(g.type)&&pc(),On(g),null;case 3:return C=g.stateNode,Sc(),$t(Lr),$t(Gr),X1(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(p===null||p.child===null)&&(Pm(g)?Ha(g):p===null||p.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,ya!==null&&(_b(ya),ya=null))),_f(p,g),On(g),null;case 5:K1(g),C=Ua(wc.current);var _=g.type;if(p!==null&&g.stateNode!=null)Wm(p,g,_,E,C),p.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!E){if(g.stateNode===null)throw Error(s(166));return On(g),null}if(p=Ua(Gi.current),Pm(g)){if(!Z)throw Error(s(175));p=xs(g.stateNode,g.type,g.memoizedProps,C,p,g,!Sf),g.updateQueue=p,p!==null&&Ha(g)}else{var O=L(_,E,C,p,g);Pf(O,g,!1,!1),g.stateNode=O,ee(O,_,E,C,p)&&Ha(g)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return On(g),null;case 6:if(p&&g.stateNode!=null)qm(p,g,p.memoizedProps,E);else{if(typeof E!="string"&&g.stateNode===null)throw Error(s(166));if(p=Ua(wc.current),C=Ua(Gi.current),Pm(g)){if(!Z)throw Error(s(176));if(p=g.stateNode,C=g.memoizedProps,(E=An(p,C,g,!Sf))&&(_=Ni,_!==null))switch(_.tag){case 3:T1(_.stateNode.containerInfo,p,C,(_.mode&1)!==0);break;case 5:j1(_.type,_.memoizedProps,_.stateNode,p,C,(_.mode&1)!==0)}E&&Ha(g)}else g.stateNode=de(E,p,C,g)}return On(g),null;case 13:if($t(fr),E=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(ir&&$i!==null&&g.mode&1&&!(g.flags&128))I4(),vc(),g.flags|=98560,_=!1;else if(_=Pm(g),E!==null&&E.dehydrated!==null){if(p===null){if(!_)throw Error(s(318));if(!Z)throw Error(s(344));if(_=g.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(s(317));nn(_,g)}else vc(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;On(g),_=!1}else ya!==null&&(_b(ya),ya=null),_=!0;if(!_)return g.flags&65536?g:null}return g.flags&128?(g.lanes=C,g):(C=E!==null,C!==(p!==null&&p.memoizedState!==null)&&C&&(g.child.flags|=8192,g.mode&1&&(p===null||fr.current&1?qr===0&&(qr=3):Rb())),g.updateQueue!==null&&(g.flags|=4),On(g),null);case 4:return Sc(),_f(p,g),p===null&&ge(g.stateNode.containerInfo),On(g),null;case 10:return U1(g.type._context),On(g),null;case 17:return Yn(g.type)&&pc(),On(g),null;case 19:if($t(fr),_=g.memoizedState,_===null)return On(g),null;if(E=(g.flags&128)!==0,O=_.rendering,O===null)if(E)Af(_,!1);else{if(qr!==0||p!==null&&p.flags&128)for(p=g.child;p!==null;){if(O=Lm(p),O!==null){for(g.flags|=128,Af(_,!1),p=O.updateQueue,p!==null&&(g.updateQueue=p,g.flags|=4),g.subtreeFlags=0,p=C,C=g.child;C!==null;)E=C,_=p,E.flags&=14680066,O=E.alternate,O===null?(E.childLanes=0,E.lanes=_,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=O.childLanes,E.lanes=O.lanes,E.child=O.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=O.memoizedProps,E.memoizedState=O.memoizedState,E.updateQueue=O.updateQueue,E.type=O.type,_=O.dependencies,E.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),C=C.sibling;return vt(fr,fr.current&1|2),g.child}p=p.sibling}_.tail!==null&&an()>Tb&&(g.flags|=128,E=!0,Af(_,!1),g.lanes=4194304)}else{if(!E)if(p=Lm(O),p!==null){if(g.flags|=128,E=!0,p=p.updateQueue,p!==null&&(g.updateQueue=p,g.flags|=4),Af(_,!0),_.tail===null&&_.tailMode==="hidden"&&!O.alternate&&!ir)return On(g),null}else 2*an()-_.renderingStartTime>Tb&&C!==1073741824&&(g.flags|=128,E=!0,Af(_,!1),g.lanes=4194304);_.isBackwards?(O.sibling=g.child,g.child=O):(p=_.last,p!==null?p.sibling=O:g.child=O,_.last=O)}return _.tail!==null?(g=_.tail,_.rendering=g,_.tail=g.sibling,_.renderingStartTime=an(),g.sibling=null,p=fr.current,vt(fr,E?p&1|2:p&1),g):(On(g),null);case 22:case 23:return Ab(),C=g.memoizedState!==null,p!==null&&p.memoizedState!==null!==C&&(g.flags|=8192),C&&g.mode&1?Ei&1073741824&&(On(g),q&&g.subtreeFlags&6&&(g.flags|=8192)):On(g),null;case 24:return null;case 25:return null}throw Error(s(156,g.tag))}function BL(p,g){switch(L1(g),g.tag){case 1:return Yn(g.type)&&pc(),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return Sc(),$t(Lr),$t(Gr),X1(),p=g.flags,p&65536&&!(p&128)?(g.flags=p&-65537|128,g):null;case 5:return K1(g),null;case 13:if($t(fr),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(s(340));vc()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return $t(fr),null;case 4:return Sc(),null;case 10:return U1(g.type._context),null;case 22:case 23:return Ab(),null;case 24:return null;default:return null}}var Km=!1,In=!1,FL=typeof WeakSet=="function"?WeakSet:Set,Be=null;function Cc(p,g){var C=p.ref;if(C!==null)if(typeof C=="function")try{C(null)}catch(E){ar(p,g,E)}else C.current=null}function mb(p,g,C){try{C()}catch(E){ar(p,g,E)}}var DN=!1;function zL(p,g){for(J(p.containerInfo),Be=g;Be!==null;)if(p=Be,g=p.child,(p.subtreeFlags&1028)!==0&&g!==null)g.return=p,Be=g;else for(;Be!==null;){p=Be;try{var C=p.alternate;if(p.flags&1024)switch(p.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var E=C.memoizedProps,_=C.memoizedState,O=p.stateNode,X=O.getSnapshotBeforeUpdate(p.elementType===p.type?E:xa(p.type,E),_);O.__reactInternalSnapshotBeforeUpdate=X}break;case 3:q&&He(p.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(oe){ar(p,p.return,oe)}if(g=p.sibling,g!==null){g.return=p.return,Be=g;break}Be=p.return}return C=DN,DN=!1,C}function Rf(p,g,C){var E=g.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var _=E=E.next;do{if((_.tag&p)===p){var O=_.destroy;_.destroy=void 0,O!==void 0&&mb(g,C,O)}_=_.next}while(_!==E)}}function Ym(p,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var C=g=g.next;do{if((C.tag&p)===p){var E=C.create;C.destroy=E()}C=C.next}while(C!==g)}}function gb(p){var g=p.ref;if(g!==null){var C=p.stateNode;switch(p.tag){case 5:p=z(C);break;default:p=C}typeof g=="function"?g(p):g.current=p}}function ON(p){var g=p.alternate;g!==null&&(p.alternate=null,ON(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&Te(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}function IN(p){return p.tag===5||p.tag===3||p.tag===4}function LN(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||IN(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function vb(p,g,C){var E=p.tag;if(E===5||E===6)p=p.stateNode,g?Q(C,p,g):Nt(C,p);else if(E!==4&&(p=p.child,p!==null))for(vb(p,g,C),p=p.sibling;p!==null;)vb(p,g,C),p=p.sibling}function yb(p,g,C){var E=p.tag;if(E===5||E===6)p=p.stateNode,g?H(C,p,g):bt(C,p);else if(E!==4&&(p=p.child,p!==null))for(yb(p,g,C),p=p.sibling;p!==null;)yb(p,g,C),p=p.sibling}var xn=null,ba=!1;function Wa(p,g,C){for(C=C.child;C!==null;)xb(p,g,C),C=C.sibling}function xb(p,g,C){if(za&&typeof za.onCommitFiberUnmount=="function")try{za.onCommitFiberUnmount(Em,C)}catch{}switch(C.tag){case 5:In||Cc(C,g);case 6:if(q){var E=xn,_=ba;xn=null,Wa(p,g,C),xn=E,ba=_,xn!==null&&(ba?ue(xn,C.stateNode):ae(xn,C.stateNode))}else Wa(p,g,C);break;case 18:q&&xn!==null&&(ba?N1(xn,C.stateNode):wm(xn,C.stateNode));break;case 4:q?(E=xn,_=ba,xn=C.stateNode.containerInfo,ba=!0,Wa(p,g,C),xn=E,ba=_):(te&&(E=C.stateNode.containerInfo,_=tt(E),st(E,_)),Wa(p,g,C));break;case 0:case 11:case 14:case 15:if(!In&&(E=C.updateQueue,E!==null&&(E=E.lastEffect,E!==null))){_=E=E.next;do{var O=_,X=O.destroy;O=O.tag,X!==void 0&&(O&2||O&4)&&mb(C,g,X),_=_.next}while(_!==E)}Wa(p,g,C);break;case 1:if(!In&&(Cc(C,g),E=C.stateNode,typeof E.componentWillUnmount=="function"))try{E.props=C.memoizedProps,E.state=C.memoizedState,E.componentWillUnmount()}catch(oe){ar(C,g,oe)}Wa(p,g,C);break;case 21:Wa(p,g,C);break;case 22:C.mode&1?(In=(E=In)||C.memoizedState!==null,Wa(p,g,C),In=E):Wa(p,g,C);break;default:Wa(p,g,C)}}function BN(p){var g=p.updateQueue;if(g!==null){p.updateQueue=null;var C=p.stateNode;C===null&&(C=p.stateNode=new FL),g.forEach(function(E){var _=YL.bind(null,p,E);C.has(E)||(C.add(E),E.then(_,_))})}}function wa(p,g){var C=g.deletions;if(C!==null)for(var E=0;E<C.length;E++){var _=C[E];try{var O=p,X=g;if(q){var oe=X;e:for(;oe!==null;){switch(oe.tag){case 5:xn=oe.stateNode,ba=!1;break e;case 3:xn=oe.stateNode.containerInfo,ba=!0;break e;case 4:xn=oe.stateNode.containerInfo,ba=!0;break e}oe=oe.return}if(xn===null)throw Error(s(160));xb(O,X,_),xn=null,ba=!1}else xb(O,X,_);var pe=_.alternate;pe!==null&&(pe.return=null),_.return=null}catch(ke){ar(_,g,ke)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)FN(g,p),g=g.sibling}function FN(p,g){var C=p.alternate,E=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:if(wa(g,p),qa(p),E&4){try{Rf(3,p,p.return),Ym(3,p)}catch(Pe){ar(p,p.return,Pe)}try{Rf(5,p,p.return)}catch(Pe){ar(p,p.return,Pe)}}break;case 1:wa(g,p),qa(p),E&512&&C!==null&&Cc(C,C.return);break;case 5:if(wa(g,p),qa(p),E&512&&C!==null&&Cc(C,C.return),q){if(p.flags&32){var _=p.stateNode;try{fe(_)}catch(Pe){ar(p,p.return,Pe)}}if(E&4&&(_=p.stateNode,_!=null)){var O=p.memoizedProps;if(C=C!==null?C.memoizedProps:O,E=p.type,g=p.updateQueue,p.updateQueue=null,g!==null)try{ve(_,g,E,C,O,p)}catch(Pe){ar(p,p.return,Pe)}}}break;case 6:if(wa(g,p),qa(p),E&4&&q){if(p.stateNode===null)throw Error(s(162));_=p.stateNode,O=p.memoizedProps,C=C!==null?C.memoizedProps:O;try{Je(_,C,O)}catch(Pe){ar(p,p.return,Pe)}}break;case 3:if(wa(g,p),qa(p),E&4){if(q&&Z&&C!==null&&C.memoizedState.isDehydrated)try{Hl(g.containerInfo)}catch(Pe){ar(p,p.return,Pe)}if(te){_=g.containerInfo,O=g.pendingChildren;try{st(_,O)}catch(Pe){ar(p,p.return,Pe)}}}break;case 4:if(wa(g,p),qa(p),E&4&&te){O=p.stateNode,_=O.containerInfo,O=O.pendingChildren;try{st(_,O)}catch(Pe){ar(p,p.return,Pe)}}break;case 13:wa(g,p),qa(p),_=p.child,_.flags&8192&&(O=_.memoizedState!==null,_.stateNode.isHidden=O,!O||_.alternate!==null&&_.alternate.memoizedState!==null||(Eb=an())),E&4&&BN(p);break;case 22:var X=C!==null&&C.memoizedState!==null;if(p.mode&1?(In=(C=In)||X,wa(g,p),In=C):wa(g,p),qa(p),E&8192){if(C=p.memoizedState!==null,(p.stateNode.isHidden=C)&&!X&&p.mode&1)for(Be=p,E=p.child;E!==null;){for(g=Be=E;Be!==null;){X=Be;var oe=X.child;switch(X.tag){case 0:case 11:case 14:case 15:Rf(4,X,X.return);break;case 1:Cc(X,X.return);var pe=X.stateNode;if(typeof pe.componentWillUnmount=="function"){var ke=X,$e=X.return;try{var ot=ke;pe.props=ot.memoizedProps,pe.state=ot.memoizedState,pe.componentWillUnmount()}catch(Pe){ar(ke,$e,Pe)}}break;case 5:Cc(X,X.return);break;case 22:if(X.memoizedState!==null){$N(g);continue}}oe!==null?(oe.return=X,Be=oe):$N(g)}E=E.sibling}if(q){e:if(E=null,q)for(g=p;;){if(g.tag===5){if(E===null){E=g;try{_=g.stateNode,C?xe(_):je(g.stateNode,g.memoizedProps)}catch(Pe){ar(p,p.return,Pe)}}}else if(g.tag===6){if(E===null)try{O=g.stateNode,C?ye(O):Me(O,g.memoizedProps)}catch(Pe){ar(p,p.return,Pe)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;E===g&&(E=null),g=g.return}E===g&&(E=null),g.sibling.return=g.return,g=g.sibling}}}break;case 19:wa(g,p),qa(p),E&4&&BN(p);break;case 21:break;default:wa(g,p),qa(p)}}function qa(p){var g=p.flags;if(g&2){try{if(q){e:{for(var C=p.return;C!==null;){if(IN(C)){var E=C;break e}C=C.return}throw Error(s(160))}switch(E.tag){case 5:var _=E.stateNode;E.flags&32&&(fe(_),E.flags&=-33);var O=LN(p);yb(p,O,_);break;case 3:case 4:var X=E.stateNode.containerInfo,oe=LN(p);vb(p,oe,X);break;default:throw Error(s(161))}}}catch(pe){ar(p,p.return,pe)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function VL(p,g,C){Be=p,zN(p)}function zN(p,g,C){for(var E=(p.mode&1)!==0;Be!==null;){var _=Be,O=_.child;if(_.tag===22&&E){var X=_.memoizedState!==null||Km;if(!X){var oe=_.alternate,pe=oe!==null&&oe.memoizedState!==null||In;oe=Km;var ke=In;if(Km=X,(In=pe)&&!ke)for(Be=_;Be!==null;)X=Be,pe=X.child,X.tag===22&&X.memoizedState!==null?UN(_):pe!==null?(pe.return=X,Be=pe):UN(_);for(;O!==null;)Be=O,zN(O),O=O.sibling;Be=_,Km=oe,In=ke}VN(p)}else _.subtreeFlags&8772&&O!==null?(O.return=_,Be=O):VN(p)}}function VN(p){for(;Be!==null;){var g=Be;if(g.flags&8772){var C=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:In||Ym(5,g);break;case 1:var E=g.stateNode;if(g.flags&4&&!In)if(C===null)E.componentDidMount();else{var _=g.elementType===g.type?C.memoizedProps:xa(g.type,C.memoizedProps);E.componentDidUpdate(_,C.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var O=g.updateQueue;O!==null&&G4(g,O,E);break;case 3:var X=g.updateQueue;if(X!==null){if(C=null,g.child!==null)switch(g.child.tag){case 5:C=z(g.child.stateNode);break;case 1:C=g.child.stateNode}G4(g,X,C)}break;case 5:var oe=g.stateNode;C===null&&g.flags&4&&Oe(oe,g.type,g.memoizedProps,g);break;case 6:break;case 4:break;case 12:break;case 13:if(Z&&g.memoizedState===null){var pe=g.alternate;if(pe!==null){var ke=pe.memoizedState;if(ke!==null){var $e=ke.dehydrated;$e!==null&&oi($e)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}In||g.flags&512&&gb(g)}catch(ot){ar(g,g.return,ot)}}if(g===p){Be=null;break}if(C=g.sibling,C!==null){C.return=g.return,Be=C;break}Be=g.return}}function $N(p){for(;Be!==null;){var g=Be;if(g===p){Be=null;break}var C=g.sibling;if(C!==null){C.return=g.return,Be=C;break}Be=g.return}}function UN(p){for(;Be!==null;){var g=Be;try{switch(g.tag){case 0:case 11:case 15:var C=g.return;try{Ym(4,g)}catch(pe){ar(g,C,pe)}break;case 1:var E=g.stateNode;if(typeof E.componentDidMount=="function"){var _=g.return;try{E.componentDidMount()}catch(pe){ar(g,_,pe)}}var O=g.return;try{gb(g)}catch(pe){ar(g,O,pe)}break;case 5:var X=g.return;try{gb(g)}catch(pe){ar(g,X,pe)}}}catch(pe){ar(g,g.return,pe)}if(g===p){Be=null;break}var oe=g.sibling;if(oe!==null){oe.return=g.return,Be=oe;break}Be=g.return}}var Xm=0,Qm=1,Jm=2,Zm=3,eg=4;if(typeof Symbol=="function"&&Symbol.for){var Df=Symbol.for;Xm=Df("selector.component"),Qm=Df("selector.has_pseudo_class"),Jm=Df("selector.role"),Zm=Df("selector.test_id"),eg=Df("selector.text")}function bb(p){var g=le(p);if(g!=null){if(typeof g.memoizedProps["data-testname"]!="string")throw Error(s(364));return g}if(p=De(p),p===null)throw Error(s(362));return p.stateNode.current}function wb(p,g){switch(g.$$typeof){case Xm:if(p.type===g.value)return!0;break;case Qm:e:{g=g.value,p=[p,0];for(var C=0;C<p.length;){var E=p[C++],_=p[C++],O=g[_];if(E.tag!==5||!Ie(E)){for(;O!=null&&wb(E,O);)_++,O=g[_];if(_===g.length){g=!0;break e}else for(E=E.child;E!==null;)p.push(E,_),E=E.sibling}}g=!1}return g;case Jm:if(p.tag===5&&rt(p.stateNode,g.value))return!0;break;case eg:if((p.tag===5||p.tag===6)&&(p=We(p),p!==null&&0<=p.indexOf(g.value)))return!0;break;case Zm:if(p.tag===5&&(p=p.memoizedProps["data-testname"],typeof p=="string"&&p.toLowerCase()===g.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function Sb(p){switch(p.$$typeof){case Xm:return"<"+(j(p.value)||"Unknown")+">";case Qm:return":has("+(Sb(p)||"")+")";case Jm:return'[role="'+p.value+'"]';case eg:return'"'+p.value+'"';case Zm:return'[data-testname="'+p.value+'"]';default:throw Error(s(365))}}function GN(p,g){var C=[];p=[p,0];for(var E=0;E<p.length;){var _=p[E++],O=p[E++],X=g[O];if(_.tag!==5||!Ie(_)){for(;X!=null&&wb(_,X);)O++,X=g[O];if(O===g.length)C.push(_);else for(_=_.child;_!==null;)p.push(_,O),_=_.sibling}}return C}function kb(p,g){if(!Ce)throw Error(s(363));p=bb(p),p=GN(p,g),g=[],p=Array.from(p);for(var C=0;C<p.length;){var E=p[C++];if(E.tag===5)Ie(E)||g.push(E.stateNode);else for(E=E.child;E!==null;)p.push(E),E=E.sibling}return g}var $L=Math.ceil,tg=o.ReactCurrentDispatcher,Cb=o.ReactCurrentOwner,_r=o.ReactCurrentBatchConfig,yt=0,on=null,Br=null,bn=0,Ei=0,Nc=ma(0),qr=0,Of=null,Ql=0,rg=0,Nb=0,If=null,ui=null,Eb=0,Tb=1/0,Ts=null;function Ec(){Tb=an()+500}var ng=!1,jb=null,yo=null,ig=!1,xo=null,ag=0,Lf=0,Mb=null,sg=-1,og=0;function Ln(){return yt&6?an():sg!==-1?sg:sg=an()}function bo(p){return p.mode&1?yt&2&&bn!==0?bn&-bn:CL.transition!==null?(og===0&&(og=j4()),og):(p=Pt,p!==0?p:Ue()):1}function Wi(p,g,C,E){if(50<Lf)throw Lf=0,Mb=null,Error(s(185));wf(p,C,E),(!(yt&2)||p!==on)&&(p===on&&(!(yt&2)&&(rg|=C),qr===4&&wo(p,bn)),ci(p,E),C===1&&yt===0&&!(g.mode&1)&&(Ec(),Tm&&Va()))}function ci(p,g){var C=p.callbackNode;mL(p,g);var E=Nm(p,p===on?bn:0);if(E===0)C!==null&&P4(C),p.callbackNode=null,p.callbackPriority=0;else if(g=E&-E,p.callbackPriority!==g){if(C!=null&&P4(C),g===1)p.tag===0?kL(WN.bind(null,p)):_4(WN.bind(null,p)),Re?Ge(function(){!(yt&6)&&Va()}):A1(R1,Va),C=null;else{switch(M4(E)){case 1:C=R1;break;case 4:C=xL;break;case 16:C=D1;break;case 536870912:C=bL;break;default:C=D1}C=tE(C,HN.bind(null,p))}p.callbackPriority=g,p.callbackNode=C}}function HN(p,g){if(sg=-1,og=0,yt&6)throw Error(s(327));var C=p.callbackNode;if(eu()&&p.callbackNode!==C)return null;var E=Nm(p,p===on?bn:0);if(E===0)return null;if(E&30||E&p.expiredLanes||g)g=lg(p,E);else{g=E;var _=yt;yt|=2;var O=YN();(on!==p||bn!==g)&&(Ts=null,Ec(),Jl(p,g));do try{HL();break}catch(oe){KN(p,oe)}while(1);$1(),tg.current=O,yt=_,Br!==null?g=0:(on=null,bn=0,g=qr)}if(g!==0){if(g===2&&(_=M1(p),_!==0&&(E=_,g=Pb(p,_))),g===1)throw C=Of,Jl(p,0),wo(p,E),ci(p,an()),C;if(g===6)wo(p,E);else{if(_=p.current.alternate,!(E&30)&&!UL(_)&&(g=lg(p,E),g===2&&(O=M1(p),O!==0&&(E=O,g=Pb(p,O))),g===1))throw C=Of,Jl(p,0),wo(p,E),ci(p,an()),C;switch(p.finishedWork=_,p.finishedLanes=E,g){case 0:case 1:throw Error(s(345));case 2:Zl(p,ui,Ts);break;case 3:if(wo(p,E),(E&130023424)===E&&(g=Eb+500-an(),10<g)){if(Nm(p,0)!==0)break;if(_=p.suspendedLanes,(_&E)!==E){Ln(),p.pingedLanes|=p.suspendedLanes&_;break}p.timeoutHandle=W(Zl.bind(null,p,ui,Ts),g);break}Zl(p,ui,Ts);break;case 4:if(wo(p,E),(E&4194240)===E)break;for(g=p.eventTimes,_=-1;0<E;){var X=31-ga(E);O=1<<X,X=g[X],X>_&&(_=X),E&=~O}if(E=_,E=an()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*$L(E/1960))-E,10<E){p.timeoutHandle=W(Zl.bind(null,p,ui,Ts),E);break}Zl(p,ui,Ts);break;case 5:Zl(p,ui,Ts);break;default:throw Error(s(329))}}}return ci(p,an()),p.callbackNode===C?HN.bind(null,p):null}function Pb(p,g){var C=If;return p.current.memoizedState.isDehydrated&&(Jl(p,g).flags|=256),p=lg(p,g),p!==2&&(g=ui,ui=C,g!==null&&_b(g)),p}function _b(p){ui===null?ui=p:ui.push.apply(ui,p)}function UL(p){for(var g=p;;){if(g.flags&16384){var C=g.updateQueue;if(C!==null&&(C=C.stores,C!==null))for(var E=0;E<C.length;E++){var _=C[E],O=_.getSnapshot;_=_.value;try{if(!va(O(),_))return!1}catch{return!1}}}if(C=g.child,g.subtreeFlags&16384&&C!==null)C.return=g,g=C;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function wo(p,g){for(g&=~Nb,g&=~rg,p.suspendedLanes|=g,p.pingedLanes&=~g,p=p.expirationTimes;0<g;){var C=31-ga(g),E=1<<C;p[C]=-1,g&=~E}}function WN(p){if(yt&6)throw Error(s(327));eu();var g=Nm(p,0);if(!(g&1))return ci(p,an()),null;var C=lg(p,g);if(p.tag!==0&&C===2){var E=M1(p);E!==0&&(g=E,C=Pb(p,E))}if(C===1)throw C=Of,Jl(p,0),wo(p,g),ci(p,an()),C;if(C===6)throw Error(s(345));return p.finishedWork=p.current.alternate,p.finishedLanes=g,Zl(p,ui,Ts),ci(p,an()),null}function qN(p){xo!==null&&xo.tag===0&&!(yt&6)&&eu();var g=yt;yt|=1;var C=_r.transition,E=Pt;try{if(_r.transition=null,Pt=1,p)return p()}finally{Pt=E,_r.transition=C,yt=g,!(yt&6)&&Va()}}function Ab(){Ei=Nc.current,$t(Nc)}function Jl(p,g){p.finishedWork=null,p.finishedLanes=0;var C=p.timeoutHandle;if(C!==ie&&(p.timeoutHandle=ie,ne(C)),Br!==null)for(C=Br.return;C!==null;){var E=C;switch(L1(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&pc();break;case 3:Sc(),$t(Lr),$t(Gr),X1();break;case 5:K1(E);break;case 4:Sc();break;case 13:$t(fr);break;case 19:$t(fr);break;case 10:U1(E.type._context);break;case 22:case 23:Ab()}C=C.return}if(on=p,Br=p=So(p.current,null),bn=Ei=g,qr=0,Of=null,Nb=rg=Ql=0,ui=If=null,Yl!==null){for(g=0;g<Yl.length;g++)if(C=Yl[g],E=C.interleaved,E!==null){C.interleaved=null;var _=E.next,O=C.pending;if(O!==null){var X=O.next;O.next=_,E.next=X}C.pending=E}Yl=null}return p}function KN(p,g){do{var C=Br;try{if($1(),Bm.current=$m,Fm){for(var E=hr.memoizedState;E!==null;){var _=E.queue;_!==null&&(_.pending=null),E=E.next}Fm=!1}if(Xl=0,sn=Wr=hr=null,Ef=!1,Tf=0,Cb.current=null,C===null||C.return===null){qr=1,Of=g,Br=null;break}e:{var O=p,X=C.return,oe=C,pe=g;if(g=bn,oe.flags|=32768,pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var ke=pe,$e=oe,ot=$e.tag;if(!($e.mode&1)&&(ot===0||ot===11||ot===15)){var Pe=$e.alternate;Pe?($e.updateQueue=Pe.updateQueue,$e.memoizedState=Pe.memoizedState,$e.lanes=Pe.lanes):($e.updateQueue=null,$e.memoizedState=null)}var Jt=xN(X);if(Jt!==null){Jt.flags&=-257,bN(Jt,X,oe,O,g),Jt.mode&1&&yN(O,ke,g),g=Jt,pe=ke;var Ut=g.updateQueue;if(Ut===null){var di=new Set;di.add(pe),g.updateQueue=di}else Ut.add(pe);break e}else{if(!(g&1)){yN(O,ke,g),Rb();break e}pe=Error(s(426))}}else if(ir&&oe.mode&1){var js=xN(X);if(js!==null){!(js.flags&65536)&&(js.flags|=256),bN(js,X,oe,O,g),z1(kc(pe,oe));break e}}O=pe=kc(pe,oe),qr!==4&&(qr=2),If===null?If=[O]:If.push(O),O=X;do{switch(O.tag){case 3:O.flags|=65536,g&=-g,O.lanes|=g;var he=gN(O,pe,g);U4(O,he);break e;case 1:oe=pe;var ce=O.type,me=O.stateNode;if(!(O.flags&128)&&(typeof ce.getDerivedStateFromError=="function"||me!==null&&typeof me.componentDidCatch=="function"&&(yo===null||!yo.has(me)))){O.flags|=65536,g&=-g,O.lanes|=g;var _e=vN(O,oe,g);U4(O,_e);break e}}O=O.return}while(O!==null)}QN(C)}catch(Xe){g=Xe,Br===C&&C!==null&&(Br=C=C.return);continue}break}while(1)}function YN(){var p=tg.current;return tg.current=$m,p===null?$m:p}function Rb(){(qr===0||qr===3||qr===2)&&(qr=4),on===null||!(Ql&268435455)&&!(rg&268435455)||wo(on,bn)}function lg(p,g){var C=yt;yt|=2;var E=YN();(on!==p||bn!==g)&&(Ts=null,Jl(p,g));do try{GL();break}catch(_){KN(p,_)}while(1);if($1(),yt=C,tg.current=E,Br!==null)throw Error(s(261));return on=null,bn=0,qr}function GL(){for(;Br!==null;)XN(Br)}function HL(){for(;Br!==null&&!vL();)XN(Br)}function XN(p){var g=eE(p.alternate,p,Ei);p.memoizedProps=p.pendingProps,g===null?QN(p):Br=g,Cb.current=null}function QN(p){var g=p;do{var C=g.alternate;if(p=g.return,g.flags&32768){if(C=BL(C,g),C!==null){C.flags&=32767,Br=C;return}if(p!==null)p.flags|=32768,p.subtreeFlags=0,p.deletions=null;else{qr=6,Br=null;return}}else if(C=LL(C,g,Ei),C!==null){Br=C;return}if(g=g.sibling,g!==null){Br=g;return}Br=g=p}while(g!==null);qr===0&&(qr=5)}function Zl(p,g,C){var E=Pt,_=_r.transition;try{_r.transition=null,Pt=1,WL(p,g,C,E)}finally{_r.transition=_,Pt=E}return null}function WL(p,g,C,E){do eu();while(xo!==null);if(yt&6)throw Error(s(327));C=p.finishedWork;var _=p.finishedLanes;if(C===null)return null;if(p.finishedWork=null,p.finishedLanes=0,C===p.current)throw Error(s(177));p.callbackNode=null,p.callbackPriority=0;var O=C.lanes|C.childLanes;if(gL(p,O),p===on&&(Br=on=null,bn=0),!(C.subtreeFlags&2064)&&!(C.flags&2064)||ig||(ig=!0,tE(D1,function(){return eu(),null})),O=(C.flags&15990)!==0,C.subtreeFlags&15990||O){O=_r.transition,_r.transition=null;var X=Pt;Pt=1;var oe=yt;yt|=4,Cb.current=null,zL(p,C),FN(C,p),Y(p.containerInfo),p.current=C,VL(C),yL(),yt=oe,Pt=X,_r.transition=O}else p.current=C;if(ig&&(ig=!1,xo=p,ag=_),O=p.pendingLanes,O===0&&(yo=null),wL(C.stateNode),ci(p,an()),g!==null)for(E=p.onRecoverableError,C=0;C<g.length;C++)_=g[C],E(_.value,{componentStack:_.stack,digest:_.digest});if(ng)throw ng=!1,p=jb,jb=null,p;return ag&1&&p.tag!==0&&eu(),O=p.pendingLanes,O&1?p===Mb?Lf++:(Lf=0,Mb=p):Lf=0,Va(),null}function eu(){if(xo!==null){var p=M4(ag),g=_r.transition,C=Pt;try{if(_r.transition=null,Pt=16>p?16:p,xo===null)var E=!1;else{if(p=xo,xo=null,ag=0,yt&6)throw Error(s(331));var _=yt;for(yt|=4,Be=p.current;Be!==null;){var O=Be,X=O.child;if(Be.flags&16){var oe=O.deletions;if(oe!==null){for(var pe=0;pe<oe.length;pe++){var ke=oe[pe];for(Be=ke;Be!==null;){var $e=Be;switch($e.tag){case 0:case 11:case 15:Rf(8,$e,O)}var ot=$e.child;if(ot!==null)ot.return=$e,Be=ot;else for(;Be!==null;){$e=Be;var Pe=$e.sibling,Jt=$e.return;if(ON($e),$e===ke){Be=null;break}if(Pe!==null){Pe.return=Jt,Be=Pe;break}Be=Jt}}}var Ut=O.alternate;if(Ut!==null){var di=Ut.child;if(di!==null){Ut.child=null;do{var js=di.sibling;di.sibling=null,di=js}while(di!==null)}}Be=O}}if(O.subtreeFlags&2064&&X!==null)X.return=O,Be=X;else e:for(;Be!==null;){if(O=Be,O.flags&2048)switch(O.tag){case 0:case 11:case 15:Rf(9,O,O.return)}var he=O.sibling;if(he!==null){he.return=O.return,Be=he;break e}Be=O.return}}var ce=p.current;for(Be=ce;Be!==null;){X=Be;var me=X.child;if(X.subtreeFlags&2064&&me!==null)me.return=X,Be=me;else e:for(X=ce;Be!==null;){if(oe=Be,oe.flags&2048)try{switch(oe.tag){case 0:case 11:case 15:Ym(9,oe)}}catch(Xe){ar(oe,oe.return,Xe)}if(oe===X){Be=null;break e}var _e=oe.sibling;if(_e!==null){_e.return=oe.return,Be=_e;break e}Be=oe.return}}if(yt=_,Va(),za&&typeof za.onPostCommitFiberRoot=="function")try{za.onPostCommitFiberRoot(Em,p)}catch{}E=!0}return E}finally{Pt=C,_r.transition=g}}return!1}function JN(p,g,C){g=kc(C,g),g=gN(p,g,1),p=vo(p,g,1),g=Ln(),p!==null&&(wf(p,1,g),ci(p,g))}function ar(p,g,C){if(p.tag===3)JN(p,p,C);else for(;g!==null;){if(g.tag===3){JN(g,p,C);break}else if(g.tag===1){var E=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(yo===null||!yo.has(E))){p=kc(C,p),p=vN(g,p,1),g=vo(g,p,1),p=Ln(),g!==null&&(wf(g,1,p),ci(g,p));break}}g=g.return}}function qL(p,g,C){var E=p.pingCache;E!==null&&E.delete(g),g=Ln(),p.pingedLanes|=p.suspendedLanes&C,on===p&&(bn&C)===C&&(qr===4||qr===3&&(bn&130023424)===bn&&500>an()-Eb?Jl(p,0):Nb|=C),ci(p,g)}function ZN(p,g){g===0&&(p.mode&1?(g=Cm,Cm<<=1,!(Cm&130023424)&&(Cm=4194304)):g=1);var C=Ln();p=$a(p,g),p!==null&&(wf(p,g,C),ci(p,C))}function KL(p){var g=p.memoizedState,C=0;g!==null&&(C=g.retryLane),ZN(p,C)}function YL(p,g){var C=0;switch(p.tag){case 13:var E=p.stateNode,_=p.memoizedState;_!==null&&(C=_.retryLane);break;case 19:E=p.stateNode;break;default:throw Error(s(314))}E!==null&&E.delete(g),ZN(p,C)}var eE;eE=function(p,g,C){if(p!==null)if(p.memoizedProps!==g.pendingProps||Lr.current)li=!0;else{if(!(p.lanes&C)&&!(g.flags&128))return li=!1,IL(p,g,C);li=!!(p.flags&131072)}else li=!1,ir&&g.flags&1048576&&A4(g,Mm,g.index);switch(g.lanes=0,g.tag){case 2:var E=g.type;Hm(p,g),p=g.pendingProps;var _=mo(g,Gr.current);bc(g,C),_=Z1(null,g,E,p,_,C);var O=eb();return g.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Yn(E)?(O=!0,Sm(g)):O=!1,g.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,W1(g),_.updater=Um,g.stateNode=_,_._reactInternals=g,sb(g,E,p,C),g=cb(null,g,E,!0,O,C)):(g.tag=0,ir&&O&&I1(g),Xn(null,g,_,C),g=g.child),g;case 16:E=g.elementType;e:{switch(Hm(p,g),p=g.pendingProps,_=E._init,E=_(E._payload),g.type=E,_=g.tag=QL(E),p=xa(E,p),_){case 0:g=ub(null,g,E,p,C);break e;case 1:g=EN(null,g,E,p,C);break e;case 11:g=wN(null,g,E,p,C);break e;case 14:g=SN(null,g,E,xa(E.type,p),C);break e}throw Error(s(306,E,""))}return g;case 0:return E=g.type,_=g.pendingProps,_=g.elementType===E?_:xa(E,_),ub(p,g,E,_,C);case 1:return E=g.type,_=g.pendingProps,_=g.elementType===E?_:xa(E,_),EN(p,g,E,_,C);case 3:e:{if(TN(g),p===null)throw Error(s(387));E=g.pendingProps,O=g.memoizedState,_=O.element,$4(p,g),Im(g,E,null,C);var X=g.memoizedState;if(E=X.element,Z&&O.isDehydrated)if(O={element:E,isDehydrated:!1,cache:X.cache,pendingSuspenseBoundaries:X.pendingSuspenseBoundaries,transitions:X.transitions},g.updateQueue.baseState=O,g.memoizedState=O,g.flags&256){_=kc(Error(s(423)),g),g=jN(p,g,E,C,_);break e}else if(E!==_){_=kc(Error(s(424)),g),g=jN(p,g,E,C,_);break e}else for(Z&&($i=ho(g.stateNode.containerInfo),Ni=g,ir=!0,ya=null,Sf=!1),C=F4(g,null,E,C),g.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(vc(),E===_){g=Es(p,g,C);break e}Xn(p,g,E,C)}g=g.child}return g;case 5:return H4(g),p===null&&F1(g),E=g.type,_=g.pendingProps,O=p!==null?p.memoizedProps:null,X=_.children,se(E,_)?X=null:O!==null&&se(E,O)&&(g.flags|=32),NN(p,g),Xn(p,g,X,C),g.child;case 6:return p===null&&F1(g),null;case 13:return MN(p,g,C);case 4:return q1(g,g.stateNode.containerInfo),E=g.pendingProps,p===null?g.child=yc(g,null,E,C):Xn(p,g,E,C),g.child;case 11:return E=g.type,_=g.pendingProps,_=g.elementType===E?_:xa(E,_),wN(p,g,E,_,C);case 7:return Xn(p,g,g.pendingProps,C),g.child;case 8:return Xn(p,g,g.pendingProps.children,C),g.child;case 12:return Xn(p,g,g.pendingProps.children,C),g.child;case 10:e:{if(E=g.type._context,_=g.pendingProps,O=g.memoizedProps,X=_.value,z4(g,E,X),O!==null)if(va(O.value,X)){if(O.children===_.children&&!Lr.current){g=Es(p,g,C);break e}}else for(O=g.child,O!==null&&(O.return=g);O!==null;){var oe=O.dependencies;if(oe!==null){X=O.child;for(var pe=oe.firstContext;pe!==null;){if(pe.context===E){if(O.tag===1){pe=Ns(-1,C&-C),pe.tag=2;var ke=O.updateQueue;if(ke!==null){ke=ke.shared;var $e=ke.pending;$e===null?pe.next=pe:(pe.next=$e.next,$e.next=pe),ke.pending=pe}}O.lanes|=C,pe=O.alternate,pe!==null&&(pe.lanes|=C),G1(O.return,C,g),oe.lanes|=C;break}pe=pe.next}}else if(O.tag===10)X=O.type===g.type?null:O.child;else if(O.tag===18){if(X=O.return,X===null)throw Error(s(341));X.lanes|=C,oe=X.alternate,oe!==null&&(oe.lanes|=C),G1(X,C,g),X=O.sibling}else X=O.child;if(X!==null)X.return=O;else for(X=O;X!==null;){if(X===g){X=null;break}if(O=X.sibling,O!==null){O.return=X.return,X=O;break}X=X.return}O=X}Xn(p,g,_.children,C),g=g.child}return g;case 9:return _=g.type,E=g.pendingProps.children,bc(g,C),_=Ui(_),E=E(_),g.flags|=1,Xn(p,g,E,C),g.child;case 14:return E=g.type,_=xa(E,g.pendingProps),_=xa(E.type,_),SN(p,g,E,_,C);case 15:return kN(p,g,g.type,g.pendingProps,C);case 17:return E=g.type,_=g.pendingProps,_=g.elementType===E?_:xa(E,_),Hm(p,g),g.tag=1,Yn(E)?(p=!0,Sm(g)):p=!1,bc(g,C),pN(g,E,_),sb(g,E,_,C),cb(null,g,E,!0,p,C);case 19:return _N(p,g,C);case 22:return CN(p,g,C)}throw Error(s(156,g.tag))};function tE(p,g){return A1(p,g)}function XL(p,g,C,E){this.tag=p,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qi(p,g,C,E){return new XL(p,g,C,E)}function Db(p){return p=p.prototype,!(!p||!p.isReactComponent)}function QL(p){if(typeof p=="function")return Db(p)?1:0;if(p!=null){if(p=p.$$typeof,p===x)return 11;if(p===S)return 14}return 2}function So(p,g){var C=p.alternate;return C===null?(C=qi(p.tag,g,p.key,p.mode),C.elementType=p.elementType,C.type=p.type,C.stateNode=p.stateNode,C.alternate=p,p.alternate=C):(C.pendingProps=g,C.type=p.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=p.flags&14680064,C.childLanes=p.childLanes,C.lanes=p.lanes,C.child=p.child,C.memoizedProps=p.memoizedProps,C.memoizedState=p.memoizedState,C.updateQueue=p.updateQueue,g=p.dependencies,C.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},C.sibling=p.sibling,C.index=p.index,C.ref=p.ref,C}function ug(p,g,C,E,_,O){var X=2;if(E=p,typeof p=="function")Db(p)&&(X=1);else if(typeof p=="string")X=5;else e:switch(p){case c:return tu(C.children,_,O,g);case d:X=8,_|=8;break;case h:return p=qi(12,C,g,_|2),p.elementType=h,p.lanes=O,p;case y:return p=qi(13,C,g,_),p.elementType=y,p.lanes=O,p;case b:return p=qi(19,C,g,_),p.elementType=b,p.lanes=O,p;case k:return cg(C,_,O,g);default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case m:X=10;break e;case v:X=9;break e;case x:X=11;break e;case S:X=14;break e;case w:X=16,E=null;break e}throw Error(s(130,p==null?p:typeof p,""))}return g=qi(X,C,g,_),g.elementType=p,g.type=E,g.lanes=O,g}function tu(p,g,C,E){return p=qi(7,p,E,g),p.lanes=C,p}function cg(p,g,C,E){return p=qi(22,p,E,g),p.elementType=k,p.lanes=C,p.stateNode={isHidden:!1},p}function Ob(p,g,C){return p=qi(6,p,null,g),p.lanes=C,p}function Ib(p,g,C){return g=qi(4,p.children!==null?p.children:[],p.key,g),g.lanes=C,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}function JL(p,g,C,E,_){this.tag=g,this.containerInfo=p,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ie,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=P1(0),this.expirationTimes=P1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=P1(0),this.identifierPrefix=E,this.onRecoverableError=_,Z&&(this.mutableSourceEagerHydrationData=null)}function rE(p,g,C,E,_,O,X,oe,pe){return p=new JL(p,g,C,oe,pe),g===1?(g=1,O===!0&&(g|=8)):g=0,O=qi(3,null,null,g),p.current=O,O.stateNode=p,O.memoizedState={element:E,isDehydrated:C,cache:null,transitions:null,pendingSuspenseBoundaries:null},W1(O),p}function nE(p){if(!p)return Fi;p=p._reactInternals;e:{if(A(p)!==p||p.tag!==1)throw Error(s(170));var g=p;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Yn(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(s(171))}if(p.tag===1){var C=p.type;if(Yn(C))return E4(p,C,g)}return g}function iE(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(s(188)):(p=Object.keys(p).join(","),Error(s(268,p)));return p=R(g),p===null?null:p.stateNode}function aE(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var C=p.retryLane;p.retryLane=C!==0&&C<g?C:g}}function dg(p,g){aE(p,g),(p=p.alternate)&&aE(p,g)}function ZL(p){return p=R(p),p===null?null:p.stateNode}function eB(){return null}return r.attemptContinuousHydration=function(p){if(p.tag===13){var g=$a(p,134217728);if(g!==null){var C=Ln();Wi(g,p,134217728,C)}dg(p,134217728)}},r.attemptDiscreteHydration=function(p){if(p.tag===13){var g=$a(p,1);if(g!==null){var C=Ln();Wi(g,p,1,C)}dg(p,1)}},r.attemptHydrationAtCurrentPriority=function(p){if(p.tag===13){var g=bo(p),C=$a(p,g);if(C!==null){var E=Ln();Wi(C,p,g,E)}dg(p,g)}},r.attemptSynchronousHydration=function(p){switch(p.tag){case 3:var g=p.stateNode;if(g.current.memoizedState.isDehydrated){var C=bf(g.pendingLanes);C!==0&&(_1(g,C|1),ci(g,an()),!(yt&6)&&(Ec(),Va()))}break;case 13:qN(function(){var E=$a(p,1);if(E!==null){var _=Ln();Wi(E,p,1,_)}}),dg(p,1)}},r.batchedUpdates=function(p,g){var C=yt;yt|=1;try{return p(g)}finally{yt=C,yt===0&&(Ec(),Tm&&Va())}},r.createComponentSelector=function(p){return{$$typeof:Xm,value:p}},r.createContainer=function(p,g,C,E,_,O,X){return rE(p,g,!1,null,C,E,_,O,X)},r.createHasPseudoClassSelector=function(p){return{$$typeof:Qm,value:p}},r.createHydrationContainer=function(p,g,C,E,_,O,X,oe,pe){return p=rE(C,E,!0,p,_,O,X,oe,pe),p.context=nE(null),C=p.current,E=Ln(),_=bo(C),O=Ns(E,_),O.callback=g??null,vo(C,O,_),p.current.lanes=_,wf(p,_,E),ci(p,E),p},r.createPortal=function(p,g,C){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:E==null?null:""+E,children:p,containerInfo:g,implementation:C}},r.createRoleSelector=function(p){return{$$typeof:Jm,value:p}},r.createTestNameSelector=function(p){return{$$typeof:Zm,value:p}},r.createTextSelector=function(p){return{$$typeof:eg,value:p}},r.deferredUpdates=function(p){var g=Pt,C=_r.transition;try{return _r.transition=null,Pt=16,p()}finally{Pt=g,_r.transition=C}},r.discreteUpdates=function(p,g,C,E,_){var O=Pt,X=_r.transition;try{return _r.transition=null,Pt=1,p(g,C,E,_)}finally{Pt=O,_r.transition=X,yt===0&&Ec()}},r.findAllNodes=kb,r.findBoundingRects=function(p,g){if(!Ce)throw Error(s(363));g=kb(p,g),p=[];for(var C=0;C<g.length;C++)p.push(Ve(g[C]));for(g=p.length-1;0<g;g--){C=p[g];for(var E=C.x,_=E+C.width,O=C.y,X=O+C.height,oe=g-1;0<=oe;oe--)if(g!==oe){var pe=p[oe],ke=pe.x,$e=ke+pe.width,ot=pe.y,Pe=ot+pe.height;if(E>=ke&&O>=ot&&_<=$e&&X<=Pe){p.splice(g,1);break}else if(E!==ke||C.width!==pe.width||Pe<O||ot>X){if(!(O!==ot||C.height!==pe.height||$e<E||ke>_)){ke>E&&(pe.width+=ke-E,pe.x=E),$e<_&&(pe.width=_-ke),p.splice(g,1);break}}else{ot>O&&(pe.height+=ot-O,pe.y=O),Pe<X&&(pe.height=X-ot),p.splice(g,1);break}}}return p},r.findHostInstance=iE,r.findHostInstanceWithNoPortals=function(p){return p=D(p),p=p!==null?U(p):null,p===null?null:p.stateNode},r.findHostInstanceWithWarning=function(p){return iE(p)},r.flushControlled=function(p){var g=yt;yt|=1;var C=_r.transition,E=Pt;try{_r.transition=null,Pt=1,p()}finally{Pt=E,_r.transition=C,yt=g,yt===0&&(Ec(),Va())}},r.flushPassiveEffects=eu,r.flushSync=qN,r.focusWithin=function(p,g){if(!Ce)throw Error(s(363));for(p=bb(p),g=GN(p,g),g=Array.from(g),p=0;p<g.length;){var C=g[p++];if(!Ie(C)){if(C.tag===5&&ut(C.stateNode))return!0;for(C=C.child;C!==null;)g.push(C),C=C.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Pt},r.getFindAllNodesFailureDescription=function(p,g){if(!Ce)throw Error(s(363));var C=0,E=[];p=[bb(p),0];for(var _=0;_<p.length;){var O=p[_++],X=p[_++],oe=g[X];if((O.tag!==5||!Ie(O))&&(wb(O,oe)&&(E.push(Sb(oe)),X++,X>C&&(C=X)),X<g.length))for(O=O.child;O!==null;)p.push(O,X),O=O.sibling}if(C<g.length){for(p=[];C<g.length;C++)p.push(Sb(g[C]));return`findAllNodes was able to match part of the selector:
  `+(E.join(" > ")+`

No matching component was found for:
  `)+p.join(" > ")}return null},r.getPublicRootInstance=function(p){if(p=p.current,!p.child)return null;switch(p.child.tag){case 5:return z(p.child.stateNode);default:return p.child.stateNode}},r.injectIntoDevTools=function(p){if(p={bundleType:p.bundleType,version:p.version,rendererPackageName:p.rendererPackageName,rendererConfig:p.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:ZL,findFiberByHostInstance:p.findFiberByHostInstance||eB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")p=!1;else{var g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(g.isDisabled||!g.supportsFiber)p=!0;else{try{Em=g.inject(p),za=g}catch{}p=!!g.checkDCE}}return p},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(p,g,C,E){if(!Ce)throw Error(s(363));p=kb(p,g);var _=xt(p,C,E).disconnect;return{disconnect:function(){_()}}},r.registerMutableSourceForHydration=function(p,g){var C=g._getVersion;C=C(g._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[g,C]:p.mutableSourceEagerHydrationData.push(g,C)},r.runWithPriority=function(p,g){var C=Pt;try{return Pt=p,g()}finally{Pt=C}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(p,g,C,E){var _=g.current,O=Ln(),X=bo(_);return C=nE(C),g.context===null?g.context=C:g.pendingContext=C,g=Ns(O,X),g.payload={element:p},E=E===void 0?null:E,E!==null&&(g.callback=E),p=vo(_,g,X),p!==null&&(Wi(p,_,X,O),Om(p,_,X)),X},r};nL.exports=Uue;var Gue=nL.exports;const Hue=Up(Gue);var iL={exports:{}},fc={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */fc.ConcurrentRoot=1;fc.ContinuousEventPriority=4;fc.DefaultEventPriority=16;fc.DiscreteEventPriority=1;fc.IdleEventPriority=536870912;fc.LegacyRoot=0;iL.exports=fc;var aL=iL.exports;const FM={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let zM=!1,VM=!1;const k4=".react-konva-event",Wue=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,que=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,Kue={};function C1(t,e,r=Kue){if(!zM&&"zIndex"in e&&(console.warn(que),zM=!0),!VM&&e.draggable){var n=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;n&&!i&&(console.warn(Wue),VM=!0)}for(var a in r)if(!FM[a]){var s=a.slice(0,2)==="on",o=r[a]!==e[a];if(s&&o){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),t.off(l,r[a])}var u=!e.hasOwnProperty(a);u&&t.setAttr(a,void 0)}var c=e._useStrictMode,d={},h=!1;const m={};for(var a in e)if(!FM[a]){var s=a.slice(0,2)==="on",v=r[a]!==e[a];if(s&&v){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e[a]&&(m[l]=e[a])}!s&&(e[a]!==r[a]||c&&e[a]!==t.getAttr(a))&&(h=!0,d[a]=e[a])}h&&(t.setAttrs(d),Gl(t));for(var l in m)t.on(l+k4,m[l])}function Gl(t){if(!pt.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const sL={},Yue={};$p.Node.prototype._applyProps=C1;function Xue(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),Gl(t)}function Que(t,e,r){let n=$p[t];n||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=$p.Group);const i={},a={};for(var s in e){var o=s.slice(0,2)==="on";o?a[s]=e[s]:i[s]=e[s]}const l=new n(i);return C1(l,a),l}function Jue(t,e,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function Zue(t,e,r){return!1}function ece(t){return t}function tce(){return null}function rce(){return null}function nce(t,e,r,n){return Yue}function ice(){}function ace(t){}function sce(t,e){return!1}function oce(){return sL}function lce(){return sL}const uce=setTimeout,cce=clearTimeout,dce=-1;function fce(t,e){return!1}const hce=!1,pce=!0,mce=!0;function gce(t,e){e.parent===t?e.moveToTop():t.add(e),Gl(t)}function vce(t,e){e.parent===t?e.moveToTop():t.add(e),Gl(t)}function oL(t,e,r){e._remove(),t.add(e),e.setZIndex(r.getZIndex()),Gl(t)}function yce(t,e,r){oL(t,e,r)}function xce(t,e){e.destroy(),e.off(k4),Gl(t)}function bce(t,e){e.destroy(),e.off(k4),Gl(t)}function wce(t,e,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function Sce(t,e,r){}function kce(t,e,r,n,i){C1(t,i,n)}function Cce(t){t.hide(),Gl(t)}function Nce(t){}function Ece(t,e){(e.visible==null||e.visible)&&t.show()}function Tce(t,e){}function jce(t){}function Mce(){}const Pce=()=>aL.DefaultEventPriority,_ce=Object.freeze(Object.defineProperty({__proto__:null,appendChild:gce,appendChildToContainer:vce,appendInitialChild:Xue,cancelTimeout:cce,clearContainer:jce,commitMount:Sce,commitTextUpdate:wce,commitUpdate:kce,createInstance:Que,createTextInstance:Jue,detachDeletedInstance:Mce,finalizeInitialChildren:Zue,getChildHostContext:lce,getCurrentEventPriority:Pce,getPublicInstance:ece,getRootHostContext:oce,hideInstance:Cce,hideTextInstance:Nce,idlePriority:Eh.unstable_IdlePriority,insertBefore:oL,insertInContainerBefore:yce,isPrimaryRenderer:hce,noTimeout:dce,now:Eh.unstable_now,prepareForCommit:tce,preparePortalMount:rce,prepareUpdate:nce,removeChild:xce,removeChildFromContainer:bce,resetAfterCommit:ice,resetTextContent:ace,run:Eh.unstable_runWithPriority,scheduleTimeout:uce,shouldDeprioritizeSubtree:sce,shouldSetTextContent:fce,supportsMutation:mce,unhideInstance:Ece,unhideTextInstance:Tce,warnsIfNotActing:pce},Symbol.toStringTag,{value:"Module"}));var Ace=Object.defineProperty,Rce=Object.defineProperties,Dce=Object.getOwnPropertyDescriptors,$M=Object.getOwnPropertySymbols,Oce=Object.prototype.hasOwnProperty,Ice=Object.prototype.propertyIsEnumerable,UM=(t,e,r)=>e in t?Ace(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,GM=(t,e)=>{for(var r in e||(e={}))Oce.call(e,r)&&UM(t,r,e[r]);if($M)for(var r of $M(e))Ice.call(e,r)&&UM(t,r,e[r]);return t},Lce=(t,e)=>Rce(t,Dce(e)),HM,WM;typeof window<"u"&&((HM=window.document)!=null&&HM.createElement||((WM=window.navigator)==null?void 0:WM.product)==="ReactNative")?K.useLayoutEffect:K.useEffect;function lL(t,e,r){if(!t)return;if(r(t)===!0)return t;let n=e?t.return:t.child;for(;n;){const i=lL(n,e,r);if(i)return i;n=e?null:n.sibling}}function uL(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const qM=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=qM;return}return qM.apply(this,arguments)};const C4=uL(K.createContext(null));class cL extends K.Component{render(){return K.createElement(C4.Provider,{value:this._reactInternals},this.props.children)}}function Bce(){const t=K.useContext(C4);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=K.useId();return K.useMemo(()=>{for(const n of[t,t==null?void 0:t.alternate]){if(!n)continue;const i=lL(n,!1,a=>{let s=a.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(i)return i}},[t,e])}function Fce(){const t=Bce(),[e]=K.useState(()=>new Map);e.clear();let r=t;for(;r;){if(r.type&&typeof r.type=="object"){const i=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;i&&i!==C4&&!e.has(i)&&e.set(i,K.useContext(uL(i)))}r=r.return}return e}function zce(){const t=Fce();return K.useMemo(()=>Array.from(t.keys()).reduce((e,r)=>n=>K.createElement(e,null,K.createElement(r.Provider,Lce(GM({},n),{value:t.get(r)}))),e=>K.createElement(cL,GM({},e))),[t])}function Vce(t){const e=kt.useRef({});return kt.useLayoutEffect(()=>{e.current=t}),kt.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const $ce=t=>{const e=kt.useRef(),r=kt.useRef(),n=kt.useRef(),i=Vce(t),a=zce(),s=o=>{const{forwardedRef:l}=t;l&&(typeof l=="function"?l(o):l.current=o)};return kt.useLayoutEffect(()=>(r.current=new $p.Stage({width:t.width,height:t.height,container:e.current}),s(r.current),n.current=Nh.createContainer(r.current,aL.LegacyRoot,!1,null),Nh.updateContainer(kt.createElement(a,{},t.children),n.current),()=>{$p.isBrowser&&(s(null),Nh.updateContainer(null,n.current,null),r.current.destroy())}),[]),kt.useLayoutEffect(()=>{s(r.current),C1(r.current,t,i),Nh.updateContainer(kt.createElement(a,{},t.children),n.current,null)}),kt.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},KM="Layer",YM="Rect",Uce="Line",Gce="Image",Hce="Text",Wce="Transformer",Nh=Hue(_ce);Nh.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:kt.version,rendererPackageName:"react-konva"});const qce=kt.forwardRef((t,e)=>kt.createElement(cL,{},kt.createElement($ce,{...t,forwardedRef:e}))),LS=({stepNumber:t,title:e,isOpen:r,onClick:n,children:i})=>f.jsxs("div",{className:`border border-white/10 rounded-2xl bg-[#13141f] overflow-hidden transition-all duration-300 ${r?"ring-1 ring-primary/50":"opacity-80"}`,children:[f.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-6 hover:bg-white/5 transition-colors",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:`size-8 rounded-full flex items-center justify-center font-black text-sm ${r?"bg-primary text-white":"bg-white/10 text-slate-400"}`,children:t}),f.jsx("h3",{className:`text-lg font-bold ${r?"text-white":"text-slate-400"}`,children:e})]}),f.jsx("span",{className:`material-symbols-outlined transition-transform duration-300 ${r?"rotate-180 text-primary":"text-slate-500"}`,children:"expand_more"})]}),r&&f.jsx("div",{className:"p-6 pt-0 border-t border-white/5 animate-in fade-in slide-in-from-top-2",children:i})]}),BS=({icon:t,title:e,desc:r,selected:n,onClick:i})=>f.jsxs("div",{onClick:i,className:`p-6 rounded-xl border cursor-pointer transition-all relative group h-full flex flex-col justify-between ${n?"bg-primary/20 border-primary shadow-[0_0_30px_rgba(var(--color-primary),0.3)]":"bg-[#0a0a0c] border-white/10 hover:border-white/30"}`,children:[f.jsxs("div",{className:"mb-4",children:[f.jsx("div",{className:`size-12 rounded-lg flex items-center justify-center mb-4 ${n?"bg-primary text-white":"bg-white/10 text-slate-400 group-hover:text-white group-hover:bg-white/20"}`,children:f.jsx("span",{className:"material-symbols-outlined text-2xl",children:t})}),f.jsx("h4",{className:"font-bold text-white mb-1",children:e}),f.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:r})]}),n&&f.jsx("div",{className:"absolute top-4 right-4 size-3 bg-primary rounded-full shadow-glow"})]}),Kce=({src:t,x:e,y:r,width:n,height:i})=>{const[a,s]=K.useState(null);return K.useEffect(()=>{if(!t)return;const o=new window.Image;o.src=t,o.crossOrigin="Anonymous",o.onload=()=>{s(o)}},[t]),f.jsx(Gce,{image:a,x:e,y:r,width:n,height:i})},Yce=({selectedId:t})=>{const e=kt.useRef();return kt.useEffect(()=>{if(t){const r=e.current.getStage().findOne("#"+t);r&&(e.current.nodes([r]),e.current.getLayer().batchDraw())}else e.current.nodes([])},[t]),f.jsx(Wce,{ref:e})},XM=({mode:t})=>{var ie;const{username:e,projectName:r,folderId:n,entityId:i}=Bi(),a=Li(),s=Ju(),{setRightOpen:o,setRightPanelMode:l,setAvailableTemplates:u,mapSettings:c,setMapSettings:d,setOnMapSettingsChange:h}=jl(),[m,v]=K.useState(t==="create"?"setup":"editor");K.useEffect(()=>{v(t==="create"?"setup":"editor")},[t]);const[x,y]=K.useState(((ie=s.state)==null?void 0:ie.folderId)||null),[b,S]=K.useState(1),[w,k]=K.useState({name:"New Map",description:"",parentZone:null,type:"regional",sourceType:"blank",dims:{width:800,height:600},bgImage:null}),[N,T]=K.useState(!1),[j,M]=K.useState("brush"),[A,P]=K.useState([]),[D,R]=K.useState([]),[I,U]=K.useState([]),[B,z]=K.useState(null),F=kt.useRef(!1),[V,J]=K.useState({isOpen:!1,id:null,text:""}),Y=$=>{$.target===$.target.getStage()&&z(null)},L=$=>{Y($);const te=$.target.getStage().getPointerPosition();j!=="select"&&(F.current=!0,j==="brush"||j==="eraser"?P([...A,{id:`line-${Date.now()}`,tool:j,points:[te.x,te.y],color:j==="eraser"?"#ffffff":"#df4b26",size:j==="eraser"?20:5}]):j==="rect"?R([...D,{id:`rect-${Date.now()}`,x:te.x,y:te.y,width:0,height:0,color:"#df4b26"}]):j==="text"&&(U([...I,{id:`text-${Date.now()}`,x:te.x,y:te.y,text:"Double click to edit",fontSize:20,color:"#ffffff"}]),F.current=!1))},G=$=>{if(!F.current)return;const te=$.target.getStage().getPointerPosition();j==="brush"||j==="eraser"?P(Z=>{const le=[...Z],ge={...le[le.length-1]};return ge.points=ge.points.concat([te.x,te.y]),le[le.length-1]=ge,le}):j==="rect"&&R(Z=>{const le=[...Z],ge={...le[le.length-1]};return ge.width=te.x-ge.x,ge.height=te.y-ge.y,le[le.length-1]=ge,le})},ee=()=>{F.current=!1};K.useEffect(()=>{if(o(m==="editor"),m==="editor"){l("MAP");const $={showGrid:!0,gridSize:50,width:w.dims.width,height:w.dims.height};d($),h(q=>{q&&k(te=>({...te,dims:{width:q.width,height:q.height}}))})}},[m]),K.useEffect(()=>{t==="create"&&!x&&n&&(console.log("Resolving folder ID for slug:",n),Ne.get(`/world-bible/folders/${n}`).then($=>y($.id)).catch($=>console.error("Could not resolve folder ID",$)))},[t,n,x]);const re=$=>{const q=$.target.files[0];if(q){const te=new FileReader;te.onload=Z=>{const le=new Image;le.onload=()=>{k(ge=>({...ge,bgImage:Z.target.result,dims:{width:le.width,height:le.height},sourceType:"upload"}))},le.src=Z.target.result},te.readAsDataURL(q)}},se=kt.useRef(null),de=async()=>{if(!x){alert("Folder context missing. Please start from the folder view again.");return}T(!0);try{let $=w.bgImage;if(se.current){const Z=se.current.findOne("Transformer");if(Z&&Z.nodes([]),$=se.current.toDataURL({pixelRatio:.5}),Z&&B){const le=se.current.findOne("#"+B);le&&Z.nodes([le])}}const q={nombre:w.name,tipoEspecial:"map",carpetaId:x,descripcion:JSON.stringify({description:w.description,type:w.type,width:w.dims.width,height:w.dims.height,bgImage:w.bgImage,layers:{lines:A,rectangles:D,texts:I},snapshotUrl:$}),iconUrl:$},te=await Ne.post("/world-bible/entities",q);window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:x}})),a(`/${e}/${r}/map-editor/edit/${te.id}`,{replace:!0})}catch($){console.error($),alert("Error creating map. Check console.")}finally{T(!1)}},W=kt.useRef(null);K.useEffect(()=>{(!t||t==="edit")&&i&&Ne.get(`/world-bible/entities/${i}`).then($=>{y($.carpetaId),W.current=$.iconUrl,v("editor");let q={};try{q=$.descripcion?JSON.parse($.descripcion):{}}catch(te){console.error("Error parsing map data",te)}k({name:$.nombre,description:q.description||"",parentZone:null,type:q.type||"regional",sourceType:q.bgImage?"upload":"blank",dims:{width:q.width||800,height:q.height||600},bgImage:q.bgImage}),q.layers&&(P(q.layers.lines||[]),R(q.layers.rectangles||[]),U(q.layers.texts||[])),d({name:$.nombre,description:q.description||"",type:q.type||"regional",showGrid:!0,gridSize:50,width:q.width||800,height:q.height||600,bgImage:q.bgImage})}).catch($=>console.error("Error loading entity",$))},[t,i]);const ne=async()=>{T(!0);try{let $=w.bgImage;if(se.current){z(null);const te=se.current.findOne("Transformer");te&&te.nodes([]),$=se.current.toDataURL({pixelRatio:.5})}const q={id:i,nombre:w.name,tipoEspecial:"map",carpetaId:x,descripcion:JSON.stringify({description:w.description,type:w.type,width:w.dims.width,height:w.dims.height,bgImage:w.bgImage,layers:{lines:A,rectangles:D,texts:I},snapshotUrl:$}),iconUrl:W.current};await Ne.put(`/world-bible/entities/${i}`,q),a(x?`/${e}/${r}/bible/folder/${x}`:`/${e}/${r}/bible`)}catch($){console.error("Save failed",$),alert("Error saving map")}finally{T(!1)}};return m==="setup"?f.jsxs("div",{className:"flex-1 flex flex-col h-screen bg-[#060608] text-white",children:[f.jsxs("div",{className:"h-16 border-b border-white/5 flex items-center justify-between px-8 bg-[#0a0a0c]",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"p-2 bg-primary/20 rounded-lg text-primary",children:f.jsx("span",{className:"material-symbols-outlined",children:"add_circle"})}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-lg font-bold leading-tight",children:"Create New Map / Zone"}),f.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-bold tracking-wider",children:"Configure details for your new cartography entry"})]})]}),f.jsx("button",{onClick:()=>a(-1),className:"p-2 hover:bg-white/5 rounded-full text-slate-500 hover:text-white transition-colors",children:f.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-8",children:f.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[f.jsx(LS,{stepNumber:"1",title:"Identity & Hierarchy",isOpen:b===1,onClick:()=>S(1),children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Map Name"}),f.jsx("input",{autoFocus:!0,value:w.name,onChange:$=>k({...w,name:$.target.value}),className:"w-full bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-white focus:border-primary outline-none transition-colors",placeholder:"e.g. The Sapphire Coast"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Parent Zone (Optional)"}),f.jsxs("div",{className:"w-full bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-slate-400 flex items-center justify-between cursor-pointer hover:border-white/20",children:[f.jsx("span",{children:"Current Folder (Default)"}),f.jsx("span",{className:"material-symbols-outlined text-sm",children:"expand_more"})]}),f.jsx("p",{className:"text-[10px] text-slate-600 mt-2",children:"Selecting a parent makes this a sub-zone."})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Description"}),f.jsx("textarea",{value:w.description,onChange:$=>k({...w,description:$.target.value}),className:"w-full h-40 bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-white resize-none focus:border-primary outline-none transition-colors leading-relaxed",placeholder:"Brief description of geography, climate, or importance..."})]})]})}),f.jsx(LS,{stepNumber:"2",title:"Map Type",isOpen:b===2,onClick:()=>S(2),children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(BS,{icon:"public",title:"World Map",desc:"Continents, oceans, global scale.",selected:w.type==="world",onClick:()=>k({...w,type:"world"})}),f.jsx(BS,{icon:"map",title:"Regional Map",desc:"Kingdoms, provinces, biomes.",selected:w.type==="regional",onClick:()=>k({...w,type:"regional"})}),f.jsx(BS,{icon:"location_city",title:"City / Local",desc:"Cities, dungeons, battlemaps.",selected:w.type==="local",onClick:()=>k({...w,type:"local"})})]})}),f.jsx(LS,{stepNumber:"3",title:"Canvas Source",isOpen:b===3,onClick:()=>S(3),children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{onClick:()=>document.getElementById("map-upload-input").click(),className:`relative p-8 rounded-xl border-2 border-dashed flex flex-col items-center justify-center text-center cursor-pointer transition-all group min-h-[200px] ${w.sourceType==="upload"?"border-primary bg-primary/5":"border-white/10 hover:border-white/30 bg-[#0a0a0c]"}`,children:[f.jsx("input",{id:"map-upload-input",type:"file",accept:"image/*",className:"hidden",onChange:re}),w.bgImage?f.jsx("img",{src:w.bgImage,alt:"Preview",className:"absolute inset-0 w-full h-full object-cover rounded-xl opacity-50 group-hover:opacity-70"}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"size-16 bg-white/5 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:f.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"cloud_upload"})}),f.jsx("h4",{className:"font-bold text-white",children:"Upload Image File"}),f.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Drag & drop or click to browse"}),f.jsx("p",{className:"text-[10px] text-slate-600 mt-1 uppercase font-bold",children:"JPG, PNG, WEBP  Max 20MB"})]}),w.sourceType==="upload"&&f.jsx("div",{className:"absolute top-4 right-4 size-3 bg-primary rounded-full shadow-glow z-10"})]}),f.jsxs("div",{onClick:()=>k({...w,sourceType:"blank",bgImage:null}),className:`p-8 rounded-xl border flex flex-col items-center justify-center text-center cursor-pointer transition-all min-h-[200px] ${w.sourceType==="blank"?"border-primary bg-primary/5":"border-white/10 hover:border-white/30 bg-[#0a0a0c]"}`,children:[f.jsx("div",{className:"size-16 bg-white/5 rounded-full flex items-center justify-center mb-4",children:f.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"check_box_outline_blank"})}),f.jsx("h4",{className:"font-bold text-white",children:"Blank Canvas"}),f.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Start a new drawing from scratch"}),w.sourceType==="blank"&&f.jsxs("div",{className:"mt-6 flex items-center gap-2 bg-black/50 p-1 rounded-lg border border-white/10",children:[f.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 px-2",children:"Size"}),f.jsx("span",{className:"text-xs font-mono text-white",children:"4096 px"}),f.jsx("span",{className:"text-xs text-slate-500",children:"x"}),f.jsx("span",{className:"text-xs font-mono text-white",children:"4096 px"})]})]})]})})]})}),f.jsxs("div",{className:"h-20 border-t border-white/5 bg-[#0a0a0c] flex items-center justify-between px-8 z-20",children:[f.jsx("button",{onClick:()=>a(-1),className:"text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"Cancel"}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("span",{className:"text-xs text-slate-600 italic",children:"Changes saved locally"}),f.jsx(Wt,{variant:"primary",size:"lg",icon:"check",onClick:de,disabled:!w.name||N,className:"bg-primary hover:bg-primary-light text-white shadow-lg shadow-primary/25 px-8",children:N?"Creating...":"Create Map"})]})]})]}):f.jsxs("div",{className:"flex flex-col h-screen w-full bg-[#0f0f13] text-white overflow-hidden",children:[f.jsxs("header",{className:"h-14 border-b border-white/5 flex items-center justify-between px-4 bg-[#1a1a20] shrink-0",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("button",{onClick:()=>a(-1),className:"p-2 hover:bg-white/5 rounded-full",title:"Back to Collection",children:f.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"})}),f.jsxs("div",{className:"flex flex-col",children:[f.jsx("input",{value:w.name,onChange:$=>k({...w,name:$.target.value}),className:"bg-transparent font-bold text-sm outline-none focus:bg-white/5 rounded px-2 -ml-2"}),f.jsxs("span",{className:"text-[10px] text-text-muted px-2",children:[w.dims.width," x ",w.dims.height,"  ",(c==null?void 0:c.gridSize)||50,"px Grid"]})]})]}),f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(Wt,{variant:"primary",size:"sm",icon:"save",onClick:ne,disabled:N,children:N?"Saving...":"Save Changes"})})]}),f.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[f.jsx("div",{className:"w-14 bg-[#1a1a20] border-r border-white/5 flex flex-col items-center py-4 gap-4 z-10",children:[{id:"select",icon:"near_me"},{id:"brush",icon:"brush"},{id:"eraser",icon:"ink_eraser"},{id:"rect",icon:"check_box_outline_blank"},{id:"text",icon:"title"}].map($=>f.jsx("button",{onClick:()=>M($.id),className:`p-2 rounded-lg transition-colors ${j===$.id?"bg-primary text-white shadow-lg shadow-primary/30":"hover:bg-white/5 text-slate-400 hover:text-white"}`,children:f.jsx("span",{className:"material-symbols-outlined",children:$.icon})},$.id))}),f.jsx("div",{className:"flex-1 overflow-auto bg-[#0f0f13] relative flex items-center justify-center p-8 custom-scrollbar",children:f.jsx("div",{className:"bg-[#1a1a20] shadow-[0_0_50px_rgba(0,0,0,0.5)] flex-none",children:f.jsxs(qce,{ref:se,width:w.dims.width,height:w.dims.height,onMouseDown:L,onMouseMove:G,onMouseUp:ee,className:"bg-white",children:[f.jsxs(KM,{children:[w.bgImage&&f.jsx(Kce,{src:w.bgImage,x:0,y:0,width:w.dims.width,height:w.dims.height}),(c==null?void 0:c.showGrid)&&f.jsx(YM,{width:w.dims.width,height:w.dims.height,fillPatternImage:(()=>{const $=document.createElement("canvas");$.width=c.gridSize||50,$.height=c.gridSize||50;const q=$.getContext("2d");return q.strokeStyle="rgba(0,0,0,0.2)",q.lineWidth=1,q.strokeRect(0,0,$.width,$.height),$})(),listening:!1})]}),f.jsxs(KM,{children:[A.map(($,q)=>f.jsx(Uce,{points:$.points,stroke:$.color,strokeWidth:$.size,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:$.tool==="eraser"?"destination-out":"source-over"},q)),D.map(($,q)=>f.jsx(YM,{id:$.id,x:$.x,y:$.y,width:$.width,height:$.height,stroke:$.color,strokeWidth:2,draggable:j==="select",onClick:()=>j==="select"&&z($.id),onTap:()=>j==="select"&&z($.id)},$.id)),I.map(($,q)=>f.jsx(Hce,{id:$.id,x:$.x,y:$.y,text:$.text,fontSize:$.fontSize,fill:$.color,draggable:j==="select",onClick:()=>j==="select"&&z($.id),onTap:()=>j==="select"&&z($.id),onDblClick:te=>{J({isOpen:!0,id:$.id,text:$.text})}},$.id)),f.jsx(Yce,{selectedId:B})]})]})})})]}),f.jsx(xI,{isOpen:V.isOpen,onClose:()=>J($=>({...$,isOpen:!1})),title:"Edit Map Text",initialValue:V.text,onConfirm:$=>{U(q=>q.map(te=>te.id===V.id?{...te,text:$}:te))},confirmText:"Save Text"})]})};function Xce(){return f.jsx(TV,{children:f.jsxs(xV,{children:[f.jsx(pr,{path:"/",element:f.jsx(m$,{})}),f.jsx(pr,{element:f.jsx(d$,{}),children:f.jsxs(pr,{path:"/:username/:projectName",element:f.jsx(x$,{}),children:[f.jsx(pr,{index:!0,element:f.jsx(g$,{})}),f.jsx(pr,{path:"writing",element:f.jsx(Aae,{})}),f.jsx(pr,{path:"entities/:type/:entityId",element:f.jsx(vY,{})}),f.jsx(pr,{path:"settings",element:f.jsx(v$,{})}),f.jsx(pr,{path:"map-editor/create/:folderId",element:f.jsx(XM,{mode:"create"})}),f.jsx(pr,{path:"map-editor/edit/:entityId",element:f.jsx(XM,{mode:"edit"})}),f.jsxs(pr,{path:"bible",element:f.jsx(Uae,{}),children:[f.jsx(pr,{index:!0,element:f.jsx(Gae,{})}),f.jsx(pr,{path:"folder/:folderSlug/entity/new/:type",element:f.jsx(uh,{mode:"creation"})}),f.jsx(pr,{path:"folder/:folderSlug",element:f.jsx(Fae,{})}),f.jsx(pr,{path:"entity/:entitySlug",element:f.jsx(uh,{})}),f.jsx(pr,{path:"folder/:folderSlug/entity/:entitySlug",element:f.jsx(uh,{})}),f.jsx(pr,{path:"folder/:folderSlug/map/:entitySlug",element:f.jsx(uh,{})}),f.jsx(pr,{path:"folder/:folderSlug/timeline/:entitySlug",element:f.jsx(uh,{})})]}),f.jsx(pr,{path:"map",element:f.jsx(CY,{})}),f.jsx(pr,{path:"timeline",element:f.jsx(yY,{})}),f.jsx(pr,{path:"languages",element:f.jsx(jY,{})}),f.jsx(pr,{path:"trash",element:f.jsx(Rae,{})}),f.jsx(pr,{path:"graph",element:f.jsx(fY,{})})]})})]})})}class Qce extends kt.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,r){this.setState({error:e,errorInfo:r}),console.error("Uncaught Error:",e,r)}render(){return this.state.hasError?f.jsxs("div",{style:{padding:20,background:"#222",color:"red",height:"100vh"},children:[f.jsx("h1",{children:"Something went wrong."}),f.jsxs("details",{style:{whiteSpace:"pre-wrap"},children:[this.state.error&&this.state.error.toString(),f.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}):this.props.children}}const QM=document.getElementById("root");QM?FS.createRoot(QM).render(f.jsx(kt.StrictMode,{children:f.jsx(Qce,{children:f.jsx(Xce,{})})})):console.error("React root element not found (looked for #root)");

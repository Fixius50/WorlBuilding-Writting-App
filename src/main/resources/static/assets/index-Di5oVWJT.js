function V_(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var SC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var x1={exports:{}},bp={},b1={exports:{}},Gt={};var kC;function U_(){if(kC)return Gt;kC=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),f=Symbol.iterator;function m(V){return V===null||typeof V!="object"?null:(V=f&&V[f]||V["@@iterator"],typeof V=="function"?V:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function w(V,Y,Z){this.props=V,this.context=Y,this.refs=b,this.updater=Z||g}w.prototype.isReactComponent={},w.prototype.setState=function(V,Y){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,Y,"setState")},w.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function N(){}N.prototype=w.prototype;function k(V,Y,Z){this.props=V,this.context=Y,this.refs=b,this.updater=Z||g}var C=k.prototype=new N;C.constructor=k,y(C,w.prototype),C.isPureReactComponent=!0;var E=Array.isArray,P=Object.prototype.hasOwnProperty,_={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function I(V,Y,Z){var ie,ce={},he=null,ee=null;if(Y!=null)for(ie in Y.ref!==void 0&&(ee=Y.ref),Y.key!==void 0&&(he=""+Y.key),Y)P.call(Y,ie)&&!A.hasOwnProperty(ie)&&(ce[ie]=Y[ie]);var le=arguments.length-2;if(le===1)ce.children=Z;else if(1<le){for(var te=Array(le),ae=0;ae<le;ae++)te[ae]=arguments[ae+2];ce.children=te}if(V&&V.defaultProps)for(ie in le=V.defaultProps,le)ce[ie]===void 0&&(ce[ie]=le[ie]);return{$$typeof:t,type:V,key:he,ref:ee,props:ce,_owner:_.current}}function D(V,Y){return{$$typeof:t,type:V.type,key:Y,ref:V.ref,props:V.props,_owner:V._owner}}function L(V){return typeof V=="object"&&V!==null&&V.$$typeof===t}function U(V){var Y={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(Z){return Y[Z]})}var H=/\/+/g;function M(V,Y){return typeof V=="object"&&V!==null&&V.key!=null?U(""+V.key):Y.toString(36)}function z(V,Y,Z,ie,ce){var he=typeof V;(he==="undefined"||he==="boolean")&&(V=null);var ee=!1;if(V===null)ee=!0;else switch(he){case"string":case"number":ee=!0;break;case"object":switch(V.$$typeof){case t:case e:ee=!0}}if(ee)return ee=V,ce=ce(ee),V=ie===""?"."+M(ee,0):ie,E(ce)?(Z="",V!=null&&(Z=V.replace(H,"$&/")+"/"),z(ce,Y,Z,"",function(ae){return ae})):ce!=null&&(L(ce)&&(ce=D(ce,Z+(!ce.key||ee&&ee.key===ce.key?"":(""+ce.key).replace(H,"$&/")+"/")+V)),Y.push(ce)),1;if(ee=0,ie=ie===""?".":ie+":",E(V))for(var le=0;le<V.length;le++){he=V[le];var te=ie+M(he,le);ee+=z(he,Y,Z,te,ce)}else if(te=m(V),typeof te=="function")for(V=te.call(V),le=0;!(he=V.next()).done;)he=he.value,te=ie+M(he,le++),ee+=z(he,Y,Z,te,ce);else if(he==="object")throw Y=String(V),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.");return ee}function O(V,Y,Z){if(V==null)return V;var ie=[],ce=0;return z(V,ie,"","",function(he){return Y.call(Z,he,ce++)}),ie}function G(V){if(V._status===-1){var Y=V._result;Y=Y(),Y.then(function(Z){(V._status===0||V._status===-1)&&(V._status=1,V._result=Z)},function(Z){(V._status===0||V._status===-1)&&(V._status=2,V._result=Z)}),V._status===-1&&(V._status=0,V._result=Y)}if(V._status===1)return V._result.default;throw V._result}var W={current:null},$={transition:null},X={ReactCurrentDispatcher:W,ReactCurrentBatchConfig:$,ReactCurrentOwner:_};function Q(){throw Error("act(...) is not supported in production builds of React.")}return Gt.Children={map:O,forEach:function(V,Y,Z){O(V,function(){Y.apply(this,arguments)},Z)},count:function(V){var Y=0;return O(V,function(){Y++}),Y},toArray:function(V){return O(V,function(Y){return Y})||[]},only:function(V){if(!L(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},Gt.Component=w,Gt.Fragment=r,Gt.Profiler=i,Gt.PureComponent=k,Gt.StrictMode=n,Gt.Suspense=l,Gt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Gt.act=Q,Gt.cloneElement=function(V,Y,Z){if(V==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+V+".");var ie=y({},V.props),ce=V.key,he=V.ref,ee=V._owner;if(Y!=null){if(Y.ref!==void 0&&(he=Y.ref,ee=_.current),Y.key!==void 0&&(ce=""+Y.key),V.type&&V.type.defaultProps)var le=V.type.defaultProps;for(te in Y)P.call(Y,te)&&!A.hasOwnProperty(te)&&(ie[te]=Y[te]===void 0&&le!==void 0?le[te]:Y[te])}var te=arguments.length-2;if(te===1)ie.children=Z;else if(1<te){le=Array(te);for(var ae=0;ae<te;ae++)le[ae]=arguments[ae+2];ie.children=le}return{$$typeof:t,type:V.type,key:ce,ref:he,props:ie,_owner:ee}},Gt.createContext=function(V){return V={$$typeof:s,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},V.Provider={$$typeof:a,_context:V},V.Consumer=V},Gt.createElement=I,Gt.createFactory=function(V){var Y=I.bind(null,V);return Y.type=V,Y},Gt.createRef=function(){return{current:null}},Gt.forwardRef=function(V){return{$$typeof:o,render:V}},Gt.isValidElement=L,Gt.lazy=function(V){return{$$typeof:c,_payload:{_status:-1,_result:V},_init:G}},Gt.memo=function(V,Y){return{$$typeof:u,type:V,compare:Y===void 0?null:Y}},Gt.startTransition=function(V){var Y=$.transition;$.transition={};try{V()}finally{$.transition=Y}},Gt.unstable_act=Q,Gt.useCallback=function(V,Y){return W.current.useCallback(V,Y)},Gt.useContext=function(V){return W.current.useContext(V)},Gt.useDebugValue=function(){},Gt.useDeferredValue=function(V){return W.current.useDeferredValue(V)},Gt.useEffect=function(V,Y){return W.current.useEffect(V,Y)},Gt.useId=function(){return W.current.useId()},Gt.useImperativeHandle=function(V,Y,Z){return W.current.useImperativeHandle(V,Y,Z)},Gt.useInsertionEffect=function(V,Y){return W.current.useInsertionEffect(V,Y)},Gt.useLayoutEffect=function(V,Y){return W.current.useLayoutEffect(V,Y)},Gt.useMemo=function(V,Y){return W.current.useMemo(V,Y)},Gt.useReducer=function(V,Y,Z){return W.current.useReducer(V,Y,Z)},Gt.useRef=function(V){return W.current.useRef(V)},Gt.useState=function(V){return W.current.useState(V)},Gt.useSyncExternalStore=function(V,Y,Z){return W.current.useSyncExternalStore(V,Y,Z)},Gt.useTransition=function(){return W.current.useTransition()},Gt.version="18.3.1",Gt}var CC;function vh(){return CC||(CC=1,b1.exports=U_()),b1.exports}var NC;function G_(){if(NC)return bp;NC=1;var t=vh(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function s(o,l,u){var c,f={},m=null,g=null;u!==void 0&&(m=""+u),l.key!==void 0&&(m=""+l.key),l.ref!==void 0&&(g=l.ref);for(c in l)n.call(l,c)&&!a.hasOwnProperty(c)&&(f[c]=l[c]);if(o&&o.defaultProps)for(c in l=o.defaultProps,l)f[c]===void 0&&(f[c]=l[c]);return{$$typeof:e,type:o,key:m,ref:g,props:f,_owner:i.current}}return bp.Fragment=r,bp.jsx=s,bp.jsxs=s,bp}var EC;function H_(){return EC||(EC=1,x1.exports=G_()),x1.exports}var h=H_(),se=vh();const Kt=gh(se),q_=V_({__proto__:null,default:Kt},[se]);var Wv={},w1={exports:{}},ma={},S1={exports:{}},k1={};var TC;function W_(){return TC||(TC=1,(function(t){function e($,X){var Q=$.length;$.push(X);e:for(;0<Q;){var V=Q-1>>>1,Y=$[V];if(0<i(Y,X))$[V]=X,$[Q]=Y,Q=V;else break e}}function r($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var X=$[0],Q=$.pop();if(Q!==X){$[0]=Q;e:for(var V=0,Y=$.length,Z=Y>>>1;V<Z;){var ie=2*(V+1)-1,ce=$[ie],he=ie+1,ee=$[he];if(0>i(ce,Q))he<Y&&0>i(ee,ce)?($[V]=ee,$[he]=Q,V=he):($[V]=ce,$[ie]=Q,V=ie);else if(he<Y&&0>i(ee,Q))$[V]=ee,$[he]=Q,V=he;else break e}}return X}function i($,X){var Q=$.sortIndex-X.sortIndex;return Q!==0?Q:$.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();t.unstable_now=function(){return s.now()-o}}var l=[],u=[],c=1,f=null,m=3,g=!1,y=!1,b=!1,w=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C($){for(var X=r(u);X!==null;){if(X.callback===null)n(u);else if(X.startTime<=$)n(u),X.sortIndex=X.expirationTime,e(l,X);else break;X=r(u)}}function E($){if(b=!1,C($),!y)if(r(l)!==null)y=!0,G(P);else{var X=r(u);X!==null&&W(E,X.startTime-$)}}function P($,X){y=!1,b&&(b=!1,N(I),I=-1),g=!0;var Q=m;try{for(C(X),f=r(l);f!==null&&(!(f.expirationTime>X)||$&&!U());){var V=f.callback;if(typeof V=="function"){f.callback=null,m=f.priorityLevel;var Y=V(f.expirationTime<=X);X=t.unstable_now(),typeof Y=="function"?f.callback=Y:f===r(l)&&n(l),C(X)}else n(l);f=r(l)}if(f!==null)var Z=!0;else{var ie=r(u);ie!==null&&W(E,ie.startTime-X),Z=!1}return Z}finally{f=null,m=Q,g=!1}}var _=!1,A=null,I=-1,D=5,L=-1;function U(){return!(t.unstable_now()-L<D)}function H(){if(A!==null){var $=t.unstable_now();L=$;var X=!0;try{X=A(!0,$)}finally{X?M():(_=!1,A=null)}}else _=!1}var M;if(typeof k=="function")M=function(){k(H)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,O=z.port2;z.port1.onmessage=H,M=function(){O.postMessage(null)}}else M=function(){w(H,0)};function G($){A=$,_||(_=!0,M())}function W($,X){I=w(function(){$(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){y||g||(y=!0,G(P))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function($){switch(m){case 1:case 2:case 3:var X=3;break;default:X=m}var Q=m;m=X;try{return $()}finally{m=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,X){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Q=m;m=$;try{return X()}finally{m=Q}},t.unstable_scheduleCallback=function($,X,Q){var V=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?V+Q:V):Q=V,$){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=Q+Y,$={id:c++,callback:X,priorityLevel:$,startTime:Q,expirationTime:Y,sortIndex:-1},Q>V?($.sortIndex=Q,e(u,$),r(l)===null&&$===r(u)&&(b?(N(I),I=-1):b=!0,W(E,Q-V))):($.sortIndex=Y,e(l,$),y||g||(y=!0,G(P))),$},t.unstable_shouldYield=U,t.unstable_wrapCallback=function($){var X=m;return function(){var Q=m;m=X;try{return $.apply(this,arguments)}finally{m=Q}}}})(k1)),k1}var jC;function vS(){return jC||(jC=1,S1.exports=W_()),S1.exports}var PC;function $_(){if(PC)return ma;PC=1;var t=vh(),e=vS();function r(d){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+d,S=1;S<arguments.length;S++)p+="&args[]="+encodeURIComponent(arguments[S]);return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(d,p){s(d,p),s(d+"Capture",p)}function s(d,p){for(i[d]=p,d=0;d<p.length;d++)n.add(p[d])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c={},f={};function m(d){return l.call(f,d)?!0:l.call(c,d)?!1:u.test(d)?f[d]=!0:(c[d]=!0,!1)}function g(d,p,S,j){if(S!==null&&S.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return j?!1:S!==null?!S.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function y(d,p,S,j){if(p===null||typeof p>"u"||g(d,p,S,j))return!0;if(j)return!1;if(S!==null)switch(S.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function b(d,p,S,j,B,q,J){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=j,this.attributeNamespace=B,this.mustUseProperty=S,this.propertyName=d,this.type=p,this.sanitizeURL=q,this.removeEmptyString=J}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){w[d]=new b(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var p=d[0];w[p]=new b(p,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){w[d]=new b(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){w[d]=new b(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){w[d]=new b(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){w[d]=new b(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){w[d]=new b(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){w[d]=new b(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){w[d]=new b(d,5,!1,d.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function k(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var p=d.replace(N,k);w[p]=new b(p,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var p=d.replace(N,k);w[p]=new b(p,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var p=d.replace(N,k);w[p]=new b(p,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){w[d]=new b(d,1,!1,d.toLowerCase(),null,!1,!1)}),w.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){w[d]=new b(d,1,!1,d.toLowerCase(),null,!0,!0)});function C(d,p,S,j){var B=w.hasOwnProperty(p)?w[p]:null;(B!==null?B.type!==0:j||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(y(p,S,B,j)&&(S=null),j||B===null?m(p)&&(S===null?d.removeAttribute(p):d.setAttribute(p,""+S)):B.mustUseProperty?d[B.propertyName]=S===null?B.type===3?!1:"":S:(p=B.attributeName,j=B.attributeNamespace,S===null?d.removeAttribute(p):(B=B.type,S=B===3||B===4&&S===!0?"":""+S,j?d.setAttributeNS(j,p,S):d.setAttribute(p,S))))}var E=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,P=Symbol.for("react.element"),_=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),U=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),W=Symbol.for("react.offscreen"),$=Symbol.iterator;function X(d){return d===null||typeof d!="object"?null:(d=$&&d[$]||d["@@iterator"],typeof d=="function"?d:null)}var Q=Object.assign,V;function Y(d){if(V===void 0)try{throw Error()}catch(S){var p=S.stack.trim().match(/\n( *(at )?)/);V=p&&p[1]||""}return`
`+V+d}var Z=!1;function ie(d,p){if(!d||Z)return"";Z=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(Ee){var j=Ee}Reflect.construct(d,[],p)}else{try{p.call()}catch(Ee){j=Ee}d.call(p.prototype)}else{try{throw Error()}catch(Ee){j=Ee}d()}}catch(Ee){if(Ee&&j&&typeof Ee.stack=="string"){for(var B=Ee.stack.split(`
`),q=j.stack.split(`
`),J=B.length-1,de=q.length-1;1<=J&&0<=de&&B[J]!==q[de];)de--;for(;1<=J&&0<=de;J--,de--)if(B[J]!==q[de]){if(J!==1||de!==1)do if(J--,de--,0>de||B[J]!==q[de]){var me=`
`+B[J].replace(" at new "," at ");return d.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",d.displayName)),me}while(1<=J&&0<=de);break}}}finally{Z=!1,Error.prepareStackTrace=S}return(d=d?d.displayName||d.name:"")?Y(d):""}function ce(d){switch(d.tag){case 5:return Y(d.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 2:case 15:return d=ie(d.type,!1),d;case 11:return d=ie(d.type.render,!1),d;case 1:return d=ie(d.type,!0),d;default:return""}}function he(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case A:return"Fragment";case _:return"Portal";case D:return"Profiler";case I:return"StrictMode";case M:return"Suspense";case z:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case U:return(d.displayName||"Context")+".Consumer";case L:return(d._context.displayName||"Context")+".Provider";case H:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case O:return p=d.displayName||null,p!==null?p:he(d.type)||"Memo";case G:p=d._payload,d=d._init;try{return he(d(p))}catch{}}return null}function ee(d){var p=d.type;switch(d.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=p.render,d=d.displayName||d.name||"",p.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return he(p);case 8:return p===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function le(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function te(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function ae(d){var p=te(d)?"checked":"value",S=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),j=""+d[p];if(!d.hasOwnProperty(p)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var B=S.get,q=S.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return B.call(this)},set:function(J){j=""+J,q.call(this,J)}}),Object.defineProperty(d,p,{enumerable:S.enumerable}),{getValue:function(){return j},setValue:function(J){j=""+J},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function oe(d){d._valueTracker||(d._valueTracker=ae(d))}function fe(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var S=p.getValue(),j="";return d&&(j=te(d)?d.checked?"true":"false":d.value),d=j,d!==S?(p.setValue(d),!0):!1}function pe(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Te(d,p){var S=p.checked;return Q({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:S??d._wrapperState.initialChecked})}function Oe(d,p){var S=p.defaultValue==null?"":p.defaultValue,j=p.checked!=null?p.checked:p.defaultChecked;S=le(p.value!=null?p.value:S),d._wrapperState={initialChecked:j,initialValue:S,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function _e(d,p){p=p.checked,p!=null&&C(d,"checked",p,!1)}function Ae(d,p){_e(d,p);var S=le(p.value),j=p.type;if(S!=null)j==="number"?(S===0&&d.value===""||d.value!=S)&&(d.value=""+S):d.value!==""+S&&(d.value=""+S);else if(j==="submit"||j==="reset"){d.removeAttribute("value");return}p.hasOwnProperty("value")?tt(d,p.type,S):p.hasOwnProperty("defaultValue")&&tt(d,p.type,le(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function He(d,p,S){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var j=p.type;if(!(j!=="submit"&&j!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+d._wrapperState.initialValue,S||p===d.value||(d.value=p),d.defaultValue=p}S=d.name,S!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,S!==""&&(d.name=S)}function tt(d,p,S){(p!=="number"||pe(d.ownerDocument)!==d)&&(S==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+S&&(d.defaultValue=""+S))}var Ie=Array.isArray;function ye(d,p,S,j){if(d=d.options,p){p={};for(var B=0;B<S.length;B++)p["$"+S[B]]=!0;for(S=0;S<d.length;S++)B=p.hasOwnProperty("$"+d[S].value),d[S].selected!==B&&(d[S].selected=B),B&&j&&(d[S].defaultSelected=!0)}else{for(S=""+le(S),p=null,B=0;B<d.length;B++){if(d[B].value===S){d[B].selected=!0,j&&(d[B].defaultSelected=!0);return}p!==null||d[B].disabled||(p=d[B])}p!==null&&(p.selected=!0)}}function Pe(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(r(91));return Q({},p,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function Be(d,p){var S=p.value;if(S==null){if(S=p.children,p=p.defaultValue,S!=null){if(p!=null)throw Error(r(92));if(Ie(S)){if(1<S.length)throw Error(r(93));S=S[0]}p=S}p==null&&(p=""),S=p}d._wrapperState={initialValue:le(S)}}function Ge(d,p){var S=le(p.value),j=le(p.defaultValue);S!=null&&(S=""+S,S!==d.value&&(d.value=S),p.defaultValue==null&&d.defaultValue!==S&&(d.defaultValue=S)),j!=null&&(d.defaultValue=""+j)}function et(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==""&&p!==null&&(d.value=p)}function mt(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gt(d,p){return d==null||d==="http://www.w3.org/1999/xhtml"?mt(p):d==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var bt,_t=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,S,j,B){MSApp.execUnsafeLocalFunction(function(){return d(p,S,j,B)})}:d})(function(d,p){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=p;else{for(bt=bt||document.createElement("div"),bt.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=bt.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function ot(d,p){if(p){var S=d.firstChild;if(S&&S===d.lastChild&&S.nodeType===3){S.nodeValue=p;return}}d.textContent=p}var Ye={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},De=["Webkit","ms","Moz","O"];Object.keys(Ye).forEach(function(d){De.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),Ye[p]=Ye[d]})});function re(d,p,S){return p==null||typeof p=="boolean"||p===""?"":S||typeof p!="number"||p===0||Ye.hasOwnProperty(d)&&Ye[d]?(""+p).trim():p+"px"}function ue(d,p){d=d.style;for(var S in p)if(p.hasOwnProperty(S)){var j=S.indexOf("--")===0,B=re(S,p[S],j);S==="float"&&(S="cssFloat"),j?d.setProperty(S,B):d[S]=B}}var ge=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(d,p){if(p){if(ge[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(r(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(r(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(r(61))}if(p.style!=null&&typeof p.style!="object")throw Error(r(62))}}function Ce(d,p){if(d.indexOf("-")===-1)return typeof p.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Le=null;function Re(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Ze=null,Je=null,dt=null;function Nt(d){if(d=kc(d)){if(typeof Ze!="function")throw Error(r(280));var p=d.stateNode;p&&(p=Nn(p),Ze(d.stateNode,d.type,p))}}function Et(d){Je?dt?dt.push(d):dt=[d]:Je=d}function it(){if(Je){var d=Je,p=dt;if(dt=Je=null,Nt(d),p)for(d=0;d<p.length;d++)Nt(p[d])}}function jt(d,p){return d(p)}function Pt(){}var ar=!1;function Xt(d,p,S){if(ar)return d(p,S);ar=!0;try{return jt(d,p,S)}finally{ar=!1,(Je!==null||dt!==null)&&(Pt(),it())}}function $r(d,p){var S=d.stateNode;if(S===null)return null;var j=Nn(S);if(j===null)return null;S=j[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(j=!j.disabled)||(d=d.type,j=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!j;break e;default:d=!1}if(d)return null;if(S&&typeof S!="function")throw Error(r(231,p,typeof S));return S}var Er=!1;if(o)try{var Tr={};Object.defineProperty(Tr,"passive",{get:function(){Er=!0}}),window.addEventListener("test",Tr,Tr),window.removeEventListener("test",Tr,Tr)}catch{Er=!1}function Fr(d,p,S,j,B,q,J,de,me){var Ee=Array.prototype.slice.call(arguments,3);try{p.apply(S,Ee)}catch(ze){this.onError(ze)}}var xr=!1,Fi=null,br=!1,Gn=null,Ta={onError:function(d){xr=!0,Fi=d}};function zs(d,p,S,j,B,q,J,de,me){xr=!1,Fi=null,Fr.apply(Ta,arguments)}function wl(d,p,S,j,B,q,J,de,me){if(zs.apply(this,arguments),xr){if(xr){var Ee=Fi;xr=!1,Fi=null}else throw Error(r(198));br||(br=!0,Gn=Ee)}}function oi(d){var p=d,S=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(S=p.return),d=p.return;while(d)}return p.tag===3?S:null}function An(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function cn(d){if(oi(d)!==d)throw Error(r(188))}function Hn(d){var p=d.alternate;if(!p){if(p=oi(d),p===null)throw Error(r(188));return p!==d?null:d}for(var S=d,j=p;;){var B=S.return;if(B===null)break;var q=B.alternate;if(q===null){if(j=B.return,j!==null){S=j;continue}break}if(B.child===q.child){for(q=B.child;q;){if(q===S)return cn(B),d;if(q===j)return cn(B),p;q=q.sibling}throw Error(r(188))}if(S.return!==j.return)S=B,j=q;else{for(var J=!1,de=B.child;de;){if(de===S){J=!0,S=B,j=q;break}if(de===j){J=!0,j=B,S=q;break}de=de.sibling}if(!J){for(de=q.child;de;){if(de===S){J=!0,S=q,j=B;break}if(de===j){J=!0,j=q,S=B;break}de=de.sibling}if(!J)throw Error(r(189))}}if(S.alternate!==j)throw Error(r(190))}if(S.tag!==3)throw Error(r(188));return S.stateNode.current===S?d:p}function Vs(d){return d=Hn(d),d!==null?li(d):null}function li(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=li(d);if(p!==null)return p;d=d.sibling}return null}var ic=e.unstable_scheduleCallback,Td=e.unstable_cancelCallback,Th=e.unstable_shouldYield,jh=e.unstable_requestPaint,Dr=e.unstable_now,ac=e.unstable_getCurrentPriorityLevel,gs=e.unstable_ImmediatePriority,Sl=e.unstable_UserBlockingPriority,ia=e.unstable_NormalPriority,sc=e.unstable_LowPriority,vs=e.unstable_IdlePriority,aa=null,Jr=null;function ur(d){if(Jr&&typeof Jr.onCommitFiberRoot=="function")try{Jr.onCommitFiberRoot(aa,d,void 0,(d.current.flags&128)===128)}catch{}}var Tt=Math.clz32?Math.clz32:Zr,sa=Math.log,dn=Math.LN2;function Zr(d){return d>>>=0,d===0?32:31-(sa(d)/dn|0)|0}var zr=64,ja=4194304;function fn(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function ys(d,p){var S=d.pendingLanes;if(S===0)return 0;var j=0,B=d.suspendedLanes,q=d.pingedLanes,J=S&268435455;if(J!==0){var de=J&~B;de!==0?j=fn(de):(q&=J,q!==0&&(j=fn(q)))}else J=S&~B,J!==0?j=fn(J):q!==0&&(j=fn(q));if(j===0)return 0;if(p!==0&&p!==j&&(p&B)===0&&(B=j&-j,q=p&-p,B>=q||B===16&&(q&4194240)!==0))return p;if((j&4)!==0&&(j|=S&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=j;0<p;)S=31-Tt(p),B=1<<S,j|=d[S],p&=~B;return j}function Hg(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qg(d,p){for(var S=d.suspendedLanes,j=d.pingedLanes,B=d.expirationTimes,q=d.pendingLanes;0<q;){var J=31-Tt(q),de=1<<J,me=B[J];me===-1?((de&S)===0||(de&j)!==0)&&(B[J]=Hg(de,p)):me<=p&&(d.expiredLanes|=de),q&=~de}}function kl(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function Ph(){var d=zr;return zr<<=1,(zr&4194240)===0&&(zr=64),d}function zi(d){for(var p=[],S=0;31>S;S++)p.push(d);return p}function oc(d,p,S){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-Tt(p),d[p]=S}function Ux(d,p){var S=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var j=d.eventTimes;for(d=d.expirationTimes;0<S;){var B=31-Tt(S),q=1<<B;p[B]=0,j[B]=-1,d[B]=-1,S&=~q}}function Mh(d,p){var S=d.entangledLanes|=p;for(d=d.entanglements;S;){var j=31-Tt(S),B=1<<j;B&p|d[j]&p&&(d[j]|=p),S&=~B}}var Yt=0;function lc(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var Cl,Nl,Wg,$g,jd,Pd=!1,El=[],oa=null,Us=null,Ga=null,Ut=new Map,Tl=new Map,Ha=[],Kg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yg(d,p){switch(d){case"focusin":case"focusout":oa=null;break;case"dragenter":case"dragleave":Us=null;break;case"mouseover":case"mouseout":Ga=null;break;case"pointerover":case"pointerout":Ut.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tl.delete(p.pointerId)}}function uc(d,p,S,j,B,q){return d===null||d.nativeEvent!==q?(d={blockedOn:p,domEventName:S,eventSystemFlags:j,nativeEvent:q,targetContainers:[B]},p!==null&&(p=kc(p),p!==null&&Nl(p)),d):(d.eventSystemFlags|=j,p=d.targetContainers,B!==null&&p.indexOf(B)===-1&&p.push(B),d)}function kn(d,p,S,j,B){switch(p){case"focusin":return oa=uc(oa,d,p,S,j,B),!0;case"dragenter":return Us=uc(Us,d,p,S,j,B),!0;case"mouseover":return Ga=uc(Ga,d,p,S,j,B),!0;case"pointerover":var q=B.pointerId;return Ut.set(q,uc(Ut.get(q)||null,d,p,S,j,B)),!0;case"gotpointercapture":return q=B.pointerId,Tl.set(q,uc(Tl.get(q)||null,d,p,S,j,B)),!0}return!1}function Md(d){var p=Js(d.target);if(p!==null){var S=oi(p);if(S!==null){if(p=S.tag,p===13){if(p=An(S),p!==null){d.blockedOn=p,jd(d.priority,function(){Wg(S)});return}}else if(p===3&&S.stateNode.current.memoizedState.isDehydrated){d.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}d.blockedOn=null}function _d(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var S=Dd(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(S===null){S=d.nativeEvent;var j=new S.constructor(S.type,S);Le=j,S.target.dispatchEvent(j),Le=null}else return p=kc(S),p!==null&&Nl(p),d.blockedOn=S,!1;p.shift()}return!0}function Ad(d,p,S){_d(d)&&S.delete(p)}function Gx(){Pd=!1,oa!==null&&_d(oa)&&(oa=null),Us!==null&&_d(Us)&&(Us=null),Ga!==null&&_d(Ga)&&(Ga=null),Ut.forEach(Ad),Tl.forEach(Ad)}function Gs(d,p){d.blockedOn===p&&(d.blockedOn=null,Pd||(Pd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Gx)))}function Ti(d){function p(B){return Gs(B,d)}if(0<El.length){Gs(El[0],d);for(var S=1;S<El.length;S++){var j=El[S];j.blockedOn===d&&(j.blockedOn=null)}}for(oa!==null&&Gs(oa,d),Us!==null&&Gs(Us,d),Ga!==null&&Gs(Ga,d),Ut.forEach(p),Tl.forEach(p),S=0;S<Ha.length;S++)j=Ha[S],j.blockedOn===d&&(j.blockedOn=null);for(;0<Ha.length&&(S=Ha[0],S.blockedOn===null);)Md(S),S.blockedOn===null&&Ha.shift()}var jl=E.ReactCurrentBatchConfig,Rd=!0;function Pa(d,p,S,j){var B=Yt,q=jl.transition;jl.transition=null;try{Yt=1,Pl(d,p,S,j)}finally{Yt=B,jl.transition=q}}function xs(d,p,S,j){var B=Yt,q=jl.transition;jl.transition=null;try{Yt=4,Pl(d,p,S,j)}finally{Yt=B,jl.transition=q}}function Pl(d,p,S,j){if(Rd){var B=Dd(d,p,S,j);if(B===null)Xd(d,p,j,Ml,S),Yg(d,j);else if(kn(B,d,p,S,j))j.stopPropagation();else if(Yg(d,j),p&4&&-1<Kg.indexOf(d)){for(;B!==null;){var q=kc(B);if(q!==null&&Cl(q),q=Dd(d,p,S,j),q===null&&Xd(d,p,j,Ml,S),q===B)break;B=q}B!==null&&j.stopPropagation()}else Xd(d,p,j,null,S)}}var Ml=null;function Dd(d,p,S,j){if(Ml=null,d=Re(j),d=Js(d),d!==null)if(p=oi(d),p===null)d=null;else if(S=p.tag,S===13){if(d=An(p),d!==null)return d;d=null}else if(S===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return Ml=d,null}function Xg(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ac()){case gs:return 1;case Sl:return 4;case ia:case sc:return 16;case vs:return 536870912;default:return 16}default:return 16}}var Rn=null,Hs=null,bs=null;function cc(){if(bs)return bs;var d,p=Hs,S=p.length,j,B="value"in Rn?Rn.value:Rn.textContent,q=B.length;for(d=0;d<S&&p[d]===B[d];d++);var J=S-d;for(j=1;j<=J&&p[S-j]===B[q-j];j++);return bs=B.slice(d,1<j?1-j:void 0)}function To(d){var p=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function ui(){return!0}function Vi(){return!1}function hn(d){function p(S,j,B,q,J){this._reactName=S,this._targetInst=B,this.type=j,this.nativeEvent=q,this.target=J,this.currentTarget=null;for(var de in d)d.hasOwnProperty(de)&&(S=d[de],this[de]=S?S(q):q[de]);return this.isDefaultPrevented=(q.defaultPrevented!=null?q.defaultPrevented:q.returnValue===!1)?ui:Vi,this.isPropagationStopped=Vi,this}return Q(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=ui)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=ui)},persist:function(){},isPersistent:ui}),p}var ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ma=hn(ji),_a=Q({},ji,{view:0,detail:0}),Qg=hn(_a),dc,fc,Dn,ci=Q({},_a,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Po,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Dn&&(Dn&&d.type==="mousemove"?(dc=d.screenX-Dn.screenX,fc=d.screenY-Dn.screenY):fc=dc=0,Dn=d),dc)},movementY:function(d){return"movementY"in d?d.movementY:fc}}),wr=hn(ci),hc=Q({},ci,{dataTransfer:0}),Aa=hn(hc),Jg=Q({},_a,{relatedTarget:0}),Od=hn(Jg),_h=Q({},ji,{animationName:0,elapsedTime:0,pseudoElement:0}),Ah=hn(_h),Zg=Q({},ji,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),Id=hn(Zg),ev=Q({},ji,{data:0}),jo=hn(ev),Rh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ld={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qx(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=Ld[d])?!!p[d]:!1}function Po(){return qx}var Bd=Q({},_a,{key:function(d){if(d.key){var p=Rh[d.key]||d.key;if(p!=="Unidentified")return p}return d.type==="keypress"?(d=To(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Hx[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Po,charCode:function(d){return d.type==="keypress"?To(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?To(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),tv=hn(Bd),rv=Q({},ci,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mo=hn(rv),nv=Q({},_a,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Po}),Fd=hn(nv),zd=Q({},ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),_l=hn(zd),Dh=Q({},ci,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Oh=hn(Dh),iv=[9,13,27,32],pc=o&&"CompositionEvent"in window,_o=null;o&&"documentMode"in document&&(_o=document.documentMode);var Al=o&&"TextEvent"in window&&!_o,Ui=o&&(!pc||_o&&8<_o&&11>=_o),qs=" ",Vd=!1;function Ih(d,p){switch(d){case"keyup":return iv.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ra(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Gi=!1;function Lh(d,p){switch(d){case"compositionend":return Ra(p);case"keypress":return p.which!==32?null:(Vd=!0,qs);case"textInput":return d=p.data,d===qs&&Vd?null:d;default:return null}}function av(d,p){if(Gi)return d==="compositionend"||!pc&&Ih(d,p)?(d=cc(),bs=Hs=Rn=null,Gi=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return Ui&&p.locale!=="ko"?null:p.data;default:return null}}var ws={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ss(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p==="input"?!!ws[d.type]:p==="textarea"}function mc(d,p,S,j){Et(j),p=Qd(p,"onChange"),0<p.length&&(S=new Ma("onChange","change",null,S,j),d.push({event:S,listeners:p}))}var Rl=null,Ws=null;function sv(d){Kh(d,0)}function $s(d){var p=mn(d);if(fe(p))return d}function la(d,p){if(d==="change")return p}var Dl=!1;if(o){var Ks;if(o){var ua="oninput"in document;if(!ua){var Ud=document.createElement("div");Ud.setAttribute("oninput","return;"),ua=typeof Ud.oninput=="function"}Ks=ua}else Ks=!1;Dl=Ks&&(!document.documentMode||9<document.documentMode)}function Ao(){Rl&&(Rl.detachEvent("onpropertychange",Bh),Ws=Rl=null)}function Bh(d){if(d.propertyName==="value"&&$s(Ws)){var p=[];mc(p,Ws,d,Re(d)),Xt(sv,p)}}function Fh(d,p,S){d==="focusin"?(Ao(),Rl=p,Ws=S,Rl.attachEvent("onpropertychange",Bh)):d==="focusout"&&Ao()}function Or(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return $s(Ws)}function Gd(d,p){if(d==="click")return $s(p)}function zh(d,p){if(d==="input"||d==="change")return $s(p)}function Vh(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var Pi=typeof Object.is=="function"?Object.is:Vh;function Ro(d,p){if(Pi(d,p))return!0;if(typeof d!="object"||d===null||typeof p!="object"||p===null)return!1;var S=Object.keys(d),j=Object.keys(p);if(S.length!==j.length)return!1;for(j=0;j<S.length;j++){var B=S[j];if(!l.call(p,B)||!Pi(d[B],p[B]))return!1}return!0}function Ys(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function jr(d,p){var S=Ys(d);d=0;for(var j;S;){if(S.nodeType===3){if(j=d+S.textContent.length,d<=p&&j>=p)return{node:S,offset:p-d};d=j}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=Ys(S)}}function en(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?en(d,p.parentNode):"contains"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function pn(){for(var d=window,p=pe();p instanceof d.HTMLIFrameElement;){try{var S=typeof p.contentWindow.location.href=="string"}catch{S=!1}if(S)d=p.contentWindow;else break;p=pe(d.document)}return p}function Ol(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||p==="textarea"||d.contentEditable==="true")}function gc(d){var p=pn(),S=d.focusedElem,j=d.selectionRange;if(p!==S&&S&&S.ownerDocument&&en(S.ownerDocument.documentElement,S)){if(j!==null&&Ol(S)){if(p=j.start,d=j.end,d===void 0&&(d=p),"selectionStart"in S)S.selectionStart=p,S.selectionEnd=Math.min(d,S.value.length);else if(d=(p=S.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var B=S.textContent.length,q=Math.min(j.start,B);j=j.end===void 0?q:Math.min(j.end,B),!d.extend&&q>j&&(B=j,j=q,q=B),B=jr(S,q);var J=jr(S,j);B&&J&&(d.rangeCount!==1||d.anchorNode!==B.node||d.anchorOffset!==B.offset||d.focusNode!==J.node||d.focusOffset!==J.offset)&&(p=p.createRange(),p.setStart(B.node,B.offset),d.removeAllRanges(),q>j?(d.addRange(p),d.extend(J.node,J.offset)):(p.setEnd(J.node,J.offset),d.addRange(p)))}}for(p=[],d=S;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<p.length;S++)d=p[S],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var vc=o&&"documentMode"in document&&11>=document.documentMode,Il=null,Cn=null,Do=null,yc=!1;function Hd(d,p,S){var j=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;yc||Il==null||Il!==pe(j)||(j=Il,"selectionStart"in j&&Ol(j)?j={start:j.selectionStart,end:j.selectionEnd}:(j=(j.ownerDocument&&j.ownerDocument.defaultView||window).getSelection(),j={anchorNode:j.anchorNode,anchorOffset:j.anchorOffset,focusNode:j.focusNode,focusOffset:j.focusOffset}),Do&&Ro(Do,j)||(Do=j,j=Qd(Cn,"onSelect"),0<j.length&&(p=new Ma("onSelect","select",null,p,S),d.push({event:p,listeners:j}),p.target=Il)))}function Hi(d,p){var S={};return S[d.toLowerCase()]=p.toLowerCase(),S["Webkit"+d]="webkit"+p,S["Moz"+d]="moz"+p,S}var On={animationend:Hi("Animation","AnimationEnd"),animationiteration:Hi("Animation","AnimationIteration"),animationstart:Hi("Animation","AnimationStart"),transitionend:Hi("Transition","TransitionEnd")},Oo={},qd={};o&&(qd=document.createElement("div").style,"AnimationEvent"in window||(delete On.animationend.animation,delete On.animationiteration.animation,delete On.animationstart.animation),"TransitionEvent"in window||delete On.transitionend.transition);function Ll(d){if(Oo[d])return Oo[d];if(!On[d])return d;var p=On[d],S;for(S in p)if(p.hasOwnProperty(S)&&S in qd)return Oo[d]=p[S];return d}var Uh=Ll("animationend"),Gh=Ll("animationiteration"),Hh=Ll("animationstart"),qh=Ll("transitionend"),Wh=new Map,$h="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ks(d,p){Wh.set(d,p),a(p,[d])}for(var Wd=0;Wd<$h.length;Wd++){var Io=$h[Wd],ov=Io.toLowerCase(),$d=Io[0].toUpperCase()+Io.slice(1);ks(ov,"on"+$d)}ks(Uh,"onAnimationEnd"),ks(Gh,"onAnimationIteration"),ks(Hh,"onAnimationStart"),ks("dblclick","onDoubleClick"),ks("focusin","onFocus"),ks("focusout","onBlur"),ks(qh,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xs));function Kd(d,p,S){var j=d.type||"unknown-event";d.currentTarget=S,wl(j,p,void 0,d),d.currentTarget=null}function Kh(d,p){p=(p&4)!==0;for(var S=0;S<d.length;S++){var j=d[S],B=j.event;j=j.listeners;e:{var q=void 0;if(p)for(var J=j.length-1;0<=J;J--){var de=j[J],me=de.instance,Ee=de.currentTarget;if(de=de.listener,me!==q&&B.isPropagationStopped())break e;Kd(B,de,Ee),q=me}else for(J=0;J<j.length;J++){if(de=j[J],me=de.instance,Ee=de.currentTarget,de=de.listener,me!==q&&B.isPropagationStopped())break e;Kd(B,de,Ee),q=me}}}if(br)throw d=Gn,br=!1,Gn=null,d}function hr(d,p){var S=p[Zd];S===void 0&&(S=p[Zd]=new Set);var j=d+"__bubble";S.has(j)||(Yh(p,d,2,!1),S.add(j))}function Yd(d,p,S){var j=0;p&&(j|=4),Yh(S,d,j,p)}var xc="_reactListening"+Math.random().toString(36).slice(2);function Lo(d){if(!d[xc]){d[xc]=!0,n.forEach(function(S){S!=="selectionchange"&&(lv.has(S)||Yd(S,!1,d),Yd(S,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[xc]||(p[xc]=!0,Yd("selectionchange",!1,p))}}function Yh(d,p,S,j){switch(Xg(p)){case 1:var B=Pa;break;case 4:B=xs;break;default:B=Pl}S=B.bind(null,p,S,d),B=void 0,!Er||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(B=!0),j?B!==void 0?d.addEventListener(p,S,{capture:!0,passive:B}):d.addEventListener(p,S,!0):B!==void 0?d.addEventListener(p,S,{passive:B}):d.addEventListener(p,S,!1)}function Xd(d,p,S,j,B){var q=j;if((p&1)===0&&(p&2)===0&&j!==null)e:for(;;){if(j===null)return;var J=j.tag;if(J===3||J===4){var de=j.stateNode.containerInfo;if(de===B||de.nodeType===8&&de.parentNode===B)break;if(J===4)for(J=j.return;J!==null;){var me=J.tag;if((me===3||me===4)&&(me=J.stateNode.containerInfo,me===B||me.nodeType===8&&me.parentNode===B))return;J=J.return}for(;de!==null;){if(J=Js(de),J===null)return;if(me=J.tag,me===5||me===6){j=q=J;continue e}de=de.parentNode}}j=j.return}Xt(function(){var Ee=q,ze=Re(S),Ue=[];e:{var Fe=Wh.get(d);if(Fe!==void 0){var at=Ma,ft=d;switch(d){case"keypress":if(To(S)===0)break e;case"keydown":case"keyup":at=tv;break;case"focusin":ft="focus",at=Od;break;case"focusout":ft="blur",at=Od;break;case"beforeblur":case"afterblur":at=Od;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=wr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=Aa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=Fd;break;case Uh:case Gh:case Hh:at=Ah;break;case qh:at=_l;break;case"scroll":at=Qg;break;case"wheel":at=Oh;break;case"copy":case"cut":case"paste":at=Id;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=Mo}var ht=(p&4)!==0,xn=!ht&&d==="scroll",Se=ht?Fe!==null?Fe+"Capture":null:Fe;ht=[];for(var ve=Ee,ke;ve!==null;){ke=ve;var Ke=ke.stateNode;if(ke.tag===5&&Ke!==null&&(ke=Ke,Se!==null&&(Ke=$r(ve,Se),Ke!=null&&ht.push(Bl(ve,Ke,ke)))),xn)break;ve=ve.return}0<ht.length&&(Fe=new at(Fe,ft,null,S,ze),Ue.push({event:Fe,listeners:ht}))}}if((p&7)===0){e:{if(Fe=d==="mouseover"||d==="pointerover",at=d==="mouseout"||d==="pointerout",Fe&&S!==Le&&(ft=S.relatedTarget||S.fromElement)&&(Js(ft)||ft[Wa]))break e;if((at||Fe)&&(Fe=ze.window===ze?ze:(Fe=ze.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,at?(ft=S.relatedTarget||S.toElement,at=Ee,ft=ft?Js(ft):null,ft!==null&&(xn=oi(ft),ft!==xn||ft.tag!==5&&ft.tag!==6)&&(ft=null)):(at=null,ft=Ee),at!==ft)){if(ht=wr,Ke="onMouseLeave",Se="onMouseEnter",ve="mouse",(d==="pointerout"||d==="pointerover")&&(ht=Mo,Ke="onPointerLeave",Se="onPointerEnter",ve="pointer"),xn=at==null?Fe:mn(at),ke=ft==null?Fe:mn(ft),Fe=new ht(Ke,ve+"leave",at,S,ze),Fe.target=xn,Fe.relatedTarget=ke,Ke=null,Js(ze)===Ee&&(ht=new ht(Se,ve+"enter",ft,S,ze),ht.target=ke,ht.relatedTarget=xn,Ke=ht),xn=Ke,at&&ft)t:{for(ht=at,Se=ft,ve=0,ke=ht;ke;ke=Bo(ke))ve++;for(ke=0,Ke=Se;Ke;Ke=Bo(Ke))ke++;for(;0<ve-ke;)ht=Bo(ht),ve--;for(;0<ke-ve;)Se=Bo(Se),ke--;for(;ve--;){if(ht===Se||Se!==null&&ht===Se.alternate)break t;ht=Bo(ht),Se=Bo(Se)}ht=null}else ht=null;at!==null&&uv(Ue,Fe,at,ht,!1),ft!==null&&xn!==null&&uv(Ue,xn,ft,ht,!0)}}e:{if(Fe=Ee?mn(Ee):window,at=Fe.nodeName&&Fe.nodeName.toLowerCase(),at==="select"||at==="input"&&Fe.type==="file")var pt=la;else if(Ss(Fe))if(Dl)pt=zh;else{pt=Or;var St=Fh}else(at=Fe.nodeName)&&at.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(pt=Gd);if(pt&&(pt=pt(d,Ee))){mc(Ue,pt,S,ze);break e}St&&St(d,Fe,Ee),d==="focusout"&&(St=Fe._wrapperState)&&St.controlled&&Fe.type==="number"&&tt(Fe,"number",Fe.value)}switch(St=Ee?mn(Ee):window,d){case"focusin":(Ss(St)||St.contentEditable==="true")&&(Il=St,Cn=Ee,Do=null);break;case"focusout":Do=Cn=Il=null;break;case"mousedown":yc=!0;break;case"contextmenu":case"mouseup":case"dragend":yc=!1,Hd(Ue,S,ze);break;case"selectionchange":if(vc)break;case"keydown":case"keyup":Hd(Ue,S,ze)}var kt;if(pc)e:{switch(d){case"compositionstart":var Mt="onCompositionStart";break e;case"compositionend":Mt="onCompositionEnd";break e;case"compositionupdate":Mt="onCompositionUpdate";break e}Mt=void 0}else Gi?Ih(d,S)&&(Mt="onCompositionEnd"):d==="keydown"&&S.keyCode===229&&(Mt="onCompositionStart");Mt&&(Ui&&S.locale!=="ko"&&(Gi||Mt!=="onCompositionStart"?Mt==="onCompositionEnd"&&Gi&&(kt=cc()):(Rn=ze,Hs="value"in Rn?Rn.value:Rn.textContent,Gi=!0)),St=Qd(Ee,Mt),0<St.length&&(Mt=new jo(Mt,d,null,S,ze),Ue.push({event:Mt,listeners:St}),kt?Mt.data=kt:(kt=Ra(S),kt!==null&&(Mt.data=kt)))),(kt=Al?Lh(d,S):av(d,S))&&(Ee=Qd(Ee,"onBeforeInput"),0<Ee.length&&(ze=new jo("onBeforeInput","beforeinput",null,S,ze),Ue.push({event:ze,listeners:Ee}),ze.data=kt))}Kh(Ue,p)})}function Bl(d,p,S){return{instance:d,listener:p,currentTarget:S}}function Qd(d,p){for(var S=p+"Capture",j=[];d!==null;){var B=d,q=B.stateNode;B.tag===5&&q!==null&&(B=q,q=$r(d,S),q!=null&&j.unshift(Bl(d,q,B)),q=$r(d,p),q!=null&&j.push(Bl(d,q,B))),d=d.return}return j}function Bo(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function uv(d,p,S,j,B){for(var q=p._reactName,J=[];S!==null&&S!==j;){var de=S,me=de.alternate,Ee=de.stateNode;if(me!==null&&me===j)break;de.tag===5&&Ee!==null&&(de=Ee,B?(me=$r(S,q),me!=null&&J.unshift(Bl(S,me,de))):B||(me=$r(S,q),me!=null&&J.push(Bl(S,me,de)))),S=S.return}J.length!==0&&d.push({event:p,listeners:J})}var Wx=/\r\n?/g,cv=/\u0000|\uFFFD/g;function Xh(d){return(typeof d=="string"?d:""+d).replace(Wx,`
`).replace(cv,"")}function bc(d,p,S){if(p=Xh(p),Xh(d)!==p&&S)throw Error(r(425))}function Fo(){}var Qh=null,Jh=null;function Zh(d,p){return d==="textarea"||d==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var qi=typeof setTimeout=="function"?setTimeout:void 0,ep=typeof clearTimeout=="function"?clearTimeout:void 0,wc=typeof Promise=="function"?Promise:void 0,dv=typeof queueMicrotask=="function"?queueMicrotask:typeof wc<"u"?function(d){return wc.resolve(null).then(d).catch(fv)}:qi;function fv(d){setTimeout(function(){throw d})}function Jd(d,p){var S=p,j=0;do{var B=S.nextSibling;if(d.removeChild(S),B&&B.nodeType===8)if(S=B.data,S==="/$"){if(j===0){d.removeChild(B),Ti(p);return}j--}else S!=="$"&&S!=="$?"&&S!=="$!"||j++;S=B}while(S);Ti(p)}function qa(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return d}function zo(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var S=d.data;if(S==="$"||S==="$!"||S==="$?"){if(p===0)return d;p--}else S==="/$"&&p++}d=d.previousSibling}return null}var Qs=Math.random().toString(36).slice(2),ca="__reactFiber$"+Qs,Sc="__reactProps$"+Qs,Wa="__reactContainer$"+Qs,Zd="__reactEvents$"+Qs,hv="__reactListeners$"+Qs,pv="__reactHandles$"+Qs;function Js(d){var p=d[ca];if(p)return p;for(var S=d.parentNode;S;){if(p=S[Wa]||S[ca]){if(S=p.alternate,p.child!==null||S!==null&&S.child!==null)for(d=zo(d);d!==null;){if(S=d[ca])return S;d=zo(d)}return p}d=S,S=d.parentNode}return null}function kc(d){return d=d[ca]||d[Wa],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function mn(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(r(33))}function Nn(d){return d[Sc]||null}var ef=[],Vo=-1;function Cs(d){return{current:d}}function pr(d){0>Vo||(d.current=ef[Vo],ef[Vo]=null,Vo--)}function cr(d,p){Vo++,ef[Vo]=d.current,d.current=p}var $a={},In=Cs($a),qn=Cs(!1),Zs=$a;function Uo(d,p){var S=d.type.contextTypes;if(!S)return $a;var j=d.stateNode;if(j&&j.__reactInternalMemoizedUnmaskedChildContext===p)return j.__reactInternalMemoizedMaskedChildContext;var B={},q;for(q in S)B[q]=p[q];return j&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=B),B}function Wn(d){return d=d.childContextTypes,d!=null}function Fl(){pr(qn),pr(In)}function tp(d,p,S){if(In.current!==$a)throw Error(r(168));cr(In,p),cr(qn,S)}function tf(d,p,S){var j=d.stateNode;if(p=p.childContextTypes,typeof j.getChildContext!="function")return S;j=j.getChildContext();for(var B in j)if(!(B in p))throw Error(r(108,ee(d)||"Unknown",B));return Q({},S,j)}function Go(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||$a,Zs=In.current,cr(In,d),cr(qn,qn.current),!0}function mv(d,p,S){var j=d.stateNode;if(!j)throw Error(r(169));S?(d=tf(d,p,Zs),j.__reactInternalMemoizedMergedChildContext=d,pr(qn),pr(In),cr(In,d)):pr(qn),cr(qn,S)}var Ka=null,zl=!1,rf=!1;function Cc(d){Ka===null?Ka=[d]:Ka.push(d)}function Ns(d){zl=!0,Cc(d)}function eo(){if(!rf&&Ka!==null){rf=!0;var d=0,p=Yt;try{var S=Ka;for(Yt=1;d<S.length;d++){var j=S[d];do j=j(!0);while(j!==null)}Ka=null,zl=!1}catch(B){throw Ka!==null&&(Ka=Ka.slice(d+1)),ic(gs,eo),B}finally{Yt=p,rf=!1}}return null}var di=[],Ho=0,to=null,ro=0,fi=[],hi=0,no=null,Wi=1,Pr="";function qo(d,p){di[Ho++]=ro,di[Ho++]=to,to=d,ro=p}function gv(d,p,S){fi[hi++]=Wi,fi[hi++]=Pr,fi[hi++]=no,no=d;var j=Wi;d=Pr;var B=32-Tt(j)-1;j&=~(1<<B),S+=1;var q=32-Tt(p)+B;if(30<q){var J=B-B%5;q=(j&(1<<J)-1).toString(32),j>>=J,B-=J,Wi=1<<32-Tt(p)+B|S<<B|j,Pr=q+d}else Wi=1<<q|S<<B|j,Pr=d}function Vl(d){d.return!==null&&(qo(d,1),gv(d,1,0))}function En(d){for(;d===to;)to=di[--Ho],di[Ho]=null,ro=di[--Ho],di[Ho]=null;for(;d===no;)no=fi[--hi],fi[hi]=null,Pr=fi[--hi],fi[hi]=null,Wi=fi[--hi],fi[hi]=null}var $i=null,Xe=null,rr=!1,Ki=null;function rp(d,p){var S=ts(5,null,null,0);S.elementType="DELETED",S.stateNode=p,S.return=d,p=d.deletions,p===null?(d.deletions=[S],d.flags|=16):p.push(S)}function vv(d,p){switch(d.tag){case 5:var S=d.type;return p=p.nodeType!==1||S.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,$i=d,Xe=qa(p.firstChild),!0):!1;case 6:return p=d.pendingProps===""||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,$i=d,Xe=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(S=no!==null?{id:Wi,overflow:Pr}:null,d.memoizedState={dehydrated:p,treeContext:S,retryLane:1073741824},S=ts(18,null,null,0),S.stateNode=p,S.return=d,d.child=S,$i=d,Xe=null,!0):!1;default:return!1}}function Wo(d){return(d.mode&1)!==0&&(d.flags&128)===0}function Ul(d){if(rr){var p=Xe;if(p){var S=p;if(!vv(d,p)){if(Wo(d))throw Error(r(418));p=qa(S.nextSibling);var j=$i;p&&vv(d,p)?rp(j,S):(d.flags=d.flags&-4097|2,rr=!1,$i=d)}}else{if(Wo(d))throw Error(r(418));d.flags=d.flags&-4097|2,rr=!1,$i=d}}}function nf(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;$i=d}function Nc(d){if(d!==$i)return!1;if(!rr)return nf(d),rr=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!=="head"&&p!=="body"&&!Zh(d.type,d.memoizedProps)),p&&(p=Xe)){if(Wo(d))throw np(),Error(r(418));for(;p;)rp(d,p),p=qa(p.nextSibling)}if(nf(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var S=d.data;if(S==="/$"){if(p===0){Xe=qa(d.nextSibling);break e}p--}else S!=="$"&&S!=="$!"&&S!=="$?"||p++}d=d.nextSibling}Xe=null}}else Xe=$i?qa(d.stateNode.nextSibling):null;return!0}function np(){for(var d=Xe;d;)d=qa(d.nextSibling)}function $o(){Xe=$i=null,rr=!1}function Ec(d){Ki===null?Ki=[d]:Ki.push(d)}var ip=E.ReactCurrentBatchConfig;function Kr(d,p,S){if(d=S.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(S._owner){if(S=S._owner,S){if(S.tag!==1)throw Error(r(309));var j=S.stateNode}if(!j)throw Error(r(147,d));var B=j,q=""+d;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===q?p.ref:(p=function(J){var de=B.refs;J===null?delete de[q]:de[q]=J},p._stringRef=q,p)}if(typeof d!="string")throw Error(r(284));if(!S._owner)throw Error(r(290,d))}return d}function Mi(d,p){throw d=Object.prototype.toString.call(p),Error(r(31,d==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":d))}function Da(d){var p=d._init;return p(d._payload)}function af(d){function p(Se,ve){if(d){var ke=Se.deletions;ke===null?(Se.deletions=[ve],Se.flags|=16):ke.push(ve)}}function S(Se,ve){if(!d)return null;for(;ve!==null;)p(Se,ve),ve=ve.sibling;return null}function j(Se,ve){for(Se=new Map;ve!==null;)ve.key!==null?Se.set(ve.key,ve):Se.set(ve.index,ve),ve=ve.sibling;return Se}function B(Se,ve){return Se=lu(Se,ve),Se.index=0,Se.sibling=null,Se}function q(Se,ve,ke){return Se.index=ke,d?(ke=Se.alternate,ke!==null?(ke=ke.index,ke<ve?(Se.flags|=2,ve):ke):(Se.flags|=2,ve)):(Se.flags|=1048576,ve)}function J(Se){return d&&Se.alternate===null&&(Se.flags|=2),Se}function de(Se,ve,ke,Ke){return ve===null||ve.tag!==6?(ve=h1(ke,Se.mode,Ke),ve.return=Se,ve):(ve=B(ve,ke),ve.return=Se,ve)}function me(Se,ve,ke,Ke){var pt=ke.type;return pt===A?ze(Se,ve,ke.props.children,Ke,ke.key):ve!==null&&(ve.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===G&&Da(pt)===ve.type)?(Ke=B(ve,ke.props),Ke.ref=Kr(Se,ve,ke),Ke.return=Se,Ke):(Ke=Bv(ke.type,ke.key,ke.props,null,Se.mode,Ke),Ke.ref=Kr(Se,ve,ke),Ke.return=Se,Ke)}function Ee(Se,ve,ke,Ke){return ve===null||ve.tag!==4||ve.stateNode.containerInfo!==ke.containerInfo||ve.stateNode.implementation!==ke.implementation?(ve=p1(ke,Se.mode,Ke),ve.return=Se,ve):(ve=B(ve,ke.children||[]),ve.return=Se,ve)}function ze(Se,ve,ke,Ke,pt){return ve===null||ve.tag!==7?(ve=Lc(ke,Se.mode,Ke,pt),ve.return=Se,ve):(ve=B(ve,ke),ve.return=Se,ve)}function Ue(Se,ve,ke){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return ve=h1(""+ve,Se.mode,ke),ve.return=Se,ve;if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case P:return ke=Bv(ve.type,ve.key,ve.props,null,Se.mode,ke),ke.ref=Kr(Se,null,ve),ke.return=Se,ke;case _:return ve=p1(ve,Se.mode,ke),ve.return=Se,ve;case G:var Ke=ve._init;return Ue(Se,Ke(ve._payload),ke)}if(Ie(ve)||X(ve))return ve=Lc(ve,Se.mode,ke,null),ve.return=Se,ve;Mi(Se,ve)}return null}function Fe(Se,ve,ke,Ke){var pt=ve!==null?ve.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number")return pt!==null?null:de(Se,ve,""+ke,Ke);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case P:return ke.key===pt?me(Se,ve,ke,Ke):null;case _:return ke.key===pt?Ee(Se,ve,ke,Ke):null;case G:return pt=ke._init,Fe(Se,ve,pt(ke._payload),Ke)}if(Ie(ke)||X(ke))return pt!==null?null:ze(Se,ve,ke,Ke,null);Mi(Se,ke)}return null}function at(Se,ve,ke,Ke,pt){if(typeof Ke=="string"&&Ke!==""||typeof Ke=="number")return Se=Se.get(ke)||null,de(ve,Se,""+Ke,pt);if(typeof Ke=="object"&&Ke!==null){switch(Ke.$$typeof){case P:return Se=Se.get(Ke.key===null?ke:Ke.key)||null,me(ve,Se,Ke,pt);case _:return Se=Se.get(Ke.key===null?ke:Ke.key)||null,Ee(ve,Se,Ke,pt);case G:var St=Ke._init;return at(Se,ve,ke,St(Ke._payload),pt)}if(Ie(Ke)||X(Ke))return Se=Se.get(ke)||null,ze(ve,Se,Ke,pt,null);Mi(ve,Ke)}return null}function ft(Se,ve,ke,Ke){for(var pt=null,St=null,kt=ve,Mt=ve=0,Jn=null;kt!==null&&Mt<ke.length;Mt++){kt.index>Mt?(Jn=kt,kt=null):Jn=kt.sibling;var er=Fe(Se,kt,ke[Mt],Ke);if(er===null){kt===null&&(kt=Jn);break}d&&kt&&er.alternate===null&&p(Se,kt),ve=q(er,ve,Mt),St===null?pt=er:St.sibling=er,St=er,kt=Jn}if(Mt===ke.length)return S(Se,kt),rr&&qo(Se,Mt),pt;if(kt===null){for(;Mt<ke.length;Mt++)kt=Ue(Se,ke[Mt],Ke),kt!==null&&(ve=q(kt,ve,Mt),St===null?pt=kt:St.sibling=kt,St=kt);return rr&&qo(Se,Mt),pt}for(kt=j(Se,kt);Mt<ke.length;Mt++)Jn=at(kt,Se,Mt,ke[Mt],Ke),Jn!==null&&(d&&Jn.alternate!==null&&kt.delete(Jn.key===null?Mt:Jn.key),ve=q(Jn,ve,Mt),St===null?pt=Jn:St.sibling=Jn,St=Jn);return d&&kt.forEach(function(uu){return p(Se,uu)}),rr&&qo(Se,Mt),pt}function ht(Se,ve,ke,Ke){var pt=X(ke);if(typeof pt!="function")throw Error(r(150));if(ke=pt.call(ke),ke==null)throw Error(r(151));for(var St=pt=null,kt=ve,Mt=ve=0,Jn=null,er=ke.next();kt!==null&&!er.done;Mt++,er=ke.next()){kt.index>Mt?(Jn=kt,kt=null):Jn=kt.sibling;var uu=Fe(Se,kt,er.value,Ke);if(uu===null){kt===null&&(kt=Jn);break}d&&kt&&uu.alternate===null&&p(Se,kt),ve=q(uu,ve,Mt),St===null?pt=uu:St.sibling=uu,St=uu,kt=Jn}if(er.done)return S(Se,kt),rr&&qo(Se,Mt),pt;if(kt===null){for(;!er.done;Mt++,er=ke.next())er=Ue(Se,er.value,Ke),er!==null&&(ve=q(er,ve,Mt),St===null?pt=er:St.sibling=er,St=er);return rr&&qo(Se,Mt),pt}for(kt=j(Se,kt);!er.done;Mt++,er=ke.next())er=at(kt,Se,Mt,er.value,Ke),er!==null&&(d&&er.alternate!==null&&kt.delete(er.key===null?Mt:er.key),ve=q(er,ve,Mt),St===null?pt=er:St.sibling=er,St=er);return d&&kt.forEach(function(z_){return p(Se,z_)}),rr&&qo(Se,Mt),pt}function xn(Se,ve,ke,Ke){if(typeof ke=="object"&&ke!==null&&ke.type===A&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case P:e:{for(var pt=ke.key,St=ve;St!==null;){if(St.key===pt){if(pt=ke.type,pt===A){if(St.tag===7){S(Se,St.sibling),ve=B(St,ke.props.children),ve.return=Se,Se=ve;break e}}else if(St.elementType===pt||typeof pt=="object"&&pt!==null&&pt.$$typeof===G&&Da(pt)===St.type){S(Se,St.sibling),ve=B(St,ke.props),ve.ref=Kr(Se,St,ke),ve.return=Se,Se=ve;break e}S(Se,St);break}else p(Se,St);St=St.sibling}ke.type===A?(ve=Lc(ke.props.children,Se.mode,Ke,ke.key),ve.return=Se,Se=ve):(Ke=Bv(ke.type,ke.key,ke.props,null,Se.mode,Ke),Ke.ref=Kr(Se,ve,ke),Ke.return=Se,Se=Ke)}return J(Se);case _:e:{for(St=ke.key;ve!==null;){if(ve.key===St)if(ve.tag===4&&ve.stateNode.containerInfo===ke.containerInfo&&ve.stateNode.implementation===ke.implementation){S(Se,ve.sibling),ve=B(ve,ke.children||[]),ve.return=Se,Se=ve;break e}else{S(Se,ve);break}else p(Se,ve);ve=ve.sibling}ve=p1(ke,Se.mode,Ke),ve.return=Se,Se=ve}return J(Se);case G:return St=ke._init,xn(Se,ve,St(ke._payload),Ke)}if(Ie(ke))return ft(Se,ve,ke,Ke);if(X(ke))return ht(Se,ve,ke,Ke);Mi(Se,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"?(ke=""+ke,ve!==null&&ve.tag===6?(S(Se,ve.sibling),ve=B(ve,ke),ve.return=Se,Se=ve):(S(Se,ve),ve=h1(ke,Se.mode,Ke),ve.return=Se,Se=ve),J(Se)):S(Se,ve)}return xn}var Ko=af(!0),da=af(!1),Tc=Cs(null),Yi=null,Gl=null,sf=null;function of(){sf=Gl=Yi=null}function lf(d){var p=Tc.current;pr(Tc),d._currentValue=p}function uf(d,p,S){for(;d!==null;){var j=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,j!==null&&(j.childLanes|=p)):j!==null&&(j.childLanes&p)!==p&&(j.childLanes|=p),d===S)break;d=d.return}}function Es(d,p){Yi=d,sf=Gl=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&p)!==0&&(K=!0),d.firstContext=null)}function pi(d){var p=d._currentValue;if(sf!==d)if(d={context:d,memoizedValue:p,next:null},Gl===null){if(Yi===null)throw Error(r(308));Gl=d,Yi.dependencies={lanes:0,firstContext:d}}else Gl=Gl.next=d;return p}var Ya=null;function Hl(d){Ya===null?Ya=[d]:Ya.push(d)}function jc(d,p,S,j){var B=p.interleaved;return B===null?(S.next=S,Hl(p)):(S.next=B.next,B.next=S),p.interleaved=S,Xi(d,j)}function Xi(d,p){d.lanes|=p;var S=d.alternate;for(S!==null&&(S.lanes|=p),S=d,d=d.return;d!==null;)d.childLanes|=p,S=d.alternate,S!==null&&(S.childLanes|=p),S=d,d=d.return;return S.tag===3?S.stateNode:null}var Xa=!1;function Pc(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cf(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function Qa(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function Ja(d,p,S){var j=d.updateQueue;if(j===null)return null;if(j=j.shared,(Qt&2)!==0){var B=j.pending;return B===null?p.next=p:(p.next=B.next,B.next=p),j.pending=p,Xi(d,S)}return B=j.interleaved,B===null?(p.next=p,Hl(j)):(p.next=B.next,B.next=p),j.interleaved=p,Xi(d,S)}function df(d,p,S){if(p=p.updateQueue,p!==null&&(p=p.shared,(S&4194240)!==0)){var j=p.lanes;j&=d.pendingLanes,S|=j,p.lanes=S,Mh(d,S)}}function Mc(d,p){var S=d.updateQueue,j=d.alternate;if(j!==null&&(j=j.updateQueue,S===j)){var B=null,q=null;if(S=S.firstBaseUpdate,S!==null){do{var J={eventTime:S.eventTime,lane:S.lane,tag:S.tag,payload:S.payload,callback:S.callback,next:null};q===null?B=q=J:q=q.next=J,S=S.next}while(S!==null);q===null?B=q=p:q=q.next=p}else B=q=p;S={baseState:j.baseState,firstBaseUpdate:B,lastBaseUpdate:q,shared:j.shared,effects:j.effects},d.updateQueue=S;return}d=S.lastBaseUpdate,d===null?S.firstBaseUpdate=p:d.next=p,S.lastBaseUpdate=p}function ql(d,p,S,j){var B=d.updateQueue;Xa=!1;var q=B.firstBaseUpdate,J=B.lastBaseUpdate,de=B.shared.pending;if(de!==null){B.shared.pending=null;var me=de,Ee=me.next;me.next=null,J===null?q=Ee:J.next=Ee,J=me;var ze=d.alternate;ze!==null&&(ze=ze.updateQueue,de=ze.lastBaseUpdate,de!==J&&(de===null?ze.firstBaseUpdate=Ee:de.next=Ee,ze.lastBaseUpdate=me))}if(q!==null){var Ue=B.baseState;J=0,ze=Ee=me=null,de=q;do{var Fe=de.lane,at=de.eventTime;if((j&Fe)===Fe){ze!==null&&(ze=ze.next={eventTime:at,lane:0,tag:de.tag,payload:de.payload,callback:de.callback,next:null});e:{var ft=d,ht=de;switch(Fe=p,at=S,ht.tag){case 1:if(ft=ht.payload,typeof ft=="function"){Ue=ft.call(at,Ue,Fe);break e}Ue=ft;break e;case 3:ft.flags=ft.flags&-65537|128;case 0:if(ft=ht.payload,Fe=typeof ft=="function"?ft.call(at,Ue,Fe):ft,Fe==null)break e;Ue=Q({},Ue,Fe);break e;case 2:Xa=!0}}de.callback!==null&&de.lane!==0&&(d.flags|=64,Fe=B.effects,Fe===null?B.effects=[de]:Fe.push(de))}else at={eventTime:at,lane:Fe,tag:de.tag,payload:de.payload,callback:de.callback,next:null},ze===null?(Ee=ze=at,me=Ue):ze=ze.next=at,J|=Fe;if(de=de.next,de===null){if(de=B.shared.pending,de===null)break;Fe=de,de=Fe.next,Fe.next=null,B.lastBaseUpdate=Fe,B.shared.pending=null}}while(!0);if(ze===null&&(me=Ue),B.baseState=me,B.firstBaseUpdate=Ee,B.lastBaseUpdate=ze,p=B.shared.interleaved,p!==null){B=p;do J|=B.lane,B=B.next;while(B!==p)}else q===null&&(B.shared.lanes=0);Rc|=J,d.lanes=J,d.memoizedState=Ue}}function Vr(d,p,S){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var j=d[p],B=j.callback;if(B!==null){if(j.callback=null,j=S,typeof B!="function")throw Error(r(191,B));B.call(j)}}}var Ot={},dr=Cs(Ot),Mr=Cs(Ot),Yr=Cs(Ot);function gn(d){if(d===Ot)throw Error(r(174));return d}function io(d,p){switch(cr(Yr,p),cr(Mr,d),cr(dr,Ot),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:gt(null,"");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=gt(p,d)}pr(dr),cr(dr,p)}function _r(){pr(dr),pr(Mr),pr(Yr)}function Wl(d){gn(Yr.current);var p=gn(dr.current),S=gt(p,d.type);p!==S&&(cr(Mr,d),cr(dr,S))}function Ts(d){Mr.current===d&&(pr(dr),pr(Mr))}var mr=Cs(0);function $l(d){for(var p=d;p!==null;){if(p.tag===13){var S=p.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||S.data==="$?"||S.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var Yo=[];function $n(){for(var d=0;d<Yo.length;d++)Yo[d]._workInProgressVersionPrimary=null;Yo.length=0}var Kl=E.ReactCurrentDispatcher,_c=E.ReactCurrentBatchConfig,mi=0,sr=null,Ur=null,tn=null,Oa=!1,ao=!1,fa=0,ff=0;function rn(){throw Error(r(321))}function Ac(d,p){if(p===null)return!1;for(var S=0;S<p.length&&S<d.length;S++)if(!Pi(d[S],p[S]))return!1;return!0}function Yl(d,p,S,j,B,q){if(mi=q,sr=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,Kl.current=d===null||d.memoizedState===null?Kx:lo,d=S(j,B),ao){q=0;do{if(ao=!1,fa=0,25<=q)throw Error(r(301));q+=1,tn=Ur=null,p.updateQueue=null,Kl.current=vf,d=S(j,B)}while(ao)}if(Kl.current=Zl,p=Ur!==null&&Ur.next!==null,mi=0,tn=Ur=sr=null,Oa=!1,p)throw Error(r(300));return d}function Xl(){var d=fa!==0;return fa=0,d}function Sr(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tn===null?sr.memoizedState=tn=d:tn=tn.next=d,tn}function vn(){if(Ur===null){var d=sr.alternate;d=d!==null?d.memoizedState:null}else d=Ur.next;var p=tn===null?sr.memoizedState:tn.next;if(p!==null)tn=p,Ur=d;else{if(d===null)throw Error(r(310));Ur=d,d={memoizedState:Ur.memoizedState,baseState:Ur.baseState,baseQueue:Ur.baseQueue,queue:Ur.queue,next:null},tn===null?sr.memoizedState=tn=d:tn=tn.next=d}return tn}function Kn(d,p){return typeof p=="function"?p(d):p}function Yn(d){var p=vn(),S=p.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=d;var j=Ur,B=j.baseQueue,q=S.pending;if(q!==null){if(B!==null){var J=B.next;B.next=q.next,q.next=J}j.baseQueue=B=q,S.pending=null}if(B!==null){q=B.next,j=j.baseState;var de=J=null,me=null,Ee=q;do{var ze=Ee.lane;if((mi&ze)===ze)me!==null&&(me=me.next={lane:0,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),j=Ee.hasEagerState?Ee.eagerState:d(j,Ee.action);else{var Ue={lane:ze,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null};me===null?(de=me=Ue,J=j):me=me.next=Ue,sr.lanes|=ze,Rc|=ze}Ee=Ee.next}while(Ee!==null&&Ee!==q);me===null?J=j:me.next=de,Pi(j,p.memoizedState)||(K=!0),p.memoizedState=j,p.baseState=J,p.baseQueue=me,S.lastRenderedState=j}if(d=S.interleaved,d!==null){B=d;do q=B.lane,sr.lanes|=q,Rc|=q,B=B.next;while(B!==d)}else B===null&&(S.lanes=0);return[p.memoizedState,S.dispatch]}function hf(d){var p=vn(),S=p.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=d;var j=S.dispatch,B=S.pending,q=p.memoizedState;if(B!==null){S.pending=null;var J=B=B.next;do q=d(q,J.action),J=J.next;while(J!==B);Pi(q,p.memoizedState)||(K=!0),p.memoizedState=q,p.baseQueue===null&&(p.baseState=q),S.lastRenderedState=q}return[q,j]}function pf(){}function mf(d,p){var S=sr,j=vn(),B=p(),q=!Pi(j.memoizedState,B);if(q&&(j.memoizedState=B,K=!0),j=j.queue,lp(ap.bind(null,S,j,d),[d]),j.getSnapshot!==p||q||tn!==null&&tn.memoizedState.tag&1){if(S.flags|=2048,Ql(9,js.bind(null,S,j,B,p),void 0,null),Qn===null)throw Error(r(349));(mi&30)!==0||yv(S,p,B)}return B}function yv(d,p,S){d.flags|=16384,d={getSnapshot:p,value:S},p=sr.updateQueue,p===null?(p={lastEffect:null,stores:null},sr.updateQueue=p,p.stores=[d]):(S=p.stores,S===null?p.stores=[d]:S.push(d))}function js(d,p,S,j){p.value=S,p.getSnapshot=j,sp(p)&&gf(d)}function ap(d,p,S){return S(function(){sp(p)&&gf(d)})}function sp(d){var p=d.getSnapshot;d=d.value;try{var S=p();return!Pi(d,S)}catch{return!0}}function gf(d){var p=Xi(d,1);p!==null&&As(p,d,1,-1)}function so(d){var p=Sr();return typeof d=="function"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kn,lastRenderedState:d},p.queue=d,d=d.dispatch=Cv.bind(null,sr,d),[p.memoizedState,d]}function Ql(d,p,S,j){return d={tag:d,create:p,destroy:S,deps:j,next:null},p=sr.updateQueue,p===null?(p={lastEffect:null,stores:null},sr.updateQueue=p,p.lastEffect=d.next=d):(S=p.lastEffect,S===null?p.lastEffect=d.next=d:(j=S.next,S.next=d,d.next=j,p.lastEffect=d)),d}function op(){return vn().memoizedState}function Jl(d,p,S,j){var B=Sr();sr.flags|=d,B.memoizedState=Ql(1|p,S,void 0,j===void 0?null:j)}function Xo(d,p,S,j){var B=vn();j=j===void 0?null:j;var q=void 0;if(Ur!==null){var J=Ur.memoizedState;if(q=J.destroy,j!==null&&Ac(j,J.deps)){B.memoizedState=Ql(p,S,q,j);return}}sr.flags|=d,B.memoizedState=Ql(1|p,S,q,j)}function xv(d,p){return Jl(8390656,8,d,p)}function lp(d,p){return Xo(2048,8,d,p)}function up(d,p){return Xo(4,2,d,p)}function cp(d,p){return Xo(4,4,d,p)}function oo(d,p){if(typeof p=="function")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function bv(d,p,S){return S=S!=null?S.concat([d]):null,Xo(4,4,oo.bind(null,p,d),S)}function Ps(){}function dp(d,p){var S=vn();p=p===void 0?null:p;var j=S.memoizedState;return j!==null&&p!==null&&Ac(p,j[1])?j[0]:(S.memoizedState=[d,p],d)}function kr(d,p){var S=vn();p=p===void 0?null:p;var j=S.memoizedState;return j!==null&&p!==null&&Ac(p,j[1])?j[0]:(d=d(),S.memoizedState=[d,p],d)}function wv(d,p,S){return(mi&21)===0?(d.baseState&&(d.baseState=!1,K=!0),d.memoizedState=S):(Pi(S,p)||(S=Ph(),sr.lanes|=S,Rc|=S,d.baseState=!0),p)}function Sv(d,p){var S=Yt;Yt=S!==0&&4>S?S:4,d(!0);var j=_c.transition;_c.transition={};try{d(!1),p()}finally{Yt=S,_c.transition=j}}function kv(){return vn().memoizedState}function $x(d,p,S){var j=su(d);if(S={lane:j,action:S,hasEagerState:!1,eagerState:null,next:null},fp(d))Nv(p,S);else if(S=jc(d,p,S,j),S!==null){var B=Ji();As(S,d,j,B),Qi(S,p,j)}}function Cv(d,p,S){var j=su(d),B={lane:j,action:S,hasEagerState:!1,eagerState:null,next:null};if(fp(d))Nv(p,B);else{var q=d.alternate;if(d.lanes===0&&(q===null||q.lanes===0)&&(q=p.lastRenderedReducer,q!==null))try{var J=p.lastRenderedState,de=q(J,S);if(B.hasEagerState=!0,B.eagerState=de,Pi(de,J)){var me=p.interleaved;me===null?(B.next=B,Hl(p)):(B.next=me.next,me.next=B),p.interleaved=B;return}}catch{}S=jc(d,p,B,j),S!==null&&(B=Ji(),As(S,d,j,B),Qi(S,p,j))}}function fp(d){var p=d.alternate;return d===sr||p!==null&&p===sr}function Nv(d,p){ao=Oa=!0;var S=d.pending;S===null?p.next=p:(p.next=S.next,S.next=p),d.pending=p}function Qi(d,p,S){if((S&4194240)!==0){var j=p.lanes;j&=d.pendingLanes,S|=j,p.lanes=S,Mh(d,S)}}var Zl={readContext:pi,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useInsertionEffect:rn,useLayoutEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useMutableSource:rn,useSyncExternalStore:rn,useId:rn,unstable_isNewReconciler:!1},Kx={readContext:pi,useCallback:function(d,p){return Sr().memoizedState=[d,p===void 0?null:p],d},useContext:pi,useEffect:xv,useImperativeHandle:function(d,p,S){return S=S!=null?S.concat([d]):null,Jl(4194308,4,oo.bind(null,p,d),S)},useLayoutEffect:function(d,p){return Jl(4194308,4,d,p)},useInsertionEffect:function(d,p){return Jl(4,2,d,p)},useMemo:function(d,p){var S=Sr();return p=p===void 0?null:p,d=d(),S.memoizedState=[d,p],d},useReducer:function(d,p,S){var j=Sr();return p=S!==void 0?S(p):p,j.memoizedState=j.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},j.queue=d,d=d.dispatch=$x.bind(null,sr,d),[j.memoizedState,d]},useRef:function(d){var p=Sr();return d={current:d},p.memoizedState=d},useState:so,useDebugValue:Ps,useDeferredValue:function(d){return Sr().memoizedState=d},useTransition:function(){var d=so(!1),p=d[0];return d=Sv.bind(null,d[1]),Sr().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,S){var j=sr,B=Sr();if(rr){if(S===void 0)throw Error(r(407));S=S()}else{if(S=p(),Qn===null)throw Error(r(349));(mi&30)!==0||yv(j,p,S)}B.memoizedState=S;var q={value:S,getSnapshot:p};return B.queue=q,xv(ap.bind(null,j,q,d),[d]),j.flags|=2048,Ql(9,js.bind(null,j,q,S,p),void 0,null),S},useId:function(){var d=Sr(),p=Qn.identifierPrefix;if(rr){var S=Pr,j=Wi;S=(j&~(1<<32-Tt(j)-1)).toString(32)+S,p=":"+p+"R"+S,S=fa++,0<S&&(p+="H"+S.toString(32)),p+=":"}else S=ff++,p=":"+p+"r"+S.toString(32)+":";return d.memoizedState=p},unstable_isNewReconciler:!1},lo={readContext:pi,useCallback:dp,useContext:pi,useEffect:lp,useImperativeHandle:bv,useInsertionEffect:up,useLayoutEffect:cp,useMemo:kr,useReducer:Yn,useRef:op,useState:function(){return Yn(Kn)},useDebugValue:Ps,useDeferredValue:function(d){var p=vn();return wv(p,Ur.memoizedState,d)},useTransition:function(){var d=Yn(Kn)[0],p=vn().memoizedState;return[d,p]},useMutableSource:pf,useSyncExternalStore:mf,useId:kv,unstable_isNewReconciler:!1},vf={readContext:pi,useCallback:dp,useContext:pi,useEffect:lp,useImperativeHandle:bv,useInsertionEffect:up,useLayoutEffect:cp,useMemo:kr,useReducer:hf,useRef:op,useState:function(){return hf(Kn)},useDebugValue:Ps,useDeferredValue:function(d){var p=vn();return Ur===null?p.memoizedState=d:wv(p,Ur.memoizedState,d)},useTransition:function(){var d=hf(Kn)[0],p=vn().memoizedState;return[d,p]},useMutableSource:pf,useSyncExternalStore:mf,useId:kv,unstable_isNewReconciler:!1};function Ln(d,p){if(d&&d.defaultProps){p=Q({},p),d=d.defaultProps;for(var S in d)p[S]===void 0&&(p[S]=d[S]);return p}return p}function eu(d,p,S,j){p=d.memoizedState,S=S(j,p),S=S==null?p:Q({},p,S),d.memoizedState=S,d.lanes===0&&(d.updateQueue.baseState=S)}var tu={isMounted:function(d){return(d=d._reactInternals)?oi(d)===d:!1},enqueueSetState:function(d,p,S){d=d._reactInternals;var j=Ji(),B=su(d),q=Qa(j,B);q.payload=p,S!=null&&(q.callback=S),p=Ja(d,q,B),p!==null&&(As(p,d,B,j),df(p,d,B))},enqueueReplaceState:function(d,p,S){d=d._reactInternals;var j=Ji(),B=su(d),q=Qa(j,B);q.tag=1,q.payload=p,S!=null&&(q.callback=S),p=Ja(d,q,B),p!==null&&(As(p,d,B,j),df(p,d,B))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var S=Ji(),j=su(d),B=Qa(S,j);B.tag=2,p!=null&&(B.callback=p),p=Ja(d,B,j),p!==null&&(As(p,d,j,S),df(p,d,j))}};function yf(d,p,S,j,B,q,J){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(j,q,J):p.prototype&&p.prototype.isPureReactComponent?!Ro(S,j)||!Ro(B,q):!0}function Ev(d,p,S){var j=!1,B=$a,q=p.contextType;return typeof q=="object"&&q!==null?q=pi(q):(B=Wn(p)?Zs:In.current,j=p.contextTypes,q=(j=j!=null)?Uo(d,B):$a),p=new p(S,q),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=tu,d.stateNode=p,p._reactInternals=d,j&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=B,d.__reactInternalMemoizedMaskedChildContext=q),p}function hp(d,p,S,j){d=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(S,j),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(S,j),p.state!==d&&tu.enqueueReplaceState(p,p.state,null)}function xf(d,p,S,j){var B=d.stateNode;B.props=S,B.state=d.memoizedState,B.refs={},Pc(d);var q=p.contextType;typeof q=="object"&&q!==null?B.context=pi(q):(q=Wn(p)?Zs:In.current,B.context=Uo(d,q)),B.state=d.memoizedState,q=p.getDerivedStateFromProps,typeof q=="function"&&(eu(d,p,q,S),B.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(p=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),p!==B.state&&tu.enqueueReplaceState(B,B.state,null),ql(d,S,B,j),B.state=d.memoizedState),typeof B.componentDidMount=="function"&&(d.flags|=4194308)}function Qo(d,p){try{var S="",j=p;do S+=ce(j),j=j.return;while(j);var B=S}catch(q){B=`
Error generating stack: `+q.message+`
`+q.stack}return{value:d,source:p,stack:B,digest:null}}function bf(d,p,S){return{value:d,source:null,stack:S??null,digest:p??null}}function ru(d,p){try{console.error(p.value)}catch(S){setTimeout(function(){throw S})}}var Yx=typeof WeakMap=="function"?WeakMap:Map;function Tv(d,p,S){S=Qa(-1,S),S.tag=3,S.payload={element:null};var j=p.value;return S.callback=function(){Av||(Av=!0,a1=j),ru(d,p)},S}function v(d,p,S){S=Qa(-1,S),S.tag=3;var j=d.type.getDerivedStateFromError;if(typeof j=="function"){var B=p.value;S.payload=function(){return j(B)},S.callback=function(){ru(d,p)}}var q=d.stateNode;return q!==null&&typeof q.componentDidCatch=="function"&&(S.callback=function(){ru(d,p),typeof j!="function"&&(iu===null?iu=new Set([this]):iu.add(this));var J=p.stack;this.componentDidCatch(p.value,{componentStack:J!==null?J:""})}),S}function x(d,p,S){var j=d.pingCache;if(j===null){j=d.pingCache=new Yx;var B=new Set;j.set(p,B)}else B=j.get(p),B===void 0&&(B=new Set,j.set(p,B));B.has(S)||(B.add(S),d=P_.bind(null,d,p,S),p.then(d,d))}function T(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function R(d,p,S,j,B){return(d.mode&1)===0?(d===p?d.flags|=65536:(d.flags|=128,S.flags|=131072,S.flags&=-52805,S.tag===1&&(S.alternate===null?S.tag=17:(p=Qa(-1,1),p.tag=2,Ja(S,p,1))),S.lanes|=1),d):(d.flags|=65536,d.lanes=B,d)}var F=E.ReactCurrentOwner,K=!1;function ne(d,p,S,j){p.child=d===null?da(p,null,S,j):Ko(p,d.child,S,j)}function xe(d,p,S,j,B){S=S.render;var q=p.ref;return Es(p,B),j=Yl(d,p,S,j,q,B),S=Xl(),d!==null&&!K?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~B,Xn(d,p,B)):(rr&&S&&Vl(p),p.flags|=1,ne(d,p,j,B),p.child)}function je(d,p,S,j,B){if(d===null){var q=S.type;return typeof q=="function"&&!f1(q)&&q.defaultProps===void 0&&S.compare===null&&S.defaultProps===void 0?(p.tag=15,p.type=q,We(d,p,q,j,B)):(d=Bv(S.type,null,j,p,p.mode,B),d.ref=p.ref,d.return=p,p.child=d)}if(q=d.child,(d.lanes&B)===0){var J=q.memoizedProps;if(S=S.compare,S=S!==null?S:Ro,S(J,j)&&d.ref===p.ref)return Xn(d,p,B)}return p.flags|=1,d=lu(q,j),d.ref=p.ref,d.return=p,p.child=d}function We(d,p,S,j,B){if(d!==null){var q=d.memoizedProps;if(Ro(q,j)&&d.ref===p.ref)if(K=!1,p.pendingProps=j=q,(d.lanes&B)!==0)(d.flags&131072)!==0&&(K=!0);else return p.lanes=d.lanes,Xn(d,p,B)}return rt(d,p,S,j,B)}function lt(d,p,S){var j=p.pendingProps,B=j.children,q=d!==null?d.memoizedState:null;if(j.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},cr(Sf,Ia),Ia|=S;else{if((S&1073741824)===0)return d=q!==null?q.baseLanes|S:S,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,cr(Sf,Ia),Ia|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},j=q!==null?q.baseLanes:S,cr(Sf,Ia),Ia|=j}else q!==null?(j=q.baseLanes|S,p.memoizedState=null):j=S,cr(Sf,Ia),Ia|=j;return ne(d,p,B,S),p.child}function At(d,p){var S=p.ref;(d===null&&S!==null||d!==null&&d.ref!==S)&&(p.flags|=512,p.flags|=2097152)}function rt(d,p,S,j,B){var q=Wn(S)?Zs:In.current;return q=Uo(p,q),Es(p,B),S=Yl(d,p,S,j,q,B),j=Xl(),d!==null&&!K?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~B,Xn(d,p,B)):(rr&&j&&Vl(p),p.flags|=1,ne(d,p,S,B),p.child)}function gr(d,p,S,j,B){if(Wn(S)){var q=!0;Go(p)}else q=!1;if(Es(p,B),p.stateNode===null)qt(d,p),Ev(p,S,j),xf(p,S,j,B),j=!0;else if(d===null){var J=p.stateNode,de=p.memoizedProps;J.props=de;var me=J.context,Ee=S.contextType;typeof Ee=="object"&&Ee!==null?Ee=pi(Ee):(Ee=Wn(S)?Zs:In.current,Ee=Uo(p,Ee));var ze=S.getDerivedStateFromProps,Ue=typeof ze=="function"||typeof J.getSnapshotBeforeUpdate=="function";Ue||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(de!==j||me!==Ee)&&hp(p,J,j,Ee),Xa=!1;var Fe=p.memoizedState;J.state=Fe,ql(p,j,J,B),me=p.memoizedState,de!==j||Fe!==me||qn.current||Xa?(typeof ze=="function"&&(eu(p,S,ze,j),me=p.memoizedState),(de=Xa||yf(p,S,de,j,Fe,me,Ee))?(Ue||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(p.flags|=4194308)):(typeof J.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=j,p.memoizedState=me),J.props=j,J.state=me,J.context=Ee,j=de):(typeof J.componentDidMount=="function"&&(p.flags|=4194308),j=!1)}else{J=p.stateNode,cf(d,p),de=p.memoizedProps,Ee=p.type===p.elementType?de:Ln(p.type,de),J.props=Ee,Ue=p.pendingProps,Fe=J.context,me=S.contextType,typeof me=="object"&&me!==null?me=pi(me):(me=Wn(S)?Zs:In.current,me=Uo(p,me));var at=S.getDerivedStateFromProps;(ze=typeof at=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(de!==Ue||Fe!==me)&&hp(p,J,j,me),Xa=!1,Fe=p.memoizedState,J.state=Fe,ql(p,j,J,B);var ft=p.memoizedState;de!==Ue||Fe!==ft||qn.current||Xa?(typeof at=="function"&&(eu(p,S,at,j),ft=p.memoizedState),(Ee=Xa||yf(p,S,Ee,j,Fe,ft,me)||!1)?(ze||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(j,ft,me),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(j,ft,me)),typeof J.componentDidUpdate=="function"&&(p.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof J.componentDidUpdate!="function"||de===d.memoizedProps&&Fe===d.memoizedState||(p.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||de===d.memoizedProps&&Fe===d.memoizedState||(p.flags|=1024),p.memoizedProps=j,p.memoizedState=ft),J.props=j,J.state=ft,J.context=me,j=Ee):(typeof J.componentDidUpdate!="function"||de===d.memoizedProps&&Fe===d.memoizedState||(p.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||de===d.memoizedProps&&Fe===d.memoizedState||(p.flags|=1024),j=!1)}return nr(d,p,S,j,q,B)}function nr(d,p,S,j,B,q){At(d,p);var J=(p.flags&128)!==0;if(!j&&!J)return B&&mv(p,S,!1),Xn(d,p,q);j=p.stateNode,F.current=p;var de=J&&typeof S.getDerivedStateFromError!="function"?null:j.render();return p.flags|=1,d!==null&&J?(p.child=Ko(p,d.child,null,q),p.child=Ko(p,null,de,q)):ne(d,p,de,q),p.memoizedState=j.state,B&&mv(p,S,!0),p.child}function gi(d){var p=d.stateNode;p.pendingContext?tp(d,p.pendingContext,p.pendingContext!==p.context):p.context&&tp(d,p.context,!1),io(d,p.containerInfo)}function Za(d,p,S,j,B){return $o(),Ec(B),p.flags|=256,ne(d,p,S,j),p.child}var Ne={dehydrated:null,treeContext:null,retryLane:0};function we(d){return{baseLanes:d,cachePool:null,transitions:null}}function Me(d,p,S){var j=p.pendingProps,B=mr.current,q=!1,J=(p.flags&128)!==0,de;if((de=J)||(de=d!==null&&d.memoizedState===null?!1:(B&2)!==0),de?(q=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(B|=1),cr(mr,B&1),d===null)return Ul(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((p.mode&1)===0?p.lanes=1:d.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(J=j.children,d=j.fallback,q?(j=p.mode,q=p.child,J={mode:"hidden",children:J},(j&1)===0&&q!==null?(q.childLanes=0,q.pendingProps=J):q=Fv(J,j,0,null),d=Lc(d,j,S,null),q.return=p,d.return=p,q.sibling=d,p.child=q,p.child.memoizedState=we(S),p.memoizedState=Ne,d):nt(p,J));if(B=d.memoizedState,B!==null&&(de=B.dehydrated,de!==null))return It(d,p,J,j,de,B,S);if(q){q=j.fallback,J=p.mode,B=d.child,de=B.sibling;var me={mode:"hidden",children:j.children};return(J&1)===0&&p.child!==B?(j=p.child,j.childLanes=0,j.pendingProps=me,p.deletions=null):(j=lu(B,me),j.subtreeFlags=B.subtreeFlags&14680064),de!==null?q=lu(de,q):(q=Lc(q,J,S,null),q.flags|=2),q.return=p,j.return=p,j.sibling=q,p.child=j,j=q,q=p.child,J=d.child.memoizedState,J=J===null?we(S):{baseLanes:J.baseLanes|S,cachePool:null,transitions:J.transitions},q.memoizedState=J,q.childLanes=d.childLanes&~S,p.memoizedState=Ne,j}return q=d.child,d=q.sibling,j=lu(q,{mode:"visible",children:j.children}),(p.mode&1)===0&&(j.lanes=S),j.return=p,j.sibling=null,d!==null&&(S=p.deletions,S===null?(p.deletions=[d],p.flags|=16):S.push(d)),p.child=j,p.memoizedState=null,j}function nt(d,p){return p=Fv({mode:"visible",children:p},d.mode,0,null),p.return=d,d.child=p}function vt(d,p,S,j){return j!==null&&Ec(j),Ko(p,d.child,null,S),d=nt(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function It(d,p,S,j,B,q,J){if(S)return p.flags&256?(p.flags&=-257,j=bf(Error(r(422))),vt(d,p,J,j)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):(q=j.fallback,B=p.mode,j=Fv({mode:"visible",children:j.children},B,0,null),q=Lc(q,B,J,null),q.flags|=2,j.return=p,q.return=p,j.sibling=q,p.child=j,(p.mode&1)!==0&&Ko(p,d.child,null,J),p.child.memoizedState=we(J),p.memoizedState=Ne,q);if((p.mode&1)===0)return vt(d,p,J,null);if(B.data==="$!"){if(j=B.nextSibling&&B.nextSibling.dataset,j)var de=j.dgst;return j=de,q=Error(r(419)),j=bf(q,j,void 0),vt(d,p,J,j)}if(de=(J&d.childLanes)!==0,K||de){if(j=Qn,j!==null){switch(J&-J){case 4:B=2;break;case 16:B=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:B=32;break;case 536870912:B=268435456;break;default:B=0}B=(B&(j.suspendedLanes|J))!==0?0:B,B!==0&&B!==q.retryLane&&(q.retryLane=B,Xi(d,B),As(j,d,B,-1))}return d1(),j=bf(Error(r(421))),vt(d,p,J,j)}return B.data==="$?"?(p.flags|=128,p.child=d.child,p=M_.bind(null,d),B._reactRetry=p,null):(d=q.treeContext,Xe=qa(B.nextSibling),$i=p,rr=!0,Ki=null,d!==null&&(fi[hi++]=Wi,fi[hi++]=Pr,fi[hi++]=no,Wi=d.id,Pr=d.overflow,no=p),p=nt(p,j.children),p.flags|=4096,p)}function Rt(d,p,S){d.lanes|=p;var j=d.alternate;j!==null&&(j.lanes|=p),uf(d.return,p,S)}function $t(d,p,S,j,B){var q=d.memoizedState;q===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:j,tail:S,tailMode:B}:(q.isBackwards=p,q.rendering=null,q.renderingStartTime=0,q.last=j,q.tail=S,q.tailMode=B)}function yn(d,p,S){var j=p.pendingProps,B=j.revealOrder,q=j.tail;if(ne(d,p,j.children,S),j=mr.current,(j&2)!==0)j=j&1|2,p.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&Rt(d,S,p);else if(d.tag===19)Rt(d,S,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}j&=1}if(cr(mr,j),(p.mode&1)===0)p.memoizedState=null;else switch(B){case"forwards":for(S=p.child,B=null;S!==null;)d=S.alternate,d!==null&&$l(d)===null&&(B=S),S=S.sibling;S=B,S===null?(B=p.child,p.child=null):(B=S.sibling,S.sibling=null),$t(p,!1,B,S,q);break;case"backwards":for(S=null,B=p.child,p.child=null;B!==null;){if(d=B.alternate,d!==null&&$l(d)===null){p.child=B;break}d=B.sibling,B.sibling=S,S=B,B=d}$t(p,!0,S,null,q);break;case"together":$t(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function qt(d,p){(p.mode&1)===0&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function Xn(d,p,S){if(d!==null&&(p.dependencies=d.dependencies),Rc|=p.lanes,(S&p.childLanes)===0)return null;if(d!==null&&p.child!==d.child)throw Error(r(153));if(p.child!==null){for(d=p.child,S=lu(d,d.pendingProps),p.child=S,S.return=p;d.sibling!==null;)d=d.sibling,S=S.sibling=lu(d,d.pendingProps),S.return=p;S.sibling=null}return p.child}function Xx(d,p,S){switch(p.tag){case 3:gi(p),$o();break;case 5:Wl(p);break;case 1:Wn(p.type)&&Go(p);break;case 4:io(p,p.stateNode.containerInfo);break;case 10:var j=p.type._context,B=p.memoizedProps.value;cr(Tc,j._currentValue),j._currentValue=B;break;case 13:if(j=p.memoizedState,j!==null)return j.dehydrated!==null?(cr(mr,mr.current&1),p.flags|=128,null):(S&p.child.childLanes)!==0?Me(d,p,S):(cr(mr,mr.current&1),d=Xn(d,p,S),d!==null?d.sibling:null);cr(mr,mr.current&1);break;case 19:if(j=(S&p.childLanes)!==0,(d.flags&128)!==0){if(j)return yn(d,p,S);p.flags|=128}if(B=p.memoizedState,B!==null&&(B.rendering=null,B.tail=null,B.lastEffect=null),cr(mr,mr.current),j)break;return null;case 22:case 23:return p.lanes=0,lt(d,p,S)}return Xn(d,p,S)}var $k,Qx,Kk,Yk;$k=function(d,p){for(var S=p.child;S!==null;){if(S.tag===5||S.tag===6)d.appendChild(S.stateNode);else if(S.tag!==4&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===p)break;for(;S.sibling===null;){if(S.return===null||S.return===p)return;S=S.return}S.sibling.return=S.return,S=S.sibling}},Qx=function(){},Kk=function(d,p,S,j){var B=d.memoizedProps;if(B!==j){d=p.stateNode,gn(dr.current);var q=null;switch(S){case"input":B=Te(d,B),j=Te(d,j),q=[];break;case"select":B=Q({},B,{value:void 0}),j=Q({},j,{value:void 0}),q=[];break;case"textarea":B=Pe(d,B),j=Pe(d,j),q=[];break;default:typeof B.onClick!="function"&&typeof j.onClick=="function"&&(d.onclick=Fo)}be(S,j);var J;S=null;for(Ee in B)if(!j.hasOwnProperty(Ee)&&B.hasOwnProperty(Ee)&&B[Ee]!=null)if(Ee==="style"){var de=B[Ee];for(J in de)de.hasOwnProperty(J)&&(S||(S={}),S[J]="")}else Ee!=="dangerouslySetInnerHTML"&&Ee!=="children"&&Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&Ee!=="autoFocus"&&(i.hasOwnProperty(Ee)?q||(q=[]):(q=q||[]).push(Ee,null));for(Ee in j){var me=j[Ee];if(de=B?.[Ee],j.hasOwnProperty(Ee)&&me!==de&&(me!=null||de!=null))if(Ee==="style")if(de){for(J in de)!de.hasOwnProperty(J)||me&&me.hasOwnProperty(J)||(S||(S={}),S[J]="");for(J in me)me.hasOwnProperty(J)&&de[J]!==me[J]&&(S||(S={}),S[J]=me[J])}else S||(q||(q=[]),q.push(Ee,S)),S=me;else Ee==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,de=de?de.__html:void 0,me!=null&&de!==me&&(q=q||[]).push(Ee,me)):Ee==="children"?typeof me!="string"&&typeof me!="number"||(q=q||[]).push(Ee,""+me):Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ee)?(me!=null&&Ee==="onScroll"&&hr("scroll",d),q||de===me||(q=[])):(q=q||[]).push(Ee,me))}S&&(q=q||[]).push("style",S);var Ee=q;(p.updateQueue=Ee)&&(p.flags|=4)}},Yk=function(d,p,S,j){S!==j&&(p.flags|=4)};function pp(d,p){if(!rr)switch(d.tailMode){case"hidden":p=d.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?d.tail=null:S.sibling=null;break;case"collapsed":S=d.tail;for(var j=null;S!==null;)S.alternate!==null&&(j=S),S=S.sibling;j===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:j.sibling=null}}function _i(d){var p=d.alternate!==null&&d.alternate.child===d.child,S=0,j=0;if(p)for(var B=d.child;B!==null;)S|=B.lanes|B.childLanes,j|=B.subtreeFlags&14680064,j|=B.flags&14680064,B.return=d,B=B.sibling;else for(B=d.child;B!==null;)S|=B.lanes|B.childLanes,j|=B.subtreeFlags,j|=B.flags,B.return=d,B=B.sibling;return d.subtreeFlags|=j,d.childLanes=S,p}function x_(d,p,S){var j=p.pendingProps;switch(En(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _i(p),null;case 1:return Wn(p.type)&&Fl(),_i(p),null;case 3:return j=p.stateNode,_r(),pr(qn),pr(In),$n(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(d===null||d.child===null)&&(Nc(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,Ki!==null&&(l1(Ki),Ki=null))),Qx(d,p),_i(p),null;case 5:Ts(p);var B=gn(Yr.current);if(S=p.type,d!==null&&p.stateNode!=null)Kk(d,p,S,j,B),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!j){if(p.stateNode===null)throw Error(r(166));return _i(p),null}if(d=gn(dr.current),Nc(p)){j=p.stateNode,S=p.type;var q=p.memoizedProps;switch(j[ca]=p,j[Sc]=q,d=(p.mode&1)!==0,S){case"dialog":hr("cancel",j),hr("close",j);break;case"iframe":case"object":case"embed":hr("load",j);break;case"video":case"audio":for(B=0;B<Xs.length;B++)hr(Xs[B],j);break;case"source":hr("error",j);break;case"img":case"image":case"link":hr("error",j),hr("load",j);break;case"details":hr("toggle",j);break;case"input":Oe(j,q),hr("invalid",j);break;case"select":j._wrapperState={wasMultiple:!!q.multiple},hr("invalid",j);break;case"textarea":Be(j,q),hr("invalid",j)}be(S,q),B=null;for(var J in q)if(q.hasOwnProperty(J)){var de=q[J];J==="children"?typeof de=="string"?j.textContent!==de&&(q.suppressHydrationWarning!==!0&&bc(j.textContent,de,d),B=["children",de]):typeof de=="number"&&j.textContent!==""+de&&(q.suppressHydrationWarning!==!0&&bc(j.textContent,de,d),B=["children",""+de]):i.hasOwnProperty(J)&&de!=null&&J==="onScroll"&&hr("scroll",j)}switch(S){case"input":oe(j),He(j,q,!0);break;case"textarea":oe(j),et(j);break;case"select":case"option":break;default:typeof q.onClick=="function"&&(j.onclick=Fo)}j=B,p.updateQueue=j,j!==null&&(p.flags|=4)}else{J=B.nodeType===9?B:B.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=mt(S)),d==="http://www.w3.org/1999/xhtml"?S==="script"?(d=J.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof j.is=="string"?d=J.createElement(S,{is:j.is}):(d=J.createElement(S),S==="select"&&(J=d,j.multiple?J.multiple=!0:j.size&&(J.size=j.size))):d=J.createElementNS(d,S),d[ca]=p,d[Sc]=j,$k(d,p,!1,!1),p.stateNode=d;e:{switch(J=Ce(S,j),S){case"dialog":hr("cancel",d),hr("close",d),B=j;break;case"iframe":case"object":case"embed":hr("load",d),B=j;break;case"video":case"audio":for(B=0;B<Xs.length;B++)hr(Xs[B],d);B=j;break;case"source":hr("error",d),B=j;break;case"img":case"image":case"link":hr("error",d),hr("load",d),B=j;break;case"details":hr("toggle",d),B=j;break;case"input":Oe(d,j),B=Te(d,j),hr("invalid",d);break;case"option":B=j;break;case"select":d._wrapperState={wasMultiple:!!j.multiple},B=Q({},j,{value:void 0}),hr("invalid",d);break;case"textarea":Be(d,j),B=Pe(d,j),hr("invalid",d);break;default:B=j}be(S,B),de=B;for(q in de)if(de.hasOwnProperty(q)){var me=de[q];q==="style"?ue(d,me):q==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,me!=null&&_t(d,me)):q==="children"?typeof me=="string"?(S!=="textarea"||me!=="")&&ot(d,me):typeof me=="number"&&ot(d,""+me):q!=="suppressContentEditableWarning"&&q!=="suppressHydrationWarning"&&q!=="autoFocus"&&(i.hasOwnProperty(q)?me!=null&&q==="onScroll"&&hr("scroll",d):me!=null&&C(d,q,me,J))}switch(S){case"input":oe(d),He(d,j,!1);break;case"textarea":oe(d),et(d);break;case"option":j.value!=null&&d.setAttribute("value",""+le(j.value));break;case"select":d.multiple=!!j.multiple,q=j.value,q!=null?ye(d,!!j.multiple,q,!1):j.defaultValue!=null&&ye(d,!!j.multiple,j.defaultValue,!0);break;default:typeof B.onClick=="function"&&(d.onclick=Fo)}switch(S){case"button":case"input":case"select":case"textarea":j=!!j.autoFocus;break e;case"img":j=!0;break e;default:j=!1}}j&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return _i(p),null;case 6:if(d&&p.stateNode!=null)Yk(d,p,d.memoizedProps,j);else{if(typeof j!="string"&&p.stateNode===null)throw Error(r(166));if(S=gn(Yr.current),gn(dr.current),Nc(p)){if(j=p.stateNode,S=p.memoizedProps,j[ca]=p,(q=j.nodeValue!==S)&&(d=$i,d!==null))switch(d.tag){case 3:bc(j.nodeValue,S,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&bc(j.nodeValue,S,(d.mode&1)!==0)}q&&(p.flags|=4)}else j=(S.nodeType===9?S:S.ownerDocument).createTextNode(j),j[ca]=p,p.stateNode=j}return _i(p),null;case 13:if(pr(mr),j=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(rr&&Xe!==null&&(p.mode&1)!==0&&(p.flags&128)===0)np(),$o(),p.flags|=98560,q=!1;else if(q=Nc(p),j!==null&&j.dehydrated!==null){if(d===null){if(!q)throw Error(r(318));if(q=p.memoizedState,q=q!==null?q.dehydrated:null,!q)throw Error(r(317));q[ca]=p}else $o(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;_i(p),q=!1}else Ki!==null&&(l1(Ki),Ki=null),q=!0;if(!q)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=S,p):(j=j!==null,j!==(d!==null&&d.memoizedState!==null)&&j&&(p.child.flags|=8192,(p.mode&1)!==0&&(d===null||(mr.current&1)!==0?Bn===0&&(Bn=3):d1())),p.updateQueue!==null&&(p.flags|=4),_i(p),null);case 4:return _r(),Qx(d,p),d===null&&Lo(p.stateNode.containerInfo),_i(p),null;case 10:return lf(p.type._context),_i(p),null;case 17:return Wn(p.type)&&Fl(),_i(p),null;case 19:if(pr(mr),q=p.memoizedState,q===null)return _i(p),null;if(j=(p.flags&128)!==0,J=q.rendering,J===null)if(j)pp(q,!1);else{if(Bn!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if(J=$l(d),J!==null){for(p.flags|=128,pp(q,!1),j=J.updateQueue,j!==null&&(p.updateQueue=j,p.flags|=4),p.subtreeFlags=0,j=S,S=p.child;S!==null;)q=S,d=j,q.flags&=14680066,J=q.alternate,J===null?(q.childLanes=0,q.lanes=d,q.child=null,q.subtreeFlags=0,q.memoizedProps=null,q.memoizedState=null,q.updateQueue=null,q.dependencies=null,q.stateNode=null):(q.childLanes=J.childLanes,q.lanes=J.lanes,q.child=J.child,q.subtreeFlags=0,q.deletions=null,q.memoizedProps=J.memoizedProps,q.memoizedState=J.memoizedState,q.updateQueue=J.updateQueue,q.type=J.type,d=J.dependencies,q.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),S=S.sibling;return cr(mr,mr.current&1|2),p.child}d=d.sibling}q.tail!==null&&Dr()>kf&&(p.flags|=128,j=!0,pp(q,!1),p.lanes=4194304)}else{if(!j)if(d=$l(J),d!==null){if(p.flags|=128,j=!0,S=d.updateQueue,S!==null&&(p.updateQueue=S,p.flags|=4),pp(q,!0),q.tail===null&&q.tailMode==="hidden"&&!J.alternate&&!rr)return _i(p),null}else 2*Dr()-q.renderingStartTime>kf&&S!==1073741824&&(p.flags|=128,j=!0,pp(q,!1),p.lanes=4194304);q.isBackwards?(J.sibling=p.child,p.child=J):(S=q.last,S!==null?S.sibling=J:p.child=J,q.last=J)}return q.tail!==null?(p=q.tail,q.rendering=p,q.tail=p.sibling,q.renderingStartTime=Dr(),p.sibling=null,S=mr.current,cr(mr,j?S&1|2:S&1),p):(_i(p),null);case 22:case 23:return c1(),j=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==j&&(p.flags|=8192),j&&(p.mode&1)!==0?(Ia&1073741824)!==0&&(_i(p),p.subtreeFlags&6&&(p.flags|=8192)):_i(p),null;case 24:return null;case 25:return null}throw Error(r(156,p.tag))}function b_(d,p){switch(En(p),p.tag){case 1:return Wn(p.type)&&Fl(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return _r(),pr(qn),pr(In),$n(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 5:return Ts(p),null;case 13:if(pr(mr),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(r(340));$o()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return pr(mr),null;case 4:return _r(),null;case 10:return lf(p.type._context),null;case 22:case 23:return c1(),null;case 24:return null;default:return null}}var jv=!1,Ai=!1,w_=typeof WeakSet=="function"?WeakSet:Set,ut=null;function wf(d,p){var S=d.ref;if(S!==null)if(typeof S=="function")try{S(null)}catch(j){nn(d,p,j)}else S.current=null}function Jx(d,p,S){try{S()}catch(j){nn(d,p,j)}}var Xk=!1;function S_(d,p){if(Qh=Rd,d=pn(),Ol(d)){if("selectionStart"in d)var S={start:d.selectionStart,end:d.selectionEnd};else e:{S=(S=d.ownerDocument)&&S.defaultView||window;var j=S.getSelection&&S.getSelection();if(j&&j.rangeCount!==0){S=j.anchorNode;var B=j.anchorOffset,q=j.focusNode;j=j.focusOffset;try{S.nodeType,q.nodeType}catch{S=null;break e}var J=0,de=-1,me=-1,Ee=0,ze=0,Ue=d,Fe=null;t:for(;;){for(var at;Ue!==S||B!==0&&Ue.nodeType!==3||(de=J+B),Ue!==q||j!==0&&Ue.nodeType!==3||(me=J+j),Ue.nodeType===3&&(J+=Ue.nodeValue.length),(at=Ue.firstChild)!==null;)Fe=Ue,Ue=at;for(;;){if(Ue===d)break t;if(Fe===S&&++Ee===B&&(de=J),Fe===q&&++ze===j&&(me=J),(at=Ue.nextSibling)!==null)break;Ue=Fe,Fe=Ue.parentNode}Ue=at}S=de===-1||me===-1?null:{start:de,end:me}}else S=null}S=S||{start:0,end:0}}else S=null;for(Jh={focusedElem:d,selectionRange:S},Rd=!1,ut=p;ut!==null;)if(p=ut,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,ut=d;else for(;ut!==null;){p=ut;try{var ft=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(ft!==null){var ht=ft.memoizedProps,xn=ft.memoizedState,Se=p.stateNode,ve=Se.getSnapshotBeforeUpdate(p.elementType===p.type?ht:Ln(p.type,ht),xn);Se.__reactInternalSnapshotBeforeUpdate=ve}break;case 3:var ke=p.stateNode.containerInfo;ke.nodeType===1?ke.textContent="":ke.nodeType===9&&ke.documentElement&&ke.removeChild(ke.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ke){nn(p,p.return,Ke)}if(d=p.sibling,d!==null){d.return=p.return,ut=d;break}ut=p.return}return ft=Xk,Xk=!1,ft}function mp(d,p,S){var j=p.updateQueue;if(j=j!==null?j.lastEffect:null,j!==null){var B=j=j.next;do{if((B.tag&d)===d){var q=B.destroy;B.destroy=void 0,q!==void 0&&Jx(p,S,q)}B=B.next}while(B!==j)}}function Pv(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var S=p=p.next;do{if((S.tag&d)===d){var j=S.create;S.destroy=j()}S=S.next}while(S!==p)}}function Zx(d){var p=d.ref;if(p!==null){var S=d.stateNode;d.tag,d=S,typeof p=="function"?p(d):p.current=d}}function Qk(d){var p=d.alternate;p!==null&&(d.alternate=null,Qk(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[ca],delete p[Sc],delete p[Zd],delete p[hv],delete p[pv])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function Jk(d){return d.tag===5||d.tag===3||d.tag===4}function Zk(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||Jk(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function e1(d,p,S){var j=d.tag;if(j===5||j===6)d=d.stateNode,p?S.nodeType===8?S.parentNode.insertBefore(d,p):S.insertBefore(d,p):(S.nodeType===8?(p=S.parentNode,p.insertBefore(d,S)):(p=S,p.appendChild(d)),S=S._reactRootContainer,S!=null||p.onclick!==null||(p.onclick=Fo));else if(j!==4&&(d=d.child,d!==null))for(e1(d,p,S),d=d.sibling;d!==null;)e1(d,p,S),d=d.sibling}function t1(d,p,S){var j=d.tag;if(j===5||j===6)d=d.stateNode,p?S.insertBefore(d,p):S.appendChild(d);else if(j!==4&&(d=d.child,d!==null))for(t1(d,p,S),d=d.sibling;d!==null;)t1(d,p,S),d=d.sibling}var vi=null,Ms=!1;function nu(d,p,S){for(S=S.child;S!==null;)eC(d,p,S),S=S.sibling}function eC(d,p,S){if(Jr&&typeof Jr.onCommitFiberUnmount=="function")try{Jr.onCommitFiberUnmount(aa,S)}catch{}switch(S.tag){case 5:Ai||wf(S,p);case 6:var j=vi,B=Ms;vi=null,nu(d,p,S),vi=j,Ms=B,vi!==null&&(Ms?(d=vi,S=S.stateNode,d.nodeType===8?d.parentNode.removeChild(S):d.removeChild(S)):vi.removeChild(S.stateNode));break;case 18:vi!==null&&(Ms?(d=vi,S=S.stateNode,d.nodeType===8?Jd(d.parentNode,S):d.nodeType===1&&Jd(d,S),Ti(d)):Jd(vi,S.stateNode));break;case 4:j=vi,B=Ms,vi=S.stateNode.containerInfo,Ms=!0,nu(d,p,S),vi=j,Ms=B;break;case 0:case 11:case 14:case 15:if(!Ai&&(j=S.updateQueue,j!==null&&(j=j.lastEffect,j!==null))){B=j=j.next;do{var q=B,J=q.destroy;q=q.tag,J!==void 0&&((q&2)!==0||(q&4)!==0)&&Jx(S,p,J),B=B.next}while(B!==j)}nu(d,p,S);break;case 1:if(!Ai&&(wf(S,p),j=S.stateNode,typeof j.componentWillUnmount=="function"))try{j.props=S.memoizedProps,j.state=S.memoizedState,j.componentWillUnmount()}catch(de){nn(S,p,de)}nu(d,p,S);break;case 21:nu(d,p,S);break;case 22:S.mode&1?(Ai=(j=Ai)||S.memoizedState!==null,nu(d,p,S),Ai=j):nu(d,p,S);break;default:nu(d,p,S)}}function tC(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var S=d.stateNode;S===null&&(S=d.stateNode=new w_),p.forEach(function(j){var B=__.bind(null,d,j);S.has(j)||(S.add(j),j.then(B,B))})}}function _s(d,p){var S=p.deletions;if(S!==null)for(var j=0;j<S.length;j++){var B=S[j];try{var q=d,J=p,de=J;e:for(;de!==null;){switch(de.tag){case 5:vi=de.stateNode,Ms=!1;break e;case 3:vi=de.stateNode.containerInfo,Ms=!0;break e;case 4:vi=de.stateNode.containerInfo,Ms=!0;break e}de=de.return}if(vi===null)throw Error(r(160));eC(q,J,B),vi=null,Ms=!1;var me=B.alternate;me!==null&&(me.return=null),B.return=null}catch(Ee){nn(B,p,Ee)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)rC(p,d),p=p.sibling}function rC(d,p){var S=d.alternate,j=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(_s(p,d),uo(d),j&4){try{mp(3,d,d.return),Pv(3,d)}catch(ht){nn(d,d.return,ht)}try{mp(5,d,d.return)}catch(ht){nn(d,d.return,ht)}}break;case 1:_s(p,d),uo(d),j&512&&S!==null&&wf(S,S.return);break;case 5:if(_s(p,d),uo(d),j&512&&S!==null&&wf(S,S.return),d.flags&32){var B=d.stateNode;try{ot(B,"")}catch(ht){nn(d,d.return,ht)}}if(j&4&&(B=d.stateNode,B!=null)){var q=d.memoizedProps,J=S!==null?S.memoizedProps:q,de=d.type,me=d.updateQueue;if(d.updateQueue=null,me!==null)try{de==="input"&&q.type==="radio"&&q.name!=null&&_e(B,q),Ce(de,J);var Ee=Ce(de,q);for(J=0;J<me.length;J+=2){var ze=me[J],Ue=me[J+1];ze==="style"?ue(B,Ue):ze==="dangerouslySetInnerHTML"?_t(B,Ue):ze==="children"?ot(B,Ue):C(B,ze,Ue,Ee)}switch(de){case"input":Ae(B,q);break;case"textarea":Ge(B,q);break;case"select":var Fe=B._wrapperState.wasMultiple;B._wrapperState.wasMultiple=!!q.multiple;var at=q.value;at!=null?ye(B,!!q.multiple,at,!1):Fe!==!!q.multiple&&(q.defaultValue!=null?ye(B,!!q.multiple,q.defaultValue,!0):ye(B,!!q.multiple,q.multiple?[]:"",!1))}B[Sc]=q}catch(ht){nn(d,d.return,ht)}}break;case 6:if(_s(p,d),uo(d),j&4){if(d.stateNode===null)throw Error(r(162));B=d.stateNode,q=d.memoizedProps;try{B.nodeValue=q}catch(ht){nn(d,d.return,ht)}}break;case 3:if(_s(p,d),uo(d),j&4&&S!==null&&S.memoizedState.isDehydrated)try{Ti(p.containerInfo)}catch(ht){nn(d,d.return,ht)}break;case 4:_s(p,d),uo(d);break;case 13:_s(p,d),uo(d),B=d.child,B.flags&8192&&(q=B.memoizedState!==null,B.stateNode.isHidden=q,!q||B.alternate!==null&&B.alternate.memoizedState!==null||(i1=Dr())),j&4&&tC(d);break;case 22:if(ze=S!==null&&S.memoizedState!==null,d.mode&1?(Ai=(Ee=Ai)||ze,_s(p,d),Ai=Ee):_s(p,d),uo(d),j&8192){if(Ee=d.memoizedState!==null,(d.stateNode.isHidden=Ee)&&!ze&&(d.mode&1)!==0)for(ut=d,ze=d.child;ze!==null;){for(Ue=ut=ze;ut!==null;){switch(Fe=ut,at=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:mp(4,Fe,Fe.return);break;case 1:wf(Fe,Fe.return);var ft=Fe.stateNode;if(typeof ft.componentWillUnmount=="function"){j=Fe,S=Fe.return;try{p=j,ft.props=p.memoizedProps,ft.state=p.memoizedState,ft.componentWillUnmount()}catch(ht){nn(j,S,ht)}}break;case 5:wf(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){aC(Ue);continue}}at!==null?(at.return=Fe,ut=at):aC(Ue)}ze=ze.sibling}e:for(ze=null,Ue=d;;){if(Ue.tag===5){if(ze===null){ze=Ue;try{B=Ue.stateNode,Ee?(q=B.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none"):(de=Ue.stateNode,me=Ue.memoizedProps.style,J=me!=null&&me.hasOwnProperty("display")?me.display:null,de.style.display=re("display",J))}catch(ht){nn(d,d.return,ht)}}}else if(Ue.tag===6){if(ze===null)try{Ue.stateNode.nodeValue=Ee?"":Ue.memoizedProps}catch(ht){nn(d,d.return,ht)}}else if((Ue.tag!==22&&Ue.tag!==23||Ue.memoizedState===null||Ue===d)&&Ue.child!==null){Ue.child.return=Ue,Ue=Ue.child;continue}if(Ue===d)break e;for(;Ue.sibling===null;){if(Ue.return===null||Ue.return===d)break e;ze===Ue&&(ze=null),Ue=Ue.return}ze===Ue&&(ze=null),Ue.sibling.return=Ue.return,Ue=Ue.sibling}}break;case 19:_s(p,d),uo(d),j&4&&tC(d);break;case 21:break;default:_s(p,d),uo(d)}}function uo(d){var p=d.flags;if(p&2){try{e:{for(var S=d.return;S!==null;){if(Jk(S)){var j=S;break e}S=S.return}throw Error(r(160))}switch(j.tag){case 5:var B=j.stateNode;j.flags&32&&(ot(B,""),j.flags&=-33);var q=Zk(d);t1(d,q,B);break;case 3:case 4:var J=j.stateNode.containerInfo,de=Zk(d);e1(d,de,J);break;default:throw Error(r(161))}}catch(me){nn(d,d.return,me)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function k_(d,p,S){ut=d,nC(d)}function nC(d,p,S){for(var j=(d.mode&1)!==0;ut!==null;){var B=ut,q=B.child;if(B.tag===22&&j){var J=B.memoizedState!==null||jv;if(!J){var de=B.alternate,me=de!==null&&de.memoizedState!==null||Ai;de=jv;var Ee=Ai;if(jv=J,(Ai=me)&&!Ee)for(ut=B;ut!==null;)J=ut,me=J.child,J.tag===22&&J.memoizedState!==null?sC(B):me!==null?(me.return=J,ut=me):sC(B);for(;q!==null;)ut=q,nC(q),q=q.sibling;ut=B,jv=de,Ai=Ee}iC(d)}else(B.subtreeFlags&8772)!==0&&q!==null?(q.return=B,ut=q):iC(d)}}function iC(d){for(;ut!==null;){var p=ut;if((p.flags&8772)!==0){var S=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Ai||Pv(5,p);break;case 1:var j=p.stateNode;if(p.flags&4&&!Ai)if(S===null)j.componentDidMount();else{var B=p.elementType===p.type?S.memoizedProps:Ln(p.type,S.memoizedProps);j.componentDidUpdate(B,S.memoizedState,j.__reactInternalSnapshotBeforeUpdate)}var q=p.updateQueue;q!==null&&Vr(p,q,j);break;case 3:var J=p.updateQueue;if(J!==null){if(S=null,p.child!==null)switch(p.child.tag){case 5:S=p.child.stateNode;break;case 1:S=p.child.stateNode}Vr(p,J,S)}break;case 5:var de=p.stateNode;if(S===null&&p.flags&4){S=de;var me=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":me.autoFocus&&S.focus();break;case"img":me.src&&(S.src=me.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var Ee=p.alternate;if(Ee!==null){var ze=Ee.memoizedState;if(ze!==null){var Ue=ze.dehydrated;Ue!==null&&Ti(Ue)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Ai||p.flags&512&&Zx(p)}catch(Fe){nn(p,p.return,Fe)}}if(p===d){ut=null;break}if(S=p.sibling,S!==null){S.return=p.return,ut=S;break}ut=p.return}}function aC(d){for(;ut!==null;){var p=ut;if(p===d){ut=null;break}var S=p.sibling;if(S!==null){S.return=p.return,ut=S;break}ut=p.return}}function sC(d){for(;ut!==null;){var p=ut;try{switch(p.tag){case 0:case 11:case 15:var S=p.return;try{Pv(4,p)}catch(me){nn(p,S,me)}break;case 1:var j=p.stateNode;if(typeof j.componentDidMount=="function"){var B=p.return;try{j.componentDidMount()}catch(me){nn(p,B,me)}}var q=p.return;try{Zx(p)}catch(me){nn(p,q,me)}break;case 5:var J=p.return;try{Zx(p)}catch(me){nn(p,J,me)}}}catch(me){nn(p,p.return,me)}if(p===d){ut=null;break}var de=p.sibling;if(de!==null){de.return=p.return,ut=de;break}ut=p.return}}var C_=Math.ceil,Mv=E.ReactCurrentDispatcher,r1=E.ReactCurrentOwner,es=E.ReactCurrentBatchConfig,Qt=0,Qn=null,Tn=null,yi=0,Ia=0,Sf=Cs(0),Bn=0,gp=null,Rc=0,_v=0,n1=0,vp=null,ha=null,i1=0,kf=1/0,Jo=null,Av=!1,a1=null,iu=null,Rv=!1,au=null,Dv=0,yp=0,s1=null,Ov=-1,Iv=0;function Ji(){return(Qt&6)!==0?Dr():Ov!==-1?Ov:Ov=Dr()}function su(d){return(d.mode&1)===0?1:(Qt&2)!==0&&yi!==0?yi&-yi:ip.transition!==null?(Iv===0&&(Iv=Ph()),Iv):(d=Yt,d!==0||(d=window.event,d=d===void 0?16:Xg(d.type)),d)}function As(d,p,S,j){if(50<yp)throw yp=0,s1=null,Error(r(185));oc(d,S,j),((Qt&2)===0||d!==Qn)&&(d===Qn&&((Qt&2)===0&&(_v|=S),Bn===4&&ou(d,yi)),pa(d,j),S===1&&Qt===0&&(p.mode&1)===0&&(kf=Dr()+500,zl&&eo()))}function pa(d,p){var S=d.callbackNode;qg(d,p);var j=ys(d,d===Qn?yi:0);if(j===0)S!==null&&Td(S),d.callbackNode=null,d.callbackPriority=0;else if(p=j&-j,d.callbackPriority!==p){if(S!=null&&Td(S),p===1)d.tag===0?Ns(lC.bind(null,d)):Cc(lC.bind(null,d)),dv(function(){(Qt&6)===0&&eo()}),S=null;else{switch(lc(j)){case 1:S=gs;break;case 4:S=Sl;break;case 16:S=ia;break;case 536870912:S=vs;break;default:S=ia}S=gC(S,oC.bind(null,d))}d.callbackPriority=p,d.callbackNode=S}}function oC(d,p){if(Ov=-1,Iv=0,(Qt&6)!==0)throw Error(r(327));var S=d.callbackNode;if(Cf()&&d.callbackNode!==S)return null;var j=ys(d,d===Qn?yi:0);if(j===0)return null;if((j&30)!==0||(j&d.expiredLanes)!==0||p)p=Lv(d,j);else{p=j;var B=Qt;Qt|=2;var q=cC();(Qn!==d||yi!==p)&&(Jo=null,kf=Dr()+500,Oc(d,p));do try{T_();break}catch(de){uC(d,de)}while(!0);of(),Mv.current=q,Qt=B,Tn!==null?p=0:(Qn=null,yi=0,p=Bn)}if(p!==0){if(p===2&&(B=kl(d),B!==0&&(j=B,p=o1(d,B))),p===1)throw S=gp,Oc(d,0),ou(d,j),pa(d,Dr()),S;if(p===6)ou(d,j);else{if(B=d.current.alternate,(j&30)===0&&!N_(B)&&(p=Lv(d,j),p===2&&(q=kl(d),q!==0&&(j=q,p=o1(d,q))),p===1))throw S=gp,Oc(d,0),ou(d,j),pa(d,Dr()),S;switch(d.finishedWork=B,d.finishedLanes=j,p){case 0:case 1:throw Error(r(345));case 2:Ic(d,ha,Jo);break;case 3:if(ou(d,j),(j&130023424)===j&&(p=i1+500-Dr(),10<p)){if(ys(d,0)!==0)break;if(B=d.suspendedLanes,(B&j)!==j){Ji(),d.pingedLanes|=d.suspendedLanes&B;break}d.timeoutHandle=qi(Ic.bind(null,d,ha,Jo),p);break}Ic(d,ha,Jo);break;case 4:if(ou(d,j),(j&4194240)===j)break;for(p=d.eventTimes,B=-1;0<j;){var J=31-Tt(j);q=1<<J,J=p[J],J>B&&(B=J),j&=~q}if(j=B,j=Dr()-j,j=(120>j?120:480>j?480:1080>j?1080:1920>j?1920:3e3>j?3e3:4320>j?4320:1960*C_(j/1960))-j,10<j){d.timeoutHandle=qi(Ic.bind(null,d,ha,Jo),j);break}Ic(d,ha,Jo);break;case 5:Ic(d,ha,Jo);break;default:throw Error(r(329))}}}return pa(d,Dr()),d.callbackNode===S?oC.bind(null,d):null}function o1(d,p){var S=vp;return d.current.memoizedState.isDehydrated&&(Oc(d,p).flags|=256),d=Lv(d,p),d!==2&&(p=ha,ha=S,p!==null&&l1(p)),d}function l1(d){ha===null?ha=d:ha.push.apply(ha,d)}function N_(d){for(var p=d;;){if(p.flags&16384){var S=p.updateQueue;if(S!==null&&(S=S.stores,S!==null))for(var j=0;j<S.length;j++){var B=S[j],q=B.getSnapshot;B=B.value;try{if(!Pi(q(),B))return!1}catch{return!1}}}if(S=p.child,p.subtreeFlags&16384&&S!==null)S.return=p,p=S;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function ou(d,p){for(p&=~n1,p&=~_v,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var S=31-Tt(p),j=1<<S;d[S]=-1,p&=~j}}function lC(d){if((Qt&6)!==0)throw Error(r(327));Cf();var p=ys(d,0);if((p&1)===0)return pa(d,Dr()),null;var S=Lv(d,p);if(d.tag!==0&&S===2){var j=kl(d);j!==0&&(p=j,S=o1(d,j))}if(S===1)throw S=gp,Oc(d,0),ou(d,p),pa(d,Dr()),S;if(S===6)throw Error(r(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,Ic(d,ha,Jo),pa(d,Dr()),null}function u1(d,p){var S=Qt;Qt|=1;try{return d(p)}finally{Qt=S,Qt===0&&(kf=Dr()+500,zl&&eo())}}function Dc(d){au!==null&&au.tag===0&&(Qt&6)===0&&Cf();var p=Qt;Qt|=1;var S=es.transition,j=Yt;try{if(es.transition=null,Yt=1,d)return d()}finally{Yt=j,es.transition=S,Qt=p,(Qt&6)===0&&eo()}}function c1(){Ia=Sf.current,pr(Sf)}function Oc(d,p){d.finishedWork=null,d.finishedLanes=0;var S=d.timeoutHandle;if(S!==-1&&(d.timeoutHandle=-1,ep(S)),Tn!==null)for(S=Tn.return;S!==null;){var j=S;switch(En(j),j.tag){case 1:j=j.type.childContextTypes,j!=null&&Fl();break;case 3:_r(),pr(qn),pr(In),$n();break;case 5:Ts(j);break;case 4:_r();break;case 13:pr(mr);break;case 19:pr(mr);break;case 10:lf(j.type._context);break;case 22:case 23:c1()}S=S.return}if(Qn=d,Tn=d=lu(d.current,null),yi=Ia=p,Bn=0,gp=null,n1=_v=Rc=0,ha=vp=null,Ya!==null){for(p=0;p<Ya.length;p++)if(S=Ya[p],j=S.interleaved,j!==null){S.interleaved=null;var B=j.next,q=S.pending;if(q!==null){var J=q.next;q.next=B,j.next=J}S.pending=j}Ya=null}return d}function uC(d,p){do{var S=Tn;try{if(of(),Kl.current=Zl,Oa){for(var j=sr.memoizedState;j!==null;){var B=j.queue;B!==null&&(B.pending=null),j=j.next}Oa=!1}if(mi=0,tn=Ur=sr=null,ao=!1,fa=0,r1.current=null,S===null||S.return===null){Bn=1,gp=p,Tn=null;break}e:{var q=d,J=S.return,de=S,me=p;if(p=yi,de.flags|=32768,me!==null&&typeof me=="object"&&typeof me.then=="function"){var Ee=me,ze=de,Ue=ze.tag;if((ze.mode&1)===0&&(Ue===0||Ue===11||Ue===15)){var Fe=ze.alternate;Fe?(ze.updateQueue=Fe.updateQueue,ze.memoizedState=Fe.memoizedState,ze.lanes=Fe.lanes):(ze.updateQueue=null,ze.memoizedState=null)}var at=T(J);if(at!==null){at.flags&=-257,R(at,J,de,q,p),at.mode&1&&x(q,Ee,p),p=at,me=Ee;var ft=p.updateQueue;if(ft===null){var ht=new Set;ht.add(me),p.updateQueue=ht}else ft.add(me);break e}else{if((p&1)===0){x(q,Ee,p),d1();break e}me=Error(r(426))}}else if(rr&&de.mode&1){var xn=T(J);if(xn!==null){(xn.flags&65536)===0&&(xn.flags|=256),R(xn,J,de,q,p),Ec(Qo(me,de));break e}}q=me=Qo(me,de),Bn!==4&&(Bn=2),vp===null?vp=[q]:vp.push(q),q=J;do{switch(q.tag){case 3:q.flags|=65536,p&=-p,q.lanes|=p;var Se=Tv(q,me,p);Mc(q,Se);break e;case 1:de=me;var ve=q.type,ke=q.stateNode;if((q.flags&128)===0&&(typeof ve.getDerivedStateFromError=="function"||ke!==null&&typeof ke.componentDidCatch=="function"&&(iu===null||!iu.has(ke)))){q.flags|=65536,p&=-p,q.lanes|=p;var Ke=v(q,de,p);Mc(q,Ke);break e}}q=q.return}while(q!==null)}fC(S)}catch(pt){p=pt,Tn===S&&S!==null&&(Tn=S=S.return);continue}break}while(!0)}function cC(){var d=Mv.current;return Mv.current=Zl,d===null?Zl:d}function d1(){(Bn===0||Bn===3||Bn===2)&&(Bn=4),Qn===null||(Rc&268435455)===0&&(_v&268435455)===0||ou(Qn,yi)}function Lv(d,p){var S=Qt;Qt|=2;var j=cC();(Qn!==d||yi!==p)&&(Jo=null,Oc(d,p));do try{E_();break}catch(B){uC(d,B)}while(!0);if(of(),Qt=S,Mv.current=j,Tn!==null)throw Error(r(261));return Qn=null,yi=0,Bn}function E_(){for(;Tn!==null;)dC(Tn)}function T_(){for(;Tn!==null&&!Th();)dC(Tn)}function dC(d){var p=mC(d.alternate,d,Ia);d.memoizedProps=d.pendingProps,p===null?fC(d):Tn=p,r1.current=null}function fC(d){var p=d;do{var S=p.alternate;if(d=p.return,(p.flags&32768)===0){if(S=x_(S,p,Ia),S!==null){Tn=S;return}}else{if(S=b_(S,p),S!==null){S.flags&=32767,Tn=S;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{Bn=6,Tn=null;return}}if(p=p.sibling,p!==null){Tn=p;return}Tn=p=d}while(p!==null);Bn===0&&(Bn=5)}function Ic(d,p,S){var j=Yt,B=es.transition;try{es.transition=null,Yt=1,j_(d,p,S,j)}finally{es.transition=B,Yt=j}return null}function j_(d,p,S,j){do Cf();while(au!==null);if((Qt&6)!==0)throw Error(r(327));S=d.finishedWork;var B=d.finishedLanes;if(S===null)return null;if(d.finishedWork=null,d.finishedLanes=0,S===d.current)throw Error(r(177));d.callbackNode=null,d.callbackPriority=0;var q=S.lanes|S.childLanes;if(Ux(d,q),d===Qn&&(Tn=Qn=null,yi=0),(S.subtreeFlags&2064)===0&&(S.flags&2064)===0||Rv||(Rv=!0,gC(ia,function(){return Cf(),null})),q=(S.flags&15990)!==0,(S.subtreeFlags&15990)!==0||q){q=es.transition,es.transition=null;var J=Yt;Yt=1;var de=Qt;Qt|=4,r1.current=null,S_(d,S),rC(S,d),gc(Jh),Rd=!!Qh,Jh=Qh=null,d.current=S,k_(S),jh(),Qt=de,Yt=J,es.transition=q}else d.current=S;if(Rv&&(Rv=!1,au=d,Dv=B),q=d.pendingLanes,q===0&&(iu=null),ur(S.stateNode),pa(d,Dr()),p!==null)for(j=d.onRecoverableError,S=0;S<p.length;S++)B=p[S],j(B.value,{componentStack:B.stack,digest:B.digest});if(Av)throw Av=!1,d=a1,a1=null,d;return(Dv&1)!==0&&d.tag!==0&&Cf(),q=d.pendingLanes,(q&1)!==0?d===s1?yp++:(yp=0,s1=d):yp=0,eo(),null}function Cf(){if(au!==null){var d=lc(Dv),p=es.transition,S=Yt;try{if(es.transition=null,Yt=16>d?16:d,au===null)var j=!1;else{if(d=au,au=null,Dv=0,(Qt&6)!==0)throw Error(r(331));var B=Qt;for(Qt|=4,ut=d.current;ut!==null;){var q=ut,J=q.child;if((ut.flags&16)!==0){var de=q.deletions;if(de!==null){for(var me=0;me<de.length;me++){var Ee=de[me];for(ut=Ee;ut!==null;){var ze=ut;switch(ze.tag){case 0:case 11:case 15:mp(8,ze,q)}var Ue=ze.child;if(Ue!==null)Ue.return=ze,ut=Ue;else for(;ut!==null;){ze=ut;var Fe=ze.sibling,at=ze.return;if(Qk(ze),ze===Ee){ut=null;break}if(Fe!==null){Fe.return=at,ut=Fe;break}ut=at}}}var ft=q.alternate;if(ft!==null){var ht=ft.child;if(ht!==null){ft.child=null;do{var xn=ht.sibling;ht.sibling=null,ht=xn}while(ht!==null)}}ut=q}}if((q.subtreeFlags&2064)!==0&&J!==null)J.return=q,ut=J;else e:for(;ut!==null;){if(q=ut,(q.flags&2048)!==0)switch(q.tag){case 0:case 11:case 15:mp(9,q,q.return)}var Se=q.sibling;if(Se!==null){Se.return=q.return,ut=Se;break e}ut=q.return}}var ve=d.current;for(ut=ve;ut!==null;){J=ut;var ke=J.child;if((J.subtreeFlags&2064)!==0&&ke!==null)ke.return=J,ut=ke;else e:for(J=ve;ut!==null;){if(de=ut,(de.flags&2048)!==0)try{switch(de.tag){case 0:case 11:case 15:Pv(9,de)}}catch(pt){nn(de,de.return,pt)}if(de===J){ut=null;break e}var Ke=de.sibling;if(Ke!==null){Ke.return=de.return,ut=Ke;break e}ut=de.return}}if(Qt=B,eo(),Jr&&typeof Jr.onPostCommitFiberRoot=="function")try{Jr.onPostCommitFiberRoot(aa,d)}catch{}j=!0}return j}finally{Yt=S,es.transition=p}}return!1}function hC(d,p,S){p=Qo(S,p),p=Tv(d,p,1),d=Ja(d,p,1),p=Ji(),d!==null&&(oc(d,1,p),pa(d,p))}function nn(d,p,S){if(d.tag===3)hC(d,d,S);else for(;p!==null;){if(p.tag===3){hC(p,d,S);break}else if(p.tag===1){var j=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(iu===null||!iu.has(j))){d=Qo(S,d),d=v(p,d,1),p=Ja(p,d,1),d=Ji(),p!==null&&(oc(p,1,d),pa(p,d));break}}p=p.return}}function P_(d,p,S){var j=d.pingCache;j!==null&&j.delete(p),p=Ji(),d.pingedLanes|=d.suspendedLanes&S,Qn===d&&(yi&S)===S&&(Bn===4||Bn===3&&(yi&130023424)===yi&&500>Dr()-i1?Oc(d,0):n1|=S),pa(d,p)}function pC(d,p){p===0&&((d.mode&1)===0?p=1:(p=ja,ja<<=1,(ja&130023424)===0&&(ja=4194304)));var S=Ji();d=Xi(d,p),d!==null&&(oc(d,p,S),pa(d,S))}function M_(d){var p=d.memoizedState,S=0;p!==null&&(S=p.retryLane),pC(d,S)}function __(d,p){var S=0;switch(d.tag){case 13:var j=d.stateNode,B=d.memoizedState;B!==null&&(S=B.retryLane);break;case 19:j=d.stateNode;break;default:throw Error(r(314))}j!==null&&j.delete(p),pC(d,S)}var mC;mC=function(d,p,S){if(d!==null)if(d.memoizedProps!==p.pendingProps||qn.current)K=!0;else{if((d.lanes&S)===0&&(p.flags&128)===0)return K=!1,Xx(d,p,S);K=(d.flags&131072)!==0}else K=!1,rr&&(p.flags&1048576)!==0&&gv(p,ro,p.index);switch(p.lanes=0,p.tag){case 2:var j=p.type;qt(d,p),d=p.pendingProps;var B=Uo(p,In.current);Es(p,S),B=Yl(null,p,j,d,B,S);var q=Xl();return p.flags|=1,typeof B=="object"&&B!==null&&typeof B.render=="function"&&B.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Wn(j)?(q=!0,Go(p)):q=!1,p.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,Pc(p),B.updater=tu,p.stateNode=B,B._reactInternals=p,xf(p,j,d,S),p=nr(null,p,j,!0,q,S)):(p.tag=0,rr&&q&&Vl(p),ne(null,p,B,S),p=p.child),p;case 16:j=p.elementType;e:{switch(qt(d,p),d=p.pendingProps,B=j._init,j=B(j._payload),p.type=j,B=p.tag=R_(j),d=Ln(j,d),B){case 0:p=rt(null,p,j,d,S);break e;case 1:p=gr(null,p,j,d,S);break e;case 11:p=xe(null,p,j,d,S);break e;case 14:p=je(null,p,j,Ln(j.type,d),S);break e}throw Error(r(306,j,""))}return p;case 0:return j=p.type,B=p.pendingProps,B=p.elementType===j?B:Ln(j,B),rt(d,p,j,B,S);case 1:return j=p.type,B=p.pendingProps,B=p.elementType===j?B:Ln(j,B),gr(d,p,j,B,S);case 3:e:{if(gi(p),d===null)throw Error(r(387));j=p.pendingProps,q=p.memoizedState,B=q.element,cf(d,p),ql(p,j,null,S);var J=p.memoizedState;if(j=J.element,q.isDehydrated)if(q={element:j,isDehydrated:!1,cache:J.cache,pendingSuspenseBoundaries:J.pendingSuspenseBoundaries,transitions:J.transitions},p.updateQueue.baseState=q,p.memoizedState=q,p.flags&256){B=Qo(Error(r(423)),p),p=Za(d,p,j,S,B);break e}else if(j!==B){B=Qo(Error(r(424)),p),p=Za(d,p,j,S,B);break e}else for(Xe=qa(p.stateNode.containerInfo.firstChild),$i=p,rr=!0,Ki=null,S=da(p,null,j,S),p.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if($o(),j===B){p=Xn(d,p,S);break e}ne(d,p,j,S)}p=p.child}return p;case 5:return Wl(p),d===null&&Ul(p),j=p.type,B=p.pendingProps,q=d!==null?d.memoizedProps:null,J=B.children,Zh(j,B)?J=null:q!==null&&Zh(j,q)&&(p.flags|=32),At(d,p),ne(d,p,J,S),p.child;case 6:return d===null&&Ul(p),null;case 13:return Me(d,p,S);case 4:return io(p,p.stateNode.containerInfo),j=p.pendingProps,d===null?p.child=Ko(p,null,j,S):ne(d,p,j,S),p.child;case 11:return j=p.type,B=p.pendingProps,B=p.elementType===j?B:Ln(j,B),xe(d,p,j,B,S);case 7:return ne(d,p,p.pendingProps,S),p.child;case 8:return ne(d,p,p.pendingProps.children,S),p.child;case 12:return ne(d,p,p.pendingProps.children,S),p.child;case 10:e:{if(j=p.type._context,B=p.pendingProps,q=p.memoizedProps,J=B.value,cr(Tc,j._currentValue),j._currentValue=J,q!==null)if(Pi(q.value,J)){if(q.children===B.children&&!qn.current){p=Xn(d,p,S);break e}}else for(q=p.child,q!==null&&(q.return=p);q!==null;){var de=q.dependencies;if(de!==null){J=q.child;for(var me=de.firstContext;me!==null;){if(me.context===j){if(q.tag===1){me=Qa(-1,S&-S),me.tag=2;var Ee=q.updateQueue;if(Ee!==null){Ee=Ee.shared;var ze=Ee.pending;ze===null?me.next=me:(me.next=ze.next,ze.next=me),Ee.pending=me}}q.lanes|=S,me=q.alternate,me!==null&&(me.lanes|=S),uf(q.return,S,p),de.lanes|=S;break}me=me.next}}else if(q.tag===10)J=q.type===p.type?null:q.child;else if(q.tag===18){if(J=q.return,J===null)throw Error(r(341));J.lanes|=S,de=J.alternate,de!==null&&(de.lanes|=S),uf(J,S,p),J=q.sibling}else J=q.child;if(J!==null)J.return=q;else for(J=q;J!==null;){if(J===p){J=null;break}if(q=J.sibling,q!==null){q.return=J.return,J=q;break}J=J.return}q=J}ne(d,p,B.children,S),p=p.child}return p;case 9:return B=p.type,j=p.pendingProps.children,Es(p,S),B=pi(B),j=j(B),p.flags|=1,ne(d,p,j,S),p.child;case 14:return j=p.type,B=Ln(j,p.pendingProps),B=Ln(j.type,B),je(d,p,j,B,S);case 15:return We(d,p,p.type,p.pendingProps,S);case 17:return j=p.type,B=p.pendingProps,B=p.elementType===j?B:Ln(j,B),qt(d,p),p.tag=1,Wn(j)?(d=!0,Go(p)):d=!1,Es(p,S),Ev(p,j,B),xf(p,j,B,S),nr(null,p,j,!0,d,S);case 19:return yn(d,p,S);case 22:return lt(d,p,S)}throw Error(r(156,p.tag))};function gC(d,p){return ic(d,p)}function A_(d,p,S,j){this.tag=d,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ts(d,p,S,j){return new A_(d,p,S,j)}function f1(d){return d=d.prototype,!(!d||!d.isReactComponent)}function R_(d){if(typeof d=="function")return f1(d)?1:0;if(d!=null){if(d=d.$$typeof,d===H)return 11;if(d===O)return 14}return 2}function lu(d,p){var S=d.alternate;return S===null?(S=ts(d.tag,p,d.key,d.mode),S.elementType=d.elementType,S.type=d.type,S.stateNode=d.stateNode,S.alternate=d,d.alternate=S):(S.pendingProps=p,S.type=d.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=d.flags&14680064,S.childLanes=d.childLanes,S.lanes=d.lanes,S.child=d.child,S.memoizedProps=d.memoizedProps,S.memoizedState=d.memoizedState,S.updateQueue=d.updateQueue,p=d.dependencies,S.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},S.sibling=d.sibling,S.index=d.index,S.ref=d.ref,S}function Bv(d,p,S,j,B,q){var J=2;if(j=d,typeof d=="function")f1(d)&&(J=1);else if(typeof d=="string")J=5;else e:switch(d){case A:return Lc(S.children,B,q,p);case I:J=8,B|=8;break;case D:return d=ts(12,S,p,B|2),d.elementType=D,d.lanes=q,d;case M:return d=ts(13,S,p,B),d.elementType=M,d.lanes=q,d;case z:return d=ts(19,S,p,B),d.elementType=z,d.lanes=q,d;case W:return Fv(S,B,q,p);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case L:J=10;break e;case U:J=9;break e;case H:J=11;break e;case O:J=14;break e;case G:J=16,j=null;break e}throw Error(r(130,d==null?d:typeof d,""))}return p=ts(J,S,p,B),p.elementType=d,p.type=j,p.lanes=q,p}function Lc(d,p,S,j){return d=ts(7,d,j,p),d.lanes=S,d}function Fv(d,p,S,j){return d=ts(22,d,j,p),d.elementType=W,d.lanes=S,d.stateNode={isHidden:!1},d}function h1(d,p,S){return d=ts(6,d,null,p),d.lanes=S,d}function p1(d,p,S){return p=ts(4,d.children!==null?d.children:[],d.key,p),p.lanes=S,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function D_(d,p,S,j,B){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zi(0),this.expirationTimes=zi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zi(0),this.identifierPrefix=j,this.onRecoverableError=B,this.mutableSourceEagerHydrationData=null}function m1(d,p,S,j,B,q,J,de,me){return d=new D_(d,p,S,de,me),p===1?(p=1,q===!0&&(p|=8)):p=0,q=ts(3,null,null,p),d.current=q,q.stateNode=d,q.memoizedState={element:j,isDehydrated:S,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pc(q),d}function O_(d,p,S){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_,key:j==null?null:""+j,children:d,containerInfo:p,implementation:S}}function vC(d){if(!d)return $a;d=d._reactInternals;e:{if(oi(d)!==d||d.tag!==1)throw Error(r(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Wn(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(r(171))}if(d.tag===1){var S=d.type;if(Wn(S))return tf(d,S,p)}return p}function yC(d,p,S,j,B,q,J,de,me){return d=m1(S,j,!0,d,B,q,J,de,me),d.context=vC(null),S=d.current,j=Ji(),B=su(S),q=Qa(j,B),q.callback=p??null,Ja(S,q,B),d.current.lanes=B,oc(d,B,j),pa(d,j),d}function zv(d,p,S,j){var B=p.current,q=Ji(),J=su(B);return S=vC(S),p.context===null?p.context=S:p.pendingContext=S,p=Qa(q,J),p.payload={element:d},j=j===void 0?null:j,j!==null&&(p.callback=j),d=Ja(B,p,J),d!==null&&(As(d,B,J,q),df(d,B,J)),J}function Vv(d){return d=d.current,d.child?(d.child.tag===5,d.child.stateNode):null}function xC(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var S=d.retryLane;d.retryLane=S!==0&&S<p?S:p}}function g1(d,p){xC(d,p),(d=d.alternate)&&xC(d,p)}function I_(){return null}var bC=typeof reportError=="function"?reportError:function(d){console.error(d)};function v1(d){this._internalRoot=d}Uv.prototype.render=v1.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(r(409));zv(d,p,null,null)},Uv.prototype.unmount=v1.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;Dc(function(){zv(null,d,null,null)}),p[Wa]=null}};function Uv(d){this._internalRoot=d}Uv.prototype.unstable_scheduleHydration=function(d){if(d){var p=$g();d={blockedOn:null,target:d,priority:p};for(var S=0;S<Ha.length&&p!==0&&p<Ha[S].priority;S++);Ha.splice(S,0,d),S===0&&Md(d)}};function y1(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function Gv(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function wC(){}function L_(d,p,S,j,B){if(B){if(typeof j=="function"){var q=j;j=function(){var Ee=Vv(J);q.call(Ee)}}var J=yC(p,j,d,0,null,!1,!1,"",wC);return d._reactRootContainer=J,d[Wa]=J.current,Lo(d.nodeType===8?d.parentNode:d),Dc(),J}for(;B=d.lastChild;)d.removeChild(B);if(typeof j=="function"){var de=j;j=function(){var Ee=Vv(me);de.call(Ee)}}var me=m1(d,0,!1,null,null,!1,!1,"",wC);return d._reactRootContainer=me,d[Wa]=me.current,Lo(d.nodeType===8?d.parentNode:d),Dc(function(){zv(p,me,S,j)}),me}function Hv(d,p,S,j,B){var q=S._reactRootContainer;if(q){var J=q;if(typeof B=="function"){var de=B;B=function(){var me=Vv(J);de.call(me)}}zv(p,J,d,B)}else J=L_(S,p,d,B,j);return Vv(J)}Cl=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var S=fn(p.pendingLanes);S!==0&&(Mh(p,S|1),pa(p,Dr()),(Qt&6)===0&&(kf=Dr()+500,eo()))}break;case 13:Dc(function(){var j=Xi(d,1);if(j!==null){var B=Ji();As(j,d,1,B)}}),g1(d,1)}},Nl=function(d){if(d.tag===13){var p=Xi(d,134217728);if(p!==null){var S=Ji();As(p,d,134217728,S)}g1(d,134217728)}},Wg=function(d){if(d.tag===13){var p=su(d),S=Xi(d,p);if(S!==null){var j=Ji();As(S,d,p,j)}g1(d,p)}},$g=function(){return Yt},jd=function(d,p){var S=Yt;try{return Yt=d,p()}finally{Yt=S}},Ze=function(d,p,S){switch(p){case"input":if(Ae(d,S),p=S.name,S.type==="radio"&&p!=null){for(S=d;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<S.length;p++){var j=S[p];if(j!==d&&j.form===d.form){var B=Nn(j);if(!B)throw Error(r(90));fe(j),Ae(j,B)}}}break;case"textarea":Ge(d,S);break;case"select":p=S.value,p!=null&&ye(d,!!S.multiple,p,!1)}},jt=u1,Pt=Dc;var B_={usingClientEntryPoint:!1,Events:[kc,mn,Nn,Et,it,u1]},xp={findFiberByHostInstance:Js,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},F_={bundleType:xp.bundleType,version:xp.version,rendererPackageName:xp.rendererPackageName,rendererConfig:xp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=Vs(d),d===null?null:d.stateNode},findFiberByHostInstance:xp.findFiberByHostInstance||I_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var qv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!qv.isDisabled&&qv.supportsFiber)try{aa=qv.inject(F_),Jr=qv}catch{}}return ma.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B_,ma.createPortal=function(d,p){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y1(p))throw Error(r(200));return O_(d,p,null,S)},ma.createRoot=function(d,p){if(!y1(d))throw Error(r(299));var S=!1,j="",B=bC;return p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(j=p.identifierPrefix),p.onRecoverableError!==void 0&&(B=p.onRecoverableError)),p=m1(d,1,!1,null,null,S,!1,j,B),d[Wa]=p.current,Lo(d.nodeType===8?d.parentNode:d),new v1(p)},ma.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render=="function"?Error(r(188)):(d=Object.keys(d).join(","),Error(r(268,d)));return d=Vs(p),d=d===null?null:d.stateNode,d},ma.flushSync=function(d){return Dc(d)},ma.hydrate=function(d,p,S){if(!Gv(p))throw Error(r(200));return Hv(null,d,p,!0,S)},ma.hydrateRoot=function(d,p,S){if(!y1(d))throw Error(r(405));var j=S!=null&&S.hydratedSources||null,B=!1,q="",J=bC;if(S!=null&&(S.unstable_strictMode===!0&&(B=!0),S.identifierPrefix!==void 0&&(q=S.identifierPrefix),S.onRecoverableError!==void 0&&(J=S.onRecoverableError)),p=yC(p,null,d,1,S??null,B,!1,q,J),d[Wa]=p.current,Lo(d),j)for(d=0;d<j.length;d++)S=j[d],B=S._getVersion,B=B(S._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[S,B]:p.mutableSourceEagerHydrationData.push(S,B);return new Uv(p)},ma.render=function(d,p,S){if(!Gv(p))throw Error(r(200));return Hv(null,d,p,!1,S)},ma.unmountComponentAtNode=function(d){if(!Gv(d))throw Error(r(40));return d._reactRootContainer?(Dc(function(){Hv(null,null,d,!1,function(){d._reactRootContainer=null,d[Wa]=null})}),!0):!1},ma.unstable_batchedUpdates=u1,ma.unstable_renderSubtreeIntoContainer=function(d,p,S,j){if(!Gv(S))throw Error(r(200));if(d==null||d._reactInternals===void 0)throw Error(r(38));return Hv(d,p,S,!1,j)},ma.version="18.3.1-next-f1338f8080-20240426",ma}var MC;function $T(){if(MC)return w1.exports;MC=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),w1.exports=$_(),w1.exports}var _C;function K_(){if(_C)return Wv;_C=1;var t=$T();return Wv.createRoot=t.createRoot,Wv.hydrateRoot=t.hydrateRoot,Wv}var Y_=K_();const X_=gh(Y_);var hl=$T();const Q_=gh(hl);function Qm(){return Qm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qm.apply(this,arguments)}var Cu;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Cu||(Cu={}));const AC="popstate";function J_(t){t===void 0&&(t={});function e(n,i){let{pathname:a,search:s,hash:o}=n.location;return o2("",{pathname:a,search:s,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:W0(i)}return eA(e,r,null,t)}function on(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function yS(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Z_(){return Math.random().toString(36).substr(2,8)}function RC(t,e){return{usr:t.state,key:t.key,idx:e}}function o2(t,e,r,n){return r===void 0&&(r=null),Qm({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?yh(e):e,{state:r,key:e&&e.key||n||Z_()})}function W0(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function yh(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function eA(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,s=i.history,o=Cu.Pop,l=null,u=c();u==null&&(u=0,s.replaceState(Qm({},s.state,{idx:u}),""));function c(){return(s.state||{idx:null}).idx}function f(){o=Cu.Pop;let w=c(),N=w==null?null:w-u;u=w,l&&l({action:o,location:b.location,delta:N})}function m(w,N){o=Cu.Push;let k=o2(b.location,w,N);u=c()+1;let C=RC(k,u),E=b.createHref(k);try{s.pushState(C,"",E)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(E)}a&&l&&l({action:o,location:b.location,delta:1})}function g(w,N){o=Cu.Replace;let k=o2(b.location,w,N);u=c();let C=RC(k,u),E=b.createHref(k);s.replaceState(C,"",E),a&&l&&l({action:o,location:b.location,delta:0})}function y(w){let N=i.location.origin!=="null"?i.location.origin:i.location.href,k=typeof w=="string"?w:W0(w);return k=k.replace(/ $/,"%20"),on(N,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,N)}let b={get action(){return o},get location(){return t(i,s)},listen(w){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(AC,f),l=w,()=>{i.removeEventListener(AC,f),l=null}},createHref(w){return e(i,w)},createURL:y,encodeLocation(w){let N=y(w);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:m,replace:g,go(w){return s.go(w)}};return b}var DC;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(DC||(DC={}));function tA(t,e,r){return r===void 0&&(r="/"),rA(t,e,r)}function rA(t,e,r,n){let i=typeof e=="string"?yh(e):e,a=th(i.pathname||"/",r);if(a==null)return null;let s=KT(t);nA(s);let o=null;for(let l=0;o==null&&l<s.length;++l){let u=pA(a);o=fA(s[l],u)}return o}function KT(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,s,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:s,route:a};l.relativePath.startsWith("/")&&(on(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=_u([n,l.relativePath]),c=r.concat(l);a.children&&a.children.length>0&&(on(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),KT(a.children,e,c,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:cA(u,a.index),routesMeta:c})};return t.forEach((a,s)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))i(a,s);else for(let l of YT(a.path))i(a,s,l)}),e}function YT(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let s=YT(n.join("/")),o=[];return o.push(...s.map(l=>l===""?a:[a,l].join("/"))),i&&o.push(...s),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function nA(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:dA(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const iA=/^:[\w-]+$/,aA=3,sA=2,oA=1,lA=10,uA=-2,OC=t=>t==="*";function cA(t,e){let r=t.split("/"),n=r.length;return r.some(OC)&&(n+=uA),e&&(n+=sA),r.filter(i=>!OC(i)).reduce((i,a)=>i+(iA.test(a)?aA:a===""?oA:lA),n)}function dA(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function fA(t,e,r){let{routesMeta:n}=t,i={},a="/",s=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,c=a==="/"?e:e.slice(a.length)||"/",f=l2({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),m=l.route;if(!f)return null;Object.assign(i,f.params),s.push({params:i,pathname:_u([a,f.pathname]),pathnameBase:xA(_u([a,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(a=_u([a,f.pathnameBase]))}return s}function l2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=hA(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((u,c,f)=>{let{paramName:m,isOptional:g}=c;if(m==="*"){let b=o[f]||"";s=a.slice(0,a.length-b.length).replace(/(.)\/+$/,"$1")}const y=o[f];return g&&!y?u[m]=void 0:u[m]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:s,pattern:t}}function hA(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),yS(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function pA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return yS(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function th(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const mA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gA=t=>mA.test(t);function vA(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?yh(t):t,a;if(r)if(gA(r))a=r;else{if(r.includes("//")){let s=r;r=r.replace(/\/\/+/g,"/"),yS(!1,"Pathnames cannot have embedded double slashes - normalizing "+(s+" -> "+r))}r.startsWith("/")?a=IC(r.substring(1),"/"):a=IC(r,e)}else a=e;return{pathname:a,search:bA(n),hash:wA(i)}}function IC(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function C1(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function yA(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function XT(t,e){let r=yA(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function QT(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=yh(t):(i=Qm({},t),on(!i.pathname||!i.pathname.includes("?"),C1("?","pathname","search",i)),on(!i.pathname||!i.pathname.includes("#"),C1("#","pathname","hash",i)),on(!i.search||!i.search.includes("#"),C1("#","search","hash",i)));let a=t===""||i.pathname==="",s=a?"/":i.pathname,o;if(s==null)o=r;else{let f=e.length-1;if(!n&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),f-=1;i.pathname=m.join("/")}o=f>=0?e[f]:"/"}let l=vA(i,o),u=s&&s!=="/"&&s.endsWith("/"),c=(a||s===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const _u=t=>t.join("/").replace(/\/\/+/g,"/"),xA=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),bA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,wA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function SA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const JT=["post","put","patch","delete"];new Set(JT);const kA=["get",...JT];new Set(kA);function Jm(){return Jm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Jm.apply(this,arguments)}const tx=se.createContext(null),ZT=se.createContext(null),Wu=se.createContext(null),rx=se.createContext(null),vl=se.createContext({outlet:null,matches:[],isDataRoute:!1}),e6=se.createContext(null);function CA(t,e){let{relative:r}=e===void 0?{}:e;kg()||on(!1);let{basename:n,navigator:i}=se.useContext(Wu),{hash:a,pathname:s,search:o}=nx(t,{relative:r}),l=s;return n!=="/"&&(l=s==="/"?n:_u([n,s])),i.createHref({pathname:l,search:o,hash:a})}function kg(){return se.useContext(rx)!=null}function wd(){return kg()||on(!1),se.useContext(rx).location}function t6(t){se.useContext(Wu).static||se.useLayoutEffect(t)}function Na(){let{isDataRoute:t}=se.useContext(vl);return t?BA():NA()}function NA(){kg()||on(!1);let t=se.useContext(tx),{basename:e,future:r,navigator:n}=se.useContext(Wu),{matches:i}=se.useContext(vl),{pathname:a}=wd(),s=JSON.stringify(XT(i,r.v7_relativeSplatPath)),o=se.useRef(!1);return t6(()=>{o.current=!0}),se.useCallback(function(u,c){if(c===void 0&&(c={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let f=QT(u,JSON.parse(s),a,c.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:_u([e,f.pathname])),(c.replace?n.replace:n.push)(f,c.state,c)},[e,n,s,a,t])}const r6=se.createContext(null);function $u(){return se.useContext(r6)}function EA(t){let e=se.useContext(vl).outlet;return e&&se.createElement(r6.Provider,{value:t},e)}function Ua(){let{matches:t}=se.useContext(vl),e=t[t.length-1];return e?e.params:{}}function nx(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=se.useContext(Wu),{matches:i}=se.useContext(vl),{pathname:a}=wd(),s=JSON.stringify(XT(i,n.v7_relativeSplatPath));return se.useMemo(()=>QT(t,JSON.parse(s),a,r==="path"),[t,s,a,r])}function TA(t,e){return jA(t,e)}function jA(t,e,r,n){kg()||on(!1);let{navigator:i}=se.useContext(Wu),{matches:a}=se.useContext(vl),s=a[a.length-1],o=s?s.params:{};s&&s.pathname;let l=s?s.pathnameBase:"/";s&&s.route;let u=wd(),c;if(e){var f;let w=typeof e=="string"?yh(e):e;l==="/"||(f=w.pathname)!=null&&f.startsWith(l)||on(!1),c=w}else c=u;let m=c.pathname||"/",g=m;if(l!=="/"){let w=l.replace(/^\//,"").split("/");g="/"+m.replace(/^\//,"").split("/").slice(w.length).join("/")}let y=tA(t,{pathname:g}),b=RA(y&&y.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:_u([l,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:_u([l,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return e&&b?se.createElement(rx.Provider,{value:{location:Jm({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Cu.Pop}},b):b}function PA(){let t=LA(),e=SA(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return se.createElement(se.Fragment,null,se.createElement("h2",null,"Unexpected Application Error!"),se.createElement("h3",{style:{fontStyle:"italic"}},e),r?se.createElement("pre",{style:i},r):null,null)}const MA=se.createElement(PA,null);class _A extends se.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?se.createElement(vl.Provider,{value:this.props.routeContext},se.createElement(e6.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function AA(t){let{routeContext:e,match:r,children:n}=t,i=se.useContext(tx);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),se.createElement(vl.Provider,{value:e},n)}function RA(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,o=(i=r)==null?void 0:i.errors;if(o!=null){let c=s.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);c>=0||on(!1),s=s.slice(0,Math.min(s.length,c+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let c=0;c<s.length;c++){let f=s[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=c),f.route.id){let{loaderData:m,errors:g}=r,y=f.route.loader&&m[f.route.id]===void 0&&(!g||g[f.route.id]===void 0);if(f.route.lazy||y){l=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}return s.reduceRight((c,f,m)=>{let g,y=!1,b=null,w=null;r&&(g=o&&f.route.id?o[f.route.id]:void 0,b=f.route.errorElement||MA,l&&(u<0&&m===0?(FA("route-fallback"),y=!0,w=null):u===m&&(y=!0,w=f.route.hydrateFallbackElement||null)));let N=e.concat(s.slice(0,m+1)),k=()=>{let C;return g?C=b:y?C=w:f.route.Component?C=se.createElement(f.route.Component,null):f.route.element?C=f.route.element:C=c,se.createElement(AA,{match:f,routeContext:{outlet:c,matches:N,isDataRoute:r!=null},children:C})};return r&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?se.createElement(_A,{location:r.location,revalidation:r.revalidation,component:b,error:g,children:k(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):k()},null)}var n6=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(n6||{}),i6=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(i6||{});function DA(t){let e=se.useContext(tx);return e||on(!1),e}function OA(t){let e=se.useContext(ZT);return e||on(!1),e}function IA(t){let e=se.useContext(vl);return e||on(!1),e}function a6(t){let e=IA(),r=e.matches[e.matches.length-1];return r.route.id||on(!1),r.route.id}function LA(){var t;let e=se.useContext(e6),r=OA(),n=a6();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function BA(){let{router:t}=DA(n6.UseNavigateStable),e=a6(i6.UseNavigateStable),r=se.useRef(!1);return t6(()=>{r.current=!0}),se.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Jm({fromRouteId:e},a)))},[t,e])}const LC={};function FA(t,e,r){LC[t]||(LC[t]=!0)}function zA(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function xS(t){return EA(t.context)}function Xr(t){on(!1)}function VA(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Cu.Pop,navigator:a,static:s=!1,future:o}=t;kg()&&on(!1);let l=e.replace(/^\/*/,"/"),u=se.useMemo(()=>({basename:l,navigator:a,static:s,future:Jm({v7_relativeSplatPath:!1},o)}),[l,o,a,s]);typeof n=="string"&&(n=yh(n));let{pathname:c="/",search:f="",hash:m="",state:g=null,key:y="default"}=n,b=se.useMemo(()=>{let w=th(c,l);return w==null?null:{location:{pathname:w,search:f,hash:m,state:g,key:y},navigationType:i}},[l,c,f,m,g,y,i]);return b==null?null:se.createElement(Wu.Provider,{value:u},se.createElement(rx.Provider,{children:r,value:b}))}function UA(t){let{children:e,location:r}=t;return TA(u2(e),r)}new Promise(()=>{});function u2(t,e){e===void 0&&(e=[]);let r=[];return se.Children.forEach(t,(n,i)=>{if(!se.isValidElement(n))return;let a=[...e,i];if(n.type===se.Fragment){r.push.apply(r,u2(n.props.children,a));return}n.type!==Xr&&on(!1),!n.props.index||!n.props.children||on(!1);let s={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=u2(n.props.children,a)),r.push(s)}),r}function $0(){return $0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},$0.apply(this,arguments)}function s6(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function GA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function HA(t,e){return t.button===0&&(!e||e==="_self")&&!GA(t)}const qA=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],WA=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],$A="6";try{window.__reactRouterVersion=$A}catch{}const KA=se.createContext({isTransitioning:!1}),YA="startTransition",BC=q_[YA];function XA(t){let{basename:e,children:r,future:n,window:i}=t,a=se.useRef();a.current==null&&(a.current=J_({window:i,v5Compat:!0}));let s=a.current,[o,l]=se.useState({action:s.action,location:s.location}),{v7_startTransition:u}=n||{},c=se.useCallback(f=>{u&&BC?BC(()=>l(f)):l(f)},[l,u]);return se.useLayoutEffect(()=>s.listen(c),[s,c]),se.useEffect(()=>zA(n),[n]),se.createElement(VA,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:s,future:n})}const QA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",JA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ld=se.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:a,replace:s,state:o,target:l,to:u,preventScrollReset:c,viewTransition:f}=e,m=s6(e,qA),{basename:g}=se.useContext(Wu),y,b=!1;if(typeof u=="string"&&JA.test(u)&&(y=u,QA))try{let C=new URL(window.location.href),E=u.startsWith("//")?new URL(C.protocol+u):new URL(u),P=th(E.pathname,g);E.origin===C.origin&&P!=null?u=P+E.search+E.hash:b=!0}catch{}let w=CA(u,{relative:i}),N=tR(u,{replace:s,state:o,target:l,preventScrollReset:c,relative:i,viewTransition:f});function k(C){n&&n(C),C.defaultPrevented||N(C)}return se.createElement("a",$0({},m,{href:y||w,onClick:b||a?n:k,ref:r,target:l}))}),ZA=se.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:a="",end:s=!1,style:o,to:l,viewTransition:u,children:c}=e,f=s6(e,WA),m=nx(l,{relative:f.relative}),g=wd(),y=se.useContext(ZT),{navigator:b,basename:w}=se.useContext(Wu),N=y!=null&&rR(m)&&u===!0,k=b.encodeLocation?b.encodeLocation(m).pathname:m.pathname,C=g.pathname,E=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;i||(C=C.toLowerCase(),E=E?E.toLowerCase():null,k=k.toLowerCase()),E&&w&&(E=th(E,w)||E);const P=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let _=C===k||!s&&C.startsWith(k)&&C.charAt(P)==="/",A=E!=null&&(E===k||!s&&E.startsWith(k)&&E.charAt(k.length)==="/"),I={isActive:_,isPending:A,isTransitioning:N},D=_?n:void 0,L;typeof a=="function"?L=a(I):L=[a,_?"active":null,A?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let U=typeof o=="function"?o(I):o;return se.createElement(ld,$0({},f,{"aria-current":D,className:L,ref:r,style:U,to:l,viewTransition:u}),typeof c=="function"?c(I):c)});var c2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(c2||(c2={}));var FC;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(FC||(FC={}));function eR(t){let e=se.useContext(tx);return e||on(!1),e}function tR(t,e){let{target:r,replace:n,state:i,preventScrollReset:a,relative:s,viewTransition:o}=e===void 0?{}:e,l=Na(),u=wd(),c=nx(t,{relative:s});return se.useCallback(f=>{if(HA(f,r)){f.preventDefault();let m=n!==void 0?n:W0(u)===W0(c);l(t,{replace:m,state:i,preventScrollReset:a,relative:s,viewTransition:o})}},[u,l,c,n,i,r,t,a,s,o])}function rR(t,e){e===void 0&&(e={});let r=se.useContext(KA);r==null&&on(!1);let{basename:n}=eR(c2.useViewTransitionState),i=nx(t,{relative:e.relative});if(!r.isTransitioning)return!1;let a=th(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=th(r.nextLocation.pathname,n)||r.nextLocation.pathname;return l2(i.pathname,s)!=null||l2(i.pathname,a)!=null}const bS="-",nR=t=>{const e=aR(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const o=s.split(bS);return o[0]===""&&o.length!==1&&o.shift(),o6(o,e)||iR(s)},getConflictingClassGroupIds:(s,o)=>{const l=r[s]||[];return o&&n[s]?[...l,...n[s]]:l}}},o6=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?o6(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(bS);return e.validators.find(({validator:s})=>s(a))?.classGroupId},zC=/^\[(.+)\]$/,iR=t=>{if(zC.test(t)){const e=zC.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},aR=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return oR(Object.entries(t.classGroups),r).forEach(([a,s])=>{d2(s,n,a,e)}),n},d2=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:VC(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(sR(i)){d2(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{d2(s,VC(e,a),r,n)})})},VC=(t,e)=>{let r=t;return e.split(bS).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},sR=t=>t.isThemeGetter,oR=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,o])=>[e+s,o])):a);return[r,i]}):t,lR=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},l6="!",uR=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,s=o=>{const l=[];let u=0,c=0,f;for(let w=0;w<o.length;w++){let N=o[w];if(u===0){if(N===i&&(n||o.slice(w,w+a)===e)){l.push(o.slice(c,w)),c=w+a;continue}if(N==="/"){f=w;continue}}N==="["?u++:N==="]"&&u--}const m=l.length===0?o:o.substring(c),g=m.startsWith(l6),y=g?m.substring(1):m,b=f&&f>c?f-c:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:y,maybePostfixModifierPosition:b}};return r?o=>r({className:o,parseClassName:s}):s},cR=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},dR=t=>({cache:lR(t.cacheSize),parseClassName:uR(t),...nR(t)}),fR=/\s+/,hR=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],s=t.trim().split(fR);let o="";for(let l=s.length-1;l>=0;l-=1){const u=s[l],{modifiers:c,hasImportantModifier:f,baseClassName:m,maybePostfixModifierPosition:g}=r(u);let y=!!g,b=n(y?m.substring(0,g):m);if(!b){if(!y){o=u+(o.length>0?" "+o:o);continue}if(b=n(m),!b){o=u+(o.length>0?" "+o:o);continue}y=!1}const w=cR(c).join(":"),N=f?w+l6:w,k=N+b;if(a.includes(k))continue;a.push(k);const C=i(b,y);for(let E=0;E<C.length;++E){const P=C[E];a.push(N+P)}o=u+(o.length>0?" "+o:o)}return o};function pR(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=u6(e))&&(n&&(n+=" "),n+=r);return n}const u6=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=u6(t[n]))&&(r&&(r+=" "),r+=e);return r};function mR(t,...e){let r,n,i,a=s;function s(l){const u=e.reduce((c,f)=>f(c),t());return r=dR(u),n=r.cache.get,i=r.cache.set,a=o,o(l)}function o(l){const u=n(l);if(u)return u;const c=hR(l,r);return i(l,c),c}return function(){return a(pR.apply(null,arguments))}}const Ir=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},c6=/^\[(?:([a-z-]+):)?(.+)\]$/i,gR=/^\d+\/\d+$/,vR=new Set(["px","full","screen"]),yR=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,xR=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,bR=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,wR=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,SR=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Zo=t=>Kf(t)||vR.has(t)||gR.test(t),cu=t=>xh(t,"length",MR),Kf=t=>!!t&&!Number.isNaN(Number(t)),N1=t=>xh(t,"number",Kf),wp=t=>!!t&&Number.isInteger(Number(t)),kR=t=>t.endsWith("%")&&Kf(t.slice(0,-1)),Lt=t=>c6.test(t),du=t=>yR.test(t),CR=new Set(["length","size","percentage"]),NR=t=>xh(t,CR,d6),ER=t=>xh(t,"position",d6),TR=new Set(["image","url"]),jR=t=>xh(t,TR,AR),PR=t=>xh(t,"",_R),Sp=()=>!0,xh=(t,e,r)=>{const n=c6.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},MR=t=>xR.test(t)&&!bR.test(t),d6=()=>!1,_R=t=>wR.test(t),AR=t=>SR.test(t),RR=()=>{const t=Ir("colors"),e=Ir("spacing"),r=Ir("blur"),n=Ir("brightness"),i=Ir("borderColor"),a=Ir("borderRadius"),s=Ir("borderSpacing"),o=Ir("borderWidth"),l=Ir("contrast"),u=Ir("grayscale"),c=Ir("hueRotate"),f=Ir("invert"),m=Ir("gap"),g=Ir("gradientColorStops"),y=Ir("gradientColorStopPositions"),b=Ir("inset"),w=Ir("margin"),N=Ir("opacity"),k=Ir("padding"),C=Ir("saturate"),E=Ir("scale"),P=Ir("sepia"),_=Ir("skew"),A=Ir("space"),I=Ir("translate"),D=()=>["auto","contain","none"],L=()=>["auto","hidden","clip","visible","scroll"],U=()=>["auto",Lt,e],H=()=>[Lt,e],M=()=>["",Zo,cu],z=()=>["auto",Kf,Lt],O=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],G=()=>["solid","dashed","dotted","double","none"],W=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],$=()=>["start","end","center","between","around","evenly","stretch"],X=()=>["","0",Lt],Q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],V=()=>[Kf,Lt];return{cacheSize:500,separator:":",theme:{colors:[Sp],spacing:[Zo,cu],blur:["none","",du,Lt],brightness:V(),borderColor:[t],borderRadius:["none","","full",du,Lt],borderSpacing:H(),borderWidth:M(),contrast:V(),grayscale:X(),hueRotate:V(),invert:X(),gap:H(),gradientColorStops:[t],gradientColorStopPositions:[kR,cu],inset:U(),margin:U(),opacity:V(),padding:H(),saturate:V(),scale:V(),sepia:X(),skew:V(),space:H(),translate:H()},classGroups:{aspect:[{aspect:["auto","square","video",Lt]}],container:["container"],columns:[{columns:[du]}],"break-after":[{"break-after":Q()}],"break-before":[{"break-before":Q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...O(),Lt]}],overflow:[{overflow:L()}],"overflow-x":[{"overflow-x":L()}],"overflow-y":[{"overflow-y":L()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",wp,Lt]}],basis:[{basis:U()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Lt]}],grow:[{grow:X()}],shrink:[{shrink:X()}],order:[{order:["first","last","none",wp,Lt]}],"grid-cols":[{"grid-cols":[Sp]}],"col-start-end":[{col:["auto",{span:["full",wp,Lt]},Lt]}],"col-start":[{"col-start":z()}],"col-end":[{"col-end":z()}],"grid-rows":[{"grid-rows":[Sp]}],"row-start-end":[{row:["auto",{span:[wp,Lt]},Lt]}],"row-start":[{"row-start":z()}],"row-end":[{"row-end":z()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Lt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Lt]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...$()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...$(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...$(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[A]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[A]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Lt,e]}],"min-w":[{"min-w":[Lt,e,"min","max","fit"]}],"max-w":[{"max-w":[Lt,e,"none","full","min","max","fit","prose",{screen:[du]},du]}],h:[{h:[Lt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Lt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Lt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Lt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",du,cu]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",N1]}],"font-family":[{font:[Sp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Lt]}],"line-clamp":[{"line-clamp":["none",Kf,N1]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Zo,Lt]}],"list-image":[{"list-image":["none",Lt]}],"list-style-type":[{list:["none","disc","decimal",Lt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[N]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[N]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Zo,cu]}],"underline-offset":[{"underline-offset":["auto",Zo,Lt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:H()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Lt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Lt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[N]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...O(),ER]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",NR]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},jR]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[g]}],"gradient-via":[{via:[g]}],"gradient-to":[{to:[g]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[N]}],"border-style":[{border:[...G(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[N]}],"divide-style":[{divide:G()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...G()]}],"outline-offset":[{"outline-offset":[Zo,Lt]}],"outline-w":[{outline:[Zo,cu]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[N]}],"ring-offset-w":[{"ring-offset":[Zo,cu]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",du,PR]}],"shadow-color":[{shadow:[Sp]}],opacity:[{opacity:[N]}],"mix-blend":[{"mix-blend":[...W(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":W()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",du,Lt]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[f]}],saturate:[{saturate:[C]}],sepia:[{sepia:[P]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[N]}],"backdrop-saturate":[{"backdrop-saturate":[C]}],"backdrop-sepia":[{"backdrop-sepia":[P]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Lt]}],duration:[{duration:V()}],ease:[{ease:["linear","in","out","in-out",Lt]}],delay:[{delay:V()}],animate:[{animate:["none","spin","ping","pulse","bounce",Lt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[E]}],"scale-x":[{"scale-x":[E]}],"scale-y":[{"scale-y":[E]}],rotate:[{rotate:[wp,Lt]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[_]}],"skew-y":[{"skew-y":[_]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Lt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Lt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":H()}],"scroll-mx":[{"scroll-mx":H()}],"scroll-my":[{"scroll-my":H()}],"scroll-ms":[{"scroll-ms":H()}],"scroll-me":[{"scroll-me":H()}],"scroll-mt":[{"scroll-mt":H()}],"scroll-mr":[{"scroll-mr":H()}],"scroll-mb":[{"scroll-mb":H()}],"scroll-ml":[{"scroll-ml":H()}],"scroll-p":[{"scroll-p":H()}],"scroll-px":[{"scroll-px":H()}],"scroll-py":[{"scroll-py":H()}],"scroll-ps":[{"scroll-ps":H()}],"scroll-pe":[{"scroll-pe":H()}],"scroll-pt":[{"scroll-pt":H()}],"scroll-pr":[{"scroll-pr":H()}],"scroll-pb":[{"scroll-pb":H()}],"scroll-pl":[{"scroll-pl":H()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Lt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Zo,cu,N1]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},wS=mR(RR),ir=({children:t,className:e,...r})=>h.jsx("div",{className:wS("bg-glass backdrop-blur-xl border border-glass-border rounded-xl",e),...r,children:t}),K0=({url:t,name:e,alt:r="User",size:n="md",className:i})=>{const a={sm:"size-8 text-xs",md:"size-10 text-sm",lg:"size-16 text-lg",xl:"size-32 text-2xl"},s=e?e.charAt(0).toUpperCase():r?r.charAt(0).toUpperCase():"?";return h.jsx("div",{className:wS("rounded-full bg-surface-light border border-white/10 flex items-center justify-center overflow-hidden shrink-0 text-slate-400 font-bold select-none",a[n],i),children:t?h.jsx("img",{src:t,alt:e||r,className:"w-full h-full object-cover"}):h.jsx("span",{children:s})})},DR=()=>h.jsx("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark relative",children:h.jsx("main",{className:"flex-1 min-w-0 relative overflow-hidden flex flex-col",children:h.jsx(xS,{})})}),OR="/api",$e={async request(t,e={}){const r=`${OR}${t}`,n={"Content-Type":"application/json",...e.headers},i=await fetch(r,{...e,headers:n,credentials:"include"});if(!i.ok){const a=await i.json().catch(()=>({}));throw new Error(a.error||`HTTP error! status: ${i.status}`)}return i.status===204||i.headers.get("content-length")==="0"?null:i.json()},get(t,e={}){return this.request(t,{method:"GET",headers:e})},post(t,e,r={}){return this.request(t,{method:"POST",body:JSON.stringify(e),headers:r})},put(t,e,r={}){return this.request(t,{method:"PUT",body:JSON.stringify(e),headers:r})},patch(t,e,r={}){return this.request(t,{method:"PATCH",body:JSON.stringify(e),headers:r})},delete(t,e={}){return this.request(t,{method:"DELETE",headers:e})}},kp={list:()=>$e.get("/workspaces"),create:(t,e,r,n)=>$e.post("/workspaces",{name:t,title:e,genre:r,imageUrl:n}),delete:t=>$e.delete("/workspaces/"+t),update:(t,e)=>$e.put("/workspaces/"+t,e),select:t=>$e.post("/workspaces/select",{projectName:t})},IR=["FANTASA","SCI-FI","HORROR","LORE","MISTERIO","HISTRICO","CYBERPUNK","STEAMPUNK"],LR=({isOpen:t,onClose:e,onCreate:r})=>{if(!t)return null;const[n,i]=se.useState(!1),[a,s]=se.useState({name:"",title:"",genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"}),o=u=>{const{name:c,value:f}=u.target;s(m=>({...m,[c]:f}))},l=u=>{u.preventDefault();let c=a.name;if(!c&&a.title&&(c=a.title.toLowerCase().replace(/[^a-z0-9]/g,"-")),!c){alert("Project ID/Name is required");return}r({...a,name:c}),e(),s({name:"",title:"",genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"})};return hl.createPortal(h.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[h.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),h.jsxs("div",{className:"relative w-full max-w-2xl bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex animate-in zoom-in-95 duration-200",children:[h.jsxs("div",{className:"w-1/3 bg-black relative hidden sm:block",children:[h.jsx("img",{src:a.imageUrl,onError:()=>i(!0),className:`absolute inset-0 w-full h-full object-cover opacity-60 transition-opacity duration-500 ${n?"hidden":""}`,alt:"Preview"}),h.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-6 bg-gradient-to-t from-black to-transparent",children:[h.jsx("h4",{className:"text-white font-black text-xl leading-none",children:a.title||"Untitled"}),h.jsx("span",{className:"text-[10px] font-bold text-primary uppercase tracking-widest mt-2 block",children:a.genre})]})]}),h.jsxs("div",{className:"flex-1 p-8",children:[h.jsx("h2",{className:"text-2xl font-black text-white mb-6",children:"Nuevo Cuaderno"}),h.jsxs("form",{onSubmit:l,className:"space-y-5",children:[h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Ttulo del Proyecto"}),h.jsx("input",{type:"text",name:"title",value:a.title,onChange:o,placeholder:"e.g. Las Crnicas de Etheria",className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all",autoFocus:!0})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"ID de Archivo (Slug)"}),h.jsx("input",{type:"text",name:"name",value:a.name,onChange:o,placeholder:"e.g. etheria-v1",className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white font-mono text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all placeholder:text-white/10"}),h.jsx("p",{className:"text-[10px] text-white/20",children:"Se usar como nombre del archivo .db"})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Gnero"}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:IR.slice(0,4).map(u=>h.jsx("button",{type:"button",onClick:()=>s(c=>({...c,genre:u})),className:`px-3 py-2 rounded-lg text-[10px] font-bold border transition-all ${a.genre===u?"bg-primary text-white border-primary":"bg-[#13141f] border-white/10 text-text-muted hover:border-white/20"}`,children:u},u))})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Imagen de Portada (URL)"}),h.jsx("input",{type:"text",name:"imageUrl",value:a.imageUrl,onChange:u=>{s(c=>({...c,imageUrl:u.target.value})),i(!1)},className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all truncate"})]}),h.jsxs("div",{className:"pt-4 flex gap-3",children:[h.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-[#13141f] hover:bg-white/5 border border-white/10 rounded-xl text-xs font-bold text-text-muted transition-all",children:"Cancelar"}),h.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold transition-all shadow-lg shadow-primary/20 flex items-center justify-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"rocket_launch"}),"Crear Universo"]})]})]})]})]})]}),document.body)},BR=["FANTASA","SCI-FI","HORROR","LORE","MISTERIO","HISTRICO","CYBERPUNK","STEAMPUNK"],FR=({isOpen:t,onClose:e,onUpdate:r,project:n})=>{if(!t||!n)return null;const[i,a]=se.useState(!1),[s,o]=se.useState({name:n,title:n,genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"});se.useEffect(()=>{n&&o(u=>({...u,name:n,title:n}))},[n]);const l=u=>{u.preventDefault(),r(s.name,{title:s.title,genre:s.genre,imageUrl:s.imageUrl}),e()};return hl.createPortal(h.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[h.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),h.jsxs("div",{className:"relative w-full max-w-2xl bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex animate-in zoom-in-95 duration-200",children:[h.jsxs("div",{className:"w-1/3 bg-black relative hidden sm:block",children:[h.jsx("img",{src:s.imageUrl,onError:()=>a(!0),className:`absolute inset-0 w-full h-full object-cover opacity-60 transition-opacity duration-500 ${i?"hidden":""}`,alt:"Preview"}),h.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-6 bg-gradient-to-t from-black to-transparent",children:[h.jsx("h4",{className:"text-white font-black text-xl leading-none",children:s.title||"Untitled"}),h.jsx("span",{className:"text-[10px] font-bold text-primary uppercase tracking-widest mt-2 block",children:s.genre})]})]}),h.jsxs("div",{className:"flex-1 p-8",children:[h.jsx("h2",{className:"text-2xl font-black text-white mb-6",children:"Editar Cuaderno"}),h.jsxs("form",{onSubmit:l,className:"space-y-5",children:[h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Ttulo del Proyecto"}),h.jsx("input",{type:"text",name:"title",value:s.title,onChange:u=>o(c=>({...c,title:u.target.value})),className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all",autoFocus:!0})]}),h.jsxs("div",{className:"space-y-1.5 opacity-50",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"ID de Archivo (Inmutable)"}),h.jsx("input",{type:"text",value:s.name,readOnly:!0,className:"w-full bg-[#0a0a0c] border border-white/5 rounded-xl px-4 py-3 text-white/50 font-mono text-xs outline-none cursor-not-allowed"})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Gnero"}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:BR.slice(0,4).map(u=>h.jsx("button",{type:"button",onClick:()=>o(c=>({...c,genre:u})),className:`px-3 py-2 rounded-lg text-[10px] font-bold border transition-all ${s.genre===u?"bg-primary text-white border-primary":"bg-[#13141f] border-white/10 text-text-muted hover:border-white/20"}`,children:u},u))})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Imagen de Portada (URL)"}),h.jsx("input",{type:"text",value:s.imageUrl,onChange:u=>{o(c=>({...c,imageUrl:u.target.value})),a(!1)},className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all truncate"})]}),h.jsxs("div",{className:"pt-4 flex gap-3",children:[h.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-[#13141f] hover:bg-white/5 border border-white/10 rounded-xl text-xs font-bold text-text-muted transition-all",children:"Cancelar"}),h.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold transition-all shadow-lg shadow-primary/20 flex items-center justify-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar Cambios"]})]})]})]})]})]}),document.body)},yr=se.forwardRef(({children:t,variant:e="primary",size:r="md",className:n,icon:i,isLoading:a,...s},o)=>{const l="inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed active:scale-95",u={primary:"bg-primary text-white shadow-lg shadow-primary/25 hover:bg-primary-light hover:shadow-primary/40 border border-transparent",secondary:"bg-surface-light text-slate-200 border border-white/10 hover:bg-white/5 hover:text-white hover:border-white/20",ghost:"bg-transparent text-slate-400 hover:text-white hover:bg-white/5",danger:"bg-red-500/10 text-red-500 border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/50 hover:shadow-lg hover:shadow-red-500/10",outline:"bg-transparent border border-primary/50 text-primary hover:bg-primary/10"},c={xs:"px-2.5 py-1 text-xs gap-1.5",sm:"px-3 py-1.5 text-xs gap-1.5",md:"px-4 py-2 text-sm gap-2",lg:"px-6 py-3 text-base gap-3",icon:"size-9 p-0"};return h.jsxs("button",{ref:o,className:wS(l,u[e],c[r],n),disabled:a,...s,children:[a?h.jsx("span",{className:"material-symbols-outlined animate-spin text-[18px]",children:"progress_activity"}):i?h.jsx("span",{className:"material-symbols-outlined text-[18px]",children:i}):null,t]})});yr.displayName="Button";const f6=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirm",cancelText:s="Cancel",isDestructive:o=!0})=>t?h.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[h.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",onClick:e}),h.jsx("div",{className:"relative z-10 w-full max-w-md animate-in zoom-in-95 duration-300",children:h.jsxs(ir,{className:"p-6 border-red-500/20 shadow-2xl shadow-black/50",children:[h.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[h.jsx("div",{className:`
                            size-12 rounded-xl flex items-center justify-center shrink-0
                            ${o?"bg-red-500/10 text-red-500":"bg-primary/10 text-primary"}
                        `,children:h.jsx("span",{className:"material-symbols-outlined text-2xl",children:o?"warning":"help"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-black text-white mb-2 leading-tight",children:n}),h.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:i})]})]}),h.jsxs("div",{className:"flex items-center justify-end gap-3",children:[h.jsx(yr,{variant:"ghost",onClick:e,children:s}),h.jsx(yr,{variant:o?"danger":"primary",onClick:()=>{r(),e()},icon:o?"delete":"check",children:a})]})]})})]}):null,zR=()=>{const t=Na(),[e,r]=se.useState([]),[n,i]=se.useState(!0),[a,s]=se.useState(null),[o,l]=se.useState(""),[u,c]=se.useState(!1),[f,m]=se.useState(null),[g,y]=se.useState(null);se.useEffect(()=>{b()},[]);const b=async()=>{try{i(!0);const P=await kp.list();r(P)}catch(P){console.error("Failed to load workspaces",P),s("Error al cargar cuadernos. Est el servidor encendido?")}finally{i(!1)}},w=async P=>{try{i(!0);const _=await kp.select(P);_.success&&_.redirect&&(localStorage.setItem("user",JSON.stringify({username:"local",success:!0})),t(_.redirect))}catch(_){s(_.message||"Fallo al entrar al cuaderno"),i(!1)}},N=async P=>{try{i(!0),(await kp.create(P.name,P.title,P.genre,P.imageUrl)).success&&await w(P.name)}catch{s("Error al crear cuaderno"),i(!1)}},k=async()=>{if(f)try{i(!0),await kp.delete(f),await b(),m(null)}catch{s("Error al borrar el cuaderno"),i(!1)}},C=async(P,_)=>{try{i(!0),await kp.update(P,_),await b(),y(null)}catch{s("Error al actualizar cuaderno"),i(!1)}},E=e.filter(P=>(P.title||P.filename||"").toLowerCase().includes(o.toLowerCase()));return h.jsxs("div",{className:"h-screen w-full bg-[#0a0b14] text-white flex flex-col items-center font-sans selection:bg-indigo-500/30 overflow-hidden",children:[h.jsxs("div",{className:"w-full max-w-6xl flex-1 flex flex-col overflow-y-auto custom-scrollbar p-8",children:[h.jsxs("header",{className:"w-full mt-24 mb-12 flex flex-col lg:flex-row lg:items-end justify-between gap-8 flex-shrink-0",children:[h.jsx("div",{className:"space-y-4",children:h.jsx("div",{className:"flex items-center gap-4",children:h.jsxs("h1",{className:"text-6xl font-black tracking-tighter leading-none",children:[h.jsx("span",{className:"block text-indigo-400",children:"Mis"}),h.jsx("span",{className:"block text-white",children:"Cuadernos"})]})})}),h.jsx("div",{className:"flex items-center gap-4",children:h.jsxs("div",{className:"relative group min-w-[300px]",children:[h.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-white/20 text-xl group-focus-within:text-indigo-400 transition-colors pointer-events-none",children:"search"}),h.jsx("input",{type:"text",placeholder:"Buscar...",value:o,onChange:P=>l(P.target.value),className:"w-full bg-[#13141f] border border-white/5 rounded-2xl py-3 pl-12 pr-4 text-sm text-white focus:outline-none focus:border-indigo-500/50 transition-all placeholder:text-white/10"})]})})]}),h.jsx("section",{className:"w-full max-w-6xl",children:n?h.jsxs("div",{className:"flex flex-col items-center gap-6 py-20 opacity-20",children:[h.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),h.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:"Accediendo al Sector Local..."})]}):h.jsxs("div",{className:"flex flex-wrap gap-6 justify-start pb-20",children:[h.jsxs("div",{onClick:()=>c(!0),className:"group relative h-[380px] rounded-[2.5rem] border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-6 hover:bg-white/5 hover:border-indigo-500/30 transition-all cursor-pointer overflow-hidden animate-in fade-in duration-700 w-full md:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)]",children:[h.jsx("div",{className:"w-20 h-20 rounded-full bg-[#13141f] border border-white/5 flex items-center justify-center text-4xl text-white/20 group-hover:scale-110 group-hover:text-indigo-400 transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-4xl",children:"add"})}),h.jsxs("div",{className:"text-center",children:[h.jsx("h3",{className:"text-xl font-black tracking-tight text-white/50 group-hover:text-white transition-colors",children:"Nuevo Cuaderno"}),h.jsx("p",{className:"text-[10px] font-bold text-white/20 uppercase tracking-widest mt-2 group-hover:text-white/40",children:"Inicia un nuevo universo"})]})]}),E.map(P=>{const _=P.imageUrl||"https://images.unsplash.com/photo-1451187580459-43490279c0fa?auto=format&fit=crop&q=80&w=800";return h.jsxs("div",{onClick:()=>w(P.filename),className:"group relative h-[380px] rounded-[2.5rem] bg-[#13141f] border border-white/5 overflow-hidden transition-all hover:-translate-y-2 hover:shadow-2xl hover:shadow-indigo-500/10 cursor-pointer animate-in fade-in slide-in-from-bottom-4 w-full md:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)]",children:[h.jsxs("div",{className:"absolute inset-x-0 top-0 h-2/3",children:[h.jsx("img",{src:_,className:"w-full h-full object-cover opacity-40 group-hover:opacity-60 transition-opacity",alt:""}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#13141f] via-transparent to-transparent"})]}),h.jsxs("div",{className:"absolute top-6 right-6 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20",children:[h.jsx("button",{onClick:A=>{A.stopPropagation(),y(P.filename)},className:"w-10 h-10 rounded-full bg-black/50 backdrop-blur-md border border-white/10 flex items-center justify-center text-white/70 hover:text-white hover:bg-indigo-500 hover:border-indigo-400 transition-all",title:"Editar",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),h.jsx("button",{onClick:A=>{A.stopPropagation(),m(P.filename)},className:"w-10 h-10 rounded-full bg-black/50 backdrop-blur-md border border-white/10 flex items-center justify-center text-white/70 hover:text-white hover:bg-red-500 hover:border-red-400 transition-all",title:"Eliminar",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),h.jsx("div",{className:"absolute inset-0 flex flex-col justify-end p-8",children:h.jsxs("div",{className:"mt-auto space-y-3",children:[h.jsx("span",{className:"inline-block px-3 py-1 bg-red-500/20 border border-red-500/30 text-[9px] font-black text-red-100 rounded-lg tracking-widest uppercase",children:P.tag}),h.jsx("h3",{className:"text-3xl font-black text-white tracking-tighter leading-tight group-hover:text-indigo-400 transition-colors",children:P.title}),P.title!==P.filename&&h.jsx("p",{className:"text-[10px] text-white/30 font-mono mb-1",children:P.filename}),h.jsx("p",{className:"text-xs text-white/40 line-clamp-2 leading-relaxed",children:"Una tierra dividida por la magia y la tecnologa antigua..."}),h.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-white/5 mt-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]"}),h.jsxs("span",{className:"text-[9px] font-black uppercase tracking-widest text-white/20",children:["ltima edicin: ",h.jsx("span",{className:"text-white/40",children:P.lastModified})]})]}),h.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-[10px] font-black text-indigo-300",children:P.initials})]})]})})]},P.filename)})]})})]}),a&&h.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 px-6 py-3 bg-red-500/20 border border-red-500/30 text-red-200 rounded-2xl text-xs font-bold shadow-2xl animate-bounce",children:a}),h.jsx(LR,{isOpen:u,onClose:()=>c(!1),onCreate:N}),h.jsx(FR,{isOpen:!!g,onClose:()=>y(null),project:g,onUpdate:C}),h.jsx(f6,{isOpen:!!f,onClose:()=>m(null),onConfirm:k,title:"Eliminar Proyecto?",message:`Ests a punto de borrar "${f}" y todo su contenido permanentemente. Esta accin no se puede deshacer.`,confirmText:"Eliminar Universo",isDestructive:!0})]})},$v=({icon:t,title:e,desc:r,color:n})=>h.jsxs("div",{className:"group relative p-8 rounded-[32px] bg-surface-dark border border-white/5 hover:border-white/10 transition-all cursor-pointer flex flex-col h-full gap-6 hover:shadow-2xl hover:shadow-black/40",children:[h.jsx("div",{className:`size-14 rounded-2xl ${n} flex items-center justify-center text-white shadow-lg group-hover:scale-110 transition-all duration-500`,children:h.jsx("span",{className:"material-symbols-outlined text-3xl",children:t})}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("h3",{className:"text-2xl font-bold text-white tracking-tight",children:e}),h.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:r})]}),h.jsxs("div",{className:"mt-auto pt-4 border-t border-white/5 flex items-center justify-between text-slate-500 group-hover:text-white transition-colors",children:[h.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Architect Tool"}),h.jsx("span",{className:"material-symbols-outlined text-xl group-hover:translate-x-1 transition-transform",children:"arrow_forward"})]})]}),VR=()=>{const{projectName:t}=$u(),e=Na(),{username:r}=Ua();return h.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 gap-16 max-w-6xl mx-auto w-full",children:[h.jsxs("div",{className:"flex flex-col items-center text-center gap-8 max-w-2xl animate-in fade-in slide-in-from-bottom-8 duration-700",children:[h.jsx("div",{className:"size-20 rounded-full bg-white text-background-dark flex items-center justify-center shadow-2xl shadow-white/20",children:h.jsx("span",{className:"material-symbols-outlined text-4xl font-bold",children:"explore"})}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tighter leading-tight",children:"Bienvenido de nuevo, Viajero."}),h.jsxs("p",{className:"text-xl text-slate-400 font-medium leading-relaxed",children:["Tu mundo ",h.jsx("span",{className:"text-primary font-bold",children:t||"Cargando..."})," espera ser descubierto. El lienzo est vaco, pero tu imaginacin no tiene lmites. Cmo empezamos hoy?"]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 w-full items-stretch animate-in fade-in slide-in-from-bottom-12 duration-1000 delay-300",children:[h.jsx("div",{onClick:()=>e("bible"),children:h.jsx($v,{icon:"person_add",title:"Aadir Entidad",desc:"Ve a la Biblia para agregar un personaje, lugar o item.",color:"bg-indigo-600"})}),h.jsx("div",{onClick:()=>e("map"),children:h.jsx($v,{icon:"map",title:"Crear Mapa",desc:"Dibuja una representacin cartogrfica de una regin.",color:"bg-purple-600"})}),h.jsx("div",{onClick:()=>e("writing"),children:h.jsx($v,{icon:"edit_note",title:"Empezar a Escribir",desc:"Abre el editor de texto y comienza un nuevo captulo.",color:"bg-emerald-600"})}),h.jsx("div",{onClick:()=>alert("WIP: Notas Rpidas"),children:h.jsx($v,{icon:"lightbulb",title:"Ver Ideas Rpidas",desc:"Revisa tus notas y fragmentos de inspiracin guardados.",color:"bg-amber-600"})})]})]})},UR=()=>{const t=Na(),[e,r]=se.useState(null),[n,i]=se.useState("appearance"),[a,s]=se.useState({theme:"deep_space",font:"Manrope",fontSize:16,focusMode:!1,transparencyEffects:!0,vaultPath:"./data"});se.useEffect(()=>{console.log("Settings Page Mounted");try{const c=localStorage.getItem("user");c&&c!=="undefined"&&r(JSON.parse(c))}catch(c){console.error("Failed to parse user settings",c)}},[]);const o=async()=>{try{await $e.post("/auth/logout",{})}catch(c){console.error("Logout error",c)}finally{localStorage.removeItem("user"),sessionStorage.clear(),t("/")}},l=[{id:"general",label:"General",icon:"settings"},{id:"appearance",label:"Apariencia",icon:"palette"},{id:"editor",label:"Editor",icon:"edit_note"},{id:"sync",label:"Sincronizacin",icon:"sync_lock"},{id:"notifications",label:"Notificaciones",icon:"notifications"}],u=[{id:"deep_space",label:"Deep Space",color:"#0f172a"},{id:"nebula",label:"Nebula",color:"#312e81"},{id:"high_contrast",label:"High Contrast",color:"#000000"}];return h.jsxs("div",{className:"flex w-full h-full bg-[#050508] text-white font-sans overflow-hidden",children:[h.jsxs("aside",{className:"w-64 flex-none flex flex-col border-r border-white/5 bg-[#0a0a0e]",children:[h.jsxs("div",{className:"p-8 pb-4",children:[h.jsx("div",{className:"size-10 rounded-full bg-white flex items-center justify-center text-black mb-4",children:h.jsx("span",{className:"material-symbols-outlined text-2xl",children:"settings"})}),h.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"Ajustes"}),h.jsx("p",{className:"text-xs text-slate-500 font-mono mt-1",children:"v2.4.0 Local-Build"})]}),h.jsx("nav",{className:"flex-1 px-4 py-4 space-y-1",children:l.map(c=>h.jsxs("button",{onClick:()=>i(c.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold transition-all ${n===c.id?"bg-indigo-500/10 text-indigo-400":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[h.jsx("span",{className:"material-symbols-outlined text-lg",children:c.icon}),c.label]},c.id))}),h.jsx("div",{className:"p-4 border-t border-white/5",children:h.jsxs("button",{onClick:o,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold text-red-400 hover:bg-red-500/10 transition-colors",children:[h.jsx("span",{className:"material-symbols-outlined text-lg",children:"logout"}),"Cerrar Sesin"]})})]}),h.jsx("main",{className:"flex-1 overflow-y-auto p-12 custom-scrollbar",children:h.jsxs("div",{className:"max-w-3xl mx-auto space-y-12",children:[h.jsxs("header",{children:[h.jsx("h2",{className:"text-3xl font-bold mb-2",children:l.find(c=>c.id===n)?.label}),h.jsx("p",{className:"text-slate-500",children:"Personaliza la interfaz visual y tu entorno de escritura para maximizar tu creatividad y concentracin."})]}),n==="appearance"&&h.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4",children:[h.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8",children:[h.jsx("h3",{className:"text-lg font-bold mb-1",children:"Tema de la Interfaz"}),h.jsx("p",{className:"text-xs text-slate-500 mb-6",children:"Selecciona el esquema de colores que prefieras."}),h.jsx("div",{className:"grid grid-cols-3 gap-6",children:u.map(c=>h.jsxs("button",{onClick:()=>s({...a,theme:c.id}),className:`relative group text-left transition-all ${a.theme===c.id?"ring-2 ring-indigo-500":"hover:ring-1 hover:ring-white/20"} rounded-2xl overflow-hidden`,children:[h.jsx("div",{className:"h-32 bg-black/20 relative p-4 flex items-center justify-center",children:h.jsx("div",{className:"w-full h-full rounded-xl flex items-center justify-center",style:{backgroundColor:c.color},children:h.jsx("div",{className:"size-8 rounded-full bg-white/10 backdrop-blur-md"})})}),h.jsx("div",{className:"p-4 bg-[#18181b]",children:h.jsx("span",{className:"text-xs font-bold text-slate-300 group-hover:text-white",children:c.label})})]},c.id))})]}),h.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8 space-y-8",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("span",{className:"material-symbols-outlined text-indigo-400",children:"text_fields"}),h.jsx("h3",{className:"text-lg font-bold",children:"Configuracin del Editor"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-12 border-b border-white/5 pb-8",children:[h.jsxs("div",{className:"space-y-3",children:[h.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Tipografa"}),h.jsxs("div",{className:"relative",children:[h.jsxs("select",{value:a.font,onChange:c=>s({...a,font:c.target.value}),className:"w-full bg-[#18181b] border border-white/10 rounded-xl px-4 py-3 text-sm text-white appearance-none outline-none focus:border-indigo-500 transition-colors",children:[h.jsx("option",{value:"Manrope",children:"Manrope (Sans-serif)"}),h.jsx("option",{value:"Inter",children:"Inter"}),h.jsx("option",{value:"Merriweather",children:"Merriweather (Serif)"})]}),h.jsx("span",{className:"material-symbols-outlined absolute right-4 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-sm",children:"expand_more"})]}),h.jsx("p",{className:"text-[10px] text-slate-600",children:"La fuente utilizada en el lienzo de escritura."})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex justify-between",children:[h.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Tamao de Fuente"}),h.jsxs("span",{className:"text-xs font-bold text-indigo-400",children:[a.fontSize,"px"]})]}),h.jsx("input",{type:"range",min:"12",max:"24",value:a.fontSize,onChange:c=>s({...a,fontSize:parseInt(c.target.value)}),className:"w-full accent-indigo-500 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer"}),h.jsxs("div",{className:"flex justify-between text-[10px] text-slate-600 font-bold uppercase",children:[h.jsx("span",{children:"Aa"}),h.jsx("span",{children:"Aa"})]})]})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"size-10 rounded-full bg-white/5 flex items-center justify-center text-slate-400",children:h.jsx("span",{className:"material-symbols-outlined",children:"center_focus_strong"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-sm font-bold text-white",children:"Modo Enfoque"}),h.jsx("p",{className:"text-xs text-slate-500",children:"Oculta todos los paneles laterales al escribir."})]})]}),h.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:a.focusMode,onChange:c=>s({...a,focusMode:c.target.checked}),className:"sr-only peer"}),h.jsx("div",{className:"w-11 h-6 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-slate-400 after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-500 peer-checked:after:bg-white"})]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex gap-4",children:[h.jsx("div",{className:"size-10 rounded-full bg-white/5 flex items-center justify-center text-slate-400",children:h.jsx("span",{className:"material-symbols-outlined",children:"blur_on"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-sm font-bold text-white",children:"Efectos de Transparencia"}),h.jsx("p",{className:"text-xs text-slate-500",children:"Desactivar para mejorar el rendimiento."})]})]}),h.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:a.transparencyEffects,onChange:c=>s({...a,transparencyEffects:c.target.checked}),className:"sr-only peer"}),h.jsx("div",{className:"w-11 h-6 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-slate-400 after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-500 peer-checked:after:bg-white"})]})]})]})]}),h.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-1 relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-indigo-500 rounded-l-3xl"}),h.jsxs("div",{className:"p-8",children:[h.jsxs("div",{className:"flex justify-between items-start mb-6",children:[h.jsxs("div",{className:"flex gap-4",children:[h.jsx("span",{className:"material-symbols-outlined text-indigo-400 text-2xl",children:"folder_special"}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-bold text-white",children:"Almacenamiento Local"}),h.jsx("p",{className:"text-xs text-slate-500",children:"Tus datos viven en tu dispositivo. Gestiona tus copias de seguridad."})]})]}),h.jsxs("span",{className:"px-3 py-1 bg-green-500/10 text-green-400 rounded-full text-[10px] font-bold uppercase border border-green-500/20 flex items-center gap-2",children:[h.jsx("span",{className:"size-1.5 rounded-full bg-green-500 animate-pulse"})," Sincronizado"]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 block mb-2",children:"Ruta de la Bveda"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("div",{className:"flex-1 bg-[#18181b] border border-white/10 rounded-xl px-4 py-3 text-xs font-mono text-slate-300 truncate",children:a.vaultPath}),h.jsx("button",{className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-xl text-xs font-bold transition-colors",children:"Cambiar"})]})]}),h.jsxs("div",{className:"bg-[#18181b] rounded-xl p-4 flex items-center justify-between border border-white/5",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"size-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:h.jsx("span",{className:"material-symbols-outlined",children:"history"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-sm font-bold text-white",children:"Copia de Seguridad Automtica"}),h.jsx("p",{className:"text-[10px] text-slate-500",children:"Ultima copia: Hace 12 minutos"})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-lg text-xs font-bold transition-colors",children:"Restaurar"}),h.jsx("button",{className:"px-4 py-2 bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg text-xs font-bold transition-colors shadow-lg shadow-indigo-500/20",children:"Respaldar Ahora"})]})]})]})]})]}),h.jsx("div",{className:"flex justify-end pt-8 pb-20",children:h.jsx("button",{className:"px-8 py-3 bg-white text-black font-bold rounded-full hover:scale-105 transition-transform shadow-xl",children:"Guardar Cambios"})})]}),n!=="appearance"&&h.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] text-slate-600",children:[h.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-20",children:"construction"}),h.jsx("h3",{className:"text-xl font-bold text-slate-500",children:"En Construccin"}),h.jsxs("p",{className:"text-sm",children:["El mdulo ",l.find(c=>c.id===n)?.label," estar disponible pronto."]})]})]})})]})},Cg=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirmar",cancelText:s="Cancelar",type:o="danger"})=>t?hl.createPortal(h.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[h.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),h.jsxs("div",{className:"relative w-full max-w-md bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl p-6 animate-in zoom-in-95 duration-200 overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 left-0 right-0 h-32 bg-gradient-to-b from-white/5 to-transparent pointer-events-none"}),h.jsxs("div",{className:"relative z-10 text-center",children:[h.jsx("div",{className:`mx-auto mb-4 size-16 rounded-2xl flex items-center justify-center ${o==="danger"?"bg-red-500/10 text-red-500":"bg-yellow-500/10 text-yellow-500"}`,children:h.jsx("span",{className:"material-symbols-outlined text-3xl",children:o==="danger"?"delete_forever":"warning"})}),h.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),h.jsx("p",{className:"text-text-muted text-sm mb-8 leading-relaxed",children:i}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 rounded-xl bg-surface-light hover:bg-white/10 text-text-muted hover:text-white text-xs font-bold transition-all border border-white/5",children:s}),h.jsx("button",{onClick:()=>{r(),e()},className:`flex-1 px-4 py-3 rounded-xl text-white text-xs font-bold transition-all shadow-lg flex items-center justify-center gap-2
                                ${o==="danger"?"bg-red-500 hover:bg-red-600 shadow-red-500/20":"bg-primary hover:bg-primary-light shadow-primary/20"}`,children:h.jsx("span",{children:a})})]})]})]})]}),document.body):null,UC=({compact:t=!1})=>{const[e,r]=se.useState(null),[n,i]=se.useState([]),[a,s]=se.useState(!1),[o,l]=se.useState(null);se.useEffect(()=>{u()},[]);const u=async()=>{try{const g=await $e.get("/world-bible/folders");g.length>0&&r(g[0].id),c()}catch(g){console.error("Init error:",g)}},c=async()=>{s(!0);try{const g=await $e.get("/world-bible/templates/global");i(g)}catch(g){console.error("Error loading templates:",g)}finally{s(!1)}},f=async g=>{if(e)try{await $e.post(`/world-bible/folders/${e}/templates`,{nombre:g.label,tipo:g.type,required:g.required,metadata:g.metadata?JSON.stringify(g.metadata):null,global:!0}),c()}catch(y){console.error("Error creating template:",y)}},m=async()=>{if(o)try{await $e.delete(`/world-bible/templates/${o}`),i(g=>g.filter(y=>y.id!==o))}catch(g){console.error("Error deleting template:",g)}finally{l(null)}};return h.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[h.jsxs(ir,{className:`${t?"p-4 bg-transparent border-none shadow-none":"p-8 space-y-8"}`,children:[h.jsx("header",{className:`flex ${t?"flex-col gap-4":"justify-between items-center"}`,children:h.jsxs("div",{children:[h.jsx("h3",{className:`${t?"text-sm":"text-xl"} font-bold text-white`,children:"Atributos Globales"}),h.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Define atributos disponibles para todas las entidades."})]})}),h.jsxs("div",{className:"space-y-4",children:[a?h.jsx("div",{className:"text-center p-4 text-slate-500",children:"Cargando plantillas..."}):n.map((g,y)=>h.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-primary/50 hover:bg-white/5 transition-all cursor-grab active:cursor-grabbing group select-none",draggable:!0,onDragStart:b=>{b.dataTransfer.setData("application/reactflow/type","attribute"),b.dataTransfer.setData("templateId",g.id),b.dataTransfer.setData("templateData",JSON.stringify(g)),b.dataTransfer.effectAllowed="copy"},children:[h.jsxs("span",{className:"text-[10px] font-black text-slate-700 w-6 group-hover:text-primary transition-colors",children:["0",y+1]}),h.jsxs("div",{className:"flex-1 pointer-events-none",children:[h.jsx("div",{className:"text-sm font-bold text-white",children:g.nombre}),h.jsxs("div",{className:"text-[10px] text-slate-500 uppercase tracking-widest",children:[g.tipo," ",g.esObligatorio&&" Required"]}),g.metadata&&h.jsx("div",{className:"text-[10px] text-slate-600 font-mono mt-1 truncate",children:g.metadata})]}),h.jsx("button",{onClick:()=>l(g.id),className:"p-1.5 text-slate-500 hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",title:"Eliminar Plantilla Global",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},g.id)),h.jsx(GR,{onAdd:f})]})]}),h.jsx(Cg,{isOpen:!!o,onClose:()=>l(null),onConfirm:m,title:"Eliminar Plantilla",message:"Ests seguro de que quieres eliminar esta plantilla? Esta accin es irreversible.",confirmText:"Eliminar",type:"danger"})]})},GR=({onAdd:t})=>{const[e,r]=se.useState(""),[n,i]=se.useState("text"),[a,s]=se.useState(!1),[o,l]=se.useState([""]),u=()=>l([...o,""]),c=g=>l(o.filter((y,b)=>b!==g)),f=(g,y)=>{const b=[...o];b[g]=y,l(b)},m=()=>{if(!e)return;let g=null;["select","multi_select"].includes(n)&&(g={options:o.filter(y=>y.trim())}),t({label:e,type:n,required:a,metadata:g}),r(""),l([""])};return h.jsxs("div",{className:"p-4 rounded-2xl border-2 border-dashed border-white/10 bg-white/[0.01] space-y-4",children:[h.jsx("h4",{className:"text-xs font-black uppercase tracking-widest text-primary",children:"Add New Attribute"}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsx("input",{placeholder:"Field Name",value:e,onChange:g=>r(g.target.value),className:"bg-black/20 border border-white/5 rounded-xl px-4 py-2 text-xs text-white outline-none focus:border-primary/30 min-w-0"}),h.jsxs("select",{value:n,onChange:g=>i(g.target.value),className:"bg-black/20 border border-white/5 rounded-xl px-4 py-2 text-xs text-white outline-none",children:[h.jsx("option",{value:"text",children:"Text (Long)"}),h.jsx("option",{value:"short_text",children:"Text (Short)"}),h.jsx("option",{value:"number",children:"Number"}),h.jsx("option",{value:"date",children:"Date"}),h.jsx("option",{value:"select",children:"Single Selection (Dropdown)"}),h.jsx("option",{value:"multi_select",children:"Multiple Selection"}),h.jsx("option",{value:"boolean",children:"Switch (True/False)"})]})]}),["select","multi_select"].includes(n)&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Options"}),h.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-2 custom-scrollbar",children:o.map((g,y)=>h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{placeholder:`Option ${y+1}`,value:g,onChange:b=>f(y,b.target.value),className:"flex-1 bg-black/20 border border-white/5 rounded-lg px-3 py-1.5 text-xs text-white outline-none focus:border-primary/30"}),h.jsx("button",{onClick:()=>c(y),className:"p-1.5 hover:bg-red-500/20 text-slate-500 hover:text-red-400 rounded-lg transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]},y))}),h.jsx("button",{onClick:u,className:"w-full py-1.5 text-[10px] font-bold uppercase tracking-widest text-primary hover:bg-primary/5 rounded-lg border border-dashed border-primary/20 transition-all",children:"+ Add Custom Option"})]}),h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:a,onChange:g=>s(g.target.checked),className:"size-4 rounded border-white/10 bg-white/5 accent-primary"}),h.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"Required Field"})]}),h.jsx("button",{onClick:m,className:"px-4 py-2 bg-primary/20 text-primary rounded-lg text-xs font-bold hover:bg-primary/30 transition-all",children:"+ Add Field"})]})]})},GC=({projectName:t,storageKey:e})=>{const[r,n]=se.useState([]),[i,a]=se.useState(!1),[s,o]=se.useState(null),l=()=>e||`notes_v2_${t}`;se.useEffect(()=>{const k=l();if(!k)return;const C=localStorage.getItem(k);if(C)n(JSON.parse(C));else if(!e){const E=localStorage.getItem(`notes_${t}`);if(E){const P={id:Date.now(),title:"Nota General",content:E};n([P]),localStorage.setItem(k,JSON.stringify([P]))}}},[t,e]);const u=k=>{n(k);const C=l();C&&localStorage.setItem(C,JSON.stringify(k))},c=()=>{const k={id:Date.now(),title:"Nueva Nota",content:""};u([...r,k]),o(k.id)},[f,m]=se.useState(null),g=k=>{m(k)},y=()=>{f&&(u(r.filter(k=>k.id!==f)),m(null))},b=(k,C,E)=>{u(r.map(P=>P.id===k?{...P,[C]:E}:P))},w=()=>a(!i),N=()=>h.jsxs("div",{className:`flex flex-col h-full bg-surface-dark/40 ${i?"":"max-h-[25vh]"}`,children:[h.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-glass-border bg-white/5",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"edit_note"}),h.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-white",children:["Notas (",r.length,")"]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:c,className:"p-1 hover:text-primary text-text-muted transition-colors",title:"Aadir Nota",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})}),h.jsx("button",{onClick:w,className:"p-1 hover:text-white text-text-muted transition-colors",title:"Pantalla Completa",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:i?"fullscreen_exit":"fullscreen"})})]})]}),h.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-2",children:r.length===0?h.jsx("div",{className:"py-8 text-center opacity-30 italic text-[10px] uppercase font-bold",children:"Sin notas"}):r.map(k=>h.jsxs("div",{className:"group bg-white/5 border border-glass-border rounded-xl overflow-hidden hover:border-primary/30 transition-all",children:[h.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white/5",children:[h.jsx("input",{className:"bg-transparent border-none text-[11px] font-bold text-white outline-none w-full",value:k.title,onChange:C=>b(k.id,"title",C.target.value),placeholder:"Ttulo..."}),h.jsx("button",{onClick:()=>g(k.id),className:"opacity-0 group-hover:opacity-100 p-1 text-text-muted hover:text-red-400 transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-xs",children:"delete"})})]}),h.jsx("textarea",{className:"w-full bg-transparent p-3 text-xs text-white/70 outline-none resize-none min-h-[80px] custom-scrollbar",value:k.content,onChange:C=>b(k.id,"content",C.target.value),placeholder:"Escribe el contenido aqu..."})]},k.id))}),h.jsx(Cg,{isOpen:!!f,onClose:()=>m(null),onConfirm:y,title:"Eliminar Nota",message:"Ests seguro de que quieres eliminar esta nota? No se podr recuperar.",confirmText:"Eliminar",type:"danger"})]});return i?h.jsx("div",{className:"fixed inset-0 z-[100] bg-background-dark/95 backdrop-blur-md p-8 flex flex-col items-center",children:h.jsx("div",{className:"w-full max-w-4xl h-full flex flex-col border border-glass-border rounded-3xl overflow-hidden shadow-2xl bg-surface-dark",children:h.jsx(N,{})})}):h.jsx("div",{className:"h-full border border-glass-border rounded-2xl overflow-hidden",children:h.jsx(N,{})})},Bc=({to:t,icon:e,label:r,collapsed:n,end:i})=>h.jsxs(ZA,{to:t,end:i,className:({isActive:a})=>`
            flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all group
            ${a?"bg-primary text-white shadow-lg shadow-primary/20":"text-text-muted hover:text-white hover:bg-white/5"}
            ${n?"justify-center":""}
        `,title:n?r:"",children:[h.jsx("span",{className:"material-symbols-outlined text-xl",children:e}),!n&&h.jsx("span",{className:"text-sm font-bold tracking-wide",children:r})]}),HC=t=>{switch(t?.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},HR=()=>{console.log("ArchitectLayout Mounting");const{username:t,projectName:e,folderSlug:r}=Ua(),n=Na(),i=wd(),[a,s]=se.useState(!0),[o,l]=se.useState(!1),[u,c]=se.useState("Loading..."),[f,m]=se.useState(null),[g,y]=se.useState("NOTES"),[b,w]=se.useState(""),[N,k]=se.useState([]),[C,E]=se.useState(null),[P,_]=se.useState(null),[A,I]=se.useState({name:"",description:"",type:"regional",showGrid:!0,gridSize:50,width:800,height:600,bgImage:null}),[D,L]=se.useState(null),[U,H]=se.useState("identity"),[M,z]=se.useState("notes"),[O,G]=se.useState(""),[W,$]=se.useState("ALL"),X=i.pathname.includes("/bible"),Q=i.pathname.includes("/writing"),[V,Y]=se.useState("index"),[Z,ie]=se.useState(null),[ce,he]=se.useState([]),[ee,le]=se.useState("identity"),[te,ae]=se.useState(null),oe=(_e,Ae)=>{_e.stopPropagation(),ae(Ae)},fe=async()=>{if(te){try{await $e.delete(`/world-bible/templates/${te}`),k(_e=>_e.filter(Ae=>Ae.id!==te))}catch(_e){console.error("Delete failed",_e)}ae(null)}},pe=async _e=>{_e.preventDefault();try{await $e.put(`/world-bible/templates/${Z.id}`,Z),k(Ae=>Ae.map(He=>He.id===Z.id?Z:He)),ie(null)}catch(Ae){console.error("Update failed",Ae)}},Te=`/${t}/${e}`;se.useEffect(()=>{e&&Oe(e);const _e=()=>{e&&Oe(e)};return window.addEventListener("focus",_e),()=>window.removeEventListener("focus",_e)},[e]);const Oe=async _e=>{try{const Ae=await $e.get(`/proyectos/${_e}`);Ae&&(c(Ae.nombreProyecto),m(Ae.id))}catch(Ae){console.error("Error loading project:",Ae),c("Error"),n("/")}};return h.jsxs("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark text-text-main font-sans selection:bg-primary/30",children:[h.jsxs("aside",{className:`
                    flex-none bg-surface-dark border-r border-glass-border transition-all duration-500 relative flex flex-col z-30
                    ${a?"w-80":"w-20"}
                `,children:[h.jsxs("div",{className:"h-16 flex items-center justify-center border-b border-glass-border relative",children:[a?h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"size-8 rounded-lg bg-surface-light flex items-center justify-center text-primary shadow-inner",children:h.jsx("span",{className:"material-symbols-outlined",children:"auto_stories"})}),h.jsx("h2",{className:"text-sm font-black uppercase tracking-widest text-white truncate max-w-[150px]",children:u})]}):h.jsx("button",{onClick:()=>s(!0),className:"size-10 rounded-xl hover:bg-white/5 flex items-center justify-center text-text-muted hover:text-white transition-all",children:h.jsx("span",{className:"material-symbols-outlined",children:"menu"})}),a&&h.jsx("button",{onClick:()=>s(!1),className:"absolute right-4 text-text-muted hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"dock_to_left"})})]}),h.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar flex flex-col",children:h.jsxs("div",{className:"p-3 space-y-1",children:[h.jsx(Bc,{to:Te,icon:"home",label:"Dashboard",collapsed:!a,end:!0}),h.jsx(Bc,{to:`${Te}/bible`,icon:"menu_book",label:"World Bible",collapsed:!a}),h.jsx(Bc,{to:`${Te}/map`,icon:"map",label:"Atlas",collapsed:!a}),h.jsx(Bc,{to:`${Te}/timeline`,icon:"calendar_month",label:"Chronology",collapsed:!a}),h.jsx(Bc,{to:`${Te}/graph`,icon:"hub",label:"Graph",collapsed:!a}),h.jsx("div",{className:"h-px bg-glass-border my-2 mx-2 opacity-50"}),h.jsx(Bc,{to:`${Te}/writing`,icon:"edit_note",label:"Writing",collapsed:!a}),h.jsx(Bc,{to:`${Te}/settings`,icon:"settings",label:"Settings",collapsed:!a})]})}),h.jsx("footer",{className:"p-4 border-t border-glass-border",children:h.jsxs("div",{className:`flex items-center gap-3 ${!a&&"justify-center"}`,children:[h.jsx("div",{className:"size-10 rounded-full border border-glass-border p-1 bg-surface-light relative",children:h.jsx("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-primary to-purple-500 flex items-center justify-center text-white font-black text-xs",children:t?t.substring(0,2).toUpperCase():"US"})}),a&&h.jsxs("div",{className:"overflow-hidden",children:[h.jsx("h4",{className:"text-xs font-bold text-white truncate",children:t||"User"}),h.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-tighter",children:"Architect"})]})]})})]}),h.jsxs("main",{className:"flex-1 flex flex-col min-w-0 bg-background-dark relative",children:[h.jsx("div",{className:"h-16 w-full absolute top-0 left-0 bg-gradient-to-b from-background-dark to-transparent pointer-events-none"}),h.jsx("div",{className:"flex-1 flex overflow-hidden relative",children:h.jsx(xS,{context:{setRightPanelMode:y,setRightOpen:l,setRightPanelTitle:w,projectName:u,projectId:f,availableTemplates:N,setAvailableTemplates:k,setAddAttributeHandler:E,setCreateTemplateHandler:_,mapSettings:A,setMapSettings:I,setOnMapSettingsChange:L,entityTabs:ce,setEntityTabs:he,activeEntityTab:ee,setActiveEntityTab:le,folderSearchTerm:O,setFolderSearchTerm:G,folderFilterType:W,setFolderFilterType:$}})})]}),h.jsxs("aside",{className:`
                    flex-none bg-surface-dark border-l border-glass-border transition-all duration-500 relative flex flex-col z-30 shrink-0
                    ${o?"w-80":"w-20"}
                `,children:[h.jsx("header",{className:"h-16 flex items-center px-6 border-b border-glass-border justify-between shrink-0",children:o?h.jsxs(h.Fragment,{children:[g==="CUSTOM"&&!Q?h.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-primary",children:b||"Panel"}):Q?h.jsxs("div",{className:"flex bg-white/5 rounded-lg p-1 gap-1 w-full mr-4",children:[h.jsx("button",{onClick:()=>Y("index"),className:`flex-1 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${V==="index"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"ndice"}),h.jsx("button",{onClick:()=>Y("notes"),className:`flex-1 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${V==="notes"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Notas"})]}):X&&g==="NOTES"?h.jsxs("div",{className:"flex bg-white/5 rounded-lg p-1 gap-1",children:[h.jsx("button",{onClick:()=>z("notes"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${M==="notes"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Notas"}),h.jsx("button",{onClick:()=>z("templates"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${M==="templates"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Plantillas"}),h.jsx("button",{onClick:()=>z("filters"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${M==="filters"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Explorar"})]}):h.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-white",children:b||(g==="NOTES"?"Notas Globales":"Constructor")}),h.jsx("button",{onClick:()=>l(!1),className:"text-text-muted hover:text-white transition-colors shrink-0",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"dock_to_right"})})]}):h.jsx("button",{onClick:()=>l(!0),className:"w-full h-full flex items-center justify-center text-text-muted hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined",children:g==="NOTES"||Q?"edit_note":g==="MAP"?"map":g==="CUSTOM"?"build":"handyman"})})}),h.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar p-0 relative",children:[h.jsx("div",{id:"architect-right-panel-portal",className:`
                            ${(Q||g==="CUSTOM")&&o?"flex flex-col h-full relative":"hidden"}
                        `}),o?Q?h.jsx(h.Fragment,{children:h.jsx("div",{className:`h-full p-4 overflow-hidden ${V==="notes"?"block":"hidden"}`,children:h.jsx(GC,{projectName:e})})}):g==="CUSTOM"?h.jsx(h.Fragment,{}):g==="NOTES"?M==="templates"&&X?h.jsx("div",{className:"h-full overflow-y-auto no-scrollbar",children:h.jsx(UC,{compact:!0})}):M==="filters"&&X?h.jsxs("div",{className:"h-full p-6 space-y-6 animate-in fade-in slide-in-from-right-4",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Bsqueda"}),h.jsxs("div",{className:"bg-black/20 border border-white/10 rounded-xl p-3 flex items-center gap-2 focus-within:border-primary transition-colors",children:[h.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"search"}),h.jsx("input",{value:O,onChange:_e=>G(_e.target.value),placeholder:"Buscar entidad...",className:"bg-transparent border-none outline-none text-sm text-white w-full placeholder-slate-600"}),O&&h.jsx("button",{onClick:()=>G(""),className:"text-slate-500 hover:text-white",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]})]}),h.jsx("div",{className:"h-px bg-glass-border"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Filtrar por Tipo"}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"ALL",label:"Todos",icon:"grid_view"},{id:"ENTITY",label:"Entidades",icon:"person"},{id:"MAP",label:"Mapas",icon:"map"},{id:"TIMELINE",label:"Timelines",icon:"timeline"}].map(_e=>h.jsxs("button",{onClick:()=>$(_e.id),className:`
                                                        p-3 rounded-xl border flex flex-col items-center gap-2 transition-all
                                                        ${W===_e.id?"bg-primary text-white border-primary shadow-lg shadow-primary/20":"bg-white/5 border-transparent text-slate-500 hover:bg-white/10 hover:text-white"}
                                                    `,children:[h.jsx("span",{className:"material-symbols-outlined",children:_e.icon}),h.jsx("span",{className:"text-[10px] font-bold uppercase",children:_e.label})]},_e.id))})]})]}):h.jsx("div",{className:"h-full p-4 overflow-hidden",children:h.jsx(GC,{projectName:e})}):g==="MAP"?h.jsxs("div",{className:"p-6 space-y-8 animate-in fade-in slide-in-from-right-4",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Grid System"}),h.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:A.showGrid,onChange:_e=>{const Ae={...A,showGrid:_e.target.checked};I(Ae),D&&D(Ae)},className:"sr-only peer"}),h.jsx("div",{className:"w-9 h-5 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-primary"})]})]}),h.jsxs("div",{className:`space-y-2 transition-opacity ${A.showGrid?"opacity-100":"opacity-30 pointer-events-none"}`,children:[h.jsxs("div",{className:"flex justify-between text-xs font-bold text-white",children:[h.jsx("span",{children:"Size"}),h.jsxs("span",{className:"font-mono text-primary",children:[A.gridSize,"px"]})]}),h.jsx("input",{type:"range",min:"10",max:"200",step:"10",value:A.gridSize,onChange:_e=>{const Ae={...A,gridSize:parseInt(_e.target.value)};I(Ae),D&&D(Ae)},className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-primary"})]})]}),h.jsx("div",{className:"h-px bg-glass-border"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Canvas Data"}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Width (px)"}),h.jsx("input",{type:"number",value:A.width,onChange:_e=>{const Ae={...A,width:parseInt(_e.target.value)};I(Ae),D&&D(Ae)},className:"w-full bg-black/20 border border-white/10 rounded-lg p-2 text-white text-right font-mono text-sm focus:border-primary outline-none"})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Height (px)"}),h.jsx("input",{type:"number",value:A.height,onChange:_e=>{const Ae={...A,height:parseInt(_e.target.value)};I(Ae),D&&D(Ae)},className:"w-full bg-black/20 border border-white/10 rounded-lg p-2 text-white text-right font-mono text-sm focus:border-primary outline-none"})]})]})]}),h.jsx("div",{className:"h-px bg-glass-border"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Background Image"}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("label",{className:"cursor-pointer bg-white/5 hover:bg-white/10 text-white rounded-lg px-3 py-2 text-xs font-bold transition-colors border border-glass-border flex items-center gap-2 flex-1",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"upload"}),h.jsx("span",{children:"Upload New Image"}),h.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:_e=>{const Ae=_e.target.files[0];if(Ae){const He=new FileReader;He.onload=tt=>{const Ie=new Image;Ie.onload=()=>{const ye={...A,bgImage:tt.target.result,width:Ie.width,height:Ie.height};I(ye),D&&D(ye)},Ie.src=tt.target.result},He.readAsDataURL(Ae)}}})]}),A.bgImage&&h.jsx("button",{onClick:()=>{const _e={...A,bgImage:null};I(_e),D&&D(_e)},className:"p-2 bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-lg border border-red-500/20",title:"Remove Image",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),A.bgImage&&h.jsxs("div",{className:"rounded-lg overflow-hidden border border-glass-border bg-black/20 h-32 relative group",children:[h.jsx("img",{src:A.bgImage,alt:"Background",className:"w-full h-full object-cover opacity-70"}),h.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:h.jsxs("span",{className:"text-[10px] font-mono bg-black/50 px-2 py-1 rounded text-white backdrop-blur-sm",children:[A.width," x ",A.height]})})]})]})]})]}):g==="ENTITY"?h.jsxs("div",{className:"flex flex-col h-full animate-in fade-in slide-in-from-right-4",children:[h.jsx("div",{className:"p-4 border-b border-glass-border",children:h.jsx("div",{className:"bg-black/40 p-1 rounded-xl flex",children:ce.map(_e=>{const Ae=He=>{switch(He.toLowerCase()){case"identity":return"badge";case"narrative":return"auto_stories";case"attributes":return"tune";case"notes":return"edit_note";default:return"circle"}};return h.jsxs("button",{onClick:()=>le(_e),className:`
                                                        flex-1 py-2 rounded-lg transition-all group relative flex items-center justify-center
                                                        ${ee===_e?"bg-primary text-white shadow-lg":"text-text-muted hover:text-white hover:bg-white/5"}
                                                    `,title:_e,children:[h.jsx("span",{className:"material-symbols-outlined text-lg",children:Ae(_e)}),h.jsx("span",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2 bg-black/90 text-white text-[10px] uppercase font-bold px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50",children:_e})]},_e)})})}),ee==="attributes"&&h.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col bg-black/20",children:[h.jsxs("div",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500 tracking-widest flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"drag_indicator"})," Drag Attributes"]}),h.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-2",children:h.jsx(UC,{compact:!0,initialFolderSlug:r})})]})]}):g==="TOOLBOX"?h.jsx("div",{className:"p-4 space-y-6",children:h.jsxs("div",{className:"space-y-3",children:[h.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted px-2 flex justify-between items-center",children:[h.jsx("span",{children:"Plantillas Disponibles"}),h.jsx("button",{className:"text-primary hover:text-white transition-colors",title:"Crear Nueva Plantilla",onClick:()=>P&&P(),children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})]}),N.length===0?h.jsx("div",{className:"p-6 text-center border border-dashed border-glass-border rounded-2xl opacity-30",children:h.jsx("p",{className:"text-[10px] uppercase font-bold",children:"Sin Plantillas"})}):N.map(_e=>h.jsxs("button",{className:"w-full flex items-center gap-3 p-3 rounded-2xl bg-white/5 border border-glass-border hover:border-primary/50 hover:bg-primary/5 transition-all text-left group relative",draggable:!0,onDragStart:Ae=>{Ae.dataTransfer.setData("application/reactflow/type","attribute"),Ae.dataTransfer.setData("templateId",_e.id),Ae.dataTransfer.effectAllowed="move"},onClick:()=>C&&C(_e.id),children:[_e.global&&h.jsx("span",{className:"absolute top-2 right-2 flex size-2 bg-blue-500 rounded-full shadow-lg shadow-blue-500/50",title:"Global"}),h.jsx("div",{className:"size-8 rounded-lg bg-surface-light flex items-center justify-center text-primary group-hover:scale-110 transition-transform",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:HC(_e.tipo)})}),h.jsxs("div",{className:"overflow-hidden",children:[h.jsx("p",{className:"text-xs font-bold text-white truncate",children:_e.nombre}),h.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-tighter",children:_e.tipo})]}),h.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx("div",{onClick:Ae=>{Ae.stopPropagation(),ie(_e)},className:"p-1 hover:text-white text-text-muted hover:bg-white/10 rounded cursor-pointer",title:"Edit",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),h.jsx("div",{onClick:Ae=>oe(Ae,_e.id),className:"p-1 hover:text-red-400 text-text-muted hover:bg-white/10 rounded cursor-pointer",title:"Delete",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]},_e.id))]})}):h.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted opacity-50",children:[h.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"dashboard"}),h.jsx("p",{className:"text-xs uppercase font-bold tracking-widest",children:"Select an item"})]}):h.jsx("div",{className:"flex flex-col items-center gap-4 py-4 w-full",children:g==="NOTES"||Q?h.jsx("button",{onClick:()=>l(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Notas Globales",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"edit_note"})}):g==="MAP"?h.jsx("button",{onClick:()=>l(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Ajustes de Mapa",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"tune"})}):g==="ENTITY"?h.jsx("button",{onClick:()=>l(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Atributos",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"fact_check"})}):g==="CUSTOM"?h.jsx("button",{onClick:()=>l(!0),className:"size-10 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary hover:bg-primary/20 transition-all",title:b||"Panel",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"extension"})}):N.slice(0,5).map(_e=>h.jsxs("button",{className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white hover:bg-primary/20 transition-all relative",draggable:!0,onDragStart:Ae=>{Ae.dataTransfer.setData("application/reactflow/type","attribute"),Ae.dataTransfer.setData("templateId",_e.id)},title:_e.nombre,children:[_e.global&&h.jsx("span",{className:"absolute top-0 right-0 size-2 bg-blue-500 rounded-full border border-surface-dark"}),h.jsx("span",{className:"material-symbols-outlined text-lg",children:HC(_e.tipo)})]},_e.id))})]})]}),Z&&h.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-surface-dark border border-glass-border rounded-2xl p-6 w-full max-w-md shadow-2xl animate-scale-in",children:[h.jsx("h3",{className:"text-xl font-black text-white mb-4",children:"Editar Plantilla"}),h.jsxs("form",{onSubmit:pe,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs uppercase font-bold text-text-muted block mb-1",children:"Nombre"}),h.jsx("input",{autoFocus:!0,className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none",value:Z.nombre,onChange:_e=>ie({...Z,nombre:_e.target.value}),required:!0})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs uppercase font-bold text-text-muted block mb-1",children:"Tipo"}),h.jsxs("select",{className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none",value:Z.tipo,onChange:_e=>ie({...Z,tipo:_e.target.value}),children:[h.jsx("option",{value:"text",children:"Texto Largo"}),h.jsx("option",{value:"short_text",children:"Texto Corto"}),h.jsx("option",{value:"number",children:"Nmero"}),h.jsx("option",{value:"boolean",children:"Si/No"}),h.jsx("option",{value:"date",children:"Fecha"}),h.jsx("option",{value:"entity_link",children:"Vnculo Entidad"}),h.jsx("option",{value:"image",children:"Imagen URL"})]})]}),h.jsx("div",{className:"flex items-center",children:h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-3 bg-white/5 rounded-xl w-full hover:bg-white/10 transition-colors",children:[h.jsx("input",{type:"checkbox",checked:Z.global,onChange:_e=>ie({...Z,global:_e.target.checked}),className:"accent-primary size-4"}),h.jsx("span",{className:"text-sm font-bold text-white",children:"Es Global?"})]})})]}),h.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[h.jsx("button",{type:"button",onClick:()=>ie(null),className:"px-4 py-2 text-text-muted hover:text-white font-bold transition-colors",children:"Cancelar"}),h.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded-xl font-bold shadow-lg shadow-primary/20 hover:scale-105 transition-transform",children:"Guardar"})]})]})]})}),h.jsx(Cg,{isOpen:!!te,onClose:()=>ae(null),onConfirm:fe,title:"Eliminar Plantilla",message:"Ests seguro de que quieres eliminar esta plantilla? Esta accin no se puede deshacer.",confirmText:"Eliminar",type:"danger"})]})};var E1={exports:{}},T1,qC;function qR(){if(qC)return T1;qC=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return T1=t,T1}var j1,WC;function WR(){if(WC)return j1;WC=1;var t=qR();function e(){}function r(){}return r.resetWarningCache=e,j1=function(){function n(s,o,l,u,c,f){if(f!==t){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},j1}var $C;function $R(){return $C||($C=1,E1.exports=WR()()),E1.exports}var KR=$R();const YR=gh(KR);function f2(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function XR(t){if(Array.isArray(t))return t}function QR(t){if(Array.isArray(t))return f2(t)}function Ku(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JR(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p6(n.key),n)}}function Yu(t,e,r){return e&&JR(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function wa(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=SS(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,o=!1;return{s:function(){r=r.call(t)},n:function(){var l=r.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{s||r.return==null||r.return()}finally{if(o)throw a}}}}function h6(t,e,r){return(e=p6(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZR(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function eD(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}function tD(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rD(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pn(t,e){return XR(t)||eD(t,e)||SS(t,e)||tD()}function Y0(t){return QR(t)||ZR(t)||SS(t)||rD()}function nD(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function p6(t){var e=nD(t,"string");return typeof e=="symbol"?e:e+""}function Vn(t){"@babel/helpers - typeof";return Vn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vn(t)}function SS(t,e){if(t){if(typeof t=="string")return f2(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f2(t,e):void 0}}var Fn=typeof window>"u"?null:window,KC=Fn?Fn.navigator:null;Fn&&Fn.document;var iD=Vn(""),m6=Vn({}),aD=Vn(function(){}),sD=typeof HTMLElement>"u"?"undefined":Vn(HTMLElement),Ng=function(e){return e&&e.instanceString&&Qr(e.instanceString)?e.instanceString():null},xt=function(e){return e!=null&&Vn(e)==iD},Qr=function(e){return e!=null&&Vn(e)===aD},Nr=function(e){return!Fa(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},Zt=function(e){return e!=null&&Vn(e)===m6&&!Nr(e)&&e.constructor===Object},oD=function(e){return e!=null&&Vn(e)===m6},Qe=function(e){return e!=null&&Vn(e)===Vn(1)&&!isNaN(e)},lD=function(e){return Qe(e)&&Math.floor(e)===e},X0=function(e){if(sD!=="undefined")return e!=null&&e instanceof HTMLElement},Fa=function(e){return Eg(e)||g6(e)},Eg=function(e){return Ng(e)==="collection"&&e._private.single},g6=function(e){return Ng(e)==="collection"&&!e._private.single},kS=function(e){return Ng(e)==="core"},v6=function(e){return Ng(e)==="stylesheet"},uD=function(e){return Ng(e)==="event"},Bu=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},cD=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},dD=function(e){return Zt(e)&&Qe(e.x1)&&Qe(e.x2)&&Qe(e.y1)&&Qe(e.y2)},fD=function(e){return oD(e)&&Qr(e.then)},hD=function(){return KC&&KC.userAgent.match(/msie|trident|edge/i)},rh=function(e,r){r||(r=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var a=[],s=0;s<arguments.length;s++)a.push(arguments[s]);return a.join("$")});var n=function(){var a=this,s=arguments,o,l=r.apply(a,s),u=n.cache;return(o=u[l])||(o=u[l]=e.apply(a,s)),o};return n.cache={},n},CS=rh(function(t){return t.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),ix=rh(function(t){return t.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),y6=rh(function(t,e){return t+e[0].toUpperCase()+e.substring(1)},function(t,e){return t+"$"+e}),YC=function(e){return Bu(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},Nu=function(e,r){return e.slice(-1*r.length)===r},zn="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",pD="rgb[a]?\\(("+zn+"[%]?)\\s*,\\s*("+zn+"[%]?)\\s*,\\s*("+zn+"[%]?)(?:\\s*,\\s*("+zn+"))?\\)",mD="rgb[a]?\\((?:"+zn+"[%]?)\\s*,\\s*(?:"+zn+"[%]?)\\s*,\\s*(?:"+zn+"[%]?)(?:\\s*,\\s*(?:"+zn+"))?\\)",gD="hsl[a]?\\(("+zn+")\\s*,\\s*("+zn+"[%])\\s*,\\s*("+zn+"[%])(?:\\s*,\\s*("+zn+"))?\\)",vD="hsl[a]?\\((?:"+zn+")\\s*,\\s*(?:"+zn+"[%])\\s*,\\s*(?:"+zn+"[%])(?:\\s*,\\s*(?:"+zn+"))?\\)",yD="\\#[0-9a-fA-F]{3}",xD="\\#[0-9a-fA-F]{6}",x6=function(e,r){return e<r?-1:e>r?1:0},bD=function(e,r){return-1*x6(e,r)},Ct=Object.assign!=null?Object.assign.bind(Object):function(t){for(var e=arguments,r=1;r<e.length;r++){var n=e[r];if(n!=null)for(var i=Object.keys(n),a=0;a<i.length;a++){var s=i[a];t[s]=n[s]}}return t},wD=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var r=e.length===4,n,i,a,s=16;return r?(n=parseInt(e[1]+e[1],s),i=parseInt(e[2]+e[2],s),a=parseInt(e[3]+e[3],s)):(n=parseInt(e[1]+e[2],s),i=parseInt(e[3]+e[4],s),a=parseInt(e[5]+e[6],s)),[n,i,a]}},SD=function(e){var r,n,i,a,s,o,l,u;function c(y,b,w){return w<0&&(w+=1),w>1&&(w-=1),w<1/6?y+(b-y)*6*w:w<1/2?b:w<2/3?y+(b-y)*(2/3-w)*6:y}var f=new RegExp("^"+gD+"$").exec(e);if(f){if(n=parseInt(f[1]),n<0?n=(360- -1*n%360)%360:n>360&&(n=n%360),n/=360,i=parseFloat(f[2]),i<0||i>100||(i=i/100,a=parseFloat(f[3]),a<0||a>100)||(a=a/100,s=f[4],s!==void 0&&(s=parseFloat(s),s<0||s>1)))return;if(i===0)o=l=u=Math.round(a*255);else{var m=a<.5?a*(1+i):a+i-a*i,g=2*a-m;o=Math.round(255*c(g,m,n+1/3)),l=Math.round(255*c(g,m,n)),u=Math.round(255*c(g,m,n-1/3))}r=[o,l,u,s]}return r},kD=function(e){var r,n=new RegExp("^"+pD+"$").exec(e);if(n){r=[];for(var i=[],a=1;a<=3;a++){var s=n[a];if(s[s.length-1]==="%"&&(i[a]=!0),s=parseFloat(s),i[a]&&(s=s/100*255),s<0||s>255)return;r.push(Math.floor(s))}var o=i[1]||i[2]||i[3],l=i[1]&&i[2]&&i[3];if(o&&!l)return;var u=n[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;r.push(u)}}return r},CD=function(e){return ND[e.toLowerCase()]},b6=function(e){return(Nr(e)?e:null)||CD(e)||wD(e)||kD(e)||SD(e)},ND={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},w6=function(e){for(var r=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var s=n[a];if(Zt(s))throw Error("Tried to set map with object key");a<n.length-1?(r[s]==null&&(r[s]={}),r=r[s]):r[s]=e.value}},S6=function(e){for(var r=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var s=n[a];if(Zt(s))throw Error("Tried to get map with object key");if(r=r[s],r==null)return r}return r},Kv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var P1,XC;function jg(){if(XC)return P1;XC=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return P1=t,P1}var M1,QC;function ED(){if(QC)return M1;QC=1;var t=typeof Kv=="object"&&Kv&&Kv.Object===Object&&Kv;return M1=t,M1}var _1,JC;function ax(){if(JC)return _1;JC=1;var t=ED(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return _1=r,_1}var A1,ZC;function TD(){if(ZC)return A1;ZC=1;var t=ax(),e=function(){return t.Date.now()};return A1=e,A1}var R1,e5;function jD(){if(e5)return R1;e5=1;var t=/\s/;function e(r){for(var n=r.length;n--&&t.test(r.charAt(n)););return n}return R1=e,R1}var D1,t5;function PD(){if(t5)return D1;t5=1;var t=jD(),e=/^\s+/;function r(n){return n&&n.slice(0,t(n)+1).replace(e,"")}return D1=r,D1}var O1,r5;function NS(){if(r5)return O1;r5=1;var t=ax(),e=t.Symbol;return O1=e,O1}var I1,n5;function MD(){if(n5)return I1;n5=1;var t=NS(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function a(s){var o=r.call(s,i),l=s[i];try{s[i]=void 0;var u=!0}catch{}var c=n.call(s);return u&&(o?s[i]=l:delete s[i]),c}return I1=a,I1}var L1,i5;function _D(){if(i5)return L1;i5=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return L1=r,L1}var B1,a5;function k6(){if(a5)return B1;a5=1;var t=NS(),e=MD(),r=_D(),n="[object Null]",i="[object Undefined]",a=t?t.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):r(o)}return B1=s,B1}var F1,s5;function AD(){if(s5)return F1;s5=1;function t(e){return e!=null&&typeof e=="object"}return F1=t,F1}var z1,o5;function Pg(){if(o5)return z1;o5=1;var t=k6(),e=AD(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return z1=n,z1}var V1,l5;function RD(){if(l5)return V1;l5=1;var t=PD(),e=jg(),r=Pg(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(u){if(typeof u=="number")return u;if(r(u))return n;if(e(u)){var c=typeof u.valueOf=="function"?u.valueOf():u;u=e(c)?c+"":c}if(typeof u!="string")return u===0?u:+u;u=t(u);var f=a.test(u);return f||s.test(u)?o(u.slice(2),f?2:8):i.test(u)?n:+u}return V1=l,V1}var U1,u5;function DD(){if(u5)return U1;u5=1;var t=jg(),e=TD(),r=RD(),n="Expected a function",i=Math.max,a=Math.min;function s(o,l,u){var c,f,m,g,y,b,w=0,N=!1,k=!1,C=!0;if(typeof o!="function")throw new TypeError(n);l=r(l)||0,t(u)&&(N=!!u.leading,k="maxWait"in u,m=k?i(r(u.maxWait)||0,l):m,C="trailing"in u?!!u.trailing:C);function E(M){var z=c,O=f;return c=f=void 0,w=M,g=o.apply(O,z),g}function P(M){return w=M,y=setTimeout(I,l),N?E(M):g}function _(M){var z=M-b,O=M-w,G=l-z;return k?a(G,m-O):G}function A(M){var z=M-b,O=M-w;return b===void 0||z>=l||z<0||k&&O>=m}function I(){var M=e();if(A(M))return D(M);y=setTimeout(I,_(M))}function D(M){return y=void 0,C&&c?E(M):(c=f=void 0,g)}function L(){y!==void 0&&clearTimeout(y),w=0,c=b=f=y=void 0}function U(){return y===void 0?g:D(e())}function H(){var M=e(),z=A(M);if(c=arguments,f=this,b=M,z){if(y===void 0)return P(b);if(k)return clearTimeout(y),y=setTimeout(I,l),E(b)}return y===void 0&&(y=setTimeout(I,l)),g}return H.cancel=L,H.flush=U,H}return U1=s,U1}var OD=DD(),Mg=Tg(OD),G1=Fn?Fn.performance:null,C6=G1&&G1.now?function(){return G1.now()}:function(){return Date.now()},ID=(function(){if(Fn){if(Fn.requestAnimationFrame)return function(t){Fn.requestAnimationFrame(t)};if(Fn.mozRequestAnimationFrame)return function(t){Fn.mozRequestAnimationFrame(t)};if(Fn.webkitRequestAnimationFrame)return function(t){Fn.webkitRequestAnimationFrame(t)};if(Fn.msRequestAnimationFrame)return function(t){Fn.msRequestAnimationFrame(t)}}return function(t){t&&setTimeout(function(){t(C6())},1e3/60)}})(),Q0=function(e){return ID(e)},pl=C6,Wc=9261,N6=65599,Lf=5381,E6=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wc,n=r,i;i=e.next(),!i.done;)n=n*N6+i.value|0;return n},Zm=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wc;return r*N6+e|0},eg=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lf;return(r<<5)+r+e|0},LD=function(e,r){return e*2097152+r},fu=function(e){return e[0]*2097152+e[1]},Yv=function(e,r){return[Zm(e[0],r[0]),eg(e[1],r[1])]},c5=function(e,r){var n={value:0,done:!1},i=0,a=e.length,s={next:function(){return i<a?n.value=e[i++]:n.done=!0,n}};return E6(s,r)},ud=function(e,r){var n={value:0,done:!1},i=0,a=e.length,s={next:function(){return i<a?n.value=e.charCodeAt(i++):n.done=!0,n}};return E6(s,r)},T6=function(){return BD(arguments)},BD=function(e){for(var r,n=0;n<e.length;n++){var i=e[n];n===0?r=ud(i):r=ud(i,r)}return r};function FD(t,e,r,n,i){var a=i*Math.PI/180,s=Math.cos(a)*(t-r)-Math.sin(a)*(e-n)+r,o=Math.sin(a)*(t-r)+Math.cos(a)*(e-n)+n;return{x:s,y:o}}var zD=function(e,r,n,i,a,s){return{x:(e-n)*a+n,y:(r-i)*s+i}};function VD(t,e,r){if(r===0)return t;var n=(e.x1+e.x2)/2,i=(e.y1+e.y2)/2,a=e.w/e.h,s=1/a,o=FD(t.x,t.y,n,i,r),l=zD(o.x,o.y,n,i,a,s);return{x:l.x,y:l.y}}var d5=!0,UD=console.warn!=null,GD=console.trace!=null,ES=Number.MAX_SAFE_INTEGER||9007199254740991,j6=function(){return!0},J0=function(){return!1},f5=function(){return 0},TS=function(){},Hr=function(e){throw new Error(e)},P6=function(e){if(e!==void 0)d5=!!e;else return d5},lr=function(e){P6()&&(UD?console.warn(e):(console.log(e),GD&&console.trace()))},HD=function(e){return Ct({},e)},xo=function(e){return e==null?e:Nr(e)?e.slice():Zt(e)?HD(e):e},qD=function(e){return e.slice()},M6=function(e,r){for(r=e="";e++<36;r+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return r},WD={},_6=function(){return WD},Ni=function(e){var r=Object.keys(e);return function(n){for(var i={},a=0;a<r.length;a++){var s=r[a],o=n?.[s];i[s]=o===void 0?e[s]:o}return i}},Fu=function(e,r,n){for(var i=e.length-1;i>=0;i--)e[i]===r&&e.splice(i,1)},jS=function(e){e.splice(0,e.length)},$D=function(e,r){for(var n=0;n<r.length;n++){var i=r[n];e.push(i)}},ya=function(e,r,n){return n&&(r=y6(n,r)),e[r]},ll=function(e,r,n,i){n&&(r=y6(n,r)),e[r]=i},KD=(function(){function t(){Ku(this,t),this._obj={}}return Yu(t,[{key:"set",value:function(r,n){return this._obj[r]=n,this}},{key:"delete",value:function(r){return this._obj[r]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(r){return this._obj[r]!==void 0}},{key:"get",value:function(r){return this._obj[r]}}])})(),ul=typeof Map<"u"?Map:KD,YD="undefined",XD=(function(){function t(e){if(Ku(this,t),this._obj=Object.create(null),this.size=0,e!=null){var r;e.instanceString!=null&&e.instanceString()===this.instanceString()?r=e.toArray():r=e;for(var n=0;n<r.length;n++)this.add(r[n])}}return Yu(t,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(r){var n=this._obj;n[r]!==1&&(n[r]=1,this.size++)}},{key:"delete",value:function(r){var n=this._obj;n[r]===1&&(n[r]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(r){return this._obj[r]===1}},{key:"toArray",value:function(){var r=this;return Object.keys(this._obj).filter(function(n){return r.has(n)})}},{key:"forEach",value:function(r,n){return this.toArray().forEach(r,n)}}])})(),bh=(typeof Set>"u"?"undefined":Vn(Set))!==YD?Set:XD,sx=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||r===void 0||!kS(e)){Hr("An element must have a core reference and parameters set");return}var i=r.group;if(i==null&&(r.data&&r.data.source!=null&&r.data.target!=null?i="edges":i="nodes"),i!=="nodes"&&i!=="edges"){Hr("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1,this[0]=this;var a=this._private={cy:e,single:!0,data:r.data||{},position:r.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!r.selected,selectable:r.selectable===void 0?!0:!!r.selectable,locked:!!r.locked,grabbed:!1,grabbable:r.grabbable===void 0?!0:!!r.grabbable,pannable:r.pannable===void 0?i==="edges":!!r.pannable,active:!1,classes:new bh,animation:{current:[],queue:[]},rscratch:{},scratch:r.scratch||{},edges:[],children:[],parent:r.parent&&r.parent.isNode()?r.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(a.position.x==null&&(a.position.x=0),a.position.y==null&&(a.position.y=0),r.renderedPosition){var s=r.renderedPosition,o=e.pan(),l=e.zoom();a.position={x:(s.x-o.x)/l,y:(s.y-o.y)/l}}var u=[];Nr(r.classes)?u=r.classes:xt(r.classes)&&(u=r.classes.split(/\s+/));for(var c=0,f=u.length;c<f;c++){var m=u[c];!m||m===""||a.classes.add(m)}this.createEmitter(),(n===void 0||n)&&this.restore();var g=r.style||r.css;g&&(lr("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(g))},h5=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(n,i,a){var s;Zt(n)&&!Fa(n)&&(s=n,n=s.roots||s.root,i=s.visit,a=s.directed),a=arguments.length===2&&!Qr(i)?i:a,i=Qr(i)?i:function(){};for(var o=this._private.cy,l=n=xt(n)?this.filter(n):n,u=[],c=[],f={},m={},g={},y=0,b,w=this.byGroup(),N=w.nodes,k=w.edges,C=0;C<l.length;C++){var E=l[C],P=E.id();E.isNode()&&(u.unshift(E),e.bfs&&(g[P]=!0,c.push(E)),m[P]=0)}for(var _=function(){var M=e.bfs?u.shift():u.pop(),z=M.id();if(e.dfs){if(g[z])return 0;g[z]=!0,c.push(M)}var O=m[z],G=f[z],W=G!=null?G.source():null,$=G!=null?G.target():null,X=G==null?void 0:M.same(W)?$[0]:W[0],Q;if(Q=i(M,G,X,y++,O),Q===!0)return b=M,1;if(Q===!1)return 1;for(var V=M.connectedEdges().filter(function(he){return(!a||he.source().same(M))&&k.has(he)}),Y=0;Y<V.length;Y++){var Z=V[Y],ie=Z.connectedNodes().filter(function(he){return!he.same(M)&&N.has(he)}),ce=ie.id();ie.length!==0&&!g[ce]&&(ie=ie[0],u.push(ie),e.bfs&&(g[ce]=!0,c.push(ie)),f[ce]=Z,m[ce]=m[z]+1)}},A;u.length!==0&&(A=_(),!(A!==0&&A===1)););for(var I=o.collection(),D=0;D<c.length;D++){var L=c[D],U=f[L.id()];U!=null&&I.push(U),I.push(L)}return{path:o.collection(I),found:o.collection(b)}}},tg={breadthFirstSearch:h5({bfs:!0}),depthFirstSearch:h5({dfs:!0})};tg.bfs=tg.breadthFirstSearch;tg.dfs=tg.depthFirstSearch;var j0={exports:{}},QD=j0.exports,p5;function JD(){return p5||(p5=1,(function(t,e){(function(){var r,n,i,a,s,o,l,u,c,f,m,g,y,b,w;i=Math.floor,f=Math.min,n=function(N,k){return N<k?-1:N>k?1:0},c=function(N,k,C,E,P){var _;if(C==null&&(C=0),P==null&&(P=n),C<0)throw new Error("lo must be non-negative");for(E==null&&(E=N.length);C<E;)_=i((C+E)/2),P(k,N[_])<0?E=_:C=_+1;return[].splice.apply(N,[C,C-C].concat(k)),k},o=function(N,k,C){return C==null&&(C=n),N.push(k),b(N,0,N.length-1,C)},s=function(N,k){var C,E;return k==null&&(k=n),C=N.pop(),N.length?(E=N[0],N[0]=C,w(N,0,k)):E=C,E},u=function(N,k,C){var E;return C==null&&(C=n),E=N[0],N[0]=k,w(N,0,C),E},l=function(N,k,C){var E;return C==null&&(C=n),N.length&&C(N[0],k)<0&&(E=[N[0],k],k=E[0],N[0]=E[1],w(N,0,C)),k},a=function(N,k){var C,E,P,_,A,I;for(k==null&&(k=n),_=(function(){I=[];for(var D=0,L=i(N.length/2);0<=L?D<L:D>L;0<=L?D++:D--)I.push(D);return I}).apply(this).reverse(),A=[],E=0,P=_.length;E<P;E++)C=_[E],A.push(w(N,C,k));return A},y=function(N,k,C){var E;if(C==null&&(C=n),E=N.indexOf(k),E!==-1)return b(N,0,E,C),w(N,E,C)},m=function(N,k,C){var E,P,_,A,I;if(C==null&&(C=n),P=N.slice(0,k),!P.length)return P;for(a(P,C),I=N.slice(k),_=0,A=I.length;_<A;_++)E=I[_],l(P,E,C);return P.sort(C).reverse()},g=function(N,k,C){var E,P,_,A,I,D,L,U,H;if(C==null&&(C=n),k*10<=N.length){if(_=N.slice(0,k).sort(C),!_.length)return _;for(P=_[_.length-1],L=N.slice(k),A=0,D=L.length;A<D;A++)E=L[A],C(E,P)<0&&(c(_,E,0,null,C),_.pop(),P=_[_.length-1]);return _}for(a(N,C),H=[],I=0,U=f(k,N.length);0<=U?I<U:I>U;0<=U?++I:--I)H.push(s(N,C));return H},b=function(N,k,C,E){var P,_,A;for(E==null&&(E=n),P=N[C];C>k;){if(A=C-1>>1,_=N[A],E(P,_)<0){N[C]=_,C=A;continue}break}return N[C]=P},w=function(N,k,C){var E,P,_,A,I;for(C==null&&(C=n),P=N.length,I=k,_=N[k],E=2*k+1;E<P;)A=E+1,A<P&&!(C(N[E],N[A])<0)&&(E=A),N[k]=N[E],k=E,E=2*k+1;return N[k]=_,b(N,I,k,C)},r=(function(){N.push=o,N.pop=s,N.replace=u,N.pushpop=l,N.heapify=a,N.updateItem=y,N.nlargest=m,N.nsmallest=g;function N(k){this.cmp=k??n,this.nodes=[]}return N.prototype.push=function(k){return o(this.nodes,k,this.cmp)},N.prototype.pop=function(){return s(this.nodes,this.cmp)},N.prototype.peek=function(){return this.nodes[0]},N.prototype.contains=function(k){return this.nodes.indexOf(k)!==-1},N.prototype.replace=function(k){return u(this.nodes,k,this.cmp)},N.prototype.pushpop=function(k){return l(this.nodes,k,this.cmp)},N.prototype.heapify=function(){return a(this.nodes,this.cmp)},N.prototype.updateItem=function(k){return y(this.nodes,k,this.cmp)},N.prototype.clear=function(){return this.nodes=[]},N.prototype.empty=function(){return this.nodes.length===0},N.prototype.size=function(){return this.nodes.length},N.prototype.clone=function(){var k;return k=new N,k.nodes=this.nodes.slice(0),k},N.prototype.toArray=function(){return this.nodes.slice(0)},N.prototype.insert=N.prototype.push,N.prototype.top=N.prototype.peek,N.prototype.front=N.prototype.peek,N.prototype.has=N.prototype.contains,N.prototype.copy=N.prototype.clone,N})(),(function(N,k){return t.exports=k()})(this,function(){return r})}).call(QD)})(j0)),j0.exports}var H1,m5;function ZD(){return m5||(m5=1,H1=JD()),H1}var eO=ZD(),_g=Tg(eO),tO=Ni({root:null,weight:function(e){return 1},directed:!1}),rO={dijkstra:function(e){if(!Zt(e)){var r=arguments;e={root:r[0],weight:r[1],directed:r[2]}}var n=tO(e),i=n.root,a=n.weight,s=n.directed,o=this,l=a,u=xt(i)?this.filter(i)[0]:i[0],c={},f={},m={},g=this.byGroup(),y=g.nodes,b=g.edges;b.unmergeBy(function(O){return O.isLoop()});for(var w=function(G){return c[G.id()]},N=function(G,W){c[G.id()]=W,k.updateItem(G)},k=new _g(function(O,G){return w(O)-w(G)}),C=0;C<y.length;C++){var E=y[C];c[E.id()]=E.same(u)?0:1/0,k.push(E)}for(var P=function(G,W){for(var $=(s?G.edgesTo(W):G.edgesWith(W)).intersect(b),X=1/0,Q,V=0;V<$.length;V++){var Y=$[V],Z=l(Y);(Z<X||!Q)&&(X=Z,Q=Y)}return{edge:Q,dist:X}};k.size()>0;){var _=k.pop(),A=w(_),I=_.id();if(m[I]=A,A!==1/0)for(var D=_.neighborhood().intersect(y),L=0;L<D.length;L++){var U=D[L],H=U.id(),M=P(_,U),z=A+M.dist;z<w(U)&&(N(U,z),f[H]={node:_,edge:M.edge})}}return{distanceTo:function(G){var W=xt(G)?y.filter(G)[0]:G[0];return m[W.id()]},pathTo:function(G){var W=xt(G)?y.filter(G)[0]:G[0],$=[],X=W,Q=X.id();if(W.length>0)for($.unshift(W);f[Q];){var V=f[Q];$.unshift(V.edge),$.unshift(V.node),X=V.node,Q=X.id()}return o.spawn($)}}}},nO={kruskal:function(e){e=e||function(C){return 1};for(var r=this.byGroup(),n=r.nodes,i=r.edges,a=n.length,s=new Array(a),o=n,l=function(E){for(var P=0;P<s.length;P++){var _=s[P];if(_.has(E))return P}},u=0;u<a;u++)s[u]=this.spawn(n[u]);for(var c=i.sort(function(C,E){return e(C)-e(E)}),f=0;f<c.length;f++){var m=c[f],g=m.source()[0],y=m.target()[0],b=l(g),w=l(y),N=s[b],k=s[w];b!==w&&(o.merge(m),N.merge(k),s.splice(w,1))}return o}},iO=Ni({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),aO={aStar:function(e){var r=this.cy(),n=iO(e),i=n.root,a=n.goal,s=n.heuristic,o=n.directed,l=n.weight;i=r.collection(i)[0],a=r.collection(a)[0];var u=i.id(),c=a.id(),f={},m={},g={},y=new _g(function(Q,V){return m[Q.id()]-m[V.id()]}),b=new bh,w={},N={},k=function(V,Y){y.push(V),b.add(Y)},C,E,P=function(){C=y.pop(),E=C.id(),b.delete(E)},_=function(V){return b.has(V)};k(i,u),f[u]=0,m[u]=s(i);for(var A=0;y.size()>0;){if(P(),A++,E===c){for(var I=[],D=a,L=c,U=N[L];I.unshift(D),U!=null&&I.unshift(U),D=w[L],D!=null;)L=D.id(),U=N[L];return{found:!0,distance:f[E],path:this.spawn(I),steps:A}}g[E]=!0;for(var H=C._private.edges,M=0;M<H.length;M++){var z=H[M];if(this.hasElementWithId(z.id())&&!(o&&z.data("source")!==E)){var O=z.source(),G=z.target(),W=O.id()!==E?O:G,$=W.id();if(this.hasElementWithId($)&&!g[$]){var X=f[E]+l(z);if(!_($)){f[$]=X,m[$]=X+s(W),k(W,$),w[$]=C,N[$]=z;continue}X<f[$]&&(f[$]=X,m[$]=X+s(W),w[$]=C,N[$]=z)}}}}return{found:!1,distance:void 0,path:void 0,steps:A}}},sO=Ni({weight:function(e){return 1},directed:!1}),oO={floydWarshall:function(e){for(var r=this.cy(),n=sO(e),i=n.weight,a=n.directed,s=i,o=this.byGroup(),l=o.nodes,u=o.edges,c=l.length,f=c*c,m=function(Z){return l.indexOf(Z)},g=function(Z){return l[Z]},y=new Array(f),b=0;b<f;b++){var w=b%c,N=(b-w)/c;N===w?y[b]=0:y[b]=1/0}for(var k=new Array(f),C=new Array(f),E=0;E<u.length;E++){var P=u[E],_=P.source()[0],A=P.target()[0];if(_!==A){var I=m(_),D=m(A),L=I*c+D,U=s(P);if(y[L]>U&&(y[L]=U,k[L]=D,C[L]=P),!a){var H=D*c+I;!a&&y[H]>U&&(y[H]=U,k[H]=I,C[H]=P)}}}for(var M=0;M<c;M++)for(var z=0;z<c;z++)for(var O=z*c+M,G=0;G<c;G++){var W=z*c+G,$=M*c+G;y[O]+y[$]<y[W]&&(y[W]=y[O]+y[$],k[W]=k[O])}var X=function(Z){return(xt(Z)?r.filter(Z):Z)[0]},Q=function(Z){return m(X(Z))},V={distance:function(Z,ie){var ce=Q(Z),he=Q(ie);return y[ce*c+he]},path:function(Z,ie){var ce=Q(Z),he=Q(ie),ee=g(ce);if(ce===he)return ee.collection();if(k[ce*c+he]==null)return r.collection();var le=r.collection(),te=ce,ae;for(le.merge(ee);ce!==he;)te=ce,ce=k[ce*c+he],ae=C[te*c+ce],le.merge(ae),le.merge(g(ce));return le}};return V}},lO=Ni({weight:function(e){return 1},directed:!1,root:null}),uO={bellmanFord:function(e){var r=this,n=lO(e),i=n.weight,a=n.directed,s=n.root,o=i,l=this,u=this.cy(),c=this.byGroup(),f=c.edges,m=c.nodes,g=m.length,y=new ul,b=!1,w=[];s=u.collection(s)[0],f.unmergeBy(function(Ae){return Ae.isLoop()});for(var N=f.length,k=function(He){var tt=y.get(He.id());return tt||(tt={},y.set(He.id(),tt)),tt},C=function(He){return(xt(He)?u.$(He):He)[0]},E=function(He){return k(C(He)).dist},P=function(He){for(var tt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,Ie=C(He),ye=[],Pe=Ie;;){if(Pe==null)return r.spawn();var Be=k(Pe),Ge=Be.edge,et=Be.pred;if(ye.unshift(Pe[0]),Pe.same(tt)&&ye.length>0)break;Ge!=null&&ye.unshift(Ge),Pe=et}return l.spawn(ye)},_=0;_<g;_++){var A=m[_],I=k(A);A.same(s)?I.dist=0:I.dist=1/0,I.pred=null,I.edge=null}for(var D=!1,L=function(He,tt,Ie,ye,Pe,Be){var Ge=ye.dist+Be;Ge<Pe.dist&&!Ie.same(ye.edge)&&(Pe.dist=Ge,Pe.pred=He,Pe.edge=Ie,D=!0)},U=1;U<g;U++){D=!1;for(var H=0;H<N;H++){var M=f[H],z=M.source(),O=M.target(),G=o(M),W=k(z),$=k(O);L(z,O,M,W,$,G),a||L(O,z,M,$,W,G)}if(!D)break}if(D)for(var X=[],Q=0;Q<N;Q++){var V=f[Q],Y=V.source(),Z=V.target(),ie=o(V),ce=k(Y).dist,he=k(Z).dist;if(ce+ie<he||!a&&he+ie<ce)if(b||(lr("Graph contains a negative weight cycle for Bellman-Ford"),b=!0),e.findNegativeWeightCycles!==!1){var ee=[];ce+ie<he&&ee.push(Y),!a&&he+ie<ce&&ee.push(Z);for(var le=ee.length,te=0;te<le;te++){var ae=ee[te],oe=[ae];oe.push(k(ae).edge);for(var fe=k(ae).pred;oe.indexOf(fe)===-1;)oe.push(fe),oe.push(k(fe).edge),fe=k(fe).pred;oe=oe.slice(oe.indexOf(fe));for(var pe=oe[0].id(),Te=0,Oe=2;Oe<oe.length;Oe+=2)oe[Oe].id()<pe&&(pe=oe[Oe].id(),Te=Oe);oe=oe.slice(Te).concat(oe.slice(0,Te)),oe.push(oe[0]);var _e=oe.map(function(Ae){return Ae.id()}).join(",");X.indexOf(_e)===-1&&(w.push(l.spawn(oe)),X.push(_e))}}else break}return{distanceTo:E,pathTo:P,hasNegativeWeightCycle:b,negativeWeightCycles:w}}},cO=Math.sqrt(2),dO=function(e,r,n){n.length===0&&Hr("Karger-Stein must be run on a connected (sub)graph");for(var i=n[e],a=i[1],s=i[2],o=r[a],l=r[s],u=n,c=u.length-1;c>=0;c--){var f=u[c],m=f[1],g=f[2];(r[m]===o&&r[g]===l||r[m]===l&&r[g]===o)&&u.splice(c,1)}for(var y=0;y<u.length;y++){var b=u[y];b[1]===l?(u[y]=b.slice(),u[y][1]=o):b[2]===l&&(u[y]=b.slice(),u[y][2]=o)}for(var w=0;w<r.length;w++)r[w]===l&&(r[w]=o);return u},q1=function(e,r,n,i){for(;n>i;){var a=Math.floor(Math.random()*r.length);r=dO(a,e,r),n--}return r},fO={kargerStein:function(){var e=this,r=this.byGroup(),n=r.nodes,i=r.edges;i.unmergeBy(function($){return $.isLoop()});var a=n.length,s=i.length,o=Math.ceil(Math.pow(Math.log(a)/Math.LN2,2)),l=Math.floor(a/cO);if(a<2){Hr("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],c=0;c<s;c++){var f=i[c];u.push([c,n.indexOf(f.source()),n.indexOf(f.target())])}for(var m=1/0,g=[],y=new Array(a),b=new Array(a),w=new Array(a),N=function(X,Q){for(var V=0;V<a;V++)Q[V]=X[V]},k=0;k<=o;k++){for(var C=0;C<a;C++)b[C]=C;var E=q1(b,u.slice(),a,l),P=E.slice();N(b,w);var _=q1(b,E,l,2),A=q1(w,P,l,2);_.length<=A.length&&_.length<m?(m=_.length,g=_,N(b,y)):A.length<=_.length&&A.length<m&&(m=A.length,g=A,N(w,y))}for(var I=this.spawn(g.map(function($){return i[$[0]]})),D=this.spawn(),L=this.spawn(),U=y[0],H=0;H<y.length;H++){var M=y[H],z=n[H];M===U?D.merge(z):L.merge(z)}var O=function(X){var Q=e.spawn();return X.forEach(function(V){Q.merge(V),V.connectedEdges().forEach(function(Y){e.contains(Y)&&!I.contains(Y)&&Q.merge(Y)})}),Q},G=[O(D),O(L)],W={cut:I,components:G,partition1:D,partition2:L};return W}},W1,hO=function(e){return{x:e.x,y:e.y}},ox=function(e,r,n){return{x:e.x*r+n.x,y:e.y*r+n.y}},A6=function(e,r,n){return{x:(e.x-n.x)/r,y:(e.y-n.y)/r}},Hf=function(e){return{x:e[0],y:e[1]}},pO=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=1/0,a=r;a<n;a++){var s=e[a];isFinite(s)&&(i=Math.min(s,i))}return i},mO=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=-1/0,a=r;a<n;a++){var s=e[a];isFinite(s)&&(i=Math.max(s,i))}return i},gO=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=0,a=0,s=r;s<n;s++){var o=e[s];isFinite(o)&&(i+=o,a++)}return i/a},vO=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;i?e=e.slice(r,n):(n<e.length&&e.splice(n,e.length-n),r>0&&e.splice(0,r));for(var o=0,l=e.length-1;l>=0;l--){var u=e[l];s?isFinite(u)||(e[l]=-1/0,o++):e.splice(l,1)}a&&e.sort(function(m,g){return m-g});var c=e.length,f=Math.floor(c/2);return c%2!==0?e[f+1+o]:(e[f-1+o]+e[f+o])/2},yO=function(e){return Math.PI*e/180},Xv=function(e,r){return Math.atan2(r,e)-Math.PI/2},PS=Math.log2||function(t){return Math.log(t)/Math.log(2)},MS=function(e){return e>0?1:e<0?-1:0},cd=function(e,r){return Math.sqrt(Gc(e,r))},Gc=function(e,r){var n=r.x-e.x,i=r.y-e.y;return n*n+i*i},xO=function(e){for(var r=e.length,n=0,i=0;i<r;i++)n+=e[i];for(var a=0;a<r;a++)e[a]=e[a]/n;return e},Zn=function(e,r,n,i){return(1-i)*(1-i)*e+2*(1-i)*i*r+i*i*n},Yf=function(e,r,n,i){return{x:Zn(e.x,r.x,n.x,i),y:Zn(e.y,r.y,n.y,i)}},bO=function(e,r,n,i){var a={x:r.x-e.x,y:r.y-e.y},s=cd(e,r),o={x:a.x/s,y:a.y/s};return n=n??0,i=i??n*s,{x:e.x+o.x*i,y:e.y+o.y*i}},rg=function(e,r,n){return Math.max(e,Math.min(n,r))},ea=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},wO=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},SO=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},kO=function(e,r){e.x1=Math.min(e.x1,r.x1),e.x2=Math.max(e.x2,r.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,r.y1),e.y2=Math.max(e.y2,r.y2),e.h=e.y2-e.y1},R6=function(e,r,n){e.x1=Math.min(e.x1,r),e.x2=Math.max(e.x2,r),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},P0=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=r,e.x2+=r,e.y1-=r,e.y2+=r,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},M0=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],n,i,a,s;if(r.length===1)n=i=a=s=r[0];else if(r.length===2)n=a=r[0],s=i=r[1];else if(r.length===4){var o=Pn(r,4);n=o[0],i=o[1],a=o[2],s=o[3]}return e.x1-=s,e.x2+=i,e.y1-=n,e.y2+=a,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},g5=function(e,r){e.x1=r.x1,e.y1=r.y1,e.x2=r.x2,e.y2=r.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},_S=function(e,r){return!(e.x1>r.x2||r.x1>e.x2||e.x2<r.x1||r.x2<e.x1||e.y2<r.y1||r.y2<e.y1||e.y1>r.y2||r.y1>e.y2)},Eu=function(e,r,n){return e.x1<=r&&r<=e.x2&&e.y1<=n&&n<=e.y2},v5=function(e,r){return Eu(e,r.x,r.y)},D6=function(e,r){return Eu(e,r.x1,r.y1)&&Eu(e,r.x2,r.y2)},CO=(W1=Math.hypot)!==null&&W1!==void 0?W1:function(t,e){return Math.sqrt(t*t+e*e)};function NO(t,e){if(t.length<3)throw new Error("Need at least 3 vertices");var r=function(I,D){return{x:I.x+D.x,y:I.y+D.y}},n=function(I,D){return{x:I.x-D.x,y:I.y-D.y}},i=function(I,D){return{x:I.x*D,y:I.y*D}},a=function(I,D){return I.x*D.y-I.y*D.x},s=function(I){var D=CO(I.x,I.y);return D===0?{x:0,y:0}:{x:I.x/D,y:I.y/D}},o=function(I){for(var D=0,L=0;L<I.length;L++){var U=I[L],H=I[(L+1)%I.length];D+=U.x*H.y-H.x*U.y}return D/2},l=function(I,D,L,U){var H=n(D,I),M=n(U,L),z=a(H,M);if(Math.abs(z)<1e-9)return r(I,i(H,.5));var O=a(n(L,I),M)/z;return r(I,i(H,O))},u=t.map(function(A){return{x:A.x,y:A.y}});o(u)<0&&u.reverse();for(var c=u.length,f=[],m=0;m<c;m++){var g=u[m],y=u[(m+1)%c],b=n(y,g),w=s({x:b.y,y:-b.x});f.push(w)}for(var N=f.map(function(A,I){var D=r(u[I],i(A,e)),L=r(u[(I+1)%c],i(A,e));return{p1:D,p2:L}}),k=[],C=0;C<c;C++){var E=N[(C-1+c)%c],P=N[C],_=l(E.p1,E.p2,P.p1,P.p2);k.push(_)}return k}function EO(t,e,r,n,i,a){var s=OO(t,e,r,n,i),o=NO(s,a),l=ea();return o.forEach(function(u){return R6(l,u.x,u.y)}),l}var O6=function(e,r,n,i,a,s,o){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",u=l==="auto"?zu(a,s):l,c=a/2,f=s/2;u=Math.min(u,c,f);var m=u!==c,g=u!==f,y;if(m){var b=n-c+u-o,w=i-f-o,N=n+c-u+o,k=w;if(y=Tu(e,r,n,i,b,w,N,k,!1),y.length>0)return y}if(g){var C=n+c+o,E=i-f+u-o,P=C,_=i+f-u+o;if(y=Tu(e,r,n,i,C,E,P,_,!1),y.length>0)return y}if(m){var A=n-c+u-o,I=i+f+o,D=n+c-u+o,L=I;if(y=Tu(e,r,n,i,A,I,D,L,!1),y.length>0)return y}if(g){var U=n-c-o,H=i-f+u-o,M=U,z=i+f-u+o;if(y=Tu(e,r,n,i,U,H,M,z,!1),y.length>0)return y}var O;{var G=n-c+u,W=i-f+u;if(O=Tm(e,r,n,i,G,W,u+o),O.length>0&&O[0]<=G&&O[1]<=W)return[O[0],O[1]]}{var $=n+c-u,X=i-f+u;if(O=Tm(e,r,n,i,$,X,u+o),O.length>0&&O[0]>=$&&O[1]<=X)return[O[0],O[1]]}{var Q=n+c-u,V=i+f-u;if(O=Tm(e,r,n,i,Q,V,u+o),O.length>0&&O[0]>=Q&&O[1]>=V)return[O[0],O[1]]}{var Y=n-c+u,Z=i+f-u;if(O=Tm(e,r,n,i,Y,Z,u+o),O.length>0&&O[0]<=Y&&O[1]>=Z)return[O[0],O[1]]}return[]},TO=function(e,r,n,i,a,s,o){var l=o,u=Math.min(n,a),c=Math.max(n,a),f=Math.min(i,s),m=Math.max(i,s);return u-l<=e&&e<=c+l&&f-l<=r&&r<=m+l},jO=function(e,r,n,i,a,s,o,l,u){var c={x1:Math.min(n,o,a)-u,x2:Math.max(n,o,a)+u,y1:Math.min(i,l,s)-u,y2:Math.max(i,l,s)+u};return!(e<c.x1||e>c.x2||r<c.y1||r>c.y2)},PO=function(e,r,n,i){n-=i;var a=r*r-4*e*n;if(a<0)return[];var s=Math.sqrt(a),o=2*e,l=(-r+s)/o,u=(-r-s)/o;return[l,u]},MO=function(e,r,n,i,a){var s=1e-5;e===0&&(e=s),r/=e,n/=e,i/=e;var o,l,u,c,f,m,g,y;if(l=(3*n-r*r)/9,u=-(27*i)+r*(9*n-2*(r*r)),u/=54,o=l*l*l+u*u,a[1]=0,g=r/3,o>0){f=u+Math.sqrt(o),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),m=u-Math.sqrt(o),m=m<0?-Math.pow(-m,1/3):Math.pow(m,1/3),a[0]=-g+f+m,g+=(f+m)/2,a[4]=a[2]=-g,g=Math.sqrt(3)*(-m+f)/2,a[3]=g,a[5]=-g;return}if(a[5]=a[3]=0,o===0){y=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),a[0]=-g+2*y,a[4]=a[2]=-(y+g);return}l=-l,c=l*l*l,c=Math.acos(u/Math.sqrt(c)),y=2*Math.sqrt(l),a[0]=-g+y*Math.cos(c/3),a[2]=-g+y*Math.cos((c+2*Math.PI)/3),a[4]=-g+y*Math.cos((c+4*Math.PI)/3)},_O=function(e,r,n,i,a,s,o,l){var u=1*n*n-4*n*a+2*n*o+4*a*a-4*a*o+o*o+i*i-4*i*s+2*i*l+4*s*s-4*s*l+l*l,c=9*n*a-3*n*n-3*n*o-6*a*a+3*a*o+9*i*s-3*i*i-3*i*l-6*s*s+3*s*l,f=3*n*n-6*n*a+n*o-n*e+2*a*a+2*a*e-o*e+3*i*i-6*i*s+i*l-i*r+2*s*s+2*s*r-l*r,m=1*n*a-n*n+n*e-a*e+i*s-i*i+i*r-s*r,g=[];MO(u,c,f,m,g);for(var y=1e-7,b=[],w=0;w<6;w+=2)Math.abs(g[w+1])<y&&g[w]>=0&&g[w]<=1&&b.push(g[w]);b.push(1),b.push(0);for(var N=-1,k,C,E,P=0;P<b.length;P++)k=Math.pow(1-b[P],2)*n+2*(1-b[P])*b[P]*a+b[P]*b[P]*o,C=Math.pow(1-b[P],2)*i+2*(1-b[P])*b[P]*s+b[P]*b[P]*l,E=Math.pow(k-e,2)+Math.pow(C-r,2),N>=0?E<N&&(N=E):N=E;return N},AO=function(e,r,n,i,a,s){var o=[e-n,r-i],l=[a-n,s-i],u=l[0]*l[0]+l[1]*l[1],c=o[0]*o[0]+o[1]*o[1],f=o[0]*l[0]+o[1]*l[1],m=f*f/u;return f<0?c:m>u?(e-a)*(e-a)+(r-s)*(r-s):c-m},xa=function(e,r,n){for(var i,a,s,o,l,u=0,c=0;c<n.length/2;c++)if(i=n[c*2],a=n[c*2+1],c+1<n.length/2?(s=n[(c+1)*2],o=n[(c+1)*2+1]):(s=n[(c+1-n.length/2)*2],o=n[(c+1-n.length/2)*2+1]),!(i==e&&s==e))if(i>=e&&e>=s||i<=e&&e<=s)l=(e-i)/(s-i)*(o-a)+a,l>r&&u++;else continue;return u%2!==0},ml=function(e,r,n,i,a,s,o,l,u){var c=new Array(n.length),f;l[0]!=null?(f=Math.atan(l[1]/l[0]),l[0]<0?f=f+Math.PI/2:f=-f-Math.PI/2):f=l;for(var m=Math.cos(-f),g=Math.sin(-f),y=0;y<c.length/2;y++)c[y*2]=s/2*(n[y*2]*m-n[y*2+1]*g),c[y*2+1]=o/2*(n[y*2+1]*m+n[y*2]*g),c[y*2]+=i,c[y*2+1]+=a;var b;if(u>0){var w=ey(c,-u);b=Z0(w)}else b=c;return xa(e,r,b)},RO=function(e,r,n,i,a,s,o,l){for(var u=new Array(n.length*2),c=0;c<l.length;c++){var f=l[c];u[c*4+0]=f.startX,u[c*4+1]=f.startY,u[c*4+2]=f.stopX,u[c*4+3]=f.stopY;var m=Math.pow(f.cx-e,2)+Math.pow(f.cy-r,2);if(m<=Math.pow(f.radius,2))return!0}return xa(e,r,u)},Z0=function(e){for(var r=new Array(e.length/2),n,i,a,s,o,l,u,c,f=0;f<e.length/4;f++){n=e[f*4],i=e[f*4+1],a=e[f*4+2],s=e[f*4+3],f<e.length/4-1?(o=e[(f+1)*4],l=e[(f+1)*4+1],u=e[(f+1)*4+2],c=e[(f+1)*4+3]):(o=e[0],l=e[1],u=e[2],c=e[3]);var m=Tu(n,i,a,s,o,l,u,c,!0);r[f*2]=m[0],r[f*2+1]=m[1]}return r},ey=function(e,r){for(var n=new Array(e.length*2),i,a,s,o,l=0;l<e.length/2;l++){i=e[l*2],a=e[l*2+1],l<e.length/2-1?(s=e[(l+1)*2],o=e[(l+1)*2+1]):(s=e[0],o=e[1]);var u=o-a,c=-(s-i),f=Math.sqrt(u*u+c*c),m=u/f,g=c/f;n[l*4]=i+m*r,n[l*4+1]=a+g*r,n[l*4+2]=s+m*r,n[l*4+3]=o+g*r}return n},DO=function(e,r,n,i,a,s){var o=n-e,l=i-r;o/=a,l/=s;var u=Math.sqrt(o*o+l*l),c=u-1;if(c<0)return[];var f=c/u;return[(n-e)*f+e,(i-r)*f+r]},Yc=function(e,r,n,i,a,s,o){return e-=a,r-=s,e/=n/2+o,r/=i/2+o,e*e+r*r<=1},Tm=function(e,r,n,i,a,s,o){var l=[n-e,i-r],u=[e-a,r-s],c=l[0]*l[0]+l[1]*l[1],f=2*(u[0]*l[0]+u[1]*l[1]),m=u[0]*u[0]+u[1]*u[1]-o*o,g=f*f-4*c*m;if(g<0)return[];var y=(-f+Math.sqrt(g))/(2*c),b=(-f-Math.sqrt(g))/(2*c),w=Math.min(y,b),N=Math.max(y,b),k=[];if(w>=0&&w<=1&&k.push(w),N>=0&&N<=1&&k.push(N),k.length===0)return[];var C=k[0]*l[0]+e,E=k[0]*l[1]+r;if(k.length>1){if(k[0]==k[1])return[C,E];var P=k[1]*l[0]+e,_=k[1]*l[1]+r;return[C,E,P,_]}else return[C,E]},$1=function(e,r,n){return r<=e&&e<=n||n<=e&&e<=r?e:e<=r&&r<=n||n<=r&&r<=e?r:n},Tu=function(e,r,n,i,a,s,o,l,u){var c=e-a,f=n-e,m=o-a,g=r-s,y=i-r,b=l-s,w=m*g-b*c,N=f*g-y*c,k=b*f-m*y;if(k!==0){var C=w/k,E=N/k,P=.001,_=0-P,A=1+P;return _<=C&&C<=A&&_<=E&&E<=A?[e+C*f,r+C*y]:u?[e+C*f,r+C*y]:[]}else return w===0||N===0?$1(e,n,o)===o?[o,l]:$1(e,n,a)===a?[a,s]:$1(a,o,n)===n?[n,i]:[]:[]},OO=function(e,r,n,i,a){var s=[],o=i/2,l=a/2,u=r,c=n;s.push({x:u+o*e[0],y:c+l*e[1]});for(var f=1;f<e.length/2;f++)s.push({x:u+o*e[f*2],y:c+l*e[f*2+1]});return s},ng=function(e,r,n,i,a,s,o,l){var u=[],c,f=new Array(n.length),m=!0;s==null&&(m=!1);var g;if(m){for(var y=0;y<f.length/2;y++)f[y*2]=n[y*2]*s+i,f[y*2+1]=n[y*2+1]*o+a;if(l>0){var b=ey(f,-l);g=Z0(b)}else g=f}else g=n;for(var w,N,k,C,E=0;E<g.length/2;E++)w=g[E*2],N=g[E*2+1],E<g.length/2-1?(k=g[(E+1)*2],C=g[(E+1)*2+1]):(k=g[0],C=g[1]),c=Tu(e,r,i,a,w,N,k,C),c.length!==0&&u.push(c[0],c[1]);return u},IO=function(e,r,n,i,a,s,o,l,u){var c=[],f,m=new Array(n.length*2);u.forEach(function(k,C){C===0?(m[m.length-2]=k.startX,m[m.length-1]=k.startY):(m[C*4-2]=k.startX,m[C*4-1]=k.startY),m[C*4]=k.stopX,m[C*4+1]=k.stopY,f=Tm(e,r,i,a,k.cx,k.cy,k.radius),f.length!==0&&c.push(f[0],f[1])});for(var g=0;g<m.length/4;g++)f=Tu(e,r,i,a,m[g*4],m[g*4+1],m[g*4+2],m[g*4+3],!1),f.length!==0&&c.push(f[0],f[1]);if(c.length>2){for(var y=[c[0],c[1]],b=Math.pow(y[0]-e,2)+Math.pow(y[1]-r,2),w=1;w<c.length/2;w++){var N=Math.pow(c[w*2]-e,2)+Math.pow(c[w*2+1]-r,2);N<=b&&(y[0]=c[w*2],y[1]=c[w*2+1],b=N)}return y}return c},Qv=function(e,r,n){var i=[e[0]-r[0],e[1]-r[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=(a-n)/a;return s<0&&(s=1e-5),[r[0]+s*i[0],r[1]+s*i[1]]},Zi=function(e,r){var n=h2(e,r);return n=I6(n),n},I6=function(e){for(var r,n,i=e.length/2,a=1/0,s=1/0,o=-1/0,l=-1/0,u=0;u<i;u++)r=e[2*u],n=e[2*u+1],a=Math.min(a,r),o=Math.max(o,r),s=Math.min(s,n),l=Math.max(l,n);for(var c=2/(o-a),f=2/(l-s),m=0;m<i;m++)r=e[2*m]=e[2*m]*c,n=e[2*m+1]=e[2*m+1]*f,a=Math.min(a,r),o=Math.max(o,r),s=Math.min(s,n),l=Math.max(l,n);if(s<-1)for(var g=0;g<i;g++)n=e[2*g+1]=e[2*g+1]+(-1-s);return e},h2=function(e,r){var n=1/e*2*Math.PI,i=e%2===0?Math.PI/2+n/2:Math.PI/2;i+=r;for(var a=new Array(e*2),s,o=0;o<e;o++)s=o*n+i,a[2*o]=Math.cos(s),a[2*o+1]=Math.sin(-s);return a},zu=function(e,r){return Math.min(e/4,r/4,8)},L6=function(e,r){return Math.min(e/10,r/10,8)},AS=function(){return 8},LO=function(e,r,n){return[e-2*r+n,2*(r-e),e]},p2=function(e,r){return{heightOffset:Math.min(15,.05*r),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};function K1(t,e){function r(f){for(var m=[],g=0;g<f.length;g++){var y=f[g],b=f[(g+1)%f.length],w={x:b.x-y.x,y:b.y-y.y},N={x:-w.y,y:w.x},k=Math.sqrt(N.x*N.x+N.y*N.y);m.push({x:N.x/k,y:N.y/k})}return m}function n(f,m){var g=1/0,y=-1/0,b=wa(f),w;try{for(b.s();!(w=b.n()).done;){var N=w.value,k=N.x*m.x+N.y*m.y;g=Math.min(g,k),y=Math.max(y,k)}}catch(C){b.e(C)}finally{b.f()}return{min:g,max:y}}function i(f,m){return!(f.max<m.min||m.max<f.min)}var a=[].concat(Y0(r(t)),Y0(r(e))),s=wa(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,u=n(t,l),c=n(e,l);if(!i(u,c))return!1}}catch(f){s.e(f)}finally{s.f()}return!0}var BO=Ni({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),FO={pageRank:function(e){for(var r=BO(e),n=r.dampingFactor,i=r.precision,a=r.iterations,s=r.weight,o=this._private.cy,l=this.byGroup(),u=l.nodes,c=l.edges,f=u.length,m=f*f,g=c.length,y=new Array(m),b=new Array(f),w=(1-n)/f,N=0;N<f;N++){for(var k=0;k<f;k++){var C=N*f+k;y[C]=0}b[N]=0}for(var E=0;E<g;E++){var P=c[E],_=P.data("source"),A=P.data("target");if(_!==A){var I=u.indexOfId(_),D=u.indexOfId(A),L=s(P),U=D*f+I;y[U]+=L,b[I]+=L}}for(var H=1/f+w,M=0;M<f;M++)if(b[M]===0)for(var z=0;z<f;z++){var O=z*f+M;y[O]=H}else for(var G=0;G<f;G++){var W=G*f+M;y[W]=y[W]/b[M]+w}for(var $=new Array(f),X=new Array(f),Q,V=0;V<f;V++)$[V]=1;for(var Y=0;Y<a;Y++){for(var Z=0;Z<f;Z++)X[Z]=0;for(var ie=0;ie<f;ie++)for(var ce=0;ce<f;ce++){var he=ie*f+ce;X[ie]+=y[he]*$[ce]}xO(X),Q=$,$=X,X=Q;for(var ee=0,le=0;le<f;le++){var te=Q[le]-$[le];ee+=te*te}if(ee<i)break}var ae={rank:function(fe){return fe=o.collection(fe)[0],$[u.indexOf(fe)]}};return ae}},y5=Ni({root:null,weight:function(e){return 1},directed:!1,alpha:0}),Xf={degreeCentralityNormalized:function(e){e=y5(e);var r=this.cy(),n=this.nodes(),i=n.length;if(e.directed){for(var c={},f={},m=0,g=0,y=0;y<i;y++){var b=n[y],w=b.id();e.root=b;var N=this.degreeCentrality(e);m<N.indegree&&(m=N.indegree),g<N.outdegree&&(g=N.outdegree),c[w]=N.indegree,f[w]=N.outdegree}return{indegree:function(C){return m==0?0:(xt(C)&&(C=r.filter(C)),c[C.id()]/m)},outdegree:function(C){return g===0?0:(xt(C)&&(C=r.filter(C)),f[C.id()]/g)}}}else{for(var a={},s=0,o=0;o<i;o++){var l=n[o];e.root=l;var u=this.degreeCentrality(e);s<u.degree&&(s=u.degree),a[l.id()]=u.degree}return{degree:function(C){return s===0?0:(xt(C)&&(C=r.filter(C)),a[C.id()]/s)}}}},degreeCentrality:function(e){e=y5(e);var r=this.cy(),n=this,i=e,a=i.root,s=i.weight,o=i.directed,l=i.alpha;if(a=r.collection(a)[0],o){for(var g=a.connectedEdges(),y=g.filter(function(_){return _.target().same(a)&&n.has(_)}),b=g.filter(function(_){return _.source().same(a)&&n.has(_)}),w=y.length,N=b.length,k=0,C=0,E=0;E<y.length;E++)k+=s(y[E]);for(var P=0;P<b.length;P++)C+=s(b[P]);return{indegree:Math.pow(w,1-l)*Math.pow(k,l),outdegree:Math.pow(N,1-l)*Math.pow(C,l)}}else{for(var u=a.connectedEdges().intersection(n),c=u.length,f=0,m=0;m<u.length;m++)f+=s(u[m]);return{degree:Math.pow(c,1-l)*Math.pow(f,l)}}}};Xf.dc=Xf.degreeCentrality;Xf.dcn=Xf.degreeCentralityNormalised=Xf.degreeCentralityNormalized;var x5=Ni({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),Qf={closenessCentralityNormalized:function(e){for(var r=x5(e),n=r.harmonic,i=r.weight,a=r.directed,s=this.cy(),o={},l=0,u=this.nodes(),c=this.floydWarshall({weight:i,directed:a}),f=0;f<u.length;f++){for(var m=0,g=u[f],y=0;y<u.length;y++)if(f!==y){var b=c.distance(g,u[y]);n?m+=1/b:m+=b}n||(m=1/m),l<m&&(l=m),o[g.id()]=m}return{closeness:function(N){return l==0?0:(xt(N)?N=s.filter(N)[0].id():N=N.id(),o[N]/l)}}},closenessCentrality:function(e){var r=x5(e),n=r.root,i=r.weight,a=r.directed,s=r.harmonic;n=this.filter(n)[0];for(var o=this.dijkstra({root:n,weight:i,directed:a}),l=0,u=this.nodes(),c=0;c<u.length;c++){var f=u[c];if(!f.same(n)){var m=o.distanceTo(f);s?l+=1/m:l+=m}}return s?l:1/l}};Qf.cc=Qf.closenessCentrality;Qf.ccn=Qf.closenessCentralityNormalised=Qf.closenessCentralityNormalized;var zO=Ni({weight:null,directed:!1}),m2={betweennessCentrality:function(e){for(var r=zO(e),n=r.directed,i=r.weight,a=i!=null,s=this.cy(),o=this.nodes(),l={},u={},c=0,f={set:function(C,E){u[C]=E,E>c&&(c=E)},get:function(C){return u[C]}},m=0;m<o.length;m++){var g=o[m],y=g.id();n?l[y]=g.outgoers().nodes():l[y]=g.openNeighborhood().nodes(),f.set(y,0)}for(var b=function(){for(var C=o[w].id(),E=[],P={},_={},A={},I=new _g(function(ie,ce){return A[ie]-A[ce]}),D=0;D<o.length;D++){var L=o[D].id();P[L]=[],_[L]=0,A[L]=1/0}for(_[C]=1,A[C]=0,I.push(C);!I.empty();){var U=I.pop();if(E.push(U),a)for(var H=0;H<l[U].length;H++){var M=l[U][H],z=s.getElementById(U),O=void 0;z.edgesTo(M).length>0?O=z.edgesTo(M)[0]:O=M.edgesTo(z)[0];var G=i(O);M=M.id(),A[M]>A[U]+G&&(A[M]=A[U]+G,I.nodes.indexOf(M)<0?I.push(M):I.updateItem(M),_[M]=0,P[M]=[]),A[M]==A[U]+G&&(_[M]=_[M]+_[U],P[M].push(U))}else for(var W=0;W<l[U].length;W++){var $=l[U][W].id();A[$]==1/0&&(I.push($),A[$]=A[U]+1),A[$]==A[U]+1&&(_[$]=_[$]+_[U],P[$].push(U))}}for(var X={},Q=0;Q<o.length;Q++)X[o[Q].id()]=0;for(;E.length>0;){for(var V=E.pop(),Y=0;Y<P[V].length;Y++){var Z=P[V][Y];X[Z]=X[Z]+_[Z]/_[V]*(1+X[V])}V!=o[w].id()&&f.set(V,f.get(V)+X[V])}},w=0;w<o.length;w++)b();var N={betweenness:function(C){var E=s.collection(C).id();return f.get(E)},betweennessNormalized:function(C){if(c==0)return 0;var E=s.collection(C).id();return f.get(E)/c}};return N.betweennessNormalised=N.betweennessNormalized,N}};m2.bc=m2.betweennessCentrality;var VO=Ni({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(t){return 1}]}),UO=function(e){return VO(e)},GO=function(e,r){for(var n=0,i=0;i<r.length;i++)n+=r[i](e);return n},HO=function(e,r,n){for(var i=0;i<r;i++)e[i*r+i]=n},B6=function(e,r){for(var n,i=0;i<r;i++){n=0;for(var a=0;a<r;a++)n+=e[a*r+i];for(var s=0;s<r;s++)e[s*r+i]=e[s*r+i]/n}},qO=function(e,r,n){for(var i=new Array(n*n),a=0;a<n;a++){for(var s=0;s<n;s++)i[a*n+s]=0;for(var o=0;o<n;o++)for(var l=0;l<n;l++)i[a*n+l]+=e[a*n+o]*r[o*n+l]}return i},WO=function(e,r,n){for(var i=e.slice(0),a=1;a<n;a++)e=qO(e,i,r);return e},$O=function(e,r,n){for(var i=new Array(r*r),a=0;a<r*r;a++)i[a]=Math.pow(e[a],n);return B6(i,r),i},KO=function(e,r,n,i){for(var a=0;a<n;a++){var s=Math.round(e[a]*Math.pow(10,i))/Math.pow(10,i),o=Math.round(r[a]*Math.pow(10,i))/Math.pow(10,i);if(s!==o)return!1}return!0},YO=function(e,r,n,i){for(var a=[],s=0;s<r;s++){for(var o=[],l=0;l<r;l++)Math.round(e[s*r+l]*1e3)/1e3>0&&o.push(n[l]);o.length!==0&&a.push(i.collection(o))}return a},XO=function(e,r){for(var n=0;n<e.length;n++)if(!r[n]||e[n].id()!==r[n].id())return!1;return!0},QO=function(e){for(var r=0;r<e.length;r++)for(var n=0;n<e.length;n++)r!=n&&XO(e[r],e[n])&&e.splice(n,1);return e},b5=function(e){for(var r=this.nodes(),n=this.edges(),i=this.cy(),a=UO(e),s={},o=0;o<r.length;o++)s[r[o].id()]=o;for(var l=r.length,u=l*l,c=new Array(u),f,m=0;m<u;m++)c[m]=0;for(var g=0;g<n.length;g++){var y=n[g],b=s[y.source().id()],w=s[y.target().id()],N=GO(y,a.attributes);c[b*l+w]+=N,c[w*l+b]+=N}HO(c,l,a.multFactor),B6(c,l);for(var k=!0,C=0;k&&C<a.maxIterations;)k=!1,f=WO(c,l,a.expandFactor),c=$O(f,l,a.inflateFactor),KO(c,f,u,4)||(k=!0),C++;var E=YO(c,l,r,i);return E=QO(E),E},JO={markovClustering:b5,mcl:b5},ZO=function(e){return e},F6=function(e,r){return Math.abs(r-e)},w5=function(e,r,n){return e+F6(r,n)},S5=function(e,r,n){return e+Math.pow(n-r,2)},e9=function(e){return Math.sqrt(e)},t9=function(e,r,n){return Math.max(e,F6(r,n))},Cp=function(e,r,n,i,a){for(var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:ZO,o=i,l,u,c=0;c<e;c++)l=r(c),u=n(c),o=a(o,l,u);return s(o)},nh={euclidean:function(e,r,n){return e>=2?Cp(e,r,n,0,S5,e9):Cp(e,r,n,0,w5)},squaredEuclidean:function(e,r,n){return Cp(e,r,n,0,S5)},manhattan:function(e,r,n){return Cp(e,r,n,0,w5)},max:function(e,r,n){return Cp(e,r,n,-1/0,t9)}};nh["squared-euclidean"]=nh.squaredEuclidean;nh.squaredeuclidean=nh.squaredEuclidean;function lx(t,e,r,n,i,a){var s;return Qr(t)?s=t:s=nh[t]||nh.euclidean,e===0&&Qr(t)?s(i,a):s(e,r,n,i,a)}var r9=Ni({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),RS=function(e){return r9(e)},ty=function(e,r,n,i,a){var s=a!=="kMedoids",o=s?function(f){return n[f]}:function(f){return i[f](n)},l=function(m){return i[m](r)},u=n,c=r;return lx(e,i.length,o,l,u,c)},Y1=function(e,r,n){for(var i=n.length,a=new Array(i),s=new Array(i),o=new Array(r),l=null,u=0;u<i;u++)a[u]=e.min(n[u]).value,s[u]=e.max(n[u]).value;for(var c=0;c<r;c++){l=[];for(var f=0;f<i;f++)l[f]=Math.random()*(s[f]-a[f])+a[f];o[c]=l}return o},z6=function(e,r,n,i,a){for(var s=1/0,o=0,l=0;l<r.length;l++){var u=ty(n,e,r[l],i,a);u<s&&(s=u,o=l)}return o},V6=function(e,r,n){for(var i=[],a=null,s=0;s<r.length;s++)a=r[s],n[a.id()]===e&&i.push(a);return i},n9=function(e,r,n){return Math.abs(r-e)<=n},i9=function(e,r,n){for(var i=0;i<e.length;i++)for(var a=0;a<e[i].length;a++){var s=Math.abs(e[i][a]-r[i][a]);if(s>n)return!1}return!0},a9=function(e,r,n){for(var i=0;i<n;i++)if(e===r[i])return!0;return!1},k5=function(e,r){var n=new Array(r);if(e.length<50)for(var i=0;i<r;i++){for(var a=e[Math.floor(Math.random()*e.length)];a9(a,n,i);)a=e[Math.floor(Math.random()*e.length)];n[i]=a}else for(var s=0;s<r;s++)n[s]=e[Math.floor(Math.random()*e.length)];return n},C5=function(e,r,n){for(var i=0,a=0;a<r.length;a++)i+=ty("manhattan",r[a],e,n,"kMedoids");return i},s9=function(e){var r=this.cy(),n=this.nodes(),i=null,a=RS(e),s=new Array(a.k),o={},l;a.testMode?typeof a.testCentroids=="number"?(a.testCentroids,l=Y1(n,a.k,a.attributes)):Vn(a.testCentroids)==="object"?l=a.testCentroids:l=Y1(n,a.k,a.attributes):l=Y1(n,a.k,a.attributes);for(var u=!0,c=0;u&&c<a.maxIterations;){for(var f=0;f<n.length;f++)i=n[f],o[i.id()]=z6(i,l,a.distance,a.attributes,"kMeans");u=!1;for(var m=0;m<a.k;m++){var g=V6(m,n,o);if(g.length!==0){for(var y=a.attributes.length,b=l[m],w=new Array(y),N=new Array(y),k=0;k<y;k++){N[k]=0;for(var C=0;C<g.length;C++)i=g[C],N[k]+=a.attributes[k](i);w[k]=N[k]/g.length,n9(w[k],b[k],a.sensitivityThreshold)||(u=!0)}l[m]=w,s[m]=r.collection(g)}}c++}return s},o9=function(e){var r=this.cy(),n=this.nodes(),i=null,a=RS(e),s=new Array(a.k),o,l={},u,c=new Array(a.k);a.testMode?typeof a.testCentroids=="number"||(Vn(a.testCentroids)==="object"?o=a.testCentroids:o=k5(n,a.k)):o=k5(n,a.k);for(var f=!0,m=0;f&&m<a.maxIterations;){for(var g=0;g<n.length;g++)i=n[g],l[i.id()]=z6(i,o,a.distance,a.attributes,"kMedoids");f=!1;for(var y=0;y<o.length;y++){var b=V6(y,n,l);if(b.length!==0){c[y]=C5(o[y],b,a.attributes);for(var w=0;w<b.length;w++)u=C5(b[w],b,a.attributes),u<c[y]&&(c[y]=u,o[y]=b[w],f=!0);s[y]=r.collection(b)}}m++}return s},l9=function(e,r,n,i,a){for(var s,o,l=0;l<r.length;l++)for(var u=0;u<e.length;u++)i[l][u]=Math.pow(n[l][u],a.m);for(var c=0;c<e.length;c++)for(var f=0;f<a.attributes.length;f++){s=0,o=0;for(var m=0;m<r.length;m++)s+=i[m][c]*a.attributes[f](r[m]),o+=i[m][c];e[c][f]=s/o}},u9=function(e,r,n,i,a){for(var s=0;s<e.length;s++)r[s]=e[s].slice();for(var o,l,u,c=2/(a.m-1),f=0;f<n.length;f++)for(var m=0;m<i.length;m++){o=0;for(var g=0;g<n.length;g++)l=ty(a.distance,i[m],n[f],a.attributes,"cmeans"),u=ty(a.distance,i[m],n[g],a.attributes,"cmeans"),o+=Math.pow(l/u,c);e[m][f]=1/o}},c9=function(e,r,n,i){for(var a=new Array(n.k),s=0;s<a.length;s++)a[s]=[];for(var o,l,u=0;u<r.length;u++){o=-1/0,l=-1;for(var c=0;c<r[0].length;c++)r[u][c]>o&&(o=r[u][c],l=c);a[l].push(e[u])}for(var f=0;f<a.length;f++)a[f]=i.collection(a[f]);return a},N5=function(e){var r=this.cy(),n=this.nodes(),i=RS(e),a,s,o,l,u;l=new Array(n.length);for(var c=0;c<n.length;c++)l[c]=new Array(i.k);o=new Array(n.length);for(var f=0;f<n.length;f++)o[f]=new Array(i.k);for(var m=0;m<n.length;m++){for(var g=0,y=0;y<i.k;y++)o[m][y]=Math.random(),g+=o[m][y];for(var b=0;b<i.k;b++)o[m][b]=o[m][b]/g}s=new Array(i.k);for(var w=0;w<i.k;w++)s[w]=new Array(i.attributes.length);u=new Array(n.length);for(var N=0;N<n.length;N++)u[N]=new Array(i.k);for(var k=!0,C=0;k&&C<i.maxIterations;)k=!1,l9(s,n,o,u,i),u9(o,l,s,n,i),i9(o,l,i.sensitivityThreshold)||(k=!0),C++;return a=c9(n,o,i,r),{clusters:a,degreeOfMembership:o}},d9={kMeans:s9,kMedoids:o9,fuzzyCMeans:N5,fcm:N5},f9=Ni({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),h9={single:"min",complete:"max"},p9=function(e){var r=f9(e),n=h9[r.linkage];return n!=null&&(r.linkage=n),r},E5=function(e,r,n,i,a){for(var s=0,o=1/0,l,u=a.attributes,c=function(D,L){return lx(a.distance,u.length,function(U){return u[U](D)},function(U){return u[U](L)},D,L)},f=0;f<e.length;f++){var m=e[f].key,g=n[m][i[m]];g<o&&(s=m,o=g)}if(a.mode==="threshold"&&o>=a.threshold||a.mode==="dendrogram"&&e.length===1)return!1;var y=r[s],b=r[i[s]],w;a.mode==="dendrogram"?w={left:y,right:b,key:y.key}:w={value:y.value.concat(b.value),key:y.key},e[y.index]=w,e.splice(b.index,1),r[y.key]=w;for(var N=0;N<e.length;N++){var k=e[N];y.key===k.key?l=1/0:a.linkage==="min"?(l=n[y.key][k.key],n[y.key][k.key]>n[b.key][k.key]&&(l=n[b.key][k.key])):a.linkage==="max"?(l=n[y.key][k.key],n[y.key][k.key]<n[b.key][k.key]&&(l=n[b.key][k.key])):a.linkage==="mean"?l=(n[y.key][k.key]*y.size+n[b.key][k.key]*b.size)/(y.size+b.size):a.mode==="dendrogram"?l=c(k.value,y.value):l=c(k.value[0],y.value[0]),n[y.key][k.key]=n[k.key][y.key]=l}for(var C=0;C<e.length;C++){var E=e[C].key;if(i[E]===y.key||i[E]===b.key){for(var P=E,_=0;_<e.length;_++){var A=e[_].key;n[E][A]<n[E][P]&&(P=A)}i[E]=P}e[C].index=C}return y.key=b.key=y.index=b.index=null,!0},qf=function(e,r,n){e&&(e.value?r.push(e.value):(e.left&&qf(e.left,r),e.right&&qf(e.right,r)))},g2=function(e,r){if(!e)return"";if(e.left&&e.right){var n=g2(e.left,r),i=g2(e.right,r),a=r.add({group:"nodes",data:{id:n+","+i}});return r.add({group:"edges",data:{source:n,target:a.id()}}),r.add({group:"edges",data:{source:i,target:a.id()}}),a.id()}else if(e.value)return e.value.id()},v2=function(e,r,n){if(!e)return[];var i=[],a=[],s=[];return r===0?(e.left&&qf(e.left,i),e.right&&qf(e.right,a),s=i.concat(a),[n.collection(s)]):r===1?e.value?[n.collection(e.value)]:(e.left&&qf(e.left,i),e.right&&qf(e.right,a),[n.collection(i),n.collection(a)]):e.value?[n.collection(e.value)]:(e.left&&(i=v2(e.left,r-1,n)),e.right&&(a=v2(e.right,r-1,n)),i.concat(a))},T5=function(e){for(var r=this.cy(),n=this.nodes(),i=p9(e),a=i.attributes,s=function(C,E){return lx(i.distance,a.length,function(P){return a[P](C)},function(P){return a[P](E)},C,E)},o=[],l=[],u=[],c=[],f=0;f<n.length;f++){var m={value:i.mode==="dendrogram"?n[f]:[n[f]],key:f,index:f};o[f]=m,c[f]=m,l[f]=[],u[f]=0}for(var g=0;g<o.length;g++)for(var y=0;y<=g;y++){var b=void 0;i.mode==="dendrogram"?b=g===y?1/0:s(o[g].value,o[y].value):b=g===y?1/0:s(o[g].value[0],o[y].value[0]),l[g][y]=b,l[y][g]=b,b<l[g][u[g]]&&(u[g]=y)}for(var w=E5(o,c,l,u,i);w;)w=E5(o,c,l,u,i);var N;return i.mode==="dendrogram"?(N=v2(o[0],i.dendrogramDepth,r),i.addDendrogram&&g2(o[0],r)):(N=new Array(o.length),o.forEach(function(k,C){k.key=k.index=null,N[C]=r.collection(k.value)})),N},m9={hierarchicalClustering:T5,hca:T5},g9=Ni({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),v9=function(e){var r=e.damping,n=e.preference;.5<=r&&r<1||Hr("Damping must range on [0.5, 1).  Got: ".concat(r));var i=["median","mean","min","max"];return i.some(function(a){return a===n})||Qe(n)||Hr("Preference must be one of [".concat(i.map(function(a){return"'".concat(a,"'")}).join(", "),"] or a number.  Got: ").concat(n)),g9(e)},y9=function(e,r,n,i){var a=function(o,l){return i[l](o)};return-lx(e,i.length,function(s){return a(r,s)},function(s){return a(n,s)},r,n)},x9=function(e,r){var n=null;return r==="median"?n=vO(e):r==="mean"?n=gO(e):r==="min"?n=pO(e):r==="max"?n=mO(e):n=r,n},b9=function(e,r,n){for(var i=[],a=0;a<e;a++)r[a*e+a]+n[a*e+a]>0&&i.push(a);return i},j5=function(e,r,n){for(var i=[],a=0;a<e;a++){for(var s=-1,o=-1/0,l=0;l<n.length;l++){var u=n[l];r[a*e+u]>o&&(s=u,o=r[a*e+u])}s>0&&i.push(s)}for(var c=0;c<n.length;c++)i[n[c]]=n[c];return i},w9=function(e,r,n){for(var i=j5(e,r,n),a=0;a<n.length;a++){for(var s=[],o=0;o<i.length;o++)i[o]===n[a]&&s.push(o);for(var l=-1,u=-1/0,c=0;c<s.length;c++){for(var f=0,m=0;m<s.length;m++)f+=r[s[m]*e+s[c]];f>u&&(l=c,u=f)}n[a]=s[l]}return i=j5(e,r,n),i},P5=function(e){for(var r=this.cy(),n=this.nodes(),i=v9(e),a={},s=0;s<n.length;s++)a[n[s].id()]=s;var o,l,u,c,f,m;o=n.length,l=o*o,u=new Array(l);for(var g=0;g<l;g++)u[g]=-1/0;for(var y=0;y<o;y++)for(var b=0;b<o;b++)y!==b&&(u[y*o+b]=y9(i.distance,n[y],n[b],i.attributes));c=x9(u,i.preference);for(var w=0;w<o;w++)u[w*o+w]=c;f=new Array(l);for(var N=0;N<l;N++)f[N]=0;m=new Array(l);for(var k=0;k<l;k++)m[k]=0;for(var C=new Array(o),E=new Array(o),P=new Array(o),_=0;_<o;_++)C[_]=0,E[_]=0,P[_]=0;for(var A=new Array(o*i.minIterations),I=0;I<A.length;I++)A[I]=0;var D;for(D=0;D<i.maxIterations;D++){for(var L=0;L<o;L++){for(var U=-1/0,H=-1/0,M=-1,z=0,O=0;O<o;O++)C[O]=f[L*o+O],z=m[L*o+O]+u[L*o+O],z>=U?(H=U,U=z,M=O):z>H&&(H=z);for(var G=0;G<o;G++)f[L*o+G]=(1-i.damping)*(u[L*o+G]-U)+i.damping*C[G];f[L*o+M]=(1-i.damping)*(u[L*o+M]-H)+i.damping*C[M]}for(var W=0;W<o;W++){for(var $=0,X=0;X<o;X++)C[X]=m[X*o+W],E[X]=Math.max(0,f[X*o+W]),$+=E[X];$-=E[W],E[W]=f[W*o+W],$+=E[W];for(var Q=0;Q<o;Q++)m[Q*o+W]=(1-i.damping)*Math.min(0,$-E[Q])+i.damping*C[Q];m[W*o+W]=(1-i.damping)*($-E[W])+i.damping*C[W]}for(var V=0,Y=0;Y<o;Y++){var Z=m[Y*o+Y]+f[Y*o+Y]>0?1:0;A[D%i.minIterations*o+Y]=Z,V+=Z}if(V>0&&(D>=i.minIterations-1||D==i.maxIterations-1)){for(var ie=0,ce=0;ce<o;ce++){P[ce]=0;for(var he=0;he<i.minIterations;he++)P[ce]+=A[he*o+ce];(P[ce]===0||P[ce]===i.minIterations)&&ie++}if(ie===o)break}}for(var ee=b9(o,f,m),le=w9(o,u,ee),te={},ae=0;ae<ee.length;ae++)te[ee[ae]]=[];for(var oe=0;oe<n.length;oe++){var fe=a[n[oe].id()],pe=le[fe];pe!=null&&te[pe].push(n[oe])}for(var Te=new Array(ee.length),Oe=0;Oe<ee.length;Oe++)Te[Oe]=r.collection(te[ee[Oe]]);return Te},S9={affinityPropagation:P5,ap:P5},k9=Ni({root:void 0,directed:!1}),C9={hierholzer:function(e){if(!Zt(e)){var r=arguments;e={root:r[0],directed:r[1]}}var n=k9(e),i=n.root,a=n.directed,s=this,o=!1,l,u,c;i&&(c=xt(i)?this.filter(i)[0].id():i[0].id());var f={},m={};a?s.forEach(function(k){var C=k.id();if(k.isNode()){var E=k.indegree(!0),P=k.outdegree(!0),_=E-P,A=P-E;_==1?l?o=!0:l=C:A==1?u?o=!0:u=C:(A>1||_>1)&&(o=!0),f[C]=[],k.outgoers().forEach(function(I){I.isEdge()&&f[C].push(I.id())})}else m[C]=[void 0,k.target().id()]}):s.forEach(function(k){var C=k.id();if(k.isNode()){var E=k.degree(!0);E%2&&(l?u?o=!0:u=C:l=C),f[C]=[],k.connectedEdges().forEach(function(P){return f[C].push(P.id())})}else m[C]=[k.source().id(),k.target().id()]});var g={found:!1,trail:void 0};if(o)return g;if(u&&l)if(a){if(c&&u!=c)return g;c=u}else{if(c&&u!=c&&l!=c)return g;c||(c=u)}else c||(c=s[0].id());var y=function(C){for(var E=C,P=[C],_,A,I;f[E].length;)_=f[E].shift(),A=m[_][0],I=m[_][1],E!=I?(f[I]=f[I].filter(function(D){return D!=_}),E=I):!a&&E!=A&&(f[A]=f[A].filter(function(D){return D!=_}),E=A),P.unshift(_),P.unshift(E);return P},b=[],w=[];for(w=y(c);w.length!=1;)f[w[0]].length==0?(b.unshift(s.getElementById(w.shift())),b.unshift(s.getElementById(w.shift()))):w=y(w.shift()).concat(w);b.unshift(s.getElementById(w.shift()));for(var N in f)if(f[N].length)return g;return g.found=!0,g.trail=this.spawn(b,!0),g}},Jv=function(){var e=this,r={},n=0,i=0,a=[],s=[],o={},l=function(m,g){for(var y=s.length-1,b=[],w=e.spawn();s[y].x!=m||s[y].y!=g;)b.push(s.pop().edge),y--;b.push(s.pop().edge),b.forEach(function(N){var k=N.connectedNodes().intersection(e);w.merge(N),k.forEach(function(C){var E=C.id(),P=C.connectedEdges().intersection(e);w.merge(C),r[E].cutVertex?w.merge(P.filter(function(_){return _.isLoop()})):w.merge(P)})}),a.push(w)},u=function(m,g,y){m===y&&(i+=1),r[g]={id:n,low:n++,cutVertex:!1};var b=e.getElementById(g).connectedEdges().intersection(e);if(b.size()===0)a.push(e.spawn(e.getElementById(g)));else{var w,N,k,C;b.forEach(function(E){w=E.source().id(),N=E.target().id(),k=w===g?N:w,k!==y&&(C=E.id(),o[C]||(o[C]=!0,s.push({x:g,y:k,edge:E})),k in r?r[g].low=Math.min(r[g].low,r[k].id):(u(m,k,g),r[g].low=Math.min(r[g].low,r[k].low),r[g].id<=r[k].low&&(r[g].cutVertex=!0,l(g,k))))})}};e.forEach(function(f){if(f.isNode()){var m=f.id();m in r||(i=0,u(m,m),r[m].cutVertex=i>1)}});var c=Object.keys(r).filter(function(f){return r[f].cutVertex}).map(function(f){return e.getElementById(f)});return{cut:e.spawn(c),components:a}},N9={hopcroftTarjanBiconnected:Jv,htbc:Jv,htb:Jv,hopcroftTarjanBiconnectedComponents:Jv},Zv=function(){var e=this,r={},n=0,i=[],a=[],s=e.spawn(e),o=function(u){a.push(u),r[u]={index:n,low:n++,explored:!1};var c=e.getElementById(u).connectedEdges().intersection(e);if(c.forEach(function(b){var w=b.target().id();w!==u&&(w in r||o(w),r[w].explored||(r[u].low=Math.min(r[u].low,r[w].low)))}),r[u].index===r[u].low){for(var f=e.spawn();;){var m=a.pop();if(f.merge(e.getElementById(m)),r[m].low=r[u].index,r[m].explored=!0,m===u)break}var g=f.edgesWith(f),y=f.merge(g);i.push(y),s=s.difference(y)}};return e.forEach(function(l){if(l.isNode()){var u=l.id();u in r||o(u)}}),{cut:s,components:i}},E9={tarjanStronglyConnected:Zv,tsc:Zv,tscc:Zv,tarjanStronglyConnectedComponents:Zv},U6={};[tg,rO,nO,aO,oO,uO,fO,FO,Xf,Qf,m2,JO,d9,m9,S9,C9,N9,E9].forEach(function(t){Ct(U6,t)});var G6=0,H6=1,q6=2,Fs=function(e){if(!(this instanceof Fs))return new Fs(e);this.id="Thenable/1.0.7",this.state=G6,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};Fs.prototype={fulfill:function(e){return M5(this,H6,"fulfillValue",e)},reject:function(e){return M5(this,q6,"rejectReason",e)},then:function(e,r){var n=this,i=new Fs;return n.onFulfilled.push(A5(e,i,"fulfill")),n.onRejected.push(A5(r,i,"reject")),W6(n),i.proxy}};var M5=function(e,r,n,i){return e.state===G6&&(e.state=r,e[n]=i,W6(e)),e},W6=function(e){e.state===H6?_5(e,"onFulfilled",e.fulfillValue):e.state===q6&&_5(e,"onRejected",e.rejectReason)},_5=function(e,r,n){if(e[r].length!==0){var i=e[r];e[r]=[];var a=function(){for(var o=0;o<i.length;o++)i[o](n)};typeof setImmediate=="function"?setImmediate(a):setTimeout(a,0)}},A5=function(e,r,n){return function(i){if(typeof e!="function")r[n].call(r,i);else{var a;try{a=e(i)}catch(s){r.reject(s);return}$6(r,a)}}},$6=function(e,r){if(e===r||e.proxy===r){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(Vn(r)==="object"&&r!==null||typeof r=="function")try{n=r.then}catch(a){e.reject(a);return}if(typeof n=="function"){var i=!1;try{n.call(r,function(a){i||(i=!0,a===r?e.reject(new TypeError("circular thenable chain")):$6(e,a))},function(a){i||(i=!0,e.reject(a))})}catch(a){i||e.reject(a)}return}e.fulfill(r)};Fs.all=function(t){return new Fs(function(e,r){for(var n=new Array(t.length),i=0,a=function(l,u){n[l]=u,i++,i===t.length&&e(n)},s=0;s<t.length;s++)(function(o){var l=t[o],u=l!=null&&l.then!=null;if(u)l.then(function(f){a(o,f)},function(f){r(f)});else{var c=l;a(o,c)}})(s)})};Fs.resolve=function(t){return new Fs(function(e,r){e(t)})};Fs.reject=function(t){return new Fs(function(e,r){r(t)})};var wh=typeof Promise<"u"?Promise:Fs,y2=function(e,r,n){var i=kS(e),a=!i,s=this._private=Ct({duration:1e3},r,n);if(s.target=e,s.style=s.style||s.css,s.started=!1,s.playing=!1,s.hooked=!1,s.applying=!1,s.progress=0,s.completes=[],s.frames=[],s.complete&&Qr(s.complete)&&s.completes.push(s.complete),a){var o=e.position();s.startPosition=s.startPosition||{x:o.x,y:o.y},s.startStyle=s.startStyle||e.cy().style().getAnimationStartStyle(e,s.style)}if(i){var l=e.pan();s.startPan={x:l.x,y:l.y},s.startZoom=e.zoom()}this.length=1,this[0]=this},dd=y2.prototype;Ct(dd,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var r,n=e.target._private.animation;e.queue?r=n.queue:r=n.current,r.push(this),Fa(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var r=this._private;return e===void 0?r.progress*r.duration:this.progress(e/r.duration)},progress:function(e){var r=this._private,n=r.playing;return e===void 0?r.progress:(n&&this.pause(),r.progress=e,r.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,r=e.playing;r&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(u,c){var f=e[u];f!=null&&(e[u]=e[c],e[c]=f)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var i=0;i<e.style.length;i++){var a=e.style[i],s=a.name,o=e.startStyle[s];e.startStyle[s]=a,e.style[i]=o}return r&&this.play(),this},promise:function(e){var r=this._private,n;switch(e){case"frame":n=r.frames;break;default:case"complete":case"completed":n=r.completes}return new wh(function(i,a){n.push(function(){i()})})}});dd.complete=dd.completed;dd.run=dd.play;dd.running=dd.playing;var T9={animated:function(){return function(){var r=this,n=r.length!==void 0,i=n?r:[r],a=this._private.cy||this;if(!a.styleEnabled())return!1;var s=i[0];if(s)return s._private.animation.current.length>0}},clearQueue:function(){return function(){var r=this,n=r.length!==void 0,i=n?r:[r],a=this._private.cy||this;if(!a.styleEnabled())return this;for(var s=0;s<i.length;s++){var o=i[s];o._private.animation.queue=[]}return this}},delay:function(){return function(r,n){var i=this._private.cy||this;return i.styleEnabled()?this.animate({delay:r,duration:r,complete:n}):this}},delayAnimation:function(){return function(r,n){var i=this._private.cy||this;return i.styleEnabled()?this.animation({delay:r,duration:r,complete:n}):this}},animation:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this,l=!a,u=!l;if(!o.styleEnabled())return this;var c=o.style();r=Ct({},r,n);var f=Object.keys(r).length===0;if(f)return new y2(s[0],r);switch(r.duration===void 0&&(r.duration=400),r.duration){case"slow":r.duration=600;break;case"fast":r.duration=200;break}if(u&&(r.style=c.getPropsList(r.style||r.css),r.css=void 0),u&&r.renderedPosition!=null){var m=r.renderedPosition,g=o.pan(),y=o.zoom();r.position=A6(m,y,g)}if(l&&r.panBy!=null){var b=r.panBy,w=o.pan();r.pan={x:w.x+b.x,y:w.y+b.y}}var N=r.center||r.centre;if(l&&N!=null){var k=o.getCenterPan(N.eles,r.zoom);k!=null&&(r.pan=k)}if(l&&r.fit!=null){var C=r.fit,E=o.getFitViewport(C.eles||C.boundingBox,C.padding);E!=null&&(r.pan=E.pan,r.zoom=E.zoom)}if(l&&Zt(r.zoom)){var P=o.getZoomedViewport(r.zoom);P!=null?(P.zoomed&&(r.zoom=P.zoom),P.panned&&(r.pan=P.pan)):r.zoom=null}return new y2(s[0],r)}},animate:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;n&&(r=Ct({},r,n));for(var l=0;l<s.length;l++){var u=s[l],c=u.animated()&&(r.queue===void 0||r.queue),f=u.animation(r,c?{queue:!0}:void 0);f.play()}return this}},stop:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;for(var l=0;l<s.length;l++){for(var u=s[l],c=u._private,f=c.animation.current,m=0;m<f.length;m++){var g=f[m],y=g._private;n&&(y.duration=0)}r&&(c.animation.queue=[]),n||(c.animation.current=[])}return o.notify("draw"),this}}},X1,R5;function ux(){if(R5)return X1;R5=1;var t=Array.isArray;return X1=t,X1}var Q1,D5;function j9(){if(D5)return Q1;D5=1;var t=ux(),e=Pg(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(t(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return Q1=i,Q1}var J1,O5;function P9(){if(O5)return J1;O5=1;var t=k6(),e=jg(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var l=t(o);return l==n||l==i||l==r||l==a}return J1=s,J1}var Z1,I5;function M9(){if(I5)return Z1;I5=1;var t=ax(),e=t["__core-js_shared__"];return Z1=e,Z1}var eb,L5;function _9(){if(L5)return eb;L5=1;var t=M9(),e=(function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!e&&e in n}return eb=r,eb}var tb,B5;function A9(){if(B5)return tb;B5=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return tb=r,tb}var rb,F5;function R9(){if(F5)return rb;F5=1;var t=P9(),e=_9(),r=jg(),n=A9(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,u=o.hasOwnProperty,c=RegExp("^"+l.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(m){if(!r(m)||e(m))return!1;var g=t(m)?c:a;return g.test(n(m))}return rb=f,rb}var nb,z5;function D9(){if(z5)return nb;z5=1;function t(e,r){return e?.[r]}return nb=t,nb}var ib,V5;function DS(){if(V5)return ib;V5=1;var t=R9(),e=D9();function r(n,i){var a=e(n,i);return t(a)?a:void 0}return ib=r,ib}var ab,U5;function cx(){if(U5)return ab;U5=1;var t=DS(),e=t(Object,"create");return ab=e,ab}var sb,G5;function O9(){if(G5)return sb;G5=1;var t=cx();function e(){this.__data__=t?t(null):{},this.size=0}return sb=e,sb}var ob,H5;function I9(){if(H5)return ob;H5=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return ob=t,ob}var lb,q5;function L9(){if(q5)return lb;q5=1;var t=cx(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(t){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return lb=i,lb}var ub,W5;function B9(){if(W5)return ub;W5=1;var t=cx(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var a=this.__data__;return t?a[i]!==void 0:r.call(a,i)}return ub=n,ub}var cb,$5;function F9(){if($5)return cb;$5=1;var t=cx(),e="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=t&&i===void 0?e:i,this}return cb=r,cb}var db,K5;function z9(){if(K5)return db;K5=1;var t=O9(),e=I9(),r=L9(),n=B9(),i=F9();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,db=a,db}var fb,Y5;function V9(){if(Y5)return fb;Y5=1;function t(){this.__data__=[],this.size=0}return fb=t,fb}var hb,X5;function K6(){if(X5)return hb;X5=1;function t(e,r){return e===r||e!==e&&r!==r}return hb=t,hb}var pb,Q5;function dx(){if(Q5)return pb;Q5=1;var t=K6();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return pb=e,pb}var mb,J5;function U9(){if(J5)return mb;J5=1;var t=dx(),e=Array.prototype,r=e.splice;function n(i){var a=this.__data__,s=t(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return mb=n,mb}var gb,Z5;function G9(){if(Z5)return gb;Z5=1;var t=dx();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return gb=e,gb}var vb,eN;function H9(){if(eN)return vb;eN=1;var t=dx();function e(r){return t(this.__data__,r)>-1}return vb=e,vb}var yb,tN;function q9(){if(tN)return yb;tN=1;var t=dx();function e(r,n){var i=this.__data__,a=t(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return yb=e,yb}var xb,rN;function W9(){if(rN)return xb;rN=1;var t=V9(),e=U9(),r=G9(),n=H9(),i=q9();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,xb=a,xb}var bb,nN;function $9(){if(nN)return bb;nN=1;var t=DS(),e=ax(),r=t(e,"Map");return bb=r,bb}var wb,iN;function K9(){if(iN)return wb;iN=1;var t=z9(),e=W9(),r=$9();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return wb=n,wb}var Sb,aN;function Y9(){if(aN)return Sb;aN=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return Sb=t,Sb}var kb,sN;function fx(){if(sN)return kb;sN=1;var t=Y9();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return kb=e,kb}var Cb,oN;function X9(){if(oN)return Cb;oN=1;var t=fx();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return Cb=e,Cb}var Nb,lN;function Q9(){if(lN)return Nb;lN=1;var t=fx();function e(r){return t(this,r).get(r)}return Nb=e,Nb}var Eb,uN;function J9(){if(uN)return Eb;uN=1;var t=fx();function e(r){return t(this,r).has(r)}return Eb=e,Eb}var Tb,cN;function Z9(){if(cN)return Tb;cN=1;var t=fx();function e(r,n){var i=t(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return Tb=e,Tb}var jb,dN;function eI(){if(dN)return jb;dN=1;var t=K9(),e=X9(),r=Q9(),n=J9(),i=Z9();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,jb=a,jb}var Pb,fN;function tI(){if(fN)return Pb;fN=1;var t=eI(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],l=a.cache;if(l.has(o))return l.get(o);var u=n.apply(this,s);return a.cache=l.set(o,u)||l,u};return a.cache=new(r.Cache||t),a}return r.Cache=t,Pb=r,Pb}var Mb,hN;function rI(){if(hN)return Mb;hN=1;var t=tI(),e=500;function r(n){var i=t(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return Mb=r,Mb}var _b,pN;function Y6(){if(pN)return _b;pN=1;var t=rI(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,l,u){a.push(l?u.replace(r,"$1"):o||s)}),a});return _b=n,_b}var Ab,mN;function X6(){if(mN)return Ab;mN=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=r(e[n],n,e);return a}return Ab=t,Ab}var Rb,gN;function nI(){if(gN)return Rb;gN=1;var t=NS(),e=X6(),r=ux(),n=Pg(),i=t?t.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return Rb=s,Rb}var Db,vN;function Q6(){if(vN)return Db;vN=1;var t=nI();function e(r){return r==null?"":t(r)}return Db=e,Db}var Ob,yN;function J6(){if(yN)return Ob;yN=1;var t=ux(),e=j9(),r=Y6(),n=Q6();function i(a,s){return t(a)?a:e(a,s)?[a]:r(n(a))}return Ob=i,Ob}var Ib,xN;function OS(){if(xN)return Ib;xN=1;var t=Pg();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return Ib=e,Ib}var Lb,bN;function iI(){if(bN)return Lb;bN=1;var t=J6(),e=OS();function r(n,i){i=t(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return Lb=r,Lb}var Bb,wN;function aI(){if(wN)return Bb;wN=1;var t=iI();function e(r,n,i){var a=r==null?void 0:t(r,n);return a===void 0?i:a}return Bb=e,Bb}var sI=aI(),oI=Tg(sI),Fb,SN;function lI(){if(SN)return Fb;SN=1;var t=DS(),e=(function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}})();return Fb=e,Fb}var zb,kN;function uI(){if(kN)return zb;kN=1;var t=lI();function e(r,n,i){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return zb=e,zb}var Vb,CN;function cI(){if(CN)return Vb;CN=1;var t=uI(),e=K6(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o){var l=a[s];(!(n.call(a,s)&&e(l,o))||o===void 0&&!(s in a))&&t(a,s,o)}return Vb=i,Vb}var Ub,NN;function dI(){if(NN)return Ub;NN=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??t,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return Ub=r,Ub}var Gb,EN;function fI(){if(EN)return Gb;EN=1;var t=cI(),e=J6(),r=dI(),n=jg(),i=OS();function a(s,o,l,u){if(!n(s))return s;o=e(o,s);for(var c=-1,f=o.length,m=f-1,g=s;g!=null&&++c<f;){var y=i(o[c]),b=l;if(y==="__proto__"||y==="constructor"||y==="prototype")return s;if(c!=m){var w=g[y];b=u?u(w,y,g):void 0,b===void 0&&(b=n(w)?w:r(o[c+1])?[]:{})}t(g,y,b),g=g[y]}return s}return Gb=a,Gb}var Hb,TN;function hI(){if(TN)return Hb;TN=1;var t=fI();function e(r,n,i){return r==null?r:t(r,n,i)}return Hb=e,Hb}var pI=hI(),mI=Tg(pI),qb,jN;function gI(){if(jN)return qb;jN=1;function t(e,r){var n=-1,i=e.length;for(r||(r=Array(i));++n<i;)r[n]=e[n];return r}return qb=t,qb}var Wb,PN;function vI(){if(PN)return Wb;PN=1;var t=X6(),e=gI(),r=ux(),n=Pg(),i=Y6(),a=OS(),s=Q6();function o(l){return r(l)?t(l,a):n(l)?[l]:e(i(s(l)))}return Wb=o,Wb}var yI=vI(),xI=Tg(yI),bI={data:function(e){var r={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(i){},beforeSet:function(i,a){},onSet:function(i){},canSet:function(i){return!0}};return e=Ct({},r,e),function(i,a){var s=e,o=this,l=o.length!==void 0,u=l?o:[o],c=l?o[0]:o;if(xt(i)){var f=i.indexOf(".")!==-1,m=f&&xI(i);if(s.allowGetting&&a===void 0){var g;return c&&(s.beforeGet(c),m&&c._private[s.field][i]===void 0?g=oI(c._private[s.field],m):g=c._private[s.field][i]),g}else if(s.allowSetting&&a!==void 0){var y=!s.immutableKeys[i];if(y){var b=h6({},i,a);s.beforeSet(o,b);for(var w=0,N=u.length;w<N;w++){var k=u[w];s.canSet(k)&&(m&&c._private[s.field][i]===void 0?mI(k._private[s.field],m,a):k._private[s.field][i]=a)}s.updateStyle&&o.updateStyle(),s.onSet(o),s.settingTriggersEvent&&o[s.triggerFnName](s.settingEvent)}}}else if(s.allowSetting&&Zt(i)){var C=i,E,P,_=Object.keys(C);s.beforeSet(o,C);for(var A=0;A<_.length;A++){E=_[A],P=C[E];var I=!s.immutableKeys[E];if(I)for(var D=0;D<u.length;D++){var L=u[D];s.canSet(L)&&(L._private[s.field][E]=P)}}s.updateStyle&&o.updateStyle(),s.onSet(o),s.settingTriggersEvent&&o[s.triggerFnName](s.settingEvent)}else if(s.allowBinding&&Qr(i)){var U=i;o.on(s.bindingEvent,U)}else if(s.allowGetting&&i===void 0){var H;return c&&(s.beforeGet(c),H=c._private[s.field]),H}return o}},removeData:function(e){var r={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Ct({},r,e),function(i){var a=e,s=this,o=s.length!==void 0,l=o?s:[s];if(xt(i)){for(var u=i.split(/\s+/),c=u.length,f=0;f<c;f++){var m=u[f];if(!Bu(m)){var g=!a.immutableKeys[m];if(g)for(var y=0,b=l.length;y<b;y++)l[y]._private[a.field][m]=void 0}}a.triggerEvent&&s[a.triggerFnName](a.event)}else if(i===void 0){for(var w=0,N=l.length;w<N;w++)for(var k=l[w]._private[a.field],C=Object.keys(k),E=0;E<C.length;E++){var P=C[E],_=!a.immutableKeys[P];_&&(k[P]=void 0)}a.triggerEvent&&s[a.triggerFnName](a.event)}return s}}},wI={eventAliasesOn:function(e){var r=e;r.addListener=r.listen=r.bind=r.on,r.unlisten=r.unbind=r.off=r.removeListener,r.trigger=r.emit,r.pon=r.promiseOn=function(n,i){var a=this,s=Array.prototype.slice.call(arguments,0);return new wh(function(o,l){var u=function(g){a.off.apply(a,f),o(g)},c=s.concat([u]),f=c.concat([]);a.on.apply(a,c)})}}},or={};[T9,bI,wI].forEach(function(t){Ct(or,t)});var SI={animate:or.animate(),animation:or.animation(),animated:or.animated(),clearQueue:or.clearQueue(),delay:or.delay(),delayAnimation:or.delayAnimation(),stop:or.stop()},_0={classes:function(e){var r=this;if(e===void 0){var n=[];return r[0]._private.classes.forEach(function(y){return n.push(y)}),n}else Nr(e)||(e=(e||"").match(/\S+/g)||[]);for(var i=[],a=new bh(e),s=0;s<r.length;s++){for(var o=r[s],l=o._private,u=l.classes,c=!1,f=0;f<e.length;f++){var m=e[f],g=u.has(m);if(!g){c=!0;break}}c||(c=u.size!==e.length),c&&(l.classes=a,i.push(o))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),r},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var r=this[0];return r!=null&&r._private.classes.has(e)},toggleClass:function(e,r){Nr(e)||(e=e.match(/\S+/g)||[]);for(var n=this,i=r===void 0,a=[],s=0,o=n.length;s<o;s++)for(var l=n[s],u=l._private.classes,c=!1,f=0;f<e.length;f++){var m=e[f],g=u.has(m),y=!1;r||i&&!g?(u.add(m),y=!0):(!r||i&&g)&&(u.delete(m),y=!0),!c&&y&&(a.push(l),c=!0)}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,r){var n=this;if(r==null)r=250;else if(r===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},r),n}};_0.className=_0.classNames=_0.classes;var Jt={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:zn,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};Jt.variable="(?:[\\w-.]|(?:\\\\"+Jt.metaChar+"))+";Jt.className="(?:[\\w-]|(?:\\\\"+Jt.metaChar+"))+";Jt.value=Jt.string+"|"+Jt.number;Jt.id=Jt.variable;(function(){var t,e,r;for(t=Jt.comparatorOp.split("|"),r=0;r<t.length;r++)e=t[r],Jt.comparatorOp+="|@"+e;for(t=Jt.comparatorOp.split("|"),r=0;r<t.length;r++)e=t[r],!(e.indexOf("!")>=0)&&e!=="="&&(Jt.comparatorOp+="|\\!"+e)})();var vr=function(){return{checks:[]}},ct={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},x2=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(t,e){return bD(t.selector,e.selector)}),kI=(function(){for(var t={},e,r=0;r<x2.length;r++)e=x2[r],t[e.selector]=e.matches;return t})(),CI=function(e,r){return kI[e](r)},NI="("+x2.map(function(t){return t.selector}).join("|")+")",Nf=function(e){return e.replace(new RegExp("\\\\("+Jt.metaChar+")","g"),function(r,n){return n})},hu=function(e,r,n){e[e.length-1]=n},b2=[{name:"group",query:!0,regex:"("+Jt.group+")",populate:function(e,r,n){var i=Pn(n,1),a=i[0];r.checks.push({type:ct.GROUP,value:a==="*"?a:a+"s"})}},{name:"state",query:!0,regex:NI,populate:function(e,r,n){var i=Pn(n,1),a=i[0];r.checks.push({type:ct.STATE,value:a})}},{name:"id",query:!0,regex:"\\#("+Jt.id+")",populate:function(e,r,n){var i=Pn(n,1),a=i[0];r.checks.push({type:ct.ID,value:Nf(a)})}},{name:"className",query:!0,regex:"\\.("+Jt.className+")",populate:function(e,r,n){var i=Pn(n,1),a=i[0];r.checks.push({type:ct.CLASS,value:Nf(a)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+Jt.variable+")\\s*\\]",populate:function(e,r,n){var i=Pn(n,1),a=i[0];r.checks.push({type:ct.DATA_EXIST,field:Nf(a)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+Jt.variable+")\\s*("+Jt.comparatorOp+")\\s*("+Jt.value+")\\s*\\]",populate:function(e,r,n){var i=Pn(n,3),a=i[0],s=i[1],o=i[2],l=new RegExp("^"+Jt.string+"$").exec(o)!=null;l?o=o.substring(1,o.length-1):o=parseFloat(o),r.checks.push({type:ct.DATA_COMPARE,field:Nf(a),operator:s,value:o})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+Jt.boolOp+")\\s*("+Jt.variable+")\\s*\\]",populate:function(e,r,n){var i=Pn(n,2),a=i[0],s=i[1];r.checks.push({type:ct.DATA_BOOL,field:Nf(s),operator:a})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+Jt.meta+")\\s*("+Jt.comparatorOp+")\\s*("+Jt.number+")\\s*\\]\\]",populate:function(e,r,n){var i=Pn(n,3),a=i[0],s=i[1],o=i[2];r.checks.push({type:ct.META_COMPARE,field:Nf(a),operator:s,value:parseFloat(o)})}},{name:"nextQuery",separator:!0,regex:Jt.separator,populate:function(e,r){var n=e.currentSubject,i=e.edgeCount,a=e.compoundCount,s=e[e.length-1];n!=null&&(s.subject=n,e.currentSubject=null),s.edgeCount=i,s.compoundCount=a,e.edgeCount=0,e.compoundCount=0;var o=e[e.length++]=vr();return o}},{name:"directedEdge",separator:!0,regex:Jt.directedEdge,populate:function(e,r){if(e.currentSubject==null){var n=vr(),i=r,a=vr();return n.checks.push({type:ct.DIRECTED_EDGE,source:i,target:a}),hu(e,r,n),e.edgeCount++,a}else{var s=vr(),o=r,l=vr();return s.checks.push({type:ct.NODE_SOURCE,source:o,target:l}),hu(e,r,s),e.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:Jt.undirectedEdge,populate:function(e,r){if(e.currentSubject==null){var n=vr(),i=r,a=vr();return n.checks.push({type:ct.UNDIRECTED_EDGE,nodes:[i,a]}),hu(e,r,n),e.edgeCount++,a}else{var s=vr(),o=r,l=vr();return s.checks.push({type:ct.NODE_NEIGHBOR,node:o,neighbor:l}),hu(e,r,s),l}}},{name:"child",separator:!0,regex:Jt.child,populate:function(e,r){if(e.currentSubject==null){var n=vr(),i=vr(),a=e[e.length-1];return n.checks.push({type:ct.CHILD,parent:a,child:i}),hu(e,r,n),e.compoundCount++,i}else if(e.currentSubject===r){var s=vr(),o=e[e.length-1],l=vr(),u=vr(),c=vr(),f=vr();return s.checks.push({type:ct.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=r.checks,r.checks=[{type:ct.TRUE}],f.checks.push({type:ct.TRUE}),l.checks.push({type:ct.PARENT,parent:f,child:c}),hu(e,o,s),e.currentSubject=u,e.compoundCount++,c}else{var m=vr(),g=vr(),y=[{type:ct.PARENT,parent:m,child:g}];return m.checks=r.checks,r.checks=y,e.compoundCount++,g}}},{name:"descendant",separator:!0,regex:Jt.descendant,populate:function(e,r){if(e.currentSubject==null){var n=vr(),i=vr(),a=e[e.length-1];return n.checks.push({type:ct.DESCENDANT,ancestor:a,descendant:i}),hu(e,r,n),e.compoundCount++,i}else if(e.currentSubject===r){var s=vr(),o=e[e.length-1],l=vr(),u=vr(),c=vr(),f=vr();return s.checks.push({type:ct.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=r.checks,r.checks=[{type:ct.TRUE}],f.checks.push({type:ct.TRUE}),l.checks.push({type:ct.ANCESTOR,ancestor:f,descendant:c}),hu(e,o,s),e.currentSubject=u,e.compoundCount++,c}else{var m=vr(),g=vr(),y=[{type:ct.ANCESTOR,ancestor:m,descendant:g}];return m.checks=r.checks,r.checks=y,e.compoundCount++,g}}},{name:"subject",modifier:!0,regex:Jt.subject,populate:function(e,r){if(e.currentSubject!=null&&e.currentSubject!==r)return lr("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=r;var n=e[e.length-1],i=n.checks[0],a=i==null?null:i.type;a===ct.DIRECTED_EDGE?i.type=ct.NODE_TARGET:a===ct.UNDIRECTED_EDGE&&(i.type=ct.NODE_NEIGHBOR,i.node=i.nodes[1],i.neighbor=i.nodes[0],i.nodes=null)}}];b2.forEach(function(t){return t.regexObj=new RegExp("^"+t.regex)});var EI=function(e){for(var r,n,i,a=0;a<b2.length;a++){var s=b2[a],o=s.name,l=e.match(s.regexObj);if(l!=null){n=l,r=s,i=o;var u=l[0];e=e.substring(u.length);break}}return{expr:r,match:n,name:i,remaining:e}},TI=function(e){var r=e.match(/^\s+/);if(r){var n=r[0];e=e.substring(n.length)}return e},jI=function(e){var r=this,n=r.inputText=e,i=r[0]=vr();for(r.length=1,n=TI(n);;){var a=EI(n);if(a.expr==null)return lr("The selector `"+e+"`is invalid"),!1;var s=a.match.slice(1),o=a.expr.populate(r,i,s);if(o===!1)return!1;if(o!=null&&(i=o),n=a.remaining,n.match(/^\s*$/))break}var l=r[r.length-1];r.currentSubject!=null&&(l.subject=r.currentSubject),l.edgeCount=r.edgeCount,l.compoundCount=r.compoundCount;for(var u=0;u<r.length;u++){var c=r[u];if(c.compoundCount>0&&c.edgeCount>0)return lr("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return lr("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;c.edgeCount===1&&lr("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},PI=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(c){return c??""},r=function(c){return xt(c)?'"'+c+'"':e(c)},n=function(c){return" "+c+" "},i=function(c,f){var m=c.type,g=c.value;switch(m){case ct.GROUP:{var y=e(g);return y.substring(0,y.length-1)}case ct.DATA_COMPARE:{var b=c.field,w=c.operator;return"["+b+n(e(w))+r(g)+"]"}case ct.DATA_BOOL:{var N=c.operator,k=c.field;return"["+e(N)+k+"]"}case ct.DATA_EXIST:{var C=c.field;return"["+C+"]"}case ct.META_COMPARE:{var E=c.operator,P=c.field;return"[["+P+n(e(E))+r(g)+"]]"}case ct.STATE:return g;case ct.ID:return"#"+g;case ct.CLASS:return"."+g;case ct.PARENT:case ct.CHILD:return a(c.parent,f)+n(">")+a(c.child,f);case ct.ANCESTOR:case ct.DESCENDANT:return a(c.ancestor,f)+" "+a(c.descendant,f);case ct.COMPOUND_SPLIT:{var _=a(c.left,f),A=a(c.subject,f),I=a(c.right,f);return _+(_.length>0?" ":"")+A+I}case ct.TRUE:return""}},a=function(c,f){return c.checks.reduce(function(m,g,y){return m+(f===c&&y===0?"$":"")+i(g,f)},"")},s="",o=0;o<this.length;o++){var l=this[o];s+=a(l,l.subject),this.length>1&&o<this.length-1&&(s+=", ")}return this.toStringCache=s,s},MI={parse:jI,toString:PI},Z6=function(e,r,n){var i,a=xt(e),s=Qe(e),o=xt(n),l,u,c=!1,f=!1,m=!1;switch(r.indexOf("!")>=0&&(r=r.replace("!",""),f=!0),r.indexOf("@")>=0&&(r=r.replace("@",""),c=!0),(a||o||c)&&(l=!a&&!s?"":""+e,u=""+n),c&&(e=l=l.toLowerCase(),n=u=u.toLowerCase()),r){case"*=":i=l.indexOf(u)>=0;break;case"$=":i=l.indexOf(u,l.length-u.length)>=0;break;case"^=":i=l.indexOf(u)===0;break;case"=":i=e===n;break;case">":m=!0,i=e>n;break;case">=":m=!0,i=e>=n;break;case"<":m=!0,i=e<n;break;case"<=":m=!0,i=e<=n;break;default:i=!1;break}return f&&(e!=null||!m)&&(i=!i),i},_I=function(e,r){switch(r){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},AI=function(e){return e!==void 0},IS=function(e,r){return e.data(r)},RI=function(e,r){return e[r]()},ln=[],Br=function(e,r){return e.checks.every(function(n){return ln[n.type](n,r)})};ln[ct.GROUP]=function(t,e){var r=t.value;return r==="*"||r===e.group()};ln[ct.STATE]=function(t,e){var r=t.value;return CI(r,e)};ln[ct.ID]=function(t,e){var r=t.value;return e.id()===r};ln[ct.CLASS]=function(t,e){var r=t.value;return e.hasClass(r)};ln[ct.META_COMPARE]=function(t,e){var r=t.field,n=t.operator,i=t.value;return Z6(RI(e,r),n,i)};ln[ct.DATA_COMPARE]=function(t,e){var r=t.field,n=t.operator,i=t.value;return Z6(IS(e,r),n,i)};ln[ct.DATA_BOOL]=function(t,e){var r=t.field,n=t.operator;return _I(IS(e,r),n)};ln[ct.DATA_EXIST]=function(t,e){var r=t.field;return t.operator,AI(IS(e,r))};ln[ct.UNDIRECTED_EDGE]=function(t,e){var r=t.nodes[0],n=t.nodes[1],i=e.source(),a=e.target();return Br(r,i)&&Br(n,a)||Br(n,i)&&Br(r,a)};ln[ct.NODE_NEIGHBOR]=function(t,e){return Br(t.node,e)&&e.neighborhood().some(function(r){return r.isNode()&&Br(t.neighbor,r)})};ln[ct.DIRECTED_EDGE]=function(t,e){return Br(t.source,e.source())&&Br(t.target,e.target())};ln[ct.NODE_SOURCE]=function(t,e){return Br(t.source,e)&&e.outgoers().some(function(r){return r.isNode()&&Br(t.target,r)})};ln[ct.NODE_TARGET]=function(t,e){return Br(t.target,e)&&e.incomers().some(function(r){return r.isNode()&&Br(t.source,r)})};ln[ct.CHILD]=function(t,e){return Br(t.child,e)&&Br(t.parent,e.parent())};ln[ct.PARENT]=function(t,e){return Br(t.parent,e)&&e.children().some(function(r){return Br(t.child,r)})};ln[ct.DESCENDANT]=function(t,e){return Br(t.descendant,e)&&e.ancestors().some(function(r){return Br(t.ancestor,r)})};ln[ct.ANCESTOR]=function(t,e){return Br(t.ancestor,e)&&e.descendants().some(function(r){return Br(t.descendant,r)})};ln[ct.COMPOUND_SPLIT]=function(t,e){return Br(t.subject,e)&&Br(t.left,e)&&Br(t.right,e)};ln[ct.TRUE]=function(){return!0};ln[ct.COLLECTION]=function(t,e){var r=t.value;return r.has(e)};ln[ct.FILTER]=function(t,e){var r=t.value;return r(e)};var DI=function(e){var r=this;if(r.length===1&&r[0].checks.length===1&&r[0].checks[0].type===ct.ID)return e.getElementById(r[0].checks[0].value).collection();var n=function(a){for(var s=0;s<r.length;s++){var o=r[s];if(Br(o,a))return!0}return!1};return r.text()==null&&(n=function(){return!0}),e.filter(n)},OI=function(e){for(var r=this,n=0;n<r.length;n++){var i=r[n];if(Br(i,e))return!0}return!1},II={matches:OI,filter:DI},Vu=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||xt(e)&&e.match(/^\s*$/)||(Fa(e)?this.addQuery({checks:[{type:ct.COLLECTION,value:e.collection()}]}):Qr(e)?this.addQuery({checks:[{type:ct.FILTER,value:e}]}):xt(e)?this.parse(e)||(this.invalid=!0):Hr("A selector must be created from a string; found "))},Uu=Vu.prototype;[MI,II].forEach(function(t){return Ct(Uu,t)});Uu.text=function(){return this.inputText};Uu.size=function(){return this.length};Uu.eq=function(t){return this[t]};Uu.sameText=function(t){return!this.invalid&&!t.invalid&&this.text()===t.text()};Uu.addQuery=function(t){this[this.length++]=t};Uu.selector=Uu.toString;var Au={allAre:function(e){var r=new Vu(e);return this.every(function(n){return r.matches(n)})},is:function(e){var r=new Vu(e);return this.some(function(n){return r.matches(n)})},some:function(e,r){for(var n=0;n<this.length;n++){var i=r?e.apply(r,[this[n],n,this]):e(this[n],n,this);if(i)return!0}return!1},every:function(e,r){for(var n=0;n<this.length;n++){var i=r?e.apply(r,[this[n],n,this]):e(this[n],n,this);if(!i)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var r=this.length,n=e.length;return r!==n?!1:r===1?this[0]===e[0]:this.every(function(i){return e.hasElementWithId(i.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(r){return e.hasElementWithId(r.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var r=this.neighborhood();return e.every(function(n){return r.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var r=this;return e.every(function(n){return r.hasElementWithId(n.id())})}};Au.allAreNeighbours=Au.allAreNeighbors;Au.has=Au.contains;Au.equal=Au.equals=Au.same;var us=function(e,r){return function(i,a,s,o){var l=i,u=this,c;if(l==null?c="":Fa(l)&&l.length===1&&(c=l.id()),u.length===1&&c){var f=u[0]._private,m=f.traversalCache=f.traversalCache||{},g=m[r]=m[r]||[],y=ud(c),b=g[y];return b||(g[y]=e.call(u,i,a,s,o))}else return e.call(u,i,a,s,o)}},ih={parent:function(e){var r=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var i=0;i<this.length;i++){var a=this[i],s=a._private.parent;s&&r.push(s)}return this.spawn(r,!0).filter(e)},parents:function(e){for(var r=[],n=this.parent();n.nonempty();){for(var i=0;i<n.length;i++){var a=n[i];r.push(a)}n=n.parent()}return this.spawn(r,!0).filter(e)},commonAncestors:function(e){for(var r,n=0;n<this.length;n++){var i=this[n],a=i.parents();r=r||a,r=r.intersect(a)}return r.filter(e)},orphans:function(e){return this.stdFilter(function(r){return r.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(r){return r.isChild()}).filter(e)},children:us(function(t){for(var e=[],r=0;r<this.length;r++)for(var n=this[r],i=n._private.children,a=0;a<i.length;a++)e.push(i[a]);return this.spawn(e,!0).filter(t)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var r=[];function n(i){for(var a=0;a<i.length;a++){var s=i[a];r.push(s),s.children().nonempty()&&n(s.children())}}return n(this.children()),this.spawn(r,!0).filter(e)}};function LS(t,e,r,n){for(var i=[],a=new bh,s=t.cy(),o=s.hasCompoundNodes(),l=0;l<t.length;l++){var u=t[l];r?i.push(u):o&&n(i,a,u)}for(;i.length>0;){var c=i.shift();e(c),a.add(c.id()),o&&n(i,a,c)}return t}function ej(t,e,r){if(r.isParent())for(var n=r._private.children,i=0;i<n.length;i++){var a=n[i];e.has(a.id())||t.push(a)}}ih.forEachDown=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return LS(this,t,e,ej)};function tj(t,e,r){if(r.isChild()){var n=r._private.parent;e.has(n.id())||t.push(n)}}ih.forEachUp=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return LS(this,t,e,tj)};function LI(t,e,r){tj(t,e,r),ej(t,e,r)}ih.forEachUpAndDown=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return LS(this,t,e,LI)};ih.ancestors=ih.parents;var ig,rj;ig=rj={data:or.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:or.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:or.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:or.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:or.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:or.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};ig.attr=ig.data;ig.removeAttr=ig.removeData;var BI=rj,hx={};function $b(t){return function(e){var r=this;if(e===void 0&&(e=!0),r.length!==0)if(r.isNode()&&!r.removed()){for(var n=0,i=r[0],a=i._private.edges,s=0;s<a.length;s++){var o=a[s];!e&&o.isLoop()||(n+=t(i,o))}return n}else return}}Ct(hx,{degree:$b(function(t,e){return e.source().same(e.target())?2:1}),indegree:$b(function(t,e){return e.target().same(t)?1:0}),outdegree:$b(function(t,e){return e.source().same(t)?1:0})});function Ef(t,e){return function(r){for(var n,i=this.nodes(),a=0;a<i.length;a++){var s=i[a],o=s[t](r);o!==void 0&&(n===void 0||e(o,n))&&(n=o)}return n}}Ct(hx,{minDegree:Ef("degree",function(t,e){return t<e}),maxDegree:Ef("degree",function(t,e){return t>e}),minIndegree:Ef("indegree",function(t,e){return t<e}),maxIndegree:Ef("indegree",function(t,e){return t>e}),minOutdegree:Ef("outdegree",function(t,e){return t<e}),maxOutdegree:Ef("outdegree",function(t,e){return t>e})});Ct(hx,{totalDegree:function(e){for(var r=0,n=this.nodes(),i=0;i<n.length;i++)r+=n[i].degree(e);return r}});var Bs,nj,ij=function(e,r,n){for(var i=0;i<e.length;i++){var a=e[i];if(!a.locked()){var s=a._private.position,o={x:r.x!=null?r.x-s.x:0,y:r.y!=null?r.y-s.y:0};a.isParent()&&!(o.x===0&&o.y===0)&&a.children().shift(o,n),a.dirtyBoundingBoxCache()}}},MN={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,r){ij(e,r,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};Bs=nj={position:or.data(MN),silentPosition:or.data(Ct({},MN,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,r){ij(e,r,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,r){if(Zt(e))r?this.silentPosition(e):this.position(e);else if(Qr(e)){var n=e,i=this.cy();i.startBatch();for(var a=0;a<this.length;a++){var s=this[a],o=void 0;(o=n(s,a))&&(r?s.silentPosition(o):s.position(o))}i.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,r,n){var i;if(Zt(e)?(i={x:Qe(e.x)?e.x:0,y:Qe(e.y)?e.y:0},n=r):xt(e)&&Qe(r)&&(i={x:0,y:0},i[e]=r),i!=null){var a=this.cy();a.startBatch();for(var s=0;s<this.length;s++){var o=this[s];if(!(a.hasCompoundNodes()&&o.isChild()&&o.ancestors().anySame(this))){var l=o.position(),u={x:l.x+i.x,y:l.y+i.y};n?o.silentPosition(u):o.position(u)}}a.endBatch()}return this},silentShift:function(e,r){return Zt(e)?this.shift(e,!0):xt(e)&&Qe(r)&&this.shift(e,r,!0),this},renderedPosition:function(e,r){var n=this[0],i=this.cy(),a=i.zoom(),s=i.pan(),o=Zt(e)?e:void 0,l=o!==void 0||r!==void 0&&xt(e);if(n&&n.isNode())if(l)for(var u=0;u<this.length;u++){var c=this[u];r!==void 0?c.position(e,(r-s[e])/a):o!==void 0&&c.position(A6(o,a,s))}else{var f=n.position();return o=ox(f,a,s),e===void 0?o:o[e]}else if(!l)return;return this},relativePosition:function(e,r){var n=this[0],i=this.cy(),a=Zt(e)?e:void 0,s=a!==void 0||r!==void 0&&xt(e),o=i.hasCompoundNodes();if(n&&n.isNode())if(s)for(var l=0;l<this.length;l++){var u=this[l],c=o?u.parent():null,f=c&&c.length>0,m=f;f&&(c=c[0]);var g=m?c.position():{x:0,y:0};r!==void 0?u.position(e,r+g[e]):a!==void 0&&u.position({x:a.x+g.x,y:a.y+g.y})}else{var y=n.position(),b=o?n.parent():null,w=b&&b.length>0,N=w;w&&(b=b[0]);var k=N?b.position():{x:0,y:0};return a={x:y.x-k.x,y:y.y-k.y},e===void 0?a:a[e]}else if(!s)return;return this}};Bs.modelPosition=Bs.point=Bs.position;Bs.modelPositions=Bs.points=Bs.positions;Bs.renderedPoint=Bs.renderedPosition;Bs.relativePoint=Bs.relativePosition;var FI=nj,Jf,Xu;Jf=Xu={};Xu.renderedBoundingBox=function(t){var e=this.boundingBox(t),r=this.cy(),n=r.zoom(),i=r.pan(),a=e.x1*n+i.x,s=e.x2*n+i.x,o=e.y1*n+i.y,l=e.y2*n+i.y;return{x1:a,x2:s,y1:o,y2:l,w:s-a,h:l-o}};Xu.dirtyCompoundBoundsCache=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(r){if(r.isParent()){var n=r._private;n.compoundBoundsClean=!1,n.bbCache=null,t||r.emitAndNotify("bounds")}}),this)};Xu.updateCompoundBounds=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!t&&e.batching())return this;function r(s){if(!s.isParent())return;var o=s._private,l=s.children(),u=s.pstyle("compound-sizing-wrt-labels").value==="include",c={width:{val:s.pstyle("min-width").pfValue,left:s.pstyle("min-width-bias-left"),right:s.pstyle("min-width-bias-right")},height:{val:s.pstyle("min-height").pfValue,top:s.pstyle("min-height-bias-top"),bottom:s.pstyle("min-height-bias-bottom")}},f=l.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),m=o.position;(f.w===0||f.h===0)&&(f={w:s.pstyle("width").pfValue,h:s.pstyle("height").pfValue},f.x1=m.x-f.w/2,f.x2=m.x+f.w/2,f.y1=m.y-f.h/2,f.y2=m.y+f.h/2);function g(D,L,U){var H=0,M=0,z=L+U;return D>0&&z>0&&(H=L/z*D,M=U/z*D),{biasDiff:H,biasComplementDiff:M}}function y(D,L,U,H){if(U.units==="%")switch(H){case"width":return D>0?U.pfValue*D:0;case"height":return L>0?U.pfValue*L:0;case"average":return D>0&&L>0?U.pfValue*(D+L)/2:0;case"min":return D>0&&L>0?D>L?U.pfValue*L:U.pfValue*D:0;case"max":return D>0&&L>0?D>L?U.pfValue*D:U.pfValue*L:0;default:return 0}else return U.units==="px"?U.pfValue:0}var b=c.width.left.value;c.width.left.units==="px"&&c.width.val>0&&(b=b*100/c.width.val);var w=c.width.right.value;c.width.right.units==="px"&&c.width.val>0&&(w=w*100/c.width.val);var N=c.height.top.value;c.height.top.units==="px"&&c.height.val>0&&(N=N*100/c.height.val);var k=c.height.bottom.value;c.height.bottom.units==="px"&&c.height.val>0&&(k=k*100/c.height.val);var C=g(c.width.val-f.w,b,w),E=C.biasDiff,P=C.biasComplementDiff,_=g(c.height.val-f.h,N,k),A=_.biasDiff,I=_.biasComplementDiff;o.autoPadding=y(f.w,f.h,s.pstyle("padding"),s.pstyle("padding-relative-to").value),o.autoWidth=Math.max(f.w,c.width.val),m.x=(-E+f.x1+f.x2+P)/2,o.autoHeight=Math.max(f.h,c.height.val),m.y=(-A+f.y1+f.y2+I)/2}for(var n=0;n<this.length;n++){var i=this[n],a=i._private;(!a.compoundBoundsClean||t)&&(r(i),e.batching()||(a.compoundBoundsClean=!0))}return this};var ss=function(e){return e===1/0||e===-1/0?0:e},Ds=function(e,r,n,i,a){i-r===0||a-n===0||r==null||n==null||i==null||a==null||(e.x1=r<e.x1?r:e.x1,e.x2=i>e.x2?i:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=a>e.y2?a:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},yu=function(e,r){return r==null?e:Ds(e,r.x1,r.y1,r.x2,r.y2)},Np=function(e,r,n){return ya(e,r,n)},e0=function(e,r,n){if(!r.cy().headless()){var i=r._private,a=i.rstyle,s=a.arrowWidth/2,o=r.pstyle(n+"-arrow-shape").value,l,u;if(o!=="none"){n==="source"?(l=a.srcX,u=a.srcY):n==="target"?(l=a.tgtX,u=a.tgtY):(l=a.midX,u=a.midY);var c=i.arrowBounds=i.arrowBounds||{},f=c[n]=c[n]||{};f.x1=l-s,f.y1=u-s,f.x2=l+s,f.y2=u+s,f.w=f.x2-f.x1,f.h=f.y2-f.y1,P0(f,1),Ds(e,f.x1,f.y1,f.x2,f.y2)}}},Kb=function(e,r,n){if(!r.cy().headless()){var i;n?i=n+"-":i="";var a=r._private,s=a.rstyle,o=r.pstyle(i+"label").strValue;if(o){var l=r.pstyle("text-halign"),u=r.pstyle("text-valign"),c=Np(s,"labelWidth",n),f=Np(s,"labelHeight",n),m=Np(s,"labelX",n),g=Np(s,"labelY",n),y=r.pstyle(i+"text-margin-x").pfValue,b=r.pstyle(i+"text-margin-y").pfValue,w=r.isEdge(),N=r.pstyle(i+"text-rotation"),k=r.pstyle("text-outline-width").pfValue,C=r.pstyle("text-border-width").pfValue,E=C/2,P=r.pstyle("text-background-padding").pfValue,_=2,A=f,I=c,D=I/2,L=A/2,U,H,M,z;if(w)U=m-D,H=m+D,M=g-L,z=g+L;else{switch(l.value){case"left":U=m-I,H=m;break;case"center":U=m-D,H=m+D;break;case"right":U=m,H=m+I;break}switch(u.value){case"top":M=g-A,z=g;break;case"center":M=g-L,z=g+L;break;case"bottom":M=g,z=g+A;break}}var O=y-Math.max(k,E)-P-_,G=y+Math.max(k,E)+P+_,W=b-Math.max(k,E)-P-_,$=b+Math.max(k,E)+P+_;U+=O,H+=G,M+=W,z+=$;var X=n||"main",Q=a.labelBounds,V=Q[X]=Q[X]||{};V.x1=U,V.y1=M,V.x2=H,V.y2=z,V.w=H-U,V.h=z-M,V.leftPad=O,V.rightPad=G,V.topPad=W,V.botPad=$;var Y=w&&N.strValue==="autorotate",Z=N.pfValue!=null&&N.pfValue!==0;if(Y||Z){var ie=Y?Np(a.rstyle,"labelAngle",n):N.pfValue,ce=Math.cos(ie),he=Math.sin(ie),ee=(U+H)/2,le=(M+z)/2;if(!w){switch(l.value){case"left":ee=H;break;case"right":ee=U;break}switch(u.value){case"top":le=z;break;case"bottom":le=M;break}}var te=function(Ae,He){return Ae=Ae-ee,He=He-le,{x:Ae*ce-He*he+ee,y:Ae*he+He*ce+le}},ae=te(U,M),oe=te(U,z),fe=te(H,M),pe=te(H,z);U=Math.min(ae.x,oe.x,fe.x,pe.x),H=Math.max(ae.x,oe.x,fe.x,pe.x),M=Math.min(ae.y,oe.y,fe.y,pe.y),z=Math.max(ae.y,oe.y,fe.y,pe.y)}var Te=X+"Rot",Oe=Q[Te]=Q[Te]||{};Oe.x1=U,Oe.y1=M,Oe.x2=H,Oe.y2=z,Oe.w=H-U,Oe.h=z-M,Ds(e,U,M,H,z),Ds(a.labelBounds.all,U,M,H,z)}return e}},_N=function(e,r){if(!r.cy().headless()){var n=r.pstyle("outline-opacity").value,i=r.pstyle("outline-width").value,a=r.pstyle("outline-offset").value,s=i+a;aj(e,r,n,s,"outside",s/2)}},aj=function(e,r,n,i,a,s){if(!(n===0||i<=0||a==="inside")){var o=r.cy(),l=r.pstyle("shape").value,u=o.renderer().nodeShapes[l],c=r.position(),f=c.x,m=c.y,g=r.width(),y=r.height();if(u.hasMiterBounds){a==="center"&&(i/=2);var b=u.miterBounds(f,m,g,y,i);yu(e,b)}else s!=null&&s>0&&M0(e,[s,s,s,s])}},zI=function(e,r){if(!r.cy().headless()){var n=r.pstyle("border-opacity").value,i=r.pstyle("border-width").pfValue,a=r.pstyle("border-position").value;aj(e,r,n,i,a)}},VI=function(e,r){var n=e._private.cy,i=n.styleEnabled(),a=n.headless(),s=ea(),o=e._private,l=e.isNode(),u=e.isEdge(),c,f,m,g,y,b,w=o.rstyle,N=l&&i?e.pstyle("bounds-expansion").pfValue:[0],k=function(_e){return _e.pstyle("display").value!=="none"},C=!i||k(e)&&(!u||k(e.source())&&k(e.target()));if(C){var E=0,P=0;i&&r.includeOverlays&&(E=e.pstyle("overlay-opacity").value,E!==0&&(P=e.pstyle("overlay-padding").value));var _=0,A=0;i&&r.includeUnderlays&&(_=e.pstyle("underlay-opacity").value,_!==0&&(A=e.pstyle("underlay-padding").value));var I=Math.max(P,A),D=0,L=0;if(i&&(D=e.pstyle("width").pfValue,L=D/2),l&&r.includeNodes){var U=e.position();y=U.x,b=U.y;var H=e.outerWidth(),M=H/2,z=e.outerHeight(),O=z/2;c=y-M,f=y+M,m=b-O,g=b+O,Ds(s,c,m,f,g),i&&_N(s,e),i&&r.includeOutlines&&!a&&_N(s,e),i&&zI(s,e)}else if(u&&r.includeEdges)if(i&&!a){var G=e.pstyle("curve-style").strValue;if(c=Math.min(w.srcX,w.midX,w.tgtX),f=Math.max(w.srcX,w.midX,w.tgtX),m=Math.min(w.srcY,w.midY,w.tgtY),g=Math.max(w.srcY,w.midY,w.tgtY),c-=L,f+=L,m-=L,g+=L,Ds(s,c,m,f,g),G==="haystack"){var W=w.haystackPts;if(W&&W.length===2){if(c=W[0].x,m=W[0].y,f=W[1].x,g=W[1].y,c>f){var $=c;c=f,f=$}if(m>g){var X=m;m=g,g=X}Ds(s,c-L,m-L,f+L,g+L)}}else if(G==="bezier"||G==="unbundled-bezier"||Nu(G,"segments")||Nu(G,"taxi")){var Q;switch(G){case"bezier":case"unbundled-bezier":Q=w.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":Q=w.linePts;break}if(Q!=null)for(var V=0;V<Q.length;V++){var Y=Q[V];c=Y.x-L,f=Y.x+L,m=Y.y-L,g=Y.y+L,Ds(s,c,m,f,g)}}}else{var Z=e.source(),ie=Z.position(),ce=e.target(),he=ce.position();if(c=ie.x,f=he.x,m=ie.y,g=he.y,c>f){var ee=c;c=f,f=ee}if(m>g){var le=m;m=g,g=le}c-=L,f+=L,m-=L,g+=L,Ds(s,c,m,f,g)}if(i&&r.includeEdges&&u&&(e0(s,e,"mid-source"),e0(s,e,"mid-target"),e0(s,e,"source"),e0(s,e,"target")),i){var te=e.pstyle("ghost").value==="yes";if(te){var ae=e.pstyle("ghost-offset-x").pfValue,oe=e.pstyle("ghost-offset-y").pfValue;Ds(s,s.x1+ae,s.y1+oe,s.x2+ae,s.y2+oe)}}var fe=o.bodyBounds=o.bodyBounds||{};g5(fe,s),M0(fe,N),P0(fe,1),i&&(c=s.x1,f=s.x2,m=s.y1,g=s.y2,Ds(s,c-I,m-I,f+I,g+I));var pe=o.overlayBounds=o.overlayBounds||{};g5(pe,s),M0(pe,N),P0(pe,1);var Te=o.labelBounds=o.labelBounds||{};Te.all!=null?SO(Te.all):Te.all=ea(),i&&r.includeLabels&&(r.includeMainLabels&&Kb(s,e,null),u&&(r.includeSourceLabels&&Kb(s,e,"source"),r.includeTargetLabels&&Kb(s,e,"target")))}return s.x1=ss(s.x1),s.y1=ss(s.y1),s.x2=ss(s.x2),s.y2=ss(s.y2),s.w=ss(s.x2-s.x1),s.h=ss(s.y2-s.y1),s.w>0&&s.h>0&&C&&(M0(s,N),P0(s,1)),s},sj=function(e){var r=0,n=function(s){return(s?1:0)<<r++},i=0;return i+=n(e.incudeNodes),i+=n(e.includeEdges),i+=n(e.includeLabels),i+=n(e.includeMainLabels),i+=n(e.includeSourceLabels),i+=n(e.includeTargetLabels),i+=n(e.includeOverlays),i+=n(e.includeOutlines),i},oj=function(e){var r=function(o){return Math.round(o)};if(e.isEdge()){var n=e.source().position(),i=e.target().position();return c5([r(n.x),r(n.y),r(i.x),r(i.y)])}else{var a=e.position();return c5([r(a.x),r(a.y)])}},AN=function(e,r){var n=e._private,i,a=e.isEdge(),s=r==null?RN:sj(r),o=s===RN;if(n.bbCache==null?(i=VI(e,ag),n.bbCache=i,n.bbCachePosKey=oj(e)):i=n.bbCache,!o){var l=e.isNode();i=ea(),(r.includeNodes&&l||r.includeEdges&&!l)&&(r.includeOverlays?yu(i,n.overlayBounds):yu(i,n.bodyBounds)),r.includeLabels&&(r.includeMainLabels&&(!a||r.includeSourceLabels&&r.includeTargetLabels)?yu(i,n.labelBounds.all):(r.includeMainLabels&&yu(i,n.labelBounds.mainRot),r.includeSourceLabels&&yu(i,n.labelBounds.sourceRot),r.includeTargetLabels&&yu(i,n.labelBounds.targetRot))),i.w=i.x2-i.x1,i.h=i.y2-i.y1}return i},ag={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},RN=sj(ag),DN=Ni(ag);Xu.boundingBox=function(t){var e,r=t===void 0||t.useCache===void 0||t.useCache===!0,n=rh(function(c){var f=c._private;return f.bbCache==null||f.styleDirty||f.bbCachePosKey!==oj(c)},function(c){return c.id()});if(r&&this.length===1&&!n(this[0]))t===void 0?t=ag:t=DN(t),e=AN(this[0],t);else{e=ea(),t=t||ag;var i=DN(t),a=this,s=a.cy(),o=s.styleEnabled();this.edges().forEach(n),this.nodes().forEach(n),o&&this.recalculateRenderedStyle(r),this.updateCompoundBounds(!r);for(var l=0;l<a.length;l++){var u=a[l];n(u)&&u.dirtyBoundingBoxCache(),yu(e,AN(u,i))}}return e.x1=ss(e.x1),e.y1=ss(e.y1),e.x2=ss(e.x2),e.y2=ss(e.y2),e.w=ss(e.x2-e.x1),e.h=ss(e.y2-e.y1),e};Xu.dirtyBoundingBoxCache=function(){for(var t=0;t<this.length;t++){var e=this[t]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Xu.boundingBoxAt=function(t){var e=this.nodes(),r=this.cy(),n=r.hasCompoundNodes(),i=r.collection();if(n&&(i=e.filter(function(u){return u.isParent()}),e=e.not(i)),Zt(t)){var a=t;t=function(){return a}}var s=function(c,f){return c._private.bbAtOldPos=t(c,f)},o=function(c){return c._private.bbAtOldPos};r.startBatch(),e.forEach(s).silentPositions(t),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0));var l=wO(this.boundingBox({useCache:!1}));return e.silentPositions(o),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0)),r.endBatch(),l};Jf.boundingbox=Jf.bb=Jf.boundingBox;Jf.renderedBoundingbox=Jf.renderedBoundingBox;var UI=Xu,jm,Ag;jm=Ag={};var lj=function(e){e.uppercaseName=YC(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=YC(e.outerName),jm[e.name]=function(){var n=this[0],i=n._private,a=i.cy,s=a._private.styleEnabled;if(n)if(s){if(n.isParent())return n.updateCompoundBounds(),i[e.autoName]||0;var o=n.pstyle(e.name);return o.strValue==="label"?(n.recalculateRenderedStyle(),i.rstyle[e.labelName]||0):o.pfValue}else return 1},jm["outer"+e.uppercaseName]=function(){var n=this[0],i=n._private,a=i.cy,s=a._private.styleEnabled;if(n)if(s){var o=n[e.name](),l=n.pstyle("border-position").value,u;l==="center"?u=n.pstyle("border-width").pfValue:l==="outside"?u=2*n.pstyle("border-width").pfValue:u=0;var c=2*n.padding();return o+u+c}else return 1},jm["rendered"+e.uppercaseName]=function(){var n=this[0];if(n){var i=n[e.name]();return i*this.cy().zoom()}},jm["rendered"+e.uppercaseOuterName]=function(){var n=this[0];if(n){var i=n[e.outerName]();return i*this.cy().zoom()}}};lj({name:"width"});lj({name:"height"});Ag.padding=function(){var t=this[0],e=t._private;return t.isParent()?(t.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:t.pstyle("padding").pfValue):t.pstyle("padding").pfValue};Ag.paddedHeight=function(){var t=this[0];return t.height()+2*t.padding()};Ag.paddedWidth=function(){var t=this[0];return t.width()+2*t.padding()};var GI=Ag,HI=function(e,r){if(e.isEdge()&&e.takesUpSpace())return r(e)},qI=function(e,r){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy();return ox(r(e),n.zoom(),n.pan())}},WI=function(e,r){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy(),i=n.pan(),a=n.zoom();return r(e).map(function(s){return ox(s,a,i)})}},$I=function(e){return e.renderer().getControlPoints(e)},KI=function(e){return e.renderer().getSegmentPoints(e)},YI=function(e){return e.renderer().getSourceEndpoint(e)},XI=function(e){return e.renderer().getTargetEndpoint(e)},QI=function(e){return e.renderer().getEdgeMidpoint(e)},ON={controlPoints:{get:$I,mult:!0},segmentPoints:{get:KI,mult:!0},sourceEndpoint:{get:YI},targetEndpoint:{get:XI},midpoint:{get:QI}},JI=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},ZI=Object.keys(ON).reduce(function(t,e){var r=ON[e],n=JI(e);return t[e]=function(){return HI(this,r.get)},r.mult?t[n]=function(){return WI(this,r.get)}:t[n]=function(){return qI(this,r.get)},t},{}),eL=Ct({},FI,UI,GI,ZI);var uj=function(e,r){this.recycle(e,r)};function Ep(){return!1}function t0(){return!0}uj.prototype={instanceString:function(){return"event"},recycle:function(e,r){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Ep,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?t0:Ep):e!=null&&e.type?r=e:this.type=e,r!=null&&(this.originalEvent=r.originalEvent,this.type=r.type!=null?r.type:this.type,this.cy=r.cy,this.target=r.target,this.position=r.position,this.renderedPosition=r.renderedPosition,this.namespace=r.namespace,this.layout=r.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,i=this.cy.zoom(),a=this.cy.pan();this.renderedPosition={x:n.x*i+a.x,y:n.y*i+a.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=t0;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=t0;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=t0,this.stopPropagation()},isDefaultPrevented:Ep,isPropagationStopped:Ep,isImmediatePropagationStopped:Ep};var cj=/^([^.]+)(\.(?:[^.]+))?$/,tL=".*",dj={qualifierCompare:function(e,r){return e===r},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},IN=Object.keys(dj),rL={};function px(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rL,e=arguments.length>1?arguments[1]:void 0,r=0;r<IN.length;r++){var n=IN[r];this[n]=t[n]||dj[n]}this.context=e||this.context,this.listeners=[],this.emitting=0}var Gu=px.prototype,fj=function(e,r,n,i,a,s,o){Qr(i)&&(a=i,i=null),o&&(s==null?s=o:s=Ct({},s,o));for(var l=Nr(n)?n:n.split(/\s+/),u=0;u<l.length;u++){var c=l[u];if(!Bu(c)){var f=c.match(cj);if(f){var m=f[1],g=f[2]?f[2]:null,y=r(e,c,m,g,i,a,s);if(y===!1)break}}}},LN=function(e,r){return e.addEventFields(e.context,r),new uj(r.type,r)},nL=function(e,r,n){if(uD(n)){r(e,n);return}else if(Zt(n)){r(e,LN(e,n));return}for(var i=Nr(n)?n:n.split(/\s+/),a=0;a<i.length;a++){var s=i[a];if(!Bu(s)){var o=s.match(cj);if(o){var l=o[1],u=o[2]?o[2]:null,c=LN(e,{type:l,namespace:u,target:e.context});r(e,c)}}}};Gu.on=Gu.addListener=function(t,e,r,n,i){return fj(this,function(a,s,o,l,u,c,f){Qr(c)&&a.listeners.push({event:s,callback:c,type:o,namespace:l,qualifier:u,conf:f})},t,e,r,n,i),this};Gu.one=function(t,e,r,n){return this.on(t,e,r,n,{one:!0})};Gu.removeListener=Gu.off=function(t,e,r,n){var i=this;this.emitting!==0&&(this.listeners=qD(this.listeners));for(var a=this.listeners,s=function(u){var c=a[u];fj(i,function(f,m,g,y,b,w){if((c.type===g||t==="*")&&(!y&&c.namespace!==".*"||c.namespace===y)&&(!b||f.qualifierCompare(c.qualifier,b))&&(!w||c.callback===w))return a.splice(u,1),!1},t,e,r,n)},o=a.length-1;o>=0;o--)s(o);return this};Gu.removeAllListeners=function(){return this.removeListener("*")};Gu.emit=Gu.trigger=function(t,e,r){var n=this.listeners,i=n.length;return this.emitting++,Nr(e)||(e=[e]),nL(this,function(a,s){r!=null&&(n=[{event:s.event,type:s.type,namespace:s.namespace,callback:r}],i=n.length);for(var o=function(){var c=n[l];if(c.type===s.type&&(!c.namespace||c.namespace===s.namespace||c.namespace===tL)&&a.eventMatches(a.context,c,s)){var f=[s];e!=null&&$D(f,e),a.beforeEmit(a.context,c,s),c.conf&&c.conf.one&&(a.listeners=a.listeners.filter(function(y){return y!==c}));var m=a.callbackContext(a.context,c,s),g=c.callback.apply(m,f);a.afterEmit(a.context,c,s),g===!1&&(s.stopPropagation(),s.preventDefault())}},l=0;l<i;l++)o();a.bubble(a.context)&&!s.isPropagationStopped()&&a.parent(a.context).emit(s,e)},t),this.emitting--,this};var iL={qualifierCompare:function(e,r){return e==null||r==null?e==null&&r==null:e.sameText(r)},eventMatches:function(e,r,n){var i=r.qualifier;return i!=null?e!==n.target&&Eg(n.target)&&i.matches(n.target):!0},addEventFields:function(e,r){r.cy=e.cy(),r.target=e},callbackContext:function(e,r,n){return r.qualifier!=null?n.target:e},beforeEmit:function(e,r){r.conf&&r.conf.once&&r.conf.onceCollection.removeListener(r.event,r.qualifier,r.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},r0=function(e){return xt(e)?new Vu(e):e},hj={createEmitter:function(){for(var e=0;e<this.length;e++){var r=this[e],n=r._private;n.emitter||(n.emitter=new px(iL,r))}return this},emitter:function(){return this._private.emitter},on:function(e,r,n){for(var i=r0(r),a=0;a<this.length;a++){var s=this[a];s.emitter().on(e,i,n)}return this},removeListener:function(e,r,n){for(var i=r0(r),a=0;a<this.length;a++){var s=this[a];s.emitter().removeListener(e,i,n)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var r=this[e];r.emitter().removeAllListeners()}return this},one:function(e,r,n){for(var i=r0(r),a=0;a<this.length;a++){var s=this[a];s.emitter().one(e,i,n)}return this},once:function(e,r,n){for(var i=r0(r),a=0;a<this.length;a++){var s=this[a];s.emitter().on(e,i,n,{once:!0,onceCollection:this})}},emit:function(e,r){for(var n=0;n<this.length;n++){var i=this[n];i.emitter().emit(e,r)}return this},emitAndNotify:function(e,r){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,r),this}};or.eventAliasesOn(hj);var pj={nodes:function(e){return this.filter(function(r){return r.isNode()}).filter(e)},edges:function(e){return this.filter(function(r){return r.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),r=this.spawn(),n=0;n<this.length;n++){var i=this[n];i.isNode()?e.push(i):r.push(i)}return{nodes:e,edges:r}},filter:function(e,r){if(e===void 0)return this;if(xt(e)||Fa(e))return new Vu(e).filter(this);if(Qr(e)){for(var n=this.spawn(),i=this,a=0;a<i.length;a++){var s=i[a],o=r?e.apply(r,[s,a,i]):e(s,a,i);o&&n.push(s)}return n}return this.spawn()},not:function(e){if(e){xt(e)&&(e=this.filter(e));for(var r=this.spawn(),n=0;n<this.length;n++){var i=this[n],a=e.has(i);a||r.push(i)}return r}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(xt(e)){var r=e;return this.filter(r)}for(var n=this.spawn(),i=this,a=e,s=this.length<e.length,o=s?i:a,l=s?a:i,u=0;u<o.length;u++){var c=o[u];l.has(c)&&n.push(c)}return n},xor:function(e){var r=this._private.cy;xt(e)&&(e=r.$(e));var n=this.spawn(),i=this,a=e,s=function(l,u){for(var c=0;c<l.length;c++){var f=l[c],m=f._private.data.id,g=u.hasElementWithId(m);g||n.push(f)}};return s(i,a),s(a,i),n},diff:function(e){var r=this._private.cy;xt(e)&&(e=r.$(e));var n=this.spawn(),i=this.spawn(),a=this.spawn(),s=this,o=e,l=function(c,f,m){for(var g=0;g<c.length;g++){var y=c[g],b=y._private.data.id,w=f.hasElementWithId(b);w?a.merge(y):m.push(y)}};return l(s,o,n),l(o,s,i),{left:n,right:i,both:a}},add:function(e){var r=this._private.cy;if(!e)return this;if(xt(e)){var n=e;e=r.mutableElements().filter(n)}for(var i=this.spawnSelf(),a=0;a<e.length;a++){var s=e[a],o=!this.has(s);o&&i.push(s)}return i},merge:function(e){var r=this._private,n=r.cy;if(!e)return this;if(e&&xt(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=r.map,s=0;s<e.length;s++){var o=e[s],l=o._private.data.id,u=!a.has(l);if(u){var c=this.length++;this[c]=o,a.set(l,{ele:o,index:c})}}return this},unmergeAt:function(e){var r=this[e],n=r.id(),i=this._private,a=i.map;this[e]=void 0,a.delete(n);var s=e===this.length-1;if(this.length>1&&!s){var o=this.length-1,l=this[o],u=l._private.data.id;this[o]=void 0,this[e]=l,a.set(u,{ele:l,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var r=this._private,n=e._private.data.id,i=r.map,a=i.get(n);if(!a)return this;var s=a.index;return this.unmergeAt(s),this},unmerge:function(e){var r=this._private.cy;if(!e)return this;if(e&&xt(e)){var n=e;e=r.mutableElements().filter(n)}for(var i=0;i<e.length;i++)this.unmergeOne(e[i]);return this},unmergeBy:function(e){for(var r=this.length-1;r>=0;r--){var n=this[r];e(n)&&this.unmergeAt(r)}return this},map:function(e,r){for(var n=[],i=this,a=0;a<i.length;a++){var s=i[a],o=r?e.apply(r,[s,a,i]):e(s,a,i);n.push(o)}return n},reduce:function(e,r){for(var n=r,i=this,a=0;a<i.length;a++)n=e(n,i[a],a,i);return n},max:function(e,r){for(var n=-1/0,i,a=this,s=0;s<a.length;s++){var o=a[s],l=r?e.apply(r,[o,s,a]):e(o,s,a);l>n&&(n=l,i=o)}return{value:n,ele:i}},min:function(e,r){for(var n=1/0,i,a=this,s=0;s<a.length;s++){var o=a[s],l=r?e.apply(r,[o,s,a]):e(o,s,a);l<n&&(n=l,i=o)}return{value:n,ele:i}}},tr=pj;tr.u=tr["|"]=tr["+"]=tr.union=tr.or=tr.add;tr["\\"]=tr["!"]=tr["-"]=tr.difference=tr.relativeComplement=tr.subtract=tr.not;tr.n=tr["&"]=tr["."]=tr.and=tr.intersection=tr.intersect;tr["^"]=tr["(+)"]=tr["(-)"]=tr.symmetricDifference=tr.symdiff=tr.xor;tr.fnFilter=tr.filterFn=tr.stdFilter=tr.filter;tr.complement=tr.abscomp=tr.absoluteComplement;var aL={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},mj=function(e,r){var n=e.cy(),i=n.hasCompoundNodes();function a(c){var f=c.pstyle("z-compound-depth");return f.value==="auto"?i?c.zDepth():0:f.value==="bottom"?-1:f.value==="top"?ES:0}var s=a(e)-a(r);if(s!==0)return s;function o(c){var f=c.pstyle("z-index-compare");return f.value==="auto"&&c.isNode()?1:0}var l=o(e)-o(r);if(l!==0)return l;var u=e.pstyle("z-index").value-r.pstyle("z-index").value;return u!==0?u:e.poolIndex()-r.poolIndex()},ry={forEach:function(e,r){if(Qr(e))for(var n=this.length,i=0;i<n;i++){var a=this[i],s=r?e.apply(r,[a,i,this]):e(a,i,this);if(s===!1)break}return this},toArray:function(){for(var e=[],r=0;r<this.length;r++)e.push(this[r]);return e},slice:function(e,r){var n=[],i=this.length;r==null&&(r=i),e==null&&(e=0),e<0&&(e=i+e),r<0&&(r=i+r);for(var a=e;a>=0&&a<r&&a<i;a++)n.push(this[a]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!Qr(e))return this;var r=this.toArray().sort(e);return this.spawn(r)},sortByZIndex:function(){return this.sort(mj)},zDepth:function(){var e=this[0];if(e){var r=e._private,n=r.group;if(n==="nodes"){var i=r.data.parent?e.parents().size():0;return e.isParent()?i:ES-1}else{var a=r.source,s=r.target,o=a.zDepth(),l=s.zDepth();return Math.max(o,l,0)}}}};ry.each=ry.forEach;var sL=function(){var e="undefined",r=(typeof Symbol>"u"?"undefined":Vn(Symbol))!=e&&Vn(Symbol.iterator)!=e;r&&(ry[Symbol.iterator]=function(){var n=this,i={value:void 0,done:!1},a=0,s=this.length;return h6({next:function(){return a<s?i.value=n[a++]:(i.value=void 0,i.done=!0),i}},Symbol.iterator,function(){return this})})};sL();var oL=Ni({nodeDimensionsIncludeLabels:!1}),A0={layoutDimensions:function(e){e=oL(e);var r;if(!this.takesUpSpace())r={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();r={w:n.w,h:n.h}}else r={w:this.outerWidth(),h:this.outerHeight()};return(r.w===0||r.h===0)&&(r.w=r.h=1),r},layoutPositions:function(e,r,n){var i=this.nodes().filter(function(P){return!P.isParent()}),a=this.cy(),s=r.eles,o=function(_){return _.id()},l=rh(n,o);e.emit({type:"layoutstart",layout:e}),e.animations=[];var u=function(_,A,I){var D={x:A.x1+A.w/2,y:A.y1+A.h/2},L={x:(I.x-D.x)*_,y:(I.y-D.y)*_};return{x:D.x+L.x,y:D.y+L.y}},c=r.spacingFactor&&r.spacingFactor!==1,f=function(){if(!c)return null;for(var _=ea(),A=0;A<i.length;A++){var I=i[A],D=l(I,A);R6(_,D.x,D.y)}return _},m=f(),g=rh(function(P,_){var A=l(P,_);if(c){var I=Math.abs(r.spacingFactor);A=u(I,m,A)}return r.transform!=null&&(A=r.transform(P,A)),A},o);if(r.animate){for(var y=0;y<i.length;y++){var b=i[y],w=g(b,y),N=r.animateFilter==null||r.animateFilter(b,y);if(N){var k=b.animation({position:w,duration:r.animationDuration,easing:r.animationEasing});e.animations.push(k)}else b.position(w)}if(r.fit){var C=a.animation({fit:{boundingBox:s.boundingBoxAt(g),padding:r.padding},duration:r.animationDuration,easing:r.animationEasing});e.animations.push(C)}else if(r.zoom!==void 0&&r.pan!==void 0){var E=a.animation({zoom:r.zoom,pan:r.pan,duration:r.animationDuration,easing:r.animationEasing});e.animations.push(E)}e.animations.forEach(function(P){return P.play()}),e.one("layoutready",r.ready),e.emit({type:"layoutready",layout:e}),wh.all(e.animations.map(function(P){return P.promise()})).then(function(){e.one("layoutstop",r.stop),e.emit({type:"layoutstop",layout:e})})}else i.positions(g),r.fit&&a.fit(r.eles,r.padding),r.zoom!=null&&a.zoom(r.zoom),r.pan&&a.pan(r.pan),e.one("layoutready",r.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",r.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var r=this.cy();return r.makeLayout(Ct({},e,{eles:this}))}};A0.createLayout=A0.makeLayout=A0.layout;function gj(t,e,r){var n=r._private,i=n.styleCache=n.styleCache||[],a;return(a=i[t])!=null||(a=i[t]=e(r)),a}function mx(t,e){return t=ud(t),function(n){return gj(t,e,n)}}function gx(t,e){t=ud(t);var r=function(i){return e.call(i)};return function(){var i=this[0];if(i)return gj(t,r,i)}}var Si={recalculateRenderedStyle:function(e){var r=this.cy(),n=r.renderer(),i=r.styleEnabled();return n&&i&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),r=function(a){return a._private.styleCache=null};if(e.hasCompoundNodes()){var n;n=this.spawnSelf().merge(this.descendants()).merge(this.parents()),n.merge(n.connectedEdges()),n.forEach(r)}else this.forEach(function(i){r(i),i.connectedEdges().forEach(r)});return this},updateStyle:function(e){var r=this._private.cy;if(!r.styleEnabled())return this;if(r.batching()){var n=r._private.batchStyleEles;return n.merge(this),this}var i=r.hasCompoundNodes(),a=this;e=!!(e||e===void 0),i&&(a=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var s=a;return e?s.emitAndNotify("style"):s.emit("style"),a.forEach(function(o){return o._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var r=0;r<this.length;r++){var n=this[r];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this[0],i=n.cy();if(i.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,i.style().apply(n));var a=n._private.style[e];return a??(r?i.style().getDefaultProperty(e):null)}},numericStyle:function(e){var r=this[0];if(r.cy().styleEnabled()&&r){var n=r.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var r=this[0];if(r.cy().styleEnabled()&&r)return r.pstyle(e).units},renderedStyle:function(e){var r=this.cy();if(!r.styleEnabled())return this;var n=this[0];if(n)return r.style().getRenderedStyle(n,e)},style:function(e,r){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style();if(Zt(e)){var s=e;a.applyBypass(this,s,i),this.emitAndNotify("style")}else if(xt(e))if(r===void 0){var o=this[0];return o?a.getStylePropertyValue(o,e):void 0}else a.applyBypass(this,e,r,i),this.emitAndNotify("style");else if(e===void 0){var l=this[0];return l?a.getRawStyle(l):void 0}return this},removeStyle:function(e){var r=this.cy();if(!r.styleEnabled())return this;var n=!1,i=r.style(),a=this;if(e===void 0)for(var s=0;s<a.length;s++){var o=a[s];i.removeAllBypasses(o,n)}else{e=e.split(/\s+/);for(var l=0;l<a.length;l++){var u=a[l];i.removeBypasses(u,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var r=e.hasCompoundNodes(),n=this[0];if(n){var i=n._private,a=n.pstyle("opacity").value;if(!r)return a;var s=i.data.parent?n.parents():null;if(s)for(var o=0;o<s.length;o++){var l=s[o],u=l.pstyle("opacity").value;a=u*a}return a}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var r=this[0],n=r.cy().hasCompoundNodes();if(r)return n?r.effectiveOpacity()===0:r.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var r=this[0];return!!r._private.backgrounding}};function Yb(t,e){var r=t._private,n=r.data.parent?t.parents():null;if(n)for(var i=0;i<n.length;i++){var a=n[i];if(!e(a))return!1}return!0}function BS(t){var e=t.ok,r=t.edgeOkViaNode||t.ok,n=t.parentOk||t.ok;return function(){var i=this.cy();if(!i.styleEnabled())return!0;var a=this[0],s=i.hasCompoundNodes();if(a){var o=a._private;if(!e(a))return!1;if(a.isNode())return!s||Yb(a,n);var l=o.source,u=o.target;return r(l)&&(!s||Yb(l,r))&&(l===u||r(u)&&(!s||Yb(u,r)))}}}var Sh=mx("eleTakesUpSpace",function(t){return t.pstyle("display").value==="element"&&t.width()!==0&&(t.isNode()?t.height()!==0:!0)});Si.takesUpSpace=gx("takesUpSpace",BS({ok:Sh}));var lL=mx("eleInteractive",function(t){return t.pstyle("events").value==="yes"&&t.pstyle("visibility").value==="visible"&&Sh(t)}),uL=mx("parentInteractive",function(t){return t.pstyle("visibility").value==="visible"&&Sh(t)});Si.interactive=gx("interactive",BS({ok:lL,parentOk:uL,edgeOkViaNode:Sh}));Si.noninteractive=function(){var t=this[0];if(t)return!t.interactive()};var cL=mx("eleVisible",function(t){return t.pstyle("visibility").value==="visible"&&t.pstyle("opacity").pfValue!==0&&Sh(t)}),dL=Sh;Si.visible=gx("visible",BS({ok:cL,edgeOkViaNode:dL}));Si.hidden=function(){var t=this[0];if(t)return!t.visible()};Si.isBundledBezier=gx("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});Si.bypass=Si.css=Si.style;Si.renderedCss=Si.renderedStyle;Si.removeBypass=Si.removeCss=Si.removeStyle;Si.pstyle=Si.parsedStyle;var Ru={};function BN(t){return function(){var e=arguments,r=[];if(e.length===2){var n=e[0],i=e[1];this.on(t.event,n,i)}else if(e.length===1&&Qr(e[0])){var a=e[0];this.on(t.event,a)}else if(e.length===0||e.length===1&&Nr(e[0])){for(var s=e.length===1?e[0]:null,o=0;o<this.length;o++){var l=this[o],u=!t.ableField||l._private[t.ableField],c=l._private[t.field]!=t.value;if(t.overrideAble){var f=t.overrideAble(l);if(f!==void 0&&(u=f,!f))return this}u&&(l._private[t.field]=t.value,c&&r.push(l))}var m=this.spawn(r);m.updateStyle(),m.emit(t.event),s&&m.emit(s)}return this}}function kh(t){Ru[t.field]=function(){var e=this[0];if(e){if(t.overrideField){var r=t.overrideField(e);if(r!==void 0)return r}return e._private[t.field]}},Ru[t.on]=BN({event:t.on,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!0}),Ru[t.off]=BN({event:t.off,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!1})}kh({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});kh({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});kh({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});kh({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});Ru.deselect=Ru.unselect;Ru.grabbed=function(){var t=this[0];if(t)return t._private.grabbed};kh({field:"active",on:"activate",off:"unactivate"});kh({field:"pannable",on:"panify",off:"unpanify"});Ru.inactive=function(){var t=this[0];if(t)return!t._private.active};var Oi={},FN=function(e){return function(n){for(var i=this,a=[],s=0;s<i.length;s++){var o=i[s];if(o.isNode()){for(var l=!1,u=o.connectedEdges(),c=0;c<u.length;c++){var f=u[c],m=f.source(),g=f.target();if(e.noIncomingEdges&&g===o&&m!==o||e.noOutgoingEdges&&m===o&&g!==o){l=!0;break}}l||a.push(o)}}return this.spawn(a,!0).filter(n)}},zN=function(e){return function(r){for(var n=this,i=[],a=0;a<n.length;a++){var s=n[a];if(s.isNode())for(var o=s.connectedEdges(),l=0;l<o.length;l++){var u=o[l],c=u.source(),f=u.target();e.outgoing&&c===s?(i.push(u),i.push(f)):e.incoming&&f===s&&(i.push(u),i.push(c))}}return this.spawn(i,!0).filter(r)}},VN=function(e){return function(r){for(var n=this,i=[],a={};;){var s=e.outgoing?n.outgoers():n.incomers();if(s.length===0)break;for(var o=!1,l=0;l<s.length;l++){var u=s[l],c=u.id();a[c]||(a[c]=!0,i.push(u),o=!0)}if(!o)break;n=s}return this.spawn(i,!0).filter(r)}};Oi.clearTraversalCache=function(){for(var t=0;t<this.length;t++)this[t]._private.traversalCache=null};Ct(Oi,{roots:FN({noIncomingEdges:!0}),leaves:FN({noOutgoingEdges:!0}),outgoers:us(zN({outgoing:!0}),"outgoers"),successors:VN({outgoing:!0}),incomers:us(zN({incoming:!0}),"incomers"),predecessors:VN({})});Ct(Oi,{neighborhood:us(function(t){for(var e=[],r=this.nodes(),n=0;n<r.length;n++)for(var i=r[n],a=i.connectedEdges(),s=0;s<a.length;s++){var o=a[s],l=o.source(),u=o.target(),c=i===l?u:l;c.length>0&&e.push(c[0]),e.push(o[0])}return this.spawn(e,!0).filter(t)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});Oi.neighbourhood=Oi.neighborhood;Oi.closedNeighbourhood=Oi.closedNeighborhood;Oi.openNeighbourhood=Oi.openNeighborhood;Ct(Oi,{source:us(function(e){var r=this[0],n;return r&&(n=r._private.source||r.cy().collection()),n&&e?n.filter(e):n},"source"),target:us(function(e){var r=this[0],n;return r&&(n=r._private.target||r.cy().collection()),n&&e?n.filter(e):n},"target"),sources:UN({attr:"source"}),targets:UN({attr:"target"})});function UN(t){return function(r){for(var n=[],i=0;i<this.length;i++){var a=this[i],s=a._private[t.attr];s&&n.push(s)}return this.spawn(n,!0).filter(r)}}Ct(Oi,{edgesWith:us(GN(),"edgesWith"),edgesTo:us(GN({thisIsSrc:!0}),"edgesTo")});function GN(t){return function(r){var n=[],i=this._private.cy,a=t||{};xt(r)&&(r=i.$(r));for(var s=0;s<r.length;s++)for(var o=r[s]._private.edges,l=0;l<o.length;l++){var u=o[l],c=u._private.data,f=this.hasElementWithId(c.source)&&r.hasElementWithId(c.target),m=r.hasElementWithId(c.source)&&this.hasElementWithId(c.target),g=f||m;g&&((a.thisIsSrc||a.thisIsTgt)&&(a.thisIsSrc&&!f||a.thisIsTgt&&!m)||n.push(u))}return this.spawn(n,!0)}}Ct(Oi,{connectedEdges:us(function(t){for(var e=[],r=this,n=0;n<r.length;n++){var i=r[n];if(i.isNode())for(var a=i._private.edges,s=0;s<a.length;s++){var o=a[s];e.push(o)}}return this.spawn(e,!0).filter(t)},"connectedEdges"),connectedNodes:us(function(t){for(var e=[],r=this,n=0;n<r.length;n++){var i=r[n];i.isEdge()&&(e.push(i.source()[0]),e.push(i.target()[0]))}return this.spawn(e,!0).filter(t)},"connectedNodes"),parallelEdges:us(HN(),"parallelEdges"),codirectedEdges:us(HN({codirected:!0}),"codirectedEdges")});function HN(t){var e={codirected:!1};return t=Ct({},e,t),function(n){for(var i=[],a=this.edges(),s=t,o=0;o<a.length;o++)for(var l=a[o],u=l._private,c=u.source,f=c._private.data.id,m=u.data.target,g=c._private.edges,y=0;y<g.length;y++){var b=g[y],w=b._private.data,N=w.target,k=w.source,C=N===m&&k===f,E=f===N&&m===k;(s.codirected&&C||!s.codirected&&(C||E))&&i.push(b)}return this.spawn(i,!0).filter(n)}}Ct(Oi,{components:function(e){var r=this,n=r.cy(),i=n.collection(),a=e==null?r.nodes():e.nodes(),s=[];e!=null&&a.empty()&&(a=e.sources());var o=function(c,f){i.merge(c),a.unmerge(c),f.merge(c)};if(a.empty())return r.spawn();var l=function(){var c=n.collection();s.push(c);var f=a[0];o(f,c),r.bfs({directed:!1,roots:f,visit:function(g){return o(g,c)}}),c.forEach(function(m){m.connectedEdges().forEach(function(g){r.has(g)&&c.has(g.source())&&c.has(g.target())&&c.merge(g)})})};do l();while(a.length>0);return s},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});Oi.componentsOf=Oi.components;var ki=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){Hr("A collection must have a reference to the core");return}var a=new ul,s=!1;if(!r)r=[];else if(r.length>0&&Zt(r[0])&&!Eg(r[0])){s=!0;for(var o=[],l=new bh,u=0,c=r.length;u<c;u++){var f=r[u];f.data==null&&(f.data={});var m=f.data;if(m.id==null)m.id=M6();else if(e.hasElementWithId(m.id)||l.has(m.id))continue;var g=new sx(e,f,!1);o.push(g),l.add(m.id)}r=o}this.length=0;for(var y=0,b=r.length;y<b;y++){var w=r[y][0];if(w!=null){var N=w._private.data.id;(!n||!a.has(N))&&(n&&a.set(N,{index:this.length,ele:w}),this[this.length]=w,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(k){this.lazyMap=k},rebuildMap:function(){for(var C=this.lazyMap=new ul,E=this.eles,P=0;P<E.length;P++){var _=E[P];C.set(_.id(),{index:P,ele:_})}}},n&&(this._private.map=a),s&&!i&&this.restore()},Rr=sx.prototype=ki.prototype=Object.create(Array.prototype);Rr.instanceString=function(){return"collection"};Rr.spawn=function(t,e){return new ki(this.cy(),t,e)};Rr.spawnSelf=function(){return this.spawn(this)};Rr.cy=function(){return this._private.cy};Rr.renderer=function(){return this._private.cy.renderer()};Rr.element=function(){return this[0]};Rr.collection=function(){return g6(this)?this:new ki(this._private.cy,[this])};Rr.unique=function(){return new ki(this._private.cy,this,!0)};Rr.hasElementWithId=function(t){return t=""+t,this._private.map.has(t)};Rr.getElementById=function(t){t=""+t;var e=this._private.cy,r=this._private.map.get(t);return r?r.ele:new ki(e)};Rr.$id=Rr.getElementById;Rr.poolIndex=function(){var t=this._private.cy,e=t._private.elements,r=this[0]._private.data.id;return e._private.map.get(r).index};Rr.indexOf=function(t){var e=t[0]._private.data.id;return this._private.map.get(e).index};Rr.indexOfId=function(t){return t=""+t,this._private.map.get(t).index};Rr.json=function(t){var e=this.element(),r=this.cy();if(e==null&&t)return this;if(e!=null){var n=e._private;if(Zt(t)){if(r.startBatch(),t.data){e.data(t.data);var i=n.data;if(e.isEdge()){var a=!1,s={},o=t.data.source,l=t.data.target;o!=null&&o!=i.source&&(s.source=""+o,a=!0),l!=null&&l!=i.target&&(s.target=""+l,a=!0),a&&(e=e.move(s))}else{var u="parent"in t.data,c=t.data.parent;u&&(c!=null||i.parent!=null)&&c!=i.parent&&(c===void 0&&(c=null),c!=null&&(c=""+c),e=e.move({parent:c}))}}t.position&&e.position(t.position);var f=function(b,w,N){var k=t[b];k!=null&&k!==n[b]&&(k?e[w]():e[N]())};return f("removed","remove","restore"),f("selected","select","unselect"),f("selectable","selectify","unselectify"),f("locked","lock","unlock"),f("grabbable","grabify","ungrabify"),f("pannable","panify","unpanify"),t.classes!=null&&e.classes(t.classes),r.endBatch(),this}else if(t===void 0){var m={data:xo(n.data),position:xo(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};m.classes="";var g=0;return n.classes.forEach(function(y){return m.classes+=g++===0?y:" "+y}),m}}};Rr.jsons=function(){for(var t=[],e=0;e<this.length;e++){var r=this[e],n=r.json();t.push(n)}return t};Rr.clone=function(){for(var t=this.cy(),e=[],r=0;r<this.length;r++){var n=this[r],i=n.json(),a=new sx(t,i,!1);e.push(a)}return new ki(t,e)};Rr.copy=Rr.clone;Rr.restore=function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,n=r.cy(),i=n._private,a=[],s=[],o,l=0,u=r.length;l<u;l++){var c=r[l];e&&!c.removed()||(c.isNode()?a.push(c):s.push(c))}o=a.concat(s);var f,m=function(){o.splice(f,1),f--};for(f=0;f<o.length;f++){var g=o[f],y=g._private,b=y.data;if(g.clearTraversalCache(),!(!e&&!y.removed)){if(b.id===void 0)b.id=M6();else if(Qe(b.id))b.id=""+b.id;else if(Bu(b.id)||!xt(b.id)){Hr("Can not create element with invalid string ID `"+b.id+"`"),m();continue}else if(n.hasElementWithId(b.id)){Hr("Can not create second element with ID `"+b.id+"`"),m();continue}}var w=b.id;if(g.isNode()){var N=y.position;N.x==null&&(N.x=0),N.y==null&&(N.y=0)}if(g.isEdge()){for(var k=g,C=["source","target"],E=C.length,P=!1,_=0;_<E;_++){var A=C[_],I=b[A];Qe(I)&&(I=b[A]=""+b[A]),I==null||I===""?(Hr("Can not create edge `"+w+"` with unspecified "+A),P=!0):n.hasElementWithId(I)||(Hr("Can not create edge `"+w+"` with nonexistant "+A+" `"+I+"`"),P=!0)}if(P){m();continue}var D=n.getElementById(b.source),L=n.getElementById(b.target);D.same(L)?D._private.edges.push(k):(D._private.edges.push(k),L._private.edges.push(k)),k._private.source=D,k._private.target=L}y.map=new ul,y.map.set(w,{ele:g,index:0}),y.removed=!1,e&&n.addToPool(g)}for(var U=0;U<a.length;U++){var H=a[U],M=H._private.data;Qe(M.parent)&&(M.parent=""+M.parent);var z=M.parent,O=z!=null;if(O||H._private.parent){var G=H._private.parent?n.collection().merge(H._private.parent):n.getElementById(z);if(G.empty())M.parent=void 0;else if(G[0].removed())lr("Node added with missing parent, reference to parent removed"),M.parent=void 0,H._private.parent=null;else{for(var W=!1,$=G;!$.empty();){if(H.same($)){W=!0,M.parent=void 0;break}$=$.parent()}W||(G[0]._private.children.push(H),H._private.parent=G[0],i.hasCompoundNodes=!0)}}}if(o.length>0){for(var X=o.length===r.length?r:new ki(n,o),Q=0;Q<X.length;Q++){var V=X[Q];V.isNode()||(V.parallelEdges().clearTraversalCache(),V.source().clearTraversalCache(),V.target().clearTraversalCache())}var Y;i.hasCompoundNodes?Y=n.collection().merge(X).merge(X.connectedNodes()).merge(X.parent()):Y=X,Y.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(t),t?X.emitAndNotify("add"):e&&X.emit("add")}return r};Rr.removed=function(){var t=this[0];return t&&t._private.removed};Rr.inside=function(){var t=this[0];return t&&!t._private.removed};Rr.remove=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,n=[],i={},a=r._private.cy;function s(z){for(var O=z._private.edges,G=0;G<O.length;G++)l(O[G])}function o(z){for(var O=z._private.children,G=0;G<O.length;G++)l(O[G])}function l(z){var O=i[z.id()];e&&z.removed()||O||(i[z.id()]=!0,z.isNode()?(n.push(z),s(z),o(z)):n.unshift(z))}for(var u=0,c=r.length;u<c;u++){var f=r[u];l(f)}function m(z,O){var G=z._private.edges;Fu(G,O),z.clearTraversalCache()}function g(z){z.clearTraversalCache()}var y=[];y.ids={};function b(z,O){O=O[0],z=z[0];var G=z._private.children,W=z.id();Fu(G,O),O._private.parent=null,y.ids[W]||(y.ids[W]=!0,y.push(z))}r.dirtyCompoundBoundsCache(),e&&a.removeFromPool(n);for(var w=0;w<n.length;w++){var N=n[w];if(N.isEdge()){var k=N.source()[0],C=N.target()[0];m(k,N),m(C,N);for(var E=N.parallelEdges(),P=0;P<E.length;P++){var _=E[P];g(_),_.isBundledBezier()&&_.dirtyBoundingBoxCache()}}else{var A=N.parent();A.length!==0&&b(A,N)}e&&(N._private.removed=!0)}var I=a._private.elements;a._private.hasCompoundNodes=!1;for(var D=0;D<I.length;D++){var L=I[D];if(L.isParent()){a._private.hasCompoundNodes=!0;break}}var U=new ki(this.cy(),n);U.size()>0&&(t?U.emitAndNotify("remove"):e&&U.emit("remove"));for(var H=0;H<y.length;H++){var M=y[H];(!e||!M.removed())&&M.updateStyle()}return U};Rr.move=function(t){var e=this._private.cy,r=this,n=!1,i=!1,a=function(y){return y==null?y:""+y};if(t.source!==void 0||t.target!==void 0){var s=a(t.source),o=a(t.target),l=s!=null&&e.hasElementWithId(s),u=o!=null&&e.hasElementWithId(o);(l||u)&&(e.batch(function(){r.remove(n,i),r.emitAndNotify("moveout");for(var g=0;g<r.length;g++){var y=r[g],b=y._private.data;y.isEdge()&&(l&&(b.source=s),u&&(b.target=o))}r.restore(n,i)}),r.emitAndNotify("move"))}else if(t.parent!==void 0){var c=a(t.parent),f=c===null||e.hasElementWithId(c);if(f){var m=c===null?void 0:c;e.batch(function(){var g=r.remove(n,i);g.emitAndNotify("moveout");for(var y=0;y<r.length;y++){var b=r[y],w=b._private.data;b.isNode()&&(w.parent=m)}g.restore(n,i)}),r.emitAndNotify("move")}}return this};[U6,SI,_0,Au,ih,BI,hx,eL,hj,pj,aL,ry,A0,Si,Ru,Oi].forEach(function(t){Ct(Rr,t)});var fL={add:function(e){var r,n=this;if(Fa(e)){var i=e;if(i._private.cy===n)r=i.restore();else{for(var a=[],s=0;s<i.length;s++){var o=i[s];a.push(o.json())}r=new ki(n,a)}}else if(Nr(e)){var l=e;r=new ki(n,l)}else if(Zt(e)&&(Nr(e.nodes)||Nr(e.edges))){for(var u=e,c=[],f=["nodes","edges"],m=0,g=f.length;m<g;m++){var y=f[m],b=u[y];if(Nr(b))for(var w=0,N=b.length;w<N;w++){var k=Ct({group:y},b[w]);c.push(k)}}r=new ki(n,c)}else{var C=e;r=new sx(n,C).collection()}return r},remove:function(e){if(!Fa(e)){if(xt(e)){var r=e;e=this.$(r)}}return e.remove()}};function hL(t,e,r,n){var i=4,a=.001,s=1e-7,o=10,l=11,u=1/(l-1),c=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var f=0;f<4;++f)if(typeof arguments[f]!="number"||isNaN(arguments[f])||!isFinite(arguments[f]))return!1;t=Math.min(t,1),r=Math.min(r,1),t=Math.max(t,0),r=Math.max(r,0);var m=c?new Float32Array(l):new Array(l);function g(L,U){return 1-3*U+3*L}function y(L,U){return 3*U-6*L}function b(L){return 3*L}function w(L,U,H){return((g(U,H)*L+y(U,H))*L+b(U))*L}function N(L,U,H){return 3*g(U,H)*L*L+2*y(U,H)*L+b(U)}function k(L,U){for(var H=0;H<i;++H){var M=N(U,t,r);if(M===0)return U;var z=w(U,t,r)-L;U-=z/M}return U}function C(){for(var L=0;L<l;++L)m[L]=w(L*u,t,r)}function E(L,U,H){var M,z,O=0;do z=U+(H-U)/2,M=w(z,t,r)-L,M>0?H=z:U=z;while(Math.abs(M)>s&&++O<o);return z}function P(L){for(var U=0,H=1,M=l-1;H!==M&&m[H]<=L;++H)U+=u;--H;var z=(L-m[H])/(m[H+1]-m[H]),O=U+z*u,G=N(O,t,r);return G>=a?k(L,O):G===0?O:E(L,U,U+u)}var _=!1;function A(){_=!0,(t!==e||r!==n)&&C()}var I=function(U){return _||A(),t===e&&r===n?U:U===0?0:U===1?1:w(P(U),e,n)};I.getControlPoints=function(){return[{x:t,y:e},{x:r,y:n}]};var D="generateBezier("+[t,e,r,n]+")";return I.toString=function(){return D},I}var pL=(function(){function t(n){return-n.tension*n.x-n.friction*n.v}function e(n,i,a){var s={x:n.x+a.dx*i,v:n.v+a.dv*i,tension:n.tension,friction:n.friction};return{dx:s.v,dv:t(s)}}function r(n,i){var a={dx:n.v,dv:t(n)},s=e(n,i*.5,a),o=e(n,i*.5,s),l=e(n,i,o),u=1/6*(a.dx+2*(s.dx+o.dx)+l.dx),c=1/6*(a.dv+2*(s.dv+o.dv)+l.dv);return n.x=n.x+u*i,n.v=n.v+c*i,n}return function n(i,a,s){var o={x:-1,v:0,tension:null,friction:null},l=[0],u=0,c=1/1e4,f=16/1e3,m,g,y;for(i=parseFloat(i)||500,a=parseFloat(a)||20,s=s||null,o.tension=i,o.friction=a,m=s!==null,m?(u=n(i,a),g=u/s*f):g=f;y=r(y||o,g),l.push(1+y.x),u+=16,Math.abs(y.x)>c&&Math.abs(y.v)>c;);return m?function(b){return l[b*(l.length-1)|0]}:u}})(),Ar=function(e,r,n,i){var a=hL(e,r,n,i);return function(s,o,l){return s+(o-s)*a(l)}},R0={linear:function(e,r,n){return e+(r-e)*n},ease:Ar(.25,.1,.25,1),"ease-in":Ar(.42,0,1,1),"ease-out":Ar(0,0,.58,1),"ease-in-out":Ar(.42,0,.58,1),"ease-in-sine":Ar(.47,0,.745,.715),"ease-out-sine":Ar(.39,.575,.565,1),"ease-in-out-sine":Ar(.445,.05,.55,.95),"ease-in-quad":Ar(.55,.085,.68,.53),"ease-out-quad":Ar(.25,.46,.45,.94),"ease-in-out-quad":Ar(.455,.03,.515,.955),"ease-in-cubic":Ar(.55,.055,.675,.19),"ease-out-cubic":Ar(.215,.61,.355,1),"ease-in-out-cubic":Ar(.645,.045,.355,1),"ease-in-quart":Ar(.895,.03,.685,.22),"ease-out-quart":Ar(.165,.84,.44,1),"ease-in-out-quart":Ar(.77,0,.175,1),"ease-in-quint":Ar(.755,.05,.855,.06),"ease-out-quint":Ar(.23,1,.32,1),"ease-in-out-quint":Ar(.86,0,.07,1),"ease-in-expo":Ar(.95,.05,.795,.035),"ease-out-expo":Ar(.19,1,.22,1),"ease-in-out-expo":Ar(1,0,0,1),"ease-in-circ":Ar(.6,.04,.98,.335),"ease-out-circ":Ar(.075,.82,.165,1),"ease-in-out-circ":Ar(.785,.135,.15,.86),spring:function(e,r,n){if(n===0)return R0.linear;var i=pL(e,r,n);return function(a,s,o){return a+(s-a)*i(o)}},"cubic-bezier":Ar};function qN(t,e,r,n,i){if(n===1||e===r)return r;var a=i(e,r,n);return t==null||((t.roundValue||t.color)&&(a=Math.round(a)),t.min!==void 0&&(a=Math.max(a,t.min)),t.max!==void 0&&(a=Math.min(a,t.max))),a}function WN(t,e){return t.pfValue!=null||t.value!=null?t.pfValue!=null&&(e==null||e.type.units!=="%")?t.pfValue:t.value:t}function Tf(t,e,r,n,i){var a=i!=null?i.type:null;r<0?r=0:r>1&&(r=1);var s=WN(t,i),o=WN(e,i);if(Qe(s)&&Qe(o))return qN(a,s,o,r,n);if(Nr(s)&&Nr(o)){for(var l=[],u=0;u<o.length;u++){var c=s[u],f=o[u];if(c!=null&&f!=null){var m=qN(a,c,f,r,n);l.push(m)}else l.push(f)}return l}}function mL(t,e,r,n){var i=!n,a=t._private,s=e._private,o=s.easing,l=s.startTime,u=n?t:t.cy(),c=u.style();if(!s.easingImpl)if(o==null)s.easingImpl=R0.linear;else{var f;if(xt(o)){var m=c.parse("transition-timing-function",o);f=m.value}else f=o;var g,y;xt(f)?(g=f,y=[]):(g=f[1],y=f.slice(2).map(function(X){return+X})),y.length>0?(g==="spring"&&y.push(s.duration),s.easingImpl=R0[g].apply(null,y)):s.easingImpl=R0[g]}var b=s.easingImpl,w;if(s.duration===0?w=1:w=(r-l)/s.duration,s.applying&&(w=s.progress),w<0?w=0:w>1&&(w=1),s.delay==null){var N=s.startPosition,k=s.position;if(k&&i&&!t.locked()){var C={};Tp(N.x,k.x)&&(C.x=Tf(N.x,k.x,w,b)),Tp(N.y,k.y)&&(C.y=Tf(N.y,k.y,w,b)),t.position(C)}var E=s.startPan,P=s.pan,_=a.pan,A=P!=null&&n;A&&(Tp(E.x,P.x)&&(_.x=Tf(E.x,P.x,w,b)),Tp(E.y,P.y)&&(_.y=Tf(E.y,P.y,w,b)),t.emit("pan"));var I=s.startZoom,D=s.zoom,L=D!=null&&n;L&&(Tp(I,D)&&(a.zoom=rg(a.minZoom,Tf(I,D,w,b),a.maxZoom)),t.emit("zoom")),(A||L)&&t.emit("viewport");var U=s.style;if(U&&U.length>0&&i){for(var H=0;H<U.length;H++){var M=U[H],z=M.name,O=M,G=s.startStyle[z],W=c.properties[G.name],$=Tf(G,O,w,b,W);c.overrideBypass(t,z,$)}t.emit("style")}}return s.progress=w,w}function Tp(t,e){return t==null||e==null?!1:Qe(t)&&Qe(e)?!0:!!(t&&e)}function gL(t,e,r,n){var i=e._private;i.started=!0,i.startTime=r-i.progress*i.duration}function $N(t,e){var r=e._private.aniEles,n=[];function i(c,f){var m=c._private,g=m.animation.current,y=m.animation.queue,b=!1;if(g.length===0){var w=y.shift();w&&g.push(w)}for(var N=function(_){for(var A=_.length-1;A>=0;A--){var I=_[A];I()}_.splice(0,_.length)},k=g.length-1;k>=0;k--){var C=g[k],E=C._private;if(E.stopped){g.splice(k,1),E.hooked=!1,E.playing=!1,E.started=!1,N(E.frames);continue}!E.playing&&!E.applying||(E.playing&&E.applying&&(E.applying=!1),E.started||gL(c,C,t),mL(c,C,t,f),E.applying&&(E.applying=!1),N(E.frames),E.step!=null&&E.step(t),C.completed()&&(g.splice(k,1),E.hooked=!1,E.playing=!1,E.started=!1,N(E.completes)),b=!0)}return!f&&g.length===0&&y.length===0&&n.push(c),b}for(var a=!1,s=0;s<r.length;s++){var o=r[s],l=i(o);a=a||l}var u=i(e,!0);(a||u)&&(r.length>0?e.notify("draw",r):e.notify("draw")),r.unmerge(n),e.emit("step")}var vL={animate:or.animate(),animation:or.animation(),animated:or.animated(),clearQueue:or.clearQueue(),delay:or.delay(),delayAnimation:or.delayAnimation(),stop:or.stop(),addToAnimationPool:function(e){var r=this;r.styleEnabled()&&r._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function r(){e._private.animationsRunning&&Q0(function(a){$N(a,e),r()})}var n=e.renderer();n&&n.beforeRender?n.beforeRender(function(a,s){$N(s,e)},n.beforeRenderPriorities.animations):r()}},yL={qualifierCompare:function(e,r){return e==null||r==null?e==null&&r==null:e.sameText(r)},eventMatches:function(e,r,n){var i=r.qualifier;return i!=null?e!==n.target&&Eg(n.target)&&i.matches(n.target):!0},addEventFields:function(e,r){r.cy=e,r.target=e},callbackContext:function(e,r,n){return r.qualifier!=null?n.target:e}},n0=function(e){return xt(e)?new Vu(e):e},vj={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new px(yL,this)),this},emitter:function(){return this._private.emitter},on:function(e,r,n){return this.emitter().on(e,n0(r),n),this},removeListener:function(e,r,n){return this.emitter().removeListener(e,n0(r),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,r,n){return this.emitter().one(e,n0(r),n),this},once:function(e,r,n){return this.emitter().one(e,n0(r),n),this},emit:function(e,r){return this.emitter().emit(e,r),this},emitAndNotify:function(e,r){return this.emit(e),this.notify(e,r),this}};or.eventAliasesOn(vj);var w2={png:function(e){var r=this._private.renderer;return e=e||{},r.png(e)},jpg:function(e){var r=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",r.jpg(e)}};w2.jpeg=w2.jpg;var D0={layout:function(e){var r=this;if(e==null){Hr("Layout options must be specified to make a layout");return}if(e.name==null){Hr("A `name` must be specified to make a layout");return}var n=e.name,i=r.extension("layout",n);if(i==null){Hr("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var a;xt(e.eles)?a=r.$(e.eles):a=e.eles!=null?e.eles:r.$();var s=new i(Ct({},e,{cy:r,eles:a}));return s}};D0.createLayout=D0.makeLayout=D0.layout;var xL={notify:function(e,r){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var i=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();r!=null&&i.merge(r);return}if(n.notificationsEnabled){var a=this.renderer();this.destroyed()||!a||a.notify(e,r)}},notifications:function(e){var r=this._private;return e===void 0?r.notificationsEnabled:(r.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var r=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var i=e.batchNotifications[n];i.empty()?r.notify(n):r.notify(n,i)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var r=this;return this.batch(function(){for(var n=Object.keys(e),i=0;i<n.length;i++){var a=n[i],s=e[a],o=r.getElementById(a);o.data(s)}})}},bL=Ni({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),S2={renderTo:function(e,r,n,i){var a=this._private.renderer;return a.renderTo(e,r,n,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var r=this,n=r.extension("renderer",e.name);if(n==null){Hr("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&lr("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=bL(e);i.cy=r,r._private.renderer=new n(i),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var r=e.container();if(r)for(r._cyreg=null;r.childNodes.length>0;)r.removeChild(r.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var i=n._private;i.rscratch={},i.rstyle={},i.animation.current=[],i.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};S2.invalidateDimensions=S2.resize;var O0={collection:function(e,r){return xt(e)?this.$(e):Fa(e)?e.collection():Nr(e)?(r||(r={}),new ki(this,e,r.unique,r.removed)):new ki(this)},nodes:function(e){var r=this.$(function(n){return n.isNode()});return e?r.filter(e):r},edges:function(e){var r=this.$(function(n){return n.isEdge()});return e?r.filter(e):r},$:function(e){var r=this._private.elements;return e?r.filter(e):r.spawnSelf()},mutableElements:function(){return this._private.elements}};O0.elements=O0.filter=O0.$;var ai={},Om="t",wL="f";ai.apply=function(t){for(var e=this,r=e._private,n=r.cy,i=n.collection(),a=0;a<t.length;a++){var s=t[a],o=e.getContextMeta(s);if(!o.empty){var l=e.getContextStyle(o),u=e.applyContextStyle(o,l,s);s._private.appliedInitStyle?e.updateTransitions(s,u.diffProps):s._private.appliedInitStyle=!0;var c=e.updateStyleHints(s);c&&i.push(s)}}return i};ai.getPropertiesDiff=function(t,e){var r=this,n=r._private.propDiffs=r._private.propDiffs||{},i=t+"-"+e,a=n[i];if(a)return a;for(var s=[],o={},l=0;l<r.length;l++){var u=r[l],c=t[l]===Om,f=e[l]===Om,m=c!==f,g=u.mappedProperties.length>0;if(m||f&&g){var y=void 0;m&&g||m?y=u.properties:g&&(y=u.mappedProperties);for(var b=0;b<y.length;b++){for(var w=y[b],N=w.name,k=!1,C=l+1;C<r.length;C++){var E=r[C],P=e[C]===Om;if(P&&(k=E.properties[w.name]!=null,k))break}!o[N]&&!k&&(o[N]=!0,s.push(N))}}}return n[i]=s,s};ai.getContextMeta=function(t){for(var e=this,r="",n,i=t._private.styleCxtKey||"",a=0;a<e.length;a++){var s=e[a],o=s.selector&&s.selector.matches(t);o?r+=Om:r+=wL}return n=e.getPropertiesDiff(i,r),t._private.styleCxtKey=r,{key:r,diffPropNames:n,empty:n.length===0}};ai.getContextStyle=function(t){var e=t.key,r=this,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var i={_private:{key:e}},a=0;a<r.length;a++){var s=r[a],o=e[a]===Om;if(o)for(var l=0;l<s.properties.length;l++){var u=s.properties[l];i[u.name]=u}}return n[e]=i,i};ai.applyContextStyle=function(t,e,r){for(var n=this,i=t.diffPropNames,a={},s=n.types,o=0;o<i.length;o++){var l=i[o],u=e[l],c=r.pstyle(l);if(!u)if(c)c.bypass?u={name:l,deleteBypassed:!0}:u={name:l,delete:!0};else continue;if(c!==u){if(u.mapped===s.fn&&c!=null&&c.mapping!=null&&c.mapping.value===u.value){var f=c.mapping,m=f.fnValue=u.value(r);if(m===f.prevFnValue)continue}var g=a[l]={prev:c};n.applyParsedProperty(r,u),g.next=r.pstyle(l),g.next&&g.next.bypass&&(g.next=g.next.bypassed)}}return{diffProps:a}};ai.updateStyleHints=function(t){var e=t._private,r=this,n=r.propertyGroupNames,i=r.propertyGroupKeys,a=function(fe,pe,Te){return r.getPropertiesHash(fe,pe,Te)},s=e.styleKey;if(t.removed())return!1;var o=e.group==="nodes",l=t._private.style;n=Object.keys(l);for(var u=0;u<i.length;u++){var c=i[u];e.styleKeys[c]=[Wc,Lf]}for(var f=function(fe,pe){return e.styleKeys[pe][0]=Zm(fe,e.styleKeys[pe][0])},m=function(fe,pe){return e.styleKeys[pe][1]=eg(fe,e.styleKeys[pe][1])},g=function(fe,pe){f(fe,pe),m(fe,pe)},y=function(fe,pe){for(var Te=0;Te<fe.length;Te++){var Oe=fe.charCodeAt(Te);f(Oe,pe),m(Oe,pe)}},b=2e9,w=function(fe){return-128<fe&&fe<128&&Math.floor(fe)!==fe?b-(fe*1024|0):fe},N=0;N<n.length;N++){var k=n[N],C=l[k];if(C!=null){var E=this.properties[k],P=E.type,_=E.groupKey,A=void 0;E.hashOverride!=null?A=E.hashOverride(t,C):C.pfValue!=null&&(A=C.pfValue);var I=E.enums==null?C.value:null,D=A!=null,L=I!=null,U=D||L,H=C.units;if(P.number&&U&&!P.multiple){var M=D?A:I;g(w(M),_),!D&&H!=null&&y(H,_)}else y(C.strValue,_)}}for(var z=[Wc,Lf],O=0;O<i.length;O++){var G=i[O],W=e.styleKeys[G];z[0]=Zm(W[0],z[0]),z[1]=eg(W[1],z[1])}e.styleKey=LD(z[0],z[1]);var $=e.styleKeys;e.labelDimsKey=fu($.labelDimensions);var X=a(t,["label"],$.labelDimensions);if(e.labelKey=fu(X),e.labelStyleKey=fu(Yv($.commonLabel,X)),!o){var Q=a(t,["source-label"],$.labelDimensions);e.sourceLabelKey=fu(Q),e.sourceLabelStyleKey=fu(Yv($.commonLabel,Q));var V=a(t,["target-label"],$.labelDimensions);e.targetLabelKey=fu(V),e.targetLabelStyleKey=fu(Yv($.commonLabel,V))}if(o){var Y=e.styleKeys,Z=Y.nodeBody,ie=Y.nodeBorder,ce=Y.nodeOutline,he=Y.backgroundImage,ee=Y.compound,le=Y.pie,te=Y.stripe,ae=[Z,ie,ce,he,ee,le,te].filter(function(oe){return oe!=null}).reduce(Yv,[Wc,Lf]);e.nodeKey=fu(ae),e.hasPie=le!=null&&le[0]!==Wc&&le[1]!==Lf,e.hasStripe=te!=null&&te[0]!==Wc&&te[1]!==Lf}return s!==e.styleKey};ai.clearStyleHints=function(t){var e=t._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null,e.hasStripe=null};ai.applyParsedProperty=function(t,e){var r=this,n=e,i=t._private.style,a,s=r.types,o=r.properties[n.name].type,l=n.bypass,u=i[n.name],c=u&&u.bypass,f=t._private,m="mapping",g=function(Z){return Z==null?null:Z.pfValue!=null?Z.pfValue:Z.value},y=function(){var Z=g(u),ie=g(n);r.checkTriggers(t,n.name,Z,ie)};if(e.name==="curve-style"&&t.isEdge()&&(e.value!=="bezier"&&t.isLoop()||e.value==="haystack"&&(t.source().isParent()||t.target().isParent()))&&(n=e=this.parse(e.name,"bezier",l)),n.delete)return i[n.name]=void 0,y(),!0;if(n.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,y(),!0):!1:(y(),!0);if(n.deleteBypass)return u?u.bypass?(i[n.name]=u.bypassed,y(),!0):!1:(y(),!0);var b=function(){lr("Do not assign mappings to elements without corresponding data (i.e. ele `"+t.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case s.mapData:{for(var w=n.field.split("."),N=f.data,k=0;k<w.length&&N;k++){var C=w[k];N=N[C]}if(N==null)return b(),!1;var E;if(Qe(N)){var P=n.fieldMax-n.fieldMin;P===0?E=0:E=(N-n.fieldMin)/P}else return lr("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+N+"` for `"+t.id()+"` is non-numeric)"),!1;if(E<0?E=0:E>1&&(E=1),o.color){var _=n.valueMin[0],A=n.valueMax[0],I=n.valueMin[1],D=n.valueMax[1],L=n.valueMin[2],U=n.valueMax[2],H=n.valueMin[3]==null?1:n.valueMin[3],M=n.valueMax[3]==null?1:n.valueMax[3],z=[Math.round(_+(A-_)*E),Math.round(I+(D-I)*E),Math.round(L+(U-L)*E),Math.round(H+(M-H)*E)];a={bypass:n.bypass,name:n.name,value:z,strValue:"rgb("+z[0]+", "+z[1]+", "+z[2]+")"}}else if(o.number){var O=n.valueMin+(n.valueMax-n.valueMin)*E;a=this.parse(n.name,O,n.bypass,m)}else return!1;if(!a)return b(),!1;a.mapping=n,n=a;break}case s.data:{for(var G=n.field.split("."),W=f.data,$=0;$<G.length&&W;$++){var X=G[$];W=W[X]}if(W!=null&&(a=this.parse(n.name,W,n.bypass,m)),!a)return b(),!1;a.mapping=n,n=a;break}case s.fn:{var Q=n.value,V=n.fnValue!=null?n.fnValue:Q(t);if(n.prevFnValue=V,V==null)return lr("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+t.id()+"` is null)"),!1;if(a=this.parse(n.name,V,n.bypass,m),!a)return lr("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+t.id()+"` is invalid)"),!1;a.mapping=xo(n),n=a;break}case void 0:break;default:return!1}return l?(c?n.bypassed=u.bypassed:n.bypassed=u,i[n.name]=n):c?u.bypassed=n:i[n.name]=n,y(),!0};ai.cleanElements=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),!e)n._private.style={};else for(var i=n._private.style,a=Object.keys(i),s=0;s<a.length;s++){var o=a[s],l=i[o];l!=null&&(l.bypass?l.bypassed=null:i[o]=null)}}};ai.update=function(){var t=this._private.cy,e=t.mutableElements();e.updateStyle()};ai.updateTransitions=function(t,e){var r=this,n=t._private,i=t.pstyle("transition-property").value,a=t.pstyle("transition-duration").pfValue,s=t.pstyle("transition-delay").pfValue;if(i.length>0&&a>0){for(var o={},l=!1,u=0;u<i.length;u++){var c=i[u],f=t.pstyle(c),m=e[c];if(m){var g=m.prev,y=g,b=m.next!=null?m.next:f,w=!1,N=void 0,k=1e-6;y&&(Qe(y.pfValue)&&Qe(b.pfValue)?(w=b.pfValue-y.pfValue,N=y.pfValue+k*w):Qe(y.value)&&Qe(b.value)?(w=b.value-y.value,N=y.value+k*w):Nr(y.value)&&Nr(b.value)&&(w=y.value[0]!==b.value[0]||y.value[1]!==b.value[1]||y.value[2]!==b.value[2],N=y.strValue),w&&(o[c]=b.strValue,this.applyBypass(t,c,N),l=!0))}}if(!l)return;n.transitioning=!0,new wh(function(C){s>0?t.delayAnimation(s).play().promise().then(C):C()}).then(function(){return t.animation({style:o,duration:a,easing:t.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){r.removeBypasses(t,i),t.emitAndNotify("style"),n.transitioning=!1})}else n.transitioning&&(this.removeBypasses(t,i),t.emitAndNotify("style"),n.transitioning=!1)};ai.checkTrigger=function(t,e,r,n,i,a){var s=this.properties[e],o=i(s);t.removed()||o!=null&&o(r,n,t)&&a(s)};ai.checkZOrderTrigger=function(t,e,r,n){var i=this;this.checkTrigger(t,e,r,n,function(a){return a.triggersZOrder},function(){i._private.cy.notify("zorder",t)})};ai.checkBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBounds},function(i){t.dirtyCompoundBoundsCache(),t.dirtyBoundingBoxCache()})};ai.checkConnectedEdgesBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBoundsOfConnectedEdges},function(i){t.connectedEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};ai.checkParallelEdgesBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBoundsOfParallelEdges},function(i){t.parallelEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};ai.checkTriggers=function(t,e,r,n){t.dirtyStyleCache(),this.checkZOrderTrigger(t,e,r,n),this.checkBoundsTrigger(t,e,r,n),this.checkConnectedEdgesBoundsTrigger(t,e,r,n),this.checkParallelEdgesBoundsTrigger(t,e,r,n)};var Rg={};Rg.applyBypass=function(t,e,r,n){var i=this,a=[],s=!0;if(e==="*"||e==="**"){if(r!==void 0)for(var o=0;o<i.properties.length;o++){var l=i.properties[o],u=l.name,c=this.parse(u,r,!0);c&&a.push(c)}}else if(xt(e)){var f=this.parse(e,r,!0);f&&a.push(f)}else if(Zt(e)){var m=e;n=r;for(var g=Object.keys(m),y=0;y<g.length;y++){var b=g[y],w=m[b];if(w===void 0&&(w=m[ix(b)]),w!==void 0){var N=this.parse(b,w,!0);N&&a.push(N)}}}else return!1;if(a.length===0)return!1;for(var k=!1,C=0;C<t.length;C++){for(var E=t[C],P={},_=void 0,A=0;A<a.length;A++){var I=a[A];if(n){var D=E.pstyle(I.name);_=P[I.name]={prev:D}}k=this.applyParsedProperty(E,xo(I))||k,n&&(_.next=E.pstyle(I.name))}k&&this.updateStyleHints(E),n&&this.updateTransitions(E,P,s)}return k};Rg.overrideBypass=function(t,e,r){e=CS(e);for(var n=0;n<t.length;n++){var i=t[n],a=i._private.style[e],s=this.properties[e].type,o=s.color,l=s.mutiple,u=a?a.pfValue!=null?a.pfValue:a.value:null;!a||!a.bypass?this.applyBypass(i,e,r):(a.value=r,a.pfValue!=null&&(a.pfValue=r),o?a.strValue="rgb("+r.join(",")+")":l?a.strValue=r.join(" "):a.strValue=""+r,this.updateStyleHints(i)),this.checkTriggers(i,e,u,r)}};Rg.removeAllBypasses=function(t,e){return this.removeBypasses(t,this.propertyNames,e)};Rg.removeBypasses=function(t,e,r){for(var n=!0,i=0;i<t.length;i++){for(var a=t[i],s={},o=0;o<e.length;o++){var l=e[o],u=this.properties[l],c=a.pstyle(u.name);if(!(!c||!c.bypass)){var f="",m=this.parse(l,f,!0),g=s[u.name]={prev:c};this.applyParsedProperty(a,m),g.next=a.pstyle(u.name)}}this.updateStyleHints(a),r&&this.updateTransitions(a,s,n)}};var FS={};FS.getEmSizeInPixels=function(){var t=this.containerCss("font-size");return t!=null?parseFloat(t):1};FS.containerCss=function(t){var e=this._private.cy,r=e.container(),n=e.window();if(n&&r&&n.getComputedStyle)return n.getComputedStyle(r).getPropertyValue(t)};var wo={};wo.getRenderedStyle=function(t,e){return e?this.getStylePropertyValue(t,e,!0):this.getRawStyle(t,!0)};wo.getRawStyle=function(t,e){var r=this;if(t=t[0],t){for(var n={},i=0;i<r.properties.length;i++){var a=r.properties[i],s=r.getStylePropertyValue(t,a.name,e);s!=null&&(n[a.name]=s,n[ix(a.name)]=s)}return n}};wo.getIndexedStyle=function(t,e,r,n){var i=t.pstyle(e)[r][n];return i??t.cy().style().getDefaultProperty(e)[r][0]};wo.getStylePropertyValue=function(t,e,r){var n=this;if(t=t[0],t){var i=n.properties[e];i.alias&&(i=i.pointsTo);var a=i.type,s=t.pstyle(i.name);if(s){var o=s.value,l=s.units,u=s.strValue;if(r&&a.number&&o!=null&&Qe(o)){var c=t.cy().zoom(),f=function(w){return w*c},m=function(w,N){return f(w)+N},g=Nr(o),y=g?l.every(function(b){return b!=null}):l!=null;return y?g?o.map(function(b,w){return m(b,l[w])}).join(" "):m(o,l):g?o.map(function(b){return xt(b)?b:""+f(b)}).join(" "):""+f(o)}else if(u!=null)return u}return null}};wo.getAnimationStartStyle=function(t,e){for(var r={},n=0;n<e.length;n++){var i=e[n],a=i.name,s=t.pstyle(a);s!==void 0&&(Zt(s)?s=this.parse(a,s.strValue):s=this.parse(a,s)),s&&(r[a]=s)}return r};wo.getPropsList=function(t){var e=this,r=[],n=t,i=e.properties;if(n)for(var a=Object.keys(n),s=0;s<a.length;s++){var o=a[s],l=n[o],u=i[o]||i[CS(o)],c=this.parse(u.name,l);c&&r.push(c)}return r};wo.getNonDefaultPropertiesHash=function(t,e,r){var n=r.slice(),i,a,s,o,l,u;for(l=0;l<e.length;l++)if(i=e[l],a=t.pstyle(i,!1),a!=null)if(a.pfValue!=null)n[0]=Zm(o,n[0]),n[1]=eg(o,n[1]);else for(s=a.strValue,u=0;u<s.length;u++)o=s.charCodeAt(u),n[0]=Zm(o,n[0]),n[1]=eg(o,n[1]);return n};wo.getPropertiesHash=wo.getNonDefaultPropertiesHash;var vx={};vx.appendFromJson=function(t){for(var e=this,r=0;r<t.length;r++){var n=t[r],i=n.selector,a=n.style||n.css,s=Object.keys(a);e.selector(i);for(var o=0;o<s.length;o++){var l=s[o],u=a[l];e.css(l,u)}}return e};vx.fromJson=function(t){var e=this;return e.resetToDefault(),e.appendFromJson(t),e};vx.json=function(){for(var t=[],e=this.defaultLength;e<this.length;e++){for(var r=this[e],n=r.selector,i=r.properties,a={},s=0;s<i.length;s++){var o=i[s];a[o.name]=o.strValue}t.push({selector:n?n.toString():"core",style:a})}return t};var zS={};zS.appendFromString=function(t){var e=this,r=this,n=""+t,i,a,s;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function o(){n.length>i.length?n=n.substr(i.length):n=""}function l(){a.length>s.length?a=a.substr(s.length):a=""}for(;;){var u=n.match(/^\s*$/);if(u)break;var c=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!c){lr("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}i=c[0];var f=c[1];if(f!=="core"){var m=new Vu(f);if(m.invalid){lr("Skipping parsing of block: Invalid selector found in string stylesheet: "+f),o();continue}}var g=c[2],y=!1;a=g;for(var b=[];;){var w=a.match(/^\s*$/);if(w)break;var N=a.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!N){lr("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+g),y=!0;break}s=N[0];var k=N[1],C=N[2],E=e.properties[k];if(!E){lr("Skipping property: Invalid property name in: "+s),l();continue}var P=r.parse(k,C);if(!P){lr("Skipping property: Invalid property definition in: "+s),l();continue}b.push({name:k,val:C}),l()}if(y){o();break}r.selector(f);for(var _=0;_<b.length;_++){var A=b[_];r.css(A.name,A.val)}o()}return r};zS.fromString=function(t){var e=this;return e.resetToDefault(),e.appendFromString(t),e};var jn={};(function(){var t=zn,e=mD,r=vD,n=yD,i=xD,a=function(oe){return"^"+oe+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},s=function(oe){var fe=t+"|\\w+|"+e+"|"+r+"|"+n+"|"+i;return"^"+oe+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+t+")\\s*\\,\\s*("+t+")\\s*,\\s*("+fe+")\\s*\\,\\s*("+fe+")\\)$"},o=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];jn.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},scratch:{mapping:!0,regex:a("scratch")},mapData:{mapping:!0,regex:s("mapData")},mapLayoutData:{mapping:!0,regex:s("mapLayoutData")},mapScratch:{mapping:!0,regex:s("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:o,singleRegexMatchValue:!0},urls:{regexes:o,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(oe,fe){switch(oe.length){case 2:return fe[0]!=="deg"&&fe[0]!=="rad"&&fe[1]!=="deg"&&fe[1]!=="rad";case 1:return xt(oe[0])||fe[0]==="deg"||fe[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(oe){var fe=oe.length;return fe===1||fe===2||fe===4}}};var l={zeroNonZero:function(oe,fe){return(oe==null||fe==null)&&oe!==fe||oe==0&&fe!=0?!0:oe!=0&&fe==0},any:function(oe,fe){return oe!=fe},emptyNonEmpty:function(oe,fe){var pe=Bu(oe),Te=Bu(fe);return pe&&!Te||!pe&&Te}},u=jn.types,c=[{name:"label",type:u.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any}],f=[{name:"source-label",type:u.text,triggersBounds:l.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:u.size,triggersBounds:l.any}],m=[{name:"target-label",type:u.text,triggersBounds:l.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:u.size,triggersBounds:l.any}],g=[{name:"font-family",type:u.fontFamily,triggersBounds:l.any},{name:"font-style",type:u.fontStyle,triggersBounds:l.any},{name:"font-weight",type:u.fontWeight,triggersBounds:l.any},{name:"font-size",type:u.size,triggersBounds:l.any},{name:"text-transform",type:u.textTransform,triggersBounds:l.any},{name:"text-wrap",type:u.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:u.size,triggersBounds:l.any},{name:"text-outline-width",type:u.size,triggersBounds:l.any},{name:"line-height",type:u.positiveNumber,triggersBounds:l.any}],y=[{name:"text-valign",type:u.valign,triggersBounds:l.any},{name:"text-halign",type:u.halign,triggersBounds:l.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:l.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:l.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:u.justification},{name:"box-select-labels",type:u.bool,triggersBounds:l.any}],b=[{name:"events",type:u.bool,triggersZOrder:l.any},{name:"text-events",type:u.bool,triggersZOrder:l.any},{name:"box-selection",type:u.boxSelection,triggersZOrder:l.any}],w=[{name:"display",type:u.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfConnectedEdges:l.any,triggersBoundsOfParallelEdges:function(oe,fe,pe){return oe===fe?!1:pe.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:u.visibility,triggersZOrder:l.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:u.number,triggersZOrder:l.any}],N=[{name:"overlay-padding",type:u.size,triggersBounds:l.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"overlay-corner-radius",type:u.cornerRadius}],k=[{name:"underlay-padding",type:u.size,triggersBounds:l.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"underlay-corner-radius",type:u.cornerRadius}],C=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],E=function(oe,fe){return fe.value==="label"?-oe.poolIndex():fe.pfValue},P=[{name:"height",type:u.nodeSize,triggersBounds:l.any,hashOverride:E},{name:"width",type:u.nodeSize,triggersBounds:l.any,hashOverride:E},{name:"shape",type:u.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:l.any},{name:"corner-radius",type:u.cornerRadius},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:l.any}],_=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:l.any},{name:"border-style",type:u.borderStyle},{name:"border-cap",type:u.lineCap},{name:"border-join",type:u.lineJoin},{name:"border-dash-pattern",type:u.numbers},{name:"border-dash-offset",type:u.number},{name:"border-position",type:u.linePosition}],A=[{name:"outline-color",type:u.color},{name:"outline-opacity",type:u.zeroOneNumber},{name:"outline-width",type:u.size,triggersBounds:l.any},{name:"outline-style",type:u.borderStyle},{name:"outline-offset",type:u.size,triggersBounds:l.any}],I=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],D=[{name:"position",type:u.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:u.size,triggersBounds:l.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:u.size,triggersBounds:l.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:l.any}],L=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-outline-width",type:u.size},{name:"line-outline-color",type:u.color},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelEdges:function(oe,fe){return oe===fe?!1:oe==="bezier"||fe==="bezier"}},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:u.size,triggersBounds:l.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-radii",type:u.numbers,triggersBounds:l.any},{name:"radius-type",type:u.radiusType,triggersBounds:l.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:l.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:l.any},{name:"taxi-radius",type:u.number,triggersBounds:l.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:u.angle,triggersBounds:l.any},{name:"loop-sweep",type:u.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:u.size,triggersBounds:l.any},{name:"target-distance-from-node",type:u.size,triggersBounds:l.any}],U=[{name:"ghost",type:u.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:u.zeroOneNumber}],H=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],M=[];jn.pieBackgroundN=16,M.push({name:"pie-size",type:u.sizeMaybePercent}),M.push({name:"pie-hole",type:u.sizeMaybePercent}),M.push({name:"pie-start-angle",type:u.angle});for(var z=1;z<=jn.pieBackgroundN;z++)M.push({name:"pie-"+z+"-background-color",type:u.color}),M.push({name:"pie-"+z+"-background-size",type:u.percent}),M.push({name:"pie-"+z+"-background-opacity",type:u.zeroOneNumber});var O=[];jn.stripeBackgroundN=16,O.push({name:"stripe-size",type:u.sizeMaybePercent}),O.push({name:"stripe-direction",type:u.axisDirectionPrimary});for(var G=1;G<=jn.stripeBackgroundN;G++)O.push({name:"stripe-"+G+"-background-color",type:u.color}),O.push({name:"stripe-"+G+"-background-size",type:u.percent}),O.push({name:"stripe-"+G+"-background-opacity",type:u.zeroOneNumber});var W=[],$=jn.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill},{name:"arrow-width",type:u.arrowWidth}].forEach(function(ae){$.forEach(function(oe){var fe=oe+"-"+ae.name,pe=ae.type,Te=ae.triggersBounds;W.push({name:fe,type:pe,triggersBounds:Te})})},{});var X=jn.properties=[].concat(b,C,w,N,k,U,y,g,c,f,m,P,_,A,I,M,O,D,L,W,H),Q=jn.propertyGroups={behavior:b,transition:C,visibility:w,overlay:N,underlay:k,ghost:U,commonLabel:y,labelDimensions:g,mainLabel:c,sourceLabel:f,targetLabel:m,nodeBody:P,nodeBorder:_,nodeOutline:A,backgroundImage:I,pie:M,stripe:O,compound:D,edgeLine:L,edgeArrow:W,core:H},V=jn.propertyGroupNames={},Y=jn.propertyGroupKeys=Object.keys(Q);Y.forEach(function(ae){V[ae]=Q[ae].map(function(oe){return oe.name}),Q[ae].forEach(function(oe){return oe.groupKey=ae})});var Z=jn.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];jn.propertyNames=X.map(function(ae){return ae.name});for(var ie=0;ie<X.length;ie++){var ce=X[ie];X[ce.name]=ce}for(var he=0;he<Z.length;he++){var ee=Z[he],le=X[ee.pointsTo],te={name:ee.name,alias:!0,pointsTo:le};X.push(te),X[ee.name]=te}})();jn.getDefaultProperty=function(t){return this.getDefaultProperties()[t]};jn.getDefaultProperties=function(){var t=this._private;if(t.defaultProperties!=null)return t.defaultProperties;for(var e=Ct({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=jn.pieBackgroundN;c++){var f=u.name.replace("{{i}}",c),m=u.value;l[f]=m}return l},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=jn.stripeBackgroundN;c++){var f=u.name.replace("{{i}}",c),m=u.value;l[f]=m}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(l,u){return jn.arrowPrefixes.forEach(function(c){var f=c+"-"+u.name,m=u.value;l[f]=m}),l},{})),r={},n=0;n<this.properties.length;n++){var i=this.properties[n];if(!i.pointsTo){var a=i.name,s=e[a],o=this.parse(a,s);r[a]=o}}return t.defaultProperties=r,t.defaultProperties};jn.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var yx={};yx.parse=function(t,e,r,n){var i=this;if(Qr(e))return i.parseImplWarn(t,e,r,n);var a=n==="mapping"||n===!0||n===!1||n==null?"dontcare":n,s=r?"t":"f",o=""+e,l=T6(t,o,s,a),u=i.propCache=i.propCache||[],c;return(c=u[l])||(c=u[l]=i.parseImplWarn(t,e,r,n)),(r||n==="mapping")&&(c=xo(c),c&&(c.value=xo(c.value))),c};yx.parseImplWarn=function(t,e,r,n){var i=this.parseImpl(t,e,r,n);return!i&&e!=null&&lr("The style property `".concat(t,": ").concat(e,"` is invalid")),i&&(i.name==="width"||i.name==="height")&&e==="label"&&lr("The style value of `label` is deprecated for `"+i.name+"`"),i};yx.parseImpl=function(t,e,r,n){var i=this;t=CS(t);var a=i.properties[t],s=e,o=i.types;if(!a||e===void 0)return null;a.alias&&(a=a.pointsTo,t=a.name);var l=xt(e);l&&(e=e.trim());var u=a.type;if(!u)return null;if(r&&(e===""||e===null))return{name:t,value:e,bypass:!0,deleteBypass:!0};if(Qr(e))return{name:t,value:e,strValue:"fn",mapped:o.fn,bypass:r};var c,f;if(!(!l||n||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(c=new RegExp(o.data.regex).exec(e))){if(r)return!1;var m=o.data;return{name:t,value:c,strValue:""+e,mapped:m,field:c[1],bypass:r}}else if(e.length>=10&&e[0]==="m"&&(f=new RegExp(o.mapData.regex).exec(e))){if(r||u.multiple)return!1;var g=o.mapData;if(!(u.color||u.number))return!1;var y=this.parse(t,f[4]);if(!y||y.mapped)return!1;var b=this.parse(t,f[5]);if(!b||b.mapped)return!1;if(y.pfValue===b.pfValue||y.strValue===b.strValue)return lr("`"+t+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+t+": "+y.strValue+"`"),this.parse(t,y.strValue);if(u.color){var w=y.value,N=b.value,k=w[0]===N[0]&&w[1]===N[1]&&w[2]===N[2]&&(w[3]===N[3]||(w[3]==null||w[3]===1)&&(N[3]==null||N[3]===1));if(k)return!1}return{name:t,value:f,strValue:""+e,mapped:g,field:f[1],fieldMin:parseFloat(f[2]),fieldMax:parseFloat(f[3]),valueMin:y.value,valueMax:b.value,bypass:r}}}if(u.multiple&&n!=="multiple"){var C;if(l?C=e.split(/\s+/):Nr(e)?C=e:C=[e],u.evenMultiple&&C.length%2!==0)return null;for(var E=[],P=[],_=[],A="",I=!1,D=0;D<C.length;D++){var L=i.parse(t,C[D],r,"multiple");I=I||xt(L.value),E.push(L.value),_.push(L.pfValue!=null?L.pfValue:L.value),P.push(L.units),A+=(D>0?" ":"")+L.strValue}return u.validate&&!u.validate(E,P)?null:u.singleEnum&&I?E.length===1&&xt(E[0])?{name:t,value:E[0],strValue:E[0],bypass:r}:null:{name:t,value:E,pfValue:_,strValue:A,bypass:r,units:P}}var U=function(){for(var te=0;te<u.enums.length;te++){var ae=u.enums[te];if(ae===e)return{name:t,value:e,strValue:""+e,bypass:r}}return null};if(u.number){var H,M="px";if(u.units&&(H=u.units),u.implicitUnits&&(M=u.implicitUnits),!u.unitless)if(l){var z="px|em"+(u.allowPercent?"|\\%":"");H&&(z=H);var O=e.match("^("+zn+")("+z+")?$");O&&(e=O[1],H=O[2]||M)}else(!H||u.implicitUnits)&&(H=M);if(e=parseFloat(e),isNaN(e)&&u.enums===void 0)return null;if(isNaN(e)&&u.enums!==void 0)return e=s,U();if(u.integer&&!lD(e)||u.min!==void 0&&(e<u.min||u.strictMin&&e===u.min)||u.max!==void 0&&(e>u.max||u.strictMax&&e===u.max))return null;var G={name:t,value:e,strValue:""+e+(H||""),units:H,bypass:r};return u.unitless||H!=="px"&&H!=="em"?G.pfValue=e:G.pfValue=H==="px"||!H?e:this.getEmSizeInPixels()*e,(H==="ms"||H==="s")&&(G.pfValue=H==="ms"?e:1e3*e),(H==="deg"||H==="rad")&&(G.pfValue=H==="rad"?e:yO(e)),H==="%"&&(G.pfValue=e/100),G}else if(u.propList){var W=[],$=""+e;if($!=="none"){for(var X=$.split(/\s*,\s*|\s+/),Q=0;Q<X.length;Q++){var V=X[Q].trim();i.properties[V]?W.push(V):lr("`"+V+"` is not a valid property name")}if(W.length===0)return null}return{name:t,value:W,strValue:W.length===0?"none":W.join(" "),bypass:r}}else if(u.color){var Y=b6(e);return Y?{name:t,value:Y,pfValue:Y,strValue:"rgb("+Y[0]+","+Y[1]+","+Y[2]+")",bypass:r}:null}else if(u.regex||u.regexes){if(u.enums){var Z=U();if(Z)return Z}for(var ie=u.regexes?u.regexes:[u.regex],ce=0;ce<ie.length;ce++){var he=new RegExp(ie[ce]),ee=he.exec(e);if(ee)return{name:t,value:u.singleRegexMatchValue?ee[1]:ee,strValue:""+e,bypass:r}}return null}else return u.string?{name:t,value:""+e,strValue:""+e,bypass:r}:u.enums?U():null};var ri=function(e){if(!(this instanceof ri))return new ri(e);if(!kS(e)){Hr("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},Ii=ri.prototype;Ii.instanceString=function(){return"style"};Ii.clear=function(){for(var t=this._private,e=t.cy,r=e.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,t.contextStyles={},t.propDiffs={},this.cleanElements(r,!0),r.forEach(function(i){var a=i[0]._private;a.styleDirty=!0,a.appliedInitStyle=!1}),this};Ii.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Ii.core=function(t){return this._private.coreStyle[t]||this.getDefaultProperty(t)};Ii.selector=function(t){var e=t==="core"?null:new Vu(t),r=this.length++;return this[r]={selector:e,properties:[],mappedProperties:[],index:r},this};Ii.css=function(){var t=this,e=arguments;if(e.length===1)for(var r=e[0],n=0;n<t.properties.length;n++){var i=t.properties[n],a=r[i.name];a===void 0&&(a=r[ix(i.name)]),a!==void 0&&this.cssRule(i.name,a)}else e.length===2&&this.cssRule(e[0],e[1]);return this};Ii.style=Ii.css;Ii.cssRule=function(t,e){var r=this.parse(t,e);if(r){var n=this.length-1;this[n].properties.push(r),this[n].properties[r.name]=r,r.name.match(/pie-(\d+)-background-size/)&&r.value&&(this._private.hasPie=!0),r.name.match(/stripe-(\d+)-background-size/)&&r.value&&(this._private.hasStripe=!0),r.mapped&&this[n].mappedProperties.push(r);var i=!this[n].selector;i&&(this._private.coreStyle[r.name]=r)}return this};Ii.append=function(t){return v6(t)?t.appendToStyle(this):Nr(t)?this.appendFromJson(t):xt(t)&&this.appendFromString(t),this};ri.fromJson=function(t,e){var r=new ri(t);return r.fromJson(e),r};ri.fromString=function(t,e){return new ri(t).fromString(e)};[ai,Rg,FS,wo,vx,zS,jn,yx].forEach(function(t){Ct(Ii,t)});ri.types=Ii.types;ri.properties=Ii.properties;ri.propertyGroups=Ii.propertyGroups;ri.propertyGroupNames=Ii.propertyGroupNames;ri.propertyGroupKeys=Ii.propertyGroupKeys;var SL={style:function(e){if(e){var r=this.setStyle(e);r.update()}return this._private.style},setStyle:function(e){var r=this._private;return v6(e)?r.style=e.generateStyle(this):Nr(e)?r.style=ri.fromJson(this,e):xt(e)?r.style=ri.fromString(this,e):r.style=ri(this),r.style},updateStyle:function(){this.mutableElements().updateStyle()}},kL="single",fd={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var r=this._private;if(r.selectionType==null&&(r.selectionType=kL),e!==void 0)(e==="additive"||e==="single")&&(r.selectionType=e);else return r.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,r=this._private.pan,n,i,a,s,o;switch(e.length){case 0:return r;case 1:if(xt(e[0]))return n=e[0],r[n];if(Zt(e[0])){if(!this._private.panningEnabled)return this;a=e[0],s=a.x,o=a.y,Qe(s)&&(r.x=s),Qe(o)&&(r.y=o),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;n=e[0],i=e[1],(n==="x"||n==="y")&&Qe(i)&&(r[n]=i),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,r){var n=arguments,i=this._private.pan,a,s,o,l,u;if(!this._private.panningEnabled)return this;switch(n.length){case 1:Zt(e)&&(o=n[0],l=o.x,u=o.y,Qe(l)&&(i.x+=l),Qe(u)&&(i.y+=u),this.emit("pan viewport"));break;case 2:a=e,s=r,(a==="x"||a==="y")&&Qe(s)&&(i[a]+=s),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,r){var n=this.getFitViewport(e,r);if(n){var i=this._private;i.zoom=n.zoom,i.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,r){if(Qe(e)&&r===void 0&&(r=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var n;if(xt(e)){var i=e;e=this.$(i)}else if(dD(e)){var a=e;n={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},n.w=n.x2-n.x1,n.h=n.y2-n.y1}else Fa(e)||(e=this.mutableElements());if(!(Fa(e)&&e.empty())){n=n||e.boundingBox();var s=this.width(),o=this.height(),l;if(r=Qe(r)?r:0,!isNaN(s)&&!isNaN(o)&&s>0&&o>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){l=Math.min((s-2*r)/n.w,(o-2*r)/n.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var u={x:(s-l*(n.x1+n.x2))/2,y:(o-l*(n.y1+n.y2))/2};return{zoom:l,pan:u}}}}},zoomRange:function(e,r){var n=this._private;if(r==null){var i=e;e=i.min,r=i.max}return Qe(e)&&Qe(r)&&e<=r?(n.minZoom=e,n.maxZoom=r):Qe(e)&&r===void 0&&e<=n.maxZoom?n.minZoom=e:Qe(r)&&e===void 0&&r>=n.minZoom&&(n.maxZoom=r),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var r=this._private,n=r.pan,i=r.zoom,a,s,o=!1;if(r.zoomingEnabled||(o=!0),Qe(e)?s=e:Zt(e)&&(s=e.level,e.position!=null?a=ox(e.position,i,n):e.renderedPosition!=null&&(a=e.renderedPosition),a!=null&&!r.panningEnabled&&(o=!0)),s=s>r.maxZoom?r.maxZoom:s,s=s<r.minZoom?r.minZoom:s,o||!Qe(s)||s===i||a!=null&&(!Qe(a.x)||!Qe(a.y)))return null;if(a!=null){var l=n,u=i,c=s,f={x:-c/u*(a.x-l.x)+a.x,y:-c/u*(a.y-l.y)+a.y};return{zoomed:!0,panned:!0,zoom:c,pan:f}}else return{zoomed:!0,panned:!1,zoom:s,pan:n}},zoom:function(e){if(e===void 0)return this._private.zoom;var r=this.getZoomedViewport(e),n=this._private;return r==null||!r.zoomed?this:(n.zoom=r.zoom,r.panned&&(n.pan.x=r.pan.x,n.pan.y=r.pan.y),this.emit("zoom"+(r.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var r=this._private,n=!0,i=!0,a=[],s=!1,o=!1;if(!e)return this;if(Qe(e.zoom)||(n=!1),Zt(e.pan)||(i=!1),!n&&!i)return this;if(n){var l=e.zoom;l<r.minZoom||l>r.maxZoom||!r.zoomingEnabled?s=!0:(r.zoom=l,a.push("zoom"))}if(i&&(!s||!e.cancelOnFailedZoom)&&r.panningEnabled){var u=e.pan;Qe(u.x)&&(r.pan.x=u.x,o=!1),Qe(u.y)&&(r.pan.y=u.y,o=!1),o||a.push("pan")}return a.length>0&&(a.push("viewport"),this.emit(a.join(" ")),this.notify("viewport")),this},center:function(e){var r=this.getCenterPan(e);return r&&(this._private.pan=r,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,r){if(this._private.panningEnabled){if(xt(e)){var n=e;e=this.mutableElements().filter(n)}else Fa(e)||(e=this.mutableElements());if(e.length!==0){var i=e.boundingBox(),a=this.width(),s=this.height();r=r===void 0?this._private.zoom:r;var o={x:(a-r*(i.x1+i.x2))/2,y:(s-r*(i.y1+i.y2))/2};return o}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,r=e.container,n=this;return e.sizeCache=e.sizeCache||(r?(function(){var i=n.window().getComputedStyle(r),a=function(o){return parseFloat(i.getPropertyValue(o))};return{width:r.clientWidth-a("padding-left")-a("padding-right"),height:r.clientHeight-a("padding-top")-a("padding-bottom")}})():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,r=this._private.zoom,n=this.renderedExtent(),i={x1:(n.x1-e.x)/r,x2:(n.x2-e.x)/r,y1:(n.y1-e.y)/r,y2:(n.y2-e.y)/r};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var e=this.width(),r=this.height();return{x1:0,y1:0,x2:e,y2:r,w:e,h:r}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};fd.centre=fd.center;fd.autolockNodes=fd.autolock;fd.autoungrabifyNodes=fd.autoungrabify;var sg={data:or.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:or.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:or.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:or.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};sg.attr=sg.data;sg.removeAttr=sg.removeData;var og=function(e){var r=this;e=Ct({},e);var n=e.container;n&&!X0(n)&&X0(n[0])&&(n=n[0]);var i=n?n._cyreg:null;i=i||{},i&&i.cy&&(i.cy.destroy(),i={});var a=i.readies=i.readies||[];n&&(n._cyreg=i),i.cy=r;var s=Fn!==void 0&&n!==void 0&&!e.headless,o=e;o.layout=Ct({name:s?"grid":"null"},o.layout),o.renderer=Ct({name:s?"canvas":"null"},o.renderer);var l=function(y,b,w){return b!==void 0?b:w!==void 0?w:y},u=this._private={container:n,ready:!1,options:o,elements:new ki(this),listeners:[],aniEles:new ki(this),data:o.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,o.zoomingEnabled),userZoomingEnabled:l(!0,o.userZoomingEnabled),panningEnabled:l(!0,o.panningEnabled),userPanningEnabled:l(!0,o.userPanningEnabled),boxSelectionEnabled:l(!0,o.boxSelectionEnabled),autolock:l(!1,o.autolock,o.autolockNodes),autoungrabify:l(!1,o.autoungrabify,o.autoungrabifyNodes),autounselectify:l(!1,o.autounselectify),styleEnabled:o.styleEnabled===void 0?s:o.styleEnabled,zoom:Qe(o.zoom)?o.zoom:1,pan:{x:Zt(o.pan)&&Qe(o.pan.x)?o.pan.x:0,y:Zt(o.pan)&&Qe(o.pan.y)?o.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,o.multiClickDebounceTime)};this.createEmitter(),this.selectionType(o.selectionType),this.zoomRange({min:o.minZoom,max:o.maxZoom});var c=function(y,b){var w=y.some(fD);if(w)return wh.all(y).then(b);b(y)};u.styleEnabled&&r.setStyle([]);var f=Ct({},o,o.renderer);r.initRenderer(f);var m=function(y,b,w){r.notifications(!1);var N=r.mutableElements();N.length>0&&N.remove(),y!=null&&(Zt(y)||Nr(y))&&r.add(y),r.one("layoutready",function(C){r.notifications(!0),r.emit(C),r.one("load",b),r.emitAndNotify("load")}).one("layoutstop",function(){r.one("done",w),r.emit("done")});var k=Ct({},r._private.options.layout);k.eles=r.elements(),r.layout(k).run()};c([o.style,o.elements],function(g){var y=g[0],b=g[1];u.styleEnabled&&r.style().append(y),m(b,function(){r.startAnimationLoop(),u.ready=!0,Qr(o.ready)&&r.on("ready",o.ready);for(var w=0;w<a.length;w++){var N=a[w];r.on("ready",N)}i&&(i.readies=[]),r.emit("ready")},o.done)})},ny=og.prototype;Ct(ny,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return Fn;var r=this._private.container.ownerDocument;return r===void 0||r==null?Fn:r.defaultView||Fn},mount:function(e){if(e!=null){var r=this,n=r._private,i=n.options;return!X0(e)&&X0(e[0])&&(e=e[0]),r.stopAnimationLoop(),r.destroyRenderer(),n.container=e,n.styleEnabled=!0,r.invalidateSize(),r.initRenderer(Ct({},i,i.renderer,{name:i.renderer.name==="null"?"canvas":i.renderer.name})),r.startAnimationLoop(),r.style(i.style),r.emit("mount"),r}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return xo(this._private.options)},json:function(e){var r=this,n=r._private,i=r.mutableElements(),a=function(E){return r.getElementById(E.id())};if(Zt(e)){if(r.startBatch(),e.elements){var s={},o=function(E,P){for(var _=[],A=[],I=0;I<E.length;I++){var D=E[I];if(!D.data.id){lr("cy.json() cannot handle elements without an ID attribute");continue}var L=""+D.data.id,U=r.getElementById(L);s[L]=!0,U.length!==0?A.push({ele:U,json:D}):(P&&(D.group=P),_.push(D))}r.add(_);for(var H=0;H<A.length;H++){var M=A[H],z=M.ele,O=M.json;z.json(O)}};if(Nr(e.elements))o(e.elements);else for(var l=["nodes","edges"],u=0;u<l.length;u++){var c=l[u],f=e.elements[c];Nr(f)&&o(f,c)}var m=r.collection();i.filter(function(C){return!s[C.id()]}).forEach(function(C){C.isParent()?m.merge(C):C.remove()}),m.forEach(function(C){return C.children().move({parent:null})}),m.forEach(function(C){return a(C).remove()})}e.style&&r.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&r.zoom(e.zoom),e.pan&&(e.pan.x!==n.pan.x||e.pan.y!==n.pan.y)&&r.pan(e.pan),e.data&&r.data(e.data);for(var g=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],y=0;y<g.length;y++){var b=g[y];e[b]!=null&&r[b](e[b])}return r.endBatch(),this}else{var w=!!e,N={};w?N.elements=this.elements().map(function(C){return C.json()}):(N.elements={},i.forEach(function(C){var E=C.group();N.elements[E]||(N.elements[E]=[]),N.elements[E].push(C.json())})),this._private.styleEnabled&&(N.style=r.style().json()),N.data=xo(r.data());var k=n.options;return N.zoomingEnabled=n.zoomingEnabled,N.userZoomingEnabled=n.userZoomingEnabled,N.zoom=n.zoom,N.minZoom=n.minZoom,N.maxZoom=n.maxZoom,N.panningEnabled=n.panningEnabled,N.userPanningEnabled=n.userPanningEnabled,N.pan=xo(n.pan),N.boxSelectionEnabled=n.boxSelectionEnabled,N.renderer=xo(k.renderer),N.hideEdgesOnViewport=k.hideEdgesOnViewport,N.textureOnViewport=k.textureOnViewport,N.wheelSensitivity=k.wheelSensitivity,N.motionBlur=k.motionBlur,N.multiClickDebounceTime=k.multiClickDebounceTime,N}}});ny.$id=ny.getElementById;[fL,vL,vj,w2,D0,xL,S2,O0,SL,fd,sg].forEach(function(t){Ct(ny,t)});var CL={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}},NL={maximal:!1,acyclic:!1},jf=function(e){return e.scratch("breadthfirst")},KN=function(e,r){return e.scratch("breadthfirst",r)};function yj(t){this.options=Ct({},CL,NL,t)}yj.prototype.run=function(){var t=this.options,e=t.cy,r=t.eles,n=r.nodes().filter(function(tt){return tt.isChildless()}),i=r,a=t.directed,s=t.acyclic||t.maximal||t.maximalAdjustments>0,o=!!t.boundingBox,l=ea(o?t.boundingBox:structuredClone(e.extent())),u;if(Fa(t.roots))u=t.roots;else if(Nr(t.roots)){for(var c=[],f=0;f<t.roots.length;f++){var m=t.roots[f],g=e.getElementById(m);c.push(g)}u=e.collection(c)}else if(xt(t.roots))u=e.$(t.roots);else if(a)u=n.roots();else{var y=r.components();u=e.collection();for(var b=function(){var Ie=y[w],ye=Ie.maxDegree(!1),Pe=Ie.filter(function(Be){return Be.degree(!1)===ye});u=u.add(Pe)},w=0;w<y.length;w++)b()}var N=[],k={},C=function(Ie,ye){N[ye]==null&&(N[ye]=[]);var Pe=N[ye].length;N[ye].push(Ie),KN(Ie,{index:Pe,depth:ye})},E=function(Ie,ye){var Pe=jf(Ie),Be=Pe.depth,Ge=Pe.index;N[Be][Ge]=null,Ie.isChildless()&&C(Ie,ye)};i.bfs({roots:u,directed:t.directed,visit:function(Ie,ye,Pe,Be,Ge){var et=Ie[0],mt=et.id();et.isChildless()&&C(et,Ge),k[mt]=!0}});for(var P=[],_=0;_<n.length;_++){var A=n[_];k[A.id()]||P.push(A)}var I=function(Ie){for(var ye=N[Ie],Pe=0;Pe<ye.length;Pe++){var Be=ye[Pe];if(Be==null){ye.splice(Pe,1),Pe--;continue}KN(Be,{depth:Ie,index:Pe})}},D=function(Ie,ye){for(var Pe=jf(Ie),Be=Ie.incomers().filter(function(ot){return ot.isNode()&&r.has(ot)}),Ge=-1,et=Ie.id(),mt=0;mt<Be.length;mt++){var gt=Be[mt],bt=jf(gt);Ge=Math.max(Ge,bt.depth)}if(Pe.depth<=Ge){if(!t.acyclic&&ye[et])return null;var _t=Ge+1;return E(Ie,_t),ye[et]=_t,!0}return!1};if(a&&s){var L=[],U={},H=function(Ie){return L.push(Ie)},M=function(){return L.shift()};for(n.forEach(function(tt){return L.push(tt)});L.length>0;){var z=M(),O=D(z,U);if(O)z.outgoers().filter(function(tt){return tt.isNode()&&r.has(tt)}).forEach(H);else if(O===null){lr("Detected double maximal shift for node `"+z.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var G=0;if(t.avoidOverlap)for(var W=0;W<n.length;W++){var $=n[W],X=$.layoutDimensions(t),Q=X.w,V=X.h;G=Math.max(G,Q,V)}var Y={},Z=function(Ie){if(Y[Ie.id()])return Y[Ie.id()];for(var ye=jf(Ie).depth,Pe=Ie.neighborhood(),Be=0,Ge=0,et=0;et<Pe.length;et++){var mt=Pe[et];if(!(mt.isEdge()||mt.isParent()||!n.has(mt))){var gt=jf(mt);if(gt!=null){var bt=gt.index,_t=gt.depth;if(!(bt==null||_t==null)){var ot=N[_t].length;_t<ye&&(Be+=bt/ot,Ge++)}}}}return Ge=Math.max(1,Ge),Be=Be/Ge,Ge===0&&(Be=0),Y[Ie.id()]=Be,Be},ie=function(Ie,ye){var Pe=Z(Ie),Be=Z(ye),Ge=Pe-Be;return Ge===0?x6(Ie.id(),ye.id()):Ge};t.depthSort!==void 0&&(ie=t.depthSort);for(var ce=N.length,he=0;he<ce;he++)N[he].sort(ie),I(he);for(var ee=[],le=0;le<P.length;le++)ee.push(P[le]);var te=function(){for(var Ie=0;Ie<ce;Ie++)I(Ie)};ee.length&&(N.unshift(ee),ce=N.length,te());for(var ae=0,oe=0;oe<ce;oe++)ae=Math.max(N[oe].length,ae);var fe={x:l.x1+l.w/2,y:l.y1+l.h/2},pe=n.reduce(function(tt,Ie){return(function(ye){return{w:tt.w===-1?ye.w:(tt.w+ye.w)/2,h:tt.h===-1?ye.h:(tt.h+ye.h)/2}})(Ie.boundingBox({includeLabels:t.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),Te=Math.max(ce===1?0:o?(l.h-t.padding*2-pe.h)/(ce-1):(l.h-t.padding*2-pe.h)/(ce+1),G),Oe=N.reduce(function(tt,Ie){return Math.max(tt,Ie.length)},0),_e=function(Ie){var ye=jf(Ie),Pe=ye.depth,Be=ye.index;if(t.circle){var Ge=Math.min(l.w/2/ce,l.h/2/ce);Ge=Math.max(Ge,G);var et=Ge*Pe+Ge-(ce>0&&N[0].length<=3?Ge/2:0),mt=2*Math.PI/N[Pe].length*Be;return Pe===0&&N[0].length===1&&(et=1),{x:fe.x+et*Math.cos(mt),y:fe.y+et*Math.sin(mt)}}else{var gt=N[Pe].length,bt=Math.max(gt===1?0:o?(l.w-t.padding*2-pe.w)/((t.grid?Oe:gt)-1):(l.w-t.padding*2-pe.w)/((t.grid?Oe:gt)+1),G),_t={x:fe.x+(Be+1-(gt+1)/2)*bt,y:fe.y+(Pe+1-(ce+1)/2)*Te};return _t}},Ae={downward:0,leftward:90,upward:180,rightward:-90};Object.keys(Ae).indexOf(t.direction)===-1&&Hr("Invalid direction '".concat(t.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(Ae).join(", ")));var He=function(Ie){return VD(_e(Ie),l,Ae[t.direction])};return r.nodes().layoutPositions(this,t,He),this};var EL={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function xj(t){this.options=Ct({},EL,t)}xj.prototype.run=function(){var t=this.options,e=t,r=t.cy,n=e.eles,i=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,a=n.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));for(var s=ea(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()}),o={x:s.x1+s.w/2,y:s.y1+s.h/2},l=e.sweep===void 0?2*Math.PI-2*Math.PI/a.length:e.sweep,u=l/Math.max(1,a.length-1),c,f=0,m=0;m<a.length;m++){var g=a[m],y=g.layoutDimensions(e),b=y.w,w=y.h;f=Math.max(f,b,w)}if(Qe(e.radius)?c=e.radius:a.length<=1?c=0:c=Math.min(s.h,s.w)/2-f,a.length>1&&e.avoidOverlap){f*=1.75;var N=Math.cos(u)-Math.cos(0),k=Math.sin(u)-Math.sin(0),C=Math.sqrt(f*f/(N*N+k*k));c=Math.max(C,c)}var E=function(_,A){var I=e.startAngle+A*u*(i?1:-1),D=c*Math.cos(I),L=c*Math.sin(I),U={x:o.x+D,y:o.y+L};return U};return n.nodes().layoutPositions(this,e,E),this};var TL={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function bj(t){this.options=Ct({},TL,t)}bj.prototype.run=function(){for(var t=this.options,e=t,r=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,n=t.cy,i=e.eles,a=i.nodes().not(":parent"),s=ea(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),o={x:s.x1+s.w/2,y:s.y1+s.h/2},l=[],u=0,c=0;c<a.length;c++){var f=a[c],m=void 0;m=e.concentric(f),l.push({value:m,node:f}),f._private.scratch.concentric=m}a.updateStyle();for(var g=0;g<a.length;g++){var y=a[g],b=y.layoutDimensions(e);u=Math.max(u,b.w,b.h)}l.sort(function(Te,Oe){return Oe.value-Te.value});for(var w=e.levelWidth(a),N=[[]],k=N[0],C=0;C<l.length;C++){var E=l[C];if(k.length>0){var P=Math.abs(k[0].value-E.value);P>=w&&(k=[],N.push(k))}k.push(E)}var _=u+e.minNodeSpacing;if(!e.avoidOverlap){var A=N.length>0&&N[0].length>1,I=Math.min(s.w,s.h)/2-_,D=I/(N.length+A?1:0);_=Math.min(_,D)}for(var L=0,U=0;U<N.length;U++){var H=N[U],M=e.sweep===void 0?2*Math.PI-2*Math.PI/H.length:e.sweep,z=H.dTheta=M/Math.max(1,H.length-1);if(H.length>1&&e.avoidOverlap){var O=Math.cos(z)-Math.cos(0),G=Math.sin(z)-Math.sin(0),W=Math.sqrt(_*_/(O*O+G*G));L=Math.max(W,L)}H.r=L,L+=_}if(e.equidistant){for(var $=0,X=0,Q=0;Q<N.length;Q++){var V=N[Q],Y=V.r-X;$=Math.max($,Y)}X=0;for(var Z=0;Z<N.length;Z++){var ie=N[Z];Z===0&&(X=ie.r),ie.r=X,X+=$}}for(var ce={},he=0;he<N.length;he++)for(var ee=N[he],le=ee.dTheta,te=ee.r,ae=0;ae<ee.length;ae++){var oe=ee[ae],fe=e.startAngle+(r?1:-1)*le*ae,pe={x:o.x+te*Math.cos(fe),y:o.y+te*Math.sin(fe)};ce[oe.node.id()]=pe}return i.nodes().layoutPositions(this,e,function(Te){var Oe=Te.id();return ce[Oe]}),this};var Xb,jL={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,r){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function xx(t){this.options=Ct({},jL,t),this.options.layout=this;var e=this.options.eles.nodes(),r=this.options.eles.edges(),n=r.filter(function(i){var a=i.source().data("id"),s=i.target().data("id"),o=e.some(function(u){return u.data("id")===a}),l=e.some(function(u){return u.data("id")===s});return!o||!l});this.options.eles=this.options.eles.not(n)}xx.prototype.run=function(){var t=this.options,e=t.cy,r=this;r.stopped=!1,(t.animate===!0||t.animate===!1)&&r.emit({type:"layoutstart",layout:r}),t.debug===!0?Xb=!0:Xb=!1;var n=PL(e,r,t);Xb&&_L(n),t.randomize&&AL(n);var i=pl(),a=function(){RL(n,e,t),t.fit===!0&&e.fit(t.padding)},s=function(m){return!(r.stopped||m>=t.numIter||(DL(n,t),n.temperature=n.temperature*t.coolingFactor,n.temperature<t.minTemp))},o=function(){if(t.animate===!0||t.animate===!1)a(),r.one("layoutstop",t.stop),r.emit({type:"layoutstop",layout:r});else{var m=t.eles.nodes(),g=Sj(n,t,m);m.layoutPositions(r,t,g)}},l=0,u=!0;if(t.animate===!0){var c=function(){for(var m=0;u&&m<t.refresh;)u=s(l),l++,m++;if(!u)XN(n,t),o();else{var g=pl();g-i>=t.animationThreshold&&a(),Q0(c)}};c()}else{for(;u;)u=s(l),l++;XN(n,t),o()}return this};xx.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};xx.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var PL=function(e,r,n){for(var i=n.eles.edges(),a=n.eles.nodes(),s=ea(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),o={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:n.initialTemp,clientWidth:s.w,clientHeight:s.h,boundingBox:s},l=n.eles.components(),u={},c=0;c<l.length;c++)for(var f=l[c],m=0;m<f.length;m++){var g=f[m];u[g.id()]=c}for(var c=0;c<o.nodeSize;c++){var y=a[c],b=y.layoutDimensions(n),w={};w.isLocked=y.locked(),w.id=y.data("id"),w.parentId=y.data("parent"),w.cmptId=u[y.id()],w.children=[],w.positionX=y.position("x"),w.positionY=y.position("y"),w.offsetX=0,w.offsetY=0,w.height=b.w,w.width=b.h,w.maxX=w.positionX+w.width/2,w.minX=w.positionX-w.width/2,w.maxY=w.positionY+w.height/2,w.minY=w.positionY-w.height/2,w.padLeft=parseFloat(y.style("padding")),w.padRight=parseFloat(y.style("padding")),w.padTop=parseFloat(y.style("padding")),w.padBottom=parseFloat(y.style("padding")),w.nodeRepulsion=Qr(n.nodeRepulsion)?n.nodeRepulsion(y):n.nodeRepulsion,o.layoutNodes.push(w),o.idToIndex[w.id]=c}for(var N=[],k=0,C=-1,E=[],c=0;c<o.nodeSize;c++){var y=o.layoutNodes[c],P=y.parentId;P!=null?o.layoutNodes[o.idToIndex[P]].children.push(y.id):(N[++C]=y.id,E.push(y.id))}for(o.graphSet.push(E);k<=C;){var _=N[k++],A=o.idToIndex[_],g=o.layoutNodes[A],I=g.children;if(I.length>0){o.graphSet.push(I);for(var c=0;c<I.length;c++)N[++C]=I[c]}}for(var c=0;c<o.graphSet.length;c++)for(var D=o.graphSet[c],m=0;m<D.length;m++){var L=o.idToIndex[D[m]];o.indexToGraph[L]=c}for(var c=0;c<o.edgeSize;c++){var U=i[c],H={};H.id=U.data("id"),H.sourceId=U.data("source"),H.targetId=U.data("target");var M=Qr(n.idealEdgeLength)?n.idealEdgeLength(U):n.idealEdgeLength,z=Qr(n.edgeElasticity)?n.edgeElasticity(U):n.edgeElasticity,O=o.idToIndex[H.sourceId],G=o.idToIndex[H.targetId],W=o.indexToGraph[O],$=o.indexToGraph[G];if(W!=$){for(var X=ML(H.sourceId,H.targetId,o),Q=o.graphSet[X],V=0,w=o.layoutNodes[O];Q.indexOf(w.id)===-1;)w=o.layoutNodes[o.idToIndex[w.parentId]],V++;for(w=o.layoutNodes[G];Q.indexOf(w.id)===-1;)w=o.layoutNodes[o.idToIndex[w.parentId]],V++;M*=V*n.nestingFactor}H.idealLength=M,H.elasticity=z,o.layoutEdges.push(H)}return o},ML=function(e,r,n){var i=wj(e,r,0,n);return 2>i.count?0:i.graph},wj=function(e,r,n,i){var a=i.graphSet[n];if(-1<a.indexOf(e)&&-1<a.indexOf(r))return{count:2,graph:n};for(var s=0,o=0;o<a.length;o++){var l=a[o],u=i.idToIndex[l],c=i.layoutNodes[u].children;if(c.length!==0){var f=i.indexToGraph[i.idToIndex[c[0]]],m=wj(e,r,f,i);if(m.count!==0)if(m.count===1){if(s++,s===2)break}else return m}}return{count:s,graph:n}},_L,AL=function(e,r){for(var n=e.clientWidth,i=e.clientHeight,a=0;a<e.nodeSize;a++){var s=e.layoutNodes[a];s.children.length===0&&!s.isLocked&&(s.positionX=Math.random()*n,s.positionY=Math.random()*i)}},Sj=function(e,r,n){var i=e.boundingBox,a={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return r.boundingBox&&(n.forEach(function(s){var o=e.layoutNodes[e.idToIndex[s.data("id")]];a.x1=Math.min(a.x1,o.positionX),a.x2=Math.max(a.x2,o.positionX),a.y1=Math.min(a.y1,o.positionY),a.y2=Math.max(a.y2,o.positionY)}),a.w=a.x2-a.x1,a.h=a.y2-a.y1),function(s,o){var l=e.layoutNodes[e.idToIndex[s.data("id")]];if(r.boundingBox){var u=a.w===0?.5:(l.positionX-a.x1)/a.w,c=a.h===0?.5:(l.positionY-a.y1)/a.h;return{x:i.x1+u*i.w,y:i.y1+c*i.h}}else return{x:l.positionX,y:l.positionY}}},RL=function(e,r,n){var i=n.layout,a=n.eles.nodes(),s=Sj(e,n,a);a.positions(s),e.ready!==!0&&(e.ready=!0,i.one("layoutready",n.ready),i.emit({type:"layoutready",layout:this}))},DL=function(e,r,n){OL(e,r),BL(e),FL(e,r),zL(e),VL(e)},OL=function(e,r){for(var n=0;n<e.graphSet.length;n++)for(var i=e.graphSet[n],a=i.length,s=0;s<a;s++)for(var o=e.layoutNodes[e.idToIndex[i[s]]],l=s+1;l<a;l++){var u=e.layoutNodes[e.idToIndex[i[l]]];IL(o,u,e,r)}},YN=function(e){return-1+2*e*Math.random()},IL=function(e,r,n,i){var a=e.cmptId,s=r.cmptId;if(!(a!==s&&!n.isCompound)){var o=r.positionX-e.positionX,l=r.positionY-e.positionY,u=1;o===0&&l===0&&(o=YN(u),l=YN(u));var c=LL(e,r,o,l);if(c>0)var f=i.nodeOverlap*c,m=Math.sqrt(o*o+l*l),g=f*o/m,y=f*l/m;else var b=iy(e,o,l),w=iy(r,-1*o,-1*l),N=w.x-b.x,k=w.y-b.y,C=N*N+k*k,m=Math.sqrt(C),f=(e.nodeRepulsion+r.nodeRepulsion)/C,g=f*N/m,y=f*k/m;e.isLocked||(e.offsetX-=g,e.offsetY-=y),r.isLocked||(r.offsetX+=g,r.offsetY+=y)}},LL=function(e,r,n,i){if(n>0)var a=e.maxX-r.minX;else var a=r.maxX-e.minX;if(i>0)var s=e.maxY-r.minY;else var s=r.maxY-e.minY;return a>=0&&s>=0?Math.sqrt(a*a+s*s):0},iy=function(e,r,n){var i=e.positionX,a=e.positionY,s=e.height||1,o=e.width||1,l=n/r,u=s/o,c={};return r===0&&0<n||r===0&&0>n?(c.x=i,c.y=a+s/2,c):0<r&&-1*u<=l&&l<=u?(c.x=i+o/2,c.y=a+o*n/2/r,c):0>r&&-1*u<=l&&l<=u?(c.x=i-o/2,c.y=a-o*n/2/r,c):0<n&&(l<=-1*u||l>=u)?(c.x=i+s*r/2/n,c.y=a+s/2,c):(0>n&&(l<=-1*u||l>=u)&&(c.x=i-s*r/2/n,c.y=a-s/2),c)},BL=function(e,r){for(var n=0;n<e.edgeSize;n++){var i=e.layoutEdges[n],a=e.idToIndex[i.sourceId],s=e.layoutNodes[a],o=e.idToIndex[i.targetId],l=e.layoutNodes[o],u=l.positionX-s.positionX,c=l.positionY-s.positionY;if(!(u===0&&c===0)){var f=iy(s,u,c),m=iy(l,-1*u,-1*c),g=m.x-f.x,y=m.y-f.y,b=Math.sqrt(g*g+y*y),w=Math.pow(i.idealLength-b,2)/i.elasticity;if(b!==0)var N=w*g/b,k=w*y/b;else var N=0,k=0;s.isLocked||(s.offsetX+=N,s.offsetY+=k),l.isLocked||(l.offsetX-=N,l.offsetY-=k)}}},FL=function(e,r){if(r.gravity!==0)for(var n=1,i=0;i<e.graphSet.length;i++){var a=e.graphSet[i],s=a.length;if(i===0)var o=e.clientHeight/2,l=e.clientWidth/2;else var u=e.layoutNodes[e.idToIndex[a[0]]],c=e.layoutNodes[e.idToIndex[u.parentId]],o=c.positionX,l=c.positionY;for(var f=0;f<s;f++){var m=e.layoutNodes[e.idToIndex[a[f]]];if(!m.isLocked){var g=o-m.positionX,y=l-m.positionY,b=Math.sqrt(g*g+y*y);if(b>n){var w=r.gravity*g/b,N=r.gravity*y/b;m.offsetX+=w,m.offsetY+=N}}}}},zL=function(e,r){var n=[],i=0,a=-1;for(n.push.apply(n,e.graphSet[0]),a+=e.graphSet[0].length;i<=a;){var s=n[i++],o=e.idToIndex[s],l=e.layoutNodes[o],u=l.children;if(0<u.length&&!l.isLocked){for(var c=l.offsetX,f=l.offsetY,m=0;m<u.length;m++){var g=e.layoutNodes[e.idToIndex[u[m]]];g.offsetX+=c,g.offsetY+=f,n[++a]=u[m]}l.offsetX=0,l.offsetY=0}}},VL=function(e,r){for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];if(!(0<i.children.length||i.isLocked)){var a=UL(i.offsetX,i.offsetY,e.temperature);i.positionX+=a.x,i.positionY+=a.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,kj(i,e)}}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},UL=function(e,r,n){var i=Math.sqrt(e*e+r*r);if(i>n)var a={x:n*e/i,y:n*r/i};else var a={x:e,y:r};return a},kj=function(e,r){var n=e.parentId;if(n!=null){var i=r.layoutNodes[r.idToIndex[n]],a=!1;if((i.maxX==null||e.maxX+i.padRight>i.maxX)&&(i.maxX=e.maxX+i.padRight,a=!0),(i.minX==null||e.minX-i.padLeft<i.minX)&&(i.minX=e.minX-i.padLeft,a=!0),(i.maxY==null||e.maxY+i.padBottom>i.maxY)&&(i.maxY=e.maxY+i.padBottom,a=!0),(i.minY==null||e.minY-i.padTop<i.minY)&&(i.minY=e.minY-i.padTop,a=!0),a)return kj(i,r)}},XN=function(e,r){for(var n=e.layoutNodes,i=[],a=0;a<n.length;a++){var s=n[a],o=s.cmptId,l=i[o]=i[o]||[];l.push(s)}for(var u=0,a=0;a<i.length;a++){var c=i[a];if(c){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var f=0;f<c.length;f++){var m=c[f];c.x1=Math.min(c.x1,m.positionX-m.width/2),c.x2=Math.max(c.x2,m.positionX+m.width/2),c.y1=Math.min(c.y1,m.positionY-m.height/2),c.y2=Math.max(c.y2,m.positionY+m.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,u+=c.w*c.h}}i.sort(function(k,C){return C.w*C.h-k.w*k.h});for(var g=0,y=0,b=0,w=0,N=Math.sqrt(u)*e.clientWidth/e.clientHeight,a=0;a<i.length;a++){var c=i[a];if(c){for(var f=0;f<c.length;f++){var m=c[f];m.isLocked||(m.positionX+=g-c.x1,m.positionY+=y-c.y1)}g+=c.w+r.componentSpacing,b+=c.w+r.componentSpacing,w=Math.max(w,c.h),b>N&&(y+=w+r.componentSpacing,g=0,b=0,w=0)}}},GL={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function Cj(t){this.options=Ct({},GL,t)}Cj.prototype.run=function(){var t=this.options,e=t,r=t.cy,n=e.eles,i=n.nodes().not(":parent");e.sort&&(i=i.sort(e.sort));var a=ea(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()});if(a.h===0||a.w===0)n.nodes().layoutPositions(this,e,function(Z){return{x:a.x1,y:a.y1}});else{var s=i.size(),o=Math.sqrt(s*a.h/a.w),l=Math.round(o),u=Math.round(a.w/a.h*o),c=function(ie){if(ie==null)return Math.min(l,u);var ce=Math.min(l,u);ce==l?l=ie:u=ie},f=function(ie){if(ie==null)return Math.max(l,u);var ce=Math.max(l,u);ce==l?l=ie:u=ie},m=e.rows,g=e.cols!=null?e.cols:e.columns;if(m!=null&&g!=null)l=m,u=g;else if(m!=null&&g==null)l=m,u=Math.ceil(s/l);else if(m==null&&g!=null)u=g,l=Math.ceil(s/u);else if(u*l>s){var y=c(),b=f();(y-1)*b>=s?c(y-1):(b-1)*y>=s&&f(b-1)}else for(;u*l<s;){var w=c(),N=f();(N+1)*w>=s?f(N+1):c(w+1)}var k=a.w/u,C=a.h/l;if(e.condense&&(k=0,C=0),e.avoidOverlap)for(var E=0;E<i.length;E++){var P=i[E],_=P._private.position;(_.x==null||_.y==null)&&(_.x=0,_.y=0);var A=P.layoutDimensions(e),I=e.avoidOverlapPadding,D=A.w+I,L=A.h+I;k=Math.max(k,D),C=Math.max(C,L)}for(var U={},H=function(ie,ce){return!!U["c-"+ie+"-"+ce]},M=function(ie,ce){U["c-"+ie+"-"+ce]=!0},z=0,O=0,G=function(){O++,O>=u&&(O=0,z++)},W={},$=0;$<i.length;$++){var X=i[$],Q=e.position(X);if(Q&&(Q.row!==void 0||Q.col!==void 0)){var V={row:Q.row,col:Q.col};if(V.col===void 0)for(V.col=0;H(V.row,V.col);)V.col++;else if(V.row===void 0)for(V.row=0;H(V.row,V.col);)V.row++;W[X.id()]=V,M(V.row,V.col)}}var Y=function(ie,ce){var he,ee;if(ie.locked()||ie.isParent())return!1;var le=W[ie.id()];if(le)he=le.col*k+k/2+a.x1,ee=le.row*C+C/2+a.y1;else{for(;H(z,O);)G();he=O*k+k/2+a.x1,ee=z*C+C/2+a.y1,M(z,O),G()}return{x:he,y:ee}};i.layoutPositions(this,e,Y)}return this};var HL={ready:function(){},stop:function(){}};function VS(t){this.options=Ct({},HL,t)}VS.prototype.run=function(){var t=this.options,e=t.eles,r=this;return t.cy,r.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),r.one("layoutready",t.ready),r.emit("layoutready"),r.one("layoutstop",t.stop),r.emit("layoutstop"),this};VS.prototype.stop=function(){return this};var qL={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function Nj(t){this.options=Ct({},qL,t)}Nj.prototype.run=function(){var t=this.options,e=t.eles,r=e.nodes(),n=Qr(t.positions);function i(a){if(t.positions==null)return hO(a.position());if(n)return t.positions(a);var s=t.positions[a._private.data.id];return s??null}return r.layoutPositions(this,t,function(a,s){var o=i(a);return a.locked()||o==null?!1:o}),this};var WL={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function Ej(t){this.options=Ct({},WL,t)}Ej.prototype.run=function(){var t=this.options,e=t.cy,r=t.eles,n=ea(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),i=function(s,o){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};return r.nodes().layoutPositions(this,t,i),this};var $L=[{name:"breadthfirst",impl:yj},{name:"circle",impl:xj},{name:"concentric",impl:bj},{name:"cose",impl:xx},{name:"grid",impl:Cj},{name:"null",impl:VS},{name:"preset",impl:Nj},{name:"random",impl:Ej}];function Tj(t){this.options=t,this.notifications=0}var QN=function(){},JN=function(){throw new Error("A headless instance can not render images")};Tj.prototype={recalculateRenderedStyle:QN,notify:function(){this.notifications++},init:QN,isHeadless:function(){return!0},png:JN,jpg:JN};var US={};US.arrowShapeWidth=.3;US.registerArrowShapes=function(){var t=this.arrowShapes={},e=this,r=function(u,c,f,m,g,y,b){var w=g.x-f/2-b,N=g.x+f/2+b,k=g.y-f/2-b,C=g.y+f/2+b,E=w<=u&&u<=N&&k<=c&&c<=C;return E},n=function(u,c,f,m,g){var y=u*Math.cos(m)-c*Math.sin(m),b=u*Math.sin(m)+c*Math.cos(m),w=y*f,N=b*f,k=w+g.x,C=N+g.y;return{x:k,y:C}},i=function(u,c,f,m){for(var g=[],y=0;y<u.length;y+=2){var b=u[y],w=u[y+1];g.push(n(b,w,c,f,m))}return g},a=function(u){for(var c=[],f=0;f<u.length;f++){var m=u[f];c.push(m.x,m.y)}return c},s=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},o=function(u,c){xt(c)&&(c=t[c]),t[u]=Ct({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(m,g,y,b,w,N){var k=a(i(this.points,y+2*N,b,w)),C=xa(m,g,k);return C},roughCollide:r,draw:function(m,g,y,b){var w=i(this.points,g,y,b);e.arrowShapeImpl("polygon")(m,w)},spacing:function(m){return 0},gap:s},c)};o("none",{collide:J0,roughCollide:J0,draw:TS,spacing:f5,gap:f5}),o("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),o("arrow","triangle"),o("triangle-backcurve",{points:t.triangle.points,controlPoint:[0,-.15],roughCollide:r,draw:function(u,c,f,m,g){var y=i(this.points,c,f,m),b=this.controlPoint,w=n(b[0],b[1],c,f,m);e.arrowShapeImpl(this.name)(u,y,w)},gap:function(u){return s(u)*.8}}),o("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,c,f,m,g,y,b){var w=a(i(this.points,f+2*b,m,g)),N=a(i(this.pointsTee,f+2*b,m,g)),k=xa(u,c,w)||xa(u,c,N);return k},draw:function(u,c,f,m,g){var y=i(this.points,c,f,m),b=i(this.pointsTee,c,f,m);e.arrowShapeImpl(this.name)(u,y,b)}}),o("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,c,f,m,g,y,b){var w=g,N=Math.pow(w.x-u,2)+Math.pow(w.y-c,2)<=Math.pow((f+2*b)*this.radius,2),k=a(i(this.points,f+2*b,m,g));return xa(u,c,k)||N},draw:function(u,c,f,m,g){var y=i(this.pointsTr,c,f,m);e.arrowShapeImpl(this.name)(u,y,m.x,m.y,this.radius*c)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,c){var f=this.baseCrossLinePts.slice(),m=c/u,g=3,y=5;return f[g]=f[g]-m,f[y]=f[y]-m,f},collide:function(u,c,f,m,g,y,b){var w=a(i(this.points,f+2*b,m,g)),N=a(i(this.crossLinePts(f,y),f+2*b,m,g)),k=xa(u,c,w)||xa(u,c,N);return k},draw:function(u,c,f,m,g){var y=i(this.points,c,f,m),b=i(this.crossLinePts(c,g),c,f,m);e.arrowShapeImpl(this.name)(u,y,b)}}),o("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return s(u)*.525}}),o("circle",{radius:.15,collide:function(u,c,f,m,g,y,b){var w=g,N=Math.pow(w.x-u,2)+Math.pow(w.y-c,2)<=Math.pow((f+2*b)*this.radius,2);return N},draw:function(u,c,f,m,g){e.arrowShapeImpl(this.name)(u,m.x,m.y,this.radius*c)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),o("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),o("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),o("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};var Sd={};Sd.projectIntoViewport=function(t,e){var r=this.cy,n=this.findContainerClientCoords(),i=n[0],a=n[1],s=n[4],o=r.pan(),l=r.zoom(),u=((t-i)/s-o.x)/l,c=((e-a)/s-o.y)/l;return[u,c]};Sd.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var t=this.container,e=t.getBoundingClientRect(),r=this.cy.window().getComputedStyle(t),n=function(N){return parseFloat(r.getPropertyValue(N))},i={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")},a={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")},s=t.clientWidth,o=t.clientHeight,l=i.left+i.right,u=i.top+i.bottom,c=a.left+a.right,f=e.width/(s+c),m=s-l,g=o-u,y=e.left+i.left+a.left,b=e.top+i.top+a.top;return this.containerBB=[y,b,m,g,f]};Sd.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Sd.findNearestElement=function(t,e,r,n){return this.findNearestElements(t,e,r,n)[0]};Sd.findNearestElements=function(t,e,r,n){var i=this,a=this,s=a.getCachedZSortedEles(),o=[],l=a.cy.zoom(),u=a.cy.hasCompoundNodes(),c=(n?24:8)/l,f=(n?8:2)/l,m=(n?8:2)/l,g=1/0,y,b;r&&(s=s.interactive);function w(A,I){if(A.isNode()){if(b)return;b=A,o.push(A)}if(A.isEdge()&&(I==null||I<g))if(y){if(y.pstyle("z-compound-depth").value===A.pstyle("z-compound-depth").value&&y.pstyle("z-compound-depth").value===A.pstyle("z-compound-depth").value){for(var D=0;D<o.length;D++)if(o[D].isEdge()){o[D]=A,y=A,g=I??g;break}}}else o.push(A),y=A,g=I??g}function N(A){var I=A.outerWidth()+2*f,D=A.outerHeight()+2*f,L=I/2,U=D/2,H=A.position(),M=A.pstyle("corner-radius").value==="auto"?"auto":A.pstyle("corner-radius").pfValue,z=A._private.rscratch;if(H.x-L<=t&&t<=H.x+L&&H.y-U<=e&&e<=H.y+U){var O=a.nodeShapes[i.getNodeShape(A)];if(O.checkPoint(t,e,0,I,D,H.x,H.y,M,z))return w(A,0),!0}}function k(A){var I=A._private,D=I.rscratch,L=A.pstyle("width").pfValue,U=A.pstyle("arrow-scale").value,H=L/2+c,M=H*H,z=H*2,$=I.source,X=I.target,O;if(D.edgeType==="segments"||D.edgeType==="straight"||D.edgeType==="haystack"){for(var G=D.allpts,W=0;W+3<G.length;W+=2)if(TO(t,e,G[W],G[W+1],G[W+2],G[W+3],z)&&M>(O=AO(t,e,G[W],G[W+1],G[W+2],G[W+3])))return w(A,O),!0}else if(D.edgeType==="bezier"||D.edgeType==="multibezier"||D.edgeType==="self"||D.edgeType==="compound"){for(var G=D.allpts,W=0;W+5<D.allpts.length;W+=4)if(jO(t,e,G[W],G[W+1],G[W+2],G[W+3],G[W+4],G[W+5],z)&&M>(O=_O(t,e,G[W],G[W+1],G[W+2],G[W+3],G[W+4],G[W+5])))return w(A,O),!0}for(var $=$||I.source,X=X||I.target,Q=i.getArrowWidth(L,U),V=[{name:"source",x:D.arrowStartX,y:D.arrowStartY,angle:D.srcArrowAngle},{name:"target",x:D.arrowEndX,y:D.arrowEndY,angle:D.tgtArrowAngle},{name:"mid-source",x:D.midX,y:D.midY,angle:D.midsrcArrowAngle},{name:"mid-target",x:D.midX,y:D.midY,angle:D.midtgtArrowAngle}],W=0;W<V.length;W++){var Y=V[W],Z=a.arrowShapes[A.pstyle(Y.name+"-arrow-shape").value],ie=A.pstyle("width").pfValue;if(Z.roughCollide(t,e,Q,Y.angle,{x:Y.x,y:Y.y},ie,c)&&Z.collide(t,e,Q,Y.angle,{x:Y.x,y:Y.y},ie,c))return w(A),!0}u&&o.length>0&&(N($),N(X))}function C(A,I,D){return ya(A,I,D)}function E(A,I){var D=A._private,L=m,U;I?U=I+"-":U="",A.boundingBox();var H=D.labelBounds[I||"main"],M=A.pstyle(U+"label").value,z=A.pstyle("text-events").strValue==="yes";if(!(!z||!M)){var O=C(D.rscratch,"labelX",I),G=C(D.rscratch,"labelY",I),W=C(D.rscratch,"labelAngle",I),$=A.pstyle(U+"text-margin-x").pfValue,X=A.pstyle(U+"text-margin-y").pfValue,Q=H.x1-L-$,V=H.x2+L-$,Y=H.y1-L-X,Z=H.y2+L-X;if(W){var ie=Math.cos(W),ce=Math.sin(W),he=function(pe,Te){return pe=pe-O,Te=Te-G,{x:pe*ie-Te*ce+O,y:pe*ce+Te*ie+G}},ee=he(Q,Y),le=he(Q,Z),te=he(V,Y),ae=he(V,Z),oe=[ee.x+$,ee.y+X,te.x+$,te.y+X,ae.x+$,ae.y+X,le.x+$,le.y+X];if(xa(t,e,oe))return w(A),!0}else if(Eu(H,t,e))return w(A),!0}}for(var P=s.length-1;P>=0;P--){var _=s[P];_.isNode()?N(_)||E(_):k(_)||E(_)||E(_,"source")||E(_,"target")}return o};Sd.getAllInBox=function(t,e,r,n){var i=this.getCachedZSortedEles().interactive,a=this.cy.zoom(),s=2/a,o=[],l=Math.min(t,r),u=Math.max(t,r),c=Math.min(e,n),f=Math.max(e,n);t=l,r=u,e=c,n=f;var m=ea({x1:t,y1:e,x2:r,y2:n}),g=[{x:m.x1,y:m.y1},{x:m.x2,y:m.y1},{x:m.x2,y:m.y2},{x:m.x1,y:m.y2}],y=[[g[0],g[1]],[g[1],g[2]],[g[2],g[3]],[g[3],g[0]]];function b(pe,Te,Oe){return ya(pe,Te,Oe)}function w(pe,Te){var Oe=pe._private,_e=s,Ae="";pe.boundingBox();var He=Oe.labelBounds.main;if(!He)return null;var tt=b(Oe.rscratch,"labelX",Te),Ie=b(Oe.rscratch,"labelY",Te),ye=b(Oe.rscratch,"labelAngle",Te),Pe=pe.pstyle(Ae+"text-margin-x").pfValue,Be=pe.pstyle(Ae+"text-margin-y").pfValue,Ge=He.x1-_e-Pe,et=He.x2+_e-Pe,mt=He.y1-_e-Be,gt=He.y2+_e-Be;if(ye){var bt=Math.cos(ye),_t=Math.sin(ye),ot=function(De,re){return De=De-tt,re=re-Ie,{x:De*bt-re*_t+tt,y:De*_t+re*bt+Ie}};return[ot(Ge,mt),ot(et,mt),ot(et,gt),ot(Ge,gt)]}else return[{x:Ge,y:mt},{x:et,y:mt},{x:et,y:gt},{x:Ge,y:gt}]}function N(pe,Te,Oe,_e){function Ae(He,tt,Ie){return(Ie.y-He.y)*(tt.x-He.x)>(tt.y-He.y)*(Ie.x-He.x)}return Ae(pe,Oe,_e)!==Ae(Te,Oe,_e)&&Ae(pe,Te,Oe)!==Ae(pe,Te,_e)}for(var k=0;k<i.length;k++){var C=i[k];if(C.isNode()){var E=C,P=E.pstyle("text-events").strValue==="yes",_=E.pstyle("box-selection").strValue,A=E.pstyle("box-select-labels").strValue==="yes";if(_==="none")continue;var I=(_==="overlap"||A)&&P,D=E.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:I});if(_==="contain"){var L=!1;if(A&&P){var U=w(E);U&&K1(U,g)&&(o.push(E),L=!0)}!L&&D6(m,D)&&o.push(E)}else if(_==="overlap"&&_S(m,D)){var H=E.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1}),M=[{x:H.x1,y:H.y1},{x:H.x2,y:H.y1},{x:H.x2,y:H.y2},{x:H.x1,y:H.y2}];if(K1(M,g))o.push(E);else{var z=w(E);z&&K1(z,g)&&o.push(E)}}}else{var O=C,G=O._private,W=G.rscratch,$=O.pstyle("box-selection").strValue;if($==="none")continue;if($==="contain"){if(W.startX!=null&&W.startY!=null&&!Eu(m,W.startX,W.startY)||W.endX!=null&&W.endY!=null&&!Eu(m,W.endX,W.endY))continue;if(W.edgeType==="bezier"||W.edgeType==="multibezier"||W.edgeType==="self"||W.edgeType==="compound"||W.edgeType==="segments"||W.edgeType==="haystack"){for(var X=G.rstyle.bezierPts||G.rstyle.linePts||G.rstyle.haystackPts,Q=!0,V=0;V<X.length;V++)if(!v5(m,X[V])){Q=!1;break}Q&&o.push(O)}else W.edgeType==="straight"&&o.push(O)}else if($==="overlap"){var Y=!1;if(W.startX!=null&&W.startY!=null&&W.endX!=null&&W.endY!=null&&(Eu(m,W.startX,W.startY)||Eu(m,W.endX,W.endY)))o.push(O),Y=!0;else if(!Y&&W.edgeType==="haystack"){for(var Z=G.rstyle.haystackPts,ie=0;ie<Z.length;ie++)if(v5(m,Z[ie])){o.push(O),Y=!0;break}}if(!Y){var ce=G.rstyle.bezierPts||G.rstyle.linePts||G.rstyle.haystackPts;if((!ce||ce.length<2)&&W.edgeType==="straight"&&W.startX!=null&&W.startY!=null&&W.endX!=null&&W.endY!=null&&(ce=[{x:W.startX,y:W.startY},{x:W.endX,y:W.endY}]),!ce||ce.length<2)continue;for(var he=0;he<ce.length-1;he++){for(var ee=ce[he],le=ce[he+1],te=0;te<y.length;te++){var ae=Pn(y[te],2),oe=ae[0],fe=ae[1];if(N(ee,le,oe,fe)){o.push(O),Y=!0;break}}if(Y)break}}}}}return o};var ay={};ay.calculateArrowAngles=function(t){var e=t._private.rscratch,r=e.edgeType==="haystack",n=e.edgeType==="bezier",i=e.edgeType==="multibezier",a=e.edgeType==="segments",s=e.edgeType==="compound",o=e.edgeType==="self",l,u,c,f,m,g,N,k;if(r?(c=e.haystackPts[0],f=e.haystackPts[1],m=e.haystackPts[2],g=e.haystackPts[3]):(c=e.arrowStartX,f=e.arrowStartY,m=e.arrowEndX,g=e.arrowEndY),N=e.midX,k=e.midY,a)l=c-e.segpts[0],u=f-e.segpts[1];else if(i||s||o||n){var y=e.allpts,b=Zn(y[0],y[2],y[4],.1),w=Zn(y[1],y[3],y[5],.1);l=c-b,u=f-w}else l=c-N,u=f-k;e.srcArrowAngle=Xv(l,u);var N=e.midX,k=e.midY;if(r&&(N=(c+m)/2,k=(f+g)/2),l=m-c,u=g-f,a){var y=e.allpts;if(y.length/2%2===0){var C=y.length/2,E=C-2;l=y[C]-y[E],u=y[C+1]-y[E+1]}else if(e.isRound)l=e.midVector[1],u=-e.midVector[0];else{var C=y.length/2-1,E=C-2;l=y[C]-y[E],u=y[C+1]-y[E+1]}}else if(i||s||o){var y=e.allpts,P=e.ctrlpts,_,A,I,D;if(P.length/2%2===0){var L=y.length/2-1,U=L+2,H=U+2;_=Zn(y[L],y[U],y[H],0),A=Zn(y[L+1],y[U+1],y[H+1],0),I=Zn(y[L],y[U],y[H],1e-4),D=Zn(y[L+1],y[U+1],y[H+1],1e-4)}else{var U=y.length/2-1,L=U-2,H=U+2;_=Zn(y[L],y[U],y[H],.4999),A=Zn(y[L+1],y[U+1],y[H+1],.4999),I=Zn(y[L],y[U],y[H],.5),D=Zn(y[L+1],y[U+1],y[H+1],.5)}l=I-_,u=D-A}if(e.midtgtArrowAngle=Xv(l,u),e.midDispX=l,e.midDispY=u,l*=-1,u*=-1,a){var y=e.allpts;if(y.length/2%2!==0){if(!e.isRound){var C=y.length/2-1,M=C+2;l=-(y[M]-y[C]),u=-(y[M+1]-y[C+1])}}}if(e.midsrcArrowAngle=Xv(l,u),a)l=m-e.segpts[e.segpts.length-2],u=g-e.segpts[e.segpts.length-1];else if(i||s||o||n){var y=e.allpts,z=y.length,b=Zn(y[z-6],y[z-4],y[z-2],.9),w=Zn(y[z-5],y[z-3],y[z-1],.9);l=m-b,u=g-w}else l=m-N,u=g-k;e.tgtArrowAngle=Xv(l,u)};ay.getArrowWidth=ay.getArrowHeight=function(t,e){var r=this.arrowWidthCache=this.arrowWidthCache||{},n=r[t+", "+e];return n||(n=Math.max(Math.pow(t*13.37,.9),29)*e,r[t+", "+e]=n,n)};var k2,C2,po={},ns={},ZN,eE,$c,I0,el,Fc,Hc,co,Pf,i0,jj,Pj,N2,E2,tE,rE=function(e,r,n){n.x=r.x-e.x,n.y=r.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},KL=function(e,r){r.x=e.x*-1,r.y=e.y*-1,r.nx=e.nx*-1,r.ny=e.ny*-1,r.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},YL=function(e,r,n,i,a){if(e!==tE?rE(r,e,po):KL(ns,po),rE(r,n,ns),ZN=po.nx*ns.ny-po.ny*ns.nx,eE=po.nx*ns.nx-po.ny*-ns.ny,el=Math.asin(Math.max(-1,Math.min(1,ZN))),Math.abs(el)<1e-6){k2=r.x,C2=r.y,Hc=Pf=0;return}$c=1,I0=!1,eE<0?el<0?el=Math.PI+el:(el=Math.PI-el,$c=-1,I0=!0):el>0&&($c=-1,I0=!0),r.radius!==void 0?Pf=r.radius:Pf=i,Fc=el/2,i0=Math.min(po.len/2,ns.len/2),a?(co=Math.abs(Math.cos(Fc)*Pf/Math.sin(Fc)),co>i0?(co=i0,Hc=Math.abs(co*Math.sin(Fc)/Math.cos(Fc))):Hc=Pf):(co=Math.min(i0,Pf),Hc=Math.abs(co*Math.sin(Fc)/Math.cos(Fc))),N2=r.x+ns.nx*co,E2=r.y+ns.ny*co,k2=N2-ns.ny*Hc*$c,C2=E2+ns.nx*Hc*$c,jj=r.x+po.nx*co,Pj=r.y+po.ny*co,tE=r};function Mj(t,e){e.radius===0?t.lineTo(e.cx,e.cy):t.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function GS(t,e,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return n===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(YL(t,e,r,n,i),{cx:k2,cy:C2,radius:Hc,startX:jj,startY:Pj,stopX:N2,stopY:E2,startAngle:po.ang+Math.PI/2*$c,endAngle:ns.ang-Math.PI/2*$c,counterClockwise:I0})}var lg=.01,XL=Math.sqrt(2*lg),Li={};Li.findMidptPtsEtc=function(t,e){var r=e.posPts,n=e.intersectionPts,i=e.vectorNormInverse,a,s=t.pstyle("source-endpoint"),o=t.pstyle("target-endpoint"),l=s.units!=null&&o.units!=null,u=function(P,_,A,I){var D=I-_,L=A-P,U=Math.sqrt(L*L+D*D);return{x:-D/U,y:L/U}},c=t.pstyle("edge-distances").value;switch(c){case"node-position":a=r;break;case"intersection":a=n;break;case"endpoints":{if(l){var f=this.manualEndptToPx(t.source()[0],s),m=Pn(f,2),g=m[0],y=m[1],b=this.manualEndptToPx(t.target()[0],o),w=Pn(b,2),N=w[0],k=w[1],C={x1:g,y1:y,x2:N,y2:k};i=u(g,y,N,k),a=C}else lr("Edge ".concat(t.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),a=n;break}}return{midptPts:a,vectorNormInverse:i}};Li.findHaystackPoints=function(t){for(var e=0;e<t.length;e++){var r=t[e],n=r._private,i=n.rscratch;if(!i.haystack){var a=Math.random()*2*Math.PI;i.source={x:Math.cos(a),y:Math.sin(a)},a=Math.random()*2*Math.PI,i.target={x:Math.cos(a),y:Math.sin(a)}}var s=n.source,o=n.target,l=s.position(),u=o.position(),c=s.width(),f=o.width(),m=s.height(),g=o.height(),y=r.pstyle("haystack-radius").value,b=y/2;i.haystackPts=i.allpts=[i.source.x*c*b+l.x,i.source.y*m*b+l.y,i.target.x*f*b+u.x,i.target.y*g*b+u.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(r),this.calculateArrowAngles(r),this.recalculateEdgeLabelProjections(r),this.calculateLabelAngles(r)}};Li.findSegmentsPoints=function(t,e){var r=t._private.rscratch,n=t.pstyle("segment-weights"),i=t.pstyle("segment-distances"),a=t.pstyle("segment-radii"),s=t.pstyle("radius-type"),o=Math.min(n.pfValue.length,i.pfValue.length),l=a.pfValue[a.pfValue.length-1],u=s.pfValue[s.pfValue.length-1];r.edgeType="segments",r.segpts=[],r.radii=[],r.isArcRadius=[];for(var c=0;c<o;c++){var f=n.pfValue[c],m=i.pfValue[c],g=1-f,y=f,b=this.findMidptPtsEtc(t,e),w=b.midptPts,N=b.vectorNormInverse,k={x:w.x1*g+w.x2*y,y:w.y1*g+w.y2*y};r.segpts.push(k.x+N.x*m,k.y+N.y*m),r.radii.push(a.pfValue[c]!==void 0?a.pfValue[c]:l),r.isArcRadius.push((s.pfValue[c]!==void 0?s.pfValue[c]:u)==="arc-radius")}};Li.findLoopPoints=function(t,e,r,n){var i=t._private.rscratch,a=e.dirCounts,s=e.srcPos,o=t.pstyle("control-point-distances"),l=o?o.pfValue[0]:void 0,u=t.pstyle("loop-direction").pfValue,c=t.pstyle("loop-sweep").pfValue,f=t.pstyle("control-point-step-size").pfValue;i.edgeType="self";var m=r,g=f;n&&(m=0,g=l);var y=u-Math.PI/2,b=y-c/2,w=y+c/2,N=u+"_"+c;m=a[N]===void 0?a[N]=0:++a[N],i.ctrlpts=[s.x+Math.cos(b)*1.4*g*(m/3+1),s.y+Math.sin(b)*1.4*g*(m/3+1),s.x+Math.cos(w)*1.4*g*(m/3+1),s.y+Math.sin(w)*1.4*g*(m/3+1)]};Li.findCompoundLoopPoints=function(t,e,r,n){var i=t._private.rscratch;i.edgeType="compound";var a=e.srcPos,s=e.tgtPos,o=e.srcW,l=e.srcH,u=e.tgtW,c=e.tgtH,f=t.pstyle("control-point-step-size").pfValue,m=t.pstyle("control-point-distances"),g=m?m.pfValue[0]:void 0,y=r,b=f;n&&(y=0,b=g);var w=50,N={x:a.x-o/2,y:a.y-l/2},k={x:s.x-u/2,y:s.y-c/2},C={x:Math.min(N.x,k.x),y:Math.min(N.y,k.y)},E=.5,P=Math.max(E,Math.log(o*lg)),_=Math.max(E,Math.log(u*lg));i.ctrlpts=[C.x,C.y-(1+Math.pow(w,1.12)/100)*b*(y/3+1)*P,C.x-(1+Math.pow(w,1.12)/100)*b*(y/3+1)*_,C.y]};Li.findStraightEdgePoints=function(t){t._private.rscratch.edgeType="straight"};Li.findBezierPoints=function(t,e,r,n,i){var a=t._private.rscratch,s=t.pstyle("control-point-step-size").pfValue,o=t.pstyle("control-point-distances"),l=t.pstyle("control-point-weights"),u=o&&l?Math.min(o.value.length,l.value.length):1,c=o?o.pfValue[0]:void 0,f=l.value[0],m=n;a.edgeType=m?"multibezier":"bezier",a.ctrlpts=[];for(var g=0;g<u;g++){var y=(.5-e.eles.length/2+r)*s*(i?-1:1),b=void 0,w=MS(y);m&&(c=o?o.pfValue[g]:s,f=l.value[g]),n?b=c:b=c!==void 0?w*c:void 0;var N=b!==void 0?b:y,k=1-f,C=f,E=this.findMidptPtsEtc(t,e),P=E.midptPts,_=E.vectorNormInverse,A={x:P.x1*k+P.x2*C,y:P.y1*k+P.y2*C};a.ctrlpts.push(A.x+_.x*N,A.y+_.y*N)}};Li.findTaxiPoints=function(t,e){var r=t._private.rscratch;r.edgeType="segments";var n="vertical",i="horizontal",a="leftward",s="rightward",o="downward",l="upward",u="auto",c=e.posPts,f=e.srcW,m=e.srcH,g=e.tgtW,y=e.tgtH,b=t.pstyle("edge-distances").value,w=b!=="node-position",N=t.pstyle("taxi-direction").value,k=N,C=t.pstyle("taxi-turn"),E=C.units==="%",P=C.pfValue,_=P<0,A=t.pstyle("taxi-turn-min-distance").pfValue,I=w?(f+g)/2:0,D=w?(m+y)/2:0,L=c.x2-c.x1,U=c.y2-c.y1,H=function(re,ue){return re>0?Math.max(re-ue,0):Math.min(re+ue,0)},M=H(L,I),z=H(U,D),O=!1;k===u?N=Math.abs(M)>Math.abs(z)?i:n:k===l||k===o?(N=n,O=!0):(k===a||k===s)&&(N=i,O=!0);var G=N===n,W=G?z:M,$=G?U:L,X=MS($),Q=!1;!(O&&(E||_))&&(k===o&&$<0||k===l&&$>0||k===a&&$>0||k===s&&$<0)&&(X*=-1,W=X*Math.abs(W),Q=!0);var V;if(E){var Y=P<0?1+P:P;V=Y*W}else{var Z=P<0?W:0;V=Z+P*X}var ie=function(re){return Math.abs(re)<A||Math.abs(re)>=Math.abs(W)},ce=ie(V),he=ie(Math.abs(W)-Math.abs(V)),ee=ce||he;if(ee&&!Q)if(G){var le=Math.abs($)<=m/2,te=Math.abs(L)<=g/2;if(le){var ae=(c.x1+c.x2)/2,oe=c.y1,fe=c.y2;r.segpts=[ae,oe,ae,fe]}else if(te){var pe=(c.y1+c.y2)/2,Te=c.x1,Oe=c.x2;r.segpts=[Te,pe,Oe,pe]}else r.segpts=[c.x1,c.y2]}else{var _e=Math.abs($)<=f/2,Ae=Math.abs(U)<=y/2;if(_e){var He=(c.y1+c.y2)/2,tt=c.x1,Ie=c.x2;r.segpts=[tt,He,Ie,He]}else if(Ae){var ye=(c.x1+c.x2)/2,Pe=c.y1,Be=c.y2;r.segpts=[ye,Pe,ye,Be]}else r.segpts=[c.x2,c.y1]}else if(G){var Ge=c.y1+V+(w?m/2*X:0),et=c.x1,mt=c.x2;r.segpts=[et,Ge,mt,Ge]}else{var gt=c.x1+V+(w?f/2*X:0),bt=c.y1,_t=c.y2;r.segpts=[gt,bt,gt,_t]}if(r.isRound){var ot=t.pstyle("taxi-radius").value,Ye=t.pstyle("radius-type").value[0]==="arc-radius";r.radii=new Array(r.segpts.length/2).fill(ot),r.isArcRadius=new Array(r.segpts.length/2).fill(Ye)}};Li.tryToCorrectInvalidPoints=function(t,e){var r=t._private.rscratch;if(r.edgeType==="bezier"){var n=e.srcPos,i=e.tgtPos,a=e.srcW,s=e.srcH,o=e.tgtW,l=e.tgtH,u=e.srcShape,c=e.tgtShape,f=e.srcCornerRadius,m=e.tgtCornerRadius,g=e.srcRs,y=e.tgtRs,b=!Qe(r.startX)||!Qe(r.startY),w=!Qe(r.arrowStartX)||!Qe(r.arrowStartY),N=!Qe(r.endX)||!Qe(r.endY),k=!Qe(r.arrowEndX)||!Qe(r.arrowEndY),C=3,E=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth,P=C*E,_=cd({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.startX,y:r.startY}),A=_<P,I=cd({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.endX,y:r.endY}),D=I<P,L=!1;if(b||w||A){L=!0;var U={x:r.ctrlpts[0]-n.x,y:r.ctrlpts[1]-n.y},H=Math.sqrt(U.x*U.x+U.y*U.y),M={x:U.x/H,y:U.y/H},z=Math.max(a,s),O={x:r.ctrlpts[0]+M.x*2*z,y:r.ctrlpts[1]+M.y*2*z},G=u.intersectLine(n.x,n.y,a,s,O.x,O.y,0,f,g);A?(r.ctrlpts[0]=r.ctrlpts[0]+M.x*(P-_),r.ctrlpts[1]=r.ctrlpts[1]+M.y*(P-_)):(r.ctrlpts[0]=G[0]+M.x*P,r.ctrlpts[1]=G[1]+M.y*P)}if(N||k||D){L=!0;var W={x:r.ctrlpts[0]-i.x,y:r.ctrlpts[1]-i.y},$=Math.sqrt(W.x*W.x+W.y*W.y),X={x:W.x/$,y:W.y/$},Q=Math.max(a,s),V={x:r.ctrlpts[0]+X.x*2*Q,y:r.ctrlpts[1]+X.y*2*Q},Y=c.intersectLine(i.x,i.y,o,l,V.x,V.y,0,m,y);D?(r.ctrlpts[0]=r.ctrlpts[0]+X.x*(P-I),r.ctrlpts[1]=r.ctrlpts[1]+X.y*(P-I)):(r.ctrlpts[0]=Y[0]+X.x*P,r.ctrlpts[1]=Y[1]+X.y*P)}L&&this.findEndpoints(t)}};Li.storeAllpts=function(t){var e=t._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var r=0;r+1<e.ctrlpts.length;r+=2)e.allpts.push(e.ctrlpts[r],e.ctrlpts[r+1]),r+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[r]+e.ctrlpts[r+2])/2,(e.ctrlpts[r+1]+e.ctrlpts[r+3])/2);e.allpts.push(e.endX,e.endY);var n,i;e.ctrlpts.length/2%2===0?(n=e.allpts.length/2-1,e.midX=e.allpts[n],e.midY=e.allpts[n+1]):(n=e.allpts.length/2-3,i=.5,e.midX=Zn(e.allpts[n],e.allpts[n+2],e.allpts[n+4],i),e.midY=Zn(e.allpts[n+1],e.allpts[n+3],e.allpts[n+5],i))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var a=2;a+3<e.allpts.length;a+=2){var s=e.radii[a/2-1],o=e.isArcRadius[a/2-1];e.roundCorners.push(GS({x:e.allpts[a-2],y:e.allpts[a-1]},{x:e.allpts[a],y:e.allpts[a+1],radius:s},{x:e.allpts[a+2],y:e.allpts[a+3]},s,o))}}if(e.segpts.length%4===0){var l=e.segpts.length/2,u=l-2;e.midX=(e.segpts[u]+e.segpts[l])/2,e.midY=(e.segpts[u+1]+e.segpts[l+1])/2}else{var c=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[c],e.midY=e.segpts[c+1];else{var f={x:e.segpts[c],y:e.segpts[c+1]},m=e.roundCorners[c/2];if(m.radius===0){var g={x:e.segpts[c+2],y:e.segpts[c+3]};e.midX=f.x,e.midY=f.y,e.midVector=[f.y-g.y,g.x-f.x]}else{var y=[f.x-m.cx,f.y-m.cy],b=m.radius/Math.sqrt(Math.pow(y[0],2)+Math.pow(y[1],2));y=y.map(function(w){return w*b}),e.midX=m.cx+y[0],e.midY=m.cy+y[1],e.midVector=y}}}}};Li.checkForInvalidEdgeWarning=function(t){var e=t[0]._private.rscratch;e.nodesOverlap||Qe(e.startX)&&Qe(e.startY)&&Qe(e.endX)&&Qe(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,lr("Edge `"+t.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};Li.findEdgeControlPoints=function(t){var e=this;if(!(!t||t.length===0)){for(var r=this,n=r.cy,i=n.hasCompoundNodes(),a=new ul,s=function(D,L){return[].concat(Y0(D),[L?1:0]).join("-")},o=[],l=[],u=0;u<t.length;u++){var c=t[u],f=c._private,m=c.pstyle("curve-style").value;if(!(c.removed()||!c.takesUpSpace())){if(m==="haystack"){l.push(c);continue}var g=m==="unbundled-bezier"||Nu(m,"segments")||m==="straight"||m==="straight-triangle"||Nu(m,"taxi"),y=m==="unbundled-bezier"||m==="bezier",b=f.source,w=f.target,N=b.poolIndex(),k=w.poolIndex(),C=[N,k].sort(),E=s(C,g),P=a.get(E);P==null&&(P={eles:[]},o.push({pairId:C,edgeIsUnbundled:g}),a.set(E,P)),P.eles.push(c),g&&(P.hasUnbundled=!0),y&&(P.hasBezier=!0)}}for(var _=function(){var D=o[A],L=D.pairId,U=D.edgeIsUnbundled,H=s(L,U),M=a.get(H),z;if(!M.hasUnbundled){var O=M.eles[0].parallelEdges().filter(function(Ye){return Ye.isBundledBezier()});jS(M.eles),O.forEach(function(Ye){return M.eles.push(Ye)}),M.eles.sort(function(Ye,De){return Ye.poolIndex()-De.poolIndex()})}var G=M.eles[0],W=G.source(),$=G.target();if(W.poolIndex()>$.poolIndex()){var X=W;W=$,$=X}var Q=M.srcPos=W.position(),V=M.tgtPos=$.position(),Y=M.srcW=W.outerWidth(),Z=M.srcH=W.outerHeight(),ie=M.tgtW=$.outerWidth(),ce=M.tgtH=$.outerHeight(),he=M.srcShape=r.nodeShapes[e.getNodeShape(W)],ee=M.tgtShape=r.nodeShapes[e.getNodeShape($)],le=M.srcCornerRadius=W.pstyle("corner-radius").value==="auto"?"auto":W.pstyle("corner-radius").pfValue,te=M.tgtCornerRadius=$.pstyle("corner-radius").value==="auto"?"auto":$.pstyle("corner-radius").pfValue,ae=M.tgtRs=$._private.rscratch,oe=M.srcRs=W._private.rscratch;M.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var fe=0;fe<M.eles.length;fe++){var pe=M.eles[fe],Te=pe[0]._private.rscratch,Oe=pe.pstyle("curve-style").value,_e=Oe==="unbundled-bezier"||Nu(Oe,"segments")||Nu(Oe,"taxi"),Ae=!W.same(pe.source());if(!M.calculatedIntersection&&W!==$&&(M.hasBezier||M.hasUnbundled)){M.calculatedIntersection=!0;var He=he.intersectLine(Q.x,Q.y,Y,Z,V.x,V.y,0,le,oe),tt=M.srcIntn=He,Ie=ee.intersectLine(V.x,V.y,ie,ce,Q.x,Q.y,0,te,ae),ye=M.tgtIntn=Ie,Pe=M.intersectionPts={x1:He[0],x2:Ie[0],y1:He[1],y2:Ie[1]},Be=M.posPts={x1:Q.x,x2:V.x,y1:Q.y,y2:V.y},Ge=Ie[1]-He[1],et=Ie[0]-He[0],mt=Math.sqrt(et*et+Ge*Ge);Qe(mt)&&mt>=XL||(mt=Math.sqrt(Math.max(et*et,lg)+Math.max(Ge*Ge,lg)));var gt=M.vector={x:et,y:Ge},bt=M.vectorNorm={x:gt.x/mt,y:gt.y/mt},_t={x:-bt.y,y:bt.x};M.nodesOverlap=!Qe(mt)||ee.checkPoint(He[0],He[1],0,ie,ce,V.x,V.y,te,ae)||he.checkPoint(Ie[0],Ie[1],0,Y,Z,Q.x,Q.y,le,oe),M.vectorNormInverse=_t,z={nodesOverlap:M.nodesOverlap,dirCounts:M.dirCounts,calculatedIntersection:!0,hasBezier:M.hasBezier,hasUnbundled:M.hasUnbundled,eles:M.eles,srcPos:V,srcRs:ae,tgtPos:Q,tgtRs:oe,srcW:ie,srcH:ce,tgtW:Y,tgtH:Z,srcIntn:ye,tgtIntn:tt,srcShape:ee,tgtShape:he,posPts:{x1:Be.x2,y1:Be.y2,x2:Be.x1,y2:Be.y1},intersectionPts:{x1:Pe.x2,y1:Pe.y2,x2:Pe.x1,y2:Pe.y1},vector:{x:-gt.x,y:-gt.y},vectorNorm:{x:-bt.x,y:-bt.y},vectorNormInverse:{x:-_t.x,y:-_t.y}}}var ot=Ae?z:M;Te.nodesOverlap=ot.nodesOverlap,Te.srcIntn=ot.srcIntn,Te.tgtIntn=ot.tgtIntn,Te.isRound=Oe.startsWith("round"),i&&(W.isParent()||W.isChild()||$.isParent()||$.isChild())&&(W.parents().anySame($)||$.parents().anySame(W)||W.same($)&&W.isParent())?e.findCompoundLoopPoints(pe,ot,fe,_e):W===$?e.findLoopPoints(pe,ot,fe,_e):Oe.endsWith("segments")?e.findSegmentsPoints(pe,ot):Oe.endsWith("taxi")?e.findTaxiPoints(pe,ot):Oe==="straight"||!_e&&M.eles.length%2===1&&fe===Math.floor(M.eles.length/2)?e.findStraightEdgePoints(pe):e.findBezierPoints(pe,ot,fe,_e,Ae),e.findEndpoints(pe),e.tryToCorrectInvalidPoints(pe,ot),e.checkForInvalidEdgeWarning(pe),e.storeAllpts(pe),e.storeEdgeProjections(pe),e.calculateArrowAngles(pe),e.recalculateEdgeLabelProjections(pe),e.calculateLabelAngles(pe)}},A=0;A<o.length;A++)_();this.findHaystackPoints(l)}};function _j(t){var e=[];if(t!=null){for(var r=0;r<t.length;r+=2){var n=t[r],i=t[r+1];e.push({x:n,y:i})}return e}}Li.getSegmentPoints=function(t){var e=t[0]._private.rscratch;this.recalculateRenderedStyle(t);var r=e.edgeType;if(r==="segments")return _j(e.segpts)};Li.getControlPoints=function(t){var e=t[0]._private.rscratch;this.recalculateRenderedStyle(t);var r=e.edgeType;if(r==="bezier"||r==="multibezier"||r==="self"||r==="compound")return _j(e.ctrlpts)};Li.getEdgeMidpoint=function(t){var e=t[0]._private.rscratch;return this.recalculateRenderedStyle(t),{x:e.midX,y:e.midY}};var Dg={};Dg.manualEndptToPx=function(t,e){var r=this,n=t.position(),i=t.outerWidth(),a=t.outerHeight(),s=t._private.rscratch;if(e.value.length===2){var o=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(o[0]=o[0]*i),e.units[1]==="%"&&(o[1]=o[1]*a),o[0]+=n.x,o[1]+=n.y,o}else{var l=e.pfValue[0];l=-Math.PI/2+l;var u=2*Math.max(i,a),c=[n.x+Math.cos(l)*u,n.y+Math.sin(l)*u];return r.nodeShapes[this.getNodeShape(t)].intersectLine(n.x,n.y,i,a,c[0],c[1],0,t.pstyle("corner-radius").value==="auto"?"auto":t.pstyle("corner-radius").pfValue,s)}};Dg.findEndpoints=function(t){var e,r,n,i,a=this,s,o=t.source()[0],l=t.target()[0],u=o.position(),c=l.position(),f=t.pstyle("target-arrow-shape").value,m=t.pstyle("source-arrow-shape").value,g=t.pstyle("target-distance-from-node").pfValue,y=t.pstyle("source-distance-from-node").pfValue,b=o._private.rscratch,w=l._private.rscratch,N=t.pstyle("curve-style").value,k=t._private.rscratch,C=k.edgeType,E=Nu(N,"taxi"),P=C==="self"||C==="compound",_=C==="bezier"||C==="multibezier"||P,A=C!=="bezier",I=C==="straight"||C==="segments",D=C==="segments",L=_||A||I,U=P||E,H=t.pstyle("source-endpoint"),M=U?"outside-to-node":H.value,z=o.pstyle("corner-radius").value==="auto"?"auto":o.pstyle("corner-radius").pfValue,O=t.pstyle("target-endpoint"),G=U?"outside-to-node":O.value,W=l.pstyle("corner-radius").value==="auto"?"auto":l.pstyle("corner-radius").pfValue;k.srcManEndpt=H,k.tgtManEndpt=O;var $,X,Q,V,Y=(e=(O==null||(r=O.pfValue)===null||r===void 0?void 0:r.length)===2?O.pfValue:null)!==null&&e!==void 0?e:[0,0],Z=(n=(H==null||(i=H.pfValue)===null||i===void 0?void 0:i.length)===2?H.pfValue:null)!==null&&n!==void 0?n:[0,0];if(_){var ie=[k.ctrlpts[0],k.ctrlpts[1]],ce=A?[k.ctrlpts[k.ctrlpts.length-2],k.ctrlpts[k.ctrlpts.length-1]]:ie;$=ce,X=ie}else if(I){var he=D?k.segpts.slice(0,2):[c.x+Y[0],c.y+Y[1]],ee=D?k.segpts.slice(k.segpts.length-2):[u.x+Z[0],u.y+Z[1]];$=ee,X=he}if(G==="inside-to-node")s=[c.x,c.y];else if(O.units)s=this.manualEndptToPx(l,O);else if(G==="outside-to-line")s=k.tgtIntn;else if(G==="outside-to-node"||G==="outside-to-node-or-label"?Q=$:(G==="outside-to-line"||G==="outside-to-line-or-label")&&(Q=[u.x,u.y]),s=a.nodeShapes[this.getNodeShape(l)].intersectLine(c.x,c.y,l.outerWidth(),l.outerHeight(),Q[0],Q[1],0,W,w),G==="outside-to-node-or-label"||G==="outside-to-line-or-label"){var le=l._private.rscratch,te=le.labelWidth,ae=le.labelHeight,oe=le.labelX,fe=le.labelY,pe=te/2,Te=ae/2,Oe=l.pstyle("text-valign").value;Oe==="top"?fe-=Te:Oe==="bottom"&&(fe+=Te);var _e=l.pstyle("text-halign").value;_e==="left"?oe-=pe:_e==="right"&&(oe+=pe);var Ae=ng(Q[0],Q[1],[oe-pe,fe-Te,oe+pe,fe-Te,oe+pe,fe+Te,oe-pe,fe+Te],c.x,c.y);if(Ae.length>0){var He=u,tt=Gc(He,Hf(s)),Ie=Gc(He,Hf(Ae)),ye=tt;if(Ie<tt&&(s=Ae,ye=Ie),Ae.length>2){var Pe=Gc(He,{x:Ae[2],y:Ae[3]});Pe<ye&&(s=[Ae[2],Ae[3]])}}}var Be=Qv(s,$,a.arrowShapes[f].spacing(t)+g),Ge=Qv(s,$,a.arrowShapes[f].gap(t)+g);if(k.endX=Ge[0],k.endY=Ge[1],k.arrowEndX=Be[0],k.arrowEndY=Be[1],M==="inside-to-node")s=[u.x,u.y];else if(H.units)s=this.manualEndptToPx(o,H);else if(M==="outside-to-line")s=k.srcIntn;else if(M==="outside-to-node"||M==="outside-to-node-or-label"?V=X:(M==="outside-to-line"||M==="outside-to-line-or-label")&&(V=[c.x,c.y]),s=a.nodeShapes[this.getNodeShape(o)].intersectLine(u.x,u.y,o.outerWidth(),o.outerHeight(),V[0],V[1],0,z,b),M==="outside-to-node-or-label"||M==="outside-to-line-or-label"){var et=o._private.rscratch,mt=et.labelWidth,gt=et.labelHeight,bt=et.labelX,_t=et.labelY,ot=mt/2,Ye=gt/2,De=o.pstyle("text-valign").value;De==="top"?_t-=Ye:De==="bottom"&&(_t+=Ye);var re=o.pstyle("text-halign").value;re==="left"?bt-=ot:re==="right"&&(bt+=ot);var ue=ng(V[0],V[1],[bt-ot,_t-Ye,bt+ot,_t-Ye,bt+ot,_t+Ye,bt-ot,_t+Ye],u.x,u.y);if(ue.length>0){var ge=c,be=Gc(ge,Hf(s)),Ce=Gc(ge,Hf(ue)),Le=be;if(Ce<be&&(s=[ue[0],ue[1]],Le=Ce),ue.length>2){var Re=Gc(ge,{x:ue[2],y:ue[3]});Re<Le&&(s=[ue[2],ue[3]])}}}var Ze=Qv(s,X,a.arrowShapes[m].spacing(t)+y),Je=Qv(s,X,a.arrowShapes[m].gap(t)+y);k.startX=Je[0],k.startY=Je[1],k.arrowStartX=Ze[0],k.arrowStartY=Ze[1],L&&(!Qe(k.startX)||!Qe(k.startY)||!Qe(k.endX)||!Qe(k.endY)?k.badLine=!0:k.badLine=!1)};Dg.getSourceEndpoint=function(t){var e=t[0]._private.rscratch;return this.recalculateRenderedStyle(t),e.edgeType==="haystack"?{x:e.haystackPts[0],y:e.haystackPts[1]}:{x:e.arrowStartX,y:e.arrowStartY}};Dg.getTargetEndpoint=function(t){var e=t[0]._private.rscratch;return this.recalculateRenderedStyle(t),e.edgeType==="haystack"?{x:e.haystackPts[2],y:e.haystackPts[3]}:{x:e.arrowEndX,y:e.arrowEndY}};var HS={};function QL(t,e,r){for(var n=function(u,c,f,m){return Zn(u,c,f,m)},i=e._private,a=i.rstyle.bezierPts,s=0;s<t.bezierProjPcts.length;s++){var o=t.bezierProjPcts[s];a.push({x:n(r[0],r[2],r[4],o),y:n(r[1],r[3],r[5],o)})}}HS.storeEdgeProjections=function(t){var e=t._private,r=e.rscratch,n=r.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){e.rstyle.bezierPts=[];for(var i=0;i+5<r.allpts.length;i+=4)QL(this,t,r.allpts.slice(i,i+6))}else if(n==="segments")for(var a=e.rstyle.linePts=[],i=0;i+1<r.allpts.length;i+=2)a.push({x:r.allpts[i],y:r.allpts[i+1]});else if(n==="haystack"){var s=r.haystackPts;e.rstyle.haystackPts=[{x:s[0],y:s[1]},{x:s[2],y:s[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth};HS.recalculateEdgeProjections=function(t){this.findEdgeControlPoints(t)};var No={};No.recalculateNodeLabelProjection=function(t){var e=t.pstyle("label").strValue;if(!Bu(e)){var r,n,i=t._private,a=t.width(),s=t.height(),o=t.padding(),l=t.position(),u=t.pstyle("text-halign").strValue,c=t.pstyle("text-valign").strValue,f=i.rscratch,m=i.rstyle;switch(u){case"left":r=l.x-a/2-o;break;case"right":r=l.x+a/2+o;break;default:r=l.x}switch(c){case"top":n=l.y-s/2-o;break;case"bottom":n=l.y+s/2+o;break;default:n=l.y}f.labelX=r,f.labelY=n,m.labelX=r,m.labelY=n,this.calculateLabelAngles(t),this.applyLabelDimensions(t)}};var Aj=function(e,r){var n=Math.atan(r/e);return e===0&&n<0&&(n=n*-1),n},Rj=function(e,r){var n=r.x-e.x,i=r.y-e.y;return Aj(n,i)},JL=function(e,r,n,i){var a=rg(0,i-.001,1),s=rg(0,i+.001,1),o=Yf(e,r,n,a),l=Yf(e,r,n,s);return Rj(o,l)};No.recalculateEdgeLabelProjections=function(t){var e,r=t._private,n=r.rscratch,i=this,a={mid:t.pstyle("label").strValue,source:t.pstyle("source-label").strValue,target:t.pstyle("target-label").strValue};if(a.mid||a.source||a.target){e={x:n.midX,y:n.midY};var s=function(f,m,g){ll(r.rscratch,f,m,g),ll(r.rstyle,f,m,g)};s("labelX",null,e.x),s("labelY",null,e.y);var o=Aj(n.midDispX,n.midDispY);s("labelAutoAngle",null,o);var l=function(){if(l.cache)return l.cache;for(var f=[],m=0;m+5<n.allpts.length;m+=4){var g={x:n.allpts[m],y:n.allpts[m+1]},y={x:n.allpts[m+2],y:n.allpts[m+3]},b={x:n.allpts[m+4],y:n.allpts[m+5]};f.push({p0:g,p1:y,p2:b,startDist:0,length:0,segments:[]})}var w=r.rstyle.bezierPts,N=i.bezierProjPcts.length;function k(A,I,D,L,U){var H=cd(I,D),M=A.segments[A.segments.length-1],z={p0:I,p1:D,t0:L,t1:U,startDist:M?M.startDist+M.length:0,length:H};A.segments.push(z),A.length+=H}for(var C=0;C<f.length;C++){var E=f[C],P=f[C-1];P&&(E.startDist=P.startDist+P.length),k(E,E.p0,w[C*N],0,i.bezierProjPcts[0]);for(var _=0;_<N-1;_++)k(E,w[C*N+_],w[C*N+_+1],i.bezierProjPcts[_],i.bezierProjPcts[_+1]);k(E,w[C*N+N-1],E.p2,i.bezierProjPcts[N-1],1)}return l.cache=f},u=function(f){var m,g=f==="source";if(a[f]){var y=t.pstyle(f+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var b=l(),w,N=0,k=0,C=0;C<b.length;C++){for(var E=b[g?C:b.length-1-C],P=0;P<E.segments.length;P++){var _=E.segments[g?P:E.segments.length-1-P],A=C===b.length-1&&P===E.segments.length-1;if(N=k,k+=_.length,k>=y||A){w={cp:E,segment:_};break}}if(w)break}var I=w.cp,D=w.segment,L=(y-N)/D.length,U=D.t1-D.t0,H=g?D.t0+U*L:D.t1-U*L;H=rg(0,H,1),e=Yf(I.p0,I.p1,I.p2,H),m=JL(I.p0,I.p1,I.p2,H);break}case"straight":case"segments":case"haystack":{for(var M=0,z,O,G,W,$=n.allpts.length,X=0;X+3<$&&(g?(G={x:n.allpts[X],y:n.allpts[X+1]},W={x:n.allpts[X+2],y:n.allpts[X+3]}):(G={x:n.allpts[$-2-X],y:n.allpts[$-1-X]},W={x:n.allpts[$-4-X],y:n.allpts[$-3-X]}),z=cd(G,W),O=M,M+=z,!(M>=y));X+=2);var Q=y-O,V=Q/z;V=rg(0,V,1),e=bO(G,W,V),m=Rj(G,W);break}}s("labelX",f,e.x),s("labelY",f,e.y),s("labelAutoAngle",f,m)}};u("source"),u("target"),this.applyLabelDimensions(t)}};No.applyLabelDimensions=function(t){this.applyPrefixedLabelDimensions(t),t.isEdge()&&(this.applyPrefixedLabelDimensions(t,"source"),this.applyPrefixedLabelDimensions(t,"target"))};No.applyPrefixedLabelDimensions=function(t,e){var r=t._private,n=this.getLabelText(t,e),i=ud(n,t._private.labelDimsKey);if(ya(r.rscratch,"prefixedLabelDimsKey",e)!==i){ll(r.rscratch,"prefixedLabelDimsKey",e,i);var a=this.calculateLabelDimensions(t,n),s=t.pstyle("line-height").pfValue,o=t.pstyle("text-wrap").strValue,l=ya(r.rscratch,"labelWrapCachedLines",e)||[],u=o!=="wrap"?1:Math.max(l.length,1),c=a.height/u,f=c*s,m=a.width,g=a.height+(u-1)*(s-1)*c;ll(r.rstyle,"labelWidth",e,m),ll(r.rscratch,"labelWidth",e,m),ll(r.rstyle,"labelHeight",e,g),ll(r.rscratch,"labelHeight",e,g),ll(r.rscratch,"labelLineHeight",e,f)}};No.getLabelText=function(t,e){var r=t._private,n=e?e+"-":"",i=t.pstyle(n+"label").strValue,a=t.pstyle("text-transform").value,s=function(Z,ie){return ie?(ll(r.rscratch,Z,e,ie),ie):ya(r.rscratch,Z,e)};if(!i)return"";a=="none"||(a=="uppercase"?i=i.toUpperCase():a=="lowercase"&&(i=i.toLowerCase()));var o=t.pstyle("text-wrap").value;if(o==="wrap"){var l=s("labelKey");if(l!=null&&s("labelWrapKey")===l)return s("labelWrapCachedText");for(var u="",c=i.split(`
`),f=t.pstyle("text-max-width").pfValue,m=t.pstyle("text-overflow-wrap").value,g=m==="anywhere",y=[],b=/[\s\u200b]+|$/g,w=0;w<c.length;w++){var N=c[w],k=this.calculateLabelDimensions(t,N),C=k.width;if(g){var E=N.split("").join(u);N=E}if(C>f){var P=N.matchAll(b),_="",A=0,I=wa(P),D;try{for(I.s();!(D=I.n()).done;){var L=D.value,U=L[0],H=N.substring(A,L.index);A=L.index+U.length;var M=_.length===0?H:_+H+U,z=this.calculateLabelDimensions(t,M),O=z.width;O<=f?_+=H+U:(_&&y.push(_),_=H+U)}}catch(Y){I.e(Y)}finally{I.f()}_.match(/^[\s\u200b]+$/)||y.push(_)}else y.push(N)}s("labelWrapCachedLines",y),i=s("labelWrapCachedText",y.join(`
`)),s("labelWrapKey",l)}else if(o==="ellipsis"){var G=t.pstyle("text-max-width").pfValue,W="",$="",X=!1;if(this.calculateLabelDimensions(t,i).width<G)return i;for(var Q=0;Q<i.length;Q++){var V=this.calculateLabelDimensions(t,W+i[Q]+$).width;if(V>G)break;W+=i[Q],Q===i.length-1&&(X=!0)}return X||(W+=$),W}return i};No.getLabelJustification=function(t){var e=t.pstyle("text-justification").strValue,r=t.pstyle("text-halign").strValue;if(e==="auto")if(t.isNode())switch(r){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};No.calculateLabelDimensions=function(t,e){var r=this,n=r.cy.window(),i=n.document,a=0,s=t.pstyle("font-style").strValue,o=t.pstyle("font-size").pfValue,l=t.pstyle("font-family").strValue,u=t.pstyle("font-weight").strValue,c=this.labelCalcCanvas,f=this.labelCalcCanvasContext;if(!c){c=this.labelCalcCanvas=i.createElement("canvas"),f=this.labelCalcCanvasContext=c.getContext("2d");var m=c.style;m.position="absolute",m.left="-9999px",m.top="-9999px",m.zIndex="-1",m.visibility="hidden",m.pointerEvents="none"}f.font="".concat(s," ").concat(u," ").concat(o,"px ").concat(l);for(var g=0,y=0,b=e.split(`
`),w=0;w<b.length;w++){var N=b[w],k=f.measureText(N),C=Math.ceil(k.width),E=o;g=Math.max(C,g),y+=E}return g+=a,y+=a,{width:g,height:y}};No.calculateLabelAngle=function(t,e){var r=t._private,n=r.rscratch,i=t.isEdge(),a=e?e+"-":"",s=t.pstyle(a+"text-rotation"),o=s.strValue;return o==="none"?0:i&&o==="autorotate"?n.labelAutoAngle:o==="autorotate"?0:s.pfValue};No.calculateLabelAngles=function(t){var e=this,r=t.isEdge(),n=t._private,i=n.rscratch;i.labelAngle=e.calculateLabelAngle(t),r&&(i.sourceLabelAngle=e.calculateLabelAngle(t,"source"),i.targetLabelAngle=e.calculateLabelAngle(t,"target"))};var Dj={},nE=28,iE=!1;Dj.getNodeShape=function(t){var e=this,r=t.pstyle("shape").value;if(r==="cutrectangle"&&(t.width()<nE||t.height()<nE))return iE||(lr("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),iE=!0),"rectangle";if(t.isParent())return r==="rectangle"||r==="roundrectangle"||r==="round-rectangle"||r==="cutrectangle"||r==="cut-rectangle"||r==="barrel"?r:"rectangle";if(r==="polygon"){var n=t.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(n).name}return r};var bx={};bx.registerCalculationListeners=function(){var t=this.cy,e=t.collection(),r=this,n=function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(s),o)for(var l=0;l<s.length;l++){var u=s[l],c=u._private,f=c.rstyle;f.clean=!1,f.cleanConnected=!1}};r.binder(t).on("bounds.* dirty.*",function(s){var o=s.target;n(o)}).on("style.* background.*",function(s){var o=s.target;n(o,!1)});var i=function(s){if(s){var o=r.onUpdateEleCalcsFns;e.cleanStyle();for(var l=0;l<e.length;l++){var u=e[l],c=u._private.rstyle;u.isNode()&&!c.cleanConnected&&(n(u.connectedEdges()),c.cleanConnected=!0)}if(o)for(var f=0;f<o.length;f++){var m=o[f];m(s,e)}r.recalculateRenderedStyle(e),e=t.collection()}};r.flushRenderedStyleQueue=function(){i(!0)},r.beforeRender(i,r.beforeRenderPriorities.eleCalcs)};bx.onUpdateEleCalcs=function(t){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(t)};bx.recalculateRenderedStyle=function(t,e){var r=function(E){return E._private.rstyle.cleanConnected};if(t.length!==0){var n=[],i=[];if(!this.destroyed){e===void 0&&(e=!0);for(var a=0;a<t.length;a++){var s=t[a],o=s._private,l=o.rstyle;s.isEdge()&&(!r(s.source())||!r(s.target()))&&(l.clean=!1),s.isEdge()&&s.isBundledBezier()&&s.parallelEdges().some(function(C){return!C._private.rstyle.clean&&C.isBundledBezier()})&&(l.clean=!1),!(e&&l.clean||s.removed())&&s.pstyle("display").value!=="none"&&(o.group==="nodes"?i.push(s):n.push(s),l.clean=!0)}for(var u=0;u<i.length;u++){var c=i[u],f=c._private,m=f.rstyle,g=c.position();this.recalculateNodeLabelProjection(c),m.nodeX=g.x,m.nodeY=g.y,m.nodeW=c.pstyle("width").pfValue,m.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var y=0;y<n.length;y++){var b=n[y],w=b._private,N=w.rstyle,k=w.rscratch;N.srcX=k.arrowStartX,N.srcY=k.arrowStartY,N.tgtX=k.arrowEndX,N.tgtY=k.arrowEndY,N.midX=k.midX,N.midY=k.midY,N.labelAngle=k.labelAngle,N.sourceLabelAngle=k.sourceLabelAngle,N.targetLabelAngle=k.targetLabelAngle}}}};var wx={};wx.updateCachedGrabbedEles=function(){var t=this.cachedZSortedEles;if(t){t.drag=[],t.nondrag=[];for(var e=[],r=0;r<t.length;r++){var n=t[r],i=n._private.rscratch;n.grabbed()&&!n.isParent()?e.push(n):i.inDragLayer?t.drag.push(n):t.nondrag.push(n)}for(var r=0;r<e.length;r++){var n=e[r];t.drag.push(n)}}};wx.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};wx.getCachedZSortedEles=function(t){if(t||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(mj),e.interactive=e.filter(function(r){return r.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var Oj={};[Sd,ay,Li,Dg,HS,No,Dj,bx,wx].forEach(function(t){Ct(Oj,t)});var Ij={};Ij.getCachedImage=function(t,e,r){var n=this,i=n.imageCache=n.imageCache||{},a=i[t];if(a)return a.image.complete||a.image.addEventListener("load",r),a.image;a=i[t]=i[t]||{};var s=a.image=new Image;s.addEventListener("load",r),s.addEventListener("error",function(){s.error=!0});var o="data:",l=t.substring(0,o.length).toLowerCase()===o;return l||(e=e==="null"?null:e,s.crossOrigin=e),s.src=t,s};var Ch={};Ch.registerBinding=function(t,e,r,n){var i=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(t)){for(var a=[],s=0;s<t.length;s++){var o=t[s];if(o!==void 0){var l=this.binder(o);a.push(l.on.apply(l,i))}}return a}var l=this.binder(t);return l.on.apply(l,i)};Ch.binder=function(t){var e=this,r=e.cy.window(),n=t===r||t===r.document||t===r.document.body||cD(t);if(e.supportsPassiveEvents==null){var i=!1;try{var a=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});r.addEventListener("test",null,a)}catch{}e.supportsPassiveEvents=i}var s=function(l,u,c){var f=Array.prototype.slice.call(arguments);return n&&e.supportsPassiveEvents&&(f[2]={capture:c??!1,passive:!1,once:!1}),e.bindings.push({target:t,args:f}),(t.addEventListener||t.on).apply(t,f),this};return{on:s,addEventListener:s,addListener:s,bind:s}};Ch.nodeIsDraggable=function(t){return t&&t.isNode()&&!t.locked()&&t.grabbable()};Ch.nodeIsGrabbable=function(t){return this.nodeIsDraggable(t)&&t.interactive()};Ch.load=function(){var t=this,e=t.cy.window(),r=function(re){return re.selected()},n=function(re){var ue=re.getRootNode();if(ue&&ue.nodeType===11&&ue.host!==void 0)return ue},i=function(re,ue,ge,be){re==null&&(re=t.cy);for(var Ce=0;Ce<ue.length;Ce++){var Le=ue[Ce];re.emit({originalEvent:ge,type:Le,position:be})}},a=function(re){return re.shiftKey||re.metaKey||re.ctrlKey},s=function(re,ue){var ge=!0;if(t.cy.hasCompoundNodes()&&re&&re.pannable())for(var be=0;ue&&be<ue.length;be++){var re=ue[be];if(re.isNode()&&re.isParent()&&!re.pannable()){ge=!1;break}}else ge=!0;return ge},o=function(re){re[0]._private.grabbed=!0},l=function(re){re[0]._private.grabbed=!1},u=function(re){re[0]._private.rscratch.inDragLayer=!0},c=function(re){re[0]._private.rscratch.inDragLayer=!1},f=function(re){re[0]._private.rscratch.isGrabTarget=!0},m=function(re){re[0]._private.rscratch.isGrabTarget=!1},g=function(re,ue){var ge=ue.addToList,be=ge.has(re);!be&&re.grabbable()&&!re.locked()&&(ge.merge(re),o(re))},y=function(re,ue){if(re.cy().hasCompoundNodes()&&!(ue.inDragLayer==null&&ue.addToList==null)){var ge=re.descendants();ue.inDragLayer&&(ge.forEach(u),ge.connectedEdges().forEach(u)),ue.addToList&&g(ge,ue)}},b=function(re,ue){ue=ue||{};var ge=re.cy().hasCompoundNodes();ue.inDragLayer&&(re.forEach(u),re.neighborhood().stdFilter(function(be){return!ge||be.isEdge()}).forEach(u)),ue.addToList&&re.forEach(function(be){g(be,ue)}),y(re,ue),k(re,{inDragLayer:ue.inDragLayer}),t.updateCachedGrabbedEles()},w=b,N=function(re){re&&(t.getCachedZSortedEles().forEach(function(ue){l(ue),c(ue),m(ue)}),t.updateCachedGrabbedEles())},k=function(re,ue){if(!(ue.inDragLayer==null&&ue.addToList==null)&&re.cy().hasCompoundNodes()){var ge=re.ancestors().orphans();if(!ge.same(re)){var be=ge.descendants().spawnSelf().merge(ge).unmerge(re).unmerge(re.descendants()),Ce=be.connectedEdges();ue.inDragLayer&&(Ce.forEach(u),be.forEach(u)),ue.addToList&&be.forEach(function(Le){g(Le,ue)})}}},C=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},E=typeof MutationObserver<"u",P=typeof ResizeObserver<"u";E?(t.removeObserver=new MutationObserver(function(De){for(var re=0;re<De.length;re++){var ue=De[re],ge=ue.removedNodes;if(ge)for(var be=0;be<ge.length;be++){var Ce=ge[be];if(Ce===t.container){t.destroy();break}}}}),t.container.parentNode&&t.removeObserver.observe(t.container.parentNode,{childList:!0})):t.registerBinding(t.container,"DOMNodeRemoved",function(De){t.destroy()});var _=Mg(function(){t.cy.resize()},100);E&&(t.styleObserver=new MutationObserver(_),t.styleObserver.observe(t.container,{attributes:!0})),t.registerBinding(e,"resize",_),P&&(t.resizeObserver=new ResizeObserver(_),t.resizeObserver.observe(t.container));var A=function(re,ue){for(;re!=null;)ue(re),re=re.parentNode},I=function(){t.invalidateContainerClientCoordsCache()};A(t.container,function(De){t.registerBinding(De,"transitionend",I),t.registerBinding(De,"animationend",I),t.registerBinding(De,"scroll",I)}),t.registerBinding(t.container,"contextmenu",function(De){De.preventDefault()});var D=function(){return t.selection[4]!==0},L=function(re){for(var ue=t.findContainerClientCoords(),ge=ue[0],be=ue[1],Ce=ue[2],Le=ue[3],Re=re.touches?re.touches:[re],Ze=!1,Je=0;Je<Re.length;Je++){var dt=Re[Je];if(ge<=dt.clientX&&dt.clientX<=ge+Ce&&be<=dt.clientY&&dt.clientY<=be+Le){Ze=!0;break}}if(!Ze)return!1;for(var Nt=t.container,Et=re.target,it=Et.parentNode,jt=!1;it;){if(it===Nt){jt=!0;break}it=it.parentNode}return!!jt};t.registerBinding(t.container,"mousedown",function(re){if(L(re)&&!(t.hoverData.which===1&&re.which!==1)){re.preventDefault(),C(),t.hoverData.capture=!0,t.hoverData.which=re.which;var ue=t.cy,ge=[re.clientX,re.clientY],be=t.projectIntoViewport(ge[0],ge[1]),Ce=t.selection,Le=t.findNearestElements(be[0],be[1],!0,!1),Re=Le[0],Ze=t.dragData.possibleDragElements;t.hoverData.mdownPos=be,t.hoverData.mdownGPos=ge;var Je=function(Pt){return{originalEvent:re,type:Pt,position:{x:be[0],y:be[1]}}},dt=function(){t.hoverData.tapholdCancelled=!1,clearTimeout(t.hoverData.tapholdTimeout),t.hoverData.tapholdTimeout=setTimeout(function(){if(!t.hoverData.tapholdCancelled){var Pt=t.hoverData.down;Pt?Pt.emit(Je("taphold")):ue.emit(Je("taphold"))}},t.tapholdDuration)};if(re.which==3){t.hoverData.cxtStarted=!0;var Nt={originalEvent:re,type:"cxttapstart",position:{x:be[0],y:be[1]}};Re?(Re.activate(),Re.emit(Nt),t.hoverData.down=Re):ue.emit(Nt),t.hoverData.downTime=new Date().getTime(),t.hoverData.cxtDragged=!1}else if(re.which==1){Re&&Re.activate();{if(Re!=null&&t.nodeIsGrabbable(Re)){var Et=function(Pt){Pt.emit(Je("grab"))};if(f(Re),!Re.selected())Ze=t.dragData.possibleDragElements=ue.collection(),w(Re,{addToList:Ze}),Re.emit(Je("grabon")).emit(Je("grab"));else{Ze=t.dragData.possibleDragElements=ue.collection();var it=ue.$(function(jt){return jt.isNode()&&jt.selected()&&t.nodeIsGrabbable(jt)});b(it,{addToList:Ze}),Re.emit(Je("grabon")),it.forEach(Et)}t.redrawHint("eles",!0),t.redrawHint("drag",!0)}t.hoverData.down=Re,t.hoverData.downs=Le,t.hoverData.downTime=new Date().getTime()}i(Re,["mousedown","tapstart","vmousedown"],re,{x:be[0],y:be[1]}),Re==null?(Ce[4]=1,t.data.bgActivePosistion={x:be[0],y:be[1]},t.redrawHint("select",!0),t.redraw()):Re.pannable()&&(Ce[4]=1),dt()}Ce[0]=Ce[2]=be[0],Ce[1]=Ce[3]=be[1]}},!1);var U=n(t.container);t.registerBinding([e,U],"mousemove",function(re){var ue=t.hoverData.capture;if(!(!ue&&!L(re))){var ge=!1,be=t.cy,Ce=be.zoom(),Le=[re.clientX,re.clientY],Re=t.projectIntoViewport(Le[0],Le[1]),Ze=t.hoverData.mdownPos,Je=t.hoverData.mdownGPos,dt=t.selection,Nt=null;!t.hoverData.draggingEles&&!t.hoverData.dragging&&!t.hoverData.selecting&&(Nt=t.findNearestElement(Re[0],Re[1],!0,!1));var Et=t.hoverData.last,it=t.hoverData.down,jt=[Re[0]-dt[2],Re[1]-dt[3]],Pt=t.dragData.possibleDragElements,ar;if(Je){var Xt=Le[0]-Je[0],$r=Xt*Xt,Er=Le[1]-Je[1],Tr=Er*Er,Fr=$r+Tr;t.hoverData.isOverThresholdDrag=ar=Fr>=t.desktopTapThreshold2}var xr=a(re);ar&&(t.hoverData.tapholdCancelled=!0);var Fi=function(){var li=t.hoverData.dragDelta=t.hoverData.dragDelta||[];li.length===0?(li.push(jt[0]),li.push(jt[1])):(li[0]+=jt[0],li[1]+=jt[1])};ge=!0,i(Nt,["mousemove","vmousemove","tapdrag"],re,{x:Re[0],y:Re[1]});var br=function(li){return{originalEvent:re,type:li,position:{x:Re[0],y:Re[1]}}},Gn=function(){t.data.bgActivePosistion=void 0,t.hoverData.selecting||be.emit(br("boxstart")),dt[4]=1,t.hoverData.selecting=!0,t.redrawHint("select",!0),t.redraw()};if(t.hoverData.which===3){if(ar){var Ta=br("cxtdrag");it?it.emit(Ta):be.emit(Ta),t.hoverData.cxtDragged=!0,(!t.hoverData.cxtOver||Nt!==t.hoverData.cxtOver)&&(t.hoverData.cxtOver&&t.hoverData.cxtOver.emit(br("cxtdragout")),t.hoverData.cxtOver=Nt,Nt&&Nt.emit(br("cxtdragover")))}}else if(t.hoverData.dragging){if(ge=!0,be.panningEnabled()&&be.userPanningEnabled()){var zs;if(t.hoverData.justStartedPan){var wl=t.hoverData.mdownPos;zs={x:(Re[0]-wl[0])*Ce,y:(Re[1]-wl[1])*Ce},t.hoverData.justStartedPan=!1}else zs={x:jt[0]*Ce,y:jt[1]*Ce};be.panBy(zs),be.emit(br("dragpan")),t.hoverData.dragged=!0}Re=t.projectIntoViewport(re.clientX,re.clientY)}else if(dt[4]==1&&(it==null||it.pannable())){if(ar){if(!t.hoverData.dragging&&be.boxSelectionEnabled()&&(xr||!be.panningEnabled()||!be.userPanningEnabled()))Gn();else if(!t.hoverData.selecting&&be.panningEnabled()&&be.userPanningEnabled()){var oi=s(it,t.hoverData.downs);oi&&(t.hoverData.dragging=!0,t.hoverData.justStartedPan=!0,dt[4]=0,t.data.bgActivePosistion=Hf(Ze),t.redrawHint("select",!0),t.redraw())}it&&it.pannable()&&it.active()&&it.unactivate()}}else{if(it&&it.pannable()&&it.active()&&it.unactivate(),(!it||!it.grabbed())&&Nt!=Et&&(Et&&i(Et,["mouseout","tapdragout"],re,{x:Re[0],y:Re[1]}),Nt&&i(Nt,["mouseover","tapdragover"],re,{x:Re[0],y:Re[1]}),t.hoverData.last=Nt),it)if(ar){if(be.boxSelectionEnabled()&&xr)it&&it.grabbed()&&(N(Pt),it.emit(br("freeon")),Pt.emit(br("free")),t.dragData.didDrag&&(it.emit(br("dragfreeon")),Pt.emit(br("dragfree")))),Gn();else if(it&&it.grabbed()&&t.nodeIsDraggable(it)){var An=!t.dragData.didDrag;An&&t.redrawHint("eles",!0),t.dragData.didDrag=!0,t.hoverData.draggingEles||b(Pt,{inDragLayer:!0});var cn={x:0,y:0};if(Qe(jt[0])&&Qe(jt[1])&&(cn.x+=jt[0],cn.y+=jt[1],An)){var Hn=t.hoverData.dragDelta;Hn&&Qe(Hn[0])&&Qe(Hn[1])&&(cn.x+=Hn[0],cn.y+=Hn[1])}t.hoverData.draggingEles=!0,Pt.silentShift(cn).emit(br("position")).emit(br("drag")),t.redrawHint("drag",!0),t.redraw()}}else Fi();ge=!0}if(dt[2]=Re[0],dt[3]=Re[1],ge)return re.stopPropagation&&re.stopPropagation(),re.preventDefault&&re.preventDefault(),!1}},!1);var H,M,z;t.registerBinding(e,"mouseup",function(re){if(!(t.hoverData.which===1&&re.which!==1&&t.hoverData.capture)){var ue=t.hoverData.capture;if(ue){t.hoverData.capture=!1;var ge=t.cy,be=t.projectIntoViewport(re.clientX,re.clientY),Ce=t.selection,Le=t.findNearestElement(be[0],be[1],!0,!1),Re=t.dragData.possibleDragElements,Ze=t.hoverData.down,Je=a(re);t.data.bgActivePosistion&&(t.redrawHint("select",!0),t.redraw()),t.hoverData.tapholdCancelled=!0,t.data.bgActivePosistion=void 0,Ze&&Ze.unactivate();var dt=function(Xt){return{originalEvent:re,type:Xt,position:{x:be[0],y:be[1]}}};if(t.hoverData.which===3){var Nt=dt("cxttapend");if(Ze?Ze.emit(Nt):ge.emit(Nt),!t.hoverData.cxtDragged){var Et=dt("cxttap");Ze?Ze.emit(Et):ge.emit(Et)}t.hoverData.cxtDragged=!1,t.hoverData.which=null}else if(t.hoverData.which===1){if(i(Le,["mouseup","tapend","vmouseup"],re,{x:be[0],y:be[1]}),!t.dragData.didDrag&&!t.hoverData.dragged&&!t.hoverData.selecting&&!t.hoverData.isOverThresholdDrag&&(i(Ze,["click","tap","vclick"],re,{x:be[0],y:be[1]}),M=!1,re.timeStamp-z<=ge.multiClickDebounceTime()?(H&&clearTimeout(H),M=!0,z=null,i(Ze,["dblclick","dbltap","vdblclick"],re,{x:be[0],y:be[1]})):(H=setTimeout(function(){M||i(Ze,["oneclick","onetap","voneclick"],re,{x:be[0],y:be[1]})},ge.multiClickDebounceTime()),z=re.timeStamp)),Ze==null&&!t.dragData.didDrag&&!t.hoverData.selecting&&!t.hoverData.dragged&&!a(re)&&(ge.$(r).unselect(["tapunselect"]),Re.length>0&&t.redrawHint("eles",!0),t.dragData.possibleDragElements=Re=ge.collection()),Le==Ze&&!t.dragData.didDrag&&!t.hoverData.selecting&&Le!=null&&Le._private.selectable&&(t.hoverData.dragging||(ge.selectionType()==="additive"||Je?Le.selected()?Le.unselect(["tapunselect"]):Le.select(["tapselect"]):Je||(ge.$(r).unmerge(Le).unselect(["tapunselect"]),Le.select(["tapselect"]))),t.redrawHint("eles",!0)),t.hoverData.selecting){var it=ge.collection(t.getAllInBox(Ce[0],Ce[1],Ce[2],Ce[3]));t.redrawHint("select",!0),it.length>0&&t.redrawHint("eles",!0),ge.emit(dt("boxend"));var jt=function(Xt){return Xt.selectable()&&!Xt.selected()};ge.selectionType()==="additive"||Je||ge.$(r).unmerge(it).unselect(),it.emit(dt("box")).stdFilter(jt).select().emit(dt("boxselect")),t.redraw()}if(t.hoverData.dragging&&(t.hoverData.dragging=!1,t.redrawHint("select",!0),t.redrawHint("eles",!0),t.redraw()),!Ce[4]){t.redrawHint("drag",!0),t.redrawHint("eles",!0);var Pt=Ze&&Ze.grabbed();N(Re),Pt&&(Ze.emit(dt("freeon")),Re.emit(dt("free")),t.dragData.didDrag&&(Ze.emit(dt("dragfreeon")),Re.emit(dt("dragfree"))))}}Ce[4]=0,t.hoverData.down=null,t.hoverData.cxtStarted=!1,t.hoverData.draggingEles=!1,t.hoverData.selecting=!1,t.hoverData.isOverThresholdDrag=!1,t.dragData.didDrag=!1,t.hoverData.dragged=!1,t.hoverData.dragDelta=[],t.hoverData.mdownPos=null,t.hoverData.mdownGPos=null,t.hoverData.which=null}}},!1);var O=[],G=4,W,$=1e5,X=function(re,ue){for(var ge=0;ge<re.length;ge++)if(re[ge]%ue!==0)return!1;return!0},Q=function(re){for(var ue=Math.abs(re[0]),ge=1;ge<re.length;ge++)if(Math.abs(re[ge])!==ue)return!1;return!0},V=function(re){var ue=!1,ge=re.deltaY;if(ge==null&&(re.wheelDeltaY!=null?ge=re.wheelDeltaY/4:re.wheelDelta!=null&&(ge=re.wheelDelta/4)),ge!==0){if(W==null)if(O.length>=G){var be=O;if(W=X(be,5),!W){var Ce=Math.abs(be[0]);W=Q(be)&&Ce>5}if(W)for(var Le=0;Le<be.length;Le++)$=Math.min(Math.abs(be[Le]),$)}else O.push(ge),ue=!0;else W&&($=Math.min(Math.abs(ge),$));if(!t.scrollingPage){var Re=t.cy,Ze=Re.zoom(),Je=Re.pan(),dt=t.projectIntoViewport(re.clientX,re.clientY),Nt=[dt[0]*Ze+Je.x,dt[1]*Ze+Je.y];if(t.hoverData.draggingEles||t.hoverData.dragging||t.hoverData.cxtStarted||D()){re.preventDefault();return}if(Re.panningEnabled()&&Re.userPanningEnabled()&&Re.zoomingEnabled()&&Re.userZoomingEnabled()){re.preventDefault(),t.data.wheelZooming=!0,clearTimeout(t.data.wheelTimeout),t.data.wheelTimeout=setTimeout(function(){t.data.wheelZooming=!1,t.redrawHint("eles",!0),t.redraw()},150);var Et;ue&&Math.abs(ge)>5&&(ge=MS(ge)*5),Et=ge/-250,W&&(Et/=$,Et*=3),Et=Et*t.wheelSensitivity;var it=re.deltaMode===1;it&&(Et*=33);var jt=Re.zoom()*Math.pow(10,Et);re.type==="gesturechange"&&(jt=t.gestureStartZoom*re.scale),Re.zoom({level:jt,renderedPosition:{x:Nt[0],y:Nt[1]}}),Re.emit({type:re.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:re,position:{x:dt[0],y:dt[1]}})}}}};t.registerBinding(t.container,"wheel",V,!0),t.registerBinding(e,"scroll",function(re){t.scrollingPage=!0,clearTimeout(t.scrollingPageTimeout),t.scrollingPageTimeout=setTimeout(function(){t.scrollingPage=!1},250)},!0),t.registerBinding(t.container,"gesturestart",function(re){t.gestureStartZoom=t.cy.zoom(),t.hasTouchStarted||re.preventDefault()},!0),t.registerBinding(t.container,"gesturechange",function(De){t.hasTouchStarted||V(De)},!0),t.registerBinding(t.container,"mouseout",function(re){var ue=t.projectIntoViewport(re.clientX,re.clientY);t.cy.emit({originalEvent:re,type:"mouseout",position:{x:ue[0],y:ue[1]}})},!1),t.registerBinding(t.container,"mouseover",function(re){var ue=t.projectIntoViewport(re.clientX,re.clientY);t.cy.emit({originalEvent:re,type:"mouseover",position:{x:ue[0],y:ue[1]}})},!1);var Y,Z,ie,ce,he,ee,le,te,ae,oe,fe,pe,Te,Oe=function(re,ue,ge,be){return Math.sqrt((ge-re)*(ge-re)+(be-ue)*(be-ue))},_e=function(re,ue,ge,be){return(ge-re)*(ge-re)+(be-ue)*(be-ue)},Ae;t.registerBinding(t.container,"touchstart",Ae=function(re){if(t.hasTouchStarted=!0,!!L(re)){C(),t.touchData.capture=!0,t.data.bgActivePosistion=void 0;var ue=t.cy,ge=t.touchData.now,be=t.touchData.earlier;if(re.touches[0]){var Ce=t.projectIntoViewport(re.touches[0].clientX,re.touches[0].clientY);ge[0]=Ce[0],ge[1]=Ce[1]}if(re.touches[1]){var Ce=t.projectIntoViewport(re.touches[1].clientX,re.touches[1].clientY);ge[2]=Ce[0],ge[3]=Ce[1]}if(re.touches[2]){var Ce=t.projectIntoViewport(re.touches[2].clientX,re.touches[2].clientY);ge[4]=Ce[0],ge[5]=Ce[1]}var Le=function(xr){return{originalEvent:re,type:xr,position:{x:ge[0],y:ge[1]}}};if(re.touches[1]){t.touchData.singleTouchMoved=!0,N(t.dragData.touchDragEles);var Re=t.findContainerClientCoords();ae=Re[0],oe=Re[1],fe=Re[2],pe=Re[3],Y=re.touches[0].clientX-ae,Z=re.touches[0].clientY-oe,ie=re.touches[1].clientX-ae,ce=re.touches[1].clientY-oe,Te=0<=Y&&Y<=fe&&0<=ie&&ie<=fe&&0<=Z&&Z<=pe&&0<=ce&&ce<=pe;var Ze=ue.pan(),Je=ue.zoom();he=Oe(Y,Z,ie,ce),ee=_e(Y,Z,ie,ce),le=[(Y+ie)/2,(Z+ce)/2],te=[(le[0]-Ze.x)/Je,(le[1]-Ze.y)/Je];var dt=200,Nt=dt*dt;if(ee<Nt&&!re.touches[2]){var Et=t.findNearestElement(ge[0],ge[1],!0,!0),it=t.findNearestElement(ge[2],ge[3],!0,!0);Et&&Et.isNode()?(Et.activate().emit(Le("cxttapstart")),t.touchData.start=Et):it&&it.isNode()?(it.activate().emit(Le("cxttapstart")),t.touchData.start=it):ue.emit(Le("cxttapstart")),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!0,t.touchData.cxtDragged=!1,t.data.bgActivePosistion=void 0,t.redraw();return}}if(re.touches[2])ue.boxSelectionEnabled()&&re.preventDefault();else if(!re.touches[1]){if(re.touches[0]){var jt=t.findNearestElements(ge[0],ge[1],!0,!0),Pt=jt[0];if(Pt!=null&&(Pt.activate(),t.touchData.start=Pt,t.touchData.starts=jt,t.nodeIsGrabbable(Pt))){var ar=t.dragData.touchDragEles=ue.collection(),Xt=null;t.redrawHint("eles",!0),t.redrawHint("drag",!0),Pt.selected()?(Xt=ue.$(function(Fr){return Fr.selected()&&t.nodeIsGrabbable(Fr)}),b(Xt,{addToList:ar})):w(Pt,{addToList:ar}),f(Pt),Pt.emit(Le("grabon")),Xt?Xt.forEach(function(Fr){Fr.emit(Le("grab"))}):Pt.emit(Le("grab"))}i(Pt,["touchstart","tapstart","vmousedown"],re,{x:ge[0],y:ge[1]}),Pt==null&&(t.data.bgActivePosistion={x:Ce[0],y:Ce[1]},t.redrawHint("select",!0),t.redraw()),t.touchData.singleTouchMoved=!1,t.touchData.singleTouchStartTime=+new Date,clearTimeout(t.touchData.tapholdTimeout),t.touchData.tapholdTimeout=setTimeout(function(){t.touchData.singleTouchMoved===!1&&!t.pinching&&!t.touchData.selecting&&i(t.touchData.start,["taphold"],re,{x:ge[0],y:ge[1]})},t.tapholdDuration)}}if(re.touches.length>=1){for(var $r=t.touchData.startPosition=[null,null,null,null,null,null],Er=0;Er<ge.length;Er++)$r[Er]=be[Er]=ge[Er];var Tr=re.touches[0];t.touchData.startGPosition=[Tr.clientX,Tr.clientY]}}},!1);var He;t.registerBinding(e,"touchmove",He=function(re){var ue=t.touchData.capture;if(!(!ue&&!L(re))){var ge=t.selection,be=t.cy,Ce=t.touchData.now,Le=t.touchData.earlier,Re=be.zoom();if(re.touches[0]){var Ze=t.projectIntoViewport(re.touches[0].clientX,re.touches[0].clientY);Ce[0]=Ze[0],Ce[1]=Ze[1]}if(re.touches[1]){var Ze=t.projectIntoViewport(re.touches[1].clientX,re.touches[1].clientY);Ce[2]=Ze[0],Ce[3]=Ze[1]}if(re.touches[2]){var Ze=t.projectIntoViewport(re.touches[2].clientX,re.touches[2].clientY);Ce[4]=Ze[0],Ce[5]=Ze[1]}var Je=function(ys){return{originalEvent:re,type:ys,position:{x:Ce[0],y:Ce[1]}}},dt=t.touchData.startGPosition,Nt;if(ue&&re.touches[0]&&dt){for(var Et=[],it=0;it<Ce.length;it++)Et[it]=Ce[it]-Le[it];var jt=re.touches[0].clientX-dt[0],Pt=jt*jt,ar=re.touches[0].clientY-dt[1],Xt=ar*ar,$r=Pt+Xt;Nt=$r>=t.touchTapThreshold2}if(ue&&t.touchData.cxt){re.preventDefault();var Er=re.touches[0].clientX-ae,Tr=re.touches[0].clientY-oe,Fr=re.touches[1].clientX-ae,xr=re.touches[1].clientY-oe,Fi=_e(Er,Tr,Fr,xr),br=Fi/ee,Gn=150,Ta=Gn*Gn,zs=1.5,wl=zs*zs;if(br>=wl||Fi>=Ta){t.touchData.cxt=!1,t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var oi=Je("cxttapend");t.touchData.start?(t.touchData.start.unactivate().emit(oi),t.touchData.start=null):be.emit(oi)}}if(ue&&t.touchData.cxt){var oi=Je("cxtdrag");t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.touchData.start?t.touchData.start.emit(oi):be.emit(oi),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxtDragged=!0;var An=t.findNearestElement(Ce[0],Ce[1],!0,!0);(!t.touchData.cxtOver||An!==t.touchData.cxtOver)&&(t.touchData.cxtOver&&t.touchData.cxtOver.emit(Je("cxtdragout")),t.touchData.cxtOver=An,An&&An.emit(Je("cxtdragover")))}else if(ue&&re.touches[2]&&be.boxSelectionEnabled())re.preventDefault(),t.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,t.touchData.selecting||be.emit(Je("boxstart")),t.touchData.selecting=!0,t.touchData.didSelect=!0,ge[4]=1,!ge||ge.length===0||ge[0]===void 0?(ge[0]=(Ce[0]+Ce[2]+Ce[4])/3,ge[1]=(Ce[1]+Ce[3]+Ce[5])/3,ge[2]=(Ce[0]+Ce[2]+Ce[4])/3+1,ge[3]=(Ce[1]+Ce[3]+Ce[5])/3+1):(ge[2]=(Ce[0]+Ce[2]+Ce[4])/3,ge[3]=(Ce[1]+Ce[3]+Ce[5])/3),t.redrawHint("select",!0),t.redraw();else if(ue&&re.touches[1]&&!t.touchData.didSelect&&be.zoomingEnabled()&&be.panningEnabled()&&be.userZoomingEnabled()&&be.userPanningEnabled()){re.preventDefault(),t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var cn=t.dragData.touchDragEles;if(cn){t.redrawHint("drag",!0);for(var Hn=0;Hn<cn.length;Hn++){var Vs=cn[Hn]._private;Vs.grabbed=!1,Vs.rscratch.inDragLayer=!1}}var li=t.touchData.start,Er=re.touches[0].clientX-ae,Tr=re.touches[0].clientY-oe,Fr=re.touches[1].clientX-ae,xr=re.touches[1].clientY-oe,ic=Oe(Er,Tr,Fr,xr),Td=ic/he;if(Te){var Th=Er-Y,jh=Tr-Z,Dr=Fr-ie,ac=xr-ce,gs=(Th+Dr)/2,Sl=(jh+ac)/2,ia=be.zoom(),sc=ia*Td,vs=be.pan(),aa=te[0]*ia+vs.x,Jr=te[1]*ia+vs.y,ur={x:-sc/ia*(aa-vs.x-gs)+aa,y:-sc/ia*(Jr-vs.y-Sl)+Jr};if(li&&li.active()){var cn=t.dragData.touchDragEles;N(cn),t.redrawHint("drag",!0),t.redrawHint("eles",!0),li.unactivate().emit(Je("freeon")),cn.emit(Je("free")),t.dragData.didDrag&&(li.emit(Je("dragfreeon")),cn.emit(Je("dragfree")))}be.viewport({zoom:sc,pan:ur,cancelOnFailedZoom:!0}),be.emit(Je("pinchzoom")),he=ic,Y=Er,Z=Tr,ie=Fr,ce=xr,t.pinching=!0}if(re.touches[0]){var Ze=t.projectIntoViewport(re.touches[0].clientX,re.touches[0].clientY);Ce[0]=Ze[0],Ce[1]=Ze[1]}if(re.touches[1]){var Ze=t.projectIntoViewport(re.touches[1].clientX,re.touches[1].clientY);Ce[2]=Ze[0],Ce[3]=Ze[1]}if(re.touches[2]){var Ze=t.projectIntoViewport(re.touches[2].clientX,re.touches[2].clientY);Ce[4]=Ze[0],Ce[5]=Ze[1]}}else if(re.touches[0]&&!t.touchData.didSelect){var Tt=t.touchData.start,sa=t.touchData.last,An;if(!t.hoverData.draggingEles&&!t.swipePanning&&(An=t.findNearestElement(Ce[0],Ce[1],!0,!0)),ue&&Tt!=null&&re.preventDefault(),ue&&Tt!=null&&t.nodeIsDraggable(Tt))if(Nt){var cn=t.dragData.touchDragEles,dn=!t.dragData.didDrag;dn&&b(cn,{inDragLayer:!0}),t.dragData.didDrag=!0;var Zr={x:0,y:0};if(Qe(Et[0])&&Qe(Et[1])&&(Zr.x+=Et[0],Zr.y+=Et[1],dn)){t.redrawHint("eles",!0);var zr=t.touchData.dragDelta;zr&&Qe(zr[0])&&Qe(zr[1])&&(Zr.x+=zr[0],Zr.y+=zr[1])}t.hoverData.draggingEles=!0,cn.silentShift(Zr).emit(Je("position")).emit(Je("drag")),t.redrawHint("drag",!0),t.touchData.startPosition[0]==Le[0]&&t.touchData.startPosition[1]==Le[1]&&t.redrawHint("eles",!0),t.redraw()}else{var zr=t.touchData.dragDelta=t.touchData.dragDelta||[];zr.length===0?(zr.push(Et[0]),zr.push(Et[1])):(zr[0]+=Et[0],zr[1]+=Et[1])}if(i(Tt||An,["touchmove","tapdrag","vmousemove"],re,{x:Ce[0],y:Ce[1]}),(!Tt||!Tt.grabbed())&&An!=sa&&(sa&&sa.emit(Je("tapdragout")),An&&An.emit(Je("tapdragover"))),t.touchData.last=An,ue)for(var Hn=0;Hn<Ce.length;Hn++)Ce[Hn]&&t.touchData.startPosition[Hn]&&Nt&&(t.touchData.singleTouchMoved=!0);if(ue&&(Tt==null||Tt.pannable())&&be.panningEnabled()&&be.userPanningEnabled()){var ja=s(Tt,t.touchData.starts);ja&&(re.preventDefault(),t.data.bgActivePosistion||(t.data.bgActivePosistion=Hf(t.touchData.startPosition)),t.swipePanning?(be.panBy({x:Et[0]*Re,y:Et[1]*Re}),be.emit(Je("dragpan"))):Nt&&(t.swipePanning=!0,be.panBy({x:jt*Re,y:ar*Re}),be.emit(Je("dragpan")),Tt&&(Tt.unactivate(),t.redrawHint("select",!0),t.touchData.start=null)));var Ze=t.projectIntoViewport(re.touches[0].clientX,re.touches[0].clientY);Ce[0]=Ze[0],Ce[1]=Ze[1]}}for(var it=0;it<Ce.length;it++)Le[it]=Ce[it];ue&&re.touches.length>0&&!t.hoverData.draggingEles&&!t.swipePanning&&t.data.bgActivePosistion!=null&&(t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.redraw())}},!1);var tt;t.registerBinding(e,"touchcancel",tt=function(re){var ue=t.touchData.start;t.touchData.capture=!1,ue&&ue.unactivate()});var Ie,ye,Pe,Be;if(t.registerBinding(e,"touchend",Ie=function(re){var ue=t.touchData.start,ge=t.touchData.capture;if(ge)re.touches.length===0&&(t.touchData.capture=!1),re.preventDefault();else return;var be=t.selection;t.swipePanning=!1,t.hoverData.draggingEles=!1;var Ce=t.cy,Le=Ce.zoom(),Re=t.touchData.now,Ze=t.touchData.earlier;if(re.touches[0]){var Je=t.projectIntoViewport(re.touches[0].clientX,re.touches[0].clientY);Re[0]=Je[0],Re[1]=Je[1]}if(re.touches[1]){var Je=t.projectIntoViewport(re.touches[1].clientX,re.touches[1].clientY);Re[2]=Je[0],Re[3]=Je[1]}if(re.touches[2]){var Je=t.projectIntoViewport(re.touches[2].clientX,re.touches[2].clientY);Re[4]=Je[0],Re[5]=Je[1]}var dt=function(Ta){return{originalEvent:re,type:Ta,position:{x:Re[0],y:Re[1]}}};ue&&ue.unactivate();var Nt;if(t.touchData.cxt){if(Nt=dt("cxttapend"),ue?ue.emit(Nt):Ce.emit(Nt),!t.touchData.cxtDragged){var Et=dt("cxttap");ue?ue.emit(Et):Ce.emit(Et)}t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!1,t.touchData.start=null,t.redraw();return}if(!re.touches[2]&&Ce.boxSelectionEnabled()&&t.touchData.selecting){t.touchData.selecting=!1;var it=Ce.collection(t.getAllInBox(be[0],be[1],be[2],be[3]));be[0]=void 0,be[1]=void 0,be[2]=void 0,be[3]=void 0,be[4]=0,t.redrawHint("select",!0),Ce.emit(dt("boxend"));var jt=function(Ta){return Ta.selectable()&&!Ta.selected()};it.emit(dt("box")).stdFilter(jt).select().emit(dt("boxselect")),it.nonempty()&&t.redrawHint("eles",!0),t.redraw()}if(ue?.unactivate(),re.touches[2])t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);else if(!re.touches[1]){if(!re.touches[0]){if(!re.touches[0]){t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var Pt=t.dragData.touchDragEles;if(ue!=null){var ar=ue._private.grabbed;N(Pt),t.redrawHint("drag",!0),t.redrawHint("eles",!0),ar&&(ue.emit(dt("freeon")),Pt.emit(dt("free")),t.dragData.didDrag&&(ue.emit(dt("dragfreeon")),Pt.emit(dt("dragfree")))),i(ue,["touchend","tapend","vmouseup","tapdragout"],re,{x:Re[0],y:Re[1]}),ue.unactivate(),t.touchData.start=null}else{var Xt=t.findNearestElement(Re[0],Re[1],!0,!0);i(Xt,["touchend","tapend","vmouseup","tapdragout"],re,{x:Re[0],y:Re[1]})}var $r=t.touchData.startPosition[0]-Re[0],Er=$r*$r,Tr=t.touchData.startPosition[1]-Re[1],Fr=Tr*Tr,xr=Er+Fr,Fi=xr*Le*Le;t.touchData.singleTouchMoved||(ue||Ce.$(":selected").unselect(["tapunselect"]),i(ue,["tap","vclick"],re,{x:Re[0],y:Re[1]}),ye=!1,re.timeStamp-Be<=Ce.multiClickDebounceTime()?(Pe&&clearTimeout(Pe),ye=!0,Be=null,i(ue,["dbltap","vdblclick"],re,{x:Re[0],y:Re[1]})):(Pe=setTimeout(function(){ye||i(ue,["onetap","voneclick"],re,{x:Re[0],y:Re[1]})},Ce.multiClickDebounceTime()),Be=re.timeStamp)),ue!=null&&!t.dragData.didDrag&&ue._private.selectable&&Fi<t.touchTapThreshold2&&!t.pinching&&(Ce.selectionType()==="single"?(Ce.$(r).unmerge(ue).unselect(["tapunselect"]),ue.select(["tapselect"])):ue.selected()?ue.unselect(["tapunselect"]):ue.select(["tapselect"]),t.redrawHint("eles",!0)),t.touchData.singleTouchMoved=!0}}}for(var br=0;br<Re.length;br++)Ze[br]=Re[br];t.dragData.didDrag=!1,re.touches.length===0&&(t.touchData.dragDelta=[],t.touchData.startPosition=[null,null,null,null,null,null],t.touchData.startGPosition=null,t.touchData.didSelect=!1),re.touches.length<2&&(re.touches.length===1&&(t.touchData.startGPosition=[re.touches[0].clientX,re.touches[0].clientY]),t.pinching=!1,t.redrawHint("eles",!0),t.redraw())},!1),typeof TouchEvent>"u"){var Ge=[],et=function(re){return{clientX:re.clientX,clientY:re.clientY,force:1,identifier:re.pointerId,pageX:re.pageX,pageY:re.pageY,radiusX:re.width/2,radiusY:re.height/2,screenX:re.screenX,screenY:re.screenY,target:re.target}},mt=function(re){return{event:re,touch:et(re)}},gt=function(re){Ge.push(mt(re))},bt=function(re){for(var ue=0;ue<Ge.length;ue++){var ge=Ge[ue];if(ge.event.pointerId===re.pointerId){Ge.splice(ue,1);return}}},_t=function(re){var ue=Ge.filter(function(ge){return ge.event.pointerId===re.pointerId})[0];ue.event=re,ue.touch=et(re)},ot=function(re){re.touches=Ge.map(function(ue){return ue.touch})},Ye=function(re){return re.pointerType==="mouse"||re.pointerType===4};t.registerBinding(t.container,"pointerdown",function(De){Ye(De)||(De.preventDefault(),gt(De),ot(De),Ae(De))}),t.registerBinding(t.container,"pointerup",function(De){Ye(De)||(bt(De),ot(De),Ie(De))}),t.registerBinding(t.container,"pointercancel",function(De){Ye(De)||(bt(De),ot(De),tt(De))}),t.registerBinding(t.container,"pointermove",function(De){Ye(De)||(De.preventDefault(),_t(De),ot(De),He(De))})}};var yl={};yl.generatePolygon=function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,draw:function(n,i,a,s,o,l){this.renderer.nodeShapeImpl("polygon",n,i,a,s,o,this.points)},intersectLine:function(n,i,a,s,o,l,u,c){return ng(o,l,this.points,n,i,a/2,s/2,u)},checkPoint:function(n,i,a,s,o,l,u,c){return ml(n,i,this.points,l,u,s,o,[0,-1],a)},hasMiterBounds:t!=="rectangle",miterBounds:function(n,i,a,s,o,l){return EO(this.points,n,i,a,s,o)}}};yl.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a)},intersectLine:function(e,r,n,i,a,s,o,l){return DO(a,s,e,r,n/2+o,i/2+o)},checkPoint:function(e,r,n,i,a,s,o,l){return Yc(e,r,i,a,s,o,n)}}};yl.generateRoundPolygon=function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,getOrCreateCorners:function(n,i,a,s,o,l,u){if(l[u]!==void 0&&l[u+"-cx"]===n&&l[u+"-cy"]===i)return l[u];l[u]=new Array(e.length/2),l[u+"-cx"]=n,l[u+"-cy"]=i;var c=a/2,f=s/2;o=o==="auto"?L6(a,s):o;for(var m=new Array(e.length/2),g=0;g<e.length/2;g++)m[g]={x:n+c*e[g*2],y:i+f*e[g*2+1]};var y,b,w,N,k=m.length;for(b=m[k-1],y=0;y<k;y++)w=m[y%k],N=m[(y+1)%k],l[u][y]=GS(b,w,N,o),b=w,w=N;return l[u]},draw:function(n,i,a,s,o,l,u){this.renderer.nodeShapeImpl("round-polygon",n,i,a,s,o,this.points,this.getOrCreateCorners(i,a,s,o,l,u,"drawCorners"))},intersectLine:function(n,i,a,s,o,l,u,c,f){return IO(o,l,this.points,n,i,a,s,u,this.getOrCreateCorners(n,i,a,s,c,f,"corners"))},checkPoint:function(n,i,a,s,o,l,u,c,f){return RO(n,i,this.points,l,u,s,o,this.getOrCreateCorners(l,u,s,o,c,f,"corners"))}}};yl.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Zi(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,this.points,s)},intersectLine:function(e,r,n,i,a,s,o,l){return O6(a,s,e,r,n,i,o,l)},checkPoint:function(e,r,n,i,a,s,o,l){var u=i/2,c=a/2;l=l==="auto"?zu(i,a):l,l=Math.min(u,c,l);var f=l*2;return!!(ml(e,r,this.points,s,o,i,a-f,[0,-1],n)||ml(e,r,this.points,s,o,i-f,a,[0,-1],n)||Yc(e,r,f,f,s-u+l,o-c+l,n)||Yc(e,r,f,f,s+u-l,o-c+l,n)||Yc(e,r,f,f,s+u-l,o+c-l,n)||Yc(e,r,f,f,s-u+l,o+c-l,n))}}};yl.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:AS(),points:Zi(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,null,s)},generateCutTrianglePts:function(e,r,n,i,a){var s=a==="auto"?this.cornerLength:a,o=r/2,l=e/2,u=n-l,c=n+l,f=i-o,m=i+o;return{topLeft:[u,f+s,u+s,f,u+s,f+s],topRight:[c-s,f,c,f+s,c-s,f+s],bottomRight:[c,m-s,c-s,m,c-s,m-s],bottomLeft:[u+s,m,u,m-s,u+s,m-s]}},intersectLine:function(e,r,n,i,a,s,o,l){var u=this.generateCutTrianglePts(n+2*o,i+2*o,e,r,l),c=[].concat.apply([],[u.topLeft.splice(0,4),u.topRight.splice(0,4),u.bottomRight.splice(0,4),u.bottomLeft.splice(0,4)]);return ng(a,s,c,e,r)},checkPoint:function(e,r,n,i,a,s,o,l){var u=l==="auto"?this.cornerLength:l;if(ml(e,r,this.points,s,o,i,a-2*u,[0,-1],n)||ml(e,r,this.points,s,o,i-2*u,a,[0,-1],n))return!0;var c=this.generateCutTrianglePts(i,a,s,o);return xa(e,r,c.topLeft)||xa(e,r,c.topRight)||xa(e,r,c.bottomRight)||xa(e,r,c.bottomLeft)}}};yl.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Zi(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a)},intersectLine:function(e,r,n,i,a,s,o,l){var u=.15,c=.5,f=.85,m=this.generateBarrelBezierPts(n+2*o,i+2*o,e,r),g=function(w){var N=Yf({x:w[0],y:w[1]},{x:w[2],y:w[3]},{x:w[4],y:w[5]},u),k=Yf({x:w[0],y:w[1]},{x:w[2],y:w[3]},{x:w[4],y:w[5]},c),C=Yf({x:w[0],y:w[1]},{x:w[2],y:w[3]},{x:w[4],y:w[5]},f);return[w[0],w[1],N.x,N.y,k.x,k.y,C.x,C.y,w[4],w[5]]},y=[].concat(g(m.topLeft),g(m.topRight),g(m.bottomRight),g(m.bottomLeft));return ng(a,s,y,e,r)},generateBarrelBezierPts:function(e,r,n,i){var a=r/2,s=e/2,o=n-s,l=n+s,u=i-a,c=i+a,f=p2(e,r),m=f.heightOffset,g=f.widthOffset,y=f.ctrlPtOffsetPct*e,b={topLeft:[o,u+m,o+y,u,o+g,u],topRight:[l-g,u,l-y,u,l,u+m],bottomRight:[l,c-m,l-y,c,l-g,c],bottomLeft:[o+g,c,o+y,c,o,c-m]};return b.topLeft.isTop=!0,b.topRight.isTop=!0,b.bottomLeft.isBottom=!0,b.bottomRight.isBottom=!0,b},checkPoint:function(e,r,n,i,a,s,o,l){var u=p2(i,a),c=u.heightOffset,f=u.widthOffset;if(ml(e,r,this.points,s,o,i,a-2*c,[0,-1],n)||ml(e,r,this.points,s,o,i-2*f,a,[0,-1],n))return!0;for(var m=this.generateBarrelBezierPts(i,a,s,o),g=function(I,D,L){var U=L[4],H=L[2],M=L[0],z=L[5],O=L[1],G=Math.min(U,M),W=Math.max(U,M),$=Math.min(z,O),X=Math.max(z,O);if(G<=I&&I<=W&&$<=D&&D<=X){var Q=LO(U,H,M),V=PO(Q[0],Q[1],Q[2],I),Y=V.filter(function(Z){return 0<=Z&&Z<=1});if(Y.length>0)return Y[0]}return null},y=Object.keys(m),b=0;b<y.length;b++){var w=y[b],N=m[w],k=g(e,r,N);if(k!=null){var C=N[5],E=N[3],P=N[1],_=Zn(C,E,P,k);if(N.isTop&&_<=r||N.isBottom&&r<=_)return!0}}return!1}}};yl.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Zi(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,this.points,s)},intersectLine:function(e,r,n,i,a,s,o,l){var u=e-(n/2+o),c=r-(i/2+o),f=c,m=e+(n/2+o),g=Tu(a,s,e,r,u,c,m,f,!1);return g.length>0?g:O6(a,s,e,r,n,i,o,l)},checkPoint:function(e,r,n,i,a,s,o,l){l=l==="auto"?zu(i,a):l;var u=2*l;if(ml(e,r,this.points,s,o,i,a-u,[0,-1],n)||ml(e,r,this.points,s,o,i-u,a,[0,-1],n))return!0;var c=i/2+2*n,f=a/2+2*n,m=[s-c,o-f,s-c,o,s+c,o,s+c,o-f];return!!(xa(e,r,m)||Yc(e,r,u,u,s+i/2-l,o+a/2-l,n)||Yc(e,r,u,u,s-i/2+l,o+a/2-l,n))}}};yl.registerNodeShapes=function(){var t=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",Zi(3,0)),this.generateRoundPolygon("round-triangle",Zi(3,0)),this.generatePolygon("rectangle",Zi(4,0)),t.square=t.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var r=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",r),this.generateRoundPolygon("round-diamond",r)}this.generatePolygon("pentagon",Zi(5,0)),this.generateRoundPolygon("round-pentagon",Zi(5,0)),this.generatePolygon("hexagon",Zi(6,0)),this.generateRoundPolygon("round-hexagon",Zi(6,0)),this.generatePolygon("heptagon",Zi(7,0)),this.generateRoundPolygon("round-heptagon",Zi(7,0)),this.generatePolygon("octagon",Zi(8,0)),this.generateRoundPolygon("round-octagon",Zi(8,0));var n=new Array(20);{var i=h2(5,0),a=h2(5,Math.PI/5),s=.5*(3-Math.sqrt(5));s*=1.57;for(var o=0;o<a.length/2;o++)a[o*2]*=s,a[o*2+1]*=s;for(var o=0;o<20/4;o++)n[o*4]=i[o*2],n[o*4+1]=i[o*2+1],n[o*4+2]=a[o*2],n[o*4+3]=a[o*2+1]}n=I6(n),this.generatePolygon("star",n),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}t.makePolygon=function(u){var c=u.join("$"),f="polygon-"+c,m;return(m=this[f])?m:e.generatePolygon(f,u)}};var Og={};Og.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};Og.redraw=function(t){t=t||_6();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=t};Og.beforeRender=function(t,e){if(!this.destroyed){e==null&&Hr("Priority is not optional for beforeRender");var r=this.beforeRenderCallbacks;r.push({fn:t,priority:e}),r.sort(function(n,i){return i.priority-n.priority})}};var aE=function(e,r,n){for(var i=e.beforeRenderCallbacks,a=0;a<i.length;a++)i[a].fn(r,n)};Og.startRenderLoop=function(){var t=this,e=t.cy;if(!t.renderLoopStarted){t.renderLoopStarted=!0;var r=function(i){if(!t.destroyed){if(!e.batching())if(t.requestedFrame&&!t.skipFrame){aE(t,!0,i);var a=pl();t.render(t.renderOptions);var s=t.lastDrawTime=pl();t.averageRedrawTime===void 0&&(t.averageRedrawTime=s-a),t.redrawCount===void 0&&(t.redrawCount=0),t.redrawCount++,t.redrawTotalTime===void 0&&(t.redrawTotalTime=0);var o=s-a;t.redrawTotalTime+=o,t.lastRedrawTime=o,t.averageRedrawTime=t.averageRedrawTime/2+o/2,t.requestedFrame=!1}else aE(t,!1,i);t.skipFrame=!1,Q0(r)}};Q0(r)}};var ZL=function(e){this.init(e)},Lj=ZL,Nh=Lj.prototype;Nh.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];Nh.init=function(t){var e=this;e.options=t,e.cy=t.cy;var r=e.container=t.cy.container(),n=e.cy.window();if(n){var i=n.document,a=i.head,s="__________cytoscape_stylesheet",o="__________cytoscape_container",l=i.getElementById(s)!=null;if(r.className.indexOf(o)<0&&(r.className=(r.className||"")+" "+o),!l){var u=i.createElement("style");u.id=s,u.textContent="."+o+" { position: relative; }",a.insertBefore(u,a.children[0])}var c=n.getComputedStyle(r),f=c.getPropertyValue("position");f==="static"&&lr("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=t.showFps,e.debug=t.debug,e.webgl=t.webgl,e.hideEdgesOnViewport=t.hideEdgesOnViewport,e.textureOnViewport=t.textureOnViewport,e.wheelSensitivity=t.wheelSensitivity,e.motionBlurEnabled=t.motionBlur,e.forcedPixelRatio=Qe(t.pixelRatio)?t.pixelRatio:null,e.motionBlur=t.motionBlur,e.motionBlurOpacity=t.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=t.desktopTapThreshold,e.desktopTapThreshold2=t.desktopTapThreshold*t.desktopTapThreshold,e.touchTapThreshold=t.touchTapThreshold,e.touchTapThreshold2=t.touchTapThreshold*t.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};Nh.notify=function(t,e){var r=this,n=r.cy;if(!this.destroyed){if(t==="init"){r.load();return}if(t==="destroy"){r.destroy();return}(t==="add"||t==="remove"||t==="move"&&n.hasCompoundNodes()||t==="load"||t==="zorder"||t==="mount")&&r.invalidateCachedZSortedEles(),t==="viewport"&&r.redrawHint("select",!0),t==="gc"&&r.redrawHint("gc",!0),(t==="load"||t==="resize"||t==="mount")&&(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container)),r.redrawHint("eles",!0),r.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};Nh.destroy=function(){var t=this;t.destroyed=!0,t.cy.stopAnimationLoop();for(var e=0;e<t.bindings.length;e++){var r=t.bindings[e],n=r,i=n.target;(i.off||i.removeEventListener).apply(i,n.args)}if(t.bindings=[],t.beforeRenderCallbacks=[],t.onUpdateEleCalcsFns=[],t.removeObserver&&t.removeObserver.disconnect(),t.styleObserver&&t.styleObserver.disconnect(),t.resizeObserver&&t.resizeObserver.disconnect(),t.labelCalcDiv)try{document.body.removeChild(t.labelCalcDiv)}catch{}};Nh.isHeadless=function(){return!1};[US,Oj,Ij,Ch,yl,Og].forEach(function(t){Ct(Nh,t)});var Qb=1e3/60,Bj={setupDequeueing:function(e){return function(){var n=this,i=this.renderer;if(!n.dequeueingSetup){n.dequeueingSetup=!0;var a=Mg(function(){i.redrawHint("eles",!0),i.redrawHint("drag",!0),i.redraw()},e.deqRedrawThreshold),s=function(u,c){var f=pl(),m=i.averageRedrawTime,g=i.lastRedrawTime,y=[],b=i.cy.extent(),w=i.getPixelRatio();for(u||i.flushRenderedStyleQueue();;){var N=pl(),k=N-f,C=N-c;if(g<Qb){var E=Qb-(u?m:0);if(C>=e.deqFastCost*E)break}else if(u){if(k>=e.deqCost*g||k>=e.deqAvgCost*m)break}else if(C>=e.deqNoDrawCost*Qb)break;var P=e.deq(n,w,b);if(P.length>0)for(var _=0;_<P.length;_++)y.push(P[_]);else break}y.length>0&&(e.onDeqd(n,y),!u&&e.shouldRedraw(n,y,w,b)&&a())},o=e.priority||TS;i.beforeRender(s,o(n))}}}},e7=(function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:J0;Ku(this,t),this.idsByKey=new ul,this.keyForId=new ul,this.cachesByLvl=new ul,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=r}return Yu(t,[{key:"getIdsFor",value:function(r){r==null&&Hr("Can not get id list for null key");var n=this.idsByKey,i=this.idsByKey.get(r);return i||(i=new bh,n.set(r,i)),i}},{key:"addIdForKey",value:function(r,n){r!=null&&this.getIdsFor(r).add(n)}},{key:"deleteIdForKey",value:function(r,n){r!=null&&this.getIdsFor(r).delete(n)}},{key:"getNumberOfIdsForKey",value:function(r){return r==null?0:this.getIdsFor(r).size}},{key:"updateKeyMappingFor",value:function(r){var n=r.id(),i=this.keyForId.get(n),a=this.getKey(r);this.deleteIdForKey(i,n),this.addIdForKey(a,n),this.keyForId.set(n,a)}},{key:"deleteKeyMappingFor",value:function(r){var n=r.id(),i=this.keyForId.get(n);this.deleteIdForKey(i,n),this.keyForId.delete(n)}},{key:"keyHasChangedFor",value:function(r){var n=r.id(),i=this.keyForId.get(n),a=this.getKey(r);return i!==a}},{key:"isInvalid",value:function(r){return this.keyHasChangedFor(r)||this.doesEleInvalidateKey(r)}},{key:"getCachesAt",value:function(r){var n=this.cachesByLvl,i=this.lvls,a=n.get(r);return a||(a=new ul,n.set(r,a),i.push(r)),a}},{key:"getCache",value:function(r,n){return this.getCachesAt(n).get(r)}},{key:"get",value:function(r,n){var i=this.getKey(r),a=this.getCache(i,n);return a!=null&&this.updateKeyMappingFor(r),a}},{key:"getForCachedKey",value:function(r,n){var i=this.keyForId.get(r.id()),a=this.getCache(i,n);return a}},{key:"hasCache",value:function(r,n){return this.getCachesAt(n).has(r)}},{key:"has",value:function(r,n){var i=this.getKey(r);return this.hasCache(i,n)}},{key:"setCache",value:function(r,n,i){i.key=r,this.getCachesAt(n).set(r,i)}},{key:"set",value:function(r,n,i){var a=this.getKey(r);this.setCache(a,n,i),this.updateKeyMappingFor(r)}},{key:"deleteCache",value:function(r,n){this.getCachesAt(n).delete(r)}},{key:"delete",value:function(r,n){var i=this.getKey(r);this.deleteCache(i,n)}},{key:"invalidateKey",value:function(r){var n=this;this.lvls.forEach(function(i){return n.deleteCache(r,i)})}},{key:"invalidate",value:function(r){var n=r.id(),i=this.keyForId.get(n);this.deleteKeyMappingFor(r);var a=this.doesEleInvalidateKey(r);return a&&this.invalidateKey(i),a||this.getNumberOfIdsForKey(i)===0}}])})(),sE=25,a0=50,L0=-4,T2=3,Fj=7.99,t7=8,r7=1024,n7=1024,i7=1024,a7=.2,s7=.8,o7=10,l7=.15,u7=.1,c7=.9,d7=.9,f7=100,h7=1,Wf={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},p7=Ni({getKey:null,doesEleInvalidateKey:J0,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:j6,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),Pm=function(e,r){var n=this;n.renderer=e,n.onDequeues=[];var i=p7(r);Ct(n,i),n.lookup=new e7(i.getKey,i.doesEleInvalidateKey),n.setupDequeueing()},Un=Pm.prototype;Un.reasons=Wf;Un.getTextureQueue=function(t){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[t]=e.eleImgCaches[t]||[]};Un.getRetiredTextureQueue=function(t){var e=this,r=e.eleImgCaches.retired=e.eleImgCaches.retired||{},n=r[t]=r[t]||[];return n};Un.getElementQueue=function(){var t=this,e=t.eleCacheQueue=t.eleCacheQueue||new _g(function(r,n){return n.reqs-r.reqs});return e};Un.getElementKeyToQueue=function(){var t=this,e=t.eleKeyToCacheQueue=t.eleKeyToCacheQueue||{};return e};Un.getElement=function(t,e,r,n,i){var a=this,s=this.renderer,o=s.cy.zoom(),l=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!t.visible()||t.removed()||!a.allowEdgeTxrCaching&&t.isEdge()||!a.allowParentTxrCaching&&t.isParent())return null;if(n==null&&(n=Math.ceil(PS(o*r))),n<L0)n=L0;else if(o>=Fj||n>T2)return null;var u=Math.pow(2,n),c=e.h*u,f=e.w*u,m=s.eleTextBiggerThanMin(t,u);if(!this.isVisible(t,m))return null;var g=l.get(t,n);if(g&&g.invalidated&&(g.invalidated=!1,g.texture.invalidatedWidth-=g.width),g)return g;var y;if(c<=sE?y=sE:c<=a0?y=a0:y=Math.ceil(c/a0)*a0,c>i7||f>n7)return null;var b=a.getTextureQueue(y),w=b[b.length-2],N=function(){return a.recycleTexture(y,f)||a.addTexture(y,f)};w||(w=b[b.length-1]),w||(w=N()),w.width-w.usedWidth<f&&(w=N());for(var k=function(G){return G&&G.scaledLabelShown===m},C=i&&i===Wf.dequeue,E=i&&i===Wf.highQuality,P=i&&i===Wf.downscale,_,A=n+1;A<=T2;A++){var I=l.get(t,A);if(I){_=I;break}}var D=_&&_.level===n+1?_:null,L=function(){w.context.drawImage(D.texture.canvas,D.x,0,D.width,D.height,w.usedWidth,0,f,c)};if(w.context.setTransform(1,0,0,1,0,0),w.context.clearRect(w.usedWidth,0,f,y),k(D))L();else if(k(_))if(E){for(var U=_.level;U>n;U--)D=a.getElement(t,e,r,U,Wf.downscale);L()}else return a.queueElement(t,_.level-1),_;else{var H;if(!C&&!E&&!P)for(var M=n-1;M>=L0;M--){var z=l.get(t,M);if(z){H=z;break}}if(k(H))return a.queueElement(t,n),H;w.context.translate(w.usedWidth,0),w.context.scale(u,u),this.drawElement(w.context,t,e,m,!1),w.context.scale(1/u,1/u),w.context.translate(-w.usedWidth,0)}return g={x:w.usedWidth,texture:w,level:n,scale:u,width:f,height:c,scaledLabelShown:m},w.usedWidth+=Math.ceil(f+t7),w.eleCaches.push(g),l.set(t,n,g),a.checkTextureFullness(w),g};Un.invalidateElements=function(t){for(var e=0;e<t.length;e++)this.invalidateElement(t[e])};Un.invalidateElement=function(t){var e=this,r=e.lookup,n=[],i=r.isInvalid(t);if(i){for(var a=L0;a<=T2;a++){var s=r.getForCachedKey(t,a);s&&n.push(s)}var o=r.invalidate(t);if(o)for(var l=0;l<n.length;l++){var u=n[l],c=u.texture;c.invalidatedWidth+=u.width,u.invalidated=!0,e.checkTextureUtility(c)}e.removeFromQueue(t)}};Un.checkTextureUtility=function(t){t.invalidatedWidth>=a7*t.width&&this.retireTexture(t)};Un.checkTextureFullness=function(t){var e=this,r=e.getTextureQueue(t.height);t.usedWidth/t.width>s7&&t.fullnessChecks>=o7?Fu(r,t):t.fullnessChecks++};Un.retireTexture=function(t){var e=this,r=t.height,n=e.getTextureQueue(r),i=this.lookup;Fu(n,t),t.retired=!0;for(var a=t.eleCaches,s=0;s<a.length;s++){var o=a[s];i.deleteCache(o.key,o.level)}jS(a);var l=e.getRetiredTextureQueue(r);l.push(t)};Un.addTexture=function(t,e){var r=this,n=r.getTextureQueue(t),i={};return n.push(i),i.eleCaches=[],i.height=t,i.width=Math.max(r7,e),i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,i.canvas=r.renderer.makeOffscreenCanvas(i.width,i.height),i.context=i.canvas.getContext("2d"),i};Un.recycleTexture=function(t,e){for(var r=this,n=r.getTextureQueue(t),i=r.getRetiredTextureQueue(t),a=0;a<i.length;a++){var s=i[a];if(s.width>=e)return s.retired=!1,s.usedWidth=0,s.invalidatedWidth=0,s.fullnessChecks=0,jS(s.eleCaches),s.context.setTransform(1,0,0,1,0,0),s.context.clearRect(0,0,s.width,s.height),Fu(i,s),n.push(s),s}};Un.queueElement=function(t,e){var r=this,n=r.getElementQueue(),i=r.getElementKeyToQueue(),a=this.getKey(t),s=i[a];if(s)s.level=Math.max(s.level,e),s.eles.merge(t),s.reqs++,n.updateItem(s);else{var o={eles:t.spawn().merge(t),level:e,reqs:1,key:a};n.push(o),i[a]=o}};Un.dequeue=function(t){for(var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),i=[],a=e.lookup,s=0;s<h7&&r.size()>0;s++){var o=r.pop(),l=o.key,u=o.eles[0],c=a.hasCache(u,o.level);if(n[l]=null,c)continue;i.push(o);var f=e.getBoundingBox(u);e.getElement(u,f,t,o.level,Wf.dequeue)}return i};Un.removeFromQueue=function(t){var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),i=this.getKey(t),a=n[i];a!=null&&(a.eles.length===1?(a.reqs=ES,r.updateItem(a),r.pop(),n[i]=null):a.eles.unmerge(t))};Un.onDequeue=function(t){this.onDequeues.push(t)};Un.offDequeue=function(t){Fu(this.onDequeues,t)};Un.setupDequeueing=Bj.setupDequeueing({deqRedrawThreshold:f7,deqCost:l7,deqAvgCost:u7,deqNoDrawCost:c7,deqFastCost:d7,deq:function(e,r,n){return e.dequeue(r,n)},onDeqd:function(e,r){for(var n=0;n<e.onDequeues.length;n++){var i=e.onDequeues[n];i(r)}},shouldRedraw:function(e,r,n,i){for(var a=0;a<r.length;a++)for(var s=r[a].eles,o=0;o<s.length;o++){var l=s[o].boundingBox();if(_S(l,i))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var m7=1,Im=-4,sy=2,g7=3.99,v7=50,y7=50,x7=.15,b7=.1,w7=.9,S7=.9,k7=1,oE=250,C7=4e3*4e3,lE=32767,N7=!0,zj=function(e){var r=this,n=r.renderer=e,i=n.cy;r.layersByLevel={},r.firstGet=!0,r.lastInvalidationTime=pl()-2*oE,r.skipping=!1,r.eleTxrDeqs=i.collection(),r.scheduleElementRefinement=Mg(function(){r.refineElementTextures(r.eleTxrDeqs),r.eleTxrDeqs.unmerge(r.eleTxrDeqs)},y7),n.beforeRender(function(s,o){o-r.lastInvalidationTime<=oE?r.skipping=!0:r.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip);var a=function(o,l){return l.reqs-o.reqs};r.layersQueue=new _g(a),r.setupDequeueing()},Ei=zj.prototype,uE=0,E7=Math.pow(2,53)-1;Ei.makeLayer=function(t,e){var r=Math.pow(2,e),n=Math.ceil(t.w*r),i=Math.ceil(t.h*r),a=this.renderer.makeOffscreenCanvas(n,i),s={id:uE=++uE%E7,bb:t,level:e,width:n,height:i,canvas:a,context:a.getContext("2d"),eles:[],elesQueue:[],reqs:0},o=s.context,l=-s.bb.x1,u=-s.bb.y1;return o.scale(r,r),o.translate(l,u),s};Ei.getLayers=function(t,e,r){var n=this,i=n.renderer,a=i.cy,s=a.zoom(),o=n.firstGet;if(n.firstGet=!1,r==null){if(r=Math.ceil(PS(s*e)),r<Im)r=Im;else if(s>=g7||r>sy)return null}n.validateLayersElesOrdering(r,t);var l=n.layersByLevel,u=Math.pow(2,r),c=l[r]=l[r]||[],f,m=n.levelIsComplete(r,t),g,y=function(){var L=function(O){if(n.validateLayersElesOrdering(O,t),n.levelIsComplete(O,t))return g=l[O],!0},U=function(O){if(!g)for(var G=r+O;Im<=G&&G<=sy&&!L(G);G+=O);};U(1),U(-1);for(var H=c.length-1;H>=0;H--){var M=c[H];M.invalid&&Fu(c,M)}};if(!m)y();else return c;var b=function(){if(!f){f=ea();for(var L=0;L<t.length;L++)kO(f,t[L].boundingBox())}return f},w=function(L){L=L||{};var U=L.after;b();var H=Math.ceil(f.w*u),M=Math.ceil(f.h*u);if(H>lE||M>lE)return null;var z=H*M;if(z>C7)return null;var O=n.makeLayer(f,r);if(U!=null){var G=c.indexOf(U)+1;c.splice(G,0,O)}else(L.insert===void 0||L.insert)&&c.unshift(O);return O};if(n.skipping&&!o)return null;for(var N=null,k=t.length/m7,C=!o,E=0;E<t.length;E++){var P=t[E],_=P._private.rscratch,A=_.imgLayerCaches=_.imgLayerCaches||{},I=A[r];if(I){N=I;continue}if((!N||N.eles.length>=k||!D6(N.bb,P.boundingBox()))&&(N=w({insert:!0,after:N}),!N))return null;g||C?n.queueLayer(N,P):n.drawEleInLayer(N,P,r,e),N.eles.push(P),A[r]=N}return g||(C?null:c)};Ei.getEleLevelForLayerLevel=function(t,e){return t};Ei.drawEleInLayer=function(t,e,r,n){var i=this,a=this.renderer,s=t.context,o=e.boundingBox();o.w===0||o.h===0||!e.visible()||(r=i.getEleLevelForLayerLevel(r,n),a.setImgSmoothing(s,!1),a.drawCachedElement(s,e,null,null,r,N7),a.setImgSmoothing(s,!0))};Ei.levelIsComplete=function(t,e){var r=this,n=r.layersByLevel[t];if(!n||n.length===0)return!1;for(var i=0,a=0;a<n.length;a++){var s=n[a];if(s.reqs>0||s.invalid)return!1;i+=s.eles.length}return i===e.length};Ei.validateLayersElesOrdering=function(t,e){var r=this.layersByLevel[t];if(r)for(var n=0;n<r.length;n++){for(var i=r[n],a=-1,s=0;s<e.length;s++)if(i.eles[0]===e[s]){a=s;break}if(a<0){this.invalidateLayer(i);continue}for(var o=a,s=0;s<i.eles.length;s++)if(i.eles[s]!==e[o+s]){this.invalidateLayer(i);break}}};Ei.updateElementsInLayers=function(t,e){for(var r=this,n=Eg(t[0]),i=0;i<t.length;i++)for(var a=n?null:t[i],s=n?t[i]:t[i].ele,o=s._private.rscratch,l=o.imgLayerCaches=o.imgLayerCaches||{},u=Im;u<=sy;u++){var c=l[u];c&&(a&&r.getEleLevelForLayerLevel(c.level)!==a.level||e(c,s,a))}};Ei.haveLayers=function(){for(var t=this,e=!1,r=Im;r<=sy;r++){var n=t.layersByLevel[r];if(n&&n.length>0){e=!0;break}}return e};Ei.invalidateElements=function(t){var e=this;t.length!==0&&(e.lastInvalidationTime=pl(),!(t.length===0||!e.haveLayers())&&e.updateElementsInLayers(t,function(n,i,a){e.invalidateLayer(n)}))};Ei.invalidateLayer=function(t){if(this.lastInvalidationTime=pl(),!t.invalid){var e=t.level,r=t.eles,n=this.layersByLevel[e];Fu(n,t),t.elesQueue=[],t.invalid=!0,t.replacement&&(t.replacement.invalid=!0);for(var i=0;i<r.length;i++){var a=r[i]._private.rscratch.imgLayerCaches;a&&(a[e]=null)}}};Ei.refineElementTextures=function(t){var e=this;e.updateElementsInLayers(t,function(n,i,a){var s=n.replacement;if(s||(s=n.replacement=e.makeLayer(n.bb,n.level),s.replaces=n,s.eles=n.eles),!s.reqs)for(var o=0;o<s.eles.length;o++)e.queueLayer(s,s.eles[o])})};Ei.enqueueElementRefinement=function(t){this.eleTxrDeqs.merge(t),this.scheduleElementRefinement()};Ei.queueLayer=function(t,e){var r=this,n=r.layersQueue,i=t.elesQueue,a=i.hasId=i.hasId||{};if(!t.replacement){if(e){if(a[e.id()])return;i.push(e),a[e.id()]=!0}t.reqs?(t.reqs++,n.updateItem(t)):(t.reqs=1,n.push(t))}};Ei.dequeue=function(t){for(var e=this,r=e.layersQueue,n=[],i=0;i<k7&&r.size()!==0;){var a=r.peek();if(a.replacement){r.pop();continue}if(a.replaces&&a!==a.replaces.replacement){r.pop();continue}if(a.invalid){r.pop();continue}var s=a.elesQueue.shift();s&&(e.drawEleInLayer(a,s,a.level,t),i++),n.length===0&&n.push(!0),a.elesQueue.length===0&&(r.pop(),a.reqs=0,a.replaces&&e.applyLayerReplacement(a),e.requestRedraw())}return n};Ei.applyLayerReplacement=function(t){var e=this,r=e.layersByLevel[t.level],n=t.replaces,i=r.indexOf(n);if(!(i<0||n.invalid)){r[i]=t;for(var a=0;a<t.eles.length;a++){var s=t.eles[a]._private,o=s.imgLayerCaches=s.imgLayerCaches||{};o&&(o[t.level]=t)}e.requestRedraw()}};Ei.requestRedraw=Mg(function(){var t=this.renderer;t.redrawHint("eles",!0),t.redrawHint("drag",!0),t.redraw()},100);Ei.setupDequeueing=Bj.setupDequeueing({deqRedrawThreshold:v7,deqCost:x7,deqAvgCost:b7,deqNoDrawCost:w7,deqFastCost:S7,deq:function(e,r){return e.dequeue(r)},onDeqd:TS,shouldRedraw:j6,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var Vj={},cE;function T7(t,e){for(var r=0;r<e.length;r++){var n=e[r];t.lineTo(n.x,n.y)}}function j7(t,e,r){for(var n,i=0;i<e.length;i++){var a=e[i];i===0&&(n=a),t.lineTo(a.x,a.y)}t.quadraticCurveTo(r.x,r.y,n.x,n.y)}function dE(t,e,r){t.beginPath&&t.beginPath();for(var n=e,i=0;i<n.length;i++){var a=n[i];t.lineTo(a.x,a.y)}var s=r,o=r[0];t.moveTo(o.x,o.y);for(var i=1;i<s.length;i++){var a=s[i];t.lineTo(a.x,a.y)}t.closePath&&t.closePath()}function P7(t,e,r,n,i){t.beginPath&&t.beginPath(),t.arc(r,n,i,0,Math.PI*2,!1);var a=e,s=a[0];t.moveTo(s.x,s.y);for(var o=0;o<a.length;o++){var l=a[o];t.lineTo(l.x,l.y)}t.closePath&&t.closePath()}function M7(t,e,r,n){t.arc(e,r,n,0,Math.PI*2,!1)}Vj.arrowShapeImpl=function(t){return(cE||(cE={polygon:T7,"triangle-backcurve":j7,"triangle-tee":dE,"circle-triangle":P7,"triangle-cross":dE,circle:M7}))[t]};var Eo={};Eo.drawElement=function(t,e,r,n,i,a){var s=this;e.isNode()?s.drawNode(t,e,r,n,i,a):s.drawEdge(t,e,r,n,i,a)};Eo.drawElementOverlay=function(t,e){var r=this;e.isNode()?r.drawNodeOverlay(t,e):r.drawEdgeOverlay(t,e)};Eo.drawElementUnderlay=function(t,e){var r=this;e.isNode()?r.drawNodeUnderlay(t,e):r.drawEdgeUnderlay(t,e)};Eo.drawCachedElementPortion=function(t,e,r,n,i,a,s,o){var l=this,u=r.getBoundingBox(e);if(!(u.w===0||u.h===0)){var c=r.getElement(e,u,n,i,a);if(c!=null){var f=o(l,e);if(f===0)return;var m=s(l,e),g=u.x1,y=u.y1,b=u.w,w=u.h,N,k,C,E,P;if(m!==0){var _=r.getRotationPoint(e);C=_.x,E=_.y,t.translate(C,E),t.rotate(m),P=l.getImgSmoothing(t),P||l.setImgSmoothing(t,!0);var A=r.getRotationOffset(e);N=A.x,k=A.y}else N=g,k=y;var I;f!==1&&(I=t.globalAlpha,t.globalAlpha=I*f),t.drawImage(c.texture.canvas,c.x,0,c.width,c.height,N,k,b,w),f!==1&&(t.globalAlpha=I),m!==0&&(t.rotate(-m),t.translate(-C,-E),P||l.setImgSmoothing(t,!1))}else r.drawElement(t,e)}};var _7=function(){return 0},A7=function(e,r){return e.getTextAngle(r,null)},R7=function(e,r){return e.getTextAngle(r,"source")},D7=function(e,r){return e.getTextAngle(r,"target")},O7=function(e,r){return r.effectiveOpacity()},Jb=function(e,r){return r.pstyle("text-opacity").pfValue*r.effectiveOpacity()};Eo.drawCachedElement=function(t,e,r,n,i,a){var s=this,o=s.data,l=o.eleTxrCache,u=o.lblTxrCache,c=o.slbTxrCache,f=o.tlbTxrCache,m=e.boundingBox(),g=a===!0?l.reasons.highQuality:null;if(!(m.w===0||m.h===0||!e.visible())&&(!n||_S(m,n))){var y=e.isEdge(),b=e.element()._private.rscratch.badLine;s.drawElementUnderlay(t,e),s.drawCachedElementPortion(t,e,l,r,i,g,_7,O7),(!y||!b)&&s.drawCachedElementPortion(t,e,u,r,i,g,A7,Jb),y&&!b&&(s.drawCachedElementPortion(t,e,c,r,i,g,R7,Jb),s.drawCachedElementPortion(t,e,f,r,i,g,D7,Jb)),s.drawElementOverlay(t,e)}};Eo.drawElements=function(t,e){for(var r=this,n=0;n<e.length;n++){var i=e[n];r.drawElement(t,i)}};Eo.drawCachedElements=function(t,e,r,n){for(var i=this,a=0;a<e.length;a++){var s=e[a];i.drawCachedElement(t,s,r,n)}};Eo.drawCachedNodes=function(t,e,r,n){for(var i=this,a=0;a<e.length;a++){var s=e[a];s.isNode()&&i.drawCachedElement(t,s,r,n)}};Eo.drawLayeredElements=function(t,e,r,n){var i=this,a=i.data.lyrTxrCache.getLayers(e,r);if(a)for(var s=0;s<a.length;s++){var o=a[s],l=o.bb;l.w===0||l.h===0||t.drawImage(o.canvas,l.x1,l.y1,l.w,l.h)}else i.drawCachedElements(t,e,r,n)};var xl={};xl.drawEdge=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,o=e._private.rscratch;if(!(a&&!e.visible())&&!(o.badLine||o.allpts==null||isNaN(o.allpts[0]))){var l;r&&(l=r,t.translate(-l.x1,-l.y1));var u=a?e.pstyle("opacity").value:1,c=a?e.pstyle("line-opacity").value:1,f=e.pstyle("curve-style").value,m=e.pstyle("line-style").value,g=e.pstyle("width").pfValue,y=e.pstyle("line-cap").value,b=e.pstyle("line-outline-width").value,w=e.pstyle("line-outline-color").value,N=u*c,k=u*c,C=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N;f==="straight-triangle"?(s.eleStrokeStyle(t,e,O),s.drawEdgeTrianglePath(e,t,o.allpts)):(t.lineWidth=g,t.lineCap=y,s.eleStrokeStyle(t,e,O),s.drawEdgePath(e,t,o.allpts,m),t.lineCap="butt")},E=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N;if(t.lineWidth=g+b,t.lineCap=y,b>0)s.colorStrokeStyle(t,w[0],w[1],w[2],O);else{t.lineCap="butt";return}f==="straight-triangle"?s.drawEdgeTrianglePath(e,t,o.allpts):(s.drawEdgePath(e,t,o.allpts,m),t.lineCap="butt")},P=function(){i&&s.drawEdgeOverlay(t,e)},_=function(){i&&s.drawEdgeUnderlay(t,e)},A=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:k;s.drawArrowheads(t,e,O)},I=function(){s.drawElementText(t,e,null,n)};t.lineJoin="round";var D=e.pstyle("ghost").value==="yes";if(D){var L=e.pstyle("ghost-offset-x").pfValue,U=e.pstyle("ghost-offset-y").pfValue,H=e.pstyle("ghost-opacity").value,M=N*H;t.translate(L,U),C(M),A(M),t.translate(-L,-U)}else E();_(),C(),A(),P(),I(),r&&t.translate(l.x1,l.y1)}};var Uj=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(r,n){if(n.visible()){var i=n.pstyle("".concat(e,"-opacity")).value;if(i!==0){var a=this,s=a.usePaths(),o=n._private.rscratch,l=n.pstyle("".concat(e,"-padding")).pfValue,u=2*l,c=n.pstyle("".concat(e,"-color")).value;r.lineWidth=u,o.edgeType==="self"&&!s?r.lineCap="butt":r.lineCap="round",a.colorStrokeStyle(r,c[0],c[1],c[2],i),a.drawEdgePath(n,r,o.allpts,"solid")}}}};xl.drawEdgeOverlay=Uj("overlay");xl.drawEdgeUnderlay=Uj("underlay");xl.drawEdgePath=function(t,e,r,n){var i=t._private.rscratch,a=e,s,o=!1,l=this.usePaths(),u=t.pstyle("line-dash-pattern").pfValue,c=t.pstyle("line-dash-offset").pfValue;if(l){var f=r.join("$"),m=i.pathCacheKey&&i.pathCacheKey===f;m?(s=e=i.pathCache,o=!0):(s=e=new Path2D,i.pathCacheKey=f,i.pathCache=s)}if(a.setLineDash)switch(n){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash(u),a.lineDashOffset=c;break;case"solid":a.setLineDash([]);break}if(!o&&!i.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(r[0],r[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var g=2;g+3<r.length;g+=4)e.quadraticCurveTo(r[g],r[g+1],r[g+2],r[g+3]);break;case"straight":case"haystack":for(var y=2;y+1<r.length;y+=2)e.lineTo(r[y],r[y+1]);break;case"segments":if(i.isRound){var b=wa(i.roundCorners),w;try{for(b.s();!(w=b.n()).done;){var N=w.value;Mj(e,N)}}catch(C){b.e(C)}finally{b.f()}e.lineTo(r[r.length-2],r[r.length-1])}else for(var k=2;k+1<r.length;k+=2)e.lineTo(r[k],r[k+1]);break}e=a,l?e.stroke(s):e.stroke(),e.setLineDash&&e.setLineDash([])};xl.drawEdgeTrianglePath=function(t,e,r){e.fillStyle=e.strokeStyle;for(var n=t.pstyle("width").pfValue,i=0;i+1<r.length;i+=2){var a=[r[i+2]-r[i],r[i+3]-r[i+1]],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]),o=[a[1]/s,-a[0]/s],l=[o[0]*n/2,o[1]*n/2];e.beginPath(),e.moveTo(r[i]-l[0],r[i+1]-l[1]),e.lineTo(r[i]+l[0],r[i+1]+l[1]),e.lineTo(r[i+2],r[i+3]),e.closePath(),e.fill()}};xl.drawArrowheads=function(t,e,r){var n=e._private.rscratch,i=n.edgeType==="haystack";i||this.drawArrowhead(t,e,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,r),this.drawArrowhead(t,e,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,r),this.drawArrowhead(t,e,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,r),i||this.drawArrowhead(t,e,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,r)};xl.drawArrowhead=function(t,e,r,n,i,a,s){if(!(isNaN(n)||n==null||isNaN(i)||i==null||isNaN(a)||a==null)){var o=this,l=e.pstyle(r+"-arrow-shape").value;if(l!=="none"){var u=e.pstyle(r+"-arrow-fill").value==="hollow"?"both":"filled",c=e.pstyle(r+"-arrow-fill").value,f=e.pstyle("width").pfValue,m=e.pstyle(r+"-arrow-width"),g=m.value==="match-line"?f:m.pfValue;m.units==="%"&&(g*=f);var y=e.pstyle("opacity").value;s===void 0&&(s=y);var b=t.globalCompositeOperation;(s!==1||c==="hollow")&&(t.globalCompositeOperation="destination-out",o.colorFillStyle(t,255,255,255,1),o.colorStrokeStyle(t,255,255,255,1),o.drawArrowShape(e,t,u,f,l,g,n,i,a),t.globalCompositeOperation=b);var w=e.pstyle(r+"-arrow-color").value;o.colorFillStyle(t,w[0],w[1],w[2],s),o.colorStrokeStyle(t,w[0],w[1],w[2],s),o.drawArrowShape(e,t,c,f,l,g,n,i,a)}}};xl.drawArrowShape=function(t,e,r,n,i,a,s,o,l){var u=this,c=this.usePaths()&&i!=="triangle-cross",f=!1,m,g=e,y={x:s,y:o},b=t.pstyle("arrow-scale").value,w=this.getArrowWidth(n,b),N=u.arrowShapes[i];if(c){var k=u.arrowPathCache=u.arrowPathCache||[],C=ud(i),E=k[C];E!=null?(m=e=E,f=!0):(m=e=new Path2D,k[C]=m)}f||(e.beginPath&&e.beginPath(),c?N.draw(e,1,0,{x:0,y:0},1):N.draw(e,w,l,y,n),e.closePath&&e.closePath()),e=g,c&&(e.translate(s,o),e.rotate(l),e.scale(w,w)),(r==="filled"||r==="both")&&(c?e.fill(m):e.fill()),(r==="hollow"||r==="both")&&(e.lineWidth=a/(c?w:1),e.lineJoin="miter",c?e.stroke(m):e.stroke()),c&&(e.scale(1/w,1/w),e.rotate(-l),e.translate(-s,-o))};var qS={};qS.safeDrawImage=function(t,e,r,n,i,a,s,o,l,u){if(!(i<=0||a<=0||l<=0||u<=0))try{t.drawImage(e,r,n,i,a,s,o,l,u)}catch(c){lr(c)}};qS.drawInscribedImage=function(t,e,r,n,i){var a=this,s=r.position(),o=s.x,l=s.y,u=r.cy().style(),c=u.getIndexedStyle.bind(u),f=c(r,"background-fit","value",n),m=c(r,"background-repeat","value",n),g=r.width(),y=r.height(),b=r.padding()*2,w=g+(c(r,"background-width-relative-to","value",n)==="inner"?0:b),N=y+(c(r,"background-height-relative-to","value",n)==="inner"?0:b),k=r._private.rscratch,C=c(r,"background-clip","value",n),E=C==="node",P=c(r,"background-image-opacity","value",n)*i,_=c(r,"background-image-smoothing","value",n),A=r.pstyle("corner-radius").value;A!=="auto"&&(A=r.pstyle("corner-radius").pfValue);var I=e.width||e.cachedW,D=e.height||e.cachedH;(I==null||D==null)&&(document.body.appendChild(e),I=e.cachedW=e.width||e.offsetWidth,D=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var L=I,U=D;if(c(r,"background-width","value",n)!=="auto"&&(c(r,"background-width","units",n)==="%"?L=c(r,"background-width","pfValue",n)*w:L=c(r,"background-width","pfValue",n)),c(r,"background-height","value",n)!=="auto"&&(c(r,"background-height","units",n)==="%"?U=c(r,"background-height","pfValue",n)*N:U=c(r,"background-height","pfValue",n)),!(L===0||U===0)){if(f==="contain"){var H=Math.min(w/L,N/U);L*=H,U*=H}else if(f==="cover"){var H=Math.max(w/L,N/U);L*=H,U*=H}var M=o-w/2,z=c(r,"background-position-x","units",n),O=c(r,"background-position-x","pfValue",n);z==="%"?M+=(w-L)*O:M+=O;var G=c(r,"background-offset-x","units",n),W=c(r,"background-offset-x","pfValue",n);G==="%"?M+=(w-L)*W:M+=W;var $=l-N/2,X=c(r,"background-position-y","units",n),Q=c(r,"background-position-y","pfValue",n);X==="%"?$+=(N-U)*Q:$+=Q;var V=c(r,"background-offset-y","units",n),Y=c(r,"background-offset-y","pfValue",n);V==="%"?$+=(N-U)*Y:$+=Y,k.pathCache&&(M-=o,$-=l,o=0,l=0);var Z=t.globalAlpha;t.globalAlpha=P;var ie=a.getImgSmoothing(t),ce=!1;if(_==="no"&&ie?(a.setImgSmoothing(t,!1),ce=!0):_==="yes"&&!ie&&(a.setImgSmoothing(t,!0),ce=!0),m==="no-repeat")E&&(t.save(),k.pathCache?t.clip(k.pathCache):(a.nodeShapes[a.getNodeShape(r)].draw(t,o,l,w,N,A,k),t.clip())),a.safeDrawImage(t,e,0,0,I,D,M,$,L,U),E&&t.restore();else{var he=t.createPattern(e,m);t.fillStyle=he,a.nodeShapes[a.getNodeShape(r)].draw(t,o,l,w,N,A,k),t.translate(M,$),t.fill(),t.translate(-M,-$)}t.globalAlpha=Z,ce&&a.setImgSmoothing(t,ie)}};var kd={};kd.eleTextBiggerThanMin=function(t,e){if(!e){var r=t.cy().zoom(),n=this.getPixelRatio(),i=Math.ceil(PS(r*n));e=Math.pow(2,i)}var a=t.pstyle("font-size").pfValue*e,s=t.pstyle("min-zoomed-font-size").pfValue;return!(a<s)};kd.drawElementText=function(t,e,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this;if(n==null){if(a&&!s.eleTextBiggerThanMin(e))return}else if(n===!1)return;if(e.isNode()){var o=e.pstyle("label");if(!o||!o.value)return;var l=s.getLabelJustification(e);t.textAlign=l,t.textBaseline="bottom"}else{var u=e.element()._private.rscratch.badLine,c=e.pstyle("label"),f=e.pstyle("source-label"),m=e.pstyle("target-label");if(u||(!c||!c.value)&&(!f||!f.value)&&(!m||!m.value))return;t.textAlign="center",t.textBaseline="bottom"}var g=!r,y;r&&(y=r,t.translate(-y.x1,-y.y1)),i==null?(s.drawText(t,e,null,g,a),e.isEdge()&&(s.drawText(t,e,"source",g,a),s.drawText(t,e,"target",g,a))):s.drawText(t,e,i,g,a),r&&t.translate(y.x1,y.y1)};kd.getFontCache=function(t){var e;this.fontCaches=this.fontCaches||[];for(var r=0;r<this.fontCaches.length;r++)if(e=this.fontCaches[r],e.context===t)return e;return e={context:t},this.fontCaches.push(e),e};kd.setupTextStyle=function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=e.pstyle("font-style").strValue,i=e.pstyle("font-size").pfValue+"px",a=e.pstyle("font-family").strValue,s=e.pstyle("font-weight").strValue,o=r?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,l=e.pstyle("text-outline-opacity").value*o,u=e.pstyle("color").value,c=e.pstyle("text-outline-color").value;t.font=n+" "+s+" "+i+" "+a,t.lineJoin="round",this.colorFillStyle(t,u[0],u[1],u[2],o),this.colorStrokeStyle(t,c[0],c[1],c[2],l)};function I7(t,e,r,n,i){var a=Math.min(n,i),s=a/2,o=e+n/2,l=r+i/2;t.beginPath(),t.arc(o,l,s,0,Math.PI*2),t.closePath()}function fE(t,e,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,s=Math.min(a,n/2,i/2);t.beginPath(),t.moveTo(e+s,r),t.lineTo(e+n-s,r),t.quadraticCurveTo(e+n,r,e+n,r+s),t.lineTo(e+n,r+i-s),t.quadraticCurveTo(e+n,r+i,e+n-s,r+i),t.lineTo(e+s,r+i),t.quadraticCurveTo(e,r+i,e,r+i-s),t.lineTo(e,r+s),t.quadraticCurveTo(e,r,e+s,r),t.closePath()}kd.getTextAngle=function(t,e){var r,n=t._private,i=n.rscratch,a=e?e+"-":"",s=t.pstyle(a+"text-rotation");if(s.strValue==="autorotate"){var o=ya(i,"labelAngle",e);r=t.isEdge()?o:0}else s.strValue==="none"?r=0:r=s.pfValue;return r};kd.drawText=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=e._private,s=a.rscratch,o=i?e.effectiveOpacity():1;if(!(i&&(o===0||e.pstyle("text-opacity").value===0))){r==="main"&&(r=null);var l=ya(s,"labelX",r),u=ya(s,"labelY",r),c,f,m=this.getLabelText(e,r);if(m!=null&&m!==""&&!isNaN(l)&&!isNaN(u)){this.setupTextStyle(t,e,i);var g=r?r+"-":"",y=ya(s,"labelWidth",r),b=ya(s,"labelHeight",r),w=e.pstyle(g+"text-margin-x").pfValue,N=e.pstyle(g+"text-margin-y").pfValue,k=e.isEdge(),C=e.pstyle("text-halign").value,E=e.pstyle("text-valign").value;k&&(C="center",E="center"),l+=w,u+=N;var P;switch(n?P=this.getTextAngle(e,r):P=0,P!==0&&(c=l,f=u,t.translate(c,f),t.rotate(P),l=0,u=0),E){case"top":break;case"center":u+=b/2;break;case"bottom":u+=b;break}var _=e.pstyle("text-background-opacity").value,A=e.pstyle("text-border-opacity").value,I=e.pstyle("text-border-width").pfValue,D=e.pstyle("text-background-padding").pfValue,L=e.pstyle("text-background-shape").strValue,U=L==="round-rectangle"||L==="roundrectangle",H=L==="circle",M=2;if(_>0||I>0&&A>0){var z=t.fillStyle,O=t.strokeStyle,G=t.lineWidth,W=e.pstyle("text-background-color").value,$=e.pstyle("text-border-color").value,X=e.pstyle("text-border-style").value,Q=_>0,V=I>0&&A>0,Y=l-D;switch(C){case"left":Y-=y;break;case"center":Y-=y/2;break}var Z=u-b-D,ie=y+2*D,ce=b+2*D;if(Q&&(t.fillStyle="rgba(".concat(W[0],",").concat(W[1],",").concat(W[2],",").concat(_*o,")")),V&&(t.strokeStyle="rgba(".concat($[0],",").concat($[1],",").concat($[2],",").concat(A*o,")"),t.lineWidth=I,t.setLineDash))switch(X){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"double":t.lineWidth=I/4,t.setLineDash([]);break;default:t.setLineDash([]);break}if(U?(t.beginPath(),fE(t,Y,Z,ie,ce,M)):H?(t.beginPath(),I7(t,Y,Z,ie,ce)):(t.beginPath(),t.rect(Y,Z,ie,ce)),Q&&t.fill(),V&&t.stroke(),V&&X==="double"){var he=I/2;t.beginPath(),U?fE(t,Y+he,Z+he,ie-2*he,ce-2*he,M):t.rect(Y+he,Z+he,ie-2*he,ce-2*he),t.stroke()}t.fillStyle=z,t.strokeStyle=O,t.lineWidth=G,t.setLineDash&&t.setLineDash([])}var ee=2*e.pstyle("text-outline-width").pfValue;if(ee>0&&(t.lineWidth=ee),e.pstyle("text-wrap").value==="wrap"){var le=ya(s,"labelWrapCachedLines",r),te=ya(s,"labelLineHeight",r),ae=y/2,oe=this.getLabelJustification(e);switch(oe==="auto"||(C==="left"?oe==="left"?l+=-y:oe==="center"&&(l+=-ae):C==="center"?oe==="left"?l+=-ae:oe==="right"&&(l+=ae):C==="right"&&(oe==="center"?l+=ae:oe==="right"&&(l+=y))),E){case"top":u-=(le.length-1)*te;break;case"center":case"bottom":u-=(le.length-1)*te;break}for(var fe=0;fe<le.length;fe++)ee>0&&t.strokeText(le[fe],l,u),t.fillText(le[fe],l,u),u+=te}else ee>0&&t.strokeText(m,l,u),t.fillText(m,l,u);P!==0&&(t.rotate(-P),t.translate(-c,-f))}}};var Qu={};Qu.drawNode=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,o,l,u=e._private,c=u.rscratch,f=e.position();if(!(!Qe(f.x)||!Qe(f.y))&&!(a&&!e.visible())){var m=a?e.effectiveOpacity():1,g=s.usePaths(),y,b=!1,w=e.padding();o=e.width()+2*w,l=e.height()+2*w;var N;r&&(N=r,t.translate(-N.x1,-N.y1));for(var k=e.pstyle("background-image"),C=k.value,E=new Array(C.length),P=new Array(C.length),_=0,A=0;A<C.length;A++){var I=C[A],D=E[A]=I!=null&&I!=="none";if(D){var L=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",A);_++,P[A]=s.getCachedImage(I,L,function(){u.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var U=e.pstyle("background-blacken").value,H=e.pstyle("border-width").pfValue,M=e.pstyle("background-opacity").value*m,z=e.pstyle("border-color").value,O=e.pstyle("border-style").value,G=e.pstyle("border-join").value,W=e.pstyle("border-cap").value,$=e.pstyle("border-position").value,X=e.pstyle("border-dash-pattern").pfValue,Q=e.pstyle("border-dash-offset").pfValue,V=e.pstyle("border-opacity").value*m,Y=e.pstyle("outline-width").pfValue,Z=e.pstyle("outline-color").value,ie=e.pstyle("outline-style").value,ce=e.pstyle("outline-opacity").value*m,he=e.pstyle("outline-offset").value,ee=e.pstyle("corner-radius").value;ee!=="auto"&&(ee=e.pstyle("corner-radius").pfValue);var le=function(){var Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:M;s.eleFillStyle(t,e,Ye)},te=function(){var Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:V;s.colorStrokeStyle(t,z[0],z[1],z[2],Ye)},ae=function(){var Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ce;s.colorStrokeStyle(t,Z[0],Z[1],Z[2],Ye)},oe=function(Ye,De,re,ue){var ge=s.nodePathCache=s.nodePathCache||[],be=T6(re==="polygon"?re+","+ue.join(","):re,""+De,""+Ye,""+ee),Ce=ge[be],Le,Re=!1;return Ce!=null?(Le=Ce,Re=!0,c.pathCache=Le):(Le=new Path2D,ge[be]=c.pathCache=Le),{path:Le,cacheHit:Re}},fe=e.pstyle("shape").strValue,pe=e.pstyle("shape-polygon-points").pfValue;if(g){t.translate(f.x,f.y);var Te=oe(o,l,fe,pe);y=Te.path,b=Te.cacheHit}var Oe=function(){if(!b){var Ye=f;g&&(Ye={x:0,y:0}),s.nodeShapes[s.getNodeShape(e)].draw(y||t,Ye.x,Ye.y,o,l,ee,c)}g?t.fill(y):t.fill()},_e=function(){for(var Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m,De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,re=u.backgrounding,ue=0,ge=0;ge<P.length;ge++){var be=e.cy().style().getIndexedStyle(e,"background-image-containment","value",ge);if(De&&be==="over"||!De&&be==="inside"){ue++;continue}E[ge]&&P[ge].complete&&!P[ge].error&&(ue++,s.drawInscribedImage(t,P[ge],e,ge,Ye))}u.backgrounding=ue!==_,re!==u.backgrounding&&e.updateStyle(!1)},Ae=function(){var Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m;s.hasPie(e)&&(s.drawPie(t,e,De),Ye&&(g||s.nodeShapes[s.getNodeShape(e)].draw(t,f.x,f.y,o,l,ee,c)))},He=function(){var Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m;s.hasStripe(e)&&(t.save(),g?t.clip(c.pathCache):(s.nodeShapes[s.getNodeShape(e)].draw(t,f.x,f.y,o,l,ee,c),t.clip()),s.drawStripe(t,e,De),t.restore(),Ye&&(g||s.nodeShapes[s.getNodeShape(e)].draw(t,f.x,f.y,o,l,ee,c)))},tt=function(){var Ye=arguments.length>0&&arguments[0]!==void 0?arguments[0]:m,De=(U>0?U:-U)*Ye,re=U>0?0:255;U!==0&&(s.colorFillStyle(t,re,re,re,De),g?t.fill(y):t.fill())},Ie=function(){if(H>0){if(t.lineWidth=H,t.lineCap=W,t.lineJoin=G,t.setLineDash)switch(O){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash(X),t.lineDashOffset=Q;break;case"solid":case"double":t.setLineDash([]);break}if($!=="center"){if(t.save(),t.lineWidth*=2,$==="inside")g?t.clip(y):t.clip();else{var Ye=new Path2D;Ye.rect(-o/2-H,-l/2-H,o+2*H,l+2*H),Ye.addPath(y),t.clip(Ye,"evenodd")}g?t.stroke(y):t.stroke(),t.restore()}else g?t.stroke(y):t.stroke();if(O==="double"){t.lineWidth=H/3;var De=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",g?t.stroke(y):t.stroke(),t.globalCompositeOperation=De}t.setLineDash&&t.setLineDash([])}},ye=function(){if(Y>0){if(t.lineWidth=Y,t.lineCap="butt",t.setLineDash)switch(ie){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"solid":case"double":t.setLineDash([]);break}var Ye=f;g&&(Ye={x:0,y:0});var De=s.getNodeShape(e),re=H;$==="inside"&&(re=0),$==="outside"&&(re*=2);var ue=(o+re+(Y+he))/o,ge=(l+re+(Y+he))/l,be=o*ue,Ce=l*ge,Le=s.nodeShapes[De].points,Re;if(g){var Ze=oe(be,Ce,De,Le);Re=Ze.path}if(De==="ellipse")s.drawEllipsePath(Re||t,Ye.x,Ye.y,be,Ce);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(De)){var Je=0,dt=0,Nt=0;De==="round-diamond"?Je=(re+he+Y)*1.4:De==="round-heptagon"?(Je=(re+he+Y)*1.075,Nt=-(re/2+he+Y)/35):De==="round-hexagon"?Je=(re+he+Y)*1.12:De==="round-pentagon"?(Je=(re+he+Y)*1.13,Nt=-(re/2+he+Y)/15):De==="round-tag"?(Je=(re+he+Y)*1.12,dt=(re/2+Y+he)*.07):De==="round-triangle"&&(Je=(re+he+Y)*(Math.PI/2),Nt=-(re+he/2+Y)/Math.PI),Je!==0&&(ue=(o+Je)/o,be=o*ue,["round-hexagon","round-tag"].includes(De)||(ge=(l+Je)/l,Ce=l*ge)),ee=ee==="auto"?L6(be,Ce):ee;for(var Et=be/2,it=Ce/2,jt=ee+(re+Y+he)/2,Pt=new Array(Le.length/2),ar=new Array(Le.length/2),Xt=0;Xt<Le.length/2;Xt++)Pt[Xt]={x:Ye.x+dt+Et*Le[Xt*2],y:Ye.y+Nt+it*Le[Xt*2+1]};var $r,Er,Tr,Fr,xr=Pt.length;for(Er=Pt[xr-1],$r=0;$r<xr;$r++)Tr=Pt[$r%xr],Fr=Pt[($r+1)%xr],ar[$r]=GS(Er,Tr,Fr,jt),Er=Tr,Tr=Fr;s.drawRoundPolygonPath(Re||t,Ye.x+dt,Ye.y+Nt,o*ue,l*ge,Le,ar)}else if(["roundrectangle","round-rectangle"].includes(De))ee=ee==="auto"?zu(be,Ce):ee,s.drawRoundRectanglePath(Re||t,Ye.x,Ye.y,be,Ce,ee+(re+Y+he)/2);else if(["cutrectangle","cut-rectangle"].includes(De))ee=ee==="auto"?AS():ee,s.drawCutRectanglePath(Re||t,Ye.x,Ye.y,be,Ce,null,ee+(re+Y+he)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(De))ee=ee==="auto"?zu(be,Ce):ee,s.drawBottomRoundRectanglePath(Re||t,Ye.x,Ye.y,be,Ce,ee+(re+Y+he)/2);else if(De==="barrel")s.drawBarrelPath(Re||t,Ye.x,Ye.y,be,Ce);else if(De.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(De)){var Fi=(re+Y+he)/o;Le=Z0(ey(Le,Fi)),s.drawPolygonPath(Re||t,Ye.x,Ye.y,o,l,Le)}else{var br=(re+Y+he)/o;Le=Z0(ey(Le,-br)),s.drawPolygonPath(Re||t,Ye.x,Ye.y,o,l,Le)}if(g?t.stroke(Re):t.stroke(),ie==="double"){t.lineWidth=re/3;var Gn=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",g?t.stroke(Re):t.stroke(),t.globalCompositeOperation=Gn}t.setLineDash&&t.setLineDash([])}},Pe=function(){i&&s.drawNodeOverlay(t,e,f,o,l)},Be=function(){i&&s.drawNodeUnderlay(t,e,f,o,l)},Ge=function(){s.drawElementText(t,e,null,n)},et=e.pstyle("ghost").value==="yes";if(et){var mt=e.pstyle("ghost-offset-x").pfValue,gt=e.pstyle("ghost-offset-y").pfValue,bt=e.pstyle("ghost-opacity").value,_t=bt*m;t.translate(mt,gt),ae(),ye(),le(bt*M),Oe(),_e(_t,!0),te(bt*V),Ie(),Ae(U!==0||H!==0),He(U!==0||H!==0),_e(_t,!1),tt(_t),t.translate(-mt,-gt)}g&&t.translate(-f.x,-f.y),Be(),g&&t.translate(f.x,f.y),ae(),ye(),le(),Oe(),_e(m,!0),te(),Ie(),Ae(U!==0||H!==0),He(U!==0||H!==0),_e(m,!1),tt(),g&&t.translate(-f.x,-f.y),Ge(),Pe(),r&&t.translate(N.x1,N.y1)}};var Gj=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(r,n,i,a,s){var o=this;if(n.visible()){var l=n.pstyle("".concat(e,"-padding")).pfValue,u=n.pstyle("".concat(e,"-opacity")).value,c=n.pstyle("".concat(e,"-color")).value,f=n.pstyle("".concat(e,"-shape")).value,m=n.pstyle("".concat(e,"-corner-radius")).value;if(u>0){if(i=i||n.position(),a==null||s==null){var g=n.padding();a=n.width()+2*g,s=n.height()+2*g}o.colorFillStyle(r,c[0],c[1],c[2],u),o.nodeShapes[f].draw(r,i.x,i.y,a+l*2,s+l*2,m),r.fill()}}}};Qu.drawNodeOverlay=Gj("overlay");Qu.drawNodeUnderlay=Gj("underlay");Qu.hasPie=function(t){return t=t[0],t._private.hasPie};Qu.hasStripe=function(t){return t=t[0],t._private.hasStripe};Qu.drawPie=function(t,e,r,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=e.pstyle("pie-size"),s=e.pstyle("pie-hole"),o=e.pstyle("pie-start-angle").pfValue,l=n.x,u=n.y,c=e.width(),f=e.height(),m=Math.min(c,f)/2,g,y=0,b=this.usePaths();if(b&&(l=0,u=0),a.units==="%"?m=m*a.pfValue:a.pfValue!==void 0&&(m=a.pfValue/2),s.units==="%"?g=m*s.pfValue:s.pfValue!==void 0&&(g=s.pfValue/2),!(g>=m))for(var w=1;w<=i.pieBackgroundN;w++){var N=e.pstyle("pie-"+w+"-background-size").value,k=e.pstyle("pie-"+w+"-background-color").value,C=e.pstyle("pie-"+w+"-background-opacity").value*r,E=N/100;E+y>1&&(E=1-y);var P=1.5*Math.PI+2*Math.PI*y;P+=o;var _=2*Math.PI*E,A=P+_;N===0||y>=1||y+E>1||(g===0?(t.beginPath(),t.moveTo(l,u),t.arc(l,u,m,P,A),t.closePath()):(t.beginPath(),t.arc(l,u,m,P,A),t.arc(l,u,g,A,P,!0),t.closePath()),this.colorFillStyle(t,k[0],k[1],k[2],C),t.fill(),y+=E)}};Qu.drawStripe=function(t,e,r,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=n.x,s=n.y,o=e.width(),l=e.height(),u=0,c=this.usePaths();t.save();var f=e.pstyle("stripe-direction").value,m=e.pstyle("stripe-size");switch(f){case"vertical":break;case"righward":t.rotate(-Math.PI/2);break}var g=o,y=l;m.units==="%"?(g=g*m.pfValue,y=y*m.pfValue):m.pfValue!==void 0&&(g=m.pfValue,y=m.pfValue),c&&(a=0,s=0),s-=g/2,a-=y/2;for(var b=1;b<=i.stripeBackgroundN;b++){var w=e.pstyle("stripe-"+b+"-background-size").value,N=e.pstyle("stripe-"+b+"-background-color").value,k=e.pstyle("stripe-"+b+"-background-opacity").value*r,C=w/100;C+u>1&&(C=1-u),!(w===0||u>=1||u+C>1)&&(t.beginPath(),t.rect(a,s+y*u,g,y*C),t.closePath(),this.colorFillStyle(t,N[0],N[1],N[2],k),t.fill(),u+=C)}t.restore()};var na={},L7=100;na.getPixelRatio=function(){var t=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),r=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/r};na.paintCache=function(t){for(var e=this.paintCaches=this.paintCaches||[],r=!0,n,i=0;i<e.length;i++)if(n=e[i],n.context===t){r=!1;break}return r&&(n={context:t},e.push(n)),n};na.createGradientStyleFor=function(t,e,r,n,i){var a,s=this.usePaths(),o=r.pstyle(e+"-gradient-stop-colors").value,l=r.pstyle(e+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(r.isEdge()){var u=r.sourceEndpoint(),c=r.targetEndpoint(),f=r.midpoint(),m=cd(u,f),g=cd(c,f);a=t.createRadialGradient(f.x,f.y,0,f.x,f.y,Math.max(m,g))}else{var y=s?{x:0,y:0}:r.position(),b=r.paddedWidth(),w=r.paddedHeight();a=t.createRadialGradient(y.x,y.y,0,y.x,y.y,Math.max(b,w))}else if(r.isEdge()){var N=r.sourceEndpoint(),k=r.targetEndpoint();a=t.createLinearGradient(N.x,N.y,k.x,k.y)}else{var C=s?{x:0,y:0}:r.position(),E=r.paddedWidth(),P=r.paddedHeight(),_=E/2,A=P/2,I=r.pstyle("background-gradient-direction").value;switch(I){case"to-bottom":a=t.createLinearGradient(C.x,C.y-A,C.x,C.y+A);break;case"to-top":a=t.createLinearGradient(C.x,C.y+A,C.x,C.y-A);break;case"to-left":a=t.createLinearGradient(C.x+_,C.y,C.x-_,C.y);break;case"to-right":a=t.createLinearGradient(C.x-_,C.y,C.x+_,C.y);break;case"to-bottom-right":case"to-right-bottom":a=t.createLinearGradient(C.x-_,C.y-A,C.x+_,C.y+A);break;case"to-top-right":case"to-right-top":a=t.createLinearGradient(C.x-_,C.y+A,C.x+_,C.y-A);break;case"to-bottom-left":case"to-left-bottom":a=t.createLinearGradient(C.x+_,C.y-A,C.x-_,C.y+A);break;case"to-top-left":case"to-left-top":a=t.createLinearGradient(C.x+_,C.y+A,C.x-_,C.y-A);break}}if(!a)return null;for(var D=l.length===o.length,L=o.length,U=0;U<L;U++)a.addColorStop(D?l[U]:U/(L-1),"rgba("+o[U][0]+","+o[U][1]+","+o[U][2]+","+i+")");return a};na.gradientFillStyle=function(t,e,r,n){var i=this.createGradientStyleFor(t,"background",e,r,n);if(!i)return null;t.fillStyle=i};na.colorFillStyle=function(t,e,r,n,i){t.fillStyle="rgba("+e+","+r+","+n+","+i+")"};na.eleFillStyle=function(t,e,r){var n=e.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(t,e,n,r);else{var i=e.pstyle("background-color").value;this.colorFillStyle(t,i[0],i[1],i[2],r)}};na.gradientStrokeStyle=function(t,e,r,n){var i=this.createGradientStyleFor(t,"line",e,r,n);if(!i)return null;t.strokeStyle=i};na.colorStrokeStyle=function(t,e,r,n,i){t.strokeStyle="rgba("+e+","+r+","+n+","+i+")"};na.eleStrokeStyle=function(t,e,r){var n=e.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(t,e,n,r);else{var i=e.pstyle("line-color").value;this.colorStrokeStyle(t,i[0],i[1],i[2],r)}};na.matchCanvasSize=function(t){var e=this,r=e.data,n=e.findContainerClientCoords(),i=n[2],a=n[3],s=e.getPixelRatio(),o=e.motionBlurPxRatio;(t===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||t===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(s=o);var l=i*s,u=a*s,c;if(!(l===e.canvasWidth&&u===e.canvasHeight)){e.fontCaches=null;var f=r.canvasContainer;f.style.width=i+"px",f.style.height=a+"px";for(var m=0;m<e.CANVAS_LAYERS;m++)c=r.canvases[m],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=a+"px";for(var m=0;m<e.BUFFER_COUNT;m++)c=r.bufferCanvases[m],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=a+"px";e.textureMult=1,s<=1&&(c=r.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,c.width=l*e.textureMult,c.height=u*e.textureMult),e.canvasWidth=l,e.canvasHeight=u,e.pixelRatio=s}};na.renderTo=function(t,e,r,n){this.render({forcedContext:t,forcedZoom:e,forcedPan:r,drawAllLayers:!0,forcedPxRatio:n})};na.clearCanvas=function(){var t=this,e=t.data;function r(n){n.clearRect(0,0,t.canvasWidth,t.canvasHeight)}r(e.contexts[t.NODE]),r(e.contexts[t.DRAG])};na.render=function(t){var e=this;t=t||_6();var r=e.cy,n=t.forcedContext,i=t.drawAllLayers,a=t.drawOnlyNodeLayer,s=t.forcedZoom,o=t.forcedPan,l=t.forcedPxRatio===void 0?this.getPixelRatio():t.forcedPxRatio,u=e.data,c=u.canvasNeedsRedraw,f=e.textureOnViewport&&!n&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),m=t.motionBlur!==void 0?t.motionBlur:e.motionBlur,g=e.motionBlurPxRatio,y=r.hasCompoundNodes(),b=e.hoverData.draggingEles,w=!!(e.hoverData.selecting||e.touchData.selecting);m=m&&!n&&e.motionBlurEnabled&&!w;var N=m;n||(e.prevPxRatio!==l&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=l),!n&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),m&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(N=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!f&&(c[e.NODE]=!0,c[e.SELECT_BOX]=!0);var k=r.style(),C=r.zoom(),E=s!==void 0?s:C,P=r.pan(),_={x:P.x,y:P.y},A={zoom:C,pan:{x:P.x,y:P.y}},I=e.prevViewport,D=I===void 0||A.zoom!==I.zoom||A.pan.x!==I.pan.x||A.pan.y!==I.pan.y;!D&&!(b&&!y)&&(e.motionBlurPxRatio=1),o&&(_=o),E*=l,_.x*=l,_.y*=l;var L=e.getCachedZSortedEles();function U(te,ae,oe,fe,pe){var Te=te.globalCompositeOperation;te.globalCompositeOperation="destination-out",e.colorFillStyle(te,255,255,255,e.motionBlurTransparency),te.fillRect(ae,oe,fe,pe),te.globalCompositeOperation=Te}function H(te,ae){var oe,fe,pe,Te;!e.clearingMotionBlur&&(te===u.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||te===u.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(oe={x:P.x*g,y:P.y*g},fe=C*g,pe=e.canvasWidth*g,Te=e.canvasHeight*g):(oe=_,fe=E,pe=e.canvasWidth,Te=e.canvasHeight),te.setTransform(1,0,0,1,0,0),ae==="motionBlur"?U(te,0,0,pe,Te):!n&&(ae===void 0||ae)&&te.clearRect(0,0,pe,Te),i||(te.translate(oe.x,oe.y),te.scale(fe,fe)),o&&te.translate(o.x,o.y),s&&te.scale(s,s)}if(f||(e.textureDrawLastFrame=!1),f){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=r.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var M=e.data.bufferContexts[e.TEXTURE_BUFFER];M.setTransform(1,0,0,1,0,0),M.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:M,drawOnlyNodeLayer:!0,forcedPxRatio:l*e.textureMult});var A=e.textureCache.viewport={zoom:r.zoom(),pan:r.pan(),width:e.canvasWidth,height:e.canvasHeight};A.mpan={x:(0-A.pan.x)/A.zoom,y:(0-A.pan.y)/A.zoom}}c[e.DRAG]=!1,c[e.NODE]=!1;var z=u.contexts[e.NODE],O=e.textureCache.texture,A=e.textureCache.viewport;z.setTransform(1,0,0,1,0,0),m?U(z,0,0,A.width,A.height):z.clearRect(0,0,A.width,A.height);var G=k.core("outside-texture-bg-color").value,W=k.core("outside-texture-bg-opacity").value;e.colorFillStyle(z,G[0],G[1],G[2],W),z.fillRect(0,0,A.width,A.height);var C=r.zoom();H(z,!1),z.clearRect(A.mpan.x,A.mpan.y,A.width/A.zoom/l,A.height/A.zoom/l),z.drawImage(O,A.mpan.x,A.mpan.y,A.width/A.zoom/l,A.height/A.zoom/l)}else e.textureOnViewport&&!n&&(e.textureCache=null);var $=r.extent(),X=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),Q=e.hideEdgesOnViewport&&X,V=[];if(V[e.NODE]=!c[e.NODE]&&m&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,V[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),V[e.DRAG]=!c[e.DRAG]&&m&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,V[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),c[e.NODE]||i||a||V[e.NODE]){var Y=m&&!V[e.NODE]&&g!==1,z=n||(Y?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:u.contexts[e.NODE]),Z=m&&!Y?"motionBlur":void 0;H(z,Z),Q?e.drawCachedNodes(z,L.nondrag,l,$):e.drawLayeredElements(z,L.nondrag,l,$),e.debug&&e.drawDebugPoints(z,L.nondrag),!i&&!m&&(c[e.NODE]=!1)}if(!a&&(c[e.DRAG]||i||V[e.DRAG])){var Y=m&&!V[e.DRAG]&&g!==1,z=n||(Y?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:u.contexts[e.DRAG]);H(z,m&&!Y?"motionBlur":void 0),Q?e.drawCachedNodes(z,L.drag,l,$):e.drawCachedElements(z,L.drag,l,$),e.debug&&e.drawDebugPoints(z,L.drag),!i&&!m&&(c[e.DRAG]=!1)}if(this.drawSelectionRectangle(t,H),m&&g!==1){var ie=u.contexts[e.NODE],ce=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],he=u.contexts[e.DRAG],ee=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],le=function(ae,oe,fe){ae.setTransform(1,0,0,1,0,0),fe||!N?ae.clearRect(0,0,e.canvasWidth,e.canvasHeight):U(ae,0,0,e.canvasWidth,e.canvasHeight);var pe=g;ae.drawImage(oe,0,0,e.canvasWidth*pe,e.canvasHeight*pe,0,0,e.canvasWidth,e.canvasHeight)};(c[e.NODE]||V[e.NODE])&&(le(ie,ce,V[e.NODE]),c[e.NODE]=!1),(c[e.DRAG]||V[e.DRAG])&&(le(he,ee,V[e.DRAG]),c[e.DRAG]=!1)}e.prevViewport=A,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),m&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!f,e.mbFrames=0,c[e.NODE]=!0,c[e.DRAG]=!0,e.redraw()},L7)),n||r.emit("render")};var jp;na.drawSelectionRectangle=function(t,e){var r=this,n=r.cy,i=r.data,a=n.style(),s=t.drawOnlyNodeLayer,o=t.drawAllLayers,l=i.canvasNeedsRedraw,u=t.forcedContext;if(r.showFps||!s&&l[r.SELECT_BOX]&&!o){var c=u||i.contexts[r.SELECT_BOX];if(e(c),r.selection[4]==1&&(r.hoverData.selecting||r.touchData.selecting)){var f=r.cy.zoom(),m=a.core("selection-box-border-width").value/f;c.lineWidth=m,c.fillStyle="rgba("+a.core("selection-box-color").value[0]+","+a.core("selection-box-color").value[1]+","+a.core("selection-box-color").value[2]+","+a.core("selection-box-opacity").value+")",c.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]),m>0&&(c.strokeStyle="rgba("+a.core("selection-box-border-color").value[0]+","+a.core("selection-box-border-color").value[1]+","+a.core("selection-box-border-color").value[2]+","+a.core("selection-box-opacity").value+")",c.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]))}if(i.bgActivePosistion&&!r.hoverData.selecting){var f=r.cy.zoom(),g=i.bgActivePosistion;c.fillStyle="rgba("+a.core("active-bg-color").value[0]+","+a.core("active-bg-color").value[1]+","+a.core("active-bg-color").value[2]+","+a.core("active-bg-opacity").value+")",c.beginPath(),c.arc(g.x,g.y,a.core("active-bg-size").pfValue/f,0,2*Math.PI),c.fill()}var y=r.lastRedrawTime;if(r.showFps&&y){y=Math.round(y);var b=Math.round(1e3/y),w="1 frame = "+y+" ms = "+b+" fps";if(c.setTransform(1,0,0,1,0,0),c.fillStyle="rgba(255, 0, 0, 0.75)",c.strokeStyle="rgba(255, 0, 0, 0.75)",c.font="30px Arial",!jp){var N=c.measureText(w);jp=N.actualBoundingBoxAscent}c.fillText(w,0,jp);var k=60;c.strokeRect(0,jp+10,250,20),c.fillRect(0,jp+10,250*Math.min(b/k,1),20)}o||(l[r.SELECT_BOX]=!1)}};function hE(t,e,r){var n=t.createShader(e);if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n));return n}function B7(t,e,r){var n=hE(t,t.VERTEX_SHADER,e),i=hE(t,t.FRAGMENT_SHADER,r),a=t.createProgram();if(t.attachShader(a,n),t.attachShader(a,i),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new Error("Could not initialize shaders");return a}function F7(t,e,r){r===void 0&&(r=e);var n=t.makeOffscreenCanvas(e,r),i=n.context=n.getContext("2d");return n.clear=function(){return i.clearRect(0,0,n.width,n.height)},n.clear(),n}function WS(t){var e=t.pixelRatio,r=t.cy.zoom(),n=t.cy.pan();return{zoom:r*e,pan:{x:n.x*e,y:n.y*e}}}function z7(t){var e=t.pixelRatio,r=t.cy.zoom();return r*e}function V7(t,e,r,n,i){var a=n*r+e.x,s=i*r+e.y;return s=Math.round(t.canvasHeight-s),[a,s]}function U7(t){return t.pstyle("background-fill").value!=="solid"||t.pstyle("background-image").strValue!=="none"?!1:t.pstyle("border-width").value===0||t.pstyle("border-opacity").value===0?!0:t.pstyle("border-style").value==="solid"}function G7(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function zc(t,e,r){var n=t[0]/255,i=t[1]/255,a=t[2]/255,s=e,o=r||new Array(4);return o[0]=n*s,o[1]=i*s,o[2]=a*s,o[3]=s,o}function Mf(t,e){var r=e||new Array(4);return r[0]=(t>>0&255)/255,r[1]=(t>>8&255)/255,r[2]=(t>>16&255)/255,r[3]=(t>>24&255)/255,r}function H7(t){return t[0]+(t[1]<<8)+(t[2]<<16)+(t[3]<<24)}function q7(t,e){var r=t.createTexture();return r.buffer=function(n){t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)},r.deleteTexture=function(){t.deleteTexture(r)},r}function Hj(t,e){switch(e){case"float":return[1,t.FLOAT,4];case"vec2":return[2,t.FLOAT,4];case"vec3":return[3,t.FLOAT,4];case"vec4":return[4,t.FLOAT,4];case"int":return[1,t.INT,4];case"ivec2":return[2,t.INT,4]}}function qj(t,e,r){switch(e){case t.FLOAT:return new Float32Array(r);case t.INT:return new Int32Array(r)}}function W7(t,e,r,n,i,a){switch(e){case t.FLOAT:return new Float32Array(r.buffer,a*n,i);case t.INT:return new Int32Array(r.buffer,a*n,i)}}function $7(t,e,r,n){var i=Hj(t,e),a=Pn(i,2),s=a[0],o=a[1],l=qj(t,o,n),u=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,l,t.STATIC_DRAW),o===t.FLOAT?t.vertexAttribPointer(r,s,o,!1,0,0):o===t.INT&&t.vertexAttribIPointer(r,s,o,0,0),t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,null),u}function fo(t,e,r,n){var i=Hj(t,r),a=Pn(i,3),s=a[0],o=a[1],l=a[2],u=qj(t,o,e*s),c=s*l,f=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,f),t.bufferData(t.ARRAY_BUFFER,e*c,t.DYNAMIC_DRAW),t.enableVertexAttribArray(n),o===t.FLOAT?t.vertexAttribPointer(n,s,o,!1,c,0):o===t.INT&&t.vertexAttribIPointer(n,s,o,c,0),t.vertexAttribDivisor(n,1),t.bindBuffer(t.ARRAY_BUFFER,null);for(var m=new Array(e),g=0;g<e;g++)m[g]=W7(t,o,u,c,s,g);return f.dataArray=u,f.stride=c,f.size=s,f.getView=function(y){return m[y]},f.setPoint=function(y,b,w){var N=m[y];N[0]=b,N[1]=w},f.bufferSubData=function(y){t.bindBuffer(t.ARRAY_BUFFER,f),y?t.bufferSubData(t.ARRAY_BUFFER,0,u,0,y*s):t.bufferSubData(t.ARRAY_BUFFER,0,u)},f}function K7(t,e,r){for(var n=9,i=new Float32Array(e*n),a=new Array(e),s=0;s<e;s++){var o=s*n*4;a[s]=new Float32Array(i.buffer,o,n)}var l=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferData(t.ARRAY_BUFFER,i.byteLength,t.DYNAMIC_DRAW);for(var u=0;u<3;u++){var c=r+u;t.enableVertexAttribArray(c),t.vertexAttribPointer(c,3,t.FLOAT,!1,36,u*12),t.vertexAttribDivisor(c,1)}return t.bindBuffer(t.ARRAY_BUFFER,null),l.getMatrixView=function(f){return a[f]},l.setData=function(f,m){a[m].set(f,0)},l.bufferSubData=function(){t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferSubData(t.ARRAY_BUFFER,0,i)},l}function Y7(t){var e=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.bindFramebuffer(t.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(n,i){t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,i,0,t.RGBA,t.UNSIGNED_BYTE,null)},e}var pE=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Zb(){var t=new pE(9);return pE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function mE(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function X7(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=e[8],m=r[0],g=r[1],y=r[2],b=r[3],w=r[4],N=r[5],k=r[6],C=r[7],E=r[8];return t[0]=m*n+g*s+y*u,t[1]=m*i+g*o+y*c,t[2]=m*a+g*l+y*f,t[3]=b*n+w*s+N*u,t[4]=b*i+w*o+N*c,t[5]=b*a+w*l+N*f,t[6]=k*n+C*s+E*u,t[7]=k*i+C*o+E*c,t[8]=k*a+C*l+E*f,t}function B0(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=e[8],m=r[0],g=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=s,t[4]=o,t[5]=l,t[6]=m*n+g*s+u,t[7]=m*i+g*o+c,t[8]=m*a+g*l+f,t}function gE(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=e[8],m=Math.sin(r),g=Math.cos(r);return t[0]=g*n+m*s,t[1]=g*i+m*o,t[2]=g*a+m*l,t[3]=g*s-m*n,t[4]=g*o-m*i,t[5]=g*l-m*a,t[6]=u,t[7]=c,t[8]=f,t}function j2(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Q7(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}var J7=(function(){function t(e,r,n,i){Ku(this,t),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.texSize=r,this.texRows=n,this.texHeight=Math.floor(r/n),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=i(e,r,r),this.scratch=i(e,r,this.texHeight,"scratch")}return Yu(t,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(r){var n=r.w,i=r.h,a=this.texHeight,s=this.texSize,o=a/i,l=n*o,u=i*o;return l>s&&(o=s/n,l=n*o,u=i*o),{scale:o,texW:l,texH:u}}},{key:"draw",value:function(r,n,i){var a=this;if(this.locked)throw new Error("can't draw, atlas is locked");var s=this.texSize,o=this.texRows,l=this.texHeight,u=this.getScale(n),c=u.scale,f=u.texW,m=u.texH,g=function(C,E){if(i&&E){var P=E.context,_=C.x,A=C.row,I=_,D=l*A;P.save(),P.translate(I,D),P.scale(c,c),i(P,n),P.restore()}},y=[null,null],b=function(){g(a.freePointer,a.canvas),y[0]={x:a.freePointer.x,y:a.freePointer.row*l,w:f,h:m},y[1]={x:a.freePointer.x+f,y:a.freePointer.row*l,w:0,h:m},a.freePointer.x+=f,a.freePointer.x==s&&(a.freePointer.x=0,a.freePointer.row++)},w=function(){var C=a.scratch,E=a.canvas;C.clear(),g({x:0,row:0},C);var P=s-a.freePointer.x,_=f-P,A=l;{var I=a.freePointer.x,D=a.freePointer.row*l,L=P;E.context.drawImage(C,0,0,L,A,I,D,L,A),y[0]={x:I,y:D,w:L,h:m}}{var U=P,H=(a.freePointer.row+1)*l,M=_;E&&E.context.drawImage(C,U,0,M,A,0,H,M,A),y[1]={x:0,y:H,w:M,h:m}}a.freePointer.x=_,a.freePointer.row++},N=function(){a.freePointer.x=0,a.freePointer.row++};if(this.freePointer.x+f<=s)b();else{if(this.freePointer.row>=o-1)return!1;this.freePointer.x===s?(N(),b()):this.enableWrapping?w():(N(),b())}return this.keyToLocation.set(r,y),this.needsBuffer=!0,y}},{key:"getOffsets",value:function(r){return this.keyToLocation.get(r)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(r){if(this.locked)return!1;var n=this.texSize,i=this.texRows,a=this.getScale(r),s=a.texW;return this.freePointer.x+s>n?this.freePointer.row<i-1:!0}},{key:"bufferIfNeeded",value:function(r){this.texture||(this.texture=q7(r,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])})(),Z7=(function(){function t(e,r,n,i){Ku(this,t),this.r=e,this.texSize=r,this.texRows=n,this.createTextureCanvas=i,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return Yu(t,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var r=this.r,n=this.texSize,i=this.texRows,a=this.createTextureCanvas;return new J7(r,n,i,a)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var r=this.r,n=this.texSize,i=this.texRows,a=this.createTextureCanvas,s=Math.floor(n/i);this.scratch=a(r,n,s,"scratch")}return this.scratch}},{key:"draw",value:function(r,n,i){var a=this.styleKeyToAtlas.get(r);return a||(a=this.atlases[this.atlases.length-1],(!a||!a.canFit(n))&&(a&&a.lock(),a=this._createAtlas(),this.atlases.push(a)),a.draw(r,n,i),this.styleKeyToAtlas.set(r,a)),a}},{key:"getAtlas",value:function(r){return this.styleKeyToAtlas.get(r)}},{key:"hasAtlas",value:function(r){return this.styleKeyToAtlas.has(r)}},{key:"markKeyForGC",value:function(r){this.markedKeys.add(r)}},{key:"gc",value:function(){var r=this,n=this.markedKeys;if(n.size===0){console.log("nothing to garbage collect");return}var i=[],a=new Map,s=null,o=wa(this.atlases),l;try{var u=function(){var f=l.value,m=f.getKeys(),g=eB(n,m);if(g.size===0)return i.push(f),m.forEach(function(P){return a.set(P,f)}),1;s||(s=r._createAtlas(),i.push(s));var y=wa(m),b;try{for(y.s();!(b=y.n()).done;){var w=b.value;if(!g.has(w)){var N=f.getOffsets(w),k=Pn(N,2),C=k[0],E=k[1];s.canFit({w:C.w+E.w,h:C.h})||(s.lock(),s=r._createAtlas(),i.push(s)),f.canvas&&(r._copyTextureToNewAtlas(w,f,s),a.set(w,s))}}}catch(P){y.e(P)}finally{y.f()}f.dispose()};for(o.s();!(l=o.n()).done;)u()}catch(c){o.e(c)}finally{o.f()}this.atlases=i,this.styleKeyToAtlas=a,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(r,n,i){var a=n.getOffsets(r),s=Pn(a,2),o=s[0],l=s[1];if(l.w===0)i.draw(r,o,function(m){m.drawImage(n.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h)});else{var u=this._getScratchCanvas();u.clear(),u.context.drawImage(n.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h),u.context.drawImage(n.canvas,l.x,l.y,l.w,l.h,o.w,0,l.w,l.h);var c=o.w+l.w,f=o.h;i.draw(r,{w:c,h:f},function(m){m.drawImage(u,0,0,c,f,0,0,c,f)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])})();function eB(t,e){return t.intersection?t.intersection(e):new Set(Y0(t).filter(function(r){return e.has(r)}))}var tB=(function(){function t(e,r){Ku(this,t),this.r=e,this.globalOptions=r,this.atlasSize=r.webglTexSize,this.maxAtlasesPerBatch=r.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return Yu(t,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(r,n){var i=this.globalOptions,a=i.webglTexSize,s=i.createTextureCanvas,o=n.texRows,l=this._cacheScratchCanvas(s),u=new Z7(this.r,a,o,l);this.collections.set(r,u)}},{key:"addRenderType",value:function(r,n){var i=n.collection;if(!this.collections.has(i))throw new Error("invalid atlas collection name '".concat(i,"'"));var a=this.collections.get(i),s=Ct({type:r,atlasCollection:a},n);this.renderTypes.set(r,s)}},{key:"getRenderTypeOpts",value:function(r){return this.renderTypes.get(r)}},{key:"getAtlasCollection",value:function(r){return this.collections.get(r)}},{key:"_cacheScratchCanvas",value:function(r){var n=-1,i=-1,a=null;return function(s,o,l,u){return u?((!a||o!=n||l!=i)&&(n=o,i=l,a=r(s,o,l)),a):r(s,o,l)}}},{key:"_key",value:function(r,n){return"".concat(r,"-").concat(n)}},{key:"invalidate",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.forceRedraw,s=a===void 0?!1:a,o=i.filterEle,l=o===void 0?function(){return!0}:o,u=i.filterType,c=u===void 0?function(){return!0}:u,f=!1,m=!1,g=wa(r),y;try{for(g.s();!(y=g.n()).done;){var b=y.value;if(l(b)){var w=wa(this.renderTypes.values()),N;try{var k=function(){var E=N.value,P=E.type;if(c(P)){var _=n.collections.get(E.collection),A=E.getKey(b),I=Array.isArray(A)?A:[A];if(s)I.forEach(function(H){return _.markKeyForGC(H)}),m=!0;else{var D=E.getID?E.getID(b):b.id(),L=n._key(P,D),U=n.typeAndIdToKey.get(L);U!==void 0&&!G7(I,U)&&(f=!0,n.typeAndIdToKey.delete(L),U.forEach(function(H){return _.markKeyForGC(H)}))}}};for(w.s();!(N=w.n()).done;)k()}catch(C){w.e(C)}finally{w.f()}}}}catch(C){g.e(C)}finally{g.f()}return m&&(this.gc(),f=!1),f}},{key:"gc",value:function(){var r=wa(this.collections.values()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;i.gc()}}catch(a){r.e(a)}finally{r.f()}}},{key:"getOrCreateAtlas",value:function(r,n,i,a){var s=this.renderTypes.get(n),o=this.collections.get(s.collection),l=!1,u=o.draw(a,i,function(m){s.drawClipped?(m.save(),m.beginPath(),m.rect(0,0,i.w,i.h),m.clip(),s.drawElement(m,r,i,!0,!0),m.restore()):s.drawElement(m,r,i,!0,!0),l=!0});if(l){var c=s.getID?s.getID(r):r.id(),f=this._key(n,c);this.typeAndIdToKey.has(f)?this.typeAndIdToKey.get(f).push(a):this.typeAndIdToKey.set(f,[a])}return u}},{key:"getAtlasInfo",value:function(r,n){var i=this,a=this.renderTypes.get(n),s=a.getKey(r),o=Array.isArray(s)?s:[s];return o.map(function(l){var u=a.getBoundingBox(r,l),c=i.getOrCreateAtlas(r,n,u,l),f=c.getOffsets(l),m=Pn(f,2),g=m[0],y=m[1];return{atlas:c,tex:g,tex1:g,tex2:y,bb:u}})}},{key:"getDebugInfo",value:function(){var r=[],n=wa(this.collections),i;try{for(n.s();!(i=n.n()).done;){var a=Pn(i.value,2),s=a[0],o=a[1],l=o.getCounts(),u=l.keyCount,c=l.atlasCount;r.push({type:s,keyCount:u,atlasCount:c})}}catch(f){n.e(f)}finally{n.f()}return r}}])})(),rB=(function(){function t(e){Ku(this,t),this.globalOptions=e,this.atlasSize=e.webglTexSize,this.maxAtlasesPerBatch=e.webglTexPerBatch,this.batchAtlases=[]}return Yu(t,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(r,n){return n})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(r){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(r):!0}},{key:"getAtlasIndexForBatch",value:function(r){var n=this.batchAtlases.indexOf(r);if(n<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(r),n=this.batchAtlases.length-1}return n}}])})(),nB=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,iB=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,aB=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,sB=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,Lm={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},oy={IGNORE:1,USE_BB:2},ew=0,vE=1,yE=2,tw=3,_f=4,s0=5,Pp=6,Mp=7,oB=(function(){function t(e,r,n){Ku(this,t),this.r=e,this.gl=r,this.maxInstances=n.webglBatchSize,this.atlasSize=n.webglTexSize,this.bgColor=n.bgColor,this.debug=n.webglDebug,this.batchDebugInfo=[],n.enableWrapping=!0,n.createTextureCanvas=F7,this.atlasManager=new tB(e,n),this.batchManager=new rB(n),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(Lm.SCREEN),this.pickingProgram=this._createShaderProgram(Lm.PICKING),this.vao=this._createVAO()}return Yu(t,[{key:"addAtlasCollection",value:function(r,n){this.atlasManager.addAtlasCollection(r,n)}},{key:"addTextureAtlasRenderType",value:function(r,n){this.atlasManager.addRenderType(r,n)}},{key:"addSimpleShapeRenderType",value:function(r,n){this.simpleShapeOptions.set(r,n)}},{key:"invalidate",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.type,a=this.atlasManager;return i?a.invalidate(r,{filterType:function(o){return o===i},forceRedraw:!0}):a.invalidate(r)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(r){var n=this.gl,i=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(ew,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(_f," || aVertType == ").concat(Mp,` 
             || aVertType == `).concat(s0," || aVertType == ").concat(Pp,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(vE,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(yE,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(tw,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),a=this.batchManager.getIndexArray(),s=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(a.map(function(u){return"uniform sampler2D uTexture".concat(u,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(nB,`
      `).concat(iB,`
      `).concat(aB,`
      `).concat(sB,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(ew,`) {
          // look up the texel from the texture unit
          `).concat(a.map(function(u){return"if(vAtlasId == ".concat(u,") outColor = texture(uTexture").concat(u,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(tw,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(_f,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(_f," || vVertType == ").concat(Mp,` 
          || vVertType == `).concat(s0," || vVertType == ").concat(Pp,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(_f,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(Mp,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(Mp,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(r.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),o=B7(n,i,s);o.aPosition=n.getAttribLocation(o,"aPosition"),o.aIndex=n.getAttribLocation(o,"aIndex"),o.aVertType=n.getAttribLocation(o,"aVertType"),o.aTransform=n.getAttribLocation(o,"aTransform"),o.aAtlasId=n.getAttribLocation(o,"aAtlasId"),o.aTex=n.getAttribLocation(o,"aTex"),o.aPointAPointB=n.getAttribLocation(o,"aPointAPointB"),o.aPointCPointD=n.getAttribLocation(o,"aPointCPointD"),o.aLineWidth=n.getAttribLocation(o,"aLineWidth"),o.aColor=n.getAttribLocation(o,"aColor"),o.aCornerRadius=n.getAttribLocation(o,"aCornerRadius"),o.aBorderColor=n.getAttribLocation(o,"aBorderColor"),o.uPanZoomMatrix=n.getUniformLocation(o,"uPanZoomMatrix"),o.uAtlasSize=n.getUniformLocation(o,"uAtlasSize"),o.uBGColor=n.getUniformLocation(o,"uBGColor"),o.uZoom=n.getUniformLocation(o,"uZoom"),o.uTextures=[];for(var l=0;l<this.batchManager.getMaxAtlasesPerBatch();l++)o.uTextures.push(n.getUniformLocation(o,"uTexture".concat(l)));return o}},{key:"_createVAO",value:function(){var r=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=r.length/2;var n=this.maxInstances,i=this.gl,a=this.program,s=i.createVertexArray();return i.bindVertexArray(s),$7(i,"vec2",a.aPosition,r),this.transformBuffer=K7(i,n,a.aTransform),this.indexBuffer=fo(i,n,"vec4",a.aIndex),this.vertTypeBuffer=fo(i,n,"int",a.aVertType),this.atlasIdBuffer=fo(i,n,"int",a.aAtlasId),this.texBuffer=fo(i,n,"vec4",a.aTex),this.pointAPointBBuffer=fo(i,n,"vec4",a.aPointAPointB),this.pointCPointDBuffer=fo(i,n,"vec4",a.aPointCPointD),this.lineWidthBuffer=fo(i,n,"vec2",a.aLineWidth),this.colorBuffer=fo(i,n,"vec4",a.aColor),this.cornerRadiusBuffer=fo(i,n,"vec4",a.aCornerRadius),this.borderColorBuffer=fo(i,n,"vec4",a.aBorderColor),i.bindVertexArray(null),s}},{key:"buffers",get:function(){var r=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(n){return Nu(n,"Buffer")}).map(function(n){return r[n]})),this._buffers}},{key:"startFrame",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Lm.SCREEN;this.panZoomMatrix=r,this.renderTarget=n,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(r,n){return r.visible()?n&&n.isVisible?n.isVisible(r):!0:!1}},{key:"drawTexture",value:function(r,n,i){var a=this.atlasManager,s=this.batchManager,o=a.getRenderTypeOpts(i);if(this._isVisible(r,o)&&!(r.isEdge()&&!this._isValidEdge(r))){if(this.renderTarget.picking&&o.getTexPickingMode){var l=o.getTexPickingMode(r);if(l===oy.IGNORE)return;if(l==oy.USE_BB){this.drawPickingRectangle(r,n,i);return}}var u=a.getAtlasInfo(r,i),c=wa(u),f;try{for(c.s();!(f=c.n()).done;){var m=f.value,g=m.atlas,y=m.tex1,b=m.tex2;s.canAddToCurrentBatch(g)||this.endBatch();for(var w=s.getAtlasIndexForBatch(g),N=0,k=[[y,!0],[b,!1]];N<k.length;N++){var C=Pn(k[N],2),E=C[0],P=C[1];if(E.w!=0){var _=this.instanceCount;this.vertTypeBuffer.getView(_)[0]=ew;var A=this.indexBuffer.getView(_);Mf(n,A);var I=this.atlasIdBuffer.getView(_);I[0]=w;var D=this.texBuffer.getView(_);D[0]=E.x,D[1]=E.y,D[2]=E.w,D[3]=E.h;var L=this.transformBuffer.getMatrixView(_);this.setTransformMatrix(r,L,o,m,P),this.instanceCount++,P||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(U){c.e(U)}finally{c.f()}}}},{key:"setTransformMatrix",value:function(r,n,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=0;if(i.shapeProps&&i.shapeProps.padding&&(o=r.pstyle(i.shapeProps.padding).pfValue),a){var l=a.bb,u=a.tex1,c=a.tex2,f=u.w/(u.w+c.w);s||(f=1-f);var m=this._getAdjustedBB(l,o,s,f);this._applyTransformMatrix(n,m,i,r)}else{var g=i.getBoundingBox(r),y=this._getAdjustedBB(g,o,!0,1);this._applyTransformMatrix(n,y,i,r)}}},{key:"_applyTransformMatrix",value:function(r,n,i,a){var s,o;mE(r);var l=i.getRotation?i.getRotation(a):0;if(l!==0){var u=i.getRotationPoint(a),c=u.x,f=u.y;B0(r,r,[c,f]),gE(r,r,l);var m=i.getRotationOffset(a);s=m.x+(n.xOffset||0),o=m.y+(n.yOffset||0)}else s=n.x1,o=n.y1;B0(r,r,[s,o]),j2(r,r,[n.w,n.h])}},{key:"_getAdjustedBB",value:function(r,n,i,a){var s=r.x1,o=r.y1,l=r.w,u=r.h,c=r.yOffset;n&&(s-=n,o-=n,l+=2*n,u+=2*n);var f=0,m=l*a;return i&&a<1?l=m:!i&&a<1&&(f=l-m,s+=f,l=m),{x1:s,y1:o,w:l,h:u,xOffset:f,yOffset:c}}},{key:"drawPickingRectangle",value:function(r,n,i){var a=this.atlasManager.getRenderTypeOpts(i),s=this.instanceCount;this.vertTypeBuffer.getView(s)[0]=_f;var o=this.indexBuffer.getView(s);Mf(n,o);var l=this.colorBuffer.getView(s);zc([0,0,0],1,l);var u=this.transformBuffer.getMatrixView(s);this.setTransformMatrix(r,u,a),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(r,n,i){var a=this.simpleShapeOptions.get(i);if(this._isVisible(r,a)){var s=a.shapeProps,o=this._getVertTypeForShape(r,s.shape);if(o===void 0||a.isSimple&&!a.isSimple(r)){this.drawTexture(r,n,i);return}var l=this.instanceCount;if(this.vertTypeBuffer.getView(l)[0]=o,o===s0||o===Pp){var u=a.getBoundingBox(r),c=this._getCornerRadius(r,s.radius,u),f=this.cornerRadiusBuffer.getView(l);f[0]=c,f[1]=c,f[2]=c,f[3]=c,o===Pp&&(f[0]=0,f[2]=0)}var m=this.indexBuffer.getView(l);Mf(n,m);var g=r.pstyle(s.color).value,y=r.pstyle(s.opacity).value,b=this.colorBuffer.getView(l);zc(g,y,b);var w=this.lineWidthBuffer.getView(l);if(w[0]=0,w[1]=0,s.border){var N=r.pstyle("border-width").value;if(N>0){var k=r.pstyle("border-color").value,C=r.pstyle("border-opacity").value,E=this.borderColorBuffer.getView(l);zc(k,C,E);var P=r.pstyle("border-position").value;if(P==="inside")w[0]=0,w[1]=-N;else if(P==="outside")w[0]=N,w[1]=0;else{var _=N/2;w[0]=_,w[1]=-_}}}var A=this.transformBuffer.getMatrixView(l);this.setTransformMatrix(r,A,a),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(r,n){var i=r.pstyle(n).value;switch(i){case"rectangle":return _f;case"ellipse":return Mp;case"roundrectangle":case"round-rectangle":return s0;case"bottom-round-rectangle":return Pp;default:return}}},{key:"_getCornerRadius",value:function(r,n,i){var a=i.w,s=i.h;if(r.pstyle(n).value==="auto")return zu(a,s);var o=r.pstyle(n).pfValue,l=a/2,u=s/2;return Math.min(o,u,l)}},{key:"drawEdgeArrow",value:function(r,n,i){if(r.visible()){var a=r._private.rscratch,s,o,l;if(i==="source"?(s=a.arrowStartX,o=a.arrowStartY,l=a.srcArrowAngle):(s=a.arrowEndX,o=a.arrowEndY,l=a.tgtArrowAngle),!(isNaN(s)||s==null||isNaN(o)||o==null||isNaN(l)||l==null)){var u=r.pstyle(i+"-arrow-shape").value;if(u!=="none"){var c=r.pstyle(i+"-arrow-color").value,f=r.pstyle("opacity").value,m=r.pstyle("line-opacity").value,g=f*m,y=r.pstyle("width").pfValue,b=r.pstyle("arrow-scale").value,w=this.r.getArrowWidth(y,b),N=this.instanceCount,k=this.transformBuffer.getMatrixView(N);mE(k),B0(k,k,[s,o]),j2(k,k,[w,w]),gE(k,k,l),this.vertTypeBuffer.getView(N)[0]=tw;var C=this.indexBuffer.getView(N);Mf(n,C);var E=this.colorBuffer.getView(N);zc(c,g,E),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(r,n){if(r.visible()){var i=this._getEdgePoints(r);if(i){var a=r.pstyle("opacity").value,s=r.pstyle("line-opacity").value,o=r.pstyle("width").pfValue,l=r.pstyle("line-color").value,u=a*s;if(i.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),i.length==4){var c=this.instanceCount;this.vertTypeBuffer.getView(c)[0]=vE;var f=this.indexBuffer.getView(c);Mf(n,f);var m=this.colorBuffer.getView(c);zc(l,u,m);var g=this.lineWidthBuffer.getView(c);g[0]=o;var y=this.pointAPointBBuffer.getView(c);y[0]=i[0],y[1]=i[1],y[2]=i[2],y[3]=i[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var b=0;b<i.length-2;b+=2){var w=this.instanceCount;this.vertTypeBuffer.getView(w)[0]=yE;var N=this.indexBuffer.getView(w);Mf(n,N);var k=this.colorBuffer.getView(w);zc(l,u,k);var C=this.lineWidthBuffer.getView(w);C[0]=o;var E=i[b-2],P=i[b-1],_=i[b],A=i[b+1],I=i[b+2],D=i[b+3],L=i[b+4],U=i[b+5];b==0&&(E=2*_-I+.001,P=2*A-D+.001),b==i.length-4&&(L=2*I-_+.001,U=2*D-A+.001);var H=this.pointAPointBBuffer.getView(w);H[0]=E,H[1]=P,H[2]=_,H[3]=A;var M=this.pointCPointDBuffer.getView(w);M[0]=I,M[1]=D,M[2]=L,M[3]=U,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_isValidEdge",value:function(r){var n=r._private.rscratch;return!(n.badLine||n.allpts==null||isNaN(n.allpts[0]))}},{key:"_getEdgePoints",value:function(r){var n=r._private.rscratch;if(this._isValidEdge(r)){var i=n.allpts;if(i.length==4)return i;var a=this._getNumSegments(r);return this._getCurveSegmentPoints(i,a)}}},{key:"_getNumSegments",value:function(r){var n=15;return Math.min(Math.max(n,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(r,n){if(r.length==4)return r;for(var i=Array((n+1)*2),a=0;a<=n;a++)if(a==0)i[0]=r[0],i[1]=r[1];else if(a==n)i[a*2]=r[r.length-2],i[a*2+1]=r[r.length-1];else{var s=a/n;this._setCurvePoint(r,s,i,a*2)}return i}},{key:"_setCurvePoint",value:function(r,n,i,a){if(r.length<=2)i[a]=r[0],i[a+1]=r[1];else{for(var s=Array(r.length-2),o=0;o<s.length;o+=2){var l=(1-n)*r[o]+n*r[o+2],u=(1-n)*r[o+1]+n*r[o+3];s[o]=l,s[o+1]=u}return this._setCurvePoint(s,n,i,a)}}},{key:"endBatch",value:function(){var r=this.gl,n=this.vao,i=this.vertexCount,a=this.instanceCount;if(a!==0){var s=this.renderTarget.picking?this.pickingProgram:this.program;r.useProgram(s),r.bindVertexArray(n);var o=wa(this.buffers),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;u.bufferSubData(a)}}catch(y){o.e(y)}finally{o.f()}for(var c=this.batchManager.getAtlases(),f=0;f<c.length;f++)c[f].bufferIfNeeded(r);for(var m=0;m<c.length;m++)r.activeTexture(r.TEXTURE0+m),r.bindTexture(r.TEXTURE_2D,c[m].texture),r.uniform1i(s.uTextures[m],m);r.uniform1f(s.uZoom,z7(this.r)),r.uniformMatrix3fv(s.uPanZoomMatrix,!1,this.panZoomMatrix),r.uniform1i(s.uAtlasSize,this.batchManager.getAtlasSize());var g=zc(this.bgColor,1);r.uniform4fv(s.uBGColor,g),r.drawArraysInstanced(r.TRIANGLES,0,i,a),r.bindVertexArray(null),r.bindTexture(r.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:a,atlasCount:c.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var r=this.atlasManager.getDebugInfo(),n=r.reduce(function(s,o){return s+o.atlasCount},0),i=this.batchDebugInfo,a=i.reduce(function(s,o){return s+o.count},0);return{atlasInfo:r,totalAtlases:n,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:i.length,batchInfo:i,totalInstances:a}}}])})(),Wj={};Wj.initWebgl=function(t,e){var r=this,n=r.data.contexts[r.WEBGL];t.bgColor=lB(r),t.webglTexSize=Math.min(t.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE)),t.webglTexRows=Math.min(t.webglTexRows,54),t.webglTexRowsNodes=Math.min(t.webglTexRowsNodes,54),t.webglBatchSize=Math.min(t.webglBatchSize,16384),t.webglTexPerBatch=Math.min(t.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),r.webglDebug=t.webglDebug,r.webglDebugShowAtlases=t.webglDebugShowAtlases,r.pickingFrameBuffer=Y7(n),r.pickingFrameBuffer.needsDraw=!0,r.drawing=new oB(r,n,t);var i=function(f){return function(m){return r.getTextAngle(m,f)}},a=function(f){return function(m){var g=m.pstyle(f);return g&&g.value}},s=function(f){return function(m){return m.pstyle("".concat(f,"-opacity")).value>0}},o=function(f){var m=f.pstyle("text-events").strValue==="yes";return m?oy.USE_BB:oy.IGNORE},l=function(f){var m=f.position(),g=m.x,y=m.y,b=f.outerWidth(),w=f.outerHeight();return{w:b,h:w,x1:g-b/2,y1:y-w/2}};r.drawing.addAtlasCollection("node",{texRows:t.webglTexRowsNodes}),r.drawing.addAtlasCollection("label",{texRows:t.webglTexRows}),r.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement}),r.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:l,isSimple:U7,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),r.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:l,isVisible:s("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),r.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:l,isVisible:s("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),r.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:o,getKey:rw(e.getLabelKey,null),getBoundingBox:nw(e.getLabelBox,null),drawClipped:!0,drawElement:e.drawLabel,getRotation:i(null),getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:a("label")}),r.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:o,getKey:rw(e.getSourceLabelKey,"source"),getBoundingBox:nw(e.getSourceLabelBox,"source"),drawClipped:!0,drawElement:e.drawSourceLabel,getRotation:i("source"),getRotationPoint:e.getSourceLabelRotationPoint,getRotationOffset:e.getSourceLabelRotationOffset,isVisible:a("source-label")}),r.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:o,getKey:rw(e.getTargetLabelKey,"target"),getBoundingBox:nw(e.getTargetLabelBox,"target"),drawClipped:!0,drawElement:e.drawTargetLabel,getRotation:i("target"),getRotationPoint:e.getTargetLabelRotationPoint,getRotationOffset:e.getTargetLabelRotationOffset,isVisible:a("target-label")});var u=Mg(function(){console.log("garbage collect flag set"),r.data.gc=!0},1e4);r.onUpdateEleCalcs(function(c,f){var m=!1;f&&f.length>0&&(m|=r.drawing.invalidate(f)),m&&u()}),uB(r)};function lB(t){var e=t.cy.container(),r=e&&e.style&&e.style.backgroundColor||"white";return b6(r)}function $j(t,e){var r=t._private.rscratch;return ya(r,"labelWrapCachedLines",e)||[]}var rw=function(e,r){return function(n){var i=e(n),a=$j(n,r);return a.length>1?a.map(function(s,o){return"".concat(i,"_").concat(o)}):i}},nw=function(e,r){return function(n,i){var a=e(n);if(typeof i=="string"){var s=i.indexOf("_");if(s>0){var o=Number(i.substring(s+1)),l=$j(n,r),u=a.h/l.length,c=u*o,f=a.y1+c;return{x1:a.x1,w:a.w,y1:f,h:u,yOffset:c}}}return a}};function uB(t){{var e=t.render;t.render=function(a){a=a||{};var s=t.cy;t.webgl&&(s.zoom()>Fj?(cB(t),e.call(t,a)):(dB(t),Yj(t,a,Lm.SCREEN)))}}{var r=t.matchCanvasSize;t.matchCanvasSize=function(a){r.call(t,a),t.pickingFrameBuffer.setFramebufferAttachmentSizes(t.canvasWidth,t.canvasHeight),t.pickingFrameBuffer.needsDraw=!0}}t.findNearestElements=function(a,s,o,l){return vB(t,a,s)};{var n=t.invalidateCachedZSortedEles;t.invalidateCachedZSortedEles=function(){n.call(t),t.pickingFrameBuffer.needsDraw=!0}}{var i=t.notify;t.notify=function(a,s){i.call(t,a,s),a==="viewport"||a==="bounds"?t.pickingFrameBuffer.needsDraw=!0:a==="background"&&t.drawing.invalidate(s,{type:"node-body"})}}}function cB(t){var e=t.data.contexts[t.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function dB(t){var e=function(n){n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.canvasWidth,t.canvasHeight),n.restore()};e(t.data.contexts[t.NODE]),e(t.data.contexts[t.DRAG])}function fB(t){var e=t.canvasWidth,r=t.canvasHeight,n=WS(t),i=n.pan,a=n.zoom,s=Zb();B0(s,s,[i.x,i.y]),j2(s,s,[a,a]);var o=Zb();Q7(o,e,r);var l=Zb();return X7(l,o,s),l}function Kj(t,e){var r=t.canvasWidth,n=t.canvasHeight,i=WS(t),a=i.pan,s=i.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,r,n),e.translate(a.x,a.y),e.scale(s,s)}function hB(t,e){t.drawSelectionRectangle(e,function(r){return Kj(t,r)})}function pB(t){var e=t.data.contexts[t.NODE];e.save(),Kj(t,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function mB(t){var e=function(i,a,s){for(var o=i.atlasManager.getAtlasCollection(a),l=t.data.contexts[t.NODE],u=o.atlases,c=0;c<u.length;c++){var f=u[c],m=f.canvas;if(m){var g=m.width,y=m.height,b=g*c,w=m.height*s,N=.4;l.save(),l.scale(N,N),l.drawImage(m,b,w),l.strokeStyle="black",l.rect(b,w,g,y),l.stroke(),l.restore()}}},r=0;e(t.drawing,"node",r++),e(t.drawing,"label",r++)}function gB(t,e,r,n,i){var a,s,o,l,u=WS(t),c=u.pan,f=u.zoom;{var m=V7(t,c,f,e,r),g=Pn(m,2),y=g[0],b=g[1],w=6;a=y-w/2,s=b-w/2,o=w,l=w}if(o===0||l===0)return[];var N=t.data.contexts[t.WEBGL];N.bindFramebuffer(N.FRAMEBUFFER,t.pickingFrameBuffer),t.pickingFrameBuffer.needsDraw&&(N.viewport(0,0,N.canvas.width,N.canvas.height),Yj(t,null,Lm.PICKING),t.pickingFrameBuffer.needsDraw=!1);var k=o*l,C=new Uint8Array(k*4);N.readPixels(a,s,o,l,N.RGBA,N.UNSIGNED_BYTE,C),N.bindFramebuffer(N.FRAMEBUFFER,null);for(var E=new Set,P=0;P<k;P++){var _=C.slice(P*4,P*4+4),A=H7(_)-1;A>=0&&E.add(A)}return E}function vB(t,e,r){var n=gB(t,e,r),i=t.getCachedZSortedEles(),a,s,o=wa(n),l;try{for(o.s();!(l=o.n()).done;){var u=l.value,c=i[u];if(!a&&c.isNode()&&(a=c),!s&&c.isEdge()&&(s=c),a&&s)break}}catch(f){o.e(f)}finally{o.f()}return[a,s].filter(Boolean)}function iw(t,e,r){var n=t.drawing;e+=1,r.isNode()?(n.drawNode(r,e,"node-underlay"),n.drawNode(r,e,"node-body"),n.drawTexture(r,e,"label"),n.drawNode(r,e,"node-overlay")):(n.drawEdgeLine(r,e),n.drawEdgeArrow(r,e,"source"),n.drawEdgeArrow(r,e,"target"),n.drawTexture(r,e,"label"),n.drawTexture(r,e,"edge-source-label"),n.drawTexture(r,e,"edge-target-label"))}function Yj(t,e,r){var n;t.webglDebug&&(n=performance.now());var i=t.drawing,a=0;if(r.screen&&t.data.canvasNeedsRedraw[t.SELECT_BOX]&&hB(t,e),t.data.canvasNeedsRedraw[t.NODE]||r.picking){var s=t.data.contexts[t.WEBGL];r.screen?(s.clearColor(0,0,0,0),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA)):s.disable(s.BLEND),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.viewport(0,0,s.canvas.width,s.canvas.height);var o=fB(t),l=t.getCachedZSortedEles();if(a=l.length,i.startFrame(o,r),r.screen){for(var u=0;u<l.nondrag.length;u++)iw(t,u,l.nondrag[u]);for(var c=0;c<l.drag.length;c++)iw(t,c,l.drag[c])}else if(r.picking)for(var f=0;f<l.length;f++)iw(t,f,l[f]);i.endFrame(),r.screen&&t.webglDebugShowAtlases&&(pB(t),mB(t)),t.data.canvasNeedsRedraw[t.NODE]=!1,t.data.canvasNeedsRedraw[t.DRAG]=!1}if(t.webglDebug){var m=performance.now(),g=!1,y=Math.ceil(m-n),b=i.getDebugInfo(),w=["".concat(a," elements"),"".concat(b.totalInstances," instances"),"".concat(b.batchCount," batches"),"".concat(b.totalAtlases," atlases"),"".concat(b.wrappedCount," wrapped textures"),"".concat(b.simpleCount," simple shapes")].join(", ");if(g)console.log("WebGL (".concat(r.name,") - time ").concat(y,"ms, ").concat(w));else{console.log("WebGL (".concat(r.name,") - frame time ").concat(y,"ms")),console.log("Totals:"),console.log("  ".concat(w)),console.log("Texture Atlases Used:");var N=b.atlasInfo,k=wa(N),C;try{for(k.s();!(C=k.n()).done;){var E=C.value;console.log("  ".concat(E.type,": ").concat(E.keyCount," keys, ").concat(E.atlasCount," atlases"))}}catch(P){k.e(P)}finally{k.f()}console.log("")}}t.data.gc&&(console.log("Garbage Collect!"),t.data.gc=!1,i.gc())}var Ju={};Ju.drawPolygonPath=function(t,e,r,n,i,a){var s=n/2,o=i/2;t.beginPath&&t.beginPath(),t.moveTo(e+s*a[0],r+o*a[1]);for(var l=1;l<a.length/2;l++)t.lineTo(e+s*a[l*2],r+o*a[l*2+1]);t.closePath()};Ju.drawRoundPolygonPath=function(t,e,r,n,i,a,s){s.forEach(function(o){return Mj(t,o)}),t.closePath()};Ju.drawRoundRectanglePath=function(t,e,r,n,i,a){var s=n/2,o=i/2,l=a==="auto"?zu(n,i):Math.min(a,o,s);t.beginPath&&t.beginPath(),t.moveTo(e,r-o),t.arcTo(e+s,r-o,e+s,r,l),t.arcTo(e+s,r+o,e,r+o,l),t.arcTo(e-s,r+o,e-s,r,l),t.arcTo(e-s,r-o,e,r-o,l),t.lineTo(e,r-o),t.closePath()};Ju.drawBottomRoundRectanglePath=function(t,e,r,n,i,a){var s=n/2,o=i/2,l=a==="auto"?zu(n,i):a;t.beginPath&&t.beginPath(),t.moveTo(e,r-o),t.lineTo(e+s,r-o),t.lineTo(e+s,r),t.arcTo(e+s,r+o,e,r+o,l),t.arcTo(e-s,r+o,e-s,r,l),t.lineTo(e-s,r-o),t.lineTo(e,r-o),t.closePath()};Ju.drawCutRectanglePath=function(t,e,r,n,i,a,s){var o=n/2,l=i/2,u=s==="auto"?AS():s;t.beginPath&&t.beginPath(),t.moveTo(e-o+u,r-l),t.lineTo(e+o-u,r-l),t.lineTo(e+o,r-l+u),t.lineTo(e+o,r+l-u),t.lineTo(e+o-u,r+l),t.lineTo(e-o+u,r+l),t.lineTo(e-o,r+l-u),t.lineTo(e-o,r-l+u),t.closePath()};Ju.drawBarrelPath=function(t,e,r,n,i){var a=n/2,s=i/2,o=e-a,l=e+a,u=r-s,c=r+s,f=p2(n,i),m=f.widthOffset,g=f.heightOffset,y=f.ctrlPtOffsetPct*m;t.beginPath&&t.beginPath(),t.moveTo(o,u+g),t.lineTo(o,c-g),t.quadraticCurveTo(o+y,c,o+m,c),t.lineTo(l-m,c),t.quadraticCurveTo(l-y,c,l,c-g),t.lineTo(l,u+g),t.quadraticCurveTo(l-y,u,l-m,u),t.lineTo(o+m,u),t.quadraticCurveTo(o+y,u,o,u+g),t.closePath()};var xE=Math.sin(0),bE=Math.cos(0),P2={},M2={},Xj=Math.PI/40;for(var Af=0*Math.PI;Af<2*Math.PI;Af+=Xj)P2[Af]=Math.sin(Af),M2[Af]=Math.cos(Af);Ju.drawEllipsePath=function(t,e,r,n,i){if(t.beginPath&&t.beginPath(),t.ellipse)t.ellipse(e,r,n/2,i/2,0,0,2*Math.PI);else for(var a,s,o=n/2,l=i/2,u=0*Math.PI;u<2*Math.PI;u+=Xj)a=e-o*P2[u]*xE+o*M2[u]*bE,s=r+l*M2[u]*xE+l*P2[u]*bE,u===0?t.moveTo(a,s):t.lineTo(a,s);t.closePath()};var Ig={};Ig.createBuffer=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,[r,r.getContext("2d")]};Ig.bufferCanvasImage=function(t){var e=this.cy,r=e.mutableElements(),n=r.boundingBox(),i=this.findContainerClientCoords(),a=t.full?Math.ceil(n.w):i[2],s=t.full?Math.ceil(n.h):i[3],o=Qe(t.maxWidth)||Qe(t.maxHeight),l=this.getPixelRatio(),u=1;if(t.scale!==void 0)a*=t.scale,s*=t.scale,u=t.scale;else if(o){var c=1/0,f=1/0;Qe(t.maxWidth)&&(c=u*t.maxWidth/a),Qe(t.maxHeight)&&(f=u*t.maxHeight/s),u=Math.min(c,f),a*=u,s*=u}o||(a*=l,s*=l,u*=l);var m=document.createElement("canvas");m.width=a,m.height=s,m.style.width=a+"px",m.style.height=s+"px";var g=m.getContext("2d");if(a>0&&s>0){g.clearRect(0,0,a,s),g.globalCompositeOperation="source-over";var y=this.getCachedZSortedEles();if(t.full)g.translate(-n.x1*u,-n.y1*u),g.scale(u,u),this.drawElements(g,y),g.scale(1/u,1/u),g.translate(n.x1*u,n.y1*u);else{var b=e.pan(),w={x:b.x*u,y:b.y*u};u*=e.zoom(),g.translate(w.x,w.y),g.scale(u,u),this.drawElements(g,y),g.scale(1/u,1/u),g.translate(-w.x,-w.y)}t.bg&&(g.globalCompositeOperation="destination-over",g.fillStyle=t.bg,g.rect(0,0,a,s),g.fill())}return m};function yB(t,e){for(var r=atob(t),n=new ArrayBuffer(r.length),i=new Uint8Array(n),a=0;a<r.length;a++)i[a]=r.charCodeAt(a);return new Blob([n],{type:e})}function wE(t){var e=t.indexOf(",");return t.substr(e+1)}function Qj(t,e,r){var n=function(){return e.toDataURL(r,t.quality)};switch(t.output){case"blob-promise":return new wh(function(i,a){try{e.toBlob(function(s){s!=null?i(s):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},r,t.quality)}catch(s){a(s)}});case"blob":return yB(wE(n()),r);case"base64":return wE(n());default:return n()}}Ig.png=function(t){return Qj(t,this.bufferCanvasImage(t),"image/png")};Ig.jpg=function(t){return Qj(t,this.bufferCanvasImage(t),"image/jpeg")};var Jj={};Jj.nodeShapeImpl=function(t,e,r,n,i,a,s,o){switch(t){case"ellipse":return this.drawEllipsePath(e,r,n,i,a);case"polygon":return this.drawPolygonPath(e,r,n,i,a,s);case"round-polygon":return this.drawRoundPolygonPath(e,r,n,i,a,s,o);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,r,n,i,a,o);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,r,n,i,a,s,o);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,r,n,i,a,o);case"barrel":return this.drawBarrelPath(e,r,n,i,a)}};var xB=Zj,zt=Zj.prototype;zt.CANVAS_LAYERS=3;zt.SELECT_BOX=0;zt.DRAG=1;zt.NODE=2;zt.WEBGL=3;zt.CANVAS_TYPES=["2d","2d","2d","webgl2"];zt.BUFFER_COUNT=3;zt.TEXTURE_BUFFER=0;zt.MOTIONBLUR_BUFFER_NODE=1;zt.MOTIONBLUR_BUFFER_DRAG=2;function Zj(t){var e=this,r=e.cy.window(),n=r.document;t.webgl&&(zt.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(zt.CANVAS_LAYERS),contexts:new Array(zt.CANVAS_LAYERS),canvasNeedsRedraw:new Array(zt.CANVAS_LAYERS),bufferCanvases:new Array(zt.BUFFER_COUNT),bufferContexts:new Array(zt.CANVAS_LAYERS)};var i="-webkit-tap-highlight-color",a="rgba(0,0,0,0)";e.data.canvasContainer=n.createElement("div");var s=e.data.canvasContainer.style;e.data.canvasContainer.style[i]=a,s.position="relative",s.zIndex="0",s.overflow="hidden";var o=t.cy.container();o.appendChild(e.data.canvasContainer),o.style[i]=a;var l={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};hD()&&(l["-ms-touch-action"]="none",l["touch-action"]="none");for(var u=0;u<zt.CANVAS_LAYERS;u++){var c=e.data.canvases[u]=n.createElement("canvas"),f=zt.CANVAS_TYPES[u];e.data.contexts[u]=c.getContext(f),e.data.contexts[u]||Hr("Could not create canvas of type "+f),Object.keys(l).forEach(function(te){c.style[te]=l[te]}),c.style.position="absolute",c.setAttribute("data-id","layer"+u),c.style.zIndex=String(zt.CANVAS_LAYERS-u),e.data.canvasContainer.appendChild(c),e.data.canvasNeedsRedraw[u]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[zt.NODE].setAttribute("data-id","layer"+zt.NODE+"-node"),e.data.canvases[zt.SELECT_BOX].setAttribute("data-id","layer"+zt.SELECT_BOX+"-selectbox"),e.data.canvases[zt.DRAG].setAttribute("data-id","layer"+zt.DRAG+"-drag"),e.data.canvases[zt.WEBGL]&&e.data.canvases[zt.WEBGL].setAttribute("data-id","layer"+zt.WEBGL+"-webgl");for(var u=0;u<zt.BUFFER_COUNT;u++)e.data.bufferCanvases[u]=n.createElement("canvas"),e.data.bufferContexts[u]=e.data.bufferCanvases[u].getContext("2d"),e.data.bufferCanvases[u].style.position="absolute",e.data.bufferCanvases[u].setAttribute("data-id","buffer"+u),e.data.bufferCanvases[u].style.zIndex=String(-u-1),e.data.bufferCanvases[u].style.visibility="hidden";e.pathsEnabled=!0;var m=ea(),g=function(ae){return{x:(ae.x1+ae.x2)/2,y:(ae.y1+ae.y2)/2}},y=function(ae){return{x:-ae.w/2,y:-ae.h/2}},b=function(ae){var oe=ae[0]._private,fe=oe.oldBackgroundTimestamp===oe.backgroundTimestamp;return!fe},w=function(ae){return ae[0]._private.nodeKey},N=function(ae){return ae[0]._private.labelStyleKey},k=function(ae){return ae[0]._private.sourceLabelStyleKey},C=function(ae){return ae[0]._private.targetLabelStyleKey},E=function(ae,oe,fe,pe,Te){return e.drawElement(ae,oe,fe,!1,!1,Te)},P=function(ae,oe,fe,pe,Te){return e.drawElementText(ae,oe,fe,pe,"main",Te)},_=function(ae,oe,fe,pe,Te){return e.drawElementText(ae,oe,fe,pe,"source",Te)},A=function(ae,oe,fe,pe,Te){return e.drawElementText(ae,oe,fe,pe,"target",Te)},I=function(ae){return ae.boundingBox(),ae[0]._private.bodyBounds},D=function(ae){return ae.boundingBox(),ae[0]._private.labelBounds.main||m},L=function(ae){return ae.boundingBox(),ae[0]._private.labelBounds.source||m},U=function(ae){return ae.boundingBox(),ae[0]._private.labelBounds.target||m},H=function(ae,oe){return oe},M=function(ae){return g(I(ae))},z=function(ae,oe,fe){var pe=ae?ae+"-":"";return{x:oe.x+fe.pstyle(pe+"text-margin-x").pfValue,y:oe.y+fe.pstyle(pe+"text-margin-y").pfValue}},O=function(ae,oe,fe){var pe=ae[0]._private.rscratch;return{x:pe[oe],y:pe[fe]}},G=function(ae){return z("",O(ae,"labelX","labelY"),ae)},W=function(ae){return z("source",O(ae,"sourceLabelX","sourceLabelY"),ae)},$=function(ae){return z("target",O(ae,"targetLabelX","targetLabelY"),ae)},X=function(ae){return y(I(ae))},Q=function(ae){return y(L(ae))},V=function(ae){return y(U(ae))},Y=function(ae){var oe=D(ae),fe=y(D(ae));if(ae.isNode()){switch(ae.pstyle("text-halign").value){case"left":fe.x=-oe.w-(oe.leftPad||0);break;case"right":fe.x=-(oe.rightPad||0);break}switch(ae.pstyle("text-valign").value){case"top":fe.y=-oe.h-(oe.topPad||0);break;case"bottom":fe.y=-(oe.botPad||0);break}}return fe},Z=e.data.eleTxrCache=new Pm(e,{getKey:w,doesEleInvalidateKey:b,drawElement:E,getBoundingBox:I,getRotationPoint:M,getRotationOffset:X,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),ie=e.data.lblTxrCache=new Pm(e,{getKey:N,drawElement:P,getBoundingBox:D,getRotationPoint:G,getRotationOffset:Y,isVisible:H}),ce=e.data.slbTxrCache=new Pm(e,{getKey:k,drawElement:_,getBoundingBox:L,getRotationPoint:W,getRotationOffset:Q,isVisible:H}),he=e.data.tlbTxrCache=new Pm(e,{getKey:C,drawElement:A,getBoundingBox:U,getRotationPoint:$,getRotationOffset:V,isVisible:H}),ee=e.data.lyrTxrCache=new zj(e);e.onUpdateEleCalcs(function(ae,oe){Z.invalidateElements(oe),ie.invalidateElements(oe),ce.invalidateElements(oe),he.invalidateElements(oe),ee.invalidateElements(oe);for(var fe=0;fe<oe.length;fe++){var pe=oe[fe]._private;pe.oldBackgroundTimestamp=pe.backgroundTimestamp}});var le=function(ae){for(var oe=0;oe<ae.length;oe++)ee.enqueueElementRefinement(ae[oe].ele)};Z.onDequeue(le),ie.onDequeue(le),ce.onDequeue(le),he.onDequeue(le),t.webgl&&e.initWebgl(t,{getStyleKey:w,getLabelKey:N,getSourceLabelKey:k,getTargetLabelKey:C,drawElement:E,drawLabel:P,drawSourceLabel:_,drawTargetLabel:A,getElementBox:I,getLabelBox:D,getSourceLabelBox:L,getTargetLabelBox:U,getElementRotationPoint:M,getElementRotationOffset:X,getLabelRotationPoint:G,getSourceLabelRotationPoint:W,getTargetLabelRotationPoint:$,getLabelRotationOffset:Y,getSourceLabelRotationOffset:Q,getTargetLabelRotationOffset:V})}zt.redrawHint=function(t,e){var r=this;switch(t){case"eles":r.data.canvasNeedsRedraw[zt.NODE]=e;break;case"drag":r.data.canvasNeedsRedraw[zt.DRAG]=e;break;case"select":r.data.canvasNeedsRedraw[zt.SELECT_BOX]=e;break;case"gc":r.data.gc=!0;break}};var bB=typeof Path2D<"u";zt.path2dEnabled=function(t){if(t===void 0)return this.pathsEnabled;this.pathsEnabled=!!t};zt.usePaths=function(){return bB&&this.pathsEnabled};zt.setImgSmoothing=function(t,e){t.imageSmoothingEnabled!=null?t.imageSmoothingEnabled=e:(t.webkitImageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e)};zt.getImgSmoothing=function(t){return t.imageSmoothingEnabled!=null?t.imageSmoothingEnabled:t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled};zt.makeOffscreenCanvas=function(t,e){var r;if((typeof OffscreenCanvas>"u"?"undefined":Vn(OffscreenCanvas))!=="undefined")r=new OffscreenCanvas(t,e);else{var n=this.cy.window(),i=n.document;r=i.createElement("canvas"),r.width=t,r.height=e}return r};[Vj,Eo,xl,qS,kd,Qu,na,Wj,Ju,Ig,Jj].forEach(function(t){Ct(zt,t)});var wB=[{name:"null",impl:Tj},{name:"base",impl:Lj},{name:"canvas",impl:xB}],SB=[{type:"layout",extensions:$L},{type:"renderer",extensions:wB}],eP={},tP={};function rP(t,e,r){var n=r,i=function(I){lr("Can not register `"+e+"` for `"+t+"` since `"+I+"` already exists in the prototype and can not be overridden")};if(t==="core"){if(og.prototype[e])return i(e);og.prototype[e]=r}else if(t==="collection"){if(ki.prototype[e])return i(e);ki.prototype[e]=r}else if(t==="layout"){for(var a=function(I){this.options=I,r.call(this,I),Zt(this._private)||(this._private={}),this._private.cy=I.cy,this._private.listeners=[],this.createEmitter()},s=a.prototype=Object.create(r.prototype),o=[],l=0;l<o.length;l++){var u=o[l];s[u]=s[u]||function(){return this}}s.start&&!s.run?s.run=function(){return this.start(),this}:!s.start&&s.run&&(s.start=function(){return this.run(),this});var c=r.prototype.stop;s.stop=function(){var A=this.options;if(A&&A.animate){var I=this.animations;if(I)for(var D=0;D<I.length;D++)I[D].stop()}return c?c.call(this):this.emit("layoutstop"),this},s.destroy||(s.destroy=function(){return this}),s.cy=function(){return this._private.cy};var f=function(I){return I._private.cy},m={addEventFields:function(I,D){D.layout=I,D.cy=f(I),D.target=I},bubble:function(){return!0},parent:function(I){return f(I)}};Ct(s,{createEmitter:function(){return this._private.emitter=new px(m,this),this},emitter:function(){return this._private.emitter},on:function(I,D){return this.emitter().on(I,D),this},one:function(I,D){return this.emitter().one(I,D),this},once:function(I,D){return this.emitter().one(I,D),this},removeListener:function(I,D){return this.emitter().removeListener(I,D),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(I,D){return this.emitter().emit(I,D),this}}),or.eventAliasesOn(s),n=a}else if(t==="renderer"&&e!=="null"&&e!=="base"){var g=nP("renderer","base"),y=g.prototype,b=r,w=r.prototype,N=function(){g.apply(this,arguments),b.apply(this,arguments)},k=N.prototype;for(var C in y){var E=y[C],P=w[C]!=null;if(P)return i(C);k[C]=E}for(var _ in w)k[_]=w[_];y.clientFunctions.forEach(function(A){k[A]=k[A]||function(){Hr("Renderer does not implement `renderer."+A+"()` on its prototype")}}),n=N}else if(t==="__proto__"||t==="constructor"||t==="prototype")return Hr(t+" is an illegal type to be registered, possibly lead to prototype pollutions");return w6({map:eP,keys:[t,e],value:n})}function nP(t,e){return S6({map:eP,keys:[t,e]})}function kB(t,e,r,n,i){return w6({map:tP,keys:[t,e,r,n],value:i})}function CB(t,e,r,n){return S6({map:tP,keys:[t,e,r,n]})}var _2=function(){if(arguments.length===2)return nP.apply(null,arguments);if(arguments.length===3)return rP.apply(null,arguments);if(arguments.length===4)return CB.apply(null,arguments);if(arguments.length===5)return kB.apply(null,arguments);Hr("Invalid extension access syntax")};og.prototype.extension=_2;SB.forEach(function(t){t.extensions.forEach(function(e){rP(t.type,e.name,e.impl)})});var ly=function(){if(!(this instanceof ly))return new ly;this.length=0},hd=ly.prototype;hd.instanceString=function(){return"stylesheet"};hd.selector=function(t){var e=this.length++;return this[e]={selector:t,properties:[]},this};hd.css=function(t,e){var r=this.length-1;if(xt(t))this[r].properties.push({name:t,value:e});else if(Zt(t))for(var n=t,i=Object.keys(n),a=0;a<i.length;a++){var s=i[a],o=n[s];if(o!=null){var l=ri.properties[s]||ri.properties[ix(s)];if(l!=null){var u=l.name,c=o;this[r].properties.push({name:u,value:c})}}}return this};hd.style=hd.css;hd.generateStyle=function(t){var e=new ri(t);return this.appendToStyle(e)};hd.appendToStyle=function(t){for(var e=0;e<this.length;e++){var r=this[e],n=r.selector,i=r.properties;t.selector(n);for(var a=0;a<i.length;a++){var s=i[a];t.css(s.name,s.value)}}return t};var NB="3.33.1",pd=function(e){if(e===void 0&&(e={}),Zt(e))return new og(e);if(xt(e))return _2.apply(_2,arguments)};pd.use=function(t){var e=Array.prototype.slice.call(arguments,1);return e.unshift(pd),t.apply(null,e),this};pd.warnings=function(t){return P6(t)};pd.version=NB;pd.stylesheet=pd.Stylesheet=ly;const{string:o0,array:SE,object:l0,number:_p,bool:La,oneOfType:Rf,any:u0,func:Ap}=YR,EB={id:o0,className:o0,style:Rf([o0,l0]),elements:Rf([SE,u0]),stylesheet:Rf([SE,u0]),layout:Rf([l0,u0]),pan:Rf([l0,u0]),zoom:_p,panningEnabled:La,userPanningEnabled:La,minZoom:_p,maxZoom:_p,zoomingEnabled:La,userZoomingEnabled:La,boxSelectionEnabled:La,autoungrabify:La,autolock:La,autounselectify:La,get:Ap,toJson:Ap,diff:Ap,forEach:Ap,cy:Ap,headless:La,styleEnabled:La,hideEdgesOnViewport:La,textureOnViewport:La,motionBlur:La,motionBlurOpacity:_p,wheelSensitivity:_p,pixelRatio:Rf([o0,l0])},iP=(t,e)=>{if(((a,s)=>a==null||s==null)(t,e)&&(t!=null||e!=null))return!0;if(t===e)return!1;if(typeof t!="object"||typeof e!="object")return t!==e;const r=Object.keys(t),n=Object.keys(e),i=a=>t[a]!==e[a];return r.length!==n.length||!(!r.some(i)&&!n.some(i))},Rs=(t,e)=>t!=null?t[e]:null,TB={diff:iP,get:Rs,toJson:t=>t,forEach:(t,e)=>t.forEach(e),elements:[{data:{id:"a",label:"Example node A"}},{data:{id:"b",label:"Example node B"}},{data:{id:"e",source:"a",target:"b"}}],stylesheet:[{selector:"node",style:{label:"data(label)"}}],zoom:1,pan:{x:0,y:0}},c0=(t,e,r,n)=>r(Rs(t,n),Rs(e,n)),jB=(t,e,r,n,i,a,s)=>{t.batch(()=>{(n===iP||c0(e,r,n,"elements"))&&AB(t,Rs(e,"elements"),Rs(r,"elements"),i,a,s,n),c0(e,r,n,"stylesheet")&&_B(t,Rs(e,"stylesheet"),Rs(r,"stylesheet"),i),["zoom","minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","pan","panningEnabled","userPanningEnabled","boxSelectionEnabled","autoungrabify","autolock","autounselectify"].forEach(o=>{c0(e,r,n,o)&&PB(t,o,Rs(e,o),Rs(r,o),i)})}),c0(e,r,n,"layout")&&MB(t,Rs(e,"layout"),Rs(r,"layout"),i)},PB=(t,e,r,n,i)=>{t[e](i(n))},MB=(t,e,r,n)=>{const i=n(r);i!=null&&t.layout(i).run()},_B=(t,e,r,n)=>{const i=t.style();i?.fromJson(n(r)).update()},AB=(t,e,r,n,i,a,s)=>{const o=[],l=t.collection(),u=[],c={},f={},m=g=>i(i(g,"data"),"id");a(r,g=>{const y=m(g);f[y]=g}),e!=null&&a(e,g=>{const y=m(g);c[y]=g,(b=>f[b]!=null)(y)||l.merge(t.getElementById(y))}),a(r,g=>{const y=m(g),b=(w=>c[w])(y);(w=>c[w]!=null)(y)?u.push({ele1:b,ele2:g}):o.push(n(g))}),l.length>0&&t.remove(l),o.length>0&&t.add(o),u.forEach(({ele1:g,ele2:y})=>RB(t,g,y,n,i,s))},RB=(t,e,r,n,i,a)=>{const s=i(i(r,"data"),"id"),o=t.getElementById(s),l={};["data","position","selected","selectable","locked","grabbable","classes"].forEach(c=>{const f=i(r,c);a(f,i(e,c))&&(l[c]=n(f))});const u=i(r,"scratch");a(u,i(e,"scratch"))&&o.scratch(n(u)),Object.keys(l).length>0&&o.json(l)};class DB extends Kt.Component{static get propTypes(){return EB}static get defaultProps(){return TB}static normalizeElements(e){if(e.length!=null)return e;{let{nodes:r,edges:n}=e;return r==null&&(r=[]),n==null&&(n=[]),r.concat(n)}}constructor(e){super(e),this.displayName="CytoscapeComponent",this.containerRef=Kt.createRef()}componentDidMount(){const e=this.containerRef.current,{global:r,headless:n,styleEnabled:i,hideEdgesOnViewport:a,textureOnViewport:s,motionBlur:o,motionBlurOpacity:l,wheelSensitivity:u,pixelRatio:c}=this.props,f=this._cy=new pd({container:e,headless:n,styleEnabled:i,hideEdgesOnViewport:a,textureOnViewport:s,motionBlur:o,motionBlurOpacity:l,wheelSensitivity:u,pixelRatio:c});r&&(window[r]=f),this.updateCytoscape(null,this.props)}updateCytoscape(e,r){const n=this._cy,{diff:i,toJson:a,get:s,forEach:o}=r;jB(n,e,r,i,a,s,o),r.cy!=null&&r.cy(n)}componentDidUpdate(e){this.updateCytoscape(e,this.props)}componentWillUnmount(){this._cy.destroy()}render(){const{id:e,className:r,style:n}=this.props;return Kt.createElement("div",{ref:this.containerRef,id:e,className:r,style:n})}}const OB=[{selector:"node",style:{"background-color":"#1f2937",label:"data(label)",color:"#cbd5e1","font-family":"Outfit, sans-serif","font-size":"12px","text-valign":"bottom","text-margin-y":8,width:40,height:40,"border-width":2,"border-color":"#475569","text-outline-width":2,"text-outline-color":"#050508","overlay-padding":6,"z-index":10}},{selector:'node[category="Individual"]',style:{"background-color":"rgba(49, 46, 129, 0.9)","border-color":"#6366f1",shape:"ellipse",width:50,height:50}},{selector:'node[category="Location"]',style:{"background-color":"rgba(6, 78, 59, 0.9)","border-color":"#10b981",shape:"hexagon",width:60,height:60}},{selector:'node[category="Group"]',style:{"background-color":"rgba(88, 28, 135, 0.9)","border-color":"#a855f7",shape:"round-rectangle"}},{selector:"edge",style:{width:2,"line-color":"#334155","target-arrow-color":"#334155","target-arrow-shape":"triangle","curve-style":"bezier"}},{selector:":selected",style:{"border-width":4,"border-color":"#fafafa","line-color":"#fafafa","target-arrow-color":"#fafafa","z-index":999}}],IB=()=>{const{username:t,projectName:e}=Ua(),[r,n]=se.useState([]),[i,a]=se.useState([]),[s,o]=se.useState(""),[l,u]=se.useState(!0),c=se.useRef(null),f=Na();se.useEffect(()=>{m()},[]);const m=async()=>{u(!0);try{const b=await $e.get("/world-bible/graph");console.log("Graph Data Loaded:",b),b&&b.nodes&&n([...b.nodes,...b.edges])}catch(b){console.error("Failed to load graph data",b),f("/")}finally{u(!1)}},g=()=>{if(!c.current)return;c.current.layout({name:"cose",animate:!0,padding:50,nodeOverlap:20,componentSpacing:100}).run()};se.useEffect(()=>{c.current&&g()},[r]);const y=()=>{if(!c.current||!s)return;const b=c.current;if(b.elements().removeClass("highlighted faded"),s.length>0){const w=b.nodes().filter(N=>N.data("label").toLowerCase().includes(s.toLowerCase()));w.length>0&&(b.elements().not(w).addClass("faded"),w.addClass("highlighted"),b.animate({fit:{eles:w,padding:50}}))}};return h.jsxs("div",{className:"w-full h-full flex bg-background-dark relative overflow-hidden font-display text-foreground",children:[h.jsx("div",{className:"absolute top-4 left-4 z-20 w-80 pointer-events-none",children:h.jsxs("div",{className:"bg-card/90 backdrop-blur-md border border-border/50 rounded-xl p-4 shadow-2xl pointer-events-auto space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:"size-8 rounded bg-primary flex items-center justify-center",children:h.jsx("span",{className:"material-symbols-outlined text-primary-foreground",children:"hub"})}),h.jsx("h2",{className:"font-bold text-lg tracking-tight",children:"Graph View"})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{className:"bg-accent/50 border border-input rounded-md px-3 py-2 text-sm w-full outline-none focus:ring-1 focus:ring-primary",placeholder:"Find node...",value:s,onChange:b=>o(b.target.value),onKeyDown:b=>b.key==="Enter"&&y()}),h.jsx("button",{onClick:y,className:"bg-primary/20 hover:bg-primary/30 text-primary border border-primary/50 rounded-md px-3 transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"search"})})]}),h.jsxs("div",{className:"flex flex-wrap gap-2 text-[10px] uppercase font-bold text-muted-foreground pt-2 border-t border-border/50",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("div",{className:"size-2 rounded-full bg-indigo-500"})," Individual"]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("div",{className:"size-2 rounded-full bg-emerald-500"})," Location"]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("div",{className:"size-2 rounded-full bg-purple-500"})," Group"]})]}),h.jsx("div",{className:"pt-2",children:h.jsxs(yr,{onClick:g,size:"sm",variant:"outline",className:"w-full text-xs",children:[h.jsx("span",{className:"material-symbols-outlined text-sm mr-2",children:"refresh"}),"Re-Layout"]})})]})}),r.length===0&&!l&&h.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10 pointer-events-none",children:h.jsx("div",{className:"text-muted text-lg",children:"No entities found. Create some in the Bible!"})}),h.jsx(DB,{elements:r,stylesheet:OB,style:{width:"100%",height:"100%"},cy:b=>{c.current=b},minZoom:.2,maxZoom:3,wheelSensitivity:.3,className:"bg-background-dark"})]})},LB=({id:t})=>{const{id:e}=Ua(),r=Na(),[n,i]=se.useState("overview"),[a,s]=se.useState(null),[o,l]=se.useState(!0),[u,c]=se.useState(!1);se.useEffect(()=>{f()},[t]);const f=async()=>{l(!0);try{const b=await $e.get(`/bd/entidadindividual/${t}`);s(b)}catch(b){console.error("Error loading character:",b)}finally{l(!1)}},m=async()=>{try{await $e.patch("/bd/modificar",{...a,tipoEntidad:"entidadindividual"}),c(!1)}catch(b){console.error("Error saving:",b)}},g=async()=>{if(window.confirm("Move this character to the Trash Bin?"))try{await $e.delete(`/bd/entidadindividual/${t}`),r(`/project/${e}`)}catch(b){console.error(b)}},y=(b,w)=>{s(N=>({...N,[b]:w}))};return o?h.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Summoning entity..."}):a?h.jsxs("div",{className:"flex h-full",children:[h.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto custom-scrollbar p-8 gap-6",children:[h.jsxs("div",{className:"flex items-start gap-6",children:[h.jsx("div",{className:"relative",children:h.jsx(K0,{url:a.imagenUrl||"https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1976&auto=format&fit=crop",size:"xl",className:"rounded-2xl border-2 border-primary shadow-[0_0_30px_rgba(99,102,242,0.3)]"})}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[h.jsx("span",{className:"text-xs font-bold text-primary bg-primary/10 px-2 py-0.5 rounded border border-primary/20",children:a.estado||"ACTIVE"}),h.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:a.tipo||"Unknown"})]}),h.jsxs("h1",{className:"text-4xl font-bold text-white mb-2",children:[a.nombre," ",a.apellidos]}),h.jsx("p",{className:"text-lg text-slate-300",children:a.origen||"Traveling the void"})]}),h.jsxs("div",{className:"flex gap-2",children:[!u&&h.jsx(yr,{className:"border-red-500/30 text-red-400 hover:bg-red-500/10",icon:"delete",onClick:g,children:"Delete"}),h.jsx(yr,{variant:"secondary",icon:u?"close":"edit",onClick:()=>c(!u),children:u?"Cancel":"Edit Profile"}),u&&h.jsx(yr,{variant:"primary",icon:"save",onClick:m,children:"Save Changes"})]})]}),h.jsx("div",{className:"border-b border-glass-border flex gap-6",children:["Overview","Biography","Attributes & Stats","Relationships"].map(b=>h.jsx("button",{onClick:()=>i(b.toLowerCase()),className:`pb-4 px-2 text-sm font-bold border-b-2 transition-colors ${n===b.toLowerCase()?"text-primary border-primary":"text-slate-500 border-transparent hover:text-white"}`,children:b},b))}),h.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[h.jsx("div",{className:"col-span-1 space-y-6",children:h.jsxs(ir,{className:"p-4",children:[h.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"fingerprint"})," Identity"]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Name"}),h.jsx("input",{type:"text",value:a.nombre,onChange:b=>y("nombre",b.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Surnames"}),h.jsx("input",{type:"text",value:a.apellidos||"",onChange:b=>y("apellidos",b.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Type / Species"}),h.jsx("input",{type:"text",value:a.tipo||"",onChange:b=>y("tipo",b.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Origin"}),h.jsx("input",{type:"text",value:a.origen||"",onChange:b=>y("origen",b.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]})]})]})}),h.jsx("div",{className:"col-span-2 space-y-6",children:h.jsxs(ir,{className:"p-6 relative overflow-hidden group",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"})," Narrative & Connections"]}),!u&&h.jsx("span",{className:"text-[10px] text-slate-600 bg-white/5 px-2 py-1 rounded",children:"Read Only"})]}),h.jsxs("div",{className:"mb-8",children:[h.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mb-3 opacity-80",children:"Biography"}),h.jsx("textarea",{value:a.descripcion||"",onChange:b=>y("descripcion",b.target.value),readOnly:!u,className:`w-full bg-transparent border-none outline-none text-slate-300 text-sm leading-relaxed resize-none custom-scrollbar ${u?"min-h-[150px] placeholder-white/20":"h-auto overflow-hidden"}`,placeholder:"Write the history of this person..."}),h.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mt-6 mb-3 opacity-80",children:"Behavior & Personality"}),h.jsx("textarea",{value:a.comportamiento||"",onChange:b=>y("comportamiento",b.target.value),readOnly:!u,className:`w-full bg-transparent border-none outline-none text-slate-300 text-sm leading-relaxed resize-none custom-scrollbar ${u?"min-h-[100px]":"h-auto overflow-hidden"}`,placeholder:"How does this person act?"})]}),h.jsxs("div",{className:"pt-6 border-t border-white/5",children:[h.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mb-4 flex items-center gap-2 opacity-80",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})," Established Connections"]}),a.relaciones&&a.relaciones.length>0?h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.relaciones.map((b,w)=>h.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5 hover:border-primary/30 transition-colors",children:[h.jsx("div",{className:"size-8 rounded-full bg-white/10 flex items-center justify-center text-xs font-bold",children:b.entidadDestino?.nombre?.charAt(0)||"?"}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm font-bold text-white truncate",children:b.entidadDestino?.nombre||"Unknown"}),h.jsx("div",{className:"text-[10px] text-primary truncate",children:b.tipoRelacion||"Connected"})]})]},w))}):h.jsx("div",{className:"p-6 text-center bg-white/5 rounded-xl border border-dashed border-white/10",children:h.jsx("p",{className:"text-xs text-slate-500 italic",children:"No relationships recorded yet."})})]})]})})]})]}),h.jsxs("div",{className:"w-80 border-l border-glass-border bg-surface-dark/50 hidden xl:flex flex-col",children:[h.jsxs("div",{className:"p-4 border-b border-glass-border flex justify-between items-center",children:[h.jsx("span",{className:"text-xs font-bold text-slate-500",children:"QUICK NOTES"}),h.jsx("button",{className:"text-slate-400 hover:text-white",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"})})]}),h.jsx("div",{className:"p-4 flex-1",children:h.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none text-sm text-slate-300 placeholder-slate-600 resize-none",placeholder:"Draft a quick scene or jot down notes for Elara here..."})}),h.jsx("div",{className:"p-2 border-t border-glass-border text-right text-[10px] text-slate-600",children:"0 words"})]})]}):h.jsx("div",{className:"p-20 text-center text-red-500",children:"Character not found in the archives."})},kE=({id:t})=>{const[e,r]=se.useState(null),[n,i]=se.useState(!0),[a,s]=se.useState(!1);se.useEffect(()=>{o()},[t]);const o=async()=>{i(!0);try{const c=await $e.get(`/bd/zona/${t}`);r(c)}catch(c){console.error("Error loading location:",c)}finally{i(!1)}},l=async()=>{try{await $e.patch("/bd/modificar",{...e,tipoEntidad:"zona"}),s(!1)}catch(c){console.error("Error saving:",c)}},u=(c,f)=>{r(m=>({...m,[c]:f}))};return n?h.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Scanning terrain..."}):e?h.jsxs("div",{className:"flex h-full overflow-y-auto custom-scrollbar p-8 flex-col gap-8",children:[h.jsxs("header",{className:"flex justify-between items-end",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("span",{className:"text-xs font-bold text-emerald-400 bg-emerald-400/10 px-2 py-0.5 rounded border border-emerald-400/20",children:"LOCATION"}),h.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:e.tipo||"Wilderness"})]}),h.jsx("h1",{className:"text-5xl font-manrope font-black text-white tracking-tight",children:e.nombre}),h.jsx("p",{className:"text-slate-400 mt-2",children:e.apellidos||"Uncharted territory"})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(yr,{variant:"secondary",icon:a?"close":"edit",onClick:()=>s(!a),children:a?"Cancel":"Edit Location"}),a&&h.jsx(yr,{variant:"primary",icon:"save",onClick:l,children:"Update Records"})]})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[h.jsxs("div",{className:"col-span-1 space-y-6",children:[h.jsxs(ir,{className:"p-6",children:[h.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"straighten"})," Geography & Scale"]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Size / Scale"}),h.jsx("input",{type:"text",value:e.tamanno||"",onChange:c=>u("tamanno",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Development Level"}),h.jsx("input",{type:"text",value:e.desarrollo||"",onChange:c=>u("desarrollo",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]})]})]}),h.jsxs(ir,{className:"p-6",children:[h.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4",children:"Quick Stats"}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[h.jsx("span",{className:"text-[10px] text-slate-500 block",children:"Density"}),h.jsx("span",{className:"text-white font-bold",children:"Medium"})]}),h.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[h.jsx("span",{className:"text-[10px] text-slate-500 block",children:"Security"}),h.jsx("span",{className:"text-emerald-400 font-bold",children:"Stable"})]})]})]})]}),h.jsx("div",{className:"col-span-2 space-y-6",children:h.jsxs(ir,{className:"p-8",children:[h.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"description"})," Topographic Records & Lore"]}),h.jsx("textarea",{value:e.descripcion||"",onChange:c=>u("descripcion",c.target.value),readOnly:!a,className:"w-full bg-transparent border-none outline-none text-slate-300 text-lg leading-relaxed min-h-[400px] resize-none",placeholder:"Describe the vistas, the smells, and the secrets of this place..."})]})})]})]}):h.jsx("div",{className:"p-20 text-center text-red-500",children:"Location not found in the maps."})},BB=({id:t})=>{const[e,r]=se.useState(null),[n,i]=se.useState(!0),[a,s]=se.useState(!1);se.useEffect(()=>{o()},[t]);const o=async()=>{i(!0);try{const c=await $e.get(`/bd/entidadcolectiva/${t}`);r(c)}catch(c){console.error("Error loading collective:",c)}finally{i(!1)}},l=async()=>{try{await $e.patch("/bd/modificar",{...e,tipoEntidad:"entidadcolectiva"}),s(!1)}catch(c){console.error("Error saving:",c)}},u=(c,f)=>{r(m=>({...m,[c]:f}))};return n?h.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Gathering intelligence..."}):e?h.jsxs("div",{className:"flex h-full overflow-y-auto custom-scrollbar p-8 flex-col gap-8",children:[h.jsxs("header",{className:"flex justify-between items-end",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("span",{className:"text-xs font-bold text-indigo-400 bg-indigo-400/10 px-2 py-0.5 rounded border border-indigo-400/20",children:"COLLECTIVE"}),h.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:e.tipo||"Organization"})]}),h.jsx("h1",{className:"text-5xl font-manrope font-black text-white tracking-tight",children:e.nombre}),h.jsxs("p",{className:"text-slate-400 mt-2",children:[e.cantidadMiembros||"Unknown"," members"]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx(yr,{variant:"secondary",icon:a?"close":"edit",onClick:()=>s(!a),children:a?"Cancel":"Edit Collective"}),a&&h.jsx(yr,{variant:"primary",icon:"save",onClick:l,children:"Update Dossier"})]})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[h.jsx("div",{className:"col-span-1 space-y-6",children:h.jsxs(ir,{className:"p-6",children:[h.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"group_work"})," Group Dynamics"]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Scale / Members"}),h.jsx("input",{type:"text",value:e.cantidadMiembros||"",onChange:c=>u("cantidadMiembros",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Behavior / Alignment"}),h.jsx("input",{type:"text",value:e.comportamiento||"",onChange:c=>u("comportamiento",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]})]})]})}),h.jsx("div",{className:"col-span-2 space-y-6",children:h.jsxs(ir,{className:"p-8",children:[h.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"history_edu"})," Mandate & History"]}),h.jsx("textarea",{value:e.descripcion||"",onChange:c=>u("descripcion",c.target.value),readOnly:!a,className:"w-full bg-transparent border-none outline-none text-slate-300 text-lg leading-relaxed min-h-[400px] resize-none",placeholder:"Detail the motives, the structure, and the legacy of this group..."})]})})]})]}):h.jsx("div",{className:"p-20 text-center text-red-500",children:"Collective not found in the records."})},FB=()=>h.jsx("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300",children:h.jsxs("main",{className:"flex-1 flex flex-col p-12 overflow-y-auto custom-scrollbar relative",children:[h.jsxs("header",{className:"mb-12 space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold text-[10px] tracking-widest uppercase",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"grid_view"}),h.jsx("span",{children:"Universo Alpha"}),h.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),h.jsx("span",{children:"Galaxia Andrmeda"}),h.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),h.jsx("span",{className:"text-white",children:"Sistema Solar"})]}),h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"space-y-4 max-w-3xl",children:[h.jsxs("div",{className:"flex items-center gap-3 px-3 py-1 rounded bg-orange-500/10 text-orange-400 border border-orange-500/20 inline-block",children:[h.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"sunny"}),h.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Sistema Planetario"}),h.jsx("span",{className:"text-[9px] font-bold text-slate-600 tracking-widest ml-2",children:"ID: SYS-SOL-001"})]}),h.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:"Sistema Solar"}),h.jsx("p",{className:"text-slate-400 text-lg leading-relaxed",children:"Sistema planetario principal ubicado en el Brazo de Orin, hogar de la nica vida biolgica compleja confirmada en el sector galctico Alpha-9."})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{className:"p-3 rounded-2xl bg-white/5 hover:bg-red-500/10 text-slate-500 hover:text-red-400 border border-white/5 transition-all outline-none",children:h.jsx("span",{className:"material-symbols-outlined",children:"delete"})}),h.jsx(yr,{variant:"primary",icon:"save",children:"Guardar"})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[h.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[h.jsxs("section",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"sell"}),h.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Etiquetas"}),h.jsx("span",{className:"ml-auto text-[9px] font-bold text-slate-600 px-1.5 py-0.5 rounded bg-white/5",children:"3 ACTIVAS"})]}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.jsx(aw,{label:"Estrella Tipo G",color:"amber",icon:"star"}),h.jsx(aw,{label:"Vida Confirmada",color:"emerald",icon:"tempest"}),h.jsx(aw,{label:"Rico en Agua",color:"cyan",icon:"water_drop"}),h.jsx("button",{className:"size-8 rounded-full border border-dashed border-white/10 flex items-center justify-center text-slate-600 hover:text-white hover:border-white/30 transition-all",children:"+"})]})]}),h.jsxs("section",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"analytics"}),h.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Atributos Principales"}),h.jsx("button",{className:"ml-auto text-slate-600 hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"settings"})})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(d0,{label:"Forma / Estructura",value:"Heliosfrica Estndar",icon:"hive"}),h.jsx(d0,{label:"Composicin",value:"Hidrgeno (74%), Helio (24%)",icon:"experiment"}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsx(d0,{label:"Edad (Aos)",value:"4.6 MM",unit:"Aos"}),h.jsx(d0,{label:"Ciclo Orbital",value:"230 MM",unit:"Aos"})]})]})]}),h.jsxs("section",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"menu_book"}),h.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Notas de Lore"})]}),h.jsx("textarea",{className:"w-full h-48 bg-white/5 border border-white/5 rounded-[2rem] p-6 text-sm text-slate-400 placeholder:text-slate-700 focus:border-primary/50 outline-none transition-all resize-none leading-relaxed italic shadow-inner",defaultValue:"El sistema contiene un cinturn de asteroides inusualmente denso entre el 4 y 5 planeta. Se teoriza que es el remanente de una colisin planetaria antigua conocida como 'El Gran Impacto' en las escrituras sagradas de los habitantes de Terra."})]})]}),h.jsx("div",{className:"lg:col-span-2",children:h.jsxs(ir,{className:"h-full border-white/5 bg-surface-dark/40 overflow-hidden flex flex-col shadow-2xl",children:[h.jsxs("header",{className:"p-8 border-b border-white/5 flex justify-between items-center",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"size-10 rounded-xl bg-primary/20 text-primary flex items-center justify-center",children:h.jsx("span",{className:"material-symbols-outlined",children:"hub"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-white text-lg tracking-tight",children:"Contenido Interno (Planetas)"}),h.jsx("p",{className:"text-[10px] font-medium text-slate-500 mt-0.5",children:"Arrastra para reordenar la jerarqua orbital"})]})]}),h.jsxs("div",{className:"px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[10px] font-black uppercase tracking-widest flex items-center gap-2",children:[h.jsx("div",{className:"size-1.5 rounded-full bg-emerald-500 animate-pulse"}),"8 Entidades"]})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-3",children:[h.jsx(Rp,{name:"Mercurio",type:"Rocoso",stats:"430C | 88 Das",icon:"public"}),h.jsx(Rp,{name:"Venus",type:"Atmsfera",stats:"462C | 225 Das",icon:"public"}),h.jsx(Rp,{name:"Tierra",type:"Habitable",stats:"8B Hab | 1 Luna",icon:"public",active:!0}),h.jsx(Rp,{name:"Marte",type:"Desierto",stats:"-60C | 2 Lunas",icon:"public"}),h.jsx(Rp,{name:"Cinturn Asteroides",type:"Anillo",stats:">1M Obj",icon:"grain"})]}),h.jsx("div",{className:"p-8 bg-black/20 border-t border-white/5",children:h.jsxs("button",{className:"w-full py-4 rounded-[1.5rem] border-2 border-dashed border-white/10 text-slate-500 hover:text-white hover:border-primary/50 hover:bg-primary/5 transition-all flex items-center justify-center gap-3 font-black uppercase text-[10px] tracking-[0.2em]",children:[h.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Aadir Nueva Entidad"]})})]})})]})]})}),aw=({label:t,color:e,icon:r})=>h.jsxs("div",{className:`px-4 py-1.5 rounded-xl bg-${e}-500/10 text-${e}-400 border border-${e}-500/20 flex items-center gap-2 text-[10px] font-black uppercase tracking-widest shadow-lg`,children:[h.jsx("span",{className:"material-symbols-outlined text-[14px]",children:r}),t]}),d0=({label:t,value:e,unit:r,icon:n})=>h.jsxs("div",{className:"space-y-2",children:[h.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-slate-600 ml-1",children:t}),h.jsxs("div",{className:"w-full bg-white/5 border border-white/5 rounded-2xl px-5 py-3.5 flex items-center justify-between group hover:border-white/10 transition-all",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[n&&h.jsx("span",{className:"material-symbols-outlined text-slate-500 text-lg group-hover:text-primary transition-colors",children:n}),h.jsx("span",{className:"text-sm font-bold text-slate-300",children:e})]}),r&&h.jsx("span",{className:"text-[10px] font-black text-slate-600 uppercase tracking-widest",children:r})]})]}),Rp=({name:t,type:e,stats:r,icon:n,active:i})=>h.jsxs("div",{className:`group flex items-center gap-6 p-4 rounded-2xl transition-all cursor-pointer ${i?"bg-primary/10 border border-primary/20 shadow-xl":"hover:bg-white/5 border border-transparent"}`,children:[h.jsx("span",{className:"material-symbols-outlined text-slate-700 group-hover:text-slate-500",children:"drag_indicator"}),h.jsx("div",{className:`size-12 rounded-xl flex items-center justify-center ${i?"bg-primary text-white shadow-lg shadow-primary/30":"bg-surface-dark border border-white/5 text-slate-500"}`,children:h.jsx("span",{className:"material-symbols-outlined text-3xl",children:n})}),h.jsx("div",{className:"flex-1",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("h4",{className:"text-sm font-bold text-white group-hover:text-primary transition-colors",children:t}),h.jsx("span",{className:`text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-widest ${i?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-white/5 text-slate-600"}`,children:e})]})}),h.jsx("div",{className:"flex flex-col items-end gap-1",children:h.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[h.jsx("span",{className:"material-symbols-outlined text-[12px]",children:"analytics"}),h.jsx("span",{className:"text-[10px] font-mono tracking-tight group-hover:text-slate-300",children:r})]})}),h.jsxs("div",{className:"flex gap-2 ml-4",children:[h.jsx("button",{className:"p-2 rounded-lg text-slate-700 hover:text-white hover:bg-white/5 transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit_note"})}),i?h.jsx("button",{className:"size-8 rounded-full bg-primary text-white flex items-center justify-center shadow-lg",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"arrow_forward"})}):h.jsx("button",{className:"p-2 rounded-lg text-slate-700 hover:text-white hover:bg-white/5 transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"open_in_new"})})]})]}),zB=()=>h.jsx("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300",children:h.jsxs("main",{className:"flex-1 flex flex-col p-12 overflow-y-auto custom-scrollbar relative",children:[h.jsxs("header",{className:"mb-12 space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold text-[10px] tracking-widest uppercase",children:[h.jsx("span",{children:"Sistema Solar"}),h.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),h.jsx("span",{children:"Kepler-186f"}),h.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),h.jsx("span",{className:"text-white",children:"Territorios"})]}),h.jsxs("div",{className:"flex justify-between items-end",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[h.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:"Kepler-186f"}),h.jsx("span",{className:"material-symbols-outlined text-4xl text-primary",children:"public"})]}),h.jsx("p",{className:"text-slate-400 text-lg max-w-2xl leading-relaxed",children:"Gestin geopoltica y geogrfica de la superficie planetaria. Administra biomas, asentamientos y recursos estratgicos."})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx(yr,{variant:"secondary",icon:"map",children:"Ver Atlas"}),h.jsx(yr,{variant:"primary",icon:"add",children:"Nuevo Territorio"})]})]})]}),h.jsxs("section",{className:"space-y-8",children:[h.jsxs(ir,{className:"p-2 flex items-center justify-between border-white/5",children:[h.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[h.jsxs("div",{className:"relative flex-1 max-w-sm",children:[h.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm",children:"search"}),h.jsx("input",{type:"text",placeholder:"Buscar por nombre...",className:"w-full bg-transparent border-none rounded-xl py-2 pl-9 pr-4 text-xs focus:ring-1 focus:ring-primary/30 outline-none transition-all"})]}),h.jsx("div",{className:"w-px h-6 bg-white/5 mx-2"}),h.jsx(sw,{label:"Bioma: Todos"}),h.jsx(sw,{label:"Poblacin"}),h.jsx(sw,{label:"Estado"})]}),h.jsxs("div",{className:"flex items-center gap-1 p-1 bg-white/5 rounded-lg",children:[h.jsx("button",{className:"p-1.5 rounded-md text-slate-500 hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"format_list_bulleted"})}),h.jsx("button",{className:"p-1.5 rounded-md bg-white/10 text-white shadow-sm",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_view"})})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[h.jsx(ow,{title:"Nueva Neo-Tokyo",desc:"Metrpolis vertical construida sobre las...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuAYF5Q6W3o1w1f1",badges:["Capital"],stats:["15M","Templado","Costero"],color:"cyan"}),h.jsx(ow,{title:"Mar de Dunas",desc:"Extensin rida rica en especia slica...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuBYG6R7X4p2x2g2",stats:["Hostil","rido"],color:"amber"}),h.jsx(ow,{title:"Sanctum Bio-Domo",desc:"Instalacin de investigacin...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuCZ H7S8Y5q3z3h3",badges:["Ciencia"],stats:["5K","Jungla"],color:"purple"}),h.jsxs("div",{className:"group border-2 border-dashed border-white/5 rounded-[2.5rem] flex flex-col items-center justify-center p-12 gap-4 hover:border-primary/30 hover:bg-primary/5 transition-all cursor-pointer",children:[h.jsx("div",{className:"size-16 rounded-3xl bg-white/5 flex items-center justify-center group-hover:scale-110 transition-transform",children:h.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-600 group-hover:text-primary",children:"add_location_alt"})}),h.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-slate-600 group-hover:text-white",children:"Aadir Territorio"})]})]})]})]})}),sw=({label:t})=>h.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl hover:bg-white/5 transition-all group",children:[h.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-white",children:t}),h.jsx("span",{className:"material-symbols-outlined text-slate-600 text-[14px]",children:"expand_more"})]}),ow=({title:t,desc:e,image:r,badges:n=[],stats:i=[],color:a})=>h.jsxs("div",{className:"group relative rounded-[2.5rem] overflow-hidden border border-white/5 bg-surface-dark/50 hover:border-white/10 transition-all shadow-2xl",children:[h.jsxs("div",{className:"h-48 overflow-hidden relative",children:[h.jsx("img",{src:r,alt:t,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-60 group-hover:opacity-100"}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-surface-dark via-transparent to-transparent"}),h.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:n.map(s=>h.jsxs("span",{className:`px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest bg-${a==="cyan"?"primary":a==="amber"?"amber-500":"purple-500"}/20 text-${a==="cyan"?"primary":a==="amber"?"amber-400":"purple-400"} border border-white/10 backdrop-blur-md flex items-center gap-1.5`,children:[h.jsx("span",{className:"material-symbols-outlined text-[12px]",children:s==="Capital"?"star":"science"}),s]},s))})]}),h.jsxs("div",{className:"p-8 space-y-6",children:[h.jsxs("header",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-2xl font-manrope font-black text-white mb-2 group-hover:text-primary transition-colors",children:t}),h.jsx("p",{className:"text-xs text-slate-500 leading-relaxed line-clamp-2",children:e})]}),h.jsx("button",{className:"p-2 text-slate-700 hover:text-white",children:h.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})]}),h.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(s=>h.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-white/5 border border-white/5 text-[9px] font-black text-slate-400 uppercase tracking-widest",children:[h.jsx("div",{className:`size-1.5 rounded-full bg-${a==="cyan"?"primary":a==="amber"?"amber-500":"purple-500"}/50`}),s]},s))}),h.jsxs("div",{className:"flex gap-3 pt-2",children:[h.jsxs("button",{className:"flex-1 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[h.jsx("span",{className:"material-symbols-outlined text-sm opacity-50",children:"edit"})," Editar"]}),h.jsxs("button",{className:"flex-1 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[h.jsx("span",{className:"material-symbols-outlined text-sm opacity-50",children:"map"})," Ubicacin"]})]})]})]}),VB=()=>{const{type:t,entityId:e}=Ua(),r=()=>{const n=t?.toLowerCase();switch(n){case"character":case"entidadindividual":return h.jsx(LB,{id:e});case"location":case"zona":return h.jsx(kE,{id:e});case"culture":case"entidadcolectiva":return h.jsx(BB,{id:e});case"universe":case"galaxy":case"system":return h.jsx(FB,{id:e,type:n});case"planet":return h.jsx(zB,{id:e});case"construccion":return h.jsx(kE,{id:e});case"efectos":return h.jsxs("div",{className:"p-8 text-white",children:["Effect/Spell View for ID: ",id]});case"interaccion":return h.jsxs("div",{className:"p-8 text-white",children:["Interaction/Event View for ID: ",id]});case"magic":return h.jsxs("div",{className:"p-8 text-white",children:["Magic System View for ID: ",id]});default:return h.jsxs("div",{className:"p-8 text-white",children:["Unknown Entity Type: ",t]})}};return h.jsx("div",{className:"flex-1 bg-background-dark overflow-hidden",children:r()})},UB=()=>{const{setRightPanelMode:t,setRightOpen:e,setRightPanelTitle:r}=$u(),[n,i]=se.useState([]),[a,s]=se.useState(null),[o,l]=se.useState([]),[u,c]=se.useState(!0),[f,m]=se.useState(!1),[g,y]=se.useState(!1),[b,w]=se.useState({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0}),[N,k]=se.useState({nombre:"",descripcion:""}),[C,E]=se.useState(null),[P,_]=se.useState(null),[A,I]=se.useState("eventos"),[D,L]=se.useState([]),[U,H]=se.useState([]),[M,z]=se.useState(null),O=Kt.useRef(!1),G=async ye=>{try{return(await $e.get("/bd/relacion")).filter(et=>et.tipoOrigen==="lineatiempo"&&et.idOrigen===ye||et.tipoDestino==="lineatiempo"&&et.idDestino===ye).map(et=>et.idOrigen===ye?et.idDestino:et.idOrigen)}catch(Pe){return console.error(Pe),[]}},W=async(ye,Pe)=>{const Be=await G(ye),Ge=Pe.filter(mt=>Be.includes(mt.id));L(Ge);const et=Pe.filter(mt=>mt.id!==ye&&!Be.includes(mt.id));H(et)},$=async ye=>{if(!(!a||!ye))try{await $e.put("/bd/insertar",{tipoEntidad:"relacion",tipoOrigen:"lineatiempo",idOrigen:a,tipoDestino:"lineatiempo",idDestino:ye,descripcion:"Anexo de lnea de tiempo"}),W(a,n)}catch(Pe){console.error(Pe)}},X=async ye=>{const Be=(await $e.get("/bd/relacion")).find(Ge=>Ge.tipoOrigen==="lineatiempo"&&Ge.idOrigen===a&&Ge.idDestino===ye||Ge.tipoDestino==="lineatiempo"&&Ge.idDestino===a&&Ge.idOrigen===ye);Be&&(await $e.delete(`/bd/relacion/${Be.id}`),W(a,n))};se.useEffect(()=>{t("CUSTOM"),r("Lnea de Tiempo");const ye=setInterval(()=>{const Pe=document.getElementById("architect-right-panel-portal");Pe&&(z(Pe),clearInterval(ye))},50);return()=>{clearInterval(ye),t("NOTES"),r("")}},[]);const[Q,V]=se.useState([]),[Y,Z]=se.useState(null);se.useEffect(()=>{O.current||(O.current=!0,ce())},[]);const ie=ye=>{r(h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{children:"LNEA DE TIEMPO"}),ye&&h.jsx("span",{className:"text-[10px] text-slate-400 font-medium normal-case tracking-normal mt-0.5",children:ye})]}))};se.useEffect(()=>{if(A==="eventos"||A==="anexos")if(a){const Pe=Q.flatMap(Be=>Be.lineasTemporales||[]).find(Be=>Be.id===a);ie(Pe?.nombre)}else ie(null);else A==="universo"&&r("Multiverso")},[a,A,Q]);const ce=async()=>{try{const ye=await $e.get("/multiverso/list");if(V(ye),!a&&ye.length>0){const Pe=ye[0];Pe.lineasTemporales&&Pe.lineasTemporales.length>0&&s(Pe.lineasTemporales[0].id)}}catch(ye){console.error("Failed to load multiverse",ye)}},he=async ye=>{try{const Pe=await $e.get(`/timeline/linea/${ye}/eventos`);Pe.sort((Be,Ge)=>(Be.ordenAbsoluto||0)-(Ge.ordenAbsoluto||0)),l(Pe)}catch(Pe){console.error("Failed to load events",Pe)}},ee=async()=>{if(!a||!b.nombre)return;const ye={...b,ordenAbsoluto:parseInt(b.ordenAbsoluto)||0};try{C?await $e.put(`/timeline/evento/${C.id}`,{...ye,lineaTiempo:{id:a}}):await $e.post("/timeline/evento",{...ye,lineaTiempo:{id:a}}),w({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0}),E(null),he(a)}catch(Pe){console.error(Pe)}},le=ye=>{E(ye),w({nombre:ye.nombre,descripcion:ye.descripcion,fechaTexto:ye.fechaTexto,ordenAbsoluto:ye.ordenAbsoluto||0}),I("eventos"),e(!0)},te=async()=>{if(!(!N.nombre||!N.universoId))try{const ye=await $e.post("/timeline/linea",{...N,esRaiz:!1,universo:{id:N.universoId}});y(!1),k({nombre:"",descripcion:"",universoId:null}),await ce(),s(ye.id)}catch(ye){console.error("Error creating timeline:",ye)}},[ae,oe]=se.useState({nombre:"",descripcion:""}),fe=async()=>{if(ae.nombre)try{const ye=await $e.post("/multiverso/crear",ae);oe({nombre:"",descripcion:""}),e(!1),await ce()}catch(ye){console.error("Error creating universe",ye)}},pe=async()=>{if(Y)try{await $e.put(`/multiverso/${Y}`,{nombre:ae.nombre,descripcion:ae.descripcion}),e(!1),await ce()}catch(ye){console.error("Error updating universe",ye)}},Te=async()=>{if(Y&&window.confirm("Delete this universe and ALL its timelines? This cannot be undone."))try{await $e.delete(`/multiverso/${Y}`),e(!1),Z(null),await ce()}catch(ye){console.error("Error deleting universe",ye)}};se.useEffect(()=>{if(A==="universe-create")oe({nombre:"",descripcion:""});else if(A==="universe-edit"&&Y){const ye=Q.find(Pe=>Pe.id===Y);ye&&oe({nombre:ye.nombre,descripcion:ye.descripcion||""})}},[A,Y,Q]);const[Oe,_e]=se.useState({open:!1,type:null,id:null,title:"",message:""}),Ae=(ye,Pe)=>{Pe.stopPropagation(),_e({open:!0,type:"TIMELINE",id:ye,title:"Delete Timeline",message:"Are you sure you want to delete this timeline? All events will be lost."})},He=(ye,Pe)=>{Pe.stopPropagation(),_e({open:!0,type:"EVENT",id:ye,title:"Delete Event",message:"Are you sure you want to delete this event?"})},tt=async()=>{const{type:ye,id:Pe}=Oe;if(!(!ye||!Pe))try{if(ye==="TIMELINE"){if(await $e.delete(`/timeline/linea/${Pe}`),a===Pe){const Ge=Q.flatMap(et=>et.lineasTemporales||[]).filter(et=>et.id!==Pe);s(Ge.length>0?Ge[0].id:null)}await ce()}else ye==="EVENT"&&(await $e.delete(`/timeline/evento/${Pe}`),he(a),C&&C.id===Pe&&E(null))}catch(Be){console.error(Be),alert("Error deleting item")}},Ie=h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"p-4 border-b border-white/5",children:h.jsxs("div",{className:"flex bg-black/40 rounded-lg p-1 overflow-x-auto gap-1",children:[h.jsx("button",{onClick:()=>I("eventos"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${A==="eventos"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Eventos"}),h.jsx("button",{onClick:()=>I("anexos"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${A==="anexos"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Anexos"}),h.jsx("button",{onClick:()=>I("universo"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${A==="universo"?"bg-amber-600 text-white shadow-lg":"text-slate-500 hover:text-amber-500/80"}`,children:"Universo"})]})}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[A==="eventos"&&h.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:h.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[h.jsxs("h3",{className:"text-xs font-black uppercase text-primary mb-4 flex items-center justify-between",children:[C?"Edit Event":"New Event",C&&h.jsx("button",{onClick:()=>{E(null),w({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:o.length+1})},className:"text-[10px] text-slate-500 hover:text-white underline",children:"CANCEL"})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Title"}),h.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:b.nombre,onChange:ye=>w({...b,nombre:ye.target.value}),placeholder:"Event Name"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Date Label"}),h.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:b.fechaTexto,onChange:ye=>w({...b,fechaTexto:ye.target.value}),placeholder:"e.g. Year 500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Order (Sort)"}),h.jsx("input",{type:"text",className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:b.ordenAbsoluto,onChange:ye=>{const Pe=ye.target.value;/^[-+]?\d*$/.test(Pe)&&w({...b,ordenAbsoluto:Pe})},placeholder:"+/- Num"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Description"}),h.jsx("textarea",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary h-24 resize-none",value:b.descripcion,onChange:ye=>w({...b,descripcion:ye.target.value}),placeholder:"Describe what happened..."})]}),h.jsx("div",{className:"pt-2",children:h.jsx(yr,{variant:"primary",onClick:ee,className:"w-full justify-center",children:C?"Save Changes":"Create Event"})}),C&&h.jsx("button",{onClick:ye=>He(C.id,ye),className:"w-full text-center text-xs text-red-500 hover:text-red-400 py-2 border border-red-500/20 rounded-lg hover:bg-red-500/10 transition-colors",children:"Delete Event"})]})]})}),A==="anexos"&&h.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:h.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[h.jsx("h3",{className:"text-xs font-black uppercase text-primary mb-4",children:"Annexed Timelines"}),h.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Link other localized timelines to this one to verify chronological consistency."}),h.jsxs("div",{className:"space-y-2 mb-6",children:[D.map(ye=>h.jsxs("div",{className:"flex items-center justify-between p-2 bg-white/5 rounded-lg border border-white/5",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-xs text-slate-400",children:"timeline"}),h.jsx("span",{className:"text-xs font-bold text-slate-300",children:ye.nombre})]}),h.jsx("button",{onClick:()=>X(ye.id),className:"text-slate-500 hover:text-red-500",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"link_off"})})]},ye.id)),D.length===0&&h.jsx("span",{className:"text-xs text-slate-600 italic",children:"No linked timelines."})]}),h.jsx("h4",{className:"text-[10px] font-bold uppercase text-slate-400 mb-2",children:"Available to Link"}),h.jsxs("div",{className:"space-y-1",children:[U.map(ye=>h.jsxs("button",{onClick:()=>$(ye.id),className:"w-full flex items-center gap-2 p-2 hover:bg-white/5 rounded-lg text-left transition-colors group",children:[h.jsx("span",{className:"material-symbols-outlined text-xs text-green-500/50 group-hover:text-green-500",children:"add_link"}),h.jsx("span",{className:"text-xs text-slate-400 group-hover:text-white",children:ye.nombre})]},ye.id)),U.length===0&&h.jsx("span",{className:"text-xs text-slate-600 italic",children:"No other timelines available."})]})]})}),A==="universo"&&h.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:h.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[h.jsx("h3",{className:"text-xs font-black uppercase text-amber-500 mb-4",children:Y?"Edit Universe":"New Universe"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Universe Name"}),h.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:ae.nombre,onChange:ye=>oe({...ae,nombre:ye.target.value}),placeholder:"e.g. Alternate Reality 1"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Description"}),h.jsx("textarea",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary h-24 resize-none",value:ae.descripcion,onChange:ye=>oe({...ae,descripcion:ye.target.value}),placeholder:"Context for this universe..."})]}),h.jsx("div",{className:"pt-2",children:h.jsx(yr,{variant:"primary",onClick:Y?pe:fe,className:"w-full justify-center",children:Y?"Save Changes":"Create Universe"})}),Y&&h.jsx("button",{onClick:Te,className:"w-full text-center text-xs text-red-500 hover:text-red-400 py-2 border border-red-500/20 rounded-lg hover:bg-red-500/10 transition-colors",children:"Delete Universe"})]})]})})]})]});return h.jsxs("div",{className:"flex h-screen bg-background-dark text-white overflow-hidden",children:[M&&hl.createPortal(Ie,M),h.jsxs("aside",{className:"w-64 bg-surface-dark border-r border-white/5 flex flex-col p-4 z-20 shrink-0",children:[h.jsxs("header",{className:"flex justify-between items-center mb-6",children:[h.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-primary",children:"Multiverse"}),h.jsx("button",{onClick:()=>{t("CUSTOM"),I("universo"),Z(null),oe({nombre:"",descripcion:""}),e(!0)},className:"text-slate-400 hover:text-white",title:"New Universe",children:h.jsx("span",{className:"material-symbols-outlined",children:"add_circle"})})]}),h.jsx("div",{className:"space-y-6 overflow-y-auto flex-1 custom-scrollbar",children:Q.map(ye=>h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex items-center justify-between group",children:[h.jsx("h3",{className:`text-[10px] font-bold uppercase pl-2 cursor-pointer ${Y===ye.id?"text-white":"text-slate-500"}`,onClick:()=>{Z(ye.id),oe({nombre:ye.nombre,descripcion:ye.descripcion||""}),I("universo"),t("CUSTOM"),e(!0)},children:ye.nombre}),h.jsx("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:h.jsx("button",{onClick:()=>{k({...N,universoId:ye.id}),y(!0)},className:"text-slate-500 hover:text-primary",title:"Add Timeline here",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})})]}),g&&N.universoId===ye.id&&h.jsxs("div",{className:"ml-2 mb-2 p-2 bg-black/20 rounded-lg animate-in fade-in",children:[h.jsx("input",{className:"w-full bg-transparent border-b border-white/20 text-xs p-1 outline-none focus:border-primary mb-1",placeholder:"Timeline Name",value:N.nombre,onChange:Pe=>k({...N,nombre:Pe.target.value}),autoFocus:!0,onKeyDown:Pe=>Pe.key==="Enter"&&te()}),h.jsxs("div",{className:"flex justify-end gap-1",children:[h.jsx("button",{onClick:()=>y(!1),className:"text-[10px] text-slate-500 hover:text-white",children:"CANCEL"}),h.jsx("button",{onClick:te,className:"text-[10px] font-bold text-primary",children:"CREATE"})]})]}),h.jsxs("div",{className:"space-y-1 pl-2 border-l border-white/5 ml-1",children:[ye.lineasTemporales&&ye.lineasTemporales.map(Pe=>h.jsxs("div",{onClick:()=>{s(Pe.id),I("eventos"),t("CUSTOM"),e(!0)},className:`group flex items-center justify-between p-2 rounded-lg cursor-pointer transition-all ${a===Pe.id?"bg-primary/10 text-white shadow-[0_0_10px_rgba(var(--primary-rgb),0.1)]":"text-slate-400 hover:bg-white/5"}`,children:[h.jsx("span",{className:"text-xs truncate",children:Pe.nombre}),h.jsx("button",{onClick:Be=>Ae(Pe.id,Be),className:"opacity-0 group-hover:opacity-100 text-slate-500 hover:text-red-500 transition-opacity",children:h.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"delete"})})]},Pe.id)),(!ye.lineasTemporales||ye.lineasTemporales.length===0)&&h.jsx("div",{className:"p-2 text-[10px] italic text-slate-600",children:"No timelines here"})]})]},ye.id))})]}),h.jsxs("main",{className:"flex-1 relative flex flex-col h-full overflow-hidden bg-background-dark",children:[h.jsx("div",{className:"h-16 border-b border-white/5 bg-background-dark/80 backdrop-blur flex items-center px-8 z-10 shrink-0",children:h.jsx("div",{children:(()=>{const Pe=Q.flatMap(Be=>Be.lineasTemporales||[]).find(Be=>Be.id===a);return h.jsxs(h.Fragment,{children:[h.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[Pe?.esRaiz&&h.jsx("span",{className:"text-amber-400 material-symbols-outlined",children:"star"}),Pe?.nombre||"Select Timeline"]}),h.jsx("p",{className:"text-xs text-slate-500",children:Pe?.descripcion})]})})()})}),h.jsx("div",{className:"flex-1 overflow-y-auto p-8 relative custom-scrollbar z-10",children:h.jsxs("div",{className:"max-w-2xl mx-auto relative pl-8 border-l-2 border-white/10 space-y-8 pb-32",children:[o.length===0&&h.jsx("div",{className:"text-center text-slate-600 italic py-20",children:"No events yet. Use the right panel to add one."}),o.map((ye,Pe)=>h.jsxs("div",{className:"relative group animate-in fade-in slide-in-from-bottom-4",style:{animationDelay:`${Pe*50}ms`},children:[h.jsx("div",{className:"absolute top-6 -left-[41px] size-4 rounded-full bg-white/20 border-4 border-background-dark group-hover:bg-primary transition-colors cursor-pointer",onClick:()=>le(ye)}),h.jsxs("div",{className:"ml-4 bg-surface-dark/50 border border-white/5 p-5 rounded-2xl hover:border-primary/30 transition-all hover:bg-surface-dark group-hover:translate-x-1 duration-300 relative group/card",children:[h.jsxs("div",{className:"absolute top-3 right-3 opacity-0 group-hover/card:opacity-100 transition-opacity flex gap-1 bg-black/50 rounded-lg backdrop-blur-sm border border-white/5 p-1",children:[h.jsx("button",{onClick:()=>le(ye),className:"p-1.5 text-slate-400 hover:text-white hover:bg-white/10 rounded transition-colors",title:"Edit",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),h.jsx("button",{onClick:Be=>He(ye.id,Be),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-500/10 rounded transition-colors",title:"Delete",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),h.jsx("div",{className:"flex justify-between items-start",children:h.jsxs("div",{children:[h.jsxs("div",{className:"flex flex-col mb-1",children:[h.jsx("h3",{className:"text-lg font-bold text-white",children:ye.nombre}),h.jsx("span",{className:"text-xs font-mono font-bold text-primary opacity-80",children:ye.fechaTexto})]}),h.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:ye.descripcion})]})})]})]},ye.id))]})})]}),h.jsx(Cg,{isOpen:Oe.open,onClose:()=>_e({...Oe,open:!1}),onConfirm:tt,title:Oe.title,message:Oe.message,confirmText:"Delete",type:"danger"})]})},GB=({onCancel:t,onCreate:e})=>{const[r,n]=se.useState(1),[i,a]=se.useState("regional"),[s,o]=se.useState("upload");return h.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-xl animate-in fade-in duration-300",children:h.jsx("div",{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto no-scrollbar relative animate-in zoom-in-95 duration-500",children:h.jsxs(ir,{className:"p-0 border-white/10 shadow-[0_0_100px_rgba(0,0,0,0.5)] overflow-hidden",children:[h.jsxs("header",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"size-12 rounded-2xl bg-primary/20 text-primary flex items-center justify-center",children:h.jsx("span",{className:"material-symbols-outlined text-2xl",children:"add_location_alt"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-manrope font-black text-white tracking-tight",children:"Crear Nuevo Mapa / Zona"}),h.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Configura los detalles para tu nueva entrada cartogrfica."})]})]}),h.jsx("button",{onClick:t,className:"text-slate-500 hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),h.jsxs("div",{className:"p-12 space-y-12",children:[h.jsxs("section",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===1?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"1"}),h.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Identidad y Jerarqua"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pl-12",children:[h.jsx(HB,{label:"Nombre del Mapa",placeholder:"ej. La Costa de Zafiro"}),h.jsxs("div",{className:"space-y-1.5 row-span-2",children:[h.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Descripcin"}),h.jsx("textarea",{placeholder:"Breve descripcin de la geografa, clima o importancia...",className:"w-full h-[120px] bg-white/5 border border-white/5 rounded-2xl p-4 text-sm text-white focus:border-primary/50 outline-none transition-all resize-none"})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Zona Padre (Opcional)"}),h.jsxs("select",{className:"w-full bg-white/5 border border-white/5 rounded-2xl px-4 py-3 text-sm text-white focus:border-primary/50 outline-none appearance-none",children:[h.jsx("option",{children:"Ninguna (Nivel Superior)"}),h.jsx("option",{children:"Reino de Aethelgard"}),h.jsx("option",{children:"Continente de Aurum"})]}),h.jsx("p",{className:"text-[9px] text-slate-500 italic mt-1 ml-1 text-primary/70",children:"Seleccionar un padre convierte esto en sub-zona."})]})]})]}),h.jsx("div",{className:"h-px w-full bg-white/5"}),h.jsxs("section",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===2?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"2"}),h.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Tipo de Mapa"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 pl-12",children:[h.jsx(lw,{active:i==="world",onClick:()=>a("world"),icon:"public",label:"Mapa Mundial",desc:"Continentes, ocanos, escala global."}),h.jsx(lw,{active:i==="regional",onClick:()=>a("regional"),icon:"map",label:"Mapa Regional",desc:"Reinos, provincias, biomas."}),h.jsx(lw,{active:i==="local",onClick:()=>a("local"),icon:"location_city",label:"Ciudad / Local",desc:"Ciudades, mazmorras, mapas de batalla."})]})]}),h.jsx("div",{className:"h-px w-full bg-white/5"}),h.jsxs("section",{className:"space-y-6",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===3?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"3"}),h.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Fuente del Lienzo"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pl-12",children:[h.jsx(CE,{active:s==="upload",onClick:()=>o("upload"),icon:"cloud_upload",label:"Cargar Archivo de Imagen",desc:"Arrastra y suelta o haz clic para buscar",subdesc:"JPG, PNG, WEBP  MAX 25MB"}),h.jsx(CE,{active:s==="blank",onClick:()=>o("blank"),icon:"brush",label:"Lienzo en Blanco",desc:"Crear un nuevo dibujo desde cero",subdesc:"4096 px x 4096 px"})]})]})]}),h.jsxs("footer",{className:"p-8 bg-white/[0.02] border-t border-white/5 flex justify-between items-center",children:[h.jsx("button",{onClick:t,className:"text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"Cancelar"}),h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-600",children:"Cambios guardados localmente"}),h.jsx(yr,{variant:"primary",className:"px-10 py-3 shadow-xl",onClick:()=>e(s),children:"Crear Mapa"})]})]})]})})})},HB=({label:t,placeholder:e})=>h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:t}),h.jsx("input",{type:"text",placeholder:e,className:"w-full bg-white/5 border border-white/5 rounded-2xl px-4 py-3 text-sm text-white focus:border-primary/50 transition-all outline-none"})]}),lw=({active:t,onClick:e,icon:r,label:n,desc:i})=>h.jsxs("div",{onClick:e,className:`p-6 rounded-3xl border transition-all cursor-pointer group ${t?"bg-primary/10 border-primary shadow-lg shadow-primary/10":"bg-white/5 border-white/5 hover:border-white/10"}`,children:[h.jsx("div",{className:`size-10 rounded-xl mb-4 flex items-center justify-center transition-all ${t?"bg-primary text-white":"bg-white/5 text-slate-500 group-hover:text-slate-300"}`,children:h.jsx("span",{className:"material-symbols-outlined",children:r})}),h.jsx("h3",{className:`text-sm font-bold mb-1 transition-colors ${t?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:n}),h.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-medium",children:i})]}),CE=({active:t,onClick:e,icon:r,label:n,desc:i,subdesc:a})=>h.jsxs("div",{onClick:e,className:`p-10 rounded-[2.5rem] border transition-all cursor-pointer group flex flex-col items-center text-center gap-4 ${t?"bg-primary/5 border-primary shadow-lg":"bg-white/[0.02] border-white/5 hover:border-white/10 hover:bg-white/[0.04]"}`,children:[h.jsx("div",{className:`size-16 rounded-[2rem] flex items-center justify-center transition-all ${t?"bg-primary text-white shadow-xl shadow-primary/20":"bg-white/5 text-slate-600 group-hover:text-slate-400"}`,children:h.jsx("span",{className:"material-symbols-outlined text-3xl",children:r})}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("h3",{className:`font-bold transition-colors ${t?"text-white":"text-slate-400"}`,children:n}),h.jsx("p",{className:"text-xs text-slate-500 font-medium",children:i})]}),h.jsx("div",{className:"flex gap-2 mt-2",children:a.split("").map((s,o)=>h.jsx("span",{className:"px-2 py-1 rounded bg-black/20 text-[8px] font-black text-slate-600 tracking-tighter uppercase whitespace-nowrap",children:s.trim()},o))})]});var F0={exports:{}},Dp={},uw={},cw={},NE;function Vt(){return NE||(NE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof SC<"u"?SC:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.16",isBrowser:r(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return t.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var i;return(i=t.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(i){t.glob.Konva=i}};const n=i=>{t.Konva[i.prototype.getClassName()]=i};t._registerNode=n,t.Konva._injectGlobal(t.Konva)})(cw)),cw}var dw={},EE;function un(){return EE||(EE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=Vt();class r{constructor(E=[1,0,0,1,0,0]){this.dirty=!1,this.m=E&&E.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(E){E.m[0]=this.m[0],E.m[1]=this.m[1],E.m[2]=this.m[2],E.m[3]=this.m[3],E.m[4]=this.m[4],E.m[5]=this.m[5]}point(E){const P=this.m;return{x:P[0]*E.x+P[2]*E.y+P[4],y:P[1]*E.x+P[3]*E.y+P[5]}}translate(E,P){return this.m[4]+=this.m[0]*E+this.m[2]*P,this.m[5]+=this.m[1]*E+this.m[3]*P,this}scale(E,P){return this.m[0]*=E,this.m[1]*=E,this.m[2]*=P,this.m[3]*=P,this}rotate(E){const P=Math.cos(E),_=Math.sin(E),A=this.m[0]*P+this.m[2]*_,I=this.m[1]*P+this.m[3]*_,D=this.m[0]*-_+this.m[2]*P,L=this.m[1]*-_+this.m[3]*P;return this.m[0]=A,this.m[1]=I,this.m[2]=D,this.m[3]=L,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(E,P){const _=this.m[0]+this.m[2]*P,A=this.m[1]+this.m[3]*P,I=this.m[2]+this.m[0]*E,D=this.m[3]+this.m[1]*E;return this.m[0]=_,this.m[1]=A,this.m[2]=I,this.m[3]=D,this}multiply(E){const P=this.m[0]*E.m[0]+this.m[2]*E.m[1],_=this.m[1]*E.m[0]+this.m[3]*E.m[1],A=this.m[0]*E.m[2]+this.m[2]*E.m[3],I=this.m[1]*E.m[2]+this.m[3]*E.m[3],D=this.m[0]*E.m[4]+this.m[2]*E.m[5]+this.m[4],L=this.m[1]*E.m[4]+this.m[3]*E.m[5]+this.m[5];return this.m[0]=P,this.m[1]=_,this.m[2]=A,this.m[3]=I,this.m[4]=D,this.m[5]=L,this}invert(){const E=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),P=this.m[3]*E,_=-this.m[1]*E,A=-this.m[2]*E,I=this.m[0]*E,D=E*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),L=E*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=P,this.m[1]=_,this.m[2]=A,this.m[3]=I,this.m[4]=D,this.m[5]=L,this}getMatrix(){return this.m}decompose(){const E=this.m[0],P=this.m[1],_=this.m[2],A=this.m[3],I=this.m[4],D=this.m[5],L=E*A-P*_,U={x:I,y:D,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(E!=0||P!=0){const H=Math.sqrt(E*E+P*P);U.rotation=P>0?Math.acos(E/H):-Math.acos(E/H),U.scaleX=H,U.scaleY=L/H,U.skewX=(E*_+P*A)/L,U.skewY=0}else if(_!=0||A!=0){const H=Math.sqrt(_*_+A*A);U.rotation=Math.PI/2-(A>0?Math.acos(-_/H):-Math.acos(_/H)),U.scaleX=L/H,U.scaleY=H,U.skewX=0,U.skewY=(E*_+P*A)/L}return U.rotation=t.Util._getRotation(U.rotation),U}}t.Transform=r;let n="[object Array]",i="[object Number]",a="[object String]",s="[object Boolean]",o=Math.PI/180,l=180/Math.PI,u="#",c="",f="0",m="Konva warning: ",g="Konva error: ",y="rgb(",b={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},w=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,N=[];const k=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(C){setTimeout(C,60)};t.Util={_isElement(C){return!!(C&&C.nodeType==1)},_isFunction(C){return!!(C&&C.constructor&&C.call&&C.apply)},_isPlainObject(C){return!!C&&C.constructor===Object},_isArray(C){return Object.prototype.toString.call(C)===n},_isNumber(C){return Object.prototype.toString.call(C)===i&&!isNaN(C)&&isFinite(C)},_isString(C){return Object.prototype.toString.call(C)===a},_isBoolean(C){return Object.prototype.toString.call(C)===s},isObject(C){return C instanceof Object},isValidSelector(C){if(typeof C!="string")return!1;const E=C[0];return E==="#"||E==="."||E===E.toUpperCase()},_sign(C){return C===0||C>0?1:-1},requestAnimFrame(C){N.push(C),N.length===1&&k(function(){const E=N;N=[],E.forEach(function(P){P()})})},createCanvasElement(){const C=document.createElement("canvas");try{C.style=C.style||{}}catch{}return C},createImageElement(){return document.createElement("img")},_isInDocument(C){for(;C=C.parentNode;)if(C==document)return!0;return!1},_urlToImage(C,E){const P=t.Util.createImageElement();P.onload=function(){E(P)},P.src=C},_rgbToHex(C,E,P){return((1<<24)+(C<<16)+(E<<8)+P).toString(16).slice(1)},_hexToRgb(C){C=C.replace(u,c);const E=parseInt(C,16);return{r:E>>16&255,g:E>>8&255,b:E&255}},getRandomColor(){let C=(Math.random()*16777215<<0).toString(16);for(;C.length<6;)C=f+C;return u+C},getRGB(C){let E;return C in b?(E=b[C],{r:E[0],g:E[1],b:E[2]}):C[0]===u?this._hexToRgb(C.substring(1)):C.substr(0,4)===y?(E=w.exec(C.replace(/ /g,"")),{r:parseInt(E[1],10),g:parseInt(E[2],10),b:parseInt(E[3],10)}):{r:0,g:0,b:0}},colorToRGBA(C){return C=C||"black",t.Util._namedColorToRBA(C)||t.Util._hex3ColorToRGBA(C)||t.Util._hex4ColorToRGBA(C)||t.Util._hex6ColorToRGBA(C)||t.Util._hex8ColorToRGBA(C)||t.Util._rgbColorToRGBA(C)||t.Util._rgbaColorToRGBA(C)||t.Util._hslColorToRGBA(C)},_namedColorToRBA(C){const E=b[C.toLowerCase()];return E?{r:E[0],g:E[1],b:E[2],a:1}:null},_rgbColorToRGBA(C){if(C.indexOf("rgb(")===0){C=C.match(/rgb\(([^)]+)\)/)[1];const E=C.split(/ *, */).map(Number);return{r:E[0],g:E[1],b:E[2],a:1}}},_rgbaColorToRGBA(C){if(C.indexOf("rgba(")===0){C=C.match(/rgba\(([^)]+)\)/)[1];const E=C.split(/ *, */).map((P,_)=>P.slice(-1)==="%"?_===3?parseInt(P)/100:parseInt(P)/100*255:Number(P));return{r:E[0],g:E[1],b:E[2],a:E[3]}}},_hex8ColorToRGBA(C){if(C[0]==="#"&&C.length===9)return{r:parseInt(C.slice(1,3),16),g:parseInt(C.slice(3,5),16),b:parseInt(C.slice(5,7),16),a:parseInt(C.slice(7,9),16)/255}},_hex6ColorToRGBA(C){if(C[0]==="#"&&C.length===7)return{r:parseInt(C.slice(1,3),16),g:parseInt(C.slice(3,5),16),b:parseInt(C.slice(5,7),16),a:1}},_hex4ColorToRGBA(C){if(C[0]==="#"&&C.length===5)return{r:parseInt(C[1]+C[1],16),g:parseInt(C[2]+C[2],16),b:parseInt(C[3]+C[3],16),a:parseInt(C[4]+C[4],16)/255}},_hex3ColorToRGBA(C){if(C[0]==="#"&&C.length===4)return{r:parseInt(C[1]+C[1],16),g:parseInt(C[2]+C[2],16),b:parseInt(C[3]+C[3],16),a:1}},_hslColorToRGBA(C){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(C)){const[E,...P]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(C),_=Number(P[0])/360,A=Number(P[1])/100,I=Number(P[2])/100;let D,L,U;if(A===0)return U=I*255,{r:Math.round(U),g:Math.round(U),b:Math.round(U),a:1};I<.5?D=I*(1+A):D=I+A-I*A;const H=2*I-D,M=[0,0,0];for(let z=0;z<3;z++)L=_+1/3*-(z-1),L<0&&L++,L>1&&L--,6*L<1?U=H+(D-H)*6*L:2*L<1?U=D:3*L<2?U=H+(D-H)*(2/3-L)*6:U=H,M[z]=U*255;return{r:Math.round(M[0]),g:Math.round(M[1]),b:Math.round(M[2]),a:1}}},haveIntersection(C,E){return!(E.x>C.x+C.width||E.x+E.width<C.x||E.y>C.y+C.height||E.y+E.height<C.y)},cloneObject(C){const E={};for(const P in C)this._isPlainObject(C[P])?E[P]=this.cloneObject(C[P]):this._isArray(C[P])?E[P]=this.cloneArray(C[P]):E[P]=C[P];return E},cloneArray(C){return C.slice(0)},degToRad(C){return C*o},radToDeg(C){return C*l},_degToRad(C){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(C)},_radToDeg(C){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(C)},_getRotation(C){return e.Konva.angleDeg?t.Util.radToDeg(C):C},_capitalize(C){return C.charAt(0).toUpperCase()+C.slice(1)},throw(C){throw new Error(g+C)},error(C){console.error(g+C)},warn(C){e.Konva.showWarnings&&console.warn(m+C)},each(C,E){for(const P in C)E(P,C[P])},_inRange(C,E,P){return E<=C&&C<P},_getProjectionToSegment(C,E,P,_,A,I){let D,L,U;const H=(C-P)*(C-P)+(E-_)*(E-_);if(H==0)D=C,L=E,U=(A-P)*(A-P)+(I-_)*(I-_);else{const M=((A-C)*(P-C)+(I-E)*(_-E))/H;M<0?(D=C,L=E,U=(C-A)*(C-A)+(E-I)*(E-I)):M>1?(D=P,L=_,U=(P-A)*(P-A)+(_-I)*(_-I)):(D=C+M*(P-C),L=E+M*(_-E),U=(D-A)*(D-A)+(L-I)*(L-I))}return[D,L,U]},_getProjectionToLine(C,E,P){const _=t.Util.cloneObject(C);let A=Number.MAX_VALUE;return E.forEach(function(I,D){if(!P&&D===E.length-1)return;const L=E[(D+1)%E.length],U=t.Util._getProjectionToSegment(I.x,I.y,L.x,L.y,C.x,C.y),H=U[0],M=U[1],z=U[2];z<A&&(_.x=H,_.y=M,A=z)}),_},_prepareArrayForTween(C,E,P){let _,A=[],I=[];if(C.length>E.length){const L=E;E=C,C=L}for(_=0;_<C.length;_+=2)A.push({x:C[_],y:C[_+1]});for(_=0;_<E.length;_+=2)I.push({x:E[_],y:E[_+1]});const D=[];return I.forEach(function(L){const U=t.Util._getProjectionToLine(L,A,P);D.push(U.x),D.push(U.y)}),D},_prepareToStringify(C){let E;C.visitedByCircularReferenceRemoval=!0;for(const P in C)if(C.hasOwnProperty(P)&&C[P]&&typeof C[P]=="object"){if(E=Object.getOwnPropertyDescriptor(C,P),C[P].visitedByCircularReferenceRemoval||t.Util._isElement(C[P]))if(E.configurable)delete C[P];else return null;else if(t.Util._prepareToStringify(C[P])===null)if(E.configurable)delete C[P];else return null}return delete C.visitedByCircularReferenceRemoval,C},_assign(C,E){for(const P in E)C[P]=E[P];return C},_getFirstPointerId(C){return C.touches?C.changedTouches[0].identifier:C.pointerId||999},releaseCanvas(...C){e.Konva.releaseCanvasOnDestroy&&C.forEach(E=>{E.width=0,E.height=0})},drawRoundedRectPath(C,E,P,_){let A=0,I=0,D=0,L=0;typeof _=="number"?A=I=D=L=Math.min(_,E/2,P/2):(A=Math.min(_[0]||0,E/2,P/2),I=Math.min(_[1]||0,E/2,P/2),L=Math.min(_[2]||0,E/2,P/2),D=Math.min(_[3]||0,E/2,P/2)),C.moveTo(A,0),C.lineTo(E-I,0),C.arc(E-I,I,I,Math.PI*3/2,0,!1),C.lineTo(E,P-L),C.arc(E-L,P-L,L,0,Math.PI/2,!1),C.lineTo(D,P),C.arc(D,P-D,D,Math.PI/2,Math.PI,!1),C.lineTo(0,A),C.arc(A,A,A,Math.PI,Math.PI*3/2,!1)}}})(dw)),dw}var Op={},fw={},ga={},TE;function Wt(){if(TE)return ga;TE=1,Object.defineProperty(ga,"__esModule",{value:!0}),ga.RGBComponent=n,ga.alphaComponent=i,ga.getNumberValidator=a,ga.getNumberOrArrayOfNumbersValidator=s,ga.getNumberOrAutoValidator=o,ga.getStringValidator=l,ga.getStringOrGradientValidator=u,ga.getFunctionValidator=c,ga.getNumberArrayValidator=f,ga.getBooleanValidator=m,ga.getComponentValidator=g;const t=Vt(),e=un();function r(y){return e.Util._isString(y)?'"'+y+'"':Object.prototype.toString.call(y)==="[object Number]"||e.Util._isBoolean(y)?y:Object.prototype.toString.call(y)}function n(y){return y>255?255:y<0?0:Math.round(y)}function i(y){return y>1?1:y<1e-4?1e-4:y}function a(){if(t.Konva.isUnminified)return function(y,b){return e.Util._isNumber(y)||e.Util.warn(r(y)+' is a not valid value for "'+b+'" attribute. The value should be a number.'),y}}function s(y){if(t.Konva.isUnminified)return function(b,w){const N=e.Util._isNumber(b),k=e.Util._isArray(b)&&b.length==y;return!N&&!k&&e.Util.warn(r(b)+' is a not valid value for "'+w+'" attribute. The value should be a number or Array<number>('+y+")"),b}}function o(){if(t.Konva.isUnminified)return function(y,b){return e.Util._isNumber(y)||y==="auto"||e.Util.warn(r(y)+' is a not valid value for "'+b+'" attribute. The value should be a number or "auto".'),y}}function l(){if(t.Konva.isUnminified)return function(y,b){return e.Util._isString(y)||e.Util.warn(r(y)+' is a not valid value for "'+b+'" attribute. The value should be a string.'),y}}function u(){if(t.Konva.isUnminified)return function(y,b){const w=e.Util._isString(y),N=Object.prototype.toString.call(y)==="[object CanvasGradient]"||y&&y.addColorStop;return w||N||e.Util.warn(r(y)+' is a not valid value for "'+b+'" attribute. The value should be a string or a native gradient.'),y}}function c(){if(t.Konva.isUnminified)return function(y,b){return e.Util._isFunction(y)||e.Util.warn(r(y)+' is a not valid value for "'+b+'" attribute. The value should be a function.'),y}}function f(){if(t.Konva.isUnminified)return function(y,b){const w=Int8Array?Object.getPrototypeOf(Int8Array):null;return w&&y instanceof w||(e.Util._isArray(y)?y.forEach(function(N){e.Util._isNumber(N)||e.Util.warn('"'+b+'" attribute has non numeric element '+N+". Make sure that all elements are numbers.")}):e.Util.warn(r(y)+' is a not valid value for "'+b+'" attribute. The value should be a array of numbers.')),y}}function m(){if(t.Konva.isUnminified)return function(y,b){return y===!0||y===!1||e.Util.warn(r(y)+' is a not valid value for "'+b+'" attribute. The value should be a boolean.'),y}}function g(y){if(t.Konva.isUnminified)return function(b,w){return b==null||e.Util.isObject(b)||e.Util.warn(r(b)+' is a not valid value for "'+w+'" attribute. The value should be an object with properties '+y),b}}return ga}var jE;function Ht(){return jE||(jE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=un(),r=Wt(),n="get",i="set";t.Factory={addGetterSetter(a,s,o,l,u){t.Factory.addGetter(a,s,o),t.Factory.addSetter(a,s,l,u),t.Factory.addOverloadedGetterSetter(a,s)},addGetter(a,s,o){const l=n+e.Util._capitalize(s);a.prototype[l]=a.prototype[l]||function(){const u=this.attrs[s];return u===void 0?o:u}},addSetter(a,s,o,l){const u=i+e.Util._capitalize(s);a.prototype[u]||t.Factory.overWriteSetter(a,s,o,l)},overWriteSetter(a,s,o,l){const u=i+e.Util._capitalize(s);a.prototype[u]=function(c){return o&&c!==void 0&&c!==null&&(c=o.call(this,c,s)),this._setAttr(s,c),l&&l.call(this),this}},addComponentsGetterSetter(a,s,o,l,u){let c=o.length,f=e.Util._capitalize,m=n+f(s),g=i+f(s),y,b;a.prototype[m]=function(){const N={};for(y=0;y<c;y++)b=o[y],N[b]=this.getAttr(s+f(b));return N};const w=(0,r.getComponentValidator)(o);a.prototype[g]=function(N){let k=this.attrs[s],C;l&&(N=l.call(this,N)),w&&w.call(this,N,s);for(C in N)N.hasOwnProperty(C)&&this._setAttr(s+f(C),N[C]);return N||o.forEach(E=>{this._setAttr(s+f(E),void 0)}),this._fireChangeEvent(s,k,N),u&&u.call(this),this},t.Factory.addOverloadedGetterSetter(a,s)},addOverloadedGetterSetter(a,s){const o=e.Util._capitalize(s),l=i+o,u=n+o;a.prototype[s]=function(){return arguments.length?(this[l](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,s,o,l){e.Util.error("Adding deprecated "+s);const u=n+e.Util._capitalize(s),c=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){e.Util.error(c);const f=this.attrs[s];return f===void 0?o:f},t.Factory.addSetter(a,s,l,function(){e.Util.error(c)}),t.Factory.addOverloadedGetterSetter(a,s)},backCompat(a,s){e.Util.each(s,function(o,l){const u=a.prototype[l],c=n+e.Util._capitalize(o),f=i+e.Util._capitalize(o);function m(){u.apply(this,arguments),e.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}a.prototype[o]=m,a.prototype[c]=m,a.prototype[f]=m})},afterSetFilter(){this._filterUpToDate=!1}}})(fw)),fw}var tl={},rl={},PE;function aP(){if(PE)return rl;PE=1,Object.defineProperty(rl,"__esModule",{value:!0}),rl.HitContext=rl.SceneContext=rl.Context=void 0;const t=un(),e=Vt();function r(N){let k=[],C=N.length,E=t.Util,P,_;for(P=0;P<C;P++)_=N[P],E._isNumber(_)?_=Math.round(_*1e3)/1e3:E._isString(_)||(_=_+""),k.push(_);return k}const n=",",i="(",a=")",s="([",o="])",l=";",u="()",c="=",f=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],m=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],g=100;let y=class{constructor(k){this.canvas=k,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(k){k.fillEnabled()&&this._fill(k)}_fill(k){}strokeShape(k){k.hasStroke()&&this._stroke(k)}_stroke(k){}fillStrokeShape(k){k.attrs.fillAfterStrokeEnabled?(this.strokeShape(k),this.fillShape(k)):(this.fillShape(k),this.strokeShape(k))}getTrace(k,C){let E=this.traceArr,P=E.length,_="",A,I,D,L;for(A=0;A<P;A++)I=E[A],D=I.method,D?(L=I.args,_+=D,k?_+=u:t.Util._isArray(L[0])?_+=s+L.join(n)+o:(C&&(L=L.map(U=>typeof U=="number"?Math.floor(U):U)),_+=i+L.join(n)+a)):(_+=I.property,k||(_+=c+I.val)),_+=l;return _}clearTrace(){this.traceArr=[]}_trace(k){let C=this.traceArr,E;C.push(k),E=C.length,E>=g&&C.shift()}reset(){const k=this.getCanvas().getPixelRatio();this.setTransform(1*k,0,0,1*k,0,0)}getCanvas(){return this.canvas}clear(k){const C=this.getCanvas();k?this.clearRect(k.x||0,k.y||0,k.width||0,k.height||0):this.clearRect(0,0,C.getWidth()/C.pixelRatio,C.getHeight()/C.pixelRatio)}_applyLineCap(k){const C=k.attrs.lineCap;C&&this.setAttr("lineCap",C)}_applyOpacity(k){const C=k.getAbsoluteOpacity();C!==1&&this.setAttr("globalAlpha",C)}_applyLineJoin(k){const C=k.attrs.lineJoin;C&&this.setAttr("lineJoin",C)}setAttr(k,C){this._context[k]=C}arc(k,C,E,P,_,A){this._context.arc(k,C,E,P,_,A)}arcTo(k,C,E,P,_){this._context.arcTo(k,C,E,P,_)}beginPath(){this._context.beginPath()}bezierCurveTo(k,C,E,P,_,A){this._context.bezierCurveTo(k,C,E,P,_,A)}clearRect(k,C,E,P){this._context.clearRect(k,C,E,P)}clip(...k){this._context.clip.apply(this._context,k)}closePath(){this._context.closePath()}createImageData(k,C){const E=arguments;if(E.length===2)return this._context.createImageData(k,C);if(E.length===1)return this._context.createImageData(k)}createLinearGradient(k,C,E,P){return this._context.createLinearGradient(k,C,E,P)}createPattern(k,C){return this._context.createPattern(k,C)}createRadialGradient(k,C,E,P,_,A){return this._context.createRadialGradient(k,C,E,P,_,A)}drawImage(k,C,E,P,_,A,I,D,L){const U=arguments,H=this._context;U.length===3?H.drawImage(k,C,E):U.length===5?H.drawImage(k,C,E,P,_):U.length===9&&H.drawImage(k,C,E,P,_,A,I,D,L)}ellipse(k,C,E,P,_,A,I,D){this._context.ellipse(k,C,E,P,_,A,I,D)}isPointInPath(k,C,E,P){return E?this._context.isPointInPath(E,k,C,P):this._context.isPointInPath(k,C,P)}fill(...k){this._context.fill.apply(this._context,k)}fillRect(k,C,E,P){this._context.fillRect(k,C,E,P)}strokeRect(k,C,E,P){this._context.strokeRect(k,C,E,P)}fillText(k,C,E,P){P?this._context.fillText(k,C,E,P):this._context.fillText(k,C,E)}measureText(k){return this._context.measureText(k)}getImageData(k,C,E,P){return this._context.getImageData(k,C,E,P)}lineTo(k,C){this._context.lineTo(k,C)}moveTo(k,C){this._context.moveTo(k,C)}rect(k,C,E,P){this._context.rect(k,C,E,P)}roundRect(k,C,E,P,_){this._context.roundRect(k,C,E,P,_)}putImageData(k,C,E){this._context.putImageData(k,C,E)}quadraticCurveTo(k,C,E,P){this._context.quadraticCurveTo(k,C,E,P)}restore(){this._context.restore()}rotate(k){this._context.rotate(k)}save(){this._context.save()}scale(k,C){this._context.scale(k,C)}setLineDash(k){this._context.setLineDash?this._context.setLineDash(k):"mozDash"in this._context?this._context.mozDash=k:"webkitLineDash"in this._context&&(this._context.webkitLineDash=k)}getLineDash(){return this._context.getLineDash()}setTransform(k,C,E,P,_,A){this._context.setTransform(k,C,E,P,_,A)}stroke(k){k?this._context.stroke(k):this._context.stroke()}strokeText(k,C,E,P){this._context.strokeText(k,C,E,P)}transform(k,C,E,P,_,A){this._context.transform(k,C,E,P,_,A)}translate(k,C){this._context.translate(k,C)}_enableTrace(){let k=this,C=f.length,E=this.setAttr,P,_;const A=function(I){let D=k[I],L;k[I]=function(){return _=r(Array.prototype.slice.call(arguments,0)),L=D.apply(k,arguments),k._trace({method:I,args:_}),L}};for(P=0;P<C;P++)A(f[P]);k.setAttr=function(){E.apply(k,arguments);const I=arguments[0];let D=arguments[1];(I==="shadowOffsetX"||I==="shadowOffsetY"||I==="shadowBlur")&&(D=D/this.canvas.getPixelRatio()),k._trace({property:I,val:D})}}_applyGlobalCompositeOperation(k){const C=k.attrs.globalCompositeOperation;!C||C==="source-over"||this.setAttr("globalCompositeOperation",C)}};rl.Context=y,m.forEach(function(N){Object.defineProperty(y.prototype,N,{get(){return this._context[N]},set(k){this._context[N]=k}})});class b extends y{constructor(k,{willReadFrequently:C=!1}={}){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:C})}_fillColor(k){const C=k.fill();this.setAttr("fillStyle",C),k._fillFunc(this)}_fillPattern(k){this.setAttr("fillStyle",k._getFillPattern()),k._fillFunc(this)}_fillLinearGradient(k){const C=k._getLinearGradient();C&&(this.setAttr("fillStyle",C),k._fillFunc(this))}_fillRadialGradient(k){const C=k._getRadialGradient();C&&(this.setAttr("fillStyle",C),k._fillFunc(this))}_fill(k){const C=k.fill(),E=k.getFillPriority();if(C&&E==="color"){this._fillColor(k);return}const P=k.getFillPatternImage();if(P&&E==="pattern"){this._fillPattern(k);return}const _=k.getFillLinearGradientColorStops();if(_&&E==="linear-gradient"){this._fillLinearGradient(k);return}const A=k.getFillRadialGradientColorStops();if(A&&E==="radial-gradient"){this._fillRadialGradient(k);return}C?this._fillColor(k):P?this._fillPattern(k):_?this._fillLinearGradient(k):A&&this._fillRadialGradient(k)}_strokeLinearGradient(k){const C=k.getStrokeLinearGradientStartPoint(),E=k.getStrokeLinearGradientEndPoint(),P=k.getStrokeLinearGradientColorStops(),_=this.createLinearGradient(C.x,C.y,E.x,E.y);if(P){for(let A=0;A<P.length;A+=2)_.addColorStop(P[A],P[A+1]);this.setAttr("strokeStyle",_)}}_stroke(k){const C=k.dash(),E=k.getStrokeScaleEnabled();if(k.hasStroke()){if(!E){this.save();const _=this.getCanvas().getPixelRatio();this.setTransform(_,0,0,_,0,0)}this._applyLineCap(k),C&&k.dashEnabled()&&(this.setLineDash(C),this.setAttr("lineDashOffset",k.dashOffset())),this.setAttr("lineWidth",k.strokeWidth()),k.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),k.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(k):this.setAttr("strokeStyle",k.stroke()),k._strokeFunc(this),E||this.restore()}}_applyShadow(k){var C,E,P;const _=(C=k.getShadowRGBA())!==null&&C!==void 0?C:"black",A=(E=k.getShadowBlur())!==null&&E!==void 0?E:5,I=(P=k.getShadowOffset())!==null&&P!==void 0?P:{x:0,y:0},D=k.getAbsoluteScale(),L=this.canvas.getPixelRatio(),U=D.x*L,H=D.y*L;this.setAttr("shadowColor",_),this.setAttr("shadowBlur",A*Math.min(Math.abs(U),Math.abs(H))),this.setAttr("shadowOffsetX",I.x*U),this.setAttr("shadowOffsetY",I.y*H)}}rl.SceneContext=b;class w extends y{constructor(k){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:!0})}_fill(k){this.save(),this.setAttr("fillStyle",k.colorKey),k._fillFuncHit(this),this.restore()}strokeShape(k){k.hasHitStroke()&&this._stroke(k)}_stroke(k){if(k.hasHitStroke()){const C=k.getStrokeScaleEnabled();if(!C){this.save();const _=this.getCanvas().getPixelRatio();this.setTransform(_,0,0,_,0,0)}this._applyLineCap(k);const E=k.hitStrokeWidth(),P=E==="auto"?k.strokeWidth():E;this.setAttr("lineWidth",P),this.setAttr("strokeStyle",k.colorKey),k._strokeFuncHit(this),C||this.restore()}}}return rl.HitContext=w,rl}var ME;function Sx(){if(ME)return tl;ME=1,Object.defineProperty(tl,"__esModule",{value:!0}),tl.HitCanvas=tl.SceneCanvas=tl.Canvas=void 0;const t=un(),e=aP(),r=Vt(),n=Ht(),i=Wt();let a;function s(){if(a)return a;const c=t.Util.createCanvasElement(),f=c.getContext("2d");return a=(function(){const m=r.Konva._global.devicePixelRatio||1,g=f.webkitBackingStorePixelRatio||f.mozBackingStorePixelRatio||f.msBackingStorePixelRatio||f.oBackingStorePixelRatio||f.backingStorePixelRatio||1;return m/g})(),t.Util.releaseCanvas(c),a}let o=class{constructor(f){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const g=(f||{}).pixelRatio||r.Konva.pixelRatio||s();this.pixelRatio=g,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(f){const m=this.pixelRatio;this.pixelRatio=f,this.setSize(this.getWidth()/m,this.getHeight()/m)}setWidth(f){this.width=this._canvas.width=f*this.pixelRatio,this._canvas.style.width=f+"px";const m=this.pixelRatio;this.getContext()._context.scale(m,m)}setHeight(f){this.height=this._canvas.height=f*this.pixelRatio,this._canvas.style.height=f+"px";const m=this.pixelRatio;this.getContext()._context.scale(m,m)}getWidth(){return this.width}getHeight(){return this.height}setSize(f,m){this.setWidth(f||0),this.setHeight(m||0)}toDataURL(f,m){try{return this._canvas.toDataURL(f,m)}catch{try{return this._canvas.toDataURL()}catch(y){return t.Util.error("Unable to get data URL. "+y.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};tl.Canvas=o,n.Factory.addGetterSetter(o,"pixelRatio",void 0,(0,i.getNumberValidator)());class l extends o{constructor(f={width:0,height:0,willReadFrequently:!1}){super(f),this.context=new e.SceneContext(this,{willReadFrequently:f.willReadFrequently}),this.setSize(f.width,f.height)}}tl.SceneCanvas=l;class u extends o{constructor(f={width:0,height:0}){super(f),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(f.width,f.height)}}return tl.HitCanvas=u,tl}var hw={},_E;function $S(){return _E||(_E=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=Vt(),r=un();t.DD={get isDragging(){let n=!1;return t.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return t.DD._dragElements.forEach(i=>{n=i.node}),n},_dragElements:new Map,_drag(n){const i=[];t.DD._dragElements.forEach((a,s)=>{const{node:o}=a,l=o.getStage();l.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=l._changedPointerPositions.find(c=>c.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const c=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<c||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),i.push(o)}}),i.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const i=[];t.DD._dragElements.forEach(a=>{const{node:s}=a,o=s.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(c=>c.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof e.Konva.Stage&&a.node;u&&i.indexOf(u)===-1&&i.push(u)}),i.forEach(a=>{a.draw()})},_endDragAfter(n){t.DD._dragElements.forEach((i,a)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:n},!0),i.dragStatus!=="dragging"&&t.DD._dragElements.delete(a)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(hw)),hw}var AE;function bn(){if(AE)return Op;AE=1,Object.defineProperty(Op,"__esModule",{value:!0}),Op.Node=void 0;const t=un(),e=Ht(),r=Sx(),n=Vt(),i=$S(),a=Wt(),s="absoluteOpacity",o="allEventListeners",l="absoluteTransform",u="absoluteScale",c="canvas",f="Change",m="children",g="konva",y="listening",b="mouseenter",w="mouseleave",N="set",k="Shape",C=" ",E="stage",P="transform",_="Stage",A="visible",I=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(C);let D=1;class L{constructor(M){this._id=D++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(M),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(M){(M===P||M===l)&&this._cache.get(M)?this._cache.get(M).dirty=!0:M?this._cache.delete(M):this._cache.clear()}_getCache(M,z){let O=this._cache.get(M);return(O===void 0||(M===P||M===l)&&O.dirty===!0)&&(O=z.call(this),this._cache.set(M,O)),O}_calculate(M,z,O){if(!this._attachedDepsListeners.get(M)){const G=z.map(W=>W+"Change.konva").join(C);this.on(G,()=>{this._clearCache(M)}),this._attachedDepsListeners.set(M,!0)}return this._getCache(M,O)}_getCanvasCache(){return this._cache.get(c)}_clearSelfAndDescendantCache(M){this._clearCache(M),M===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(c)){const{scene:M,filter:z,hit:O}=this._cache.get(c);t.Util.releaseCanvas(M,z,O),this._cache.delete(c)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(M){const z=M||{};let O={};(z.x===void 0||z.y===void 0||z.width===void 0||z.height===void 0)&&(O=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let G=Math.ceil(z.width||O.width),W=Math.ceil(z.height||O.height),$=z.pixelRatio,X=z.x===void 0?Math.floor(O.x):z.x,Q=z.y===void 0?Math.floor(O.y):z.y,V=z.offset||0,Y=z.drawBorder||!1,Z=z.hitCanvasPixelRatio||1;if(!G||!W){t.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const ie=Math.abs(Math.round(O.x)-X)>.5?1:0,ce=Math.abs(Math.round(O.y)-Q)>.5?1:0;G+=V*2+ie,W+=V*2+ce,X-=V,Q-=V;const he=new r.SceneCanvas({pixelRatio:$,width:G,height:W}),ee=new r.SceneCanvas({pixelRatio:$,width:0,height:0,willReadFrequently:!0}),le=new r.HitCanvas({pixelRatio:Z,width:G,height:W}),te=he.getContext(),ae=le.getContext();return le.isCache=!0,he.isCache=!0,this._cache.delete(c),this._filterUpToDate=!1,z.imageSmoothingEnabled===!1&&(he.getContext()._context.imageSmoothingEnabled=!1,ee.getContext()._context.imageSmoothingEnabled=!1),te.save(),ae.save(),te.translate(-X,-Q),ae.translate(-X,-Q),this._isUnderCache=!0,this._clearSelfAndDescendantCache(s),this._clearSelfAndDescendantCache(u),this.drawScene(he,this),this.drawHit(le,this),this._isUnderCache=!1,te.restore(),ae.restore(),Y&&(te.save(),te.beginPath(),te.rect(0,0,G,W),te.closePath(),te.setAttr("strokeStyle","red"),te.setAttr("lineWidth",5),te.stroke(),te.restore()),this._cache.set(c,{scene:he,filter:ee,hit:le,x:X,y:Q}),this._requestDraw(),this}isCached(){return this._cache.has(c)}getClientRect(M){throw new Error('abstract "getClientRect" method call')}_transformedRect(M,z){const O=[{x:M.x,y:M.y},{x:M.x+M.width,y:M.y},{x:M.x+M.width,y:M.y+M.height},{x:M.x,y:M.y+M.height}];let G=1/0,W=1/0,$=-1/0,X=-1/0;const Q=this.getAbsoluteTransform(z);return O.forEach(function(V){const Y=Q.point(V);G===void 0&&(G=$=Y.x,W=X=Y.y),G=Math.min(G,Y.x),W=Math.min(W,Y.y),$=Math.max($,Y.x),X=Math.max(X,Y.y)}),{x:G,y:W,width:$-G,height:X-W}}_drawCachedSceneCanvas(M){M.save(),M._applyOpacity(this),M._applyGlobalCompositeOperation(this);const z=this._getCanvasCache();M.translate(z.x,z.y);const O=this._getCachedSceneCanvas(),G=O.pixelRatio;M.drawImage(O._canvas,0,0,O.width/G,O.height/G),M.restore()}_drawCachedHitCanvas(M){const z=this._getCanvasCache(),O=z.hit;M.save(),M.translate(z.x,z.y),M.drawImage(O._canvas,0,0,O.width/O.pixelRatio,O.height/O.pixelRatio),M.restore()}_getCachedSceneCanvas(){let M=this.filters(),z=this._getCanvasCache(),O=z.scene,G=z.filter,W=G.getContext(),$,X,Q,V;if(M){if(!this._filterUpToDate){const Y=O.pixelRatio;G.setSize(O.width/O.pixelRatio,O.height/O.pixelRatio);try{for($=M.length,W.clear(),W.drawImage(O._canvas,0,0,O.getWidth()/Y,O.getHeight()/Y),X=W.getImageData(0,0,G.getWidth(),G.getHeight()),Q=0;Q<$;Q++){if(V=M[Q],typeof V!="function"){t.Util.error("Filter should be type of function, but got "+typeof V+" instead. Please check correct filters");continue}V.call(this,X),W.putImageData(X,0,0)}}catch(Z){t.Util.error("Unable to apply filter. "+Z.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return G}return O}on(M,z){if(this._cache&&this._cache.delete(o),arguments.length===3)return this._delegate.apply(this,arguments);let O=M.split(C),G=O.length,W,$,X,Q,V;for(W=0;W<G;W++)$=O[W],X=$.split("."),Q=X[0],V=X[1]||"",this.eventListeners[Q]||(this.eventListeners[Q]=[]),this.eventListeners[Q].push({name:V,handler:z});return this}off(M,z){let O=(M||"").split(C),G=O.length,W,$,X,Q,V,Y;if(this._cache&&this._cache.delete(o),!M)for($ in this.eventListeners)this._off($);for(W=0;W<G;W++)if(X=O[W],Q=X.split("."),V=Q[0],Y=Q[1],V)this.eventListeners[V]&&this._off(V,Y,z);else for($ in this.eventListeners)this._off($,Y,z);return this}dispatchEvent(M){const z={target:this,type:M.type,evt:M};return this.fire(M.type,z),this}addEventListener(M,z){return this.on(M,function(O){z.call(this,O.evt)}),this}removeEventListener(M){return this.off(M),this}_delegate(M,z,O){const G=this;this.on(M,function(W){const $=W.target.findAncestors(z,!0,G);for(let X=0;X<$.length;X++)W=t.Util.cloneObject(W),W.currentTarget=$[X],O.call($[X],W)})}remove(){return this.isDragging()&&this.stopDrag(),i.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(s),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(E),this._clearSelfAndDescendantCache(A),this._clearSelfAndDescendantCache(y)}_remove(){this._clearCaches();const M=this.getParent();M&&M.children&&(M.children.splice(this.index,1),M._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(M){const z="get"+t.Util._capitalize(M);return t.Util._isFunction(this[z])?this[z]():this.attrs[M]}getAncestors(){let M=this.getParent(),z=[];for(;M;)z.push(M),M=M.getParent();return z}getAttrs(){return this.attrs||{}}setAttrs(M){return this._batchTransformChanges(()=>{let z,O;if(!M)return this;for(z in M)z!==m&&(O=N+t.Util._capitalize(z),t.Util._isFunction(this[O])?this[O](M[z]):this._setAttr(z,M[z]))}),this}isListening(){return this._getCache(y,this._isListening)}_isListening(M){if(!this.listening())return!1;const O=this.getParent();return O&&O!==M&&this!==M?O._isListening(M):!0}isVisible(){return this._getCache(A,this._isVisible)}_isVisible(M){if(!this.visible())return!1;const O=this.getParent();return O&&O!==M&&this!==M?O._isVisible(M):!0}shouldDrawHit(M,z=!1){if(M)return this._isVisible(M)&&this._isListening(M);const O=this.getLayer();let G=!1;i.DD._dragElements.forEach($=>{$.dragStatus==="dragging"&&($.node.nodeType==="Stage"||$.node.getLayer()===O)&&(G=!0)});const W=!z&&!n.Konva.hitOnDragEnabled&&(G||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!W}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let M=this.getDepth(),z=this,O=0,G,W,$,X;function Q(Y){for(G=[],W=Y.length,$=0;$<W;$++)X=Y[$],O++,X.nodeType!==k&&(G=G.concat(X.getChildren().slice())),X._id===z._id&&($=W);G.length>0&&G[0].getDepth()<=M&&Q(G)}const V=this.getStage();return z.nodeType!==_&&V&&Q(V.getChildren()),O}getDepth(){let M=0,z=this.parent;for(;z;)M++,z=z.parent;return M}_batchTransformChanges(M){this._batchingTransformChange=!0,M(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(P),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(M){return this._batchTransformChanges(()=>{this.x(M.x),this.y(M.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const M=this.getStage();if(!M)return null;const z=M.getPointerPosition();if(!z)return null;const O=this.getAbsoluteTransform().copy();return O.invert(),O.point(z)}getAbsolutePosition(M){let z=!1,O=this.parent;for(;O;){if(O.isCached()){z=!0;break}O=O.parent}z&&!M&&(M=!0);const G=this.getAbsoluteTransform(M).getMatrix(),W=new t.Transform,$=this.offset();return W.m=G.slice(),W.translate($.x,$.y),W.getTranslation()}setAbsolutePosition(M){const{x:z,y:O,...G}=this._clearTransform();this.attrs.x=z,this.attrs.y=O,this._clearCache(P);const W=this._getAbsoluteTransform().copy();return W.invert(),W.translate(M.x,M.y),M={x:this.attrs.x+W.getTranslation().x,y:this.attrs.y+W.getTranslation().y},this._setTransform(G),this.setPosition({x:M.x,y:M.y}),this._clearCache(P),this._clearSelfAndDescendantCache(l),this}_setTransform(M){let z;for(z in M)this.attrs[z]=M[z]}_clearTransform(){const M={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,M}move(M){let z=M.x,O=M.y,G=this.x(),W=this.y();return z!==void 0&&(G+=z),O!==void 0&&(W+=O),this.setPosition({x:G,y:W}),this}_eachAncestorReverse(M,z){let O=[],G=this.getParent(),W,$;if(!(z&&z._id===this._id)){for(O.unshift(this);G&&(!z||G._id!==z._id);)O.unshift(G),G=G.parent;for(W=O.length,$=0;$<W;$++)M(O[$])}}rotate(M){return this.rotation(this.rotation()+M),this}moveToTop(){if(!this.parent)return t.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const M=this.index,z=this.parent.getChildren().length;return M<z-1?(this.parent.children.splice(M,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return t.Util.warn("Node has no parent. moveUp function is ignored."),!1;const M=this.index,z=this.parent.getChildren().length;return M<z-1?(this.parent.children.splice(M,1),this.parent.children.splice(M+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return t.Util.warn("Node has no parent. moveDown function is ignored."),!1;const M=this.index;return M>0?(this.parent.children.splice(M,1),this.parent.children.splice(M-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return t.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const M=this.index;return M>0?(this.parent.children.splice(M,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(M){if(!this.parent)return t.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(M<0||M>=this.parent.children.length)&&t.Util.warn("Unexpected value "+M+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const z=this.index;return this.parent.children.splice(z,1),this.parent.children.splice(M,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(s,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let M=this.opacity();const z=this.getParent();return z&&!z._isUnderCache&&(M*=z.getAbsoluteOpacity()),M}moveTo(M){return this.getParent()!==M&&(this._remove(),M.add(this)),this}toObject(){let M=this.getAttrs(),z,O,G,W,$;const X={attrs:{},className:this.getClassName()};for(z in M)O=M[z],$=t.Util.isObject(O)&&!t.Util._isPlainObject(O)&&!t.Util._isArray(O),!$&&(G=typeof this[z]=="function"&&this[z],delete M[z],W=G?G.call(this):null,M[z]=O,W!==O&&(X.attrs[z]=O));return t.Util._prepareToStringify(X)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(M,z,O){const G=[];z&&this._isMatch(M)&&G.push(this);let W=this.parent;for(;W;){if(W===O)return G;W._isMatch(M)&&G.push(W),W=W.parent}return G}isAncestorOf(M){return!1}findAncestor(M,z,O){return this.findAncestors(M,z,O)[0]}_isMatch(M){if(!M)return!1;if(typeof M=="function")return M(this);let z=M.replace(/ /g,"").split(","),O=z.length,G,W;for(G=0;G<O;G++)if(W=z[G],t.Util.isValidSelector(W)||(t.Util.warn('Selector "'+W+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),t.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),t.Util.warn("Konva is awesome, right?")),W.charAt(0)==="#"){if(this.id()===W.slice(1))return!0}else if(W.charAt(0)==="."){if(this.hasName(W.slice(1)))return!0}else if(this.className===W||this.nodeType===W)return!0;return!1}getLayer(){const M=this.getParent();return M?M.getLayer():null}getStage(){return this._getCache(E,this._getStage)}_getStage(){const M=this.getParent();return M?M.getStage():null}fire(M,z={},O){return z.target=z.target||this,O?this._fireAndBubble(M,z):this._fire(M,z),this}getAbsoluteTransform(M){return M?this._getAbsoluteTransform(M):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(M){let z;if(M)return z=new t.Transform,this._eachAncestorReverse(function(O){const G=O.transformsEnabled();G==="all"?z.multiply(O.getTransform()):G==="position"&&z.translate(O.x()-O.offsetX(),O.y()-O.offsetY())},M),z;{z=this._cache.get(l)||new t.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(z):z.reset();const O=this.transformsEnabled();if(O==="all")z.multiply(this.getTransform());else if(O==="position"){const G=this.attrs.x||0,W=this.attrs.y||0,$=this.attrs.offsetX||0,X=this.attrs.offsetY||0;z.translate(G-$,W-X)}return z.dirty=!1,z}}getAbsoluteScale(M){let z=this;for(;z;)z._isUnderCache&&(M=z),z=z.getParent();const G=this.getAbsoluteTransform(M).decompose();return{x:G.scaleX,y:G.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(P,this._getTransform)}_getTransform(){var M,z;const O=this._cache.get(P)||new t.Transform;O.reset();const G=this.x(),W=this.y(),$=n.Konva.getAngle(this.rotation()),X=(M=this.attrs.scaleX)!==null&&M!==void 0?M:1,Q=(z=this.attrs.scaleY)!==null&&z!==void 0?z:1,V=this.attrs.skewX||0,Y=this.attrs.skewY||0,Z=this.attrs.offsetX||0,ie=this.attrs.offsetY||0;return(G!==0||W!==0)&&O.translate(G,W),$!==0&&O.rotate($),(V!==0||Y!==0)&&O.skew(V,Y),(X!==1||Q!==1)&&O.scale(X,Q),(Z!==0||ie!==0)&&O.translate(-1*Z,-1*ie),O.dirty=!1,O}clone(M){let z=t.Util.cloneObject(this.attrs),O,G,W,$,X;for(O in M)z[O]=M[O];const Q=new this.constructor(z);for(O in this.eventListeners)for(G=this.eventListeners[O],W=G.length,$=0;$<W;$++)X=G[$],X.name.indexOf(g)<0&&(Q.eventListeners[O]||(Q.eventListeners[O]=[]),Q.eventListeners[O].push(X));return Q}_toKonvaCanvas(M){M=M||{};const z=this.getClientRect(),O=this.getStage(),G=M.x!==void 0?M.x:Math.floor(z.x),W=M.y!==void 0?M.y:Math.floor(z.y),$=M.pixelRatio||1,X=new r.SceneCanvas({width:M.width||Math.ceil(z.width)||(O?O.width():0),height:M.height||Math.ceil(z.height)||(O?O.height():0),pixelRatio:$}),Q=X.getContext(),V=new r.SceneCanvas({width:X.width/X.pixelRatio+Math.abs(G),height:X.height/X.pixelRatio+Math.abs(W),pixelRatio:X.pixelRatio});return M.imageSmoothingEnabled===!1&&(Q._context.imageSmoothingEnabled=!1),Q.save(),(G||W)&&Q.translate(-1*G,-1*W),this.drawScene(X,void 0,V),Q.restore(),X}toCanvas(M){return this._toKonvaCanvas(M)._canvas}toDataURL(M){M=M||{};const z=M.mimeType||null,O=M.quality||null,G=this._toKonvaCanvas(M).toDataURL(z,O);return M.callback&&M.callback(G),G}toImage(M){return new Promise((z,O)=>{try{const G=M?.callback;G&&delete M.callback,t.Util._urlToImage(this.toDataURL(M),function(W){z(W),G?.(W)})}catch(G){O(G)}})}toBlob(M){return new Promise((z,O)=>{try{const G=M?.callback;G&&delete M.callback,this.toCanvas(M).toBlob(W=>{z(W),G?.(W)},M?.mimeType,M?.quality)}catch(G){O(G)}})}setSize(M){return this.width(M.width),this.height(M.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(M,z,O){let G=this.eventListeners[M],W,$,X;for(W=0;W<G.length;W++)if($=G[W].name,X=G[W].handler,($!=="konva"||z==="konva")&&(!z||$===z)&&(!O||O===X)){if(G.splice(W,1),G.length===0){delete this.eventListeners[M];break}W--}}_fireChangeEvent(M,z,O){this._fire(M+f,{oldVal:z,newVal:O})}addName(M){if(!this.hasName(M)){const z=this.name(),O=z?z+" "+M:M;this.name(O)}return this}hasName(M){if(!M)return!1;const z=this.name();return z?(z||"").split(/\s/g).indexOf(M)!==-1:!1}removeName(M){const z=(this.name()||"").split(/\s/g),O=z.indexOf(M);return O!==-1&&(z.splice(O,1),this.name(z.join(" "))),this}setAttr(M,z){const O=this[N+t.Util._capitalize(M)];return t.Util._isFunction(O)?O.call(this,z):this._setAttr(M,z),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const M=this.getLayer()||this.getStage();M?.batchDraw()}}_setAttr(M,z){const O=this.attrs[M];O===z&&!t.Util.isObject(z)||(z==null?delete this.attrs[M]:this.attrs[M]=z,this._shouldFireChangeEvents&&this._fireChangeEvent(M,O,z),this._requestDraw())}_setComponentAttr(M,z,O){let G;O!==void 0&&(G=this.attrs[M],G||(this.attrs[M]=this.getAttr(M)),this.attrs[M][z]=O,this._fireChangeEvent(M,G,O))}_fireAndBubble(M,z,O){if(z&&this.nodeType===k&&(z.target=this),!((M===b||M===w)&&(O&&(this===O||this.isAncestorOf&&this.isAncestorOf(O))||this.nodeType==="Stage"&&!O))){this._fire(M,z);const W=(M===b||M===w)&&O&&O.isAncestorOf&&O.isAncestorOf(this)&&!O.isAncestorOf(this.parent);(z&&!z.cancelBubble||!z)&&this.parent&&this.parent.isListening()&&!W&&(O&&O.parent?this._fireAndBubble.call(this.parent,M,z,O):this._fireAndBubble.call(this.parent,M,z))}}_getProtoListeners(M){var z,O,G;const W=(z=this._cache.get(o))!==null&&z!==void 0?z:{};let $=W?.[M];if($===void 0){$=[];let X=Object.getPrototypeOf(this);for(;X;){const Q=(G=(O=X.eventListeners)===null||O===void 0?void 0:O[M])!==null&&G!==void 0?G:[];$.push(...Q),X=Object.getPrototypeOf(X)}W[M]=$,this._cache.set(o,W)}return $}_fire(M,z){z=z||{},z.currentTarget=this,z.type=M;const O=this._getProtoListeners(M);if(O)for(var G=0;G<O.length;G++)O[G].handler.call(this,z);const W=this.eventListeners[M];if(W)for(var G=0;G<W.length;G++)W[G].handler.call(this,z)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(M){const z=M?M.pointerId:void 0,O=this.getStage(),G=this.getAbsolutePosition();if(!O)return;const W=O._getPointerById(z)||O._changedPointerPositions[0]||G;i.DD._dragElements.set(this._id,{node:this,startPointerPos:W,offset:{x:W.x-G.x,y:W.y-G.y},dragStatus:"ready",pointerId:z})}startDrag(M,z=!0){i.DD._dragElements.has(this._id)||this._createDragElement(M);const O=i.DD._dragElements.get(this._id);O.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:M&&M.evt},z)}_setDragPosition(M,z){const O=this.getStage()._getPointerById(z.pointerId);if(!O)return;let G={x:O.x-z.offset.x,y:O.y-z.offset.y};const W=this.dragBoundFunc();if(W!==void 0){const $=W.call(this,G,M);$?G=$:t.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==G.x||this._lastPos.y!==G.y)&&(this.setAbsolutePosition(G),this._requestDraw()),this._lastPos=G}stopDrag(M){const z=i.DD._dragElements.get(this._id);z&&(z.dragStatus="stopped"),i.DD._endDragBefore(M),i.DD._endDragAfter(M)}setDraggable(M){this._setAttr("draggable",M),this._dragChange()}isDragging(){const M=i.DD._dragElements.get(this._id);return M?M.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(M){if(!(!(M.evt.button!==void 0)||n.Konva.dragButtons.indexOf(M.evt.button)>=0)||this.isDragging())return;let G=!1;i.DD._dragElements.forEach(W=>{this.isAncestorOf(W.node)&&(G=!0)}),G||this._createDragElement(M)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const z=i.DD._dragElements.get(this._id),O=z&&z.dragStatus==="dragging",G=z&&z.dragStatus==="ready";O?this.stopDrag():G&&i.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(M={x:0,y:0}){const z=this.getStage();if(!z)return!1;const O={x:-M.x,y:-M.y,width:z.width()+2*M.x,height:z.height()+2*M.y};return t.Util.haveIntersection(O,this.getClientRect())}static create(M,z){return t.Util._isString(M)&&(M=JSON.parse(M)),this._createNode(M,z)}static _createNode(M,z){let O=L.prototype.getClassName.call(M),G=M.children,W,$,X;z&&(M.attrs.container=z),n.Konva[O]||(t.Util.warn('Can not find a node with class name "'+O+'". Fallback to "Shape".'),O="Shape");const Q=n.Konva[O];if(W=new Q(M.attrs),G)for($=G.length,X=0;X<$;X++)W.add(L._createNode(G[X]));return W}}Op.Node=L,L.prototype.nodeType="Node",L.prototype._attrsAffectingSize=[],L.prototype.eventListeners={},L.prototype.on.call(L.prototype,I,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(P),this._clearSelfAndDescendantCache(l)}),L.prototype.on.call(L.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(A)}),L.prototype.on.call(L.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(y)}),L.prototype.on.call(L.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(s)});const U=e.Factory.addGetterSetter;return U(L,"zIndex"),U(L,"absolutePosition"),U(L,"position"),U(L,"x",0,(0,a.getNumberValidator)()),U(L,"y",0,(0,a.getNumberValidator)()),U(L,"globalCompositeOperation","source-over",(0,a.getStringValidator)()),U(L,"opacity",1,(0,a.getNumberValidator)()),U(L,"name","",(0,a.getStringValidator)()),U(L,"id","",(0,a.getStringValidator)()),U(L,"rotation",0,(0,a.getNumberValidator)()),e.Factory.addComponentsGetterSetter(L,"scale",["x","y"]),U(L,"scaleX",1,(0,a.getNumberValidator)()),U(L,"scaleY",1,(0,a.getNumberValidator)()),e.Factory.addComponentsGetterSetter(L,"skew",["x","y"]),U(L,"skewX",0,(0,a.getNumberValidator)()),U(L,"skewY",0,(0,a.getNumberValidator)()),e.Factory.addComponentsGetterSetter(L,"offset",["x","y"]),U(L,"offsetX",0,(0,a.getNumberValidator)()),U(L,"offsetY",0,(0,a.getNumberValidator)()),U(L,"dragDistance",null,(0,a.getNumberValidator)()),U(L,"width",0,(0,a.getNumberValidator)()),U(L,"height",0,(0,a.getNumberValidator)()),U(L,"listening",!0,(0,a.getBooleanValidator)()),U(L,"preventDefault",!0,(0,a.getBooleanValidator)()),U(L,"filters",null,function(H){return this._filterUpToDate=!1,H}),U(L,"visible",!0,(0,a.getBooleanValidator)()),U(L,"transformsEnabled","all",(0,a.getStringValidator)()),U(L,"size"),U(L,"dragBoundFunc"),U(L,"draggable",!1,(0,a.getBooleanValidator)()),e.Factory.backCompat(L,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Op}var Ip={},RE;function kx(){if(RE)return Ip;RE=1,Object.defineProperty(Ip,"__esModule",{value:!0}),Ip.Container=void 0;const t=Ht(),e=bn(),r=Wt();let n=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(a){if(!a)return this.children||[];const s=this.children||[],o=[];return s.forEach(function(l){a(l)&&o.push(l)}),o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.destroy()}),this.children=[],this._requestDraw(),this}add(...a){if(a.length===0)return this;if(a.length>1){for(let o=0;o<a.length;o++)this.add(a[o]);return this}const s=a[0];return s.getParent()?(s.moveTo(this),this):(this._validateAdd(s),s.index=this.getChildren().length,s.parent=this,s._clearCaches(),this.getChildren().push(s),this._fire("add",{child:s}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(a){return this._generalFind(a,!1)}findOne(a){const s=this._generalFind(a,!0);return s.length>0?s[0]:void 0}_generalFind(a,s){const o=[];return this._descendants(l=>{const u=l._isMatch(a);return u&&o.push(l),!!(u&&s)}),o}_descendants(a){let s=!1;const o=this.getChildren();for(const l of o){if(s=a(l),s)return!0;if(l.hasChildren()&&(s=l._descendants(a),s))return!0}return!1}toObject(){const a=e.Node.prototype.toObject.call(this);return a.children=[],this.getChildren().forEach(s=>{a.children.push(s.toObject())}),a}isAncestorOf(a){let s=a.getParent();for(;s;){if(s._id===this._id)return!0;s=s.getParent()}return!1}clone(a){const s=e.Node.prototype.clone.call(this,a);return this.getChildren().forEach(function(o){s.add(o.clone())}),s}getAllIntersections(a){const s=[];return this.find("Shape").forEach(o=>{o.isVisible()&&o.intersects(a)&&s.push(o)}),s}_clearSelfAndDescendantCache(a){var s;super._clearSelfAndDescendantCache(a),!this.isCached()&&((s=this.children)===null||s===void 0||s.forEach(function(o){o._clearSelfAndDescendantCache(a)}))}_setChildrenIndices(){var a;(a=this.children)===null||a===void 0||a.forEach(function(s,o){s.index=o}),this._requestDraw()}drawScene(a,s,o){const l=this.getLayer(),u=a||l&&l.getCanvas(),c=u&&u.getContext(),f=this._getCanvasCache(),m=f&&f.scene,g=u&&u.isCache;if(!this.isVisible()&&!g)return this;if(m){c.save();const y=this.getAbsoluteTransform(s).getMatrix();c.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._drawCachedSceneCanvas(c),c.restore()}else this._drawChildren("drawScene",u,s,o);return this}drawHit(a,s){if(!this.shouldDrawHit(s))return this;const o=this.getLayer(),l=a||o&&o.hitCanvas,u=l&&l.getContext(),c=this._getCanvasCache();if(c&&c.hit){u.save();const m=this.getAbsoluteTransform(s).getMatrix();u.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(u),u.restore()}else this._drawChildren("drawHit",l,s);return this}_drawChildren(a,s,o,l){var u;const c=s&&s.getContext(),f=this.clipWidth(),m=this.clipHeight(),g=this.clipFunc(),y=typeof f=="number"&&typeof m=="number"||g,b=o===this;if(y){c.save();const N=this.getAbsoluteTransform(o);let k=N.getMatrix();c.transform(k[0],k[1],k[2],k[3],k[4],k[5]),c.beginPath();let C;if(g)C=g.call(this,c,this);else{const E=this.clipX(),P=this.clipY();c.rect(E||0,P||0,f,m)}c.clip.apply(c,C),k=N.copy().invert().getMatrix(),c.transform(k[0],k[1],k[2],k[3],k[4],k[5])}const w=!b&&this.globalCompositeOperation()!=="source-over"&&a==="drawScene";w&&(c.save(),c._applyGlobalCompositeOperation(this)),(u=this.children)===null||u===void 0||u.forEach(function(N){N[a](s,o,l)}),w&&c.restore(),y&&c.restore()}getClientRect(a={}){var s;const o=a.skipTransform,l=a.relativeTo;let u,c,f,m,g={x:1/0,y:1/0,width:0,height:0};const y=this;(s=this.children)===null||s===void 0||s.forEach(function(N){if(!N.visible())return;const k=N.getClientRect({relativeTo:y,skipShadow:a.skipShadow,skipStroke:a.skipStroke});k.width===0&&k.height===0||(u===void 0?(u=k.x,c=k.y,f=k.x+k.width,m=k.y+k.height):(u=Math.min(u,k.x),c=Math.min(c,k.y),f=Math.max(f,k.x+k.width),m=Math.max(m,k.y+k.height)))});const b=this.find("Shape");let w=!1;for(let N=0;N<b.length;N++)if(b[N]._isVisible(this)){w=!0;break}return w&&u!==void 0?g={x:u,y:c,width:f-u,height:m-c}:g={x:0,y:0,width:0,height:0},o?g:this._transformedRect(g,l)}};return Ip.Container=n,t.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(n,"clipX",void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipY",void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipWidth",void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipHeight",void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipFunc"),Ip}var pw={},pu={},DE;function sP(){if(DE)return pu;DE=1,Object.defineProperty(pu,"__esModule",{value:!0}),pu.getCapturedShape=n,pu.createEvent=i,pu.hasPointerCapture=a,pu.setPointerCapture=s,pu.releaseCapture=o;const t=Vt(),e=new Map,r=t.Konva._global.PointerEvent!==void 0;function n(l){return e.get(l)}function i(l){return{evt:l,pointerId:l.pointerId}}function a(l,u){return e.get(l)===u}function s(l,u){o(l),u.getStage()&&(e.set(l,u),r&&u._fire("gotpointercapture",i(new PointerEvent("gotpointercapture"))))}function o(l,u){const c=e.get(l);if(!c)return;const f=c.getStage();f&&f.content,e.delete(l),r&&c._fire("lostpointercapture",i(new PointerEvent("lostpointercapture")))}return pu}var OE;function qB(){return OE||(OE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=un(),r=Ht(),n=kx(),i=Vt(),a=Sx(),s=$S(),o=Vt(),l=sP(),u="Stage",c="string",f="px",m="mouseout",g="mouseleave",y="mouseover",b="mouseenter",w="mousemove",N="mousedown",k="mouseup",C="pointermove",E="pointerdown",P="pointerup",_="pointercancel",A="lostpointercapture",I="pointerout",D="pointerleave",L="pointerover",U="pointerenter",H="contextmenu",M="touchstart",z="touchend",O="touchmove",G="touchcancel",W="wheel",$=5,X=[[b,"_pointerenter"],[N,"_pointerdown"],[w,"_pointermove"],[k,"_pointerup"],[g,"_pointerleave"],[M,"_pointerdown"],[O,"_pointermove"],[z,"_pointerup"],[G,"_pointercancel"],[y,"_pointerover"],[W,"_wheel"],[H,"_contextmenu"],[E,"_pointerdown"],[C,"_pointermove"],[P,"_pointerup"],[_,"_pointercancel"],[A,"_lostpointercapture"]],Q={mouse:{[I]:m,[D]:g,[L]:y,[U]:b,[C]:w,[E]:N,[P]:k,[_]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[I]:"touchout",[D]:"touchleave",[L]:"touchover",[U]:"touchenter",[C]:O,[E]:M,[P]:z,[_]:G,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[I]:I,[D]:D,[L]:L,[U]:U,[C]:C,[E]:E,[P]:P,[_]:_,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},V=he=>he.indexOf("pointer")>=0?"pointer":he.indexOf("touch")>=0?"touch":"mouse",Y=he=>{const ee=V(he);if(ee==="pointer")return i.Konva.pointerEventsEnabled&&Q.pointer;if(ee==="touch")return Q.touch;if(ee==="mouse")return Q.mouse};function Z(he={}){return(he.clipFunc||he.clipWidth||he.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),he}const ie="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class ce extends n.Container{constructor(ee){super(Z(ee)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Z(this.attrs)}),this._checkVisibility()}_validateAdd(ee){const le=ee.getType()==="Layer",te=ee.getType()==="FastLayer";le||te||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const ee=this.visible()?"":"none";this.content.style.display=ee}setContainer(ee){if(typeof ee===c){if(ee.charAt(0)==="."){const te=ee.slice(1);ee=document.getElementsByClassName(te)[0]}else{var le;ee.charAt(0)!=="#"?le=ee:le=ee.slice(1),ee=document.getElementById(le)}if(!ee)throw"Can not find container in document with id "+le}return this._setAttr("container",ee),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),ee.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let ee=this.children,le=ee.length,te;for(te=0;te<le;te++)ee[te].clear();return this}clone(ee){return ee||(ee={}),ee.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,ee)}destroy(){super.destroy();const ee=this.content;ee&&e.Util._isInDocument(ee)&&this.container().removeChild(ee);const le=t.stages.indexOf(this);return le>-1&&t.stages.splice(le,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const ee=this._pointerPositions[0]||this._changedPointerPositions[0];return ee?{x:ee.x,y:ee.y}:(e.Util.warn(ie),null)}_getPointerById(ee){return this._pointerPositions.find(le=>le.id===ee)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(ee){ee=ee||{},ee.x=ee.x||0,ee.y=ee.y||0,ee.width=ee.width||this.width(),ee.height=ee.height||this.height();const le=new a.SceneCanvas({width:ee.width,height:ee.height,pixelRatio:ee.pixelRatio||1}),te=le.getContext()._context,ae=this.children;return(ee.x||ee.y)&&te.translate(-1*ee.x,-1*ee.y),ae.forEach(function(oe){if(!oe.isVisible())return;const fe=oe._toKonvaCanvas(ee);te.drawImage(fe._canvas,ee.x,ee.y,fe.getWidth()/fe.getPixelRatio(),fe.getHeight()/fe.getPixelRatio())}),le}getIntersection(ee){if(!ee)return null;let le=this.children,te=le.length,ae=te-1,oe;for(oe=ae;oe>=0;oe--){const fe=le[oe].getIntersection(ee);if(fe)return fe}return null}_resizeDOM(){const ee=this.width(),le=this.height();this.content&&(this.content.style.width=ee+f,this.content.style.height=le+f),this.bufferCanvas.setSize(ee,le),this.bufferHitCanvas.setSize(ee,le),this.children.forEach(te=>{te.setSize({width:ee,height:le}),te.draw()})}add(ee,...le){if(arguments.length>1){for(let ae=0;ae<arguments.length;ae++)this.add(arguments[ae]);return this}super.add(ee);const te=this.children.length;return te>$&&e.Util.warn("The stage has "+te+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),ee.setSize({width:this.width(),height:this.height()}),ee.draw(),i.Konva.isBrowser&&this.content.appendChild(ee.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(ee){return l.hasPointerCapture(ee,this)}setPointerCapture(ee){l.setPointerCapture(ee,this)}releaseCapture(ee){l.releaseCapture(ee,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&X.forEach(([ee,le])=>{this.content.addEventListener(ee,te=>{this[le](te)},{passive:!1})})}_pointerenter(ee){this.setPointersPositions(ee);const le=Y(ee.type);le&&this._fire(le.pointerenter,{evt:ee,target:this,currentTarget:this})}_pointerover(ee){this.setPointersPositions(ee);const le=Y(ee.type);le&&this._fire(le.pointerover,{evt:ee,target:this,currentTarget:this})}_getTargetShape(ee){let le=this[ee+"targetShape"];return le&&!le.getStage()&&(le=null),le}_pointerleave(ee){const le=Y(ee.type),te=V(ee.type);if(!le)return;this.setPointersPositions(ee);const ae=this._getTargetShape(te),oe=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;ae&&oe?(ae._fireAndBubble(le.pointerout,{evt:ee}),ae._fireAndBubble(le.pointerleave,{evt:ee}),this._fire(le.pointerleave,{evt:ee,target:this,currentTarget:this}),this[te+"targetShape"]=null):oe&&(this._fire(le.pointerleave,{evt:ee,target:this,currentTarget:this}),this._fire(le.pointerout,{evt:ee,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(ee){const le=Y(ee.type),te=V(ee.type);if(!le)return;this.setPointersPositions(ee);let ae=!1;this._changedPointerPositions.forEach(oe=>{const fe=this.getIntersection(oe);if(s.DD.justDragged=!1,i.Konva["_"+te+"ListenClick"]=!0,!fe||!fe.isListening()){this[te+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&fe.setPointerCapture(oe.id),this[te+"ClickStartShape"]=fe,fe._fireAndBubble(le.pointerdown,{evt:ee,pointerId:oe.id}),ae=!0;const pe=ee.type.indexOf("touch")>=0;fe.preventDefault()&&ee.cancelable&&pe&&ee.preventDefault()}),ae||this._fire(le.pointerdown,{evt:ee,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(ee){const le=Y(ee.type),te=V(ee.type);if(!le||(i.Konva.isDragging()&&s.DD.node.preventDefault()&&ee.cancelable&&ee.preventDefault(),this.setPointersPositions(ee),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const oe={};let fe=!1;const pe=this._getTargetShape(te);this._changedPointerPositions.forEach(Te=>{const Oe=l.getCapturedShape(Te.id)||this.getIntersection(Te),_e=Te.id,Ae={evt:ee,pointerId:_e},He=pe!==Oe;if(He&&pe&&(pe._fireAndBubble(le.pointerout,{...Ae},Oe),pe._fireAndBubble(le.pointerleave,{...Ae},Oe)),Oe){if(oe[Oe._id])return;oe[Oe._id]=!0}Oe&&Oe.isListening()?(fe=!0,He&&(Oe._fireAndBubble(le.pointerover,{...Ae},pe),Oe._fireAndBubble(le.pointerenter,{...Ae},pe),this[te+"targetShape"]=Oe),Oe._fireAndBubble(le.pointermove,{...Ae})):pe&&(this._fire(le.pointerover,{evt:ee,target:this,currentTarget:this,pointerId:_e}),this[te+"targetShape"]=null)}),fe||this._fire(le.pointermove,{evt:ee,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(ee){const le=Y(ee.type),te=V(ee.type);if(!le)return;this.setPointersPositions(ee);const ae=this[te+"ClickStartShape"],oe=this[te+"ClickEndShape"],fe={};let pe=!1;this._changedPointerPositions.forEach(Te=>{const Oe=l.getCapturedShape(Te.id)||this.getIntersection(Te);if(Oe){if(Oe.releaseCapture(Te.id),fe[Oe._id])return;fe[Oe._id]=!0}const _e=Te.id,Ae={evt:ee,pointerId:_e};let He=!1;i.Konva["_"+te+"InDblClickWindow"]?(He=!0,clearTimeout(this[te+"DblTimeout"])):s.DD.justDragged||(i.Konva["_"+te+"InDblClickWindow"]=!0,clearTimeout(this[te+"DblTimeout"])),this[te+"DblTimeout"]=setTimeout(function(){i.Konva["_"+te+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),Oe&&Oe.isListening()?(pe=!0,this[te+"ClickEndShape"]=Oe,Oe._fireAndBubble(le.pointerup,{...Ae}),i.Konva["_"+te+"ListenClick"]&&ae&&ae===Oe&&(Oe._fireAndBubble(le.pointerclick,{...Ae}),He&&oe&&oe===Oe&&Oe._fireAndBubble(le.pointerdblclick,{...Ae}))):(this[te+"ClickEndShape"]=null,i.Konva["_"+te+"ListenClick"]&&this._fire(le.pointerclick,{evt:ee,target:this,currentTarget:this,pointerId:_e}),He&&this._fire(le.pointerdblclick,{evt:ee,target:this,currentTarget:this,pointerId:_e}))}),pe||this._fire(le.pointerup,{evt:ee,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+te+"ListenClick"]=!1,ee.cancelable&&te!=="touch"&&ee.preventDefault()}_contextmenu(ee){this.setPointersPositions(ee);const le=this.getIntersection(this.getPointerPosition());le&&le.isListening()?le._fireAndBubble(H,{evt:ee}):this._fire(H,{evt:ee,target:this,currentTarget:this})}_wheel(ee){this.setPointersPositions(ee);const le=this.getIntersection(this.getPointerPosition());le&&le.isListening()?le._fireAndBubble(W,{evt:ee}):this._fire(W,{evt:ee,target:this,currentTarget:this})}_pointercancel(ee){this.setPointersPositions(ee);const le=l.getCapturedShape(ee.pointerId)||this.getIntersection(this.getPointerPosition());le&&le._fireAndBubble(P,l.createEvent(ee)),l.releaseCapture(ee.pointerId)}_lostpointercapture(ee){l.releaseCapture(ee.pointerId)}setPointersPositions(ee){let le=this._getContentPosition(),te=null,ae=null;ee=ee||window.event,ee.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(ee.touches,oe=>{this._pointerPositions.push({id:oe.identifier,x:(oe.clientX-le.left)/le.scaleX,y:(oe.clientY-le.top)/le.scaleY})}),Array.prototype.forEach.call(ee.changedTouches||ee.touches,oe=>{this._changedPointerPositions.push({id:oe.identifier,x:(oe.clientX-le.left)/le.scaleX,y:(oe.clientY-le.top)/le.scaleY})})):(te=(ee.clientX-le.left)/le.scaleX,ae=(ee.clientY-le.top)/le.scaleY,this.pointerPos={x:te,y:ae},this._pointerPositions=[{x:te,y:ae,id:e.Util._getFirstPointerId(ee)}],this._changedPointerPositions=[{x:te,y:ae,id:e.Util._getFirstPointerId(ee)}])}_setPointerPosition(ee){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(ee)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const ee=this.content.getBoundingClientRect();return{top:ee.top,left:ee.left,scaleX:ee.width/this.content.clientWidth||1,scaleY:ee.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const ee=this.container();if(!ee)throw"Stage has no container. A container is required.";ee.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),ee.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(ee){ee.batchDraw()}),this}}t.Stage=ce,ce.prototype.nodeType=u,(0,o._registerNode)(ce),r.Factory.addGetterSetter(ce,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(he=>{he.batchDraw()})})})(pw)),pw}var Lp={},mw={},IE;function si(){return IE||(IE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=Vt(),r=un(),n=Ht(),i=bn(),a=Wt(),s=Vt(),o=sP(),l="hasShadow",u="shadowRGBA",c="patternImage",f="linearGradient",m="radialGradient";let g;function y(){return g||(g=r.Util.createCanvasElement().getContext("2d"),g)}t.shapes={};function b(D){const L=this.attrs.fillRule;L?D.fill(L):D.fill()}function w(D){D.stroke()}function N(D){const L=this.attrs.fillRule;L?D.fill(L):D.fill()}function k(D){D.stroke()}function C(){this._clearCache(l)}function E(){this._clearCache(u)}function P(){this._clearCache(c)}function _(){this._clearCache(f)}function A(){this._clearCache(m)}class I extends i.Node{constructor(L){super(L);let U;for(;U=r.Util.getRandomColor(),!(U&&!(U in t.shapes)););this.colorKey=U,t.shapes[U]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(c,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const U=y().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(U&&U.setTransform){const H=new r.Transform;H.translate(this.fillPatternX(),this.fillPatternY()),H.rotate(e.Konva.getAngle(this.fillPatternRotation())),H.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),H.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const M=H.getMatrix(),z=typeof DOMMatrix>"u"?{a:M[0],b:M[1],c:M[2],d:M[3],e:M[4],f:M[5]}:new DOMMatrix(M);U.setTransform(z)}return U}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){const L=this.fillLinearGradientColorStops();if(L){const U=y(),H=this.fillLinearGradientStartPoint(),M=this.fillLinearGradientEndPoint(),z=U.createLinearGradient(H.x,H.y,M.x,M.y);for(let O=0;O<L.length;O+=2)z.addColorStop(L[O],L[O+1]);return z}}_getRadialGradient(){return this._getCache(m,this.__getRadialGradient)}__getRadialGradient(){const L=this.fillRadialGradientColorStops();if(L){const U=y(),H=this.fillRadialGradientStartPoint(),M=this.fillRadialGradientEndPoint(),z=U.createRadialGradient(H.x,H.y,this.fillRadialGradientStartRadius(),M.x,M.y,this.fillRadialGradientEndRadius());for(let O=0;O<L.length;O+=2)z.addColorStop(L[O],L[O+1]);return z}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const L=r.Util.colorToRGBA(this.shadowColor());if(L)return"rgba("+L.r+","+L.g+","+L.b+","+L.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const L=this.hitStrokeWidth();return L==="auto"?this.hasStroke():this.strokeEnabled()&&!!L}intersects(L){const U=this.getStage();if(!U)return!1;const H=U.bufferHitCanvas;return H.getContext().clear(),this.drawHit(H,void 0,!0),H.context.getImageData(Math.round(L.x),Math.round(L.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(L){var U;if(!((U=this.attrs.perfectDrawEnabled)!==null&&U!==void 0?U:!0))return!1;const M=L||this.hasFill(),z=this.hasStroke(),O=this.getAbsoluteOpacity()!==1;if(M&&z&&O)return!0;const G=this.hasShadow(),W=this.shadowForStrokeEnabled();return!!(M&&z&&G&&W)}setStrokeHitEnabled(L){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),L?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const L=this.size();return{x:this._centroid?-L.width/2:0,y:this._centroid?-L.height/2:0,width:L.width,height:L.height}}getClientRect(L={}){let U=!1,H=this.getParent();for(;H;){if(H.isCached()){U=!0;break}H=H.getParent()}const M=L.skipTransform,z=L.relativeTo||U&&this.getStage()||void 0,O=this.getSelfRect(),W=!L.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,$=O.width+W,X=O.height+W,Q=!L.skipShadow&&this.hasShadow(),V=Q?this.shadowOffsetX():0,Y=Q?this.shadowOffsetY():0,Z=$+Math.abs(V),ie=X+Math.abs(Y),ce=Q&&this.shadowBlur()||0,he=Z+ce*2,ee=ie+ce*2,le={width:he,height:ee,x:-(W/2+ce)+Math.min(V,0)+O.x,y:-(W/2+ce)+Math.min(Y,0)+O.y};return M?le:this._transformedRect(le,z)}drawScene(L,U,H){const M=this.getLayer();let z=L||M.getCanvas(),O=z.getContext(),G=this._getCanvasCache(),W=this.getSceneFunc(),$=this.hasShadow(),X,Q;const V=z.isCache,Y=U===this;if(!this.isVisible()&&!Y)return this;if(G){O.save();const ie=this.getAbsoluteTransform(U).getMatrix();return O.transform(ie[0],ie[1],ie[2],ie[3],ie[4],ie[5]),this._drawCachedSceneCanvas(O),O.restore(),this}if(!W)return this;if(O.save(),this._useBufferCanvas()&&!V){X=this.getStage();const ie=H||X.bufferCanvas;Q=ie.getContext(),Q.clear(),Q.save(),Q._applyLineJoin(this);var Z=this.getAbsoluteTransform(U).getMatrix();Q.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5]),W.call(this,Q,this),Q.restore();const ce=ie.pixelRatio;$&&O._applyShadow(this),O._applyOpacity(this),O._applyGlobalCompositeOperation(this),O.drawImage(ie._canvas,0,0,ie.width/ce,ie.height/ce)}else{if(O._applyLineJoin(this),!Y){var Z=this.getAbsoluteTransform(U).getMatrix();O.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5]),O._applyOpacity(this),O._applyGlobalCompositeOperation(this)}$&&O._applyShadow(this),W.call(this,O,this)}return O.restore(),this}drawHit(L,U,H=!1){if(!this.shouldDrawHit(U,H))return this;const M=this.getLayer(),z=L||M.hitCanvas,O=z&&z.getContext(),G=this.hitFunc()||this.sceneFunc(),W=this._getCanvasCache(),$=W&&W.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),$){O.save();const Q=this.getAbsoluteTransform(U).getMatrix();return O.transform(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5]),this._drawCachedHitCanvas(O),O.restore(),this}if(!G)return this;if(O.save(),O._applyLineJoin(this),!(this===U)){const Q=this.getAbsoluteTransform(U).getMatrix();O.transform(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5])}return G.call(this,O,this),O.restore(),this}drawHitFromCache(L=0){let U=this._getCanvasCache(),H=this._getCachedSceneCanvas(),M=U.hit,z=M.getContext(),O=M.getWidth(),G=M.getHeight(),W,$,X,Q,V,Y;z.clear(),z.drawImage(H._canvas,0,0,O,G);try{for(W=z.getImageData(0,0,O,G),$=W.data,X=$.length,Q=r.Util._hexToRgb(this.colorKey),V=0;V<X;V+=4)Y=$[V+3],Y>L?($[V]=Q.r,$[V+1]=Q.g,$[V+2]=Q.b,$[V+3]=255):$[V+3]=0;z.putImageData(W,0,0)}catch(Z){r.Util.error("Unable to draw hit graph from cached scene canvas. "+Z.message)}return this}hasPointerCapture(L){return o.hasPointerCapture(L,this)}setPointerCapture(L){o.setPointerCapture(L,this)}releaseCapture(L){o.releaseCapture(L,this)}}t.Shape=I,I.prototype._fillFunc=b,I.prototype._strokeFunc=w,I.prototype._fillFuncHit=N,I.prototype._strokeFuncHit=k,I.prototype._centroid=!1,I.prototype.nodeType="Shape",(0,s._registerNode)(I),I.prototype.eventListeners={},I.prototype.on.call(I.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",C),I.prototype.on.call(I.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",E),I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",P),I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",_),I.prototype.on.call(I.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",A),n.Factory.addGetterSetter(I,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(I,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(I,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(I,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(I,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(I,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(I,"lineJoin"),n.Factory.addGetterSetter(I,"lineCap"),n.Factory.addGetterSetter(I,"sceneFunc"),n.Factory.addGetterSetter(I,"hitFunc"),n.Factory.addGetterSetter(I,"dash"),n.Factory.addGetterSetter(I,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(I,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(I,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(I,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(I,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(I,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(I,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillPatternImage"),n.Factory.addGetterSetter(I,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(I,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(I,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(I,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(I,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(I,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(I,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(I,"fillEnabled",!0),n.Factory.addGetterSetter(I,"strokeEnabled",!0),n.Factory.addGetterSetter(I,"shadowEnabled",!0),n.Factory.addGetterSetter(I,"dashEnabled",!0),n.Factory.addGetterSetter(I,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(I,"fillPriority","color"),n.Factory.addComponentsGetterSetter(I,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(I,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(I,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(I,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(I,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(I,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(I,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(I,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(I,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(I,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(I,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(I,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(I,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(I,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(I,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(I,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(I,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(I,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(I,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(I,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(I,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(I,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(I,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(I,"fillPatternRotation",0),n.Factory.addGetterSetter(I,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(I,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(mw)),mw}var LE;function oP(){if(LE)return Lp;LE=1,Object.defineProperty(Lp,"__esModule",{value:!0}),Lp.Layer=void 0;const t=un(),e=kx(),r=bn(),n=Ht(),i=Sx(),a=Wt(),s=si(),o=Vt(),l="#",u="beforeDraw",c="draw",f=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],m=f.length;class g extends e.Container{constructor(b){super(b),this.canvas=new i.SceneCanvas,this.hitCanvas=new i.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(b){return this.getContext().clear(b),this.getHitCanvas().getContext().clear(b),this}setZIndex(b){super.setZIndex(b);const w=this.getStage();return w&&w.content&&(w.content.removeChild(this.getNativeCanvasElement()),b<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[b+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);const b=this.getStage();return b&&b.content&&(b.content.removeChild(this.getNativeCanvasElement()),b.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!r.Node.prototype.moveUp.call(this))return!1;const w=this.getStage();return!w||!w.content?!1:(w.content.removeChild(this.getNativeCanvasElement()),this.index<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[this.index+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){const b=this.getStage();if(b){const w=b.children;b.content&&(b.content.removeChild(this.getNativeCanvasElement()),b.content.insertBefore(this.getNativeCanvasElement(),w[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){const b=this.getStage();if(b){const w=b.children;b.content&&(b.content.removeChild(this.getNativeCanvasElement()),b.content.insertBefore(this.getNativeCanvasElement(),w[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const b=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),b&&b.parentNode&&t.Util._isInDocument(b)&&b.parentNode.removeChild(b),this}getStage(){return this.parent}setSize({width:b,height:w}){return this.canvas.setSize(b,w),this.hitCanvas.setSize(b,w),this._setSmoothEnabled(),this}_validateAdd(b){const w=b.getType();w!=="Group"&&w!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(b){return b=b||{},b.width=b.width||this.getWidth(),b.height=b.height||this.getHeight(),b.x=b.x!==void 0?b.x:this.x(),b.y=b.y!==void 0?b.y:this.y(),r.Node.prototype._toKonvaCanvas.call(this,b)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(b){if(!this.isListening()||!this.isVisible())return null;let w=1,N=!1;for(;;){for(let k=0;k<m;k++){const C=f[k],E=this._getIntersection({x:b.x+C.x*w,y:b.y+C.y*w}),P=E.shape;if(P)return P;if(N=!!E.antialiased,!E.antialiased)break}if(N)w+=1;else return null}}_getIntersection(b){const w=this.hitCanvas.pixelRatio,N=this.hitCanvas.context.getImageData(Math.round(b.x*w),Math.round(b.y*w),1,1).data,k=N[3];if(k===255){const C=t.Util._rgbToHex(N[0],N[1],N[2]),E=s.shapes[l+C];return E?{shape:E}:{antialiased:!0}}else if(k>0)return{antialiased:!0};return{}}drawScene(b,w){const N=this.getLayer(),k=b||N&&N.getCanvas();return this._fire(u,{node:this}),this.clearBeforeDraw()&&k.getContext().clear(),e.Container.prototype.drawScene.call(this,k,w),this._fire(c,{node:this}),this}drawHit(b,w){const N=this.getLayer(),k=b||N&&N.hitCanvas;return N&&N.clearBeforeDraw()&&N.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,k,w),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(b){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(b)}getHitGraphEnabled(b){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const b=this.parent;!!this.hitCanvas._canvas.parentNode?b.content.removeChild(this.hitCanvas._canvas):b.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return Lp.Layer=g,g.prototype.nodeType="Layer",(0,o._registerNode)(g),n.Factory.addGetterSetter(g,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(g,"clearBeforeDraw",!0),n.Factory.addGetterSetter(g,"hitGraphEnabled",!0,(0,a.getBooleanValidator)()),Lp}var Bp={},BE;function WB(){if(BE)return Bp;BE=1,Object.defineProperty(Bp,"__esModule",{value:!0}),Bp.FastLayer=void 0;const t=un(),e=oP(),r=Vt();let n=class extends e.Layer{constructor(a){super(a),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return Bp.FastLayer=n,n.prototype.nodeType="FastLayer",(0,r._registerNode)(n),Bp}var Fp={},FE;function KS(){if(FE)return Fp;FE=1,Object.defineProperty(Fp,"__esModule",{value:!0}),Fp.Group=void 0;const t=un(),e=kx(),r=Vt();let n=class extends e.Container{_validateAdd(a){const s=a.getType();s!=="Group"&&s!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return Fp.Group=n,n.prototype.nodeType="Group",(0,r._registerNode)(n),Fp}var zp={},zE;function YS(){if(zE)return zp;zE=1,Object.defineProperty(zp,"__esModule",{value:!0}),zp.Animation=void 0;const t=Vt(),e=un(),r=(function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}})();let n=class Bf{constructor(a,s){this.id=Bf.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=a,this.setLayers(s)}setLayers(a){let s=[];return a&&(s=Array.isArray(a)?a:[a]),this.layers=s,this}getLayers(){return this.layers}addLayer(a){const s=this.layers,o=s.length;for(let l=0;l<o;l++)if(s[l]._id===a._id)return!1;return this.layers.push(a),!0}isRunning(){const s=Bf.animations,o=s.length;for(let l=0;l<o;l++)if(s[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),Bf._addAnimation(this),this}stop(){return Bf._removeAnimation(this),this}_updateFrameObject(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(a){this.animations.push(a),this._handleAnimation()}static _removeAnimation(a){const s=a.id,o=this.animations,l=o.length;for(let u=0;u<l;u++)if(o[u].id===s){this.animations.splice(u,1);break}}static _runFrames(){const a={},s=this.animations;for(let o=0;o<s.length;o++){const l=s[o],u=l.layers,c=l.func;l._updateFrameObject(r());const f=u.length;let m;if(c?m=c.call(l,l.frame)!==!1:m=!0,!!m)for(let g=0;g<f;g++){const y=u[g];y._id!==void 0&&(a[y._id]=y)}}for(const o in a)a.hasOwnProperty(o)&&a[o].batchDraw()}static _animationLoop(){const a=Bf;a.animations.length?(a._runFrames(),e.Util.requestAnimFrame(a._animationLoop)):a.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return zp.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,zp}var gw={},VE;function $B(){return VE||(VE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=un(),r=YS(),n=bn(),i=Vt();let a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,o=2,l=3,u=0,c=["fill","stroke","shadowColor"];class f{constructor(y,b,w,N,k,C,E){this.prop=y,this.propFunc=b,this.begin=N,this._pos=N,this.duration=C,this._change=0,this.prevPos=0,this.yoyo=E,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=w,this._change=k-this.begin,this.pause()}fire(y){const b=this[y];b&&b()}setTime(y){y>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():y<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=y,this.update())}getTime(){return this._time}setPosition(y){this.prevPos=this._pos,this.propFunc(y),this._pos=y}getPosition(y){return y===void 0&&(y=this._time),this.func(y,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(y){this.pause(),this._time=y,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const y=this.getTimer()-this._startTime;this.state===o?this.setTime(y):this.state===l&&this.setTime(this.duration-y)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class m{constructor(y){let b=this,w=y.node,N=w._id,k,C=y.easing||t.Easings.Linear,E=!!y.yoyo,P;typeof y.duration>"u"?k=.3:y.duration===0?k=.001:k=y.duration,this.node=w,this._id=u++;const _=w.getLayer()||(w instanceof i.Konva.Stage?w.getLayers():null);_||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){b.tween.onEnterFrame()},_),this.tween=new f(P,function(A){b._tweenFunc(A)},C,0,1,k*1e3,E),this._addListeners(),m.attrs[N]||(m.attrs[N]={}),m.attrs[N][this._id]||(m.attrs[N][this._id]={}),m.tweens[N]||(m.tweens[N]={});for(P in y)a[P]===void 0&&this._addAttr(P,y[P]);this.reset(),this.onFinish=y.onFinish,this.onReset=y.onReset,this.onUpdate=y.onUpdate}_addAttr(y,b){let w=this.node,N=w._id,k,C,E,P,_,A,I,D;if(E=m.tweens[N][y],E&&delete m.attrs[N][E][y],k=w.getAttr(y),e.Util._isArray(b))if(C=[],_=Math.max(b.length,k.length),y==="points"&&b.length!==k.length&&(b.length>k.length?(I=k,k=e.Util._prepareArrayForTween(k,b,w.closed())):(A=b,b=e.Util._prepareArrayForTween(b,k,w.closed()))),y.indexOf("fill")===0)for(P=0;P<_;P++)if(P%2===0)C.push(b[P]-k[P]);else{const L=e.Util.colorToRGBA(k[P]);D=e.Util.colorToRGBA(b[P]),k[P]=L,C.push({r:D.r-L.r,g:D.g-L.g,b:D.b-L.b,a:D.a-L.a})}else for(P=0;P<_;P++)C.push(b[P]-k[P]);else c.indexOf(y)!==-1?(k=e.Util.colorToRGBA(k),D=e.Util.colorToRGBA(b),C={r:D.r-k.r,g:D.g-k.g,b:D.b-k.b,a:D.a-k.a}):C=b-k;m.attrs[N][this._id][y]={start:k,diff:C,end:b,trueEnd:A,trueStart:I},m.tweens[N][y]=this._id}_tweenFunc(y){let b=this.node,w=m.attrs[b._id][this._id],N,k,C,E,P,_,A,I;for(N in w){if(k=w[N],C=k.start,E=k.diff,I=k.end,e.Util._isArray(C))if(P=[],A=Math.max(C.length,I.length),N.indexOf("fill")===0)for(_=0;_<A;_++)_%2===0?P.push((C[_]||0)+E[_]*y):P.push("rgba("+Math.round(C[_].r+E[_].r*y)+","+Math.round(C[_].g+E[_].g*y)+","+Math.round(C[_].b+E[_].b*y)+","+(C[_].a+E[_].a*y)+")");else for(_=0;_<A;_++)P.push((C[_]||0)+E[_]*y);else c.indexOf(N)!==-1?P="rgba("+Math.round(C.r+E.r*y)+","+Math.round(C.g+E.g*y)+","+Math.round(C.b+E.b*y)+","+(C.a+E.a*y)+")":P=C+E*y;b.setAttr(N,P)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const y=this.node,b=m.attrs[y._id][this._id];b.points&&b.points.trueEnd&&y.setAttr("points",b.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const y=this.node,b=m.attrs[y._id][this._id];b.points&&b.points.trueStart&&y.points(b.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(y){return this.tween.seek(y*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let y=this.node._id,b=this._id,w=m.tweens[y],N;this.pause();for(N in w)delete m.tweens[y][N];delete m.attrs[y][b]}}t.Tween=m,m.attrs={},m.tweens={},n.Node.prototype.to=function(g){const y=g.onFinish;g.node=this,g.onFinish=function(){this.destroy(),y&&y()},new m(g).play()},t.Easings={BackEaseIn(g,y,b,w){return b*(g/=w)*g*((1.70158+1)*g-1.70158)+y},BackEaseOut(g,y,b,w){return b*((g=g/w-1)*g*((1.70158+1)*g+1.70158)+1)+y},BackEaseInOut(g,y,b,w){let N=1.70158;return(g/=w/2)<1?b/2*(g*g*(((N*=1.525)+1)*g-N))+y:b/2*((g-=2)*g*(((N*=1.525)+1)*g+N)+2)+y},ElasticEaseIn(g,y,b,w,N,k){let C=0;return g===0?y:(g/=w)===1?y+b:(k||(k=w*.3),!N||N<Math.abs(b)?(N=b,C=k/4):C=k/(2*Math.PI)*Math.asin(b/N),-(N*Math.pow(2,10*(g-=1))*Math.sin((g*w-C)*(2*Math.PI)/k))+y)},ElasticEaseOut(g,y,b,w,N,k){let C=0;return g===0?y:(g/=w)===1?y+b:(k||(k=w*.3),!N||N<Math.abs(b)?(N=b,C=k/4):C=k/(2*Math.PI)*Math.asin(b/N),N*Math.pow(2,-10*g)*Math.sin((g*w-C)*(2*Math.PI)/k)+b+y)},ElasticEaseInOut(g,y,b,w,N,k){let C=0;return g===0?y:(g/=w/2)===2?y+b:(k||(k=w*(.3*1.5)),!N||N<Math.abs(b)?(N=b,C=k/4):C=k/(2*Math.PI)*Math.asin(b/N),g<1?-.5*(N*Math.pow(2,10*(g-=1))*Math.sin((g*w-C)*(2*Math.PI)/k))+y:N*Math.pow(2,-10*(g-=1))*Math.sin((g*w-C)*(2*Math.PI)/k)*.5+b+y)},BounceEaseOut(g,y,b,w){return(g/=w)<1/2.75?b*(7.5625*g*g)+y:g<2/2.75?b*(7.5625*(g-=1.5/2.75)*g+.75)+y:g<2.5/2.75?b*(7.5625*(g-=2.25/2.75)*g+.9375)+y:b*(7.5625*(g-=2.625/2.75)*g+.984375)+y},BounceEaseIn(g,y,b,w){return b-t.Easings.BounceEaseOut(w-g,0,b,w)+y},BounceEaseInOut(g,y,b,w){return g<w/2?t.Easings.BounceEaseIn(g*2,0,b,w)*.5+y:t.Easings.BounceEaseOut(g*2-w,0,b,w)*.5+b*.5+y},EaseIn(g,y,b,w){return b*(g/=w)*g+y},EaseOut(g,y,b,w){return-b*(g/=w)*(g-2)+y},EaseInOut(g,y,b,w){return(g/=w/2)<1?b/2*g*g+y:-b/2*(--g*(g-2)-1)+y},StrongEaseIn(g,y,b,w){return b*(g/=w)*g*g*g*g+y},StrongEaseOut(g,y,b,w){return b*((g=g/w-1)*g*g*g*g+1)+y},StrongEaseInOut(g,y,b,w){return(g/=w/2)<1?b/2*g*g*g*g*g+y:b/2*((g-=2)*g*g*g*g+2)+y},Linear(g,y,b,w){return b*g/w+y}}})(gw)),gw}var UE;function A2(){return UE||(UE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=Vt(),r=un(),n=bn(),i=kx(),a=qB(),s=oP(),o=WB(),l=KS(),u=$S(),c=si(),f=YS(),m=$B(),g=aP(),y=Sx();t.Konva=r.Util._assign(e.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:s.Layer,FastLayer:o.FastLayer,Group:l.Group,DD:u.DD,Shape:c.Shape,shapes:c.shapes,Animation:f.Animation,Tween:m.Tween,Easings:m.Easings,Context:g.Context,Canvas:y.Canvas}),t.default=t.Konva})(uw)),uw}var Vp={},GE;function KB(){if(GE)return Vp;GE=1,Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.Arc=void 0;const t=Ht(),e=si(),r=Vt(),n=Wt(),i=Vt();let a=class extends e.Shape{_sceneFunc(o){const l=r.Konva.getAngle(this.angle()),u=this.clockwise();o.beginPath(),o.arc(0,0,this.outerRadius(),0,l,u),o.arc(0,0,this.innerRadius(),l,0,!u),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}getSelfRect(){const o=this.innerRadius(),l=this.outerRadius(),u=this.clockwise(),c=r.Konva.getAngle(u?360-this.angle():this.angle()),f=Math.cos(Math.min(c,Math.PI)),m=1,g=Math.sin(Math.min(Math.max(Math.PI,c),3*Math.PI/2)),y=Math.sin(Math.min(c,Math.PI/2)),b=f*(f>0?o:l),w=m*l,N=g*(g>0?o:l),k=y*(y>0?l:o);return{x:b,y:u?-1*k:N,width:w-b,height:k-N}}};return Vp.Arc=a,a.prototype._centroid=!0,a.prototype.className="Arc",a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(a),t.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"clockwise",!1,(0,n.getBooleanValidator)()),Vp}var Up={},Gp={},HE;function lP(){if(HE)return Gp;HE=1,Object.defineProperty(Gp,"__esModule",{value:!0}),Gp.Line=void 0;const t=Ht(),e=Vt(),r=si(),n=Wt();function i(o,l,u,c,f,m,g){const y=Math.sqrt(Math.pow(u-o,2)+Math.pow(c-l,2)),b=Math.sqrt(Math.pow(f-u,2)+Math.pow(m-c,2)),w=g*y/(y+b),N=g*b/(y+b),k=u-w*(f-o),C=c-w*(m-l),E=u+N*(f-o),P=c+N*(m-l);return[k,C,E,P]}function a(o,l){const u=o.length,c=[];for(let f=2;f<u-2;f+=2){const m=i(o[f-2],o[f-1],o[f],o[f+1],o[f+2],o[f+3],l);isNaN(m[0])||(c.push(m[0]),c.push(m[1]),c.push(o[f]),c.push(o[f+1]),c.push(m[2]),c.push(m[3]))}return c}class s extends r.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){let u=this.points(),c=u.length,f=this.tension(),m=this.closed(),g=this.bezier(),y,b,w;if(c){if(l.beginPath(),l.moveTo(u[0],u[1]),f!==0&&c>4){for(y=this.getTensionPoints(),b=y.length,w=m?0:4,m||l.quadraticCurveTo(y[0],y[1],y[2],y[3]);w<b-2;)l.bezierCurveTo(y[w++],y[w++],y[w++],y[w++],y[w++],y[w++]);m||l.quadraticCurveTo(y[b-2],y[b-1],u[c-2],u[c-1])}else if(g)for(w=2;w<c;)l.bezierCurveTo(u[w++],u[w++],u[w++],u[w++],u[w++],u[w++]);else for(w=2;w<c;w+=2)l.lineTo(u[w],u[w+1]);m?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():a(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),u=l.length,c=this.tension(),f=i(l[u-2],l[u-1],l[0],l[1],l[2],l[3],c),m=i(l[u-4],l[u-3],l[u-2],l[u-1],l[0],l[1],c),g=a(l,c);return[f[2],f[3]].concat(g).concat([m[0],m[1],l[u-2],l[u-1],m[2],m[3],f[0],f[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let u=l[0],c=l[0],f=l[1],m=l[1],g,y;for(let b=0;b<l.length/2;b++)g=l[b*2],y=l[b*2+1],u=Math.min(u,g),c=Math.max(c,g),f=Math.min(f,y),m=Math.max(m,y);return{x:u,y:f,width:c-u,height:m-f}}}return Gp.Line=s,s.prototype.className="Line",s.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(s),t.Factory.addGetterSetter(s,"closed",!1),t.Factory.addGetterSetter(s,"bezier",!1),t.Factory.addGetterSetter(s,"tension",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"points",[],(0,n.getNumberArrayValidator)()),Gp}var Hp={},vw={},qE;function YB(){return qE||(qE=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(s,o,l)=>{let u,c;const m=l/2;u=0;for(let g=0;g<20;g++)c=m*t.tValues[20][g]+m,u+=t.cValues[20][g]*n(s,o,c);return m*u};t.getCubicArcLength=e;const r=(s,o,l)=>{l===void 0&&(l=1);const u=s[0]-2*s[1]+s[2],c=o[0]-2*o[1]+o[2],f=2*s[1]-2*s[0],m=2*o[1]-2*o[0],g=4*(u*u+c*c),y=4*(u*f+c*m),b=f*f+m*m;if(g===0)return l*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(o[2]-o[0],2));const w=y/(2*g),N=b/g,k=l+w,C=N-w*w,E=k*k+C>0?Math.sqrt(k*k+C):0,P=w*w+C>0?Math.sqrt(w*w+C):0,_=w+Math.sqrt(w*w+C)!==0?C*Math.log(Math.abs((k+E)/(w+P))):0;return Math.sqrt(g)/2*(k*E-w*P+_)};t.getQuadraticArcLength=r;function n(s,o,l){const u=i(1,l,s),c=i(1,l,o),f=u*u+c*c;return Math.sqrt(f)}const i=(s,o,l)=>{const u=l.length-1;let c,f;if(u===0)return 0;if(s===0){f=0;for(let m=0;m<=u;m++)f+=t.binomialCoefficients[u][m]*Math.pow(1-o,u-m)*Math.pow(o,m)*l[m];return f}else{c=new Array(u);for(let m=0;m<u;m++)c[m]=u*(l[m+1]-l[m]);return i(s-1,o,c)}},a=(s,o,l)=>{let u=1,c=s/o,f=(s-l(c))/o,m=0;for(;u>.001;){const g=l(c+f),y=Math.abs(s-g)/o;if(y<u)u=y,c+=f;else{const b=l(c-f),w=Math.abs(s-b)/o;w<u?(u=w,c-=f):f/=2}if(m++,m>500)break}return c};t.t2length=a})(vw)),vw}var WE;function XS(){if(WE)return Hp;WE=1,Object.defineProperty(Hp,"__esModule",{value:!0}),Hp.Path=void 0;const t=Ht(),e=si(),r=Vt(),n=YB();let i=class va extends e.Shape{constructor(s){super(s),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=va.parsePathData(this.data()),this.pathLength=va.getPathLength(this.dataArray)}_sceneFunc(s){const o=this.dataArray;s.beginPath();let l=!1;for(let E=0;E<o.length;E++){const P=o[E].command,_=o[E].points;switch(P){case"L":s.lineTo(_[0],_[1]);break;case"M":s.moveTo(_[0],_[1]);break;case"C":s.bezierCurveTo(_[0],_[1],_[2],_[3],_[4],_[5]);break;case"Q":s.quadraticCurveTo(_[0],_[1],_[2],_[3]);break;case"A":var u=_[0],c=_[1],f=_[2],m=_[3],g=_[4],y=_[5],b=_[6],w=_[7],N=f>m?f:m,k=f>m?1:f/m,C=f>m?m/f:1;s.translate(u,c),s.rotate(b),s.scale(k,C),s.arc(0,0,N,g,g+y,1-w),s.scale(1/k,1/C),s.rotate(-b),s.translate(-u,-c);break;case"z":l=!0,s.closePath();break}}!l&&!this.hasFill()?s.strokeShape(this):s.fillStrokeShape(this)}getSelfRect(){let s=[];this.dataArray.forEach(function(g){if(g.command==="A"){const y=g.points[4],b=g.points[5],w=g.points[4]+b;let N=Math.PI/180;if(Math.abs(y-w)<N&&(N=Math.abs(y-w)),b<0)for(let k=y-N;k>w;k-=N){const C=va.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],k,0);s.push(C.x,C.y)}else for(let k=y+N;k<w;k+=N){const C=va.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],k,0);s.push(C.x,C.y)}}else if(g.command==="C")for(let y=0;y<=1;y+=.01){const b=va.getPointOnCubicBezier(y,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);s.push(b.x,b.y)}else s=s.concat(g.points)});let o=s[0],l=s[0],u=s[1],c=s[1],f,m;for(let g=0;g<s.length/2;g++)f=s[g*2],m=s[g*2+1],isNaN(f)||(o=Math.min(o,f),l=Math.max(l,f)),isNaN(m)||(u=Math.min(u,m),c=Math.max(c,m));return{x:o,y:u,width:l-o,height:c-u}}getLength(){return this.pathLength}getPointAtLength(s){return va.getPointAtLengthOfDataArray(s,this.dataArray)}static getLineLength(s,o,l,u){return Math.sqrt((l-s)*(l-s)+(u-o)*(u-o))}static getPathLength(s){let o=0;for(let l=0;l<s.length;++l)o+=s[l].pathLength;return o}static getPointAtLengthOfDataArray(s,o){let l,u=0,c=o.length;if(!c)return null;for(;u<c&&s>o[u].pathLength;)s-=o[u].pathLength,++u;if(u===c)return l=o[u-1].points.slice(-2),{x:l[0],y:l[1]};if(s<.01)return l=o[u].points.slice(0,2),{x:l[0],y:l[1]};const f=o[u],m=f.points;switch(f.command){case"L":return va.getPointOnLine(s,f.start.x,f.start.y,m[0],m[1]);case"C":return va.getPointOnCubicBezier((0,n.t2length)(s,va.getPathLength(o),E=>(0,n.getCubicArcLength)([f.start.x,m[0],m[2],m[4]],[f.start.y,m[1],m[3],m[5]],E)),f.start.x,f.start.y,m[0],m[1],m[2],m[3],m[4],m[5]);case"Q":return va.getPointOnQuadraticBezier((0,n.t2length)(s,va.getPathLength(o),E=>(0,n.getQuadraticArcLength)([f.start.x,m[0],m[2]],[f.start.y,m[1],m[3]],E)),f.start.x,f.start.y,m[0],m[1],m[2],m[3]);case"A":var g=m[0],y=m[1],b=m[2],w=m[3],N=m[4],k=m[5],C=m[6];return N+=k*s/f.pathLength,va.getPointOnEllipticalArc(g,y,b,w,N,C)}return null}static getPointOnLine(s,o,l,u,c,f,m){f=f??o,m=m??l;const g=this.getLineLength(o,l,u,c);if(g<1e-10)return{x:o,y:l};if(u===o)return{x:f,y:m+(c>l?s:-s)};const y=(c-l)/(u-o),b=Math.sqrt(s*s/(1+y*y))*(u<o?-1:1),w=y*b;if(Math.abs(m-l-y*(f-o))<1e-10)return{x:f+b,y:m+w};const N=((f-o)*(u-o)+(m-l)*(c-l))/(g*g),k=o+N*(u-o),C=l+N*(c-l),E=this.getLineLength(f,m,k,C),P=Math.sqrt(s*s-E*E),_=Math.sqrt(P*P/(1+y*y))*(u<o?-1:1),A=y*_;return{x:k+_,y:C+A}}static getPointOnCubicBezier(s,o,l,u,c,f,m,g,y){function b(P){return P*P*P}function w(P){return 3*P*P*(1-P)}function N(P){return 3*P*(1-P)*(1-P)}function k(P){return(1-P)*(1-P)*(1-P)}const C=g*b(s)+f*w(s)+u*N(s)+o*k(s),E=y*b(s)+m*w(s)+c*N(s)+l*k(s);return{x:C,y:E}}static getPointOnQuadraticBezier(s,o,l,u,c,f,m){function g(k){return k*k}function y(k){return 2*k*(1-k)}function b(k){return(1-k)*(1-k)}const w=f*g(s)+u*y(s)+o*b(s),N=m*g(s)+c*y(s)+l*b(s);return{x:w,y:N}}static getPointOnEllipticalArc(s,o,l,u,c,f){const m=Math.cos(f),g=Math.sin(f),y={x:l*Math.cos(c),y:u*Math.sin(c)};return{x:s+(y.x*m-y.y*g),y:o+(y.x*g+y.y*m)}}static parsePathData(s){if(!s)return[];let o=s;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];o=o.replace(new RegExp(" ","g"),",");for(var u=0;u<l.length;u++)o=o.replace(new RegExp(l[u],"g"),"|"+l[u]);const c=o.split("|"),f=[],m=[];let g=0,y=0;const b=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let w;for(u=1;u<c.length;u++){let M=c[u],z=M.charAt(0);for(M=M.slice(1),m.length=0;w=b.exec(M);)m.push(w[0]);const O=[];for(let G=0,W=m.length;G<W;G++){if(m[G]==="00"){O.push(0,0);continue}const $=parseFloat(m[G]);isNaN($)?O.push(0):O.push($)}for(;O.length>0&&!isNaN(O[0]);){let G="",W=[];const $=g,X=y;var N,k,C,E,P,_,A,I,D,L;switch(z){case"l":g+=O.shift(),y+=O.shift(),G="L",W.push(g,y);break;case"L":g=O.shift(),y=O.shift(),W.push(g,y);break;case"m":var U=O.shift(),H=O.shift();if(g+=U,y+=H,G="M",f.length>2&&f[f.length-1].command==="z"){for(let Q=f.length-2;Q>=0;Q--)if(f[Q].command==="M"){g=f[Q].points[0]+U,y=f[Q].points[1]+H;break}}W.push(g,y),z="l";break;case"M":g=O.shift(),y=O.shift(),G="M",W.push(g,y),z="L";break;case"h":g+=O.shift(),G="L",W.push(g,y);break;case"H":g=O.shift(),G="L",W.push(g,y);break;case"v":y+=O.shift(),G="L",W.push(g,y);break;case"V":y=O.shift(),G="L",W.push(g,y);break;case"C":W.push(O.shift(),O.shift(),O.shift(),O.shift()),g=O.shift(),y=O.shift(),W.push(g,y);break;case"c":W.push(g+O.shift(),y+O.shift(),g+O.shift(),y+O.shift()),g+=O.shift(),y+=O.shift(),G="C",W.push(g,y);break;case"S":k=g,C=y,N=f[f.length-1],N.command==="C"&&(k=g+(g-N.points[2]),C=y+(y-N.points[3])),W.push(k,C,O.shift(),O.shift()),g=O.shift(),y=O.shift(),G="C",W.push(g,y);break;case"s":k=g,C=y,N=f[f.length-1],N.command==="C"&&(k=g+(g-N.points[2]),C=y+(y-N.points[3])),W.push(k,C,g+O.shift(),y+O.shift()),g+=O.shift(),y+=O.shift(),G="C",W.push(g,y);break;case"Q":W.push(O.shift(),O.shift()),g=O.shift(),y=O.shift(),W.push(g,y);break;case"q":W.push(g+O.shift(),y+O.shift()),g+=O.shift(),y+=O.shift(),G="Q",W.push(g,y);break;case"T":k=g,C=y,N=f[f.length-1],N.command==="Q"&&(k=g+(g-N.points[0]),C=y+(y-N.points[1])),g=O.shift(),y=O.shift(),G="Q",W.push(k,C,g,y);break;case"t":k=g,C=y,N=f[f.length-1],N.command==="Q"&&(k=g+(g-N.points[0]),C=y+(y-N.points[1])),g+=O.shift(),y+=O.shift(),G="Q",W.push(k,C,g,y);break;case"A":E=O.shift(),P=O.shift(),_=O.shift(),A=O.shift(),I=O.shift(),D=g,L=y,g=O.shift(),y=O.shift(),G="A",W=this.convertEndpointToCenterParameterization(D,L,g,y,A,I,E,P,_);break;case"a":E=O.shift(),P=O.shift(),_=O.shift(),A=O.shift(),I=O.shift(),D=g,L=y,g+=O.shift(),y+=O.shift(),G="A",W=this.convertEndpointToCenterParameterization(D,L,g,y,A,I,E,P,_);break}f.push({command:G||z,points:W,start:{x:$,y:X},pathLength:this.calcLength($,X,G||z,W)})}(z==="z"||z==="Z")&&f.push({command:"z",points:[],start:void 0,pathLength:0})}return f}static calcLength(s,o,l,u){let c,f,m,g;const y=va;switch(l){case"L":return y.getLineLength(s,o,u[0],u[1]);case"C":return(0,n.getCubicArcLength)([s,u[0],u[2],u[4]],[o,u[1],u[3],u[5]],1);case"Q":return(0,n.getQuadraticArcLength)([s,u[0],u[2]],[o,u[1],u[3]],1);case"A":c=0;var b=u[4],w=u[5],N=u[4]+w,k=Math.PI/180;if(Math.abs(b-N)<k&&(k=Math.abs(b-N)),f=y.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],b,0),w<0)for(g=b-k;g>N;g-=k)m=y.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],g,0),c+=y.getLineLength(f.x,f.y,m.x,m.y),f=m;else for(g=b+k;g<N;g+=k)m=y.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],g,0),c+=y.getLineLength(f.x,f.y,m.x,m.y),f=m;return m=y.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],N,0),c+=y.getLineLength(f.x,f.y,m.x,m.y),c}return 0}static convertEndpointToCenterParameterization(s,o,l,u,c,f,m,g,y){const b=y*(Math.PI/180),w=Math.cos(b)*(s-l)/2+Math.sin(b)*(o-u)/2,N=-1*Math.sin(b)*(s-l)/2+Math.cos(b)*(o-u)/2,k=w*w/(m*m)+N*N/(g*g);k>1&&(m*=Math.sqrt(k),g*=Math.sqrt(k));let C=Math.sqrt((m*m*(g*g)-m*m*(N*N)-g*g*(w*w))/(m*m*(N*N)+g*g*(w*w)));c===f&&(C*=-1),isNaN(C)&&(C=0);const E=C*m*N/g,P=C*-g*w/m,_=(s+l)/2+Math.cos(b)*E-Math.sin(b)*P,A=(o+u)/2+Math.sin(b)*E+Math.cos(b)*P,I=function(O){return Math.sqrt(O[0]*O[0]+O[1]*O[1])},D=function(O,G){return(O[0]*G[0]+O[1]*G[1])/(I(O)*I(G))},L=function(O,G){return(O[0]*G[1]<O[1]*G[0]?-1:1)*Math.acos(D(O,G))},U=L([1,0],[(w-E)/m,(N-P)/g]),H=[(w-E)/m,(N-P)/g],M=[(-1*w-E)/m,(-1*N-P)/g];let z=L(H,M);return D(H,M)<=-1&&(z=Math.PI),D(H,M)>=1&&(z=0),f===0&&z>0&&(z=z-2*Math.PI),f===1&&z<0&&(z=z+2*Math.PI),[_,A,m,g,U,z,b,f]}};return Hp.Path=i,i.prototype.className="Path",i.prototype._attrsAffectingSize=["data"],(0,r._registerNode)(i),t.Factory.addGetterSetter(i,"data"),Hp}var $E;function XB(){if($E)return Up;$E=1,Object.defineProperty(Up,"__esModule",{value:!0}),Up.Arrow=void 0;const t=Ht(),e=lP(),r=Wt(),n=Vt(),i=XS();let a=class extends e.Line{_sceneFunc(o){super._sceneFunc(o);const l=Math.PI*2,u=this.points();let c=u;const f=this.tension()!==0&&u.length>4;f&&(c=this.getTensionPoints());const m=this.pointerLength(),g=u.length;let y,b;if(f){const k=[c[c.length-4],c[c.length-3],c[c.length-2],c[c.length-1],u[g-2],u[g-1]],C=i.Path.calcLength(c[c.length-4],c[c.length-3],"C",k),E=i.Path.getPointOnQuadraticBezier(Math.min(1,1-m/C),k[0],k[1],k[2],k[3],k[4],k[5]);y=u[g-2]-E.x,b=u[g-1]-E.y}else y=u[g-2]-u[g-4],b=u[g-1]-u[g-3];const w=(Math.atan2(b,y)+l)%l,N=this.pointerWidth();this.pointerAtEnding()&&(o.save(),o.beginPath(),o.translate(u[g-2],u[g-1]),o.rotate(w),o.moveTo(0,0),o.lineTo(-m,N/2),o.lineTo(-m,-N/2),o.closePath(),o.restore(),this.__fillStroke(o)),this.pointerAtBeginning()&&(o.save(),o.beginPath(),o.translate(u[0],u[1]),f?(y=(c[0]+c[2])/2-u[0],b=(c[1]+c[3])/2-u[1]):(y=u[2]-u[0],b=u[3]-u[1]),o.rotate((Math.atan2(-b,-y)+l)%l),o.moveTo(0,0),o.lineTo(-m,N/2),o.lineTo(-m,-N/2),o.closePath(),o.restore(),this.__fillStroke(o))}__fillStroke(o){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,o.setLineDash([])),o.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const o=super.getSelfRect(),l=this.pointerWidth()/2;return{x:o.x-l,y:o.y-l,width:o.width+l*2,height:o.height+l*2}}};return Up.Arrow=a,a.prototype.className="Arrow",(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"pointerLength",10,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(a,"pointerWidth",10,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(a,"pointerAtBeginning",!1),t.Factory.addGetterSetter(a,"pointerAtEnding",!0),Up}var qp={},KE;function QB(){if(KE)return qp;KE=1,Object.defineProperty(qp,"__esModule",{value:!0}),qp.Circle=void 0;const t=Ht(),e=si(),r=Wt(),n=Vt();let i=class extends e.Shape{_sceneFunc(s){s.beginPath(),s.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),s.closePath(),s.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(s){this.radius()!==s/2&&this.radius(s/2)}setHeight(s){this.radius()!==s/2&&this.radius(s/2)}};return qp.Circle=i,i.prototype._centroid=!0,i.prototype.className="Circle",i.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(i),t.Factory.addGetterSetter(i,"radius",0,(0,r.getNumberValidator)()),qp}var Wp={},YE;function JB(){if(YE)return Wp;YE=1,Object.defineProperty(Wp,"__esModule",{value:!0}),Wp.Ellipse=void 0;const t=Ht(),e=si(),r=Wt(),n=Vt();let i=class extends e.Shape{_sceneFunc(s){const o=this.radiusX(),l=this.radiusY();s.beginPath(),s.save(),o!==l&&s.scale(1,l/o),s.arc(0,0,o,0,Math.PI*2,!1),s.restore(),s.closePath(),s.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(s){this.radiusX(s/2)}setHeight(s){this.radiusY(s/2)}};return Wp.Ellipse=i,i.prototype.className="Ellipse",i.prototype._centroid=!0,i.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(i),t.Factory.addComponentsGetterSetter(i,"radius",["x","y"]),t.Factory.addGetterSetter(i,"radiusX",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,"radiusY",0,(0,r.getNumberValidator)()),Wp}var $p={},XE;function ZB(){if(XE)return $p;XE=1,Object.defineProperty($p,"__esModule",{value:!0}),$p.Image=void 0;const t=un(),e=Ht(),r=si(),n=Vt(),i=Wt();class a extends r.Shape{constructor(o){super(o),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const o=this.image();o&&o.complete||o&&o.readyState===4||o&&o.addEventListener&&o.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){const o=!!this.cornerRadius(),l=this.hasShadow();return o&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(o){const l=this.getWidth(),u=this.getHeight(),c=this.cornerRadius(),f=this.attrs.image;let m;if(f){const g=this.attrs.cropWidth,y=this.attrs.cropHeight;g&&y?m=[f,this.cropX(),this.cropY(),g,y,0,0,l,u]:m=[f,0,0,l,u]}(this.hasFill()||this.hasStroke()||c)&&(o.beginPath(),c?t.Util.drawRoundedRectPath(o,l,u,c):o.rect(0,0,l,u),o.closePath(),o.fillStrokeShape(this)),f&&(c&&o.clip(),o.drawImage.apply(o,m))}_hitFunc(o){const l=this.width(),u=this.height(),c=this.cornerRadius();o.beginPath(),c?t.Util.drawRoundedRectPath(o,l,u,c):o.rect(0,0,l,u),o.closePath(),o.fillStrokeShape(this)}getWidth(){var o,l;return(o=this.attrs.width)!==null&&o!==void 0?o:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var o,l;return(o=this.attrs.height)!==null&&o!==void 0?o:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(o,l,u=null){const c=t.Util.createImageElement();c.onload=function(){const f=new a({image:c});l(f)},c.onerror=u,c.crossOrigin="Anonymous",c.src=o}}return $p.Image=a,a.prototype.className="Image",(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(a,"image"),e.Factory.addComponentsGetterSetter(a,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(a,"cropX",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(a,"cropY",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(a,"cropWidth",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(a,"cropHeight",0,(0,i.getNumberValidator)()),$p}var Vc={},QE;function eF(){if(QE)return Vc;QE=1,Object.defineProperty(Vc,"__esModule",{value:!0}),Vc.Tag=Vc.Label=void 0;const t=Ht(),e=si(),r=KS(),n=Wt(),i=Vt(),a=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],s="Change.konva",o="none",l="up",u="right",c="down",f="left",m=a.length;let g=class extends r.Group{constructor(w){super(w),this.on("add.konva",function(N){this._addListeners(N.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(w){let N=this,k;const C=function(){N._sync()};for(k=0;k<m;k++)w.on(a[k]+s,C)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let w=this.getText(),N=this.getTag(),k,C,E,P,_,A,I;if(w&&N){switch(k=w.width(),C=w.height(),E=N.pointerDirection(),P=N.pointerWidth(),I=N.pointerHeight(),_=0,A=0,E){case l:_=k/2,A=-1*I;break;case u:_=k+P,A=C/2;break;case c:_=k/2,A=C+I;break;case f:_=-1*P,A=C/2;break}N.setAttrs({x:-1*_,y:-1*A,width:k,height:C}),w.setAttrs({x:-1*_,y:-1*A})}}};Vc.Label=g,g.prototype.className="Label",(0,i._registerNode)(g);class y extends e.Shape{_sceneFunc(w){const N=this.width(),k=this.height(),C=this.pointerDirection(),E=this.pointerWidth(),P=this.pointerHeight(),_=this.cornerRadius();let A=0,I=0,D=0,L=0;typeof _=="number"?A=I=D=L=Math.min(_,N/2,k/2):(A=Math.min(_[0]||0,N/2,k/2),I=Math.min(_[1]||0,N/2,k/2),L=Math.min(_[2]||0,N/2,k/2),D=Math.min(_[3]||0,N/2,k/2)),w.beginPath(),w.moveTo(A,0),C===l&&(w.lineTo((N-E)/2,0),w.lineTo(N/2,-1*P),w.lineTo((N+E)/2,0)),w.lineTo(N-I,0),w.arc(N-I,I,I,Math.PI*3/2,0,!1),C===u&&(w.lineTo(N,(k-P)/2),w.lineTo(N+E,k/2),w.lineTo(N,(k+P)/2)),w.lineTo(N,k-L),w.arc(N-L,k-L,L,0,Math.PI/2,!1),C===c&&(w.lineTo((N+E)/2,k),w.lineTo(N/2,k+P),w.lineTo((N-E)/2,k)),w.lineTo(D,k),w.arc(D,k-D,D,Math.PI/2,Math.PI,!1),C===f&&(w.lineTo(0,(k+P)/2),w.lineTo(-1*E,k/2),w.lineTo(0,(k-P)/2)),w.lineTo(0,A),w.arc(A,A,A,Math.PI,Math.PI*3/2,!1),w.closePath(),w.fillStrokeShape(this)}getSelfRect(){let w=0,N=0,k=this.pointerWidth(),C=this.pointerHeight(),E=this.pointerDirection(),P=this.width(),_=this.height();return E===l?(N-=C,_+=C):E===c?_+=C:E===f?(w-=k*1.5,P+=k):E===u&&(P+=k*1.5),{x:w,y:N,width:P,height:_}}}return Vc.Tag=y,y.prototype.className="Tag",(0,i._registerNode)(y),t.Factory.addGetterSetter(y,"pointerDirection",o),t.Factory.addGetterSetter(y,"pointerWidth",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(y,"pointerHeight",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(y,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),Vc}var Kp={},JE;function uP(){if(JE)return Kp;JE=1,Object.defineProperty(Kp,"__esModule",{value:!0}),Kp.Rect=void 0;const t=Ht(),e=si(),r=Vt(),n=un(),i=Wt();class a extends e.Shape{_sceneFunc(o){const l=this.cornerRadius(),u=this.width(),c=this.height();o.beginPath(),l?n.Util.drawRoundedRectPath(o,u,c,l):o.rect(0,0,u,c),o.closePath(),o.fillStrokeShape(this)}}return Kp.Rect=a,a.prototype.className="Rect",(0,r._registerNode)(a),t.Factory.addGetterSetter(a,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),Kp}var Yp={},ZE;function tF(){if(ZE)return Yp;ZE=1,Object.defineProperty(Yp,"__esModule",{value:!0}),Yp.RegularPolygon=void 0;const t=Ht(),e=si(),r=Wt(),n=Vt();let i=class extends e.Shape{_sceneFunc(s){const o=this._getPoints();s.beginPath(),s.moveTo(o[0].x,o[0].y);for(let l=1;l<o.length;l++)s.lineTo(o[l].x,o[l].y);s.closePath(),s.fillStrokeShape(this)}_getPoints(){const s=this.attrs.sides,o=this.attrs.radius||0,l=[];for(let u=0;u<s;u++)l.push({x:o*Math.sin(u*2*Math.PI/s),y:-1*o*Math.cos(u*2*Math.PI/s)});return l}getSelfRect(){const s=this._getPoints();let o=s[0].x,l=s[0].y,u=s[0].x,c=s[0].y;return s.forEach(f=>{o=Math.min(o,f.x),l=Math.max(l,f.x),u=Math.min(u,f.y),c=Math.max(c,f.y)}),{x:o,y:u,width:l-o,height:c-u}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(s){this.radius(s/2)}setHeight(s){this.radius(s/2)}};return Yp.RegularPolygon=i,i.prototype.className="RegularPolygon",i.prototype._centroid=!0,i.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(i),t.Factory.addGetterSetter(i,"radius",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,"sides",0,(0,r.getNumberValidator)()),Yp}var Xp={},e3;function rF(){if(e3)return Xp;e3=1,Object.defineProperty(Xp,"__esModule",{value:!0}),Xp.Ring=void 0;const t=Ht(),e=si(),r=Wt(),n=Vt(),i=Math.PI*2;let a=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.innerRadius(),0,i,!1),o.moveTo(this.outerRadius(),0),o.arc(0,0,this.outerRadius(),i,0,!0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return Xp.Ring=a,a.prototype.className="Ring",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"innerRadius",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(a,"outerRadius",0,(0,r.getNumberValidator)()),Xp}var Qp={},t3;function nF(){if(t3)return Qp;t3=1,Object.defineProperty(Qp,"__esModule",{value:!0}),Qp.Sprite=void 0;const t=Ht(),e=si(),r=YS(),n=Wt(),i=Vt();let a=class extends e.Shape{constructor(o){super(o),this._updated=!0,this.anim=new r.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(o){const l=this.animation(),u=this.frameIndex(),c=u*4,f=this.animations()[l],m=this.frameOffsets(),g=f[c+0],y=f[c+1],b=f[c+2],w=f[c+3],N=this.image();if((this.hasFill()||this.hasStroke())&&(o.beginPath(),o.rect(0,0,b,w),o.closePath(),o.fillStrokeShape(this)),N)if(m){const k=m[l],C=u*2;o.drawImage(N,g,y,b,w,k[C+0],k[C+1],b,w)}else o.drawImage(N,g,y,b,w,0,0,b,w)}_hitFunc(o){const l=this.animation(),u=this.frameIndex(),c=u*4,f=this.animations()[l],m=this.frameOffsets(),g=f[c+2],y=f[c+3];if(o.beginPath(),m){const b=m[l],w=u*2;o.rect(b[w+0],b[w+1],g,y)}else o.rect(0,0,g,y);o.closePath(),o.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const o=this;this.interval=setInterval(function(){o._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const o=this.getLayer();this.anim.setLayers(o),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const o=this.frameIndex(),l=this.animation(),u=this.animations(),c=u[l],f=c.length/4;o<f-1?this.frameIndex(o+1):this.frameIndex(0)}};return Qp.Sprite=a,a.prototype.className="Sprite",(0,i._registerNode)(a),t.Factory.addGetterSetter(a,"animation"),t.Factory.addGetterSetter(a,"animations"),t.Factory.addGetterSetter(a,"frameOffsets"),t.Factory.addGetterSetter(a,"image"),t.Factory.addGetterSetter(a,"frameIndex",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"frameRate",17,(0,n.getNumberValidator)()),t.Factory.backCompat(a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Qp}var Jp={},r3;function iF(){if(r3)return Jp;r3=1,Object.defineProperty(Jp,"__esModule",{value:!0}),Jp.Star=void 0;const t=Ht(),e=si(),r=Wt(),n=Vt();let i=class extends e.Shape{_sceneFunc(s){const o=this.innerRadius(),l=this.outerRadius(),u=this.numPoints();s.beginPath(),s.moveTo(0,0-l);for(let c=1;c<u*2;c++){const f=c%2===0?l:o,m=f*Math.sin(c*Math.PI/u),g=-1*f*Math.cos(c*Math.PI/u);s.lineTo(m,g)}s.closePath(),s.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(s){this.outerRadius(s/2)}setHeight(s){this.outerRadius(s/2)}};return Jp.Star=i,i.prototype.className="Star",i.prototype._centroid=!0,i.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(i),t.Factory.addGetterSetter(i,"numPoints",5,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,"innerRadius",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,"outerRadius",0,(0,r.getNumberValidator)()),Jp}var Df={},n3;function cP(){if(n3)return Df;n3=1,Object.defineProperty(Df,"__esModule",{value:!0}),Df.Text=void 0,Df.stringToArray=s;const t=un(),e=Ht(),r=si(),n=Vt(),i=Wt(),a=Vt();function s(Y){return[...Y].reduce((Z,ie,ce,he)=>(new RegExp("\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?(?:\\u200D\\p{Emoji_Presentation})+","u").test(ie)?Z.push(ie):new RegExp("\\p{Regional_Indicator}{2}","u").test(ie+(he[ce+1]||""))?Z.push(ie+he[ce+1]):ce>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(ie)?Z[Z.length-1]+=ie:Z.push(ie),Z),[])}const o="auto",l="center",u="inherit",c="justify",f="Change.konva",m="2d",g="-",y="left",b="text",w="Text",N="top",k="bottom",C="middle",E="normal",P="px ",_=" ",A="right",I="rtl",D="word",L="char",U="none",H="",M=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],z=M.length;function O(Y){return Y.split(",").map(Z=>{Z=Z.trim();const ie=Z.indexOf(" ")>=0,ce=Z.indexOf('"')>=0||Z.indexOf("'")>=0;return ie&&!ce&&(Z=`"${Z}"`),Z}).join(", ")}let G;function W(){return G||(G=t.Util.createCanvasElement().getContext(m),G)}function $(Y){Y.fillText(this._partialText,this._partialTextX,this._partialTextY)}function X(Y){Y.setAttr("miterLimit",2),Y.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Q(Y){return Y=Y||{},!Y.fillLinearGradientColorStops&&!Y.fillRadialGradientColorStops&&!Y.fillPatternImage&&(Y.fill=Y.fill||"black"),Y}class V extends r.Shape{constructor(Z){super(Q(Z)),this._partialTextX=0,this._partialTextY=0;for(let ie=0;ie<z;ie++)this.on(M[ie]+f,this._setTextData);this._setTextData()}_sceneFunc(Z){const ie=this.textArr,ce=ie.length;if(!this.text())return;let he=this.padding(),ee=this.fontSize(),le=this.lineHeight()*ee,te=this.verticalAlign(),ae=this.direction(),oe=0,fe=this.align(),pe=this.getWidth(),Te=this.letterSpacing(),Oe=this.fill(),_e=this.textDecoration(),Ae=_e.indexOf("underline")!==-1,He=_e.indexOf("line-through")!==-1,tt;ae=ae===u?Z.direction:ae;let Ie=le/2,ye=C;if(n.Konva._fixTextRendering){const Ye=this.measureSize("M");ye="alphabetic",Ie=(Ye.fontBoundingBoxAscent-Ye.fontBoundingBoxDescent)/2+le/2}var Pe=0,Be=0;for(ae===I&&Z.setAttr("direction",ae),Z.setAttr("font",this._getContextFont()),Z.setAttr("textBaseline",ye),Z.setAttr("textAlign",y),te===C?oe=(this.getHeight()-ce*le-he*2)/2:te===k&&(oe=this.getHeight()-ce*le-he*2),Z.translate(he,oe+he),tt=0;tt<ce;tt++){var Pe=0,Be=0,Ge=ie[tt],et=Ge.text,mt=Ge.width,gt=Ge.lastInParagraph,bt,_t,ot;if(Z.save(),fe===A?Pe+=pe-mt-he*2:fe===l&&(Pe+=(pe-mt-he*2)/2),Ae){Z.save(),Z.beginPath();const re=n.Konva._fixTextRendering?Math.round(ee/4):Math.round(ee/2),ue=Pe,ge=Ie+Be+re;Z.moveTo(ue,ge),bt=et.split(" ").length-1,_t=bt===0,ot=fe===c&&!gt?pe-he*2:mt,Z.lineTo(ue+Math.round(ot),ge),Z.lineWidth=ee/15;const be=this._getLinearGradient();Z.strokeStyle=be||Oe,Z.stroke(),Z.restore()}if(He){Z.save(),Z.beginPath();const re=n.Konva._fixTextRendering?-Math.round(ee/4):0;Z.moveTo(Pe,Ie+Be+re),bt=et.split(" ").length-1,_t=bt===0,ot=fe===c&&gt&&!_t?pe-he*2:mt,Z.lineTo(Pe+Math.round(ot),Ie+Be+re),Z.lineWidth=ee/15;const ue=this._getLinearGradient();Z.strokeStyle=ue||Oe,Z.stroke(),Z.restore()}if(ae!==I&&(Te!==0||fe===c)){bt=et.split(" ").length-1;const re=s(et);for(let ue=0;ue<re.length;ue++){const ge=re[ue];ge===" "&&!gt&&fe===c&&(Pe+=(pe-he*2-mt)/bt),this._partialTextX=Pe,this._partialTextY=Ie+Be,this._partialText=ge,Z.fillStrokeShape(this),Pe+=this.measureSize(ge).width+Te}}else Te!==0&&Z.setAttr("letterSpacing",`${Te}px`),this._partialTextX=Pe,this._partialTextY=Ie+Be,this._partialText=et,Z.fillStrokeShape(this);Z.restore(),ce>1&&(Ie+=le)}}_hitFunc(Z){const ie=this.getWidth(),ce=this.getHeight();Z.beginPath(),Z.rect(0,0,ie,ce),Z.closePath(),Z.fillStrokeShape(this)}setText(Z){const ie=t.Util._isString(Z)?Z:Z==null?"":Z+"";return this._setAttr(b,ie),this}getWidth(){return this.attrs.width===o||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===o||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(Z){var ie,ce,he,ee,le,te,ae,oe,fe,pe,Te;let Oe=W(),_e=this.fontSize(),Ae;Oe.save(),Oe.font=this._getContextFont(),Ae=Oe.measureText(Z),Oe.restore();const He=_e/100;return{actualBoundingBoxAscent:(ie=Ae.actualBoundingBoxAscent)!==null&&ie!==void 0?ie:71.58203125*He,actualBoundingBoxDescent:(ce=Ae.actualBoundingBoxDescent)!==null&&ce!==void 0?ce:0,actualBoundingBoxLeft:(he=Ae.actualBoundingBoxLeft)!==null&&he!==void 0?he:-7.421875*He,actualBoundingBoxRight:(ee=Ae.actualBoundingBoxRight)!==null&&ee!==void 0?ee:75.732421875*He,alphabeticBaseline:(le=Ae.alphabeticBaseline)!==null&&le!==void 0?le:0,emHeightAscent:(te=Ae.emHeightAscent)!==null&&te!==void 0?te:100*He,emHeightDescent:(ae=Ae.emHeightDescent)!==null&&ae!==void 0?ae:-20*He,fontBoundingBoxAscent:(oe=Ae.fontBoundingBoxAscent)!==null&&oe!==void 0?oe:91*He,fontBoundingBoxDescent:(fe=Ae.fontBoundingBoxDescent)!==null&&fe!==void 0?fe:21*He,hangingBaseline:(pe=Ae.hangingBaseline)!==null&&pe!==void 0?pe:72.80000305175781*He,ideographicBaseline:(Te=Ae.ideographicBaseline)!==null&&Te!==void 0?Te:-21*He,width:Ae.width,height:_e}}_getContextFont(){return this.fontStyle()+_+this.fontVariant()+_+(this.fontSize()+P)+O(this.fontFamily())}_addTextLine(Z){this.align()===c&&(Z=Z.trim());const ce=this._getTextWidth(Z);return this.textArr.push({text:Z,width:ce,lastInParagraph:!1})}_getTextWidth(Z){const ie=this.letterSpacing(),ce=Z.length;return W().measureText(Z).width+(ce?ie*(ce-1):0)}_setTextData(){let Z=this.text().split(`
`),ie=+this.fontSize(),ce=0,he=this.lineHeight()*ie,ee=this.attrs.width,le=this.attrs.height,te=ee!==o&&ee!==void 0,ae=le!==o&&le!==void 0,oe=this.padding(),fe=ee-oe*2,pe=le-oe*2,Te=0,Oe=this.wrap(),_e=Oe!==U,Ae=Oe!==L&&_e,He=this.ellipsis();this.textArr=[],W().font=this._getContextFont();const tt=He?this._getTextWidth(H):0;for(let ye=0,Pe=Z.length;ye<Pe;++ye){let Be=Z[ye],Ge=this._getTextWidth(Be);if(te&&Ge>fe)for(;Be.length>0;){let et=0,mt=Be.length,gt="",bt=0;for(;et<mt;){const _t=et+mt>>>1,ot=Be.slice(0,_t+1),Ye=this._getTextWidth(ot)+tt;Ye<=fe?(et=_t+1,gt=ot,bt=Ye):mt=_t}if(gt){if(Ae){var Ie;const ot=Be[gt.length];(ot===_||ot===g)&&bt<=fe?Ie=gt.length:Ie=Math.max(gt.lastIndexOf(_),gt.lastIndexOf(g))+1,Ie>0&&(et=Ie,gt=gt.slice(0,et),bt=this._getTextWidth(gt))}if(gt=gt.trimRight(),this._addTextLine(gt),ce=Math.max(ce,bt),Te+=he,this._shouldHandleEllipsis(Te)){this._tryToAddEllipsisToLastLine();break}if(Be=Be.slice(et),Be=Be.trimLeft(),Be.length>0&&(Ge=this._getTextWidth(Be),Ge<=fe)){this._addTextLine(Be),Te+=he,ce=Math.max(ce,Ge);break}}else break}else this._addTextLine(Be),Te+=he,ce=Math.max(ce,Ge),this._shouldHandleEllipsis(Te)&&ye<Pe-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),ae&&Te+he>pe)break}this.textHeight=ie,this.textWidth=ce}_shouldHandleEllipsis(Z){const ie=+this.fontSize(),ce=this.lineHeight()*ie,he=this.attrs.height,ee=he!==o&&he!==void 0,le=this.padding(),te=he-le*2;return!(this.wrap()!==U)||ee&&Z+ce>te}_tryToAddEllipsisToLastLine(){const Z=this.attrs.width,ie=Z!==o&&Z!==void 0,ce=this.padding(),he=Z-ce*2,ee=this.ellipsis(),le=this.textArr[this.textArr.length-1];!le||!ee||(ie&&(this._getTextWidth(le.text+H)<he||(le.text=le.text.slice(0,le.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(le.text+H))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const Z=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,ie=this.hasShadow();return Z&&ie?!0:super._useBufferCanvas()}}return Df.Text=V,V.prototype._fillFunc=$,V.prototype._strokeFunc=X,V.prototype.className=w,V.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,a._registerNode)(V),e.Factory.overWriteSetter(V,"width",(0,i.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(V,"height",(0,i.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(V,"direction",u),e.Factory.addGetterSetter(V,"fontFamily","Arial"),e.Factory.addGetterSetter(V,"fontSize",12,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(V,"fontStyle",E),e.Factory.addGetterSetter(V,"fontVariant",E),e.Factory.addGetterSetter(V,"padding",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(V,"align",y),e.Factory.addGetterSetter(V,"verticalAlign",N),e.Factory.addGetterSetter(V,"lineHeight",1,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(V,"wrap",D),e.Factory.addGetterSetter(V,"ellipsis",!1,(0,i.getBooleanValidator)()),e.Factory.addGetterSetter(V,"letterSpacing",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(V,"text","",(0,i.getStringValidator)()),e.Factory.addGetterSetter(V,"textDecoration",""),Df}var Zp={},i3;function aF(){if(i3)return Zp;i3=1,Object.defineProperty(Zp,"__esModule",{value:!0}),Zp.TextPath=void 0;const t=un(),e=Ht(),r=si(),n=XS(),i=cP(),a=Wt(),s=Vt(),o="",l="normal";function u(m){m.fillText(this.partialText,0,0)}function c(m){m.strokeText(this.partialText,0,0)}let f=class extends r.Shape{constructor(g){super(g),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(g){if(!this.attrs.data)return null;const y=this.pathLength;return g-1>y?null:n.Path.getPointAtLengthOfDataArray(g,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(g){g.setAttr("font",this._getContextFont()),g.setAttr("textBaseline",this.textBaseline()),g.setAttr("textAlign","left"),g.save();const y=this.textDecoration(),b=this.fill(),w=this.fontSize(),N=this.glyphInfo;y==="underline"&&g.beginPath();for(let k=0;k<N.length;k++){g.save();const C=N[k].p0;g.translate(C.x,C.y),g.rotate(N[k].rotation),this.partialText=N[k].text,g.fillStrokeShape(this),y==="underline"&&(k===0&&g.moveTo(0,w/2+1),g.lineTo(w,w/2+1)),g.restore()}y==="underline"&&(g.strokeStyle=b,g.lineWidth=w/20,g.stroke()),g.restore()}_hitFunc(g){g.beginPath();const y=this.glyphInfo;if(y.length>=1){const b=y[0].p0;g.moveTo(b.x,b.y)}for(let b=0;b<y.length;b++){const w=y[b].p1;g.lineTo(w.x,w.y)}g.setAttr("lineWidth",this.fontSize()),g.setAttr("strokeStyle",this.colorKey),g.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(g){return i.Text.prototype.setText.call(this,g)}_getContextFont(){return i.Text.prototype._getContextFont.call(this)}_getTextSize(g){const b=this.dummyCanvas.getContext("2d");b.save(),b.font=this._getContextFont();const w=b.measureText(g);return b.restore(),{width:w.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:g,height:y}=this._getTextSize(this.attrs.text);if(this.textWidth=g,this.textHeight=y,this.glyphInfo=[],!this.attrs.data)return null;const b=this.letterSpacing(),w=this.align(),N=this.kerningFunc(),k=Math.max(this.textWidth+((this.attrs.text||"").length-1)*b,0);let C=0;w==="center"&&(C=Math.max(0,this.pathLength/2-k/2)),w==="right"&&(C=Math.max(0,this.pathLength-k));const E=(0,i.stringToArray)(this.text());let P=C;for(let _=0;_<E.length;_++){const A=this._getPointAtLength(P);if(!A)return;let I=this._getTextSize(E[_]).width+b;if(E[_]===" "&&w==="justify"){const z=this.text().split(" ").length-1;I+=(this.pathLength-k)/z}const D=this._getPointAtLength(P+I);if(!D)return;const L=n.Path.getLineLength(A.x,A.y,D.x,D.y);let U=0;if(N)try{U=N(E[_-1],E[_])*this.fontSize()}catch{U=0}A.x+=U,D.x+=U,this.textWidth+=U;const H=n.Path.getPointOnLine(U+L/2,A.x,A.y,D.x,D.y),M=Math.atan2(D.y-A.y,D.x-A.x);this.glyphInfo.push({transposeX:H.x,transposeY:H.y,text:E[_],rotation:M,p0:A,p1:D}),P+=I}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const g=[];this.glyphInfo.forEach(function(P){g.push(P.p0.x),g.push(P.p0.y),g.push(P.p1.x),g.push(P.p1.y)});let y=g[0]||0,b=g[0]||0,w=g[1]||0,N=g[1]||0,k,C;for(let P=0;P<g.length/2;P++)k=g[P*2],C=g[P*2+1],y=Math.min(y,k),b=Math.max(b,k),w=Math.min(w,C),N=Math.max(N,C);const E=this.fontSize();return{x:y-E/2,y:w-E/2,width:b-y+E,height:N-w+E}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return Zp.TextPath=f,f.prototype._fillFunc=u,f.prototype._strokeFunc=c,f.prototype._fillFuncHit=u,f.prototype._strokeFuncHit=c,f.prototype.className="TextPath",f.prototype._attrsAffectingSize=["text","fontSize","data"],(0,s._registerNode)(f),e.Factory.addGetterSetter(f,"data"),e.Factory.addGetterSetter(f,"fontFamily","Arial"),e.Factory.addGetterSetter(f,"fontSize",12,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(f,"fontStyle",l),e.Factory.addGetterSetter(f,"align","left"),e.Factory.addGetterSetter(f,"letterSpacing",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(f,"textBaseline","middle"),e.Factory.addGetterSetter(f,"fontVariant",l),e.Factory.addGetterSetter(f,"text",o),e.Factory.addGetterSetter(f,"textDecoration",null),e.Factory.addGetterSetter(f,"kerningFunc",null),Zp}var em={},a3;function sF(){if(a3)return em;a3=1,Object.defineProperty(em,"__esModule",{value:!0}),em.Transformer=void 0;const t=un(),e=Ht(),r=bn(),n=si(),i=uP(),a=KS(),s=Vt(),o=Wt(),l=Vt(),u="tr-konva",c=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(I=>I+`.${u}`).join(" "),f="nodesRect",m=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],g={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},y="ontouchstart"in s.Konva._global;function b(I,D,L){if(I==="rotater")return L;D+=t.Util.degToRad(g[I]||0);const U=(t.Util.radToDeg(D)%360+360)%360;return t.Util._inRange(U,315+22.5,360)||t.Util._inRange(U,0,22.5)?"ns-resize":t.Util._inRange(U,45-22.5,45+22.5)?"nesw-resize":t.Util._inRange(U,90-22.5,90+22.5)?"ew-resize":t.Util._inRange(U,135-22.5,135+22.5)?"nwse-resize":t.Util._inRange(U,180-22.5,180+22.5)?"ns-resize":t.Util._inRange(U,225-22.5,225+22.5)?"nesw-resize":t.Util._inRange(U,270-22.5,270+22.5)?"ew-resize":t.Util._inRange(U,315-22.5,315+22.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+U),"pointer")}const w=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function N(I){return{x:I.x+I.width/2*Math.cos(I.rotation)+I.height/2*Math.sin(-I.rotation),y:I.y+I.height/2*Math.cos(I.rotation)+I.width/2*Math.sin(I.rotation)}}function k(I,D,L){const U=L.x+(I.x-L.x)*Math.cos(D)-(I.y-L.y)*Math.sin(D),H=L.y+(I.x-L.x)*Math.sin(D)+(I.y-L.y)*Math.cos(D);return{...I,rotation:I.rotation+D,x:U,y:H}}function C(I,D){const L=N(I);return k(I,D,L)}function E(I,D,L){let U=D;for(let H=0;H<I.length;H++){const M=s.Konva.getAngle(I[H]),z=Math.abs(M-D)%(Math.PI*2);Math.min(z,Math.PI*2-z)<L&&(U=M)}return U}let P=0;class _ extends a.Group{constructor(D){super(D),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(c,this.update),this.getNode()&&this.update()}attachTo(D){return this.setNode(D),this}setNode(D){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([D])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return u+this._id}setNodes(D=[]){this._nodes&&this._nodes.length&&this.detach();const L=D.filter(H=>H.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=D=L,D.length===1&&this.useSingleNodeRotation()?this.rotation(D[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(H=>{const M=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},z=H._attrsAffectingSize.map(O=>O+"Change."+this._getEventNamespace()).join(" ");H.on(z,M),H.on(m.map(O=>O+`.${this._getEventNamespace()}`).join(" "),M),H.on(`absoluteTransformChange.${this._getEventNamespace()}`,M),this._proxyDrag(H)}),this._resetTransformCache(),this.findOne(".top-left")&&this.update(),this}_proxyDrag(D){let L;D.on(`dragstart.${this._getEventNamespace()}`,U=>{L=D.getAbsolutePosition(),!this.isDragging()&&D!==this.findOne(".back")&&this.startDrag(U,!1)}),D.on(`dragmove.${this._getEventNamespace()}`,U=>{if(!L)return;const H=D.getAbsolutePosition(),M=H.x-L.x,z=H.y-L.y;this.nodes().forEach(O=>{if(O===D||O.isDragging())return;const G=O.getAbsolutePosition();O.setAbsolutePosition({x:G.x+M,y:G.y+z}),O.startDrag(U)}),L=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(D=>{D.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(f),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(f,this.__getNodeRect)}__getNodeShape(D,L=this.rotation(),U){const H=D.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),M=D.getAbsoluteScale(U),z=D.getAbsolutePosition(U),O=H.x*M.x-D.offsetX()*M.x,G=H.y*M.y-D.offsetY()*M.y,W=(s.Konva.getAngle(D.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),$={x:z.x+O*Math.cos(W)+G*Math.sin(-W),y:z.y+G*Math.cos(W)+O*Math.sin(W),width:H.width*M.x,height:H.height*M.y,rotation:W};return k($,-s.Konva.getAngle(L),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const L=[];this.nodes().map(W=>{const $=W.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),X=[{x:$.x,y:$.y},{x:$.x+$.width,y:$.y},{x:$.x+$.width,y:$.y+$.height},{x:$.x,y:$.y+$.height}],Q=W.getAbsoluteTransform();X.forEach(function(V){const Y=Q.point(V);L.push(Y)})});const U=new t.Transform;U.rotate(-s.Konva.getAngle(this.rotation()));let H=1/0,M=1/0,z=-1/0,O=-1/0;L.forEach(function(W){const $=U.point(W);H===void 0&&(H=z=$.x,M=O=$.y),H=Math.min(H,$.x),M=Math.min(M,$.y),z=Math.max(z,$.x),O=Math.max(O,$.y)}),U.invert();const G=U.point({x:H,y:M});return{x:G.x,y:G.y,width:z-H,height:O-M,rotation:s.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),w.forEach(D=>{this._createAnchor(D)}),this._createAnchor("rotater")}_createAnchor(D){const L=new i.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:D+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:y?10:"auto"}),U=this;L.on("mousedown touchstart",function(H){U._handleMouseDown(H)}),L.on("dragstart",H=>{L.stopDrag(),H.cancelBubble=!0}),L.on("dragend",H=>{H.cancelBubble=!0}),L.on("mouseenter",()=>{const H=s.Konva.getAngle(this.rotation()),M=this.rotateAnchorCursor(),z=b(D,H,M);L.getStage().content&&(L.getStage().content.style.cursor=z),this._cursorChange=!0}),L.on("mouseout",()=>{L.getStage().content&&(L.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(L)}_createBack(){const D=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(L,U){const H=U.getParent(),M=H.padding();L.beginPath(),L.rect(-M,-M,U.width()+M*2,U.height()+M*2),L.moveTo(U.width()/2,-M),H.rotateEnabled()&&H.rotateLineVisible()&&L.lineTo(U.width()/2,-H.rotateAnchorOffset()*t.Util._sign(U.height())-M),L.fillStrokeShape(U)},hitFunc:(L,U)=>{if(!this.shouldOverdrawWholeArea())return;const H=this.padding();L.beginPath(),L.rect(-H,-H,U.width()+H*2,U.height()+H*2),L.fillStrokeShape(U)}});this.add(D),this._proxyDrag(D),D.on("dragstart",L=>{L.cancelBubble=!0}),D.on("dragmove",L=>{L.cancelBubble=!0}),D.on("dragend",L=>{L.cancelBubble=!0}),this.on("dragmove",L=>{this.update()})}_handleMouseDown(D){if(this._transforming)return;this._movingAnchorName=D.target.name().split(" ")[0];const L=this._getNodeRect(),U=L.width,H=L.height,M=Math.sqrt(Math.pow(U,2)+Math.pow(H,2));this.sin=Math.abs(H/M),this.cos=Math.abs(U/M),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const z=D.target.getAbsolutePosition(),O=D.target.getStage().getPointerPosition();this._anchorDragOffset={x:O.x-z.x,y:O.y-z.y},P++,this._fire("transformstart",{evt:D.evt,target:this.getNode()}),this._nodes.forEach(G=>{G._fire("transformstart",{evt:D.evt,target:G})})}_handleMouseMove(D){let L,U,H;const M=this.findOne("."+this._movingAnchorName),z=M.getStage();z.setPointersPositions(D);const O=z.getPointerPosition();let G={x:O.x-this._anchorDragOffset.x,y:O.y-this._anchorDragOffset.y};const W=M.getAbsolutePosition();this.anchorDragBoundFunc()&&(G=this.anchorDragBoundFunc()(W,G,D)),M.setAbsolutePosition(G);const $=M.getAbsolutePosition();if(W.x===$.x&&W.y===$.y)return;if(this._movingAnchorName==="rotater"){const te=this._getNodeRect();L=M.x()-te.width/2,U=-M.y()+te.height/2;let ae=Math.atan2(-U,L)+Math.PI/2;te.height<0&&(ae-=Math.PI);const fe=s.Konva.getAngle(this.rotation())+ae,pe=s.Konva.getAngle(this.rotationSnapTolerance()),Oe=E(this.rotationSnaps(),fe,pe)-te.rotation,_e=C(te,Oe);this._fitNodesInto(_e,D);return}const X=this.shiftBehavior();let Q;X==="inverted"?Q=this.keepRatio()&&!D.shiftKey:X==="none"?Q=this.keepRatio():Q=this.keepRatio()||D.shiftKey;var ce=this.centeredScaling()||D.altKey;if(this._movingAnchorName==="top-left"){if(Q){var V=ce?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};H=Math.sqrt(Math.pow(V.x-M.x(),2)+Math.pow(V.y-M.y(),2));var Y=this.findOne(".top-left").x()>V.x?-1:1,Z=this.findOne(".top-left").y()>V.y?-1:1;L=H*this.cos*Y,U=H*this.sin*Z,this.findOne(".top-left").x(V.x-L),this.findOne(".top-left").y(V.y-U)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(M.y());else if(this._movingAnchorName==="top-right"){if(Q){var V=ce?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};H=Math.sqrt(Math.pow(M.x()-V.x,2)+Math.pow(V.y-M.y(),2));var Y=this.findOne(".top-right").x()<V.x?-1:1,Z=this.findOne(".top-right").y()>V.y?-1:1;L=H*this.cos*Y,U=H*this.sin*Z,this.findOne(".top-right").x(V.x+L),this.findOne(".top-right").y(V.y-U)}var ie=M.position();this.findOne(".top-left").y(ie.y),this.findOne(".bottom-right").x(ie.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(M.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(M.x());else if(this._movingAnchorName==="bottom-left"){if(Q){var V=ce?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};H=Math.sqrt(Math.pow(V.x-M.x(),2)+Math.pow(M.y()-V.y,2));var Y=V.x<M.x()?-1:1,Z=M.y()<V.y?-1:1;L=H*this.cos*Y,U=H*this.sin*Z,M.x(V.x-L),M.y(V.y+U)}ie=M.position(),this.findOne(".top-left").x(ie.x),this.findOne(".bottom-right").y(ie.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(M.y());else if(this._movingAnchorName==="bottom-right"){if(Q){var V=ce?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};H=Math.sqrt(Math.pow(M.x()-V.x,2)+Math.pow(M.y()-V.y,2));var Y=this.findOne(".bottom-right").x()<V.x?-1:1,Z=this.findOne(".bottom-right").y()<V.y?-1:1;L=H*this.cos*Y,U=H*this.sin*Z,this.findOne(".bottom-right").x(V.x+L),this.findOne(".bottom-right").y(V.y+U)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var ce=this.centeredScaling()||D.altKey;if(ce){const te=this.findOne(".top-left"),ae=this.findOne(".bottom-right"),oe=te.x(),fe=te.y(),pe=this.getWidth()-ae.x(),Te=this.getHeight()-ae.y();ae.move({x:-oe,y:-fe}),te.move({x:pe,y:Te})}const he=this.findOne(".top-left").getAbsolutePosition();L=he.x,U=he.y;const ee=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),le=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:L,y:U,width:ee,height:le,rotation:s.Konva.getAngle(this.rotation())},D)}_handleMouseUp(D){this._removeEvents(D)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(D){var L;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const U=this.getNode();P--,this._fire("transformend",{evt:D,target:U}),(L=this.getLayer())===null||L===void 0||L.batchDraw(),U&&this._nodes.forEach(H=>{var M;H._fire("transformend",{evt:D,target:H}),(M=H.getLayer())===null||M===void 0||M.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(D,L){const U=this._getNodeRect(),H=1;if(t.Util._inRange(D.width,-this.padding()*2-H,H)){this.update();return}if(t.Util._inRange(D.height,-this.padding()*2-H,H)){this.update();return}const M=new t.Transform;if(M.rotate(s.Konva.getAngle(this.rotation())),this._movingAnchorName&&D.width<0&&this._movingAnchorName.indexOf("left")>=0){const Q=M.point({x:-this.padding()*2,y:0});D.x+=Q.x,D.y+=Q.y,D.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=Q.x,this._anchorDragOffset.y-=Q.y}else if(this._movingAnchorName&&D.width<0&&this._movingAnchorName.indexOf("right")>=0){const Q=M.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=Q.x,this._anchorDragOffset.y-=Q.y,D.width+=this.padding()*2}if(this._movingAnchorName&&D.height<0&&this._movingAnchorName.indexOf("top")>=0){const Q=M.point({x:0,y:-this.padding()*2});D.x+=Q.x,D.y+=Q.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=Q.x,this._anchorDragOffset.y-=Q.y,D.height+=this.padding()*2}else if(this._movingAnchorName&&D.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const Q=M.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=Q.x,this._anchorDragOffset.y-=Q.y,D.height+=this.padding()*2}if(this.boundBoxFunc()){const Q=this.boundBoxFunc()(U,D);Q?D=Q:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const z=1e7,O=new t.Transform;O.translate(U.x,U.y),O.rotate(U.rotation),O.scale(U.width/z,U.height/z);const G=new t.Transform,W=D.width/z,$=D.height/z;this.flipEnabled()===!1?(G.translate(D.x,D.y),G.rotate(D.rotation),G.translate(D.width<0?D.width:0,D.height<0?D.height:0),G.scale(Math.abs(W),Math.abs($))):(G.translate(D.x,D.y),G.rotate(D.rotation),G.scale(W,$));const X=G.multiply(O.invert());this._nodes.forEach(Q=>{var V;const Y=Q.getParent().getAbsoluteTransform(),Z=Q.getTransform().copy();Z.translate(Q.offsetX(),Q.offsetY());const ie=new t.Transform;ie.multiply(Y.copy().invert()).multiply(X).multiply(Y).multiply(Z);const ce=ie.decompose();Q.setAttrs(ce),(V=Q.getLayer())===null||V===void 0||V.batchDraw()}),this.rotation(t.Util._getRotation(D.rotation)),this._nodes.forEach(Q=>{this._fire("transform",{evt:L,target:Q}),Q._fire("transform",{evt:L,target:Q})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(D,L){this.findOne(D).setAttrs(L)}update(){var D;const L=this._getNodeRect();this.rotation(t.Util._getRotation(L.rotation));const U=L.width,H=L.height,M=this.enabledAnchors(),z=this.resizeEnabled(),O=this.padding(),G=this.anchorSize(),W=this.find("._anchor");W.forEach(X=>{X.setAttrs({width:G,height:G,offsetX:G/2,offsetY:G/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:G/2+O,offsetY:G/2+O,visible:z&&M.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:U/2,y:0,offsetY:G/2+O,visible:z&&M.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:U,y:0,offsetX:G/2-O,offsetY:G/2+O,visible:z&&M.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:H/2,offsetX:G/2+O,visible:z&&M.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:U,y:H/2,offsetX:G/2-O,visible:z&&M.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:H,offsetX:G/2+O,offsetY:G/2-O,visible:z&&M.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:U/2,y:H,offsetY:G/2-O,visible:z&&M.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:U,y:H,offsetX:G/2-O,offsetY:G/2-O,visible:z&&M.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:U/2,y:-this.rotateAnchorOffset()*t.Util._sign(H)-O,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:U,height:H,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const $=this.anchorStyleFunc();$&&W.forEach(X=>{$(X)}),(D=this.getLayer())===null||D===void 0||D.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const D=this.findOne("."+this._movingAnchorName);D&&D.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),a.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(D){return r.Node.prototype.clone.call(this,D)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}em.Transformer=_,_.isTransforming=()=>P>0;function A(I){return I instanceof Array||t.Util.warn("enabledAnchors value should be an array"),I instanceof Array&&I.forEach(function(D){w.indexOf(D)===-1&&t.Util.warn("Unknown anchor name: "+D+". Available names are: "+w.join(", "))}),I||[]}return _.prototype.className="Transformer",(0,l._registerNode)(_),e.Factory.addGetterSetter(_,"enabledAnchors",w,A),e.Factory.addGetterSetter(_,"flipEnabled",!0,(0,o.getBooleanValidator)()),e.Factory.addGetterSetter(_,"resizeEnabled",!0),e.Factory.addGetterSetter(_,"anchorSize",10,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(_,"rotateEnabled",!0),e.Factory.addGetterSetter(_,"rotateLineVisible",!0),e.Factory.addGetterSetter(_,"rotationSnaps",[]),e.Factory.addGetterSetter(_,"rotateAnchorOffset",50,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(_,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(_,"rotationSnapTolerance",5,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(_,"borderEnabled",!0),e.Factory.addGetterSetter(_,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(_,"anchorStrokeWidth",1,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(_,"anchorFill","white"),e.Factory.addGetterSetter(_,"anchorCornerRadius",0,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(_,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(_,"borderStrokeWidth",1,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(_,"borderDash"),e.Factory.addGetterSetter(_,"keepRatio",!0),e.Factory.addGetterSetter(_,"shiftBehavior","default"),e.Factory.addGetterSetter(_,"centeredScaling",!1),e.Factory.addGetterSetter(_,"ignoreStroke",!1),e.Factory.addGetterSetter(_,"padding",0,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(_,"node"),e.Factory.addGetterSetter(_,"nodes"),e.Factory.addGetterSetter(_,"boundBoxFunc"),e.Factory.addGetterSetter(_,"anchorDragBoundFunc"),e.Factory.addGetterSetter(_,"anchorStyleFunc"),e.Factory.addGetterSetter(_,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(_,"useSingleNodeRotation",!0),e.Factory.backCompat(_,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),em}var tm={},s3;function oF(){if(s3)return tm;s3=1,Object.defineProperty(tm,"__esModule",{value:!0}),tm.Wedge=void 0;const t=Ht(),e=si(),r=Vt(),n=Wt(),i=Vt();let a=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),o.lineTo(0,0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return tm.Wedge=a,a.prototype.className="Wedge",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(a),t.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"clockwise",!1),t.Factory.backCompat(a,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),tm}var rm={},o3;function lF(){if(o3)return rm;o3=1,Object.defineProperty(rm,"__esModule",{value:!0}),rm.Blur=void 0;const t=Ht(),e=bn(),r=Wt();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const i=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function s(l,u){const c=l.data,f=l.width,m=l.height;let g,y,b,w,N,k,C,E,P,_,A,I,D,L,U,H,M,z,O,G,W,$,X,Q,V=u+u+1,Y=f-1,Z=m-1,ie=u+1,ce=ie*(ie+1)/2,he=new n,ee=null,le=he,te=null,ae=null,oe=i[u],fe=a[u];for(b=1;b<V;b++)le=le.next=new n,b===ie&&(ee=le);for(le.next=he,C=k=0,y=0;y<m;y++){for(H=M=z=O=E=P=_=A=0,I=ie*(G=c[k]),D=ie*(W=c[k+1]),L=ie*($=c[k+2]),U=ie*(X=c[k+3]),E+=ce*G,P+=ce*W,_+=ce*$,A+=ce*X,le=he,b=0;b<ie;b++)le.r=G,le.g=W,le.b=$,le.a=X,le=le.next;for(b=1;b<ie;b++)w=k+((Y<b?Y:b)<<2),E+=(le.r=G=c[w])*(Q=ie-b),P+=(le.g=W=c[w+1])*Q,_+=(le.b=$=c[w+2])*Q,A+=(le.a=X=c[w+3])*Q,H+=G,M+=W,z+=$,O+=X,le=le.next;for(te=he,ae=ee,g=0;g<f;g++)c[k+3]=X=A*oe>>fe,X!==0?(X=255/X,c[k]=(E*oe>>fe)*X,c[k+1]=(P*oe>>fe)*X,c[k+2]=(_*oe>>fe)*X):c[k]=c[k+1]=c[k+2]=0,E-=I,P-=D,_-=L,A-=U,I-=te.r,D-=te.g,L-=te.b,U-=te.a,w=C+((w=g+u+1)<Y?w:Y)<<2,H+=te.r=c[w],M+=te.g=c[w+1],z+=te.b=c[w+2],O+=te.a=c[w+3],E+=H,P+=M,_+=z,A+=O,te=te.next,I+=G=ae.r,D+=W=ae.g,L+=$=ae.b,U+=X=ae.a,H-=G,M-=W,z-=$,O-=X,ae=ae.next,k+=4;C+=f}for(g=0;g<f;g++){for(M=z=O=H=P=_=A=E=0,k=g<<2,I=ie*(G=c[k]),D=ie*(W=c[k+1]),L=ie*($=c[k+2]),U=ie*(X=c[k+3]),E+=ce*G,P+=ce*W,_+=ce*$,A+=ce*X,le=he,b=0;b<ie;b++)le.r=G,le.g=W,le.b=$,le.a=X,le=le.next;for(N=f,b=1;b<=u;b++)k=N+g<<2,E+=(le.r=G=c[k])*(Q=ie-b),P+=(le.g=W=c[k+1])*Q,_+=(le.b=$=c[k+2])*Q,A+=(le.a=X=c[k+3])*Q,H+=G,M+=W,z+=$,O+=X,le=le.next,b<Z&&(N+=f);for(k=g,te=he,ae=ee,y=0;y<m;y++)w=k<<2,c[w+3]=X=A*oe>>fe,X>0?(X=255/X,c[w]=(E*oe>>fe)*X,c[w+1]=(P*oe>>fe)*X,c[w+2]=(_*oe>>fe)*X):c[w]=c[w+1]=c[w+2]=0,E-=I,P-=D,_-=L,A-=U,I-=te.r,D-=te.g,L-=te.b,U-=te.a,w=g+((w=y+ie)<Z?w:Z)*f<<2,E+=H+=te.r=c[w],P+=M+=te.g=c[w+1],_+=z+=te.b=c[w+2],A+=O+=te.a=c[w+3],te=te.next,I+=G=ae.r,D+=W=ae.g,L+=$=ae.b,U+=X=ae.a,H-=G,M-=W,z-=$,O-=X,ae=ae.next,k+=f}}const o=function(u){const c=Math.round(this.blurRadius());c>0&&s(u,c)};return rm.Blur=o,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),rm}var nm={},l3;function uF(){if(l3)return nm;l3=1,Object.defineProperty(nm,"__esModule",{value:!0}),nm.Brighten=void 0;const t=Ht(),e=bn(),r=Wt(),n=function(i){let a=this.brightness()*255,s=i.data,o=s.length,l;for(l=0;l<o;l+=4)s[l]+=a,s[l+1]+=a,s[l+2]+=a};return nm.Brighten=n,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),nm}var im={},u3;function cF(){if(u3)return im;u3=1,Object.defineProperty(im,"__esModule",{value:!0}),im.Contrast=void 0;const t=Ht(),e=bn(),r=Wt(),n=function(i){const a=Math.pow((this.contrast()+100)/100,2);let s=i.data,o=s.length,l=150,u=150,c=150,f;for(f=0;f<o;f+=4)l=s[f],u=s[f+1],c=s[f+2],l/=255,l-=.5,l*=a,l+=.5,l*=255,u/=255,u-=.5,u*=a,u+=.5,u*=255,c/=255,c-=.5,c*=a,c+=.5,c*=255,l=l<0?0:l>255?255:l,u=u<0?0:u>255?255:u,c=c<0?0:c>255?255:c,s[f]=l,s[f+1]=u,s[f+2]=c};return im.Contrast=n,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),im}var am={},c3;function dF(){if(c3)return am;c3=1,Object.defineProperty(am,"__esModule",{value:!0}),am.Emboss=void 0;const t=Ht(),e=bn(),r=un(),n=Wt(),i=function(a){let s=this.embossStrength()*10,o=this.embossWhiteLevel()*255,l=this.embossDirection(),u=this.embossBlend(),c=0,f=0,m=a.data,g=a.width,y=a.height,b=g*4,w=y;switch(l){case"top-left":c=-1,f=-1;break;case"top":c=-1,f=0;break;case"top-right":c=-1,f=1;break;case"right":c=0,f=1;break;case"bottom-right":c=1,f=1;break;case"bottom":c=1,f=0;break;case"bottom-left":c=1,f=-1;break;case"left":c=0,f=-1;break;default:r.Util.error("Unknown emboss direction: "+l)}do{const N=(w-1)*b;let k=c;w+k<1&&(k=0),w+k>y&&(k=0);const C=(w-1+k)*g*4;let E=g;do{const P=N+(E-1)*4;let _=f;E+_<1&&(_=0),E+_>g&&(_=0);const A=C+(E-1+_)*4,I=m[P]-m[A],D=m[P+1]-m[A+1],L=m[P+2]-m[A+2];let U=I;const H=U>0?U:-U,M=D>0?D:-D,z=L>0?L:-L;if(M>H&&(U=D),z>H&&(U=L),U*=s,u){const O=m[P]+U,G=m[P+1]+U,W=m[P+2]+U;m[P]=O>255?255:O<0?0:O,m[P+1]=G>255?255:G<0?0:G,m[P+2]=W>255?255:W<0?0:W}else{let O=o-U;O<0?O=0:O>255&&(O=255),m[P]=m[P+1]=m[P+2]=O}}while(--E)}while(--w)};return am.Emboss=i,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",null,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,null,t.Factory.afterSetFilter),am}var sm={},d3;function fF(){if(d3)return sm;d3=1,Object.defineProperty(sm,"__esModule",{value:!0}),sm.Enhance=void 0;const t=Ht(),e=bn(),r=Wt();function n(a,s,o,l,u){let c=o-s,f=u-l,m;return c===0?l+f/2:f===0?l:(m=(a-s)/c,m=f*m+l,m)}const i=function(a){let s=a.data,o=s.length,l=s[0],u=l,c,f=s[1],m=f,g,y=s[2],b=y,w,N;const k=this.enhance();if(k===0)return;for(N=0;N<o;N+=4)c=s[N+0],c<l?l=c:c>u&&(u=c),g=s[N+1],g<f?f=g:g>m&&(m=g),w=s[N+2],w<y?y=w:w>b&&(b=w);u===l&&(u=255,l=0),m===f&&(m=255,f=0),b===y&&(b=255,y=0);let C,E,P,_,A,I,D,L,U;for(k>0?(E=u+k*(255-u),P=l-k*(l-0),A=m+k*(255-m),I=f-k*(f-0),L=b+k*(255-b),U=y-k*(y-0)):(C=(u+l)*.5,E=u+k*(u-C),P=l+k*(l-C),_=(m+f)*.5,A=m+k*(m-_),I=f+k*(f-_),D=(b+y)*.5,L=b+k*(b-D),U=y+k*(y-D)),N=0;N<o;N+=4)s[N+0]=n(s[N+0],l,u,P,E),s[N+1]=n(s[N+1],f,m,I,A),s[N+2]=n(s[N+2],y,b,U,L)};return sm.Enhance=i,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),sm}var om={},f3;function hF(){if(f3)return om;f3=1,Object.defineProperty(om,"__esModule",{value:!0}),om.Grayscale=void 0;const t=function(e){let r=e.data,n=r.length,i,a;for(i=0;i<n;i+=4)a=.34*r[i]+.5*r[i+1]+.16*r[i+2],r[i]=a,r[i+1]=a,r[i+2]=a};return om.Grayscale=t,om}var lm={},h3;function pF(){if(h3)return lm;h3=1,Object.defineProperty(lm,"__esModule",{value:!0}),lm.HSL=void 0;const t=Ht(),e=bn(),r=Wt();t.Factory.addGetterSetter(e.Node,"hue",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter);const n=function(i){let a=i.data,s=a.length,o=1,l=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,c=this.luminance()*127,f;const m=o*l*Math.cos(u*Math.PI/180),g=o*l*Math.sin(u*Math.PI/180),y=.299*o+.701*m+.167*g,b=.587*o-.587*m+.33*g,w=.114*o-.114*m-.497*g,N=.299*o-.299*m-.328*g,k=.587*o+.413*m+.035*g,C=.114*o-.114*m+.293*g,E=.299*o-.3*m+1.25*g,P=.587*o-.586*m-1.05*g,_=.114*o+.886*m-.2*g;let A,I,D,L;for(f=0;f<s;f+=4)A=a[f+0],I=a[f+1],D=a[f+2],L=a[f+3],a[f+0]=y*A+b*I+w*D+c,a[f+1]=N*A+k*I+C*D+c,a[f+2]=E*A+P*I+_*D+c,a[f+3]=L};return lm.HSL=n,lm}var um={},p3;function mF(){if(p3)return um;p3=1,Object.defineProperty(um,"__esModule",{value:!0}),um.HSV=void 0;const t=Ht(),e=bn(),r=Wt(),n=function(i){const a=i.data,s=a.length,o=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,c=o*l*Math.cos(u*Math.PI/180),f=o*l*Math.sin(u*Math.PI/180),m=.299*o+.701*c+.167*f,g=.587*o-.587*c+.33*f,y=.114*o-.114*c-.497*f,b=.299*o-.299*c-.328*f,w=.587*o+.413*c+.035*f,N=.114*o-.114*c+.293*f,k=.299*o-.3*c+1.25*f,C=.587*o-.586*c-1.05*f,E=.114*o+.886*c-.2*f;let P,_,A,I;for(let D=0;D<s;D+=4)P=a[D+0],_=a[D+1],A=a[D+2],I=a[D+3],a[D+0]=m*P+g*_+y*A,a[D+1]=b*P+w*_+N*A,a[D+2]=k*P+C*_+E*A,a[D+3]=I};return um.HSV=n,t.Factory.addGetterSetter(e.Node,"hue",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),um}var cm={},m3;function gF(){if(m3)return cm;m3=1,Object.defineProperty(cm,"__esModule",{value:!0}),cm.Invert=void 0;const t=function(e){let r=e.data,n=r.length,i;for(i=0;i<n;i+=4)r[i]=255-r[i],r[i+1]=255-r[i+1],r[i+2]=255-r[i+2]};return cm.Invert=t,cm}var dm={},g3;function vF(){if(g3)return dm;g3=1,Object.defineProperty(dm,"__esModule",{value:!0}),dm.Kaleidoscope=void 0;const t=Ht(),e=bn(),r=un(),n=Wt(),i=function(o,l,u){let c=o.data,f=l.data,m=o.width,g=o.height,y=u.polarCenterX||m/2,b=u.polarCenterY||g/2,w,N,k,C=0,E=0,P=0,_=0,A,I=Math.sqrt(y*y+b*b);N=m-y,k=g-b,A=Math.sqrt(N*N+k*k),I=A>I?A:I;let D=g,L=m,U,H,M=360/L*Math.PI/180,z,O;for(H=0;H<L;H+=1)for(z=Math.sin(H*M),O=Math.cos(H*M),U=0;U<D;U+=1)N=Math.floor(y+I*U/D*O),k=Math.floor(b+I*U/D*z),w=(k*m+N)*4,C=c[w+0],E=c[w+1],P=c[w+2],_=c[w+3],w=(H+U*m)*4,f[w+0]=C,f[w+1]=E,f[w+2]=P,f[w+3]=_},a=function(o,l,u){let c=o.data,f=l.data,m=o.width,g=o.height,y=u.polarCenterX||m/2,b=u.polarCenterY||g/2,w,N,k,C,E,P=0,_=0,A=0,I=0,D,L=Math.sqrt(y*y+b*b);N=m-y,k=g-b,D=Math.sqrt(N*N+k*k),L=D>L?D:L;let U=g,H=m,M,z,O=0,G,W;for(N=0;N<m;N+=1)for(k=0;k<g;k+=1)C=N-y,E=k-b,M=Math.sqrt(C*C+E*E)*U/L,z=(Math.atan2(E,C)*180/Math.PI+360+O)%360,z=z*H/360,G=Math.floor(z),W=Math.floor(M),w=(W*m+G)*4,P=c[w+0],_=c[w+1],A=c[w+2],I=c[w+3],w=(k*m+N)*4,f[w+0]=P,f[w+1]=_,f[w+2]=A,f[w+3]=I},s=function(o){const l=o.width,u=o.height;let c,f,m,g,y,b,w,N,k,C,E=Math.round(this.kaleidoscopePower());const P=Math.round(this.kaleidoscopeAngle()),_=Math.floor(l*(P%360)/360);if(E<1)return;const A=r.Util.createCanvasElement();A.width=l,A.height=u;const I=A.getContext("2d").getImageData(0,0,l,u);r.Util.releaseCanvas(A),i(o,I,{polarCenterX:l/2,polarCenterY:u/2});let D=l/Math.pow(2,E);for(;D<=8;)D=D*2,E-=1;D=Math.ceil(D);let L=D,U=0,H=L,M=1;for(_+D>l&&(U=L,H=0,M=-1),f=0;f<u;f+=1)for(c=U;c!==H;c+=M)m=Math.round(c+_)%l,k=(l*f+m)*4,y=I.data[k+0],b=I.data[k+1],w=I.data[k+2],N=I.data[k+3],C=(l*f+c)*4,I.data[C+0]=y,I.data[C+1]=b,I.data[C+2]=w,I.data[C+3]=N;for(f=0;f<u;f+=1)for(L=Math.floor(D),g=0;g<E;g+=1){for(c=0;c<L+1;c+=1)k=(l*f+c)*4,y=I.data[k+0],b=I.data[k+1],w=I.data[k+2],N=I.data[k+3],C=(l*f+L*2-c-1)*4,I.data[C+0]=y,I.data[C+1]=b,I.data[C+2]=w,I.data[C+3]=N;L*=2}a(I,o,{})};return dm.Kaleidoscope=s,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),dm}var fm={},v3;function yF(){if(v3)return fm;v3=1,Object.defineProperty(fm,"__esModule",{value:!0}),fm.Mask=void 0;const t=Ht(),e=bn(),r=Wt();function n(m,g,y){let b=(y*m.width+g)*4;const w=[];return w.push(m.data[b++],m.data[b++],m.data[b++],m.data[b++]),w}function i(m,g){return Math.sqrt(Math.pow(m[0]-g[0],2)+Math.pow(m[1]-g[1],2)+Math.pow(m[2]-g[2],2))}function a(m){const g=[0,0,0];for(let y=0;y<m.length;y++)g[0]+=m[y][0],g[1]+=m[y][1],g[2]+=m[y][2];return g[0]/=m.length,g[1]/=m.length,g[2]/=m.length,g}function s(m,g){const y=n(m,0,0),b=n(m,m.width-1,0),w=n(m,0,m.height-1),N=n(m,m.width-1,m.height-1),k=g||10;if(i(y,b)<k&&i(b,N)<k&&i(N,w)<k&&i(w,y)<k){const C=a([b,y,N,w]),E=[];for(let P=0;P<m.width*m.height;P++){const _=i(C,[m.data[P*4],m.data[P*4+1],m.data[P*4+2]]);E[P]=_<k?0:255}return E}}function o(m,g){for(let y=0;y<m.width*m.height;y++)m.data[4*y+3]=g[y]}function l(m,g,y){const b=[1,1,1,1,0,1,1,1,1],w=Math.round(Math.sqrt(b.length)),N=Math.floor(w/2),k=[];for(let C=0;C<y;C++)for(let E=0;E<g;E++){const P=C*g+E;let _=0;for(let A=0;A<w;A++)for(let I=0;I<w;I++){const D=C+A-N,L=E+I-N;if(D>=0&&D<y&&L>=0&&L<g){const U=D*g+L,H=b[A*w+I];_+=m[U]*H}}k[P]=_===2040?255:0}return k}function u(m,g,y){const b=[1,1,1,1,1,1,1,1,1],w=Math.round(Math.sqrt(b.length)),N=Math.floor(w/2),k=[];for(let C=0;C<y;C++)for(let E=0;E<g;E++){const P=C*g+E;let _=0;for(let A=0;A<w;A++)for(let I=0;I<w;I++){const D=C+A-N,L=E+I-N;if(D>=0&&D<y&&L>=0&&L<g){const U=D*g+L,H=b[A*w+I];_+=m[U]*H}}k[P]=_>=1020?255:0}return k}function c(m,g,y){const b=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],w=Math.round(Math.sqrt(b.length)),N=Math.floor(w/2),k=[];for(let C=0;C<y;C++)for(let E=0;E<g;E++){const P=C*g+E;let _=0;for(let A=0;A<w;A++)for(let I=0;I<w;I++){const D=C+A-N,L=E+I-N;if(D>=0&&D<y&&L>=0&&L<g){const U=D*g+L,H=b[A*w+I];_+=m[U]*H}}k[P]=_}return k}const f=function(m){let g=this.threshold(),y=s(m,g);return y&&(y=l(y,m.width,m.height),y=u(y,m.width,m.height),y=c(y,m.width,m.height),o(m,y)),m};return fm.Mask=f,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),fm}var hm={},y3;function xF(){if(y3)return hm;y3=1,Object.defineProperty(hm,"__esModule",{value:!0}),hm.Noise=void 0;const t=Ht(),e=bn(),r=Wt(),n=function(i){const a=this.noise()*255,s=i.data,o=s.length,l=a/2;for(let u=0;u<o;u+=4)s[u+0]+=l-2*l*Math.random(),s[u+1]+=l-2*l*Math.random(),s[u+2]+=l-2*l*Math.random()};return hm.Noise=n,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),hm}var pm={},x3;function bF(){if(x3)return pm;x3=1,Object.defineProperty(pm,"__esModule",{value:!0}),pm.Pixelate=void 0;const t=Ht(),e=un(),r=bn(),n=Wt(),i=function(a){let s=Math.ceil(this.pixelSize()),o=a.width,l=a.height,u,c,f,m,g,y,b,w=Math.ceil(o/s),N=Math.ceil(l/s),k,C,E,P,_,A,I,D=a.data;if(s<=0){e.Util.error("pixelSize value can not be <= 0");return}for(_=0;_<w;_+=1)for(A=0;A<N;A+=1){for(m=0,g=0,y=0,b=0,k=_*s,C=k+s,E=A*s,P=E+s,I=0,u=k;u<C;u+=1)if(!(u>=o))for(c=E;c<P;c+=1)c>=l||(f=(o*c+u)*4,m+=D[f+0],g+=D[f+1],y+=D[f+2],b+=D[f+3],I+=1);for(m=m/I,g=g/I,y=y/I,b=b/I,u=k;u<C;u+=1)if(!(u>=o))for(c=E;c<P;c+=1)c>=l||(f=(o*c+u)*4,D[f+0]=m,D[f+1]=g,D[f+2]=y,D[f+3]=b)}};return pm.Pixelate=i,t.Factory.addGetterSetter(r.Node,"pixelSize",8,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),pm}var mm={},b3;function wF(){if(b3)return mm;b3=1,Object.defineProperty(mm,"__esModule",{value:!0}),mm.Posterize=void 0;const t=Ht(),e=bn(),r=Wt(),n=function(i){let a=Math.round(this.levels()*254)+1,s=i.data,o=s.length,l=255/a,u;for(u=0;u<o;u+=1)s[u]=Math.floor(s[u]/l)*l};return mm.Posterize=n,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),mm}var gm={},w3;function SF(){if(w3)return gm;w3=1,Object.defineProperty(gm,"__esModule",{value:!0}),gm.RGB=void 0;const t=Ht(),e=bn(),r=Wt(),n=function(i){let a=i.data,s=a.length,o=this.red(),l=this.green(),u=this.blue(),c,f;for(c=0;c<s;c+=4)f=(.34*a[c]+.5*a[c+1]+.16*a[c+2])/255,a[c]=f*o,a[c+1]=f*l,a[c+2]=f*u,a[c+3]=a[c+3]};return gm.RGB=n,t.Factory.addGetterSetter(e.Node,"red",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)}),t.Factory.addGetterSetter(e.Node,"green",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)}),t.Factory.addGetterSetter(e.Node,"blue",0,r.RGBComponent,t.Factory.afterSetFilter),gm}var vm={},S3;function kF(){if(S3)return vm;S3=1,Object.defineProperty(vm,"__esModule",{value:!0}),vm.RGBA=void 0;const t=Ht(),e=bn(),r=Wt(),n=function(i){const a=i.data,s=a.length,o=this.red(),l=this.green(),u=this.blue(),c=this.alpha();for(let f=0;f<s;f+=4){const m=1-c;a[f]=o*c+a[f]*m,a[f+1]=l*c+a[f+1]*m,a[f+2]=u*c+a[f+2]*m}};return vm.RGBA=n,t.Factory.addGetterSetter(e.Node,"red",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)}),t.Factory.addGetterSetter(e.Node,"green",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)}),t.Factory.addGetterSetter(e.Node,"blue",0,r.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(i){return this._filterUpToDate=!1,i>1?1:i<0?0:i}),vm}var ym={},k3;function CF(){if(k3)return ym;k3=1,Object.defineProperty(ym,"__esModule",{value:!0}),ym.Sepia=void 0;const t=function(e){let r=e.data,n=r.length,i,a,s,o;for(i=0;i<n;i+=4)a=r[i+0],s=r[i+1],o=r[i+2],r[i+0]=Math.min(255,a*.393+s*.769+o*.189),r[i+1]=Math.min(255,a*.349+s*.686+o*.168),r[i+2]=Math.min(255,a*.272+s*.534+o*.131)};return ym.Sepia=t,ym}var xm={},C3;function NF(){if(C3)return xm;C3=1,Object.defineProperty(xm,"__esModule",{value:!0}),xm.Solarize=void 0;const t=function(e){const r=e.data,n=e.width,i=e.height,a=n*4;let s=i;do{const o=(s-1)*a;let l=n;do{const u=o+(l-1)*4;let c=r[u],f=r[u+1],m=r[u+2];c>127&&(c=255-c),f>127&&(f=255-f),m>127&&(m=255-m),r[u]=c,r[u+1]=f,r[u+2]=m}while(--l)}while(--s)};return xm.Solarize=t,xm}var bm={},N3;function EF(){if(N3)return bm;N3=1,Object.defineProperty(bm,"__esModule",{value:!0}),bm.Threshold=void 0;const t=Ht(),e=bn(),r=Wt(),n=function(i){const a=this.threshold()*255,s=i.data,o=s.length;for(let l=0;l<o;l+=1)s[l]=s[l]<a?0:255};return bm.Threshold=n,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),bm}var E3;function TF(){if(E3)return Dp;E3=1,Object.defineProperty(Dp,"__esModule",{value:!0}),Dp.Konva=void 0;const t=A2(),e=KB(),r=XB(),n=QB(),i=JB(),a=ZB(),s=eF(),o=lP(),l=XS(),u=uP(),c=tF(),f=rF(),m=nF(),g=iF(),y=cP(),b=aF(),w=sF(),N=oF(),k=lF(),C=uF(),E=cF(),P=dF(),_=fF(),A=hF(),I=pF(),D=mF(),L=gF(),U=vF(),H=yF(),M=xF(),z=bF(),O=wF(),G=SF(),W=kF(),$=CF(),X=NF(),Q=EF();return Dp.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:r.Arrow,Circle:n.Circle,Ellipse:i.Ellipse,Image:a.Image,Label:s.Label,Tag:s.Tag,Line:o.Line,Path:l.Path,Rect:u.Rect,RegularPolygon:c.RegularPolygon,Ring:f.Ring,Sprite:m.Sprite,Star:g.Star,Text:y.Text,TextPath:b.TextPath,Transformer:w.Transformer,Wedge:N.Wedge,Filters:{Blur:k.Blur,Brighten:C.Brighten,Contrast:E.Contrast,Emboss:P.Emboss,Enhance:_.Enhance,Grayscale:A.Grayscale,HSL:I.HSL,HSV:D.HSV,Invert:L.Invert,Kaleidoscope:U.Kaleidoscope,Mask:H.Mask,Noise:M.Noise,Pixelate:z.Pixelate,Posterize:O.Posterize,RGB:G.RGB,RGBA:W.RGBA,Sepia:$.Sepia,Solarize:X.Solarize,Threshold:Q.Threshold}}),Dp}var jF=F0.exports,T3;function PF(){if(T3)return F0.exports;T3=1,Object.defineProperty(jF,"__esModule",{value:!0});const t=TF();return F0.exports=t.Konva,F0.exports}PF();var f0={exports:{}},j3;function MF(){return j3||(j3=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var r=A2();Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=A2();t.exports=n.Konva})(f0,f0.exports)),f0.exports}var _F=MF();const ug=gh(_F);var yw={exports:{}};var xw,P3;function AF(){return P3||(P3=1,xw=function(e){var r={},n=vh(),i=vS(),a=Object.assign;function s(v){for(var x="https://reactjs.org/docs/error-decoder.html?invariant="+v,T=1;T<arguments.length;T++)x+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+v+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),y=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),E=Symbol.for("react.offscreen"),P=Symbol.iterator;function _(v){return v===null||typeof v!="object"?null:(v=P&&v[P]||v["@@iterator"],typeof v=="function"?v:null)}function A(v){if(v==null)return null;if(typeof v=="function")return v.displayName||v.name||null;if(typeof v=="string")return v;switch(v){case c:return"Fragment";case u:return"Portal";case m:return"Profiler";case f:return"StrictMode";case w:return"Suspense";case N:return"SuspenseList"}if(typeof v=="object")switch(v.$$typeof){case y:return(v.displayName||"Context")+".Consumer";case g:return(v._context.displayName||"Context")+".Provider";case b:var x=v.render;return v=v.displayName,v||(v=x.displayName||x.name||"",v=v!==""?"ForwardRef("+v+")":"ForwardRef"),v;case k:return x=v.displayName||null,x!==null?x:A(v.type)||"Memo";case C:x=v._payload,v=v._init;try{return A(v(x))}catch{}}return null}function I(v){var x=v.type;switch(v.tag){case 24:return"Cache";case 9:return(x.displayName||"Context")+".Consumer";case 10:return(x._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return v=x.render,v=v.displayName||v.name||"",x.displayName||(v!==""?"ForwardRef("+v+")":"ForwardRef");case 7:return"Fragment";case 5:return x;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return A(x);case 8:return x===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x}return null}function D(v){var x=v,T=v;if(v.alternate)for(;x.return;)x=x.return;else{v=x;do x=v,(x.flags&4098)!==0&&(T=x.return),v=x.return;while(v)}return x.tag===3?T:null}function L(v){if(D(v)!==v)throw Error(s(188))}function U(v){var x=v.alternate;if(!x){if(x=D(v),x===null)throw Error(s(188));return x!==v?null:v}for(var T=v,R=x;;){var F=T.return;if(F===null)break;var K=F.alternate;if(K===null){if(R=F.return,R!==null){T=R;continue}break}if(F.child===K.child){for(K=F.child;K;){if(K===T)return L(F),v;if(K===R)return L(F),x;K=K.sibling}throw Error(s(188))}if(T.return!==R.return)T=F,R=K;else{for(var ne=!1,xe=F.child;xe;){if(xe===T){ne=!0,T=F,R=K;break}if(xe===R){ne=!0,R=F,T=K;break}xe=xe.sibling}if(!ne){for(xe=K.child;xe;){if(xe===T){ne=!0,T=K,R=F;break}if(xe===R){ne=!0,R=K,T=F;break}xe=xe.sibling}if(!ne)throw Error(s(189))}}if(T.alternate!==R)throw Error(s(190))}if(T.tag!==3)throw Error(s(188));return T.stateNode.current===T?v:x}function H(v){return v=U(v),v!==null?M(v):null}function M(v){if(v.tag===5||v.tag===6)return v;for(v=v.child;v!==null;){var x=M(v);if(x!==null)return x;v=v.sibling}return null}function z(v){if(v.tag===5||v.tag===6)return v;for(v=v.child;v!==null;){if(v.tag!==4){var x=z(v);if(x!==null)return x}v=v.sibling}return null}var O=Array.isArray,G=e.getPublicInstance,W=e.getRootHostContext,$=e.getChildHostContext,X=e.prepareForCommit,Q=e.resetAfterCommit,V=e.createInstance,Y=e.appendInitialChild,Z=e.finalizeInitialChildren,ie=e.prepareUpdate,ce=e.shouldSetTextContent,he=e.createTextInstance,ee=e.scheduleTimeout,le=e.cancelTimeout,te=e.noTimeout,ae=e.isPrimaryRenderer,oe=e.supportsMutation,fe=e.supportsPersistence,pe=e.supportsHydration,Te=e.getInstanceFromNode,Oe=e.preparePortalMount,_e=e.getCurrentEventPriority,Ae=e.detachDeletedInstance,He=e.supportsMicrotasks,tt=e.scheduleMicrotask,Ie=e.supportsTestSelectors,ye=e.findFiberRoot,Pe=e.getBoundingRect,Be=e.getTextContent,Ge=e.isHiddenSubtree,et=e.matchAccessibilityRole,mt=e.setFocusIfFocusable,gt=e.setupIntersectionObserver,bt=e.appendChild,_t=e.appendChildToContainer,ot=e.commitTextUpdate,Ye=e.commitMount,De=e.commitUpdate,re=e.insertBefore,ue=e.insertInContainerBefore,ge=e.removeChild,be=e.removeChildFromContainer,Ce=e.resetTextContent,Le=e.hideInstance,Re=e.hideTextInstance,Ze=e.unhideInstance,Je=e.unhideTextInstance,dt=e.clearContainer,Nt=e.cloneInstance,Et=e.createContainerChildSet,it=e.appendChildToContainerChildSet,jt=e.finalizeContainerChildren,Pt=e.replaceContainerChildren,ar=e.cloneHiddenInstance,Xt=e.cloneHiddenTextInstance,$r=e.canHydrateInstance,Er=e.canHydrateTextInstance,Tr=e.canHydrateSuspenseInstance,Fr=e.isSuspenseInstancePending,xr=e.isSuspenseInstanceFallback,Fi=e.getSuspenseInstanceFallbackErrorDetails,br=e.registerSuspenseInstanceRetry,Gn=e.getNextHydratableSibling,Ta=e.getFirstHydratableChild,zs=e.getFirstHydratableChildWithinContainer,wl=e.getFirstHydratableChildWithinSuspenseInstance,oi=e.hydrateInstance,An=e.hydrateTextInstance,cn=e.hydrateSuspenseInstance,Hn=e.getNextHydratableInstanceAfterSuspenseInstance,Vs=e.commitHydratedContainer,li=e.commitHydratedSuspenseInstance,ic=e.clearSuspenseBoundary,Td=e.clearSuspenseBoundaryFromContainer,Th=e.shouldDeleteUnhydratedTailInstances,jh=e.didNotMatchHydratedContainerTextInstance,Dr=e.didNotMatchHydratedTextInstance,ac;function gs(v){if(ac===void 0)try{throw Error()}catch(T){var x=T.stack.trim().match(/\n( *(at )?)/);ac=x&&x[1]||""}return`
`+ac+v}var Sl=!1;function ia(v,x){if(!v||Sl)return"";Sl=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(x)if(x=function(){throw Error()},Object.defineProperty(x.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(x,[])}catch(We){var R=We}Reflect.construct(v,[],x)}else{try{x.call()}catch(We){R=We}v.call(x.prototype)}else{try{throw Error()}catch(We){R=We}v()}}catch(We){if(We&&R&&typeof We.stack=="string"){for(var F=We.stack.split(`
`),K=R.stack.split(`
`),ne=F.length-1,xe=K.length-1;1<=ne&&0<=xe&&F[ne]!==K[xe];)xe--;for(;1<=ne&&0<=xe;ne--,xe--)if(F[ne]!==K[xe]){if(ne!==1||xe!==1)do if(ne--,xe--,0>xe||F[ne]!==K[xe]){var je=`
`+F[ne].replace(" at new "," at ");return v.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",v.displayName)),je}while(1<=ne&&0<=xe);break}}}finally{Sl=!1,Error.prepareStackTrace=T}return(v=v?v.displayName||v.name:"")?gs(v):""}var sc=Object.prototype.hasOwnProperty,vs=[],aa=-1;function Jr(v){return{current:v}}function ur(v){0>aa||(v.current=vs[aa],vs[aa]=null,aa--)}function Tt(v,x){aa++,vs[aa]=v.current,v.current=x}var sa={},dn=Jr(sa),Zr=Jr(!1),zr=sa;function ja(v,x){var T=v.type.contextTypes;if(!T)return sa;var R=v.stateNode;if(R&&R.__reactInternalMemoizedUnmaskedChildContext===x)return R.__reactInternalMemoizedMaskedChildContext;var F={},K;for(K in T)F[K]=x[K];return R&&(v=v.stateNode,v.__reactInternalMemoizedUnmaskedChildContext=x,v.__reactInternalMemoizedMaskedChildContext=F),F}function fn(v){return v=v.childContextTypes,v!=null}function ys(){ur(Zr),ur(dn)}function Hg(v,x,T){if(dn.current!==sa)throw Error(s(168));Tt(dn,x),Tt(Zr,T)}function qg(v,x,T){var R=v.stateNode;if(x=x.childContextTypes,typeof R.getChildContext!="function")return T;R=R.getChildContext();for(var F in R)if(!(F in x))throw Error(s(108,I(v)||"Unknown",F));return a({},T,R)}function kl(v){return v=(v=v.stateNode)&&v.__reactInternalMemoizedMergedChildContext||sa,zr=dn.current,Tt(dn,v),Tt(Zr,Zr.current),!0}function Ph(v,x,T){var R=v.stateNode;if(!R)throw Error(s(169));T?(v=qg(v,x,zr),R.__reactInternalMemoizedMergedChildContext=v,ur(Zr),ur(dn),Tt(dn,v)):ur(Zr),Tt(Zr,T)}var zi=Math.clz32?Math.clz32:Mh,oc=Math.log,Ux=Math.LN2;function Mh(v){return v>>>=0,v===0?32:31-(oc(v)/Ux|0)|0}var Yt=64,lc=4194304;function Cl(v){switch(v&-v){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return v&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return v}}function Nl(v,x){var T=v.pendingLanes;if(T===0)return 0;var R=0,F=v.suspendedLanes,K=v.pingedLanes,ne=T&268435455;if(ne!==0){var xe=ne&~F;xe!==0?R=Cl(xe):(K&=ne,K!==0&&(R=Cl(K)))}else ne=T&~F,ne!==0?R=Cl(ne):K!==0&&(R=Cl(K));if(R===0)return 0;if(x!==0&&x!==R&&(x&F)===0&&(F=R&-R,K=x&-x,F>=K||F===16&&(K&4194240)!==0))return x;if((R&4)!==0&&(R|=T&16),x=v.entangledLanes,x!==0)for(v=v.entanglements,x&=R;0<x;)T=31-zi(x),F=1<<T,R|=v[T],x&=~F;return R}function Wg(v,x){switch(v){case 1:case 2:case 4:return x+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $g(v,x){for(var T=v.suspendedLanes,R=v.pingedLanes,F=v.expirationTimes,K=v.pendingLanes;0<K;){var ne=31-zi(K),xe=1<<ne,je=F[ne];je===-1?((xe&T)===0||(xe&R)!==0)&&(F[ne]=Wg(xe,x)):je<=x&&(v.expiredLanes|=xe),K&=~xe}}function jd(v){return v=v.pendingLanes&-1073741825,v!==0?v:v&1073741824?1073741824:0}function Pd(){var v=Yt;return Yt<<=1,(Yt&4194240)===0&&(Yt=64),v}function El(v){for(var x=[],T=0;31>T;T++)x.push(v);return x}function oa(v,x,T){v.pendingLanes|=x,x!==536870912&&(v.suspendedLanes=0,v.pingedLanes=0),v=v.eventTimes,x=31-zi(x),v[x]=T}function Us(v,x){var T=v.pendingLanes&~x;v.pendingLanes=x,v.suspendedLanes=0,v.pingedLanes=0,v.expiredLanes&=x,v.mutableReadLanes&=x,v.entangledLanes&=x,x=v.entanglements;var R=v.eventTimes;for(v=v.expirationTimes;0<T;){var F=31-zi(T),K=1<<F;x[F]=0,R[F]=-1,v[F]=-1,T&=~K}}function Ga(v,x){var T=v.entangledLanes|=x;for(v=v.entanglements;T;){var R=31-zi(T),F=1<<R;F&x|v[R]&x&&(v[R]|=x),T&=~F}}var Ut=0;function Tl(v){return v&=-v,1<v?4<v?(v&268435455)!==0?16:536870912:4:1}var Ha=i.unstable_scheduleCallback,Kg=i.unstable_cancelCallback,Yg=i.unstable_shouldYield,uc=i.unstable_requestPaint,kn=i.unstable_now,Md=i.unstable_ImmediatePriority,_d=i.unstable_UserBlockingPriority,Ad=i.unstable_NormalPriority,Gx=i.unstable_IdlePriority,Gs=null,Ti=null;function jl(v){if(Ti&&typeof Ti.onCommitFiberRoot=="function")try{Ti.onCommitFiberRoot(Gs,v,void 0,(v.current.flags&128)===128)}catch{}}function Rd(v,x){return v===x&&(v!==0||1/v===1/x)||v!==v&&x!==x}var Pa=typeof Object.is=="function"?Object.is:Rd,xs=null,Pl=!1,Ml=!1;function Dd(v){xs===null?xs=[v]:xs.push(v)}function Xg(v){Pl=!0,Dd(v)}function Rn(){if(!Ml&&xs!==null){Ml=!0;var v=0,x=Ut;try{var T=xs;for(Ut=1;v<T.length;v++){var R=T[v];do R=R(!0);while(R!==null)}xs=null,Pl=!1}catch(F){throw xs!==null&&(xs=xs.slice(v+1)),Ha(Md,Rn),F}finally{Ut=x,Ml=!1}}return null}var Hs=[],bs=0,cc=null,To=0,ui=[],Vi=0,hn=null,ji=1,Ma="";function _a(v,x){Hs[bs++]=To,Hs[bs++]=cc,cc=v,To=x}function Qg(v,x,T){ui[Vi++]=ji,ui[Vi++]=Ma,ui[Vi++]=hn,hn=v;var R=ji;v=Ma;var F=32-zi(R)-1;R&=~(1<<F),T+=1;var K=32-zi(x)+F;if(30<K){var ne=F-F%5;K=(R&(1<<ne)-1).toString(32),R>>=ne,F-=ne,ji=1<<32-zi(x)+F|T<<F|R,Ma=K+v}else ji=1<<K|T<<F|R,Ma=v}function dc(v){v.return!==null&&(_a(v,1),Qg(v,1,0))}function fc(v){for(;v===cc;)cc=Hs[--bs],Hs[bs]=null,To=Hs[--bs],Hs[bs]=null;for(;v===hn;)hn=ui[--Vi],ui[Vi]=null,Ma=ui[--Vi],ui[Vi]=null,ji=ui[--Vi],ui[Vi]=null}var Dn=null,ci=null,wr=!1,hc=!1,Aa=null;function Jg(v,x){var T=Qi(5,null,null,0);T.elementType="DELETED",T.stateNode=x,T.return=v,x=v.deletions,x===null?(v.deletions=[T],v.flags|=16):x.push(T)}function Od(v,x){switch(v.tag){case 5:return x=$r(x,v.type,v.pendingProps),x!==null?(v.stateNode=x,Dn=v,ci=Ta(x),!0):!1;case 6:return x=Er(x,v.pendingProps),x!==null?(v.stateNode=x,Dn=v,ci=null,!0):!1;case 13:if(x=Tr(x),x!==null){var T=hn!==null?{id:ji,overflow:Ma}:null;return v.memoizedState={dehydrated:x,treeContext:T,retryLane:1073741824},T=Qi(18,null,null,0),T.stateNode=x,T.return=v,v.child=T,Dn=v,ci=null,!0}return!1;default:return!1}}function _h(v){return(v.mode&1)!==0&&(v.flags&128)===0}function Ah(v){if(wr){var x=ci;if(x){var T=x;if(!Od(v,x)){if(_h(v))throw Error(s(418));x=Gn(T);var R=Dn;x&&Od(v,x)?Jg(R,T):(v.flags=v.flags&-4097|2,wr=!1,Dn=v)}}else{if(_h(v))throw Error(s(418));v.flags=v.flags&-4097|2,wr=!1,Dn=v}}}function Zg(v){for(v=v.return;v!==null&&v.tag!==5&&v.tag!==3&&v.tag!==13;)v=v.return;Dn=v}function Id(v){if(!pe||v!==Dn)return!1;if(!wr)return Zg(v),wr=!0,!1;if(v.tag!==3&&(v.tag!==5||Th(v.type)&&!ce(v.type,v.memoizedProps))){var x=ci;if(x){if(_h(v))throw ev(),Error(s(418));for(;x;)Jg(v,x),x=Gn(x)}}if(Zg(v),v.tag===13){if(!pe)throw Error(s(316));if(v=v.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(s(317));ci=Hn(v)}else ci=Dn?Gn(v.stateNode):null;return!0}function ev(){for(var v=ci;v;)v=Gn(v)}function jo(){pe&&(ci=Dn=null,hc=wr=!1)}function Rh(v){Aa===null?Aa=[v]:Aa.push(v)}var Hx=o.ReactCurrentBatchConfig;function Ld(v,x){if(Pa(v,x))return!0;if(typeof v!="object"||v===null||typeof x!="object"||x===null)return!1;var T=Object.keys(v),R=Object.keys(x);if(T.length!==R.length)return!1;for(R=0;R<T.length;R++){var F=T[R];if(!sc.call(x,F)||!Pa(v[F],x[F]))return!1}return!0}function qx(v){switch(v.tag){case 5:return gs(v.type);case 16:return gs("Lazy");case 13:return gs("Suspense");case 19:return gs("SuspenseList");case 0:case 2:case 15:return v=ia(v.type,!1),v;case 11:return v=ia(v.type.render,!1),v;case 1:return v=ia(v.type,!0),v;default:return""}}function Po(v,x,T){if(v=T.ref,v!==null&&typeof v!="function"&&typeof v!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(s(309));var R=T.stateNode}if(!R)throw Error(s(147,v));var F=R,K=""+v;return x!==null&&x.ref!==null&&typeof x.ref=="function"&&x.ref._stringRef===K?x.ref:(x=function(ne){var xe=F.refs;ne===null?delete xe[K]:xe[K]=ne},x._stringRef=K,x)}if(typeof v!="string")throw Error(s(284));if(!T._owner)throw Error(s(290,v))}return v}function Bd(v,x){throw v=Object.prototype.toString.call(x),Error(s(31,v==="[object Object]"?"object with keys {"+Object.keys(x).join(", ")+"}":v))}function tv(v){var x=v._init;return x(v._payload)}function rv(v){function x(Ne,we){if(v){var Me=Ne.deletions;Me===null?(Ne.deletions=[we],Ne.flags|=16):Me.push(we)}}function T(Ne,we){if(!v)return null;for(;we!==null;)x(Ne,we),we=we.sibling;return null}function R(Ne,we){for(Ne=new Map;we!==null;)we.key!==null?Ne.set(we.key,we):Ne.set(we.index,we),we=we.sibling;return Ne}function F(Ne,we){return Ne=lo(Ne,we),Ne.index=0,Ne.sibling=null,Ne}function K(Ne,we,Me){return Ne.index=Me,v?(Me=Ne.alternate,Me!==null?(Me=Me.index,Me<we?(Ne.flags|=2,we):Me):(Ne.flags|=2,we)):(Ne.flags|=1048576,we)}function ne(Ne){return v&&Ne.alternate===null&&(Ne.flags|=2),Ne}function xe(Ne,we,Me,nt){return we===null||we.tag!==6?(we=tu(Me,Ne.mode,nt),we.return=Ne,we):(we=F(we,Me),we.return=Ne,we)}function je(Ne,we,Me,nt){var vt=Me.type;return vt===c?lt(Ne,we,Me.props.children,nt,Me.key):we!==null&&(we.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===C&&tv(vt)===we.type)?(nt=F(we,Me.props),nt.ref=Po(Ne,we,Me),nt.return=Ne,nt):(nt=vf(Me.type,Me.key,Me.props,null,Ne.mode,nt),nt.ref=Po(Ne,we,Me),nt.return=Ne,nt)}function We(Ne,we,Me,nt){return we===null||we.tag!==4||we.stateNode.containerInfo!==Me.containerInfo||we.stateNode.implementation!==Me.implementation?(we=yf(Me,Ne.mode,nt),we.return=Ne,we):(we=F(we,Me.children||[]),we.return=Ne,we)}function lt(Ne,we,Me,nt,vt){return we===null||we.tag!==7?(we=Ln(Me,Ne.mode,nt,vt),we.return=Ne,we):(we=F(we,Me),we.return=Ne,we)}function At(Ne,we,Me){if(typeof we=="string"&&we!==""||typeof we=="number")return we=tu(""+we,Ne.mode,Me),we.return=Ne,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case l:return Me=vf(we.type,we.key,we.props,null,Ne.mode,Me),Me.ref=Po(Ne,null,we),Me.return=Ne,Me;case u:return we=yf(we,Ne.mode,Me),we.return=Ne,we;case C:var nt=we._init;return At(Ne,nt(we._payload),Me)}if(O(we)||_(we))return we=Ln(we,Ne.mode,Me,null),we.return=Ne,we;Bd(Ne,we)}return null}function rt(Ne,we,Me,nt){var vt=we!==null?we.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number")return vt!==null?null:xe(Ne,we,""+Me,nt);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case l:return Me.key===vt?je(Ne,we,Me,nt):null;case u:return Me.key===vt?We(Ne,we,Me,nt):null;case C:return vt=Me._init,rt(Ne,we,vt(Me._payload),nt)}if(O(Me)||_(Me))return vt!==null?null:lt(Ne,we,Me,nt,null);Bd(Ne,Me)}return null}function gr(Ne,we,Me,nt,vt){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return Ne=Ne.get(Me)||null,xe(we,Ne,""+nt,vt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case l:return Ne=Ne.get(nt.key===null?Me:nt.key)||null,je(we,Ne,nt,vt);case u:return Ne=Ne.get(nt.key===null?Me:nt.key)||null,We(we,Ne,nt,vt);case C:var It=nt._init;return gr(Ne,we,Me,It(nt._payload),vt)}if(O(nt)||_(nt))return Ne=Ne.get(Me)||null,lt(we,Ne,nt,vt,null);Bd(we,nt)}return null}function nr(Ne,we,Me,nt){for(var vt=null,It=null,Rt=we,$t=we=0,yn=null;Rt!==null&&$t<Me.length;$t++){Rt.index>$t?(yn=Rt,Rt=null):yn=Rt.sibling;var qt=rt(Ne,Rt,Me[$t],nt);if(qt===null){Rt===null&&(Rt=yn);break}v&&Rt&&qt.alternate===null&&x(Ne,Rt),we=K(qt,we,$t),It===null?vt=qt:It.sibling=qt,It=qt,Rt=yn}if($t===Me.length)return T(Ne,Rt),wr&&_a(Ne,$t),vt;if(Rt===null){for(;$t<Me.length;$t++)Rt=At(Ne,Me[$t],nt),Rt!==null&&(we=K(Rt,we,$t),It===null?vt=Rt:It.sibling=Rt,It=Rt);return wr&&_a(Ne,$t),vt}for(Rt=R(Ne,Rt);$t<Me.length;$t++)yn=gr(Rt,Ne,$t,Me[$t],nt),yn!==null&&(v&&yn.alternate!==null&&Rt.delete(yn.key===null?$t:yn.key),we=K(yn,we,$t),It===null?vt=yn:It.sibling=yn,It=yn);return v&&Rt.forEach(function(Xn){return x(Ne,Xn)}),wr&&_a(Ne,$t),vt}function gi(Ne,we,Me,nt){var vt=_(Me);if(typeof vt!="function")throw Error(s(150));if(Me=vt.call(Me),Me==null)throw Error(s(151));for(var It=vt=null,Rt=we,$t=we=0,yn=null,qt=Me.next();Rt!==null&&!qt.done;$t++,qt=Me.next()){Rt.index>$t?(yn=Rt,Rt=null):yn=Rt.sibling;var Xn=rt(Ne,Rt,qt.value,nt);if(Xn===null){Rt===null&&(Rt=yn);break}v&&Rt&&Xn.alternate===null&&x(Ne,Rt),we=K(Xn,we,$t),It===null?vt=Xn:It.sibling=Xn,It=Xn,Rt=yn}if(qt.done)return T(Ne,Rt),wr&&_a(Ne,$t),vt;if(Rt===null){for(;!qt.done;$t++,qt=Me.next())qt=At(Ne,qt.value,nt),qt!==null&&(we=K(qt,we,$t),It===null?vt=qt:It.sibling=qt,It=qt);return wr&&_a(Ne,$t),vt}for(Rt=R(Ne,Rt);!qt.done;$t++,qt=Me.next())qt=gr(Rt,Ne,$t,qt.value,nt),qt!==null&&(v&&qt.alternate!==null&&Rt.delete(qt.key===null?$t:qt.key),we=K(qt,we,$t),It===null?vt=qt:It.sibling=qt,It=qt);return v&&Rt.forEach(function(Xx){return x(Ne,Xx)}),wr&&_a(Ne,$t),vt}function Za(Ne,we,Me,nt){if(typeof Me=="object"&&Me!==null&&Me.type===c&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case l:e:{for(var vt=Me.key,It=we;It!==null;){if(It.key===vt){if(vt=Me.type,vt===c){if(It.tag===7){T(Ne,It.sibling),we=F(It,Me.props.children),we.return=Ne,Ne=we;break e}}else if(It.elementType===vt||typeof vt=="object"&&vt!==null&&vt.$$typeof===C&&tv(vt)===It.type){T(Ne,It.sibling),we=F(It,Me.props),we.ref=Po(Ne,It,Me),we.return=Ne,Ne=we;break e}T(Ne,It);break}else x(Ne,It);It=It.sibling}Me.type===c?(we=Ln(Me.props.children,Ne.mode,nt,Me.key),we.return=Ne,Ne=we):(nt=vf(Me.type,Me.key,Me.props,null,Ne.mode,nt),nt.ref=Po(Ne,we,Me),nt.return=Ne,Ne=nt)}return ne(Ne);case u:e:{for(It=Me.key;we!==null;){if(we.key===It)if(we.tag===4&&we.stateNode.containerInfo===Me.containerInfo&&we.stateNode.implementation===Me.implementation){T(Ne,we.sibling),we=F(we,Me.children||[]),we.return=Ne,Ne=we;break e}else{T(Ne,we);break}else x(Ne,we);we=we.sibling}we=yf(Me,Ne.mode,nt),we.return=Ne,Ne=we}return ne(Ne);case C:return It=Me._init,Za(Ne,we,It(Me._payload),nt)}if(O(Me))return nr(Ne,we,Me,nt);if(_(Me))return gi(Ne,we,Me,nt);Bd(Ne,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"?(Me=""+Me,we!==null&&we.tag===6?(T(Ne,we.sibling),we=F(we,Me),we.return=Ne,Ne=we):(T(Ne,we),we=tu(Me,Ne.mode,nt),we.return=Ne,Ne=we),ne(Ne)):T(Ne,we)}return Za}var Mo=rv(!0),nv=rv(!1),Fd=Jr(null),zd=null,_l=null,Dh=null;function Oh(){Dh=_l=zd=null}function iv(v,x,T){ae?(Tt(Fd,x._currentValue),x._currentValue=T):(Tt(Fd,x._currentValue2),x._currentValue2=T)}function pc(v){var x=Fd.current;ur(Fd),ae?v._currentValue=x:v._currentValue2=x}function _o(v,x,T){for(;v!==null;){var R=v.alternate;if((v.childLanes&x)!==x?(v.childLanes|=x,R!==null&&(R.childLanes|=x)):R!==null&&(R.childLanes&x)!==x&&(R.childLanes|=x),v===T)break;v=v.return}}function Al(v,x){zd=v,Dh=_l=null,v=v.dependencies,v!==null&&v.firstContext!==null&&((v.lanes&x)!==0&&(mn=!0),v.firstContext=null)}function Ui(v){var x=ae?v._currentValue:v._currentValue2;if(Dh!==v)if(v={context:v,memoizedValue:x,next:null},_l===null){if(zd===null)throw Error(s(308));_l=v,zd.dependencies={lanes:0,firstContext:v}}else _l=_l.next=v;return x}var qs=null;function Vd(v){qs===null?qs=[v]:qs.push(v)}function Ih(v,x,T,R){var F=x.interleaved;return F===null?(T.next=T,Vd(x)):(T.next=F.next,F.next=T),x.interleaved=T,Ra(v,R)}function Ra(v,x){v.lanes|=x;var T=v.alternate;for(T!==null&&(T.lanes|=x),T=v,v=v.return;v!==null;)v.childLanes|=x,T=v.alternate,T!==null&&(T.childLanes|=x),T=v,v=v.return;return T.tag===3?T.stateNode:null}var Gi=!1;function Lh(v){v.updateQueue={baseState:v.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function av(v,x){v=v.updateQueue,x.updateQueue===v&&(x.updateQueue={baseState:v.baseState,firstBaseUpdate:v.firstBaseUpdate,lastBaseUpdate:v.lastBaseUpdate,shared:v.shared,effects:v.effects})}function ws(v,x){return{eventTime:v,lane:x,tag:0,payload:null,callback:null,next:null}}function Ss(v,x,T){var R=v.updateQueue;if(R===null)return null;if(R=R.shared,(Ot&2)!==0){var F=R.pending;return F===null?x.next=x:(x.next=F.next,F.next=x),R.pending=x,Ra(v,T)}return F=R.interleaved,F===null?(x.next=x,Vd(R)):(x.next=F.next,F.next=x),R.interleaved=x,Ra(v,T)}function mc(v,x,T){if(x=x.updateQueue,x!==null&&(x=x.shared,(T&4194240)!==0)){var R=x.lanes;R&=v.pendingLanes,T|=R,x.lanes=T,Ga(v,T)}}function Rl(v,x){var T=v.updateQueue,R=v.alternate;if(R!==null&&(R=R.updateQueue,T===R)){var F=null,K=null;if(T=T.firstBaseUpdate,T!==null){do{var ne={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};K===null?F=K=ne:K=K.next=ne,T=T.next}while(T!==null);K===null?F=K=x:K=K.next=x}else F=K=x;T={baseState:R.baseState,firstBaseUpdate:F,lastBaseUpdate:K,shared:R.shared,effects:R.effects},v.updateQueue=T;return}v=T.lastBaseUpdate,v===null?T.firstBaseUpdate=x:v.next=x,T.lastBaseUpdate=x}function Ws(v,x,T,R){var F=v.updateQueue;Gi=!1;var K=F.firstBaseUpdate,ne=F.lastBaseUpdate,xe=F.shared.pending;if(xe!==null){F.shared.pending=null;var je=xe,We=je.next;je.next=null,ne===null?K=We:ne.next=We,ne=je;var lt=v.alternate;lt!==null&&(lt=lt.updateQueue,xe=lt.lastBaseUpdate,xe!==ne&&(xe===null?lt.firstBaseUpdate=We:xe.next=We,lt.lastBaseUpdate=je))}if(K!==null){var At=F.baseState;ne=0,lt=We=je=null,xe=K;do{var rt=xe.lane,gr=xe.eventTime;if((R&rt)===rt){lt!==null&&(lt=lt.next={eventTime:gr,lane:0,tag:xe.tag,payload:xe.payload,callback:xe.callback,next:null});e:{var nr=v,gi=xe;switch(rt=x,gr=T,gi.tag){case 1:if(nr=gi.payload,typeof nr=="function"){At=nr.call(gr,At,rt);break e}At=nr;break e;case 3:nr.flags=nr.flags&-65537|128;case 0:if(nr=gi.payload,rt=typeof nr=="function"?nr.call(gr,At,rt):nr,rt==null)break e;At=a({},At,rt);break e;case 2:Gi=!0}}xe.callback!==null&&xe.lane!==0&&(v.flags|=64,rt=F.effects,rt===null?F.effects=[xe]:rt.push(xe))}else gr={eventTime:gr,lane:rt,tag:xe.tag,payload:xe.payload,callback:xe.callback,next:null},lt===null?(We=lt=gr,je=At):lt=lt.next=gr,ne|=rt;if(xe=xe.next,xe===null){if(xe=F.shared.pending,xe===null)break;rt=xe,xe=rt.next,rt.next=null,F.lastBaseUpdate=rt,F.shared.pending=null}}while(!0);if(lt===null&&(je=At),F.baseState=je,F.firstBaseUpdate=We,F.lastBaseUpdate=lt,x=F.shared.interleaved,x!==null){F=x;do ne|=F.lane,F=F.next;while(F!==x)}else K===null&&(F.shared.lanes=0);Ts|=ne,v.lanes=ne,v.memoizedState=At}}function sv(v,x,T){if(v=x.effects,x.effects=null,v!==null)for(x=0;x<v.length;x++){var R=v[x],F=R.callback;if(F!==null){if(R.callback=null,R=T,typeof F!="function")throw Error(s(191,F));F.call(R)}}}var $s={},la=Jr($s),Dl=Jr($s),Ks=Jr($s);function ua(v){if(v===$s)throw Error(s(174));return v}function Ud(v,x){Tt(Ks,x),Tt(Dl,v),Tt(la,$s),v=W(x),ur(la),Tt(la,v)}function Ao(){ur(la),ur(Dl),ur(Ks)}function Bh(v){var x=ua(Ks.current),T=ua(la.current);x=$(T,v.type,x),T!==x&&(Tt(Dl,v),Tt(la,x))}function Fh(v){Dl.current===v&&(ur(la),ur(Dl))}var Or=Jr(0);function Gd(v){for(var x=v;x!==null;){if(x.tag===13){var T=x.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||Fr(T)||xr(T)))return x}else if(x.tag===19&&x.memoizedProps.revealOrder!==void 0){if((x.flags&128)!==0)return x}else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===v)break;for(;x.sibling===null;){if(x.return===null||x.return===v)return null;x=x.return}x.sibling.return=x.return,x=x.sibling}return null}var zh=[];function Vh(){for(var v=0;v<zh.length;v++){var x=zh[v];ae?x._workInProgressVersionPrimary=null:x._workInProgressVersionSecondary=null}zh.length=0}var Pi=o.ReactCurrentDispatcher,Ro=o.ReactCurrentBatchConfig,Ys=0,jr=null,en=null,pn=null,Ol=!1,gc=!1,vc=0,Il=0;function Cn(){throw Error(s(321))}function Do(v,x){if(x===null)return!1;for(var T=0;T<x.length&&T<v.length;T++)if(!Pa(v[T],x[T]))return!1;return!0}function yc(v,x,T,R,F,K){if(Ys=K,jr=x,x.memoizedState=null,x.updateQueue=null,x.lanes=0,Pi.current=v===null||v.memoizedState===null?Qh:Jh,v=T(R,F),gc){K=0;do{if(gc=!1,vc=0,25<=K)throw Error(s(301));K+=1,pn=en=null,x.updateQueue=null,Pi.current=Zh,v=T(R,F)}while(gc)}if(Pi.current=Fo,x=en!==null&&en.next!==null,Ys=0,pn=en=jr=null,Ol=!1,x)throw Error(s(300));return v}function Hd(){var v=vc!==0;return vc=0,v}function Hi(){var v={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?jr.memoizedState=pn=v:pn=pn.next=v,pn}function On(){if(en===null){var v=jr.alternate;v=v!==null?v.memoizedState:null}else v=en.next;var x=pn===null?jr.memoizedState:pn.next;if(x!==null)pn=x,en=v;else{if(v===null)throw Error(s(310));en=v,v={memoizedState:en.memoizedState,baseState:en.baseState,baseQueue:en.baseQueue,queue:en.queue,next:null},pn===null?jr.memoizedState=pn=v:pn=pn.next=v}return pn}function Oo(v,x){return typeof x=="function"?x(v):x}function qd(v){var x=On(),T=x.queue;if(T===null)throw Error(s(311));T.lastRenderedReducer=v;var R=en,F=R.baseQueue,K=T.pending;if(K!==null){if(F!==null){var ne=F.next;F.next=K.next,K.next=ne}R.baseQueue=F=K,T.pending=null}if(F!==null){K=F.next,R=R.baseState;var xe=ne=null,je=null,We=K;do{var lt=We.lane;if((Ys&lt)===lt)je!==null&&(je=je.next={lane:0,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null}),R=We.hasEagerState?We.eagerState:v(R,We.action);else{var At={lane:lt,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null};je===null?(xe=je=At,ne=R):je=je.next=At,jr.lanes|=lt,Ts|=lt}We=We.next}while(We!==null&&We!==K);je===null?ne=R:je.next=xe,Pa(R,x.memoizedState)||(mn=!0),x.memoizedState=R,x.baseState=ne,x.baseQueue=je,T.lastRenderedState=R}if(v=T.interleaved,v!==null){F=v;do K=F.lane,jr.lanes|=K,Ts|=K,F=F.next;while(F!==v)}else F===null&&(T.lanes=0);return[x.memoizedState,T.dispatch]}function Ll(v){var x=On(),T=x.queue;if(T===null)throw Error(s(311));T.lastRenderedReducer=v;var R=T.dispatch,F=T.pending,K=x.memoizedState;if(F!==null){T.pending=null;var ne=F=F.next;do K=v(K,ne.action),ne=ne.next;while(ne!==F);Pa(K,x.memoizedState)||(mn=!0),x.memoizedState=K,x.baseQueue===null&&(x.baseState=K),T.lastRenderedState=K}return[K,R]}function Uh(){}function Gh(v,x){var T=jr,R=On(),F=x(),K=!Pa(R.memoizedState,F);if(K&&(R.memoizedState=F,mn=!0),R=R.queue,Kd(Wh.bind(null,T,R,v),[v]),R.getSnapshot!==x||K||pn!==null&&pn.memoizedState.tag&1){if(T.flags|=2048,Io(9,qh.bind(null,T,R,F,x),void 0,null),dr===null)throw Error(s(349));(Ys&30)!==0||Hh(T,x,F)}return F}function Hh(v,x,T){v.flags|=16384,v={getSnapshot:x,value:T},x=jr.updateQueue,x===null?(x={lastEffect:null,stores:null},jr.updateQueue=x,x.stores=[v]):(T=x.stores,T===null?x.stores=[v]:T.push(v))}function qh(v,x,T,R){x.value=T,x.getSnapshot=R,$h(x)&&ks(v)}function Wh(v,x,T){return T(function(){$h(x)&&ks(v)})}function $h(v){var x=v.getSnapshot;v=v.value;try{var T=x();return!Pa(v,T)}catch{return!0}}function ks(v){var x=Ra(v,1);x!==null&&Kn(x,v,1,-1)}function Wd(v){var x=Hi();return typeof v=="function"&&(v=v()),x.memoizedState=x.baseState=v,v={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oo,lastRenderedState:v},x.queue=v,v=v.dispatch=Wx.bind(null,jr,v),[x.memoizedState,v]}function Io(v,x,T,R){return v={tag:v,create:x,destroy:T,deps:R,next:null},x=jr.updateQueue,x===null?(x={lastEffect:null,stores:null},jr.updateQueue=x,x.lastEffect=v.next=v):(T=x.lastEffect,T===null?x.lastEffect=v.next=v:(R=T.next,T.next=v,v.next=R,x.lastEffect=v)),v}function ov(){return On().memoizedState}function $d(v,x,T,R){var F=Hi();jr.flags|=v,F.memoizedState=Io(1|x,T,void 0,R===void 0?null:R)}function Xs(v,x,T,R){var F=On();R=R===void 0?null:R;var K=void 0;if(en!==null){var ne=en.memoizedState;if(K=ne.destroy,R!==null&&Do(R,ne.deps)){F.memoizedState=Io(x,T,K,R);return}}jr.flags|=v,F.memoizedState=Io(1|x,T,K,R)}function lv(v,x){return $d(8390656,8,v,x)}function Kd(v,x){return Xs(2048,8,v,x)}function Kh(v,x){return Xs(4,2,v,x)}function hr(v,x){return Xs(4,4,v,x)}function Yd(v,x){if(typeof x=="function")return v=v(),x(v),function(){x(null)};if(x!=null)return v=v(),x.current=v,function(){x.current=null}}function xc(v,x,T){return T=T!=null?T.concat([v]):null,Xs(4,4,Yd.bind(null,x,v),T)}function Lo(){}function Yh(v,x){var T=On();x=x===void 0?null:x;var R=T.memoizedState;return R!==null&&x!==null&&Do(x,R[1])?R[0]:(T.memoizedState=[v,x],v)}function Xd(v,x){var T=On();x=x===void 0?null:x;var R=T.memoizedState;return R!==null&&x!==null&&Do(x,R[1])?R[0]:(v=v(),T.memoizedState=[v,x],v)}function Bl(v,x,T){return(Ys&21)===0?(v.baseState&&(v.baseState=!1,mn=!0),v.memoizedState=T):(Pa(T,x)||(T=Pd(),jr.lanes|=T,Ts|=T,v.baseState=!0),x)}function Qd(v,x){var T=Ut;Ut=T!==0&&4>T?T:4,v(!0);var R=Ro.transition;Ro.transition={};try{v(!1),x()}finally{Ut=T,Ro.transition=R}}function Bo(){return On().memoizedState}function uv(v,x,T){var R=vn(v);if(T={lane:R,action:T,hasEagerState:!1,eagerState:null,next:null},cv(v))Xh(x,T);else if(T=Ih(v,x,T,R),T!==null){var F=Sr();Kn(T,v,R,F),bc(T,x,R)}}function Wx(v,x,T){var R=vn(v),F={lane:R,action:T,hasEagerState:!1,eagerState:null,next:null};if(cv(v))Xh(x,F);else{var K=v.alternate;if(v.lanes===0&&(K===null||K.lanes===0)&&(K=x.lastRenderedReducer,K!==null))try{var ne=x.lastRenderedState,xe=K(ne,T);if(F.hasEagerState=!0,F.eagerState=xe,Pa(xe,ne)){var je=x.interleaved;je===null?(F.next=F,Vd(x)):(F.next=je.next,je.next=F),x.interleaved=F;return}}catch{}T=Ih(v,x,F,R),T!==null&&(F=Sr(),Kn(T,v,R,F),bc(T,x,R))}}function cv(v){var x=v.alternate;return v===jr||x!==null&&x===jr}function Xh(v,x){gc=Ol=!0;var T=v.pending;T===null?x.next=x:(x.next=T.next,T.next=x),v.pending=x}function bc(v,x,T){if((T&4194240)!==0){var R=x.lanes;R&=v.pendingLanes,T|=R,x.lanes=T,Ga(v,T)}}var Fo={readContext:Ui,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useInsertionEffect:Cn,useLayoutEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useMutableSource:Cn,useSyncExternalStore:Cn,useId:Cn,unstable_isNewReconciler:!1},Qh={readContext:Ui,useCallback:function(v,x){return Hi().memoizedState=[v,x===void 0?null:x],v},useContext:Ui,useEffect:lv,useImperativeHandle:function(v,x,T){return T=T!=null?T.concat([v]):null,$d(4194308,4,Yd.bind(null,x,v),T)},useLayoutEffect:function(v,x){return $d(4194308,4,v,x)},useInsertionEffect:function(v,x){return $d(4,2,v,x)},useMemo:function(v,x){var T=Hi();return x=x===void 0?null:x,v=v(),T.memoizedState=[v,x],v},useReducer:function(v,x,T){var R=Hi();return x=T!==void 0?T(x):x,R.memoizedState=R.baseState=x,v={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:v,lastRenderedState:x},R.queue=v,v=v.dispatch=uv.bind(null,jr,v),[R.memoizedState,v]},useRef:function(v){var x=Hi();return v={current:v},x.memoizedState=v},useState:Wd,useDebugValue:Lo,useDeferredValue:function(v){return Hi().memoizedState=v},useTransition:function(){var v=Wd(!1),x=v[0];return v=Qd.bind(null,v[1]),Hi().memoizedState=v,[x,v]},useMutableSource:function(){},useSyncExternalStore:function(v,x,T){var R=jr,F=Hi();if(wr){if(T===void 0)throw Error(s(407));T=T()}else{if(T=x(),dr===null)throw Error(s(349));(Ys&30)!==0||Hh(R,x,T)}F.memoizedState=T;var K={value:T,getSnapshot:x};return F.queue=K,lv(Wh.bind(null,R,K,v),[v]),R.flags|=2048,Io(9,qh.bind(null,R,K,T,x),void 0,null),T},useId:function(){var v=Hi(),x=dr.identifierPrefix;if(wr){var T=Ma,R=ji;T=(R&~(1<<32-zi(R)-1)).toString(32)+T,x=":"+x+"R"+T,T=vc++,0<T&&(x+="H"+T.toString(32)),x+=":"}else T=Il++,x=":"+x+"r"+T.toString(32)+":";return v.memoizedState=x},unstable_isNewReconciler:!1},Jh={readContext:Ui,useCallback:Yh,useContext:Ui,useEffect:Kd,useImperativeHandle:xc,useInsertionEffect:Kh,useLayoutEffect:hr,useMemo:Xd,useReducer:qd,useRef:ov,useState:function(){return qd(Oo)},useDebugValue:Lo,useDeferredValue:function(v){var x=On();return Bl(x,en.memoizedState,v)},useTransition:function(){var v=qd(Oo)[0],x=On().memoizedState;return[v,x]},useMutableSource:Uh,useSyncExternalStore:Gh,useId:Bo,unstable_isNewReconciler:!1},Zh={readContext:Ui,useCallback:Yh,useContext:Ui,useEffect:Kd,useImperativeHandle:xc,useInsertionEffect:Kh,useLayoutEffect:hr,useMemo:Xd,useReducer:Ll,useRef:ov,useState:function(){return Ll(Oo)},useDebugValue:Lo,useDeferredValue:function(v){var x=On();return en===null?x.memoizedState=v:Bl(x,en.memoizedState,v)},useTransition:function(){var v=Ll(Oo)[0],x=On().memoizedState;return[v,x]},useMutableSource:Uh,useSyncExternalStore:Gh,useId:Bo,unstable_isNewReconciler:!1};function qi(v,x){if(v&&v.defaultProps){x=a({},x),v=v.defaultProps;for(var T in v)x[T]===void 0&&(x[T]=v[T]);return x}return x}function ep(v,x,T,R){x=v.memoizedState,T=T(R,x),T=T==null?x:a({},x,T),v.memoizedState=T,v.lanes===0&&(v.updateQueue.baseState=T)}var wc={isMounted:function(v){return(v=v._reactInternals)?D(v)===v:!1},enqueueSetState:function(v,x,T){v=v._reactInternals;var R=Sr(),F=vn(v),K=ws(R,F);K.payload=x,T!=null&&(K.callback=T),x=Ss(v,K,F),x!==null&&(Kn(x,v,F,R),mc(x,v,F))},enqueueReplaceState:function(v,x,T){v=v._reactInternals;var R=Sr(),F=vn(v),K=ws(R,F);K.tag=1,K.payload=x,T!=null&&(K.callback=T),x=Ss(v,K,F),x!==null&&(Kn(x,v,F,R),mc(x,v,F))},enqueueForceUpdate:function(v,x){v=v._reactInternals;var T=Sr(),R=vn(v),F=ws(T,R);F.tag=2,x!=null&&(F.callback=x),x=Ss(v,F,R),x!==null&&(Kn(x,v,R,T),mc(x,v,R))}};function dv(v,x,T,R,F,K,ne){return v=v.stateNode,typeof v.shouldComponentUpdate=="function"?v.shouldComponentUpdate(R,K,ne):x.prototype&&x.prototype.isPureReactComponent?!Ld(T,R)||!Ld(F,K):!0}function fv(v,x,T){var R=!1,F=sa,K=x.contextType;return typeof K=="object"&&K!==null?K=Ui(K):(F=fn(x)?zr:dn.current,R=x.contextTypes,K=(R=R!=null)?ja(v,F):sa),x=new x(T,K),v.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=wc,v.stateNode=x,x._reactInternals=v,R&&(v=v.stateNode,v.__reactInternalMemoizedUnmaskedChildContext=F,v.__reactInternalMemoizedMaskedChildContext=K),x}function Jd(v,x,T,R){v=x.state,typeof x.componentWillReceiveProps=="function"&&x.componentWillReceiveProps(T,R),typeof x.UNSAFE_componentWillReceiveProps=="function"&&x.UNSAFE_componentWillReceiveProps(T,R),x.state!==v&&wc.enqueueReplaceState(x,x.state,null)}function qa(v,x,T,R){var F=v.stateNode;F.props=T,F.state=v.memoizedState,F.refs={},Lh(v);var K=x.contextType;typeof K=="object"&&K!==null?F.context=Ui(K):(K=fn(x)?zr:dn.current,F.context=ja(v,K)),F.state=v.memoizedState,K=x.getDerivedStateFromProps,typeof K=="function"&&(ep(v,x,K,T),F.state=v.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof F.getSnapshotBeforeUpdate=="function"||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(x=F.state,typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount(),x!==F.state&&wc.enqueueReplaceState(F,F.state,null),Ws(v,T,F,R),F.state=v.memoizedState),typeof F.componentDidMount=="function"&&(v.flags|=4194308)}function zo(v,x){try{var T="",R=x;do T+=qx(R),R=R.return;while(R);var F=T}catch(K){F=`
Error generating stack: `+K.message+`
`+K.stack}return{value:v,source:x,stack:F,digest:null}}function Qs(v,x,T){return{value:v,source:null,stack:T??null,digest:x??null}}function ca(v,x){try{console.error(x.value)}catch(T){setTimeout(function(){throw T})}}var Sc=typeof WeakMap=="function"?WeakMap:Map;function Wa(v,x,T){T=ws(-1,T),T.tag=3,T.payload={element:null};var R=x.value;return T.callback=function(){Ur||(Ur=!0,tn=R),ca(v,x)},T}function Zd(v,x,T){T=ws(-1,T),T.tag=3;var R=v.type.getDerivedStateFromError;if(typeof R=="function"){var F=x.value;T.payload=function(){return R(F)},T.callback=function(){ca(v,x)}}var K=v.stateNode;return K!==null&&typeof K.componentDidCatch=="function"&&(T.callback=function(){ca(v,x),typeof R!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var ne=x.stack;this.componentDidCatch(x.value,{componentStack:ne!==null?ne:""})}),T}function hv(v,x,T){var R=v.pingCache;if(R===null){R=v.pingCache=new Sc;var F=new Set;R.set(x,F)}else F=R.get(x),F===void 0&&(F=new Set,R.set(x,F));F.has(T)||(F.add(T),v=wv.bind(null,v,x,T),x.then(v,v))}function pv(v){do{var x;if((x=v.tag===13)&&(x=v.memoizedState,x=x!==null?x.dehydrated!==null:!0),x)return v;v=v.return}while(v!==null);return null}function Js(v,x,T,R,F){return(v.mode&1)===0?(v===x?v.flags|=65536:(v.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(x=ws(-1,1),x.tag=2,Ss(T,x,1))),T.lanes|=1),v):(v.flags|=65536,v.lanes=F,v)}var kc=o.ReactCurrentOwner,mn=!1;function Nn(v,x,T,R){x.child=v===null?nv(x,null,T,R):Mo(x,v.child,T,R)}function ef(v,x,T,R,F){T=T.render;var K=x.ref;return Al(x,F),R=yc(v,x,T,R,K,F),T=Hd(),v!==null&&!mn?(x.updateQueue=v.updateQueue,x.flags&=-2053,v.lanes&=~F,Ns(v,x,F)):(wr&&T&&dc(x),x.flags|=1,Nn(v,x,R,F),x.child)}function Vo(v,x,T,R,F){if(v===null){var K=T.type;return typeof K=="function"&&!Zl(K)&&K.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(x.tag=15,x.type=K,Cs(v,x,K,R,F)):(v=vf(T.type,null,R,x,x.mode,F),v.ref=x.ref,v.return=x,x.child=v)}if(K=v.child,(v.lanes&F)===0){var ne=K.memoizedProps;if(T=T.compare,T=T!==null?T:Ld,T(ne,R)&&v.ref===x.ref)return Ns(v,x,F)}return x.flags|=1,v=lo(K,R),v.ref=x.ref,v.return=x,x.child=v}function Cs(v,x,T,R,F){if(v!==null){var K=v.memoizedProps;if(Ld(K,R)&&v.ref===x.ref)if(mn=!1,x.pendingProps=R=K,(v.lanes&F)!==0)(v.flags&131072)!==0&&(mn=!0);else return x.lanes=v.lanes,Ns(v,x,F)}return $a(v,x,T,R,F)}function pr(v,x,T){var R=x.pendingProps,F=R.children,K=v!==null?v.memoizedState:null;if(R.mode==="hidden")if((x.mode&1)===0)x.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(io,gn),gn|=T;else{if((T&1073741824)===0)return v=K!==null?K.baseLanes|T:T,x.lanes=x.childLanes=1073741824,x.memoizedState={baseLanes:v,cachePool:null,transitions:null},x.updateQueue=null,Tt(io,gn),gn|=v,null;x.memoizedState={baseLanes:0,cachePool:null,transitions:null},R=K!==null?K.baseLanes:T,Tt(io,gn),gn|=R}else K!==null?(R=K.baseLanes|T,x.memoizedState=null):R=T,Tt(io,gn),gn|=R;return Nn(v,x,F,T),x.child}function cr(v,x){var T=x.ref;(v===null&&T!==null||v!==null&&v.ref!==T)&&(x.flags|=512,x.flags|=2097152)}function $a(v,x,T,R,F){var K=fn(T)?zr:dn.current;return K=ja(x,K),Al(x,F),T=yc(v,x,T,R,K,F),R=Hd(),v!==null&&!mn?(x.updateQueue=v.updateQueue,x.flags&=-2053,v.lanes&=~F,Ns(v,x,F)):(wr&&R&&dc(x),x.flags|=1,Nn(v,x,T,F),x.child)}function In(v,x,T,R,F){if(fn(T)){var K=!0;kl(x)}else K=!1;if(Al(x,F),x.stateNode===null)Cc(v,x),fv(x,T,R),qa(x,T,R,F),R=!0;else if(v===null){var ne=x.stateNode,xe=x.memoizedProps;ne.props=xe;var je=ne.context,We=T.contextType;typeof We=="object"&&We!==null?We=Ui(We):(We=fn(T)?zr:dn.current,We=ja(x,We));var lt=T.getDerivedStateFromProps,At=typeof lt=="function"||typeof ne.getSnapshotBeforeUpdate=="function";At||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(xe!==R||je!==We)&&Jd(x,ne,R,We),Gi=!1;var rt=x.memoizedState;ne.state=rt,Ws(x,R,ne,F),je=x.memoizedState,xe!==R||rt!==je||Zr.current||Gi?(typeof lt=="function"&&(ep(x,T,lt,R),je=x.memoizedState),(xe=Gi||dv(x,T,xe,R,rt,je,We))?(At||typeof ne.UNSAFE_componentWillMount!="function"&&typeof ne.componentWillMount!="function"||(typeof ne.componentWillMount=="function"&&ne.componentWillMount(),typeof ne.UNSAFE_componentWillMount=="function"&&ne.UNSAFE_componentWillMount()),typeof ne.componentDidMount=="function"&&(x.flags|=4194308)):(typeof ne.componentDidMount=="function"&&(x.flags|=4194308),x.memoizedProps=R,x.memoizedState=je),ne.props=R,ne.state=je,ne.context=We,R=xe):(typeof ne.componentDidMount=="function"&&(x.flags|=4194308),R=!1)}else{ne=x.stateNode,av(v,x),xe=x.memoizedProps,We=x.type===x.elementType?xe:qi(x.type,xe),ne.props=We,At=x.pendingProps,rt=ne.context,je=T.contextType,typeof je=="object"&&je!==null?je=Ui(je):(je=fn(T)?zr:dn.current,je=ja(x,je));var gr=T.getDerivedStateFromProps;(lt=typeof gr=="function"||typeof ne.getSnapshotBeforeUpdate=="function")||typeof ne.UNSAFE_componentWillReceiveProps!="function"&&typeof ne.componentWillReceiveProps!="function"||(xe!==At||rt!==je)&&Jd(x,ne,R,je),Gi=!1,rt=x.memoizedState,ne.state=rt,Ws(x,R,ne,F);var nr=x.memoizedState;xe!==At||rt!==nr||Zr.current||Gi?(typeof gr=="function"&&(ep(x,T,gr,R),nr=x.memoizedState),(We=Gi||dv(x,T,We,R,rt,nr,je)||!1)?(lt||typeof ne.UNSAFE_componentWillUpdate!="function"&&typeof ne.componentWillUpdate!="function"||(typeof ne.componentWillUpdate=="function"&&ne.componentWillUpdate(R,nr,je),typeof ne.UNSAFE_componentWillUpdate=="function"&&ne.UNSAFE_componentWillUpdate(R,nr,je)),typeof ne.componentDidUpdate=="function"&&(x.flags|=4),typeof ne.getSnapshotBeforeUpdate=="function"&&(x.flags|=1024)):(typeof ne.componentDidUpdate!="function"||xe===v.memoizedProps&&rt===v.memoizedState||(x.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||xe===v.memoizedProps&&rt===v.memoizedState||(x.flags|=1024),x.memoizedProps=R,x.memoizedState=nr),ne.props=R,ne.state=nr,ne.context=je,R=We):(typeof ne.componentDidUpdate!="function"||xe===v.memoizedProps&&rt===v.memoizedState||(x.flags|=4),typeof ne.getSnapshotBeforeUpdate!="function"||xe===v.memoizedProps&&rt===v.memoizedState||(x.flags|=1024),R=!1)}return qn(v,x,T,R,K,F)}function qn(v,x,T,R,F,K){cr(v,x);var ne=(x.flags&128)!==0;if(!R&&!ne)return F&&Ph(x,T,!1),Ns(v,x,K);R=x.stateNode,kc.current=x;var xe=ne&&typeof T.getDerivedStateFromError!="function"?null:R.render();return x.flags|=1,v!==null&&ne?(x.child=Mo(x,v.child,null,K),x.child=Mo(x,null,xe,K)):Nn(v,x,xe,K),x.memoizedState=R.state,F&&Ph(x,T,!0),x.child}function Zs(v){var x=v.stateNode;x.pendingContext?Hg(v,x.pendingContext,x.pendingContext!==x.context):x.context&&Hg(v,x.context,!1),Ud(v,x.containerInfo)}function Uo(v,x,T,R,F){return jo(),Rh(F),x.flags|=256,Nn(v,x,T,R),x.child}var Wn={dehydrated:null,treeContext:null,retryLane:0};function Fl(v){return{baseLanes:v,cachePool:null,transitions:null}}function tp(v,x,T){var R=x.pendingProps,F=Or.current,K=!1,ne=(x.flags&128)!==0,xe;if((xe=ne)||(xe=v!==null&&v.memoizedState===null?!1:(F&2)!==0),xe?(K=!0,x.flags&=-129):(v===null||v.memoizedState!==null)&&(F|=1),Tt(Or,F&1),v===null)return Ah(x),v=x.memoizedState,v!==null&&(v=v.dehydrated,v!==null)?((x.mode&1)===0?x.lanes=1:xr(v)?x.lanes=8:x.lanes=1073741824,null):(ne=R.children,v=R.fallback,K?(R=x.mode,K=x.child,ne={mode:"hidden",children:ne},(R&1)===0&&K!==null?(K.childLanes=0,K.pendingProps=ne):K=eu(ne,R,0,null),v=Ln(v,R,T,null),K.return=x,v.return=x,K.sibling=v,x.child=K,x.child.memoizedState=Fl(T),x.memoizedState=Wn,v):tf(x,ne));if(F=v.memoizedState,F!==null&&(xe=F.dehydrated,xe!==null))return mv(v,x,ne,R,xe,F,T);if(K){K=R.fallback,ne=x.mode,F=v.child,xe=F.sibling;var je={mode:"hidden",children:R.children};return(ne&1)===0&&x.child!==F?(R=x.child,R.childLanes=0,R.pendingProps=je,x.deletions=null):(R=lo(F,je),R.subtreeFlags=F.subtreeFlags&14680064),xe!==null?K=lo(xe,K):(K=Ln(K,ne,T,null),K.flags|=2),K.return=x,R.return=x,R.sibling=K,x.child=R,R=K,K=x.child,ne=v.child.memoizedState,ne=ne===null?Fl(T):{baseLanes:ne.baseLanes|T,cachePool:null,transitions:ne.transitions},K.memoizedState=ne,K.childLanes=v.childLanes&~T,x.memoizedState=Wn,R}return K=v.child,v=K.sibling,R=lo(K,{mode:"visible",children:R.children}),(x.mode&1)===0&&(R.lanes=T),R.return=x,R.sibling=null,v!==null&&(T=x.deletions,T===null?(x.deletions=[v],x.flags|=16):T.push(v)),x.child=R,x.memoizedState=null,R}function tf(v,x){return x=eu({mode:"visible",children:x},v.mode,0,null),x.return=v,v.child=x}function Go(v,x,T,R){return R!==null&&Rh(R),Mo(x,v.child,null,T),v=tf(x,x.pendingProps.children),v.flags|=2,x.memoizedState=null,v}function mv(v,x,T,R,F,K,ne){if(T)return x.flags&256?(x.flags&=-257,R=Qs(Error(s(422))),Go(v,x,ne,R)):x.memoizedState!==null?(x.child=v.child,x.flags|=128,null):(K=R.fallback,F=x.mode,R=eu({mode:"visible",children:R.children},F,0,null),K=Ln(K,F,ne,null),K.flags|=2,R.return=x,K.return=x,R.sibling=K,x.child=R,(x.mode&1)!==0&&Mo(x,v.child,null,ne),x.child.memoizedState=Fl(ne),x.memoizedState=Wn,K);if((x.mode&1)===0)return Go(v,x,ne,null);if(xr(F))return R=Fi(F).digest,K=Error(s(419)),R=Qs(K,R,void 0),Go(v,x,ne,R);if(T=(ne&v.childLanes)!==0,mn||T){if(R=dr,R!==null){switch(ne&-ne){case 4:F=2;break;case 16:F=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:F=32;break;case 536870912:F=268435456;break;default:F=0}F=(F&(R.suspendedLanes|ne))!==0?0:F,F!==0&&F!==K.retryLane&&(K.retryLane=F,Ra(v,F),Kn(R,v,F,-1))}return Jl(),R=Qs(Error(s(421))),Go(v,x,ne,R)}return Fr(F)?(x.flags|=128,x.child=v.child,x=kv.bind(null,v),br(F,x),null):(v=K.treeContext,pe&&(ci=wl(F),Dn=x,wr=!0,Aa=null,hc=!1,v!==null&&(ui[Vi++]=ji,ui[Vi++]=Ma,ui[Vi++]=hn,ji=v.id,Ma=v.overflow,hn=x)),x=tf(x,R.children),x.flags|=4096,x)}function Ka(v,x,T){v.lanes|=x;var R=v.alternate;R!==null&&(R.lanes|=x),_o(v.return,x,T)}function zl(v,x,T,R,F){var K=v.memoizedState;K===null?v.memoizedState={isBackwards:x,rendering:null,renderingStartTime:0,last:R,tail:T,tailMode:F}:(K.isBackwards=x,K.rendering=null,K.renderingStartTime=0,K.last=R,K.tail=T,K.tailMode=F)}function rf(v,x,T){var R=x.pendingProps,F=R.revealOrder,K=R.tail;if(Nn(v,x,R.children,T),R=Or.current,(R&2)!==0)R=R&1|2,x.flags|=128;else{if(v!==null&&(v.flags&128)!==0)e:for(v=x.child;v!==null;){if(v.tag===13)v.memoizedState!==null&&Ka(v,T,x);else if(v.tag===19)Ka(v,T,x);else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===x)break e;for(;v.sibling===null;){if(v.return===null||v.return===x)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}R&=1}if(Tt(Or,R),(x.mode&1)===0)x.memoizedState=null;else switch(F){case"forwards":for(T=x.child,F=null;T!==null;)v=T.alternate,v!==null&&Gd(v)===null&&(F=T),T=T.sibling;T=F,T===null?(F=x.child,x.child=null):(F=T.sibling,T.sibling=null),zl(x,!1,F,T,K);break;case"backwards":for(T=null,F=x.child,x.child=null;F!==null;){if(v=F.alternate,v!==null&&Gd(v)===null){x.child=F;break}v=F.sibling,F.sibling=T,T=F,F=v}zl(x,!0,T,null,K);break;case"together":zl(x,!1,null,null,void 0);break;default:x.memoizedState=null}return x.child}function Cc(v,x){(x.mode&1)===0&&v!==null&&(v.alternate=null,x.alternate=null,x.flags|=2)}function Ns(v,x,T){if(v!==null&&(x.dependencies=v.dependencies),Ts|=x.lanes,(T&x.childLanes)===0)return null;if(v!==null&&x.child!==v.child)throw Error(s(153));if(x.child!==null){for(v=x.child,T=lo(v,v.pendingProps),x.child=T,T.return=x;v.sibling!==null;)v=v.sibling,T=T.sibling=lo(v,v.pendingProps),T.return=x;T.sibling=null}return x.child}function eo(v,x,T){switch(x.tag){case 3:Zs(x),jo();break;case 5:Bh(x);break;case 1:fn(x.type)&&kl(x);break;case 4:Ud(x,x.stateNode.containerInfo);break;case 10:iv(x,x.type._context,x.memoizedProps.value);break;case 13:var R=x.memoizedState;if(R!==null)return R.dehydrated!==null?(Tt(Or,Or.current&1),x.flags|=128,null):(T&x.child.childLanes)!==0?tp(v,x,T):(Tt(Or,Or.current&1),v=Ns(v,x,T),v!==null?v.sibling:null);Tt(Or,Or.current&1);break;case 19:if(R=(T&x.childLanes)!==0,(v.flags&128)!==0){if(R)return rf(v,x,T);x.flags|=128}var F=x.memoizedState;if(F!==null&&(F.rendering=null,F.tail=null,F.lastEffect=null),Tt(Or,Or.current),R)break;return null;case 22:case 23:return x.lanes=0,pr(v,x,T)}return Ns(v,x,T)}function di(v){v.flags|=4}function Ho(v,x){if(v!==null&&v.child===x.child)return!0;if((x.flags&16)!==0)return!1;for(v=x.child;v!==null;){if((v.flags&12854)!==0||(v.subtreeFlags&12854)!==0)return!1;v=v.sibling}return!0}var to,ro,fi,hi;if(oe)to=function(v,x){for(var T=x.child;T!==null;){if(T.tag===5||T.tag===6)Y(v,T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===x)break;for(;T.sibling===null;){if(T.return===null||T.return===x)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},ro=function(){},fi=function(v,x,T,R,F){if(v=v.memoizedProps,v!==R){var K=x.stateNode,ne=ua(la.current);T=ie(K,T,v,R,F,ne),(x.updateQueue=T)&&di(x)}},hi=function(v,x,T,R){T!==R&&di(x)};else if(fe){to=function(v,x,T,R){for(var F=x.child;F!==null;){if(F.tag===5){var K=F.stateNode;T&&R&&(K=ar(K,F.type,F.memoizedProps,F)),Y(v,K)}else if(F.tag===6)K=F.stateNode,T&&R&&(K=Xt(K,F.memoizedProps,F)),Y(v,K);else if(F.tag!==4){if(F.tag===22&&F.memoizedState!==null)K=F.child,K!==null&&(K.return=F),to(v,F,!0,!0);else if(F.child!==null){F.child.return=F,F=F.child;continue}}if(F===x)break;for(;F.sibling===null;){if(F.return===null||F.return===x)return;F=F.return}F.sibling.return=F.return,F=F.sibling}};var no=function(v,x,T,R){for(var F=x.child;F!==null;){if(F.tag===5){var K=F.stateNode;T&&R&&(K=ar(K,F.type,F.memoizedProps,F)),it(v,K)}else if(F.tag===6)K=F.stateNode,T&&R&&(K=Xt(K,F.memoizedProps,F)),it(v,K);else if(F.tag!==4){if(F.tag===22&&F.memoizedState!==null)K=F.child,K!==null&&(K.return=F),no(v,F,!0,!0);else if(F.child!==null){F.child.return=F,F=F.child;continue}}if(F===x)break;for(;F.sibling===null;){if(F.return===null||F.return===x)return;F=F.return}F.sibling.return=F.return,F=F.sibling}};ro=function(v,x){var T=x.stateNode;if(!Ho(v,x)){v=T.containerInfo;var R=Et(v);no(R,x,!1,!1),T.pendingChildren=R,di(x),jt(v,R)}},fi=function(v,x,T,R,F){var K=v.stateNode,ne=v.memoizedProps;if((v=Ho(v,x))&&ne===R)x.stateNode=K;else{var xe=x.stateNode,je=ua(la.current),We=null;ne!==R&&(We=ie(xe,T,ne,R,F,je)),v&&We===null?x.stateNode=K:(K=Nt(K,We,T,ne,R,x,v,xe),Z(K,T,R,F,je)&&di(x),x.stateNode=K,v?di(x):to(K,x,!1,!1))}},hi=function(v,x,T,R){T!==R?(v=ua(Ks.current),T=ua(la.current),x.stateNode=he(R,v,T,x),di(x)):x.stateNode=v.stateNode}}else ro=function(){},fi=function(){},hi=function(){};function Wi(v,x){if(!wr)switch(v.tailMode){case"hidden":x=v.tail;for(var T=null;x!==null;)x.alternate!==null&&(T=x),x=x.sibling;T===null?v.tail=null:T.sibling=null;break;case"collapsed":T=v.tail;for(var R=null;T!==null;)T.alternate!==null&&(R=T),T=T.sibling;R===null?x||v.tail===null?v.tail=null:v.tail.sibling=null:R.sibling=null}}function Pr(v){var x=v.alternate!==null&&v.alternate.child===v.child,T=0,R=0;if(x)for(var F=v.child;F!==null;)T|=F.lanes|F.childLanes,R|=F.subtreeFlags&14680064,R|=F.flags&14680064,F.return=v,F=F.sibling;else for(F=v.child;F!==null;)T|=F.lanes|F.childLanes,R|=F.subtreeFlags,R|=F.flags,F.return=v,F=F.sibling;return v.subtreeFlags|=R,v.childLanes=T,x}function qo(v,x,T){var R=x.pendingProps;switch(fc(x),x.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pr(x),null;case 1:return fn(x.type)&&ys(),Pr(x),null;case 3:return T=x.stateNode,Ao(),ur(Zr),ur(dn),Vh(),T.pendingContext&&(T.context=T.pendingContext,T.pendingContext=null),(v===null||v.child===null)&&(Id(x)?di(x):v===null||v.memoizedState.isDehydrated&&(x.flags&256)===0||(x.flags|=1024,Aa!==null&&(mf(Aa),Aa=null))),ro(v,x),Pr(x),null;case 5:Fh(x),T=ua(Ks.current);var F=x.type;if(v!==null&&x.stateNode!=null)fi(v,x,F,R,T),v.ref!==x.ref&&(x.flags|=512,x.flags|=2097152);else{if(!R){if(x.stateNode===null)throw Error(s(166));return Pr(x),null}if(v=ua(la.current),Id(x)){if(!pe)throw Error(s(175));v=oi(x.stateNode,x.type,x.memoizedProps,T,v,x,!hc),x.updateQueue=v,v!==null&&di(x)}else{var K=V(F,R,T,v,x);to(K,x,!1,!1),x.stateNode=K,Z(K,F,R,T,v)&&di(x)}x.ref!==null&&(x.flags|=512,x.flags|=2097152)}return Pr(x),null;case 6:if(v&&x.stateNode!=null)hi(v,x,v.memoizedProps,R);else{if(typeof R!="string"&&x.stateNode===null)throw Error(s(166));if(v=ua(Ks.current),T=ua(la.current),Id(x)){if(!pe)throw Error(s(176));if(v=x.stateNode,T=x.memoizedProps,(R=An(v,T,x,!hc))&&(F=Dn,F!==null))switch(F.tag){case 3:jh(F.stateNode.containerInfo,v,T,(F.mode&1)!==0);break;case 5:Dr(F.type,F.memoizedProps,F.stateNode,v,T,(F.mode&1)!==0)}R&&di(x)}else x.stateNode=he(R,v,T,x)}return Pr(x),null;case 13:if(ur(Or),R=x.memoizedState,v===null||v.memoizedState!==null&&v.memoizedState.dehydrated!==null){if(wr&&ci!==null&&(x.mode&1)!==0&&(x.flags&128)===0)ev(),jo(),x.flags|=98560,F=!1;else if(F=Id(x),R!==null&&R.dehydrated!==null){if(v===null){if(!F)throw Error(s(318));if(!pe)throw Error(s(344));if(F=x.memoizedState,F=F!==null?F.dehydrated:null,!F)throw Error(s(317));cn(F,x)}else jo(),(x.flags&128)===0&&(x.memoizedState=null),x.flags|=4;Pr(x),F=!1}else Aa!==null&&(mf(Aa),Aa=null),F=!0;if(!F)return x.flags&65536?x:null}return(x.flags&128)!==0?(x.lanes=T,x):(T=R!==null,T!==(v!==null&&v.memoizedState!==null)&&T&&(x.child.flags|=8192,(x.mode&1)!==0&&(v===null||(Or.current&1)!==0?_r===0&&(_r=3):Jl())),x.updateQueue!==null&&(x.flags|=4),Pr(x),null);case 4:return Ao(),ro(v,x),v===null&&Oe(x.stateNode.containerInfo),Pr(x),null;case 10:return pc(x.type._context),Pr(x),null;case 17:return fn(x.type)&&ys(),Pr(x),null;case 19:if(ur(Or),F=x.memoizedState,F===null)return Pr(x),null;if(R=(x.flags&128)!==0,K=F.rendering,K===null)if(R)Wi(F,!1);else{if(_r!==0||v!==null&&(v.flags&128)!==0)for(v=x.child;v!==null;){if(K=Gd(v),K!==null){for(x.flags|=128,Wi(F,!1),v=K.updateQueue,v!==null&&(x.updateQueue=v,x.flags|=4),x.subtreeFlags=0,v=T,T=x.child;T!==null;)R=T,F=v,R.flags&=14680066,K=R.alternate,K===null?(R.childLanes=0,R.lanes=F,R.child=null,R.subtreeFlags=0,R.memoizedProps=null,R.memoizedState=null,R.updateQueue=null,R.dependencies=null,R.stateNode=null):(R.childLanes=K.childLanes,R.lanes=K.lanes,R.child=K.child,R.subtreeFlags=0,R.deletions=null,R.memoizedProps=K.memoizedProps,R.memoizedState=K.memoizedState,R.updateQueue=K.updateQueue,R.type=K.type,F=K.dependencies,R.dependencies=F===null?null:{lanes:F.lanes,firstContext:F.firstContext}),T=T.sibling;return Tt(Or,Or.current&1|2),x.child}v=v.sibling}F.tail!==null&&kn()>_c&&(x.flags|=128,R=!0,Wi(F,!1),x.lanes=4194304)}else{if(!R)if(v=Gd(K),v!==null){if(x.flags|=128,R=!0,v=v.updateQueue,v!==null&&(x.updateQueue=v,x.flags|=4),Wi(F,!0),F.tail===null&&F.tailMode==="hidden"&&!K.alternate&&!wr)return Pr(x),null}else 2*kn()-F.renderingStartTime>_c&&T!==1073741824&&(x.flags|=128,R=!0,Wi(F,!1),x.lanes=4194304);F.isBackwards?(K.sibling=x.child,x.child=K):(v=F.last,v!==null?v.sibling=K:x.child=K,F.last=K)}return F.tail!==null?(x=F.tail,F.rendering=x,F.tail=x.sibling,F.renderingStartTime=kn(),x.sibling=null,v=Or.current,Tt(Or,R?v&1|2:v&1),x):(Pr(x),null);case 22:case 23:return gf(),T=x.memoizedState!==null,v!==null&&v.memoizedState!==null!==T&&(x.flags|=8192),T&&(x.mode&1)!==0?(gn&1073741824)!==0&&(Pr(x),oe&&x.subtreeFlags&6&&(x.flags|=8192)):Pr(x),null;case 24:return null;case 25:return null}throw Error(s(156,x.tag))}function gv(v,x){switch(fc(x),x.tag){case 1:return fn(x.type)&&ys(),v=x.flags,v&65536?(x.flags=v&-65537|128,x):null;case 3:return Ao(),ur(Zr),ur(dn),Vh(),v=x.flags,(v&65536)!==0&&(v&128)===0?(x.flags=v&-65537|128,x):null;case 5:return Fh(x),null;case 13:if(ur(Or),v=x.memoizedState,v!==null&&v.dehydrated!==null){if(x.alternate===null)throw Error(s(340));jo()}return v=x.flags,v&65536?(x.flags=v&-65537|128,x):null;case 19:return ur(Or),null;case 4:return Ao(),null;case 10:return pc(x.type._context),null;case 22:case 23:return gf(),null;case 24:return null;default:return null}}var Vl=!1,En=!1,$i=typeof WeakSet=="function"?WeakSet:Set,Xe=null;function rr(v,x){var T=v.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(R){kr(v,x,R)}else T.current=null}function Ki(v,x,T){try{T()}catch(R){kr(v,x,R)}}var rp=!1;function vv(v,x){for(X(v.containerInfo),Xe=x;Xe!==null;)if(v=Xe,x=v.child,(v.subtreeFlags&1028)!==0&&x!==null)x.return=v,Xe=x;else for(;Xe!==null;){v=Xe;try{var T=v.alternate;if((v.flags&1024)!==0)switch(v.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var R=T.memoizedProps,F=T.memoizedState,K=v.stateNode,ne=K.getSnapshotBeforeUpdate(v.elementType===v.type?R:qi(v.type,R),F);K.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:oe&&dt(v.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(xe){kr(v,v.return,xe)}if(x=v.sibling,x!==null){x.return=v.return,Xe=x;break}Xe=v.return}return T=rp,rp=!1,T}function Wo(v,x,T){var R=x.updateQueue;if(R=R!==null?R.lastEffect:null,R!==null){var F=R=R.next;do{if((F.tag&v)===v){var K=F.destroy;F.destroy=void 0,K!==void 0&&Ki(x,T,K)}F=F.next}while(F!==R)}}function Ul(v,x){if(x=x.updateQueue,x=x!==null?x.lastEffect:null,x!==null){var T=x=x.next;do{if((T.tag&v)===v){var R=T.create;T.destroy=R()}T=T.next}while(T!==x)}}function nf(v){var x=v.ref;if(x!==null){var T=v.stateNode;v.tag===5?v=G(T):v=T,typeof x=="function"?x(v):x.current=v}}function Nc(v){var x=v.alternate;x!==null&&(v.alternate=null,Nc(x)),v.child=null,v.deletions=null,v.sibling=null,v.tag===5&&(x=v.stateNode,x!==null&&Ae(x)),v.stateNode=null,v.return=null,v.dependencies=null,v.memoizedProps=null,v.memoizedState=null,v.pendingProps=null,v.stateNode=null,v.updateQueue=null}function np(v){return v.tag===5||v.tag===3||v.tag===4}function $o(v){e:for(;;){for(;v.sibling===null;){if(v.return===null||np(v.return))return null;v=v.return}for(v.sibling.return=v.return,v=v.sibling;v.tag!==5&&v.tag!==6&&v.tag!==18;){if(v.flags&2||v.child===null||v.tag===4)continue e;v.child.return=v,v=v.child}if(!(v.flags&2))return v.stateNode}}function Ec(v,x,T){var R=v.tag;if(R===5||R===6)v=v.stateNode,x?ue(T,v,x):_t(T,v);else if(R!==4&&(v=v.child,v!==null))for(Ec(v,x,T),v=v.sibling;v!==null;)Ec(v,x,T),v=v.sibling}function ip(v,x,T){var R=v.tag;if(R===5||R===6)v=v.stateNode,x?re(T,v,x):bt(T,v);else if(R!==4&&(v=v.child,v!==null))for(ip(v,x,T),v=v.sibling;v!==null;)ip(v,x,T),v=v.sibling}var Kr=null,Mi=!1;function Da(v,x,T){for(T=T.child;T!==null;)af(v,x,T),T=T.sibling}function af(v,x,T){if(Ti&&typeof Ti.onCommitFiberUnmount=="function")try{Ti.onCommitFiberUnmount(Gs,T)}catch{}switch(T.tag){case 5:En||rr(T,x);case 6:if(oe){var R=Kr,F=Mi;Kr=null,Da(v,x,T),Kr=R,Mi=F,Kr!==null&&(Mi?be(Kr,T.stateNode):ge(Kr,T.stateNode))}else Da(v,x,T);break;case 18:oe&&Kr!==null&&(Mi?Td(Kr,T.stateNode):ic(Kr,T.stateNode));break;case 4:oe?(R=Kr,F=Mi,Kr=T.stateNode.containerInfo,Mi=!0,Da(v,x,T),Kr=R,Mi=F):(fe&&(R=T.stateNode.containerInfo,F=Et(R),Pt(R,F)),Da(v,x,T));break;case 0:case 11:case 14:case 15:if(!En&&(R=T.updateQueue,R!==null&&(R=R.lastEffect,R!==null))){F=R=R.next;do{var K=F,ne=K.destroy;K=K.tag,ne!==void 0&&((K&2)!==0||(K&4)!==0)&&Ki(T,x,ne),F=F.next}while(F!==R)}Da(v,x,T);break;case 1:if(!En&&(rr(T,x),R=T.stateNode,typeof R.componentWillUnmount=="function"))try{R.props=T.memoizedProps,R.state=T.memoizedState,R.componentWillUnmount()}catch(xe){kr(T,x,xe)}Da(v,x,T);break;case 21:Da(v,x,T);break;case 22:T.mode&1?(En=(R=En)||T.memoizedState!==null,Da(v,x,T),En=R):Da(v,x,T);break;default:Da(v,x,T)}}function Ko(v){var x=v.updateQueue;if(x!==null){v.updateQueue=null;var T=v.stateNode;T===null&&(T=v.stateNode=new $i),x.forEach(function(R){var F=$x.bind(null,v,R);T.has(R)||(T.add(R),R.then(F,F))})}}function da(v,x){var T=x.deletions;if(T!==null)for(var R=0;R<T.length;R++){var F=T[R];try{var K=v,ne=x;if(oe){var xe=ne;e:for(;xe!==null;){switch(xe.tag){case 5:Kr=xe.stateNode,Mi=!1;break e;case 3:Kr=xe.stateNode.containerInfo,Mi=!0;break e;case 4:Kr=xe.stateNode.containerInfo,Mi=!0;break e}xe=xe.return}if(Kr===null)throw Error(s(160));af(K,ne,F),Kr=null,Mi=!1}else af(K,ne,F);var je=F.alternate;je!==null&&(je.return=null),F.return=null}catch(We){kr(F,x,We)}}if(x.subtreeFlags&12854)for(x=x.child;x!==null;)Tc(x,v),x=x.sibling}function Tc(v,x){var T=v.alternate,R=v.flags;switch(v.tag){case 0:case 11:case 14:case 15:if(da(x,v),Yi(v),R&4){try{Wo(3,v,v.return),Ul(3,v)}catch(rt){kr(v,v.return,rt)}try{Wo(5,v,v.return)}catch(rt){kr(v,v.return,rt)}}break;case 1:da(x,v),Yi(v),R&512&&T!==null&&rr(T,T.return);break;case 5:if(da(x,v),Yi(v),R&512&&T!==null&&rr(T,T.return),oe){if(v.flags&32){var F=v.stateNode;try{Ce(F)}catch(rt){kr(v,v.return,rt)}}if(R&4&&(F=v.stateNode,F!=null)){var K=v.memoizedProps;if(T=T!==null?T.memoizedProps:K,R=v.type,x=v.updateQueue,v.updateQueue=null,x!==null)try{De(F,x,R,T,K,v)}catch(rt){kr(v,v.return,rt)}}}break;case 6:if(da(x,v),Yi(v),R&4&&oe){if(v.stateNode===null)throw Error(s(162));F=v.stateNode,K=v.memoizedProps,T=T!==null?T.memoizedProps:K;try{ot(F,T,K)}catch(rt){kr(v,v.return,rt)}}break;case 3:if(da(x,v),Yi(v),R&4){if(oe&&pe&&T!==null&&T.memoizedState.isDehydrated)try{Vs(x.containerInfo)}catch(rt){kr(v,v.return,rt)}if(fe){F=x.containerInfo,K=x.pendingChildren;try{Pt(F,K)}catch(rt){kr(v,v.return,rt)}}}break;case 4:if(da(x,v),Yi(v),R&4&&fe){K=v.stateNode,F=K.containerInfo,K=K.pendingChildren;try{Pt(F,K)}catch(rt){kr(v,v.return,rt)}}break;case 13:da(x,v),Yi(v),F=v.child,F.flags&8192&&(K=F.memoizedState!==null,F.stateNode.isHidden=K,!K||F.alternate!==null&&F.alternate.memoizedState!==null||(Kl=kn())),R&4&&Ko(v);break;case 22:var ne=T!==null&&T.memoizedState!==null;if(v.mode&1?(En=(T=En)||ne,da(x,v),En=T):da(x,v),Yi(v),R&8192){if(T=v.memoizedState!==null,(v.stateNode.isHidden=T)&&!ne&&(v.mode&1)!==0)for(Xe=v,R=v.child;R!==null;){for(x=Xe=R;Xe!==null;){ne=Xe;var xe=ne.child;switch(ne.tag){case 0:case 11:case 14:case 15:Wo(4,ne,ne.return);break;case 1:rr(ne,ne.return);var je=ne.stateNode;if(typeof je.componentWillUnmount=="function"){var We=ne,lt=ne.return;try{var At=We;je.props=At.memoizedProps,je.state=At.memoizedState,je.componentWillUnmount()}catch(rt){kr(We,lt,rt)}}break;case 5:rr(ne,ne.return);break;case 22:if(ne.memoizedState!==null){lf(x);continue}}xe!==null?(xe.return=ne,Xe=xe):lf(x)}R=R.sibling}if(oe){e:if(R=null,oe)for(x=v;;){if(x.tag===5){if(R===null){R=x;try{F=x.stateNode,T?Le(F):Ze(x.stateNode,x.memoizedProps)}catch(rt){kr(v,v.return,rt)}}}else if(x.tag===6){if(R===null)try{K=x.stateNode,T?Re(K):Je(K,x.memoizedProps)}catch(rt){kr(v,v.return,rt)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===v)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===v)break e;for(;x.sibling===null;){if(x.return===null||x.return===v)break e;R===x&&(R=null),x=x.return}R===x&&(R=null),x.sibling.return=x.return,x=x.sibling}}}break;case 19:da(x,v),Yi(v),R&4&&Ko(v);break;case 21:break;default:da(x,v),Yi(v)}}function Yi(v){var x=v.flags;if(x&2){try{if(oe){e:{for(var T=v.return;T!==null;){if(np(T)){var R=T;break e}T=T.return}throw Error(s(160))}switch(R.tag){case 5:var F=R.stateNode;R.flags&32&&(Ce(F),R.flags&=-33);var K=$o(v);ip(v,K,F);break;case 3:case 4:var ne=R.stateNode.containerInfo,xe=$o(v);Ec(v,xe,ne);break;default:throw Error(s(161))}}}catch(je){kr(v,v.return,je)}v.flags&=-3}x&4096&&(v.flags&=-4097)}function Gl(v,x,T){Xe=v,sf(v)}function sf(v,x,T){for(var R=(v.mode&1)!==0;Xe!==null;){var F=Xe,K=F.child;if(F.tag===22&&R){var ne=F.memoizedState!==null||Vl;if(!ne){var xe=F.alternate,je=xe!==null&&xe.memoizedState!==null||En;xe=Vl;var We=En;if(Vl=ne,(En=je)&&!We)for(Xe=F;Xe!==null;)ne=Xe,je=ne.child,ne.tag===22&&ne.memoizedState!==null?uf(F):je!==null?(je.return=ne,Xe=je):uf(F);for(;K!==null;)Xe=K,sf(K),K=K.sibling;Xe=F,Vl=xe,En=We}of(v)}else(F.subtreeFlags&8772)!==0&&K!==null?(K.return=F,Xe=K):of(v)}}function of(v){for(;Xe!==null;){var x=Xe;if((x.flags&8772)!==0){var T=x.alternate;try{if((x.flags&8772)!==0)switch(x.tag){case 0:case 11:case 15:En||Ul(5,x);break;case 1:var R=x.stateNode;if(x.flags&4&&!En)if(T===null)R.componentDidMount();else{var F=x.elementType===x.type?T.memoizedProps:qi(x.type,T.memoizedProps);R.componentDidUpdate(F,T.memoizedState,R.__reactInternalSnapshotBeforeUpdate)}var K=x.updateQueue;K!==null&&sv(x,K,R);break;case 3:var ne=x.updateQueue;if(ne!==null){if(T=null,x.child!==null)switch(x.child.tag){case 5:T=G(x.child.stateNode);break;case 1:T=x.child.stateNode}sv(x,ne,T)}break;case 5:var xe=x.stateNode;T===null&&x.flags&4&&Ye(xe,x.type,x.memoizedProps,x);break;case 6:break;case 4:break;case 12:break;case 13:if(pe&&x.memoizedState===null){var je=x.alternate;if(je!==null){var We=je.memoizedState;if(We!==null){var lt=We.dehydrated;lt!==null&&li(lt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}En||x.flags&512&&nf(x)}catch(At){kr(x,x.return,At)}}if(x===v){Xe=null;break}if(T=x.sibling,T!==null){T.return=x.return,Xe=T;break}Xe=x.return}}function lf(v){for(;Xe!==null;){var x=Xe;if(x===v){Xe=null;break}var T=x.sibling;if(T!==null){T.return=x.return,Xe=T;break}Xe=x.return}}function uf(v){for(;Xe!==null;){var x=Xe;try{switch(x.tag){case 0:case 11:case 15:var T=x.return;try{Ul(4,x)}catch(je){kr(x,T,je)}break;case 1:var R=x.stateNode;if(typeof R.componentDidMount=="function"){var F=x.return;try{R.componentDidMount()}catch(je){kr(x,F,je)}}var K=x.return;try{nf(x)}catch(je){kr(x,K,je)}break;case 5:var ne=x.return;try{nf(x)}catch(je){kr(x,ne,je)}}}catch(je){kr(x,x.return,je)}if(x===v){Xe=null;break}var xe=x.sibling;if(xe!==null){xe.return=x.return,Xe=xe;break}Xe=x.return}}var Es=0,pi=1,Ya=2,Hl=3,jc=4;if(typeof Symbol=="function"&&Symbol.for){var Xi=Symbol.for;Es=Xi("selector.component"),pi=Xi("selector.has_pseudo_class"),Ya=Xi("selector.role"),Hl=Xi("selector.test_id"),jc=Xi("selector.text")}function Xa(v){var x=Te(v);if(x!=null){if(typeof x.memoizedProps["data-testname"]!="string")throw Error(s(364));return x}if(v=ye(v),v===null)throw Error(s(362));return v.stateNode.current}function Pc(v,x){switch(x.$$typeof){case Es:if(v.type===x.value)return!0;break;case pi:e:{x=x.value,v=[v,0];for(var T=0;T<v.length;){var R=v[T++],F=v[T++],K=x[F];if(R.tag!==5||!Ge(R)){for(;K!=null&&Pc(R,K);)F++,K=x[F];if(F===x.length){x=!0;break e}else for(R=R.child;R!==null;)v.push(R,F),R=R.sibling}}x=!1}return x;case Ya:if(v.tag===5&&et(v.stateNode,x.value))return!0;break;case jc:if((v.tag===5||v.tag===6)&&(v=Be(v),v!==null&&0<=v.indexOf(x.value)))return!0;break;case Hl:if(v.tag===5&&(v=v.memoizedProps["data-testname"],typeof v=="string"&&v.toLowerCase()===x.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function cf(v){switch(v.$$typeof){case Es:return"<"+(A(v.value)||"Unknown")+">";case pi:return":has("+(cf(v)||"")+")";case Ya:return'[role="'+v.value+'"]';case jc:return'"'+v.value+'"';case Hl:return'[data-testname="'+v.value+'"]';default:throw Error(s(365))}}function Qa(v,x){var T=[];v=[v,0];for(var R=0;R<v.length;){var F=v[R++],K=v[R++],ne=x[K];if(F.tag!==5||!Ge(F)){for(;ne!=null&&Pc(F,ne);)K++,ne=x[K];if(K===x.length)T.push(F);else for(F=F.child;F!==null;)v.push(F,K),F=F.sibling}}return T}function Ja(v,x){if(!Ie)throw Error(s(363));v=Xa(v),v=Qa(v,x),x=[],v=Array.from(v);for(var T=0;T<v.length;){var R=v[T++];if(R.tag===5)Ge(R)||x.push(R.stateNode);else for(R=R.child;R!==null;)v.push(R),R=R.sibling}return x}var df=Math.ceil,Mc=o.ReactCurrentDispatcher,ql=o.ReactCurrentOwner,Vr=o.ReactCurrentBatchConfig,Ot=0,dr=null,Mr=null,Yr=0,gn=0,io=Jr(0),_r=0,Wl=null,Ts=0,mr=0,$l=0,Yo=null,$n=null,Kl=0,_c=1/0,mi=null;function sr(){_c=kn()+500}var Ur=!1,tn=null,Oa=null,ao=!1,fa=null,ff=0,rn=0,Ac=null,Yl=-1,Xl=0;function Sr(){return(Ot&6)!==0?kn():Yl!==-1?Yl:Yl=kn()}function vn(v){return(v.mode&1)===0?1:(Ot&2)!==0&&Yr!==0?Yr&-Yr:Hx.transition!==null?(Xl===0&&(Xl=Pd()),Xl):(v=Ut,v!==0?v:_e())}function Kn(v,x,T,R){if(50<rn)throw rn=0,Ac=null,Error(s(185));oa(v,T,R),((Ot&2)===0||v!==dr)&&(v===dr&&((Ot&2)===0&&(mr|=T),_r===4&&js(v,Yr)),Yn(v,R),T===1&&Ot===0&&(x.mode&1)===0&&(sr(),Pl&&Rn()))}function Yn(v,x){var T=v.callbackNode;$g(v,x);var R=Nl(v,v===dr?Yr:0);if(R===0)T!==null&&Kg(T),v.callbackNode=null,v.callbackPriority=0;else if(x=R&-R,v.callbackPriority!==x){if(T!=null&&Kg(T),x===1)v.tag===0?Xg(ap.bind(null,v)):Dd(ap.bind(null,v)),He?tt(function(){(Ot&6)===0&&Rn()}):Ha(Md,Rn),T=null;else{switch(Tl(R)){case 1:T=Md;break;case 4:T=_d;break;case 16:T=Ad;break;case 536870912:T=Gx;break;default:T=Ad}T=fp(T,hf.bind(null,v))}v.callbackPriority=x,v.callbackNode=T}}function hf(v,x){if(Yl=-1,Xl=0,(Ot&6)!==0)throw Error(s(327));var T=v.callbackNode;if(Ps()&&v.callbackNode!==T)return null;var R=Nl(v,v===dr?Yr:0);if(R===0)return null;if((R&30)!==0||(R&v.expiredLanes)!==0||x)x=Xo(v,R);else{x=R;var F=Ot;Ot|=2;var K=op();(dr!==v||Yr!==x)&&(mi=null,sr(),so(v,x));do try{lp();break}catch(xe){Ql(v,xe)}while(!0);Oh(),Mc.current=K,Ot=F,Mr!==null?x=0:(dr=null,Yr=0,x=_r)}if(x!==0){if(x===2&&(F=jd(v),F!==0&&(R=F,x=pf(v,F))),x===1)throw T=Wl,so(v,0),js(v,R),Yn(v,kn()),T;if(x===6)js(v,R);else{if(F=v.current.alternate,(R&30)===0&&!yv(F)&&(x=Xo(v,R),x===2&&(K=jd(v),K!==0&&(R=K,x=pf(v,K))),x===1))throw T=Wl,so(v,0),js(v,R),Yn(v,kn()),T;switch(v.finishedWork=F,v.finishedLanes=R,x){case 0:case 1:throw Error(s(345));case 2:oo(v,$n,mi);break;case 3:if(js(v,R),(R&130023424)===R&&(x=Kl+500-kn(),10<x)){if(Nl(v,0)!==0)break;if(F=v.suspendedLanes,(F&R)!==R){Sr(),v.pingedLanes|=v.suspendedLanes&F;break}v.timeoutHandle=ee(oo.bind(null,v,$n,mi),x);break}oo(v,$n,mi);break;case 4:if(js(v,R),(R&4194240)===R)break;for(x=v.eventTimes,F=-1;0<R;){var ne=31-zi(R);K=1<<ne,ne=x[ne],ne>F&&(F=ne),R&=~K}if(R=F,R=kn()-R,R=(120>R?120:480>R?480:1080>R?1080:1920>R?1920:3e3>R?3e3:4320>R?4320:1960*df(R/1960))-R,10<R){v.timeoutHandle=ee(oo.bind(null,v,$n,mi),R);break}oo(v,$n,mi);break;case 5:oo(v,$n,mi);break;default:throw Error(s(329))}}}return Yn(v,kn()),v.callbackNode===T?hf.bind(null,v):null}function pf(v,x){var T=Yo;return v.current.memoizedState.isDehydrated&&(so(v,x).flags|=256),v=Xo(v,x),v!==2&&(x=$n,$n=T,x!==null&&mf(x)),v}function mf(v){$n===null?$n=v:$n.push.apply($n,v)}function yv(v){for(var x=v;;){if(x.flags&16384){var T=x.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var R=0;R<T.length;R++){var F=T[R],K=F.getSnapshot;F=F.value;try{if(!Pa(K(),F))return!1}catch{return!1}}}if(T=x.child,x.subtreeFlags&16384&&T!==null)T.return=x,x=T;else{if(x===v)break;for(;x.sibling===null;){if(x.return===null||x.return===v)return!0;x=x.return}x.sibling.return=x.return,x=x.sibling}}return!0}function js(v,x){for(x&=~$l,x&=~mr,v.suspendedLanes|=x,v.pingedLanes&=~x,v=v.expirationTimes;0<x;){var T=31-zi(x),R=1<<T;v[T]=-1,x&=~R}}function ap(v){if((Ot&6)!==0)throw Error(s(327));Ps();var x=Nl(v,0);if((x&1)===0)return Yn(v,kn()),null;var T=Xo(v,x);if(v.tag!==0&&T===2){var R=jd(v);R!==0&&(x=R,T=pf(v,R))}if(T===1)throw T=Wl,so(v,0),js(v,x),Yn(v,kn()),T;if(T===6)throw Error(s(345));return v.finishedWork=v.current.alternate,v.finishedLanes=x,oo(v,$n,mi),Yn(v,kn()),null}function sp(v){fa!==null&&fa.tag===0&&(Ot&6)===0&&Ps();var x=Ot;Ot|=1;var T=Vr.transition,R=Ut;try{if(Vr.transition=null,Ut=1,v)return v()}finally{Ut=R,Vr.transition=T,Ot=x,(Ot&6)===0&&Rn()}}function gf(){gn=io.current,ur(io)}function so(v,x){v.finishedWork=null,v.finishedLanes=0;var T=v.timeoutHandle;if(T!==te&&(v.timeoutHandle=te,le(T)),Mr!==null)for(T=Mr.return;T!==null;){var R=T;switch(fc(R),R.tag){case 1:R=R.type.childContextTypes,R!=null&&ys();break;case 3:Ao(),ur(Zr),ur(dn),Vh();break;case 5:Fh(R);break;case 4:Ao();break;case 13:ur(Or);break;case 19:ur(Or);break;case 10:pc(R.type._context);break;case 22:case 23:gf()}T=T.return}if(dr=v,Mr=v=lo(v.current,null),Yr=gn=x,_r=0,Wl=null,$l=mr=Ts=0,$n=Yo=null,qs!==null){for(x=0;x<qs.length;x++)if(T=qs[x],R=T.interleaved,R!==null){T.interleaved=null;var F=R.next,K=T.pending;if(K!==null){var ne=K.next;K.next=F,R.next=ne}T.pending=R}qs=null}return v}function Ql(v,x){do{var T=Mr;try{if(Oh(),Pi.current=Fo,Ol){for(var R=jr.memoizedState;R!==null;){var F=R.queue;F!==null&&(F.pending=null),R=R.next}Ol=!1}if(Ys=0,pn=en=jr=null,gc=!1,vc=0,ql.current=null,T===null||T.return===null){_r=1,Wl=x,Mr=null;break}e:{var K=v,ne=T.return,xe=T,je=x;if(x=Yr,xe.flags|=32768,je!==null&&typeof je=="object"&&typeof je.then=="function"){var We=je,lt=xe,At=lt.tag;if((lt.mode&1)===0&&(At===0||At===11||At===15)){var rt=lt.alternate;rt?(lt.updateQueue=rt.updateQueue,lt.memoizedState=rt.memoizedState,lt.lanes=rt.lanes):(lt.updateQueue=null,lt.memoizedState=null)}var gr=pv(ne);if(gr!==null){gr.flags&=-257,Js(gr,ne,xe,K,x),gr.mode&1&&hv(K,We,x),x=gr,je=We;var nr=x.updateQueue;if(nr===null){var gi=new Set;gi.add(je),x.updateQueue=gi}else nr.add(je);break e}else{if((x&1)===0){hv(K,We,x),Jl();break e}je=Error(s(426))}}else if(wr&&xe.mode&1){var Za=pv(ne);if(Za!==null){(Za.flags&65536)===0&&(Za.flags|=256),Js(Za,ne,xe,K,x),Rh(zo(je,xe));break e}}K=je=zo(je,xe),_r!==4&&(_r=2),Yo===null?Yo=[K]:Yo.push(K),K=ne;do{switch(K.tag){case 3:K.flags|=65536,x&=-x,K.lanes|=x;var Ne=Wa(K,je,x);Rl(K,Ne);break e;case 1:xe=je;var we=K.type,Me=K.stateNode;if((K.flags&128)===0&&(typeof we.getDerivedStateFromError=="function"||Me!==null&&typeof Me.componentDidCatch=="function"&&(Oa===null||!Oa.has(Me)))){K.flags|=65536,x&=-x,K.lanes|=x;var nt=Zd(K,xe,x);Rl(K,nt);break e}}K=K.return}while(K!==null)}cp(T)}catch(vt){x=vt,Mr===T&&T!==null&&(Mr=T=T.return);continue}break}while(!0)}function op(){var v=Mc.current;return Mc.current=Fo,v===null?Fo:v}function Jl(){(_r===0||_r===3||_r===2)&&(_r=4),dr===null||(Ts&268435455)===0&&(mr&268435455)===0||js(dr,Yr)}function Xo(v,x){var T=Ot;Ot|=2;var R=op();(dr!==v||Yr!==x)&&(mi=null,so(v,x));do try{xv();break}catch(F){Ql(v,F)}while(!0);if(Oh(),Ot=T,Mc.current=R,Mr!==null)throw Error(s(261));return dr=null,Yr=0,_r}function xv(){for(;Mr!==null;)up(Mr)}function lp(){for(;Mr!==null&&!Yg();)up(Mr)}function up(v){var x=Cv(v.alternate,v,gn);v.memoizedProps=v.pendingProps,x===null?cp(v):Mr=x,ql.current=null}function cp(v){var x=v;do{var T=x.alternate;if(v=x.return,(x.flags&32768)===0){if(T=qo(T,x,gn),T!==null){Mr=T;return}}else{if(T=gv(T,x),T!==null){T.flags&=32767,Mr=T;return}if(v!==null)v.flags|=32768,v.subtreeFlags=0,v.deletions=null;else{_r=6,Mr=null;return}}if(x=x.sibling,x!==null){Mr=x;return}Mr=x=v}while(x!==null);_r===0&&(_r=5)}function oo(v,x,T){var R=Ut,F=Vr.transition;try{Vr.transition=null,Ut=1,bv(v,x,T,R)}finally{Vr.transition=F,Ut=R}return null}function bv(v,x,T,R){do Ps();while(fa!==null);if((Ot&6)!==0)throw Error(s(327));T=v.finishedWork;var F=v.finishedLanes;if(T===null)return null;if(v.finishedWork=null,v.finishedLanes=0,T===v.current)throw Error(s(177));v.callbackNode=null,v.callbackPriority=0;var K=T.lanes|T.childLanes;if(Us(v,K),v===dr&&(Mr=dr=null,Yr=0),(T.subtreeFlags&2064)===0&&(T.flags&2064)===0||ao||(ao=!0,fp(Ad,function(){return Ps(),null})),K=(T.flags&15990)!==0,(T.subtreeFlags&15990)!==0||K){K=Vr.transition,Vr.transition=null;var ne=Ut;Ut=1;var xe=Ot;Ot|=4,ql.current=null,vv(v,T),Tc(T,v),Q(v.containerInfo),v.current=T,Gl(T),uc(),Ot=xe,Ut=ne,Vr.transition=K}else v.current=T;if(ao&&(ao=!1,fa=v,ff=F),K=v.pendingLanes,K===0&&(Oa=null),jl(T.stateNode),Yn(v,kn()),x!==null)for(R=v.onRecoverableError,T=0;T<x.length;T++)F=x[T],R(F.value,{componentStack:F.stack,digest:F.digest});if(Ur)throw Ur=!1,v=tn,tn=null,v;return(ff&1)!==0&&v.tag!==0&&Ps(),K=v.pendingLanes,(K&1)!==0?v===Ac?rn++:(rn=0,Ac=v):rn=0,Rn(),null}function Ps(){if(fa!==null){var v=Tl(ff),x=Vr.transition,T=Ut;try{if(Vr.transition=null,Ut=16>v?16:v,fa===null)var R=!1;else{if(v=fa,fa=null,ff=0,(Ot&6)!==0)throw Error(s(331));var F=Ot;for(Ot|=4,Xe=v.current;Xe!==null;){var K=Xe,ne=K.child;if((Xe.flags&16)!==0){var xe=K.deletions;if(xe!==null){for(var je=0;je<xe.length;je++){var We=xe[je];for(Xe=We;Xe!==null;){var lt=Xe;switch(lt.tag){case 0:case 11:case 15:Wo(8,lt,K)}var At=lt.child;if(At!==null)At.return=lt,Xe=At;else for(;Xe!==null;){lt=Xe;var rt=lt.sibling,gr=lt.return;if(Nc(lt),lt===We){Xe=null;break}if(rt!==null){rt.return=gr,Xe=rt;break}Xe=gr}}}var nr=K.alternate;if(nr!==null){var gi=nr.child;if(gi!==null){nr.child=null;do{var Za=gi.sibling;gi.sibling=null,gi=Za}while(gi!==null)}}Xe=K}}if((K.subtreeFlags&2064)!==0&&ne!==null)ne.return=K,Xe=ne;else e:for(;Xe!==null;){if(K=Xe,(K.flags&2048)!==0)switch(K.tag){case 0:case 11:case 15:Wo(9,K,K.return)}var Ne=K.sibling;if(Ne!==null){Ne.return=K.return,Xe=Ne;break e}Xe=K.return}}var we=v.current;for(Xe=we;Xe!==null;){ne=Xe;var Me=ne.child;if((ne.subtreeFlags&2064)!==0&&Me!==null)Me.return=ne,Xe=Me;else e:for(ne=we;Xe!==null;){if(xe=Xe,(xe.flags&2048)!==0)try{switch(xe.tag){case 0:case 11:case 15:Ul(9,xe)}}catch(vt){kr(xe,xe.return,vt)}if(xe===ne){Xe=null;break e}var nt=xe.sibling;if(nt!==null){nt.return=xe.return,Xe=nt;break e}Xe=xe.return}}if(Ot=F,Rn(),Ti&&typeof Ti.onPostCommitFiberRoot=="function")try{Ti.onPostCommitFiberRoot(Gs,v)}catch{}R=!0}return R}finally{Ut=T,Vr.transition=x}}return!1}function dp(v,x,T){x=zo(T,x),x=Wa(v,x,1),v=Ss(v,x,1),x=Sr(),v!==null&&(oa(v,1,x),Yn(v,x))}function kr(v,x,T){if(v.tag===3)dp(v,v,T);else for(;x!==null;){if(x.tag===3){dp(x,v,T);break}else if(x.tag===1){var R=x.stateNode;if(typeof x.type.getDerivedStateFromError=="function"||typeof R.componentDidCatch=="function"&&(Oa===null||!Oa.has(R))){v=zo(T,v),v=Zd(x,v,1),x=Ss(x,v,1),v=Sr(),x!==null&&(oa(x,1,v),Yn(x,v));break}}x=x.return}}function wv(v,x,T){var R=v.pingCache;R!==null&&R.delete(x),x=Sr(),v.pingedLanes|=v.suspendedLanes&T,dr===v&&(Yr&T)===T&&(_r===4||_r===3&&(Yr&130023424)===Yr&&500>kn()-Kl?so(v,0):$l|=T),Yn(v,x)}function Sv(v,x){x===0&&((v.mode&1)===0?x=1:(x=lc,lc<<=1,(lc&130023424)===0&&(lc=4194304)));var T=Sr();v=Ra(v,x),v!==null&&(oa(v,x,T),Yn(v,T))}function kv(v){var x=v.memoizedState,T=0;x!==null&&(T=x.retryLane),Sv(v,T)}function $x(v,x){var T=0;switch(v.tag){case 13:var R=v.stateNode,F=v.memoizedState;F!==null&&(T=F.retryLane);break;case 19:R=v.stateNode;break;default:throw Error(s(314))}R!==null&&R.delete(x),Sv(v,T)}var Cv;Cv=function(v,x,T){if(v!==null)if(v.memoizedProps!==x.pendingProps||Zr.current)mn=!0;else{if((v.lanes&T)===0&&(x.flags&128)===0)return mn=!1,eo(v,x,T);mn=(v.flags&131072)!==0}else mn=!1,wr&&(x.flags&1048576)!==0&&Qg(x,To,x.index);switch(x.lanes=0,x.tag){case 2:var R=x.type;Cc(v,x),v=x.pendingProps;var F=ja(x,dn.current);Al(x,T),F=yc(null,x,R,v,F,T);var K=Hd();return x.flags|=1,typeof F=="object"&&F!==null&&typeof F.render=="function"&&F.$$typeof===void 0?(x.tag=1,x.memoizedState=null,x.updateQueue=null,fn(R)?(K=!0,kl(x)):K=!1,x.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,Lh(x),F.updater=wc,x.stateNode=F,F._reactInternals=x,qa(x,R,v,T),x=qn(null,x,R,!0,K,T)):(x.tag=0,wr&&K&&dc(x),Nn(null,x,F,T),x=x.child),x;case 16:R=x.elementType;e:{switch(Cc(v,x),v=x.pendingProps,F=R._init,R=F(R._payload),x.type=R,F=x.tag=Kx(R),v=qi(R,v),F){case 0:x=$a(null,x,R,v,T);break e;case 1:x=In(null,x,R,v,T);break e;case 11:x=ef(null,x,R,v,T);break e;case 14:x=Vo(null,x,R,qi(R.type,v),T);break e}throw Error(s(306,R,""))}return x;case 0:return R=x.type,F=x.pendingProps,F=x.elementType===R?F:qi(R,F),$a(v,x,R,F,T);case 1:return R=x.type,F=x.pendingProps,F=x.elementType===R?F:qi(R,F),In(v,x,R,F,T);case 3:e:{if(Zs(x),v===null)throw Error(s(387));R=x.pendingProps,K=x.memoizedState,F=K.element,av(v,x),Ws(x,R,null,T);var ne=x.memoizedState;if(R=ne.element,pe&&K.isDehydrated)if(K={element:R,isDehydrated:!1,cache:ne.cache,pendingSuspenseBoundaries:ne.pendingSuspenseBoundaries,transitions:ne.transitions},x.updateQueue.baseState=K,x.memoizedState=K,x.flags&256){F=zo(Error(s(423)),x),x=Uo(v,x,R,T,F);break e}else if(R!==F){F=zo(Error(s(424)),x),x=Uo(v,x,R,T,F);break e}else for(pe&&(ci=zs(x.stateNode.containerInfo),Dn=x,wr=!0,Aa=null,hc=!1),T=nv(x,null,R,T),x.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(jo(),R===F){x=Ns(v,x,T);break e}Nn(v,x,R,T)}x=x.child}return x;case 5:return Bh(x),v===null&&Ah(x),R=x.type,F=x.pendingProps,K=v!==null?v.memoizedProps:null,ne=F.children,ce(R,F)?ne=null:K!==null&&ce(R,K)&&(x.flags|=32),cr(v,x),Nn(v,x,ne,T),x.child;case 6:return v===null&&Ah(x),null;case 13:return tp(v,x,T);case 4:return Ud(x,x.stateNode.containerInfo),R=x.pendingProps,v===null?x.child=Mo(x,null,R,T):Nn(v,x,R,T),x.child;case 11:return R=x.type,F=x.pendingProps,F=x.elementType===R?F:qi(R,F),ef(v,x,R,F,T);case 7:return Nn(v,x,x.pendingProps,T),x.child;case 8:return Nn(v,x,x.pendingProps.children,T),x.child;case 12:return Nn(v,x,x.pendingProps.children,T),x.child;case 10:e:{if(R=x.type._context,F=x.pendingProps,K=x.memoizedProps,ne=F.value,iv(x,R,ne),K!==null)if(Pa(K.value,ne)){if(K.children===F.children&&!Zr.current){x=Ns(v,x,T);break e}}else for(K=x.child,K!==null&&(K.return=x);K!==null;){var xe=K.dependencies;if(xe!==null){ne=K.child;for(var je=xe.firstContext;je!==null;){if(je.context===R){if(K.tag===1){je=ws(-1,T&-T),je.tag=2;var We=K.updateQueue;if(We!==null){We=We.shared;var lt=We.pending;lt===null?je.next=je:(je.next=lt.next,lt.next=je),We.pending=je}}K.lanes|=T,je=K.alternate,je!==null&&(je.lanes|=T),_o(K.return,T,x),xe.lanes|=T;break}je=je.next}}else if(K.tag===10)ne=K.type===x.type?null:K.child;else if(K.tag===18){if(ne=K.return,ne===null)throw Error(s(341));ne.lanes|=T,xe=ne.alternate,xe!==null&&(xe.lanes|=T),_o(ne,T,x),ne=K.sibling}else ne=K.child;if(ne!==null)ne.return=K;else for(ne=K;ne!==null;){if(ne===x){ne=null;break}if(K=ne.sibling,K!==null){K.return=ne.return,ne=K;break}ne=ne.return}K=ne}Nn(v,x,F.children,T),x=x.child}return x;case 9:return F=x.type,R=x.pendingProps.children,Al(x,T),F=Ui(F),R=R(F),x.flags|=1,Nn(v,x,R,T),x.child;case 14:return R=x.type,F=qi(R,x.pendingProps),F=qi(R.type,F),Vo(v,x,R,F,T);case 15:return Cs(v,x,x.type,x.pendingProps,T);case 17:return R=x.type,F=x.pendingProps,F=x.elementType===R?F:qi(R,F),Cc(v,x),x.tag=1,fn(R)?(v=!0,kl(x)):v=!1,Al(x,T),fv(x,R,F),qa(x,R,F,T),qn(null,x,R,!0,v,T);case 19:return rf(v,x,T);case 22:return pr(v,x,T)}throw Error(s(156,x.tag))};function fp(v,x){return Ha(v,x)}function Nv(v,x,T,R){this.tag=v,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=x,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=R,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qi(v,x,T,R){return new Nv(v,x,T,R)}function Zl(v){return v=v.prototype,!(!v||!v.isReactComponent)}function Kx(v){if(typeof v=="function")return Zl(v)?1:0;if(v!=null){if(v=v.$$typeof,v===b)return 11;if(v===k)return 14}return 2}function lo(v,x){var T=v.alternate;return T===null?(T=Qi(v.tag,x,v.key,v.mode),T.elementType=v.elementType,T.type=v.type,T.stateNode=v.stateNode,T.alternate=v,v.alternate=T):(T.pendingProps=x,T.type=v.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=v.flags&14680064,T.childLanes=v.childLanes,T.lanes=v.lanes,T.child=v.child,T.memoizedProps=v.memoizedProps,T.memoizedState=v.memoizedState,T.updateQueue=v.updateQueue,x=v.dependencies,T.dependencies=x===null?null:{lanes:x.lanes,firstContext:x.firstContext},T.sibling=v.sibling,T.index=v.index,T.ref=v.ref,T}function vf(v,x,T,R,F,K){var ne=2;if(R=v,typeof v=="function")Zl(v)&&(ne=1);else if(typeof v=="string")ne=5;else e:switch(v){case c:return Ln(T.children,F,K,x);case f:ne=8,F|=8;break;case m:return v=Qi(12,T,x,F|2),v.elementType=m,v.lanes=K,v;case w:return v=Qi(13,T,x,F),v.elementType=w,v.lanes=K,v;case N:return v=Qi(19,T,x,F),v.elementType=N,v.lanes=K,v;case E:return eu(T,F,K,x);default:if(typeof v=="object"&&v!==null)switch(v.$$typeof){case g:ne=10;break e;case y:ne=9;break e;case b:ne=11;break e;case k:ne=14;break e;case C:ne=16,R=null;break e}throw Error(s(130,v==null?v:typeof v,""))}return x=Qi(ne,T,x,F),x.elementType=v,x.type=R,x.lanes=K,x}function Ln(v,x,T,R){return v=Qi(7,v,R,x),v.lanes=T,v}function eu(v,x,T,R){return v=Qi(22,v,R,x),v.elementType=E,v.lanes=T,v.stateNode={isHidden:!1},v}function tu(v,x,T){return v=Qi(6,v,null,x),v.lanes=T,v}function yf(v,x,T){return x=Qi(4,v.children!==null?v.children:[],v.key,x),x.lanes=T,x.stateNode={containerInfo:v.containerInfo,pendingChildren:null,implementation:v.implementation},x}function Ev(v,x,T,R,F){this.tag=x,this.containerInfo=v,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=te,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=El(0),this.expirationTimes=El(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=El(0),this.identifierPrefix=R,this.onRecoverableError=F,pe&&(this.mutableSourceEagerHydrationData=null)}function hp(v,x,T,R,F,K,ne,xe,je){return v=new Ev(v,x,T,xe,je),x===1?(x=1,K===!0&&(x|=8)):x=0,K=Qi(3,null,null,x),v.current=K,K.stateNode=v,K.memoizedState={element:R,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lh(K),v}function xf(v){if(!v)return sa;v=v._reactInternals;e:{if(D(v)!==v||v.tag!==1)throw Error(s(170));var x=v;do{switch(x.tag){case 3:x=x.stateNode.context;break e;case 1:if(fn(x.type)){x=x.stateNode.__reactInternalMemoizedMergedChildContext;break e}}x=x.return}while(x!==null);throw Error(s(171))}if(v.tag===1){var T=v.type;if(fn(T))return qg(v,T,x)}return x}function Qo(v){var x=v._reactInternals;if(x===void 0)throw typeof v.render=="function"?Error(s(188)):(v=Object.keys(v).join(","),Error(s(268,v)));return v=H(x),v===null?null:v.stateNode}function bf(v,x){if(v=v.memoizedState,v!==null&&v.dehydrated!==null){var T=v.retryLane;v.retryLane=T!==0&&T<x?T:x}}function ru(v,x){bf(v,x),(v=v.alternate)&&bf(v,x)}function Yx(v){return v=H(v),v===null?null:v.stateNode}function Tv(){return null}return r.attemptContinuousHydration=function(v){if(v.tag===13){var x=Ra(v,134217728);if(x!==null){var T=Sr();Kn(x,v,134217728,T)}ru(v,134217728)}},r.attemptDiscreteHydration=function(v){if(v.tag===13){var x=Ra(v,1);if(x!==null){var T=Sr();Kn(x,v,1,T)}ru(v,1)}},r.attemptHydrationAtCurrentPriority=function(v){if(v.tag===13){var x=vn(v),T=Ra(v,x);if(T!==null){var R=Sr();Kn(T,v,x,R)}ru(v,x)}},r.attemptSynchronousHydration=function(v){switch(v.tag){case 3:var x=v.stateNode;if(x.current.memoizedState.isDehydrated){var T=Cl(x.pendingLanes);T!==0&&(Ga(x,T|1),Yn(x,kn()),(Ot&6)===0&&(sr(),Rn()))}break;case 13:sp(function(){var R=Ra(v,1);if(R!==null){var F=Sr();Kn(R,v,1,F)}}),ru(v,1)}},r.batchedUpdates=function(v,x){var T=Ot;Ot|=1;try{return v(x)}finally{Ot=T,Ot===0&&(sr(),Pl&&Rn())}},r.createComponentSelector=function(v){return{$$typeof:Es,value:v}},r.createContainer=function(v,x,T,R,F,K,ne){return hp(v,x,!1,null,T,R,F,K,ne)},r.createHasPseudoClassSelector=function(v){return{$$typeof:pi,value:v}},r.createHydrationContainer=function(v,x,T,R,F,K,ne,xe,je){return v=hp(T,R,!0,v,F,K,ne,xe,je),v.context=xf(null),T=v.current,R=Sr(),F=vn(T),K=ws(R,F),K.callback=x??null,Ss(T,K,F),v.current.lanes=F,oa(v,F,R),Yn(v,R),v},r.createPortal=function(v,x,T){var R=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:R==null?null:""+R,children:v,containerInfo:x,implementation:T}},r.createRoleSelector=function(v){return{$$typeof:Ya,value:v}},r.createTestNameSelector=function(v){return{$$typeof:Hl,value:v}},r.createTextSelector=function(v){return{$$typeof:jc,value:v}},r.deferredUpdates=function(v){var x=Ut,T=Vr.transition;try{return Vr.transition=null,Ut=16,v()}finally{Ut=x,Vr.transition=T}},r.discreteUpdates=function(v,x,T,R,F){var K=Ut,ne=Vr.transition;try{return Vr.transition=null,Ut=1,v(x,T,R,F)}finally{Ut=K,Vr.transition=ne,Ot===0&&sr()}},r.findAllNodes=Ja,r.findBoundingRects=function(v,x){if(!Ie)throw Error(s(363));x=Ja(v,x),v=[];for(var T=0;T<x.length;T++)v.push(Pe(x[T]));for(x=v.length-1;0<x;x--){T=v[x];for(var R=T.x,F=R+T.width,K=T.y,ne=K+T.height,xe=x-1;0<=xe;xe--)if(x!==xe){var je=v[xe],We=je.x,lt=We+je.width,At=je.y,rt=At+je.height;if(R>=We&&K>=At&&F<=lt&&ne<=rt){v.splice(x,1);break}else if(R!==We||T.width!==je.width||rt<K||At>ne){if(!(K!==At||T.height!==je.height||lt<R||We>F)){We>R&&(je.width+=We-R,je.x=R),lt<F&&(je.width=F-We),v.splice(x,1);break}}else{At>K&&(je.height+=At-K,je.y=K),rt<ne&&(je.height=ne-At),v.splice(x,1);break}}}return v},r.findHostInstance=Qo,r.findHostInstanceWithNoPortals=function(v){return v=U(v),v=v!==null?z(v):null,v===null?null:v.stateNode},r.findHostInstanceWithWarning=function(v){return Qo(v)},r.flushControlled=function(v){var x=Ot;Ot|=1;var T=Vr.transition,R=Ut;try{Vr.transition=null,Ut=1,v()}finally{Ut=R,Vr.transition=T,Ot=x,Ot===0&&(sr(),Rn())}},r.flushPassiveEffects=Ps,r.flushSync=sp,r.focusWithin=function(v,x){if(!Ie)throw Error(s(363));for(v=Xa(v),x=Qa(v,x),x=Array.from(x),v=0;v<x.length;){var T=x[v++];if(!Ge(T)){if(T.tag===5&&mt(T.stateNode))return!0;for(T=T.child;T!==null;)x.push(T),T=T.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Ut},r.getFindAllNodesFailureDescription=function(v,x){if(!Ie)throw Error(s(363));var T=0,R=[];v=[Xa(v),0];for(var F=0;F<v.length;){var K=v[F++],ne=v[F++],xe=x[ne];if((K.tag!==5||!Ge(K))&&(Pc(K,xe)&&(R.push(cf(xe)),ne++,ne>T&&(T=ne)),ne<x.length))for(K=K.child;K!==null;)v.push(K,ne),K=K.sibling}if(T<x.length){for(v=[];T<x.length;T++)v.push(cf(x[T]));return`findAllNodes was able to match part of the selector:
  `+(R.join(" > ")+`

No matching component was found for:
  `)+v.join(" > ")}return null},r.getPublicRootInstance=function(v){return v=v.current,v.child?v.child.tag===5?G(v.child.stateNode):v.child.stateNode:null},r.injectIntoDevTools=function(v){if(v={bundleType:v.bundleType,version:v.version,rendererPackageName:v.rendererPackageName,rendererConfig:v.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:Yx,findFiberByHostInstance:v.findFiberByHostInstance||Tv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")v=!1;else{var x=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(x.isDisabled||!x.supportsFiber)v=!0;else{try{Gs=x.inject(v),Ti=x}catch{}v=!!x.checkDCE}}return v},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(v,x,T,R){if(!Ie)throw Error(s(363));v=Ja(v,x);var F=gt(v,T,R).disconnect;return{disconnect:function(){F()}}},r.registerMutableSourceForHydration=function(v,x){var T=x._getVersion;T=T(x._source),v.mutableSourceEagerHydrationData==null?v.mutableSourceEagerHydrationData=[x,T]:v.mutableSourceEagerHydrationData.push(x,T)},r.runWithPriority=function(v,x){var T=Ut;try{return Ut=v,x()}finally{Ut=T}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(v,x,T,R){var F=x.current,K=Sr(),ne=vn(F);return T=xf(T),x.context===null?x.context=T:x.pendingContext=T,x=ws(K,ne),x.payload={element:v},R=R===void 0?null:R,R!==null&&(x.callback=R),v=Ss(F,x,ne),v!==null&&(Kn(v,F,ne,K),mc(v,F,ne)),ne},r}),xw}var M3;function RF(){return M3||(M3=1,yw.exports=AF()),yw.exports}var DF=RF();const OF=gh(DF);var bw={exports:{}},mu={};var _3;function IF(){return _3||(_3=1,mu.ConcurrentRoot=1,mu.ContinuousEventPriority=4,mu.DefaultEventPriority=16,mu.DiscreteEventPriority=1,mu.IdleEventPriority=536870912,mu.LegacyRoot=0),mu}var A3;function LF(){return A3||(A3=1,bw.exports=IF()),bw.exports}var dP=LF(),BF=Vt();const R3={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let D3=!1,O3=!1;const QS=".react-konva-event",FF=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,zF=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,VF={};function Cx(t,e,r=VF){if(!D3&&"zIndex"in e&&(console.warn(zF),D3=!0),!O3&&e.draggable){var n=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;n&&!i&&(console.warn(FF),O3=!0)}for(var a in r)if(!R3[a]){var s=a.slice(0,2)==="on",o=r[a]!==e[a];if(s&&o){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),t.off(l,r[a])}var u=!e.hasOwnProperty(a);u&&t.setAttr(a,void 0)}var c=e._useStrictMode,f={},m=!1;const g={};for(var a in e)if(!R3[a]){var s=a.slice(0,2)==="on",y=r[a]!==e[a];if(s&&y){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e[a]&&(g[l]=e[a])}!s&&(e[a]!==r[a]||c&&e[a]!==t.getAttr(a))&&(m=!0,f[a]=e[a])}m&&(t.setAttrs(f),Zu(t));for(var l in g)t.on(l+QS,g[l])}function Zu(t){if(!BF.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}var ww=vS();const fP={},UF={};ug.Node.prototype._applyProps=Cx;function GF(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),Zu(t)}function HF(t,e,r){let n=ug[t];n||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=ug.Group);const i={},a={};for(var s in e){var o=s.slice(0,2)==="on";o?a[s]=e[s]:i[s]=e[s]}const l=new n(i);return Cx(l,a),l}function qF(t,e,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function WF(t,e,r){return!1}function $F(t){return t}function KF(){return null}function YF(){return null}function XF(t,e,r,n){return UF}function QF(){}function JF(t){}function ZF(t,e){return!1}function ez(){return fP}function tz(){return fP}const rz=setTimeout,nz=clearTimeout,iz=-1;function az(t,e){return!1}const sz=!1,oz=!0,lz=!0;function uz(t,e){e.parent===t?e.moveToTop():t.add(e),Zu(t)}function cz(t,e){e.parent===t?e.moveToTop():t.add(e),Zu(t)}function hP(t,e,r){e._remove(),t.add(e),e.setZIndex(r.getZIndex()),Zu(t)}function dz(t,e,r){hP(t,e,r)}function fz(t,e){e.destroy(),e.off(QS),Zu(t)}function hz(t,e){e.destroy(),e.off(QS),Zu(t)}function pz(t,e,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function mz(t,e,r){}function gz(t,e,r,n,i){Cx(t,i,n)}function vz(t){t.hide(),Zu(t)}function yz(t){}function xz(t,e){(e.visible==null||e.visible)&&t.show()}function bz(t,e){}function wz(t){}function Sz(){}const kz=()=>dP.DefaultEventPriority,Cz=Object.freeze(Object.defineProperty({__proto__:null,appendChild:uz,appendChildToContainer:cz,appendInitialChild:GF,cancelTimeout:nz,clearContainer:wz,commitMount:mz,commitTextUpdate:pz,commitUpdate:gz,createInstance:HF,createTextInstance:qF,detachDeletedInstance:Sz,finalizeInitialChildren:WF,getChildHostContext:tz,getCurrentEventPriority:kz,getPublicInstance:$F,getRootHostContext:ez,hideInstance:vz,hideTextInstance:yz,idlePriority:ww.unstable_IdlePriority,insertBefore:hP,insertInContainerBefore:dz,isPrimaryRenderer:sz,noTimeout:iz,now:ww.unstable_now,prepareForCommit:KF,preparePortalMount:YF,prepareUpdate:XF,removeChild:fz,removeChildFromContainer:hz,resetAfterCommit:QF,resetTextContent:JF,run:ww.unstable_runWithPriority,scheduleTimeout:rz,shouldDeprioritizeSubtree:ZF,shouldSetTextContent:az,supportsMutation:lz,unhideInstance:xz,unhideTextInstance:bz,warnsIfNotActing:oz},Symbol.toStringTag,{value:"Module"}));var Nz=Object.defineProperty,Ez=Object.defineProperties,Tz=Object.getOwnPropertyDescriptors,I3=Object.getOwnPropertySymbols,jz=Object.prototype.hasOwnProperty,Pz=Object.prototype.propertyIsEnumerable,L3=(t,e,r)=>e in t?Nz(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,B3=(t,e)=>{for(var r in e||(e={}))jz.call(e,r)&&L3(t,r,e[r]);if(I3)for(var r of I3(e))Pz.call(e,r)&&L3(t,r,e[r]);return t},Mz=(t,e)=>Ez(t,Tz(e)),F3,z3;typeof window<"u"&&((F3=window.document)!=null&&F3.createElement||((z3=window.navigator)==null?void 0:z3.product)==="ReactNative")?se.useLayoutEffect:se.useEffect;function pP(t,e,r){if(!t)return;if(r(t)===!0)return t;let n=t.child;for(;n;){const i=pP(n,e,r);if(i)return i;n=n.sibling}}function mP(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const V3=console.error;console.error=function(){const t=[...arguments].join("");if(t?.startsWith("Warning:")&&t.includes("useContext")){console.error=V3;return}return V3.apply(this,arguments)};const JS=mP(se.createContext(null));class gP extends se.Component{render(){return se.createElement(JS.Provider,{value:this._reactInternals},this.props.children)}}function _z(){const t=se.useContext(JS);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=se.useId();return se.useMemo(()=>{for(const n of[t,t?.alternate]){if(!n)continue;const i=pP(n,!1,a=>{let s=a.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(i)return i}},[t,e])}function Az(){const t=_z(),[e]=se.useState(()=>new Map);e.clear();let r=t;for(;r;){if(r.type&&typeof r.type=="object"){const i=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;i&&i!==JS&&!e.has(i)&&e.set(i,se.useContext(mP(i)))}r=r.return}return e}function Rz(){const t=Az();return se.useMemo(()=>Array.from(t.keys()).reduce((e,r)=>n=>se.createElement(e,null,se.createElement(r.Provider,Mz(B3({},n),{value:t.get(r)}))),e=>se.createElement(gP,B3({},e))),[t])}function Dz(t){const e=Kt.useRef({});return Kt.useLayoutEffect(()=>{e.current=t}),Kt.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const Oz=t=>{const e=Kt.useRef(),r=Kt.useRef(),n=Kt.useRef(),i=Dz(t),a=Rz(),s=o=>{const{forwardedRef:l}=t;l&&(typeof l=="function"?l(o):l.current=o)};return Kt.useLayoutEffect(()=>(r.current=new ug.Stage({width:t.width,height:t.height,container:e.current}),s(r.current),n.current=Mm.createContainer(r.current,dP.LegacyRoot,!1,null),Mm.updateContainer(Kt.createElement(a,{},t.children),n.current),()=>{ug.isBrowser&&(s(null),Mm.updateContainer(null,n.current,null),r.current.destroy())}),[]),Kt.useLayoutEffect(()=>{s(r.current),Cx(r.current,t,i),Mm.updateContainer(Kt.createElement(a,{},t.children),n.current,null)}),Kt.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},U3="Layer",G3="Rect",Iz="Line",Lz="Image",Bz="Text",Fz="Transformer",Mm=OF(Cz);Mm.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Kt.version,rendererPackageName:"react-konva"});const zz=Kt.forwardRef((t,e)=>Kt.createElement(gP,{},Kt.createElement(Oz,{...t,forwardedRef:e}))),R2=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,initialValue:a="",placeholder:s="",confirmText:o="Confirmar",cancelText:l="Cancelar"})=>{const[u,c]=se.useState(a),f=se.useRef(null);if(se.useEffect(()=>{c(a)},[a,t]),se.useEffect(()=>{t&&f.current&&setTimeout(()=>f.current.focus(),50)},[t]),!t)return null;const m=g=>{g.preventDefault(),r(u),e()};return hl.createPortal(h.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-md animate-in fade-in duration-300",children:h.jsxs("div",{className:"bg-[#0f0f13] border border-white/10 rounded-2xl p-6 shadow-2xl shadow-black/50 w-full max-w-md space-y-5 animate-in zoom-in-95 slide-in-from-bottom-2 duration-300 relative overflow-hidden ring-1 ring-white/5",onClick:g=>g.stopPropagation(),children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary to-transparent opacity-70"}),h.jsx("div",{className:"absolute -top-10 -right-10 size-40 bg-primary/5 rounded-full blur-3xl pointer-events-none"}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:n}),i&&h.jsx("p",{className:"text-sm text-slate-400 leading-relaxed mt-2",children:i})]}),h.jsxs("form",{onSubmit:m,className:"space-y-6",children:[h.jsx("input",{ref:f,type:"text",value:u,onChange:g=>c(g.target.value),placeholder:s,className:"w-full bg-black/30 border border-white/10 rounded-xl px-4 py-3.5 text-white placeholder-slate-600 focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all font-sans text-sm shadow-inner"}),h.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[h.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors",children:l}),h.jsx(yr,{type:"submit",variant:"primary",disabled:!u.trim(),children:o})]})]})]})}),document.body)},Sw=({stepNumber:t,title:e,isOpen:r,onClick:n,children:i})=>h.jsxs("div",{className:`border border-white/10 rounded-2xl bg-[#13141f] overflow-hidden transition-all duration-300 ${r?"ring-1 ring-primary/50":"opacity-80"}`,children:[h.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-6 hover:bg-white/5 transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:`size-8 rounded-full flex items-center justify-center font-black text-sm ${r?"bg-primary text-white":"bg-white/10 text-slate-400"}`,children:t}),h.jsx("h3",{className:`text-lg font-bold ${r?"text-white":"text-slate-400"}`,children:e})]}),h.jsx("span",{className:`material-symbols-outlined transition-transform duration-300 ${r?"rotate-180 text-primary":"text-slate-500"}`,children:"expand_more"})]}),r&&h.jsx("div",{className:"p-6 pt-0 border-t border-white/5 animate-in fade-in slide-in-from-top-2",children:i})]}),kw=({icon:t,title:e,desc:r,selected:n,onClick:i})=>h.jsxs("div",{onClick:i,className:`p-6 rounded-xl border cursor-pointer transition-all relative group h-full flex flex-col justify-between ${n?"bg-primary/20 border-primary shadow-[0_0_30px_rgba(var(--color-primary),0.3)]":"bg-[#0a0a0c] border-white/10 hover:border-white/30"}`,children:[h.jsxs("div",{className:"mb-4",children:[h.jsx("div",{className:`size-12 rounded-lg flex items-center justify-center mb-4 ${n?"bg-primary text-white":"bg-white/10 text-slate-400 group-hover:text-white group-hover:bg-white/20"}`,children:h.jsx("span",{className:"material-symbols-outlined text-2xl",children:t})}),h.jsx("h4",{className:"font-bold text-white mb-1",children:e}),h.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:r})]}),n&&h.jsx("div",{className:"absolute top-4 right-4 size-3 bg-primary rounded-full shadow-glow"})]}),Vz=({src:t,x:e,y:r,width:n,height:i})=>{const[a,s]=se.useState(null);return se.useEffect(()=>{if(!t)return;const o=new window.Image;o.src=t,o.crossOrigin="Anonymous",o.onload=()=>{s(o)}},[t]),h.jsx(Lz,{image:a,x:e,y:r,width:n,height:i})},Uz=({selectedId:t})=>{const e=Kt.useRef();return Kt.useEffect(()=>{if(t){const r=e.current.getStage().findOne("#"+t);r&&(e.current.nodes([r]),e.current.getLayer().batchDraw())}else e.current.nodes([])},[t]),h.jsx(Fz,{ref:e})},D2=({mode:t})=>{const{username:e,projectName:r,folderId:n,entityId:i}=Ua(),a=Na(),s=wd(),{setRightOpen:o,setRightPanelMode:l,setAvailableTemplates:u,mapSettings:c,setMapSettings:f,setOnMapSettingsChange:m}=$u(),[g,y]=se.useState(t==="create"?"setup":"editor");se.useEffect(()=>{y(t==="create"?"setup":"editor")},[t]);const[b,w]=se.useState(s.state?.folderId||null),[N,k]=se.useState(1),[C,E]=se.useState({name:"New Map",description:"",parentZone:null,type:"regional",sourceType:"blank",dims:{width:800,height:600},bgImage:null}),[P,_]=se.useState(!1),[A,I]=se.useState("brush"),[D,L]=se.useState([]),[U,H]=se.useState([]),[M,z]=se.useState([]),[O,G]=se.useState(null),W=Kt.useRef(!1),[$,X]=se.useState({isOpen:!1,id:null,text:""}),Q=te=>{te.target===te.target.getStage()&&G(null)},V=te=>{Q(te);const oe=te.target.getStage().getPointerPosition();A!=="select"&&(W.current=!0,A==="brush"||A==="eraser"?L([...D,{id:`line-${Date.now()}`,tool:A,points:[oe.x,oe.y],color:A==="eraser"?"#ffffff":"#df4b26",size:A==="eraser"?20:5}]):A==="rect"?H([...U,{id:`rect-${Date.now()}`,x:oe.x,y:oe.y,width:0,height:0,color:"#df4b26"}]):A==="text"&&(z([...M,{id:`text-${Date.now()}`,x:oe.x,y:oe.y,text:"Double click to edit",fontSize:20,color:"#ffffff"}]),W.current=!1))},Y=te=>{if(!W.current)return;const oe=te.target.getStage().getPointerPosition();A==="brush"||A==="eraser"?L(fe=>{const pe=[...fe],Te={...pe[pe.length-1]};return Te.points=Te.points.concat([oe.x,oe.y]),pe[pe.length-1]=Te,pe}):A==="rect"&&H(fe=>{const pe=[...fe],Te={...pe[pe.length-1]};return Te.width=oe.x-Te.x,Te.height=oe.y-Te.y,pe[pe.length-1]=Te,pe})},Z=()=>{W.current=!1};se.useEffect(()=>{if(o(g==="editor"),g==="editor"){l("MAP");const te={showGrid:!0,gridSize:50,width:C.dims.width,height:C.dims.height};f(te),m(ae=>{ae&&E(oe=>({...oe,dims:{width:ae.width,height:ae.height},bgImage:ae.bgImage||oe.bgImage}))})}},[g]),se.useEffect(()=>{t==="create"&&!b&&n&&(console.log("Resolving folder ID for slug:",n),$e.get(`/world-bible/folders/${n}`).then(te=>w(te.id)).catch(te=>console.error("Could not resolve folder ID",te)))},[t,n,b]);const ie=te=>{const ae=te.target.files[0];if(ae){const oe=new FileReader;oe.onload=fe=>{const pe=new Image;pe.onload=()=>{E(Te=>({...Te,bgImage:fe.target.result,dims:{width:pe.width,height:pe.height},sourceType:"upload"}))},pe.src=fe.target.result},oe.readAsDataURL(ae)}},ce=Kt.useRef(null),he=async()=>{if(!b){alert("Folder context missing. Please start from the folder view again.");return}_(!0);try{let te=C.bgImage;if(ce.current){const fe=ce.current.findOne("Transformer");if(fe&&fe.nodes([]),te=ce.current.toDataURL({pixelRatio:.5}),fe&&O){const pe=ce.current.findOne("#"+O);pe&&fe.nodes([pe])}}const ae={nombre:C.name,tipoEspecial:"map",carpetaId:b,descripcion:C.description,attributes:{type:C.type,width:C.dims.width,height:C.dims.height,bgImage:C.bgImage,layers:{lines:D,rectangles:U,texts:M},snapshotUrl:te},iconUrl:te},oe=await $e.post("/world-bible/entities",ae);window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:b}})),a(`/${e}/${r}/map-editor/edit/${oe.id}`,{replace:!0})}catch(te){console.error(te),alert("Error creating map. Check console.")}finally{_(!1)}},ee=Kt.useRef(null);se.useEffect(()=>{(!t||t==="edit")&&i&&$e.get(`/world-bible/entities/${i}`).then(te=>{w(te.carpetaId),ee.current=te.iconUrl,y("editor");let ae=te.attributes||{},oe={};const fe=ae.layers||ae.bgImage;if(!fe&&te.descripcion&&te.descripcion.trim().startsWith("{"))try{oe=JSON.parse(te.descripcion)}catch(Oe){console.error("Error parsing legacy map data",Oe)}const pe=fe?ae:oe;let Te=te.descripcion;te.descripcion&&te.descripcion.trim().startsWith("{")&&(Te=oe.description||""),E({name:te.nombre,description:Te||"",parentZone:null,type:pe.type||"regional",sourceType:pe.bgImage?"upload":"blank",dims:{width:pe.width||800,height:pe.height||600},bgImage:pe.bgImage}),pe.layers&&(L(pe.layers.lines||[]),H(pe.layers.rectangles||[]),z(pe.layers.texts||[])),f({name:te.nombre,description:Te||"",type:pe.type||"regional",showGrid:!0,gridSize:50,width:pe.width||800,height:pe.height||600,bgImage:pe.bgImage})}).catch(te=>console.error("Error loading entity",te))},[t,i]);const le=async()=>{_(!0);try{let te=C.bgImage;if(ce.current){G(null);const oe=ce.current.findOne("Transformer");oe&&oe.nodes([]),te=ce.current.toDataURL({pixelRatio:.5})}const ae={id:i,nombre:C.name,tipoEspecial:"map",carpetaId:b,descripcion:C.description,attributes:{type:C.type,width:C.dims.width,height:C.dims.height,bgImage:C.bgImage,layers:{lines:D,rectangles:U,texts:M},snapshotUrl:te},iconUrl:ee.current};await $e.put(`/world-bible/entities/${i}`,ae),a(b?`/${e}/${r}/bible/folder/${b}`:`/${e}/${r}/bible`)}catch(te){console.error("Save failed",te),alert("Error saving map")}finally{_(!1)}};return g==="setup"?h.jsxs("div",{className:"flex-1 flex flex-col h-screen bg-[#060608] text-white",children:[h.jsxs("div",{className:"h-16 border-b border-white/5 flex items-center justify-between px-8 bg-[#0a0a0c]",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-primary/20 rounded-lg text-primary",children:h.jsx("span",{className:"material-symbols-outlined",children:"add_circle"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-lg font-bold leading-tight",children:"Create New Map / Zone"}),h.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-bold tracking-wider",children:"Configure details for your new cartography entry"})]})]}),h.jsx("button",{onClick:()=>a(-1),className:"p-2 hover:bg-white/5 rounded-full text-slate-500 hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),h.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-8",children:h.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[h.jsx(Sw,{stepNumber:"1",title:"Identity & Hierarchy",isOpen:N===1,onClick:()=>k(1),children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Map Name"}),h.jsx("input",{autoFocus:!0,value:C.name,onChange:te=>E({...C,name:te.target.value}),className:"w-full bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-white focus:border-primary outline-none transition-colors",placeholder:"e.g. The Sapphire Coast"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Parent Zone (Optional)"}),h.jsxs("div",{className:"w-full bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-slate-400 flex items-center justify-between cursor-pointer hover:border-white/20",children:[h.jsx("span",{children:"Current Folder (Default)"}),h.jsx("span",{className:"material-symbols-outlined text-sm",children:"expand_more"})]}),h.jsx("p",{className:"text-[10px] text-slate-600 mt-2",children:"Selecting a parent makes this a sub-zone."})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Description"}),h.jsx("textarea",{value:C.description,onChange:te=>E({...C,description:te.target.value}),className:"w-full h-40 bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-white resize-none focus:border-primary outline-none transition-colors leading-relaxed",placeholder:"Brief description of geography, climate, or importance..."})]})]})}),h.jsx(Sw,{stepNumber:"2",title:"Map Type",isOpen:N===2,onClick:()=>k(2),children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsx(kw,{icon:"public",title:"World Map",desc:"Continents, oceans, global scale.",selected:C.type==="world",onClick:()=>E({...C,type:"world"})}),h.jsx(kw,{icon:"map",title:"Regional Map",desc:"Kingdoms, provinces, biomes.",selected:C.type==="regional",onClick:()=>E({...C,type:"regional"})}),h.jsx(kw,{icon:"location_city",title:"City / Local",desc:"Cities, dungeons, battlemaps.",selected:C.type==="local",onClick:()=>E({...C,type:"local"})})]})}),h.jsx(Sw,{stepNumber:"3",title:"Canvas Source",isOpen:N===3,onClick:()=>k(3),children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{onClick:()=>document.getElementById("map-upload-input").click(),className:`relative p-8 rounded-xl border-2 border-dashed flex flex-col items-center justify-center text-center cursor-pointer transition-all group min-h-[200px] ${C.sourceType==="upload"?"border-primary bg-primary/5":"border-white/10 hover:border-white/30 bg-[#0a0a0c]"}`,children:[h.jsx("input",{id:"map-upload-input",type:"file",accept:"image/*",className:"hidden",onChange:ie}),C.bgImage?h.jsx("img",{src:C.bgImage,alt:"Preview",className:"absolute inset-0 w-full h-full object-cover rounded-xl opacity-50 group-hover:opacity-70"}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"size-16 bg-white/5 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:h.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"cloud_upload"})}),h.jsx("h4",{className:"font-bold text-white",children:"Upload Image File"}),h.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Drag & drop or click to browse"}),h.jsx("p",{className:"text-[10px] text-slate-600 mt-1 uppercase font-bold",children:"JPG, PNG, WEBP  Max 20MB"})]}),C.sourceType==="upload"&&h.jsx("div",{className:"absolute top-4 right-4 size-3 bg-primary rounded-full shadow-glow z-10"})]}),h.jsxs("div",{onClick:()=>E({...C,sourceType:"blank",bgImage:null}),className:`p-8 rounded-xl border flex flex-col items-center justify-center text-center cursor-pointer transition-all min-h-[200px] ${C.sourceType==="blank"?"border-primary bg-primary/5":"border-white/10 hover:border-white/30 bg-[#0a0a0c]"}`,children:[h.jsx("div",{className:"size-16 bg-white/5 rounded-full flex items-center justify-center mb-4",children:h.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"check_box_outline_blank"})}),h.jsx("h4",{className:"font-bold text-white",children:"Blank Canvas"}),h.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Start a new drawing from scratch"}),C.sourceType==="blank"&&h.jsxs("div",{className:"mt-6 flex items-center gap-2 bg-black/50 p-1 rounded-lg border border-white/10",children:[h.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 px-2",children:"Size"}),h.jsx("span",{className:"text-xs font-mono text-white",children:"4096 px"}),h.jsx("span",{className:"text-xs text-slate-500",children:"x"}),h.jsx("span",{className:"text-xs font-mono text-white",children:"4096 px"})]})]})]})})]})}),h.jsxs("div",{className:"h-20 border-t border-white/5 bg-[#0a0a0c] flex items-center justify-between px-8 z-20",children:[h.jsx("button",{onClick:()=>a(-1),className:"text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"Cancel"}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("span",{className:"text-xs text-slate-600 italic",children:"Changes saved locally"}),h.jsx(yr,{variant:"primary",size:"lg",icon:"check",onClick:he,disabled:!C.name||P,className:"bg-primary hover:bg-primary-light text-white shadow-lg shadow-primary/25 px-8",children:P?"Creating...":"Create Map"})]})]})]}):h.jsxs("div",{className:"flex flex-col h-screen w-full bg-[#0f0f13] text-white overflow-hidden",children:[h.jsxs("header",{className:"h-14 border-b border-white/5 flex items-center justify-between px-4 bg-[#1a1a20] shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("button",{onClick:()=>a(-1),className:"p-2 hover:bg-white/5 rounded-full",title:"Back to Collection",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"})}),h.jsxs("div",{className:"flex flex-col",children:[h.jsx("input",{value:C.name,onChange:te=>E({...C,name:te.target.value}),className:"bg-transparent font-bold text-sm outline-none focus:bg-white/5 rounded px-2 -ml-2"}),h.jsxs("span",{className:"text-[10px] text-text-muted px-2",children:[C.dims.width," x ",C.dims.height,"  ",c?.gridSize||50,"px Grid"]})]})]}),h.jsx("div",{className:"flex items-center gap-2",children:h.jsx(yr,{variant:"primary",size:"sm",icon:"save",onClick:le,disabled:P,children:P?"Saving...":"Save Changes"})})]}),h.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[h.jsx("div",{className:"w-14 bg-[#1a1a20] border-r border-white/5 flex flex-col items-center py-4 gap-4 z-10",children:[{id:"select",icon:"near_me"},{id:"brush",icon:"brush"},{id:"eraser",icon:"ink_eraser"},{id:"rect",icon:"check_box_outline_blank"},{id:"text",icon:"title"}].map(te=>h.jsx("button",{onClick:()=>I(te.id),className:`p-2 rounded-lg transition-colors ${A===te.id?"bg-primary text-white shadow-lg shadow-primary/30":"hover:bg-white/5 text-slate-400 hover:text-white"}`,children:h.jsx("span",{className:"material-symbols-outlined",children:te.icon})},te.id))}),h.jsx("div",{className:"flex-1 overflow-auto bg-[#0f0f13] relative flex items-center justify-center p-8 custom-scrollbar",children:h.jsx("div",{className:"bg-[#1a1a20] shadow-[0_0_50px_rgba(0,0,0,0.5)] flex-none",children:h.jsxs(zz,{ref:ce,width:C.dims.width,height:C.dims.height,onMouseDown:V,onMouseMove:Y,onMouseUp:Z,className:"bg-white",children:[h.jsxs(U3,{children:[C.bgImage&&h.jsx(Vz,{src:C.bgImage,x:0,y:0,width:C.dims.width,height:C.dims.height,onMouseDown:V,onTouchStart:V}),c?.showGrid&&h.jsx(G3,{width:C.dims.width,height:C.dims.height,fillPatternImage:(()=>{const te=document.createElement("canvas");te.width=c.gridSize||50,te.height=c.gridSize||50;const ae=te.getContext("2d");return ae.strokeStyle="rgba(0,0,0,0.2)",ae.lineWidth=1,ae.strokeRect(0,0,te.width,te.height),te})(),listening:!1})]}),h.jsxs(U3,{children:[D.map((te,ae)=>h.jsx(Iz,{points:te.points,stroke:te.color,strokeWidth:te.size,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:te.tool==="eraser"?"destination-out":"source-over"},ae)),U.map((te,ae)=>h.jsx(G3,{id:te.id,x:te.x,y:te.y,width:te.width,height:te.height,stroke:te.color,strokeWidth:2,draggable:A==="select",onClick:()=>A==="select"&&G(te.id),onTap:()=>A==="select"&&G(te.id)},te.id)),M.map((te,ae)=>h.jsx(Bz,{id:te.id,x:te.x,y:te.y,text:te.text,fontSize:te.fontSize,fill:te.color,draggable:A==="select",onClick:()=>A==="select"&&G(te.id),onTap:()=>A==="select"&&G(te.id),onDblClick:oe=>{X({isOpen:!0,id:te.id,text:te.text})}},te.id)),h.jsx(Uz,{selectedId:O})]})]})})})]}),h.jsx(R2,{isOpen:$.isOpen,onClose:()=>X(te=>({...te,isOpen:!1})),title:"Edit Map Text",initialValue:$.text,onConfirm:te=>{z(ae=>ae.map(oe=>oe.id===$.id?{...oe,text:te}:oe))},confirmText:"Save Text"})]})},Gz=({map:t})=>{const[e,r]=se.useState(null),n=t?.nombre||"Explorador de Mundo",i=t?.attributes||{};let a={};if(!i.bgImage&&t?.descripcion&&t?.descripcion.startsWith("{"))try{a=JSON.parse(t.descripcion)}catch{}const s=i.bgImage||a.bgImage||t?.iconUrl||"https://images.unsplash.com/photo-1521295121783-8a321d551ad2?auto=format&fit=crop&w=2000&q=80",o=[];return h.jsxs("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300 relative",children:[h.jsxs("main",{className:"flex-1 overflow-hidden relative group",children:[h.jsxs("div",{className:"absolute inset-4 rounded-[2.5rem] overflow-hidden border border-white/5 shadow-2xl bg-surface-dark",children:[h.jsx("img",{src:s,alt:n,className:"w-full h-full object-contain bg-black/20"}),h.jsx("div",{className:"absolute inset-0",children:o.map(l=>h.jsx("div",{onClick:()=>r(l),className:`absolute size-10 -translate-x-1/2 -translate-y-1/2 cursor-pointer transition-all hover:scale-125 z-10 ${e?.id===l.id?"scale-125":""}`,style:{left:l.x,top:l.y},children:h.jsxs("div",{className:`size-full rounded-2xl ${l.color} border-4 border-background-dark shadow-[0_0_20px_rgba(0,0,0,0.5)] flex items-center justify-center text-white relative group/marker`,children:[h.jsx("span",{className:"material-symbols-outlined text-lg",children:l.type==="location"?"fort":l.type==="region"?"terrain":"skull"}),h.jsx("div",{className:"absolute top-12 left-1/2 -translate-x-1/2 px-3 py-1.5 rounded-lg bg-surface-dark border border-white/10 text-[9px] font-black uppercase tracking-widest text-white whitespace-nowrap opacity-0 group-hover/marker:opacity-100 transition-opacity",children:l.name}),h.jsx("div",{className:`absolute -inset-2 rounded-[1.5rem] opacity-20 animate-ping -z-10 ${l.color}`})]})},l.id))})]}),h.jsx("aside",{className:"absolute left-12 top-1/2 -translate-y-1/2 z-20 flex flex-col gap-4",children:h.jsxs(ir,{className:"p-2 flex flex-col gap-2 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[h.jsx(wm,{icon:"near_me",active:!0}),h.jsx(wm,{icon:"location_on"}),h.jsx(wm,{icon:"brush"}),h.jsx(wm,{icon:"layers"}),h.jsx("div",{className:"w-8 h-px bg-white/10 mx-auto my-1"}),h.jsx(wm,{icon:"tune"})]})}),h.jsx("div",{className:"absolute bottom-12 left-12 z-20 px-4 py-2 rounded-xl bg-black/40 border border-white/10 backdrop-blur-md text-[10px] font-black tracking-widest text-slate-400",children:"125%"})]}),h.jsx("aside",{className:`flex-none bg-surface-dark border-l border-white/5 transition-all duration-700 relative z-30 ${e?"w-96 p-8 opacity-100":"w-0 p-0 opacity-0 overflow-hidden"}`,children:e&&h.jsxs("div",{className:"flex flex-col h-full gap-8 animate-in slide-in-from-right-8 duration-500",children:[h.jsxs("header",{className:"space-y-6",children:[h.jsxs("div",{className:"relative aspect-[4/3] rounded-3xl overflow-hidden border border-white/10 shadow-xl group",children:[h.jsx("img",{src:"https://images.unsplash.com/photo-1533154683836-84ea7a0bc310?auto=format&fit=crop&w=500&q=80",alt:"Detail",className:"w-full h-full object-cover grayscale-[0.4] group-hover:grayscale-0 transition-all duration-700"}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background-dark via-transparent to-transparent"}),h.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:h.jsx("button",{onClick:()=>r(null),className:"size-8 rounded-lg bg-black/40 border border-white/10 backdrop-blur-md text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})}),h.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[h.jsx("span",{className:"px-3 py-1 rounded bg-primary/20 text-primary border border-primary/20 text-[8px] font-black uppercase tracking-widest backdrop-blur-md",children:"Lugar"}),h.jsx("span",{className:"px-3 py-1 rounded bg-emerald-500/20 text-emerald-400 border border-emerald-500/20 text-[8px] font-black uppercase tracking-widest backdrop-blur-md",children:"Capital"})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsx("h2",{className:"text-3xl font-manrope font-black text-white tracking-tight leading-none",children:e.name}),h.jsx("button",{className:"text-slate-500 hover:text-white transition-colors p-2 rounded-xl hover:bg-white/5",children:h.jsx("span",{className:"material-symbols-outlined",children:"edit"})})]}),h.jsx("p",{className:"text-sm text-slate-400 leading-relaxed font-manrope",children:"La antigua sede de los Magos de Fuego, erigida sobre la caldera inactiva del Monte Ignis. Sus muros estn imbuidos de magia protectora."})]})]}),h.jsxs("div",{className:"space-y-8 flex-1 overflow-y-auto no-scrollbar",children:[h.jsxs("section",{className:"space-y-4",children:[h.jsxs("div",{className:"flex justify-between items-center px-1",children:[h.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Habitantes Clave"}),h.jsx("button",{className:"text-[10px] font-bold text-primary hover:underline transition-all",children:"Ver todos"})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsx(H3,{name:"Lyra Ignis",role:"Gran Maga"}),h.jsx(H3,{name:"Kaelen",role:"Capitn de la Guardia"})]})]}),h.jsxs("section",{className:"space-y-4",children:[h.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 px-1",children:"Eventos Relacionados"}),h.jsx(ir,{className:"p-4 border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx("div",{className:"size-10 rounded-xl bg-amber-500/10 text-amber-500 border border-amber-500/20 flex items-center justify-center",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"history_edu"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-xs font-bold text-white group-hover:text-primary transition-colors",children:"El Asedio de Ceniza"}),h.jsx("p",{className:"text-[10px] text-slate-500 font-medium",children:"Hace 300 aos"})]})]})})]})]}),h.jsx("footer",{className:"pt-6 border-t border-white/5",children:h.jsx(yr,{variant:"primary",icon:"auto_stories",className:"w-full py-4 rounded-2xl shadow-xl shadow-primary/20",children:"Abrir en la Biblia"})})]})})]})},wm=({icon:t,active:e})=>h.jsx("button",{className:`size-12 rounded-xl flex items-center justify-center transition-all ${e?"bg-primary text-white shadow-lg shadow-primary/30":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:t})}),H3=({name:t,role:e})=>h.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:[h.jsx(K0,{name:t,size:"sm",className:"border-white/10 group-hover:border-primary/50 transition-all"}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"text-xs font-bold text-white truncate",children:t}),h.jsx("p",{className:"text-[10px] text-slate-500 font-medium truncate",children:e})]}),h.jsx("span",{className:"material-symbols-outlined text-slate-700 text-sm group-hover:text-white transition-colors",children:"chevron_right"})]}),Hz=({maps:t,onSelect:e,onCreateNew:r,onClose:n})=>h.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-xl animate-in fade-in duration-300",children:h.jsx("div",{className:"w-full max-w-3xl animate-in zoom-in-95 duration-500",children:h.jsxs(ir,{className:"overflow-hidden border-white/10 shadow-2xl",children:[h.jsxs("header",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"material-symbols-outlined text-primary",children:"map"}),h.jsx("h2",{className:"text-xl font-manrope font-black text-white",children:"Cartografa del Proyecto"})]}),h.jsx("button",{onClick:n,className:"text-slate-500 hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),h.jsxs("div",{className:"p-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[60vh] overflow-y-auto custom-scrollbar",children:[h.jsxs("div",{onClick:r,className:"group p-6 rounded-2xl border-2 border-dashed border-white/5 hover:border-primary/50 hover:bg-primary/5 transition-all cursor-pointer flex flex-col items-center justify-center text-center gap-3",children:[h.jsx("div",{className:"size-12 rounded-full bg-primary/10 text-primary flex items-center justify-center group-hover:scale-110 transition-transform",children:h.jsx("span",{className:"material-symbols-outlined",children:"add"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-sm font-bold text-white",children:"Nuevo Mapa"}),h.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-tighter",children:"Crear desde cero"})]})]}),t.map(i=>h.jsxs("div",{onClick:()=>e(i),className:"group p-4 rounded-2xl bg-white/5 border border-white/5 hover:border-primary/50 hover:bg-white/10 transition-all cursor-pointer space-y-3",children:[h.jsx("div",{className:"aspect-video rounded-xl bg-surface-light border border-white/5 flex items-center justify-center overflow-hidden",children:h.jsx("span",{className:"material-symbols-outlined text-4xl opacity-20 group-hover:opacity-40 transition-opacity",children:"image"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-sm font-bold text-white truncate",children:i.nombre}),h.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-tighter",children:"ltima edicin: Reciente"})]})]},i.id))]}),h.jsx("footer",{className:"p-6 bg-white/[0.02] border-t border-white/5 flex justify-end",children:h.jsx("p",{className:"text-[10px] text-slate-600 font-bold uppercase tracking-widest",children:"Selecciona un mapa para cargar el visor"})})]})})}),qz=()=>{const[t,e]=se.useState("viewer"),[r,n]=se.useState([]),[i,a]=se.useState(null),[s,o]=se.useState(!1);se.useEffect(()=>{l()},[]);const l=async()=>{try{const f=(await $e.get("/world-bible/entities")).filter(m=>m.tipoEspecial==="map");n(f),f.length>0&&!i&&a(f[0])}catch(c){console.error("Error loading maps",c)}},u=c=>{c==="blank"?e("editor"):(l(),e("viewer"))};return h.jsxs("div",{className:"flex-1 flex flex-col h-full bg-background-dark overflow-hidden",children:[t==="viewer"&&h.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[h.jsx("button",{onClick:()=>o(!0),className:"absolute right-12 bottom-12 z-50 size-16 rounded-3xl bg-primary text-white flex items-center justify-center shadow-2xl shadow-primary/40 hover:scale-110 active:scale-95 transition-all group",children:h.jsx("span",{className:"material-symbols-outlined text-3xl group-hover:rotate-90 transition-transform duration-300",children:"add"})}),h.jsx(Gz,{map:i}),s&&h.jsx(Hz,{maps:r,onSelect:c=>{a(c),o(!1)},onCreateNew:()=>{o(!1),e("wizard")},onClose:()=>o(!1)})]}),t==="wizard"&&h.jsx(GB,{onCancel:()=>e("viewer"),onCreate:u}),t==="editor"&&h.jsx(D2,{onBack:()=>e("viewer"),onSave:()=>e("viewer")})]})},Wz=()=>{const[t,e]=se.useState("Loading..."),[r,n]=se.useState({words:0,rules:0,glyphs:0}),[i,a]=se.useState("Standard Tongue");se.useEffect(()=>{s()},[]);const s=async()=>{try{const o=await $e.get("/bd/proyecto-activo");e(o.nombreProyecto);const l=await $e.get("/conlang/stats");n(l);const u=await $e.get("/conlang/lenguas");u&&u.length>0&&a(u[0].nombre)}catch(o){console.error("Error loading conlang data:",o),e("Default Project")}};return h.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#0a0a0f] text-slate-300 font-sans overflow-y-auto no-scrollbar p-12 lg:p-16 gap-16",children:[h.jsxs("header",{className:"space-y-6",children:[h.jsxs("nav",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-slate-500",children:[h.jsx("span",{children:t}),h.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),h.jsxs("span",{className:"text-white",children:["Conlang: ",i]})]}),h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"space-y-4 max-w-2xl",children:[h.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:i}),h.jsxs("p",{className:"text-lg text-slate-400 leading-relaxed",children:["A conlang belonging to ",t,". Manage its lexicon, grammar rules, and writing systems here."]}),h.jsxs("div",{className:"flex gap-4 pt-2",children:[h.jsx("span",{className:"px-3 py-1 rounded bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[9px] font-black uppercase tracking-widest",children:"Complete: 45%"}),h.jsx("span",{className:"px-3 py-1 rounded bg-primary/10 text-primary border border-primary/20 text-[9px] font-black uppercase tracking-widest",children:"Type: Agglutinative"})]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"flex items-center gap-3 text-slate-500 border-r border-white/5 pr-6 mr-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm animate-pulse text-emerald-500",children:"save"}),h.jsx("span",{className:"text-[10px] font-bold",children:"Auto-Saved"}),h.jsx("span",{className:"material-symbols-outlined hover:text-white transition-colors cursor-pointer",children:"dark_mode"})]}),h.jsx(yr,{variant:"primary",icon:"add",size:"md",children:"Create Element"})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-12",children:[h.jsxs("section",{className:"xl:col-span-2 space-y-8",children:[h.jsxs("div",{className:"flex justify-between items-center px-2",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"menu_book"}),h.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Lexicon"})]}),h.jsxs("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest hover:text-primary transition-all cursor-pointer",children:["View All (",r.words,")"]})]}),h.jsxs(ir,{className:"p-0 border-white/5 bg-surface-dark/40 overflow-hidden shadow-2xl",children:[h.jsxs("div",{className:"p-4 border-b border-white/5 flex items-center gap-4",children:[h.jsxs("div",{className:"flex-1 relative",children:[h.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 text-lg",children:"search"}),h.jsx("input",{type:"text",placeholder:"Search word or meaning...",className:"w-full bg-white/5 border border-white/5 rounded-2xl py-3 pl-12 pr-4 text-xs focus:ring-1 focus:ring-primary/30 outline-none transition-all"})]}),h.jsx("button",{className:"size-10 rounded-xl bg-white/5 border border-white/5 flex items-center justify-center text-slate-500 hover:text-white transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"tune"})})]}),h.jsxs("div",{className:"p-6 space-y-4",children:[h.jsx(Cw,{word:"Ael'or",type:"noun",gender:"neutral",def:"Starlight; specifically the light from the twin moons."}),h.jsx(Cw,{word:"Vexi",type:"verb",gender:"transitive",def:"To weave magic; to create something from nothing."}),h.jsx(Cw,{word:"Dra'kan",type:"adj",gender:"",def:"Ancient; belonging to the era of dragons."})]}),h.jsx("div",{className:"p-6 bg-black/20 border-t border-white/5",children:h.jsxs("button",{className:"w-full py-4 rounded-3xl border-2 border-dashed border-white/5 text-slate-600 hover:text-white hover:border-primary/50 hover:bg-primary/5 transition-all text-[10px] font-black uppercase tracking-[0.2em] flex items-center justify-center gap-3",children:[h.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Add New Word"]})})]})]}),h.jsxs("section",{className:"space-y-8",children:[h.jsxs("div",{className:"flex justify-between items-center px-2",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"architecture"}),h.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Grammar Rules"})]}),h.jsx("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest hover:text-primary transition-all cursor-pointer",children:"Manage"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx(q3,{title:"Sentence Structure",status:"active",statusColor:"emerald",desc:"Standard order is SOV (Subject-Object-Verb), but poetry uses VSO for emphasis on action.",tags:["Syntax","Basic"]}),h.jsx(q3,{title:"Noun Declensions",status:"pending",statusColor:"amber",desc:"Seven cases marked by suffixes. Pluralization shifts the stress to the final syllable.",tags:["Morphology"]}),h.jsxs("button",{className:"w-full h-32 rounded-[2.5rem] border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-2 text-slate-600 hover:text-white hover:border-primary/30 hover:bg-primary/5 transition-all",children:[h.jsx("span",{className:"material-symbols-outlined",children:"add_circle"}),h.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Define New Rule"})]})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-12",children:[h.jsxs("section",{className:"space-y-8",children:[h.jsxs("div",{className:"flex justify-between items-center px-2",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"draw"}),h.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Writing System"})]}),h.jsxs("div",{className:"flex gap-2 text-slate-600",children:[h.jsx("button",{className:"p-1 rounded hover:bg-white/5 hover:text-white",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_view"})}),h.jsx("button",{className:"p-1 rounded hover:bg-white/5 hover:text-white",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"title"})})]})]}),h.jsxs(ir,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-8 shadow-2xl",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"text-2xl font-black text-white tracking-tight mb-1",children:"Moon Script"}),h.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Abugida  Left-to-Right"})]}),h.jsx(yr,{variant:"secondary",size:"sm",className:"bg-primary/10 border-primary/20 text-primary",children:"Open Editor"})]}),h.jsxs("div",{className:"grid grid-cols-6 gap-3",children:[["","","","",""].map(o=>h.jsx("div",{className:"aspect-square rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-3xl font-serif text-white hover:bg-white/10 transition-all cursor-pointer",children:o},o)),h.jsx("div",{className:"aspect-square rounded-2xl border-2 border-dashed border-white/5 flex items-center justify-center text-slate-600 hover:border-primary/50 hover:text-white transition-all cursor-pointer",children:h.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex justify-between text-[8px] font-black uppercase tracking-widest text-slate-600",children:[h.jsx("span",{children:"Glyph Set"}),h.jsx("span",{children:"24/32 Completed"})]}),h.jsx("div",{className:"h-1.5 w-full bg-white/5 rounded-full overflow-hidden",children:h.jsx("div",{className:"h-full bg-primary w-[75%] rounded-full shadow-[0_0_10px_rgba(99,102,242,0.5)]"})})]})]})]}),h.jsxs("section",{className:"space-y-8",children:[h.jsxs("div",{className:"flex items-center gap-3 px-2",children:[h.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"graphic_eq"}),h.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Translator & Phonology"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[h.jsxs(ir,{className:"p-8 border-primary/20 bg-primary/5 rounded-[3rem] space-y-6 shadow-2xl shadow-primary/10",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary",children:"Live Logographic Stream"}),h.jsx("span",{className:"material-symbols-outlined text-primary animate-pulse",children:"sync_alt"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("input",{type:"text",placeholder:"Source text here...",className:"w-full bg-black/40 border border-white/10 rounded-2xl p-4 text-xs font-bold text-white focus:border-primary/50 outline-none transition-all"}),h.jsxs("div",{className:"h-24 rounded-2xl bg-black/60 border border-white/5 flex items-center justify-center relative overflow-hidden group",children:[h.jsx("span",{className:"text-5xl font-serif text-white opacity-40 group-hover:opacity-100 transition-opacity",children:"   "}),h.jsx("div",{className:"absolute top-2 right-4 text-[7px] font-black uppercase tracking-widest text-slate-700",children:"Rendered Output"})]})]})]}),h.jsxs(ir,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Vowel Inventory"}),h.jsx("button",{className:"text-primary text-lg",children:h.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),h.jsx("div",{className:"flex flex-wrap gap-2",children:["/a/","/e/","/i/","/o/","/u/","/y/"].map(o=>h.jsx("div",{className:"px-3 py-1.5 rounded-xl bg-white/5 border border-white/5 text-[11px] font-mono font-bold text-slate-300 hover:text-white transition-colors cursor-pointer",children:o},o))})]}),h.jsxs(ir,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Vector Symbols"}),h.jsx("button",{className:"text-[8px] font-bold text-primary hover:underline transition-all",children:"Upload SVG"})]}),h.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[[{id:1,icon:"filter_vintage"},{id:2,icon:"auto_awesome"},{id:3,icon:"infinite"}].map(o=>h.jsx("div",{className:"aspect-square rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-slate-400 hover:text-white transition-all cursor-pointer",children:h.jsx("span",{className:"material-symbols-outlined text-2xl",children:o.icon})},o.id)),h.jsxs("div",{className:"aspect-square rounded-2xl border-2 border-dashed border-white/5 flex flex-col items-center justify-center text-slate-700 hover:border-primary/50 hover:text-white transition-all cursor-pointer",children:[h.jsx("span",{className:"material-symbols-outlined text-lg",children:"cloud_upload"}),h.jsx("span",{className:"text-[7px] font-bold uppercase mt-1",children:"Add"})]})]})]})]})]})]})]})},Cw=({word:t,type:e,gender:r,def:n})=>h.jsxs("div",{className:"p-4 rounded-2xl border border-transparent hover:bg-white/5 hover:border-white/5 transition-all group cursor-pointer relative",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[h.jsx("h4",{className:"text-xl font-manrope font-black text-white group-hover:text-primary transition-colors",children:t}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("span",{className:"text-[9px] font-bold text-slate-600 italic",children:e}),r&&h.jsxs("span",{className:"text-[9px] font-bold text-slate-700 uppercase",children:["(",r,")"]})]})]}),h.jsx("p",{className:"text-sm text-slate-400 leading-relaxed font-manrope",children:n}),h.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity p-2 text-slate-600 hover:text-white",children:h.jsx("span",{className:"material-symbols-outlined",children:"edit_note"})})]}),q3=({title:t,status:e,statusColor:r,desc:n,tags:i})=>h.jsxs(ir,{className:"p-8 border-white/5 hover:border-white/10 transition-all cursor-pointer group space-y-4",children:[h.jsxs("header",{className:"flex justify-between items-start",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`size-2 rounded-full bg-${r}-500 shadow-[0_0_10px_rgba(var(--${r}-rgb),0.5)]`}),h.jsx("h4",{className:"font-bold text-white group-hover:text-primary transition-colors",children:t})]}),h.jsx("button",{className:"text-slate-700 hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})]}),h.jsx("p",{className:"text-[11px] text-slate-500 leading-relaxed font-manrope",children:n}),h.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(a=>h.jsx("span",{className:"px-2 py-0.5 rounded bg-white/5 border border-white/5 text-[8px] font-black uppercase tracking-widest text-slate-600",children:a},a))})]}),$z=()=>h.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#050B0D] text-[#00E5FF] font-mono overflow-hidden",children:[h.jsxs("header",{className:"h-20 border-b border-[#00E5FF]/20 flex items-center justify-between px-10 bg-black/40 backdrop-blur-xl",children:[h.jsxs("div",{className:"flex items-center gap-10",children:[h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"text-[10px] opacity-40 uppercase tracking-[0.4em] font-bold",children:"Datastream_Nav"}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"material-symbols-outlined text-2xl",children:"language"}),h.jsx("span",{className:"text-2xl font-black italic tracking-tighter",children:"Chronos Atlas"})]})]}),h.jsxs("div",{className:"flex items-center gap-4 border-l border-[#00E5FF]/20 pl-10",children:[h.jsx("span",{className:"text-3xl font-black tracking-[0.2em] italic opacity-80",children:"DIGITAL RUNE COMPILER"}),h.jsx("div",{className:"px-3 py-1 rounded-sm bg-[#00E5FF]/10 border border-[#00E5FF]/30 text-[10px] font-black uppercase tracking-widest animate-pulse",children:"Data Ready"})]})]}),h.jsxs("div",{className:"flex items-center gap-8",children:[h.jsxs("div",{className:"flex items-center gap-2 opacity-60 hover:opacity-100 transition-opacity cursor-pointer",children:[h.jsx("span",{className:"material-symbols-outlined text-lg",children:"help"}),h.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Protocol"})]}),h.jsxs("button",{className:"flex items-center gap-3 px-6 py-2.5 bg-[#00E5FF] text-black font-black uppercase text-xs tracking-widest rounded-sm hover:shadow-[0_0_20px_rgba(0,229,255,0.4)] transition-all",children:[h.jsx("span",{className:"material-symbols-outlined",children:"save"}),"Commit Data"]}),h.jsx("div",{className:"size-10 rounded-full bg-gradient-to-tr from-[#00E5FF] to-blue-600 border border-white/20 shadow-lg"})]})]}),h.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[h.jsxs("main",{className:"flex-1 flex flex-col p-12 gap-12 overflow-y-auto no-scrollbar relative",children:[h.jsx("div",{className:"absolute top-0 left-0 w-full h-[2px] bg-white/5 overflow-hidden",children:h.jsx("div",{className:"h-full bg-[#00E5FF] w-[64%] shadow-[0_0_10px_#00E5FF]"})}),h.jsxs("section",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"size-2 bg-[#00E5FF] rounded-full shadow-[0_0_10px_#00E5FF]"}),h.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.4em]",children:"Glyph Set (Scan)"})]}),h.jsxs("div",{className:"flex gap-4 opacity-40",children:[h.jsx("span",{className:"material-symbols-outlined text-xl",children:"grid_view"}),h.jsx("span",{className:"material-symbols-outlined text-xl",children:"view_list"})]})]}),h.jsxs("div",{className:"p-10 rounded-sm border border-[#00E5FF]/10 bg-[#00E5FF]/[0.02] grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-6",children:[h.jsx(ho,{symbol:"",keyLabel:"A"}),h.jsx(ho,{symbol:"",keyLabel:"B"}),h.jsx(ho,{symbol:"",keyLabel:"C"}),h.jsx(ho,{symbol:"",keyLabel:"D",active:!0}),h.jsx(ho,{}),h.jsx(ho,{}),h.jsx(ho,{}),h.jsx(ho,{}),h.jsx(ho,{}),h.jsx(ho,{}),h.jsx("div",{className:"aspect-square rounded shadow-inner border border-dashed border-[#00E5FF]/20 flex items-center justify-center hover:bg-[#00E5FF]/5 transition-colors cursor-pointer group",children:h.jsx("span",{className:"material-symbols-outlined opacity-20 group-hover:opacity-100 transition-opacity",children:"add"})})]}),h.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-[0.2em] opacity-40",children:[h.jsx("span",{children:"26 Glyphs Mapped"}),h.jsxs("div",{className:"flex gap-10",children:[h.jsxs("button",{className:"hover:text-[#00E5FF] flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"tune"})," Manage"]}),h.jsxs("button",{className:"hover:text-[#00E5FF] flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"settings_input_component"})," Ranges"]})]})]})]}),h.jsxs("section",{className:"flex-1 flex flex-col gap-6",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"size-2 bg-[#00E5FF] rounded-full shadow-[0_0_10px_#00E5FF] opacity-40"}),h.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.4em] opacity-40",children:"Live Preview Stream"})]}),h.jsxs("div",{className:"flex-1 rounded-sm border border-[#00E5FF]/10 bg-black/40 flex flex-col p-12 items-center justify-center relative group min-h-[300px]",children:[h.jsx("div",{className:"absolute top-4 left-4 text-[8px] opacity-20 uppercase tracking-widest font-black",children:"Buffer Status: Active"}),h.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none text-center text-7xl font-bold tracking-widest text-[#00E5FF]/10 group-hover:text-[#00E5FF]/40 transition-all placeholder:text-[#00E5FF]/5 resize-none italic",placeholder:"Input your data stream here..."}),h.jsxs("div",{className:"absolute bottom-6 right-8 flex gap-6 text-[8px] font-black uppercase tracking-widest opacity-20",children:[h.jsx("span",{children:"48px"}),h.jsx("span",{children:"Regular"}),h.jsx("span",{children:"UTF-8"})]}),h.jsx("div",{className:"absolute inset-x-12 top-1/2 h-px bg-[#00E5FF]/10 -translate-y-1/2 pointer-events-none"})]})]})]}),h.jsxs("aside",{className:"w-[450px] border-l border-[#00E5FF]/10 p-10 flex flex-col gap-10 bg-black/40 backdrop-blur-xl relative z-20",children:[h.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.4em] opacity-60 mb-2",children:"Configuration Matrix"}),h.jsxs(ir,{className:"p-8 border-[#00E5FF]/20 bg-[#00E5FF]/[0.02] space-y-8 rounded-sm",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Font Name"}),h.jsx("input",{type:"text",defaultValue:"NEURALINK CIPHER",className:"w-full bg-black/60 border border-[#00E5FF]/30 px-6 py-4 text-xs font-black text-[#00E5FF] focus:border-[#00E5FF] outline-none transition-all tracking-widest uppercase italic"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Author / Metadata"}),h.jsx("input",{type:"text",placeholder:"YOUR SYNTHETIC ID",className:"w-full bg-black/60 border border-[#00E5FF]/30 px-6 py-4 text-xs font-black text-[#00E5FF] focus:border-[#00E5FF] outline-none transition-all tracking-widest uppercase italic"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Format"}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsx("button",{className:"py-4 border border-[#00E5FF] bg-[#00E5FF]/10 text-[#00E5FF] text-xs font-black tracking-widest shadow-[0_0_15px_rgba(0,229,255,0.2)]",children:".TTF"}),h.jsx("button",{className:"py-4 border border-[#00E5FF]/20 text-[#00E5FF]/40 text-xs font-black tracking-widest hover:border-[#00E5FF]/40 transition-all",children:".OTF"})]})]}),h.jsxs("div",{className:"pt-4 space-y-6",children:[h.jsx(W3,{label:"Ligatures",active:!0}),h.jsx(W3,{label:"Kerning",active:!0})]}),h.jsxs("button",{className:"w-full py-6 mt-6 bg-gradient-to-r from-blue-600 to-fuchsia-500 text-white font-black uppercase text-xs tracking-[0.3em] flex items-center justify-center gap-4 hover:shadow-[0_0_30px_rgba(255,0,255,0.3)] transition-all animate-pulse",children:[h.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Compile & Download"]})]}),h.jsxs("div",{className:"flex-1 flex flex-col gap-6 opacity-30 pointer-events-none",children:[h.jsxs("div",{className:"flex justify-between text-[10px] uppercase font-black",children:[h.jsx("span",{children:"Compiler Logs"}),h.jsx("span",{children:"V2.0.4"})]}),h.jsxs("div",{className:"flex-1 border border-[#00E5FF]/10 bg-black/20 p-6 flex flex-col font-mono text-[9px] gap-2 overflow-hidden",children:[h.jsx("p",{children:"[SCN] Initializing Glyph Buffer..."}),h.jsx("p",{children:"[MAP] Vector data detected for U+0394"}),h.jsx("p",{children:"[SYS] Memory allocation optimized"}),h.jsx("p",{className:"animate-pulse",children:"_"})]})]})]})]})]}),ho=({symbol:t,keyLabel:e,active:r})=>h.jsxs("div",{className:`aspect-square rounded border transition-all cursor-pointer flex items-center justify-center relative group ${r?"bg-[#00E5FF]/20 border-[#00E5FF] shadow-[0_0_20px_rgba(0,229,255,0.3)]":"bg-black/40 border-[#00E5FF]/10 hover:border-[#00E5FF]/40"}`,children:[h.jsx("span",{className:`text-3xl font-serif ${r?"text-white":"opacity-20 group-hover:opacity-60"}`,children:t||"..."}),e&&h.jsx("span",{className:`absolute top-1 right-1 text-[8px] font-black uppercase ${r?"text-[#00E5FF]/80":"opacity-20"}`,children:e})]}),W3=({label:t,active:e})=>h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-60",children:t}),h.jsx("button",{className:`w-12 h-6 rounded-full p-1 transition-colors relative ${e?"bg-[#00E5FF]/40":"bg-white/5"}`,children:h.jsx("div",{className:`size-4 rounded-full bg-[#00E5FF] shadow-[0_0_10px_#00E5FF] transition-transform ${e?"translate-x-6":"translate-x-0"}`})})]}),Kz=({onBack:t,onSave:e})=>{const[r,n]=se.useState(4),[i,a]=se.useState("curve"),[s,o]=se.useState(1),l=[{id:"select",icon:"near_me"},{id:"curve",icon:"gesture"},{id:"eraser",icon:"ink_eraser"},{id:"line",icon:"horizontal_rule"},{id:"shape",icon:"pentagon"},{id:"text",icon:"title"}],u=[{id:1,name:"Trazo Principal",type:"Vector",locked:!0,visible:!0},{id:2,name:"Detalles Secundarios",type:"Vector",locked:!0,visible:!0},{id:3,name:"Boceto Ref.",type:"Imagen (Raster)",locked:!0,visible:!1}];return h.jsxs("div",{className:"flex-1 flex flex-col bg-[#0a0a0f] text-slate-300 font-sans h-full overflow-hidden relative",children:[h.jsxs("header",{className:"h-20 flex-none border-b border-white/5 flex items-center justify-between px-8 bg-surface-dark/80 backdrop-blur-md z-30",children:[h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsx("button",{onClick:t,className:"p-2 rounded-xl bg-white/5 hover:bg-white/10 transition-colors",children:h.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),h.jsx("div",{className:"w-px h-8 bg-white/10"}),h.jsxs("div",{children:[h.jsxs("nav",{className:"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-slate-500 mb-0.5",children:[h.jsx("span",{children:"Idiomas"}),h.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),h.jsx("span",{className:"text-white",children:"Editor Grfico"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:"flex items-center gap-4 text-slate-500",children:[h.jsx("button",{className:"hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"undo"})}),h.jsx("button",{className:"hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"redo"})})]}),h.jsx("div",{className:"w-px h-4 bg-white/10 mx-2"}),h.jsxs("div",{className:"flex gap-1",children:[h.jsx("button",{className:"p-1 rounded hover:bg-white/5 text-slate-500 hover:text-white",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_on"})}),h.jsx("button",{className:"p-1 rounded bg-white/10 text-primary",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})})]})]})]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("button",{className:"flex items-center gap-2 px-6 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 transition-all text-xs font-black uppercase tracking-widest text-slate-400",children:[h.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Exportar SVG"]}),h.jsx(yr,{variant:"primary",icon:"save",className:"px-8 py-3 shadow-xl shadow-primary/30",onClick:e,children:"Guardar Glifo"}),h.jsx("div",{className:"size-10 rounded-full bg-gradient-to-br from-primary to-orange-400 border-2 border-white/10 shadow-lg ml-2"})]})]}),h.jsxs("div",{className:"flex-1 flex relative overflow-hidden",children:[h.jsxs("aside",{className:"h-full w-20 flex-none border-r border-white/5 bg-surface-dark/40 backdrop-blur-xl flex flex-col items-center py-6 gap-2 z-40",children:[l.map(c=>h.jsx("button",{onClick:()=>a(c.id),className:`size-12 rounded-2xl flex items-center justify-center transition-all ${i===c.id?"bg-primary text-white shadow-lg shadow-primary/30":"text-slate-600 hover:text-white hover:bg-white/5"}`,children:h.jsx("span",{className:"material-symbols-outlined text-2xl",children:c.icon})},c.id)),h.jsx("div",{className:"flex-1"}),h.jsx("button",{className:"size-12 rounded-2xl flex items-center justify-center text-slate-600 hover:text-white transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-2xl",children:"add_photo_alternate"})}),h.jsx("button",{className:"size-12 rounded-2xl flex items-center justify-center text-slate-600 hover:text-white transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-2xl",children:"settings"})})]}),h.jsxs("main",{className:"flex-1 bg-[#050508] relative overflow-hidden flex items-center justify-center no-scrollbar",children:[h.jsx("div",{className:"absolute inset-x-20 top-1/2 h-px bg-red-500/20 pointer-events-none"}),h.jsxs("div",{className:"relative group animate-in zoom-in-95 duration-700",children:[h.jsx("div",{className:"absolute inset-x-0 top-10 h-px bg-white/10"}),h.jsx("div",{className:"absolute inset-x-0 bottom-10 h-px bg-white/10"}),h.jsxs("div",{className:"w-[600px] h-[600px] border border-white/5 rounded-3xl bg-black/40 flex items-center justify-center relative overflow-hidden",children:[h.jsxs("svg",{width:"400",height:"400",className:"drop-shadow-[0_0_20px_rgba(99,102,242,0.5)] scale-125",children:[h.jsx("circle",{cx:"200",cy:"230",r:"100",fill:"none",stroke:"#6366f1",strokeWidth:"6",strokeLinecap:"round"}),h.jsx("line",{x1:"200",y1:"230",x2:"200",y2:"380",stroke:"#6366f1",strokeWidth:"6",strokeLinecap:"round"}),h.jsx("circle",{cx:"200",cy:"230",r:"4",fill:"white"}),h.jsx("rect",{x:"196",y:"376",width:"8",height:"8",fill:"white"}),h.jsx("rect",{x:"96",y:"226",width:"8",height:"8",fill:"#6366f1"}),h.jsx("rect",{x:"296",y:"226",width:"8",height:"8",fill:"#6366f1"}),h.jsx("rect",{x:"136",y:"160",width:"6",height:"6",fill:"#6366f1",className:"opacity-40"}),h.jsx("rect",{x:"256",y:"160",width:"6",height:"6",fill:"#6366f1",className:"opacity-40"})]}),h.jsx("div",{className:"absolute top-[160px] left-[136px] size-1 border border-primary/40 border-dashed w-[20px] h-[100px] pointer-events-none"}),h.jsx("div",{className:"absolute top-[160px] right-[136px] size-1 border border-primary/40 border-dashed w-[20px] h-[100px] pointer-events-none"})]})]}),h.jsx("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2",children:h.jsxs(ir,{className:"px-6 py-2.5 flex items-center gap-6 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[h.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"remove"})}),h.jsx("span",{className:"text-[10px] font-black text-white w-12 text-center uppercase tracking-widest",children:"120%"}),h.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"add"})})]})})]}),h.jsxs("aside",{className:"w-96 flex-none flex flex-col p-10 gap-10 bg-surface-dark/20 backdrop-blur-xl border-l border-white/5 z-40 overflow-y-auto no-scrollbar",children:[h.jsxs("section",{className:"space-y-6",children:[h.jsxs("header",{className:"flex justify-between items-center group cursor-pointer",children:[h.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Propiedades"}),h.jsx("span",{className:"material-symbols-outlined text-slate-700 text-sm",children:"more_horiz"})]}),h.jsxs(ir,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[2rem] space-y-8",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Grosor de Trazo"}),h.jsxs("span",{className:"px-2 py-0.5 rounded bg-white/5 text-[10px] font-black text-white",children:[r,"px"]})]}),h.jsx("input",{type:"range",min:"1",max:"20",value:r,onChange:c=>n(c.target.value),className:"w-full accent-primary h-1 bg-white/5 rounded-full appearance-none cursor-pointer"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 block ml-1",children:"Color / Relleno"}),h.jsxs("div",{className:"flex items-center gap-4 bg-black/40 rounded-2xl p-4 border border-white/5",children:[h.jsx("div",{className:"size-10 rounded-full bg-primary shadow-[0_0_15px_rgba(99,102,242,0.4)] border-2 border-white/20"}),h.jsx("input",{type:"text",defaultValue:"#2F2CED",className:"bg-transparent border-none outline-none text-xs font-mono text-slate-300 w-full"})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 block ml-1",children:"Terminacin (Cap)"}),h.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[h.jsx(Nw,{icon:"square"}),h.jsx(Nw,{icon:"circle",active:!0}),h.jsx(Nw,{icon:"rectangle"})]})]}),h.jsxs("button",{className:"w-full py-4 rounded-2xl bg-white/5 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-3 hover:bg-white/10 transition-all",children:[h.jsx("span",{className:"material-symbols-outlined text-lg",children:"gesture"}),"Suavizar Trazo"]})]})]}),h.jsxs("section",{className:"flex-1 flex flex-col gap-6",children:[h.jsxs("header",{className:"flex justify-between items-center",children:[h.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Capas"}),h.jsx("button",{className:"p-1 rounded bg-white/5 text-slate-500 hover:text-white transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})]}),h.jsx("div",{className:"space-y-3 overflow-y-auto no-scrollbar flex-1",children:u.map(c=>h.jsxs("div",{onClick:()=>o(c.id),className:`flex items-center gap-4 p-4 rounded-2xl transition-all cursor-pointer group ${s===c.id?"bg-primary/10 border border-primary/20":"bg-white/[0.02] border border-white/5 opacity-60 hover:opacity-100 hover:border-white/10"}`,children:[h.jsx("button",{className:"material-symbols-outlined text-sm text-slate-500 hover:text-white",children:c.visible?"visibility":"visibility_off"}),h.jsx("div",{className:"size-10 rounded-xl bg-black border border-white/10 flex items-center justify-center",children:h.jsx("span",{className:"material-symbols-outlined text-slate-600 group-hover:text-primary transition-colors text-xl",children:c.type.includes("Vector")?"timeline":"image"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"text-xs font-bold text-white truncate",children:c.name}),h.jsx("p",{className:"text-[9px] text-slate-600 font-bold uppercase tracking-widest",children:c.type})]}),h.jsx("button",{className:"material-symbols-outlined text-slate-700 text-sm",children:"lock"})]},c.id))}),h.jsxs("div",{className:"flex gap-4 p-3 rounded-2xl bg-black/20 border border-white/5",children:[h.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})}),h.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"content_copy"})}),h.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"folder"})})]})]}),h.jsxs("div",{className:"p-6 rounded-[2rem] bg-gradient-to-br from-primary/20 to-orange-500/20 border border-white/10 space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:"material-symbols-outlined text-primary",children:"auto_fix_high"}),h.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-white",children:"Vectorizacin Inteligente"})]}),h.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-manrope",children:"Arrastra una imagen para convertirla automticamente en nodos editables."}),h.jsx(yr,{variant:"primary",size:"sm",className:"w-full text-[9px] py-3 rounded-xl shadow-lg",children:"Importar y Procesar"})]})]})]})]})},Nw=({icon:t,active:e})=>h.jsx("button",{className:`py-4 rounded-xl border transition-all flex items-center justify-center ${e?"bg-primary/20 border-primary shadow-lg shadow-primary/20":"bg-white/5 border-white/5 hover:border-white/10"}`,children:h.jsx("span",{className:`material-symbols-outlined text-lg ${e?"text-white":"text-slate-600"}`,children:t})}),Yz=()=>{const[t,e]=se.useState("hub");return h.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#050508] overflow-hidden",children:[t==="hub"&&h.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[h.jsx("button",{onClick:()=>e("foundry"),className:"absolute right-12 bottom-12 z-50 size-16 rounded-3xl bg-primary text-white flex items-center justify-center shadow-2xl shadow-primary/40 hover:scale-110 active:scale-95 transition-all group",title:"Glyph Foundry",children:h.jsx("span",{className:"material-symbols-outlined text-3xl group-hover:rotate-12 transition-transform duration-300",children:"font_download"})}),h.jsx(Wz,{onOpenEditor:()=>e("editor")})]}),t==="foundry"&&h.jsx($z,{onBack:()=>e("hub")}),t==="editor"&&h.jsx(Kz,{onBack:()=>e("hub"),onSave:()=>e("hub")})]})};var Ew={exports:{}},Tw={};var $3;function Xz(){if($3)return Tw;$3=1;var t=vh();function e(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,a=t.useLayoutEffect,s=t.useDebugValue;function o(f,m){var g=m(),y=n({inst:{value:g,getSnapshot:m}}),b=y[0].inst,w=y[1];return a(function(){b.value=g,b.getSnapshot=m,l(b)&&w({inst:b})},[f,g,m]),i(function(){return l(b)&&w({inst:b}),f(function(){l(b)&&w({inst:b})})},[f]),s(g),g}function l(f){var m=f.getSnapshot;f=f.value;try{var g=m();return!r(f,g)}catch{return!0}}function u(f,m){return m()}var c=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return Tw.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:c,Tw}var K3;function vP(){return K3||(K3=1,Ew.exports=Xz()),Ew.exports}var yP=vP();function xi(t){this.content=t}xi.prototype={constructor:xi,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,r){var n=r&&r!=t?this.remove(r):this,i=n.find(t),a=n.content.slice();return i==-1?a.push(r||t,e):(a[i+1]=e,r&&(a[i]=r)),new xi(a)},remove:function(t){var e=this.find(t);if(e==-1)return this;var r=this.content.slice();return r.splice(e,2),new xi(r)},addToStart:function(t,e){return new xi([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var r=this.remove(t).content.slice();return r.push(t,e),new xi(r)},addBefore:function(t,e,r){var n=this.remove(e),i=n.content.slice(),a=n.find(t);return i.splice(a==-1?i.length:a,0,e,r),new xi(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=xi.from(t),t.size?new xi(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=xi.from(t),t.size?new xi(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=xi.from(t);for(var r=0;r<t.content.length;r+=2)e=e.remove(t.content[r]);return e},toObject:function(){var t={};return this.forEach(function(e,r){t[e]=r}),t},get size(){return this.content.length>>1}};xi.from=function(t){if(t instanceof xi)return t;var e=[];if(t)for(var r in t)e.push(r,t[r]);return new xi(e)};function xP(t,e,r){for(let n=0;;n++){if(n==t.childCount||n==e.childCount)return t.childCount==e.childCount?null:r;let i=t.child(n),a=e.child(n);if(i==a){r+=i.nodeSize;continue}if(!i.sameMarkup(a))return r;if(i.isText&&i.text!=a.text){for(let s=0;i.text[s]==a.text[s];s++)r++;return r}if(i.content.size||a.content.size){let s=xP(i.content,a.content,r+1);if(s!=null)return s}r+=i.nodeSize}}function bP(t,e,r,n){for(let i=t.childCount,a=e.childCount;;){if(i==0||a==0)return i==a?null:{a:r,b:n};let s=t.child(--i),o=e.child(--a),l=s.nodeSize;if(s==o){r-=l,n-=l;continue}if(!s.sameMarkup(o))return{a:r,b:n};if(s.isText&&s.text!=o.text){let u=0,c=Math.min(s.text.length,o.text.length);for(;u<c&&s.text[s.text.length-u-1]==o.text[o.text.length-u-1];)u++,r--,n--;return{a:r,b:n}}if(s.content.size||o.content.size){let u=bP(s.content,o.content,r-1,n-1);if(u)return u}r-=l,n-=l}}class Ve{constructor(e,r){if(this.content=e,this.size=r||0,r==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,r,n,i=0,a){for(let s=0,o=0;o<r;s++){let l=this.content[s],u=o+l.nodeSize;if(u>e&&n(l,i+o,a||null,s)!==!1&&l.content.size){let c=o+1;l.nodesBetween(Math.max(0,e-c),Math.min(l.content.size,r-c),n,i+c)}o=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,r,n,i){let a="",s=!0;return this.nodesBetween(e,r,(o,l)=>{let u=o.isText?o.text.slice(Math.max(e,l)-l,r-l):o.isLeaf?i?typeof i=="function"?i(o):i:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&u||o.isTextblock)&&n&&(s?s=!1:a+=n),a+=u},0),a}append(e){if(!e.size)return this;if(!this.size)return e;let r=this.lastChild,n=e.firstChild,i=this.content.slice(),a=0;for(r.isText&&r.sameMarkup(n)&&(i[i.length-1]=r.withText(r.text+n.text),a=1);a<e.content.length;a++)i.push(e.content[a]);return new Ve(i,this.size+e.size)}cut(e,r=this.size){if(e==0&&r==this.size)return this;let n=[],i=0;if(r>e)for(let a=0,s=0;s<r;a++){let o=this.content[a],l=s+o.nodeSize;l>e&&((s<e||l>r)&&(o.isText?o=o.cut(Math.max(0,e-s),Math.min(o.text.length,r-s)):o=o.cut(Math.max(0,e-s-1),Math.min(o.content.size,r-s-1))),n.push(o),i+=o.nodeSize),s=l}return new Ve(n,i)}cutByIndex(e,r){return e==r?Ve.empty:e==0&&r==this.content.length?this:new Ve(this.content.slice(e,r))}replaceChild(e,r){let n=this.content[e];if(n==r)return this;let i=this.content.slice(),a=this.size+r.nodeSize-n.nodeSize;return i[e]=r,new Ve(i,a)}addToStart(e){return new Ve([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Ve(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(e.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let r=this.content[e];if(!r)throw new RangeError("Index "+e+" out of range for "+this);return r}maybeChild(e){return this.content[e]||null}forEach(e){for(let r=0,n=0;r<this.content.length;r++){let i=this.content[r];e(i,n,r),n+=i.nodeSize}}findDiffStart(e,r=0){return xP(this,e,r)}findDiffEnd(e,r=this.size,n=e.size){return bP(this,e,r,n)}findIndex(e){if(e==0)return h0(0,e);if(e==this.size)return h0(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,n=0;;r++){let i=this.child(r),a=n+i.nodeSize;if(a>=e)return a==e?h0(r+1,a):h0(r,n);n=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,r){if(!r)return Ve.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ve(r.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Ve.empty;let r,n=0;for(let i=0;i<e.length;i++){let a=e[i];n+=a.nodeSize,i&&a.isText&&e[i-1].sameMarkup(a)?(r||(r=e.slice(0,i)),r[r.length-1]=a.withText(r[r.length-1].text+a.text)):r&&r.push(a)}return new Ve(r||e,n)}static from(e){if(!e)return Ve.empty;if(e instanceof Ve)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Ve([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Ve.empty=new Ve([],0);const jw={index:0,offset:0};function h0(t,e){return jw.index=t,jw.offset=e,jw}function uy(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let r=Array.isArray(t);if(Array.isArray(e)!=r)return!1;if(r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!uy(t[n],e[n]))return!1}else{for(let n in t)if(!(n in e)||!uy(t[n],e[n]))return!1;for(let n in e)if(!(n in t))return!1}return!0}let Cr=class O2{constructor(e,r){this.type=e,this.attrs=r}addToSet(e){let r,n=!1;for(let i=0;i<e.length;i++){let a=e[i];if(this.eq(a))return e;if(this.type.excludes(a.type))r||(r=e.slice(0,i));else{if(a.type.excludes(this.type))return e;!n&&a.type.rank>this.type.rank&&(r||(r=e.slice(0,i)),r.push(this),n=!0),r&&r.push(a)}}return r||(r=e.slice()),n||r.push(this),r}removeFromSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return e.slice(0,r).concat(e.slice(r+1));return e}isInSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return!0;return!1}eq(e){return this==e||this.type==e.type&&uy(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[r.type];if(!n)throw new RangeError(`There is no mark type ${r.type} in this schema`);let i=n.create(r.attrs);return n.checkAttrs(i.attrs),i}static sameSet(e,r){if(e==r)return!0;if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(r[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return O2.none;if(e instanceof O2)return[e];let r=e.slice();return r.sort((n,i)=>n.type.rank-i.type.rank),r}};Cr.none=[];class cy extends Error{}class st{constructor(e,r,n){this.content=e,this.openStart=r,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,r){let n=SP(this.content,e+this.openStart,r);return n&&new st(n,this.openStart,this.openEnd)}removeBetween(e,r){return new st(wP(this.content,e+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,r){if(!r)return st.empty;let n=r.openStart||0,i=r.openEnd||0;if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new st(Ve.fromJSON(e,r.content),n,i)}static maxOpen(e,r=!0){let n=0,i=0;for(let a=e.firstChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.firstChild)n++;for(let a=e.lastChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.lastChild)i++;return new st(e,n,i)}}st.empty=new st(Ve.empty,0,0);function wP(t,e,r){let{index:n,offset:i}=t.findIndex(e),a=t.maybeChild(n),{index:s,offset:o}=t.findIndex(r);if(i==e||a.isText){if(o!=r&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(r))}if(n!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(n,a.copy(wP(a.content,e-i-1,r-i-1)))}function SP(t,e,r,n){let{index:i,offset:a}=t.findIndex(e),s=t.maybeChild(i);if(a==e||s.isText)return n&&!n.canReplace(i,i,r)?null:t.cut(0,e).append(r).append(t.cut(e));let o=SP(s.content,e-a-1,r,s);return o&&t.replaceChild(i,s.copy(o))}function Qz(t,e,r){if(r.openStart>t.depth)throw new cy("Inserted content deeper than insertion position");if(t.depth-r.openStart!=e.depth-r.openEnd)throw new cy("Inconsistent open depths");return kP(t,e,r,0)}function kP(t,e,r,n){let i=t.index(n),a=t.node(n);if(i==e.index(n)&&n<t.depth-r.openStart){let s=kP(t,e,r,n+1);return a.copy(a.content.replaceChild(i,s))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&t.depth==n&&e.depth==n){let s=t.parent,o=s.content;return rd(s,o.cut(0,t.parentOffset).append(r.content).append(o.cut(e.parentOffset)))}else{let{start:s,end:o}=Jz(r,t);return rd(a,NP(t,s,o,e,n))}else return rd(a,dy(t,e,n))}function CP(t,e){if(!e.type.compatibleContent(t.type))throw new cy("Cannot join "+e.type.name+" onto "+t.type.name)}function I2(t,e,r){let n=t.node(r);return CP(n,e.node(r)),n}function td(t,e){let r=e.length-1;r>=0&&t.isText&&t.sameMarkup(e[r])?e[r]=t.withText(e[r].text+t.text):e.push(t)}function Bm(t,e,r,n){let i=(e||t).node(r),a=0,s=e?e.index(r):i.childCount;t&&(a=t.index(r),t.depth>r?a++:t.textOffset&&(td(t.nodeAfter,n),a++));for(let o=a;o<s;o++)td(i.child(o),n);e&&e.depth==r&&e.textOffset&&td(e.nodeBefore,n)}function rd(t,e){return t.type.checkContent(e),t.copy(e)}function NP(t,e,r,n,i){let a=t.depth>i&&I2(t,e,i+1),s=n.depth>i&&I2(r,n,i+1),o=[];return Bm(null,t,i,o),a&&s&&e.index(i)==r.index(i)?(CP(a,s),td(rd(a,NP(t,e,r,n,i+1)),o)):(a&&td(rd(a,dy(t,e,i+1)),o),Bm(e,r,i,o),s&&td(rd(s,dy(r,n,i+1)),o)),Bm(n,null,i,o),new Ve(o)}function dy(t,e,r){let n=[];if(Bm(null,t,r,n),t.depth>r){let i=I2(t,e,r+1);td(rd(i,dy(t,e,r+1)),n)}return Bm(e,null,r,n),new Ve(n)}function Jz(t,e){let r=e.depth-t.openStart,i=e.node(r).copy(t.content);for(let a=r-1;a>=0;a--)i=e.node(a).copy(Ve.from(i));return{start:i.resolveNoCache(t.openStart+r),end:i.resolveNoCache(i.content.size-t.openEnd-r)}}class cg{constructor(e,r,n){this.pos=e,this.path=r,this.parentOffset=n,this.depth=r.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,r=this.index(this.depth);if(r==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(r);return n?e.child(r).cut(n):i}get nodeBefore(){let e=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(e).cut(0,r):e==0?null:this.parent.child(e-1)}posAtIndex(e,r){r=this.resolveDepth(r);let n=this.path[r*3],i=r==0?0:this.path[r*3-1]+1;for(let a=0;a<e;a++)i+=n.child(a).nodeSize;return i}marks(){let e=this.parent,r=this.index();if(e.content.size==0)return Cr.none;if(this.textOffset)return e.child(r).marks;let n=e.maybeChild(r-1),i=e.maybeChild(r);if(!n){let o=n;n=i,i=o}let a=n.marks;for(var s=0;s<a.length;s++)a[s].type.spec.inclusive===!1&&(!i||!a[s].isInSet(i.marks))&&(a=a[s--].removeFromSet(a));return a}marksAcross(e){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let n=r.marks,i=e.parent.maybeChild(e.index());for(var a=0;a<n.length;a++)n[a].type.spec.inclusive===!1&&(!i||!n[a].isInSet(i.marks))&&(n=n[a--].removeFromSet(n));return n}sharedDepth(e){for(let r=this.depth;r>0;r--)if(this.start(r)<=e&&this.end(r)>=e)return r;return 0}blockRange(e=this,r){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!r||r(this.node(n))))return new fy(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let r=1;r<=this.depth;r++)e+=(e?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return e+":"+this.parentOffset}static resolve(e,r){if(!(r>=0&&r<=e.content.size))throw new RangeError("Position "+r+" out of range");let n=[],i=0,a=r;for(let s=e;;){let{index:o,offset:l}=s.content.findIndex(a),u=a-l;if(n.push(s,o,i+l),!u||(s=s.child(o),s.isText))break;a=u-1,i+=l+1}return new cg(r,n,a)}static resolveCached(e,r){let n=Y3.get(e);if(n)for(let a=0;a<n.elts.length;a++){let s=n.elts[a];if(s.pos==r)return s}else Y3.set(e,n=new Zz);let i=n.elts[n.i]=cg.resolve(e,r);return n.i=(n.i+1)%eV,i}}class Zz{constructor(){this.elts=[],this.i=0}}const eV=12,Y3=new WeakMap;class fy{constructor(e,r,n){this.$from=e,this.$to=r,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const tV=Object.create(null);class cs{constructor(e,r,n,i=Cr.none){this.type=e,this.attrs=r,this.marks=i,this.content=n||Ve.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,r,n,i=0){this.content.nodesBetween(e,r,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,r,n,i){return this.content.textBetween(e,r,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,r,n){return this.type==e&&uy(this.attrs,r||e.defaultAttrs||tV)&&Cr.sameSet(this.marks,n||Cr.none)}copy(e=null){return e==this.content?this:new cs(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new cs(this.type,this.attrs,this.content,e)}cut(e,r=this.content.size){return e==0&&r==this.content.size?this:this.copy(this.content.cut(e,r))}slice(e,r=this.content.size,n=!1){if(e==r)return st.empty;let i=this.resolve(e),a=this.resolve(r),s=n?0:i.sharedDepth(r),o=i.start(s),u=i.node(s).content.cut(i.pos-o,a.pos-o);return new st(u,i.depth-s,a.depth-s)}replace(e,r,n){return Qz(this.resolve(e),this.resolve(r),n)}nodeAt(e){for(let r=this;;){let{index:n,offset:i}=r.content.findIndex(e);if(r=r.maybeChild(n),!r)return null;if(i==e||r.isText)return r;e-=i+1}}childAfter(e){let{index:r,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(r),index:r,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:r,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(r),index:r,offset:n};let i=this.content.child(r-1);return{node:i,index:r-1,offset:n-i.nodeSize}}resolve(e){return cg.resolveCached(this,e)}resolveNoCache(e){return cg.resolve(this,e)}rangeHasMark(e,r,n){let i=!1;return r>e&&this.nodesBetween(e,r,a=>(n.isInSet(a.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),EP(this.marks,e)}contentMatchAt(e){let r=this.type.contentMatch.matchFragment(this.content,0,e);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(e,r,n=Ve.empty,i=0,a=n.childCount){let s=this.contentMatchAt(e).matchFragment(n,i,a),o=s&&s.matchFragment(this.content,r);if(!o||!o.validEnd)return!1;for(let l=i;l<a;l++)if(!this.type.allowsMarks(n.child(l).marks))return!1;return!0}canReplaceWith(e,r,n,i){if(i&&!this.type.allowsMarks(i))return!1;let a=this.contentMatchAt(e).matchType(n),s=a&&a.matchFragment(this.content,r);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Cr.none;for(let r=0;r<this.marks.length;r++){let n=this.marks[r];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!Cr.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(r=>r.toJSON())),e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let n;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=r.marks.map(e.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(r.text,n)}let i=Ve.fromJSON(e,r.content),a=e.nodeType(r.type).create(r.attrs,i,n);return a.type.checkAttrs(a.attrs),a}}cs.prototype.text=void 0;class hy extends cs{constructor(e,r,n,i){if(super(e,r,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):EP(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,r){return this.text.slice(e,r)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new hy(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new hy(this.type,this.attrs,e,this.marks)}cut(e=0,r=this.text.length){return e==0&&r==this.text.length?this:this.withText(this.text.slice(e,r))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function EP(t,e){for(let r=t.length-1;r>=0;r--)e=t[r].type.name+"("+e+")";return e}class md{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,r){let n=new rV(e,r);if(n.next==null)return md.empty;let i=TP(n);n.next&&n.err("Unexpected trailing text");let a=uV(lV(i));return cV(a,n),a}matchType(e){for(let r=0;r<this.next.length;r++)if(this.next[r].type==e)return this.next[r].next;return null}matchFragment(e,r=0,n=e.childCount){let i=this;for(let a=r;i&&a<n;a++)i=i.matchType(e.child(a).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:r}=this.next[e];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(e){for(let r=0;r<this.next.length;r++)for(let n=0;n<e.next.length;n++)if(this.next[r].type==e.next[n].type)return!0;return!1}fillBefore(e,r=!1,n=0){let i=[this];function a(s,o){let l=s.matchFragment(e,n);if(l&&(!r||l.validEnd))return Ve.from(o.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:c,next:f}=s.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let m=a(f,o.concat(c));if(m)return m}}return null}return a(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let r=this.computeWrapping(e);return this.wrapCache.push(e,r),r}computeWrapping(e){let r=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),a=i.match;if(a.matchType(e)){let s=[];for(let o=i;o.type;o=o.via)s.push(o.type);return s.reverse()}for(let s=0;s<a.next.length;s++){let{type:o,next:l}=a.next[s];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in r)&&(!i.type||l.validEnd)&&(n.push({match:o.contentMatch,type:o,via:i}),r[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function r(n){e.push(n);for(let i=0;i<n.next.length;i++)e.indexOf(n.next[i].next)==-1&&r(n.next[i].next)}return r(this),e.map((n,i)=>{let a=i+(n.validEnd?"*":" ")+" ";for(let s=0;s<n.next.length;s++)a+=(s?", ":"")+n.next[s].type.name+"->"+e.indexOf(n.next[s].next);return a}).join(`
`)}}md.empty=new md(!0);class rV{constructor(e,r){this.string=e,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function TP(t){let e=[];do e.push(nV(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function nV(t){let e=[];do e.push(iV(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function iV(t){let e=oV(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=aV(t,e);else break;return e}function X3(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function aV(t,e){let r=X3(t),n=r;return t.eat(",")&&(t.next!="}"?n=X3(t):n=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:e}}function sV(t,e){let r=t.nodeTypes,n=r[e];if(n)return[n];let i=[];for(let a in r){let s=r[a];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function oV(t){if(t.eat("(")){let e=TP(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=sV(t,t.next).map(r=>(t.inline==null?t.inline=r.isInline:t.inline!=r.isInline&&t.err("Mixing inline and block content"),{type:"name",value:r}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function lV(t){let e=[[]];return i(a(t,0),r()),e;function r(){return e.push([])-1}function n(s,o,l){let u={term:l,to:o};return e[s].push(u),u}function i(s,o){s.forEach(l=>l.to=o)}function a(s,o){if(s.type=="choice")return s.exprs.reduce((l,u)=>l.concat(a(u,o)),[]);if(s.type=="seq")for(let l=0;;l++){let u=a(s.exprs[l],o);if(l==s.exprs.length-1)return u;i(u,o=r())}else if(s.type=="star"){let l=r();return n(o,l),i(a(s.expr,l),l),[n(l)]}else if(s.type=="plus"){let l=r();return i(a(s.expr,o),l),i(a(s.expr,l),l),[n(l)]}else{if(s.type=="opt")return[n(o)].concat(a(s.expr,o));if(s.type=="range"){let l=o;for(let u=0;u<s.min;u++){let c=r();i(a(s.expr,l),c),l=c}if(s.max==-1)i(a(s.expr,l),l);else for(let u=s.min;u<s.max;u++){let c=r();n(l,c),i(a(s.expr,l),c),l=c}return[n(l)]}else{if(s.type=="name")return[n(o,void 0,s.value)];throw new Error("Unknown expr type")}}}}function jP(t,e){return e-t}function Q3(t,e){let r=[];return n(e),r.sort(jP);function n(i){let a=t[i];if(a.length==1&&!a[0].term)return n(a[0].to);r.push(i);for(let s=0;s<a.length;s++){let{term:o,to:l}=a[s];!o&&r.indexOf(l)==-1&&n(l)}}}function uV(t){let e=Object.create(null);return r(Q3(t,0));function r(n){let i=[];n.forEach(s=>{t[s].forEach(({term:o,to:l})=>{if(!o)return;let u;for(let c=0;c<i.length;c++)i[c][0]==o&&(u=i[c][1]);Q3(t,l).forEach(c=>{u||i.push([o,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let a=e[n.join(",")]=new md(n.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let o=i[s][1].sort(jP);a.next.push({type:i[s][0],next:e[o.join(",")]||r(o)})}return a}}function cV(t,e){for(let r=0,n=[t];r<n.length;r++){let i=n[r],a=!i.validEnd,s=[];for(let o=0;o<i.next.length;o++){let{type:l,next:u}=i.next[o];s.push(l.name),a&&!(l.isText||l.hasRequiredAttrs())&&(a=!1),n.indexOf(u)==-1&&n.push(u)}a&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function PP(t){let e=Object.create(null);for(let r in t){let n=t[r];if(!n.hasDefault)return null;e[r]=n.default}return e}function MP(t,e){let r=Object.create(null);for(let n in t){let i=e&&e[n];if(i===void 0){let a=t[n];if(a.hasDefault)i=a.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=i}return r}function _P(t,e,r,n){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${r} of type ${i}`);for(let i in t){let a=t[i];a.validate&&a.validate(e[i])}}function AP(t,e){let r=Object.create(null);if(e)for(let n in e)r[n]=new fV(t,n,e[n]);return r}let J3=class RP{constructor(e,r,n){this.name=e,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=AP(e,n.attrs),this.defaultAttrs=PP(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==md.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:MP(this.attrs,e)}create(e=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new cs(this,this.computeAttrs(e),Ve.from(r),Cr.setFrom(n))}createChecked(e=null,r,n){return r=Ve.from(r),this.checkContent(r),new cs(this,this.computeAttrs(e),r,Cr.setFrom(n))}createAndFill(e=null,r,n){if(e=this.computeAttrs(e),r=Ve.from(r),r.size){let s=this.contentMatch.fillBefore(r);if(!s)return null;r=s.append(r)}let i=this.contentMatch.matchFragment(r),a=i&&i.fillBefore(Ve.empty,!0);return a?new cs(this,e,r.append(a),Cr.setFrom(n)):null}validContent(e){let r=this.contentMatch.matchFragment(e);if(!r||!r.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){_P(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let r=0;r<e.length;r++)if(!this.allowsMarkType(e[r].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let r;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?r&&r.push(e[n]):r||(r=e.slice(0,n));return r?r.length?r:Cr.none:e}static compile(e,r){let n=Object.create(null);e.forEach((a,s)=>n[a]=new RP(a,r,s));let i=r.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let a in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function dV(t,e,r){let n=r.split("|");return i=>{let a=i===null?"null":typeof i;if(n.indexOf(a)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${t}, got ${a}`)}}class fV{constructor(e,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?dV(e,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Nx{constructor(e,r,n,i){this.name=e,this.rank=r,this.schema=n,this.spec=i,this.attrs=AP(e,i.attrs),this.excluded=null;let a=PP(this.attrs);this.instance=a?new Cr(this,a):null}create(e=null){return!e&&this.instance?this.instance:new Cr(this,MP(this.attrs,e))}static compile(e,r){let n=Object.create(null),i=0;return e.forEach((a,s)=>n[a]=new Nx(a,i++,r,s)),n}removeFromSet(e){for(var r=0;r<e.length;r++)e[r].type==this&&(e=e.slice(0,r).concat(e.slice(r+1)),r--);return e}isInSet(e){for(let r=0;r<e.length;r++)if(e[r].type==this)return e[r]}checkAttrs(e){_P(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class DP{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let i in e)r[i]=e[i];r.nodes=xi.from(e.nodes),r.marks=xi.from(e.marks||{}),this.nodes=J3.compile(this.spec.nodes,this),this.marks=Nx.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let a=this.nodes[i],s=a.spec.content||"",o=a.spec.marks;if(a.contentMatch=n[s]||(n[s]=md.parse(s,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=o=="_"?null:o?Z3(this,o.split(" ")):o==""||!a.inlineContent?[]:null}for(let i in this.marks){let a=this.marks[i],s=a.spec.excludes;a.excluded=s==null?[a]:s==""?[]:Z3(this,s.split(" "))}this.nodeFromJSON=i=>cs.fromJSON(this,i),this.markFromJSON=i=>Cr.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,r=null,n,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof J3){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(r,n,i)}text(e,r){let n=this.nodes.text;return new hy(n,n.defaultAttrs,e,Cr.setFrom(r))}mark(e,r){return typeof e=="string"&&(e=this.marks[e]),e.create(r)}nodeType(e){let r=this.nodes[e];if(!r)throw new RangeError("Unknown node type: "+e);return r}}function Z3(t,e){let r=[];for(let n=0;n<e.length;n++){let i=e[n],a=t.marks[i],s=a;if(a)r.push(a);else for(let o in t.marks){let l=t.marks[o];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&r.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return r}function hV(t){return t.tag!=null}function pV(t){return t.style!=null}class Du{constructor(e,r){this.schema=e,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(i=>{if(hV(i))this.tags.push(i);else if(pV(i)){let a=/[^=]*/.exec(i.style)[0];n.indexOf(a)<0&&n.push(a),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let a=e.nodes[i.node];return a.contentMatch.matchType(a)})}parse(e,r={}){let n=new t4(this,r,!1);return n.addAll(e,Cr.none,r.from,r.to),n.finish()}parseSlice(e,r={}){let n=new t4(this,r,!0);return n.addAll(e,Cr.none,r.from,r.to),st.maxOpen(n.finish())}matchTag(e,r,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let a=this.tags[i];if(vV(e,a.tag)&&(a.namespace===void 0||e.namespaceURI==a.namespace)&&(!a.context||r.matchesContext(a.context))){if(a.getAttrs){let s=a.getAttrs(e);if(s===!1)continue;a.attrs=s||void 0}return a}}}matchStyle(e,r,n,i){for(let a=i?this.styles.indexOf(i)+1:0;a<this.styles.length;a++){let s=this.styles[a],o=s.style;if(!(o.indexOf(e)!=0||s.context&&!n.matchesContext(s.context)||o.length>e.length&&(o.charCodeAt(e.length)!=61||o.slice(e.length+1)!=r))){if(s.getAttrs){let l=s.getAttrs(r);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let r=[];function n(i){let a=i.priority==null?50:i.priority,s=0;for(;s<r.length;s++){let o=r[s];if((o.priority==null?50:o.priority)<a)break}r.splice(s,0,i)}for(let i in e.marks){let a=e.marks[i].spec.parseDOM;a&&a.forEach(s=>{n(s=r4(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let a=e.nodes[i].spec.parseDOM;a&&a.forEach(s=>{n(s=r4(s)),s.node||s.ignore||s.mark||(s.node=i)})}return r}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Du(e,Du.schemaRules(e)))}}const OP={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},mV={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},IP={ol:!0,ul:!0},dg=1,L2=2,Fm=4;function e4(t,e,r){return e!=null?(e?dg:0)|(e==="full"?L2:0):t&&t.whitespace=="pre"?dg|L2:r&~Fm}class p0{constructor(e,r,n,i,a,s){this.type=e,this.attrs=r,this.marks=n,this.solid=i,this.options=s,this.content=[],this.activeMarks=Cr.none,this.match=a||(s&Fm?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(Ve.from(e));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&dg)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let a=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-i[0].length))}}let r=Ve.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(Ve.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!OP.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class t4{constructor(e,r,n){this.parser=e,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let i=r.topNode,a,s=e4(null,r.preserveWhitespace,0)|(n?Fm:0);i?a=new p0(i.type,i.attrs,Cr.none,!0,r.topMatch||i.type.contentMatch,s):n?a=new p0(null,null,Cr.none,!0,null,s):a=new p0(e.schema.topNodeType,null,Cr.none,!0,null,s),this.nodes=[a],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,r){e.nodeType==3?this.addTextNode(e,r):e.nodeType==1&&this.addElement(e,r)}addTextNode(e,r){let n=e.nodeValue,i=this.top,a=i.options&L2?"full":this.localPreserveWS||(i.options&dg)>0,{schema:s}=this.parser;if(a==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(a)if(a==="full")n=n.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(s.linebreakReplacement.create())){let o=n.split(/\r?\n|\r/);for(let l=0;l<o.length;l++)l&&this.insertNode(s.linebreakReplacement.create(),r,!0),o[l]&&this.insertNode(s.text(o[l]),r,!/\S/.test(o[l]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let o=i.content[i.content.length-1],l=e.previousSibling;(!o||l&&l.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(n=n.slice(1))}n&&this.insertNode(s.text(n),r,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,r,n){let i=this.localPreserveWS,a=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),o;IP.hasOwnProperty(s)&&this.parser.normalizeLists&&gV(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,n));e:if(l?l.ignore:mV.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,r);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let u,c=this.needsBlock;if(OP.hasOwnProperty(s))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),u=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,r);break e}let f=l&&l.skip?r:this.readStyles(e,r);f&&this.addAll(e,f),u&&this.sync(a),this.needsBlock=c}else{let u=this.readStyles(e,r);u&&this.addElementByRule(e,l,u,l.consuming===!1?o:void 0)}this.localPreserveWS=i}leafFallback(e,r){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),r)}ignoreFallback(e,r){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(e,r){let n=e.style;if(n&&n.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let a=this.parser.matchedStyles[i],s=n.getPropertyValue(a);if(s)for(let o=void 0;;){let l=this.parser.matchStyle(a,s,this,o);if(!l)break;if(l.ignore)return null;if(l.clearMark?r=r.filter(u=>!l.clearMark(u)):r=r.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)o=l;else break}}return r}addElementByRule(e,r,n,i){let a,s;if(r.node)if(s=this.parser.schema.nodes[r.node],s.isLeaf)this.insertNode(s.create(r.attrs),n,e.nodeName=="BR")||this.leafFallback(e,n);else{let l=this.enter(s,r.attrs||null,n,r.preserveWhitespace);l&&(a=!0,n=l)}else{let l=this.parser.schema.marks[r.mark];n=n.concat(l.create(r.attrs))}let o=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,n,i);else if(r.getContent)this.findInside(e),r.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,n,!1));else{let l=e;typeof r.contentElement=="string"?l=e.querySelector(r.contentElement):typeof r.contentElement=="function"?l=r.contentElement(e):r.contentElement&&(l=r.contentElement),this.findAround(e,l,!0),this.addAll(l,n),this.findAround(e,l,!1)}a&&this.sync(o)&&this.open--}addAll(e,r,n,i){let a=n||0;for(let s=n?e.childNodes[n]:e.firstChild,o=i==null?null:e.childNodes[i];s!=o;s=s.nextSibling,++a)this.findAtPoint(e,a),this.addDOM(s,r);this.findAtPoint(e,a)}findPlace(e,r,n){let i,a;for(let s=this.open,o=0;s>=0;s--){let l=this.nodes[s],u=l.findWrapping(e);if(u&&(!i||i.length>u.length+o)&&(i=u,a=l,!u.length))break;if(l.solid){if(n)break;o+=2}}if(!i)return null;this.sync(a);for(let s=0;s<i.length;s++)r=this.enterInner(i[s],null,r,!1);return r}insertNode(e,r,n){if(e.isInline&&this.needsBlock&&!this.top.type){let a=this.textblockFromContext();a&&(r=this.enterInner(a,null,r))}let i=this.findPlace(e,r,n);if(i){this.closeExtra();let a=this.top;a.match&&(a.match=a.match.matchType(e.type));let s=Cr.none;for(let o of i.concat(e.marks))(a.type?a.type.allowsMarkType(o.type):n4(o.type,e.type))&&(s=o.addToSet(s));return a.content.push(e.mark(s)),!0}return!1}enter(e,r,n,i){let a=this.findPlace(e.create(r),n,!1);return a&&(a=this.enterInner(e,r,n,!0,i)),a}enterInner(e,r,n,i=!1,a){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let o=e4(e,a,s.options);s.options&Fm&&s.content.length==0&&(o|=Fm);let l=Cr.none;return n=n.filter(u=>(s.type?s.type.allowsMarkType(u.type):n4(u.type,e))?(l=u.addToSet(l),!1):!0),this.nodes.push(new p0(e,r,l,i,null,o)),this.open++,n}closeExtra(e=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let r=this.open;r>=0;r--){if(this.nodes[r]==e)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=dg)}return!1}get currentPos(){this.closeExtra();let e=0;for(let r=this.open;r>=0;r--){let n=this.nodes[r].content;for(let i=n.length-1;i>=0;i--)e+=n[i].nodeSize;r&&e++}return e}findAtPoint(e,r){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==r&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(e,r,n){if(e!=r&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&r.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&(this.find[r].pos=this.currentPos-(e.nodeValue.length-this.find[r].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let r=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),a=-(n?n.depth+1:0)+(i?0:1),s=(o,l)=>{for(;o>=0;o--){let u=r[o];if(u==""){if(o==r.length-1||o==0)continue;for(;l>=a;l--)if(s(o-1,l))return!0;return!1}else{let c=l>0||l==0&&i?this.nodes[l].type:n&&l>=a?n.node(l-a).type:null;if(!c||c.name!=u&&!c.isInGroup(u))return!1;l--}}return!0};return s(r.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let r=e.depth;r>=0;r--){let n=e.node(r).contentMatchAt(e.indexAfter(r)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let r in this.parser.schema.nodes){let n=this.parser.schema.nodes[r];if(n.isTextblock&&n.defaultAttrs)return n}}}function gV(t){for(let e=t.firstChild,r=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&IP.hasOwnProperty(n)&&r?(r.appendChild(e),e=r):n=="li"?r=e:n&&(r=null)}}function vV(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function r4(t){let e={};for(let r in t)e[r]=t[r];return e}function n4(t,e){let r=e.schema.nodes;for(let n in r){let i=r[n];if(!i.allowsMarkType(t))continue;let a=[],s=o=>{a.push(o);for(let l=0;l<o.edgeCount;l++){let{type:u,next:c}=o.edge(l);if(u==e||a.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}class Cd{constructor(e,r){this.nodes=e,this.marks=r}serializeFragment(e,r={},n){n||(n=Pw(r).createDocumentFragment());let i=n,a=[];return e.forEach(s=>{if(a.length||s.marks.length){let o=0,l=0;for(;o<a.length&&l<s.marks.length;){let u=s.marks[l];if(!this.marks[u.type.name]){l++;continue}if(!u.eq(a[o][0])||u.type.spec.spanning===!1)break;o++,l++}for(;o<a.length;)i=a.pop()[1];for(;l<s.marks.length;){let u=s.marks[l++],c=this.serializeMark(u,s.isInline,r);c&&(a.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,r))}),n}serializeNodeInner(e,r){let{dom:n,contentDOM:i}=z0(Pw(r),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,r,i)}return n}serializeNode(e,r={}){let n=this.serializeNodeInner(e,r);for(let i=e.marks.length-1;i>=0;i--){let a=this.serializeMark(e.marks[i],e.isInline,r);a&&((a.contentDOM||a.dom).appendChild(n),n=a.dom)}return n}serializeMark(e,r,n={}){let i=this.marks[e.type.name];return i&&z0(Pw(n),i(e,r),null,e.attrs)}static renderSpec(e,r,n=null,i){return z0(e,r,n,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Cd(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let r=i4(e.nodes);return r.text||(r.text=n=>n.text),r}static marksFromSchema(e){return i4(e.marks)}}function i4(t){let e={};for(let r in t){let n=t[r].spec.toDOM;n&&(e[r]=n)}return e}function Pw(t){return t.document||window.document}const a4=new WeakMap;function yV(t){let e=a4.get(t);return e===void 0&&a4.set(t,e=xV(t)),e}function xV(t){let e=null;function r(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")e||(e=[]),e.push(n);else for(let i=0;i<n.length;i++)r(n[i]);else for(let i in n)r(n[i])}return r(t),e}function z0(t,e,r,n){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],a;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(a=yV(n))&&a.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,l=r?t.createElementNS(r,i):t.createElement(i),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let f in u)if(u[f]!=null){let m=f.indexOf(" ");m>0?l.setAttributeNS(f.slice(0,m),f.slice(m+1),u[f]):f=="style"&&l.style?l.style.cssText=u[f]:l.setAttribute(f,u[f])}}for(let f=c;f<e.length;f++){let m=e[f];if(m===0){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:g,contentDOM:y}=z0(t,m,r,n);if(l.appendChild(g),y){if(o)throw new RangeError("Multiple content holes");o=y}}}return{dom:l,contentDOM:o}}const LP=65535,BP=Math.pow(2,16);function bV(t,e){return t+e*BP}function s4(t){return t&LP}function wV(t){return(t-(t&LP))/BP}const FP=1,zP=2,V0=4,VP=8;class B2{constructor(e,r,n){this.pos=e,this.delInfo=r,this.recover=n}get deleted(){return(this.delInfo&VP)>0}get deletedBefore(){return(this.delInfo&(FP|V0))>0}get deletedAfter(){return(this.delInfo&(zP|V0))>0}get deletedAcross(){return(this.delInfo&V0)>0}}class Ba{constructor(e,r=!1){if(this.ranges=e,this.inverted=r,!e.length&&Ba.empty)return Ba.empty}recover(e){let r=0,n=s4(e);if(!this.inverted)for(let i=0;i<n;i++)r+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[n*3]+r+wV(e)}mapResult(e,r=1){return this._map(e,r,!1)}map(e,r=1){return this._map(e,r,!0)}_map(e,r,n){let i=0,a=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?i:0);if(l>e)break;let u=this.ranges[o+a],c=this.ranges[o+s],f=l+u;if(e<=f){let m=u?e==l?-1:e==f?1:r:r,g=l+i+(m<0?0:c);if(n)return g;let y=e==(r<0?l:f)?null:bV(o/3,e-l),b=e==l?zP:e==f?FP:V0;return(r<0?e!=l:e!=f)&&(b|=VP),new B2(g,b,y)}i+=c-u}return n?e+i:new B2(e+i,0,null)}touches(e,r){let n=0,i=s4(r),a=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?n:0);if(l>e)break;let u=this.ranges[o+a],c=l+u;if(e<=c&&o==i*3)return!0;n+=this.ranges[o+s]-u}return!1}forEach(e){let r=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,a=0;i<this.ranges.length;i+=3){let s=this.ranges[i],o=s-(this.inverted?a:0),l=s+(this.inverted?0:a),u=this.ranges[i+r],c=this.ranges[i+n];e(o,o+u,l,l+c),a+=c-u}}invert(){return new Ba(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Ba.empty:new Ba(e<0?[0,-e,0]:[0,0,e])}}Ba.empty=new Ba([]);class fg{constructor(e,r,n=0,i=e?e.length:0){this.mirror=r,this.from=n,this.to=i,this._maps=e||[],this.ownData=!(e||r)}get maps(){return this._maps}slice(e=0,r=this.maps.length){return new fg(this._maps,this.mirror,e,r)}appendMap(e,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(e){for(let r=0,n=this._maps.length;r<e._maps.length;r++){let i=e.getMirror(r);this.appendMap(e._maps[r],i!=null&&i<r?n+i:void 0)}}getMirror(e){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==e)return this.mirror[r+(r%2?-1:1)]}}setMirror(e,r){this.mirror||(this.mirror=[]),this.mirror.push(e,r)}appendMappingInverted(e){for(let r=e.maps.length-1,n=this._maps.length+e._maps.length;r>=0;r--){let i=e.getMirror(r);this.appendMap(e._maps[r].invert(),i!=null&&i>r?n-i-1:void 0)}}invert(){let e=new fg;return e.appendMappingInverted(this),e}map(e,r=1){if(this.mirror)return this._map(e,r,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,r);return e}mapResult(e,r=1){return this._map(e,r,!1)}_map(e,r,n){let i=0;for(let a=this.from;a<this.to;a++){let s=this._maps[a],o=s.mapResult(e,r);if(o.recover!=null){let l=this.getMirror(a);if(l!=null&&l>a&&l<this.to){a=l,e=this._maps[l].recover(o.recover);continue}}i|=o.delInfo,e=o.pos}return n?e:new B2(e,i,null)}}const Mw=Object.create(null);class Bi{getMap(){return Ba.empty}merge(e){return null}static fromJSON(e,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Mw[r.stepType];if(!n)throw new RangeError(`No step type ${r.stepType} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in Mw)throw new RangeError("Duplicate use of step JSON ID "+e);return Mw[e]=r,r.prototype.jsonID=e,r}}class Mn{constructor(e,r){this.doc=e,this.failed=r}static ok(e){return new Mn(e,null)}static fail(e){return new Mn(null,e)}static fromReplace(e,r,n,i){try{return Mn.ok(e.replace(r,n,i))}catch(a){if(a instanceof cy)return Mn.fail(a.message);throw a}}}function ZS(t,e,r){let n=[];for(let i=0;i<t.childCount;i++){let a=t.child(i);a.content.size&&(a=a.copy(ZS(a.content,e,a))),a.isInline&&(a=e(a,r,i)),n.push(a)}return Ve.fromArray(n)}class ju extends Bi{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),a=new st(ZS(r.content,(s,o)=>!s.isAtom||!o.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),r.openStart,r.openEnd);return Mn.fromReplace(e,this.from,this.to,a)}invert(){return new Is(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new ju(r.pos,n.pos,this.mark)}merge(e){return e instanceof ju&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ju(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ju(r.from,r.to,e.markFromJSON(r.mark))}}Bi.jsonID("addMark",ju);class Is extends Bi{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=new st(ZS(r.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),r.openStart,r.openEnd);return Mn.fromReplace(e,this.from,this.to,n)}invert(){return new ju(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new Is(r.pos,n.pos,this.mark)}merge(e){return e instanceof Is&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Is(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Is(r.from,r.to,e.markFromJSON(r.mark))}}Bi.jsonID("removeMark",Is);class Pu extends Bi{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return Mn.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return Mn.fromReplace(e,this.pos,this.pos+1,new st(Ve.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);if(r){let n=this.mark.addToSet(r.marks);if(n.length==r.marks.length){for(let i=0;i<r.marks.length;i++)if(!r.marks[i].isInSet(n))return new Pu(this.pos,r.marks[i]);return new Pu(this.pos,this.mark)}}return new gd(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new Pu(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Pu(r.pos,e.markFromJSON(r.mark))}}Bi.jsonID("addNodeMark",Pu);class gd extends Bi{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return Mn.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return Mn.fromReplace(e,this.pos,this.pos+1,new st(Ve.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new Pu(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new gd(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new gd(r.pos,e.markFromJSON(r.mark))}}Bi.jsonID("removeNodeMark",gd);class ei extends Bi{constructor(e,r,n,i=!1){super(),this.from=e,this.to=r,this.slice=n,this.structure=i}apply(e){return this.structure&&F2(e,this.from,this.to)?Mn.fail("Structure replace would overwrite content"):Mn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Ba([this.from,this.to-this.from,this.slice.size])}invert(e){return new ei(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deletedAcross&&n.deletedAcross?null:new ei(r.pos,Math.max(r.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof ei)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let r=this.slice.size+e.slice.size==0?st.empty:new st(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ei(this.from,this.to+(e.to-e.from),r,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let r=this.slice.size+e.slice.size==0?st.empty:new st(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ei(e.from,this.to,r,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ei(r.from,r.to,st.fromJSON(e,r.slice),!!r.structure)}}Bi.jsonID("replace",ei);class ni extends Bi{constructor(e,r,n,i,a,s,o=!1){super(),this.from=e,this.to=r,this.gapFrom=n,this.gapTo=i,this.slice=a,this.insert=s,this.structure=o}apply(e){if(this.structure&&(F2(e,this.from,this.gapFrom)||F2(e,this.gapTo,this.to)))return Mn.fail("Structure gap-replace would overwrite content");let r=e.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return Mn.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,r.content);return n?Mn.fromReplace(e,this.from,this.to,n):Mn.fail("Content does not fit in gap")}getMap(){return new Ba([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let r=this.gapTo-this.gapFrom;return new ni(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=this.from==this.gapFrom?r.pos:e.map(this.gapFrom,-1),a=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return r.deletedAcross&&n.deletedAcross||i<r.pos||a>n.pos?null:new ni(r.pos,n.pos,i,a,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ni(r.from,r.to,r.gapFrom,r.gapTo,st.fromJSON(e,r.slice),r.insert,!!r.structure)}}Bi.jsonID("replaceAround",ni);function F2(t,e,r){let n=t.resolve(e),i=r-e,a=n.depth;for(;i>0&&a>0&&n.indexAfter(a)==n.node(a).childCount;)a--,i--;if(i>0){let s=n.node(a).maybeChild(n.indexAfter(a));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function SV(t,e,r,n){let i=[],a=[],s,o;t.doc.nodesBetween(e,r,(l,u,c)=>{if(!l.isInline)return;let f=l.marks;if(!n.isInSet(f)&&c.type.allowsMarkType(n.type)){let m=Math.max(u,e),g=Math.min(u+l.nodeSize,r),y=n.addToSet(f);for(let b=0;b<f.length;b++)f[b].isInSet(y)||(s&&s.to==m&&s.mark.eq(f[b])?s.to=g:i.push(s=new Is(m,g,f[b])));o&&o.to==m?o.to=g:a.push(o=new ju(m,g,n))}}),i.forEach(l=>t.step(l)),a.forEach(l=>t.step(l))}function kV(t,e,r,n){let i=[],a=0;t.doc.nodesBetween(e,r,(s,o)=>{if(!s.isInline)return;a++;let l=null;if(n instanceof Nx){let u=s.marks,c;for(;c=n.isInSet(u);)(l||(l=[])).push(c),u=c.removeFromSet(u)}else n?n.isInSet(s.marks)&&(l=[n]):l=s.marks;if(l&&l.length){let u=Math.min(o+s.nodeSize,r);for(let c=0;c<l.length;c++){let f=l[c],m;for(let g=0;g<i.length;g++){let y=i[g];y.step==a-1&&f.eq(i[g].style)&&(m=y)}m?(m.to=u,m.step=a):i.push({style:f,from:Math.max(o,e),to:u,step:a})}}}),i.forEach(s=>t.step(new Is(s.from,s.to,s.style)))}function ek(t,e,r,n=r.contentMatch,i=!0){let a=t.doc.nodeAt(e),s=[],o=e+1;for(let l=0;l<a.childCount;l++){let u=a.child(l),c=o+u.nodeSize,f=n.matchType(u.type);if(!f)s.push(new ei(o,c,st.empty));else{n=f;for(let m=0;m<u.marks.length;m++)r.allowsMarkType(u.marks[m].type)||t.step(new Is(o,c,u.marks[m]));if(i&&u.isText&&r.whitespace!="pre"){let m,g=/\r?\n|\r/g,y;for(;m=g.exec(u.text);)y||(y=new st(Ve.from(r.schema.text(" ",r.allowedMarks(u.marks))),0,0)),s.push(new ei(o+m.index,o+m.index+m[0].length,y))}}o=c}if(!n.validEnd){let l=n.fillBefore(Ve.empty,!0);t.replace(o,o,new st(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function CV(t,e,r){return(e==0||t.canReplace(e,t.childCount))&&(r==t.childCount||t.canReplace(0,r))}function Eh(t){let r=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth,i=0,a=0;;--n){let s=t.$from.node(n),o=t.$from.index(n)+i,l=t.$to.indexAfter(n)-a;if(n<t.depth&&s.canReplace(o,l,r))return n;if(n==0||s.type.spec.isolating||!CV(s,o,l))break;o&&(i=1),l<s.childCount&&(a=1)}return null}function NV(t,e,r){let{$from:n,$to:i,depth:a}=e,s=n.before(a+1),o=i.after(a+1),l=s,u=o,c=Ve.empty,f=0;for(let y=a,b=!1;y>r;y--)b||n.index(y)>0?(b=!0,c=Ve.from(n.node(y).copy(c)),f++):l--;let m=Ve.empty,g=0;for(let y=a,b=!1;y>r;y--)b||i.after(y+1)<i.end(y)?(b=!0,m=Ve.from(i.node(y).copy(m)),g++):u++;t.step(new ni(l,u,s,o,new st(c.append(m),f,g),c.size-f,!0))}function tk(t,e,r=null,n=t){let i=EV(t,e),a=i&&TV(n,e);return a?i.map(o4).concat({type:e,attrs:r}).concat(a.map(o4)):null}function o4(t){return{type:t,attrs:null}}function EV(t,e){let{parent:r,startIndex:n,endIndex:i}=t,a=r.contentMatchAt(n).findWrapping(e);if(!a)return null;let s=a.length?a[0]:e;return r.canReplaceWith(n,i,s)?a:null}function TV(t,e){let{parent:r,startIndex:n,endIndex:i}=t,a=r.child(n),s=e.contentMatch.findWrapping(a.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let u=n;l&&u<i;u++)l=l.matchType(r.child(u).type);return!l||!l.validEnd?null:s}function jV(t,e,r){let n=Ve.empty;for(let s=r.length-1;s>=0;s--){if(n.size){let o=r[s].type.contentMatch.matchFragment(n);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Ve.from(r[s].type.create(r[s].attrs,n))}let i=e.start,a=e.end;t.step(new ni(i,a,i,a,new st(n,0,0),r.length,!0))}function PV(t,e,r,n,i){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=t.steps.length;t.doc.nodesBetween(e,r,(s,o)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(n,l)&&MV(t.doc,t.mapping.slice(a).map(o),n)){let u=null;if(n.schema.linebreakReplacement){let g=n.whitespace=="pre",y=!!n.contentMatch.matchType(n.schema.linebreakReplacement);g&&!y?u=!1:!g&&y&&(u=!0)}u===!1&&GP(t,s,o,a),ek(t,t.mapping.slice(a).map(o,1),n,void 0,u===null);let c=t.mapping.slice(a),f=c.map(o,1),m=c.map(o+s.nodeSize,1);return t.step(new ni(f,m,f+1,m-1,new st(Ve.from(n.create(l,null,s.marks)),0,0),1,!0)),u===!0&&UP(t,s,o,a),!1}})}function UP(t,e,r,n){e.forEach((i,a)=>{if(i.isText){let s,o=/\r?\n|\r/g;for(;s=o.exec(i.text);){let l=t.mapping.slice(n).map(r+1+a+s.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function GP(t,e,r,n){e.forEach((i,a)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(n).map(r+1+a);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function MV(t,e,r){let n=t.resolve(e),i=n.index();return n.parent.canReplaceWith(i,i+1,r)}function _V(t,e,r,n,i){let a=t.doc.nodeAt(e);if(!a)throw new RangeError("No node at given position");r||(r=a.type);let s=r.create(n,null,i||a.marks);if(a.isLeaf)return t.replaceWith(e,e+a.nodeSize,s);if(!r.validContent(a.content))throw new RangeError("Invalid content for node type "+r.name);t.step(new ni(e,e+a.nodeSize,e+1,e+a.nodeSize-1,new st(Ve.from(s),0,0),1,!0))}function dl(t,e,r=1,n){let i=t.resolve(e),a=i.depth-r,s=n&&n[n.length-1]||i.parent;if(a<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=r-2;u>a;u--,c--){let f=i.node(u),m=i.index(u);if(f.type.spec.isolating)return!1;let g=f.content.cutByIndex(m,f.childCount),y=n&&n[c+1];y&&(g=g.replaceChild(0,y.type.create(y.attrs)));let b=n&&n[c]||f;if(!f.canReplace(m+1,f.childCount)||!b.type.validContent(g))return!1}let o=i.indexAfter(a),l=n&&n[0];return i.node(a).canReplaceWith(o,o,l?l.type:i.node(a+1).type)}function AV(t,e,r=1,n){let i=t.doc.resolve(e),a=Ve.empty,s=Ve.empty;for(let o=i.depth,l=i.depth-r,u=r-1;o>l;o--,u--){a=Ve.from(i.node(o).copy(a));let c=n&&n[u];s=Ve.from(c?c.type.create(c.attrs,s):i.node(o).copy(s))}t.step(new ei(e,e,new st(a.append(s),r,r),!0))}function ec(t,e){let r=t.resolve(e),n=r.index();return HP(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function RV(t,e){e.content.size||t.type.compatibleContent(e.type);let r=t.contentMatchAt(t.childCount),{linebreakReplacement:n}=t.type.schema;for(let i=0;i<e.childCount;i++){let a=e.child(i),s=a.type==n?t.type.schema.nodes.text:a.type;if(r=r.matchType(s),!r||!t.type.allowsMarks(a.marks))return!1}return r.validEnd}function HP(t,e){return!!(t&&e&&!t.isLeaf&&RV(t,e))}function Ex(t,e,r=-1){let n=t.resolve(e);for(let i=n.depth;;i--){let a,s,o=n.index(i);if(i==n.depth?(a=n.nodeBefore,s=n.nodeAfter):r>0?(a=n.node(i+1),o++,s=n.node(i).maybeChild(o)):(a=n.node(i).maybeChild(o-1),s=n.node(i+1)),a&&!a.isTextblock&&HP(a,s)&&n.node(i).canReplace(o,o+1))return e;if(i==0)break;e=r<0?n.before(i):n.after(i)}}function DV(t,e,r){let n=null,{linebreakReplacement:i}=t.doc.type.schema,a=t.doc.resolve(e-r),s=a.node().type;if(i&&s.inlineContent){let c=s.whitespace=="pre",f=!!s.contentMatch.matchType(i);c&&!f?n=!1:!c&&f&&(n=!0)}let o=t.steps.length;if(n===!1){let c=t.doc.resolve(e+r);GP(t,c.node(),c.before(),o)}s.inlineContent&&ek(t,e+r-1,s,a.node().contentMatchAt(a.index()),n==null);let l=t.mapping.slice(o),u=l.map(e-r);if(t.step(new ei(u,l.map(e+r,-1),st.empty,!0)),n===!0){let c=t.doc.resolve(u);UP(t,c.node(),c.before(),t.steps.length)}return t}function OV(t,e,r){let n=t.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),r))return e;if(n.parentOffset==0)for(let i=n.depth-1;i>=0;i--){let a=n.index(i);if(n.node(i).canReplaceWith(a,a,r))return n.before(i+1);if(a>0)return null}if(n.parentOffset==n.parent.content.size)for(let i=n.depth-1;i>=0;i--){let a=n.indexAfter(i);if(n.node(i).canReplaceWith(a,a,r))return n.after(i+1);if(a<n.node(i).childCount)return null}return null}function qP(t,e,r){let n=t.resolve(e);if(!r.content.size)return e;let i=r.content;for(let a=0;a<r.openStart;a++)i=i.firstChild.content;for(let a=1;a<=(r.openStart==0&&r.size?2:1);a++)for(let s=n.depth;s>=0;s--){let o=s==n.depth?0:n.pos<=(n.start(s+1)+n.end(s+1))/2?-1:1,l=n.index(s)+(o>0?1:0),u=n.node(s),c=!1;if(a==1)c=u.canReplace(l,l,i);else{let f=u.contentMatchAt(l).findWrapping(i.firstChild.type);c=f&&u.canReplaceWith(l,l,f[0])}if(c)return o==0?n.pos:o<0?n.before(s+1):n.after(s+1)}return null}function Tx(t,e,r=e,n=st.empty){if(e==r&&!n.size)return null;let i=t.resolve(e),a=t.resolve(r);return WP(i,a,n)?new ei(e,r,n):new IV(i,a,n).fit()}function WP(t,e,r){return!r.openStart&&!r.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),r.content)}class IV{constructor(e,r,n){this.$from=e,this.$to=r,this.unplaced=n,this.frontier=[],this.placed=Ve.empty;for(let i=0;i<=e.depth;i++){let a=e.node(i);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=Ve.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let a=this.placed,s=n.depth,o=i.depth;for(;s&&o&&a.childCount==1;)a=a.firstChild.content,s--,o--;let l=new st(a,s,o);return e>-1?new ni(n.pos,e,this.$to.pos,this.$to.end(),l,r):l.size||n.pos!=this.$to.pos?new ei(n.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let r=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let a=r.firstChild;if(r.childCount>1&&(i=0),a.type.spec.isolating&&i<=n){e=n;break}r=a.content}for(let r=1;r<=2;r++)for(let n=r==1?e:this.unplaced.openStart;n>=0;n--){let i,a=null;n?(a=_w(this.unplaced.content,n-1).firstChild,i=a.content):i=this.unplaced.content;let s=i.firstChild;for(let o=this.depth;o>=0;o--){let{type:l,match:u}=this.frontier[o],c,f=null;if(r==1&&(s?u.matchType(s.type)||(f=u.fillBefore(Ve.from(s),!1)):a&&l.compatibleContent(a.type)))return{sliceDepth:n,frontierDepth:o,parent:a,inject:f};if(r==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:o,parent:a,wrap:c};if(a&&u.matchType(a.type))break}}}openMore(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=_w(e,r);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new st(e,r+1,Math.max(n,i.size+r>=e.size-n?r+1:0)),!0)}dropNode(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=_w(e,r);if(i.childCount<=1&&r>0){let a=e.size-r<=r+i.size;this.unplaced=new st(_m(e,r-1,1),r-1,a?r-1:n)}else this.unplaced=new st(_m(e,r,1),r,n)}placeNodes({sliceDepth:e,frontierDepth:r,parent:n,inject:i,wrap:a}){for(;this.depth>r;)this.closeFrontierNode();if(a)for(let b=0;b<a.length;b++)this.openFrontierNode(a[b]);let s=this.unplaced,o=n?n.content:s.content,l=s.openStart-e,u=0,c=[],{match:f,type:m}=this.frontier[r];if(i){for(let b=0;b<i.childCount;b++)c.push(i.child(b));f=f.matchFragment(i)}let g=o.size+e-(s.content.size-s.openEnd);for(;u<o.childCount;){let b=o.child(u),w=f.matchType(b.type);if(!w)break;u++,(u>1||l==0||b.content.size)&&(f=w,c.push($P(b.mark(m.allowedMarks(b.marks)),u==1?l:0,u==o.childCount?g:-1)))}let y=u==o.childCount;y||(g=-1),this.placed=Am(this.placed,r,Ve.from(c)),this.frontier[r].match=f,y&&g<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let b=0,w=o;b<g;b++){let N=w.lastChild;this.frontier.push({type:N.type,match:N.contentMatchAt(N.childCount)}),w=N.content}this.unplaced=y?e==0?st.empty:new st(_m(s.content,e-1,1),e-1,g<0?s.openEnd:e-1):new st(_m(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],r;if(!e.type.isTextblock||!Aw(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let r=Math.min(this.depth,e.depth);r>=0;r--){let{match:n,type:i}=this.frontier[r],a=r<e.depth&&e.end(r+1)==e.pos+(e.depth-(r+1)),s=Aw(e,r,i,n,a);if(s){for(let o=r-1;o>=0;o--){let{match:l,type:u}=this.frontier[o],c=Aw(e,o,u,l,!0);if(!c||c.childCount)continue e}return{depth:r,fit:s,move:a?e.doc.resolve(e.after(r+1)):e}}}}close(e){let r=this.findCloseLevel(e);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=Am(this.placed,r.depth,r.fit)),e=r.move;for(let n=r.depth+1;n<=e.depth;n++){let i=e.node(n),a=i.type.contentMatch.fillBefore(i.content,!0,e.index(n));this.openFrontierNode(i.type,i.attrs,a)}return e}openFrontierNode(e,r=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Am(this.placed,this.depth,Ve.from(e.create(r,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(Ve.empty,!0);r.childCount&&(this.placed=Am(this.placed,this.frontier.length,r))}}function _m(t,e,r){return e==0?t.cutByIndex(r,t.childCount):t.replaceChild(0,t.firstChild.copy(_m(t.firstChild.content,e-1,r)))}function Am(t,e,r){return e==0?t.append(r):t.replaceChild(t.childCount-1,t.lastChild.copy(Am(t.lastChild.content,e-1,r)))}function _w(t,e){for(let r=0;r<e;r++)t=t.firstChild.content;return t}function $P(t,e,r){if(e<=0)return t;let n=t.content;return e>1&&(n=n.replaceChild(0,$P(n.firstChild,e-1,n.childCount==1?r-1:0))),e>0&&(n=t.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(t.type.contentMatch.matchFragment(n).fillBefore(Ve.empty,!0)))),t.copy(n)}function Aw(t,e,r,n,i){let a=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==a.childCount&&!r.compatibleContent(a.type))return null;let o=n.fillBefore(a.content,!0,s);return o&&!LV(r,a.content,s)?o:null}function LV(t,e,r){for(let n=r;n<e.childCount;n++)if(!t.allowsMarks(e.child(n).marks))return!0;return!1}function BV(t){return t.spec.defining||t.spec.definingForContent}function FV(t,e,r,n){if(!n.size)return t.deleteRange(e,r);let i=t.doc.resolve(e),a=t.doc.resolve(r);if(WP(i,a,n))return t.step(new ei(e,r,n));let s=YP(i,a);s[s.length-1]==0&&s.pop();let o=-(i.depth+1);s.unshift(o);for(let m=i.depth,g=i.pos-1;m>0;m--,g--){let y=i.node(m).type.spec;if(y.defining||y.definingAsContext||y.isolating)break;s.indexOf(m)>-1?o=m:i.before(m)==g&&s.splice(1,0,-m)}let l=s.indexOf(o),u=[],c=n.openStart;for(let m=n.content,g=0;;g++){let y=m.firstChild;if(u.push(y),g==n.openStart)break;m=y.content}for(let m=c-1;m>=0;m--){let g=u[m],y=BV(g.type);if(y&&!g.sameMarkup(i.node(Math.abs(o)-1)))c=m;else if(y||!g.type.isTextblock)break}for(let m=n.openStart;m>=0;m--){let g=(m+c+1)%(n.openStart+1),y=u[g];if(y)for(let b=0;b<s.length;b++){let w=s[(b+l)%s.length],N=!0;w<0&&(N=!1,w=-w);let k=i.node(w-1),C=i.index(w-1);if(k.canReplaceWith(C,C,y.type,y.marks))return t.replace(i.before(w),N?a.after(w):r,new st(KP(n.content,0,n.openStart,g),g,n.openEnd))}}let f=t.steps.length;for(let m=s.length-1;m>=0&&(t.replace(e,r,n),!(t.steps.length>f));m--){let g=s[m];g<0||(e=i.before(g),r=a.after(g))}}function KP(t,e,r,n,i){if(e<r){let a=t.firstChild;t=t.replaceChild(0,a.copy(KP(a.content,e+1,r,n,a)))}if(e>n){let a=i.contentMatchAt(0),s=a.fillBefore(t).append(t);t=s.append(a.matchFragment(s).fillBefore(Ve.empty,!0))}return t}function zV(t,e,r,n){if(!n.isInline&&e==r&&t.doc.resolve(e).parent.content.size){let i=OV(t.doc,e,n.type);i!=null&&(e=r=i)}t.replaceRange(e,r,new st(Ve.from(n),0,0))}function VV(t,e,r){let n=t.doc.resolve(e),i=t.doc.resolve(r),a=YP(n,i);for(let s=0;s<a.length;s++){let o=a[s],l=s==a.length-1;if(l&&o==0||n.node(o).type.contentMatch.validEnd)return t.delete(n.start(o),i.end(o));if(o>0&&(l||n.node(o-1).canReplace(n.index(o-1),i.indexAfter(o-1))))return t.delete(n.before(o),i.after(o))}for(let s=1;s<=n.depth&&s<=i.depth;s++)if(e-n.start(s)==n.depth-s&&r>n.end(s)&&i.end(s)-r!=i.depth-s&&n.start(s-1)==i.start(s-1)&&n.node(s-1).canReplace(n.index(s-1),i.index(s-1)))return t.delete(n.before(s),r);t.delete(e,r)}function YP(t,e){let r=[],n=Math.min(t.depth,e.depth);for(let i=n;i>=0;i--){let a=t.start(i);if(a<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(a==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==a-1)&&r.push(i)}return r}class Zf extends Bi{constructor(e,r,n){super(),this.pos=e,this.attr=r,this.value=n}apply(e){let r=e.nodeAt(this.pos);if(!r)return Mn.fail("No node at attribute step's position");let n=Object.create(null);for(let a in r.attrs)n[a]=r.attrs[a];n[this.attr]=this.value;let i=r.type.create(n,null,r.marks);return Mn.fromReplace(e,this.pos,this.pos+1,new st(Ve.from(i),0,r.isLeaf?0:1))}getMap(){return Ba.empty}invert(e){return new Zf(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new Zf(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Zf(r.pos,r.attr,r.value)}}Bi.jsonID("attr",Zf);class hg extends Bi{constructor(e,r){super(),this.attr=e,this.value=r}apply(e){let r=Object.create(null);for(let i in e.attrs)r[i]=e.attrs[i];r[this.attr]=this.value;let n=e.type.create(r,e.content,e.marks);return Mn.ok(n)}getMap(){return Ba.empty}invert(e){return new hg(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new hg(r.attr,r.value)}}Bi.jsonID("docAttr",hg);let ah=class extends Error{};ah=function t(e){let r=Error.call(this,e);return r.__proto__=t.prototype,r};ah.prototype=Object.create(Error.prototype);ah.prototype.constructor=ah;ah.prototype.name="TransformError";class XP{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new fg}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let r=this.maybeStep(e);if(r.failed)throw new ah(r.failed);return this}maybeStep(e){let r=e.apply(this.doc);return r.failed||this.addStep(e,r.doc),r}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,r=-1e9;for(let n=0;n<this.mapping.maps.length;n++){let i=this.mapping.maps[n];n&&(e=i.map(e,1),r=i.map(r,-1)),i.forEach((a,s,o,l)=>{e=Math.min(e,o),r=Math.max(r,l)})}return e==1e9?null:{from:e,to:r}}addStep(e,r){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=r}replace(e,r=e,n=st.empty){let i=Tx(this.doc,e,r,n);return i&&this.step(i),this}replaceWith(e,r,n){return this.replace(e,r,new st(Ve.from(n),0,0))}delete(e,r){return this.replace(e,r,st.empty)}insert(e,r){return this.replaceWith(e,e,r)}replaceRange(e,r,n){return FV(this,e,r,n),this}replaceRangeWith(e,r,n){return zV(this,e,r,n),this}deleteRange(e,r){return VV(this,e,r),this}lift(e,r){return NV(this,e,r),this}join(e,r=1){return DV(this,e,r),this}wrap(e,r){return jV(this,e,r),this}setBlockType(e,r=e,n,i=null){return PV(this,e,r,n,i),this}setNodeMarkup(e,r,n=null,i){return _V(this,e,r,n,i),this}setNodeAttribute(e,r,n){return this.step(new Zf(e,r,n)),this}setDocAttribute(e,r){return this.step(new hg(e,r)),this}addNodeMark(e,r){return this.step(new Pu(e,r)),this}removeNodeMark(e,r){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(r instanceof Cr)r.isInSet(n.marks)&&this.step(new gd(e,r));else{let i=n.marks,a,s=[];for(;a=r.isInSet(i);)s.push(new gd(e,a)),i=a.removeFromSet(i);for(let o=s.length-1;o>=0;o--)this.step(s[o])}return this}split(e,r=1,n){return AV(this,e,r,n),this}addMark(e,r,n){return SV(this,e,r,n),this}removeMark(e,r,n){return kV(this,e,r,n),this}clearIncompatible(e,r,n){return ek(this,e,r,n),this}}const Rw=Object.create(null);class Ft{constructor(e,r,n){this.$anchor=e,this.$head=r,this.ranges=n||[new UV(e.min(r),e.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let r=0;r<e.length;r++)if(e[r].$from.pos!=e[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,r=st.empty){let n=r.content.lastChild,i=null;for(let o=0;o<r.openEnd;o++)i=n,n=n.lastChild;let a=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:l,$to:u}=s[o],c=e.mapping.slice(a);e.replaceRange(c.map(l.pos),c.map(u.pos),o?st.empty:r),o==0&&c4(e,a,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,r){let n=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:s,$to:o}=i[a],l=e.mapping.slice(n),u=l.map(s.pos),c=l.map(o.pos);a?e.deleteRange(u,c):(e.replaceRangeWith(u,c,r),c4(e,n,r.isInline?-1:1))}}static findFrom(e,r,n=!1){let i=e.parent.inlineContent?new Dt(e):Ff(e.node(0),e.parent,e.pos,e.index(),r,n);if(i)return i;for(let a=e.depth-1;a>=0;a--){let s=r<0?Ff(e.node(0),e.node(a),e.before(a+1),e.index(a),r,n):Ff(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,r,n);if(s)return s}return null}static near(e,r=1){return this.findFrom(e,r)||this.findFrom(e,-r)||new za(e.node(0))}static atStart(e){return Ff(e,e,0,0,1)||new za(e)}static atEnd(e){return Ff(e,e,e.content.size,e.childCount,-1)||new za(e)}static fromJSON(e,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=Rw[r.type];if(!n)throw new RangeError(`No selection type ${r.type} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in Rw)throw new RangeError("Duplicate use of selection JSON ID "+e);return Rw[e]=r,r.prototype.jsonID=e,r}getBookmark(){return Dt.between(this.$anchor,this.$head).getBookmark()}}Ft.prototype.visible=!0;class UV{constructor(e,r){this.$from=e,this.$to=r}}let l4=!1;function u4(t){!l4&&!t.parent.inlineContent&&(l4=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Dt extends Ft{constructor(e,r=e){u4(e),u4(r),super(e,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,r){let n=e.resolve(r.map(this.head));if(!n.parent.inlineContent)return Ft.near(n);let i=e.resolve(r.map(this.anchor));return new Dt(i.parent.inlineContent?i:n,n)}replace(e,r=st.empty){if(super.replace(e,r),r==st.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof Dt&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new jx(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Dt(e.resolve(r.anchor),e.resolve(r.head))}static create(e,r,n=r){let i=e.resolve(r);return new this(i,n==r?i:e.resolve(n))}static between(e,r,n){let i=e.pos-r.pos;if((!n||i)&&(n=i>=0?1:-1),!r.parent.inlineContent){let a=Ft.findFrom(r,n,!0)||Ft.findFrom(r,-n,!0);if(a)r=a.$head;else return Ft.near(r,n)}return e.parent.inlineContent||(i==0?e=r:(e=(Ft.findFrom(e,-n,!0)||Ft.findFrom(e,n,!0)).$anchor,e.pos<r.pos!=i<0&&(e=r))),new Dt(e,r)}}Ft.jsonID("text",Dt);class jx{constructor(e,r){this.anchor=e,this.head=r}map(e){return new jx(e.map(this.anchor),e.map(this.head))}resolve(e){return Dt.between(e.resolve(this.anchor),e.resolve(this.head))}}class wt extends Ft{constructor(e){let r=e.nodeAfter,n=e.node(0).resolve(e.pos+r.nodeSize);super(e,n),this.node=r}map(e,r){let{deleted:n,pos:i}=r.mapResult(this.anchor),a=e.resolve(i);return n?Ft.near(a):new wt(a)}content(){return new st(Ve.from(this.node),0,0)}eq(e){return e instanceof wt&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new rk(this.anchor)}static fromJSON(e,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new wt(e.resolve(r.anchor))}static create(e,r){return new wt(e.resolve(r))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}wt.prototype.visible=!1;Ft.jsonID("node",wt);class rk{constructor(e){this.anchor=e}map(e){let{deleted:r,pos:n}=e.mapResult(this.anchor);return r?new jx(n,n):new rk(n)}resolve(e){let r=e.resolve(this.anchor),n=r.nodeAfter;return n&&wt.isSelectable(n)?new wt(r):Ft.near(r)}}class za extends Ft{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,r=st.empty){if(r==st.empty){e.delete(0,e.doc.content.size);let n=Ft.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,r)}toJSON(){return{type:"all"}}static fromJSON(e){return new za(e)}map(e){return new za(e)}eq(e){return e instanceof za}getBookmark(){return GV}}Ft.jsonID("all",za);const GV={map(){return this},resolve(t){return new za(t)}};function Ff(t,e,r,n,i,a=!1){if(e.inlineContent)return Dt.create(t,r);for(let s=n-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let o=e.child(s);if(o.isAtom){if(!a&&wt.isSelectable(o))return wt.create(t,r-(i<0?o.nodeSize:0))}else{let l=Ff(t,o,r+i,i<0?o.childCount:0,i,a);if(l)return l}r+=o.nodeSize*i}return null}function c4(t,e,r){let n=t.steps.length-1;if(n<e)return;let i=t.steps[n];if(!(i instanceof ei||i instanceof ni))return;let a=t.mapping.maps[n],s;a.forEach((o,l,u,c)=>{s==null&&(s=c)}),t.setSelection(Ft.near(t.doc.resolve(s),r))}const d4=1,m0=2,f4=4;class HV extends XP{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|d4)&~m0,this.storedMarks=null,this}get selectionSet(){return(this.updated&d4)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=m0,this}ensureMarks(e){return Cr.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&m0)>0}addStep(e,r){super.addStep(e,r),this.updated=this.updated&~m0,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,r=!0){let n=this.selection;return r&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Cr.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,r,n){let i=this.doc.type.schema;if(r==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(n==null&&(n=r),!e)return this.deleteRange(r,n);let a=this.storedMarks;if(!a){let s=this.doc.resolve(r);a=n==r?s.marks():s.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(r,n,i.text(e,a)),!this.selection.empty&&this.selection.to==r+e.length&&this.setSelection(Ft.near(this.selection.$to)),this}}setMeta(e,r){return this.meta[typeof e=="string"?e:e.key]=r,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=f4,this}get scrolledIntoView(){return(this.updated&f4)>0}}function h4(t,e){return!e||!t?t:t.bind(e)}class Rm{constructor(e,r,n){this.name=e,this.init=h4(r.init,n),this.apply=h4(r.apply,n)}}const qV=[new Rm("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Rm("selection",{init(t,e){return t.selection||Ft.atStart(e.doc)},apply(t){return t.selection}}),new Rm("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,r,n){return n.selection.$cursor?t.storedMarks:null}}),new Rm("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Dw{constructor(e,r){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=qV.slice(),r&&r.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new Rm(n.key,n.spec.state,n))})}}class $f{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,r=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=r){let i=this.config.plugins[n];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let r=[e],n=this.applyInner(e),i=null;for(;;){let a=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let l=i?i[s].n:0,u=i?i[s].state:this,c=l<r.length&&o.spec.appendTransaction.call(o,l?r.slice(l):r,u,n);if(c&&n.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<s?{state:n,n:r.length}:{state:this,n:0})}r.push(c),n=n.applyInner(c),a=!0}i&&(i[s]={state:n,n:r.length})}}if(!a)return{state:n,transactions:r}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let r=new $f(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let a=n[i];r[a.name]=a.apply(e,this[a.name],this,r)}return r}get tr(){return new HV(this)}static create(e){let r=new Dw(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new $f(r);for(let i=0;i<r.fields.length;i++)n[r.fields[i].name]=r.fields[i].init(e,n);return n}reconfigure(e){let r=new Dw(this.schema,e.plugins),n=r.fields,i=new $f(r);for(let a=0;a<n.length;a++){let s=n[a].name;i[s]=this.hasOwnProperty(s)?this[s]:n[a].init(e,i)}return i}toJSON(e){let r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(n=>n.toJSON())),e&&typeof e=="object")for(let n in e){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[n],a=i.spec.state;a&&a.toJSON&&(r[n]=a.toJSON.call(i,this[i.key]))}return r}static fromJSON(e,r,n){if(!r)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Dw(e.schema,e.plugins),a=new $f(i);return i.fields.forEach(s=>{if(s.name=="doc")a.doc=cs.fromJSON(e.schema,r.doc);else if(s.name=="selection")a.selection=Ft.fromJSON(a.doc,r.selection);else if(s.name=="storedMarks")r.storedMarks&&(a.storedMarks=r.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let o in n){let l=n[o],u=l.spec.state;if(l.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(r,o)){a[s.name]=u.fromJSON.call(l,e,r[o],a);return}}a[s.name]=s.init(e,a)}}),a}}function QP(t,e,r){for(let n in t){let i=t[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=QP(i,e,{})),r[n]=i}return r}class Wr{constructor(e){this.spec=e,this.props={},e.props&&QP(e.props,this,this.props),this.key=e.key?e.key.key:JP("plugin")}getState(e){return e[this.key]}}const Ow=Object.create(null);function JP(t){return t in Ow?t+"$"+ ++Ow[t]:(Ow[t]=0,t+"$")}class wn{constructor(e="key"){this.key=JP(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const nk=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function ZP(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("backward",t):r.parentOffset>0)?null:r}const e8=(t,e,r)=>{let n=ZP(t,r);if(!n)return!1;let i=ik(n);if(!i){let s=n.blockRange(),o=s&&Eh(s);return o==null?!1:(e&&e(t.tr.lift(s,o).scrollIntoView()),!0)}let a=i.nodeBefore;if(u8(t,i,e,-1))return!0;if(n.parent.content.size==0&&(sh(a,"end")||wt.isSelectable(a)))for(let s=n.depth;;s--){let o=Tx(t.doc,n.before(s),n.after(s),st.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(sh(a,"end")?Ft.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):wt.create(l.doc,i.pos-a.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||n.node(s-1).childCount>1)break}return a.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos-a.nodeSize,i.pos).scrollIntoView()),!0):!1},WV=(t,e,r)=>{let n=ZP(t,r);if(!n)return!1;let i=ik(n);return i?t8(t,i,e):!1},$V=(t,e,r)=>{let n=n8(t,r);if(!n)return!1;let i=ak(n);return i?t8(t,i,e):!1};function t8(t,e,r){let n=e.nodeBefore,i=n,a=e.pos-1;for(;!i.isTextblock;a--){if(i.type.spec.isolating)return!1;let c=i.lastChild;if(!c)return!1;i=c}let s=e.nodeAfter,o=s,l=e.pos+1;for(;!o.isTextblock;l++){if(o.type.spec.isolating)return!1;let c=o.firstChild;if(!c)return!1;o=c}let u=Tx(t.doc,a,l,st.empty);if(!u||u.from!=a||u instanceof ei&&u.slice.size>=l-a)return!1;if(r){let c=t.tr.step(u);c.setSelection(Dt.create(c.doc,a)),r(c.scrollIntoView())}return!0}function sh(t,e,r=!1){for(let n=t;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const r8=(t,e,r)=>{let{$head:n,empty:i}=t.selection,a=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",t):n.parentOffset>0)return!1;a=ik(n)}let s=a&&a.nodeBefore;return!s||!wt.isSelectable(s)?!1:(e&&e(t.tr.setSelection(wt.create(t.doc,a.pos-s.nodeSize)).scrollIntoView()),!0)};function ik(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function n8(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)?null:r}const i8=(t,e,r)=>{let n=n8(t,r);if(!n)return!1;let i=ak(n);if(!i)return!1;let a=i.nodeAfter;if(u8(t,i,e,1))return!0;if(n.parent.content.size==0&&(sh(a,"start")||wt.isSelectable(a))){let s=Tx(t.doc,n.before(),n.after(),st.empty);if(s&&s.slice.size<s.to-s.from){if(e){let o=t.tr.step(s);o.setSelection(sh(a,"start")?Ft.findFrom(o.doc.resolve(o.mapping.map(i.pos)),1):wt.create(o.doc,o.mapping.map(i.pos))),e(o.scrollIntoView())}return!0}}return a.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+a.nodeSize).scrollIntoView()),!0):!1},a8=(t,e,r)=>{let{$head:n,empty:i}=t.selection,a=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)return!1;a=ak(n)}let s=a&&a.nodeAfter;return!s||!wt.isSelectable(s)?!1:(e&&e(t.tr.setSelection(wt.create(t.doc,a.pos)).scrollIntoView()),!0)};function ak(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let r=t.node(e);if(t.index(e)+1<r.childCount)return t.doc.resolve(t.after(e+1));if(r.type.spec.isolating)break}return null}const KV=(t,e)=>{let r=t.selection,n=r instanceof wt,i;if(n){if(r.node.isTextblock||!ec(t.doc,r.from))return!1;i=r.from}else if(i=Ex(t.doc,r.from,-1),i==null)return!1;if(e){let a=t.tr.join(i);n&&a.setSelection(wt.create(a.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(a.scrollIntoView())}return!0},YV=(t,e)=>{let r=t.selection,n;if(r instanceof wt){if(r.node.isTextblock||!ec(t.doc,r.to))return!1;n=r.to}else if(n=Ex(t.doc,r.to,1),n==null)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0},XV=(t,e)=>{let{$from:r,$to:n}=t.selection,i=r.blockRange(n),a=i&&Eh(i);return a==null?!1:(e&&e(t.tr.lift(i,a).scrollIntoView()),!0)},s8=(t,e)=>{let{$head:r,$anchor:n}=t.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function sk(t){for(let e=0;e<t.edgeCount;e++){let{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const QV=(t,e)=>{let{$head:r,$anchor:n}=t.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let i=r.node(-1),a=r.indexAfter(-1),s=sk(i.contentMatchAt(a));if(!s||!i.canReplaceWith(a,a,s))return!1;if(e){let o=r.after(),l=t.tr.replaceWith(o,o,s.createAndFill());l.setSelection(Ft.near(l.doc.resolve(o),1)),e(l.scrollIntoView())}return!0},o8=(t,e)=>{let r=t.selection,{$from:n,$to:i}=r;if(r instanceof za||n.parent.inlineContent||i.parent.inlineContent)return!1;let a=sk(i.parent.contentMatchAt(i.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){let s=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,o=t.tr.insert(s,a.createAndFill());o.setSelection(Dt.create(o.doc,s+1)),e(o.scrollIntoView())}return!0},l8=(t,e)=>{let{$cursor:r}=t.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let a=r.before();if(dl(t.doc,a))return e&&e(t.tr.split(a).scrollIntoView()),!0}let n=r.blockRange(),i=n&&Eh(n);return i==null?!1:(e&&e(t.tr.lift(n,i).scrollIntoView()),!0)};function JV(t){return(e,r)=>{let{$from:n,$to:i}=e.selection;if(e.selection instanceof wt&&e.selection.node.isBlock)return!n.parentOffset||!dl(e.doc,n.pos)?!1:(r&&r(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let a=[],s,o,l=!1,u=!1;for(let g=n.depth;;g--)if(n.node(g).isBlock){l=n.end(g)==n.pos+(n.depth-g),u=n.start(g)==n.pos-(n.depth-g),o=sk(n.node(g-1).contentMatchAt(n.indexAfter(g-1))),a.unshift(l&&o?{type:o}:null),s=g;break}else{if(g==1)return!1;a.unshift(null)}let c=e.tr;(e.selection instanceof Dt||e.selection instanceof za)&&c.deleteSelection();let f=c.mapping.map(n.pos),m=dl(c.doc,f,a.length,a);if(m||(a[0]=o?{type:o}:null,m=dl(c.doc,f,a.length,a)),!m)return!1;if(c.split(f,a.length,a),!l&&u&&n.node(s).type!=o){let g=c.mapping.map(n.before(s)),y=c.doc.resolve(g);o&&n.node(s-1).canReplaceWith(y.index(),y.index()+1,o)&&c.setNodeMarkup(c.mapping.map(n.before(s)),o)}return r&&r(c.scrollIntoView()),!0}}const ZV=JV(),eU=(t,e)=>{let{$from:r,to:n}=t.selection,i,a=r.sharedDepth(n);return a==0?!1:(i=r.before(a),e&&e(t.tr.setSelection(wt.create(t.doc,i))),!0)};function tU(t,e,r){let n=e.nodeBefore,i=e.nodeAfter,a=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(a-1,a)?(r&&r(t.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(a,a+1)||!(i.isTextblock||ec(t.doc,e.pos))?!1:(r&&r(t.tr.join(e.pos).scrollIntoView()),!0)}function u8(t,e,r,n){let i=e.nodeBefore,a=e.nodeAfter,s,o,l=i.type.spec.isolating||a.type.spec.isolating;if(!l&&tU(t,e,r))return!0;let u=!l&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(s=(o=i.contentMatchAt(i.childCount)).findWrapping(a.type))&&o.matchType(s[0]||a.type).validEnd){if(r){let g=e.pos+a.nodeSize,y=Ve.empty;for(let N=s.length-1;N>=0;N--)y=Ve.from(s[N].create(null,y));y=Ve.from(i.copy(y));let b=t.tr.step(new ni(e.pos-1,g,e.pos,g,new st(y,1,0),s.length,!0)),w=b.doc.resolve(g+2*s.length);w.nodeAfter&&w.nodeAfter.type==i.type&&ec(b.doc,w.pos)&&b.join(w.pos),r(b.scrollIntoView())}return!0}let c=a.type.spec.isolating||n>0&&l?null:Ft.findFrom(e,1),f=c&&c.$from.blockRange(c.$to),m=f&&Eh(f);if(m!=null&&m>=e.depth)return r&&r(t.tr.lift(f,m).scrollIntoView()),!0;if(u&&sh(a,"start",!0)&&sh(i,"end")){let g=i,y=[];for(;y.push(g),!g.isTextblock;)g=g.lastChild;let b=a,w=1;for(;!b.isTextblock;b=b.firstChild)w++;if(g.canReplace(g.childCount,g.childCount,b.content)){if(r){let N=Ve.empty;for(let C=y.length-1;C>=0;C--)N=Ve.from(y[C].copy(N));let k=t.tr.step(new ni(e.pos-y.length,e.pos+a.nodeSize,e.pos+w,e.pos+a.nodeSize-w,new st(N,y.length,0),0,!0));r(k.scrollIntoView())}return!0}}return!1}function c8(t){return function(e,r){let n=e.selection,i=t<0?n.$from:n.$to,a=i.depth;for(;i.node(a).isInline;){if(!a)return!1;a--}return i.node(a).isTextblock?(r&&r(e.tr.setSelection(Dt.create(e.doc,t<0?i.start(a):i.end(a)))),!0):!1}}const rU=c8(-1),nU=c8(1);function iU(t,e=null){return function(r,n){let{$from:i,$to:a}=r.selection,s=i.blockRange(a),o=s&&tk(s,t,e);return o?(n&&n(r.tr.wrap(s,o).scrollIntoView()),!0):!1}}function p4(t,e=null){return function(r,n){let i=!1;for(let a=0;a<r.selection.ranges.length&&!i;a++){let{$from:{pos:s},$to:{pos:o}}=r.selection.ranges[a];r.doc.nodesBetween(s,o,(l,u)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)i=!0;else{let c=r.doc.resolve(u),f=c.index();i=c.parent.canReplaceWith(f,f+1,t)}})}if(!i)return!1;if(n){let a=r.tr;for(let s=0;s<r.selection.ranges.length;s++){let{$from:{pos:o},$to:{pos:l}}=r.selection.ranges[s];a.setBlockType(o,l,t,e)}n(a.scrollIntoView())}return!0}}function ok(...t){return function(e,r,n){for(let i=0;i<t.length;i++)if(t[i](e,r,n))return!0;return!1}}ok(nk,e8,r8);ok(nk,i8,a8);ok(s8,o8,l8,ZV);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function aU(t,e=null){return function(r,n){let{$from:i,$to:a}=r.selection,s=i.blockRange(a);if(!s)return!1;let o=n?r.tr:null;return sU(o,s,t,e)?(n&&n(o.scrollIntoView()),!0):!1}}function sU(t,e,r,n=null){let i=!1,a=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(r)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);a=new fy(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new fy(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let o=tk(a,r,n,e);return o?(t&&oU(t,e,o,i,r),!0):!1}function oU(t,e,r,n,i){let a=Ve.empty;for(let c=r.length-1;c>=0;c--)a=Ve.from(r[c].type.create(r[c].attrs,a));t.step(new ni(e.start-(n?2:0),e.end,e.start,e.end,new st(a,0,0),r.length,!0));let s=0;for(let c=0;c<r.length;c++)r[c].type==i&&(s=c+1);let o=r.length-s,l=e.start+r.length-(n?2:0),u=e.parent;for(let c=e.startIndex,f=e.endIndex,m=!0;c<f;c++,m=!1)!m&&dl(t.doc,l,o)&&(t.split(l,o),l+=2*o),l+=u.child(c).nodeSize;return t}function lU(t){return function(e,r){let{$from:n,$to:i}=e.selection,a=n.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return a?r?n.node(a.depth-1).type==t?uU(e,r,t,a):cU(e,r,a):!0:!1}}function uU(t,e,r,n){let i=t.tr,a=n.end,s=n.$to.end(n.depth);a<s&&(i.step(new ni(a-1,s,a,s,new st(Ve.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new fy(i.doc.resolve(n.$from.pos),i.doc.resolve(s),n.depth));const o=Eh(n);if(o==null)return!1;i.lift(n,o);let l=i.doc.resolve(i.mapping.map(a,-1)-1);return ec(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function cU(t,e,r){let n=t.tr,i=r.parent;for(let g=r.end,y=r.endIndex-1,b=r.startIndex;y>b;y--)g-=i.child(y).nodeSize,n.delete(g-1,g+1);let a=n.doc.resolve(r.start),s=a.nodeAfter;if(n.mapping.map(r.end)!=r.start+a.nodeAfter.nodeSize)return!1;let o=r.startIndex==0,l=r.endIndex==i.childCount,u=a.node(-1),c=a.index(-1);if(!u.canReplace(c+(o?0:1),c+1,s.content.append(l?Ve.empty:Ve.from(i))))return!1;let f=a.pos,m=f+s.nodeSize;return n.step(new ni(f-(o?1:0),m+(l?1:0),f+1,m-1,new st((o?Ve.empty:Ve.from(i.copy(Ve.empty))).append(l?Ve.empty:Ve.from(i.copy(Ve.empty))),o?0:1,l?0:1),o?0:1)),e(n.scrollIntoView()),!0}function dU(t){return function(e,r){let{$from:n,$to:i}=e.selection,a=n.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!a)return!1;let s=a.startIndex;if(s==0)return!1;let o=a.parent,l=o.child(s-1);if(l.type!=t)return!1;if(r){let u=l.lastChild&&l.lastChild.type==o.type,c=Ve.from(u?t.create():null),f=new st(Ve.from(t.create(null,Ve.from(o.type.create(null,c)))),u?3:1,0),m=a.start,g=a.end;r(e.tr.step(new ni(m-(u?3:1),g,m,g,f,1,!0)).scrollIntoView())}return!0}}const bi=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},oh=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let z2=null;const ol=function(t,e,r){let n=z2||(z2=document.createRange());return n.setEnd(t,r??t.nodeValue.length),n.setStart(t,e||0),n},fU=function(){z2=null},vd=function(t,e,r,n){return r&&(m4(t,e,r,n,-1)||m4(t,e,r,n,1))},hU=/^(img|br|input|textarea|hr)$/i;function m4(t,e,r,n,i){for(var a;;){if(t==r&&e==n)return!0;if(e==(i<0?0:ls(t))){let s=t.parentNode;if(!s||s.nodeType!=1||Lg(t)||hU.test(t.nodeName)||t.contentEditable=="false")return!1;e=bi(t)+(i<0?0:1),t=s}else if(t.nodeType==1){let s=t.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((a=s.pmViewDesc)===null||a===void 0)&&a.ignoreForSelection)e+=i;else return!1;else t=s,e=i<0?ls(t):0}else return!1}}function ls(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function pU(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=ls(t)}else if(t.parentNode&&!Lg(t))e=bi(t),t=t.parentNode;else return null}}function mU(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!Lg(t))e=bi(t)+1,t=t.parentNode;else return null}}function gU(t,e,r){for(let n=e==0,i=e==ls(t);n||i;){if(t==r)return!0;let a=bi(t);if(t=t.parentNode,!t)return!1;n=n&&a==0,i=i&&a==ls(t)}}function Lg(t){let e;for(let r=t;r&&!(e=r.pmViewDesc);r=r.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Px=function(t){return t.focusNode&&vd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Kc(t,e){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=t,r.key=r.code=e,r}function vU(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function yU(t,e,r){if(t.caretPositionFromPoint)try{let n=t.caretPositionFromPoint(e,r);if(n)return{node:n.offsetNode,offset:Math.min(ls(n.offsetNode),n.offset)}}catch{}if(t.caretRangeFromPoint){let n=t.caretRangeFromPoint(e,r);if(n)return{node:n.startContainer,offset:Math.min(ls(n.startContainer),n.startOffset)}}}const So=typeof navigator<"u"?navigator:null,g4=typeof document<"u"?document:null,tc=So&&So.userAgent||"",V2=/Edge\/(\d+)/.exec(tc),d8=/MSIE \d/.exec(tc),U2=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(tc),Sa=!!(d8||U2||V2),Ou=d8?document.documentMode:U2?+U2[1]:V2?+V2[1]:0,ds=!Sa&&/gecko\/(\d+)/i.test(tc);ds&&+(/Firefox\/(\d+)/.exec(tc)||[0,0])[1];const G2=!Sa&&/Chrome\/(\d+)/.exec(tc),ti=!!G2,f8=G2?+G2[1]:0,Ci=!Sa&&!!So&&/Apple Computer/.test(So.vendor),lh=Ci&&(/Mobile\/\w+/.test(tc)||!!So&&So.maxTouchPoints>2),as=lh||(So?/Mac/.test(So.platform):!1),h8=So?/Win/.test(So.platform):!1,cl=/Android \d/.test(tc),Bg=!!g4&&"webkitFontSmoothing"in g4.documentElement.style,xU=Bg?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function bU(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function nl(t,e){return typeof t=="number"?t:t[e]}function wU(t){let e=t.getBoundingClientRect(),r=e.width/t.offsetWidth||1,n=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*r,top:e.top,bottom:e.top+t.clientHeight*n}}function v4(t,e,r){let n=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,a=t.dom.ownerDocument;for(let s=r||t.dom;s;){if(s.nodeType!=1){s=oh(s);continue}let o=s,l=o==a.body,u=l?bU(a):wU(o),c=0,f=0;if(e.top<u.top+nl(n,"top")?f=-(u.top-e.top+nl(i,"top")):e.bottom>u.bottom-nl(n,"bottom")&&(f=e.bottom-e.top>u.bottom-u.top?e.top+nl(i,"top")-u.top:e.bottom-u.bottom+nl(i,"bottom")),e.left<u.left+nl(n,"left")?c=-(u.left-e.left+nl(i,"left")):e.right>u.right-nl(n,"right")&&(c=e.right-u.right+nl(i,"right")),c||f)if(l)a.defaultView.scrollBy(c,f);else{let g=o.scrollLeft,y=o.scrollTop;f&&(o.scrollTop+=f),c&&(o.scrollLeft+=c);let b=o.scrollLeft-g,w=o.scrollTop-y;e={left:e.left-b,top:e.top-w,right:e.right-b,bottom:e.bottom-w}}let m=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(m))break;s=m=="absolute"?s.offsetParent:oh(s)}}function SU(t){let e=t.dom.getBoundingClientRect(),r=Math.max(0,e.top),n,i;for(let a=(e.left+e.right)/2,s=r+1;s<Math.min(innerHeight,e.bottom);s+=5){let o=t.root.elementFromPoint(a,s);if(!o||o==t.dom||!t.dom.contains(o))continue;let l=o.getBoundingClientRect();if(l.top>=r-20){n=o,i=l.top;break}}return{refDOM:n,refTop:i,stack:p8(t.dom)}}function p8(t){let e=[],r=t.ownerDocument;for(let n=t;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),t!=r);n=oh(n));return e}function kU({refDOM:t,refTop:e,stack:r}){let n=t?t.getBoundingClientRect().top:0;m8(r,n==0?0:n-e)}function m8(t,e){for(let r=0;r<t.length;r++){let{dom:n,top:i,left:a}=t[r];n.scrollTop!=i+e&&(n.scrollTop=i+e),n.scrollLeft!=a&&(n.scrollLeft=a)}}let Of=null;function CU(t){if(t.setActive)return t.setActive();if(Of)return t.focus(Of);let e=p8(t);t.focus(Of==null?{get preventScroll(){return Of={preventScroll:!0},!0}}:void 0),Of||(Of=!1,m8(e,0))}function g8(t,e){let r,n=2e8,i,a=0,s=e.top,o=e.top,l,u;for(let c=t.firstChild,f=0;c;c=c.nextSibling,f++){let m;if(c.nodeType==1)m=c.getClientRects();else if(c.nodeType==3)m=ol(c).getClientRects();else continue;for(let g=0;g<m.length;g++){let y=m[g];if(y.top<=s&&y.bottom>=o){s=Math.max(y.bottom,s),o=Math.min(y.top,o);let b=y.left>e.left?y.left-e.left:y.right<e.left?e.left-y.right:0;if(b<n){r=c,n=b,i=b&&r.nodeType==3?{left:y.right<e.left?y.right:y.left,top:e.top}:e,c.nodeType==1&&b&&(a=f+(e.left>=(y.left+y.right)/2?1:0));continue}}else y.top>e.top&&!l&&y.left<=e.left&&y.right>=e.left&&(l=c,u={left:Math.max(y.left,Math.min(y.right,e.left)),top:y.top});!r&&(e.left>=y.right&&e.top>=y.top||e.left>=y.left&&e.top>=y.bottom)&&(a=f+1)}}return!r&&l&&(r=l,i=u,n=0),r&&r.nodeType==3?NU(r,i):!r||n&&r.nodeType==1?{node:t,offset:a}:g8(r,i)}function NU(t,e){let r=t.nodeValue.length,n=document.createRange(),i;for(let a=0;a<r;a++){n.setEnd(t,a+1),n.setStart(t,a);let s=vu(n,1);if(s.top!=s.bottom&&lk(e,s)){i={node:t,offset:a+(e.left>=(s.left+s.right)/2?1:0)};break}}return n.detach(),i||{node:t,offset:0}}function lk(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function EU(t,e){let r=t.parentNode;return r&&/^li$/i.test(r.nodeName)&&e.left<t.getBoundingClientRect().left?r:t}function TU(t,e,r){let{node:n,offset:i}=g8(e,r),a=-1;if(n.nodeType==1&&!n.firstChild){let s=n.getBoundingClientRect();a=s.left!=s.right&&r.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(n,i,a)}function jU(t,e,r,n){let i=-1;for(let a=e,s=!1;a!=t.dom;){let o=t.docView.nearestDesc(a,!0),l;if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((l=o.dom.getBoundingClientRect()).width||l.height)&&(o.node.isBlock&&o.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(o.dom.nodeName)&&(!s&&l.left>n.left||l.top>n.top?i=o.posBefore:(!s&&l.right<n.left||l.bottom<n.top)&&(i=o.posAfter),s=!0),!o.contentDOM&&i<0&&!o.node.isText))return(o.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2)?o.posBefore:o.posAfter;a=o.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,r,-1)}function v8(t,e,r){let n=t.childNodes.length;if(n&&r.top<r.bottom)for(let i=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-r.top)/(r.bottom-r.top))-2)),a=i;;){let s=t.childNodes[a];if(s.nodeType==1){let o=s.getClientRects();for(let l=0;l<o.length;l++){let u=o[l];if(lk(e,u))return v8(s,e,u)}}if((a=(a+1)%n)==i)break}return t}function PU(t,e){let r=t.dom.ownerDocument,n,i=0,a=yU(r,e.left,e.top);a&&({node:n,offset:i}=a);let s=(t.root.elementFromPoint?t.root:r).elementFromPoint(e.left,e.top),o;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=t.dom.getBoundingClientRect();if(!lk(e,u)||(s=v8(t.dom,e,u),!s))return null}if(Ci)for(let u=s;n&&u;u=oh(u))u.draggable&&(n=void 0);if(s=EU(s,e),n){if(ds&&n.nodeType==1&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){let c=n.childNodes[i],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let u;Bg&&i&&n.nodeType==1&&(u=n.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,n==t.dom&&i==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?o=t.state.doc.content.size:(i==0||n.nodeType!=1||n.childNodes[i-1].nodeName!="BR")&&(o=jU(t,n,i,e))}o==null&&(o=TU(t,s,e));let l=t.docView.nearestDesc(s,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function y4(t){return t.top<t.bottom||t.left<t.right}function vu(t,e){let r=t.getClientRects();if(r.length){let n=r[e<0?0:r.length-1];if(y4(n))return n}return Array.prototype.find.call(r,y4)||t.getBoundingClientRect()}const MU=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function y8(t,e,r){let{node:n,offset:i,atom:a}=t.docView.domFromPos(e,r<0?-1:1),s=Bg||ds;if(n.nodeType==3)if(s&&(MU.test(n.nodeValue)||(r<0?!i:i==n.nodeValue.length))){let l=vu(ol(n,i,i),r);if(ds&&i&&/\s/.test(n.nodeValue[i-1])&&i<n.nodeValue.length){let u=vu(ol(n,i-1,i-1),-1);if(u.top==l.top){let c=vu(ol(n,i,i+1),-1);if(c.top!=l.top)return Sm(c,c.left<u.left)}}return l}else{let l=i,u=i,c=r<0?1:-1;return r<0&&!i?(u++,c=-1):r>=0&&i==n.nodeValue.length?(l--,c=1):r<0?l--:u++,Sm(vu(ol(n,l,u),c),c<0)}if(!t.state.doc.resolve(e-(a||0)).parent.inlineContent){if(a==null&&i&&(r<0||i==ls(n))){let l=n.childNodes[i-1];if(l.nodeType==1)return Iw(l.getBoundingClientRect(),!1)}if(a==null&&i<ls(n)){let l=n.childNodes[i];if(l.nodeType==1)return Iw(l.getBoundingClientRect(),!0)}return Iw(n.getBoundingClientRect(),r>=0)}if(a==null&&i&&(r<0||i==ls(n))){let l=n.childNodes[i-1],u=l.nodeType==3?ol(l,ls(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(u)return Sm(vu(u,1),!1)}if(a==null&&i<ls(n)){let l=n.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let u=l?l.nodeType==3?ol(l,0,s?0:1):l.nodeType==1?l:null:null;if(u)return Sm(vu(u,-1),!0)}return Sm(vu(n.nodeType==3?ol(n):n,-r),r>=0)}function Sm(t,e){if(t.width==0)return t;let r=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:r,right:r}}function Iw(t,e){if(t.height==0)return t;let r=e?t.top:t.bottom;return{top:r,bottom:r,left:t.left,right:t.right}}function x8(t,e,r){let n=t.state,i=t.root.activeElement;n!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return r()}finally{n!=e&&t.updateState(n),i!=t.dom&&i&&i.focus()}}function _U(t,e,r){let n=e.selection,i=r=="up"?n.$from:n.$to;return x8(t,e,()=>{let{node:a}=t.docView.domFromPos(i.pos,r=="up"?-1:1);for(;;){let o=t.docView.nearestDesc(a,!0);if(!o)break;if(o.node.isBlock){a=o.contentDOM||o.dom;break}a=o.dom.parentNode}let s=y8(t,i.pos,1);for(let o=a.firstChild;o;o=o.nextSibling){let l;if(o.nodeType==1)l=o.getClientRects();else if(o.nodeType==3)l=ol(o,0,o.nodeValue.length).getClientRects();else continue;for(let u=0;u<l.length;u++){let c=l[u];if(c.bottom>c.top+1&&(r=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const AU=/[\u0590-\u08ac]/;function RU(t,e,r){let{$head:n}=e.selection;if(!n.parent.isTextblock)return!1;let i=n.parentOffset,a=!i,s=i==n.parent.content.size,o=t.domSelection();return o?!AU.test(n.parent.textContent)||!o.modify?r=="left"||r=="backward"?a:s:x8(t,e,()=>{let{focusNode:l,focusOffset:u,anchorNode:c,anchorOffset:f}=t.domSelectionRange(),m=o.caretBidiLevel;o.modify("move",r,"character");let g=n.depth?t.docView.domAfterPos(n.before()):t.dom,{focusNode:y,focusOffset:b}=t.domSelectionRange(),w=y&&!g.contains(y.nodeType==1?y:y.parentNode)||l==y&&u==b;try{o.collapse(c,f),l&&(l!=c||u!=f)&&o.extend&&o.extend(l,u)}catch{}return m!=null&&(o.caretBidiLevel=m),w}):n.pos==n.start()||n.pos==n.end()}let x4=null,b4=null,w4=!1;function DU(t,e,r){return x4==e&&b4==r?w4:(x4=e,b4=r,w4=r=="up"||r=="down"?_U(t,e,r):RU(t,e,r))}const fs=0,S4=1,Xc=2,ko=3;class Fg{constructor(e,r,n,i){this.parent=e,this.children=r,this.dom=n,this.contentDOM=i,this.dirty=fs,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,r,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let r=0;r<this.children.length;r++)e+=this.children[r].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let r=0,n=this.posAtStart;;r++){let i=this.children[r];if(i==e)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,r,n){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(n<0){let a,s;if(e==this.contentDOM)a=e.childNodes[r-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.previousSibling}for(;a&&!((s=a.pmViewDesc)&&s.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(s)+s.size:this.posAtStart}else{let a,s;if(e==this.contentDOM)a=e.childNodes[r];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.nextSibling}for(;a&&!((s=a.pmViewDesc)&&s.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=r>bi(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(r==0)for(let a=e;;a=a.parentNode){if(a==this.dom){i=!1;break}if(a.previousSibling)break}if(i==null&&r==e.childNodes.length)for(let a=e;;a=a.parentNode){if(a==this.dom){i=!0;break}if(a.nextSibling)break}}return i??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,r=!1){for(let n=!0,i=e;i;i=i.parentNode){let a=this.getDesc(i),s;if(a&&(!r||a.node))if(n&&(s=a.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))n=!1;else return a}}getDesc(e){let r=e.pmViewDesc;for(let n=r;n;n=n.parent)if(n==this)return r}posFromDOM(e,r,n){for(let i=e;i;i=i.parentNode){let a=this.getDesc(i);if(a)return a.localPosFromDOM(e,r,n)}return-1}descAt(e){for(let r=0,n=0;r<this.children.length;r++){let i=this.children[r],a=n+i.size;if(n==e&&a!=n){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let o=i.children[s];if(o.size){i=o;break}}return i}if(e<a)return i.descAt(e-n-i.border);n=a}}domFromPos(e,r){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,i=0;for(let a=0;n<this.children.length;n++){let s=this.children[n],o=a+s.size;if(o>e||s instanceof w8){i=e-a;break}a=o}if(i)return this.children[n].domFromPos(i-this.children[n].border,r);for(let a;n&&!(a=this.children[n-1]).size&&a instanceof b8&&a.side>=0;n--);if(r<=0){let a,s=!0;for(;a=n?this.children[n-1]:null,!(!a||a.dom.parentNode==this.contentDOM);n--,s=!1);return a&&r&&s&&!a.border&&!a.domAtom?a.domFromPos(a.size,r):{node:this.contentDOM,offset:a?bi(a.dom)+1:0}}else{let a,s=!0;for(;a=n<this.children.length?this.children[n]:null,!(!a||a.dom.parentNode==this.contentDOM);n++,s=!1);return a&&s&&!a.border&&!a.domAtom?a.domFromPos(0,r):{node:this.contentDOM,offset:a?bi(a.dom):this.contentDOM.childNodes.length}}}parseRange(e,r,n=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:r,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,a=-1;for(let s=n,o=0;;o++){let l=this.children[o],u=s+l.size;if(i==-1&&e<=u){let c=s+l.border;if(e>=c&&r<=u-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,r,c);e=s;for(let f=o;f>0;f--){let m=this.children[f-1];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(1)){i=bi(m.dom)+1;break}e-=m.size}i==-1&&(i=0)}if(i>-1&&(u>r||o==this.children.length-1)){r=u;for(let c=o+1;c<this.children.length;c++){let f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){a=bi(f.dom);break}r+=f.size}a==-1&&(a=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:r,fromOffset:i,toOffset:a}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let r=this.children[e<0?0:this.children.length-1];return r.size==0||r.emptyChildAt(e)}domAfterPos(e){let{node:r,offset:n}=this.domFromPos(e,0);if(r.nodeType!=1||n==r.childNodes.length)throw new RangeError("No node after pos "+e);return r.childNodes[n]}setSelection(e,r,n,i=!1){let a=Math.min(e,r),s=Math.max(e,r);for(let g=0,y=0;g<this.children.length;g++){let b=this.children[g],w=y+b.size;if(a>y&&s<w)return b.setSelection(e-y-b.border,r-y-b.border,n,i);y=w}let o=this.domFromPos(e,e?-1:1),l=r==e?o:this.domFromPos(r,r?-1:1),u=n.root.getSelection(),c=n.domSelectionRange(),f=!1;if((ds||Ci)&&e==r){let{node:g,offset:y}=o;if(g.nodeType==3){if(f=!!(y&&g.nodeValue[y-1]==`
`),f&&y==g.nodeValue.length)for(let b=g,w;b;b=b.parentNode){if(w=b.nextSibling){w.nodeName=="BR"&&(o=l={node:w.parentNode,offset:bi(w)+1});break}let N=b.pmViewDesc;if(N&&N.node&&N.node.isBlock)break}}else{let b=g.childNodes[y-1];f=b&&(b.nodeName=="BR"||b.contentEditable=="false")}}if(ds&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let g=c.focusNode.childNodes[c.focusOffset];g&&g.contentEditable=="false"&&(i=!0)}if(!(i||f&&Ci)&&vd(o.node,o.offset,c.anchorNode,c.anchorOffset)&&vd(l.node,l.offset,c.focusNode,c.focusOffset))return;let m=!1;if((u.extend||e==r)&&!(f&&ds)){u.collapse(o.node,o.offset);try{e!=r&&u.extend(l.node,l.offset),m=!0}catch{}}if(!m){if(e>r){let y=o;o=l,l=y}let g=document.createRange();g.setEnd(l.node,l.offset),g.setStart(o.node,o.offset),u.removeAllRanges(),u.addRange(g)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,r){for(let n=0,i=0;i<this.children.length;i++){let a=this.children[i],s=n+a.size;if(n==s?e<=s&&r>=n:e<s&&r>n){let o=n+a.border,l=s-a.border;if(e>=o&&r<=l){this.dirty=e==n||r==s?Xc:S4,e==o&&r==l&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=ko:a.markDirty(e-o,r-o);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?Xc:ko}n=s}this.dirty=Xc}markParentsDirty(){let e=1;for(let r=this.parent;r;r=r.parent,e++){let n=e==1?Xc:S4;r.dirty<n&&(r.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class b8 extends Fg{constructor(e,r,n,i){let a,s=r.type.toDOM;if(typeof s=="function"&&(s=s(n,()=>{if(!a)return i;if(a.parent)return a.parent.posBeforeChild(a)})),!r.type.spec.raw){if(s.nodeType!=1){let o=document.createElement("span");o.appendChild(s),s=o}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=r,this.widget=r,a=this}matchesWidget(e){return this.dirty==fs&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let r=this.widget.spec.stopEvent;return r?r(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class OU extends Fg{constructor(e,r,n,i){super(e,[],r,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(e,r){return e!=this.textDOM?this.posAtStart+(r?this.size:0):this.posAtStart+r}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class yd extends Fg{constructor(e,r,n,i,a){super(e,[],n,i),this.mark=r,this.spec=a}static create(e,r,n,i){let a=i.nodeViews[r.type.name],s=a&&a(r,i,n);return(!s||!s.dom)&&(s=Cd.renderSpec(document,r.type.spec.toDOM(r,n),null,r.attrs)),new yd(e,r,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&ko||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=ko&&this.mark.eq(e)}markDirty(e,r){if(super.markDirty(e,r),this.dirty!=fs){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=fs}}slice(e,r,n){let i=yd.create(this.parent,this.mark,!0,n),a=this.children,s=this.size;r<s&&(a=q2(a,r,s,n)),e>0&&(a=q2(a,0,e,n));for(let o=0;o<a.length;o++)a[o].parent=i;return i.children=a,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Iu extends Fg{constructor(e,r,n,i,a,s,o,l,u){super(e,[],a,s),this.node=r,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=o}static create(e,r,n,i,a,s){let o=a.nodeViews[r.type.name],l,u=o&&o(r,a,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},n,i),c=u&&u.dom,f=u&&u.contentDOM;if(r.isText){if(!c)c=document.createTextNode(r.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:f}=Cd.renderSpec(document,r.type.spec.toDOM(r),null,r.attrs));!f&&!r.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),r.type.spec.draggable&&(c.draggable=!0));let m=c;return c=C8(c,n,r),u?l=new IU(e,r,n,i,c,f||null,m,u,a,s+1):r.isText?new Mx(e,r,n,i,c,m,a):new Iu(e,r,n,i,c,f||null,m,a,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let r=this.children.length-1;r>=0;r--){let n=this.children[r];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Ve.empty)}return e}matchesNode(e,r,n){return this.dirty==fs&&e.eq(this.node)&&py(r,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,r){let n=this.node.inlineContent,i=r,a=e.composing?this.localCompositionInfo(e,r):null,s=a&&a.pos>-1?a:null,o=a&&a.pos<0,l=new BU(this,s&&s.node,e);VU(this.node,this.innerDeco,(u,c,f)=>{u.spec.marks?l.syncToMarks(u.spec.marks,n,e,c):u.type.side>=0&&!f&&l.syncToMarks(c==this.node.childCount?Cr.none:this.node.child(c).marks,n,e,c),l.placeWidget(u,e,i)},(u,c,f,m)=>{l.syncToMarks(u.marks,n,e,m);let g;l.findNodeMatch(u,c,f,m)||o&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(g=l.findIndexWithChild(a.node))>-1&&l.updateNodeAt(u,c,f,g,e)||l.updateNextNode(u,c,f,e,m,i)||l.addNode(u,c,f,e,i),i+=u.nodeSize}),l.syncToMarks([],n,e,0),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Xc)&&(s&&this.protectLocalComposition(e,s),S8(this.contentDOM,this.children,e),lh&&UU(this.dom))}localCompositionInfo(e,r){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof Dt)||n<r||i>r+this.node.content.size)return null;let a=e.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let s=a.nodeValue,o=GU(this.node.content,s,n-r,i-r);return o<0?null:{node:a,pos:o,text:s}}else return{node:a,pos:-1,text:""}}protectLocalComposition(e,{node:r,pos:n,text:i}){if(this.getDesc(r))return;let a=r;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let s=new OU(this,a,r,i);e.input.compositionNodes.push(s),this.children=q2(this.children,n,n+i.length,e,s)}update(e,r,n,i){return this.dirty==ko||!e.sameMarkup(this.node)?!1:(this.updateInner(e,r,n,i),!0)}updateInner(e,r,n,i){this.updateOuterDeco(r),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=fs}updateOuterDeco(e){if(py(e,this.outerDeco))return;let r=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=k8(this.dom,this.nodeDOM,H2(this.outerDeco,this.node,r),H2(e,this.node,r)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function k4(t,e,r,n,i){C8(n,e,t);let a=new Iu(void 0,t,e,r,n,n,n,i,0);return a.contentDOM&&a.updateChildren(i,0),a}class Mx extends Iu{constructor(e,r,n,i,a,s,o){super(e,r,n,i,a,null,s,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,r,n,i){return this.dirty==ko||this.dirty!=fs&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(r),(this.dirty!=fs||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=fs,!0)}inParent(){let e=this.parent.contentDOM;for(let r=this.nodeDOM;r;r=r.parentNode)if(r==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,r,n){return e==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):super.localPosFromDOM(e,r,n)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,r,n){let i=this.node.cut(e,r),a=document.createTextNode(i.text);return new Mx(this.parent,i,this.outerDeco,this.innerDeco,a,a,n)}markDirty(e,r){super.markDirty(e,r),this.dom!=this.nodeDOM&&(e==0||r==this.nodeDOM.nodeValue.length)&&(this.dirty=ko)}get domAtom(){return!1}isText(e){return this.node.text==e}}class w8 extends Fg{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==fs&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class IU extends Iu{constructor(e,r,n,i,a,s,o,l,u,c){super(e,r,n,i,a,s,o,u,c),this.spec=l}update(e,r,n,i){if(this.dirty==ko)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let a=this.spec.update(e,r,n);return a&&this.updateInner(e,r,n,i),a}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,r,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,r,n,i){this.spec.setSelection?this.spec.setSelection(e,r,n.root):super.setSelection(e,r,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function S8(t,e,r){let n=t.firstChild,i=!1;for(let a=0;a<e.length;a++){let s=e[a],o=s.dom;if(o.parentNode==t){for(;o!=n;)n=C4(n),i=!0;n=n.nextSibling}else i=!0,t.insertBefore(o,n);if(s instanceof yd){let l=n?n.previousSibling:t.lastChild;S8(s.contentDOM,s.children,r),n=l?l.nextSibling:t.firstChild}}for(;n;)n=C4(n),i=!0;i&&r.trackWrites==t&&(r.trackWrites=null)}const zm=function(t){t&&(this.nodeName=t)};zm.prototype=Object.create(null);const Qc=[new zm];function H2(t,e,r){if(t.length==0)return Qc;let n=r?Qc[0]:new zm,i=[n];for(let a=0;a<t.length;a++){let s=t[a].type.attrs;if(s){s.nodeName&&i.push(n=new zm(s.nodeName));for(let o in s){let l=s[o];l!=null&&(r&&i.length==1&&i.push(n=new zm(e.isInline?"span":"div")),o=="class"?n.class=(n.class?n.class+" ":"")+l:o=="style"?n.style=(n.style?n.style+";":"")+l:o!="nodeName"&&(n[o]=l))}}}return i}function k8(t,e,r,n){if(r==Qc&&n==Qc)return e;let i=e;for(let a=0;a<n.length;a++){let s=n[a],o=r[a];if(a){let l;o&&o.nodeName==s.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),o=Qc[0]),i=l}LU(i,o||Qc[0],s)}return i}function LU(t,e,r){for(let n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in r)&&t.removeAttribute(n);for(let n in r)n!="class"&&n!="style"&&n!="nodeName"&&r[n]!=e[n]&&t.setAttribute(n,r[n]);if(e.class!=r.class){let n=e.class?e.class.split(" ").filter(Boolean):[],i=r.class?r.class.split(" ").filter(Boolean):[];for(let a=0;a<n.length;a++)i.indexOf(n[a])==-1&&t.classList.remove(n[a]);for(let a=0;a<i.length;a++)n.indexOf(i[a])==-1&&t.classList.add(i[a]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=r.style){if(e.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=n.exec(e.style);)t.style.removeProperty(i[1])}r.style&&(t.style.cssText+=r.style)}}function C8(t,e,r){return k8(t,t,Qc,H2(e,r,t.nodeType!=1))}function py(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].type.eq(e[r].type))return!1;return!0}function C4(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class BU{constructor(e,r,n){this.lock=r,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=FU(e.node.content,e)}destroyBetween(e,r){if(e!=r){for(let n=e;n<r;n++)this.top.children[n].destroy();this.top.children.splice(e,r-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,r,n,i){let a=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;a<o&&(a==s-1?this.top:this.stack[a+1<<1]).matchesMark(e[a])&&e[a].type.spec.spanning!==!1;)a++;for(;a<s;)this.destroyRest(),this.top.dirty=fs,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1,u=this.top.children.length;i<this.preMatch.index&&(u=Math.min(this.index+3,u));for(let c=this.index;c<u;c++){let f=this.top.children[c];if(f.matchesMark(e[s])&&!this.isLocked(f.dom)){l=c;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let c=yd.create(this.top,e[s],r,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,s++}}findNodeMatch(e,r,n,i){let a=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,r,n))a=this.top.children.indexOf(s,this.index);else for(let o=this.index,l=Math.min(this.top.children.length,o+5);o<l;o++){let u=this.top.children[o];if(u.matchesNode(e,r,n)&&!this.preMatch.matched.has(u)){a=o;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(e,r,n,i,a){let s=this.top.children[i];return s.dirty==ko&&s.dom==s.contentDOM&&(s.dirty=Xc),s.update(e,r,n,a)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let r=e.parentNode;if(!r)return-1;if(r==this.top.contentDOM){let n=e.pmViewDesc;if(n){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==n)return i}return-1}e=r}}updateNextNode(e,r,n,i,a,s){for(let o=this.index;o<this.top.children.length;o++){let l=this.top.children[o];if(l instanceof Iu){let u=this.preMatch.matched.get(l);if(u!=null&&u!=a)return!1;let c=l.dom,f,m=this.isLocked(c)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=ko&&py(r,l.outerDeco));if(!m&&l.update(e,r,n,i))return this.destroyBetween(this.index,o),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!m&&(f=this.recreateWrapper(l,e,r,n,i,s)))return this.destroyBetween(this.index,o),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=Xc,f.updateChildren(i,s+1),f.dirty=fs),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,r,n,i,a,s){if(e.dirty||r.isAtom||!e.children.length||!e.node.content.eq(r.content)||!py(n,e.outerDeco)||!i.eq(e.innerDeco))return null;let o=Iu.create(this.top,r,n,i,a,s);if(o.contentDOM){o.children=e.children,e.children=[];for(let l of o.children)l.parent=o}return e.destroy(),o}addNode(e,r,n,i,a){let s=Iu.create(this.top,e,r,n,i,a);s.contentDOM&&s.updateChildren(i,a+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,r,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let a=new b8(this.top,e,r,n);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],r=this.top;for(;e instanceof yd;)r=e,e=r.children[r.children.length-1];(!e||!(e instanceof Mx)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Ci||ti)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",r),this.addHackNode("BR",this.top))}addHackNode(e,r){if(r==this.top&&this.index<r.children.length&&r.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);e=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),e=="BR"&&(n.className="ProseMirror-trailingBreak");let i=new w8(this.top,[],n,null);r!=this.top?r.children.push(i):r.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function FU(t,e){let r=e,n=r.children.length,i=t.childCount,a=new Map,s=[];e:for(;i>0;){let o;for(;;)if(n){let u=r.children[n-1];if(u instanceof yd)r=u,n=u.children.length;else{o=u,n--;break}}else{if(r==e)break e;n=r.parent.children.indexOf(r),r=r.parent}let l=o.node;if(l){if(l!=t.child(i-1))break;--i,a.set(o,i),s.push(o)}}return{index:i,matched:a,matches:s.reverse()}}function zU(t,e){return t.type.side-e.type.side}function VU(t,e,r,n){let i=e.locals(t),a=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let c=t.child(u);n(c,i,e.forChild(a,c),u),a+=c.nodeSize}return}let s=0,o=[],l=null;for(let u=0;;){let c,f;for(;s<i.length&&i[s].to==a;){let w=i[s++];w.widget&&(c?(f||(f=[c])).push(w):c=w)}if(c)if(f){f.sort(zU);for(let w=0;w<f.length;w++)r(f[w],u,!!l)}else r(c,u,!!l);let m,g;if(l)g=-1,m=l,l=null;else if(u<t.childCount)g=u,m=t.child(u++);else break;for(let w=0;w<o.length;w++)o[w].to<=a&&o.splice(w--,1);for(;s<i.length&&i[s].from<=a&&i[s].to>a;)o.push(i[s++]);let y=a+m.nodeSize;if(m.isText){let w=y;s<i.length&&i[s].from<w&&(w=i[s].from);for(let N=0;N<o.length;N++)o[N].to<w&&(w=o[N].to);w<y&&(l=m.cut(w-a),m=m.cut(0,w-a),y=w,g=-1)}else for(;s<i.length&&i[s].to<y;)s++;let b=m.isInline&&!m.isLeaf?o.filter(w=>!w.inline):o.slice();n(m,b,e.forChild(a,m),g),a=y}}function UU(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function GU(t,e,r,n){for(let i=0,a=0;i<t.childCount&&a<=n;){let s=t.child(i++),o=a;if(a+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<t.childCount;){let u=t.child(i++);if(a+=u.nodeSize,!u.isText)break;l+=u.text}if(a>=r){if(a>=n&&l.slice(n-e.length-o,n-o)==e)return n-e.length;let u=o<n?l.lastIndexOf(e,n-o-1):-1;if(u>=0&&u+e.length+o>=r)return o+u;if(r==n&&l.length>=n+e.length-o&&l.slice(n-o,n-o+e.length)==e)return n}}return-1}function q2(t,e,r,n,i){let a=[];for(let s=0,o=0;s<t.length;s++){let l=t[s],u=o,c=o+=l.size;u>=r||c<=e?a.push(l):(u<e&&a.push(l.slice(0,e-u,n)),i&&(a.push(i),i=void 0),c>r&&a.push(l.slice(r-u,l.size,n)))}return a}function uk(t,e=null){let r=t.domSelectionRange(),n=t.state.doc;if(!r.focusNode)return null;let i=t.docView.nearestDesc(r.focusNode),a=i&&i.size==0,s=t.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(s<0)return null;let o=n.resolve(s),l,u;if(Px(r)){for(l=s;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&wt.isSelectable(f)&&i.parent&&!(f.isInline&&gU(r.focusNode,r.focusOffset,i.dom))){let m=i.posBefore;u=new wt(s==m?o:n.resolve(m))}}else{if(r instanceof t.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let f=s,m=s;for(let g=0;g<r.rangeCount;g++){let y=r.getRangeAt(g);f=Math.min(f,t.docView.posFromDOM(y.startContainer,y.startOffset,1)),m=Math.max(m,t.docView.posFromDOM(y.endContainer,y.endOffset,-1))}if(f<0)return null;[l,s]=m==t.state.selection.anchor?[m,f]:[f,m],o=n.resolve(s)}else l=t.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(l<0)return null}let c=n.resolve(l);if(!u){let f=e=="pointer"||t.state.selection.head<o.pos&&!a?1:-1;u=ck(t,c,o,f)}return u}function N8(t){return t.editable?t.hasFocus():T8(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function fl(t,e=!1){let r=t.state.selection;if(E8(t,r),!!N8(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&ti){let n=t.domSelectionRange(),i=t.domObserver.currentSelection;if(n.anchorNode&&i.anchorNode&&vd(n.anchorNode,n.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)qU(t);else{let{anchor:n,head:i}=r,a,s;N4&&!(r instanceof Dt)&&(r.$from.parent.inlineContent||(a=E4(t,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(s=E4(t,r.to))),t.docView.setSelection(n,i,t,e),N4&&(a&&T4(a),s&&T4(s)),r.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&HU(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const N4=Ci||ti&&f8<63;function E4(t,e){let{node:r,offset:n}=t.docView.domFromPos(e,0),i=n<r.childNodes.length?r.childNodes[n]:null,a=n?r.childNodes[n-1]:null;if(Ci&&i&&i.contentEditable=="false")return Lw(i);if((!i||i.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(i)return Lw(i);if(a)return Lw(a)}}function Lw(t){return t.contentEditable="true",Ci&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function T4(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function HU(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let r=t.domSelectionRange(),n=r.anchorNode,i=r.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(r.anchorNode!=n||r.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!N8(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function qU(t){let e=t.domSelection();if(!e)return;let r=t.cursorWrapper.dom,n=r.nodeName=="IMG";n?e.collapse(r.parentNode,bi(r)+1):e.collapse(r,0),!n&&!t.state.selection.visible&&Sa&&Ou<=11&&(r.disabled=!0,r.disabled=!1)}function E8(t,e){if(e instanceof wt){let r=t.docView.descAt(e.from);r!=t.lastSelectedViewDesc&&(j4(t),r&&r.selectNode(),t.lastSelectedViewDesc=r)}else j4(t)}function j4(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function ck(t,e,r,n){return t.someProp("createSelectionBetween",i=>i(t,e,r))||Dt.between(e,r,n)}function P4(t){return t.editable&&!t.hasFocus()?!1:T8(t)}function T8(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function WU(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),r=t.domSelectionRange();return vd(e.node,e.offset,r.anchorNode,r.anchorOffset)}function W2(t,e){let{$anchor:r,$head:n}=t.selection,i=e>0?r.max(n):r.min(n),a=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return a&&Ft.findFrom(a,e)}function xu(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function M4(t,e,r){let n=t.state.selection;if(n instanceof Dt)if(r.indexOf("s")>-1){let{$head:i}=n,a=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+a.nodeSize*(e<0?-1:1));return xu(t,new Dt(n.$anchor,s))}else if(n.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=W2(t.state,e);return i&&i instanceof wt?xu(t,i):!1}else if(!(as&&r.indexOf("m")>-1)){let i=n.$head,a=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!a||a.isText)return!1;let o=e<0?i.pos-a.nodeSize:i.pos;return a.isAtom||(s=t.docView.descAt(o))&&!s.contentDOM?wt.isSelectable(a)?xu(t,new wt(e<0?t.state.doc.resolve(i.pos-a.nodeSize):i)):Bg?xu(t,new Dt(t.state.doc.resolve(e<0?o:o+a.nodeSize))):!1:!1}}else return!1;else{if(n instanceof wt&&n.node.isInline)return xu(t,new Dt(e>0?n.$to:n.$from));{let i=W2(t.state,e);return i?xu(t,i):!1}}}function my(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Vm(t,e){let r=t.pmViewDesc;return r&&r.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function If(t,e){return e<0?$U(t):KU(t)}function $U(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i,a,s=!1;for(ds&&r.nodeType==1&&n<my(r)&&Vm(r.childNodes[n],-1)&&(s=!0);;)if(n>0){if(r.nodeType!=1)break;{let o=r.childNodes[n-1];if(Vm(o,-1))i=r,a=--n;else if(o.nodeType==3)r=o,n=r.nodeValue.length;else break}}else{if(j8(r))break;{let o=r.previousSibling;for(;o&&Vm(o,-1);)i=r.parentNode,a=bi(o),o=o.previousSibling;if(o)r=o,n=my(r);else{if(r=r.parentNode,r==t.dom)break;n=0}}}s?$2(t,r,n):i&&$2(t,i,a)}function KU(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i=my(r),a,s;for(;;)if(n<i){if(r.nodeType!=1)break;let o=r.childNodes[n];if(Vm(o,1))a=r,s=++n;else break}else{if(j8(r))break;{let o=r.nextSibling;for(;o&&Vm(o,1);)a=o.parentNode,s=bi(o)+1,o=o.nextSibling;if(o)r=o,n=0,i=my(r);else{if(r=r.parentNode,r==t.dom)break;n=i=0}}}a&&$2(t,a,s)}function j8(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function YU(t,e){for(;t&&e==t.childNodes.length&&!Lg(t);)e=bi(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let r=t.childNodes[e];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=0}}function XU(t,e){for(;t&&!e&&!Lg(t);)e=bi(t),t=t.parentNode;for(;t&&e;){let r=t.childNodes[e-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=t.childNodes.length}}function $2(t,e,r){if(e.nodeType!=3){let a,s;(s=YU(e,r))?(e=s,r=0):(a=XU(e,r))&&(e=a,r=a.nodeValue.length)}let n=t.domSelection();if(!n)return;if(Px(n)){let a=document.createRange();a.setEnd(e,r),a.setStart(e,r),n.removeAllRanges(),n.addRange(a)}else n.extend&&n.extend(e,r);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&fl(t)},50)}function _4(t,e){let r=t.state.doc.resolve(e);if(!(ti||h8)&&r.parent.inlineContent){let i=t.coordsAtPos(e);if(e>r.start()){let a=t.coordsAtPos(e-1),s=(a.top+a.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(a.left-i.left)>1)return a.left<i.left?"ltr":"rtl"}if(e<r.end()){let a=t.coordsAtPos(e+1),s=(a.top+a.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(a.left-i.left)>1)return a.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function A4(t,e,r){let n=t.state.selection;if(n instanceof Dt&&!n.empty||r.indexOf("s")>-1||as&&r.indexOf("m")>-1)return!1;let{$from:i,$to:a}=n;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=W2(t.state,e);if(s&&s instanceof wt)return xu(t,s)}if(!i.parent.inlineContent){let s=e<0?i:a,o=n instanceof za?Ft.near(s,e):Ft.findFrom(s,e);return o?xu(t,o):!1}return!1}function R4(t,e){if(!(t.state.selection instanceof Dt))return!0;let{$head:r,$anchor:n,empty:i}=t.state.selection;if(!r.sameParent(n))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let a=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(a&&!a.isText){let s=t.state.tr;return e<0?s.delete(r.pos-a.nodeSize,r.pos):s.delete(r.pos,r.pos+a.nodeSize),t.dispatch(s),!0}return!1}function D4(t,e,r){t.domObserver.stop(),e.contentEditable=r,t.domObserver.start()}function QU(t){if(!Ci||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:r}=t.domSelectionRange();if(e&&e.nodeType==1&&r==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let n=e.firstChild;D4(t,n,"true"),setTimeout(()=>D4(t,n,"false"),20)}return!1}function JU(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function ZU(t,e){let r=e.keyCode,n=JU(e);if(r==8||as&&r==72&&n=="c")return R4(t,-1)||If(t,-1);if(r==46&&!e.shiftKey||as&&r==68&&n=="c")return R4(t,1)||If(t,1);if(r==13||r==27)return!0;if(r==37||as&&r==66&&n=="c"){let i=r==37?_4(t,t.state.selection.from)=="ltr"?-1:1:-1;return M4(t,i,n)||If(t,i)}else if(r==39||as&&r==70&&n=="c"){let i=r==39?_4(t,t.state.selection.from)=="ltr"?1:-1:1;return M4(t,i,n)||If(t,i)}else{if(r==38||as&&r==80&&n=="c")return A4(t,-1,n)||If(t,-1);if(r==40||as&&r==78&&n=="c")return QU(t)||A4(t,1,n)||If(t,1);if(n==(as?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function dk(t,e){t.someProp("transformCopied",g=>{e=g(e,t)});let r=[],{content:n,openStart:i,openEnd:a}=e;for(;i>1&&a>1&&n.childCount==1&&n.firstChild.childCount==1;){i--,a--;let g=n.firstChild;r.push(g.type.name,g.attrs!=g.type.defaultAttrs?g.attrs:null),n=g.content}let s=t.someProp("clipboardSerializer")||Cd.fromSchema(t.state.schema),o=D8(),l=o.createElement("div");l.appendChild(s.serializeFragment(n,{document:o}));let u=l.firstChild,c,f=0;for(;u&&u.nodeType==1&&(c=R8[u.nodeName.toLowerCase()]);){for(let g=c.length-1;g>=0;g--){let y=o.createElement(c[g]);for(;l.firstChild;)y.appendChild(l.firstChild);l.appendChild(y),f++}u=l.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${a}${f?` -${f}`:""} ${JSON.stringify(r)}`);let m=t.someProp("clipboardTextSerializer",g=>g(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:m,slice:e}}function P8(t,e,r,n,i){let a=i.parent.type.spec.code,s,o;if(!r&&!e)return null;let l=!!e&&(n||a||!r);if(l){if(t.someProp("transformPastedText",m=>{e=m(e,a||n,t)}),a)return o=new st(Ve.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",m=>{o=m(o,t,!0)}),o;let f=t.someProp("clipboardTextParser",m=>m(e,i,n,t));if(f)o=f;else{let m=i.marks(),{schema:g}=t.state,y=Cd.fromSchema(g);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(b=>{let w=s.appendChild(document.createElement("p"));b&&w.appendChild(y.serializeNode(g.text(b,m)))})}}else t.someProp("transformPastedHTML",f=>{r=f(r,t)}),s=nG(r),Bg&&iG(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let m=s.firstChild;for(;m&&m.nodeType!=1;)m=m.nextSibling;if(!m)break;s=m}if(o||(o=(t.someProp("clipboardParser")||t.someProp("domParser")||Du.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||c),context:i,ruleFromNode(m){return m.nodeName=="BR"&&!m.nextSibling&&m.parentNode&&!eG.test(m.parentNode.nodeName)?{ignore:!0}:null}})),c)o=aG(O4(o,+c[1],+c[2]),c[4]);else if(o=st.maxOpen(tG(o.content,i),!0),o.openStart||o.openEnd){let f=0,m=0;for(let g=o.content.firstChild;f<o.openStart&&!g.type.spec.isolating;f++,g=g.firstChild);for(let g=o.content.lastChild;m<o.openEnd&&!g.type.spec.isolating;m++,g=g.lastChild);o=O4(o,f,m)}return t.someProp("transformPasted",f=>{o=f(o,t,l)}),o}const eG=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function tG(t,e){if(t.childCount<2)return t;for(let r=e.depth;r>=0;r--){let i=e.node(r).contentMatchAt(e.index(r)),a,s=[];if(t.forEach(o=>{if(!s)return;let l=i.findWrapping(o.type),u;if(!l)return s=null;if(u=s.length&&a.length&&_8(l,a,o,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=A8(s[s.length-1],a.length));let c=M8(o,l);s.push(c),i=i.matchType(c.type),a=l}}),s)return Ve.from(s)}return t}function M8(t,e,r=0){for(let n=e.length-1;n>=r;n--)t=e[n].create(null,Ve.from(t));return t}function _8(t,e,r,n,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let a=_8(t,e,r,n.lastChild,i+1);if(a)return n.copy(n.content.replaceChild(n.childCount-1,a));if(n.contentMatchAt(n.childCount).matchType(i==t.length-1?r.type:t[i+1]))return n.copy(n.content.append(Ve.from(M8(r,t,i+1))))}}function A8(t,e){if(e==0)return t;let r=t.content.replaceChild(t.childCount-1,A8(t.lastChild,e-1)),n=t.contentMatchAt(t.childCount).fillBefore(Ve.empty,!0);return t.copy(r.append(n))}function K2(t,e,r,n,i,a){let s=e<0?t.firstChild:t.lastChild,o=s.content;return t.childCount>1&&(a=0),i<n-1&&(o=K2(o,e,r,n,i+1,a)),i>=r&&(o=e<0?s.contentMatchAt(0).fillBefore(o,a<=i).append(o):o.append(s.contentMatchAt(s.childCount).fillBefore(Ve.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(o))}function O4(t,e,r){return e<t.openStart&&(t=new st(K2(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),r<t.openEnd&&(t=new st(K2(t.content,1,r,t.openEnd,0,0),t.openStart,r)),t}const R8={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let I4=null;function D8(){return I4||(I4=document.implementation.createHTMLDocument("title"))}let Bw=null;function rG(t){let e=window.trustedTypes;return e?(Bw||(Bw=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),Bw.createHTML(t)):t}function nG(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let r=D8().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(t),i;if((i=n&&R8[n[1].toLowerCase()])&&(t=i.map(a=>"<"+a+">").join("")+t+i.map(a=>"</"+a+">").reverse().join("")),r.innerHTML=rG(t),i)for(let a=0;a<i.length;a++)r=r.querySelector(i[a])||r;return r}function iG(t){let e=t.querySelectorAll(ti?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<e.length;r++){let n=e[r];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),n)}}function aG(t,e){if(!t.size)return t;let r=t.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return t}let{content:i,openStart:a,openEnd:s}=t;for(let o=n.length-2;o>=0;o-=2){let l=r.nodes[n[o]];if(!l||l.hasRequiredAttrs())break;i=Ve.from(l.create(n[o+1],i)),a++,s++}return new st(i,a,s)}const ta={},ra={},sG={touchstart:!0,touchmove:!0};class oG{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function lG(t){for(let e in ta){let r=ta[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=n=>{cG(t,n)&&!fk(t,n)&&(t.editable||!(n.type in ra))&&r(t,n)},sG[e]?{passive:!0}:void 0)}Ci&&t.dom.addEventListener("input",()=>null),Y2(t)}function Mu(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function uG(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Y2(t){t.someProp("handleDOMEvents",e=>{for(let r in e)t.input.eventHandlers[r]||t.dom.addEventListener(r,t.input.eventHandlers[r]=n=>fk(t,n))})}function fk(t,e){return t.someProp("handleDOMEvents",r=>{let n=r[e.type];return n?n(t,e)||e.defaultPrevented:!1})}function cG(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target;r!=t.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(e))return!1;return!0}function dG(t,e){!fk(t,e)&&ta[e.type]&&(t.editable||!(e.type in ra))&&ta[e.type](t,e)}ra.keydown=(t,e)=>{let r=e;if(t.input.shiftKey=r.keyCode==16||r.shiftKey,!I8(t,r)&&(t.input.lastKeyCode=r.keyCode,t.input.lastKeyCodeTime=Date.now(),!(cl&&ti&&r.keyCode==13)))if(r.keyCode!=229&&t.domObserver.forceFlush(),lh&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();t.input.lastIOSEnter=n,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==n&&(t.someProp("handleKeyDown",i=>i(t,Kc(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",n=>n(t,r))||ZU(t,r)?r.preventDefault():Mu(t,"key")};ra.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};ra.keypress=(t,e)=>{let r=e;if(I8(t,r)||!r.charCode||r.ctrlKey&&!r.altKey||as&&r.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,r))){r.preventDefault();return}let n=t.state.selection;if(!(n instanceof Dt)||!n.$from.sameParent(n.$to)){let i=String.fromCharCode(r.charCode),a=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",s=>s(t,n.$from.pos,n.$to.pos,i,a))&&t.dispatch(a()),r.preventDefault()}};function _x(t){return{left:t.clientX,top:t.clientY}}function fG(t,e){let r=e.x-t.clientX,n=e.y-t.clientY;return r*r+n*n<100}function hk(t,e,r,n,i){if(n==-1)return!1;let a=t.state.doc.resolve(n);for(let s=a.depth+1;s>0;s--)if(t.someProp(e,o=>s>a.depth?o(t,r,a.nodeAfter,a.before(s),i,!0):o(t,r,a.node(s),a.before(s),i,!1)))return!0;return!1}function eh(t,e,r){if(t.focused||t.focus(),t.state.selection.eq(e))return;let n=t.state.tr.setSelection(e);n.setMeta("pointer",!0),t.dispatch(n)}function hG(t,e){if(e==-1)return!1;let r=t.state.doc.resolve(e),n=r.nodeAfter;return n&&n.isAtom&&wt.isSelectable(n)?(eh(t,new wt(r)),!0):!1}function pG(t,e){if(e==-1)return!1;let r=t.state.selection,n,i;r instanceof wt&&(n=r.node);let a=t.state.doc.resolve(e);for(let s=a.depth+1;s>0;s--){let o=s>a.depth?a.nodeAfter:a.node(s);if(wt.isSelectable(o)){n&&r.$from.depth>0&&s>=r.$from.depth&&a.before(r.$from.depth+1)==r.$from.pos?i=a.before(r.$from.depth):i=a.before(s);break}}return i!=null?(eh(t,wt.create(t.state.doc,i)),!0):!1}function mG(t,e,r,n,i){return hk(t,"handleClickOn",e,r,n)||t.someProp("handleClick",a=>a(t,e,n))||(i?pG(t,r):hG(t,r))}function gG(t,e,r,n){return hk(t,"handleDoubleClickOn",e,r,n)||t.someProp("handleDoubleClick",i=>i(t,e,n))}function vG(t,e,r,n){return hk(t,"handleTripleClickOn",e,r,n)||t.someProp("handleTripleClick",i=>i(t,e,n))||yG(t,r,n)}function yG(t,e,r){if(r.button!=0)return!1;let n=t.state.doc;if(e==-1)return n.inlineContent?(eh(t,Dt.create(n,0,n.content.size)),!0):!1;let i=n.resolve(e);for(let a=i.depth+1;a>0;a--){let s=a>i.depth?i.nodeAfter:i.node(a),o=i.before(a);if(s.inlineContent)eh(t,Dt.create(n,o+1,o+1+s.content.size));else if(wt.isSelectable(s))eh(t,wt.create(n,o));else continue;return!0}}function pk(t){return gy(t)}const O8=as?"metaKey":"ctrlKey";ta.mousedown=(t,e)=>{let r=e;t.input.shiftKey=r.shiftKey;let n=pk(t),i=Date.now(),a="singleClick";i-t.input.lastClick.time<500&&fG(r,t.input.lastClick)&&!r[O8]&&t.input.lastClick.button==r.button&&(t.input.lastClick.type=="singleClick"?a="doubleClick":t.input.lastClick.type=="doubleClick"&&(a="tripleClick")),t.input.lastClick={time:i,x:r.clientX,y:r.clientY,type:a,button:r.button};let s=t.posAtCoords(_x(r));s&&(a=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new xG(t,s,r,!!n)):(a=="doubleClick"?gG:vG)(t,s.pos,s.inside,r)?r.preventDefault():Mu(t,"pointer"))};class xG{constructor(e,r,n,i){this.view=e,this.pos=r,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[O8],this.allowDefault=n.shiftKey;let a,s;if(r.inside>-1)a=e.state.doc.nodeAt(r.inside),s=r.inside;else{let c=e.state.doc.resolve(r.pos);a=c.parent,s=c.depth?c.before():0}const o=i?null:n.target,l=o?e.docView.nearestDesc(o,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:u}=e.state;(n.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||u instanceof wt&&u.from<=s&&u.to>s)&&(this.mightDrag={node:a,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&ds&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Mu(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>fl(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(_x(e))),this.updateAllowDefault(e),this.allowDefault||!r?Mu(this.view,"pointer"):mG(this.view,r.pos,r.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Ci&&this.mightDrag&&!this.mightDrag.node.isAtom||ti&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?(eh(this.view,Ft.near(this.view.state.doc.resolve(r.pos))),e.preventDefault()):Mu(this.view,"pointer")}move(e){this.updateAllowDefault(e),Mu(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}ta.touchstart=t=>{t.input.lastTouch=Date.now(),pk(t),Mu(t,"pointer")};ta.touchmove=t=>{t.input.lastTouch=Date.now(),Mu(t,"pointer")};ta.contextmenu=t=>pk(t);function I8(t,e){return t.composing?!0:Ci&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const bG=cl?5e3:-1;ra.compositionstart=ra.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,r=e.selection.$to;if(e.selection instanceof Dt&&(e.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)||ti&&h8&&wG(t)))t.markCursor=t.state.storedMarks||r.marks(),gy(t,!0),t.markCursor=null;else if(gy(t,!e.selection.empty),ds&&e.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=t.domSelectionRange();for(let i=n.focusNode,a=n.focusOffset;i&&i.nodeType==1&&a!=0;){let s=a<0?i.lastChild:i.childNodes[a-1];if(!s)break;if(s.nodeType==3){let o=t.domSelection();o&&o.collapse(s,s.nodeValue.length);break}else i=s,a=-1}}t.input.composing=!0}L8(t,bG)};function wG(t){let{focusNode:e,focusOffset:r}=t.domSelectionRange();if(!e||e.nodeType!=1||r>=e.childNodes.length)return!1;let n=e.childNodes[r];return n.nodeType==1&&n.contentEditable=="false"}ra.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,L8(t,20))};function L8(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>gy(t),e))}function B8(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=kG());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function SG(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let r=pU(e.focusNode,e.focusOffset),n=mU(e.focusNode,e.focusOffset);if(r&&n&&r!=n){let i=n.pmViewDesc,a=t.domObserver.lastChangedTextNode;if(r==a||n==a)return a;if(!i||!i.isText(n.nodeValue))return n;if(t.input.compositionNode==n){let s=r.pmViewDesc;if(!(!s||!s.isText(r.nodeValue)))return n}}return r||n}function kG(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function gy(t,e=!1){if(!(cl&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),B8(t),e||t.docView&&t.docView.dirty){let r=uk(t),n=t.state.selection;return r&&!r.eq(n)?t.dispatch(t.state.tr.setSelection(r)):(t.markCursor||e)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function CG(t,e){if(!t.dom.parentNode)return;let r=t.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(e),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),t.focus()},50)}const pg=Sa&&Ou<15||lh&&xU<604;ta.copy=ra.cut=(t,e)=>{let r=e,n=t.state.selection,i=r.type=="cut";if(n.empty)return;let a=pg?null:r.clipboardData,s=n.content(),{dom:o,text:l}=dk(t,s);a?(r.preventDefault(),a.clearData(),a.setData("text/html",o.innerHTML),a.setData("text/plain",l)):CG(t,o),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function NG(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function EG(t,e){if(!t.dom.parentNode)return;let r=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,n=t.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),n.parentNode&&n.parentNode.removeChild(n),r?mg(t,n.value,null,i,e):mg(t,n.textContent,n.innerHTML,i,e)},50)}function mg(t,e,r,n,i){let a=P8(t,e,r,n,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,i,a||st.empty)))return!0;if(!a)return!1;let s=NG(a),o=s?t.state.tr.replaceSelectionWith(s,n):t.state.tr.replaceSelection(a);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function F8(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let r=t.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}ra.paste=(t,e)=>{let r=e;if(t.composing&&!cl)return;let n=pg?null:r.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;n&&mg(t,F8(n),n.getData("text/html"),i,r)?r.preventDefault():EG(t,r)};class z8{constructor(e,r,n){this.slice=e,this.move=r,this.node=n}}const TG=as?"altKey":"ctrlKey";function V8(t,e){let r=t.someProp("dragCopies",n=>!n(e));return r??!e[TG]}ta.dragstart=(t,e)=>{let r=e,n=t.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let i=t.state.selection,a=i.empty?null:t.posAtCoords(_x(r)),s;if(!(a&&a.pos>=i.from&&a.pos<=(i instanceof wt?i.to-1:i.to))){if(n&&n.mightDrag)s=wt.create(t.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let f=t.docView.nearestDesc(r.target,!0);f&&f.node.type.spec.draggable&&f!=t.docView&&(s=wt.create(t.state.doc,f.posBefore))}}let o=(s||t.state.selection).content(),{dom:l,text:u,slice:c}=dk(t,o);(!r.dataTransfer.files.length||!ti||f8>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData(pg?"Text":"text/html",l.innerHTML),r.dataTransfer.effectAllowed="copyMove",pg||r.dataTransfer.setData("text/plain",u),t.dragging=new z8(c,V8(t,r),s)};ta.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};ra.dragover=ra.dragenter=(t,e)=>e.preventDefault();ra.drop=(t,e)=>{try{jG(t,e,t.dragging)}finally{t.dragging=null}};function jG(t,e,r){if(!e.dataTransfer)return;let n=t.posAtCoords(_x(e));if(!n)return;let i=t.state.doc.resolve(n.pos),a=r&&r.slice;a?t.someProp("transformPasted",g=>{a=g(a,t,!1)}):a=P8(t,F8(e.dataTransfer),pg?null:e.dataTransfer.getData("text/html"),!1,i);let s=!!(r&&V8(t,e));if(t.someProp("handleDrop",g=>g(t,e,a||st.empty,s))){e.preventDefault();return}if(!a)return;e.preventDefault();let o=a?qP(t.state.doc,i.pos,a):i.pos;o==null&&(o=i.pos);let l=t.state.tr;if(s){let{node:g}=r;g?g.replace(l):l.deleteSelection()}let u=l.mapping.map(o),c=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,f=l.doc;if(c?l.replaceRangeWith(u,u,a.content.firstChild):l.replaceRange(u,u,a),l.doc.eq(f))return;let m=l.doc.resolve(u);if(c&&wt.isSelectable(a.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(a.content.firstChild))l.setSelection(new wt(m));else{let g=l.mapping.map(o);l.mapping.maps[l.mapping.maps.length-1].forEach((y,b,w,N)=>g=N),l.setSelection(ck(t,m,l.doc.resolve(g)))}t.focus(),t.dispatch(l.setMeta("uiEvent","drop"))}ta.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&fl(t)},20))};ta.blur=(t,e)=>{let r=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),r.relatedTarget&&t.dom.contains(r.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};ta.beforeinput=(t,e)=>{if(ti&&cl&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:n}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=n||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",a=>a(t,Kc(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in ra)ta[t]=ra[t];function gg(t,e){if(t==e)return!0;for(let r in t)if(t[r]!==e[r])return!1;for(let r in e)if(!(r in t))return!1;return!0}class vy{constructor(e,r){this.toDOM=e,this.spec=r||nd,this.side=this.spec.side||0}map(e,r,n,i){let{pos:a,deleted:s}=e.mapResult(r.from+i,this.side<0?-1:1);return s?null:new Di(a-n,a-n,this)}valid(){return!0}eq(e){return this==e||e instanceof vy&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&gg(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Lu{constructor(e,r){this.attrs=e,this.spec=r||nd}map(e,r,n,i){let a=e.map(r.from+i,this.spec.inclusiveStart?-1:1)-n,s=e.map(r.to+i,this.spec.inclusiveEnd?1:-1)-n;return a>=s?null:new Di(a,s,this)}valid(e,r){return r.from<r.to}eq(e){return this==e||e instanceof Lu&&gg(this.attrs,e.attrs)&&gg(this.spec,e.spec)}static is(e){return e.type instanceof Lu}destroy(){}}class mk{constructor(e,r){this.attrs=e,this.spec=r||nd}map(e,r,n,i){let a=e.mapResult(r.from+i,1);if(a.deleted)return null;let s=e.mapResult(r.to+i,-1);return s.deleted||s.pos<=a.pos?null:new Di(a.pos-n,s.pos-n,this)}valid(e,r){let{index:n,offset:i}=e.content.findIndex(r.from),a;return i==r.from&&!(a=e.child(n)).isText&&i+a.nodeSize==r.to}eq(e){return this==e||e instanceof mk&&gg(this.attrs,e.attrs)&&gg(this.spec,e.spec)}destroy(){}}class Di{constructor(e,r,n){this.from=e,this.to=r,this.type=n}copy(e,r){return new Di(e,r,this.type)}eq(e,r=0){return this.type.eq(e.type)&&this.from+r==e.from&&this.to+r==e.to}map(e,r,n){return this.type.map(e,this,r,n)}static widget(e,r,n){return new Di(e,e,new vy(r,n))}static inline(e,r,n,i){return new Di(e,r,new Lu(n,i))}static node(e,r,n,i){return new Di(e,r,new mk(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Lu}get widget(){return this.type instanceof vy}}const zf=[],nd={};class Gr{constructor(e,r){this.local=e.length?e:zf,this.children=r.length?r:zf}static create(e,r){return r.length?yy(r,e,0,nd):Ri}find(e,r,n){let i=[];return this.findInner(e??0,r??1e9,i,0,n),i}findInner(e,r,n,i,a){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=r&&o.to>=e&&(!a||a(o.spec))&&n.push(o.copy(o.from+i,o.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<r&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,r-o,n,i+o,a)}}map(e,r,n){return this==Ri||e.maps.length==0?this:this.mapInner(e,r,0,0,n||nd)}mapInner(e,r,n,i,a){let s;for(let o=0;o<this.local.length;o++){let l=this.local[o].map(e,n,i);l&&l.type.valid(r,l)?(s||(s=[])).push(l):a.onRemove&&a.onRemove(this.local[o].spec)}return this.children.length?PG(this.children,s||[],e,r,n,i,a):s?new Gr(s.sort(ad),zf):Ri}add(e,r){return r.length?this==Ri?Gr.create(e,r):this.addInner(e,r,0):this}addInner(e,r,n){let i,a=0;e.forEach((o,l)=>{let u=l+n,c;if(c=G8(r,o,u)){for(i||(i=this.children.slice());a<i.length&&i[a]<l;)a+=3;i[a]==l?i[a+2]=i[a+2].addInner(o,c,u+1):i.splice(a,0,l,l+o.nodeSize,yy(c,o,u+1,nd)),a+=3}});let s=U8(a?H8(r):r,-n);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||s.splice(o--,1);return new Gr(s.length?this.local.concat(s).sort(ad):this.local,i||this.children)}remove(e){return e.length==0||this==Ri?this:this.removeInner(e,0)}removeInner(e,r){let n=this.children,i=this.local;for(let a=0;a<n.length;a+=3){let s,o=n[a]+r,l=n[a+1]+r;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>o&&f.to<l&&(e[c]=null,(s||(s=[])).push(f));if(!s)continue;n==this.children&&(n=this.children.slice());let u=n[a+2].removeInner(s,o+1);u!=Ri?n[a+2]=u:(n.splice(a,3),a-=3)}if(i.length){for(let a=0,s;a<e.length;a++)if(s=e[a])for(let o=0;o<i.length;o++)i[o].eq(s,r)&&(i==this.local&&(i=this.local.slice()),i.splice(o--,1))}return n==this.children&&i==this.local?this:i.length||n.length?new Gr(i,n):Ri}forChild(e,r){if(this==Ri)return this;if(r.isLeaf)return Gr.empty;let n,i;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}let a=e+1,s=a+r.content.size;for(let o=0;o<this.local.length;o++){let l=this.local[o];if(l.from<s&&l.to>a&&l.type instanceof Lu){let u=Math.max(a,l.from)-a,c=Math.min(s,l.to)-a;u<c&&(i||(i=[])).push(l.copy(u,c))}}if(i){let o=new Gr(i.sort(ad),zf);return n?new Su([o,n]):o}return n||Ri}eq(e){if(this==e)return!0;if(!(e instanceof Gr)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(e.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=e.children[r]||this.children[r+1]!=e.children[r+1]||!this.children[r+2].eq(e.children[r+2]))return!1;return!0}locals(e){return gk(this.localsInner(e))}localsInner(e){if(this==Ri)return zf;if(e.inlineContent||!this.local.some(Lu.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Lu||r.push(this.local[n]);return r}forEachSet(e){e(this)}}Gr.empty=new Gr([],[]);Gr.removeOverlap=gk;const Ri=Gr.empty;class Su{constructor(e){this.members=e}map(e,r){const n=this.members.map(i=>i.map(e,r,nd));return Su.from(n)}forChild(e,r){if(r.isLeaf)return Gr.empty;let n=[];for(let i=0;i<this.members.length;i++){let a=this.members[i].forChild(e,r);a!=Ri&&(a instanceof Su?n=n.concat(a.members):n.push(a))}return Su.from(n)}eq(e){if(!(e instanceof Su)||e.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(e.members[r]))return!1;return!0}locals(e){let r,n=!0;for(let i=0;i<this.members.length;i++){let a=this.members[i].localsInner(e);if(a.length)if(!r)r=a;else{n&&(r=r.slice(),n=!1);for(let s=0;s<a.length;s++)r.push(a[s])}}return r?gk(n?r:r.sort(ad)):zf}static from(e){switch(e.length){case 0:return Ri;case 1:return e[0];default:return new Su(e.every(r=>r instanceof Gr)?e:e.reduce((r,n)=>r.concat(n instanceof Gr?n:n.members),[]))}}forEachSet(e){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(e)}}function PG(t,e,r,n,i,a,s){let o=t.slice();for(let u=0,c=a;u<r.maps.length;u++){let f=0;r.maps[u].forEach((m,g,y,b)=>{let w=b-y-(g-m);for(let N=0;N<o.length;N+=3){let k=o[N+1];if(k<0||m>k+c-f)continue;let C=o[N]+c-f;g>=C?o[N+1]=m<=C?-2:-1:m>=c&&w&&(o[N]+=w,o[N+1]+=w)}f+=w}),c=r.maps[u].map(c,-1)}let l=!1;for(let u=0;u<o.length;u+=3)if(o[u+1]<0){if(o[u+1]==-2){l=!0,o[u+1]=-1;continue}let c=r.map(t[u]+a),f=c-i;if(f<0||f>=n.content.size){l=!0;continue}let m=r.map(t[u+1]+a,-1),g=m-i,{index:y,offset:b}=n.content.findIndex(f),w=n.maybeChild(y);if(w&&b==f&&b+w.nodeSize==g){let N=o[u+2].mapInner(r,w,c+1,t[u]+a+1,s);N!=Ri?(o[u]=f,o[u+1]=g,o[u+2]=N):(o[u+1]=-2,l=!0)}else l=!0}if(l){let u=MG(o,t,e,r,i,a,s),c=yy(u,n,0,s);e=c.local;for(let f=0;f<o.length;f+=3)o[f+1]<0&&(o.splice(f,3),f-=3);for(let f=0,m=0;f<c.children.length;f+=3){let g=c.children[f];for(;m<o.length&&o[m]<g;)m+=3;o.splice(m,0,c.children[f],c.children[f+1],c.children[f+2])}}return new Gr(e.sort(ad),o)}function U8(t,e){if(!e||!t.length)return t;let r=[];for(let n=0;n<t.length;n++){let i=t[n];r.push(new Di(i.from+e,i.to+e,i.type))}return r}function MG(t,e,r,n,i,a,s){function o(l,u){for(let c=0;c<l.local.length;c++){let f=l.local[c].map(n,i,u);f?r.push(f):s.onRemove&&s.onRemove(l.local[c].spec)}for(let c=0;c<l.children.length;c+=3)o(l.children[c+2],l.children[c]+u+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&o(t[l+2],e[l]+a+1);return r}function G8(t,e,r){if(e.isLeaf)return null;let n=r+e.nodeSize,i=null;for(let a=0,s;a<t.length;a++)(s=t[a])&&s.from>r&&s.to<n&&((i||(i=[])).push(s),t[a]=null);return i}function H8(t){let e=[];for(let r=0;r<t.length;r++)t[r]!=null&&e.push(t[r]);return e}function yy(t,e,r,n){let i=[],a=!1;e.forEach((o,l)=>{let u=G8(t,o,l+r);if(u){a=!0;let c=yy(u,o,r+l+1,n);c!=Ri&&i.push(l,l+o.nodeSize,c)}});let s=U8(a?H8(t):t,-r).sort(ad);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||(n.onRemove&&n.onRemove(s[o].spec),s.splice(o--,1));return s.length||i.length?new Gr(s,i):Ri}function ad(t,e){return t.from-e.from||t.to-e.to}function gk(t){let e=t;for(let r=0;r<e.length-1;r++){let n=e[r];if(n.from!=n.to)for(let i=r+1;i<e.length;i++){let a=e[i];if(a.from==n.from){a.to!=n.to&&(e==t&&(e=t.slice()),e[i]=a.copy(a.from,n.to),L4(e,i+1,a.copy(n.to,a.to)));continue}else{a.from<n.to&&(e==t&&(e=t.slice()),e[r]=n.copy(n.from,a.from),L4(e,i,n.copy(a.from,n.to)));break}}}return e}function L4(t,e,r){for(;e<t.length&&ad(r,t[e])>0;)e++;t.splice(e,0,r)}function Fw(t){let e=[];return t.someProp("decorations",r=>{let n=r(t.state);n&&n!=Ri&&e.push(n)}),t.cursorWrapper&&e.push(Gr.create(t.state.doc,[t.cursorWrapper.deco])),Su.from(e)}const _G={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},AG=Sa&&Ou<=11;class RG{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class DG{constructor(e,r){this.view=e,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new RG,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let i=0;i<n.length;i++)this.queue.push(n[i]);Sa&&Ou<=11&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():Ci&&e.composing&&n.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),AG&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,_G)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let r=0;r<e.length;r++)this.queue.push(e[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(P4(this.view)){if(this.suppressingSelectionUpdates)return fl(this.view);if(Sa&&Ou<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&vd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let r=new Set,n;for(let a=e.focusNode;a;a=oh(a))r.add(a);for(let a=e.anchorNode;a;a=oh(a))if(r.has(a)){n=a;break}let i=n&&this.view.docView.nearestDesc(n);if(i&&i.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&P4(e)&&!this.ignoreSelectionChange(n),a=-1,s=-1,o=!1,l=[];if(e.editable)for(let c=0;c<r.length;c++){let f=this.registerMutation(r[c],l);f&&(a=a<0?f.from:Math.min(f.from,a),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(o=!0))}if(ds&&l.length){let c=l.filter(f=>f.nodeName=="BR");if(c.length==2){let[f,m]=c;f.parentNode&&f.parentNode.parentNode==m.parentNode?m.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let m of c){let g=m.parentNode;g&&g.nodeName=="LI"&&(!f||LG(e,f)!=g)&&m.remove()}}}else if((ti||Ci)&&l.some(c=>c.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let c of l)if(c.nodeName=="BR"&&c.parentNode){let f=c.nextSibling;f&&f.nodeType==1&&f.contentEditable=="false"&&c.parentNode.removeChild(c)}}let u=null;a<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Px(n)&&(u=uk(e))&&u.eq(Ft.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,fl(e),this.currentSelection.set(n),e.scrollToSelection()):(a>-1||i)&&(a>-1&&(e.docView.markDirty(a,s),OG(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,BG(e,l)),this.handleDOMChange(a,s,o,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||fl(e),this.currentSelection.set(n))}registerMutation(e,r){if(r.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let f=e.addedNodes[c];r.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,a=e.nextSibling;if(Sa&&Ou<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:f,nextSibling:m}=e.addedNodes[c];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!m||Array.prototype.indexOf.call(e.addedNodes,m)<0)&&(a=m)}let s=i&&i.parentNode==e.target?bi(i)+1:0,o=n.localPosFromDOM(e.target,s,-1),l=a&&a.parentNode==e.target?bi(a):e.target.childNodes.length,u=n.localPosFromDOM(e.target,l,1);return{from:o,to:u}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let B4=new WeakMap,F4=!1;function OG(t){if(!B4.has(t)&&(B4.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=ds,F4)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),F4=!0}}function z4(t,e){let r=e.startContainer,n=e.startOffset,i=e.endContainer,a=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return vd(s.node,s.offset,i,a)&&([r,n,i,a]=[i,a,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:a}}function IG(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return z4(t,i)}let r;function n(i){i.preventDefault(),i.stopImmediatePropagation(),r=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0),r?z4(t,r):null}function LG(t,e){for(let r=e.parentNode;r&&r!=t.dom;r=r.parentNode){let n=t.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function BG(t,e){var r;let{focusNode:n,focusOffset:i}=t.domSelectionRange();for(let a of e)if(((r=a.parentNode)===null||r===void 0?void 0:r.nodeName)=="TR"){let s=a.nextSibling;for(;s&&s.nodeName!="TD"&&s.nodeName!="TH";)s=s.nextSibling;if(s){let o=s;for(;;){let l=o.firstChild;if(!l||l.nodeType!=1||l.contentEditable=="false"||/^(BR|IMG)$/.test(l.nodeName))break;o=l}o.insertBefore(a,o.firstChild),n==a&&t.domSelection().collapse(a,i)}else a.parentNode.removeChild(a)}}function FG(t,e,r){let{node:n,fromOffset:i,toOffset:a,from:s,to:o}=t.docView.parseRange(e,r),l=t.domSelectionRange(),u,c=l.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:l.anchorOffset}],Px(l)||u.push({node:l.focusNode,offset:l.focusOffset})),ti&&t.input.lastKeyCode===8)for(let w=a;w>i;w--){let N=n.childNodes[w-1],k=N.pmViewDesc;if(N.nodeName=="BR"&&!k){a=w;break}if(!k||k.size)break}let f=t.state.doc,m=t.someProp("domParser")||Du.fromSchema(t.state.schema),g=f.resolve(s),y=null,b=m.parse(n,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:a,preserveWhitespace:g.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:zG,context:g});if(u&&u[0].pos!=null){let w=u[0].pos,N=u[1]&&u[1].pos;N==null&&(N=w),y={anchor:w+s,head:N+s}}return{doc:b,sel:y,from:s,to:o}}function zG(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Ci&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(t.parentNode.lastChild==t||Ci&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const VG=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function UG(t,e,r,n,i){let a=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let A=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,I=uk(t,A);if(I&&!t.state.selection.eq(I)){if(ti&&cl&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",L=>L(t,Kc(13,"Enter"))))return;let D=t.state.tr.setSelection(I);A=="pointer"?D.setMeta("pointer",!0):A=="key"&&D.scrollIntoView(),a&&D.setMeta("composition",a),t.dispatch(D)}return}let s=t.state.doc.resolve(e),o=s.sharedDepth(r);e=s.before(o+1),r=t.state.doc.resolve(r).after(o+1);let l=t.state.selection,u=FG(t,e,r),c=t.state.doc,f=c.slice(u.from,u.to),m,g;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(m=t.state.selection.to,g="end"):(m=t.state.selection.from,g="start"),t.input.lastKeyCode=null;let y=qG(f.content,u.doc.content,u.from,m,g);if(y&&t.input.domChangeCount++,(lh&&t.input.lastIOSEnter>Date.now()-225||cl)&&i.some(A=>A.nodeType==1&&!VG.test(A.nodeName))&&(!y||y.endA>=y.endB)&&t.someProp("handleKeyDown",A=>A(t,Kc(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!y)if(n&&l instanceof Dt&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))y={start:l.from,endA:l.to,endB:l.to};else{if(u.sel){let A=V4(t,t.state.doc,u.sel);if(A&&!A.eq(t.state.selection)){let I=t.state.tr.setSelection(A);a&&I.setMeta("composition",a),t.dispatch(I)}}return}t.state.selection.from<t.state.selection.to&&y.start==y.endB&&t.state.selection instanceof Dt&&(y.start>t.state.selection.from&&y.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?y.start=t.state.selection.from:y.endA<t.state.selection.to&&y.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(y.endB+=t.state.selection.to-y.endA,y.endA=t.state.selection.to)),Sa&&Ou<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>u.from&&u.doc.textBetween(y.start-u.from-1,y.start-u.from+1)==" "&&(y.start--,y.endA--,y.endB--);let b=u.doc.resolveNoCache(y.start-u.from),w=u.doc.resolveNoCache(y.endB-u.from),N=c.resolve(y.start),k=b.sameParent(w)&&b.parent.inlineContent&&N.end()>=y.endA;if((lh&&t.input.lastIOSEnter>Date.now()-225&&(!k||i.some(A=>A.nodeName=="DIV"||A.nodeName=="P"))||!k&&b.pos<u.doc.content.size&&(!b.sameParent(w)||!b.parent.inlineContent)&&b.pos<w.pos&&!/\S/.test(u.doc.textBetween(b.pos,w.pos,"","")))&&t.someProp("handleKeyDown",A=>A(t,Kc(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>y.start&&HG(c,y.start,y.endA,b,w)&&t.someProp("handleKeyDown",A=>A(t,Kc(8,"Backspace")))){cl&&ti&&t.domObserver.suppressSelectionUpdates();return}ti&&y.endB==y.start&&(t.input.lastChromeDelete=Date.now()),cl&&!k&&b.start()!=w.start()&&w.parentOffset==0&&b.depth==w.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==y.endA&&(y.endB-=2,w=u.doc.resolveNoCache(y.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(A){return A(t,Kc(13,"Enter"))})},20));let C=y.start,E=y.endA,P=A=>{let I=A||t.state.tr.replace(C,E,u.doc.slice(y.start-u.from,y.endB-u.from));if(u.sel){let D=V4(t,I.doc,u.sel);D&&!(ti&&t.composing&&D.empty&&(y.start!=y.endB||t.input.lastChromeDelete<Date.now()-100)&&(D.head==C||D.head==I.mapping.map(E)-1)||Sa&&D.empty&&D.head==C)&&I.setSelection(D)}return a&&I.setMeta("composition",a),I.scrollIntoView()},_;if(k)if(b.pos==w.pos){Sa&&Ou<=11&&b.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>fl(t),20));let A=P(t.state.tr.delete(C,E)),I=c.resolve(y.start).marksAcross(c.resolve(y.endA));I&&A.ensureMarks(I),t.dispatch(A)}else if(y.endA==y.endB&&(_=GG(b.parent.content.cut(b.parentOffset,w.parentOffset),N.parent.content.cut(N.parentOffset,y.endA-N.start())))){let A=P(t.state.tr);_.type=="add"?A.addMark(C,E,_.mark):A.removeMark(C,E,_.mark),t.dispatch(A)}else if(b.parent.child(b.index()).isText&&b.index()==w.index()-(w.textOffset?0:1)){let A=b.parent.textBetween(b.parentOffset,w.parentOffset),I=()=>P(t.state.tr.insertText(A,C,E));t.someProp("handleTextInput",D=>D(t,C,E,A,I))||t.dispatch(I())}else t.dispatch(P());else t.dispatch(P())}function V4(t,e,r){return Math.max(r.anchor,r.head)>e.content.size?null:ck(t,e.resolve(r.anchor),e.resolve(r.head))}function GG(t,e){let r=t.firstChild.marks,n=e.firstChild.marks,i=r,a=n,s,o,l;for(let c=0;c<n.length;c++)i=n[c].removeFromSet(i);for(let c=0;c<r.length;c++)a=r[c].removeFromSet(a);if(i.length==1&&a.length==0)o=i[0],s="add",l=c=>c.mark(o.addToSet(c.marks));else if(i.length==0&&a.length==1)o=a[0],s="remove",l=c=>c.mark(o.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(l(e.child(c)));if(Ve.from(u).eq(t))return{mark:o,type:s}}function HG(t,e,r,n,i){if(r-e<=i.pos-n.pos||zw(n,!0,!1)<i.pos)return!1;let a=t.resolve(e);if(!n.parent.isTextblock){let o=a.nodeAfter;return o!=null&&r==e+o.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let s=t.resolve(zw(a,!0,!0));return!s.parent.isTextblock||s.pos>r||zw(s,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(s.parent.content)}function zw(t,e,r){let n=t.depth,i=e?t.end():t.pos;for(;n>0&&(e||t.indexAfter(n)==t.node(n).childCount);)n--,i++,e=!1;if(r){let a=t.node(n).maybeChild(t.indexAfter(n));for(;a&&!a.isLeaf;)a=a.firstChild,i++}return i}function qG(t,e,r,n,i){let a=t.findDiffStart(e,r);if(a==null)return null;let{a:s,b:o}=t.findDiffEnd(e,r+t.size,r+e.size);if(i=="end"){let l=Math.max(0,a-Math.min(s,o));n-=s+l-a}if(s<a&&t.size<e.size){let l=n<=a&&n>=s?a-n:0;a-=l,a&&a<e.size&&U4(e.textBetween(a-1,a+1))&&(a+=l?1:-1),o=a+(o-s),s=a}else if(o<a){let l=n<=a&&n>=o?a-n:0;a-=l,a&&a<t.size&&U4(t.textBetween(a-1,a+1))&&(a+=l?1:-1),s=a+(s-o),o=a}return{start:a,endA:s,endB:o}}function U4(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),r=t.charCodeAt(1);return e>=56320&&e<=57343&&r>=55296&&r<=56319}class q8{constructor(e,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new oG,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach($4),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=q4(this),H4(this),this.nodeViews=W4(this),this.docView=k4(this.state.doc,G4(this),Fw(this),this.dom,this),this.domObserver=new DG(this,(n,i,a,s)=>UG(this,n,i,a,s)),this.domObserver.start(),lG(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let r in e)this._props[r]=e[r];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Y2(this);let r=this._props;this._props=e,e.plugins&&(e.plugins.forEach($4),this.directPlugins=e.plugins),this.updateStateInner(e.state,r)}setProps(e){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in e)r[n]=e[n];this.update(r)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,r){var n;let i=this.state,a=!1,s=!1;e.storedMarks&&this.composing&&(B8(this),s=!0),this.state=e;let o=i.plugins!=e.plugins||this._props.plugins!=r.plugins;if(o||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let g=W4(this);$G(g,this.nodeViews)&&(this.nodeViews=g,a=!0)}(o||r.handleDOMEvents!=this._props.handleDOMEvents)&&Y2(this),this.editable=q4(this),H4(this);let l=Fw(this),u=G4(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=a||!this.docView.matchesNode(e.doc,u,l);(f||!e.selection.eq(i.selection))&&(s=!0);let m=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&SU(this);if(s){this.domObserver.stop();let g=f&&(Sa||ti)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&WG(i.selection,e.selection);if(f){let y=ti?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=SG(this)),(a||!this.docView.update(e.doc,u,l,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=k4(e.doc,u,l,this.dom,this)),y&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(g=!0)}g||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&WU(this))?fl(this,g):(E8(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((n=this.dragging)===null||n===void 0)&&n.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():m&&kU(m)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof wt){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&v4(this,r.getBoundingClientRect(),e)}else v4(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,e)}}updateDraggedNode(e,r){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let a=n.from+(this.state.doc.content.size-r.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==n.node&&(i=a)}this.dragging=new z8(e.slice,e.move,i<0?void 0:wt.create(this.state.doc,i))}someProp(e,r){let n=this._props&&this._props[e],i;if(n!=null&&(i=r?r(n):n))return i;for(let s=0;s<this.directPlugins.length;s++){let o=this.directPlugins[s].props[e];if(o!=null&&(i=r?r(o):o))return i}let a=this.state.plugins;if(a)for(let s=0;s<a.length;s++){let o=a[s].props[e];if(o!=null&&(i=r?r(o):o))return i}}hasFocus(){if(Sa){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&CU(this.dom),fl(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return e||document}updateRoot(){this._root=null}posAtCoords(e){return PU(this,e)}coordsAtPos(e,r=1){return y8(this,e,r)}domAtPos(e,r=0){return this.docView.domFromPos(e,r)}nodeDOM(e){let r=this.docView.descAt(e);return r?r.nodeDOM:null}posAtDOM(e,r,n=-1){let i=this.docView.posFromDOM(e,r,n);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,r){return DU(this,r||this.state,e)}pasteHTML(e,r){return mg(this,"",e,!1,r||new ClipboardEvent("paste"))}pasteText(e,r){return mg(this,e,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(e){return dk(this,e)}destroy(){this.docView&&(uG(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Fw(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,fU())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return dG(this,e)}domSelectionRange(){let e=this.domSelection();return e?Ci&&this.root.nodeType===11&&vU(this.dom.ownerDocument)==this.dom&&IG(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}q8.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function G4(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(t.state)),r)for(let n in r)n=="class"?e.class+=" "+r[n]:n=="style"?e.style=(e.style?e.style+";":"")+r[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(r[n]))}),e.translate||(e.translate="no"),[Di.node(0,t.state.doc.content.size,e)]}function H4(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Di.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function q4(t){return!t.someProp("editable",e=>e(t.state)===!1)}function WG(t,e){let r=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(r)!=e.$anchor.start(r)}function W4(t){let e=Object.create(null);function r(n){for(let i in n)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n[i])}return t.someProp("nodeViews",r),t.someProp("markViews",r),e}function $G(t,e){let r=0,n=0;for(let i in t){if(t[i]!=e[i])return!0;r++}for(let i in e)n++;return r!=n}function $4(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Hu={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},xy={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},KG=typeof navigator<"u"&&/Mac/.test(navigator.platform),YG=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var wi=0;wi<10;wi++)Hu[48+wi]=Hu[96+wi]=String(wi);for(var wi=1;wi<=24;wi++)Hu[wi+111]="F"+wi;for(var wi=65;wi<=90;wi++)Hu[wi]=String.fromCharCode(wi+32),xy[wi]=String.fromCharCode(wi);for(var Vw in Hu)xy.hasOwnProperty(Vw)||(xy[Vw]=Hu[Vw]);function XG(t){var e=KG&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||YG&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?xy:Hu)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const QG=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),JG=typeof navigator<"u"&&/Win/.test(navigator.platform);function ZG(t){let e=t.split(/-(?!$)/),r=e[e.length-1];r=="Space"&&(r=" ");let n,i,a,s;for(let o=0;o<e.length-1;o++){let l=e[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))QG?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(r="Alt-"+r),i&&(r="Ctrl-"+r),s&&(r="Meta-"+r),a&&(r="Shift-"+r),r}function eH(t){let e=Object.create(null);for(let r in t)e[ZG(r)]=t[r];return e}function Uw(t,e,r=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r&&e.shiftKey&&(t="Shift-"+t),t}function tH(t){return new Wr({props:{handleKeyDown:W8(t)}})}function W8(t){let e=eH(t);return function(r,n){let i=XG(n),a,s=e[Uw(i,n)];if(s&&s(r.state,r.dispatch,r))return!0;if(i.length==1&&i!=" "){if(n.shiftKey){let o=e[Uw(i,n,!1)];if(o&&o(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(JG&&n.ctrlKey&&n.altKey)&&(a=Hu[n.keyCode])&&a!=i){let o=e[Uw(a,n)];if(o&&o(r.state,r.dispatch,r))return!0}}return!1}}var rH=Object.defineProperty,vk=(t,e)=>{for(var r in e)rH(t,r,{get:e[r],enumerable:!0})};function Ax(t){const{state:e,transaction:r}=t;let{selection:n}=r,{doc:i}=r,{storedMarks:a}=r;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return n},get doc(){return i},get tr(){return n=r.selection,i=r.doc,a=r.storedMarks,r}}}var Rx=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:r}=this,{view:n}=e,{tr:i}=r,a=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([s,o])=>[s,(...u)=>{const c=o(...u)(a);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(i),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:r,editor:n,state:i}=this,{view:a}=n,s=[],o=!!t,l=t||i.tr,u=()=>(!o&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(l),s.every(f=>f===!0)),c={...Object.fromEntries(Object.entries(r).map(([f,m])=>[f,(...y)=>{const b=this.buildProps(l,e),w=m(...y)(b);return s.push(w),c}])),run:u};return c}createCan(t){const{rawCommands:e,state:r}=this,n=!1,i=t||r.tr,a=this.buildProps(i,n);return{...Object.fromEntries(Object.entries(e).map(([o,l])=>[o,(...u)=>l(...u)({...a,dispatch:void 0})])),chain:()=>this.createChain(i,n)}}buildProps(t,e=!0){const{rawCommands:r,editor:n,state:i}=this,{view:a}=n,s={tr:t,editor:n,view:a,state:Ax({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([o,l])=>[o,(...u)=>l(...u)(s)]))}};return s}},$8={};vk($8,{blur:()=>nH,clearContent:()=>iH,clearNodes:()=>aH,command:()=>sH,createParagraphNear:()=>oH,cut:()=>lH,deleteCurrentNode:()=>uH,deleteNode:()=>cH,deleteRange:()=>dH,deleteSelection:()=>fH,enter:()=>hH,exitCode:()=>pH,extendMarkRange:()=>mH,first:()=>gH,focus:()=>yH,forEach:()=>xH,insertContent:()=>bH,insertContentAt:()=>kH,joinBackward:()=>EH,joinDown:()=>NH,joinForward:()=>TH,joinItemBackward:()=>jH,joinItemForward:()=>PH,joinTextblockBackward:()=>MH,joinTextblockForward:()=>_H,joinUp:()=>CH,keyboardShortcut:()=>RH,lift:()=>DH,liftEmptyBlock:()=>OH,liftListItem:()=>IH,newlineInCode:()=>LH,resetAttributes:()=>BH,scrollIntoView:()=>FH,selectAll:()=>zH,selectNodeBackward:()=>VH,selectNodeForward:()=>UH,selectParentNode:()=>GH,selectTextblockEnd:()=>HH,selectTextblockStart:()=>qH,setContent:()=>WH,setMark:()=>fq,setMeta:()=>hq,setNode:()=>pq,setNodeSelection:()=>mq,setTextDirection:()=>gq,setTextSelection:()=>vq,sinkListItem:()=>yq,splitBlock:()=>xq,splitListItem:()=>bq,toggleList:()=>wq,toggleMark:()=>Sq,toggleNode:()=>kq,toggleWrap:()=>Cq,undoInputRule:()=>Nq,unsetAllMarks:()=>Eq,unsetMark:()=>Tq,unsetTextDirection:()=>jq,updateAttributes:()=>Pq,wrapIn:()=>Mq,wrapInList:()=>_q});var nH=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var r;t.isDestroyed||(e.dom.blur(),(r=window?.getSelection())==null||r.removeAllRanges())}),!0),iH=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),aH=()=>({state:t,tr:e,dispatch:r})=>{const{selection:n}=e,{ranges:i}=n;return r&&i.forEach(({$from:a,$to:s})=>{t.doc.nodesBetween(a.pos,s.pos,(o,l)=>{if(o.type.isText)return;const{doc:u,mapping:c}=e,f=u.resolve(c.map(l)),m=u.resolve(c.map(l+o.nodeSize)),g=f.blockRange(m);if(!g)return;const y=Eh(g);if(o.type.isTextblock){const{defaultType:b}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(g.start,b)}(y||y===0)&&e.lift(g,y)})}),!0},sH=t=>e=>t(e),oH=()=>({state:t,dispatch:e})=>o8(t,e),lH=(t,e)=>({editor:r,tr:n})=>{const{state:i}=r,a=i.doc.slice(t.from,t.to);n.deleteRange(t.from,t.to);const s=n.mapping.map(e);return n.insert(s,a.content),n.setSelection(new Dt(n.doc.resolve(Math.max(s-1,0)))),!0},uH=()=>({tr:t,dispatch:e})=>{const{selection:r}=t,n=r.$anchor.node();if(n.content.size>0)return!1;const i=t.selection.$anchor;for(let a=i.depth;a>0;a-=1)if(i.node(a).type===n.type){if(e){const o=i.before(a),l=i.after(a);t.delete(o,l).scrollIntoView()}return!0}return!1};function _n(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var cH=t=>({tr:e,state:r,dispatch:n})=>{const i=_n(t,r.schema),a=e.selection.$anchor;for(let s=a.depth;s>0;s-=1)if(a.node(s).type===i){if(n){const l=a.before(s),u=a.after(s);e.delete(l,u).scrollIntoView()}return!0}return!1},dH=t=>({tr:e,dispatch:r})=>{const{from:n,to:i}=t;return r&&e.delete(n,i),!0},fH=()=>({state:t,dispatch:e})=>nk(t,e),hH=()=>({commands:t})=>t.keyboardShortcut("Enter"),pH=()=>({state:t,dispatch:e})=>QV(t,e);function yk(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function by(t,e,r={strict:!0}){const n=Object.keys(e);return n.length?n.every(i=>r.strict?e[i]===t[i]:yk(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function K8(t,e,r={}){return t.find(n=>n.type===e&&by(Object.fromEntries(Object.keys(r).map(i=>[i,n.attrs[i]])),r))}function K4(t,e,r={}){return!!K8(t,e,r)}function xk(t,e,r){var n;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(c=>c.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(c=>c.type===e)||(r=r||((n=i.node.marks[0])==null?void 0:n.attrs),!K8([...i.node.marks],e,r)))return;let s=i.index,o=t.start()+i.offset,l=s+1,u=o+i.node.nodeSize;for(;s>0&&K4([...t.parent.child(s-1).marks],e,r);)s-=1,o-=t.parent.child(s).nodeSize;for(;l<t.parent.childCount&&K4([...t.parent.child(l).marks],e,r);)u+=t.parent.child(l).nodeSize,l+=1;return{from:o,to:u}}function bl(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var mH=(t,e={})=>({tr:r,state:n,dispatch:i})=>{const a=bl(t,n.schema),{doc:s,selection:o}=r,{$from:l,from:u,to:c}=o;if(i){const f=xk(l,a,e);if(f&&f.from<=u&&f.to>=c){const m=Dt.create(s,f.from,f.to);r.setSelection(m)}}return!0},gH=t=>e=>{const r=typeof t=="function"?t(e):t;for(let n=0;n<r.length;n+=1)if(r[n](e))return!0;return!1};function Y8(t){return t instanceof Dt}function Jc(t=0,e=0,r=0){return Math.min(Math.max(t,e),r)}function X8(t,e=null){if(!e)return null;const r=Ft.atStart(t),n=Ft.atEnd(t);if(e==="start"||e===!0)return r;if(e==="end")return n;const i=r.from,a=n.to;return e==="all"?Dt.create(t,Jc(0,i,a),Jc(t.content.size,i,a)):Dt.create(t,Jc(e,i,a),Jc(e,i,a))}function Y4(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function wy(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function vH(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var yH=(t=null,e={})=>({editor:r,view:n,tr:i,dispatch:a})=>{e={scrollIntoView:!0,...e};const s=()=>{(wy()||Y4())&&n.dom.focus(),vH()&&!wy()&&!Y4()&&n.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{r.isDestroyed||(n.focus(),e?.scrollIntoView&&r.commands.scrollIntoView())})};if(n.hasFocus()&&t===null||t===!1)return!0;if(a&&t===null&&!Y8(r.state.selection))return s(),!0;const o=X8(i.doc,t)||r.state.selection,l=r.state.selection.eq(o);return a&&(l||i.setSelection(o),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},xH=(t,e)=>r=>t.every((n,i)=>e(n,{...r,index:i})),bH=(t,e)=>({tr:r,commands:n})=>n.insertContentAt({from:r.selection.from,to:r.selection.to},t,e),Q8=t=>{const e=t.childNodes;for(let r=e.length-1;r>=0;r-=1){const n=e[r];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?t.removeChild(n):n.nodeType===1&&Q8(n)}return t};function g0(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,r=new window.DOMParser().parseFromString(e,"text/html").body;return Q8(r)}function vg(t,e,r){if(t instanceof cs||t instanceof Ve)return t;r={slice:!0,parseOptions:{},...r};const n=typeof t=="object"&&t!==null,i=typeof t=="string";if(n)try{if(Array.isArray(t)&&t.length>0)return Ve.fromArray(t.map(o=>e.nodeFromJSON(o)));const s=e.nodeFromJSON(t);return r.errorOnInvalidContent&&s.check(),s}catch(a){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",a),vg("",e,r)}if(i){if(r.errorOnInvalidContent){let s=!1,o="";const l=new DP({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(s=!0,o=typeof u=="string"?u:u.outerHTML,null)}]}})});if(r.slice?Du.fromSchema(l).parseSlice(g0(t),r.parseOptions):Du.fromSchema(l).parse(g0(t),r.parseOptions),r.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const a=Du.fromSchema(e);return r.slice?a.parseSlice(g0(t),r.parseOptions).content:a.parse(g0(t),r.parseOptions)}return vg("",e,r)}function wH(t,e,r){const n=t.steps.length-1;if(n<e)return;const i=t.steps[n];if(!(i instanceof ei||i instanceof ni))return;const a=t.mapping.maps[n];let s=0;a.forEach((o,l,u,c)=>{s===0&&(s=c)}),t.setSelection(Ft.near(t.doc.resolve(s),r))}var SH=t=>!("type"in t),kH=(t,e,r)=>({tr:n,dispatch:i,editor:a})=>{var s;if(i){r={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let o;const l=w=>{a.emit("contentError",{editor:a,error:w,disableCollaboration:()=>{"collaboration"in a.storage&&typeof a.storage.collaboration=="object"&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{vg(e,a.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(w){l(w)}try{o=vg(e,a.schema,{parseOptions:u,errorOnInvalidContent:(s=r.errorOnInvalidContent)!=null?s:a.options.enableContentCheck})}catch(w){return l(w),!1}let{from:c,to:f}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},m=!0,g=!0;if((SH(o)?o:[o]).forEach(w=>{w.check(),m=m?w.isText&&w.marks.length===0:!1,g=g?w.isBlock:!1}),c===f&&g){const{parent:w}=n.doc.resolve(c);w.isTextblock&&!w.type.spec.code&&!w.childCount&&(c-=1,f+=1)}let b;if(m){if(Array.isArray(e))b=e.map(w=>w.text||"").join("");else if(e instanceof Ve){let w="";e.forEach(N=>{N.text&&(w+=N.text)}),b=w}else typeof e=="object"&&e&&e.text?b=e.text:b=e;n.insertText(b,c,f)}else{b=o;const w=n.doc.resolve(c),N=w.node(),k=w.parentOffset===0,C=N.isText||N.isTextblock,E=N.content.size>0;k&&C&&E&&(c=Math.max(0,c-1)),n.replaceWith(c,f,b)}r.updateSelection&&wH(n,n.steps.length-1,-1),r.applyInputRules&&n.setMeta("applyInputRules",{from:c,text:b}),r.applyPasteRules&&n.setMeta("applyPasteRules",{from:c,text:b})}return!0},CH=()=>({state:t,dispatch:e})=>KV(t,e),NH=()=>({state:t,dispatch:e})=>YV(t,e),EH=()=>({state:t,dispatch:e})=>e8(t,e),TH=()=>({state:t,dispatch:e})=>i8(t,e),jH=()=>({state:t,dispatch:e,tr:r})=>{try{const n=Ex(t.doc,t.selection.$from.pos,-1);return n==null?!1:(r.join(n,2),e&&e(r),!0)}catch{return!1}},PH=()=>({state:t,dispatch:e,tr:r})=>{try{const n=Ex(t.doc,t.selection.$from.pos,1);return n==null?!1:(r.join(n,2),e&&e(r),!0)}catch{return!1}},MH=()=>({state:t,dispatch:e})=>WV(t,e),_H=()=>({state:t,dispatch:e})=>$V(t,e);function J8(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function AH(t){const e=t.split(/-(?!$)/);let r=e[e.length-1];r==="Space"&&(r=" ");let n,i,a,s;for(let o=0;o<e.length-1;o+=1){const l=e[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))wy()||J8()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(r=`Alt-${r}`),i&&(r=`Ctrl-${r}`),s&&(r=`Meta-${r}`),a&&(r=`Shift-${r}`),r}var RH=t=>({editor:e,view:r,tr:n,dispatch:i})=>{const a=AH(t).split(/-(?!$)/),s=a.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),o=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{r.someProp("handleKeyDown",u=>u(r,o))});return l?.steps.forEach(u=>{const c=u.map(n.mapping);c&&i&&n.maybeStep(c)}),!0};function qu(t,e,r={}){const{from:n,to:i,empty:a}=t.selection,s=e?_n(e,t.schema):null,o=[];t.doc.nodesBetween(n,i,(f,m)=>{if(f.isText)return;const g=Math.max(n,m),y=Math.min(i,m+f.nodeSize);o.push({node:f,from:g,to:y})});const l=i-n,u=o.filter(f=>s?s.name===f.node.type.name:!0).filter(f=>by(f.node.attrs,r,{strict:!1}));return a?!!u.length:u.reduce((f,m)=>f+m.to-m.from,0)>=l}var DH=(t,e={})=>({state:r,dispatch:n})=>{const i=_n(t,r.schema);return qu(r,i,e)?XV(r,n):!1},OH=()=>({state:t,dispatch:e})=>l8(t,e),IH=t=>({state:e,dispatch:r})=>{const n=_n(t,e.schema);return lU(n)(e,r)},LH=()=>({state:t,dispatch:e})=>s8(t,e);function Dx(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function X4(t,e){const r=typeof e=="string"?[e]:e;return Object.keys(t).reduce((n,i)=>(r.includes(i)||(n[i]=t[i]),n),{})}var BH=(t,e)=>({tr:r,state:n,dispatch:i})=>{let a=null,s=null;const o=Dx(typeof t=="string"?t:t.name,n.schema);if(!o)return!1;o==="node"&&(a=_n(t,n.schema)),o==="mark"&&(s=bl(t,n.schema));let l=!1;return r.selection.ranges.forEach(u=>{n.doc.nodesBetween(u.$from.pos,u.$to.pos,(c,f)=>{a&&a===c.type&&(l=!0,i&&r.setNodeMarkup(f,void 0,X4(c.attrs,e))),s&&c.marks.length&&c.marks.forEach(m=>{s===m.type&&(l=!0,i&&r.addMark(f,f+c.nodeSize,s.create(X4(m.attrs,e))))})})}),l},FH=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),zH=()=>({tr:t,dispatch:e})=>{if(e){const r=new za(t.doc);t.setSelection(r)}return!0},VH=()=>({state:t,dispatch:e})=>r8(t,e),UH=()=>({state:t,dispatch:e})=>a8(t,e),GH=()=>({state:t,dispatch:e})=>eU(t,e),HH=()=>({state:t,dispatch:e})=>nU(t,e),qH=()=>({state:t,dispatch:e})=>rU(t,e);function X2(t,e,r={},n={}){return vg(t,e,{slice:!1,parseOptions:r,errorOnInvalidContent:n.errorOnInvalidContent})}var WH=(t,{errorOnInvalidContent:e,emitUpdate:r=!0,parseOptions:n={}}={})=>({editor:i,tr:a,dispatch:s,commands:o})=>{const{doc:l}=a;if(n.preserveWhitespace!=="full"){const u=X2(t,i.schema,n,{errorOnInvalidContent:e??i.options.enableContentCheck});return s&&a.replaceWith(0,l.content.size,u).setMeta("preventUpdate",!r),!0}return s&&a.setMeta("preventUpdate",!r),o.insertContentAt({from:0,to:l.content.size},t,{parseOptions:n,errorOnInvalidContent:e??i.options.enableContentCheck})};function Z8(t,e){const r=bl(e,t.schema),{from:n,to:i,empty:a}=t.selection,s=[];a?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(n,i,l=>{s.push(...l.marks)});const o=s.find(l=>l.type.name===r.name);return o?{...o.attrs}:{}}function eM(t,e){const r=new XP(t);return e.forEach(n=>{n.steps.forEach(i=>{r.step(i)})}),r}function $H(t){for(let e=0;e<t.edgeCount;e+=1){const{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function KH(t,e,r){const n=[];return t.nodesBetween(e.from,e.to,(i,a)=>{r(i)&&n.push({node:i,pos:a})}),n}function YH(t,e){for(let r=t.depth;r>0;r-=1){const n=t.node(r);if(e(n))return{pos:r>0?t.before(r):0,start:t.start(r),depth:r,node:n}}}function Ox(t){return e=>YH(e.$from,t)}function yt(t,e,r){return t.config[e]===void 0&&t.parent?yt(t.parent,e,r):typeof t.config[e]=="function"?t.config[e].bind({...r,parent:t.parent?yt(t.parent,e,r):null}):t.config[e]}function bk(t){return t.map(e=>{const r={name:e.name,options:e.options,storage:e.storage},n=yt(e,"addExtensions",r);return n?[e,...bk(n())]:e}).flat(10)}function wk(t,e){const r=Cd.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(r),i.innerHTML}function tM(t){return typeof t=="function"}function fr(t,e=void 0,...r){return tM(t)?e?t.bind(e)(...r):t(...r):t}function XH(t={}){return Object.keys(t).length===0&&t.constructor===Object}function uh(t){const e=t.filter(i=>i.type==="extension"),r=t.filter(i=>i.type==="node"),n=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:r,markExtensions:n}}function rM(t){const e=[],{nodeExtensions:r,markExtensions:n}=uh(t),i=[...r,...n],a={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage,extensions:i},l=yt(s,"addGlobalAttributes",o);if(!l)return;l().forEach(c=>{c.types.forEach(f=>{Object.entries(c.attributes).forEach(([m,g])=>{e.push({type:f,name:m,attribute:{...a,...g}})})})})}),i.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage},l=yt(s,"addAttributes",o);if(!l)return;const u=l();Object.entries(u).forEach(([c,f])=>{const m={...a,...f};typeof m?.default=="function"&&(m.default=m.default()),m?.isRequired&&m?.default===void 0&&delete m.default,e.push({type:s.name,name:c,attribute:m})})}),e}function qr(...t){return t.filter(e=>!!e).reduce((e,r)=>{const n={...e};return Object.entries(r).forEach(([i,a])=>{if(!n[i]){n[i]=a;return}if(i==="class"){const o=a?String(a).split(" "):[],l=n[i]?n[i].split(" "):[],u=o.filter(c=>!l.includes(c));n[i]=[...l,...u].join(" ")}else if(i==="style"){const o=a?a.split(";").map(c=>c.trim()).filter(Boolean):[],l=n[i]?n[i].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;l.forEach(c=>{const[f,m]=c.split(":").map(g=>g.trim());u.set(f,m)}),o.forEach(c=>{const[f,m]=c.split(":").map(g=>g.trim());u.set(f,m)}),n[i]=Array.from(u.entries()).map(([c,f])=>`${c}: ${f}`).join("; ")}else n[i]=a}),n},{})}function yg(t,e){return e.filter(r=>r.type===t.type.name).filter(r=>r.attribute.rendered).map(r=>r.attribute.renderHTML?r.attribute.renderHTML(t.attrs)||{}:{[r.name]:t.attrs[r.name]}).reduce((r,n)=>qr(r,n),{})}function QH(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Q4(t,e){return"style"in t?t:{...t,getAttrs:r=>{const n=t.getAttrs?t.getAttrs(r):t.attrs;if(n===!1)return!1;const i=e.reduce((a,s)=>{const o=s.attribute.parseHTML?s.attribute.parseHTML(r):QH(r.getAttribute(s.name));return o==null?a:{...a,[s.name]:o}},{});return{...n,...i}}}}function J4(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>e==="attrs"&&XH(r)?!1:r!=null))}function Z4(t){var e,r;const n={};return!((e=t?.attribute)!=null&&e.isRequired)&&"default"in(t?.attribute||{})&&(n.default=t.attribute.default),((r=t?.attribute)==null?void 0:r.validate)!==void 0&&(n.validate=t.attribute.validate),[t.name,n]}function JH(t,e){var r;const n=rM(t),{nodeExtensions:i,markExtensions:a}=uh(t),s=(r=i.find(u=>yt(u,"topNode")))==null?void 0:r.name,o=Object.fromEntries(i.map(u=>{const c=n.filter(N=>N.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:e},m=t.reduce((N,k)=>{const C=yt(k,"extendNodeSchema",f);return{...N,...C?C(u):{}}},{}),g=J4({...m,content:fr(yt(u,"content",f)),marks:fr(yt(u,"marks",f)),group:fr(yt(u,"group",f)),inline:fr(yt(u,"inline",f)),atom:fr(yt(u,"atom",f)),selectable:fr(yt(u,"selectable",f)),draggable:fr(yt(u,"draggable",f)),code:fr(yt(u,"code",f)),whitespace:fr(yt(u,"whitespace",f)),linebreakReplacement:fr(yt(u,"linebreakReplacement",f)),defining:fr(yt(u,"defining",f)),isolating:fr(yt(u,"isolating",f)),attrs:Object.fromEntries(c.map(Z4))}),y=fr(yt(u,"parseHTML",f));y&&(g.parseDOM=y.map(N=>Q4(N,c)));const b=yt(u,"renderHTML",f);b&&(g.toDOM=N=>b({node:N,HTMLAttributes:yg(N,c)}));const w=yt(u,"renderText",f);return w&&(g.toText=w),[u.name,g]})),l=Object.fromEntries(a.map(u=>{const c=n.filter(w=>w.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:e},m=t.reduce((w,N)=>{const k=yt(N,"extendMarkSchema",f);return{...w,...k?k(u):{}}},{}),g=J4({...m,inclusive:fr(yt(u,"inclusive",f)),excludes:fr(yt(u,"excludes",f)),group:fr(yt(u,"group",f)),spanning:fr(yt(u,"spanning",f)),code:fr(yt(u,"code",f)),attrs:Object.fromEntries(c.map(Z4))}),y=fr(yt(u,"parseHTML",f));y&&(g.parseDOM=y.map(w=>Q4(w,c)));const b=yt(u,"renderHTML",f);return b&&(g.toDOM=w=>b({mark:w,HTMLAttributes:yg(w,c)})),[u.name,g]}));return new DP({topNode:s,nodes:o,marks:l})}function ZH(t){const e=t.filter((r,n)=>t.indexOf(r)!==n);return Array.from(new Set(e))}function Sy(t){return t.sort((r,n)=>{const i=yt(r,"priority")||100,a=yt(n,"priority")||100;return i>a?-1:i<a?1:0})}function nM(t){const e=Sy(bk(t)),r=ZH(e.map(n=>n.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),e}function iM(t,e,r){const{from:n,to:i}=e,{blockSeparator:a=`

`,textSerializers:s={}}=r||{};let o="";return t.nodesBetween(n,i,(l,u,c,f)=>{var m;l.isBlock&&u>n&&(o+=a);const g=s?.[l.type.name];if(g)return c&&(o+=g({node:l,pos:u,parent:c,index:f,range:e})),!1;l.isText&&(o+=(m=l?.text)==null?void 0:m.slice(Math.max(n,u)-u,i-u))}),o}function eq(t,e){const r={from:0,to:t.content.size};return iM(t,r,e)}function aM(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,r])=>[e,r.spec.toText]))}function tq(t,e){const r=_n(e,t.schema),{from:n,to:i}=t.selection,a=[];t.doc.nodesBetween(n,i,o=>{a.push(o)});const s=a.reverse().find(o=>o.type.name===r.name);return s?{...s.attrs}:{}}function sM(t,e){const r=Dx(typeof e=="string"?e:e.name,t.schema);return r==="node"?tq(t,e):r==="mark"?Z8(t,e):{}}function rq(t,e=JSON.stringify){const r={};return t.filter(n=>{const i=e(n);return Object.prototype.hasOwnProperty.call(r,i)?!1:r[i]=!0})}function nq(t){const e=rq(t);return e.length===1?e:e.filter((r,n)=>!e.filter((a,s)=>s!==n).some(a=>r.oldRange.from>=a.oldRange.from&&r.oldRange.to<=a.oldRange.to&&r.newRange.from>=a.newRange.from&&r.newRange.to<=a.newRange.to))}function oM(t){const{mapping:e,steps:r}=t,n=[];return e.maps.forEach((i,a)=>{const s=[];if(i.ranges.length)i.forEach((o,l)=>{s.push({from:o,to:l})});else{const{from:o,to:l}=r[a];if(o===void 0||l===void 0)return;s.push({from:o,to:l})}s.forEach(({from:o,to:l})=>{const u=e.slice(a).map(o,-1),c=e.slice(a).map(l),f=e.invert().map(u,-1),m=e.invert().map(c);n.push({oldRange:{from:f,to:m},newRange:{from:u,to:c}})})}),nq(n)}function Sk(t,e,r){const n=[];return t===e?r.resolve(t).marks().forEach(i=>{const a=r.resolve(t),s=xk(a,i.type);s&&n.push({mark:i,...s})}):r.nodesBetween(t,e,(i,a)=>{!i||i?.nodeSize===void 0||n.push(...i.marks.map(s=>({from:a,to:a+i.nodeSize,mark:s})))}),n}var iq=(t,e,r,n=20)=>{const i=t.doc.resolve(r);let a=n,s=null;for(;a>0&&s===null;){const o=i.node(a);o?.type.name===e?s=o:a-=1}return[s,a]};function v0(t,e){return e.nodes[t]||e.marks[t]||null}function U0(t,e,r){return Object.fromEntries(Object.entries(r).filter(([n])=>{const i=t.find(a=>a.type===e&&a.name===n);return i?i.attribute.keepOnSplit:!1}))}var aq=(t,e=500)=>{let r="";const n=t.parentOffset;return t.parent.nodesBetween(Math.max(0,n-e),n,(i,a,s,o)=>{var l,u;const c=((u=(l=i.type.spec).toText)==null?void 0:u.call(l,{node:i,pos:a,parent:s,index:o}))||i.textContent||"%leaf%";r+=i.isAtom&&!i.isText?c:c.slice(0,Math.max(0,n-a))}),r};function Q2(t,e,r={}){const{empty:n,ranges:i}=t.selection,a=e?bl(e,t.schema):null;if(n)return!!(t.storedMarks||t.selection.$from.marks()).filter(f=>a?a.name===f.type.name:!0).find(f=>by(f.attrs,r,{strict:!1}));let s=0;const o=[];if(i.forEach(({$from:f,$to:m})=>{const g=f.pos,y=m.pos;t.doc.nodesBetween(g,y,(b,w)=>{if(!b.isText&&!b.marks.length)return;const N=Math.max(g,w),k=Math.min(y,w+b.nodeSize),C=k-N;s+=C,o.push(...b.marks.map(E=>({mark:E,from:N,to:k})))})}),s===0)return!1;const l=o.filter(f=>a?a.name===f.mark.type.name:!0).filter(f=>by(f.mark.attrs,r,{strict:!1})).reduce((f,m)=>f+m.to-m.from,0),u=o.filter(f=>a?f.mark.type!==a&&f.mark.type.excludes(a):!0).reduce((f,m)=>f+m.to-m.from,0);return(l>0?l+u:l)>=s}function sq(t,e,r={}){if(!e)return qu(t,null,r)||Q2(t,null,r);const n=Dx(e,t.schema);return n==="node"?qu(t,e,r):n==="mark"?Q2(t,e,r):!1}var oq=(t,e)=>{const{$from:r,$to:n,$anchor:i}=t.selection;if(e){const a=Ox(o=>o.type.name===e)(t.selection);if(!a)return!1;const s=t.doc.resolve(a.pos+1);return i.pos+1===s.end()}return!(n.parentOffset<n.parent.nodeSize-2||r.pos!==n.pos)},lq=t=>{const{$from:e,$to:r}=t.selection;return!(e.parentOffset>0||e.pos!==r.pos)};function eT(t,e){return Array.isArray(e)?e.some(r=>(typeof r=="string"?r:r.name)===t.name):e}function tT(t,e){const{nodeExtensions:r}=uh(e),n=r.find(s=>s.name===t);if(!n)return!1;const i={name:n.name,options:n.options,storage:n.storage},a=fr(yt(n,"group",i));return typeof a!="string"?!1:a.split(" ").includes("list")}function Ix(t,{checkChildren:e=!0,ignoreWhitespace:r=!1}={}){var n;if(r){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((n=t.text)!=null?n:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(a=>{i!==!1&&(Ix(a,{ignoreWhitespace:r,checkChildren:e})||(i=!1))}),i}return!1}function lM(t){return t instanceof wt}var uM=class cM{constructor(e){this.position=e}static fromJSON(e){return new cM(e.position)}toJSON(){return{position:this.position}}};function uq(t,e){const r=e.mapping.mapResult(t.position);return{position:new uM(r.pos),mapResult:r}}function cq(t){return new uM(t)}function dq(t,e,r){var n;const{selection:i}=e;let a=null;if(Y8(i)&&(a=i.$cursor),a){const o=(n=t.storedMarks)!=null?n:a.marks();return a.parent.type.allowsMarkType(r)&&(!!r.isInSet(o)||!o.some(u=>u.type.excludes(r)))}const{ranges:s}=i;return s.some(({$from:o,$to:l})=>{let u=o.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(r):!1;return t.doc.nodesBetween(o.pos,l.pos,(c,f,m)=>{if(u)return!1;if(c.isInline){const g=!m||m.type.allowsMarkType(r),y=!!r.isInSet(c.marks)||!c.marks.some(b=>b.type.excludes(r));u=g&&y}return!u}),u})}var fq=(t,e={})=>({tr:r,state:n,dispatch:i})=>{const{selection:a}=r,{empty:s,ranges:o}=a,l=bl(t,n.schema);if(i)if(s){const u=Z8(n,l);r.addStoredMark(l.create({...u,...e}))}else o.forEach(u=>{const c=u.$from.pos,f=u.$to.pos;n.doc.nodesBetween(c,f,(m,g)=>{const y=Math.max(g,c),b=Math.min(g+m.nodeSize,f);m.marks.find(N=>N.type===l)?m.marks.forEach(N=>{l===N.type&&r.addMark(y,b,l.create({...N.attrs,...e}))}):r.addMark(y,b,l.create(e))})});return dq(n,r,l)},hq=(t,e)=>({tr:r})=>(r.setMeta(t,e),!0),pq=(t,e={})=>({state:r,dispatch:n,chain:i})=>{const a=_n(t,r.schema);let s;return r.selection.$anchor.sameParent(r.selection.$head)&&(s=r.selection.$anchor.parent.attrs),a.isTextblock?i().command(({commands:o})=>p4(a,{...s,...e})(r)?!0:o.clearNodes()).command(({state:o})=>p4(a,{...s,...e})(o,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},mq=t=>({tr:e,dispatch:r})=>{if(r){const{doc:n}=e,i=Jc(t,0,n.content.size),a=wt.create(n,i);e.setSelection(a)}return!0},gq=(t,e)=>({tr:r,state:n,dispatch:i})=>{const{selection:a}=n;let s,o;return typeof e=="number"?(s=e,o=e):e&&"from"in e&&"to"in e?(s=e.from,o=e.to):(s=a.from,o=a.to),i&&r.doc.nodesBetween(s,o,(l,u)=>{l.isText||r.setNodeMarkup(u,void 0,{...l.attrs,dir:t})}),!0},vq=t=>({tr:e,dispatch:r})=>{if(r){const{doc:n}=e,{from:i,to:a}=typeof t=="number"?{from:t,to:t}:t,s=Dt.atStart(n).from,o=Dt.atEnd(n).to,l=Jc(i,s,o),u=Jc(a,s,o),c=Dt.create(n,l,u);e.setSelection(c)}return!0},yq=t=>({state:e,dispatch:r})=>{const n=_n(t,e.schema);return dU(n)(e,r)};function rT(t,e){const r=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(r){const n=r.filter(i=>e?.includes(i.type.name));t.tr.ensureMarks(n)}}var xq=({keepMarks:t=!0}={})=>({tr:e,state:r,dispatch:n,editor:i})=>{const{selection:a,doc:s}=e,{$from:o,$to:l}=a,u=i.extensionManager.attributes,c=U0(u,o.node().type.name,o.node().attrs);if(a instanceof wt&&a.node.isBlock)return!o.parentOffset||!dl(s,o.pos)?!1:(n&&(t&&rT(r,i.extensionManager.splittableMarks),e.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;const f=l.parentOffset===l.parent.content.size,m=o.depth===0?void 0:$H(o.node(-1).contentMatchAt(o.indexAfter(-1)));let g=f&&m?[{type:m,attrs:c}]:void 0,y=dl(e.doc,e.mapping.map(o.pos),1,g);if(!g&&!y&&dl(e.doc,e.mapping.map(o.pos),1,m?[{type:m}]:void 0)&&(y=!0,g=m?[{type:m,attrs:c}]:void 0),n){if(y&&(a instanceof Dt&&e.deleteSelection(),e.split(e.mapping.map(o.pos),1,g),m&&!f&&!o.parentOffset&&o.parent.type!==m)){const b=e.mapping.map(o.before()),w=e.doc.resolve(b);o.node(-1).canReplaceWith(w.index(),w.index()+1,m)&&e.setNodeMarkup(e.mapping.map(o.before()),m)}t&&rT(r,i.extensionManager.splittableMarks),e.scrollIntoView()}return y},bq=(t,e={})=>({tr:r,state:n,dispatch:i,editor:a})=>{var s;const o=_n(t,n.schema),{$from:l,$to:u}=n.selection,c=n.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(u))return!1;const f=l.node(-1);if(f.type!==o)return!1;const m=a.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==o||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let N=Ve.empty;const k=l.index(-1)?1:l.index(-2)?2:3;for(let I=l.depth-k;I>=l.depth-3;I-=1)N=Ve.from(l.node(I).copy(N));const C=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,E={...U0(m,l.node().type.name,l.node().attrs),...e},P=((s=o.contentMatch.defaultType)==null?void 0:s.createAndFill(E))||void 0;N=N.append(Ve.from(o.createAndFill(null,P)||void 0));const _=l.before(l.depth-(k-1));r.replace(_,l.after(-C),new st(N,4-k,0));let A=-1;r.doc.nodesBetween(_,r.doc.content.size,(I,D)=>{if(A>-1)return!1;I.isTextblock&&I.content.size===0&&(A=D+1)}),A>-1&&r.setSelection(Dt.near(r.doc.resolve(A))),r.scrollIntoView()}return!0}const g=u.pos===l.end()?f.contentMatchAt(0).defaultType:null,y={...U0(m,f.type.name,f.attrs),...e},b={...U0(m,l.node().type.name,l.node().attrs),...e};r.delete(l.pos,u.pos);const w=g?[{type:o,attrs:y},{type:g,attrs:b}]:[{type:o,attrs:y}];if(!dl(r.doc,l.pos,2))return!1;if(i){const{selection:N,storedMarks:k}=n,{splittableMarks:C}=a.extensionManager,E=k||N.$to.parentOffset&&N.$from.marks();if(r.split(l.pos,2,w).scrollIntoView(),!E||!i)return!0;const P=E.filter(_=>C.includes(_.type.name));r.ensureMarks(P)}return!0},Gw=(t,e)=>{const r=Ox(s=>s.type===e)(t.selection);if(!r)return!0;const n=t.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(n===void 0)return!0;const i=t.doc.nodeAt(n);return r.node.type===i?.type&&ec(t.doc,r.pos)&&t.join(r.pos),!0},Hw=(t,e)=>{const r=Ox(s=>s.type===e)(t.selection);if(!r)return!0;const n=t.doc.resolve(r.start).after(r.depth);if(n===void 0)return!0;const i=t.doc.nodeAt(n);return r.node.type===i?.type&&ec(t.doc,n)&&t.join(n),!0},wq=(t,e,r,n={})=>({editor:i,tr:a,state:s,dispatch:o,chain:l,commands:u,can:c})=>{const{extensions:f,splittableMarks:m}=i.extensionManager,g=_n(t,s.schema),y=_n(e,s.schema),{selection:b,storedMarks:w}=s,{$from:N,$to:k}=b,C=N.blockRange(k),E=w||b.$to.parentOffset&&b.$from.marks();if(!C)return!1;const P=Ox(_=>tT(_.type.name,f))(b);if(C.depth>=1&&P&&C.depth-P.depth<=1){if(P.node.type===g)return u.liftListItem(y);if(tT(P.node.type.name,f)&&g.validContent(P.node.content)&&o)return l().command(()=>(a.setNodeMarkup(P.pos,g),!0)).command(()=>Gw(a,g)).command(()=>Hw(a,g)).run()}return!r||!E||!o?l().command(()=>c().wrapInList(g,n)?!0:u.clearNodes()).wrapInList(g,n).command(()=>Gw(a,g)).command(()=>Hw(a,g)).run():l().command(()=>{const _=c().wrapInList(g,n),A=E.filter(I=>m.includes(I.type.name));return a.ensureMarks(A),_?!0:u.clearNodes()}).wrapInList(g,n).command(()=>Gw(a,g)).command(()=>Hw(a,g)).run()},Sq=(t,e={},r={})=>({state:n,commands:i})=>{const{extendEmptyMarkRange:a=!1}=r,s=bl(t,n.schema);return Q2(n,s,e)?i.unsetMark(s,{extendEmptyMarkRange:a}):i.setMark(s,e)},kq=(t,e,r={})=>({state:n,commands:i})=>{const a=_n(t,n.schema),s=_n(e,n.schema),o=qu(n,a,r);let l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),o?i.setNode(s,l):i.setNode(a,{...l,...r})},Cq=(t,e={})=>({state:r,commands:n})=>{const i=_n(t,r.schema);return qu(r,i,e)?n.lift(i):n.wrapIn(i,e)},Nq=()=>({state:t,dispatch:e})=>{const r=t.plugins;for(let n=0;n<r.length;n+=1){const i=r[n];let a;if(i.spec.isInputRules&&(a=i.getState(t))){if(e){const s=t.tr,o=a.transform;for(let l=o.steps.length-1;l>=0;l-=1)s.step(o.steps[l].invert(o.docs[l]));if(a.text){const l=s.doc.resolve(a.from).marks();s.replaceWith(a.from,a.to,t.schema.text(a.text,l))}else s.delete(a.from,a.to)}return!0}}return!1},Eq=()=>({tr:t,dispatch:e})=>{const{selection:r}=t,{empty:n,ranges:i}=r;return n||e&&i.forEach(a=>{t.removeMark(a.$from.pos,a.$to.pos)}),!0},Tq=(t,e={})=>({tr:r,state:n,dispatch:i})=>{var a;const{extendEmptyMarkRange:s=!1}=e,{selection:o}=r,l=bl(t,n.schema),{$from:u,empty:c,ranges:f}=o;if(!i)return!0;if(c&&s){let{from:m,to:g}=o;const y=(a=u.marks().find(w=>w.type===l))==null?void 0:a.attrs,b=xk(u,l,y);b&&(m=b.from,g=b.to),r.removeMark(m,g,l)}else f.forEach(m=>{r.removeMark(m.$from.pos,m.$to.pos,l)});return r.removeStoredMark(l),!0},jq=t=>({tr:e,state:r,dispatch:n})=>{const{selection:i}=r;let a,s;return typeof t=="number"?(a=t,s=t):t&&"from"in t&&"to"in t?(a=t.from,s=t.to):(a=i.from,s=i.to),n&&e.doc.nodesBetween(a,s,(o,l)=>{if(o.isText)return;const u={...o.attrs};delete u.dir,e.setNodeMarkup(l,void 0,u)}),!0},Pq=(t,e={})=>({tr:r,state:n,dispatch:i})=>{let a=null,s=null;const o=Dx(typeof t=="string"?t:t.name,n.schema);if(!o)return!1;o==="node"&&(a=_n(t,n.schema)),o==="mark"&&(s=bl(t,n.schema));let l=!1;return r.selection.ranges.forEach(u=>{const c=u.$from.pos,f=u.$to.pos;let m,g,y,b;r.selection.empty?n.doc.nodesBetween(c,f,(w,N)=>{a&&a===w.type&&(l=!0,y=Math.max(N,c),b=Math.min(N+w.nodeSize,f),m=N,g=w)}):n.doc.nodesBetween(c,f,(w,N)=>{N<c&&a&&a===w.type&&(l=!0,y=Math.max(N,c),b=Math.min(N+w.nodeSize,f),m=N,g=w),N>=c&&N<=f&&(a&&a===w.type&&(l=!0,i&&r.setNodeMarkup(N,void 0,{...w.attrs,...e})),s&&w.marks.length&&w.marks.forEach(k=>{if(s===k.type&&(l=!0,i)){const C=Math.max(N,c),E=Math.min(N+w.nodeSize,f);r.addMark(C,E,s.create({...k.attrs,...e}))}}))}),g&&(m!==void 0&&i&&r.setNodeMarkup(m,void 0,{...g.attrs,...e}),s&&g.marks.length&&g.marks.forEach(w=>{s===w.type&&i&&r.addMark(y,b,s.create({...w.attrs,...e}))}))}),l},Mq=(t,e={})=>({state:r,dispatch:n})=>{const i=_n(t,r.schema);return iU(i,e)(r,n)},_q=(t,e={})=>({state:r,dispatch:n})=>{const i=_n(t,r.schema);return aU(i,e)(r,n)},Aq=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const r=this.callbacks[t];return r&&r.forEach(n=>n.apply(this,e)),this}off(t,e){const r=this.callbacks[t];return r&&(e?this.callbacks[t]=r.filter(n=>n!==e):delete this.callbacks[t]),this}once(t,e){const r=(...n)=>{this.off(t,r),e.apply(this,n)};return this.on(t,r)}removeAllListeners(){this.callbacks={}}},Lx=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},Rq=(t,e)=>{if(yk(e))return e.exec(t);const r=e(t);if(!r)return null;const n=[r.text];return n.index=r.index,n.input=t,n.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(r.replaceWith)),n};function y0(t){var e;const{editor:r,from:n,to:i,text:a,rules:s,plugin:o}=t,{view:l}=r;if(l.composing)return!1;const u=l.state.doc.resolve(n);if(u.parent.type.spec.code||(e=u.nodeBefore||u.nodeAfter)!=null&&e.marks.find(m=>m.type.spec.code))return!1;let c=!1;const f=aq(u)+a;return s.forEach(m=>{if(c)return;const g=Rq(f,m.find);if(!g)return;const y=l.state.tr,b=Ax({state:l.state,transaction:y}),w={from:n-(g[0].length-a.length),to:i},{commands:N,chain:k,can:C}=new Rx({editor:r,state:b});m.handler({state:b,range:w,match:g,commands:N,chain:k,can:C})===null||!y.steps.length||(m.undoable&&y.setMeta(o,{transform:y,from:n,to:i,text:a}),l.dispatch(y),c=!0)}),c}function Dq(t){const{editor:e,rules:r}=t,n=new Wr({state:{init(){return null},apply(i,a,s){const o=i.getMeta(n);if(o)return o;const l=i.getMeta("applyInputRules");return l&&setTimeout(()=>{let{text:c}=l;typeof c=="string"?c=c:c=wk(Ve.from(c),s.schema);const{from:f}=l,m=f+c.length;y0({editor:e,from:f,to:m,text:c,rules:r,plugin:n})}),i.selectionSet||i.docChanged?null:a}},props:{handleTextInput(i,a,s,o){return y0({editor:e,from:a,to:s,text:o,rules:r,plugin:n})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:a}=i.state.selection;a&&y0({editor:e,from:a.pos,to:a.pos,text:"",rules:r,plugin:n})}),!1)},handleKeyDown(i,a){if(a.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?y0({editor:e,from:s.pos,to:s.pos,text:`
`,rules:r,plugin:n}):!1}},isInputRules:!0});return n}function Oq(t){return Object.prototype.toString.call(t).slice(8,-1)}function x0(t){return Oq(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function dM(t,e){const r={...t};return x0(t)&&x0(e)&&Object.keys(e).forEach(n=>{x0(e[n])&&x0(t[n])?r[n]=dM(t[n],e[n]):r[n]=e[n]}),r}var kk=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...fr(yt(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...fr(yt(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>dM(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},Nd=class fM extends kk{constructor(){super(...arguments),this.type="mark"}static create(e={}){const r=typeof e=="function"?e():e;return new fM(r)}static handleExit({editor:e,mark:r}){const{tr:n}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(u=>u?.type.name===r.name))return!1;const l=s.find(u=>u?.type.name===r.name);return l&&n.removeStoredMark(l),n.insertText(" ",i.pos),e.view.dispatch(n),!0}return!1}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}};function Iq(t){return typeof t=="number"}var Lq=class{constructor(t){this.find=t.find,this.handler=t.handler}},Bq=(t,e,r)=>{if(yk(e))return[...t.matchAll(e)];const n=e(t,r);return n?n.map(i=>{const a=[i.text];return a.index=i.index,a.input=t,a.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(i.replaceWith)),a}):[]};function Fq(t){const{editor:e,state:r,from:n,to:i,rule:a,pasteEvent:s,dropEvent:o}=t,{commands:l,chain:u,can:c}=new Rx({editor:e,state:r}),f=[];return r.doc.nodesBetween(n,i,(g,y)=>{var b,w,N,k,C;if((w=(b=g.type)==null?void 0:b.spec)!=null&&w.code||!(g.isText||g.isTextblock||g.isInline))return;const E=(C=(k=(N=g.content)==null?void 0:N.size)!=null?k:g.nodeSize)!=null?C:0,P=Math.max(n,y),_=Math.min(i,y+E);if(P>=_)return;const A=g.isText?g.text||"":g.textBetween(P-y,_-y,void 0,"");Bq(A,a.find,s).forEach(D=>{if(D.index===void 0)return;const L=P+D.index+1,U=L+D[0].length,H={from:r.tr.mapping.map(L),to:r.tr.mapping.map(U)},M=a.handler({state:r,range:H,match:D,commands:l,chain:u,can:c,pasteEvent:s,dropEvent:o});f.push(M)})}),f.every(g=>g!==null)}var b0=null,zq=t=>{var e;const r=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=r.clipboardData)==null||e.setData("text/html",t),r};function Vq(t){const{editor:e,rules:r}=t;let n=null,i=!1,a=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o;try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}const l=({state:c,from:f,to:m,rule:g,pasteEvt:y})=>{const b=c.tr,w=Ax({state:c,transaction:b});if(!(!Fq({editor:e,state:w,from:Math.max(f-1,0),to:m.b-1,rule:g,pasteEvent:y,dropEvent:o})||!b.steps.length)){try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,b}};return r.map(c=>new Wr({view(f){const m=y=>{var b;n=(b=f.dom.parentElement)!=null&&b.contains(y.target)?f.dom.parentElement:null,n&&(b0=e)},g=()=>{b0&&(b0=null)};return window.addEventListener("dragstart",m),window.addEventListener("dragend",g),{destroy(){window.removeEventListener("dragstart",m),window.removeEventListener("dragend",g)}}},props:{handleDOMEvents:{drop:(f,m)=>{if(a=n===f.dom.parentElement,o=m,!a){const g=b0;g?.isEditable&&setTimeout(()=>{const y=g.state.selection;y&&g.commands.deleteRange({from:y.from,to:y.to})},10)}return!1},paste:(f,m)=>{var g;const y=(g=m.clipboardData)==null?void 0:g.getData("text/html");return s=m,i=!!y?.includes("data-pm-slice"),!1}}},appendTransaction:(f,m,g)=>{const y=f[0],b=y.getMeta("uiEvent")==="paste"&&!i,w=y.getMeta("uiEvent")==="drop"&&!a,N=y.getMeta("applyPasteRules"),k=!!N;if(!b&&!w&&!k)return;if(k){let{text:P}=N;typeof P=="string"?P=P:P=wk(Ve.from(P),g.schema);const{from:_}=N,A=_+P.length,I=zq(P);return l({rule:c,state:g,from:_,to:{b:A},pasteEvt:I})}const C=m.doc.content.findDiffStart(g.doc.content),E=m.doc.content.findDiffEnd(g.doc.content);if(!(!Iq(C)||!E||C===E.b))return l({rule:c,state:g,from:C,to:E,pasteEvt:s})}}))}var Bx=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=nM(t),this.schema=JH(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:v0(e.name,this.schema)},n=yt(e,"addCommands",r);return n?{...t,...n()}:t},{})}get plugins(){const{editor:t}=this;return Sy([...this.extensions].reverse()).flatMap(n=>{const i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:v0(n.name,this.schema)},a=[],s=yt(n,"addKeyboardShortcuts",i);let o={};if(n.type==="mark"&&yt(n,"exitable",i)&&(o.ArrowRight=()=>Nd.handleExit({editor:t,mark:n})),s){const m=Object.fromEntries(Object.entries(s()).map(([g,y])=>[g,()=>y({editor:t})]));o={...o,...m}}const l=tH(o);a.push(l);const u=yt(n,"addInputRules",i);if(eT(n,t.options.enableInputRules)&&u){const m=u();if(m&&m.length){const g=Dq({editor:t,rules:m}),y=Array.isArray(g)?g:[g];a.push(...y)}}const c=yt(n,"addPasteRules",i);if(eT(n,t.options.enablePasteRules)&&c){const m=c();if(m&&m.length){const g=Vq({editor:t,rules:m});a.push(...g)}}const f=yt(n,"addProseMirrorPlugins",i);if(f){const m=f();a.push(...m)}return a})}get attributes(){return rM(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=uh(this.extensions);return Object.fromEntries(e.filter(r=>!!yt(r,"addNodeView")).map(r=>{const n=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:_n(r.name,this.schema)},a=yt(r,"addNodeView",i);if(!a)return[];const s=a();if(!s)return[];const o=(l,u,c,f,m)=>{const g=yg(l,n);return s({node:l,view:u,getPos:c,decorations:f,innerDecorations:m,editor:t,extension:r,HTMLAttributes:g})};return[r.name,o]}))}dispatchTransaction(t){const{editor:e}=this;return Sy([...this.extensions].reverse()).reduceRight((n,i)=>{const a={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:e,type:v0(i.name,this.schema)},s=yt(i,"dispatchTransaction",a);return s?o=>{s.call(a,{transaction:o,next:n})}:n},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=uh(this.extensions);return Object.fromEntries(e.filter(r=>!!yt(r,"addMarkView")).map(r=>{const n=this.attributes.filter(o=>o.type===r.name),i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:bl(r.name,this.schema)},a=yt(r,"addMarkView",i);if(!a)return[];const s=(o,l,u)=>{const c=yg(o,n);return a()({mark:o,view:l,inline:u,editor:t,extension:r,HTMLAttributes:c,updateAttributes:f=>{tW(o,t,f)}})};return[r.name,s]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var r;const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:v0(e.name,this.schema)};e.type==="mark"&&((r=fr(yt(e,"keepOnSplit",n)))==null||r)&&this.splittableMarks.push(e.name);const i=yt(e,"onBeforeCreate",n),a=yt(e,"onCreate",n),s=yt(e,"onUpdate",n),o=yt(e,"onSelectionUpdate",n),l=yt(e,"onTransaction",n),u=yt(e,"onFocus",n),c=yt(e,"onBlur",n),f=yt(e,"onDestroy",n);i&&this.editor.on("beforeCreate",i),a&&this.editor.on("create",a),s&&this.editor.on("update",s),o&&this.editor.on("selectionUpdate",o),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),f&&this.editor.on("destroy",f)})}};Bx.resolve=nM;Bx.sort=Sy;Bx.flatten=bk;var Uq={};vk(Uq,{ClipboardTextSerializer:()=>pM,Commands:()=>mM,Delete:()=>gM,Drop:()=>vM,Editable:()=>yM,FocusEvents:()=>bM,Keymap:()=>wM,Paste:()=>SM,Tabindex:()=>kM,TextDirection:()=>CM,focusEventsPluginKey:()=>xM});var Sn=class hM extends kk{constructor(){super(...arguments),this.type="extension"}static create(e={}){const r=typeof e=="function"?e():e;return new hM(r)}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}},pM=Sn.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Wr({key:new wn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:r}=t,{doc:n,selection:i}=e,{ranges:a}=i,s=Math.min(...a.map(c=>c.$from.pos)),o=Math.max(...a.map(c=>c.$to.pos)),l=aM(r);return iM(n,{from:s,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),mM=Sn.create({name:"commands",addCommands(){return{...$8}}}),gM=Sn.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var r,n,i;const a=()=>{var s,o,l,u;if((u=(l=(o=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:o.filterTransaction)==null?void 0:l.call(o,t))!=null?u:t.getMeta("y-sync$"))return;const c=eM(t.before,[t,...e]);oM(c).forEach(g=>{c.mapping.mapResult(g.oldRange.from).deletedAfter&&c.mapping.mapResult(g.oldRange.to).deletedBefore&&c.before.nodesBetween(g.oldRange.from,g.oldRange.to,(y,b)=>{const w=b+y.nodeSize-2,N=g.oldRange.from<=b&&w<=g.oldRange.to;this.editor.emit("delete",{type:"node",node:y,from:b,to:w,newFrom:c.mapping.map(b),newTo:c.mapping.map(w),deletedRange:g.oldRange,newRange:g.newRange,partial:!N,editor:this.editor,transaction:t,combinedTransform:c})})});const m=c.mapping;c.steps.forEach((g,y)=>{var b,w;if(g instanceof Is){const N=m.slice(y).map(g.from,-1),k=m.slice(y).map(g.to),C=m.invert().map(N,-1),E=m.invert().map(k),P=(b=c.doc.nodeAt(N-1))==null?void 0:b.marks.some(A=>A.eq(g.mark)),_=(w=c.doc.nodeAt(k))==null?void 0:w.marks.some(A=>A.eq(g.mark));this.editor.emit("delete",{type:"mark",mark:g.mark,from:g.from,to:g.to,deletedRange:{from:C,to:E},newRange:{from:N,to:k},partial:!!(_||P),editor:this.editor,transaction:t,combinedTransform:c})}})};(i=(n=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:n.async)==null||i?setTimeout(a,0):a()}}),vM=Sn.create({name:"drop",addProseMirrorPlugins(){return[new Wr({key:new wn("tiptapDrop"),props:{handleDrop:(t,e,r,n)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:r,moved:n})}}})]}}),yM=Sn.create({name:"editable",addProseMirrorPlugins(){return[new Wr({key:new wn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),xM=new wn("focusEvents"),bM=Sn.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Wr({key:xM,props:{handleDOMEvents:{focus:(e,r)=>{t.isFocused=!0;const n=t.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,r)=>{t.isFocused=!1;const n=t.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}}),wM=Sn.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:o})=>{const{selection:l,doc:u}=o,{empty:c,$anchor:f}=l,{pos:m,parent:g}=f,y=f.parent.isTextblock&&m>0?o.doc.resolve(m-1):f,b=y.parent.type.spec.isolating,w=f.pos-f.parentOffset,N=b&&y.parent.childCount===1?w===f.pos:Ft.atStart(u).from===m;return!c||!g.type.isTextblock||g.textContent.length||!N||N&&f.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},a={...n,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return wy()||J8()?a:i},addProseMirrorPlugins(){return[new Wr({key:new wn("clearDocument"),appendTransaction:(t,e,r)=>{if(t.some(b=>b.getMeta("composition")))return;const n=t.some(b=>b.docChanged)&&!e.doc.eq(r.doc),i=t.some(b=>b.getMeta("preventClearDocument"));if(!n||i)return;const{empty:a,from:s,to:o}=e.selection,l=Ft.atStart(e.doc).from,u=Ft.atEnd(e.doc).to;if(a||!(s===l&&o===u)||!Ix(r.doc))return;const m=r.tr,g=Ax({state:r,transaction:m}),{commands:y}=new Rx({editor:this.editor,state:g});if(y.clearNodes(),!!m.steps.length)return m}})]}}),SM=Sn.create({name:"paste",addProseMirrorPlugins(){return[new Wr({key:new wn("tiptapPaste"),props:{handlePaste:(t,e,r)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:r})}}})]}}),kM=Sn.create({name:"tabindex",addProseMirrorPlugins(){return[new Wr({key:new wn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),CM=Sn.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=uh(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const r=e.getAttribute("dir");return r&&(r==="ltr"||r==="rtl"||r==="auto")?r:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new Wr({key:new wn("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),Gq=class Vf{constructor(e,r,n=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=r,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let r=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}r=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:r,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),r=this.resolvedPos.doc.resolve(e);return new Vf(r,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Vf(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Vf(e,this.editor)}get children(){const e=[];return this.node.content.forEach((r,n)=>{const i=r.isBlock&&!r.isTextblock,a=r.isAtom&&!r.isText,s=this.pos+n+(a?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const o=this.resolvedPos.doc.resolve(s);if(!i&&o.depth<=this.depth)return;const l=new Vf(o,this.editor,i,i?r:null);i&&(l.actualDepth=this.depth+1),e.push(new Vf(o,this.editor,i,i?r:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,r={}){let n=null,i=this.parent;for(;i&&!n;){if(i.node.type.name===e)if(Object.keys(r).length>0){const a=i.node.attrs,s=Object.keys(r);for(let o=0;o<s.length;o+=1){const l=s[o];if(a[l]!==r[l])break}}else n=i;i=i.parent}return n}querySelector(e,r={}){return this.querySelectorAll(e,r,!0)[0]||null}querySelectorAll(e,r={},n=!1){let i=[];if(!this.children||this.children.length===0)return i;const a=Object.keys(r);return this.children.forEach(s=>{n&&i.length>0||(s.node.type.name===e&&a.every(l=>r[l]===s.node.attrs[l])&&i.push(s),!(n&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,r,n))))}),i}setAttribute(e){const{tr:r}=this.editor.state;r.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(r)}},Hq=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function qq(t,e,r){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}var Wq=class extends Aq{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:uq,createMappablePosition:cq},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:i,moved:a})=>this.options.onDrop(n,i,a)),this.on("paste",({event:n,slice:i})=>this.options.onPaste(n,i)),this.on("delete",this.options.onDelete);const e=this.createDoc(),r=X8(e,this.options.autofocus);this.editorState=$f.create({doc:e,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t?.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=qq(Hq,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const r=tM(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let r=e;if([].concat(t).forEach(i=>{const a=typeof i=="string"?`${i}$`:i.key;r=r.filter(s=>!s.key.startsWith(a))}),e.length===r.length)return;const n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}createExtensionManager(){var t,e;const n=[...this.options.enableCoreExtensions?[yM,pM.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),mM,bM,wM,kM,vM,SM,gM,CM.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new Bx(n,this)}createCommandManager(){this.commandManager=new Rx({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=X2(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),t=X2(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:r}=this.options,n=e.dispatchTransaction||this.dispatchTransaction.bind(this),i=r?this.extensionManager.dispatchTransaction(n):n;this.editorView=new q8(t,{...e,attributes:{role:"textbox",...e?.attributes},dispatchTransaction:i,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const a=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(a),this.prependClass(),this.injectCSS();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(u=>{var c;return(c=this.capturedTransaction)==null?void 0:c.step(u)});return}const{state:e,transactions:r}=this.state.applyTransaction(t),n=!this.state.selection.eq(e.selection),i=r.includes(t),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:r.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=r.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),o=s?.getMeta("focus"),l=s?.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),!(t.getMeta("preventUpdate")||!r.some(u=>u.docChanged)||a.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:r.slice(1)})}getAttributes(t){return sM(this.state,t)}isActive(t,e){const r=typeof t=="string"?t:null,n=typeof t=="string"?e:t;return sq(this.state,r,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return wk(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:r={}}=t||{};return eq(this.state.doc,{blockSeparator:e,textSerializers:{...aM(this.schema),...r}})}get isEmpty(){return Ix(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var r;return((r=this.$doc)==null?void 0:r.querySelector(t,e))||null}$nodes(t,e){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new Gq(e,this)}get $doc(){return this.$pos(0)}};function ch(t){return new Lx({find:t.find,handler:({state:e,range:r,match:n})=>{const i=fr(t.getAttributes,void 0,n);if(i===!1||i===null)return null;const{tr:a}=e,s=n[n.length-1],o=n[0];if(s){const l=o.search(/\S/),u=r.from+o.indexOf(s),c=u+s.length;if(Sk(r.from,r.to,e.doc).filter(g=>g.mark.type.excluded.find(b=>b===t.type&&b!==g.mark.type)).filter(g=>g.to>u).length)return null;c<r.to&&a.delete(c,r.to),u>r.from&&a.delete(r.from+l,u);const m=r.from+l+s.length;a.addMark(r.from+l,m,t.type.create(i||{})),a.removeStoredMark(t.type)}},undoable:t.undoable})}function $q(t){return new Lx({find:t.find,handler:({state:e,range:r,match:n})=>{const i=fr(t.getAttributes,void 0,n)||{},{tr:a}=e,s=r.from;let o=r.to;const l=t.type.create(i);if(n[1]){const u=n[0].lastIndexOf(n[1]);let c=s+u;c>o?c=o:o=c+n[1].length;const f=n[0][n[0].length-1];a.insertText(f,s+n[0].length-1),a.replaceWith(c,o,l)}else if(n[0]){const u=t.type.isInline?s:s-1;a.insert(u,t.type.create(i)).delete(a.mapping.map(s),a.mapping.map(o))}a.scrollIntoView()},undoable:t.undoable})}function J2(t){return new Lx({find:t.find,handler:({state:e,range:r,match:n})=>{const i=e.doc.resolve(r.from),a=fr(t.getAttributes,void 0,n)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(r.from,r.to).setBlockType(r.from,r.from,t.type,a)},undoable:t.undoable})}function dh(t){return new Lx({find:t.find,handler:({state:e,range:r,match:n,chain:i})=>{const a=fr(t.getAttributes,void 0,n)||{},s=e.tr.delete(r.from,r.to),l=s.doc.resolve(r.from).blockRange(),u=l&&tk(l,t.type,a);if(!u)return null;if(s.wrap(l,u),t.keepMarks&&t.editor){const{selection:f,storedMarks:m}=e,{splittableMarks:g}=t.editor.extensionManager,y=m||f.$to.parentOffset&&f.$from.marks();if(y){const b=y.filter(w=>g.includes(w.type.name));s.ensureMarks(b)}}if(t.keepAttributes){const f=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,a).run()}const c=s.doc.resolve(r.from-1).nodeBefore;c&&c.type===t.type&&ec(s.doc,r.from-1)&&(!t.joinPredicate||t.joinPredicate(n,c))&&s.join(r.from-1)},undoable:t.undoable})}function Kq(t,e){const{selection:r}=t,{$from:n}=r;if(r instanceof wt){const a=n.index();return n.parent.canReplaceWith(a,a+1,e)}let i=n.depth;for(;i>=0;){const a=n.index(i);if(n.node(i).contentMatchAt(a).matchType(e))return!0;i-=1}return!1}function Yq(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var Xq={};vk(Xq,{createAtomBlockMarkdownSpec:()=>Qq,createBlockMarkdownSpec:()=>Jq,createInlineMarkdownSpec:()=>NM,parseAttributes:()=>Ck,parseIndentedBlocks:()=>Z2,renderNestedMarkdownContent:()=>Ek,serializeAttributes:()=>Nk});function Ck(t){if(!t?.trim())return{};const e={},r=[],n=t.replace(/["']([^"']*)["']/g,u=>(r.push(u),`__QUOTED_${r.length-1}__`)),i=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const u=i.map(c=>c.trim().slice(1));e.class=u.join(" ")}const a=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);a&&(e.id=a[1]);const s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(s)).forEach(([,u,c])=>{var f;const m=parseInt(((f=c.match(/__QUOTED_(\d+)__/))==null?void 0:f[1])||"0",10),g=r[m];g&&(e[u]=g.slice(1,-1))});const l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(c=>{c.match(/^[a-zA-Z][\w-]*$/)&&(e[c]=!0)}),e}function Nk(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(n=>e.push(`.${n}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([r,n])=>{r==="class"||r==="id"||(n===!0?e.push(r):n!==!1&&n!=null&&e.push(`${r}="${String(n)}"`))}),e.join(" ")}function Qq(t){const{nodeName:e,name:r,parseAttributes:n=Ck,serializeAttributes:i=Nk,defaultAttributes:a={},requiredAttributes:s=[],allowedAttributes:o}=t,l=r||e,u=c=>{if(!o)return c;const f={};return o.forEach(m=>{m in c&&(f[m]=c[m])}),f};return{parseMarkdown:(c,f)=>{const m={...a,...c.attributes};return f.createNode(e,m,[])},markdownTokenizer:{name:e,level:"block",start(c){var f;const m=new RegExp(`^:::${l}(?:\\s|$)`,"m"),g=(f=c.match(m))==null?void 0:f.index;return g!==void 0?g:-1},tokenize(c,f,m){const g=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),y=c.match(g);if(!y)return;const b=y[1]||"",w=n(b);if(!s.find(k=>!(k in w)))return{type:e,raw:y[0],attributes:w}}},renderMarkdown:c=>{const f=u(c.attrs||{}),m=i(f),g=m?` {${m}}`:"";return`:::${l}${g} :::`}}}function Jq(t){const{nodeName:e,name:r,getContent:n,parseAttributes:i=Ck,serializeAttributes:a=Nk,defaultAttributes:s={},content:o="block",allowedAttributes:l}=t,u=r||e,c=f=>{if(!l)return f;const m={};return l.forEach(g=>{g in f&&(m[g]=f[g])}),m};return{parseMarkdown:(f,m)=>{let g;if(n){const b=n(f);g=typeof b=="string"?[{type:"text",text:b}]:b}else o==="block"?g=m.parseChildren(f.tokens||[]):g=m.parseInline(f.tokens||[]);const y={...s,...f.attributes};return m.createNode(e,y,g)},markdownTokenizer:{name:e,level:"block",start(f){var m;const g=new RegExp(`^:::${u}`,"m"),y=(m=f.match(g))==null?void 0:m.index;return y!==void 0?y:-1},tokenize(f,m,g){var y;const b=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),w=f.match(b);if(!w)return;const[N,k=""]=w,C=i(k);let E=1;const P=N.length;let _="";const A=/^:::([\w-]*)(\s.*)?/gm,I=f.slice(P);for(A.lastIndex=0;;){const D=A.exec(I);if(D===null)break;const L=D.index,U=D[1];if(!((y=D[2])!=null&&y.endsWith(":::"))){if(U)E+=1;else if(E-=1,E===0){const H=I.slice(0,L);_=H.trim();const M=f.slice(0,P+L+D[0].length);let z=[];if(_)if(o==="block")for(z=g.blockTokens(H),z.forEach(O=>{O.text&&(!O.tokens||O.tokens.length===0)&&(O.tokens=g.inlineTokens(O.text))});z.length>0;){const O=z[z.length-1];if(O.type==="paragraph"&&(!O.text||O.text.trim()===""))z.pop();else break}else z=g.inlineTokens(_);return{type:e,raw:M,attributes:C,content:_,tokens:z}}}}}},renderMarkdown:(f,m)=>{const g=c(f.attrs||{}),y=a(g),b=y?` {${y}}`:"",w=m.renderChildren(f.content||[],`

`);return`:::${u}${b}

${w}

:::`}}}function Zq(t){if(!t.trim())return{};const e={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(t);for(;n!==null;){const[,i,a,s]=n;e[i]=a||s,n=r.exec(t)}return e}function eW(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e}="${r}"`).join(" ")}function NM(t){const{nodeName:e,name:r,getContent:n,parseAttributes:i=Zq,serializeAttributes:a=eW,defaultAttributes:s={},selfClosing:o=!1,allowedAttributes:l}=t,u=r||e,c=m=>{if(!l)return m;const g={};return l.forEach(y=>{const b=typeof y=="string"?y:y.name,w=typeof y=="string"?void 0:y.skipIfDefault;if(b in m){const N=m[b];if(w!==void 0&&N===w)return;g[b]=N}}),g},f=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(m,g)=>{const y={...s,...m.attributes};if(o)return g.createNode(e,y);const b=n?n(m):m.content||"";return b?g.createNode(e,y,[g.createTextNode(b)]):g.createNode(e,y,[])},markdownTokenizer:{name:e,level:"inline",start(m){const g=o?new RegExp(`\\[${f}\\s*[^\\]]*\\]`):new RegExp(`\\[${f}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${f}\\]`),y=m.match(g),b=y?.index;return b!==void 0?b:-1},tokenize(m,g,y){const b=o?new RegExp(`^\\[${f}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${f}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${f}\\]`),w=m.match(b);if(!w)return;let N="",k="";if(o){const[,E]=w;k=E}else{const[,E,P]=w;k=E,N=P||""}const C=i(k.trim());return{type:e,raw:w[0],content:N.trim(),attributes:C}}},renderMarkdown:m=>{let g="";n?g=n(m):m.content&&m.content.length>0&&(g=m.content.filter(N=>N.type==="text").map(N=>N.text).join(""));const y=c(m.attrs||{}),b=a(y),w=b?` ${b}`:"";return o?`[${u}${w}]`:`[${u}${w}]${g}[/${u}]`}}}function Z2(t,e,r){var n,i,a,s;const o=t.split(`
`),l=[];let u="",c=0;const f=e.baseIndentSize||2;for(;c<o.length;){const m=o[c],g=m.match(e.itemPattern);if(!g){if(l.length>0)break;if(m.trim()===""){c+=1,u=`${u}${m}
`;continue}else return}const y=e.extractItemData(g),{indentLevel:b,mainContent:w}=y;u=`${u}${m}
`;const N=[w];for(c+=1;c<o.length;){const P=o[c];if(P.trim()===""){const A=o.slice(c+1).findIndex(L=>L.trim()!=="");if(A===-1)break;if((((i=(n=o[c+1+A].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:i.length)||0)>b){N.push(P),u=`${u}${P}
`,c+=1;continue}else break}if((((s=(a=P.match(/^(\s*)/))==null?void 0:a[1])==null?void 0:s.length)||0)>b)N.push(P),u=`${u}${P}
`,c+=1;else break}let k;const C=N.slice(1);if(C.length>0){const P=C.map(_=>_.slice(b+f)).join(`
`);P.trim()&&(e.customNestedParser?k=e.customNestedParser(P):k=r.blockTokens(P))}const E=e.createToken(y,k);l.push(E)}if(l.length!==0)return{items:l,raw:u}}function Ek(t,e,r,n){if(!t||!Array.isArray(t.content))return"";const i=typeof r=="function"?r(n):r,[a,...s]=t.content,o=e.renderChildren([a]),l=[`${i}${o}`];return s&&s.length>0&&s.forEach(u=>{const c=e.renderChildren([u]);if(c){const f=c.split(`
`).map(m=>m?e.indent(m):"").join(`
`);l.push(f)}}),l.join(`
`)}function tW(t,e,r={}){const{state:n}=e,{doc:i,tr:a}=n,s=t;i.descendants((o,l)=>{const u=a.mapping.map(l),c=a.mapping.map(l)+o.nodeSize;let f=null;if(o.marks.forEach(g=>{if(g!==s)return!1;f=g}),!f)return;let m=!1;if(Object.keys(r).forEach(g=>{r[g]!==f.attrs[g]&&(m=!0)}),m){const g=t.type.create({...t.attrs,...r});a.removeMark(u,c,t.type),a.addMark(u,c,g)}}),a.docChanged&&e.view.dispatch(a)}var Ea=class EM extends kk{constructor(){super(...arguments),this.type="node"}static create(e={}){const r=typeof e=="function"?e():e;return new EM(r)}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}};function xd(t){return new Lq({find:t.find,handler:({state:e,range:r,match:n,pasteEvent:i})=>{const a=fr(t.getAttributes,void 0,n,i);if(a===!1||a===null)return null;const{tr:s}=e,o=n[n.length-1],l=n[0];let u=r.to;if(o){const c=l.search(/\S/),f=r.from+l.indexOf(o),m=f+o.length;if(Sk(r.from,r.to,e.doc).filter(y=>y.mark.type.excluded.find(w=>w===t.type&&w!==y.mark.type)).filter(y=>y.to>f).length)return null;m<r.to&&s.delete(m,r.to),f>r.from&&s.delete(r.from+c,f),u=r.from+c+o.length,s.addMark(r.from+c,u,t.type.create(a||{})),s.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:rW,getOwnPropertySymbols:nW}=Object,{hasOwnProperty:iW}=Object.prototype;function qw(t,e){return function(n,i,a){return t(n,i,a)&&e(n,i,a)}}function w0(t){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return t(r,n,i);const{cache:a}=i,s=a.get(r),o=a.get(n);if(s&&o)return s===n&&o===r;a.set(r,n),a.set(n,r);const l=t(r,n,i);return a.delete(r),a.delete(n),l}}function aW(t){return t?.[Symbol.toStringTag]}function nT(t){return rW(t).concat(nW(t))}const sW=Object.hasOwn||((t,e)=>iW.call(t,e));function Ed(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const oW="__v",lW="__o",uW="_owner",{getOwnPropertyDescriptor:iT,keys:aT}=Object;function cW(t,e){return t.byteLength===e.byteLength&&ky(new Uint8Array(t),new Uint8Array(e))}function dW(t,e,r){let n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!r.equals(t[n],e[n],n,n,t,e,r))return!1;return!0}function fW(t,e){return t.byteLength===e.byteLength&&ky(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function hW(t,e){return Ed(t.getTime(),e.getTime())}function pW(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function mW(t,e){return t===e}function sT(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const i=new Array(n),a=t.entries();let s,o,l=0;for(;(s=a.next())&&!s.done;){const u=e.entries();let c=!1,f=0;for(;(o=u.next())&&!o.done;){if(i[f]){f++;continue}const m=s.value,g=o.value;if(r.equals(m[0],g[0],l,f,t,e,r)&&r.equals(m[1],g[1],m[0],g[0],t,e,r)){c=i[f]=!0;break}f++}if(!c)return!1;l++}return!0}const gW=Ed;function vW(t,e,r){const n=aT(t);let i=n.length;if(aT(e).length!==i)return!1;for(;i-- >0;)if(!TM(t,e,r,n[i]))return!1;return!0}function km(t,e,r){const n=nT(t);let i=n.length;if(nT(e).length!==i)return!1;let a,s,o;for(;i-- >0;)if(a=n[i],!TM(t,e,r,a)||(s=iT(t,a),o=iT(e,a),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function yW(t,e){return Ed(t.valueOf(),e.valueOf())}function xW(t,e){return t.source===e.source&&t.flags===e.flags}function oT(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const i=new Array(n),a=t.values();let s,o;for(;(s=a.next())&&!s.done;){const l=e.values();let u=!1,c=0;for(;(o=l.next())&&!o.done;){if(!i[c]&&r.equals(s.value,o.value,s.value,o.value,t,e,r)){u=i[c]=!0;break}c++}if(!u)return!1}return!0}function ky(t,e){let r=t.byteLength;if(e.byteLength!==r||t.byteOffset!==e.byteOffset)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}function bW(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function TM(t,e,r,n){return(n===uW||n===lW||n===oW)&&(t.$$typeof||e.$$typeof)?!0:sW(e,n)&&r.equals(t[n],e[n],n,n,t,e,r)}const wW="[object ArrayBuffer]",SW="[object Arguments]",kW="[object Boolean]",CW="[object DataView]",NW="[object Date]",EW="[object Error]",TW="[object Map]",jW="[object Number]",PW="[object Object]",MW="[object RegExp]",_W="[object Set]",AW="[object String]",RW={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},DW="[object URL]",OW=Object.prototype.toString;function IW({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:i,areFunctionsEqual:a,areMapsEqual:s,areNumbersEqual:o,areObjectsEqual:l,arePrimitiveWrappersEqual:u,areRegExpsEqual:c,areSetsEqual:f,areTypedArraysEqual:m,areUrlsEqual:g,unknownTagComparators:y}){return function(w,N,k){if(w===N)return!0;if(w==null||N==null)return!1;const C=typeof w;if(C!==typeof N)return!1;if(C!=="object")return C==="number"?o(w,N,k):C==="function"?a(w,N,k):!1;const E=w.constructor;if(E!==N.constructor)return!1;if(E===Object)return l(w,N,k);if(Array.isArray(w))return e(w,N,k);if(E===Date)return n(w,N,k);if(E===RegExp)return c(w,N,k);if(E===Map)return s(w,N,k);if(E===Set)return f(w,N,k);const P=OW.call(w);if(P===NW)return n(w,N,k);if(P===MW)return c(w,N,k);if(P===TW)return s(w,N,k);if(P===_W)return f(w,N,k);if(P===PW)return typeof w.then!="function"&&typeof N.then!="function"&&l(w,N,k);if(P===DW)return g(w,N,k);if(P===EW)return i(w,N,k);if(P===SW)return l(w,N,k);if(RW[P])return m(w,N,k);if(P===wW)return t(w,N,k);if(P===CW)return r(w,N,k);if(P===kW||P===jW||P===AW)return u(w,N,k);if(y){let _=y[P];if(!_){const A=aW(w);A&&(_=y[A])}if(_)return _(w,N,k)}return!1}}function LW({circular:t,createCustomConfig:e,strict:r}){let n={areArrayBuffersEqual:cW,areArraysEqual:r?km:dW,areDataViewsEqual:fW,areDatesEqual:hW,areErrorsEqual:pW,areFunctionsEqual:mW,areMapsEqual:r?qw(sT,km):sT,areNumbersEqual:gW,areObjectsEqual:r?km:vW,arePrimitiveWrappersEqual:yW,areRegExpsEqual:xW,areSetsEqual:r?qw(oT,km):oT,areTypedArraysEqual:r?qw(ky,km):ky,areUrlsEqual:bW,unknownTagComparators:void 0};if(e&&(n=Object.assign({},n,e(n))),t){const i=w0(n.areArraysEqual),a=w0(n.areMapsEqual),s=w0(n.areObjectsEqual),o=w0(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:i,areMapsEqual:a,areObjectsEqual:s,areSetsEqual:o})}return n}function BW(t){return function(e,r,n,i,a,s,o){return t(e,r,o)}}function FW({circular:t,comparator:e,createState:r,equals:n,strict:i}){if(r)return function(o,l){const{cache:u=t?new WeakMap:void 0,meta:c}=r();return e(o,l,{cache:u,equals:n,meta:c,strict:i})};if(t)return function(o,l){return e(o,l,{cache:new WeakMap,equals:n,meta:void 0,strict:i})};const a={cache:void 0,equals:n,meta:void 0,strict:i};return function(o,l){return e(o,l,a)}}const zW=rc();rc({strict:!0});rc({circular:!0});rc({circular:!0,strict:!0});rc({createInternalComparator:()=>Ed});rc({strict:!0,createInternalComparator:()=>Ed});rc({circular:!0,createInternalComparator:()=>Ed});rc({circular:!0,createInternalComparator:()=>Ed,strict:!0});function rc(t={}){const{circular:e=!1,createInternalComparator:r,createState:n,strict:i=!1}=t,a=LW(t),s=IW(a),o=r?r(s):BW(s);return FW({circular:e,comparator:s,createState:n,equals:o,strict:i})}var Ww={exports:{}},$w={};var lT;function VW(){if(lT)return $w;lT=1;var t=vh(),e=vP();function r(u,c){return u===c&&(u!==0||1/u===1/c)||u!==u&&c!==c}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,a=t.useRef,s=t.useEffect,o=t.useMemo,l=t.useDebugValue;return $w.useSyncExternalStoreWithSelector=function(u,c,f,m,g){var y=a(null);if(y.current===null){var b={hasValue:!1,value:null};y.current=b}else b=y.current;y=o(function(){function N(_){if(!k){if(k=!0,C=_,_=m(_),g!==void 0&&b.hasValue){var A=b.value;if(g(A,_))return E=A}return E=_}if(A=E,n(C,_))return A;var I=m(_);return g!==void 0&&g(A,I)?(C=_,A):(C=_,E=I)}var k=!1,C,E,P=f===void 0?null:f;return[function(){return N(c())},P===null?void 0:function(){return N(P())}]},[c,f,m,g]);var w=i(u,y[0],y[1]);return s(function(){b.hasValue=!0,b.value=w},[w]),l(w),w},$w}var uT;function UW(){return uT||(uT=1,Ww.exports=VW()),Ww.exports}var GW=UW(),HW=(...t)=>e=>{t.forEach(r=>{typeof r=="function"?r(e):r&&(r.current=e)})},qW=({contentComponent:t})=>{const e=yP.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return h.jsx(h.Fragment,{children:Object.values(e)})};function WW(){const t=new Set;let e={};return{subscribe(r){return t.add(r),()=>{t.delete(r)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(r,n){e={...e,[r]:Q_.createPortal(n.reactElement,n.element,r)},t.forEach(i=>i())},removeRenderer(r){const n={...e};delete n[r],e=n,t.forEach(i=>i())}}}var $W=class extends Kt.Component{constructor(t){var e;super(t),this.editorContentRef=Kt.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const r=this.editorContentRef.current;r.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:r}),e.contentComponent=WW(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const r=document.createElement("div");r.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:r})}catch{}}}render(){const{editor:t,innerRef:e,...r}=this.props;return h.jsxs(h.Fragment,{children:[h.jsx("div",{ref:HW(e,this.editorContentRef),...r}),t?.contentComponent&&h.jsx(qW,{contentComponent:t.contentComponent})]})}},KW=se.forwardRef((t,e)=>{const r=Kt.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return Kt.createElement($W,{key:r,innerRef:e,...t})}),YW=Kt.memo(KW),XW=typeof window<"u"?se.useLayoutEffect:se.useEffect,QW=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(n=>n())},r=this.editor;return r.on("transaction",e),()=>{r.off("transaction",e)}}}};function JW(t){var e;const[r]=se.useState(()=>new QW(t.editor)),n=GW.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:zW);return XW(()=>r.watch(t.editor),[t.editor,r]),se.useDebugValue(n),n}var ZW=!1,eS=typeof window>"u",e$=eS||!!(typeof window<"u"&&window.next),t$=class jM{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(r=>r())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?eS||e$?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...n)=>{var i,a;return(a=(i=this.options.current).onBeforeCreate)==null?void 0:a.call(i,...n)},onBlur:(...n)=>{var i,a;return(a=(i=this.options.current).onBlur)==null?void 0:a.call(i,...n)},onCreate:(...n)=>{var i,a;return(a=(i=this.options.current).onCreate)==null?void 0:a.call(i,...n)},onDestroy:(...n)=>{var i,a;return(a=(i=this.options.current).onDestroy)==null?void 0:a.call(i,...n)},onFocus:(...n)=>{var i,a;return(a=(i=this.options.current).onFocus)==null?void 0:a.call(i,...n)},onSelectionUpdate:(...n)=>{var i,a;return(a=(i=this.options.current).onSelectionUpdate)==null?void 0:a.call(i,...n)},onTransaction:(...n)=>{var i,a;return(a=(i=this.options.current).onTransaction)==null?void 0:a.call(i,...n)},onUpdate:(...n)=>{var i,a;return(a=(i=this.options.current).onUpdate)==null?void 0:a.call(i,...n)},onContentError:(...n)=>{var i,a;return(a=(i=this.options.current).onContentError)==null?void 0:a.call(i,...n)},onDrop:(...n)=>{var i,a;return(a=(i=this.options.current).onDrop)==null?void 0:a.call(i,...n)},onPaste:(...n)=>{var i,a;return(a=(i=this.options.current).onPaste)==null?void 0:a.call(i,...n)},onDelete:(...n)=>{var i,a;return(a=(i=this.options.current).onDelete)==null?void 0:a.call(i,...n)}};return new Wq(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,r){return Object.keys(e).every(n=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)?!0:n==="extensions"&&e.extensions&&r.extensions?e.extensions.length!==r.extensions.length?!1:e.extensions.every((i,a)=>{var s;return i===((s=r.extensions)==null?void 0:s[a])}):e[n]===r[n])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?jM.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((n,i)=>n===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,r=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){r&&r.setOptions(this.options.current);return}r&&!r.isDestroyed&&(r.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function r$(t={},e=[]){const r=se.useRef(t);r.current=t;const[n]=se.useState(()=>new t$(r)),i=yP.useSyncExternalStore(n.subscribe,n.getEditor,n.getServerSnapshot);return se.useDebugValue(i),se.useEffect(n.onRender(e)),JW({editor:i,selector:({transactionNumber:a})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&a===0?0:a+1}),i}var n$=se.createContext({editor:null});n$.Consumer;var i$=se.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),a$=()=>se.useContext(i$);Kt.forwardRef((t,e)=>{const{onDragStart:r}=a$(),n=t.as||"div";return h.jsx(n,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...t.style}})});function cT(t){return!!(typeof t=="function"&&t.prototype&&t.prototype.isReactComponent)}function dT(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.forward_ref)"||t.$$typeof.description==="react.forward_ref"))}function s$(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.memo)"||t.$$typeof.description==="react.memo"))}function o$(t){if(cT(t)||dT(t))return!0;if(s$(t)){const e=t.type;if(e)return cT(e)||dT(e)}return!1}function l$(){try{if(se.version)return parseInt(se.version.split(".")[0],10)>=19}catch{}return!1}var u$=class{constructor(t,{editor:e,props:r={},as:n="div",className:i=""}){this.ref=null,this.destroyed=!1,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=t,this.editor=e,this.props=r,this.element=document.createElement(n),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?hl.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.destroyed||this.render()})}render(){var t;if(this.destroyed)return;const e=this.component,r=this.props,n=this.editor,i=l$(),a=o$(e),s={...r};s.ref&&!(i||a)&&delete s.ref,!s.ref&&(i||a)&&(s.ref=o=>{this.ref=o}),this.reactElement=h.jsx(e,{...s}),(t=n?.contentComponent)==null||t.setRenderer(this.id,this)}updateProps(t={}){this.destroyed||(this.props={...this.props,...t},this.render())}destroy(){var t;this.destroyed=!0;const e=this.editor;(t=e?.contentComponent)==null||t.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(t){Object.keys(t).forEach(e=>{this.element.setAttribute(e,t[e])})}};Kt.createContext({markViewContentRef:()=>{}});var Cy=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:r,...n}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,n,r]},c$=/^\s*>\s$/,d$=Ea.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return Cy("blockquote",{...qr(this.options.HTMLAttributes,t),children:Cy("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const r=">",n=[];return t.content.forEach(i=>{const o=e.renderChildren([i]).split(`
`).map(l=>l.trim()===""?r:`${r} ${l}`);n.push(o.join(`
`))}),n.join(`
${r}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[dh({find:c$,type:this.type})]}}),f$=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,h$=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,p$=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,m$=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,g$=Nd.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return Cy("strong",{...qr(this.options.HTMLAttributes,t),children:Cy("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ch({find:f$,type:this.type}),ch({find:p$,type:this.type})]},addPasteRules(){return[xd({find:h$,type:this.type}),xd({find:m$,type:this.type})]}}),v$=/(^|[^`])`([^`]+)`(?!`)$/,y$=/(^|[^`])`([^`]+)`(?!`)/g,x$=Nd.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",qr(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ch({find:v$,type:this.type})]},addPasteRules(){return[xd({find:y$,type:this.type})]}}),Kw=4,b$=/^```([a-z]+)?[\s\n]$/,w$=/^~~~([a-z]+)?[\s\n]$/,S$=Ea.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Kw,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:r}=this.options;if(!r)return null;const a=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(s=>s.startsWith(r)).map(s=>s.replace(r,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",qr(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var r;return((r=t.raw)==null?void 0:r.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var r;let n="";const i=((r=t.attrs)==null?void 0:r.language)||"";return t.content?n=[`\`\`\`${i}`,e.renderChildren(t.content),"```"].join(`
`):n=`\`\`\`${i}

\`\`\``,n},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,r=e.pos===1;return!t||e.parent.type.name!==this.name?!1:r||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const r=(e=this.options.tabSize)!=null?e:Kw,{state:n}=t,{selection:i}=n,{$from:a,empty:s}=i;if(a.parent.type!==this.type)return!1;const o=" ".repeat(r);return s?t.commands.insertContent(o):t.commands.command(({tr:l})=>{const{from:u,to:c}=i,g=n.doc.textBetween(u,c,`
`,`
`).split(`
`).map(y=>o+y).join(`
`);return l.replaceWith(u,c,n.schema.text(g)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const r=(e=this.options.tabSize)!=null?e:Kw,{state:n}=t,{selection:i}=n,{$from:a,empty:s}=i;return a.parent.type!==this.type?!1:s?t.commands.command(({tr:o})=>{var l;const{pos:u}=a,c=a.start(),f=a.end(),g=n.doc.textBetween(c,f,`
`,`
`).split(`
`);let y=0,b=0;const w=u-c;for(let _=0;_<g.length;_+=1){if(b+g[_].length>=w){y=_;break}b+=g[_].length+1}const k=((l=g[y].match(/^ */))==null?void 0:l[0])||"",C=Math.min(k.length,r);if(C===0)return!0;let E=c;for(let _=0;_<y;_+=1)E+=g[_].length+1;return o.delete(E,E+C),u-E<=C&&o.setSelection(Dt.create(o.doc,E)),!0}):t.commands.command(({tr:o})=>{const{from:l,to:u}=i,m=n.doc.textBetween(l,u,`
`,`
`).split(`
`).map(g=>{var y;const b=((y=g.match(/^ */))==null?void 0:y[0])||"",w=Math.min(b.length,r);return g.slice(w)}).join(`
`);return o.replaceWith(l,u,n.schema.text(m)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:r}=e,{$from:n,empty:i}=r;if(!i||n.parent.type!==this.type)return!1;const a=n.parentOffset===n.parent.nodeSize-2,s=n.parent.textContent.endsWith(`

`);return!a||!s?!1:t.chain().command(({tr:o})=>(o.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:r,doc:n}=e,{$from:i,empty:a}=r;if(!a||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const o=i.after();return o===void 0?!1:n.nodeAt(o)?t.commands.command(({tr:u})=>(u.setSelection(Ft.near(n.resolve(o))),!0)):t.commands.exitCode()}}},addInputRules(){return[J2({find:b$,type:this.type,getAttributes:t=>({language:t[1]})}),J2({find:w$,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Wr({key:new wn("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const r=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("vscode-editor-data"),i=n?JSON.parse(n):void 0,a=i?.mode;if(!r||!a)return!1;const{tr:s,schema:o}=t.state,l=o.text(r.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:a},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(Dt.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),k$=Ea.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),C$=Ea.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",qr(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:r,editor:n})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:a}=r;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=n.extensionManager,l=a||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&l&&s){const f=l.filter(m=>o.includes(m.type.name));u.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),N$=Ea.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,qr(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var r;const n=(r=t.attrs)!=null&&r.level?parseInt(t.attrs.level,10):1,i="#".repeat(n);return t.content?`${i} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>J2({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),E$=Ea.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",qr(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!Kq(e,e.schema.nodes[this.name]))return!1;const{selection:r}=e,{$to:n}=r,i=t();return lM(r)?i.insertContentAt(n.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:a,tr:s,dispatch:o})=>{if(o){const{$to:l}=s.selection,u=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection(Dt.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(wt.create(s.doc,l.pos)):s.setSelection(Dt.create(s.doc,l.pos));else{const c=a.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,f=c?.create();f&&(s.insert(u,f),s.setSelection(Dt.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[$q({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),T$=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,j$=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,P$=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,M$=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,_$=Nd.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",qr(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ch({find:T$,type:this.type}),ch({find:P$,type:this.type})]},addPasteRules(){return[xd({find:j$,type:this.type}),xd({find:M$,type:this.type})]}});const A$="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",R$="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",tS="numeric",rS="ascii",nS="alpha",Um="asciinumeric",Dm="alphanumeric",iS="domain",PM="emoji",D$="scheme",O$="slashscheme",Yw="whitespace";function I$(t,e){return t in e||(e[t]=[]),e[t]}function Zc(t,e,r){e[tS]&&(e[Um]=!0,e[Dm]=!0),e[rS]&&(e[Um]=!0,e[nS]=!0),e[Um]&&(e[Dm]=!0),e[nS]&&(e[Dm]=!0),e[Dm]&&(e[iS]=!0),e[PM]&&(e[iS]=!0);for(const n in e){const i=I$(n,r);i.indexOf(t)<0&&i.push(t)}}function L$(t,e){const r={};for(const n in e)e[n].indexOf(t)>=0&&(r[n]=!0);return r}function ba(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}ba.groups={};ba.prototype={accepts(){return!!this.t},go(t){const e=this,r=e.j[t];if(r)return r;for(let n=0;n<e.jr.length;n++){const i=e.jr[n][0],a=e.jr[n][1];if(a&&i.test(t))return a}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,r,n){for(let i=0;i<t.length;i++)this.tt(t[i],e,r,n)},tr(t,e,r,n){n=n||ba.groups;let i;return e&&e.j?i=e:(i=new ba(e),r&&n&&Zc(e,r,n)),this.jr.push([t,i]),i},ts(t,e,r,n){let i=this;const a=t.length;if(!a)return i;for(let s=0;s<a-1;s++)i=i.tt(t[s]);return i.tt(t[a-1],e,r,n)},tt(t,e,r,n){n=n||ba.groups;const i=this;if(e&&e.j)return i.j[t]=e,e;const a=e;let s,o=i.go(t);if(o?(s=new ba,Object.assign(s.j,o.j),s.jr.push.apply(s.jr,o.jr),s.jd=o.jd,s.t=o.t):s=new ba,a){if(n)if(s.t&&typeof s.t=="string"){const l=Object.assign(L$(s.t,n),r);Zc(a,l,n)}else r&&Zc(a,r,n);s.t=a}return i.j[t]=s,s}};const Bt=(t,e,r,n,i)=>t.ta(e,r,n,i),an=(t,e,r,n,i)=>t.tr(e,r,n,i),fT=(t,e,r,n,i)=>t.ts(e,r,n,i),qe=(t,e,r,n,i)=>t.tt(e,r,n,i),sl="WORD",aS="UWORD",MM="ASCIINUMERICAL",_M="ALPHANUMERICAL",xg="LOCALHOST",sS="TLD",oS="UTLD",G0="SCHEME",Uf="SLASH_SCHEME",Tk="NUM",lS="WS",jk="NL",Gm="OPENBRACE",Hm="CLOSEBRACE",Ny="OPENBRACKET",Ey="CLOSEBRACKET",Ty="OPENPAREN",jy="CLOSEPAREN",Py="OPENANGLEBRACKET",My="CLOSEANGLEBRACKET",_y="FULLWIDTHLEFTPAREN",Ay="FULLWIDTHRIGHTPAREN",Ry="LEFTCORNERBRACKET",Dy="RIGHTCORNERBRACKET",Oy="LEFTWHITECORNERBRACKET",Iy="RIGHTWHITECORNERBRACKET",Ly="FULLWIDTHLESSTHAN",By="FULLWIDTHGREATERTHAN",Fy="AMPERSAND",zy="APOSTROPHE",Vy="ASTERISK",bu="AT",Uy="BACKSLASH",Gy="BACKTICK",Hy="CARET",ku="COLON",Pk="COMMA",qy="DOLLAR",mo="DOT",Wy="EQUALS",Mk="EXCLAMATION",is="HYPHEN",qm="PERCENT",$y="PIPE",Ky="PLUS",Yy="POUND",Wm="QUERY",_k="QUOTE",AM="FULLWIDTHMIDDLEDOT",Ak="SEMI",go="SLASH",$m="TILDE",Xy="UNDERSCORE",RM="EMOJI",Qy="SYM";var DM=Object.freeze({__proto__:null,ALPHANUMERICAL:_M,AMPERSAND:Fy,APOSTROPHE:zy,ASCIINUMERICAL:MM,ASTERISK:Vy,AT:bu,BACKSLASH:Uy,BACKTICK:Gy,CARET:Hy,CLOSEANGLEBRACKET:My,CLOSEBRACE:Hm,CLOSEBRACKET:Ey,CLOSEPAREN:jy,COLON:ku,COMMA:Pk,DOLLAR:qy,DOT:mo,EMOJI:RM,EQUALS:Wy,EXCLAMATION:Mk,FULLWIDTHGREATERTHAN:By,FULLWIDTHLEFTPAREN:_y,FULLWIDTHLESSTHAN:Ly,FULLWIDTHMIDDLEDOT:AM,FULLWIDTHRIGHTPAREN:Ay,HYPHEN:is,LEFTCORNERBRACKET:Ry,LEFTWHITECORNERBRACKET:Oy,LOCALHOST:xg,NL:jk,NUM:Tk,OPENANGLEBRACKET:Py,OPENBRACE:Gm,OPENBRACKET:Ny,OPENPAREN:Ty,PERCENT:qm,PIPE:$y,PLUS:Ky,POUND:Yy,QUERY:Wm,QUOTE:_k,RIGHTCORNERBRACKET:Dy,RIGHTWHITECORNERBRACKET:Iy,SCHEME:G0,SEMI:Ak,SLASH:go,SLASH_SCHEME:Uf,SYM:Qy,TILDE:$m,TLD:sS,UNDERSCORE:Xy,UTLD:oS,UWORD:aS,WORD:sl,WS:lS});const il=/[a-z]/,Cm=new RegExp("\\p{L}","u"),Xw=new RegExp("\\p{Emoji}","u"),al=/\d/,Qw=/\s/,hT="\r",Jw=`
`,B$="",F$="",Zw="";let S0=null,k0=null;function z$(t=[]){const e={};ba.groups=e;const r=new ba;S0==null&&(S0=pT(A$)),k0==null&&(k0=pT(R$)),qe(r,"'",zy),qe(r,"{",Gm),qe(r,"}",Hm),qe(r,"[",Ny),qe(r,"]",Ey),qe(r,"(",Ty),qe(r,")",jy),qe(r,"<",Py),qe(r,">",My),qe(r,"",_y),qe(r,"",Ay),qe(r,"",Ry),qe(r,"",Dy),qe(r,"",Oy),qe(r,"",Iy),qe(r,"",Ly),qe(r,"",By),qe(r,"&",Fy),qe(r,"*",Vy),qe(r,"@",bu),qe(r,"`",Gy),qe(r,"^",Hy),qe(r,":",ku),qe(r,",",Pk),qe(r,"$",qy),qe(r,".",mo),qe(r,"=",Wy),qe(r,"!",Mk),qe(r,"-",is),qe(r,"%",qm),qe(r,"|",$y),qe(r,"+",Ky),qe(r,"#",Yy),qe(r,"?",Wm),qe(r,'"',_k),qe(r,"/",go),qe(r,";",Ak),qe(r,"~",$m),qe(r,"_",Xy),qe(r,"\\",Uy),qe(r,"",AM);const n=an(r,al,Tk,{[tS]:!0});an(n,al,n);const i=an(n,il,MM,{[Um]:!0}),a=an(n,Cm,_M,{[Dm]:!0}),s=an(r,il,sl,{[rS]:!0});an(s,al,i),an(s,il,s),an(i,al,i),an(i,il,i);const o=an(r,Cm,aS,{[nS]:!0});an(o,il),an(o,al,a),an(o,Cm,o),an(a,al,a),an(a,il),an(a,Cm,a);const l=qe(r,Jw,jk,{[Yw]:!0}),u=qe(r,hT,lS,{[Yw]:!0}),c=an(r,Qw,lS,{[Yw]:!0});qe(r,Zw,c),qe(u,Jw,l),qe(u,Zw,c),an(u,Qw,c),qe(c,hT),qe(c,Jw),an(c,Qw,c),qe(c,Zw,c);const f=an(r,Xw,RM,{[PM]:!0});qe(f,"#"),an(f,Xw,f),qe(f,B$,f);const m=qe(f,F$);qe(m,"#"),an(m,Xw,f);const g=[[il,s],[al,i]],y=[[il,null],[Cm,o],[al,a]];for(let b=0;b<S0.length;b++)gu(r,S0[b],sS,sl,g);for(let b=0;b<k0.length;b++)gu(r,k0[b],oS,aS,y);Zc(sS,{tld:!0,ascii:!0},e),Zc(oS,{utld:!0,alpha:!0},e),gu(r,"file",G0,sl,g),gu(r,"mailto",G0,sl,g),gu(r,"http",Uf,sl,g),gu(r,"https",Uf,sl,g),gu(r,"ftp",Uf,sl,g),gu(r,"ftps",Uf,sl,g),Zc(G0,{scheme:!0,ascii:!0},e),Zc(Uf,{slashscheme:!0,ascii:!0},e),t=t.sort((b,w)=>b[0]>w[0]?1:-1);for(let b=0;b<t.length;b++){const w=t[b][0],k=t[b][1]?{[D$]:!0}:{[O$]:!0};w.indexOf("-")>=0?k[iS]=!0:il.test(w)?al.test(w)?k[Um]=!0:k[rS]=!0:k[tS]=!0,fT(r,w,w,k)}return fT(r,"localhost",xg,{ascii:!0}),r.jd=new ba(Qy),{start:r,tokens:Object.assign({groups:e},DM)}}function OM(t,e){const r=V$(e.replace(/[A-Z]/g,o=>o.toLowerCase())),n=r.length,i=[];let a=0,s=0;for(;s<n;){let o=t,l=null,u=0,c=null,f=-1,m=-1;for(;s<n&&(l=o.go(r[s]));)o=l,o.accepts()?(f=0,m=0,c=o):f>=0&&(f+=r[s].length,m++),u+=r[s].length,a+=r[s].length,s++;a-=f,s-=m,u-=f,i.push({t:c.t,v:e.slice(a-u,a),s:a-u,e:a})}return i}function V$(t){const e=[],r=t.length;let n=0;for(;n<r;){let i=t.charCodeAt(n),a,s=i<55296||i>56319||n+1===r||(a=t.charCodeAt(n+1))<56320||a>57343?t[n]:t.slice(n,n+2);e.push(s),n+=s.length}return e}function gu(t,e,r,n,i){let a;const s=e.length;for(let o=0;o<s-1;o++){const l=e[o];t.j[l]?a=t.j[l]:(a=new ba(n),a.jr=i.slice(),t.j[l]=a),t=a}return a=new ba(r),a.jr=i.slice(),t.j[e[s-1]]=a,a}function pT(t){const e=[],r=[];let n=0,i="0123456789";for(;n<t.length;){let a=0;for(;i.indexOf(t[n+a])>=0;)a++;if(a>0){e.push(r.join(""));for(let s=parseInt(t.substring(n,n+a),10);s>0;s--)r.pop();n+=a}else r.push(t[n]),n++}return e}const bg={defaultProtocol:"http",events:null,format:mT,formatHref:mT,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Rk(t,e=null){let r=Object.assign({},bg);t&&(r=Object.assign(r,t instanceof Rk?t.o:t));const n=r.ignoreTags,i=[];for(let a=0;a<n.length;a++)i.push(n[a].toUpperCase());this.o=r,e&&(this.defaultRender=e),this.ignoreTags=i}Rk.prototype={o:bg,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,r){const n=e!=null;let i=this.o[t];return i&&(typeof i=="object"?(i=r.t in i?i[r.t]:bg[t],typeof i=="function"&&n&&(i=i(e,r))):typeof i=="function"&&n&&(i=i(e,r.t,r)),i)},getObj(t,e,r){let n=this.o[t];return typeof n=="function"&&e!=null&&(n=n(e,r.t,r)),n},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function mT(t){return t}function IM(t,e){this.t="token",this.v=t,this.tk=e}IM.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),r=t.get("truncate",e,this),n=t.get("format",e,this);return r&&n.length>r?n.substring(0,r)+"":n},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=bg.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,r=this.toHref(t.get("defaultProtocol")),n=t.get("formatHref",r,this),i=t.get("tagName",r,e),a=this.toFormattedString(t),s={},o=t.get("className",r,e),l=t.get("target",r,e),u=t.get("rel",r,e),c=t.getObj("attributes",r,e),f=t.getObj("events",r,e);return s.href=n,o&&(s.class=o),l&&(s.target=l),u&&(s.rel=u),c&&Object.assign(s,c),{tagName:i,attributes:s,content:a,eventListeners:f}}};function Fx(t,e){class r extends IM{constructor(i,a){super(i,a),this.t=t}}for(const n in e)r.prototype[n]=e[n];return r.t=t,r}const gT=Fx("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),vT=Fx("text"),U$=Fx("nl"),C0=Fx("url",{isLink:!0,toHref(t=bg.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==xg&&t[1].t===ku}}),rs=t=>new ba(t);function G$({groups:t}){const e=t.domain.concat([Fy,Vy,bu,Uy,Gy,Hy,qy,Wy,is,Tk,qm,$y,Ky,Yy,go,Qy,$m,Xy]),r=[zy,ku,Pk,mo,Mk,qm,Wm,_k,Ak,Py,My,Gm,Hm,Ey,Ny,Ty,jy,_y,Ay,Ry,Dy,Oy,Iy,Ly,By],n=[Fy,zy,Vy,Uy,Gy,Hy,qy,Wy,is,Gm,Hm,qm,$y,Ky,Yy,Wm,go,Qy,$m,Xy],i=rs(),a=qe(i,$m);Bt(a,n,a),Bt(a,t.domain,a);const s=rs(),o=rs(),l=rs();Bt(i,t.domain,s),Bt(i,t.scheme,o),Bt(i,t.slashscheme,l),Bt(s,n,a),Bt(s,t.domain,s);const u=qe(s,bu);qe(a,bu,u),qe(o,bu,u),qe(l,bu,u);const c=qe(a,mo);Bt(c,n,a),Bt(c,t.domain,a);const f=rs();Bt(u,t.domain,f),Bt(f,t.domain,f);const m=qe(f,mo);Bt(m,t.domain,f);const g=rs(gT);Bt(m,t.tld,g),Bt(m,t.utld,g),qe(u,xg,g);const y=qe(f,is);qe(y,is,y),Bt(y,t.domain,f),Bt(g,t.domain,f),qe(g,mo,m),qe(g,is,y);const b=qe(g,ku);Bt(b,t.numeric,gT);const w=qe(s,is),N=qe(s,mo);qe(w,is,w),Bt(w,t.domain,s),Bt(N,n,a),Bt(N,t.domain,s);const k=rs(C0);Bt(N,t.tld,k),Bt(N,t.utld,k),Bt(k,t.domain,s),Bt(k,n,a),qe(k,mo,N),qe(k,is,w),qe(k,bu,u);const C=qe(k,ku),E=rs(C0);Bt(C,t.numeric,E);const P=rs(C0),_=rs();Bt(P,e,P),Bt(P,r,_),Bt(_,e,P),Bt(_,r,_),qe(k,go,P),qe(E,go,P);const A=qe(o,ku),I=qe(l,ku),D=qe(I,go),L=qe(D,go);Bt(o,t.domain,s),qe(o,mo,N),qe(o,is,w),Bt(l,t.domain,s),qe(l,mo,N),qe(l,is,w),Bt(A,t.domain,P),qe(A,go,P),qe(A,Wm,P),Bt(L,t.domain,P),Bt(L,e,P),qe(L,go,P);const U=[[Gm,Hm],[Ny,Ey],[Ty,jy],[Py,My],[_y,Ay],[Ry,Dy],[Oy,Iy],[Ly,By]];for(let H=0;H<U.length;H++){const[M,z]=U[H],O=qe(P,M);qe(_,M,O),qe(O,z,P);const G=rs(C0);Bt(O,e,G);const W=rs();Bt(O,r),Bt(G,e,G),Bt(G,r,W),Bt(W,e,G),Bt(W,r,W),qe(G,z,P),qe(W,z,P)}return qe(i,xg,k),qe(i,jk,U$),{start:i,tokens:DM}}function H$(t,e,r){let n=r.length,i=0,a=[],s=[];for(;i<n;){let o=t,l=null,u=null,c=0,f=null,m=-1;for(;i<n&&!(l=o.go(r[i].t));)s.push(r[i++]);for(;i<n&&(u=l||o.go(r[i].t));)l=null,o=u,o.accepts()?(m=0,f=o):m>=0&&m++,i++,c++;if(m<0)i-=c,i<n&&(s.push(r[i]),i++);else{s.length>0&&(a.push(e2(vT,e,s)),s=[]),i-=m,c-=m;const g=f.t,y=r.slice(i-c,i);a.push(e2(g,e,y))}}return s.length>0&&a.push(e2(vT,e,s)),a}function e2(t,e,r){const n=r[0].s,i=r[r.length-1].e,a=e.slice(n,i);return new t(a,r)}const q$=typeof console<"u"&&console&&console.warn||(()=>{}),W$="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",Lr={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function $$(){return ba.groups={},Lr.scanner=null,Lr.parser=null,Lr.tokenQueue=[],Lr.pluginQueue=[],Lr.customSchemes=[],Lr.initialized=!1,Lr}function yT(t,e=!1){if(Lr.initialized&&q$(`linkifyjs: already initialized - will not register custom scheme "${t}" ${W$}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);Lr.customSchemes.push([t,e])}function K$(){Lr.scanner=z$(Lr.customSchemes);for(let t=0;t<Lr.tokenQueue.length;t++)Lr.tokenQueue[t][1]({scanner:Lr.scanner});Lr.parser=G$(Lr.scanner.tokens);for(let t=0;t<Lr.pluginQueue.length;t++)Lr.pluginQueue[t][1]({scanner:Lr.scanner,parser:Lr.parser});return Lr.initialized=!0,Lr}function Dk(t){return Lr.initialized||K$(),H$(Lr.parser.start,t,OM(Lr.scanner.start,t))}Dk.scan=OM;function LM(t,e=null,r=null){if(e&&typeof e=="object"){if(r)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);r=e,e=null}const n=new Rk(r),i=Dk(t),a=[];for(let s=0;s<i.length;s++){const o=i[s];o.isLink&&(!e||o.t===e)&&n.check(o)&&a.push(o.toFormattedObject(n))}return a}var Ok="[\0- -\u2029]",Y$=new RegExp(Ok),X$=new RegExp(`${Ok}$`),Q$=new RegExp(Ok,"g");function J$(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function Z$(t){return new Wr({key:new wn("autolink"),appendTransaction:(e,r,n)=>{const i=e.some(u=>u.docChanged)&&!r.doc.eq(n.doc),a=e.some(u=>u.getMeta("preventAutolink"));if(!i||a)return;const{tr:s}=n,o=eM(r.doc,[...e]);if(oM(o).forEach(({newRange:u})=>{const c=KH(n.doc,u,g=>g.isTextblock);let f,m;if(c.length>1)f=c[0],m=n.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ");else if(c.length){const g=n.doc.textBetween(u.from,u.to," "," ");if(!X$.test(g))return;f=c[0],m=n.doc.textBetween(f.pos,u.to,void 0," ")}if(f&&m){const g=m.split(Y$).filter(Boolean);if(g.length<=0)return!1;const y=g[g.length-1],b=f.pos+m.lastIndexOf(y);if(!y)return!1;const w=Dk(y).map(N=>N.toObject(t.defaultProtocol));if(!J$(w))return!1;w.filter(N=>N.isLink).map(N=>({...N,from:b+N.start+1,to:b+N.end+1})).filter(N=>n.schema.marks.code?!n.doc.rangeHasMark(N.from,N.to,n.schema.marks.code):!0).filter(N=>t.validate(N.value)).filter(N=>t.shouldAutoLink(N.value)).forEach(N=>{Sk(N.from,N.to,n.doc).some(k=>k.mark.type===t.type)||s.addMark(N.from,N.to,t.type.create({href:N.href}))})}}),!!s.steps.length)return s}})}function eK(t){return new Wr({key:new wn("handleClickLink"),props:{handleClick:(e,r,n)=>{var i,a;if(n.button!==0||!e.editable)return!1;let s=null;if(n.target instanceof HTMLAnchorElement)s=n.target;else{const l=n.target;if(!l)return!1;const u=t.editor.view.dom;s=l.closest("a"),s&&!u.contains(s)&&(s=null)}if(!s)return!1;let o=!1;if(t.enableClickSelection&&(o=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){const l=sM(e.state,t.type.name),u=(i=s.href)!=null?i:l.href,c=(a=s.target)!=null?a:l.target;u&&(window.open(u,c),o=!0)}return o}}})}function tK(t){return new Wr({key:new wn("handlePasteLink"),props:{handlePaste:(e,r,n)=>{const{shouldAutoLink:i}=t,{state:a}=e,{selection:s}=a,{empty:o}=s;if(o)return!1;let l="";n.content.forEach(c=>{l+=c.textContent});const u=LM(l,{defaultProtocol:t.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!u||i!==void 0&&!i(u.value)?!1:t.editor.commands.setMark(t.type,{href:u.href})}}})}function Uc(t,e){const r=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(n=>{const i=typeof n=="string"?n:n.scheme;i&&r.push(i)}),!t||t.replace(Q$,"").match(new RegExp(`^(?:(?:${r.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var rK=Nd.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){yT(t);return}yT(t.scheme,t.optionalSlashes)})},onDestroy(){$$()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!Uc(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),r=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||r&&!t.includes("@"))return!0;const i=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:r=>!!Uc(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!Uc(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",qr(this.options.HTMLAttributes,t),0]:["a",qr(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var r;const n=((r=t.attrs)==null?void 0:r.href)||"";return`[${e.renderChildren(t)}](${n})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:r}=t;return this.options.isAllowedUri(r,{defaultValidate:n=>!!Uc(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:r}=t||{};return r&&!this.options.isAllowedUri(r,{defaultValidate:n=>!!Uc(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[xd({find:t=>{const e=[];if(t){const{protocols:r,defaultProtocol:n}=this.options,i=LM(t).filter(a=>a.isLink&&this.options.isAllowedUri(a.value,{defaultValidate:s=>!!Uc(s,r),protocols:r,defaultProtocol:n}));i.length&&i.forEach(a=>{this.options.shouldAutoLink(a.value)&&e.push({text:a.value,data:{href:a.href},index:a.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:r}=this.options;return this.options.autolink&&t.push(Z$({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:i=>!!Uc(i,e),protocols:e,defaultProtocol:r}),shouldAutoLink:this.options.shouldAutoLink})),t.push(eK({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(tK({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),nK=Object.defineProperty,iK=(t,e)=>{for(var r in e)nK(t,r,{get:e[r],enumerable:!0})},aK="listItem",xT="textStyle",bT=/^\s*([-+*])\s$/,BM=Ea.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",qr(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(aK,this.editor.getAttributes(xT)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=dh({find:bT,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=dh({find:bT,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(xT),editor:this.editor})),[t]}}),FM=Ea.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",qr(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let r=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(i=>i.type==="paragraph"))r=e.parseChildren(t.tokens);else{const i=t.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(r=[{type:"paragraph",content:e.parseInline(i.tokens)}],t.tokens.length>1){const s=t.tokens.slice(1),o=e.parseChildren(s);r.push(...o)}}else r=e.parseChildren(t.tokens)}return r.length===0&&(r=[{type:"paragraph",content:[]}]),{type:"listItem",content:r}},renderMarkdown:(t,e,r)=>Ek(t,e,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",r),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),sK={};iK(sK,{findListItemPos:()=>zg,getNextListDepth:()=>Ik,handleBackspace:()=>uS,handleDelete:()=>cS,hasListBefore:()=>zM,hasListItemAfter:()=>oK,hasListItemBefore:()=>VM,listItemHasSubList:()=>UM,nextListIsDeeper:()=>GM,nextListIsHigher:()=>HM});var zg=(t,e)=>{const{$from:r}=e.selection,n=_n(t,e.schema);let i=null,a=r.depth,s=r.pos,o=null;for(;a>0&&o===null;)i=r.node(a),i.type===n?o=a:(a-=1,s-=1);return o===null?null:{$pos:e.doc.resolve(s),depth:o}},Ik=(t,e)=>{const r=zg(t,e);if(!r)return!1;const[,n]=iq(e,t,r.$pos.pos+4);return n},zM=(t,e,r)=>{const{$anchor:n}=t.selection,i=Math.max(0,n.pos-2),a=t.doc.resolve(i).node();return!(!a||!r.includes(a.type.name))},VM=(t,e)=>{var r;const{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-2);return!(i.index()===0||((r=i.nodeBefore)==null?void 0:r.type.name)!==t)},UM=(t,e,r)=>{if(!r)return!1;const n=_n(t,e.schema);let i=!1;return r.descendants(a=>{a.type===n&&(i=!0)}),i},uS=(t,e,r)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!qu(t.state,e)&&zM(t.state,e,r)){const{$anchor:o}=t.state.selection,l=t.state.doc.resolve(o.before()-1),u=[];l.node().descendants((m,g)=>{m.type.name===e&&u.push({node:m,pos:g})});const c=u.at(-1);if(!c)return!1;const f=t.state.doc.resolve(l.start()+c.pos+1);return t.chain().cut({from:o.start()-1,to:o.end()+1},f.end()).joinForward().run()}if(!qu(t.state,e)||!lq(t.state))return!1;const n=zg(e,t.state);if(!n)return!1;const a=t.state.doc.resolve(n.$pos.pos-2).node(n.depth),s=UM(e,t.state,a);return VM(e,t.state)&&!s?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},GM=(t,e)=>{const r=Ik(t,e),n=zg(t,e);return!n||!r?!1:r>n.depth},HM=(t,e)=>{const r=Ik(t,e),n=zg(t,e);return!n||!r?!1:r<n.depth},cS=(t,e)=>{if(!qu(t.state,e)||!oq(t.state,e))return!1;const{selection:r}=t.state,{$from:n,$to:i}=r;return!r.empty&&n.sameParent(i)?!1:GM(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():HM(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},oK=(t,e)=>{var r;const{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-n.parentOffset-2);return!(i.index()===i.parent.childCount-1||((r=i.nodeAfter)==null?void 0:r.type.name)!==t)},qM=Sn.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r})=>{t.state.schema.nodes[r]!==void 0&&cS(t,r)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r})=>{t.state.schema.nodes[r]!==void 0&&cS(t,r)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{t.state.schema.nodes[r]!==void 0&&uS(t,r,n)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{t.state.schema.nodes[r]!==void 0&&uS(t,r,n)&&(e=!0)}),e}}}}),wT=/^(\s*)(\d+)\.\s+(.*)$/,lK=/^\s/;function uK(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r],a=i.match(wT);if(!a)break;const[,s,o,l]=a,u=s.length;let c=l,f=r+1;const m=[i];for(;f<t.length;){const g=t[f];if(g.match(wT))break;if(g.trim()==="")m.push(g),c+=`
`,f+=1;else if(g.match(lK))m.push(g),c+=`
${g.slice(u+2)}`,f+=1;else break}e.push({indent:u,number:parseInt(o,10),content:c.trim(),raw:m.join(`
`)}),n=f,r=f}return[e,n]}function WM(t,e,r){var n;const i=[];let a=0;for(;a<t.length;){const s=t[a];if(s.indent===e){const o=s.content.split(`
`),l=((n=o[0])==null?void 0:n.trim())||"",u=[];l&&u.push({type:"paragraph",raw:l,tokens:r.inlineTokens(l)});const c=o.slice(1).join(`
`).trim();if(c){const g=r.blockTokens(c);u.push(...g)}let f=a+1;const m=[];for(;f<t.length&&t[f].indent>e;)m.push(t[f]),f+=1;if(m.length>0){const g=Math.min(...m.map(b=>b.indent)),y=WM(m,g,r);u.push({type:"list",ordered:!0,start:m[0].number,items:y,raw:m.map(b=>b.raw).join(`
`)})}i.push({type:"list_item",raw:s.raw,tokens:u}),a=f}else a+=1}return i}function cK(t,e){return t.map(r=>{if(r.type!=="list_item")return e.parseChildren([r])[0];const n=[];return r.tokens&&r.tokens.length>0&&r.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")n.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){const a=e.parseChildren([i]);n.push({type:"paragraph",content:a})}else{const a=e.parseChildren([i]);a.length>0&&n.push(...a)}}),{type:"listItem",content:n}})}var dK="listItem",ST="textStyle",kT=/^(\d+)\.\s$/,$M=Ea.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...r}=t;return e===1?["ol",qr(this.options.HTMLAttributes,r),0]:["ol",qr(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const r=t.start||1,n=t.items?cK(t.items,e):[];return r!==1?{type:"orderedList",attrs:{start:r},content:n}:{type:"orderedList",content:n}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),r=e?.index;return r!==void 0?r:-1},tokenize:(t,e,r)=>{var n;const i=t.split(`
`),[a,s]=uK(i);if(a.length===0)return;const o=WM(a,0,r);return o.length===0?void 0:{type:"list",ordered:!0,start:((n=a[0])==null?void 0:n.number)||1,items:o,raw:i.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(dK,this.editor.getAttributes(ST)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=dh({find:kT,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=dh({find:kT,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(ST)}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1],editor:this.editor})),[t]}}),fK=/^\s*(\[([( |x])?\])\s$/,hK=Ea.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",qr(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const r=[];if(t.tokens&&t.tokens.length>0?r.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?r.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):r.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const n=e.parseChildren(t.nestedTokens);r.push(...n)}return e.createNode("taskItem",{checked:t.checked||!1},r)},renderMarkdown:(t,e)=>{var r;const i=`- [${(r=t.attrs)!=null&&r.checked?"x":" "}] `;return Ek(t,e,i)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:r,editor:n})=>{const i=document.createElement("li"),a=document.createElement("label"),s=document.createElement("span"),o=document.createElement("input"),l=document.createElement("div"),u=f=>{var m,g;o.ariaLabel=((g=(m=this.options.a11y)==null?void 0:m.checkboxLabel)==null?void 0:g.call(m,f,o.checked))||`Task item checkbox for ${f.textContent||"empty task item"}`};u(t),a.contentEditable="false",o.type="checkbox",o.addEventListener("mousedown",f=>f.preventDefault()),o.addEventListener("change",f=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){o.checked=!o.checked;return}const{checked:m}=f.target;n.isEditable&&typeof r=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:g})=>{const y=r();if(typeof y!="number")return!1;const b=g.doc.nodeAt(y);return g.setNodeMarkup(y,void 0,{...b?.attrs,checked:m}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,m)||(o.checked=!o.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([f,m])=>{i.setAttribute(f,m)}),i.dataset.checked=t.attrs.checked,o.checked=t.attrs.checked,a.append(o,s),i.append(a,l),Object.entries(e).forEach(([f,m])=>{i.setAttribute(f,m)});let c=new Set(Object.keys(e));return{dom:i,contentDOM:l,update:f=>{if(f.type!==this.type)return!1;i.dataset.checked=f.attrs.checked,o.checked=f.attrs.checked,u(f);const m=n.extensionManager.attributes,g=yg(f,m),y=new Set(Object.keys(g)),b=this.options.HTMLAttributes;return c.forEach(w=>{y.has(w)||(w in b?i.setAttribute(w,b[w]):i.removeAttribute(w))}),Object.entries(g).forEach(([w,N])=>{N==null?w in b?i.setAttribute(w,b[w]):i.removeAttribute(w):i.setAttribute(w,N)}),c=y,!0}}}},addInputRules(){return[dh({find:fK,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),pK=Ea.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",qr(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const r=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return r!==void 0?r:-1},tokenize(t,e,r){const n=a=>{const s=Z2(a,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,l)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:r.inlineTokens(o.mainContent),nestedTokens:l}),customNestedParser:n},r);return s?[{type:"taskList",raw:s.raw,items:s.items}]:r.blockTokens(a)},i=Z2(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,s)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:r.inlineTokens(a.mainContent),nestedTokens:s}),customNestedParser:n},r);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Sn.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(BM.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(FM.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(qM.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push($M.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(hK.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(pK.configure(this.options.taskList)),t}});var mK=Ea.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",qr(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const r=t.tokens||[];return r.length===1&&r[0].type==="image"?e.parseChildren([r[0]]):e.createNode("paragraph",void 0,e.parseInline(r))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),gK=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,vK=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,yK=Nd.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",qr(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[ch({find:gK,type:this.type})]},addPasteRules(){return[xd({find:vK,type:this.type})]}}),xK=Ea.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),bK=Nd.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",qr(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,r){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const a=i[2].trim();return{type:"underline",raw:i[0],text:a,tokens:r.inlineTokens(a)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function wK(t={}){return new Wr({view(e){return new SK(e,t)}})}class SK{constructor(e,r){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=r.width)!==null&&n!==void 0?n:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let a=s=>{this[i](s)};return e.dom.addEventListener(i,a),{name:i,handler:a}})}destroy(){this.handlers.forEach(({name:e,handler:r})=>this.editorView.dom.removeEventListener(e,r))}update(e,r){this.cursorPos!=null&&r.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),r=!e.parent.inlineContent,n,i=this.editorView.dom,a=i.getBoundingClientRect(),s=a.width/i.offsetWidth,o=a.height/i.offsetHeight;if(r){let f=e.nodeBefore,m=e.nodeAfter;if(f||m){let g=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(g){let y=g.getBoundingClientRect(),b=f?y.bottom:y.top;f&&m&&(b=(b+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*o;n={left:y.left,right:y.right,top:b-w,bottom:b+w}}}}if(!n){let f=this.editorView.coordsAtPos(this.cursorPos),m=this.width/2*s;n={left:f.left-m,right:f.left+m,top:f.top,bottom:f.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let u,c;if(!l||l==document.body&&getComputedStyle(l).position=="static")u=-pageXOffset,c=-pageYOffset;else{let f=l.getBoundingClientRect(),m=f.width/l.offsetWidth,g=f.height/l.offsetHeight;u=f.left-l.scrollLeft*m,c=f.top-l.scrollTop*g}this.element.style.left=(n.left-u)/s+"px",this.element.style.top=(n.top-c)/o+"px",this.element.style.width=(n.right-n.left)/s+"px",this.element.style.height=(n.bottom-n.top)/o+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),i=n&&n.type.spec.disableDropCursor,a=typeof i=="function"?i(this.editorView,r,e):i;if(r&&!a){let s=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=qP(this.editorView.state.doc,s,this.editorView.dragging.slice);o!=null&&(s=o)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class sn extends Ft{constructor(e){super(e,e)}map(e,r){let n=e.resolve(r.map(this.head));return sn.valid(n)?new sn(n):Ft.near(n)}content(){return st.empty}eq(e){return e instanceof sn&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new sn(e.resolve(r.pos))}getBookmark(){return new Lk(this.anchor)}static valid(e){let r=e.parent;if(r.isTextblock||!kK(e)||!CK(e))return!1;let n=r.type.spec.allowGapCursor;if(n!=null)return n;let i=r.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,r,n=!1){e:for(;;){if(!n&&sn.valid(e))return e;let i=e.pos,a=null;for(let s=e.depth;;s--){let o=e.node(s);if(r>0?e.indexAfter(s)<o.childCount:e.index(s)>0){a=o.child(r>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=r;let l=e.doc.resolve(i);if(sn.valid(l))return l}for(;;){let s=r>0?a.firstChild:a.lastChild;if(!s){if(a.isAtom&&!a.isText&&!wt.isSelectable(a)){e=e.doc.resolve(i+a.nodeSize*r),n=!1;continue e}break}a=s,i+=r;let o=e.doc.resolve(i);if(sn.valid(o))return o}return null}}}sn.prototype.visible=!1;sn.findFrom=sn.findGapCursorFrom;Ft.jsonID("gapcursor",sn);class Lk{constructor(e){this.pos=e}map(e){return new Lk(e.map(this.pos))}resolve(e){let r=e.resolve(this.pos);return sn.valid(r)?new sn(r):Ft.near(r)}}function KM(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function kK(t){for(let e=t.depth;e>=0;e--){let r=t.index(e),n=t.node(e);if(r==0){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||KM(i.type))return!0;if(i.inlineContent)return!1}}return!0}function CK(t){for(let e=t.depth;e>=0;e--){let r=t.indexAfter(e),n=t.node(e);if(r==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||KM(i.type))return!0;if(i.inlineContent)return!1}}return!0}function NK(){return new Wr({props:{decorations:PK,createSelectionBetween(t,e,r){return e.pos==r.pos&&sn.valid(r)?new sn(r):null},handleClick:TK,handleKeyDown:EK,handleDOMEvents:{beforeinput:jK}}})}const EK=W8({ArrowLeft:N0("horiz",-1),ArrowRight:N0("horiz",1),ArrowUp:N0("vert",-1),ArrowDown:N0("vert",1)});function N0(t,e){const r=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,i,a){let s=n.selection,o=e>0?s.$to:s.$from,l=s.empty;if(s instanceof Dt){if(!a.endOfTextblock(r)||o.depth==0)return!1;l=!1,o=n.doc.resolve(e>0?o.after():o.before())}let u=sn.findGapCursorFrom(o,e,l);return u?(i&&i(n.tr.setSelection(new sn(u))),!0):!1}}function TK(t,e,r){if(!t||!t.editable)return!1;let n=t.state.doc.resolve(e);if(!sn.valid(n))return!1;let i=t.posAtCoords({left:r.clientX,top:r.clientY});return i&&i.inside>-1&&wt.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new sn(n))),!0)}function jK(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof sn))return!1;let{$from:r}=t.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(t.state.schema.nodes.text);if(!n)return!1;let i=Ve.empty;for(let s=n.length-1;s>=0;s--)i=Ve.from(n[s].createAndFill(null,i));let a=t.state.tr.replace(r.pos,r.pos,new st(i,0,0));return a.setSelection(Dt.near(a.doc.resolve(r.pos+1))),t.dispatch(a),!1}function PK(t){if(!(t.selection instanceof sn))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Gr.create(t.doc,[Di.widget(t.selection.head,e,{key:"gapcursor"})])}var Jy=200,ii=function(){};ii.prototype.append=function(e){return e.length?(e=ii.from(e),!this.length&&e||e.length<Jy&&this.leafAppend(e)||this.length<Jy&&e.leafPrepend(this)||this.appendInner(e)):this};ii.prototype.prepend=function(e){return e.length?ii.from(e).append(this):this};ii.prototype.appendInner=function(e){return new MK(this,e)};ii.prototype.slice=function(e,r){return e===void 0&&(e=0),r===void 0&&(r=this.length),e>=r?ii.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,r))};ii.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};ii.prototype.forEach=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length),r<=n?this.forEachInner(e,r,n,0):this.forEachInvertedInner(e,r,n,0)};ii.prototype.map=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length);var i=[];return this.forEach(function(a,s){return i.push(e(a,s))},r,n),i};ii.from=function(e){return e instanceof ii?e:e&&e.length?new YM(e):ii.empty};var YM=(function(t){function e(n){t.call(this),this.values=n}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,a){return i==0&&a==this.length?this:new e(this.values.slice(i,a))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,a,s,o){for(var l=a;l<s;l++)if(i(this.values[l],o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,a,s,o){for(var l=a-1;l>=s;l--)if(i(this.values[l],o+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Jy)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Jy)return new e(i.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(e.prototype,r),e})(ii);ii.empty=new YM([]);var MK=(function(t){function e(r,n){t.call(this),this.left=r,this.right=n,this.length=r.length+n.length,this.depth=Math.max(r.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,i,a,s){var o=this.left.length;if(i<o&&this.left.forEachInner(n,i,Math.min(a,o),s)===!1||a>o&&this.right.forEachInner(n,Math.max(i-o,0),Math.min(this.length,a)-o,s+o)===!1)return!1},e.prototype.forEachInvertedInner=function(n,i,a,s){var o=this.left.length;if(i>o&&this.right.forEachInvertedInner(n,i-o,Math.max(a,o)-o,s+o)===!1||a<o&&this.left.forEachInvertedInner(n,Math.min(i,o),a,s)===!1)return!1},e.prototype.sliceInner=function(n,i){if(n==0&&i==this.length)return this;var a=this.left.length;return i<=a?this.left.slice(n,i):n>=a?this.right.slice(n-a,i-a):this.left.slice(n,a).append(this.right.slice(0,i-a))},e.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new e(i,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e})(ii);const _K=500;class Os{constructor(e,r){this.items=e,this.eventCount=r}popEvent(e,r){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let i,a;r&&(i=this.remapping(n,this.items.length),a=i.maps.length);let s=e.tr,o,l,u=[],c=[];return this.items.forEach((f,m)=>{if(!f.step){i||(i=this.remapping(n,m+1),a=i.maps.length),a--,c.push(f);return}if(i){c.push(new vo(f.map));let g=f.step.map(i.slice(a)),y;g&&s.maybeStep(g).doc&&(y=s.mapping.maps[s.mapping.maps.length-1],u.push(new vo(y,void 0,void 0,u.length+c.length))),a--,y&&i.appendMap(y,a)}else s.maybeStep(f.step);if(f.selection)return o=i?f.selection.map(i.slice(a)):f.selection,l=new Os(this.items.slice(0,n).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:o}}addTransform(e,r,n,i){let a=[],s=this.eventCount,o=this.items,l=!i&&o.length?o.get(o.length-1):null;for(let c=0;c<e.steps.length;c++){let f=e.steps[c].invert(e.docs[c]),m=new vo(e.mapping.maps[c],f,r),g;(g=l&&l.merge(m))&&(m=g,c?a.pop():o=o.slice(0,o.length-1)),a.push(m),r&&(s++,r=void 0),i||(l=m)}let u=s-n.depth;return u>RK&&(o=AK(o,u),s-=u),new Os(o.append(a),s)}remapping(e,r){let n=new fg;return this.items.forEach((i,a)=>{let s=i.mirrorOffset!=null&&a-i.mirrorOffset>=e?n.maps.length-i.mirrorOffset:void 0;n.appendMap(i.map,s)},e,r),n}addMaps(e){return this.eventCount==0?this:new Os(this.items.append(e.map(r=>new vo(r))),this.eventCount)}rebased(e,r){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-r),a=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach(m=>{m.selection&&o--},i);let l=r;this.items.forEach(m=>{let g=a.getMirror(--l);if(g==null)return;s=Math.min(s,g);let y=a.maps[g];if(m.step){let b=e.steps[g].invert(e.docs[g]),w=m.selection&&m.selection.map(a.slice(l+1,g));w&&o++,n.push(new vo(y,b,w))}else n.push(new vo(y))},i);let u=[];for(let m=r;m<s;m++)u.push(new vo(a.maps[m]));let c=this.items.slice(0,i).append(u).append(n),f=new Os(c,o);return f.emptyItemCount()>_K&&(f=f.compress(this.items.length-n.length)),f}emptyItemCount(){let e=0;return this.items.forEach(r=>{r.step||e++}),e}compress(e=this.items.length){let r=this.remapping(0,e),n=r.maps.length,i=[],a=0;return this.items.forEach((s,o)=>{if(o>=e)i.push(s),s.selection&&a++;else if(s.step){let l=s.step.map(r.slice(n)),u=l&&l.getMap();if(n--,u&&r.appendMap(u,n),l){let c=s.selection&&s.selection.map(r.slice(n));c&&a++;let f=new vo(u.invert(),l,c),m,g=i.length-1;(m=i.length&&i[g].merge(f))?i[g]=m:i.push(f)}}else s.map&&n--},this.items.length,0),new Os(ii.from(i.reverse()),a)}}Os.empty=new Os(ii.empty,0);function AK(t,e){let r;return t.forEach((n,i)=>{if(n.selection&&e--==0)return r=i,!1}),t.slice(r)}class vo{constructor(e,r,n,i){this.map=e,this.step=r,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let r=e.step.merge(this.step);if(r)return new vo(r.getMap().invert(),r,this.selection)}}}class wu{constructor(e,r,n,i,a){this.done=e,this.undone=r,this.prevRanges=n,this.prevTime=i,this.prevComposition=a}}const RK=20;function DK(t,e,r,n){let i=r.getMeta(sd),a;if(i)return i.historyState;r.getMeta(LK)&&(t=new wu(t.done,t.undone,null,0,-1));let s=r.getMeta("appendedTransaction");if(r.steps.length==0)return t;if(s&&s.getMeta(sd))return s.getMeta(sd).redo?new wu(t.done.addTransform(r,void 0,n,H0(e)),t.undone,CT(r.mapping.maps),t.prevTime,t.prevComposition):new wu(t.done,t.undone.addTransform(r,void 0,n,H0(e)),null,t.prevTime,t.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let o=r.getMeta("composition"),l=t.prevTime==0||!s&&t.prevComposition!=o&&(t.prevTime<(r.time||0)-n.newGroupDelay||!OK(r,t.prevRanges)),u=s?t2(t.prevRanges,r.mapping):CT(r.mapping.maps);return new wu(t.done.addTransform(r,l?e.selection.getBookmark():void 0,n,H0(e)),Os.empty,u,r.time,o??t.prevComposition)}else return(a=r.getMeta("rebased"))?new wu(t.done.rebased(r,a),t.undone.rebased(r,a),t2(t.prevRanges,r.mapping),t.prevTime,t.prevComposition):new wu(t.done.addMaps(r.mapping.maps),t.undone.addMaps(r.mapping.maps),t2(t.prevRanges,r.mapping),t.prevTime,t.prevComposition)}function OK(t,e){if(!e)return!1;if(!t.docChanged)return!0;let r=!1;return t.mapping.maps[0].forEach((n,i)=>{for(let a=0;a<e.length;a+=2)n<=e[a+1]&&i>=e[a]&&(r=!0)}),r}function CT(t){let e=[];for(let r=t.length-1;r>=0&&e.length==0;r--)t[r].forEach((n,i,a,s)=>e.push(a,s));return e}function t2(t,e){if(!t)return null;let r=[];for(let n=0;n<t.length;n+=2){let i=e.map(t[n],1),a=e.map(t[n+1],-1);i<=a&&r.push(i,a)}return r}function IK(t,e,r){let n=H0(e),i=sd.get(e).spec.config,a=(r?t.undone:t.done).popEvent(e,n);if(!a)return null;let s=a.selection.resolve(a.transform.doc),o=(r?t.done:t.undone).addTransform(a.transform,e.selection.getBookmark(),i,n),l=new wu(r?o:a.remaining,r?a.remaining:o,null,0,-1);return a.transform.setSelection(s).setMeta(sd,{redo:r,historyState:l})}let r2=!1,NT=null;function H0(t){let e=t.plugins;if(NT!=e){r2=!1,NT=e;for(let r=0;r<e.length;r++)if(e[r].spec.historyPreserveItems){r2=!0;break}}return r2}const sd=new wn("history"),LK=new wn("closeHistory");function BK(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Wr({key:sd,state:{init(){return new wu(Os.empty,Os.empty,null,0,-1)},apply(e,r,n){return DK(r,n,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,r){let n=r.inputType,i=n=="historyUndo"?QM:n=="historyRedo"?JM:null;return!i||!e.editable?!1:(r.preventDefault(),i(e.state,e.dispatch))}}}})}function XM(t,e){return(r,n)=>{let i=sd.getState(r);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(n){let a=IK(i,r,t);a&&n(e?a.scrollIntoView():a)}return!0}}const QM=XM(!1,!0),JM=XM(!0,!0);Sn.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=t?.node||this.editor.state.doc;if((t?.mode||this.options.mode)==="textSize"){const n=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(n)}return e.nodeSize},this.storage.words=t=>{const e=t?.node||this.editor.state.doc,r=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let t=!1;return[new Wr({key:new wn("characterCount"),appendTransaction:(e,r,n)=>{if(t)return;const i=this.options.limit;if(i==null||i===0){t=!0;return}const a=this.storage.characters({node:n.doc});if(a>i){const s=a-i,o=0,l=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const u=n.tr.deleteRange(o,l);return t=!0,u}t=!0},filterTransaction:(e,r)=>{const n=this.options.limit;if(!e.docChanged||n===0||n===null||n===void 0)return!0;const i=this.storage.characters({node:r.doc}),a=this.storage.characters({node:e.doc});if(a<=n||i>n&&a>n&&a<=i)return!0;if(i>n&&a>n&&a>i||!e.getMeta("paste"))return!1;const o=e.selection.$head.pos,l=a-n,u=o-l,c=o;return e.deleteRange(u,c),!(this.storage.characters({node:e.doc})>n)}})]}});var FK=Sn.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[wK(this.options)]}});Sn.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Wr({key:new wn("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:i}=e,a=[];if(!r||!n)return Gr.create(t,[]);let s=0;this.options.mode==="deepest"&&t.descendants((l,u)=>{if(l.isText)return;if(!(i>=u&&i<=u+l.nodeSize-1))return!1;s+=1});let o=0;return t.descendants((l,u)=>{if(l.isText||!(i>=u&&i<=u+l.nodeSize-1))return!1;if(o+=1,this.options.mode==="deepest"&&s-o>0||this.options.mode==="shallowest"&&o>1)return this.options.mode==="deepest";a.push(Di.node(u,u+l.nodeSize,{class:this.options.className}))}),Gr.create(t,a)}}})]}});var zK=Sn.create({name:"gapCursor",addProseMirrorPlugins(){return[NK()]},extendNodeSchema(t){var e;const r={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=fr(yt(t,"allowGapCursor",r)))!=null?e:null}}}),VK=Sn.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Wr({key:new wn("placeholder"),props:{decorations:({doc:t,selection:e})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=e,i=[];if(!r)return null;const a=this.editor.isEmpty;return t.descendants((s,o)=>{const l=n>=o&&n<=o+s.nodeSize,u=!s.isLeaf&&Ix(s);if((l||!this.options.showOnlyCurrent)&&u){const c=[this.options.emptyNodeClass];a&&c.push(this.options.emptyEditorClass);const f=Di.node(o,o+s.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:o,hasAnchor:l}):this.options.placeholder});i.push(f)}return this.options.includeChildren}),Gr.create(t,i)}}})]}});Sn.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new Wr({key:new wn("selection"),props:{decorations(r){return r.selection.empty||t.isFocused||!t.isEditable||lM(r.selection)||t.view.dragging?null:Gr.create(r.doc,[Di.inline(r.selection.from,r.selection.to,{class:e.className})])}}})]}});function ET({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||e?.type===t}var UK=Sn.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new wn(this.name),r=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(r).includes(i.name));return[new Wr({key:e,appendTransaction:(i,a,s)=>{const{doc:o,tr:l,schema:u}=s,c=e.getState(s),f=o.content.size,m=u.nodes[r];if(c)return l.insert(f,m.create())},state:{init:(i,a)=>{const s=a.tr.doc.lastChild;return!ET({node:s,types:n})},apply:(i,a)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return a;const s=i.doc.lastChild;return!ET({node:s,types:n})}}})]}}),GK=Sn.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>QM(t,e),redo:()=>({state:t,dispatch:e})=>JM(t,e)}},addProseMirrorPlugins(){return[BK(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),HK=Sn.create({name:"starterKit",addExtensions(){var t,e,r,n;const i=[];return this.options.bold!==!1&&i.push(g$.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(d$.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(BM.configure(this.options.bulletList)),this.options.code!==!1&&i.push(x$.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(S$.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(k$.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(FK.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(zK.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(C$.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(N$.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(GK.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(E$.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(_$.configure(this.options.italic)),this.options.listItem!==!1&&i.push(FM.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(qM.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&i.push(rK.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push($M.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(mK.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(yK.configure(this.options.strike)),this.options.text!==!1&&i.push(xK.configure(this.options.text)),this.options.underline!==!1&&i.push(bK.configure((r=this.options)==null?void 0:r.underline)),this.options.trailingNode!==!1&&i.push(UK.configure((n=this.options)==null?void 0:n.trailingNode)),i}}),qK=HK,WK=VK;function $K(t){var e;const{char:r,allowSpaces:n,allowToIncludeChar:i,allowedPrefixes:a,startOfLine:s,$position:o}=t,l=n&&!i,u=Yq(r),c=new RegExp(`\\s${u}$`),f=s?"^":"",m=i?"":u,g=l?new RegExp(`${f}${u}.*?(?=\\s${m}|$)`,"gm"):new RegExp(`${f}(?:^)?${u}[^\\s${m}]*`,"gm"),y=((e=o.nodeBefore)==null?void 0:e.isText)&&o.nodeBefore.text;if(!y)return null;const b=o.pos-y.length,w=Array.from(y.matchAll(g)).pop();if(!w||w.input===void 0||w.index===void 0)return null;const N=w.input.slice(Math.max(0,w.index-1),w.index),k=new RegExp(`^[${a?.join("")}\0]?$`).test(N);if(a!==null&&!k)return null;const C=b+w.index;let E=C+w[0].length;return l&&c.test(y.slice(E-1,E+1))&&(w[0]+=" ",E+=1),C<o.pos&&E>=o.pos?{range:{from:C,to:E},query:w[0].slice(r.length),text:w[0]}:null}var KK=new wn("suggestion");function YK({pluginKey:t=KK,editor:e,char:r="@",allowSpaces:n=!1,allowToIncludeChar:i=!1,allowedPrefixes:a=[" "],startOfLine:s=!1,decorationTag:o="span",decorationClass:l="suggestion",decorationContent:u="",decorationEmptyClass:c="is-empty",command:f=()=>null,items:m=()=>[],render:g=()=>({}),allow:y=()=>!0,findSuggestionMatch:b=$K,shouldShow:w}){let N;const k=g?.(),C=()=>{const A=e.state.selection.$anchor.pos,I=e.view.coordsAtPos(A),{top:D,right:L,bottom:U,left:H}=I;try{return new DOMRect(H,D,L-H,U-D)}catch{return null}},E=(A,I)=>I?()=>{const D=t.getState(e.state),L=D?.decorationId,U=A.dom.querySelector(`[data-decoration-id="${L}"]`);return U?.getBoundingClientRect()||null}:C;function P(A,I){var D;try{const U=t.getState(A.state),H=U?.decorationId?A.dom.querySelector(`[data-decoration-id="${U.decorationId}"]`):null,M={editor:e,range:U?.range||{from:0,to:0},query:U?.query||null,text:U?.text||null,items:[],command:z=>f({editor:e,range:U?.range||{from:0,to:0},props:z}),decorationNode:H,clientRect:E(A,H)};(D=k?.onExit)==null||D.call(k,M)}catch{}const L=A.state.tr.setMeta(I,{exit:!0});A.dispatch(L)}const _=new Wr({key:t,view(){return{update:async(A,I)=>{var D,L,U,H,M,z,O;const G=(D=this.key)==null?void 0:D.getState(I),W=(L=this.key)==null?void 0:L.getState(A.state),$=G.active&&W.active&&G.range.from!==W.range.from,X=!G.active&&W.active,Q=G.active&&!W.active,V=!X&&!Q&&G.query!==W.query,Y=X||$&&V,Z=V||$,ie=Q||$&&V;if(!Y&&!Z&&!ie)return;const ce=ie&&!Y?G:W,he=A.dom.querySelector(`[data-decoration-id="${ce.decorationId}"]`);N={editor:e,range:ce.range,query:ce.query,text:ce.text,items:[],command:ee=>f({editor:e,range:ce.range,props:ee}),decorationNode:he,clientRect:E(A,he)},Y&&((U=k?.onBeforeStart)==null||U.call(k,N)),Z&&((H=k?.onBeforeUpdate)==null||H.call(k,N)),(Z||Y)&&(N.items=await m({editor:e,query:ce.query})),ie&&((M=k?.onExit)==null||M.call(k,N)),Z&&((z=k?.onUpdate)==null||z.call(k,N)),Y&&((O=k?.onStart)==null||O.call(k,N))},destroy:()=>{var A;N&&((A=k?.onExit)==null||A.call(k,N))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(A,I,D,L){const{isEditable:U}=e,{composing:H}=e.view,{selection:M}=A,{empty:z,from:O}=M,G={...I},W=A.getMeta(t);if(W&&W.exit)return G.active=!1,G.decorationId=null,G.range={from:0,to:0},G.query=null,G.text=null,G;if(G.composing=H,U&&(z||e.view.composing)){(O<I.range.from||O>I.range.to)&&!H&&!I.composing&&(G.active=!1);const $=b({char:r,allowSpaces:n,allowToIncludeChar:i,allowedPrefixes:a,startOfLine:s,$position:M.$from}),X=`id_${Math.floor(Math.random()*4294967295)}`;$&&y({editor:e,state:L,range:$.range,isActive:I.active})&&(!w||w({editor:e,range:$.range,query:$.query,text:$.text,transaction:A}))?(G.active=!0,G.decorationId=I.decorationId?I.decorationId:X,G.range=$.range,G.query=$.query,G.text=$.text):G.active=!1}else G.active=!1;return G.active||(G.decorationId=null,G.range={from:0,to:0},G.query=null,G.text=null),G}},props:{handleKeyDown(A,I){var D,L,U,H;const{active:M,range:z}=_.getState(A.state);if(!M)return!1;if(I.key==="Escape"||I.key==="Esc"){const G=_.getState(A.state),W=(D=N?.decorationNode)!=null?D:null,$=W??(G?.decorationId?A.dom.querySelector(`[data-decoration-id="${G.decorationId}"]`):null);if(((L=k?.onKeyDown)==null?void 0:L.call(k,{view:A,event:I,range:G.range}))||!1)return!0;const Q={editor:e,range:G.range,query:G.query,text:G.text,items:[],command:V=>f({editor:e,range:G.range,props:V}),decorationNode:$,clientRect:$?()=>$.getBoundingClientRect()||null:null};return(U=k?.onExit)==null||U.call(k,Q),P(A,t),!0}return((H=k?.onKeyDown)==null?void 0:H.call(k,{view:A,event:I,range:z}))||!1},decorations(A){const{active:I,range:D,decorationId:L,query:U}=_.getState(A);if(!I)return null;const H=!U?.length,M=[l];return H&&M.push(c),Gr.create(A.doc,[Di.inline(D.from,D.to,{nodeName:o,class:M.join(" "),"data-decoration-id":L,"data-decoration-content":u})])}}});return _}function XK({editor:t,overrideSuggestionOptions:e,extensionName:r,char:n="@"}){const i=new wn;return{editor:t,char:n,pluginKey:i,command:({editor:a,range:s,props:o})=>{var l,u,c;const f=a.view.state.selection.$to.nodeAfter;(l=f?.text)!=null&&l.startsWith(" ")&&(s.to+=1),a.chain().focus().insertContentAt(s,[{type:r,attrs:{...o,mentionSuggestionChar:n}},{type:"text",text:" "}]).run(),(c=(u=a.view.dom.ownerDocument.defaultView)==null?void 0:u.getSelection())==null||c.collapseToEnd()},allow:({state:a,range:s})=>{const o=a.doc.resolve(s.from),l=a.schema.nodes[r];return!!o.parent.type.contentMatch.matchType(l)},...e}}function ZM(t){return(t.options.suggestions.length?t.options.suggestions:[t.options.suggestion]).map(e=>XK({editor:t.editor,overrideSuggestionOptions:e,extensionName:t.name,char:e.char}))}function TT(t,e){const r=ZM(t),n=r.find(i=>i.char===e);return n||(r.length?r[0]:null)}var QK=Ea.create({name:"mention",priority:101,addOptions(){return{HTMLAttributes:{},renderText({node:t,suggestion:e}){var r,n;return`${(r=e?.char)!=null?r:"@"}${(n=t.attrs.label)!=null?n:t.attrs.id}`},deleteTriggerWithBackspace:!1,renderHTML({options:t,node:e,suggestion:r}){var n,i;return["span",qr(this.HTMLAttributes,t.HTMLAttributes),`${(n=r?.char)!=null?n:"@"}${(i=e.attrs.label)!=null?i:e.attrs.id}`]},suggestions:[],suggestion:{}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:t=>t.getAttribute("data-id"),renderHTML:t=>t.id?{"data-id":t.id}:{}},label:{default:null,parseHTML:t=>t.getAttribute("data-label"),renderHTML:t=>t.label?{"data-label":t.label}:{}},mentionSuggestionChar:{default:"@",parseHTML:t=>t.getAttribute("data-mention-suggestion-char"),renderHTML:t=>({"data-mention-suggestion-char":t.mentionSuggestionChar})}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:t,HTMLAttributes:e}){const r=TT(this,t.attrs.mentionSuggestionChar);if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",qr({"data-type":this.name},this.options.HTMLAttributes,e),this.options.renderLabel({options:this.options,node:t,suggestion:r})];const n={...this.options};n.HTMLAttributes=qr({"data-type":this.name},this.options.HTMLAttributes,e);const i=this.options.renderHTML({options:n,node:t,suggestion:r});return typeof i=="string"?["span",qr({"data-type":this.name},this.options.HTMLAttributes,e),i]:i},...NM({nodeName:"mention",name:"@",selfClosing:!0,allowedAttributes:["id","label",{name:"mentionSuggestionChar",skipIfDefault:"@"}],parseAttributes:t=>{const e={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(t);for(;n!==null;){const[,i,a,s]=n,o=a??s;e[i==="char"?"mentionSuggestionChar":i]=o,n=r.exec(t)}return e},serializeAttributes:t=>Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e==="mentionSuggestionChar"?"char":e}="${r}"`).join(" ")}),renderText({node:t}){const e={options:this.options,node:t,suggestion:TT(this,t.attrs.mentionSuggestionChar)};return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel(e)):this.options.renderText(e)},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:t,state:e})=>{let r=!1;const{selection:n}=e,{empty:i,anchor:a}=n;if(!i)return!1;let s=new cs,o=0;return e.doc.nodesBetween(a-1,a,(l,u)=>{if(l.type.name===this.name)return r=!0,s=l,o=u,!1}),r&&t.insertText(this.options.deleteTriggerWithBackspace?"":s.attrs.mentionSuggestionChar,o,o+s.nodeSize),r})}},addProseMirrorPlugins(){return ZM(this).map(YK)}}),JK=QK,ka="top",ps="bottom",ms="right",Ca="left",Bk="auto",Vg=[ka,ps,ms,Ca],fh="start",wg="end",ZK="clippingParents",e_="viewport",Nm="popper",eY="reference",jT=Vg.reduce(function(t,e){return t.concat([e+"-"+fh,e+"-"+wg])},[]),t_=[].concat(Vg,[Bk]).reduce(function(t,e){return t.concat([e,e+"-"+fh,e+"-"+wg])},[]),tY="beforeRead",rY="read",nY="afterRead",iY="beforeMain",aY="main",sY="afterMain",oY="beforeWrite",lY="write",uY="afterWrite",cY=[tY,rY,nY,iY,aY,sY,oY,lY,uY];function Co(t){return t?(t.nodeName||"").toLowerCase():null}function Va(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function bd(t){var e=Va(t).Element;return t instanceof e||t instanceof Element}function hs(t){var e=Va(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Fk(t){if(typeof ShadowRoot>"u")return!1;var e=Va(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function dY(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},a=e.elements[r];!hs(a)||!Co(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function fY(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},s=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=s.reduce(function(l,u){return l[u]="",l},{});!hs(i)||!Co(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}const r_={name:"applyStyles",enabled:!0,phase:"write",fn:dY,effect:fY,requires:["computeStyles"]};function bo(t){return t.split("-")[0]}var od=Math.max,Zy=Math.min,hh=Math.round;function dS(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function n_(){return!/^((?!chrome|android).)*safari/i.test(dS())}function ph(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&hs(t)&&(i=t.offsetWidth>0&&hh(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&hh(n.height)/t.offsetHeight||1);var s=bd(t)?Va(t):window,o=s.visualViewport,l=!n_()&&r,u=(n.left+(l&&o?o.offsetLeft:0))/i,c=(n.top+(l&&o?o.offsetTop:0))/a,f=n.width/i,m=n.height/a;return{width:f,height:m,top:c,right:u+f,bottom:c+m,left:u,x:u,y:c}}function zk(t){var e=ph(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function i_(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&Fk(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function gl(t){return Va(t).getComputedStyle(t)}function hY(t){return["table","td","th"].indexOf(Co(t))>=0}function nc(t){return((bd(t)?t.ownerDocument:t.document)||window.document).documentElement}function zx(t){return Co(t)==="html"?t:t.assignedSlot||t.parentNode||(Fk(t)?t.host:null)||nc(t)}function PT(t){return!hs(t)||gl(t).position==="fixed"?null:t.offsetParent}function pY(t){var e=/firefox/i.test(dS()),r=/Trident/i.test(dS());if(r&&hs(t)){var n=gl(t);if(n.position==="fixed")return null}var i=zx(t);for(Fk(i)&&(i=i.host);hs(i)&&["html","body"].indexOf(Co(i))<0;){var a=gl(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Ug(t){for(var e=Va(t),r=PT(t);r&&hY(r)&&gl(r).position==="static";)r=PT(r);return r&&(Co(r)==="html"||Co(r)==="body"&&gl(r).position==="static")?e:r||pY(t)||e}function Vk(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Km(t,e,r){return od(t,Zy(e,r))}function mY(t,e,r){var n=Km(t,e,r);return n>r?r:n}function a_(){return{top:0,right:0,bottom:0,left:0}}function s_(t){return Object.assign({},a_(),t)}function o_(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var gY=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,s_(typeof e!="number"?e:o_(e,Vg))};function vY(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,s=r.modifiersData.popperOffsets,o=bo(r.placement),l=Vk(o),u=[Ca,ms].indexOf(o)>=0,c=u?"height":"width";if(!(!a||!s)){var f=gY(i.padding,r),m=zk(a),g=l==="y"?ka:Ca,y=l==="y"?ps:ms,b=r.rects.reference[c]+r.rects.reference[l]-s[l]-r.rects.popper[c],w=s[l]-r.rects.reference[l],N=Ug(a),k=N?l==="y"?N.clientHeight||0:N.clientWidth||0:0,C=b/2-w/2,E=f[g],P=k-m[c]-f[y],_=k/2-m[c]/2+C,A=Km(E,_,P),I=l;r.modifiersData[n]=(e={},e[I]=A,e.centerOffset=A-_,e)}}function yY(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||i_(e.elements.popper,i)&&(e.elements.arrow=i))}const xY={name:"arrow",enabled:!0,phase:"main",fn:vY,effect:yY,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function mh(t){return t.split("-")[1]}var bY={top:"auto",right:"auto",bottom:"auto",left:"auto"};function wY(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:hh(r*i)/i||0,y:hh(n*i)/i||0}}function MT(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,s=t.offsets,o=t.position,l=t.gpuAcceleration,u=t.adaptive,c=t.roundOffsets,f=t.isFixed,m=s.x,g=m===void 0?0:m,y=s.y,b=y===void 0?0:y,w=typeof c=="function"?c({x:g,y:b}):{x:g,y:b};g=w.x,b=w.y;var N=s.hasOwnProperty("x"),k=s.hasOwnProperty("y"),C=Ca,E=ka,P=window;if(u){var _=Ug(r),A="clientHeight",I="clientWidth";if(_===Va(r)&&(_=nc(r),gl(_).position!=="static"&&o==="absolute"&&(A="scrollHeight",I="scrollWidth")),_=_,i===ka||(i===Ca||i===ms)&&a===wg){E=ps;var D=f&&_===P&&P.visualViewport?P.visualViewport.height:_[A];b-=D-n.height,b*=l?1:-1}if(i===Ca||(i===ka||i===ps)&&a===wg){C=ms;var L=f&&_===P&&P.visualViewport?P.visualViewport.width:_[I];g-=L-n.width,g*=l?1:-1}}var U=Object.assign({position:o},u&&bY),H=c===!0?wY({x:g,y:b},Va(r)):{x:g,y:b};if(g=H.x,b=H.y,l){var M;return Object.assign({},U,(M={},M[E]=k?"0":"",M[C]=N?"0":"",M.transform=(P.devicePixelRatio||1)<=1?"translate("+g+"px, "+b+"px)":"translate3d("+g+"px, "+b+"px, 0)",M))}return Object.assign({},U,(e={},e[E]=k?b+"px":"",e[C]=N?g+"px":"",e.transform="",e))}function SY(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,s=a===void 0?!0:a,o=r.roundOffsets,l=o===void 0?!0:o,u={placement:bo(e.placement),variation:mh(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,MT(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,MT(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const kY={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:SY,data:{}};var E0={passive:!0};function CY(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,s=n.resize,o=s===void 0?!0:s,l=Va(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&u.forEach(function(c){c.addEventListener("scroll",r.update,E0)}),o&&l.addEventListener("resize",r.update,E0),function(){a&&u.forEach(function(c){c.removeEventListener("scroll",r.update,E0)}),o&&l.removeEventListener("resize",r.update,E0)}}const NY={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:CY,data:{}};var EY={left:"right",right:"left",bottom:"top",top:"bottom"};function q0(t){return t.replace(/left|right|bottom|top/g,function(e){return EY[e]})}var TY={start:"end",end:"start"};function _T(t){return t.replace(/start|end/g,function(e){return TY[e]})}function Uk(t){var e=Va(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function Gk(t){return ph(nc(t)).left+Uk(t).scrollLeft}function jY(t,e){var r=Va(t),n=nc(t),i=r.visualViewport,a=n.clientWidth,s=n.clientHeight,o=0,l=0;if(i){a=i.width,s=i.height;var u=n_();(u||!u&&e==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:a,height:s,x:o+Gk(t),y:l}}function PY(t){var e,r=nc(t),n=Uk(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=od(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=od(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+Gk(t),l=-n.scrollTop;return gl(i||r).direction==="rtl"&&(o+=od(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:l}}function Hk(t){var e=gl(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function l_(t){return["html","body","#document"].indexOf(Co(t))>=0?t.ownerDocument.body:hs(t)&&Hk(t)?t:l_(zx(t))}function Ym(t,e){var r;e===void 0&&(e=[]);var n=l_(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=Va(n),s=i?[a].concat(a.visualViewport||[],Hk(n)?n:[]):n,o=e.concat(s);return i?o:o.concat(Ym(zx(s)))}function fS(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function MY(t,e){var r=ph(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function AT(t,e,r){return e===e_?fS(jY(t,r)):bd(e)?MY(e,r):fS(PY(nc(t)))}function _Y(t){var e=Ym(zx(t)),r=["absolute","fixed"].indexOf(gl(t).position)>=0,n=r&&hs(t)?Ug(t):t;return bd(n)?e.filter(function(i){return bd(i)&&i_(i,n)&&Co(i)!=="body"}):[]}function AY(t,e,r,n){var i=e==="clippingParents"?_Y(t):[].concat(e),a=[].concat(i,[r]),s=a[0],o=a.reduce(function(l,u){var c=AT(t,u,n);return l.top=od(c.top,l.top),l.right=Zy(c.right,l.right),l.bottom=Zy(c.bottom,l.bottom),l.left=od(c.left,l.left),l},AT(t,s,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function u_(t){var e=t.reference,r=t.element,n=t.placement,i=n?bo(n):null,a=n?mh(n):null,s=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,l;switch(i){case ka:l={x:s,y:e.y-r.height};break;case ps:l={x:s,y:e.y+e.height};break;case ms:l={x:e.x+e.width,y:o};break;case Ca:l={x:e.x-r.width,y:o};break;default:l={x:e.x,y:e.y}}var u=i?Vk(i):null;if(u!=null){var c=u==="y"?"height":"width";switch(a){case fh:l[u]=l[u]-(e[c]/2-r[c]/2);break;case wg:l[u]=l[u]+(e[c]/2-r[c]/2);break}}return l}function Sg(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.strategy,s=a===void 0?t.strategy:a,o=r.boundary,l=o===void 0?ZK:o,u=r.rootBoundary,c=u===void 0?e_:u,f=r.elementContext,m=f===void 0?Nm:f,g=r.altBoundary,y=g===void 0?!1:g,b=r.padding,w=b===void 0?0:b,N=s_(typeof w!="number"?w:o_(w,Vg)),k=m===Nm?eY:Nm,C=t.rects.popper,E=t.elements[y?k:m],P=AY(bd(E)?E:E.contextElement||nc(t.elements.popper),l,c,s),_=ph(t.elements.reference),A=u_({reference:_,element:C,placement:i}),I=fS(Object.assign({},C,A)),D=m===Nm?I:_,L={top:P.top-D.top+N.top,bottom:D.bottom-P.bottom+N.bottom,left:P.left-D.left+N.left,right:D.right-P.right+N.right},U=t.modifiersData.offset;if(m===Nm&&U){var H=U[i];Object.keys(L).forEach(function(M){var z=[ms,ps].indexOf(M)>=0?1:-1,O=[ka,ps].indexOf(M)>=0?"y":"x";L[M]+=H[O]*z})}return L}function RY(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,s=r.padding,o=r.flipVariations,l=r.allowedAutoPlacements,u=l===void 0?t_:l,c=mh(n),f=c?o?jT:jT.filter(function(y){return mh(y)===c}):Vg,m=f.filter(function(y){return u.indexOf(y)>=0});m.length===0&&(m=f);var g=m.reduce(function(y,b){return y[b]=Sg(t,{placement:b,boundary:i,rootBoundary:a,padding:s})[bo(b)],y},{});return Object.keys(g).sort(function(y,b){return g[y]-g[b]})}function DY(t){if(bo(t)===Bk)return[];var e=q0(t);return[_T(t),e,_T(e)]}function OY(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!0:s,l=r.fallbackPlacements,u=r.padding,c=r.boundary,f=r.rootBoundary,m=r.altBoundary,g=r.flipVariations,y=g===void 0?!0:g,b=r.allowedAutoPlacements,w=e.options.placement,N=bo(w),k=N===w,C=l||(k||!y?[q0(w)]:DY(w)),E=[w].concat(C).reduce(function(ie,ce){return ie.concat(bo(ce)===Bk?RY(e,{placement:ce,boundary:c,rootBoundary:f,padding:u,flipVariations:y,allowedAutoPlacements:b}):ce)},[]),P=e.rects.reference,_=e.rects.popper,A=new Map,I=!0,D=E[0],L=0;L<E.length;L++){var U=E[L],H=bo(U),M=mh(U)===fh,z=[ka,ps].indexOf(H)>=0,O=z?"width":"height",G=Sg(e,{placement:U,boundary:c,rootBoundary:f,altBoundary:m,padding:u}),W=z?M?ms:Ca:M?ps:ka;P[O]>_[O]&&(W=q0(W));var $=q0(W),X=[];if(a&&X.push(G[H]<=0),o&&X.push(G[W]<=0,G[$]<=0),X.every(function(ie){return ie})){D=U,I=!1;break}A.set(U,X)}if(I)for(var Q=y?3:1,V=function(ce){var he=E.find(function(ee){var le=A.get(ee);if(le)return le.slice(0,ce).every(function(te){return te})});if(he)return D=he,"break"},Y=Q;Y>0;Y--){var Z=V(Y);if(Z==="break")break}e.placement!==D&&(e.modifiersData[n]._skip=!0,e.placement=D,e.reset=!0)}}const IY={name:"flip",enabled:!0,phase:"main",fn:OY,requiresIfExists:["offset"],data:{_skip:!1}};function RT(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function DT(t){return[ka,ms,ps,Ca].some(function(e){return t[e]>=0})}function LY(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=Sg(e,{elementContext:"reference"}),o=Sg(e,{altBoundary:!0}),l=RT(s,n),u=RT(o,i,a),c=DT(l),f=DT(u);e.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":f})}const BY={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:LY};function FY(t,e,r){var n=bo(t),i=[Ca,ka].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[Ca,ms].indexOf(n)>=0?{x:o,y:s}:{x:s,y:o}}function zY(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,s=t_.reduce(function(c,f){return c[f]=FY(f,e.rects,a),c},{}),o=s[e.placement],l=o.x,u=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[n]=s}const VY={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:zY};function UY(t){var e=t.state,r=t.name;e.modifiersData[r]=u_({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const GY={name:"popperOffsets",enabled:!0,phase:"read",fn:UY,data:{}};function HY(t){return t==="x"?"y":"x"}function qY(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!1:s,l=r.boundary,u=r.rootBoundary,c=r.altBoundary,f=r.padding,m=r.tether,g=m===void 0?!0:m,y=r.tetherOffset,b=y===void 0?0:y,w=Sg(e,{boundary:l,rootBoundary:u,padding:f,altBoundary:c}),N=bo(e.placement),k=mh(e.placement),C=!k,E=Vk(N),P=HY(E),_=e.modifiersData.popperOffsets,A=e.rects.reference,I=e.rects.popper,D=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,L=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),U=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,H={x:0,y:0};if(_){if(a){var M,z=E==="y"?ka:Ca,O=E==="y"?ps:ms,G=E==="y"?"height":"width",W=_[E],$=W+w[z],X=W-w[O],Q=g?-I[G]/2:0,V=k===fh?A[G]:I[G],Y=k===fh?-I[G]:-A[G],Z=e.elements.arrow,ie=g&&Z?zk(Z):{width:0,height:0},ce=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:a_(),he=ce[z],ee=ce[O],le=Km(0,A[G],ie[G]),te=C?A[G]/2-Q-le-he-L.mainAxis:V-le-he-L.mainAxis,ae=C?-A[G]/2+Q+le+ee+L.mainAxis:Y+le+ee+L.mainAxis,oe=e.elements.arrow&&Ug(e.elements.arrow),fe=oe?E==="y"?oe.clientTop||0:oe.clientLeft||0:0,pe=(M=U?.[E])!=null?M:0,Te=W+te-pe-fe,Oe=W+ae-pe,_e=Km(g?Zy($,Te):$,W,g?od(X,Oe):X);_[E]=_e,H[E]=_e-W}if(o){var Ae,He=E==="x"?ka:Ca,tt=E==="x"?ps:ms,Ie=_[P],ye=P==="y"?"height":"width",Pe=Ie+w[He],Be=Ie-w[tt],Ge=[ka,Ca].indexOf(N)!==-1,et=(Ae=U?.[P])!=null?Ae:0,mt=Ge?Pe:Ie-A[ye]-I[ye]-et+L.altAxis,gt=Ge?Ie+A[ye]+I[ye]-et-L.altAxis:Be,bt=g&&Ge?mY(mt,Ie,gt):Km(g?mt:Pe,Ie,g?gt:Be);_[P]=bt,H[P]=bt-Ie}e.modifiersData[n]=H}}const WY={name:"preventOverflow",enabled:!0,phase:"main",fn:qY,requiresIfExists:["offset"]};function $Y(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function KY(t){return t===Va(t)||!hs(t)?Uk(t):$Y(t)}function YY(t){var e=t.getBoundingClientRect(),r=hh(e.width)/t.offsetWidth||1,n=hh(e.height)/t.offsetHeight||1;return r!==1||n!==1}function XY(t,e,r){r===void 0&&(r=!1);var n=hs(e),i=hs(e)&&YY(e),a=nc(e),s=ph(t,i,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&((Co(e)!=="body"||Hk(a))&&(o=KY(e)),hs(e)?(l=ph(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=Gk(a))),{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}function QY(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!r.has(o)){var l=e.get(o);l&&i(l)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function JY(t){var e=QY(t);return cY.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function ZY(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function eX(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var OT={placement:"bottom",modifiers:[],strategy:"absolute"};function IT(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function tX(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?OT:i;return function(o,l,u){u===void 0&&(u=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},OT,a),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},f=[],m=!1,g={state:c,setOptions:function(N){var k=typeof N=="function"?N(c.options):N;b(),c.options=Object.assign({},a,c.options,k),c.scrollParents={reference:bd(o)?Ym(o):o.contextElement?Ym(o.contextElement):[],popper:Ym(l)};var C=JY(eX([].concat(n,c.options.modifiers)));return c.orderedModifiers=C.filter(function(E){return E.enabled}),y(),g.update()},forceUpdate:function(){if(!m){var N=c.elements,k=N.reference,C=N.popper;if(IT(k,C)){c.rects={reference:XY(k,Ug(C),c.options.strategy==="fixed"),popper:zk(C)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(L){return c.modifiersData[L.name]=Object.assign({},L.data)});for(var E=0;E<c.orderedModifiers.length;E++){if(c.reset===!0){c.reset=!1,E=-1;continue}var P=c.orderedModifiers[E],_=P.fn,A=P.options,I=A===void 0?{}:A,D=P.name;typeof _=="function"&&(c=_({state:c,options:I,name:D,instance:g})||c)}}}},update:ZY(function(){return new Promise(function(w){g.forceUpdate(),w(c)})}),destroy:function(){b(),m=!0}};if(!IT(o,l))return g;g.setOptions(u).then(function(w){!m&&u.onFirstUpdate&&u.onFirstUpdate(w)});function y(){c.orderedModifiers.forEach(function(w){var N=w.name,k=w.options,C=k===void 0?{}:k,E=w.effect;if(typeof E=="function"){var P=E({state:c,name:N,instance:g,options:C}),_=function(){};f.push(P||_)}})}function b(){f.forEach(function(w){return w()}),f=[]}return g}}var rX=[NY,GY,kY,r_,VY,IY,WY,xY,BY],nX=tX({defaultModifiers:rX}),iX="tippy-box",c_="tippy-content",aX="tippy-backdrop",d_="tippy-arrow",f_="tippy-svg-arrow",qc={passive:!0,capture:!0},h_=function(){return document.body};function n2(t,e,r){if(Array.isArray(t)){var n=t[e];return n??(Array.isArray(r)?r[e]:r)}return t}function qk(t,e){var r={}.toString.call(t);return r.indexOf("[object")===0&&r.indexOf(e+"]")>-1}function p_(t,e){return typeof t=="function"?t.apply(void 0,e):t}function LT(t,e){if(e===0)return t;var r;return function(n){clearTimeout(r),r=setTimeout(function(){t(n)},e)}}function sX(t){return t.split(/\s+/).filter(Boolean)}function Gf(t){return[].concat(t)}function BT(t,e){t.indexOf(e)===-1&&t.push(e)}function oX(t){return t.filter(function(e,r){return t.indexOf(e)===r})}function lX(t){return t.split("-")[0]}function ex(t){return[].slice.call(t)}function FT(t){return Object.keys(t).reduce(function(e,r){return t[r]!==void 0&&(e[r]=t[r]),e},{})}function Xm(){return document.createElement("div")}function Vx(t){return["Element","Fragment"].some(function(e){return qk(t,e)})}function uX(t){return qk(t,"NodeList")}function cX(t){return qk(t,"MouseEvent")}function dX(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function fX(t){return Vx(t)?[t]:uX(t)?ex(t):Array.isArray(t)?t:ex(document.querySelectorAll(t))}function i2(t,e){t.forEach(function(r){r&&(r.style.transitionDuration=e+"ms")})}function zT(t,e){t.forEach(function(r){r&&r.setAttribute("data-state",e)})}function hX(t){var e,r=Gf(t),n=r[0];return n!=null&&(e=n.ownerDocument)!=null&&e.body?n.ownerDocument:document}function pX(t,e){var r=e.clientX,n=e.clientY;return t.every(function(i){var a=i.popperRect,s=i.popperState,o=i.props,l=o.interactiveBorder,u=lX(s.placement),c=s.modifiersData.offset;if(!c)return!0;var f=u==="bottom"?c.top.y:0,m=u==="top"?c.bottom.y:0,g=u==="right"?c.left.x:0,y=u==="left"?c.right.x:0,b=a.top-n+f>l,w=n-a.bottom-m>l,N=a.left-r+g>l,k=r-a.right-y>l;return b||w||N||k})}function a2(t,e,r){var n=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[n](i,r)})}function VT(t,e){for(var r=e;r;){var n;if(t.contains(r))return!0;r=r.getRootNode==null||(n=r.getRootNode())==null?void 0:n.host}return!1}var yo={isTouch:!1},UT=0;function mX(){yo.isTouch||(yo.isTouch=!0,window.performance&&document.addEventListener("mousemove",m_))}function m_(){var t=performance.now();t-UT<20&&(yo.isTouch=!1,document.removeEventListener("mousemove",m_)),UT=t}function gX(){var t=document.activeElement;if(dX(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function vX(){document.addEventListener("touchstart",mX,qc),window.addEventListener("blur",gX)}var yX=typeof window<"u"&&typeof document<"u",xX=yX?!!window.msCrypto:!1,bX={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},wX={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Ls=Object.assign({appendTo:h_,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},bX,wX),SX=Object.keys(Ls),kX=function(e){var r=Object.keys(e);r.forEach(function(n){Ls[n]=e[n]})};function g_(t){var e=t.plugins||[],r=e.reduce(function(n,i){var a=i.name,s=i.defaultValue;if(a){var o;n[a]=t[a]!==void 0?t[a]:(o=Ls[a])!=null?o:s}return n},{});return Object.assign({},t,r)}function CX(t,e){var r=e?Object.keys(g_(Object.assign({},Ls,{plugins:e}))):SX,n=r.reduce(function(i,a){var s=(t.getAttribute("data-tippy-"+a)||"").trim();if(!s)return i;if(a==="content")i[a]=s;else try{i[a]=JSON.parse(s)}catch{i[a]=s}return i},{});return n}function GT(t,e){var r=Object.assign({},e,{content:p_(e.content,[t])},e.ignoreAttributes?{}:CX(t,e.plugins));return r.aria=Object.assign({},Ls.aria,r.aria),r.aria={expanded:r.aria.expanded==="auto"?e.interactive:r.aria.expanded,content:r.aria.content==="auto"?e.interactive?null:"describedby":r.aria.content},r}var NX=function(){return"innerHTML"};function hS(t,e){t[NX()]=e}function HT(t){var e=Xm();return t===!0?e.className=d_:(e.className=f_,Vx(t)?e.appendChild(t):hS(e,t)),e}function qT(t,e){Vx(e.content)?(hS(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?hS(t,e.content):t.textContent=e.content)}function pS(t){var e=t.firstElementChild,r=ex(e.children);return{box:e,content:r.find(function(n){return n.classList.contains(c_)}),arrow:r.find(function(n){return n.classList.contains(d_)||n.classList.contains(f_)}),backdrop:r.find(function(n){return n.classList.contains(aX)})}}function v_(t){var e=Xm(),r=Xm();r.className=iX,r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1");var n=Xm();n.className=c_,n.setAttribute("data-state","hidden"),qT(n,t.props),e.appendChild(r),r.appendChild(n),i(t.props,t.props);function i(a,s){var o=pS(e),l=o.box,u=o.content,c=o.arrow;s.theme?l.setAttribute("data-theme",s.theme):l.removeAttribute("data-theme"),typeof s.animation=="string"?l.setAttribute("data-animation",s.animation):l.removeAttribute("data-animation"),s.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?l.setAttribute("role",s.role):l.removeAttribute("role"),(a.content!==s.content||a.allowHTML!==s.allowHTML)&&qT(u,t.props),s.arrow?c?a.arrow!==s.arrow&&(l.removeChild(c),l.appendChild(HT(s.arrow))):l.appendChild(HT(s.arrow)):c&&l.removeChild(c)}return{popper:e,onUpdate:i}}v_.$$tippy=!0;var EX=1,T0=[],s2=[];function TX(t,e){var r=GT(t,Object.assign({},Ls,g_(FT(e)))),n,i,a,s=!1,o=!1,l=!1,u=!1,c,f,m,g=[],y=LT(Te,r.interactiveDebounce),b,w=EX++,N=null,k=oX(r.plugins),C={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},E={id:w,reference:t,popper:Xm(),popperInstance:N,props:r,state:C,plugins:k,clearDelayTimeouts:mt,setProps:gt,setContent:bt,show:_t,hide:ot,hideWithInteractivity:Ye,enable:Ge,disable:et,unmount:De,destroy:re};if(!r.render)return E;var P=r.render(E),_=P.popper,A=P.onUpdate;_.setAttribute("data-tippy-root",""),_.id="tippy-"+E.id,E.popper=_,t._tippy=E,_._tippy=E;var I=k.map(function(ue){return ue.fn(E)}),D=t.hasAttribute("aria-expanded");return oe(),Q(),W(),$("onCreate",[E]),r.showOnCreate&&Pe(),_.addEventListener("mouseenter",function(){E.props.interactive&&E.state.isVisible&&E.clearDelayTimeouts()}),_.addEventListener("mouseleave",function(){E.props.interactive&&E.props.trigger.indexOf("mouseenter")>=0&&z().addEventListener("mousemove",y)}),E;function L(){var ue=E.props.touch;return Array.isArray(ue)?ue:[ue,0]}function U(){return L()[0]==="hold"}function H(){var ue;return!!((ue=E.props.render)!=null&&ue.$$tippy)}function M(){return b||t}function z(){var ue=M().parentNode;return ue?hX(ue):document}function O(){return pS(_)}function G(ue){return E.state.isMounted&&!E.state.isVisible||yo.isTouch||c&&c.type==="focus"?0:n2(E.props.delay,ue?0:1,Ls.delay)}function W(ue){ue===void 0&&(ue=!1),_.style.pointerEvents=E.props.interactive&&!ue?"":"none",_.style.zIndex=""+E.props.zIndex}function $(ue,ge,be){if(be===void 0&&(be=!0),I.forEach(function(Le){Le[ue]&&Le[ue].apply(Le,ge)}),be){var Ce;(Ce=E.props)[ue].apply(Ce,ge)}}function X(){var ue=E.props.aria;if(ue.content){var ge="aria-"+ue.content,be=_.id,Ce=Gf(E.props.triggerTarget||t);Ce.forEach(function(Le){var Re=Le.getAttribute(ge);if(E.state.isVisible)Le.setAttribute(ge,Re?Re+" "+be:be);else{var Ze=Re&&Re.replace(be,"").trim();Ze?Le.setAttribute(ge,Ze):Le.removeAttribute(ge)}})}}function Q(){if(!(D||!E.props.aria.expanded)){var ue=Gf(E.props.triggerTarget||t);ue.forEach(function(ge){E.props.interactive?ge.setAttribute("aria-expanded",E.state.isVisible&&ge===M()?"true":"false"):ge.removeAttribute("aria-expanded")})}}function V(){z().removeEventListener("mousemove",y),T0=T0.filter(function(ue){return ue!==y})}function Y(ue){if(!(yo.isTouch&&(l||ue.type==="mousedown"))){var ge=ue.composedPath&&ue.composedPath()[0]||ue.target;if(!(E.props.interactive&&VT(_,ge))){if(Gf(E.props.triggerTarget||t).some(function(be){return VT(be,ge)})){if(yo.isTouch||E.state.isVisible&&E.props.trigger.indexOf("click")>=0)return}else $("onClickOutside",[E,ue]);E.props.hideOnClick===!0&&(E.clearDelayTimeouts(),E.hide(),o=!0,setTimeout(function(){o=!1}),E.state.isMounted||he())}}}function Z(){l=!0}function ie(){l=!1}function ce(){var ue=z();ue.addEventListener("mousedown",Y,!0),ue.addEventListener("touchend",Y,qc),ue.addEventListener("touchstart",ie,qc),ue.addEventListener("touchmove",Z,qc)}function he(){var ue=z();ue.removeEventListener("mousedown",Y,!0),ue.removeEventListener("touchend",Y,qc),ue.removeEventListener("touchstart",ie,qc),ue.removeEventListener("touchmove",Z,qc)}function ee(ue,ge){te(ue,function(){!E.state.isVisible&&_.parentNode&&_.parentNode.contains(_)&&ge()})}function le(ue,ge){te(ue,ge)}function te(ue,ge){var be=O().box;function Ce(Le){Le.target===be&&(a2(be,"remove",Ce),ge())}if(ue===0)return ge();a2(be,"remove",f),a2(be,"add",Ce),f=Ce}function ae(ue,ge,be){be===void 0&&(be=!1);var Ce=Gf(E.props.triggerTarget||t);Ce.forEach(function(Le){Le.addEventListener(ue,ge,be),g.push({node:Le,eventType:ue,handler:ge,options:be})})}function oe(){U()&&(ae("touchstart",pe,{passive:!0}),ae("touchend",Oe,{passive:!0})),sX(E.props.trigger).forEach(function(ue){if(ue!=="manual")switch(ae(ue,pe),ue){case"mouseenter":ae("mouseleave",Oe);break;case"focus":ae(xX?"focusout":"blur",_e);break;case"focusin":ae("focusout",_e);break}})}function fe(){g.forEach(function(ue){var ge=ue.node,be=ue.eventType,Ce=ue.handler,Le=ue.options;ge.removeEventListener(be,Ce,Le)}),g=[]}function pe(ue){var ge,be=!1;if(!(!E.state.isEnabled||Ae(ue)||o)){var Ce=((ge=c)==null?void 0:ge.type)==="focus";c=ue,b=ue.currentTarget,Q(),!E.state.isVisible&&cX(ue)&&T0.forEach(function(Le){return Le(ue)}),ue.type==="click"&&(E.props.trigger.indexOf("mouseenter")<0||s)&&E.props.hideOnClick!==!1&&E.state.isVisible?be=!0:Pe(ue),ue.type==="click"&&(s=!be),be&&!Ce&&Be(ue)}}function Te(ue){var ge=ue.target,be=M().contains(ge)||_.contains(ge);if(!(ue.type==="mousemove"&&be)){var Ce=ye().concat(_).map(function(Le){var Re,Ze=Le._tippy,Je=(Re=Ze.popperInstance)==null?void 0:Re.state;return Je?{popperRect:Le.getBoundingClientRect(),popperState:Je,props:r}:null}).filter(Boolean);pX(Ce,ue)&&(V(),Be(ue))}}function Oe(ue){var ge=Ae(ue)||E.props.trigger.indexOf("click")>=0&&s;if(!ge){if(E.props.interactive){E.hideWithInteractivity(ue);return}Be(ue)}}function _e(ue){E.props.trigger.indexOf("focusin")<0&&ue.target!==M()||E.props.interactive&&ue.relatedTarget&&_.contains(ue.relatedTarget)||Be(ue)}function Ae(ue){return yo.isTouch?U()!==ue.type.indexOf("touch")>=0:!1}function He(){tt();var ue=E.props,ge=ue.popperOptions,be=ue.placement,Ce=ue.offset,Le=ue.getReferenceClientRect,Re=ue.moveTransition,Ze=H()?pS(_).arrow:null,Je=Le?{getBoundingClientRect:Le,contextElement:Le.contextElement||M()}:t,dt={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(it){var jt=it.state;if(H()){var Pt=O(),ar=Pt.box;["placement","reference-hidden","escaped"].forEach(function(Xt){Xt==="placement"?ar.setAttribute("data-placement",jt.placement):jt.attributes.popper["data-popper-"+Xt]?ar.setAttribute("data-"+Xt,""):ar.removeAttribute("data-"+Xt)}),jt.attributes.popper={}}}},Nt=[{name:"offset",options:{offset:Ce}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Re}},dt];H()&&Ze&&Nt.push({name:"arrow",options:{element:Ze,padding:3}}),Nt.push.apply(Nt,ge?.modifiers||[]),E.popperInstance=nX(Je,_,Object.assign({},ge,{placement:be,onFirstUpdate:m,modifiers:Nt}))}function tt(){E.popperInstance&&(E.popperInstance.destroy(),E.popperInstance=null)}function Ie(){var ue=E.props.appendTo,ge,be=M();E.props.interactive&&ue===h_||ue==="parent"?ge=be.parentNode:ge=p_(ue,[be]),ge.contains(_)||ge.appendChild(_),E.state.isMounted=!0,He()}function ye(){return ex(_.querySelectorAll("[data-tippy-root]"))}function Pe(ue){E.clearDelayTimeouts(),ue&&$("onTrigger",[E,ue]),ce();var ge=G(!0),be=L(),Ce=be[0],Le=be[1];yo.isTouch&&Ce==="hold"&&Le&&(ge=Le),ge?n=setTimeout(function(){E.show()},ge):E.show()}function Be(ue){if(E.clearDelayTimeouts(),$("onUntrigger",[E,ue]),!E.state.isVisible){he();return}if(!(E.props.trigger.indexOf("mouseenter")>=0&&E.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(ue.type)>=0&&s)){var ge=G(!1);ge?i=setTimeout(function(){E.state.isVisible&&E.hide()},ge):a=requestAnimationFrame(function(){E.hide()})}}function Ge(){E.state.isEnabled=!0}function et(){E.hide(),E.state.isEnabled=!1}function mt(){clearTimeout(n),clearTimeout(i),cancelAnimationFrame(a)}function gt(ue){if(!E.state.isDestroyed){$("onBeforeUpdate",[E,ue]),fe();var ge=E.props,be=GT(t,Object.assign({},ge,FT(ue),{ignoreAttributes:!0}));E.props=be,oe(),ge.interactiveDebounce!==be.interactiveDebounce&&(V(),y=LT(Te,be.interactiveDebounce)),ge.triggerTarget&&!be.triggerTarget?Gf(ge.triggerTarget).forEach(function(Ce){Ce.removeAttribute("aria-expanded")}):be.triggerTarget&&t.removeAttribute("aria-expanded"),Q(),W(),A&&A(ge,be),E.popperInstance&&(He(),ye().forEach(function(Ce){requestAnimationFrame(Ce._tippy.popperInstance.forceUpdate)})),$("onAfterUpdate",[E,ue])}}function bt(ue){E.setProps({content:ue})}function _t(){var ue=E.state.isVisible,ge=E.state.isDestroyed,be=!E.state.isEnabled,Ce=yo.isTouch&&!E.props.touch,Le=n2(E.props.duration,0,Ls.duration);if(!(ue||ge||be||Ce)&&!M().hasAttribute("disabled")&&($("onShow",[E],!1),E.props.onShow(E)!==!1)){if(E.state.isVisible=!0,H()&&(_.style.visibility="visible"),W(),ce(),E.state.isMounted||(_.style.transition="none"),H()){var Re=O(),Ze=Re.box,Je=Re.content;i2([Ze,Je],0)}m=function(){var Nt;if(!(!E.state.isVisible||u)){if(u=!0,_.offsetHeight,_.style.transition=E.props.moveTransition,H()&&E.props.animation){var Et=O(),it=Et.box,jt=Et.content;i2([it,jt],Le),zT([it,jt],"visible")}X(),Q(),BT(s2,E),(Nt=E.popperInstance)==null||Nt.forceUpdate(),$("onMount",[E]),E.props.animation&&H()&&le(Le,function(){E.state.isShown=!0,$("onShown",[E])})}},Ie()}}function ot(){var ue=!E.state.isVisible,ge=E.state.isDestroyed,be=!E.state.isEnabled,Ce=n2(E.props.duration,1,Ls.duration);if(!(ue||ge||be)&&($("onHide",[E],!1),E.props.onHide(E)!==!1)){if(E.state.isVisible=!1,E.state.isShown=!1,u=!1,s=!1,H()&&(_.style.visibility="hidden"),V(),he(),W(!0),H()){var Le=O(),Re=Le.box,Ze=Le.content;E.props.animation&&(i2([Re,Ze],Ce),zT([Re,Ze],"hidden"))}X(),Q(),E.props.animation?H()&&ee(Ce,E.unmount):E.unmount()}}function Ye(ue){z().addEventListener("mousemove",y),BT(T0,y),y(ue)}function De(){E.state.isVisible&&E.hide(),E.state.isMounted&&(tt(),ye().forEach(function(ue){ue._tippy.unmount()}),_.parentNode&&_.parentNode.removeChild(_),s2=s2.filter(function(ue){return ue!==E}),E.state.isMounted=!1,$("onHidden",[E]))}function re(){E.state.isDestroyed||(E.clearDelayTimeouts(),E.unmount(),fe(),delete t._tippy,E.state.isDestroyed=!0,$("onDestroy",[E]))}}function Gg(t,e){e===void 0&&(e={});var r=Ls.plugins.concat(e.plugins||[]);vX();var n=Object.assign({},e,{plugins:r}),i=fX(t),a=i.reduce(function(s,o){var l=o&&TX(o,n);return l&&s.push(l),s},[]);return Vx(t)?a[0]:a}Gg.defaultProps=Ls;Gg.setDefaultProps=kX;Gg.currentInput=yo;Object.assign({},r_,{effect:function(e){var r=e.state,n={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(r.elements.popper.style,n.popper),r.styles=n,r.elements.arrow&&Object.assign(r.elements.arrow.style,n.arrow)}});Gg.setDefaultProps({render:v_});const jX=se.forwardRef((t,e)=>{const[r,n]=se.useState(0),i=l=>{const u=t.items[l];u&&t.command({id:u.id,label:u.label})},a=()=>{n((r+t.items.length-1)%t.items.length)},s=()=>{n((r+1)%t.items.length)},o=()=>{i(r)};return se.useEffect(()=>n(0),[t.items]),se.useImperativeHandle(e,()=>({onKeyDown:({event:l})=>l.key==="ArrowUp"?(a(),!0):l.key==="ArrowDown"?(s(),!0):l.key==="Enter"?(o(),!0):!1})),h.jsx("div",{className:"items bg-popover border border-border rounded-md shadow-lg overflow-hidden min-w-[200px] p-1",children:t.items.length?t.items.map((l,u)=>h.jsx("button",{className:`flex w-full items-center text-sm px-2 py-1.5 rounded-sm outline-none text-left ${u===r?"bg-accent text-accent-foreground":"text-popover-foreground"}`,onClick:()=>i(u),children:l.label},u)):h.jsx("div",{className:"item text-sm px-2 py-1.5 text-muted-foreground",children:"No result"})})}),PX={items:async({query:t})=>{try{return(await $e.get("/world-bible/entities")).filter(r=>r.nombre.toLowerCase().startsWith(t.toLowerCase())).slice(0,5).map(r=>({id:r.id,label:r.nombre}))}catch(e){return console.error(e),[]}},render:()=>{let t,e;return{onStart:r=>{t=new u$(jX,{props:r,editor:r.editor}),r.clientRect&&(e=Gg("body",{getReferenceClientRect:r.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(r){t.updateProps(r),r.clientRect&&e[0].setProps({getReferenceClientRect:r.clientRect})},onKeyDown(r){return r.event.key==="Escape"?(e[0].hide(),!0):t.ref?.onKeyDown(r)},onExit(){e[0].destroy(),t.destroy()}}}},MX=({content:t,onUpdate:e,editable:r=!0})=>{const n=r$({extensions:[qK,WK.configure({placeholder:"Escribe tu historia aqu... Usa @ para mencionar entidades."}),JK.configure({HTMLAttributes:{class:"mention"},suggestion:PX})],content:t,editable:r,onUpdate:({editor:i})=>{e(i.getHTML())},editorProps:{attributes:{class:"prose prose-invert max-w-none focus:outline-none min-h-[300px] p-4 text-foreground/90 leading-relaxed font-serif text-lg"}}});return se.useEffect(()=>{n&&t!==n.getHTML()&&n.commands.setContent(t)},[t,n]),n?h.jsxs("div",{className:"zen-editor-container w-full h-full overflow-y-auto no-scrollbar bg-card/20 rounded-lg border border-border/50",children:[h.jsx(YW,{editor:n,className:"h-full"}),h.jsx("style",{jsx:!0,global:!0,children:`
        .mention {
          @apply bg-primary/20 text-primary-light font-medium rounded-sm px-1 py-0.5 cursor-pointer hover:bg-primary/30 decoration-clone;
        }
        .tiptap p.is-editor-empty:first-child::before {
          color: #6b7280;
          content: attr(data-placeholder);
          float: left;
          height: 0;
          pointer-events: none;
        }
      `})]}):null},_X=({notebooks:t,loading:e,onSelectNotebook:r,onCreateNotebook:n,onDeleteNotebook:i,onUpdateNotebook:a})=>{const[s,o]=se.useState(!1),[l,u]=se.useState(null),[c,f]=se.useState(null),m=b=>{n(b)},g=()=>{l&&(i(l.id),u(null))},y=b=>{c&&(a(c.id,b,c.descripcion),f(null))};return h.jsxs("div",{className:"p-8 w-full h-full overflow-y-auto",children:[h.jsxs("div",{className:"max-w-7xl mx-auto",children:[h.jsxs("header",{className:"flex justify-between items-center mb-12",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-4xl font-serif text-slate-200 mb-2",children:"Your Notebooks"}),h.jsx("p",{className:"text-slate-500 font-mono text-sm",children:"Select a chronicle to begin writing"})]}),h.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all shadow-lg shadow-indigo-500/20",children:[h.jsx("span",{className:"material-symbols-outlined",children:"add"}),h.jsx("span",{className:"font-bold tracking-wide text-sm",children:"NEW NOTEBOOK"})]})]}),e?h.jsx("div",{className:"text-slate-500",children:"Loading chronicles..."}):h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.map(b=>h.jsxs("div",{onClick:()=>r(b),className:"group relative bg-[#050508] border border-white/10 rounded-2xl p-6 cursor-pointer hover:border-indigo-500/50 hover:shadow-2xl hover:shadow-indigo-900/10 transition-all duration-300 h-64 flex flex-col",children:[h.jsxs("div",{className:"flex-1 relative",children:[h.jsxs("div",{className:"flex justify-between items-start",children:[h.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/5 flex items-center justify-center text-slate-400 group-hover:bg-indigo-500/10 group-hover:text-indigo-400 transition-colors mb-6",children:h.jsx("span",{className:"material-symbols-outlined text-2xl",children:"menu_book"})}),h.jsxs("div",{className:"flex items-center gap-1 transition-opacity duration-200",children:[h.jsx("button",{onClick:w=>{w.stopPropagation(),f(b)},className:"p-2 text-slate-500 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-all",title:"Rename Notebook",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit"})}),h.jsx("button",{onClick:w=>{w.stopPropagation(),u(b)},className:"p-2 text-slate-500 hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-all",title:"Delete Notebook",children:h.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})})]})]}),h.jsx("h3",{className:"text-xl font-serif text-slate-200 group-hover:text-white mb-2 line-clamp-2",children:b.titulo}),h.jsx("p",{className:"text-slate-500 text-sm line-clamp-3",children:b.descripcion||"No description"})]}),h.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 flex justify-between items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx("span",{className:"text-xs font-mono text-slate-500",children:"OPEN CHRONICLE"}),h.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"arrow_forward"})]})]},b.id)),h.jsxs("button",{onClick:()=>o(!0),className:"border-2 border-dashed border-white/5 rounded-2xl p-6 h-64 flex flex-col items-center justify-center gap-4 text-slate-600 hover:text-slate-400 hover:border-white/10 transition-all",children:[h.jsx("span",{className:"material-symbols-outlined text-4xl",children:"add"}),h.jsx("span",{className:"font-mono text-xs uppercase tracking-widest",children:"Create New"})]})]})]}),h.jsx(R2,{isOpen:s,onClose:()=>o(!1),onConfirm:m,title:"New Notebook",message:"Give a title to your new chronicle.",placeholder:"Ex: The Lost Kingdom",confirmText:"Create Notebook"}),h.jsx(R2,{isOpen:!!c,onClose:()=>f(null),onConfirm:y,title:"Rename Notebook",message:`Enter a new title for "${c?.titulo}".`,placeholder:c?.titulo,confirmText:"Update"}),h.jsx(f6,{isOpen:!!l,onClose:()=>u(null),onConfirm:g,title:"Delete Notebook?",message:`Are you sure you want to delete "${l?.titulo}"? This action cannot be undone and will delete all pages inside.`,confirmText:"Delete Forever",isDestructive:!0})]})},AX=()=>{const{setRightPanelMode:t,setRightOpen:e,setRightPanelTitle:r}=$u(),[n,i]=se.useState("dashboard"),[a,s]=se.useState(null),[o,l]=se.useState([]),[u,c]=se.useState(0),[f,m]=se.useState(!1),g=se.useRef(null),[y,b]=se.useState([]),[w,N]=se.useState(!0),[k,C]=se.useState(null);se.useEffect(()=>{t("NOTES"),E()},[]),se.useEffect(()=>{const $=setInterval(()=>{const X=document.getElementById("architect-right-panel-portal");X&&(C(X),clearInterval($))},100);return()=>clearInterval($)},[n]);const E=async()=>{try{N(!0);const $=await $e.get("/escritura/cuadernos");b($)}catch($){console.error("Error loading notebooks:",$)}finally{N(!1)}},P=async $=>{try{const X=await $e.post("/escritura/cuaderno",{titulo:$});b([...y,X])}catch(X){console.error(X),alert("Error creating notebook")}},_=async $=>{try{await $e.delete(`/escritura/cuaderno/${$}`),b(y.filter(X=>X.id!==$))}catch(X){console.error(X),alert("Error deleting notebook")}},A=async($,X,Q)=>{try{const V=await $e.put(`/escritura/cuaderno/${$}`,{titulo:X,descripcion:Q});b(y.map(Y=>Y.id===$?V:Y))}catch(V){console.error(V),alert("Error updating notebook")}},I=async $=>{s($),await L($.id),i("editor")},D=()=>{i("dashboard"),s(null),l([])},L=async $=>{try{const X=await $e.get(`/escritura/cuaderno/${$}/hojas`);if(X&&X.length>0)l(X),c(0);else{const Q=await $e.post(`/escritura/cuaderno/${$}/hoja`,{});l([Q]),c(0)}}catch(X){console.error("Error loading pages:",X),l([])}},U=$=>{if(!o[u])return;const X=[...o];X[u].contenido=$,l(X),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{H(X[u])},1500)},H=async $=>{m(!0);try{await $e.put(`/escritura/hoja/${$.id}`,{contenido:$.contenido})}catch(X){console.error("Error saving page:",X)}finally{m(!1)}},M=async()=>{if(a)try{const $=await $e.post(`/escritura/cuaderno/${a.id}/hoja`,{});l([...o,$]),c(o.length)}catch($){console.error("Error creating page:",$)}},z=$=>{c($)},O=()=>h.jsxs("div",{className:"flex flex-col h-full bg-[#08080A]",children:[h.jsxs("div",{className:"h-12 border-b border-white/5 flex items-center px-4 font-mono text-[10px] uppercase tracking-widest text-slate-500 whitespace-nowrap overflow-hidden text-ellipsis",children:["Library  ",y.length," Notebooks"]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:y.map($=>h.jsx("button",{onClick:()=>I($),className:"w-full text-left p-3 rounded-lg border-b border-white/5 hover:bg-white/5 transition-all group",children:h.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[h.jsx("div",{className:"text-slate-500 group-hover:text-indigo-400 transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-lg",children:"book"})}),h.jsx("span",{className:"font-serif font-bold text-sm text-slate-300 group-hover:text-white truncate",children:$.titulo})]})},$.id))})]}),G=()=>h.jsxs("div",{className:"flex flex-col h-full bg-[#08080A]",children:[h.jsxs("div",{className:"h-12 border-b border-white/5 flex items-center px-4 font-mono text-[10px] uppercase tracking-widest text-slate-500 whitespace-nowrap overflow-hidden text-ellipsis",children:["Index  ",o.length," Pages"]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:o.map(($,X)=>h.jsxs("button",{onClick:()=>z(X),className:`w-full text-left p-3 rounded-lg border transition-all group ${X===u?"bg-indigo-500/10 border-indigo-500/30 text-indigo-200":"bg-transparent border-transparent hover:bg-white/5 text-slate-400"}`,children:[h.jsxs("div",{className:"flex justify-between items-center mb-1",children:[h.jsxs("span",{className:"font-serif font-bold text-sm truncate",children:["Page ",$.numeroPagina]}),X===u&&h.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 shrink-0 ml-2"})]}),h.jsx("p",{className:"text-[10px] line-clamp-2 opacity-50 font-mono break-words",children:$.contenido?.replace(/<[^>]+>/g,"").substring(0,50)||"Empty page..."})]},$.id))}),h.jsx("div",{className:"p-4 border-t border-white/5",children:h.jsxs("button",{onClick:M,className:"w-full py-2 bg-white/5 hover:bg-white/10 border border-white/5 rounded-lg text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[h.jsx("span",{className:"material-symbols-outlined text-base",children:"add"}),h.jsx("span",{children:"New Page"})]})})]}),W=o[u];return n==="dashboard"?h.jsxs(h.Fragment,{children:[k&&hl.createPortal(O(),k),h.jsx(_X,{notebooks:y,loading:w,onSelectNotebook:I,onCreateNotebook:P,onDeleteNotebook:_,onUpdateNotebook:A})]}):h.jsxs("div",{className:"flex-1 flex w-full h-full bg-[#050508] relative overflow-hidden",children:[k&&hl.createPortal(G(),k),h.jsxs("div",{className:"flex-1 flex flex-col relative z-10 transition-all duration-300",children:[h.jsxs("header",{className:"h-12 border-b border-white/5 bg-surface-dark/40 backdrop-blur-md flex items-center justify-between px-6 select-none",children:[h.jsxs("div",{className:"flex items-center gap-4 text-xs font-serif text-slate-400",children:[h.jsxs("button",{onClick:D,className:"hover:text-white transition-colors flex items-center gap-1",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"}),"Dashboard"]}),h.jsx("span",{className:"opacity-20",children:"|"}),h.jsx("span",{className:"text-slate-300 font-bold tracking-wide",children:a?.titulo}),h.jsx("span",{className:"opacity-20",children:"|"}),h.jsx("span",{children:new Date().toLocaleDateString()})]}),h.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-slate-500",children:[h.jsx("span",{children:a?.nombreProyecto||"Workspace"}),h.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${f?"bg-amber-500 animate-pulse":"bg-emerald-500/50"}`})]})]}),h.jsx("main",{className:"flex-1 overflow-y-auto custom-scrollbar flex justify-center bg-[#101012] relative",children:W&&h.jsxs("div",{className:"w-full max-w-3xl py-12 px-8 min-h-full flex flex-col",children:[h.jsx("input",{type:"text",placeholder:"Untitled Page",className:"w-full bg-transparent text-4xl font-serif font-bold text-slate-200 placeholder:text-slate-700 border-none outline-none mb-8 text-center",defaultValue:`Page ${W.numeroPagina}`,readOnly:!0}),h.jsx("div",{className:"flex-1 bg-white/5 border border-white/5 rounded-sm shadow-2xl shadow-black/50 overflow-hidden relative",children:h.jsx(MX,{content:W.contenido,onUpdate:U})})]})})]})]})};function RX(){const{id:t}=Ua();Na();const[e,r]=se.useState([]),[n,i]=se.useState(!0),[a,s]=se.useState(null);se.useEffect(()=>{o()},[t]);const o=async()=>{try{i(!0);const c=await $e.get("/api/papelera/items");r(c),s(null)}catch(c){console.error("Error loading trash:",c),s("Failed to load trash items.")}finally{i(!1)}},l=async(c,f)=>{try{await $e.post(`/api/papelera/restaurar/${c}/${f}`),o()}catch(m){console.error("Restoration failed",m)}},u=async(c,f)=>{if(window.confirm("Are you sure you want to PERMANENTLY delete this item? This cannot be undone."))try{await $e.delete(`/api/papelera/eliminar/${c}/${f}`),o()}catch(m){console.error("Deletion failed",m)}};return n?h.jsx("div",{className:"text-white p-8",children:"Loading Trash Bin..."}):h.jsxs("div",{className:"flex flex-col h-full bg-[#09090b] text-white p-8 overflow-y-auto",children:[h.jsx("h1",{className:"text-3xl font-light mb-2 text-white/90",children:"Trash Bin"}),h.jsx("p",{className:"text-white/50 mb-8 font-light text-sm",children:"Items are automatically deleted after 30 days."}),a&&h.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 p-4 rounded mb-6",children:a}),e.length===0?h.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-50 border border-dashed border-white/10 rounded-xl",children:[h.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"delete_outline"}),h.jsx("p",{children:"Trash is empty"})]}):h.jsx("div",{className:"bg-zinc-900/50 rounded-xl border border-white/5 overflow-hidden",children:h.jsxs("table",{className:"w-full text-left border-collapse",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"border-b border-white/5 text-xs text-white/40 uppercase tracking-wider",children:[h.jsx("th",{className:"p-4 font-normal",children:"Name"}),h.jsx("th",{className:"p-4 font-normal",children:"Type"}),h.jsx("th",{className:"p-4 font-normal",children:"Deleted Date"}),h.jsx("th",{className:"p-4 font-normal text-right",children:"Actions"})]})}),h.jsx("tbody",{className:"divide-y divide-white/5",children:e.map(c=>h.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[h.jsx("td",{className:"p-4 text-white/80 font-medium",children:c.nombre||"Untitled"}),h.jsx("td",{className:"p-4 text-white/50 text-sm",children:c.tipo}),h.jsx("td",{className:"p-4 text-white/50 text-sm font-mono",children:c.deleted_date?new Date(c.deleted_date).toLocaleDateString():"-"}),h.jsxs("td",{className:"p-4 text-right space-x-2",children:[h.jsx("button",{onClick:()=>l(c.tipo,c.id),className:"px-3 py-1.5 text-xs bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20 rounded-md transition-colors border border-emerald-500/20",children:"RESTORE"}),h.jsx("button",{onClick:()=>u(c.tipo,c.id),className:"px-3 py-1.5 text-xs bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-md transition-colors border border-red-500/20",children:"DELETE"})]})]},`${c.tipo}-${c.id}`))})]})})]})}const DX=({attribute:t,value:e,onChange:r,onRemove:n,linkableEntities:i=[]})=>{const a=t.plantilla||t,s=()=>{switch(a.tipo){case"text":return h.jsx("textarea",{className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none resize-none no-scrollbar h-auto min-h-[100px]",value:e||"",onChange:m=>r(m.target.value),placeholder:"..."});case"short_text":return h.jsx("input",{type:"text",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none",value:e||"",onChange:m=>r(m.target.value),placeholder:"..."});case"number":return h.jsx("input",{type:"number",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none",value:e||"",onChange:m=>r(m.target.value)});case"boolean":return h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("button",{onClick:()=>r(e==="true"?"false":"true"),className:`size-6 rounded-lg border flex items-center justify-center transition-all ${e==="true"?"bg-primary border-primary text-white":"border-glass-border text-transparent hover:border-primary/50"}`,children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"check"})}),h.jsx("span",{className:"text-xs text-text-muted",children:e==="true"?"Enabled":"Disabled"})]});case"select":let o=[];try{o=(typeof a.metadata=="string"?JSON.parse(a.metadata||"{}"):a.metadata||{}).options||[]}catch{}return h.jsxs("div",{className:"relative",children:[h.jsxs("select",{className:"w-full bg-black/30 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-primary/50 appearance-none cursor-pointer",value:e||"",onChange:m=>r(m.target.value),children:[h.jsx("option",{value:"",children:"Select an option..."}),o.map((m,g)=>h.jsx("option",{value:m,className:"bg-surface-dark text-white p-2",children:m},g))]}),h.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/50",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"unfold_more"})})]});case"multi_select":let l=[];try{l=(typeof a.metadata=="string"?JSON.parse(a.metadata||"{}"):a.metadata||{}).options||[]}catch{}let u=[];try{u=e?JSON.parse(e):[],Array.isArray(u)||(u=[])}catch(m){console.error("Error parsing select values",m)}const c=m=>{const g=u.includes(m)?u.filter(y=>y!==m):[...u,m];r(JSON.stringify(g))};return h.jsxs("div",{className:"bg-black/20 border border-white/5 rounded-xl p-2 space-y-1 max-h-40 overflow-y-auto custom-scrollbar",children:[l.map((m,g)=>h.jsxs("label",{onClick:y=>{y.preventDefault(),c(m)},className:"flex items-center gap-3 p-2 hover:bg-white/5 rounded-lg cursor-pointer group transition-colors",children:[h.jsx("div",{className:`size-4 rounded border flex items-center justify-center transition-all ${u.includes(m)?"bg-primary border-primary":"border-white/10 group-hover:border-white/30"}`,children:u.includes(m)&&h.jsx("span",{className:"material-symbols-outlined text-[10px] text-white",children:"check"})}),h.jsx("span",{className:`text-xs font-medium ${u.includes(m)?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:m})]},g)),l.length===0&&h.jsx("div",{className:"text-xs text-slate-500 p-2 italic",children:"No options defined."})]});case"date":return h.jsx("input",{type:"date",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none [color-scheme:dark]",value:e||"",onChange:m=>r(m.target.value)});case"entity_link":return h.jsxs("div",{className:"relative",children:[h.jsxs("select",{className:"w-full bg-black/30 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-primary/50 appearance-none cursor-pointer",value:e||"",onChange:m=>r(m.target.value),children:[h.jsx("option",{value:"",children:"Select an Entity Link..."}),i.map(m=>h.jsx("option",{value:m.id,className:"bg-surface-dark text-white p-2",children:m.nombre},m.id))]}),h.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/50",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"link"})})]});case"image":return h.jsxs("div",{className:"space-y-2",children:[h.jsx("div",{className:"flex gap-2",children:h.jsx("input",{type:"text",className:"flex-1 bg-black/30 border border-white/5 rounded-xl px-4 py-2 text-xs text-text-muted focus:text-white focus:outline-none",placeholder:"Image URL...",value:e||"",onChange:m=>r(m.target.value)})}),e&&h.jsx("div",{className:"w-full aspect-video rounded-xl bg-black/40 border border-white/5 overflow-hidden relative group",children:h.jsx("img",{src:e,alt:"Preview",className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"})}),!e&&h.jsx("div",{className:"w-full h-20 rounded-xl bg-white/5 border border-dashed border-white/10 flex items-center justify-center text-text-muted/30",children:h.jsx("span",{className:"material-symbols-outlined",children:"image"})})]});case"table":const f=e||"[]";return h.jsxs("div",{className:"space-y-2",children:[h.jsx("textarea",{className:"w-full h-32 bg-black/30 border border-white/5 rounded-xl p-3 text-xs font-mono text-white/70 focus:outline-none focus:border-primary/50",value:f,onChange:m=>r(m.target.value),placeholder:'[{"Item": "Sword", "Qty": 1}, ...]'}),h.jsxs("div",{className:"text-[10px] text-text-muted flex justify-between",children:[h.jsx("span",{children:"JSON Format supported"}),h.jsx("span",{className:"material-symbols-outlined text-xs",children:"data_array"})]})]});default:return h.jsxs("div",{className:"text-sm font-medium text-white/70 italic p-2 rounded-lg bg-white/5 border border-white/5",children:[h.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 mr-2",children:a.tipo}),e]})}};return h.jsxs("div",{className:"p-4 border border-white/5 rounded-2xl bg-surface-dark/50 backdrop-blur-sm relative overflow-hidden h-full flex flex-col group hover:border-primary/20 transition-all",children:[h.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted mb-3 flex items-center justify-between gap-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-xs opacity-50",children:"label"}),a.nombre]}),n&&h.jsx("button",{onClick:o=>{o.preventDefault(),n()},className:"text-white/20 hover:text-red-400 transition-colors",title:"Remove Attribute",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]}),h.jsx("div",{className:"flex-1 nodrag",children:s()}),h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"})]})},OX=[{value:"Individual",label:"Personaje"},{value:"Group",label:"Grupo/Faccin"},{value:"Location",label:"Lugar"},{value:"Item",label:"Objeto"},{value:"Event",label:"Evento"},{value:"Timeline",label:"Lnea de Tiempo"},{value:"Map",label:"Mapa"},{value:"Structure",label:"Construccin"},{value:"Creature",label:"Criatura"},{value:"Plant",label:"Flora"}],IX=({entityId:t,entityType:e})=>{console.log(">>> RELATIONSHIP MANAGER V2 LOADED");const[r,n]=se.useState([]),[i,a]=se.useState(!1),[s,o]=se.useState(!1),[l,u]=se.useState("Individual"),[c,f]=se.useState([]),[m,g]=se.useState(""),[y,b]=se.useState(""),[w,N]=se.useState(""),[k,C]=se.useState(!1);se.useEffect(()=>{t&&E()},[t,e]),se.useEffect(()=>{s&&l&&P(l)},[s,l]);const E=async()=>{a(!0);try{const L=(await $e.get("/bd/relacion")).filter(H=>H.nodoOrigenId===parseInt(t)&&(H.tipoOrigen===e||H.tipoOrigen==="GenericEntity")||H.nodoDestinoId===parseInt(t)&&(H.tipoDestino===e||H.tipoDestino==="GenericEntity")),U=await Promise.all(L.map(async H=>{const M=H.nodoOrigenId===parseInt(t),z=M?H.nodoDestinoId:H.nodoOrigenId,O=await $e.get(`/world-bible/entities/${z}`);if(!O)throw new Error(`Entity ${z} not found`);return{...H,otherName:O.nombre,otherType:O.categoria||"Entity",isOutgoing:M}}));n(U)}catch(D){console.error("Failed to load relationships",D)}finally{a(!1)}},P=async D=>{C(!0);try{const U=(await $e.get("/world-bible/entities")).filter(H=>(H.categoria||"Generic").toLowerCase()===D.toLowerCase()||H.tipoEspecial&&H.tipoEspecial.toLowerCase()===D.toLowerCase());f(U||[])}catch(L){console.error("Failed to fetch targets",L),f([])}finally{C(!1)}},_=async()=>{if(!(!m||!y))try{const D={nodoOrigenId:parseInt(t),tipoOrigen:e,nodoDestinoId:parseInt(m),tipoDestino:"GenericEntity",tipoRelacion:y,descripcion:w,metadata:JSON.stringify({originalCategory:l}),tipoEntidad:"relacion"};await $e.put("/bd/insertar",D),o(!1),I(),E()}catch(D){console.error("Failed to save relationship",D),alert("Error saving relationship")}},A=async D=>{if(confirm("Are you sure?"))try{await $e.delete(`/bd/relacion/${D}`),E()}catch(L){console.error("Failed to delete",L)}},I=()=>{u("Individual"),g(""),b(""),N("")};return h.jsxs("div",{className:"p-6 space-y-6",children:[h.jsxs("header",{className:"flex justify-between items-center",children:[h.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-widest",children:"Relationships"}),h.jsx(yr,{variant:"secondary",icon:"add_link",onClick:()=>o(!s),children:s?"Cancel":"Connect"})]}),s&&h.jsxs("div",{className:"p-4 rounded-2xl bg-white/5 border border-white/10 space-y-4 animate-in fade-in slide-in-from-top-4",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Target Type"}),h.jsx("select",{className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:l,onChange:D=>u(D.target.value),children:OX.map(D=>h.jsx("option",{value:D.value,children:D.label},D.value))})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Target Entity"}),h.jsxs("select",{className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:m,onChange:D=>g(D.target.value),disabled:k,children:[h.jsx("option",{value:"",children:"Select Target..."}),c.map(D=>h.jsx("option",{value:D.id,children:D.nombre},D.id))]})]})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Relationship Type"}),h.jsx("input",{type:"text",placeholder:"e.g. Father of, Located in, Enemy of...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:y,onChange:D=>b(D.target.value)})]}),h.jsxs("div",{className:"space-y-1",children:[h.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Description (The Why)"}),h.jsx("textarea",{placeholder:"Explain the nature of this connection...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary h-20 resize-none",value:w,onChange:D=>N(D.target.value)})]}),h.jsx("div",{className:"flex justify-end pt-2",children:h.jsx(yr,{variant:"primary",icon:"save",onClick:_,disabled:!m||!y,children:"Save Connection"})})]}),h.jsx("div",{className:"space-y-3",children:i?h.jsx("div",{className:"text-center text-slate-500 py-8",children:"Scanning connections..."}):r.length===0?h.jsx("div",{className:"text-center text-slate-500 py-8 italic border border-dashed border-white/10 rounded-2xl",children:"No connections established"}):r.map((D,L)=>h.jsxs("div",{className:"group relative p-4 rounded-2xl bg-surface-dark border border-white/5 hover:border-primary/50 transition-all flex items-start gap-4",children:[h.jsx("div",{className:"mt-1",children:h.jsx("span",{className:"material-symbols-outlined text-slate-500",children:D.isOutgoing?"arrow_outward":"arrow_inward"})}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:D.isOutgoing?"To:":"From:"}),h.jsx("span",{className:"text-sm font-bold text-white",children:D.otherName}),h.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-white/10 text-slate-400 font-bold uppercase tracking-wider",children:D.otherType})]}),h.jsx("div",{className:"text-primary text-xs font-black uppercase tracking-widest mb-2",children:D.tipoRelacion}),D.descripcion&&h.jsxs("p",{className:"text-xs text-slate-400 leading-relaxed bg-black/20 p-2 rounded-lg border border-white/5",children:['"',D.descripcion,'"']})]}),h.jsx("button",{onClick:()=>A(D.id),className:"opacity-0 group-hover:opacity-100 p-2 text-slate-600 hover:text-red-400 transition-all",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},D.id||L))})]})},Em=({mode:t})=>{const{username:e,projectName:r,entitySlug:n,folderSlug:i,type:a}=Ua(),s=Na(),o=t==="creation",{setRightOpen:l,setAvailableTemplates:u,setRightPanelMode:c,setAddAttributeHandler:f,setEntityTabs:m,activeEntityTab:g,setActiveEntityTab:y}=$u(),[b,w]=se.useState({nombre:"",tipo:"entidadindividual",descripcion:"",color:"#6366f1",apariencia:"",notas:"",iconUrl:null,tipoEspecial:a||null,carpeta:null,categoria:"Individual"}),[N,k]=se.useState([]),[C,E]=se.useState(!0),[P,_]=se.useState(!1),[A,I]=se.useState([]),[D,L]=se.useState([]),[U,H]=se.useState(!1);se.useEffect(()=>(l(!0),c("ENTITY"),m(["identity","narrative","attributes"]),y("identity"),()=>{c("NOTES"),m([])}),[]),se.useEffect(()=>{o?z():O()},[n,i,o]);const M=V=>{u(V),L(V),f(Y=>{const Z=V.find(ie=>ie.id===Y);Z&&k(ie=>[...ie,{id:`temp-${Z.id}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,attribute:Z,value:Z.valorDefecto||"",isTemp:!0}])})},z=async()=>{E(!0);try{const V=await $e.get(`/world-bible/folders/${i}`),Y=await $e.get(`/world-bible/folders/${i}/templates`);M(Y),w(ie=>({...ie,nombre:`Nuevo ${a==="map"?"Mapa":a==="timeline"?"Cronograma":"Ente"}`,carpeta:V,tipoEspecial:a||"entidadindividual",tipo:a||"entidadindividual"}));const Z=Y.filter(ie=>ie.esObligatorio).map(ie=>({id:`temp-${ie.id}-${Math.random().toString(36).substr(2,9)}`,attribute:ie,value:ie.valorDefecto||"",isTemp:!0}));k(Z)}catch(V){console.error("Error creating draft:",V)}finally{E(!1)}},O=async()=>{E(!0);try{const V=await $e.get(`/world-bible/entities/${n}`);if(w({...V,apariencia:V.apariencia||"",notas:V.notas||"",iconUrl:V.iconUrl||null,tags:V.tags||"",tipo:V.tipoEspecial||getHierarchyType(V.tipo).id,color:V.color||"#6366f1",categoria:V.categoria||"Individual",attributes:V.attributes||{}}),V.carpeta?.id){const Z=await $e.get(`/world-bible/folders/${V.carpeta.id}/templates`);M(Z)}const Y=(V.valores||[]).filter(Z=>Z.plantilla).map(Z=>({id:Z.id.toString(),attribute:Z.plantilla,value:Z.valor,isTemp:!1}));k(Y)}catch(V){console.error("Error loading entity:",V)}finally{E(!1)}},G=(V,Y)=>{w(Z=>({...Z,[V]:Y}))},W=V=>{const Y=V.target.files[0];if(Y){const Z=new FileReader;Z.onloadend=()=>{G("iconUrl",Z.result)},Z.readAsDataURL(Y)}},$=(V,Y)=>{k(Z=>Z.map(ie=>ie.id===V?{...ie,value:Y}:ie))},X=V=>{V.toString().startsWith("temp-")||I(Y=>[...Y,V]),k(Y=>Y.filter(Z=>Z.id!==V))},Q=async(V=!0)=>{_(!0);try{const Y={nombre:b.nombre,descripcion:b.descripcion,tags:b.tags,apariencia:b.apariencia,notas:b.notas,iconUrl:b.iconUrl,tipoEspecial:b.tipoEspecial||"entidadindividual",color:b.color,categoria:b.categoria,attributes:b.attributes};let Z=b.id;if(o){if(!b.carpeta&&!i){alert("Error: Missing context (no folder). Redirecting."),s(`/${e}/${r}/bible`);return}if(Y.carpetaId=b.carpeta?.id,!Y.carpetaId&&i)try{const te=await $e.get(`/world-bible/folders/${i}`);Y.carpetaId=te.id}catch(te){console.error("Could not resolve folder",te)}const ee=await $e.post("/world-bible/entities",Y);Z=ee.id;const le=[...N];for(let te=0;te<le.length;te++){const ae=le[te];if(ae.isTemp)try{const oe=await $e.post(`/world-bible/entities/${ee.id}/attributes`,{plantillaId:ae.attribute.id});await $e.patch(`/world-bible/entities/${ee.id}/values`,[{valorId:oe.id,nuevoValor:ae.value}]),le[te]={...ae,id:oe.id.toString(),isTemp:!1}}catch(oe){console.error("Attr save failed",oe)}}if(k(le),_(!1),V){const te=ee.carpeta?ee.carpeta.slug||ee.carpeta.id:i;s(`/${e}/${r}/bible/folder/${te}`)}else{const te=ee.carpeta?ee.carpeta.slug||ee.carpeta.id:i;s(`/${e}/${r}/bible/folder/${te}/entity/${ee.slug||ee.id}`,{replace:!0})}return}await $e.put(`/world-bible/entities/${Z}`,{nombre:Y.nombre,color:Y.color,iconUrl:Y.iconUrl}),await $e.patch(`/world-bible/entities/${Z}/details`,{descripcion:Y.descripcion,tags:Y.tags,apariencia:Y.apariencia,notas:Y.notas,iconUrl:Y.iconUrl,attributes:Y.attributes}),A.length>0&&(await Promise.all(A.map(ee=>$e.delete(`/world-bible/values/${ee}`))),I([]));const ie=N.filter(ee=>!ee.isTemp).map(ee=>({valorId:parseInt(ee.id),nuevoValor:ee.value}));ie.length>0&&await $e.patch(`/world-bible/entities/${Z}/values`,ie);let ce=!1;const he=[...N];for(let ee=0;ee<he.length;ee++){const le=he[ee];if(le.isTemp)try{const te=await $e.post(`/world-bible/entities/${Z}/attributes`,{plantillaId:le.attribute.id});await $e.patch(`/world-bible/entities/${Z}/values`,[{valorId:te.id,nuevoValor:le.value}]),he[ee]={...le,id:te.id.toString(),isTemp:!1},ce=!0}catch(te){console.error("Error saving field:",le,te)}}if(ce&&k(he),_(!1),V){const le=i||(b.carpeta?b.carpeta.slug||b.carpeta.id:"root")||"root";s(`/${e}/${r}/bible/folder/${le}`)}}catch(Y){console.error("Save error",Y),_(!1)}};return C?h.jsx("div",{className:"p-20 text-center animate-pulse",children:"Loading Builder..."}):h.jsx("div",{className:"flex h-full w-full bg-background-dark overflow-hidden",children:h.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-y-auto custom-scrollbar relative",children:[h.jsxs("div",{className:"border-b border-white/5 p-4 flex justify-between items-center bg-background-dark/80 backdrop-blur sticky top-0 z-30",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx(K0,{url:b.iconUrl,name:b.nombre,className:"size-10 rounded-lg border border-white/10"}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-lg font-bold text-white leading-tight",children:b.nombre||"Sin Nombre"}),h.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest text-slate-500",children:o?"Creando Nueva Entidad":"Editando Entidad"})]})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("button",{onClick:()=>s(`/${e}/${r}/bible/folder/${i}`),className:"px-4 py-2 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 text-xs font-bold uppercase tracking-widest transition-all",children:"Cancelar"}),h.jsxs("div",{className:"flex bg-white/5 rounded-xl p-1 gap-1 border border-white/10",children:[h.jsxs("button",{onClick:()=>Q(!0),disabled:P,className:"h-9 px-4 rounded-lg bg-primary hover:bg-primary-light text-white text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 disabled:opacity-50",children:[P?h.jsx("span",{className:"material-symbols-outlined animate-spin text-sm",children:"refresh"}):h.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar"]}),h.jsx("div",{className:"w-px bg-white/10 my-1"}),h.jsx("button",{onClick:()=>Q(!1),disabled:P,className:"h-9 px-3 rounded-lg bg-transparent hover:bg-white/10 text-white transition-all flex items-center justify-center disabled:opacity-50",title:"Guardar y Seguir Editando",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit_document"})})]})]})]}),h.jsxs("div",{className:"p-8 pb-32 max-w-5xl mx-auto w-full",children:[g==="identity"&&h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[h.jsxs(ir,{className:`p-6 space-y-6 ${b.tipoEspecial==="map"?"lg:col-span-2":""}`,children:[h.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"badge"})," Identity"]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Full Name"}),h.jsx("input",{value:b.nombre,onChange:V=>G("nombre",V.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none transition-colors",placeholder:"E.g. King Alaric"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Entity Type / Category"}),h.jsxs("select",{value:b.categoria||"Individual",onChange:V=>G("categoria",V.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none transition-colors appearance-none",children:[h.jsx("option",{value:"Individual",children:"Individual (Character/Person)"}),h.jsx("option",{value:"Group",children:"Group / Faction"}),h.jsx("option",{value:"Location",children:"Location"}),h.jsx("option",{value:"Event",children:"Event"}),h.jsx("option",{value:"Object",children:"Object / Item"}),h.jsx("option",{value:"Concept",children:"Concept / Magic"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Tags (comma separated)"}),h.jsx("input",{value:b.tags,onChange:V=>G("tags",V.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-slate-300 focus:border-primary/50 outline-none transition-colors",placeholder:"Warrior, Leader, Human..."})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Icon / Portrait"}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx(K0,{url:b.iconUrl,name:b.nombre,size:"lg",className:"rounded-xl"}),h.jsxs("label",{className:"cursor-pointer px-4 py-2 bg-white/5 hover:bg-white/10 rounded-lg border border-white/10 text-xs font-bold text-slate-300 transition-colors",children:["Upload Image",h.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:W})]}),b.iconUrl&&h.jsx("button",{onClick:()=>G("iconUrl",""),className:"p-2 hover:text-red-400 transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]})]})]}),b.tipoEspecial!=="map"&&h.jsxs(ir,{className:"p-6 space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"palette"})," Appearance"]}),h.jsx("div",{className:"flex gap-2",children:h.jsxs("label",{className:"cursor-pointer text-[10px] font-bold uppercase tracking-wider text-slate-500 hover:text-white transition-colors flex items-center gap-1",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"add_photo_alternate"}),"Insert Image",h.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:V=>{const Y=V.target.files[0];if(Y){const Z=new FileReader;Z.onloadend=()=>{const ie=`

![${Y.name}](${Z.result})
`;G("apariencia",(b.apariencia||"")+ie)},Z.readAsDataURL(Y)}}})]})})]}),h.jsx("textarea",{value:b.apariencia,onChange:V=>G("apariencia",V.target.value),className:"w-full h-80 bg-black/30 border border-white/10 rounded-xl p-4 text-sm text-slate-300 leading-relaxed focus:border-primary/50 outline-none transition-colors custom-scrollbar font-mono",placeholder:"Describe their physical appearance, clothing, distinct marks... (Markdown Supported)"})]}),b.tipoEspecial==="map"&&h.jsxs(ir,{className:"p-6 lg:col-span-2 space-y-6",children:[h.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Cartography"]}),h.jsx("div",{onClick:()=>{H(!0)},className:"w-full aspect-[21/9] bg-black/30 border border-white/10 rounded-xl overflow-hidden cursor-pointer group relative",children:(()=>{let V=b.attributes?.snapshotUrl||b.attributes?.bgImage||b.iconUrl;if(!V)try{const Y=JSON.parse(b.descripcion||"{}");Y.snapshotUrl&&(V=Y.snapshotUrl)}catch{}return V?h.jsxs(h.Fragment,{children:[h.jsx("img",{src:V,alt:"Map Preview",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),h.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:h.jsx("span",{className:"material-symbols-outlined text-white text-3xl",children:"zoom_in"})})]}):h.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-xs italic",children:"No map preview available"})})()}),h.jsx("div",{className:"flex justify-end",children:h.jsx(yr,{variant:"secondary",size:"sm",icon:"edit",onClick:()=>window.open(`/${e}/${r}/map-editor/edit/${b.id}`,"_self"),children:"Open Editor"})})]}),b.tipoEspecial!=="map"&&h.jsxs(ir,{className:"p-6 lg:col-span-2",children:[h.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"sticky_note_2"})," Quick Notes"]}),h.jsx("textarea",{className:"w-full h-40 bg-black/30 border border-white/10 rounded-xl p-4 text-sm text-slate-300 leading-relaxed resize-none focus:border-primary/50 outline-none transition-colors custom-scrollbar font-mono placeholder:text-slate-600",placeholder:"Quick notes about this entity...",value:b.notas||"",onChange:V=>G("notas",V.target.value)})]})]}),g==="narrative"&&h.jsxs("div",{className:"animate-in fade-in duration-500 space-y-8",children:[h.jsxs(ir,{className:"min-h-[40vh] flex flex-col p-8",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"history_edu"})," Biography"]}),h.jsx("span",{className:"text-[10px] text-slate-500 bg-white/5 px-2 py-1 rounded",children:"Markdown Supported"})]}),h.jsx("textarea",{className:"flex-1 w-full bg-transparent border-none outline-none text-slate-300 leading-relaxed resize-none focus:ring-0 placeholder:text-slate-600 custom-scrollbar text-base min-h-[300px]",placeholder:"Write the origin story...",value:b.descripcion||"",onChange:V=>G("descripcion",V.target.value)})]}),h.jsxs(ir,{className:"min-h-[40vh]",children:[h.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary p-6 pb-0 flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})," Relationships"]}),o?h.jsxs("div",{className:"p-12 text-center text-slate-500",children:[h.jsx("span",{className:"material-symbols-outlined text-4xl mb-4",children:"save_as"}),h.jsx("p",{className:"text-sm font-bold",children:"Please save the entity first to manage relationships."})]}):h.jsx(IX,{entityId:b.id,entityType:b.tipo||"entidadindividual"})]})]}),g==="attributes"&&h.jsxs("div",{className:`animate-in fade-in duration-500 space-y-6 min-h-[50vh] transition-colors rounded-2xl p-4 ${window.isDraggingOver?"bg-primary/10 border-2 border-dashed border-primary":""}`,onDragOver:V=>{V.preventDefault(),V.dataTransfer.dropEffect="copy",V.currentTarget.classList.add("bg-primary/10","border-primary","border-dashed","border-2")},onDragLeave:V=>{V.preventDefault(),V.currentTarget.classList.remove("bg-primary/10","border-primary","border-dashed","border-2")},onDrop:V=>{if(V.preventDefault(),V.currentTarget.classList.remove("bg-primary/10","border-primary","border-dashed","border-2"),V.dataTransfer.getData("application/reactflow/type")!=="attribute")return;let Z=null;try{const ie=V.dataTransfer.getData("templateData");if(ie)Z=JSON.parse(ie);else{const ce=parseInt(V.dataTransfer.getData("templateId"));Z=D.find(he=>he.id===ce)}}catch(ie){console.error("Drop error",ie)}Z&&k(ie=>[...ie,{id:`temp-${Z.id}-${Date.now()}`,attribute:Z,value:Z.valorDefecto||"",isTemp:!0}])},children:[h.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary border-b border-white/5 pb-4 flex items-center justify-between",children:[h.jsx("span",{children:"Atributos especiales"}),h.jsx("span",{className:"text-[10px] text-slate-500 font-normal normal-case opacity-50 hidden md:block",children:"Arraste atributos desde el panel derecho"})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 border-2 border-dashed border-white/5 rounded-2xl hover:border-primary/20 transition-colors bg-white/[0.01]",children:[N.length===0&&h.jsxs("div",{className:"col-span-full py-12 text-center text-slate-500 text-sm pointer-events-none",children:[h.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"drag_indicator"}),h.jsx("p",{children:"Arrastra plantillas aqu para aadir atributos"})]}),N.filter(V=>V.attribute).map(V=>h.jsx(DX,{attribute:V.attribute,value:V.value,onChange:Y=>$(V.id,Y),onRemove:()=>X(V.id)},V.id))]})]})]}),U&&b.iconUrl&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-300",onClick:()=>H(!1),children:h.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] p-2",children:[h.jsx("button",{onClick:()=>H(!1),className:"absolute -top-12 right-0 p-2 text-white hover:text-primary transition-colors",children:h.jsx("span",{className:"material-symbols-outlined text-3xl",children:"close"})}),h.jsx("img",{src:b.iconUrl,alt:b.nombre,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl border border-white/10",onClick:V=>V.stopPropagation()})]})})]})})},LX=t=>{switch(t?.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},mS=({item:t,type:e,linkTo:r,onContextMenu:n,onDelete:i})=>{const a=e==="folder";return h.jsxs(ld,{to:r,onContextMenu:n,className:"group relative flex flex-col p-4 rounded-3xl bg-surface-dark border border-glass-border hover:border-primary/50 hover:bg-white/5 transition-all duration-300 backdrop-blur-sm overflow-hidden",children:[t.iconUrl&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"absolute inset-0 z-0",children:h.jsx("img",{src:t.iconUrl,alt:"",className:"w-full h-full object-cover opacity-60 group-hover:scale-105 transition-transform duration-700"})}),h.jsx("div",{className:"absolute inset-0 z-0 bg-gradient-to-t from-[#0a0a0c] via-[#0a0a0c]/80 to-transparent"})]}),h.jsxs("div",{className:"relative z-10 flex items-start justify-between mb-4",children:[h.jsx("div",{className:`
                    size-12 rounded-2xl flex items-center justify-center text-xl transition-transform group-hover:scale-110 
                    ${a?"bg-primary/20 text-primary":"bg-white/5 text-text-muted group-hover:text-white backdrop-blur-md border border-white/5"}
                `,children:h.jsx("span",{className:"material-symbols-outlined",children:a?"folder":LX(t.tipoEspecial)})}),a&&h.jsx("div",{className:"px-2 py-1 rounded-lg bg-surface-light/50 border border-glass-border text-[10px] font-black text-white shadow-sm backdrop-blur-md",children:t.itemCount||0})]}),h.jsxs("div",{className:"relative z-10 mt-auto",children:[h.jsx("h3",{className:"text-sm font-bold text-white truncate group-hover:text-primary transition-colors drop-shadow-md",children:t.nombre}),h.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted mt-1 opacity-70 group-hover:opacity-100 transition-opacity",children:a?"Folder":t.tipoEspecial||"Entity"})]}),h.jsxs("div",{className:"absolute top-4 right-4 z-20 flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[i&&h.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),i(t)},className:"p-1.5 rounded-lg bg-red-500/10 hover:bg-red-500 text-red-500 hover:text-white transition-all border border-red-500/20 shadow-lg shadow-red-500/5 group/del backdrop-blur-md",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})}),h.jsx("span",{className:"material-symbols-outlined text-primary text-sm transform group-hover:translate-x-1 transition-transform drop-shadow-md",children:"arrow_forward"})]})]})},BX=({path:t,currentFolder:e})=>{const{username:r,projectName:n}=Ua(),i=`/${r}/${n}/bible`;return!t&&!e?null:h.jsxs("nav",{className:"flex items-center gap-2 text-[10px] uppercase font-bold tracking-wider text-slate-500 mb-4 overflow-x-auto no-scrollbar whitespace-nowrap",children:[h.jsxs(ld,{to:i,className:"hover:text-primary transition-colors flex items-center gap-1",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"home"}),"Bible"]}),t&&t.map((a,s)=>h.jsxs(Kt.Fragment,{children:[h.jsx("span",{className:"text-slate-700",children:"/"}),h.jsx(ld,{to:`${i}/folder/${a.slug||a.id}`,className:"hover:text-primary transition-colors",children:a.nombre})]},a.id)),e&&h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"text-slate-700",children:"/"}),h.jsx("span",{className:"text-white bg-white/5 px-2 py-0.5 rounded",children:e.nombre})]})]})},FX=({entities:t=[],onAddEvent:e})=>{const r=[...t].sort((n,i)=>n.id-i.id);return h.jsx("div",{className:"w-full max-w-3xl mx-auto p-4 animate-slide-up",children:h.jsxs("div",{className:"relative border-l-2 border-white/10 ml-6 space-y-12 py-8",children:[r.length===0&&h.jsx("div",{className:"pl-12 opacity-50",children:h.jsx("p",{className:"text-white text-sm",children:"No events recorded in this timeline yet."})}),r.map((n,i)=>h.jsxs("div",{className:"relative pl-12 group",children:[h.jsx("div",{className:"absolute left-[-9px] top-0 size-4 rounded-full bg-background-dark border-2 border-primary group-hover:scale-125 group-hover:bg-primary transition-all shadow-[0_0_10px_rgba(99,102,241,0.3)]"}),h.jsxs(ir,{className:"p-6 border-white/5 hover:border-primary/30 transition-all hover:-translate-y-1 cursor-pointer",children:[h.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n.nombre}),h.jsx("p",{className:"text-sm text-text-muted leading-relaxed line-clamp-3",children:n.descripcion||"No description provided."})]})]},n.id)),h.jsxs("div",{onClick:e,className:"relative pl-12 group cursor-pointer opacity-50 hover:opacity-100 transition-opacity",children:[h.jsx("div",{className:"absolute left-[-9px] top-2 size-4 rounded-full bg-background-dark border-2 border-dashed border-white/30"}),h.jsxs("div",{className:"p-4 border-2 border-dashed border-white/10 rounded-2xl flex items-center justify-center text-text-muted hover:border-primary/50 hover:text-white transition-all",children:[h.jsx("span",{className:"material-symbols-outlined mr-2",children:"add_circle"}),h.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Add Historical Event"})]})]})]})})},ed={UNIVERSE:{id:"UNIVERSE",label:"Universo / Multiverso",description:"Contenedor supremo de realidades.",icon:"public",color:"text-purple-400",bgColor:"bg-purple-900/20"},GALAXY:{id:"GALAXY",label:"Galaxia",description:"Agrupacin masiva de sistemas estelares.",icon:"auto_awesome",color:"text-indigo-400",bgColor:"bg-indigo-900/20"},SYSTEM:{id:"SYSTEM",label:"Sistema Solar",description:"Estrella central y sus cuerpos orbitales.",icon:"wb_sunny",color:"text-yellow-400",bgColor:"bg-yellow-900/20"},PLANET:{id:"PLANET",label:"Planeta / Mundo",description:"Cuerpo celeste o plano de existencia principal.",icon:"public",color:"text-emerald-400",bgColor:"bg-emerald-900/20"},GEOGRAPHY:{id:"GEOGRAPHY",label:"Geografa",icon:"map",color:"text-green-300"},ENTITIES:{id:"ENTITIES",label:"Entidades",icon:"groups",color:"text-blue-300"},MAGIC:{id:"MAGIC",label:"Magia",icon:"auto_fix_high",color:"text-pink-300"},TIMELINE:{id:"TIMELINE",label:"Cronologa",icon:"history",color:"text-orange-300"},FACTIONS:{id:"FACTIONS",label:"Facciones",icon:"security",color:"text-red-300"},ITEMS:{id:"ITEMS",label:"Objetos",icon:"inventory_2",color:"text-gray-300"},FOLDER:{id:"FOLDER",label:"Carpeta",icon:"folder",color:"text-gray-400"}},gS=t=>ed[t]||ed.FOLDER,zX=()=>{const{username:t,projectName:e,folderSlug:r}=Ua(),n=Na(),{handleCreateEntity:i,handleDeleteEntity:a,handleCreateSimpleFolder:s,folderSearchTerm:o,folderFilterType:l}=$u(),[u,c]=se.useState([]),[f,m]=se.useState(null),[g,y]=se.useState([]),[b,w]=se.useState(!0),[N,k]=se.useState(!1),C=u.filter(A=>{const I=A.nombre.toLowerCase().includes(o||""),D=l==="ALL"||l==="MAP"&&A.tipoEspecial==="map"||l==="TIMELINE"&&A.tipoEspecial==="timeline"||l==="ENTITY"&&(!A.tipoEspecial||A.tipoEspecial==="entidadindividual");return I&&D});se.useEffect(()=>{const A=I=>{const{folderId:D,removeId:L,type:U,item:H,expand:M}=I.detail||{};D===(f?.id||r)&&(L?c(z=>z.filter(O=>O.id!==L)):H&&H.slug&&H.slug!==r?n(`/${t}/${e}/bible/folder/${H.slug}`,{replace:!0}):E())};return window.addEventListener("folder-update",A),()=>window.removeEventListener("folder-update",A)},[r,f?.id]),se.useEffect(()=>{E()},[r]);const E=async()=>{w(!0);try{const[A,I]=await Promise.all([$e.get(`/world-bible/folders/${r}/entities`),$e.get(`/world-bible/folders/${r}`)]);c(A),I.folder?(m(I.folder),y(I.path||[])):(m(I||{name:"Folder"}),y([]))}catch(A){console.error("Error loading folder content:",A),m(null),y([])}finally{w(!1)}};if(b)return h.jsx("div",{className:"p-20 text-center animate-pulse text-text-muted",children:"Loading sector..."});if(!f)return h.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-20 text-text-muted",children:[h.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-20",children:"folder_off"}),h.jsx("h2",{className:"text-xl font-bold opacity-50",children:"Folder Not Found"}),h.jsx("p",{className:"text-sm opacity-30 mt-2",children:"The sector you are looking for does not exist or has been moved."}),h.jsx(ld,{to:`/${t}/${e}/bible`,className:"mt-6 px-6 py-2 bg-white/5 hover:bg-white/10 rounded-full text-xs font-bold transition-colors",children:"Return to Root"})]});const P=f&&f.tipo&&(["UNIVERSE","GALAXY","SYSTEM","PLANET"].includes(f.tipo)||f.tipo==="MAGIC"),_=f?gS(f.tipo):ed.FOLDER;return P?h.jsxs("div",{className:"flex-1 overflow-y-auto bg-[#0a0a0c] text-white w-full h-full relative",children:[h.jsxs("div",{className:`w-full min-h-[300px] ${_.bgColor} relative flex items-end p-10 border-b border-white/5`,children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0c] to-transparent opacity-80 pointer-events-none"}),h.jsx("div",{className:"absolute top-6 left-10 z-20",children:h.jsx(BX,{path:g,currentFolder:f})}),h.jsxs("div",{className:"relative z-10 flex gap-8 items-end w-full max-w-7xl mx-auto",children:[h.jsx("div",{className:`w-32 h-32 rounded-3xl ${_.bgColor} border border-white/10 flex items-center justify-center shadow-2xl`,children:h.jsx("span",{className:`material-symbols-outlined text-6xl ${_.color}`,children:_.icon})}),h.jsxs("div",{className:"flex-1 mb-2",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[h.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border border-white/10 ${_.bgColor} ${_.color}`,children:_.label}),h.jsxs("span",{className:"text-white/30 text-xs font-mono tracking-widest uppercase",children:["ID: ",f.id]})]}),h.jsx("h1",{className:"text-6xl font-black tracking-tighter text-white mb-2",children:f.nombre}),h.jsx("p",{className:"text-lg text-white/50 max-w-2xl font-light leading-relaxed",children:f.descripcion||"Sin descripcin definida para este sector cosmolgico."})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("button",{onClick:()=>n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadindividual`),className:"px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"person_add"})," Nueva Entidad"]}),h.jsxs("button",{onClick:()=>n(`/${t}/${e}/map-editor/create/${r}`,{state:{folderId:f?.id}}),className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all border border-glass-border",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Mapa"]})]})]})]}),h.jsxs("div",{className:"max-w-7xl mx-auto p-10 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"bg-[#13141f] border border-white/5 rounded-2xl p-6",children:[h.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Estadsticas"}),h.jsx("div",{className:"grid grid-cols-2 gap-4",children:h.jsxs("div",{children:[h.jsx("div",{className:"text-2xl font-black text-white",children:u.length}),h.jsx("div",{className:"text-[10px] text-white/40 uppercase",children:"Entidades"})]})})]}),h.jsxs("div",{className:"bg-[#13141f] border border-white/5 rounded-2xl p-6 h-64 flex flex-col",children:[h.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Notas Rpidas"}),h.jsx("textarea",{className:"flex-1 bg-transparent resize-none outline-none text-sm text-white/70 placeholder-white/20",placeholder:"Escribir notas de la zona..."})]})]}),h.jsxs("div",{className:"lg:col-span-2",children:[h.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Contenido Interno"}),u.length===0&&h.jsxs("div",{className:"p-12 border border-dashed border-white/10 rounded-2xl text-center",children:[h.jsx("span",{className:"material-symbols-outlined text-4xl text-white/20 mb-2",children:"folder_open"}),h.jsx("p",{className:"text-white/30 text-sm",children:"Este sector est vaco."})]}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:u.map(A=>h.jsx(mS,{item:A,type:"entity",linkTo:`/${t}/${e}/bible/folder/${f.slug||r}/entity/${A.slug||A.id}`,onDelete:()=>a(A.id,f?.id||r)},A.id))})]})]})]}):h.jsxs("div",{className:"flex-1 p-8 max-w-[1600px] mx-auto w-full h-full overflow-y-auto",children:[h.jsxs("header",{className:"mb-8 flex items-end justify-between",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsxs(ld,{to:`/${t}/${e}/bible`,className:"text-xs font-bold text-text-muted hover:text-primary transition-colors flex items-center gap-1",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"})," Root"]}),f&&h.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] bg-white/5 border border-white/10 ${_.color}`,children:_.label})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("span",{className:`material-symbols-outlined text-3xl ${_.color}`,children:_.icon}),h.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter",children:f?.nombre||"Unnamed Folder"})]}),h.jsx("p",{className:"text-white/50 text-sm mt-2 max-w-xl",children:f?.descripcion})]}),h.jsxs("div",{className:"flex items-center gap-3 relative",children:[h.jsxs("button",{onClick:()=>k(!N),className:"h-10 px-6 rounded-xl bg-primary hover:bg-primary-light transition flex items-center gap-2 text-xs font-bold text-white shadow-lg shadow-primary/20",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"}),h.jsx("span",{children:"Aadir Elemento"})]}),N&&h.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-surface-dark border border-glass-border rounded-2xl shadow-2xl py-2 z-50 animate-in fade-in slide-in-from-top-2",children:[h.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadindividual`),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"person"})," Personaje"]}),h.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadcolectiva`),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-blue-400",children:"groups"})," Cultura / Grupo"]}),h.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/zona`),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-green-400",children:"location_on"})," Lugar / Geografa"]}),h.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/interaccion`),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-amber-400",children:"history_edu"})," Lore / Interaccin"]}),h.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/efectos`),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-purple-400",children:"magic_button"})," Objeto / Efecto"]}),h.jsx("div",{className:"h-px bg-white/5 my-1"}),h.jsxs("button",{onClick:()=>{n(`/${t}/${e}/map-editor/create/${r}`,{state:{folderId:f?.id}}),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-red-400",children:"map"})," Nuevo Mapa"]}),h.jsxs("button",{onClick:()=>{s(f,"TIMELINE"),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-cyan-400",children:"timeline"})," Timeline"]})]})]})]}),f?.tipo==="TIMELINE"?h.jsx(FX,{entities:C,folderId:r,onAddEvent:()=>n(`/${t}/${e}/bible/folder/${r}/entity/new/evento`)}):h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:C.map(A=>{const I=A.tipoEspecial==="map"||A.tipoEspecial==="timeline"?A.tipoEspecial:"entity";return h.jsx(mS,{item:A,type:"entity",linkTo:`/${t}/${e}/bible/folder/${f?.slug||r}/${I}/${A.slug||A.id}`,onDelete:()=>a(A.id,f?.id||r)},A.id)})}),u.length===0&&h.jsx("div",{className:"p-20 text-center border-2 border-dashed border-glass-border rounded-[3rem] opacity-30 mt-8",children:h.jsx("p",{className:"text-text-muted font-bold uppercase tracking-widest",children:"Empty Folder"})})]})},VX=t=>{switch(t?.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},UX=(t,e,r,n)=>{const i=r.slug||r.id;return`/${t}/${e}/bible/folder/${n||"root"}/entity/${i}`},y_=({folder:t,onCreateSubfolder:e,onRename:r,onDeleteFolder:n,onDeleteEntity:i,onCreateTemplate:a,onMoveEntity:s,onCreateEntity:o,onConfirmCreate:l,className:u})=>{const{username:c,projectName:f}=Ua(),m=Na(),[g,y]=se.useState(!1),[b,w]=se.useState({folders:[],entities:[]}),[N,k]=se.useState(!1),[C,E]=se.useState(null),[P,_]=se.useState(t.nombre),[A,I]=se.useState(!1),[D,L]=se.useState(null);se.useEffect(()=>{_(t.nombre)},[t.nombre]),se.useEffect(()=>{const V=Y=>{const{folderId:Z,optimisticType:ie,confirmedType:ce,removeId:he,item:ee,oldId:le,expand:te,type:ae}=Y.detail||{};if(Z===t.id){if(te&&(y(!0),N||U()),N)if(ie){const oe=ie==="folder"?"folders":"entities";w(fe=>({...fe,[oe]:[...fe[oe].filter(pe=>pe.id!==ee.id),ee]}))}else if(ce){const oe=ce==="folder"?"folders":"entities";w(fe=>({...fe,[oe]:fe[oe].map(pe=>pe.id===le?ee:pe)}))}else if(he){const oe=ae==="folder"?"folders":"entities";w(fe=>({...fe,[oe]:fe[oe].filter(pe=>pe.id!==he)}))}else!ie&&!ce&&!he&&U()}else Y.detail?.targetFolderId===t.id&&Y.detail?.type==="move-in"?N&&U():Y.detail?.sourceFolderId===t.id&&Y.detail?.type==="move-out"&&N&&w(oe=>({...oe,entities:oe.entities.filter(fe=>fe.id!==fe.detail.entityId)}))};return window.addEventListener("folder-update",V),()=>window.removeEventListener("folder-update",V)},[t.id,N]);const U=async()=>{try{console.log("Loading content for folder:",t.id,"Slug:",t.slug);const[V,Y]=await Promise.all([$e.get(`/world-bible/folders/${t.id}/subfolders`),$e.get(`/world-bible/folders/${t.id}/entities`)]);w({folders:V,entities:Y}),k(!0)}catch(V){console.error("Error reloading folder content:",V),V.message&&V.message.includes("404")&&console.error(`404 for folder ${t.id} (${t.nombre})`)}},H=V=>{V.stopPropagation(),y(!g),!N&&!g&&U()},M=()=>m(`/${c}/${f}/bible/folder/${t.slug||t.id}`),z=(V,Y,Z,ie)=>{V.preventDefault(),V.stopPropagation(),E({x:V.clientX,y:V.clientY,type:Y,id:Z,name:ie})},O=()=>E(null);se.useEffect(()=>{if(C)return window.addEventListener("click",O),()=>window.removeEventListener("click",O)},[C]);const G=V=>{if(V.key==="Enter"){V.preventDefault();const Y=V.target.value.trim();Y?l(t.id,Y,"folder",t.parentId,t.tipoEspecial):t.isNew&&i(t.id,t.parentId)}};if(t.isNew)return h.jsx("div",{className:"px-3 py-1 animate-in fade-in zoom-in-95 duration-200",children:h.jsx("input",{autoFocus:!0,type:"text",className:"w-full bg-surface-light border border-primary/50 rounded px-2 py-1 text-xs text-white outline-none",placeholder:"Folder Name...",onKeyDown:G,onBlur:V=>{const Y=V.target.value.trim();Y?l(t.id,Y,"folder",t.parentId):i(t.id,t.parentId)}})});const W=({item:V,type:Y})=>h.jsx("div",{className:"px-3 py-1 animate-in fade-in zoom-in-95 duration-200",children:h.jsx("input",{autoFocus:!0,type:"text",defaultValue:V.nombre||"",className:"w-full bg-surface-light border border-primary/50 rounded px-2 py-1 text-xs text-white outline-none",placeholder:"Name...",onKeyDown:Z=>{if(Z.key==="Enter"){Z.preventDefault();const ie=Z.target.value.trim();ie?l(V.id,ie,Y,t.id,V.tipoEspecial):V.isNew&&i(V.id,t.id),L(null)}else Z.key==="Escape"&&(L(null),V.isNew&&i(V.id,t.id))},onBlur:Z=>{const ie=Z.target.value.trim();ie?l(V.id,ie,Y,t.id,V.tipoEspecial):V.isNew&&i(V.id,t.id),L(null)}})}),$=V=>{V.preventDefault(),V.stopPropagation(),V.currentTarget.classList.add("bg-primary/20")},X=V=>{V.preventDefault(),V.stopPropagation(),V.currentTarget.classList.remove("bg-primary/20")},Q=V=>{V.preventDefault(),V.stopPropagation(),V.currentTarget.classList.remove("bg-primary/20");const Y=V.dataTransfer.getData("entityId"),Z=V.dataTransfer.getData("sourceFolderId");Y&&Z&&Z!==String(t.id)&&s(Y,t.id,Z)};return h.jsxs("div",{className:`space-y-1 select-none ${u||""}`,children:[h.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 rounded-xl text-xs font-bold text-text-muted hover:text-white hover:bg-white/5 cursor-pointer transition-all group relative",onClick:M,onContextMenu:V=>z(V,"folder",t.id,t.nombre),onDragOver:$,onDragLeave:X,onDrop:Q,children:[h.jsx("span",{onClick:H,className:`material-symbols-outlined text-lg transition-transform hover:text-primary ${g?"rotate-90 text-primary":"opacity-50"}`,children:"chevron_right"}),h.jsx("span",{className:`material-symbols-outlined text-lg ${gS(t.tipo).color}`,children:gS(t.tipo).icon}),A?h.jsx("input",{autoFocus:!0,className:"bg-surface-light border border-primary/50 rounded px-2 py-0.5 text-xs text-white outline-none flex-1 min-w-0",defaultValue:P,onKeyDown:async V=>{if(V.key==="Enter"){V.preventDefault(),V.stopPropagation();const Y=V.target.value.trim();if(Y&&Y!==P)try{await r(t.id,Y),_(Y)}catch(Z){console.error("Rename failed",Z)}I(!1)}else V.key==="Escape"&&(V.preventDefault(),V.stopPropagation(),I(!1))},onBlur:()=>I(!1),onClick:V=>V.stopPropagation()}):h.jsx("span",{className:"truncate flex-1",children:P})]}),C&&h.jsxs("div",{className:"fixed bg-surface-dark border border-glass-border shadow-2xl rounded-xl py-2 z-50 w-48 text-xs font-medium flex flex-col",style:{top:C.y,left:C.x},onClick:V=>V.stopPropagation(),children:[h.jsx("div",{className:"px-4 py-2 border-b border-white/5 font-bold text-text-muted truncate",children:C.name}),C.type==="folder"?h.jsxs(h.Fragment,{children:[h.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{o(t.id,"entidadindividual"),O()},children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"person"})," Add Character"]}),h.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{m(`/${c}/${f}/map-editor/create/${t.id}`),O()},children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Add Map"]}),h.jsx("div",{className:"h-px bg-white/5 my-1"}),h.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{I(!0),O()},children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Rename Folder"]}),h.jsxs("button",{className:"px-4 py-2 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-2",onClick:()=>{n(t.id,t.parentId),O()},children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Delete Folder"]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2 cursor-pointer",onClick:()=>{L(C.id),O()},children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Rename"]}),h.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2 cursor-pointer",onClick:async()=>{try{await $e.entityService.toggleFavorite(C.id),window.dispatchEvent(new CustomEvent("favorites-update")),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:t.id}}))}catch(V){console.error(V)}O()},children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-500",children:"star"})," Toggle Favorite"]}),h.jsxs("button",{className:"px-4 py-2 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-2",onClick:()=>{i(C.id,t.id),O()},children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Delete Entity"]})]})]}),g&&h.jsxs("div",{className:"ml-6 pl-4 border-l border-glass-border space-y-1 animate-slide-in",children:[b.folders.map(V=>h.jsx(y_,{folder:V,onCreateSubfolder:e,onRename:r,onDeleteFolder:n,onDeleteEntity:i,onCreateTemplate:a,onMoveEntity:s,onCreateEntity:o,onConfirmCreate:l},V.id)),b.entities.map(V=>V.isNew||V.id===D?h.jsx(W,{item:V,type:"entity"},V.id):h.jsxs(ld,{to:UX(c,f,V,t.slug||t.id),onContextMenu:Y=>z(Y,"entity",V.id,V.nombre),className:`flex items-center gap-3 px-3 py-2 rounded-xl text-[11px] font-medium text-text-muted hover:text-white hover:bg-primary/10 transition-all group cursor-grab active:cursor-grabbing ${V.pending?"opacity-50 pointer-events-none":""}`,draggable:!V.pending,onDragStart:Y=>{Y.dataTransfer.setData("entityId",V.id),Y.dataTransfer.setData("sourceFolderId",t.id)},children:[h.jsx("span",{className:"material-symbols-outlined text-sm opacity-70 group-hover:text-primary transition-colors",children:VX(V.tipoEspecial)}),h.jsx("span",{className:"truncate flex-1",children:V.nombre}),V.favorite&&h.jsx("span",{className:"material-symbols-outlined text-[10px] text-yellow-500",title:"Favorito",children:"star"})]},V.id)),N&&b.folders.length===0&&b.entities.length===0&&h.jsx("div",{className:"px-3 py-2 text-[10px] text-text-muted/30 uppercase font-black italic tracking-tighter",children:"Empty Sector"})]})]})},GX=({isOpen:t,onClose:e,onCreate:r,parentFolder:n})=>{const[i,a]=se.useState({nombre:"",descripcion:"",tipo:"FOLDER",canvasType:"BLANK"});if(!t)return null;const s=()=>{r(i),e(),a({nombre:"",descripcion:"",tipo:"FOLDER",canvasType:"BLANK"})},o=[ed.UNIVERSE,ed.GALAXY,ed.SYSTEM,ed.PLANET];return h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:h.jsxs("div",{className:"bg-[#1a1b26] w-full max-w-4xl rounded-2xl shadow-2xl border border-white/10 overflow-hidden flex flex-col max-h-[90vh]",children:[h.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-[#1f202e]",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:h.jsx("span",{className:"material-icons text-sm",children:"add"})}),h.jsx("h2",{className:"text-xl font-semibold text-white",children:n?"Crear Nuevo Espacio":"Crear Nuevo Mapa"})]}),h.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition",children:h.jsx("span",{className:"material-icons",children:"close"})})]}),h.jsx("div",{className:"p-8 overflow-y-auto flex-1",children:h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[h.jsxs("div",{className:"space-y-6",children:[h.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-indigo-400",children:"Identidad"}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-2",children:"Nombre del Espacio"}),h.jsx("input",{autoFocus:!0,type:"text",value:i.nombre,onChange:l=>a({...i,nombre:l.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-indigo-500/50 transition-all shadow-inner",placeholder:"ej. Sistema Solar"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-2",children:"Descripcin"}),h.jsx("textarea",{value:i.descripcion,onChange:l=>a({...i,descripcion:l.target.value}),className:"w-full h-32 bg-black/40 border border-white/5 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-indigo-500/50 resize-none transition-all",placeholder:"Detalles sobre este nivel jerrquico..."})]})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-indigo-400",children:"Configuracin"}),h.jsxs("div",{className:"space-y-3",children:[h.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-1",children:"Tipo de Jerarqua"}),h.jsx("div",{className:"grid grid-cols-2 gap-2",children:o.concat([{id:"FOLDER",label:"Carpeta",icon:"folder",color:"text-white/50"}]).map(l=>h.jsxs("div",{onClick:()=>a({...i,tipo:l.id}),className:`flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all ${i.tipo===l.id?"bg-indigo-500/10 border-indigo-500/50":"bg-white/5 border-white/5 hover:bg-white/10"}`,children:[h.jsx("span",{className:`material-icons text-lg ${l.color||""}`,children:l.icon}),h.jsx("span",{className:"text-xs font-bold text-white/80",children:l.label})]},l.id||"FOLDER"))})]}),h.jsx("div",{className:"p-4 rounded-2xl bg-indigo-500/5 border border-indigo-500/10",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:h.jsx("span",{className:"material-icons",children:"info"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-[10px] uppercase font-black text-indigo-300",children:"Ubicacin Actual"}),h.jsx("p",{className:"text-xs text-indigo-100/50",children:n?n.nombre:"Raz del Mundo"})]})]})})]})]})}),h.jsxs("div",{className:"p-6 border-t border-white/5 flex justify-end gap-3 bg-[#1f202e]",children:[h.jsx("button",{onClick:e,className:"px-6 py-3 rounded-xl text-xs font-black uppercase tracking-widest text-text-muted hover:text-white transition",children:"Cancelar"}),h.jsx("button",{onClick:s,disabled:!i.nombre,className:"px-8 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-black uppercase tracking-widest shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-30 disabled:pointer-events-none",children:"Confirmar y Crear"})]})]})})},HX=()=>{const{username:t,projectName:e}=Ua(),r=Na(),{handleCreateEntity:n,...i}=$u()||{},[a,s]=se.useState([]),[o,l]=se.useState([]),[u,c]=se.useState(!1),[f,m]=se.useState(!1),[g,y]=se.useState(null),[b,w]=se.useState(!1),[N,k]=se.useState(null),C=`/${t}/${e}/bible`;se.useEffect(()=>{E(),P();const O=()=>P();return window.addEventListener("favorites-update",O),()=>window.removeEventListener("favorites-update",O)},[e]);const E=async()=>{try{const O=await $e.get("/world-bible/folders");s(O)}catch(O){console.error("Error loading folders:",O)}},P=async()=>{try{const O=await $e.get("/world-bible/favorites");l(O)}catch(O){console.error("Error loading favorites:",O)}},_=(O=null)=>{y(O),m(!0),c(!1)},A=async(O=null,G="FOLDER")=>{try{const W=O?typeof O=="object"?O.id:O:null,$=await $e.post("/world-bible/folders",{nombre:G==="TIMELINE"?"Nueva Lnea de Tiempo":"Nueva Carpeta",padreId:W,tipo:G});if(W===null){const X=await $e.get("/world-bible/folders");s(X),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:null}}))}else window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:W,optimisticType:"folder",item:$,expand:!0}}))}catch(W){console.error("Error creating simple folder:",W)}},I=async O=>{try{const G=g?g.id:null,W=await $e.post("/world-bible/folders",{nombre:O.nombre,descripcion:O.descripcion,padreId:G,tipo:O.tipo});if(G===null){const $=await $e.get("/world-bible/folders");s($),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:null}}))}else W.id||console.error("CRITICAL: Created folder has no ID!",W),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:G,optimisticType:"folder",item:W,expand:!0}}))}catch(G){console.error(G),alert("Error creating folder/zone.")}},D=async(O,G="entidadindividual")=>{const W=typeof O=="object"?O.slug||O.id:O;r(`${C}/folder/${W}/entity/new/${G}`)},L=async(O,G)=>{try{await $e.put(`/world-bible/folders/${O}`,{nombre:G}),s(W=>W.map($=>$.id===O?{...$,nombre:G}:$))}catch(W){throw W}},U=(O,G=null)=>{k({id:O,parentId:G,type:"folder"}),w(!0)},H=async()=>{if(!N)return;const{id:O,parentId:G,type:W,folderId:$}=N;try{W==="folder"?(await $e.delete(`/world-bible/folders/${O}`),G===null&&s(X=>X.filter(Q=>Q.id!==O)),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:G,removeId:O,type:"folder"}}))):W==="entity"&&(await $e.delete(`/world-bible/entities/${O}`),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:$,removeId:O,type:"entity"}})))}catch(X){console.error("Deletion failed:",X),alert("Error trying to delete item.")}finally{k(null)}},M=(O,G)=>{k({id:O,folderId:G,type:"entity"}),w(!0)},z=async(O,G,W,$,X)=>{try{if(W==="folder")typeof O=="number"&&!O.toString().startsWith("temp")&&(await $e.put(`/world-bible/folders/${O}`,{nombre:G}),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:$,confirmedType:"folder",oldId:O,item:{id:O,nombre:G,parentId:$,tipo:X,uiKey:Date.now()}}})),$||s(Q=>Q.map(V=>V.id===O?{...V,nombre:G}:V)));else if(W==="entity")if(typeof O=="string"&&O.startsWith("new-")){const Q=await $e.post("/world-bible/entities",{nombre:G,carpetaId:$,tipoEspecial:X||"entidadindividual"});window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:$,confirmedType:"entity",oldId:O,item:Q}}))}else await $e.put(`/world-bible/entities/${O}`,{nombre:G}),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:$,confirmedType:"entity",oldId:O,item:{id:O,nombre:G,carpeta:{id:$},tipoEspecial:X,slug:O}}})),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:$}}))}catch(Q){console.error("Creation/Rename failed",Q),W==="folder"&&U(O,$)}};return h.jsxs("div",{className:"flex h-full w-full bg-background-dark max-w-[1920px] mx-auto",children:[h.jsxs("aside",{className:"w-80 flex-none flex flex-col border-r border-glass-border bg-surface-dark/50 z-10",children:[h.jsx("div",{className:"p-4 border-b border-glass-border",children:h.jsxs("div",{className:"relative group mb-3",children:[h.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-text-muted text-sm group-focus-within:text-primary transition-colors",children:"search"}),h.jsx("input",{type:"text",placeholder:"Buscar en Biblia...",className:"w-full bg-surface-light/50 border border-glass-border rounded-xl py-2 pl-9 pr-3 text-xs focus:border-primary/50 outline-none transition-all text-white placeholder:text-text-muted/50"})]})}),h.jsxs("div",{className:"px-2 pt-2",children:[h.jsx("div",{className:"flex items-center justify-between px-2 mb-1",children:h.jsx("h2",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted",children:"Favoritos"})}),o.length>0?h.jsx("div",{className:"space-y-0.5",children:o.map(O=>h.jsxs("div",{onClick:()=>r(`${C}/folder/${O.carpeta.slug||O.carpeta.id}/entity/${O.slug||O.id}`),className:"flex items-center gap-3 px-3 py-1.5 rounded-lg text-[11px] font-medium text-text-muted hover:text-white hover:bg-white/5 cursor-pointer transition-all group",children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-500/70 group-hover:text-yellow-400",children:"star"}),h.jsx("span",{className:"truncate",children:O.nombre})]},O.id))}):h.jsx("div",{className:"px-4 py-2 text-[10px] text-text-muted/30 italic",children:"Sin favoritos"}),h.jsx("div",{className:"h-px bg-glass-border my-2 opacity-50"})]}),h.jsx("div",{className:"p-4 border-b border-glass-border pt-0",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("h2",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted",children:"Explorador"}),h.jsx("div",{className:"relative",children:h.jsx("button",{className:"transition-colors hover:text-white text-primary",onClick:()=>A(null),title:"Crear Carpeta",children:h.jsx("span",{className:"material-symbols-outlined text-sm",children:"create_new_folder"})})})]})}),h.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar p-2 space-y-0.5",children:a.length===0?h.jsxs("div",{className:"p-8 text-center opacity-30",children:[h.jsx("span",{className:"material-symbols-outlined text-3xl mb-2",children:"folder_off"}),h.jsx("p",{className:"text-[10px] uppercase font-bold",children:"Biblia Vaca"})]}):a.map(O=>h.jsx(y_,{folder:O,onCreateSubfolder:()=>{},onRename:L,onDeleteFolder:U,onDeleteEntity:U,onCreateTemplate:()=>{},onMoveEntity:(G,W,$)=>console.log("move",G,W,$),onCreateEntity:D,onConfirmCreate:z},O.uiKey||O.id))})]}),h.jsx("main",{className:"flex-1 overflow-hidden relative bg-gradient-to-br from-background-dark to-surface-dark/20",children:h.jsx(xS,{context:{...i,folders:a,handleCreateEntity:D,handleOpenCreateModal:_,handleDeleteFolder:U,handleDeleteEntity:M,handleCreateSimpleFolder:A}})}),h.jsx(GX,{isOpen:f,onClose:()=>m(!1),onCreate:I,parentFolder:g}),h.jsx(Cg,{isOpen:b,onClose:()=>w(!1),onConfirm:H,title:N?.type==="folder"?"Borrar Carpeta":"Borrar Entidad",message:N?.type==="folder"?"Esta accin eliminar la carpeta y todo su contenido. Ests seguro?":"Ests seguro de querer eliminar esta entidad de tu mundo?",confirmText:"S, borrar"})]})},qX=()=>{const{username:t,projectName:e}=Ua();Na();const{handleOpenCreateModal:r,handleDeleteFolder:n,handleCreateSimpleFolder:i,handleRenameFolder:a,folders:s=[]}=$u(),[o,l]=se.useState(null),[u,c]=se.useState(null),[f,m]=se.useState(""),g=(w,N)=>{w.preventDefault(),w.stopPropagation(),l({x:w.clientX,y:w.clientY,folder:N})},y=()=>l(null);se.useEffect(()=>{if(o){const w=()=>y();return window.addEventListener("click",w),()=>window.removeEventListener("click",w)}},[o]);const b=async(w,N)=>{N.trim()&&a&&await a(w,N.trim()),c(null),m("")};return s===void 0?h.jsx("div",{className:"p-20 text-center animate-pulse text-text-muted",children:"Loading World Bible..."}):h.jsxs("div",{className:"flex-1 p-8 max-w-[1600px] mx-auto w-full h-full overflow-y-auto",children:[h.jsxs("header",{className:"mb-8 flex items-end justify-between",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-3 text-xs font-black uppercase tracking-widest text-primary italic mb-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"}),"World Bible"]}),h.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter",children:"Root Index"}),h.jsx("p",{className:"text-text-muted mt-2 max-w-lg text-sm",children:"The central archive of your world. Organize characters, locations, timelines, and maps."})]}),h.jsx("div",{className:"flex items-center gap-2",children:h.jsxs("button",{onClick:()=>i(null,"FOLDER"),className:"px-6 py-2 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold flex items-center gap-2 transition-all shadow-lg shadow-primary/20",children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"create_new_folder"})," Nueva Carpeta"]})})]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:s.map(w=>u===w.id?h.jsx("div",{className:"p-4 rounded-3xl bg-surface-dark border border-primary/50",children:h.jsx("input",{autoFocus:!0,type:"text",value:f,onChange:N=>m(N.target.value),onKeyDown:N=>{N.key==="Enter"&&b(w.id,f),N.key==="Escape"&&(c(null),m(""))},onBlur:()=>b(w.id,f),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none",placeholder:"Folder name..."})},w.id):h.jsx(mS,{item:w,type:"folder",linkTo:`/${t}/${e}/bible/folder/${w.slug||w.id}`,onDelete:()=>n(w.id),onContextMenu:N=>g(N,w)},w.id))}),s.length===0&&h.jsxs("div",{className:"p-20 text-center border-2 border-dashed border-glass-border rounded-[3rem] opacity-30 mt-8",children:[h.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 text-text-muted",children:"library_books"}),h.jsx("h3",{className:"text-xl font-bold text-white uppercase tracking-widest",children:"Archivo Vaco"}),h.jsx("p",{className:"text-text-muted mt-2",children:"Comienza creando espacios para organizar tu mundo."})]}),o&&h.jsxs("div",{className:"fixed bg-surface-dark border border-glass-border shadow-2xl rounded-xl py-2 z-50 w-52 text-xs font-medium flex flex-col animate-in fade-in zoom-in-95 duration-150",style:{top:o.y,left:o.x},onClick:w=>w.stopPropagation(),children:[h.jsxs("div",{className:"px-4 py-2 border-b border-white/5 font-bold text-text-muted truncate flex items-center gap-2",children:[h.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"folder"}),o.folder.nombre]}),h.jsxs("button",{className:"px-4 py-2.5 hover:bg-white/5 text-left flex items-center gap-3 text-white/80 hover:text-white transition-colors",onClick:()=>{c(o.folder.id),m(o.folder.nombre),y()},children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Renombrar"]}),h.jsxs("button",{className:"px-4 py-2.5 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-3 transition-colors",onClick:()=>{n(o.folder.id),y()},children:[h.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Eliminar Carpeta"]})]})]})};function WX(){return h.jsx(XA,{children:h.jsxs(UA,{children:[h.jsx(Xr,{path:"/",element:h.jsx(zR,{})}),h.jsx(Xr,{element:h.jsx(DR,{}),children:h.jsxs(Xr,{path:"/:username/:projectName",element:h.jsx(HR,{}),children:[h.jsx(Xr,{index:!0,element:h.jsx(VR,{})}),h.jsx(Xr,{path:"writing",element:h.jsx(AX,{})}),h.jsx(Xr,{path:"entities/:type/:entityId",element:h.jsx(VB,{})}),h.jsx(Xr,{path:"settings",element:h.jsx(UR,{})}),h.jsx(Xr,{path:"map-editor/create/:folderId",element:h.jsx(D2,{mode:"create"})}),h.jsx(Xr,{path:"map-editor/edit/:entityId",element:h.jsx(D2,{mode:"edit"})}),h.jsxs(Xr,{path:"bible",element:h.jsx(HX,{}),children:[h.jsx(Xr,{index:!0,element:h.jsx(qX,{})}),h.jsx(Xr,{path:"folder/:folderSlug/entity/new/:type",element:h.jsx(Em,{mode:"creation"})}),h.jsx(Xr,{path:"folder/:folderSlug",element:h.jsx(zX,{})}),h.jsx(Xr,{path:"entity/:entitySlug",element:h.jsx(Em,{})}),h.jsx(Xr,{path:"folder/:folderSlug/entity/:entitySlug",element:h.jsx(Em,{})}),h.jsx(Xr,{path:"folder/:folderSlug/map/:entitySlug",element:h.jsx(Em,{})}),h.jsx(Xr,{path:"folder/:folderSlug/timeline/:entitySlug",element:h.jsx(Em,{})})]}),h.jsx(Xr,{path:"map",element:h.jsx(qz,{})}),h.jsx(Xr,{path:"timeline",element:h.jsx(UB,{})}),h.jsx(Xr,{path:"languages",element:h.jsx(Yz,{})}),h.jsx(Xr,{path:"trash",element:h.jsx(RX,{})}),h.jsx(Xr,{path:"graph",element:h.jsx(IB,{})})]})})]})})}const Wk=(t,e,r,n="")=>{fetch("/api/logs/error",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:t,message:e,stack:r,componentStack:n})}).catch(i=>console.error("Failed to send error log:",i))};window.onerror=(t,e,r,n,i)=>{Wk("Global Window Error",t,i?i.stack:`${e}:${r}:${n}`)};window.onunhandledrejection=t=>{Wk("Unhandled Promise Rejection",t.reason?t.reason.message:"Unknown reason",t.reason?t.reason.stack:"")};class $X extends Kt.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,r){this.setState({error:e,errorInfo:r}),console.error("Uncaught Error:",e,r),Wk("React ErrorBoundary",e.message,e.stack,r.componentStack)}render(){return this.state.hasError?h.jsxs("div",{style:{padding:20,background:"#222",color:"red",height:"100vh"},children:[h.jsx("h1",{children:"Something went wrong."}),h.jsxs("details",{style:{whiteSpace:"pre-wrap"},children:[this.state.error&&this.state.error.toString(),h.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}):this.props.children}}const WT=document.getElementById("root");WT?X_.createRoot(WT).render(h.jsx(Kt.StrictMode,{children:h.jsx($X,{children:h.jsx(WX,{})})})):console.error("React root element not found (looked for #root)");

function tR(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var Nk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _1={exports:{}},Jp={},S1={exports:{}},dr={};var Tk;function rR(){if(Tk)return dr;Tk=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),s=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),f=Symbol.iterator;function g(G){return G===null||typeof G!="object"?null:(G=f&&G[f]||G["@@iterator"],typeof G=="function"?G:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,_={};function S(G,te,ne){this.props=G,this.context=te,this.refs=_,this.updater=ne||v}S.prototype.isReactComponent={},S.prototype.setState=function(G,te){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,te,"setState")},S.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function N(){}N.prototype=S.prototype;function k(G,te,ne){this.props=G,this.context=te,this.refs=_,this.updater=ne||v}var E=k.prototype=new N;E.constructor=k,x(E,S.prototype),E.isPureReactComponent=!0;var T=Array.isArray,R=Object.prototype.hasOwnProperty,j={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function B(G,te,ne){var de,me={},ye=null,ie=null;if(te!=null)for(de in te.ref!==void 0&&(ie=te.ref),te.key!==void 0&&(ye=""+te.key),te)R.call(te,de)&&!D.hasOwnProperty(de)&&(me[de]=te[de]);var pe=arguments.length-2;if(pe===1)me.children=ne;else if(1<pe){for(var oe=Array(pe),fe=0;fe<pe;fe++)oe[fe]=arguments[fe+2];me.children=oe}if(G&&G.defaultProps)for(de in pe=G.defaultProps,pe)me[de]===void 0&&(me[de]=pe[de]);return{$$typeof:t,type:G,key:ye,ref:ie,props:me,_owner:j.current}}function I(G,te){return{$$typeof:t,type:G.type,key:te,ref:G.ref,props:G.props,_owner:G._owner}}function V(G){return typeof G=="object"&&G!==null&&G.$$typeof===t}function $(G){var te={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(ne){return te[ne]})}var Z=/\/+/g;function O(G,te){return typeof G=="object"&&G!==null&&G.key!=null?$(""+G.key):te.toString(36)}function W(G,te,ne,de,me){var ye=typeof G;(ye==="undefined"||ye==="boolean")&&(G=null);var ie=!1;if(G===null)ie=!0;else switch(ye){case"string":case"number":ie=!0;break;case"object":switch(G.$$typeof){case t:case e:ie=!0}}if(ie)return ie=G,me=me(ie),G=de===""?"."+O(ie,0):de,T(me)?(ne="",G!=null&&(ne=G.replace(Z,"$&/")+"/"),W(me,te,ne,"",function(fe){return fe})):me!=null&&(V(me)&&(me=I(me,ne+(!me.key||ie&&ie.key===me.key?"":(""+me.key).replace(Z,"$&/")+"/")+G)),te.push(me)),1;if(ie=0,de=de===""?".":de+":",T(G))for(var pe=0;pe<G.length;pe++){ye=G[pe];var oe=de+O(ye,pe);ie+=W(ye,te,ne,oe,me)}else if(oe=g(G),typeof oe=="function")for(G=oe.call(G),pe=0;!(ye=G.next()).done;)ye=ye.value,oe=de+O(ye,pe++),ie+=W(ye,te,ne,oe,me);else if(ye==="object")throw te=String(G),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.");return ie}function F(G,te,ne){if(G==null)return G;var de=[],me=0;return W(G,de,"","",function(ye){return te.call(ne,ye,me++)}),de}function K(G){if(G._status===-1){var te=G._result;te=te(),te.then(function(ne){(G._status===0||G._status===-1)&&(G._status=1,G._result=ne)},function(ne){(G._status===0||G._status===-1)&&(G._status=2,G._result=ne)}),G._status===-1&&(G._status=0,G._result=te)}if(G._status===1)return G._result.default;throw G._result}var X={current:null},Q={transition:null},ae={ReactCurrentDispatcher:X,ReactCurrentBatchConfig:Q,ReactCurrentOwner:j};function re(){throw Error("act(...) is not supported in production builds of React.")}return dr.Children={map:F,forEach:function(G,te,ne){F(G,function(){te.apply(this,arguments)},ne)},count:function(G){var te=0;return F(G,function(){te++}),te},toArray:function(G){return F(G,function(te){return te})||[]},only:function(G){if(!V(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},dr.Component=S,dr.Fragment=r,dr.Profiler=i,dr.PureComponent=k,dr.StrictMode=n,dr.Suspense=l,dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ae,dr.act=re,dr.cloneElement=function(G,te,ne){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var de=x({},G.props),me=G.key,ye=G.ref,ie=G._owner;if(te!=null){if(te.ref!==void 0&&(ye=te.ref,ie=j.current),te.key!==void 0&&(me=""+te.key),G.type&&G.type.defaultProps)var pe=G.type.defaultProps;for(oe in te)R.call(te,oe)&&!D.hasOwnProperty(oe)&&(de[oe]=te[oe]===void 0&&pe!==void 0?pe[oe]:te[oe])}var oe=arguments.length-2;if(oe===1)de.children=ne;else if(1<oe){pe=Array(oe);for(var fe=0;fe<oe;fe++)pe[fe]=arguments[fe+2];de.children=pe}return{$$typeof:t,type:G.type,key:me,ref:ye,props:de,_owner:ie}},dr.createContext=function(G){return G={$$typeof:s,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:a,_context:G},G.Consumer=G},dr.createElement=B,dr.createFactory=function(G){var te=B.bind(null,G);return te.type=G,te},dr.createRef=function(){return{current:null}},dr.forwardRef=function(G){return{$$typeof:o,render:G}},dr.isValidElement=V,dr.lazy=function(G){return{$$typeof:c,_payload:{_status:-1,_result:G},_init:K}},dr.memo=function(G,te){return{$$typeof:u,type:G,compare:te===void 0?null:te}},dr.startTransition=function(G){var te=Q.transition;Q.transition={};try{G()}finally{Q.transition=te}},dr.unstable_act=re,dr.useCallback=function(G,te){return X.current.useCallback(G,te)},dr.useContext=function(G){return X.current.useContext(G)},dr.useDebugValue=function(){},dr.useDeferredValue=function(G){return X.current.useDeferredValue(G)},dr.useEffect=function(G,te){return X.current.useEffect(G,te)},dr.useId=function(){return X.current.useId()},dr.useImperativeHandle=function(G,te,ne){return X.current.useImperativeHandle(G,te,ne)},dr.useInsertionEffect=function(G,te){return X.current.useInsertionEffect(G,te)},dr.useLayoutEffect=function(G,te){return X.current.useLayoutEffect(G,te)},dr.useMemo=function(G,te){return X.current.useMemo(G,te)},dr.useReducer=function(G,te,ne){return X.current.useReducer(G,te,ne)},dr.useRef=function(G){return X.current.useRef(G)},dr.useState=function(G){return X.current.useState(G)},dr.useSyncExternalStore=function(G,te,ne){return X.current.useSyncExternalStore(G,te,ne)},dr.useTransition=function(){return X.current.useTransition()},dr.version="18.3.1",dr}var Pk;function Sp(){return Pk||(Pk=1,S1.exports=rR()),S1.exports}var Mk;function nR(){if(Mk)return Jp;Mk=1;var t=Sp(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function s(o,l,u){var c,f={},g=null,v=null;u!==void 0&&(g=""+u),l.key!==void 0&&(g=""+l.key),l.ref!==void 0&&(v=l.ref);for(c in l)n.call(l,c)&&!a.hasOwnProperty(c)&&(f[c]=l[c]);if(o&&o.defaultProps)for(c in l=o.defaultProps,l)f[c]===void 0&&(f[c]=l[c]);return{$$typeof:e,type:o,key:g,ref:v,props:f,_owner:i.current}}return Jp.Fragment=r,Jp.jsx=s,Jp.jsxs=s,Jp}var Ak;function iR(){return Ak||(Ak=1,_1.exports=nR()),_1.exports}var p=iR(),ce=Sp();const er=Wh(ce),aR=tR({__proto__:null,default:er},[ce]);var e0={},k1={exports:{}},Cs={},C1={exports:{}},E1={};var jk;function sR(){return jk||(jk=1,(function(t){function e(Q,ae){var re=Q.length;Q.push(ae);e:for(;0<re;){var G=re-1>>>1,te=Q[G];if(0<i(te,ae))Q[G]=ae,Q[re]=te,re=G;else break e}}function r(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var ae=Q[0],re=Q.pop();if(re!==ae){Q[0]=re;e:for(var G=0,te=Q.length,ne=te>>>1;G<ne;){var de=2*(G+1)-1,me=Q[de],ye=de+1,ie=Q[ye];if(0>i(me,re))ye<te&&0>i(ie,me)?(Q[G]=ie,Q[ye]=re,G=ye):(Q[G]=me,Q[de]=re,G=de);else if(ye<te&&0>i(ie,re))Q[G]=ie,Q[ye]=re,G=ye;else break e}}return ae}function i(Q,ae){var re=Q.sortIndex-ae.sortIndex;return re!==0?re:Q.id-ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();t.unstable_now=function(){return s.now()-o}}var l=[],u=[],c=1,f=null,g=3,v=!1,x=!1,_=!1,S=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(Q){for(var ae=r(u);ae!==null;){if(ae.callback===null)n(u);else if(ae.startTime<=Q)n(u),ae.sortIndex=ae.expirationTime,e(l,ae);else break;ae=r(u)}}function T(Q){if(_=!1,E(Q),!x)if(r(l)!==null)x=!0,K(R);else{var ae=r(u);ae!==null&&X(T,ae.startTime-Q)}}function R(Q,ae){x=!1,_&&(_=!1,N(B),B=-1),v=!0;var re=g;try{for(E(ae),f=r(l);f!==null&&(!(f.expirationTime>ae)||Q&&!$());){var G=f.callback;if(typeof G=="function"){f.callback=null,g=f.priorityLevel;var te=G(f.expirationTime<=ae);ae=t.unstable_now(),typeof te=="function"?f.callback=te:f===r(l)&&n(l),E(ae)}else n(l);f=r(l)}if(f!==null)var ne=!0;else{var de=r(u);de!==null&&X(T,de.startTime-ae),ne=!1}return ne}finally{f=null,g=re,v=!1}}var j=!1,D=null,B=-1,I=5,V=-1;function $(){return!(t.unstable_now()-V<I)}function Z(){if(D!==null){var Q=t.unstable_now();V=Q;var ae=!0;try{ae=D(!0,Q)}finally{ae?O():(j=!1,D=null)}}else j=!1}var O;if(typeof k=="function")O=function(){k(Z)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,F=W.port2;W.port1.onmessage=Z,O=function(){F.postMessage(null)}}else O=function(){S(Z,0)};function K(Q){D=Q,j||(j=!0,O())}function X(Q,ae){B=S(function(){Q(t.unstable_now())},ae)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){x||v||(x=!0,K(R))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(Q){switch(g){case 1:case 2:case 3:var ae=3;break;default:ae=g}var re=g;g=ae;try{return Q()}finally{g=re}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,ae){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var re=g;g=Q;try{return ae()}finally{g=re}},t.unstable_scheduleCallback=function(Q,ae,re){var G=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?G+re:G):re=G,Q){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=re+te,Q={id:c++,callback:ae,priorityLevel:Q,startTime:re,expirationTime:te,sortIndex:-1},re>G?(Q.sortIndex=re,e(u,Q),r(l)===null&&Q===r(u)&&(_?(N(B),B=-1):_=!0,X(T,re-G))):(Q.sortIndex=te,e(l,Q),x||v||(x=!0,K(R))),Q},t.unstable_shouldYield=$,t.unstable_wrapCallback=function(Q){var ae=g;return function(){var re=g;g=ae;try{return Q.apply(this,arguments)}finally{g=re}}}})(E1)),E1}var Rk;function b_(){return Rk||(Rk=1,C1.exports=sR()),C1.exports}var Lk;function oR(){if(Lk)return Cs;Lk=1;var t=Sp(),e=b_();function r(d){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+d,C=1;C<arguments.length;C++)m+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(d,m){s(d,m),s(d+"Capture",m)}function s(d,m){for(i[d]=m,d=0;d<m.length;d++)n.add(m[d])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c={},f={};function g(d){return l.call(f,d)?!0:l.call(c,d)?!1:u.test(d)?f[d]=!0:(c[d]=!0,!1)}function v(d,m,C,A){if(C!==null&&C.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return A?!1:C!==null?!C.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function x(d,m,C,A){if(m===null||typeof m>"u"||v(d,m,C,A))return!0;if(A)return!1;if(C!==null)switch(C.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function _(d,m,C,A,H,Y,se){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=A,this.attributeNamespace=H,this.mustUseProperty=C,this.propertyName=d,this.type=m,this.sanitizeURL=Y,this.removeEmptyString=se}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){S[d]=new _(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var m=d[0];S[m]=new _(m,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){S[d]=new _(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){S[d]=new _(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){S[d]=new _(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){S[d]=new _(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){S[d]=new _(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){S[d]=new _(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){S[d]=new _(d,5,!1,d.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function k(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var m=d.replace(N,k);S[m]=new _(m,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var m=d.replace(N,k);S[m]=new _(m,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var m=d.replace(N,k);S[m]=new _(m,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){S[d]=new _(d,1,!1,d.toLowerCase(),null,!1,!1)}),S.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){S[d]=new _(d,1,!1,d.toLowerCase(),null,!0,!0)});function E(d,m,C,A){var H=S.hasOwnProperty(m)?S[m]:null;(H!==null?H.type!==0:A||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(x(m,C,H,A)&&(C=null),A||H===null?g(m)&&(C===null?d.removeAttribute(m):d.setAttribute(m,""+C)):H.mustUseProperty?d[H.propertyName]=C===null?H.type===3?!1:"":C:(m=H.attributeName,A=H.attributeNamespace,C===null?d.removeAttribute(m):(H=H.type,C=H===3||H===4&&C===!0?"":""+C,A?d.setAttributeNS(A,m,C):d.setAttribute(m,C))))}var T=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),j=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),$=Symbol.for("react.context"),Z=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),X=Symbol.for("react.offscreen"),Q=Symbol.iterator;function ae(d){return d===null||typeof d!="object"?null:(d=Q&&d[Q]||d["@@iterator"],typeof d=="function"?d:null)}var re=Object.assign,G;function te(d){if(G===void 0)try{throw Error()}catch(C){var m=C.stack.trim().match(/\n( *(at )?)/);G=m&&m[1]||""}return`
`+G+d}var ne=!1;function de(d,m){if(!d||ne)return"";ne=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(Ie){var A=Ie}Reflect.construct(d,[],m)}else{try{m.call()}catch(Ie){A=Ie}d.call(m.prototype)}else{try{throw Error()}catch(Ie){A=Ie}d()}}catch(Ie){if(Ie&&A&&typeof Ie.stack=="string"){for(var H=Ie.stack.split(`
`),Y=A.stack.split(`
`),se=H.length-1,xe=Y.length-1;1<=se&&0<=xe&&H[se]!==Y[xe];)xe--;for(;1<=se&&0<=xe;se--,xe--)if(H[se]!==Y[xe]){if(se!==1||xe!==1)do if(se--,xe--,0>xe||H[se]!==Y[xe]){var Se=`
`+H[se].replace(" at new "," at ");return d.displayName&&Se.includes("<anonymous>")&&(Se=Se.replace("<anonymous>",d.displayName)),Se}while(1<=se&&0<=xe);break}}}finally{ne=!1,Error.prepareStackTrace=C}return(d=d?d.displayName||d.name:"")?te(d):""}function me(d){switch(d.tag){case 5:return te(d.type);case 16:return te("Lazy");case 13:return te("Suspense");case 19:return te("SuspenseList");case 0:case 2:case 15:return d=de(d.type,!1),d;case 11:return d=de(d.type.render,!1),d;case 1:return d=de(d.type,!0),d;default:return""}}function ye(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case D:return"Fragment";case j:return"Portal";case I:return"Profiler";case B:return"StrictMode";case O:return"Suspense";case W:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case $:return(d.displayName||"Context")+".Consumer";case V:return(d._context.displayName||"Context")+".Provider";case Z:var m=d.render;return d=d.displayName,d||(d=m.displayName||m.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case F:return m=d.displayName||null,m!==null?m:ye(d.type)||"Memo";case K:m=d._payload,d=d._init;try{return ye(d(m))}catch{}}return null}function ie(d){var m=d.type;switch(d.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=m.render,d=d.displayName||d.name||"",m.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ye(m);case 8:return m===B?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function pe(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function oe(d){var m=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function fe(d){var m=oe(d)?"checked":"value",C=Object.getOwnPropertyDescriptor(d.constructor.prototype,m),A=""+d[m];if(!d.hasOwnProperty(m)&&typeof C<"u"&&typeof C.get=="function"&&typeof C.set=="function"){var H=C.get,Y=C.set;return Object.defineProperty(d,m,{configurable:!0,get:function(){return H.call(this)},set:function(se){A=""+se,Y.call(this,se)}}),Object.defineProperty(d,m,{enumerable:C.enumerable}),{getValue:function(){return A},setValue:function(se){A=""+se},stopTracking:function(){d._valueTracker=null,delete d[m]}}}}function ge(d){d._valueTracker||(d._valueTracker=fe(d))}function be(d){if(!d)return!1;var m=d._valueTracker;if(!m)return!0;var C=m.getValue(),A="";return d&&(A=oe(d)?d.checked?"true":"false":d.value),d=A,d!==C?(m.setValue(d),!0):!1}function _e(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function De(d,m){var C=m.checked;return re({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:C??d._wrapperState.initialChecked})}function qe(d,m){var C=m.defaultValue==null?"":m.defaultValue,A=m.checked!=null?m.checked:m.defaultChecked;C=pe(m.value!=null?m.value:C),d._wrapperState={initialChecked:A,initialValue:C,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function Ue(d,m){m=m.checked,m!=null&&E(d,"checked",m,!1)}function Ve(d,m){Ue(d,m);var C=pe(m.value),A=m.type;if(C!=null)A==="number"?(C===0&&d.value===""||d.value!=C)&&(d.value=""+C):d.value!==""+C&&(d.value=""+C);else if(A==="submit"||A==="reset"){d.removeAttribute("value");return}m.hasOwnProperty("value")?ft(d,m.type,C):m.hasOwnProperty("defaultValue")&&ft(d,m.type,pe(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(d.defaultChecked=!!m.defaultChecked)}function Je(d,m,C){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var A=m.type;if(!(A!=="submit"&&A!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+d._wrapperState.initialValue,C||m===d.value||(d.value=m),d.defaultValue=m}C=d.name,C!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,C!==""&&(d.name=C)}function ft(d,m,C){(m!=="number"||_e(d.ownerDocument)!==d)&&(C==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+C&&(d.defaultValue=""+C))}var We=Array.isArray;function Ce(d,m,C,A){if(d=d.options,m){m={};for(var H=0;H<C.length;H++)m["$"+C[H]]=!0;for(C=0;C<d.length;C++)H=m.hasOwnProperty("$"+d[C].value),d[C].selected!==H&&(d[C].selected=H),H&&A&&(d[C].defaultSelected=!0)}else{for(C=""+pe(C),m=null,H=0;H<d.length;H++){if(d[H].value===C){d[H].selected=!0,A&&(d[H].defaultSelected=!0);return}m!==null||d[H].disabled||(m=d[H])}m!==null&&(m.selected=!0)}}function ze(d,m){if(m.dangerouslySetInnerHTML!=null)throw Error(r(91));return re({},m,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function Ke(d,m){var C=m.value;if(C==null){if(C=m.children,m=m.defaultValue,C!=null){if(m!=null)throw Error(r(92));if(We(C)){if(1<C.length)throw Error(r(93));C=C[0]}m=C}m==null&&(m=""),C=m}d._wrapperState={initialValue:pe(C)}}function et(d,m){var C=pe(m.value),A=pe(m.defaultValue);C!=null&&(C=""+C,C!==d.value&&(d.value=C),m.defaultValue==null&&d.defaultValue!==C&&(d.defaultValue=C)),A!=null&&(d.defaultValue=""+A)}function ht(d){var m=d.textContent;m===d._wrapperState.initialValue&&m!==""&&m!==null&&(d.value=m)}function Nt(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mt(d,m){return d==null||d==="http://www.w3.org/1999/xhtml"?Nt(m):d==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var jt,Wt=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,C,A,H){MSApp.execUnsafeLocalFunction(function(){return d(m,C,A,H)})}:d})(function(d,m){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=m;else{for(jt=jt||document.createElement("div"),jt.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=jt.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;m.firstChild;)d.appendChild(m.firstChild)}});function xt(d,m){if(m){var C=d.firstChild;if(C&&C===d.lastChild&&C.nodeType===3){C.nodeValue=m;return}}d.textContent=m}var st={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ge=["Webkit","ms","Moz","O"];Object.keys(st).forEach(function(d){Ge.forEach(function(m){m=m+d.charAt(0).toUpperCase()+d.substring(1),st[m]=st[d]})});function ue(d,m,C){return m==null||typeof m=="boolean"||m===""?"":C||typeof m!="number"||m===0||st.hasOwnProperty(d)&&st[d]?(""+m).trim():m+"px"}function ve(d,m){d=d.style;for(var C in m)if(m.hasOwnProperty(C)){var A=C.indexOf("--")===0,H=ue(C,m[C],A);C==="float"&&(C="cssFloat"),A?d.setProperty(C,H):d[C]=H}}var ke=re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ne(d,m){if(m){if(ke[d]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(r(137,d));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(r(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(r(61))}if(m.style!=null&&typeof m.style!="object")throw Error(r(62))}}function je(d,m){if(d.indexOf("-")===-1)return typeof m.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ze=null;function He(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var ut=null,lt=null,_t=null;function Bt(d){if(d=Yo(d)){if(typeof ut!="function")throw Error(r(280));var m=d.stateNode;m&&(m=Vn(m),ut(d.stateNode,d.type,m))}}function zt(d){lt?_t?_t.push(d):_t=[d]:lt=d}function vt(){if(lt){var d=lt,m=_t;if(_t=lt=null,Bt(d),m)for(d=0;d<m.length;d++)Bt(m[d])}}function Ht(d,m){return d(m)}function qt(){}var Sr=!1;function fr(d,m,C){if(Sr)return d(m,C);Sr=!0;try{return Ht(d,m,C)}finally{Sr=!1,(lt!==null||_t!==null)&&(qt(),vt())}}function fn(d,m){var C=d.stateNode;if(C===null)return null;var A=Vn(C);if(A===null)return null;C=A[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(d=d.type,A=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!A;break e;default:d=!1}if(d)return null;if(C&&typeof C!="function")throw Error(r(231,m,typeof C));return C}var Gr=!1;if(o)try{var qr={};Object.defineProperty(qr,"passive",{get:function(){Gr=!0}}),window.addEventListener("test",qr,qr),window.removeEventListener("test",qr,qr)}catch{Gr=!1}function nn(d,m,C,A,H,Y,se,xe,Se){var Ie=Array.prototype.slice.call(arguments,3);try{m.apply(C,Ie)}catch(Xe){this.onError(Xe)}}var ur=!1,yt=null,Lr=!1,Yn=null,Na={onError:function(d){ur=!0,yt=d}};function Ds(d,m,C,A,H,Y,se,xe,Se){ur=!1,yt=null,nn.apply(Na,arguments)}function Js(d,m,C,A,H,Y,se,xe,Se){if(Ds.apply(this,arguments),ur){if(ur){var Ie=yt;ur=!1,yt=null}else throw Error(r(198));Lr||(Lr=!0,Yn=Ie)}}function ui(d){var m=d,C=d;if(d.alternate)for(;m.return;)m=m.return;else{d=m;do m=d,(m.flags&4098)!==0&&(C=m.return),d=m.return;while(d)}return m.tag===3?C:null}function an(d){if(d.tag===13){var m=d.memoizedState;if(m===null&&(d=d.alternate,d!==null&&(m=d.memoizedState)),m!==null)return m.dehydrated}return null}function xn(d){if(ui(d)!==d)throw Error(r(188))}function ci(d){var m=d.alternate;if(!m){if(m=ui(d),m===null)throw Error(r(188));return m!==d?null:d}for(var C=d,A=m;;){var H=C.return;if(H===null)break;var Y=H.alternate;if(Y===null){if(A=H.return,A!==null){C=A;continue}break}if(H.child===Y.child){for(Y=H.child;Y;){if(Y===C)return xn(H),d;if(Y===A)return xn(H),m;Y=Y.sibling}throw Error(r(188))}if(C.return!==A.return)C=H,A=Y;else{for(var se=!1,xe=H.child;xe;){if(xe===C){se=!0,C=H,A=Y;break}if(xe===A){se=!0,A=H,C=Y;break}xe=xe.sibling}if(!se){for(xe=Y.child;xe;){if(xe===C){se=!0,C=Y,A=H;break}if(xe===A){se=!0,A=Y,C=H;break}xe=xe.sibling}if(!se)throw Error(r(189))}}if(C.alternate!==A)throw Error(r(190))}if(C.tag!==3)throw Error(r(188));return C.stateNode.current===C?d:m}function eo(d){return d=ci(d),d!==null?wi(d):null}function wi(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var m=wi(d);if(m!==null)return m;d=d.sibling}return null}var su=e.unstable_scheduleCallback,ou=e.unstable_cancelCallback,Id=e.unstable_shouldYield,fl=e.unstable_requestPaint,Xr=e.unstable_now,lu=e.unstable_getCurrentPriorityLevel,Is=e.unstable_ImmediatePriority,pl=e.unstable_UserBlockingPriority,Ta=e.unstable_NormalPriority,Lo=e.unstable_LowPriority,ea=e.unstable_IdlePriority,ta=null,pn=null;function vr(d){if(pn&&typeof pn.onCommitFiberRoot=="function")try{pn.onCommitFiberRoot(ta,d,void 0,(d.current.flags&128)===128)}catch{}}var ot=Math.clz32?Math.clz32:zr,cr=Math.log,sn=Math.LN2;function zr(d){return d>>>=0,d===0?32:31-(cr(d)/sn|0)|0}var Nr=64,ra=4194304;function Tt(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function yr(d,m){var C=d.pendingLanes;if(C===0)return 0;var A=0,H=d.suspendedLanes,Y=d.pingedLanes,se=C&268435455;if(se!==0){var xe=se&~H;xe!==0?A=Tt(xe):(Y&=se,Y!==0&&(A=Tt(Y)))}else se=C&~H,se!==0?A=Tt(se):Y!==0&&(A=Tt(Y));if(A===0)return 0;if(m!==0&&m!==A&&(m&H)===0&&(H=A&-A,Y=m&-m,H>=Y||H===16&&(Y&4194240)!==0))return m;if((A&4)!==0&&(A|=C&16),m=d.entangledLanes,m!==0)for(d=d.entanglements,m&=A;0<m;)C=31-ot(m),H=1<<C,A|=d[C],m&=~H;return A}function Ju(d,m){switch(d){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uu(d,m){for(var C=d.suspendedLanes,A=d.pingedLanes,H=d.expirationTimes,Y=d.pendingLanes;0<Y;){var se=31-ot(Y),xe=1<<se,Se=H[se];Se===-1?((xe&C)===0||(xe&A)!==0)&&(H[se]=Ju(xe,m)):Se<=m&&(d.expiredLanes|=xe),Y&=~xe}}function Xn(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function Bd(){var d=Nr;return Nr<<=1,(Nr&4194240)===0&&(Nr=64),d}function di(d){for(var m=[],C=0;31>C;C++)m.push(d);return m}function $a(d,m,C){d.pendingLanes|=m,m!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,m=31-ot(m),d[m]=C}function bn(d,m){var C=d.pendingLanes&~m;d.pendingLanes=m,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=m,d.mutableReadLanes&=m,d.entangledLanes&=m,m=d.entanglements;var A=d.eventTimes;for(d=d.expirationTimes;0<C;){var H=31-ot(C),Y=1<<H;m[H]=0,A[H]=-1,d[H]=-1,C&=~Y}}function Bs(d,m){var C=d.entangledLanes|=m;for(d=d.entanglements;C;){var A=31-ot(C),H=1<<A;H&m|d[A]&m&&(d[A]|=m),C&=~H}}var rr=0;function zs(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var to,fs,ec,tc,Oo,ml=!1,ro=[],_i=null,Fs=null,Pa=null,nr=new Map,Gt=new Map,On=[],Tr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zd(d,m){switch(d){case"focusin":case"focusout":_i=null;break;case"dragenter":case"dragleave":Fs=null;break;case"mouseover":case"mouseout":Pa=null;break;case"pointerover":case"pointerout":nr.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gt.delete(m.pointerId)}}function Do(d,m,C,A,H,Y){return d===null||d.nativeEvent!==Y?(d={blockedOn:m,domEventName:C,eventSystemFlags:A,nativeEvent:Y,targetContainers:[H]},m!==null&&(m=Yo(m),m!==null&&fs(m)),d):(d.eventSystemFlags|=A,m=d.targetContainers,H!==null&&m.indexOf(H)===-1&&m.push(H),d)}function wn(d,m,C,A,H){switch(m){case"focusin":return _i=Do(_i,d,m,C,A,H),!0;case"dragenter":return Fs=Do(Fs,d,m,C,A,H),!0;case"mouseover":return Pa=Do(Pa,d,m,C,A,H),!0;case"pointerover":var Y=H.pointerId;return nr.set(Y,Do(nr.get(Y)||null,d,m,C,A,H)),!0;case"gotpointercapture":return Y=H.pointerId,Gt.set(Y,Do(Gt.get(Y)||null,d,m,C,A,H)),!0}return!1}function gl(d){var m=co(d.target);if(m!==null){var C=ui(m);if(C!==null){if(m=C.tag,m===13){if(m=an(C),m!==null){d.blockedOn=m,Oo(d.priority,function(){ec(C)});return}}else if(m===3&&C.stateNode.current.memoizedState.isDehydrated){d.blockedOn=C.tag===3?C.stateNode.containerInfo:null;return}}}d.blockedOn=null}function ps(d){if(d.blockedOn!==null)return!1;for(var m=d.targetContainers;0<m.length;){var C=hu(d.domEventName,d.eventSystemFlags,m[0],d.nativeEvent);if(C===null){C=d.nativeEvent;var A=new C.constructor(C.type,C);Ze=A,C.target.dispatchEvent(A),Ze=null}else return m=Yo(C),m!==null&&fs(m),d.blockedOn=C,!1;m.shift()}return!0}function vl(d,m,C){ps(d)&&C.delete(m)}function cu(){ml=!1,_i!==null&&ps(_i)&&(_i=null),Fs!==null&&ps(Fs)&&(Fs=null),Pa!==null&&ps(Pa)&&(Pa=null),nr.forEach(vl),Gt.forEach(vl)}function Wr(d,m){d.blockedOn===m&&(d.blockedOn=null,ml||(ml=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,cu)))}function _n(d){function m(H){return Wr(H,d)}if(0<ro.length){Wr(ro[0],d);for(var C=1;C<ro.length;C++){var A=ro[C];A.blockedOn===d&&(A.blockedOn=null)}}for(_i!==null&&Wr(_i,d),Fs!==null&&Wr(Fs,d),Pa!==null&&Wr(Pa,d),nr.forEach(m),Gt.forEach(m),C=0;C<On.length;C++)A=On[C],A.blockedOn===d&&(A.blockedOn=null);for(;0<On.length&&(C=On[0],C.blockedOn===null);)gl(C),C.blockedOn===null&&On.shift()}var Io=T.ReactCurrentBatchConfig,du=!0;function Ka(d,m,C,A){var H=rr,Y=Io.transition;Io.transition=null;try{rr=1,no(d,m,C,A)}finally{rr=H,Io.transition=Y}}function ms(d,m,C,A){var H=rr,Y=Io.transition;Io.transition=null;try{rr=4,no(d,m,C,A)}finally{rr=H,Io.transition=Y}}function no(d,m,C,A){if(du){var H=hu(d,m,C,A);if(H===null)h(d,m,A,yl,C),zd(d,A);else if(wn(H,d,m,C,A))A.stopPropagation();else if(zd(d,A),m&4&&-1<Tr.indexOf(d)){for(;H!==null;){var Y=Yo(H);if(Y!==null&&to(Y),Y=hu(d,m,C,A),Y===null&&h(d,m,A,yl,C),Y===H)break;H=Y}H!==null&&A.stopPropagation()}else h(d,m,A,null,C)}}var yl=null;function hu(d,m,C,A){if(yl=null,d=He(A),d=co(d),d!==null)if(m=ui(d),m===null)d=null;else if(C=m.tag,C===13){if(d=an(m),d!==null)return d;d=null}else if(C===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;d=null}else m!==d&&(d=null);return yl=d,null}function sr(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lu()){case Is:return 1;case pl:return 4;case Ta:case Lo:return 16;case ea:return 536870912;default:return 16}default:return 16}}var Qn=null,zn=null,na=null;function xl(){if(na)return na;var d,m=zn,C=m.length,A,H="value"in Qn?Qn.value:Qn.textContent,Y=H.length;for(d=0;d<C&&m[d]===H[d];d++);var se=C-d;for(A=1;A<=se&&m[C-A]===H[Y-A];A++);return na=H.slice(d,1<A?1-A:void 0)}function Bo(d){var m=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&m===13&&(d=13)):d=m,d===10&&(d=13),32<=d||d===13?d:0}function Jn(){return!0}function ia(){return!1}function Sn(d){function m(C,A,H,Y,se){this._reactName=C,this._targetInst=H,this.type=A,this.nativeEvent=Y,this.target=se,this.currentTarget=null;for(var xe in d)d.hasOwnProperty(xe)&&(C=d[xe],this[xe]=C?C(Y):Y[xe]);return this.isDefaultPrevented=(Y.defaultPrevented!=null?Y.defaultPrevented:Y.returnValue===!1)?Jn:ia,this.isPropagationStopped=ia,this}return re(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var C=this.nativeEvent;C&&(C.preventDefault?C.preventDefault():typeof C.returnValue!="unknown"&&(C.returnValue=!1),this.isDefaultPrevented=Jn)},stopPropagation:function(){var C=this.nativeEvent;C&&(C.stopPropagation?C.stopPropagation():typeof C.cancelBubble!="unknown"&&(C.cancelBubble=!0),this.isPropagationStopped=Jn)},persist:function(){},isPersistent:Jn}),m}var ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Za=Sn(ji),aa=re({},ji,{view:0,detail:0}),Jh=Sn(aa),Ri,fu,Fn,on=re({},aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ya,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Fn&&(Fn&&d.type==="mousemove"?(Ri=d.screenX-Fn.screenX,fu=d.screenY-Fn.screenY):fu=Ri=0,Fn=d),Ri)},movementY:function(d){return"movementY"in d?d.movementY:fu}}),Or=Sn(on),bl=re({},on,{dataTransfer:0}),sa=Sn(bl),ef=re({},aa,{relatedTarget:0}),pu=Sn(ef),rc=re({},ji,{animationName:0,elapsedTime:0,pseudoElement:0}),Fd=Sn(rc),tf=re({},ji,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),wl=Sn(tf),rf=re({},ji,{data:0}),io=Sn(rf),nc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ic={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rp(d){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(d):(d=gs[d])?!!m[d]:!1}function Ya(){return Rp}var Si=re({},aa,{key:function(d){if(d.key){var m=nc[d.key]||d.key;if(m!=="Unidentified")return m}return d.type==="keypress"?(d=Bo(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?ic[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ya,charCode:function(d){return d.type==="keypress"?Bo(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?Bo(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Vd=Sn(Si),Ud=re({},on,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zo=Sn(Ud),ac=re({},aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ya}),_l=Sn(ac),sc=re({},ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sl=Sn(sc),oc=re({},on,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Hd=Sn(oc),Ma=[9,13,27,32],vs=o&&"CompositionEvent"in window,Fo=null;o&&"documentMode"in document&&(Fo=document.documentMode);var Li=o&&"TextEvent"in window&&!Fo,oa=o&&(!vs||Fo&&8<Fo&&11>=Fo),la=" ",lc=!1;function Vo(d,m){switch(d){case"keyup":return Ma.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Aa(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var hi=!1;function Gd(d,m){switch(d){case"compositionend":return Aa(m);case"keypress":return m.which!==32?null:(lc=!0,la);case"textInput":return d=m.data,d===la&&lc?null:d;default:return null}}function Vs(d,m){if(hi)return d==="compositionend"||!vs&&Vo(d,m)?(d=xl(),na=zn=Qn=null,hi=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return oa&&m.locale!=="ko"?null:m.data;default:return null}}var ja={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Us(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m==="input"?!!ja[d.type]:m==="textarea"}function Uo(d,m,C,A){zt(A),m=P(m,"onChange"),0<m.length&&(C=new Za("onChange","change",null,C,A),d.push({event:C,listeners:m}))}var kl=null,fi=null;function nf(d){pc(d,0)}function ua(d){var m=Nn(d);if(be(m))return d}function Ra(d,m){if(d==="change")return m}var Oi=!1;if(o){var Xa;if(o){var ca="oninput"in document;if(!ca){var Cl=document.createElement("div");Cl.setAttribute("oninput","return;"),ca=typeof Cl.oninput=="function"}Xa=ca}else Xa=!1;Oi=Xa&&(!document.documentMode||9<document.documentMode)}function ys(){kl&&(kl.detachEvent("onpropertychange",mu),fi=kl=null)}function mu(d){if(d.propertyName==="value"&&ua(fi)){var m=[];Uo(m,fi,d,He(d)),fr(nf,m)}}function El(d,m,C){d==="focusin"?(ys(),kl=m,fi=C,kl.attachEvent("onpropertychange",mu)):d==="focusout"&&ys()}function kr(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return ua(fi)}function Ho(d,m){if(d==="click")return ua(m)}function gu(d,m){if(d==="input"||d==="change")return ua(m)}function uc(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var Di=typeof Object.is=="function"?Object.is:uc;function xs(d,m){if(Di(d,m))return!0;if(typeof d!="object"||d===null||typeof m!="object"||m===null)return!1;var C=Object.keys(d),A=Object.keys(m);if(C.length!==A.length)return!1;for(A=0;A<C.length;A++){var H=C[A];if(!l.call(m,H)||!Di(d[H],m[H]))return!1}return!0}function ao(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function Fr(d,m){var C=ao(d);d=0;for(var A;C;){if(C.nodeType===3){if(A=d+C.textContent.length,d<=m&&A>=m)return{node:C,offset:m-d};d=A}e:{for(;C;){if(C.nextSibling){C=C.nextSibling;break e}C=C.parentNode}C=void 0}C=ao(C)}}function kn(d,m){return d&&m?d===m?!0:d&&d.nodeType===3?!1:m&&m.nodeType===3?kn(d,m.parentNode):"contains"in d?d.contains(m):d.compareDocumentPosition?!!(d.compareDocumentPosition(m)&16):!1:!1}function Cn(){for(var d=window,m=_e();m instanceof d.HTMLIFrameElement;){try{var C=typeof m.contentWindow.location.href=="string"}catch{C=!1}if(C)d=m.contentWindow;else break;m=_e(d.document)}return m}function Nl(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m&&(m==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||m==="textarea"||d.contentEditable==="true")}function Ii(d){var m=Cn(),C=d.focusedElem,A=d.selectionRange;if(m!==C&&C&&C.ownerDocument&&kn(C.ownerDocument.documentElement,C)){if(A!==null&&Nl(C)){if(m=A.start,d=A.end,d===void 0&&(d=m),"selectionStart"in C)C.selectionStart=m,C.selectionEnd=Math.min(d,C.value.length);else if(d=(m=C.ownerDocument||document)&&m.defaultView||window,d.getSelection){d=d.getSelection();var H=C.textContent.length,Y=Math.min(A.start,H);A=A.end===void 0?Y:Math.min(A.end,H),!d.extend&&Y>A&&(H=A,A=Y,Y=H),H=Fr(C,Y);var se=Fr(C,A);H&&se&&(d.rangeCount!==1||d.anchorNode!==H.node||d.anchorOffset!==H.offset||d.focusNode!==se.node||d.focusOffset!==se.offset)&&(m=m.createRange(),m.setStart(H.node,H.offset),d.removeAllRanges(),Y>A?(d.addRange(m),d.extend(se.node,se.offset)):(m.setEnd(se.node,se.offset),d.addRange(m)))}}for(m=[],d=C;d=d.parentNode;)d.nodeType===1&&m.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<m.length;C++)d=m[C],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var so=o&&"documentMode"in document&&11>=document.documentMode,Tl=null,mn=null,Go=null,Pl=!1;function cc(d,m,C){var A=C.window===C?C.document:C.nodeType===9?C:C.ownerDocument;Pl||Tl==null||Tl!==_e(A)||(A=Tl,"selectionStart"in A&&Nl(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),Go&&xs(Go,A)||(Go=A,A=P(mn,"onSelect"),0<A.length&&(m=new Za("onSelect","select",null,m,C),d.push({event:m,listeners:A}),m.target=Tl)))}function ei(d,m){var C={};return C[d.toLowerCase()]=m.toLowerCase(),C["Webkit"+d]="webkit"+m,C["Moz"+d]="moz"+m,C}var ti={animationend:ei("Animation","AnimationEnd"),animationiteration:ei("Animation","AnimationIteration"),animationstart:ei("Animation","AnimationStart"),transitionend:ei("Transition","TransitionEnd")},La={},vu={};o&&(vu=document.createElement("div").style,"AnimationEvent"in window||(delete ti.animationend.animation,delete ti.animationiteration.animation,delete ti.animationstart.animation),"TransitionEvent"in window||delete ti.transitionend.transition);function qo(d){if(La[d])return La[d];if(!ti[d])return d;var m=ti[d],C;for(C in m)if(m.hasOwnProperty(C)&&C in vu)return La[d]=m[C];return d}var qd=qo("animationend"),Qa=qo("animationiteration"),dc=qo("animationstart"),hc=qo("transitionend"),Wo=new Map,Wd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oa(d,m){Wo.set(d,m),a(m,[d])}for(var oo=0;oo<Wd.length;oo++){var lo=Wd[oo],$d=lo.toLowerCase(),fc=lo[0].toUpperCase()+lo.slice(1);Oa($d,"on"+fc)}Oa(qd,"onAnimationEnd"),Oa(Qa,"onAnimationIteration"),Oa(dc,"onAnimationStart"),Oa("dblclick","onDoubleClick"),Oa("focusin","onFocus"),Oa("focusout","onBlur"),Oa(hc,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Kd=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hs));function yu(d,m,C){var A=d.type||"unknown-event";d.currentTarget=C,Js(A,m,void 0,d),d.currentTarget=null}function pc(d,m){m=(m&4)!==0;for(var C=0;C<d.length;C++){var A=d[C],H=A.event;A=A.listeners;e:{var Y=void 0;if(m)for(var se=A.length-1;0<=se;se--){var xe=A[se],Se=xe.instance,Ie=xe.currentTarget;if(xe=xe.listener,Se!==Y&&H.isPropagationStopped())break e;yu(H,xe,Ie),Y=Se}else for(se=0;se<A.length;se++){if(xe=A[se],Se=xe.instance,Ie=xe.currentTarget,xe=xe.listener,Se!==Y&&H.isPropagationStopped())break e;yu(H,xe,Ie),Y=Se}}}if(Lr)throw d=Yn,Lr=!1,Yn=null,d}function Pr(d,m){var C=m[Zo];C===void 0&&(C=m[Zo]=new Set);var A=d+"__bubble";C.has(A)||(Zd(m,d,2,!1),C.add(A))}function mc(d,m,C){var A=0;m&&(A|=4),Zd(C,d,A,m)}var Ml="_reactListening"+Math.random().toString(36).slice(2);function uo(d){if(!d[Ml]){d[Ml]=!0,n.forEach(function(C){C!=="selectionchange"&&(Kd.has(C)||mc(C,!1,d),mc(C,!0,d))});var m=d.nodeType===9?d:d.ownerDocument;m===null||m[Ml]||(m[Ml]=!0,mc("selectionchange",!1,m))}}function Zd(d,m,C,A){switch(sr(m)){case 1:var H=Ka;break;case 4:H=ms;break;default:H=no}C=H.bind(null,m,C,d),H=void 0,!Gr||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(H=!0),A?H!==void 0?d.addEventListener(m,C,{capture:!0,passive:H}):d.addEventListener(m,C,!0):H!==void 0?d.addEventListener(m,C,{passive:H}):d.addEventListener(m,C,!1)}function h(d,m,C,A,H){var Y=A;if((m&1)===0&&(m&2)===0&&A!==null)e:for(;;){if(A===null)return;var se=A.tag;if(se===3||se===4){var xe=A.stateNode.containerInfo;if(xe===H||xe.nodeType===8&&xe.parentNode===H)break;if(se===4)for(se=A.return;se!==null;){var Se=se.tag;if((Se===3||Se===4)&&(Se=se.stateNode.containerInfo,Se===H||Se.nodeType===8&&Se.parentNode===H))return;se=se.return}for(;xe!==null;){if(se=co(xe),se===null)return;if(Se=se.tag,Se===5||Se===6){A=Y=se;continue e}xe=xe.parentNode}}A=A.return}fr(function(){var Ie=Y,Xe=He(C),tt=[];e:{var Ye=Wo.get(d);if(Ye!==void 0){var bt=Za,Et=d;switch(d){case"keypress":if(Bo(C)===0)break e;case"keydown":case"keyup":bt=Vd;break;case"focusin":Et="focus",bt=pu;break;case"focusout":Et="blur",bt=pu;break;case"beforeblur":case"afterblur":bt=pu;break;case"click":if(C.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":bt=Or;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":bt=sa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":bt=_l;break;case qd:case Qa:case dc:bt=Fd;break;case hc:bt=Sl;break;case"scroll":bt=Jh;break;case"wheel":bt=Hd;break;case"copy":case"cut":case"paste":bt=wl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":bt=zo}var Pt=(m&4)!==0,ai=!Pt&&d==="scroll",Ae=Pt?Ye!==null?Ye+"Capture":null:Ye;Pt=[];for(var Ee=Ie,Re;Ee!==null;){Re=Ee;var at=Re.stateNode;if(Re.tag===5&&at!==null&&(Re=at,Ae!==null&&(at=fn(Ee,Ae),at!=null&&Pt.push(w(Ee,at,Re)))),ai)break;Ee=Ee.return}0<Pt.length&&(Ye=new bt(Ye,Et,null,C,Xe),tt.push({event:Ye,listeners:Pt}))}}if((m&7)===0){e:{if(Ye=d==="mouseover"||d==="pointerover",bt=d==="mouseout"||d==="pointerout",Ye&&C!==Ze&&(Et=C.relatedTarget||C.fromElement)&&(co(Et)||Et[xr]))break e;if((bt||Ye)&&(Ye=Xe.window===Xe?Xe:(Ye=Xe.ownerDocument)?Ye.defaultView||Ye.parentWindow:window,bt?(Et=C.relatedTarget||C.toElement,bt=Ie,Et=Et?co(Et):null,Et!==null&&(ai=ui(Et),Et!==ai||Et.tag!==5&&Et.tag!==6)&&(Et=null)):(bt=null,Et=Ie),bt!==Et)){if(Pt=Or,at="onMouseLeave",Ae="onMouseEnter",Ee="mouse",(d==="pointerout"||d==="pointerover")&&(Pt=zo,at="onPointerLeave",Ae="onPointerEnter",Ee="pointer"),ai=bt==null?Ye:Nn(bt),Re=Et==null?Ye:Nn(Et),Ye=new Pt(at,Ee+"leave",bt,C,Xe),Ye.target=ai,Ye.relatedTarget=Re,at=null,co(Xe)===Ie&&(Pt=new Pt(Ae,Ee+"enter",Et,C,Xe),Pt.target=Re,Pt.relatedTarget=ai,at=Pt),ai=at,bt&&Et)t:{for(Pt=bt,Ae=Et,Ee=0,Re=Pt;Re;Re=U(Re))Ee++;for(Re=0,at=Ae;at;at=U(at))Re++;for(;0<Ee-Re;)Pt=U(Pt),Ee--;for(;0<Re-Ee;)Ae=U(Ae),Re--;for(;Ee--;){if(Pt===Ae||Ae!==null&&Pt===Ae.alternate)break t;Pt=U(Pt),Ae=U(Ae)}Pt=null}else Pt=null;bt!==null&&J(tt,Ye,bt,Pt,!1),Et!==null&&ai!==null&&J(tt,ai,Et,Pt,!0)}}e:{if(Ye=Ie?Nn(Ie):window,bt=Ye.nodeName&&Ye.nodeName.toLowerCase(),bt==="select"||bt==="input"&&Ye.type==="file")var At=Ra;else if(Us(Ye))if(Oi)At=gu;else{At=kr;var Ft=El}else(bt=Ye.nodeName)&&bt.toLowerCase()==="input"&&(Ye.type==="checkbox"||Ye.type==="radio")&&(At=Ho);if(At&&(At=At(d,Ie))){Uo(tt,At,C,Xe);break e}Ft&&Ft(d,Ye,Ie),d==="focusout"&&(Ft=Ye._wrapperState)&&Ft.controlled&&Ye.type==="number"&&ft(Ye,"number",Ye.value)}switch(Ft=Ie?Nn(Ie):window,d){case"focusin":(Us(Ft)||Ft.contentEditable==="true")&&(Tl=Ft,mn=Ie,Go=null);break;case"focusout":Go=mn=Tl=null;break;case"mousedown":Pl=!0;break;case"contextmenu":case"mouseup":case"dragend":Pl=!1,cc(tt,C,Xe);break;case"selectionchange":if(so)break;case"keydown":case"keyup":cc(tt,C,Xe)}var Vt;if(vs)e:{switch(d){case"compositionstart":var $t="onCompositionStart";break e;case"compositionend":$t="onCompositionEnd";break e;case"compositionupdate":$t="onCompositionUpdate";break e}$t=void 0}else hi?Vo(d,C)&&($t="onCompositionEnd"):d==="keydown"&&C.keyCode===229&&($t="onCompositionStart");$t&&(oa&&C.locale!=="ko"&&(hi||$t!=="onCompositionStart"?$t==="onCompositionEnd"&&hi&&(Vt=xl()):(Qn=Xe,zn="value"in Qn?Qn.value:Qn.textContent,hi=!0)),Ft=P(Ie,$t),0<Ft.length&&($t=new io($t,d,null,C,Xe),tt.push({event:$t,listeners:Ft}),Vt?$t.data=Vt:(Vt=Aa(C),Vt!==null&&($t.data=Vt)))),(Vt=Li?Gd(d,C):Vs(d,C))&&(Ie=P(Ie,"onBeforeInput"),0<Ie.length&&(Xe=new io("onBeforeInput","beforeinput",null,C,Xe),tt.push({event:Xe,listeners:Ie}),Xe.data=Vt))}pc(tt,m)})}function w(d,m,C){return{instance:d,listener:m,currentTarget:C}}function P(d,m){for(var C=m+"Capture",A=[];d!==null;){var H=d,Y=H.stateNode;H.tag===5&&Y!==null&&(H=Y,Y=fn(d,C),Y!=null&&A.unshift(w(d,Y,H)),Y=fn(d,m),Y!=null&&A.push(w(d,Y,H))),d=d.return}return A}function U(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function J(d,m,C,A,H){for(var Y=m._reactName,se=[];C!==null&&C!==A;){var xe=C,Se=xe.alternate,Ie=xe.stateNode;if(Se!==null&&Se===A)break;xe.tag===5&&Ie!==null&&(xe=Ie,H?(Se=fn(C,Y),Se!=null&&se.unshift(w(C,Se,xe))):H||(Se=fn(C,Y),Se!=null&&se.push(w(C,Se,xe)))),C=C.return}se.length!==0&&d.push({event:m,listeners:se})}var le=/\r\n?/g,we=/\u0000|\uFFFD/g;function Me(d){return(typeof d=="string"?d:""+d).replace(le,`
`).replace(we,"")}function Le(d,m,C){if(m=Me(m),Me(d)!==m&&C)throw Error(r(425))}function $e(){}var pt=null,Dt=null;function Xt(d,m){return d==="textarea"||d==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var Mr=typeof setTimeout=="function"?setTimeout:void 0,En=typeof clearTimeout=="function"?clearTimeout:void 0,pi=typeof Promise=="function"?Promise:void 0,ki=typeof queueMicrotask=="function"?queueMicrotask:typeof pi<"u"?function(d){return pi.resolve(null).then(d).catch($o)}:Mr;function $o(d){setTimeout(function(){throw d})}function gc(d,m){var C=m,A=0;do{var H=C.nextSibling;if(d.removeChild(C),H&&H.nodeType===8)if(C=H.data,C==="/$"){if(A===0){d.removeChild(H),_n(m);return}A--}else C!=="$"&&C!=="$?"&&C!=="$!"||A++;C=H}while(C);_n(m)}function bs(d){for(;d!=null;d=d.nextSibling){var m=d.nodeType;if(m===1||m===3)break;if(m===8){if(m=d.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return d}function Ko(d){d=d.previousSibling;for(var m=0;d;){if(d.nodeType===8){var C=d.data;if(C==="$"||C==="$!"||C==="$?"){if(m===0)return d;m--}else C==="/$"&&m++}d=d.previousSibling}return null}var Gs=Math.random().toString(36).slice(2),Da="__reactFiber$"+Gs,Al="__reactProps$"+Gs,xr="__reactContainer$"+Gs,Zo="__reactEvents$"+Gs,af="__reactListeners$"+Gs,sf="__reactHandles$"+Gs;function co(d){var m=d[Da];if(m)return m;for(var C=d.parentNode;C;){if(m=C[xr]||C[Da]){if(C=m.alternate,m.child!==null||C!==null&&C.child!==null)for(d=Ko(d);d!==null;){if(C=d[Da])return C;d=Ko(d)}return m}d=C,C=d.parentNode}return null}function Yo(d){return d=d[Da]||d[xr],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function Nn(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(r(33))}function Vn(d){return d[Al]||null}var of=[],xu=-1;function Xo(d){return{current:d}}function $r(d){0>xu||(d.current=of[xu],of[xu]=null,xu--)}function Vr(d,m){xu++,of[xu]=d.current,d.current=m}var ho={},Ci=Xo(ho),Bi=Xo(!1),jl=ho;function bu(d,m){var C=d.type.contextTypes;if(!C)return ho;var A=d.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===m)return A.__reactInternalMemoizedMaskedChildContext;var H={},Y;for(Y in C)H[Y]=m[Y];return A&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=m,d.__reactInternalMemoizedMaskedChildContext=H),H}function zi(d){return d=d.childContextTypes,d!=null}function vc(){$r(Bi),$r(Ci)}function Lp(d,m,C){if(Ci.current!==ho)throw Error(r(168));Vr(Ci,m),Vr(Bi,C)}function lf(d,m,C){var A=d.stateNode;if(m=m.childContextTypes,typeof A.getChildContext!="function")return C;A=A.getChildContext();for(var H in A)if(!(H in m))throw Error(r(108,ie(d)||"Unknown",H));return re({},C,A)}function wu(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||ho,jl=Ci.current,Vr(Ci,d),Vr(Bi,Bi.current),!0}function Sv(d,m,C){var A=d.stateNode;if(!A)throw Error(r(169));C?(d=lf(d,m,jl),A.__reactInternalMemoizedMergedChildContext=d,$r(Bi),$r(Ci),Vr(Ci,d)):$r(Bi),Vr(Bi,C)}var fo=null,yc=!1,uf=!1;function Yd(d){fo===null?fo=[d]:fo.push(d)}function Qo(d){yc=!0,Yd(d)}function Rl(){if(!uf&&fo!==null){uf=!0;var d=0,m=rr;try{var C=fo;for(rr=1;d<C.length;d++){var A=C[d];do A=A(!0);while(A!==null)}fo=null,yc=!1}catch(H){throw fo!==null&&(fo=fo.slice(d+1)),su(Is,Rl),H}finally{rr=m,uf=!1}}return null}var da=[],_u=0,Ll=null,Ol=0,ha=[],fa=0,Dl=null,Ja=1,ln="";function Su(d,m){da[_u++]=Ol,da[_u++]=Ll,Ll=d,Ol=m}function kv(d,m,C){ha[fa++]=Ja,ha[fa++]=ln,ha[fa++]=Dl,Dl=d;var A=Ja;d=ln;var H=32-ot(A)-1;A&=~(1<<H),C+=1;var Y=32-ot(m)+H;if(30<Y){var se=H-H%5;Y=(A&(1<<se)-1).toString(32),A>>=se,H-=se,Ja=1<<32-ot(m)+H|C<<H|A,ln=Y+d}else Ja=1<<Y|C<<H|A,ln=d}function xc(d){d.return!==null&&(Su(d,1),kv(d,1,0))}function mi(d){for(;d===Ll;)Ll=da[--_u],da[_u]=null,Ol=da[--_u],da[_u]=null;for(;d===Dl;)Dl=ha[--fa],ha[fa]=null,ln=ha[--fa],ha[fa]=null,Ja=ha[--fa],ha[fa]=null}var es=null,ct=null,Ar=!1,ts=null;function Op(d,m){var C=bo(5,null,null,0);C.elementType="DELETED",C.stateNode=m,C.return=d,m=d.deletions,m===null?(d.deletions=[C],d.flags|=16):m.push(C)}function Cv(d,m){switch(d.tag){case 5:var C=d.type;return m=m.nodeType!==1||C.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(d.stateNode=m,es=d,ct=bs(m.firstChild),!0):!1;case 6:return m=d.pendingProps===""||m.nodeType!==3?null:m,m!==null?(d.stateNode=m,es=d,ct=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(C=Dl!==null?{id:Ja,overflow:ln}:null,d.memoizedState={dehydrated:m,treeContext:C,retryLane:1073741824},C=bo(18,null,null,0),C.stateNode=m,C.return=d,d.child=C,es=d,ct=null,!0):!1;default:return!1}}function ku(d){return(d.mode&1)!==0&&(d.flags&128)===0}function bc(d){if(Ar){var m=ct;if(m){var C=m;if(!Cv(d,m)){if(ku(d))throw Error(r(418));m=bs(C.nextSibling);var A=es;m&&Cv(d,m)?Op(A,C):(d.flags=d.flags&-4097|2,Ar=!1,es=d)}}else{if(ku(d))throw Error(r(418));d.flags=d.flags&-4097|2,Ar=!1,es=d}}}function cf(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;es=d}function Xd(d){if(d!==es)return!1;if(!Ar)return cf(d),Ar=!0,!1;var m;if((m=d.tag!==3)&&!(m=d.tag!==5)&&(m=d.type,m=m!=="head"&&m!=="body"&&!Xt(d.type,d.memoizedProps)),m&&(m=ct)){if(ku(d))throw Dp(),Error(r(418));for(;m;)Op(d,m),m=bs(m.nextSibling)}if(cf(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));e:{for(d=d.nextSibling,m=0;d;){if(d.nodeType===8){var C=d.data;if(C==="/$"){if(m===0){ct=bs(d.nextSibling);break e}m--}else C!=="$"&&C!=="$!"&&C!=="$?"||m++}d=d.nextSibling}ct=null}}else ct=es?bs(d.stateNode.nextSibling):null;return!0}function Dp(){for(var d=ct;d;)d=bs(d.nextSibling)}function Cu(){ct=es=null,Ar=!1}function Qd(d){ts===null?ts=[d]:ts.push(d)}var Ip=T.ReactCurrentBatchConfig;function Dn(d,m,C){if(d=C.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(C._owner){if(C=C._owner,C){if(C.tag!==1)throw Error(r(309));var A=C.stateNode}if(!A)throw Error(r(147,d));var H=A,Y=""+d;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===Y?m.ref:(m=function(se){var xe=H.refs;se===null?delete xe[Y]:xe[Y]=se},m._stringRef=Y,m)}if(typeof d!="string")throw Error(r(284));if(!C._owner)throw Error(r(290,d))}return d}function Ia(d,m){throw d=Object.prototype.toString.call(m),Error(r(31,d==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":d))}function qs(d){var m=d._init;return m(d._payload)}function df(d){function m(Ae,Ee){if(d){var Re=Ae.deletions;Re===null?(Ae.deletions=[Ee],Ae.flags|=16):Re.push(Ee)}}function C(Ae,Ee){if(!d)return null;for(;Ee!==null;)m(Ae,Ee),Ee=Ee.sibling;return null}function A(Ae,Ee){for(Ae=new Map;Ee!==null;)Ee.key!==null?Ae.set(Ee.key,Ee):Ae.set(Ee.index,Ee),Ee=Ee.sibling;return Ae}function H(Ae,Ee){return Ae=Fc(Ae,Ee),Ae.index=0,Ae.sibling=null,Ae}function Y(Ae,Ee,Re){return Ae.index=Re,d?(Re=Ae.alternate,Re!==null?(Re=Re.index,Re<Ee?(Ae.flags|=2,Ee):Re):(Ae.flags|=2,Ee)):(Ae.flags|=1048576,Ee)}function se(Ae){return d&&Ae.alternate===null&&(Ae.flags|=2),Ae}function xe(Ae,Ee,Re,at){return Ee===null||Ee.tag!==6?(Ee=g1(Re,Ae.mode,at),Ee.return=Ae,Ee):(Ee=H(Ee,Re),Ee.return=Ae,Ee)}function Se(Ae,Ee,Re,at){var At=Re.type;return At===D?Xe(Ae,Ee,Re.props.children,at,Re.key):Ee!==null&&(Ee.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===K&&qs(At)===Ee.type)?(at=H(Ee,Re.props),at.ref=Dn(Ae,Ee,Re),at.return=Ae,at):(at=Wv(Re.type,Re.key,Re.props,null,Ae.mode,at),at.ref=Dn(Ae,Ee,Re),at.return=Ae,at)}function Ie(Ae,Ee,Re,at){return Ee===null||Ee.tag!==4||Ee.stateNode.containerInfo!==Re.containerInfo||Ee.stateNode.implementation!==Re.implementation?(Ee=v1(Re,Ae.mode,at),Ee.return=Ae,Ee):(Ee=H(Ee,Re.children||[]),Ee.return=Ae,Ee)}function Xe(Ae,Ee,Re,at,At){return Ee===null||Ee.tag!==7?(Ee=uh(Re,Ae.mode,at,At),Ee.return=Ae,Ee):(Ee=H(Ee,Re),Ee.return=Ae,Ee)}function tt(Ae,Ee,Re){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return Ee=g1(""+Ee,Ae.mode,Re),Ee.return=Ae,Ee;if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case R:return Re=Wv(Ee.type,Ee.key,Ee.props,null,Ae.mode,Re),Re.ref=Dn(Ae,null,Ee),Re.return=Ae,Re;case j:return Ee=v1(Ee,Ae.mode,Re),Ee.return=Ae,Ee;case K:var at=Ee._init;return tt(Ae,at(Ee._payload),Re)}if(We(Ee)||ae(Ee))return Ee=uh(Ee,Ae.mode,Re,null),Ee.return=Ae,Ee;Ia(Ae,Ee)}return null}function Ye(Ae,Ee,Re,at){var At=Ee!==null?Ee.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number")return At!==null?null:xe(Ae,Ee,""+Re,at);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case R:return Re.key===At?Se(Ae,Ee,Re,at):null;case j:return Re.key===At?Ie(Ae,Ee,Re,at):null;case K:return At=Re._init,Ye(Ae,Ee,At(Re._payload),at)}if(We(Re)||ae(Re))return At!==null?null:Xe(Ae,Ee,Re,at,null);Ia(Ae,Re)}return null}function bt(Ae,Ee,Re,at,At){if(typeof at=="string"&&at!==""||typeof at=="number")return Ae=Ae.get(Re)||null,xe(Ee,Ae,""+at,At);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case R:return Ae=Ae.get(at.key===null?Re:at.key)||null,Se(Ee,Ae,at,At);case j:return Ae=Ae.get(at.key===null?Re:at.key)||null,Ie(Ee,Ae,at,At);case K:var Ft=at._init;return bt(Ae,Ee,Re,Ft(at._payload),At)}if(We(at)||ae(at))return Ae=Ae.get(Re)||null,Xe(Ee,Ae,at,At,null);Ia(Ee,at)}return null}function Et(Ae,Ee,Re,at){for(var At=null,Ft=null,Vt=Ee,$t=Ee=0,qi=null;Vt!==null&&$t<Re.length;$t++){Vt.index>$t?(qi=Vt,Vt=null):qi=Vt.sibling;var Cr=Ye(Ae,Vt,Re[$t],at);if(Cr===null){Vt===null&&(Vt=qi);break}d&&Vt&&Cr.alternate===null&&m(Ae,Vt),Ee=Y(Cr,Ee,$t),Ft===null?At=Cr:Ft.sibling=Cr,Ft=Cr,Vt=qi}if($t===Re.length)return C(Ae,Vt),Ar&&Su(Ae,$t),At;if(Vt===null){for(;$t<Re.length;$t++)Vt=tt(Ae,Re[$t],at),Vt!==null&&(Ee=Y(Vt,Ee,$t),Ft===null?At=Vt:Ft.sibling=Vt,Ft=Vt);return Ar&&Su(Ae,$t),At}for(Vt=A(Ae,Vt);$t<Re.length;$t++)qi=bt(Vt,Ae,$t,Re[$t],at),qi!==null&&(d&&qi.alternate!==null&&Vt.delete(qi.key===null?$t:qi.key),Ee=Y(qi,Ee,$t),Ft===null?At=qi:Ft.sibling=qi,Ft=qi);return d&&Vt.forEach(function(Vc){return m(Ae,Vc)}),Ar&&Su(Ae,$t),At}function Pt(Ae,Ee,Re,at){var At=ae(Re);if(typeof At!="function")throw Error(r(150));if(Re=At.call(Re),Re==null)throw Error(r(151));for(var Ft=At=null,Vt=Ee,$t=Ee=0,qi=null,Cr=Re.next();Vt!==null&&!Cr.done;$t++,Cr=Re.next()){Vt.index>$t?(qi=Vt,Vt=null):qi=Vt.sibling;var Vc=Ye(Ae,Vt,Cr.value,at);if(Vc===null){Vt===null&&(Vt=qi);break}d&&Vt&&Vc.alternate===null&&m(Ae,Vt),Ee=Y(Vc,Ee,$t),Ft===null?At=Vc:Ft.sibling=Vc,Ft=Vc,Vt=qi}if(Cr.done)return C(Ae,Vt),Ar&&Su(Ae,$t),At;if(Vt===null){for(;!Cr.done;$t++,Cr=Re.next())Cr=tt(Ae,Cr.value,at),Cr!==null&&(Ee=Y(Cr,Ee,$t),Ft===null?At=Cr:Ft.sibling=Cr,Ft=Cr);return Ar&&Su(Ae,$t),At}for(Vt=A(Ae,Vt);!Cr.done;$t++,Cr=Re.next())Cr=bt(Vt,Ae,$t,Cr.value,at),Cr!==null&&(d&&Cr.alternate!==null&&Vt.delete(Cr.key===null?$t:Cr.key),Ee=Y(Cr,Ee,$t),Ft===null?At=Cr:Ft.sibling=Cr,Ft=Cr);return d&&Vt.forEach(function(eR){return m(Ae,eR)}),Ar&&Su(Ae,$t),At}function ai(Ae,Ee,Re,at){if(typeof Re=="object"&&Re!==null&&Re.type===D&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case R:e:{for(var At=Re.key,Ft=Ee;Ft!==null;){if(Ft.key===At){if(At=Re.type,At===D){if(Ft.tag===7){C(Ae,Ft.sibling),Ee=H(Ft,Re.props.children),Ee.return=Ae,Ae=Ee;break e}}else if(Ft.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===K&&qs(At)===Ft.type){C(Ae,Ft.sibling),Ee=H(Ft,Re.props),Ee.ref=Dn(Ae,Ft,Re),Ee.return=Ae,Ae=Ee;break e}C(Ae,Ft);break}else m(Ae,Ft);Ft=Ft.sibling}Re.type===D?(Ee=uh(Re.props.children,Ae.mode,at,Re.key),Ee.return=Ae,Ae=Ee):(at=Wv(Re.type,Re.key,Re.props,null,Ae.mode,at),at.ref=Dn(Ae,Ee,Re),at.return=Ae,Ae=at)}return se(Ae);case j:e:{for(Ft=Re.key;Ee!==null;){if(Ee.key===Ft)if(Ee.tag===4&&Ee.stateNode.containerInfo===Re.containerInfo&&Ee.stateNode.implementation===Re.implementation){C(Ae,Ee.sibling),Ee=H(Ee,Re.children||[]),Ee.return=Ae,Ae=Ee;break e}else{C(Ae,Ee);break}else m(Ae,Ee);Ee=Ee.sibling}Ee=v1(Re,Ae.mode,at),Ee.return=Ae,Ae=Ee}return se(Ae);case K:return Ft=Re._init,ai(Ae,Ee,Ft(Re._payload),at)}if(We(Re))return Et(Ae,Ee,Re,at);if(ae(Re))return Pt(Ae,Ee,Re,at);Ia(Ae,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"?(Re=""+Re,Ee!==null&&Ee.tag===6?(C(Ae,Ee.sibling),Ee=H(Ee,Re),Ee.return=Ae,Ae=Ee):(C(Ae,Ee),Ee=g1(Re,Ae.mode,at),Ee.return=Ae,Ae=Ee),se(Ae)):C(Ae,Ee)}return ai}var Eu=df(!0),ws=df(!1),Jd=Xo(null),rs=null,wc=null,hf=null;function ff(){hf=wc=rs=null}function pf(d){var m=Jd.current;$r(Jd),d._currentValue=m}function mf(d,m,C){for(;d!==null;){var A=d.alternate;if((d.childLanes&m)!==m?(d.childLanes|=m,A!==null&&(A.childLanes|=m)):A!==null&&(A.childLanes&m)!==m&&(A.childLanes|=m),d===C)break;d=d.return}}function Jo(d,m){rs=d,hf=wc=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&m)!==0&&(ee=!0),d.firstContext=null)}function pa(d){var m=d._currentValue;if(hf!==d)if(d={context:d,memoizedValue:m,next:null},wc===null){if(rs===null)throw Error(r(308));wc=d,rs.dependencies={lanes:0,firstContext:d}}else wc=wc.next=d;return m}var po=null;function _c(d){po===null?po=[d]:po.push(d)}function eh(d,m,C,A){var H=m.interleaved;return H===null?(C.next=C,_c(m)):(C.next=H.next,H.next=C),m.interleaved=C,ns(d,A)}function ns(d,m){d.lanes|=m;var C=d.alternate;for(C!==null&&(C.lanes|=m),C=d,d=d.return;d!==null;)d.childLanes|=m,C=d.alternate,C!==null&&(C.childLanes|=m),C=d,d=d.return;return C.tag===3?C.stateNode:null}var mo=!1;function th(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gf(d,m){d=d.updateQueue,m.updateQueue===d&&(m.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function go(d,m){return{eventTime:d,lane:m,tag:0,payload:null,callback:null,next:null}}function vo(d,m,C){var A=d.updateQueue;if(A===null)return null;if(A=A.shared,(br&2)!==0){var H=A.pending;return H===null?m.next=m:(m.next=H.next,H.next=m),A.pending=m,ns(d,C)}return H=A.interleaved,H===null?(m.next=m,_c(A)):(m.next=H.next,H.next=m),A.interleaved=m,ns(d,C)}function vf(d,m,C){if(m=m.updateQueue,m!==null&&(m=m.shared,(C&4194240)!==0)){var A=m.lanes;A&=d.pendingLanes,C|=A,m.lanes=C,Bs(d,C)}}function rh(d,m){var C=d.updateQueue,A=d.alternate;if(A!==null&&(A=A.updateQueue,C===A)){var H=null,Y=null;if(C=C.firstBaseUpdate,C!==null){do{var se={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};Y===null?H=Y=se:Y=Y.next=se,C=C.next}while(C!==null);Y===null?H=Y=m:Y=Y.next=m}else H=Y=m;C={baseState:A.baseState,firstBaseUpdate:H,lastBaseUpdate:Y,shared:A.shared,effects:A.effects},d.updateQueue=C;return}d=C.lastBaseUpdate,d===null?C.firstBaseUpdate=m:d.next=m,C.lastBaseUpdate=m}function Sc(d,m,C,A){var H=d.updateQueue;mo=!1;var Y=H.firstBaseUpdate,se=H.lastBaseUpdate,xe=H.shared.pending;if(xe!==null){H.shared.pending=null;var Se=xe,Ie=Se.next;Se.next=null,se===null?Y=Ie:se.next=Ie,se=Se;var Xe=d.alternate;Xe!==null&&(Xe=Xe.updateQueue,xe=Xe.lastBaseUpdate,xe!==se&&(xe===null?Xe.firstBaseUpdate=Ie:xe.next=Ie,Xe.lastBaseUpdate=Se))}if(Y!==null){var tt=H.baseState;se=0,Xe=Ie=Se=null,xe=Y;do{var Ye=xe.lane,bt=xe.eventTime;if((A&Ye)===Ye){Xe!==null&&(Xe=Xe.next={eventTime:bt,lane:0,tag:xe.tag,payload:xe.payload,callback:xe.callback,next:null});e:{var Et=d,Pt=xe;switch(Ye=m,bt=C,Pt.tag){case 1:if(Et=Pt.payload,typeof Et=="function"){tt=Et.call(bt,tt,Ye);break e}tt=Et;break e;case 3:Et.flags=Et.flags&-65537|128;case 0:if(Et=Pt.payload,Ye=typeof Et=="function"?Et.call(bt,tt,Ye):Et,Ye==null)break e;tt=re({},tt,Ye);break e;case 2:mo=!0}}xe.callback!==null&&xe.lane!==0&&(d.flags|=64,Ye=H.effects,Ye===null?H.effects=[xe]:Ye.push(xe))}else bt={eventTime:bt,lane:Ye,tag:xe.tag,payload:xe.payload,callback:xe.callback,next:null},Xe===null?(Ie=Xe=bt,Se=tt):Xe=Xe.next=bt,se|=Ye;if(xe=xe.next,xe===null){if(xe=H.shared.pending,xe===null)break;Ye=xe,xe=Ye.next,Ye.next=null,H.lastBaseUpdate=Ye,H.shared.pending=null}}while(!0);if(Xe===null&&(Se=tt),H.baseState=Se,H.firstBaseUpdate=Ie,H.lastBaseUpdate=Xe,m=H.shared.interleaved,m!==null){H=m;do se|=H.lane,H=H.next;while(H!==m)}else Y===null&&(H.shared.lanes=0);ah|=se,d.lanes=se,d.memoizedState=tt}}function Tn(d,m,C){if(d=m.effects,m.effects=null,d!==null)for(m=0;m<d.length;m++){var A=d[m],H=A.callback;if(H!==null){if(A.callback=null,A=C,typeof H!="function")throw Error(r(191,H));H.call(A)}}}var Qt={},Ur=Xo(Qt),un=Xo(Qt),In=Xo(Qt);function ri(d){if(d===Qt)throw Error(r(174));return d}function Il(d,m){switch(Vr(In,m),Vr(un,d),Vr(Ur,Qt),d=m.nodeType,d){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:Mt(null,"");break;default:d=d===8?m.parentNode:m,m=d.namespaceURI||null,d=d.tagName,m=Mt(m,d)}$r(Ur),Vr(Ur,m)}function cn(){$r(Ur),$r(un),$r(In)}function kc(d){ri(In.current);var m=ri(Ur.current),C=Mt(m,d.type);m!==C&&(Vr(un,d),Vr(Ur,C))}function el(d){un.current===d&&($r(Ur),$r(un))}var Kr=Xo(0);function Cc(d){for(var m=d;m!==null;){if(m.tag===13){var C=m.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||C.data==="$?"||C.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var Nu=[];function Fi(){for(var d=0;d<Nu.length;d++)Nu[d]._workInProgressVersionPrimary=null;Nu.length=0}var Ec=T.ReactCurrentDispatcher,nh=T.ReactCurrentBatchConfig,ma=0,Dr=null,Pn=null,Un=null,Ws=!1,Bl=!1,_s=0,yf=0;function Hn(){throw Error(r(321))}function ih(d,m){if(m===null)return!1;for(var C=0;C<m.length&&C<d.length;C++)if(!Di(d[C],m[C]))return!1;return!0}function Nc(d,m,C,A,H,Y){if(ma=Y,Dr=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,Ec.current=d===null||d.memoizedState===null?Xx:Vl,d=C(A,H),Bl){Y=0;do{if(Bl=!1,_s=0,25<=Y)throw Error(r(301));Y+=1,Un=Pn=null,m.updateQueue=null,Ec.current=Sf,d=C(A,H)}while(Bl)}if(Ec.current=Ac,m=Pn!==null&&Pn.next!==null,ma=0,Un=Pn=Dr=null,Ws=!1,m)throw Error(r(300));return d}function Tc(){var d=_s!==0;return _s=0,d}function Qr(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?Dr.memoizedState=Un=d:Un=Un.next=d,Un}function ni(){if(Pn===null){var d=Dr.alternate;d=d!==null?d.memoizedState:null}else d=Pn.next;var m=Un===null?Dr.memoizedState:Un.next;if(m!==null)Un=m,Pn=d;else{if(d===null)throw Error(r(310));Pn=d,d={memoizedState:Pn.memoizedState,baseState:Pn.baseState,baseQueue:Pn.baseQueue,queue:Pn.queue,next:null},Un===null?Dr.memoizedState=Un=d:Un=Un.next=d}return Un}function Vi(d,m){return typeof m=="function"?m(d):m}function Ui(d){var m=ni(),C=m.queue;if(C===null)throw Error(r(311));C.lastRenderedReducer=d;var A=Pn,H=A.baseQueue,Y=C.pending;if(Y!==null){if(H!==null){var se=H.next;H.next=Y.next,Y.next=se}A.baseQueue=H=Y,C.pending=null}if(H!==null){Y=H.next,A=A.baseState;var xe=se=null,Se=null,Ie=Y;do{var Xe=Ie.lane;if((ma&Xe)===Xe)Se!==null&&(Se=Se.next={lane:0,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null}),A=Ie.hasEagerState?Ie.eagerState:d(A,Ie.action);else{var tt={lane:Xe,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null};Se===null?(xe=Se=tt,se=A):Se=Se.next=tt,Dr.lanes|=Xe,ah|=Xe}Ie=Ie.next}while(Ie!==null&&Ie!==Y);Se===null?se=A:Se.next=xe,Di(A,m.memoizedState)||(ee=!0),m.memoizedState=A,m.baseState=se,m.baseQueue=Se,C.lastRenderedState=A}if(d=C.interleaved,d!==null){H=d;do Y=H.lane,Dr.lanes|=Y,ah|=Y,H=H.next;while(H!==d)}else H===null&&(C.lanes=0);return[m.memoizedState,C.dispatch]}function xf(d){var m=ni(),C=m.queue;if(C===null)throw Error(r(311));C.lastRenderedReducer=d;var A=C.dispatch,H=C.pending,Y=m.memoizedState;if(H!==null){C.pending=null;var se=H=H.next;do Y=d(Y,se.action),se=se.next;while(se!==H);Di(Y,m.memoizedState)||(ee=!0),m.memoizedState=Y,m.baseQueue===null&&(m.baseState=Y),C.lastRenderedState=Y}return[Y,A]}function bf(){}function wf(d,m){var C=Dr,A=ni(),H=m(),Y=!Di(A.memoizedState,H);if(Y&&(A.memoizedState=H,ee=!0),A=A.queue,Vp(Bp.bind(null,C,A,d),[d]),A.getSnapshot!==m||Y||Un!==null&&Un.memoizedState.tag&1){if(C.flags|=2048,Pc(9,tl.bind(null,C,A,H,m),void 0,null),Gi===null)throw Error(r(349));(ma&30)!==0||Ev(C,m,H)}return H}function Ev(d,m,C){d.flags|=16384,d={getSnapshot:m,value:C},m=Dr.updateQueue,m===null?(m={lastEffect:null,stores:null},Dr.updateQueue=m,m.stores=[d]):(C=m.stores,C===null?m.stores=[d]:C.push(d))}function tl(d,m,C,A){m.value=C,m.getSnapshot=A,zp(m)&&_f(d)}function Bp(d,m,C){return C(function(){zp(m)&&_f(d)})}function zp(d){var m=d.getSnapshot;d=d.value;try{var C=m();return!Di(d,C)}catch{return!0}}function _f(d){var m=ns(d,1);m!==null&&al(m,d,1,-1)}function zl(d){var m=Qr();return typeof d=="function"&&(d=d()),m.memoizedState=m.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:d},m.queue=d,d=d.dispatch=jv.bind(null,Dr,d),[m.memoizedState,d]}function Pc(d,m,C,A){return d={tag:d,create:m,destroy:C,deps:A,next:null},m=Dr.updateQueue,m===null?(m={lastEffect:null,stores:null},Dr.updateQueue=m,m.lastEffect=d.next=d):(C=m.lastEffect,C===null?m.lastEffect=d.next=d:(A=C.next,C.next=d,d.next=A,m.lastEffect=d)),d}function Fp(){return ni().memoizedState}function Mc(d,m,C,A){var H=Qr();Dr.flags|=d,H.memoizedState=Pc(1|m,C,void 0,A===void 0?null:A)}function Tu(d,m,C,A){var H=ni();A=A===void 0?null:A;var Y=void 0;if(Pn!==null){var se=Pn.memoizedState;if(Y=se.destroy,A!==null&&ih(A,se.deps)){H.memoizedState=Pc(m,C,Y,A);return}}Dr.flags|=d,H.memoizedState=Pc(1|m,C,Y,A)}function Nv(d,m){return Mc(8390656,8,d,m)}function Vp(d,m){return Tu(2048,8,d,m)}function Up(d,m){return Tu(4,2,d,m)}function Hp(d,m){return Tu(4,4,d,m)}function Fl(d,m){if(typeof m=="function")return d=d(),m(d),function(){m(null)};if(m!=null)return d=d(),m.current=d,function(){m.current=null}}function Tv(d,m,C){return C=C!=null?C.concat([d]):null,Tu(4,4,Fl.bind(null,m,d),C)}function rl(){}function Gp(d,m){var C=ni();m=m===void 0?null:m;var A=C.memoizedState;return A!==null&&m!==null&&ih(m,A[1])?A[0]:(C.memoizedState=[d,m],d)}function Jr(d,m){var C=ni();m=m===void 0?null:m;var A=C.memoizedState;return A!==null&&m!==null&&ih(m,A[1])?A[0]:(d=d(),C.memoizedState=[d,m],d)}function Pv(d,m,C){return(ma&21)===0?(d.baseState&&(d.baseState=!1,ee=!0),d.memoizedState=C):(Di(C,m)||(C=Bd(),Dr.lanes|=C,ah|=C,d.baseState=!0),m)}function Mv(d,m){var C=rr;rr=C!==0&&4>C?C:4,d(!0);var A=nh.transition;nh.transition={};try{d(!1),m()}finally{rr=C,nh.transition=A}}function Av(){return ni().memoizedState}function Yx(d,m,C){var A=Bc(d);if(C={lane:A,action:C,hasEagerState:!1,eagerState:null,next:null},qp(d))Rv(m,C);else if(C=eh(d,m,C,A),C!==null){var H=as();al(C,d,A,H),is(C,m,A)}}function jv(d,m,C){var A=Bc(d),H={lane:A,action:C,hasEagerState:!1,eagerState:null,next:null};if(qp(d))Rv(m,H);else{var Y=d.alternate;if(d.lanes===0&&(Y===null||Y.lanes===0)&&(Y=m.lastRenderedReducer,Y!==null))try{var se=m.lastRenderedState,xe=Y(se,C);if(H.hasEagerState=!0,H.eagerState=xe,Di(xe,se)){var Se=m.interleaved;Se===null?(H.next=H,_c(m)):(H.next=Se.next,Se.next=H),m.interleaved=H;return}}catch{}C=eh(d,m,H,A),C!==null&&(H=as(),al(C,d,A,H),is(C,m,A))}}function qp(d){var m=d.alternate;return d===Dr||m!==null&&m===Dr}function Rv(d,m){Bl=Ws=!0;var C=d.pending;C===null?m.next=m:(m.next=C.next,C.next=m),d.pending=m}function is(d,m,C){if((C&4194240)!==0){var A=m.lanes;A&=d.pendingLanes,C|=A,m.lanes=C,Bs(d,C)}}var Ac={readContext:pa,useCallback:Hn,useContext:Hn,useEffect:Hn,useImperativeHandle:Hn,useInsertionEffect:Hn,useLayoutEffect:Hn,useMemo:Hn,useReducer:Hn,useRef:Hn,useState:Hn,useDebugValue:Hn,useDeferredValue:Hn,useTransition:Hn,useMutableSource:Hn,useSyncExternalStore:Hn,useId:Hn,unstable_isNewReconciler:!1},Xx={readContext:pa,useCallback:function(d,m){return Qr().memoizedState=[d,m===void 0?null:m],d},useContext:pa,useEffect:Nv,useImperativeHandle:function(d,m,C){return C=C!=null?C.concat([d]):null,Mc(4194308,4,Fl.bind(null,m,d),C)},useLayoutEffect:function(d,m){return Mc(4194308,4,d,m)},useInsertionEffect:function(d,m){return Mc(4,2,d,m)},useMemo:function(d,m){var C=Qr();return m=m===void 0?null:m,d=d(),C.memoizedState=[d,m],d},useReducer:function(d,m,C){var A=Qr();return m=C!==void 0?C(m):m,A.memoizedState=A.baseState=m,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:m},A.queue=d,d=d.dispatch=Yx.bind(null,Dr,d),[A.memoizedState,d]},useRef:function(d){var m=Qr();return d={current:d},m.memoizedState=d},useState:zl,useDebugValue:rl,useDeferredValue:function(d){return Qr().memoizedState=d},useTransition:function(){var d=zl(!1),m=d[0];return d=Mv.bind(null,d[1]),Qr().memoizedState=d,[m,d]},useMutableSource:function(){},useSyncExternalStore:function(d,m,C){var A=Dr,H=Qr();if(Ar){if(C===void 0)throw Error(r(407));C=C()}else{if(C=m(),Gi===null)throw Error(r(349));(ma&30)!==0||Ev(A,m,C)}H.memoizedState=C;var Y={value:C,getSnapshot:m};return H.queue=Y,Nv(Bp.bind(null,A,Y,d),[d]),A.flags|=2048,Pc(9,tl.bind(null,A,Y,C,m),void 0,null),C},useId:function(){var d=Qr(),m=Gi.identifierPrefix;if(Ar){var C=ln,A=Ja;C=(A&~(1<<32-ot(A)-1)).toString(32)+C,m=":"+m+"R"+C,C=_s++,0<C&&(m+="H"+C.toString(32)),m+=":"}else C=yf++,m=":"+m+"r"+C.toString(32)+":";return d.memoizedState=m},unstable_isNewReconciler:!1},Vl={readContext:pa,useCallback:Gp,useContext:pa,useEffect:Vp,useImperativeHandle:Tv,useInsertionEffect:Up,useLayoutEffect:Hp,useMemo:Jr,useReducer:Ui,useRef:Fp,useState:function(){return Ui(Vi)},useDebugValue:rl,useDeferredValue:function(d){var m=ni();return Pv(m,Pn.memoizedState,d)},useTransition:function(){var d=Ui(Vi)[0],m=ni().memoizedState;return[d,m]},useMutableSource:bf,useSyncExternalStore:wf,useId:Av,unstable_isNewReconciler:!1},Sf={readContext:pa,useCallback:Gp,useContext:pa,useEffect:Vp,useImperativeHandle:Tv,useInsertionEffect:Up,useLayoutEffect:Hp,useMemo:Jr,useReducer:xf,useRef:Fp,useState:function(){return xf(Vi)},useDebugValue:rl,useDeferredValue:function(d){var m=ni();return Pn===null?m.memoizedState=d:Pv(m,Pn.memoizedState,d)},useTransition:function(){var d=xf(Vi)[0],m=ni().memoizedState;return[d,m]},useMutableSource:bf,useSyncExternalStore:wf,useId:Av,unstable_isNewReconciler:!1};function Ei(d,m){if(d&&d.defaultProps){m=re({},m),d=d.defaultProps;for(var C in d)m[C]===void 0&&(m[C]=d[C]);return m}return m}function jc(d,m,C,A){m=d.memoizedState,C=C(A,m),C=C==null?m:re({},m,C),d.memoizedState=C,d.lanes===0&&(d.updateQueue.baseState=C)}var Rc={isMounted:function(d){return(d=d._reactInternals)?ui(d)===d:!1},enqueueSetState:function(d,m,C){d=d._reactInternals;var A=as(),H=Bc(d),Y=go(A,H);Y.payload=m,C!=null&&(Y.callback=C),m=vo(d,Y,H),m!==null&&(al(m,d,H,A),vf(m,d,H))},enqueueReplaceState:function(d,m,C){d=d._reactInternals;var A=as(),H=Bc(d),Y=go(A,H);Y.tag=1,Y.payload=m,C!=null&&(Y.callback=C),m=vo(d,Y,H),m!==null&&(al(m,d,H,A),vf(m,d,H))},enqueueForceUpdate:function(d,m){d=d._reactInternals;var C=as(),A=Bc(d),H=go(C,A);H.tag=2,m!=null&&(H.callback=m),m=vo(d,H,A),m!==null&&(al(m,d,A,C),vf(m,d,A))}};function kf(d,m,C,A,H,Y,se){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(A,Y,se):m.prototype&&m.prototype.isPureReactComponent?!xs(C,A)||!xs(H,Y):!0}function Lv(d,m,C){var A=!1,H=ho,Y=m.contextType;return typeof Y=="object"&&Y!==null?Y=pa(Y):(H=zi(m)?jl:Ci.current,A=m.contextTypes,Y=(A=A!=null)?bu(d,H):ho),m=new m(C,Y),d.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Rc,d.stateNode=m,m._reactInternals=d,A&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=H,d.__reactInternalMemoizedMaskedChildContext=Y),m}function Wp(d,m,C,A){d=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(C,A),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(C,A),m.state!==d&&Rc.enqueueReplaceState(m,m.state,null)}function Cf(d,m,C,A){var H=d.stateNode;H.props=C,H.state=d.memoizedState,H.refs={},th(d);var Y=m.contextType;typeof Y=="object"&&Y!==null?H.context=pa(Y):(Y=zi(m)?jl:Ci.current,H.context=bu(d,Y)),H.state=d.memoizedState,Y=m.getDerivedStateFromProps,typeof Y=="function"&&(jc(d,m,Y,C),H.state=d.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof H.getSnapshotBeforeUpdate=="function"||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(m=H.state,typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount(),m!==H.state&&Rc.enqueueReplaceState(H,H.state,null),Sc(d,C,H,A),H.state=d.memoizedState),typeof H.componentDidMount=="function"&&(d.flags|=4194308)}function Pu(d,m){try{var C="",A=m;do C+=me(A),A=A.return;while(A);var H=C}catch(Y){H=`
Error generating stack: `+Y.message+`
`+Y.stack}return{value:d,source:m,stack:H,digest:null}}function Ef(d,m,C){return{value:d,source:null,stack:C??null,digest:m??null}}function Lc(d,m){try{console.error(m.value)}catch(C){setTimeout(function(){throw C})}}var Qx=typeof WeakMap=="function"?WeakMap:Map;function Ov(d,m,C){C=go(-1,C),C.tag=3,C.payload={element:null};var A=m.value;return C.callback=function(){Fv||(Fv=!0,l1=A),Lc(d,m)},C}function y(d,m,C){C=go(-1,C),C.tag=3;var A=d.type.getDerivedStateFromError;if(typeof A=="function"){var H=m.value;C.payload=function(){return A(H)},C.callback=function(){Lc(d,m)}}var Y=d.stateNode;return Y!==null&&typeof Y.componentDidCatch=="function"&&(C.callback=function(){Lc(d,m),typeof A!="function"&&(Dc===null?Dc=new Set([this]):Dc.add(this));var se=m.stack;this.componentDidCatch(m.value,{componentStack:se!==null?se:""})}),C}function b(d,m,C){var A=d.pingCache;if(A===null){A=d.pingCache=new Qx;var H=new Set;A.set(m,H)}else H=A.get(m),H===void 0&&(H=new Set,A.set(m,H));H.has(C)||(H.add(C),d=Hj.bind(null,d,m,C),m.then(d,d))}function M(d){do{var m;if((m=d.tag===13)&&(m=d.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return d;d=d.return}while(d!==null);return null}function z(d,m,C,A,H){return(d.mode&1)===0?(d===m?d.flags|=65536:(d.flags|=128,C.flags|=131072,C.flags&=-52805,C.tag===1&&(C.alternate===null?C.tag=17:(m=go(-1,1),m.tag=2,vo(C,m,1))),C.lanes|=1),d):(d.flags|=65536,d.lanes=H,d)}var q=T.ReactCurrentOwner,ee=!1;function he(d,m,C,A){m.child=d===null?ws(m,null,C,A):Eu(m,d.child,C,A)}function Te(d,m,C,A,H){C=C.render;var Y=m.ref;return Jo(m,H),A=Nc(d,m,C,A,Y,H),C=Tc(),d!==null&&!ee?(m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~H,Hi(d,m,H)):(Ar&&C&&xc(m),m.flags|=1,he(d,m,A,H),m.child)}function Be(d,m,C,A,H){if(d===null){var Y=C.type;return typeof Y=="function"&&!m1(Y)&&Y.defaultProps===void 0&&C.compare===null&&C.defaultProps===void 0?(m.tag=15,m.type=Y,nt(d,m,Y,A,H)):(d=Wv(C.type,null,A,m,m.mode,H),d.ref=m.ref,d.return=m,m.child=d)}if(Y=d.child,(d.lanes&H)===0){var se=Y.memoizedProps;if(C=C.compare,C=C!==null?C:xs,C(se,A)&&d.ref===m.ref)return Hi(d,m,H)}return m.flags|=1,d=Fc(Y,A),d.ref=m.ref,d.return=m,m.child=d}function nt(d,m,C,A,H){if(d!==null){var Y=d.memoizedProps;if(xs(Y,A)&&d.ref===m.ref)if(ee=!1,m.pendingProps=A=Y,(d.lanes&H)!==0)(d.flags&131072)!==0&&(ee=!0);else return m.lanes=d.lanes,Hi(d,m,H)}return mt(d,m,C,A,H)}function St(d,m,C){var A=m.pendingProps,H=A.children,Y=d!==null?d.memoizedState:null;if(A.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vr(Tf,$s),$s|=C;else{if((C&1073741824)===0)return d=Y!==null?Y.baseLanes|C:C,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:d,cachePool:null,transitions:null},m.updateQueue=null,Vr(Tf,$s),$s|=d,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=Y!==null?Y.baseLanes:C,Vr(Tf,$s),$s|=A}else Y!==null?(A=Y.baseLanes|C,m.memoizedState=null):A=C,Vr(Tf,$s),$s|=A;return he(d,m,H,C),m.child}function Kt(d,m){var C=m.ref;(d===null&&C!==null||d!==null&&d.ref!==C)&&(m.flags|=512,m.flags|=2097152)}function mt(d,m,C,A,H){var Y=zi(C)?jl:Ci.current;return Y=bu(m,Y),Jo(m,H),C=Nc(d,m,C,A,Y,H),A=Tc(),d!==null&&!ee?(m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~H,Hi(d,m,H)):(Ar&&A&&xc(m),m.flags|=1,he(d,m,C,H),m.child)}function Zr(d,m,C,A,H){if(zi(C)){var Y=!0;wu(m)}else Y=!1;if(Jo(m,H),m.stateNode===null)pr(d,m),Lv(m,C,A),Cf(m,C,A,H),A=!0;else if(d===null){var se=m.stateNode,xe=m.memoizedProps;se.props=xe;var Se=se.context,Ie=C.contextType;typeof Ie=="object"&&Ie!==null?Ie=pa(Ie):(Ie=zi(C)?jl:Ci.current,Ie=bu(m,Ie));var Xe=C.getDerivedStateFromProps,tt=typeof Xe=="function"||typeof se.getSnapshotBeforeUpdate=="function";tt||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(xe!==A||Se!==Ie)&&Wp(m,se,A,Ie),mo=!1;var Ye=m.memoizedState;se.state=Ye,Sc(m,A,se,H),Se=m.memoizedState,xe!==A||Ye!==Se||Bi.current||mo?(typeof Xe=="function"&&(jc(m,C,Xe,A),Se=m.memoizedState),(xe=mo||kf(m,C,xe,A,Ye,Se,Ie))?(tt||typeof se.UNSAFE_componentWillMount!="function"&&typeof se.componentWillMount!="function"||(typeof se.componentWillMount=="function"&&se.componentWillMount(),typeof se.UNSAFE_componentWillMount=="function"&&se.UNSAFE_componentWillMount()),typeof se.componentDidMount=="function"&&(m.flags|=4194308)):(typeof se.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=A,m.memoizedState=Se),se.props=A,se.state=Se,se.context=Ie,A=xe):(typeof se.componentDidMount=="function"&&(m.flags|=4194308),A=!1)}else{se=m.stateNode,gf(d,m),xe=m.memoizedProps,Ie=m.type===m.elementType?xe:Ei(m.type,xe),se.props=Ie,tt=m.pendingProps,Ye=se.context,Se=C.contextType,typeof Se=="object"&&Se!==null?Se=pa(Se):(Se=zi(C)?jl:Ci.current,Se=bu(m,Se));var bt=C.getDerivedStateFromProps;(Xe=typeof bt=="function"||typeof se.getSnapshotBeforeUpdate=="function")||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(xe!==tt||Ye!==Se)&&Wp(m,se,A,Se),mo=!1,Ye=m.memoizedState,se.state=Ye,Sc(m,A,se,H);var Et=m.memoizedState;xe!==tt||Ye!==Et||Bi.current||mo?(typeof bt=="function"&&(jc(m,C,bt,A),Et=m.memoizedState),(Ie=mo||kf(m,C,Ie,A,Ye,Et,Se)||!1)?(Xe||typeof se.UNSAFE_componentWillUpdate!="function"&&typeof se.componentWillUpdate!="function"||(typeof se.componentWillUpdate=="function"&&se.componentWillUpdate(A,Et,Se),typeof se.UNSAFE_componentWillUpdate=="function"&&se.UNSAFE_componentWillUpdate(A,Et,Se)),typeof se.componentDidUpdate=="function"&&(m.flags|=4),typeof se.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof se.componentDidUpdate!="function"||xe===d.memoizedProps&&Ye===d.memoizedState||(m.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||xe===d.memoizedProps&&Ye===d.memoizedState||(m.flags|=1024),m.memoizedProps=A,m.memoizedState=Et),se.props=A,se.state=Et,se.context=Se,A=Ie):(typeof se.componentDidUpdate!="function"||xe===d.memoizedProps&&Ye===d.memoizedState||(m.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||xe===d.memoizedProps&&Ye===d.memoizedState||(m.flags|=1024),A=!1)}return jr(d,m,C,A,Y,H)}function jr(d,m,C,A,H,Y){Kt(d,m);var se=(m.flags&128)!==0;if(!A&&!se)return H&&Sv(m,C,!1),Hi(d,m,Y);A=m.stateNode,q.current=m;var xe=se&&typeof C.getDerivedStateFromError!="function"?null:A.render();return m.flags|=1,d!==null&&se?(m.child=Eu(m,d.child,null,Y),m.child=Eu(m,null,xe,Y)):he(d,m,xe,Y),m.memoizedState=A.state,H&&Sv(m,C,!0),m.child}function ga(d){var m=d.stateNode;m.pendingContext?Lp(d,m.pendingContext,m.pendingContext!==m.context):m.context&&Lp(d,m.context,!1),Il(d,m.containerInfo)}function yo(d,m,C,A,H){return Cu(),Qd(H),m.flags|=256,he(d,m,C,A),m.child}var Oe={dehydrated:null,treeContext:null,retryLane:0};function Pe(d){return{baseLanes:d,cachePool:null,transitions:null}}function Fe(d,m,C){var A=m.pendingProps,H=Kr.current,Y=!1,se=(m.flags&128)!==0,xe;if((xe=se)||(xe=d!==null&&d.memoizedState===null?!1:(H&2)!==0),xe?(Y=!0,m.flags&=-129):(d===null||d.memoizedState!==null)&&(H|=1),Vr(Kr,H&1),d===null)return bc(m),d=m.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((m.mode&1)===0?m.lanes=1:d.data==="$!"?m.lanes=8:m.lanes=1073741824,null):(se=A.children,d=A.fallback,Y?(A=m.mode,Y=m.child,se={mode:"hidden",children:se},(A&1)===0&&Y!==null?(Y.childLanes=0,Y.pendingProps=se):Y=$v(se,A,0,null),d=uh(d,A,C,null),Y.return=m,d.return=m,Y.sibling=d,m.child=Y,m.child.memoizedState=Pe(C),m.memoizedState=Oe,d):gt(m,se));if(H=d.memoizedState,H!==null&&(xe=H.dehydrated,xe!==null))return Jt(d,m,se,A,xe,H,C);if(Y){Y=A.fallback,se=m.mode,H=d.child,xe=H.sibling;var Se={mode:"hidden",children:A.children};return(se&1)===0&&m.child!==H?(A=m.child,A.childLanes=0,A.pendingProps=Se,m.deletions=null):(A=Fc(H,Se),A.subtreeFlags=H.subtreeFlags&14680064),xe!==null?Y=Fc(xe,Y):(Y=uh(Y,se,C,null),Y.flags|=2),Y.return=m,A.return=m,A.sibling=Y,m.child=A,A=Y,Y=m.child,se=d.child.memoizedState,se=se===null?Pe(C):{baseLanes:se.baseLanes|C,cachePool:null,transitions:se.transitions},Y.memoizedState=se,Y.childLanes=d.childLanes&~C,m.memoizedState=Oe,A}return Y=d.child,d=Y.sibling,A=Fc(Y,{mode:"visible",children:A.children}),(m.mode&1)===0&&(A.lanes=C),A.return=m,A.sibling=null,d!==null&&(C=m.deletions,C===null?(m.deletions=[d],m.flags|=16):C.push(d)),m.child=A,m.memoizedState=null,A}function gt(d,m){return m=$v({mode:"visible",children:m},d.mode,0,null),m.return=d,d.child=m}function Rt(d,m,C,A){return A!==null&&Qd(A),Eu(m,d.child,null,C),d=gt(m,m.pendingProps.children),d.flags|=2,m.memoizedState=null,d}function Jt(d,m,C,A,H,Y,se){if(C)return m.flags&256?(m.flags&=-257,A=Ef(Error(r(422))),Rt(d,m,se,A)):m.memoizedState!==null?(m.child=d.child,m.flags|=128,null):(Y=A.fallback,H=m.mode,A=$v({mode:"visible",children:A.children},H,0,null),Y=uh(Y,H,se,null),Y.flags|=2,A.return=m,Y.return=m,A.sibling=Y,m.child=A,(m.mode&1)!==0&&Eu(m,d.child,null,se),m.child.memoizedState=Pe(se),m.memoizedState=Oe,Y);if((m.mode&1)===0)return Rt(d,m,se,null);if(H.data==="$!"){if(A=H.nextSibling&&H.nextSibling.dataset,A)var xe=A.dgst;return A=xe,Y=Error(r(419)),A=Ef(Y,A,void 0),Rt(d,m,se,A)}if(xe=(se&d.childLanes)!==0,ee||xe){if(A=Gi,A!==null){switch(se&-se){case 4:H=2;break;case 16:H=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:H=32;break;case 536870912:H=268435456;break;default:H=0}H=(H&(A.suspendedLanes|se))!==0?0:H,H!==0&&H!==Y.retryLane&&(Y.retryLane=H,ns(d,H),al(A,d,H,-1))}return p1(),A=Ef(Error(r(421))),Rt(d,m,se,A)}return H.data==="$?"?(m.flags|=128,m.child=d.child,m=Gj.bind(null,d),H._reactRetry=m,null):(d=Y.treeContext,ct=bs(H.nextSibling),es=m,Ar=!0,ts=null,d!==null&&(ha[fa++]=Ja,ha[fa++]=ln,ha[fa++]=Dl,Ja=d.id,ln=d.overflow,Dl=m),m=gt(m,A.children),m.flags|=4096,m)}function Zt(d,m,C){d.lanes|=m;var A=d.alternate;A!==null&&(A.lanes|=m),mf(d.return,m,C)}function gr(d,m,C,A,H){var Y=d.memoizedState;Y===null?d.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:A,tail:C,tailMode:H}:(Y.isBackwards=m,Y.rendering=null,Y.renderingStartTime=0,Y.last=A,Y.tail=C,Y.tailMode=H)}function ii(d,m,C){var A=m.pendingProps,H=A.revealOrder,Y=A.tail;if(he(d,m,A.children,C),A=Kr.current,(A&2)!==0)A=A&1|2,m.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=m.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&Zt(d,C,m);else if(d.tag===19)Zt(d,C,m);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===m)break e;for(;d.sibling===null;){if(d.return===null||d.return===m)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}A&=1}if(Vr(Kr,A),(m.mode&1)===0)m.memoizedState=null;else switch(H){case"forwards":for(C=m.child,H=null;C!==null;)d=C.alternate,d!==null&&Cc(d)===null&&(H=C),C=C.sibling;C=H,C===null?(H=m.child,m.child=null):(H=C.sibling,C.sibling=null),gr(m,!1,H,C,Y);break;case"backwards":for(C=null,H=m.child,m.child=null;H!==null;){if(d=H.alternate,d!==null&&Cc(d)===null){m.child=H;break}d=H.sibling,H.sibling=C,C=H,H=d}gr(m,!0,C,null,Y);break;case"together":gr(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function pr(d,m){(m.mode&1)===0&&d!==null&&(d.alternate=null,m.alternate=null,m.flags|=2)}function Hi(d,m,C){if(d!==null&&(m.dependencies=d.dependencies),ah|=m.lanes,(C&m.childLanes)===0)return null;if(d!==null&&m.child!==d.child)throw Error(r(153));if(m.child!==null){for(d=m.child,C=Fc(d,d.pendingProps),m.child=C,C.return=m;d.sibling!==null;)d=d.sibling,C=C.sibling=Fc(d,d.pendingProps),C.return=m;C.sibling=null}return m.child}function Jx(d,m,C){switch(m.tag){case 3:ga(m),Cu();break;case 5:kc(m);break;case 1:zi(m.type)&&wu(m);break;case 4:Il(m,m.stateNode.containerInfo);break;case 10:var A=m.type._context,H=m.memoizedProps.value;Vr(Jd,A._currentValue),A._currentValue=H;break;case 13:if(A=m.memoizedState,A!==null)return A.dehydrated!==null?(Vr(Kr,Kr.current&1),m.flags|=128,null):(C&m.child.childLanes)!==0?Fe(d,m,C):(Vr(Kr,Kr.current&1),d=Hi(d,m,C),d!==null?d.sibling:null);Vr(Kr,Kr.current&1);break;case 19:if(A=(C&m.childLanes)!==0,(d.flags&128)!==0){if(A)return ii(d,m,C);m.flags|=128}if(H=m.memoizedState,H!==null&&(H.rendering=null,H.tail=null,H.lastEffect=null),Vr(Kr,Kr.current),A)break;return null;case 22:case 23:return m.lanes=0,St(d,m,C)}return Hi(d,m,C)}var QS,e1,JS,ek;QS=function(d,m){for(var C=m.child;C!==null;){if(C.tag===5||C.tag===6)d.appendChild(C.stateNode);else if(C.tag!==4&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===m)break;for(;C.sibling===null;){if(C.return===null||C.return===m)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},e1=function(){},JS=function(d,m,C,A){var H=d.memoizedProps;if(H!==A){d=m.stateNode,ri(Ur.current);var Y=null;switch(C){case"input":H=De(d,H),A=De(d,A),Y=[];break;case"select":H=re({},H,{value:void 0}),A=re({},A,{value:void 0}),Y=[];break;case"textarea":H=ze(d,H),A=ze(d,A),Y=[];break;default:typeof H.onClick!="function"&&typeof A.onClick=="function"&&(d.onclick=$e)}Ne(C,A);var se;C=null;for(Ie in H)if(!A.hasOwnProperty(Ie)&&H.hasOwnProperty(Ie)&&H[Ie]!=null)if(Ie==="style"){var xe=H[Ie];for(se in xe)xe.hasOwnProperty(se)&&(C||(C={}),C[se]="")}else Ie!=="dangerouslySetInnerHTML"&&Ie!=="children"&&Ie!=="suppressContentEditableWarning"&&Ie!=="suppressHydrationWarning"&&Ie!=="autoFocus"&&(i.hasOwnProperty(Ie)?Y||(Y=[]):(Y=Y||[]).push(Ie,null));for(Ie in A){var Se=A[Ie];if(xe=H?.[Ie],A.hasOwnProperty(Ie)&&Se!==xe&&(Se!=null||xe!=null))if(Ie==="style")if(xe){for(se in xe)!xe.hasOwnProperty(se)||Se&&Se.hasOwnProperty(se)||(C||(C={}),C[se]="");for(se in Se)Se.hasOwnProperty(se)&&xe[se]!==Se[se]&&(C||(C={}),C[se]=Se[se])}else C||(Y||(Y=[]),Y.push(Ie,C)),C=Se;else Ie==="dangerouslySetInnerHTML"?(Se=Se?Se.__html:void 0,xe=xe?xe.__html:void 0,Se!=null&&xe!==Se&&(Y=Y||[]).push(Ie,Se)):Ie==="children"?typeof Se!="string"&&typeof Se!="number"||(Y=Y||[]).push(Ie,""+Se):Ie!=="suppressContentEditableWarning"&&Ie!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ie)?(Se!=null&&Ie==="onScroll"&&Pr("scroll",d),Y||xe===Se||(Y=[])):(Y=Y||[]).push(Ie,Se))}C&&(Y=Y||[]).push("style",C);var Ie=Y;(m.updateQueue=Ie)&&(m.flags|=4)}},ek=function(d,m,C,A){C!==A&&(m.flags|=4)};function $p(d,m){if(!Ar)switch(d.tailMode){case"hidden":m=d.tail;for(var C=null;m!==null;)m.alternate!==null&&(C=m),m=m.sibling;C===null?d.tail=null:C.sibling=null;break;case"collapsed":C=d.tail;for(var A=null;C!==null;)C.alternate!==null&&(A=C),C=C.sibling;A===null?m||d.tail===null?d.tail=null:d.tail.sibling=null:A.sibling=null}}function Ba(d){var m=d.alternate!==null&&d.alternate.child===d.child,C=0,A=0;if(m)for(var H=d.child;H!==null;)C|=H.lanes|H.childLanes,A|=H.subtreeFlags&14680064,A|=H.flags&14680064,H.return=d,H=H.sibling;else for(H=d.child;H!==null;)C|=H.lanes|H.childLanes,A|=H.subtreeFlags,A|=H.flags,H.return=d,H=H.sibling;return d.subtreeFlags|=A,d.childLanes=C,m}function Rj(d,m,C){var A=m.pendingProps;switch(mi(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ba(m),null;case 1:return zi(m.type)&&vc(),Ba(m),null;case 3:return A=m.stateNode,cn(),$r(Bi),$r(Ci),Fi(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(d===null||d.child===null)&&(Xd(m)?m.flags|=4:d===null||d.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,ts!==null&&(d1(ts),ts=null))),e1(d,m),Ba(m),null;case 5:el(m);var H=ri(In.current);if(C=m.type,d!==null&&m.stateNode!=null)JS(d,m,C,A,H),d.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!A){if(m.stateNode===null)throw Error(r(166));return Ba(m),null}if(d=ri(Ur.current),Xd(m)){A=m.stateNode,C=m.type;var Y=m.memoizedProps;switch(A[Da]=m,A[Al]=Y,d=(m.mode&1)!==0,C){case"dialog":Pr("cancel",A),Pr("close",A);break;case"iframe":case"object":case"embed":Pr("load",A);break;case"video":case"audio":for(H=0;H<Hs.length;H++)Pr(Hs[H],A);break;case"source":Pr("error",A);break;case"img":case"image":case"link":Pr("error",A),Pr("load",A);break;case"details":Pr("toggle",A);break;case"input":qe(A,Y),Pr("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!Y.multiple},Pr("invalid",A);break;case"textarea":Ke(A,Y),Pr("invalid",A)}Ne(C,Y),H=null;for(var se in Y)if(Y.hasOwnProperty(se)){var xe=Y[se];se==="children"?typeof xe=="string"?A.textContent!==xe&&(Y.suppressHydrationWarning!==!0&&Le(A.textContent,xe,d),H=["children",xe]):typeof xe=="number"&&A.textContent!==""+xe&&(Y.suppressHydrationWarning!==!0&&Le(A.textContent,xe,d),H=["children",""+xe]):i.hasOwnProperty(se)&&xe!=null&&se==="onScroll"&&Pr("scroll",A)}switch(C){case"input":ge(A),Je(A,Y,!0);break;case"textarea":ge(A),ht(A);break;case"select":case"option":break;default:typeof Y.onClick=="function"&&(A.onclick=$e)}A=H,m.updateQueue=A,A!==null&&(m.flags|=4)}else{se=H.nodeType===9?H:H.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Nt(C)),d==="http://www.w3.org/1999/xhtml"?C==="script"?(d=se.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof A.is=="string"?d=se.createElement(C,{is:A.is}):(d=se.createElement(C),C==="select"&&(se=d,A.multiple?se.multiple=!0:A.size&&(se.size=A.size))):d=se.createElementNS(d,C),d[Da]=m,d[Al]=A,QS(d,m,!1,!1),m.stateNode=d;e:{switch(se=je(C,A),C){case"dialog":Pr("cancel",d),Pr("close",d),H=A;break;case"iframe":case"object":case"embed":Pr("load",d),H=A;break;case"video":case"audio":for(H=0;H<Hs.length;H++)Pr(Hs[H],d);H=A;break;case"source":Pr("error",d),H=A;break;case"img":case"image":case"link":Pr("error",d),Pr("load",d),H=A;break;case"details":Pr("toggle",d),H=A;break;case"input":qe(d,A),H=De(d,A),Pr("invalid",d);break;case"option":H=A;break;case"select":d._wrapperState={wasMultiple:!!A.multiple},H=re({},A,{value:void 0}),Pr("invalid",d);break;case"textarea":Ke(d,A),H=ze(d,A),Pr("invalid",d);break;default:H=A}Ne(C,H),xe=H;for(Y in xe)if(xe.hasOwnProperty(Y)){var Se=xe[Y];Y==="style"?ve(d,Se):Y==="dangerouslySetInnerHTML"?(Se=Se?Se.__html:void 0,Se!=null&&Wt(d,Se)):Y==="children"?typeof Se=="string"?(C!=="textarea"||Se!=="")&&xt(d,Se):typeof Se=="number"&&xt(d,""+Se):Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&Y!=="autoFocus"&&(i.hasOwnProperty(Y)?Se!=null&&Y==="onScroll"&&Pr("scroll",d):Se!=null&&E(d,Y,Se,se))}switch(C){case"input":ge(d),Je(d,A,!1);break;case"textarea":ge(d),ht(d);break;case"option":A.value!=null&&d.setAttribute("value",""+pe(A.value));break;case"select":d.multiple=!!A.multiple,Y=A.value,Y!=null?Ce(d,!!A.multiple,Y,!1):A.defaultValue!=null&&Ce(d,!!A.multiple,A.defaultValue,!0);break;default:typeof H.onClick=="function"&&(d.onclick=$e)}switch(C){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return Ba(m),null;case 6:if(d&&m.stateNode!=null)ek(d,m,d.memoizedProps,A);else{if(typeof A!="string"&&m.stateNode===null)throw Error(r(166));if(C=ri(In.current),ri(Ur.current),Xd(m)){if(A=m.stateNode,C=m.memoizedProps,A[Da]=m,(Y=A.nodeValue!==C)&&(d=es,d!==null))switch(d.tag){case 3:Le(A.nodeValue,C,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&Le(A.nodeValue,C,(d.mode&1)!==0)}Y&&(m.flags|=4)}else A=(C.nodeType===9?C:C.ownerDocument).createTextNode(A),A[Da]=m,m.stateNode=A}return Ba(m),null;case 13:if($r(Kr),A=m.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(Ar&&ct!==null&&(m.mode&1)!==0&&(m.flags&128)===0)Dp(),Cu(),m.flags|=98560,Y=!1;else if(Y=Xd(m),A!==null&&A.dehydrated!==null){if(d===null){if(!Y)throw Error(r(318));if(Y=m.memoizedState,Y=Y!==null?Y.dehydrated:null,!Y)throw Error(r(317));Y[Da]=m}else Cu(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Ba(m),Y=!1}else ts!==null&&(d1(ts),ts=null),Y=!0;if(!Y)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=C,m):(A=A!==null,A!==(d!==null&&d.memoizedState!==null)&&A&&(m.child.flags|=8192,(m.mode&1)!==0&&(d===null||(Kr.current&1)!==0?Ni===0&&(Ni=3):p1())),m.updateQueue!==null&&(m.flags|=4),Ba(m),null);case 4:return cn(),e1(d,m),d===null&&uo(m.stateNode.containerInfo),Ba(m),null;case 10:return pf(m.type._context),Ba(m),null;case 17:return zi(m.type)&&vc(),Ba(m),null;case 19:if($r(Kr),Y=m.memoizedState,Y===null)return Ba(m),null;if(A=(m.flags&128)!==0,se=Y.rendering,se===null)if(A)$p(Y,!1);else{if(Ni!==0||d!==null&&(d.flags&128)!==0)for(d=m.child;d!==null;){if(se=Cc(d),se!==null){for(m.flags|=128,$p(Y,!1),A=se.updateQueue,A!==null&&(m.updateQueue=A,m.flags|=4),m.subtreeFlags=0,A=C,C=m.child;C!==null;)Y=C,d=A,Y.flags&=14680066,se=Y.alternate,se===null?(Y.childLanes=0,Y.lanes=d,Y.child=null,Y.subtreeFlags=0,Y.memoizedProps=null,Y.memoizedState=null,Y.updateQueue=null,Y.dependencies=null,Y.stateNode=null):(Y.childLanes=se.childLanes,Y.lanes=se.lanes,Y.child=se.child,Y.subtreeFlags=0,Y.deletions=null,Y.memoizedProps=se.memoizedProps,Y.memoizedState=se.memoizedState,Y.updateQueue=se.updateQueue,Y.type=se.type,d=se.dependencies,Y.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),C=C.sibling;return Vr(Kr,Kr.current&1|2),m.child}d=d.sibling}Y.tail!==null&&Xr()>Pf&&(m.flags|=128,A=!0,$p(Y,!1),m.lanes=4194304)}else{if(!A)if(d=Cc(se),d!==null){if(m.flags|=128,A=!0,C=d.updateQueue,C!==null&&(m.updateQueue=C,m.flags|=4),$p(Y,!0),Y.tail===null&&Y.tailMode==="hidden"&&!se.alternate&&!Ar)return Ba(m),null}else 2*Xr()-Y.renderingStartTime>Pf&&C!==1073741824&&(m.flags|=128,A=!0,$p(Y,!1),m.lanes=4194304);Y.isBackwards?(se.sibling=m.child,m.child=se):(C=Y.last,C!==null?C.sibling=se:m.child=se,Y.last=se)}return Y.tail!==null?(m=Y.tail,Y.rendering=m,Y.tail=m.sibling,Y.renderingStartTime=Xr(),m.sibling=null,C=Kr.current,Vr(Kr,A?C&1|2:C&1),m):(Ba(m),null);case 22:case 23:return f1(),A=m.memoizedState!==null,d!==null&&d.memoizedState!==null!==A&&(m.flags|=8192),A&&(m.mode&1)!==0?($s&1073741824)!==0&&(Ba(m),m.subtreeFlags&6&&(m.flags|=8192)):Ba(m),null;case 24:return null;case 25:return null}throw Error(r(156,m.tag))}function Lj(d,m){switch(mi(m),m.tag){case 1:return zi(m.type)&&vc(),d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 3:return cn(),$r(Bi),$r(Ci),Fi(),d=m.flags,(d&65536)!==0&&(d&128)===0?(m.flags=d&-65537|128,m):null;case 5:return el(m),null;case 13:if($r(Kr),d=m.memoizedState,d!==null&&d.dehydrated!==null){if(m.alternate===null)throw Error(r(340));Cu()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 19:return $r(Kr),null;case 4:return cn(),null;case 10:return pf(m.type._context),null;case 22:case 23:return f1(),null;case 24:return null;default:return null}}var Dv=!1,za=!1,Oj=typeof WeakSet=="function"?WeakSet:Set,kt=null;function Nf(d,m){var C=d.ref;if(C!==null)if(typeof C=="function")try{C(null)}catch(A){Gn(d,m,A)}else C.current=null}function t1(d,m,C){try{C()}catch(A){Gn(d,m,A)}}var tk=!1;function Dj(d,m){if(pt=du,d=Cn(),Nl(d)){if("selectionStart"in d)var C={start:d.selectionStart,end:d.selectionEnd};else e:{C=(C=d.ownerDocument)&&C.defaultView||window;var A=C.getSelection&&C.getSelection();if(A&&A.rangeCount!==0){C=A.anchorNode;var H=A.anchorOffset,Y=A.focusNode;A=A.focusOffset;try{C.nodeType,Y.nodeType}catch{C=null;break e}var se=0,xe=-1,Se=-1,Ie=0,Xe=0,tt=d,Ye=null;t:for(;;){for(var bt;tt!==C||H!==0&&tt.nodeType!==3||(xe=se+H),tt!==Y||A!==0&&tt.nodeType!==3||(Se=se+A),tt.nodeType===3&&(se+=tt.nodeValue.length),(bt=tt.firstChild)!==null;)Ye=tt,tt=bt;for(;;){if(tt===d)break t;if(Ye===C&&++Ie===H&&(xe=se),Ye===Y&&++Xe===A&&(Se=se),(bt=tt.nextSibling)!==null)break;tt=Ye,Ye=tt.parentNode}tt=bt}C=xe===-1||Se===-1?null:{start:xe,end:Se}}else C=null}C=C||{start:0,end:0}}else C=null;for(Dt={focusedElem:d,selectionRange:C},du=!1,kt=m;kt!==null;)if(m=kt,d=m.child,(m.subtreeFlags&1028)!==0&&d!==null)d.return=m,kt=d;else for(;kt!==null;){m=kt;try{var Et=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(Et!==null){var Pt=Et.memoizedProps,ai=Et.memoizedState,Ae=m.stateNode,Ee=Ae.getSnapshotBeforeUpdate(m.elementType===m.type?Pt:Ei(m.type,Pt),ai);Ae.__reactInternalSnapshotBeforeUpdate=Ee}break;case 3:var Re=m.stateNode.containerInfo;Re.nodeType===1?Re.textContent="":Re.nodeType===9&&Re.documentElement&&Re.removeChild(Re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(at){Gn(m,m.return,at)}if(d=m.sibling,d!==null){d.return=m.return,kt=d;break}kt=m.return}return Et=tk,tk=!1,Et}function Kp(d,m,C){var A=m.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var H=A=A.next;do{if((H.tag&d)===d){var Y=H.destroy;H.destroy=void 0,Y!==void 0&&t1(m,C,Y)}H=H.next}while(H!==A)}}function Iv(d,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var C=m=m.next;do{if((C.tag&d)===d){var A=C.create;C.destroy=A()}C=C.next}while(C!==m)}}function r1(d){var m=d.ref;if(m!==null){var C=d.stateNode;d.tag,d=C,typeof m=="function"?m(d):m.current=d}}function rk(d){var m=d.alternate;m!==null&&(d.alternate=null,rk(m)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(m=d.stateNode,m!==null&&(delete m[Da],delete m[Al],delete m[Zo],delete m[af],delete m[sf])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function nk(d){return d.tag===5||d.tag===3||d.tag===4}function ik(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||nk(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function n1(d,m,C){var A=d.tag;if(A===5||A===6)d=d.stateNode,m?C.nodeType===8?C.parentNode.insertBefore(d,m):C.insertBefore(d,m):(C.nodeType===8?(m=C.parentNode,m.insertBefore(d,C)):(m=C,m.appendChild(d)),C=C._reactRootContainer,C!=null||m.onclick!==null||(m.onclick=$e));else if(A!==4&&(d=d.child,d!==null))for(n1(d,m,C),d=d.sibling;d!==null;)n1(d,m,C),d=d.sibling}function i1(d,m,C){var A=d.tag;if(A===5||A===6)d=d.stateNode,m?C.insertBefore(d,m):C.appendChild(d);else if(A!==4&&(d=d.child,d!==null))for(i1(d,m,C),d=d.sibling;d!==null;)i1(d,m,C),d=d.sibling}var va=null,nl=!1;function Oc(d,m,C){for(C=C.child;C!==null;)ak(d,m,C),C=C.sibling}function ak(d,m,C){if(pn&&typeof pn.onCommitFiberUnmount=="function")try{pn.onCommitFiberUnmount(ta,C)}catch{}switch(C.tag){case 5:za||Nf(C,m);case 6:var A=va,H=nl;va=null,Oc(d,m,C),va=A,nl=H,va!==null&&(nl?(d=va,C=C.stateNode,d.nodeType===8?d.parentNode.removeChild(C):d.removeChild(C)):va.removeChild(C.stateNode));break;case 18:va!==null&&(nl?(d=va,C=C.stateNode,d.nodeType===8?gc(d.parentNode,C):d.nodeType===1&&gc(d,C),_n(d)):gc(va,C.stateNode));break;case 4:A=va,H=nl,va=C.stateNode.containerInfo,nl=!0,Oc(d,m,C),va=A,nl=H;break;case 0:case 11:case 14:case 15:if(!za&&(A=C.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){H=A=A.next;do{var Y=H,se=Y.destroy;Y=Y.tag,se!==void 0&&((Y&2)!==0||(Y&4)!==0)&&t1(C,m,se),H=H.next}while(H!==A)}Oc(d,m,C);break;case 1:if(!za&&(Nf(C,m),A=C.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=C.memoizedProps,A.state=C.memoizedState,A.componentWillUnmount()}catch(xe){Gn(C,m,xe)}Oc(d,m,C);break;case 21:Oc(d,m,C);break;case 22:C.mode&1?(za=(A=za)||C.memoizedState!==null,Oc(d,m,C),za=A):Oc(d,m,C);break;default:Oc(d,m,C)}}function sk(d){var m=d.updateQueue;if(m!==null){d.updateQueue=null;var C=d.stateNode;C===null&&(C=d.stateNode=new Oj),m.forEach(function(A){var H=qj.bind(null,d,A);C.has(A)||(C.add(A),A.then(H,H))})}}function il(d,m){var C=m.deletions;if(C!==null)for(var A=0;A<C.length;A++){var H=C[A];try{var Y=d,se=m,xe=se;e:for(;xe!==null;){switch(xe.tag){case 5:va=xe.stateNode,nl=!1;break e;case 3:va=xe.stateNode.containerInfo,nl=!0;break e;case 4:va=xe.stateNode.containerInfo,nl=!0;break e}xe=xe.return}if(va===null)throw Error(r(160));ak(Y,se,H),va=null,nl=!1;var Se=H.alternate;Se!==null&&(Se.return=null),H.return=null}catch(Ie){Gn(H,m,Ie)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)ok(m,d),m=m.sibling}function ok(d,m){var C=d.alternate,A=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(il(m,d),Ul(d),A&4){try{Kp(3,d,d.return),Iv(3,d)}catch(Pt){Gn(d,d.return,Pt)}try{Kp(5,d,d.return)}catch(Pt){Gn(d,d.return,Pt)}}break;case 1:il(m,d),Ul(d),A&512&&C!==null&&Nf(C,C.return);break;case 5:if(il(m,d),Ul(d),A&512&&C!==null&&Nf(C,C.return),d.flags&32){var H=d.stateNode;try{xt(H,"")}catch(Pt){Gn(d,d.return,Pt)}}if(A&4&&(H=d.stateNode,H!=null)){var Y=d.memoizedProps,se=C!==null?C.memoizedProps:Y,xe=d.type,Se=d.updateQueue;if(d.updateQueue=null,Se!==null)try{xe==="input"&&Y.type==="radio"&&Y.name!=null&&Ue(H,Y),je(xe,se);var Ie=je(xe,Y);for(se=0;se<Se.length;se+=2){var Xe=Se[se],tt=Se[se+1];Xe==="style"?ve(H,tt):Xe==="dangerouslySetInnerHTML"?Wt(H,tt):Xe==="children"?xt(H,tt):E(H,Xe,tt,Ie)}switch(xe){case"input":Ve(H,Y);break;case"textarea":et(H,Y);break;case"select":var Ye=H._wrapperState.wasMultiple;H._wrapperState.wasMultiple=!!Y.multiple;var bt=Y.value;bt!=null?Ce(H,!!Y.multiple,bt,!1):Ye!==!!Y.multiple&&(Y.defaultValue!=null?Ce(H,!!Y.multiple,Y.defaultValue,!0):Ce(H,!!Y.multiple,Y.multiple?[]:"",!1))}H[Al]=Y}catch(Pt){Gn(d,d.return,Pt)}}break;case 6:if(il(m,d),Ul(d),A&4){if(d.stateNode===null)throw Error(r(162));H=d.stateNode,Y=d.memoizedProps;try{H.nodeValue=Y}catch(Pt){Gn(d,d.return,Pt)}}break;case 3:if(il(m,d),Ul(d),A&4&&C!==null&&C.memoizedState.isDehydrated)try{_n(m.containerInfo)}catch(Pt){Gn(d,d.return,Pt)}break;case 4:il(m,d),Ul(d);break;case 13:il(m,d),Ul(d),H=d.child,H.flags&8192&&(Y=H.memoizedState!==null,H.stateNode.isHidden=Y,!Y||H.alternate!==null&&H.alternate.memoizedState!==null||(o1=Xr())),A&4&&sk(d);break;case 22:if(Xe=C!==null&&C.memoizedState!==null,d.mode&1?(za=(Ie=za)||Xe,il(m,d),za=Ie):il(m,d),Ul(d),A&8192){if(Ie=d.memoizedState!==null,(d.stateNode.isHidden=Ie)&&!Xe&&(d.mode&1)!==0)for(kt=d,Xe=d.child;Xe!==null;){for(tt=kt=Xe;kt!==null;){switch(Ye=kt,bt=Ye.child,Ye.tag){case 0:case 11:case 14:case 15:Kp(4,Ye,Ye.return);break;case 1:Nf(Ye,Ye.return);var Et=Ye.stateNode;if(typeof Et.componentWillUnmount=="function"){A=Ye,C=Ye.return;try{m=A,Et.props=m.memoizedProps,Et.state=m.memoizedState,Et.componentWillUnmount()}catch(Pt){Gn(A,C,Pt)}}break;case 5:Nf(Ye,Ye.return);break;case 22:if(Ye.memoizedState!==null){ck(tt);continue}}bt!==null?(bt.return=Ye,kt=bt):ck(tt)}Xe=Xe.sibling}e:for(Xe=null,tt=d;;){if(tt.tag===5){if(Xe===null){Xe=tt;try{H=tt.stateNode,Ie?(Y=H.style,typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none"):(xe=tt.stateNode,Se=tt.memoizedProps.style,se=Se!=null&&Se.hasOwnProperty("display")?Se.display:null,xe.style.display=ue("display",se))}catch(Pt){Gn(d,d.return,Pt)}}}else if(tt.tag===6){if(Xe===null)try{tt.stateNode.nodeValue=Ie?"":tt.memoizedProps}catch(Pt){Gn(d,d.return,Pt)}}else if((tt.tag!==22&&tt.tag!==23||tt.memoizedState===null||tt===d)&&tt.child!==null){tt.child.return=tt,tt=tt.child;continue}if(tt===d)break e;for(;tt.sibling===null;){if(tt.return===null||tt.return===d)break e;Xe===tt&&(Xe=null),tt=tt.return}Xe===tt&&(Xe=null),tt.sibling.return=tt.return,tt=tt.sibling}}break;case 19:il(m,d),Ul(d),A&4&&sk(d);break;case 21:break;default:il(m,d),Ul(d)}}function Ul(d){var m=d.flags;if(m&2){try{e:{for(var C=d.return;C!==null;){if(nk(C)){var A=C;break e}C=C.return}throw Error(r(160))}switch(A.tag){case 5:var H=A.stateNode;A.flags&32&&(xt(H,""),A.flags&=-33);var Y=ik(d);i1(d,Y,H);break;case 3:case 4:var se=A.stateNode.containerInfo,xe=ik(d);n1(d,xe,se);break;default:throw Error(r(161))}}catch(Se){Gn(d,d.return,Se)}d.flags&=-3}m&4096&&(d.flags&=-4097)}function Ij(d,m,C){kt=d,lk(d)}function lk(d,m,C){for(var A=(d.mode&1)!==0;kt!==null;){var H=kt,Y=H.child;if(H.tag===22&&A){var se=H.memoizedState!==null||Dv;if(!se){var xe=H.alternate,Se=xe!==null&&xe.memoizedState!==null||za;xe=Dv;var Ie=za;if(Dv=se,(za=Se)&&!Ie)for(kt=H;kt!==null;)se=kt,Se=se.child,se.tag===22&&se.memoizedState!==null?dk(H):Se!==null?(Se.return=se,kt=Se):dk(H);for(;Y!==null;)kt=Y,lk(Y),Y=Y.sibling;kt=H,Dv=xe,za=Ie}uk(d)}else(H.subtreeFlags&8772)!==0&&Y!==null?(Y.return=H,kt=Y):uk(d)}}function uk(d){for(;kt!==null;){var m=kt;if((m.flags&8772)!==0){var C=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:za||Iv(5,m);break;case 1:var A=m.stateNode;if(m.flags&4&&!za)if(C===null)A.componentDidMount();else{var H=m.elementType===m.type?C.memoizedProps:Ei(m.type,C.memoizedProps);A.componentDidUpdate(H,C.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var Y=m.updateQueue;Y!==null&&Tn(m,Y,A);break;case 3:var se=m.updateQueue;if(se!==null){if(C=null,m.child!==null)switch(m.child.tag){case 5:C=m.child.stateNode;break;case 1:C=m.child.stateNode}Tn(m,se,C)}break;case 5:var xe=m.stateNode;if(C===null&&m.flags&4){C=xe;var Se=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":Se.autoFocus&&C.focus();break;case"img":Se.src&&(C.src=Se.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var Ie=m.alternate;if(Ie!==null){var Xe=Ie.memoizedState;if(Xe!==null){var tt=Xe.dehydrated;tt!==null&&_n(tt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}za||m.flags&512&&r1(m)}catch(Ye){Gn(m,m.return,Ye)}}if(m===d){kt=null;break}if(C=m.sibling,C!==null){C.return=m.return,kt=C;break}kt=m.return}}function ck(d){for(;kt!==null;){var m=kt;if(m===d){kt=null;break}var C=m.sibling;if(C!==null){C.return=m.return,kt=C;break}kt=m.return}}function dk(d){for(;kt!==null;){var m=kt;try{switch(m.tag){case 0:case 11:case 15:var C=m.return;try{Iv(4,m)}catch(Se){Gn(m,C,Se)}break;case 1:var A=m.stateNode;if(typeof A.componentDidMount=="function"){var H=m.return;try{A.componentDidMount()}catch(Se){Gn(m,H,Se)}}var Y=m.return;try{r1(m)}catch(Se){Gn(m,Y,Se)}break;case 5:var se=m.return;try{r1(m)}catch(Se){Gn(m,se,Se)}}}catch(Se){Gn(m,m.return,Se)}if(m===d){kt=null;break}var xe=m.sibling;if(xe!==null){xe.return=m.return,kt=xe;break}kt=m.return}}var Bj=Math.ceil,Bv=T.ReactCurrentDispatcher,a1=T.ReactCurrentOwner,xo=T.ReactCurrentBatchConfig,br=0,Gi=null,gi=null,ya=0,$s=0,Tf=Xo(0),Ni=0,Zp=null,ah=0,zv=0,s1=0,Yp=null,Ss=null,o1=0,Pf=1/0,Mu=null,Fv=!1,l1=null,Dc=null,Vv=!1,Ic=null,Uv=0,Xp=0,u1=null,Hv=-1,Gv=0;function as(){return(br&6)!==0?Xr():Hv!==-1?Hv:Hv=Xr()}function Bc(d){return(d.mode&1)===0?1:(br&2)!==0&&ya!==0?ya&-ya:Ip.transition!==null?(Gv===0&&(Gv=Bd()),Gv):(d=rr,d!==0||(d=window.event,d=d===void 0?16:sr(d.type)),d)}function al(d,m,C,A){if(50<Xp)throw Xp=0,u1=null,Error(r(185));$a(d,C,A),((br&2)===0||d!==Gi)&&(d===Gi&&((br&2)===0&&(zv|=C),Ni===4&&zc(d,ya)),ks(d,A),C===1&&br===0&&(m.mode&1)===0&&(Pf=Xr()+500,yc&&Rl()))}function ks(d,m){var C=d.callbackNode;uu(d,m);var A=yr(d,d===Gi?ya:0);if(A===0)C!==null&&ou(C),d.callbackNode=null,d.callbackPriority=0;else if(m=A&-A,d.callbackPriority!==m){if(C!=null&&ou(C),m===1)d.tag===0?Qo(fk.bind(null,d)):Yd(fk.bind(null,d)),ki(function(){(br&6)===0&&Rl()}),C=null;else{switch(zs(A)){case 1:C=Is;break;case 4:C=pl;break;case 16:C=Ta;break;case 536870912:C=ea;break;default:C=Ta}C=wk(C,hk.bind(null,d))}d.callbackPriority=m,d.callbackNode=C}}function hk(d,m){if(Hv=-1,Gv=0,(br&6)!==0)throw Error(r(327));var C=d.callbackNode;if(Mf()&&d.callbackNode!==C)return null;var A=yr(d,d===Gi?ya:0);if(A===0)return null;if((A&30)!==0||(A&d.expiredLanes)!==0||m)m=qv(d,A);else{m=A;var H=br;br|=2;var Y=mk();(Gi!==d||ya!==m)&&(Mu=null,Pf=Xr()+500,oh(d,m));do try{Vj();break}catch(xe){pk(d,xe)}while(!0);ff(),Bv.current=Y,br=H,gi!==null?m=0:(Gi=null,ya=0,m=Ni)}if(m!==0){if(m===2&&(H=Xn(d),H!==0&&(A=H,m=c1(d,H))),m===1)throw C=Zp,oh(d,0),zc(d,A),ks(d,Xr()),C;if(m===6)zc(d,A);else{if(H=d.current.alternate,(A&30)===0&&!zj(H)&&(m=qv(d,A),m===2&&(Y=Xn(d),Y!==0&&(A=Y,m=c1(d,Y))),m===1))throw C=Zp,oh(d,0),zc(d,A),ks(d,Xr()),C;switch(d.finishedWork=H,d.finishedLanes=A,m){case 0:case 1:throw Error(r(345));case 2:lh(d,Ss,Mu);break;case 3:if(zc(d,A),(A&130023424)===A&&(m=o1+500-Xr(),10<m)){if(yr(d,0)!==0)break;if(H=d.suspendedLanes,(H&A)!==A){as(),d.pingedLanes|=d.suspendedLanes&H;break}d.timeoutHandle=Mr(lh.bind(null,d,Ss,Mu),m);break}lh(d,Ss,Mu);break;case 4:if(zc(d,A),(A&4194240)===A)break;for(m=d.eventTimes,H=-1;0<A;){var se=31-ot(A);Y=1<<se,se=m[se],se>H&&(H=se),A&=~Y}if(A=H,A=Xr()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*Bj(A/1960))-A,10<A){d.timeoutHandle=Mr(lh.bind(null,d,Ss,Mu),A);break}lh(d,Ss,Mu);break;case 5:lh(d,Ss,Mu);break;default:throw Error(r(329))}}}return ks(d,Xr()),d.callbackNode===C?hk.bind(null,d):null}function c1(d,m){var C=Yp;return d.current.memoizedState.isDehydrated&&(oh(d,m).flags|=256),d=qv(d,m),d!==2&&(m=Ss,Ss=C,m!==null&&d1(m)),d}function d1(d){Ss===null?Ss=d:Ss.push.apply(Ss,d)}function zj(d){for(var m=d;;){if(m.flags&16384){var C=m.updateQueue;if(C!==null&&(C=C.stores,C!==null))for(var A=0;A<C.length;A++){var H=C[A],Y=H.getSnapshot;H=H.value;try{if(!Di(Y(),H))return!1}catch{return!1}}}if(C=m.child,m.subtreeFlags&16384&&C!==null)C.return=m,m=C;else{if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function zc(d,m){for(m&=~s1,m&=~zv,d.suspendedLanes|=m,d.pingedLanes&=~m,d=d.expirationTimes;0<m;){var C=31-ot(m),A=1<<C;d[C]=-1,m&=~A}}function fk(d){if((br&6)!==0)throw Error(r(327));Mf();var m=yr(d,0);if((m&1)===0)return ks(d,Xr()),null;var C=qv(d,m);if(d.tag!==0&&C===2){var A=Xn(d);A!==0&&(m=A,C=c1(d,A))}if(C===1)throw C=Zp,oh(d,0),zc(d,m),ks(d,Xr()),C;if(C===6)throw Error(r(345));return d.finishedWork=d.current.alternate,d.finishedLanes=m,lh(d,Ss,Mu),ks(d,Xr()),null}function h1(d,m){var C=br;br|=1;try{return d(m)}finally{br=C,br===0&&(Pf=Xr()+500,yc&&Rl())}}function sh(d){Ic!==null&&Ic.tag===0&&(br&6)===0&&Mf();var m=br;br|=1;var C=xo.transition,A=rr;try{if(xo.transition=null,rr=1,d)return d()}finally{rr=A,xo.transition=C,br=m,(br&6)===0&&Rl()}}function f1(){$s=Tf.current,$r(Tf)}function oh(d,m){d.finishedWork=null,d.finishedLanes=0;var C=d.timeoutHandle;if(C!==-1&&(d.timeoutHandle=-1,En(C)),gi!==null)for(C=gi.return;C!==null;){var A=C;switch(mi(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&vc();break;case 3:cn(),$r(Bi),$r(Ci),Fi();break;case 5:el(A);break;case 4:cn();break;case 13:$r(Kr);break;case 19:$r(Kr);break;case 10:pf(A.type._context);break;case 22:case 23:f1()}C=C.return}if(Gi=d,gi=d=Fc(d.current,null),ya=$s=m,Ni=0,Zp=null,s1=zv=ah=0,Ss=Yp=null,po!==null){for(m=0;m<po.length;m++)if(C=po[m],A=C.interleaved,A!==null){C.interleaved=null;var H=A.next,Y=C.pending;if(Y!==null){var se=Y.next;Y.next=H,A.next=se}C.pending=A}po=null}return d}function pk(d,m){do{var C=gi;try{if(ff(),Ec.current=Ac,Ws){for(var A=Dr.memoizedState;A!==null;){var H=A.queue;H!==null&&(H.pending=null),A=A.next}Ws=!1}if(ma=0,Un=Pn=Dr=null,Bl=!1,_s=0,a1.current=null,C===null||C.return===null){Ni=1,Zp=m,gi=null;break}e:{var Y=d,se=C.return,xe=C,Se=m;if(m=ya,xe.flags|=32768,Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var Ie=Se,Xe=xe,tt=Xe.tag;if((Xe.mode&1)===0&&(tt===0||tt===11||tt===15)){var Ye=Xe.alternate;Ye?(Xe.updateQueue=Ye.updateQueue,Xe.memoizedState=Ye.memoizedState,Xe.lanes=Ye.lanes):(Xe.updateQueue=null,Xe.memoizedState=null)}var bt=M(se);if(bt!==null){bt.flags&=-257,z(bt,se,xe,Y,m),bt.mode&1&&b(Y,Ie,m),m=bt,Se=Ie;var Et=m.updateQueue;if(Et===null){var Pt=new Set;Pt.add(Se),m.updateQueue=Pt}else Et.add(Se);break e}else{if((m&1)===0){b(Y,Ie,m),p1();break e}Se=Error(r(426))}}else if(Ar&&xe.mode&1){var ai=M(se);if(ai!==null){(ai.flags&65536)===0&&(ai.flags|=256),z(ai,se,xe,Y,m),Qd(Pu(Se,xe));break e}}Y=Se=Pu(Se,xe),Ni!==4&&(Ni=2),Yp===null?Yp=[Y]:Yp.push(Y),Y=se;do{switch(Y.tag){case 3:Y.flags|=65536,m&=-m,Y.lanes|=m;var Ae=Ov(Y,Se,m);rh(Y,Ae);break e;case 1:xe=Se;var Ee=Y.type,Re=Y.stateNode;if((Y.flags&128)===0&&(typeof Ee.getDerivedStateFromError=="function"||Re!==null&&typeof Re.componentDidCatch=="function"&&(Dc===null||!Dc.has(Re)))){Y.flags|=65536,m&=-m,Y.lanes|=m;var at=y(Y,xe,m);rh(Y,at);break e}}Y=Y.return}while(Y!==null)}vk(C)}catch(At){m=At,gi===C&&C!==null&&(gi=C=C.return);continue}break}while(!0)}function mk(){var d=Bv.current;return Bv.current=Ac,d===null?Ac:d}function p1(){(Ni===0||Ni===3||Ni===2)&&(Ni=4),Gi===null||(ah&268435455)===0&&(zv&268435455)===0||zc(Gi,ya)}function qv(d,m){var C=br;br|=2;var A=mk();(Gi!==d||ya!==m)&&(Mu=null,oh(d,m));do try{Fj();break}catch(H){pk(d,H)}while(!0);if(ff(),br=C,Bv.current=A,gi!==null)throw Error(r(261));return Gi=null,ya=0,Ni}function Fj(){for(;gi!==null;)gk(gi)}function Vj(){for(;gi!==null&&!Id();)gk(gi)}function gk(d){var m=bk(d.alternate,d,$s);d.memoizedProps=d.pendingProps,m===null?vk(d):gi=m,a1.current=null}function vk(d){var m=d;do{var C=m.alternate;if(d=m.return,(m.flags&32768)===0){if(C=Rj(C,m,$s),C!==null){gi=C;return}}else{if(C=Lj(C,m),C!==null){C.flags&=32767,gi=C;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{Ni=6,gi=null;return}}if(m=m.sibling,m!==null){gi=m;return}gi=m=d}while(m!==null);Ni===0&&(Ni=5)}function lh(d,m,C){var A=rr,H=xo.transition;try{xo.transition=null,rr=1,Uj(d,m,C,A)}finally{xo.transition=H,rr=A}return null}function Uj(d,m,C,A){do Mf();while(Ic!==null);if((br&6)!==0)throw Error(r(327));C=d.finishedWork;var H=d.finishedLanes;if(C===null)return null;if(d.finishedWork=null,d.finishedLanes=0,C===d.current)throw Error(r(177));d.callbackNode=null,d.callbackPriority=0;var Y=C.lanes|C.childLanes;if(bn(d,Y),d===Gi&&(gi=Gi=null,ya=0),(C.subtreeFlags&2064)===0&&(C.flags&2064)===0||Vv||(Vv=!0,wk(Ta,function(){return Mf(),null})),Y=(C.flags&15990)!==0,(C.subtreeFlags&15990)!==0||Y){Y=xo.transition,xo.transition=null;var se=rr;rr=1;var xe=br;br|=4,a1.current=null,Dj(d,C),ok(C,d),Ii(Dt),du=!!pt,Dt=pt=null,d.current=C,Ij(C),fl(),br=xe,rr=se,xo.transition=Y}else d.current=C;if(Vv&&(Vv=!1,Ic=d,Uv=H),Y=d.pendingLanes,Y===0&&(Dc=null),vr(C.stateNode),ks(d,Xr()),m!==null)for(A=d.onRecoverableError,C=0;C<m.length;C++)H=m[C],A(H.value,{componentStack:H.stack,digest:H.digest});if(Fv)throw Fv=!1,d=l1,l1=null,d;return(Uv&1)!==0&&d.tag!==0&&Mf(),Y=d.pendingLanes,(Y&1)!==0?d===u1?Xp++:(Xp=0,u1=d):Xp=0,Rl(),null}function Mf(){if(Ic!==null){var d=zs(Uv),m=xo.transition,C=rr;try{if(xo.transition=null,rr=16>d?16:d,Ic===null)var A=!1;else{if(d=Ic,Ic=null,Uv=0,(br&6)!==0)throw Error(r(331));var H=br;for(br|=4,kt=d.current;kt!==null;){var Y=kt,se=Y.child;if((kt.flags&16)!==0){var xe=Y.deletions;if(xe!==null){for(var Se=0;Se<xe.length;Se++){var Ie=xe[Se];for(kt=Ie;kt!==null;){var Xe=kt;switch(Xe.tag){case 0:case 11:case 15:Kp(8,Xe,Y)}var tt=Xe.child;if(tt!==null)tt.return=Xe,kt=tt;else for(;kt!==null;){Xe=kt;var Ye=Xe.sibling,bt=Xe.return;if(rk(Xe),Xe===Ie){kt=null;break}if(Ye!==null){Ye.return=bt,kt=Ye;break}kt=bt}}}var Et=Y.alternate;if(Et!==null){var Pt=Et.child;if(Pt!==null){Et.child=null;do{var ai=Pt.sibling;Pt.sibling=null,Pt=ai}while(Pt!==null)}}kt=Y}}if((Y.subtreeFlags&2064)!==0&&se!==null)se.return=Y,kt=se;else e:for(;kt!==null;){if(Y=kt,(Y.flags&2048)!==0)switch(Y.tag){case 0:case 11:case 15:Kp(9,Y,Y.return)}var Ae=Y.sibling;if(Ae!==null){Ae.return=Y.return,kt=Ae;break e}kt=Y.return}}var Ee=d.current;for(kt=Ee;kt!==null;){se=kt;var Re=se.child;if((se.subtreeFlags&2064)!==0&&Re!==null)Re.return=se,kt=Re;else e:for(se=Ee;kt!==null;){if(xe=kt,(xe.flags&2048)!==0)try{switch(xe.tag){case 0:case 11:case 15:Iv(9,xe)}}catch(At){Gn(xe,xe.return,At)}if(xe===se){kt=null;break e}var at=xe.sibling;if(at!==null){at.return=xe.return,kt=at;break e}kt=xe.return}}if(br=H,Rl(),pn&&typeof pn.onPostCommitFiberRoot=="function")try{pn.onPostCommitFiberRoot(ta,d)}catch{}A=!0}return A}finally{rr=C,xo.transition=m}}return!1}function yk(d,m,C){m=Pu(C,m),m=Ov(d,m,1),d=vo(d,m,1),m=as(),d!==null&&($a(d,1,m),ks(d,m))}function Gn(d,m,C){if(d.tag===3)yk(d,d,C);else for(;m!==null;){if(m.tag===3){yk(m,d,C);break}else if(m.tag===1){var A=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(Dc===null||!Dc.has(A))){d=Pu(C,d),d=y(m,d,1),m=vo(m,d,1),d=as(),m!==null&&($a(m,1,d),ks(m,d));break}}m=m.return}}function Hj(d,m,C){var A=d.pingCache;A!==null&&A.delete(m),m=as(),d.pingedLanes|=d.suspendedLanes&C,Gi===d&&(ya&C)===C&&(Ni===4||Ni===3&&(ya&130023424)===ya&&500>Xr()-o1?oh(d,0):s1|=C),ks(d,m)}function xk(d,m){m===0&&((d.mode&1)===0?m=1:(m=ra,ra<<=1,(ra&130023424)===0&&(ra=4194304)));var C=as();d=ns(d,m),d!==null&&($a(d,m,C),ks(d,C))}function Gj(d){var m=d.memoizedState,C=0;m!==null&&(C=m.retryLane),xk(d,C)}function qj(d,m){var C=0;switch(d.tag){case 13:var A=d.stateNode,H=d.memoizedState;H!==null&&(C=H.retryLane);break;case 19:A=d.stateNode;break;default:throw Error(r(314))}A!==null&&A.delete(m),xk(d,C)}var bk;bk=function(d,m,C){if(d!==null)if(d.memoizedProps!==m.pendingProps||Bi.current)ee=!0;else{if((d.lanes&C)===0&&(m.flags&128)===0)return ee=!1,Jx(d,m,C);ee=(d.flags&131072)!==0}else ee=!1,Ar&&(m.flags&1048576)!==0&&kv(m,Ol,m.index);switch(m.lanes=0,m.tag){case 2:var A=m.type;pr(d,m),d=m.pendingProps;var H=bu(m,Ci.current);Jo(m,C),H=Nc(null,m,A,d,H,C);var Y=Tc();return m.flags|=1,typeof H=="object"&&H!==null&&typeof H.render=="function"&&H.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,zi(A)?(Y=!0,wu(m)):Y=!1,m.memoizedState=H.state!==null&&H.state!==void 0?H.state:null,th(m),H.updater=Rc,m.stateNode=H,H._reactInternals=m,Cf(m,A,d,C),m=jr(null,m,A,!0,Y,C)):(m.tag=0,Ar&&Y&&xc(m),he(null,m,H,C),m=m.child),m;case 16:A=m.elementType;e:{switch(pr(d,m),d=m.pendingProps,H=A._init,A=H(A._payload),m.type=A,H=m.tag=$j(A),d=Ei(A,d),H){case 0:m=mt(null,m,A,d,C);break e;case 1:m=Zr(null,m,A,d,C);break e;case 11:m=Te(null,m,A,d,C);break e;case 14:m=Be(null,m,A,Ei(A.type,d),C);break e}throw Error(r(306,A,""))}return m;case 0:return A=m.type,H=m.pendingProps,H=m.elementType===A?H:Ei(A,H),mt(d,m,A,H,C);case 1:return A=m.type,H=m.pendingProps,H=m.elementType===A?H:Ei(A,H),Zr(d,m,A,H,C);case 3:e:{if(ga(m),d===null)throw Error(r(387));A=m.pendingProps,Y=m.memoizedState,H=Y.element,gf(d,m),Sc(m,A,null,C);var se=m.memoizedState;if(A=se.element,Y.isDehydrated)if(Y={element:A,isDehydrated:!1,cache:se.cache,pendingSuspenseBoundaries:se.pendingSuspenseBoundaries,transitions:se.transitions},m.updateQueue.baseState=Y,m.memoizedState=Y,m.flags&256){H=Pu(Error(r(423)),m),m=yo(d,m,A,C,H);break e}else if(A!==H){H=Pu(Error(r(424)),m),m=yo(d,m,A,C,H);break e}else for(ct=bs(m.stateNode.containerInfo.firstChild),es=m,Ar=!0,ts=null,C=ws(m,null,A,C),m.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(Cu(),A===H){m=Hi(d,m,C);break e}he(d,m,A,C)}m=m.child}return m;case 5:return kc(m),d===null&&bc(m),A=m.type,H=m.pendingProps,Y=d!==null?d.memoizedProps:null,se=H.children,Xt(A,H)?se=null:Y!==null&&Xt(A,Y)&&(m.flags|=32),Kt(d,m),he(d,m,se,C),m.child;case 6:return d===null&&bc(m),null;case 13:return Fe(d,m,C);case 4:return Il(m,m.stateNode.containerInfo),A=m.pendingProps,d===null?m.child=Eu(m,null,A,C):he(d,m,A,C),m.child;case 11:return A=m.type,H=m.pendingProps,H=m.elementType===A?H:Ei(A,H),Te(d,m,A,H,C);case 7:return he(d,m,m.pendingProps,C),m.child;case 8:return he(d,m,m.pendingProps.children,C),m.child;case 12:return he(d,m,m.pendingProps.children,C),m.child;case 10:e:{if(A=m.type._context,H=m.pendingProps,Y=m.memoizedProps,se=H.value,Vr(Jd,A._currentValue),A._currentValue=se,Y!==null)if(Di(Y.value,se)){if(Y.children===H.children&&!Bi.current){m=Hi(d,m,C);break e}}else for(Y=m.child,Y!==null&&(Y.return=m);Y!==null;){var xe=Y.dependencies;if(xe!==null){se=Y.child;for(var Se=xe.firstContext;Se!==null;){if(Se.context===A){if(Y.tag===1){Se=go(-1,C&-C),Se.tag=2;var Ie=Y.updateQueue;if(Ie!==null){Ie=Ie.shared;var Xe=Ie.pending;Xe===null?Se.next=Se:(Se.next=Xe.next,Xe.next=Se),Ie.pending=Se}}Y.lanes|=C,Se=Y.alternate,Se!==null&&(Se.lanes|=C),mf(Y.return,C,m),xe.lanes|=C;break}Se=Se.next}}else if(Y.tag===10)se=Y.type===m.type?null:Y.child;else if(Y.tag===18){if(se=Y.return,se===null)throw Error(r(341));se.lanes|=C,xe=se.alternate,xe!==null&&(xe.lanes|=C),mf(se,C,m),se=Y.sibling}else se=Y.child;if(se!==null)se.return=Y;else for(se=Y;se!==null;){if(se===m){se=null;break}if(Y=se.sibling,Y!==null){Y.return=se.return,se=Y;break}se=se.return}Y=se}he(d,m,H.children,C),m=m.child}return m;case 9:return H=m.type,A=m.pendingProps.children,Jo(m,C),H=pa(H),A=A(H),m.flags|=1,he(d,m,A,C),m.child;case 14:return A=m.type,H=Ei(A,m.pendingProps),H=Ei(A.type,H),Be(d,m,A,H,C);case 15:return nt(d,m,m.type,m.pendingProps,C);case 17:return A=m.type,H=m.pendingProps,H=m.elementType===A?H:Ei(A,H),pr(d,m),m.tag=1,zi(A)?(d=!0,wu(m)):d=!1,Jo(m,C),Lv(m,A,H),Cf(m,A,H,C),jr(null,m,A,!0,d,C);case 19:return ii(d,m,C);case 22:return St(d,m,C)}throw Error(r(156,m.tag))};function wk(d,m){return su(d,m)}function Wj(d,m,C,A){this.tag=d,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bo(d,m,C,A){return new Wj(d,m,C,A)}function m1(d){return d=d.prototype,!(!d||!d.isReactComponent)}function $j(d){if(typeof d=="function")return m1(d)?1:0;if(d!=null){if(d=d.$$typeof,d===Z)return 11;if(d===F)return 14}return 2}function Fc(d,m){var C=d.alternate;return C===null?(C=bo(d.tag,m,d.key,d.mode),C.elementType=d.elementType,C.type=d.type,C.stateNode=d.stateNode,C.alternate=d,d.alternate=C):(C.pendingProps=m,C.type=d.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=d.flags&14680064,C.childLanes=d.childLanes,C.lanes=d.lanes,C.child=d.child,C.memoizedProps=d.memoizedProps,C.memoizedState=d.memoizedState,C.updateQueue=d.updateQueue,m=d.dependencies,C.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},C.sibling=d.sibling,C.index=d.index,C.ref=d.ref,C}function Wv(d,m,C,A,H,Y){var se=2;if(A=d,typeof d=="function")m1(d)&&(se=1);else if(typeof d=="string")se=5;else e:switch(d){case D:return uh(C.children,H,Y,m);case B:se=8,H|=8;break;case I:return d=bo(12,C,m,H|2),d.elementType=I,d.lanes=Y,d;case O:return d=bo(13,C,m,H),d.elementType=O,d.lanes=Y,d;case W:return d=bo(19,C,m,H),d.elementType=W,d.lanes=Y,d;case X:return $v(C,H,Y,m);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case V:se=10;break e;case $:se=9;break e;case Z:se=11;break e;case F:se=14;break e;case K:se=16,A=null;break e}throw Error(r(130,d==null?d:typeof d,""))}return m=bo(se,C,m,H),m.elementType=d,m.type=A,m.lanes=Y,m}function uh(d,m,C,A){return d=bo(7,d,A,m),d.lanes=C,d}function $v(d,m,C,A){return d=bo(22,d,A,m),d.elementType=X,d.lanes=C,d.stateNode={isHidden:!1},d}function g1(d,m,C){return d=bo(6,d,null,m),d.lanes=C,d}function v1(d,m,C){return m=bo(4,d.children!==null?d.children:[],d.key,m),m.lanes=C,m.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},m}function Kj(d,m,C,A,H){this.tag=m,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=di(0),this.expirationTimes=di(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=di(0),this.identifierPrefix=A,this.onRecoverableError=H,this.mutableSourceEagerHydrationData=null}function y1(d,m,C,A,H,Y,se,xe,Se){return d=new Kj(d,m,C,xe,Se),m===1?(m=1,Y===!0&&(m|=8)):m=0,Y=bo(3,null,null,m),d.current=Y,Y.stateNode=d,Y.memoizedState={element:A,isDehydrated:C,cache:null,transitions:null,pendingSuspenseBoundaries:null},th(Y),d}function Zj(d,m,C){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:A==null?null:""+A,children:d,containerInfo:m,implementation:C}}function _k(d){if(!d)return ho;d=d._reactInternals;e:{if(ui(d)!==d||d.tag!==1)throw Error(r(170));var m=d;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(zi(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(r(171))}if(d.tag===1){var C=d.type;if(zi(C))return lf(d,C,m)}return m}function Sk(d,m,C,A,H,Y,se,xe,Se){return d=y1(C,A,!0,d,H,Y,se,xe,Se),d.context=_k(null),C=d.current,A=as(),H=Bc(C),Y=go(A,H),Y.callback=m??null,vo(C,Y,H),d.current.lanes=H,$a(d,H,A),ks(d,A),d}function Kv(d,m,C,A){var H=m.current,Y=as(),se=Bc(H);return C=_k(C),m.context===null?m.context=C:m.pendingContext=C,m=go(Y,se),m.payload={element:d},A=A===void 0?null:A,A!==null&&(m.callback=A),d=vo(H,m,se),d!==null&&(al(d,H,se,Y),vf(d,H,se)),se}function Zv(d){return d=d.current,d.child?(d.child.tag===5,d.child.stateNode):null}function kk(d,m){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var C=d.retryLane;d.retryLane=C!==0&&C<m?C:m}}function x1(d,m){kk(d,m),(d=d.alternate)&&kk(d,m)}function Yj(){return null}var Ck=typeof reportError=="function"?reportError:function(d){console.error(d)};function b1(d){this._internalRoot=d}Yv.prototype.render=b1.prototype.render=function(d){var m=this._internalRoot;if(m===null)throw Error(r(409));Kv(d,m,null,null)},Yv.prototype.unmount=b1.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var m=d.containerInfo;sh(function(){Kv(null,d,null,null)}),m[xr]=null}};function Yv(d){this._internalRoot=d}Yv.prototype.unstable_scheduleHydration=function(d){if(d){var m=tc();d={blockedOn:null,target:d,priority:m};for(var C=0;C<On.length&&m!==0&&m<On[C].priority;C++);On.splice(C,0,d),C===0&&gl(d)}};function w1(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function Xv(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function Ek(){}function Xj(d,m,C,A,H){if(H){if(typeof A=="function"){var Y=A;A=function(){var Ie=Zv(se);Y.call(Ie)}}var se=Sk(m,A,d,0,null,!1,!1,"",Ek);return d._reactRootContainer=se,d[xr]=se.current,uo(d.nodeType===8?d.parentNode:d),sh(),se}for(;H=d.lastChild;)d.removeChild(H);if(typeof A=="function"){var xe=A;A=function(){var Ie=Zv(Se);xe.call(Ie)}}var Se=y1(d,0,!1,null,null,!1,!1,"",Ek);return d._reactRootContainer=Se,d[xr]=Se.current,uo(d.nodeType===8?d.parentNode:d),sh(function(){Kv(m,Se,C,A)}),Se}function Qv(d,m,C,A,H){var Y=C._reactRootContainer;if(Y){var se=Y;if(typeof H=="function"){var xe=H;H=function(){var Se=Zv(se);xe.call(Se)}}Kv(m,se,d,H)}else se=Xj(C,m,d,H,A);return Zv(se)}to=function(d){switch(d.tag){case 3:var m=d.stateNode;if(m.current.memoizedState.isDehydrated){var C=Tt(m.pendingLanes);C!==0&&(Bs(m,C|1),ks(m,Xr()),(br&6)===0&&(Pf=Xr()+500,Rl()))}break;case 13:sh(function(){var A=ns(d,1);if(A!==null){var H=as();al(A,d,1,H)}}),x1(d,1)}},fs=function(d){if(d.tag===13){var m=ns(d,134217728);if(m!==null){var C=as();al(m,d,134217728,C)}x1(d,134217728)}},ec=function(d){if(d.tag===13){var m=Bc(d),C=ns(d,m);if(C!==null){var A=as();al(C,d,m,A)}x1(d,m)}},tc=function(){return rr},Oo=function(d,m){var C=rr;try{return rr=d,m()}finally{rr=C}},ut=function(d,m,C){switch(m){case"input":if(Ve(d,C),m=C.name,C.type==="radio"&&m!=null){for(C=d;C.parentNode;)C=C.parentNode;for(C=C.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<C.length;m++){var A=C[m];if(A!==d&&A.form===d.form){var H=Vn(A);if(!H)throw Error(r(90));be(A),Ve(A,H)}}}break;case"textarea":et(d,C);break;case"select":m=C.value,m!=null&&Ce(d,!!C.multiple,m,!1)}},Ht=h1,qt=sh;var Qj={usingClientEntryPoint:!1,Events:[Yo,Nn,Vn,zt,vt,h1]},Qp={findFiberByHostInstance:co,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Jj={bundleType:Qp.bundleType,version:Qp.version,rendererPackageName:Qp.rendererPackageName,rendererConfig:Qp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=eo(d),d===null?null:d.stateNode},findFiberByHostInstance:Qp.findFiberByHostInstance||Yj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jv.isDisabled&&Jv.supportsFiber)try{ta=Jv.inject(Jj),pn=Jv}catch{}}return Cs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qj,Cs.createPortal=function(d,m){var C=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!w1(m))throw Error(r(200));return Zj(d,m,null,C)},Cs.createRoot=function(d,m){if(!w1(d))throw Error(r(299));var C=!1,A="",H=Ck;return m!=null&&(m.unstable_strictMode===!0&&(C=!0),m.identifierPrefix!==void 0&&(A=m.identifierPrefix),m.onRecoverableError!==void 0&&(H=m.onRecoverableError)),m=y1(d,1,!1,null,null,C,!1,A,H),d[xr]=m.current,uo(d.nodeType===8?d.parentNode:d),new b1(m)},Cs.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var m=d._reactInternals;if(m===void 0)throw typeof d.render=="function"?Error(r(188)):(d=Object.keys(d).join(","),Error(r(268,d)));return d=eo(m),d=d===null?null:d.stateNode,d},Cs.flushSync=function(d){return sh(d)},Cs.hydrate=function(d,m,C){if(!Xv(m))throw Error(r(200));return Qv(null,d,m,!0,C)},Cs.hydrateRoot=function(d,m,C){if(!w1(d))throw Error(r(405));var A=C!=null&&C.hydratedSources||null,H=!1,Y="",se=Ck;if(C!=null&&(C.unstable_strictMode===!0&&(H=!0),C.identifierPrefix!==void 0&&(Y=C.identifierPrefix),C.onRecoverableError!==void 0&&(se=C.onRecoverableError)),m=Sk(m,null,d,1,C??null,H,!1,Y,se),d[xr]=m.current,uo(d),A)for(d=0;d<A.length;d++)C=A[d],H=C._getVersion,H=H(C._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[C,H]:m.mutableSourceEagerHydrationData.push(C,H);return new Yv(m)},Cs.render=function(d,m,C){if(!Xv(m))throw Error(r(200));return Qv(null,d,m,!1,C)},Cs.unmountComponentAtNode=function(d){if(!Xv(d))throw Error(r(40));return d._reactRootContainer?(sh(function(){Qv(null,null,d,!1,function(){d._reactRootContainer=null,d[xr]=null})}),!0):!1},Cs.unstable_batchedUpdates=h1,Cs.unstable_renderSubtreeIntoContainer=function(d,m,C,A){if(!Xv(C))throw Error(r(200));if(d==null||d._reactInternals===void 0)throw Error(r(38));return Qv(d,m,C,!1,A)},Cs.version="18.3.1-next-f1338f8080-20240426",Cs}var Ok;function e4(){if(Ok)return k1.exports;Ok=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),k1.exports=oR(),k1.exports}var Dk;function lR(){if(Dk)return e0;Dk=1;var t=e4();return e0.createRoot=t.createRoot,e0.hydrateRoot=t.hydrateRoot,e0}var uR=lR();const cR=Wh(uR);var nu=e4();const dR=Wh(nu);function Mg(){return Mg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mg.apply(this,arguments)}var rd;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(rd||(rd={}));const Ik="popstate";function hR(t){t===void 0&&(t={});function e(n,i){let{pathname:a,search:s,hash:o}=n.location;return c2("",{pathname:a,search:s,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:J0(i)}return pR(e,r,null,t)}function $n(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function w_(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function fR(){return Math.random().toString(36).substr(2,8)}function Bk(t,e){return{usr:t.state,key:t.key,idx:e}}function c2(t,e,r,n){return r===void 0&&(r=null),Mg({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?kp(e):e,{state:r,key:e&&e.key||n||fR()})}function J0(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function kp(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function pR(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,s=i.history,o=rd.Pop,l=null,u=c();u==null&&(u=0,s.replaceState(Mg({},s.state,{idx:u}),""));function c(){return(s.state||{idx:null}).idx}function f(){o=rd.Pop;let S=c(),N=S==null?null:S-u;u=S,l&&l({action:o,location:_.location,delta:N})}function g(S,N){o=rd.Push;let k=c2(_.location,S,N);u=c()+1;let E=Bk(k,u),T=_.createHref(k);try{s.pushState(E,"",T)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;i.location.assign(T)}a&&l&&l({action:o,location:_.location,delta:1})}function v(S,N){o=rd.Replace;let k=c2(_.location,S,N);u=c();let E=Bk(k,u),T=_.createHref(k);s.replaceState(E,"",T),a&&l&&l({action:o,location:_.location,delta:0})}function x(S){let N=i.location.origin!=="null"?i.location.origin:i.location.href,k=typeof S=="string"?S:J0(S);return k=k.replace(/ $/,"%20"),$n(N,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,N)}let _={get action(){return o},get location(){return t(i,s)},listen(S){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Ik,f),l=S,()=>{i.removeEventListener(Ik,f),l=null}},createHref(S){return e(i,S)},createURL:x,encodeLocation(S){let N=x(S);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:g,replace:v,go(S){return s.go(S)}};return _}var zk;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(zk||(zk={}));function mR(t,e,r){return r===void 0&&(r="/"),gR(t,e,r)}function gR(t,e,r,n){let i=typeof e=="string"?kp(e):e,a=lp(i.pathname||"/",r);if(a==null)return null;let s=t4(t);vR(s);let o=null;for(let l=0;o==null&&l<s.length;++l){let u=TR(a);o=ER(s[l],u)}return o}function t4(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,s,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:s,route:a};l.relativePath.startsWith("/")&&($n(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=cd([n,l.relativePath]),c=r.concat(l);a.children&&a.children.length>0&&($n(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),t4(a.children,e,c,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:kR(u,a.index),routesMeta:c})};return t.forEach((a,s)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))i(a,s);else for(let l of r4(a.path))i(a,s,l)}),e}function r4(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let s=r4(n.join("/")),o=[];return o.push(...s.map(l=>l===""?a:[a,l].join("/"))),i&&o.push(...s),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function vR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:CR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const yR=/^:[\w-]+$/,xR=3,bR=2,wR=1,_R=10,SR=-2,Fk=t=>t==="*";function kR(t,e){let r=t.split("/"),n=r.length;return r.some(Fk)&&(n+=SR),e&&(n+=bR),r.filter(i=>!Fk(i)).reduce((i,a)=>i+(yR.test(a)?xR:a===""?wR:_R),n)}function CR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function ER(t,e,r){let{routesMeta:n}=t,i={},a="/",s=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,c=a==="/"?e:e.slice(a.length)||"/",f=d2({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),g=l.route;if(!f)return null;Object.assign(i,f.params),s.push({params:i,pathname:cd([a,f.pathname]),pathnameBase:RR(cd([a,f.pathnameBase])),route:g}),f.pathnameBase!=="/"&&(a=cd([a,f.pathnameBase]))}return s}function d2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=NR(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((u,c,f)=>{let{paramName:g,isOptional:v}=c;if(g==="*"){let _=o[f]||"";s=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const x=o[f];return v&&!x?u[g]=void 0:u[g]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:s,pattern:t}}function NR(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),w_(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function TR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return w_(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function lp(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const PR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,MR=t=>PR.test(t);function AR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?kp(t):t,a;if(r)if(MR(r))a=r;else{if(r.includes("//")){let s=r;r=r.replace(/\/\/+/g,"/"),w_(!1,"Pathnames cannot have embedded double slashes - normalizing "+(s+" -> "+r))}r.startsWith("/")?a=Vk(r.substring(1),"/"):a=Vk(r,e)}else a=e;return{pathname:a,search:LR(n),hash:OR(i)}}function Vk(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function N1(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function jR(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function n4(t,e){let r=jR(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function i4(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=kp(t):(i=Mg({},t),$n(!i.pathname||!i.pathname.includes("?"),N1("?","pathname","search",i)),$n(!i.pathname||!i.pathname.includes("#"),N1("#","pathname","hash",i)),$n(!i.search||!i.search.includes("#"),N1("#","search","hash",i)));let a=t===""||i.pathname==="",s=a?"/":i.pathname,o;if(s==null)o=r;else{let f=e.length-1;if(!n&&s.startsWith("..")){let g=s.split("/");for(;g[0]==="..";)g.shift(),f-=1;i.pathname=g.join("/")}o=f>=0?e[f]:"/"}let l=AR(i,o),u=s&&s!=="/"&&s.endsWith("/"),c=(a||s===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const cd=t=>t.join("/").replace(/\/\/+/g,"/"),RR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),LR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,OR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function DR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const a4=["post","put","patch","delete"];new Set(a4);const IR=["get",...a4];new Set(IR);function Ag(){return Ag=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ag.apply(this,arguments)}const lx=ce.createContext(null),s4=ce.createContext(null),Ed=ce.createContext(null),ux=ce.createContext(null),Ku=ce.createContext({outlet:null,matches:[],isDataRoute:!1}),o4=ce.createContext(null);function BR(t,e){let{relative:r}=e===void 0?{}:e;rv()||$n(!1);let{basename:n,navigator:i}=ce.useContext(Ed),{hash:a,pathname:s,search:o}=cx(t,{relative:r}),l=s;return n!=="/"&&(l=s==="/"?n:cd([n,s])),i.createHref({pathname:l,search:o,hash:a})}function rv(){return ce.useContext(ux)!=null}function $h(){return rv()||$n(!1),ce.useContext(ux).location}function l4(t){ce.useContext(Ed).static||ce.useLayoutEffect(t)}function Ga(){let{isDataRoute:t}=ce.useContext(Ku);return t?QR():zR()}function zR(){rv()||$n(!1);let t=ce.useContext(lx),{basename:e,future:r,navigator:n}=ce.useContext(Ed),{matches:i}=ce.useContext(Ku),{pathname:a}=$h(),s=JSON.stringify(n4(i,r.v7_relativeSplatPath)),o=ce.useRef(!1);return l4(()=>{o.current=!0}),ce.useCallback(function(u,c){if(c===void 0&&(c={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let f=i4(u,JSON.parse(s),a,c.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:cd([e,f.pathname])),(c.replace?n.replace:n.push)(f,c.state,c)},[e,n,s,a,t])}const u4=ce.createContext(null);function Zu(){return ce.useContext(u4)}function FR(t){let e=ce.useContext(Ku).outlet;return e&&ce.createElement(u4.Provider,{value:t},e)}function ds(){let{matches:t}=ce.useContext(Ku),e=t[t.length-1];return e?e.params:{}}function cx(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=ce.useContext(Ed),{matches:i}=ce.useContext(Ku),{pathname:a}=$h(),s=JSON.stringify(n4(i,n.v7_relativeSplatPath));return ce.useMemo(()=>i4(t,JSON.parse(s),a,r==="path"),[t,s,a,r])}function VR(t,e){return UR(t,e)}function UR(t,e,r,n){rv()||$n(!1);let{navigator:i}=ce.useContext(Ed),{matches:a}=ce.useContext(Ku),s=a[a.length-1],o=s?s.params:{};s&&s.pathname;let l=s?s.pathnameBase:"/";s&&s.route;let u=$h(),c;if(e){var f;let S=typeof e=="string"?kp(e):e;l==="/"||(f=S.pathname)!=null&&f.startsWith(l)||$n(!1),c=S}else c=u;let g=c.pathname||"/",v=g;if(l!=="/"){let S=l.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(S.length).join("/")}let x=mR(t,{pathname:v}),_=$R(x&&x.map(S=>Object.assign({},S,{params:Object.assign({},o,S.params),pathname:cd([l,i.encodeLocation?i.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?l:cd([l,i.encodeLocation?i.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),a,r,n);return e&&_?ce.createElement(ux.Provider,{value:{location:Ag({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:rd.Pop}},_):_}function HR(){let t=XR(),e=DR(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ce.createElement(ce.Fragment,null,ce.createElement("h2",null,"Unexpected Application Error!"),ce.createElement("h3",{style:{fontStyle:"italic"}},e),r?ce.createElement("pre",{style:i},r):null,null)}const GR=ce.createElement(HR,null);class qR extends ce.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?ce.createElement(Ku.Provider,{value:this.props.routeContext},ce.createElement(o4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function WR(t){let{routeContext:e,match:r,children:n}=t,i=ce.useContext(lx);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),ce.createElement(Ku.Provider,{value:e},n)}function $R(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,o=(i=r)==null?void 0:i.errors;if(o!=null){let c=s.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);c>=0||$n(!1),s=s.slice(0,Math.min(s.length,c+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let c=0;c<s.length;c++){let f=s[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=c),f.route.id){let{loaderData:g,errors:v}=r,x=f.route.loader&&g[f.route.id]===void 0&&(!v||v[f.route.id]===void 0);if(f.route.lazy||x){l=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}return s.reduceRight((c,f,g)=>{let v,x=!1,_=null,S=null;r&&(v=o&&f.route.id?o[f.route.id]:void 0,_=f.route.errorElement||GR,l&&(u<0&&g===0?(JR("route-fallback"),x=!0,S=null):u===g&&(x=!0,S=f.route.hydrateFallbackElement||null)));let N=e.concat(s.slice(0,g+1)),k=()=>{let E;return v?E=_:x?E=S:f.route.Component?E=ce.createElement(f.route.Component,null):f.route.element?E=f.route.element:E=c,ce.createElement(WR,{match:f,routeContext:{outlet:c,matches:N,isDataRoute:r!=null},children:E})};return r&&(f.route.ErrorBoundary||f.route.errorElement||g===0)?ce.createElement(qR,{location:r.location,revalidation:r.revalidation,component:_,error:v,children:k(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):k()},null)}var c4=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(c4||{}),d4=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(d4||{});function KR(t){let e=ce.useContext(lx);return e||$n(!1),e}function ZR(t){let e=ce.useContext(s4);return e||$n(!1),e}function YR(t){let e=ce.useContext(Ku);return e||$n(!1),e}function h4(t){let e=YR(),r=e.matches[e.matches.length-1];return r.route.id||$n(!1),r.route.id}function XR(){var t;let e=ce.useContext(o4),r=ZR(),n=h4();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function QR(){let{router:t}=KR(c4.UseNavigateStable),e=h4(d4.UseNavigateStable),r=ce.useRef(!1);return l4(()=>{r.current=!0}),ce.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Ag({fromRouteId:e},a)))},[t,e])}const Uk={};function JR(t,e,r){Uk[t]||(Uk[t]=!0)}function eL(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function __(t){return FR(t.context)}function Mn(t){$n(!1)}function tL(t){let{basename:e="/",children:r=null,location:n,navigationType:i=rd.Pop,navigator:a,static:s=!1,future:o}=t;rv()&&$n(!1);let l=e.replace(/^\/*/,"/"),u=ce.useMemo(()=>({basename:l,navigator:a,static:s,future:Ag({v7_relativeSplatPath:!1},o)}),[l,o,a,s]);typeof n=="string"&&(n=kp(n));let{pathname:c="/",search:f="",hash:g="",state:v=null,key:x="default"}=n,_=ce.useMemo(()=>{let S=lp(c,l);return S==null?null:{location:{pathname:S,search:f,hash:g,state:v,key:x},navigationType:i}},[l,c,f,g,v,x,i]);return _==null?null:ce.createElement(Ed.Provider,{value:u},ce.createElement(ux.Provider,{children:r,value:_}))}function rL(t){let{children:e,location:r}=t;return VR(h2(e),r)}new Promise(()=>{});function h2(t,e){e===void 0&&(e=[]);let r=[];return ce.Children.forEach(t,(n,i)=>{if(!ce.isValidElement(n))return;let a=[...e,i];if(n.type===ce.Fragment){r.push.apply(r,h2(n.props.children,a));return}n.type!==Mn&&$n(!1),!n.props.index||!n.props.children||$n(!1);let s={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=h2(n.props.children,a)),r.push(s)}),r}function ey(){return ey=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ey.apply(this,arguments)}function f4(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function nL(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function iL(t,e){return t.button===0&&(!e||e==="_self")&&!nL(t)}const aL=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],sL=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],oL="6";try{window.__reactRouterVersion=oL}catch{}const lL=ce.createContext({isTransitioning:!1}),uL="startTransition",Hk=aR[uL];function cL(t){let{basename:e,children:r,future:n,window:i}=t,a=ce.useRef();a.current==null&&(a.current=hR({window:i,v5Compat:!0}));let s=a.current,[o,l]=ce.useState({action:s.action,location:s.location}),{v7_startTransition:u}=n||{},c=ce.useCallback(f=>{u&&Hk?Hk(()=>l(f)):l(f)},[l,u]);return ce.useLayoutEffect(()=>s.listen(c),[s,c]),ce.useEffect(()=>eL(n),[n]),ce.createElement(tL,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:s,future:n})}const dL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",hL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rh=ce.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:a,replace:s,state:o,target:l,to:u,preventScrollReset:c,viewTransition:f}=e,g=f4(e,aL),{basename:v}=ce.useContext(Ed),x,_=!1;if(typeof u=="string"&&hL.test(u)&&(x=u,dL))try{let E=new URL(window.location.href),T=u.startsWith("//")?new URL(E.protocol+u):new URL(u),R=lp(T.pathname,v);T.origin===E.origin&&R!=null?u=R+T.search+T.hash:_=!0}catch{}let S=BR(u,{relative:i}),N=mL(u,{replace:s,state:o,target:l,preventScrollReset:c,relative:i,viewTransition:f});function k(E){n&&n(E),E.defaultPrevented||N(E)}return ce.createElement("a",ey({},g,{href:x||S,onClick:_||a?n:k,ref:r,target:l}))}),fL=ce.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:a="",end:s=!1,style:o,to:l,viewTransition:u,children:c}=e,f=f4(e,sL),g=cx(l,{relative:f.relative}),v=$h(),x=ce.useContext(s4),{navigator:_,basename:S}=ce.useContext(Ed),N=x!=null&&gL(g)&&u===!0,k=_.encodeLocation?_.encodeLocation(g).pathname:g.pathname,E=v.pathname,T=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;i||(E=E.toLowerCase(),T=T?T.toLowerCase():null,k=k.toLowerCase()),T&&S&&(T=lp(T,S)||T);const R=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let j=E===k||!s&&E.startsWith(k)&&E.charAt(R)==="/",D=T!=null&&(T===k||!s&&T.startsWith(k)&&T.charAt(k.length)==="/"),B={isActive:j,isPending:D,isTransitioning:N},I=j?n:void 0,V;typeof a=="function"?V=a(B):V=[a,j?"active":null,D?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let $=typeof o=="function"?o(B):o;return ce.createElement(Rh,ey({},f,{"aria-current":I,className:V,ref:r,style:$,to:l,viewTransition:u}),typeof c=="function"?c(B):c)});var f2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(f2||(f2={}));var Gk;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Gk||(Gk={}));function pL(t){let e=ce.useContext(lx);return e||$n(!1),e}function mL(t,e){let{target:r,replace:n,state:i,preventScrollReset:a,relative:s,viewTransition:o}=e===void 0?{}:e,l=Ga(),u=$h(),c=cx(t,{relative:s});return ce.useCallback(f=>{if(iL(f,r)){f.preventDefault();let g=n!==void 0?n:J0(u)===J0(c);l(t,{replace:g,state:i,preventScrollReset:a,relative:s,viewTransition:o})}},[u,l,c,n,i,r,t,a,s,o])}function gL(t,e){e===void 0&&(e={});let r=ce.useContext(lL);r==null&&$n(!1);let{basename:n}=pL(f2.useViewTransitionState),i=cx(t,{relative:e.relative});if(!r.isTransitioning)return!1;let a=lp(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=lp(r.nextLocation.pathname,n)||r.nextLocation.pathname;return d2(i.pathname,s)!=null||d2(i.pathname,a)!=null}const S_="-",vL=t=>{const e=xL(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const o=s.split(S_);return o[0]===""&&o.length!==1&&o.shift(),p4(o,e)||yL(s)},getConflictingClassGroupIds:(s,o)=>{const l=r[s]||[];return o&&n[s]?[...l,...n[s]]:l}}},p4=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?p4(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(S_);return e.validators.find(({validator:s})=>s(a))?.classGroupId},qk=/^\[(.+)\]$/,yL=t=>{if(qk.test(t)){const e=qk.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},xL=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return wL(Object.entries(t.classGroups),r).forEach(([a,s])=>{p2(s,n,a,e)}),n},p2=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:Wk(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(bL(i)){p2(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{p2(s,Wk(e,a),r,n)})})},Wk=(t,e)=>{let r=t;return e.split(S_).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},bL=t=>t.isThemeGetter,wL=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,o])=>[e+s,o])):a);return[r,i]}):t,_L=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},m4="!",SL=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,s=o=>{const l=[];let u=0,c=0,f;for(let S=0;S<o.length;S++){let N=o[S];if(u===0){if(N===i&&(n||o.slice(S,S+a)===e)){l.push(o.slice(c,S)),c=S+a;continue}if(N==="/"){f=S;continue}}N==="["?u++:N==="]"&&u--}const g=l.length===0?o:o.substring(c),v=g.startsWith(m4),x=v?g.substring(1):g,_=f&&f>c?f-c:void 0;return{modifiers:l,hasImportantModifier:v,baseClassName:x,maybePostfixModifierPosition:_}};return r?o=>r({className:o,parseClassName:s}):s},kL=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},CL=t=>({cache:_L(t.cacheSize),parseClassName:SL(t),...vL(t)}),EL=/\s+/,NL=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],s=t.trim().split(EL);let o="";for(let l=s.length-1;l>=0;l-=1){const u=s[l],{modifiers:c,hasImportantModifier:f,baseClassName:g,maybePostfixModifierPosition:v}=r(u);let x=!!v,_=n(x?g.substring(0,v):g);if(!_){if(!x){o=u+(o.length>0?" "+o:o);continue}if(_=n(g),!_){o=u+(o.length>0?" "+o:o);continue}x=!1}const S=kL(c).join(":"),N=f?S+m4:S,k=N+_;if(a.includes(k))continue;a.push(k);const E=i(_,x);for(let T=0;T<E.length;++T){const R=E[T];a.push(N+R)}o=u+(o.length>0?" "+o:o)}return o};function TL(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=g4(e))&&(n&&(n+=" "),n+=r);return n}const g4=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=g4(t[n]))&&(r&&(r+=" "),r+=e);return r};function PL(t,...e){let r,n,i,a=s;function s(l){const u=e.reduce((c,f)=>f(c),t());return r=CL(u),n=r.cache.get,i=r.cache.set,a=o,o(l)}function o(l){const u=n(l);if(u)return u;const c=NL(l,r);return i(l,c),c}return function(){return a(TL.apply(null,arguments))}}const gn=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},v4=/^\[(?:([a-z-]+):)?(.+)\]$/i,ML=/^\d+\/\d+$/,AL=new Set(["px","full","screen"]),jL=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,RL=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,LL=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,OL=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,DL=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Au=t=>tp(t)||AL.has(t)||ML.test(t),Uc=t=>Cp(t,"length",GL),tp=t=>!!t&&!Number.isNaN(Number(t)),T1=t=>Cp(t,"number",tp),em=t=>!!t&&Number.isInteger(Number(t)),IL=t=>t.endsWith("%")&&tp(t.slice(0,-1)),tr=t=>v4.test(t),Hc=t=>jL.test(t),BL=new Set(["length","size","percentage"]),zL=t=>Cp(t,BL,y4),FL=t=>Cp(t,"position",y4),VL=new Set(["image","url"]),UL=t=>Cp(t,VL,WL),HL=t=>Cp(t,"",qL),tm=()=>!0,Cp=(t,e,r)=>{const n=v4.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},GL=t=>RL.test(t)&&!LL.test(t),y4=()=>!1,qL=t=>OL.test(t),WL=t=>DL.test(t),$L=()=>{const t=gn("colors"),e=gn("spacing"),r=gn("blur"),n=gn("brightness"),i=gn("borderColor"),a=gn("borderRadius"),s=gn("borderSpacing"),o=gn("borderWidth"),l=gn("contrast"),u=gn("grayscale"),c=gn("hueRotate"),f=gn("invert"),g=gn("gap"),v=gn("gradientColorStops"),x=gn("gradientColorStopPositions"),_=gn("inset"),S=gn("margin"),N=gn("opacity"),k=gn("padding"),E=gn("saturate"),T=gn("scale"),R=gn("sepia"),j=gn("skew"),D=gn("space"),B=gn("translate"),I=()=>["auto","contain","none"],V=()=>["auto","hidden","clip","visible","scroll"],$=()=>["auto",tr,e],Z=()=>[tr,e],O=()=>["",Au,Uc],W=()=>["auto",tp,tr],F=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],K=()=>["solid","dashed","dotted","double","none"],X=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Q=()=>["start","end","center","between","around","evenly","stretch"],ae=()=>["","0",tr],re=()=>["auto","avoid","all","avoid-page","page","left","right","column"],G=()=>[tp,tr];return{cacheSize:500,separator:":",theme:{colors:[tm],spacing:[Au,Uc],blur:["none","",Hc,tr],brightness:G(),borderColor:[t],borderRadius:["none","","full",Hc,tr],borderSpacing:Z(),borderWidth:O(),contrast:G(),grayscale:ae(),hueRotate:G(),invert:ae(),gap:Z(),gradientColorStops:[t],gradientColorStopPositions:[IL,Uc],inset:$(),margin:$(),opacity:G(),padding:Z(),saturate:G(),scale:G(),sepia:ae(),skew:G(),space:Z(),translate:Z()},classGroups:{aspect:[{aspect:["auto","square","video",tr]}],container:["container"],columns:[{columns:[Hc]}],"break-after":[{"break-after":re()}],"break-before":[{"break-before":re()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...F(),tr]}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:I()}],"overscroll-x":[{"overscroll-x":I()}],"overscroll-y":[{"overscroll-y":I()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[_]}],"inset-x":[{"inset-x":[_]}],"inset-y":[{"inset-y":[_]}],start:[{start:[_]}],end:[{end:[_]}],top:[{top:[_]}],right:[{right:[_]}],bottom:[{bottom:[_]}],left:[{left:[_]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",em,tr]}],basis:[{basis:$()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",tr]}],grow:[{grow:ae()}],shrink:[{shrink:ae()}],order:[{order:["first","last","none",em,tr]}],"grid-cols":[{"grid-cols":[tm]}],"col-start-end":[{col:["auto",{span:["full",em,tr]},tr]}],"col-start":[{"col-start":W()}],"col-end":[{"col-end":W()}],"grid-rows":[{"grid-rows":[tm]}],"row-start-end":[{row:["auto",{span:[em,tr]},tr]}],"row-start":[{"row-start":W()}],"row-end":[{"row-end":W()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",tr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",tr]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...Q()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Q(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Q(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[S]}],mx:[{mx:[S]}],my:[{my:[S]}],ms:[{ms:[S]}],me:[{me:[S]}],mt:[{mt:[S]}],mr:[{mr:[S]}],mb:[{mb:[S]}],ml:[{ml:[S]}],"space-x":[{"space-x":[D]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[D]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",tr,e]}],"min-w":[{"min-w":[tr,e,"min","max","fit"]}],"max-w":[{"max-w":[tr,e,"none","full","min","max","fit","prose",{screen:[Hc]},Hc]}],h:[{h:[tr,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[tr,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[tr,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[tr,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Hc,Uc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",T1]}],"font-family":[{font:[tm]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",tr]}],"line-clamp":[{"line-clamp":["none",tp,T1]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Au,tr]}],"list-image":[{"list-image":["none",tr]}],"list-style-type":[{list:["none","disc","decimal",tr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[N]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[N]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...K(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Au,Uc]}],"underline-offset":[{"underline-offset":["auto",Au,tr]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",tr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",tr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[N]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...F(),FL]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",zL]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},UL]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[N]}],"border-style":[{border:[...K(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[N]}],"divide-style":[{divide:K()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...K()]}],"outline-offset":[{"outline-offset":[Au,tr]}],"outline-w":[{outline:[Au,Uc]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:O()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[N]}],"ring-offset-w":[{"ring-offset":[Au,Uc]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Hc,HL]}],"shadow-color":[{shadow:[tm]}],opacity:[{opacity:[N]}],"mix-blend":[{"mix-blend":[...X(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":X()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Hc,tr]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[f]}],saturate:[{saturate:[E]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[N]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",tr]}],duration:[{duration:G()}],ease:[{ease:["linear","in","out","in-out",tr]}],delay:[{delay:G()}],animate:[{animate:["none","spin","ping","pulse","bounce",tr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[em,tr]}],"translate-x":[{"translate-x":[B]}],"translate-y":[{"translate-y":[B]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",tr]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",tr]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Z()}],"scroll-mx":[{"scroll-mx":Z()}],"scroll-my":[{"scroll-my":Z()}],"scroll-ms":[{"scroll-ms":Z()}],"scroll-me":[{"scroll-me":Z()}],"scroll-mt":[{"scroll-mt":Z()}],"scroll-mr":[{"scroll-mr":Z()}],"scroll-mb":[{"scroll-mb":Z()}],"scroll-ml":[{"scroll-ml":Z()}],"scroll-p":[{"scroll-p":Z()}],"scroll-px":[{"scroll-px":Z()}],"scroll-py":[{"scroll-py":Z()}],"scroll-ps":[{"scroll-ps":Z()}],"scroll-pe":[{"scroll-pe":Z()}],"scroll-pt":[{"scroll-pt":Z()}],"scroll-pr":[{"scroll-pr":Z()}],"scroll-pb":[{"scroll-pb":Z()}],"scroll-pl":[{"scroll-pl":Z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",tr]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Au,Uc,T1]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},k_=PL($L),Rr=({children:t,className:e,...r})=>p.jsx("div",{className:k_("bg-glass backdrop-blur-xl border border-glass-border rounded-xl",e),...r,children:t}),ty=({url:t,name:e,alt:r="User",size:n="md",className:i})=>{const a={sm:"size-8 text-xs",md:"size-10 text-sm",lg:"size-16 text-lg",xl:"size-32 text-2xl"},s=e?e.charAt(0).toUpperCase():r?r.charAt(0).toUpperCase():"?";return p.jsx("div",{className:k_("rounded-full bg-surface-light border border-white/10 flex items-center justify-center overflow-hidden shrink-0 text-slate-400 font-bold select-none",a[n],i),children:t?p.jsx("img",{src:t,alt:e||r,className:"w-full h-full object-cover"}):p.jsx("span",{children:s})})},KL=()=>p.jsx("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark relative",children:p.jsx("main",{className:"flex-1 min-w-0 relative overflow-hidden flex flex-col",children:p.jsx(__,{})})}),ZL="/api",it={async request(t,e={}){const r=`${ZL}${t}`,n={"Content-Type":"application/json",...e.headers},i=await fetch(r,{...e,headers:n,credentials:"include"});if(!i.ok){const a=await i.json().catch(()=>({}));throw new Error(a.error||`HTTP error! status: ${i.status}`)}return i.status===204||i.headers.get("content-length")==="0"?null:i.json()},get(t,e={}){return this.request(t,{method:"GET",headers:e})},post(t,e,r={}){return this.request(t,{method:"POST",body:JSON.stringify(e),headers:r})},put(t,e,r={}){return this.request(t,{method:"PUT",body:JSON.stringify(e),headers:r})},patch(t,e,r={}){return this.request(t,{method:"PATCH",body:JSON.stringify(e),headers:r})},delete(t,e={}){return this.request(t,{method:"DELETE",headers:e})}},rm={list:()=>it.get("/workspaces"),create:(t,e,r,n)=>it.post("/workspaces",{name:t,title:e,genre:r,imageUrl:n}),delete:t=>it.delete("/workspaces/"+t),update:(t,e)=>it.put("/workspaces/"+t,e),select:t=>it.post("/workspaces/select",{projectName:t})},YL=["FANTASA","SCI-FI","HORROR","LORE","MISTERIO","HISTRICO","CYBERPUNK","STEAMPUNK"],XL=({isOpen:t,onClose:e,onCreate:r})=>{if(!t)return null;const[n,i]=ce.useState(!1),[a,s]=ce.useState({name:"",title:"",genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"}),o=u=>{const{name:c,value:f}=u.target;s(g=>({...g,[c]:f}))},l=u=>{u.preventDefault();let c=a.name;if(!c&&a.title&&(c=a.title.toLowerCase().replace(/[^a-z0-9]/g,"-")),!c){alert("Project ID/Name is required");return}r({...a,name:c}),e(),s({name:"",title:"",genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"})};return nu.createPortal(p.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[p.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),p.jsxs("div",{className:"relative w-full max-w-2xl bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex animate-in zoom-in-95 duration-200",children:[p.jsxs("div",{className:"w-1/3 bg-black relative hidden sm:block",children:[p.jsx("img",{src:a.imageUrl,onError:()=>i(!0),className:`absolute inset-0 w-full h-full object-cover opacity-60 transition-opacity duration-500 ${n?"hidden":""}`,alt:"Preview"}),p.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-6 bg-gradient-to-t from-black to-transparent",children:[p.jsx("h4",{className:"text-white font-black text-xl leading-none",children:a.title||"Untitled"}),p.jsx("span",{className:"text-[10px] font-bold text-primary uppercase tracking-widest mt-2 block",children:a.genre})]})]}),p.jsxs("div",{className:"flex-1 p-8",children:[p.jsx("h2",{className:"text-2xl font-black text-white mb-6",children:"Nuevo Cuaderno"}),p.jsxs("form",{onSubmit:l,className:"space-y-5",children:[p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Ttulo del Proyecto"}),p.jsx("input",{type:"text",name:"title",value:a.title,onChange:o,placeholder:"e.g. Las Crnicas de Etheria",className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all",autoFocus:!0})]}),p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"ID de Archivo (Slug)"}),p.jsx("input",{type:"text",name:"name",value:a.name,onChange:o,placeholder:"e.g. etheria-v1",className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white font-mono text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all placeholder:text-white/10"}),p.jsx("p",{className:"text-[10px] text-white/20",children:"Se usar como nombre del archivo .db"})]}),p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Gnero"}),p.jsx("div",{className:"grid grid-cols-2 gap-2",children:YL.slice(0,4).map(u=>p.jsx("button",{type:"button",onClick:()=>s(c=>({...c,genre:u})),className:`px-3 py-2 rounded-lg text-[10px] font-bold border transition-all ${a.genre===u?"bg-primary text-white border-primary":"bg-[#13141f] border-white/10 text-text-muted hover:border-white/20"}`,children:u},u))})]}),p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Imagen de Portada (URL)"}),p.jsx("input",{type:"text",name:"imageUrl",value:a.imageUrl,onChange:u=>{s(c=>({...c,imageUrl:u.target.value})),i(!1)},className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all truncate"})]}),p.jsxs("div",{className:"pt-4 flex gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-[#13141f] hover:bg-white/5 border border-white/10 rounded-xl text-xs font-bold text-text-muted transition-all",children:"Cancelar"}),p.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold transition-all shadow-lg shadow-primary/20 flex items-center justify-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"rocket_launch"}),"Crear Universo"]})]})]})]})]})]}),document.body)},QL=["FANTASA","SCI-FI","HORROR","LORE","MISTERIO","HISTRICO","CYBERPUNK","STEAMPUNK"],JL=({isOpen:t,onClose:e,onUpdate:r,project:n})=>{if(!t||!n)return null;const[i,a]=ce.useState(!1),[s,o]=ce.useState({name:n,title:n,genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"});ce.useEffect(()=>{n&&o(u=>({...u,name:n,title:n}))},[n]);const l=u=>{u.preventDefault(),r(s.name,{title:s.title,genre:s.genre,imageUrl:s.imageUrl}),e()};return nu.createPortal(p.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[p.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),p.jsxs("div",{className:"relative w-full max-w-2xl bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex animate-in zoom-in-95 duration-200",children:[p.jsxs("div",{className:"w-1/3 bg-black relative hidden sm:block",children:[p.jsx("img",{src:s.imageUrl,onError:()=>a(!0),className:`absolute inset-0 w-full h-full object-cover opacity-60 transition-opacity duration-500 ${i?"hidden":""}`,alt:"Preview"}),p.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-6 bg-gradient-to-t from-black to-transparent",children:[p.jsx("h4",{className:"text-white font-black text-xl leading-none",children:s.title||"Untitled"}),p.jsx("span",{className:"text-[10px] font-bold text-primary uppercase tracking-widest mt-2 block",children:s.genre})]})]}),p.jsxs("div",{className:"flex-1 p-8",children:[p.jsx("h2",{className:"text-2xl font-black text-white mb-6",children:"Editar Cuaderno"}),p.jsxs("form",{onSubmit:l,className:"space-y-5",children:[p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Ttulo del Proyecto"}),p.jsx("input",{type:"text",name:"title",value:s.title,onChange:u=>o(c=>({...c,title:u.target.value})),className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all",autoFocus:!0})]}),p.jsxs("div",{className:"space-y-1.5 opacity-50",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"ID de Archivo (Inmutable)"}),p.jsx("input",{type:"text",value:s.name,readOnly:!0,className:"w-full bg-[#0a0a0c] border border-white/5 rounded-xl px-4 py-3 text-white/50 font-mono text-xs outline-none cursor-not-allowed"})]}),p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Gnero"}),p.jsx("div",{className:"grid grid-cols-2 gap-2",children:QL.slice(0,4).map(u=>p.jsx("button",{type:"button",onClick:()=>o(c=>({...c,genre:u})),className:`px-3 py-2 rounded-lg text-[10px] font-bold border transition-all ${s.genre===u?"bg-primary text-white border-primary":"bg-[#13141f] border-white/10 text-text-muted hover:border-white/20"}`,children:u},u))})]}),p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Imagen de Portada (URL)"}),p.jsx("input",{type:"text",value:s.imageUrl,onChange:u=>{o(c=>({...c,imageUrl:u.target.value})),a(!1)},className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all truncate"})]}),p.jsxs("div",{className:"pt-4 flex gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-[#13141f] hover:bg-white/5 border border-white/10 rounded-xl text-xs font-bold text-text-muted transition-all",children:"Cancelar"}),p.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold transition-all shadow-lg shadow-primary/20 flex items-center justify-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar Cambios"]})]})]})]})]})]}),document.body)},rn=ce.forwardRef(({children:t,variant:e="primary",size:r="md",className:n,icon:i,isLoading:a,...s},o)=>{const l="inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed active:scale-95",u={primary:"bg-primary text-white shadow-lg shadow-primary/25 hover:bg-primary-light hover:shadow-primary/40 border border-transparent",secondary:"bg-surface-light text-slate-200 border border-white/10 hover:bg-white/5 hover:text-white hover:border-white/20",ghost:"bg-transparent text-slate-400 hover:text-white hover:bg-white/5",danger:"bg-red-500/10 text-red-500 border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/50 hover:shadow-lg hover:shadow-red-500/10",outline:"bg-transparent border border-primary/50 text-primary hover:bg-primary/10"},c={xs:"px-2.5 py-1 text-xs gap-1.5",sm:"px-3 py-1.5 text-xs gap-1.5",md:"px-4 py-2 text-sm gap-2",lg:"px-6 py-3 text-base gap-3",icon:"size-9 p-0"};return p.jsxs("button",{ref:o,className:k_(l,u[e],c[r],n),disabled:a,...s,children:[a?p.jsx("span",{className:"material-symbols-outlined animate-spin text-[18px]",children:"progress_activity"}):i?p.jsx("span",{className:"material-symbols-outlined text-[18px]",children:i}):null,t]})});rn.displayName="Button";const e8=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirm",cancelText:s="Cancel",isDestructive:o=!0})=>t?p.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[p.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",onClick:e}),p.jsx("div",{className:"relative z-10 w-full max-w-md animate-in zoom-in-95 duration-300",children:p.jsxs(Rr,{className:"p-6 border-red-500/20 shadow-2xl shadow-black/50",children:[p.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[p.jsx("div",{className:`
                            size-12 rounded-xl flex items-center justify-center shrink-0
                            ${o?"bg-red-500/10 text-red-500":"bg-primary/10 text-primary"}
                        `,children:p.jsx("span",{className:"material-symbols-outlined text-2xl",children:o?"warning":"help"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-black text-white mb-2 leading-tight",children:n}),p.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:i})]})]}),p.jsxs("div",{className:"flex items-center justify-end gap-3",children:[p.jsx(rn,{variant:"ghost",onClick:e,children:s}),p.jsx(rn,{variant:o?"danger":"primary",onClick:()=>{r(),e()},icon:o?"delete":"check",children:a})]})]})})]}):null,t8=()=>{const t=Ga(),[e,r]=ce.useState([]),[n,i]=ce.useState(!0),[a,s]=ce.useState(null),[o,l]=ce.useState(""),[u,c]=ce.useState(!1),[f,g]=ce.useState(null),[v,x]=ce.useState(null);ce.useEffect(()=>{_()},[]);const _=async()=>{try{i(!0);const j=await rm.list();r(j)}catch(j){console.error("Failed to load workspaces",j),s("Error al cargar cuadernos. Est el servidor encendido?")}finally{i(!1)}},S=async j=>{try{i(!0);const D=await rm.select(j);D.success&&D.redirect&&(localStorage.setItem("user",JSON.stringify({username:"local",success:!0})),t(D.redirect))}catch(D){s(D.message||"Fallo al entrar al cuaderno"),i(!1)}},N=async j=>{try{i(!0),(await rm.create(j.name,j.title,j.genre,j.imageUrl)).success&&await S(j.name)}catch{s("Error al crear cuaderno"),i(!1)}},k=async()=>{if(f)try{i(!0),await rm.delete(f),await _(),g(null)}catch{s("Error al borrar el cuaderno"),i(!1)}},E=async(j,D)=>{try{i(!0),await rm.update(j,D),await _(),x(null)}catch{s("Error al actualizar cuaderno"),i(!1)}},T=()=>{window.location.href="/api/backup/download"},R=e.filter(j=>(j.title||j.filename||"").toLowerCase().includes(o.toLowerCase()));return p.jsxs("div",{className:"h-screen w-full bg-[#0a0b14] text-white flex flex-col items-center font-sans selection:bg-indigo-500/30 overflow-hidden",children:[p.jsxs("div",{className:"w-full max-w-6xl flex-1 flex flex-col overflow-y-auto custom-scrollbar p-8",children:[p.jsxs("header",{className:"w-full mt-24 mb-12 flex flex-col lg:flex-row lg:items-end justify-between gap-8 flex-shrink-0",children:[p.jsx("div",{className:"space-y-4",children:p.jsx("div",{className:"flex items-center gap-4",children:p.jsxs("h1",{className:"text-6xl font-black tracking-tighter leading-none",children:[p.jsx("span",{className:"block text-indigo-400",children:"Mis"}),p.jsx("span",{className:"block text-white",children:"Cuadernos"})]})})}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("button",{onClick:()=>t("/settings"),className:"flex items-center gap-2 px-5 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl transition-all text-xs font-bold text-slate-400 hover:text-white group",title:"Configuracin Global",children:[p.jsx("span",{className:"material-symbols-outlined text-lg group-hover:rotate-90 transition-transform duration-500",children:"settings"}),p.jsx("span",{className:"hidden sm:inline",children:"Ajustes"})]}),p.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-5 py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl transition-all text-xs font-bold text-slate-400 hover:text-white group",title:"Descargar copia de seguridad de todos los universos",children:[p.jsx("span",{className:"material-symbols-outlined text-lg group-hover:scale-110 transition-transform",children:"cloud_download"}),p.jsx("span",{className:"hidden sm:inline",children:"Backup Global"})]}),p.jsxs("div",{className:"relative group min-w-[300px]",children:[p.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-white/20 text-xl group-focus-within:text-indigo-400 transition-colors pointer-events-none",children:"search"}),p.jsx("input",{type:"text",placeholder:"Buscar...",value:o,onChange:j=>l(j.target.value),className:"w-full bg-[#13141f] border border-white/5 rounded-2xl py-3 pl-12 pr-4 text-sm text-white focus:outline-none focus:border-indigo-500/50 transition-all placeholder:text-white/10"})]})]})]}),p.jsx("section",{className:"w-full max-w-6xl",children:n?p.jsxs("div",{className:"flex flex-col items-center gap-6 py-20 opacity-20",children:[p.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),p.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:"Accediendo al Sector Local..."})]}):p.jsxs("div",{className:"flex flex-wrap gap-6 justify-start pb-20",children:[p.jsxs("div",{onClick:()=>c(!0),className:"group relative h-[380px] rounded-[2.5rem] border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-6 hover:bg-white/5 hover:border-indigo-500/30 transition-all cursor-pointer overflow-hidden animate-in fade-in duration-700 w-full md:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)]",children:[p.jsx("div",{className:"w-20 h-20 rounded-full bg-[#13141f] border border-white/5 flex items-center justify-center text-4xl text-white/20 group-hover:scale-110 group-hover:text-indigo-400 transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-4xl",children:"add"})}),p.jsxs("div",{className:"text-center",children:[p.jsx("h3",{className:"text-xl font-black tracking-tight text-white/50 group-hover:text-white transition-colors",children:"Nuevo Cuaderno"}),p.jsx("p",{className:"text-[10px] font-bold text-white/20 uppercase tracking-widest mt-2 group-hover:text-white/40",children:"Inicia un nuevo universo"})]})]}),R.map(j=>{const D=j.imageUrl||"https://images.unsplash.com/photo-1451187580459-43490279c0fa?auto=format&fit=crop&q=80&w=800";return p.jsxs("div",{onClick:()=>S(j.filename),className:"group relative h-[380px] rounded-[2.5rem] bg-[#13141f] border border-white/5 overflow-hidden transition-all hover:-translate-y-2 hover:shadow-2xl hover:shadow-indigo-500/10 cursor-pointer animate-in fade-in slide-in-from-bottom-4 w-full md:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)]",children:[p.jsxs("div",{className:"absolute inset-x-0 top-0 h-2/3",children:[p.jsx("img",{src:D,className:"w-full h-full object-cover opacity-40 group-hover:opacity-60 transition-opacity",alt:""}),p.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#13141f] via-transparent to-transparent"})]}),p.jsxs("div",{className:"absolute top-6 right-6 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20",children:[p.jsx("button",{onClick:B=>{B.stopPropagation(),x(j.filename)},className:"w-10 h-10 rounded-full bg-black/50 backdrop-blur-md border border-white/10 flex items-center justify-center text-white/70 hover:text-white hover:bg-indigo-500 hover:border-indigo-400 transition-all",title:"Editar",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),p.jsx("button",{onClick:B=>{B.stopPropagation(),g(j.filename)},className:"w-10 h-10 rounded-full bg-black/50 backdrop-blur-md border border-white/10 flex items-center justify-center text-white/70 hover:text-white hover:bg-red-500 hover:border-red-400 transition-all",title:"Eliminar",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),p.jsx("div",{className:"absolute inset-0 flex flex-col justify-end p-8",children:p.jsxs("div",{className:"mt-auto space-y-3",children:[p.jsx("span",{className:"inline-block px-3 py-1 bg-red-500/20 border border-red-500/30 text-[9px] font-black text-red-100 rounded-lg tracking-widest uppercase",children:j.tag}),p.jsx("h3",{className:"text-3xl font-black text-white tracking-tighter leading-tight group-hover:text-indigo-400 transition-colors",children:j.title}),j.title!==j.filename&&p.jsx("p",{className:"text-[10px] text-white/30 font-mono mb-1",children:j.filename}),p.jsx("p",{className:"text-xs text-white/40 line-clamp-2 leading-relaxed",children:"Una tierra dividida por la magia y la tecnologa antigua..."}),p.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-white/5 mt-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]"}),p.jsxs("span",{className:"text-[9px] font-black uppercase tracking-widest text-white/20",children:["ltima edicin: ",p.jsx("span",{className:"text-white/40",children:j.lastModified})]})]}),p.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-[10px] font-black text-indigo-300",children:j.initials})]})]})})]},j.filename)})]})})]}),a&&p.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 px-6 py-3 bg-red-500/20 border border-red-500/30 text-red-200 rounded-2xl text-xs font-bold shadow-2xl animate-bounce",children:a}),p.jsx(XL,{isOpen:u,onClose:()=>c(!1),onCreate:N}),p.jsx(JL,{isOpen:!!v,onClose:()=>x(null),project:v,onUpdate:E}),p.jsx(e8,{isOpen:!!f,onClose:()=>g(null),onConfirm:k,title:"Eliminar Proyecto?",message:`Ests a punto de borrar "${f}" y todo su contenido permanentemente. Esta accin no se puede deshacer.`,confirmText:"Eliminar Universo",isDestructive:!0})]})},Af=({icon:t,title:e,desc:r,color:n,onClick:i})=>p.jsxs("div",{onClick:i,className:"group relative p-8 rounded-[32px] bg-surface-dark border border-white/5 hover:border-white/10 transition-all cursor-pointer flex flex-col h-full gap-6 hover:shadow-2xl hover:shadow-black/40",children:[p.jsx("div",{className:`size-14 rounded-2xl ${n} flex items-center justify-center text-white shadow-lg group-hover:scale-110 transition-all duration-500`,children:p.jsx("span",{className:"material-symbols-outlined text-3xl",children:t})}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("h3",{className:"text-2xl font-bold text-white tracking-tight",children:e}),p.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:r})]}),p.jsxs("div",{className:"mt-auto pt-6 border-t border-white/5 flex items-center justify-between text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-white transition-colors",children:[p.jsx("span",{children:"Explorar Herramienta"}),p.jsx("span",{className:"material-symbols-outlined text-sm group-hover:translate-x-1 transition-transform",children:"arrow_forward"})]})]}),r8=()=>{const{projectName:t}=Zu(),e=Ga(),{username:r}=ds(),n=`/${r}/${t}`;return p.jsxs("div",{className:"flex-1 flex flex-col h-screen overflow-hidden bg-background-dark",children:[p.jsxs("div",{className:"h-20 border-b border-white/5 flex items-center justify-between px-12 bg-surface-dark/20 backdrop-blur-xl shrink-0",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"size-10 rounded-xl bg-primary/20 flex items-center justify-center text-primary shadow-lg shadow-primary/10",children:p.jsx("span",{className:"material-symbols-outlined",children:"auto_stories"})}),p.jsxs("div",{children:[p.jsx("h1",{className:"text-xl font-black text-white tracking-tight uppercase",children:t}),p.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Panel de Control del Arquitecto"})]})]}),p.jsx("div",{className:"flex items-center gap-4",children:p.jsx("div",{className:"flex -space-x-2",children:[1,2,3].map(i=>p.jsx("div",{className:"size-8 rounded-full border-2 border-surface-dark bg-slate-800 flex items-center justify-center text-[10px] font-bold text-slate-400",children:p.jsx("span",{className:"material-symbols-outlined text-xs",children:"person"})},i))})})]}),p.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:p.jsxs("div",{className:"max-w-7xl mx-auto p-12 space-y-16 animate-in fade-in slide-in-from-bottom-8 duration-700",children:[p.jsxs("div",{className:"space-y-4 max-w-2xl",children:[p.jsxs("h2",{className:"text-4xl font-black text-white tracking-tighter leading-tight",children:["Bienvenido, ",p.jsx("span",{className:"text-indigo-400",children:"Arquitecto"}),"."]}),p.jsx("p",{className:"text-slate-400 text-lg font-serif italic leading-relaxed opacity-80",children:"Tu mundo est esperando ser esculpido. Utiliza el Codex para documentar entidades, el Atlas para trazar geografas o las Crnicas para escribir su historia."})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[p.jsx(Af,{icon:"menu_book",title:"Codex Mundial",desc:"Documenta personajes, lugares, grupos y objetos. Es la base de conocimiento de tu universo.",color:"bg-indigo-600 shadow-indigo-500/20",onClick:()=>e(`${n}/bible`)}),p.jsx(Af,{icon:"map",title:"Atlas Interactivo",desc:"Crea y gestiona mapas detallados con marcadores interactivos conectados a tu Codex.",color:"bg-emerald-600 shadow-emerald-500/20",onClick:()=>e(`${n}/map`)}),p.jsx(Af,{icon:"edit_note",title:"Las Crnicas",desc:"El editor zen para tus relatos, captulos y fragmentos de lore. Organizado por hojas.",color:"bg-amber-600 shadow-amber-500/20",onClick:()=>e(`${n}/writing`)}),p.jsx(Af,{icon:"hub",title:"Red de Relaciones",desc:"Visualiza las conexiones entre tus entidades mediante un grafo dinmico e interactivo.",color:"bg-purple-600 shadow-purple-500/20",onClick:()=>e(`${n}/graph`)}),p.jsx(Af,{icon:"calendar_month",title:"Lneas Temporales",desc:"Traza la cronologa de eventos histricos y la progresin de tus relatos.",color:"bg-rose-600 shadow-rose-500/20",onClick:()=>e(`${n}/timeline`)}),p.jsx(Af,{icon:"translate",title:"Forja Lingstica",desc:"Herramientas para la creacin de conlangs, diccionarios y gramticas nicas.",color:"bg-blue-600 shadow-blue-500/20",onClick:()=>e(`${n}/linguistics`)})]})]})})]})},n8=()=>{const t=Ga(),[e,r]=ce.useState(null),[n,i]=ce.useState([]),[a,s]=ce.useState([]),[o,l]=ce.useState("general"),[u,c]=ce.useState([]),[f,g]=ce.useState({theme:"deep_space",font:"Manrope",fontSize:16});ce.useEffect(()=>{try{const j=localStorage.getItem("user");j&&j!=="undefined"&&r(JSON.parse(j));const D=localStorage.getItem("app_settings");D&&g(JSON.parse(D));const B=localStorage.getItem("sync_projects");B&&s(JSON.parse(B)),v()}catch(j){console.error("Failed to parse user settings",j)}},[]);const v=async()=>{try{const j=await it.get("/workspaces");j&&i(j)}catch(j){console.error("Error loading projects for sync",j)}},x=(j,D="success")=>{const B=Date.now();c(I=>[...I,{id:B,message:j,type:D}]),setTimeout(()=>{c(I=>I.filter(V=>V.id!==B))},3e3)},_=(j,D)=>{const B={...f,[j]:D};g(B),localStorage.setItem("app_settings",JSON.stringify(B)),x(`Ajuste actualizado: ${j}`)},S=j=>{const D=a.includes(j),B=D?a.filter(I=>I!==j):[...a,j];s(B),localStorage.setItem("sync_projects",JSON.stringify(B)),x(D?"Universo desmarcado de sincronizacin":"Universo incluido en sincronizacin")},N=()=>{x("Iniciando descarga de backup...","info");const j=document.createElement("a"),D="/api/backup/download",B=a.length>0?`?projects=${a.join(",")}`:"";j.href=D+B,j.setAttribute("download",`worldbuilding_backup_${Date.now()}.zip`),document.body.appendChild(j),j.click(),document.body.removeChild(j)},k=er.useRef(null),E=async j=>{const D=j.target.files[0];if(!D)return;if(!D.name.endsWith(".db")){x("Solo se permiten archivos .db","error");return}const B=new FormData;B.append("file",D),x("Importando universo...","info");try{const I=await it.post("/import/database",B,{headers:{"Content-Type":"multipart/form-data"}});x(I.message||"Universo importado con xito"),v()}catch(I){console.error("Import error",I);const V=I.response?.data?.error||"Error al importar el archivo";x(V,"error")}k.current&&(k.current.value="")},T=[{id:"general",label:"General / Sincro",icon:"person"},{id:"appearance",label:"Apariencia y Editor",icon:"palette"}],R=[{id:"deep_space",label:"Deep Space",color:"#0f172a"},{id:"nebula",label:"Nebula",color:"#312e81"},{id:"high_contrast",label:"High Contrast",color:"#000000"}];return p.jsxs("div",{className:"flex flex-col w-full h-full bg-[#050508] text-white font-sans overflow-hidden",children:[p.jsx("div",{className:"fixed top-24 right-8 z-[100] flex flex-col gap-3",children:u.map(j=>p.jsxs("div",{className:"flex items-center gap-3 px-6 py-4 bg-surface-dark border border-white/10 rounded-2xl shadow-2xl animate-slide-in-right",children:[p.jsx("span",{className:`material-symbols-outlined ${j.type==="success"?"text-green-400":"text-indigo-400"}`,children:j.type==="success"?"check_circle":"info"}),p.jsx("span",{className:"text-sm font-bold",children:j.message})]},j.id))}),p.jsxs("header",{className:"h-20 flex-none flex items-center justify-between px-12 border-b border-white/5 bg-[#0a0a0e] z-30",children:[p.jsxs("div",{className:"flex items-center gap-8",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"size-10 rounded-xl bg-indigo-500 flex items-center justify-center text-white shadow-lg shadow-indigo-500/20",children:p.jsx("span",{className:"material-symbols-outlined text-2xl",children:"settings"})}),p.jsx("h1",{className:"text-xl font-bold tracking-tight hidden sm:block",children:"Ajustes"})]}),p.jsx("nav",{className:"flex items-center gap-2 p-1 bg-white/5 rounded-2xl",children:T.map(j=>p.jsxs("button",{onClick:()=>l(j.id),className:`flex items-center gap-2 px-5 py-2.5 rounded-xl text-xs font-bold transition-all ${o===j.id?"bg-indigo-500 text-white shadow-lg shadow-indigo-500/20":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:j.icon}),j.label]},j.id))})]}),p.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 px-6 py-2.5 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl transition-all text-xs font-bold text-slate-400 hover:text-white",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"}),p.jsx("span",{children:"Volver"})]})]}),p.jsx("main",{className:"flex-1 overflow-y-auto p-12 custom-scrollbar",children:p.jsxs("div",{className:"max-w-3xl mx-auto pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[o==="general"&&p.jsxs("div",{className:"space-y-6",children:[p.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8",children:[p.jsxs("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2 text-indigo-400",children:[p.jsx("span",{className:"material-symbols-outlined",children:"person"}),"Perfil de Arquitecto"]}),p.jsxs("div",{className:"flex items-center gap-6 p-4 bg-white/5 rounded-2xl border border-white/5",children:[p.jsx("div",{className:"size-16 rounded-full bg-indigo-500 flex items-center justify-center text-white text-2xl font-black",children:e?.username?.substring(0,2).toUpperCase()||"AR"}),p.jsxs("div",{className:"flex-1",children:[p.jsx("h4",{className:"text-xl font-bold text-white",children:e?.username||"Arquitecto Local"}),p.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Sincronizacin guardada automticamente."})]})]})]}),p.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8 space-y-6",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-indigo-400",children:[p.jsx("span",{className:"material-symbols-outlined",children:"sync_lock"}),"Sincronizacin y Respaldo"]}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("input",{type:"file",ref:k,onChange:E,accept:".db",className:"hidden"}),p.jsxs("button",{onClick:()=>k.current?.click(),className:"flex items-center gap-2 px-6 py-3 border border-white/5 bg-white/5 hover:bg-white/10 text-white rounded-2xl text-xs font-black uppercase tracking-widest transition-all",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"upload_file"}),"Importar Universo"]}),p.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-6 py-3 bg-indigo-500 hover:bg-indigo-600 text-white rounded-2xl text-xs font-black uppercase tracking-widest transition-all shadow-lg shadow-indigo-500/30",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"cloud_download"}),"Descargar Backup ZIP"]})]})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 block",children:"Universos para sincronizacin"}),p.jsx("div",{className:"grid grid-cols-2 gap-3",children:n.length>0?n.map(j=>p.jsxs("button",{onClick:()=>S(j.filename),className:`flex items-center gap-3 p-4 rounded-2xl border transition-all text-left ${a.includes(j.filename)?"border-indigo-500 bg-indigo-500/10 text-white":"border-white/5 bg-black/20 text-slate-400 hover:border-white/10"}`,children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:a.includes(j.filename)?"check_circle":"circle"}),p.jsx("div",{className:"truncate",children:p.jsx("p",{className:"text-xs font-bold truncate",children:j.title})})]},j.filename)):p.jsx("div",{className:"col-span-2 p-8 border border-dashed border-white/5 rounded-2xl text-center text-slate-600 text-xs italic text-glass-muted",children:"No hay universos detectados..."})})]})]})]}),o==="appearance"&&p.jsxs("div",{className:"space-y-6",children:[p.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8",children:[p.jsxs("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2 text-indigo-400",children:[p.jsx("span",{className:"material-symbols-outlined",children:"palette"}),"Esttica del Sistema"]}),p.jsx("div",{className:"grid grid-cols-3 gap-6",children:R.map(j=>p.jsxs("button",{onClick:()=>_("theme",j.id),className:`relative flex flex-col gap-3 group text-left transition-all p-3 rounded-2xl border ${f.theme===j.id?"border-indigo-500 bg-indigo-500/5 ring-1 ring-indigo-500/50":"border-white/5 bg-black/20 hover:border-white/20"}`,children:[p.jsx("div",{className:"h-24 rounded-xl flex items-center justify-center overflow-hidden",style:{backgroundColor:j.color},children:p.jsx("div",{className:"size-10 rounded-full bg-white/10 backdrop-blur-xl border border-white/10"})}),p.jsx("span",{className:"text-xs font-bold text-center",children:j.label})]},j.id))})]}),p.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8",children:[p.jsxs("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2 text-indigo-400",children:[p.jsx("span",{className:"material-symbols-outlined",children:"text_fields"}),"Tipografa y Lectura"]}),p.jsxs("div",{className:"grid grid-cols-2 gap-12",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Fuente del Codex"}),p.jsxs("div",{className:"relative",children:[p.jsxs("select",{value:f.font,onChange:j=>_("font",j.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl px-5 py-3.5 text-sm text-white appearance-none outline-none focus:border-indigo-500 transition-all font-sans",children:[p.jsx("option",{value:"Manrope",children:"Manrope (Moderno)"}),p.jsx("option",{value:"Merriweather",children:"Merriweather (Serif)"}),p.jsx("option",{value:"Inter",children:"Inter (Legibilidad)"}),p.jsx("option",{value:"JetBrains Mono",children:"JetBrains (Mono)"})]}),p.jsx("span",{className:"material-symbols-outlined absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-500",children:"expand_more"})]})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Tamao del Texto"}),p.jsxs("span",{className:"text-xs font-bold text-indigo-400",children:[f.fontSize,"px"]})]}),p.jsx("div",{className:"flex items-center gap-4 py-3",children:p.jsx("input",{type:"range",min:"12",max:"24",value:f.fontSize,onChange:j=>_("fontSize",parseInt(j.target.value)),className:"flex-1 accent-indigo-500 h-1 bg-white/10 rounded-full appearance-none cursor-pointer"})})]})]}),p.jsx("div",{className:"mt-8 p-6 bg-black/40 rounded-2xl border border-white/5 text-center shadow-inner",children:p.jsx("p",{style:{fontFamily:f.font,fontSize:`${f.fontSize}px`},className:"text-slate-200 transition-all duration-300",children:'"El universo es un libro escrito en el lenguaje de las historias."'})})]})]})]})})]})},nv=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirmar",cancelText:s="Cancelar",type:o="danger"})=>t?nu.createPortal(p.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[p.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),p.jsxs("div",{className:"relative w-full max-w-md bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl p-6 animate-in zoom-in-95 duration-200 overflow-hidden",children:[p.jsx("div",{className:"absolute top-0 left-0 right-0 h-32 bg-gradient-to-b from-white/5 to-transparent pointer-events-none"}),p.jsxs("div",{className:"relative z-10 text-center",children:[p.jsx("div",{className:`mx-auto mb-4 size-16 rounded-2xl flex items-center justify-center ${o==="danger"?"bg-red-500/10 text-red-500":"bg-yellow-500/10 text-yellow-500"}`,children:p.jsx("span",{className:"material-symbols-outlined text-3xl",children:o==="danger"?"delete_forever":"warning"})}),p.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),p.jsx("p",{className:"text-text-muted text-sm mb-8 leading-relaxed",children:i}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 rounded-xl bg-surface-light hover:bg-white/10 text-text-muted hover:text-white text-xs font-bold transition-all border border-white/5",children:s}),p.jsx("button",{onClick:()=>{r(),e()},className:`flex-1 px-4 py-3 rounded-xl text-white text-xs font-bold transition-all shadow-lg flex items-center justify-center gap-2
                                ${o==="danger"?"bg-red-500 hover:bg-red-600 shadow-red-500/20":"bg-primary hover:bg-primary-light shadow-primary/20"}`,children:p.jsx("span",{children:a})})]})]})]})]}),document.body):null,$k=({compact:t=!1})=>{const[e,r]=ce.useState(null),[n,i]=ce.useState([]),[a,s]=ce.useState(!1),[o,l]=ce.useState(null);ce.useEffect(()=>{u()},[]);const u=async()=>{try{const v=await it.get("/world-bible/folders");v.length>0&&r(v[0].id),c()}catch(v){console.error("Init error:",v)}},c=async()=>{s(!0);try{const v=await it.get("/world-bible/templates/global");i(v)}catch(v){console.error("Error loading templates:",v)}finally{s(!1)}},f=async v=>{if(e)try{await it.post(`/world-bible/folders/${e}/templates`,{nombre:v.label,tipo:v.type,required:v.required,metadata:v.metadata?JSON.stringify(v.metadata):null,global:!0}),c()}catch(x){console.error("Error creating template:",x)}},g=async()=>{if(o)try{await it.delete(`/world-bible/templates/${o}`),i(v=>v.filter(x=>x.id!==o))}catch(v){console.error("Error deleting template:",v)}finally{l(null)}};return p.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[p.jsxs(Rr,{className:`${t?"p-4 bg-transparent border-none shadow-none":"p-8 space-y-8"}`,children:[p.jsx("header",{className:`flex ${t?"flex-col gap-4":"justify-between items-center"}`,children:p.jsxs("div",{children:[p.jsx("h3",{className:`${t?"text-sm":"text-xl"} font-bold text-white`,children:"Atributos Globales"}),p.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Define atributos disponibles para todas las entidades."})]})}),p.jsxs("div",{className:"space-y-4",children:[a?p.jsx("div",{className:"text-center p-4 text-slate-500",children:"Cargando plantillas..."}):n.map((v,x)=>p.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-primary/50 hover:bg-white/5 transition-all cursor-grab active:cursor-grabbing group select-none",draggable:!0,onDragStart:_=>{_.dataTransfer.setData("application/reactflow/type","attribute"),_.dataTransfer.setData("templateId",v.id),_.dataTransfer.setData("templateData",JSON.stringify(v)),_.dataTransfer.effectAllowed="copy"},children:[p.jsxs("span",{className:"text-[10px] font-black text-slate-700 w-6 group-hover:text-primary transition-colors",children:["0",x+1]}),p.jsxs("div",{className:"flex-1 pointer-events-none",children:[p.jsx("div",{className:"text-sm font-bold text-white",children:v.nombre}),p.jsxs("div",{className:"text-[10px] text-slate-500 uppercase tracking-widest",children:[v.tipo," ",v.esObligatorio&&" Required"]}),v.metadata&&p.jsx("div",{className:"text-[10px] text-slate-600 font-mono mt-1 truncate",children:v.metadata})]}),p.jsx("button",{onClick:()=>l(v.id),className:"p-1.5 text-slate-500 hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",title:"Eliminar Plantilla Global",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},v.id)),p.jsx(i8,{onAdd:f})]})]}),p.jsx(nv,{isOpen:!!o,onClose:()=>l(null),onConfirm:g,title:"Eliminar Plantilla",message:"Ests seguro de que quieres eliminar esta plantilla? Esta accin es irreversible.",confirmText:"Eliminar",type:"danger"})]})},i8=({onAdd:t})=>{const[e,r]=ce.useState(""),[n,i]=ce.useState("text"),[a,s]=ce.useState(!1),[o,l]=ce.useState([""]),u=()=>l([...o,""]),c=v=>l(o.filter((x,_)=>_!==v)),f=(v,x)=>{const _=[...o];_[v]=x,l(_)},g=()=>{if(!e)return;let v=null;["select","multi_select"].includes(n)&&(v={options:o.filter(x=>x.trim())}),t({label:e,type:n,required:a,metadata:v}),r(""),l([""])};return p.jsxs("div",{className:"p-4 rounded-2xl border-2 border-dashed border-white/10 bg-white/[0.01] space-y-4",children:[p.jsx("h4",{className:"text-xs font-black uppercase tracking-widest text-primary",children:"Add New Attribute"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsx("input",{placeholder:"Field Name",value:e,onChange:v=>r(v.target.value),className:"bg-black/20 border border-white/5 rounded-xl px-4 py-2 text-xs text-white outline-none focus:border-primary/30 min-w-0"}),p.jsxs("select",{value:n,onChange:v=>i(v.target.value),className:"bg-black/20 border border-white/5 rounded-xl px-4 py-2 text-xs text-white outline-none",children:[p.jsx("option",{value:"text",children:"Text (Long)"}),p.jsx("option",{value:"short_text",children:"Text (Short)"}),p.jsx("option",{value:"number",children:"Number"}),p.jsx("option",{value:"date",children:"Date"}),p.jsx("option",{value:"select",children:"Single Selection (Dropdown)"}),p.jsx("option",{value:"multi_select",children:"Multiple Selection"}),p.jsx("option",{value:"boolean",children:"Switch (True/False)"})]})]}),["select","multi_select"].includes(n)&&p.jsxs("div",{className:"space-y-2",children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Options"}),p.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-2 custom-scrollbar",children:o.map((v,x)=>p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{placeholder:`Option ${x+1}`,value:v,onChange:_=>f(x,_.target.value),className:"flex-1 bg-black/20 border border-white/5 rounded-lg px-3 py-1.5 text-xs text-white outline-none focus:border-primary/30"}),p.jsx("button",{onClick:()=>c(x),className:"p-1.5 hover:bg-red-500/20 text-slate-500 hover:text-red-400 rounded-lg transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]},x))}),p.jsx("button",{onClick:u,className:"w-full py-1.5 text-[10px] font-bold uppercase tracking-widest text-primary hover:bg-primary/5 rounded-lg border border-dashed border-primary/20 transition-all",children:"+ Add Custom Option"})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:a,onChange:v=>s(v.target.checked),className:"size-4 rounded border-white/10 bg-white/5 accent-primary"}),p.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"Required Field"})]}),p.jsx("button",{onClick:g,className:"px-4 py-2 bg-primary/20 text-primary rounded-lg text-xs font-bold hover:bg-primary/30 transition-all",children:"+ Add Field"})]})]})},Kk=({projectName:t,storageKey:e})=>{const[r,n]=ce.useState([]),[i,a]=ce.useState(!1),[s,o]=ce.useState(null),l=()=>e||`notes_v2_${t}`;ce.useEffect(()=>{const k=l();if(!k)return;const E=localStorage.getItem(k);if(E)n(JSON.parse(E));else if(!e){const T=localStorage.getItem(`notes_${t}`);if(T){const R={id:Date.now(),title:"Nota General",content:T};n([R]),localStorage.setItem(k,JSON.stringify([R]))}}},[t,e]);const u=k=>{n(k);const E=l();E&&localStorage.setItem(E,JSON.stringify(k))},c=()=>{const k={id:Date.now(),title:"Nueva Nota",content:""};u([...r,k]),o(k.id)},[f,g]=ce.useState(null),v=k=>{g(k)},x=()=>{f&&(u(r.filter(k=>k.id!==f)),g(null))},_=(k,E,T)=>{u(r.map(R=>R.id===k?{...R,[E]:T}:R))},S=()=>a(!i),N=()=>p.jsxs("div",{className:`flex flex-col h-full bg-surface-dark/40 ${i?"":"max-h-[25vh]"}`,children:[p.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-glass-border bg-white/5",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"edit_note"}),p.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-white",children:["Notas (",r.length,")"]})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("button",{onClick:c,className:"p-1 hover:text-primary text-text-muted transition-colors",title:"Aadir Nota",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})}),p.jsx("button",{onClick:S,className:"p-1 hover:text-white text-text-muted transition-colors",title:"Pantalla Completa",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:i?"fullscreen_exit":"fullscreen"})})]})]}),p.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-2",children:r.length===0?p.jsx("div",{className:"py-8 text-center opacity-30 italic text-[10px] uppercase font-bold",children:"Sin notas"}):r.map(k=>p.jsxs("div",{className:"group bg-white/5 border border-glass-border rounded-xl overflow-hidden hover:border-primary/30 transition-all",children:[p.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white/5",children:[p.jsx("input",{className:"bg-transparent border-none text-[11px] font-bold text-white outline-none w-full",value:k.title,onChange:E=>_(k.id,"title",E.target.value),placeholder:"Ttulo..."}),p.jsx("button",{onClick:()=>v(k.id),className:"opacity-0 group-hover:opacity-100 p-1 text-text-muted hover:text-red-400 transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-xs",children:"delete"})})]}),p.jsx("textarea",{className:"w-full bg-transparent p-3 text-xs text-white/70 outline-none resize-none min-h-[80px] custom-scrollbar",value:k.content,onChange:E=>_(k.id,"content",E.target.value),placeholder:"Escribe el contenido aqu..."})]},k.id))}),p.jsx(nv,{isOpen:!!f,onClose:()=>g(null),onConfirm:x,title:"Eliminar Nota",message:"Ests seguro de que quieres eliminar esta nota? No se podr recuperar.",confirmText:"Eliminar",type:"danger"})]});return i?p.jsx("div",{className:"fixed inset-0 z-[100] bg-background-dark/95 backdrop-blur-md p-8 flex flex-col items-center",children:p.jsx("div",{className:"w-full max-w-4xl h-full flex flex-col border border-glass-border rounded-3xl overflow-hidden shadow-2xl bg-surface-dark",children:p.jsx(N,{})})}):p.jsx("div",{className:"h-full border border-glass-border rounded-2xl overflow-hidden",children:p.jsx(N,{})})},ch=({to:t,icon:e,label:r,collapsed:n,end:i})=>p.jsxs(fL,{to:t,end:i,className:({isActive:a})=>`
            flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all group
            ${a?"bg-primary text-white shadow-lg shadow-primary/20":"text-text-muted hover:text-white hover:bg-white/5"}
            ${n?"justify-center":""}
        `,title:n?r:"",children:[p.jsx("span",{className:"material-symbols-outlined text-xl",children:e}),!n&&p.jsx("span",{className:"text-sm font-bold tracking-wide",children:r})]}),Zk=t=>{switch(t?.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},a8=()=>{console.log("ArchitectLayout Mounting");const{username:t,projectName:e,folderSlug:r}=ds(),n=Ga(),i=$h(),[a,s]=ce.useState(!0),[o,l]=ce.useState(!1),[u,c]=ce.useState("Loading..."),[f,g]=ce.useState(null),[v,x]=ce.useState("NOTES"),[_,S]=ce.useState(""),[N,k]=ce.useState([]),[E,T]=ce.useState(null),[R,j]=ce.useState(null),[D,B]=ce.useState({name:"",description:"",type:"regional",showGrid:!0,gridSize:50,width:800,height:600,bgImage:null}),[I,V]=ce.useState(null),[$,Z]=ce.useState("identity"),[O,W]=ce.useState("notes"),[F,K]=ce.useState(""),[X,Q]=ce.useState("ALL"),ae=i.pathname.includes("/bible"),re=i.pathname.includes("/writing"),[G,te]=ce.useState("index"),[ne,de]=ce.useState(null),[me,ye]=ce.useState([]),[ie,pe]=ce.useState("identity"),[oe,fe]=ce.useState(null),ge=(Ue,Ve)=>{Ue.stopPropagation(),fe(Ve)},be=async()=>{if(oe){try{await it.delete(`/world-bible/templates/${oe}`),k(Ue=>Ue.filter(Ve=>Ve.id!==oe))}catch(Ue){console.error("Delete failed",Ue)}fe(null)}},_e=async Ue=>{Ue.preventDefault();try{await it.put(`/world-bible/templates/${ne.id}`,ne),k(Ve=>Ve.map(Je=>Je.id===ne.id?ne:Je)),de(null)}catch(Ve){console.error("Update failed",Ve)}},De=`/${t}/${e}`;ce.useEffect(()=>{e&&qe(e);const Ue=()=>{e&&qe(e)};return window.addEventListener("focus",Ue),()=>window.removeEventListener("focus",Ue)},[e]);const qe=async Ue=>{try{const Ve=await it.get(`/proyectos/${Ue}`);Ve&&(c(Ve.nombreProyecto),g(Ve.id))}catch(Ve){console.error("Error loading project:",Ve),c("Error"),n("/")}};return p.jsxs("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark text-text-main font-sans selection:bg-primary/30",children:[p.jsxs("aside",{className:`
                    flex-none bg-surface-dark border-r border-glass-border transition-all duration-500 relative flex flex-col z-30
                    ${a?"w-80":"w-20"}
                `,children:[p.jsxs("div",{className:"h-16 flex items-center justify-center border-b border-glass-border relative",children:[a?p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:"size-8 rounded-lg bg-surface-light flex items-center justify-center text-primary shadow-inner",children:p.jsx("span",{className:"material-symbols-outlined",children:i.pathname.includes("/writing")?"edit_note":i.pathname.includes("/graph")?"hub":i.pathname.includes("/bible")?"auto_stories":i.pathname.includes("/map")?"map":i.pathname.includes("/timeline")?"timeline":i.pathname.includes("/languages")?"translate":"auto_stories"})}),p.jsx("h2",{className:"text-sm font-black uppercase tracking-widest text-white truncate max-w-[150px]",children:u})]}):p.jsx("button",{onClick:()=>s(!0),className:"size-10 rounded-xl hover:bg-white/5 flex items-center justify-center text-text-muted hover:text-white transition-all",children:p.jsx("span",{className:"material-symbols-outlined",children:"menu"})}),a&&p.jsx("button",{onClick:()=>s(!1),className:"absolute right-4 text-text-muted hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"dock_to_left"})})]}),p.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar flex flex-col",children:p.jsxs("div",{className:"p-3 space-y-1",children:[p.jsx(ch,{to:De,icon:"home",label:"Dashboard",collapsed:!a,end:!0}),p.jsx(ch,{to:`${De}/bible`,icon:"menu_book",label:"World Bible",collapsed:!a}),p.jsx(ch,{to:`${De}/map`,icon:"map",label:"Atlas",collapsed:!a}),p.jsx(ch,{to:`${De}/timeline`,icon:"calendar_month",label:"Chronology",collapsed:!a}),p.jsx(ch,{to:`${De}/graph`,icon:"hub",label:"Graph",collapsed:!a}),p.jsx("div",{className:"h-px bg-glass-border my-2 mx-2 opacity-50"}),p.jsx(ch,{to:`${De}/writing`,icon:"edit_note",label:"Writing",collapsed:!a}),p.jsx("div",{className:"h-px bg-glass-border my-2 mx-2 opacity-10"}),p.jsx(ch,{to:"/",icon:"logout",label:"Salir al Hub",collapsed:!a})]})}),p.jsx("footer",{className:"p-4 border-t border-glass-border",children:p.jsxs("div",{className:`flex items-center gap-3 ${!a&&"justify-center"}`,children:[p.jsx("div",{className:"size-10 rounded-full border border-glass-border p-1 bg-surface-light relative",children:p.jsx("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-primary to-purple-500 flex items-center justify-center text-white font-black text-xs",children:t?t.substring(0,2).toUpperCase():"US"})}),a&&p.jsxs("div",{className:"overflow-hidden",children:[p.jsx("h4",{className:"text-xs font-bold text-white truncate",children:t||"User"}),p.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-tighter",children:"Architect"})]})]})})]}),p.jsxs("main",{className:"flex-1 flex flex-col min-w-0 bg-background-dark relative",children:[p.jsx("div",{className:"h-16 w-full absolute top-0 left-0 bg-gradient-to-b from-background-dark to-transparent pointer-events-none"}),p.jsx("div",{className:"flex-1 flex overflow-hidden relative",children:p.jsx(__,{context:{setRightPanelMode:x,setRightOpen:l,setRightPanelTitle:S,projectName:u,projectId:f,availableTemplates:N,setAvailableTemplates:k,setAddAttributeHandler:T,setCreateTemplateHandler:j,mapSettings:D,setMapSettings:B,setOnMapSettingsChange:V,entityTabs:me,setEntityTabs:ye,activeEntityTab:ie,setActiveEntityTab:pe,folderSearchTerm:F,setFolderSearchTerm:K,folderFilterType:X,setFolderFilterType:Q}})})]}),p.jsxs("aside",{className:`
                    flex-none bg-surface-dark border-l border-glass-border transition-all duration-500 relative flex flex-col z-30 shrink-0
                    ${o?"w-80":"w-20"}
                `,children:[p.jsx("header",{className:"h-16 flex items-center px-6 border-b border-glass-border justify-between shrink-0",children:o?p.jsxs(p.Fragment,{children:[v==="CUSTOM"&&!re?p.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-primary",children:_||"Panel"}):re?p.jsxs("div",{className:"flex bg-white/5 rounded-lg p-1 gap-1 w-full mr-4",children:[p.jsx("button",{onClick:()=>te("index"),className:`flex-1 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${G==="index"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"ndice"}),p.jsx("button",{onClick:()=>te("notes"),className:`flex-1 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${G==="notes"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Notas"})]}):ae&&v==="NOTES"?p.jsxs("div",{className:"flex bg-white/5 rounded-lg p-1 gap-1",children:[p.jsx("button",{onClick:()=>W("notes"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${O==="notes"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Notas"}),p.jsx("button",{onClick:()=>W("templates"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${O==="templates"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Plantillas"}),p.jsx("button",{onClick:()=>W("filters"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${O==="filters"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Explorar"})]}):p.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-white",children:_||(v==="NOTES"?"Notas Globales":"Constructor")}),p.jsx("button",{onClick:()=>l(!1),className:"text-text-muted hover:text-white transition-colors shrink-0",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"dock_to_right"})})]}):p.jsx("button",{onClick:()=>l(!0),className:"w-full h-full flex items-center justify-center text-text-muted hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined",children:v==="NOTES"||re?"edit_note":v==="MAP"?"map":v==="CUSTOM"?"build":"handyman"})})}),p.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar p-0 relative",children:[p.jsx("div",{id:"architect-right-panel-portal",className:`
                            ${(re||v==="CUSTOM")&&o?"flex flex-col h-full relative":"hidden"}
                        `}),o?re?p.jsx(p.Fragment,{children:p.jsx("div",{className:`h-full p-4 overflow-hidden ${G==="notes"?"block":"hidden"}`,children:p.jsx(Kk,{projectName:e})})}):v==="CUSTOM"?p.jsx(p.Fragment,{}):v==="NOTES"?O==="templates"&&ae?p.jsx("div",{className:"h-full overflow-y-auto no-scrollbar",children:p.jsx($k,{compact:!0})}):O==="filters"&&ae?p.jsxs("div",{className:"h-full p-6 space-y-6 animate-in fade-in slide-in-from-right-4",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Bsqueda"}),p.jsxs("div",{className:"bg-black/20 border border-white/10 rounded-xl p-3 flex items-center gap-2 focus-within:border-primary transition-colors",children:[p.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"search"}),p.jsx("input",{value:F,onChange:Ue=>K(Ue.target.value),placeholder:"Buscar entidad...",className:"bg-transparent border-none outline-none text-sm text-white w-full placeholder-slate-600"}),F&&p.jsx("button",{onClick:()=>K(""),className:"text-slate-500 hover:text-white",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]})]}),p.jsx("div",{className:"h-px bg-glass-border"}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Filtrar por Tipo"}),p.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"ALL",label:"Todos",icon:"grid_view"},{id:"ENTITY",label:"Entidades",icon:"person"},{id:"MAP",label:"Mapas",icon:"map"},{id:"TIMELINE",label:"Timelines",icon:"timeline"}].map(Ue=>p.jsxs("button",{onClick:()=>Q(Ue.id),className:`
                                                        p-3 rounded-xl border flex flex-col items-center gap-2 transition-all
                                                        ${X===Ue.id?"bg-primary text-white border-primary shadow-lg shadow-primary/20":"bg-white/5 border-transparent text-slate-500 hover:bg-white/10 hover:text-white"}
                                                    `,children:[p.jsx("span",{className:"material-symbols-outlined",children:Ue.icon}),p.jsx("span",{className:"text-[10px] font-bold uppercase",children:Ue.label})]},Ue.id))})]})]}):p.jsx("div",{className:"h-full p-4 overflow-hidden",children:p.jsx(Kk,{projectName:e})}):v==="MAP"?p.jsxs("div",{className:"p-6 space-y-8 animate-in fade-in slide-in-from-right-4",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Grid System"}),p.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[p.jsx("input",{type:"checkbox",checked:D.showGrid,onChange:Ue=>{const Ve={...D,showGrid:Ue.target.checked};B(Ve),I&&I(Ve)},className:"sr-only peer"}),p.jsx("div",{className:"w-9 h-5 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-primary"})]})]}),p.jsxs("div",{className:`space-y-2 transition-opacity ${D.showGrid?"opacity-100":"opacity-30 pointer-events-none"}`,children:[p.jsxs("div",{className:"flex justify-between text-xs font-bold text-white",children:[p.jsx("span",{children:"Size"}),p.jsxs("span",{className:"font-mono text-primary",children:[D.gridSize,"px"]})]}),p.jsx("input",{type:"range",min:"10",max:"200",step:"10",value:D.gridSize,onChange:Ue=>{const Ve={...D,gridSize:parseInt(Ue.target.value)};B(Ve),I&&I(Ve)},className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-primary"})]})]}),p.jsx("div",{className:"h-px bg-glass-border"}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Canvas Data"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{className:"space-y-1",children:[p.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Width (px)"}),p.jsx("input",{type:"number",value:D.width,onChange:Ue=>{const Ve={...D,width:parseInt(Ue.target.value)};B(Ve),I&&I(Ve)},className:"w-full bg-black/20 border border-white/10 rounded-lg p-2 text-white text-right font-mono text-sm focus:border-primary outline-none"})]}),p.jsxs("div",{className:"space-y-1",children:[p.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Height (px)"}),p.jsx("input",{type:"number",value:D.height,onChange:Ue=>{const Ve={...D,height:parseInt(Ue.target.value)};B(Ve),I&&I(Ve)},className:"w-full bg-black/20 border border-white/10 rounded-lg p-2 text-white text-right font-mono text-sm focus:border-primary outline-none"})]})]})]}),p.jsx("div",{className:"h-px bg-glass-border"}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Background Image"}),p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("label",{className:"cursor-pointer bg-white/5 hover:bg-white/10 text-white rounded-lg px-3 py-2 text-xs font-bold transition-colors border border-glass-border flex items-center gap-2 flex-1",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"upload"}),p.jsx("span",{children:"Upload New Image"}),p.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:Ue=>{const Ve=Ue.target.files[0];if(Ve){const Je=new FileReader;Je.onload=ft=>{const We=new Image;We.onload=()=>{const Ce={...D,bgImage:ft.target.result,width:We.width,height:We.height};B(Ce),I&&I(Ce)},We.src=ft.target.result},Je.readAsDataURL(Ve)}}})]}),D.bgImage&&p.jsx("button",{onClick:()=>{const Ue={...D,bgImage:null};B(Ue),I&&I(Ue)},className:"p-2 bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-lg border border-red-500/20",title:"Remove Image",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),D.bgImage&&p.jsxs("div",{className:"rounded-lg overflow-hidden border border-glass-border bg-black/20 h-32 relative group",children:[p.jsx("img",{src:D.bgImage,alt:"Background",className:"w-full h-full object-cover opacity-70"}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:p.jsxs("span",{className:"text-[10px] font-mono bg-black/50 px-2 py-1 rounded text-white backdrop-blur-sm",children:[D.width," x ",D.height]})})]})]})]})]}):v==="ENTITY"?p.jsxs("div",{className:"flex flex-col h-full animate-in fade-in slide-in-from-right-4",children:[p.jsx("div",{className:"p-4 border-b border-glass-border",children:p.jsx("div",{className:"bg-black/40 p-1 rounded-xl flex",children:me.map(Ue=>{const Ve=Je=>{switch(Je.toLowerCase()){case"identity":return"badge";case"narrative":return"auto_stories";case"attributes":return"tune";case"notes":return"edit_note";default:return"circle"}};return p.jsxs("button",{onClick:()=>pe(Ue),className:`
                                                        flex-1 py-2 rounded-lg transition-all group relative flex items-center justify-center
                                                        ${ie===Ue?"bg-primary text-white shadow-lg":"text-text-muted hover:text-white hover:bg-white/5"}
                                                    `,title:Ue,children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:Ve(Ue)}),p.jsx("span",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2 bg-black/90 text-white text-[10px] uppercase font-bold px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50",children:Ue})]},Ue)})})}),ie==="attributes"&&p.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col bg-black/20",children:[p.jsxs("div",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500 tracking-widest flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"drag_indicator"})," Drag Attributes"]}),p.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-2",children:p.jsx($k,{compact:!0,initialFolderSlug:r})})]})]}):v==="TOOLBOX"?p.jsx("div",{className:"p-4 space-y-6",children:p.jsxs("div",{className:"space-y-3",children:[p.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted px-2 flex justify-between items-center",children:[p.jsx("span",{children:"Plantillas Disponibles"}),p.jsx("button",{className:"text-primary hover:text-white transition-colors",title:"Crear Nueva Plantilla",onClick:()=>R&&R(),children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})]}),N.length===0?p.jsx("div",{className:"p-6 text-center border border-dashed border-glass-border rounded-2xl opacity-30",children:p.jsx("p",{className:"text-[10px] uppercase font-bold",children:"Sin Plantillas"})}):N.map(Ue=>p.jsxs("button",{className:"w-full flex items-center gap-3 p-3 rounded-2xl bg-white/5 border border-glass-border hover:border-primary/50 hover:bg-primary/5 transition-all text-left group relative",draggable:!0,onDragStart:Ve=>{Ve.dataTransfer.setData("application/reactflow/type","attribute"),Ve.dataTransfer.setData("templateId",Ue.id),Ve.dataTransfer.effectAllowed="move"},onClick:()=>E&&E(Ue.id),children:[Ue.global&&p.jsx("span",{className:"absolute top-2 right-2 flex size-2 bg-blue-500 rounded-full shadow-lg shadow-blue-500/50",title:"Global"}),p.jsx("div",{className:"size-8 rounded-lg bg-surface-light flex items-center justify-center text-primary group-hover:scale-110 transition-transform",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:Zk(Ue.tipo)})}),p.jsxs("div",{className:"overflow-hidden",children:[p.jsx("p",{className:"text-xs font-bold text-white truncate",children:Ue.nombre}),p.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-tighter",children:Ue.tipo})]}),p.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[p.jsx("div",{onClick:Ve=>{Ve.stopPropagation(),de(Ue)},className:"p-1 hover:text-white text-text-muted hover:bg-white/10 rounded cursor-pointer",title:"Edit",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),p.jsx("div",{onClick:Ve=>ge(Ve,Ue.id),className:"p-1 hover:text-red-400 text-text-muted hover:bg-white/10 rounded cursor-pointer",title:"Delete",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]},Ue.id))]})}):p.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted opacity-50",children:[p.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"dashboard"}),p.jsx("p",{className:"text-xs uppercase font-bold tracking-widest",children:"Select an item"})]}):p.jsx("div",{className:"flex flex-col items-center gap-4 py-4 w-full",children:v==="NOTES"||re?p.jsx("button",{onClick:()=>l(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Notas Globales",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"edit_note"})}):v==="MAP"?p.jsx("button",{onClick:()=>l(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Ajustes de Mapa",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"tune"})}):v==="ENTITY"?p.jsx("button",{onClick:()=>l(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Atributos",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"fact_check"})}):v==="CUSTOM"?p.jsx("button",{onClick:()=>l(!0),className:"size-10 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary hover:bg-primary/20 transition-all",title:_||"Panel",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"extension"})}):N.slice(0,5).map(Ue=>p.jsxs("button",{className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white hover:bg-primary/20 transition-all relative",draggable:!0,onDragStart:Ve=>{Ve.dataTransfer.setData("application/reactflow/type","attribute"),Ve.dataTransfer.setData("templateId",Ue.id)},title:Ue.nombre,children:[Ue.global&&p.jsx("span",{className:"absolute top-0 right-0 size-2 bg-blue-500 rounded-full border border-surface-dark"}),p.jsx("span",{className:"material-symbols-outlined text-lg",children:Zk(Ue.tipo)})]},Ue.id))})]})]}),ne&&p.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:p.jsxs("div",{className:"bg-surface-dark border border-glass-border rounded-2xl p-6 w-full max-w-md shadow-2xl animate-scale-in",children:[p.jsx("h3",{className:"text-xl font-black text-white mb-4",children:"Editar Plantilla"}),p.jsxs("form",{onSubmit:_e,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-xs uppercase font-bold text-text-muted block mb-1",children:"Nombre"}),p.jsx("input",{autoFocus:!0,className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none",value:ne.nombre,onChange:Ue=>de({...ne,nombre:Ue.target.value}),required:!0})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-xs uppercase font-bold text-text-muted block mb-1",children:"Tipo"}),p.jsxs("select",{className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none",value:ne.tipo,onChange:Ue=>de({...ne,tipo:Ue.target.value}),children:[p.jsx("option",{value:"text",children:"Texto Largo"}),p.jsx("option",{value:"short_text",children:"Texto Corto"}),p.jsx("option",{value:"number",children:"Nmero"}),p.jsx("option",{value:"boolean",children:"Si/No"}),p.jsx("option",{value:"date",children:"Fecha"}),p.jsx("option",{value:"entity_link",children:"Vnculo Entidad"}),p.jsx("option",{value:"image",children:"Imagen URL"})]})]}),p.jsx("div",{className:"flex items-center",children:p.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-3 bg-white/5 rounded-xl w-full hover:bg-white/10 transition-colors",children:[p.jsx("input",{type:"checkbox",checked:ne.global,onChange:Ue=>de({...ne,global:Ue.target.checked}),className:"accent-primary size-4"}),p.jsx("span",{className:"text-sm font-bold text-white",children:"Es Global?"})]})})]}),p.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[p.jsx("button",{type:"button",onClick:()=>de(null),className:"px-4 py-2 text-text-muted hover:text-white font-bold transition-colors",children:"Cancelar"}),p.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded-xl font-bold shadow-lg shadow-primary/20 hover:scale-105 transition-transform",children:"Guardar"})]})]})]})}),p.jsx(nv,{isOpen:!!oe,onClose:()=>fe(null),onConfirm:be,title:"Eliminar Plantilla",message:"Ests seguro de que quieres eliminar esta plantilla? Esta accin no se puede deshacer.",confirmText:"Eliminar",type:"danger"})]})};var P1={exports:{}},M1,Yk;function s8(){if(Yk)return M1;Yk=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return M1=t,M1}var A1,Xk;function o8(){if(Xk)return A1;Xk=1;var t=s8();function e(){}function r(){}return r.resetWarningCache=e,A1=function(){function n(s,o,l,u,c,f){if(f!==t){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}n.isRequired=n;function i(){return n}var a={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},A1}var Qk;function l8(){return Qk||(Qk=1,P1.exports=o8()()),P1.exports}var u8=l8();const c8=Wh(u8);function m2(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function d8(t){if(Array.isArray(t))return t}function h8(t){if(Array.isArray(t))return m2(t)}function Nd(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f8(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b4(n.key),n)}}function Td(t,e,r){return e&&f8(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function As(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=C_(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,o=!1;return{s:function(){r=r.call(t)},n:function(){var l=r.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{s||r.return==null||r.return()}finally{if(o)throw a}}}}function x4(t,e,r){return(e=b4(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p8(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function m8(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(c){u=!0,i=c}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return o}}function g8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yi(t,e){return d8(t)||m8(t,e)||C_(t,e)||g8()}function ry(t){return h8(t)||p8(t)||C_(t)||v8()}function y8(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function b4(t){var e=y8(t,"string");return typeof e=="symbol"?e:e+""}function Mi(t){"@babel/helpers - typeof";return Mi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mi(t)}function C_(t,e){if(t){if(typeof t=="string")return m2(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m2(t,e):void 0}}var Ti=typeof window>"u"?null:window,Jk=Ti?Ti.navigator:null;Ti&&Ti.document;var x8=Mi(""),w4=Mi({}),b8=Mi(function(){}),w8=typeof HTMLElement>"u"?"undefined":Mi(HTMLElement),iv=function(e){return e&&e.instanceString&&Bn(e.instanceString)?e.instanceString():null},Ot=function(e){return e!=null&&Mi(e)==x8},Bn=function(e){return e!=null&&Mi(e)===b8},tn=function(e){return!Ys(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},_r=function(e){return e!=null&&Mi(e)===w4&&!tn(e)&&e.constructor===Object},_8=function(e){return e!=null&&Mi(e)===w4},dt=function(e){return e!=null&&Mi(e)===Mi(1)&&!isNaN(e)},S8=function(e){return dt(e)&&Math.floor(e)===e},ny=function(e){if(w8!=="undefined")return e!=null&&e instanceof HTMLElement},Ys=function(e){return av(e)||_4(e)},av=function(e){return iv(e)==="collection"&&e._private.single},_4=function(e){return iv(e)==="collection"&&!e._private.single},E_=function(e){return iv(e)==="core"},S4=function(e){return iv(e)==="stylesheet"},k8=function(e){return iv(e)==="event"},yd=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},C8=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},E8=function(e){return _r(e)&&dt(e.x1)&&dt(e.x2)&&dt(e.y1)&&dt(e.y2)},N8=function(e){return _8(e)&&Bn(e.then)},T8=function(){return Jk&&Jk.userAgent.match(/msie|trident|edge/i)},up=function(e,r){r||(r=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var a=[],s=0;s<arguments.length;s++)a.push(arguments[s]);return a.join("$")});var n=function(){var a=this,s=arguments,o,l=r.apply(a,s),u=n.cache;return(o=u[l])||(o=u[l]=e.apply(a,s)),o};return n.cache={},n},N_=up(function(t){return t.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),dx=up(function(t){return t.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),k4=up(function(t,e){return t+e[0].toUpperCase()+e.substring(1)},function(t,e){return t+"$"+e}),eC=function(e){return yd(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},nd=function(e,r){return e.slice(-1*r.length)===r},Pi="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",P8="rgb[a]?\\(("+Pi+"[%]?)\\s*,\\s*("+Pi+"[%]?)\\s*,\\s*("+Pi+"[%]?)(?:\\s*,\\s*("+Pi+"))?\\)",M8="rgb[a]?\\((?:"+Pi+"[%]?)\\s*,\\s*(?:"+Pi+"[%]?)\\s*,\\s*(?:"+Pi+"[%]?)(?:\\s*,\\s*(?:"+Pi+"))?\\)",A8="hsl[a]?\\(("+Pi+")\\s*,\\s*("+Pi+"[%])\\s*,\\s*("+Pi+"[%])(?:\\s*,\\s*("+Pi+"))?\\)",j8="hsl[a]?\\((?:"+Pi+")\\s*,\\s*(?:"+Pi+"[%])\\s*,\\s*(?:"+Pi+"[%])(?:\\s*,\\s*(?:"+Pi+"))?\\)",R8="\\#[0-9a-fA-F]{3}",L8="\\#[0-9a-fA-F]{6}",C4=function(e,r){return e<r?-1:e>r?1:0},O8=function(e,r){return-1*C4(e,r)},Ut=Object.assign!=null?Object.assign.bind(Object):function(t){for(var e=arguments,r=1;r<e.length;r++){var n=e[r];if(n!=null)for(var i=Object.keys(n),a=0;a<i.length;a++){var s=i[a];t[s]=n[s]}}return t},D8=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var r=e.length===4,n,i,a,s=16;return r?(n=parseInt(e[1]+e[1],s),i=parseInt(e[2]+e[2],s),a=parseInt(e[3]+e[3],s)):(n=parseInt(e[1]+e[2],s),i=parseInt(e[3]+e[4],s),a=parseInt(e[5]+e[6],s)),[n,i,a]}},I8=function(e){var r,n,i,a,s,o,l,u;function c(x,_,S){return S<0&&(S+=1),S>1&&(S-=1),S<1/6?x+(_-x)*6*S:S<1/2?_:S<2/3?x+(_-x)*(2/3-S)*6:x}var f=new RegExp("^"+A8+"$").exec(e);if(f){if(n=parseInt(f[1]),n<0?n=(360- -1*n%360)%360:n>360&&(n=n%360),n/=360,i=parseFloat(f[2]),i<0||i>100||(i=i/100,a=parseFloat(f[3]),a<0||a>100)||(a=a/100,s=f[4],s!==void 0&&(s=parseFloat(s),s<0||s>1)))return;if(i===0)o=l=u=Math.round(a*255);else{var g=a<.5?a*(1+i):a+i-a*i,v=2*a-g;o=Math.round(255*c(v,g,n+1/3)),l=Math.round(255*c(v,g,n)),u=Math.round(255*c(v,g,n-1/3))}r=[o,l,u,s]}return r},B8=function(e){var r,n=new RegExp("^"+P8+"$").exec(e);if(n){r=[];for(var i=[],a=1;a<=3;a++){var s=n[a];if(s[s.length-1]==="%"&&(i[a]=!0),s=parseFloat(s),i[a]&&(s=s/100*255),s<0||s>255)return;r.push(Math.floor(s))}var o=i[1]||i[2]||i[3],l=i[1]&&i[2]&&i[3];if(o&&!l)return;var u=n[4];if(u!==void 0){if(u=parseFloat(u),u<0||u>1)return;r.push(u)}}return r},z8=function(e){return F8[e.toLowerCase()]},E4=function(e){return(tn(e)?e:null)||z8(e)||D8(e)||B8(e)||I8(e)},F8={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},N4=function(e){for(var r=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var s=n[a];if(_r(s))throw Error("Tried to set map with object key");a<n.length-1?(r[s]==null&&(r[s]={}),r=r[s]):r[s]=e.value}},T4=function(e){for(var r=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var s=n[a];if(_r(s))throw Error("Tried to get map with object key");if(r=r[s],r==null)return r}return r},t0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var j1,tC;function ov(){if(tC)return j1;tC=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return j1=t,j1}var R1,rC;function V8(){if(rC)return R1;rC=1;var t=typeof t0=="object"&&t0&&t0.Object===Object&&t0;return R1=t,R1}var L1,nC;function hx(){if(nC)return L1;nC=1;var t=V8(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return L1=r,L1}var O1,iC;function U8(){if(iC)return O1;iC=1;var t=hx(),e=function(){return t.Date.now()};return O1=e,O1}var D1,aC;function H8(){if(aC)return D1;aC=1;var t=/\s/;function e(r){for(var n=r.length;n--&&t.test(r.charAt(n)););return n}return D1=e,D1}var I1,sC;function G8(){if(sC)return I1;sC=1;var t=H8(),e=/^\s+/;function r(n){return n&&n.slice(0,t(n)+1).replace(e,"")}return I1=r,I1}var B1,oC;function T_(){if(oC)return B1;oC=1;var t=hx(),e=t.Symbol;return B1=e,B1}var z1,lC;function q8(){if(lC)return z1;lC=1;var t=T_(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function a(s){var o=r.call(s,i),l=s[i];try{s[i]=void 0;var u=!0}catch{}var c=n.call(s);return u&&(o?s[i]=l:delete s[i]),c}return z1=a,z1}var F1,uC;function W8(){if(uC)return F1;uC=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return F1=r,F1}var V1,cC;function P4(){if(cC)return V1;cC=1;var t=T_(),e=q8(),r=W8(),n="[object Null]",i="[object Undefined]",a=t?t.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):r(o)}return V1=s,V1}var U1,dC;function $8(){if(dC)return U1;dC=1;function t(e){return e!=null&&typeof e=="object"}return U1=t,U1}var H1,hC;function lv(){if(hC)return H1;hC=1;var t=P4(),e=$8(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return H1=n,H1}var G1,fC;function K8(){if(fC)return G1;fC=1;var t=G8(),e=ov(),r=lv(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(u){if(typeof u=="number")return u;if(r(u))return n;if(e(u)){var c=typeof u.valueOf=="function"?u.valueOf():u;u=e(c)?c+"":c}if(typeof u!="string")return u===0?u:+u;u=t(u);var f=a.test(u);return f||s.test(u)?o(u.slice(2),f?2:8):i.test(u)?n:+u}return G1=l,G1}var q1,pC;function Z8(){if(pC)return q1;pC=1;var t=ov(),e=U8(),r=K8(),n="Expected a function",i=Math.max,a=Math.min;function s(o,l,u){var c,f,g,v,x,_,S=0,N=!1,k=!1,E=!0;if(typeof o!="function")throw new TypeError(n);l=r(l)||0,t(u)&&(N=!!u.leading,k="maxWait"in u,g=k?i(r(u.maxWait)||0,l):g,E="trailing"in u?!!u.trailing:E);function T(O){var W=c,F=f;return c=f=void 0,S=O,v=o.apply(F,W),v}function R(O){return S=O,x=setTimeout(B,l),N?T(O):v}function j(O){var W=O-_,F=O-S,K=l-W;return k?a(K,g-F):K}function D(O){var W=O-_,F=O-S;return _===void 0||W>=l||W<0||k&&F>=g}function B(){var O=e();if(D(O))return I(O);x=setTimeout(B,j(O))}function I(O){return x=void 0,E&&c?T(O):(c=f=void 0,v)}function V(){x!==void 0&&clearTimeout(x),S=0,c=_=f=x=void 0}function $(){return x===void 0?v:I(e())}function Z(){var O=e(),W=D(O);if(c=arguments,f=this,_=O,W){if(x===void 0)return R(_);if(k)return clearTimeout(x),x=setTimeout(B,l),T(_)}return x===void 0&&(x=setTimeout(B,l)),v}return Z.cancel=V,Z.flush=$,Z}return q1=s,q1}var Y8=Z8(),uv=sv(Y8),W1=Ti?Ti.performance:null,M4=W1&&W1.now?function(){return W1.now()}:function(){return Date.now()},X8=(function(){if(Ti){if(Ti.requestAnimationFrame)return function(t){Ti.requestAnimationFrame(t)};if(Ti.mozRequestAnimationFrame)return function(t){Ti.mozRequestAnimationFrame(t)};if(Ti.webkitRequestAnimationFrame)return function(t){Ti.webkitRequestAnimationFrame(t)};if(Ti.msRequestAnimationFrame)return function(t){Ti.msRequestAnimationFrame(t)}}return function(t){t&&setTimeout(function(){t(M4())},1e3/60)}})(),iy=function(e){return X8(e)},qu=M4,yh=9261,A4=65599,Gf=5381,j4=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yh,n=r,i;i=e.next(),!i.done;)n=n*A4+i.value|0;return n},jg=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yh;return r*A4+e|0},Rg=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gf;return(r<<5)+r+e|0},Q8=function(e,r){return e*2097152+r},Gc=function(e){return e[0]*2097152+e[1]},r0=function(e,r){return[jg(e[0],r[0]),Rg(e[1],r[1])]},mC=function(e,r){var n={value:0,done:!1},i=0,a=e.length,s={next:function(){return i<a?n.value=e[i++]:n.done=!0,n}};return j4(s,r)},Lh=function(e,r){var n={value:0,done:!1},i=0,a=e.length,s={next:function(){return i<a?n.value=e.charCodeAt(i++):n.done=!0,n}};return j4(s,r)},R4=function(){return J8(arguments)},J8=function(e){for(var r,n=0;n<e.length;n++){var i=e[n];n===0?r=Lh(i):r=Lh(i,r)}return r};function eO(t,e,r,n,i){var a=i*Math.PI/180,s=Math.cos(a)*(t-r)-Math.sin(a)*(e-n)+r,o=Math.sin(a)*(t-r)+Math.cos(a)*(e-n)+n;return{x:s,y:o}}var tO=function(e,r,n,i,a,s){return{x:(e-n)*a+n,y:(r-i)*s+i}};function rO(t,e,r){if(r===0)return t;var n=(e.x1+e.x2)/2,i=(e.y1+e.y2)/2,a=e.w/e.h,s=1/a,o=eO(t.x,t.y,n,i,r),l=tO(o.x,o.y,n,i,a,s);return{x:l.x,y:l.y}}var gC=!0,nO=console.warn!=null,iO=console.trace!=null,P_=Number.MAX_SAFE_INTEGER||9007199254740991,L4=function(){return!0},ay=function(){return!1},vC=function(){return 0},M_=function(){},jn=function(e){throw new Error(e)},O4=function(e){if(e!==void 0)gC=!!e;else return gC},Br=function(e){O4()&&(nO?console.warn(e):(console.log(e),iO&&console.trace()))},aO=function(e){return Ut({},e)},Xl=function(e){return e==null?e:tn(e)?e.slice():_r(e)?aO(e):e},sO=function(e){return e.slice()},D4=function(e,r){for(r=e="";e++<36;r+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return r},oO={},I4=function(){return oO},Ca=function(e){var r=Object.keys(e);return function(n){for(var i={},a=0;a<r.length;a++){var s=r[a],o=n?.[s];i[s]=o===void 0?e[s]:o}return i}},xd=function(e,r,n){for(var i=e.length-1;i>=0;i--)e[i]===r&&e.splice(i,1)},A_=function(e){e.splice(0,e.length)},lO=function(e,r){for(var n=0;n<r.length;n++){var i=r[n];e.push(i)}},Ts=function(e,r,n){return n&&(r=k4(n,r)),e[r]},Fu=function(e,r,n,i){n&&(r=k4(n,r)),e[r]=i},uO=(function(){function t(){Nd(this,t),this._obj={}}return Td(t,[{key:"set",value:function(r,n){return this._obj[r]=n,this}},{key:"delete",value:function(r){return this._obj[r]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(r){return this._obj[r]!==void 0}},{key:"get",value:function(r){return this._obj[r]}}])})(),Vu=typeof Map<"u"?Map:uO,cO="undefined",dO=(function(){function t(e){if(Nd(this,t),this._obj=Object.create(null),this.size=0,e!=null){var r;e.instanceString!=null&&e.instanceString()===this.instanceString()?r=e.toArray():r=e;for(var n=0;n<r.length;n++)this.add(r[n])}}return Td(t,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(r){var n=this._obj;n[r]!==1&&(n[r]=1,this.size++)}},{key:"delete",value:function(r){var n=this._obj;n[r]===1&&(n[r]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(r){return this._obj[r]===1}},{key:"toArray",value:function(){var r=this;return Object.keys(this._obj).filter(function(n){return r.has(n)})}},{key:"forEach",value:function(r,n){return this.toArray().forEach(r,n)}}])})(),Ep=(typeof Set>"u"?"undefined":Mi(Set))!==cO?Set:dO,fx=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||r===void 0||!E_(e)){jn("An element must have a core reference and parameters set");return}var i=r.group;if(i==null&&(r.data&&r.data.source!=null&&r.data.target!=null?i="edges":i="nodes"),i!=="nodes"&&i!=="edges"){jn("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1,this[0]=this;var a=this._private={cy:e,single:!0,data:r.data||{},position:r.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!r.selected,selectable:r.selectable===void 0?!0:!!r.selectable,locked:!!r.locked,grabbed:!1,grabbable:r.grabbable===void 0?!0:!!r.grabbable,pannable:r.pannable===void 0?i==="edges":!!r.pannable,active:!1,classes:new Ep,animation:{current:[],queue:[]},rscratch:{},scratch:r.scratch||{},edges:[],children:[],parent:r.parent&&r.parent.isNode()?r.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(a.position.x==null&&(a.position.x=0),a.position.y==null&&(a.position.y=0),r.renderedPosition){var s=r.renderedPosition,o=e.pan(),l=e.zoom();a.position={x:(s.x-o.x)/l,y:(s.y-o.y)/l}}var u=[];tn(r.classes)?u=r.classes:Ot(r.classes)&&(u=r.classes.split(/\s+/));for(var c=0,f=u.length;c<f;c++){var g=u[c];!g||g===""||a.classes.add(g)}this.createEmitter(),(n===void 0||n)&&this.restore();var v=r.style||r.css;v&&(Br("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(v))},yC=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(n,i,a){var s;_r(n)&&!Ys(n)&&(s=n,n=s.roots||s.root,i=s.visit,a=s.directed),a=arguments.length===2&&!Bn(i)?i:a,i=Bn(i)?i:function(){};for(var o=this._private.cy,l=n=Ot(n)?this.filter(n):n,u=[],c=[],f={},g={},v={},x=0,_,S=this.byGroup(),N=S.nodes,k=S.edges,E=0;E<l.length;E++){var T=l[E],R=T.id();T.isNode()&&(u.unshift(T),e.bfs&&(v[R]=!0,c.push(T)),g[R]=0)}for(var j=function(){var O=e.bfs?u.shift():u.pop(),W=O.id();if(e.dfs){if(v[W])return 0;v[W]=!0,c.push(O)}var F=g[W],K=f[W],X=K!=null?K.source():null,Q=K!=null?K.target():null,ae=K==null?void 0:O.same(X)?Q[0]:X[0],re;if(re=i(O,K,ae,x++,F),re===!0)return _=O,1;if(re===!1)return 1;for(var G=O.connectedEdges().filter(function(ye){return(!a||ye.source().same(O))&&k.has(ye)}),te=0;te<G.length;te++){var ne=G[te],de=ne.connectedNodes().filter(function(ye){return!ye.same(O)&&N.has(ye)}),me=de.id();de.length!==0&&!v[me]&&(de=de[0],u.push(de),e.bfs&&(v[me]=!0,c.push(de)),f[me]=ne,g[me]=g[W]+1)}},D;u.length!==0&&(D=j(),!(D!==0&&D===1)););for(var B=o.collection(),I=0;I<c.length;I++){var V=c[I],$=f[V.id()];$!=null&&B.push($),B.push(V)}return{path:o.collection(B),found:o.collection(_)}}},Lg={breadthFirstSearch:yC({bfs:!0}),depthFirstSearch:yC({dfs:!0})};Lg.bfs=Lg.breadthFirstSearch;Lg.dfs=Lg.depthFirstSearch;var O0={exports:{}},hO=O0.exports,xC;function fO(){return xC||(xC=1,(function(t,e){(function(){var r,n,i,a,s,o,l,u,c,f,g,v,x,_,S;i=Math.floor,f=Math.min,n=function(N,k){return N<k?-1:N>k?1:0},c=function(N,k,E,T,R){var j;if(E==null&&(E=0),R==null&&(R=n),E<0)throw new Error("lo must be non-negative");for(T==null&&(T=N.length);E<T;)j=i((E+T)/2),R(k,N[j])<0?T=j:E=j+1;return[].splice.apply(N,[E,E-E].concat(k)),k},o=function(N,k,E){return E==null&&(E=n),N.push(k),_(N,0,N.length-1,E)},s=function(N,k){var E,T;return k==null&&(k=n),E=N.pop(),N.length?(T=N[0],N[0]=E,S(N,0,k)):T=E,T},u=function(N,k,E){var T;return E==null&&(E=n),T=N[0],N[0]=k,S(N,0,E),T},l=function(N,k,E){var T;return E==null&&(E=n),N.length&&E(N[0],k)<0&&(T=[N[0],k],k=T[0],N[0]=T[1],S(N,0,E)),k},a=function(N,k){var E,T,R,j,D,B;for(k==null&&(k=n),j=(function(){B=[];for(var I=0,V=i(N.length/2);0<=V?I<V:I>V;0<=V?I++:I--)B.push(I);return B}).apply(this).reverse(),D=[],T=0,R=j.length;T<R;T++)E=j[T],D.push(S(N,E,k));return D},x=function(N,k,E){var T;if(E==null&&(E=n),T=N.indexOf(k),T!==-1)return _(N,0,T,E),S(N,T,E)},g=function(N,k,E){var T,R,j,D,B;if(E==null&&(E=n),R=N.slice(0,k),!R.length)return R;for(a(R,E),B=N.slice(k),j=0,D=B.length;j<D;j++)T=B[j],l(R,T,E);return R.sort(E).reverse()},v=function(N,k,E){var T,R,j,D,B,I,V,$,Z;if(E==null&&(E=n),k*10<=N.length){if(j=N.slice(0,k).sort(E),!j.length)return j;for(R=j[j.length-1],V=N.slice(k),D=0,I=V.length;D<I;D++)T=V[D],E(T,R)<0&&(c(j,T,0,null,E),j.pop(),R=j[j.length-1]);return j}for(a(N,E),Z=[],B=0,$=f(k,N.length);0<=$?B<$:B>$;0<=$?++B:--B)Z.push(s(N,E));return Z},_=function(N,k,E,T){var R,j,D;for(T==null&&(T=n),R=N[E];E>k;){if(D=E-1>>1,j=N[D],T(R,j)<0){N[E]=j,E=D;continue}break}return N[E]=R},S=function(N,k,E){var T,R,j,D,B;for(E==null&&(E=n),R=N.length,B=k,j=N[k],T=2*k+1;T<R;)D=T+1,D<R&&!(E(N[T],N[D])<0)&&(T=D),N[k]=N[T],k=T,T=2*k+1;return N[k]=j,_(N,B,k,E)},r=(function(){N.push=o,N.pop=s,N.replace=u,N.pushpop=l,N.heapify=a,N.updateItem=x,N.nlargest=g,N.nsmallest=v;function N(k){this.cmp=k??n,this.nodes=[]}return N.prototype.push=function(k){return o(this.nodes,k,this.cmp)},N.prototype.pop=function(){return s(this.nodes,this.cmp)},N.prototype.peek=function(){return this.nodes[0]},N.prototype.contains=function(k){return this.nodes.indexOf(k)!==-1},N.prototype.replace=function(k){return u(this.nodes,k,this.cmp)},N.prototype.pushpop=function(k){return l(this.nodes,k,this.cmp)},N.prototype.heapify=function(){return a(this.nodes,this.cmp)},N.prototype.updateItem=function(k){return x(this.nodes,k,this.cmp)},N.prototype.clear=function(){return this.nodes=[]},N.prototype.empty=function(){return this.nodes.length===0},N.prototype.size=function(){return this.nodes.length},N.prototype.clone=function(){var k;return k=new N,k.nodes=this.nodes.slice(0),k},N.prototype.toArray=function(){return this.nodes.slice(0)},N.prototype.insert=N.prototype.push,N.prototype.top=N.prototype.peek,N.prototype.front=N.prototype.peek,N.prototype.has=N.prototype.contains,N.prototype.copy=N.prototype.clone,N})(),(function(N,k){return t.exports=k()})(this,function(){return r})}).call(hO)})(O0)),O0.exports}var $1,bC;function pO(){return bC||(bC=1,$1=fO()),$1}var mO=pO(),cv=sv(mO),gO=Ca({root:null,weight:function(e){return 1},directed:!1}),vO={dijkstra:function(e){if(!_r(e)){var r=arguments;e={root:r[0],weight:r[1],directed:r[2]}}var n=gO(e),i=n.root,a=n.weight,s=n.directed,o=this,l=a,u=Ot(i)?this.filter(i)[0]:i[0],c={},f={},g={},v=this.byGroup(),x=v.nodes,_=v.edges;_.unmergeBy(function(F){return F.isLoop()});for(var S=function(K){return c[K.id()]},N=function(K,X){c[K.id()]=X,k.updateItem(K)},k=new cv(function(F,K){return S(F)-S(K)}),E=0;E<x.length;E++){var T=x[E];c[T.id()]=T.same(u)?0:1/0,k.push(T)}for(var R=function(K,X){for(var Q=(s?K.edgesTo(X):K.edgesWith(X)).intersect(_),ae=1/0,re,G=0;G<Q.length;G++){var te=Q[G],ne=l(te);(ne<ae||!re)&&(ae=ne,re=te)}return{edge:re,dist:ae}};k.size()>0;){var j=k.pop(),D=S(j),B=j.id();if(g[B]=D,D!==1/0)for(var I=j.neighborhood().intersect(x),V=0;V<I.length;V++){var $=I[V],Z=$.id(),O=R(j,$),W=D+O.dist;W<S($)&&(N($,W),f[Z]={node:j,edge:O.edge})}}return{distanceTo:function(K){var X=Ot(K)?x.filter(K)[0]:K[0];return g[X.id()]},pathTo:function(K){var X=Ot(K)?x.filter(K)[0]:K[0],Q=[],ae=X,re=ae.id();if(X.length>0)for(Q.unshift(X);f[re];){var G=f[re];Q.unshift(G.edge),Q.unshift(G.node),ae=G.node,re=ae.id()}return o.spawn(Q)}}}},yO={kruskal:function(e){e=e||function(E){return 1};for(var r=this.byGroup(),n=r.nodes,i=r.edges,a=n.length,s=new Array(a),o=n,l=function(T){for(var R=0;R<s.length;R++){var j=s[R];if(j.has(T))return R}},u=0;u<a;u++)s[u]=this.spawn(n[u]);for(var c=i.sort(function(E,T){return e(E)-e(T)}),f=0;f<c.length;f++){var g=c[f],v=g.source()[0],x=g.target()[0],_=l(v),S=l(x),N=s[_],k=s[S];_!==S&&(o.merge(g),N.merge(k),s.splice(S,1))}return o}},xO=Ca({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),bO={aStar:function(e){var r=this.cy(),n=xO(e),i=n.root,a=n.goal,s=n.heuristic,o=n.directed,l=n.weight;i=r.collection(i)[0],a=r.collection(a)[0];var u=i.id(),c=a.id(),f={},g={},v={},x=new cv(function(re,G){return g[re.id()]-g[G.id()]}),_=new Ep,S={},N={},k=function(G,te){x.push(G),_.add(te)},E,T,R=function(){E=x.pop(),T=E.id(),_.delete(T)},j=function(G){return _.has(G)};k(i,u),f[u]=0,g[u]=s(i);for(var D=0;x.size()>0;){if(R(),D++,T===c){for(var B=[],I=a,V=c,$=N[V];B.unshift(I),$!=null&&B.unshift($),I=S[V],I!=null;)V=I.id(),$=N[V];return{found:!0,distance:f[T],path:this.spawn(B),steps:D}}v[T]=!0;for(var Z=E._private.edges,O=0;O<Z.length;O++){var W=Z[O];if(this.hasElementWithId(W.id())&&!(o&&W.data("source")!==T)){var F=W.source(),K=W.target(),X=F.id()!==T?F:K,Q=X.id();if(this.hasElementWithId(Q)&&!v[Q]){var ae=f[T]+l(W);if(!j(Q)){f[Q]=ae,g[Q]=ae+s(X),k(X,Q),S[Q]=E,N[Q]=W;continue}ae<f[Q]&&(f[Q]=ae,g[Q]=ae+s(X),S[Q]=E,N[Q]=W)}}}}return{found:!1,distance:void 0,path:void 0,steps:D}}},wO=Ca({weight:function(e){return 1},directed:!1}),_O={floydWarshall:function(e){for(var r=this.cy(),n=wO(e),i=n.weight,a=n.directed,s=i,o=this.byGroup(),l=o.nodes,u=o.edges,c=l.length,f=c*c,g=function(ne){return l.indexOf(ne)},v=function(ne){return l[ne]},x=new Array(f),_=0;_<f;_++){var S=_%c,N=(_-S)/c;N===S?x[_]=0:x[_]=1/0}for(var k=new Array(f),E=new Array(f),T=0;T<u.length;T++){var R=u[T],j=R.source()[0],D=R.target()[0];if(j!==D){var B=g(j),I=g(D),V=B*c+I,$=s(R);if(x[V]>$&&(x[V]=$,k[V]=I,E[V]=R),!a){var Z=I*c+B;!a&&x[Z]>$&&(x[Z]=$,k[Z]=B,E[Z]=R)}}}for(var O=0;O<c;O++)for(var W=0;W<c;W++)for(var F=W*c+O,K=0;K<c;K++){var X=W*c+K,Q=O*c+K;x[F]+x[Q]<x[X]&&(x[X]=x[F]+x[Q],k[X]=k[F])}var ae=function(ne){return(Ot(ne)?r.filter(ne):ne)[0]},re=function(ne){return g(ae(ne))},G={distance:function(ne,de){var me=re(ne),ye=re(de);return x[me*c+ye]},path:function(ne,de){var me=re(ne),ye=re(de),ie=v(me);if(me===ye)return ie.collection();if(k[me*c+ye]==null)return r.collection();var pe=r.collection(),oe=me,fe;for(pe.merge(ie);me!==ye;)oe=me,me=k[me*c+ye],fe=E[oe*c+me],pe.merge(fe),pe.merge(v(me));return pe}};return G}},SO=Ca({weight:function(e){return 1},directed:!1,root:null}),kO={bellmanFord:function(e){var r=this,n=SO(e),i=n.weight,a=n.directed,s=n.root,o=i,l=this,u=this.cy(),c=this.byGroup(),f=c.edges,g=c.nodes,v=g.length,x=new Vu,_=!1,S=[];s=u.collection(s)[0],f.unmergeBy(function(Ve){return Ve.isLoop()});for(var N=f.length,k=function(Je){var ft=x.get(Je.id());return ft||(ft={},x.set(Je.id(),ft)),ft},E=function(Je){return(Ot(Je)?u.$(Je):Je)[0]},T=function(Je){return k(E(Je)).dist},R=function(Je){for(var ft=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,We=E(Je),Ce=[],ze=We;;){if(ze==null)return r.spawn();var Ke=k(ze),et=Ke.edge,ht=Ke.pred;if(Ce.unshift(ze[0]),ze.same(ft)&&Ce.length>0)break;et!=null&&Ce.unshift(et),ze=ht}return l.spawn(Ce)},j=0;j<v;j++){var D=g[j],B=k(D);D.same(s)?B.dist=0:B.dist=1/0,B.pred=null,B.edge=null}for(var I=!1,V=function(Je,ft,We,Ce,ze,Ke){var et=Ce.dist+Ke;et<ze.dist&&!We.same(Ce.edge)&&(ze.dist=et,ze.pred=Je,ze.edge=We,I=!0)},$=1;$<v;$++){I=!1;for(var Z=0;Z<N;Z++){var O=f[Z],W=O.source(),F=O.target(),K=o(O),X=k(W),Q=k(F);V(W,F,O,X,Q,K),a||V(F,W,O,Q,X,K)}if(!I)break}if(I)for(var ae=[],re=0;re<N;re++){var G=f[re],te=G.source(),ne=G.target(),de=o(G),me=k(te).dist,ye=k(ne).dist;if(me+de<ye||!a&&ye+de<me)if(_||(Br("Graph contains a negative weight cycle for Bellman-Ford"),_=!0),e.findNegativeWeightCycles!==!1){var ie=[];me+de<ye&&ie.push(te),!a&&ye+de<me&&ie.push(ne);for(var pe=ie.length,oe=0;oe<pe;oe++){var fe=ie[oe],ge=[fe];ge.push(k(fe).edge);for(var be=k(fe).pred;ge.indexOf(be)===-1;)ge.push(be),ge.push(k(be).edge),be=k(be).pred;ge=ge.slice(ge.indexOf(be));for(var _e=ge[0].id(),De=0,qe=2;qe<ge.length;qe+=2)ge[qe].id()<_e&&(_e=ge[qe].id(),De=qe);ge=ge.slice(De).concat(ge.slice(0,De)),ge.push(ge[0]);var Ue=ge.map(function(Ve){return Ve.id()}).join(",");ae.indexOf(Ue)===-1&&(S.push(l.spawn(ge)),ae.push(Ue))}}else break}return{distanceTo:T,pathTo:R,hasNegativeWeightCycle:_,negativeWeightCycles:S}}},CO=Math.sqrt(2),EO=function(e,r,n){n.length===0&&jn("Karger-Stein must be run on a connected (sub)graph");for(var i=n[e],a=i[1],s=i[2],o=r[a],l=r[s],u=n,c=u.length-1;c>=0;c--){var f=u[c],g=f[1],v=f[2];(r[g]===o&&r[v]===l||r[g]===l&&r[v]===o)&&u.splice(c,1)}for(var x=0;x<u.length;x++){var _=u[x];_[1]===l?(u[x]=_.slice(),u[x][1]=o):_[2]===l&&(u[x]=_.slice(),u[x][2]=o)}for(var S=0;S<r.length;S++)r[S]===l&&(r[S]=o);return u},K1=function(e,r,n,i){for(;n>i;){var a=Math.floor(Math.random()*r.length);r=EO(a,e,r),n--}return r},NO={kargerStein:function(){var e=this,r=this.byGroup(),n=r.nodes,i=r.edges;i.unmergeBy(function(Q){return Q.isLoop()});var a=n.length,s=i.length,o=Math.ceil(Math.pow(Math.log(a)/Math.LN2,2)),l=Math.floor(a/CO);if(a<2){jn("At least 2 nodes are required for Karger-Stein algorithm");return}for(var u=[],c=0;c<s;c++){var f=i[c];u.push([c,n.indexOf(f.source()),n.indexOf(f.target())])}for(var g=1/0,v=[],x=new Array(a),_=new Array(a),S=new Array(a),N=function(ae,re){for(var G=0;G<a;G++)re[G]=ae[G]},k=0;k<=o;k++){for(var E=0;E<a;E++)_[E]=E;var T=K1(_,u.slice(),a,l),R=T.slice();N(_,S);var j=K1(_,T,l,2),D=K1(S,R,l,2);j.length<=D.length&&j.length<g?(g=j.length,v=j,N(_,x)):D.length<=j.length&&D.length<g&&(g=D.length,v=D,N(S,x))}for(var B=this.spawn(v.map(function(Q){return i[Q[0]]})),I=this.spawn(),V=this.spawn(),$=x[0],Z=0;Z<x.length;Z++){var O=x[Z],W=n[Z];O===$?I.merge(W):V.merge(W)}var F=function(ae){var re=e.spawn();return ae.forEach(function(G){re.merge(G),G.connectedEdges().forEach(function(te){e.contains(te)&&!B.contains(te)&&re.merge(te)})}),re},K=[F(I),F(V)],X={cut:B,components:K,partition1:I,partition2:V};return X}},Z1,TO=function(e){return{x:e.x,y:e.y}},px=function(e,r,n){return{x:e.x*r+n.x,y:e.y*r+n.y}},B4=function(e,r,n){return{x:(e.x-n.x)/r,y:(e.y-n.y)/r}},Xf=function(e){return{x:e[0],y:e[1]}},PO=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=1/0,a=r;a<n;a++){var s=e[a];isFinite(s)&&(i=Math.min(s,i))}return i},MO=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=-1/0,a=r;a<n;a++){var s=e[a];isFinite(s)&&(i=Math.max(s,i))}return i},AO=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=0,a=0,s=r;s<n;s++){var o=e[s];isFinite(o)&&(i+=o,a++)}return i/a},jO=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;i?e=e.slice(r,n):(n<e.length&&e.splice(n,e.length-n),r>0&&e.splice(0,r));for(var o=0,l=e.length-1;l>=0;l--){var u=e[l];s?isFinite(u)||(e[l]=-1/0,o++):e.splice(l,1)}a&&e.sort(function(g,v){return g-v});var c=e.length,f=Math.floor(c/2);return c%2!==0?e[f+1+o]:(e[f-1+o]+e[f+o])/2},RO=function(e){return Math.PI*e/180},n0=function(e,r){return Math.atan2(r,e)-Math.PI/2},j_=Math.log2||function(t){return Math.log(t)/Math.log(2)},R_=function(e){return e>0?1:e<0?-1:0},Oh=function(e,r){return Math.sqrt(mh(e,r))},mh=function(e,r){var n=r.x-e.x,i=r.y-e.y;return n*n+i*i},LO=function(e){for(var r=e.length,n=0,i=0;i<r;i++)n+=e[i];for(var a=0;a<r;a++)e[a]=e[a]/n;return e},Wi=function(e,r,n,i){return(1-i)*(1-i)*e+2*(1-i)*i*r+i*i*n},rp=function(e,r,n,i){return{x:Wi(e.x,r.x,n.x,i),y:Wi(e.y,r.y,n.y,i)}},OO=function(e,r,n,i){var a={x:r.x-e.x,y:r.y-e.y},s=Oh(e,r),o={x:a.x/s,y:a.y/s};return n=n??0,i=i??n*s,{x:e.x+o.x*i,y:e.y+o.y*i}},Og=function(e,r,n){return Math.max(e,Math.min(n,r))},ls=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},DO=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},IO=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},BO=function(e,r){e.x1=Math.min(e.x1,r.x1),e.x2=Math.max(e.x2,r.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,r.y1),e.y2=Math.max(e.y2,r.y2),e.h=e.y2-e.y1},z4=function(e,r,n){e.x1=Math.min(e.x1,r),e.x2=Math.max(e.x2,r),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},D0=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=r,e.x2+=r,e.y1-=r,e.y2+=r,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},I0=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],n,i,a,s;if(r.length===1)n=i=a=s=r[0];else if(r.length===2)n=a=r[0],s=i=r[1];else if(r.length===4){var o=yi(r,4);n=o[0],i=o[1],a=o[2],s=o[3]}return e.x1-=s,e.x2+=i,e.y1-=n,e.y2+=a,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},wC=function(e,r){e.x1=r.x1,e.y1=r.y1,e.x2=r.x2,e.y2=r.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},L_=function(e,r){return!(e.x1>r.x2||r.x1>e.x2||e.x2<r.x1||r.x2<e.x1||e.y2<r.y1||r.y2<e.y1||e.y1>r.y2||r.y1>e.y2)},ad=function(e,r,n){return e.x1<=r&&r<=e.x2&&e.y1<=n&&n<=e.y2},_C=function(e,r){return ad(e,r.x,r.y)},F4=function(e,r){return ad(e,r.x1,r.y1)&&ad(e,r.x2,r.y2)},zO=(Z1=Math.hypot)!==null&&Z1!==void 0?Z1:function(t,e){return Math.sqrt(t*t+e*e)};function FO(t,e){if(t.length<3)throw new Error("Need at least 3 vertices");var r=function(B,I){return{x:B.x+I.x,y:B.y+I.y}},n=function(B,I){return{x:B.x-I.x,y:B.y-I.y}},i=function(B,I){return{x:B.x*I,y:B.y*I}},a=function(B,I){return B.x*I.y-B.y*I.x},s=function(B){var I=zO(B.x,B.y);return I===0?{x:0,y:0}:{x:B.x/I,y:B.y/I}},o=function(B){for(var I=0,V=0;V<B.length;V++){var $=B[V],Z=B[(V+1)%B.length];I+=$.x*Z.y-Z.x*$.y}return I/2},l=function(B,I,V,$){var Z=n(I,B),O=n($,V),W=a(Z,O);if(Math.abs(W)<1e-9)return r(B,i(Z,.5));var F=a(n(V,B),O)/W;return r(B,i(Z,F))},u=t.map(function(D){return{x:D.x,y:D.y}});o(u)<0&&u.reverse();for(var c=u.length,f=[],g=0;g<c;g++){var v=u[g],x=u[(g+1)%c],_=n(x,v),S=s({x:_.y,y:-_.x});f.push(S)}for(var N=f.map(function(D,B){var I=r(u[B],i(D,e)),V=r(u[(B+1)%c],i(D,e));return{p1:I,p2:V}}),k=[],E=0;E<c;E++){var T=N[(E-1+c)%c],R=N[E],j=l(T.p1,T.p2,R.p1,R.p2);k.push(j)}return k}function VO(t,e,r,n,i,a){var s=YO(t,e,r,n,i),o=FO(s,a),l=ls();return o.forEach(function(u){return z4(l,u.x,u.y)}),l}var V4=function(e,r,n,i,a,s,o){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",u=l==="auto"?bd(a,s):l,c=a/2,f=s/2;u=Math.min(u,c,f);var g=u!==c,v=u!==f,x;if(g){var _=n-c+u-o,S=i-f-o,N=n+c-u+o,k=S;if(x=sd(e,r,n,i,_,S,N,k,!1),x.length>0)return x}if(v){var E=n+c+o,T=i-f+u-o,R=E,j=i+f-u+o;if(x=sd(e,r,n,i,E,T,R,j,!1),x.length>0)return x}if(g){var D=n-c+u-o,B=i+f+o,I=n+c-u+o,V=B;if(x=sd(e,r,n,i,D,B,I,V,!1),x.length>0)return x}if(v){var $=n-c-o,Z=i-f+u-o,O=$,W=i+f-u+o;if(x=sd(e,r,n,i,$,Z,O,W,!1),x.length>0)return x}var F;{var K=n-c+u,X=i-f+u;if(F=ag(e,r,n,i,K,X,u+o),F.length>0&&F[0]<=K&&F[1]<=X)return[F[0],F[1]]}{var Q=n+c-u,ae=i-f+u;if(F=ag(e,r,n,i,Q,ae,u+o),F.length>0&&F[0]>=Q&&F[1]<=ae)return[F[0],F[1]]}{var re=n+c-u,G=i+f-u;if(F=ag(e,r,n,i,re,G,u+o),F.length>0&&F[0]>=re&&F[1]>=G)return[F[0],F[1]]}{var te=n-c+u,ne=i+f-u;if(F=ag(e,r,n,i,te,ne,u+o),F.length>0&&F[0]<=te&&F[1]>=ne)return[F[0],F[1]]}return[]},UO=function(e,r,n,i,a,s,o){var l=o,u=Math.min(n,a),c=Math.max(n,a),f=Math.min(i,s),g=Math.max(i,s);return u-l<=e&&e<=c+l&&f-l<=r&&r<=g+l},HO=function(e,r,n,i,a,s,o,l,u){var c={x1:Math.min(n,o,a)-u,x2:Math.max(n,o,a)+u,y1:Math.min(i,l,s)-u,y2:Math.max(i,l,s)+u};return!(e<c.x1||e>c.x2||r<c.y1||r>c.y2)},GO=function(e,r,n,i){n-=i;var a=r*r-4*e*n;if(a<0)return[];var s=Math.sqrt(a),o=2*e,l=(-r+s)/o,u=(-r-s)/o;return[l,u]},qO=function(e,r,n,i,a){var s=1e-5;e===0&&(e=s),r/=e,n/=e,i/=e;var o,l,u,c,f,g,v,x;if(l=(3*n-r*r)/9,u=-(27*i)+r*(9*n-2*(r*r)),u/=54,o=l*l*l+u*u,a[1]=0,v=r/3,o>0){f=u+Math.sqrt(o),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),g=u-Math.sqrt(o),g=g<0?-Math.pow(-g,1/3):Math.pow(g,1/3),a[0]=-v+f+g,v+=(f+g)/2,a[4]=a[2]=-v,v=Math.sqrt(3)*(-g+f)/2,a[3]=v,a[5]=-v;return}if(a[5]=a[3]=0,o===0){x=u<0?-Math.pow(-u,1/3):Math.pow(u,1/3),a[0]=-v+2*x,a[4]=a[2]=-(x+v);return}l=-l,c=l*l*l,c=Math.acos(u/Math.sqrt(c)),x=2*Math.sqrt(l),a[0]=-v+x*Math.cos(c/3),a[2]=-v+x*Math.cos((c+2*Math.PI)/3),a[4]=-v+x*Math.cos((c+4*Math.PI)/3)},WO=function(e,r,n,i,a,s,o,l){var u=1*n*n-4*n*a+2*n*o+4*a*a-4*a*o+o*o+i*i-4*i*s+2*i*l+4*s*s-4*s*l+l*l,c=9*n*a-3*n*n-3*n*o-6*a*a+3*a*o+9*i*s-3*i*i-3*i*l-6*s*s+3*s*l,f=3*n*n-6*n*a+n*o-n*e+2*a*a+2*a*e-o*e+3*i*i-6*i*s+i*l-i*r+2*s*s+2*s*r-l*r,g=1*n*a-n*n+n*e-a*e+i*s-i*i+i*r-s*r,v=[];qO(u,c,f,g,v);for(var x=1e-7,_=[],S=0;S<6;S+=2)Math.abs(v[S+1])<x&&v[S]>=0&&v[S]<=1&&_.push(v[S]);_.push(1),_.push(0);for(var N=-1,k,E,T,R=0;R<_.length;R++)k=Math.pow(1-_[R],2)*n+2*(1-_[R])*_[R]*a+_[R]*_[R]*o,E=Math.pow(1-_[R],2)*i+2*(1-_[R])*_[R]*s+_[R]*_[R]*l,T=Math.pow(k-e,2)+Math.pow(E-r,2),N>=0?T<N&&(N=T):N=T;return N},$O=function(e,r,n,i,a,s){var o=[e-n,r-i],l=[a-n,s-i],u=l[0]*l[0]+l[1]*l[1],c=o[0]*o[0]+o[1]*o[1],f=o[0]*l[0]+o[1]*l[1],g=f*f/u;return f<0?c:g>u?(e-a)*(e-a)+(r-s)*(r-s):c-g},Ps=function(e,r,n){for(var i,a,s,o,l,u=0,c=0;c<n.length/2;c++)if(i=n[c*2],a=n[c*2+1],c+1<n.length/2?(s=n[(c+1)*2],o=n[(c+1)*2+1]):(s=n[(c+1-n.length/2)*2],o=n[(c+1-n.length/2)*2+1]),!(i==e&&s==e))if(i>=e&&e>=s||i<=e&&e<=s)l=(e-i)/(s-i)*(o-a)+a,l>r&&u++;else continue;return u%2!==0},Wu=function(e,r,n,i,a,s,o,l,u){var c=new Array(n.length),f;l[0]!=null?(f=Math.atan(l[1]/l[0]),l[0]<0?f=f+Math.PI/2:f=-f-Math.PI/2):f=l;for(var g=Math.cos(-f),v=Math.sin(-f),x=0;x<c.length/2;x++)c[x*2]=s/2*(n[x*2]*g-n[x*2+1]*v),c[x*2+1]=o/2*(n[x*2+1]*g+n[x*2]*v),c[x*2]+=i,c[x*2+1]+=a;var _;if(u>0){var S=oy(c,-u);_=sy(S)}else _=c;return Ps(e,r,_)},KO=function(e,r,n,i,a,s,o,l){for(var u=new Array(n.length*2),c=0;c<l.length;c++){var f=l[c];u[c*4+0]=f.startX,u[c*4+1]=f.startY,u[c*4+2]=f.stopX,u[c*4+3]=f.stopY;var g=Math.pow(f.cx-e,2)+Math.pow(f.cy-r,2);if(g<=Math.pow(f.radius,2))return!0}return Ps(e,r,u)},sy=function(e){for(var r=new Array(e.length/2),n,i,a,s,o,l,u,c,f=0;f<e.length/4;f++){n=e[f*4],i=e[f*4+1],a=e[f*4+2],s=e[f*4+3],f<e.length/4-1?(o=e[(f+1)*4],l=e[(f+1)*4+1],u=e[(f+1)*4+2],c=e[(f+1)*4+3]):(o=e[0],l=e[1],u=e[2],c=e[3]);var g=sd(n,i,a,s,o,l,u,c,!0);r[f*2]=g[0],r[f*2+1]=g[1]}return r},oy=function(e,r){for(var n=new Array(e.length*2),i,a,s,o,l=0;l<e.length/2;l++){i=e[l*2],a=e[l*2+1],l<e.length/2-1?(s=e[(l+1)*2],o=e[(l+1)*2+1]):(s=e[0],o=e[1]);var u=o-a,c=-(s-i),f=Math.sqrt(u*u+c*c),g=u/f,v=c/f;n[l*4]=i+g*r,n[l*4+1]=a+v*r,n[l*4+2]=s+g*r,n[l*4+3]=o+v*r}return n},ZO=function(e,r,n,i,a,s){var o=n-e,l=i-r;o/=a,l/=s;var u=Math.sqrt(o*o+l*l),c=u-1;if(c<0)return[];var f=c/u;return[(n-e)*f+e,(i-r)*f+r]},wh=function(e,r,n,i,a,s,o){return e-=a,r-=s,e/=n/2+o,r/=i/2+o,e*e+r*r<=1},ag=function(e,r,n,i,a,s,o){var l=[n-e,i-r],u=[e-a,r-s],c=l[0]*l[0]+l[1]*l[1],f=2*(u[0]*l[0]+u[1]*l[1]),g=u[0]*u[0]+u[1]*u[1]-o*o,v=f*f-4*c*g;if(v<0)return[];var x=(-f+Math.sqrt(v))/(2*c),_=(-f-Math.sqrt(v))/(2*c),S=Math.min(x,_),N=Math.max(x,_),k=[];if(S>=0&&S<=1&&k.push(S),N>=0&&N<=1&&k.push(N),k.length===0)return[];var E=k[0]*l[0]+e,T=k[0]*l[1]+r;if(k.length>1){if(k[0]==k[1])return[E,T];var R=k[1]*l[0]+e,j=k[1]*l[1]+r;return[E,T,R,j]}else return[E,T]},Y1=function(e,r,n){return r<=e&&e<=n||n<=e&&e<=r?e:e<=r&&r<=n||n<=r&&r<=e?r:n},sd=function(e,r,n,i,a,s,o,l,u){var c=e-a,f=n-e,g=o-a,v=r-s,x=i-r,_=l-s,S=g*v-_*c,N=f*v-x*c,k=_*f-g*x;if(k!==0){var E=S/k,T=N/k,R=.001,j=0-R,D=1+R;return j<=E&&E<=D&&j<=T&&T<=D?[e+E*f,r+E*x]:u?[e+E*f,r+E*x]:[]}else return S===0||N===0?Y1(e,n,o)===o?[o,l]:Y1(e,n,a)===a?[a,s]:Y1(a,o,n)===n?[n,i]:[]:[]},YO=function(e,r,n,i,a){var s=[],o=i/2,l=a/2,u=r,c=n;s.push({x:u+o*e[0],y:c+l*e[1]});for(var f=1;f<e.length/2;f++)s.push({x:u+o*e[f*2],y:c+l*e[f*2+1]});return s},Dg=function(e,r,n,i,a,s,o,l){var u=[],c,f=new Array(n.length),g=!0;s==null&&(g=!1);var v;if(g){for(var x=0;x<f.length/2;x++)f[x*2]=n[x*2]*s+i,f[x*2+1]=n[x*2+1]*o+a;if(l>0){var _=oy(f,-l);v=sy(_)}else v=f}else v=n;for(var S,N,k,E,T=0;T<v.length/2;T++)S=v[T*2],N=v[T*2+1],T<v.length/2-1?(k=v[(T+1)*2],E=v[(T+1)*2+1]):(k=v[0],E=v[1]),c=sd(e,r,i,a,S,N,k,E),c.length!==0&&u.push(c[0],c[1]);return u},XO=function(e,r,n,i,a,s,o,l,u){var c=[],f,g=new Array(n.length*2);u.forEach(function(k,E){E===0?(g[g.length-2]=k.startX,g[g.length-1]=k.startY):(g[E*4-2]=k.startX,g[E*4-1]=k.startY),g[E*4]=k.stopX,g[E*4+1]=k.stopY,f=ag(e,r,i,a,k.cx,k.cy,k.radius),f.length!==0&&c.push(f[0],f[1])});for(var v=0;v<g.length/4;v++)f=sd(e,r,i,a,g[v*4],g[v*4+1],g[v*4+2],g[v*4+3],!1),f.length!==0&&c.push(f[0],f[1]);if(c.length>2){for(var x=[c[0],c[1]],_=Math.pow(x[0]-e,2)+Math.pow(x[1]-r,2),S=1;S<c.length/2;S++){var N=Math.pow(c[S*2]-e,2)+Math.pow(c[S*2+1]-r,2);N<=_&&(x[0]=c[S*2],x[1]=c[S*2+1],_=N)}return x}return c},i0=function(e,r,n){var i=[e[0]-r[0],e[1]-r[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=(a-n)/a;return s<0&&(s=1e-5),[r[0]+s*i[0],r[1]+s*i[1]]},ss=function(e,r){var n=g2(e,r);return n=U4(n),n},U4=function(e){for(var r,n,i=e.length/2,a=1/0,s=1/0,o=-1/0,l=-1/0,u=0;u<i;u++)r=e[2*u],n=e[2*u+1],a=Math.min(a,r),o=Math.max(o,r),s=Math.min(s,n),l=Math.max(l,n);for(var c=2/(o-a),f=2/(l-s),g=0;g<i;g++)r=e[2*g]=e[2*g]*c,n=e[2*g+1]=e[2*g+1]*f,a=Math.min(a,r),o=Math.max(o,r),s=Math.min(s,n),l=Math.max(l,n);if(s<-1)for(var v=0;v<i;v++)n=e[2*v+1]=e[2*v+1]+(-1-s);return e},g2=function(e,r){var n=1/e*2*Math.PI,i=e%2===0?Math.PI/2+n/2:Math.PI/2;i+=r;for(var a=new Array(e*2),s,o=0;o<e;o++)s=o*n+i,a[2*o]=Math.cos(s),a[2*o+1]=Math.sin(-s);return a},bd=function(e,r){return Math.min(e/4,r/4,8)},H4=function(e,r){return Math.min(e/10,r/10,8)},O_=function(){return 8},QO=function(e,r,n){return[e-2*r+n,2*(r-e),e]},v2=function(e,r){return{heightOffset:Math.min(15,.05*r),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};function X1(t,e){function r(f){for(var g=[],v=0;v<f.length;v++){var x=f[v],_=f[(v+1)%f.length],S={x:_.x-x.x,y:_.y-x.y},N={x:-S.y,y:S.x},k=Math.sqrt(N.x*N.x+N.y*N.y);g.push({x:N.x/k,y:N.y/k})}return g}function n(f,g){var v=1/0,x=-1/0,_=As(f),S;try{for(_.s();!(S=_.n()).done;){var N=S.value,k=N.x*g.x+N.y*g.y;v=Math.min(v,k),x=Math.max(x,k)}}catch(E){_.e(E)}finally{_.f()}return{min:v,max:x}}function i(f,g){return!(f.max<g.min||g.max<f.min)}var a=[].concat(ry(r(t)),ry(r(e))),s=As(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,u=n(t,l),c=n(e,l);if(!i(u,c))return!1}}catch(f){s.e(f)}finally{s.f()}return!0}var JO=Ca({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),eD={pageRank:function(e){for(var r=JO(e),n=r.dampingFactor,i=r.precision,a=r.iterations,s=r.weight,o=this._private.cy,l=this.byGroup(),u=l.nodes,c=l.edges,f=u.length,g=f*f,v=c.length,x=new Array(g),_=new Array(f),S=(1-n)/f,N=0;N<f;N++){for(var k=0;k<f;k++){var E=N*f+k;x[E]=0}_[N]=0}for(var T=0;T<v;T++){var R=c[T],j=R.data("source"),D=R.data("target");if(j!==D){var B=u.indexOfId(j),I=u.indexOfId(D),V=s(R),$=I*f+B;x[$]+=V,_[B]+=V}}for(var Z=1/f+S,O=0;O<f;O++)if(_[O]===0)for(var W=0;W<f;W++){var F=W*f+O;x[F]=Z}else for(var K=0;K<f;K++){var X=K*f+O;x[X]=x[X]/_[O]+S}for(var Q=new Array(f),ae=new Array(f),re,G=0;G<f;G++)Q[G]=1;for(var te=0;te<a;te++){for(var ne=0;ne<f;ne++)ae[ne]=0;for(var de=0;de<f;de++)for(var me=0;me<f;me++){var ye=de*f+me;ae[de]+=x[ye]*Q[me]}LO(ae),re=Q,Q=ae,ae=re;for(var ie=0,pe=0;pe<f;pe++){var oe=re[pe]-Q[pe];ie+=oe*oe}if(ie<i)break}var fe={rank:function(be){return be=o.collection(be)[0],Q[u.indexOf(be)]}};return fe}},SC=Ca({root:null,weight:function(e){return 1},directed:!1,alpha:0}),np={degreeCentralityNormalized:function(e){e=SC(e);var r=this.cy(),n=this.nodes(),i=n.length;if(e.directed){for(var c={},f={},g=0,v=0,x=0;x<i;x++){var _=n[x],S=_.id();e.root=_;var N=this.degreeCentrality(e);g<N.indegree&&(g=N.indegree),v<N.outdegree&&(v=N.outdegree),c[S]=N.indegree,f[S]=N.outdegree}return{indegree:function(E){return g==0?0:(Ot(E)&&(E=r.filter(E)),c[E.id()]/g)},outdegree:function(E){return v===0?0:(Ot(E)&&(E=r.filter(E)),f[E.id()]/v)}}}else{for(var a={},s=0,o=0;o<i;o++){var l=n[o];e.root=l;var u=this.degreeCentrality(e);s<u.degree&&(s=u.degree),a[l.id()]=u.degree}return{degree:function(E){return s===0?0:(Ot(E)&&(E=r.filter(E)),a[E.id()]/s)}}}},degreeCentrality:function(e){e=SC(e);var r=this.cy(),n=this,i=e,a=i.root,s=i.weight,o=i.directed,l=i.alpha;if(a=r.collection(a)[0],o){for(var v=a.connectedEdges(),x=v.filter(function(j){return j.target().same(a)&&n.has(j)}),_=v.filter(function(j){return j.source().same(a)&&n.has(j)}),S=x.length,N=_.length,k=0,E=0,T=0;T<x.length;T++)k+=s(x[T]);for(var R=0;R<_.length;R++)E+=s(_[R]);return{indegree:Math.pow(S,1-l)*Math.pow(k,l),outdegree:Math.pow(N,1-l)*Math.pow(E,l)}}else{for(var u=a.connectedEdges().intersection(n),c=u.length,f=0,g=0;g<u.length;g++)f+=s(u[g]);return{degree:Math.pow(c,1-l)*Math.pow(f,l)}}}};np.dc=np.degreeCentrality;np.dcn=np.degreeCentralityNormalised=np.degreeCentralityNormalized;var kC=Ca({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),ip={closenessCentralityNormalized:function(e){for(var r=kC(e),n=r.harmonic,i=r.weight,a=r.directed,s=this.cy(),o={},l=0,u=this.nodes(),c=this.floydWarshall({weight:i,directed:a}),f=0;f<u.length;f++){for(var g=0,v=u[f],x=0;x<u.length;x++)if(f!==x){var _=c.distance(v,u[x]);n?g+=1/_:g+=_}n||(g=1/g),l<g&&(l=g),o[v.id()]=g}return{closeness:function(N){return l==0?0:(Ot(N)?N=s.filter(N)[0].id():N=N.id(),o[N]/l)}}},closenessCentrality:function(e){var r=kC(e),n=r.root,i=r.weight,a=r.directed,s=r.harmonic;n=this.filter(n)[0];for(var o=this.dijkstra({root:n,weight:i,directed:a}),l=0,u=this.nodes(),c=0;c<u.length;c++){var f=u[c];if(!f.same(n)){var g=o.distanceTo(f);s?l+=1/g:l+=g}}return s?l:1/l}};ip.cc=ip.closenessCentrality;ip.ccn=ip.closenessCentralityNormalised=ip.closenessCentralityNormalized;var tD=Ca({weight:null,directed:!1}),y2={betweennessCentrality:function(e){for(var r=tD(e),n=r.directed,i=r.weight,a=i!=null,s=this.cy(),o=this.nodes(),l={},u={},c=0,f={set:function(E,T){u[E]=T,T>c&&(c=T)},get:function(E){return u[E]}},g=0;g<o.length;g++){var v=o[g],x=v.id();n?l[x]=v.outgoers().nodes():l[x]=v.openNeighborhood().nodes(),f.set(x,0)}for(var _=function(){for(var E=o[S].id(),T=[],R={},j={},D={},B=new cv(function(de,me){return D[de]-D[me]}),I=0;I<o.length;I++){var V=o[I].id();R[V]=[],j[V]=0,D[V]=1/0}for(j[E]=1,D[E]=0,B.push(E);!B.empty();){var $=B.pop();if(T.push($),a)for(var Z=0;Z<l[$].length;Z++){var O=l[$][Z],W=s.getElementById($),F=void 0;W.edgesTo(O).length>0?F=W.edgesTo(O)[0]:F=O.edgesTo(W)[0];var K=i(F);O=O.id(),D[O]>D[$]+K&&(D[O]=D[$]+K,B.nodes.indexOf(O)<0?B.push(O):B.updateItem(O),j[O]=0,R[O]=[]),D[O]==D[$]+K&&(j[O]=j[O]+j[$],R[O].push($))}else for(var X=0;X<l[$].length;X++){var Q=l[$][X].id();D[Q]==1/0&&(B.push(Q),D[Q]=D[$]+1),D[Q]==D[$]+1&&(j[Q]=j[Q]+j[$],R[Q].push($))}}for(var ae={},re=0;re<o.length;re++)ae[o[re].id()]=0;for(;T.length>0;){for(var G=T.pop(),te=0;te<R[G].length;te++){var ne=R[G][te];ae[ne]=ae[ne]+j[ne]/j[G]*(1+ae[G])}G!=o[S].id()&&f.set(G,f.get(G)+ae[G])}},S=0;S<o.length;S++)_();var N={betweenness:function(E){var T=s.collection(E).id();return f.get(T)},betweennessNormalized:function(E){if(c==0)return 0;var T=s.collection(E).id();return f.get(T)/c}};return N.betweennessNormalised=N.betweennessNormalized,N}};y2.bc=y2.betweennessCentrality;var rD=Ca({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(t){return 1}]}),nD=function(e){return rD(e)},iD=function(e,r){for(var n=0,i=0;i<r.length;i++)n+=r[i](e);return n},aD=function(e,r,n){for(var i=0;i<r;i++)e[i*r+i]=n},G4=function(e,r){for(var n,i=0;i<r;i++){n=0;for(var a=0;a<r;a++)n+=e[a*r+i];for(var s=0;s<r;s++)e[s*r+i]=e[s*r+i]/n}},sD=function(e,r,n){for(var i=new Array(n*n),a=0;a<n;a++){for(var s=0;s<n;s++)i[a*n+s]=0;for(var o=0;o<n;o++)for(var l=0;l<n;l++)i[a*n+l]+=e[a*n+o]*r[o*n+l]}return i},oD=function(e,r,n){for(var i=e.slice(0),a=1;a<n;a++)e=sD(e,i,r);return e},lD=function(e,r,n){for(var i=new Array(r*r),a=0;a<r*r;a++)i[a]=Math.pow(e[a],n);return G4(i,r),i},uD=function(e,r,n,i){for(var a=0;a<n;a++){var s=Math.round(e[a]*Math.pow(10,i))/Math.pow(10,i),o=Math.round(r[a]*Math.pow(10,i))/Math.pow(10,i);if(s!==o)return!1}return!0},cD=function(e,r,n,i){for(var a=[],s=0;s<r;s++){for(var o=[],l=0;l<r;l++)Math.round(e[s*r+l]*1e3)/1e3>0&&o.push(n[l]);o.length!==0&&a.push(i.collection(o))}return a},dD=function(e,r){for(var n=0;n<e.length;n++)if(!r[n]||e[n].id()!==r[n].id())return!1;return!0},hD=function(e){for(var r=0;r<e.length;r++)for(var n=0;n<e.length;n++)r!=n&&dD(e[r],e[n])&&e.splice(n,1);return e},CC=function(e){for(var r=this.nodes(),n=this.edges(),i=this.cy(),a=nD(e),s={},o=0;o<r.length;o++)s[r[o].id()]=o;for(var l=r.length,u=l*l,c=new Array(u),f,g=0;g<u;g++)c[g]=0;for(var v=0;v<n.length;v++){var x=n[v],_=s[x.source().id()],S=s[x.target().id()],N=iD(x,a.attributes);c[_*l+S]+=N,c[S*l+_]+=N}aD(c,l,a.multFactor),G4(c,l);for(var k=!0,E=0;k&&E<a.maxIterations;)k=!1,f=oD(c,l,a.expandFactor),c=lD(f,l,a.inflateFactor),uD(c,f,u,4)||(k=!0),E++;var T=cD(c,l,r,i);return T=hD(T),T},fD={markovClustering:CC,mcl:CC},pD=function(e){return e},q4=function(e,r){return Math.abs(r-e)},EC=function(e,r,n){return e+q4(r,n)},NC=function(e,r,n){return e+Math.pow(n-r,2)},mD=function(e){return Math.sqrt(e)},gD=function(e,r,n){return Math.max(e,q4(r,n))},nm=function(e,r,n,i,a){for(var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:pD,o=i,l,u,c=0;c<e;c++)l=r(c),u=n(c),o=a(o,l,u);return s(o)},cp={euclidean:function(e,r,n){return e>=2?nm(e,r,n,0,NC,mD):nm(e,r,n,0,EC)},squaredEuclidean:function(e,r,n){return nm(e,r,n,0,NC)},manhattan:function(e,r,n){return nm(e,r,n,0,EC)},max:function(e,r,n){return nm(e,r,n,-1/0,gD)}};cp["squared-euclidean"]=cp.squaredEuclidean;cp.squaredeuclidean=cp.squaredEuclidean;function mx(t,e,r,n,i,a){var s;return Bn(t)?s=t:s=cp[t]||cp.euclidean,e===0&&Bn(t)?s(i,a):s(e,r,n,i,a)}var vD=Ca({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),D_=function(e){return vD(e)},ly=function(e,r,n,i,a){var s=a!=="kMedoids",o=s?function(f){return n[f]}:function(f){return i[f](n)},l=function(g){return i[g](r)},u=n,c=r;return mx(e,i.length,o,l,u,c)},Q1=function(e,r,n){for(var i=n.length,a=new Array(i),s=new Array(i),o=new Array(r),l=null,u=0;u<i;u++)a[u]=e.min(n[u]).value,s[u]=e.max(n[u]).value;for(var c=0;c<r;c++){l=[];for(var f=0;f<i;f++)l[f]=Math.random()*(s[f]-a[f])+a[f];o[c]=l}return o},W4=function(e,r,n,i,a){for(var s=1/0,o=0,l=0;l<r.length;l++){var u=ly(n,e,r[l],i,a);u<s&&(s=u,o=l)}return o},$4=function(e,r,n){for(var i=[],a=null,s=0;s<r.length;s++)a=r[s],n[a.id()]===e&&i.push(a);return i},yD=function(e,r,n){return Math.abs(r-e)<=n},xD=function(e,r,n){for(var i=0;i<e.length;i++)for(var a=0;a<e[i].length;a++){var s=Math.abs(e[i][a]-r[i][a]);if(s>n)return!1}return!0},bD=function(e,r,n){for(var i=0;i<n;i++)if(e===r[i])return!0;return!1},TC=function(e,r){var n=new Array(r);if(e.length<50)for(var i=0;i<r;i++){for(var a=e[Math.floor(Math.random()*e.length)];bD(a,n,i);)a=e[Math.floor(Math.random()*e.length)];n[i]=a}else for(var s=0;s<r;s++)n[s]=e[Math.floor(Math.random()*e.length)];return n},PC=function(e,r,n){for(var i=0,a=0;a<r.length;a++)i+=ly("manhattan",r[a],e,n,"kMedoids");return i},wD=function(e){var r=this.cy(),n=this.nodes(),i=null,a=D_(e),s=new Array(a.k),o={},l;a.testMode?typeof a.testCentroids=="number"?(a.testCentroids,l=Q1(n,a.k,a.attributes)):Mi(a.testCentroids)==="object"?l=a.testCentroids:l=Q1(n,a.k,a.attributes):l=Q1(n,a.k,a.attributes);for(var u=!0,c=0;u&&c<a.maxIterations;){for(var f=0;f<n.length;f++)i=n[f],o[i.id()]=W4(i,l,a.distance,a.attributes,"kMeans");u=!1;for(var g=0;g<a.k;g++){var v=$4(g,n,o);if(v.length!==0){for(var x=a.attributes.length,_=l[g],S=new Array(x),N=new Array(x),k=0;k<x;k++){N[k]=0;for(var E=0;E<v.length;E++)i=v[E],N[k]+=a.attributes[k](i);S[k]=N[k]/v.length,yD(S[k],_[k],a.sensitivityThreshold)||(u=!0)}l[g]=S,s[g]=r.collection(v)}}c++}return s},_D=function(e){var r=this.cy(),n=this.nodes(),i=null,a=D_(e),s=new Array(a.k),o,l={},u,c=new Array(a.k);a.testMode?typeof a.testCentroids=="number"||(Mi(a.testCentroids)==="object"?o=a.testCentroids:o=TC(n,a.k)):o=TC(n,a.k);for(var f=!0,g=0;f&&g<a.maxIterations;){for(var v=0;v<n.length;v++)i=n[v],l[i.id()]=W4(i,o,a.distance,a.attributes,"kMedoids");f=!1;for(var x=0;x<o.length;x++){var _=$4(x,n,l);if(_.length!==0){c[x]=PC(o[x],_,a.attributes);for(var S=0;S<_.length;S++)u=PC(_[S],_,a.attributes),u<c[x]&&(c[x]=u,o[x]=_[S],f=!0);s[x]=r.collection(_)}}g++}return s},SD=function(e,r,n,i,a){for(var s,o,l=0;l<r.length;l++)for(var u=0;u<e.length;u++)i[l][u]=Math.pow(n[l][u],a.m);for(var c=0;c<e.length;c++)for(var f=0;f<a.attributes.length;f++){s=0,o=0;for(var g=0;g<r.length;g++)s+=i[g][c]*a.attributes[f](r[g]),o+=i[g][c];e[c][f]=s/o}},kD=function(e,r,n,i,a){for(var s=0;s<e.length;s++)r[s]=e[s].slice();for(var o,l,u,c=2/(a.m-1),f=0;f<n.length;f++)for(var g=0;g<i.length;g++){o=0;for(var v=0;v<n.length;v++)l=ly(a.distance,i[g],n[f],a.attributes,"cmeans"),u=ly(a.distance,i[g],n[v],a.attributes,"cmeans"),o+=Math.pow(l/u,c);e[g][f]=1/o}},CD=function(e,r,n,i){for(var a=new Array(n.k),s=0;s<a.length;s++)a[s]=[];for(var o,l,u=0;u<r.length;u++){o=-1/0,l=-1;for(var c=0;c<r[0].length;c++)r[u][c]>o&&(o=r[u][c],l=c);a[l].push(e[u])}for(var f=0;f<a.length;f++)a[f]=i.collection(a[f]);return a},MC=function(e){var r=this.cy(),n=this.nodes(),i=D_(e),a,s,o,l,u;l=new Array(n.length);for(var c=0;c<n.length;c++)l[c]=new Array(i.k);o=new Array(n.length);for(var f=0;f<n.length;f++)o[f]=new Array(i.k);for(var g=0;g<n.length;g++){for(var v=0,x=0;x<i.k;x++)o[g][x]=Math.random(),v+=o[g][x];for(var _=0;_<i.k;_++)o[g][_]=o[g][_]/v}s=new Array(i.k);for(var S=0;S<i.k;S++)s[S]=new Array(i.attributes.length);u=new Array(n.length);for(var N=0;N<n.length;N++)u[N]=new Array(i.k);for(var k=!0,E=0;k&&E<i.maxIterations;)k=!1,SD(s,n,o,u,i),kD(o,l,s,n,i),xD(o,l,i.sensitivityThreshold)||(k=!0),E++;return a=CD(n,o,i,r),{clusters:a,degreeOfMembership:o}},ED={kMeans:wD,kMedoids:_D,fuzzyCMeans:MC,fcm:MC},ND=Ca({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),TD={single:"min",complete:"max"},PD=function(e){var r=ND(e),n=TD[r.linkage];return n!=null&&(r.linkage=n),r},AC=function(e,r,n,i,a){for(var s=0,o=1/0,l,u=a.attributes,c=function(I,V){return mx(a.distance,u.length,function($){return u[$](I)},function($){return u[$](V)},I,V)},f=0;f<e.length;f++){var g=e[f].key,v=n[g][i[g]];v<o&&(s=g,o=v)}if(a.mode==="threshold"&&o>=a.threshold||a.mode==="dendrogram"&&e.length===1)return!1;var x=r[s],_=r[i[s]],S;a.mode==="dendrogram"?S={left:x,right:_,key:x.key}:S={value:x.value.concat(_.value),key:x.key},e[x.index]=S,e.splice(_.index,1),r[x.key]=S;for(var N=0;N<e.length;N++){var k=e[N];x.key===k.key?l=1/0:a.linkage==="min"?(l=n[x.key][k.key],n[x.key][k.key]>n[_.key][k.key]&&(l=n[_.key][k.key])):a.linkage==="max"?(l=n[x.key][k.key],n[x.key][k.key]<n[_.key][k.key]&&(l=n[_.key][k.key])):a.linkage==="mean"?l=(n[x.key][k.key]*x.size+n[_.key][k.key]*_.size)/(x.size+_.size):a.mode==="dendrogram"?l=c(k.value,x.value):l=c(k.value[0],x.value[0]),n[x.key][k.key]=n[k.key][x.key]=l}for(var E=0;E<e.length;E++){var T=e[E].key;if(i[T]===x.key||i[T]===_.key){for(var R=T,j=0;j<e.length;j++){var D=e[j].key;n[T][D]<n[T][R]&&(R=D)}i[T]=R}e[E].index=E}return x.key=_.key=x.index=_.index=null,!0},Qf=function(e,r,n){e&&(e.value?r.push(e.value):(e.left&&Qf(e.left,r),e.right&&Qf(e.right,r)))},x2=function(e,r){if(!e)return"";if(e.left&&e.right){var n=x2(e.left,r),i=x2(e.right,r),a=r.add({group:"nodes",data:{id:n+","+i}});return r.add({group:"edges",data:{source:n,target:a.id()}}),r.add({group:"edges",data:{source:i,target:a.id()}}),a.id()}else if(e.value)return e.value.id()},b2=function(e,r,n){if(!e)return[];var i=[],a=[],s=[];return r===0?(e.left&&Qf(e.left,i),e.right&&Qf(e.right,a),s=i.concat(a),[n.collection(s)]):r===1?e.value?[n.collection(e.value)]:(e.left&&Qf(e.left,i),e.right&&Qf(e.right,a),[n.collection(i),n.collection(a)]):e.value?[n.collection(e.value)]:(e.left&&(i=b2(e.left,r-1,n)),e.right&&(a=b2(e.right,r-1,n)),i.concat(a))},jC=function(e){for(var r=this.cy(),n=this.nodes(),i=PD(e),a=i.attributes,s=function(E,T){return mx(i.distance,a.length,function(R){return a[R](E)},function(R){return a[R](T)},E,T)},o=[],l=[],u=[],c=[],f=0;f<n.length;f++){var g={value:i.mode==="dendrogram"?n[f]:[n[f]],key:f,index:f};o[f]=g,c[f]=g,l[f]=[],u[f]=0}for(var v=0;v<o.length;v++)for(var x=0;x<=v;x++){var _=void 0;i.mode==="dendrogram"?_=v===x?1/0:s(o[v].value,o[x].value):_=v===x?1/0:s(o[v].value[0],o[x].value[0]),l[v][x]=_,l[x][v]=_,_<l[v][u[v]]&&(u[v]=x)}for(var S=AC(o,c,l,u,i);S;)S=AC(o,c,l,u,i);var N;return i.mode==="dendrogram"?(N=b2(o[0],i.dendrogramDepth,r),i.addDendrogram&&x2(o[0],r)):(N=new Array(o.length),o.forEach(function(k,E){k.key=k.index=null,N[E]=r.collection(k.value)})),N},MD={hierarchicalClustering:jC,hca:jC},AD=Ca({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),jD=function(e){var r=e.damping,n=e.preference;.5<=r&&r<1||jn("Damping must range on [0.5, 1).  Got: ".concat(r));var i=["median","mean","min","max"];return i.some(function(a){return a===n})||dt(n)||jn("Preference must be one of [".concat(i.map(function(a){return"'".concat(a,"'")}).join(", "),"] or a number.  Got: ").concat(n)),AD(e)},RD=function(e,r,n,i){var a=function(o,l){return i[l](o)};return-mx(e,i.length,function(s){return a(r,s)},function(s){return a(n,s)},r,n)},LD=function(e,r){var n=null;return r==="median"?n=jO(e):r==="mean"?n=AO(e):r==="min"?n=PO(e):r==="max"?n=MO(e):n=r,n},OD=function(e,r,n){for(var i=[],a=0;a<e;a++)r[a*e+a]+n[a*e+a]>0&&i.push(a);return i},RC=function(e,r,n){for(var i=[],a=0;a<e;a++){for(var s=-1,o=-1/0,l=0;l<n.length;l++){var u=n[l];r[a*e+u]>o&&(s=u,o=r[a*e+u])}s>0&&i.push(s)}for(var c=0;c<n.length;c++)i[n[c]]=n[c];return i},DD=function(e,r,n){for(var i=RC(e,r,n),a=0;a<n.length;a++){for(var s=[],o=0;o<i.length;o++)i[o]===n[a]&&s.push(o);for(var l=-1,u=-1/0,c=0;c<s.length;c++){for(var f=0,g=0;g<s.length;g++)f+=r[s[g]*e+s[c]];f>u&&(l=c,u=f)}n[a]=s[l]}return i=RC(e,r,n),i},LC=function(e){for(var r=this.cy(),n=this.nodes(),i=jD(e),a={},s=0;s<n.length;s++)a[n[s].id()]=s;var o,l,u,c,f,g;o=n.length,l=o*o,u=new Array(l);for(var v=0;v<l;v++)u[v]=-1/0;for(var x=0;x<o;x++)for(var _=0;_<o;_++)x!==_&&(u[x*o+_]=RD(i.distance,n[x],n[_],i.attributes));c=LD(u,i.preference);for(var S=0;S<o;S++)u[S*o+S]=c;f=new Array(l);for(var N=0;N<l;N++)f[N]=0;g=new Array(l);for(var k=0;k<l;k++)g[k]=0;for(var E=new Array(o),T=new Array(o),R=new Array(o),j=0;j<o;j++)E[j]=0,T[j]=0,R[j]=0;for(var D=new Array(o*i.minIterations),B=0;B<D.length;B++)D[B]=0;var I;for(I=0;I<i.maxIterations;I++){for(var V=0;V<o;V++){for(var $=-1/0,Z=-1/0,O=-1,W=0,F=0;F<o;F++)E[F]=f[V*o+F],W=g[V*o+F]+u[V*o+F],W>=$?(Z=$,$=W,O=F):W>Z&&(Z=W);for(var K=0;K<o;K++)f[V*o+K]=(1-i.damping)*(u[V*o+K]-$)+i.damping*E[K];f[V*o+O]=(1-i.damping)*(u[V*o+O]-Z)+i.damping*E[O]}for(var X=0;X<o;X++){for(var Q=0,ae=0;ae<o;ae++)E[ae]=g[ae*o+X],T[ae]=Math.max(0,f[ae*o+X]),Q+=T[ae];Q-=T[X],T[X]=f[X*o+X],Q+=T[X];for(var re=0;re<o;re++)g[re*o+X]=(1-i.damping)*Math.min(0,Q-T[re])+i.damping*E[re];g[X*o+X]=(1-i.damping)*(Q-T[X])+i.damping*E[X]}for(var G=0,te=0;te<o;te++){var ne=g[te*o+te]+f[te*o+te]>0?1:0;D[I%i.minIterations*o+te]=ne,G+=ne}if(G>0&&(I>=i.minIterations-1||I==i.maxIterations-1)){for(var de=0,me=0;me<o;me++){R[me]=0;for(var ye=0;ye<i.minIterations;ye++)R[me]+=D[ye*o+me];(R[me]===0||R[me]===i.minIterations)&&de++}if(de===o)break}}for(var ie=OD(o,f,g),pe=DD(o,u,ie),oe={},fe=0;fe<ie.length;fe++)oe[ie[fe]]=[];for(var ge=0;ge<n.length;ge++){var be=a[n[ge].id()],_e=pe[be];_e!=null&&oe[_e].push(n[ge])}for(var De=new Array(ie.length),qe=0;qe<ie.length;qe++)De[qe]=r.collection(oe[ie[qe]]);return De},ID={affinityPropagation:LC,ap:LC},BD=Ca({root:void 0,directed:!1}),zD={hierholzer:function(e){if(!_r(e)){var r=arguments;e={root:r[0],directed:r[1]}}var n=BD(e),i=n.root,a=n.directed,s=this,o=!1,l,u,c;i&&(c=Ot(i)?this.filter(i)[0].id():i[0].id());var f={},g={};a?s.forEach(function(k){var E=k.id();if(k.isNode()){var T=k.indegree(!0),R=k.outdegree(!0),j=T-R,D=R-T;j==1?l?o=!0:l=E:D==1?u?o=!0:u=E:(D>1||j>1)&&(o=!0),f[E]=[],k.outgoers().forEach(function(B){B.isEdge()&&f[E].push(B.id())})}else g[E]=[void 0,k.target().id()]}):s.forEach(function(k){var E=k.id();if(k.isNode()){var T=k.degree(!0);T%2&&(l?u?o=!0:u=E:l=E),f[E]=[],k.connectedEdges().forEach(function(R){return f[E].push(R.id())})}else g[E]=[k.source().id(),k.target().id()]});var v={found:!1,trail:void 0};if(o)return v;if(u&&l)if(a){if(c&&u!=c)return v;c=u}else{if(c&&u!=c&&l!=c)return v;c||(c=u)}else c||(c=s[0].id());var x=function(E){for(var T=E,R=[E],j,D,B;f[T].length;)j=f[T].shift(),D=g[j][0],B=g[j][1],T!=B?(f[B]=f[B].filter(function(I){return I!=j}),T=B):!a&&T!=D&&(f[D]=f[D].filter(function(I){return I!=j}),T=D),R.unshift(j),R.unshift(T);return R},_=[],S=[];for(S=x(c);S.length!=1;)f[S[0]].length==0?(_.unshift(s.getElementById(S.shift())),_.unshift(s.getElementById(S.shift()))):S=x(S.shift()).concat(S);_.unshift(s.getElementById(S.shift()));for(var N in f)if(f[N].length)return v;return v.found=!0,v.trail=this.spawn(_,!0),v}},a0=function(){var e=this,r={},n=0,i=0,a=[],s=[],o={},l=function(g,v){for(var x=s.length-1,_=[],S=e.spawn();s[x].x!=g||s[x].y!=v;)_.push(s.pop().edge),x--;_.push(s.pop().edge),_.forEach(function(N){var k=N.connectedNodes().intersection(e);S.merge(N),k.forEach(function(E){var T=E.id(),R=E.connectedEdges().intersection(e);S.merge(E),r[T].cutVertex?S.merge(R.filter(function(j){return j.isLoop()})):S.merge(R)})}),a.push(S)},u=function(g,v,x){g===x&&(i+=1),r[v]={id:n,low:n++,cutVertex:!1};var _=e.getElementById(v).connectedEdges().intersection(e);if(_.size()===0)a.push(e.spawn(e.getElementById(v)));else{var S,N,k,E;_.forEach(function(T){S=T.source().id(),N=T.target().id(),k=S===v?N:S,k!==x&&(E=T.id(),o[E]||(o[E]=!0,s.push({x:v,y:k,edge:T})),k in r?r[v].low=Math.min(r[v].low,r[k].id):(u(g,k,v),r[v].low=Math.min(r[v].low,r[k].low),r[v].id<=r[k].low&&(r[v].cutVertex=!0,l(v,k))))})}};e.forEach(function(f){if(f.isNode()){var g=f.id();g in r||(i=0,u(g,g),r[g].cutVertex=i>1)}});var c=Object.keys(r).filter(function(f){return r[f].cutVertex}).map(function(f){return e.getElementById(f)});return{cut:e.spawn(c),components:a}},FD={hopcroftTarjanBiconnected:a0,htbc:a0,htb:a0,hopcroftTarjanBiconnectedComponents:a0},s0=function(){var e=this,r={},n=0,i=[],a=[],s=e.spawn(e),o=function(u){a.push(u),r[u]={index:n,low:n++,explored:!1};var c=e.getElementById(u).connectedEdges().intersection(e);if(c.forEach(function(_){var S=_.target().id();S!==u&&(S in r||o(S),r[S].explored||(r[u].low=Math.min(r[u].low,r[S].low)))}),r[u].index===r[u].low){for(var f=e.spawn();;){var g=a.pop();if(f.merge(e.getElementById(g)),r[g].low=r[u].index,r[g].explored=!0,g===u)break}var v=f.edgesWith(f),x=f.merge(v);i.push(x),s=s.difference(x)}};return e.forEach(function(l){if(l.isNode()){var u=l.id();u in r||o(u)}}),{cut:s,components:i}},VD={tarjanStronglyConnected:s0,tsc:s0,tscc:s0,tarjanStronglyConnectedComponents:s0},K4={};[Lg,vO,yO,bO,_O,kO,NO,eD,np,ip,y2,fD,ED,MD,ID,zD,FD,VD].forEach(function(t){Ut(K4,t)});var Z4=0,Y4=1,X4=2,hl=function(e){if(!(this instanceof hl))return new hl(e);this.id="Thenable/1.0.7",this.state=Z4,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};hl.prototype={fulfill:function(e){return OC(this,Y4,"fulfillValue",e)},reject:function(e){return OC(this,X4,"rejectReason",e)},then:function(e,r){var n=this,i=new hl;return n.onFulfilled.push(IC(e,i,"fulfill")),n.onRejected.push(IC(r,i,"reject")),Q4(n),i.proxy}};var OC=function(e,r,n,i){return e.state===Z4&&(e.state=r,e[n]=i,Q4(e)),e},Q4=function(e){e.state===Y4?DC(e,"onFulfilled",e.fulfillValue):e.state===X4&&DC(e,"onRejected",e.rejectReason)},DC=function(e,r,n){if(e[r].length!==0){var i=e[r];e[r]=[];var a=function(){for(var o=0;o<i.length;o++)i[o](n)};typeof setImmediate=="function"?setImmediate(a):setTimeout(a,0)}},IC=function(e,r,n){return function(i){if(typeof e!="function")r[n].call(r,i);else{var a;try{a=e(i)}catch(s){r.reject(s);return}J4(r,a)}}},J4=function(e,r){if(e===r||e.proxy===r){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(Mi(r)==="object"&&r!==null||typeof r=="function")try{n=r.then}catch(a){e.reject(a);return}if(typeof n=="function"){var i=!1;try{n.call(r,function(a){i||(i=!0,a===r?e.reject(new TypeError("circular thenable chain")):J4(e,a))},function(a){i||(i=!0,e.reject(a))})}catch(a){i||e.reject(a)}return}e.fulfill(r)};hl.all=function(t){return new hl(function(e,r){for(var n=new Array(t.length),i=0,a=function(l,u){n[l]=u,i++,i===t.length&&e(n)},s=0;s<t.length;s++)(function(o){var l=t[o],u=l!=null&&l.then!=null;if(u)l.then(function(f){a(o,f)},function(f){r(f)});else{var c=l;a(o,c)}})(s)})};hl.resolve=function(t){return new hl(function(e,r){e(t)})};hl.reject=function(t){return new hl(function(e,r){r(t)})};var Np=typeof Promise<"u"?Promise:hl,w2=function(e,r,n){var i=E_(e),a=!i,s=this._private=Ut({duration:1e3},r,n);if(s.target=e,s.style=s.style||s.css,s.started=!1,s.playing=!1,s.hooked=!1,s.applying=!1,s.progress=0,s.completes=[],s.frames=[],s.complete&&Bn(s.complete)&&s.completes.push(s.complete),a){var o=e.position();s.startPosition=s.startPosition||{x:o.x,y:o.y},s.startStyle=s.startStyle||e.cy().style().getAnimationStartStyle(e,s.style)}if(i){var l=e.pan();s.startPan={x:l.x,y:l.y},s.startZoom=e.zoom()}this.length=1,this[0]=this},Dh=w2.prototype;Ut(Dh,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var r,n=e.target._private.animation;e.queue?r=n.queue:r=n.current,r.push(this),Ys(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var r=this._private;return e===void 0?r.progress*r.duration:this.progress(e/r.duration)},progress:function(e){var r=this._private,n=r.playing;return e===void 0?r.progress:(n&&this.pause(),r.progress=e,r.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,r=e.playing;r&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(u,c){var f=e[u];f!=null&&(e[u]=e[c],e[c]=f)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var i=0;i<e.style.length;i++){var a=e.style[i],s=a.name,o=e.startStyle[s];e.startStyle[s]=a,e.style[i]=o}return r&&this.play(),this},promise:function(e){var r=this._private,n;switch(e){case"frame":n=r.frames;break;default:case"complete":case"completed":n=r.completes}return new Np(function(i,a){n.push(function(){i()})})}});Dh.complete=Dh.completed;Dh.run=Dh.play;Dh.running=Dh.playing;var UD={animated:function(){return function(){var r=this,n=r.length!==void 0,i=n?r:[r],a=this._private.cy||this;if(!a.styleEnabled())return!1;var s=i[0];if(s)return s._private.animation.current.length>0}},clearQueue:function(){return function(){var r=this,n=r.length!==void 0,i=n?r:[r],a=this._private.cy||this;if(!a.styleEnabled())return this;for(var s=0;s<i.length;s++){var o=i[s];o._private.animation.queue=[]}return this}},delay:function(){return function(r,n){var i=this._private.cy||this;return i.styleEnabled()?this.animate({delay:r,duration:r,complete:n}):this}},delayAnimation:function(){return function(r,n){var i=this._private.cy||this;return i.styleEnabled()?this.animation({delay:r,duration:r,complete:n}):this}},animation:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this,l=!a,u=!l;if(!o.styleEnabled())return this;var c=o.style();r=Ut({},r,n);var f=Object.keys(r).length===0;if(f)return new w2(s[0],r);switch(r.duration===void 0&&(r.duration=400),r.duration){case"slow":r.duration=600;break;case"fast":r.duration=200;break}if(u&&(r.style=c.getPropsList(r.style||r.css),r.css=void 0),u&&r.renderedPosition!=null){var g=r.renderedPosition,v=o.pan(),x=o.zoom();r.position=B4(g,x,v)}if(l&&r.panBy!=null){var _=r.panBy,S=o.pan();r.pan={x:S.x+_.x,y:S.y+_.y}}var N=r.center||r.centre;if(l&&N!=null){var k=o.getCenterPan(N.eles,r.zoom);k!=null&&(r.pan=k)}if(l&&r.fit!=null){var E=r.fit,T=o.getFitViewport(E.eles||E.boundingBox,E.padding);T!=null&&(r.pan=T.pan,r.zoom=T.zoom)}if(l&&_r(r.zoom)){var R=o.getZoomedViewport(r.zoom);R!=null?(R.zoomed&&(r.zoom=R.zoom),R.panned&&(r.pan=R.pan)):r.zoom=null}return new w2(s[0],r)}},animate:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;n&&(r=Ut({},r,n));for(var l=0;l<s.length;l++){var u=s[l],c=u.animated()&&(r.queue===void 0||r.queue),f=u.animation(r,c?{queue:!0}:void 0);f.play()}return this}},stop:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;for(var l=0;l<s.length;l++){for(var u=s[l],c=u._private,f=c.animation.current,g=0;g<f.length;g++){var v=f[g],x=v._private;n&&(x.duration=0)}r&&(c.animation.queue=[]),n||(c.animation.current=[])}return o.notify("draw"),this}}},J1,BC;function gx(){if(BC)return J1;BC=1;var t=Array.isArray;return J1=t,J1}var eb,zC;function HD(){if(zC)return eb;zC=1;var t=gx(),e=lv(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(t(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return eb=i,eb}var tb,FC;function GD(){if(FC)return tb;FC=1;var t=P4(),e=ov(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var l=t(o);return l==n||l==i||l==r||l==a}return tb=s,tb}var rb,VC;function qD(){if(VC)return rb;VC=1;var t=hx(),e=t["__core-js_shared__"];return rb=e,rb}var nb,UC;function WD(){if(UC)return nb;UC=1;var t=qD(),e=(function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!e&&e in n}return nb=r,nb}var ib,HC;function $D(){if(HC)return ib;HC=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return ib=r,ib}var ab,GC;function KD(){if(GC)return ab;GC=1;var t=GD(),e=WD(),r=ov(),n=$D(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,u=o.hasOwnProperty,c=RegExp("^"+l.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(g){if(!r(g)||e(g))return!1;var v=t(g)?c:a;return v.test(n(g))}return ab=f,ab}var sb,qC;function ZD(){if(qC)return sb;qC=1;function t(e,r){return e?.[r]}return sb=t,sb}var ob,WC;function I_(){if(WC)return ob;WC=1;var t=KD(),e=ZD();function r(n,i){var a=e(n,i);return t(a)?a:void 0}return ob=r,ob}var lb,$C;function vx(){if($C)return lb;$C=1;var t=I_(),e=t(Object,"create");return lb=e,lb}var ub,KC;function YD(){if(KC)return ub;KC=1;var t=vx();function e(){this.__data__=t?t(null):{},this.size=0}return ub=e,ub}var cb,ZC;function XD(){if(ZC)return cb;ZC=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return cb=t,cb}var db,YC;function QD(){if(YC)return db;YC=1;var t=vx(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(t){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return db=i,db}var hb,XC;function JD(){if(XC)return hb;XC=1;var t=vx(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var a=this.__data__;return t?a[i]!==void 0:r.call(a,i)}return hb=n,hb}var fb,QC;function eI(){if(QC)return fb;QC=1;var t=vx(),e="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=t&&i===void 0?e:i,this}return fb=r,fb}var pb,JC;function tI(){if(JC)return pb;JC=1;var t=YD(),e=XD(),r=QD(),n=JD(),i=eI();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,pb=a,pb}var mb,eE;function rI(){if(eE)return mb;eE=1;function t(){this.__data__=[],this.size=0}return mb=t,mb}var gb,tE;function eP(){if(tE)return gb;tE=1;function t(e,r){return e===r||e!==e&&r!==r}return gb=t,gb}var vb,rE;function yx(){if(rE)return vb;rE=1;var t=eP();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return vb=e,vb}var yb,nE;function nI(){if(nE)return yb;nE=1;var t=yx(),e=Array.prototype,r=e.splice;function n(i){var a=this.__data__,s=t(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return yb=n,yb}var xb,iE;function iI(){if(iE)return xb;iE=1;var t=yx();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return xb=e,xb}var bb,aE;function aI(){if(aE)return bb;aE=1;var t=yx();function e(r){return t(this.__data__,r)>-1}return bb=e,bb}var wb,sE;function sI(){if(sE)return wb;sE=1;var t=yx();function e(r,n){var i=this.__data__,a=t(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return wb=e,wb}var _b,oE;function oI(){if(oE)return _b;oE=1;var t=rI(),e=nI(),r=iI(),n=aI(),i=sI();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,_b=a,_b}var Sb,lE;function lI(){if(lE)return Sb;lE=1;var t=I_(),e=hx(),r=t(e,"Map");return Sb=r,Sb}var kb,uE;function uI(){if(uE)return kb;uE=1;var t=tI(),e=oI(),r=lI();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return kb=n,kb}var Cb,cE;function cI(){if(cE)return Cb;cE=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return Cb=t,Cb}var Eb,dE;function xx(){if(dE)return Eb;dE=1;var t=cI();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return Eb=e,Eb}var Nb,hE;function dI(){if(hE)return Nb;hE=1;var t=xx();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return Nb=e,Nb}var Tb,fE;function hI(){if(fE)return Tb;fE=1;var t=xx();function e(r){return t(this,r).get(r)}return Tb=e,Tb}var Pb,pE;function fI(){if(pE)return Pb;pE=1;var t=xx();function e(r){return t(this,r).has(r)}return Pb=e,Pb}var Mb,mE;function pI(){if(mE)return Mb;mE=1;var t=xx();function e(r,n){var i=t(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return Mb=e,Mb}var Ab,gE;function mI(){if(gE)return Ab;gE=1;var t=uI(),e=dI(),r=hI(),n=fI(),i=pI();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var u=s[o];this.set(u[0],u[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,Ab=a,Ab}var jb,vE;function gI(){if(vE)return jb;vE=1;var t=mI(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],l=a.cache;if(l.has(o))return l.get(o);var u=n.apply(this,s);return a.cache=l.set(o,u)||l,u};return a.cache=new(r.Cache||t),a}return r.Cache=t,jb=r,jb}var Rb,yE;function vI(){if(yE)return Rb;yE=1;var t=gI(),e=500;function r(n){var i=t(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return Rb=r,Rb}var Lb,xE;function tP(){if(xE)return Lb;xE=1;var t=vI(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,l,u){a.push(l?u.replace(r,"$1"):o||s)}),a});return Lb=n,Lb}var Ob,bE;function rP(){if(bE)return Ob;bE=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=r(e[n],n,e);return a}return Ob=t,Ob}var Db,wE;function yI(){if(wE)return Db;wE=1;var t=T_(),e=rP(),r=gx(),n=lv(),i=t?t.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return Db=s,Db}var Ib,_E;function nP(){if(_E)return Ib;_E=1;var t=yI();function e(r){return r==null?"":t(r)}return Ib=e,Ib}var Bb,SE;function iP(){if(SE)return Bb;SE=1;var t=gx(),e=HD(),r=tP(),n=nP();function i(a,s){return t(a)?a:e(a,s)?[a]:r(n(a))}return Bb=i,Bb}var zb,kE;function B_(){if(kE)return zb;kE=1;var t=lv();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return zb=e,zb}var Fb,CE;function xI(){if(CE)return Fb;CE=1;var t=iP(),e=B_();function r(n,i){i=t(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return Fb=r,Fb}var Vb,EE;function bI(){if(EE)return Vb;EE=1;var t=xI();function e(r,n,i){var a=r==null?void 0:t(r,n);return a===void 0?i:a}return Vb=e,Vb}var wI=bI(),_I=sv(wI),Ub,NE;function SI(){if(NE)return Ub;NE=1;var t=I_(),e=(function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}})();return Ub=e,Ub}var Hb,TE;function kI(){if(TE)return Hb;TE=1;var t=SI();function e(r,n,i){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return Hb=e,Hb}var Gb,PE;function CI(){if(PE)return Gb;PE=1;var t=kI(),e=eP(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o){var l=a[s];(!(n.call(a,s)&&e(l,o))||o===void 0&&!(s in a))&&t(a,s,o)}return Gb=i,Gb}var qb,ME;function EI(){if(ME)return qb;ME=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??t,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return qb=r,qb}var Wb,AE;function NI(){if(AE)return Wb;AE=1;var t=CI(),e=iP(),r=EI(),n=ov(),i=B_();function a(s,o,l,u){if(!n(s))return s;o=e(o,s);for(var c=-1,f=o.length,g=f-1,v=s;v!=null&&++c<f;){var x=i(o[c]),_=l;if(x==="__proto__"||x==="constructor"||x==="prototype")return s;if(c!=g){var S=v[x];_=u?u(S,x,v):void 0,_===void 0&&(_=n(S)?S:r(o[c+1])?[]:{})}t(v,x,_),v=v[x]}return s}return Wb=a,Wb}var $b,jE;function TI(){if(jE)return $b;jE=1;var t=NI();function e(r,n,i){return r==null?r:t(r,n,i)}return $b=e,$b}var PI=TI(),MI=sv(PI),Kb,RE;function AI(){if(RE)return Kb;RE=1;function t(e,r){var n=-1,i=e.length;for(r||(r=Array(i));++n<i;)r[n]=e[n];return r}return Kb=t,Kb}var Zb,LE;function jI(){if(LE)return Zb;LE=1;var t=rP(),e=AI(),r=gx(),n=lv(),i=tP(),a=B_(),s=nP();function o(l){return r(l)?t(l,a):n(l)?[l]:e(i(s(l)))}return Zb=o,Zb}var RI=jI(),LI=sv(RI),OI={data:function(e){var r={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(i){},beforeSet:function(i,a){},onSet:function(i){},canSet:function(i){return!0}};return e=Ut({},r,e),function(i,a){var s=e,o=this,l=o.length!==void 0,u=l?o:[o],c=l?o[0]:o;if(Ot(i)){var f=i.indexOf(".")!==-1,g=f&&LI(i);if(s.allowGetting&&a===void 0){var v;return c&&(s.beforeGet(c),g&&c._private[s.field][i]===void 0?v=_I(c._private[s.field],g):v=c._private[s.field][i]),v}else if(s.allowSetting&&a!==void 0){var x=!s.immutableKeys[i];if(x){var _=x4({},i,a);s.beforeSet(o,_);for(var S=0,N=u.length;S<N;S++){var k=u[S];s.canSet(k)&&(g&&c._private[s.field][i]===void 0?MI(k._private[s.field],g,a):k._private[s.field][i]=a)}s.updateStyle&&o.updateStyle(),s.onSet(o),s.settingTriggersEvent&&o[s.triggerFnName](s.settingEvent)}}}else if(s.allowSetting&&_r(i)){var E=i,T,R,j=Object.keys(E);s.beforeSet(o,E);for(var D=0;D<j.length;D++){T=j[D],R=E[T];var B=!s.immutableKeys[T];if(B)for(var I=0;I<u.length;I++){var V=u[I];s.canSet(V)&&(V._private[s.field][T]=R)}}s.updateStyle&&o.updateStyle(),s.onSet(o),s.settingTriggersEvent&&o[s.triggerFnName](s.settingEvent)}else if(s.allowBinding&&Bn(i)){var $=i;o.on(s.bindingEvent,$)}else if(s.allowGetting&&i===void 0){var Z;return c&&(s.beforeGet(c),Z=c._private[s.field]),Z}return o}},removeData:function(e){var r={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Ut({},r,e),function(i){var a=e,s=this,o=s.length!==void 0,l=o?s:[s];if(Ot(i)){for(var u=i.split(/\s+/),c=u.length,f=0;f<c;f++){var g=u[f];if(!yd(g)){var v=!a.immutableKeys[g];if(v)for(var x=0,_=l.length;x<_;x++)l[x]._private[a.field][g]=void 0}}a.triggerEvent&&s[a.triggerFnName](a.event)}else if(i===void 0){for(var S=0,N=l.length;S<N;S++)for(var k=l[S]._private[a.field],E=Object.keys(k),T=0;T<E.length;T++){var R=E[T],j=!a.immutableKeys[R];j&&(k[R]=void 0)}a.triggerEvent&&s[a.triggerFnName](a.event)}return s}}},DI={eventAliasesOn:function(e){var r=e;r.addListener=r.listen=r.bind=r.on,r.unlisten=r.unbind=r.off=r.removeListener,r.trigger=r.emit,r.pon=r.promiseOn=function(n,i){var a=this,s=Array.prototype.slice.call(arguments,0);return new Np(function(o,l){var u=function(v){a.off.apply(a,f),o(v)},c=s.concat([u]),f=c.concat([]);a.on.apply(a,c)})}}},Ir={};[UD,OI,DI].forEach(function(t){Ut(Ir,t)});var II={animate:Ir.animate(),animation:Ir.animation(),animated:Ir.animated(),clearQueue:Ir.clearQueue(),delay:Ir.delay(),delayAnimation:Ir.delayAnimation(),stop:Ir.stop()},B0={classes:function(e){var r=this;if(e===void 0){var n=[];return r[0]._private.classes.forEach(function(x){return n.push(x)}),n}else tn(e)||(e=(e||"").match(/\S+/g)||[]);for(var i=[],a=new Ep(e),s=0;s<r.length;s++){for(var o=r[s],l=o._private,u=l.classes,c=!1,f=0;f<e.length;f++){var g=e[f],v=u.has(g);if(!v){c=!0;break}}c||(c=u.size!==e.length),c&&(l.classes=a,i.push(o))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),r},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var r=this[0];return r!=null&&r._private.classes.has(e)},toggleClass:function(e,r){tn(e)||(e=e.match(/\S+/g)||[]);for(var n=this,i=r===void 0,a=[],s=0,o=n.length;s<o;s++)for(var l=n[s],u=l._private.classes,c=!1,f=0;f<e.length;f++){var g=e[f],v=u.has(g),x=!1;r||i&&!v?(u.add(g),x=!0):(!r||i&&v)&&(u.delete(g),x=!0),!c&&x&&(a.push(l),c=!0)}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,r){var n=this;if(r==null)r=250;else if(r===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},r),n}};B0.className=B0.classNames=B0.classes;var wr={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Pi,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};wr.variable="(?:[\\w-.]|(?:\\\\"+wr.metaChar+"))+";wr.className="(?:[\\w-]|(?:\\\\"+wr.metaChar+"))+";wr.value=wr.string+"|"+wr.number;wr.id=wr.variable;(function(){var t,e,r;for(t=wr.comparatorOp.split("|"),r=0;r<t.length;r++)e=t[r],wr.comparatorOp+="|@"+e;for(t=wr.comparatorOp.split("|"),r=0;r<t.length;r++)e=t[r],!(e.indexOf("!")>=0)&&e!=="="&&(wr.comparatorOp+="|\\!"+e)})();var Yr=function(){return{checks:[]}},Ct={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},_2=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(t,e){return O8(t.selector,e.selector)}),BI=(function(){for(var t={},e,r=0;r<_2.length;r++)e=_2[r],t[e.selector]=e.matches;return t})(),zI=function(e,r){return BI[e](r)},FI="("+_2.map(function(t){return t.selector}).join("|")+")",jf=function(e){return e.replace(new RegExp("\\\\("+wr.metaChar+")","g"),function(r,n){return n})},qc=function(e,r,n){e[e.length-1]=n},S2=[{name:"group",query:!0,regex:"("+wr.group+")",populate:function(e,r,n){var i=yi(n,1),a=i[0];r.checks.push({type:Ct.GROUP,value:a==="*"?a:a+"s"})}},{name:"state",query:!0,regex:FI,populate:function(e,r,n){var i=yi(n,1),a=i[0];r.checks.push({type:Ct.STATE,value:a})}},{name:"id",query:!0,regex:"\\#("+wr.id+")",populate:function(e,r,n){var i=yi(n,1),a=i[0];r.checks.push({type:Ct.ID,value:jf(a)})}},{name:"className",query:!0,regex:"\\.("+wr.className+")",populate:function(e,r,n){var i=yi(n,1),a=i[0];r.checks.push({type:Ct.CLASS,value:jf(a)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+wr.variable+")\\s*\\]",populate:function(e,r,n){var i=yi(n,1),a=i[0];r.checks.push({type:Ct.DATA_EXIST,field:jf(a)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+wr.variable+")\\s*("+wr.comparatorOp+")\\s*("+wr.value+")\\s*\\]",populate:function(e,r,n){var i=yi(n,3),a=i[0],s=i[1],o=i[2],l=new RegExp("^"+wr.string+"$").exec(o)!=null;l?o=o.substring(1,o.length-1):o=parseFloat(o),r.checks.push({type:Ct.DATA_COMPARE,field:jf(a),operator:s,value:o})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+wr.boolOp+")\\s*("+wr.variable+")\\s*\\]",populate:function(e,r,n){var i=yi(n,2),a=i[0],s=i[1];r.checks.push({type:Ct.DATA_BOOL,field:jf(s),operator:a})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+wr.meta+")\\s*("+wr.comparatorOp+")\\s*("+wr.number+")\\s*\\]\\]",populate:function(e,r,n){var i=yi(n,3),a=i[0],s=i[1],o=i[2];r.checks.push({type:Ct.META_COMPARE,field:jf(a),operator:s,value:parseFloat(o)})}},{name:"nextQuery",separator:!0,regex:wr.separator,populate:function(e,r){var n=e.currentSubject,i=e.edgeCount,a=e.compoundCount,s=e[e.length-1];n!=null&&(s.subject=n,e.currentSubject=null),s.edgeCount=i,s.compoundCount=a,e.edgeCount=0,e.compoundCount=0;var o=e[e.length++]=Yr();return o}},{name:"directedEdge",separator:!0,regex:wr.directedEdge,populate:function(e,r){if(e.currentSubject==null){var n=Yr(),i=r,a=Yr();return n.checks.push({type:Ct.DIRECTED_EDGE,source:i,target:a}),qc(e,r,n),e.edgeCount++,a}else{var s=Yr(),o=r,l=Yr();return s.checks.push({type:Ct.NODE_SOURCE,source:o,target:l}),qc(e,r,s),e.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:wr.undirectedEdge,populate:function(e,r){if(e.currentSubject==null){var n=Yr(),i=r,a=Yr();return n.checks.push({type:Ct.UNDIRECTED_EDGE,nodes:[i,a]}),qc(e,r,n),e.edgeCount++,a}else{var s=Yr(),o=r,l=Yr();return s.checks.push({type:Ct.NODE_NEIGHBOR,node:o,neighbor:l}),qc(e,r,s),l}}},{name:"child",separator:!0,regex:wr.child,populate:function(e,r){if(e.currentSubject==null){var n=Yr(),i=Yr(),a=e[e.length-1];return n.checks.push({type:Ct.CHILD,parent:a,child:i}),qc(e,r,n),e.compoundCount++,i}else if(e.currentSubject===r){var s=Yr(),o=e[e.length-1],l=Yr(),u=Yr(),c=Yr(),f=Yr();return s.checks.push({type:Ct.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=r.checks,r.checks=[{type:Ct.TRUE}],f.checks.push({type:Ct.TRUE}),l.checks.push({type:Ct.PARENT,parent:f,child:c}),qc(e,o,s),e.currentSubject=u,e.compoundCount++,c}else{var g=Yr(),v=Yr(),x=[{type:Ct.PARENT,parent:g,child:v}];return g.checks=r.checks,r.checks=x,e.compoundCount++,v}}},{name:"descendant",separator:!0,regex:wr.descendant,populate:function(e,r){if(e.currentSubject==null){var n=Yr(),i=Yr(),a=e[e.length-1];return n.checks.push({type:Ct.DESCENDANT,ancestor:a,descendant:i}),qc(e,r,n),e.compoundCount++,i}else if(e.currentSubject===r){var s=Yr(),o=e[e.length-1],l=Yr(),u=Yr(),c=Yr(),f=Yr();return s.checks.push({type:Ct.COMPOUND_SPLIT,left:o,right:l,subject:u}),u.checks=r.checks,r.checks=[{type:Ct.TRUE}],f.checks.push({type:Ct.TRUE}),l.checks.push({type:Ct.ANCESTOR,ancestor:f,descendant:c}),qc(e,o,s),e.currentSubject=u,e.compoundCount++,c}else{var g=Yr(),v=Yr(),x=[{type:Ct.ANCESTOR,ancestor:g,descendant:v}];return g.checks=r.checks,r.checks=x,e.compoundCount++,v}}},{name:"subject",modifier:!0,regex:wr.subject,populate:function(e,r){if(e.currentSubject!=null&&e.currentSubject!==r)return Br("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=r;var n=e[e.length-1],i=n.checks[0],a=i==null?null:i.type;a===Ct.DIRECTED_EDGE?i.type=Ct.NODE_TARGET:a===Ct.UNDIRECTED_EDGE&&(i.type=Ct.NODE_NEIGHBOR,i.node=i.nodes[1],i.neighbor=i.nodes[0],i.nodes=null)}}];S2.forEach(function(t){return t.regexObj=new RegExp("^"+t.regex)});var VI=function(e){for(var r,n,i,a=0;a<S2.length;a++){var s=S2[a],o=s.name,l=e.match(s.regexObj);if(l!=null){n=l,r=s,i=o;var u=l[0];e=e.substring(u.length);break}}return{expr:r,match:n,name:i,remaining:e}},UI=function(e){var r=e.match(/^\s+/);if(r){var n=r[0];e=e.substring(n.length)}return e},HI=function(e){var r=this,n=r.inputText=e,i=r[0]=Yr();for(r.length=1,n=UI(n);;){var a=VI(n);if(a.expr==null)return Br("The selector `"+e+"`is invalid"),!1;var s=a.match.slice(1),o=a.expr.populate(r,i,s);if(o===!1)return!1;if(o!=null&&(i=o),n=a.remaining,n.match(/^\s*$/))break}var l=r[r.length-1];r.currentSubject!=null&&(l.subject=r.currentSubject),l.edgeCount=r.edgeCount,l.compoundCount=r.compoundCount;for(var u=0;u<r.length;u++){var c=r[u];if(c.compoundCount>0&&c.edgeCount>0)return Br("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return Br("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;c.edgeCount===1&&Br("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},GI=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(c){return c??""},r=function(c){return Ot(c)?'"'+c+'"':e(c)},n=function(c){return" "+c+" "},i=function(c,f){var g=c.type,v=c.value;switch(g){case Ct.GROUP:{var x=e(v);return x.substring(0,x.length-1)}case Ct.DATA_COMPARE:{var _=c.field,S=c.operator;return"["+_+n(e(S))+r(v)+"]"}case Ct.DATA_BOOL:{var N=c.operator,k=c.field;return"["+e(N)+k+"]"}case Ct.DATA_EXIST:{var E=c.field;return"["+E+"]"}case Ct.META_COMPARE:{var T=c.operator,R=c.field;return"[["+R+n(e(T))+r(v)+"]]"}case Ct.STATE:return v;case Ct.ID:return"#"+v;case Ct.CLASS:return"."+v;case Ct.PARENT:case Ct.CHILD:return a(c.parent,f)+n(">")+a(c.child,f);case Ct.ANCESTOR:case Ct.DESCENDANT:return a(c.ancestor,f)+" "+a(c.descendant,f);case Ct.COMPOUND_SPLIT:{var j=a(c.left,f),D=a(c.subject,f),B=a(c.right,f);return j+(j.length>0?" ":"")+D+B}case Ct.TRUE:return""}},a=function(c,f){return c.checks.reduce(function(g,v,x){return g+(f===c&&x===0?"$":"")+i(v,f)},"")},s="",o=0;o<this.length;o++){var l=this[o];s+=a(l,l.subject),this.length>1&&o<this.length-1&&(s+=", ")}return this.toStringCache=s,s},qI={parse:HI,toString:GI},aP=function(e,r,n){var i,a=Ot(e),s=dt(e),o=Ot(n),l,u,c=!1,f=!1,g=!1;switch(r.indexOf("!")>=0&&(r=r.replace("!",""),f=!0),r.indexOf("@")>=0&&(r=r.replace("@",""),c=!0),(a||o||c)&&(l=!a&&!s?"":""+e,u=""+n),c&&(e=l=l.toLowerCase(),n=u=u.toLowerCase()),r){case"*=":i=l.indexOf(u)>=0;break;case"$=":i=l.indexOf(u,l.length-u.length)>=0;break;case"^=":i=l.indexOf(u)===0;break;case"=":i=e===n;break;case">":g=!0,i=e>n;break;case">=":g=!0,i=e>=n;break;case"<":g=!0,i=e<n;break;case"<=":g=!0,i=e<=n;break;default:i=!1;break}return f&&(e!=null||!g)&&(i=!i),i},WI=function(e,r){switch(r){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},$I=function(e){return e!==void 0},z_=function(e,r){return e.data(r)},KI=function(e,r){return e[r]()},Kn=[],yn=function(e,r){return e.checks.every(function(n){return Kn[n.type](n,r)})};Kn[Ct.GROUP]=function(t,e){var r=t.value;return r==="*"||r===e.group()};Kn[Ct.STATE]=function(t,e){var r=t.value;return zI(r,e)};Kn[Ct.ID]=function(t,e){var r=t.value;return e.id()===r};Kn[Ct.CLASS]=function(t,e){var r=t.value;return e.hasClass(r)};Kn[Ct.META_COMPARE]=function(t,e){var r=t.field,n=t.operator,i=t.value;return aP(KI(e,r),n,i)};Kn[Ct.DATA_COMPARE]=function(t,e){var r=t.field,n=t.operator,i=t.value;return aP(z_(e,r),n,i)};Kn[Ct.DATA_BOOL]=function(t,e){var r=t.field,n=t.operator;return WI(z_(e,r),n)};Kn[Ct.DATA_EXIST]=function(t,e){var r=t.field;return t.operator,$I(z_(e,r))};Kn[Ct.UNDIRECTED_EDGE]=function(t,e){var r=t.nodes[0],n=t.nodes[1],i=e.source(),a=e.target();return yn(r,i)&&yn(n,a)||yn(n,i)&&yn(r,a)};Kn[Ct.NODE_NEIGHBOR]=function(t,e){return yn(t.node,e)&&e.neighborhood().some(function(r){return r.isNode()&&yn(t.neighbor,r)})};Kn[Ct.DIRECTED_EDGE]=function(t,e){return yn(t.source,e.source())&&yn(t.target,e.target())};Kn[Ct.NODE_SOURCE]=function(t,e){return yn(t.source,e)&&e.outgoers().some(function(r){return r.isNode()&&yn(t.target,r)})};Kn[Ct.NODE_TARGET]=function(t,e){return yn(t.target,e)&&e.incomers().some(function(r){return r.isNode()&&yn(t.source,r)})};Kn[Ct.CHILD]=function(t,e){return yn(t.child,e)&&yn(t.parent,e.parent())};Kn[Ct.PARENT]=function(t,e){return yn(t.parent,e)&&e.children().some(function(r){return yn(t.child,r)})};Kn[Ct.DESCENDANT]=function(t,e){return yn(t.descendant,e)&&e.ancestors().some(function(r){return yn(t.ancestor,r)})};Kn[Ct.ANCESTOR]=function(t,e){return yn(t.ancestor,e)&&e.descendants().some(function(r){return yn(t.descendant,r)})};Kn[Ct.COMPOUND_SPLIT]=function(t,e){return yn(t.subject,e)&&yn(t.left,e)&&yn(t.right,e)};Kn[Ct.TRUE]=function(){return!0};Kn[Ct.COLLECTION]=function(t,e){var r=t.value;return r.has(e)};Kn[Ct.FILTER]=function(t,e){var r=t.value;return r(e)};var ZI=function(e){var r=this;if(r.length===1&&r[0].checks.length===1&&r[0].checks[0].type===Ct.ID)return e.getElementById(r[0].checks[0].value).collection();var n=function(a){for(var s=0;s<r.length;s++){var o=r[s];if(yn(o,a))return!0}return!1};return r.text()==null&&(n=function(){return!0}),e.filter(n)},YI=function(e){for(var r=this,n=0;n<r.length;n++){var i=r[n];if(yn(i,e))return!0}return!1},XI={matches:YI,filter:ZI},wd=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||Ot(e)&&e.match(/^\s*$/)||(Ys(e)?this.addQuery({checks:[{type:Ct.COLLECTION,value:e.collection()}]}):Bn(e)?this.addQuery({checks:[{type:Ct.FILTER,value:e}]}):Ot(e)?this.parse(e)||(this.invalid=!0):jn("A selector must be created from a string; found "))},_d=wd.prototype;[qI,XI].forEach(function(t){return Ut(_d,t)});_d.text=function(){return this.inputText};_d.size=function(){return this.length};_d.eq=function(t){return this[t]};_d.sameText=function(t){return!this.invalid&&!t.invalid&&this.text()===t.text()};_d.addQuery=function(t){this[this.length++]=t};_d.selector=_d.toString;var dd={allAre:function(e){var r=new wd(e);return this.every(function(n){return r.matches(n)})},is:function(e){var r=new wd(e);return this.some(function(n){return r.matches(n)})},some:function(e,r){for(var n=0;n<this.length;n++){var i=r?e.apply(r,[this[n],n,this]):e(this[n],n,this);if(i)return!0}return!1},every:function(e,r){for(var n=0;n<this.length;n++){var i=r?e.apply(r,[this[n],n,this]):e(this[n],n,this);if(!i)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var r=this.length,n=e.length;return r!==n?!1:r===1?this[0]===e[0]:this.every(function(i){return e.hasElementWithId(i.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(r){return e.hasElementWithId(r.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var r=this.neighborhood();return e.every(function(n){return r.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var r=this;return e.every(function(n){return r.hasElementWithId(n.id())})}};dd.allAreNeighbours=dd.allAreNeighbors;dd.has=dd.contains;dd.equal=dd.equals=dd.same;var No=function(e,r){return function(i,a,s,o){var l=i,u=this,c;if(l==null?c="":Ys(l)&&l.length===1&&(c=l.id()),u.length===1&&c){var f=u[0]._private,g=f.traversalCache=f.traversalCache||{},v=g[r]=g[r]||[],x=Lh(c),_=v[x];return _||(v[x]=e.call(u,i,a,s,o))}else return e.call(u,i,a,s,o)}},dp={parent:function(e){var r=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var i=0;i<this.length;i++){var a=this[i],s=a._private.parent;s&&r.push(s)}return this.spawn(r,!0).filter(e)},parents:function(e){for(var r=[],n=this.parent();n.nonempty();){for(var i=0;i<n.length;i++){var a=n[i];r.push(a)}n=n.parent()}return this.spawn(r,!0).filter(e)},commonAncestors:function(e){for(var r,n=0;n<this.length;n++){var i=this[n],a=i.parents();r=r||a,r=r.intersect(a)}return r.filter(e)},orphans:function(e){return this.stdFilter(function(r){return r.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(r){return r.isChild()}).filter(e)},children:No(function(t){for(var e=[],r=0;r<this.length;r++)for(var n=this[r],i=n._private.children,a=0;a<i.length;a++)e.push(i[a]);return this.spawn(e,!0).filter(t)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var r=[];function n(i){for(var a=0;a<i.length;a++){var s=i[a];r.push(s),s.children().nonempty()&&n(s.children())}}return n(this.children()),this.spawn(r,!0).filter(e)}};function F_(t,e,r,n){for(var i=[],a=new Ep,s=t.cy(),o=s.hasCompoundNodes(),l=0;l<t.length;l++){var u=t[l];r?i.push(u):o&&n(i,a,u)}for(;i.length>0;){var c=i.shift();e(c),a.add(c.id()),o&&n(i,a,c)}return t}function sP(t,e,r){if(r.isParent())for(var n=r._private.children,i=0;i<n.length;i++){var a=n[i];e.has(a.id())||t.push(a)}}dp.forEachDown=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return F_(this,t,e,sP)};function oP(t,e,r){if(r.isChild()){var n=r._private.parent;e.has(n.id())||t.push(n)}}dp.forEachUp=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return F_(this,t,e,oP)};function QI(t,e,r){oP(t,e,r),sP(t,e,r)}dp.forEachUpAndDown=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return F_(this,t,e,QI)};dp.ancestors=dp.parents;var Ig,lP;Ig=lP={data:Ir.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Ir.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Ir.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Ir.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Ir.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Ir.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};Ig.attr=Ig.data;Ig.removeAttr=Ig.removeData;var JI=lP,bx={};function Yb(t){return function(e){var r=this;if(e===void 0&&(e=!0),r.length!==0)if(r.isNode()&&!r.removed()){for(var n=0,i=r[0],a=i._private.edges,s=0;s<a.length;s++){var o=a[s];!e&&o.isLoop()||(n+=t(i,o))}return n}else return}}Ut(bx,{degree:Yb(function(t,e){return e.source().same(e.target())?2:1}),indegree:Yb(function(t,e){return e.target().same(t)?1:0}),outdegree:Yb(function(t,e){return e.source().same(t)?1:0})});function Rf(t,e){return function(r){for(var n,i=this.nodes(),a=0;a<i.length;a++){var s=i[a],o=s[t](r);o!==void 0&&(n===void 0||e(o,n))&&(n=o)}return n}}Ut(bx,{minDegree:Rf("degree",function(t,e){return t<e}),maxDegree:Rf("degree",function(t,e){return t>e}),minIndegree:Rf("indegree",function(t,e){return t<e}),maxIndegree:Rf("indegree",function(t,e){return t>e}),minOutdegree:Rf("outdegree",function(t,e){return t<e}),maxOutdegree:Rf("outdegree",function(t,e){return t>e})});Ut(bx,{totalDegree:function(e){for(var r=0,n=this.nodes(),i=0;i<n.length;i++)r+=n[i].degree(e);return r}});var dl,uP,cP=function(e,r,n){for(var i=0;i<e.length;i++){var a=e[i];if(!a.locked()){var s=a._private.position,o={x:r.x!=null?r.x-s.x:0,y:r.y!=null?r.y-s.y:0};a.isParent()&&!(o.x===0&&o.y===0)&&a.children().shift(o,n),a.dirtyBoundingBoxCache()}}},OE={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,r){cP(e,r,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};dl=uP={position:Ir.data(OE),silentPosition:Ir.data(Ut({},OE,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,r){cP(e,r,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,r){if(_r(e))r?this.silentPosition(e):this.position(e);else if(Bn(e)){var n=e,i=this.cy();i.startBatch();for(var a=0;a<this.length;a++){var s=this[a],o=void 0;(o=n(s,a))&&(r?s.silentPosition(o):s.position(o))}i.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,r,n){var i;if(_r(e)?(i={x:dt(e.x)?e.x:0,y:dt(e.y)?e.y:0},n=r):Ot(e)&&dt(r)&&(i={x:0,y:0},i[e]=r),i!=null){var a=this.cy();a.startBatch();for(var s=0;s<this.length;s++){var o=this[s];if(!(a.hasCompoundNodes()&&o.isChild()&&o.ancestors().anySame(this))){var l=o.position(),u={x:l.x+i.x,y:l.y+i.y};n?o.silentPosition(u):o.position(u)}}a.endBatch()}return this},silentShift:function(e,r){return _r(e)?this.shift(e,!0):Ot(e)&&dt(r)&&this.shift(e,r,!0),this},renderedPosition:function(e,r){var n=this[0],i=this.cy(),a=i.zoom(),s=i.pan(),o=_r(e)?e:void 0,l=o!==void 0||r!==void 0&&Ot(e);if(n&&n.isNode())if(l)for(var u=0;u<this.length;u++){var c=this[u];r!==void 0?c.position(e,(r-s[e])/a):o!==void 0&&c.position(B4(o,a,s))}else{var f=n.position();return o=px(f,a,s),e===void 0?o:o[e]}else if(!l)return;return this},relativePosition:function(e,r){var n=this[0],i=this.cy(),a=_r(e)?e:void 0,s=a!==void 0||r!==void 0&&Ot(e),o=i.hasCompoundNodes();if(n&&n.isNode())if(s)for(var l=0;l<this.length;l++){var u=this[l],c=o?u.parent():null,f=c&&c.length>0,g=f;f&&(c=c[0]);var v=g?c.position():{x:0,y:0};r!==void 0?u.position(e,r+v[e]):a!==void 0&&u.position({x:a.x+v.x,y:a.y+v.y})}else{var x=n.position(),_=o?n.parent():null,S=_&&_.length>0,N=S;S&&(_=_[0]);var k=N?_.position():{x:0,y:0};return a={x:x.x-k.x,y:x.y-k.y},e===void 0?a:a[e]}else if(!s)return;return this}};dl.modelPosition=dl.point=dl.position;dl.modelPositions=dl.points=dl.positions;dl.renderedPoint=dl.renderedPosition;dl.relativePoint=dl.relativePosition;var e9=uP,ap,Pd;ap=Pd={};Pd.renderedBoundingBox=function(t){var e=this.boundingBox(t),r=this.cy(),n=r.zoom(),i=r.pan(),a=e.x1*n+i.x,s=e.x2*n+i.x,o=e.y1*n+i.y,l=e.y2*n+i.y;return{x1:a,x2:s,y1:o,y2:l,w:s-a,h:l-o}};Pd.dirtyCompoundBoundsCache=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(r){if(r.isParent()){var n=r._private;n.compoundBoundsClean=!1,n.bbCache=null,t||r.emitAndNotify("bounds")}}),this)};Pd.updateCompoundBounds=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!t&&e.batching())return this;function r(s){if(!s.isParent())return;var o=s._private,l=s.children(),u=s.pstyle("compound-sizing-wrt-labels").value==="include",c={width:{val:s.pstyle("min-width").pfValue,left:s.pstyle("min-width-bias-left"),right:s.pstyle("min-width-bias-right")},height:{val:s.pstyle("min-height").pfValue,top:s.pstyle("min-height-bias-top"),bottom:s.pstyle("min-height-bias-bottom")}},f=l.boundingBox({includeLabels:u,includeOverlays:!1,useCache:!1}),g=o.position;(f.w===0||f.h===0)&&(f={w:s.pstyle("width").pfValue,h:s.pstyle("height").pfValue},f.x1=g.x-f.w/2,f.x2=g.x+f.w/2,f.y1=g.y-f.h/2,f.y2=g.y+f.h/2);function v(I,V,$){var Z=0,O=0,W=V+$;return I>0&&W>0&&(Z=V/W*I,O=$/W*I),{biasDiff:Z,biasComplementDiff:O}}function x(I,V,$,Z){if($.units==="%")switch(Z){case"width":return I>0?$.pfValue*I:0;case"height":return V>0?$.pfValue*V:0;case"average":return I>0&&V>0?$.pfValue*(I+V)/2:0;case"min":return I>0&&V>0?I>V?$.pfValue*V:$.pfValue*I:0;case"max":return I>0&&V>0?I>V?$.pfValue*I:$.pfValue*V:0;default:return 0}else return $.units==="px"?$.pfValue:0}var _=c.width.left.value;c.width.left.units==="px"&&c.width.val>0&&(_=_*100/c.width.val);var S=c.width.right.value;c.width.right.units==="px"&&c.width.val>0&&(S=S*100/c.width.val);var N=c.height.top.value;c.height.top.units==="px"&&c.height.val>0&&(N=N*100/c.height.val);var k=c.height.bottom.value;c.height.bottom.units==="px"&&c.height.val>0&&(k=k*100/c.height.val);var E=v(c.width.val-f.w,_,S),T=E.biasDiff,R=E.biasComplementDiff,j=v(c.height.val-f.h,N,k),D=j.biasDiff,B=j.biasComplementDiff;o.autoPadding=x(f.w,f.h,s.pstyle("padding"),s.pstyle("padding-relative-to").value),o.autoWidth=Math.max(f.w,c.width.val),g.x=(-T+f.x1+f.x2+R)/2,o.autoHeight=Math.max(f.h,c.height.val),g.y=(-D+f.y1+f.y2+B)/2}for(var n=0;n<this.length;n++){var i=this[n],a=i._private;(!a.compoundBoundsClean||t)&&(r(i),e.batching()||(a.compoundBoundsClean=!0))}return this};var Co=function(e){return e===1/0||e===-1/0?0:e},ol=function(e,r,n,i,a){i-r===0||a-n===0||r==null||n==null||i==null||a==null||(e.x1=r<e.x1?r:e.x1,e.x2=i>e.x2?i:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=a>e.y2?a:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},Yc=function(e,r){return r==null?e:ol(e,r.x1,r.y1,r.x2,r.y2)},im=function(e,r,n){return Ts(e,r,n)},o0=function(e,r,n){if(!r.cy().headless()){var i=r._private,a=i.rstyle,s=a.arrowWidth/2,o=r.pstyle(n+"-arrow-shape").value,l,u;if(o!=="none"){n==="source"?(l=a.srcX,u=a.srcY):n==="target"?(l=a.tgtX,u=a.tgtY):(l=a.midX,u=a.midY);var c=i.arrowBounds=i.arrowBounds||{},f=c[n]=c[n]||{};f.x1=l-s,f.y1=u-s,f.x2=l+s,f.y2=u+s,f.w=f.x2-f.x1,f.h=f.y2-f.y1,D0(f,1),ol(e,f.x1,f.y1,f.x2,f.y2)}}},Xb=function(e,r,n){if(!r.cy().headless()){var i;n?i=n+"-":i="";var a=r._private,s=a.rstyle,o=r.pstyle(i+"label").strValue;if(o){var l=r.pstyle("text-halign"),u=r.pstyle("text-valign"),c=im(s,"labelWidth",n),f=im(s,"labelHeight",n),g=im(s,"labelX",n),v=im(s,"labelY",n),x=r.pstyle(i+"text-margin-x").pfValue,_=r.pstyle(i+"text-margin-y").pfValue,S=r.isEdge(),N=r.pstyle(i+"text-rotation"),k=r.pstyle("text-outline-width").pfValue,E=r.pstyle("text-border-width").pfValue,T=E/2,R=r.pstyle("text-background-padding").pfValue,j=2,D=f,B=c,I=B/2,V=D/2,$,Z,O,W;if(S)$=g-I,Z=g+I,O=v-V,W=v+V;else{switch(l.value){case"left":$=g-B,Z=g;break;case"center":$=g-I,Z=g+I;break;case"right":$=g,Z=g+B;break}switch(u.value){case"top":O=v-D,W=v;break;case"center":O=v-V,W=v+V;break;case"bottom":O=v,W=v+D;break}}var F=x-Math.max(k,T)-R-j,K=x+Math.max(k,T)+R+j,X=_-Math.max(k,T)-R-j,Q=_+Math.max(k,T)+R+j;$+=F,Z+=K,O+=X,W+=Q;var ae=n||"main",re=a.labelBounds,G=re[ae]=re[ae]||{};G.x1=$,G.y1=O,G.x2=Z,G.y2=W,G.w=Z-$,G.h=W-O,G.leftPad=F,G.rightPad=K,G.topPad=X,G.botPad=Q;var te=S&&N.strValue==="autorotate",ne=N.pfValue!=null&&N.pfValue!==0;if(te||ne){var de=te?im(a.rstyle,"labelAngle",n):N.pfValue,me=Math.cos(de),ye=Math.sin(de),ie=($+Z)/2,pe=(O+W)/2;if(!S){switch(l.value){case"left":ie=Z;break;case"right":ie=$;break}switch(u.value){case"top":pe=W;break;case"bottom":pe=O;break}}var oe=function(Ve,Je){return Ve=Ve-ie,Je=Je-pe,{x:Ve*me-Je*ye+ie,y:Ve*ye+Je*me+pe}},fe=oe($,O),ge=oe($,W),be=oe(Z,O),_e=oe(Z,W);$=Math.min(fe.x,ge.x,be.x,_e.x),Z=Math.max(fe.x,ge.x,be.x,_e.x),O=Math.min(fe.y,ge.y,be.y,_e.y),W=Math.max(fe.y,ge.y,be.y,_e.y)}var De=ae+"Rot",qe=re[De]=re[De]||{};qe.x1=$,qe.y1=O,qe.x2=Z,qe.y2=W,qe.w=Z-$,qe.h=W-O,ol(e,$,O,Z,W),ol(a.labelBounds.all,$,O,Z,W)}return e}},DE=function(e,r){if(!r.cy().headless()){var n=r.pstyle("outline-opacity").value,i=r.pstyle("outline-width").value,a=r.pstyle("outline-offset").value,s=i+a;dP(e,r,n,s,"outside",s/2)}},dP=function(e,r,n,i,a,s){if(!(n===0||i<=0||a==="inside")){var o=r.cy(),l=r.pstyle("shape").value,u=o.renderer().nodeShapes[l],c=r.position(),f=c.x,g=c.y,v=r.width(),x=r.height();if(u.hasMiterBounds){a==="center"&&(i/=2);var _=u.miterBounds(f,g,v,x,i);Yc(e,_)}else s!=null&&s>0&&I0(e,[s,s,s,s])}},t9=function(e,r){if(!r.cy().headless()){var n=r.pstyle("border-opacity").value,i=r.pstyle("border-width").pfValue,a=r.pstyle("border-position").value;dP(e,r,n,i,a)}},r9=function(e,r){var n=e._private.cy,i=n.styleEnabled(),a=n.headless(),s=ls(),o=e._private,l=e.isNode(),u=e.isEdge(),c,f,g,v,x,_,S=o.rstyle,N=l&&i?e.pstyle("bounds-expansion").pfValue:[0],k=function(Ue){return Ue.pstyle("display").value!=="none"},E=!i||k(e)&&(!u||k(e.source())&&k(e.target()));if(E){var T=0,R=0;i&&r.includeOverlays&&(T=e.pstyle("overlay-opacity").value,T!==0&&(R=e.pstyle("overlay-padding").value));var j=0,D=0;i&&r.includeUnderlays&&(j=e.pstyle("underlay-opacity").value,j!==0&&(D=e.pstyle("underlay-padding").value));var B=Math.max(R,D),I=0,V=0;if(i&&(I=e.pstyle("width").pfValue,V=I/2),l&&r.includeNodes){var $=e.position();x=$.x,_=$.y;var Z=e.outerWidth(),O=Z/2,W=e.outerHeight(),F=W/2;c=x-O,f=x+O,g=_-F,v=_+F,ol(s,c,g,f,v),i&&DE(s,e),i&&r.includeOutlines&&!a&&DE(s,e),i&&t9(s,e)}else if(u&&r.includeEdges)if(i&&!a){var K=e.pstyle("curve-style").strValue;if(c=Math.min(S.srcX,S.midX,S.tgtX),f=Math.max(S.srcX,S.midX,S.tgtX),g=Math.min(S.srcY,S.midY,S.tgtY),v=Math.max(S.srcY,S.midY,S.tgtY),c-=V,f+=V,g-=V,v+=V,ol(s,c,g,f,v),K==="haystack"){var X=S.haystackPts;if(X&&X.length===2){if(c=X[0].x,g=X[0].y,f=X[1].x,v=X[1].y,c>f){var Q=c;c=f,f=Q}if(g>v){var ae=g;g=v,v=ae}ol(s,c-V,g-V,f+V,v+V)}}else if(K==="bezier"||K==="unbundled-bezier"||nd(K,"segments")||nd(K,"taxi")){var re;switch(K){case"bezier":case"unbundled-bezier":re=S.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":re=S.linePts;break}if(re!=null)for(var G=0;G<re.length;G++){var te=re[G];c=te.x-V,f=te.x+V,g=te.y-V,v=te.y+V,ol(s,c,g,f,v)}}}else{var ne=e.source(),de=ne.position(),me=e.target(),ye=me.position();if(c=de.x,f=ye.x,g=de.y,v=ye.y,c>f){var ie=c;c=f,f=ie}if(g>v){var pe=g;g=v,v=pe}c-=V,f+=V,g-=V,v+=V,ol(s,c,g,f,v)}if(i&&r.includeEdges&&u&&(o0(s,e,"mid-source"),o0(s,e,"mid-target"),o0(s,e,"source"),o0(s,e,"target")),i){var oe=e.pstyle("ghost").value==="yes";if(oe){var fe=e.pstyle("ghost-offset-x").pfValue,ge=e.pstyle("ghost-offset-y").pfValue;ol(s,s.x1+fe,s.y1+ge,s.x2+fe,s.y2+ge)}}var be=o.bodyBounds=o.bodyBounds||{};wC(be,s),I0(be,N),D0(be,1),i&&(c=s.x1,f=s.x2,g=s.y1,v=s.y2,ol(s,c-B,g-B,f+B,v+B));var _e=o.overlayBounds=o.overlayBounds||{};wC(_e,s),I0(_e,N),D0(_e,1);var De=o.labelBounds=o.labelBounds||{};De.all!=null?IO(De.all):De.all=ls(),i&&r.includeLabels&&(r.includeMainLabels&&Xb(s,e,null),u&&(r.includeSourceLabels&&Xb(s,e,"source"),r.includeTargetLabels&&Xb(s,e,"target")))}return s.x1=Co(s.x1),s.y1=Co(s.y1),s.x2=Co(s.x2),s.y2=Co(s.y2),s.w=Co(s.x2-s.x1),s.h=Co(s.y2-s.y1),s.w>0&&s.h>0&&E&&(I0(s,N),D0(s,1)),s},hP=function(e){var r=0,n=function(s){return(s?1:0)<<r++},i=0;return i+=n(e.incudeNodes),i+=n(e.includeEdges),i+=n(e.includeLabels),i+=n(e.includeMainLabels),i+=n(e.includeSourceLabels),i+=n(e.includeTargetLabels),i+=n(e.includeOverlays),i+=n(e.includeOutlines),i},fP=function(e){var r=function(o){return Math.round(o)};if(e.isEdge()){var n=e.source().position(),i=e.target().position();return mC([r(n.x),r(n.y),r(i.x),r(i.y)])}else{var a=e.position();return mC([r(a.x),r(a.y)])}},IE=function(e,r){var n=e._private,i,a=e.isEdge(),s=r==null?BE:hP(r),o=s===BE;if(n.bbCache==null?(i=r9(e,Bg),n.bbCache=i,n.bbCachePosKey=fP(e)):i=n.bbCache,!o){var l=e.isNode();i=ls(),(r.includeNodes&&l||r.includeEdges&&!l)&&(r.includeOverlays?Yc(i,n.overlayBounds):Yc(i,n.bodyBounds)),r.includeLabels&&(r.includeMainLabels&&(!a||r.includeSourceLabels&&r.includeTargetLabels)?Yc(i,n.labelBounds.all):(r.includeMainLabels&&Yc(i,n.labelBounds.mainRot),r.includeSourceLabels&&Yc(i,n.labelBounds.sourceRot),r.includeTargetLabels&&Yc(i,n.labelBounds.targetRot))),i.w=i.x2-i.x1,i.h=i.y2-i.y1}return i},Bg={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},BE=hP(Bg),zE=Ca(Bg);Pd.boundingBox=function(t){var e,r=t===void 0||t.useCache===void 0||t.useCache===!0,n=up(function(c){var f=c._private;return f.bbCache==null||f.styleDirty||f.bbCachePosKey!==fP(c)},function(c){return c.id()});if(r&&this.length===1&&!n(this[0]))t===void 0?t=Bg:t=zE(t),e=IE(this[0],t);else{e=ls(),t=t||Bg;var i=zE(t),a=this,s=a.cy(),o=s.styleEnabled();this.edges().forEach(n),this.nodes().forEach(n),o&&this.recalculateRenderedStyle(r),this.updateCompoundBounds(!r);for(var l=0;l<a.length;l++){var u=a[l];n(u)&&u.dirtyBoundingBoxCache(),Yc(e,IE(u,i))}}return e.x1=Co(e.x1),e.y1=Co(e.y1),e.x2=Co(e.x2),e.y2=Co(e.y2),e.w=Co(e.x2-e.x1),e.h=Co(e.y2-e.y1),e};Pd.dirtyBoundingBoxCache=function(){for(var t=0;t<this.length;t++){var e=this[t]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};Pd.boundingBoxAt=function(t){var e=this.nodes(),r=this.cy(),n=r.hasCompoundNodes(),i=r.collection();if(n&&(i=e.filter(function(u){return u.isParent()}),e=e.not(i)),_r(t)){var a=t;t=function(){return a}}var s=function(c,f){return c._private.bbAtOldPos=t(c,f)},o=function(c){return c._private.bbAtOldPos};r.startBatch(),e.forEach(s).silentPositions(t),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0));var l=DO(this.boundingBox({useCache:!1}));return e.silentPositions(o),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0)),r.endBatch(),l};ap.boundingbox=ap.bb=ap.boundingBox;ap.renderedBoundingbox=ap.renderedBoundingBox;var n9=Pd,sg,dv;sg=dv={};var pP=function(e){e.uppercaseName=eC(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=eC(e.outerName),sg[e.name]=function(){var n=this[0],i=n._private,a=i.cy,s=a._private.styleEnabled;if(n)if(s){if(n.isParent())return n.updateCompoundBounds(),i[e.autoName]||0;var o=n.pstyle(e.name);return o.strValue==="label"?(n.recalculateRenderedStyle(),i.rstyle[e.labelName]||0):o.pfValue}else return 1},sg["outer"+e.uppercaseName]=function(){var n=this[0],i=n._private,a=i.cy,s=a._private.styleEnabled;if(n)if(s){var o=n[e.name](),l=n.pstyle("border-position").value,u;l==="center"?u=n.pstyle("border-width").pfValue:l==="outside"?u=2*n.pstyle("border-width").pfValue:u=0;var c=2*n.padding();return o+u+c}else return 1},sg["rendered"+e.uppercaseName]=function(){var n=this[0];if(n){var i=n[e.name]();return i*this.cy().zoom()}},sg["rendered"+e.uppercaseOuterName]=function(){var n=this[0];if(n){var i=n[e.outerName]();return i*this.cy().zoom()}}};pP({name:"width"});pP({name:"height"});dv.padding=function(){var t=this[0],e=t._private;return t.isParent()?(t.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:t.pstyle("padding").pfValue):t.pstyle("padding").pfValue};dv.paddedHeight=function(){var t=this[0];return t.height()+2*t.padding()};dv.paddedWidth=function(){var t=this[0];return t.width()+2*t.padding()};var i9=dv,a9=function(e,r){if(e.isEdge()&&e.takesUpSpace())return r(e)},s9=function(e,r){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy();return px(r(e),n.zoom(),n.pan())}},o9=function(e,r){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy(),i=n.pan(),a=n.zoom();return r(e).map(function(s){return px(s,a,i)})}},l9=function(e){return e.renderer().getControlPoints(e)},u9=function(e){return e.renderer().getSegmentPoints(e)},c9=function(e){return e.renderer().getSourceEndpoint(e)},d9=function(e){return e.renderer().getTargetEndpoint(e)},h9=function(e){return e.renderer().getEdgeMidpoint(e)},FE={controlPoints:{get:l9,mult:!0},segmentPoints:{get:u9,mult:!0},sourceEndpoint:{get:c9},targetEndpoint:{get:d9},midpoint:{get:h9}},f9=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},p9=Object.keys(FE).reduce(function(t,e){var r=FE[e],n=f9(e);return t[e]=function(){return a9(this,r.get)},r.mult?t[n]=function(){return o9(this,r.get)}:t[n]=function(){return s9(this,r.get)},t},{}),m9=Ut({},e9,n9,i9,p9);var mP=function(e,r){this.recycle(e,r)};function am(){return!1}function l0(){return!0}mP.prototype={instanceString:function(){return"event"},recycle:function(e,r){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=am,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?l0:am):e!=null&&e.type?r=e:this.type=e,r!=null&&(this.originalEvent=r.originalEvent,this.type=r.type!=null?r.type:this.type,this.cy=r.cy,this.target=r.target,this.position=r.position,this.renderedPosition=r.renderedPosition,this.namespace=r.namespace,this.layout=r.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,i=this.cy.zoom(),a=this.cy.pan();this.renderedPosition={x:n.x*i+a.x,y:n.y*i+a.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=l0;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=l0;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l0,this.stopPropagation()},isDefaultPrevented:am,isPropagationStopped:am,isImmediatePropagationStopped:am};var gP=/^([^.]+)(\.(?:[^.]+))?$/,g9=".*",vP={qualifierCompare:function(e,r){return e===r},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},VE=Object.keys(vP),v9={};function wx(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v9,e=arguments.length>1?arguments[1]:void 0,r=0;r<VE.length;r++){var n=VE[r];this[n]=t[n]||vP[n]}this.context=e||this.context,this.listeners=[],this.emitting=0}var Sd=wx.prototype,yP=function(e,r,n,i,a,s,o){Bn(i)&&(a=i,i=null),o&&(s==null?s=o:s=Ut({},s,o));for(var l=tn(n)?n:n.split(/\s+/),u=0;u<l.length;u++){var c=l[u];if(!yd(c)){var f=c.match(gP);if(f){var g=f[1],v=f[2]?f[2]:null,x=r(e,c,g,v,i,a,s);if(x===!1)break}}}},UE=function(e,r){return e.addEventFields(e.context,r),new mP(r.type,r)},y9=function(e,r,n){if(k8(n)){r(e,n);return}else if(_r(n)){r(e,UE(e,n));return}for(var i=tn(n)?n:n.split(/\s+/),a=0;a<i.length;a++){var s=i[a];if(!yd(s)){var o=s.match(gP);if(o){var l=o[1],u=o[2]?o[2]:null,c=UE(e,{type:l,namespace:u,target:e.context});r(e,c)}}}};Sd.on=Sd.addListener=function(t,e,r,n,i){return yP(this,function(a,s,o,l,u,c,f){Bn(c)&&a.listeners.push({event:s,callback:c,type:o,namespace:l,qualifier:u,conf:f})},t,e,r,n,i),this};Sd.one=function(t,e,r,n){return this.on(t,e,r,n,{one:!0})};Sd.removeListener=Sd.off=function(t,e,r,n){var i=this;this.emitting!==0&&(this.listeners=sO(this.listeners));for(var a=this.listeners,s=function(u){var c=a[u];yP(i,function(f,g,v,x,_,S){if((c.type===v||t==="*")&&(!x&&c.namespace!==".*"||c.namespace===x)&&(!_||f.qualifierCompare(c.qualifier,_))&&(!S||c.callback===S))return a.splice(u,1),!1},t,e,r,n)},o=a.length-1;o>=0;o--)s(o);return this};Sd.removeAllListeners=function(){return this.removeListener("*")};Sd.emit=Sd.trigger=function(t,e,r){var n=this.listeners,i=n.length;return this.emitting++,tn(e)||(e=[e]),y9(this,function(a,s){r!=null&&(n=[{event:s.event,type:s.type,namespace:s.namespace,callback:r}],i=n.length);for(var o=function(){var c=n[l];if(c.type===s.type&&(!c.namespace||c.namespace===s.namespace||c.namespace===g9)&&a.eventMatches(a.context,c,s)){var f=[s];e!=null&&lO(f,e),a.beforeEmit(a.context,c,s),c.conf&&c.conf.one&&(a.listeners=a.listeners.filter(function(x){return x!==c}));var g=a.callbackContext(a.context,c,s),v=c.callback.apply(g,f);a.afterEmit(a.context,c,s),v===!1&&(s.stopPropagation(),s.preventDefault())}},l=0;l<i;l++)o();a.bubble(a.context)&&!s.isPropagationStopped()&&a.parent(a.context).emit(s,e)},t),this.emitting--,this};var x9={qualifierCompare:function(e,r){return e==null||r==null?e==null&&r==null:e.sameText(r)},eventMatches:function(e,r,n){var i=r.qualifier;return i!=null?e!==n.target&&av(n.target)&&i.matches(n.target):!0},addEventFields:function(e,r){r.cy=e.cy(),r.target=e},callbackContext:function(e,r,n){return r.qualifier!=null?n.target:e},beforeEmit:function(e,r){r.conf&&r.conf.once&&r.conf.onceCollection.removeListener(r.event,r.qualifier,r.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},u0=function(e){return Ot(e)?new wd(e):e},xP={createEmitter:function(){for(var e=0;e<this.length;e++){var r=this[e],n=r._private;n.emitter||(n.emitter=new wx(x9,r))}return this},emitter:function(){return this._private.emitter},on:function(e,r,n){for(var i=u0(r),a=0;a<this.length;a++){var s=this[a];s.emitter().on(e,i,n)}return this},removeListener:function(e,r,n){for(var i=u0(r),a=0;a<this.length;a++){var s=this[a];s.emitter().removeListener(e,i,n)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var r=this[e];r.emitter().removeAllListeners()}return this},one:function(e,r,n){for(var i=u0(r),a=0;a<this.length;a++){var s=this[a];s.emitter().one(e,i,n)}return this},once:function(e,r,n){for(var i=u0(r),a=0;a<this.length;a++){var s=this[a];s.emitter().on(e,i,n,{once:!0,onceCollection:this})}},emit:function(e,r){for(var n=0;n<this.length;n++){var i=this[n];i.emitter().emit(e,r)}return this},emitAndNotify:function(e,r){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,r),this}};Ir.eventAliasesOn(xP);var bP={nodes:function(e){return this.filter(function(r){return r.isNode()}).filter(e)},edges:function(e){return this.filter(function(r){return r.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),r=this.spawn(),n=0;n<this.length;n++){var i=this[n];i.isNode()?e.push(i):r.push(i)}return{nodes:e,edges:r}},filter:function(e,r){if(e===void 0)return this;if(Ot(e)||Ys(e))return new wd(e).filter(this);if(Bn(e)){for(var n=this.spawn(),i=this,a=0;a<i.length;a++){var s=i[a],o=r?e.apply(r,[s,a,i]):e(s,a,i);o&&n.push(s)}return n}return this.spawn()},not:function(e){if(e){Ot(e)&&(e=this.filter(e));for(var r=this.spawn(),n=0;n<this.length;n++){var i=this[n],a=e.has(i);a||r.push(i)}return r}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(Ot(e)){var r=e;return this.filter(r)}for(var n=this.spawn(),i=this,a=e,s=this.length<e.length,o=s?i:a,l=s?a:i,u=0;u<o.length;u++){var c=o[u];l.has(c)&&n.push(c)}return n},xor:function(e){var r=this._private.cy;Ot(e)&&(e=r.$(e));var n=this.spawn(),i=this,a=e,s=function(l,u){for(var c=0;c<l.length;c++){var f=l[c],g=f._private.data.id,v=u.hasElementWithId(g);v||n.push(f)}};return s(i,a),s(a,i),n},diff:function(e){var r=this._private.cy;Ot(e)&&(e=r.$(e));var n=this.spawn(),i=this.spawn(),a=this.spawn(),s=this,o=e,l=function(c,f,g){for(var v=0;v<c.length;v++){var x=c[v],_=x._private.data.id,S=f.hasElementWithId(_);S?a.merge(x):g.push(x)}};return l(s,o,n),l(o,s,i),{left:n,right:i,both:a}},add:function(e){var r=this._private.cy;if(!e)return this;if(Ot(e)){var n=e;e=r.mutableElements().filter(n)}for(var i=this.spawnSelf(),a=0;a<e.length;a++){var s=e[a],o=!this.has(s);o&&i.push(s)}return i},merge:function(e){var r=this._private,n=r.cy;if(!e)return this;if(e&&Ot(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=r.map,s=0;s<e.length;s++){var o=e[s],l=o._private.data.id,u=!a.has(l);if(u){var c=this.length++;this[c]=o,a.set(l,{ele:o,index:c})}}return this},unmergeAt:function(e){var r=this[e],n=r.id(),i=this._private,a=i.map;this[e]=void 0,a.delete(n);var s=e===this.length-1;if(this.length>1&&!s){var o=this.length-1,l=this[o],u=l._private.data.id;this[o]=void 0,this[e]=l,a.set(u,{ele:l,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var r=this._private,n=e._private.data.id,i=r.map,a=i.get(n);if(!a)return this;var s=a.index;return this.unmergeAt(s),this},unmerge:function(e){var r=this._private.cy;if(!e)return this;if(e&&Ot(e)){var n=e;e=r.mutableElements().filter(n)}for(var i=0;i<e.length;i++)this.unmergeOne(e[i]);return this},unmergeBy:function(e){for(var r=this.length-1;r>=0;r--){var n=this[r];e(n)&&this.unmergeAt(r)}return this},map:function(e,r){for(var n=[],i=this,a=0;a<i.length;a++){var s=i[a],o=r?e.apply(r,[s,a,i]):e(s,a,i);n.push(o)}return n},reduce:function(e,r){for(var n=r,i=this,a=0;a<i.length;a++)n=e(n,i[a],a,i);return n},max:function(e,r){for(var n=-1/0,i,a=this,s=0;s<a.length;s++){var o=a[s],l=r?e.apply(r,[o,s,a]):e(o,s,a);l>n&&(n=l,i=o)}return{value:n,ele:i}},min:function(e,r){for(var n=1/0,i,a=this,s=0;s<a.length;s++){var o=a[s],l=r?e.apply(r,[o,s,a]):e(o,s,a);l<n&&(n=l,i=o)}return{value:n,ele:i}}},Er=bP;Er.u=Er["|"]=Er["+"]=Er.union=Er.or=Er.add;Er["\\"]=Er["!"]=Er["-"]=Er.difference=Er.relativeComplement=Er.subtract=Er.not;Er.n=Er["&"]=Er["."]=Er.and=Er.intersection=Er.intersect;Er["^"]=Er["(+)"]=Er["(-)"]=Er.symmetricDifference=Er.symdiff=Er.xor;Er.fnFilter=Er.filterFn=Er.stdFilter=Er.filter;Er.complement=Er.abscomp=Er.absoluteComplement;var b9={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},wP=function(e,r){var n=e.cy(),i=n.hasCompoundNodes();function a(c){var f=c.pstyle("z-compound-depth");return f.value==="auto"?i?c.zDepth():0:f.value==="bottom"?-1:f.value==="top"?P_:0}var s=a(e)-a(r);if(s!==0)return s;function o(c){var f=c.pstyle("z-index-compare");return f.value==="auto"&&c.isNode()?1:0}var l=o(e)-o(r);if(l!==0)return l;var u=e.pstyle("z-index").value-r.pstyle("z-index").value;return u!==0?u:e.poolIndex()-r.poolIndex()},uy={forEach:function(e,r){if(Bn(e))for(var n=this.length,i=0;i<n;i++){var a=this[i],s=r?e.apply(r,[a,i,this]):e(a,i,this);if(s===!1)break}return this},toArray:function(){for(var e=[],r=0;r<this.length;r++)e.push(this[r]);return e},slice:function(e,r){var n=[],i=this.length;r==null&&(r=i),e==null&&(e=0),e<0&&(e=i+e),r<0&&(r=i+r);for(var a=e;a>=0&&a<r&&a<i;a++)n.push(this[a]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!Bn(e))return this;var r=this.toArray().sort(e);return this.spawn(r)},sortByZIndex:function(){return this.sort(wP)},zDepth:function(){var e=this[0];if(e){var r=e._private,n=r.group;if(n==="nodes"){var i=r.data.parent?e.parents().size():0;return e.isParent()?i:P_-1}else{var a=r.source,s=r.target,o=a.zDepth(),l=s.zDepth();return Math.max(o,l,0)}}}};uy.each=uy.forEach;var w9=function(){var e="undefined",r=(typeof Symbol>"u"?"undefined":Mi(Symbol))!=e&&Mi(Symbol.iterator)!=e;r&&(uy[Symbol.iterator]=function(){var n=this,i={value:void 0,done:!1},a=0,s=this.length;return x4({next:function(){return a<s?i.value=n[a++]:(i.value=void 0,i.done=!0),i}},Symbol.iterator,function(){return this})})};w9();var _9=Ca({nodeDimensionsIncludeLabels:!1}),z0={layoutDimensions:function(e){e=_9(e);var r;if(!this.takesUpSpace())r={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();r={w:n.w,h:n.h}}else r={w:this.outerWidth(),h:this.outerHeight()};return(r.w===0||r.h===0)&&(r.w=r.h=1),r},layoutPositions:function(e,r,n){var i=this.nodes().filter(function(R){return!R.isParent()}),a=this.cy(),s=r.eles,o=function(j){return j.id()},l=up(n,o);e.emit({type:"layoutstart",layout:e}),e.animations=[];var u=function(j,D,B){var I={x:D.x1+D.w/2,y:D.y1+D.h/2},V={x:(B.x-I.x)*j,y:(B.y-I.y)*j};return{x:I.x+V.x,y:I.y+V.y}},c=r.spacingFactor&&r.spacingFactor!==1,f=function(){if(!c)return null;for(var j=ls(),D=0;D<i.length;D++){var B=i[D],I=l(B,D);z4(j,I.x,I.y)}return j},g=f(),v=up(function(R,j){var D=l(R,j);if(c){var B=Math.abs(r.spacingFactor);D=u(B,g,D)}return r.transform!=null&&(D=r.transform(R,D)),D},o);if(r.animate){for(var x=0;x<i.length;x++){var _=i[x],S=v(_,x),N=r.animateFilter==null||r.animateFilter(_,x);if(N){var k=_.animation({position:S,duration:r.animationDuration,easing:r.animationEasing});e.animations.push(k)}else _.position(S)}if(r.fit){var E=a.animation({fit:{boundingBox:s.boundingBoxAt(v),padding:r.padding},duration:r.animationDuration,easing:r.animationEasing});e.animations.push(E)}else if(r.zoom!==void 0&&r.pan!==void 0){var T=a.animation({zoom:r.zoom,pan:r.pan,duration:r.animationDuration,easing:r.animationEasing});e.animations.push(T)}e.animations.forEach(function(R){return R.play()}),e.one("layoutready",r.ready),e.emit({type:"layoutready",layout:e}),Np.all(e.animations.map(function(R){return R.promise()})).then(function(){e.one("layoutstop",r.stop),e.emit({type:"layoutstop",layout:e})})}else i.positions(v),r.fit&&a.fit(r.eles,r.padding),r.zoom!=null&&a.zoom(r.zoom),r.pan&&a.pan(r.pan),e.one("layoutready",r.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",r.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var r=this.cy();return r.makeLayout(Ut({},e,{eles:this}))}};z0.createLayout=z0.makeLayout=z0.layout;function _P(t,e,r){var n=r._private,i=n.styleCache=n.styleCache||[],a;return(a=i[t])!=null||(a=i[t]=e(r)),a}function _x(t,e){return t=Lh(t),function(n){return _P(t,e,n)}}function Sx(t,e){t=Lh(t);var r=function(i){return e.call(i)};return function(){var i=this[0];if(i)return _P(t,r,i)}}var _a={recalculateRenderedStyle:function(e){var r=this.cy(),n=r.renderer(),i=r.styleEnabled();return n&&i&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),r=function(a){return a._private.styleCache=null};if(e.hasCompoundNodes()){var n;n=this.spawnSelf().merge(this.descendants()).merge(this.parents()),n.merge(n.connectedEdges()),n.forEach(r)}else this.forEach(function(i){r(i),i.connectedEdges().forEach(r)});return this},updateStyle:function(e){var r=this._private.cy;if(!r.styleEnabled())return this;if(r.batching()){var n=r._private.batchStyleEles;return n.merge(this),this}var i=r.hasCompoundNodes(),a=this;e=!!(e||e===void 0),i&&(a=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var s=a;return e?s.emitAndNotify("style"):s.emit("style"),a.forEach(function(o){return o._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var r=0;r<this.length;r++){var n=this[r];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this[0],i=n.cy();if(i.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,i.style().apply(n));var a=n._private.style[e];return a??(r?i.style().getDefaultProperty(e):null)}},numericStyle:function(e){var r=this[0];if(r.cy().styleEnabled()&&r){var n=r.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var r=this[0];if(r.cy().styleEnabled()&&r)return r.pstyle(e).units},renderedStyle:function(e){var r=this.cy();if(!r.styleEnabled())return this;var n=this[0];if(n)return r.style().getRenderedStyle(n,e)},style:function(e,r){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style();if(_r(e)){var s=e;a.applyBypass(this,s,i),this.emitAndNotify("style")}else if(Ot(e))if(r===void 0){var o=this[0];return o?a.getStylePropertyValue(o,e):void 0}else a.applyBypass(this,e,r,i),this.emitAndNotify("style");else if(e===void 0){var l=this[0];return l?a.getRawStyle(l):void 0}return this},removeStyle:function(e){var r=this.cy();if(!r.styleEnabled())return this;var n=!1,i=r.style(),a=this;if(e===void 0)for(var s=0;s<a.length;s++){var o=a[s];i.removeAllBypasses(o,n)}else{e=e.split(/\s+/);for(var l=0;l<a.length;l++){var u=a[l];i.removeBypasses(u,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var r=e.hasCompoundNodes(),n=this[0];if(n){var i=n._private,a=n.pstyle("opacity").value;if(!r)return a;var s=i.data.parent?n.parents():null;if(s)for(var o=0;o<s.length;o++){var l=s[o],u=l.pstyle("opacity").value;a=u*a}return a}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var r=this[0],n=r.cy().hasCompoundNodes();if(r)return n?r.effectiveOpacity()===0:r.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var r=this[0];return!!r._private.backgrounding}};function Qb(t,e){var r=t._private,n=r.data.parent?t.parents():null;if(n)for(var i=0;i<n.length;i++){var a=n[i];if(!e(a))return!1}return!0}function V_(t){var e=t.ok,r=t.edgeOkViaNode||t.ok,n=t.parentOk||t.ok;return function(){var i=this.cy();if(!i.styleEnabled())return!0;var a=this[0],s=i.hasCompoundNodes();if(a){var o=a._private;if(!e(a))return!1;if(a.isNode())return!s||Qb(a,n);var l=o.source,u=o.target;return r(l)&&(!s||Qb(l,r))&&(l===u||r(u)&&(!s||Qb(u,r)))}}}var Tp=_x("eleTakesUpSpace",function(t){return t.pstyle("display").value==="element"&&t.width()!==0&&(t.isNode()?t.height()!==0:!0)});_a.takesUpSpace=Sx("takesUpSpace",V_({ok:Tp}));var S9=_x("eleInteractive",function(t){return t.pstyle("events").value==="yes"&&t.pstyle("visibility").value==="visible"&&Tp(t)}),k9=_x("parentInteractive",function(t){return t.pstyle("visibility").value==="visible"&&Tp(t)});_a.interactive=Sx("interactive",V_({ok:S9,parentOk:k9,edgeOkViaNode:Tp}));_a.noninteractive=function(){var t=this[0];if(t)return!t.interactive()};var C9=_x("eleVisible",function(t){return t.pstyle("visibility").value==="visible"&&t.pstyle("opacity").pfValue!==0&&Tp(t)}),E9=Tp;_a.visible=Sx("visible",V_({ok:C9,edgeOkViaNode:E9}));_a.hidden=function(){var t=this[0];if(t)return!t.visible()};_a.isBundledBezier=Sx("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});_a.bypass=_a.css=_a.style;_a.renderedCss=_a.renderedStyle;_a.removeBypass=_a.removeCss=_a.removeStyle;_a.pstyle=_a.parsedStyle;var hd={};function HE(t){return function(){var e=arguments,r=[];if(e.length===2){var n=e[0],i=e[1];this.on(t.event,n,i)}else if(e.length===1&&Bn(e[0])){var a=e[0];this.on(t.event,a)}else if(e.length===0||e.length===1&&tn(e[0])){for(var s=e.length===1?e[0]:null,o=0;o<this.length;o++){var l=this[o],u=!t.ableField||l._private[t.ableField],c=l._private[t.field]!=t.value;if(t.overrideAble){var f=t.overrideAble(l);if(f!==void 0&&(u=f,!f))return this}u&&(l._private[t.field]=t.value,c&&r.push(l))}var g=this.spawn(r);g.updateStyle(),g.emit(t.event),s&&g.emit(s)}return this}}function Pp(t){hd[t.field]=function(){var e=this[0];if(e){if(t.overrideField){var r=t.overrideField(e);if(r!==void 0)return r}return e._private[t.field]}},hd[t.on]=HE({event:t.on,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!0}),hd[t.off]=HE({event:t.off,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!1})}Pp({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});Pp({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});Pp({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});Pp({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});hd.deselect=hd.unselect;hd.grabbed=function(){var t=this[0];if(t)return t._private.grabbed};Pp({field:"active",on:"activate",off:"unactivate"});Pp({field:"pannable",on:"panify",off:"unpanify"});hd.inactive=function(){var t=this[0];if(t)return!t._private.active};var Ua={},GE=function(e){return function(n){for(var i=this,a=[],s=0;s<i.length;s++){var o=i[s];if(o.isNode()){for(var l=!1,u=o.connectedEdges(),c=0;c<u.length;c++){var f=u[c],g=f.source(),v=f.target();if(e.noIncomingEdges&&v===o&&g!==o||e.noOutgoingEdges&&g===o&&v!==o){l=!0;break}}l||a.push(o)}}return this.spawn(a,!0).filter(n)}},qE=function(e){return function(r){for(var n=this,i=[],a=0;a<n.length;a++){var s=n[a];if(s.isNode())for(var o=s.connectedEdges(),l=0;l<o.length;l++){var u=o[l],c=u.source(),f=u.target();e.outgoing&&c===s?(i.push(u),i.push(f)):e.incoming&&f===s&&(i.push(u),i.push(c))}}return this.spawn(i,!0).filter(r)}},WE=function(e){return function(r){for(var n=this,i=[],a={};;){var s=e.outgoing?n.outgoers():n.incomers();if(s.length===0)break;for(var o=!1,l=0;l<s.length;l++){var u=s[l],c=u.id();a[c]||(a[c]=!0,i.push(u),o=!0)}if(!o)break;n=s}return this.spawn(i,!0).filter(r)}};Ua.clearTraversalCache=function(){for(var t=0;t<this.length;t++)this[t]._private.traversalCache=null};Ut(Ua,{roots:GE({noIncomingEdges:!0}),leaves:GE({noOutgoingEdges:!0}),outgoers:No(qE({outgoing:!0}),"outgoers"),successors:WE({outgoing:!0}),incomers:No(qE({incoming:!0}),"incomers"),predecessors:WE({})});Ut(Ua,{neighborhood:No(function(t){for(var e=[],r=this.nodes(),n=0;n<r.length;n++)for(var i=r[n],a=i.connectedEdges(),s=0;s<a.length;s++){var o=a[s],l=o.source(),u=o.target(),c=i===l?u:l;c.length>0&&e.push(c[0]),e.push(o[0])}return this.spawn(e,!0).filter(t)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});Ua.neighbourhood=Ua.neighborhood;Ua.closedNeighbourhood=Ua.closedNeighborhood;Ua.openNeighbourhood=Ua.openNeighborhood;Ut(Ua,{source:No(function(e){var r=this[0],n;return r&&(n=r._private.source||r.cy().collection()),n&&e?n.filter(e):n},"source"),target:No(function(e){var r=this[0],n;return r&&(n=r._private.target||r.cy().collection()),n&&e?n.filter(e):n},"target"),sources:$E({attr:"source"}),targets:$E({attr:"target"})});function $E(t){return function(r){for(var n=[],i=0;i<this.length;i++){var a=this[i],s=a._private[t.attr];s&&n.push(s)}return this.spawn(n,!0).filter(r)}}Ut(Ua,{edgesWith:No(KE(),"edgesWith"),edgesTo:No(KE({thisIsSrc:!0}),"edgesTo")});function KE(t){return function(r){var n=[],i=this._private.cy,a=t||{};Ot(r)&&(r=i.$(r));for(var s=0;s<r.length;s++)for(var o=r[s]._private.edges,l=0;l<o.length;l++){var u=o[l],c=u._private.data,f=this.hasElementWithId(c.source)&&r.hasElementWithId(c.target),g=r.hasElementWithId(c.source)&&this.hasElementWithId(c.target),v=f||g;v&&((a.thisIsSrc||a.thisIsTgt)&&(a.thisIsSrc&&!f||a.thisIsTgt&&!g)||n.push(u))}return this.spawn(n,!0)}}Ut(Ua,{connectedEdges:No(function(t){for(var e=[],r=this,n=0;n<r.length;n++){var i=r[n];if(i.isNode())for(var a=i._private.edges,s=0;s<a.length;s++){var o=a[s];e.push(o)}}return this.spawn(e,!0).filter(t)},"connectedEdges"),connectedNodes:No(function(t){for(var e=[],r=this,n=0;n<r.length;n++){var i=r[n];i.isEdge()&&(e.push(i.source()[0]),e.push(i.target()[0]))}return this.spawn(e,!0).filter(t)},"connectedNodes"),parallelEdges:No(ZE(),"parallelEdges"),codirectedEdges:No(ZE({codirected:!0}),"codirectedEdges")});function ZE(t){var e={codirected:!1};return t=Ut({},e,t),function(n){for(var i=[],a=this.edges(),s=t,o=0;o<a.length;o++)for(var l=a[o],u=l._private,c=u.source,f=c._private.data.id,g=u.data.target,v=c._private.edges,x=0;x<v.length;x++){var _=v[x],S=_._private.data,N=S.target,k=S.source,E=N===g&&k===f,T=f===N&&g===k;(s.codirected&&E||!s.codirected&&(E||T))&&i.push(_)}return this.spawn(i,!0).filter(n)}}Ut(Ua,{components:function(e){var r=this,n=r.cy(),i=n.collection(),a=e==null?r.nodes():e.nodes(),s=[];e!=null&&a.empty()&&(a=e.sources());var o=function(c,f){i.merge(c),a.unmerge(c),f.merge(c)};if(a.empty())return r.spawn();var l=function(){var c=n.collection();s.push(c);var f=a[0];o(f,c),r.bfs({directed:!1,roots:f,visit:function(v){return o(v,c)}}),c.forEach(function(g){g.connectedEdges().forEach(function(v){r.has(v)&&c.has(v.source())&&c.has(v.target())&&c.merge(v)})})};do l();while(a.length>0);return s},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});Ua.componentsOf=Ua.components;var Sa=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){jn("A collection must have a reference to the core");return}var a=new Vu,s=!1;if(!r)r=[];else if(r.length>0&&_r(r[0])&&!av(r[0])){s=!0;for(var o=[],l=new Ep,u=0,c=r.length;u<c;u++){var f=r[u];f.data==null&&(f.data={});var g=f.data;if(g.id==null)g.id=D4();else if(e.hasElementWithId(g.id)||l.has(g.id))continue;var v=new fx(e,f,!1);o.push(v),l.add(g.id)}r=o}this.length=0;for(var x=0,_=r.length;x<_;x++){var S=r[x][0];if(S!=null){var N=S._private.data.id;(!n||!a.has(N))&&(n&&a.set(N,{index:this.length,ele:S}),this[this.length]=S,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(k){this.lazyMap=k},rebuildMap:function(){for(var E=this.lazyMap=new Vu,T=this.eles,R=0;R<T.length;R++){var j=T[R];E.set(j.id(),{index:R,ele:j})}}},n&&(this._private.map=a),s&&!i&&this.restore()},hn=fx.prototype=Sa.prototype=Object.create(Array.prototype);hn.instanceString=function(){return"collection"};hn.spawn=function(t,e){return new Sa(this.cy(),t,e)};hn.spawnSelf=function(){return this.spawn(this)};hn.cy=function(){return this._private.cy};hn.renderer=function(){return this._private.cy.renderer()};hn.element=function(){return this[0]};hn.collection=function(){return _4(this)?this:new Sa(this._private.cy,[this])};hn.unique=function(){return new Sa(this._private.cy,this,!0)};hn.hasElementWithId=function(t){return t=""+t,this._private.map.has(t)};hn.getElementById=function(t){t=""+t;var e=this._private.cy,r=this._private.map.get(t);return r?r.ele:new Sa(e)};hn.$id=hn.getElementById;hn.poolIndex=function(){var t=this._private.cy,e=t._private.elements,r=this[0]._private.data.id;return e._private.map.get(r).index};hn.indexOf=function(t){var e=t[0]._private.data.id;return this._private.map.get(e).index};hn.indexOfId=function(t){return t=""+t,this._private.map.get(t).index};hn.json=function(t){var e=this.element(),r=this.cy();if(e==null&&t)return this;if(e!=null){var n=e._private;if(_r(t)){if(r.startBatch(),t.data){e.data(t.data);var i=n.data;if(e.isEdge()){var a=!1,s={},o=t.data.source,l=t.data.target;o!=null&&o!=i.source&&(s.source=""+o,a=!0),l!=null&&l!=i.target&&(s.target=""+l,a=!0),a&&(e=e.move(s))}else{var u="parent"in t.data,c=t.data.parent;u&&(c!=null||i.parent!=null)&&c!=i.parent&&(c===void 0&&(c=null),c!=null&&(c=""+c),e=e.move({parent:c}))}}t.position&&e.position(t.position);var f=function(_,S,N){var k=t[_];k!=null&&k!==n[_]&&(k?e[S]():e[N]())};return f("removed","remove","restore"),f("selected","select","unselect"),f("selectable","selectify","unselectify"),f("locked","lock","unlock"),f("grabbable","grabify","ungrabify"),f("pannable","panify","unpanify"),t.classes!=null&&e.classes(t.classes),r.endBatch(),this}else if(t===void 0){var g={data:Xl(n.data),position:Xl(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};g.classes="";var v=0;return n.classes.forEach(function(x){return g.classes+=v++===0?x:" "+x}),g}}};hn.jsons=function(){for(var t=[],e=0;e<this.length;e++){var r=this[e],n=r.json();t.push(n)}return t};hn.clone=function(){for(var t=this.cy(),e=[],r=0;r<this.length;r++){var n=this[r],i=n.json(),a=new fx(t,i,!1);e.push(a)}return new Sa(t,e)};hn.copy=hn.clone;hn.restore=function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,n=r.cy(),i=n._private,a=[],s=[],o,l=0,u=r.length;l<u;l++){var c=r[l];e&&!c.removed()||(c.isNode()?a.push(c):s.push(c))}o=a.concat(s);var f,g=function(){o.splice(f,1),f--};for(f=0;f<o.length;f++){var v=o[f],x=v._private,_=x.data;if(v.clearTraversalCache(),!(!e&&!x.removed)){if(_.id===void 0)_.id=D4();else if(dt(_.id))_.id=""+_.id;else if(yd(_.id)||!Ot(_.id)){jn("Can not create element with invalid string ID `"+_.id+"`"),g();continue}else if(n.hasElementWithId(_.id)){jn("Can not create second element with ID `"+_.id+"`"),g();continue}}var S=_.id;if(v.isNode()){var N=x.position;N.x==null&&(N.x=0),N.y==null&&(N.y=0)}if(v.isEdge()){for(var k=v,E=["source","target"],T=E.length,R=!1,j=0;j<T;j++){var D=E[j],B=_[D];dt(B)&&(B=_[D]=""+_[D]),B==null||B===""?(jn("Can not create edge `"+S+"` with unspecified "+D),R=!0):n.hasElementWithId(B)||(jn("Can not create edge `"+S+"` with nonexistant "+D+" `"+B+"`"),R=!0)}if(R){g();continue}var I=n.getElementById(_.source),V=n.getElementById(_.target);I.same(V)?I._private.edges.push(k):(I._private.edges.push(k),V._private.edges.push(k)),k._private.source=I,k._private.target=V}x.map=new Vu,x.map.set(S,{ele:v,index:0}),x.removed=!1,e&&n.addToPool(v)}for(var $=0;$<a.length;$++){var Z=a[$],O=Z._private.data;dt(O.parent)&&(O.parent=""+O.parent);var W=O.parent,F=W!=null;if(F||Z._private.parent){var K=Z._private.parent?n.collection().merge(Z._private.parent):n.getElementById(W);if(K.empty())O.parent=void 0;else if(K[0].removed())Br("Node added with missing parent, reference to parent removed"),O.parent=void 0,Z._private.parent=null;else{for(var X=!1,Q=K;!Q.empty();){if(Z.same(Q)){X=!0,O.parent=void 0;break}Q=Q.parent()}X||(K[0]._private.children.push(Z),Z._private.parent=K[0],i.hasCompoundNodes=!0)}}}if(o.length>0){for(var ae=o.length===r.length?r:new Sa(n,o),re=0;re<ae.length;re++){var G=ae[re];G.isNode()||(G.parallelEdges().clearTraversalCache(),G.source().clearTraversalCache(),G.target().clearTraversalCache())}var te;i.hasCompoundNodes?te=n.collection().merge(ae).merge(ae.connectedNodes()).merge(ae.parent()):te=ae,te.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(t),t?ae.emitAndNotify("add"):e&&ae.emit("add")}return r};hn.removed=function(){var t=this[0];return t&&t._private.removed};hn.inside=function(){var t=this[0];return t&&!t._private.removed};hn.remove=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,n=[],i={},a=r._private.cy;function s(W){for(var F=W._private.edges,K=0;K<F.length;K++)l(F[K])}function o(W){for(var F=W._private.children,K=0;K<F.length;K++)l(F[K])}function l(W){var F=i[W.id()];e&&W.removed()||F||(i[W.id()]=!0,W.isNode()?(n.push(W),s(W),o(W)):n.unshift(W))}for(var u=0,c=r.length;u<c;u++){var f=r[u];l(f)}function g(W,F){var K=W._private.edges;xd(K,F),W.clearTraversalCache()}function v(W){W.clearTraversalCache()}var x=[];x.ids={};function _(W,F){F=F[0],W=W[0];var K=W._private.children,X=W.id();xd(K,F),F._private.parent=null,x.ids[X]||(x.ids[X]=!0,x.push(W))}r.dirtyCompoundBoundsCache(),e&&a.removeFromPool(n);for(var S=0;S<n.length;S++){var N=n[S];if(N.isEdge()){var k=N.source()[0],E=N.target()[0];g(k,N),g(E,N);for(var T=N.parallelEdges(),R=0;R<T.length;R++){var j=T[R];v(j),j.isBundledBezier()&&j.dirtyBoundingBoxCache()}}else{var D=N.parent();D.length!==0&&_(D,N)}e&&(N._private.removed=!0)}var B=a._private.elements;a._private.hasCompoundNodes=!1;for(var I=0;I<B.length;I++){var V=B[I];if(V.isParent()){a._private.hasCompoundNodes=!0;break}}var $=new Sa(this.cy(),n);$.size()>0&&(t?$.emitAndNotify("remove"):e&&$.emit("remove"));for(var Z=0;Z<x.length;Z++){var O=x[Z];(!e||!O.removed())&&O.updateStyle()}return $};hn.move=function(t){var e=this._private.cy,r=this,n=!1,i=!1,a=function(x){return x==null?x:""+x};if(t.source!==void 0||t.target!==void 0){var s=a(t.source),o=a(t.target),l=s!=null&&e.hasElementWithId(s),u=o!=null&&e.hasElementWithId(o);(l||u)&&(e.batch(function(){r.remove(n,i),r.emitAndNotify("moveout");for(var v=0;v<r.length;v++){var x=r[v],_=x._private.data;x.isEdge()&&(l&&(_.source=s),u&&(_.target=o))}r.restore(n,i)}),r.emitAndNotify("move"))}else if(t.parent!==void 0){var c=a(t.parent),f=c===null||e.hasElementWithId(c);if(f){var g=c===null?void 0:c;e.batch(function(){var v=r.remove(n,i);v.emitAndNotify("moveout");for(var x=0;x<r.length;x++){var _=r[x],S=_._private.data;_.isNode()&&(S.parent=g)}v.restore(n,i)}),r.emitAndNotify("move")}}return this};[K4,II,B0,dd,dp,JI,bx,m9,xP,bP,b9,uy,z0,_a,hd,Ua].forEach(function(t){Ut(hn,t)});var N9={add:function(e){var r,n=this;if(Ys(e)){var i=e;if(i._private.cy===n)r=i.restore();else{for(var a=[],s=0;s<i.length;s++){var o=i[s];a.push(o.json())}r=new Sa(n,a)}}else if(tn(e)){var l=e;r=new Sa(n,l)}else if(_r(e)&&(tn(e.nodes)||tn(e.edges))){for(var u=e,c=[],f=["nodes","edges"],g=0,v=f.length;g<v;g++){var x=f[g],_=u[x];if(tn(_))for(var S=0,N=_.length;S<N;S++){var k=Ut({group:x},_[S]);c.push(k)}}r=new Sa(n,c)}else{var E=e;r=new fx(n,E).collection()}return r},remove:function(e){if(!Ys(e)){if(Ot(e)){var r=e;e=this.$(r)}}return e.remove()}};function T9(t,e,r,n){var i=4,a=.001,s=1e-7,o=10,l=11,u=1/(l-1),c=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var f=0;f<4;++f)if(typeof arguments[f]!="number"||isNaN(arguments[f])||!isFinite(arguments[f]))return!1;t=Math.min(t,1),r=Math.min(r,1),t=Math.max(t,0),r=Math.max(r,0);var g=c?new Float32Array(l):new Array(l);function v(V,$){return 1-3*$+3*V}function x(V,$){return 3*$-6*V}function _(V){return 3*V}function S(V,$,Z){return((v($,Z)*V+x($,Z))*V+_($))*V}function N(V,$,Z){return 3*v($,Z)*V*V+2*x($,Z)*V+_($)}function k(V,$){for(var Z=0;Z<i;++Z){var O=N($,t,r);if(O===0)return $;var W=S($,t,r)-V;$-=W/O}return $}function E(){for(var V=0;V<l;++V)g[V]=S(V*u,t,r)}function T(V,$,Z){var O,W,F=0;do W=$+(Z-$)/2,O=S(W,t,r)-V,O>0?Z=W:$=W;while(Math.abs(O)>s&&++F<o);return W}function R(V){for(var $=0,Z=1,O=l-1;Z!==O&&g[Z]<=V;++Z)$+=u;--Z;var W=(V-g[Z])/(g[Z+1]-g[Z]),F=$+W*u,K=N(F,t,r);return K>=a?k(V,F):K===0?F:T(V,$,$+u)}var j=!1;function D(){j=!0,(t!==e||r!==n)&&E()}var B=function($){return j||D(),t===e&&r===n?$:$===0?0:$===1?1:S(R($),e,n)};B.getControlPoints=function(){return[{x:t,y:e},{x:r,y:n}]};var I="generateBezier("+[t,e,r,n]+")";return B.toString=function(){return I},B}var P9=(function(){function t(n){return-n.tension*n.x-n.friction*n.v}function e(n,i,a){var s={x:n.x+a.dx*i,v:n.v+a.dv*i,tension:n.tension,friction:n.friction};return{dx:s.v,dv:t(s)}}function r(n,i){var a={dx:n.v,dv:t(n)},s=e(n,i*.5,a),o=e(n,i*.5,s),l=e(n,i,o),u=1/6*(a.dx+2*(s.dx+o.dx)+l.dx),c=1/6*(a.dv+2*(s.dv+o.dv)+l.dv);return n.x=n.x+u*i,n.v=n.v+c*i,n}return function n(i,a,s){var o={x:-1,v:0,tension:null,friction:null},l=[0],u=0,c=1/1e4,f=16/1e3,g,v,x;for(i=parseFloat(i)||500,a=parseFloat(a)||20,s=s||null,o.tension=i,o.friction=a,g=s!==null,g?(u=n(i,a),v=u/s*f):v=f;x=r(x||o,v),l.push(1+x.x),u+=16,Math.abs(x.x)>c&&Math.abs(x.v)>c;);return g?function(_){return l[_*(l.length-1)|0]}:u}})(),dn=function(e,r,n,i){var a=T9(e,r,n,i);return function(s,o,l){return s+(o-s)*a(l)}},F0={linear:function(e,r,n){return e+(r-e)*n},ease:dn(.25,.1,.25,1),"ease-in":dn(.42,0,1,1),"ease-out":dn(0,0,.58,1),"ease-in-out":dn(.42,0,.58,1),"ease-in-sine":dn(.47,0,.745,.715),"ease-out-sine":dn(.39,.575,.565,1),"ease-in-out-sine":dn(.445,.05,.55,.95),"ease-in-quad":dn(.55,.085,.68,.53),"ease-out-quad":dn(.25,.46,.45,.94),"ease-in-out-quad":dn(.455,.03,.515,.955),"ease-in-cubic":dn(.55,.055,.675,.19),"ease-out-cubic":dn(.215,.61,.355,1),"ease-in-out-cubic":dn(.645,.045,.355,1),"ease-in-quart":dn(.895,.03,.685,.22),"ease-out-quart":dn(.165,.84,.44,1),"ease-in-out-quart":dn(.77,0,.175,1),"ease-in-quint":dn(.755,.05,.855,.06),"ease-out-quint":dn(.23,1,.32,1),"ease-in-out-quint":dn(.86,0,.07,1),"ease-in-expo":dn(.95,.05,.795,.035),"ease-out-expo":dn(.19,1,.22,1),"ease-in-out-expo":dn(1,0,0,1),"ease-in-circ":dn(.6,.04,.98,.335),"ease-out-circ":dn(.075,.82,.165,1),"ease-in-out-circ":dn(.785,.135,.15,.86),spring:function(e,r,n){if(n===0)return F0.linear;var i=P9(e,r,n);return function(a,s,o){return a+(s-a)*i(o)}},"cubic-bezier":dn};function YE(t,e,r,n,i){if(n===1||e===r)return r;var a=i(e,r,n);return t==null||((t.roundValue||t.color)&&(a=Math.round(a)),t.min!==void 0&&(a=Math.max(a,t.min)),t.max!==void 0&&(a=Math.min(a,t.max))),a}function XE(t,e){return t.pfValue!=null||t.value!=null?t.pfValue!=null&&(e==null||e.type.units!=="%")?t.pfValue:t.value:t}function Lf(t,e,r,n,i){var a=i!=null?i.type:null;r<0?r=0:r>1&&(r=1);var s=XE(t,i),o=XE(e,i);if(dt(s)&&dt(o))return YE(a,s,o,r,n);if(tn(s)&&tn(o)){for(var l=[],u=0;u<o.length;u++){var c=s[u],f=o[u];if(c!=null&&f!=null){var g=YE(a,c,f,r,n);l.push(g)}else l.push(f)}return l}}function M9(t,e,r,n){var i=!n,a=t._private,s=e._private,o=s.easing,l=s.startTime,u=n?t:t.cy(),c=u.style();if(!s.easingImpl)if(o==null)s.easingImpl=F0.linear;else{var f;if(Ot(o)){var g=c.parse("transition-timing-function",o);f=g.value}else f=o;var v,x;Ot(f)?(v=f,x=[]):(v=f[1],x=f.slice(2).map(function(ae){return+ae})),x.length>0?(v==="spring"&&x.push(s.duration),s.easingImpl=F0[v].apply(null,x)):s.easingImpl=F0[v]}var _=s.easingImpl,S;if(s.duration===0?S=1:S=(r-l)/s.duration,s.applying&&(S=s.progress),S<0?S=0:S>1&&(S=1),s.delay==null){var N=s.startPosition,k=s.position;if(k&&i&&!t.locked()){var E={};sm(N.x,k.x)&&(E.x=Lf(N.x,k.x,S,_)),sm(N.y,k.y)&&(E.y=Lf(N.y,k.y,S,_)),t.position(E)}var T=s.startPan,R=s.pan,j=a.pan,D=R!=null&&n;D&&(sm(T.x,R.x)&&(j.x=Lf(T.x,R.x,S,_)),sm(T.y,R.y)&&(j.y=Lf(T.y,R.y,S,_)),t.emit("pan"));var B=s.startZoom,I=s.zoom,V=I!=null&&n;V&&(sm(B,I)&&(a.zoom=Og(a.minZoom,Lf(B,I,S,_),a.maxZoom)),t.emit("zoom")),(D||V)&&t.emit("viewport");var $=s.style;if($&&$.length>0&&i){for(var Z=0;Z<$.length;Z++){var O=$[Z],W=O.name,F=O,K=s.startStyle[W],X=c.properties[K.name],Q=Lf(K,F,S,_,X);c.overrideBypass(t,W,Q)}t.emit("style")}}return s.progress=S,S}function sm(t,e){return t==null||e==null?!1:dt(t)&&dt(e)?!0:!!(t&&e)}function A9(t,e,r,n){var i=e._private;i.started=!0,i.startTime=r-i.progress*i.duration}function QE(t,e){var r=e._private.aniEles,n=[];function i(c,f){var g=c._private,v=g.animation.current,x=g.animation.queue,_=!1;if(v.length===0){var S=x.shift();S&&v.push(S)}for(var N=function(j){for(var D=j.length-1;D>=0;D--){var B=j[D];B()}j.splice(0,j.length)},k=v.length-1;k>=0;k--){var E=v[k],T=E._private;if(T.stopped){v.splice(k,1),T.hooked=!1,T.playing=!1,T.started=!1,N(T.frames);continue}!T.playing&&!T.applying||(T.playing&&T.applying&&(T.applying=!1),T.started||A9(c,E,t),M9(c,E,t,f),T.applying&&(T.applying=!1),N(T.frames),T.step!=null&&T.step(t),E.completed()&&(v.splice(k,1),T.hooked=!1,T.playing=!1,T.started=!1,N(T.completes)),_=!0)}return!f&&v.length===0&&x.length===0&&n.push(c),_}for(var a=!1,s=0;s<r.length;s++){var o=r[s],l=i(o);a=a||l}var u=i(e,!0);(a||u)&&(r.length>0?e.notify("draw",r):e.notify("draw")),r.unmerge(n),e.emit("step")}var j9={animate:Ir.animate(),animation:Ir.animation(),animated:Ir.animated(),clearQueue:Ir.clearQueue(),delay:Ir.delay(),delayAnimation:Ir.delayAnimation(),stop:Ir.stop(),addToAnimationPool:function(e){var r=this;r.styleEnabled()&&r._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function r(){e._private.animationsRunning&&iy(function(a){QE(a,e),r()})}var n=e.renderer();n&&n.beforeRender?n.beforeRender(function(a,s){QE(s,e)},n.beforeRenderPriorities.animations):r()}},R9={qualifierCompare:function(e,r){return e==null||r==null?e==null&&r==null:e.sameText(r)},eventMatches:function(e,r,n){var i=r.qualifier;return i!=null?e!==n.target&&av(n.target)&&i.matches(n.target):!0},addEventFields:function(e,r){r.cy=e,r.target=e},callbackContext:function(e,r,n){return r.qualifier!=null?n.target:e}},c0=function(e){return Ot(e)?new wd(e):e},SP={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new wx(R9,this)),this},emitter:function(){return this._private.emitter},on:function(e,r,n){return this.emitter().on(e,c0(r),n),this},removeListener:function(e,r,n){return this.emitter().removeListener(e,c0(r),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,r,n){return this.emitter().one(e,c0(r),n),this},once:function(e,r,n){return this.emitter().one(e,c0(r),n),this},emit:function(e,r){return this.emitter().emit(e,r),this},emitAndNotify:function(e,r){return this.emit(e),this.notify(e,r),this}};Ir.eventAliasesOn(SP);var k2={png:function(e){var r=this._private.renderer;return e=e||{},r.png(e)},jpg:function(e){var r=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",r.jpg(e)}};k2.jpeg=k2.jpg;var V0={layout:function(e){var r=this;if(e==null){jn("Layout options must be specified to make a layout");return}if(e.name==null){jn("A `name` must be specified to make a layout");return}var n=e.name,i=r.extension("layout",n);if(i==null){jn("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var a;Ot(e.eles)?a=r.$(e.eles):a=e.eles!=null?e.eles:r.$();var s=new i(Ut({},e,{cy:r,eles:a}));return s}};V0.createLayout=V0.makeLayout=V0.layout;var L9={notify:function(e,r){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var i=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();r!=null&&i.merge(r);return}if(n.notificationsEnabled){var a=this.renderer();this.destroyed()||!a||a.notify(e,r)}},notifications:function(e){var r=this._private;return e===void 0?r.notificationsEnabled:(r.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var r=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var i=e.batchNotifications[n];i.empty()?r.notify(n):r.notify(n,i)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var r=this;return this.batch(function(){for(var n=Object.keys(e),i=0;i<n.length;i++){var a=n[i],s=e[a],o=r.getElementById(a);o.data(s)}})}},O9=Ca({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),C2={renderTo:function(e,r,n,i){var a=this._private.renderer;return a.renderTo(e,r,n,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var r=this,n=r.extension("renderer",e.name);if(n==null){jn("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&Br("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=O9(e);i.cy=r,r._private.renderer=new n(i),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var r=e.container();if(r)for(r._cyreg=null;r.childNodes.length>0;)r.removeChild(r.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var i=n._private;i.rscratch={},i.rstyle={},i.animation.current=[],i.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};C2.invalidateDimensions=C2.resize;var U0={collection:function(e,r){return Ot(e)?this.$(e):Ys(e)?e.collection():tn(e)?(r||(r={}),new Sa(this,e,r.unique,r.removed)):new Sa(this)},nodes:function(e){var r=this.$(function(n){return n.isNode()});return e?r.filter(e):r},edges:function(e){var r=this.$(function(n){return n.isEdge()});return e?r.filter(e):r},$:function(e){var r=this._private.elements;return e?r.filter(e):r.spawnSelf()},mutableElements:function(){return this._private.elements}};U0.elements=U0.filter=U0.$;var Qi={},pg="t",D9="f";Qi.apply=function(t){for(var e=this,r=e._private,n=r.cy,i=n.collection(),a=0;a<t.length;a++){var s=t[a],o=e.getContextMeta(s);if(!o.empty){var l=e.getContextStyle(o),u=e.applyContextStyle(o,l,s);s._private.appliedInitStyle?e.updateTransitions(s,u.diffProps):s._private.appliedInitStyle=!0;var c=e.updateStyleHints(s);c&&i.push(s)}}return i};Qi.getPropertiesDiff=function(t,e){var r=this,n=r._private.propDiffs=r._private.propDiffs||{},i=t+"-"+e,a=n[i];if(a)return a;for(var s=[],o={},l=0;l<r.length;l++){var u=r[l],c=t[l]===pg,f=e[l]===pg,g=c!==f,v=u.mappedProperties.length>0;if(g||f&&v){var x=void 0;g&&v||g?x=u.properties:v&&(x=u.mappedProperties);for(var _=0;_<x.length;_++){for(var S=x[_],N=S.name,k=!1,E=l+1;E<r.length;E++){var T=r[E],R=e[E]===pg;if(R&&(k=T.properties[S.name]!=null,k))break}!o[N]&&!k&&(o[N]=!0,s.push(N))}}}return n[i]=s,s};Qi.getContextMeta=function(t){for(var e=this,r="",n,i=t._private.styleCxtKey||"",a=0;a<e.length;a++){var s=e[a],o=s.selector&&s.selector.matches(t);o?r+=pg:r+=D9}return n=e.getPropertiesDiff(i,r),t._private.styleCxtKey=r,{key:r,diffPropNames:n,empty:n.length===0}};Qi.getContextStyle=function(t){var e=t.key,r=this,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var i={_private:{key:e}},a=0;a<r.length;a++){var s=r[a],o=e[a]===pg;if(o)for(var l=0;l<s.properties.length;l++){var u=s.properties[l];i[u.name]=u}}return n[e]=i,i};Qi.applyContextStyle=function(t,e,r){for(var n=this,i=t.diffPropNames,a={},s=n.types,o=0;o<i.length;o++){var l=i[o],u=e[l],c=r.pstyle(l);if(!u)if(c)c.bypass?u={name:l,deleteBypassed:!0}:u={name:l,delete:!0};else continue;if(c!==u){if(u.mapped===s.fn&&c!=null&&c.mapping!=null&&c.mapping.value===u.value){var f=c.mapping,g=f.fnValue=u.value(r);if(g===f.prevFnValue)continue}var v=a[l]={prev:c};n.applyParsedProperty(r,u),v.next=r.pstyle(l),v.next&&v.next.bypass&&(v.next=v.next.bypassed)}}return{diffProps:a}};Qi.updateStyleHints=function(t){var e=t._private,r=this,n=r.propertyGroupNames,i=r.propertyGroupKeys,a=function(be,_e,De){return r.getPropertiesHash(be,_e,De)},s=e.styleKey;if(t.removed())return!1;var o=e.group==="nodes",l=t._private.style;n=Object.keys(l);for(var u=0;u<i.length;u++){var c=i[u];e.styleKeys[c]=[yh,Gf]}for(var f=function(be,_e){return e.styleKeys[_e][0]=jg(be,e.styleKeys[_e][0])},g=function(be,_e){return e.styleKeys[_e][1]=Rg(be,e.styleKeys[_e][1])},v=function(be,_e){f(be,_e),g(be,_e)},x=function(be,_e){for(var De=0;De<be.length;De++){var qe=be.charCodeAt(De);f(qe,_e),g(qe,_e)}},_=2e9,S=function(be){return-128<be&&be<128&&Math.floor(be)!==be?_-(be*1024|0):be},N=0;N<n.length;N++){var k=n[N],E=l[k];if(E!=null){var T=this.properties[k],R=T.type,j=T.groupKey,D=void 0;T.hashOverride!=null?D=T.hashOverride(t,E):E.pfValue!=null&&(D=E.pfValue);var B=T.enums==null?E.value:null,I=D!=null,V=B!=null,$=I||V,Z=E.units;if(R.number&&$&&!R.multiple){var O=I?D:B;v(S(O),j),!I&&Z!=null&&x(Z,j)}else x(E.strValue,j)}}for(var W=[yh,Gf],F=0;F<i.length;F++){var K=i[F],X=e.styleKeys[K];W[0]=jg(X[0],W[0]),W[1]=Rg(X[1],W[1])}e.styleKey=Q8(W[0],W[1]);var Q=e.styleKeys;e.labelDimsKey=Gc(Q.labelDimensions);var ae=a(t,["label"],Q.labelDimensions);if(e.labelKey=Gc(ae),e.labelStyleKey=Gc(r0(Q.commonLabel,ae)),!o){var re=a(t,["source-label"],Q.labelDimensions);e.sourceLabelKey=Gc(re),e.sourceLabelStyleKey=Gc(r0(Q.commonLabel,re));var G=a(t,["target-label"],Q.labelDimensions);e.targetLabelKey=Gc(G),e.targetLabelStyleKey=Gc(r0(Q.commonLabel,G))}if(o){var te=e.styleKeys,ne=te.nodeBody,de=te.nodeBorder,me=te.nodeOutline,ye=te.backgroundImage,ie=te.compound,pe=te.pie,oe=te.stripe,fe=[ne,de,me,ye,ie,pe,oe].filter(function(ge){return ge!=null}).reduce(r0,[yh,Gf]);e.nodeKey=Gc(fe),e.hasPie=pe!=null&&pe[0]!==yh&&pe[1]!==Gf,e.hasStripe=oe!=null&&oe[0]!==yh&&oe[1]!==Gf}return s!==e.styleKey};Qi.clearStyleHints=function(t){var e=t._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null,e.hasStripe=null};Qi.applyParsedProperty=function(t,e){var r=this,n=e,i=t._private.style,a,s=r.types,o=r.properties[n.name].type,l=n.bypass,u=i[n.name],c=u&&u.bypass,f=t._private,g="mapping",v=function(ne){return ne==null?null:ne.pfValue!=null?ne.pfValue:ne.value},x=function(){var ne=v(u),de=v(n);r.checkTriggers(t,n.name,ne,de)};if(e.name==="curve-style"&&t.isEdge()&&(e.value!=="bezier"&&t.isLoop()||e.value==="haystack"&&(t.source().isParent()||t.target().isParent()))&&(n=e=this.parse(e.name,"bezier",l)),n.delete)return i[n.name]=void 0,x(),!0;if(n.deleteBypassed)return u?u.bypass?(u.bypassed=void 0,x(),!0):!1:(x(),!0);if(n.deleteBypass)return u?u.bypass?(i[n.name]=u.bypassed,x(),!0):!1:(x(),!0);var _=function(){Br("Do not assign mappings to elements without corresponding data (i.e. ele `"+t.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case s.mapData:{for(var S=n.field.split("."),N=f.data,k=0;k<S.length&&N;k++){var E=S[k];N=N[E]}if(N==null)return _(),!1;var T;if(dt(N)){var R=n.fieldMax-n.fieldMin;R===0?T=0:T=(N-n.fieldMin)/R}else return Br("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+N+"` for `"+t.id()+"` is non-numeric)"),!1;if(T<0?T=0:T>1&&(T=1),o.color){var j=n.valueMin[0],D=n.valueMax[0],B=n.valueMin[1],I=n.valueMax[1],V=n.valueMin[2],$=n.valueMax[2],Z=n.valueMin[3]==null?1:n.valueMin[3],O=n.valueMax[3]==null?1:n.valueMax[3],W=[Math.round(j+(D-j)*T),Math.round(B+(I-B)*T),Math.round(V+($-V)*T),Math.round(Z+(O-Z)*T)];a={bypass:n.bypass,name:n.name,value:W,strValue:"rgb("+W[0]+", "+W[1]+", "+W[2]+")"}}else if(o.number){var F=n.valueMin+(n.valueMax-n.valueMin)*T;a=this.parse(n.name,F,n.bypass,g)}else return!1;if(!a)return _(),!1;a.mapping=n,n=a;break}case s.data:{for(var K=n.field.split("."),X=f.data,Q=0;Q<K.length&&X;Q++){var ae=K[Q];X=X[ae]}if(X!=null&&(a=this.parse(n.name,X,n.bypass,g)),!a)return _(),!1;a.mapping=n,n=a;break}case s.fn:{var re=n.value,G=n.fnValue!=null?n.fnValue:re(t);if(n.prevFnValue=G,G==null)return Br("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+t.id()+"` is null)"),!1;if(a=this.parse(n.name,G,n.bypass,g),!a)return Br("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+t.id()+"` is invalid)"),!1;a.mapping=Xl(n),n=a;break}case void 0:break;default:return!1}return l?(c?n.bypassed=u.bypassed:n.bypassed=u,i[n.name]=n):c?u.bypassed=n:i[n.name]=n,x(),!0};Qi.cleanElements=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),!e)n._private.style={};else for(var i=n._private.style,a=Object.keys(i),s=0;s<a.length;s++){var o=a[s],l=i[o];l!=null&&(l.bypass?l.bypassed=null:i[o]=null)}}};Qi.update=function(){var t=this._private.cy,e=t.mutableElements();e.updateStyle()};Qi.updateTransitions=function(t,e){var r=this,n=t._private,i=t.pstyle("transition-property").value,a=t.pstyle("transition-duration").pfValue,s=t.pstyle("transition-delay").pfValue;if(i.length>0&&a>0){for(var o={},l=!1,u=0;u<i.length;u++){var c=i[u],f=t.pstyle(c),g=e[c];if(g){var v=g.prev,x=v,_=g.next!=null?g.next:f,S=!1,N=void 0,k=1e-6;x&&(dt(x.pfValue)&&dt(_.pfValue)?(S=_.pfValue-x.pfValue,N=x.pfValue+k*S):dt(x.value)&&dt(_.value)?(S=_.value-x.value,N=x.value+k*S):tn(x.value)&&tn(_.value)&&(S=x.value[0]!==_.value[0]||x.value[1]!==_.value[1]||x.value[2]!==_.value[2],N=x.strValue),S&&(o[c]=_.strValue,this.applyBypass(t,c,N),l=!0))}}if(!l)return;n.transitioning=!0,new Np(function(E){s>0?t.delayAnimation(s).play().promise().then(E):E()}).then(function(){return t.animation({style:o,duration:a,easing:t.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){r.removeBypasses(t,i),t.emitAndNotify("style"),n.transitioning=!1})}else n.transitioning&&(this.removeBypasses(t,i),t.emitAndNotify("style"),n.transitioning=!1)};Qi.checkTrigger=function(t,e,r,n,i,a){var s=this.properties[e],o=i(s);t.removed()||o!=null&&o(r,n,t)&&a(s)};Qi.checkZOrderTrigger=function(t,e,r,n){var i=this;this.checkTrigger(t,e,r,n,function(a){return a.triggersZOrder},function(){i._private.cy.notify("zorder",t)})};Qi.checkBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBounds},function(i){t.dirtyCompoundBoundsCache(),t.dirtyBoundingBoxCache()})};Qi.checkConnectedEdgesBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBoundsOfConnectedEdges},function(i){t.connectedEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};Qi.checkParallelEdgesBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBoundsOfParallelEdges},function(i){t.parallelEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};Qi.checkTriggers=function(t,e,r,n){t.dirtyStyleCache(),this.checkZOrderTrigger(t,e,r,n),this.checkBoundsTrigger(t,e,r,n),this.checkConnectedEdgesBoundsTrigger(t,e,r,n),this.checkParallelEdgesBoundsTrigger(t,e,r,n)};var hv={};hv.applyBypass=function(t,e,r,n){var i=this,a=[],s=!0;if(e==="*"||e==="**"){if(r!==void 0)for(var o=0;o<i.properties.length;o++){var l=i.properties[o],u=l.name,c=this.parse(u,r,!0);c&&a.push(c)}}else if(Ot(e)){var f=this.parse(e,r,!0);f&&a.push(f)}else if(_r(e)){var g=e;n=r;for(var v=Object.keys(g),x=0;x<v.length;x++){var _=v[x],S=g[_];if(S===void 0&&(S=g[dx(_)]),S!==void 0){var N=this.parse(_,S,!0);N&&a.push(N)}}}else return!1;if(a.length===0)return!1;for(var k=!1,E=0;E<t.length;E++){for(var T=t[E],R={},j=void 0,D=0;D<a.length;D++){var B=a[D];if(n){var I=T.pstyle(B.name);j=R[B.name]={prev:I}}k=this.applyParsedProperty(T,Xl(B))||k,n&&(j.next=T.pstyle(B.name))}k&&this.updateStyleHints(T),n&&this.updateTransitions(T,R,s)}return k};hv.overrideBypass=function(t,e,r){e=N_(e);for(var n=0;n<t.length;n++){var i=t[n],a=i._private.style[e],s=this.properties[e].type,o=s.color,l=s.mutiple,u=a?a.pfValue!=null?a.pfValue:a.value:null;!a||!a.bypass?this.applyBypass(i,e,r):(a.value=r,a.pfValue!=null&&(a.pfValue=r),o?a.strValue="rgb("+r.join(",")+")":l?a.strValue=r.join(" "):a.strValue=""+r,this.updateStyleHints(i)),this.checkTriggers(i,e,u,r)}};hv.removeAllBypasses=function(t,e){return this.removeBypasses(t,this.propertyNames,e)};hv.removeBypasses=function(t,e,r){for(var n=!0,i=0;i<t.length;i++){for(var a=t[i],s={},o=0;o<e.length;o++){var l=e[o],u=this.properties[l],c=a.pstyle(u.name);if(!(!c||!c.bypass)){var f="",g=this.parse(l,f,!0),v=s[u.name]={prev:c};this.applyParsedProperty(a,g),v.next=a.pstyle(u.name)}}this.updateStyleHints(a),r&&this.updateTransitions(a,s,n)}};var U_={};U_.getEmSizeInPixels=function(){var t=this.containerCss("font-size");return t!=null?parseFloat(t):1};U_.containerCss=function(t){var e=this._private.cy,r=e.container(),n=e.window();if(n&&r&&n.getComputedStyle)return n.getComputedStyle(r).getPropertyValue(t)};var Jl={};Jl.getRenderedStyle=function(t,e){return e?this.getStylePropertyValue(t,e,!0):this.getRawStyle(t,!0)};Jl.getRawStyle=function(t,e){var r=this;if(t=t[0],t){for(var n={},i=0;i<r.properties.length;i++){var a=r.properties[i],s=r.getStylePropertyValue(t,a.name,e);s!=null&&(n[a.name]=s,n[dx(a.name)]=s)}return n}};Jl.getIndexedStyle=function(t,e,r,n){var i=t.pstyle(e)[r][n];return i??t.cy().style().getDefaultProperty(e)[r][0]};Jl.getStylePropertyValue=function(t,e,r){var n=this;if(t=t[0],t){var i=n.properties[e];i.alias&&(i=i.pointsTo);var a=i.type,s=t.pstyle(i.name);if(s){var o=s.value,l=s.units,u=s.strValue;if(r&&a.number&&o!=null&&dt(o)){var c=t.cy().zoom(),f=function(S){return S*c},g=function(S,N){return f(S)+N},v=tn(o),x=v?l.every(function(_){return _!=null}):l!=null;return x?v?o.map(function(_,S){return g(_,l[S])}).join(" "):g(o,l):v?o.map(function(_){return Ot(_)?_:""+f(_)}).join(" "):""+f(o)}else if(u!=null)return u}return null}};Jl.getAnimationStartStyle=function(t,e){for(var r={},n=0;n<e.length;n++){var i=e[n],a=i.name,s=t.pstyle(a);s!==void 0&&(_r(s)?s=this.parse(a,s.strValue):s=this.parse(a,s)),s&&(r[a]=s)}return r};Jl.getPropsList=function(t){var e=this,r=[],n=t,i=e.properties;if(n)for(var a=Object.keys(n),s=0;s<a.length;s++){var o=a[s],l=n[o],u=i[o]||i[N_(o)],c=this.parse(u.name,l);c&&r.push(c)}return r};Jl.getNonDefaultPropertiesHash=function(t,e,r){var n=r.slice(),i,a,s,o,l,u;for(l=0;l<e.length;l++)if(i=e[l],a=t.pstyle(i,!1),a!=null)if(a.pfValue!=null)n[0]=jg(o,n[0]),n[1]=Rg(o,n[1]);else for(s=a.strValue,u=0;u<s.length;u++)o=s.charCodeAt(u),n[0]=jg(o,n[0]),n[1]=Rg(o,n[1]);return n};Jl.getPropertiesHash=Jl.getNonDefaultPropertiesHash;var kx={};kx.appendFromJson=function(t){for(var e=this,r=0;r<t.length;r++){var n=t[r],i=n.selector,a=n.style||n.css,s=Object.keys(a);e.selector(i);for(var o=0;o<s.length;o++){var l=s[o],u=a[l];e.css(l,u)}}return e};kx.fromJson=function(t){var e=this;return e.resetToDefault(),e.appendFromJson(t),e};kx.json=function(){for(var t=[],e=this.defaultLength;e<this.length;e++){for(var r=this[e],n=r.selector,i=r.properties,a={},s=0;s<i.length;s++){var o=i[s];a[o.name]=o.strValue}t.push({selector:n?n.toString():"core",style:a})}return t};var H_={};H_.appendFromString=function(t){var e=this,r=this,n=""+t,i,a,s;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function o(){n.length>i.length?n=n.substr(i.length):n=""}function l(){a.length>s.length?a=a.substr(s.length):a=""}for(;;){var u=n.match(/^\s*$/);if(u)break;var c=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!c){Br("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}i=c[0];var f=c[1];if(f!=="core"){var g=new wd(f);if(g.invalid){Br("Skipping parsing of block: Invalid selector found in string stylesheet: "+f),o();continue}}var v=c[2],x=!1;a=v;for(var _=[];;){var S=a.match(/^\s*$/);if(S)break;var N=a.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!N){Br("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+v),x=!0;break}s=N[0];var k=N[1],E=N[2],T=e.properties[k];if(!T){Br("Skipping property: Invalid property name in: "+s),l();continue}var R=r.parse(k,E);if(!R){Br("Skipping property: Invalid property definition in: "+s),l();continue}_.push({name:k,val:E}),l()}if(x){o();break}r.selector(f);for(var j=0;j<_.length;j++){var D=_[j];r.css(D.name,D.val)}o()}return r};H_.fromString=function(t){var e=this;return e.resetToDefault(),e.appendFromString(t),e};var vi={};(function(){var t=Pi,e=M8,r=j8,n=R8,i=L8,a=function(ge){return"^"+ge+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},s=function(ge){var be=t+"|\\w+|"+e+"|"+r+"|"+n+"|"+i;return"^"+ge+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+t+")\\s*\\,\\s*("+t+")\\s*,\\s*("+be+")\\s*\\,\\s*("+be+")\\)$"},o=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];vi.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},scratch:{mapping:!0,regex:a("scratch")},mapData:{mapping:!0,regex:s("mapData")},mapLayoutData:{mapping:!0,regex:s("mapLayoutData")},mapScratch:{mapping:!0,regex:s("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:o,singleRegexMatchValue:!0},urls:{regexes:o,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(ge,be){switch(ge.length){case 2:return be[0]!=="deg"&&be[0]!=="rad"&&be[1]!=="deg"&&be[1]!=="rad";case 1:return Ot(ge[0])||be[0]==="deg"||be[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(ge){var be=ge.length;return be===1||be===2||be===4}}};var l={zeroNonZero:function(ge,be){return(ge==null||be==null)&&ge!==be||ge==0&&be!=0?!0:ge!=0&&be==0},any:function(ge,be){return ge!=be},emptyNonEmpty:function(ge,be){var _e=yd(ge),De=yd(be);return _e&&!De||!_e&&De}},u=vi.types,c=[{name:"label",type:u.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any}],f=[{name:"source-label",type:u.text,triggersBounds:l.any},{name:"source-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:u.size,triggersBounds:l.any}],g=[{name:"target-label",type:u.text,triggersBounds:l.any},{name:"target-text-rotation",type:u.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:u.size,triggersBounds:l.any}],v=[{name:"font-family",type:u.fontFamily,triggersBounds:l.any},{name:"font-style",type:u.fontStyle,triggersBounds:l.any},{name:"font-weight",type:u.fontWeight,triggersBounds:l.any},{name:"font-size",type:u.size,triggersBounds:l.any},{name:"text-transform",type:u.textTransform,triggersBounds:l.any},{name:"text-wrap",type:u.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:u.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:u.size,triggersBounds:l.any},{name:"text-outline-width",type:u.size,triggersBounds:l.any},{name:"line-height",type:u.positiveNumber,triggersBounds:l.any}],x=[{name:"text-valign",type:u.valign,triggersBounds:l.any},{name:"text-halign",type:u.halign,triggersBounds:l.any},{name:"color",type:u.color},{name:"text-outline-color",type:u.color},{name:"text-outline-opacity",type:u.zeroOneNumber},{name:"text-background-color",type:u.color},{name:"text-background-opacity",type:u.zeroOneNumber},{name:"text-background-padding",type:u.size,triggersBounds:l.any},{name:"text-border-opacity",type:u.zeroOneNumber},{name:"text-border-color",type:u.color},{name:"text-border-width",type:u.size,triggersBounds:l.any},{name:"text-border-style",type:u.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:u.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:u.justification},{name:"box-select-labels",type:u.bool,triggersBounds:l.any}],_=[{name:"events",type:u.bool,triggersZOrder:l.any},{name:"text-events",type:u.bool,triggersZOrder:l.any},{name:"box-selection",type:u.boxSelection,triggersZOrder:l.any}],S=[{name:"display",type:u.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfConnectedEdges:l.any,triggersBoundsOfParallelEdges:function(ge,be,_e){return ge===be?!1:_e.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:u.visibility,triggersZOrder:l.any},{name:"opacity",type:u.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:u.zeroOneNumber},{name:"min-zoomed-font-size",type:u.size},{name:"z-compound-depth",type:u.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:u.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:u.number,triggersZOrder:l.any}],N=[{name:"overlay-padding",type:u.size,triggersBounds:l.any},{name:"overlay-color",type:u.color},{name:"overlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"overlay-corner-radius",type:u.cornerRadius}],k=[{name:"underlay-padding",type:u.size,triggersBounds:l.any},{name:"underlay-color",type:u.color},{name:"underlay-opacity",type:u.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:u.overlayShape,triggersBounds:l.any},{name:"underlay-corner-radius",type:u.cornerRadius}],E=[{name:"transition-property",type:u.propList},{name:"transition-duration",type:u.time},{name:"transition-delay",type:u.time},{name:"transition-timing-function",type:u.easing}],T=function(ge,be){return be.value==="label"?-ge.poolIndex():be.pfValue},R=[{name:"height",type:u.nodeSize,triggersBounds:l.any,hashOverride:T},{name:"width",type:u.nodeSize,triggersBounds:l.any,hashOverride:T},{name:"shape",type:u.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:u.polygonPointList,triggersBounds:l.any},{name:"corner-radius",type:u.cornerRadius},{name:"background-color",type:u.color},{name:"background-fill",type:u.fill},{name:"background-opacity",type:u.zeroOneNumber},{name:"background-blacken",type:u.nOneOneNumber},{name:"background-gradient-stop-colors",type:u.colors},{name:"background-gradient-stop-positions",type:u.percentages},{name:"background-gradient-direction",type:u.gradientDirection},{name:"padding",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:u.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:u.boundsExpansion,triggersBounds:l.any}],j=[{name:"border-color",type:u.color},{name:"border-opacity",type:u.zeroOneNumber},{name:"border-width",type:u.size,triggersBounds:l.any},{name:"border-style",type:u.borderStyle},{name:"border-cap",type:u.lineCap},{name:"border-join",type:u.lineJoin},{name:"border-dash-pattern",type:u.numbers},{name:"border-dash-offset",type:u.number},{name:"border-position",type:u.linePosition}],D=[{name:"outline-color",type:u.color},{name:"outline-opacity",type:u.zeroOneNumber},{name:"outline-width",type:u.size,triggersBounds:l.any},{name:"outline-style",type:u.borderStyle},{name:"outline-offset",type:u.size,triggersBounds:l.any}],B=[{name:"background-image",type:u.urls},{name:"background-image-crossorigin",type:u.bgCrossOrigin},{name:"background-image-opacity",type:u.zeroOneNumbers},{name:"background-image-containment",type:u.bgContainment},{name:"background-image-smoothing",type:u.bools},{name:"background-position-x",type:u.bgPos},{name:"background-position-y",type:u.bgPos},{name:"background-width-relative-to",type:u.bgRelativeTo},{name:"background-height-relative-to",type:u.bgRelativeTo},{name:"background-repeat",type:u.bgRepeat},{name:"background-fit",type:u.bgFit},{name:"background-clip",type:u.bgClip},{name:"background-width",type:u.bgWH},{name:"background-height",type:u.bgWH},{name:"background-offset-x",type:u.bgPos},{name:"background-offset-y",type:u.bgPos}],I=[{name:"position",type:u.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:u.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:u.size,triggersBounds:l.any},{name:"min-width-bias-left",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:u.size,triggersBounds:l.any},{name:"min-height-bias-top",type:u.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:u.sizeMaybePercent,triggersBounds:l.any}],V=[{name:"line-style",type:u.lineStyle},{name:"line-color",type:u.color},{name:"line-fill",type:u.fill},{name:"line-cap",type:u.lineCap},{name:"line-opacity",type:u.zeroOneNumber},{name:"line-dash-pattern",type:u.numbers},{name:"line-dash-offset",type:u.number},{name:"line-outline-width",type:u.size},{name:"line-outline-color",type:u.color},{name:"line-gradient-stop-colors",type:u.colors},{name:"line-gradient-stop-positions",type:u.percentages},{name:"curve-style",type:u.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelEdges:function(ge,be){return ge===be?!1:ge==="bezier"||be==="bezier"}},{name:"haystack-radius",type:u.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:u.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:u.size,triggersBounds:l.any},{name:"control-point-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-distances",type:u.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:u.numbers,triggersBounds:l.any},{name:"segment-radii",type:u.numbers,triggersBounds:l.any},{name:"radius-type",type:u.radiusType,triggersBounds:l.any},{name:"taxi-turn",type:u.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:u.size,triggersBounds:l.any},{name:"taxi-direction",type:u.axisDirection,triggersBounds:l.any},{name:"taxi-radius",type:u.number,triggersBounds:l.any},{name:"edge-distances",type:u.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:u.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:u.angle,triggersBounds:l.any},{name:"loop-sweep",type:u.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:u.size,triggersBounds:l.any},{name:"target-distance-from-node",type:u.size,triggersBounds:l.any}],$=[{name:"ghost",type:u.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:u.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:u.zeroOneNumber}],Z=[{name:"selection-box-color",type:u.color},{name:"selection-box-opacity",type:u.zeroOneNumber},{name:"selection-box-border-color",type:u.color},{name:"selection-box-border-width",type:u.size},{name:"active-bg-color",type:u.color},{name:"active-bg-opacity",type:u.zeroOneNumber},{name:"active-bg-size",type:u.size},{name:"outside-texture-bg-color",type:u.color},{name:"outside-texture-bg-opacity",type:u.zeroOneNumber}],O=[];vi.pieBackgroundN=16,O.push({name:"pie-size",type:u.sizeMaybePercent}),O.push({name:"pie-hole",type:u.sizeMaybePercent}),O.push({name:"pie-start-angle",type:u.angle});for(var W=1;W<=vi.pieBackgroundN;W++)O.push({name:"pie-"+W+"-background-color",type:u.color}),O.push({name:"pie-"+W+"-background-size",type:u.percent}),O.push({name:"pie-"+W+"-background-opacity",type:u.zeroOneNumber});var F=[];vi.stripeBackgroundN=16,F.push({name:"stripe-size",type:u.sizeMaybePercent}),F.push({name:"stripe-direction",type:u.axisDirectionPrimary});for(var K=1;K<=vi.stripeBackgroundN;K++)F.push({name:"stripe-"+K+"-background-color",type:u.color}),F.push({name:"stripe-"+K+"-background-size",type:u.percent}),F.push({name:"stripe-"+K+"-background-opacity",type:u.zeroOneNumber});var X=[],Q=vi.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:u.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:u.color},{name:"arrow-fill",type:u.arrowFill},{name:"arrow-width",type:u.arrowWidth}].forEach(function(fe){Q.forEach(function(ge){var be=ge+"-"+fe.name,_e=fe.type,De=fe.triggersBounds;X.push({name:be,type:_e,triggersBounds:De})})},{});var ae=vi.properties=[].concat(_,E,S,N,k,$,x,v,c,f,g,R,j,D,B,O,F,I,V,X,Z),re=vi.propertyGroups={behavior:_,transition:E,visibility:S,overlay:N,underlay:k,ghost:$,commonLabel:x,labelDimensions:v,mainLabel:c,sourceLabel:f,targetLabel:g,nodeBody:R,nodeBorder:j,nodeOutline:D,backgroundImage:B,pie:O,stripe:F,compound:I,edgeLine:V,edgeArrow:X,core:Z},G=vi.propertyGroupNames={},te=vi.propertyGroupKeys=Object.keys(re);te.forEach(function(fe){G[fe]=re[fe].map(function(ge){return ge.name}),re[fe].forEach(function(ge){return ge.groupKey=fe})});var ne=vi.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];vi.propertyNames=ae.map(function(fe){return fe.name});for(var de=0;de<ae.length;de++){var me=ae[de];ae[me.name]=me}for(var ye=0;ye<ne.length;ye++){var ie=ne[ye],pe=ae[ie.pointsTo],oe={name:ie.name,alias:!0,pointsTo:pe};ae.push(oe),ae[ie.name]=oe}})();vi.getDefaultProperty=function(t){return this.getDefaultProperties()[t]};vi.getDefaultProperties=function(){var t=this._private;if(t.defaultProperties!=null)return t.defaultProperties;for(var e=Ut({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=vi.pieBackgroundN;c++){var f=u.name.replace("{{i}}",c),g=u.value;l[f]=g}return l},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(l,u){for(var c=1;c<=vi.stripeBackgroundN;c++){var f=u.name.replace("{{i}}",c),g=u.value;l[f]=g}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(l,u){return vi.arrowPrefixes.forEach(function(c){var f=c+"-"+u.name,g=u.value;l[f]=g}),l},{})),r={},n=0;n<this.properties.length;n++){var i=this.properties[n];if(!i.pointsTo){var a=i.name,s=e[a],o=this.parse(a,s);r[a]=o}}return t.defaultProperties=r,t.defaultProperties};vi.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var Cx={};Cx.parse=function(t,e,r,n){var i=this;if(Bn(e))return i.parseImplWarn(t,e,r,n);var a=n==="mapping"||n===!0||n===!1||n==null?"dontcare":n,s=r?"t":"f",o=""+e,l=R4(t,o,s,a),u=i.propCache=i.propCache||[],c;return(c=u[l])||(c=u[l]=i.parseImplWarn(t,e,r,n)),(r||n==="mapping")&&(c=Xl(c),c&&(c.value=Xl(c.value))),c};Cx.parseImplWarn=function(t,e,r,n){var i=this.parseImpl(t,e,r,n);return!i&&e!=null&&Br("The style property `".concat(t,": ").concat(e,"` is invalid")),i&&(i.name==="width"||i.name==="height")&&e==="label"&&Br("The style value of `label` is deprecated for `"+i.name+"`"),i};Cx.parseImpl=function(t,e,r,n){var i=this;t=N_(t);var a=i.properties[t],s=e,o=i.types;if(!a||e===void 0)return null;a.alias&&(a=a.pointsTo,t=a.name);var l=Ot(e);l&&(e=e.trim());var u=a.type;if(!u)return null;if(r&&(e===""||e===null))return{name:t,value:e,bypass:!0,deleteBypass:!0};if(Bn(e))return{name:t,value:e,strValue:"fn",mapped:o.fn,bypass:r};var c,f;if(!(!l||n||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(c=new RegExp(o.data.regex).exec(e))){if(r)return!1;var g=o.data;return{name:t,value:c,strValue:""+e,mapped:g,field:c[1],bypass:r}}else if(e.length>=10&&e[0]==="m"&&(f=new RegExp(o.mapData.regex).exec(e))){if(r||u.multiple)return!1;var v=o.mapData;if(!(u.color||u.number))return!1;var x=this.parse(t,f[4]);if(!x||x.mapped)return!1;var _=this.parse(t,f[5]);if(!_||_.mapped)return!1;if(x.pfValue===_.pfValue||x.strValue===_.strValue)return Br("`"+t+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+t+": "+x.strValue+"`"),this.parse(t,x.strValue);if(u.color){var S=x.value,N=_.value,k=S[0]===N[0]&&S[1]===N[1]&&S[2]===N[2]&&(S[3]===N[3]||(S[3]==null||S[3]===1)&&(N[3]==null||N[3]===1));if(k)return!1}return{name:t,value:f,strValue:""+e,mapped:v,field:f[1],fieldMin:parseFloat(f[2]),fieldMax:parseFloat(f[3]),valueMin:x.value,valueMax:_.value,bypass:r}}}if(u.multiple&&n!=="multiple"){var E;if(l?E=e.split(/\s+/):tn(e)?E=e:E=[e],u.evenMultiple&&E.length%2!==0)return null;for(var T=[],R=[],j=[],D="",B=!1,I=0;I<E.length;I++){var V=i.parse(t,E[I],r,"multiple");B=B||Ot(V.value),T.push(V.value),j.push(V.pfValue!=null?V.pfValue:V.value),R.push(V.units),D+=(I>0?" ":"")+V.strValue}return u.validate&&!u.validate(T,R)?null:u.singleEnum&&B?T.length===1&&Ot(T[0])?{name:t,value:T[0],strValue:T[0],bypass:r}:null:{name:t,value:T,pfValue:j,strValue:D,bypass:r,units:R}}var $=function(){for(var oe=0;oe<u.enums.length;oe++){var fe=u.enums[oe];if(fe===e)return{name:t,value:e,strValue:""+e,bypass:r}}return null};if(u.number){var Z,O="px";if(u.units&&(Z=u.units),u.implicitUnits&&(O=u.implicitUnits),!u.unitless)if(l){var W="px|em"+(u.allowPercent?"|\\%":"");Z&&(W=Z);var F=e.match("^("+Pi+")("+W+")?$");F&&(e=F[1],Z=F[2]||O)}else(!Z||u.implicitUnits)&&(Z=O);if(e=parseFloat(e),isNaN(e)&&u.enums===void 0)return null;if(isNaN(e)&&u.enums!==void 0)return e=s,$();if(u.integer&&!S8(e)||u.min!==void 0&&(e<u.min||u.strictMin&&e===u.min)||u.max!==void 0&&(e>u.max||u.strictMax&&e===u.max))return null;var K={name:t,value:e,strValue:""+e+(Z||""),units:Z,bypass:r};return u.unitless||Z!=="px"&&Z!=="em"?K.pfValue=e:K.pfValue=Z==="px"||!Z?e:this.getEmSizeInPixels()*e,(Z==="ms"||Z==="s")&&(K.pfValue=Z==="ms"?e:1e3*e),(Z==="deg"||Z==="rad")&&(K.pfValue=Z==="rad"?e:RO(e)),Z==="%"&&(K.pfValue=e/100),K}else if(u.propList){var X=[],Q=""+e;if(Q!=="none"){for(var ae=Q.split(/\s*,\s*|\s+/),re=0;re<ae.length;re++){var G=ae[re].trim();i.properties[G]?X.push(G):Br("`"+G+"` is not a valid property name")}if(X.length===0)return null}return{name:t,value:X,strValue:X.length===0?"none":X.join(" "),bypass:r}}else if(u.color){var te=E4(e);return te?{name:t,value:te,pfValue:te,strValue:"rgb("+te[0]+","+te[1]+","+te[2]+")",bypass:r}:null}else if(u.regex||u.regexes){if(u.enums){var ne=$();if(ne)return ne}for(var de=u.regexes?u.regexes:[u.regex],me=0;me<de.length;me++){var ye=new RegExp(de[me]),ie=ye.exec(e);if(ie)return{name:t,value:u.singleRegexMatchValue?ie[1]:ie,strValue:""+e,bypass:r}}return null}else return u.string?{name:t,value:""+e,strValue:""+e,bypass:r}:u.enums?$():null};var Zi=function(e){if(!(this instanceof Zi))return new Zi(e);if(!E_(e)){jn("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},Ha=Zi.prototype;Ha.instanceString=function(){return"style"};Ha.clear=function(){for(var t=this._private,e=t.cy,r=e.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,t.contextStyles={},t.propDiffs={},this.cleanElements(r,!0),r.forEach(function(i){var a=i[0]._private;a.styleDirty=!0,a.appliedInitStyle=!1}),this};Ha.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Ha.core=function(t){return this._private.coreStyle[t]||this.getDefaultProperty(t)};Ha.selector=function(t){var e=t==="core"?null:new wd(t),r=this.length++;return this[r]={selector:e,properties:[],mappedProperties:[],index:r},this};Ha.css=function(){var t=this,e=arguments;if(e.length===1)for(var r=e[0],n=0;n<t.properties.length;n++){var i=t.properties[n],a=r[i.name];a===void 0&&(a=r[dx(i.name)]),a!==void 0&&this.cssRule(i.name,a)}else e.length===2&&this.cssRule(e[0],e[1]);return this};Ha.style=Ha.css;Ha.cssRule=function(t,e){var r=this.parse(t,e);if(r){var n=this.length-1;this[n].properties.push(r),this[n].properties[r.name]=r,r.name.match(/pie-(\d+)-background-size/)&&r.value&&(this._private.hasPie=!0),r.name.match(/stripe-(\d+)-background-size/)&&r.value&&(this._private.hasStripe=!0),r.mapped&&this[n].mappedProperties.push(r);var i=!this[n].selector;i&&(this._private.coreStyle[r.name]=r)}return this};Ha.append=function(t){return S4(t)?t.appendToStyle(this):tn(t)?this.appendFromJson(t):Ot(t)&&this.appendFromString(t),this};Zi.fromJson=function(t,e){var r=new Zi(t);return r.fromJson(e),r};Zi.fromString=function(t,e){return new Zi(t).fromString(e)};[Qi,hv,U_,Jl,kx,H_,vi,Cx].forEach(function(t){Ut(Ha,t)});Zi.types=Ha.types;Zi.properties=Ha.properties;Zi.propertyGroups=Ha.propertyGroups;Zi.propertyGroupNames=Ha.propertyGroupNames;Zi.propertyGroupKeys=Ha.propertyGroupKeys;var I9={style:function(e){if(e){var r=this.setStyle(e);r.update()}return this._private.style},setStyle:function(e){var r=this._private;return S4(e)?r.style=e.generateStyle(this):tn(e)?r.style=Zi.fromJson(this,e):Ot(e)?r.style=Zi.fromString(this,e):r.style=Zi(this),r.style},updateStyle:function(){this.mutableElements().updateStyle()}},B9="single",Ih={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var r=this._private;if(r.selectionType==null&&(r.selectionType=B9),e!==void 0)(e==="additive"||e==="single")&&(r.selectionType=e);else return r.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,r=this._private.pan,n,i,a,s,o;switch(e.length){case 0:return r;case 1:if(Ot(e[0]))return n=e[0],r[n];if(_r(e[0])){if(!this._private.panningEnabled)return this;a=e[0],s=a.x,o=a.y,dt(s)&&(r.x=s),dt(o)&&(r.y=o),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;n=e[0],i=e[1],(n==="x"||n==="y")&&dt(i)&&(r[n]=i),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,r){var n=arguments,i=this._private.pan,a,s,o,l,u;if(!this._private.panningEnabled)return this;switch(n.length){case 1:_r(e)&&(o=n[0],l=o.x,u=o.y,dt(l)&&(i.x+=l),dt(u)&&(i.y+=u),this.emit("pan viewport"));break;case 2:a=e,s=r,(a==="x"||a==="y")&&dt(s)&&(i[a]+=s),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,r){var n=this.getFitViewport(e,r);if(n){var i=this._private;i.zoom=n.zoom,i.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,r){if(dt(e)&&r===void 0&&(r=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var n;if(Ot(e)){var i=e;e=this.$(i)}else if(E8(e)){var a=e;n={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},n.w=n.x2-n.x1,n.h=n.y2-n.y1}else Ys(e)||(e=this.mutableElements());if(!(Ys(e)&&e.empty())){n=n||e.boundingBox();var s=this.width(),o=this.height(),l;if(r=dt(r)?r:0,!isNaN(s)&&!isNaN(o)&&s>0&&o>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){l=Math.min((s-2*r)/n.w,(o-2*r)/n.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var u={x:(s-l*(n.x1+n.x2))/2,y:(o-l*(n.y1+n.y2))/2};return{zoom:l,pan:u}}}}},zoomRange:function(e,r){var n=this._private;if(r==null){var i=e;e=i.min,r=i.max}return dt(e)&&dt(r)&&e<=r?(n.minZoom=e,n.maxZoom=r):dt(e)&&r===void 0&&e<=n.maxZoom?n.minZoom=e:dt(r)&&e===void 0&&r>=n.minZoom&&(n.maxZoom=r),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var r=this._private,n=r.pan,i=r.zoom,a,s,o=!1;if(r.zoomingEnabled||(o=!0),dt(e)?s=e:_r(e)&&(s=e.level,e.position!=null?a=px(e.position,i,n):e.renderedPosition!=null&&(a=e.renderedPosition),a!=null&&!r.panningEnabled&&(o=!0)),s=s>r.maxZoom?r.maxZoom:s,s=s<r.minZoom?r.minZoom:s,o||!dt(s)||s===i||a!=null&&(!dt(a.x)||!dt(a.y)))return null;if(a!=null){var l=n,u=i,c=s,f={x:-c/u*(a.x-l.x)+a.x,y:-c/u*(a.y-l.y)+a.y};return{zoomed:!0,panned:!0,zoom:c,pan:f}}else return{zoomed:!0,panned:!1,zoom:s,pan:n}},zoom:function(e){if(e===void 0)return this._private.zoom;var r=this.getZoomedViewport(e),n=this._private;return r==null||!r.zoomed?this:(n.zoom=r.zoom,r.panned&&(n.pan.x=r.pan.x,n.pan.y=r.pan.y),this.emit("zoom"+(r.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var r=this._private,n=!0,i=!0,a=[],s=!1,o=!1;if(!e)return this;if(dt(e.zoom)||(n=!1),_r(e.pan)||(i=!1),!n&&!i)return this;if(n){var l=e.zoom;l<r.minZoom||l>r.maxZoom||!r.zoomingEnabled?s=!0:(r.zoom=l,a.push("zoom"))}if(i&&(!s||!e.cancelOnFailedZoom)&&r.panningEnabled){var u=e.pan;dt(u.x)&&(r.pan.x=u.x,o=!1),dt(u.y)&&(r.pan.y=u.y,o=!1),o||a.push("pan")}return a.length>0&&(a.push("viewport"),this.emit(a.join(" ")),this.notify("viewport")),this},center:function(e){var r=this.getCenterPan(e);return r&&(this._private.pan=r,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,r){if(this._private.panningEnabled){if(Ot(e)){var n=e;e=this.mutableElements().filter(n)}else Ys(e)||(e=this.mutableElements());if(e.length!==0){var i=e.boundingBox(),a=this.width(),s=this.height();r=r===void 0?this._private.zoom:r;var o={x:(a-r*(i.x1+i.x2))/2,y:(s-r*(i.y1+i.y2))/2};return o}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,r=e.container,n=this;return e.sizeCache=e.sizeCache||(r?(function(){var i=n.window().getComputedStyle(r),a=function(o){return parseFloat(i.getPropertyValue(o))};return{width:r.clientWidth-a("padding-left")-a("padding-right"),height:r.clientHeight-a("padding-top")-a("padding-bottom")}})():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,r=this._private.zoom,n=this.renderedExtent(),i={x1:(n.x1-e.x)/r,x2:(n.x2-e.x)/r,y1:(n.y1-e.y)/r,y2:(n.y2-e.y)/r};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var e=this.width(),r=this.height();return{x1:0,y1:0,x2:e,y2:r,w:e,h:r}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};Ih.centre=Ih.center;Ih.autolockNodes=Ih.autolock;Ih.autoungrabifyNodes=Ih.autoungrabify;var zg={data:Ir.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:Ir.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:Ir.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Ir.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};zg.attr=zg.data;zg.removeAttr=zg.removeData;var Fg=function(e){var r=this;e=Ut({},e);var n=e.container;n&&!ny(n)&&ny(n[0])&&(n=n[0]);var i=n?n._cyreg:null;i=i||{},i&&i.cy&&(i.cy.destroy(),i={});var a=i.readies=i.readies||[];n&&(n._cyreg=i),i.cy=r;var s=Ti!==void 0&&n!==void 0&&!e.headless,o=e;o.layout=Ut({name:s?"grid":"null"},o.layout),o.renderer=Ut({name:s?"canvas":"null"},o.renderer);var l=function(x,_,S){return _!==void 0?_:S!==void 0?S:x},u=this._private={container:n,ready:!1,options:o,elements:new Sa(this),listeners:[],aniEles:new Sa(this),data:o.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,o.zoomingEnabled),userZoomingEnabled:l(!0,o.userZoomingEnabled),panningEnabled:l(!0,o.panningEnabled),userPanningEnabled:l(!0,o.userPanningEnabled),boxSelectionEnabled:l(!0,o.boxSelectionEnabled),autolock:l(!1,o.autolock,o.autolockNodes),autoungrabify:l(!1,o.autoungrabify,o.autoungrabifyNodes),autounselectify:l(!1,o.autounselectify),styleEnabled:o.styleEnabled===void 0?s:o.styleEnabled,zoom:dt(o.zoom)?o.zoom:1,pan:{x:_r(o.pan)&&dt(o.pan.x)?o.pan.x:0,y:_r(o.pan)&&dt(o.pan.y)?o.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,o.multiClickDebounceTime)};this.createEmitter(),this.selectionType(o.selectionType),this.zoomRange({min:o.minZoom,max:o.maxZoom});var c=function(x,_){var S=x.some(N8);if(S)return Np.all(x).then(_);_(x)};u.styleEnabled&&r.setStyle([]);var f=Ut({},o,o.renderer);r.initRenderer(f);var g=function(x,_,S){r.notifications(!1);var N=r.mutableElements();N.length>0&&N.remove(),x!=null&&(_r(x)||tn(x))&&r.add(x),r.one("layoutready",function(E){r.notifications(!0),r.emit(E),r.one("load",_),r.emitAndNotify("load")}).one("layoutstop",function(){r.one("done",S),r.emit("done")});var k=Ut({},r._private.options.layout);k.eles=r.elements(),r.layout(k).run()};c([o.style,o.elements],function(v){var x=v[0],_=v[1];u.styleEnabled&&r.style().append(x),g(_,function(){r.startAnimationLoop(),u.ready=!0,Bn(o.ready)&&r.on("ready",o.ready);for(var S=0;S<a.length;S++){var N=a[S];r.on("ready",N)}i&&(i.readies=[]),r.emit("ready")},o.done)})},cy=Fg.prototype;Ut(cy,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return Ti;var r=this._private.container.ownerDocument;return r===void 0||r==null?Ti:r.defaultView||Ti},mount:function(e){if(e!=null){var r=this,n=r._private,i=n.options;return!ny(e)&&ny(e[0])&&(e=e[0]),r.stopAnimationLoop(),r.destroyRenderer(),n.container=e,n.styleEnabled=!0,r.invalidateSize(),r.initRenderer(Ut({},i,i.renderer,{name:i.renderer.name==="null"?"canvas":i.renderer.name})),r.startAnimationLoop(),r.style(i.style),r.emit("mount"),r}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return Xl(this._private.options)},json:function(e){var r=this,n=r._private,i=r.mutableElements(),a=function(T){return r.getElementById(T.id())};if(_r(e)){if(r.startBatch(),e.elements){var s={},o=function(T,R){for(var j=[],D=[],B=0;B<T.length;B++){var I=T[B];if(!I.data.id){Br("cy.json() cannot handle elements without an ID attribute");continue}var V=""+I.data.id,$=r.getElementById(V);s[V]=!0,$.length!==0?D.push({ele:$,json:I}):(R&&(I.group=R),j.push(I))}r.add(j);for(var Z=0;Z<D.length;Z++){var O=D[Z],W=O.ele,F=O.json;W.json(F)}};if(tn(e.elements))o(e.elements);else for(var l=["nodes","edges"],u=0;u<l.length;u++){var c=l[u],f=e.elements[c];tn(f)&&o(f,c)}var g=r.collection();i.filter(function(E){return!s[E.id()]}).forEach(function(E){E.isParent()?g.merge(E):E.remove()}),g.forEach(function(E){return E.children().move({parent:null})}),g.forEach(function(E){return a(E).remove()})}e.style&&r.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&r.zoom(e.zoom),e.pan&&(e.pan.x!==n.pan.x||e.pan.y!==n.pan.y)&&r.pan(e.pan),e.data&&r.data(e.data);for(var v=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],x=0;x<v.length;x++){var _=v[x];e[_]!=null&&r[_](e[_])}return r.endBatch(),this}else{var S=!!e,N={};S?N.elements=this.elements().map(function(E){return E.json()}):(N.elements={},i.forEach(function(E){var T=E.group();N.elements[T]||(N.elements[T]=[]),N.elements[T].push(E.json())})),this._private.styleEnabled&&(N.style=r.style().json()),N.data=Xl(r.data());var k=n.options;return N.zoomingEnabled=n.zoomingEnabled,N.userZoomingEnabled=n.userZoomingEnabled,N.zoom=n.zoom,N.minZoom=n.minZoom,N.maxZoom=n.maxZoom,N.panningEnabled=n.panningEnabled,N.userPanningEnabled=n.userPanningEnabled,N.pan=Xl(n.pan),N.boxSelectionEnabled=n.boxSelectionEnabled,N.renderer=Xl(k.renderer),N.hideEdgesOnViewport=k.hideEdgesOnViewport,N.textureOnViewport=k.textureOnViewport,N.wheelSensitivity=k.wheelSensitivity,N.motionBlur=k.motionBlur,N.multiClickDebounceTime=k.multiClickDebounceTime,N}}});cy.$id=cy.getElementById;[N9,j9,SP,k2,V0,L9,C2,U0,I9,Ih,zg].forEach(function(t){Ut(cy,t)});var z9={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}},F9={maximal:!1,acyclic:!1},Of=function(e){return e.scratch("breadthfirst")},JE=function(e,r){return e.scratch("breadthfirst",r)};function kP(t){this.options=Ut({},z9,F9,t)}kP.prototype.run=function(){var t=this.options,e=t.cy,r=t.eles,n=r.nodes().filter(function(ft){return ft.isChildless()}),i=r,a=t.directed,s=t.acyclic||t.maximal||t.maximalAdjustments>0,o=!!t.boundingBox,l=ls(o?t.boundingBox:structuredClone(e.extent())),u;if(Ys(t.roots))u=t.roots;else if(tn(t.roots)){for(var c=[],f=0;f<t.roots.length;f++){var g=t.roots[f],v=e.getElementById(g);c.push(v)}u=e.collection(c)}else if(Ot(t.roots))u=e.$(t.roots);else if(a)u=n.roots();else{var x=r.components();u=e.collection();for(var _=function(){var We=x[S],Ce=We.maxDegree(!1),ze=We.filter(function(Ke){return Ke.degree(!1)===Ce});u=u.add(ze)},S=0;S<x.length;S++)_()}var N=[],k={},E=function(We,Ce){N[Ce]==null&&(N[Ce]=[]);var ze=N[Ce].length;N[Ce].push(We),JE(We,{index:ze,depth:Ce})},T=function(We,Ce){var ze=Of(We),Ke=ze.depth,et=ze.index;N[Ke][et]=null,We.isChildless()&&E(We,Ce)};i.bfs({roots:u,directed:t.directed,visit:function(We,Ce,ze,Ke,et){var ht=We[0],Nt=ht.id();ht.isChildless()&&E(ht,et),k[Nt]=!0}});for(var R=[],j=0;j<n.length;j++){var D=n[j];k[D.id()]||R.push(D)}var B=function(We){for(var Ce=N[We],ze=0;ze<Ce.length;ze++){var Ke=Ce[ze];if(Ke==null){Ce.splice(ze,1),ze--;continue}JE(Ke,{depth:We,index:ze})}},I=function(We,Ce){for(var ze=Of(We),Ke=We.incomers().filter(function(xt){return xt.isNode()&&r.has(xt)}),et=-1,ht=We.id(),Nt=0;Nt<Ke.length;Nt++){var Mt=Ke[Nt],jt=Of(Mt);et=Math.max(et,jt.depth)}if(ze.depth<=et){if(!t.acyclic&&Ce[ht])return null;var Wt=et+1;return T(We,Wt),Ce[ht]=Wt,!0}return!1};if(a&&s){var V=[],$={},Z=function(We){return V.push(We)},O=function(){return V.shift()};for(n.forEach(function(ft){return V.push(ft)});V.length>0;){var W=O(),F=I(W,$);if(F)W.outgoers().filter(function(ft){return ft.isNode()&&r.has(ft)}).forEach(Z);else if(F===null){Br("Detected double maximal shift for node `"+W.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var K=0;if(t.avoidOverlap)for(var X=0;X<n.length;X++){var Q=n[X],ae=Q.layoutDimensions(t),re=ae.w,G=ae.h;K=Math.max(K,re,G)}var te={},ne=function(We){if(te[We.id()])return te[We.id()];for(var Ce=Of(We).depth,ze=We.neighborhood(),Ke=0,et=0,ht=0;ht<ze.length;ht++){var Nt=ze[ht];if(!(Nt.isEdge()||Nt.isParent()||!n.has(Nt))){var Mt=Of(Nt);if(Mt!=null){var jt=Mt.index,Wt=Mt.depth;if(!(jt==null||Wt==null)){var xt=N[Wt].length;Wt<Ce&&(Ke+=jt/xt,et++)}}}}return et=Math.max(1,et),Ke=Ke/et,et===0&&(Ke=0),te[We.id()]=Ke,Ke},de=function(We,Ce){var ze=ne(We),Ke=ne(Ce),et=ze-Ke;return et===0?C4(We.id(),Ce.id()):et};t.depthSort!==void 0&&(de=t.depthSort);for(var me=N.length,ye=0;ye<me;ye++)N[ye].sort(de),B(ye);for(var ie=[],pe=0;pe<R.length;pe++)ie.push(R[pe]);var oe=function(){for(var We=0;We<me;We++)B(We)};ie.length&&(N.unshift(ie),me=N.length,oe());for(var fe=0,ge=0;ge<me;ge++)fe=Math.max(N[ge].length,fe);var be={x:l.x1+l.w/2,y:l.y1+l.h/2},_e=n.reduce(function(ft,We){return(function(Ce){return{w:ft.w===-1?Ce.w:(ft.w+Ce.w)/2,h:ft.h===-1?Ce.h:(ft.h+Ce.h)/2}})(We.boundingBox({includeLabels:t.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),De=Math.max(me===1?0:o?(l.h-t.padding*2-_e.h)/(me-1):(l.h-t.padding*2-_e.h)/(me+1),K),qe=N.reduce(function(ft,We){return Math.max(ft,We.length)},0),Ue=function(We){var Ce=Of(We),ze=Ce.depth,Ke=Ce.index;if(t.circle){var et=Math.min(l.w/2/me,l.h/2/me);et=Math.max(et,K);var ht=et*ze+et-(me>0&&N[0].length<=3?et/2:0),Nt=2*Math.PI/N[ze].length*Ke;return ze===0&&N[0].length===1&&(ht=1),{x:be.x+ht*Math.cos(Nt),y:be.y+ht*Math.sin(Nt)}}else{var Mt=N[ze].length,jt=Math.max(Mt===1?0:o?(l.w-t.padding*2-_e.w)/((t.grid?qe:Mt)-1):(l.w-t.padding*2-_e.w)/((t.grid?qe:Mt)+1),K),Wt={x:be.x+(Ke+1-(Mt+1)/2)*jt,y:be.y+(ze+1-(me+1)/2)*De};return Wt}},Ve={downward:0,leftward:90,upward:180,rightward:-90};Object.keys(Ve).indexOf(t.direction)===-1&&jn("Invalid direction '".concat(t.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(Ve).join(", ")));var Je=function(We){return rO(Ue(We),l,Ve[t.direction])};return r.nodes().layoutPositions(this,t,Je),this};var V9={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function CP(t){this.options=Ut({},V9,t)}CP.prototype.run=function(){var t=this.options,e=t,r=t.cy,n=e.eles,i=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,a=n.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));for(var s=ls(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()}),o={x:s.x1+s.w/2,y:s.y1+s.h/2},l=e.sweep===void 0?2*Math.PI-2*Math.PI/a.length:e.sweep,u=l/Math.max(1,a.length-1),c,f=0,g=0;g<a.length;g++){var v=a[g],x=v.layoutDimensions(e),_=x.w,S=x.h;f=Math.max(f,_,S)}if(dt(e.radius)?c=e.radius:a.length<=1?c=0:c=Math.min(s.h,s.w)/2-f,a.length>1&&e.avoidOverlap){f*=1.75;var N=Math.cos(u)-Math.cos(0),k=Math.sin(u)-Math.sin(0),E=Math.sqrt(f*f/(N*N+k*k));c=Math.max(E,c)}var T=function(j,D){var B=e.startAngle+D*u*(i?1:-1),I=c*Math.cos(B),V=c*Math.sin(B),$={x:o.x+I,y:o.y+V};return $};return n.nodes().layoutPositions(this,e,T),this};var U9={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function EP(t){this.options=Ut({},U9,t)}EP.prototype.run=function(){for(var t=this.options,e=t,r=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,n=t.cy,i=e.eles,a=i.nodes().not(":parent"),s=ls(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),o={x:s.x1+s.w/2,y:s.y1+s.h/2},l=[],u=0,c=0;c<a.length;c++){var f=a[c],g=void 0;g=e.concentric(f),l.push({value:g,node:f}),f._private.scratch.concentric=g}a.updateStyle();for(var v=0;v<a.length;v++){var x=a[v],_=x.layoutDimensions(e);u=Math.max(u,_.w,_.h)}l.sort(function(De,qe){return qe.value-De.value});for(var S=e.levelWidth(a),N=[[]],k=N[0],E=0;E<l.length;E++){var T=l[E];if(k.length>0){var R=Math.abs(k[0].value-T.value);R>=S&&(k=[],N.push(k))}k.push(T)}var j=u+e.minNodeSpacing;if(!e.avoidOverlap){var D=N.length>0&&N[0].length>1,B=Math.min(s.w,s.h)/2-j,I=B/(N.length+D?1:0);j=Math.min(j,I)}for(var V=0,$=0;$<N.length;$++){var Z=N[$],O=e.sweep===void 0?2*Math.PI-2*Math.PI/Z.length:e.sweep,W=Z.dTheta=O/Math.max(1,Z.length-1);if(Z.length>1&&e.avoidOverlap){var F=Math.cos(W)-Math.cos(0),K=Math.sin(W)-Math.sin(0),X=Math.sqrt(j*j/(F*F+K*K));V=Math.max(X,V)}Z.r=V,V+=j}if(e.equidistant){for(var Q=0,ae=0,re=0;re<N.length;re++){var G=N[re],te=G.r-ae;Q=Math.max(Q,te)}ae=0;for(var ne=0;ne<N.length;ne++){var de=N[ne];ne===0&&(ae=de.r),de.r=ae,ae+=Q}}for(var me={},ye=0;ye<N.length;ye++)for(var ie=N[ye],pe=ie.dTheta,oe=ie.r,fe=0;fe<ie.length;fe++){var ge=ie[fe],be=e.startAngle+(r?1:-1)*pe*fe,_e={x:o.x+oe*Math.cos(be),y:o.y+oe*Math.sin(be)};me[ge.node.id()]=_e}return i.nodes().layoutPositions(this,e,function(De){var qe=De.id();return me[qe]}),this};var Jb,H9={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,r){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function Ex(t){this.options=Ut({},H9,t),this.options.layout=this;var e=this.options.eles.nodes(),r=this.options.eles.edges(),n=r.filter(function(i){var a=i.source().data("id"),s=i.target().data("id"),o=e.some(function(u){return u.data("id")===a}),l=e.some(function(u){return u.data("id")===s});return!o||!l});this.options.eles=this.options.eles.not(n)}Ex.prototype.run=function(){var t=this.options,e=t.cy,r=this;r.stopped=!1,(t.animate===!0||t.animate===!1)&&r.emit({type:"layoutstart",layout:r}),t.debug===!0?Jb=!0:Jb=!1;var n=G9(e,r,t);Jb&&W9(n),t.randomize&&$9(n);var i=qu(),a=function(){K9(n,e,t),t.fit===!0&&e.fit(t.padding)},s=function(g){return!(r.stopped||g>=t.numIter||(Z9(n,t),n.temperature=n.temperature*t.coolingFactor,n.temperature<t.minTemp))},o=function(){if(t.animate===!0||t.animate===!1)a(),r.one("layoutstop",t.stop),r.emit({type:"layoutstop",layout:r});else{var g=t.eles.nodes(),v=TP(n,t,g);g.layoutPositions(r,t,v)}},l=0,u=!0;if(t.animate===!0){var c=function(){for(var g=0;u&&g<t.refresh;)u=s(l),l++,g++;if(!u)tN(n,t),o();else{var v=qu();v-i>=t.animationThreshold&&a(),iy(c)}};c()}else{for(;u;)u=s(l),l++;tN(n,t),o()}return this};Ex.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};Ex.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var G9=function(e,r,n){for(var i=n.eles.edges(),a=n.eles.nodes(),s=ls(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),o={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:n.initialTemp,clientWidth:s.w,clientHeight:s.h,boundingBox:s},l=n.eles.components(),u={},c=0;c<l.length;c++)for(var f=l[c],g=0;g<f.length;g++){var v=f[g];u[v.id()]=c}for(var c=0;c<o.nodeSize;c++){var x=a[c],_=x.layoutDimensions(n),S={};S.isLocked=x.locked(),S.id=x.data("id"),S.parentId=x.data("parent"),S.cmptId=u[x.id()],S.children=[],S.positionX=x.position("x"),S.positionY=x.position("y"),S.offsetX=0,S.offsetY=0,S.height=_.w,S.width=_.h,S.maxX=S.positionX+S.width/2,S.minX=S.positionX-S.width/2,S.maxY=S.positionY+S.height/2,S.minY=S.positionY-S.height/2,S.padLeft=parseFloat(x.style("padding")),S.padRight=parseFloat(x.style("padding")),S.padTop=parseFloat(x.style("padding")),S.padBottom=parseFloat(x.style("padding")),S.nodeRepulsion=Bn(n.nodeRepulsion)?n.nodeRepulsion(x):n.nodeRepulsion,o.layoutNodes.push(S),o.idToIndex[S.id]=c}for(var N=[],k=0,E=-1,T=[],c=0;c<o.nodeSize;c++){var x=o.layoutNodes[c],R=x.parentId;R!=null?o.layoutNodes[o.idToIndex[R]].children.push(x.id):(N[++E]=x.id,T.push(x.id))}for(o.graphSet.push(T);k<=E;){var j=N[k++],D=o.idToIndex[j],v=o.layoutNodes[D],B=v.children;if(B.length>0){o.graphSet.push(B);for(var c=0;c<B.length;c++)N[++E]=B[c]}}for(var c=0;c<o.graphSet.length;c++)for(var I=o.graphSet[c],g=0;g<I.length;g++){var V=o.idToIndex[I[g]];o.indexToGraph[V]=c}for(var c=0;c<o.edgeSize;c++){var $=i[c],Z={};Z.id=$.data("id"),Z.sourceId=$.data("source"),Z.targetId=$.data("target");var O=Bn(n.idealEdgeLength)?n.idealEdgeLength($):n.idealEdgeLength,W=Bn(n.edgeElasticity)?n.edgeElasticity($):n.edgeElasticity,F=o.idToIndex[Z.sourceId],K=o.idToIndex[Z.targetId],X=o.indexToGraph[F],Q=o.indexToGraph[K];if(X!=Q){for(var ae=q9(Z.sourceId,Z.targetId,o),re=o.graphSet[ae],G=0,S=o.layoutNodes[F];re.indexOf(S.id)===-1;)S=o.layoutNodes[o.idToIndex[S.parentId]],G++;for(S=o.layoutNodes[K];re.indexOf(S.id)===-1;)S=o.layoutNodes[o.idToIndex[S.parentId]],G++;O*=G*n.nestingFactor}Z.idealLength=O,Z.elasticity=W,o.layoutEdges.push(Z)}return o},q9=function(e,r,n){var i=NP(e,r,0,n);return 2>i.count?0:i.graph},NP=function(e,r,n,i){var a=i.graphSet[n];if(-1<a.indexOf(e)&&-1<a.indexOf(r))return{count:2,graph:n};for(var s=0,o=0;o<a.length;o++){var l=a[o],u=i.idToIndex[l],c=i.layoutNodes[u].children;if(c.length!==0){var f=i.indexToGraph[i.idToIndex[c[0]]],g=NP(e,r,f,i);if(g.count!==0)if(g.count===1){if(s++,s===2)break}else return g}}return{count:s,graph:n}},W9,$9=function(e,r){for(var n=e.clientWidth,i=e.clientHeight,a=0;a<e.nodeSize;a++){var s=e.layoutNodes[a];s.children.length===0&&!s.isLocked&&(s.positionX=Math.random()*n,s.positionY=Math.random()*i)}},TP=function(e,r,n){var i=e.boundingBox,a={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return r.boundingBox&&(n.forEach(function(s){var o=e.layoutNodes[e.idToIndex[s.data("id")]];a.x1=Math.min(a.x1,o.positionX),a.x2=Math.max(a.x2,o.positionX),a.y1=Math.min(a.y1,o.positionY),a.y2=Math.max(a.y2,o.positionY)}),a.w=a.x2-a.x1,a.h=a.y2-a.y1),function(s,o){var l=e.layoutNodes[e.idToIndex[s.data("id")]];if(r.boundingBox){var u=a.w===0?.5:(l.positionX-a.x1)/a.w,c=a.h===0?.5:(l.positionY-a.y1)/a.h;return{x:i.x1+u*i.w,y:i.y1+c*i.h}}else return{x:l.positionX,y:l.positionY}}},K9=function(e,r,n){var i=n.layout,a=n.eles.nodes(),s=TP(e,n,a);a.positions(s),e.ready!==!0&&(e.ready=!0,i.one("layoutready",n.ready),i.emit({type:"layoutready",layout:this}))},Z9=function(e,r,n){Y9(e,r),J9(e),e7(e,r),t7(e),r7(e)},Y9=function(e,r){for(var n=0;n<e.graphSet.length;n++)for(var i=e.graphSet[n],a=i.length,s=0;s<a;s++)for(var o=e.layoutNodes[e.idToIndex[i[s]]],l=s+1;l<a;l++){var u=e.layoutNodes[e.idToIndex[i[l]]];X9(o,u,e,r)}},eN=function(e){return-1+2*e*Math.random()},X9=function(e,r,n,i){var a=e.cmptId,s=r.cmptId;if(!(a!==s&&!n.isCompound)){var o=r.positionX-e.positionX,l=r.positionY-e.positionY,u=1;o===0&&l===0&&(o=eN(u),l=eN(u));var c=Q9(e,r,o,l);if(c>0)var f=i.nodeOverlap*c,g=Math.sqrt(o*o+l*l),v=f*o/g,x=f*l/g;else var _=dy(e,o,l),S=dy(r,-1*o,-1*l),N=S.x-_.x,k=S.y-_.y,E=N*N+k*k,g=Math.sqrt(E),f=(e.nodeRepulsion+r.nodeRepulsion)/E,v=f*N/g,x=f*k/g;e.isLocked||(e.offsetX-=v,e.offsetY-=x),r.isLocked||(r.offsetX+=v,r.offsetY+=x)}},Q9=function(e,r,n,i){if(n>0)var a=e.maxX-r.minX;else var a=r.maxX-e.minX;if(i>0)var s=e.maxY-r.minY;else var s=r.maxY-e.minY;return a>=0&&s>=0?Math.sqrt(a*a+s*s):0},dy=function(e,r,n){var i=e.positionX,a=e.positionY,s=e.height||1,o=e.width||1,l=n/r,u=s/o,c={};return r===0&&0<n||r===0&&0>n?(c.x=i,c.y=a+s/2,c):0<r&&-1*u<=l&&l<=u?(c.x=i+o/2,c.y=a+o*n/2/r,c):0>r&&-1*u<=l&&l<=u?(c.x=i-o/2,c.y=a-o*n/2/r,c):0<n&&(l<=-1*u||l>=u)?(c.x=i+s*r/2/n,c.y=a+s/2,c):(0>n&&(l<=-1*u||l>=u)&&(c.x=i-s*r/2/n,c.y=a-s/2),c)},J9=function(e,r){for(var n=0;n<e.edgeSize;n++){var i=e.layoutEdges[n],a=e.idToIndex[i.sourceId],s=e.layoutNodes[a],o=e.idToIndex[i.targetId],l=e.layoutNodes[o],u=l.positionX-s.positionX,c=l.positionY-s.positionY;if(!(u===0&&c===0)){var f=dy(s,u,c),g=dy(l,-1*u,-1*c),v=g.x-f.x,x=g.y-f.y,_=Math.sqrt(v*v+x*x),S=Math.pow(i.idealLength-_,2)/i.elasticity;if(_!==0)var N=S*v/_,k=S*x/_;else var N=0,k=0;s.isLocked||(s.offsetX+=N,s.offsetY+=k),l.isLocked||(l.offsetX-=N,l.offsetY-=k)}}},e7=function(e,r){if(r.gravity!==0)for(var n=1,i=0;i<e.graphSet.length;i++){var a=e.graphSet[i],s=a.length;if(i===0)var o=e.clientHeight/2,l=e.clientWidth/2;else var u=e.layoutNodes[e.idToIndex[a[0]]],c=e.layoutNodes[e.idToIndex[u.parentId]],o=c.positionX,l=c.positionY;for(var f=0;f<s;f++){var g=e.layoutNodes[e.idToIndex[a[f]]];if(!g.isLocked){var v=o-g.positionX,x=l-g.positionY,_=Math.sqrt(v*v+x*x);if(_>n){var S=r.gravity*v/_,N=r.gravity*x/_;g.offsetX+=S,g.offsetY+=N}}}}},t7=function(e,r){var n=[],i=0,a=-1;for(n.push.apply(n,e.graphSet[0]),a+=e.graphSet[0].length;i<=a;){var s=n[i++],o=e.idToIndex[s],l=e.layoutNodes[o],u=l.children;if(0<u.length&&!l.isLocked){for(var c=l.offsetX,f=l.offsetY,g=0;g<u.length;g++){var v=e.layoutNodes[e.idToIndex[u[g]]];v.offsetX+=c,v.offsetY+=f,n[++a]=u[g]}l.offsetX=0,l.offsetY=0}}},r7=function(e,r){for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];if(!(0<i.children.length||i.isLocked)){var a=n7(i.offsetX,i.offsetY,e.temperature);i.positionX+=a.x,i.positionY+=a.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,PP(i,e)}}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},n7=function(e,r,n){var i=Math.sqrt(e*e+r*r);if(i>n)var a={x:n*e/i,y:n*r/i};else var a={x:e,y:r};return a},PP=function(e,r){var n=e.parentId;if(n!=null){var i=r.layoutNodes[r.idToIndex[n]],a=!1;if((i.maxX==null||e.maxX+i.padRight>i.maxX)&&(i.maxX=e.maxX+i.padRight,a=!0),(i.minX==null||e.minX-i.padLeft<i.minX)&&(i.minX=e.minX-i.padLeft,a=!0),(i.maxY==null||e.maxY+i.padBottom>i.maxY)&&(i.maxY=e.maxY+i.padBottom,a=!0),(i.minY==null||e.minY-i.padTop<i.minY)&&(i.minY=e.minY-i.padTop,a=!0),a)return PP(i,r)}},tN=function(e,r){for(var n=e.layoutNodes,i=[],a=0;a<n.length;a++){var s=n[a],o=s.cmptId,l=i[o]=i[o]||[];l.push(s)}for(var u=0,a=0;a<i.length;a++){var c=i[a];if(c){c.x1=1/0,c.x2=-1/0,c.y1=1/0,c.y2=-1/0;for(var f=0;f<c.length;f++){var g=c[f];c.x1=Math.min(c.x1,g.positionX-g.width/2),c.x2=Math.max(c.x2,g.positionX+g.width/2),c.y1=Math.min(c.y1,g.positionY-g.height/2),c.y2=Math.max(c.y2,g.positionY+g.height/2)}c.w=c.x2-c.x1,c.h=c.y2-c.y1,u+=c.w*c.h}}i.sort(function(k,E){return E.w*E.h-k.w*k.h});for(var v=0,x=0,_=0,S=0,N=Math.sqrt(u)*e.clientWidth/e.clientHeight,a=0;a<i.length;a++){var c=i[a];if(c){for(var f=0;f<c.length;f++){var g=c[f];g.isLocked||(g.positionX+=v-c.x1,g.positionY+=x-c.y1)}v+=c.w+r.componentSpacing,_+=c.w+r.componentSpacing,S=Math.max(S,c.h),_>N&&(x+=S+r.componentSpacing,v=0,_=0,S=0)}}},i7={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function MP(t){this.options=Ut({},i7,t)}MP.prototype.run=function(){var t=this.options,e=t,r=t.cy,n=e.eles,i=n.nodes().not(":parent");e.sort&&(i=i.sort(e.sort));var a=ls(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()});if(a.h===0||a.w===0)n.nodes().layoutPositions(this,e,function(ne){return{x:a.x1,y:a.y1}});else{var s=i.size(),o=Math.sqrt(s*a.h/a.w),l=Math.round(o),u=Math.round(a.w/a.h*o),c=function(de){if(de==null)return Math.min(l,u);var me=Math.min(l,u);me==l?l=de:u=de},f=function(de){if(de==null)return Math.max(l,u);var me=Math.max(l,u);me==l?l=de:u=de},g=e.rows,v=e.cols!=null?e.cols:e.columns;if(g!=null&&v!=null)l=g,u=v;else if(g!=null&&v==null)l=g,u=Math.ceil(s/l);else if(g==null&&v!=null)u=v,l=Math.ceil(s/u);else if(u*l>s){var x=c(),_=f();(x-1)*_>=s?c(x-1):(_-1)*x>=s&&f(_-1)}else for(;u*l<s;){var S=c(),N=f();(N+1)*S>=s?f(N+1):c(S+1)}var k=a.w/u,E=a.h/l;if(e.condense&&(k=0,E=0),e.avoidOverlap)for(var T=0;T<i.length;T++){var R=i[T],j=R._private.position;(j.x==null||j.y==null)&&(j.x=0,j.y=0);var D=R.layoutDimensions(e),B=e.avoidOverlapPadding,I=D.w+B,V=D.h+B;k=Math.max(k,I),E=Math.max(E,V)}for(var $={},Z=function(de,me){return!!$["c-"+de+"-"+me]},O=function(de,me){$["c-"+de+"-"+me]=!0},W=0,F=0,K=function(){F++,F>=u&&(F=0,W++)},X={},Q=0;Q<i.length;Q++){var ae=i[Q],re=e.position(ae);if(re&&(re.row!==void 0||re.col!==void 0)){var G={row:re.row,col:re.col};if(G.col===void 0)for(G.col=0;Z(G.row,G.col);)G.col++;else if(G.row===void 0)for(G.row=0;Z(G.row,G.col);)G.row++;X[ae.id()]=G,O(G.row,G.col)}}var te=function(de,me){var ye,ie;if(de.locked()||de.isParent())return!1;var pe=X[de.id()];if(pe)ye=pe.col*k+k/2+a.x1,ie=pe.row*E+E/2+a.y1;else{for(;Z(W,F);)K();ye=F*k+k/2+a.x1,ie=W*E+E/2+a.y1,O(W,F),K()}return{x:ye,y:ie}};i.layoutPositions(this,e,te)}return this};var a7={ready:function(){},stop:function(){}};function G_(t){this.options=Ut({},a7,t)}G_.prototype.run=function(){var t=this.options,e=t.eles,r=this;return t.cy,r.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),r.one("layoutready",t.ready),r.emit("layoutready"),r.one("layoutstop",t.stop),r.emit("layoutstop"),this};G_.prototype.stop=function(){return this};var s7={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function AP(t){this.options=Ut({},s7,t)}AP.prototype.run=function(){var t=this.options,e=t.eles,r=e.nodes(),n=Bn(t.positions);function i(a){if(t.positions==null)return TO(a.position());if(n)return t.positions(a);var s=t.positions[a._private.data.id];return s??null}return r.layoutPositions(this,t,function(a,s){var o=i(a);return a.locked()||o==null?!1:o}),this};var o7={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function jP(t){this.options=Ut({},o7,t)}jP.prototype.run=function(){var t=this.options,e=t.cy,r=t.eles,n=ls(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),i=function(s,o){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};return r.nodes().layoutPositions(this,t,i),this};var l7=[{name:"breadthfirst",impl:kP},{name:"circle",impl:CP},{name:"concentric",impl:EP},{name:"cose",impl:Ex},{name:"grid",impl:MP},{name:"null",impl:G_},{name:"preset",impl:AP},{name:"random",impl:jP}];function RP(t){this.options=t,this.notifications=0}var rN=function(){},nN=function(){throw new Error("A headless instance can not render images")};RP.prototype={recalculateRenderedStyle:rN,notify:function(){this.notifications++},init:rN,isHeadless:function(){return!0},png:nN,jpg:nN};var q_={};q_.arrowShapeWidth=.3;q_.registerArrowShapes=function(){var t=this.arrowShapes={},e=this,r=function(u,c,f,g,v,x,_){var S=v.x-f/2-_,N=v.x+f/2+_,k=v.y-f/2-_,E=v.y+f/2+_,T=S<=u&&u<=N&&k<=c&&c<=E;return T},n=function(u,c,f,g,v){var x=u*Math.cos(g)-c*Math.sin(g),_=u*Math.sin(g)+c*Math.cos(g),S=x*f,N=_*f,k=S+v.x,E=N+v.y;return{x:k,y:E}},i=function(u,c,f,g){for(var v=[],x=0;x<u.length;x+=2){var _=u[x],S=u[x+1];v.push(n(_,S,c,f,g))}return v},a=function(u){for(var c=[],f=0;f<u.length;f++){var g=u[f];c.push(g.x,g.y)}return c},s=function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").pfValue*2},o=function(u,c){Ot(c)&&(c=t[c]),t[u]=Ut({name:u,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(g,v,x,_,S,N){var k=a(i(this.points,x+2*N,_,S)),E=Ps(g,v,k);return E},roughCollide:r,draw:function(g,v,x,_){var S=i(this.points,v,x,_);e.arrowShapeImpl("polygon")(g,S)},spacing:function(g){return 0},gap:s},c)};o("none",{collide:ay,roughCollide:ay,draw:M_,spacing:vC,gap:vC}),o("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),o("arrow","triangle"),o("triangle-backcurve",{points:t.triangle.points,controlPoint:[0,-.15],roughCollide:r,draw:function(u,c,f,g,v){var x=i(this.points,c,f,g),_=this.controlPoint,S=n(_[0],_[1],c,f,g);e.arrowShapeImpl(this.name)(u,x,S)},gap:function(u){return s(u)*.8}}),o("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(u,c,f,g,v,x,_){var S=a(i(this.points,f+2*_,g,v)),N=a(i(this.pointsTee,f+2*_,g,v)),k=Ps(u,c,S)||Ps(u,c,N);return k},draw:function(u,c,f,g,v){var x=i(this.points,c,f,g),_=i(this.pointsTee,c,f,g);e.arrowShapeImpl(this.name)(u,x,_)}}),o("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(u,c,f,g,v,x,_){var S=v,N=Math.pow(S.x-u,2)+Math.pow(S.y-c,2)<=Math.pow((f+2*_)*this.radius,2),k=a(i(this.points,f+2*_,g,v));return Ps(u,c,k)||N},draw:function(u,c,f,g,v){var x=i(this.pointsTr,c,f,g);e.arrowShapeImpl(this.name)(u,x,g.x,g.y,this.radius*c)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(u,c){var f=this.baseCrossLinePts.slice(),g=c/u,v=3,x=5;return f[v]=f[v]-g,f[x]=f[x]-g,f},collide:function(u,c,f,g,v,x,_){var S=a(i(this.points,f+2*_,g,v)),N=a(i(this.crossLinePts(f,x),f+2*_,g,v)),k=Ps(u,c,S)||Ps(u,c,N);return k},draw:function(u,c,f,g,v){var x=i(this.points,c,f,g),_=i(this.crossLinePts(c,v),c,f,g);e.arrowShapeImpl(this.name)(u,x,_)}}),o("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(u){return s(u)*.525}}),o("circle",{radius:.15,collide:function(u,c,f,g,v,x,_){var S=v,N=Math.pow(S.x-u,2)+Math.pow(S.y-c,2)<=Math.pow((f+2*_)*this.radius,2);return N},draw:function(u,c,f,g,v){e.arrowShapeImpl(this.name)(u,g.x,g.y,this.radius*c)},spacing:function(u){return e.getArrowWidth(u.pstyle("width").pfValue,u.pstyle("arrow-scale").value)*this.radius}}),o("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(u){return 1},gap:function(u){return 1}}),o("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),o("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(u){return u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}}),o("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(u){return .95*u.pstyle("width").pfValue*u.pstyle("arrow-scale").value}})};var Kh={};Kh.projectIntoViewport=function(t,e){var r=this.cy,n=this.findContainerClientCoords(),i=n[0],a=n[1],s=n[4],o=r.pan(),l=r.zoom(),u=((t-i)/s-o.x)/l,c=((e-a)/s-o.y)/l;return[u,c]};Kh.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var t=this.container,e=t.getBoundingClientRect(),r=this.cy.window().getComputedStyle(t),n=function(N){return parseFloat(r.getPropertyValue(N))},i={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")},a={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")},s=t.clientWidth,o=t.clientHeight,l=i.left+i.right,u=i.top+i.bottom,c=a.left+a.right,f=e.width/(s+c),g=s-l,v=o-u,x=e.left+i.left+a.left,_=e.top+i.top+a.top;return this.containerBB=[x,_,g,v,f]};Kh.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Kh.findNearestElement=function(t,e,r,n){return this.findNearestElements(t,e,r,n)[0]};Kh.findNearestElements=function(t,e,r,n){var i=this,a=this,s=a.getCachedZSortedEles(),o=[],l=a.cy.zoom(),u=a.cy.hasCompoundNodes(),c=(n?24:8)/l,f=(n?8:2)/l,g=(n?8:2)/l,v=1/0,x,_;r&&(s=s.interactive);function S(D,B){if(D.isNode()){if(_)return;_=D,o.push(D)}if(D.isEdge()&&(B==null||B<v))if(x){if(x.pstyle("z-compound-depth").value===D.pstyle("z-compound-depth").value&&x.pstyle("z-compound-depth").value===D.pstyle("z-compound-depth").value){for(var I=0;I<o.length;I++)if(o[I].isEdge()){o[I]=D,x=D,v=B??v;break}}}else o.push(D),x=D,v=B??v}function N(D){var B=D.outerWidth()+2*f,I=D.outerHeight()+2*f,V=B/2,$=I/2,Z=D.position(),O=D.pstyle("corner-radius").value==="auto"?"auto":D.pstyle("corner-radius").pfValue,W=D._private.rscratch;if(Z.x-V<=t&&t<=Z.x+V&&Z.y-$<=e&&e<=Z.y+$){var F=a.nodeShapes[i.getNodeShape(D)];if(F.checkPoint(t,e,0,B,I,Z.x,Z.y,O,W))return S(D,0),!0}}function k(D){var B=D._private,I=B.rscratch,V=D.pstyle("width").pfValue,$=D.pstyle("arrow-scale").value,Z=V/2+c,O=Z*Z,W=Z*2,Q=B.source,ae=B.target,F;if(I.edgeType==="segments"||I.edgeType==="straight"||I.edgeType==="haystack"){for(var K=I.allpts,X=0;X+3<K.length;X+=2)if(UO(t,e,K[X],K[X+1],K[X+2],K[X+3],W)&&O>(F=$O(t,e,K[X],K[X+1],K[X+2],K[X+3])))return S(D,F),!0}else if(I.edgeType==="bezier"||I.edgeType==="multibezier"||I.edgeType==="self"||I.edgeType==="compound"){for(var K=I.allpts,X=0;X+5<I.allpts.length;X+=4)if(HO(t,e,K[X],K[X+1],K[X+2],K[X+3],K[X+4],K[X+5],W)&&O>(F=WO(t,e,K[X],K[X+1],K[X+2],K[X+3],K[X+4],K[X+5])))return S(D,F),!0}for(var Q=Q||B.source,ae=ae||B.target,re=i.getArrowWidth(V,$),G=[{name:"source",x:I.arrowStartX,y:I.arrowStartY,angle:I.srcArrowAngle},{name:"target",x:I.arrowEndX,y:I.arrowEndY,angle:I.tgtArrowAngle},{name:"mid-source",x:I.midX,y:I.midY,angle:I.midsrcArrowAngle},{name:"mid-target",x:I.midX,y:I.midY,angle:I.midtgtArrowAngle}],X=0;X<G.length;X++){var te=G[X],ne=a.arrowShapes[D.pstyle(te.name+"-arrow-shape").value],de=D.pstyle("width").pfValue;if(ne.roughCollide(t,e,re,te.angle,{x:te.x,y:te.y},de,c)&&ne.collide(t,e,re,te.angle,{x:te.x,y:te.y},de,c))return S(D),!0}u&&o.length>0&&(N(Q),N(ae))}function E(D,B,I){return Ts(D,B,I)}function T(D,B){var I=D._private,V=g,$;B?$=B+"-":$="",D.boundingBox();var Z=I.labelBounds[B||"main"],O=D.pstyle($+"label").value,W=D.pstyle("text-events").strValue==="yes";if(!(!W||!O)){var F=E(I.rscratch,"labelX",B),K=E(I.rscratch,"labelY",B),X=E(I.rscratch,"labelAngle",B),Q=D.pstyle($+"text-margin-x").pfValue,ae=D.pstyle($+"text-margin-y").pfValue,re=Z.x1-V-Q,G=Z.x2+V-Q,te=Z.y1-V-ae,ne=Z.y2+V-ae;if(X){var de=Math.cos(X),me=Math.sin(X),ye=function(_e,De){return _e=_e-F,De=De-K,{x:_e*de-De*me+F,y:_e*me+De*de+K}},ie=ye(re,te),pe=ye(re,ne),oe=ye(G,te),fe=ye(G,ne),ge=[ie.x+Q,ie.y+ae,oe.x+Q,oe.y+ae,fe.x+Q,fe.y+ae,pe.x+Q,pe.y+ae];if(Ps(t,e,ge))return S(D),!0}else if(ad(Z,t,e))return S(D),!0}}for(var R=s.length-1;R>=0;R--){var j=s[R];j.isNode()?N(j)||T(j):k(j)||T(j)||T(j,"source")||T(j,"target")}return o};Kh.getAllInBox=function(t,e,r,n){var i=this.getCachedZSortedEles().interactive,a=this.cy.zoom(),s=2/a,o=[],l=Math.min(t,r),u=Math.max(t,r),c=Math.min(e,n),f=Math.max(e,n);t=l,r=u,e=c,n=f;var g=ls({x1:t,y1:e,x2:r,y2:n}),v=[{x:g.x1,y:g.y1},{x:g.x2,y:g.y1},{x:g.x2,y:g.y2},{x:g.x1,y:g.y2}],x=[[v[0],v[1]],[v[1],v[2]],[v[2],v[3]],[v[3],v[0]]];function _(_e,De,qe){return Ts(_e,De,qe)}function S(_e,De){var qe=_e._private,Ue=s,Ve="";_e.boundingBox();var Je=qe.labelBounds.main;if(!Je)return null;var ft=_(qe.rscratch,"labelX",De),We=_(qe.rscratch,"labelY",De),Ce=_(qe.rscratch,"labelAngle",De),ze=_e.pstyle(Ve+"text-margin-x").pfValue,Ke=_e.pstyle(Ve+"text-margin-y").pfValue,et=Je.x1-Ue-ze,ht=Je.x2+Ue-ze,Nt=Je.y1-Ue-Ke,Mt=Je.y2+Ue-Ke;if(Ce){var jt=Math.cos(Ce),Wt=Math.sin(Ce),xt=function(Ge,ue){return Ge=Ge-ft,ue=ue-We,{x:Ge*jt-ue*Wt+ft,y:Ge*Wt+ue*jt+We}};return[xt(et,Nt),xt(ht,Nt),xt(ht,Mt),xt(et,Mt)]}else return[{x:et,y:Nt},{x:ht,y:Nt},{x:ht,y:Mt},{x:et,y:Mt}]}function N(_e,De,qe,Ue){function Ve(Je,ft,We){return(We.y-Je.y)*(ft.x-Je.x)>(ft.y-Je.y)*(We.x-Je.x)}return Ve(_e,qe,Ue)!==Ve(De,qe,Ue)&&Ve(_e,De,qe)!==Ve(_e,De,Ue)}for(var k=0;k<i.length;k++){var E=i[k];if(E.isNode()){var T=E,R=T.pstyle("text-events").strValue==="yes",j=T.pstyle("box-selection").strValue,D=T.pstyle("box-select-labels").strValue==="yes";if(j==="none")continue;var B=(j==="overlap"||D)&&R,I=T.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:B});if(j==="contain"){var V=!1;if(D&&R){var $=S(T);$&&X1($,v)&&(o.push(T),V=!0)}!V&&F4(g,I)&&o.push(T)}else if(j==="overlap"&&L_(g,I)){var Z=T.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1}),O=[{x:Z.x1,y:Z.y1},{x:Z.x2,y:Z.y1},{x:Z.x2,y:Z.y2},{x:Z.x1,y:Z.y2}];if(X1(O,v))o.push(T);else{var W=S(T);W&&X1(W,v)&&o.push(T)}}}else{var F=E,K=F._private,X=K.rscratch,Q=F.pstyle("box-selection").strValue;if(Q==="none")continue;if(Q==="contain"){if(X.startX!=null&&X.startY!=null&&!ad(g,X.startX,X.startY)||X.endX!=null&&X.endY!=null&&!ad(g,X.endX,X.endY))continue;if(X.edgeType==="bezier"||X.edgeType==="multibezier"||X.edgeType==="self"||X.edgeType==="compound"||X.edgeType==="segments"||X.edgeType==="haystack"){for(var ae=K.rstyle.bezierPts||K.rstyle.linePts||K.rstyle.haystackPts,re=!0,G=0;G<ae.length;G++)if(!_C(g,ae[G])){re=!1;break}re&&o.push(F)}else X.edgeType==="straight"&&o.push(F)}else if(Q==="overlap"){var te=!1;if(X.startX!=null&&X.startY!=null&&X.endX!=null&&X.endY!=null&&(ad(g,X.startX,X.startY)||ad(g,X.endX,X.endY)))o.push(F),te=!0;else if(!te&&X.edgeType==="haystack"){for(var ne=K.rstyle.haystackPts,de=0;de<ne.length;de++)if(_C(g,ne[de])){o.push(F),te=!0;break}}if(!te){var me=K.rstyle.bezierPts||K.rstyle.linePts||K.rstyle.haystackPts;if((!me||me.length<2)&&X.edgeType==="straight"&&X.startX!=null&&X.startY!=null&&X.endX!=null&&X.endY!=null&&(me=[{x:X.startX,y:X.startY},{x:X.endX,y:X.endY}]),!me||me.length<2)continue;for(var ye=0;ye<me.length-1;ye++){for(var ie=me[ye],pe=me[ye+1],oe=0;oe<x.length;oe++){var fe=yi(x[oe],2),ge=fe[0],be=fe[1];if(N(ie,pe,ge,be)){o.push(F),te=!0;break}}if(te)break}}}}}return o};var hy={};hy.calculateArrowAngles=function(t){var e=t._private.rscratch,r=e.edgeType==="haystack",n=e.edgeType==="bezier",i=e.edgeType==="multibezier",a=e.edgeType==="segments",s=e.edgeType==="compound",o=e.edgeType==="self",l,u,c,f,g,v,N,k;if(r?(c=e.haystackPts[0],f=e.haystackPts[1],g=e.haystackPts[2],v=e.haystackPts[3]):(c=e.arrowStartX,f=e.arrowStartY,g=e.arrowEndX,v=e.arrowEndY),N=e.midX,k=e.midY,a)l=c-e.segpts[0],u=f-e.segpts[1];else if(i||s||o||n){var x=e.allpts,_=Wi(x[0],x[2],x[4],.1),S=Wi(x[1],x[3],x[5],.1);l=c-_,u=f-S}else l=c-N,u=f-k;e.srcArrowAngle=n0(l,u);var N=e.midX,k=e.midY;if(r&&(N=(c+g)/2,k=(f+v)/2),l=g-c,u=v-f,a){var x=e.allpts;if(x.length/2%2===0){var E=x.length/2,T=E-2;l=x[E]-x[T],u=x[E+1]-x[T+1]}else if(e.isRound)l=e.midVector[1],u=-e.midVector[0];else{var E=x.length/2-1,T=E-2;l=x[E]-x[T],u=x[E+1]-x[T+1]}}else if(i||s||o){var x=e.allpts,R=e.ctrlpts,j,D,B,I;if(R.length/2%2===0){var V=x.length/2-1,$=V+2,Z=$+2;j=Wi(x[V],x[$],x[Z],0),D=Wi(x[V+1],x[$+1],x[Z+1],0),B=Wi(x[V],x[$],x[Z],1e-4),I=Wi(x[V+1],x[$+1],x[Z+1],1e-4)}else{var $=x.length/2-1,V=$-2,Z=$+2;j=Wi(x[V],x[$],x[Z],.4999),D=Wi(x[V+1],x[$+1],x[Z+1],.4999),B=Wi(x[V],x[$],x[Z],.5),I=Wi(x[V+1],x[$+1],x[Z+1],.5)}l=B-j,u=I-D}if(e.midtgtArrowAngle=n0(l,u),e.midDispX=l,e.midDispY=u,l*=-1,u*=-1,a){var x=e.allpts;if(x.length/2%2!==0){if(!e.isRound){var E=x.length/2-1,O=E+2;l=-(x[O]-x[E]),u=-(x[O+1]-x[E+1])}}}if(e.midsrcArrowAngle=n0(l,u),a)l=g-e.segpts[e.segpts.length-2],u=v-e.segpts[e.segpts.length-1];else if(i||s||o||n){var x=e.allpts,W=x.length,_=Wi(x[W-6],x[W-4],x[W-2],.9),S=Wi(x[W-5],x[W-3],x[W-1],.9);l=g-_,u=v-S}else l=g-N,u=v-k;e.tgtArrowAngle=n0(l,u)};hy.getArrowWidth=hy.getArrowHeight=function(t,e){var r=this.arrowWidthCache=this.arrowWidthCache||{},n=r[t+", "+e];return n||(n=Math.max(Math.pow(t*13.37,.9),29)*e,r[t+", "+e]=n,n)};var E2,N2,Wl={},_o={},iN,aN,xh,H0,ju,dh,gh,Hl,Df,d0,LP,OP,T2,P2,sN,oN=function(e,r,n){n.x=r.x-e.x,n.y=r.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},u7=function(e,r){r.x=e.x*-1,r.y=e.y*-1,r.nx=e.nx*-1,r.ny=e.ny*-1,r.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},c7=function(e,r,n,i,a){if(e!==sN?oN(r,e,Wl):u7(_o,Wl),oN(r,n,_o),iN=Wl.nx*_o.ny-Wl.ny*_o.nx,aN=Wl.nx*_o.nx-Wl.ny*-_o.ny,ju=Math.asin(Math.max(-1,Math.min(1,iN))),Math.abs(ju)<1e-6){E2=r.x,N2=r.y,gh=Df=0;return}xh=1,H0=!1,aN<0?ju<0?ju=Math.PI+ju:(ju=Math.PI-ju,xh=-1,H0=!0):ju>0&&(xh=-1,H0=!0),r.radius!==void 0?Df=r.radius:Df=i,dh=ju/2,d0=Math.min(Wl.len/2,_o.len/2),a?(Hl=Math.abs(Math.cos(dh)*Df/Math.sin(dh)),Hl>d0?(Hl=d0,gh=Math.abs(Hl*Math.sin(dh)/Math.cos(dh))):gh=Df):(Hl=Math.min(d0,Df),gh=Math.abs(Hl*Math.sin(dh)/Math.cos(dh))),T2=r.x+_o.nx*Hl,P2=r.y+_o.ny*Hl,E2=T2-_o.ny*gh*xh,N2=P2+_o.nx*gh*xh,LP=r.x+Wl.nx*Hl,OP=r.y+Wl.ny*Hl,sN=r};function DP(t,e){e.radius===0?t.lineTo(e.cx,e.cy):t.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function W_(t,e,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return n===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(c7(t,e,r,n,i),{cx:E2,cy:N2,radius:gh,startX:LP,startY:OP,stopX:T2,stopY:P2,startAngle:Wl.ang+Math.PI/2*xh,endAngle:_o.ang-Math.PI/2*xh,counterClockwise:H0})}var Vg=.01,d7=Math.sqrt(2*Vg),qa={};qa.findMidptPtsEtc=function(t,e){var r=e.posPts,n=e.intersectionPts,i=e.vectorNormInverse,a,s=t.pstyle("source-endpoint"),o=t.pstyle("target-endpoint"),l=s.units!=null&&o.units!=null,u=function(R,j,D,B){var I=B-j,V=D-R,$=Math.sqrt(V*V+I*I);return{x:-I/$,y:V/$}},c=t.pstyle("edge-distances").value;switch(c){case"node-position":a=r;break;case"intersection":a=n;break;case"endpoints":{if(l){var f=this.manualEndptToPx(t.source()[0],s),g=yi(f,2),v=g[0],x=g[1],_=this.manualEndptToPx(t.target()[0],o),S=yi(_,2),N=S[0],k=S[1],E={x1:v,y1:x,x2:N,y2:k};i=u(v,x,N,k),a=E}else Br("Edge ".concat(t.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),a=n;break}}return{midptPts:a,vectorNormInverse:i}};qa.findHaystackPoints=function(t){for(var e=0;e<t.length;e++){var r=t[e],n=r._private,i=n.rscratch;if(!i.haystack){var a=Math.random()*2*Math.PI;i.source={x:Math.cos(a),y:Math.sin(a)},a=Math.random()*2*Math.PI,i.target={x:Math.cos(a),y:Math.sin(a)}}var s=n.source,o=n.target,l=s.position(),u=o.position(),c=s.width(),f=o.width(),g=s.height(),v=o.height(),x=r.pstyle("haystack-radius").value,_=x/2;i.haystackPts=i.allpts=[i.source.x*c*_+l.x,i.source.y*g*_+l.y,i.target.x*f*_+u.x,i.target.y*v*_+u.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(r),this.calculateArrowAngles(r),this.recalculateEdgeLabelProjections(r),this.calculateLabelAngles(r)}};qa.findSegmentsPoints=function(t,e){var r=t._private.rscratch,n=t.pstyle("segment-weights"),i=t.pstyle("segment-distances"),a=t.pstyle("segment-radii"),s=t.pstyle("radius-type"),o=Math.min(n.pfValue.length,i.pfValue.length),l=a.pfValue[a.pfValue.length-1],u=s.pfValue[s.pfValue.length-1];r.edgeType="segments",r.segpts=[],r.radii=[],r.isArcRadius=[];for(var c=0;c<o;c++){var f=n.pfValue[c],g=i.pfValue[c],v=1-f,x=f,_=this.findMidptPtsEtc(t,e),S=_.midptPts,N=_.vectorNormInverse,k={x:S.x1*v+S.x2*x,y:S.y1*v+S.y2*x};r.segpts.push(k.x+N.x*g,k.y+N.y*g),r.radii.push(a.pfValue[c]!==void 0?a.pfValue[c]:l),r.isArcRadius.push((s.pfValue[c]!==void 0?s.pfValue[c]:u)==="arc-radius")}};qa.findLoopPoints=function(t,e,r,n){var i=t._private.rscratch,a=e.dirCounts,s=e.srcPos,o=t.pstyle("control-point-distances"),l=o?o.pfValue[0]:void 0,u=t.pstyle("loop-direction").pfValue,c=t.pstyle("loop-sweep").pfValue,f=t.pstyle("control-point-step-size").pfValue;i.edgeType="self";var g=r,v=f;n&&(g=0,v=l);var x=u-Math.PI/2,_=x-c/2,S=x+c/2,N=u+"_"+c;g=a[N]===void 0?a[N]=0:++a[N],i.ctrlpts=[s.x+Math.cos(_)*1.4*v*(g/3+1),s.y+Math.sin(_)*1.4*v*(g/3+1),s.x+Math.cos(S)*1.4*v*(g/3+1),s.y+Math.sin(S)*1.4*v*(g/3+1)]};qa.findCompoundLoopPoints=function(t,e,r,n){var i=t._private.rscratch;i.edgeType="compound";var a=e.srcPos,s=e.tgtPos,o=e.srcW,l=e.srcH,u=e.tgtW,c=e.tgtH,f=t.pstyle("control-point-step-size").pfValue,g=t.pstyle("control-point-distances"),v=g?g.pfValue[0]:void 0,x=r,_=f;n&&(x=0,_=v);var S=50,N={x:a.x-o/2,y:a.y-l/2},k={x:s.x-u/2,y:s.y-c/2},E={x:Math.min(N.x,k.x),y:Math.min(N.y,k.y)},T=.5,R=Math.max(T,Math.log(o*Vg)),j=Math.max(T,Math.log(u*Vg));i.ctrlpts=[E.x,E.y-(1+Math.pow(S,1.12)/100)*_*(x/3+1)*R,E.x-(1+Math.pow(S,1.12)/100)*_*(x/3+1)*j,E.y]};qa.findStraightEdgePoints=function(t){t._private.rscratch.edgeType="straight"};qa.findBezierPoints=function(t,e,r,n,i){var a=t._private.rscratch,s=t.pstyle("control-point-step-size").pfValue,o=t.pstyle("control-point-distances"),l=t.pstyle("control-point-weights"),u=o&&l?Math.min(o.value.length,l.value.length):1,c=o?o.pfValue[0]:void 0,f=l.value[0],g=n;a.edgeType=g?"multibezier":"bezier",a.ctrlpts=[];for(var v=0;v<u;v++){var x=(.5-e.eles.length/2+r)*s*(i?-1:1),_=void 0,S=R_(x);g&&(c=o?o.pfValue[v]:s,f=l.value[v]),n?_=c:_=c!==void 0?S*c:void 0;var N=_!==void 0?_:x,k=1-f,E=f,T=this.findMidptPtsEtc(t,e),R=T.midptPts,j=T.vectorNormInverse,D={x:R.x1*k+R.x2*E,y:R.y1*k+R.y2*E};a.ctrlpts.push(D.x+j.x*N,D.y+j.y*N)}};qa.findTaxiPoints=function(t,e){var r=t._private.rscratch;r.edgeType="segments";var n="vertical",i="horizontal",a="leftward",s="rightward",o="downward",l="upward",u="auto",c=e.posPts,f=e.srcW,g=e.srcH,v=e.tgtW,x=e.tgtH,_=t.pstyle("edge-distances").value,S=_!=="node-position",N=t.pstyle("taxi-direction").value,k=N,E=t.pstyle("taxi-turn"),T=E.units==="%",R=E.pfValue,j=R<0,D=t.pstyle("taxi-turn-min-distance").pfValue,B=S?(f+v)/2:0,I=S?(g+x)/2:0,V=c.x2-c.x1,$=c.y2-c.y1,Z=function(ue,ve){return ue>0?Math.max(ue-ve,0):Math.min(ue+ve,0)},O=Z(V,B),W=Z($,I),F=!1;k===u?N=Math.abs(O)>Math.abs(W)?i:n:k===l||k===o?(N=n,F=!0):(k===a||k===s)&&(N=i,F=!0);var K=N===n,X=K?W:O,Q=K?$:V,ae=R_(Q),re=!1;!(F&&(T||j))&&(k===o&&Q<0||k===l&&Q>0||k===a&&Q>0||k===s&&Q<0)&&(ae*=-1,X=ae*Math.abs(X),re=!0);var G;if(T){var te=R<0?1+R:R;G=te*X}else{var ne=R<0?X:0;G=ne+R*ae}var de=function(ue){return Math.abs(ue)<D||Math.abs(ue)>=Math.abs(X)},me=de(G),ye=de(Math.abs(X)-Math.abs(G)),ie=me||ye;if(ie&&!re)if(K){var pe=Math.abs(Q)<=g/2,oe=Math.abs(V)<=v/2;if(pe){var fe=(c.x1+c.x2)/2,ge=c.y1,be=c.y2;r.segpts=[fe,ge,fe,be]}else if(oe){var _e=(c.y1+c.y2)/2,De=c.x1,qe=c.x2;r.segpts=[De,_e,qe,_e]}else r.segpts=[c.x1,c.y2]}else{var Ue=Math.abs(Q)<=f/2,Ve=Math.abs($)<=x/2;if(Ue){var Je=(c.y1+c.y2)/2,ft=c.x1,We=c.x2;r.segpts=[ft,Je,We,Je]}else if(Ve){var Ce=(c.x1+c.x2)/2,ze=c.y1,Ke=c.y2;r.segpts=[Ce,ze,Ce,Ke]}else r.segpts=[c.x2,c.y1]}else if(K){var et=c.y1+G+(S?g/2*ae:0),ht=c.x1,Nt=c.x2;r.segpts=[ht,et,Nt,et]}else{var Mt=c.x1+G+(S?f/2*ae:0),jt=c.y1,Wt=c.y2;r.segpts=[Mt,jt,Mt,Wt]}if(r.isRound){var xt=t.pstyle("taxi-radius").value,st=t.pstyle("radius-type").value[0]==="arc-radius";r.radii=new Array(r.segpts.length/2).fill(xt),r.isArcRadius=new Array(r.segpts.length/2).fill(st)}};qa.tryToCorrectInvalidPoints=function(t,e){var r=t._private.rscratch;if(r.edgeType==="bezier"){var n=e.srcPos,i=e.tgtPos,a=e.srcW,s=e.srcH,o=e.tgtW,l=e.tgtH,u=e.srcShape,c=e.tgtShape,f=e.srcCornerRadius,g=e.tgtCornerRadius,v=e.srcRs,x=e.tgtRs,_=!dt(r.startX)||!dt(r.startY),S=!dt(r.arrowStartX)||!dt(r.arrowStartY),N=!dt(r.endX)||!dt(r.endY),k=!dt(r.arrowEndX)||!dt(r.arrowEndY),E=3,T=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth,R=E*T,j=Oh({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.startX,y:r.startY}),D=j<R,B=Oh({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.endX,y:r.endY}),I=B<R,V=!1;if(_||S||D){V=!0;var $={x:r.ctrlpts[0]-n.x,y:r.ctrlpts[1]-n.y},Z=Math.sqrt($.x*$.x+$.y*$.y),O={x:$.x/Z,y:$.y/Z},W=Math.max(a,s),F={x:r.ctrlpts[0]+O.x*2*W,y:r.ctrlpts[1]+O.y*2*W},K=u.intersectLine(n.x,n.y,a,s,F.x,F.y,0,f,v);D?(r.ctrlpts[0]=r.ctrlpts[0]+O.x*(R-j),r.ctrlpts[1]=r.ctrlpts[1]+O.y*(R-j)):(r.ctrlpts[0]=K[0]+O.x*R,r.ctrlpts[1]=K[1]+O.y*R)}if(N||k||I){V=!0;var X={x:r.ctrlpts[0]-i.x,y:r.ctrlpts[1]-i.y},Q=Math.sqrt(X.x*X.x+X.y*X.y),ae={x:X.x/Q,y:X.y/Q},re=Math.max(a,s),G={x:r.ctrlpts[0]+ae.x*2*re,y:r.ctrlpts[1]+ae.y*2*re},te=c.intersectLine(i.x,i.y,o,l,G.x,G.y,0,g,x);I?(r.ctrlpts[0]=r.ctrlpts[0]+ae.x*(R-B),r.ctrlpts[1]=r.ctrlpts[1]+ae.y*(R-B)):(r.ctrlpts[0]=te[0]+ae.x*R,r.ctrlpts[1]=te[1]+ae.y*R)}V&&this.findEndpoints(t)}};qa.storeAllpts=function(t){var e=t._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var r=0;r+1<e.ctrlpts.length;r+=2)e.allpts.push(e.ctrlpts[r],e.ctrlpts[r+1]),r+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[r]+e.ctrlpts[r+2])/2,(e.ctrlpts[r+1]+e.ctrlpts[r+3])/2);e.allpts.push(e.endX,e.endY);var n,i;e.ctrlpts.length/2%2===0?(n=e.allpts.length/2-1,e.midX=e.allpts[n],e.midY=e.allpts[n+1]):(n=e.allpts.length/2-3,i=.5,e.midX=Wi(e.allpts[n],e.allpts[n+2],e.allpts[n+4],i),e.midY=Wi(e.allpts[n+1],e.allpts[n+3],e.allpts[n+5],i))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var a=2;a+3<e.allpts.length;a+=2){var s=e.radii[a/2-1],o=e.isArcRadius[a/2-1];e.roundCorners.push(W_({x:e.allpts[a-2],y:e.allpts[a-1]},{x:e.allpts[a],y:e.allpts[a+1],radius:s},{x:e.allpts[a+2],y:e.allpts[a+3]},s,o))}}if(e.segpts.length%4===0){var l=e.segpts.length/2,u=l-2;e.midX=(e.segpts[u]+e.segpts[l])/2,e.midY=(e.segpts[u+1]+e.segpts[l+1])/2}else{var c=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[c],e.midY=e.segpts[c+1];else{var f={x:e.segpts[c],y:e.segpts[c+1]},g=e.roundCorners[c/2];if(g.radius===0){var v={x:e.segpts[c+2],y:e.segpts[c+3]};e.midX=f.x,e.midY=f.y,e.midVector=[f.y-v.y,v.x-f.x]}else{var x=[f.x-g.cx,f.y-g.cy],_=g.radius/Math.sqrt(Math.pow(x[0],2)+Math.pow(x[1],2));x=x.map(function(S){return S*_}),e.midX=g.cx+x[0],e.midY=g.cy+x[1],e.midVector=x}}}}};qa.checkForInvalidEdgeWarning=function(t){var e=t[0]._private.rscratch;e.nodesOverlap||dt(e.startX)&&dt(e.startY)&&dt(e.endX)&&dt(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,Br("Edge `"+t.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};qa.findEdgeControlPoints=function(t){var e=this;if(!(!t||t.length===0)){for(var r=this,n=r.cy,i=n.hasCompoundNodes(),a=new Vu,s=function(I,V){return[].concat(ry(I),[V?1:0]).join("-")},o=[],l=[],u=0;u<t.length;u++){var c=t[u],f=c._private,g=c.pstyle("curve-style").value;if(!(c.removed()||!c.takesUpSpace())){if(g==="haystack"){l.push(c);continue}var v=g==="unbundled-bezier"||nd(g,"segments")||g==="straight"||g==="straight-triangle"||nd(g,"taxi"),x=g==="unbundled-bezier"||g==="bezier",_=f.source,S=f.target,N=_.poolIndex(),k=S.poolIndex(),E=[N,k].sort(),T=s(E,v),R=a.get(T);R==null&&(R={eles:[]},o.push({pairId:E,edgeIsUnbundled:v}),a.set(T,R)),R.eles.push(c),v&&(R.hasUnbundled=!0),x&&(R.hasBezier=!0)}}for(var j=function(){var I=o[D],V=I.pairId,$=I.edgeIsUnbundled,Z=s(V,$),O=a.get(Z),W;if(!O.hasUnbundled){var F=O.eles[0].parallelEdges().filter(function(st){return st.isBundledBezier()});A_(O.eles),F.forEach(function(st){return O.eles.push(st)}),O.eles.sort(function(st,Ge){return st.poolIndex()-Ge.poolIndex()})}var K=O.eles[0],X=K.source(),Q=K.target();if(X.poolIndex()>Q.poolIndex()){var ae=X;X=Q,Q=ae}var re=O.srcPos=X.position(),G=O.tgtPos=Q.position(),te=O.srcW=X.outerWidth(),ne=O.srcH=X.outerHeight(),de=O.tgtW=Q.outerWidth(),me=O.tgtH=Q.outerHeight(),ye=O.srcShape=r.nodeShapes[e.getNodeShape(X)],ie=O.tgtShape=r.nodeShapes[e.getNodeShape(Q)],pe=O.srcCornerRadius=X.pstyle("corner-radius").value==="auto"?"auto":X.pstyle("corner-radius").pfValue,oe=O.tgtCornerRadius=Q.pstyle("corner-radius").value==="auto"?"auto":Q.pstyle("corner-radius").pfValue,fe=O.tgtRs=Q._private.rscratch,ge=O.srcRs=X._private.rscratch;O.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var be=0;be<O.eles.length;be++){var _e=O.eles[be],De=_e[0]._private.rscratch,qe=_e.pstyle("curve-style").value,Ue=qe==="unbundled-bezier"||nd(qe,"segments")||nd(qe,"taxi"),Ve=!X.same(_e.source());if(!O.calculatedIntersection&&X!==Q&&(O.hasBezier||O.hasUnbundled)){O.calculatedIntersection=!0;var Je=ye.intersectLine(re.x,re.y,te,ne,G.x,G.y,0,pe,ge),ft=O.srcIntn=Je,We=ie.intersectLine(G.x,G.y,de,me,re.x,re.y,0,oe,fe),Ce=O.tgtIntn=We,ze=O.intersectionPts={x1:Je[0],x2:We[0],y1:Je[1],y2:We[1]},Ke=O.posPts={x1:re.x,x2:G.x,y1:re.y,y2:G.y},et=We[1]-Je[1],ht=We[0]-Je[0],Nt=Math.sqrt(ht*ht+et*et);dt(Nt)&&Nt>=d7||(Nt=Math.sqrt(Math.max(ht*ht,Vg)+Math.max(et*et,Vg)));var Mt=O.vector={x:ht,y:et},jt=O.vectorNorm={x:Mt.x/Nt,y:Mt.y/Nt},Wt={x:-jt.y,y:jt.x};O.nodesOverlap=!dt(Nt)||ie.checkPoint(Je[0],Je[1],0,de,me,G.x,G.y,oe,fe)||ye.checkPoint(We[0],We[1],0,te,ne,re.x,re.y,pe,ge),O.vectorNormInverse=Wt,W={nodesOverlap:O.nodesOverlap,dirCounts:O.dirCounts,calculatedIntersection:!0,hasBezier:O.hasBezier,hasUnbundled:O.hasUnbundled,eles:O.eles,srcPos:G,srcRs:fe,tgtPos:re,tgtRs:ge,srcW:de,srcH:me,tgtW:te,tgtH:ne,srcIntn:Ce,tgtIntn:ft,srcShape:ie,tgtShape:ye,posPts:{x1:Ke.x2,y1:Ke.y2,x2:Ke.x1,y2:Ke.y1},intersectionPts:{x1:ze.x2,y1:ze.y2,x2:ze.x1,y2:ze.y1},vector:{x:-Mt.x,y:-Mt.y},vectorNorm:{x:-jt.x,y:-jt.y},vectorNormInverse:{x:-Wt.x,y:-Wt.y}}}var xt=Ve?W:O;De.nodesOverlap=xt.nodesOverlap,De.srcIntn=xt.srcIntn,De.tgtIntn=xt.tgtIntn,De.isRound=qe.startsWith("round"),i&&(X.isParent()||X.isChild()||Q.isParent()||Q.isChild())&&(X.parents().anySame(Q)||Q.parents().anySame(X)||X.same(Q)&&X.isParent())?e.findCompoundLoopPoints(_e,xt,be,Ue):X===Q?e.findLoopPoints(_e,xt,be,Ue):qe.endsWith("segments")?e.findSegmentsPoints(_e,xt):qe.endsWith("taxi")?e.findTaxiPoints(_e,xt):qe==="straight"||!Ue&&O.eles.length%2===1&&be===Math.floor(O.eles.length/2)?e.findStraightEdgePoints(_e):e.findBezierPoints(_e,xt,be,Ue,Ve),e.findEndpoints(_e),e.tryToCorrectInvalidPoints(_e,xt),e.checkForInvalidEdgeWarning(_e),e.storeAllpts(_e),e.storeEdgeProjections(_e),e.calculateArrowAngles(_e),e.recalculateEdgeLabelProjections(_e),e.calculateLabelAngles(_e)}},D=0;D<o.length;D++)j();this.findHaystackPoints(l)}};function IP(t){var e=[];if(t!=null){for(var r=0;r<t.length;r+=2){var n=t[r],i=t[r+1];e.push({x:n,y:i})}return e}}qa.getSegmentPoints=function(t){var e=t[0]._private.rscratch;this.recalculateRenderedStyle(t);var r=e.edgeType;if(r==="segments")return IP(e.segpts)};qa.getControlPoints=function(t){var e=t[0]._private.rscratch;this.recalculateRenderedStyle(t);var r=e.edgeType;if(r==="bezier"||r==="multibezier"||r==="self"||r==="compound")return IP(e.ctrlpts)};qa.getEdgeMidpoint=function(t){var e=t[0]._private.rscratch;return this.recalculateRenderedStyle(t),{x:e.midX,y:e.midY}};var fv={};fv.manualEndptToPx=function(t,e){var r=this,n=t.position(),i=t.outerWidth(),a=t.outerHeight(),s=t._private.rscratch;if(e.value.length===2){var o=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(o[0]=o[0]*i),e.units[1]==="%"&&(o[1]=o[1]*a),o[0]+=n.x,o[1]+=n.y,o}else{var l=e.pfValue[0];l=-Math.PI/2+l;var u=2*Math.max(i,a),c=[n.x+Math.cos(l)*u,n.y+Math.sin(l)*u];return r.nodeShapes[this.getNodeShape(t)].intersectLine(n.x,n.y,i,a,c[0],c[1],0,t.pstyle("corner-radius").value==="auto"?"auto":t.pstyle("corner-radius").pfValue,s)}};fv.findEndpoints=function(t){var e,r,n,i,a=this,s,o=t.source()[0],l=t.target()[0],u=o.position(),c=l.position(),f=t.pstyle("target-arrow-shape").value,g=t.pstyle("source-arrow-shape").value,v=t.pstyle("target-distance-from-node").pfValue,x=t.pstyle("source-distance-from-node").pfValue,_=o._private.rscratch,S=l._private.rscratch,N=t.pstyle("curve-style").value,k=t._private.rscratch,E=k.edgeType,T=nd(N,"taxi"),R=E==="self"||E==="compound",j=E==="bezier"||E==="multibezier"||R,D=E!=="bezier",B=E==="straight"||E==="segments",I=E==="segments",V=j||D||B,$=R||T,Z=t.pstyle("source-endpoint"),O=$?"outside-to-node":Z.value,W=o.pstyle("corner-radius").value==="auto"?"auto":o.pstyle("corner-radius").pfValue,F=t.pstyle("target-endpoint"),K=$?"outside-to-node":F.value,X=l.pstyle("corner-radius").value==="auto"?"auto":l.pstyle("corner-radius").pfValue;k.srcManEndpt=Z,k.tgtManEndpt=F;var Q,ae,re,G,te=(e=(F==null||(r=F.pfValue)===null||r===void 0?void 0:r.length)===2?F.pfValue:null)!==null&&e!==void 0?e:[0,0],ne=(n=(Z==null||(i=Z.pfValue)===null||i===void 0?void 0:i.length)===2?Z.pfValue:null)!==null&&n!==void 0?n:[0,0];if(j){var de=[k.ctrlpts[0],k.ctrlpts[1]],me=D?[k.ctrlpts[k.ctrlpts.length-2],k.ctrlpts[k.ctrlpts.length-1]]:de;Q=me,ae=de}else if(B){var ye=I?k.segpts.slice(0,2):[c.x+te[0],c.y+te[1]],ie=I?k.segpts.slice(k.segpts.length-2):[u.x+ne[0],u.y+ne[1]];Q=ie,ae=ye}if(K==="inside-to-node")s=[c.x,c.y];else if(F.units)s=this.manualEndptToPx(l,F);else if(K==="outside-to-line")s=k.tgtIntn;else if(K==="outside-to-node"||K==="outside-to-node-or-label"?re=Q:(K==="outside-to-line"||K==="outside-to-line-or-label")&&(re=[u.x,u.y]),s=a.nodeShapes[this.getNodeShape(l)].intersectLine(c.x,c.y,l.outerWidth(),l.outerHeight(),re[0],re[1],0,X,S),K==="outside-to-node-or-label"||K==="outside-to-line-or-label"){var pe=l._private.rscratch,oe=pe.labelWidth,fe=pe.labelHeight,ge=pe.labelX,be=pe.labelY,_e=oe/2,De=fe/2,qe=l.pstyle("text-valign").value;qe==="top"?be-=De:qe==="bottom"&&(be+=De);var Ue=l.pstyle("text-halign").value;Ue==="left"?ge-=_e:Ue==="right"&&(ge+=_e);var Ve=Dg(re[0],re[1],[ge-_e,be-De,ge+_e,be-De,ge+_e,be+De,ge-_e,be+De],c.x,c.y);if(Ve.length>0){var Je=u,ft=mh(Je,Xf(s)),We=mh(Je,Xf(Ve)),Ce=ft;if(We<ft&&(s=Ve,Ce=We),Ve.length>2){var ze=mh(Je,{x:Ve[2],y:Ve[3]});ze<Ce&&(s=[Ve[2],Ve[3]])}}}var Ke=i0(s,Q,a.arrowShapes[f].spacing(t)+v),et=i0(s,Q,a.arrowShapes[f].gap(t)+v);if(k.endX=et[0],k.endY=et[1],k.arrowEndX=Ke[0],k.arrowEndY=Ke[1],O==="inside-to-node")s=[u.x,u.y];else if(Z.units)s=this.manualEndptToPx(o,Z);else if(O==="outside-to-line")s=k.srcIntn;else if(O==="outside-to-node"||O==="outside-to-node-or-label"?G=ae:(O==="outside-to-line"||O==="outside-to-line-or-label")&&(G=[c.x,c.y]),s=a.nodeShapes[this.getNodeShape(o)].intersectLine(u.x,u.y,o.outerWidth(),o.outerHeight(),G[0],G[1],0,W,_),O==="outside-to-node-or-label"||O==="outside-to-line-or-label"){var ht=o._private.rscratch,Nt=ht.labelWidth,Mt=ht.labelHeight,jt=ht.labelX,Wt=ht.labelY,xt=Nt/2,st=Mt/2,Ge=o.pstyle("text-valign").value;Ge==="top"?Wt-=st:Ge==="bottom"&&(Wt+=st);var ue=o.pstyle("text-halign").value;ue==="left"?jt-=xt:ue==="right"&&(jt+=xt);var ve=Dg(G[0],G[1],[jt-xt,Wt-st,jt+xt,Wt-st,jt+xt,Wt+st,jt-xt,Wt+st],u.x,u.y);if(ve.length>0){var ke=c,Ne=mh(ke,Xf(s)),je=mh(ke,Xf(ve)),Ze=Ne;if(je<Ne&&(s=[ve[0],ve[1]],Ze=je),ve.length>2){var He=mh(ke,{x:ve[2],y:ve[3]});He<Ze&&(s=[ve[2],ve[3]])}}}var ut=i0(s,ae,a.arrowShapes[g].spacing(t)+x),lt=i0(s,ae,a.arrowShapes[g].gap(t)+x);k.startX=lt[0],k.startY=lt[1],k.arrowStartX=ut[0],k.arrowStartY=ut[1],V&&(!dt(k.startX)||!dt(k.startY)||!dt(k.endX)||!dt(k.endY)?k.badLine=!0:k.badLine=!1)};fv.getSourceEndpoint=function(t){var e=t[0]._private.rscratch;return this.recalculateRenderedStyle(t),e.edgeType==="haystack"?{x:e.haystackPts[0],y:e.haystackPts[1]}:{x:e.arrowStartX,y:e.arrowStartY}};fv.getTargetEndpoint=function(t){var e=t[0]._private.rscratch;return this.recalculateRenderedStyle(t),e.edgeType==="haystack"?{x:e.haystackPts[2],y:e.haystackPts[3]}:{x:e.arrowEndX,y:e.arrowEndY}};var $_={};function h7(t,e,r){for(var n=function(u,c,f,g){return Wi(u,c,f,g)},i=e._private,a=i.rstyle.bezierPts,s=0;s<t.bezierProjPcts.length;s++){var o=t.bezierProjPcts[s];a.push({x:n(r[0],r[2],r[4],o),y:n(r[1],r[3],r[5],o)})}}$_.storeEdgeProjections=function(t){var e=t._private,r=e.rscratch,n=r.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){e.rstyle.bezierPts=[];for(var i=0;i+5<r.allpts.length;i+=4)h7(this,t,r.allpts.slice(i,i+6))}else if(n==="segments")for(var a=e.rstyle.linePts=[],i=0;i+1<r.allpts.length;i+=2)a.push({x:r.allpts[i],y:r.allpts[i+1]});else if(n==="haystack"){var s=r.haystackPts;e.rstyle.haystackPts=[{x:s[0],y:s[1]},{x:s[2],y:s[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth};$_.recalculateEdgeProjections=function(t){this.findEdgeControlPoints(t)};var iu={};iu.recalculateNodeLabelProjection=function(t){var e=t.pstyle("label").strValue;if(!yd(e)){var r,n,i=t._private,a=t.width(),s=t.height(),o=t.padding(),l=t.position(),u=t.pstyle("text-halign").strValue,c=t.pstyle("text-valign").strValue,f=i.rscratch,g=i.rstyle;switch(u){case"left":r=l.x-a/2-o;break;case"right":r=l.x+a/2+o;break;default:r=l.x}switch(c){case"top":n=l.y-s/2-o;break;case"bottom":n=l.y+s/2+o;break;default:n=l.y}f.labelX=r,f.labelY=n,g.labelX=r,g.labelY=n,this.calculateLabelAngles(t),this.applyLabelDimensions(t)}};var BP=function(e,r){var n=Math.atan(r/e);return e===0&&n<0&&(n=n*-1),n},zP=function(e,r){var n=r.x-e.x,i=r.y-e.y;return BP(n,i)},f7=function(e,r,n,i){var a=Og(0,i-.001,1),s=Og(0,i+.001,1),o=rp(e,r,n,a),l=rp(e,r,n,s);return zP(o,l)};iu.recalculateEdgeLabelProjections=function(t){var e,r=t._private,n=r.rscratch,i=this,a={mid:t.pstyle("label").strValue,source:t.pstyle("source-label").strValue,target:t.pstyle("target-label").strValue};if(a.mid||a.source||a.target){e={x:n.midX,y:n.midY};var s=function(f,g,v){Fu(r.rscratch,f,g,v),Fu(r.rstyle,f,g,v)};s("labelX",null,e.x),s("labelY",null,e.y);var o=BP(n.midDispX,n.midDispY);s("labelAutoAngle",null,o);var l=function(){if(l.cache)return l.cache;for(var f=[],g=0;g+5<n.allpts.length;g+=4){var v={x:n.allpts[g],y:n.allpts[g+1]},x={x:n.allpts[g+2],y:n.allpts[g+3]},_={x:n.allpts[g+4],y:n.allpts[g+5]};f.push({p0:v,p1:x,p2:_,startDist:0,length:0,segments:[]})}var S=r.rstyle.bezierPts,N=i.bezierProjPcts.length;function k(D,B,I,V,$){var Z=Oh(B,I),O=D.segments[D.segments.length-1],W={p0:B,p1:I,t0:V,t1:$,startDist:O?O.startDist+O.length:0,length:Z};D.segments.push(W),D.length+=Z}for(var E=0;E<f.length;E++){var T=f[E],R=f[E-1];R&&(T.startDist=R.startDist+R.length),k(T,T.p0,S[E*N],0,i.bezierProjPcts[0]);for(var j=0;j<N-1;j++)k(T,S[E*N+j],S[E*N+j+1],i.bezierProjPcts[j],i.bezierProjPcts[j+1]);k(T,S[E*N+N-1],T.p2,i.bezierProjPcts[N-1],1)}return l.cache=f},u=function(f){var g,v=f==="source";if(a[f]){var x=t.pstyle(f+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var _=l(),S,N=0,k=0,E=0;E<_.length;E++){for(var T=_[v?E:_.length-1-E],R=0;R<T.segments.length;R++){var j=T.segments[v?R:T.segments.length-1-R],D=E===_.length-1&&R===T.segments.length-1;if(N=k,k+=j.length,k>=x||D){S={cp:T,segment:j};break}}if(S)break}var B=S.cp,I=S.segment,V=(x-N)/I.length,$=I.t1-I.t0,Z=v?I.t0+$*V:I.t1-$*V;Z=Og(0,Z,1),e=rp(B.p0,B.p1,B.p2,Z),g=f7(B.p0,B.p1,B.p2,Z);break}case"straight":case"segments":case"haystack":{for(var O=0,W,F,K,X,Q=n.allpts.length,ae=0;ae+3<Q&&(v?(K={x:n.allpts[ae],y:n.allpts[ae+1]},X={x:n.allpts[ae+2],y:n.allpts[ae+3]}):(K={x:n.allpts[Q-2-ae],y:n.allpts[Q-1-ae]},X={x:n.allpts[Q-4-ae],y:n.allpts[Q-3-ae]}),W=Oh(K,X),F=O,O+=W,!(O>=x));ae+=2);var re=x-F,G=re/W;G=Og(0,G,1),e=OO(K,X,G),g=zP(K,X);break}}s("labelX",f,e.x),s("labelY",f,e.y),s("labelAutoAngle",f,g)}};u("source"),u("target"),this.applyLabelDimensions(t)}};iu.applyLabelDimensions=function(t){this.applyPrefixedLabelDimensions(t),t.isEdge()&&(this.applyPrefixedLabelDimensions(t,"source"),this.applyPrefixedLabelDimensions(t,"target"))};iu.applyPrefixedLabelDimensions=function(t,e){var r=t._private,n=this.getLabelText(t,e),i=Lh(n,t._private.labelDimsKey);if(Ts(r.rscratch,"prefixedLabelDimsKey",e)!==i){Fu(r.rscratch,"prefixedLabelDimsKey",e,i);var a=this.calculateLabelDimensions(t,n),s=t.pstyle("line-height").pfValue,o=t.pstyle("text-wrap").strValue,l=Ts(r.rscratch,"labelWrapCachedLines",e)||[],u=o!=="wrap"?1:Math.max(l.length,1),c=a.height/u,f=c*s,g=a.width,v=a.height+(u-1)*(s-1)*c;Fu(r.rstyle,"labelWidth",e,g),Fu(r.rscratch,"labelWidth",e,g),Fu(r.rstyle,"labelHeight",e,v),Fu(r.rscratch,"labelHeight",e,v),Fu(r.rscratch,"labelLineHeight",e,f)}};iu.getLabelText=function(t,e){var r=t._private,n=e?e+"-":"",i=t.pstyle(n+"label").strValue,a=t.pstyle("text-transform").value,s=function(ne,de){return de?(Fu(r.rscratch,ne,e,de),de):Ts(r.rscratch,ne,e)};if(!i)return"";a=="none"||(a=="uppercase"?i=i.toUpperCase():a=="lowercase"&&(i=i.toLowerCase()));var o=t.pstyle("text-wrap").value;if(o==="wrap"){var l=s("labelKey");if(l!=null&&s("labelWrapKey")===l)return s("labelWrapCachedText");for(var u="",c=i.split(`
`),f=t.pstyle("text-max-width").pfValue,g=t.pstyle("text-overflow-wrap").value,v=g==="anywhere",x=[],_=/[\s\u200b]+|$/g,S=0;S<c.length;S++){var N=c[S],k=this.calculateLabelDimensions(t,N),E=k.width;if(v){var T=N.split("").join(u);N=T}if(E>f){var R=N.matchAll(_),j="",D=0,B=As(R),I;try{for(B.s();!(I=B.n()).done;){var V=I.value,$=V[0],Z=N.substring(D,V.index);D=V.index+$.length;var O=j.length===0?Z:j+Z+$,W=this.calculateLabelDimensions(t,O),F=W.width;F<=f?j+=Z+$:(j&&x.push(j),j=Z+$)}}catch(te){B.e(te)}finally{B.f()}j.match(/^[\s\u200b]+$/)||x.push(j)}else x.push(N)}s("labelWrapCachedLines",x),i=s("labelWrapCachedText",x.join(`
`)),s("labelWrapKey",l)}else if(o==="ellipsis"){var K=t.pstyle("text-max-width").pfValue,X="",Q="",ae=!1;if(this.calculateLabelDimensions(t,i).width<K)return i;for(var re=0;re<i.length;re++){var G=this.calculateLabelDimensions(t,X+i[re]+Q).width;if(G>K)break;X+=i[re],re===i.length-1&&(ae=!0)}return ae||(X+=Q),X}return i};iu.getLabelJustification=function(t){var e=t.pstyle("text-justification").strValue,r=t.pstyle("text-halign").strValue;if(e==="auto")if(t.isNode())switch(r){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};iu.calculateLabelDimensions=function(t,e){var r=this,n=r.cy.window(),i=n.document,a=0,s=t.pstyle("font-style").strValue,o=t.pstyle("font-size").pfValue,l=t.pstyle("font-family").strValue,u=t.pstyle("font-weight").strValue,c=this.labelCalcCanvas,f=this.labelCalcCanvasContext;if(!c){c=this.labelCalcCanvas=i.createElement("canvas"),f=this.labelCalcCanvasContext=c.getContext("2d");var g=c.style;g.position="absolute",g.left="-9999px",g.top="-9999px",g.zIndex="-1",g.visibility="hidden",g.pointerEvents="none"}f.font="".concat(s," ").concat(u," ").concat(o,"px ").concat(l);for(var v=0,x=0,_=e.split(`
`),S=0;S<_.length;S++){var N=_[S],k=f.measureText(N),E=Math.ceil(k.width),T=o;v=Math.max(E,v),x+=T}return v+=a,x+=a,{width:v,height:x}};iu.calculateLabelAngle=function(t,e){var r=t._private,n=r.rscratch,i=t.isEdge(),a=e?e+"-":"",s=t.pstyle(a+"text-rotation"),o=s.strValue;return o==="none"?0:i&&o==="autorotate"?n.labelAutoAngle:o==="autorotate"?0:s.pfValue};iu.calculateLabelAngles=function(t){var e=this,r=t.isEdge(),n=t._private,i=n.rscratch;i.labelAngle=e.calculateLabelAngle(t),r&&(i.sourceLabelAngle=e.calculateLabelAngle(t,"source"),i.targetLabelAngle=e.calculateLabelAngle(t,"target"))};var FP={},lN=28,uN=!1;FP.getNodeShape=function(t){var e=this,r=t.pstyle("shape").value;if(r==="cutrectangle"&&(t.width()<lN||t.height()<lN))return uN||(Br("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),uN=!0),"rectangle";if(t.isParent())return r==="rectangle"||r==="roundrectangle"||r==="round-rectangle"||r==="cutrectangle"||r==="cut-rectangle"||r==="barrel"?r:"rectangle";if(r==="polygon"){var n=t.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(n).name}return r};var Nx={};Nx.registerCalculationListeners=function(){var t=this.cy,e=t.collection(),r=this,n=function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(s),o)for(var l=0;l<s.length;l++){var u=s[l],c=u._private,f=c.rstyle;f.clean=!1,f.cleanConnected=!1}};r.binder(t).on("bounds.* dirty.*",function(s){var o=s.target;n(o)}).on("style.* background.*",function(s){var o=s.target;n(o,!1)});var i=function(s){if(s){var o=r.onUpdateEleCalcsFns;e.cleanStyle();for(var l=0;l<e.length;l++){var u=e[l],c=u._private.rstyle;u.isNode()&&!c.cleanConnected&&(n(u.connectedEdges()),c.cleanConnected=!0)}if(o)for(var f=0;f<o.length;f++){var g=o[f];g(s,e)}r.recalculateRenderedStyle(e),e=t.collection()}};r.flushRenderedStyleQueue=function(){i(!0)},r.beforeRender(i,r.beforeRenderPriorities.eleCalcs)};Nx.onUpdateEleCalcs=function(t){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(t)};Nx.recalculateRenderedStyle=function(t,e){var r=function(T){return T._private.rstyle.cleanConnected};if(t.length!==0){var n=[],i=[];if(!this.destroyed){e===void 0&&(e=!0);for(var a=0;a<t.length;a++){var s=t[a],o=s._private,l=o.rstyle;s.isEdge()&&(!r(s.source())||!r(s.target()))&&(l.clean=!1),s.isEdge()&&s.isBundledBezier()&&s.parallelEdges().some(function(E){return!E._private.rstyle.clean&&E.isBundledBezier()})&&(l.clean=!1),!(e&&l.clean||s.removed())&&s.pstyle("display").value!=="none"&&(o.group==="nodes"?i.push(s):n.push(s),l.clean=!0)}for(var u=0;u<i.length;u++){var c=i[u],f=c._private,g=f.rstyle,v=c.position();this.recalculateNodeLabelProjection(c),g.nodeX=v.x,g.nodeY=v.y,g.nodeW=c.pstyle("width").pfValue,g.nodeH=c.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var x=0;x<n.length;x++){var _=n[x],S=_._private,N=S.rstyle,k=S.rscratch;N.srcX=k.arrowStartX,N.srcY=k.arrowStartY,N.tgtX=k.arrowEndX,N.tgtY=k.arrowEndY,N.midX=k.midX,N.midY=k.midY,N.labelAngle=k.labelAngle,N.sourceLabelAngle=k.sourceLabelAngle,N.targetLabelAngle=k.targetLabelAngle}}}};var Tx={};Tx.updateCachedGrabbedEles=function(){var t=this.cachedZSortedEles;if(t){t.drag=[],t.nondrag=[];for(var e=[],r=0;r<t.length;r++){var n=t[r],i=n._private.rscratch;n.grabbed()&&!n.isParent()?e.push(n):i.inDragLayer?t.drag.push(n):t.nondrag.push(n)}for(var r=0;r<e.length;r++){var n=e[r];t.drag.push(n)}}};Tx.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};Tx.getCachedZSortedEles=function(t){if(t||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(wP),e.interactive=e.filter(function(r){return r.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var VP={};[Kh,hy,qa,fv,$_,iu,FP,Nx,Tx].forEach(function(t){Ut(VP,t)});var UP={};UP.getCachedImage=function(t,e,r){var n=this,i=n.imageCache=n.imageCache||{},a=i[t];if(a)return a.image.complete||a.image.addEventListener("load",r),a.image;a=i[t]=i[t]||{};var s=a.image=new Image;s.addEventListener("load",r),s.addEventListener("error",function(){s.error=!0});var o="data:",l=t.substring(0,o.length).toLowerCase()===o;return l||(e=e==="null"?null:e,s.crossOrigin=e),s.src=t,s};var Mp={};Mp.registerBinding=function(t,e,r,n){var i=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(t)){for(var a=[],s=0;s<t.length;s++){var o=t[s];if(o!==void 0){var l=this.binder(o);a.push(l.on.apply(l,i))}}return a}var l=this.binder(t);return l.on.apply(l,i)};Mp.binder=function(t){var e=this,r=e.cy.window(),n=t===r||t===r.document||t===r.document.body||C8(t);if(e.supportsPassiveEvents==null){var i=!1;try{var a=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});r.addEventListener("test",null,a)}catch{}e.supportsPassiveEvents=i}var s=function(l,u,c){var f=Array.prototype.slice.call(arguments);return n&&e.supportsPassiveEvents&&(f[2]={capture:c??!1,passive:!1,once:!1}),e.bindings.push({target:t,args:f}),(t.addEventListener||t.on).apply(t,f),this};return{on:s,addEventListener:s,addListener:s,bind:s}};Mp.nodeIsDraggable=function(t){return t&&t.isNode()&&!t.locked()&&t.grabbable()};Mp.nodeIsGrabbable=function(t){return this.nodeIsDraggable(t)&&t.interactive()};Mp.load=function(){var t=this,e=t.cy.window(),r=function(ue){return ue.selected()},n=function(ue){var ve=ue.getRootNode();if(ve&&ve.nodeType===11&&ve.host!==void 0)return ve},i=function(ue,ve,ke,Ne){ue==null&&(ue=t.cy);for(var je=0;je<ve.length;je++){var Ze=ve[je];ue.emit({originalEvent:ke,type:Ze,position:Ne})}},a=function(ue){return ue.shiftKey||ue.metaKey||ue.ctrlKey},s=function(ue,ve){var ke=!0;if(t.cy.hasCompoundNodes()&&ue&&ue.pannable())for(var Ne=0;ve&&Ne<ve.length;Ne++){var ue=ve[Ne];if(ue.isNode()&&ue.isParent()&&!ue.pannable()){ke=!1;break}}else ke=!0;return ke},o=function(ue){ue[0]._private.grabbed=!0},l=function(ue){ue[0]._private.grabbed=!1},u=function(ue){ue[0]._private.rscratch.inDragLayer=!0},c=function(ue){ue[0]._private.rscratch.inDragLayer=!1},f=function(ue){ue[0]._private.rscratch.isGrabTarget=!0},g=function(ue){ue[0]._private.rscratch.isGrabTarget=!1},v=function(ue,ve){var ke=ve.addToList,Ne=ke.has(ue);!Ne&&ue.grabbable()&&!ue.locked()&&(ke.merge(ue),o(ue))},x=function(ue,ve){if(ue.cy().hasCompoundNodes()&&!(ve.inDragLayer==null&&ve.addToList==null)){var ke=ue.descendants();ve.inDragLayer&&(ke.forEach(u),ke.connectedEdges().forEach(u)),ve.addToList&&v(ke,ve)}},_=function(ue,ve){ve=ve||{};var ke=ue.cy().hasCompoundNodes();ve.inDragLayer&&(ue.forEach(u),ue.neighborhood().stdFilter(function(Ne){return!ke||Ne.isEdge()}).forEach(u)),ve.addToList&&ue.forEach(function(Ne){v(Ne,ve)}),x(ue,ve),k(ue,{inDragLayer:ve.inDragLayer}),t.updateCachedGrabbedEles()},S=_,N=function(ue){ue&&(t.getCachedZSortedEles().forEach(function(ve){l(ve),c(ve),g(ve)}),t.updateCachedGrabbedEles())},k=function(ue,ve){if(!(ve.inDragLayer==null&&ve.addToList==null)&&ue.cy().hasCompoundNodes()){var ke=ue.ancestors().orphans();if(!ke.same(ue)){var Ne=ke.descendants().spawnSelf().merge(ke).unmerge(ue).unmerge(ue.descendants()),je=Ne.connectedEdges();ve.inDragLayer&&(je.forEach(u),Ne.forEach(u)),ve.addToList&&Ne.forEach(function(Ze){v(Ze,ve)})}}},E=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},T=typeof MutationObserver<"u",R=typeof ResizeObserver<"u";T?(t.removeObserver=new MutationObserver(function(Ge){for(var ue=0;ue<Ge.length;ue++){var ve=Ge[ue],ke=ve.removedNodes;if(ke)for(var Ne=0;Ne<ke.length;Ne++){var je=ke[Ne];if(je===t.container){t.destroy();break}}}}),t.container.parentNode&&t.removeObserver.observe(t.container.parentNode,{childList:!0})):t.registerBinding(t.container,"DOMNodeRemoved",function(Ge){t.destroy()});var j=uv(function(){t.cy.resize()},100);T&&(t.styleObserver=new MutationObserver(j),t.styleObserver.observe(t.container,{attributes:!0})),t.registerBinding(e,"resize",j),R&&(t.resizeObserver=new ResizeObserver(j),t.resizeObserver.observe(t.container));var D=function(ue,ve){for(;ue!=null;)ve(ue),ue=ue.parentNode},B=function(){t.invalidateContainerClientCoordsCache()};D(t.container,function(Ge){t.registerBinding(Ge,"transitionend",B),t.registerBinding(Ge,"animationend",B),t.registerBinding(Ge,"scroll",B)}),t.registerBinding(t.container,"contextmenu",function(Ge){Ge.preventDefault()});var I=function(){return t.selection[4]!==0},V=function(ue){for(var ve=t.findContainerClientCoords(),ke=ve[0],Ne=ve[1],je=ve[2],Ze=ve[3],He=ue.touches?ue.touches:[ue],ut=!1,lt=0;lt<He.length;lt++){var _t=He[lt];if(ke<=_t.clientX&&_t.clientX<=ke+je&&Ne<=_t.clientY&&_t.clientY<=Ne+Ze){ut=!0;break}}if(!ut)return!1;for(var Bt=t.container,zt=ue.target,vt=zt.parentNode,Ht=!1;vt;){if(vt===Bt){Ht=!0;break}vt=vt.parentNode}return!!Ht};t.registerBinding(t.container,"mousedown",function(ue){if(V(ue)&&!(t.hoverData.which===1&&ue.which!==1)){ue.preventDefault(),E(),t.hoverData.capture=!0,t.hoverData.which=ue.which;var ve=t.cy,ke=[ue.clientX,ue.clientY],Ne=t.projectIntoViewport(ke[0],ke[1]),je=t.selection,Ze=t.findNearestElements(Ne[0],Ne[1],!0,!1),He=Ze[0],ut=t.dragData.possibleDragElements;t.hoverData.mdownPos=Ne,t.hoverData.mdownGPos=ke;var lt=function(qt){return{originalEvent:ue,type:qt,position:{x:Ne[0],y:Ne[1]}}},_t=function(){t.hoverData.tapholdCancelled=!1,clearTimeout(t.hoverData.tapholdTimeout),t.hoverData.tapholdTimeout=setTimeout(function(){if(!t.hoverData.tapholdCancelled){var qt=t.hoverData.down;qt?qt.emit(lt("taphold")):ve.emit(lt("taphold"))}},t.tapholdDuration)};if(ue.which==3){t.hoverData.cxtStarted=!0;var Bt={originalEvent:ue,type:"cxttapstart",position:{x:Ne[0],y:Ne[1]}};He?(He.activate(),He.emit(Bt),t.hoverData.down=He):ve.emit(Bt),t.hoverData.downTime=new Date().getTime(),t.hoverData.cxtDragged=!1}else if(ue.which==1){He&&He.activate();{if(He!=null&&t.nodeIsGrabbable(He)){var zt=function(qt){qt.emit(lt("grab"))};if(f(He),!He.selected())ut=t.dragData.possibleDragElements=ve.collection(),S(He,{addToList:ut}),He.emit(lt("grabon")).emit(lt("grab"));else{ut=t.dragData.possibleDragElements=ve.collection();var vt=ve.$(function(Ht){return Ht.isNode()&&Ht.selected()&&t.nodeIsGrabbable(Ht)});_(vt,{addToList:ut}),He.emit(lt("grabon")),vt.forEach(zt)}t.redrawHint("eles",!0),t.redrawHint("drag",!0)}t.hoverData.down=He,t.hoverData.downs=Ze,t.hoverData.downTime=new Date().getTime()}i(He,["mousedown","tapstart","vmousedown"],ue,{x:Ne[0],y:Ne[1]}),He==null?(je[4]=1,t.data.bgActivePosistion={x:Ne[0],y:Ne[1]},t.redrawHint("select",!0),t.redraw()):He.pannable()&&(je[4]=1),_t()}je[0]=je[2]=Ne[0],je[1]=je[3]=Ne[1]}},!1);var $=n(t.container);t.registerBinding([e,$],"mousemove",function(ue){var ve=t.hoverData.capture;if(!(!ve&&!V(ue))){var ke=!1,Ne=t.cy,je=Ne.zoom(),Ze=[ue.clientX,ue.clientY],He=t.projectIntoViewport(Ze[0],Ze[1]),ut=t.hoverData.mdownPos,lt=t.hoverData.mdownGPos,_t=t.selection,Bt=null;!t.hoverData.draggingEles&&!t.hoverData.dragging&&!t.hoverData.selecting&&(Bt=t.findNearestElement(He[0],He[1],!0,!1));var zt=t.hoverData.last,vt=t.hoverData.down,Ht=[He[0]-_t[2],He[1]-_t[3]],qt=t.dragData.possibleDragElements,Sr;if(lt){var fr=Ze[0]-lt[0],fn=fr*fr,Gr=Ze[1]-lt[1],qr=Gr*Gr,nn=fn+qr;t.hoverData.isOverThresholdDrag=Sr=nn>=t.desktopTapThreshold2}var ur=a(ue);Sr&&(t.hoverData.tapholdCancelled=!0);var yt=function(){var wi=t.hoverData.dragDelta=t.hoverData.dragDelta||[];wi.length===0?(wi.push(Ht[0]),wi.push(Ht[1])):(wi[0]+=Ht[0],wi[1]+=Ht[1])};ke=!0,i(Bt,["mousemove","vmousemove","tapdrag"],ue,{x:He[0],y:He[1]});var Lr=function(wi){return{originalEvent:ue,type:wi,position:{x:He[0],y:He[1]}}},Yn=function(){t.data.bgActivePosistion=void 0,t.hoverData.selecting||Ne.emit(Lr("boxstart")),_t[4]=1,t.hoverData.selecting=!0,t.redrawHint("select",!0),t.redraw()};if(t.hoverData.which===3){if(Sr){var Na=Lr("cxtdrag");vt?vt.emit(Na):Ne.emit(Na),t.hoverData.cxtDragged=!0,(!t.hoverData.cxtOver||Bt!==t.hoverData.cxtOver)&&(t.hoverData.cxtOver&&t.hoverData.cxtOver.emit(Lr("cxtdragout")),t.hoverData.cxtOver=Bt,Bt&&Bt.emit(Lr("cxtdragover")))}}else if(t.hoverData.dragging){if(ke=!0,Ne.panningEnabled()&&Ne.userPanningEnabled()){var Ds;if(t.hoverData.justStartedPan){var Js=t.hoverData.mdownPos;Ds={x:(He[0]-Js[0])*je,y:(He[1]-Js[1])*je},t.hoverData.justStartedPan=!1}else Ds={x:Ht[0]*je,y:Ht[1]*je};Ne.panBy(Ds),Ne.emit(Lr("dragpan")),t.hoverData.dragged=!0}He=t.projectIntoViewport(ue.clientX,ue.clientY)}else if(_t[4]==1&&(vt==null||vt.pannable())){if(Sr){if(!t.hoverData.dragging&&Ne.boxSelectionEnabled()&&(ur||!Ne.panningEnabled()||!Ne.userPanningEnabled()))Yn();else if(!t.hoverData.selecting&&Ne.panningEnabled()&&Ne.userPanningEnabled()){var ui=s(vt,t.hoverData.downs);ui&&(t.hoverData.dragging=!0,t.hoverData.justStartedPan=!0,_t[4]=0,t.data.bgActivePosistion=Xf(ut),t.redrawHint("select",!0),t.redraw())}vt&&vt.pannable()&&vt.active()&&vt.unactivate()}}else{if(vt&&vt.pannable()&&vt.active()&&vt.unactivate(),(!vt||!vt.grabbed())&&Bt!=zt&&(zt&&i(zt,["mouseout","tapdragout"],ue,{x:He[0],y:He[1]}),Bt&&i(Bt,["mouseover","tapdragover"],ue,{x:He[0],y:He[1]}),t.hoverData.last=Bt),vt)if(Sr){if(Ne.boxSelectionEnabled()&&ur)vt&&vt.grabbed()&&(N(qt),vt.emit(Lr("freeon")),qt.emit(Lr("free")),t.dragData.didDrag&&(vt.emit(Lr("dragfreeon")),qt.emit(Lr("dragfree")))),Yn();else if(vt&&vt.grabbed()&&t.nodeIsDraggable(vt)){var an=!t.dragData.didDrag;an&&t.redrawHint("eles",!0),t.dragData.didDrag=!0,t.hoverData.draggingEles||_(qt,{inDragLayer:!0});var xn={x:0,y:0};if(dt(Ht[0])&&dt(Ht[1])&&(xn.x+=Ht[0],xn.y+=Ht[1],an)){var ci=t.hoverData.dragDelta;ci&&dt(ci[0])&&dt(ci[1])&&(xn.x+=ci[0],xn.y+=ci[1])}t.hoverData.draggingEles=!0,qt.silentShift(xn).emit(Lr("position")).emit(Lr("drag")),t.redrawHint("drag",!0),t.redraw()}}else yt();ke=!0}if(_t[2]=He[0],_t[3]=He[1],ke)return ue.stopPropagation&&ue.stopPropagation(),ue.preventDefault&&ue.preventDefault(),!1}},!1);var Z,O,W;t.registerBinding(e,"mouseup",function(ue){if(!(t.hoverData.which===1&&ue.which!==1&&t.hoverData.capture)){var ve=t.hoverData.capture;if(ve){t.hoverData.capture=!1;var ke=t.cy,Ne=t.projectIntoViewport(ue.clientX,ue.clientY),je=t.selection,Ze=t.findNearestElement(Ne[0],Ne[1],!0,!1),He=t.dragData.possibleDragElements,ut=t.hoverData.down,lt=a(ue);t.data.bgActivePosistion&&(t.redrawHint("select",!0),t.redraw()),t.hoverData.tapholdCancelled=!0,t.data.bgActivePosistion=void 0,ut&&ut.unactivate();var _t=function(fr){return{originalEvent:ue,type:fr,position:{x:Ne[0],y:Ne[1]}}};if(t.hoverData.which===3){var Bt=_t("cxttapend");if(ut?ut.emit(Bt):ke.emit(Bt),!t.hoverData.cxtDragged){var zt=_t("cxttap");ut?ut.emit(zt):ke.emit(zt)}t.hoverData.cxtDragged=!1,t.hoverData.which=null}else if(t.hoverData.which===1){if(i(Ze,["mouseup","tapend","vmouseup"],ue,{x:Ne[0],y:Ne[1]}),!t.dragData.didDrag&&!t.hoverData.dragged&&!t.hoverData.selecting&&!t.hoverData.isOverThresholdDrag&&(i(ut,["click","tap","vclick"],ue,{x:Ne[0],y:Ne[1]}),O=!1,ue.timeStamp-W<=ke.multiClickDebounceTime()?(Z&&clearTimeout(Z),O=!0,W=null,i(ut,["dblclick","dbltap","vdblclick"],ue,{x:Ne[0],y:Ne[1]})):(Z=setTimeout(function(){O||i(ut,["oneclick","onetap","voneclick"],ue,{x:Ne[0],y:Ne[1]})},ke.multiClickDebounceTime()),W=ue.timeStamp)),ut==null&&!t.dragData.didDrag&&!t.hoverData.selecting&&!t.hoverData.dragged&&!a(ue)&&(ke.$(r).unselect(["tapunselect"]),He.length>0&&t.redrawHint("eles",!0),t.dragData.possibleDragElements=He=ke.collection()),Ze==ut&&!t.dragData.didDrag&&!t.hoverData.selecting&&Ze!=null&&Ze._private.selectable&&(t.hoverData.dragging||(ke.selectionType()==="additive"||lt?Ze.selected()?Ze.unselect(["tapunselect"]):Ze.select(["tapselect"]):lt||(ke.$(r).unmerge(Ze).unselect(["tapunselect"]),Ze.select(["tapselect"]))),t.redrawHint("eles",!0)),t.hoverData.selecting){var vt=ke.collection(t.getAllInBox(je[0],je[1],je[2],je[3]));t.redrawHint("select",!0),vt.length>0&&t.redrawHint("eles",!0),ke.emit(_t("boxend"));var Ht=function(fr){return fr.selectable()&&!fr.selected()};ke.selectionType()==="additive"||lt||ke.$(r).unmerge(vt).unselect(),vt.emit(_t("box")).stdFilter(Ht).select().emit(_t("boxselect")),t.redraw()}if(t.hoverData.dragging&&(t.hoverData.dragging=!1,t.redrawHint("select",!0),t.redrawHint("eles",!0),t.redraw()),!je[4]){t.redrawHint("drag",!0),t.redrawHint("eles",!0);var qt=ut&&ut.grabbed();N(He),qt&&(ut.emit(_t("freeon")),He.emit(_t("free")),t.dragData.didDrag&&(ut.emit(_t("dragfreeon")),He.emit(_t("dragfree"))))}}je[4]=0,t.hoverData.down=null,t.hoverData.cxtStarted=!1,t.hoverData.draggingEles=!1,t.hoverData.selecting=!1,t.hoverData.isOverThresholdDrag=!1,t.dragData.didDrag=!1,t.hoverData.dragged=!1,t.hoverData.dragDelta=[],t.hoverData.mdownPos=null,t.hoverData.mdownGPos=null,t.hoverData.which=null}}},!1);var F=[],K=4,X,Q=1e5,ae=function(ue,ve){for(var ke=0;ke<ue.length;ke++)if(ue[ke]%ve!==0)return!1;return!0},re=function(ue){for(var ve=Math.abs(ue[0]),ke=1;ke<ue.length;ke++)if(Math.abs(ue[ke])!==ve)return!1;return!0},G=function(ue){var ve=!1,ke=ue.deltaY;if(ke==null&&(ue.wheelDeltaY!=null?ke=ue.wheelDeltaY/4:ue.wheelDelta!=null&&(ke=ue.wheelDelta/4)),ke!==0){if(X==null)if(F.length>=K){var Ne=F;if(X=ae(Ne,5),!X){var je=Math.abs(Ne[0]);X=re(Ne)&&je>5}if(X)for(var Ze=0;Ze<Ne.length;Ze++)Q=Math.min(Math.abs(Ne[Ze]),Q)}else F.push(ke),ve=!0;else X&&(Q=Math.min(Math.abs(ke),Q));if(!t.scrollingPage){var He=t.cy,ut=He.zoom(),lt=He.pan(),_t=t.projectIntoViewport(ue.clientX,ue.clientY),Bt=[_t[0]*ut+lt.x,_t[1]*ut+lt.y];if(t.hoverData.draggingEles||t.hoverData.dragging||t.hoverData.cxtStarted||I()){ue.preventDefault();return}if(He.panningEnabled()&&He.userPanningEnabled()&&He.zoomingEnabled()&&He.userZoomingEnabled()){ue.preventDefault(),t.data.wheelZooming=!0,clearTimeout(t.data.wheelTimeout),t.data.wheelTimeout=setTimeout(function(){t.data.wheelZooming=!1,t.redrawHint("eles",!0),t.redraw()},150);var zt;ve&&Math.abs(ke)>5&&(ke=R_(ke)*5),zt=ke/-250,X&&(zt/=Q,zt*=3),zt=zt*t.wheelSensitivity;var vt=ue.deltaMode===1;vt&&(zt*=33);var Ht=He.zoom()*Math.pow(10,zt);ue.type==="gesturechange"&&(Ht=t.gestureStartZoom*ue.scale),He.zoom({level:Ht,renderedPosition:{x:Bt[0],y:Bt[1]}}),He.emit({type:ue.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:ue,position:{x:_t[0],y:_t[1]}})}}}};t.registerBinding(t.container,"wheel",G,!0),t.registerBinding(e,"scroll",function(ue){t.scrollingPage=!0,clearTimeout(t.scrollingPageTimeout),t.scrollingPageTimeout=setTimeout(function(){t.scrollingPage=!1},250)},!0),t.registerBinding(t.container,"gesturestart",function(ue){t.gestureStartZoom=t.cy.zoom(),t.hasTouchStarted||ue.preventDefault()},!0),t.registerBinding(t.container,"gesturechange",function(Ge){t.hasTouchStarted||G(Ge)},!0),t.registerBinding(t.container,"mouseout",function(ue){var ve=t.projectIntoViewport(ue.clientX,ue.clientY);t.cy.emit({originalEvent:ue,type:"mouseout",position:{x:ve[0],y:ve[1]}})},!1),t.registerBinding(t.container,"mouseover",function(ue){var ve=t.projectIntoViewport(ue.clientX,ue.clientY);t.cy.emit({originalEvent:ue,type:"mouseover",position:{x:ve[0],y:ve[1]}})},!1);var te,ne,de,me,ye,ie,pe,oe,fe,ge,be,_e,De,qe=function(ue,ve,ke,Ne){return Math.sqrt((ke-ue)*(ke-ue)+(Ne-ve)*(Ne-ve))},Ue=function(ue,ve,ke,Ne){return(ke-ue)*(ke-ue)+(Ne-ve)*(Ne-ve)},Ve;t.registerBinding(t.container,"touchstart",Ve=function(ue){if(t.hasTouchStarted=!0,!!V(ue)){E(),t.touchData.capture=!0,t.data.bgActivePosistion=void 0;var ve=t.cy,ke=t.touchData.now,Ne=t.touchData.earlier;if(ue.touches[0]){var je=t.projectIntoViewport(ue.touches[0].clientX,ue.touches[0].clientY);ke[0]=je[0],ke[1]=je[1]}if(ue.touches[1]){var je=t.projectIntoViewport(ue.touches[1].clientX,ue.touches[1].clientY);ke[2]=je[0],ke[3]=je[1]}if(ue.touches[2]){var je=t.projectIntoViewport(ue.touches[2].clientX,ue.touches[2].clientY);ke[4]=je[0],ke[5]=je[1]}var Ze=function(ur){return{originalEvent:ue,type:ur,position:{x:ke[0],y:ke[1]}}};if(ue.touches[1]){t.touchData.singleTouchMoved=!0,N(t.dragData.touchDragEles);var He=t.findContainerClientCoords();fe=He[0],ge=He[1],be=He[2],_e=He[3],te=ue.touches[0].clientX-fe,ne=ue.touches[0].clientY-ge,de=ue.touches[1].clientX-fe,me=ue.touches[1].clientY-ge,De=0<=te&&te<=be&&0<=de&&de<=be&&0<=ne&&ne<=_e&&0<=me&&me<=_e;var ut=ve.pan(),lt=ve.zoom();ye=qe(te,ne,de,me),ie=Ue(te,ne,de,me),pe=[(te+de)/2,(ne+me)/2],oe=[(pe[0]-ut.x)/lt,(pe[1]-ut.y)/lt];var _t=200,Bt=_t*_t;if(ie<Bt&&!ue.touches[2]){var zt=t.findNearestElement(ke[0],ke[1],!0,!0),vt=t.findNearestElement(ke[2],ke[3],!0,!0);zt&&zt.isNode()?(zt.activate().emit(Ze("cxttapstart")),t.touchData.start=zt):vt&&vt.isNode()?(vt.activate().emit(Ze("cxttapstart")),t.touchData.start=vt):ve.emit(Ze("cxttapstart")),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!0,t.touchData.cxtDragged=!1,t.data.bgActivePosistion=void 0,t.redraw();return}}if(ue.touches[2])ve.boxSelectionEnabled()&&ue.preventDefault();else if(!ue.touches[1]){if(ue.touches[0]){var Ht=t.findNearestElements(ke[0],ke[1],!0,!0),qt=Ht[0];if(qt!=null&&(qt.activate(),t.touchData.start=qt,t.touchData.starts=Ht,t.nodeIsGrabbable(qt))){var Sr=t.dragData.touchDragEles=ve.collection(),fr=null;t.redrawHint("eles",!0),t.redrawHint("drag",!0),qt.selected()?(fr=ve.$(function(nn){return nn.selected()&&t.nodeIsGrabbable(nn)}),_(fr,{addToList:Sr})):S(qt,{addToList:Sr}),f(qt),qt.emit(Ze("grabon")),fr?fr.forEach(function(nn){nn.emit(Ze("grab"))}):qt.emit(Ze("grab"))}i(qt,["touchstart","tapstart","vmousedown"],ue,{x:ke[0],y:ke[1]}),qt==null&&(t.data.bgActivePosistion={x:je[0],y:je[1]},t.redrawHint("select",!0),t.redraw()),t.touchData.singleTouchMoved=!1,t.touchData.singleTouchStartTime=+new Date,clearTimeout(t.touchData.tapholdTimeout),t.touchData.tapholdTimeout=setTimeout(function(){t.touchData.singleTouchMoved===!1&&!t.pinching&&!t.touchData.selecting&&i(t.touchData.start,["taphold"],ue,{x:ke[0],y:ke[1]})},t.tapholdDuration)}}if(ue.touches.length>=1){for(var fn=t.touchData.startPosition=[null,null,null,null,null,null],Gr=0;Gr<ke.length;Gr++)fn[Gr]=Ne[Gr]=ke[Gr];var qr=ue.touches[0];t.touchData.startGPosition=[qr.clientX,qr.clientY]}}},!1);var Je;t.registerBinding(e,"touchmove",Je=function(ue){var ve=t.touchData.capture;if(!(!ve&&!V(ue))){var ke=t.selection,Ne=t.cy,je=t.touchData.now,Ze=t.touchData.earlier,He=Ne.zoom();if(ue.touches[0]){var ut=t.projectIntoViewport(ue.touches[0].clientX,ue.touches[0].clientY);je[0]=ut[0],je[1]=ut[1]}if(ue.touches[1]){var ut=t.projectIntoViewport(ue.touches[1].clientX,ue.touches[1].clientY);je[2]=ut[0],je[3]=ut[1]}if(ue.touches[2]){var ut=t.projectIntoViewport(ue.touches[2].clientX,ue.touches[2].clientY);je[4]=ut[0],je[5]=ut[1]}var lt=function(yr){return{originalEvent:ue,type:yr,position:{x:je[0],y:je[1]}}},_t=t.touchData.startGPosition,Bt;if(ve&&ue.touches[0]&&_t){for(var zt=[],vt=0;vt<je.length;vt++)zt[vt]=je[vt]-Ze[vt];var Ht=ue.touches[0].clientX-_t[0],qt=Ht*Ht,Sr=ue.touches[0].clientY-_t[1],fr=Sr*Sr,fn=qt+fr;Bt=fn>=t.touchTapThreshold2}if(ve&&t.touchData.cxt){ue.preventDefault();var Gr=ue.touches[0].clientX-fe,qr=ue.touches[0].clientY-ge,nn=ue.touches[1].clientX-fe,ur=ue.touches[1].clientY-ge,yt=Ue(Gr,qr,nn,ur),Lr=yt/ie,Yn=150,Na=Yn*Yn,Ds=1.5,Js=Ds*Ds;if(Lr>=Js||yt>=Na){t.touchData.cxt=!1,t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var ui=lt("cxttapend");t.touchData.start?(t.touchData.start.unactivate().emit(ui),t.touchData.start=null):Ne.emit(ui)}}if(ve&&t.touchData.cxt){var ui=lt("cxtdrag");t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.touchData.start?t.touchData.start.emit(ui):Ne.emit(ui),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxtDragged=!0;var an=t.findNearestElement(je[0],je[1],!0,!0);(!t.touchData.cxtOver||an!==t.touchData.cxtOver)&&(t.touchData.cxtOver&&t.touchData.cxtOver.emit(lt("cxtdragout")),t.touchData.cxtOver=an,an&&an.emit(lt("cxtdragover")))}else if(ve&&ue.touches[2]&&Ne.boxSelectionEnabled())ue.preventDefault(),t.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,t.touchData.selecting||Ne.emit(lt("boxstart")),t.touchData.selecting=!0,t.touchData.didSelect=!0,ke[4]=1,!ke||ke.length===0||ke[0]===void 0?(ke[0]=(je[0]+je[2]+je[4])/3,ke[1]=(je[1]+je[3]+je[5])/3,ke[2]=(je[0]+je[2]+je[4])/3+1,ke[3]=(je[1]+je[3]+je[5])/3+1):(ke[2]=(je[0]+je[2]+je[4])/3,ke[3]=(je[1]+je[3]+je[5])/3),t.redrawHint("select",!0),t.redraw();else if(ve&&ue.touches[1]&&!t.touchData.didSelect&&Ne.zoomingEnabled()&&Ne.panningEnabled()&&Ne.userZoomingEnabled()&&Ne.userPanningEnabled()){ue.preventDefault(),t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var xn=t.dragData.touchDragEles;if(xn){t.redrawHint("drag",!0);for(var ci=0;ci<xn.length;ci++){var eo=xn[ci]._private;eo.grabbed=!1,eo.rscratch.inDragLayer=!1}}var wi=t.touchData.start,Gr=ue.touches[0].clientX-fe,qr=ue.touches[0].clientY-ge,nn=ue.touches[1].clientX-fe,ur=ue.touches[1].clientY-ge,su=qe(Gr,qr,nn,ur),ou=su/ye;if(De){var Id=Gr-te,fl=qr-ne,Xr=nn-de,lu=ur-me,Is=(Id+Xr)/2,pl=(fl+lu)/2,Ta=Ne.zoom(),Lo=Ta*ou,ea=Ne.pan(),ta=oe[0]*Ta+ea.x,pn=oe[1]*Ta+ea.y,vr={x:-Lo/Ta*(ta-ea.x-Is)+ta,y:-Lo/Ta*(pn-ea.y-pl)+pn};if(wi&&wi.active()){var xn=t.dragData.touchDragEles;N(xn),t.redrawHint("drag",!0),t.redrawHint("eles",!0),wi.unactivate().emit(lt("freeon")),xn.emit(lt("free")),t.dragData.didDrag&&(wi.emit(lt("dragfreeon")),xn.emit(lt("dragfree")))}Ne.viewport({zoom:Lo,pan:vr,cancelOnFailedZoom:!0}),Ne.emit(lt("pinchzoom")),ye=su,te=Gr,ne=qr,de=nn,me=ur,t.pinching=!0}if(ue.touches[0]){var ut=t.projectIntoViewport(ue.touches[0].clientX,ue.touches[0].clientY);je[0]=ut[0],je[1]=ut[1]}if(ue.touches[1]){var ut=t.projectIntoViewport(ue.touches[1].clientX,ue.touches[1].clientY);je[2]=ut[0],je[3]=ut[1]}if(ue.touches[2]){var ut=t.projectIntoViewport(ue.touches[2].clientX,ue.touches[2].clientY);je[4]=ut[0],je[5]=ut[1]}}else if(ue.touches[0]&&!t.touchData.didSelect){var ot=t.touchData.start,cr=t.touchData.last,an;if(!t.hoverData.draggingEles&&!t.swipePanning&&(an=t.findNearestElement(je[0],je[1],!0,!0)),ve&&ot!=null&&ue.preventDefault(),ve&&ot!=null&&t.nodeIsDraggable(ot))if(Bt){var xn=t.dragData.touchDragEles,sn=!t.dragData.didDrag;sn&&_(xn,{inDragLayer:!0}),t.dragData.didDrag=!0;var zr={x:0,y:0};if(dt(zt[0])&&dt(zt[1])&&(zr.x+=zt[0],zr.y+=zt[1],sn)){t.redrawHint("eles",!0);var Nr=t.touchData.dragDelta;Nr&&dt(Nr[0])&&dt(Nr[1])&&(zr.x+=Nr[0],zr.y+=Nr[1])}t.hoverData.draggingEles=!0,xn.silentShift(zr).emit(lt("position")).emit(lt("drag")),t.redrawHint("drag",!0),t.touchData.startPosition[0]==Ze[0]&&t.touchData.startPosition[1]==Ze[1]&&t.redrawHint("eles",!0),t.redraw()}else{var Nr=t.touchData.dragDelta=t.touchData.dragDelta||[];Nr.length===0?(Nr.push(zt[0]),Nr.push(zt[1])):(Nr[0]+=zt[0],Nr[1]+=zt[1])}if(i(ot||an,["touchmove","tapdrag","vmousemove"],ue,{x:je[0],y:je[1]}),(!ot||!ot.grabbed())&&an!=cr&&(cr&&cr.emit(lt("tapdragout")),an&&an.emit(lt("tapdragover"))),t.touchData.last=an,ve)for(var ci=0;ci<je.length;ci++)je[ci]&&t.touchData.startPosition[ci]&&Bt&&(t.touchData.singleTouchMoved=!0);if(ve&&(ot==null||ot.pannable())&&Ne.panningEnabled()&&Ne.userPanningEnabled()){var ra=s(ot,t.touchData.starts);ra&&(ue.preventDefault(),t.data.bgActivePosistion||(t.data.bgActivePosistion=Xf(t.touchData.startPosition)),t.swipePanning?(Ne.panBy({x:zt[0]*He,y:zt[1]*He}),Ne.emit(lt("dragpan"))):Bt&&(t.swipePanning=!0,Ne.panBy({x:Ht*He,y:Sr*He}),Ne.emit(lt("dragpan")),ot&&(ot.unactivate(),t.redrawHint("select",!0),t.touchData.start=null)));var ut=t.projectIntoViewport(ue.touches[0].clientX,ue.touches[0].clientY);je[0]=ut[0],je[1]=ut[1]}}for(var vt=0;vt<je.length;vt++)Ze[vt]=je[vt];ve&&ue.touches.length>0&&!t.hoverData.draggingEles&&!t.swipePanning&&t.data.bgActivePosistion!=null&&(t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.redraw())}},!1);var ft;t.registerBinding(e,"touchcancel",ft=function(ue){var ve=t.touchData.start;t.touchData.capture=!1,ve&&ve.unactivate()});var We,Ce,ze,Ke;if(t.registerBinding(e,"touchend",We=function(ue){var ve=t.touchData.start,ke=t.touchData.capture;if(ke)ue.touches.length===0&&(t.touchData.capture=!1),ue.preventDefault();else return;var Ne=t.selection;t.swipePanning=!1,t.hoverData.draggingEles=!1;var je=t.cy,Ze=je.zoom(),He=t.touchData.now,ut=t.touchData.earlier;if(ue.touches[0]){var lt=t.projectIntoViewport(ue.touches[0].clientX,ue.touches[0].clientY);He[0]=lt[0],He[1]=lt[1]}if(ue.touches[1]){var lt=t.projectIntoViewport(ue.touches[1].clientX,ue.touches[1].clientY);He[2]=lt[0],He[3]=lt[1]}if(ue.touches[2]){var lt=t.projectIntoViewport(ue.touches[2].clientX,ue.touches[2].clientY);He[4]=lt[0],He[5]=lt[1]}var _t=function(Na){return{originalEvent:ue,type:Na,position:{x:He[0],y:He[1]}}};ve&&ve.unactivate();var Bt;if(t.touchData.cxt){if(Bt=_t("cxttapend"),ve?ve.emit(Bt):je.emit(Bt),!t.touchData.cxtDragged){var zt=_t("cxttap");ve?ve.emit(zt):je.emit(zt)}t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!1,t.touchData.start=null,t.redraw();return}if(!ue.touches[2]&&je.boxSelectionEnabled()&&t.touchData.selecting){t.touchData.selecting=!1;var vt=je.collection(t.getAllInBox(Ne[0],Ne[1],Ne[2],Ne[3]));Ne[0]=void 0,Ne[1]=void 0,Ne[2]=void 0,Ne[3]=void 0,Ne[4]=0,t.redrawHint("select",!0),je.emit(_t("boxend"));var Ht=function(Na){return Na.selectable()&&!Na.selected()};vt.emit(_t("box")).stdFilter(Ht).select().emit(_t("boxselect")),vt.nonempty()&&t.redrawHint("eles",!0),t.redraw()}if(ve?.unactivate(),ue.touches[2])t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);else if(!ue.touches[1]){if(!ue.touches[0]){if(!ue.touches[0]){t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var qt=t.dragData.touchDragEles;if(ve!=null){var Sr=ve._private.grabbed;N(qt),t.redrawHint("drag",!0),t.redrawHint("eles",!0),Sr&&(ve.emit(_t("freeon")),qt.emit(_t("free")),t.dragData.didDrag&&(ve.emit(_t("dragfreeon")),qt.emit(_t("dragfree")))),i(ve,["touchend","tapend","vmouseup","tapdragout"],ue,{x:He[0],y:He[1]}),ve.unactivate(),t.touchData.start=null}else{var fr=t.findNearestElement(He[0],He[1],!0,!0);i(fr,["touchend","tapend","vmouseup","tapdragout"],ue,{x:He[0],y:He[1]})}var fn=t.touchData.startPosition[0]-He[0],Gr=fn*fn,qr=t.touchData.startPosition[1]-He[1],nn=qr*qr,ur=Gr+nn,yt=ur*Ze*Ze;t.touchData.singleTouchMoved||(ve||je.$(":selected").unselect(["tapunselect"]),i(ve,["tap","vclick"],ue,{x:He[0],y:He[1]}),Ce=!1,ue.timeStamp-Ke<=je.multiClickDebounceTime()?(ze&&clearTimeout(ze),Ce=!0,Ke=null,i(ve,["dbltap","vdblclick"],ue,{x:He[0],y:He[1]})):(ze=setTimeout(function(){Ce||i(ve,["onetap","voneclick"],ue,{x:He[0],y:He[1]})},je.multiClickDebounceTime()),Ke=ue.timeStamp)),ve!=null&&!t.dragData.didDrag&&ve._private.selectable&&yt<t.touchTapThreshold2&&!t.pinching&&(je.selectionType()==="single"?(je.$(r).unmerge(ve).unselect(["tapunselect"]),ve.select(["tapselect"])):ve.selected()?ve.unselect(["tapunselect"]):ve.select(["tapselect"]),t.redrawHint("eles",!0)),t.touchData.singleTouchMoved=!0}}}for(var Lr=0;Lr<He.length;Lr++)ut[Lr]=He[Lr];t.dragData.didDrag=!1,ue.touches.length===0&&(t.touchData.dragDelta=[],t.touchData.startPosition=[null,null,null,null,null,null],t.touchData.startGPosition=null,t.touchData.didSelect=!1),ue.touches.length<2&&(ue.touches.length===1&&(t.touchData.startGPosition=[ue.touches[0].clientX,ue.touches[0].clientY]),t.pinching=!1,t.redrawHint("eles",!0),t.redraw())},!1),typeof TouchEvent>"u"){var et=[],ht=function(ue){return{clientX:ue.clientX,clientY:ue.clientY,force:1,identifier:ue.pointerId,pageX:ue.pageX,pageY:ue.pageY,radiusX:ue.width/2,radiusY:ue.height/2,screenX:ue.screenX,screenY:ue.screenY,target:ue.target}},Nt=function(ue){return{event:ue,touch:ht(ue)}},Mt=function(ue){et.push(Nt(ue))},jt=function(ue){for(var ve=0;ve<et.length;ve++){var ke=et[ve];if(ke.event.pointerId===ue.pointerId){et.splice(ve,1);return}}},Wt=function(ue){var ve=et.filter(function(ke){return ke.event.pointerId===ue.pointerId})[0];ve.event=ue,ve.touch=ht(ue)},xt=function(ue){ue.touches=et.map(function(ve){return ve.touch})},st=function(ue){return ue.pointerType==="mouse"||ue.pointerType===4};t.registerBinding(t.container,"pointerdown",function(Ge){st(Ge)||(Ge.preventDefault(),Mt(Ge),xt(Ge),Ve(Ge))}),t.registerBinding(t.container,"pointerup",function(Ge){st(Ge)||(jt(Ge),xt(Ge),We(Ge))}),t.registerBinding(t.container,"pointercancel",function(Ge){st(Ge)||(jt(Ge),xt(Ge),ft(Ge))}),t.registerBinding(t.container,"pointermove",function(Ge){st(Ge)||(Ge.preventDefault(),Wt(Ge),xt(Ge),Je(Ge))})}};var Yu={};Yu.generatePolygon=function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,draw:function(n,i,a,s,o,l){this.renderer.nodeShapeImpl("polygon",n,i,a,s,o,this.points)},intersectLine:function(n,i,a,s,o,l,u,c){return Dg(o,l,this.points,n,i,a/2,s/2,u)},checkPoint:function(n,i,a,s,o,l,u,c){return Wu(n,i,this.points,l,u,s,o,[0,-1],a)},hasMiterBounds:t!=="rectangle",miterBounds:function(n,i,a,s,o,l){return VO(this.points,n,i,a,s,o)}}};Yu.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a)},intersectLine:function(e,r,n,i,a,s,o,l){return ZO(a,s,e,r,n/2+o,i/2+o)},checkPoint:function(e,r,n,i,a,s,o,l){return wh(e,r,i,a,s,o,n)}}};Yu.generateRoundPolygon=function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,getOrCreateCorners:function(n,i,a,s,o,l,u){if(l[u]!==void 0&&l[u+"-cx"]===n&&l[u+"-cy"]===i)return l[u];l[u]=new Array(e.length/2),l[u+"-cx"]=n,l[u+"-cy"]=i;var c=a/2,f=s/2;o=o==="auto"?H4(a,s):o;for(var g=new Array(e.length/2),v=0;v<e.length/2;v++)g[v]={x:n+c*e[v*2],y:i+f*e[v*2+1]};var x,_,S,N,k=g.length;for(_=g[k-1],x=0;x<k;x++)S=g[x%k],N=g[(x+1)%k],l[u][x]=W_(_,S,N,o),_=S,S=N;return l[u]},draw:function(n,i,a,s,o,l,u){this.renderer.nodeShapeImpl("round-polygon",n,i,a,s,o,this.points,this.getOrCreateCorners(i,a,s,o,l,u,"drawCorners"))},intersectLine:function(n,i,a,s,o,l,u,c,f){return XO(o,l,this.points,n,i,a,s,u,this.getOrCreateCorners(n,i,a,s,c,f,"corners"))},checkPoint:function(n,i,a,s,o,l,u,c,f){return KO(n,i,this.points,l,u,s,o,this.getOrCreateCorners(l,u,s,o,c,f,"corners"))}}};Yu.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:ss(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,this.points,s)},intersectLine:function(e,r,n,i,a,s,o,l){return V4(a,s,e,r,n,i,o,l)},checkPoint:function(e,r,n,i,a,s,o,l){var u=i/2,c=a/2;l=l==="auto"?bd(i,a):l,l=Math.min(u,c,l);var f=l*2;return!!(Wu(e,r,this.points,s,o,i,a-f,[0,-1],n)||Wu(e,r,this.points,s,o,i-f,a,[0,-1],n)||wh(e,r,f,f,s-u+l,o-c+l,n)||wh(e,r,f,f,s+u-l,o-c+l,n)||wh(e,r,f,f,s+u-l,o+c-l,n)||wh(e,r,f,f,s-u+l,o+c-l,n))}}};Yu.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:O_(),points:ss(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,null,s)},generateCutTrianglePts:function(e,r,n,i,a){var s=a==="auto"?this.cornerLength:a,o=r/2,l=e/2,u=n-l,c=n+l,f=i-o,g=i+o;return{topLeft:[u,f+s,u+s,f,u+s,f+s],topRight:[c-s,f,c,f+s,c-s,f+s],bottomRight:[c,g-s,c-s,g,c-s,g-s],bottomLeft:[u+s,g,u,g-s,u+s,g-s]}},intersectLine:function(e,r,n,i,a,s,o,l){var u=this.generateCutTrianglePts(n+2*o,i+2*o,e,r,l),c=[].concat.apply([],[u.topLeft.splice(0,4),u.topRight.splice(0,4),u.bottomRight.splice(0,4),u.bottomLeft.splice(0,4)]);return Dg(a,s,c,e,r)},checkPoint:function(e,r,n,i,a,s,o,l){var u=l==="auto"?this.cornerLength:l;if(Wu(e,r,this.points,s,o,i,a-2*u,[0,-1],n)||Wu(e,r,this.points,s,o,i-2*u,a,[0,-1],n))return!0;var c=this.generateCutTrianglePts(i,a,s,o);return Ps(e,r,c.topLeft)||Ps(e,r,c.topRight)||Ps(e,r,c.bottomRight)||Ps(e,r,c.bottomLeft)}}};Yu.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:ss(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a)},intersectLine:function(e,r,n,i,a,s,o,l){var u=.15,c=.5,f=.85,g=this.generateBarrelBezierPts(n+2*o,i+2*o,e,r),v=function(S){var N=rp({x:S[0],y:S[1]},{x:S[2],y:S[3]},{x:S[4],y:S[5]},u),k=rp({x:S[0],y:S[1]},{x:S[2],y:S[3]},{x:S[4],y:S[5]},c),E=rp({x:S[0],y:S[1]},{x:S[2],y:S[3]},{x:S[4],y:S[5]},f);return[S[0],S[1],N.x,N.y,k.x,k.y,E.x,E.y,S[4],S[5]]},x=[].concat(v(g.topLeft),v(g.topRight),v(g.bottomRight),v(g.bottomLeft));return Dg(a,s,x,e,r)},generateBarrelBezierPts:function(e,r,n,i){var a=r/2,s=e/2,o=n-s,l=n+s,u=i-a,c=i+a,f=v2(e,r),g=f.heightOffset,v=f.widthOffset,x=f.ctrlPtOffsetPct*e,_={topLeft:[o,u+g,o+x,u,o+v,u],topRight:[l-v,u,l-x,u,l,u+g],bottomRight:[l,c-g,l-x,c,l-v,c],bottomLeft:[o+v,c,o+x,c,o,c-g]};return _.topLeft.isTop=!0,_.topRight.isTop=!0,_.bottomLeft.isBottom=!0,_.bottomRight.isBottom=!0,_},checkPoint:function(e,r,n,i,a,s,o,l){var u=v2(i,a),c=u.heightOffset,f=u.widthOffset;if(Wu(e,r,this.points,s,o,i,a-2*c,[0,-1],n)||Wu(e,r,this.points,s,o,i-2*f,a,[0,-1],n))return!0;for(var g=this.generateBarrelBezierPts(i,a,s,o),v=function(B,I,V){var $=V[4],Z=V[2],O=V[0],W=V[5],F=V[1],K=Math.min($,O),X=Math.max($,O),Q=Math.min(W,F),ae=Math.max(W,F);if(K<=B&&B<=X&&Q<=I&&I<=ae){var re=QO($,Z,O),G=GO(re[0],re[1],re[2],B),te=G.filter(function(ne){return 0<=ne&&ne<=1});if(te.length>0)return te[0]}return null},x=Object.keys(g),_=0;_<x.length;_++){var S=x[_],N=g[S],k=v(e,r,N);if(k!=null){var E=N[5],T=N[3],R=N[1],j=Wi(E,T,R,k);if(N.isTop&&j<=r||N.isBottom&&r<=j)return!0}}return!1}}};Yu.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:ss(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,this.points,s)},intersectLine:function(e,r,n,i,a,s,o,l){var u=e-(n/2+o),c=r-(i/2+o),f=c,g=e+(n/2+o),v=sd(a,s,e,r,u,c,g,f,!1);return v.length>0?v:V4(a,s,e,r,n,i,o,l)},checkPoint:function(e,r,n,i,a,s,o,l){l=l==="auto"?bd(i,a):l;var u=2*l;if(Wu(e,r,this.points,s,o,i,a-u,[0,-1],n)||Wu(e,r,this.points,s,o,i-u,a,[0,-1],n))return!0;var c=i/2+2*n,f=a/2+2*n,g=[s-c,o-f,s-c,o,s+c,o,s+c,o-f];return!!(Ps(e,r,g)||wh(e,r,u,u,s+i/2-l,o+a/2-l,n)||wh(e,r,u,u,s-i/2+l,o+a/2-l,n))}}};Yu.registerNodeShapes=function(){var t=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",ss(3,0)),this.generateRoundPolygon("round-triangle",ss(3,0)),this.generatePolygon("rectangle",ss(4,0)),t.square=t.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var r=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",r),this.generateRoundPolygon("round-diamond",r)}this.generatePolygon("pentagon",ss(5,0)),this.generateRoundPolygon("round-pentagon",ss(5,0)),this.generatePolygon("hexagon",ss(6,0)),this.generateRoundPolygon("round-hexagon",ss(6,0)),this.generatePolygon("heptagon",ss(7,0)),this.generateRoundPolygon("round-heptagon",ss(7,0)),this.generatePolygon("octagon",ss(8,0)),this.generateRoundPolygon("round-octagon",ss(8,0));var n=new Array(20);{var i=g2(5,0),a=g2(5,Math.PI/5),s=.5*(3-Math.sqrt(5));s*=1.57;for(var o=0;o<a.length/2;o++)a[o*2]*=s,a[o*2+1]*=s;for(var o=0;o<20/4;o++)n[o*4]=i[o*2],n[o*4+1]=i[o*2+1],n[o*4+2]=a[o*2],n[o*4+3]=a[o*2+1]}n=U4(n),this.generatePolygon("star",n),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}t.makePolygon=function(u){var c=u.join("$"),f="polygon-"+c,g;return(g=this[f])?g:e.generatePolygon(f,u)}};var pv={};pv.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};pv.redraw=function(t){t=t||I4();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=t};pv.beforeRender=function(t,e){if(!this.destroyed){e==null&&jn("Priority is not optional for beforeRender");var r=this.beforeRenderCallbacks;r.push({fn:t,priority:e}),r.sort(function(n,i){return i.priority-n.priority})}};var cN=function(e,r,n){for(var i=e.beforeRenderCallbacks,a=0;a<i.length;a++)i[a].fn(r,n)};pv.startRenderLoop=function(){var t=this,e=t.cy;if(!t.renderLoopStarted){t.renderLoopStarted=!0;var r=function(i){if(!t.destroyed){if(!e.batching())if(t.requestedFrame&&!t.skipFrame){cN(t,!0,i);var a=qu();t.render(t.renderOptions);var s=t.lastDrawTime=qu();t.averageRedrawTime===void 0&&(t.averageRedrawTime=s-a),t.redrawCount===void 0&&(t.redrawCount=0),t.redrawCount++,t.redrawTotalTime===void 0&&(t.redrawTotalTime=0);var o=s-a;t.redrawTotalTime+=o,t.lastRedrawTime=o,t.averageRedrawTime=t.averageRedrawTime/2+o/2,t.requestedFrame=!1}else cN(t,!1,i);t.skipFrame=!1,iy(r)}};iy(r)}};var p7=function(e){this.init(e)},HP=p7,Ap=HP.prototype;Ap.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];Ap.init=function(t){var e=this;e.options=t,e.cy=t.cy;var r=e.container=t.cy.container(),n=e.cy.window();if(n){var i=n.document,a=i.head,s="__________cytoscape_stylesheet",o="__________cytoscape_container",l=i.getElementById(s)!=null;if(r.className.indexOf(o)<0&&(r.className=(r.className||"")+" "+o),!l){var u=i.createElement("style");u.id=s,u.textContent="."+o+" { position: relative; }",a.insertBefore(u,a.children[0])}var c=n.getComputedStyle(r),f=c.getPropertyValue("position");f==="static"&&Br("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=t.showFps,e.debug=t.debug,e.webgl=t.webgl,e.hideEdgesOnViewport=t.hideEdgesOnViewport,e.textureOnViewport=t.textureOnViewport,e.wheelSensitivity=t.wheelSensitivity,e.motionBlurEnabled=t.motionBlur,e.forcedPixelRatio=dt(t.pixelRatio)?t.pixelRatio:null,e.motionBlur=t.motionBlur,e.motionBlurOpacity=t.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=t.desktopTapThreshold,e.desktopTapThreshold2=t.desktopTapThreshold*t.desktopTapThreshold,e.touchTapThreshold=t.touchTapThreshold,e.touchTapThreshold2=t.touchTapThreshold*t.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};Ap.notify=function(t,e){var r=this,n=r.cy;if(!this.destroyed){if(t==="init"){r.load();return}if(t==="destroy"){r.destroy();return}(t==="add"||t==="remove"||t==="move"&&n.hasCompoundNodes()||t==="load"||t==="zorder"||t==="mount")&&r.invalidateCachedZSortedEles(),t==="viewport"&&r.redrawHint("select",!0),t==="gc"&&r.redrawHint("gc",!0),(t==="load"||t==="resize"||t==="mount")&&(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container)),r.redrawHint("eles",!0),r.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};Ap.destroy=function(){var t=this;t.destroyed=!0,t.cy.stopAnimationLoop();for(var e=0;e<t.bindings.length;e++){var r=t.bindings[e],n=r,i=n.target;(i.off||i.removeEventListener).apply(i,n.args)}if(t.bindings=[],t.beforeRenderCallbacks=[],t.onUpdateEleCalcsFns=[],t.removeObserver&&t.removeObserver.disconnect(),t.styleObserver&&t.styleObserver.disconnect(),t.resizeObserver&&t.resizeObserver.disconnect(),t.labelCalcDiv)try{document.body.removeChild(t.labelCalcDiv)}catch{}};Ap.isHeadless=function(){return!1};[q_,VP,UP,Mp,Yu,pv].forEach(function(t){Ut(Ap,t)});var ew=1e3/60,GP={setupDequeueing:function(e){return function(){var n=this,i=this.renderer;if(!n.dequeueingSetup){n.dequeueingSetup=!0;var a=uv(function(){i.redrawHint("eles",!0),i.redrawHint("drag",!0),i.redraw()},e.deqRedrawThreshold),s=function(u,c){var f=qu(),g=i.averageRedrawTime,v=i.lastRedrawTime,x=[],_=i.cy.extent(),S=i.getPixelRatio();for(u||i.flushRenderedStyleQueue();;){var N=qu(),k=N-f,E=N-c;if(v<ew){var T=ew-(u?g:0);if(E>=e.deqFastCost*T)break}else if(u){if(k>=e.deqCost*v||k>=e.deqAvgCost*g)break}else if(E>=e.deqNoDrawCost*ew)break;var R=e.deq(n,S,_);if(R.length>0)for(var j=0;j<R.length;j++)x.push(R[j]);else break}x.length>0&&(e.onDeqd(n,x),!u&&e.shouldRedraw(n,x,S,_)&&a())},o=e.priority||M_;i.beforeRender(s,o(n))}}}},m7=(function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ay;Nd(this,t),this.idsByKey=new Vu,this.keyForId=new Vu,this.cachesByLvl=new Vu,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=r}return Td(t,[{key:"getIdsFor",value:function(r){r==null&&jn("Can not get id list for null key");var n=this.idsByKey,i=this.idsByKey.get(r);return i||(i=new Ep,n.set(r,i)),i}},{key:"addIdForKey",value:function(r,n){r!=null&&this.getIdsFor(r).add(n)}},{key:"deleteIdForKey",value:function(r,n){r!=null&&this.getIdsFor(r).delete(n)}},{key:"getNumberOfIdsForKey",value:function(r){return r==null?0:this.getIdsFor(r).size}},{key:"updateKeyMappingFor",value:function(r){var n=r.id(),i=this.keyForId.get(n),a=this.getKey(r);this.deleteIdForKey(i,n),this.addIdForKey(a,n),this.keyForId.set(n,a)}},{key:"deleteKeyMappingFor",value:function(r){var n=r.id(),i=this.keyForId.get(n);this.deleteIdForKey(i,n),this.keyForId.delete(n)}},{key:"keyHasChangedFor",value:function(r){var n=r.id(),i=this.keyForId.get(n),a=this.getKey(r);return i!==a}},{key:"isInvalid",value:function(r){return this.keyHasChangedFor(r)||this.doesEleInvalidateKey(r)}},{key:"getCachesAt",value:function(r){var n=this.cachesByLvl,i=this.lvls,a=n.get(r);return a||(a=new Vu,n.set(r,a),i.push(r)),a}},{key:"getCache",value:function(r,n){return this.getCachesAt(n).get(r)}},{key:"get",value:function(r,n){var i=this.getKey(r),a=this.getCache(i,n);return a!=null&&this.updateKeyMappingFor(r),a}},{key:"getForCachedKey",value:function(r,n){var i=this.keyForId.get(r.id()),a=this.getCache(i,n);return a}},{key:"hasCache",value:function(r,n){return this.getCachesAt(n).has(r)}},{key:"has",value:function(r,n){var i=this.getKey(r);return this.hasCache(i,n)}},{key:"setCache",value:function(r,n,i){i.key=r,this.getCachesAt(n).set(r,i)}},{key:"set",value:function(r,n,i){var a=this.getKey(r);this.setCache(a,n,i),this.updateKeyMappingFor(r)}},{key:"deleteCache",value:function(r,n){this.getCachesAt(n).delete(r)}},{key:"delete",value:function(r,n){var i=this.getKey(r);this.deleteCache(i,n)}},{key:"invalidateKey",value:function(r){var n=this;this.lvls.forEach(function(i){return n.deleteCache(r,i)})}},{key:"invalidate",value:function(r){var n=r.id(),i=this.keyForId.get(n);this.deleteKeyMappingFor(r);var a=this.doesEleInvalidateKey(r);return a&&this.invalidateKey(i),a||this.getNumberOfIdsForKey(i)===0}}])})(),dN=25,h0=50,G0=-4,M2=3,qP=7.99,g7=8,v7=1024,y7=1024,x7=1024,b7=.2,w7=.8,_7=10,S7=.15,k7=.1,C7=.9,E7=.9,N7=100,T7=1,Jf={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},P7=Ca({getKey:null,doesEleInvalidateKey:ay,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:L4,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),og=function(e,r){var n=this;n.renderer=e,n.onDequeues=[];var i=P7(r);Ut(n,i),n.lookup=new m7(i.getKey,i.doesEleInvalidateKey),n.setupDequeueing()},Ai=og.prototype;Ai.reasons=Jf;Ai.getTextureQueue=function(t){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[t]=e.eleImgCaches[t]||[]};Ai.getRetiredTextureQueue=function(t){var e=this,r=e.eleImgCaches.retired=e.eleImgCaches.retired||{},n=r[t]=r[t]||[];return n};Ai.getElementQueue=function(){var t=this,e=t.eleCacheQueue=t.eleCacheQueue||new cv(function(r,n){return n.reqs-r.reqs});return e};Ai.getElementKeyToQueue=function(){var t=this,e=t.eleKeyToCacheQueue=t.eleKeyToCacheQueue||{};return e};Ai.getElement=function(t,e,r,n,i){var a=this,s=this.renderer,o=s.cy.zoom(),l=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!t.visible()||t.removed()||!a.allowEdgeTxrCaching&&t.isEdge()||!a.allowParentTxrCaching&&t.isParent())return null;if(n==null&&(n=Math.ceil(j_(o*r))),n<G0)n=G0;else if(o>=qP||n>M2)return null;var u=Math.pow(2,n),c=e.h*u,f=e.w*u,g=s.eleTextBiggerThanMin(t,u);if(!this.isVisible(t,g))return null;var v=l.get(t,n);if(v&&v.invalidated&&(v.invalidated=!1,v.texture.invalidatedWidth-=v.width),v)return v;var x;if(c<=dN?x=dN:c<=h0?x=h0:x=Math.ceil(c/h0)*h0,c>x7||f>y7)return null;var _=a.getTextureQueue(x),S=_[_.length-2],N=function(){return a.recycleTexture(x,f)||a.addTexture(x,f)};S||(S=_[_.length-1]),S||(S=N()),S.width-S.usedWidth<f&&(S=N());for(var k=function(K){return K&&K.scaledLabelShown===g},E=i&&i===Jf.dequeue,T=i&&i===Jf.highQuality,R=i&&i===Jf.downscale,j,D=n+1;D<=M2;D++){var B=l.get(t,D);if(B){j=B;break}}var I=j&&j.level===n+1?j:null,V=function(){S.context.drawImage(I.texture.canvas,I.x,0,I.width,I.height,S.usedWidth,0,f,c)};if(S.context.setTransform(1,0,0,1,0,0),S.context.clearRect(S.usedWidth,0,f,x),k(I))V();else if(k(j))if(T){for(var $=j.level;$>n;$--)I=a.getElement(t,e,r,$,Jf.downscale);V()}else return a.queueElement(t,j.level-1),j;else{var Z;if(!E&&!T&&!R)for(var O=n-1;O>=G0;O--){var W=l.get(t,O);if(W){Z=W;break}}if(k(Z))return a.queueElement(t,n),Z;S.context.translate(S.usedWidth,0),S.context.scale(u,u),this.drawElement(S.context,t,e,g,!1),S.context.scale(1/u,1/u),S.context.translate(-S.usedWidth,0)}return v={x:S.usedWidth,texture:S,level:n,scale:u,width:f,height:c,scaledLabelShown:g},S.usedWidth+=Math.ceil(f+g7),S.eleCaches.push(v),l.set(t,n,v),a.checkTextureFullness(S),v};Ai.invalidateElements=function(t){for(var e=0;e<t.length;e++)this.invalidateElement(t[e])};Ai.invalidateElement=function(t){var e=this,r=e.lookup,n=[],i=r.isInvalid(t);if(i){for(var a=G0;a<=M2;a++){var s=r.getForCachedKey(t,a);s&&n.push(s)}var o=r.invalidate(t);if(o)for(var l=0;l<n.length;l++){var u=n[l],c=u.texture;c.invalidatedWidth+=u.width,u.invalidated=!0,e.checkTextureUtility(c)}e.removeFromQueue(t)}};Ai.checkTextureUtility=function(t){t.invalidatedWidth>=b7*t.width&&this.retireTexture(t)};Ai.checkTextureFullness=function(t){var e=this,r=e.getTextureQueue(t.height);t.usedWidth/t.width>w7&&t.fullnessChecks>=_7?xd(r,t):t.fullnessChecks++};Ai.retireTexture=function(t){var e=this,r=t.height,n=e.getTextureQueue(r),i=this.lookup;xd(n,t),t.retired=!0;for(var a=t.eleCaches,s=0;s<a.length;s++){var o=a[s];i.deleteCache(o.key,o.level)}A_(a);var l=e.getRetiredTextureQueue(r);l.push(t)};Ai.addTexture=function(t,e){var r=this,n=r.getTextureQueue(t),i={};return n.push(i),i.eleCaches=[],i.height=t,i.width=Math.max(v7,e),i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,i.canvas=r.renderer.makeOffscreenCanvas(i.width,i.height),i.context=i.canvas.getContext("2d"),i};Ai.recycleTexture=function(t,e){for(var r=this,n=r.getTextureQueue(t),i=r.getRetiredTextureQueue(t),a=0;a<i.length;a++){var s=i[a];if(s.width>=e)return s.retired=!1,s.usedWidth=0,s.invalidatedWidth=0,s.fullnessChecks=0,A_(s.eleCaches),s.context.setTransform(1,0,0,1,0,0),s.context.clearRect(0,0,s.width,s.height),xd(i,s),n.push(s),s}};Ai.queueElement=function(t,e){var r=this,n=r.getElementQueue(),i=r.getElementKeyToQueue(),a=this.getKey(t),s=i[a];if(s)s.level=Math.max(s.level,e),s.eles.merge(t),s.reqs++,n.updateItem(s);else{var o={eles:t.spawn().merge(t),level:e,reqs:1,key:a};n.push(o),i[a]=o}};Ai.dequeue=function(t){for(var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),i=[],a=e.lookup,s=0;s<T7&&r.size()>0;s++){var o=r.pop(),l=o.key,u=o.eles[0],c=a.hasCache(u,o.level);if(n[l]=null,c)continue;i.push(o);var f=e.getBoundingBox(u);e.getElement(u,f,t,o.level,Jf.dequeue)}return i};Ai.removeFromQueue=function(t){var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),i=this.getKey(t),a=n[i];a!=null&&(a.eles.length===1?(a.reqs=P_,r.updateItem(a),r.pop(),n[i]=null):a.eles.unmerge(t))};Ai.onDequeue=function(t){this.onDequeues.push(t)};Ai.offDequeue=function(t){xd(this.onDequeues,t)};Ai.setupDequeueing=GP.setupDequeueing({deqRedrawThreshold:N7,deqCost:S7,deqAvgCost:k7,deqNoDrawCost:C7,deqFastCost:E7,deq:function(e,r,n){return e.dequeue(r,n)},onDeqd:function(e,r){for(var n=0;n<e.onDequeues.length;n++){var i=e.onDequeues[n];i(r)}},shouldRedraw:function(e,r,n,i){for(var a=0;a<r.length;a++)for(var s=r[a].eles,o=0;o<s.length;o++){var l=s[o].boundingBox();if(L_(l,i))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var M7=1,mg=-4,fy=2,A7=3.99,j7=50,R7=50,L7=.15,O7=.1,D7=.9,I7=.9,B7=1,hN=250,z7=4e3*4e3,fN=32767,F7=!0,WP=function(e){var r=this,n=r.renderer=e,i=n.cy;r.layersByLevel={},r.firstGet=!0,r.lastInvalidationTime=qu()-2*hN,r.skipping=!1,r.eleTxrDeqs=i.collection(),r.scheduleElementRefinement=uv(function(){r.refineElementTextures(r.eleTxrDeqs),r.eleTxrDeqs.unmerge(r.eleTxrDeqs)},R7),n.beforeRender(function(s,o){o-r.lastInvalidationTime<=hN?r.skipping=!0:r.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip);var a=function(o,l){return l.reqs-o.reqs};r.layersQueue=new cv(a),r.setupDequeueing()},Ea=WP.prototype,pN=0,V7=Math.pow(2,53)-1;Ea.makeLayer=function(t,e){var r=Math.pow(2,e),n=Math.ceil(t.w*r),i=Math.ceil(t.h*r),a=this.renderer.makeOffscreenCanvas(n,i),s={id:pN=++pN%V7,bb:t,level:e,width:n,height:i,canvas:a,context:a.getContext("2d"),eles:[],elesQueue:[],reqs:0},o=s.context,l=-s.bb.x1,u=-s.bb.y1;return o.scale(r,r),o.translate(l,u),s};Ea.getLayers=function(t,e,r){var n=this,i=n.renderer,a=i.cy,s=a.zoom(),o=n.firstGet;if(n.firstGet=!1,r==null){if(r=Math.ceil(j_(s*e)),r<mg)r=mg;else if(s>=A7||r>fy)return null}n.validateLayersElesOrdering(r,t);var l=n.layersByLevel,u=Math.pow(2,r),c=l[r]=l[r]||[],f,g=n.levelIsComplete(r,t),v,x=function(){var V=function(F){if(n.validateLayersElesOrdering(F,t),n.levelIsComplete(F,t))return v=l[F],!0},$=function(F){if(!v)for(var K=r+F;mg<=K&&K<=fy&&!V(K);K+=F);};$(1),$(-1);for(var Z=c.length-1;Z>=0;Z--){var O=c[Z];O.invalid&&xd(c,O)}};if(!g)x();else return c;var _=function(){if(!f){f=ls();for(var V=0;V<t.length;V++)BO(f,t[V].boundingBox())}return f},S=function(V){V=V||{};var $=V.after;_();var Z=Math.ceil(f.w*u),O=Math.ceil(f.h*u);if(Z>fN||O>fN)return null;var W=Z*O;if(W>z7)return null;var F=n.makeLayer(f,r);if($!=null){var K=c.indexOf($)+1;c.splice(K,0,F)}else(V.insert===void 0||V.insert)&&c.unshift(F);return F};if(n.skipping&&!o)return null;for(var N=null,k=t.length/M7,E=!o,T=0;T<t.length;T++){var R=t[T],j=R._private.rscratch,D=j.imgLayerCaches=j.imgLayerCaches||{},B=D[r];if(B){N=B;continue}if((!N||N.eles.length>=k||!F4(N.bb,R.boundingBox()))&&(N=S({insert:!0,after:N}),!N))return null;v||E?n.queueLayer(N,R):n.drawEleInLayer(N,R,r,e),N.eles.push(R),D[r]=N}return v||(E?null:c)};Ea.getEleLevelForLayerLevel=function(t,e){return t};Ea.drawEleInLayer=function(t,e,r,n){var i=this,a=this.renderer,s=t.context,o=e.boundingBox();o.w===0||o.h===0||!e.visible()||(r=i.getEleLevelForLayerLevel(r,n),a.setImgSmoothing(s,!1),a.drawCachedElement(s,e,null,null,r,F7),a.setImgSmoothing(s,!0))};Ea.levelIsComplete=function(t,e){var r=this,n=r.layersByLevel[t];if(!n||n.length===0)return!1;for(var i=0,a=0;a<n.length;a++){var s=n[a];if(s.reqs>0||s.invalid)return!1;i+=s.eles.length}return i===e.length};Ea.validateLayersElesOrdering=function(t,e){var r=this.layersByLevel[t];if(r)for(var n=0;n<r.length;n++){for(var i=r[n],a=-1,s=0;s<e.length;s++)if(i.eles[0]===e[s]){a=s;break}if(a<0){this.invalidateLayer(i);continue}for(var o=a,s=0;s<i.eles.length;s++)if(i.eles[s]!==e[o+s]){this.invalidateLayer(i);break}}};Ea.updateElementsInLayers=function(t,e){for(var r=this,n=av(t[0]),i=0;i<t.length;i++)for(var a=n?null:t[i],s=n?t[i]:t[i].ele,o=s._private.rscratch,l=o.imgLayerCaches=o.imgLayerCaches||{},u=mg;u<=fy;u++){var c=l[u];c&&(a&&r.getEleLevelForLayerLevel(c.level)!==a.level||e(c,s,a))}};Ea.haveLayers=function(){for(var t=this,e=!1,r=mg;r<=fy;r++){var n=t.layersByLevel[r];if(n&&n.length>0){e=!0;break}}return e};Ea.invalidateElements=function(t){var e=this;t.length!==0&&(e.lastInvalidationTime=qu(),!(t.length===0||!e.haveLayers())&&e.updateElementsInLayers(t,function(n,i,a){e.invalidateLayer(n)}))};Ea.invalidateLayer=function(t){if(this.lastInvalidationTime=qu(),!t.invalid){var e=t.level,r=t.eles,n=this.layersByLevel[e];xd(n,t),t.elesQueue=[],t.invalid=!0,t.replacement&&(t.replacement.invalid=!0);for(var i=0;i<r.length;i++){var a=r[i]._private.rscratch.imgLayerCaches;a&&(a[e]=null)}}};Ea.refineElementTextures=function(t){var e=this;e.updateElementsInLayers(t,function(n,i,a){var s=n.replacement;if(s||(s=n.replacement=e.makeLayer(n.bb,n.level),s.replaces=n,s.eles=n.eles),!s.reqs)for(var o=0;o<s.eles.length;o++)e.queueLayer(s,s.eles[o])})};Ea.enqueueElementRefinement=function(t){this.eleTxrDeqs.merge(t),this.scheduleElementRefinement()};Ea.queueLayer=function(t,e){var r=this,n=r.layersQueue,i=t.elesQueue,a=i.hasId=i.hasId||{};if(!t.replacement){if(e){if(a[e.id()])return;i.push(e),a[e.id()]=!0}t.reqs?(t.reqs++,n.updateItem(t)):(t.reqs=1,n.push(t))}};Ea.dequeue=function(t){for(var e=this,r=e.layersQueue,n=[],i=0;i<B7&&r.size()!==0;){var a=r.peek();if(a.replacement){r.pop();continue}if(a.replaces&&a!==a.replaces.replacement){r.pop();continue}if(a.invalid){r.pop();continue}var s=a.elesQueue.shift();s&&(e.drawEleInLayer(a,s,a.level,t),i++),n.length===0&&n.push(!0),a.elesQueue.length===0&&(r.pop(),a.reqs=0,a.replaces&&e.applyLayerReplacement(a),e.requestRedraw())}return n};Ea.applyLayerReplacement=function(t){var e=this,r=e.layersByLevel[t.level],n=t.replaces,i=r.indexOf(n);if(!(i<0||n.invalid)){r[i]=t;for(var a=0;a<t.eles.length;a++){var s=t.eles[a]._private,o=s.imgLayerCaches=s.imgLayerCaches||{};o&&(o[t.level]=t)}e.requestRedraw()}};Ea.requestRedraw=uv(function(){var t=this.renderer;t.redrawHint("eles",!0),t.redrawHint("drag",!0),t.redraw()},100);Ea.setupDequeueing=GP.setupDequeueing({deqRedrawThreshold:j7,deqCost:L7,deqAvgCost:O7,deqNoDrawCost:D7,deqFastCost:I7,deq:function(e,r){return e.dequeue(r)},onDeqd:M_,shouldRedraw:L4,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var $P={},mN;function U7(t,e){for(var r=0;r<e.length;r++){var n=e[r];t.lineTo(n.x,n.y)}}function H7(t,e,r){for(var n,i=0;i<e.length;i++){var a=e[i];i===0&&(n=a),t.lineTo(a.x,a.y)}t.quadraticCurveTo(r.x,r.y,n.x,n.y)}function gN(t,e,r){t.beginPath&&t.beginPath();for(var n=e,i=0;i<n.length;i++){var a=n[i];t.lineTo(a.x,a.y)}var s=r,o=r[0];t.moveTo(o.x,o.y);for(var i=1;i<s.length;i++){var a=s[i];t.lineTo(a.x,a.y)}t.closePath&&t.closePath()}function G7(t,e,r,n,i){t.beginPath&&t.beginPath(),t.arc(r,n,i,0,Math.PI*2,!1);var a=e,s=a[0];t.moveTo(s.x,s.y);for(var o=0;o<a.length;o++){var l=a[o];t.lineTo(l.x,l.y)}t.closePath&&t.closePath()}function q7(t,e,r,n){t.arc(e,r,n,0,Math.PI*2,!1)}$P.arrowShapeImpl=function(t){return(mN||(mN={polygon:U7,"triangle-backcurve":H7,"triangle-tee":gN,"circle-triangle":G7,"triangle-cross":gN,circle:q7}))[t]};var au={};au.drawElement=function(t,e,r,n,i,a){var s=this;e.isNode()?s.drawNode(t,e,r,n,i,a):s.drawEdge(t,e,r,n,i,a)};au.drawElementOverlay=function(t,e){var r=this;e.isNode()?r.drawNodeOverlay(t,e):r.drawEdgeOverlay(t,e)};au.drawElementUnderlay=function(t,e){var r=this;e.isNode()?r.drawNodeUnderlay(t,e):r.drawEdgeUnderlay(t,e)};au.drawCachedElementPortion=function(t,e,r,n,i,a,s,o){var l=this,u=r.getBoundingBox(e);if(!(u.w===0||u.h===0)){var c=r.getElement(e,u,n,i,a);if(c!=null){var f=o(l,e);if(f===0)return;var g=s(l,e),v=u.x1,x=u.y1,_=u.w,S=u.h,N,k,E,T,R;if(g!==0){var j=r.getRotationPoint(e);E=j.x,T=j.y,t.translate(E,T),t.rotate(g),R=l.getImgSmoothing(t),R||l.setImgSmoothing(t,!0);var D=r.getRotationOffset(e);N=D.x,k=D.y}else N=v,k=x;var B;f!==1&&(B=t.globalAlpha,t.globalAlpha=B*f),t.drawImage(c.texture.canvas,c.x,0,c.width,c.height,N,k,_,S),f!==1&&(t.globalAlpha=B),g!==0&&(t.rotate(-g),t.translate(-E,-T),R||l.setImgSmoothing(t,!1))}else r.drawElement(t,e)}};var W7=function(){return 0},$7=function(e,r){return e.getTextAngle(r,null)},K7=function(e,r){return e.getTextAngle(r,"source")},Z7=function(e,r){return e.getTextAngle(r,"target")},Y7=function(e,r){return r.effectiveOpacity()},tw=function(e,r){return r.pstyle("text-opacity").pfValue*r.effectiveOpacity()};au.drawCachedElement=function(t,e,r,n,i,a){var s=this,o=s.data,l=o.eleTxrCache,u=o.lblTxrCache,c=o.slbTxrCache,f=o.tlbTxrCache,g=e.boundingBox(),v=a===!0?l.reasons.highQuality:null;if(!(g.w===0||g.h===0||!e.visible())&&(!n||L_(g,n))){var x=e.isEdge(),_=e.element()._private.rscratch.badLine;s.drawElementUnderlay(t,e),s.drawCachedElementPortion(t,e,l,r,i,v,W7,Y7),(!x||!_)&&s.drawCachedElementPortion(t,e,u,r,i,v,$7,tw),x&&!_&&(s.drawCachedElementPortion(t,e,c,r,i,v,K7,tw),s.drawCachedElementPortion(t,e,f,r,i,v,Z7,tw)),s.drawElementOverlay(t,e)}};au.drawElements=function(t,e){for(var r=this,n=0;n<e.length;n++){var i=e[n];r.drawElement(t,i)}};au.drawCachedElements=function(t,e,r,n){for(var i=this,a=0;a<e.length;a++){var s=e[a];i.drawCachedElement(t,s,r,n)}};au.drawCachedNodes=function(t,e,r,n){for(var i=this,a=0;a<e.length;a++){var s=e[a];s.isNode()&&i.drawCachedElement(t,s,r,n)}};au.drawLayeredElements=function(t,e,r,n){var i=this,a=i.data.lyrTxrCache.getLayers(e,r);if(a)for(var s=0;s<a.length;s++){var o=a[s],l=o.bb;l.w===0||l.h===0||t.drawImage(o.canvas,l.x1,l.y1,l.w,l.h)}else i.drawCachedElements(t,e,r,n)};var Xu={};Xu.drawEdge=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,o=e._private.rscratch;if(!(a&&!e.visible())&&!(o.badLine||o.allpts==null||isNaN(o.allpts[0]))){var l;r&&(l=r,t.translate(-l.x1,-l.y1));var u=a?e.pstyle("opacity").value:1,c=a?e.pstyle("line-opacity").value:1,f=e.pstyle("curve-style").value,g=e.pstyle("line-style").value,v=e.pstyle("width").pfValue,x=e.pstyle("line-cap").value,_=e.pstyle("line-outline-width").value,S=e.pstyle("line-outline-color").value,N=u*c,k=u*c,E=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N;f==="straight-triangle"?(s.eleStrokeStyle(t,e,F),s.drawEdgeTrianglePath(e,t,o.allpts)):(t.lineWidth=v,t.lineCap=x,s.eleStrokeStyle(t,e,F),s.drawEdgePath(e,t,o.allpts,g),t.lineCap="butt")},T=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:N;if(t.lineWidth=v+_,t.lineCap=x,_>0)s.colorStrokeStyle(t,S[0],S[1],S[2],F);else{t.lineCap="butt";return}f==="straight-triangle"?s.drawEdgeTrianglePath(e,t,o.allpts):(s.drawEdgePath(e,t,o.allpts,g),t.lineCap="butt")},R=function(){i&&s.drawEdgeOverlay(t,e)},j=function(){i&&s.drawEdgeUnderlay(t,e)},D=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:k;s.drawArrowheads(t,e,F)},B=function(){s.drawElementText(t,e,null,n)};t.lineJoin="round";var I=e.pstyle("ghost").value==="yes";if(I){var V=e.pstyle("ghost-offset-x").pfValue,$=e.pstyle("ghost-offset-y").pfValue,Z=e.pstyle("ghost-opacity").value,O=N*Z;t.translate(V,$),E(O),D(O),t.translate(-V,-$)}else T();j(),E(),D(),R(),B(),r&&t.translate(l.x1,l.y1)}};var KP=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(r,n){if(n.visible()){var i=n.pstyle("".concat(e,"-opacity")).value;if(i!==0){var a=this,s=a.usePaths(),o=n._private.rscratch,l=n.pstyle("".concat(e,"-padding")).pfValue,u=2*l,c=n.pstyle("".concat(e,"-color")).value;r.lineWidth=u,o.edgeType==="self"&&!s?r.lineCap="butt":r.lineCap="round",a.colorStrokeStyle(r,c[0],c[1],c[2],i),a.drawEdgePath(n,r,o.allpts,"solid")}}}};Xu.drawEdgeOverlay=KP("overlay");Xu.drawEdgeUnderlay=KP("underlay");Xu.drawEdgePath=function(t,e,r,n){var i=t._private.rscratch,a=e,s,o=!1,l=this.usePaths(),u=t.pstyle("line-dash-pattern").pfValue,c=t.pstyle("line-dash-offset").pfValue;if(l){var f=r.join("$"),g=i.pathCacheKey&&i.pathCacheKey===f;g?(s=e=i.pathCache,o=!0):(s=e=new Path2D,i.pathCacheKey=f,i.pathCache=s)}if(a.setLineDash)switch(n){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash(u),a.lineDashOffset=c;break;case"solid":a.setLineDash([]);break}if(!o&&!i.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(r[0],r[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var v=2;v+3<r.length;v+=4)e.quadraticCurveTo(r[v],r[v+1],r[v+2],r[v+3]);break;case"straight":case"haystack":for(var x=2;x+1<r.length;x+=2)e.lineTo(r[x],r[x+1]);break;case"segments":if(i.isRound){var _=As(i.roundCorners),S;try{for(_.s();!(S=_.n()).done;){var N=S.value;DP(e,N)}}catch(E){_.e(E)}finally{_.f()}e.lineTo(r[r.length-2],r[r.length-1])}else for(var k=2;k+1<r.length;k+=2)e.lineTo(r[k],r[k+1]);break}e=a,l?e.stroke(s):e.stroke(),e.setLineDash&&e.setLineDash([])};Xu.drawEdgeTrianglePath=function(t,e,r){e.fillStyle=e.strokeStyle;for(var n=t.pstyle("width").pfValue,i=0;i+1<r.length;i+=2){var a=[r[i+2]-r[i],r[i+3]-r[i+1]],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]),o=[a[1]/s,-a[0]/s],l=[o[0]*n/2,o[1]*n/2];e.beginPath(),e.moveTo(r[i]-l[0],r[i+1]-l[1]),e.lineTo(r[i]+l[0],r[i+1]+l[1]),e.lineTo(r[i+2],r[i+3]),e.closePath(),e.fill()}};Xu.drawArrowheads=function(t,e,r){var n=e._private.rscratch,i=n.edgeType==="haystack";i||this.drawArrowhead(t,e,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,r),this.drawArrowhead(t,e,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,r),this.drawArrowhead(t,e,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,r),i||this.drawArrowhead(t,e,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,r)};Xu.drawArrowhead=function(t,e,r,n,i,a,s){if(!(isNaN(n)||n==null||isNaN(i)||i==null||isNaN(a)||a==null)){var o=this,l=e.pstyle(r+"-arrow-shape").value;if(l!=="none"){var u=e.pstyle(r+"-arrow-fill").value==="hollow"?"both":"filled",c=e.pstyle(r+"-arrow-fill").value,f=e.pstyle("width").pfValue,g=e.pstyle(r+"-arrow-width"),v=g.value==="match-line"?f:g.pfValue;g.units==="%"&&(v*=f);var x=e.pstyle("opacity").value;s===void 0&&(s=x);var _=t.globalCompositeOperation;(s!==1||c==="hollow")&&(t.globalCompositeOperation="destination-out",o.colorFillStyle(t,255,255,255,1),o.colorStrokeStyle(t,255,255,255,1),o.drawArrowShape(e,t,u,f,l,v,n,i,a),t.globalCompositeOperation=_);var S=e.pstyle(r+"-arrow-color").value;o.colorFillStyle(t,S[0],S[1],S[2],s),o.colorStrokeStyle(t,S[0],S[1],S[2],s),o.drawArrowShape(e,t,c,f,l,v,n,i,a)}}};Xu.drawArrowShape=function(t,e,r,n,i,a,s,o,l){var u=this,c=this.usePaths()&&i!=="triangle-cross",f=!1,g,v=e,x={x:s,y:o},_=t.pstyle("arrow-scale").value,S=this.getArrowWidth(n,_),N=u.arrowShapes[i];if(c){var k=u.arrowPathCache=u.arrowPathCache||[],E=Lh(i),T=k[E];T!=null?(g=e=T,f=!0):(g=e=new Path2D,k[E]=g)}f||(e.beginPath&&e.beginPath(),c?N.draw(e,1,0,{x:0,y:0},1):N.draw(e,S,l,x,n),e.closePath&&e.closePath()),e=v,c&&(e.translate(s,o),e.rotate(l),e.scale(S,S)),(r==="filled"||r==="both")&&(c?e.fill(g):e.fill()),(r==="hollow"||r==="both")&&(e.lineWidth=a/(c?S:1),e.lineJoin="miter",c?e.stroke(g):e.stroke()),c&&(e.scale(1/S,1/S),e.rotate(-l),e.translate(-s,-o))};var K_={};K_.safeDrawImage=function(t,e,r,n,i,a,s,o,l,u){if(!(i<=0||a<=0||l<=0||u<=0))try{t.drawImage(e,r,n,i,a,s,o,l,u)}catch(c){Br(c)}};K_.drawInscribedImage=function(t,e,r,n,i){var a=this,s=r.position(),o=s.x,l=s.y,u=r.cy().style(),c=u.getIndexedStyle.bind(u),f=c(r,"background-fit","value",n),g=c(r,"background-repeat","value",n),v=r.width(),x=r.height(),_=r.padding()*2,S=v+(c(r,"background-width-relative-to","value",n)==="inner"?0:_),N=x+(c(r,"background-height-relative-to","value",n)==="inner"?0:_),k=r._private.rscratch,E=c(r,"background-clip","value",n),T=E==="node",R=c(r,"background-image-opacity","value",n)*i,j=c(r,"background-image-smoothing","value",n),D=r.pstyle("corner-radius").value;D!=="auto"&&(D=r.pstyle("corner-radius").pfValue);var B=e.width||e.cachedW,I=e.height||e.cachedH;(B==null||I==null)&&(document.body.appendChild(e),B=e.cachedW=e.width||e.offsetWidth,I=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var V=B,$=I;if(c(r,"background-width","value",n)!=="auto"&&(c(r,"background-width","units",n)==="%"?V=c(r,"background-width","pfValue",n)*S:V=c(r,"background-width","pfValue",n)),c(r,"background-height","value",n)!=="auto"&&(c(r,"background-height","units",n)==="%"?$=c(r,"background-height","pfValue",n)*N:$=c(r,"background-height","pfValue",n)),!(V===0||$===0)){if(f==="contain"){var Z=Math.min(S/V,N/$);V*=Z,$*=Z}else if(f==="cover"){var Z=Math.max(S/V,N/$);V*=Z,$*=Z}var O=o-S/2,W=c(r,"background-position-x","units",n),F=c(r,"background-position-x","pfValue",n);W==="%"?O+=(S-V)*F:O+=F;var K=c(r,"background-offset-x","units",n),X=c(r,"background-offset-x","pfValue",n);K==="%"?O+=(S-V)*X:O+=X;var Q=l-N/2,ae=c(r,"background-position-y","units",n),re=c(r,"background-position-y","pfValue",n);ae==="%"?Q+=(N-$)*re:Q+=re;var G=c(r,"background-offset-y","units",n),te=c(r,"background-offset-y","pfValue",n);G==="%"?Q+=(N-$)*te:Q+=te,k.pathCache&&(O-=o,Q-=l,o=0,l=0);var ne=t.globalAlpha;t.globalAlpha=R;var de=a.getImgSmoothing(t),me=!1;if(j==="no"&&de?(a.setImgSmoothing(t,!1),me=!0):j==="yes"&&!de&&(a.setImgSmoothing(t,!0),me=!0),g==="no-repeat")T&&(t.save(),k.pathCache?t.clip(k.pathCache):(a.nodeShapes[a.getNodeShape(r)].draw(t,o,l,S,N,D,k),t.clip())),a.safeDrawImage(t,e,0,0,B,I,O,Q,V,$),T&&t.restore();else{var ye=t.createPattern(e,g);t.fillStyle=ye,a.nodeShapes[a.getNodeShape(r)].draw(t,o,l,S,N,D,k),t.translate(O,Q),t.fill(),t.translate(-O,-Q)}t.globalAlpha=ne,me&&a.setImgSmoothing(t,de)}};var Zh={};Zh.eleTextBiggerThanMin=function(t,e){if(!e){var r=t.cy().zoom(),n=this.getPixelRatio(),i=Math.ceil(j_(r*n));e=Math.pow(2,i)}var a=t.pstyle("font-size").pfValue*e,s=t.pstyle("min-zoomed-font-size").pfValue;return!(a<s)};Zh.drawElementText=function(t,e,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this;if(n==null){if(a&&!s.eleTextBiggerThanMin(e))return}else if(n===!1)return;if(e.isNode()){var o=e.pstyle("label");if(!o||!o.value)return;var l=s.getLabelJustification(e);t.textAlign=l,t.textBaseline="bottom"}else{var u=e.element()._private.rscratch.badLine,c=e.pstyle("label"),f=e.pstyle("source-label"),g=e.pstyle("target-label");if(u||(!c||!c.value)&&(!f||!f.value)&&(!g||!g.value))return;t.textAlign="center",t.textBaseline="bottom"}var v=!r,x;r&&(x=r,t.translate(-x.x1,-x.y1)),i==null?(s.drawText(t,e,null,v,a),e.isEdge()&&(s.drawText(t,e,"source",v,a),s.drawText(t,e,"target",v,a))):s.drawText(t,e,i,v,a),r&&t.translate(x.x1,x.y1)};Zh.getFontCache=function(t){var e;this.fontCaches=this.fontCaches||[];for(var r=0;r<this.fontCaches.length;r++)if(e=this.fontCaches[r],e.context===t)return e;return e={context:t},this.fontCaches.push(e),e};Zh.setupTextStyle=function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=e.pstyle("font-style").strValue,i=e.pstyle("font-size").pfValue+"px",a=e.pstyle("font-family").strValue,s=e.pstyle("font-weight").strValue,o=r?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,l=e.pstyle("text-outline-opacity").value*o,u=e.pstyle("color").value,c=e.pstyle("text-outline-color").value;t.font=n+" "+s+" "+i+" "+a,t.lineJoin="round",this.colorFillStyle(t,u[0],u[1],u[2],o),this.colorStrokeStyle(t,c[0],c[1],c[2],l)};function X7(t,e,r,n,i){var a=Math.min(n,i),s=a/2,o=e+n/2,l=r+i/2;t.beginPath(),t.arc(o,l,s,0,Math.PI*2),t.closePath()}function vN(t,e,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,s=Math.min(a,n/2,i/2);t.beginPath(),t.moveTo(e+s,r),t.lineTo(e+n-s,r),t.quadraticCurveTo(e+n,r,e+n,r+s),t.lineTo(e+n,r+i-s),t.quadraticCurveTo(e+n,r+i,e+n-s,r+i),t.lineTo(e+s,r+i),t.quadraticCurveTo(e,r+i,e,r+i-s),t.lineTo(e,r+s),t.quadraticCurveTo(e,r,e+s,r),t.closePath()}Zh.getTextAngle=function(t,e){var r,n=t._private,i=n.rscratch,a=e?e+"-":"",s=t.pstyle(a+"text-rotation");if(s.strValue==="autorotate"){var o=Ts(i,"labelAngle",e);r=t.isEdge()?o:0}else s.strValue==="none"?r=0:r=s.pfValue;return r};Zh.drawText=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=e._private,s=a.rscratch,o=i?e.effectiveOpacity():1;if(!(i&&(o===0||e.pstyle("text-opacity").value===0))){r==="main"&&(r=null);var l=Ts(s,"labelX",r),u=Ts(s,"labelY",r),c,f,g=this.getLabelText(e,r);if(g!=null&&g!==""&&!isNaN(l)&&!isNaN(u)){this.setupTextStyle(t,e,i);var v=r?r+"-":"",x=Ts(s,"labelWidth",r),_=Ts(s,"labelHeight",r),S=e.pstyle(v+"text-margin-x").pfValue,N=e.pstyle(v+"text-margin-y").pfValue,k=e.isEdge(),E=e.pstyle("text-halign").value,T=e.pstyle("text-valign").value;k&&(E="center",T="center"),l+=S,u+=N;var R;switch(n?R=this.getTextAngle(e,r):R=0,R!==0&&(c=l,f=u,t.translate(c,f),t.rotate(R),l=0,u=0),T){case"top":break;case"center":u+=_/2;break;case"bottom":u+=_;break}var j=e.pstyle("text-background-opacity").value,D=e.pstyle("text-border-opacity").value,B=e.pstyle("text-border-width").pfValue,I=e.pstyle("text-background-padding").pfValue,V=e.pstyle("text-background-shape").strValue,$=V==="round-rectangle"||V==="roundrectangle",Z=V==="circle",O=2;if(j>0||B>0&&D>0){var W=t.fillStyle,F=t.strokeStyle,K=t.lineWidth,X=e.pstyle("text-background-color").value,Q=e.pstyle("text-border-color").value,ae=e.pstyle("text-border-style").value,re=j>0,G=B>0&&D>0,te=l-I;switch(E){case"left":te-=x;break;case"center":te-=x/2;break}var ne=u-_-I,de=x+2*I,me=_+2*I;if(re&&(t.fillStyle="rgba(".concat(X[0],",").concat(X[1],",").concat(X[2],",").concat(j*o,")")),G&&(t.strokeStyle="rgba(".concat(Q[0],",").concat(Q[1],",").concat(Q[2],",").concat(D*o,")"),t.lineWidth=B,t.setLineDash))switch(ae){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"double":t.lineWidth=B/4,t.setLineDash([]);break;default:t.setLineDash([]);break}if($?(t.beginPath(),vN(t,te,ne,de,me,O)):Z?(t.beginPath(),X7(t,te,ne,de,me)):(t.beginPath(),t.rect(te,ne,de,me)),re&&t.fill(),G&&t.stroke(),G&&ae==="double"){var ye=B/2;t.beginPath(),$?vN(t,te+ye,ne+ye,de-2*ye,me-2*ye,O):t.rect(te+ye,ne+ye,de-2*ye,me-2*ye),t.stroke()}t.fillStyle=W,t.strokeStyle=F,t.lineWidth=K,t.setLineDash&&t.setLineDash([])}var ie=2*e.pstyle("text-outline-width").pfValue;if(ie>0&&(t.lineWidth=ie),e.pstyle("text-wrap").value==="wrap"){var pe=Ts(s,"labelWrapCachedLines",r),oe=Ts(s,"labelLineHeight",r),fe=x/2,ge=this.getLabelJustification(e);switch(ge==="auto"||(E==="left"?ge==="left"?l+=-x:ge==="center"&&(l+=-fe):E==="center"?ge==="left"?l+=-fe:ge==="right"&&(l+=fe):E==="right"&&(ge==="center"?l+=fe:ge==="right"&&(l+=x))),T){case"top":u-=(pe.length-1)*oe;break;case"center":case"bottom":u-=(pe.length-1)*oe;break}for(var be=0;be<pe.length;be++)ie>0&&t.strokeText(pe[be],l,u),t.fillText(pe[be],l,u),u+=oe}else ie>0&&t.strokeText(g,l,u),t.fillText(g,l,u);R!==0&&(t.rotate(-R),t.translate(-c,-f))}}};var Md={};Md.drawNode=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,o,l,u=e._private,c=u.rscratch,f=e.position();if(!(!dt(f.x)||!dt(f.y))&&!(a&&!e.visible())){var g=a?e.effectiveOpacity():1,v=s.usePaths(),x,_=!1,S=e.padding();o=e.width()+2*S,l=e.height()+2*S;var N;r&&(N=r,t.translate(-N.x1,-N.y1));for(var k=e.pstyle("background-image"),E=k.value,T=new Array(E.length),R=new Array(E.length),j=0,D=0;D<E.length;D++){var B=E[D],I=T[D]=B!=null&&B!=="none";if(I){var V=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",D);j++,R[D]=s.getCachedImage(B,V,function(){u.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var $=e.pstyle("background-blacken").value,Z=e.pstyle("border-width").pfValue,O=e.pstyle("background-opacity").value*g,W=e.pstyle("border-color").value,F=e.pstyle("border-style").value,K=e.pstyle("border-join").value,X=e.pstyle("border-cap").value,Q=e.pstyle("border-position").value,ae=e.pstyle("border-dash-pattern").pfValue,re=e.pstyle("border-dash-offset").pfValue,G=e.pstyle("border-opacity").value*g,te=e.pstyle("outline-width").pfValue,ne=e.pstyle("outline-color").value,de=e.pstyle("outline-style").value,me=e.pstyle("outline-opacity").value*g,ye=e.pstyle("outline-offset").value,ie=e.pstyle("corner-radius").value;ie!=="auto"&&(ie=e.pstyle("corner-radius").pfValue);var pe=function(){var st=arguments.length>0&&arguments[0]!==void 0?arguments[0]:O;s.eleFillStyle(t,e,st)},oe=function(){var st=arguments.length>0&&arguments[0]!==void 0?arguments[0]:G;s.colorStrokeStyle(t,W[0],W[1],W[2],st)},fe=function(){var st=arguments.length>0&&arguments[0]!==void 0?arguments[0]:me;s.colorStrokeStyle(t,ne[0],ne[1],ne[2],st)},ge=function(st,Ge,ue,ve){var ke=s.nodePathCache=s.nodePathCache||[],Ne=R4(ue==="polygon"?ue+","+ve.join(","):ue,""+Ge,""+st,""+ie),je=ke[Ne],Ze,He=!1;return je!=null?(Ze=je,He=!0,c.pathCache=Ze):(Ze=new Path2D,ke[Ne]=c.pathCache=Ze),{path:Ze,cacheHit:He}},be=e.pstyle("shape").strValue,_e=e.pstyle("shape-polygon-points").pfValue;if(v){t.translate(f.x,f.y);var De=ge(o,l,be,_e);x=De.path,_=De.cacheHit}var qe=function(){if(!_){var st=f;v&&(st={x:0,y:0}),s.nodeShapes[s.getNodeShape(e)].draw(x||t,st.x,st.y,o,l,ie,c)}v?t.fill(x):t.fill()},Ue=function(){for(var st=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g,Ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,ue=u.backgrounding,ve=0,ke=0;ke<R.length;ke++){var Ne=e.cy().style().getIndexedStyle(e,"background-image-containment","value",ke);if(Ge&&Ne==="over"||!Ge&&Ne==="inside"){ve++;continue}T[ke]&&R[ke].complete&&!R[ke].error&&(ve++,s.drawInscribedImage(t,R[ke],e,ke,st))}u.backgrounding=ve!==j,ue!==u.backgrounding&&e.updateStyle(!1)},Ve=function(){var st=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;s.hasPie(e)&&(s.drawPie(t,e,Ge),st&&(v||s.nodeShapes[s.getNodeShape(e)].draw(t,f.x,f.y,o,l,ie,c)))},Je=function(){var st=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g;s.hasStripe(e)&&(t.save(),v?t.clip(c.pathCache):(s.nodeShapes[s.getNodeShape(e)].draw(t,f.x,f.y,o,l,ie,c),t.clip()),s.drawStripe(t,e,Ge),t.restore(),st&&(v||s.nodeShapes[s.getNodeShape(e)].draw(t,f.x,f.y,o,l,ie,c)))},ft=function(){var st=arguments.length>0&&arguments[0]!==void 0?arguments[0]:g,Ge=($>0?$:-$)*st,ue=$>0?0:255;$!==0&&(s.colorFillStyle(t,ue,ue,ue,Ge),v?t.fill(x):t.fill())},We=function(){if(Z>0){if(t.lineWidth=Z,t.lineCap=X,t.lineJoin=K,t.setLineDash)switch(F){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash(ae),t.lineDashOffset=re;break;case"solid":case"double":t.setLineDash([]);break}if(Q!=="center"){if(t.save(),t.lineWidth*=2,Q==="inside")v?t.clip(x):t.clip();else{var st=new Path2D;st.rect(-o/2-Z,-l/2-Z,o+2*Z,l+2*Z),st.addPath(x),t.clip(st,"evenodd")}v?t.stroke(x):t.stroke(),t.restore()}else v?t.stroke(x):t.stroke();if(F==="double"){t.lineWidth=Z/3;var Ge=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",v?t.stroke(x):t.stroke(),t.globalCompositeOperation=Ge}t.setLineDash&&t.setLineDash([])}},Ce=function(){if(te>0){if(t.lineWidth=te,t.lineCap="butt",t.setLineDash)switch(de){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"solid":case"double":t.setLineDash([]);break}var st=f;v&&(st={x:0,y:0});var Ge=s.getNodeShape(e),ue=Z;Q==="inside"&&(ue=0),Q==="outside"&&(ue*=2);var ve=(o+ue+(te+ye))/o,ke=(l+ue+(te+ye))/l,Ne=o*ve,je=l*ke,Ze=s.nodeShapes[Ge].points,He;if(v){var ut=ge(Ne,je,Ge,Ze);He=ut.path}if(Ge==="ellipse")s.drawEllipsePath(He||t,st.x,st.y,Ne,je);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(Ge)){var lt=0,_t=0,Bt=0;Ge==="round-diamond"?lt=(ue+ye+te)*1.4:Ge==="round-heptagon"?(lt=(ue+ye+te)*1.075,Bt=-(ue/2+ye+te)/35):Ge==="round-hexagon"?lt=(ue+ye+te)*1.12:Ge==="round-pentagon"?(lt=(ue+ye+te)*1.13,Bt=-(ue/2+ye+te)/15):Ge==="round-tag"?(lt=(ue+ye+te)*1.12,_t=(ue/2+te+ye)*.07):Ge==="round-triangle"&&(lt=(ue+ye+te)*(Math.PI/2),Bt=-(ue+ye/2+te)/Math.PI),lt!==0&&(ve=(o+lt)/o,Ne=o*ve,["round-hexagon","round-tag"].includes(Ge)||(ke=(l+lt)/l,je=l*ke)),ie=ie==="auto"?H4(Ne,je):ie;for(var zt=Ne/2,vt=je/2,Ht=ie+(ue+te+ye)/2,qt=new Array(Ze.length/2),Sr=new Array(Ze.length/2),fr=0;fr<Ze.length/2;fr++)qt[fr]={x:st.x+_t+zt*Ze[fr*2],y:st.y+Bt+vt*Ze[fr*2+1]};var fn,Gr,qr,nn,ur=qt.length;for(Gr=qt[ur-1],fn=0;fn<ur;fn++)qr=qt[fn%ur],nn=qt[(fn+1)%ur],Sr[fn]=W_(Gr,qr,nn,Ht),Gr=qr,qr=nn;s.drawRoundPolygonPath(He||t,st.x+_t,st.y+Bt,o*ve,l*ke,Ze,Sr)}else if(["roundrectangle","round-rectangle"].includes(Ge))ie=ie==="auto"?bd(Ne,je):ie,s.drawRoundRectanglePath(He||t,st.x,st.y,Ne,je,ie+(ue+te+ye)/2);else if(["cutrectangle","cut-rectangle"].includes(Ge))ie=ie==="auto"?O_():ie,s.drawCutRectanglePath(He||t,st.x,st.y,Ne,je,null,ie+(ue+te+ye)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(Ge))ie=ie==="auto"?bd(Ne,je):ie,s.drawBottomRoundRectanglePath(He||t,st.x,st.y,Ne,je,ie+(ue+te+ye)/2);else if(Ge==="barrel")s.drawBarrelPath(He||t,st.x,st.y,Ne,je);else if(Ge.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(Ge)){var yt=(ue+te+ye)/o;Ze=sy(oy(Ze,yt)),s.drawPolygonPath(He||t,st.x,st.y,o,l,Ze)}else{var Lr=(ue+te+ye)/o;Ze=sy(oy(Ze,-Lr)),s.drawPolygonPath(He||t,st.x,st.y,o,l,Ze)}if(v?t.stroke(He):t.stroke(),de==="double"){t.lineWidth=ue/3;var Yn=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",v?t.stroke(He):t.stroke(),t.globalCompositeOperation=Yn}t.setLineDash&&t.setLineDash([])}},ze=function(){i&&s.drawNodeOverlay(t,e,f,o,l)},Ke=function(){i&&s.drawNodeUnderlay(t,e,f,o,l)},et=function(){s.drawElementText(t,e,null,n)},ht=e.pstyle("ghost").value==="yes";if(ht){var Nt=e.pstyle("ghost-offset-x").pfValue,Mt=e.pstyle("ghost-offset-y").pfValue,jt=e.pstyle("ghost-opacity").value,Wt=jt*g;t.translate(Nt,Mt),fe(),Ce(),pe(jt*O),qe(),Ue(Wt,!0),oe(jt*G),We(),Ve($!==0||Z!==0),Je($!==0||Z!==0),Ue(Wt,!1),ft(Wt),t.translate(-Nt,-Mt)}v&&t.translate(-f.x,-f.y),Ke(),v&&t.translate(f.x,f.y),fe(),Ce(),pe(),qe(),Ue(g,!0),oe(),We(),Ve($!==0||Z!==0),Je($!==0||Z!==0),Ue(g,!1),ft(),v&&t.translate(-f.x,-f.y),et(),ze(),r&&t.translate(N.x1,N.y1)}};var ZP=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(r,n,i,a,s){var o=this;if(n.visible()){var l=n.pstyle("".concat(e,"-padding")).pfValue,u=n.pstyle("".concat(e,"-opacity")).value,c=n.pstyle("".concat(e,"-color")).value,f=n.pstyle("".concat(e,"-shape")).value,g=n.pstyle("".concat(e,"-corner-radius")).value;if(u>0){if(i=i||n.position(),a==null||s==null){var v=n.padding();a=n.width()+2*v,s=n.height()+2*v}o.colorFillStyle(r,c[0],c[1],c[2],u),o.nodeShapes[f].draw(r,i.x,i.y,a+l*2,s+l*2,g),r.fill()}}}};Md.drawNodeOverlay=ZP("overlay");Md.drawNodeUnderlay=ZP("underlay");Md.hasPie=function(t){return t=t[0],t._private.hasPie};Md.hasStripe=function(t){return t=t[0],t._private.hasStripe};Md.drawPie=function(t,e,r,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=e.pstyle("pie-size"),s=e.pstyle("pie-hole"),o=e.pstyle("pie-start-angle").pfValue,l=n.x,u=n.y,c=e.width(),f=e.height(),g=Math.min(c,f)/2,v,x=0,_=this.usePaths();if(_&&(l=0,u=0),a.units==="%"?g=g*a.pfValue:a.pfValue!==void 0&&(g=a.pfValue/2),s.units==="%"?v=g*s.pfValue:s.pfValue!==void 0&&(v=s.pfValue/2),!(v>=g))for(var S=1;S<=i.pieBackgroundN;S++){var N=e.pstyle("pie-"+S+"-background-size").value,k=e.pstyle("pie-"+S+"-background-color").value,E=e.pstyle("pie-"+S+"-background-opacity").value*r,T=N/100;T+x>1&&(T=1-x);var R=1.5*Math.PI+2*Math.PI*x;R+=o;var j=2*Math.PI*T,D=R+j;N===0||x>=1||x+T>1||(v===0?(t.beginPath(),t.moveTo(l,u),t.arc(l,u,g,R,D),t.closePath()):(t.beginPath(),t.arc(l,u,g,R,D),t.arc(l,u,v,D,R,!0),t.closePath()),this.colorFillStyle(t,k[0],k[1],k[2],E),t.fill(),x+=T)}};Md.drawStripe=function(t,e,r,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=n.x,s=n.y,o=e.width(),l=e.height(),u=0,c=this.usePaths();t.save();var f=e.pstyle("stripe-direction").value,g=e.pstyle("stripe-size");switch(f){case"vertical":break;case"righward":t.rotate(-Math.PI/2);break}var v=o,x=l;g.units==="%"?(v=v*g.pfValue,x=x*g.pfValue):g.pfValue!==void 0&&(v=g.pfValue,x=g.pfValue),c&&(a=0,s=0),s-=v/2,a-=x/2;for(var _=1;_<=i.stripeBackgroundN;_++){var S=e.pstyle("stripe-"+_+"-background-size").value,N=e.pstyle("stripe-"+_+"-background-color").value,k=e.pstyle("stripe-"+_+"-background-opacity").value*r,E=S/100;E+u>1&&(E=1-u),!(S===0||u>=1||u+E>1)&&(t.beginPath(),t.rect(a,s+x*u,v,x*E),t.closePath(),this.colorFillStyle(t,N[0],N[1],N[2],k),t.fill(),u+=E)}t.restore()};var hs={},Q7=100;hs.getPixelRatio=function(){var t=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),r=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/r};hs.paintCache=function(t){for(var e=this.paintCaches=this.paintCaches||[],r=!0,n,i=0;i<e.length;i++)if(n=e[i],n.context===t){r=!1;break}return r&&(n={context:t},e.push(n)),n};hs.createGradientStyleFor=function(t,e,r,n,i){var a,s=this.usePaths(),o=r.pstyle(e+"-gradient-stop-colors").value,l=r.pstyle(e+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(r.isEdge()){var u=r.sourceEndpoint(),c=r.targetEndpoint(),f=r.midpoint(),g=Oh(u,f),v=Oh(c,f);a=t.createRadialGradient(f.x,f.y,0,f.x,f.y,Math.max(g,v))}else{var x=s?{x:0,y:0}:r.position(),_=r.paddedWidth(),S=r.paddedHeight();a=t.createRadialGradient(x.x,x.y,0,x.x,x.y,Math.max(_,S))}else if(r.isEdge()){var N=r.sourceEndpoint(),k=r.targetEndpoint();a=t.createLinearGradient(N.x,N.y,k.x,k.y)}else{var E=s?{x:0,y:0}:r.position(),T=r.paddedWidth(),R=r.paddedHeight(),j=T/2,D=R/2,B=r.pstyle("background-gradient-direction").value;switch(B){case"to-bottom":a=t.createLinearGradient(E.x,E.y-D,E.x,E.y+D);break;case"to-top":a=t.createLinearGradient(E.x,E.y+D,E.x,E.y-D);break;case"to-left":a=t.createLinearGradient(E.x+j,E.y,E.x-j,E.y);break;case"to-right":a=t.createLinearGradient(E.x-j,E.y,E.x+j,E.y);break;case"to-bottom-right":case"to-right-bottom":a=t.createLinearGradient(E.x-j,E.y-D,E.x+j,E.y+D);break;case"to-top-right":case"to-right-top":a=t.createLinearGradient(E.x-j,E.y+D,E.x+j,E.y-D);break;case"to-bottom-left":case"to-left-bottom":a=t.createLinearGradient(E.x+j,E.y-D,E.x-j,E.y+D);break;case"to-top-left":case"to-left-top":a=t.createLinearGradient(E.x+j,E.y+D,E.x-j,E.y-D);break}}if(!a)return null;for(var I=l.length===o.length,V=o.length,$=0;$<V;$++)a.addColorStop(I?l[$]:$/(V-1),"rgba("+o[$][0]+","+o[$][1]+","+o[$][2]+","+i+")");return a};hs.gradientFillStyle=function(t,e,r,n){var i=this.createGradientStyleFor(t,"background",e,r,n);if(!i)return null;t.fillStyle=i};hs.colorFillStyle=function(t,e,r,n,i){t.fillStyle="rgba("+e+","+r+","+n+","+i+")"};hs.eleFillStyle=function(t,e,r){var n=e.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(t,e,n,r);else{var i=e.pstyle("background-color").value;this.colorFillStyle(t,i[0],i[1],i[2],r)}};hs.gradientStrokeStyle=function(t,e,r,n){var i=this.createGradientStyleFor(t,"line",e,r,n);if(!i)return null;t.strokeStyle=i};hs.colorStrokeStyle=function(t,e,r,n,i){t.strokeStyle="rgba("+e+","+r+","+n+","+i+")"};hs.eleStrokeStyle=function(t,e,r){var n=e.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(t,e,n,r);else{var i=e.pstyle("line-color").value;this.colorStrokeStyle(t,i[0],i[1],i[2],r)}};hs.matchCanvasSize=function(t){var e=this,r=e.data,n=e.findContainerClientCoords(),i=n[2],a=n[3],s=e.getPixelRatio(),o=e.motionBlurPxRatio;(t===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||t===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(s=o);var l=i*s,u=a*s,c;if(!(l===e.canvasWidth&&u===e.canvasHeight)){e.fontCaches=null;var f=r.canvasContainer;f.style.width=i+"px",f.style.height=a+"px";for(var g=0;g<e.CANVAS_LAYERS;g++)c=r.canvases[g],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=a+"px";for(var g=0;g<e.BUFFER_COUNT;g++)c=r.bufferCanvases[g],c.width=l,c.height=u,c.style.width=i+"px",c.style.height=a+"px";e.textureMult=1,s<=1&&(c=r.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,c.width=l*e.textureMult,c.height=u*e.textureMult),e.canvasWidth=l,e.canvasHeight=u,e.pixelRatio=s}};hs.renderTo=function(t,e,r,n){this.render({forcedContext:t,forcedZoom:e,forcedPan:r,drawAllLayers:!0,forcedPxRatio:n})};hs.clearCanvas=function(){var t=this,e=t.data;function r(n){n.clearRect(0,0,t.canvasWidth,t.canvasHeight)}r(e.contexts[t.NODE]),r(e.contexts[t.DRAG])};hs.render=function(t){var e=this;t=t||I4();var r=e.cy,n=t.forcedContext,i=t.drawAllLayers,a=t.drawOnlyNodeLayer,s=t.forcedZoom,o=t.forcedPan,l=t.forcedPxRatio===void 0?this.getPixelRatio():t.forcedPxRatio,u=e.data,c=u.canvasNeedsRedraw,f=e.textureOnViewport&&!n&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),g=t.motionBlur!==void 0?t.motionBlur:e.motionBlur,v=e.motionBlurPxRatio,x=r.hasCompoundNodes(),_=e.hoverData.draggingEles,S=!!(e.hoverData.selecting||e.touchData.selecting);g=g&&!n&&e.motionBlurEnabled&&!S;var N=g;n||(e.prevPxRatio!==l&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=l),!n&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),g&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(N=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!f&&(c[e.NODE]=!0,c[e.SELECT_BOX]=!0);var k=r.style(),E=r.zoom(),T=s!==void 0?s:E,R=r.pan(),j={x:R.x,y:R.y},D={zoom:E,pan:{x:R.x,y:R.y}},B=e.prevViewport,I=B===void 0||D.zoom!==B.zoom||D.pan.x!==B.pan.x||D.pan.y!==B.pan.y;!I&&!(_&&!x)&&(e.motionBlurPxRatio=1),o&&(j=o),T*=l,j.x*=l,j.y*=l;var V=e.getCachedZSortedEles();function $(oe,fe,ge,be,_e){var De=oe.globalCompositeOperation;oe.globalCompositeOperation="destination-out",e.colorFillStyle(oe,255,255,255,e.motionBlurTransparency),oe.fillRect(fe,ge,be,_e),oe.globalCompositeOperation=De}function Z(oe,fe){var ge,be,_e,De;!e.clearingMotionBlur&&(oe===u.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||oe===u.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(ge={x:R.x*v,y:R.y*v},be=E*v,_e=e.canvasWidth*v,De=e.canvasHeight*v):(ge=j,be=T,_e=e.canvasWidth,De=e.canvasHeight),oe.setTransform(1,0,0,1,0,0),fe==="motionBlur"?$(oe,0,0,_e,De):!n&&(fe===void 0||fe)&&oe.clearRect(0,0,_e,De),i||(oe.translate(ge.x,ge.y),oe.scale(be,be)),o&&oe.translate(o.x,o.y),s&&oe.scale(s,s)}if(f||(e.textureDrawLastFrame=!1),f){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=r.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var O=e.data.bufferContexts[e.TEXTURE_BUFFER];O.setTransform(1,0,0,1,0,0),O.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:O,drawOnlyNodeLayer:!0,forcedPxRatio:l*e.textureMult});var D=e.textureCache.viewport={zoom:r.zoom(),pan:r.pan(),width:e.canvasWidth,height:e.canvasHeight};D.mpan={x:(0-D.pan.x)/D.zoom,y:(0-D.pan.y)/D.zoom}}c[e.DRAG]=!1,c[e.NODE]=!1;var W=u.contexts[e.NODE],F=e.textureCache.texture,D=e.textureCache.viewport;W.setTransform(1,0,0,1,0,0),g?$(W,0,0,D.width,D.height):W.clearRect(0,0,D.width,D.height);var K=k.core("outside-texture-bg-color").value,X=k.core("outside-texture-bg-opacity").value;e.colorFillStyle(W,K[0],K[1],K[2],X),W.fillRect(0,0,D.width,D.height);var E=r.zoom();Z(W,!1),W.clearRect(D.mpan.x,D.mpan.y,D.width/D.zoom/l,D.height/D.zoom/l),W.drawImage(F,D.mpan.x,D.mpan.y,D.width/D.zoom/l,D.height/D.zoom/l)}else e.textureOnViewport&&!n&&(e.textureCache=null);var Q=r.extent(),ae=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),re=e.hideEdgesOnViewport&&ae,G=[];if(G[e.NODE]=!c[e.NODE]&&g&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,G[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),G[e.DRAG]=!c[e.DRAG]&&g&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,G[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),c[e.NODE]||i||a||G[e.NODE]){var te=g&&!G[e.NODE]&&v!==1,W=n||(te?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:u.contexts[e.NODE]),ne=g&&!te?"motionBlur":void 0;Z(W,ne),re?e.drawCachedNodes(W,V.nondrag,l,Q):e.drawLayeredElements(W,V.nondrag,l,Q),e.debug&&e.drawDebugPoints(W,V.nondrag),!i&&!g&&(c[e.NODE]=!1)}if(!a&&(c[e.DRAG]||i||G[e.DRAG])){var te=g&&!G[e.DRAG]&&v!==1,W=n||(te?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:u.contexts[e.DRAG]);Z(W,g&&!te?"motionBlur":void 0),re?e.drawCachedNodes(W,V.drag,l,Q):e.drawCachedElements(W,V.drag,l,Q),e.debug&&e.drawDebugPoints(W,V.drag),!i&&!g&&(c[e.DRAG]=!1)}if(this.drawSelectionRectangle(t,Z),g&&v!==1){var de=u.contexts[e.NODE],me=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],ye=u.contexts[e.DRAG],ie=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],pe=function(fe,ge,be){fe.setTransform(1,0,0,1,0,0),be||!N?fe.clearRect(0,0,e.canvasWidth,e.canvasHeight):$(fe,0,0,e.canvasWidth,e.canvasHeight);var _e=v;fe.drawImage(ge,0,0,e.canvasWidth*_e,e.canvasHeight*_e,0,0,e.canvasWidth,e.canvasHeight)};(c[e.NODE]||G[e.NODE])&&(pe(de,me,G[e.NODE]),c[e.NODE]=!1),(c[e.DRAG]||G[e.DRAG])&&(pe(ye,ie,G[e.DRAG]),c[e.DRAG]=!1)}e.prevViewport=D,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),g&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!f,e.mbFrames=0,c[e.NODE]=!0,c[e.DRAG]=!0,e.redraw()},Q7)),n||r.emit("render")};var om;hs.drawSelectionRectangle=function(t,e){var r=this,n=r.cy,i=r.data,a=n.style(),s=t.drawOnlyNodeLayer,o=t.drawAllLayers,l=i.canvasNeedsRedraw,u=t.forcedContext;if(r.showFps||!s&&l[r.SELECT_BOX]&&!o){var c=u||i.contexts[r.SELECT_BOX];if(e(c),r.selection[4]==1&&(r.hoverData.selecting||r.touchData.selecting)){var f=r.cy.zoom(),g=a.core("selection-box-border-width").value/f;c.lineWidth=g,c.fillStyle="rgba("+a.core("selection-box-color").value[0]+","+a.core("selection-box-color").value[1]+","+a.core("selection-box-color").value[2]+","+a.core("selection-box-opacity").value+")",c.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]),g>0&&(c.strokeStyle="rgba("+a.core("selection-box-border-color").value[0]+","+a.core("selection-box-border-color").value[1]+","+a.core("selection-box-border-color").value[2]+","+a.core("selection-box-opacity").value+")",c.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]))}if(i.bgActivePosistion&&!r.hoverData.selecting){var f=r.cy.zoom(),v=i.bgActivePosistion;c.fillStyle="rgba("+a.core("active-bg-color").value[0]+","+a.core("active-bg-color").value[1]+","+a.core("active-bg-color").value[2]+","+a.core("active-bg-opacity").value+")",c.beginPath(),c.arc(v.x,v.y,a.core("active-bg-size").pfValue/f,0,2*Math.PI),c.fill()}var x=r.lastRedrawTime;if(r.showFps&&x){x=Math.round(x);var _=Math.round(1e3/x),S="1 frame = "+x+" ms = "+_+" fps";if(c.setTransform(1,0,0,1,0,0),c.fillStyle="rgba(255, 0, 0, 0.75)",c.strokeStyle="rgba(255, 0, 0, 0.75)",c.font="30px Arial",!om){var N=c.measureText(S);om=N.actualBoundingBoxAscent}c.fillText(S,0,om);var k=60;c.strokeRect(0,om+10,250,20),c.fillRect(0,om+10,250*Math.min(_/k,1),20)}o||(l[r.SELECT_BOX]=!1)}};function yN(t,e,r){var n=t.createShader(e);if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n));return n}function J7(t,e,r){var n=yN(t,t.VERTEX_SHADER,e),i=yN(t,t.FRAGMENT_SHADER,r),a=t.createProgram();if(t.attachShader(a,n),t.attachShader(a,i),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new Error("Could not initialize shaders");return a}function eB(t,e,r){r===void 0&&(r=e);var n=t.makeOffscreenCanvas(e,r),i=n.context=n.getContext("2d");return n.clear=function(){return i.clearRect(0,0,n.width,n.height)},n.clear(),n}function Z_(t){var e=t.pixelRatio,r=t.cy.zoom(),n=t.cy.pan();return{zoom:r*e,pan:{x:n.x*e,y:n.y*e}}}function tB(t){var e=t.pixelRatio,r=t.cy.zoom();return r*e}function rB(t,e,r,n,i){var a=n*r+e.x,s=i*r+e.y;return s=Math.round(t.canvasHeight-s),[a,s]}function nB(t){return t.pstyle("background-fill").value!=="solid"||t.pstyle("background-image").strValue!=="none"?!1:t.pstyle("border-width").value===0||t.pstyle("border-opacity").value===0?!0:t.pstyle("border-style").value==="solid"}function iB(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function hh(t,e,r){var n=t[0]/255,i=t[1]/255,a=t[2]/255,s=e,o=r||new Array(4);return o[0]=n*s,o[1]=i*s,o[2]=a*s,o[3]=s,o}function If(t,e){var r=e||new Array(4);return r[0]=(t>>0&255)/255,r[1]=(t>>8&255)/255,r[2]=(t>>16&255)/255,r[3]=(t>>24&255)/255,r}function aB(t){return t[0]+(t[1]<<8)+(t[2]<<16)+(t[3]<<24)}function sB(t,e){var r=t.createTexture();return r.buffer=function(n){t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)},r.deleteTexture=function(){t.deleteTexture(r)},r}function YP(t,e){switch(e){case"float":return[1,t.FLOAT,4];case"vec2":return[2,t.FLOAT,4];case"vec3":return[3,t.FLOAT,4];case"vec4":return[4,t.FLOAT,4];case"int":return[1,t.INT,4];case"ivec2":return[2,t.INT,4]}}function XP(t,e,r){switch(e){case t.FLOAT:return new Float32Array(r);case t.INT:return new Int32Array(r)}}function oB(t,e,r,n,i,a){switch(e){case t.FLOAT:return new Float32Array(r.buffer,a*n,i);case t.INT:return new Int32Array(r.buffer,a*n,i)}}function lB(t,e,r,n){var i=YP(t,e),a=yi(i,2),s=a[0],o=a[1],l=XP(t,o,n),u=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,l,t.STATIC_DRAW),o===t.FLOAT?t.vertexAttribPointer(r,s,o,!1,0,0):o===t.INT&&t.vertexAttribIPointer(r,s,o,0,0),t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,null),u}function Gl(t,e,r,n){var i=YP(t,r),a=yi(i,3),s=a[0],o=a[1],l=a[2],u=XP(t,o,e*s),c=s*l,f=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,f),t.bufferData(t.ARRAY_BUFFER,e*c,t.DYNAMIC_DRAW),t.enableVertexAttribArray(n),o===t.FLOAT?t.vertexAttribPointer(n,s,o,!1,c,0):o===t.INT&&t.vertexAttribIPointer(n,s,o,c,0),t.vertexAttribDivisor(n,1),t.bindBuffer(t.ARRAY_BUFFER,null);for(var g=new Array(e),v=0;v<e;v++)g[v]=oB(t,o,u,c,s,v);return f.dataArray=u,f.stride=c,f.size=s,f.getView=function(x){return g[x]},f.setPoint=function(x,_,S){var N=g[x];N[0]=_,N[1]=S},f.bufferSubData=function(x){t.bindBuffer(t.ARRAY_BUFFER,f),x?t.bufferSubData(t.ARRAY_BUFFER,0,u,0,x*s):t.bufferSubData(t.ARRAY_BUFFER,0,u)},f}function uB(t,e,r){for(var n=9,i=new Float32Array(e*n),a=new Array(e),s=0;s<e;s++){var o=s*n*4;a[s]=new Float32Array(i.buffer,o,n)}var l=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferData(t.ARRAY_BUFFER,i.byteLength,t.DYNAMIC_DRAW);for(var u=0;u<3;u++){var c=r+u;t.enableVertexAttribArray(c),t.vertexAttribPointer(c,3,t.FLOAT,!1,36,u*12),t.vertexAttribDivisor(c,1)}return t.bindBuffer(t.ARRAY_BUFFER,null),l.getMatrixView=function(f){return a[f]},l.setData=function(f,g){a[g].set(f,0)},l.bufferSubData=function(){t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferSubData(t.ARRAY_BUFFER,0,i)},l}function cB(t){var e=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.bindFramebuffer(t.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(n,i){t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,i,0,t.RGBA,t.UNSIGNED_BYTE,null)},e}var xN=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function rw(){var t=new xN(9);return xN!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function bN(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function dB(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=e[8],g=r[0],v=r[1],x=r[2],_=r[3],S=r[4],N=r[5],k=r[6],E=r[7],T=r[8];return t[0]=g*n+v*s+x*u,t[1]=g*i+v*o+x*c,t[2]=g*a+v*l+x*f,t[3]=_*n+S*s+N*u,t[4]=_*i+S*o+N*c,t[5]=_*a+S*l+N*f,t[6]=k*n+E*s+T*u,t[7]=k*i+E*o+T*c,t[8]=k*a+E*l+T*f,t}function q0(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=e[8],g=r[0],v=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=s,t[4]=o,t[5]=l,t[6]=g*n+v*s+u,t[7]=g*i+v*o+c,t[8]=g*a+v*l+f,t}function wN(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],f=e[8],g=Math.sin(r),v=Math.cos(r);return t[0]=v*n+g*s,t[1]=v*i+g*o,t[2]=v*a+g*l,t[3]=v*s-g*n,t[4]=v*o-g*i,t[5]=v*l-g*a,t[6]=u,t[7]=c,t[8]=f,t}function A2(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function hB(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}var fB=(function(){function t(e,r,n,i){Nd(this,t),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.texSize=r,this.texRows=n,this.texHeight=Math.floor(r/n),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=i(e,r,r),this.scratch=i(e,r,this.texHeight,"scratch")}return Td(t,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(r){var n=r.w,i=r.h,a=this.texHeight,s=this.texSize,o=a/i,l=n*o,u=i*o;return l>s&&(o=s/n,l=n*o,u=i*o),{scale:o,texW:l,texH:u}}},{key:"draw",value:function(r,n,i){var a=this;if(this.locked)throw new Error("can't draw, atlas is locked");var s=this.texSize,o=this.texRows,l=this.texHeight,u=this.getScale(n),c=u.scale,f=u.texW,g=u.texH,v=function(E,T){if(i&&T){var R=T.context,j=E.x,D=E.row,B=j,I=l*D;R.save(),R.translate(B,I),R.scale(c,c),i(R,n),R.restore()}},x=[null,null],_=function(){v(a.freePointer,a.canvas),x[0]={x:a.freePointer.x,y:a.freePointer.row*l,w:f,h:g},x[1]={x:a.freePointer.x+f,y:a.freePointer.row*l,w:0,h:g},a.freePointer.x+=f,a.freePointer.x==s&&(a.freePointer.x=0,a.freePointer.row++)},S=function(){var E=a.scratch,T=a.canvas;E.clear(),v({x:0,row:0},E);var R=s-a.freePointer.x,j=f-R,D=l;{var B=a.freePointer.x,I=a.freePointer.row*l,V=R;T.context.drawImage(E,0,0,V,D,B,I,V,D),x[0]={x:B,y:I,w:V,h:g}}{var $=R,Z=(a.freePointer.row+1)*l,O=j;T&&T.context.drawImage(E,$,0,O,D,0,Z,O,D),x[1]={x:0,y:Z,w:O,h:g}}a.freePointer.x=j,a.freePointer.row++},N=function(){a.freePointer.x=0,a.freePointer.row++};if(this.freePointer.x+f<=s)_();else{if(this.freePointer.row>=o-1)return!1;this.freePointer.x===s?(N(),_()):this.enableWrapping?S():(N(),_())}return this.keyToLocation.set(r,x),this.needsBuffer=!0,x}},{key:"getOffsets",value:function(r){return this.keyToLocation.get(r)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(r){if(this.locked)return!1;var n=this.texSize,i=this.texRows,a=this.getScale(r),s=a.texW;return this.freePointer.x+s>n?this.freePointer.row<i-1:!0}},{key:"bufferIfNeeded",value:function(r){this.texture||(this.texture=sB(r,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])})(),pB=(function(){function t(e,r,n,i){Nd(this,t),this.r=e,this.texSize=r,this.texRows=n,this.createTextureCanvas=i,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return Td(t,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var r=this.r,n=this.texSize,i=this.texRows,a=this.createTextureCanvas;return new fB(r,n,i,a)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var r=this.r,n=this.texSize,i=this.texRows,a=this.createTextureCanvas,s=Math.floor(n/i);this.scratch=a(r,n,s,"scratch")}return this.scratch}},{key:"draw",value:function(r,n,i){var a=this.styleKeyToAtlas.get(r);return a||(a=this.atlases[this.atlases.length-1],(!a||!a.canFit(n))&&(a&&a.lock(),a=this._createAtlas(),this.atlases.push(a)),a.draw(r,n,i),this.styleKeyToAtlas.set(r,a)),a}},{key:"getAtlas",value:function(r){return this.styleKeyToAtlas.get(r)}},{key:"hasAtlas",value:function(r){return this.styleKeyToAtlas.has(r)}},{key:"markKeyForGC",value:function(r){this.markedKeys.add(r)}},{key:"gc",value:function(){var r=this,n=this.markedKeys;if(n.size===0){console.log("nothing to garbage collect");return}var i=[],a=new Map,s=null,o=As(this.atlases),l;try{var u=function(){var f=l.value,g=f.getKeys(),v=mB(n,g);if(v.size===0)return i.push(f),g.forEach(function(R){return a.set(R,f)}),1;s||(s=r._createAtlas(),i.push(s));var x=As(g),_;try{for(x.s();!(_=x.n()).done;){var S=_.value;if(!v.has(S)){var N=f.getOffsets(S),k=yi(N,2),E=k[0],T=k[1];s.canFit({w:E.w+T.w,h:E.h})||(s.lock(),s=r._createAtlas(),i.push(s)),f.canvas&&(r._copyTextureToNewAtlas(S,f,s),a.set(S,s))}}}catch(R){x.e(R)}finally{x.f()}f.dispose()};for(o.s();!(l=o.n()).done;)u()}catch(c){o.e(c)}finally{o.f()}this.atlases=i,this.styleKeyToAtlas=a,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(r,n,i){var a=n.getOffsets(r),s=yi(a,2),o=s[0],l=s[1];if(l.w===0)i.draw(r,o,function(g){g.drawImage(n.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h)});else{var u=this._getScratchCanvas();u.clear(),u.context.drawImage(n.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h),u.context.drawImage(n.canvas,l.x,l.y,l.w,l.h,o.w,0,l.w,l.h);var c=o.w+l.w,f=o.h;i.draw(r,{w:c,h:f},function(g){g.drawImage(u,0,0,c,f,0,0,c,f)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])})();function mB(t,e){return t.intersection?t.intersection(e):new Set(ry(t).filter(function(r){return e.has(r)}))}var gB=(function(){function t(e,r){Nd(this,t),this.r=e,this.globalOptions=r,this.atlasSize=r.webglTexSize,this.maxAtlasesPerBatch=r.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return Td(t,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(r,n){var i=this.globalOptions,a=i.webglTexSize,s=i.createTextureCanvas,o=n.texRows,l=this._cacheScratchCanvas(s),u=new pB(this.r,a,o,l);this.collections.set(r,u)}},{key:"addRenderType",value:function(r,n){var i=n.collection;if(!this.collections.has(i))throw new Error("invalid atlas collection name '".concat(i,"'"));var a=this.collections.get(i),s=Ut({type:r,atlasCollection:a},n);this.renderTypes.set(r,s)}},{key:"getRenderTypeOpts",value:function(r){return this.renderTypes.get(r)}},{key:"getAtlasCollection",value:function(r){return this.collections.get(r)}},{key:"_cacheScratchCanvas",value:function(r){var n=-1,i=-1,a=null;return function(s,o,l,u){return u?((!a||o!=n||l!=i)&&(n=o,i=l,a=r(s,o,l)),a):r(s,o,l)}}},{key:"_key",value:function(r,n){return"".concat(r,"-").concat(n)}},{key:"invalidate",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.forceRedraw,s=a===void 0?!1:a,o=i.filterEle,l=o===void 0?function(){return!0}:o,u=i.filterType,c=u===void 0?function(){return!0}:u,f=!1,g=!1,v=As(r),x;try{for(v.s();!(x=v.n()).done;){var _=x.value;if(l(_)){var S=As(this.renderTypes.values()),N;try{var k=function(){var T=N.value,R=T.type;if(c(R)){var j=n.collections.get(T.collection),D=T.getKey(_),B=Array.isArray(D)?D:[D];if(s)B.forEach(function(Z){return j.markKeyForGC(Z)}),g=!0;else{var I=T.getID?T.getID(_):_.id(),V=n._key(R,I),$=n.typeAndIdToKey.get(V);$!==void 0&&!iB(B,$)&&(f=!0,n.typeAndIdToKey.delete(V),$.forEach(function(Z){return j.markKeyForGC(Z)}))}}};for(S.s();!(N=S.n()).done;)k()}catch(E){S.e(E)}finally{S.f()}}}}catch(E){v.e(E)}finally{v.f()}return g&&(this.gc(),f=!1),f}},{key:"gc",value:function(){var r=As(this.collections.values()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;i.gc()}}catch(a){r.e(a)}finally{r.f()}}},{key:"getOrCreateAtlas",value:function(r,n,i,a){var s=this.renderTypes.get(n),o=this.collections.get(s.collection),l=!1,u=o.draw(a,i,function(g){s.drawClipped?(g.save(),g.beginPath(),g.rect(0,0,i.w,i.h),g.clip(),s.drawElement(g,r,i,!0,!0),g.restore()):s.drawElement(g,r,i,!0,!0),l=!0});if(l){var c=s.getID?s.getID(r):r.id(),f=this._key(n,c);this.typeAndIdToKey.has(f)?this.typeAndIdToKey.get(f).push(a):this.typeAndIdToKey.set(f,[a])}return u}},{key:"getAtlasInfo",value:function(r,n){var i=this,a=this.renderTypes.get(n),s=a.getKey(r),o=Array.isArray(s)?s:[s];return o.map(function(l){var u=a.getBoundingBox(r,l),c=i.getOrCreateAtlas(r,n,u,l),f=c.getOffsets(l),g=yi(f,2),v=g[0],x=g[1];return{atlas:c,tex:v,tex1:v,tex2:x,bb:u}})}},{key:"getDebugInfo",value:function(){var r=[],n=As(this.collections),i;try{for(n.s();!(i=n.n()).done;){var a=yi(i.value,2),s=a[0],o=a[1],l=o.getCounts(),u=l.keyCount,c=l.atlasCount;r.push({type:s,keyCount:u,atlasCount:c})}}catch(f){n.e(f)}finally{n.f()}return r}}])})(),vB=(function(){function t(e){Nd(this,t),this.globalOptions=e,this.atlasSize=e.webglTexSize,this.maxAtlasesPerBatch=e.webglTexPerBatch,this.batchAtlases=[]}return Td(t,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(r,n){return n})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(r){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(r):!0}},{key:"getAtlasIndexForBatch",value:function(r){var n=this.batchAtlases.indexOf(r);if(n<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(r),n=this.batchAtlases.length-1}return n}}])})(),yB=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,xB=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,bB=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,wB=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,gg={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},py={IGNORE:1,USE_BB:2},nw=0,_N=1,SN=2,iw=3,Bf=4,f0=5,lm=6,um=7,_B=(function(){function t(e,r,n){Nd(this,t),this.r=e,this.gl=r,this.maxInstances=n.webglBatchSize,this.atlasSize=n.webglTexSize,this.bgColor=n.bgColor,this.debug=n.webglDebug,this.batchDebugInfo=[],n.enableWrapping=!0,n.createTextureCanvas=eB,this.atlasManager=new gB(e,n),this.batchManager=new vB(n),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(gg.SCREEN),this.pickingProgram=this._createShaderProgram(gg.PICKING),this.vao=this._createVAO()}return Td(t,[{key:"addAtlasCollection",value:function(r,n){this.atlasManager.addAtlasCollection(r,n)}},{key:"addTextureAtlasRenderType",value:function(r,n){this.atlasManager.addRenderType(r,n)}},{key:"addSimpleShapeRenderType",value:function(r,n){this.simpleShapeOptions.set(r,n)}},{key:"invalidate",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.type,a=this.atlasManager;return i?a.invalidate(r,{filterType:function(o){return o===i},forceRedraw:!0}):a.invalidate(r)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(r){var n=this.gl,i=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(nw,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(Bf," || aVertType == ").concat(um,` 
             || aVertType == `).concat(f0," || aVertType == ").concat(lm,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(_N,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(SN,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(iw,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),a=this.batchManager.getIndexArray(),s=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(a.map(function(u){return"uniform sampler2D uTexture".concat(u,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(yB,`
      `).concat(xB,`
      `).concat(bB,`
      `).concat(wB,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(nw,`) {
          // look up the texel from the texture unit
          `).concat(a.map(function(u){return"if(vAtlasId == ".concat(u,") outColor = texture(uTexture").concat(u,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(iw,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(Bf,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(Bf," || vVertType == ").concat(um,` 
          || vVertType == `).concat(f0," || vVertType == ").concat(lm,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(Bf,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(um,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(um,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(r.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),o=J7(n,i,s);o.aPosition=n.getAttribLocation(o,"aPosition"),o.aIndex=n.getAttribLocation(o,"aIndex"),o.aVertType=n.getAttribLocation(o,"aVertType"),o.aTransform=n.getAttribLocation(o,"aTransform"),o.aAtlasId=n.getAttribLocation(o,"aAtlasId"),o.aTex=n.getAttribLocation(o,"aTex"),o.aPointAPointB=n.getAttribLocation(o,"aPointAPointB"),o.aPointCPointD=n.getAttribLocation(o,"aPointCPointD"),o.aLineWidth=n.getAttribLocation(o,"aLineWidth"),o.aColor=n.getAttribLocation(o,"aColor"),o.aCornerRadius=n.getAttribLocation(o,"aCornerRadius"),o.aBorderColor=n.getAttribLocation(o,"aBorderColor"),o.uPanZoomMatrix=n.getUniformLocation(o,"uPanZoomMatrix"),o.uAtlasSize=n.getUniformLocation(o,"uAtlasSize"),o.uBGColor=n.getUniformLocation(o,"uBGColor"),o.uZoom=n.getUniformLocation(o,"uZoom"),o.uTextures=[];for(var l=0;l<this.batchManager.getMaxAtlasesPerBatch();l++)o.uTextures.push(n.getUniformLocation(o,"uTexture".concat(l)));return o}},{key:"_createVAO",value:function(){var r=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=r.length/2;var n=this.maxInstances,i=this.gl,a=this.program,s=i.createVertexArray();return i.bindVertexArray(s),lB(i,"vec2",a.aPosition,r),this.transformBuffer=uB(i,n,a.aTransform),this.indexBuffer=Gl(i,n,"vec4",a.aIndex),this.vertTypeBuffer=Gl(i,n,"int",a.aVertType),this.atlasIdBuffer=Gl(i,n,"int",a.aAtlasId),this.texBuffer=Gl(i,n,"vec4",a.aTex),this.pointAPointBBuffer=Gl(i,n,"vec4",a.aPointAPointB),this.pointCPointDBuffer=Gl(i,n,"vec4",a.aPointCPointD),this.lineWidthBuffer=Gl(i,n,"vec2",a.aLineWidth),this.colorBuffer=Gl(i,n,"vec4",a.aColor),this.cornerRadiusBuffer=Gl(i,n,"vec4",a.aCornerRadius),this.borderColorBuffer=Gl(i,n,"vec4",a.aBorderColor),i.bindVertexArray(null),s}},{key:"buffers",get:function(){var r=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(n){return nd(n,"Buffer")}).map(function(n){return r[n]})),this._buffers}},{key:"startFrame",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:gg.SCREEN;this.panZoomMatrix=r,this.renderTarget=n,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(r,n){return r.visible()?n&&n.isVisible?n.isVisible(r):!0:!1}},{key:"drawTexture",value:function(r,n,i){var a=this.atlasManager,s=this.batchManager,o=a.getRenderTypeOpts(i);if(this._isVisible(r,o)&&!(r.isEdge()&&!this._isValidEdge(r))){if(this.renderTarget.picking&&o.getTexPickingMode){var l=o.getTexPickingMode(r);if(l===py.IGNORE)return;if(l==py.USE_BB){this.drawPickingRectangle(r,n,i);return}}var u=a.getAtlasInfo(r,i),c=As(u),f;try{for(c.s();!(f=c.n()).done;){var g=f.value,v=g.atlas,x=g.tex1,_=g.tex2;s.canAddToCurrentBatch(v)||this.endBatch();for(var S=s.getAtlasIndexForBatch(v),N=0,k=[[x,!0],[_,!1]];N<k.length;N++){var E=yi(k[N],2),T=E[0],R=E[1];if(T.w!=0){var j=this.instanceCount;this.vertTypeBuffer.getView(j)[0]=nw;var D=this.indexBuffer.getView(j);If(n,D);var B=this.atlasIdBuffer.getView(j);B[0]=S;var I=this.texBuffer.getView(j);I[0]=T.x,I[1]=T.y,I[2]=T.w,I[3]=T.h;var V=this.transformBuffer.getMatrixView(j);this.setTransformMatrix(r,V,o,g,R),this.instanceCount++,R||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch($){c.e($)}finally{c.f()}}}},{key:"setTransformMatrix",value:function(r,n,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=0;if(i.shapeProps&&i.shapeProps.padding&&(o=r.pstyle(i.shapeProps.padding).pfValue),a){var l=a.bb,u=a.tex1,c=a.tex2,f=u.w/(u.w+c.w);s||(f=1-f);var g=this._getAdjustedBB(l,o,s,f);this._applyTransformMatrix(n,g,i,r)}else{var v=i.getBoundingBox(r),x=this._getAdjustedBB(v,o,!0,1);this._applyTransformMatrix(n,x,i,r)}}},{key:"_applyTransformMatrix",value:function(r,n,i,a){var s,o;bN(r);var l=i.getRotation?i.getRotation(a):0;if(l!==0){var u=i.getRotationPoint(a),c=u.x,f=u.y;q0(r,r,[c,f]),wN(r,r,l);var g=i.getRotationOffset(a);s=g.x+(n.xOffset||0),o=g.y+(n.yOffset||0)}else s=n.x1,o=n.y1;q0(r,r,[s,o]),A2(r,r,[n.w,n.h])}},{key:"_getAdjustedBB",value:function(r,n,i,a){var s=r.x1,o=r.y1,l=r.w,u=r.h,c=r.yOffset;n&&(s-=n,o-=n,l+=2*n,u+=2*n);var f=0,g=l*a;return i&&a<1?l=g:!i&&a<1&&(f=l-g,s+=f,l=g),{x1:s,y1:o,w:l,h:u,xOffset:f,yOffset:c}}},{key:"drawPickingRectangle",value:function(r,n,i){var a=this.atlasManager.getRenderTypeOpts(i),s=this.instanceCount;this.vertTypeBuffer.getView(s)[0]=Bf;var o=this.indexBuffer.getView(s);If(n,o);var l=this.colorBuffer.getView(s);hh([0,0,0],1,l);var u=this.transformBuffer.getMatrixView(s);this.setTransformMatrix(r,u,a),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(r,n,i){var a=this.simpleShapeOptions.get(i);if(this._isVisible(r,a)){var s=a.shapeProps,o=this._getVertTypeForShape(r,s.shape);if(o===void 0||a.isSimple&&!a.isSimple(r)){this.drawTexture(r,n,i);return}var l=this.instanceCount;if(this.vertTypeBuffer.getView(l)[0]=o,o===f0||o===lm){var u=a.getBoundingBox(r),c=this._getCornerRadius(r,s.radius,u),f=this.cornerRadiusBuffer.getView(l);f[0]=c,f[1]=c,f[2]=c,f[3]=c,o===lm&&(f[0]=0,f[2]=0)}var g=this.indexBuffer.getView(l);If(n,g);var v=r.pstyle(s.color).value,x=r.pstyle(s.opacity).value,_=this.colorBuffer.getView(l);hh(v,x,_);var S=this.lineWidthBuffer.getView(l);if(S[0]=0,S[1]=0,s.border){var N=r.pstyle("border-width").value;if(N>0){var k=r.pstyle("border-color").value,E=r.pstyle("border-opacity").value,T=this.borderColorBuffer.getView(l);hh(k,E,T);var R=r.pstyle("border-position").value;if(R==="inside")S[0]=0,S[1]=-N;else if(R==="outside")S[0]=N,S[1]=0;else{var j=N/2;S[0]=j,S[1]=-j}}}var D=this.transformBuffer.getMatrixView(l);this.setTransformMatrix(r,D,a),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(r,n){var i=r.pstyle(n).value;switch(i){case"rectangle":return Bf;case"ellipse":return um;case"roundrectangle":case"round-rectangle":return f0;case"bottom-round-rectangle":return lm;default:return}}},{key:"_getCornerRadius",value:function(r,n,i){var a=i.w,s=i.h;if(r.pstyle(n).value==="auto")return bd(a,s);var o=r.pstyle(n).pfValue,l=a/2,u=s/2;return Math.min(o,u,l)}},{key:"drawEdgeArrow",value:function(r,n,i){if(r.visible()){var a=r._private.rscratch,s,o,l;if(i==="source"?(s=a.arrowStartX,o=a.arrowStartY,l=a.srcArrowAngle):(s=a.arrowEndX,o=a.arrowEndY,l=a.tgtArrowAngle),!(isNaN(s)||s==null||isNaN(o)||o==null||isNaN(l)||l==null)){var u=r.pstyle(i+"-arrow-shape").value;if(u!=="none"){var c=r.pstyle(i+"-arrow-color").value,f=r.pstyle("opacity").value,g=r.pstyle("line-opacity").value,v=f*g,x=r.pstyle("width").pfValue,_=r.pstyle("arrow-scale").value,S=this.r.getArrowWidth(x,_),N=this.instanceCount,k=this.transformBuffer.getMatrixView(N);bN(k),q0(k,k,[s,o]),A2(k,k,[S,S]),wN(k,k,l),this.vertTypeBuffer.getView(N)[0]=iw;var E=this.indexBuffer.getView(N);If(n,E);var T=this.colorBuffer.getView(N);hh(c,v,T),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(r,n){if(r.visible()){var i=this._getEdgePoints(r);if(i){var a=r.pstyle("opacity").value,s=r.pstyle("line-opacity").value,o=r.pstyle("width").pfValue,l=r.pstyle("line-color").value,u=a*s;if(i.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),i.length==4){var c=this.instanceCount;this.vertTypeBuffer.getView(c)[0]=_N;var f=this.indexBuffer.getView(c);If(n,f);var g=this.colorBuffer.getView(c);hh(l,u,g);var v=this.lineWidthBuffer.getView(c);v[0]=o;var x=this.pointAPointBBuffer.getView(c);x[0]=i[0],x[1]=i[1],x[2]=i[2],x[3]=i[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var _=0;_<i.length-2;_+=2){var S=this.instanceCount;this.vertTypeBuffer.getView(S)[0]=SN;var N=this.indexBuffer.getView(S);If(n,N);var k=this.colorBuffer.getView(S);hh(l,u,k);var E=this.lineWidthBuffer.getView(S);E[0]=o;var T=i[_-2],R=i[_-1],j=i[_],D=i[_+1],B=i[_+2],I=i[_+3],V=i[_+4],$=i[_+5];_==0&&(T=2*j-B+.001,R=2*D-I+.001),_==i.length-4&&(V=2*B-j+.001,$=2*I-D+.001);var Z=this.pointAPointBBuffer.getView(S);Z[0]=T,Z[1]=R,Z[2]=j,Z[3]=D;var O=this.pointCPointDBuffer.getView(S);O[0]=B,O[1]=I,O[2]=V,O[3]=$,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_isValidEdge",value:function(r){var n=r._private.rscratch;return!(n.badLine||n.allpts==null||isNaN(n.allpts[0]))}},{key:"_getEdgePoints",value:function(r){var n=r._private.rscratch;if(this._isValidEdge(r)){var i=n.allpts;if(i.length==4)return i;var a=this._getNumSegments(r);return this._getCurveSegmentPoints(i,a)}}},{key:"_getNumSegments",value:function(r){var n=15;return Math.min(Math.max(n,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(r,n){if(r.length==4)return r;for(var i=Array((n+1)*2),a=0;a<=n;a++)if(a==0)i[0]=r[0],i[1]=r[1];else if(a==n)i[a*2]=r[r.length-2],i[a*2+1]=r[r.length-1];else{var s=a/n;this._setCurvePoint(r,s,i,a*2)}return i}},{key:"_setCurvePoint",value:function(r,n,i,a){if(r.length<=2)i[a]=r[0],i[a+1]=r[1];else{for(var s=Array(r.length-2),o=0;o<s.length;o+=2){var l=(1-n)*r[o]+n*r[o+2],u=(1-n)*r[o+1]+n*r[o+3];s[o]=l,s[o+1]=u}return this._setCurvePoint(s,n,i,a)}}},{key:"endBatch",value:function(){var r=this.gl,n=this.vao,i=this.vertexCount,a=this.instanceCount;if(a!==0){var s=this.renderTarget.picking?this.pickingProgram:this.program;r.useProgram(s),r.bindVertexArray(n);var o=As(this.buffers),l;try{for(o.s();!(l=o.n()).done;){var u=l.value;u.bufferSubData(a)}}catch(x){o.e(x)}finally{o.f()}for(var c=this.batchManager.getAtlases(),f=0;f<c.length;f++)c[f].bufferIfNeeded(r);for(var g=0;g<c.length;g++)r.activeTexture(r.TEXTURE0+g),r.bindTexture(r.TEXTURE_2D,c[g].texture),r.uniform1i(s.uTextures[g],g);r.uniform1f(s.uZoom,tB(this.r)),r.uniformMatrix3fv(s.uPanZoomMatrix,!1,this.panZoomMatrix),r.uniform1i(s.uAtlasSize,this.batchManager.getAtlasSize());var v=hh(this.bgColor,1);r.uniform4fv(s.uBGColor,v),r.drawArraysInstanced(r.TRIANGLES,0,i,a),r.bindVertexArray(null),r.bindTexture(r.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:a,atlasCount:c.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var r=this.atlasManager.getDebugInfo(),n=r.reduce(function(s,o){return s+o.atlasCount},0),i=this.batchDebugInfo,a=i.reduce(function(s,o){return s+o.count},0);return{atlasInfo:r,totalAtlases:n,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:i.length,batchInfo:i,totalInstances:a}}}])})(),QP={};QP.initWebgl=function(t,e){var r=this,n=r.data.contexts[r.WEBGL];t.bgColor=SB(r),t.webglTexSize=Math.min(t.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE)),t.webglTexRows=Math.min(t.webglTexRows,54),t.webglTexRowsNodes=Math.min(t.webglTexRowsNodes,54),t.webglBatchSize=Math.min(t.webglBatchSize,16384),t.webglTexPerBatch=Math.min(t.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),r.webglDebug=t.webglDebug,r.webglDebugShowAtlases=t.webglDebugShowAtlases,r.pickingFrameBuffer=cB(n),r.pickingFrameBuffer.needsDraw=!0,r.drawing=new _B(r,n,t);var i=function(f){return function(g){return r.getTextAngle(g,f)}},a=function(f){return function(g){var v=g.pstyle(f);return v&&v.value}},s=function(f){return function(g){return g.pstyle("".concat(f,"-opacity")).value>0}},o=function(f){var g=f.pstyle("text-events").strValue==="yes";return g?py.USE_BB:py.IGNORE},l=function(f){var g=f.position(),v=g.x,x=g.y,_=f.outerWidth(),S=f.outerHeight();return{w:_,h:S,x1:v-_/2,y1:x-S/2}};r.drawing.addAtlasCollection("node",{texRows:t.webglTexRowsNodes}),r.drawing.addAtlasCollection("label",{texRows:t.webglTexRows}),r.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement}),r.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:l,isSimple:nB,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),r.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:l,isVisible:s("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),r.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:l,isVisible:s("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),r.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:o,getKey:aw(e.getLabelKey,null),getBoundingBox:sw(e.getLabelBox,null),drawClipped:!0,drawElement:e.drawLabel,getRotation:i(null),getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:a("label")}),r.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:o,getKey:aw(e.getSourceLabelKey,"source"),getBoundingBox:sw(e.getSourceLabelBox,"source"),drawClipped:!0,drawElement:e.drawSourceLabel,getRotation:i("source"),getRotationPoint:e.getSourceLabelRotationPoint,getRotationOffset:e.getSourceLabelRotationOffset,isVisible:a("source-label")}),r.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:o,getKey:aw(e.getTargetLabelKey,"target"),getBoundingBox:sw(e.getTargetLabelBox,"target"),drawClipped:!0,drawElement:e.drawTargetLabel,getRotation:i("target"),getRotationPoint:e.getTargetLabelRotationPoint,getRotationOffset:e.getTargetLabelRotationOffset,isVisible:a("target-label")});var u=uv(function(){console.log("garbage collect flag set"),r.data.gc=!0},1e4);r.onUpdateEleCalcs(function(c,f){var g=!1;f&&f.length>0&&(g|=r.drawing.invalidate(f)),g&&u()}),kB(r)};function SB(t){var e=t.cy.container(),r=e&&e.style&&e.style.backgroundColor||"white";return E4(r)}function JP(t,e){var r=t._private.rscratch;return Ts(r,"labelWrapCachedLines",e)||[]}var aw=function(e,r){return function(n){var i=e(n),a=JP(n,r);return a.length>1?a.map(function(s,o){return"".concat(i,"_").concat(o)}):i}},sw=function(e,r){return function(n,i){var a=e(n);if(typeof i=="string"){var s=i.indexOf("_");if(s>0){var o=Number(i.substring(s+1)),l=JP(n,r),u=a.h/l.length,c=u*o,f=a.y1+c;return{x1:a.x1,w:a.w,y1:f,h:u,yOffset:c}}}return a}};function kB(t){{var e=t.render;t.render=function(a){a=a||{};var s=t.cy;t.webgl&&(s.zoom()>qP?(CB(t),e.call(t,a)):(EB(t),tM(t,a,gg.SCREEN)))}}{var r=t.matchCanvasSize;t.matchCanvasSize=function(a){r.call(t,a),t.pickingFrameBuffer.setFramebufferAttachmentSizes(t.canvasWidth,t.canvasHeight),t.pickingFrameBuffer.needsDraw=!0}}t.findNearestElements=function(a,s,o,l){return jB(t,a,s)};{var n=t.invalidateCachedZSortedEles;t.invalidateCachedZSortedEles=function(){n.call(t),t.pickingFrameBuffer.needsDraw=!0}}{var i=t.notify;t.notify=function(a,s){i.call(t,a,s),a==="viewport"||a==="bounds"?t.pickingFrameBuffer.needsDraw=!0:a==="background"&&t.drawing.invalidate(s,{type:"node-body"})}}}function CB(t){var e=t.data.contexts[t.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function EB(t){var e=function(n){n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.canvasWidth,t.canvasHeight),n.restore()};e(t.data.contexts[t.NODE]),e(t.data.contexts[t.DRAG])}function NB(t){var e=t.canvasWidth,r=t.canvasHeight,n=Z_(t),i=n.pan,a=n.zoom,s=rw();q0(s,s,[i.x,i.y]),A2(s,s,[a,a]);var o=rw();hB(o,e,r);var l=rw();return dB(l,o,s),l}function eM(t,e){var r=t.canvasWidth,n=t.canvasHeight,i=Z_(t),a=i.pan,s=i.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,r,n),e.translate(a.x,a.y),e.scale(s,s)}function TB(t,e){t.drawSelectionRectangle(e,function(r){return eM(t,r)})}function PB(t){var e=t.data.contexts[t.NODE];e.save(),eM(t,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function MB(t){var e=function(i,a,s){for(var o=i.atlasManager.getAtlasCollection(a),l=t.data.contexts[t.NODE],u=o.atlases,c=0;c<u.length;c++){var f=u[c],g=f.canvas;if(g){var v=g.width,x=g.height,_=v*c,S=g.height*s,N=.4;l.save(),l.scale(N,N),l.drawImage(g,_,S),l.strokeStyle="black",l.rect(_,S,v,x),l.stroke(),l.restore()}}},r=0;e(t.drawing,"node",r++),e(t.drawing,"label",r++)}function AB(t,e,r,n,i){var a,s,o,l,u=Z_(t),c=u.pan,f=u.zoom;{var g=rB(t,c,f,e,r),v=yi(g,2),x=v[0],_=v[1],S=6;a=x-S/2,s=_-S/2,o=S,l=S}if(o===0||l===0)return[];var N=t.data.contexts[t.WEBGL];N.bindFramebuffer(N.FRAMEBUFFER,t.pickingFrameBuffer),t.pickingFrameBuffer.needsDraw&&(N.viewport(0,0,N.canvas.width,N.canvas.height),tM(t,null,gg.PICKING),t.pickingFrameBuffer.needsDraw=!1);var k=o*l,E=new Uint8Array(k*4);N.readPixels(a,s,o,l,N.RGBA,N.UNSIGNED_BYTE,E),N.bindFramebuffer(N.FRAMEBUFFER,null);for(var T=new Set,R=0;R<k;R++){var j=E.slice(R*4,R*4+4),D=aB(j)-1;D>=0&&T.add(D)}return T}function jB(t,e,r){var n=AB(t,e,r),i=t.getCachedZSortedEles(),a,s,o=As(n),l;try{for(o.s();!(l=o.n()).done;){var u=l.value,c=i[u];if(!a&&c.isNode()&&(a=c),!s&&c.isEdge()&&(s=c),a&&s)break}}catch(f){o.e(f)}finally{o.f()}return[a,s].filter(Boolean)}function ow(t,e,r){var n=t.drawing;e+=1,r.isNode()?(n.drawNode(r,e,"node-underlay"),n.drawNode(r,e,"node-body"),n.drawTexture(r,e,"label"),n.drawNode(r,e,"node-overlay")):(n.drawEdgeLine(r,e),n.drawEdgeArrow(r,e,"source"),n.drawEdgeArrow(r,e,"target"),n.drawTexture(r,e,"label"),n.drawTexture(r,e,"edge-source-label"),n.drawTexture(r,e,"edge-target-label"))}function tM(t,e,r){var n;t.webglDebug&&(n=performance.now());var i=t.drawing,a=0;if(r.screen&&t.data.canvasNeedsRedraw[t.SELECT_BOX]&&TB(t,e),t.data.canvasNeedsRedraw[t.NODE]||r.picking){var s=t.data.contexts[t.WEBGL];r.screen?(s.clearColor(0,0,0,0),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA)):s.disable(s.BLEND),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.viewport(0,0,s.canvas.width,s.canvas.height);var o=NB(t),l=t.getCachedZSortedEles();if(a=l.length,i.startFrame(o,r),r.screen){for(var u=0;u<l.nondrag.length;u++)ow(t,u,l.nondrag[u]);for(var c=0;c<l.drag.length;c++)ow(t,c,l.drag[c])}else if(r.picking)for(var f=0;f<l.length;f++)ow(t,f,l[f]);i.endFrame(),r.screen&&t.webglDebugShowAtlases&&(PB(t),MB(t)),t.data.canvasNeedsRedraw[t.NODE]=!1,t.data.canvasNeedsRedraw[t.DRAG]=!1}if(t.webglDebug){var g=performance.now(),v=!1,x=Math.ceil(g-n),_=i.getDebugInfo(),S=["".concat(a," elements"),"".concat(_.totalInstances," instances"),"".concat(_.batchCount," batches"),"".concat(_.totalAtlases," atlases"),"".concat(_.wrappedCount," wrapped textures"),"".concat(_.simpleCount," simple shapes")].join(", ");if(v)console.log("WebGL (".concat(r.name,") - time ").concat(x,"ms, ").concat(S));else{console.log("WebGL (".concat(r.name,") - frame time ").concat(x,"ms")),console.log("Totals:"),console.log("  ".concat(S)),console.log("Texture Atlases Used:");var N=_.atlasInfo,k=As(N),E;try{for(k.s();!(E=k.n()).done;){var T=E.value;console.log("  ".concat(T.type,": ").concat(T.keyCount," keys, ").concat(T.atlasCount," atlases"))}}catch(R){k.e(R)}finally{k.f()}console.log("")}}t.data.gc&&(console.log("Garbage Collect!"),t.data.gc=!1,i.gc())}var Ad={};Ad.drawPolygonPath=function(t,e,r,n,i,a){var s=n/2,o=i/2;t.beginPath&&t.beginPath(),t.moveTo(e+s*a[0],r+o*a[1]);for(var l=1;l<a.length/2;l++)t.lineTo(e+s*a[l*2],r+o*a[l*2+1]);t.closePath()};Ad.drawRoundPolygonPath=function(t,e,r,n,i,a,s){s.forEach(function(o){return DP(t,o)}),t.closePath()};Ad.drawRoundRectanglePath=function(t,e,r,n,i,a){var s=n/2,o=i/2,l=a==="auto"?bd(n,i):Math.min(a,o,s);t.beginPath&&t.beginPath(),t.moveTo(e,r-o),t.arcTo(e+s,r-o,e+s,r,l),t.arcTo(e+s,r+o,e,r+o,l),t.arcTo(e-s,r+o,e-s,r,l),t.arcTo(e-s,r-o,e,r-o,l),t.lineTo(e,r-o),t.closePath()};Ad.drawBottomRoundRectanglePath=function(t,e,r,n,i,a){var s=n/2,o=i/2,l=a==="auto"?bd(n,i):a;t.beginPath&&t.beginPath(),t.moveTo(e,r-o),t.lineTo(e+s,r-o),t.lineTo(e+s,r),t.arcTo(e+s,r+o,e,r+o,l),t.arcTo(e-s,r+o,e-s,r,l),t.lineTo(e-s,r-o),t.lineTo(e,r-o),t.closePath()};Ad.drawCutRectanglePath=function(t,e,r,n,i,a,s){var o=n/2,l=i/2,u=s==="auto"?O_():s;t.beginPath&&t.beginPath(),t.moveTo(e-o+u,r-l),t.lineTo(e+o-u,r-l),t.lineTo(e+o,r-l+u),t.lineTo(e+o,r+l-u),t.lineTo(e+o-u,r+l),t.lineTo(e-o+u,r+l),t.lineTo(e-o,r+l-u),t.lineTo(e-o,r-l+u),t.closePath()};Ad.drawBarrelPath=function(t,e,r,n,i){var a=n/2,s=i/2,o=e-a,l=e+a,u=r-s,c=r+s,f=v2(n,i),g=f.widthOffset,v=f.heightOffset,x=f.ctrlPtOffsetPct*g;t.beginPath&&t.beginPath(),t.moveTo(o,u+v),t.lineTo(o,c-v),t.quadraticCurveTo(o+x,c,o+g,c),t.lineTo(l-g,c),t.quadraticCurveTo(l-x,c,l,c-v),t.lineTo(l,u+v),t.quadraticCurveTo(l-x,u,l-g,u),t.lineTo(o+g,u),t.quadraticCurveTo(o+x,u,o,u+v),t.closePath()};var kN=Math.sin(0),CN=Math.cos(0),j2={},R2={},rM=Math.PI/40;for(var zf=0*Math.PI;zf<2*Math.PI;zf+=rM)j2[zf]=Math.sin(zf),R2[zf]=Math.cos(zf);Ad.drawEllipsePath=function(t,e,r,n,i){if(t.beginPath&&t.beginPath(),t.ellipse)t.ellipse(e,r,n/2,i/2,0,0,2*Math.PI);else for(var a,s,o=n/2,l=i/2,u=0*Math.PI;u<2*Math.PI;u+=rM)a=e-o*j2[u]*kN+o*R2[u]*CN,s=r+l*R2[u]*kN+l*j2[u]*CN,u===0?t.moveTo(a,s):t.lineTo(a,s);t.closePath()};var mv={};mv.createBuffer=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,[r,r.getContext("2d")]};mv.bufferCanvasImage=function(t){var e=this.cy,r=e.mutableElements(),n=r.boundingBox(),i=this.findContainerClientCoords(),a=t.full?Math.ceil(n.w):i[2],s=t.full?Math.ceil(n.h):i[3],o=dt(t.maxWidth)||dt(t.maxHeight),l=this.getPixelRatio(),u=1;if(t.scale!==void 0)a*=t.scale,s*=t.scale,u=t.scale;else if(o){var c=1/0,f=1/0;dt(t.maxWidth)&&(c=u*t.maxWidth/a),dt(t.maxHeight)&&(f=u*t.maxHeight/s),u=Math.min(c,f),a*=u,s*=u}o||(a*=l,s*=l,u*=l);var g=document.createElement("canvas");g.width=a,g.height=s,g.style.width=a+"px",g.style.height=s+"px";var v=g.getContext("2d");if(a>0&&s>0){v.clearRect(0,0,a,s),v.globalCompositeOperation="source-over";var x=this.getCachedZSortedEles();if(t.full)v.translate(-n.x1*u,-n.y1*u),v.scale(u,u),this.drawElements(v,x),v.scale(1/u,1/u),v.translate(n.x1*u,n.y1*u);else{var _=e.pan(),S={x:_.x*u,y:_.y*u};u*=e.zoom(),v.translate(S.x,S.y),v.scale(u,u),this.drawElements(v,x),v.scale(1/u,1/u),v.translate(-S.x,-S.y)}t.bg&&(v.globalCompositeOperation="destination-over",v.fillStyle=t.bg,v.rect(0,0,a,s),v.fill())}return g};function RB(t,e){for(var r=atob(t),n=new ArrayBuffer(r.length),i=new Uint8Array(n),a=0;a<r.length;a++)i[a]=r.charCodeAt(a);return new Blob([n],{type:e})}function EN(t){var e=t.indexOf(",");return t.substr(e+1)}function nM(t,e,r){var n=function(){return e.toDataURL(r,t.quality)};switch(t.output){case"blob-promise":return new Np(function(i,a){try{e.toBlob(function(s){s!=null?i(s):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},r,t.quality)}catch(s){a(s)}});case"blob":return RB(EN(n()),r);case"base64":return EN(n());default:return n()}}mv.png=function(t){return nM(t,this.bufferCanvasImage(t),"image/png")};mv.jpg=function(t){return nM(t,this.bufferCanvasImage(t),"image/jpeg")};var iM={};iM.nodeShapeImpl=function(t,e,r,n,i,a,s,o){switch(t){case"ellipse":return this.drawEllipsePath(e,r,n,i,a);case"polygon":return this.drawPolygonPath(e,r,n,i,a,s);case"round-polygon":return this.drawRoundPolygonPath(e,r,n,i,a,s,o);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,r,n,i,a,o);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,r,n,i,a,s,o);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,r,n,i,a,o);case"barrel":return this.drawBarrelPath(e,r,n,i,a)}};var LB=aM,or=aM.prototype;or.CANVAS_LAYERS=3;or.SELECT_BOX=0;or.DRAG=1;or.NODE=2;or.WEBGL=3;or.CANVAS_TYPES=["2d","2d","2d","webgl2"];or.BUFFER_COUNT=3;or.TEXTURE_BUFFER=0;or.MOTIONBLUR_BUFFER_NODE=1;or.MOTIONBLUR_BUFFER_DRAG=2;function aM(t){var e=this,r=e.cy.window(),n=r.document;t.webgl&&(or.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(or.CANVAS_LAYERS),contexts:new Array(or.CANVAS_LAYERS),canvasNeedsRedraw:new Array(or.CANVAS_LAYERS),bufferCanvases:new Array(or.BUFFER_COUNT),bufferContexts:new Array(or.CANVAS_LAYERS)};var i="-webkit-tap-highlight-color",a="rgba(0,0,0,0)";e.data.canvasContainer=n.createElement("div");var s=e.data.canvasContainer.style;e.data.canvasContainer.style[i]=a,s.position="relative",s.zIndex="0",s.overflow="hidden";var o=t.cy.container();o.appendChild(e.data.canvasContainer),o.style[i]=a;var l={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};T8()&&(l["-ms-touch-action"]="none",l["touch-action"]="none");for(var u=0;u<or.CANVAS_LAYERS;u++){var c=e.data.canvases[u]=n.createElement("canvas"),f=or.CANVAS_TYPES[u];e.data.contexts[u]=c.getContext(f),e.data.contexts[u]||jn("Could not create canvas of type "+f),Object.keys(l).forEach(function(oe){c.style[oe]=l[oe]}),c.style.position="absolute",c.setAttribute("data-id","layer"+u),c.style.zIndex=String(or.CANVAS_LAYERS-u),e.data.canvasContainer.appendChild(c),e.data.canvasNeedsRedraw[u]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[or.NODE].setAttribute("data-id","layer"+or.NODE+"-node"),e.data.canvases[or.SELECT_BOX].setAttribute("data-id","layer"+or.SELECT_BOX+"-selectbox"),e.data.canvases[or.DRAG].setAttribute("data-id","layer"+or.DRAG+"-drag"),e.data.canvases[or.WEBGL]&&e.data.canvases[or.WEBGL].setAttribute("data-id","layer"+or.WEBGL+"-webgl");for(var u=0;u<or.BUFFER_COUNT;u++)e.data.bufferCanvases[u]=n.createElement("canvas"),e.data.bufferContexts[u]=e.data.bufferCanvases[u].getContext("2d"),e.data.bufferCanvases[u].style.position="absolute",e.data.bufferCanvases[u].setAttribute("data-id","buffer"+u),e.data.bufferCanvases[u].style.zIndex=String(-u-1),e.data.bufferCanvases[u].style.visibility="hidden";e.pathsEnabled=!0;var g=ls(),v=function(fe){return{x:(fe.x1+fe.x2)/2,y:(fe.y1+fe.y2)/2}},x=function(fe){return{x:-fe.w/2,y:-fe.h/2}},_=function(fe){var ge=fe[0]._private,be=ge.oldBackgroundTimestamp===ge.backgroundTimestamp;return!be},S=function(fe){return fe[0]._private.nodeKey},N=function(fe){return fe[0]._private.labelStyleKey},k=function(fe){return fe[0]._private.sourceLabelStyleKey},E=function(fe){return fe[0]._private.targetLabelStyleKey},T=function(fe,ge,be,_e,De){return e.drawElement(fe,ge,be,!1,!1,De)},R=function(fe,ge,be,_e,De){return e.drawElementText(fe,ge,be,_e,"main",De)},j=function(fe,ge,be,_e,De){return e.drawElementText(fe,ge,be,_e,"source",De)},D=function(fe,ge,be,_e,De){return e.drawElementText(fe,ge,be,_e,"target",De)},B=function(fe){return fe.boundingBox(),fe[0]._private.bodyBounds},I=function(fe){return fe.boundingBox(),fe[0]._private.labelBounds.main||g},V=function(fe){return fe.boundingBox(),fe[0]._private.labelBounds.source||g},$=function(fe){return fe.boundingBox(),fe[0]._private.labelBounds.target||g},Z=function(fe,ge){return ge},O=function(fe){return v(B(fe))},W=function(fe,ge,be){var _e=fe?fe+"-":"";return{x:ge.x+be.pstyle(_e+"text-margin-x").pfValue,y:ge.y+be.pstyle(_e+"text-margin-y").pfValue}},F=function(fe,ge,be){var _e=fe[0]._private.rscratch;return{x:_e[ge],y:_e[be]}},K=function(fe){return W("",F(fe,"labelX","labelY"),fe)},X=function(fe){return W("source",F(fe,"sourceLabelX","sourceLabelY"),fe)},Q=function(fe){return W("target",F(fe,"targetLabelX","targetLabelY"),fe)},ae=function(fe){return x(B(fe))},re=function(fe){return x(V(fe))},G=function(fe){return x($(fe))},te=function(fe){var ge=I(fe),be=x(I(fe));if(fe.isNode()){switch(fe.pstyle("text-halign").value){case"left":be.x=-ge.w-(ge.leftPad||0);break;case"right":be.x=-(ge.rightPad||0);break}switch(fe.pstyle("text-valign").value){case"top":be.y=-ge.h-(ge.topPad||0);break;case"bottom":be.y=-(ge.botPad||0);break}}return be},ne=e.data.eleTxrCache=new og(e,{getKey:S,doesEleInvalidateKey:_,drawElement:T,getBoundingBox:B,getRotationPoint:O,getRotationOffset:ae,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),de=e.data.lblTxrCache=new og(e,{getKey:N,drawElement:R,getBoundingBox:I,getRotationPoint:K,getRotationOffset:te,isVisible:Z}),me=e.data.slbTxrCache=new og(e,{getKey:k,drawElement:j,getBoundingBox:V,getRotationPoint:X,getRotationOffset:re,isVisible:Z}),ye=e.data.tlbTxrCache=new og(e,{getKey:E,drawElement:D,getBoundingBox:$,getRotationPoint:Q,getRotationOffset:G,isVisible:Z}),ie=e.data.lyrTxrCache=new WP(e);e.onUpdateEleCalcs(function(fe,ge){ne.invalidateElements(ge),de.invalidateElements(ge),me.invalidateElements(ge),ye.invalidateElements(ge),ie.invalidateElements(ge);for(var be=0;be<ge.length;be++){var _e=ge[be]._private;_e.oldBackgroundTimestamp=_e.backgroundTimestamp}});var pe=function(fe){for(var ge=0;ge<fe.length;ge++)ie.enqueueElementRefinement(fe[ge].ele)};ne.onDequeue(pe),de.onDequeue(pe),me.onDequeue(pe),ye.onDequeue(pe),t.webgl&&e.initWebgl(t,{getStyleKey:S,getLabelKey:N,getSourceLabelKey:k,getTargetLabelKey:E,drawElement:T,drawLabel:R,drawSourceLabel:j,drawTargetLabel:D,getElementBox:B,getLabelBox:I,getSourceLabelBox:V,getTargetLabelBox:$,getElementRotationPoint:O,getElementRotationOffset:ae,getLabelRotationPoint:K,getSourceLabelRotationPoint:X,getTargetLabelRotationPoint:Q,getLabelRotationOffset:te,getSourceLabelRotationOffset:re,getTargetLabelRotationOffset:G})}or.redrawHint=function(t,e){var r=this;switch(t){case"eles":r.data.canvasNeedsRedraw[or.NODE]=e;break;case"drag":r.data.canvasNeedsRedraw[or.DRAG]=e;break;case"select":r.data.canvasNeedsRedraw[or.SELECT_BOX]=e;break;case"gc":r.data.gc=!0;break}};var OB=typeof Path2D<"u";or.path2dEnabled=function(t){if(t===void 0)return this.pathsEnabled;this.pathsEnabled=!!t};or.usePaths=function(){return OB&&this.pathsEnabled};or.setImgSmoothing=function(t,e){t.imageSmoothingEnabled!=null?t.imageSmoothingEnabled=e:(t.webkitImageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e)};or.getImgSmoothing=function(t){return t.imageSmoothingEnabled!=null?t.imageSmoothingEnabled:t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled};or.makeOffscreenCanvas=function(t,e){var r;if((typeof OffscreenCanvas>"u"?"undefined":Mi(OffscreenCanvas))!=="undefined")r=new OffscreenCanvas(t,e);else{var n=this.cy.window(),i=n.document;r=i.createElement("canvas"),r.width=t,r.height=e}return r};[$P,au,Xu,K_,Zh,Md,hs,QP,Ad,mv,iM].forEach(function(t){Ut(or,t)});var DB=[{name:"null",impl:RP},{name:"base",impl:HP},{name:"canvas",impl:LB}],IB=[{type:"layout",extensions:l7},{type:"renderer",extensions:DB}],sM={},oM={};function lM(t,e,r){var n=r,i=function(B){Br("Can not register `"+e+"` for `"+t+"` since `"+B+"` already exists in the prototype and can not be overridden")};if(t==="core"){if(Fg.prototype[e])return i(e);Fg.prototype[e]=r}else if(t==="collection"){if(Sa.prototype[e])return i(e);Sa.prototype[e]=r}else if(t==="layout"){for(var a=function(B){this.options=B,r.call(this,B),_r(this._private)||(this._private={}),this._private.cy=B.cy,this._private.listeners=[],this.createEmitter()},s=a.prototype=Object.create(r.prototype),o=[],l=0;l<o.length;l++){var u=o[l];s[u]=s[u]||function(){return this}}s.start&&!s.run?s.run=function(){return this.start(),this}:!s.start&&s.run&&(s.start=function(){return this.run(),this});var c=r.prototype.stop;s.stop=function(){var D=this.options;if(D&&D.animate){var B=this.animations;if(B)for(var I=0;I<B.length;I++)B[I].stop()}return c?c.call(this):this.emit("layoutstop"),this},s.destroy||(s.destroy=function(){return this}),s.cy=function(){return this._private.cy};var f=function(B){return B._private.cy},g={addEventFields:function(B,I){I.layout=B,I.cy=f(B),I.target=B},bubble:function(){return!0},parent:function(B){return f(B)}};Ut(s,{createEmitter:function(){return this._private.emitter=new wx(g,this),this},emitter:function(){return this._private.emitter},on:function(B,I){return this.emitter().on(B,I),this},one:function(B,I){return this.emitter().one(B,I),this},once:function(B,I){return this.emitter().one(B,I),this},removeListener:function(B,I){return this.emitter().removeListener(B,I),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(B,I){return this.emitter().emit(B,I),this}}),Ir.eventAliasesOn(s),n=a}else if(t==="renderer"&&e!=="null"&&e!=="base"){var v=uM("renderer","base"),x=v.prototype,_=r,S=r.prototype,N=function(){v.apply(this,arguments),_.apply(this,arguments)},k=N.prototype;for(var E in x){var T=x[E],R=S[E]!=null;if(R)return i(E);k[E]=T}for(var j in S)k[j]=S[j];x.clientFunctions.forEach(function(D){k[D]=k[D]||function(){jn("Renderer does not implement `renderer."+D+"()` on its prototype")}}),n=N}else if(t==="__proto__"||t==="constructor"||t==="prototype")return jn(t+" is an illegal type to be registered, possibly lead to prototype pollutions");return N4({map:sM,keys:[t,e],value:n})}function uM(t,e){return T4({map:sM,keys:[t,e]})}function BB(t,e,r,n,i){return N4({map:oM,keys:[t,e,r,n],value:i})}function zB(t,e,r,n){return T4({map:oM,keys:[t,e,r,n]})}var L2=function(){if(arguments.length===2)return uM.apply(null,arguments);if(arguments.length===3)return lM.apply(null,arguments);if(arguments.length===4)return zB.apply(null,arguments);if(arguments.length===5)return BB.apply(null,arguments);jn("Invalid extension access syntax")};Fg.prototype.extension=L2;IB.forEach(function(t){t.extensions.forEach(function(e){lM(t.type,e.name,e.impl)})});var my=function(){if(!(this instanceof my))return new my;this.length=0},Bh=my.prototype;Bh.instanceString=function(){return"stylesheet"};Bh.selector=function(t){var e=this.length++;return this[e]={selector:t,properties:[]},this};Bh.css=function(t,e){var r=this.length-1;if(Ot(t))this[r].properties.push({name:t,value:e});else if(_r(t))for(var n=t,i=Object.keys(n),a=0;a<i.length;a++){var s=i[a],o=n[s];if(o!=null){var l=Zi.properties[s]||Zi.properties[dx(s)];if(l!=null){var u=l.name,c=o;this[r].properties.push({name:u,value:c})}}}return this};Bh.style=Bh.css;Bh.generateStyle=function(t){var e=new Zi(t);return this.appendToStyle(e)};Bh.appendToStyle=function(t){for(var e=0;e<this.length;e++){var r=this[e],n=r.selector,i=r.properties;t.selector(n);for(var a=0;a<i.length;a++){var s=i[a];t.css(s.name,s.value)}}return t};var FB="3.33.1",zh=function(e){if(e===void 0&&(e={}),_r(e))return new Fg(e);if(Ot(e))return L2.apply(L2,arguments)};zh.use=function(t){var e=Array.prototype.slice.call(arguments,1);return e.unshift(zh),t.apply(null,e),this};zh.warnings=function(t){return O4(t)};zh.version=FB;zh.stylesheet=zh.Stylesheet=my;const{string:p0,array:NN,object:m0,number:cm,bool:Ks,oneOfType:Ff,any:g0,func:dm}=c8,VB={id:p0,className:p0,style:Ff([p0,m0]),elements:Ff([NN,g0]),stylesheet:Ff([NN,g0]),layout:Ff([m0,g0]),pan:Ff([m0,g0]),zoom:cm,panningEnabled:Ks,userPanningEnabled:Ks,minZoom:cm,maxZoom:cm,zoomingEnabled:Ks,userZoomingEnabled:Ks,boxSelectionEnabled:Ks,autoungrabify:Ks,autolock:Ks,autounselectify:Ks,get:dm,toJson:dm,diff:dm,forEach:dm,cy:dm,headless:Ks,styleEnabled:Ks,hideEdgesOnViewport:Ks,textureOnViewport:Ks,motionBlur:Ks,motionBlurOpacity:cm,wheelSensitivity:cm,pixelRatio:Ff([p0,m0])},cM=(t,e)=>{if(((a,s)=>a==null||s==null)(t,e)&&(t!=null||e!=null))return!0;if(t===e)return!1;if(typeof t!="object"||typeof e!="object")return t!==e;const r=Object.keys(t),n=Object.keys(e),i=a=>t[a]!==e[a];return r.length!==n.length||!(!r.some(i)&&!n.some(i))},sl=(t,e)=>t!=null?t[e]:null,UB={diff:cM,get:sl,toJson:t=>t,forEach:(t,e)=>t.forEach(e),elements:[{data:{id:"a",label:"Example node A"}},{data:{id:"b",label:"Example node B"}},{data:{id:"e",source:"a",target:"b"}}],stylesheet:[{selector:"node",style:{label:"data(label)"}}],zoom:1,pan:{x:0,y:0}},v0=(t,e,r,n)=>r(sl(t,n),sl(e,n)),HB=(t,e,r,n,i,a,s)=>{t.batch(()=>{(n===cM||v0(e,r,n,"elements"))&&$B(t,sl(e,"elements"),sl(r,"elements"),i,a,s,n),v0(e,r,n,"stylesheet")&&WB(t,sl(e,"stylesheet"),sl(r,"stylesheet"),i),["zoom","minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","pan","panningEnabled","userPanningEnabled","boxSelectionEnabled","autoungrabify","autolock","autounselectify"].forEach(o=>{v0(e,r,n,o)&&GB(t,o,sl(e,o),sl(r,o),i)})}),v0(e,r,n,"layout")&&qB(t,sl(e,"layout"),sl(r,"layout"),i)},GB=(t,e,r,n,i)=>{t[e](i(n))},qB=(t,e,r,n)=>{const i=n(r);i!=null&&t.layout(i).run()},WB=(t,e,r,n)=>{const i=t.style();i?.fromJson(n(r)).update()},$B=(t,e,r,n,i,a,s)=>{const o=[],l=t.collection(),u=[],c={},f={},g=v=>i(i(v,"data"),"id");a(r,v=>{const x=g(v);f[x]=v}),e!=null&&a(e,v=>{const x=g(v);c[x]=v,(_=>f[_]!=null)(x)||l.merge(t.getElementById(x))}),a(r,v=>{const x=g(v),_=(S=>c[S])(x);(S=>c[S]!=null)(x)?u.push({ele1:_,ele2:v}):o.push(n(v))}),l.length>0&&t.remove(l),o.length>0&&t.add(o),u.forEach(({ele1:v,ele2:x})=>KB(t,v,x,n,i,s))},KB=(t,e,r,n,i,a)=>{const s=i(i(r,"data"),"id"),o=t.getElementById(s),l={};["data","position","selected","selectable","locked","grabbable","classes"].forEach(c=>{const f=i(r,c);a(f,i(e,c))&&(l[c]=n(f))});const u=i(r,"scratch");a(u,i(e,"scratch"))&&o.scratch(n(u)),Object.keys(l).length>0&&o.json(l)};class ZB extends er.Component{static get propTypes(){return VB}static get defaultProps(){return UB}static normalizeElements(e){if(e.length!=null)return e;{let{nodes:r,edges:n}=e;return r==null&&(r=[]),n==null&&(n=[]),r.concat(n)}}constructor(e){super(e),this.displayName="CytoscapeComponent",this.containerRef=er.createRef()}componentDidMount(){const e=this.containerRef.current,{global:r,headless:n,styleEnabled:i,hideEdgesOnViewport:a,textureOnViewport:s,motionBlur:o,motionBlurOpacity:l,wheelSensitivity:u,pixelRatio:c}=this.props,f=this._cy=new zh({container:e,headless:n,styleEnabled:i,hideEdgesOnViewport:a,textureOnViewport:s,motionBlur:o,motionBlurOpacity:l,wheelSensitivity:u,pixelRatio:c});r&&(window[r]=f),this.updateCytoscape(null,this.props)}updateCytoscape(e,r){const n=this._cy,{diff:i,toJson:a,get:s,forEach:o}=r;HB(n,e,r,i,a,s,o),r.cy!=null&&r.cy(n)}componentDidUpdate(e){this.updateCytoscape(e,this.props)}componentWillUnmount(){this._cy.destroy()}render(){const{id:e,className:r,style:n}=this.props;return er.createElement("div",{ref:this.containerRef,id:e,className:r,style:n})}}const YB=[{selector:"node",style:{"background-color":"#1f2937",label:"data(label)",color:"#cbd5e1","font-family":"Outfit, sans-serif","font-size":"12px","text-valign":"bottom","text-margin-y":8,width:40,height:40,"border-width":2,"border-color":"#475569","text-outline-width":2,"text-outline-color":"#050508","overlay-padding":6,"z-index":10}},{selector:'node[category="Individual"]',style:{"background-color":"rgba(49, 46, 129, 0.9)","border-color":"#6366f1",shape:"ellipse",width:50,height:50}},{selector:'node[category="Location"]',style:{"background-color":"rgba(6, 78, 59, 0.9)","border-color":"#10b981",shape:"hexagon",width:60,height:60}},{selector:'node[category="Group"]',style:{"background-color":"rgba(88, 28, 135, 0.9)","border-color":"#a855f7",shape:"round-rectangle"}},{selector:"edge",style:{width:2,"line-color":"#334155","target-arrow-color":"#334155","target-arrow-shape":"triangle","curve-style":"bezier"}},{selector:":selected",style:{"border-width":4,"border-color":"#fafafa","line-color":"#fafafa","target-arrow-color":"#fafafa","z-index":999}}],XB=()=>{const{username:t,projectName:e}=ds(),{setRightPanelMode:r,setRightOpen:n,setRightPanelTitle:i}=Zu(),a=Ga(),[s,o]=ce.useState([]),[l,u]=ce.useState(""),[c,f]=ce.useState(!0),[g,v]=ce.useState(null),x=ce.useRef(null),[_,S]=ce.useState(null);ce.useEffect(()=>{r("CUSTOM"),i("Inspector"),N()},[]),ce.useEffect(()=>{const R=setInterval(()=>{const j=document.getElementById("architect-right-panel-portal");j&&(S(j),clearInterval(R))},100);return()=>clearInterval(R)},[]);const N=async()=>{f(!0);try{const R=await it.get("/world-bible/graph");R&&R.nodes&&o([...R.nodes,...R.edges])}catch(R){console.error("Failed to load graph data",R),a("/")}finally{f(!1)}},k=()=>{if(!x.current)return;x.current.layout({name:"cose",animate:!0,padding:50,nodeOverlap:20,componentSpacing:100}).run()};ce.useEffect(()=>{x.current&&(k(),x.current.on("select","node",R=>{const j=R.target;v(j.data()),n(!0)}),x.current.on("unselect","node",()=>{v(null)}))},[s]);const E=()=>{if(!x.current||!l)return;const R=x.current;if(R.elements().removeClass("highlighted faded"),l.length>0){const j=R.nodes().filter(D=>D.data("label").toLowerCase().includes(l.toLowerCase()));j.length>0&&(R.elements().not(j).addClass("faded"),j.addClass("highlighted"),R.animate({fit:{eles:j,padding:50}}))}},T=()=>g?p.jsxs("div",{className:"p-6 flex flex-col h-full animate-in fade-in slide-in-from-right-4 duration-500",children:[p.jsxs("div",{className:"mb-8",children:[p.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[p.jsx("div",{className:`size-12 rounded-xl flex items-center justify-center text-white shadow-xl ${g.category==="Individual"?"bg-indigo-600 shadow-indigo-500/20":g.category==="Location"?"bg-emerald-600 shadow-emerald-500/20":"bg-purple-600 shadow-purple-500/20"}`,children:p.jsx("span",{className:"material-symbols-outlined",children:g.category==="Individual"?"person":g.category==="Location"?"location_on":"groups"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-xl font-serif font-bold text-white leading-tight",children:g.label}),p.jsx("span",{className:"text-[10px] font-black uppercase tracking-tighter text-slate-500",children:g.category})]})]}),p.jsx("p",{className:"text-sm text-slate-400 font-serif leading-relaxed italic opacity-80",children:g.summary||"No description available for this cosmic entity."})]}),p.jsxs("div",{className:"mt-auto pt-6 border-t border-white/5 space-y-3",children:[p.jsxs("button",{onClick:()=>a(`/${t}/${e}/entities/${g.type||"individual"}/${g.id}`),className:"w-full py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-[10px] font-black uppercase tracking-widest text-slate-300 transition-all flex items-center justify-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"}),p.jsx("span",{children:"Open Bible Entry"})]}),p.jsxs("button",{onClick:()=>{if(!x.current)return;const R=x.current.$id(g.id);x.current.animate({center:{eles:R},zoom:2})},className:"w-full py-3 bg-indigo-600/10 hover:bg-indigo-600/20 border border-indigo-500/30 rounded-xl text-[10px] font-black uppercase tracking-widest text-indigo-300 transition-all flex items-center justify-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"center_focus_strong"}),p.jsx("span",{children:"Focus on Graph"})]})]})]}):p.jsxs("div",{className:"p-8 flex flex-col items-center justify-center h-full text-slate-500 text-center opacity-50",children:[p.jsx("span",{className:"material-symbols-outlined text-4xl mb-4",children:"touch_app"}),p.jsxs("p",{className:"text-xs font-black uppercase tracking-widest leading-loose",children:["Select a node",p.jsx("br",{}),"to reveal its secrets"]})]});return p.jsxs("div",{className:"w-full h-full flex bg-background-dark relative overflow-hidden font-display text-foreground",children:[_&&nu.createPortal(T(),_),p.jsx("div",{className:"absolute top-4 left-4 z-20 w-80 pointer-events-none",children:p.jsxs("div",{className:"bg-card/90 backdrop-blur-md border border-border/50 rounded-xl p-4 shadow-2xl pointer-events-auto space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[p.jsx("div",{className:"size-8 rounded bg-primary flex items-center justify-center",children:p.jsx("span",{className:"material-symbols-outlined text-primary-foreground",children:"hub"})}),p.jsx("h2",{className:"font-bold text-lg tracking-tight",children:"Graph Network"})]}),p.jsx("div",{className:"flex gap-2",children:p.jsx("input",{className:"bg-accent/50 border border-input rounded-md px-3 py-2 text-sm w-full outline-none focus:ring-1 focus:ring-primary placeholder:text-slate-600 text-slate-200",placeholder:"Search nodes...",value:l,onChange:R=>u(R.target.value),onKeyDown:R=>R.key==="Enter"&&E()})}),p.jsxs("div",{className:"flex items-center justify-between gap-4 pt-2 border-t border-border/50",children:[p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:k,className:"p-2 bg-white/5 hover:bg-white/10 rounded-lg text-slate-400 hover:text-white transition-colors border border-white/5",title:"Re-simulate Gravity",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"refresh"})}),p.jsx("button",{onClick:()=>x.current?.fit(),className:"p-2 bg-white/5 hover:bg-white/10 rounded-lg text-slate-400 hover:text-white transition-colors border border-white/5",title:"Fit View",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"fit_screen"})})]}),p.jsxs("div",{className:"flex flex-wrap gap-2 text-[10px] uppercase font-bold text-slate-500",children:[p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("div",{className:"size-1.5 rounded-full bg-indigo-500"})," IND"]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("div",{className:"size-1.5 rounded-full bg-emerald-500"})," LOC"]}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("div",{className:"size-1.5 rounded-full bg-purple-500"})," GRP"]})]})]})]})}),s.length===0&&!c&&p.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10 pointer-events-none",children:p.jsx("div",{className:"text-muted text-lg font-serif italic text-slate-600",children:"The void is empty. Document your world in the Bible."})}),p.jsx(ZB,{elements:s,stylesheet:YB,style:{width:"100%",height:"100%"},cy:R=>{x.current=R},minZoom:.2,maxZoom:3,wheelSensitivity:.3,className:"bg-[#050508]"})]})},QB=({id:t})=>{const{id:e}=ds(),r=Ga(),[n,i]=ce.useState("overview"),[a,s]=ce.useState(null),[o,l]=ce.useState(!0),[u,c]=ce.useState(!1);ce.useEffect(()=>{f()},[t]);const f=async()=>{l(!0);try{const _=await it.get(`/bd/entidadindividual/${t}`);s(_)}catch(_){console.error("Error loading character:",_)}finally{l(!1)}},g=async()=>{try{await it.patch("/bd/modificar",{...a,tipoEntidad:"entidadindividual"}),c(!1)}catch(_){console.error("Error saving:",_)}},v=async()=>{if(window.confirm("Move this character to the Trash Bin?"))try{await it.delete(`/bd/entidadindividual/${t}`),r(`/project/${e}`)}catch(_){console.error(_)}},x=(_,S)=>{s(N=>({...N,[_]:S}))};return o?p.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Summoning entity..."}):a?p.jsxs("div",{className:"flex h-full",children:[p.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto custom-scrollbar p-8 gap-6",children:[p.jsxs("div",{className:"flex items-start gap-6",children:[p.jsx("div",{className:"relative",children:p.jsx(ty,{url:a.imagenUrl||"https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1976&auto=format&fit=crop",size:"xl",className:"rounded-2xl border-2 border-primary shadow-[0_0_30px_rgba(99,102,242,0.3)]"})}),p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[p.jsx("span",{className:"text-xs font-bold text-primary bg-primary/10 px-2 py-0.5 rounded border border-primary/20",children:a.estado||"ACTIVE"}),p.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:a.tipo||"Unknown"})]}),p.jsxs("h1",{className:"text-4xl font-bold text-white mb-2",children:[a.nombre," ",a.apellidos]}),p.jsx("p",{className:"text-lg text-slate-300",children:a.origen||"Traveling the void"})]}),p.jsxs("div",{className:"flex gap-2",children:[!u&&p.jsx(rn,{className:"border-red-500/30 text-red-400 hover:bg-red-500/10",icon:"delete",onClick:v,children:"Delete"}),p.jsx(rn,{variant:"secondary",icon:u?"close":"edit",onClick:()=>c(!u),children:u?"Cancel":"Edit Profile"}),u&&p.jsx(rn,{variant:"primary",icon:"save",onClick:g,children:"Save Changes"})]})]}),p.jsx("div",{className:"border-b border-glass-border flex gap-6",children:["Overview","Biography","Attributes & Stats","Relationships"].map(_=>p.jsx("button",{onClick:()=>i(_.toLowerCase()),className:`pb-4 px-2 text-sm font-bold border-b-2 transition-colors ${n===_.toLowerCase()?"text-primary border-primary":"text-slate-500 border-transparent hover:text-white"}`,children:_},_))}),p.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[p.jsx("div",{className:"col-span-1 space-y-6",children:p.jsxs(Rr,{className:"p-4",children:[p.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"fingerprint"})," Identity"]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Name"}),p.jsx("input",{type:"text",value:a.nombre,onChange:_=>x("nombre",_.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Surnames"}),p.jsx("input",{type:"text",value:a.apellidos||"",onChange:_=>x("apellidos",_.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Type / Species"}),p.jsx("input",{type:"text",value:a.tipo||"",onChange:_=>x("tipo",_.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Origin"}),p.jsx("input",{type:"text",value:a.origen||"",onChange:_=>x("origen",_.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!u})]})]})]})}),p.jsx("div",{className:"col-span-2 space-y-6",children:p.jsxs(Rr,{className:"p-6 relative overflow-hidden group",children:[p.jsxs("div",{className:"flex items-center justify-between mb-6",children:[p.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"})," Narrative & Connections"]}),!u&&p.jsx("span",{className:"text-[10px] text-slate-600 bg-white/5 px-2 py-1 rounded",children:"Read Only"})]}),p.jsxs("div",{className:"mb-8",children:[p.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mb-3 opacity-80",children:"Biography"}),p.jsx("textarea",{value:a.descripcion||"",onChange:_=>x("descripcion",_.target.value),readOnly:!u,className:`w-full bg-transparent border-none outline-none text-slate-300 text-sm leading-relaxed resize-none custom-scrollbar ${u?"min-h-[150px] placeholder-white/20":"h-auto overflow-hidden"}`,placeholder:"Write the history of this person..."}),p.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mt-6 mb-3 opacity-80",children:"Behavior & Personality"}),p.jsx("textarea",{value:a.comportamiento||"",onChange:_=>x("comportamiento",_.target.value),readOnly:!u,className:`w-full bg-transparent border-none outline-none text-slate-300 text-sm leading-relaxed resize-none custom-scrollbar ${u?"min-h-[100px]":"h-auto overflow-hidden"}`,placeholder:"How does this person act?"})]}),p.jsxs("div",{className:"pt-6 border-t border-white/5",children:[p.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mb-4 flex items-center gap-2 opacity-80",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})," Established Connections"]}),a.relaciones&&a.relaciones.length>0?p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.relaciones.map((_,S)=>p.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5 hover:border-primary/30 transition-colors",children:[p.jsx("div",{className:"size-8 rounded-full bg-white/10 flex items-center justify-center text-xs font-bold",children:_.entidadDestino?.nombre?.charAt(0)||"?"}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("div",{className:"text-sm font-bold text-white truncate",children:_.entidadDestino?.nombre||"Unknown"}),p.jsx("div",{className:"text-[10px] text-primary truncate",children:_.tipoRelacion||"Connected"})]})]},S))}):p.jsx("div",{className:"p-6 text-center bg-white/5 rounded-xl border border-dashed border-white/10",children:p.jsx("p",{className:"text-xs text-slate-500 italic",children:"No relationships recorded yet."})})]})]})})]})]}),p.jsxs("div",{className:"w-80 border-l border-glass-border bg-surface-dark/50 hidden xl:flex flex-col",children:[p.jsxs("div",{className:"p-4 border-b border-glass-border flex justify-between items-center",children:[p.jsx("span",{className:"text-xs font-bold text-slate-500",children:"QUICK NOTES"}),p.jsx("button",{className:"text-slate-400 hover:text-white",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"})})]}),p.jsx("div",{className:"p-4 flex-1",children:p.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none text-sm text-slate-300 placeholder-slate-600 resize-none",placeholder:"Draft a quick scene or jot down notes for Elara here..."})}),p.jsx("div",{className:"p-2 border-t border-glass-border text-right text-[10px] text-slate-600",children:"0 words"})]})]}):p.jsx("div",{className:"p-20 text-center text-red-500",children:"Character not found in the archives."})},TN=({id:t})=>{const[e,r]=ce.useState(null),[n,i]=ce.useState(!0),[a,s]=ce.useState(!1);ce.useEffect(()=>{o()},[t]);const o=async()=>{i(!0);try{const c=await it.get(`/bd/zona/${t}`);r(c)}catch(c){console.error("Error loading location:",c)}finally{i(!1)}},l=async()=>{try{await it.patch("/bd/modificar",{...e,tipoEntidad:"zona"}),s(!1)}catch(c){console.error("Error saving:",c)}},u=(c,f)=>{r(g=>({...g,[c]:f}))};return n?p.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Scanning terrain..."}):e?p.jsxs("div",{className:"flex h-full overflow-y-auto custom-scrollbar p-8 flex-col gap-8",children:[p.jsxs("header",{className:"flex justify-between items-end",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[p.jsx("span",{className:"text-xs font-bold text-emerald-400 bg-emerald-400/10 px-2 py-0.5 rounded border border-emerald-400/20",children:"LOCATION"}),p.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:e.tipo||"Wilderness"})]}),p.jsx("h1",{className:"text-5xl font-manrope font-black text-white tracking-tight",children:e.nombre}),p.jsx("p",{className:"text-slate-400 mt-2",children:e.apellidos||"Uncharted territory"})]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(rn,{variant:"secondary",icon:a?"close":"edit",onClick:()=>s(!a),children:a?"Cancel":"Edit Location"}),a&&p.jsx(rn,{variant:"primary",icon:"save",onClick:l,children:"Update Records"})]})]}),p.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[p.jsxs("div",{className:"col-span-1 space-y-6",children:[p.jsxs(Rr,{className:"p-6",children:[p.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"straighten"})," Geography & Scale"]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Size / Scale"}),p.jsx("input",{type:"text",value:e.tamanno||"",onChange:c=>u("tamanno",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Development Level"}),p.jsx("input",{type:"text",value:e.desarrollo||"",onChange:c=>u("desarrollo",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]})]})]}),p.jsxs(Rr,{className:"p-6",children:[p.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4",children:"Quick Stats"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[p.jsx("span",{className:"text-[10px] text-slate-500 block",children:"Density"}),p.jsx("span",{className:"text-white font-bold",children:"Medium"})]}),p.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[p.jsx("span",{className:"text-[10px] text-slate-500 block",children:"Security"}),p.jsx("span",{className:"text-emerald-400 font-bold",children:"Stable"})]})]})]})]}),p.jsx("div",{className:"col-span-2 space-y-6",children:p.jsxs(Rr,{className:"p-8",children:[p.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"description"})," Topographic Records & Lore"]}),p.jsx("textarea",{value:e.descripcion||"",onChange:c=>u("descripcion",c.target.value),readOnly:!a,className:"w-full bg-transparent border-none outline-none text-slate-300 text-lg leading-relaxed min-h-[400px] resize-none",placeholder:"Describe the vistas, the smells, and the secrets of this place..."})]})})]})]}):p.jsx("div",{className:"p-20 text-center text-red-500",children:"Location not found in the maps."})},JB=({id:t})=>{const[e,r]=ce.useState(null),[n,i]=ce.useState(!0),[a,s]=ce.useState(!1);ce.useEffect(()=>{o()},[t]);const o=async()=>{i(!0);try{const c=await it.get(`/bd/entidadcolectiva/${t}`);r(c)}catch(c){console.error("Error loading collective:",c)}finally{i(!1)}},l=async()=>{try{await it.patch("/bd/modificar",{...e,tipoEntidad:"entidadcolectiva"}),s(!1)}catch(c){console.error("Error saving:",c)}},u=(c,f)=>{r(g=>({...g,[c]:f}))};return n?p.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Gathering intelligence..."}):e?p.jsxs("div",{className:"flex h-full overflow-y-auto custom-scrollbar p-8 flex-col gap-8",children:[p.jsxs("header",{className:"flex justify-between items-end",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[p.jsx("span",{className:"text-xs font-bold text-indigo-400 bg-indigo-400/10 px-2 py-0.5 rounded border border-indigo-400/20",children:"COLLECTIVE"}),p.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:e.tipo||"Organization"})]}),p.jsx("h1",{className:"text-5xl font-manrope font-black text-white tracking-tight",children:e.nombre}),p.jsxs("p",{className:"text-slate-400 mt-2",children:[e.cantidadMiembros||"Unknown"," members"]})]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx(rn,{variant:"secondary",icon:a?"close":"edit",onClick:()=>s(!a),children:a?"Cancel":"Edit Collective"}),a&&p.jsx(rn,{variant:"primary",icon:"save",onClick:l,children:"Update Dossier"})]})]}),p.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[p.jsx("div",{className:"col-span-1 space-y-6",children:p.jsxs(Rr,{className:"p-6",children:[p.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"group_work"})," Group Dynamics"]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Scale / Members"}),p.jsx("input",{type:"text",value:e.cantidadMiembros||"",onChange:c=>u("cantidadMiembros",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Behavior / Alignment"}),p.jsx("input",{type:"text",value:e.comportamiento||"",onChange:c=>u("comportamiento",c.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]})]})]})}),p.jsx("div",{className:"col-span-2 space-y-6",children:p.jsxs(Rr,{className:"p-8",children:[p.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"history_edu"})," Mandate & History"]}),p.jsx("textarea",{value:e.descripcion||"",onChange:c=>u("descripcion",c.target.value),readOnly:!a,className:"w-full bg-transparent border-none outline-none text-slate-300 text-lg leading-relaxed min-h-[400px] resize-none",placeholder:"Detail the motives, the structure, and the legacy of this group..."})]})})]})]}):p.jsx("div",{className:"p-20 text-center text-red-500",children:"Collective not found in the records."})},ez=()=>p.jsx("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300",children:p.jsxs("main",{className:"flex-1 flex flex-col p-12 overflow-y-auto custom-scrollbar relative",children:[p.jsxs("header",{className:"mb-12 space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold text-[10px] tracking-widest uppercase",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"grid_view"}),p.jsx("span",{children:"Universo Alpha"}),p.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),p.jsx("span",{children:"Galaxia Andrmeda"}),p.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),p.jsx("span",{className:"text-white",children:"Sistema Solar"})]}),p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsxs("div",{className:"space-y-4 max-w-3xl",children:[p.jsxs("div",{className:"flex items-center gap-3 px-3 py-1 rounded bg-orange-500/10 text-orange-400 border border-orange-500/20 inline-block",children:[p.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"sunny"}),p.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Sistema Planetario"}),p.jsx("span",{className:"text-[9px] font-bold text-slate-600 tracking-widest ml-2",children:"ID: SYS-SOL-001"})]}),p.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:"Sistema Solar"}),p.jsx("p",{className:"text-slate-400 text-lg leading-relaxed",children:"Sistema planetario principal ubicado en el Brazo de Orin, hogar de la nica vida biolgica compleja confirmada en el sector galctico Alpha-9."})]}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{className:"p-3 rounded-2xl bg-white/5 hover:bg-red-500/10 text-slate-500 hover:text-red-400 border border-white/5 transition-all outline-none",children:p.jsx("span",{className:"material-symbols-outlined",children:"delete"})}),p.jsx(rn,{variant:"primary",icon:"save",children:"Guardar"})]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[p.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[p.jsxs("section",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"sell"}),p.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Etiquetas"}),p.jsx("span",{className:"ml-auto text-[9px] font-bold text-slate-600 px-1.5 py-0.5 rounded bg-white/5",children:"3 ACTIVAS"})]}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[p.jsx(lw,{label:"Estrella Tipo G",color:"amber",icon:"star"}),p.jsx(lw,{label:"Vida Confirmada",color:"emerald",icon:"tempest"}),p.jsx(lw,{label:"Rico en Agua",color:"cyan",icon:"water_drop"}),p.jsx("button",{className:"size-8 rounded-full border border-dashed border-white/10 flex items-center justify-center text-slate-600 hover:text-white hover:border-white/30 transition-all",children:"+"})]})]}),p.jsxs("section",{className:"space-y-6",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"analytics"}),p.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Atributos Principales"}),p.jsx("button",{className:"ml-auto text-slate-600 hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"settings"})})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx(y0,{label:"Forma / Estructura",value:"Heliosfrica Estndar",icon:"hive"}),p.jsx(y0,{label:"Composicin",value:"Hidrgeno (74%), Helio (24%)",icon:"experiment"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsx(y0,{label:"Edad (Aos)",value:"4.6 MM",unit:"Aos"}),p.jsx(y0,{label:"Ciclo Orbital",value:"230 MM",unit:"Aos"})]})]})]}),p.jsxs("section",{className:"space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"menu_book"}),p.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Notas de Lore"})]}),p.jsx("textarea",{className:"w-full h-48 bg-white/5 border border-white/5 rounded-[2rem] p-6 text-sm text-slate-400 placeholder:text-slate-700 focus:border-primary/50 outline-none transition-all resize-none leading-relaxed italic shadow-inner",defaultValue:"El sistema contiene un cinturn de asteroides inusualmente denso entre el 4 y 5 planeta. Se teoriza que es el remanente de una colisin planetaria antigua conocida como 'El Gran Impacto' en las escrituras sagradas de los habitantes de Terra."})]})]}),p.jsx("div",{className:"lg:col-span-2",children:p.jsxs(Rr,{className:"h-full border-white/5 bg-surface-dark/40 overflow-hidden flex flex-col shadow-2xl",children:[p.jsxs("header",{className:"p-8 border-b border-white/5 flex justify-between items-center",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"size-10 rounded-xl bg-primary/20 text-primary flex items-center justify-center",children:p.jsx("span",{className:"material-symbols-outlined",children:"hub"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-bold text-white text-lg tracking-tight",children:"Contenido Interno (Planetas)"}),p.jsx("p",{className:"text-[10px] font-medium text-slate-500 mt-0.5",children:"Arrastra para reordenar la jerarqua orbital"})]})]}),p.jsxs("div",{className:"px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[10px] font-black uppercase tracking-widest flex items-center gap-2",children:[p.jsx("div",{className:"size-1.5 rounded-full bg-emerald-500 animate-pulse"}),"8 Entidades"]})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-3",children:[p.jsx(hm,{name:"Mercurio",type:"Rocoso",stats:"430C | 88 Das",icon:"public"}),p.jsx(hm,{name:"Venus",type:"Atmsfera",stats:"462C | 225 Das",icon:"public"}),p.jsx(hm,{name:"Tierra",type:"Habitable",stats:"8B Hab | 1 Luna",icon:"public",active:!0}),p.jsx(hm,{name:"Marte",type:"Desierto",stats:"-60C | 2 Lunas",icon:"public"}),p.jsx(hm,{name:"Cinturn Asteroides",type:"Anillo",stats:">1M Obj",icon:"grain"})]}),p.jsx("div",{className:"p-8 bg-black/20 border-t border-white/5",children:p.jsxs("button",{className:"w-full py-4 rounded-[1.5rem] border-2 border-dashed border-white/10 text-slate-500 hover:text-white hover:border-primary/50 hover:bg-primary/5 transition-all flex items-center justify-center gap-3 font-black uppercase text-[10px] tracking-[0.2em]",children:[p.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Aadir Nueva Entidad"]})})]})})]})]})}),lw=({label:t,color:e,icon:r})=>p.jsxs("div",{className:`px-4 py-1.5 rounded-xl bg-${e}-500/10 text-${e}-400 border border-${e}-500/20 flex items-center gap-2 text-[10px] font-black uppercase tracking-widest shadow-lg`,children:[p.jsx("span",{className:"material-symbols-outlined text-[14px]",children:r}),t]}),y0=({label:t,value:e,unit:r,icon:n})=>p.jsxs("div",{className:"space-y-2",children:[p.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-slate-600 ml-1",children:t}),p.jsxs("div",{className:"w-full bg-white/5 border border-white/5 rounded-2xl px-5 py-3.5 flex items-center justify-between group hover:border-white/10 transition-all",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[n&&p.jsx("span",{className:"material-symbols-outlined text-slate-500 text-lg group-hover:text-primary transition-colors",children:n}),p.jsx("span",{className:"text-sm font-bold text-slate-300",children:e})]}),r&&p.jsx("span",{className:"text-[10px] font-black text-slate-600 uppercase tracking-widest",children:r})]})]}),hm=({name:t,type:e,stats:r,icon:n,active:i})=>p.jsxs("div",{className:`group flex items-center gap-6 p-4 rounded-2xl transition-all cursor-pointer ${i?"bg-primary/10 border border-primary/20 shadow-xl":"hover:bg-white/5 border border-transparent"}`,children:[p.jsx("span",{className:"material-symbols-outlined text-slate-700 group-hover:text-slate-500",children:"drag_indicator"}),p.jsx("div",{className:`size-12 rounded-xl flex items-center justify-center ${i?"bg-primary text-white shadow-lg shadow-primary/30":"bg-surface-dark border border-white/5 text-slate-500"}`,children:p.jsx("span",{className:"material-symbols-outlined text-3xl",children:n})}),p.jsx("div",{className:"flex-1",children:p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("h4",{className:"text-sm font-bold text-white group-hover:text-primary transition-colors",children:t}),p.jsx("span",{className:`text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-widest ${i?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-white/5 text-slate-600"}`,children:e})]})}),p.jsx("div",{className:"flex flex-col items-end gap-1",children:p.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[p.jsx("span",{className:"material-symbols-outlined text-[12px]",children:"analytics"}),p.jsx("span",{className:"text-[10px] font-mono tracking-tight group-hover:text-slate-300",children:r})]})}),p.jsxs("div",{className:"flex gap-2 ml-4",children:[p.jsx("button",{className:"p-2 rounded-lg text-slate-700 hover:text-white hover:bg-white/5 transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit_note"})}),i?p.jsx("button",{className:"size-8 rounded-full bg-primary text-white flex items-center justify-center shadow-lg",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"arrow_forward"})}):p.jsx("button",{className:"p-2 rounded-lg text-slate-700 hover:text-white hover:bg-white/5 transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-xl",children:"open_in_new"})})]})]}),tz=()=>p.jsx("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300",children:p.jsxs("main",{className:"flex-1 flex flex-col p-12 overflow-y-auto custom-scrollbar relative",children:[p.jsxs("header",{className:"mb-12 space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold text-[10px] tracking-widest uppercase",children:[p.jsx("span",{children:"Sistema Solar"}),p.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),p.jsx("span",{children:"Kepler-186f"}),p.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),p.jsx("span",{className:"text-white",children:"Territorios"})]}),p.jsxs("div",{className:"flex justify-between items-end",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[p.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:"Kepler-186f"}),p.jsx("span",{className:"material-symbols-outlined text-4xl text-primary",children:"public"})]}),p.jsx("p",{className:"text-slate-400 text-lg max-w-2xl leading-relaxed",children:"Gestin geopoltica y geogrfica de la superficie planetaria. Administra biomas, asentamientos y recursos estratgicos."})]}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx(rn,{variant:"secondary",icon:"map",children:"Ver Atlas"}),p.jsx(rn,{variant:"primary",icon:"add",children:"Nuevo Territorio"})]})]})]}),p.jsxs("section",{className:"space-y-8",children:[p.jsxs(Rr,{className:"p-2 flex items-center justify-between border-white/5",children:[p.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[p.jsxs("div",{className:"relative flex-1 max-w-sm",children:[p.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm",children:"search"}),p.jsx("input",{type:"text",placeholder:"Buscar por nombre...",className:"w-full bg-transparent border-none rounded-xl py-2 pl-9 pr-4 text-xs focus:ring-1 focus:ring-primary/30 outline-none transition-all"})]}),p.jsx("div",{className:"w-px h-6 bg-white/5 mx-2"}),p.jsx(uw,{label:"Bioma: Todos"}),p.jsx(uw,{label:"Poblacin"}),p.jsx(uw,{label:"Estado"})]}),p.jsxs("div",{className:"flex items-center gap-1 p-1 bg-white/5 rounded-lg",children:[p.jsx("button",{className:"p-1.5 rounded-md text-slate-500 hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"format_list_bulleted"})}),p.jsx("button",{className:"p-1.5 rounded-md bg-white/10 text-white shadow-sm",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_view"})})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[p.jsx(cw,{title:"Nueva Neo-Tokyo",desc:"Metrpolis vertical construida sobre las...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuAYF5Q6W3o1w1f1",badges:["Capital"],stats:["15M","Templado","Costero"],color:"cyan"}),p.jsx(cw,{title:"Mar de Dunas",desc:"Extensin rida rica en especia slica...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuBYG6R7X4p2x2g2",stats:["Hostil","rido"],color:"amber"}),p.jsx(cw,{title:"Sanctum Bio-Domo",desc:"Instalacin de investigacin...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuCZ H7S8Y5q3z3h3",badges:["Ciencia"],stats:["5K","Jungla"],color:"purple"}),p.jsxs("div",{className:"group border-2 border-dashed border-white/5 rounded-[2.5rem] flex flex-col items-center justify-center p-12 gap-4 hover:border-primary/30 hover:bg-primary/5 transition-all cursor-pointer",children:[p.jsx("div",{className:"size-16 rounded-3xl bg-white/5 flex items-center justify-center group-hover:scale-110 transition-transform",children:p.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-600 group-hover:text-primary",children:"add_location_alt"})}),p.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-slate-600 group-hover:text-white",children:"Aadir Territorio"})]})]})]})]})}),uw=({label:t})=>p.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl hover:bg-white/5 transition-all group",children:[p.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-white",children:t}),p.jsx("span",{className:"material-symbols-outlined text-slate-600 text-[14px]",children:"expand_more"})]}),cw=({title:t,desc:e,image:r,badges:n=[],stats:i=[],color:a})=>p.jsxs("div",{className:"group relative rounded-[2.5rem] overflow-hidden border border-white/5 bg-surface-dark/50 hover:border-white/10 transition-all shadow-2xl",children:[p.jsxs("div",{className:"h-48 overflow-hidden relative",children:[p.jsx("img",{src:r,alt:t,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-60 group-hover:opacity-100"}),p.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-surface-dark via-transparent to-transparent"}),p.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:n.map(s=>p.jsxs("span",{className:`px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest bg-${a==="cyan"?"primary":a==="amber"?"amber-500":"purple-500"}/20 text-${a==="cyan"?"primary":a==="amber"?"amber-400":"purple-400"} border border-white/10 backdrop-blur-md flex items-center gap-1.5`,children:[p.jsx("span",{className:"material-symbols-outlined text-[12px]",children:s==="Capital"?"star":"science"}),s]},s))})]}),p.jsxs("div",{className:"p-8 space-y-6",children:[p.jsxs("header",{className:"flex justify-between items-start",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-2xl font-manrope font-black text-white mb-2 group-hover:text-primary transition-colors",children:t}),p.jsx("p",{className:"text-xs text-slate-500 leading-relaxed line-clamp-2",children:e})]}),p.jsx("button",{className:"p-2 text-slate-700 hover:text-white",children:p.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})]}),p.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(s=>p.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-white/5 border border-white/5 text-[9px] font-black text-slate-400 uppercase tracking-widest",children:[p.jsx("div",{className:`size-1.5 rounded-full bg-${a==="cyan"?"primary":a==="amber"?"amber-500":"purple-500"}/50`}),s]},s))}),p.jsxs("div",{className:"flex gap-3 pt-2",children:[p.jsxs("button",{className:"flex-1 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[p.jsx("span",{className:"material-symbols-outlined text-sm opacity-50",children:"edit"})," Editar"]}),p.jsxs("button",{className:"flex-1 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[p.jsx("span",{className:"material-symbols-outlined text-sm opacity-50",children:"map"})," Ubicacin"]})]})]})]}),rz=()=>{const{type:t,entityId:e}=ds(),r=()=>{const n=t?.toLowerCase();switch(n){case"character":case"entidadindividual":return p.jsx(QB,{id:e});case"location":case"zona":return p.jsx(TN,{id:e});case"culture":case"entidadcolectiva":return p.jsx(JB,{id:e});case"universe":case"galaxy":case"system":return p.jsx(ez,{id:e,type:n});case"planet":return p.jsx(tz,{id:e});case"construccion":return p.jsx(TN,{id:e});case"efectos":return p.jsxs("div",{className:"p-8 text-white",children:["Effect/Spell View for ID: ",id]});case"interaccion":return p.jsxs("div",{className:"p-8 text-white",children:["Interaction/Event View for ID: ",id]});case"magic":return p.jsxs("div",{className:"p-8 text-white",children:["Magic System View for ID: ",id]});default:return p.jsxs("div",{className:"p-8 text-white",children:["Unknown Entity Type: ",t]})}};return p.jsx("div",{className:"flex-1 bg-background-dark overflow-hidden",children:r()})},nz=()=>{const{setRightPanelMode:t,setRightOpen:e,setRightPanelTitle:r}=Zu(),[n,i]=ce.useState([]),[a,s]=ce.useState(null),[o,l]=ce.useState([]),[u,c]=ce.useState(!0),[f,g]=ce.useState(!1),[v,x]=ce.useState(!1),[_,S]=ce.useState({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0}),[N,k]=ce.useState({nombre:"",descripcion:""}),[E,T]=ce.useState(null),[R,j]=ce.useState(null),[D,B]=ce.useState("eventos"),[I,V]=ce.useState([]),[$,Z]=ce.useState([]),[O,W]=ce.useState(null),F=er.useRef(!1),K=async Ce=>{try{return(await it.get("/bd/relacion")).filter(ht=>ht.tipoOrigen==="lineatiempo"&&ht.idOrigen===Ce||ht.tipoDestino==="lineatiempo"&&ht.idDestino===Ce).map(ht=>ht.idOrigen===Ce?ht.idDestino:ht.idOrigen)}catch(ze){return console.error(ze),[]}},X=async(Ce,ze)=>{const Ke=await K(Ce),et=ze.filter(Nt=>Ke.includes(Nt.id));V(et);const ht=ze.filter(Nt=>Nt.id!==Ce&&!Ke.includes(Nt.id));Z(ht)},Q=async Ce=>{if(!(!a||!Ce))try{await it.put("/bd/insertar",{tipoEntidad:"relacion",tipoOrigen:"lineatiempo",idOrigen:a,tipoDestino:"lineatiempo",idDestino:Ce,descripcion:"Anexo de lnea de tiempo"}),X(a,n)}catch(ze){console.error(ze)}},ae=async Ce=>{const Ke=(await it.get("/bd/relacion")).find(et=>et.tipoOrigen==="lineatiempo"&&et.idOrigen===a&&et.idDestino===Ce||et.tipoDestino==="lineatiempo"&&et.idDestino===a&&et.idOrigen===Ce);Ke&&(await it.delete(`/bd/relacion/${Ke.id}`),X(a,n))};ce.useEffect(()=>{t("CUSTOM"),r("Lnea de Tiempo");const Ce=setInterval(()=>{const ze=document.getElementById("architect-right-panel-portal");ze&&(W(ze),clearInterval(Ce))},50);return()=>{clearInterval(Ce),t("NOTES"),r("")}},[]);const[re,G]=ce.useState([]),[te,ne]=ce.useState(null);ce.useEffect(()=>{F.current||(F.current=!0,me())},[]);const de=Ce=>{r(p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{children:"LNEA DE TIEMPO"}),Ce&&p.jsx("span",{className:"text-[10px] text-slate-400 font-medium normal-case tracking-normal mt-0.5",children:Ce})]}))};ce.useEffect(()=>{if(D==="eventos"||D==="anexos")if(a){const ze=re.flatMap(Ke=>Ke.lineasTemporales||[]).find(Ke=>Ke.id===a);de(ze?.nombre)}else de(null);else D==="universo"&&r("Multiverso")},[a,D,re]);const me=async()=>{try{const Ce=await it.get("/multiverso/list");if(G(Ce),!a&&Ce.length>0){const ze=Ce[0];ze.lineasTemporales&&ze.lineasTemporales.length>0&&s(ze.lineasTemporales[0].id)}}catch(Ce){console.error("Failed to load multiverse",Ce)}},ye=async Ce=>{try{const ze=await it.get(`/timeline/linea/${Ce}/eventos`);ze.sort((Ke,et)=>(Ke.ordenAbsoluto||0)-(et.ordenAbsoluto||0)),l(ze)}catch(ze){console.error("Failed to load events",ze)}},ie=async()=>{if(!a||!_.nombre)return;const Ce={..._,ordenAbsoluto:parseInt(_.ordenAbsoluto)||0};try{E?await it.put(`/timeline/evento/${E.id}`,{...Ce,lineaTiempo:{id:a}}):await it.post("/timeline/evento",{...Ce,lineaTiempo:{id:a}}),S({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0}),T(null),ye(a)}catch(ze){console.error(ze)}},pe=Ce=>{T(Ce),S({nombre:Ce.nombre,descripcion:Ce.descripcion,fechaTexto:Ce.fechaTexto,ordenAbsoluto:Ce.ordenAbsoluto||0}),B("eventos"),e(!0)},oe=async()=>{if(!(!N.nombre||!N.universoId))try{const Ce=await it.post("/timeline/linea",{...N,esRaiz:!1,universo:{id:N.universoId}});x(!1),k({nombre:"",descripcion:"",universoId:null}),await me(),s(Ce.id)}catch(Ce){console.error("Error creating timeline:",Ce)}},[fe,ge]=ce.useState({nombre:"",descripcion:""}),be=async()=>{if(fe.nombre)try{const Ce=await it.post("/multiverso/crear",fe);ge({nombre:"",descripcion:""}),e(!1),await me()}catch(Ce){console.error("Error creating universe",Ce)}},_e=async()=>{if(te)try{await it.put(`/multiverso/${te}`,{nombre:fe.nombre,descripcion:fe.descripcion}),e(!1),await me()}catch(Ce){console.error("Error updating universe",Ce)}},De=async()=>{if(te&&window.confirm("Delete this universe and ALL its timelines? This cannot be undone."))try{await it.delete(`/multiverso/${te}`),e(!1),ne(null),await me()}catch(Ce){console.error("Error deleting universe",Ce)}};ce.useEffect(()=>{if(D==="universe-create")ge({nombre:"",descripcion:""});else if(D==="universe-edit"&&te){const Ce=re.find(ze=>ze.id===te);Ce&&ge({nombre:Ce.nombre,descripcion:Ce.descripcion||""})}},[D,te,re]);const[qe,Ue]=ce.useState({open:!1,type:null,id:null,title:"",message:""}),Ve=(Ce,ze)=>{ze.stopPropagation(),Ue({open:!0,type:"TIMELINE",id:Ce,title:"Delete Timeline",message:"Are you sure you want to delete this timeline? All events will be lost."})},Je=(Ce,ze)=>{ze.stopPropagation(),Ue({open:!0,type:"EVENT",id:Ce,title:"Delete Event",message:"Are you sure you want to delete this event?"})},ft=async()=>{const{type:Ce,id:ze}=qe;if(!(!Ce||!ze))try{if(Ce==="TIMELINE"){if(await it.delete(`/timeline/linea/${ze}`),a===ze){const et=re.flatMap(ht=>ht.lineasTemporales||[]).filter(ht=>ht.id!==ze);s(et.length>0?et[0].id:null)}await me()}else Ce==="EVENT"&&(await it.delete(`/timeline/evento/${ze}`),ye(a),E&&E.id===ze&&T(null))}catch(Ke){console.error(Ke),alert("Error deleting item")}},We=p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"p-4 border-b border-white/5",children:p.jsxs("div",{className:"flex bg-black/40 rounded-lg p-1 overflow-x-auto gap-1",children:[p.jsx("button",{onClick:()=>B("eventos"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${D==="eventos"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Eventos"}),p.jsx("button",{onClick:()=>B("anexos"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${D==="anexos"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Anexos"}),p.jsx("button",{onClick:()=>B("universo"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${D==="universo"?"bg-amber-600 text-white shadow-lg":"text-slate-500 hover:text-amber-500/80"}`,children:"Universo"})]})}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[D==="eventos"&&p.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:p.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[p.jsxs("h3",{className:"text-xs font-black uppercase text-primary mb-4 flex items-center justify-between",children:[E?"Edit Event":"New Event",E&&p.jsx("button",{onClick:()=>{T(null),S({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:o.length+1})},className:"text-[10px] text-slate-500 hover:text-white underline",children:"CANCEL"})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Title"}),p.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:_.nombre,onChange:Ce=>S({..._,nombre:Ce.target.value}),placeholder:"Event Name"})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Date Label"}),p.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:_.fechaTexto,onChange:Ce=>S({..._,fechaTexto:Ce.target.value}),placeholder:"e.g. Year 500"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Order (Sort)"}),p.jsx("input",{type:"text",className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:_.ordenAbsoluto,onChange:Ce=>{const ze=Ce.target.value;/^[-+]?\d*$/.test(ze)&&S({..._,ordenAbsoluto:ze})},placeholder:"+/- Num"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Description"}),p.jsx("textarea",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary h-24 resize-none",value:_.descripcion,onChange:Ce=>S({..._,descripcion:Ce.target.value}),placeholder:"Describe what happened..."})]}),p.jsx("div",{className:"pt-2",children:p.jsx(rn,{variant:"primary",onClick:ie,className:"w-full justify-center",children:E?"Save Changes":"Create Event"})}),E&&p.jsx("button",{onClick:Ce=>Je(E.id,Ce),className:"w-full text-center text-xs text-red-500 hover:text-red-400 py-2 border border-red-500/20 rounded-lg hover:bg-red-500/10 transition-colors",children:"Delete Event"})]})]})}),D==="anexos"&&p.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:p.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[p.jsx("h3",{className:"text-xs font-black uppercase text-primary mb-4",children:"Annexed Timelines"}),p.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Link other localized timelines to this one to verify chronological consistency."}),p.jsxs("div",{className:"space-y-2 mb-6",children:[I.map(Ce=>p.jsxs("div",{className:"flex items-center justify-between p-2 bg-white/5 rounded-lg border border-white/5",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-xs text-slate-400",children:"timeline"}),p.jsx("span",{className:"text-xs font-bold text-slate-300",children:Ce.nombre})]}),p.jsx("button",{onClick:()=>ae(Ce.id),className:"text-slate-500 hover:text-red-500",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"link_off"})})]},Ce.id)),I.length===0&&p.jsx("span",{className:"text-xs text-slate-600 italic",children:"No linked timelines."})]}),p.jsx("h4",{className:"text-[10px] font-bold uppercase text-slate-400 mb-2",children:"Available to Link"}),p.jsxs("div",{className:"space-y-1",children:[$.map(Ce=>p.jsxs("button",{onClick:()=>Q(Ce.id),className:"w-full flex items-center gap-2 p-2 hover:bg-white/5 rounded-lg text-left transition-colors group",children:[p.jsx("span",{className:"material-symbols-outlined text-xs text-green-500/50 group-hover:text-green-500",children:"add_link"}),p.jsx("span",{className:"text-xs text-slate-400 group-hover:text-white",children:Ce.nombre})]},Ce.id)),$.length===0&&p.jsx("span",{className:"text-xs text-slate-600 italic",children:"No other timelines available."})]})]})}),D==="universo"&&p.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:p.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[p.jsx("h3",{className:"text-xs font-black uppercase text-amber-500 mb-4",children:te?"Edit Universe":"New Universe"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Universe Name"}),p.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:fe.nombre,onChange:Ce=>ge({...fe,nombre:Ce.target.value}),placeholder:"e.g. Alternate Reality 1"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Description"}),p.jsx("textarea",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary h-24 resize-none",value:fe.descripcion,onChange:Ce=>ge({...fe,descripcion:Ce.target.value}),placeholder:"Context for this universe..."})]}),p.jsx("div",{className:"pt-2",children:p.jsx(rn,{variant:"primary",onClick:te?_e:be,className:"w-full justify-center",children:te?"Save Changes":"Create Universe"})}),te&&p.jsx("button",{onClick:De,className:"w-full text-center text-xs text-red-500 hover:text-red-400 py-2 border border-red-500/20 rounded-lg hover:bg-red-500/10 transition-colors",children:"Delete Universe"})]})]})})]})]});return p.jsxs("div",{className:"flex h-screen bg-background-dark text-white overflow-hidden",children:[O&&nu.createPortal(We,O),p.jsxs("aside",{className:"w-64 bg-surface-dark border-r border-white/5 flex flex-col p-4 z-20 shrink-0",children:[p.jsxs("header",{className:"flex justify-between items-center mb-6",children:[p.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-primary",children:"Multiverse"}),p.jsx("button",{onClick:()=>{t("CUSTOM"),B("universo"),ne(null),ge({nombre:"",descripcion:""}),e(!0)},className:"text-slate-400 hover:text-white",title:"New Universe",children:p.jsx("span",{className:"material-symbols-outlined",children:"add_circle"})})]}),p.jsx("div",{className:"space-y-6 overflow-y-auto flex-1 custom-scrollbar",children:re.map(Ce=>p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex items-center justify-between group",children:[p.jsx("h3",{className:`text-[10px] font-bold uppercase pl-2 cursor-pointer ${te===Ce.id?"text-white":"text-slate-500"}`,onClick:()=>{ne(Ce.id),ge({nombre:Ce.nombre,descripcion:Ce.descripcion||""}),B("universo"),t("CUSTOM"),e(!0)},children:Ce.nombre}),p.jsx("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:p.jsx("button",{onClick:()=>{k({...N,universoId:Ce.id}),x(!0)},className:"text-slate-500 hover:text-primary",title:"Add Timeline here",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})})]}),v&&N.universoId===Ce.id&&p.jsxs("div",{className:"ml-2 mb-2 p-2 bg-black/20 rounded-lg animate-in fade-in",children:[p.jsx("input",{className:"w-full bg-transparent border-b border-white/20 text-xs p-1 outline-none focus:border-primary mb-1",placeholder:"Timeline Name",value:N.nombre,onChange:ze=>k({...N,nombre:ze.target.value}),autoFocus:!0,onKeyDown:ze=>ze.key==="Enter"&&oe()}),p.jsxs("div",{className:"flex justify-end gap-1",children:[p.jsx("button",{onClick:()=>x(!1),className:"text-[10px] text-slate-500 hover:text-white",children:"CANCEL"}),p.jsx("button",{onClick:oe,className:"text-[10px] font-bold text-primary",children:"CREATE"})]})]}),p.jsxs("div",{className:"space-y-1 pl-2 border-l border-white/5 ml-1",children:[Ce.lineasTemporales&&Ce.lineasTemporales.map(ze=>p.jsxs("div",{onClick:()=>{s(ze.id),B("eventos"),t("CUSTOM"),e(!0)},className:`group flex items-center justify-between p-2 rounded-lg cursor-pointer transition-all ${a===ze.id?"bg-primary/10 text-white shadow-[0_0_10px_rgba(var(--primary-rgb),0.1)]":"text-slate-400 hover:bg-white/5"}`,children:[p.jsx("span",{className:"text-xs truncate",children:ze.nombre}),p.jsx("button",{onClick:Ke=>Ve(ze.id,Ke),className:"opacity-0 group-hover:opacity-100 text-slate-500 hover:text-red-500 transition-opacity",children:p.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"delete"})})]},ze.id)),(!Ce.lineasTemporales||Ce.lineasTemporales.length===0)&&p.jsx("div",{className:"p-2 text-[10px] italic text-slate-600",children:"No timelines here"})]})]},Ce.id))})]}),p.jsxs("main",{className:"flex-1 relative flex flex-col h-full overflow-hidden bg-background-dark",children:[p.jsx("div",{className:"h-16 border-b border-white/5 bg-background-dark/80 backdrop-blur flex items-center px-8 z-10 shrink-0",children:p.jsx("div",{children:(()=>{const ze=re.flatMap(Ke=>Ke.lineasTemporales||[]).find(Ke=>Ke.id===a);return p.jsxs(p.Fragment,{children:[p.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[ze?.esRaiz&&p.jsx("span",{className:"text-amber-400 material-symbols-outlined",children:"star"}),ze?.nombre||"Select Timeline"]}),p.jsx("p",{className:"text-xs text-slate-500",children:ze?.descripcion})]})})()})}),p.jsx("div",{className:"flex-1 overflow-y-auto p-8 relative custom-scrollbar z-10",children:p.jsxs("div",{className:"max-w-2xl mx-auto relative pl-8 border-l-2 border-white/10 space-y-8 pb-32",children:[o.length===0&&p.jsx("div",{className:"text-center text-slate-600 italic py-20",children:"No events yet. Use the right panel to add one."}),o.map((Ce,ze)=>p.jsxs("div",{className:"relative group animate-in fade-in slide-in-from-bottom-4",style:{animationDelay:`${ze*50}ms`},children:[p.jsx("div",{className:"absolute top-6 -left-[41px] size-4 rounded-full bg-white/20 border-4 border-background-dark group-hover:bg-primary transition-colors cursor-pointer",onClick:()=>pe(Ce)}),p.jsxs("div",{className:"ml-4 bg-surface-dark/50 border border-white/5 p-5 rounded-2xl hover:border-primary/30 transition-all hover:bg-surface-dark group-hover:translate-x-1 duration-300 relative group/card",children:[p.jsxs("div",{className:"absolute top-3 right-3 opacity-0 group-hover/card:opacity-100 transition-opacity flex gap-1 bg-black/50 rounded-lg backdrop-blur-sm border border-white/5 p-1",children:[p.jsx("button",{onClick:()=>pe(Ce),className:"p-1.5 text-slate-400 hover:text-white hover:bg-white/10 rounded transition-colors",title:"Edit",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),p.jsx("button",{onClick:Ke=>Je(Ce.id,Ke),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-500/10 rounded transition-colors",title:"Delete",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),p.jsx("div",{className:"flex justify-between items-start",children:p.jsxs("div",{children:[p.jsxs("div",{className:"flex flex-col mb-1",children:[p.jsx("h3",{className:"text-lg font-bold text-white",children:Ce.nombre}),p.jsx("span",{className:"text-xs font-mono font-bold text-primary opacity-80",children:Ce.fechaTexto})]}),p.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:Ce.descripcion})]})})]})]},Ce.id))]})})]}),p.jsx(nv,{isOpen:qe.open,onClose:()=>Ue({...qe,open:!1}),onConfirm:ft,title:qe.title,message:qe.message,confirmText:"Delete",type:"danger"})]})},iz=({onCancel:t,onCreate:e})=>{const[r,n]=ce.useState(1),[i,a]=ce.useState("regional"),[s,o]=ce.useState("upload"),[l,u]=ce.useState(null),[c,f]=ce.useState(""),g=er.useRef(null),v=S=>{const N=S.target.files?.[0];N&&N.type.startsWith("image/")&&(u(N),o("upload"))},x=()=>{g.current?.click()},_=()=>{e(s,c||"Nuevo Mapa",l)};return p.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-xl animate-in fade-in duration-300",children:p.jsx("div",{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto no-scrollbar relative animate-in zoom-in-95 duration-500",children:p.jsxs(Rr,{className:"p-0 border-white/10 shadow-[0_0_100px_rgba(0,0,0,0.5)] overflow-hidden",children:[p.jsxs("header",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"size-12 rounded-2xl bg-primary/20 text-primary flex items-center justify-center",children:p.jsx("span",{className:"material-symbols-outlined text-2xl",children:"add_location_alt"})}),p.jsxs("div",{children:[p.jsx("h1",{className:"text-2xl font-manrope font-black text-white tracking-tight",children:"Crear Nuevo Mapa / Zona"}),p.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Configura los detalles para tu nueva entrada cartogrfica."})]})]}),p.jsx("button",{onClick:t,className:"text-slate-500 hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),p.jsxs("div",{className:"p-12 space-y-12",children:[p.jsxs("section",{className:"space-y-6",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===1?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"1"}),p.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Identidad y Jerarqua"})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pl-12",children:[p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Nombre del Mapa"}),p.jsx("input",{type:"text",placeholder:"ej. La Costa de Zafiro",value:c,onChange:S=>f(S.target.value),className:"w-full bg-white/5 border border-white/5 rounded-2xl px-4 py-3 text-sm text-white focus:border-primary/50 transition-all outline-none"})]}),p.jsxs("div",{className:"space-y-1.5 row-span-2",children:[p.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Descripcin"}),p.jsx("textarea",{placeholder:"Breve descripcin de la geografa, clima o importancia...",className:"w-full h-[120px] bg-white/5 border border-white/5 rounded-2xl p-4 text-sm text-white focus:border-primary/50 outline-none transition-all resize-none"})]}),p.jsxs("div",{className:"space-y-1.5",children:[p.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Zona Padre (Opcional)"}),p.jsxs("select",{className:"w-full bg-white/5 border border-white/5 rounded-2xl px-4 py-3 text-sm text-white focus:border-primary/50 outline-none appearance-none",children:[p.jsx("option",{children:"Ninguna (Nivel Superior)"}),p.jsx("option",{children:"Reino de Aethelgard"}),p.jsx("option",{children:"Continente de Aurum"})]}),p.jsx("p",{className:"text-[9px] text-slate-500 italic mt-1 ml-1 text-primary/70",children:"Seleccionar un padre convierte esto en sub-zona."})]})]})]}),p.jsx("div",{className:"h-px w-full bg-white/5"}),p.jsxs("section",{className:"space-y-6",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===2?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"2"}),p.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Tipo de Mapa"})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 pl-12",children:[p.jsx(dw,{active:i==="world",onClick:()=>a("world"),icon:"public",label:"Mapa Mundial",desc:"Continentes, ocanos, escala global."}),p.jsx(dw,{active:i==="regional",onClick:()=>a("regional"),icon:"map",label:"Mapa Regional",desc:"Reinos, provincias, biomas."}),p.jsx(dw,{active:i==="local",onClick:()=>a("local"),icon:"location_city",label:"Ciudad / Local",desc:"Ciudades, mazmorras, mapas de batalla."})]})]}),p.jsx("div",{className:"h-px w-full bg-white/5"}),p.jsxs("section",{className:"space-y-6",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===3?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"3"}),p.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Fuente del Lienzo"})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pl-12",children:[p.jsx("input",{ref:g,type:"file",accept:"image/*",onChange:v,className:"hidden"}),p.jsx(PN,{active:s==="upload",onClick:x,icon:"cloud_upload",label:l?l.name:"Cargar Archivo de Imagen",desc:l?"Archivo seleccionado":"Arrastra y suelta o haz clic para buscar",subdesc:"JPG, PNG, WEBP  MAX 25MB"}),p.jsx(PN,{active:s==="blank",onClick:()=>o("blank"),icon:"brush",label:"Lienzo en Blanco",desc:"Crear un nuevo dibujo desde cero",subdesc:"4096 px x 4096 px"})]})]})]}),p.jsxs("footer",{className:"p-8 bg-white/[0.02] border-t border-white/5 flex justify-between items-center",children:[p.jsx("button",{onClick:t,className:"text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"Cancelar"}),p.jsxs("div",{className:"flex items-center gap-6",children:[p.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-600",children:"Cambios guardados localmente"}),p.jsx(rn,{variant:"primary",className:"px-10 py-3 shadow-xl",onClick:_,children:"Crear Mapa"})]})]})]})})})},dw=({active:t,onClick:e,icon:r,label:n,desc:i})=>p.jsxs("div",{onClick:e,className:`p-6 rounded-3xl border transition-all cursor-pointer group ${t?"bg-primary/10 border-primary shadow-lg shadow-primary/10":"bg-white/5 border-white/5 hover:border-white/10"}`,children:[p.jsx("div",{className:`size-10 rounded-xl mb-4 flex items-center justify-center transition-all ${t?"bg-primary text-white":"bg-white/5 text-slate-500 group-hover:text-slate-300"}`,children:p.jsx("span",{className:"material-symbols-outlined",children:r})}),p.jsx("h3",{className:`text-sm font-bold mb-1 transition-colors ${t?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:n}),p.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-medium",children:i})]}),PN=({active:t,onClick:e,icon:r,label:n,desc:i,subdesc:a})=>p.jsxs("div",{onClick:e,className:`p-10 rounded-[2.5rem] border transition-all cursor-pointer group flex flex-col items-center text-center gap-4 ${t?"bg-primary/5 border-primary shadow-lg":"bg-white/[0.02] border-white/5 hover:border-white/10 hover:bg-white/[0.04]"}`,children:[p.jsx("div",{className:`size-16 rounded-[2rem] flex items-center justify-center transition-all ${t?"bg-primary text-white shadow-xl shadow-primary/20":"bg-white/5 text-slate-600 group-hover:text-slate-400"}`,children:p.jsx("span",{className:"material-symbols-outlined text-3xl",children:r})}),p.jsxs("div",{className:"space-y-1",children:[p.jsx("h3",{className:`font-bold transition-colors ${t?"text-white":"text-slate-400"}`,children:n}),p.jsx("p",{className:"text-xs text-slate-500 font-medium",children:i})]}),p.jsx("div",{className:"flex gap-2 mt-2",children:a.split("").map((s,o)=>p.jsx("span",{className:"px-2 py-1 rounded bg-black/20 text-[8px] font-black text-slate-600 tracking-tighter uppercase whitespace-nowrap",children:s.trim()},o))})]});var W0={exports:{}},fm={},hw={},fw={},MN;function lr(){return MN||(MN=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Nk<"u"?Nk:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.16",isBrowser:r(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return t.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var i;return(i=t.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(i){t.glob.Konva=i}};const n=i=>{t.Konva[i.prototype.getClassName()]=i};t._registerNode=n,t.Konva._injectGlobal(t.Konva)})(fw)),fw}var pw={},AN;function Zn(){return AN||(AN=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=lr();class r{constructor(T=[1,0,0,1,0,0]){this.dirty=!1,this.m=T&&T.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(T){T.m[0]=this.m[0],T.m[1]=this.m[1],T.m[2]=this.m[2],T.m[3]=this.m[3],T.m[4]=this.m[4],T.m[5]=this.m[5]}point(T){const R=this.m;return{x:R[0]*T.x+R[2]*T.y+R[4],y:R[1]*T.x+R[3]*T.y+R[5]}}translate(T,R){return this.m[4]+=this.m[0]*T+this.m[2]*R,this.m[5]+=this.m[1]*T+this.m[3]*R,this}scale(T,R){return this.m[0]*=T,this.m[1]*=T,this.m[2]*=R,this.m[3]*=R,this}rotate(T){const R=Math.cos(T),j=Math.sin(T),D=this.m[0]*R+this.m[2]*j,B=this.m[1]*R+this.m[3]*j,I=this.m[0]*-j+this.m[2]*R,V=this.m[1]*-j+this.m[3]*R;return this.m[0]=D,this.m[1]=B,this.m[2]=I,this.m[3]=V,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(T,R){const j=this.m[0]+this.m[2]*R,D=this.m[1]+this.m[3]*R,B=this.m[2]+this.m[0]*T,I=this.m[3]+this.m[1]*T;return this.m[0]=j,this.m[1]=D,this.m[2]=B,this.m[3]=I,this}multiply(T){const R=this.m[0]*T.m[0]+this.m[2]*T.m[1],j=this.m[1]*T.m[0]+this.m[3]*T.m[1],D=this.m[0]*T.m[2]+this.m[2]*T.m[3],B=this.m[1]*T.m[2]+this.m[3]*T.m[3],I=this.m[0]*T.m[4]+this.m[2]*T.m[5]+this.m[4],V=this.m[1]*T.m[4]+this.m[3]*T.m[5]+this.m[5];return this.m[0]=R,this.m[1]=j,this.m[2]=D,this.m[3]=B,this.m[4]=I,this.m[5]=V,this}invert(){const T=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),R=this.m[3]*T,j=-this.m[1]*T,D=-this.m[2]*T,B=this.m[0]*T,I=T*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),V=T*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=R,this.m[1]=j,this.m[2]=D,this.m[3]=B,this.m[4]=I,this.m[5]=V,this}getMatrix(){return this.m}decompose(){const T=this.m[0],R=this.m[1],j=this.m[2],D=this.m[3],B=this.m[4],I=this.m[5],V=T*D-R*j,$={x:B,y:I,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(T!=0||R!=0){const Z=Math.sqrt(T*T+R*R);$.rotation=R>0?Math.acos(T/Z):-Math.acos(T/Z),$.scaleX=Z,$.scaleY=V/Z,$.skewX=(T*j+R*D)/V,$.skewY=0}else if(j!=0||D!=0){const Z=Math.sqrt(j*j+D*D);$.rotation=Math.PI/2-(D>0?Math.acos(-j/Z):-Math.acos(j/Z)),$.scaleX=V/Z,$.scaleY=Z,$.skewX=0,$.skewY=(T*j+R*D)/V}return $.rotation=t.Util._getRotation($.rotation),$}}t.Transform=r;let n="[object Array]",i="[object Number]",a="[object String]",s="[object Boolean]",o=Math.PI/180,l=180/Math.PI,u="#",c="",f="0",g="Konva warning: ",v="Konva error: ",x="rgb(",_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},S=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,N=[];const k=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(E){setTimeout(E,60)};t.Util={_isElement(E){return!!(E&&E.nodeType==1)},_isFunction(E){return!!(E&&E.constructor&&E.call&&E.apply)},_isPlainObject(E){return!!E&&E.constructor===Object},_isArray(E){return Object.prototype.toString.call(E)===n},_isNumber(E){return Object.prototype.toString.call(E)===i&&!isNaN(E)&&isFinite(E)},_isString(E){return Object.prototype.toString.call(E)===a},_isBoolean(E){return Object.prototype.toString.call(E)===s},isObject(E){return E instanceof Object},isValidSelector(E){if(typeof E!="string")return!1;const T=E[0];return T==="#"||T==="."||T===T.toUpperCase()},_sign(E){return E===0||E>0?1:-1},requestAnimFrame(E){N.push(E),N.length===1&&k(function(){const T=N;N=[],T.forEach(function(R){R()})})},createCanvasElement(){const E=document.createElement("canvas");try{E.style=E.style||{}}catch{}return E},createImageElement(){return document.createElement("img")},_isInDocument(E){for(;E=E.parentNode;)if(E==document)return!0;return!1},_urlToImage(E,T){const R=t.Util.createImageElement();R.onload=function(){T(R)},R.src=E},_rgbToHex(E,T,R){return((1<<24)+(E<<16)+(T<<8)+R).toString(16).slice(1)},_hexToRgb(E){E=E.replace(u,c);const T=parseInt(E,16);return{r:T>>16&255,g:T>>8&255,b:T&255}},getRandomColor(){let E=(Math.random()*16777215<<0).toString(16);for(;E.length<6;)E=f+E;return u+E},getRGB(E){let T;return E in _?(T=_[E],{r:T[0],g:T[1],b:T[2]}):E[0]===u?this._hexToRgb(E.substring(1)):E.substr(0,4)===x?(T=S.exec(E.replace(/ /g,"")),{r:parseInt(T[1],10),g:parseInt(T[2],10),b:parseInt(T[3],10)}):{r:0,g:0,b:0}},colorToRGBA(E){return E=E||"black",t.Util._namedColorToRBA(E)||t.Util._hex3ColorToRGBA(E)||t.Util._hex4ColorToRGBA(E)||t.Util._hex6ColorToRGBA(E)||t.Util._hex8ColorToRGBA(E)||t.Util._rgbColorToRGBA(E)||t.Util._rgbaColorToRGBA(E)||t.Util._hslColorToRGBA(E)},_namedColorToRBA(E){const T=_[E.toLowerCase()];return T?{r:T[0],g:T[1],b:T[2],a:1}:null},_rgbColorToRGBA(E){if(E.indexOf("rgb(")===0){E=E.match(/rgb\(([^)]+)\)/)[1];const T=E.split(/ *, */).map(Number);return{r:T[0],g:T[1],b:T[2],a:1}}},_rgbaColorToRGBA(E){if(E.indexOf("rgba(")===0){E=E.match(/rgba\(([^)]+)\)/)[1];const T=E.split(/ *, */).map((R,j)=>R.slice(-1)==="%"?j===3?parseInt(R)/100:parseInt(R)/100*255:Number(R));return{r:T[0],g:T[1],b:T[2],a:T[3]}}},_hex8ColorToRGBA(E){if(E[0]==="#"&&E.length===9)return{r:parseInt(E.slice(1,3),16),g:parseInt(E.slice(3,5),16),b:parseInt(E.slice(5,7),16),a:parseInt(E.slice(7,9),16)/255}},_hex6ColorToRGBA(E){if(E[0]==="#"&&E.length===7)return{r:parseInt(E.slice(1,3),16),g:parseInt(E.slice(3,5),16),b:parseInt(E.slice(5,7),16),a:1}},_hex4ColorToRGBA(E){if(E[0]==="#"&&E.length===5)return{r:parseInt(E[1]+E[1],16),g:parseInt(E[2]+E[2],16),b:parseInt(E[3]+E[3],16),a:parseInt(E[4]+E[4],16)/255}},_hex3ColorToRGBA(E){if(E[0]==="#"&&E.length===4)return{r:parseInt(E[1]+E[1],16),g:parseInt(E[2]+E[2],16),b:parseInt(E[3]+E[3],16),a:1}},_hslColorToRGBA(E){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(E)){const[T,...R]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(E),j=Number(R[0])/360,D=Number(R[1])/100,B=Number(R[2])/100;let I,V,$;if(D===0)return $=B*255,{r:Math.round($),g:Math.round($),b:Math.round($),a:1};B<.5?I=B*(1+D):I=B+D-B*D;const Z=2*B-I,O=[0,0,0];for(let W=0;W<3;W++)V=j+1/3*-(W-1),V<0&&V++,V>1&&V--,6*V<1?$=Z+(I-Z)*6*V:2*V<1?$=I:3*V<2?$=Z+(I-Z)*(2/3-V)*6:$=Z,O[W]=$*255;return{r:Math.round(O[0]),g:Math.round(O[1]),b:Math.round(O[2]),a:1}}},haveIntersection(E,T){return!(T.x>E.x+E.width||T.x+T.width<E.x||T.y>E.y+E.height||T.y+T.height<E.y)},cloneObject(E){const T={};for(const R in E)this._isPlainObject(E[R])?T[R]=this.cloneObject(E[R]):this._isArray(E[R])?T[R]=this.cloneArray(E[R]):T[R]=E[R];return T},cloneArray(E){return E.slice(0)},degToRad(E){return E*o},radToDeg(E){return E*l},_degToRad(E){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(E)},_radToDeg(E){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(E)},_getRotation(E){return e.Konva.angleDeg?t.Util.radToDeg(E):E},_capitalize(E){return E.charAt(0).toUpperCase()+E.slice(1)},throw(E){throw new Error(v+E)},error(E){console.error(v+E)},warn(E){e.Konva.showWarnings&&console.warn(g+E)},each(E,T){for(const R in E)T(R,E[R])},_inRange(E,T,R){return T<=E&&E<R},_getProjectionToSegment(E,T,R,j,D,B){let I,V,$;const Z=(E-R)*(E-R)+(T-j)*(T-j);if(Z==0)I=E,V=T,$=(D-R)*(D-R)+(B-j)*(B-j);else{const O=((D-E)*(R-E)+(B-T)*(j-T))/Z;O<0?(I=E,V=T,$=(E-D)*(E-D)+(T-B)*(T-B)):O>1?(I=R,V=j,$=(R-D)*(R-D)+(j-B)*(j-B)):(I=E+O*(R-E),V=T+O*(j-T),$=(I-D)*(I-D)+(V-B)*(V-B))}return[I,V,$]},_getProjectionToLine(E,T,R){const j=t.Util.cloneObject(E);let D=Number.MAX_VALUE;return T.forEach(function(B,I){if(!R&&I===T.length-1)return;const V=T[(I+1)%T.length],$=t.Util._getProjectionToSegment(B.x,B.y,V.x,V.y,E.x,E.y),Z=$[0],O=$[1],W=$[2];W<D&&(j.x=Z,j.y=O,D=W)}),j},_prepareArrayForTween(E,T,R){let j,D=[],B=[];if(E.length>T.length){const V=T;T=E,E=V}for(j=0;j<E.length;j+=2)D.push({x:E[j],y:E[j+1]});for(j=0;j<T.length;j+=2)B.push({x:T[j],y:T[j+1]});const I=[];return B.forEach(function(V){const $=t.Util._getProjectionToLine(V,D,R);I.push($.x),I.push($.y)}),I},_prepareToStringify(E){let T;E.visitedByCircularReferenceRemoval=!0;for(const R in E)if(E.hasOwnProperty(R)&&E[R]&&typeof E[R]=="object"){if(T=Object.getOwnPropertyDescriptor(E,R),E[R].visitedByCircularReferenceRemoval||t.Util._isElement(E[R]))if(T.configurable)delete E[R];else return null;else if(t.Util._prepareToStringify(E[R])===null)if(T.configurable)delete E[R];else return null}return delete E.visitedByCircularReferenceRemoval,E},_assign(E,T){for(const R in T)E[R]=T[R];return E},_getFirstPointerId(E){return E.touches?E.changedTouches[0].identifier:E.pointerId||999},releaseCanvas(...E){e.Konva.releaseCanvasOnDestroy&&E.forEach(T=>{T.width=0,T.height=0})},drawRoundedRectPath(E,T,R,j){let D=0,B=0,I=0,V=0;typeof j=="number"?D=B=I=V=Math.min(j,T/2,R/2):(D=Math.min(j[0]||0,T/2,R/2),B=Math.min(j[1]||0,T/2,R/2),V=Math.min(j[2]||0,T/2,R/2),I=Math.min(j[3]||0,T/2,R/2)),E.moveTo(D,0),E.lineTo(T-B,0),E.arc(T-B,B,B,Math.PI*3/2,0,!1),E.lineTo(T,R-V),E.arc(T-V,R-V,V,0,Math.PI/2,!1),E.lineTo(I,R),E.arc(I,R-I,I,Math.PI/2,Math.PI,!1),E.lineTo(0,D),E.arc(D,D,D,Math.PI,Math.PI*3/2,!1)}}})(pw)),pw}var pm={},mw={},Es={},jN;function mr(){if(jN)return Es;jN=1,Object.defineProperty(Es,"__esModule",{value:!0}),Es.RGBComponent=n,Es.alphaComponent=i,Es.getNumberValidator=a,Es.getNumberOrArrayOfNumbersValidator=s,Es.getNumberOrAutoValidator=o,Es.getStringValidator=l,Es.getStringOrGradientValidator=u,Es.getFunctionValidator=c,Es.getNumberArrayValidator=f,Es.getBooleanValidator=g,Es.getComponentValidator=v;const t=lr(),e=Zn();function r(x){return e.Util._isString(x)?'"'+x+'"':Object.prototype.toString.call(x)==="[object Number]"||e.Util._isBoolean(x)?x:Object.prototype.toString.call(x)}function n(x){return x>255?255:x<0?0:Math.round(x)}function i(x){return x>1?1:x<1e-4?1e-4:x}function a(){if(t.Konva.isUnminified)return function(x,_){return e.Util._isNumber(x)||e.Util.warn(r(x)+' is a not valid value for "'+_+'" attribute. The value should be a number.'),x}}function s(x){if(t.Konva.isUnminified)return function(_,S){const N=e.Util._isNumber(_),k=e.Util._isArray(_)&&_.length==x;return!N&&!k&&e.Util.warn(r(_)+' is a not valid value for "'+S+'" attribute. The value should be a number or Array<number>('+x+")"),_}}function o(){if(t.Konva.isUnminified)return function(x,_){return e.Util._isNumber(x)||x==="auto"||e.Util.warn(r(x)+' is a not valid value for "'+_+'" attribute. The value should be a number or "auto".'),x}}function l(){if(t.Konva.isUnminified)return function(x,_){return e.Util._isString(x)||e.Util.warn(r(x)+' is a not valid value for "'+_+'" attribute. The value should be a string.'),x}}function u(){if(t.Konva.isUnminified)return function(x,_){const S=e.Util._isString(x),N=Object.prototype.toString.call(x)==="[object CanvasGradient]"||x&&x.addColorStop;return S||N||e.Util.warn(r(x)+' is a not valid value for "'+_+'" attribute. The value should be a string or a native gradient.'),x}}function c(){if(t.Konva.isUnminified)return function(x,_){return e.Util._isFunction(x)||e.Util.warn(r(x)+' is a not valid value for "'+_+'" attribute. The value should be a function.'),x}}function f(){if(t.Konva.isUnminified)return function(x,_){const S=Int8Array?Object.getPrototypeOf(Int8Array):null;return S&&x instanceof S||(e.Util._isArray(x)?x.forEach(function(N){e.Util._isNumber(N)||e.Util.warn('"'+_+'" attribute has non numeric element '+N+". Make sure that all elements are numbers.")}):e.Util.warn(r(x)+' is a not valid value for "'+_+'" attribute. The value should be a array of numbers.')),x}}function g(){if(t.Konva.isUnminified)return function(x,_){return x===!0||x===!1||e.Util.warn(r(x)+' is a not valid value for "'+_+'" attribute. The value should be a boolean.'),x}}function v(x){if(t.Konva.isUnminified)return function(_,S){return _==null||e.Util.isObject(_)||e.Util.warn(r(_)+' is a not valid value for "'+S+'" attribute. The value should be an object with properties '+x),_}}return Es}var RN;function hr(){return RN||(RN=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Zn(),r=mr(),n="get",i="set";t.Factory={addGetterSetter(a,s,o,l,u){t.Factory.addGetter(a,s,o),t.Factory.addSetter(a,s,l,u),t.Factory.addOverloadedGetterSetter(a,s)},addGetter(a,s,o){const l=n+e.Util._capitalize(s);a.prototype[l]=a.prototype[l]||function(){const u=this.attrs[s];return u===void 0?o:u}},addSetter(a,s,o,l){const u=i+e.Util._capitalize(s);a.prototype[u]||t.Factory.overWriteSetter(a,s,o,l)},overWriteSetter(a,s,o,l){const u=i+e.Util._capitalize(s);a.prototype[u]=function(c){return o&&c!==void 0&&c!==null&&(c=o.call(this,c,s)),this._setAttr(s,c),l&&l.call(this),this}},addComponentsGetterSetter(a,s,o,l,u){let c=o.length,f=e.Util._capitalize,g=n+f(s),v=i+f(s),x,_;a.prototype[g]=function(){const N={};for(x=0;x<c;x++)_=o[x],N[_]=this.getAttr(s+f(_));return N};const S=(0,r.getComponentValidator)(o);a.prototype[v]=function(N){let k=this.attrs[s],E;l&&(N=l.call(this,N)),S&&S.call(this,N,s);for(E in N)N.hasOwnProperty(E)&&this._setAttr(s+f(E),N[E]);return N||o.forEach(T=>{this._setAttr(s+f(T),void 0)}),this._fireChangeEvent(s,k,N),u&&u.call(this),this},t.Factory.addOverloadedGetterSetter(a,s)},addOverloadedGetterSetter(a,s){const o=e.Util._capitalize(s),l=i+o,u=n+o;a.prototype[s]=function(){return arguments.length?(this[l](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,s,o,l){e.Util.error("Adding deprecated "+s);const u=n+e.Util._capitalize(s),c=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){e.Util.error(c);const f=this.attrs[s];return f===void 0?o:f},t.Factory.addSetter(a,s,l,function(){e.Util.error(c)}),t.Factory.addOverloadedGetterSetter(a,s)},backCompat(a,s){e.Util.each(s,function(o,l){const u=a.prototype[l],c=n+e.Util._capitalize(o),f=i+e.Util._capitalize(o);function g(){u.apply(this,arguments),e.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}a.prototype[o]=g,a.prototype[c]=g,a.prototype[f]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(mw)),mw}var Ru={},Lu={},LN;function dM(){if(LN)return Lu;LN=1,Object.defineProperty(Lu,"__esModule",{value:!0}),Lu.HitContext=Lu.SceneContext=Lu.Context=void 0;const t=Zn(),e=lr();function r(N){let k=[],E=N.length,T=t.Util,R,j;for(R=0;R<E;R++)j=N[R],T._isNumber(j)?j=Math.round(j*1e3)/1e3:T._isString(j)||(j=j+""),k.push(j);return k}const n=",",i="(",a=")",s="([",o="])",l=";",u="()",c="=",f=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],v=100;let x=class{constructor(k){this.canvas=k,e.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(k){k.fillEnabled()&&this._fill(k)}_fill(k){}strokeShape(k){k.hasStroke()&&this._stroke(k)}_stroke(k){}fillStrokeShape(k){k.attrs.fillAfterStrokeEnabled?(this.strokeShape(k),this.fillShape(k)):(this.fillShape(k),this.strokeShape(k))}getTrace(k,E){let T=this.traceArr,R=T.length,j="",D,B,I,V;for(D=0;D<R;D++)B=T[D],I=B.method,I?(V=B.args,j+=I,k?j+=u:t.Util._isArray(V[0])?j+=s+V.join(n)+o:(E&&(V=V.map($=>typeof $=="number"?Math.floor($):$)),j+=i+V.join(n)+a)):(j+=B.property,k||(j+=c+B.val)),j+=l;return j}clearTrace(){this.traceArr=[]}_trace(k){let E=this.traceArr,T;E.push(k),T=E.length,T>=v&&E.shift()}reset(){const k=this.getCanvas().getPixelRatio();this.setTransform(1*k,0,0,1*k,0,0)}getCanvas(){return this.canvas}clear(k){const E=this.getCanvas();k?this.clearRect(k.x||0,k.y||0,k.width||0,k.height||0):this.clearRect(0,0,E.getWidth()/E.pixelRatio,E.getHeight()/E.pixelRatio)}_applyLineCap(k){const E=k.attrs.lineCap;E&&this.setAttr("lineCap",E)}_applyOpacity(k){const E=k.getAbsoluteOpacity();E!==1&&this.setAttr("globalAlpha",E)}_applyLineJoin(k){const E=k.attrs.lineJoin;E&&this.setAttr("lineJoin",E)}setAttr(k,E){this._context[k]=E}arc(k,E,T,R,j,D){this._context.arc(k,E,T,R,j,D)}arcTo(k,E,T,R,j){this._context.arcTo(k,E,T,R,j)}beginPath(){this._context.beginPath()}bezierCurveTo(k,E,T,R,j,D){this._context.bezierCurveTo(k,E,T,R,j,D)}clearRect(k,E,T,R){this._context.clearRect(k,E,T,R)}clip(...k){this._context.clip.apply(this._context,k)}closePath(){this._context.closePath()}createImageData(k,E){const T=arguments;if(T.length===2)return this._context.createImageData(k,E);if(T.length===1)return this._context.createImageData(k)}createLinearGradient(k,E,T,R){return this._context.createLinearGradient(k,E,T,R)}createPattern(k,E){return this._context.createPattern(k,E)}createRadialGradient(k,E,T,R,j,D){return this._context.createRadialGradient(k,E,T,R,j,D)}drawImage(k,E,T,R,j,D,B,I,V){const $=arguments,Z=this._context;$.length===3?Z.drawImage(k,E,T):$.length===5?Z.drawImage(k,E,T,R,j):$.length===9&&Z.drawImage(k,E,T,R,j,D,B,I,V)}ellipse(k,E,T,R,j,D,B,I){this._context.ellipse(k,E,T,R,j,D,B,I)}isPointInPath(k,E,T,R){return T?this._context.isPointInPath(T,k,E,R):this._context.isPointInPath(k,E,R)}fill(...k){this._context.fill.apply(this._context,k)}fillRect(k,E,T,R){this._context.fillRect(k,E,T,R)}strokeRect(k,E,T,R){this._context.strokeRect(k,E,T,R)}fillText(k,E,T,R){R?this._context.fillText(k,E,T,R):this._context.fillText(k,E,T)}measureText(k){return this._context.measureText(k)}getImageData(k,E,T,R){return this._context.getImageData(k,E,T,R)}lineTo(k,E){this._context.lineTo(k,E)}moveTo(k,E){this._context.moveTo(k,E)}rect(k,E,T,R){this._context.rect(k,E,T,R)}roundRect(k,E,T,R,j){this._context.roundRect(k,E,T,R,j)}putImageData(k,E,T){this._context.putImageData(k,E,T)}quadraticCurveTo(k,E,T,R){this._context.quadraticCurveTo(k,E,T,R)}restore(){this._context.restore()}rotate(k){this._context.rotate(k)}save(){this._context.save()}scale(k,E){this._context.scale(k,E)}setLineDash(k){this._context.setLineDash?this._context.setLineDash(k):"mozDash"in this._context?this._context.mozDash=k:"webkitLineDash"in this._context&&(this._context.webkitLineDash=k)}getLineDash(){return this._context.getLineDash()}setTransform(k,E,T,R,j,D){this._context.setTransform(k,E,T,R,j,D)}stroke(k){k?this._context.stroke(k):this._context.stroke()}strokeText(k,E,T,R){this._context.strokeText(k,E,T,R)}transform(k,E,T,R,j,D){this._context.transform(k,E,T,R,j,D)}translate(k,E){this._context.translate(k,E)}_enableTrace(){let k=this,E=f.length,T=this.setAttr,R,j;const D=function(B){let I=k[B],V;k[B]=function(){return j=r(Array.prototype.slice.call(arguments,0)),V=I.apply(k,arguments),k._trace({method:B,args:j}),V}};for(R=0;R<E;R++)D(f[R]);k.setAttr=function(){T.apply(k,arguments);const B=arguments[0];let I=arguments[1];(B==="shadowOffsetX"||B==="shadowOffsetY"||B==="shadowBlur")&&(I=I/this.canvas.getPixelRatio()),k._trace({property:B,val:I})}}_applyGlobalCompositeOperation(k){const E=k.attrs.globalCompositeOperation;!E||E==="source-over"||this.setAttr("globalCompositeOperation",E)}};Lu.Context=x,g.forEach(function(N){Object.defineProperty(x.prototype,N,{get(){return this._context[N]},set(k){this._context[N]=k}})});class _ extends x{constructor(k,{willReadFrequently:E=!1}={}){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:E})}_fillColor(k){const E=k.fill();this.setAttr("fillStyle",E),k._fillFunc(this)}_fillPattern(k){this.setAttr("fillStyle",k._getFillPattern()),k._fillFunc(this)}_fillLinearGradient(k){const E=k._getLinearGradient();E&&(this.setAttr("fillStyle",E),k._fillFunc(this))}_fillRadialGradient(k){const E=k._getRadialGradient();E&&(this.setAttr("fillStyle",E),k._fillFunc(this))}_fill(k){const E=k.fill(),T=k.getFillPriority();if(E&&T==="color"){this._fillColor(k);return}const R=k.getFillPatternImage();if(R&&T==="pattern"){this._fillPattern(k);return}const j=k.getFillLinearGradientColorStops();if(j&&T==="linear-gradient"){this._fillLinearGradient(k);return}const D=k.getFillRadialGradientColorStops();if(D&&T==="radial-gradient"){this._fillRadialGradient(k);return}E?this._fillColor(k):R?this._fillPattern(k):j?this._fillLinearGradient(k):D&&this._fillRadialGradient(k)}_strokeLinearGradient(k){const E=k.getStrokeLinearGradientStartPoint(),T=k.getStrokeLinearGradientEndPoint(),R=k.getStrokeLinearGradientColorStops(),j=this.createLinearGradient(E.x,E.y,T.x,T.y);if(R){for(let D=0;D<R.length;D+=2)j.addColorStop(R[D],R[D+1]);this.setAttr("strokeStyle",j)}}_stroke(k){const E=k.dash(),T=k.getStrokeScaleEnabled();if(k.hasStroke()){if(!T){this.save();const j=this.getCanvas().getPixelRatio();this.setTransform(j,0,0,j,0,0)}this._applyLineCap(k),E&&k.dashEnabled()&&(this.setLineDash(E),this.setAttr("lineDashOffset",k.dashOffset())),this.setAttr("lineWidth",k.strokeWidth()),k.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),k.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(k):this.setAttr("strokeStyle",k.stroke()),k._strokeFunc(this),T||this.restore()}}_applyShadow(k){var E,T,R;const j=(E=k.getShadowRGBA())!==null&&E!==void 0?E:"black",D=(T=k.getShadowBlur())!==null&&T!==void 0?T:5,B=(R=k.getShadowOffset())!==null&&R!==void 0?R:{x:0,y:0},I=k.getAbsoluteScale(),V=this.canvas.getPixelRatio(),$=I.x*V,Z=I.y*V;this.setAttr("shadowColor",j),this.setAttr("shadowBlur",D*Math.min(Math.abs($),Math.abs(Z))),this.setAttr("shadowOffsetX",B.x*$),this.setAttr("shadowOffsetY",B.y*Z)}}Lu.SceneContext=_;class S extends x{constructor(k){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:!0})}_fill(k){this.save(),this.setAttr("fillStyle",k.colorKey),k._fillFuncHit(this),this.restore()}strokeShape(k){k.hasHitStroke()&&this._stroke(k)}_stroke(k){if(k.hasHitStroke()){const E=k.getStrokeScaleEnabled();if(!E){this.save();const j=this.getCanvas().getPixelRatio();this.setTransform(j,0,0,j,0,0)}this._applyLineCap(k);const T=k.hitStrokeWidth(),R=T==="auto"?k.strokeWidth():T;this.setAttr("lineWidth",R),this.setAttr("strokeStyle",k.colorKey),k._strokeFuncHit(this),E||this.restore()}}}return Lu.HitContext=S,Lu}var ON;function Px(){if(ON)return Ru;ON=1,Object.defineProperty(Ru,"__esModule",{value:!0}),Ru.HitCanvas=Ru.SceneCanvas=Ru.Canvas=void 0;const t=Zn(),e=dM(),r=lr(),n=hr(),i=mr();let a;function s(){if(a)return a;const c=t.Util.createCanvasElement(),f=c.getContext("2d");return a=(function(){const g=r.Konva._global.devicePixelRatio||1,v=f.webkitBackingStorePixelRatio||f.mozBackingStorePixelRatio||f.msBackingStorePixelRatio||f.oBackingStorePixelRatio||f.backingStorePixelRatio||1;return g/v})(),t.Util.releaseCanvas(c),a}let o=class{constructor(f){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const v=(f||{}).pixelRatio||r.Konva.pixelRatio||s();this.pixelRatio=v,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(f){const g=this.pixelRatio;this.pixelRatio=f,this.setSize(this.getWidth()/g,this.getHeight()/g)}setWidth(f){this.width=this._canvas.width=f*this.pixelRatio,this._canvas.style.width=f+"px";const g=this.pixelRatio;this.getContext()._context.scale(g,g)}setHeight(f){this.height=this._canvas.height=f*this.pixelRatio,this._canvas.style.height=f+"px";const g=this.pixelRatio;this.getContext()._context.scale(g,g)}getWidth(){return this.width}getHeight(){return this.height}setSize(f,g){this.setWidth(f||0),this.setHeight(g||0)}toDataURL(f,g){try{return this._canvas.toDataURL(f,g)}catch{try{return this._canvas.toDataURL()}catch(x){return t.Util.error("Unable to get data URL. "+x.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Ru.Canvas=o,n.Factory.addGetterSetter(o,"pixelRatio",void 0,(0,i.getNumberValidator)());class l extends o{constructor(f={width:0,height:0,willReadFrequently:!1}){super(f),this.context=new e.SceneContext(this,{willReadFrequently:f.willReadFrequently}),this.setSize(f.width,f.height)}}Ru.SceneCanvas=l;class u extends o{constructor(f={width:0,height:0}){super(f),this.hitCanvas=!0,this.context=new e.HitContext(this),this.setSize(f.width,f.height)}}return Ru.HitCanvas=u,Ru}var gw={},DN;function Y_(){return DN||(DN=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=lr(),r=Zn();t.DD={get isDragging(){let n=!1;return t.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return t.DD._dragElements.forEach(i=>{n=i.node}),n},_dragElements:new Map,_drag(n){const i=[];t.DD._dragElements.forEach((a,s)=>{const{node:o}=a,l=o.getStage();l.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=l._changedPointerPositions.find(c=>c.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const c=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<c||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),i.push(o)}}),i.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const i=[];t.DD._dragElements.forEach(a=>{const{node:s}=a,o=s.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(c=>c.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof e.Konva.Stage&&a.node;u&&i.indexOf(u)===-1&&i.push(u)}),i.forEach(a=>{a.draw()})},_endDragAfter(n){t.DD._dragElements.forEach((i,a)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:n},!0),i.dragStatus!=="dragging"&&t.DD._dragElements.delete(a)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(gw)),gw}var IN;function si(){if(IN)return pm;IN=1,Object.defineProperty(pm,"__esModule",{value:!0}),pm.Node=void 0;const t=Zn(),e=hr(),r=Px(),n=lr(),i=Y_(),a=mr(),s="absoluteOpacity",o="allEventListeners",l="absoluteTransform",u="absoluteScale",c="canvas",f="Change",g="children",v="konva",x="listening",_="mouseenter",S="mouseleave",N="set",k="Shape",E=" ",T="stage",R="transform",j="Stage",D="visible",B=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(E);let I=1;class V{constructor(O){this._id=I++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(O),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(O){(O===R||O===l)&&this._cache.get(O)?this._cache.get(O).dirty=!0:O?this._cache.delete(O):this._cache.clear()}_getCache(O,W){let F=this._cache.get(O);return(F===void 0||(O===R||O===l)&&F.dirty===!0)&&(F=W.call(this),this._cache.set(O,F)),F}_calculate(O,W,F){if(!this._attachedDepsListeners.get(O)){const K=W.map(X=>X+"Change.konva").join(E);this.on(K,()=>{this._clearCache(O)}),this._attachedDepsListeners.set(O,!0)}return this._getCache(O,F)}_getCanvasCache(){return this._cache.get(c)}_clearSelfAndDescendantCache(O){this._clearCache(O),O===l&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(c)){const{scene:O,filter:W,hit:F}=this._cache.get(c);t.Util.releaseCanvas(O,W,F),this._cache.delete(c)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(O){const W=O||{};let F={};(W.x===void 0||W.y===void 0||W.width===void 0||W.height===void 0)&&(F=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let K=Math.ceil(W.width||F.width),X=Math.ceil(W.height||F.height),Q=W.pixelRatio,ae=W.x===void 0?Math.floor(F.x):W.x,re=W.y===void 0?Math.floor(F.y):W.y,G=W.offset||0,te=W.drawBorder||!1,ne=W.hitCanvasPixelRatio||1;if(!K||!X){t.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const de=Math.abs(Math.round(F.x)-ae)>.5?1:0,me=Math.abs(Math.round(F.y)-re)>.5?1:0;K+=G*2+de,X+=G*2+me,ae-=G,re-=G;const ye=new r.SceneCanvas({pixelRatio:Q,width:K,height:X}),ie=new r.SceneCanvas({pixelRatio:Q,width:0,height:0,willReadFrequently:!0}),pe=new r.HitCanvas({pixelRatio:ne,width:K,height:X}),oe=ye.getContext(),fe=pe.getContext();return pe.isCache=!0,ye.isCache=!0,this._cache.delete(c),this._filterUpToDate=!1,W.imageSmoothingEnabled===!1&&(ye.getContext()._context.imageSmoothingEnabled=!1,ie.getContext()._context.imageSmoothingEnabled=!1),oe.save(),fe.save(),oe.translate(-ae,-re),fe.translate(-ae,-re),this._isUnderCache=!0,this._clearSelfAndDescendantCache(s),this._clearSelfAndDescendantCache(u),this.drawScene(ye,this),this.drawHit(pe,this),this._isUnderCache=!1,oe.restore(),fe.restore(),te&&(oe.save(),oe.beginPath(),oe.rect(0,0,K,X),oe.closePath(),oe.setAttr("strokeStyle","red"),oe.setAttr("lineWidth",5),oe.stroke(),oe.restore()),this._cache.set(c,{scene:ye,filter:ie,hit:pe,x:ae,y:re}),this._requestDraw(),this}isCached(){return this._cache.has(c)}getClientRect(O){throw new Error('abstract "getClientRect" method call')}_transformedRect(O,W){const F=[{x:O.x,y:O.y},{x:O.x+O.width,y:O.y},{x:O.x+O.width,y:O.y+O.height},{x:O.x,y:O.y+O.height}];let K=1/0,X=1/0,Q=-1/0,ae=-1/0;const re=this.getAbsoluteTransform(W);return F.forEach(function(G){const te=re.point(G);K===void 0&&(K=Q=te.x,X=ae=te.y),K=Math.min(K,te.x),X=Math.min(X,te.y),Q=Math.max(Q,te.x),ae=Math.max(ae,te.y)}),{x:K,y:X,width:Q-K,height:ae-X}}_drawCachedSceneCanvas(O){O.save(),O._applyOpacity(this),O._applyGlobalCompositeOperation(this);const W=this._getCanvasCache();O.translate(W.x,W.y);const F=this._getCachedSceneCanvas(),K=F.pixelRatio;O.drawImage(F._canvas,0,0,F.width/K,F.height/K),O.restore()}_drawCachedHitCanvas(O){const W=this._getCanvasCache(),F=W.hit;O.save(),O.translate(W.x,W.y),O.drawImage(F._canvas,0,0,F.width/F.pixelRatio,F.height/F.pixelRatio),O.restore()}_getCachedSceneCanvas(){let O=this.filters(),W=this._getCanvasCache(),F=W.scene,K=W.filter,X=K.getContext(),Q,ae,re,G;if(O){if(!this._filterUpToDate){const te=F.pixelRatio;K.setSize(F.width/F.pixelRatio,F.height/F.pixelRatio);try{for(Q=O.length,X.clear(),X.drawImage(F._canvas,0,0,F.getWidth()/te,F.getHeight()/te),ae=X.getImageData(0,0,K.getWidth(),K.getHeight()),re=0;re<Q;re++){if(G=O[re],typeof G!="function"){t.Util.error("Filter should be type of function, but got "+typeof G+" instead. Please check correct filters");continue}G.call(this,ae),X.putImageData(ae,0,0)}}catch(ne){t.Util.error("Unable to apply filter. "+ne.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return K}return F}on(O,W){if(this._cache&&this._cache.delete(o),arguments.length===3)return this._delegate.apply(this,arguments);let F=O.split(E),K=F.length,X,Q,ae,re,G;for(X=0;X<K;X++)Q=F[X],ae=Q.split("."),re=ae[0],G=ae[1]||"",this.eventListeners[re]||(this.eventListeners[re]=[]),this.eventListeners[re].push({name:G,handler:W});return this}off(O,W){let F=(O||"").split(E),K=F.length,X,Q,ae,re,G,te;if(this._cache&&this._cache.delete(o),!O)for(Q in this.eventListeners)this._off(Q);for(X=0;X<K;X++)if(ae=F[X],re=ae.split("."),G=re[0],te=re[1],G)this.eventListeners[G]&&this._off(G,te,W);else for(Q in this.eventListeners)this._off(Q,te,W);return this}dispatchEvent(O){const W={target:this,type:O.type,evt:O};return this.fire(O.type,W),this}addEventListener(O,W){return this.on(O,function(F){W.call(this,F.evt)}),this}removeEventListener(O){return this.off(O),this}_delegate(O,W,F){const K=this;this.on(O,function(X){const Q=X.target.findAncestors(W,!0,K);for(let ae=0;ae<Q.length;ae++)X=t.Util.cloneObject(X),X.currentTarget=Q[ae],F.call(Q[ae],X)})}remove(){return this.isDragging()&&this.stopDrag(),i.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(s),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(T),this._clearSelfAndDescendantCache(D),this._clearSelfAndDescendantCache(x)}_remove(){this._clearCaches();const O=this.getParent();O&&O.children&&(O.children.splice(this.index,1),O._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(O){const W="get"+t.Util._capitalize(O);return t.Util._isFunction(this[W])?this[W]():this.attrs[O]}getAncestors(){let O=this.getParent(),W=[];for(;O;)W.push(O),O=O.getParent();return W}getAttrs(){return this.attrs||{}}setAttrs(O){return this._batchTransformChanges(()=>{let W,F;if(!O)return this;for(W in O)W!==g&&(F=N+t.Util._capitalize(W),t.Util._isFunction(this[F])?this[F](O[W]):this._setAttr(W,O[W]))}),this}isListening(){return this._getCache(x,this._isListening)}_isListening(O){if(!this.listening())return!1;const F=this.getParent();return F&&F!==O&&this!==O?F._isListening(O):!0}isVisible(){return this._getCache(D,this._isVisible)}_isVisible(O){if(!this.visible())return!1;const F=this.getParent();return F&&F!==O&&this!==O?F._isVisible(O):!0}shouldDrawHit(O,W=!1){if(O)return this._isVisible(O)&&this._isListening(O);const F=this.getLayer();let K=!1;i.DD._dragElements.forEach(Q=>{Q.dragStatus==="dragging"&&(Q.node.nodeType==="Stage"||Q.node.getLayer()===F)&&(K=!0)});const X=!W&&!n.Konva.hitOnDragEnabled&&(K||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!X}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let O=this.getDepth(),W=this,F=0,K,X,Q,ae;function re(te){for(K=[],X=te.length,Q=0;Q<X;Q++)ae=te[Q],F++,ae.nodeType!==k&&(K=K.concat(ae.getChildren().slice())),ae._id===W._id&&(Q=X);K.length>0&&K[0].getDepth()<=O&&re(K)}const G=this.getStage();return W.nodeType!==j&&G&&re(G.getChildren()),F}getDepth(){let O=0,W=this.parent;for(;W;)O++,W=W.parent;return O}_batchTransformChanges(O){this._batchingTransformChange=!0,O(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(R),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(O){return this._batchTransformChanges(()=>{this.x(O.x),this.y(O.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const O=this.getStage();if(!O)return null;const W=O.getPointerPosition();if(!W)return null;const F=this.getAbsoluteTransform().copy();return F.invert(),F.point(W)}getAbsolutePosition(O){let W=!1,F=this.parent;for(;F;){if(F.isCached()){W=!0;break}F=F.parent}W&&!O&&(O=!0);const K=this.getAbsoluteTransform(O).getMatrix(),X=new t.Transform,Q=this.offset();return X.m=K.slice(),X.translate(Q.x,Q.y),X.getTranslation()}setAbsolutePosition(O){const{x:W,y:F,...K}=this._clearTransform();this.attrs.x=W,this.attrs.y=F,this._clearCache(R);const X=this._getAbsoluteTransform().copy();return X.invert(),X.translate(O.x,O.y),O={x:this.attrs.x+X.getTranslation().x,y:this.attrs.y+X.getTranslation().y},this._setTransform(K),this.setPosition({x:O.x,y:O.y}),this._clearCache(R),this._clearSelfAndDescendantCache(l),this}_setTransform(O){let W;for(W in O)this.attrs[W]=O[W]}_clearTransform(){const O={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,O}move(O){let W=O.x,F=O.y,K=this.x(),X=this.y();return W!==void 0&&(K+=W),F!==void 0&&(X+=F),this.setPosition({x:K,y:X}),this}_eachAncestorReverse(O,W){let F=[],K=this.getParent(),X,Q;if(!(W&&W._id===this._id)){for(F.unshift(this);K&&(!W||K._id!==W._id);)F.unshift(K),K=K.parent;for(X=F.length,Q=0;Q<X;Q++)O(F[Q])}}rotate(O){return this.rotation(this.rotation()+O),this}moveToTop(){if(!this.parent)return t.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const O=this.index,W=this.parent.getChildren().length;return O<W-1?(this.parent.children.splice(O,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return t.Util.warn("Node has no parent. moveUp function is ignored."),!1;const O=this.index,W=this.parent.getChildren().length;return O<W-1?(this.parent.children.splice(O,1),this.parent.children.splice(O+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return t.Util.warn("Node has no parent. moveDown function is ignored."),!1;const O=this.index;return O>0?(this.parent.children.splice(O,1),this.parent.children.splice(O-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return t.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const O=this.index;return O>0?(this.parent.children.splice(O,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(O){if(!this.parent)return t.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(O<0||O>=this.parent.children.length)&&t.Util.warn("Unexpected value "+O+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const W=this.index;return this.parent.children.splice(W,1),this.parent.children.splice(O,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(s,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let O=this.opacity();const W=this.getParent();return W&&!W._isUnderCache&&(O*=W.getAbsoluteOpacity()),O}moveTo(O){return this.getParent()!==O&&(this._remove(),O.add(this)),this}toObject(){let O=this.getAttrs(),W,F,K,X,Q;const ae={attrs:{},className:this.getClassName()};for(W in O)F=O[W],Q=t.Util.isObject(F)&&!t.Util._isPlainObject(F)&&!t.Util._isArray(F),!Q&&(K=typeof this[W]=="function"&&this[W],delete O[W],X=K?K.call(this):null,O[W]=F,X!==F&&(ae.attrs[W]=F));return t.Util._prepareToStringify(ae)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(O,W,F){const K=[];W&&this._isMatch(O)&&K.push(this);let X=this.parent;for(;X;){if(X===F)return K;X._isMatch(O)&&K.push(X),X=X.parent}return K}isAncestorOf(O){return!1}findAncestor(O,W,F){return this.findAncestors(O,W,F)[0]}_isMatch(O){if(!O)return!1;if(typeof O=="function")return O(this);let W=O.replace(/ /g,"").split(","),F=W.length,K,X;for(K=0;K<F;K++)if(X=W[K],t.Util.isValidSelector(X)||(t.Util.warn('Selector "'+X+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),t.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),t.Util.warn("Konva is awesome, right?")),X.charAt(0)==="#"){if(this.id()===X.slice(1))return!0}else if(X.charAt(0)==="."){if(this.hasName(X.slice(1)))return!0}else if(this.className===X||this.nodeType===X)return!0;return!1}getLayer(){const O=this.getParent();return O?O.getLayer():null}getStage(){return this._getCache(T,this._getStage)}_getStage(){const O=this.getParent();return O?O.getStage():null}fire(O,W={},F){return W.target=W.target||this,F?this._fireAndBubble(O,W):this._fire(O,W),this}getAbsoluteTransform(O){return O?this._getAbsoluteTransform(O):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(O){let W;if(O)return W=new t.Transform,this._eachAncestorReverse(function(F){const K=F.transformsEnabled();K==="all"?W.multiply(F.getTransform()):K==="position"&&W.translate(F.x()-F.offsetX(),F.y()-F.offsetY())},O),W;{W=this._cache.get(l)||new t.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(W):W.reset();const F=this.transformsEnabled();if(F==="all")W.multiply(this.getTransform());else if(F==="position"){const K=this.attrs.x||0,X=this.attrs.y||0,Q=this.attrs.offsetX||0,ae=this.attrs.offsetY||0;W.translate(K-Q,X-ae)}return W.dirty=!1,W}}getAbsoluteScale(O){let W=this;for(;W;)W._isUnderCache&&(O=W),W=W.getParent();const K=this.getAbsoluteTransform(O).decompose();return{x:K.scaleX,y:K.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(R,this._getTransform)}_getTransform(){var O,W;const F=this._cache.get(R)||new t.Transform;F.reset();const K=this.x(),X=this.y(),Q=n.Konva.getAngle(this.rotation()),ae=(O=this.attrs.scaleX)!==null&&O!==void 0?O:1,re=(W=this.attrs.scaleY)!==null&&W!==void 0?W:1,G=this.attrs.skewX||0,te=this.attrs.skewY||0,ne=this.attrs.offsetX||0,de=this.attrs.offsetY||0;return(K!==0||X!==0)&&F.translate(K,X),Q!==0&&F.rotate(Q),(G!==0||te!==0)&&F.skew(G,te),(ae!==1||re!==1)&&F.scale(ae,re),(ne!==0||de!==0)&&F.translate(-1*ne,-1*de),F.dirty=!1,F}clone(O){let W=t.Util.cloneObject(this.attrs),F,K,X,Q,ae;for(F in O)W[F]=O[F];const re=new this.constructor(W);for(F in this.eventListeners)for(K=this.eventListeners[F],X=K.length,Q=0;Q<X;Q++)ae=K[Q],ae.name.indexOf(v)<0&&(re.eventListeners[F]||(re.eventListeners[F]=[]),re.eventListeners[F].push(ae));return re}_toKonvaCanvas(O){O=O||{};const W=this.getClientRect(),F=this.getStage(),K=O.x!==void 0?O.x:Math.floor(W.x),X=O.y!==void 0?O.y:Math.floor(W.y),Q=O.pixelRatio||1,ae=new r.SceneCanvas({width:O.width||Math.ceil(W.width)||(F?F.width():0),height:O.height||Math.ceil(W.height)||(F?F.height():0),pixelRatio:Q}),re=ae.getContext(),G=new r.SceneCanvas({width:ae.width/ae.pixelRatio+Math.abs(K),height:ae.height/ae.pixelRatio+Math.abs(X),pixelRatio:ae.pixelRatio});return O.imageSmoothingEnabled===!1&&(re._context.imageSmoothingEnabled=!1),re.save(),(K||X)&&re.translate(-1*K,-1*X),this.drawScene(ae,void 0,G),re.restore(),ae}toCanvas(O){return this._toKonvaCanvas(O)._canvas}toDataURL(O){O=O||{};const W=O.mimeType||null,F=O.quality||null,K=this._toKonvaCanvas(O).toDataURL(W,F);return O.callback&&O.callback(K),K}toImage(O){return new Promise((W,F)=>{try{const K=O?.callback;K&&delete O.callback,t.Util._urlToImage(this.toDataURL(O),function(X){W(X),K?.(X)})}catch(K){F(K)}})}toBlob(O){return new Promise((W,F)=>{try{const K=O?.callback;K&&delete O.callback,this.toCanvas(O).toBlob(X=>{W(X),K?.(X)},O?.mimeType,O?.quality)}catch(K){F(K)}})}setSize(O){return this.width(O.width),this.height(O.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(O,W,F){let K=this.eventListeners[O],X,Q,ae;for(X=0;X<K.length;X++)if(Q=K[X].name,ae=K[X].handler,(Q!=="konva"||W==="konva")&&(!W||Q===W)&&(!F||F===ae)){if(K.splice(X,1),K.length===0){delete this.eventListeners[O];break}X--}}_fireChangeEvent(O,W,F){this._fire(O+f,{oldVal:W,newVal:F})}addName(O){if(!this.hasName(O)){const W=this.name(),F=W?W+" "+O:O;this.name(F)}return this}hasName(O){if(!O)return!1;const W=this.name();return W?(W||"").split(/\s/g).indexOf(O)!==-1:!1}removeName(O){const W=(this.name()||"").split(/\s/g),F=W.indexOf(O);return F!==-1&&(W.splice(F,1),this.name(W.join(" "))),this}setAttr(O,W){const F=this[N+t.Util._capitalize(O)];return t.Util._isFunction(F)?F.call(this,W):this._setAttr(O,W),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const O=this.getLayer()||this.getStage();O?.batchDraw()}}_setAttr(O,W){const F=this.attrs[O];F===W&&!t.Util.isObject(W)||(W==null?delete this.attrs[O]:this.attrs[O]=W,this._shouldFireChangeEvents&&this._fireChangeEvent(O,F,W),this._requestDraw())}_setComponentAttr(O,W,F){let K;F!==void 0&&(K=this.attrs[O],K||(this.attrs[O]=this.getAttr(O)),this.attrs[O][W]=F,this._fireChangeEvent(O,K,F))}_fireAndBubble(O,W,F){if(W&&this.nodeType===k&&(W.target=this),!((O===_||O===S)&&(F&&(this===F||this.isAncestorOf&&this.isAncestorOf(F))||this.nodeType==="Stage"&&!F))){this._fire(O,W);const X=(O===_||O===S)&&F&&F.isAncestorOf&&F.isAncestorOf(this)&&!F.isAncestorOf(this.parent);(W&&!W.cancelBubble||!W)&&this.parent&&this.parent.isListening()&&!X&&(F&&F.parent?this._fireAndBubble.call(this.parent,O,W,F):this._fireAndBubble.call(this.parent,O,W))}}_getProtoListeners(O){var W,F,K;const X=(W=this._cache.get(o))!==null&&W!==void 0?W:{};let Q=X?.[O];if(Q===void 0){Q=[];let ae=Object.getPrototypeOf(this);for(;ae;){const re=(K=(F=ae.eventListeners)===null||F===void 0?void 0:F[O])!==null&&K!==void 0?K:[];Q.push(...re),ae=Object.getPrototypeOf(ae)}X[O]=Q,this._cache.set(o,X)}return Q}_fire(O,W){W=W||{},W.currentTarget=this,W.type=O;const F=this._getProtoListeners(O);if(F)for(var K=0;K<F.length;K++)F[K].handler.call(this,W);const X=this.eventListeners[O];if(X)for(var K=0;K<X.length;K++)X[K].handler.call(this,W)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(O){const W=O?O.pointerId:void 0,F=this.getStage(),K=this.getAbsolutePosition();if(!F)return;const X=F._getPointerById(W)||F._changedPointerPositions[0]||K;i.DD._dragElements.set(this._id,{node:this,startPointerPos:X,offset:{x:X.x-K.x,y:X.y-K.y},dragStatus:"ready",pointerId:W})}startDrag(O,W=!0){i.DD._dragElements.has(this._id)||this._createDragElement(O);const F=i.DD._dragElements.get(this._id);F.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:O&&O.evt},W)}_setDragPosition(O,W){const F=this.getStage()._getPointerById(W.pointerId);if(!F)return;let K={x:F.x-W.offset.x,y:F.y-W.offset.y};const X=this.dragBoundFunc();if(X!==void 0){const Q=X.call(this,K,O);Q?K=Q:t.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==K.x||this._lastPos.y!==K.y)&&(this.setAbsolutePosition(K),this._requestDraw()),this._lastPos=K}stopDrag(O){const W=i.DD._dragElements.get(this._id);W&&(W.dragStatus="stopped"),i.DD._endDragBefore(O),i.DD._endDragAfter(O)}setDraggable(O){this._setAttr("draggable",O),this._dragChange()}isDragging(){const O=i.DD._dragElements.get(this._id);return O?O.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(O){if(!(!(O.evt.button!==void 0)||n.Konva.dragButtons.indexOf(O.evt.button)>=0)||this.isDragging())return;let K=!1;i.DD._dragElements.forEach(X=>{this.isAncestorOf(X.node)&&(K=!0)}),K||this._createDragElement(O)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const W=i.DD._dragElements.get(this._id),F=W&&W.dragStatus==="dragging",K=W&&W.dragStatus==="ready";F?this.stopDrag():K&&i.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(O={x:0,y:0}){const W=this.getStage();if(!W)return!1;const F={x:-O.x,y:-O.y,width:W.width()+2*O.x,height:W.height()+2*O.y};return t.Util.haveIntersection(F,this.getClientRect())}static create(O,W){return t.Util._isString(O)&&(O=JSON.parse(O)),this._createNode(O,W)}static _createNode(O,W){let F=V.prototype.getClassName.call(O),K=O.children,X,Q,ae;W&&(O.attrs.container=W),n.Konva[F]||(t.Util.warn('Can not find a node with class name "'+F+'". Fallback to "Shape".'),F="Shape");const re=n.Konva[F];if(X=new re(O.attrs),K)for(Q=K.length,ae=0;ae<Q;ae++)X.add(V._createNode(K[ae]));return X}}pm.Node=V,V.prototype.nodeType="Node",V.prototype._attrsAffectingSize=[],V.prototype.eventListeners={},V.prototype.on.call(V.prototype,B,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(R),this._clearSelfAndDescendantCache(l)}),V.prototype.on.call(V.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(D)}),V.prototype.on.call(V.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(x)}),V.prototype.on.call(V.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(s)});const $=e.Factory.addGetterSetter;return $(V,"zIndex"),$(V,"absolutePosition"),$(V,"position"),$(V,"x",0,(0,a.getNumberValidator)()),$(V,"y",0,(0,a.getNumberValidator)()),$(V,"globalCompositeOperation","source-over",(0,a.getStringValidator)()),$(V,"opacity",1,(0,a.getNumberValidator)()),$(V,"name","",(0,a.getStringValidator)()),$(V,"id","",(0,a.getStringValidator)()),$(V,"rotation",0,(0,a.getNumberValidator)()),e.Factory.addComponentsGetterSetter(V,"scale",["x","y"]),$(V,"scaleX",1,(0,a.getNumberValidator)()),$(V,"scaleY",1,(0,a.getNumberValidator)()),e.Factory.addComponentsGetterSetter(V,"skew",["x","y"]),$(V,"skewX",0,(0,a.getNumberValidator)()),$(V,"skewY",0,(0,a.getNumberValidator)()),e.Factory.addComponentsGetterSetter(V,"offset",["x","y"]),$(V,"offsetX",0,(0,a.getNumberValidator)()),$(V,"offsetY",0,(0,a.getNumberValidator)()),$(V,"dragDistance",null,(0,a.getNumberValidator)()),$(V,"width",0,(0,a.getNumberValidator)()),$(V,"height",0,(0,a.getNumberValidator)()),$(V,"listening",!0,(0,a.getBooleanValidator)()),$(V,"preventDefault",!0,(0,a.getBooleanValidator)()),$(V,"filters",null,function(Z){return this._filterUpToDate=!1,Z}),$(V,"visible",!0,(0,a.getBooleanValidator)()),$(V,"transformsEnabled","all",(0,a.getStringValidator)()),$(V,"size"),$(V,"dragBoundFunc"),$(V,"draggable",!1,(0,a.getBooleanValidator)()),e.Factory.backCompat(V,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),pm}var mm={},BN;function Mx(){if(BN)return mm;BN=1,Object.defineProperty(mm,"__esModule",{value:!0}),mm.Container=void 0;const t=hr(),e=si(),r=mr();let n=class extends e.Node{constructor(){super(...arguments),this.children=[]}getChildren(a){if(!a)return this.children||[];const s=this.children||[],o=[];return s.forEach(function(l){a(l)&&o.push(l)}),o}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.destroy()}),this.children=[],this._requestDraw(),this}add(...a){if(a.length===0)return this;if(a.length>1){for(let o=0;o<a.length;o++)this.add(a[o]);return this}const s=a[0];return s.getParent()?(s.moveTo(this),this):(this._validateAdd(s),s.index=this.getChildren().length,s.parent=this,s._clearCaches(),this.getChildren().push(s),this._fire("add",{child:s}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(a){return this._generalFind(a,!1)}findOne(a){const s=this._generalFind(a,!0);return s.length>0?s[0]:void 0}_generalFind(a,s){const o=[];return this._descendants(l=>{const u=l._isMatch(a);return u&&o.push(l),!!(u&&s)}),o}_descendants(a){let s=!1;const o=this.getChildren();for(const l of o){if(s=a(l),s)return!0;if(l.hasChildren()&&(s=l._descendants(a),s))return!0}return!1}toObject(){const a=e.Node.prototype.toObject.call(this);return a.children=[],this.getChildren().forEach(s=>{a.children.push(s.toObject())}),a}isAncestorOf(a){let s=a.getParent();for(;s;){if(s._id===this._id)return!0;s=s.getParent()}return!1}clone(a){const s=e.Node.prototype.clone.call(this,a);return this.getChildren().forEach(function(o){s.add(o.clone())}),s}getAllIntersections(a){const s=[];return this.find("Shape").forEach(o=>{o.isVisible()&&o.intersects(a)&&s.push(o)}),s}_clearSelfAndDescendantCache(a){var s;super._clearSelfAndDescendantCache(a),!this.isCached()&&((s=this.children)===null||s===void 0||s.forEach(function(o){o._clearSelfAndDescendantCache(a)}))}_setChildrenIndices(){var a;(a=this.children)===null||a===void 0||a.forEach(function(s,o){s.index=o}),this._requestDraw()}drawScene(a,s,o){const l=this.getLayer(),u=a||l&&l.getCanvas(),c=u&&u.getContext(),f=this._getCanvasCache(),g=f&&f.scene,v=u&&u.isCache;if(!this.isVisible()&&!v)return this;if(g){c.save();const x=this.getAbsoluteTransform(s).getMatrix();c.transform(x[0],x[1],x[2],x[3],x[4],x[5]),this._drawCachedSceneCanvas(c),c.restore()}else this._drawChildren("drawScene",u,s,o);return this}drawHit(a,s){if(!this.shouldDrawHit(s))return this;const o=this.getLayer(),l=a||o&&o.hitCanvas,u=l&&l.getContext(),c=this._getCanvasCache();if(c&&c.hit){u.save();const g=this.getAbsoluteTransform(s).getMatrix();u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(u),u.restore()}else this._drawChildren("drawHit",l,s);return this}_drawChildren(a,s,o,l){var u;const c=s&&s.getContext(),f=this.clipWidth(),g=this.clipHeight(),v=this.clipFunc(),x=typeof f=="number"&&typeof g=="number"||v,_=o===this;if(x){c.save();const N=this.getAbsoluteTransform(o);let k=N.getMatrix();c.transform(k[0],k[1],k[2],k[3],k[4],k[5]),c.beginPath();let E;if(v)E=v.call(this,c,this);else{const T=this.clipX(),R=this.clipY();c.rect(T||0,R||0,f,g)}c.clip.apply(c,E),k=N.copy().invert().getMatrix(),c.transform(k[0],k[1],k[2],k[3],k[4],k[5])}const S=!_&&this.globalCompositeOperation()!=="source-over"&&a==="drawScene";S&&(c.save(),c._applyGlobalCompositeOperation(this)),(u=this.children)===null||u===void 0||u.forEach(function(N){N[a](s,o,l)}),S&&c.restore(),x&&c.restore()}getClientRect(a={}){var s;const o=a.skipTransform,l=a.relativeTo;let u,c,f,g,v={x:1/0,y:1/0,width:0,height:0};const x=this;(s=this.children)===null||s===void 0||s.forEach(function(N){if(!N.visible())return;const k=N.getClientRect({relativeTo:x,skipShadow:a.skipShadow,skipStroke:a.skipStroke});k.width===0&&k.height===0||(u===void 0?(u=k.x,c=k.y,f=k.x+k.width,g=k.y+k.height):(u=Math.min(u,k.x),c=Math.min(c,k.y),f=Math.max(f,k.x+k.width),g=Math.max(g,k.y+k.height)))});const _=this.find("Shape");let S=!1;for(let N=0;N<_.length;N++)if(_[N]._isVisible(this)){S=!0;break}return S&&u!==void 0?v={x:u,y:c,width:f-u,height:g-c}:v={x:0,y:0,width:0,height:0},o?v:this._transformedRect(v,l)}};return mm.Container=n,t.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),t.Factory.addGetterSetter(n,"clipX",void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipY",void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipWidth",void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipHeight",void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(n,"clipFunc"),mm}var vw={},Wc={},zN;function hM(){if(zN)return Wc;zN=1,Object.defineProperty(Wc,"__esModule",{value:!0}),Wc.getCapturedShape=n,Wc.createEvent=i,Wc.hasPointerCapture=a,Wc.setPointerCapture=s,Wc.releaseCapture=o;const t=lr(),e=new Map,r=t.Konva._global.PointerEvent!==void 0;function n(l){return e.get(l)}function i(l){return{evt:l,pointerId:l.pointerId}}function a(l,u){return e.get(l)===u}function s(l,u){o(l),u.getStage()&&(e.set(l,u),r&&u._fire("gotpointercapture",i(new PointerEvent("gotpointercapture"))))}function o(l,u){const c=e.get(l);if(!c)return;const f=c.getStage();f&&f.content,e.delete(l),r&&c._fire("lostpointercapture",i(new PointerEvent("lostpointercapture")))}return Wc}var FN;function az(){return FN||(FN=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Zn(),r=hr(),n=Mx(),i=lr(),a=Px(),s=Y_(),o=lr(),l=hM(),u="Stage",c="string",f="px",g="mouseout",v="mouseleave",x="mouseover",_="mouseenter",S="mousemove",N="mousedown",k="mouseup",E="pointermove",T="pointerdown",R="pointerup",j="pointercancel",D="lostpointercapture",B="pointerout",I="pointerleave",V="pointerover",$="pointerenter",Z="contextmenu",O="touchstart",W="touchend",F="touchmove",K="touchcancel",X="wheel",Q=5,ae=[[_,"_pointerenter"],[N,"_pointerdown"],[S,"_pointermove"],[k,"_pointerup"],[v,"_pointerleave"],[O,"_pointerdown"],[F,"_pointermove"],[W,"_pointerup"],[K,"_pointercancel"],[x,"_pointerover"],[X,"_wheel"],[Z,"_contextmenu"],[T,"_pointerdown"],[E,"_pointermove"],[R,"_pointerup"],[j,"_pointercancel"],[D,"_lostpointercapture"]],re={mouse:{[B]:g,[I]:v,[V]:x,[$]:_,[E]:S,[T]:N,[R]:k,[j]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[B]:"touchout",[I]:"touchleave",[V]:"touchover",[$]:"touchenter",[E]:F,[T]:O,[R]:W,[j]:K,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[B]:B,[I]:I,[V]:V,[$]:$,[E]:E,[T]:T,[R]:R,[j]:j,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},G=ye=>ye.indexOf("pointer")>=0?"pointer":ye.indexOf("touch")>=0?"touch":"mouse",te=ye=>{const ie=G(ye);if(ie==="pointer")return i.Konva.pointerEventsEnabled&&re.pointer;if(ie==="touch")return re.touch;if(ie==="mouse")return re.mouse};function ne(ye={}){return(ye.clipFunc||ye.clipWidth||ye.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ye}const de="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class me extends n.Container{constructor(ie){super(ne(ie)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ne(this.attrs)}),this._checkVisibility()}_validateAdd(ie){const pe=ie.getType()==="Layer",oe=ie.getType()==="FastLayer";pe||oe||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const ie=this.visible()?"":"none";this.content.style.display=ie}setContainer(ie){if(typeof ie===c){if(ie.charAt(0)==="."){const oe=ie.slice(1);ie=document.getElementsByClassName(oe)[0]}else{var pe;ie.charAt(0)!=="#"?pe=ie:pe=ie.slice(1),ie=document.getElementById(pe)}if(!ie)throw"Can not find container in document with id "+pe}return this._setAttr("container",ie),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),ie.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let ie=this.children,pe=ie.length,oe;for(oe=0;oe<pe;oe++)ie[oe].clear();return this}clone(ie){return ie||(ie={}),ie.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,ie)}destroy(){super.destroy();const ie=this.content;ie&&e.Util._isInDocument(ie)&&this.container().removeChild(ie);const pe=t.stages.indexOf(this);return pe>-1&&t.stages.splice(pe,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const ie=this._pointerPositions[0]||this._changedPointerPositions[0];return ie?{x:ie.x,y:ie.y}:(e.Util.warn(de),null)}_getPointerById(ie){return this._pointerPositions.find(pe=>pe.id===ie)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(ie){ie=ie||{},ie.x=ie.x||0,ie.y=ie.y||0,ie.width=ie.width||this.width(),ie.height=ie.height||this.height();const pe=new a.SceneCanvas({width:ie.width,height:ie.height,pixelRatio:ie.pixelRatio||1}),oe=pe.getContext()._context,fe=this.children;return(ie.x||ie.y)&&oe.translate(-1*ie.x,-1*ie.y),fe.forEach(function(ge){if(!ge.isVisible())return;const be=ge._toKonvaCanvas(ie);oe.drawImage(be._canvas,ie.x,ie.y,be.getWidth()/be.getPixelRatio(),be.getHeight()/be.getPixelRatio())}),pe}getIntersection(ie){if(!ie)return null;let pe=this.children,oe=pe.length,fe=oe-1,ge;for(ge=fe;ge>=0;ge--){const be=pe[ge].getIntersection(ie);if(be)return be}return null}_resizeDOM(){const ie=this.width(),pe=this.height();this.content&&(this.content.style.width=ie+f,this.content.style.height=pe+f),this.bufferCanvas.setSize(ie,pe),this.bufferHitCanvas.setSize(ie,pe),this.children.forEach(oe=>{oe.setSize({width:ie,height:pe}),oe.draw()})}add(ie,...pe){if(arguments.length>1){for(let fe=0;fe<arguments.length;fe++)this.add(arguments[fe]);return this}super.add(ie);const oe=this.children.length;return oe>Q&&e.Util.warn("The stage has "+oe+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),ie.setSize({width:this.width(),height:this.height()}),ie.draw(),i.Konva.isBrowser&&this.content.appendChild(ie.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(ie){return l.hasPointerCapture(ie,this)}setPointerCapture(ie){l.setPointerCapture(ie,this)}releaseCapture(ie){l.releaseCapture(ie,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&ae.forEach(([ie,pe])=>{this.content.addEventListener(ie,oe=>{this[pe](oe)},{passive:!1})})}_pointerenter(ie){this.setPointersPositions(ie);const pe=te(ie.type);pe&&this._fire(pe.pointerenter,{evt:ie,target:this,currentTarget:this})}_pointerover(ie){this.setPointersPositions(ie);const pe=te(ie.type);pe&&this._fire(pe.pointerover,{evt:ie,target:this,currentTarget:this})}_getTargetShape(ie){let pe=this[ie+"targetShape"];return pe&&!pe.getStage()&&(pe=null),pe}_pointerleave(ie){const pe=te(ie.type),oe=G(ie.type);if(!pe)return;this.setPointersPositions(ie);const fe=this._getTargetShape(oe),ge=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;fe&&ge?(fe._fireAndBubble(pe.pointerout,{evt:ie}),fe._fireAndBubble(pe.pointerleave,{evt:ie}),this._fire(pe.pointerleave,{evt:ie,target:this,currentTarget:this}),this[oe+"targetShape"]=null):ge&&(this._fire(pe.pointerleave,{evt:ie,target:this,currentTarget:this}),this._fire(pe.pointerout,{evt:ie,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(ie){const pe=te(ie.type),oe=G(ie.type);if(!pe)return;this.setPointersPositions(ie);let fe=!1;this._changedPointerPositions.forEach(ge=>{const be=this.getIntersection(ge);if(s.DD.justDragged=!1,i.Konva["_"+oe+"ListenClick"]=!0,!be||!be.isListening()){this[oe+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&be.setPointerCapture(ge.id),this[oe+"ClickStartShape"]=be,be._fireAndBubble(pe.pointerdown,{evt:ie,pointerId:ge.id}),fe=!0;const _e=ie.type.indexOf("touch")>=0;be.preventDefault()&&ie.cancelable&&_e&&ie.preventDefault()}),fe||this._fire(pe.pointerdown,{evt:ie,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(ie){const pe=te(ie.type),oe=G(ie.type);if(!pe||(i.Konva.isDragging()&&s.DD.node.preventDefault()&&ie.cancelable&&ie.preventDefault(),this.setPointersPositions(ie),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const ge={};let be=!1;const _e=this._getTargetShape(oe);this._changedPointerPositions.forEach(De=>{const qe=l.getCapturedShape(De.id)||this.getIntersection(De),Ue=De.id,Ve={evt:ie,pointerId:Ue},Je=_e!==qe;if(Je&&_e&&(_e._fireAndBubble(pe.pointerout,{...Ve},qe),_e._fireAndBubble(pe.pointerleave,{...Ve},qe)),qe){if(ge[qe._id])return;ge[qe._id]=!0}qe&&qe.isListening()?(be=!0,Je&&(qe._fireAndBubble(pe.pointerover,{...Ve},_e),qe._fireAndBubble(pe.pointerenter,{...Ve},_e),this[oe+"targetShape"]=qe),qe._fireAndBubble(pe.pointermove,{...Ve})):_e&&(this._fire(pe.pointerover,{evt:ie,target:this,currentTarget:this,pointerId:Ue}),this[oe+"targetShape"]=null)}),be||this._fire(pe.pointermove,{evt:ie,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(ie){const pe=te(ie.type),oe=G(ie.type);if(!pe)return;this.setPointersPositions(ie);const fe=this[oe+"ClickStartShape"],ge=this[oe+"ClickEndShape"],be={};let _e=!1;this._changedPointerPositions.forEach(De=>{const qe=l.getCapturedShape(De.id)||this.getIntersection(De);if(qe){if(qe.releaseCapture(De.id),be[qe._id])return;be[qe._id]=!0}const Ue=De.id,Ve={evt:ie,pointerId:Ue};let Je=!1;i.Konva["_"+oe+"InDblClickWindow"]?(Je=!0,clearTimeout(this[oe+"DblTimeout"])):s.DD.justDragged||(i.Konva["_"+oe+"InDblClickWindow"]=!0,clearTimeout(this[oe+"DblTimeout"])),this[oe+"DblTimeout"]=setTimeout(function(){i.Konva["_"+oe+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),qe&&qe.isListening()?(_e=!0,this[oe+"ClickEndShape"]=qe,qe._fireAndBubble(pe.pointerup,{...Ve}),i.Konva["_"+oe+"ListenClick"]&&fe&&fe===qe&&(qe._fireAndBubble(pe.pointerclick,{...Ve}),Je&&ge&&ge===qe&&qe._fireAndBubble(pe.pointerdblclick,{...Ve}))):(this[oe+"ClickEndShape"]=null,i.Konva["_"+oe+"ListenClick"]&&this._fire(pe.pointerclick,{evt:ie,target:this,currentTarget:this,pointerId:Ue}),Je&&this._fire(pe.pointerdblclick,{evt:ie,target:this,currentTarget:this,pointerId:Ue}))}),_e||this._fire(pe.pointerup,{evt:ie,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+oe+"ListenClick"]=!1,ie.cancelable&&oe!=="touch"&&ie.preventDefault()}_contextmenu(ie){this.setPointersPositions(ie);const pe=this.getIntersection(this.getPointerPosition());pe&&pe.isListening()?pe._fireAndBubble(Z,{evt:ie}):this._fire(Z,{evt:ie,target:this,currentTarget:this})}_wheel(ie){this.setPointersPositions(ie);const pe=this.getIntersection(this.getPointerPosition());pe&&pe.isListening()?pe._fireAndBubble(X,{evt:ie}):this._fire(X,{evt:ie,target:this,currentTarget:this})}_pointercancel(ie){this.setPointersPositions(ie);const pe=l.getCapturedShape(ie.pointerId)||this.getIntersection(this.getPointerPosition());pe&&pe._fireAndBubble(R,l.createEvent(ie)),l.releaseCapture(ie.pointerId)}_lostpointercapture(ie){l.releaseCapture(ie.pointerId)}setPointersPositions(ie){let pe=this._getContentPosition(),oe=null,fe=null;ie=ie||window.event,ie.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(ie.touches,ge=>{this._pointerPositions.push({id:ge.identifier,x:(ge.clientX-pe.left)/pe.scaleX,y:(ge.clientY-pe.top)/pe.scaleY})}),Array.prototype.forEach.call(ie.changedTouches||ie.touches,ge=>{this._changedPointerPositions.push({id:ge.identifier,x:(ge.clientX-pe.left)/pe.scaleX,y:(ge.clientY-pe.top)/pe.scaleY})})):(oe=(ie.clientX-pe.left)/pe.scaleX,fe=(ie.clientY-pe.top)/pe.scaleY,this.pointerPos={x:oe,y:fe},this._pointerPositions=[{x:oe,y:fe,id:e.Util._getFirstPointerId(ie)}],this._changedPointerPositions=[{x:oe,y:fe,id:e.Util._getFirstPointerId(ie)}])}_setPointerPosition(ie){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(ie)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const ie=this.content.getBoundingClientRect();return{top:ie.top,left:ie.left,scaleX:ie.width/this.content.clientWidth||1,scaleY:ie.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const ie=this.container();if(!ie)throw"Stage has no container. A container is required.";ie.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),ie.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(ie){ie.batchDraw()}),this}}t.Stage=me,me.prototype.nodeType=u,(0,o._registerNode)(me),r.Factory.addGetterSetter(me,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(ye=>{ye.batchDraw()})})})(vw)),vw}var gm={},yw={},VN;function Ji(){return VN||(VN=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=lr(),r=Zn(),n=hr(),i=si(),a=mr(),s=lr(),o=hM(),l="hasShadow",u="shadowRGBA",c="patternImage",f="linearGradient",g="radialGradient";let v;function x(){return v||(v=r.Util.createCanvasElement().getContext("2d"),v)}t.shapes={};function _(I){const V=this.attrs.fillRule;V?I.fill(V):I.fill()}function S(I){I.stroke()}function N(I){const V=this.attrs.fillRule;V?I.fill(V):I.fill()}function k(I){I.stroke()}function E(){this._clearCache(l)}function T(){this._clearCache(u)}function R(){this._clearCache(c)}function j(){this._clearCache(f)}function D(){this._clearCache(g)}class B extends i.Node{constructor(V){super(V);let $;for(;$=r.Util.getRandomColor(),!($&&!($ in t.shapes)););this.colorKey=$,t.shapes[$]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(c,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const $=x().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if($&&$.setTransform){const Z=new r.Transform;Z.translate(this.fillPatternX(),this.fillPatternY()),Z.rotate(e.Konva.getAngle(this.fillPatternRotation())),Z.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),Z.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const O=Z.getMatrix(),W=typeof DOMMatrix>"u"?{a:O[0],b:O[1],c:O[2],d:O[3],e:O[4],f:O[5]}:new DOMMatrix(O);$.setTransform(W)}return $}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){const V=this.fillLinearGradientColorStops();if(V){const $=x(),Z=this.fillLinearGradientStartPoint(),O=this.fillLinearGradientEndPoint(),W=$.createLinearGradient(Z.x,Z.y,O.x,O.y);for(let F=0;F<V.length;F+=2)W.addColorStop(V[F],V[F+1]);return W}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const V=this.fillRadialGradientColorStops();if(V){const $=x(),Z=this.fillRadialGradientStartPoint(),O=this.fillRadialGradientEndPoint(),W=$.createRadialGradient(Z.x,Z.y,this.fillRadialGradientStartRadius(),O.x,O.y,this.fillRadialGradientEndRadius());for(let F=0;F<V.length;F+=2)W.addColorStop(V[F],V[F+1]);return W}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const V=r.Util.colorToRGBA(this.shadowColor());if(V)return"rgba("+V.r+","+V.g+","+V.b+","+V.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const V=this.hitStrokeWidth();return V==="auto"?this.hasStroke():this.strokeEnabled()&&!!V}intersects(V){const $=this.getStage();if(!$)return!1;const Z=$.bufferHitCanvas;return Z.getContext().clear(),this.drawHit(Z,void 0,!0),Z.context.getImageData(Math.round(V.x),Math.round(V.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(V){var $;if(!(($=this.attrs.perfectDrawEnabled)!==null&&$!==void 0?$:!0))return!1;const O=V||this.hasFill(),W=this.hasStroke(),F=this.getAbsoluteOpacity()!==1;if(O&&W&&F)return!0;const K=this.hasShadow(),X=this.shadowForStrokeEnabled();return!!(O&&W&&K&&X)}setStrokeHitEnabled(V){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),V?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const V=this.size();return{x:this._centroid?-V.width/2:0,y:this._centroid?-V.height/2:0,width:V.width,height:V.height}}getClientRect(V={}){let $=!1,Z=this.getParent();for(;Z;){if(Z.isCached()){$=!0;break}Z=Z.getParent()}const O=V.skipTransform,W=V.relativeTo||$&&this.getStage()||void 0,F=this.getSelfRect(),X=!V.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,Q=F.width+X,ae=F.height+X,re=!V.skipShadow&&this.hasShadow(),G=re?this.shadowOffsetX():0,te=re?this.shadowOffsetY():0,ne=Q+Math.abs(G),de=ae+Math.abs(te),me=re&&this.shadowBlur()||0,ye=ne+me*2,ie=de+me*2,pe={width:ye,height:ie,x:-(X/2+me)+Math.min(G,0)+F.x,y:-(X/2+me)+Math.min(te,0)+F.y};return O?pe:this._transformedRect(pe,W)}drawScene(V,$,Z){const O=this.getLayer();let W=V||O.getCanvas(),F=W.getContext(),K=this._getCanvasCache(),X=this.getSceneFunc(),Q=this.hasShadow(),ae,re;const G=W.isCache,te=$===this;if(!this.isVisible()&&!te)return this;if(K){F.save();const de=this.getAbsoluteTransform($).getMatrix();return F.transform(de[0],de[1],de[2],de[3],de[4],de[5]),this._drawCachedSceneCanvas(F),F.restore(),this}if(!X)return this;if(F.save(),this._useBufferCanvas()&&!G){ae=this.getStage();const de=Z||ae.bufferCanvas;re=de.getContext(),re.clear(),re.save(),re._applyLineJoin(this);var ne=this.getAbsoluteTransform($).getMatrix();re.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]),X.call(this,re,this),re.restore();const me=de.pixelRatio;Q&&F._applyShadow(this),F._applyOpacity(this),F._applyGlobalCompositeOperation(this),F.drawImage(de._canvas,0,0,de.width/me,de.height/me)}else{if(F._applyLineJoin(this),!te){var ne=this.getAbsoluteTransform($).getMatrix();F.transform(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5]),F._applyOpacity(this),F._applyGlobalCompositeOperation(this)}Q&&F._applyShadow(this),X.call(this,F,this)}return F.restore(),this}drawHit(V,$,Z=!1){if(!this.shouldDrawHit($,Z))return this;const O=this.getLayer(),W=V||O.hitCanvas,F=W&&W.getContext(),K=this.hitFunc()||this.sceneFunc(),X=this._getCanvasCache(),Q=X&&X.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),Q){F.save();const re=this.getAbsoluteTransform($).getMatrix();return F.transform(re[0],re[1],re[2],re[3],re[4],re[5]),this._drawCachedHitCanvas(F),F.restore(),this}if(!K)return this;if(F.save(),F._applyLineJoin(this),!(this===$)){const re=this.getAbsoluteTransform($).getMatrix();F.transform(re[0],re[1],re[2],re[3],re[4],re[5])}return K.call(this,F,this),F.restore(),this}drawHitFromCache(V=0){let $=this._getCanvasCache(),Z=this._getCachedSceneCanvas(),O=$.hit,W=O.getContext(),F=O.getWidth(),K=O.getHeight(),X,Q,ae,re,G,te;W.clear(),W.drawImage(Z._canvas,0,0,F,K);try{for(X=W.getImageData(0,0,F,K),Q=X.data,ae=Q.length,re=r.Util._hexToRgb(this.colorKey),G=0;G<ae;G+=4)te=Q[G+3],te>V?(Q[G]=re.r,Q[G+1]=re.g,Q[G+2]=re.b,Q[G+3]=255):Q[G+3]=0;W.putImageData(X,0,0)}catch(ne){r.Util.error("Unable to draw hit graph from cached scene canvas. "+ne.message)}return this}hasPointerCapture(V){return o.hasPointerCapture(V,this)}setPointerCapture(V){o.setPointerCapture(V,this)}releaseCapture(V){o.releaseCapture(V,this)}}t.Shape=B,B.prototype._fillFunc=_,B.prototype._strokeFunc=S,B.prototype._fillFuncHit=N,B.prototype._strokeFuncHit=k,B.prototype._centroid=!1,B.prototype.nodeType="Shape",(0,s._registerNode)(B),B.prototype.eventListeners={},B.prototype.on.call(B.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",E),B.prototype.on.call(B.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",T),B.prototype.on.call(B.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",R),B.prototype.on.call(B.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",j),B.prototype.on.call(B.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",D),n.Factory.addGetterSetter(B,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(B,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(B,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(B,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(B,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(B,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(B,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(B,"lineJoin"),n.Factory.addGetterSetter(B,"lineCap"),n.Factory.addGetterSetter(B,"sceneFunc"),n.Factory.addGetterSetter(B,"hitFunc"),n.Factory.addGetterSetter(B,"dash"),n.Factory.addGetterSetter(B,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(B,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(B,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(B,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(B,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(B,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(B,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(B,"fillPatternImage"),n.Factory.addGetterSetter(B,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(B,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(B,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(B,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(B,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(B,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(B,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(B,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(B,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(B,"fillEnabled",!0),n.Factory.addGetterSetter(B,"strokeEnabled",!0),n.Factory.addGetterSetter(B,"shadowEnabled",!0),n.Factory.addGetterSetter(B,"dashEnabled",!0),n.Factory.addGetterSetter(B,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(B,"fillPriority","color"),n.Factory.addComponentsGetterSetter(B,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(B,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(B,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(B,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(B,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(B,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(B,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(B,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(B,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(B,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(B,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(B,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(B,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(B,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(B,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(B,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(B,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(B,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(B,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(B,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(B,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(B,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(B,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(B,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(B,"fillPatternRotation",0),n.Factory.addGetterSetter(B,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(B,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(yw)),yw}var UN;function fM(){if(UN)return gm;UN=1,Object.defineProperty(gm,"__esModule",{value:!0}),gm.Layer=void 0;const t=Zn(),e=Mx(),r=si(),n=hr(),i=Px(),a=mr(),s=Ji(),o=lr(),l="#",u="beforeDraw",c="draw",f=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=f.length;class v extends e.Container{constructor(_){super(_),this.canvas=new i.SceneCanvas,this.hitCanvas=new i.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(_){return this.getContext().clear(_),this.getHitCanvas().getContext().clear(_),this}setZIndex(_){super.setZIndex(_);const S=this.getStage();return S&&S.content&&(S.content.removeChild(this.getNativeCanvasElement()),_<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[_+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);const _=this.getStage();return _&&_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!r.Node.prototype.moveUp.call(this))return!1;const S=this.getStage();return!S||!S.content?!1:(S.content.removeChild(this.getNativeCanvasElement()),this.index<S.children.length-1?S.content.insertBefore(this.getNativeCanvasElement(),S.children[this.index+1].getCanvas()._canvas):S.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){const _=this.getStage();if(_){const S=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),S[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){const _=this.getStage();if(_){const S=_.children;_.content&&(_.content.removeChild(this.getNativeCanvasElement()),_.content.insertBefore(this.getNativeCanvasElement(),S[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const _=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),_&&_.parentNode&&t.Util._isInDocument(_)&&_.parentNode.removeChild(_),this}getStage(){return this.parent}setSize({width:_,height:S}){return this.canvas.setSize(_,S),this.hitCanvas.setSize(_,S),this._setSmoothEnabled(),this}_validateAdd(_){const S=_.getType();S!=="Group"&&S!=="Shape"&&t.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(_){return _=_||{},_.width=_.width||this.getWidth(),_.height=_.height||this.getHeight(),_.x=_.x!==void 0?_.x:this.x(),_.y=_.y!==void 0?_.y:this.y(),r.Node.prototype._toKonvaCanvas.call(this,_)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(_){if(!this.isListening()||!this.isVisible())return null;let S=1,N=!1;for(;;){for(let k=0;k<g;k++){const E=f[k],T=this._getIntersection({x:_.x+E.x*S,y:_.y+E.y*S}),R=T.shape;if(R)return R;if(N=!!T.antialiased,!T.antialiased)break}if(N)S+=1;else return null}}_getIntersection(_){const S=this.hitCanvas.pixelRatio,N=this.hitCanvas.context.getImageData(Math.round(_.x*S),Math.round(_.y*S),1,1).data,k=N[3];if(k===255){const E=t.Util._rgbToHex(N[0],N[1],N[2]),T=s.shapes[l+E];return T?{shape:T}:{antialiased:!0}}else if(k>0)return{antialiased:!0};return{}}drawScene(_,S){const N=this.getLayer(),k=_||N&&N.getCanvas();return this._fire(u,{node:this}),this.clearBeforeDraw()&&k.getContext().clear(),e.Container.prototype.drawScene.call(this,k,S),this._fire(c,{node:this}),this}drawHit(_,S){const N=this.getLayer(),k=_||N&&N.hitCanvas;return N&&N.clearBeforeDraw()&&N.getHitCanvas().getContext().clear(),e.Container.prototype.drawHit.call(this,k,S),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(_){t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(_)}getHitGraphEnabled(_){return t.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const _=this.parent;!!this.hitCanvas._canvas.parentNode?_.content.removeChild(this.hitCanvas._canvas):_.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return gm.Layer=v,v.prototype.nodeType="Layer",(0,o._registerNode)(v),n.Factory.addGetterSetter(v,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(v,"clearBeforeDraw",!0),n.Factory.addGetterSetter(v,"hitGraphEnabled",!0,(0,a.getBooleanValidator)()),gm}var vm={},HN;function sz(){if(HN)return vm;HN=1,Object.defineProperty(vm,"__esModule",{value:!0}),vm.FastLayer=void 0;const t=Zn(),e=fM(),r=lr();let n=class extends e.Layer{constructor(a){super(a),this.listening(!1),t.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};return vm.FastLayer=n,n.prototype.nodeType="FastLayer",(0,r._registerNode)(n),vm}var ym={},GN;function X_(){if(GN)return ym;GN=1,Object.defineProperty(ym,"__esModule",{value:!0}),ym.Group=void 0;const t=Zn(),e=Mx(),r=lr();let n=class extends e.Container{_validateAdd(a){const s=a.getType();s!=="Group"&&s!=="Shape"&&t.Util.throw("You may only add groups and shapes to groups.")}};return ym.Group=n,n.prototype.nodeType="Group",(0,r._registerNode)(n),ym}var xm={},qN;function Q_(){if(qN)return xm;qN=1,Object.defineProperty(xm,"__esModule",{value:!0}),xm.Animation=void 0;const t=lr(),e=Zn(),r=(function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}})();let n=class qf{constructor(a,s){this.id=qf.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=a,this.setLayers(s)}setLayers(a){let s=[];return a&&(s=Array.isArray(a)?a:[a]),this.layers=s,this}getLayers(){return this.layers}addLayer(a){const s=this.layers,o=s.length;for(let l=0;l<o;l++)if(s[l]._id===a._id)return!1;return this.layers.push(a),!0}isRunning(){const s=qf.animations,o=s.length;for(let l=0;l<o;l++)if(s[l].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),qf._addAnimation(this),this}stop(){return qf._removeAnimation(this),this}_updateFrameObject(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(a){this.animations.push(a),this._handleAnimation()}static _removeAnimation(a){const s=a.id,o=this.animations,l=o.length;for(let u=0;u<l;u++)if(o[u].id===s){this.animations.splice(u,1);break}}static _runFrames(){const a={},s=this.animations;for(let o=0;o<s.length;o++){const l=s[o],u=l.layers,c=l.func;l._updateFrameObject(r());const f=u.length;let g;if(c?g=c.call(l,l.frame)!==!1:g=!0,!!g)for(let v=0;v<f;v++){const x=u[v];x._id!==void 0&&(a[x._id]=x)}}for(const o in a)a.hasOwnProperty(o)&&a[o].batchDraw()}static _animationLoop(){const a=qf;a.animations.length?(a._runFrames(),e.Util.requestAnimFrame(a._animationLoop)):a.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,e.Util.requestAnimFrame(this._animationLoop))}};return xm.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,xm}var xw={},WN;function oz(){return WN||(WN=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Zn(),r=Q_(),n=si(),i=lr();let a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,o=2,l=3,u=0,c=["fill","stroke","shadowColor"];class f{constructor(x,_,S,N,k,E,T){this.prop=x,this.propFunc=_,this.begin=N,this._pos=N,this.duration=E,this._change=0,this.prevPos=0,this.yoyo=T,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=S,this._change=k-this.begin,this.pause()}fire(x){const _=this[x];_&&_()}setTime(x){x>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():x<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=x,this.update())}getTime(){return this._time}setPosition(x){this.prevPos=this._pos,this.propFunc(x),this._pos=x}getPosition(x){return x===void 0&&(x=this._time),this.func(x,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(x){this.pause(),this._time=x,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const x=this.getTimer()-this._startTime;this.state===o?this.setTime(x):this.state===l&&this.setTime(this.duration-x)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(x){let _=this,S=x.node,N=S._id,k,E=x.easing||t.Easings.Linear,T=!!x.yoyo,R;typeof x.duration>"u"?k=.3:x.duration===0?k=.001:k=x.duration,this.node=S,this._id=u++;const j=S.getLayer()||(S instanceof i.Konva.Stage?S.getLayers():null);j||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){_.tween.onEnterFrame()},j),this.tween=new f(R,function(D){_._tweenFunc(D)},E,0,1,k*1e3,T),this._addListeners(),g.attrs[N]||(g.attrs[N]={}),g.attrs[N][this._id]||(g.attrs[N][this._id]={}),g.tweens[N]||(g.tweens[N]={});for(R in x)a[R]===void 0&&this._addAttr(R,x[R]);this.reset(),this.onFinish=x.onFinish,this.onReset=x.onReset,this.onUpdate=x.onUpdate}_addAttr(x,_){let S=this.node,N=S._id,k,E,T,R,j,D,B,I;if(T=g.tweens[N][x],T&&delete g.attrs[N][T][x],k=S.getAttr(x),e.Util._isArray(_))if(E=[],j=Math.max(_.length,k.length),x==="points"&&_.length!==k.length&&(_.length>k.length?(B=k,k=e.Util._prepareArrayForTween(k,_,S.closed())):(D=_,_=e.Util._prepareArrayForTween(_,k,S.closed()))),x.indexOf("fill")===0)for(R=0;R<j;R++)if(R%2===0)E.push(_[R]-k[R]);else{const V=e.Util.colorToRGBA(k[R]);I=e.Util.colorToRGBA(_[R]),k[R]=V,E.push({r:I.r-V.r,g:I.g-V.g,b:I.b-V.b,a:I.a-V.a})}else for(R=0;R<j;R++)E.push(_[R]-k[R]);else c.indexOf(x)!==-1?(k=e.Util.colorToRGBA(k),I=e.Util.colorToRGBA(_),E={r:I.r-k.r,g:I.g-k.g,b:I.b-k.b,a:I.a-k.a}):E=_-k;g.attrs[N][this._id][x]={start:k,diff:E,end:_,trueEnd:D,trueStart:B},g.tweens[N][x]=this._id}_tweenFunc(x){let _=this.node,S=g.attrs[_._id][this._id],N,k,E,T,R,j,D,B;for(N in S){if(k=S[N],E=k.start,T=k.diff,B=k.end,e.Util._isArray(E))if(R=[],D=Math.max(E.length,B.length),N.indexOf("fill")===0)for(j=0;j<D;j++)j%2===0?R.push((E[j]||0)+T[j]*x):R.push("rgba("+Math.round(E[j].r+T[j].r*x)+","+Math.round(E[j].g+T[j].g*x)+","+Math.round(E[j].b+T[j].b*x)+","+(E[j].a+T[j].a*x)+")");else for(j=0;j<D;j++)R.push((E[j]||0)+T[j]*x);else c.indexOf(N)!==-1?R="rgba("+Math.round(E.r+T.r*x)+","+Math.round(E.g+T.g*x)+","+Math.round(E.b+T.b*x)+","+(E.a+T.a*x)+")":R=E+T*x;_.setAttr(N,R)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const x=this.node,_=g.attrs[x._id][this._id];_.points&&_.points.trueEnd&&x.setAttr("points",_.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const x=this.node,_=g.attrs[x._id][this._id];_.points&&_.points.trueStart&&x.points(_.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(x){return this.tween.seek(x*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let x=this.node._id,_=this._id,S=g.tweens[x],N;this.pause();for(N in S)delete g.tweens[x][N];delete g.attrs[x][_]}}t.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(v){const x=v.onFinish;v.node=this,v.onFinish=function(){this.destroy(),x&&x()},new g(v).play()},t.Easings={BackEaseIn(v,x,_,S){return _*(v/=S)*v*((1.70158+1)*v-1.70158)+x},BackEaseOut(v,x,_,S){return _*((v=v/S-1)*v*((1.70158+1)*v+1.70158)+1)+x},BackEaseInOut(v,x,_,S){let N=1.70158;return(v/=S/2)<1?_/2*(v*v*(((N*=1.525)+1)*v-N))+x:_/2*((v-=2)*v*(((N*=1.525)+1)*v+N)+2)+x},ElasticEaseIn(v,x,_,S,N,k){let E=0;return v===0?x:(v/=S)===1?x+_:(k||(k=S*.3),!N||N<Math.abs(_)?(N=_,E=k/4):E=k/(2*Math.PI)*Math.asin(_/N),-(N*Math.pow(2,10*(v-=1))*Math.sin((v*S-E)*(2*Math.PI)/k))+x)},ElasticEaseOut(v,x,_,S,N,k){let E=0;return v===0?x:(v/=S)===1?x+_:(k||(k=S*.3),!N||N<Math.abs(_)?(N=_,E=k/4):E=k/(2*Math.PI)*Math.asin(_/N),N*Math.pow(2,-10*v)*Math.sin((v*S-E)*(2*Math.PI)/k)+_+x)},ElasticEaseInOut(v,x,_,S,N,k){let E=0;return v===0?x:(v/=S/2)===2?x+_:(k||(k=S*(.3*1.5)),!N||N<Math.abs(_)?(N=_,E=k/4):E=k/(2*Math.PI)*Math.asin(_/N),v<1?-.5*(N*Math.pow(2,10*(v-=1))*Math.sin((v*S-E)*(2*Math.PI)/k))+x:N*Math.pow(2,-10*(v-=1))*Math.sin((v*S-E)*(2*Math.PI)/k)*.5+_+x)},BounceEaseOut(v,x,_,S){return(v/=S)<1/2.75?_*(7.5625*v*v)+x:v<2/2.75?_*(7.5625*(v-=1.5/2.75)*v+.75)+x:v<2.5/2.75?_*(7.5625*(v-=2.25/2.75)*v+.9375)+x:_*(7.5625*(v-=2.625/2.75)*v+.984375)+x},BounceEaseIn(v,x,_,S){return _-t.Easings.BounceEaseOut(S-v,0,_,S)+x},BounceEaseInOut(v,x,_,S){return v<S/2?t.Easings.BounceEaseIn(v*2,0,_,S)*.5+x:t.Easings.BounceEaseOut(v*2-S,0,_,S)*.5+_*.5+x},EaseIn(v,x,_,S){return _*(v/=S)*v+x},EaseOut(v,x,_,S){return-_*(v/=S)*(v-2)+x},EaseInOut(v,x,_,S){return(v/=S/2)<1?_/2*v*v+x:-_/2*(--v*(v-2)-1)+x},StrongEaseIn(v,x,_,S){return _*(v/=S)*v*v*v*v+x},StrongEaseOut(v,x,_,S){return _*((v=v/S-1)*v*v*v*v+1)+x},StrongEaseInOut(v,x,_,S){return(v/=S/2)<1?_/2*v*v*v*v*v+x:_/2*((v-=2)*v*v*v*v+2)+x},Linear(v,x,_,S){return _*v/S+x}}})(xw)),xw}var $N;function O2(){return $N||($N=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=lr(),r=Zn(),n=si(),i=Mx(),a=az(),s=fM(),o=sz(),l=X_(),u=Y_(),c=Ji(),f=Q_(),g=oz(),v=dM(),x=Px();t.Konva=r.Util._assign(e.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:s.Layer,FastLayer:o.FastLayer,Group:l.Group,DD:u.DD,Shape:c.Shape,shapes:c.shapes,Animation:f.Animation,Tween:g.Tween,Easings:g.Easings,Context:v.Context,Canvas:x.Canvas}),t.default=t.Konva})(hw)),hw}var bm={},KN;function lz(){if(KN)return bm;KN=1,Object.defineProperty(bm,"__esModule",{value:!0}),bm.Arc=void 0;const t=hr(),e=Ji(),r=lr(),n=mr(),i=lr();let a=class extends e.Shape{_sceneFunc(o){const l=r.Konva.getAngle(this.angle()),u=this.clockwise();o.beginPath(),o.arc(0,0,this.outerRadius(),0,l,u),o.arc(0,0,this.innerRadius(),l,0,!u),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}getSelfRect(){const o=this.innerRadius(),l=this.outerRadius(),u=this.clockwise(),c=r.Konva.getAngle(u?360-this.angle():this.angle()),f=Math.cos(Math.min(c,Math.PI)),g=1,v=Math.sin(Math.min(Math.max(Math.PI,c),3*Math.PI/2)),x=Math.sin(Math.min(c,Math.PI/2)),_=f*(f>0?o:l),S=g*l,N=v*(v>0?o:l),k=x*(x>0?l:o);return{x:_,y:u?-1*k:N,width:S-_,height:k-N}}};return bm.Arc=a,a.prototype._centroid=!0,a.prototype.className="Arc",a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,i._registerNode)(a),t.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"clockwise",!1,(0,n.getBooleanValidator)()),bm}var wm={},_m={},ZN;function pM(){if(ZN)return _m;ZN=1,Object.defineProperty(_m,"__esModule",{value:!0}),_m.Line=void 0;const t=hr(),e=lr(),r=Ji(),n=mr();function i(o,l,u,c,f,g,v){const x=Math.sqrt(Math.pow(u-o,2)+Math.pow(c-l,2)),_=Math.sqrt(Math.pow(f-u,2)+Math.pow(g-c,2)),S=v*x/(x+_),N=v*_/(x+_),k=u-S*(f-o),E=c-S*(g-l),T=u+N*(f-o),R=c+N*(g-l);return[k,E,T,R]}function a(o,l){const u=o.length,c=[];for(let f=2;f<u-2;f+=2){const g=i(o[f-2],o[f-1],o[f],o[f+1],o[f+2],o[f+3],l);isNaN(g[0])||(c.push(g[0]),c.push(g[1]),c.push(o[f]),c.push(o[f+1]),c.push(g[2]),c.push(g[3]))}return c}class s extends r.Shape{constructor(l){super(l),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(l){let u=this.points(),c=u.length,f=this.tension(),g=this.closed(),v=this.bezier(),x,_,S;if(c){if(l.beginPath(),l.moveTo(u[0],u[1]),f!==0&&c>4){for(x=this.getTensionPoints(),_=x.length,S=g?0:4,g||l.quadraticCurveTo(x[0],x[1],x[2],x[3]);S<_-2;)l.bezierCurveTo(x[S++],x[S++],x[S++],x[S++],x[S++],x[S++]);g||l.quadraticCurveTo(x[_-2],x[_-1],u[c-2],u[c-1])}else if(v)for(S=2;S<c;)l.bezierCurveTo(u[S++],u[S++],u[S++],u[S++],u[S++],u[S++]);else for(S=2;S<c;S+=2)l.lineTo(u[S],u[S+1]);g?(l.closePath(),l.fillStrokeShape(this)):l.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():a(this.points(),this.tension())}_getTensionPointsClosed(){const l=this.points(),u=l.length,c=this.tension(),f=i(l[u-2],l[u-1],l[0],l[1],l[2],l[3],c),g=i(l[u-4],l[u-3],l[u-2],l[u-1],l[0],l[1],c),v=a(l,c);return[f[2],f[3]].concat(v).concat([g[0],g[1],l[u-2],l[u-1],g[2],g[3],f[0],f[1],l[0],l[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let l=this.points();if(l.length<4)return{x:l[0]||0,y:l[1]||0,width:0,height:0};this.tension()!==0?l=[l[0],l[1],...this._getTensionPoints(),l[l.length-2],l[l.length-1]]:l=this.points();let u=l[0],c=l[0],f=l[1],g=l[1],v,x;for(let _=0;_<l.length/2;_++)v=l[_*2],x=l[_*2+1],u=Math.min(u,v),c=Math.max(c,v),f=Math.min(f,x),g=Math.max(g,x);return{x:u,y:f,width:c-u,height:g-f}}}return _m.Line=s,s.prototype.className="Line",s.prototype._attrsAffectingSize=["points","bezier","tension"],(0,e._registerNode)(s),t.Factory.addGetterSetter(s,"closed",!1),t.Factory.addGetterSetter(s,"bezier",!1),t.Factory.addGetterSetter(s,"tension",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(s,"points",[],(0,n.getNumberArrayValidator)()),_m}var Sm={},bw={},YN;function uz(){return YN||(YN=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(s,o,l)=>{let u,c;const g=l/2;u=0;for(let v=0;v<20;v++)c=g*t.tValues[20][v]+g,u+=t.cValues[20][v]*n(s,o,c);return g*u};t.getCubicArcLength=e;const r=(s,o,l)=>{l===void 0&&(l=1);const u=s[0]-2*s[1]+s[2],c=o[0]-2*o[1]+o[2],f=2*s[1]-2*s[0],g=2*o[1]-2*o[0],v=4*(u*u+c*c),x=4*(u*f+c*g),_=f*f+g*g;if(v===0)return l*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(o[2]-o[0],2));const S=x/(2*v),N=_/v,k=l+S,E=N-S*S,T=k*k+E>0?Math.sqrt(k*k+E):0,R=S*S+E>0?Math.sqrt(S*S+E):0,j=S+Math.sqrt(S*S+E)!==0?E*Math.log(Math.abs((k+T)/(S+R))):0;return Math.sqrt(v)/2*(k*T-S*R+j)};t.getQuadraticArcLength=r;function n(s,o,l){const u=i(1,l,s),c=i(1,l,o),f=u*u+c*c;return Math.sqrt(f)}const i=(s,o,l)=>{const u=l.length-1;let c,f;if(u===0)return 0;if(s===0){f=0;for(let g=0;g<=u;g++)f+=t.binomialCoefficients[u][g]*Math.pow(1-o,u-g)*Math.pow(o,g)*l[g];return f}else{c=new Array(u);for(let g=0;g<u;g++)c[g]=u*(l[g+1]-l[g]);return i(s-1,o,c)}},a=(s,o,l)=>{let u=1,c=s/o,f=(s-l(c))/o,g=0;for(;u>.001;){const v=l(c+f),x=Math.abs(s-v)/o;if(x<u)u=x,c+=f;else{const _=l(c-f),S=Math.abs(s-_)/o;S<u?(u=S,c-=f):f/=2}if(g++,g>500)break}return c};t.t2length=a})(bw)),bw}var XN;function J_(){if(XN)return Sm;XN=1,Object.defineProperty(Sm,"__esModule",{value:!0}),Sm.Path=void 0;const t=hr(),e=Ji(),r=lr(),n=uz();let i=class Ns extends e.Shape{constructor(s){super(s),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Ns.parsePathData(this.data()),this.pathLength=Ns.getPathLength(this.dataArray)}_sceneFunc(s){const o=this.dataArray;s.beginPath();let l=!1;for(let T=0;T<o.length;T++){const R=o[T].command,j=o[T].points;switch(R){case"L":s.lineTo(j[0],j[1]);break;case"M":s.moveTo(j[0],j[1]);break;case"C":s.bezierCurveTo(j[0],j[1],j[2],j[3],j[4],j[5]);break;case"Q":s.quadraticCurveTo(j[0],j[1],j[2],j[3]);break;case"A":var u=j[0],c=j[1],f=j[2],g=j[3],v=j[4],x=j[5],_=j[6],S=j[7],N=f>g?f:g,k=f>g?1:f/g,E=f>g?g/f:1;s.translate(u,c),s.rotate(_),s.scale(k,E),s.arc(0,0,N,v,v+x,1-S),s.scale(1/k,1/E),s.rotate(-_),s.translate(-u,-c);break;case"z":l=!0,s.closePath();break}}!l&&!this.hasFill()?s.strokeShape(this):s.fillStrokeShape(this)}getSelfRect(){let s=[];this.dataArray.forEach(function(v){if(v.command==="A"){const x=v.points[4],_=v.points[5],S=v.points[4]+_;let N=Math.PI/180;if(Math.abs(x-S)<N&&(N=Math.abs(x-S)),_<0)for(let k=x-N;k>S;k-=N){const E=Ns.getPointOnEllipticalArc(v.points[0],v.points[1],v.points[2],v.points[3],k,0);s.push(E.x,E.y)}else for(let k=x+N;k<S;k+=N){const E=Ns.getPointOnEllipticalArc(v.points[0],v.points[1],v.points[2],v.points[3],k,0);s.push(E.x,E.y)}}else if(v.command==="C")for(let x=0;x<=1;x+=.01){const _=Ns.getPointOnCubicBezier(x,v.start.x,v.start.y,v.points[0],v.points[1],v.points[2],v.points[3],v.points[4],v.points[5]);s.push(_.x,_.y)}else s=s.concat(v.points)});let o=s[0],l=s[0],u=s[1],c=s[1],f,g;for(let v=0;v<s.length/2;v++)f=s[v*2],g=s[v*2+1],isNaN(f)||(o=Math.min(o,f),l=Math.max(l,f)),isNaN(g)||(u=Math.min(u,g),c=Math.max(c,g));return{x:o,y:u,width:l-o,height:c-u}}getLength(){return this.pathLength}getPointAtLength(s){return Ns.getPointAtLengthOfDataArray(s,this.dataArray)}static getLineLength(s,o,l,u){return Math.sqrt((l-s)*(l-s)+(u-o)*(u-o))}static getPathLength(s){let o=0;for(let l=0;l<s.length;++l)o+=s[l].pathLength;return o}static getPointAtLengthOfDataArray(s,o){let l,u=0,c=o.length;if(!c)return null;for(;u<c&&s>o[u].pathLength;)s-=o[u].pathLength,++u;if(u===c)return l=o[u-1].points.slice(-2),{x:l[0],y:l[1]};if(s<.01)return l=o[u].points.slice(0,2),{x:l[0],y:l[1]};const f=o[u],g=f.points;switch(f.command){case"L":return Ns.getPointOnLine(s,f.start.x,f.start.y,g[0],g[1]);case"C":return Ns.getPointOnCubicBezier((0,n.t2length)(s,Ns.getPathLength(o),T=>(0,n.getCubicArcLength)([f.start.x,g[0],g[2],g[4]],[f.start.y,g[1],g[3],g[5]],T)),f.start.x,f.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return Ns.getPointOnQuadraticBezier((0,n.t2length)(s,Ns.getPathLength(o),T=>(0,n.getQuadraticArcLength)([f.start.x,g[0],g[2]],[f.start.y,g[1],g[3]],T)),f.start.x,f.start.y,g[0],g[1],g[2],g[3]);case"A":var v=g[0],x=g[1],_=g[2],S=g[3],N=g[4],k=g[5],E=g[6];return N+=k*s/f.pathLength,Ns.getPointOnEllipticalArc(v,x,_,S,N,E)}return null}static getPointOnLine(s,o,l,u,c,f,g){f=f??o,g=g??l;const v=this.getLineLength(o,l,u,c);if(v<1e-10)return{x:o,y:l};if(u===o)return{x:f,y:g+(c>l?s:-s)};const x=(c-l)/(u-o),_=Math.sqrt(s*s/(1+x*x))*(u<o?-1:1),S=x*_;if(Math.abs(g-l-x*(f-o))<1e-10)return{x:f+_,y:g+S};const N=((f-o)*(u-o)+(g-l)*(c-l))/(v*v),k=o+N*(u-o),E=l+N*(c-l),T=this.getLineLength(f,g,k,E),R=Math.sqrt(s*s-T*T),j=Math.sqrt(R*R/(1+x*x))*(u<o?-1:1),D=x*j;return{x:k+j,y:E+D}}static getPointOnCubicBezier(s,o,l,u,c,f,g,v,x){function _(R){return R*R*R}function S(R){return 3*R*R*(1-R)}function N(R){return 3*R*(1-R)*(1-R)}function k(R){return(1-R)*(1-R)*(1-R)}const E=v*_(s)+f*S(s)+u*N(s)+o*k(s),T=x*_(s)+g*S(s)+c*N(s)+l*k(s);return{x:E,y:T}}static getPointOnQuadraticBezier(s,o,l,u,c,f,g){function v(k){return k*k}function x(k){return 2*k*(1-k)}function _(k){return(1-k)*(1-k)}const S=f*v(s)+u*x(s)+o*_(s),N=g*v(s)+c*x(s)+l*_(s);return{x:S,y:N}}static getPointOnEllipticalArc(s,o,l,u,c,f){const g=Math.cos(f),v=Math.sin(f),x={x:l*Math.cos(c),y:u*Math.sin(c)};return{x:s+(x.x*g-x.y*v),y:o+(x.x*v+x.y*g)}}static parsePathData(s){if(!s)return[];let o=s;const l=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];o=o.replace(new RegExp(" ","g"),",");for(var u=0;u<l.length;u++)o=o.replace(new RegExp(l[u],"g"),"|"+l[u]);const c=o.split("|"),f=[],g=[];let v=0,x=0;const _=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let S;for(u=1;u<c.length;u++){let O=c[u],W=O.charAt(0);for(O=O.slice(1),g.length=0;S=_.exec(O);)g.push(S[0]);const F=[];for(let K=0,X=g.length;K<X;K++){if(g[K]==="00"){F.push(0,0);continue}const Q=parseFloat(g[K]);isNaN(Q)?F.push(0):F.push(Q)}for(;F.length>0&&!isNaN(F[0]);){let K="",X=[];const Q=v,ae=x;var N,k,E,T,R,j,D,B,I,V;switch(W){case"l":v+=F.shift(),x+=F.shift(),K="L",X.push(v,x);break;case"L":v=F.shift(),x=F.shift(),X.push(v,x);break;case"m":var $=F.shift(),Z=F.shift();if(v+=$,x+=Z,K="M",f.length>2&&f[f.length-1].command==="z"){for(let re=f.length-2;re>=0;re--)if(f[re].command==="M"){v=f[re].points[0]+$,x=f[re].points[1]+Z;break}}X.push(v,x),W="l";break;case"M":v=F.shift(),x=F.shift(),K="M",X.push(v,x),W="L";break;case"h":v+=F.shift(),K="L",X.push(v,x);break;case"H":v=F.shift(),K="L",X.push(v,x);break;case"v":x+=F.shift(),K="L",X.push(v,x);break;case"V":x=F.shift(),K="L",X.push(v,x);break;case"C":X.push(F.shift(),F.shift(),F.shift(),F.shift()),v=F.shift(),x=F.shift(),X.push(v,x);break;case"c":X.push(v+F.shift(),x+F.shift(),v+F.shift(),x+F.shift()),v+=F.shift(),x+=F.shift(),K="C",X.push(v,x);break;case"S":k=v,E=x,N=f[f.length-1],N.command==="C"&&(k=v+(v-N.points[2]),E=x+(x-N.points[3])),X.push(k,E,F.shift(),F.shift()),v=F.shift(),x=F.shift(),K="C",X.push(v,x);break;case"s":k=v,E=x,N=f[f.length-1],N.command==="C"&&(k=v+(v-N.points[2]),E=x+(x-N.points[3])),X.push(k,E,v+F.shift(),x+F.shift()),v+=F.shift(),x+=F.shift(),K="C",X.push(v,x);break;case"Q":X.push(F.shift(),F.shift()),v=F.shift(),x=F.shift(),X.push(v,x);break;case"q":X.push(v+F.shift(),x+F.shift()),v+=F.shift(),x+=F.shift(),K="Q",X.push(v,x);break;case"T":k=v,E=x,N=f[f.length-1],N.command==="Q"&&(k=v+(v-N.points[0]),E=x+(x-N.points[1])),v=F.shift(),x=F.shift(),K="Q",X.push(k,E,v,x);break;case"t":k=v,E=x,N=f[f.length-1],N.command==="Q"&&(k=v+(v-N.points[0]),E=x+(x-N.points[1])),v+=F.shift(),x+=F.shift(),K="Q",X.push(k,E,v,x);break;case"A":T=F.shift(),R=F.shift(),j=F.shift(),D=F.shift(),B=F.shift(),I=v,V=x,v=F.shift(),x=F.shift(),K="A",X=this.convertEndpointToCenterParameterization(I,V,v,x,D,B,T,R,j);break;case"a":T=F.shift(),R=F.shift(),j=F.shift(),D=F.shift(),B=F.shift(),I=v,V=x,v+=F.shift(),x+=F.shift(),K="A",X=this.convertEndpointToCenterParameterization(I,V,v,x,D,B,T,R,j);break}f.push({command:K||W,points:X,start:{x:Q,y:ae},pathLength:this.calcLength(Q,ae,K||W,X)})}(W==="z"||W==="Z")&&f.push({command:"z",points:[],start:void 0,pathLength:0})}return f}static calcLength(s,o,l,u){let c,f,g,v;const x=Ns;switch(l){case"L":return x.getLineLength(s,o,u[0],u[1]);case"C":return(0,n.getCubicArcLength)([s,u[0],u[2],u[4]],[o,u[1],u[3],u[5]],1);case"Q":return(0,n.getQuadraticArcLength)([s,u[0],u[2]],[o,u[1],u[3]],1);case"A":c=0;var _=u[4],S=u[5],N=u[4]+S,k=Math.PI/180;if(Math.abs(_-N)<k&&(k=Math.abs(_-N)),f=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],_,0),S<0)for(v=_-k;v>N;v-=k)g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],v,0),c+=x.getLineLength(f.x,f.y,g.x,g.y),f=g;else for(v=_+k;v<N;v+=k)g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],v,0),c+=x.getLineLength(f.x,f.y,g.x,g.y),f=g;return g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],N,0),c+=x.getLineLength(f.x,f.y,g.x,g.y),c}return 0}static convertEndpointToCenterParameterization(s,o,l,u,c,f,g,v,x){const _=x*(Math.PI/180),S=Math.cos(_)*(s-l)/2+Math.sin(_)*(o-u)/2,N=-1*Math.sin(_)*(s-l)/2+Math.cos(_)*(o-u)/2,k=S*S/(g*g)+N*N/(v*v);k>1&&(g*=Math.sqrt(k),v*=Math.sqrt(k));let E=Math.sqrt((g*g*(v*v)-g*g*(N*N)-v*v*(S*S))/(g*g*(N*N)+v*v*(S*S)));c===f&&(E*=-1),isNaN(E)&&(E=0);const T=E*g*N/v,R=E*-v*S/g,j=(s+l)/2+Math.cos(_)*T-Math.sin(_)*R,D=(o+u)/2+Math.sin(_)*T+Math.cos(_)*R,B=function(F){return Math.sqrt(F[0]*F[0]+F[1]*F[1])},I=function(F,K){return(F[0]*K[0]+F[1]*K[1])/(B(F)*B(K))},V=function(F,K){return(F[0]*K[1]<F[1]*K[0]?-1:1)*Math.acos(I(F,K))},$=V([1,0],[(S-T)/g,(N-R)/v]),Z=[(S-T)/g,(N-R)/v],O=[(-1*S-T)/g,(-1*N-R)/v];let W=V(Z,O);return I(Z,O)<=-1&&(W=Math.PI),I(Z,O)>=1&&(W=0),f===0&&W>0&&(W=W-2*Math.PI),f===1&&W<0&&(W=W+2*Math.PI),[j,D,g,v,$,W,_,f]}};return Sm.Path=i,i.prototype.className="Path",i.prototype._attrsAffectingSize=["data"],(0,r._registerNode)(i),t.Factory.addGetterSetter(i,"data"),Sm}var QN;function cz(){if(QN)return wm;QN=1,Object.defineProperty(wm,"__esModule",{value:!0}),wm.Arrow=void 0;const t=hr(),e=pM(),r=mr(),n=lr(),i=J_();let a=class extends e.Line{_sceneFunc(o){super._sceneFunc(o);const l=Math.PI*2,u=this.points();let c=u;const f=this.tension()!==0&&u.length>4;f&&(c=this.getTensionPoints());const g=this.pointerLength(),v=u.length;let x,_;if(f){const k=[c[c.length-4],c[c.length-3],c[c.length-2],c[c.length-1],u[v-2],u[v-1]],E=i.Path.calcLength(c[c.length-4],c[c.length-3],"C",k),T=i.Path.getPointOnQuadraticBezier(Math.min(1,1-g/E),k[0],k[1],k[2],k[3],k[4],k[5]);x=u[v-2]-T.x,_=u[v-1]-T.y}else x=u[v-2]-u[v-4],_=u[v-1]-u[v-3];const S=(Math.atan2(_,x)+l)%l,N=this.pointerWidth();this.pointerAtEnding()&&(o.save(),o.beginPath(),o.translate(u[v-2],u[v-1]),o.rotate(S),o.moveTo(0,0),o.lineTo(-g,N/2),o.lineTo(-g,-N/2),o.closePath(),o.restore(),this.__fillStroke(o)),this.pointerAtBeginning()&&(o.save(),o.beginPath(),o.translate(u[0],u[1]),f?(x=(c[0]+c[2])/2-u[0],_=(c[1]+c[3])/2-u[1]):(x=u[2]-u[0],_=u[3]-u[1]),o.rotate((Math.atan2(-_,-x)+l)%l),o.moveTo(0,0),o.lineTo(-g,N/2),o.lineTo(-g,-N/2),o.closePath(),o.restore(),this.__fillStroke(o))}__fillStroke(o){const l=this.dashEnabled();l&&(this.attrs.dashEnabled=!1,o.setLineDash([])),o.fillStrokeShape(this),l&&(this.attrs.dashEnabled=!0)}getSelfRect(){const o=super.getSelfRect(),l=this.pointerWidth()/2;return{x:o.x-l,y:o.y-l,width:o.width+l*2,height:o.height+l*2}}};return wm.Arrow=a,a.prototype.className="Arrow",(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"pointerLength",10,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(a,"pointerWidth",10,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(a,"pointerAtBeginning",!1),t.Factory.addGetterSetter(a,"pointerAtEnding",!0),wm}var km={},JN;function dz(){if(JN)return km;JN=1,Object.defineProperty(km,"__esModule",{value:!0}),km.Circle=void 0;const t=hr(),e=Ji(),r=mr(),n=lr();let i=class extends e.Shape{_sceneFunc(s){s.beginPath(),s.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),s.closePath(),s.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(s){this.radius()!==s/2&&this.radius(s/2)}setHeight(s){this.radius()!==s/2&&this.radius(s/2)}};return km.Circle=i,i.prototype._centroid=!0,i.prototype.className="Circle",i.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(i),t.Factory.addGetterSetter(i,"radius",0,(0,r.getNumberValidator)()),km}var Cm={},e5;function hz(){if(e5)return Cm;e5=1,Object.defineProperty(Cm,"__esModule",{value:!0}),Cm.Ellipse=void 0;const t=hr(),e=Ji(),r=mr(),n=lr();let i=class extends e.Shape{_sceneFunc(s){const o=this.radiusX(),l=this.radiusY();s.beginPath(),s.save(),o!==l&&s.scale(1,l/o),s.arc(0,0,o,0,Math.PI*2,!1),s.restore(),s.closePath(),s.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(s){this.radiusX(s/2)}setHeight(s){this.radiusY(s/2)}};return Cm.Ellipse=i,i.prototype.className="Ellipse",i.prototype._centroid=!0,i.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(i),t.Factory.addComponentsGetterSetter(i,"radius",["x","y"]),t.Factory.addGetterSetter(i,"radiusX",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,"radiusY",0,(0,r.getNumberValidator)()),Cm}var Em={},t5;function fz(){if(t5)return Em;t5=1,Object.defineProperty(Em,"__esModule",{value:!0}),Em.Image=void 0;const t=Zn(),e=hr(),r=Ji(),n=lr(),i=mr();class a extends r.Shape{constructor(o){super(o),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const o=this.image();o&&o.complete||o&&o.readyState===4||o&&o.addEventListener&&o.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){const o=!!this.cornerRadius(),l=this.hasShadow();return o&&l?!0:super._useBufferCanvas(!0)}_sceneFunc(o){const l=this.getWidth(),u=this.getHeight(),c=this.cornerRadius(),f=this.attrs.image;let g;if(f){const v=this.attrs.cropWidth,x=this.attrs.cropHeight;v&&x?g=[f,this.cropX(),this.cropY(),v,x,0,0,l,u]:g=[f,0,0,l,u]}(this.hasFill()||this.hasStroke()||c)&&(o.beginPath(),c?t.Util.drawRoundedRectPath(o,l,u,c):o.rect(0,0,l,u),o.closePath(),o.fillStrokeShape(this)),f&&(c&&o.clip(),o.drawImage.apply(o,g))}_hitFunc(o){const l=this.width(),u=this.height(),c=this.cornerRadius();o.beginPath(),c?t.Util.drawRoundedRectPath(o,l,u,c):o.rect(0,0,l,u),o.closePath(),o.fillStrokeShape(this)}getWidth(){var o,l;return(o=this.attrs.width)!==null&&o!==void 0?o:(l=this.image())===null||l===void 0?void 0:l.width}getHeight(){var o,l;return(o=this.attrs.height)!==null&&o!==void 0?o:(l=this.image())===null||l===void 0?void 0:l.height}static fromURL(o,l,u=null){const c=t.Util.createImageElement();c.onload=function(){const f=new a({image:c});l(f)},c.onerror=u,c.crossOrigin="Anonymous",c.src=o}}return Em.Image=a,a.prototype.className="Image",(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),e.Factory.addGetterSetter(a,"image"),e.Factory.addComponentsGetterSetter(a,"crop",["x","y","width","height"]),e.Factory.addGetterSetter(a,"cropX",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(a,"cropY",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(a,"cropWidth",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(a,"cropHeight",0,(0,i.getNumberValidator)()),Em}var fh={},r5;function pz(){if(r5)return fh;r5=1,Object.defineProperty(fh,"__esModule",{value:!0}),fh.Tag=fh.Label=void 0;const t=hr(),e=Ji(),r=X_(),n=mr(),i=lr(),a=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],s="Change.konva",o="none",l="up",u="right",c="down",f="left",g=a.length;let v=class extends r.Group{constructor(S){super(S),this.on("add.konva",function(N){this._addListeners(N.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(S){let N=this,k;const E=function(){N._sync()};for(k=0;k<g;k++)S.on(a[k]+s,E)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let S=this.getText(),N=this.getTag(),k,E,T,R,j,D,B;if(S&&N){switch(k=S.width(),E=S.height(),T=N.pointerDirection(),R=N.pointerWidth(),B=N.pointerHeight(),j=0,D=0,T){case l:j=k/2,D=-1*B;break;case u:j=k+R,D=E/2;break;case c:j=k/2,D=E+B;break;case f:j=-1*R,D=E/2;break}N.setAttrs({x:-1*j,y:-1*D,width:k,height:E}),S.setAttrs({x:-1*j,y:-1*D})}}};fh.Label=v,v.prototype.className="Label",(0,i._registerNode)(v);class x extends e.Shape{_sceneFunc(S){const N=this.width(),k=this.height(),E=this.pointerDirection(),T=this.pointerWidth(),R=this.pointerHeight(),j=this.cornerRadius();let D=0,B=0,I=0,V=0;typeof j=="number"?D=B=I=V=Math.min(j,N/2,k/2):(D=Math.min(j[0]||0,N/2,k/2),B=Math.min(j[1]||0,N/2,k/2),V=Math.min(j[2]||0,N/2,k/2),I=Math.min(j[3]||0,N/2,k/2)),S.beginPath(),S.moveTo(D,0),E===l&&(S.lineTo((N-T)/2,0),S.lineTo(N/2,-1*R),S.lineTo((N+T)/2,0)),S.lineTo(N-B,0),S.arc(N-B,B,B,Math.PI*3/2,0,!1),E===u&&(S.lineTo(N,(k-R)/2),S.lineTo(N+T,k/2),S.lineTo(N,(k+R)/2)),S.lineTo(N,k-V),S.arc(N-V,k-V,V,0,Math.PI/2,!1),E===c&&(S.lineTo((N+T)/2,k),S.lineTo(N/2,k+R),S.lineTo((N-T)/2,k)),S.lineTo(I,k),S.arc(I,k-I,I,Math.PI/2,Math.PI,!1),E===f&&(S.lineTo(0,(k+R)/2),S.lineTo(-1*T,k/2),S.lineTo(0,(k-R)/2)),S.lineTo(0,D),S.arc(D,D,D,Math.PI,Math.PI*3/2,!1),S.closePath(),S.fillStrokeShape(this)}getSelfRect(){let S=0,N=0,k=this.pointerWidth(),E=this.pointerHeight(),T=this.pointerDirection(),R=this.width(),j=this.height();return T===l?(N-=E,j+=E):T===c?j+=E:T===f?(S-=k*1.5,R+=k):T===u&&(R+=k*1.5),{x:S,y:N,width:R,height:j}}}return fh.Tag=x,x.prototype.className="Tag",(0,i._registerNode)(x),t.Factory.addGetterSetter(x,"pointerDirection",o),t.Factory.addGetterSetter(x,"pointerWidth",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(x,"pointerHeight",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(x,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),fh}var Nm={},n5;function mM(){if(n5)return Nm;n5=1,Object.defineProperty(Nm,"__esModule",{value:!0}),Nm.Rect=void 0;const t=hr(),e=Ji(),r=lr(),n=Zn(),i=mr();class a extends e.Shape{_sceneFunc(o){const l=this.cornerRadius(),u=this.width(),c=this.height();o.beginPath(),l?n.Util.drawRoundedRectPath(o,u,c,l):o.rect(0,0,u,c),o.closePath(),o.fillStrokeShape(this)}}return Nm.Rect=a,a.prototype.className="Rect",(0,r._registerNode)(a),t.Factory.addGetterSetter(a,"cornerRadius",0,(0,i.getNumberOrArrayOfNumbersValidator)(4)),Nm}var Tm={},i5;function mz(){if(i5)return Tm;i5=1,Object.defineProperty(Tm,"__esModule",{value:!0}),Tm.RegularPolygon=void 0;const t=hr(),e=Ji(),r=mr(),n=lr();let i=class extends e.Shape{_sceneFunc(s){const o=this._getPoints();s.beginPath(),s.moveTo(o[0].x,o[0].y);for(let l=1;l<o.length;l++)s.lineTo(o[l].x,o[l].y);s.closePath(),s.fillStrokeShape(this)}_getPoints(){const s=this.attrs.sides,o=this.attrs.radius||0,l=[];for(let u=0;u<s;u++)l.push({x:o*Math.sin(u*2*Math.PI/s),y:-1*o*Math.cos(u*2*Math.PI/s)});return l}getSelfRect(){const s=this._getPoints();let o=s[0].x,l=s[0].y,u=s[0].x,c=s[0].y;return s.forEach(f=>{o=Math.min(o,f.x),l=Math.max(l,f.x),u=Math.min(u,f.y),c=Math.max(c,f.y)}),{x:o,y:u,width:l-o,height:c-u}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(s){this.radius(s/2)}setHeight(s){this.radius(s/2)}};return Tm.RegularPolygon=i,i.prototype.className="RegularPolygon",i.prototype._centroid=!0,i.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(i),t.Factory.addGetterSetter(i,"radius",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,"sides",0,(0,r.getNumberValidator)()),Tm}var Pm={},a5;function gz(){if(a5)return Pm;a5=1,Object.defineProperty(Pm,"__esModule",{value:!0}),Pm.Ring=void 0;const t=hr(),e=Ji(),r=mr(),n=lr(),i=Math.PI*2;let a=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.innerRadius(),0,i,!1),o.moveTo(this.outerRadius(),0),o.arc(0,0,this.outerRadius(),i,0,!0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}};return Pm.Ring=a,a.prototype.className="Ring",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"innerRadius",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(a,"outerRadius",0,(0,r.getNumberValidator)()),Pm}var Mm={},s5;function vz(){if(s5)return Mm;s5=1,Object.defineProperty(Mm,"__esModule",{value:!0}),Mm.Sprite=void 0;const t=hr(),e=Ji(),r=Q_(),n=mr(),i=lr();let a=class extends e.Shape{constructor(o){super(o),this._updated=!0,this.anim=new r.Animation(()=>{const l=this._updated;return this._updated=!1,l}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(o){const l=this.animation(),u=this.frameIndex(),c=u*4,f=this.animations()[l],g=this.frameOffsets(),v=f[c+0],x=f[c+1],_=f[c+2],S=f[c+3],N=this.image();if((this.hasFill()||this.hasStroke())&&(o.beginPath(),o.rect(0,0,_,S),o.closePath(),o.fillStrokeShape(this)),N)if(g){const k=g[l],E=u*2;o.drawImage(N,v,x,_,S,k[E+0],k[E+1],_,S)}else o.drawImage(N,v,x,_,S,0,0,_,S)}_hitFunc(o){const l=this.animation(),u=this.frameIndex(),c=u*4,f=this.animations()[l],g=this.frameOffsets(),v=f[c+2],x=f[c+3];if(o.beginPath(),g){const _=g[l],S=u*2;o.rect(_[S+0],_[S+1],v,x)}else o.rect(0,0,v,x);o.closePath(),o.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const o=this;this.interval=setInterval(function(){o._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const o=this.getLayer();this.anim.setLayers(o),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const o=this.frameIndex(),l=this.animation(),u=this.animations(),c=u[l],f=c.length/4;o<f-1?this.frameIndex(o+1):this.frameIndex(0)}};return Mm.Sprite=a,a.prototype.className="Sprite",(0,i._registerNode)(a),t.Factory.addGetterSetter(a,"animation"),t.Factory.addGetterSetter(a,"animations"),t.Factory.addGetterSetter(a,"frameOffsets"),t.Factory.addGetterSetter(a,"image"),t.Factory.addGetterSetter(a,"frameIndex",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"frameRate",17,(0,n.getNumberValidator)()),t.Factory.backCompat(a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Mm}var Am={},o5;function yz(){if(o5)return Am;o5=1,Object.defineProperty(Am,"__esModule",{value:!0}),Am.Star=void 0;const t=hr(),e=Ji(),r=mr(),n=lr();let i=class extends e.Shape{_sceneFunc(s){const o=this.innerRadius(),l=this.outerRadius(),u=this.numPoints();s.beginPath(),s.moveTo(0,0-l);for(let c=1;c<u*2;c++){const f=c%2===0?l:o,g=f*Math.sin(c*Math.PI/u),v=-1*f*Math.cos(c*Math.PI/u);s.lineTo(g,v)}s.closePath(),s.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(s){this.outerRadius(s/2)}setHeight(s){this.outerRadius(s/2)}};return Am.Star=i,i.prototype.className="Star",i.prototype._centroid=!0,i.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(i),t.Factory.addGetterSetter(i,"numPoints",5,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,"innerRadius",0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,"outerRadius",0,(0,r.getNumberValidator)()),Am}var Vf={},l5;function gM(){if(l5)return Vf;l5=1,Object.defineProperty(Vf,"__esModule",{value:!0}),Vf.Text=void 0,Vf.stringToArray=s;const t=Zn(),e=hr(),r=Ji(),n=lr(),i=mr(),a=lr();function s(te){return[...te].reduce((ne,de,me,ye)=>(new RegExp("\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?(?:\\u200D\\p{Emoji_Presentation})+","u").test(de)?ne.push(de):new RegExp("\\p{Regional_Indicator}{2}","u").test(de+(ye[me+1]||""))?ne.push(de+ye[me+1]):me>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(de)?ne[ne.length-1]+=de:ne.push(de),ne),[])}const o="auto",l="center",u="inherit",c="justify",f="Change.konva",g="2d",v="-",x="left",_="text",S="Text",N="top",k="bottom",E="middle",T="normal",R="px ",j=" ",D="right",B="rtl",I="word",V="char",$="none",Z="",O=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],W=O.length;function F(te){return te.split(",").map(ne=>{ne=ne.trim();const de=ne.indexOf(" ")>=0,me=ne.indexOf('"')>=0||ne.indexOf("'")>=0;return de&&!me&&(ne=`"${ne}"`),ne}).join(", ")}let K;function X(){return K||(K=t.Util.createCanvasElement().getContext(g),K)}function Q(te){te.fillText(this._partialText,this._partialTextX,this._partialTextY)}function ae(te){te.setAttr("miterLimit",2),te.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function re(te){return te=te||{},!te.fillLinearGradientColorStops&&!te.fillRadialGradientColorStops&&!te.fillPatternImage&&(te.fill=te.fill||"black"),te}class G extends r.Shape{constructor(ne){super(re(ne)),this._partialTextX=0,this._partialTextY=0;for(let de=0;de<W;de++)this.on(O[de]+f,this._setTextData);this._setTextData()}_sceneFunc(ne){const de=this.textArr,me=de.length;if(!this.text())return;let ye=this.padding(),ie=this.fontSize(),pe=this.lineHeight()*ie,oe=this.verticalAlign(),fe=this.direction(),ge=0,be=this.align(),_e=this.getWidth(),De=this.letterSpacing(),qe=this.fill(),Ue=this.textDecoration(),Ve=Ue.indexOf("underline")!==-1,Je=Ue.indexOf("line-through")!==-1,ft;fe=fe===u?ne.direction:fe;let We=pe/2,Ce=E;if(n.Konva._fixTextRendering){const st=this.measureSize("M");Ce="alphabetic",We=(st.fontBoundingBoxAscent-st.fontBoundingBoxDescent)/2+pe/2}var ze=0,Ke=0;for(fe===B&&ne.setAttr("direction",fe),ne.setAttr("font",this._getContextFont()),ne.setAttr("textBaseline",Ce),ne.setAttr("textAlign",x),oe===E?ge=(this.getHeight()-me*pe-ye*2)/2:oe===k&&(ge=this.getHeight()-me*pe-ye*2),ne.translate(ye,ge+ye),ft=0;ft<me;ft++){var ze=0,Ke=0,et=de[ft],ht=et.text,Nt=et.width,Mt=et.lastInParagraph,jt,Wt,xt;if(ne.save(),be===D?ze+=_e-Nt-ye*2:be===l&&(ze+=(_e-Nt-ye*2)/2),Ve){ne.save(),ne.beginPath();const ue=n.Konva._fixTextRendering?Math.round(ie/4):Math.round(ie/2),ve=ze,ke=We+Ke+ue;ne.moveTo(ve,ke),jt=ht.split(" ").length-1,Wt=jt===0,xt=be===c&&!Mt?_e-ye*2:Nt,ne.lineTo(ve+Math.round(xt),ke),ne.lineWidth=ie/15;const Ne=this._getLinearGradient();ne.strokeStyle=Ne||qe,ne.stroke(),ne.restore()}if(Je){ne.save(),ne.beginPath();const ue=n.Konva._fixTextRendering?-Math.round(ie/4):0;ne.moveTo(ze,We+Ke+ue),jt=ht.split(" ").length-1,Wt=jt===0,xt=be===c&&Mt&&!Wt?_e-ye*2:Nt,ne.lineTo(ze+Math.round(xt),We+Ke+ue),ne.lineWidth=ie/15;const ve=this._getLinearGradient();ne.strokeStyle=ve||qe,ne.stroke(),ne.restore()}if(fe!==B&&(De!==0||be===c)){jt=ht.split(" ").length-1;const ue=s(ht);for(let ve=0;ve<ue.length;ve++){const ke=ue[ve];ke===" "&&!Mt&&be===c&&(ze+=(_e-ye*2-Nt)/jt),this._partialTextX=ze,this._partialTextY=We+Ke,this._partialText=ke,ne.fillStrokeShape(this),ze+=this.measureSize(ke).width+De}}else De!==0&&ne.setAttr("letterSpacing",`${De}px`),this._partialTextX=ze,this._partialTextY=We+Ke,this._partialText=ht,ne.fillStrokeShape(this);ne.restore(),me>1&&(We+=pe)}}_hitFunc(ne){const de=this.getWidth(),me=this.getHeight();ne.beginPath(),ne.rect(0,0,de,me),ne.closePath(),ne.fillStrokeShape(this)}setText(ne){const de=t.Util._isString(ne)?ne:ne==null?"":ne+"";return this._setAttr(_,de),this}getWidth(){return this.attrs.width===o||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===o||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(ne){var de,me,ye,ie,pe,oe,fe,ge,be,_e,De;let qe=X(),Ue=this.fontSize(),Ve;qe.save(),qe.font=this._getContextFont(),Ve=qe.measureText(ne),qe.restore();const Je=Ue/100;return{actualBoundingBoxAscent:(de=Ve.actualBoundingBoxAscent)!==null&&de!==void 0?de:71.58203125*Je,actualBoundingBoxDescent:(me=Ve.actualBoundingBoxDescent)!==null&&me!==void 0?me:0,actualBoundingBoxLeft:(ye=Ve.actualBoundingBoxLeft)!==null&&ye!==void 0?ye:-7.421875*Je,actualBoundingBoxRight:(ie=Ve.actualBoundingBoxRight)!==null&&ie!==void 0?ie:75.732421875*Je,alphabeticBaseline:(pe=Ve.alphabeticBaseline)!==null&&pe!==void 0?pe:0,emHeightAscent:(oe=Ve.emHeightAscent)!==null&&oe!==void 0?oe:100*Je,emHeightDescent:(fe=Ve.emHeightDescent)!==null&&fe!==void 0?fe:-20*Je,fontBoundingBoxAscent:(ge=Ve.fontBoundingBoxAscent)!==null&&ge!==void 0?ge:91*Je,fontBoundingBoxDescent:(be=Ve.fontBoundingBoxDescent)!==null&&be!==void 0?be:21*Je,hangingBaseline:(_e=Ve.hangingBaseline)!==null&&_e!==void 0?_e:72.80000305175781*Je,ideographicBaseline:(De=Ve.ideographicBaseline)!==null&&De!==void 0?De:-21*Je,width:Ve.width,height:Ue}}_getContextFont(){return this.fontStyle()+j+this.fontVariant()+j+(this.fontSize()+R)+F(this.fontFamily())}_addTextLine(ne){this.align()===c&&(ne=ne.trim());const me=this._getTextWidth(ne);return this.textArr.push({text:ne,width:me,lastInParagraph:!1})}_getTextWidth(ne){const de=this.letterSpacing(),me=ne.length;return X().measureText(ne).width+(me?de*(me-1):0)}_setTextData(){let ne=this.text().split(`
`),de=+this.fontSize(),me=0,ye=this.lineHeight()*de,ie=this.attrs.width,pe=this.attrs.height,oe=ie!==o&&ie!==void 0,fe=pe!==o&&pe!==void 0,ge=this.padding(),be=ie-ge*2,_e=pe-ge*2,De=0,qe=this.wrap(),Ue=qe!==$,Ve=qe!==V&&Ue,Je=this.ellipsis();this.textArr=[],X().font=this._getContextFont();const ft=Je?this._getTextWidth(Z):0;for(let Ce=0,ze=ne.length;Ce<ze;++Ce){let Ke=ne[Ce],et=this._getTextWidth(Ke);if(oe&&et>be)for(;Ke.length>0;){let ht=0,Nt=Ke.length,Mt="",jt=0;for(;ht<Nt;){const Wt=ht+Nt>>>1,xt=Ke.slice(0,Wt+1),st=this._getTextWidth(xt)+ft;st<=be?(ht=Wt+1,Mt=xt,jt=st):Nt=Wt}if(Mt){if(Ve){var We;const xt=Ke[Mt.length];(xt===j||xt===v)&&jt<=be?We=Mt.length:We=Math.max(Mt.lastIndexOf(j),Mt.lastIndexOf(v))+1,We>0&&(ht=We,Mt=Mt.slice(0,ht),jt=this._getTextWidth(Mt))}if(Mt=Mt.trimRight(),this._addTextLine(Mt),me=Math.max(me,jt),De+=ye,this._shouldHandleEllipsis(De)){this._tryToAddEllipsisToLastLine();break}if(Ke=Ke.slice(ht),Ke=Ke.trimLeft(),Ke.length>0&&(et=this._getTextWidth(Ke),et<=be)){this._addTextLine(Ke),De+=ye,me=Math.max(me,et);break}}else break}else this._addTextLine(Ke),De+=ye,me=Math.max(me,et),this._shouldHandleEllipsis(De)&&Ce<ze-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),fe&&De+ye>_e)break}this.textHeight=de,this.textWidth=me}_shouldHandleEllipsis(ne){const de=+this.fontSize(),me=this.lineHeight()*de,ye=this.attrs.height,ie=ye!==o&&ye!==void 0,pe=this.padding(),oe=ye-pe*2;return!(this.wrap()!==$)||ie&&ne+me>oe}_tryToAddEllipsisToLastLine(){const ne=this.attrs.width,de=ne!==o&&ne!==void 0,me=this.padding(),ye=ne-me*2,ie=this.ellipsis(),pe=this.textArr[this.textArr.length-1];!pe||!ie||(de&&(this._getTextWidth(pe.text+Z)<ye||(pe.text=pe.text.slice(0,pe.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(pe.text+Z))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const ne=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,de=this.hasShadow();return ne&&de?!0:super._useBufferCanvas()}}return Vf.Text=G,G.prototype._fillFunc=Q,G.prototype._strokeFunc=ae,G.prototype.className=S,G.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,a._registerNode)(G),e.Factory.overWriteSetter(G,"width",(0,i.getNumberOrAutoValidator)()),e.Factory.overWriteSetter(G,"height",(0,i.getNumberOrAutoValidator)()),e.Factory.addGetterSetter(G,"direction",u),e.Factory.addGetterSetter(G,"fontFamily","Arial"),e.Factory.addGetterSetter(G,"fontSize",12,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(G,"fontStyle",T),e.Factory.addGetterSetter(G,"fontVariant",T),e.Factory.addGetterSetter(G,"padding",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(G,"align",x),e.Factory.addGetterSetter(G,"verticalAlign",N),e.Factory.addGetterSetter(G,"lineHeight",1,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(G,"wrap",I),e.Factory.addGetterSetter(G,"ellipsis",!1,(0,i.getBooleanValidator)()),e.Factory.addGetterSetter(G,"letterSpacing",0,(0,i.getNumberValidator)()),e.Factory.addGetterSetter(G,"text","",(0,i.getStringValidator)()),e.Factory.addGetterSetter(G,"textDecoration",""),Vf}var jm={},u5;function xz(){if(u5)return jm;u5=1,Object.defineProperty(jm,"__esModule",{value:!0}),jm.TextPath=void 0;const t=Zn(),e=hr(),r=Ji(),n=J_(),i=gM(),a=mr(),s=lr(),o="",l="normal";function u(g){g.fillText(this.partialText,0,0)}function c(g){g.strokeText(this.partialText,0,0)}let f=class extends r.Shape{constructor(v){super(v),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(v){if(!this.attrs.data)return null;const x=this.pathLength;return v-1>x?null:n.Path.getPointAtLengthOfDataArray(v,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(v){v.setAttr("font",this._getContextFont()),v.setAttr("textBaseline",this.textBaseline()),v.setAttr("textAlign","left"),v.save();const x=this.textDecoration(),_=this.fill(),S=this.fontSize(),N=this.glyphInfo;x==="underline"&&v.beginPath();for(let k=0;k<N.length;k++){v.save();const E=N[k].p0;v.translate(E.x,E.y),v.rotate(N[k].rotation),this.partialText=N[k].text,v.fillStrokeShape(this),x==="underline"&&(k===0&&v.moveTo(0,S/2+1),v.lineTo(S,S/2+1)),v.restore()}x==="underline"&&(v.strokeStyle=_,v.lineWidth=S/20,v.stroke()),v.restore()}_hitFunc(v){v.beginPath();const x=this.glyphInfo;if(x.length>=1){const _=x[0].p0;v.moveTo(_.x,_.y)}for(let _=0;_<x.length;_++){const S=x[_].p1;v.lineTo(S.x,S.y)}v.setAttr("lineWidth",this.fontSize()),v.setAttr("strokeStyle",this.colorKey),v.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(v){return i.Text.prototype.setText.call(this,v)}_getContextFont(){return i.Text.prototype._getContextFont.call(this)}_getTextSize(v){const _=this.dummyCanvas.getContext("2d");_.save(),_.font=this._getContextFont();const S=_.measureText(v);return _.restore(),{width:S.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:v,height:x}=this._getTextSize(this.attrs.text);if(this.textWidth=v,this.textHeight=x,this.glyphInfo=[],!this.attrs.data)return null;const _=this.letterSpacing(),S=this.align(),N=this.kerningFunc(),k=Math.max(this.textWidth+((this.attrs.text||"").length-1)*_,0);let E=0;S==="center"&&(E=Math.max(0,this.pathLength/2-k/2)),S==="right"&&(E=Math.max(0,this.pathLength-k));const T=(0,i.stringToArray)(this.text());let R=E;for(let j=0;j<T.length;j++){const D=this._getPointAtLength(R);if(!D)return;let B=this._getTextSize(T[j]).width+_;if(T[j]===" "&&S==="justify"){const W=this.text().split(" ").length-1;B+=(this.pathLength-k)/W}const I=this._getPointAtLength(R+B);if(!I)return;const V=n.Path.getLineLength(D.x,D.y,I.x,I.y);let $=0;if(N)try{$=N(T[j-1],T[j])*this.fontSize()}catch{$=0}D.x+=$,I.x+=$,this.textWidth+=$;const Z=n.Path.getPointOnLine($+V/2,D.x,D.y,I.x,I.y),O=Math.atan2(I.y-D.y,I.x-D.x);this.glyphInfo.push({transposeX:Z.x,transposeY:Z.y,text:T[j],rotation:O,p0:D,p1:I}),R+=B}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const v=[];this.glyphInfo.forEach(function(R){v.push(R.p0.x),v.push(R.p0.y),v.push(R.p1.x),v.push(R.p1.y)});let x=v[0]||0,_=v[0]||0,S=v[1]||0,N=v[1]||0,k,E;for(let R=0;R<v.length/2;R++)k=v[R*2],E=v[R*2+1],x=Math.min(x,k),_=Math.max(_,k),S=Math.min(S,E),N=Math.max(N,E);const T=this.fontSize();return{x:x-T/2,y:S-T/2,width:_-x+T,height:N-S+T}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};return jm.TextPath=f,f.prototype._fillFunc=u,f.prototype._strokeFunc=c,f.prototype._fillFuncHit=u,f.prototype._strokeFuncHit=c,f.prototype.className="TextPath",f.prototype._attrsAffectingSize=["text","fontSize","data"],(0,s._registerNode)(f),e.Factory.addGetterSetter(f,"data"),e.Factory.addGetterSetter(f,"fontFamily","Arial"),e.Factory.addGetterSetter(f,"fontSize",12,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(f,"fontStyle",l),e.Factory.addGetterSetter(f,"align","left"),e.Factory.addGetterSetter(f,"letterSpacing",0,(0,a.getNumberValidator)()),e.Factory.addGetterSetter(f,"textBaseline","middle"),e.Factory.addGetterSetter(f,"fontVariant",l),e.Factory.addGetterSetter(f,"text",o),e.Factory.addGetterSetter(f,"textDecoration",null),e.Factory.addGetterSetter(f,"kerningFunc",null),jm}var Rm={},c5;function bz(){if(c5)return Rm;c5=1,Object.defineProperty(Rm,"__esModule",{value:!0}),Rm.Transformer=void 0;const t=Zn(),e=hr(),r=si(),n=Ji(),i=mM(),a=X_(),s=lr(),o=mr(),l=lr(),u="tr-konva",c=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(B=>B+`.${u}`).join(" "),f="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],v={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},x="ontouchstart"in s.Konva._global;function _(B,I,V){if(B==="rotater")return V;I+=t.Util.degToRad(v[B]||0);const $=(t.Util.radToDeg(I)%360+360)%360;return t.Util._inRange($,315+22.5,360)||t.Util._inRange($,0,22.5)?"ns-resize":t.Util._inRange($,45-22.5,45+22.5)?"nesw-resize":t.Util._inRange($,90-22.5,90+22.5)?"ew-resize":t.Util._inRange($,135-22.5,135+22.5)?"nwse-resize":t.Util._inRange($,180-22.5,180+22.5)?"ns-resize":t.Util._inRange($,225-22.5,225+22.5)?"nesw-resize":t.Util._inRange($,270-22.5,270+22.5)?"ew-resize":t.Util._inRange($,315-22.5,315+22.5)?"nwse-resize":(t.Util.error("Transformer has unknown angle for cursor detection: "+$),"pointer")}const S=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function N(B){return{x:B.x+B.width/2*Math.cos(B.rotation)+B.height/2*Math.sin(-B.rotation),y:B.y+B.height/2*Math.cos(B.rotation)+B.width/2*Math.sin(B.rotation)}}function k(B,I,V){const $=V.x+(B.x-V.x)*Math.cos(I)-(B.y-V.y)*Math.sin(I),Z=V.y+(B.x-V.x)*Math.sin(I)+(B.y-V.y)*Math.cos(I);return{...B,rotation:B.rotation+I,x:$,y:Z}}function E(B,I){const V=N(B);return k(B,I,V)}function T(B,I,V){let $=I;for(let Z=0;Z<B.length;Z++){const O=s.Konva.getAngle(B[Z]),W=Math.abs(O-I)%(Math.PI*2);Math.min(W,Math.PI*2-W)<V&&($=O)}return $}let R=0;class j extends a.Group{constructor(I){super(I),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(c,this.update),this.getNode()&&this.update()}attachTo(I){return this.setNode(I),this}setNode(I){return t.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([I])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return u+this._id}setNodes(I=[]){this._nodes&&this._nodes.length&&this.detach();const V=I.filter(Z=>Z.isAncestorOf(this)?(t.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=I=V,I.length===1&&this.useSingleNodeRotation()?this.rotation(I[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(Z=>{const O=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},W=Z._attrsAffectingSize.map(F=>F+"Change."+this._getEventNamespace()).join(" ");Z.on(W,O),Z.on(g.map(F=>F+`.${this._getEventNamespace()}`).join(" "),O),Z.on(`absoluteTransformChange.${this._getEventNamespace()}`,O),this._proxyDrag(Z)}),this._resetTransformCache(),this.findOne(".top-left")&&this.update(),this}_proxyDrag(I){let V;I.on(`dragstart.${this._getEventNamespace()}`,$=>{V=I.getAbsolutePosition(),!this.isDragging()&&I!==this.findOne(".back")&&this.startDrag($,!1)}),I.on(`dragmove.${this._getEventNamespace()}`,$=>{if(!V)return;const Z=I.getAbsolutePosition(),O=Z.x-V.x,W=Z.y-V.y;this.nodes().forEach(F=>{if(F===I||F.isDragging())return;const K=F.getAbsolutePosition();F.setAbsolutePosition({x:K.x+O,y:K.y+W}),F.startDrag($)}),V=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(I=>{I.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(f),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(f,this.__getNodeRect)}__getNodeShape(I,V=this.rotation(),$){const Z=I.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),O=I.getAbsoluteScale($),W=I.getAbsolutePosition($),F=Z.x*O.x-I.offsetX()*O.x,K=Z.y*O.y-I.offsetY()*O.y,X=(s.Konva.getAngle(I.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),Q={x:W.x+F*Math.cos(X)+K*Math.sin(-X),y:W.y+K*Math.cos(X)+F*Math.sin(X),width:Z.width*O.x,height:Z.height*O.y,rotation:X};return k(Q,-s.Konva.getAngle(V),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const V=[];this.nodes().map(X=>{const Q=X.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),ae=[{x:Q.x,y:Q.y},{x:Q.x+Q.width,y:Q.y},{x:Q.x+Q.width,y:Q.y+Q.height},{x:Q.x,y:Q.y+Q.height}],re=X.getAbsoluteTransform();ae.forEach(function(G){const te=re.point(G);V.push(te)})});const $=new t.Transform;$.rotate(-s.Konva.getAngle(this.rotation()));let Z=1/0,O=1/0,W=-1/0,F=-1/0;V.forEach(function(X){const Q=$.point(X);Z===void 0&&(Z=W=Q.x,O=F=Q.y),Z=Math.min(Z,Q.x),O=Math.min(O,Q.y),W=Math.max(W,Q.x),F=Math.max(F,Q.y)}),$.invert();const K=$.point({x:Z,y:O});return{x:K.x,y:K.y,width:W-Z,height:F-O,rotation:s.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),S.forEach(I=>{this._createAnchor(I)}),this._createAnchor("rotater")}_createAnchor(I){const V=new i.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:I+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:x?10:"auto"}),$=this;V.on("mousedown touchstart",function(Z){$._handleMouseDown(Z)}),V.on("dragstart",Z=>{V.stopDrag(),Z.cancelBubble=!0}),V.on("dragend",Z=>{Z.cancelBubble=!0}),V.on("mouseenter",()=>{const Z=s.Konva.getAngle(this.rotation()),O=this.rotateAnchorCursor(),W=_(I,Z,O);V.getStage().content&&(V.getStage().content.style.cursor=W),this._cursorChange=!0}),V.on("mouseout",()=>{V.getStage().content&&(V.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(V)}_createBack(){const I=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(V,$){const Z=$.getParent(),O=Z.padding();V.beginPath(),V.rect(-O,-O,$.width()+O*2,$.height()+O*2),V.moveTo($.width()/2,-O),Z.rotateEnabled()&&Z.rotateLineVisible()&&V.lineTo($.width()/2,-Z.rotateAnchorOffset()*t.Util._sign($.height())-O),V.fillStrokeShape($)},hitFunc:(V,$)=>{if(!this.shouldOverdrawWholeArea())return;const Z=this.padding();V.beginPath(),V.rect(-Z,-Z,$.width()+Z*2,$.height()+Z*2),V.fillStrokeShape($)}});this.add(I),this._proxyDrag(I),I.on("dragstart",V=>{V.cancelBubble=!0}),I.on("dragmove",V=>{V.cancelBubble=!0}),I.on("dragend",V=>{V.cancelBubble=!0}),this.on("dragmove",V=>{this.update()})}_handleMouseDown(I){if(this._transforming)return;this._movingAnchorName=I.target.name().split(" ")[0];const V=this._getNodeRect(),$=V.width,Z=V.height,O=Math.sqrt(Math.pow($,2)+Math.pow(Z,2));this.sin=Math.abs(Z/O),this.cos=Math.abs($/O),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const W=I.target.getAbsolutePosition(),F=I.target.getStage().getPointerPosition();this._anchorDragOffset={x:F.x-W.x,y:F.y-W.y},R++,this._fire("transformstart",{evt:I.evt,target:this.getNode()}),this._nodes.forEach(K=>{K._fire("transformstart",{evt:I.evt,target:K})})}_handleMouseMove(I){let V,$,Z;const O=this.findOne("."+this._movingAnchorName),W=O.getStage();W.setPointersPositions(I);const F=W.getPointerPosition();let K={x:F.x-this._anchorDragOffset.x,y:F.y-this._anchorDragOffset.y};const X=O.getAbsolutePosition();this.anchorDragBoundFunc()&&(K=this.anchorDragBoundFunc()(X,K,I)),O.setAbsolutePosition(K);const Q=O.getAbsolutePosition();if(X.x===Q.x&&X.y===Q.y)return;if(this._movingAnchorName==="rotater"){const oe=this._getNodeRect();V=O.x()-oe.width/2,$=-O.y()+oe.height/2;let fe=Math.atan2(-$,V)+Math.PI/2;oe.height<0&&(fe-=Math.PI);const be=s.Konva.getAngle(this.rotation())+fe,_e=s.Konva.getAngle(this.rotationSnapTolerance()),qe=T(this.rotationSnaps(),be,_e)-oe.rotation,Ue=E(oe,qe);this._fitNodesInto(Ue,I);return}const ae=this.shiftBehavior();let re;ae==="inverted"?re=this.keepRatio()&&!I.shiftKey:ae==="none"?re=this.keepRatio():re=this.keepRatio()||I.shiftKey;var me=this.centeredScaling()||I.altKey;if(this._movingAnchorName==="top-left"){if(re){var G=me?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};Z=Math.sqrt(Math.pow(G.x-O.x(),2)+Math.pow(G.y-O.y(),2));var te=this.findOne(".top-left").x()>G.x?-1:1,ne=this.findOne(".top-left").y()>G.y?-1:1;V=Z*this.cos*te,$=Z*this.sin*ne,this.findOne(".top-left").x(G.x-V),this.findOne(".top-left").y(G.y-$)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(O.y());else if(this._movingAnchorName==="top-right"){if(re){var G=me?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};Z=Math.sqrt(Math.pow(O.x()-G.x,2)+Math.pow(G.y-O.y(),2));var te=this.findOne(".top-right").x()<G.x?-1:1,ne=this.findOne(".top-right").y()>G.y?-1:1;V=Z*this.cos*te,$=Z*this.sin*ne,this.findOne(".top-right").x(G.x+V),this.findOne(".top-right").y(G.y-$)}var de=O.position();this.findOne(".top-left").y(de.y),this.findOne(".bottom-right").x(de.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(O.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(O.x());else if(this._movingAnchorName==="bottom-left"){if(re){var G=me?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};Z=Math.sqrt(Math.pow(G.x-O.x(),2)+Math.pow(O.y()-G.y,2));var te=G.x<O.x()?-1:1,ne=O.y()<G.y?-1:1;V=Z*this.cos*te,$=Z*this.sin*ne,O.x(G.x-V),O.y(G.y+$)}de=O.position(),this.findOne(".top-left").x(de.x),this.findOne(".bottom-right").y(de.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(O.y());else if(this._movingAnchorName==="bottom-right"){if(re){var G=me?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};Z=Math.sqrt(Math.pow(O.x()-G.x,2)+Math.pow(O.y()-G.y,2));var te=this.findOne(".bottom-right").x()<G.x?-1:1,ne=this.findOne(".bottom-right").y()<G.y?-1:1;V=Z*this.cos*te,$=Z*this.sin*ne,this.findOne(".bottom-right").x(G.x+V),this.findOne(".bottom-right").y(G.y+$)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var me=this.centeredScaling()||I.altKey;if(me){const oe=this.findOne(".top-left"),fe=this.findOne(".bottom-right"),ge=oe.x(),be=oe.y(),_e=this.getWidth()-fe.x(),De=this.getHeight()-fe.y();fe.move({x:-ge,y:-be}),oe.move({x:_e,y:De})}const ye=this.findOne(".top-left").getAbsolutePosition();V=ye.x,$=ye.y;const ie=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),pe=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:V,y:$,width:ie,height:pe,rotation:s.Konva.getAngle(this.rotation())},I)}_handleMouseUp(I){this._removeEvents(I)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(I){var V;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const $=this.getNode();R--,this._fire("transformend",{evt:I,target:$}),(V=this.getLayer())===null||V===void 0||V.batchDraw(),$&&this._nodes.forEach(Z=>{var O;Z._fire("transformend",{evt:I,target:Z}),(O=Z.getLayer())===null||O===void 0||O.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(I,V){const $=this._getNodeRect(),Z=1;if(t.Util._inRange(I.width,-this.padding()*2-Z,Z)){this.update();return}if(t.Util._inRange(I.height,-this.padding()*2-Z,Z)){this.update();return}const O=new t.Transform;if(O.rotate(s.Konva.getAngle(this.rotation())),this._movingAnchorName&&I.width<0&&this._movingAnchorName.indexOf("left")>=0){const re=O.point({x:-this.padding()*2,y:0});I.x+=re.x,I.y+=re.y,I.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=re.x,this._anchorDragOffset.y-=re.y}else if(this._movingAnchorName&&I.width<0&&this._movingAnchorName.indexOf("right")>=0){const re=O.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=re.x,this._anchorDragOffset.y-=re.y,I.width+=this.padding()*2}if(this._movingAnchorName&&I.height<0&&this._movingAnchorName.indexOf("top")>=0){const re=O.point({x:0,y:-this.padding()*2});I.x+=re.x,I.y+=re.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=re.x,this._anchorDragOffset.y-=re.y,I.height+=this.padding()*2}else if(this._movingAnchorName&&I.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const re=O.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=re.x,this._anchorDragOffset.y-=re.y,I.height+=this.padding()*2}if(this.boundBoxFunc()){const re=this.boundBoxFunc()($,I);re?I=re:t.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const W=1e7,F=new t.Transform;F.translate($.x,$.y),F.rotate($.rotation),F.scale($.width/W,$.height/W);const K=new t.Transform,X=I.width/W,Q=I.height/W;this.flipEnabled()===!1?(K.translate(I.x,I.y),K.rotate(I.rotation),K.translate(I.width<0?I.width:0,I.height<0?I.height:0),K.scale(Math.abs(X),Math.abs(Q))):(K.translate(I.x,I.y),K.rotate(I.rotation),K.scale(X,Q));const ae=K.multiply(F.invert());this._nodes.forEach(re=>{var G;const te=re.getParent().getAbsoluteTransform(),ne=re.getTransform().copy();ne.translate(re.offsetX(),re.offsetY());const de=new t.Transform;de.multiply(te.copy().invert()).multiply(ae).multiply(te).multiply(ne);const me=de.decompose();re.setAttrs(me),(G=re.getLayer())===null||G===void 0||G.batchDraw()}),this.rotation(t.Util._getRotation(I.rotation)),this._nodes.forEach(re=>{this._fire("transform",{evt:V,target:re}),re._fire("transform",{evt:V,target:re})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(I,V){this.findOne(I).setAttrs(V)}update(){var I;const V=this._getNodeRect();this.rotation(t.Util._getRotation(V.rotation));const $=V.width,Z=V.height,O=this.enabledAnchors(),W=this.resizeEnabled(),F=this.padding(),K=this.anchorSize(),X=this.find("._anchor");X.forEach(ae=>{ae.setAttrs({width:K,height:K,offsetX:K/2,offsetY:K/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:K/2+F,offsetY:K/2+F,visible:W&&O.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:$/2,y:0,offsetY:K/2+F,visible:W&&O.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:$,y:0,offsetX:K/2-F,offsetY:K/2+F,visible:W&&O.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:Z/2,offsetX:K/2+F,visible:W&&O.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:$,y:Z/2,offsetX:K/2-F,visible:W&&O.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:Z,offsetX:K/2+F,offsetY:K/2-F,visible:W&&O.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:$/2,y:Z,offsetY:K/2-F,visible:W&&O.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:$,y:Z,offsetX:K/2-F,offsetY:K/2-F,visible:W&&O.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:$/2,y:-this.rotateAnchorOffset()*t.Util._sign(Z)-F,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:$,height:Z,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const Q=this.anchorStyleFunc();Q&&X.forEach(ae=>{Q(ae)}),(I=this.getLayer())===null||I===void 0||I.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const I=this.findOne("."+this._movingAnchorName);I&&I.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),a.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(I){return r.Node.prototype.clone.call(this,I)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Rm.Transformer=j,j.isTransforming=()=>R>0;function D(B){return B instanceof Array||t.Util.warn("enabledAnchors value should be an array"),B instanceof Array&&B.forEach(function(I){S.indexOf(I)===-1&&t.Util.warn("Unknown anchor name: "+I+". Available names are: "+S.join(", "))}),B||[]}return j.prototype.className="Transformer",(0,l._registerNode)(j),e.Factory.addGetterSetter(j,"enabledAnchors",S,D),e.Factory.addGetterSetter(j,"flipEnabled",!0,(0,o.getBooleanValidator)()),e.Factory.addGetterSetter(j,"resizeEnabled",!0),e.Factory.addGetterSetter(j,"anchorSize",10,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(j,"rotateEnabled",!0),e.Factory.addGetterSetter(j,"rotateLineVisible",!0),e.Factory.addGetterSetter(j,"rotationSnaps",[]),e.Factory.addGetterSetter(j,"rotateAnchorOffset",50,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(j,"rotateAnchorCursor","crosshair"),e.Factory.addGetterSetter(j,"rotationSnapTolerance",5,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(j,"borderEnabled",!0),e.Factory.addGetterSetter(j,"anchorStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(j,"anchorStrokeWidth",1,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(j,"anchorFill","white"),e.Factory.addGetterSetter(j,"anchorCornerRadius",0,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(j,"borderStroke","rgb(0, 161, 255)"),e.Factory.addGetterSetter(j,"borderStrokeWidth",1,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(j,"borderDash"),e.Factory.addGetterSetter(j,"keepRatio",!0),e.Factory.addGetterSetter(j,"shiftBehavior","default"),e.Factory.addGetterSetter(j,"centeredScaling",!1),e.Factory.addGetterSetter(j,"ignoreStroke",!1),e.Factory.addGetterSetter(j,"padding",0,(0,o.getNumberValidator)()),e.Factory.addGetterSetter(j,"node"),e.Factory.addGetterSetter(j,"nodes"),e.Factory.addGetterSetter(j,"boundBoxFunc"),e.Factory.addGetterSetter(j,"anchorDragBoundFunc"),e.Factory.addGetterSetter(j,"anchorStyleFunc"),e.Factory.addGetterSetter(j,"shouldOverdrawWholeArea",!1),e.Factory.addGetterSetter(j,"useSingleNodeRotation",!0),e.Factory.backCompat(j,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Rm}var Lm={},d5;function wz(){if(d5)return Lm;d5=1,Object.defineProperty(Lm,"__esModule",{value:!0}),Lm.Wedge=void 0;const t=hr(),e=Ji(),r=lr(),n=mr(),i=lr();let a=class extends e.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),o.lineTo(0,0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}};return Lm.Wedge=a,a.prototype.className="Wedge",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,i._registerNode)(a),t.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),t.Factory.addGetterSetter(a,"clockwise",!1),t.Factory.backCompat(a,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Lm}var Om={},h5;function _z(){if(h5)return Om;h5=1,Object.defineProperty(Om,"__esModule",{value:!0}),Om.Blur=void 0;const t=hr(),e=si(),r=mr();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const i=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function s(l,u){const c=l.data,f=l.width,g=l.height;let v,x,_,S,N,k,E,T,R,j,D,B,I,V,$,Z,O,W,F,K,X,Q,ae,re,G=u+u+1,te=f-1,ne=g-1,de=u+1,me=de*(de+1)/2,ye=new n,ie=null,pe=ye,oe=null,fe=null,ge=i[u],be=a[u];for(_=1;_<G;_++)pe=pe.next=new n,_===de&&(ie=pe);for(pe.next=ye,E=k=0,x=0;x<g;x++){for(Z=O=W=F=T=R=j=D=0,B=de*(K=c[k]),I=de*(X=c[k+1]),V=de*(Q=c[k+2]),$=de*(ae=c[k+3]),T+=me*K,R+=me*X,j+=me*Q,D+=me*ae,pe=ye,_=0;_<de;_++)pe.r=K,pe.g=X,pe.b=Q,pe.a=ae,pe=pe.next;for(_=1;_<de;_++)S=k+((te<_?te:_)<<2),T+=(pe.r=K=c[S])*(re=de-_),R+=(pe.g=X=c[S+1])*re,j+=(pe.b=Q=c[S+2])*re,D+=(pe.a=ae=c[S+3])*re,Z+=K,O+=X,W+=Q,F+=ae,pe=pe.next;for(oe=ye,fe=ie,v=0;v<f;v++)c[k+3]=ae=D*ge>>be,ae!==0?(ae=255/ae,c[k]=(T*ge>>be)*ae,c[k+1]=(R*ge>>be)*ae,c[k+2]=(j*ge>>be)*ae):c[k]=c[k+1]=c[k+2]=0,T-=B,R-=I,j-=V,D-=$,B-=oe.r,I-=oe.g,V-=oe.b,$-=oe.a,S=E+((S=v+u+1)<te?S:te)<<2,Z+=oe.r=c[S],O+=oe.g=c[S+1],W+=oe.b=c[S+2],F+=oe.a=c[S+3],T+=Z,R+=O,j+=W,D+=F,oe=oe.next,B+=K=fe.r,I+=X=fe.g,V+=Q=fe.b,$+=ae=fe.a,Z-=K,O-=X,W-=Q,F-=ae,fe=fe.next,k+=4;E+=f}for(v=0;v<f;v++){for(O=W=F=Z=R=j=D=T=0,k=v<<2,B=de*(K=c[k]),I=de*(X=c[k+1]),V=de*(Q=c[k+2]),$=de*(ae=c[k+3]),T+=me*K,R+=me*X,j+=me*Q,D+=me*ae,pe=ye,_=0;_<de;_++)pe.r=K,pe.g=X,pe.b=Q,pe.a=ae,pe=pe.next;for(N=f,_=1;_<=u;_++)k=N+v<<2,T+=(pe.r=K=c[k])*(re=de-_),R+=(pe.g=X=c[k+1])*re,j+=(pe.b=Q=c[k+2])*re,D+=(pe.a=ae=c[k+3])*re,Z+=K,O+=X,W+=Q,F+=ae,pe=pe.next,_<ne&&(N+=f);for(k=v,oe=ye,fe=ie,x=0;x<g;x++)S=k<<2,c[S+3]=ae=D*ge>>be,ae>0?(ae=255/ae,c[S]=(T*ge>>be)*ae,c[S+1]=(R*ge>>be)*ae,c[S+2]=(j*ge>>be)*ae):c[S]=c[S+1]=c[S+2]=0,T-=B,R-=I,j-=V,D-=$,B-=oe.r,I-=oe.g,V-=oe.b,$-=oe.a,S=v+((S=x+de)<ne?S:ne)*f<<2,T+=Z+=oe.r=c[S],R+=O+=oe.g=c[S+1],j+=W+=oe.b=c[S+2],D+=F+=oe.a=c[S+3],oe=oe.next,B+=K=fe.r,I+=X=fe.g,V+=Q=fe.b,$+=ae=fe.a,Z-=K,O-=X,W-=Q,F-=ae,fe=fe.next,k+=f}}const o=function(u){const c=Math.round(this.blurRadius());c>0&&s(u,c)};return Om.Blur=o,t.Factory.addGetterSetter(e.Node,"blurRadius",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),Om}var Dm={},f5;function Sz(){if(f5)return Dm;f5=1,Object.defineProperty(Dm,"__esModule",{value:!0}),Dm.Brighten=void 0;const t=hr(),e=si(),r=mr(),n=function(i){let a=this.brightness()*255,s=i.data,o=s.length,l;for(l=0;l<o;l+=4)s[l]+=a,s[l+1]+=a,s[l+2]+=a};return Dm.Brighten=n,t.Factory.addGetterSetter(e.Node,"brightness",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),Dm}var Im={},p5;function kz(){if(p5)return Im;p5=1,Object.defineProperty(Im,"__esModule",{value:!0}),Im.Contrast=void 0;const t=hr(),e=si(),r=mr(),n=function(i){const a=Math.pow((this.contrast()+100)/100,2);let s=i.data,o=s.length,l=150,u=150,c=150,f;for(f=0;f<o;f+=4)l=s[f],u=s[f+1],c=s[f+2],l/=255,l-=.5,l*=a,l+=.5,l*=255,u/=255,u-=.5,u*=a,u+=.5,u*=255,c/=255,c-=.5,c*=a,c+=.5,c*=255,l=l<0?0:l>255?255:l,u=u<0?0:u>255?255:u,c=c<0?0:c>255?255:c,s[f]=l,s[f+1]=u,s[f+2]=c};return Im.Contrast=n,t.Factory.addGetterSetter(e.Node,"contrast",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),Im}var Bm={},m5;function Cz(){if(m5)return Bm;m5=1,Object.defineProperty(Bm,"__esModule",{value:!0}),Bm.Emboss=void 0;const t=hr(),e=si(),r=Zn(),n=mr(),i=function(a){let s=this.embossStrength()*10,o=this.embossWhiteLevel()*255,l=this.embossDirection(),u=this.embossBlend(),c=0,f=0,g=a.data,v=a.width,x=a.height,_=v*4,S=x;switch(l){case"top-left":c=-1,f=-1;break;case"top":c=-1,f=0;break;case"top-right":c=-1,f=1;break;case"right":c=0,f=1;break;case"bottom-right":c=1,f=1;break;case"bottom":c=1,f=0;break;case"bottom-left":c=1,f=-1;break;case"left":c=0,f=-1;break;default:r.Util.error("Unknown emboss direction: "+l)}do{const N=(S-1)*_;let k=c;S+k<1&&(k=0),S+k>x&&(k=0);const E=(S-1+k)*v*4;let T=v;do{const R=N+(T-1)*4;let j=f;T+j<1&&(j=0),T+j>v&&(j=0);const D=E+(T-1+j)*4,B=g[R]-g[D],I=g[R+1]-g[D+1],V=g[R+2]-g[D+2];let $=B;const Z=$>0?$:-$,O=I>0?I:-I,W=V>0?V:-V;if(O>Z&&($=I),W>Z&&($=V),$*=s,u){const F=g[R]+$,K=g[R+1]+$,X=g[R+2]+$;g[R]=F>255?255:F<0?0:F,g[R+1]=K>255?255:K<0?0:K,g[R+2]=X>255?255:X<0?0:X}else{let F=o-$;F<0?F=0:F>255&&(F=255),g[R]=g[R+1]=g[R+2]=F}}while(--T)}while(--S)};return Bm.Emboss=i,t.Factory.addGetterSetter(e.Node,"embossStrength",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossDirection","top-left",null,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"embossBlend",!1,null,t.Factory.afterSetFilter),Bm}var zm={},g5;function Ez(){if(g5)return zm;g5=1,Object.defineProperty(zm,"__esModule",{value:!0}),zm.Enhance=void 0;const t=hr(),e=si(),r=mr();function n(a,s,o,l,u){let c=o-s,f=u-l,g;return c===0?l+f/2:f===0?l:(g=(a-s)/c,g=f*g+l,g)}const i=function(a){let s=a.data,o=s.length,l=s[0],u=l,c,f=s[1],g=f,v,x=s[2],_=x,S,N;const k=this.enhance();if(k===0)return;for(N=0;N<o;N+=4)c=s[N+0],c<l?l=c:c>u&&(u=c),v=s[N+1],v<f?f=v:v>g&&(g=v),S=s[N+2],S<x?x=S:S>_&&(_=S);u===l&&(u=255,l=0),g===f&&(g=255,f=0),_===x&&(_=255,x=0);let E,T,R,j,D,B,I,V,$;for(k>0?(T=u+k*(255-u),R=l-k*(l-0),D=g+k*(255-g),B=f-k*(f-0),V=_+k*(255-_),$=x-k*(x-0)):(E=(u+l)*.5,T=u+k*(u-E),R=l+k*(l-E),j=(g+f)*.5,D=g+k*(g-j),B=f+k*(f-j),I=(_+x)*.5,V=_+k*(_-I),$=x+k*(x-I)),N=0;N<o;N+=4)s[N+0]=n(s[N+0],l,u,R,T),s[N+1]=n(s[N+1],f,g,B,D),s[N+2]=n(s[N+2],x,_,$,V)};return zm.Enhance=i,t.Factory.addGetterSetter(e.Node,"enhance",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),zm}var Fm={},v5;function Nz(){if(v5)return Fm;v5=1,Object.defineProperty(Fm,"__esModule",{value:!0}),Fm.Grayscale=void 0;const t=function(e){let r=e.data,n=r.length,i,a;for(i=0;i<n;i+=4)a=.34*r[i]+.5*r[i+1]+.16*r[i+2],r[i]=a,r[i+1]=a,r[i+2]=a};return Fm.Grayscale=t,Fm}var Vm={},y5;function Tz(){if(y5)return Vm;y5=1,Object.defineProperty(Vm,"__esModule",{value:!0}),Vm.HSL=void 0;const t=hr(),e=si(),r=mr();t.Factory.addGetterSetter(e.Node,"hue",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"luminance",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter);const n=function(i){let a=i.data,s=a.length,o=1,l=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,c=this.luminance()*127,f;const g=o*l*Math.cos(u*Math.PI/180),v=o*l*Math.sin(u*Math.PI/180),x=.299*o+.701*g+.167*v,_=.587*o-.587*g+.33*v,S=.114*o-.114*g-.497*v,N=.299*o-.299*g-.328*v,k=.587*o+.413*g+.035*v,E=.114*o-.114*g+.293*v,T=.299*o-.3*g+1.25*v,R=.587*o-.586*g-1.05*v,j=.114*o+.886*g-.2*v;let D,B,I,V;for(f=0;f<s;f+=4)D=a[f+0],B=a[f+1],I=a[f+2],V=a[f+3],a[f+0]=x*D+_*B+S*I+c,a[f+1]=N*D+k*B+E*I+c,a[f+2]=T*D+R*B+j*I+c,a[f+3]=V};return Vm.HSL=n,Vm}var Um={},x5;function Pz(){if(x5)return Um;x5=1,Object.defineProperty(Um,"__esModule",{value:!0}),Um.HSV=void 0;const t=hr(),e=si(),r=mr(),n=function(i){const a=i.data,s=a.length,o=Math.pow(2,this.value()),l=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,c=o*l*Math.cos(u*Math.PI/180),f=o*l*Math.sin(u*Math.PI/180),g=.299*o+.701*c+.167*f,v=.587*o-.587*c+.33*f,x=.114*o-.114*c-.497*f,_=.299*o-.299*c-.328*f,S=.587*o+.413*c+.035*f,N=.114*o-.114*c+.293*f,k=.299*o-.3*c+1.25*f,E=.587*o-.586*c-1.05*f,T=.114*o+.886*c-.2*f;let R,j,D,B;for(let I=0;I<s;I+=4)R=a[I+0],j=a[I+1],D=a[I+2],B=a[I+3],a[I+0]=g*R+v*j+x*D,a[I+1]=_*R+S*j+N*D,a[I+2]=k*R+E*j+T*D,a[I+3]=B};return Um.HSV=n,t.Factory.addGetterSetter(e.Node,"hue",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"saturation",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"value",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),Um}var Hm={},b5;function Mz(){if(b5)return Hm;b5=1,Object.defineProperty(Hm,"__esModule",{value:!0}),Hm.Invert=void 0;const t=function(e){let r=e.data,n=r.length,i;for(i=0;i<n;i+=4)r[i]=255-r[i],r[i+1]=255-r[i+1],r[i+2]=255-r[i+2]};return Hm.Invert=t,Hm}var Gm={},w5;function Az(){if(w5)return Gm;w5=1,Object.defineProperty(Gm,"__esModule",{value:!0}),Gm.Kaleidoscope=void 0;const t=hr(),e=si(),r=Zn(),n=mr(),i=function(o,l,u){let c=o.data,f=l.data,g=o.width,v=o.height,x=u.polarCenterX||g/2,_=u.polarCenterY||v/2,S,N,k,E=0,T=0,R=0,j=0,D,B=Math.sqrt(x*x+_*_);N=g-x,k=v-_,D=Math.sqrt(N*N+k*k),B=D>B?D:B;let I=v,V=g,$,Z,O=360/V*Math.PI/180,W,F;for(Z=0;Z<V;Z+=1)for(W=Math.sin(Z*O),F=Math.cos(Z*O),$=0;$<I;$+=1)N=Math.floor(x+B*$/I*F),k=Math.floor(_+B*$/I*W),S=(k*g+N)*4,E=c[S+0],T=c[S+1],R=c[S+2],j=c[S+3],S=(Z+$*g)*4,f[S+0]=E,f[S+1]=T,f[S+2]=R,f[S+3]=j},a=function(o,l,u){let c=o.data,f=l.data,g=o.width,v=o.height,x=u.polarCenterX||g/2,_=u.polarCenterY||v/2,S,N,k,E,T,R=0,j=0,D=0,B=0,I,V=Math.sqrt(x*x+_*_);N=g-x,k=v-_,I=Math.sqrt(N*N+k*k),V=I>V?I:V;let $=v,Z=g,O,W,F=0,K,X;for(N=0;N<g;N+=1)for(k=0;k<v;k+=1)E=N-x,T=k-_,O=Math.sqrt(E*E+T*T)*$/V,W=(Math.atan2(T,E)*180/Math.PI+360+F)%360,W=W*Z/360,K=Math.floor(W),X=Math.floor(O),S=(X*g+K)*4,R=c[S+0],j=c[S+1],D=c[S+2],B=c[S+3],S=(k*g+N)*4,f[S+0]=R,f[S+1]=j,f[S+2]=D,f[S+3]=B},s=function(o){const l=o.width,u=o.height;let c,f,g,v,x,_,S,N,k,E,T=Math.round(this.kaleidoscopePower());const R=Math.round(this.kaleidoscopeAngle()),j=Math.floor(l*(R%360)/360);if(T<1)return;const D=r.Util.createCanvasElement();D.width=l,D.height=u;const B=D.getContext("2d").getImageData(0,0,l,u);r.Util.releaseCanvas(D),i(o,B,{polarCenterX:l/2,polarCenterY:u/2});let I=l/Math.pow(2,T);for(;I<=8;)I=I*2,T-=1;I=Math.ceil(I);let V=I,$=0,Z=V,O=1;for(j+I>l&&($=V,Z=0,O=-1),f=0;f<u;f+=1)for(c=$;c!==Z;c+=O)g=Math.round(c+j)%l,k=(l*f+g)*4,x=B.data[k+0],_=B.data[k+1],S=B.data[k+2],N=B.data[k+3],E=(l*f+c)*4,B.data[E+0]=x,B.data[E+1]=_,B.data[E+2]=S,B.data[E+3]=N;for(f=0;f<u;f+=1)for(V=Math.floor(I),v=0;v<T;v+=1){for(c=0;c<V+1;c+=1)k=(l*f+c)*4,x=B.data[k+0],_=B.data[k+1],S=B.data[k+2],N=B.data[k+3],E=(l*f+V*2-c-1)*4,B.data[E+0]=x,B.data[E+1]=_,B.data[E+2]=S,B.data[E+3]=N;V*=2}a(B,o,{})};return Gm.Kaleidoscope=s,t.Factory.addGetterSetter(e.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),Gm}var qm={},_5;function jz(){if(_5)return qm;_5=1,Object.defineProperty(qm,"__esModule",{value:!0}),qm.Mask=void 0;const t=hr(),e=si(),r=mr();function n(g,v,x){let _=(x*g.width+v)*4;const S=[];return S.push(g.data[_++],g.data[_++],g.data[_++],g.data[_++]),S}function i(g,v){return Math.sqrt(Math.pow(g[0]-v[0],2)+Math.pow(g[1]-v[1],2)+Math.pow(g[2]-v[2],2))}function a(g){const v=[0,0,0];for(let x=0;x<g.length;x++)v[0]+=g[x][0],v[1]+=g[x][1],v[2]+=g[x][2];return v[0]/=g.length,v[1]/=g.length,v[2]/=g.length,v}function s(g,v){const x=n(g,0,0),_=n(g,g.width-1,0),S=n(g,0,g.height-1),N=n(g,g.width-1,g.height-1),k=v||10;if(i(x,_)<k&&i(_,N)<k&&i(N,S)<k&&i(S,x)<k){const E=a([_,x,N,S]),T=[];for(let R=0;R<g.width*g.height;R++){const j=i(E,[g.data[R*4],g.data[R*4+1],g.data[R*4+2]]);T[R]=j<k?0:255}return T}}function o(g,v){for(let x=0;x<g.width*g.height;x++)g.data[4*x+3]=v[x]}function l(g,v,x){const _=[1,1,1,1,0,1,1,1,1],S=Math.round(Math.sqrt(_.length)),N=Math.floor(S/2),k=[];for(let E=0;E<x;E++)for(let T=0;T<v;T++){const R=E*v+T;let j=0;for(let D=0;D<S;D++)for(let B=0;B<S;B++){const I=E+D-N,V=T+B-N;if(I>=0&&I<x&&V>=0&&V<v){const $=I*v+V,Z=_[D*S+B];j+=g[$]*Z}}k[R]=j===2040?255:0}return k}function u(g,v,x){const _=[1,1,1,1,1,1,1,1,1],S=Math.round(Math.sqrt(_.length)),N=Math.floor(S/2),k=[];for(let E=0;E<x;E++)for(let T=0;T<v;T++){const R=E*v+T;let j=0;for(let D=0;D<S;D++)for(let B=0;B<S;B++){const I=E+D-N,V=T+B-N;if(I>=0&&I<x&&V>=0&&V<v){const $=I*v+V,Z=_[D*S+B];j+=g[$]*Z}}k[R]=j>=1020?255:0}return k}function c(g,v,x){const _=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],S=Math.round(Math.sqrt(_.length)),N=Math.floor(S/2),k=[];for(let E=0;E<x;E++)for(let T=0;T<v;T++){const R=E*v+T;let j=0;for(let D=0;D<S;D++)for(let B=0;B<S;B++){const I=E+D-N,V=T+B-N;if(I>=0&&I<x&&V>=0&&V<v){const $=I*v+V,Z=_[D*S+B];j+=g[$]*Z}}k[R]=j}return k}const f=function(g){let v=this.threshold(),x=s(g,v);return x&&(x=l(x,g.width,g.height),x=u(x,g.width,g.height),x=c(x,g.width,g.height),o(g,x)),g};return qm.Mask=f,t.Factory.addGetterSetter(e.Node,"threshold",0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),qm}var Wm={},S5;function Rz(){if(S5)return Wm;S5=1,Object.defineProperty(Wm,"__esModule",{value:!0}),Wm.Noise=void 0;const t=hr(),e=si(),r=mr(),n=function(i){const a=this.noise()*255,s=i.data,o=s.length,l=a/2;for(let u=0;u<o;u+=4)s[u+0]+=l-2*l*Math.random(),s[u+1]+=l-2*l*Math.random(),s[u+2]+=l-2*l*Math.random()};return Wm.Noise=n,t.Factory.addGetterSetter(e.Node,"noise",.2,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),Wm}var $m={},k5;function Lz(){if(k5)return $m;k5=1,Object.defineProperty($m,"__esModule",{value:!0}),$m.Pixelate=void 0;const t=hr(),e=Zn(),r=si(),n=mr(),i=function(a){let s=Math.ceil(this.pixelSize()),o=a.width,l=a.height,u,c,f,g,v,x,_,S=Math.ceil(o/s),N=Math.ceil(l/s),k,E,T,R,j,D,B,I=a.data;if(s<=0){e.Util.error("pixelSize value can not be <= 0");return}for(j=0;j<S;j+=1)for(D=0;D<N;D+=1){for(g=0,v=0,x=0,_=0,k=j*s,E=k+s,T=D*s,R=T+s,B=0,u=k;u<E;u+=1)if(!(u>=o))for(c=T;c<R;c+=1)c>=l||(f=(o*c+u)*4,g+=I[f+0],v+=I[f+1],x+=I[f+2],_+=I[f+3],B+=1);for(g=g/B,v=v/B,x=x/B,_=_/B,u=k;u<E;u+=1)if(!(u>=o))for(c=T;c<R;c+=1)c>=l||(f=(o*c+u)*4,I[f+0]=g,I[f+1]=v,I[f+2]=x,I[f+3]=_)}};return $m.Pixelate=i,t.Factory.addGetterSetter(r.Node,"pixelSize",8,(0,n.getNumberValidator)(),t.Factory.afterSetFilter),$m}var Km={},C5;function Oz(){if(C5)return Km;C5=1,Object.defineProperty(Km,"__esModule",{value:!0}),Km.Posterize=void 0;const t=hr(),e=si(),r=mr(),n=function(i){let a=Math.round(this.levels()*254)+1,s=i.data,o=s.length,l=255/a,u;for(u=0;u<o;u+=1)s[u]=Math.floor(s[u]/l)*l};return Km.Posterize=n,t.Factory.addGetterSetter(e.Node,"levels",.5,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),Km}var Zm={},E5;function Dz(){if(E5)return Zm;E5=1,Object.defineProperty(Zm,"__esModule",{value:!0}),Zm.RGB=void 0;const t=hr(),e=si(),r=mr(),n=function(i){let a=i.data,s=a.length,o=this.red(),l=this.green(),u=this.blue(),c,f;for(c=0;c<s;c+=4)f=(.34*a[c]+.5*a[c+1]+.16*a[c+2])/255,a[c]=f*o,a[c+1]=f*l,a[c+2]=f*u,a[c+3]=a[c+3]};return Zm.RGB=n,t.Factory.addGetterSetter(e.Node,"red",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)}),t.Factory.addGetterSetter(e.Node,"green",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)}),t.Factory.addGetterSetter(e.Node,"blue",0,r.RGBComponent,t.Factory.afterSetFilter),Zm}var Ym={},N5;function Iz(){if(N5)return Ym;N5=1,Object.defineProperty(Ym,"__esModule",{value:!0}),Ym.RGBA=void 0;const t=hr(),e=si(),r=mr(),n=function(i){const a=i.data,s=a.length,o=this.red(),l=this.green(),u=this.blue(),c=this.alpha();for(let f=0;f<s;f+=4){const g=1-c;a[f]=o*c+a[f]*g,a[f+1]=l*c+a[f+1]*g,a[f+2]=u*c+a[f+2]*g}};return Ym.RGBA=n,t.Factory.addGetterSetter(e.Node,"red",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)}),t.Factory.addGetterSetter(e.Node,"green",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)}),t.Factory.addGetterSetter(e.Node,"blue",0,r.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(e.Node,"alpha",1,function(i){return this._filterUpToDate=!1,i>1?1:i<0?0:i}),Ym}var Xm={},T5;function Bz(){if(T5)return Xm;T5=1,Object.defineProperty(Xm,"__esModule",{value:!0}),Xm.Sepia=void 0;const t=function(e){let r=e.data,n=r.length,i,a,s,o;for(i=0;i<n;i+=4)a=r[i+0],s=r[i+1],o=r[i+2],r[i+0]=Math.min(255,a*.393+s*.769+o*.189),r[i+1]=Math.min(255,a*.349+s*.686+o*.168),r[i+2]=Math.min(255,a*.272+s*.534+o*.131)};return Xm.Sepia=t,Xm}var Qm={},P5;function zz(){if(P5)return Qm;P5=1,Object.defineProperty(Qm,"__esModule",{value:!0}),Qm.Solarize=void 0;const t=function(e){const r=e.data,n=e.width,i=e.height,a=n*4;let s=i;do{const o=(s-1)*a;let l=n;do{const u=o+(l-1)*4;let c=r[u],f=r[u+1],g=r[u+2];c>127&&(c=255-c),f>127&&(f=255-f),g>127&&(g=255-g),r[u]=c,r[u+1]=f,r[u+2]=g}while(--l)}while(--s)};return Qm.Solarize=t,Qm}var Jm={},M5;function Fz(){if(M5)return Jm;M5=1,Object.defineProperty(Jm,"__esModule",{value:!0}),Jm.Threshold=void 0;const t=hr(),e=si(),r=mr(),n=function(i){const a=this.threshold()*255,s=i.data,o=s.length;for(let l=0;l<o;l+=1)s[l]=s[l]<a?0:255};return Jm.Threshold=n,t.Factory.addGetterSetter(e.Node,"threshold",.5,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),Jm}var A5;function Vz(){if(A5)return fm;A5=1,Object.defineProperty(fm,"__esModule",{value:!0}),fm.Konva=void 0;const t=O2(),e=lz(),r=cz(),n=dz(),i=hz(),a=fz(),s=pz(),o=pM(),l=J_(),u=mM(),c=mz(),f=gz(),g=vz(),v=yz(),x=gM(),_=xz(),S=bz(),N=wz(),k=_z(),E=Sz(),T=kz(),R=Cz(),j=Ez(),D=Nz(),B=Tz(),I=Pz(),V=Mz(),$=Az(),Z=jz(),O=Rz(),W=Lz(),F=Oz(),K=Dz(),X=Iz(),Q=Bz(),ae=zz(),re=Fz();return fm.Konva=t.Konva.Util._assign(t.Konva,{Arc:e.Arc,Arrow:r.Arrow,Circle:n.Circle,Ellipse:i.Ellipse,Image:a.Image,Label:s.Label,Tag:s.Tag,Line:o.Line,Path:l.Path,Rect:u.Rect,RegularPolygon:c.RegularPolygon,Ring:f.Ring,Sprite:g.Sprite,Star:v.Star,Text:x.Text,TextPath:_.TextPath,Transformer:S.Transformer,Wedge:N.Wedge,Filters:{Blur:k.Blur,Brighten:E.Brighten,Contrast:T.Contrast,Emboss:R.Emboss,Enhance:j.Enhance,Grayscale:D.Grayscale,HSL:B.HSL,HSV:I.HSV,Invert:V.Invert,Kaleidoscope:$.Kaleidoscope,Mask:Z.Mask,Noise:O.Noise,Pixelate:W.Pixelate,Posterize:F.Posterize,RGB:K.RGB,RGBA:X.RGBA,Sepia:Q.Sepia,Solarize:ae.Solarize,Threshold:re.Threshold}}),fm}var Uz=W0.exports,j5;function Hz(){if(j5)return W0.exports;j5=1,Object.defineProperty(Uz,"__esModule",{value:!0});const t=Vz();return W0.exports=t.Konva,W0.exports}Hz();var x0={exports:{}},R5;function Gz(){return R5||(R5=1,(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var r=O2();Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=O2();t.exports=n.Konva})(x0,x0.exports)),x0.exports}var qz=Gz();const Ug=Wh(qz);var ww={exports:{}};var _w,L5;function Wz(){return L5||(L5=1,_w=function(e){var r={},n=Sp(),i=b_(),a=Object.assign;function s(y){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+y,M=1;M<arguments.length;M++)b+="&args[]="+encodeURIComponent(arguments[M]);return"Minified React error #"+y+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),x=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),R=Symbol.iterator;function j(y){return y===null||typeof y!="object"?null:(y=R&&y[R]||y["@@iterator"],typeof y=="function"?y:null)}function D(y){if(y==null)return null;if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y;switch(y){case c:return"Fragment";case u:return"Portal";case g:return"Profiler";case f:return"StrictMode";case S:return"Suspense";case N:return"SuspenseList"}if(typeof y=="object")switch(y.$$typeof){case x:return(y.displayName||"Context")+".Consumer";case v:return(y._context.displayName||"Context")+".Provider";case _:var b=y.render;return y=y.displayName,y||(y=b.displayName||b.name||"",y=y!==""?"ForwardRef("+y+")":"ForwardRef"),y;case k:return b=y.displayName||null,b!==null?b:D(y.type)||"Memo";case E:b=y._payload,y=y._init;try{return D(y(b))}catch{}}return null}function B(y){var b=y.type;switch(y.tag){case 24:return"Cache";case 9:return(b.displayName||"Context")+".Consumer";case 10:return(b._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return y=b.render,y=y.displayName||y.name||"",b.displayName||(y!==""?"ForwardRef("+y+")":"ForwardRef");case 7:return"Fragment";case 5:return b;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return D(b);case 8:return b===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b}return null}function I(y){var b=y,M=y;if(y.alternate)for(;b.return;)b=b.return;else{y=b;do b=y,(b.flags&4098)!==0&&(M=b.return),y=b.return;while(y)}return b.tag===3?M:null}function V(y){if(I(y)!==y)throw Error(s(188))}function $(y){var b=y.alternate;if(!b){if(b=I(y),b===null)throw Error(s(188));return b!==y?null:y}for(var M=y,z=b;;){var q=M.return;if(q===null)break;var ee=q.alternate;if(ee===null){if(z=q.return,z!==null){M=z;continue}break}if(q.child===ee.child){for(ee=q.child;ee;){if(ee===M)return V(q),y;if(ee===z)return V(q),b;ee=ee.sibling}throw Error(s(188))}if(M.return!==z.return)M=q,z=ee;else{for(var he=!1,Te=q.child;Te;){if(Te===M){he=!0,M=q,z=ee;break}if(Te===z){he=!0,z=q,M=ee;break}Te=Te.sibling}if(!he){for(Te=ee.child;Te;){if(Te===M){he=!0,M=ee,z=q;break}if(Te===z){he=!0,z=ee,M=q;break}Te=Te.sibling}if(!he)throw Error(s(189))}}if(M.alternate!==z)throw Error(s(190))}if(M.tag!==3)throw Error(s(188));return M.stateNode.current===M?y:b}function Z(y){return y=$(y),y!==null?O(y):null}function O(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){var b=O(y);if(b!==null)return b;y=y.sibling}return null}function W(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){if(y.tag!==4){var b=W(y);if(b!==null)return b}y=y.sibling}return null}var F=Array.isArray,K=e.getPublicInstance,X=e.getRootHostContext,Q=e.getChildHostContext,ae=e.prepareForCommit,re=e.resetAfterCommit,G=e.createInstance,te=e.appendInitialChild,ne=e.finalizeInitialChildren,de=e.prepareUpdate,me=e.shouldSetTextContent,ye=e.createTextInstance,ie=e.scheduleTimeout,pe=e.cancelTimeout,oe=e.noTimeout,fe=e.isPrimaryRenderer,ge=e.supportsMutation,be=e.supportsPersistence,_e=e.supportsHydration,De=e.getInstanceFromNode,qe=e.preparePortalMount,Ue=e.getCurrentEventPriority,Ve=e.detachDeletedInstance,Je=e.supportsMicrotasks,ft=e.scheduleMicrotask,We=e.supportsTestSelectors,Ce=e.findFiberRoot,ze=e.getBoundingRect,Ke=e.getTextContent,et=e.isHiddenSubtree,ht=e.matchAccessibilityRole,Nt=e.setFocusIfFocusable,Mt=e.setupIntersectionObserver,jt=e.appendChild,Wt=e.appendChildToContainer,xt=e.commitTextUpdate,st=e.commitMount,Ge=e.commitUpdate,ue=e.insertBefore,ve=e.insertInContainerBefore,ke=e.removeChild,Ne=e.removeChildFromContainer,je=e.resetTextContent,Ze=e.hideInstance,He=e.hideTextInstance,ut=e.unhideInstance,lt=e.unhideTextInstance,_t=e.clearContainer,Bt=e.cloneInstance,zt=e.createContainerChildSet,vt=e.appendChildToContainerChildSet,Ht=e.finalizeContainerChildren,qt=e.replaceContainerChildren,Sr=e.cloneHiddenInstance,fr=e.cloneHiddenTextInstance,fn=e.canHydrateInstance,Gr=e.canHydrateTextInstance,qr=e.canHydrateSuspenseInstance,nn=e.isSuspenseInstancePending,ur=e.isSuspenseInstanceFallback,yt=e.getSuspenseInstanceFallbackErrorDetails,Lr=e.registerSuspenseInstanceRetry,Yn=e.getNextHydratableSibling,Na=e.getFirstHydratableChild,Ds=e.getFirstHydratableChildWithinContainer,Js=e.getFirstHydratableChildWithinSuspenseInstance,ui=e.hydrateInstance,an=e.hydrateTextInstance,xn=e.hydrateSuspenseInstance,ci=e.getNextHydratableInstanceAfterSuspenseInstance,eo=e.commitHydratedContainer,wi=e.commitHydratedSuspenseInstance,su=e.clearSuspenseBoundary,ou=e.clearSuspenseBoundaryFromContainer,Id=e.shouldDeleteUnhydratedTailInstances,fl=e.didNotMatchHydratedContainerTextInstance,Xr=e.didNotMatchHydratedTextInstance,lu;function Is(y){if(lu===void 0)try{throw Error()}catch(M){var b=M.stack.trim().match(/\n( *(at )?)/);lu=b&&b[1]||""}return`
`+lu+y}var pl=!1;function Ta(y,b){if(!y||pl)return"";pl=!0;var M=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error()},Object.defineProperty(b.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(b,[])}catch(nt){var z=nt}Reflect.construct(y,[],b)}else{try{b.call()}catch(nt){z=nt}y.call(b.prototype)}else{try{throw Error()}catch(nt){z=nt}y()}}catch(nt){if(nt&&z&&typeof nt.stack=="string"){for(var q=nt.stack.split(`
`),ee=z.stack.split(`
`),he=q.length-1,Te=ee.length-1;1<=he&&0<=Te&&q[he]!==ee[Te];)Te--;for(;1<=he&&0<=Te;he--,Te--)if(q[he]!==ee[Te]){if(he!==1||Te!==1)do if(he--,Te--,0>Te||q[he]!==ee[Te]){var Be=`
`+q[he].replace(" at new "," at ");return y.displayName&&Be.includes("<anonymous>")&&(Be=Be.replace("<anonymous>",y.displayName)),Be}while(1<=he&&0<=Te);break}}}finally{pl=!1,Error.prepareStackTrace=M}return(y=y?y.displayName||y.name:"")?Is(y):""}var Lo=Object.prototype.hasOwnProperty,ea=[],ta=-1;function pn(y){return{current:y}}function vr(y){0>ta||(y.current=ea[ta],ea[ta]=null,ta--)}function ot(y,b){ta++,ea[ta]=y.current,y.current=b}var cr={},sn=pn(cr),zr=pn(!1),Nr=cr;function ra(y,b){var M=y.type.contextTypes;if(!M)return cr;var z=y.stateNode;if(z&&z.__reactInternalMemoizedUnmaskedChildContext===b)return z.__reactInternalMemoizedMaskedChildContext;var q={},ee;for(ee in M)q[ee]=b[ee];return z&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=b,y.__reactInternalMemoizedMaskedChildContext=q),q}function Tt(y){return y=y.childContextTypes,y!=null}function yr(){vr(zr),vr(sn)}function Ju(y,b,M){if(sn.current!==cr)throw Error(s(168));ot(sn,b),ot(zr,M)}function uu(y,b,M){var z=y.stateNode;if(b=b.childContextTypes,typeof z.getChildContext!="function")return M;z=z.getChildContext();for(var q in z)if(!(q in b))throw Error(s(108,B(y)||"Unknown",q));return a({},M,z)}function Xn(y){return y=(y=y.stateNode)&&y.__reactInternalMemoizedMergedChildContext||cr,Nr=sn.current,ot(sn,y),ot(zr,zr.current),!0}function Bd(y,b,M){var z=y.stateNode;if(!z)throw Error(s(169));M?(y=uu(y,b,Nr),z.__reactInternalMemoizedMergedChildContext=y,vr(zr),vr(sn),ot(sn,y)):vr(zr),ot(zr,M)}var di=Math.clz32?Math.clz32:Bs,$a=Math.log,bn=Math.LN2;function Bs(y){return y>>>=0,y===0?32:31-($a(y)/bn|0)|0}var rr=64,zs=4194304;function to(y){switch(y&-y){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return y&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return y}}function fs(y,b){var M=y.pendingLanes;if(M===0)return 0;var z=0,q=y.suspendedLanes,ee=y.pingedLanes,he=M&268435455;if(he!==0){var Te=he&~q;Te!==0?z=to(Te):(ee&=he,ee!==0&&(z=to(ee)))}else he=M&~q,he!==0?z=to(he):ee!==0&&(z=to(ee));if(z===0)return 0;if(b!==0&&b!==z&&(b&q)===0&&(q=z&-z,ee=b&-b,q>=ee||q===16&&(ee&4194240)!==0))return b;if((z&4)!==0&&(z|=M&16),b=y.entangledLanes,b!==0)for(y=y.entanglements,b&=z;0<b;)M=31-di(b),q=1<<M,z|=y[M],b&=~q;return z}function ec(y,b){switch(y){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tc(y,b){for(var M=y.suspendedLanes,z=y.pingedLanes,q=y.expirationTimes,ee=y.pendingLanes;0<ee;){var he=31-di(ee),Te=1<<he,Be=q[he];Be===-1?((Te&M)===0||(Te&z)!==0)&&(q[he]=ec(Te,b)):Be<=b&&(y.expiredLanes|=Te),ee&=~Te}}function Oo(y){return y=y.pendingLanes&-1073741825,y!==0?y:y&1073741824?1073741824:0}function ml(){var y=rr;return rr<<=1,(rr&4194240)===0&&(rr=64),y}function ro(y){for(var b=[],M=0;31>M;M++)b.push(y);return b}function _i(y,b,M){y.pendingLanes|=b,b!==536870912&&(y.suspendedLanes=0,y.pingedLanes=0),y=y.eventTimes,b=31-di(b),y[b]=M}function Fs(y,b){var M=y.pendingLanes&~b;y.pendingLanes=b,y.suspendedLanes=0,y.pingedLanes=0,y.expiredLanes&=b,y.mutableReadLanes&=b,y.entangledLanes&=b,b=y.entanglements;var z=y.eventTimes;for(y=y.expirationTimes;0<M;){var q=31-di(M),ee=1<<q;b[q]=0,z[q]=-1,y[q]=-1,M&=~ee}}function Pa(y,b){var M=y.entangledLanes|=b;for(y=y.entanglements;M;){var z=31-di(M),q=1<<z;q&b|y[z]&b&&(y[z]|=b),M&=~q}}var nr=0;function Gt(y){return y&=-y,1<y?4<y?(y&268435455)!==0?16:536870912:4:1}var On=i.unstable_scheduleCallback,Tr=i.unstable_cancelCallback,zd=i.unstable_shouldYield,Do=i.unstable_requestPaint,wn=i.unstable_now,gl=i.unstable_ImmediatePriority,ps=i.unstable_UserBlockingPriority,vl=i.unstable_NormalPriority,cu=i.unstable_IdlePriority,Wr=null,_n=null;function Io(y){if(_n&&typeof _n.onCommitFiberRoot=="function")try{_n.onCommitFiberRoot(Wr,y,void 0,(y.current.flags&128)===128)}catch{}}function du(y,b){return y===b&&(y!==0||1/y===1/b)||y!==y&&b!==b}var Ka=typeof Object.is=="function"?Object.is:du,ms=null,no=!1,yl=!1;function hu(y){ms===null?ms=[y]:ms.push(y)}function sr(y){no=!0,hu(y)}function Qn(){if(!yl&&ms!==null){yl=!0;var y=0,b=nr;try{var M=ms;for(nr=1;y<M.length;y++){var z=M[y];do z=z(!0);while(z!==null)}ms=null,no=!1}catch(q){throw ms!==null&&(ms=ms.slice(y+1)),On(gl,Qn),q}finally{nr=b,yl=!1}}return null}var zn=[],na=0,xl=null,Bo=0,Jn=[],ia=0,Sn=null,ji=1,Za="";function aa(y,b){zn[na++]=Bo,zn[na++]=xl,xl=y,Bo=b}function Jh(y,b,M){Jn[ia++]=ji,Jn[ia++]=Za,Jn[ia++]=Sn,Sn=y;var z=ji;y=Za;var q=32-di(z)-1;z&=~(1<<q),M+=1;var ee=32-di(b)+q;if(30<ee){var he=q-q%5;ee=(z&(1<<he)-1).toString(32),z>>=he,q-=he,ji=1<<32-di(b)+q|M<<q|z,Za=ee+y}else ji=1<<ee|M<<q|z,Za=y}function Ri(y){y.return!==null&&(aa(y,1),Jh(y,1,0))}function fu(y){for(;y===xl;)xl=zn[--na],zn[na]=null,Bo=zn[--na],zn[na]=null;for(;y===Sn;)Sn=Jn[--ia],Jn[ia]=null,Za=Jn[--ia],Jn[ia]=null,ji=Jn[--ia],Jn[ia]=null}var Fn=null,on=null,Or=!1,bl=!1,sa=null;function ef(y,b){var M=is(5,null,null,0);M.elementType="DELETED",M.stateNode=b,M.return=y,b=y.deletions,b===null?(y.deletions=[M],y.flags|=16):b.push(M)}function pu(y,b){switch(y.tag){case 5:return b=fn(b,y.type,y.pendingProps),b!==null?(y.stateNode=b,Fn=y,on=Na(b),!0):!1;case 6:return b=Gr(b,y.pendingProps),b!==null?(y.stateNode=b,Fn=y,on=null,!0):!1;case 13:if(b=qr(b),b!==null){var M=Sn!==null?{id:ji,overflow:Za}:null;return y.memoizedState={dehydrated:b,treeContext:M,retryLane:1073741824},M=is(18,null,null,0),M.stateNode=b,M.return=y,y.child=M,Fn=y,on=null,!0}return!1;default:return!1}}function rc(y){return(y.mode&1)!==0&&(y.flags&128)===0}function Fd(y){if(Or){var b=on;if(b){var M=b;if(!pu(y,b)){if(rc(y))throw Error(s(418));b=Yn(M);var z=Fn;b&&pu(y,b)?ef(z,M):(y.flags=y.flags&-4097|2,Or=!1,Fn=y)}}else{if(rc(y))throw Error(s(418));y.flags=y.flags&-4097|2,Or=!1,Fn=y}}}function tf(y){for(y=y.return;y!==null&&y.tag!==5&&y.tag!==3&&y.tag!==13;)y=y.return;Fn=y}function wl(y){if(!_e||y!==Fn)return!1;if(!Or)return tf(y),Or=!0,!1;if(y.tag!==3&&(y.tag!==5||Id(y.type)&&!me(y.type,y.memoizedProps))){var b=on;if(b){if(rc(y))throw rf(),Error(s(418));for(;b;)ef(y,b),b=Yn(b)}}if(tf(y),y.tag===13){if(!_e)throw Error(s(316));if(y=y.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(s(317));on=ci(y)}else on=Fn?Yn(y.stateNode):null;return!0}function rf(){for(var y=on;y;)y=Yn(y)}function io(){_e&&(on=Fn=null,bl=Or=!1)}function nc(y){sa===null?sa=[y]:sa.push(y)}var ic=o.ReactCurrentBatchConfig;function gs(y,b){if(Ka(y,b))return!0;if(typeof y!="object"||y===null||typeof b!="object"||b===null)return!1;var M=Object.keys(y),z=Object.keys(b);if(M.length!==z.length)return!1;for(z=0;z<M.length;z++){var q=M[z];if(!Lo.call(b,q)||!Ka(y[q],b[q]))return!1}return!0}function Rp(y){switch(y.tag){case 5:return Is(y.type);case 16:return Is("Lazy");case 13:return Is("Suspense");case 19:return Is("SuspenseList");case 0:case 2:case 15:return y=Ta(y.type,!1),y;case 11:return y=Ta(y.type.render,!1),y;case 1:return y=Ta(y.type,!0),y;default:return""}}function Ya(y,b,M){if(y=M.ref,y!==null&&typeof y!="function"&&typeof y!="object"){if(M._owner){if(M=M._owner,M){if(M.tag!==1)throw Error(s(309));var z=M.stateNode}if(!z)throw Error(s(147,y));var q=z,ee=""+y;return b!==null&&b.ref!==null&&typeof b.ref=="function"&&b.ref._stringRef===ee?b.ref:(b=function(he){var Te=q.refs;he===null?delete Te[ee]:Te[ee]=he},b._stringRef=ee,b)}if(typeof y!="string")throw Error(s(284));if(!M._owner)throw Error(s(290,y))}return y}function Si(y,b){throw y=Object.prototype.toString.call(b),Error(s(31,y==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":y))}function Vd(y){var b=y._init;return b(y._payload)}function Ud(y){function b(Oe,Pe){if(y){var Fe=Oe.deletions;Fe===null?(Oe.deletions=[Pe],Oe.flags|=16):Fe.push(Pe)}}function M(Oe,Pe){if(!y)return null;for(;Pe!==null;)b(Oe,Pe),Pe=Pe.sibling;return null}function z(Oe,Pe){for(Oe=new Map;Pe!==null;)Pe.key!==null?Oe.set(Pe.key,Pe):Oe.set(Pe.index,Pe),Pe=Pe.sibling;return Oe}function q(Oe,Pe){return Oe=Vl(Oe,Pe),Oe.index=0,Oe.sibling=null,Oe}function ee(Oe,Pe,Fe){return Oe.index=Fe,y?(Fe=Oe.alternate,Fe!==null?(Fe=Fe.index,Fe<Pe?(Oe.flags|=2,Pe):Fe):(Oe.flags|=2,Pe)):(Oe.flags|=1048576,Pe)}function he(Oe){return y&&Oe.alternate===null&&(Oe.flags|=2),Oe}function Te(Oe,Pe,Fe,gt){return Pe===null||Pe.tag!==6?(Pe=Rc(Fe,Oe.mode,gt),Pe.return=Oe,Pe):(Pe=q(Pe,Fe),Pe.return=Oe,Pe)}function Be(Oe,Pe,Fe,gt){var Rt=Fe.type;return Rt===c?St(Oe,Pe,Fe.props.children,gt,Fe.key):Pe!==null&&(Pe.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===E&&Vd(Rt)===Pe.type)?(gt=q(Pe,Fe.props),gt.ref=Ya(Oe,Pe,Fe),gt.return=Oe,gt):(gt=Sf(Fe.type,Fe.key,Fe.props,null,Oe.mode,gt),gt.ref=Ya(Oe,Pe,Fe),gt.return=Oe,gt)}function nt(Oe,Pe,Fe,gt){return Pe===null||Pe.tag!==4||Pe.stateNode.containerInfo!==Fe.containerInfo||Pe.stateNode.implementation!==Fe.implementation?(Pe=kf(Fe,Oe.mode,gt),Pe.return=Oe,Pe):(Pe=q(Pe,Fe.children||[]),Pe.return=Oe,Pe)}function St(Oe,Pe,Fe,gt,Rt){return Pe===null||Pe.tag!==7?(Pe=Ei(Fe,Oe.mode,gt,Rt),Pe.return=Oe,Pe):(Pe=q(Pe,Fe),Pe.return=Oe,Pe)}function Kt(Oe,Pe,Fe){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return Pe=Rc(""+Pe,Oe.mode,Fe),Pe.return=Oe,Pe;if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case l:return Fe=Sf(Pe.type,Pe.key,Pe.props,null,Oe.mode,Fe),Fe.ref=Ya(Oe,null,Pe),Fe.return=Oe,Fe;case u:return Pe=kf(Pe,Oe.mode,Fe),Pe.return=Oe,Pe;case E:var gt=Pe._init;return Kt(Oe,gt(Pe._payload),Fe)}if(F(Pe)||j(Pe))return Pe=Ei(Pe,Oe.mode,Fe,null),Pe.return=Oe,Pe;Si(Oe,Pe)}return null}function mt(Oe,Pe,Fe,gt){var Rt=Pe!==null?Pe.key:null;if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number")return Rt!==null?null:Te(Oe,Pe,""+Fe,gt);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case l:return Fe.key===Rt?Be(Oe,Pe,Fe,gt):null;case u:return Fe.key===Rt?nt(Oe,Pe,Fe,gt):null;case E:return Rt=Fe._init,mt(Oe,Pe,Rt(Fe._payload),gt)}if(F(Fe)||j(Fe))return Rt!==null?null:St(Oe,Pe,Fe,gt,null);Si(Oe,Fe)}return null}function Zr(Oe,Pe,Fe,gt,Rt){if(typeof gt=="string"&&gt!==""||typeof gt=="number")return Oe=Oe.get(Fe)||null,Te(Pe,Oe,""+gt,Rt);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case l:return Oe=Oe.get(gt.key===null?Fe:gt.key)||null,Be(Pe,Oe,gt,Rt);case u:return Oe=Oe.get(gt.key===null?Fe:gt.key)||null,nt(Pe,Oe,gt,Rt);case E:var Jt=gt._init;return Zr(Oe,Pe,Fe,Jt(gt._payload),Rt)}if(F(gt)||j(gt))return Oe=Oe.get(Fe)||null,St(Pe,Oe,gt,Rt,null);Si(Pe,gt)}return null}function jr(Oe,Pe,Fe,gt){for(var Rt=null,Jt=null,Zt=Pe,gr=Pe=0,ii=null;Zt!==null&&gr<Fe.length;gr++){Zt.index>gr?(ii=Zt,Zt=null):ii=Zt.sibling;var pr=mt(Oe,Zt,Fe[gr],gt);if(pr===null){Zt===null&&(Zt=ii);break}y&&Zt&&pr.alternate===null&&b(Oe,Zt),Pe=ee(pr,Pe,gr),Jt===null?Rt=pr:Jt.sibling=pr,Jt=pr,Zt=ii}if(gr===Fe.length)return M(Oe,Zt),Or&&aa(Oe,gr),Rt;if(Zt===null){for(;gr<Fe.length;gr++)Zt=Kt(Oe,Fe[gr],gt),Zt!==null&&(Pe=ee(Zt,Pe,gr),Jt===null?Rt=Zt:Jt.sibling=Zt,Jt=Zt);return Or&&aa(Oe,gr),Rt}for(Zt=z(Oe,Zt);gr<Fe.length;gr++)ii=Zr(Zt,Oe,gr,Fe[gr],gt),ii!==null&&(y&&ii.alternate!==null&&Zt.delete(ii.key===null?gr:ii.key),Pe=ee(ii,Pe,gr),Jt===null?Rt=ii:Jt.sibling=ii,Jt=ii);return y&&Zt.forEach(function(Hi){return b(Oe,Hi)}),Or&&aa(Oe,gr),Rt}function ga(Oe,Pe,Fe,gt){var Rt=j(Fe);if(typeof Rt!="function")throw Error(s(150));if(Fe=Rt.call(Fe),Fe==null)throw Error(s(151));for(var Jt=Rt=null,Zt=Pe,gr=Pe=0,ii=null,pr=Fe.next();Zt!==null&&!pr.done;gr++,pr=Fe.next()){Zt.index>gr?(ii=Zt,Zt=null):ii=Zt.sibling;var Hi=mt(Oe,Zt,pr.value,gt);if(Hi===null){Zt===null&&(Zt=ii);break}y&&Zt&&Hi.alternate===null&&b(Oe,Zt),Pe=ee(Hi,Pe,gr),Jt===null?Rt=Hi:Jt.sibling=Hi,Jt=Hi,Zt=ii}if(pr.done)return M(Oe,Zt),Or&&aa(Oe,gr),Rt;if(Zt===null){for(;!pr.done;gr++,pr=Fe.next())pr=Kt(Oe,pr.value,gt),pr!==null&&(Pe=ee(pr,Pe,gr),Jt===null?Rt=pr:Jt.sibling=pr,Jt=pr);return Or&&aa(Oe,gr),Rt}for(Zt=z(Oe,Zt);!pr.done;gr++,pr=Fe.next())pr=Zr(Zt,Oe,gr,pr.value,gt),pr!==null&&(y&&pr.alternate!==null&&Zt.delete(pr.key===null?gr:pr.key),Pe=ee(pr,Pe,gr),Jt===null?Rt=pr:Jt.sibling=pr,Jt=pr);return y&&Zt.forEach(function(Jx){return b(Oe,Jx)}),Or&&aa(Oe,gr),Rt}function yo(Oe,Pe,Fe,gt){if(typeof Fe=="object"&&Fe!==null&&Fe.type===c&&Fe.key===null&&(Fe=Fe.props.children),typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case l:e:{for(var Rt=Fe.key,Jt=Pe;Jt!==null;){if(Jt.key===Rt){if(Rt=Fe.type,Rt===c){if(Jt.tag===7){M(Oe,Jt.sibling),Pe=q(Jt,Fe.props.children),Pe.return=Oe,Oe=Pe;break e}}else if(Jt.elementType===Rt||typeof Rt=="object"&&Rt!==null&&Rt.$$typeof===E&&Vd(Rt)===Jt.type){M(Oe,Jt.sibling),Pe=q(Jt,Fe.props),Pe.ref=Ya(Oe,Jt,Fe),Pe.return=Oe,Oe=Pe;break e}M(Oe,Jt);break}else b(Oe,Jt);Jt=Jt.sibling}Fe.type===c?(Pe=Ei(Fe.props.children,Oe.mode,gt,Fe.key),Pe.return=Oe,Oe=Pe):(gt=Sf(Fe.type,Fe.key,Fe.props,null,Oe.mode,gt),gt.ref=Ya(Oe,Pe,Fe),gt.return=Oe,Oe=gt)}return he(Oe);case u:e:{for(Jt=Fe.key;Pe!==null;){if(Pe.key===Jt)if(Pe.tag===4&&Pe.stateNode.containerInfo===Fe.containerInfo&&Pe.stateNode.implementation===Fe.implementation){M(Oe,Pe.sibling),Pe=q(Pe,Fe.children||[]),Pe.return=Oe,Oe=Pe;break e}else{M(Oe,Pe);break}else b(Oe,Pe);Pe=Pe.sibling}Pe=kf(Fe,Oe.mode,gt),Pe.return=Oe,Oe=Pe}return he(Oe);case E:return Jt=Fe._init,yo(Oe,Pe,Jt(Fe._payload),gt)}if(F(Fe))return jr(Oe,Pe,Fe,gt);if(j(Fe))return ga(Oe,Pe,Fe,gt);Si(Oe,Fe)}return typeof Fe=="string"&&Fe!==""||typeof Fe=="number"?(Fe=""+Fe,Pe!==null&&Pe.tag===6?(M(Oe,Pe.sibling),Pe=q(Pe,Fe),Pe.return=Oe,Oe=Pe):(M(Oe,Pe),Pe=Rc(Fe,Oe.mode,gt),Pe.return=Oe,Oe=Pe),he(Oe)):M(Oe,Pe)}return yo}var zo=Ud(!0),ac=Ud(!1),_l=pn(null),sc=null,Sl=null,oc=null;function Hd(){oc=Sl=sc=null}function Ma(y,b,M){fe?(ot(_l,b._currentValue),b._currentValue=M):(ot(_l,b._currentValue2),b._currentValue2=M)}function vs(y){var b=_l.current;vr(_l),fe?y._currentValue=b:y._currentValue2=b}function Fo(y,b,M){for(;y!==null;){var z=y.alternate;if((y.childLanes&b)!==b?(y.childLanes|=b,z!==null&&(z.childLanes|=b)):z!==null&&(z.childLanes&b)!==b&&(z.childLanes|=b),y===M)break;y=y.return}}function Li(y,b){sc=y,oc=Sl=null,y=y.dependencies,y!==null&&y.firstContext!==null&&((y.lanes&b)!==0&&(Nn=!0),y.firstContext=null)}function oa(y){var b=fe?y._currentValue:y._currentValue2;if(oc!==y)if(y={context:y,memoizedValue:b,next:null},Sl===null){if(sc===null)throw Error(s(308));Sl=y,sc.dependencies={lanes:0,firstContext:y}}else Sl=Sl.next=y;return b}var la=null;function lc(y){la===null?la=[y]:la.push(y)}function Vo(y,b,M,z){var q=b.interleaved;return q===null?(M.next=M,lc(b)):(M.next=q.next,q.next=M),b.interleaved=M,Aa(y,z)}function Aa(y,b){y.lanes|=b;var M=y.alternate;for(M!==null&&(M.lanes|=b),M=y,y=y.return;y!==null;)y.childLanes|=b,M=y.alternate,M!==null&&(M.childLanes|=b),M=y,y=y.return;return M.tag===3?M.stateNode:null}var hi=!1;function Gd(y){y.updateQueue={baseState:y.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vs(y,b){y=y.updateQueue,b.updateQueue===y&&(b.updateQueue={baseState:y.baseState,firstBaseUpdate:y.firstBaseUpdate,lastBaseUpdate:y.lastBaseUpdate,shared:y.shared,effects:y.effects})}function ja(y,b){return{eventTime:y,lane:b,tag:0,payload:null,callback:null,next:null}}function Us(y,b,M){var z=y.updateQueue;if(z===null)return null;if(z=z.shared,(Qt&2)!==0){var q=z.pending;return q===null?b.next=b:(b.next=q.next,q.next=b),z.pending=b,Aa(y,M)}return q=z.interleaved,q===null?(b.next=b,lc(z)):(b.next=q.next,q.next=b),z.interleaved=b,Aa(y,M)}function Uo(y,b,M){if(b=b.updateQueue,b!==null&&(b=b.shared,(M&4194240)!==0)){var z=b.lanes;z&=y.pendingLanes,M|=z,b.lanes=M,Pa(y,M)}}function kl(y,b){var M=y.updateQueue,z=y.alternate;if(z!==null&&(z=z.updateQueue,M===z)){var q=null,ee=null;if(M=M.firstBaseUpdate,M!==null){do{var he={eventTime:M.eventTime,lane:M.lane,tag:M.tag,payload:M.payload,callback:M.callback,next:null};ee===null?q=ee=he:ee=ee.next=he,M=M.next}while(M!==null);ee===null?q=ee=b:ee=ee.next=b}else q=ee=b;M={baseState:z.baseState,firstBaseUpdate:q,lastBaseUpdate:ee,shared:z.shared,effects:z.effects},y.updateQueue=M;return}y=M.lastBaseUpdate,y===null?M.firstBaseUpdate=b:y.next=b,M.lastBaseUpdate=b}function fi(y,b,M,z){var q=y.updateQueue;hi=!1;var ee=q.firstBaseUpdate,he=q.lastBaseUpdate,Te=q.shared.pending;if(Te!==null){q.shared.pending=null;var Be=Te,nt=Be.next;Be.next=null,he===null?ee=nt:he.next=nt,he=Be;var St=y.alternate;St!==null&&(St=St.updateQueue,Te=St.lastBaseUpdate,Te!==he&&(Te===null?St.firstBaseUpdate=nt:Te.next=nt,St.lastBaseUpdate=Be))}if(ee!==null){var Kt=q.baseState;he=0,St=nt=Be=null,Te=ee;do{var mt=Te.lane,Zr=Te.eventTime;if((z&mt)===mt){St!==null&&(St=St.next={eventTime:Zr,lane:0,tag:Te.tag,payload:Te.payload,callback:Te.callback,next:null});e:{var jr=y,ga=Te;switch(mt=b,Zr=M,ga.tag){case 1:if(jr=ga.payload,typeof jr=="function"){Kt=jr.call(Zr,Kt,mt);break e}Kt=jr;break e;case 3:jr.flags=jr.flags&-65537|128;case 0:if(jr=ga.payload,mt=typeof jr=="function"?jr.call(Zr,Kt,mt):jr,mt==null)break e;Kt=a({},Kt,mt);break e;case 2:hi=!0}}Te.callback!==null&&Te.lane!==0&&(y.flags|=64,mt=q.effects,mt===null?q.effects=[Te]:mt.push(Te))}else Zr={eventTime:Zr,lane:mt,tag:Te.tag,payload:Te.payload,callback:Te.callback,next:null},St===null?(nt=St=Zr,Be=Kt):St=St.next=Zr,he|=mt;if(Te=Te.next,Te===null){if(Te=q.shared.pending,Te===null)break;mt=Te,Te=mt.next,mt.next=null,q.lastBaseUpdate=mt,q.shared.pending=null}}while(!0);if(St===null&&(Be=Kt),q.baseState=Be,q.firstBaseUpdate=nt,q.lastBaseUpdate=St,b=q.shared.interleaved,b!==null){q=b;do he|=q.lane,q=q.next;while(q!==b)}else ee===null&&(q.shared.lanes=0);el|=he,y.lanes=he,y.memoizedState=Kt}}function nf(y,b,M){if(y=b.effects,b.effects=null,y!==null)for(b=0;b<y.length;b++){var z=y[b],q=z.callback;if(q!==null){if(z.callback=null,z=M,typeof q!="function")throw Error(s(191,q));q.call(z)}}}var ua={},Ra=pn(ua),Oi=pn(ua),Xa=pn(ua);function ca(y){if(y===ua)throw Error(s(174));return y}function Cl(y,b){ot(Xa,b),ot(Oi,y),ot(Ra,ua),y=X(b),vr(Ra),ot(Ra,y)}function ys(){vr(Ra),vr(Oi),vr(Xa)}function mu(y){var b=ca(Xa.current),M=ca(Ra.current);b=Q(M,y.type,b),M!==b&&(ot(Oi,y),ot(Ra,b))}function El(y){Oi.current===y&&(vr(Ra),vr(Oi))}var kr=pn(0);function Ho(y){for(var b=y;b!==null;){if(b.tag===13){var M=b.memoizedState;if(M!==null&&(M=M.dehydrated,M===null||nn(M)||ur(M)))return b}else if(b.tag===19&&b.memoizedProps.revealOrder!==void 0){if((b.flags&128)!==0)return b}else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===y)break;for(;b.sibling===null;){if(b.return===null||b.return===y)return null;b=b.return}b.sibling.return=b.return,b=b.sibling}return null}var gu=[];function uc(){for(var y=0;y<gu.length;y++){var b=gu[y];fe?b._workInProgressVersionPrimary=null:b._workInProgressVersionSecondary=null}gu.length=0}var Di=o.ReactCurrentDispatcher,xs=o.ReactCurrentBatchConfig,ao=0,Fr=null,kn=null,Cn=null,Nl=!1,Ii=!1,so=0,Tl=0;function mn(){throw Error(s(321))}function Go(y,b){if(b===null)return!1;for(var M=0;M<b.length&&M<y.length;M++)if(!Ka(y[M],b[M]))return!1;return!0}function Pl(y,b,M,z,q,ee){if(ao=ee,Fr=b,b.memoizedState=null,b.updateQueue=null,b.lanes=0,Di.current=y===null||y.memoizedState===null?pt:Dt,y=M(z,q),Ii){ee=0;do{if(Ii=!1,so=0,25<=ee)throw Error(s(301));ee+=1,Cn=kn=null,b.updateQueue=null,Di.current=Xt,y=M(z,q)}while(Ii)}if(Di.current=$e,b=kn!==null&&kn.next!==null,ao=0,Cn=kn=Fr=null,Nl=!1,b)throw Error(s(300));return y}function cc(){var y=so!==0;return so=0,y}function ei(){var y={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?Fr.memoizedState=Cn=y:Cn=Cn.next=y,Cn}function ti(){if(kn===null){var y=Fr.alternate;y=y!==null?y.memoizedState:null}else y=kn.next;var b=Cn===null?Fr.memoizedState:Cn.next;if(b!==null)Cn=b,kn=y;else{if(y===null)throw Error(s(310));kn=y,y={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},Cn===null?Fr.memoizedState=Cn=y:Cn=Cn.next=y}return Cn}function La(y,b){return typeof b=="function"?b(y):b}function vu(y){var b=ti(),M=b.queue;if(M===null)throw Error(s(311));M.lastRenderedReducer=y;var z=kn,q=z.baseQueue,ee=M.pending;if(ee!==null){if(q!==null){var he=q.next;q.next=ee.next,ee.next=he}z.baseQueue=q=ee,M.pending=null}if(q!==null){ee=q.next,z=z.baseState;var Te=he=null,Be=null,nt=ee;do{var St=nt.lane;if((ao&St)===St)Be!==null&&(Be=Be.next={lane:0,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null}),z=nt.hasEagerState?nt.eagerState:y(z,nt.action);else{var Kt={lane:St,action:nt.action,hasEagerState:nt.hasEagerState,eagerState:nt.eagerState,next:null};Be===null?(Te=Be=Kt,he=z):Be=Be.next=Kt,Fr.lanes|=St,el|=St}nt=nt.next}while(nt!==null&&nt!==ee);Be===null?he=z:Be.next=Te,Ka(z,b.memoizedState)||(Nn=!0),b.memoizedState=z,b.baseState=he,b.baseQueue=Be,M.lastRenderedState=z}if(y=M.interleaved,y!==null){q=y;do ee=q.lane,Fr.lanes|=ee,el|=ee,q=q.next;while(q!==y)}else q===null&&(M.lanes=0);return[b.memoizedState,M.dispatch]}function qo(y){var b=ti(),M=b.queue;if(M===null)throw Error(s(311));M.lastRenderedReducer=y;var z=M.dispatch,q=M.pending,ee=b.memoizedState;if(q!==null){M.pending=null;var he=q=q.next;do ee=y(ee,he.action),he=he.next;while(he!==q);Ka(ee,b.memoizedState)||(Nn=!0),b.memoizedState=ee,b.baseQueue===null&&(b.baseState=ee),M.lastRenderedState=ee}return[ee,z]}function qd(){}function Qa(y,b){var M=Fr,z=ti(),q=b(),ee=!Ka(z.memoizedState,q);if(ee&&(z.memoizedState=q,Nn=!0),z=z.queue,yu(Wo.bind(null,M,z,y),[y]),z.getSnapshot!==b||ee||Cn!==null&&Cn.memoizedState.tag&1){if(M.flags|=2048,lo(9,hc.bind(null,M,z,q,b),void 0,null),Ur===null)throw Error(s(349));(ao&30)!==0||dc(M,b,q)}return q}function dc(y,b,M){y.flags|=16384,y={getSnapshot:b,value:M},b=Fr.updateQueue,b===null?(b={lastEffect:null,stores:null},Fr.updateQueue=b,b.stores=[y]):(M=b.stores,M===null?b.stores=[y]:M.push(y))}function hc(y,b,M,z){b.value=M,b.getSnapshot=z,Wd(b)&&Oa(y)}function Wo(y,b,M){return M(function(){Wd(b)&&Oa(y)})}function Wd(y){var b=y.getSnapshot;y=y.value;try{var M=b();return!Ka(y,M)}catch{return!0}}function Oa(y){var b=Aa(y,1);b!==null&&Vi(b,y,1,-1)}function oo(y){var b=ei();return typeof y=="function"&&(y=y()),b.memoizedState=b.baseState=y,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:La,lastRenderedState:y},b.queue=y,y=y.dispatch=le.bind(null,Fr,y),[b.memoizedState,y]}function lo(y,b,M,z){return y={tag:y,create:b,destroy:M,deps:z,next:null},b=Fr.updateQueue,b===null?(b={lastEffect:null,stores:null},Fr.updateQueue=b,b.lastEffect=y.next=y):(M=b.lastEffect,M===null?b.lastEffect=y.next=y:(z=M.next,M.next=y,y.next=z,b.lastEffect=y)),y}function $d(){return ti().memoizedState}function fc(y,b,M,z){var q=ei();Fr.flags|=y,q.memoizedState=lo(1|b,M,void 0,z===void 0?null:z)}function Hs(y,b,M,z){var q=ti();z=z===void 0?null:z;var ee=void 0;if(kn!==null){var he=kn.memoizedState;if(ee=he.destroy,z!==null&&Go(z,he.deps)){q.memoizedState=lo(b,M,ee,z);return}}Fr.flags|=y,q.memoizedState=lo(1|b,M,ee,z)}function Kd(y,b){return fc(8390656,8,y,b)}function yu(y,b){return Hs(2048,8,y,b)}function pc(y,b){return Hs(4,2,y,b)}function Pr(y,b){return Hs(4,4,y,b)}function mc(y,b){if(typeof b=="function")return y=y(),b(y),function(){b(null)};if(b!=null)return y=y(),b.current=y,function(){b.current=null}}function Ml(y,b,M){return M=M!=null?M.concat([y]):null,Hs(4,4,mc.bind(null,b,y),M)}function uo(){}function Zd(y,b){var M=ti();b=b===void 0?null:b;var z=M.memoizedState;return z!==null&&b!==null&&Go(b,z[1])?z[0]:(M.memoizedState=[y,b],y)}function h(y,b){var M=ti();b=b===void 0?null:b;var z=M.memoizedState;return z!==null&&b!==null&&Go(b,z[1])?z[0]:(y=y(),M.memoizedState=[y,b],y)}function w(y,b,M){return(ao&21)===0?(y.baseState&&(y.baseState=!1,Nn=!0),y.memoizedState=M):(Ka(M,b)||(M=ml(),Fr.lanes|=M,el|=M,y.baseState=!0),b)}function P(y,b){var M=nr;nr=M!==0&&4>M?M:4,y(!0);var z=xs.transition;xs.transition={};try{y(!1),b()}finally{nr=M,xs.transition=z}}function U(){return ti().memoizedState}function J(y,b,M){var z=ni(y);if(M={lane:z,action:M,hasEagerState:!1,eagerState:null,next:null},we(y))Me(b,M);else if(M=Vo(y,b,M,z),M!==null){var q=Qr();Vi(M,y,z,q),Le(M,b,z)}}function le(y,b,M){var z=ni(y),q={lane:z,action:M,hasEagerState:!1,eagerState:null,next:null};if(we(y))Me(b,q);else{var ee=y.alternate;if(y.lanes===0&&(ee===null||ee.lanes===0)&&(ee=b.lastRenderedReducer,ee!==null))try{var he=b.lastRenderedState,Te=ee(he,M);if(q.hasEagerState=!0,q.eagerState=Te,Ka(Te,he)){var Be=b.interleaved;Be===null?(q.next=q,lc(b)):(q.next=Be.next,Be.next=q),b.interleaved=q;return}}catch{}M=Vo(y,b,q,z),M!==null&&(q=Qr(),Vi(M,y,z,q),Le(M,b,z))}}function we(y){var b=y.alternate;return y===Fr||b!==null&&b===Fr}function Me(y,b){Ii=Nl=!0;var M=y.pending;M===null?b.next=b:(b.next=M.next,M.next=b),y.pending=b}function Le(y,b,M){if((M&4194240)!==0){var z=b.lanes;z&=y.pendingLanes,M|=z,b.lanes=M,Pa(y,M)}}var $e={readContext:oa,useCallback:mn,useContext:mn,useEffect:mn,useImperativeHandle:mn,useInsertionEffect:mn,useLayoutEffect:mn,useMemo:mn,useReducer:mn,useRef:mn,useState:mn,useDebugValue:mn,useDeferredValue:mn,useTransition:mn,useMutableSource:mn,useSyncExternalStore:mn,useId:mn,unstable_isNewReconciler:!1},pt={readContext:oa,useCallback:function(y,b){return ei().memoizedState=[y,b===void 0?null:b],y},useContext:oa,useEffect:Kd,useImperativeHandle:function(y,b,M){return M=M!=null?M.concat([y]):null,fc(4194308,4,mc.bind(null,b,y),M)},useLayoutEffect:function(y,b){return fc(4194308,4,y,b)},useInsertionEffect:function(y,b){return fc(4,2,y,b)},useMemo:function(y,b){var M=ei();return b=b===void 0?null:b,y=y(),M.memoizedState=[y,b],y},useReducer:function(y,b,M){var z=ei();return b=M!==void 0?M(b):b,z.memoizedState=z.baseState=b,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:y,lastRenderedState:b},z.queue=y,y=y.dispatch=J.bind(null,Fr,y),[z.memoizedState,y]},useRef:function(y){var b=ei();return y={current:y},b.memoizedState=y},useState:oo,useDebugValue:uo,useDeferredValue:function(y){return ei().memoizedState=y},useTransition:function(){var y=oo(!1),b=y[0];return y=P.bind(null,y[1]),ei().memoizedState=y,[b,y]},useMutableSource:function(){},useSyncExternalStore:function(y,b,M){var z=Fr,q=ei();if(Or){if(M===void 0)throw Error(s(407));M=M()}else{if(M=b(),Ur===null)throw Error(s(349));(ao&30)!==0||dc(z,b,M)}q.memoizedState=M;var ee={value:M,getSnapshot:b};return q.queue=ee,Kd(Wo.bind(null,z,ee,y),[y]),z.flags|=2048,lo(9,hc.bind(null,z,ee,M,b),void 0,null),M},useId:function(){var y=ei(),b=Ur.identifierPrefix;if(Or){var M=Za,z=ji;M=(z&~(1<<32-di(z)-1)).toString(32)+M,b=":"+b+"R"+M,M=so++,0<M&&(b+="H"+M.toString(32)),b+=":"}else M=Tl++,b=":"+b+"r"+M.toString(32)+":";return y.memoizedState=b},unstable_isNewReconciler:!1},Dt={readContext:oa,useCallback:Zd,useContext:oa,useEffect:yu,useImperativeHandle:Ml,useInsertionEffect:pc,useLayoutEffect:Pr,useMemo:h,useReducer:vu,useRef:$d,useState:function(){return vu(La)},useDebugValue:uo,useDeferredValue:function(y){var b=ti();return w(b,kn.memoizedState,y)},useTransition:function(){var y=vu(La)[0],b=ti().memoizedState;return[y,b]},useMutableSource:qd,useSyncExternalStore:Qa,useId:U,unstable_isNewReconciler:!1},Xt={readContext:oa,useCallback:Zd,useContext:oa,useEffect:yu,useImperativeHandle:Ml,useInsertionEffect:pc,useLayoutEffect:Pr,useMemo:h,useReducer:qo,useRef:$d,useState:function(){return qo(La)},useDebugValue:uo,useDeferredValue:function(y){var b=ti();return kn===null?b.memoizedState=y:w(b,kn.memoizedState,y)},useTransition:function(){var y=qo(La)[0],b=ti().memoizedState;return[y,b]},useMutableSource:qd,useSyncExternalStore:Qa,useId:U,unstable_isNewReconciler:!1};function Mr(y,b){if(y&&y.defaultProps){b=a({},b),y=y.defaultProps;for(var M in y)b[M]===void 0&&(b[M]=y[M]);return b}return b}function En(y,b,M,z){b=y.memoizedState,M=M(z,b),M=M==null?b:a({},b,M),y.memoizedState=M,y.lanes===0&&(y.updateQueue.baseState=M)}var pi={isMounted:function(y){return(y=y._reactInternals)?I(y)===y:!1},enqueueSetState:function(y,b,M){y=y._reactInternals;var z=Qr(),q=ni(y),ee=ja(z,q);ee.payload=b,M!=null&&(ee.callback=M),b=Us(y,ee,q),b!==null&&(Vi(b,y,q,z),Uo(b,y,q))},enqueueReplaceState:function(y,b,M){y=y._reactInternals;var z=Qr(),q=ni(y),ee=ja(z,q);ee.tag=1,ee.payload=b,M!=null&&(ee.callback=M),b=Us(y,ee,q),b!==null&&(Vi(b,y,q,z),Uo(b,y,q))},enqueueForceUpdate:function(y,b){y=y._reactInternals;var M=Qr(),z=ni(y),q=ja(M,z);q.tag=2,b!=null&&(q.callback=b),b=Us(y,q,z),b!==null&&(Vi(b,y,z,M),Uo(b,y,z))}};function ki(y,b,M,z,q,ee,he){return y=y.stateNode,typeof y.shouldComponentUpdate=="function"?y.shouldComponentUpdate(z,ee,he):b.prototype&&b.prototype.isPureReactComponent?!gs(M,z)||!gs(q,ee):!0}function $o(y,b,M){var z=!1,q=cr,ee=b.contextType;return typeof ee=="object"&&ee!==null?ee=oa(ee):(q=Tt(b)?Nr:sn.current,z=b.contextTypes,ee=(z=z!=null)?ra(y,q):cr),b=new b(M,ee),y.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=pi,y.stateNode=b,b._reactInternals=y,z&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=q,y.__reactInternalMemoizedMaskedChildContext=ee),b}function gc(y,b,M,z){y=b.state,typeof b.componentWillReceiveProps=="function"&&b.componentWillReceiveProps(M,z),typeof b.UNSAFE_componentWillReceiveProps=="function"&&b.UNSAFE_componentWillReceiveProps(M,z),b.state!==y&&pi.enqueueReplaceState(b,b.state,null)}function bs(y,b,M,z){var q=y.stateNode;q.props=M,q.state=y.memoizedState,q.refs={},Gd(y);var ee=b.contextType;typeof ee=="object"&&ee!==null?q.context=oa(ee):(ee=Tt(b)?Nr:sn.current,q.context=ra(y,ee)),q.state=y.memoizedState,ee=b.getDerivedStateFromProps,typeof ee=="function"&&(En(y,b,ee,M),q.state=y.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(b=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),b!==q.state&&pi.enqueueReplaceState(q,q.state,null),fi(y,M,q,z),q.state=y.memoizedState),typeof q.componentDidMount=="function"&&(y.flags|=4194308)}function Ko(y,b){try{var M="",z=b;do M+=Rp(z),z=z.return;while(z);var q=M}catch(ee){q=`
Error generating stack: `+ee.message+`
`+ee.stack}return{value:y,source:b,stack:q,digest:null}}function Gs(y,b,M){return{value:y,source:null,stack:M??null,digest:b??null}}function Da(y,b){try{console.error(b.value)}catch(M){setTimeout(function(){throw M})}}var Al=typeof WeakMap=="function"?WeakMap:Map;function xr(y,b,M){M=ja(-1,M),M.tag=3,M.payload={element:null};var z=b.value;return M.callback=function(){Pn||(Pn=!0,Un=z),Da(y,b)},M}function Zo(y,b,M){M=ja(-1,M),M.tag=3;var z=y.type.getDerivedStateFromError;if(typeof z=="function"){var q=b.value;M.payload=function(){return z(q)},M.callback=function(){Da(y,b)}}var ee=y.stateNode;return ee!==null&&typeof ee.componentDidCatch=="function"&&(M.callback=function(){Da(y,b),typeof z!="function"&&(Ws===null?Ws=new Set([this]):Ws.add(this));var he=b.stack;this.componentDidCatch(b.value,{componentStack:he!==null?he:""})}),M}function af(y,b,M){var z=y.pingCache;if(z===null){z=y.pingCache=new Al;var q=new Set;z.set(b,q)}else q=z.get(b),q===void 0&&(q=new Set,z.set(b,q));q.has(M)||(q.add(M),y=Pv.bind(null,y,b,M),b.then(y,y))}function sf(y){do{var b;if((b=y.tag===13)&&(b=y.memoizedState,b=b!==null?b.dehydrated!==null:!0),b)return y;y=y.return}while(y!==null);return null}function co(y,b,M,z,q){return(y.mode&1)===0?(y===b?y.flags|=65536:(y.flags|=128,M.flags|=131072,M.flags&=-52805,M.tag===1&&(M.alternate===null?M.tag=17:(b=ja(-1,1),b.tag=2,Us(M,b,1))),M.lanes|=1),y):(y.flags|=65536,y.lanes=q,y)}var Yo=o.ReactCurrentOwner,Nn=!1;function Vn(y,b,M,z){b.child=y===null?ac(b,null,M,z):zo(b,y.child,M,z)}function of(y,b,M,z,q){M=M.render;var ee=b.ref;return Li(b,q),z=Pl(y,b,M,z,ee,q),M=cc(),y!==null&&!Nn?(b.updateQueue=y.updateQueue,b.flags&=-2053,y.lanes&=~q,Qo(y,b,q)):(Or&&M&&Ri(b),b.flags|=1,Vn(y,b,z,q),b.child)}function xu(y,b,M,z,q){if(y===null){var ee=M.type;return typeof ee=="function"&&!Ac(ee)&&ee.defaultProps===void 0&&M.compare===null&&M.defaultProps===void 0?(b.tag=15,b.type=ee,Xo(y,b,ee,z,q)):(y=Sf(M.type,null,z,b,b.mode,q),y.ref=b.ref,y.return=b,b.child=y)}if(ee=y.child,(y.lanes&q)===0){var he=ee.memoizedProps;if(M=M.compare,M=M!==null?M:gs,M(he,z)&&y.ref===b.ref)return Qo(y,b,q)}return b.flags|=1,y=Vl(ee,z),y.ref=b.ref,y.return=b,b.child=y}function Xo(y,b,M,z,q){if(y!==null){var ee=y.memoizedProps;if(gs(ee,z)&&y.ref===b.ref)if(Nn=!1,b.pendingProps=z=ee,(y.lanes&q)!==0)(y.flags&131072)!==0&&(Nn=!0);else return b.lanes=y.lanes,Qo(y,b,q)}return ho(y,b,M,z,q)}function $r(y,b,M){var z=b.pendingProps,q=z.children,ee=y!==null?y.memoizedState:null;if(z.mode==="hidden")if((b.mode&1)===0)b.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot(Il,ri),ri|=M;else{if((M&1073741824)===0)return y=ee!==null?ee.baseLanes|M:M,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:y,cachePool:null,transitions:null},b.updateQueue=null,ot(Il,ri),ri|=y,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null},z=ee!==null?ee.baseLanes:M,ot(Il,ri),ri|=z}else ee!==null?(z=ee.baseLanes|M,b.memoizedState=null):z=M,ot(Il,ri),ri|=z;return Vn(y,b,q,M),b.child}function Vr(y,b){var M=b.ref;(y===null&&M!==null||y!==null&&y.ref!==M)&&(b.flags|=512,b.flags|=2097152)}function ho(y,b,M,z,q){var ee=Tt(M)?Nr:sn.current;return ee=ra(b,ee),Li(b,q),M=Pl(y,b,M,z,ee,q),z=cc(),y!==null&&!Nn?(b.updateQueue=y.updateQueue,b.flags&=-2053,y.lanes&=~q,Qo(y,b,q)):(Or&&z&&Ri(b),b.flags|=1,Vn(y,b,M,q),b.child)}function Ci(y,b,M,z,q){if(Tt(M)){var ee=!0;Xn(b)}else ee=!1;if(Li(b,q),b.stateNode===null)Yd(y,b),$o(b,M,z),bs(b,M,z,q),z=!0;else if(y===null){var he=b.stateNode,Te=b.memoizedProps;he.props=Te;var Be=he.context,nt=M.contextType;typeof nt=="object"&&nt!==null?nt=oa(nt):(nt=Tt(M)?Nr:sn.current,nt=ra(b,nt));var St=M.getDerivedStateFromProps,Kt=typeof St=="function"||typeof he.getSnapshotBeforeUpdate=="function";Kt||typeof he.UNSAFE_componentWillReceiveProps!="function"&&typeof he.componentWillReceiveProps!="function"||(Te!==z||Be!==nt)&&gc(b,he,z,nt),hi=!1;var mt=b.memoizedState;he.state=mt,fi(b,z,he,q),Be=b.memoizedState,Te!==z||mt!==Be||zr.current||hi?(typeof St=="function"&&(En(b,M,St,z),Be=b.memoizedState),(Te=hi||ki(b,M,Te,z,mt,Be,nt))?(Kt||typeof he.UNSAFE_componentWillMount!="function"&&typeof he.componentWillMount!="function"||(typeof he.componentWillMount=="function"&&he.componentWillMount(),typeof he.UNSAFE_componentWillMount=="function"&&he.UNSAFE_componentWillMount()),typeof he.componentDidMount=="function"&&(b.flags|=4194308)):(typeof he.componentDidMount=="function"&&(b.flags|=4194308),b.memoizedProps=z,b.memoizedState=Be),he.props=z,he.state=Be,he.context=nt,z=Te):(typeof he.componentDidMount=="function"&&(b.flags|=4194308),z=!1)}else{he=b.stateNode,Vs(y,b),Te=b.memoizedProps,nt=b.type===b.elementType?Te:Mr(b.type,Te),he.props=nt,Kt=b.pendingProps,mt=he.context,Be=M.contextType,typeof Be=="object"&&Be!==null?Be=oa(Be):(Be=Tt(M)?Nr:sn.current,Be=ra(b,Be));var Zr=M.getDerivedStateFromProps;(St=typeof Zr=="function"||typeof he.getSnapshotBeforeUpdate=="function")||typeof he.UNSAFE_componentWillReceiveProps!="function"&&typeof he.componentWillReceiveProps!="function"||(Te!==Kt||mt!==Be)&&gc(b,he,z,Be),hi=!1,mt=b.memoizedState,he.state=mt,fi(b,z,he,q);var jr=b.memoizedState;Te!==Kt||mt!==jr||zr.current||hi?(typeof Zr=="function"&&(En(b,M,Zr,z),jr=b.memoizedState),(nt=hi||ki(b,M,nt,z,mt,jr,Be)||!1)?(St||typeof he.UNSAFE_componentWillUpdate!="function"&&typeof he.componentWillUpdate!="function"||(typeof he.componentWillUpdate=="function"&&he.componentWillUpdate(z,jr,Be),typeof he.UNSAFE_componentWillUpdate=="function"&&he.UNSAFE_componentWillUpdate(z,jr,Be)),typeof he.componentDidUpdate=="function"&&(b.flags|=4),typeof he.getSnapshotBeforeUpdate=="function"&&(b.flags|=1024)):(typeof he.componentDidUpdate!="function"||Te===y.memoizedProps&&mt===y.memoizedState||(b.flags|=4),typeof he.getSnapshotBeforeUpdate!="function"||Te===y.memoizedProps&&mt===y.memoizedState||(b.flags|=1024),b.memoizedProps=z,b.memoizedState=jr),he.props=z,he.state=jr,he.context=Be,z=nt):(typeof he.componentDidUpdate!="function"||Te===y.memoizedProps&&mt===y.memoizedState||(b.flags|=4),typeof he.getSnapshotBeforeUpdate!="function"||Te===y.memoizedProps&&mt===y.memoizedState||(b.flags|=1024),z=!1)}return Bi(y,b,M,z,ee,q)}function Bi(y,b,M,z,q,ee){Vr(y,b);var he=(b.flags&128)!==0;if(!z&&!he)return q&&Bd(b,M,!1),Qo(y,b,ee);z=b.stateNode,Yo.current=b;var Te=he&&typeof M.getDerivedStateFromError!="function"?null:z.render();return b.flags|=1,y!==null&&he?(b.child=zo(b,y.child,null,ee),b.child=zo(b,null,Te,ee)):Vn(y,b,Te,ee),b.memoizedState=z.state,q&&Bd(b,M,!0),b.child}function jl(y){var b=y.stateNode;b.pendingContext?Ju(y,b.pendingContext,b.pendingContext!==b.context):b.context&&Ju(y,b.context,!1),Cl(y,b.containerInfo)}function bu(y,b,M,z,q){return io(),nc(q),b.flags|=256,Vn(y,b,M,z),b.child}var zi={dehydrated:null,treeContext:null,retryLane:0};function vc(y){return{baseLanes:y,cachePool:null,transitions:null}}function Lp(y,b,M){var z=b.pendingProps,q=kr.current,ee=!1,he=(b.flags&128)!==0,Te;if((Te=he)||(Te=y!==null&&y.memoizedState===null?!1:(q&2)!==0),Te?(ee=!0,b.flags&=-129):(y===null||y.memoizedState!==null)&&(q|=1),ot(kr,q&1),y===null)return Fd(b),y=b.memoizedState,y!==null&&(y=y.dehydrated,y!==null)?((b.mode&1)===0?b.lanes=1:ur(y)?b.lanes=8:b.lanes=1073741824,null):(he=z.children,y=z.fallback,ee?(z=b.mode,ee=b.child,he={mode:"hidden",children:he},(z&1)===0&&ee!==null?(ee.childLanes=0,ee.pendingProps=he):ee=jc(he,z,0,null),y=Ei(y,z,M,null),ee.return=b,y.return=b,ee.sibling=y,b.child=ee,b.child.memoizedState=vc(M),b.memoizedState=zi,y):lf(b,he));if(q=y.memoizedState,q!==null&&(Te=q.dehydrated,Te!==null))return Sv(y,b,he,z,Te,q,M);if(ee){ee=z.fallback,he=b.mode,q=y.child,Te=q.sibling;var Be={mode:"hidden",children:z.children};return(he&1)===0&&b.child!==q?(z=b.child,z.childLanes=0,z.pendingProps=Be,b.deletions=null):(z=Vl(q,Be),z.subtreeFlags=q.subtreeFlags&14680064),Te!==null?ee=Vl(Te,ee):(ee=Ei(ee,he,M,null),ee.flags|=2),ee.return=b,z.return=b,z.sibling=ee,b.child=z,z=ee,ee=b.child,he=y.child.memoizedState,he=he===null?vc(M):{baseLanes:he.baseLanes|M,cachePool:null,transitions:he.transitions},ee.memoizedState=he,ee.childLanes=y.childLanes&~M,b.memoizedState=zi,z}return ee=y.child,y=ee.sibling,z=Vl(ee,{mode:"visible",children:z.children}),(b.mode&1)===0&&(z.lanes=M),z.return=b,z.sibling=null,y!==null&&(M=b.deletions,M===null?(b.deletions=[y],b.flags|=16):M.push(y)),b.child=z,b.memoizedState=null,z}function lf(y,b){return b=jc({mode:"visible",children:b},y.mode,0,null),b.return=y,y.child=b}function wu(y,b,M,z){return z!==null&&nc(z),zo(b,y.child,null,M),y=lf(b,b.pendingProps.children),y.flags|=2,b.memoizedState=null,y}function Sv(y,b,M,z,q,ee,he){if(M)return b.flags&256?(b.flags&=-257,z=Gs(Error(s(422))),wu(y,b,he,z)):b.memoizedState!==null?(b.child=y.child,b.flags|=128,null):(ee=z.fallback,q=b.mode,z=jc({mode:"visible",children:z.children},q,0,null),ee=Ei(ee,q,he,null),ee.flags|=2,z.return=b,ee.return=b,z.sibling=ee,b.child=z,(b.mode&1)!==0&&zo(b,y.child,null,he),b.child.memoizedState=vc(he),b.memoizedState=zi,ee);if((b.mode&1)===0)return wu(y,b,he,null);if(ur(q))return z=yt(q).digest,ee=Error(s(419)),z=Gs(ee,z,void 0),wu(y,b,he,z);if(M=(he&y.childLanes)!==0,Nn||M){if(z=Ur,z!==null){switch(he&-he){case 4:q=2;break;case 16:q=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:q=32;break;case 536870912:q=268435456;break;default:q=0}q=(q&(z.suspendedLanes|he))!==0?0:q,q!==0&&q!==ee.retryLane&&(ee.retryLane=q,Aa(y,q),Vi(z,y,q,-1))}return Mc(),z=Gs(Error(s(421))),wu(y,b,he,z)}return nn(q)?(b.flags|=128,b.child=y.child,b=Av.bind(null,y),Lr(q,b),null):(y=ee.treeContext,_e&&(on=Js(q),Fn=b,Or=!0,sa=null,bl=!1,y!==null&&(Jn[ia++]=ji,Jn[ia++]=Za,Jn[ia++]=Sn,ji=y.id,Za=y.overflow,Sn=b)),b=lf(b,z.children),b.flags|=4096,b)}function fo(y,b,M){y.lanes|=b;var z=y.alternate;z!==null&&(z.lanes|=b),Fo(y.return,b,M)}function yc(y,b,M,z,q){var ee=y.memoizedState;ee===null?y.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:z,tail:M,tailMode:q}:(ee.isBackwards=b,ee.rendering=null,ee.renderingStartTime=0,ee.last=z,ee.tail=M,ee.tailMode=q)}function uf(y,b,M){var z=b.pendingProps,q=z.revealOrder,ee=z.tail;if(Vn(y,b,z.children,M),z=kr.current,(z&2)!==0)z=z&1|2,b.flags|=128;else{if(y!==null&&(y.flags&128)!==0)e:for(y=b.child;y!==null;){if(y.tag===13)y.memoizedState!==null&&fo(y,M,b);else if(y.tag===19)fo(y,M,b);else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===b)break e;for(;y.sibling===null;){if(y.return===null||y.return===b)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}z&=1}if(ot(kr,z),(b.mode&1)===0)b.memoizedState=null;else switch(q){case"forwards":for(M=b.child,q=null;M!==null;)y=M.alternate,y!==null&&Ho(y)===null&&(q=M),M=M.sibling;M=q,M===null?(q=b.child,b.child=null):(q=M.sibling,M.sibling=null),yc(b,!1,q,M,ee);break;case"backwards":for(M=null,q=b.child,b.child=null;q!==null;){if(y=q.alternate,y!==null&&Ho(y)===null){b.child=q;break}y=q.sibling,q.sibling=M,M=q,q=y}yc(b,!0,M,null,ee);break;case"together":yc(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}function Yd(y,b){(b.mode&1)===0&&y!==null&&(y.alternate=null,b.alternate=null,b.flags|=2)}function Qo(y,b,M){if(y!==null&&(b.dependencies=y.dependencies),el|=b.lanes,(M&b.childLanes)===0)return null;if(y!==null&&b.child!==y.child)throw Error(s(153));if(b.child!==null){for(y=b.child,M=Vl(y,y.pendingProps),b.child=M,M.return=b;y.sibling!==null;)y=y.sibling,M=M.sibling=Vl(y,y.pendingProps),M.return=b;M.sibling=null}return b.child}function Rl(y,b,M){switch(b.tag){case 3:jl(b),io();break;case 5:mu(b);break;case 1:Tt(b.type)&&Xn(b);break;case 4:Cl(b,b.stateNode.containerInfo);break;case 10:Ma(b,b.type._context,b.memoizedProps.value);break;case 13:var z=b.memoizedState;if(z!==null)return z.dehydrated!==null?(ot(kr,kr.current&1),b.flags|=128,null):(M&b.child.childLanes)!==0?Lp(y,b,M):(ot(kr,kr.current&1),y=Qo(y,b,M),y!==null?y.sibling:null);ot(kr,kr.current&1);break;case 19:if(z=(M&b.childLanes)!==0,(y.flags&128)!==0){if(z)return uf(y,b,M);b.flags|=128}var q=b.memoizedState;if(q!==null&&(q.rendering=null,q.tail=null,q.lastEffect=null),ot(kr,kr.current),z)break;return null;case 22:case 23:return b.lanes=0,$r(y,b,M)}return Qo(y,b,M)}function da(y){y.flags|=4}function _u(y,b){if(y!==null&&y.child===b.child)return!0;if((b.flags&16)!==0)return!1;for(y=b.child;y!==null;){if((y.flags&12854)!==0||(y.subtreeFlags&12854)!==0)return!1;y=y.sibling}return!0}var Ll,Ol,ha,fa;if(ge)Ll=function(y,b){for(var M=b.child;M!==null;){if(M.tag===5||M.tag===6)te(y,M.stateNode);else if(M.tag!==4&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===b)break;for(;M.sibling===null;){if(M.return===null||M.return===b)return;M=M.return}M.sibling.return=M.return,M=M.sibling}},Ol=function(){},ha=function(y,b,M,z,q){if(y=y.memoizedProps,y!==z){var ee=b.stateNode,he=ca(Ra.current);M=de(ee,M,y,z,q,he),(b.updateQueue=M)&&da(b)}},fa=function(y,b,M,z){M!==z&&da(b)};else if(be){Ll=function(y,b,M,z){for(var q=b.child;q!==null;){if(q.tag===5){var ee=q.stateNode;M&&z&&(ee=Sr(ee,q.type,q.memoizedProps,q)),te(y,ee)}else if(q.tag===6)ee=q.stateNode,M&&z&&(ee=fr(ee,q.memoizedProps,q)),te(y,ee);else if(q.tag!==4){if(q.tag===22&&q.memoizedState!==null)ee=q.child,ee!==null&&(ee.return=q),Ll(y,q,!0,!0);else if(q.child!==null){q.child.return=q,q=q.child;continue}}if(q===b)break;for(;q.sibling===null;){if(q.return===null||q.return===b)return;q=q.return}q.sibling.return=q.return,q=q.sibling}};var Dl=function(y,b,M,z){for(var q=b.child;q!==null;){if(q.tag===5){var ee=q.stateNode;M&&z&&(ee=Sr(ee,q.type,q.memoizedProps,q)),vt(y,ee)}else if(q.tag===6)ee=q.stateNode,M&&z&&(ee=fr(ee,q.memoizedProps,q)),vt(y,ee);else if(q.tag!==4){if(q.tag===22&&q.memoizedState!==null)ee=q.child,ee!==null&&(ee.return=q),Dl(y,q,!0,!0);else if(q.child!==null){q.child.return=q,q=q.child;continue}}if(q===b)break;for(;q.sibling===null;){if(q.return===null||q.return===b)return;q=q.return}q.sibling.return=q.return,q=q.sibling}};Ol=function(y,b){var M=b.stateNode;if(!_u(y,b)){y=M.containerInfo;var z=zt(y);Dl(z,b,!1,!1),M.pendingChildren=z,da(b),Ht(y,z)}},ha=function(y,b,M,z,q){var ee=y.stateNode,he=y.memoizedProps;if((y=_u(y,b))&&he===z)b.stateNode=ee;else{var Te=b.stateNode,Be=ca(Ra.current),nt=null;he!==z&&(nt=de(Te,M,he,z,q,Be)),y&&nt===null?b.stateNode=ee:(ee=Bt(ee,nt,M,he,z,b,y,Te),ne(ee,M,z,q,Be)&&da(b),b.stateNode=ee,y?da(b):Ll(ee,b,!1,!1))}},fa=function(y,b,M,z){M!==z?(y=ca(Xa.current),M=ca(Ra.current),b.stateNode=ye(z,y,M,b),da(b)):b.stateNode=y.stateNode}}else Ol=function(){},ha=function(){},fa=function(){};function Ja(y,b){if(!Or)switch(y.tailMode){case"hidden":b=y.tail;for(var M=null;b!==null;)b.alternate!==null&&(M=b),b=b.sibling;M===null?y.tail=null:M.sibling=null;break;case"collapsed":M=y.tail;for(var z=null;M!==null;)M.alternate!==null&&(z=M),M=M.sibling;z===null?b||y.tail===null?y.tail=null:y.tail.sibling=null:z.sibling=null}}function ln(y){var b=y.alternate!==null&&y.alternate.child===y.child,M=0,z=0;if(b)for(var q=y.child;q!==null;)M|=q.lanes|q.childLanes,z|=q.subtreeFlags&14680064,z|=q.flags&14680064,q.return=y,q=q.sibling;else for(q=y.child;q!==null;)M|=q.lanes|q.childLanes,z|=q.subtreeFlags,z|=q.flags,q.return=y,q=q.sibling;return y.subtreeFlags|=z,y.childLanes=M,b}function Su(y,b,M){var z=b.pendingProps;switch(fu(b),b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(b),null;case 1:return Tt(b.type)&&yr(),ln(b),null;case 3:return M=b.stateNode,ys(),vr(zr),vr(sn),uc(),M.pendingContext&&(M.context=M.pendingContext,M.pendingContext=null),(y===null||y.child===null)&&(wl(b)?da(b):y===null||y.memoizedState.isDehydrated&&(b.flags&256)===0||(b.flags|=1024,sa!==null&&(wf(sa),sa=null))),Ol(y,b),ln(b),null;case 5:El(b),M=ca(Xa.current);var q=b.type;if(y!==null&&b.stateNode!=null)ha(y,b,q,z,M),y.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!z){if(b.stateNode===null)throw Error(s(166));return ln(b),null}if(y=ca(Ra.current),wl(b)){if(!_e)throw Error(s(175));y=ui(b.stateNode,b.type,b.memoizedProps,M,y,b,!bl),b.updateQueue=y,y!==null&&da(b)}else{var ee=G(q,z,M,y,b);Ll(ee,b,!1,!1),b.stateNode=ee,ne(ee,q,z,M,y)&&da(b)}b.ref!==null&&(b.flags|=512,b.flags|=2097152)}return ln(b),null;case 6:if(y&&b.stateNode!=null)fa(y,b,y.memoizedProps,z);else{if(typeof z!="string"&&b.stateNode===null)throw Error(s(166));if(y=ca(Xa.current),M=ca(Ra.current),wl(b)){if(!_e)throw Error(s(176));if(y=b.stateNode,M=b.memoizedProps,(z=an(y,M,b,!bl))&&(q=Fn,q!==null))switch(q.tag){case 3:fl(q.stateNode.containerInfo,y,M,(q.mode&1)!==0);break;case 5:Xr(q.type,q.memoizedProps,q.stateNode,y,M,(q.mode&1)!==0)}z&&da(b)}else b.stateNode=ye(z,y,M,b)}return ln(b),null;case 13:if(vr(kr),z=b.memoizedState,y===null||y.memoizedState!==null&&y.memoizedState.dehydrated!==null){if(Or&&on!==null&&(b.mode&1)!==0&&(b.flags&128)===0)rf(),io(),b.flags|=98560,q=!1;else if(q=wl(b),z!==null&&z.dehydrated!==null){if(y===null){if(!q)throw Error(s(318));if(!_e)throw Error(s(344));if(q=b.memoizedState,q=q!==null?q.dehydrated:null,!q)throw Error(s(317));xn(q,b)}else io(),(b.flags&128)===0&&(b.memoizedState=null),b.flags|=4;ln(b),q=!1}else sa!==null&&(wf(sa),sa=null),q=!0;if(!q)return b.flags&65536?b:null}return(b.flags&128)!==0?(b.lanes=M,b):(M=z!==null,M!==(y!==null&&y.memoizedState!==null)&&M&&(b.child.flags|=8192,(b.mode&1)!==0&&(y===null||(kr.current&1)!==0?cn===0&&(cn=3):Mc())),b.updateQueue!==null&&(b.flags|=4),ln(b),null);case 4:return ys(),Ol(y,b),y===null&&qe(b.stateNode.containerInfo),ln(b),null;case 10:return vs(b.type._context),ln(b),null;case 17:return Tt(b.type)&&yr(),ln(b),null;case 19:if(vr(kr),q=b.memoizedState,q===null)return ln(b),null;if(z=(b.flags&128)!==0,ee=q.rendering,ee===null)if(z)Ja(q,!1);else{if(cn!==0||y!==null&&(y.flags&128)!==0)for(y=b.child;y!==null;){if(ee=Ho(y),ee!==null){for(b.flags|=128,Ja(q,!1),y=ee.updateQueue,y!==null&&(b.updateQueue=y,b.flags|=4),b.subtreeFlags=0,y=M,M=b.child;M!==null;)z=M,q=y,z.flags&=14680066,ee=z.alternate,ee===null?(z.childLanes=0,z.lanes=q,z.child=null,z.subtreeFlags=0,z.memoizedProps=null,z.memoizedState=null,z.updateQueue=null,z.dependencies=null,z.stateNode=null):(z.childLanes=ee.childLanes,z.lanes=ee.lanes,z.child=ee.child,z.subtreeFlags=0,z.deletions=null,z.memoizedProps=ee.memoizedProps,z.memoizedState=ee.memoizedState,z.updateQueue=ee.updateQueue,z.type=ee.type,q=ee.dependencies,z.dependencies=q===null?null:{lanes:q.lanes,firstContext:q.firstContext}),M=M.sibling;return ot(kr,kr.current&1|2),b.child}y=y.sibling}q.tail!==null&&wn()>nh&&(b.flags|=128,z=!0,Ja(q,!1),b.lanes=4194304)}else{if(!z)if(y=Ho(ee),y!==null){if(b.flags|=128,z=!0,y=y.updateQueue,y!==null&&(b.updateQueue=y,b.flags|=4),Ja(q,!0),q.tail===null&&q.tailMode==="hidden"&&!ee.alternate&&!Or)return ln(b),null}else 2*wn()-q.renderingStartTime>nh&&M!==1073741824&&(b.flags|=128,z=!0,Ja(q,!1),b.lanes=4194304);q.isBackwards?(ee.sibling=b.child,b.child=ee):(y=q.last,y!==null?y.sibling=ee:b.child=ee,q.last=ee)}return q.tail!==null?(b=q.tail,q.rendering=b,q.tail=b.sibling,q.renderingStartTime=wn(),b.sibling=null,y=kr.current,ot(kr,z?y&1|2:y&1),b):(ln(b),null);case 22:case 23:return _f(),M=b.memoizedState!==null,y!==null&&y.memoizedState!==null!==M&&(b.flags|=8192),M&&(b.mode&1)!==0?(ri&1073741824)!==0&&(ln(b),ge&&b.subtreeFlags&6&&(b.flags|=8192)):ln(b),null;case 24:return null;case 25:return null}throw Error(s(156,b.tag))}function kv(y,b){switch(fu(b),b.tag){case 1:return Tt(b.type)&&yr(),y=b.flags,y&65536?(b.flags=y&-65537|128,b):null;case 3:return ys(),vr(zr),vr(sn),uc(),y=b.flags,(y&65536)!==0&&(y&128)===0?(b.flags=y&-65537|128,b):null;case 5:return El(b),null;case 13:if(vr(kr),y=b.memoizedState,y!==null&&y.dehydrated!==null){if(b.alternate===null)throw Error(s(340));io()}return y=b.flags,y&65536?(b.flags=y&-65537|128,b):null;case 19:return vr(kr),null;case 4:return ys(),null;case 10:return vs(b.type._context),null;case 22:case 23:return _f(),null;case 24:return null;default:return null}}var xc=!1,mi=!1,es=typeof WeakSet=="function"?WeakSet:Set,ct=null;function Ar(y,b){var M=y.ref;if(M!==null)if(typeof M=="function")try{M(null)}catch(z){Jr(y,b,z)}else M.current=null}function ts(y,b,M){try{M()}catch(z){Jr(y,b,z)}}var Op=!1;function Cv(y,b){for(ae(y.containerInfo),ct=b;ct!==null;)if(y=ct,b=y.child,(y.subtreeFlags&1028)!==0&&b!==null)b.return=y,ct=b;else for(;ct!==null;){y=ct;try{var M=y.alternate;if((y.flags&1024)!==0)switch(y.tag){case 0:case 11:case 15:break;case 1:if(M!==null){var z=M.memoizedProps,q=M.memoizedState,ee=y.stateNode,he=ee.getSnapshotBeforeUpdate(y.elementType===y.type?z:Mr(y.type,z),q);ee.__reactInternalSnapshotBeforeUpdate=he}break;case 3:ge&&_t(y.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(Te){Jr(y,y.return,Te)}if(b=y.sibling,b!==null){b.return=y.return,ct=b;break}ct=y.return}return M=Op,Op=!1,M}function ku(y,b,M){var z=b.updateQueue;if(z=z!==null?z.lastEffect:null,z!==null){var q=z=z.next;do{if((q.tag&y)===y){var ee=q.destroy;q.destroy=void 0,ee!==void 0&&ts(b,M,ee)}q=q.next}while(q!==z)}}function bc(y,b){if(b=b.updateQueue,b=b!==null?b.lastEffect:null,b!==null){var M=b=b.next;do{if((M.tag&y)===y){var z=M.create;M.destroy=z()}M=M.next}while(M!==b)}}function cf(y){var b=y.ref;if(b!==null){var M=y.stateNode;y.tag===5?y=K(M):y=M,typeof b=="function"?b(y):b.current=y}}function Xd(y){var b=y.alternate;b!==null&&(y.alternate=null,Xd(b)),y.child=null,y.deletions=null,y.sibling=null,y.tag===5&&(b=y.stateNode,b!==null&&Ve(b)),y.stateNode=null,y.return=null,y.dependencies=null,y.memoizedProps=null,y.memoizedState=null,y.pendingProps=null,y.stateNode=null,y.updateQueue=null}function Dp(y){return y.tag===5||y.tag===3||y.tag===4}function Cu(y){e:for(;;){for(;y.sibling===null;){if(y.return===null||Dp(y.return))return null;y=y.return}for(y.sibling.return=y.return,y=y.sibling;y.tag!==5&&y.tag!==6&&y.tag!==18;){if(y.flags&2||y.child===null||y.tag===4)continue e;y.child.return=y,y=y.child}if(!(y.flags&2))return y.stateNode}}function Qd(y,b,M){var z=y.tag;if(z===5||z===6)y=y.stateNode,b?ve(M,y,b):Wt(M,y);else if(z!==4&&(y=y.child,y!==null))for(Qd(y,b,M),y=y.sibling;y!==null;)Qd(y,b,M),y=y.sibling}function Ip(y,b,M){var z=y.tag;if(z===5||z===6)y=y.stateNode,b?ue(M,y,b):jt(M,y);else if(z!==4&&(y=y.child,y!==null))for(Ip(y,b,M),y=y.sibling;y!==null;)Ip(y,b,M),y=y.sibling}var Dn=null,Ia=!1;function qs(y,b,M){for(M=M.child;M!==null;)df(y,b,M),M=M.sibling}function df(y,b,M){if(_n&&typeof _n.onCommitFiberUnmount=="function")try{_n.onCommitFiberUnmount(Wr,M)}catch{}switch(M.tag){case 5:mi||Ar(M,b);case 6:if(ge){var z=Dn,q=Ia;Dn=null,qs(y,b,M),Dn=z,Ia=q,Dn!==null&&(Ia?Ne(Dn,M.stateNode):ke(Dn,M.stateNode))}else qs(y,b,M);break;case 18:ge&&Dn!==null&&(Ia?ou(Dn,M.stateNode):su(Dn,M.stateNode));break;case 4:ge?(z=Dn,q=Ia,Dn=M.stateNode.containerInfo,Ia=!0,qs(y,b,M),Dn=z,Ia=q):(be&&(z=M.stateNode.containerInfo,q=zt(z),qt(z,q)),qs(y,b,M));break;case 0:case 11:case 14:case 15:if(!mi&&(z=M.updateQueue,z!==null&&(z=z.lastEffect,z!==null))){q=z=z.next;do{var ee=q,he=ee.destroy;ee=ee.tag,he!==void 0&&((ee&2)!==0||(ee&4)!==0)&&ts(M,b,he),q=q.next}while(q!==z)}qs(y,b,M);break;case 1:if(!mi&&(Ar(M,b),z=M.stateNode,typeof z.componentWillUnmount=="function"))try{z.props=M.memoizedProps,z.state=M.memoizedState,z.componentWillUnmount()}catch(Te){Jr(M,b,Te)}qs(y,b,M);break;case 21:qs(y,b,M);break;case 22:M.mode&1?(mi=(z=mi)||M.memoizedState!==null,qs(y,b,M),mi=z):qs(y,b,M);break;default:qs(y,b,M)}}function Eu(y){var b=y.updateQueue;if(b!==null){y.updateQueue=null;var M=y.stateNode;M===null&&(M=y.stateNode=new es),b.forEach(function(z){var q=Yx.bind(null,y,z);M.has(z)||(M.add(z),z.then(q,q))})}}function ws(y,b){var M=b.deletions;if(M!==null)for(var z=0;z<M.length;z++){var q=M[z];try{var ee=y,he=b;if(ge){var Te=he;e:for(;Te!==null;){switch(Te.tag){case 5:Dn=Te.stateNode,Ia=!1;break e;case 3:Dn=Te.stateNode.containerInfo,Ia=!0;break e;case 4:Dn=Te.stateNode.containerInfo,Ia=!0;break e}Te=Te.return}if(Dn===null)throw Error(s(160));df(ee,he,q),Dn=null,Ia=!1}else df(ee,he,q);var Be=q.alternate;Be!==null&&(Be.return=null),q.return=null}catch(nt){Jr(q,b,nt)}}if(b.subtreeFlags&12854)for(b=b.child;b!==null;)Jd(b,y),b=b.sibling}function Jd(y,b){var M=y.alternate,z=y.flags;switch(y.tag){case 0:case 11:case 14:case 15:if(ws(b,y),rs(y),z&4){try{ku(3,y,y.return),bc(3,y)}catch(mt){Jr(y,y.return,mt)}try{ku(5,y,y.return)}catch(mt){Jr(y,y.return,mt)}}break;case 1:ws(b,y),rs(y),z&512&&M!==null&&Ar(M,M.return);break;case 5:if(ws(b,y),rs(y),z&512&&M!==null&&Ar(M,M.return),ge){if(y.flags&32){var q=y.stateNode;try{je(q)}catch(mt){Jr(y,y.return,mt)}}if(z&4&&(q=y.stateNode,q!=null)){var ee=y.memoizedProps;if(M=M!==null?M.memoizedProps:ee,z=y.type,b=y.updateQueue,y.updateQueue=null,b!==null)try{Ge(q,b,z,M,ee,y)}catch(mt){Jr(y,y.return,mt)}}}break;case 6:if(ws(b,y),rs(y),z&4&&ge){if(y.stateNode===null)throw Error(s(162));q=y.stateNode,ee=y.memoizedProps,M=M!==null?M.memoizedProps:ee;try{xt(q,M,ee)}catch(mt){Jr(y,y.return,mt)}}break;case 3:if(ws(b,y),rs(y),z&4){if(ge&&_e&&M!==null&&M.memoizedState.isDehydrated)try{eo(b.containerInfo)}catch(mt){Jr(y,y.return,mt)}if(be){q=b.containerInfo,ee=b.pendingChildren;try{qt(q,ee)}catch(mt){Jr(y,y.return,mt)}}}break;case 4:if(ws(b,y),rs(y),z&4&&be){ee=y.stateNode,q=ee.containerInfo,ee=ee.pendingChildren;try{qt(q,ee)}catch(mt){Jr(y,y.return,mt)}}break;case 13:ws(b,y),rs(y),q=y.child,q.flags&8192&&(ee=q.memoizedState!==null,q.stateNode.isHidden=ee,!ee||q.alternate!==null&&q.alternate.memoizedState!==null||(Ec=wn())),z&4&&Eu(y);break;case 22:var he=M!==null&&M.memoizedState!==null;if(y.mode&1?(mi=(M=mi)||he,ws(b,y),mi=M):ws(b,y),rs(y),z&8192){if(M=y.memoizedState!==null,(y.stateNode.isHidden=M)&&!he&&(y.mode&1)!==0)for(ct=y,z=y.child;z!==null;){for(b=ct=z;ct!==null;){he=ct;var Te=he.child;switch(he.tag){case 0:case 11:case 14:case 15:ku(4,he,he.return);break;case 1:Ar(he,he.return);var Be=he.stateNode;if(typeof Be.componentWillUnmount=="function"){var nt=he,St=he.return;try{var Kt=nt;Be.props=Kt.memoizedProps,Be.state=Kt.memoizedState,Be.componentWillUnmount()}catch(mt){Jr(nt,St,mt)}}break;case 5:Ar(he,he.return);break;case 22:if(he.memoizedState!==null){pf(b);continue}}Te!==null?(Te.return=he,ct=Te):pf(b)}z=z.sibling}if(ge){e:if(z=null,ge)for(b=y;;){if(b.tag===5){if(z===null){z=b;try{q=b.stateNode,M?Ze(q):ut(b.stateNode,b.memoizedProps)}catch(mt){Jr(y,y.return,mt)}}}else if(b.tag===6){if(z===null)try{ee=b.stateNode,M?He(ee):lt(ee,b.memoizedProps)}catch(mt){Jr(y,y.return,mt)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===y)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===y)break e;for(;b.sibling===null;){if(b.return===null||b.return===y)break e;z===b&&(z=null),b=b.return}z===b&&(z=null),b.sibling.return=b.return,b=b.sibling}}}break;case 19:ws(b,y),rs(y),z&4&&Eu(y);break;case 21:break;default:ws(b,y),rs(y)}}function rs(y){var b=y.flags;if(b&2){try{if(ge){e:{for(var M=y.return;M!==null;){if(Dp(M)){var z=M;break e}M=M.return}throw Error(s(160))}switch(z.tag){case 5:var q=z.stateNode;z.flags&32&&(je(q),z.flags&=-33);var ee=Cu(y);Ip(y,ee,q);break;case 3:case 4:var he=z.stateNode.containerInfo,Te=Cu(y);Qd(y,Te,he);break;default:throw Error(s(161))}}}catch(Be){Jr(y,y.return,Be)}y.flags&=-3}b&4096&&(y.flags&=-4097)}function wc(y,b,M){ct=y,hf(y)}function hf(y,b,M){for(var z=(y.mode&1)!==0;ct!==null;){var q=ct,ee=q.child;if(q.tag===22&&z){var he=q.memoizedState!==null||xc;if(!he){var Te=q.alternate,Be=Te!==null&&Te.memoizedState!==null||mi;Te=xc;var nt=mi;if(xc=he,(mi=Be)&&!nt)for(ct=q;ct!==null;)he=ct,Be=he.child,he.tag===22&&he.memoizedState!==null?mf(q):Be!==null?(Be.return=he,ct=Be):mf(q);for(;ee!==null;)ct=ee,hf(ee),ee=ee.sibling;ct=q,xc=Te,mi=nt}ff(y)}else(q.subtreeFlags&8772)!==0&&ee!==null?(ee.return=q,ct=ee):ff(y)}}function ff(y){for(;ct!==null;){var b=ct;if((b.flags&8772)!==0){var M=b.alternate;try{if((b.flags&8772)!==0)switch(b.tag){case 0:case 11:case 15:mi||bc(5,b);break;case 1:var z=b.stateNode;if(b.flags&4&&!mi)if(M===null)z.componentDidMount();else{var q=b.elementType===b.type?M.memoizedProps:Mr(b.type,M.memoizedProps);z.componentDidUpdate(q,M.memoizedState,z.__reactInternalSnapshotBeforeUpdate)}var ee=b.updateQueue;ee!==null&&nf(b,ee,z);break;case 3:var he=b.updateQueue;if(he!==null){if(M=null,b.child!==null)switch(b.child.tag){case 5:M=K(b.child.stateNode);break;case 1:M=b.child.stateNode}nf(b,he,M)}break;case 5:var Te=b.stateNode;M===null&&b.flags&4&&st(Te,b.type,b.memoizedProps,b);break;case 6:break;case 4:break;case 12:break;case 13:if(_e&&b.memoizedState===null){var Be=b.alternate;if(Be!==null){var nt=Be.memoizedState;if(nt!==null){var St=nt.dehydrated;St!==null&&wi(St)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}mi||b.flags&512&&cf(b)}catch(Kt){Jr(b,b.return,Kt)}}if(b===y){ct=null;break}if(M=b.sibling,M!==null){M.return=b.return,ct=M;break}ct=b.return}}function pf(y){for(;ct!==null;){var b=ct;if(b===y){ct=null;break}var M=b.sibling;if(M!==null){M.return=b.return,ct=M;break}ct=b.return}}function mf(y){for(;ct!==null;){var b=ct;try{switch(b.tag){case 0:case 11:case 15:var M=b.return;try{bc(4,b)}catch(Be){Jr(b,M,Be)}break;case 1:var z=b.stateNode;if(typeof z.componentDidMount=="function"){var q=b.return;try{z.componentDidMount()}catch(Be){Jr(b,q,Be)}}var ee=b.return;try{cf(b)}catch(Be){Jr(b,ee,Be)}break;case 5:var he=b.return;try{cf(b)}catch(Be){Jr(b,he,Be)}}}catch(Be){Jr(b,b.return,Be)}if(b===y){ct=null;break}var Te=b.sibling;if(Te!==null){Te.return=b.return,ct=Te;break}ct=b.return}}var Jo=0,pa=1,po=2,_c=3,eh=4;if(typeof Symbol=="function"&&Symbol.for){var ns=Symbol.for;Jo=ns("selector.component"),pa=ns("selector.has_pseudo_class"),po=ns("selector.role"),_c=ns("selector.test_id"),eh=ns("selector.text")}function mo(y){var b=De(y);if(b!=null){if(typeof b.memoizedProps["data-testname"]!="string")throw Error(s(364));return b}if(y=Ce(y),y===null)throw Error(s(362));return y.stateNode.current}function th(y,b){switch(b.$$typeof){case Jo:if(y.type===b.value)return!0;break;case pa:e:{b=b.value,y=[y,0];for(var M=0;M<y.length;){var z=y[M++],q=y[M++],ee=b[q];if(z.tag!==5||!et(z)){for(;ee!=null&&th(z,ee);)q++,ee=b[q];if(q===b.length){b=!0;break e}else for(z=z.child;z!==null;)y.push(z,q),z=z.sibling}}b=!1}return b;case po:if(y.tag===5&&ht(y.stateNode,b.value))return!0;break;case eh:if((y.tag===5||y.tag===6)&&(y=Ke(y),y!==null&&0<=y.indexOf(b.value)))return!0;break;case _c:if(y.tag===5&&(y=y.memoizedProps["data-testname"],typeof y=="string"&&y.toLowerCase()===b.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function gf(y){switch(y.$$typeof){case Jo:return"<"+(D(y.value)||"Unknown")+">";case pa:return":has("+(gf(y)||"")+")";case po:return'[role="'+y.value+'"]';case eh:return'"'+y.value+'"';case _c:return'[data-testname="'+y.value+'"]';default:throw Error(s(365))}}function go(y,b){var M=[];y=[y,0];for(var z=0;z<y.length;){var q=y[z++],ee=y[z++],he=b[ee];if(q.tag!==5||!et(q)){for(;he!=null&&th(q,he);)ee++,he=b[ee];if(ee===b.length)M.push(q);else for(q=q.child;q!==null;)y.push(q,ee),q=q.sibling}}return M}function vo(y,b){if(!We)throw Error(s(363));y=mo(y),y=go(y,b),b=[],y=Array.from(y);for(var M=0;M<y.length;){var z=y[M++];if(z.tag===5)et(z)||b.push(z.stateNode);else for(z=z.child;z!==null;)y.push(z),z=z.sibling}return b}var vf=Math.ceil,rh=o.ReactCurrentDispatcher,Sc=o.ReactCurrentOwner,Tn=o.ReactCurrentBatchConfig,Qt=0,Ur=null,un=null,In=0,ri=0,Il=pn(0),cn=0,kc=null,el=0,Kr=0,Cc=0,Nu=null,Fi=null,Ec=0,nh=1/0,ma=null;function Dr(){nh=wn()+500}var Pn=!1,Un=null,Ws=null,Bl=!1,_s=null,yf=0,Hn=0,ih=null,Nc=-1,Tc=0;function Qr(){return(Qt&6)!==0?wn():Nc!==-1?Nc:Nc=wn()}function ni(y){return(y.mode&1)===0?1:(Qt&2)!==0&&In!==0?In&-In:ic.transition!==null?(Tc===0&&(Tc=ml()),Tc):(y=nr,y!==0?y:Ue())}function Vi(y,b,M,z){if(50<Hn)throw Hn=0,ih=null,Error(s(185));_i(y,M,z),((Qt&2)===0||y!==Ur)&&(y===Ur&&((Qt&2)===0&&(Kr|=M),cn===4&&tl(y,In)),Ui(y,z),M===1&&Qt===0&&(b.mode&1)===0&&(Dr(),no&&Qn()))}function Ui(y,b){var M=y.callbackNode;tc(y,b);var z=fs(y,y===Ur?In:0);if(z===0)M!==null&&Tr(M),y.callbackNode=null,y.callbackPriority=0;else if(b=z&-z,y.callbackPriority!==b){if(M!=null&&Tr(M),b===1)y.tag===0?sr(Bp.bind(null,y)):hu(Bp.bind(null,y)),Je?ft(function(){(Qt&6)===0&&Qn()}):On(gl,Qn),M=null;else{switch(Gt(z)){case 1:M=gl;break;case 4:M=ps;break;case 16:M=vl;break;case 536870912:M=cu;break;default:M=vl}M=qp(M,xf.bind(null,y))}y.callbackPriority=b,y.callbackNode=M}}function xf(y,b){if(Nc=-1,Tc=0,(Qt&6)!==0)throw Error(s(327));var M=y.callbackNode;if(rl()&&y.callbackNode!==M)return null;var z=fs(y,y===Ur?In:0);if(z===0)return null;if((z&30)!==0||(z&y.expiredLanes)!==0||b)b=Tu(y,z);else{b=z;var q=Qt;Qt|=2;var ee=Fp();(Ur!==y||In!==b)&&(ma=null,Dr(),zl(y,b));do try{Vp();break}catch(Te){Pc(y,Te)}while(!0);Hd(),rh.current=ee,Qt=q,un!==null?b=0:(Ur=null,In=0,b=cn)}if(b!==0){if(b===2&&(q=Oo(y),q!==0&&(z=q,b=bf(y,q))),b===1)throw M=kc,zl(y,0),tl(y,z),Ui(y,wn()),M;if(b===6)tl(y,z);else{if(q=y.current.alternate,(z&30)===0&&!Ev(q)&&(b=Tu(y,z),b===2&&(ee=Oo(y),ee!==0&&(z=ee,b=bf(y,ee))),b===1))throw M=kc,zl(y,0),tl(y,z),Ui(y,wn()),M;switch(y.finishedWork=q,y.finishedLanes=z,b){case 0:case 1:throw Error(s(345));case 2:Fl(y,Fi,ma);break;case 3:if(tl(y,z),(z&130023424)===z&&(b=Ec+500-wn(),10<b)){if(fs(y,0)!==0)break;if(q=y.suspendedLanes,(q&z)!==z){Qr(),y.pingedLanes|=y.suspendedLanes&q;break}y.timeoutHandle=ie(Fl.bind(null,y,Fi,ma),b);break}Fl(y,Fi,ma);break;case 4:if(tl(y,z),(z&4194240)===z)break;for(b=y.eventTimes,q=-1;0<z;){var he=31-di(z);ee=1<<he,he=b[he],he>q&&(q=he),z&=~ee}if(z=q,z=wn()-z,z=(120>z?120:480>z?480:1080>z?1080:1920>z?1920:3e3>z?3e3:4320>z?4320:1960*vf(z/1960))-z,10<z){y.timeoutHandle=ie(Fl.bind(null,y,Fi,ma),z);break}Fl(y,Fi,ma);break;case 5:Fl(y,Fi,ma);break;default:throw Error(s(329))}}}return Ui(y,wn()),y.callbackNode===M?xf.bind(null,y):null}function bf(y,b){var M=Nu;return y.current.memoizedState.isDehydrated&&(zl(y,b).flags|=256),y=Tu(y,b),y!==2&&(b=Fi,Fi=M,b!==null&&wf(b)),y}function wf(y){Fi===null?Fi=y:Fi.push.apply(Fi,y)}function Ev(y){for(var b=y;;){if(b.flags&16384){var M=b.updateQueue;if(M!==null&&(M=M.stores,M!==null))for(var z=0;z<M.length;z++){var q=M[z],ee=q.getSnapshot;q=q.value;try{if(!Ka(ee(),q))return!1}catch{return!1}}}if(M=b.child,b.subtreeFlags&16384&&M!==null)M.return=b,b=M;else{if(b===y)break;for(;b.sibling===null;){if(b.return===null||b.return===y)return!0;b=b.return}b.sibling.return=b.return,b=b.sibling}}return!0}function tl(y,b){for(b&=~Cc,b&=~Kr,y.suspendedLanes|=b,y.pingedLanes&=~b,y=y.expirationTimes;0<b;){var M=31-di(b),z=1<<M;y[M]=-1,b&=~z}}function Bp(y){if((Qt&6)!==0)throw Error(s(327));rl();var b=fs(y,0);if((b&1)===0)return Ui(y,wn()),null;var M=Tu(y,b);if(y.tag!==0&&M===2){var z=Oo(y);z!==0&&(b=z,M=bf(y,z))}if(M===1)throw M=kc,zl(y,0),tl(y,b),Ui(y,wn()),M;if(M===6)throw Error(s(345));return y.finishedWork=y.current.alternate,y.finishedLanes=b,Fl(y,Fi,ma),Ui(y,wn()),null}function zp(y){_s!==null&&_s.tag===0&&(Qt&6)===0&&rl();var b=Qt;Qt|=1;var M=Tn.transition,z=nr;try{if(Tn.transition=null,nr=1,y)return y()}finally{nr=z,Tn.transition=M,Qt=b,(Qt&6)===0&&Qn()}}function _f(){ri=Il.current,vr(Il)}function zl(y,b){y.finishedWork=null,y.finishedLanes=0;var M=y.timeoutHandle;if(M!==oe&&(y.timeoutHandle=oe,pe(M)),un!==null)for(M=un.return;M!==null;){var z=M;switch(fu(z),z.tag){case 1:z=z.type.childContextTypes,z!=null&&yr();break;case 3:ys(),vr(zr),vr(sn),uc();break;case 5:El(z);break;case 4:ys();break;case 13:vr(kr);break;case 19:vr(kr);break;case 10:vs(z.type._context);break;case 22:case 23:_f()}M=M.return}if(Ur=y,un=y=Vl(y.current,null),In=ri=b,cn=0,kc=null,Cc=Kr=el=0,Fi=Nu=null,la!==null){for(b=0;b<la.length;b++)if(M=la[b],z=M.interleaved,z!==null){M.interleaved=null;var q=z.next,ee=M.pending;if(ee!==null){var he=ee.next;ee.next=q,z.next=he}M.pending=z}la=null}return y}function Pc(y,b){do{var M=un;try{if(Hd(),Di.current=$e,Nl){for(var z=Fr.memoizedState;z!==null;){var q=z.queue;q!==null&&(q.pending=null),z=z.next}Nl=!1}if(ao=0,Cn=kn=Fr=null,Ii=!1,so=0,Sc.current=null,M===null||M.return===null){cn=1,kc=b,un=null;break}e:{var ee=y,he=M.return,Te=M,Be=b;if(b=In,Te.flags|=32768,Be!==null&&typeof Be=="object"&&typeof Be.then=="function"){var nt=Be,St=Te,Kt=St.tag;if((St.mode&1)===0&&(Kt===0||Kt===11||Kt===15)){var mt=St.alternate;mt?(St.updateQueue=mt.updateQueue,St.memoizedState=mt.memoizedState,St.lanes=mt.lanes):(St.updateQueue=null,St.memoizedState=null)}var Zr=sf(he);if(Zr!==null){Zr.flags&=-257,co(Zr,he,Te,ee,b),Zr.mode&1&&af(ee,nt,b),b=Zr,Be=nt;var jr=b.updateQueue;if(jr===null){var ga=new Set;ga.add(Be),b.updateQueue=ga}else jr.add(Be);break e}else{if((b&1)===0){af(ee,nt,b),Mc();break e}Be=Error(s(426))}}else if(Or&&Te.mode&1){var yo=sf(he);if(yo!==null){(yo.flags&65536)===0&&(yo.flags|=256),co(yo,he,Te,ee,b),nc(Ko(Be,Te));break e}}ee=Be=Ko(Be,Te),cn!==4&&(cn=2),Nu===null?Nu=[ee]:Nu.push(ee),ee=he;do{switch(ee.tag){case 3:ee.flags|=65536,b&=-b,ee.lanes|=b;var Oe=xr(ee,Be,b);kl(ee,Oe);break e;case 1:Te=Be;var Pe=ee.type,Fe=ee.stateNode;if((ee.flags&128)===0&&(typeof Pe.getDerivedStateFromError=="function"||Fe!==null&&typeof Fe.componentDidCatch=="function"&&(Ws===null||!Ws.has(Fe)))){ee.flags|=65536,b&=-b,ee.lanes|=b;var gt=Zo(ee,Te,b);kl(ee,gt);break e}}ee=ee.return}while(ee!==null)}Hp(M)}catch(Rt){b=Rt,un===M&&M!==null&&(un=M=M.return);continue}break}while(!0)}function Fp(){var y=rh.current;return rh.current=$e,y===null?$e:y}function Mc(){(cn===0||cn===3||cn===2)&&(cn=4),Ur===null||(el&268435455)===0&&(Kr&268435455)===0||tl(Ur,In)}function Tu(y,b){var M=Qt;Qt|=2;var z=Fp();(Ur!==y||In!==b)&&(ma=null,zl(y,b));do try{Nv();break}catch(q){Pc(y,q)}while(!0);if(Hd(),Qt=M,rh.current=z,un!==null)throw Error(s(261));return Ur=null,In=0,cn}function Nv(){for(;un!==null;)Up(un)}function Vp(){for(;un!==null&&!zd();)Up(un)}function Up(y){var b=jv(y.alternate,y,ri);y.memoizedProps=y.pendingProps,b===null?Hp(y):un=b,Sc.current=null}function Hp(y){var b=y;do{var M=b.alternate;if(y=b.return,(b.flags&32768)===0){if(M=Su(M,b,ri),M!==null){un=M;return}}else{if(M=kv(M,b),M!==null){M.flags&=32767,un=M;return}if(y!==null)y.flags|=32768,y.subtreeFlags=0,y.deletions=null;else{cn=6,un=null;return}}if(b=b.sibling,b!==null){un=b;return}un=b=y}while(b!==null);cn===0&&(cn=5)}function Fl(y,b,M){var z=nr,q=Tn.transition;try{Tn.transition=null,nr=1,Tv(y,b,M,z)}finally{Tn.transition=q,nr=z}return null}function Tv(y,b,M,z){do rl();while(_s!==null);if((Qt&6)!==0)throw Error(s(327));M=y.finishedWork;var q=y.finishedLanes;if(M===null)return null;if(y.finishedWork=null,y.finishedLanes=0,M===y.current)throw Error(s(177));y.callbackNode=null,y.callbackPriority=0;var ee=M.lanes|M.childLanes;if(Fs(y,ee),y===Ur&&(un=Ur=null,In=0),(M.subtreeFlags&2064)===0&&(M.flags&2064)===0||Bl||(Bl=!0,qp(vl,function(){return rl(),null})),ee=(M.flags&15990)!==0,(M.subtreeFlags&15990)!==0||ee){ee=Tn.transition,Tn.transition=null;var he=nr;nr=1;var Te=Qt;Qt|=4,Sc.current=null,Cv(y,M),Jd(M,y),re(y.containerInfo),y.current=M,wc(M),Do(),Qt=Te,nr=he,Tn.transition=ee}else y.current=M;if(Bl&&(Bl=!1,_s=y,yf=q),ee=y.pendingLanes,ee===0&&(Ws=null),Io(M.stateNode),Ui(y,wn()),b!==null)for(z=y.onRecoverableError,M=0;M<b.length;M++)q=b[M],z(q.value,{componentStack:q.stack,digest:q.digest});if(Pn)throw Pn=!1,y=Un,Un=null,y;return(yf&1)!==0&&y.tag!==0&&rl(),ee=y.pendingLanes,(ee&1)!==0?y===ih?Hn++:(Hn=0,ih=y):Hn=0,Qn(),null}function rl(){if(_s!==null){var y=Gt(yf),b=Tn.transition,M=nr;try{if(Tn.transition=null,nr=16>y?16:y,_s===null)var z=!1;else{if(y=_s,_s=null,yf=0,(Qt&6)!==0)throw Error(s(331));var q=Qt;for(Qt|=4,ct=y.current;ct!==null;){var ee=ct,he=ee.child;if((ct.flags&16)!==0){var Te=ee.deletions;if(Te!==null){for(var Be=0;Be<Te.length;Be++){var nt=Te[Be];for(ct=nt;ct!==null;){var St=ct;switch(St.tag){case 0:case 11:case 15:ku(8,St,ee)}var Kt=St.child;if(Kt!==null)Kt.return=St,ct=Kt;else for(;ct!==null;){St=ct;var mt=St.sibling,Zr=St.return;if(Xd(St),St===nt){ct=null;break}if(mt!==null){mt.return=Zr,ct=mt;break}ct=Zr}}}var jr=ee.alternate;if(jr!==null){var ga=jr.child;if(ga!==null){jr.child=null;do{var yo=ga.sibling;ga.sibling=null,ga=yo}while(ga!==null)}}ct=ee}}if((ee.subtreeFlags&2064)!==0&&he!==null)he.return=ee,ct=he;else e:for(;ct!==null;){if(ee=ct,(ee.flags&2048)!==0)switch(ee.tag){case 0:case 11:case 15:ku(9,ee,ee.return)}var Oe=ee.sibling;if(Oe!==null){Oe.return=ee.return,ct=Oe;break e}ct=ee.return}}var Pe=y.current;for(ct=Pe;ct!==null;){he=ct;var Fe=he.child;if((he.subtreeFlags&2064)!==0&&Fe!==null)Fe.return=he,ct=Fe;else e:for(he=Pe;ct!==null;){if(Te=ct,(Te.flags&2048)!==0)try{switch(Te.tag){case 0:case 11:case 15:bc(9,Te)}}catch(Rt){Jr(Te,Te.return,Rt)}if(Te===he){ct=null;break e}var gt=Te.sibling;if(gt!==null){gt.return=Te.return,ct=gt;break e}ct=Te.return}}if(Qt=q,Qn(),_n&&typeof _n.onPostCommitFiberRoot=="function")try{_n.onPostCommitFiberRoot(Wr,y)}catch{}z=!0}return z}finally{nr=M,Tn.transition=b}}return!1}function Gp(y,b,M){b=Ko(M,b),b=xr(y,b,1),y=Us(y,b,1),b=Qr(),y!==null&&(_i(y,1,b),Ui(y,b))}function Jr(y,b,M){if(y.tag===3)Gp(y,y,M);else for(;b!==null;){if(b.tag===3){Gp(b,y,M);break}else if(b.tag===1){var z=b.stateNode;if(typeof b.type.getDerivedStateFromError=="function"||typeof z.componentDidCatch=="function"&&(Ws===null||!Ws.has(z))){y=Ko(M,y),y=Zo(b,y,1),b=Us(b,y,1),y=Qr(),b!==null&&(_i(b,1,y),Ui(b,y));break}}b=b.return}}function Pv(y,b,M){var z=y.pingCache;z!==null&&z.delete(b),b=Qr(),y.pingedLanes|=y.suspendedLanes&M,Ur===y&&(In&M)===M&&(cn===4||cn===3&&(In&130023424)===In&&500>wn()-Ec?zl(y,0):Cc|=M),Ui(y,b)}function Mv(y,b){b===0&&((y.mode&1)===0?b=1:(b=zs,zs<<=1,(zs&130023424)===0&&(zs=4194304)));var M=Qr();y=Aa(y,b),y!==null&&(_i(y,b,M),Ui(y,M))}function Av(y){var b=y.memoizedState,M=0;b!==null&&(M=b.retryLane),Mv(y,M)}function Yx(y,b){var M=0;switch(y.tag){case 13:var z=y.stateNode,q=y.memoizedState;q!==null&&(M=q.retryLane);break;case 19:z=y.stateNode;break;default:throw Error(s(314))}z!==null&&z.delete(b),Mv(y,M)}var jv;jv=function(y,b,M){if(y!==null)if(y.memoizedProps!==b.pendingProps||zr.current)Nn=!0;else{if((y.lanes&M)===0&&(b.flags&128)===0)return Nn=!1,Rl(y,b,M);Nn=(y.flags&131072)!==0}else Nn=!1,Or&&(b.flags&1048576)!==0&&Jh(b,Bo,b.index);switch(b.lanes=0,b.tag){case 2:var z=b.type;Yd(y,b),y=b.pendingProps;var q=ra(b,sn.current);Li(b,M),q=Pl(null,b,z,y,q,M);var ee=cc();return b.flags|=1,typeof q=="object"&&q!==null&&typeof q.render=="function"&&q.$$typeof===void 0?(b.tag=1,b.memoizedState=null,b.updateQueue=null,Tt(z)?(ee=!0,Xn(b)):ee=!1,b.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,Gd(b),q.updater=pi,b.stateNode=q,q._reactInternals=b,bs(b,z,y,M),b=Bi(null,b,z,!0,ee,M)):(b.tag=0,Or&&ee&&Ri(b),Vn(null,b,q,M),b=b.child),b;case 16:z=b.elementType;e:{switch(Yd(y,b),y=b.pendingProps,q=z._init,z=q(z._payload),b.type=z,q=b.tag=Xx(z),y=Mr(z,y),q){case 0:b=ho(null,b,z,y,M);break e;case 1:b=Ci(null,b,z,y,M);break e;case 11:b=of(null,b,z,y,M);break e;case 14:b=xu(null,b,z,Mr(z.type,y),M);break e}throw Error(s(306,z,""))}return b;case 0:return z=b.type,q=b.pendingProps,q=b.elementType===z?q:Mr(z,q),ho(y,b,z,q,M);case 1:return z=b.type,q=b.pendingProps,q=b.elementType===z?q:Mr(z,q),Ci(y,b,z,q,M);case 3:e:{if(jl(b),y===null)throw Error(s(387));z=b.pendingProps,ee=b.memoizedState,q=ee.element,Vs(y,b),fi(b,z,null,M);var he=b.memoizedState;if(z=he.element,_e&&ee.isDehydrated)if(ee={element:z,isDehydrated:!1,cache:he.cache,pendingSuspenseBoundaries:he.pendingSuspenseBoundaries,transitions:he.transitions},b.updateQueue.baseState=ee,b.memoizedState=ee,b.flags&256){q=Ko(Error(s(423)),b),b=bu(y,b,z,M,q);break e}else if(z!==q){q=Ko(Error(s(424)),b),b=bu(y,b,z,M,q);break e}else for(_e&&(on=Ds(b.stateNode.containerInfo),Fn=b,Or=!0,sa=null,bl=!1),M=ac(b,null,z,M),b.child=M;M;)M.flags=M.flags&-3|4096,M=M.sibling;else{if(io(),z===q){b=Qo(y,b,M);break e}Vn(y,b,z,M)}b=b.child}return b;case 5:return mu(b),y===null&&Fd(b),z=b.type,q=b.pendingProps,ee=y!==null?y.memoizedProps:null,he=q.children,me(z,q)?he=null:ee!==null&&me(z,ee)&&(b.flags|=32),Vr(y,b),Vn(y,b,he,M),b.child;case 6:return y===null&&Fd(b),null;case 13:return Lp(y,b,M);case 4:return Cl(b,b.stateNode.containerInfo),z=b.pendingProps,y===null?b.child=zo(b,null,z,M):Vn(y,b,z,M),b.child;case 11:return z=b.type,q=b.pendingProps,q=b.elementType===z?q:Mr(z,q),of(y,b,z,q,M);case 7:return Vn(y,b,b.pendingProps,M),b.child;case 8:return Vn(y,b,b.pendingProps.children,M),b.child;case 12:return Vn(y,b,b.pendingProps.children,M),b.child;case 10:e:{if(z=b.type._context,q=b.pendingProps,ee=b.memoizedProps,he=q.value,Ma(b,z,he),ee!==null)if(Ka(ee.value,he)){if(ee.children===q.children&&!zr.current){b=Qo(y,b,M);break e}}else for(ee=b.child,ee!==null&&(ee.return=b);ee!==null;){var Te=ee.dependencies;if(Te!==null){he=ee.child;for(var Be=Te.firstContext;Be!==null;){if(Be.context===z){if(ee.tag===1){Be=ja(-1,M&-M),Be.tag=2;var nt=ee.updateQueue;if(nt!==null){nt=nt.shared;var St=nt.pending;St===null?Be.next=Be:(Be.next=St.next,St.next=Be),nt.pending=Be}}ee.lanes|=M,Be=ee.alternate,Be!==null&&(Be.lanes|=M),Fo(ee.return,M,b),Te.lanes|=M;break}Be=Be.next}}else if(ee.tag===10)he=ee.type===b.type?null:ee.child;else if(ee.tag===18){if(he=ee.return,he===null)throw Error(s(341));he.lanes|=M,Te=he.alternate,Te!==null&&(Te.lanes|=M),Fo(he,M,b),he=ee.sibling}else he=ee.child;if(he!==null)he.return=ee;else for(he=ee;he!==null;){if(he===b){he=null;break}if(ee=he.sibling,ee!==null){ee.return=he.return,he=ee;break}he=he.return}ee=he}Vn(y,b,q.children,M),b=b.child}return b;case 9:return q=b.type,z=b.pendingProps.children,Li(b,M),q=oa(q),z=z(q),b.flags|=1,Vn(y,b,z,M),b.child;case 14:return z=b.type,q=Mr(z,b.pendingProps),q=Mr(z.type,q),xu(y,b,z,q,M);case 15:return Xo(y,b,b.type,b.pendingProps,M);case 17:return z=b.type,q=b.pendingProps,q=b.elementType===z?q:Mr(z,q),Yd(y,b),b.tag=1,Tt(z)?(y=!0,Xn(b)):y=!1,Li(b,M),$o(b,z,q),bs(b,z,q,M),Bi(null,b,z,!0,y,M);case 19:return uf(y,b,M);case 22:return $r(y,b,M)}throw Error(s(156,b.tag))};function qp(y,b){return On(y,b)}function Rv(y,b,M,z){this.tag=y,this.key=M,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=b,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=z,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function is(y,b,M,z){return new Rv(y,b,M,z)}function Ac(y){return y=y.prototype,!(!y||!y.isReactComponent)}function Xx(y){if(typeof y=="function")return Ac(y)?1:0;if(y!=null){if(y=y.$$typeof,y===_)return 11;if(y===k)return 14}return 2}function Vl(y,b){var M=y.alternate;return M===null?(M=is(y.tag,b,y.key,y.mode),M.elementType=y.elementType,M.type=y.type,M.stateNode=y.stateNode,M.alternate=y,y.alternate=M):(M.pendingProps=b,M.type=y.type,M.flags=0,M.subtreeFlags=0,M.deletions=null),M.flags=y.flags&14680064,M.childLanes=y.childLanes,M.lanes=y.lanes,M.child=y.child,M.memoizedProps=y.memoizedProps,M.memoizedState=y.memoizedState,M.updateQueue=y.updateQueue,b=y.dependencies,M.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext},M.sibling=y.sibling,M.index=y.index,M.ref=y.ref,M}function Sf(y,b,M,z,q,ee){var he=2;if(z=y,typeof y=="function")Ac(y)&&(he=1);else if(typeof y=="string")he=5;else e:switch(y){case c:return Ei(M.children,q,ee,b);case f:he=8,q|=8;break;case g:return y=is(12,M,b,q|2),y.elementType=g,y.lanes=ee,y;case S:return y=is(13,M,b,q),y.elementType=S,y.lanes=ee,y;case N:return y=is(19,M,b,q),y.elementType=N,y.lanes=ee,y;case T:return jc(M,q,ee,b);default:if(typeof y=="object"&&y!==null)switch(y.$$typeof){case v:he=10;break e;case x:he=9;break e;case _:he=11;break e;case k:he=14;break e;case E:he=16,z=null;break e}throw Error(s(130,y==null?y:typeof y,""))}return b=is(he,M,b,q),b.elementType=y,b.type=z,b.lanes=ee,b}function Ei(y,b,M,z){return y=is(7,y,z,b),y.lanes=M,y}function jc(y,b,M,z){return y=is(22,y,z,b),y.elementType=T,y.lanes=M,y.stateNode={isHidden:!1},y}function Rc(y,b,M){return y=is(6,y,null,b),y.lanes=M,y}function kf(y,b,M){return b=is(4,y.children!==null?y.children:[],y.key,b),b.lanes=M,b.stateNode={containerInfo:y.containerInfo,pendingChildren:null,implementation:y.implementation},b}function Lv(y,b,M,z,q){this.tag=b,this.containerInfo=y,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=oe,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ro(0),this.expirationTimes=ro(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ro(0),this.identifierPrefix=z,this.onRecoverableError=q,_e&&(this.mutableSourceEagerHydrationData=null)}function Wp(y,b,M,z,q,ee,he,Te,Be){return y=new Lv(y,b,M,Te,Be),b===1?(b=1,ee===!0&&(b|=8)):b=0,ee=is(3,null,null,b),y.current=ee,ee.stateNode=y,ee.memoizedState={element:z,isDehydrated:M,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gd(ee),y}function Cf(y){if(!y)return cr;y=y._reactInternals;e:{if(I(y)!==y||y.tag!==1)throw Error(s(170));var b=y;do{switch(b.tag){case 3:b=b.stateNode.context;break e;case 1:if(Tt(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break e}}b=b.return}while(b!==null);throw Error(s(171))}if(y.tag===1){var M=y.type;if(Tt(M))return uu(y,M,b)}return b}function Pu(y){var b=y._reactInternals;if(b===void 0)throw typeof y.render=="function"?Error(s(188)):(y=Object.keys(y).join(","),Error(s(268,y)));return y=Z(b),y===null?null:y.stateNode}function Ef(y,b){if(y=y.memoizedState,y!==null&&y.dehydrated!==null){var M=y.retryLane;y.retryLane=M!==0&&M<b?M:b}}function Lc(y,b){Ef(y,b),(y=y.alternate)&&Ef(y,b)}function Qx(y){return y=Z(y),y===null?null:y.stateNode}function Ov(){return null}return r.attemptContinuousHydration=function(y){if(y.tag===13){var b=Aa(y,134217728);if(b!==null){var M=Qr();Vi(b,y,134217728,M)}Lc(y,134217728)}},r.attemptDiscreteHydration=function(y){if(y.tag===13){var b=Aa(y,1);if(b!==null){var M=Qr();Vi(b,y,1,M)}Lc(y,1)}},r.attemptHydrationAtCurrentPriority=function(y){if(y.tag===13){var b=ni(y),M=Aa(y,b);if(M!==null){var z=Qr();Vi(M,y,b,z)}Lc(y,b)}},r.attemptSynchronousHydration=function(y){switch(y.tag){case 3:var b=y.stateNode;if(b.current.memoizedState.isDehydrated){var M=to(b.pendingLanes);M!==0&&(Pa(b,M|1),Ui(b,wn()),(Qt&6)===0&&(Dr(),Qn()))}break;case 13:zp(function(){var z=Aa(y,1);if(z!==null){var q=Qr();Vi(z,y,1,q)}}),Lc(y,1)}},r.batchedUpdates=function(y,b){var M=Qt;Qt|=1;try{return y(b)}finally{Qt=M,Qt===0&&(Dr(),no&&Qn())}},r.createComponentSelector=function(y){return{$$typeof:Jo,value:y}},r.createContainer=function(y,b,M,z,q,ee,he){return Wp(y,b,!1,null,M,z,q,ee,he)},r.createHasPseudoClassSelector=function(y){return{$$typeof:pa,value:y}},r.createHydrationContainer=function(y,b,M,z,q,ee,he,Te,Be){return y=Wp(M,z,!0,y,q,ee,he,Te,Be),y.context=Cf(null),M=y.current,z=Qr(),q=ni(M),ee=ja(z,q),ee.callback=b??null,Us(M,ee,q),y.current.lanes=q,_i(y,q,z),Ui(y,z),y},r.createPortal=function(y,b,M){var z=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:z==null?null:""+z,children:y,containerInfo:b,implementation:M}},r.createRoleSelector=function(y){return{$$typeof:po,value:y}},r.createTestNameSelector=function(y){return{$$typeof:_c,value:y}},r.createTextSelector=function(y){return{$$typeof:eh,value:y}},r.deferredUpdates=function(y){var b=nr,M=Tn.transition;try{return Tn.transition=null,nr=16,y()}finally{nr=b,Tn.transition=M}},r.discreteUpdates=function(y,b,M,z,q){var ee=nr,he=Tn.transition;try{return Tn.transition=null,nr=1,y(b,M,z,q)}finally{nr=ee,Tn.transition=he,Qt===0&&Dr()}},r.findAllNodes=vo,r.findBoundingRects=function(y,b){if(!We)throw Error(s(363));b=vo(y,b),y=[];for(var M=0;M<b.length;M++)y.push(ze(b[M]));for(b=y.length-1;0<b;b--){M=y[b];for(var z=M.x,q=z+M.width,ee=M.y,he=ee+M.height,Te=b-1;0<=Te;Te--)if(b!==Te){var Be=y[Te],nt=Be.x,St=nt+Be.width,Kt=Be.y,mt=Kt+Be.height;if(z>=nt&&ee>=Kt&&q<=St&&he<=mt){y.splice(b,1);break}else if(z!==nt||M.width!==Be.width||mt<ee||Kt>he){if(!(ee!==Kt||M.height!==Be.height||St<z||nt>q)){nt>z&&(Be.width+=nt-z,Be.x=z),St<q&&(Be.width=q-nt),y.splice(b,1);break}}else{Kt>ee&&(Be.height+=Kt-ee,Be.y=ee),mt<he&&(Be.height=he-Kt),y.splice(b,1);break}}}return y},r.findHostInstance=Pu,r.findHostInstanceWithNoPortals=function(y){return y=$(y),y=y!==null?W(y):null,y===null?null:y.stateNode},r.findHostInstanceWithWarning=function(y){return Pu(y)},r.flushControlled=function(y){var b=Qt;Qt|=1;var M=Tn.transition,z=nr;try{Tn.transition=null,nr=1,y()}finally{nr=z,Tn.transition=M,Qt=b,Qt===0&&(Dr(),Qn())}},r.flushPassiveEffects=rl,r.flushSync=zp,r.focusWithin=function(y,b){if(!We)throw Error(s(363));for(y=mo(y),b=go(y,b),b=Array.from(b),y=0;y<b.length;){var M=b[y++];if(!et(M)){if(M.tag===5&&Nt(M.stateNode))return!0;for(M=M.child;M!==null;)b.push(M),M=M.sibling}}return!1},r.getCurrentUpdatePriority=function(){return nr},r.getFindAllNodesFailureDescription=function(y,b){if(!We)throw Error(s(363));var M=0,z=[];y=[mo(y),0];for(var q=0;q<y.length;){var ee=y[q++],he=y[q++],Te=b[he];if((ee.tag!==5||!et(ee))&&(th(ee,Te)&&(z.push(gf(Te)),he++,he>M&&(M=he)),he<b.length))for(ee=ee.child;ee!==null;)y.push(ee,he),ee=ee.sibling}if(M<b.length){for(y=[];M<b.length;M++)y.push(gf(b[M]));return`findAllNodes was able to match part of the selector:
  `+(z.join(" > ")+`

No matching component was found for:
  `)+y.join(" > ")}return null},r.getPublicRootInstance=function(y){return y=y.current,y.child?y.child.tag===5?K(y.child.stateNode):y.child.stateNode:null},r.injectIntoDevTools=function(y){if(y={bundleType:y.bundleType,version:y.version,rendererPackageName:y.rendererPackageName,rendererConfig:y.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:Qx,findFiberByHostInstance:y.findFiberByHostInstance||Ov,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")y=!1;else{var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)y=!0;else{try{Wr=b.inject(y),_n=b}catch{}y=!!b.checkDCE}}return y},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(y,b,M,z){if(!We)throw Error(s(363));y=vo(y,b);var q=Mt(y,M,z).disconnect;return{disconnect:function(){q()}}},r.registerMutableSourceForHydration=function(y,b){var M=b._getVersion;M=M(b._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[b,M]:y.mutableSourceEagerHydrationData.push(b,M)},r.runWithPriority=function(y,b){var M=nr;try{return nr=y,b()}finally{nr=M}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(y,b,M,z){var q=b.current,ee=Qr(),he=ni(q);return M=Cf(M),b.context===null?b.context=M:b.pendingContext=M,b=ja(ee,he),b.payload={element:y},z=z===void 0?null:z,z!==null&&(b.callback=z),y=Us(q,b,he),y!==null&&(Vi(y,q,he,ee),Uo(y,q,he)),he},r}),_w}var O5;function $z(){return O5||(O5=1,ww.exports=Wz()),ww.exports}var Kz=$z();const Zz=Wh(Kz);var Sw={exports:{}},$c={};var D5;function Yz(){return D5||(D5=1,$c.ConcurrentRoot=1,$c.ContinuousEventPriority=4,$c.DefaultEventPriority=16,$c.DiscreteEventPriority=1,$c.IdleEventPriority=536870912,$c.LegacyRoot=0),$c}var I5;function Xz(){return I5||(I5=1,Sw.exports=Yz()),Sw.exports}var vM=Xz(),Qz=lr();const B5={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let z5=!1,F5=!1;const eS=".react-konva-event",Jz=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,eF=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,tF={};function Ax(t,e,r=tF){if(!z5&&"zIndex"in e&&(console.warn(eF),z5=!0),!F5&&e.draggable){var n=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;n&&!i&&(console.warn(Jz),F5=!0)}for(var a in r)if(!B5[a]){var s=a.slice(0,2)==="on",o=r[a]!==e[a];if(s&&o){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),t.off(l,r[a])}var u=!e.hasOwnProperty(a);u&&t.setAttr(a,void 0)}var c=e._useStrictMode,f={},g=!1;const v={};for(var a in e)if(!B5[a]){var s=a.slice(0,2)==="on",x=r[a]!==e[a];if(s&&x){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e[a]&&(v[l]=e[a])}!s&&(e[a]!==r[a]||c&&e[a]!==t.getAttr(a))&&(g=!0,f[a]=e[a])}g&&(t.setAttrs(f),jd(t));for(var l in v)t.on(l+eS,v[l])}function jd(t){if(!Qz.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}var kw=b_();const yM={},rF={};Ug.Node.prototype._applyProps=Ax;function nF(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),jd(t)}function iF(t,e,r){let n=Ug[t];n||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=Ug.Group);const i={},a={};for(var s in e){var o=s.slice(0,2)==="on";o?a[s]=e[s]:i[s]=e[s]}const l=new n(i);return Ax(l,a),l}function aF(t,e,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function sF(t,e,r){return!1}function oF(t){return t}function lF(){return null}function uF(){return null}function cF(t,e,r,n){return rF}function dF(){}function hF(t){}function fF(t,e){return!1}function pF(){return yM}function mF(){return yM}const gF=setTimeout,vF=clearTimeout,yF=-1;function xF(t,e){return!1}const bF=!1,wF=!0,_F=!0;function SF(t,e){e.parent===t?e.moveToTop():t.add(e),jd(t)}function kF(t,e){e.parent===t?e.moveToTop():t.add(e),jd(t)}function xM(t,e,r){e._remove(),t.add(e),e.setZIndex(r.getZIndex()),jd(t)}function CF(t,e,r){xM(t,e,r)}function EF(t,e){e.destroy(),e.off(eS),jd(t)}function NF(t,e){e.destroy(),e.off(eS),jd(t)}function TF(t,e,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function PF(t,e,r){}function MF(t,e,r,n,i){Ax(t,i,n)}function AF(t){t.hide(),jd(t)}function jF(t){}function RF(t,e){(e.visible==null||e.visible)&&t.show()}function LF(t,e){}function OF(t){}function DF(){}const IF=()=>vM.DefaultEventPriority,BF=Object.freeze(Object.defineProperty({__proto__:null,appendChild:SF,appendChildToContainer:kF,appendInitialChild:nF,cancelTimeout:vF,clearContainer:OF,commitMount:PF,commitTextUpdate:TF,commitUpdate:MF,createInstance:iF,createTextInstance:aF,detachDeletedInstance:DF,finalizeInitialChildren:sF,getChildHostContext:mF,getCurrentEventPriority:IF,getPublicInstance:oF,getRootHostContext:pF,hideInstance:AF,hideTextInstance:jF,idlePriority:kw.unstable_IdlePriority,insertBefore:xM,insertInContainerBefore:CF,isPrimaryRenderer:bF,noTimeout:yF,now:kw.unstable_now,prepareForCommit:lF,preparePortalMount:uF,prepareUpdate:cF,removeChild:EF,removeChildFromContainer:NF,resetAfterCommit:dF,resetTextContent:hF,run:kw.unstable_runWithPriority,scheduleTimeout:gF,shouldDeprioritizeSubtree:fF,shouldSetTextContent:xF,supportsMutation:_F,unhideInstance:RF,unhideTextInstance:LF,warnsIfNotActing:wF},Symbol.toStringTag,{value:"Module"}));var zF=Object.defineProperty,FF=Object.defineProperties,VF=Object.getOwnPropertyDescriptors,V5=Object.getOwnPropertySymbols,UF=Object.prototype.hasOwnProperty,HF=Object.prototype.propertyIsEnumerable,U5=(t,e,r)=>e in t?zF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,H5=(t,e)=>{for(var r in e||(e={}))UF.call(e,r)&&U5(t,r,e[r]);if(V5)for(var r of V5(e))HF.call(e,r)&&U5(t,r,e[r]);return t},GF=(t,e)=>FF(t,VF(e)),G5,q5;typeof window<"u"&&((G5=window.document)!=null&&G5.createElement||((q5=window.navigator)==null?void 0:q5.product)==="ReactNative")?ce.useLayoutEffect:ce.useEffect;function bM(t,e,r){if(!t)return;if(r(t)===!0)return t;let n=t.child;for(;n;){const i=bM(n,e,r);if(i)return i;n=n.sibling}}function wM(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const W5=console.error;console.error=function(){const t=[...arguments].join("");if(t?.startsWith("Warning:")&&t.includes("useContext")){console.error=W5;return}return W5.apply(this,arguments)};const tS=wM(ce.createContext(null));class _M extends ce.Component{render(){return ce.createElement(tS.Provider,{value:this._reactInternals},this.props.children)}}function qF(){const t=ce.useContext(tS);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ce.useId();return ce.useMemo(()=>{for(const n of[t,t?.alternate]){if(!n)continue;const i=bM(n,!1,a=>{let s=a.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(i)return i}},[t,e])}function WF(){const t=qF(),[e]=ce.useState(()=>new Map);e.clear();let r=t;for(;r;){if(r.type&&typeof r.type=="object"){const i=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;i&&i!==tS&&!e.has(i)&&e.set(i,ce.useContext(wM(i)))}r=r.return}return e}function $F(){const t=WF();return ce.useMemo(()=>Array.from(t.keys()).reduce((e,r)=>n=>ce.createElement(e,null,ce.createElement(r.Provider,GF(H5({},n),{value:t.get(r)}))),e=>ce.createElement(_M,H5({},e))),[t])}function KF(t){const e=er.useRef({});return er.useLayoutEffect(()=>{e.current=t}),er.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const ZF=t=>{const e=er.useRef(),r=er.useRef(),n=er.useRef(),i=KF(t),a=$F(),s=o=>{const{forwardedRef:l}=t;l&&(typeof l=="function"?l(o):l.current=o)};return er.useLayoutEffect(()=>(r.current=new Ug.Stage({width:t.width,height:t.height,container:e.current}),s(r.current),n.current=lg.createContainer(r.current,vM.LegacyRoot,!1,null),lg.updateContainer(er.createElement(a,{},t.children),n.current),()=>{Ug.isBrowser&&(s(null),lg.updateContainer(null,n.current,null),r.current.destroy())}),[]),er.useLayoutEffect(()=>{s(r.current),Ax(r.current,t,i),lg.updateContainer(er.createElement(a,{},t.children),n.current,null)}),er.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},$5="Layer",K5="Rect",YF="Line",XF="Image",QF="Text",JF="Transformer",lg=Zz(BF);lg.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:er.version,rendererPackageName:"react-konva"});const eV=er.forwardRef((t,e)=>er.createElement(_M,{},er.createElement(ZF,{...t,forwardedRef:e}))),tV=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,initialValue:a="",placeholder:s="",confirmText:o="Confirmar",cancelText:l="Cancelar"})=>{const[u,c]=ce.useState(a),f=ce.useRef(null);if(ce.useEffect(()=>{c(a)},[a,t]),ce.useEffect(()=>{t&&f.current&&setTimeout(()=>f.current.focus(),50)},[t]),!t)return null;const g=v=>{v.preventDefault(),r(u),e()};return nu.createPortal(p.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-md animate-in fade-in duration-300",children:p.jsxs("div",{className:"bg-[#0f0f13] border border-white/10 rounded-2xl p-6 shadow-2xl shadow-black/50 w-full max-w-md space-y-5 animate-in zoom-in-95 slide-in-from-bottom-2 duration-300 relative overflow-hidden ring-1 ring-white/5",onClick:v=>v.stopPropagation(),children:[p.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary to-transparent opacity-70"}),p.jsx("div",{className:"absolute -top-10 -right-10 size-40 bg-primary/5 rounded-full blur-3xl pointer-events-none"}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:n}),i&&p.jsx("p",{className:"text-sm text-slate-400 leading-relaxed mt-2",children:i})]}),p.jsxs("form",{onSubmit:g,className:"space-y-6",children:[p.jsx("input",{ref:f,type:"text",value:u,onChange:v=>c(v.target.value),placeholder:s,className:"w-full bg-black/30 border border-white/10 rounded-xl px-4 py-3.5 text-white placeholder-slate-600 focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all font-sans text-sm shadow-inner"}),p.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[p.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors",children:l}),p.jsx(rn,{type:"submit",variant:"primary",disabled:!u.trim(),children:o})]})]})]})}),document.body)},Cw=({stepNumber:t,title:e,isOpen:r,onClick:n,children:i})=>p.jsxs("div",{className:`border border-white/10 rounded-2xl bg-[#13141f] overflow-hidden transition-all duration-300 ${r?"ring-1 ring-primary/50":"opacity-80"}`,children:[p.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-6 hover:bg-white/5 transition-colors",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:`size-8 rounded-full flex items-center justify-center font-black text-sm ${r?"bg-primary text-white":"bg-white/10 text-slate-400"}`,children:t}),p.jsx("h3",{className:`text-lg font-bold ${r?"text-white":"text-slate-400"}`,children:e})]}),p.jsx("span",{className:`material-symbols-outlined transition-transform duration-300 ${r?"rotate-180 text-primary":"text-slate-500"}`,children:"expand_more"})]}),r&&p.jsx("div",{className:"p-6 pt-0 border-t border-white/5 animate-in fade-in slide-in-from-top-2",children:i})]}),Ew=({icon:t,title:e,desc:r,selected:n,onClick:i})=>p.jsxs("div",{onClick:i,className:`p-6 rounded-xl border cursor-pointer transition-all relative group h-full flex flex-col justify-between ${n?"bg-primary/20 border-primary shadow-[0_0_30px_rgba(var(--color-primary),0.3)]":"bg-[#0a0a0c] border-white/10 hover:border-white/30"}`,children:[p.jsxs("div",{className:"mb-4",children:[p.jsx("div",{className:`size-12 rounded-lg flex items-center justify-center mb-4 ${n?"bg-primary text-white":"bg-white/10 text-slate-400 group-hover:text-white group-hover:bg-white/20"}`,children:p.jsx("span",{className:"material-symbols-outlined text-2xl",children:t})}),p.jsx("h4",{className:"font-bold text-white mb-1",children:e}),p.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:r})]}),n&&p.jsx("div",{className:"absolute top-4 right-4 size-3 bg-primary rounded-full shadow-glow"})]}),rV=({src:t,x:e,y:r,width:n,height:i})=>{const[a,s]=ce.useState(null);return ce.useEffect(()=>{if(!t)return;const o=new window.Image;o.src=t,o.crossOrigin="Anonymous",o.onload=()=>{s(o)}},[t]),p.jsx(XF,{image:a,x:e,y:r,width:n,height:i})},nV=({selectedId:t})=>{const e=er.useRef();return er.useEffect(()=>{if(t){const r=e.current.getStage().findOne("#"+t);r&&(e.current.nodes([r]),e.current.getLayer().batchDraw())}else e.current.nodes([])},[t]),p.jsx(JF,{ref:e})},D2=({mode:t})=>{const{username:e,projectName:r,folderId:n,entityId:i}=ds(),a=Ga(),s=$h(),{setRightOpen:o,setRightPanelMode:l,setAvailableTemplates:u,mapSettings:c,setMapSettings:f,setOnMapSettingsChange:g}=Zu(),[v,x]=ce.useState(t==="create"?"setup":"editor");ce.useEffect(()=>{x(t==="create"?"setup":"editor")},[t]);const[_,S]=ce.useState(s.state?.folderId||null),[N,k]=ce.useState(1),[E,T]=ce.useState({name:"New Map",description:"",parentZone:null,type:"regional",sourceType:"blank",dims:{width:800,height:600},bgImage:null}),[R,j]=ce.useState(!1),[D,B]=ce.useState("brush"),[I,V]=ce.useState([]),[$,Z]=ce.useState([]),[O,W]=ce.useState([]),[F,K]=ce.useState(null),X=er.useRef(!1),[Q,ae]=ce.useState({isOpen:!1,id:null,text:""}),re=oe=>{oe.target===oe.target.getStage()&&K(null)},G=oe=>{re(oe);const ge=oe.target.getStage().getPointerPosition();D!=="select"&&(X.current=!0,D==="brush"||D==="eraser"?V([...I,{id:`line-${Date.now()}`,tool:D,points:[ge.x,ge.y],color:D==="eraser"?"#ffffff":"#df4b26",size:D==="eraser"?20:5}]):D==="rect"?Z([...$,{id:`rect-${Date.now()}`,x:ge.x,y:ge.y,width:0,height:0,color:"#df4b26"}]):D==="text"&&(W([...O,{id:`text-${Date.now()}`,x:ge.x,y:ge.y,text:"Double click to edit",fontSize:20,color:"#ffffff"}]),X.current=!1))},te=oe=>{if(!X.current)return;const ge=oe.target.getStage().getPointerPosition();D==="brush"||D==="eraser"?V(be=>{const _e=[...be],De={..._e[_e.length-1]};return De.points=De.points.concat([ge.x,ge.y]),_e[_e.length-1]=De,_e}):D==="rect"&&Z(be=>{const _e=[...be],De={..._e[_e.length-1]};return De.width=ge.x-De.x,De.height=ge.y-De.y,_e[_e.length-1]=De,_e})},ne=()=>{X.current=!1};ce.useEffect(()=>{if(o(v==="editor"),v==="editor"){l("MAP");const oe={showGrid:!0,gridSize:50,width:E.dims.width,height:E.dims.height};f(oe),g(fe=>{fe&&T(ge=>({...ge,dims:{width:fe.width,height:fe.height},bgImage:fe.bgImage||ge.bgImage}))})}},[v]),ce.useEffect(()=>{t==="create"&&!_&&n&&(console.log("Resolving folder ID for slug:",n),it.get(`/world-bible/folders/${n}`).then(oe=>S(oe.id)).catch(oe=>console.error("Could not resolve folder ID",oe)))},[t,n,_]);const de=oe=>{const fe=oe.target.files[0];if(fe){const ge=new FileReader;ge.onload=be=>{const _e=new Image;_e.onload=()=>{T(De=>({...De,bgImage:be.target.result,dims:{width:_e.width,height:_e.height},sourceType:"upload"}))},_e.src=be.target.result},ge.readAsDataURL(fe)}},me=er.useRef(null),ye=async()=>{if(!_){alert("Folder context missing. Please start from the folder view again.");return}j(!0);try{let oe=E.bgImage;if(me.current){const be=me.current.findOne("Transformer");if(be&&be.nodes([]),oe=me.current.toDataURL({pixelRatio:.5}),be&&F){const _e=me.current.findOne("#"+F);_e&&be.nodes([_e])}}const fe={nombre:E.name,tipoEspecial:"map",carpetaId:_,descripcion:E.description,attributes:{type:E.type,width:E.dims.width,height:E.dims.height,bgImage:E.bgImage,layers:{lines:I,rectangles:$,texts:O},snapshotUrl:oe},iconUrl:oe},ge=await it.post("/world-bible/entities",fe);window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:_}})),a(`/${e}/${r}/map-editor/edit/${ge.id}`,{replace:!0})}catch(oe){console.error(oe),alert("Error creating map. Check console.")}finally{j(!1)}},ie=er.useRef(null);ce.useEffect(()=>{(!t||t==="edit")&&i&&it.get(`/world-bible/entities/${i}`).then(oe=>{S(oe.carpetaId),ie.current=oe.iconUrl,x("editor");let fe=oe.attributes||{},ge={};const be=fe.layers||fe.bgImage;if(!be&&oe.descripcion&&oe.descripcion.trim().startsWith("{"))try{ge=JSON.parse(oe.descripcion)}catch(qe){console.error("Error parsing legacy map data",qe)}const _e=be?fe:ge;let De=oe.descripcion;oe.descripcion&&oe.descripcion.trim().startsWith("{")&&(De=ge.description||""),T({name:oe.nombre,description:De||"",parentZone:null,type:_e.type||"regional",sourceType:_e.bgImage?"upload":"blank",dims:{width:_e.width||800,height:_e.height||600},bgImage:_e.bgImage}),_e.layers&&(V(_e.layers.lines||[]),Z(_e.layers.rectangles||[]),W(_e.layers.texts||[])),f({name:oe.nombre,description:De||"",type:_e.type||"regional",showGrid:!0,gridSize:50,width:_e.width||800,height:_e.height||600,bgImage:_e.bgImage})}).catch(oe=>console.error("Error loading entity",oe))},[t,i]);const pe=async()=>{j(!0);try{let oe=E.bgImage;if(me.current){K(null);const ge=me.current.findOne("Transformer");ge&&ge.nodes([]),oe=me.current.toDataURL({pixelRatio:.5})}const fe={id:i,nombre:E.name,tipoEspecial:"map",carpetaId:_,descripcion:E.description,attributes:{type:E.type,width:E.dims.width,height:E.dims.height,bgImage:E.bgImage,layers:{lines:I,rectangles:$,texts:O},snapshotUrl:oe},iconUrl:ie.current};await it.put(`/world-bible/entities/${i}`,fe),a(_?`/${e}/${r}/bible/folder/${_}`:`/${e}/${r}/bible`)}catch(oe){console.error("Save failed",oe),alert("Error saving map")}finally{j(!1)}};return v==="setup"?p.jsxs("div",{className:"flex-1 flex flex-col h-screen bg-[#060608] text-white",children:[p.jsxs("div",{className:"h-16 border-b border-white/5 flex items-center justify-between px-8 bg-[#0a0a0c]",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"p-2 bg-primary/20 rounded-lg text-primary",children:p.jsx("span",{className:"material-symbols-outlined",children:"add_circle"})}),p.jsxs("div",{children:[p.jsx("h1",{className:"text-lg font-bold leading-tight",children:"Create New Map / Zone"}),p.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-bold tracking-wider",children:"Configure details for your new cartography entry"})]})]}),p.jsx("button",{onClick:()=>a(-1),className:"p-2 hover:bg-white/5 rounded-full text-slate-500 hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),p.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-8",children:p.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[p.jsx(Cw,{stepNumber:"1",title:"Identity & Hierarchy",isOpen:N===1,onClick:()=>k(1),children:p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Map Name"}),p.jsx("input",{autoFocus:!0,value:E.name,onChange:oe=>T({...E,name:oe.target.value}),className:"w-full bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-white focus:border-primary outline-none transition-colors",placeholder:"e.g. The Sapphire Coast"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Parent Zone (Optional)"}),p.jsxs("div",{className:"w-full bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-slate-400 flex items-center justify-between cursor-pointer hover:border-white/20",children:[p.jsx("span",{children:"Current Folder (Default)"}),p.jsx("span",{className:"material-symbols-outlined text-sm",children:"expand_more"})]}),p.jsx("p",{className:"text-[10px] text-slate-600 mt-2",children:"Selecting a parent makes this a sub-zone."})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Description"}),p.jsx("textarea",{value:E.description,onChange:oe=>T({...E,description:oe.target.value}),className:"w-full h-40 bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-white resize-none focus:border-primary outline-none transition-colors leading-relaxed",placeholder:"Brief description of geography, climate, or importance..."})]})]})}),p.jsx(Cw,{stepNumber:"2",title:"Map Type",isOpen:N===2,onClick:()=>k(2),children:p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsx(Ew,{icon:"public",title:"World Map",desc:"Continents, oceans, global scale.",selected:E.type==="world",onClick:()=>T({...E,type:"world"})}),p.jsx(Ew,{icon:"map",title:"Regional Map",desc:"Kingdoms, provinces, biomes.",selected:E.type==="regional",onClick:()=>T({...E,type:"regional"})}),p.jsx(Ew,{icon:"location_city",title:"City / Local",desc:"Cities, dungeons, battlemaps.",selected:E.type==="local",onClick:()=>T({...E,type:"local"})})]})}),p.jsx(Cw,{stepNumber:"3",title:"Canvas Source",isOpen:N===3,onClick:()=>k(3),children:p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{onClick:()=>document.getElementById("map-upload-input").click(),className:`relative p-8 rounded-xl border-2 border-dashed flex flex-col items-center justify-center text-center cursor-pointer transition-all group min-h-[200px] ${E.sourceType==="upload"?"border-primary bg-primary/5":"border-white/10 hover:border-white/30 bg-[#0a0a0c]"}`,children:[p.jsx("input",{id:"map-upload-input",type:"file",accept:"image/*",className:"hidden",onChange:de}),E.bgImage?p.jsx("img",{src:E.bgImage,alt:"Preview",className:"absolute inset-0 w-full h-full object-cover rounded-xl opacity-50 group-hover:opacity-70"}):p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"size-16 bg-white/5 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:p.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"cloud_upload"})}),p.jsx("h4",{className:"font-bold text-white",children:"Upload Image File"}),p.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Drag & drop or click to browse"}),p.jsx("p",{className:"text-[10px] text-slate-600 mt-1 uppercase font-bold",children:"JPG, PNG, WEBP  Max 20MB"})]}),E.sourceType==="upload"&&p.jsx("div",{className:"absolute top-4 right-4 size-3 bg-primary rounded-full shadow-glow z-10"})]}),p.jsxs("div",{onClick:()=>T({...E,sourceType:"blank",bgImage:null}),className:`p-8 rounded-xl border flex flex-col items-center justify-center text-center cursor-pointer transition-all min-h-[200px] ${E.sourceType==="blank"?"border-primary bg-primary/5":"border-white/10 hover:border-white/30 bg-[#0a0a0c]"}`,children:[p.jsx("div",{className:"size-16 bg-white/5 rounded-full flex items-center justify-center mb-4",children:p.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"check_box_outline_blank"})}),p.jsx("h4",{className:"font-bold text-white",children:"Blank Canvas"}),p.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Start a new drawing from scratch"}),E.sourceType==="blank"&&p.jsxs("div",{className:"mt-6 flex items-center gap-2 bg-black/50 p-1 rounded-lg border border-white/10",children:[p.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 px-2",children:"Size"}),p.jsx("span",{className:"text-xs font-mono text-white",children:"4096 px"}),p.jsx("span",{className:"text-xs text-slate-500",children:"x"}),p.jsx("span",{className:"text-xs font-mono text-white",children:"4096 px"})]})]})]})})]})}),p.jsxs("div",{className:"h-20 border-t border-white/5 bg-[#0a0a0c] flex items-center justify-between px-8 z-20",children:[p.jsx("button",{onClick:()=>a(-1),className:"text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"Cancel"}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("span",{className:"text-xs text-slate-600 italic",children:"Changes saved locally"}),p.jsx(rn,{variant:"primary",size:"lg",icon:"check",onClick:ye,disabled:!E.name||R,className:"bg-primary hover:bg-primary-light text-white shadow-lg shadow-primary/25 px-8",children:R?"Creating...":"Create Map"})]})]})]}):p.jsxs("div",{className:"flex flex-col h-screen w-full bg-[#0f0f13] text-white overflow-hidden",children:[p.jsxs("header",{className:"h-14 border-b border-white/5 flex items-center justify-between px-4 bg-[#1a1a20] shrink-0",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("button",{onClick:()=>a(-1),className:"p-2 hover:bg-white/5 rounded-full",title:"Back to Collection",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"})}),p.jsxs("div",{className:"flex flex-col",children:[p.jsx("input",{value:E.name,onChange:oe=>T({...E,name:oe.target.value}),className:"bg-transparent font-bold text-sm outline-none focus:bg-white/5 rounded px-2 -ml-2"}),p.jsxs("span",{className:"text-[10px] text-text-muted px-2",children:[E.dims.width," x ",E.dims.height,"  ",c?.gridSize||50,"px Grid"]})]})]}),p.jsx("div",{className:"flex items-center gap-2",children:p.jsx(rn,{variant:"primary",size:"sm",icon:"save",onClick:pe,disabled:R,children:R?"Saving...":"Save Changes"})})]}),p.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[p.jsx("div",{className:"w-14 bg-[#1a1a20] border-r border-white/5 flex flex-col items-center py-4 gap-4 z-10",children:[{id:"select",icon:"near_me"},{id:"brush",icon:"brush"},{id:"eraser",icon:"ink_eraser"},{id:"rect",icon:"check_box_outline_blank"},{id:"text",icon:"title"}].map(oe=>p.jsx("button",{onClick:()=>B(oe.id),className:`p-2 rounded-lg transition-colors ${D===oe.id?"bg-primary text-white shadow-lg shadow-primary/30":"hover:bg-white/5 text-slate-400 hover:text-white"}`,children:p.jsx("span",{className:"material-symbols-outlined",children:oe.icon})},oe.id))}),p.jsx("div",{className:"flex-1 overflow-auto bg-[#0f0f13] relative flex items-center justify-center p-8 custom-scrollbar",children:p.jsx("div",{className:"bg-[#1a1a20] shadow-[0_0_50px_rgba(0,0,0,0.5)] flex-none",children:p.jsxs(eV,{ref:me,width:E.dims.width,height:E.dims.height,onMouseDown:G,onMouseMove:te,onMouseUp:ne,className:"bg-white",children:[p.jsxs($5,{children:[E.bgImage&&p.jsx(rV,{src:E.bgImage,x:0,y:0,width:E.dims.width,height:E.dims.height,onMouseDown:G,onTouchStart:G}),c?.showGrid&&p.jsx(K5,{width:E.dims.width,height:E.dims.height,fillPatternImage:(()=>{const oe=document.createElement("canvas");oe.width=c.gridSize||50,oe.height=c.gridSize||50;const fe=oe.getContext("2d");return fe.strokeStyle="rgba(0,0,0,0.2)",fe.lineWidth=1,fe.strokeRect(0,0,oe.width,oe.height),oe})(),listening:!1})]}),p.jsxs($5,{children:[I.map((oe,fe)=>p.jsx(YF,{points:oe.points,stroke:oe.color,strokeWidth:oe.size,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:oe.tool==="eraser"?"destination-out":"source-over"},fe)),$.map((oe,fe)=>p.jsx(K5,{id:oe.id,x:oe.x,y:oe.y,width:oe.width,height:oe.height,stroke:oe.color,strokeWidth:2,draggable:D==="select",onClick:()=>D==="select"&&K(oe.id),onTap:()=>D==="select"&&K(oe.id)},oe.id)),O.map((oe,fe)=>p.jsx(QF,{id:oe.id,x:oe.x,y:oe.y,text:oe.text,fontSize:oe.fontSize,fill:oe.color,draggable:D==="select",onClick:()=>D==="select"&&K(oe.id),onTap:()=>D==="select"&&K(oe.id),onDblClick:ge=>{ae({isOpen:!0,id:oe.id,text:oe.text})}},oe.id)),p.jsx(nV,{selectedId:F})]})]})})})]}),p.jsx(tV,{isOpen:Q.isOpen,onClose:()=>ae(oe=>({...oe,isOpen:!1})),title:"Edit Map Text",initialValue:Q.text,onConfirm:oe=>{W(fe=>fe.map(ge=>ge.id===Q.id?{...ge,text:oe}:ge))},confirmText:"Save Text"})]})};function SM(t,e){const r=ce.useRef(e);ce.useEffect(function(){e!==r.current&&t.attributionControl!=null&&(r.current!=null&&t.attributionControl.removeAttribution(r.current),e!=null&&t.attributionControl.addAttribution(e)),r.current=e},[t,e])}const iV=1;function aV(t){return Object.freeze({__version:iV,map:t})}function kM(t,e){return Object.freeze({...t,...e})}const CM=ce.createContext(null),EM=CM.Provider;function rS(){const t=ce.useContext(CM);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function sV(t){function e(r,n){const{instance:i,context:a}=t(r).current;return ce.useImperativeHandle(n,()=>i),r.children==null?null:er.createElement(EM,{value:a},r.children)}return ce.forwardRef(e)}function oV(t){function e(r,n){const[i,a]=ce.useState(!1),{instance:s}=t(r,a).current;ce.useImperativeHandle(n,()=>s),ce.useEffect(function(){i&&s.update()},[s,i,r.children]);const o=s._contentNode;return o?nu.createPortal(r.children,o):null}return ce.forwardRef(e)}function NM(t,e){const r=ce.useRef();ce.useEffect(function(){return e!=null&&t.instance.on(e),r.current=e,function(){r.current!=null&&t.instance.off(r.current),r.current=null}},[t,e])}function TM(t,e){const r=t.pane??e.pane;return r?{...t,pane:r}:t}function lV(t,e){return function(n,i){const a=rS(),s=t(TM(n,a),a);return SM(a.map,n.attribution),NM(s.current,n.eventHandlers),e(s.current,a,n,i),s}}var ug={exports:{}};var uV=ug.exports,Z5;function cV(){return Z5||(Z5=1,(function(t,e){(function(r,n){n(e)})(uV,(function(r){var n="1.9.4";function i(h){var w,P,U,J;for(P=1,U=arguments.length;P<U;P++){J=arguments[P];for(w in J)h[w]=J[w]}return h}var a=Object.create||(function(){function h(){}return function(w){return h.prototype=w,new h}})();function s(h,w){var P=Array.prototype.slice;if(h.bind)return h.bind.apply(h,P.call(arguments,1));var U=P.call(arguments,2);return function(){return h.apply(w,U.length?U.concat(P.call(arguments)):arguments)}}var o=0;function l(h){return"_leaflet_id"in h||(h._leaflet_id=++o),h._leaflet_id}function u(h,w,P){var U,J,le,we;return we=function(){U=!1,J&&(le.apply(P,J),J=!1)},le=function(){U?J=arguments:(h.apply(P,arguments),setTimeout(we,w),U=!0)},le}function c(h,w,P){var U=w[1],J=w[0],le=U-J;return h===U&&P?h:((h-J)%le+le)%le+J}function f(){return!1}function g(h,w){if(w===!1)return h;var P=Math.pow(10,w===void 0?6:w);return Math.round(h*P)/P}function v(h){return h.trim?h.trim():h.replace(/^\s+|\s+$/g,"")}function x(h){return v(h).split(/\s+/)}function _(h,w){Object.prototype.hasOwnProperty.call(h,"options")||(h.options=h.options?a(h.options):{});for(var P in w)h.options[P]=w[P];return h.options}function S(h,w,P){var U=[];for(var J in h)U.push(encodeURIComponent(P?J.toUpperCase():J)+"="+encodeURIComponent(h[J]));return(!w||w.indexOf("?")===-1?"?":"&")+U.join("&")}var N=/\{ *([\w_ -]+) *\}/g;function k(h,w){return h.replace(N,function(P,U){var J=w[U];if(J===void 0)throw new Error("No value provided for variable "+P);return typeof J=="function"&&(J=J(w)),J})}var E=Array.isArray||function(h){return Object.prototype.toString.call(h)==="[object Array]"};function T(h,w){for(var P=0;P<h.length;P++)if(h[P]===w)return P;return-1}var R="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function j(h){return window["webkit"+h]||window["moz"+h]||window["ms"+h]}var D=0;function B(h){var w=+new Date,P=Math.max(0,16-(w-D));return D=w+P,window.setTimeout(h,P)}var I=window.requestAnimationFrame||j("RequestAnimationFrame")||B,V=window.cancelAnimationFrame||j("CancelAnimationFrame")||j("CancelRequestAnimationFrame")||function(h){window.clearTimeout(h)};function $(h,w,P){if(P&&I===B)h.call(w);else return I.call(window,s(h,w))}function Z(h){h&&V.call(window,h)}var O={__proto__:null,extend:i,create:a,bind:s,get lastId(){return o},stamp:l,throttle:u,wrapNum:c,falseFn:f,formatNum:g,trim:v,splitWords:x,setOptions:_,getParamString:S,template:k,isArray:E,indexOf:T,emptyImageUrl:R,requestFn:I,cancelFn:V,requestAnimFrame:$,cancelAnimFrame:Z};function W(){}W.extend=function(h){var w=function(){_(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},P=w.__super__=this.prototype,U=a(P);U.constructor=w,w.prototype=U;for(var J in this)Object.prototype.hasOwnProperty.call(this,J)&&J!=="prototype"&&J!=="__super__"&&(w[J]=this[J]);return h.statics&&i(w,h.statics),h.includes&&(F(h.includes),i.apply(null,[U].concat(h.includes))),i(U,h),delete U.statics,delete U.includes,U.options&&(U.options=P.options?a(P.options):{},i(U.options,h.options)),U._initHooks=[],U.callInitHooks=function(){if(!this._initHooksCalled){P.callInitHooks&&P.callInitHooks.call(this),this._initHooksCalled=!0;for(var le=0,we=U._initHooks.length;le<we;le++)U._initHooks[le].call(this)}},w},W.include=function(h){var w=this.prototype.options;return i(this.prototype,h),h.options&&(this.prototype.options=w,this.mergeOptions(h.options)),this},W.mergeOptions=function(h){return i(this.prototype.options,h),this},W.addInitHook=function(h){var w=Array.prototype.slice.call(arguments,1),P=typeof h=="function"?h:function(){this[h].apply(this,w)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(P),this};function F(h){if(!(typeof L>"u"||!L||!L.Mixin)){h=E(h)?h:[h];for(var w=0;w<h.length;w++)h[w]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var K={on:function(h,w,P){if(typeof h=="object")for(var U in h)this._on(U,h[U],w);else{h=x(h);for(var J=0,le=h.length;J<le;J++)this._on(h[J],w,P)}return this},off:function(h,w,P){if(!arguments.length)delete this._events;else if(typeof h=="object")for(var U in h)this._off(U,h[U],w);else{h=x(h);for(var J=arguments.length===1,le=0,we=h.length;le<we;le++)J?this._off(h[le]):this._off(h[le],w,P)}return this},_on:function(h,w,P,U){if(typeof w!="function"){console.warn("wrong listener type: "+typeof w);return}if(this._listens(h,w,P)===!1){P===this&&(P=void 0);var J={fn:w,ctx:P};U&&(J.once=!0),this._events=this._events||{},this._events[h]=this._events[h]||[],this._events[h].push(J)}},_off:function(h,w,P){var U,J,le;if(this._events&&(U=this._events[h],!!U)){if(arguments.length===1){if(this._firingCount)for(J=0,le=U.length;J<le;J++)U[J].fn=f;delete this._events[h];return}if(typeof w!="function"){console.warn("wrong listener type: "+typeof w);return}var we=this._listens(h,w,P);if(we!==!1){var Me=U[we];this._firingCount&&(Me.fn=f,this._events[h]=U=U.slice()),U.splice(we,1)}}},fire:function(h,w,P){if(!this.listens(h,P))return this;var U=i({},w,{type:h,target:this,sourceTarget:w&&w.sourceTarget||this});if(this._events){var J=this._events[h];if(J){this._firingCount=this._firingCount+1||1;for(var le=0,we=J.length;le<we;le++){var Me=J[le],Le=Me.fn;Me.once&&this.off(h,Le,Me.ctx),Le.call(Me.ctx||this,U)}this._firingCount--}}return P&&this._propagateEvent(U),this},listens:function(h,w,P,U){typeof h!="string"&&console.warn('"string" type argument expected');var J=w;typeof w!="function"&&(U=!!w,J=void 0,P=void 0);var le=this._events&&this._events[h];if(le&&le.length&&this._listens(h,J,P)!==!1)return!0;if(U){for(var we in this._eventParents)if(this._eventParents[we].listens(h,w,P,U))return!0}return!1},_listens:function(h,w,P){if(!this._events)return!1;var U=this._events[h]||[];if(!w)return!!U.length;P===this&&(P=void 0);for(var J=0,le=U.length;J<le;J++)if(U[J].fn===w&&U[J].ctx===P)return J;return!1},once:function(h,w,P){if(typeof h=="object")for(var U in h)this._on(U,h[U],w,!0);else{h=x(h);for(var J=0,le=h.length;J<le;J++)this._on(h[J],w,P,!0)}return this},addEventParent:function(h){return this._eventParents=this._eventParents||{},this._eventParents[l(h)]=h,this},removeEventParent:function(h){return this._eventParents&&delete this._eventParents[l(h)],this},_propagateEvent:function(h){for(var w in this._eventParents)this._eventParents[w].fire(h.type,i({layer:h.target,propagatedFrom:h.target},h),!0)}};K.addEventListener=K.on,K.removeEventListener=K.clearAllEventListeners=K.off,K.addOneTimeEventListener=K.once,K.fireEvent=K.fire,K.hasEventListeners=K.listens;var X=W.extend(K);function Q(h,w,P){this.x=P?Math.round(h):h,this.y=P?Math.round(w):w}var ae=Math.trunc||function(h){return h>0?Math.floor(h):Math.ceil(h)};Q.prototype={clone:function(){return new Q(this.x,this.y)},add:function(h){return this.clone()._add(re(h))},_add:function(h){return this.x+=h.x,this.y+=h.y,this},subtract:function(h){return this.clone()._subtract(re(h))},_subtract:function(h){return this.x-=h.x,this.y-=h.y,this},divideBy:function(h){return this.clone()._divideBy(h)},_divideBy:function(h){return this.x/=h,this.y/=h,this},multiplyBy:function(h){return this.clone()._multiplyBy(h)},_multiplyBy:function(h){return this.x*=h,this.y*=h,this},scaleBy:function(h){return new Q(this.x*h.x,this.y*h.y)},unscaleBy:function(h){return new Q(this.x/h.x,this.y/h.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ae(this.x),this.y=ae(this.y),this},distanceTo:function(h){h=re(h);var w=h.x-this.x,P=h.y-this.y;return Math.sqrt(w*w+P*P)},equals:function(h){return h=re(h),h.x===this.x&&h.y===this.y},contains:function(h){return h=re(h),Math.abs(h.x)<=Math.abs(this.x)&&Math.abs(h.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function re(h,w,P){return h instanceof Q?h:E(h)?new Q(h[0],h[1]):h==null?h:typeof h=="object"&&"x"in h&&"y"in h?new Q(h.x,h.y):new Q(h,w,P)}function G(h,w){if(h)for(var P=w?[h,w]:h,U=0,J=P.length;U<J;U++)this.extend(P[U])}G.prototype={extend:function(h){var w,P;if(!h)return this;if(h instanceof Q||typeof h[0]=="number"||"x"in h)w=P=re(h);else if(h=te(h),w=h.min,P=h.max,!w||!P)return this;return!this.min&&!this.max?(this.min=w.clone(),this.max=P.clone()):(this.min.x=Math.min(w.x,this.min.x),this.max.x=Math.max(P.x,this.max.x),this.min.y=Math.min(w.y,this.min.y),this.max.y=Math.max(P.y,this.max.y)),this},getCenter:function(h){return re((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,h)},getBottomLeft:function(){return re(this.min.x,this.max.y)},getTopRight:function(){return re(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(h){var w,P;return typeof h[0]=="number"||h instanceof Q?h=re(h):h=te(h),h instanceof G?(w=h.min,P=h.max):w=P=h,w.x>=this.min.x&&P.x<=this.max.x&&w.y>=this.min.y&&P.y<=this.max.y},intersects:function(h){h=te(h);var w=this.min,P=this.max,U=h.min,J=h.max,le=J.x>=w.x&&U.x<=P.x,we=J.y>=w.y&&U.y<=P.y;return le&&we},overlaps:function(h){h=te(h);var w=this.min,P=this.max,U=h.min,J=h.max,le=J.x>w.x&&U.x<P.x,we=J.y>w.y&&U.y<P.y;return le&&we},isValid:function(){return!!(this.min&&this.max)},pad:function(h){var w=this.min,P=this.max,U=Math.abs(w.x-P.x)*h,J=Math.abs(w.y-P.y)*h;return te(re(w.x-U,w.y-J),re(P.x+U,P.y+J))},equals:function(h){return h?(h=te(h),this.min.equals(h.getTopLeft())&&this.max.equals(h.getBottomRight())):!1}};function te(h,w){return!h||h instanceof G?h:new G(h,w)}function ne(h,w){if(h)for(var P=w?[h,w]:h,U=0,J=P.length;U<J;U++)this.extend(P[U])}ne.prototype={extend:function(h){var w=this._southWest,P=this._northEast,U,J;if(h instanceof me)U=h,J=h;else if(h instanceof ne){if(U=h._southWest,J=h._northEast,!U||!J)return this}else return h?this.extend(ye(h)||de(h)):this;return!w&&!P?(this._southWest=new me(U.lat,U.lng),this._northEast=new me(J.lat,J.lng)):(w.lat=Math.min(U.lat,w.lat),w.lng=Math.min(U.lng,w.lng),P.lat=Math.max(J.lat,P.lat),P.lng=Math.max(J.lng,P.lng)),this},pad:function(h){var w=this._southWest,P=this._northEast,U=Math.abs(w.lat-P.lat)*h,J=Math.abs(w.lng-P.lng)*h;return new ne(new me(w.lat-U,w.lng-J),new me(P.lat+U,P.lng+J))},getCenter:function(){return new me((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new me(this.getNorth(),this.getWest())},getSouthEast:function(){return new me(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(h){typeof h[0]=="number"||h instanceof me||"lat"in h?h=ye(h):h=de(h);var w=this._southWest,P=this._northEast,U,J;return h instanceof ne?(U=h.getSouthWest(),J=h.getNorthEast()):U=J=h,U.lat>=w.lat&&J.lat<=P.lat&&U.lng>=w.lng&&J.lng<=P.lng},intersects:function(h){h=de(h);var w=this._southWest,P=this._northEast,U=h.getSouthWest(),J=h.getNorthEast(),le=J.lat>=w.lat&&U.lat<=P.lat,we=J.lng>=w.lng&&U.lng<=P.lng;return le&&we},overlaps:function(h){h=de(h);var w=this._southWest,P=this._northEast,U=h.getSouthWest(),J=h.getNorthEast(),le=J.lat>w.lat&&U.lat<P.lat,we=J.lng>w.lng&&U.lng<P.lng;return le&&we},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(h,w){return h?(h=de(h),this._southWest.equals(h.getSouthWest(),w)&&this._northEast.equals(h.getNorthEast(),w)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function de(h,w){return h instanceof ne?h:new ne(h,w)}function me(h,w,P){if(isNaN(h)||isNaN(w))throw new Error("Invalid LatLng object: ("+h+", "+w+")");this.lat=+h,this.lng=+w,P!==void 0&&(this.alt=+P)}me.prototype={equals:function(h,w){if(!h)return!1;h=ye(h);var P=Math.max(Math.abs(this.lat-h.lat),Math.abs(this.lng-h.lng));return P<=(w===void 0?1e-9:w)},toString:function(h){return"LatLng("+g(this.lat,h)+", "+g(this.lng,h)+")"},distanceTo:function(h){return pe.distance(this,ye(h))},wrap:function(){return pe.wrapLatLng(this)},toBounds:function(h){var w=180*h/40075017,P=w/Math.cos(Math.PI/180*this.lat);return de([this.lat-w,this.lng-P],[this.lat+w,this.lng+P])},clone:function(){return new me(this.lat,this.lng,this.alt)}};function ye(h,w,P){return h instanceof me?h:E(h)&&typeof h[0]!="object"?h.length===3?new me(h[0],h[1],h[2]):h.length===2?new me(h[0],h[1]):null:h==null?h:typeof h=="object"&&"lat"in h?new me(h.lat,"lng"in h?h.lng:h.lon,h.alt):w===void 0?null:new me(h,w,P)}var ie={latLngToPoint:function(h,w){var P=this.projection.project(h),U=this.scale(w);return this.transformation._transform(P,U)},pointToLatLng:function(h,w){var P=this.scale(w),U=this.transformation.untransform(h,P);return this.projection.unproject(U)},project:function(h){return this.projection.project(h)},unproject:function(h){return this.projection.unproject(h)},scale:function(h){return 256*Math.pow(2,h)},zoom:function(h){return Math.log(h/256)/Math.LN2},getProjectedBounds:function(h){if(this.infinite)return null;var w=this.projection.bounds,P=this.scale(h),U=this.transformation.transform(w.min,P),J=this.transformation.transform(w.max,P);return new G(U,J)},infinite:!1,wrapLatLng:function(h){var w=this.wrapLng?c(h.lng,this.wrapLng,!0):h.lng,P=this.wrapLat?c(h.lat,this.wrapLat,!0):h.lat,U=h.alt;return new me(P,w,U)},wrapLatLngBounds:function(h){var w=h.getCenter(),P=this.wrapLatLng(w),U=w.lat-P.lat,J=w.lng-P.lng;if(U===0&&J===0)return h;var le=h.getSouthWest(),we=h.getNorthEast(),Me=new me(le.lat-U,le.lng-J),Le=new me(we.lat-U,we.lng-J);return new ne(Me,Le)}},pe=i({},ie,{wrapLng:[-180,180],R:6371e3,distance:function(h,w){var P=Math.PI/180,U=h.lat*P,J=w.lat*P,le=Math.sin((w.lat-h.lat)*P/2),we=Math.sin((w.lng-h.lng)*P/2),Me=le*le+Math.cos(U)*Math.cos(J)*we*we,Le=2*Math.atan2(Math.sqrt(Me),Math.sqrt(1-Me));return this.R*Le}}),oe=6378137,fe={R:oe,MAX_LATITUDE:85.0511287798,project:function(h){var w=Math.PI/180,P=this.MAX_LATITUDE,U=Math.max(Math.min(P,h.lat),-P),J=Math.sin(U*w);return new Q(this.R*h.lng*w,this.R*Math.log((1+J)/(1-J))/2)},unproject:function(h){var w=180/Math.PI;return new me((2*Math.atan(Math.exp(h.y/this.R))-Math.PI/2)*w,h.x*w/this.R)},bounds:(function(){var h=oe*Math.PI;return new G([-h,-h],[h,h])})()};function ge(h,w,P,U){if(E(h)){this._a=h[0],this._b=h[1],this._c=h[2],this._d=h[3];return}this._a=h,this._b=w,this._c=P,this._d=U}ge.prototype={transform:function(h,w){return this._transform(h.clone(),w)},_transform:function(h,w){return w=w||1,h.x=w*(this._a*h.x+this._b),h.y=w*(this._c*h.y+this._d),h},untransform:function(h,w){return w=w||1,new Q((h.x/w-this._b)/this._a,(h.y/w-this._d)/this._c)}};function be(h,w,P,U){return new ge(h,w,P,U)}var _e=i({},pe,{code:"EPSG:3857",projection:fe,transformation:(function(){var h=.5/(Math.PI*fe.R);return be(h,.5,-h,.5)})()}),De=i({},_e,{code:"EPSG:900913"});function qe(h){return document.createElementNS("http://www.w3.org/2000/svg",h)}function Ue(h,w){var P="",U,J,le,we,Me,Le;for(U=0,le=h.length;U<le;U++){for(Me=h[U],J=0,we=Me.length;J<we;J++)Le=Me[J],P+=(J?"L":"M")+Le.x+" "+Le.y;P+=w?yt.svg?"z":"x":""}return P||"M0 0"}var Ve=document.documentElement.style,Je="ActiveXObject"in window,ft=Je&&!document.addEventListener,We="msLaunchUri"in navigator&&!("documentMode"in document),Ce=ur("webkit"),ze=ur("android"),Ke=ur("android 2")||ur("android 3"),et=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ht=ze&&ur("Google")&&et<537&&!("AudioNode"in window),Nt=!!window.opera,Mt=!We&&ur("chrome"),jt=ur("gecko")&&!Ce&&!Nt&&!Je,Wt=!Mt&&ur("safari"),xt=ur("phantom"),st="OTransition"in Ve,Ge=navigator.platform.indexOf("Win")===0,ue=Je&&"transition"in Ve,ve="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ke,ke="MozPerspective"in Ve,Ne=!window.L_DISABLE_3D&&(ue||ve||ke)&&!st&&!xt,je=typeof orientation<"u"||ur("mobile"),Ze=je&&Ce,He=je&&ve,ut=!window.PointerEvent&&window.MSPointerEvent,lt=!!(window.PointerEvent||ut),_t="ontouchstart"in window||!!window.TouchEvent,Bt=!window.L_NO_TOUCH&&(_t||lt),zt=je&&Nt,vt=je&&jt,Ht=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,qt=(function(){var h=!1;try{var w=Object.defineProperty({},"passive",{get:function(){h=!0}});window.addEventListener("testPassiveEventSupport",f,w),window.removeEventListener("testPassiveEventSupport",f,w)}catch{}return h})(),Sr=(function(){return!!document.createElement("canvas").getContext})(),fr=!!(document.createElementNS&&qe("svg").createSVGRect),fn=!!fr&&(function(){var h=document.createElement("div");return h.innerHTML="<svg/>",(h.firstChild&&h.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Gr=!fr&&(function(){try{var h=document.createElement("div");h.innerHTML='<v:shape adj="1"/>';var w=h.firstChild;return w.style.behavior="url(#default#VML)",w&&typeof w.adj=="object"}catch{return!1}})(),qr=navigator.platform.indexOf("Mac")===0,nn=navigator.platform.indexOf("Linux")===0;function ur(h){return navigator.userAgent.toLowerCase().indexOf(h)>=0}var yt={ie:Je,ielt9:ft,edge:We,webkit:Ce,android:ze,android23:Ke,androidStock:ht,opera:Nt,chrome:Mt,gecko:jt,safari:Wt,phantom:xt,opera12:st,win:Ge,ie3d:ue,webkit3d:ve,gecko3d:ke,any3d:Ne,mobile:je,mobileWebkit:Ze,mobileWebkit3d:He,msPointer:ut,pointer:lt,touch:Bt,touchNative:_t,mobileOpera:zt,mobileGecko:vt,retina:Ht,passiveEvents:qt,canvas:Sr,svg:fr,vml:Gr,inlineSvg:fn,mac:qr,linux:nn},Lr=yt.msPointer?"MSPointerDown":"pointerdown",Yn=yt.msPointer?"MSPointerMove":"pointermove",Na=yt.msPointer?"MSPointerUp":"pointerup",Ds=yt.msPointer?"MSPointerCancel":"pointercancel",Js={touchstart:Lr,touchmove:Yn,touchend:Na,touchcancel:Ds},ui={touchstart:Xr,touchmove:fl,touchend:fl,touchcancel:fl},an={},xn=!1;function ci(h,w,P){return w==="touchstart"&&Id(),ui[w]?(P=ui[w].bind(this,P),h.addEventListener(Js[w],P,!1),P):(console.warn("wrong event specified:",w),f)}function eo(h,w,P){if(!Js[w]){console.warn("wrong event specified:",w);return}h.removeEventListener(Js[w],P,!1)}function wi(h){an[h.pointerId]=h}function su(h){an[h.pointerId]&&(an[h.pointerId]=h)}function ou(h){delete an[h.pointerId]}function Id(){xn||(document.addEventListener(Lr,wi,!0),document.addEventListener(Yn,su,!0),document.addEventListener(Na,ou,!0),document.addEventListener(Ds,ou,!0),xn=!0)}function fl(h,w){if(w.pointerType!==(w.MSPOINTER_TYPE_MOUSE||"mouse")){w.touches=[];for(var P in an)w.touches.push(an[P]);w.changedTouches=[w],h(w)}}function Xr(h,w){w.MSPOINTER_TYPE_TOUCH&&w.pointerType===w.MSPOINTER_TYPE_TOUCH&&Wr(w),fl(h,w)}function lu(h){var w={},P,U;for(U in h)P=h[U],w[U]=P&&P.bind?P.bind(h):P;return h=w,w.type="dblclick",w.detail=2,w.isTrusted=!1,w._simulated=!0,w}var Is=200;function pl(h,w){h.addEventListener("dblclick",w);var P=0,U;function J(le){if(le.detail!==1){U=le.detail;return}if(!(le.pointerType==="mouse"||le.sourceCapabilities&&!le.sourceCapabilities.firesTouchEvents)){var we=Io(le);if(!(we.some(function(Le){return Le instanceof HTMLLabelElement&&Le.attributes.for})&&!we.some(function(Le){return Le instanceof HTMLInputElement||Le instanceof HTMLSelectElement}))){var Me=Date.now();Me-P<=Is?(U++,U===2&&w(lu(le))):U=1,P=Me}}}return h.addEventListener("click",J),{dblclick:w,simDblclick:J}}function Ta(h,w){h.removeEventListener("dblclick",w.dblclick),h.removeEventListener("click",w.simDblclick)}var Lo=di(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ea=di(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ta=ea==="webkitTransition"||ea==="OTransition"?ea+"End":"transitionend";function pn(h){return typeof h=="string"?document.getElementById(h):h}function vr(h,w){var P=h.style[w]||h.currentStyle&&h.currentStyle[w];if((!P||P==="auto")&&document.defaultView){var U=document.defaultView.getComputedStyle(h,null);P=U?U[w]:null}return P==="auto"?null:P}function ot(h,w,P){var U=document.createElement(h);return U.className=w||"",P&&P.appendChild(U),U}function cr(h){var w=h.parentNode;w&&w.removeChild(h)}function sn(h){for(;h.firstChild;)h.removeChild(h.firstChild)}function zr(h){var w=h.parentNode;w&&w.lastChild!==h&&w.appendChild(h)}function Nr(h){var w=h.parentNode;w&&w.firstChild!==h&&w.insertBefore(h,w.firstChild)}function ra(h,w){if(h.classList!==void 0)return h.classList.contains(w);var P=uu(h);return P.length>0&&new RegExp("(^|\\s)"+w+"(\\s|$)").test(P)}function Tt(h,w){if(h.classList!==void 0)for(var P=x(w),U=0,J=P.length;U<J;U++)h.classList.add(P[U]);else if(!ra(h,w)){var le=uu(h);Ju(h,(le?le+" ":"")+w)}}function yr(h,w){h.classList!==void 0?h.classList.remove(w):Ju(h,v((" "+uu(h)+" ").replace(" "+w+" "," ")))}function Ju(h,w){h.className.baseVal===void 0?h.className=w:h.className.baseVal=w}function uu(h){return h.correspondingElement&&(h=h.correspondingElement),h.className.baseVal===void 0?h.className:h.className.baseVal}function Xn(h,w){"opacity"in h.style?h.style.opacity=w:"filter"in h.style&&Bd(h,w)}function Bd(h,w){var P=!1,U="DXImageTransform.Microsoft.Alpha";try{P=h.filters.item(U)}catch{if(w===1)return}w=Math.round(w*100),P?(P.Enabled=w!==100,P.Opacity=w):h.style.filter+=" progid:"+U+"(opacity="+w+")"}function di(h){for(var w=document.documentElement.style,P=0;P<h.length;P++)if(h[P]in w)return h[P];return!1}function $a(h,w,P){var U=w||new Q(0,0);h.style[Lo]=(yt.ie3d?"translate("+U.x+"px,"+U.y+"px)":"translate3d("+U.x+"px,"+U.y+"px,0)")+(P?" scale("+P+")":"")}function bn(h,w){h._leaflet_pos=w,yt.any3d?$a(h,w):(h.style.left=w.x+"px",h.style.top=w.y+"px")}function Bs(h){return h._leaflet_pos||new Q(0,0)}var rr,zs,to;if("onselectstart"in document)rr=function(){Gt(window,"selectstart",Wr)},zs=function(){Tr(window,"selectstart",Wr)};else{var fs=di(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);rr=function(){if(fs){var h=document.documentElement.style;to=h[fs],h[fs]="none"}},zs=function(){fs&&(document.documentElement.style[fs]=to,to=void 0)}}function ec(){Gt(window,"dragstart",Wr)}function tc(){Tr(window,"dragstart",Wr)}var Oo,ml;function ro(h){for(;h.tabIndex===-1;)h=h.parentNode;h.style&&(_i(),Oo=h,ml=h.style.outlineStyle,h.style.outlineStyle="none",Gt(window,"keydown",_i))}function _i(){Oo&&(Oo.style.outlineStyle=ml,Oo=void 0,ml=void 0,Tr(window,"keydown",_i))}function Fs(h){do h=h.parentNode;while((!h.offsetWidth||!h.offsetHeight)&&h!==document.body);return h}function Pa(h){var w=h.getBoundingClientRect();return{x:w.width/h.offsetWidth||1,y:w.height/h.offsetHeight||1,boundingClientRect:w}}var nr={__proto__:null,TRANSFORM:Lo,TRANSITION:ea,TRANSITION_END:ta,get:pn,getStyle:vr,create:ot,remove:cr,empty:sn,toFront:zr,toBack:Nr,hasClass:ra,addClass:Tt,removeClass:yr,setClass:Ju,getClass:uu,setOpacity:Xn,testProp:di,setTransform:$a,setPosition:bn,getPosition:Bs,get disableTextSelection(){return rr},get enableTextSelection(){return zs},disableImageDrag:ec,enableImageDrag:tc,preventOutline:ro,restoreOutline:_i,getSizedParentNode:Fs,getScale:Pa};function Gt(h,w,P,U){if(w&&typeof w=="object")for(var J in w)wn(h,J,w[J],P);else{w=x(w);for(var le=0,we=w.length;le<we;le++)wn(h,w[le],P,U)}return this}var On="_leaflet_events";function Tr(h,w,P,U){if(arguments.length===1)zd(h),delete h[On];else if(w&&typeof w=="object")for(var J in w)gl(h,J,w[J],P);else if(w=x(w),arguments.length===2)zd(h,function(Me){return T(w,Me)!==-1});else for(var le=0,we=w.length;le<we;le++)gl(h,w[le],P,U);return this}function zd(h,w){for(var P in h[On]){var U=P.split(/\d/)[0];(!w||w(U))&&gl(h,U,null,null,P)}}var Do={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function wn(h,w,P,U){var J=w+l(P)+(U?"_"+l(U):"");if(h[On]&&h[On][J])return this;var le=function(Me){return P.call(U||h,Me||window.event)},we=le;!yt.touchNative&&yt.pointer&&w.indexOf("touch")===0?le=ci(h,w,le):yt.touch&&w==="dblclick"?le=pl(h,le):"addEventListener"in h?w==="touchstart"||w==="touchmove"||w==="wheel"||w==="mousewheel"?h.addEventListener(Do[w]||w,le,yt.passiveEvents?{passive:!1}:!1):w==="mouseenter"||w==="mouseleave"?(le=function(Me){Me=Me||window.event,no(h,Me)&&we(Me)},h.addEventListener(Do[w],le,!1)):h.addEventListener(w,we,!1):h.attachEvent("on"+w,le),h[On]=h[On]||{},h[On][J]=le}function gl(h,w,P,U,J){J=J||w+l(P)+(U?"_"+l(U):"");var le=h[On]&&h[On][J];if(!le)return this;!yt.touchNative&&yt.pointer&&w.indexOf("touch")===0?eo(h,w,le):yt.touch&&w==="dblclick"?Ta(h,le):"removeEventListener"in h?h.removeEventListener(Do[w]||w,le,!1):h.detachEvent("on"+w,le),h[On][J]=null}function ps(h){return h.stopPropagation?h.stopPropagation():h.originalEvent?h.originalEvent._stopped=!0:h.cancelBubble=!0,this}function vl(h){return wn(h,"wheel",ps),this}function cu(h){return Gt(h,"mousedown touchstart dblclick contextmenu",ps),h._leaflet_disable_click=!0,this}function Wr(h){return h.preventDefault?h.preventDefault():h.returnValue=!1,this}function _n(h){return Wr(h),ps(h),this}function Io(h){if(h.composedPath)return h.composedPath();for(var w=[],P=h.target;P;)w.push(P),P=P.parentNode;return w}function du(h,w){if(!w)return new Q(h.clientX,h.clientY);var P=Pa(w),U=P.boundingClientRect;return new Q((h.clientX-U.left)/P.x-w.clientLeft,(h.clientY-U.top)/P.y-w.clientTop)}var Ka=yt.linux&&yt.chrome?window.devicePixelRatio:yt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function ms(h){return yt.edge?h.wheelDeltaY/2:h.deltaY&&h.deltaMode===0?-h.deltaY/Ka:h.deltaY&&h.deltaMode===1?-h.deltaY*20:h.deltaY&&h.deltaMode===2?-h.deltaY*60:h.deltaX||h.deltaZ?0:h.wheelDelta?(h.wheelDeltaY||h.wheelDelta)/2:h.detail&&Math.abs(h.detail)<32765?-h.detail*20:h.detail?h.detail/-32765*60:0}function no(h,w){var P=w.relatedTarget;if(!P)return!0;try{for(;P&&P!==h;)P=P.parentNode}catch{return!1}return P!==h}var yl={__proto__:null,on:Gt,off:Tr,stopPropagation:ps,disableScrollPropagation:vl,disableClickPropagation:cu,preventDefault:Wr,stop:_n,getPropagationPath:Io,getMousePosition:du,getWheelDelta:ms,isExternalTarget:no,addListener:Gt,removeListener:Tr},hu=X.extend({run:function(h,w,P,U){this.stop(),this._el=h,this._inProgress=!0,this._duration=P||.25,this._easeOutPower=1/Math.max(U||.5,.2),this._startPos=Bs(h),this._offset=w.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=$(this._animate,this),this._step()},_step:function(h){var w=+new Date-this._startTime,P=this._duration*1e3;w<P?this._runFrame(this._easeOut(w/P),h):(this._runFrame(1),this._complete())},_runFrame:function(h,w){var P=this._startPos.add(this._offset.multiplyBy(h));w&&P._round(),bn(this._el,P),this.fire("step")},_complete:function(){Z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(h){return 1-Math.pow(1-h,this._easeOutPower)}}),sr=X.extend({options:{crs:_e,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(h,w){w=_(this,w),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(h),this._initLayout(),this._onResize=s(this._onResize,this),this._initEvents(),w.maxBounds&&this.setMaxBounds(w.maxBounds),w.zoom!==void 0&&(this._zoom=this._limitZoom(w.zoom)),w.center&&w.zoom!==void 0&&this.setView(ye(w.center),w.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ea&&yt.any3d&&!yt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Gt(this._proxy,ta,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(h,w,P){if(w=w===void 0?this._zoom:this._limitZoom(w),h=this._limitCenter(ye(h),w,this.options.maxBounds),P=P||{},this._stop(),this._loaded&&!P.reset&&P!==!0){P.animate!==void 0&&(P.zoom=i({animate:P.animate},P.zoom),P.pan=i({animate:P.animate,duration:P.duration},P.pan));var U=this._zoom!==w?this._tryAnimatedZoom&&this._tryAnimatedZoom(h,w,P.zoom):this._tryAnimatedPan(h,P.pan);if(U)return clearTimeout(this._sizeTimer),this}return this._resetView(h,w,P.pan&&P.pan.noMoveStart),this},setZoom:function(h,w){return this._loaded?this.setView(this.getCenter(),h,{zoom:w}):(this._zoom=h,this)},zoomIn:function(h,w){return h=h||(yt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+h,w)},zoomOut:function(h,w){return h=h||(yt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-h,w)},setZoomAround:function(h,w,P){var U=this.getZoomScale(w),J=this.getSize().divideBy(2),le=h instanceof Q?h:this.latLngToContainerPoint(h),we=le.subtract(J).multiplyBy(1-1/U),Me=this.containerPointToLatLng(J.add(we));return this.setView(Me,w,{zoom:P})},_getBoundsCenterZoom:function(h,w){w=w||{},h=h.getBounds?h.getBounds():de(h);var P=re(w.paddingTopLeft||w.padding||[0,0]),U=re(w.paddingBottomRight||w.padding||[0,0]),J=this.getBoundsZoom(h,!1,P.add(U));if(J=typeof w.maxZoom=="number"?Math.min(w.maxZoom,J):J,J===1/0)return{center:h.getCenter(),zoom:J};var le=U.subtract(P).divideBy(2),we=this.project(h.getSouthWest(),J),Me=this.project(h.getNorthEast(),J),Le=this.unproject(we.add(Me).divideBy(2).add(le),J);return{center:Le,zoom:J}},fitBounds:function(h,w){if(h=de(h),!h.isValid())throw new Error("Bounds are not valid.");var P=this._getBoundsCenterZoom(h,w);return this.setView(P.center,P.zoom,w)},fitWorld:function(h){return this.fitBounds([[-90,-180],[90,180]],h)},panTo:function(h,w){return this.setView(h,this._zoom,{pan:w})},panBy:function(h,w){if(h=re(h).round(),w=w||{},!h.x&&!h.y)return this.fire("moveend");if(w.animate!==!0&&!this.getSize().contains(h))return this._resetView(this.unproject(this.project(this.getCenter()).add(h)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new hu,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),w.noMoveStart||this.fire("movestart"),w.animate!==!1){Tt(this._mapPane,"leaflet-pan-anim");var P=this._getMapPanePos().subtract(h).round();this._panAnim.run(this._mapPane,P,w.duration||.25,w.easeLinearity)}else this._rawPanBy(h),this.fire("move").fire("moveend");return this},flyTo:function(h,w,P){if(P=P||{},P.animate===!1||!yt.any3d)return this.setView(h,w,P);this._stop();var U=this.project(this.getCenter()),J=this.project(h),le=this.getSize(),we=this._zoom;h=ye(h),w=w===void 0?we:w;var Me=Math.max(le.x,le.y),Le=Me*this.getZoomScale(we,w),$e=J.distanceTo(U)||1,pt=1.42,Dt=pt*pt;function Xt(xr){var Zo=xr?-1:1,af=xr?Le:Me,sf=Le*Le-Me*Me+Zo*Dt*Dt*$e*$e,co=2*af*Dt*$e,Yo=sf/co,Nn=Math.sqrt(Yo*Yo+1)-Yo,Vn=Nn<1e-9?-18:Math.log(Nn);return Vn}function Mr(xr){return(Math.exp(xr)-Math.exp(-xr))/2}function En(xr){return(Math.exp(xr)+Math.exp(-xr))/2}function pi(xr){return Mr(xr)/En(xr)}var ki=Xt(0);function $o(xr){return Me*(En(ki)/En(ki+pt*xr))}function gc(xr){return Me*(En(ki)*pi(ki+pt*xr)-Mr(ki))/Dt}function bs(xr){return 1-Math.pow(1-xr,1.5)}var Ko=Date.now(),Gs=(Xt(1)-ki)/pt,Da=P.duration?1e3*P.duration:1e3*Gs*.8;function Al(){var xr=(Date.now()-Ko)/Da,Zo=bs(xr)*Gs;xr<=1?(this._flyToFrame=$(Al,this),this._move(this.unproject(U.add(J.subtract(U).multiplyBy(gc(Zo)/$e)),we),this.getScaleZoom(Me/$o(Zo),we),{flyTo:!0})):this._move(h,w)._moveEnd(!0)}return this._moveStart(!0,P.noMoveStart),Al.call(this),this},flyToBounds:function(h,w){var P=this._getBoundsCenterZoom(h,w);return this.flyTo(P.center,P.zoom,w)},setMaxBounds:function(h){return h=de(h),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),h.isValid()?(this.options.maxBounds=h,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(h){var w=this.options.minZoom;return this.options.minZoom=h,this._loaded&&w!==h&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(h):this},setMaxZoom:function(h){var w=this.options.maxZoom;return this.options.maxZoom=h,this._loaded&&w!==h&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(h):this},panInsideBounds:function(h,w){this._enforcingBounds=!0;var P=this.getCenter(),U=this._limitCenter(P,this._zoom,de(h));return P.equals(U)||this.panTo(U,w),this._enforcingBounds=!1,this},panInside:function(h,w){w=w||{};var P=re(w.paddingTopLeft||w.padding||[0,0]),U=re(w.paddingBottomRight||w.padding||[0,0]),J=this.project(this.getCenter()),le=this.project(h),we=this.getPixelBounds(),Me=te([we.min.add(P),we.max.subtract(U)]),Le=Me.getSize();if(!Me.contains(le)){this._enforcingBounds=!0;var $e=le.subtract(Me.getCenter()),pt=Me.extend(le).getSize().subtract(Le);J.x+=$e.x<0?-pt.x:pt.x,J.y+=$e.y<0?-pt.y:pt.y,this.panTo(this.unproject(J),w),this._enforcingBounds=!1}return this},invalidateSize:function(h){if(!this._loaded)return this;h=i({animate:!1,pan:!0},h===!0?{animate:!0}:h);var w=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var P=this.getSize(),U=w.divideBy(2).round(),J=P.divideBy(2).round(),le=U.subtract(J);return!le.x&&!le.y?this:(h.animate&&h.pan?this.panBy(le):(h.pan&&this._rawPanBy(le),this.fire("move"),h.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(s(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:w,newSize:P}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(h){if(h=this._locateOptions=i({timeout:1e4,watch:!1},h),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var w=s(this._handleGeolocationResponse,this),P=s(this._handleGeolocationError,this);return h.watch?this._locationWatchId=navigator.geolocation.watchPosition(w,P,h):navigator.geolocation.getCurrentPosition(w,P,h),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(h){if(this._container._leaflet_id){var w=h.code,P=h.message||(w===1?"permission denied":w===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:w,message:"Geolocation error: "+P+"."})}},_handleGeolocationResponse:function(h){if(this._container._leaflet_id){var w=h.coords.latitude,P=h.coords.longitude,U=new me(w,P),J=U.toBounds(h.coords.accuracy*2),le=this._locateOptions;if(le.setView){var we=this.getBoundsZoom(J);this.setView(U,le.maxZoom?Math.min(we,le.maxZoom):we)}var Me={latlng:U,bounds:J,timestamp:h.timestamp};for(var Le in h.coords)typeof h.coords[Le]=="number"&&(Me[Le]=h.coords[Le]);this.fire("locationfound",Me)}},addHandler:function(h,w){if(!w)return this;var P=this[h]=new w(this);return this._handlers.push(P),this.options[h]&&P.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),cr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var h;for(h in this._layers)this._layers[h].remove();for(h in this._panes)cr(this._panes[h]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(h,w){var P="leaflet-pane"+(h?" leaflet-"+h.replace("Pane","")+"-pane":""),U=ot("div",P,w||this._mapPane);return h&&(this._panes[h]=U),U},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var h=this.getPixelBounds(),w=this.unproject(h.getBottomLeft()),P=this.unproject(h.getTopRight());return new ne(w,P)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(h,w,P){h=de(h),P=re(P||[0,0]);var U=this.getZoom()||0,J=this.getMinZoom(),le=this.getMaxZoom(),we=h.getNorthWest(),Me=h.getSouthEast(),Le=this.getSize().subtract(P),$e=te(this.project(Me,U),this.project(we,U)).getSize(),pt=yt.any3d?this.options.zoomSnap:1,Dt=Le.x/$e.x,Xt=Le.y/$e.y,Mr=w?Math.max(Dt,Xt):Math.min(Dt,Xt);return U=this.getScaleZoom(Mr,U),pt&&(U=Math.round(U/(pt/100))*(pt/100),U=w?Math.ceil(U/pt)*pt:Math.floor(U/pt)*pt),Math.max(J,Math.min(le,U))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(h,w){var P=this._getTopLeftPoint(h,w);return new G(P,P.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(h){return this.options.crs.getProjectedBounds(h===void 0?this.getZoom():h)},getPane:function(h){return typeof h=="string"?this._panes[h]:h},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(h,w){var P=this.options.crs;return w=w===void 0?this._zoom:w,P.scale(h)/P.scale(w)},getScaleZoom:function(h,w){var P=this.options.crs;w=w===void 0?this._zoom:w;var U=P.zoom(h*P.scale(w));return isNaN(U)?1/0:U},project:function(h,w){return w=w===void 0?this._zoom:w,this.options.crs.latLngToPoint(ye(h),w)},unproject:function(h,w){return w=w===void 0?this._zoom:w,this.options.crs.pointToLatLng(re(h),w)},layerPointToLatLng:function(h){var w=re(h).add(this.getPixelOrigin());return this.unproject(w)},latLngToLayerPoint:function(h){var w=this.project(ye(h))._round();return w._subtract(this.getPixelOrigin())},wrapLatLng:function(h){return this.options.crs.wrapLatLng(ye(h))},wrapLatLngBounds:function(h){return this.options.crs.wrapLatLngBounds(de(h))},distance:function(h,w){return this.options.crs.distance(ye(h),ye(w))},containerPointToLayerPoint:function(h){return re(h).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(h){return re(h).add(this._getMapPanePos())},containerPointToLatLng:function(h){var w=this.containerPointToLayerPoint(re(h));return this.layerPointToLatLng(w)},latLngToContainerPoint:function(h){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ye(h)))},mouseEventToContainerPoint:function(h){return du(h,this._container)},mouseEventToLayerPoint:function(h){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(h))},mouseEventToLatLng:function(h){return this.layerPointToLatLng(this.mouseEventToLayerPoint(h))},_initContainer:function(h){var w=this._container=pn(h);if(w){if(w._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Gt(w,"scroll",this._onScroll,this),this._containerId=l(w)},_initLayout:function(){var h=this._container;this._fadeAnimated=this.options.fadeAnimation&&yt.any3d,Tt(h,"leaflet-container"+(yt.touch?" leaflet-touch":"")+(yt.retina?" leaflet-retina":"")+(yt.ielt9?" leaflet-oldie":"")+(yt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var w=vr(h,"position");w!=="absolute"&&w!=="relative"&&w!=="fixed"&&w!=="sticky"&&(h.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var h=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),bn(this._mapPane,new Q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Tt(h.markerPane,"leaflet-zoom-hide"),Tt(h.shadowPane,"leaflet-zoom-hide"))},_resetView:function(h,w,P){bn(this._mapPane,new Q(0,0));var U=!this._loaded;this._loaded=!0,w=this._limitZoom(w),this.fire("viewprereset");var J=this._zoom!==w;this._moveStart(J,P)._move(h,w)._moveEnd(J),this.fire("viewreset"),U&&this.fire("load")},_moveStart:function(h,w){return h&&this.fire("zoomstart"),w||this.fire("movestart"),this},_move:function(h,w,P,U){w===void 0&&(w=this._zoom);var J=this._zoom!==w;return this._zoom=w,this._lastCenter=h,this._pixelOrigin=this._getNewPixelOrigin(h),U?P&&P.pinch&&this.fire("zoom",P):((J||P&&P.pinch)&&this.fire("zoom",P),this.fire("move",P)),this},_moveEnd:function(h){return h&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(h){bn(this._mapPane,this._getMapPanePos().subtract(h))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(h){this._targets={},this._targets[l(this._container)]=this;var w=h?Tr:Gt;w(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&w(window,"resize",this._onResize,this),yt.any3d&&this.options.transform3DLimit&&(h?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Z(this._resizeRequest),this._resizeRequest=$(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var h=this._getMapPanePos();Math.max(Math.abs(h.x),Math.abs(h.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(h,w){for(var P=[],U,J=w==="mouseout"||w==="mouseover",le=h.target||h.srcElement,we=!1;le;){if(U=this._targets[l(le)],U&&(w==="click"||w==="preclick")&&this._draggableMoved(U)){we=!0;break}if(U&&U.listens(w,!0)&&(J&&!no(le,h)||(P.push(U),J))||le===this._container)break;le=le.parentNode}return!P.length&&!we&&!J&&this.listens(w,!0)&&(P=[this]),P},_isClickDisabled:function(h){for(;h&&h!==this._container;){if(h._leaflet_disable_click)return!0;h=h.parentNode}},_handleDOMEvent:function(h){var w=h.target||h.srcElement;if(!(!this._loaded||w._leaflet_disable_events||h.type==="click"&&this._isClickDisabled(w))){var P=h.type;P==="mousedown"&&ro(w),this._fireDOMEvent(h,P)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(h,w,P){if(h.type==="click"){var U=i({},h);U.type="preclick",this._fireDOMEvent(U,U.type,P)}var J=this._findEventTargets(h,w);if(P){for(var le=[],we=0;we<P.length;we++)P[we].listens(w,!0)&&le.push(P[we]);J=le.concat(J)}if(J.length){w==="contextmenu"&&Wr(h);var Me=J[0],Le={originalEvent:h};if(h.type!=="keypress"&&h.type!=="keydown"&&h.type!=="keyup"){var $e=Me.getLatLng&&(!Me._radius||Me._radius<=10);Le.containerPoint=$e?this.latLngToContainerPoint(Me.getLatLng()):this.mouseEventToContainerPoint(h),Le.layerPoint=this.containerPointToLayerPoint(Le.containerPoint),Le.latlng=$e?Me.getLatLng():this.layerPointToLatLng(Le.layerPoint)}for(we=0;we<J.length;we++)if(J[we].fire(w,Le,!0),Le.originalEvent._stopped||J[we].options.bubblingMouseEvents===!1&&T(this._mouseEvents,w)!==-1)return}},_draggableMoved:function(h){return h=h.dragging&&h.dragging.enabled()?h:this,h.dragging&&h.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var h=0,w=this._handlers.length;h<w;h++)this._handlers[h].disable()},whenReady:function(h,w){return this._loaded?h.call(w||this,{target:this}):this.on("load",h,w),this},_getMapPanePos:function(){return Bs(this._mapPane)||new Q(0,0)},_moved:function(){var h=this._getMapPanePos();return h&&!h.equals([0,0])},_getTopLeftPoint:function(h,w){var P=h&&w!==void 0?this._getNewPixelOrigin(h,w):this.getPixelOrigin();return P.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(h,w){var P=this.getSize()._divideBy(2);return this.project(h,w)._subtract(P)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(h,w,P){var U=this._getNewPixelOrigin(P,w);return this.project(h,w)._subtract(U)},_latLngBoundsToNewLayerBounds:function(h,w,P){var U=this._getNewPixelOrigin(P,w);return te([this.project(h.getSouthWest(),w)._subtract(U),this.project(h.getNorthWest(),w)._subtract(U),this.project(h.getSouthEast(),w)._subtract(U),this.project(h.getNorthEast(),w)._subtract(U)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(h){return this.latLngToLayerPoint(h).subtract(this._getCenterLayerPoint())},_limitCenter:function(h,w,P){if(!P)return h;var U=this.project(h,w),J=this.getSize().divideBy(2),le=new G(U.subtract(J),U.add(J)),we=this._getBoundsOffset(le,P,w);return Math.abs(we.x)<=1&&Math.abs(we.y)<=1?h:this.unproject(U.add(we),w)},_limitOffset:function(h,w){if(!w)return h;var P=this.getPixelBounds(),U=new G(P.min.add(h),P.max.add(h));return h.add(this._getBoundsOffset(U,w))},_getBoundsOffset:function(h,w,P){var U=te(this.project(w.getNorthEast(),P),this.project(w.getSouthWest(),P)),J=U.min.subtract(h.min),le=U.max.subtract(h.max),we=this._rebound(J.x,-le.x),Me=this._rebound(J.y,-le.y);return new Q(we,Me)},_rebound:function(h,w){return h+w>0?Math.round(h-w)/2:Math.max(0,Math.ceil(h))-Math.max(0,Math.floor(w))},_limitZoom:function(h){var w=this.getMinZoom(),P=this.getMaxZoom(),U=yt.any3d?this.options.zoomSnap:1;return U&&(h=Math.round(h/U)*U),Math.max(w,Math.min(P,h))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){yr(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(h,w){var P=this._getCenterOffset(h)._trunc();return(w&&w.animate)!==!0&&!this.getSize().contains(P)?!1:(this.panBy(P,w),!0)},_createAnimProxy:function(){var h=this._proxy=ot("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(h),this.on("zoomanim",function(w){var P=Lo,U=this._proxy.style[P];$a(this._proxy,this.project(w.center,w.zoom),this.getZoomScale(w.zoom,1)),U===this._proxy.style[P]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){cr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var h=this.getCenter(),w=this.getZoom();$a(this._proxy,this.project(h,w),this.getZoomScale(w,1))},_catchTransitionEnd:function(h){this._animatingZoom&&h.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(h,w,P){if(this._animatingZoom)return!0;if(P=P||{},!this._zoomAnimated||P.animate===!1||this._nothingToAnimate()||Math.abs(w-this._zoom)>this.options.zoomAnimationThreshold)return!1;var U=this.getZoomScale(w),J=this._getCenterOffset(h)._divideBy(1-1/U);return P.animate!==!0&&!this.getSize().contains(J)?!1:($(function(){this._moveStart(!0,P.noMoveStart||!1)._animateZoom(h,w,!0)},this),!0)},_animateZoom:function(h,w,P,U){this._mapPane&&(P&&(this._animatingZoom=!0,this._animateToCenter=h,this._animateToZoom=w,Tt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:h,zoom:w,noUpdate:U}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(s(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&yr(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Qn(h,w){return new sr(h,w)}var zn=W.extend({options:{position:"topright"},initialize:function(h){_(this,h)},getPosition:function(){return this.options.position},setPosition:function(h){var w=this._map;return w&&w.removeControl(this),this.options.position=h,w&&w.addControl(this),this},getContainer:function(){return this._container},addTo:function(h){this.remove(),this._map=h;var w=this._container=this.onAdd(h),P=this.getPosition(),U=h._controlCorners[P];return Tt(w,"leaflet-control"),P.indexOf("bottom")!==-1?U.insertBefore(w,U.firstChild):U.appendChild(w),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(cr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(h){this._map&&h&&h.screenX>0&&h.screenY>0&&this._map.getContainer().focus()}}),na=function(h){return new zn(h)};sr.include({addControl:function(h){return h.addTo(this),this},removeControl:function(h){return h.remove(),this},_initControlPos:function(){var h=this._controlCorners={},w="leaflet-",P=this._controlContainer=ot("div",w+"control-container",this._container);function U(J,le){var we=w+J+" "+w+le;h[J+le]=ot("div",we,P)}U("top","left"),U("top","right"),U("bottom","left"),U("bottom","right")},_clearControlPos:function(){for(var h in this._controlCorners)cr(this._controlCorners[h]);cr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var xl=zn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(h,w,P,U){return P<U?-1:U<P?1:0}},initialize:function(h,w,P){_(this,P),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var U in h)this._addLayer(h[U],U);for(U in w)this._addLayer(w[U],U,!0)},onAdd:function(h){this._initLayout(),this._update(),this._map=h,h.on("zoomend",this._checkDisabledLayers,this);for(var w=0;w<this._layers.length;w++)this._layers[w].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(h){return zn.prototype.addTo.call(this,h),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(h,w){return this._addLayer(h,w),this._map?this._update():this},addOverlay:function(h,w){return this._addLayer(h,w,!0),this._map?this._update():this},removeLayer:function(h){h.off("add remove",this._onLayerChange,this);var w=this._getLayer(l(h));return w&&this._layers.splice(this._layers.indexOf(w),1),this._map?this._update():this},expand:function(){Tt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var h=this._map.getSize().y-(this._container.offsetTop+50);return h<this._section.clientHeight?(Tt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=h+"px"):yr(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return yr(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var h="leaflet-control-layers",w=this._container=ot("div",h),P=this.options.collapsed;w.setAttribute("aria-haspopup",!0),cu(w),vl(w);var U=this._section=ot("section",h+"-list");P&&(this._map.on("click",this.collapse,this),Gt(w,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var J=this._layersLink=ot("a",h+"-toggle",w);J.href="#",J.title="Layers",J.setAttribute("role","button"),Gt(J,{keydown:function(le){le.keyCode===13&&this._expandSafely()},click:function(le){Wr(le),this._expandSafely()}},this),P||this.expand(),this._baseLayersList=ot("div",h+"-base",U),this._separator=ot("div",h+"-separator",U),this._overlaysList=ot("div",h+"-overlays",U),w.appendChild(U)},_getLayer:function(h){for(var w=0;w<this._layers.length;w++)if(this._layers[w]&&l(this._layers[w].layer)===h)return this._layers[w]},_addLayer:function(h,w,P){this._map&&h.on("add remove",this._onLayerChange,this),this._layers.push({layer:h,name:w,overlay:P}),this.options.sortLayers&&this._layers.sort(s(function(U,J){return this.options.sortFunction(U.layer,J.layer,U.name,J.name)},this)),this.options.autoZIndex&&h.setZIndex&&(this._lastZIndex++,h.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;sn(this._baseLayersList),sn(this._overlaysList),this._layerControlInputs=[];var h,w,P,U,J=0;for(P=0;P<this._layers.length;P++)U=this._layers[P],this._addItem(U),w=w||U.overlay,h=h||!U.overlay,J+=U.overlay?0:1;return this.options.hideSingleBase&&(h=h&&J>1,this._baseLayersList.style.display=h?"":"none"),this._separator.style.display=w&&h?"":"none",this},_onLayerChange:function(h){this._handlingClick||this._update();var w=this._getLayer(l(h.target)),P=w.overlay?h.type==="add"?"overlayadd":"overlayremove":h.type==="add"?"baselayerchange":null;P&&this._map.fire(P,w)},_createRadioElement:function(h,w){var P='<input type="radio" class="leaflet-control-layers-selector" name="'+h+'"'+(w?' checked="checked"':"")+"/>",U=document.createElement("div");return U.innerHTML=P,U.firstChild},_addItem:function(h){var w=document.createElement("label"),P=this._map.hasLayer(h.layer),U;h.overlay?(U=document.createElement("input"),U.type="checkbox",U.className="leaflet-control-layers-selector",U.defaultChecked=P):U=this._createRadioElement("leaflet-base-layers_"+l(this),P),this._layerControlInputs.push(U),U.layerId=l(h.layer),Gt(U,"click",this._onInputClick,this);var J=document.createElement("span");J.innerHTML=" "+h.name;var le=document.createElement("span");w.appendChild(le),le.appendChild(U),le.appendChild(J);var we=h.overlay?this._overlaysList:this._baseLayersList;return we.appendChild(w),this._checkDisabledLayers(),w},_onInputClick:function(){if(!this._preventClick){var h=this._layerControlInputs,w,P,U=[],J=[];this._handlingClick=!0;for(var le=h.length-1;le>=0;le--)w=h[le],P=this._getLayer(w.layerId).layer,w.checked?U.push(P):w.checked||J.push(P);for(le=0;le<J.length;le++)this._map.hasLayer(J[le])&&this._map.removeLayer(J[le]);for(le=0;le<U.length;le++)this._map.hasLayer(U[le])||this._map.addLayer(U[le]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var h=this._layerControlInputs,w,P,U=this._map.getZoom(),J=h.length-1;J>=0;J--)w=h[J],P=this._getLayer(w.layerId).layer,w.disabled=P.options.minZoom!==void 0&&U<P.options.minZoom||P.options.maxZoom!==void 0&&U>P.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var h=this._section;this._preventClick=!0,Gt(h,"click",Wr),this.expand();var w=this;setTimeout(function(){Tr(h,"click",Wr),w._preventClick=!1})}}),Bo=function(h,w,P){return new xl(h,w,P)},Jn=zn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(h){var w="leaflet-control-zoom",P=ot("div",w+" leaflet-bar"),U=this.options;return this._zoomInButton=this._createButton(U.zoomInText,U.zoomInTitle,w+"-in",P,this._zoomIn),this._zoomOutButton=this._createButton(U.zoomOutText,U.zoomOutTitle,w+"-out",P,this._zoomOut),this._updateDisabled(),h.on("zoomend zoomlevelschange",this._updateDisabled,this),P},onRemove:function(h){h.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(h){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(h.shiftKey?3:1))},_zoomOut:function(h){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(h.shiftKey?3:1))},_createButton:function(h,w,P,U,J){var le=ot("a",P,U);return le.innerHTML=h,le.href="#",le.title=w,le.setAttribute("role","button"),le.setAttribute("aria-label",w),cu(le),Gt(le,"click",_n),Gt(le,"click",J,this),Gt(le,"click",this._refocusOnMap,this),le},_updateDisabled:function(){var h=this._map,w="leaflet-disabled";yr(this._zoomInButton,w),yr(this._zoomOutButton,w),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||h._zoom===h.getMinZoom())&&(Tt(this._zoomOutButton,w),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||h._zoom===h.getMaxZoom())&&(Tt(this._zoomInButton,w),this._zoomInButton.setAttribute("aria-disabled","true"))}});sr.mergeOptions({zoomControl:!0}),sr.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Jn,this.addControl(this.zoomControl))});var ia=function(h){return new Jn(h)},Sn=zn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(h){var w="leaflet-control-scale",P=ot("div",w),U=this.options;return this._addScales(U,w+"-line",P),h.on(U.updateWhenIdle?"moveend":"move",this._update,this),h.whenReady(this._update,this),P},onRemove:function(h){h.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(h,w,P){h.metric&&(this._mScale=ot("div",w,P)),h.imperial&&(this._iScale=ot("div",w,P))},_update:function(){var h=this._map,w=h.getSize().y/2,P=h.distance(h.containerPointToLatLng([0,w]),h.containerPointToLatLng([this.options.maxWidth,w]));this._updateScales(P)},_updateScales:function(h){this.options.metric&&h&&this._updateMetric(h),this.options.imperial&&h&&this._updateImperial(h)},_updateMetric:function(h){var w=this._getRoundNum(h),P=w<1e3?w+" m":w/1e3+" km";this._updateScale(this._mScale,P,w/h)},_updateImperial:function(h){var w=h*3.2808399,P,U,J;w>5280?(P=w/5280,U=this._getRoundNum(P),this._updateScale(this._iScale,U+" mi",U/P)):(J=this._getRoundNum(w),this._updateScale(this._iScale,J+" ft",J/w))},_updateScale:function(h,w,P){h.style.width=Math.round(this.options.maxWidth*P)+"px",h.innerHTML=w},_getRoundNum:function(h){var w=Math.pow(10,(Math.floor(h)+"").length-1),P=h/w;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:1,w*P}}),ji=function(h){return new Sn(h)},Za='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',aa=zn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(yt.inlineSvg?Za+" ":"")+"Leaflet</a>"},initialize:function(h){_(this,h),this._attributions={}},onAdd:function(h){h.attributionControl=this,this._container=ot("div","leaflet-control-attribution"),cu(this._container);for(var w in h._layers)h._layers[w].getAttribution&&this.addAttribution(h._layers[w].getAttribution());return this._update(),h.on("layeradd",this._addAttribution,this),this._container},onRemove:function(h){h.off("layeradd",this._addAttribution,this)},_addAttribution:function(h){h.layer.getAttribution&&(this.addAttribution(h.layer.getAttribution()),h.layer.once("remove",function(){this.removeAttribution(h.layer.getAttribution())},this))},setPrefix:function(h){return this.options.prefix=h,this._update(),this},addAttribution:function(h){return h?(this._attributions[h]||(this._attributions[h]=0),this._attributions[h]++,this._update(),this):this},removeAttribution:function(h){return h?(this._attributions[h]&&(this._attributions[h]--,this._update()),this):this},_update:function(){if(this._map){var h=[];for(var w in this._attributions)this._attributions[w]&&h.push(w);var P=[];this.options.prefix&&P.push(this.options.prefix),h.length&&P.push(h.join(", ")),this._container.innerHTML=P.join(' <span aria-hidden="true">|</span> ')}}});sr.mergeOptions({attributionControl:!0}),sr.addInitHook(function(){this.options.attributionControl&&new aa().addTo(this)});var Jh=function(h){return new aa(h)};zn.Layers=xl,zn.Zoom=Jn,zn.Scale=Sn,zn.Attribution=aa,na.layers=Bo,na.zoom=ia,na.scale=ji,na.attribution=Jh;var Ri=W.extend({initialize:function(h){this._map=h},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ri.addTo=function(h,w){return h.addHandler(w,this),this};var fu={Events:K},Fn=yt.touch?"touchstart mousedown":"mousedown",on=X.extend({options:{clickTolerance:3},initialize:function(h,w,P,U){_(this,U),this._element=h,this._dragStartTarget=w||h,this._preventOutline=P},enable:function(){this._enabled||(Gt(this._dragStartTarget,Fn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(on._dragging===this&&this.finishDrag(!0),Tr(this._dragStartTarget,Fn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(h){if(this._enabled&&(this._moved=!1,!ra(this._element,"leaflet-zoom-anim"))){if(h.touches&&h.touches.length!==1){on._dragging===this&&this.finishDrag();return}if(!(on._dragging||h.shiftKey||h.which!==1&&h.button!==1&&!h.touches)&&(on._dragging=this,this._preventOutline&&ro(this._element),ec(),rr(),!this._moving)){this.fire("down");var w=h.touches?h.touches[0]:h,P=Fs(this._element);this._startPoint=new Q(w.clientX,w.clientY),this._startPos=Bs(this._element),this._parentScale=Pa(P);var U=h.type==="mousedown";Gt(document,U?"mousemove":"touchmove",this._onMove,this),Gt(document,U?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(h){if(this._enabled){if(h.touches&&h.touches.length>1){this._moved=!0;return}var w=h.touches&&h.touches.length===1?h.touches[0]:h,P=new Q(w.clientX,w.clientY)._subtract(this._startPoint);!P.x&&!P.y||Math.abs(P.x)+Math.abs(P.y)<this.options.clickTolerance||(P.x/=this._parentScale.x,P.y/=this._parentScale.y,Wr(h),this._moved||(this.fire("dragstart"),this._moved=!0,Tt(document.body,"leaflet-dragging"),this._lastTarget=h.target||h.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Tt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(P),this._moving=!0,this._lastEvent=h,this._updatePosition())}},_updatePosition:function(){var h={originalEvent:this._lastEvent};this.fire("predrag",h),bn(this._element,this._newPos),this.fire("drag",h)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(h){yr(document.body,"leaflet-dragging"),this._lastTarget&&(yr(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Tr(document,"mousemove touchmove",this._onMove,this),Tr(document,"mouseup touchend touchcancel",this._onUp,this),tc(),zs();var w=this._moved&&this._moving;this._moving=!1,on._dragging=!1,w&&this.fire("dragend",{noInertia:h,distance:this._newPos.distanceTo(this._startPos)})}});function Or(h,w,P){var U,J=[1,4,2,8],le,we,Me,Le,$e,pt,Dt,Xt;for(le=0,pt=h.length;le<pt;le++)h[le]._code=gs(h[le],w);for(Me=0;Me<4;Me++){for(Dt=J[Me],U=[],le=0,pt=h.length,we=pt-1;le<pt;we=le++)Le=h[le],$e=h[we],Le._code&Dt?$e._code&Dt||(Xt=ic($e,Le,Dt,w,P),Xt._code=gs(Xt,w),U.push(Xt)):($e._code&Dt&&(Xt=ic($e,Le,Dt,w,P),Xt._code=gs(Xt,w),U.push(Xt)),U.push(Le));h=U}return h}function bl(h,w){var P,U,J,le,we,Me,Le,$e,pt;if(!h||h.length===0)throw new Error("latlngs not passed");Si(h)||(console.warn("latlngs are not flat! Only the first ring will be used"),h=h[0]);var Dt=ye([0,0]),Xt=de(h),Mr=Xt.getNorthWest().distanceTo(Xt.getSouthWest())*Xt.getNorthEast().distanceTo(Xt.getNorthWest());Mr<1700&&(Dt=sa(h));var En=h.length,pi=[];for(P=0;P<En;P++){var ki=ye(h[P]);pi.push(w.project(ye([ki.lat-Dt.lat,ki.lng-Dt.lng])))}for(Me=Le=$e=0,P=0,U=En-1;P<En;U=P++)J=pi[P],le=pi[U],we=J.y*le.x-le.y*J.x,Le+=(J.x+le.x)*we,$e+=(J.y+le.y)*we,Me+=we*3;Me===0?pt=pi[0]:pt=[Le/Me,$e/Me];var $o=w.unproject(re(pt));return ye([$o.lat+Dt.lat,$o.lng+Dt.lng])}function sa(h){for(var w=0,P=0,U=0,J=0;J<h.length;J++){var le=ye(h[J]);w+=le.lat,P+=le.lng,U++}return ye([w/U,P/U])}var ef={__proto__:null,clipPolygon:Or,polygonCenter:bl,centroid:sa};function pu(h,w){if(!w||!h.length)return h.slice();var P=w*w;return h=rf(h,P),h=tf(h,P),h}function rc(h,w,P){return Math.sqrt(Ya(h,w,P,!0))}function Fd(h,w,P){return Ya(h,w,P)}function tf(h,w){var P=h.length,U=typeof Uint8Array<"u"?Uint8Array:Array,J=new U(P);J[0]=J[P-1]=1,wl(h,J,w,0,P-1);var le,we=[];for(le=0;le<P;le++)J[le]&&we.push(h[le]);return we}function wl(h,w,P,U,J){var le=0,we,Me,Le;for(Me=U+1;Me<=J-1;Me++)Le=Ya(h[Me],h[U],h[J],!0),Le>le&&(we=Me,le=Le);le>P&&(w[we]=1,wl(h,w,P,U,we),wl(h,w,P,we,J))}function rf(h,w){for(var P=[h[0]],U=1,J=0,le=h.length;U<le;U++)Rp(h[U],h[J])>w&&(P.push(h[U]),J=U);return J<le-1&&P.push(h[le-1]),P}var io;function nc(h,w,P,U,J){var le=U?io:gs(h,P),we=gs(w,P),Me,Le,$e;for(io=we;;){if(!(le|we))return[h,w];if(le&we)return!1;Me=le||we,Le=ic(h,w,Me,P,J),$e=gs(Le,P),Me===le?(h=Le,le=$e):(w=Le,we=$e)}}function ic(h,w,P,U,J){var le=w.x-h.x,we=w.y-h.y,Me=U.min,Le=U.max,$e,pt;return P&8?($e=h.x+le*(Le.y-h.y)/we,pt=Le.y):P&4?($e=h.x+le*(Me.y-h.y)/we,pt=Me.y):P&2?($e=Le.x,pt=h.y+we*(Le.x-h.x)/le):P&1&&($e=Me.x,pt=h.y+we*(Me.x-h.x)/le),new Q($e,pt,J)}function gs(h,w){var P=0;return h.x<w.min.x?P|=1:h.x>w.max.x&&(P|=2),h.y<w.min.y?P|=4:h.y>w.max.y&&(P|=8),P}function Rp(h,w){var P=w.x-h.x,U=w.y-h.y;return P*P+U*U}function Ya(h,w,P,U){var J=w.x,le=w.y,we=P.x-J,Me=P.y-le,Le=we*we+Me*Me,$e;return Le>0&&($e=((h.x-J)*we+(h.y-le)*Me)/Le,$e>1?(J=P.x,le=P.y):$e>0&&(J+=we*$e,le+=Me*$e)),we=h.x-J,Me=h.y-le,U?we*we+Me*Me:new Q(J,le)}function Si(h){return!E(h[0])||typeof h[0][0]!="object"&&typeof h[0][0]<"u"}function Vd(h){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Si(h)}function Ud(h,w){var P,U,J,le,we,Me,Le,$e;if(!h||h.length===0)throw new Error("latlngs not passed");Si(h)||(console.warn("latlngs are not flat! Only the first ring will be used"),h=h[0]);var pt=ye([0,0]),Dt=de(h),Xt=Dt.getNorthWest().distanceTo(Dt.getSouthWest())*Dt.getNorthEast().distanceTo(Dt.getNorthWest());Xt<1700&&(pt=sa(h));var Mr=h.length,En=[];for(P=0;P<Mr;P++){var pi=ye(h[P]);En.push(w.project(ye([pi.lat-pt.lat,pi.lng-pt.lng])))}for(P=0,U=0;P<Mr-1;P++)U+=En[P].distanceTo(En[P+1])/2;if(U===0)$e=En[0];else for(P=0,le=0;P<Mr-1;P++)if(we=En[P],Me=En[P+1],J=we.distanceTo(Me),le+=J,le>U){Le=(le-U)/J,$e=[Me.x-Le*(Me.x-we.x),Me.y-Le*(Me.y-we.y)];break}var ki=w.unproject(re($e));return ye([ki.lat+pt.lat,ki.lng+pt.lng])}var zo={__proto__:null,simplify:pu,pointToSegmentDistance:rc,closestPointOnSegment:Fd,clipSegment:nc,_getEdgeIntersection:ic,_getBitCode:gs,_sqClosestPointOnSegment:Ya,isFlat:Si,_flat:Vd,polylineCenter:Ud},ac={project:function(h){return new Q(h.lng,h.lat)},unproject:function(h){return new me(h.y,h.x)},bounds:new G([-180,-90],[180,90])},_l={R:6378137,R_MINOR:6356752314245179e-9,bounds:new G([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(h){var w=Math.PI/180,P=this.R,U=h.lat*w,J=this.R_MINOR/P,le=Math.sqrt(1-J*J),we=le*Math.sin(U),Me=Math.tan(Math.PI/4-U/2)/Math.pow((1-we)/(1+we),le/2);return U=-P*Math.log(Math.max(Me,1e-10)),new Q(h.lng*w*P,U)},unproject:function(h){for(var w=180/Math.PI,P=this.R,U=this.R_MINOR/P,J=Math.sqrt(1-U*U),le=Math.exp(-h.y/P),we=Math.PI/2-2*Math.atan(le),Me=0,Le=.1,$e;Me<15&&Math.abs(Le)>1e-7;Me++)$e=J*Math.sin(we),$e=Math.pow((1-$e)/(1+$e),J/2),Le=Math.PI/2-2*Math.atan(le*$e)-we,we+=Le;return new me(we*w,h.x*w/P)}},sc={__proto__:null,LonLat:ac,Mercator:_l,SphericalMercator:fe},Sl=i({},pe,{code:"EPSG:3395",projection:_l,transformation:(function(){var h=.5/(Math.PI*_l.R);return be(h,.5,-h,.5)})()}),oc=i({},pe,{code:"EPSG:4326",projection:ac,transformation:be(1/180,1,-1/180,.5)}),Hd=i({},ie,{projection:ac,transformation:be(1,0,-1,0),scale:function(h){return Math.pow(2,h)},zoom:function(h){return Math.log(h)/Math.LN2},distance:function(h,w){var P=w.lng-h.lng,U=w.lat-h.lat;return Math.sqrt(P*P+U*U)},infinite:!0});ie.Earth=pe,ie.EPSG3395=Sl,ie.EPSG3857=_e,ie.EPSG900913=De,ie.EPSG4326=oc,ie.Simple=Hd;var Ma=X.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(h){return h.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(h){return h&&h.removeLayer(this),this},getPane:function(h){return this._map.getPane(h?this.options[h]||h:this.options.pane)},addInteractiveTarget:function(h){return this._map._targets[l(h)]=this,this},removeInteractiveTarget:function(h){return delete this._map._targets[l(h)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(h){var w=h.target;if(w.hasLayer(this)){if(this._map=w,this._zoomAnimated=w._zoomAnimated,this.getEvents){var P=this.getEvents();w.on(P,this),this.once("remove",function(){w.off(P,this)},this)}this.onAdd(w),this.fire("add"),w.fire("layeradd",{layer:this})}}});sr.include({addLayer:function(h){if(!h._layerAdd)throw new Error("The provided object is not a Layer.");var w=l(h);return this._layers[w]?this:(this._layers[w]=h,h._mapToAdd=this,h.beforeAdd&&h.beforeAdd(this),this.whenReady(h._layerAdd,h),this)},removeLayer:function(h){var w=l(h);return this._layers[w]?(this._loaded&&h.onRemove(this),delete this._layers[w],this._loaded&&(this.fire("layerremove",{layer:h}),h.fire("remove")),h._map=h._mapToAdd=null,this):this},hasLayer:function(h){return l(h)in this._layers},eachLayer:function(h,w){for(var P in this._layers)h.call(w,this._layers[P]);return this},_addLayers:function(h){h=h?E(h)?h:[h]:[];for(var w=0,P=h.length;w<P;w++)this.addLayer(h[w])},_addZoomLimit:function(h){(!isNaN(h.options.maxZoom)||!isNaN(h.options.minZoom))&&(this._zoomBoundLayers[l(h)]=h,this._updateZoomLevels())},_removeZoomLimit:function(h){var w=l(h);this._zoomBoundLayers[w]&&(delete this._zoomBoundLayers[w],this._updateZoomLevels())},_updateZoomLevels:function(){var h=1/0,w=-1/0,P=this._getZoomSpan();for(var U in this._zoomBoundLayers){var J=this._zoomBoundLayers[U].options;h=J.minZoom===void 0?h:Math.min(h,J.minZoom),w=J.maxZoom===void 0?w:Math.max(w,J.maxZoom)}this._layersMaxZoom=w===-1/0?void 0:w,this._layersMinZoom=h===1/0?void 0:h,P!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var vs=Ma.extend({initialize:function(h,w){_(this,w),this._layers={};var P,U;if(h)for(P=0,U=h.length;P<U;P++)this.addLayer(h[P])},addLayer:function(h){var w=this.getLayerId(h);return this._layers[w]=h,this._map&&this._map.addLayer(h),this},removeLayer:function(h){var w=h in this._layers?h:this.getLayerId(h);return this._map&&this._layers[w]&&this._map.removeLayer(this._layers[w]),delete this._layers[w],this},hasLayer:function(h){var w=typeof h=="number"?h:this.getLayerId(h);return w in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(h){var w=Array.prototype.slice.call(arguments,1),P,U;for(P in this._layers)U=this._layers[P],U[h]&&U[h].apply(U,w);return this},onAdd:function(h){this.eachLayer(h.addLayer,h)},onRemove:function(h){this.eachLayer(h.removeLayer,h)},eachLayer:function(h,w){for(var P in this._layers)h.call(w,this._layers[P]);return this},getLayer:function(h){return this._layers[h]},getLayers:function(){var h=[];return this.eachLayer(h.push,h),h},setZIndex:function(h){return this.invoke("setZIndex",h)},getLayerId:function(h){return l(h)}}),Fo=function(h,w){return new vs(h,w)},Li=vs.extend({addLayer:function(h){return this.hasLayer(h)?this:(h.addEventParent(this),vs.prototype.addLayer.call(this,h),this.fire("layeradd",{layer:h}))},removeLayer:function(h){return this.hasLayer(h)?(h in this._layers&&(h=this._layers[h]),h.removeEventParent(this),vs.prototype.removeLayer.call(this,h),this.fire("layerremove",{layer:h})):this},setStyle:function(h){return this.invoke("setStyle",h)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var h=new ne;for(var w in this._layers){var P=this._layers[w];h.extend(P.getBounds?P.getBounds():P.getLatLng())}return h}}),oa=function(h,w){return new Li(h,w)},la=W.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(h){_(this,h)},createIcon:function(h){return this._createIcon("icon",h)},createShadow:function(h){return this._createIcon("shadow",h)},_createIcon:function(h,w){var P=this._getIconUrl(h);if(!P){if(h==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var U=this._createImg(P,w&&w.tagName==="IMG"?w:null);return this._setIconStyles(U,h),(this.options.crossOrigin||this.options.crossOrigin==="")&&(U.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),U},_setIconStyles:function(h,w){var P=this.options,U=P[w+"Size"];typeof U=="number"&&(U=[U,U]);var J=re(U),le=re(w==="shadow"&&P.shadowAnchor||P.iconAnchor||J&&J.divideBy(2,!0));h.className="leaflet-marker-"+w+" "+(P.className||""),le&&(h.style.marginLeft=-le.x+"px",h.style.marginTop=-le.y+"px"),J&&(h.style.width=J.x+"px",h.style.height=J.y+"px")},_createImg:function(h,w){return w=w||document.createElement("img"),w.src=h,w},_getIconUrl:function(h){return yt.retina&&this.options[h+"RetinaUrl"]||this.options[h+"Url"]}});function lc(h){return new la(h)}var Vo=la.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(h){return typeof Vo.imagePath!="string"&&(Vo.imagePath=this._detectIconPath()),(this.options.imagePath||Vo.imagePath)+la.prototype._getIconUrl.call(this,h)},_stripUrl:function(h){var w=function(P,U,J){var le=U.exec(P);return le&&le[J]};return h=w(h,/^url\((['"])?(.+)\1\)$/,2),h&&w(h,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var h=ot("div","leaflet-default-icon-path",document.body),w=vr(h,"background-image")||vr(h,"backgroundImage");if(document.body.removeChild(h),w=this._stripUrl(w),w)return w;var P=document.querySelector('link[href$="leaflet.css"]');return P?P.href.substring(0,P.href.length-11-1):""}}),Aa=Ri.extend({initialize:function(h){this._marker=h},addHooks:function(){var h=this._marker._icon;this._draggable||(this._draggable=new on(h,h,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Tt(h,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&yr(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(h){var w=this._marker,P=w._map,U=this._marker.options.autoPanSpeed,J=this._marker.options.autoPanPadding,le=Bs(w._icon),we=P.getPixelBounds(),Me=P.getPixelOrigin(),Le=te(we.min._subtract(Me).add(J),we.max._subtract(Me).subtract(J));if(!Le.contains(le)){var $e=re((Math.max(Le.max.x,le.x)-Le.max.x)/(we.max.x-Le.max.x)-(Math.min(Le.min.x,le.x)-Le.min.x)/(we.min.x-Le.min.x),(Math.max(Le.max.y,le.y)-Le.max.y)/(we.max.y-Le.max.y)-(Math.min(Le.min.y,le.y)-Le.min.y)/(we.min.y-Le.min.y)).multiplyBy(U);P.panBy($e,{animate:!1}),this._draggable._newPos._add($e),this._draggable._startPos._add($e),bn(w._icon,this._draggable._newPos),this._onDrag(h),this._panRequest=$(this._adjustPan.bind(this,h))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(h){this._marker.options.autoPan&&(Z(this._panRequest),this._panRequest=$(this._adjustPan.bind(this,h)))},_onDrag:function(h){var w=this._marker,P=w._shadow,U=Bs(w._icon),J=w._map.layerPointToLatLng(U);P&&bn(P,U),w._latlng=J,h.latlng=J,h.oldLatLng=this._oldLatLng,w.fire("move",h).fire("drag",h)},_onDragEnd:function(h){Z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",h)}}),hi=Ma.extend({options:{icon:new Vo,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(h,w){_(this,w),this._latlng=ye(h)},onAdd:function(h){this._zoomAnimated=this._zoomAnimated&&h.options.markerZoomAnimation,this._zoomAnimated&&h.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(h){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&h.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(h){var w=this._latlng;return this._latlng=ye(h),this.update(),this.fire("move",{oldLatLng:w,latlng:this._latlng})},setZIndexOffset:function(h){return this.options.zIndexOffset=h,this.update()},getIcon:function(){return this.options.icon},setIcon:function(h){return this.options.icon=h,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var h=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(h)}return this},_initIcon:function(){var h=this.options,w="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),P=h.icon.createIcon(this._icon),U=!1;P!==this._icon&&(this._icon&&this._removeIcon(),U=!0,h.title&&(P.title=h.title),P.tagName==="IMG"&&(P.alt=h.alt||"")),Tt(P,w),h.keyboard&&(P.tabIndex="0",P.setAttribute("role","button")),this._icon=P,h.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Gt(P,"focus",this._panOnFocus,this);var J=h.icon.createShadow(this._shadow),le=!1;J!==this._shadow&&(this._removeShadow(),le=!0),J&&(Tt(J,w),J.alt=""),this._shadow=J,h.opacity<1&&this._updateOpacity(),U&&this.getPane().appendChild(this._icon),this._initInteraction(),J&&le&&this.getPane(h.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Tr(this._icon,"focus",this._panOnFocus,this),cr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&cr(this._shadow),this._shadow=null},_setPos:function(h){this._icon&&bn(this._icon,h),this._shadow&&bn(this._shadow,h),this._zIndex=h.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(h){this._icon&&(this._icon.style.zIndex=this._zIndex+h)},_animateZoom:function(h){var w=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center).round();this._setPos(w)},_initInteraction:function(){if(this.options.interactive&&(Tt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Aa)){var h=this.options.draggable;this.dragging&&(h=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Aa(this),h&&this.dragging.enable()}},setOpacity:function(h){return this.options.opacity=h,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var h=this.options.opacity;this._icon&&Xn(this._icon,h),this._shadow&&Xn(this._shadow,h)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var h=this._map;if(h){var w=this.options.icon.options,P=w.iconSize?re(w.iconSize):re(0,0),U=w.iconAnchor?re(w.iconAnchor):re(0,0);h.panInside(this._latlng,{paddingTopLeft:U,paddingBottomRight:P.subtract(U)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Gd(h,w){return new hi(h,w)}var Vs=Ma.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(h){this._renderer=h.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(h){return _(this,h),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&h&&Object.prototype.hasOwnProperty.call(h,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ja=Vs.extend({options:{fill:!0,radius:10},initialize:function(h,w){_(this,w),this._latlng=ye(h),this._radius=this.options.radius},setLatLng:function(h){var w=this._latlng;return this._latlng=ye(h),this.redraw(),this.fire("move",{oldLatLng:w,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(h){return this.options.radius=this._radius=h,this.redraw()},getRadius:function(){return this._radius},setStyle:function(h){var w=h&&h.radius||this._radius;return Vs.prototype.setStyle.call(this,h),this.setRadius(w),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var h=this._radius,w=this._radiusY||h,P=this._clickTolerance(),U=[h+P,w+P];this._pxBounds=new G(this._point.subtract(U),this._point.add(U))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(h){return h.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Us(h,w){return new ja(h,w)}var Uo=ja.extend({initialize:function(h,w,P){if(typeof w=="number"&&(w=i({},P,{radius:w})),_(this,w),this._latlng=ye(h),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(h){return this._mRadius=h,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var h=[this._radius,this._radiusY||this._radius];return new ne(this._map.layerPointToLatLng(this._point.subtract(h)),this._map.layerPointToLatLng(this._point.add(h)))},setStyle:Vs.prototype.setStyle,_project:function(){var h=this._latlng.lng,w=this._latlng.lat,P=this._map,U=P.options.crs;if(U.distance===pe.distance){var J=Math.PI/180,le=this._mRadius/pe.R/J,we=P.project([w+le,h]),Me=P.project([w-le,h]),Le=we.add(Me).divideBy(2),$e=P.unproject(Le).lat,pt=Math.acos((Math.cos(le*J)-Math.sin(w*J)*Math.sin($e*J))/(Math.cos(w*J)*Math.cos($e*J)))/J;(isNaN(pt)||pt===0)&&(pt=le/Math.cos(Math.PI/180*w)),this._point=Le.subtract(P.getPixelOrigin()),this._radius=isNaN(pt)?0:Le.x-P.project([$e,h-pt]).x,this._radiusY=Le.y-we.y}else{var Dt=U.unproject(U.project(this._latlng).subtract([this._mRadius,0]));this._point=P.latLngToLayerPoint(this._latlng),this._radius=this._point.x-P.latLngToLayerPoint(Dt).x}this._updateBounds()}});function kl(h,w,P){return new Uo(h,w,P)}var fi=Vs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(h,w){_(this,w),this._setLatLngs(h)},getLatLngs:function(){return this._latlngs},setLatLngs:function(h){return this._setLatLngs(h),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(h){for(var w=1/0,P=null,U=Ya,J,le,we=0,Me=this._parts.length;we<Me;we++)for(var Le=this._parts[we],$e=1,pt=Le.length;$e<pt;$e++){J=Le[$e-1],le=Le[$e];var Dt=U(h,J,le,!0);Dt<w&&(w=Dt,P=U(h,J,le))}return P&&(P.distance=Math.sqrt(w)),P},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ud(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(h,w){return w=w||this._defaultShape(),h=ye(h),w.push(h),this._bounds.extend(h),this.redraw()},_setLatLngs:function(h){this._bounds=new ne,this._latlngs=this._convertLatLngs(h)},_defaultShape:function(){return Si(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(h){for(var w=[],P=Si(h),U=0,J=h.length;U<J;U++)P?(w[U]=ye(h[U]),this._bounds.extend(w[U])):w[U]=this._convertLatLngs(h[U]);return w},_project:function(){var h=new G;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,h),this._bounds.isValid()&&h.isValid()&&(this._rawPxBounds=h,this._updateBounds())},_updateBounds:function(){var h=this._clickTolerance(),w=new Q(h,h);this._rawPxBounds&&(this._pxBounds=new G([this._rawPxBounds.min.subtract(w),this._rawPxBounds.max.add(w)]))},_projectLatlngs:function(h,w,P){var U=h[0]instanceof me,J=h.length,le,we;if(U){for(we=[],le=0;le<J;le++)we[le]=this._map.latLngToLayerPoint(h[le]),P.extend(we[le]);w.push(we)}else for(le=0;le<J;le++)this._projectLatlngs(h[le],w,P)},_clipPoints:function(){var h=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(h))){if(this.options.noClip){this._parts=this._rings;return}var w=this._parts,P,U,J,le,we,Me,Le;for(P=0,J=0,le=this._rings.length;P<le;P++)for(Le=this._rings[P],U=0,we=Le.length;U<we-1;U++)Me=nc(Le[U],Le[U+1],h,U,!0),Me&&(w[J]=w[J]||[],w[J].push(Me[0]),(Me[1]!==Le[U+1]||U===we-2)&&(w[J].push(Me[1]),J++))}},_simplifyPoints:function(){for(var h=this._parts,w=this.options.smoothFactor,P=0,U=h.length;P<U;P++)h[P]=pu(h[P],w)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(h,w){var P,U,J,le,we,Me,Le=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(h))return!1;for(P=0,le=this._parts.length;P<le;P++)for(Me=this._parts[P],U=0,we=Me.length,J=we-1;U<we;J=U++)if(!(!w&&U===0)&&rc(h,Me[J],Me[U])<=Le)return!0;return!1}});function nf(h,w){return new fi(h,w)}fi._flat=Vd;var ua=fi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return bl(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(h){var w=fi.prototype._convertLatLngs.call(this,h),P=w.length;return P>=2&&w[0]instanceof me&&w[0].equals(w[P-1])&&w.pop(),w},_setLatLngs:function(h){fi.prototype._setLatLngs.call(this,h),Si(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Si(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var h=this._renderer._bounds,w=this.options.weight,P=new Q(w,w);if(h=new G(h.min.subtract(P),h.max.add(P)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(h))){if(this.options.noClip){this._parts=this._rings;return}for(var U=0,J=this._rings.length,le;U<J;U++)le=Or(this._rings[U],h,!0),le.length&&this._parts.push(le)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(h){var w=!1,P,U,J,le,we,Me,Le,$e;if(!this._pxBounds||!this._pxBounds.contains(h))return!1;for(le=0,Le=this._parts.length;le<Le;le++)for(P=this._parts[le],we=0,$e=P.length,Me=$e-1;we<$e;Me=we++)U=P[we],J=P[Me],U.y>h.y!=J.y>h.y&&h.x<(J.x-U.x)*(h.y-U.y)/(J.y-U.y)+U.x&&(w=!w);return w||fi.prototype._containsPoint.call(this,h,!0)}});function Ra(h,w){return new ua(h,w)}var Oi=Li.extend({initialize:function(h,w){_(this,w),this._layers={},h&&this.addData(h)},addData:function(h){var w=E(h)?h:h.features,P,U,J;if(w){for(P=0,U=w.length;P<U;P++)J=w[P],(J.geometries||J.geometry||J.features||J.coordinates)&&this.addData(J);return this}var le=this.options;if(le.filter&&!le.filter(h))return this;var we=Xa(h,le);return we?(we.feature=Ho(h),we.defaultOptions=we.options,this.resetStyle(we),le.onEachFeature&&le.onEachFeature(h,we),this.addLayer(we)):this},resetStyle:function(h){return h===void 0?this.eachLayer(this.resetStyle,this):(h.options=i({},h.defaultOptions),this._setLayerStyle(h,this.options.style),this)},setStyle:function(h){return this.eachLayer(function(w){this._setLayerStyle(w,h)},this)},_setLayerStyle:function(h,w){h.setStyle&&(typeof w=="function"&&(w=w(h.feature)),h.setStyle(w))}});function Xa(h,w){var P=h.type==="Feature"?h.geometry:h,U=P?P.coordinates:null,J=[],le=w&&w.pointToLayer,we=w&&w.coordsToLatLng||Cl,Me,Le,$e,pt;if(!U&&!P)return null;switch(P.type){case"Point":return Me=we(U),ca(le,h,Me,w);case"MultiPoint":for($e=0,pt=U.length;$e<pt;$e++)Me=we(U[$e]),J.push(ca(le,h,Me,w));return new Li(J);case"LineString":case"MultiLineString":return Le=ys(U,P.type==="LineString"?0:1,we),new fi(Le,w);case"Polygon":case"MultiPolygon":return Le=ys(U,P.type==="Polygon"?1:2,we),new ua(Le,w);case"GeometryCollection":for($e=0,pt=P.geometries.length;$e<pt;$e++){var Dt=Xa({geometry:P.geometries[$e],type:"Feature",properties:h.properties},w);Dt&&J.push(Dt)}return new Li(J);case"FeatureCollection":for($e=0,pt=P.features.length;$e<pt;$e++){var Xt=Xa(P.features[$e],w);Xt&&J.push(Xt)}return new Li(J);default:throw new Error("Invalid GeoJSON object.")}}function ca(h,w,P,U){return h?h(w,P):new hi(P,U&&U.markersInheritOptions&&U)}function Cl(h){return new me(h[1],h[0],h[2])}function ys(h,w,P){for(var U=[],J=0,le=h.length,we;J<le;J++)we=w?ys(h[J],w-1,P):(P||Cl)(h[J]),U.push(we);return U}function mu(h,w){return h=ye(h),h.alt!==void 0?[g(h.lng,w),g(h.lat,w),g(h.alt,w)]:[g(h.lng,w),g(h.lat,w)]}function El(h,w,P,U){for(var J=[],le=0,we=h.length;le<we;le++)J.push(w?El(h[le],Si(h[le])?0:w-1,P,U):mu(h[le],U));return!w&&P&&J.length>0&&J.push(J[0].slice()),J}function kr(h,w){return h.feature?i({},h.feature,{geometry:w}):Ho(w)}function Ho(h){return h.type==="Feature"||h.type==="FeatureCollection"?h:{type:"Feature",properties:{},geometry:h}}var gu={toGeoJSON:function(h){return kr(this,{type:"Point",coordinates:mu(this.getLatLng(),h)})}};hi.include(gu),Uo.include(gu),ja.include(gu),fi.include({toGeoJSON:function(h){var w=!Si(this._latlngs),P=El(this._latlngs,w?1:0,!1,h);return kr(this,{type:(w?"Multi":"")+"LineString",coordinates:P})}}),ua.include({toGeoJSON:function(h){var w=!Si(this._latlngs),P=w&&!Si(this._latlngs[0]),U=El(this._latlngs,P?2:w?1:0,!0,h);return w||(U=[U]),kr(this,{type:(P?"Multi":"")+"Polygon",coordinates:U})}}),vs.include({toMultiPoint:function(h){var w=[];return this.eachLayer(function(P){w.push(P.toGeoJSON(h).geometry.coordinates)}),kr(this,{type:"MultiPoint",coordinates:w})},toGeoJSON:function(h){var w=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(w==="MultiPoint")return this.toMultiPoint(h);var P=w==="GeometryCollection",U=[];return this.eachLayer(function(J){if(J.toGeoJSON){var le=J.toGeoJSON(h);if(P)U.push(le.geometry);else{var we=Ho(le);we.type==="FeatureCollection"?U.push.apply(U,we.features):U.push(we)}}}),P?kr(this,{geometries:U,type:"GeometryCollection"}):{type:"FeatureCollection",features:U}}});function uc(h,w){return new Oi(h,w)}var Di=uc,xs=Ma.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(h,w,P){this._url=h,this._bounds=de(w),_(this,P)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Tt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){cr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(h){return this.options.opacity=h,this._image&&this._updateOpacity(),this},setStyle:function(h){return h.opacity&&this.setOpacity(h.opacity),this},bringToFront:function(){return this._map&&zr(this._image),this},bringToBack:function(){return this._map&&Nr(this._image),this},setUrl:function(h){return this._url=h,this._image&&(this._image.src=h),this},setBounds:function(h){return this._bounds=de(h),this._map&&this._reset(),this},getEvents:function(){var h={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},setZIndex:function(h){return this.options.zIndex=h,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var h=this._url.tagName==="IMG",w=this._image=h?this._url:ot("img");if(Tt(w,"leaflet-image-layer"),this._zoomAnimated&&Tt(w,"leaflet-zoom-animated"),this.options.className&&Tt(w,this.options.className),w.onselectstart=f,w.onmousemove=f,w.onload=s(this.fire,this,"load"),w.onerror=s(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),h){this._url=w.src;return}w.src=this._url,w.alt=this.options.alt},_animateZoom:function(h){var w=this._map.getZoomScale(h.zoom),P=this._map._latLngBoundsToNewLayerBounds(this._bounds,h.zoom,h.center).min;$a(this._image,P,w)},_reset:function(){var h=this._image,w=new G(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),P=w.getSize();bn(h,w.min),h.style.width=P.x+"px",h.style.height=P.y+"px"},_updateOpacity:function(){Xn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var h=this.options.errorOverlayUrl;h&&this._url!==h&&(this._url=h,this._image.src=h)},getCenter:function(){return this._bounds.getCenter()}}),ao=function(h,w,P){return new xs(h,w,P)},Fr=xs.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var h=this._url.tagName==="VIDEO",w=this._image=h?this._url:ot("video");if(Tt(w,"leaflet-image-layer"),this._zoomAnimated&&Tt(w,"leaflet-zoom-animated"),this.options.className&&Tt(w,this.options.className),w.onselectstart=f,w.onmousemove=f,w.onloadeddata=s(this.fire,this,"load"),h){for(var P=w.getElementsByTagName("source"),U=[],J=0;J<P.length;J++)U.push(P[J].src);this._url=P.length>0?U:[w.src];return}E(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(w.style,"objectFit")&&(w.style.objectFit="fill"),w.autoplay=!!this.options.autoplay,w.loop=!!this.options.loop,w.muted=!!this.options.muted,w.playsInline=!!this.options.playsInline;for(var le=0;le<this._url.length;le++){var we=ot("source");we.src=this._url[le],w.appendChild(we)}}});function kn(h,w,P){return new Fr(h,w,P)}var Cn=xs.extend({_initImage:function(){var h=this._image=this._url;Tt(h,"leaflet-image-layer"),this._zoomAnimated&&Tt(h,"leaflet-zoom-animated"),this.options.className&&Tt(h,this.options.className),h.onselectstart=f,h.onmousemove=f}});function Nl(h,w,P){return new Cn(h,w,P)}var Ii=Ma.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(h,w){h&&(h instanceof me||E(h))?(this._latlng=ye(h),_(this,w)):(_(this,h),this._source=w),this.options.content&&(this._content=this.options.content)},openOn:function(h){return h=arguments.length?h:this._source._map,h.hasLayer(this)||h.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(h){return this._map?this.close():(arguments.length?this._source=h:h=this._source,this._prepareOpen(),this.openOn(h._map)),this},onAdd:function(h){this._zoomAnimated=h._zoomAnimated,this._container||this._initLayout(),h._fadeAnimated&&Xn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),h._fadeAnimated&&Xn(this._container,1),this.bringToFront(),this.options.interactive&&(Tt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(h){h._fadeAnimated?(Xn(this._container,0),this._removeTimeout=setTimeout(s(cr,void 0,this._container),200)):cr(this._container),this.options.interactive&&(yr(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(h){return this._latlng=ye(h),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(h){return this._content=h,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var h={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&zr(this._container),this},bringToBack:function(){return this._map&&Nr(this._container),this},_prepareOpen:function(h){var w=this._source;if(!w._map)return!1;if(w instanceof Li){w=null;var P=this._source._layers;for(var U in P)if(P[U]._map){w=P[U];break}if(!w)return!1;this._source=w}if(!h)if(w.getCenter)h=w.getCenter();else if(w.getLatLng)h=w.getLatLng();else if(w.getBounds)h=w.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(h),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var h=this._contentNode,w=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof w=="string")h.innerHTML=w;else{for(;h.hasChildNodes();)h.removeChild(h.firstChild);h.appendChild(w)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var h=this._map.latLngToLayerPoint(this._latlng),w=re(this.options.offset),P=this._getAnchor();this._zoomAnimated?bn(this._container,h.add(P)):w=w.add(h).add(P);var U=this._containerBottom=-w.y,J=this._containerLeft=-Math.round(this._containerWidth/2)+w.x;this._container.style.bottom=U+"px",this._container.style.left=J+"px"}},_getAnchor:function(){return[0,0]}});sr.include({_initOverlay:function(h,w,P,U){var J=w;return J instanceof h||(J=new h(U).setContent(w)),P&&J.setLatLng(P),J}}),Ma.include({_initOverlay:function(h,w,P,U){var J=P;return J instanceof h?(_(J,U),J._source=this):(J=w&&!U?w:new h(U,this),J.setContent(P)),J}});var so=Ii.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(h){return h=arguments.length?h:this._source._map,!h.hasLayer(this)&&h._popup&&h._popup.options.autoClose&&h.removeLayer(h._popup),h._popup=this,Ii.prototype.openOn.call(this,h)},onAdd:function(h){Ii.prototype.onAdd.call(this,h),h.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Vs||this._source.on("preclick",ps))},onRemove:function(h){Ii.prototype.onRemove.call(this,h),h.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Vs||this._source.off("preclick",ps))},getEvents:function(){var h=Ii.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(h.preclick=this.close),this.options.keepInView&&(h.moveend=this._adjustPan),h},_initLayout:function(){var h="leaflet-popup",w=this._container=ot("div",h+" "+(this.options.className||"")+" leaflet-zoom-animated"),P=this._wrapper=ot("div",h+"-content-wrapper",w);if(this._contentNode=ot("div",h+"-content",P),cu(w),vl(this._contentNode),Gt(w,"contextmenu",ps),this._tipContainer=ot("div",h+"-tip-container",w),this._tip=ot("div",h+"-tip",this._tipContainer),this.options.closeButton){var U=this._closeButton=ot("a",h+"-close-button",w);U.setAttribute("role","button"),U.setAttribute("aria-label","Close popup"),U.href="#close",U.innerHTML='<span aria-hidden="true">&#215;</span>',Gt(U,"click",function(J){Wr(J),this.close()},this)}},_updateLayout:function(){var h=this._contentNode,w=h.style;w.width="",w.whiteSpace="nowrap";var P=h.offsetWidth;P=Math.min(P,this.options.maxWidth),P=Math.max(P,this.options.minWidth),w.width=P+1+"px",w.whiteSpace="",w.height="";var U=h.offsetHeight,J=this.options.maxHeight,le="leaflet-popup-scrolled";J&&U>J?(w.height=J+"px",Tt(h,le)):yr(h,le),this._containerWidth=this._container.offsetWidth},_animateZoom:function(h){var w=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center),P=this._getAnchor();bn(this._container,w.add(P))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var h=this._map,w=parseInt(vr(this._container,"marginBottom"),10)||0,P=this._container.offsetHeight+w,U=this._containerWidth,J=new Q(this._containerLeft,-P-this._containerBottom);J._add(Bs(this._container));var le=h.layerPointToContainerPoint(J),we=re(this.options.autoPanPadding),Me=re(this.options.autoPanPaddingTopLeft||we),Le=re(this.options.autoPanPaddingBottomRight||we),$e=h.getSize(),pt=0,Dt=0;le.x+U+Le.x>$e.x&&(pt=le.x+U-$e.x+Le.x),le.x-pt-Me.x<0&&(pt=le.x-Me.x),le.y+P+Le.y>$e.y&&(Dt=le.y+P-$e.y+Le.y),le.y-Dt-Me.y<0&&(Dt=le.y-Me.y),(pt||Dt)&&(this.options.keepInView&&(this._autopanning=!0),h.fire("autopanstart").panBy([pt,Dt]))}},_getAnchor:function(){return re(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Tl=function(h,w){return new so(h,w)};sr.mergeOptions({closePopupOnClick:!0}),sr.include({openPopup:function(h,w,P){return this._initOverlay(so,h,w,P).openOn(this),this},closePopup:function(h){return h=arguments.length?h:this._popup,h&&h.close(),this}}),Ma.include({bindPopup:function(h,w){return this._popup=this._initOverlay(so,this._popup,h,w),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(h){return this._popup&&(this instanceof Li||(this._popup._source=this),this._popup._prepareOpen(h||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(h){return this._popup&&this._popup.setContent(h),this},getPopup:function(){return this._popup},_openPopup:function(h){if(!(!this._popup||!this._map)){_n(h);var w=h.layer||h.target;if(this._popup._source===w&&!(w instanceof Vs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(h.latlng);return}this._popup._source=w,this.openPopup(h.latlng)}},_movePopup:function(h){this._popup.setLatLng(h.latlng)},_onKeyPress:function(h){h.originalEvent.keyCode===13&&this._openPopup(h)}});var mn=Ii.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(h){Ii.prototype.onAdd.call(this,h),this.setOpacity(this.options.opacity),h.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(h){Ii.prototype.onRemove.call(this,h),h.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var h=Ii.prototype.getEvents.call(this);return this.options.permanent||(h.preclick=this.close),h},_initLayout:function(){var h="leaflet-tooltip",w=h+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ot("div",w),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+l(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(h){var w,P,U=this._map,J=this._container,le=U.latLngToContainerPoint(U.getCenter()),we=U.layerPointToContainerPoint(h),Me=this.options.direction,Le=J.offsetWidth,$e=J.offsetHeight,pt=re(this.options.offset),Dt=this._getAnchor();Me==="top"?(w=Le/2,P=$e):Me==="bottom"?(w=Le/2,P=0):Me==="center"?(w=Le/2,P=$e/2):Me==="right"?(w=0,P=$e/2):Me==="left"?(w=Le,P=$e/2):we.x<le.x?(Me="right",w=0,P=$e/2):(Me="left",w=Le+(pt.x+Dt.x)*2,P=$e/2),h=h.subtract(re(w,P,!0)).add(pt).add(Dt),yr(J,"leaflet-tooltip-right"),yr(J,"leaflet-tooltip-left"),yr(J,"leaflet-tooltip-top"),yr(J,"leaflet-tooltip-bottom"),Tt(J,"leaflet-tooltip-"+Me),bn(J,h)},_updatePosition:function(){var h=this._map.latLngToLayerPoint(this._latlng);this._setPosition(h)},setOpacity:function(h){this.options.opacity=h,this._container&&Xn(this._container,h)},_animateZoom:function(h){var w=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center);this._setPosition(w)},_getAnchor:function(){return re(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Go=function(h,w){return new mn(h,w)};sr.include({openTooltip:function(h,w,P){return this._initOverlay(mn,h,w,P).openOn(this),this},closeTooltip:function(h){return h.close(),this}}),Ma.include({bindTooltip:function(h,w){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(mn,this._tooltip,h,w),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(h){if(!(!h&&this._tooltipHandlersAdded)){var w=h?"off":"on",P={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?P.add=this._openTooltip:(P.mouseover=this._openTooltip,P.mouseout=this.closeTooltip,P.click=this._openTooltip,this._map?this._addFocusListeners():P.add=this._addFocusListeners),this._tooltip.options.sticky&&(P.mousemove=this._moveTooltip),this[w](P),this._tooltipHandlersAdded=!h}},openTooltip:function(h){return this._tooltip&&(this instanceof Li||(this._tooltip._source=this),this._tooltip._prepareOpen(h)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(h){return this._tooltip&&this._tooltip.setContent(h),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(h){var w=typeof h.getElement=="function"&&h.getElement();w&&(Gt(w,"focus",function(){this._tooltip._source=h,this.openTooltip()},this),Gt(w,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(h){var w=typeof h.getElement=="function"&&h.getElement();w&&w.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(h){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var w=this;this._map.once("moveend",function(){w._openOnceFlag=!1,w._openTooltip(h)});return}this._tooltip._source=h.layer||h.target,this.openTooltip(this._tooltip.options.sticky?h.latlng:void 0)}},_moveTooltip:function(h){var w=h.latlng,P,U;this._tooltip.options.sticky&&h.originalEvent&&(P=this._map.mouseEventToContainerPoint(h.originalEvent),U=this._map.containerPointToLayerPoint(P),w=this._map.layerPointToLatLng(U)),this._tooltip.setLatLng(w)}});var Pl=la.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(h){var w=h&&h.tagName==="DIV"?h:document.createElement("div"),P=this.options;if(P.html instanceof Element?(sn(w),w.appendChild(P.html)):w.innerHTML=P.html!==!1?P.html:"",P.bgPos){var U=re(P.bgPos);w.style.backgroundPosition=-U.x+"px "+-U.y+"px"}return this._setIconStyles(w,"icon"),w},createShadow:function(){return null}});function cc(h){return new Pl(h)}la.Default=Vo;var ei=Ma.extend({options:{tileSize:256,opacity:1,updateWhenIdle:yt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(h){_(this,h)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(h){h._addZoomLimit(this)},onRemove:function(h){this._removeAllTiles(),cr(this._container),h._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(zr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Nr(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(h){return this.options.opacity=h,this._updateOpacity(),this},setZIndex:function(h){return this.options.zIndex=h,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var h=this._clampZoom(this._map.getZoom());h!==this._tileZoom&&(this._tileZoom=h,this._updateLevels()),this._update()}return this},getEvents:function(){var h={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),h.move=this._onMove),this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},createTile:function(){return document.createElement("div")},getTileSize:function(){var h=this.options.tileSize;return h instanceof Q?h:new Q(h,h)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(h){for(var w=this.getPane().children,P=-h(-1/0,1/0),U=0,J=w.length,le;U<J;U++)le=w[U].style.zIndex,w[U]!==this._container&&le&&(P=h(P,+le));isFinite(P)&&(this.options.zIndex=P+h(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!yt.ielt9){Xn(this._container,this.options.opacity);var h=+new Date,w=!1,P=!1;for(var U in this._tiles){var J=this._tiles[U];if(!(!J.current||!J.loaded)){var le=Math.min(1,(h-J.loaded)/200);Xn(J.el,le),le<1?w=!0:(J.active?P=!0:this._onOpaqueTile(J),J.active=!0)}}P&&!this._noPrune&&this._pruneTiles(),w&&(Z(this._fadeFrame),this._fadeFrame=$(this._updateOpacity,this))}},_onOpaqueTile:f,_initContainer:function(){this._container||(this._container=ot("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var h=this._tileZoom,w=this.options.maxZoom;if(h!==void 0){for(var P in this._levels)P=Number(P),this._levels[P].el.children.length||P===h?(this._levels[P].el.style.zIndex=w-Math.abs(h-P),this._onUpdateLevel(P)):(cr(this._levels[P].el),this._removeTilesAtZoom(P),this._onRemoveLevel(P),delete this._levels[P]);var U=this._levels[h],J=this._map;return U||(U=this._levels[h]={},U.el=ot("div","leaflet-tile-container leaflet-zoom-animated",this._container),U.el.style.zIndex=w,U.origin=J.project(J.unproject(J.getPixelOrigin()),h).round(),U.zoom=h,this._setZoomTransform(U,J.getCenter(),J.getZoom()),f(U.el.offsetWidth),this._onCreateLevel(U)),this._level=U,U}},_onUpdateLevel:f,_onRemoveLevel:f,_onCreateLevel:f,_pruneTiles:function(){if(this._map){var h,w,P=this._map.getZoom();if(P>this.options.maxZoom||P<this.options.minZoom){this._removeAllTiles();return}for(h in this._tiles)w=this._tiles[h],w.retain=w.current;for(h in this._tiles)if(w=this._tiles[h],w.current&&!w.active){var U=w.coords;this._retainParent(U.x,U.y,U.z,U.z-5)||this._retainChildren(U.x,U.y,U.z,U.z+2)}for(h in this._tiles)this._tiles[h].retain||this._removeTile(h)}},_removeTilesAtZoom:function(h){for(var w in this._tiles)this._tiles[w].coords.z===h&&this._removeTile(w)},_removeAllTiles:function(){for(var h in this._tiles)this._removeTile(h)},_invalidateAll:function(){for(var h in this._levels)cr(this._levels[h].el),this._onRemoveLevel(Number(h)),delete this._levels[h];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(h,w,P,U){var J=Math.floor(h/2),le=Math.floor(w/2),we=P-1,Me=new Q(+J,+le);Me.z=+we;var Le=this._tileCoordsToKey(Me),$e=this._tiles[Le];return $e&&$e.active?($e.retain=!0,!0):($e&&$e.loaded&&($e.retain=!0),we>U?this._retainParent(J,le,we,U):!1)},_retainChildren:function(h,w,P,U){for(var J=2*h;J<2*h+2;J++)for(var le=2*w;le<2*w+2;le++){var we=new Q(J,le);we.z=P+1;var Me=this._tileCoordsToKey(we),Le=this._tiles[Me];if(Le&&Le.active){Le.retain=!0;continue}else Le&&Le.loaded&&(Le.retain=!0);P+1<U&&this._retainChildren(J,le,P+1,U)}},_resetView:function(h){var w=h&&(h.pinch||h.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),w,w)},_animateZoom:function(h){this._setView(h.center,h.zoom,!0,h.noUpdate)},_clampZoom:function(h){var w=this.options;return w.minNativeZoom!==void 0&&h<w.minNativeZoom?w.minNativeZoom:w.maxNativeZoom!==void 0&&w.maxNativeZoom<h?w.maxNativeZoom:h},_setView:function(h,w,P,U){var J=Math.round(w);this.options.maxZoom!==void 0&&J>this.options.maxZoom||this.options.minZoom!==void 0&&J<this.options.minZoom?J=void 0:J=this._clampZoom(J);var le=this.options.updateWhenZooming&&J!==this._tileZoom;(!U||le)&&(this._tileZoom=J,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),J!==void 0&&this._update(h),P||this._pruneTiles(),this._noPrune=!!P),this._setZoomTransforms(h,w)},_setZoomTransforms:function(h,w){for(var P in this._levels)this._setZoomTransform(this._levels[P],h,w)},_setZoomTransform:function(h,w,P){var U=this._map.getZoomScale(P,h.zoom),J=h.origin.multiplyBy(U).subtract(this._map._getNewPixelOrigin(w,P)).round();yt.any3d?$a(h.el,J,U):bn(h.el,J)},_resetGrid:function(){var h=this._map,w=h.options.crs,P=this._tileSize=this.getTileSize(),U=this._tileZoom,J=this._map.getPixelWorldBounds(this._tileZoom);J&&(this._globalTileRange=this._pxBoundsToTileRange(J)),this._wrapX=w.wrapLng&&!this.options.noWrap&&[Math.floor(h.project([0,w.wrapLng[0]],U).x/P.x),Math.ceil(h.project([0,w.wrapLng[1]],U).x/P.y)],this._wrapY=w.wrapLat&&!this.options.noWrap&&[Math.floor(h.project([w.wrapLat[0],0],U).y/P.x),Math.ceil(h.project([w.wrapLat[1],0],U).y/P.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(h){var w=this._map,P=w._animatingZoom?Math.max(w._animateToZoom,w.getZoom()):w.getZoom(),U=w.getZoomScale(P,this._tileZoom),J=w.project(h,this._tileZoom).floor(),le=w.getSize().divideBy(U*2);return new G(J.subtract(le),J.add(le))},_update:function(h){var w=this._map;if(w){var P=this._clampZoom(w.getZoom());if(h===void 0&&(h=w.getCenter()),this._tileZoom!==void 0){var U=this._getTiledPixelBounds(h),J=this._pxBoundsToTileRange(U),le=J.getCenter(),we=[],Me=this.options.keepBuffer,Le=new G(J.getBottomLeft().subtract([Me,-Me]),J.getTopRight().add([Me,-Me]));if(!(isFinite(J.min.x)&&isFinite(J.min.y)&&isFinite(J.max.x)&&isFinite(J.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var $e in this._tiles){var pt=this._tiles[$e].coords;(pt.z!==this._tileZoom||!Le.contains(new Q(pt.x,pt.y)))&&(this._tiles[$e].current=!1)}if(Math.abs(P-this._tileZoom)>1){this._setView(h,P);return}for(var Dt=J.min.y;Dt<=J.max.y;Dt++)for(var Xt=J.min.x;Xt<=J.max.x;Xt++){var Mr=new Q(Xt,Dt);if(Mr.z=this._tileZoom,!!this._isValidTile(Mr)){var En=this._tiles[this._tileCoordsToKey(Mr)];En?En.current=!0:we.push(Mr)}}if(we.sort(function(ki,$o){return ki.distanceTo(le)-$o.distanceTo(le)}),we.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var pi=document.createDocumentFragment();for(Xt=0;Xt<we.length;Xt++)this._addTile(we[Xt],pi);this._level.el.appendChild(pi)}}}},_isValidTile:function(h){var w=this._map.options.crs;if(!w.infinite){var P=this._globalTileRange;if(!w.wrapLng&&(h.x<P.min.x||h.x>P.max.x)||!w.wrapLat&&(h.y<P.min.y||h.y>P.max.y))return!1}if(!this.options.bounds)return!0;var U=this._tileCoordsToBounds(h);return de(this.options.bounds).overlaps(U)},_keyToBounds:function(h){return this._tileCoordsToBounds(this._keyToTileCoords(h))},_tileCoordsToNwSe:function(h){var w=this._map,P=this.getTileSize(),U=h.scaleBy(P),J=U.add(P),le=w.unproject(U,h.z),we=w.unproject(J,h.z);return[le,we]},_tileCoordsToBounds:function(h){var w=this._tileCoordsToNwSe(h),P=new ne(w[0],w[1]);return this.options.noWrap||(P=this._map.wrapLatLngBounds(P)),P},_tileCoordsToKey:function(h){return h.x+":"+h.y+":"+h.z},_keyToTileCoords:function(h){var w=h.split(":"),P=new Q(+w[0],+w[1]);return P.z=+w[2],P},_removeTile:function(h){var w=this._tiles[h];w&&(cr(w.el),delete this._tiles[h],this.fire("tileunload",{tile:w.el,coords:this._keyToTileCoords(h)}))},_initTile:function(h){Tt(h,"leaflet-tile");var w=this.getTileSize();h.style.width=w.x+"px",h.style.height=w.y+"px",h.onselectstart=f,h.onmousemove=f,yt.ielt9&&this.options.opacity<1&&Xn(h,this.options.opacity)},_addTile:function(h,w){var P=this._getTilePos(h),U=this._tileCoordsToKey(h),J=this.createTile(this._wrapCoords(h),s(this._tileReady,this,h));this._initTile(J),this.createTile.length<2&&$(s(this._tileReady,this,h,null,J)),bn(J,P),this._tiles[U]={el:J,coords:h,current:!0},w.appendChild(J),this.fire("tileloadstart",{tile:J,coords:h})},_tileReady:function(h,w,P){w&&this.fire("tileerror",{error:w,tile:P,coords:h});var U=this._tileCoordsToKey(h);P=this._tiles[U],P&&(P.loaded=+new Date,this._map._fadeAnimated?(Xn(P.el,0),Z(this._fadeFrame),this._fadeFrame=$(this._updateOpacity,this)):(P.active=!0,this._pruneTiles()),w||(Tt(P.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:P.el,coords:h})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),yt.ielt9||!this._map._fadeAnimated?$(this._pruneTiles,this):setTimeout(s(this._pruneTiles,this),250)))},_getTilePos:function(h){return h.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(h){var w=new Q(this._wrapX?c(h.x,this._wrapX):h.x,this._wrapY?c(h.y,this._wrapY):h.y);return w.z=h.z,w},_pxBoundsToTileRange:function(h){var w=this.getTileSize();return new G(h.min.unscaleBy(w).floor(),h.max.unscaleBy(w).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var h in this._tiles)if(!this._tiles[h].loaded)return!1;return!0}});function ti(h){return new ei(h)}var La=ei.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(h,w){this._url=h,w=_(this,w),w.detectRetina&&yt.retina&&w.maxZoom>0?(w.tileSize=Math.floor(w.tileSize/2),w.zoomReverse?(w.zoomOffset--,w.minZoom=Math.min(w.maxZoom,w.minZoom+1)):(w.zoomOffset++,w.maxZoom=Math.max(w.minZoom,w.maxZoom-1)),w.minZoom=Math.max(0,w.minZoom)):w.zoomReverse?w.minZoom=Math.min(w.maxZoom,w.minZoom):w.maxZoom=Math.max(w.minZoom,w.maxZoom),typeof w.subdomains=="string"&&(w.subdomains=w.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(h,w){return this._url===h&&w===void 0&&(w=!0),this._url=h,w||this.redraw(),this},createTile:function(h,w){var P=document.createElement("img");return Gt(P,"load",s(this._tileOnLoad,this,w,P)),Gt(P,"error",s(this._tileOnError,this,w,P)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(P.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(P.referrerPolicy=this.options.referrerPolicy),P.alt="",P.src=this.getTileUrl(h),P},getTileUrl:function(h){var w={r:yt.retina?"@2x":"",s:this._getSubdomain(h),x:h.x,y:h.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var P=this._globalTileRange.max.y-h.y;this.options.tms&&(w.y=P),w["-y"]=P}return k(this._url,i(w,this.options))},_tileOnLoad:function(h,w){yt.ielt9?setTimeout(s(h,this,null,w),0):h(null,w)},_tileOnError:function(h,w,P){var U=this.options.errorTileUrl;U&&w.getAttribute("src")!==U&&(w.src=U),h(P,w)},_onTileRemove:function(h){h.tile.onload=null},_getZoomForUrl:function(){var h=this._tileZoom,w=this.options.maxZoom,P=this.options.zoomReverse,U=this.options.zoomOffset;return P&&(h=w-h),h+U},_getSubdomain:function(h){var w=Math.abs(h.x+h.y)%this.options.subdomains.length;return this.options.subdomains[w]},_abortLoading:function(){var h,w;for(h in this._tiles)if(this._tiles[h].coords.z!==this._tileZoom&&(w=this._tiles[h].el,w.onload=f,w.onerror=f,!w.complete)){w.src=R;var P=this._tiles[h].coords;cr(w),delete this._tiles[h],this.fire("tileabort",{tile:w,coords:P})}},_removeTile:function(h){var w=this._tiles[h];if(w)return w.el.setAttribute("src",R),ei.prototype._removeTile.call(this,h)},_tileReady:function(h,w,P){if(!(!this._map||P&&P.getAttribute("src")===R))return ei.prototype._tileReady.call(this,h,w,P)}});function vu(h,w){return new La(h,w)}var qo=La.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(h,w){this._url=h;var P=i({},this.defaultWmsParams);for(var U in w)U in this.options||(P[U]=w[U]);w=_(this,w);var J=w.detectRetina&&yt.retina?2:1,le=this.getTileSize();P.width=le.x*J,P.height=le.y*J,this.wmsParams=P},onAdd:function(h){this._crs=this.options.crs||h.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var w=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[w]=this._crs.code,La.prototype.onAdd.call(this,h)},getTileUrl:function(h){var w=this._tileCoordsToNwSe(h),P=this._crs,U=te(P.project(w[0]),P.project(w[1])),J=U.min,le=U.max,we=(this._wmsVersion>=1.3&&this._crs===oc?[J.y,J.x,le.y,le.x]:[J.x,J.y,le.x,le.y]).join(","),Me=La.prototype.getTileUrl.call(this,h);return Me+S(this.wmsParams,Me,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+we},setParams:function(h,w){return i(this.wmsParams,h),w||this.redraw(),this}});function qd(h,w){return new qo(h,w)}La.WMS=qo,vu.wms=qd;var Qa=Ma.extend({options:{padding:.1},initialize:function(h){_(this,h),l(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Tt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var h={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(h.zoomanim=this._onAnimZoom),h},_onAnimZoom:function(h){this._updateTransform(h.center,h.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(h,w){var P=this._map.getZoomScale(w,this._zoom),U=this._map.getSize().multiplyBy(.5+this.options.padding),J=this._map.project(this._center,w),le=U.multiplyBy(-P).add(J).subtract(this._map._getNewPixelOrigin(h,w));yt.any3d?$a(this._container,le,P):bn(this._container,le)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var h in this._layers)this._layers[h]._reset()},_onZoomEnd:function(){for(var h in this._layers)this._layers[h]._project()},_updatePaths:function(){for(var h in this._layers)this._layers[h]._update()},_update:function(){var h=this.options.padding,w=this._map.getSize(),P=this._map.containerPointToLayerPoint(w.multiplyBy(-h)).round();this._bounds=new G(P,P.add(w.multiplyBy(1+h*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),dc=Qa.extend({options:{tolerance:0},getEvents:function(){var h=Qa.prototype.getEvents.call(this);return h.viewprereset=this._onViewPreReset,h},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Qa.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var h=this._container=document.createElement("canvas");Gt(h,"mousemove",this._onMouseMove,this),Gt(h,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Gt(h,"mouseout",this._handleMouseOut,this),h._leaflet_disable_events=!0,this._ctx=h.getContext("2d")},_destroyContainer:function(){Z(this._redrawRequest),delete this._ctx,cr(this._container),Tr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var h;this._redrawBounds=null;for(var w in this._layers)h=this._layers[w],h._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Qa.prototype._update.call(this);var h=this._bounds,w=this._container,P=h.getSize(),U=yt.retina?2:1;bn(w,h.min),w.width=U*P.x,w.height=U*P.y,w.style.width=P.x+"px",w.style.height=P.y+"px",yt.retina&&this._ctx.scale(2,2),this._ctx.translate(-h.min.x,-h.min.y),this.fire("update")}},_reset:function(){Qa.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(h){this._updateDashArray(h),this._layers[l(h)]=h;var w=h._order={layer:h,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=w),this._drawLast=w,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(h){this._requestRedraw(h)},_removePath:function(h){var w=h._order,P=w.next,U=w.prev;P?P.prev=U:this._drawLast=U,U?U.next=P:this._drawFirst=P,delete h._order,delete this._layers[l(h)],this._requestRedraw(h)},_updatePath:function(h){this._extendRedrawBounds(h),h._project(),h._update(),this._requestRedraw(h)},_updateStyle:function(h){this._updateDashArray(h),this._requestRedraw(h)},_updateDashArray:function(h){if(typeof h.options.dashArray=="string"){var w=h.options.dashArray.split(/[, ]+/),P=[],U,J;for(J=0;J<w.length;J++){if(U=Number(w[J]),isNaN(U))return;P.push(U)}h.options._dashArray=P}else h.options._dashArray=h.options.dashArray},_requestRedraw:function(h){this._map&&(this._extendRedrawBounds(h),this._redrawRequest=this._redrawRequest||$(this._redraw,this))},_extendRedrawBounds:function(h){if(h._pxBounds){var w=(h.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new G,this._redrawBounds.extend(h._pxBounds.min.subtract([w,w])),this._redrawBounds.extend(h._pxBounds.max.add([w,w]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var h=this._redrawBounds;if(h){var w=h.getSize();this._ctx.clearRect(h.min.x,h.min.y,w.x,w.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var h,w=this._redrawBounds;if(this._ctx.save(),w){var P=w.getSize();this._ctx.beginPath(),this._ctx.rect(w.min.x,w.min.y,P.x,P.y),this._ctx.clip()}this._drawing=!0;for(var U=this._drawFirst;U;U=U.next)h=U.layer,(!w||h._pxBounds&&h._pxBounds.intersects(w))&&h._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(h,w){if(this._drawing){var P,U,J,le,we=h._parts,Me=we.length,Le=this._ctx;if(Me){for(Le.beginPath(),P=0;P<Me;P++){for(U=0,J=we[P].length;U<J;U++)le=we[P][U],Le[U?"lineTo":"moveTo"](le.x,le.y);w&&Le.closePath()}this._fillStroke(Le,h)}}},_updateCircle:function(h){if(!(!this._drawing||h._empty())){var w=h._point,P=this._ctx,U=Math.max(Math.round(h._radius),1),J=(Math.max(Math.round(h._radiusY),1)||U)/U;J!==1&&(P.save(),P.scale(1,J)),P.beginPath(),P.arc(w.x,w.y/J,U,0,Math.PI*2,!1),J!==1&&P.restore(),this._fillStroke(P,h)}},_fillStroke:function(h,w){var P=w.options;P.fill&&(h.globalAlpha=P.fillOpacity,h.fillStyle=P.fillColor||P.color,h.fill(P.fillRule||"evenodd")),P.stroke&&P.weight!==0&&(h.setLineDash&&h.setLineDash(w.options&&w.options._dashArray||[]),h.globalAlpha=P.opacity,h.lineWidth=P.weight,h.strokeStyle=P.color,h.lineCap=P.lineCap,h.lineJoin=P.lineJoin,h.stroke())},_onClick:function(h){for(var w=this._map.mouseEventToLayerPoint(h),P,U,J=this._drawFirst;J;J=J.next)P=J.layer,P.options.interactive&&P._containsPoint(w)&&(!(h.type==="click"||h.type==="preclick")||!this._map._draggableMoved(P))&&(U=P);this._fireEvent(U?[U]:!1,h)},_onMouseMove:function(h){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var w=this._map.mouseEventToLayerPoint(h);this._handleMouseHover(h,w)}},_handleMouseOut:function(h){var w=this._hoveredLayer;w&&(yr(this._container,"leaflet-interactive"),this._fireEvent([w],h,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(h,w){if(!this._mouseHoverThrottled){for(var P,U,J=this._drawFirst;J;J=J.next)P=J.layer,P.options.interactive&&P._containsPoint(w)&&(U=P);U!==this._hoveredLayer&&(this._handleMouseOut(h),U&&(Tt(this._container,"leaflet-interactive"),this._fireEvent([U],h,"mouseover"),this._hoveredLayer=U)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,h),this._mouseHoverThrottled=!0,setTimeout(s(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(h,w,P){this._map._fireDOMEvent(w,P||w.type,h)},_bringToFront:function(h){var w=h._order;if(w){var P=w.next,U=w.prev;if(P)P.prev=U;else return;U?U.next=P:P&&(this._drawFirst=P),w.prev=this._drawLast,this._drawLast.next=w,w.next=null,this._drawLast=w,this._requestRedraw(h)}},_bringToBack:function(h){var w=h._order;if(w){var P=w.next,U=w.prev;if(U)U.next=P;else return;P?P.prev=U:U&&(this._drawLast=U),w.prev=null,w.next=this._drawFirst,this._drawFirst.prev=w,this._drawFirst=w,this._requestRedraw(h)}}});function hc(h){return yt.canvas?new dc(h):null}var Wo=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(h){return document.createElement("<lvml:"+h+' class="lvml">')}}catch{}return function(h){return document.createElement("<"+h+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Wd={_initContainer:function(){this._container=ot("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Qa.prototype._update.call(this),this.fire("update"))},_initPath:function(h){var w=h._container=Wo("shape");Tt(w,"leaflet-vml-shape "+(this.options.className||"")),w.coordsize="1 1",h._path=Wo("path"),w.appendChild(h._path),this._updateStyle(h),this._layers[l(h)]=h},_addPath:function(h){var w=h._container;this._container.appendChild(w),h.options.interactive&&h.addInteractiveTarget(w)},_removePath:function(h){var w=h._container;cr(w),h.removeInteractiveTarget(w),delete this._layers[l(h)]},_updateStyle:function(h){var w=h._stroke,P=h._fill,U=h.options,J=h._container;J.stroked=!!U.stroke,J.filled=!!U.fill,U.stroke?(w||(w=h._stroke=Wo("stroke")),J.appendChild(w),w.weight=U.weight+"px",w.color=U.color,w.opacity=U.opacity,U.dashArray?w.dashStyle=E(U.dashArray)?U.dashArray.join(" "):U.dashArray.replace(/( *, *)/g," "):w.dashStyle="",w.endcap=U.lineCap.replace("butt","flat"),w.joinstyle=U.lineJoin):w&&(J.removeChild(w),h._stroke=null),U.fill?(P||(P=h._fill=Wo("fill")),J.appendChild(P),P.color=U.fillColor||U.color,P.opacity=U.fillOpacity):P&&(J.removeChild(P),h._fill=null)},_updateCircle:function(h){var w=h._point.round(),P=Math.round(h._radius),U=Math.round(h._radiusY||P);this._setPath(h,h._empty()?"M0 0":"AL "+w.x+","+w.y+" "+P+","+U+" 0,"+65535*360)},_setPath:function(h,w){h._path.v=w},_bringToFront:function(h){zr(h._container)},_bringToBack:function(h){Nr(h._container)}},Oa=yt.vml?Wo:qe,oo=Qa.extend({_initContainer:function(){this._container=Oa("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Oa("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){cr(this._container),Tr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Qa.prototype._update.call(this);var h=this._bounds,w=h.getSize(),P=this._container;(!this._svgSize||!this._svgSize.equals(w))&&(this._svgSize=w,P.setAttribute("width",w.x),P.setAttribute("height",w.y)),bn(P,h.min),P.setAttribute("viewBox",[h.min.x,h.min.y,w.x,w.y].join(" ")),this.fire("update")}},_initPath:function(h){var w=h._path=Oa("path");h.options.className&&Tt(w,h.options.className),h.options.interactive&&Tt(w,"leaflet-interactive"),this._updateStyle(h),this._layers[l(h)]=h},_addPath:function(h){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(h._path),h.addInteractiveTarget(h._path)},_removePath:function(h){cr(h._path),h.removeInteractiveTarget(h._path),delete this._layers[l(h)]},_updatePath:function(h){h._project(),h._update()},_updateStyle:function(h){var w=h._path,P=h.options;w&&(P.stroke?(w.setAttribute("stroke",P.color),w.setAttribute("stroke-opacity",P.opacity),w.setAttribute("stroke-width",P.weight),w.setAttribute("stroke-linecap",P.lineCap),w.setAttribute("stroke-linejoin",P.lineJoin),P.dashArray?w.setAttribute("stroke-dasharray",P.dashArray):w.removeAttribute("stroke-dasharray"),P.dashOffset?w.setAttribute("stroke-dashoffset",P.dashOffset):w.removeAttribute("stroke-dashoffset")):w.setAttribute("stroke","none"),P.fill?(w.setAttribute("fill",P.fillColor||P.color),w.setAttribute("fill-opacity",P.fillOpacity),w.setAttribute("fill-rule",P.fillRule||"evenodd")):w.setAttribute("fill","none"))},_updatePoly:function(h,w){this._setPath(h,Ue(h._parts,w))},_updateCircle:function(h){var w=h._point,P=Math.max(Math.round(h._radius),1),U=Math.max(Math.round(h._radiusY),1)||P,J="a"+P+","+U+" 0 1,0 ",le=h._empty()?"M0 0":"M"+(w.x-P)+","+w.y+J+P*2+",0 "+J+-P*2+",0 ";this._setPath(h,le)},_setPath:function(h,w){h._path.setAttribute("d",w)},_bringToFront:function(h){zr(h._path)},_bringToBack:function(h){Nr(h._path)}});yt.vml&&oo.include(Wd);function lo(h){return yt.svg||yt.vml?new oo(h):null}sr.include({getRenderer:function(h){var w=h.options.renderer||this._getPaneRenderer(h.options.pane)||this.options.renderer||this._renderer;return w||(w=this._renderer=this._createRenderer()),this.hasLayer(w)||this.addLayer(w),w},_getPaneRenderer:function(h){if(h==="overlayPane"||h===void 0)return!1;var w=this._paneRenderers[h];return w===void 0&&(w=this._createRenderer({pane:h}),this._paneRenderers[h]=w),w},_createRenderer:function(h){return this.options.preferCanvas&&hc(h)||lo(h)}});var $d=ua.extend({initialize:function(h,w){ua.prototype.initialize.call(this,this._boundsToLatLngs(h),w)},setBounds:function(h){return this.setLatLngs(this._boundsToLatLngs(h))},_boundsToLatLngs:function(h){return h=de(h),[h.getSouthWest(),h.getNorthWest(),h.getNorthEast(),h.getSouthEast()]}});function fc(h,w){return new $d(h,w)}oo.create=Oa,oo.pointsToPath=Ue,Oi.geometryToLayer=Xa,Oi.coordsToLatLng=Cl,Oi.coordsToLatLngs=ys,Oi.latLngToCoords=mu,Oi.latLngsToCoords=El,Oi.getFeature=kr,Oi.asFeature=Ho,sr.mergeOptions({boxZoom:!0});var Hs=Ri.extend({initialize:function(h){this._map=h,this._container=h._container,this._pane=h._panes.overlayPane,this._resetStateTimeout=0,h.on("unload",this._destroy,this)},addHooks:function(){Gt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Tr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){cr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(h){if(!h.shiftKey||h.which!==1&&h.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),rr(),ec(),this._startPoint=this._map.mouseEventToContainerPoint(h),Gt(document,{contextmenu:_n,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(h){this._moved||(this._moved=!0,this._box=ot("div","leaflet-zoom-box",this._container),Tt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(h);var w=new G(this._point,this._startPoint),P=w.getSize();bn(this._box,w.min),this._box.style.width=P.x+"px",this._box.style.height=P.y+"px"},_finish:function(){this._moved&&(cr(this._box),yr(this._container,"leaflet-crosshair")),zs(),tc(),Tr(document,{contextmenu:_n,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(h){if(!(h.which!==1&&h.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(s(this._resetState,this),0);var w=new ne(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(w).fire("boxzoomend",{boxZoomBounds:w})}},_onKeyDown:function(h){h.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});sr.addInitHook("addHandler","boxZoom",Hs),sr.mergeOptions({doubleClickZoom:!0});var Kd=Ri.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(h){var w=this._map,P=w.getZoom(),U=w.options.zoomDelta,J=h.originalEvent.shiftKey?P-U:P+U;w.options.doubleClickZoom==="center"?w.setZoom(J):w.setZoomAround(h.containerPoint,J)}});sr.addInitHook("addHandler","doubleClickZoom",Kd),sr.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var yu=Ri.extend({addHooks:function(){if(!this._draggable){var h=this._map;this._draggable=new on(h._mapPane,h._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),h.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),h.on("zoomend",this._onZoomEnd,this),h.whenReady(this._onZoomEnd,this))}Tt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){yr(this._map._container,"leaflet-grab"),yr(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var h=this._map;if(h._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var w=de(this._map.options.maxBounds);this._offsetLimit=te(this._map.latLngToContainerPoint(w.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(w.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;h.fire("movestart").fire("dragstart"),h.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(h){if(this._map.options.inertia){var w=this._lastTime=+new Date,P=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(P),this._times.push(w),this._prunePositions(w)}this._map.fire("move",h).fire("drag",h)},_prunePositions:function(h){for(;this._positions.length>1&&h-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var h=this._map.getSize().divideBy(2),w=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=w.subtract(h).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(h,w){return h-(h-w)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var h=this._draggable._newPos.subtract(this._draggable._startPos),w=this._offsetLimit;h.x<w.min.x&&(h.x=this._viscousLimit(h.x,w.min.x)),h.y<w.min.y&&(h.y=this._viscousLimit(h.y,w.min.y)),h.x>w.max.x&&(h.x=this._viscousLimit(h.x,w.max.x)),h.y>w.max.y&&(h.y=this._viscousLimit(h.y,w.max.y)),this._draggable._newPos=this._draggable._startPos.add(h)}},_onPreDragWrap:function(){var h=this._worldWidth,w=Math.round(h/2),P=this._initialWorldOffset,U=this._draggable._newPos.x,J=(U-w+P)%h+w-P,le=(U+w+P)%h-w-P,we=Math.abs(J+P)<Math.abs(le+P)?J:le;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=we},_onDragEnd:function(h){var w=this._map,P=w.options,U=!P.inertia||h.noInertia||this._times.length<2;if(w.fire("dragend",h),U)w.fire("moveend");else{this._prunePositions(+new Date);var J=this._lastPos.subtract(this._positions[0]),le=(this._lastTime-this._times[0])/1e3,we=P.easeLinearity,Me=J.multiplyBy(we/le),Le=Me.distanceTo([0,0]),$e=Math.min(P.inertiaMaxSpeed,Le),pt=Me.multiplyBy($e/Le),Dt=$e/(P.inertiaDeceleration*we),Xt=pt.multiplyBy(-Dt/2).round();!Xt.x&&!Xt.y?w.fire("moveend"):(Xt=w._limitOffset(Xt,w.options.maxBounds),$(function(){w.panBy(Xt,{duration:Dt,easeLinearity:we,noMoveStart:!0,animate:!0})}))}}});sr.addInitHook("addHandler","dragging",yu),sr.mergeOptions({keyboard:!0,keyboardPanDelta:80});var pc=Ri.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(h){this._map=h,this._setPanDelta(h.options.keyboardPanDelta),this._setZoomDelta(h.options.zoomDelta)},addHooks:function(){var h=this._map._container;h.tabIndex<=0&&(h.tabIndex="0"),Gt(h,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Tr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var h=document.body,w=document.documentElement,P=h.scrollTop||w.scrollTop,U=h.scrollLeft||w.scrollLeft;this._map._container.focus(),window.scrollTo(U,P)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(h){var w=this._panKeys={},P=this.keyCodes,U,J;for(U=0,J=P.left.length;U<J;U++)w[P.left[U]]=[-1*h,0];for(U=0,J=P.right.length;U<J;U++)w[P.right[U]]=[h,0];for(U=0,J=P.down.length;U<J;U++)w[P.down[U]]=[0,h];for(U=0,J=P.up.length;U<J;U++)w[P.up[U]]=[0,-1*h]},_setZoomDelta:function(h){var w=this._zoomKeys={},P=this.keyCodes,U,J;for(U=0,J=P.zoomIn.length;U<J;U++)w[P.zoomIn[U]]=h;for(U=0,J=P.zoomOut.length;U<J;U++)w[P.zoomOut[U]]=-h},_addHooks:function(){Gt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Tr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(h){if(!(h.altKey||h.ctrlKey||h.metaKey)){var w=h.keyCode,P=this._map,U;if(w in this._panKeys){if(!P._panAnim||!P._panAnim._inProgress)if(U=this._panKeys[w],h.shiftKey&&(U=re(U).multiplyBy(3)),P.options.maxBounds&&(U=P._limitOffset(re(U),P.options.maxBounds)),P.options.worldCopyJump){var J=P.wrapLatLng(P.unproject(P.project(P.getCenter()).add(U)));P.panTo(J)}else P.panBy(U)}else if(w in this._zoomKeys)P.setZoom(P.getZoom()+(h.shiftKey?3:1)*this._zoomKeys[w]);else if(w===27&&P._popup&&P._popup.options.closeOnEscapeKey)P.closePopup();else return;_n(h)}}});sr.addInitHook("addHandler","keyboard",pc),sr.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Pr=Ri.extend({addHooks:function(){Gt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Tr(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(h){var w=ms(h),P=this._map.options.wheelDebounceTime;this._delta+=w,this._lastMousePos=this._map.mouseEventToContainerPoint(h),this._startTime||(this._startTime=+new Date);var U=Math.max(P-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(s(this._performZoom,this),U),_n(h)},_performZoom:function(){var h=this._map,w=h.getZoom(),P=this._map.options.zoomSnap||0;h._stop();var U=this._delta/(this._map.options.wheelPxPerZoomLevel*4),J=4*Math.log(2/(1+Math.exp(-Math.abs(U))))/Math.LN2,le=P?Math.ceil(J/P)*P:J,we=h._limitZoom(w+(this._delta>0?le:-le))-w;this._delta=0,this._startTime=null,we&&(h.options.scrollWheelZoom==="center"?h.setZoom(w+we):h.setZoomAround(this._lastMousePos,w+we))}});sr.addInitHook("addHandler","scrollWheelZoom",Pr);var mc=600;sr.mergeOptions({tapHold:yt.touchNative&&yt.safari&&yt.mobile,tapTolerance:15});var Ml=Ri.extend({addHooks:function(){Gt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Tr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(h){if(clearTimeout(this._holdTimeout),h.touches.length===1){var w=h.touches[0];this._startPos=this._newPos=new Q(w.clientX,w.clientY),this._holdTimeout=setTimeout(s(function(){this._cancel(),this._isTapValid()&&(Gt(document,"touchend",Wr),Gt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",w))},this),mc),Gt(document,"touchend touchcancel contextmenu",this._cancel,this),Gt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function h(){Tr(document,"touchend",Wr),Tr(document,"touchend touchcancel",h)},_cancel:function(){clearTimeout(this._holdTimeout),Tr(document,"touchend touchcancel contextmenu",this._cancel,this),Tr(document,"touchmove",this._onMove,this)},_onMove:function(h){var w=h.touches[0];this._newPos=new Q(w.clientX,w.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(h,w){var P=new MouseEvent(h,{bubbles:!0,cancelable:!0,view:window,screenX:w.screenX,screenY:w.screenY,clientX:w.clientX,clientY:w.clientY});P._simulated=!0,w.target.dispatchEvent(P)}});sr.addInitHook("addHandler","tapHold",Ml),sr.mergeOptions({touchZoom:yt.touch,bounceAtZoomLimits:!0});var uo=Ri.extend({addHooks:function(){Tt(this._map._container,"leaflet-touch-zoom"),Gt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){yr(this._map._container,"leaflet-touch-zoom"),Tr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(h){var w=this._map;if(!(!h.touches||h.touches.length!==2||w._animatingZoom||this._zooming)){var P=w.mouseEventToContainerPoint(h.touches[0]),U=w.mouseEventToContainerPoint(h.touches[1]);this._centerPoint=w.getSize()._divideBy(2),this._startLatLng=w.containerPointToLatLng(this._centerPoint),w.options.touchZoom!=="center"&&(this._pinchStartLatLng=w.containerPointToLatLng(P.add(U)._divideBy(2))),this._startDist=P.distanceTo(U),this._startZoom=w.getZoom(),this._moved=!1,this._zooming=!0,w._stop(),Gt(document,"touchmove",this._onTouchMove,this),Gt(document,"touchend touchcancel",this._onTouchEnd,this),Wr(h)}},_onTouchMove:function(h){if(!(!h.touches||h.touches.length!==2||!this._zooming)){var w=this._map,P=w.mouseEventToContainerPoint(h.touches[0]),U=w.mouseEventToContainerPoint(h.touches[1]),J=P.distanceTo(U)/this._startDist;if(this._zoom=w.getScaleZoom(J,this._startZoom),!w.options.bounceAtZoomLimits&&(this._zoom<w.getMinZoom()&&J<1||this._zoom>w.getMaxZoom()&&J>1)&&(this._zoom=w._limitZoom(this._zoom)),w.options.touchZoom==="center"){if(this._center=this._startLatLng,J===1)return}else{var le=P._add(U)._divideBy(2)._subtract(this._centerPoint);if(J===1&&le.x===0&&le.y===0)return;this._center=w.unproject(w.project(this._pinchStartLatLng,this._zoom).subtract(le),this._zoom)}this._moved||(w._moveStart(!0,!1),this._moved=!0),Z(this._animRequest);var we=s(w._move,w,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=$(we,this,!0),Wr(h)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Z(this._animRequest),Tr(document,"touchmove",this._onTouchMove,this),Tr(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});sr.addInitHook("addHandler","touchZoom",uo),sr.BoxZoom=Hs,sr.DoubleClickZoom=Kd,sr.Drag=yu,sr.Keyboard=pc,sr.ScrollWheelZoom=Pr,sr.TapHold=Ml,sr.TouchZoom=uo,r.Bounds=G,r.Browser=yt,r.CRS=ie,r.Canvas=dc,r.Circle=Uo,r.CircleMarker=ja,r.Class=W,r.Control=zn,r.DivIcon=Pl,r.DivOverlay=Ii,r.DomEvent=yl,r.DomUtil=nr,r.Draggable=on,r.Evented=X,r.FeatureGroup=Li,r.GeoJSON=Oi,r.GridLayer=ei,r.Handler=Ri,r.Icon=la,r.ImageOverlay=xs,r.LatLng=me,r.LatLngBounds=ne,r.Layer=Ma,r.LayerGroup=vs,r.LineUtil=zo,r.Map=sr,r.Marker=hi,r.Mixin=fu,r.Path=Vs,r.Point=Q,r.PolyUtil=ef,r.Polygon=ua,r.Polyline=fi,r.Popup=so,r.PosAnimation=hu,r.Projection=sc,r.Rectangle=$d,r.Renderer=Qa,r.SVG=oo,r.SVGOverlay=Cn,r.TileLayer=La,r.Tooltip=mn,r.Transformation=ge,r.Util=O,r.VideoOverlay=Fr,r.bind=s,r.bounds=te,r.canvas=hc,r.circle=kl,r.circleMarker=Us,r.control=na,r.divIcon=cc,r.extend=i,r.featureGroup=oa,r.geoJSON=uc,r.geoJson=Di,r.gridLayer=ti,r.icon=lc,r.imageOverlay=ao,r.latLng=ye,r.latLngBounds=de,r.layerGroup=Fo,r.map=Qn,r.marker=Gd,r.point=re,r.polygon=Ra,r.polyline=nf,r.popup=Tl,r.rectangle=fc,r.setOptions=_,r.stamp=l,r.svg=lo,r.svgOverlay=Nl,r.tileLayer=vu,r.tooltip=Go,r.transformation=be,r.version=n,r.videoOverlay=kn;var Zd=window.L;r.noConflict=function(){return window.L=Zd,this},window.L=r}))})(ug,ug.exports)),ug.exports}var fd=cV();const jx=Wh(fd);function nS(t,e,r){return Object.freeze({instance:t,context:e,container:r})}function PM(t,e){return e==null?function(n,i){const a=ce.useRef();return a.current||(a.current=t(n,i)),a}:function(n,i){const a=ce.useRef();a.current||(a.current=t(n,i));const s=ce.useRef(n),{instance:o}=a.current;return ce.useEffect(function(){s.current!==n&&(e(o,n,s.current),s.current=n)},[o,n,i]),a}}function dV(t,e){ce.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){e.layerContainer?.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function hV(t){return function(r){const n=rS(),i=t(TM(r,n),n);return SM(n.map,r.attribution),NM(i.current,r.eventHandlers),dV(i.current,n),i}}function MM(t,e){const r=PM(t,e),n=hV(r);return sV(n)}function fV(t,e){const r=PM(t),n=lV(r,e);return oV(n)}function pV(t,e,r){e.bounds instanceof fd.LatLngBounds&&e.bounds!==r.bounds&&t.setBounds(e.bounds),e.opacity!=null&&e.opacity!==r.opacity&&t.setOpacity(e.opacity),e.zIndex!=null&&e.zIndex!==r.zIndex&&t.setZIndex(e.zIndex)}function mV(){return rS().map}const gV=MM(function({bounds:e,url:r,...n},i){const a=new fd.ImageOverlay(r,e,n);return nS(a,kM(i,{overlayContainer:a}))},function(e,r,n){if(pV(e,r,n),r.bounds!==n.bounds){const i=r.bounds instanceof fd.LatLngBounds?r.bounds:new fd.LatLngBounds(r.bounds);e.setBounds(i)}r.url!==n.url&&e.setUrl(r.url)});function I2(){return I2=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},I2.apply(this,arguments)}function vV({bounds:t,boundsOptions:e,center:r,children:n,className:i,id:a,placeholder:s,style:o,whenReady:l,zoom:u,...c},f){const[g]=ce.useState({className:i,id:a,style:o}),[v,x]=ce.useState(null);ce.useImperativeHandle(f,()=>v?.map??null,[v]);const _=ce.useCallback(N=>{if(N!==null&&v===null){const k=new fd.Map(N,c);r!=null&&u!=null?k.setView(r,u):t!=null&&k.fitBounds(t,e),l!=null&&k.whenReady(l),x(aV(k))}},[]);ce.useEffect(()=>()=>{v?.map.remove()},[v]);const S=v?er.createElement(EM,{value:v},n):s??null;return er.createElement("div",I2({},g,{ref:_}),S)}const yV=ce.forwardRef(vV),xV=MM(function({position:e,...r},n){const i=new fd.Marker(e,r);return nS(i,kM(n,{overlayContainer:i}))},function(e,r,n){r.position!==n.position&&e.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&e.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&e.setOpacity(r.opacity),e.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?e.dragging.enable():e.dragging.disable())}),bV=fV(function(e,r){const n=new fd.Popup(e,r.overlayContainer);return nS(n,r)},function(e,r,{position:n},i){ce.useEffect(function(){const{instance:s}=e;function o(u){u.popup===s&&(s.update(),i(!0))}function l(u){u.popup===s&&i(!1)}return r.map.on({popupopen:o,popupclose:l}),r.overlayContainer==null?(n!=null&&s.setLatLng(n),s.openOn(r.map)):r.overlayContainer.bindPopup(s),function(){r.map.off({popupopen:o,popupclose:l}),r.overlayContainer?.unbindPopup(),r.map.removeLayer(s)}},[e,r,i,n])});delete jx.Icon.Default.prototype._getIconUrl;jx.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const wV=(t="default")=>{const e=`
        <div class="custom-marker-icon marker-${t}">
            <span class="material-symbols-outlined" style="font-size: 18px; color: white;">
                ${_V(t)}
            </span>
        </div>
    `;return jx.divIcon({html:e,className:"custom-leaflet-marker",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]})},_V=t=>{const e={city:"location_city",dungeon:"castle",landmark:"place",battle:"swords",default:"location_on"};return e[t]||e.default},SV=({bounds:t})=>{const e=mV();return er.useEffect(()=>{t&&e.fitBounds(t)},[e,t]),null},kV=({mapImage:t,markers:e=[],onMarkerClick:r,imageWidth:n=1920,imageHeight:i=1080})=>{const a=ce.useMemo(()=>[[0,0],[i,n]],[n,i]),s=ce.useMemo(()=>[i/2,n/2],[n,i]),o=e.length>0?e:[];return p.jsxs("div",{className:"w-full h-full relative",children:[p.jsxs(yV,{center:s,zoom:0,minZoom:-2,maxZoom:3,crs:jx.CRS.Simple,style:{height:"100%",width:"100%",background:"#0a0a0c"},zoomControl:!0,attributionControl:!1,children:[t&&p.jsx(gV,{url:t,bounds:a,opacity:1}),p.jsx(SV,{bounds:a}),o.map((l,u)=>{const c=l.position||[i/2,n/2];return p.jsx(xV,{position:c,icon:wV(l.type),eventHandlers:{click:()=>{r&&r(l)}},children:p.jsx(bV,{children:p.jsxs("div",{className:"space-y-2",children:[p.jsx("h3",{className:"text-white font-bold",children:l.label||"Unnamed Location"}),l.description&&p.jsx("p",{className:"text-slate-400 text-sm",children:l.description}),l.entityId&&p.jsxs("a",{href:`#/entity/${l.entityId}`,className:"text-primary hover:underline text-sm inline-flex items-center gap-1",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"}),"View Details"]})]})})},l.id||u)})]}),o.length>0&&p.jsxs("div",{className:"absolute bottom-4 left-4 bg-surface-dark/90 backdrop-blur-xl border border-white/10 rounded-2xl p-4 max-w-xs z-[1000]",children:[p.jsxs("h4",{className:"text-white font-bold text-sm mb-2 flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-primary",children:"map"}),"Locations (",o.length,")"]}),p.jsxs("div",{className:"space-y-1 max-h-40 overflow-y-auto no-scrollbar",children:[o.slice(0,10).map((l,u)=>p.jsxs("div",{className:"text-xs text-slate-400 flex items-center gap-2 hover:text-white cursor-pointer transition-colors",onClick:()=>r&&r(l),children:[p.jsx("span",{className:"w-2 h-2 rounded-full bg-primary"}),l.label||`Location ${u+1}`]},l.id||u)),o.length>10&&p.jsxs("p",{className:"text-xs text-slate-500 italic",children:["+",o.length-10," more..."]})]})]})]})},CV=({map:t})=>{const[e,r]=ce.useState(null),n=t?.nombre||"Explorador de Mundo",i=t?.attributes||{};let a={};if(!i.bgImage&&t?.descripcion&&t?.descripcion.startsWith("{"))try{a=JSON.parse(t.descripcion)}catch{}const s=i.bgImage||a.bgImage||t?.iconUrl||null,o=i.markers||[],l=i.imageWidth||1920,u=i.imageHeight||1080,c=f=>{r(f),console.log("Marker clicked:",f)};return p.jsxs("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300 relative",children:[p.jsxs("main",{className:"flex-1 overflow-hidden relative group",children:[p.jsx("div",{className:"absolute inset-4 rounded-[2.5rem] overflow-hidden border border-white/5 shadow-2xl bg-surface-dark",children:s?p.jsx(kV,{mapImage:s,markers:o,onMarkerClick:c,imageWidth:l,imageHeight:u}):p.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500",children:p.jsxs("div",{className:"text-center space-y-4",children:[p.jsx("span",{className:"material-symbols-outlined text-6xl opacity-20",children:"map"}),p.jsx("p",{children:"Map Image Not Found"}),p.jsx("p",{className:"text-xs text-slate-600",children:"Upload a map image in the editor to get started"})]})})}),p.jsx("div",{className:"absolute top-8 left-8 z-[1000]",children:p.jsx(Rr,{className:"px-6 py-3 border-white/10",children:p.jsxs("h1",{className:"text-2xl font-black text-white tracking-tight flex items-center gap-3",children:[p.jsx("span",{className:"material-symbols-outlined text-primary",children:"public"}),n]})})}),p.jsxs("div",{className:"absolute top-8 right-8 z-[1000] flex gap-3",children:[p.jsx("button",{className:"size-12 rounded-xl bg-surface-dark/90 backdrop-blur-xl border border-white/10 flex items-center justify-center text-slate-400 hover:text-white hover:border-primary/50 transition-all shadow-lg",children:p.jsx("span",{className:"material-symbols-outlined",children:"fullscreen"})}),p.jsx("button",{className:"size-12 rounded-xl bg-surface-dark/90 backdrop-blur-xl border border-white/10 flex items-center justify-center text-slate-400 hover:text-white hover:border-primary/50 transition-all shadow-lg",children:p.jsx("span",{className:"material-symbols-outlined",children:"share"})})]})]}),p.jsx("aside",{className:`flex-none bg-surface-dark border-l border-white/5 transition-all duration-700 relative z-30 ${e?"w-96 p-8 opacity-100":"w-0 p-0 opacity-0 overflow-hidden"}`,children:e&&p.jsxs("div",{className:"flex flex-col h-full gap-8 animate-in slide-in-from-right-8 duration-500",children:[p.jsxs("header",{className:"space-y-6",children:[p.jsxs("div",{className:"relative aspect-[4/3] rounded-3xl overflow-hidden border border-white/10 shadow-xl group",children:[p.jsx("img",{src:"https://images.unsplash.com/photo-1533154683836-84ea7a0bc310?auto=format&fit=crop&w=500&q=80",alt:"Detail",className:"w-full h-full object-cover grayscale-[0.4] group-hover:grayscale-0 transition-all duration-700"}),p.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background-dark via-transparent to-transparent"}),p.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:p.jsx("button",{onClick:()=>r(null),className:"size-8 rounded-lg bg-black/40 border border-white/10 backdrop-blur-md text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})}),p.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[p.jsx("span",{className:"px-3 py-1 rounded bg-primary/20 text-primary border border-primary/20 text-[8px] font-black uppercase tracking-widest backdrop-blur-md",children:"Lugar"}),p.jsx("span",{className:"px-3 py-1 rounded bg-emerald-500/20 text-emerald-400 border border-emerald-500/20 text-[8px] font-black uppercase tracking-widest backdrop-blur-md",children:"Capital"})]})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsx("h2",{className:"text-3xl font-manrope font-black text-white tracking-tight leading-none",children:e.label||e.name}),p.jsx("button",{className:"text-slate-500 hover:text-white transition-colors p-2 rounded-xl hover:bg-white/5",children:p.jsx("span",{className:"material-symbols-outlined",children:"edit"})})]}),p.jsx("p",{className:"text-sm text-slate-400 leading-relaxed font-manrope",children:e.description||"No description available"})]})]}),p.jsxs("div",{className:"space-y-8 flex-1 overflow-y-auto no-scrollbar",children:[p.jsxs("section",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center px-1",children:[p.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Habitantes Clave"}),p.jsx("button",{className:"text-[10px] font-bold text-primary hover:underline transition-all",children:"Ver todos"})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsx(Y5,{name:"Lyra Ignis",role:"Gran Maga"}),p.jsx(Y5,{name:"Kaelen",role:"Capitn de la Guardia"})]})]}),p.jsxs("section",{className:"space-y-4",children:[p.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 px-1",children:"Eventos Relacionados"}),p.jsx(Rr,{className:"p-4 border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:p.jsxs("div",{className:"flex gap-4 items-center",children:[p.jsx("div",{className:"size-10 rounded-xl bg-amber-500/10 text-amber-500 border border-amber-500/20 flex items-center justify-center",children:p.jsx("span",{className:"material-symbols-outlined text-xl",children:"history_edu"})}),p.jsxs("div",{children:[p.jsx("h4",{className:"text-xs font-bold text-white group-hover:text-primary transition-colors",children:"El Asedio de Ceniza"}),p.jsx("p",{className:"text-[10px] text-slate-500 font-medium",children:"Hace 300 aos"})]})]})})]})]}),p.jsx("footer",{className:"pt-6 border-t border-white/5",children:p.jsx(rn,{variant:"primary",icon:"auto_stories",className:"w-full py-4 rounded-2xl shadow-xl shadow-primary/20",children:"Abrir en la Biblia"})})]})})]})},Y5=({name:t,role:e})=>p.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:[p.jsx(ty,{name:t,size:"sm",className:"border-white/10 group-hover:border-primary/50 transition-all"}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("h4",{className:"text-xs font-bold text-white truncate",children:t}),p.jsx("p",{className:"text-[10px] text-slate-500 font-medium truncate",children:e})]}),p.jsx("span",{className:"material-symbols-outlined text-slate-700 text-sm group-hover:text-white transition-colors",children:"chevron_right"})]}),EV=({maps:t,onSelect:e,onCreateNew:r,onClose:n})=>p.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-xl animate-in fade-in duration-300",children:p.jsx("div",{className:"w-full max-w-3xl animate-in zoom-in-95 duration-500",children:p.jsxs(Rr,{className:"overflow-hidden border-white/10 shadow-2xl",children:[p.jsxs("header",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:"material-symbols-outlined text-primary",children:"map"}),p.jsx("h2",{className:"text-xl font-manrope font-black text-white",children:"Cartografa del Proyecto"})]}),p.jsx("button",{onClick:n,className:"text-slate-500 hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),p.jsxs("div",{className:"p-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[60vh] overflow-y-auto custom-scrollbar",children:[p.jsxs("div",{onClick:r,className:"group p-6 rounded-2xl border-2 border-dashed border-white/5 hover:border-primary/50 hover:bg-primary/5 transition-all cursor-pointer flex flex-col items-center justify-center text-center gap-3",children:[p.jsx("div",{className:"size-12 rounded-full bg-primary/10 text-primary flex items-center justify-center group-hover:scale-110 transition-transform",children:p.jsx("span",{className:"material-symbols-outlined",children:"add"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-bold text-white",children:"Nuevo Mapa"}),p.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-tighter",children:"Crear desde cero"})]})]}),t.map(i=>{const a=i.attributes?.snapshotUrl||i.attributes?.bgImage||i.iconUrl;return p.jsxs("div",{onClick:()=>e(i),className:"group p-4 rounded-2xl bg-white/5 border border-white/5 hover:border-primary/50 hover:bg-white/10 transition-all cursor-pointer space-y-3",children:[p.jsx("div",{className:"aspect-video rounded-xl bg-surface-light border border-white/5 flex items-center justify-center overflow-hidden",children:a?p.jsx("img",{src:a,alt:i.nombre,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}):p.jsx("span",{className:"material-symbols-outlined text-4xl opacity-20 group-hover:opacity-40 transition-opacity",children:"image"})}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-sm font-bold text-white truncate",children:i.nombre}),p.jsxs("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-tighter",children:[i.attributes?.layers?.length||0," capas"]})]})]},i.id)})]}),p.jsx("footer",{className:"p-6 bg-white/[0.02] border-t border-white/5 flex justify-end",children:p.jsx("p",{className:"text-[10px] text-slate-600 font-bold uppercase tracking-widest",children:"Selecciona un mapa para cargar el visor"})})]})})}),NV=()=>{const{username:t,projectName:e}=ds(),r=Ga(),[n,i]=ce.useState("viewer"),[a,s]=ce.useState([]),[o,l]=ce.useState(null),[u,c]=ce.useState(!1),[f,g]=ce.useState(null);er.useEffect(()=>{v()},[]);const v=async()=>{try{const S=(await it.get("/world-bible/entities")).filter(N=>N.tipoEspecial==="map");s(S),S.length>0&&!o&&l(S[0])}catch(_){console.error("Error loading maps",_)}},x=async(_,S,N)=>{try{const k=await it.get("/world-bible/folders"),E=k.find(R=>R.nombre.toLowerCase().includes("map"))||k[0];if(!E){console.error("No folders available to create map");return}const T=await it.post("/world-bible/entities",{nombre:S,carpetaId:E.id,tipoEspecial:"map",categoria:"Location",descripcion:"",iconUrl:"",attributes:{mapType:"regional",layers:[]}});g(T.id),i("wizard"),c(!1),await v(),setTimeout(()=>{i("editor")},100)}catch(k){console.error("Error creating map:",k)}};return p.jsxs("div",{className:"flex-1 flex flex-col h-full bg-background-dark overflow-hidden",children:[n==="viewer"&&p.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[p.jsx("button",{onClick:()=>c(!0),className:"absolute right-12 bottom-12 z-50 size-16 rounded-3xl bg-primary text-white flex items-center justify-center shadow-2xl shadow-primary/40 hover:scale-110 active:scale-95 transition-all group",children:p.jsx("span",{className:"material-symbols-outlined text-3xl group-hover:rotate-90 transition-transform duration-300",children:"add"})}),p.jsx(CV,{map:o}),u&&p.jsx(EV,{maps:a,onSelect:_=>{l(_),c(!1)},onCreateNew:()=>{c(!1),i("wizard")},onClose:()=>c(!1)})]}),n==="wizard"&&p.jsx(iz,{onCancel:()=>i("viewer"),onCreate:x}),n==="editor"&&p.jsx(D2,{mode:f?"create":"edit",entityId:f,onBack:()=>{i("viewer"),g(null)},onSave:async()=>{await v(),f?r(`/local/${e}/entity/${f}`):i("viewer"),g(null)}})]})},TV=()=>{const[t,e]=ce.useState("Loading..."),[r,n]=ce.useState({words:0,rules:0,glyphs:0}),[i,a]=ce.useState("Standard Tongue");ce.useEffect(()=>{s()},[]);const s=async()=>{try{const o=await it.get("/bd/proyecto-activo");e(o.nombreProyecto);const l=await it.get("/conlang/stats");n(l);const u=await it.get("/conlang/lenguas");u&&u.length>0&&a(u[0].nombre)}catch(o){console.error("Error loading conlang data:",o),e("Default Project")}};return p.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#0a0a0f] text-slate-300 font-sans overflow-y-auto no-scrollbar p-12 lg:p-16 gap-16",children:[p.jsxs("header",{className:"space-y-6",children:[p.jsxs("nav",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-slate-500",children:[p.jsx("span",{children:t}),p.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),p.jsxs("span",{className:"text-white",children:["Conlang: ",i]})]}),p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsxs("div",{className:"space-y-4 max-w-2xl",children:[p.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:i}),p.jsxs("p",{className:"text-lg text-slate-400 leading-relaxed",children:["A conlang belonging to ",t,". Manage its lexicon, grammar rules, and writing systems here."]}),p.jsxs("div",{className:"flex gap-4 pt-2",children:[p.jsx("span",{className:"px-3 py-1 rounded bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[9px] font-black uppercase tracking-widest",children:"Complete: 45%"}),p.jsx("span",{className:"px-3 py-1 rounded bg-primary/10 text-primary border border-primary/20 text-[9px] font-black uppercase tracking-widest",children:"Type: Agglutinative"})]})]}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("div",{className:"flex items-center gap-3 text-slate-500 border-r border-white/5 pr-6 mr-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm animate-pulse text-emerald-500",children:"save"}),p.jsx("span",{className:"text-[10px] font-bold",children:"Auto-Saved"}),p.jsx("span",{className:"material-symbols-outlined hover:text-white transition-colors cursor-pointer",children:"dark_mode"})]}),p.jsx(rn,{variant:"primary",icon:"add",size:"md",children:"Create Element"})]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-12",children:[p.jsxs("section",{className:"xl:col-span-2 space-y-8",children:[p.jsxs("div",{className:"flex justify-between items-center px-2",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"menu_book"}),p.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Lexicon"})]}),p.jsxs("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest hover:text-primary transition-all cursor-pointer",children:["View All (",r.words,")"]})]}),p.jsxs(Rr,{className:"p-0 border-white/5 bg-surface-dark/40 overflow-hidden shadow-2xl",children:[p.jsxs("div",{className:"p-4 border-b border-white/5 flex items-center gap-4",children:[p.jsxs("div",{className:"flex-1 relative",children:[p.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 text-lg",children:"search"}),p.jsx("input",{type:"text",placeholder:"Search word or meaning...",className:"w-full bg-white/5 border border-white/5 rounded-2xl py-3 pl-12 pr-4 text-xs focus:ring-1 focus:ring-primary/30 outline-none transition-all"})]}),p.jsx("button",{className:"size-10 rounded-xl bg-white/5 border border-white/5 flex items-center justify-center text-slate-500 hover:text-white transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-xl",children:"tune"})})]}),p.jsxs("div",{className:"p-6 space-y-4",children:[p.jsx(Nw,{word:"Ael'or",type:"noun",gender:"neutral",def:"Starlight; specifically the light from the twin moons."}),p.jsx(Nw,{word:"Vexi",type:"verb",gender:"transitive",def:"To weave magic; to create something from nothing."}),p.jsx(Nw,{word:"Dra'kan",type:"adj",gender:"",def:"Ancient; belonging to the era of dragons."})]}),p.jsx("div",{className:"p-6 bg-black/20 border-t border-white/5",children:p.jsxs("button",{className:"w-full py-4 rounded-3xl border-2 border-dashed border-white/5 text-slate-600 hover:text-white hover:border-primary/50 hover:bg-primary/5 transition-all text-[10px] font-black uppercase tracking-[0.2em] flex items-center justify-center gap-3",children:[p.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Add New Word"]})})]})]}),p.jsxs("section",{className:"space-y-8",children:[p.jsxs("div",{className:"flex justify-between items-center px-2",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"architecture"}),p.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Grammar Rules"})]}),p.jsx("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest hover:text-primary transition-all cursor-pointer",children:"Manage"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx(X5,{title:"Sentence Structure",status:"active",statusColor:"emerald",desc:"Standard order is SOV (Subject-Object-Verb), but poetry uses VSO for emphasis on action.",tags:["Syntax","Basic"]}),p.jsx(X5,{title:"Noun Declensions",status:"pending",statusColor:"amber",desc:"Seven cases marked by suffixes. Pluralization shifts the stress to the final syllable.",tags:["Morphology"]}),p.jsxs("button",{className:"w-full h-32 rounded-[2.5rem] border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-2 text-slate-600 hover:text-white hover:border-primary/30 hover:bg-primary/5 transition-all",children:[p.jsx("span",{className:"material-symbols-outlined",children:"add_circle"}),p.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Define New Rule"})]})]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-12",children:[p.jsxs("section",{className:"space-y-8",children:[p.jsxs("div",{className:"flex justify-between items-center px-2",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"draw"}),p.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Writing System"})]}),p.jsxs("div",{className:"flex gap-2 text-slate-600",children:[p.jsx("button",{className:"p-1 rounded hover:bg-white/5 hover:text-white",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_view"})}),p.jsx("button",{className:"p-1 rounded hover:bg-white/5 hover:text-white",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"title"})})]})]}),p.jsxs(Rr,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-8 shadow-2xl",children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsxs("div",{children:[p.jsx("h4",{className:"text-2xl font-black text-white tracking-tight mb-1",children:"Moon Script"}),p.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Abugida  Left-to-Right"})]}),p.jsx(rn,{variant:"secondary",size:"sm",className:"bg-primary/10 border-primary/20 text-primary",children:"Open Editor"})]}),p.jsxs("div",{className:"grid grid-cols-6 gap-3",children:[["","","","",""].map(o=>p.jsx("div",{className:"aspect-square rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-3xl font-serif text-white hover:bg-white/10 transition-all cursor-pointer",children:o},o)),p.jsx("div",{className:"aspect-square rounded-2xl border-2 border-dashed border-white/5 flex items-center justify-center text-slate-600 hover:border-primary/50 hover:text-white transition-all cursor-pointer",children:p.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),p.jsxs("div",{className:"space-y-2",children:[p.jsxs("div",{className:"flex justify-between text-[8px] font-black uppercase tracking-widest text-slate-600",children:[p.jsx("span",{children:"Glyph Set"}),p.jsx("span",{children:"24/32 Completed"})]}),p.jsx("div",{className:"h-1.5 w-full bg-white/5 rounded-full overflow-hidden",children:p.jsx("div",{className:"h-full bg-primary w-[75%] rounded-full shadow-[0_0_10px_rgba(99,102,242,0.5)]"})})]})]})]}),p.jsxs("section",{className:"space-y-8",children:[p.jsxs("div",{className:"flex items-center gap-3 px-2",children:[p.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"graphic_eq"}),p.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Translator & Phonology"})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[p.jsxs(Rr,{className:"p-8 border-primary/20 bg-primary/5 rounded-[3rem] space-y-6 shadow-2xl shadow-primary/10",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary",children:"Live Logographic Stream"}),p.jsx("span",{className:"material-symbols-outlined text-primary animate-pulse",children:"sync_alt"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("input",{type:"text",placeholder:"Source text here...",className:"w-full bg-black/40 border border-white/10 rounded-2xl p-4 text-xs font-bold text-white focus:border-primary/50 outline-none transition-all"}),p.jsxs("div",{className:"h-24 rounded-2xl bg-black/60 border border-white/5 flex items-center justify-center relative overflow-hidden group",children:[p.jsx("span",{className:"text-5xl font-serif text-white opacity-40 group-hover:opacity-100 transition-opacity",children:"   "}),p.jsx("div",{className:"absolute top-2 right-4 text-[7px] font-black uppercase tracking-widest text-slate-700",children:"Rendered Output"})]})]})]}),p.jsxs(Rr,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-6",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Vowel Inventory"}),p.jsx("button",{className:"text-primary text-lg",children:p.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),p.jsx("div",{className:"flex flex-wrap gap-2",children:["/a/","/e/","/i/","/o/","/u/","/y/"].map(o=>p.jsx("div",{className:"px-3 py-1.5 rounded-xl bg-white/5 border border-white/5 text-[11px] font-mono font-bold text-slate-300 hover:text-white transition-colors cursor-pointer",children:o},o))})]}),p.jsxs(Rr,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-6",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Vector Symbols"}),p.jsx("button",{className:"text-[8px] font-bold text-primary hover:underline transition-all",children:"Upload SVG"})]}),p.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[[{id:1,icon:"filter_vintage"},{id:2,icon:"auto_awesome"},{id:3,icon:"infinite"}].map(o=>p.jsx("div",{className:"aspect-square rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-slate-400 hover:text-white transition-all cursor-pointer",children:p.jsx("span",{className:"material-symbols-outlined text-2xl",children:o.icon})},o.id)),p.jsxs("div",{className:"aspect-square rounded-2xl border-2 border-dashed border-white/5 flex flex-col items-center justify-center text-slate-700 hover:border-primary/50 hover:text-white transition-all cursor-pointer",children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:"cloud_upload"}),p.jsx("span",{className:"text-[7px] font-bold uppercase mt-1",children:"Add"})]})]})]})]})]})]})]})},Nw=({word:t,type:e,gender:r,def:n})=>p.jsxs("div",{className:"p-4 rounded-2xl border border-transparent hover:bg-white/5 hover:border-white/5 transition-all group cursor-pointer relative",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[p.jsx("h4",{className:"text-xl font-manrope font-black text-white group-hover:text-primary transition-colors",children:t}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("span",{className:"text-[9px] font-bold text-slate-600 italic",children:e}),r&&p.jsxs("span",{className:"text-[9px] font-bold text-slate-700 uppercase",children:["(",r,")"]})]})]}),p.jsx("p",{className:"text-sm text-slate-400 leading-relaxed font-manrope",children:n}),p.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity p-2 text-slate-600 hover:text-white",children:p.jsx("span",{className:"material-symbols-outlined",children:"edit_note"})})]}),X5=({title:t,status:e,statusColor:r,desc:n,tags:i})=>p.jsxs(Rr,{className:"p-8 border-white/5 hover:border-white/10 transition-all cursor-pointer group space-y-4",children:[p.jsxs("header",{className:"flex justify-between items-start",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`size-2 rounded-full bg-${r}-500 shadow-[0_0_10px_rgba(var(--${r}-rgb),0.5)]`}),p.jsx("h4",{className:"font-bold text-white group-hover:text-primary transition-colors",children:t})]}),p.jsx("button",{className:"text-slate-700 hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})]}),p.jsx("p",{className:"text-[11px] text-slate-500 leading-relaxed font-manrope",children:n}),p.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(a=>p.jsx("span",{className:"px-2 py-0.5 rounded bg-white/5 border border-white/5 text-[8px] font-black uppercase tracking-widest text-slate-600",children:a},a))})]}),PV=()=>p.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#050B0D] text-[#00E5FF] font-mono overflow-hidden",children:[p.jsxs("header",{className:"h-20 border-b border-[#00E5FF]/20 flex items-center justify-between px-10 bg-black/40 backdrop-blur-xl",children:[p.jsxs("div",{className:"flex items-center gap-10",children:[p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:"text-[10px] opacity-40 uppercase tracking-[0.4em] font-bold",children:"Datastream_Nav"}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:"material-symbols-outlined text-2xl",children:"language"}),p.jsx("span",{className:"text-2xl font-black italic tracking-tighter",children:"Chronos Atlas"})]})]}),p.jsxs("div",{className:"flex items-center gap-4 border-l border-[#00E5FF]/20 pl-10",children:[p.jsx("span",{className:"text-3xl font-black tracking-[0.2em] italic opacity-80",children:"DIGITAL RUNE COMPILER"}),p.jsx("div",{className:"px-3 py-1 rounded-sm bg-[#00E5FF]/10 border border-[#00E5FF]/30 text-[10px] font-black uppercase tracking-widest animate-pulse",children:"Data Ready"})]})]}),p.jsxs("div",{className:"flex items-center gap-8",children:[p.jsxs("div",{className:"flex items-center gap-2 opacity-60 hover:opacity-100 transition-opacity cursor-pointer",children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:"help"}),p.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Protocol"})]}),p.jsxs("button",{className:"flex items-center gap-3 px-6 py-2.5 bg-[#00E5FF] text-black font-black uppercase text-xs tracking-widest rounded-sm hover:shadow-[0_0_20px_rgba(0,229,255,0.4)] transition-all",children:[p.jsx("span",{className:"material-symbols-outlined",children:"save"}),"Commit Data"]}),p.jsx("div",{className:"size-10 rounded-full bg-gradient-to-tr from-[#00E5FF] to-blue-600 border border-white/20 shadow-lg"})]})]}),p.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[p.jsxs("main",{className:"flex-1 flex flex-col p-12 gap-12 overflow-y-auto no-scrollbar relative",children:[p.jsx("div",{className:"absolute top-0 left-0 w-full h-[2px] bg-white/5 overflow-hidden",children:p.jsx("div",{className:"h-full bg-[#00E5FF] w-[64%] shadow-[0_0_10px_#00E5FF]"})}),p.jsxs("section",{className:"space-y-6",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"size-2 bg-[#00E5FF] rounded-full shadow-[0_0_10px_#00E5FF]"}),p.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.4em]",children:"Glyph Set (Scan)"})]}),p.jsxs("div",{className:"flex gap-4 opacity-40",children:[p.jsx("span",{className:"material-symbols-outlined text-xl",children:"grid_view"}),p.jsx("span",{className:"material-symbols-outlined text-xl",children:"view_list"})]})]}),p.jsxs("div",{className:"p-10 rounded-sm border border-[#00E5FF]/10 bg-[#00E5FF]/[0.02] grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-6",children:[p.jsx(ql,{symbol:"",keyLabel:"A"}),p.jsx(ql,{symbol:"",keyLabel:"B"}),p.jsx(ql,{symbol:"",keyLabel:"C"}),p.jsx(ql,{symbol:"",keyLabel:"D",active:!0}),p.jsx(ql,{}),p.jsx(ql,{}),p.jsx(ql,{}),p.jsx(ql,{}),p.jsx(ql,{}),p.jsx(ql,{}),p.jsx("div",{className:"aspect-square rounded shadow-inner border border-dashed border-[#00E5FF]/20 flex items-center justify-center hover:bg-[#00E5FF]/5 transition-colors cursor-pointer group",children:p.jsx("span",{className:"material-symbols-outlined opacity-20 group-hover:opacity-100 transition-opacity",children:"add"})})]}),p.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-[0.2em] opacity-40",children:[p.jsx("span",{children:"26 Glyphs Mapped"}),p.jsxs("div",{className:"flex gap-10",children:[p.jsxs("button",{className:"hover:text-[#00E5FF] flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"tune"})," Manage"]}),p.jsxs("button",{className:"hover:text-[#00E5FF] flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"settings_input_component"})," Ranges"]})]})]})]}),p.jsxs("section",{className:"flex-1 flex flex-col gap-6",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"size-2 bg-[#00E5FF] rounded-full shadow-[0_0_10px_#00E5FF] opacity-40"}),p.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.4em] opacity-40",children:"Live Preview Stream"})]}),p.jsxs("div",{className:"flex-1 rounded-sm border border-[#00E5FF]/10 bg-black/40 flex flex-col p-12 items-center justify-center relative group min-h-[300px]",children:[p.jsx("div",{className:"absolute top-4 left-4 text-[8px] opacity-20 uppercase tracking-widest font-black",children:"Buffer Status: Active"}),p.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none text-center text-7xl font-bold tracking-widest text-[#00E5FF]/10 group-hover:text-[#00E5FF]/40 transition-all placeholder:text-[#00E5FF]/5 resize-none italic",placeholder:"Input your data stream here..."}),p.jsxs("div",{className:"absolute bottom-6 right-8 flex gap-6 text-[8px] font-black uppercase tracking-widest opacity-20",children:[p.jsx("span",{children:"48px"}),p.jsx("span",{children:"Regular"}),p.jsx("span",{children:"UTF-8"})]}),p.jsx("div",{className:"absolute inset-x-12 top-1/2 h-px bg-[#00E5FF]/10 -translate-y-1/2 pointer-events-none"})]})]})]}),p.jsxs("aside",{className:"w-[450px] border-l border-[#00E5FF]/10 p-10 flex flex-col gap-10 bg-black/40 backdrop-blur-xl relative z-20",children:[p.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.4em] opacity-60 mb-2",children:"Configuration Matrix"}),p.jsxs(Rr,{className:"p-8 border-[#00E5FF]/20 bg-[#00E5FF]/[0.02] space-y-8 rounded-sm",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Font Name"}),p.jsx("input",{type:"text",defaultValue:"NEURALINK CIPHER",className:"w-full bg-black/60 border border-[#00E5FF]/30 px-6 py-4 text-xs font-black text-[#00E5FF] focus:border-[#00E5FF] outline-none transition-all tracking-widest uppercase italic"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Author / Metadata"}),p.jsx("input",{type:"text",placeholder:"YOUR SYNTHETIC ID",className:"w-full bg-black/60 border border-[#00E5FF]/30 px-6 py-4 text-xs font-black text-[#00E5FF] focus:border-[#00E5FF] outline-none transition-all tracking-widest uppercase italic"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Format"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsx("button",{className:"py-4 border border-[#00E5FF] bg-[#00E5FF]/10 text-[#00E5FF] text-xs font-black tracking-widest shadow-[0_0_15px_rgba(0,229,255,0.2)]",children:".TTF"}),p.jsx("button",{className:"py-4 border border-[#00E5FF]/20 text-[#00E5FF]/40 text-xs font-black tracking-widest hover:border-[#00E5FF]/40 transition-all",children:".OTF"})]})]}),p.jsxs("div",{className:"pt-4 space-y-6",children:[p.jsx(Q5,{label:"Ligatures",active:!0}),p.jsx(Q5,{label:"Kerning",active:!0})]}),p.jsxs("button",{className:"w-full py-6 mt-6 bg-gradient-to-r from-blue-600 to-fuchsia-500 text-white font-black uppercase text-xs tracking-[0.3em] flex items-center justify-center gap-4 hover:shadow-[0_0_30px_rgba(255,0,255,0.3)] transition-all animate-pulse",children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Compile & Download"]})]}),p.jsxs("div",{className:"flex-1 flex flex-col gap-6 opacity-30 pointer-events-none",children:[p.jsxs("div",{className:"flex justify-between text-[10px] uppercase font-black",children:[p.jsx("span",{children:"Compiler Logs"}),p.jsx("span",{children:"V2.0.4"})]}),p.jsxs("div",{className:"flex-1 border border-[#00E5FF]/10 bg-black/20 p-6 flex flex-col font-mono text-[9px] gap-2 overflow-hidden",children:[p.jsx("p",{children:"[SCN] Initializing Glyph Buffer..."}),p.jsx("p",{children:"[MAP] Vector data detected for U+0394"}),p.jsx("p",{children:"[SYS] Memory allocation optimized"}),p.jsx("p",{className:"animate-pulse",children:"_"})]})]})]})]})]}),ql=({symbol:t,keyLabel:e,active:r})=>p.jsxs("div",{className:`aspect-square rounded border transition-all cursor-pointer flex items-center justify-center relative group ${r?"bg-[#00E5FF]/20 border-[#00E5FF] shadow-[0_0_20px_rgba(0,229,255,0.3)]":"bg-black/40 border-[#00E5FF]/10 hover:border-[#00E5FF]/40"}`,children:[p.jsx("span",{className:`text-3xl font-serif ${r?"text-white":"opacity-20 group-hover:opacity-60"}`,children:t||"..."}),e&&p.jsx("span",{className:`absolute top-1 right-1 text-[8px] font-black uppercase ${r?"text-[#00E5FF]/80":"opacity-20"}`,children:e})]}),Q5=({label:t,active:e})=>p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-60",children:t}),p.jsx("button",{className:`w-12 h-6 rounded-full p-1 transition-colors relative ${e?"bg-[#00E5FF]/40":"bg-white/5"}`,children:p.jsx("div",{className:`size-4 rounded-full bg-[#00E5FF] shadow-[0_0_10px_#00E5FF] transition-transform ${e?"translate-x-6":"translate-x-0"}`})})]}),MV=({onBack:t,onSave:e})=>{const[r,n]=ce.useState(4),[i,a]=ce.useState("curve"),[s,o]=ce.useState(1),l=[{id:"select",icon:"near_me"},{id:"curve",icon:"gesture"},{id:"eraser",icon:"ink_eraser"},{id:"line",icon:"horizontal_rule"},{id:"shape",icon:"pentagon"},{id:"text",icon:"title"}],u=[{id:1,name:"Trazo Principal",type:"Vector",locked:!0,visible:!0},{id:2,name:"Detalles Secundarios",type:"Vector",locked:!0,visible:!0},{id:3,name:"Boceto Ref.",type:"Imagen (Raster)",locked:!0,visible:!1}];return p.jsxs("div",{className:"flex-1 flex flex-col bg-[#0a0a0f] text-slate-300 font-sans h-full overflow-hidden relative",children:[p.jsxs("header",{className:"h-20 flex-none border-b border-white/5 flex items-center justify-between px-8 bg-surface-dark/80 backdrop-blur-md z-30",children:[p.jsxs("div",{className:"flex items-center gap-6",children:[p.jsx("button",{onClick:t,className:"p-2 rounded-xl bg-white/5 hover:bg-white/10 transition-colors",children:p.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),p.jsx("div",{className:"w-px h-8 bg-white/10"}),p.jsxs("div",{children:[p.jsxs("nav",{className:"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-slate-500 mb-0.5",children:[p.jsx("span",{children:"Idiomas"}),p.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),p.jsx("span",{className:"text-white",children:"Editor Grfico"})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("div",{className:"flex items-center gap-4 text-slate-500",children:[p.jsx("button",{className:"hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-xl",children:"undo"})}),p.jsx("button",{className:"hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-xl",children:"redo"})})]}),p.jsx("div",{className:"w-px h-4 bg-white/10 mx-2"}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{className:"p-1 rounded hover:bg-white/5 text-slate-500 hover:text-white",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_on"})}),p.jsx("button",{className:"p-1 rounded bg-white/10 text-primary",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})})]})]})]})]}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("button",{className:"flex items-center gap-2 px-6 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 transition-all text-xs font-black uppercase tracking-widest text-slate-400",children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Exportar SVG"]}),p.jsx(rn,{variant:"primary",icon:"save",className:"px-8 py-3 shadow-xl shadow-primary/30",onClick:e,children:"Guardar Glifo"}),p.jsx("div",{className:"size-10 rounded-full bg-gradient-to-br from-primary to-orange-400 border-2 border-white/10 shadow-lg ml-2"})]})]}),p.jsxs("div",{className:"flex-1 flex relative overflow-hidden",children:[p.jsxs("aside",{className:"h-full w-20 flex-none border-r border-white/5 bg-surface-dark/40 backdrop-blur-xl flex flex-col items-center py-6 gap-2 z-40",children:[l.map(c=>p.jsx("button",{onClick:()=>a(c.id),className:`size-12 rounded-2xl flex items-center justify-center transition-all ${i===c.id?"bg-primary text-white shadow-lg shadow-primary/30":"text-slate-600 hover:text-white hover:bg-white/5"}`,children:p.jsx("span",{className:"material-symbols-outlined text-2xl",children:c.icon})},c.id)),p.jsx("div",{className:"flex-1"}),p.jsx("button",{className:"size-12 rounded-2xl flex items-center justify-center text-slate-600 hover:text-white transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-2xl",children:"add_photo_alternate"})}),p.jsx("button",{className:"size-12 rounded-2xl flex items-center justify-center text-slate-600 hover:text-white transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-2xl",children:"settings"})})]}),p.jsxs("main",{className:"flex-1 bg-[#050508] relative overflow-hidden flex items-center justify-center no-scrollbar",children:[p.jsx("div",{className:"absolute inset-x-20 top-1/2 h-px bg-red-500/20 pointer-events-none"}),p.jsxs("div",{className:"relative group animate-in zoom-in-95 duration-700",children:[p.jsx("div",{className:"absolute inset-x-0 top-10 h-px bg-white/10"}),p.jsx("div",{className:"absolute inset-x-0 bottom-10 h-px bg-white/10"}),p.jsxs("div",{className:"w-[600px] h-[600px] border border-white/5 rounded-3xl bg-black/40 flex items-center justify-center relative overflow-hidden",children:[p.jsxs("svg",{width:"400",height:"400",className:"drop-shadow-[0_0_20px_rgba(99,102,242,0.5)] scale-125",children:[p.jsx("circle",{cx:"200",cy:"230",r:"100",fill:"none",stroke:"#6366f1",strokeWidth:"6",strokeLinecap:"round"}),p.jsx("line",{x1:"200",y1:"230",x2:"200",y2:"380",stroke:"#6366f1",strokeWidth:"6",strokeLinecap:"round"}),p.jsx("circle",{cx:"200",cy:"230",r:"4",fill:"white"}),p.jsx("rect",{x:"196",y:"376",width:"8",height:"8",fill:"white"}),p.jsx("rect",{x:"96",y:"226",width:"8",height:"8",fill:"#6366f1"}),p.jsx("rect",{x:"296",y:"226",width:"8",height:"8",fill:"#6366f1"}),p.jsx("rect",{x:"136",y:"160",width:"6",height:"6",fill:"#6366f1",className:"opacity-40"}),p.jsx("rect",{x:"256",y:"160",width:"6",height:"6",fill:"#6366f1",className:"opacity-40"})]}),p.jsx("div",{className:"absolute top-[160px] left-[136px] size-1 border border-primary/40 border-dashed w-[20px] h-[100px] pointer-events-none"}),p.jsx("div",{className:"absolute top-[160px] right-[136px] size-1 border border-primary/40 border-dashed w-[20px] h-[100px] pointer-events-none"})]})]}),p.jsx("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2",children:p.jsxs(Rr,{className:"px-6 py-2.5 flex items-center gap-6 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[p.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"remove"})}),p.jsx("span",{className:"text-[10px] font-black text-white w-12 text-center uppercase tracking-widest",children:"120%"}),p.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-lg",children:"add"})})]})})]}),p.jsxs("aside",{className:"w-96 flex-none flex flex-col p-10 gap-10 bg-surface-dark/20 backdrop-blur-xl border-l border-white/5 z-40 overflow-y-auto no-scrollbar",children:[p.jsxs("section",{className:"space-y-6",children:[p.jsxs("header",{className:"flex justify-between items-center group cursor-pointer",children:[p.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Propiedades"}),p.jsx("span",{className:"material-symbols-outlined text-slate-700 text-sm",children:"more_horiz"})]}),p.jsxs(Rr,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[2rem] space-y-8",children:[p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Grosor de Trazo"}),p.jsxs("span",{className:"px-2 py-0.5 rounded bg-white/5 text-[10px] font-black text-white",children:[r,"px"]})]}),p.jsx("input",{type:"range",min:"1",max:"20",value:r,onChange:c=>n(c.target.value),className:"w-full accent-primary h-1 bg-white/5 rounded-full appearance-none cursor-pointer"})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 block ml-1",children:"Color / Relleno"}),p.jsxs("div",{className:"flex items-center gap-4 bg-black/40 rounded-2xl p-4 border border-white/5",children:[p.jsx("div",{className:"size-10 rounded-full bg-primary shadow-[0_0_15px_rgba(99,102,242,0.4)] border-2 border-white/20"}),p.jsx("input",{type:"text",defaultValue:"#2F2CED",className:"bg-transparent border-none outline-none text-xs font-mono text-slate-300 w-full"})]})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 block ml-1",children:"Terminacin (Cap)"}),p.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[p.jsx(Tw,{icon:"square"}),p.jsx(Tw,{icon:"circle",active:!0}),p.jsx(Tw,{icon:"rectangle"})]})]}),p.jsxs("button",{className:"w-full py-4 rounded-2xl bg-white/5 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-3 hover:bg-white/10 transition-all",children:[p.jsx("span",{className:"material-symbols-outlined text-lg",children:"gesture"}),"Suavizar Trazo"]})]})]}),p.jsxs("section",{className:"flex-1 flex flex-col gap-6",children:[p.jsxs("header",{className:"flex justify-between items-center",children:[p.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Capas"}),p.jsx("button",{className:"p-1 rounded bg-white/5 text-slate-500 hover:text-white transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})]}),p.jsx("div",{className:"space-y-3 overflow-y-auto no-scrollbar flex-1",children:u.map(c=>p.jsxs("div",{onClick:()=>o(c.id),className:`flex items-center gap-4 p-4 rounded-2xl transition-all cursor-pointer group ${s===c.id?"bg-primary/10 border border-primary/20":"bg-white/[0.02] border border-white/5 opacity-60 hover:opacity-100 hover:border-white/10"}`,children:[p.jsx("button",{className:"material-symbols-outlined text-sm text-slate-500 hover:text-white",children:c.visible?"visibility":"visibility_off"}),p.jsx("div",{className:"size-10 rounded-xl bg-black border border-white/10 flex items-center justify-center",children:p.jsx("span",{className:"material-symbols-outlined text-slate-600 group-hover:text-primary transition-colors text-xl",children:c.type.includes("Vector")?"timeline":"image"})}),p.jsxs("div",{className:"flex-1 min-w-0",children:[p.jsx("h4",{className:"text-xs font-bold text-white truncate",children:c.name}),p.jsx("p",{className:"text-[9px] text-slate-600 font-bold uppercase tracking-widest",children:c.type})]}),p.jsx("button",{className:"material-symbols-outlined text-slate-700 text-sm",children:"lock"})]},c.id))}),p.jsxs("div",{className:"flex gap-4 p-3 rounded-2xl bg-black/20 border border-white/5",children:[p.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})}),p.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-xl",children:"content_copy"})}),p.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-xl",children:"folder"})})]})]}),p.jsxs("div",{className:"p-6 rounded-[2rem] bg-gradient-to-br from-primary/20 to-orange-500/20 border border-white/10 space-y-4",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:"material-symbols-outlined text-primary",children:"auto_fix_high"}),p.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-white",children:"Vectorizacin Inteligente"})]}),p.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-manrope",children:"Arrastra una imagen para convertirla automticamente en nodos editables."}),p.jsx(rn,{variant:"primary",size:"sm",className:"w-full text-[9px] py-3 rounded-xl shadow-lg",children:"Importar y Procesar"})]})]})]})]})},Tw=({icon:t,active:e})=>p.jsx("button",{className:`py-4 rounded-xl border transition-all flex items-center justify-center ${e?"bg-primary/20 border-primary shadow-lg shadow-primary/20":"bg-white/5 border-white/5 hover:border-white/10"}`,children:p.jsx("span",{className:`material-symbols-outlined text-lg ${e?"text-white":"text-slate-600"}`,children:t})}),AV=()=>{const[t,e]=ce.useState("hub");return p.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#050508] overflow-hidden",children:[t==="hub"&&p.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[p.jsx("button",{onClick:()=>e("foundry"),className:"absolute right-12 bottom-12 z-50 size-16 rounded-3xl bg-primary text-white flex items-center justify-center shadow-2xl shadow-primary/40 hover:scale-110 active:scale-95 transition-all group",title:"Glyph Foundry",children:p.jsx("span",{className:"material-symbols-outlined text-3xl group-hover:rotate-12 transition-transform duration-300",children:"font_download"})}),p.jsx(TV,{onOpenEditor:()=>e("editor")})]}),t==="foundry"&&p.jsx(PV,{onBack:()=>e("hub")}),t==="editor"&&p.jsx(MV,{onBack:()=>e("hub"),onSave:()=>e("hub")})]})};var Pw={exports:{}},Mw={};var J5;function jV(){if(J5)return Mw;J5=1;var t=Sp();function e(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,i=t.useEffect,a=t.useLayoutEffect,s=t.useDebugValue;function o(f,g){var v=g(),x=n({inst:{value:v,getSnapshot:g}}),_=x[0].inst,S=x[1];return a(function(){_.value=v,_.getSnapshot=g,l(_)&&S({inst:_})},[f,v,g]),i(function(){return l(_)&&S({inst:_}),f(function(){l(_)&&S({inst:_})})},[f]),s(v),v}function l(f){var g=f.getSnapshot;f=f.value;try{var v=g();return!r(f,v)}catch{return!0}}function u(f,g){return g()}var c=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return Mw.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:c,Mw}var eT;function AM(){return eT||(eT=1,Pw.exports=jV()),Pw.exports}var jM=AM();function xa(t){this.content=t}xa.prototype={constructor:xa,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,r){var n=r&&r!=t?this.remove(r):this,i=n.find(t),a=n.content.slice();return i==-1?a.push(r||t,e):(a[i+1]=e,r&&(a[i]=r)),new xa(a)},remove:function(t){var e=this.find(t);if(e==-1)return this;var r=this.content.slice();return r.splice(e,2),new xa(r)},addToStart:function(t,e){return new xa([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var r=this.remove(t).content.slice();return r.push(t,e),new xa(r)},addBefore:function(t,e,r){var n=this.remove(e),i=n.content.slice(),a=n.find(t);return i.splice(a==-1?i.length:a,0,e,r),new xa(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=xa.from(t),t.size?new xa(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=xa.from(t),t.size?new xa(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=xa.from(t);for(var r=0;r<t.content.length;r+=2)e=e.remove(t.content[r]);return e},toObject:function(){var t={};return this.forEach(function(e,r){t[e]=r}),t},get size(){return this.content.length>>1}};xa.from=function(t){if(t instanceof xa)return t;var e=[];if(t)for(var r in t)e.push(r,t[r]);return new xa(e)};function RM(t,e,r){for(let n=0;;n++){if(n==t.childCount||n==e.childCount)return t.childCount==e.childCount?null:r;let i=t.child(n),a=e.child(n);if(i==a){r+=i.nodeSize;continue}if(!i.sameMarkup(a))return r;if(i.isText&&i.text!=a.text){for(let s=0;i.text[s]==a.text[s];s++)r++;return r}if(i.content.size||a.content.size){let s=RM(i.content,a.content,r+1);if(s!=null)return s}r+=i.nodeSize}}function LM(t,e,r,n){for(let i=t.childCount,a=e.childCount;;){if(i==0||a==0)return i==a?null:{a:r,b:n};let s=t.child(--i),o=e.child(--a),l=s.nodeSize;if(s==o){r-=l,n-=l;continue}if(!s.sameMarkup(o))return{a:r,b:n};if(s.isText&&s.text!=o.text){let u=0,c=Math.min(s.text.length,o.text.length);for(;u<c&&s.text[s.text.length-u-1]==o.text[o.text.length-u-1];)u++,r--,n--;return{a:r,b:n}}if(s.content.size||o.content.size){let u=LM(s.content,o.content,r-1,n-1);if(u)return u}r-=l,n-=l}}class Qe{constructor(e,r){if(this.content=e,this.size=r||0,r==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,r,n,i=0,a){for(let s=0,o=0;o<r;s++){let l=this.content[s],u=o+l.nodeSize;if(u>e&&n(l,i+o,a||null,s)!==!1&&l.content.size){let c=o+1;l.nodesBetween(Math.max(0,e-c),Math.min(l.content.size,r-c),n,i+c)}o=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,r,n,i){let a="",s=!0;return this.nodesBetween(e,r,(o,l)=>{let u=o.isText?o.text.slice(Math.max(e,l)-l,r-l):o.isLeaf?i?typeof i=="function"?i(o):i:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&u||o.isTextblock)&&n&&(s?s=!1:a+=n),a+=u},0),a}append(e){if(!e.size)return this;if(!this.size)return e;let r=this.lastChild,n=e.firstChild,i=this.content.slice(),a=0;for(r.isText&&r.sameMarkup(n)&&(i[i.length-1]=r.withText(r.text+n.text),a=1);a<e.content.length;a++)i.push(e.content[a]);return new Qe(i,this.size+e.size)}cut(e,r=this.size){if(e==0&&r==this.size)return this;let n=[],i=0;if(r>e)for(let a=0,s=0;s<r;a++){let o=this.content[a],l=s+o.nodeSize;l>e&&((s<e||l>r)&&(o.isText?o=o.cut(Math.max(0,e-s),Math.min(o.text.length,r-s)):o=o.cut(Math.max(0,e-s-1),Math.min(o.content.size,r-s-1))),n.push(o),i+=o.nodeSize),s=l}return new Qe(n,i)}cutByIndex(e,r){return e==r?Qe.empty:e==0&&r==this.content.length?this:new Qe(this.content.slice(e,r))}replaceChild(e,r){let n=this.content[e];if(n==r)return this;let i=this.content.slice(),a=this.size+r.nodeSize-n.nodeSize;return i[e]=r,new Qe(i,a)}addToStart(e){return new Qe([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Qe(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(e.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let r=this.content[e];if(!r)throw new RangeError("Index "+e+" out of range for "+this);return r}maybeChild(e){return this.content[e]||null}forEach(e){for(let r=0,n=0;r<this.content.length;r++){let i=this.content[r];e(i,n,r),n+=i.nodeSize}}findDiffStart(e,r=0){return RM(this,e,r)}findDiffEnd(e,r=this.size,n=e.size){return LM(this,e,r,n)}findIndex(e){if(e==0)return b0(0,e);if(e==this.size)return b0(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,n=0;;r++){let i=this.child(r),a=n+i.nodeSize;if(a>=e)return a==e?b0(r+1,a):b0(r,n);n=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,r){if(!r)return Qe.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new Qe(r.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Qe.empty;let r,n=0;for(let i=0;i<e.length;i++){let a=e[i];n+=a.nodeSize,i&&a.isText&&e[i-1].sameMarkup(a)?(r||(r=e.slice(0,i)),r[r.length-1]=a.withText(r[r.length-1].text+a.text)):r&&r.push(a)}return new Qe(r||e,n)}static from(e){if(!e)return Qe.empty;if(e instanceof Qe)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Qe([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Qe.empty=new Qe([],0);const Aw={index:0,offset:0};function b0(t,e){return Aw.index=t,Aw.offset=e,Aw}function gy(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let r=Array.isArray(t);if(Array.isArray(e)!=r)return!1;if(r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!gy(t[n],e[n]))return!1}else{for(let n in t)if(!(n in e)||!gy(t[n],e[n]))return!1;for(let n in e)if(!(n in t))return!1}return!0}let en=class B2{constructor(e,r){this.type=e,this.attrs=r}addToSet(e){let r,n=!1;for(let i=0;i<e.length;i++){let a=e[i];if(this.eq(a))return e;if(this.type.excludes(a.type))r||(r=e.slice(0,i));else{if(a.type.excludes(this.type))return e;!n&&a.type.rank>this.type.rank&&(r||(r=e.slice(0,i)),r.push(this),n=!0),r&&r.push(a)}}return r||(r=e.slice()),n||r.push(this),r}removeFromSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return e.slice(0,r).concat(e.slice(r+1));return e}isInSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return!0;return!1}eq(e){return this==e||this.type==e.type&&gy(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[r.type];if(!n)throw new RangeError(`There is no mark type ${r.type} in this schema`);let i=n.create(r.attrs);return n.checkAttrs(i.attrs),i}static sameSet(e,r){if(e==r)return!0;if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(r[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return B2.none;if(e instanceof B2)return[e];let r=e.slice();return r.sort((n,i)=>n.type.rank-i.type.rank),r}};en.none=[];class vy extends Error{}class wt{constructor(e,r,n){this.content=e,this.openStart=r,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,r){let n=DM(this.content,e+this.openStart,r);return n&&new wt(n,this.openStart,this.openEnd)}removeBetween(e,r){return new wt(OM(this.content,e+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,r){if(!r)return wt.empty;let n=r.openStart||0,i=r.openEnd||0;if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new wt(Qe.fromJSON(e,r.content),n,i)}static maxOpen(e,r=!0){let n=0,i=0;for(let a=e.firstChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.firstChild)n++;for(let a=e.lastChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.lastChild)i++;return new wt(e,n,i)}}wt.empty=new wt(Qe.empty,0,0);function OM(t,e,r){let{index:n,offset:i}=t.findIndex(e),a=t.maybeChild(n),{index:s,offset:o}=t.findIndex(r);if(i==e||a.isText){if(o!=r&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(r))}if(n!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(n,a.copy(OM(a.content,e-i-1,r-i-1)))}function DM(t,e,r,n){let{index:i,offset:a}=t.findIndex(e),s=t.maybeChild(i);if(a==e||s.isText)return n&&!n.canReplace(i,i,r)?null:t.cut(0,e).append(r).append(t.cut(e));let o=DM(s.content,e-a-1,r,s);return o&&t.replaceChild(i,s.copy(o))}function RV(t,e,r){if(r.openStart>t.depth)throw new vy("Inserted content deeper than insertion position");if(t.depth-r.openStart!=e.depth-r.openEnd)throw new vy("Inconsistent open depths");return IM(t,e,r,0)}function IM(t,e,r,n){let i=t.index(n),a=t.node(n);if(i==e.index(n)&&n<t.depth-r.openStart){let s=IM(t,e,r,n+1);return a.copy(a.content.replaceChild(i,s))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&t.depth==n&&e.depth==n){let s=t.parent,o=s.content;return Th(s,o.cut(0,t.parentOffset).append(r.content).append(o.cut(e.parentOffset)))}else{let{start:s,end:o}=LV(r,t);return Th(a,zM(t,s,o,e,n))}else return Th(a,yy(t,e,n))}function BM(t,e){if(!e.type.compatibleContent(t.type))throw new vy("Cannot join "+e.type.name+" onto "+t.type.name)}function z2(t,e,r){let n=t.node(r);return BM(n,e.node(r)),n}function Nh(t,e){let r=e.length-1;r>=0&&t.isText&&t.sameMarkup(e[r])?e[r]=t.withText(e[r].text+t.text):e.push(t)}function vg(t,e,r,n){let i=(e||t).node(r),a=0,s=e?e.index(r):i.childCount;t&&(a=t.index(r),t.depth>r?a++:t.textOffset&&(Nh(t.nodeAfter,n),a++));for(let o=a;o<s;o++)Nh(i.child(o),n);e&&e.depth==r&&e.textOffset&&Nh(e.nodeBefore,n)}function Th(t,e){return t.type.checkContent(e),t.copy(e)}function zM(t,e,r,n,i){let a=t.depth>i&&z2(t,e,i+1),s=n.depth>i&&z2(r,n,i+1),o=[];return vg(null,t,i,o),a&&s&&e.index(i)==r.index(i)?(BM(a,s),Nh(Th(a,zM(t,e,r,n,i+1)),o)):(a&&Nh(Th(a,yy(t,e,i+1)),o),vg(e,r,i,o),s&&Nh(Th(s,yy(r,n,i+1)),o)),vg(n,null,i,o),new Qe(o)}function yy(t,e,r){let n=[];if(vg(null,t,r,n),t.depth>r){let i=z2(t,e,r+1);Nh(Th(i,yy(t,e,r+1)),n)}return vg(e,null,r,n),new Qe(n)}function LV(t,e){let r=e.depth-t.openStart,i=e.node(r).copy(t.content);for(let a=r-1;a>=0;a--)i=e.node(a).copy(Qe.from(i));return{start:i.resolveNoCache(t.openStart+r),end:i.resolveNoCache(i.content.size-t.openEnd-r)}}class Hg{constructor(e,r,n){this.pos=e,this.path=r,this.parentOffset=n,this.depth=r.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,r=this.index(this.depth);if(r==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(r);return n?e.child(r).cut(n):i}get nodeBefore(){let e=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(e).cut(0,r):e==0?null:this.parent.child(e-1)}posAtIndex(e,r){r=this.resolveDepth(r);let n=this.path[r*3],i=r==0?0:this.path[r*3-1]+1;for(let a=0;a<e;a++)i+=n.child(a).nodeSize;return i}marks(){let e=this.parent,r=this.index();if(e.content.size==0)return en.none;if(this.textOffset)return e.child(r).marks;let n=e.maybeChild(r-1),i=e.maybeChild(r);if(!n){let o=n;n=i,i=o}let a=n.marks;for(var s=0;s<a.length;s++)a[s].type.spec.inclusive===!1&&(!i||!a[s].isInSet(i.marks))&&(a=a[s--].removeFromSet(a));return a}marksAcross(e){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let n=r.marks,i=e.parent.maybeChild(e.index());for(var a=0;a<n.length;a++)n[a].type.spec.inclusive===!1&&(!i||!n[a].isInSet(i.marks))&&(n=n[a--].removeFromSet(n));return n}sharedDepth(e){for(let r=this.depth;r>0;r--)if(this.start(r)<=e&&this.end(r)>=e)return r;return 0}blockRange(e=this,r){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!r||r(this.node(n))))return new xy(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let r=1;r<=this.depth;r++)e+=(e?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return e+":"+this.parentOffset}static resolve(e,r){if(!(r>=0&&r<=e.content.size))throw new RangeError("Position "+r+" out of range");let n=[],i=0,a=r;for(let s=e;;){let{index:o,offset:l}=s.content.findIndex(a),u=a-l;if(n.push(s,o,i+l),!u||(s=s.child(o),s.isText))break;a=u-1,i+=l+1}return new Hg(r,n,a)}static resolveCached(e,r){let n=tT.get(e);if(n)for(let a=0;a<n.elts.length;a++){let s=n.elts[a];if(s.pos==r)return s}else tT.set(e,n=new OV);let i=n.elts[n.i]=Hg.resolve(e,r);return n.i=(n.i+1)%DV,i}}class OV{constructor(){this.elts=[],this.i=0}}const DV=12,tT=new WeakMap;class xy{constructor(e,r,n){this.$from=e,this.$to=r,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const IV=Object.create(null);class To{constructor(e,r,n,i=en.none){this.type=e,this.attrs=r,this.marks=i,this.content=n||Qe.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,r,n,i=0){this.content.nodesBetween(e,r,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,r,n,i){return this.content.textBetween(e,r,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,r,n){return this.type==e&&gy(this.attrs,r||e.defaultAttrs||IV)&&en.sameSet(this.marks,n||en.none)}copy(e=null){return e==this.content?this:new To(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new To(this.type,this.attrs,this.content,e)}cut(e,r=this.content.size){return e==0&&r==this.content.size?this:this.copy(this.content.cut(e,r))}slice(e,r=this.content.size,n=!1){if(e==r)return wt.empty;let i=this.resolve(e),a=this.resolve(r),s=n?0:i.sharedDepth(r),o=i.start(s),u=i.node(s).content.cut(i.pos-o,a.pos-o);return new wt(u,i.depth-s,a.depth-s)}replace(e,r,n){return RV(this.resolve(e),this.resolve(r),n)}nodeAt(e){for(let r=this;;){let{index:n,offset:i}=r.content.findIndex(e);if(r=r.maybeChild(n),!r)return null;if(i==e||r.isText)return r;e-=i+1}}childAfter(e){let{index:r,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(r),index:r,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:r,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(r),index:r,offset:n};let i=this.content.child(r-1);return{node:i,index:r-1,offset:n-i.nodeSize}}resolve(e){return Hg.resolveCached(this,e)}resolveNoCache(e){return Hg.resolve(this,e)}rangeHasMark(e,r,n){let i=!1;return r>e&&this.nodesBetween(e,r,a=>(n.isInSet(a.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),FM(this.marks,e)}contentMatchAt(e){let r=this.type.contentMatch.matchFragment(this.content,0,e);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(e,r,n=Qe.empty,i=0,a=n.childCount){let s=this.contentMatchAt(e).matchFragment(n,i,a),o=s&&s.matchFragment(this.content,r);if(!o||!o.validEnd)return!1;for(let l=i;l<a;l++)if(!this.type.allowsMarks(n.child(l).marks))return!1;return!0}canReplaceWith(e,r,n,i){if(i&&!this.type.allowsMarks(i))return!1;let a=this.contentMatchAt(e).matchType(n),s=a&&a.matchFragment(this.content,r);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=en.none;for(let r=0;r<this.marks.length;r++){let n=this.marks[r];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!en.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(r=>r.toJSON())),e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let n;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=r.marks.map(e.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(r.text,n)}let i=Qe.fromJSON(e,r.content),a=e.nodeType(r.type).create(r.attrs,i,n);return a.type.checkAttrs(a.attrs),a}}To.prototype.text=void 0;class by extends To{constructor(e,r,n,i){if(super(e,r,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):FM(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,r){return this.text.slice(e,r)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new by(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new by(this.type,this.attrs,e,this.marks)}cut(e=0,r=this.text.length){return e==0&&r==this.text.length?this:this.withText(this.text.slice(e,r))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function FM(t,e){for(let r=t.length-1;r>=0;r--)e=t[r].type.name+"("+e+")";return e}class Fh{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,r){let n=new BV(e,r);if(n.next==null)return Fh.empty;let i=VM(n);n.next&&n.err("Unexpected trailing text");let a=qV(GV(i));return WV(a,n),a}matchType(e){for(let r=0;r<this.next.length;r++)if(this.next[r].type==e)return this.next[r].next;return null}matchFragment(e,r=0,n=e.childCount){let i=this;for(let a=r;i&&a<n;a++)i=i.matchType(e.child(a).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:r}=this.next[e];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(e){for(let r=0;r<this.next.length;r++)for(let n=0;n<e.next.length;n++)if(this.next[r].type==e.next[n].type)return!0;return!1}fillBefore(e,r=!1,n=0){let i=[this];function a(s,o){let l=s.matchFragment(e,n);if(l&&(!r||l.validEnd))return Qe.from(o.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:c,next:f}=s.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let g=a(f,o.concat(c));if(g)return g}}return null}return a(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let r=this.computeWrapping(e);return this.wrapCache.push(e,r),r}computeWrapping(e){let r=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),a=i.match;if(a.matchType(e)){let s=[];for(let o=i;o.type;o=o.via)s.push(o.type);return s.reverse()}for(let s=0;s<a.next.length;s++){let{type:o,next:l}=a.next[s];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in r)&&(!i.type||l.validEnd)&&(n.push({match:o.contentMatch,type:o,via:i}),r[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function r(n){e.push(n);for(let i=0;i<n.next.length;i++)e.indexOf(n.next[i].next)==-1&&r(n.next[i].next)}return r(this),e.map((n,i)=>{let a=i+(n.validEnd?"*":" ")+" ";for(let s=0;s<n.next.length;s++)a+=(s?", ":"")+n.next[s].type.name+"->"+e.indexOf(n.next[s].next);return a}).join(`
`)}}Fh.empty=new Fh(!0);class BV{constructor(e,r){this.string=e,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function VM(t){let e=[];do e.push(zV(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function zV(t){let e=[];do e.push(FV(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function FV(t){let e=HV(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=VV(t,e);else break;return e}function rT(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function VV(t,e){let r=rT(t),n=r;return t.eat(",")&&(t.next!="}"?n=rT(t):n=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:e}}function UV(t,e){let r=t.nodeTypes,n=r[e];if(n)return[n];let i=[];for(let a in r){let s=r[a];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function HV(t){if(t.eat("(")){let e=VM(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=UV(t,t.next).map(r=>(t.inline==null?t.inline=r.isInline:t.inline!=r.isInline&&t.err("Mixing inline and block content"),{type:"name",value:r}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function GV(t){let e=[[]];return i(a(t,0),r()),e;function r(){return e.push([])-1}function n(s,o,l){let u={term:l,to:o};return e[s].push(u),u}function i(s,o){s.forEach(l=>l.to=o)}function a(s,o){if(s.type=="choice")return s.exprs.reduce((l,u)=>l.concat(a(u,o)),[]);if(s.type=="seq")for(let l=0;;l++){let u=a(s.exprs[l],o);if(l==s.exprs.length-1)return u;i(u,o=r())}else if(s.type=="star"){let l=r();return n(o,l),i(a(s.expr,l),l),[n(l)]}else if(s.type=="plus"){let l=r();return i(a(s.expr,o),l),i(a(s.expr,l),l),[n(l)]}else{if(s.type=="opt")return[n(o)].concat(a(s.expr,o));if(s.type=="range"){let l=o;for(let u=0;u<s.min;u++){let c=r();i(a(s.expr,l),c),l=c}if(s.max==-1)i(a(s.expr,l),l);else for(let u=s.min;u<s.max;u++){let c=r();n(l,c),i(a(s.expr,l),c),l=c}return[n(l)]}else{if(s.type=="name")return[n(o,void 0,s.value)];throw new Error("Unknown expr type")}}}}function UM(t,e){return e-t}function nT(t,e){let r=[];return n(e),r.sort(UM);function n(i){let a=t[i];if(a.length==1&&!a[0].term)return n(a[0].to);r.push(i);for(let s=0;s<a.length;s++){let{term:o,to:l}=a[s];!o&&r.indexOf(l)==-1&&n(l)}}}function qV(t){let e=Object.create(null);return r(nT(t,0));function r(n){let i=[];n.forEach(s=>{t[s].forEach(({term:o,to:l})=>{if(!o)return;let u;for(let c=0;c<i.length;c++)i[c][0]==o&&(u=i[c][1]);nT(t,l).forEach(c=>{u||i.push([o,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let a=e[n.join(",")]=new Fh(n.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let o=i[s][1].sort(UM);a.next.push({type:i[s][0],next:e[o.join(",")]||r(o)})}return a}}function WV(t,e){for(let r=0,n=[t];r<n.length;r++){let i=n[r],a=!i.validEnd,s=[];for(let o=0;o<i.next.length;o++){let{type:l,next:u}=i.next[o];s.push(l.name),a&&!(l.isText||l.hasRequiredAttrs())&&(a=!1),n.indexOf(u)==-1&&n.push(u)}a&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function HM(t){let e=Object.create(null);for(let r in t){let n=t[r];if(!n.hasDefault)return null;e[r]=n.default}return e}function GM(t,e){let r=Object.create(null);for(let n in t){let i=e&&e[n];if(i===void 0){let a=t[n];if(a.hasDefault)i=a.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=i}return r}function qM(t,e,r,n){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${r} of type ${i}`);for(let i in t){let a=t[i];a.validate&&a.validate(e[i])}}function WM(t,e){let r=Object.create(null);if(e)for(let n in e)r[n]=new KV(t,n,e[n]);return r}let iT=class $M{constructor(e,r,n){this.name=e,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=WM(e,n.attrs),this.defaultAttrs=HM(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Fh.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:GM(this.attrs,e)}create(e=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new To(this,this.computeAttrs(e),Qe.from(r),en.setFrom(n))}createChecked(e=null,r,n){return r=Qe.from(r),this.checkContent(r),new To(this,this.computeAttrs(e),r,en.setFrom(n))}createAndFill(e=null,r,n){if(e=this.computeAttrs(e),r=Qe.from(r),r.size){let s=this.contentMatch.fillBefore(r);if(!s)return null;r=s.append(r)}let i=this.contentMatch.matchFragment(r),a=i&&i.fillBefore(Qe.empty,!0);return a?new To(this,e,r.append(a),en.setFrom(n)):null}validContent(e){let r=this.contentMatch.matchFragment(e);if(!r||!r.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){qM(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let r=0;r<e.length;r++)if(!this.allowsMarkType(e[r].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let r;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?r&&r.push(e[n]):r||(r=e.slice(0,n));return r?r.length?r:en.none:e}static compile(e,r){let n=Object.create(null);e.forEach((a,s)=>n[a]=new $M(a,r,s));let i=r.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let a in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function $V(t,e,r){let n=r.split("|");return i=>{let a=i===null?"null":typeof i;if(n.indexOf(a)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${t}, got ${a}`)}}class KV{constructor(e,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?$V(e,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Rx{constructor(e,r,n,i){this.name=e,this.rank=r,this.schema=n,this.spec=i,this.attrs=WM(e,i.attrs),this.excluded=null;let a=HM(this.attrs);this.instance=a?new en(this,a):null}create(e=null){return!e&&this.instance?this.instance:new en(this,GM(this.attrs,e))}static compile(e,r){let n=Object.create(null),i=0;return e.forEach((a,s)=>n[a]=new Rx(a,i++,r,s)),n}removeFromSet(e){for(var r=0;r<e.length;r++)e[r].type==this&&(e=e.slice(0,r).concat(e.slice(r+1)),r--);return e}isInSet(e){for(let r=0;r<e.length;r++)if(e[r].type==this)return e[r]}checkAttrs(e){qM(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class KM{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let i in e)r[i]=e[i];r.nodes=xa.from(e.nodes),r.marks=xa.from(e.marks||{}),this.nodes=iT.compile(this.spec.nodes,this),this.marks=Rx.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let a=this.nodes[i],s=a.spec.content||"",o=a.spec.marks;if(a.contentMatch=n[s]||(n[s]=Fh.parse(s,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=o=="_"?null:o?aT(this,o.split(" ")):o==""||!a.inlineContent?[]:null}for(let i in this.marks){let a=this.marks[i],s=a.spec.excludes;a.excluded=s==null?[a]:s==""?[]:aT(this,s.split(" "))}this.nodeFromJSON=i=>To.fromJSON(this,i),this.markFromJSON=i=>en.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,r=null,n,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof iT){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(r,n,i)}text(e,r){let n=this.nodes.text;return new by(n,n.defaultAttrs,e,en.setFrom(r))}mark(e,r){return typeof e=="string"&&(e=this.marks[e]),e.create(r)}nodeType(e){let r=this.nodes[e];if(!r)throw new RangeError("Unknown node type: "+e);return r}}function aT(t,e){let r=[];for(let n=0;n<e.length;n++){let i=e[n],a=t.marks[i],s=a;if(a)r.push(a);else for(let o in t.marks){let l=t.marks[o];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&r.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return r}function ZV(t){return t.tag!=null}function YV(t){return t.style!=null}class pd{constructor(e,r){this.schema=e,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(i=>{if(ZV(i))this.tags.push(i);else if(YV(i)){let a=/[^=]*/.exec(i.style)[0];n.indexOf(a)<0&&n.push(a),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let a=e.nodes[i.node];return a.contentMatch.matchType(a)})}parse(e,r={}){let n=new oT(this,r,!1);return n.addAll(e,en.none,r.from,r.to),n.finish()}parseSlice(e,r={}){let n=new oT(this,r,!0);return n.addAll(e,en.none,r.from,r.to),wt.maxOpen(n.finish())}matchTag(e,r,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let a=this.tags[i];if(JV(e,a.tag)&&(a.namespace===void 0||e.namespaceURI==a.namespace)&&(!a.context||r.matchesContext(a.context))){if(a.getAttrs){let s=a.getAttrs(e);if(s===!1)continue;a.attrs=s||void 0}return a}}}matchStyle(e,r,n,i){for(let a=i?this.styles.indexOf(i)+1:0;a<this.styles.length;a++){let s=this.styles[a],o=s.style;if(!(o.indexOf(e)!=0||s.context&&!n.matchesContext(s.context)||o.length>e.length&&(o.charCodeAt(e.length)!=61||o.slice(e.length+1)!=r))){if(s.getAttrs){let l=s.getAttrs(r);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let r=[];function n(i){let a=i.priority==null?50:i.priority,s=0;for(;s<r.length;s++){let o=r[s];if((o.priority==null?50:o.priority)<a)break}r.splice(s,0,i)}for(let i in e.marks){let a=e.marks[i].spec.parseDOM;a&&a.forEach(s=>{n(s=lT(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let a=e.nodes[i].spec.parseDOM;a&&a.forEach(s=>{n(s=lT(s)),s.node||s.ignore||s.mark||(s.node=i)})}return r}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new pd(e,pd.schemaRules(e)))}}const ZM={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},XV={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},YM={ol:!0,ul:!0},Gg=1,F2=2,yg=4;function sT(t,e,r){return e!=null?(e?Gg:0)|(e==="full"?F2:0):t&&t.whitespace=="pre"?Gg|F2:r&~yg}class w0{constructor(e,r,n,i,a,s){this.type=e,this.attrs=r,this.marks=n,this.solid=i,this.options=s,this.content=[],this.activeMarks=en.none,this.match=a||(s&yg?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(Qe.from(e));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Gg)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let a=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-i[0].length))}}let r=Qe.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(Qe.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!ZM.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class oT{constructor(e,r,n){this.parser=e,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let i=r.topNode,a,s=sT(null,r.preserveWhitespace,0)|(n?yg:0);i?a=new w0(i.type,i.attrs,en.none,!0,r.topMatch||i.type.contentMatch,s):n?a=new w0(null,null,en.none,!0,null,s):a=new w0(e.schema.topNodeType,null,en.none,!0,null,s),this.nodes=[a],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,r){e.nodeType==3?this.addTextNode(e,r):e.nodeType==1&&this.addElement(e,r)}addTextNode(e,r){let n=e.nodeValue,i=this.top,a=i.options&F2?"full":this.localPreserveWS||(i.options&Gg)>0,{schema:s}=this.parser;if(a==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(a)if(a==="full")n=n.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(s.linebreakReplacement.create())){let o=n.split(/\r?\n|\r/);for(let l=0;l<o.length;l++)l&&this.insertNode(s.linebreakReplacement.create(),r,!0),o[l]&&this.insertNode(s.text(o[l]),r,!/\S/.test(o[l]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let o=i.content[i.content.length-1],l=e.previousSibling;(!o||l&&l.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(n=n.slice(1))}n&&this.insertNode(s.text(n),r,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,r,n){let i=this.localPreserveWS,a=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),o;YM.hasOwnProperty(s)&&this.parser.normalizeLists&&QV(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,n));e:if(l?l.ignore:XV.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,r);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let u,c=this.needsBlock;if(ZM.hasOwnProperty(s))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),u=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,r);break e}let f=l&&l.skip?r:this.readStyles(e,r);f&&this.addAll(e,f),u&&this.sync(a),this.needsBlock=c}else{let u=this.readStyles(e,r);u&&this.addElementByRule(e,l,u,l.consuming===!1?o:void 0)}this.localPreserveWS=i}leafFallback(e,r){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),r)}ignoreFallback(e,r){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(e,r){let n=e.style;if(n&&n.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let a=this.parser.matchedStyles[i],s=n.getPropertyValue(a);if(s)for(let o=void 0;;){let l=this.parser.matchStyle(a,s,this,o);if(!l)break;if(l.ignore)return null;if(l.clearMark?r=r.filter(u=>!l.clearMark(u)):r=r.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)o=l;else break}}return r}addElementByRule(e,r,n,i){let a,s;if(r.node)if(s=this.parser.schema.nodes[r.node],s.isLeaf)this.insertNode(s.create(r.attrs),n,e.nodeName=="BR")||this.leafFallback(e,n);else{let l=this.enter(s,r.attrs||null,n,r.preserveWhitespace);l&&(a=!0,n=l)}else{let l=this.parser.schema.marks[r.mark];n=n.concat(l.create(r.attrs))}let o=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,n,i);else if(r.getContent)this.findInside(e),r.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,n,!1));else{let l=e;typeof r.contentElement=="string"?l=e.querySelector(r.contentElement):typeof r.contentElement=="function"?l=r.contentElement(e):r.contentElement&&(l=r.contentElement),this.findAround(e,l,!0),this.addAll(l,n),this.findAround(e,l,!1)}a&&this.sync(o)&&this.open--}addAll(e,r,n,i){let a=n||0;for(let s=n?e.childNodes[n]:e.firstChild,o=i==null?null:e.childNodes[i];s!=o;s=s.nextSibling,++a)this.findAtPoint(e,a),this.addDOM(s,r);this.findAtPoint(e,a)}findPlace(e,r,n){let i,a;for(let s=this.open,o=0;s>=0;s--){let l=this.nodes[s],u=l.findWrapping(e);if(u&&(!i||i.length>u.length+o)&&(i=u,a=l,!u.length))break;if(l.solid){if(n)break;o+=2}}if(!i)return null;this.sync(a);for(let s=0;s<i.length;s++)r=this.enterInner(i[s],null,r,!1);return r}insertNode(e,r,n){if(e.isInline&&this.needsBlock&&!this.top.type){let a=this.textblockFromContext();a&&(r=this.enterInner(a,null,r))}let i=this.findPlace(e,r,n);if(i){this.closeExtra();let a=this.top;a.match&&(a.match=a.match.matchType(e.type));let s=en.none;for(let o of i.concat(e.marks))(a.type?a.type.allowsMarkType(o.type):uT(o.type,e.type))&&(s=o.addToSet(s));return a.content.push(e.mark(s)),!0}return!1}enter(e,r,n,i){let a=this.findPlace(e.create(r),n,!1);return a&&(a=this.enterInner(e,r,n,!0,i)),a}enterInner(e,r,n,i=!1,a){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let o=sT(e,a,s.options);s.options&yg&&s.content.length==0&&(o|=yg);let l=en.none;return n=n.filter(u=>(s.type?s.type.allowsMarkType(u.type):uT(u.type,e))?(l=u.addToSet(l),!1):!0),this.nodes.push(new w0(e,r,l,i,null,o)),this.open++,n}closeExtra(e=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let r=this.open;r>=0;r--){if(this.nodes[r]==e)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=Gg)}return!1}get currentPos(){this.closeExtra();let e=0;for(let r=this.open;r>=0;r--){let n=this.nodes[r].content;for(let i=n.length-1;i>=0;i--)e+=n[i].nodeSize;r&&e++}return e}findAtPoint(e,r){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==r&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(e,r,n){if(e!=r&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&r.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&(this.find[r].pos=this.currentPos-(e.nodeValue.length-this.find[r].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let r=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),a=-(n?n.depth+1:0)+(i?0:1),s=(o,l)=>{for(;o>=0;o--){let u=r[o];if(u==""){if(o==r.length-1||o==0)continue;for(;l>=a;l--)if(s(o-1,l))return!0;return!1}else{let c=l>0||l==0&&i?this.nodes[l].type:n&&l>=a?n.node(l-a).type:null;if(!c||c.name!=u&&!c.isInGroup(u))return!1;l--}}return!0};return s(r.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let r=e.depth;r>=0;r--){let n=e.node(r).contentMatchAt(e.indexAfter(r)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let r in this.parser.schema.nodes){let n=this.parser.schema.nodes[r];if(n.isTextblock&&n.defaultAttrs)return n}}}function QV(t){for(let e=t.firstChild,r=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&YM.hasOwnProperty(n)&&r?(r.appendChild(e),e=r):n=="li"?r=e:n&&(r=null)}}function JV(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function lT(t){let e={};for(let r in t)e[r]=t[r];return e}function uT(t,e){let r=e.schema.nodes;for(let n in r){let i=r[n];if(!i.allowsMarkType(t))continue;let a=[],s=o=>{a.push(o);for(let l=0;l<o.edgeCount;l++){let{type:u,next:c}=o.edge(l);if(u==e||a.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}class Yh{constructor(e,r){this.nodes=e,this.marks=r}serializeFragment(e,r={},n){n||(n=jw(r).createDocumentFragment());let i=n,a=[];return e.forEach(s=>{if(a.length||s.marks.length){let o=0,l=0;for(;o<a.length&&l<s.marks.length;){let u=s.marks[l];if(!this.marks[u.type.name]){l++;continue}if(!u.eq(a[o][0])||u.type.spec.spanning===!1)break;o++,l++}for(;o<a.length;)i=a.pop()[1];for(;l<s.marks.length;){let u=s.marks[l++],c=this.serializeMark(u,s.isInline,r);c&&(a.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,r))}),n}serializeNodeInner(e,r){let{dom:n,contentDOM:i}=$0(jw(r),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,r,i)}return n}serializeNode(e,r={}){let n=this.serializeNodeInner(e,r);for(let i=e.marks.length-1;i>=0;i--){let a=this.serializeMark(e.marks[i],e.isInline,r);a&&((a.contentDOM||a.dom).appendChild(n),n=a.dom)}return n}serializeMark(e,r,n={}){let i=this.marks[e.type.name];return i&&$0(jw(n),i(e,r),null,e.attrs)}static renderSpec(e,r,n=null,i){return $0(e,r,n,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Yh(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let r=cT(e.nodes);return r.text||(r.text=n=>n.text),r}static marksFromSchema(e){return cT(e.marks)}}function cT(t){let e={};for(let r in t){let n=t[r].spec.toDOM;n&&(e[r]=n)}return e}function jw(t){return t.document||window.document}const dT=new WeakMap;function eU(t){let e=dT.get(t);return e===void 0&&dT.set(t,e=tU(t)),e}function tU(t){let e=null;function r(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")e||(e=[]),e.push(n);else for(let i=0;i<n.length;i++)r(n[i]);else for(let i in n)r(n[i])}return r(t),e}function $0(t,e,r,n){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],a;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(a=eU(n))&&a.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,l=r?t.createElementNS(r,i):t.createElement(i),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let f in u)if(u[f]!=null){let g=f.indexOf(" ");g>0?l.setAttributeNS(f.slice(0,g),f.slice(g+1),u[f]):f=="style"&&l.style?l.style.cssText=u[f]:l.setAttribute(f,u[f])}}for(let f=c;f<e.length;f++){let g=e[f];if(g===0){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:v,contentDOM:x}=$0(t,g,r,n);if(l.appendChild(v),x){if(o)throw new RangeError("Multiple content holes");o=x}}}return{dom:l,contentDOM:o}}const XM=65535,QM=Math.pow(2,16);function rU(t,e){return t+e*QM}function hT(t){return t&XM}function nU(t){return(t-(t&XM))/QM}const JM=1,e6=2,K0=4,t6=8;class V2{constructor(e,r,n){this.pos=e,this.delInfo=r,this.recover=n}get deleted(){return(this.delInfo&t6)>0}get deletedBefore(){return(this.delInfo&(JM|K0))>0}get deletedAfter(){return(this.delInfo&(e6|K0))>0}get deletedAcross(){return(this.delInfo&K0)>0}}class Zs{constructor(e,r=!1){if(this.ranges=e,this.inverted=r,!e.length&&Zs.empty)return Zs.empty}recover(e){let r=0,n=hT(e);if(!this.inverted)for(let i=0;i<n;i++)r+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[n*3]+r+nU(e)}mapResult(e,r=1){return this._map(e,r,!1)}map(e,r=1){return this._map(e,r,!0)}_map(e,r,n){let i=0,a=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?i:0);if(l>e)break;let u=this.ranges[o+a],c=this.ranges[o+s],f=l+u;if(e<=f){let g=u?e==l?-1:e==f?1:r:r,v=l+i+(g<0?0:c);if(n)return v;let x=e==(r<0?l:f)?null:rU(o/3,e-l),_=e==l?e6:e==f?JM:K0;return(r<0?e!=l:e!=f)&&(_|=t6),new V2(v,_,x)}i+=c-u}return n?e+i:new V2(e+i,0,null)}touches(e,r){let n=0,i=hT(r),a=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?n:0);if(l>e)break;let u=this.ranges[o+a],c=l+u;if(e<=c&&o==i*3)return!0;n+=this.ranges[o+s]-u}return!1}forEach(e){let r=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,a=0;i<this.ranges.length;i+=3){let s=this.ranges[i],o=s-(this.inverted?a:0),l=s+(this.inverted?0:a),u=this.ranges[i+r],c=this.ranges[i+n];e(o,o+u,l,l+c),a+=c-u}}invert(){return new Zs(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Zs.empty:new Zs(e<0?[0,-e,0]:[0,0,e])}}Zs.empty=new Zs([]);class qg{constructor(e,r,n=0,i=e?e.length:0){this.mirror=r,this.from=n,this.to=i,this._maps=e||[],this.ownData=!(e||r)}get maps(){return this._maps}slice(e=0,r=this.maps.length){return new qg(this._maps,this.mirror,e,r)}appendMap(e,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(e){for(let r=0,n=this._maps.length;r<e._maps.length;r++){let i=e.getMirror(r);this.appendMap(e._maps[r],i!=null&&i<r?n+i:void 0)}}getMirror(e){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==e)return this.mirror[r+(r%2?-1:1)]}}setMirror(e,r){this.mirror||(this.mirror=[]),this.mirror.push(e,r)}appendMappingInverted(e){for(let r=e.maps.length-1,n=this._maps.length+e._maps.length;r>=0;r--){let i=e.getMirror(r);this.appendMap(e._maps[r].invert(),i!=null&&i>r?n-i-1:void 0)}}invert(){let e=new qg;return e.appendMappingInverted(this),e}map(e,r=1){if(this.mirror)return this._map(e,r,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,r);return e}mapResult(e,r=1){return this._map(e,r,!1)}_map(e,r,n){let i=0;for(let a=this.from;a<this.to;a++){let s=this._maps[a],o=s.mapResult(e,r);if(o.recover!=null){let l=this.getMirror(a);if(l!=null&&l>a&&l<this.to){a=l,e=this._maps[l].recover(o.recover);continue}}i|=o.delInfo,e=o.pos}return n?e:new V2(e,i,null)}}const Rw=Object.create(null);class Wa{getMap(){return Zs.empty}merge(e){return null}static fromJSON(e,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Rw[r.stepType];if(!n)throw new RangeError(`No step type ${r.stepType} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in Rw)throw new RangeError("Duplicate use of step JSON ID "+e);return Rw[e]=r,r.prototype.jsonID=e,r}}class xi{constructor(e,r){this.doc=e,this.failed=r}static ok(e){return new xi(e,null)}static fail(e){return new xi(null,e)}static fromReplace(e,r,n,i){try{return xi.ok(e.replace(r,n,i))}catch(a){if(a instanceof vy)return xi.fail(a.message);throw a}}}function iS(t,e,r){let n=[];for(let i=0;i<t.childCount;i++){let a=t.child(i);a.content.size&&(a=a.copy(iS(a.content,e,a))),a.isInline&&(a=e(a,r,i)),n.push(a)}return Qe.fromArray(n)}class od extends Wa{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),a=new wt(iS(r.content,(s,o)=>!s.isAtom||!o.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),r.openStart,r.openEnd);return xi.fromReplace(e,this.from,this.to,a)}invert(){return new ul(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new od(r.pos,n.pos,this.mark)}merge(e){return e instanceof od&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new od(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new od(r.from,r.to,e.markFromJSON(r.mark))}}Wa.jsonID("addMark",od);class ul extends Wa{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=new wt(iS(r.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),r.openStart,r.openEnd);return xi.fromReplace(e,this.from,this.to,n)}invert(){return new od(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new ul(r.pos,n.pos,this.mark)}merge(e){return e instanceof ul&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ul(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ul(r.from,r.to,e.markFromJSON(r.mark))}}Wa.jsonID("removeMark",ul);class ld extends Wa{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return xi.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return xi.fromReplace(e,this.pos,this.pos+1,new wt(Qe.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);if(r){let n=this.mark.addToSet(r.marks);if(n.length==r.marks.length){for(let i=0;i<r.marks.length;i++)if(!r.marks[i].isInSet(n))return new ld(this.pos,r.marks[i]);return new ld(this.pos,this.mark)}}return new Vh(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new ld(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ld(r.pos,e.markFromJSON(r.mark))}}Wa.jsonID("addNodeMark",ld);class Vh extends Wa{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return xi.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return xi.fromReplace(e,this.pos,this.pos+1,new wt(Qe.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new ld(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new Vh(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Vh(r.pos,e.markFromJSON(r.mark))}}Wa.jsonID("removeNodeMark",Vh);class $i extends Wa{constructor(e,r,n,i=!1){super(),this.from=e,this.to=r,this.slice=n,this.structure=i}apply(e){return this.structure&&U2(e,this.from,this.to)?xi.fail("Structure replace would overwrite content"):xi.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Zs([this.from,this.to-this.from,this.slice.size])}invert(e){return new $i(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deletedAcross&&n.deletedAcross?null:new $i(r.pos,Math.max(r.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof $i)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let r=this.slice.size+e.slice.size==0?wt.empty:new wt(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new $i(this.from,this.to+(e.to-e.from),r,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let r=this.slice.size+e.slice.size==0?wt.empty:new wt(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new $i(e.from,this.to,r,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new $i(r.from,r.to,wt.fromJSON(e,r.slice),!!r.structure)}}Wa.jsonID("replace",$i);class Yi extends Wa{constructor(e,r,n,i,a,s,o=!1){super(),this.from=e,this.to=r,this.gapFrom=n,this.gapTo=i,this.slice=a,this.insert=s,this.structure=o}apply(e){if(this.structure&&(U2(e,this.from,this.gapFrom)||U2(e,this.gapTo,this.to)))return xi.fail("Structure gap-replace would overwrite content");let r=e.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return xi.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,r.content);return n?xi.fromReplace(e,this.from,this.to,n):xi.fail("Content does not fit in gap")}getMap(){return new Zs([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let r=this.gapTo-this.gapFrom;return new Yi(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=this.from==this.gapFrom?r.pos:e.map(this.gapFrom,-1),a=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return r.deletedAcross&&n.deletedAcross||i<r.pos||a>n.pos?null:new Yi(r.pos,n.pos,i,a,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Yi(r.from,r.to,r.gapFrom,r.gapTo,wt.fromJSON(e,r.slice),r.insert,!!r.structure)}}Wa.jsonID("replaceAround",Yi);function U2(t,e,r){let n=t.resolve(e),i=r-e,a=n.depth;for(;i>0&&a>0&&n.indexAfter(a)==n.node(a).childCount;)a--,i--;if(i>0){let s=n.node(a).maybeChild(n.indexAfter(a));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function iU(t,e,r,n){let i=[],a=[],s,o;t.doc.nodesBetween(e,r,(l,u,c)=>{if(!l.isInline)return;let f=l.marks;if(!n.isInSet(f)&&c.type.allowsMarkType(n.type)){let g=Math.max(u,e),v=Math.min(u+l.nodeSize,r),x=n.addToSet(f);for(let _=0;_<f.length;_++)f[_].isInSet(x)||(s&&s.to==g&&s.mark.eq(f[_])?s.to=v:i.push(s=new ul(g,v,f[_])));o&&o.to==g?o.to=v:a.push(o=new od(g,v,n))}}),i.forEach(l=>t.step(l)),a.forEach(l=>t.step(l))}function aU(t,e,r,n){let i=[],a=0;t.doc.nodesBetween(e,r,(s,o)=>{if(!s.isInline)return;a++;let l=null;if(n instanceof Rx){let u=s.marks,c;for(;c=n.isInSet(u);)(l||(l=[])).push(c),u=c.removeFromSet(u)}else n?n.isInSet(s.marks)&&(l=[n]):l=s.marks;if(l&&l.length){let u=Math.min(o+s.nodeSize,r);for(let c=0;c<l.length;c++){let f=l[c],g;for(let v=0;v<i.length;v++){let x=i[v];x.step==a-1&&f.eq(i[v].style)&&(g=x)}g?(g.to=u,g.step=a):i.push({style:f,from:Math.max(o,e),to:u,step:a})}}}),i.forEach(s=>t.step(new ul(s.from,s.to,s.style)))}function aS(t,e,r,n=r.contentMatch,i=!0){let a=t.doc.nodeAt(e),s=[],o=e+1;for(let l=0;l<a.childCount;l++){let u=a.child(l),c=o+u.nodeSize,f=n.matchType(u.type);if(!f)s.push(new $i(o,c,wt.empty));else{n=f;for(let g=0;g<u.marks.length;g++)r.allowsMarkType(u.marks[g].type)||t.step(new ul(o,c,u.marks[g]));if(i&&u.isText&&r.whitespace!="pre"){let g,v=/\r?\n|\r/g,x;for(;g=v.exec(u.text);)x||(x=new wt(Qe.from(r.schema.text(" ",r.allowedMarks(u.marks))),0,0)),s.push(new $i(o+g.index,o+g.index+g[0].length,x))}}o=c}if(!n.validEnd){let l=n.fillBefore(Qe.empty,!0);t.replace(o,o,new wt(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function sU(t,e,r){return(e==0||t.canReplace(e,t.childCount))&&(r==t.childCount||t.canReplace(0,r))}function jp(t){let r=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth,i=0,a=0;;--n){let s=t.$from.node(n),o=t.$from.index(n)+i,l=t.$to.indexAfter(n)-a;if(n<t.depth&&s.canReplace(o,l,r))return n;if(n==0||s.type.spec.isolating||!sU(s,o,l))break;o&&(i=1),l<s.childCount&&(a=1)}return null}function oU(t,e,r){let{$from:n,$to:i,depth:a}=e,s=n.before(a+1),o=i.after(a+1),l=s,u=o,c=Qe.empty,f=0;for(let x=a,_=!1;x>r;x--)_||n.index(x)>0?(_=!0,c=Qe.from(n.node(x).copy(c)),f++):l--;let g=Qe.empty,v=0;for(let x=a,_=!1;x>r;x--)_||i.after(x+1)<i.end(x)?(_=!0,g=Qe.from(i.node(x).copy(g)),v++):u++;t.step(new Yi(l,u,s,o,new wt(c.append(g),f,v),c.size-f,!0))}function sS(t,e,r=null,n=t){let i=lU(t,e),a=i&&uU(n,e);return a?i.map(fT).concat({type:e,attrs:r}).concat(a.map(fT)):null}function fT(t){return{type:t,attrs:null}}function lU(t,e){let{parent:r,startIndex:n,endIndex:i}=t,a=r.contentMatchAt(n).findWrapping(e);if(!a)return null;let s=a.length?a[0]:e;return r.canReplaceWith(n,i,s)?a:null}function uU(t,e){let{parent:r,startIndex:n,endIndex:i}=t,a=r.child(n),s=e.contentMatch.findWrapping(a.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let u=n;l&&u<i;u++)l=l.matchType(r.child(u).type);return!l||!l.validEnd?null:s}function cU(t,e,r){let n=Qe.empty;for(let s=r.length-1;s>=0;s--){if(n.size){let o=r[s].type.contentMatch.matchFragment(n);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=Qe.from(r[s].type.create(r[s].attrs,n))}let i=e.start,a=e.end;t.step(new Yi(i,a,i,a,new wt(n,0,0),r.length,!0))}function dU(t,e,r,n,i){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=t.steps.length;t.doc.nodesBetween(e,r,(s,o)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(n,l)&&hU(t.doc,t.mapping.slice(a).map(o),n)){let u=null;if(n.schema.linebreakReplacement){let v=n.whitespace=="pre",x=!!n.contentMatch.matchType(n.schema.linebreakReplacement);v&&!x?u=!1:!v&&x&&(u=!0)}u===!1&&n6(t,s,o,a),aS(t,t.mapping.slice(a).map(o,1),n,void 0,u===null);let c=t.mapping.slice(a),f=c.map(o,1),g=c.map(o+s.nodeSize,1);return t.step(new Yi(f,g,f+1,g-1,new wt(Qe.from(n.create(l,null,s.marks)),0,0),1,!0)),u===!0&&r6(t,s,o,a),!1}})}function r6(t,e,r,n){e.forEach((i,a)=>{if(i.isText){let s,o=/\r?\n|\r/g;for(;s=o.exec(i.text);){let l=t.mapping.slice(n).map(r+1+a+s.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function n6(t,e,r,n){e.forEach((i,a)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(n).map(r+1+a);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function hU(t,e,r){let n=t.resolve(e),i=n.index();return n.parent.canReplaceWith(i,i+1,r)}function fU(t,e,r,n,i){let a=t.doc.nodeAt(e);if(!a)throw new RangeError("No node at given position");r||(r=a.type);let s=r.create(n,null,i||a.marks);if(a.isLeaf)return t.replaceWith(e,e+a.nodeSize,s);if(!r.validContent(a.content))throw new RangeError("Invalid content for node type "+r.name);t.step(new Yi(e,e+a.nodeSize,e+1,e+a.nodeSize-1,new wt(Qe.from(s),0,0),1,!0))}function Hu(t,e,r=1,n){let i=t.resolve(e),a=i.depth-r,s=n&&n[n.length-1]||i.parent;if(a<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=r-2;u>a;u--,c--){let f=i.node(u),g=i.index(u);if(f.type.spec.isolating)return!1;let v=f.content.cutByIndex(g,f.childCount),x=n&&n[c+1];x&&(v=v.replaceChild(0,x.type.create(x.attrs)));let _=n&&n[c]||f;if(!f.canReplace(g+1,f.childCount)||!_.type.validContent(v))return!1}let o=i.indexAfter(a),l=n&&n[0];return i.node(a).canReplaceWith(o,o,l?l.type:i.node(a+1).type)}function pU(t,e,r=1,n){let i=t.doc.resolve(e),a=Qe.empty,s=Qe.empty;for(let o=i.depth,l=i.depth-r,u=r-1;o>l;o--,u--){a=Qe.from(i.node(o).copy(a));let c=n&&n[u];s=Qe.from(c?c.type.create(c.attrs,s):i.node(o).copy(s))}t.step(new $i(e,e,new wt(a.append(s),r,r),!0))}function Rd(t,e){let r=t.resolve(e),n=r.index();return i6(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function mU(t,e){e.content.size||t.type.compatibleContent(e.type);let r=t.contentMatchAt(t.childCount),{linebreakReplacement:n}=t.type.schema;for(let i=0;i<e.childCount;i++){let a=e.child(i),s=a.type==n?t.type.schema.nodes.text:a.type;if(r=r.matchType(s),!r||!t.type.allowsMarks(a.marks))return!1}return r.validEnd}function i6(t,e){return!!(t&&e&&!t.isLeaf&&mU(t,e))}function Lx(t,e,r=-1){let n=t.resolve(e);for(let i=n.depth;;i--){let a,s,o=n.index(i);if(i==n.depth?(a=n.nodeBefore,s=n.nodeAfter):r>0?(a=n.node(i+1),o++,s=n.node(i).maybeChild(o)):(a=n.node(i).maybeChild(o-1),s=n.node(i+1)),a&&!a.isTextblock&&i6(a,s)&&n.node(i).canReplace(o,o+1))return e;if(i==0)break;e=r<0?n.before(i):n.after(i)}}function gU(t,e,r){let n=null,{linebreakReplacement:i}=t.doc.type.schema,a=t.doc.resolve(e-r),s=a.node().type;if(i&&s.inlineContent){let c=s.whitespace=="pre",f=!!s.contentMatch.matchType(i);c&&!f?n=!1:!c&&f&&(n=!0)}let o=t.steps.length;if(n===!1){let c=t.doc.resolve(e+r);n6(t,c.node(),c.before(),o)}s.inlineContent&&aS(t,e+r-1,s,a.node().contentMatchAt(a.index()),n==null);let l=t.mapping.slice(o),u=l.map(e-r);if(t.step(new $i(u,l.map(e+r,-1),wt.empty,!0)),n===!0){let c=t.doc.resolve(u);r6(t,c.node(),c.before(),t.steps.length)}return t}function vU(t,e,r){let n=t.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),r))return e;if(n.parentOffset==0)for(let i=n.depth-1;i>=0;i--){let a=n.index(i);if(n.node(i).canReplaceWith(a,a,r))return n.before(i+1);if(a>0)return null}if(n.parentOffset==n.parent.content.size)for(let i=n.depth-1;i>=0;i--){let a=n.indexAfter(i);if(n.node(i).canReplaceWith(a,a,r))return n.after(i+1);if(a<n.node(i).childCount)return null}return null}function a6(t,e,r){let n=t.resolve(e);if(!r.content.size)return e;let i=r.content;for(let a=0;a<r.openStart;a++)i=i.firstChild.content;for(let a=1;a<=(r.openStart==0&&r.size?2:1);a++)for(let s=n.depth;s>=0;s--){let o=s==n.depth?0:n.pos<=(n.start(s+1)+n.end(s+1))/2?-1:1,l=n.index(s)+(o>0?1:0),u=n.node(s),c=!1;if(a==1)c=u.canReplace(l,l,i);else{let f=u.contentMatchAt(l).findWrapping(i.firstChild.type);c=f&&u.canReplaceWith(l,l,f[0])}if(c)return o==0?n.pos:o<0?n.before(s+1):n.after(s+1)}return null}function Ox(t,e,r=e,n=wt.empty){if(e==r&&!n.size)return null;let i=t.resolve(e),a=t.resolve(r);return s6(i,a,n)?new $i(e,r,n):new yU(i,a,n).fit()}function s6(t,e,r){return!r.openStart&&!r.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),r.content)}class yU{constructor(e,r,n){this.$from=e,this.$to=r,this.unplaced=n,this.frontier=[],this.placed=Qe.empty;for(let i=0;i<=e.depth;i++){let a=e.node(i);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=Qe.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let a=this.placed,s=n.depth,o=i.depth;for(;s&&o&&a.childCount==1;)a=a.firstChild.content,s--,o--;let l=new wt(a,s,o);return e>-1?new Yi(n.pos,e,this.$to.pos,this.$to.end(),l,r):l.size||n.pos!=this.$to.pos?new $i(n.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let r=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let a=r.firstChild;if(r.childCount>1&&(i=0),a.type.spec.isolating&&i<=n){e=n;break}r=a.content}for(let r=1;r<=2;r++)for(let n=r==1?e:this.unplaced.openStart;n>=0;n--){let i,a=null;n?(a=Lw(this.unplaced.content,n-1).firstChild,i=a.content):i=this.unplaced.content;let s=i.firstChild;for(let o=this.depth;o>=0;o--){let{type:l,match:u}=this.frontier[o],c,f=null;if(r==1&&(s?u.matchType(s.type)||(f=u.fillBefore(Qe.from(s),!1)):a&&l.compatibleContent(a.type)))return{sliceDepth:n,frontierDepth:o,parent:a,inject:f};if(r==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:o,parent:a,wrap:c};if(a&&u.matchType(a.type))break}}}openMore(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=Lw(e,r);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new wt(e,r+1,Math.max(n,i.size+r>=e.size-n?r+1:0)),!0)}dropNode(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=Lw(e,r);if(i.childCount<=1&&r>0){let a=e.size-r<=r+i.size;this.unplaced=new wt(cg(e,r-1,1),r-1,a?r-1:n)}else this.unplaced=new wt(cg(e,r,1),r,n)}placeNodes({sliceDepth:e,frontierDepth:r,parent:n,inject:i,wrap:a}){for(;this.depth>r;)this.closeFrontierNode();if(a)for(let _=0;_<a.length;_++)this.openFrontierNode(a[_]);let s=this.unplaced,o=n?n.content:s.content,l=s.openStart-e,u=0,c=[],{match:f,type:g}=this.frontier[r];if(i){for(let _=0;_<i.childCount;_++)c.push(i.child(_));f=f.matchFragment(i)}let v=o.size+e-(s.content.size-s.openEnd);for(;u<o.childCount;){let _=o.child(u),S=f.matchType(_.type);if(!S)break;u++,(u>1||l==0||_.content.size)&&(f=S,c.push(o6(_.mark(g.allowedMarks(_.marks)),u==1?l:0,u==o.childCount?v:-1)))}let x=u==o.childCount;x||(v=-1),this.placed=dg(this.placed,r,Qe.from(c)),this.frontier[r].match=f,x&&v<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let _=0,S=o;_<v;_++){let N=S.lastChild;this.frontier.push({type:N.type,match:N.contentMatchAt(N.childCount)}),S=N.content}this.unplaced=x?e==0?wt.empty:new wt(cg(s.content,e-1,1),e-1,v<0?s.openEnd:e-1):new wt(cg(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],r;if(!e.type.isTextblock||!Ow(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let r=Math.min(this.depth,e.depth);r>=0;r--){let{match:n,type:i}=this.frontier[r],a=r<e.depth&&e.end(r+1)==e.pos+(e.depth-(r+1)),s=Ow(e,r,i,n,a);if(s){for(let o=r-1;o>=0;o--){let{match:l,type:u}=this.frontier[o],c=Ow(e,o,u,l,!0);if(!c||c.childCount)continue e}return{depth:r,fit:s,move:a?e.doc.resolve(e.after(r+1)):e}}}}close(e){let r=this.findCloseLevel(e);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=dg(this.placed,r.depth,r.fit)),e=r.move;for(let n=r.depth+1;n<=e.depth;n++){let i=e.node(n),a=i.type.contentMatch.fillBefore(i.content,!0,e.index(n));this.openFrontierNode(i.type,i.attrs,a)}return e}openFrontierNode(e,r=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=dg(this.placed,this.depth,Qe.from(e.create(r,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(Qe.empty,!0);r.childCount&&(this.placed=dg(this.placed,this.frontier.length,r))}}function cg(t,e,r){return e==0?t.cutByIndex(r,t.childCount):t.replaceChild(0,t.firstChild.copy(cg(t.firstChild.content,e-1,r)))}function dg(t,e,r){return e==0?t.append(r):t.replaceChild(t.childCount-1,t.lastChild.copy(dg(t.lastChild.content,e-1,r)))}function Lw(t,e){for(let r=0;r<e;r++)t=t.firstChild.content;return t}function o6(t,e,r){if(e<=0)return t;let n=t.content;return e>1&&(n=n.replaceChild(0,o6(n.firstChild,e-1,n.childCount==1?r-1:0))),e>0&&(n=t.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(t.type.contentMatch.matchFragment(n).fillBefore(Qe.empty,!0)))),t.copy(n)}function Ow(t,e,r,n,i){let a=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==a.childCount&&!r.compatibleContent(a.type))return null;let o=n.fillBefore(a.content,!0,s);return o&&!xU(r,a.content,s)?o:null}function xU(t,e,r){for(let n=r;n<e.childCount;n++)if(!t.allowsMarks(e.child(n).marks))return!0;return!1}function bU(t){return t.spec.defining||t.spec.definingForContent}function wU(t,e,r,n){if(!n.size)return t.deleteRange(e,r);let i=t.doc.resolve(e),a=t.doc.resolve(r);if(s6(i,a,n))return t.step(new $i(e,r,n));let s=u6(i,a);s[s.length-1]==0&&s.pop();let o=-(i.depth+1);s.unshift(o);for(let g=i.depth,v=i.pos-1;g>0;g--,v--){let x=i.node(g).type.spec;if(x.defining||x.definingAsContext||x.isolating)break;s.indexOf(g)>-1?o=g:i.before(g)==v&&s.splice(1,0,-g)}let l=s.indexOf(o),u=[],c=n.openStart;for(let g=n.content,v=0;;v++){let x=g.firstChild;if(u.push(x),v==n.openStart)break;g=x.content}for(let g=c-1;g>=0;g--){let v=u[g],x=bU(v.type);if(x&&!v.sameMarkup(i.node(Math.abs(o)-1)))c=g;else if(x||!v.type.isTextblock)break}for(let g=n.openStart;g>=0;g--){let v=(g+c+1)%(n.openStart+1),x=u[v];if(x)for(let _=0;_<s.length;_++){let S=s[(_+l)%s.length],N=!0;S<0&&(N=!1,S=-S);let k=i.node(S-1),E=i.index(S-1);if(k.canReplaceWith(E,E,x.type,x.marks))return t.replace(i.before(S),N?a.after(S):r,new wt(l6(n.content,0,n.openStart,v),v,n.openEnd))}}let f=t.steps.length;for(let g=s.length-1;g>=0&&(t.replace(e,r,n),!(t.steps.length>f));g--){let v=s[g];v<0||(e=i.before(v),r=a.after(v))}}function l6(t,e,r,n,i){if(e<r){let a=t.firstChild;t=t.replaceChild(0,a.copy(l6(a.content,e+1,r,n,a)))}if(e>n){let a=i.contentMatchAt(0),s=a.fillBefore(t).append(t);t=s.append(a.matchFragment(s).fillBefore(Qe.empty,!0))}return t}function _U(t,e,r,n){if(!n.isInline&&e==r&&t.doc.resolve(e).parent.content.size){let i=vU(t.doc,e,n.type);i!=null&&(e=r=i)}t.replaceRange(e,r,new wt(Qe.from(n),0,0))}function SU(t,e,r){let n=t.doc.resolve(e),i=t.doc.resolve(r),a=u6(n,i);for(let s=0;s<a.length;s++){let o=a[s],l=s==a.length-1;if(l&&o==0||n.node(o).type.contentMatch.validEnd)return t.delete(n.start(o),i.end(o));if(o>0&&(l||n.node(o-1).canReplace(n.index(o-1),i.indexAfter(o-1))))return t.delete(n.before(o),i.after(o))}for(let s=1;s<=n.depth&&s<=i.depth;s++)if(e-n.start(s)==n.depth-s&&r>n.end(s)&&i.end(s)-r!=i.depth-s&&n.start(s-1)==i.start(s-1)&&n.node(s-1).canReplace(n.index(s-1),i.index(s-1)))return t.delete(n.before(s),r);t.delete(e,r)}function u6(t,e){let r=[],n=Math.min(t.depth,e.depth);for(let i=n;i>=0;i--){let a=t.start(i);if(a<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(a==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==a-1)&&r.push(i)}return r}class sp extends Wa{constructor(e,r,n){super(),this.pos=e,this.attr=r,this.value=n}apply(e){let r=e.nodeAt(this.pos);if(!r)return xi.fail("No node at attribute step's position");let n=Object.create(null);for(let a in r.attrs)n[a]=r.attrs[a];n[this.attr]=this.value;let i=r.type.create(n,null,r.marks);return xi.fromReplace(e,this.pos,this.pos+1,new wt(Qe.from(i),0,r.isLeaf?0:1))}getMap(){return Zs.empty}invert(e){return new sp(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new sp(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new sp(r.pos,r.attr,r.value)}}Wa.jsonID("attr",sp);class Wg extends Wa{constructor(e,r){super(),this.attr=e,this.value=r}apply(e){let r=Object.create(null);for(let i in e.attrs)r[i]=e.attrs[i];r[this.attr]=this.value;let n=e.type.create(r,e.content,e.marks);return xi.ok(n)}getMap(){return Zs.empty}invert(e){return new Wg(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Wg(r.attr,r.value)}}Wa.jsonID("docAttr",Wg);let hp=class extends Error{};hp=function t(e){let r=Error.call(this,e);return r.__proto__=t.prototype,r};hp.prototype=Object.create(Error.prototype);hp.prototype.constructor=hp;hp.prototype.name="TransformError";class c6{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new qg}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let r=this.maybeStep(e);if(r.failed)throw new hp(r.failed);return this}maybeStep(e){let r=e.apply(this.doc);return r.failed||this.addStep(e,r.doc),r}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,r=-1e9;for(let n=0;n<this.mapping.maps.length;n++){let i=this.mapping.maps[n];n&&(e=i.map(e,1),r=i.map(r,-1)),i.forEach((a,s,o,l)=>{e=Math.min(e,o),r=Math.max(r,l)})}return e==1e9?null:{from:e,to:r}}addStep(e,r){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=r}replace(e,r=e,n=wt.empty){let i=Ox(this.doc,e,r,n);return i&&this.step(i),this}replaceWith(e,r,n){return this.replace(e,r,new wt(Qe.from(n),0,0))}delete(e,r){return this.replace(e,r,wt.empty)}insert(e,r){return this.replaceWith(e,e,r)}replaceRange(e,r,n){return wU(this,e,r,n),this}replaceRangeWith(e,r,n){return _U(this,e,r,n),this}deleteRange(e,r){return SU(this,e,r),this}lift(e,r){return oU(this,e,r),this}join(e,r=1){return gU(this,e,r),this}wrap(e,r){return cU(this,e,r),this}setBlockType(e,r=e,n,i=null){return dU(this,e,r,n,i),this}setNodeMarkup(e,r,n=null,i){return fU(this,e,r,n,i),this}setNodeAttribute(e,r,n){return this.step(new sp(e,r,n)),this}setDocAttribute(e,r){return this.step(new Wg(e,r)),this}addNodeMark(e,r){return this.step(new ld(e,r)),this}removeNodeMark(e,r){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(r instanceof en)r.isInSet(n.marks)&&this.step(new Vh(e,r));else{let i=n.marks,a,s=[];for(;a=r.isInSet(i);)s.push(new Vh(e,a)),i=a.removeFromSet(i);for(let o=s.length-1;o>=0;o--)this.step(s[o])}return this}split(e,r=1,n){return pU(this,e,r,n),this}addMark(e,r,n){return iU(this,e,r,n),this}removeMark(e,r,n){return aU(this,e,r,n),this}clearIncompatible(e,r,n){return aS(this,e,r,n),this}}const Dw=Object.create(null);class ar{constructor(e,r,n){this.$anchor=e,this.$head=r,this.ranges=n||[new kU(e.min(r),e.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let r=0;r<e.length;r++)if(e[r].$from.pos!=e[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,r=wt.empty){let n=r.content.lastChild,i=null;for(let o=0;o<r.openEnd;o++)i=n,n=n.lastChild;let a=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:l,$to:u}=s[o],c=e.mapping.slice(a);e.replaceRange(c.map(l.pos),c.map(u.pos),o?wt.empty:r),o==0&&gT(e,a,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,r){let n=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:s,$to:o}=i[a],l=e.mapping.slice(n),u=l.map(s.pos),c=l.map(o.pos);a?e.deleteRange(u,c):(e.replaceRangeWith(u,c,r),gT(e,n,r.isInline?-1:1))}}static findFrom(e,r,n=!1){let i=e.parent.inlineContent?new Yt(e):Wf(e.node(0),e.parent,e.pos,e.index(),r,n);if(i)return i;for(let a=e.depth-1;a>=0;a--){let s=r<0?Wf(e.node(0),e.node(a),e.before(a+1),e.index(a),r,n):Wf(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,r,n);if(s)return s}return null}static near(e,r=1){return this.findFrom(e,r)||this.findFrom(e,-r)||new Xs(e.node(0))}static atStart(e){return Wf(e,e,0,0,1)||new Xs(e)}static atEnd(e){return Wf(e,e,e.content.size,e.childCount,-1)||new Xs(e)}static fromJSON(e,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=Dw[r.type];if(!n)throw new RangeError(`No selection type ${r.type} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in Dw)throw new RangeError("Duplicate use of selection JSON ID "+e);return Dw[e]=r,r.prototype.jsonID=e,r}getBookmark(){return Yt.between(this.$anchor,this.$head).getBookmark()}}ar.prototype.visible=!0;class kU{constructor(e,r){this.$from=e,this.$to=r}}let pT=!1;function mT(t){!pT&&!t.parent.inlineContent&&(pT=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Yt extends ar{constructor(e,r=e){mT(e),mT(r),super(e,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,r){let n=e.resolve(r.map(this.head));if(!n.parent.inlineContent)return ar.near(n);let i=e.resolve(r.map(this.anchor));return new Yt(i.parent.inlineContent?i:n,n)}replace(e,r=wt.empty){if(super.replace(e,r),r==wt.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof Yt&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Dx(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Yt(e.resolve(r.anchor),e.resolve(r.head))}static create(e,r,n=r){let i=e.resolve(r);return new this(i,n==r?i:e.resolve(n))}static between(e,r,n){let i=e.pos-r.pos;if((!n||i)&&(n=i>=0?1:-1),!r.parent.inlineContent){let a=ar.findFrom(r,n,!0)||ar.findFrom(r,-n,!0);if(a)r=a.$head;else return ar.near(r,n)}return e.parent.inlineContent||(i==0?e=r:(e=(ar.findFrom(e,-n,!0)||ar.findFrom(e,n,!0)).$anchor,e.pos<r.pos!=i<0&&(e=r))),new Yt(e,r)}}ar.jsonID("text",Yt);class Dx{constructor(e,r){this.anchor=e,this.head=r}map(e){return new Dx(e.map(this.anchor),e.map(this.head))}resolve(e){return Yt.between(e.resolve(this.anchor),e.resolve(this.head))}}class It extends ar{constructor(e){let r=e.nodeAfter,n=e.node(0).resolve(e.pos+r.nodeSize);super(e,n),this.node=r}map(e,r){let{deleted:n,pos:i}=r.mapResult(this.anchor),a=e.resolve(i);return n?ar.near(a):new It(a)}content(){return new wt(Qe.from(this.node),0,0)}eq(e){return e instanceof It&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new oS(this.anchor)}static fromJSON(e,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new It(e.resolve(r.anchor))}static create(e,r){return new It(e.resolve(r))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}It.prototype.visible=!1;ar.jsonID("node",It);class oS{constructor(e){this.anchor=e}map(e){let{deleted:r,pos:n}=e.mapResult(this.anchor);return r?new Dx(n,n):new oS(n)}resolve(e){let r=e.resolve(this.anchor),n=r.nodeAfter;return n&&It.isSelectable(n)?new It(r):ar.near(r)}}class Xs extends ar{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,r=wt.empty){if(r==wt.empty){e.delete(0,e.doc.content.size);let n=ar.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,r)}toJSON(){return{type:"all"}}static fromJSON(e){return new Xs(e)}map(e){return new Xs(e)}eq(e){return e instanceof Xs}getBookmark(){return CU}}ar.jsonID("all",Xs);const CU={map(){return this},resolve(t){return new Xs(t)}};function Wf(t,e,r,n,i,a=!1){if(e.inlineContent)return Yt.create(t,r);for(let s=n-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let o=e.child(s);if(o.isAtom){if(!a&&It.isSelectable(o))return It.create(t,r-(i<0?o.nodeSize:0))}else{let l=Wf(t,o,r+i,i<0?o.childCount:0,i,a);if(l)return l}r+=o.nodeSize*i}return null}function gT(t,e,r){let n=t.steps.length-1;if(n<e)return;let i=t.steps[n];if(!(i instanceof $i||i instanceof Yi))return;let a=t.mapping.maps[n],s;a.forEach((o,l,u,c)=>{s==null&&(s=c)}),t.setSelection(ar.near(t.doc.resolve(s),r))}const vT=1,_0=2,yT=4;class EU extends c6{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|vT)&~_0,this.storedMarks=null,this}get selectionSet(){return(this.updated&vT)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=_0,this}ensureMarks(e){return en.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&_0)>0}addStep(e,r){super.addStep(e,r),this.updated=this.updated&~_0,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,r=!0){let n=this.selection;return r&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||en.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,r,n){let i=this.doc.type.schema;if(r==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(n==null&&(n=r),!e)return this.deleteRange(r,n);let a=this.storedMarks;if(!a){let s=this.doc.resolve(r);a=n==r?s.marks():s.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(r,n,i.text(e,a)),!this.selection.empty&&this.selection.to==r+e.length&&this.setSelection(ar.near(this.selection.$to)),this}}setMeta(e,r){return this.meta[typeof e=="string"?e:e.key]=r,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=yT,this}get scrolledIntoView(){return(this.updated&yT)>0}}function xT(t,e){return!e||!t?t:t.bind(e)}class hg{constructor(e,r,n){this.name=e,this.init=xT(r.init,n),this.apply=xT(r.apply,n)}}const NU=[new hg("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new hg("selection",{init(t,e){return t.selection||ar.atStart(e.doc)},apply(t){return t.selection}}),new hg("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,r,n){return n.selection.$cursor?t.storedMarks:null}}),new hg("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Iw{constructor(e,r){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=NU.slice(),r&&r.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new hg(n.key,n.spec.state,n))})}}class ep{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,r=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=r){let i=this.config.plugins[n];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let r=[e],n=this.applyInner(e),i=null;for(;;){let a=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let l=i?i[s].n:0,u=i?i[s].state:this,c=l<r.length&&o.spec.appendTransaction.call(o,l?r.slice(l):r,u,n);if(c&&n.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<s?{state:n,n:r.length}:{state:this,n:0})}r.push(c),n=n.applyInner(c),a=!0}i&&(i[s]={state:n,n:r.length})}}if(!a)return{state:n,transactions:r}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let r=new ep(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let a=n[i];r[a.name]=a.apply(e,this[a.name],this,r)}return r}get tr(){return new EU(this)}static create(e){let r=new Iw(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new ep(r);for(let i=0;i<r.fields.length;i++)n[r.fields[i].name]=r.fields[i].init(e,n);return n}reconfigure(e){let r=new Iw(this.schema,e.plugins),n=r.fields,i=new ep(r);for(let a=0;a<n.length;a++){let s=n[a].name;i[s]=this.hasOwnProperty(s)?this[s]:n[a].init(e,i)}return i}toJSON(e){let r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(n=>n.toJSON())),e&&typeof e=="object")for(let n in e){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[n],a=i.spec.state;a&&a.toJSON&&(r[n]=a.toJSON.call(i,this[i.key]))}return r}static fromJSON(e,r,n){if(!r)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Iw(e.schema,e.plugins),a=new ep(i);return i.fields.forEach(s=>{if(s.name=="doc")a.doc=To.fromJSON(e.schema,r.doc);else if(s.name=="selection")a.selection=ar.fromJSON(a.doc,r.selection);else if(s.name=="storedMarks")r.storedMarks&&(a.storedMarks=r.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let o in n){let l=n[o],u=l.spec.state;if(l.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(r,o)){a[s.name]=u.fromJSON.call(l,e,r[o],a);return}}a[s.name]=s.init(e,a)}}),a}}function d6(t,e,r){for(let n in t){let i=t[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=d6(i,e,{})),r[n]=i}return r}class Ln{constructor(e){this.spec=e,this.props={},e.props&&d6(e.props,this,this.props),this.key=e.key?e.key.key:h6("plugin")}getState(e){return e[this.key]}}const Bw=Object.create(null);function h6(t){return t in Bw?t+"$"+ ++Bw[t]:(Bw[t]=0,t+"$")}class oi{constructor(e="key"){this.key=h6(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const lS=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function f6(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("backward",t):r.parentOffset>0)?null:r}const p6=(t,e,r)=>{let n=f6(t,r);if(!n)return!1;let i=uS(n);if(!i){let s=n.blockRange(),o=s&&jp(s);return o==null?!1:(e&&e(t.tr.lift(s,o).scrollIntoView()),!0)}let a=i.nodeBefore;if(S6(t,i,e,-1))return!0;if(n.parent.content.size==0&&(fp(a,"end")||It.isSelectable(a)))for(let s=n.depth;;s--){let o=Ox(t.doc,n.before(s),n.after(s),wt.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(fp(a,"end")?ar.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):It.create(l.doc,i.pos-a.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||n.node(s-1).childCount>1)break}return a.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos-a.nodeSize,i.pos).scrollIntoView()),!0):!1},TU=(t,e,r)=>{let n=f6(t,r);if(!n)return!1;let i=uS(n);return i?m6(t,i,e):!1},PU=(t,e,r)=>{let n=v6(t,r);if(!n)return!1;let i=cS(n);return i?m6(t,i,e):!1};function m6(t,e,r){let n=e.nodeBefore,i=n,a=e.pos-1;for(;!i.isTextblock;a--){if(i.type.spec.isolating)return!1;let c=i.lastChild;if(!c)return!1;i=c}let s=e.nodeAfter,o=s,l=e.pos+1;for(;!o.isTextblock;l++){if(o.type.spec.isolating)return!1;let c=o.firstChild;if(!c)return!1;o=c}let u=Ox(t.doc,a,l,wt.empty);if(!u||u.from!=a||u instanceof $i&&u.slice.size>=l-a)return!1;if(r){let c=t.tr.step(u);c.setSelection(Yt.create(c.doc,a)),r(c.scrollIntoView())}return!0}function fp(t,e,r=!1){for(let n=t;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const g6=(t,e,r)=>{let{$head:n,empty:i}=t.selection,a=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",t):n.parentOffset>0)return!1;a=uS(n)}let s=a&&a.nodeBefore;return!s||!It.isSelectable(s)?!1:(e&&e(t.tr.setSelection(It.create(t.doc,a.pos-s.nodeSize)).scrollIntoView()),!0)};function uS(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function v6(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)?null:r}const y6=(t,e,r)=>{let n=v6(t,r);if(!n)return!1;let i=cS(n);if(!i)return!1;let a=i.nodeAfter;if(S6(t,i,e,1))return!0;if(n.parent.content.size==0&&(fp(a,"start")||It.isSelectable(a))){let s=Ox(t.doc,n.before(),n.after(),wt.empty);if(s&&s.slice.size<s.to-s.from){if(e){let o=t.tr.step(s);o.setSelection(fp(a,"start")?ar.findFrom(o.doc.resolve(o.mapping.map(i.pos)),1):It.create(o.doc,o.mapping.map(i.pos))),e(o.scrollIntoView())}return!0}}return a.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+a.nodeSize).scrollIntoView()),!0):!1},x6=(t,e,r)=>{let{$head:n,empty:i}=t.selection,a=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)return!1;a=cS(n)}let s=a&&a.nodeAfter;return!s||!It.isSelectable(s)?!1:(e&&e(t.tr.setSelection(It.create(t.doc,a.pos)).scrollIntoView()),!0)};function cS(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let r=t.node(e);if(t.index(e)+1<r.childCount)return t.doc.resolve(t.after(e+1));if(r.type.spec.isolating)break}return null}const MU=(t,e)=>{let r=t.selection,n=r instanceof It,i;if(n){if(r.node.isTextblock||!Rd(t.doc,r.from))return!1;i=r.from}else if(i=Lx(t.doc,r.from,-1),i==null)return!1;if(e){let a=t.tr.join(i);n&&a.setSelection(It.create(a.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(a.scrollIntoView())}return!0},AU=(t,e)=>{let r=t.selection,n;if(r instanceof It){if(r.node.isTextblock||!Rd(t.doc,r.to))return!1;n=r.to}else if(n=Lx(t.doc,r.to,1),n==null)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0},jU=(t,e)=>{let{$from:r,$to:n}=t.selection,i=r.blockRange(n),a=i&&jp(i);return a==null?!1:(e&&e(t.tr.lift(i,a).scrollIntoView()),!0)},b6=(t,e)=>{let{$head:r,$anchor:n}=t.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function dS(t){for(let e=0;e<t.edgeCount;e++){let{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const RU=(t,e)=>{let{$head:r,$anchor:n}=t.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let i=r.node(-1),a=r.indexAfter(-1),s=dS(i.contentMatchAt(a));if(!s||!i.canReplaceWith(a,a,s))return!1;if(e){let o=r.after(),l=t.tr.replaceWith(o,o,s.createAndFill());l.setSelection(ar.near(l.doc.resolve(o),1)),e(l.scrollIntoView())}return!0},w6=(t,e)=>{let r=t.selection,{$from:n,$to:i}=r;if(r instanceof Xs||n.parent.inlineContent||i.parent.inlineContent)return!1;let a=dS(i.parent.contentMatchAt(i.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){let s=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,o=t.tr.insert(s,a.createAndFill());o.setSelection(Yt.create(o.doc,s+1)),e(o.scrollIntoView())}return!0},_6=(t,e)=>{let{$cursor:r}=t.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let a=r.before();if(Hu(t.doc,a))return e&&e(t.tr.split(a).scrollIntoView()),!0}let n=r.blockRange(),i=n&&jp(n);return i==null?!1:(e&&e(t.tr.lift(n,i).scrollIntoView()),!0)};function LU(t){return(e,r)=>{let{$from:n,$to:i}=e.selection;if(e.selection instanceof It&&e.selection.node.isBlock)return!n.parentOffset||!Hu(e.doc,n.pos)?!1:(r&&r(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let a=[],s,o,l=!1,u=!1;for(let v=n.depth;;v--)if(n.node(v).isBlock){l=n.end(v)==n.pos+(n.depth-v),u=n.start(v)==n.pos-(n.depth-v),o=dS(n.node(v-1).contentMatchAt(n.indexAfter(v-1))),a.unshift(l&&o?{type:o}:null),s=v;break}else{if(v==1)return!1;a.unshift(null)}let c=e.tr;(e.selection instanceof Yt||e.selection instanceof Xs)&&c.deleteSelection();let f=c.mapping.map(n.pos),g=Hu(c.doc,f,a.length,a);if(g||(a[0]=o?{type:o}:null,g=Hu(c.doc,f,a.length,a)),!g)return!1;if(c.split(f,a.length,a),!l&&u&&n.node(s).type!=o){let v=c.mapping.map(n.before(s)),x=c.doc.resolve(v);o&&n.node(s-1).canReplaceWith(x.index(),x.index()+1,o)&&c.setNodeMarkup(c.mapping.map(n.before(s)),o)}return r&&r(c.scrollIntoView()),!0}}const OU=LU(),DU=(t,e)=>{let{$from:r,to:n}=t.selection,i,a=r.sharedDepth(n);return a==0?!1:(i=r.before(a),e&&e(t.tr.setSelection(It.create(t.doc,i))),!0)};function IU(t,e,r){let n=e.nodeBefore,i=e.nodeAfter,a=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(a-1,a)?(r&&r(t.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(a,a+1)||!(i.isTextblock||Rd(t.doc,e.pos))?!1:(r&&r(t.tr.join(e.pos).scrollIntoView()),!0)}function S6(t,e,r,n){let i=e.nodeBefore,a=e.nodeAfter,s,o,l=i.type.spec.isolating||a.type.spec.isolating;if(!l&&IU(t,e,r))return!0;let u=!l&&e.parent.canReplace(e.index(),e.index()+1);if(u&&(s=(o=i.contentMatchAt(i.childCount)).findWrapping(a.type))&&o.matchType(s[0]||a.type).validEnd){if(r){let v=e.pos+a.nodeSize,x=Qe.empty;for(let N=s.length-1;N>=0;N--)x=Qe.from(s[N].create(null,x));x=Qe.from(i.copy(x));let _=t.tr.step(new Yi(e.pos-1,v,e.pos,v,new wt(x,1,0),s.length,!0)),S=_.doc.resolve(v+2*s.length);S.nodeAfter&&S.nodeAfter.type==i.type&&Rd(_.doc,S.pos)&&_.join(S.pos),r(_.scrollIntoView())}return!0}let c=a.type.spec.isolating||n>0&&l?null:ar.findFrom(e,1),f=c&&c.$from.blockRange(c.$to),g=f&&jp(f);if(g!=null&&g>=e.depth)return r&&r(t.tr.lift(f,g).scrollIntoView()),!0;if(u&&fp(a,"start",!0)&&fp(i,"end")){let v=i,x=[];for(;x.push(v),!v.isTextblock;)v=v.lastChild;let _=a,S=1;for(;!_.isTextblock;_=_.firstChild)S++;if(v.canReplace(v.childCount,v.childCount,_.content)){if(r){let N=Qe.empty;for(let E=x.length-1;E>=0;E--)N=Qe.from(x[E].copy(N));let k=t.tr.step(new Yi(e.pos-x.length,e.pos+a.nodeSize,e.pos+S,e.pos+a.nodeSize-S,new wt(N,x.length,0),0,!0));r(k.scrollIntoView())}return!0}}return!1}function k6(t){return function(e,r){let n=e.selection,i=t<0?n.$from:n.$to,a=i.depth;for(;i.node(a).isInline;){if(!a)return!1;a--}return i.node(a).isTextblock?(r&&r(e.tr.setSelection(Yt.create(e.doc,t<0?i.start(a):i.end(a)))),!0):!1}}const BU=k6(-1),zU=k6(1);function FU(t,e=null){return function(r,n){let{$from:i,$to:a}=r.selection,s=i.blockRange(a),o=s&&sS(s,t,e);return o?(n&&n(r.tr.wrap(s,o).scrollIntoView()),!0):!1}}function bT(t,e=null){return function(r,n){let i=!1;for(let a=0;a<r.selection.ranges.length&&!i;a++){let{$from:{pos:s},$to:{pos:o}}=r.selection.ranges[a];r.doc.nodesBetween(s,o,(l,u)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)i=!0;else{let c=r.doc.resolve(u),f=c.index();i=c.parent.canReplaceWith(f,f+1,t)}})}if(!i)return!1;if(n){let a=r.tr;for(let s=0;s<r.selection.ranges.length;s++){let{$from:{pos:o},$to:{pos:l}}=r.selection.ranges[s];a.setBlockType(o,l,t,e)}n(a.scrollIntoView())}return!0}}function hS(...t){return function(e,r,n){for(let i=0;i<t.length;i++)if(t[i](e,r,n))return!0;return!1}}hS(lS,p6,g6);hS(lS,y6,x6);hS(b6,w6,_6,OU);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function VU(t,e=null){return function(r,n){let{$from:i,$to:a}=r.selection,s=i.blockRange(a);if(!s)return!1;let o=n?r.tr:null;return UU(o,s,t,e)?(n&&n(o.scrollIntoView()),!0):!1}}function UU(t,e,r,n=null){let i=!1,a=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(r)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);a=new xy(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new xy(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let o=sS(a,r,n,e);return o?(t&&HU(t,e,o,i,r),!0):!1}function HU(t,e,r,n,i){let a=Qe.empty;for(let c=r.length-1;c>=0;c--)a=Qe.from(r[c].type.create(r[c].attrs,a));t.step(new Yi(e.start-(n?2:0),e.end,e.start,e.end,new wt(a,0,0),r.length,!0));let s=0;for(let c=0;c<r.length;c++)r[c].type==i&&(s=c+1);let o=r.length-s,l=e.start+r.length-(n?2:0),u=e.parent;for(let c=e.startIndex,f=e.endIndex,g=!0;c<f;c++,g=!1)!g&&Hu(t.doc,l,o)&&(t.split(l,o),l+=2*o),l+=u.child(c).nodeSize;return t}function GU(t){return function(e,r){let{$from:n,$to:i}=e.selection,a=n.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return a?r?n.node(a.depth-1).type==t?qU(e,r,t,a):WU(e,r,a):!0:!1}}function qU(t,e,r,n){let i=t.tr,a=n.end,s=n.$to.end(n.depth);a<s&&(i.step(new Yi(a-1,s,a,s,new wt(Qe.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new xy(i.doc.resolve(n.$from.pos),i.doc.resolve(s),n.depth));const o=jp(n);if(o==null)return!1;i.lift(n,o);let l=i.doc.resolve(i.mapping.map(a,-1)-1);return Rd(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function WU(t,e,r){let n=t.tr,i=r.parent;for(let v=r.end,x=r.endIndex-1,_=r.startIndex;x>_;x--)v-=i.child(x).nodeSize,n.delete(v-1,v+1);let a=n.doc.resolve(r.start),s=a.nodeAfter;if(n.mapping.map(r.end)!=r.start+a.nodeAfter.nodeSize)return!1;let o=r.startIndex==0,l=r.endIndex==i.childCount,u=a.node(-1),c=a.index(-1);if(!u.canReplace(c+(o?0:1),c+1,s.content.append(l?Qe.empty:Qe.from(i))))return!1;let f=a.pos,g=f+s.nodeSize;return n.step(new Yi(f-(o?1:0),g+(l?1:0),f+1,g-1,new wt((o?Qe.empty:Qe.from(i.copy(Qe.empty))).append(l?Qe.empty:Qe.from(i.copy(Qe.empty))),o?0:1,l?0:1),o?0:1)),e(n.scrollIntoView()),!0}function $U(t){return function(e,r){let{$from:n,$to:i}=e.selection,a=n.blockRange(i,u=>u.childCount>0&&u.firstChild.type==t);if(!a)return!1;let s=a.startIndex;if(s==0)return!1;let o=a.parent,l=o.child(s-1);if(l.type!=t)return!1;if(r){let u=l.lastChild&&l.lastChild.type==o.type,c=Qe.from(u?t.create():null),f=new wt(Qe.from(t.create(null,Qe.from(o.type.create(null,c)))),u?3:1,0),g=a.start,v=a.end;r(e.tr.step(new Yi(g-(u?3:1),v,g,v,f,1,!0)).scrollIntoView())}return!0}}const ba=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},pp=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let H2=null;const zu=function(t,e,r){let n=H2||(H2=document.createRange());return n.setEnd(t,r??t.nodeValue.length),n.setStart(t,e||0),n},KU=function(){H2=null},Uh=function(t,e,r,n){return r&&(wT(t,e,r,n,-1)||wT(t,e,r,n,1))},ZU=/^(img|br|input|textarea|hr)$/i;function wT(t,e,r,n,i){for(var a;;){if(t==r&&e==n)return!0;if(e==(i<0?0:Eo(t))){let s=t.parentNode;if(!s||s.nodeType!=1||gv(t)||ZU.test(t.nodeName)||t.contentEditable=="false")return!1;e=ba(t)+(i<0?0:1),t=s}else if(t.nodeType==1){let s=t.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((a=s.pmViewDesc)===null||a===void 0)&&a.ignoreForSelection)e+=i;else return!1;else t=s,e=i<0?Eo(t):0}else return!1}}function Eo(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function YU(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=Eo(t)}else if(t.parentNode&&!gv(t))e=ba(t),t=t.parentNode;else return null}}function XU(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!gv(t))e=ba(t)+1,t=t.parentNode;else return null}}function QU(t,e,r){for(let n=e==0,i=e==Eo(t);n||i;){if(t==r)return!0;let a=ba(t);if(t=t.parentNode,!t)return!1;n=n&&a==0,i=i&&a==Eo(t)}}function gv(t){let e;for(let r=t;r&&!(e=r.pmViewDesc);r=r.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Ix=function(t){return t.focusNode&&Uh(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function bh(t,e){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=t,r.key=r.code=e,r}function JU(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function eH(t,e,r){if(t.caretPositionFromPoint)try{let n=t.caretPositionFromPoint(e,r);if(n)return{node:n.offsetNode,offset:Math.min(Eo(n.offsetNode),n.offset)}}catch{}if(t.caretRangeFromPoint){let n=t.caretRangeFromPoint(e,r);if(n)return{node:n.startContainer,offset:Math.min(Eo(n.startContainer),n.startOffset)}}}const eu=typeof navigator<"u"?navigator:null,_T=typeof document<"u"?document:null,Ld=eu&&eu.userAgent||"",G2=/Edge\/(\d+)/.exec(Ld),C6=/MSIE \d/.exec(Ld),q2=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ld),js=!!(C6||q2||G2),md=C6?document.documentMode:q2?+q2[1]:G2?+G2[1]:0,Po=!js&&/gecko\/(\d+)/i.test(Ld);Po&&+(/Firefox\/(\d+)/.exec(Ld)||[0,0])[1];const W2=!js&&/Chrome\/(\d+)/.exec(Ld),Ki=!!W2,E6=W2?+W2[1]:0,ka=!js&&!!eu&&/Apple Computer/.test(eu.vendor),mp=ka&&(/Mobile\/\w+/.test(Ld)||!!eu&&eu.maxTouchPoints>2),ko=mp||(eu?/Mac/.test(eu.platform):!1),N6=eu?/Win/.test(eu.platform):!1,Uu=/Android \d/.test(Ld),vv=!!_T&&"webkitFontSmoothing"in _T.documentElement.style,tH=vv?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function rH(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Ou(t,e){return typeof t=="number"?t:t[e]}function nH(t){let e=t.getBoundingClientRect(),r=e.width/t.offsetWidth||1,n=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*r,top:e.top,bottom:e.top+t.clientHeight*n}}function ST(t,e,r){let n=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,a=t.dom.ownerDocument;for(let s=r||t.dom;s;){if(s.nodeType!=1){s=pp(s);continue}let o=s,l=o==a.body,u=l?rH(a):nH(o),c=0,f=0;if(e.top<u.top+Ou(n,"top")?f=-(u.top-e.top+Ou(i,"top")):e.bottom>u.bottom-Ou(n,"bottom")&&(f=e.bottom-e.top>u.bottom-u.top?e.top+Ou(i,"top")-u.top:e.bottom-u.bottom+Ou(i,"bottom")),e.left<u.left+Ou(n,"left")?c=-(u.left-e.left+Ou(i,"left")):e.right>u.right-Ou(n,"right")&&(c=e.right-u.right+Ou(i,"right")),c||f)if(l)a.defaultView.scrollBy(c,f);else{let v=o.scrollLeft,x=o.scrollTop;f&&(o.scrollTop+=f),c&&(o.scrollLeft+=c);let _=o.scrollLeft-v,S=o.scrollTop-x;e={left:e.left-_,top:e.top-S,right:e.right-_,bottom:e.bottom-S}}let g=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(g))break;s=g=="absolute"?s.offsetParent:pp(s)}}function iH(t){let e=t.dom.getBoundingClientRect(),r=Math.max(0,e.top),n,i;for(let a=(e.left+e.right)/2,s=r+1;s<Math.min(innerHeight,e.bottom);s+=5){let o=t.root.elementFromPoint(a,s);if(!o||o==t.dom||!t.dom.contains(o))continue;let l=o.getBoundingClientRect();if(l.top>=r-20){n=o,i=l.top;break}}return{refDOM:n,refTop:i,stack:T6(t.dom)}}function T6(t){let e=[],r=t.ownerDocument;for(let n=t;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),t!=r);n=pp(n));return e}function aH({refDOM:t,refTop:e,stack:r}){let n=t?t.getBoundingClientRect().top:0;P6(r,n==0?0:n-e)}function P6(t,e){for(let r=0;r<t.length;r++){let{dom:n,top:i,left:a}=t[r];n.scrollTop!=i+e&&(n.scrollTop=i+e),n.scrollLeft!=a&&(n.scrollLeft=a)}}let Uf=null;function sH(t){if(t.setActive)return t.setActive();if(Uf)return t.focus(Uf);let e=T6(t);t.focus(Uf==null?{get preventScroll(){return Uf={preventScroll:!0},!0}}:void 0),Uf||(Uf=!1,P6(e,0))}function M6(t,e){let r,n=2e8,i,a=0,s=e.top,o=e.top,l,u;for(let c=t.firstChild,f=0;c;c=c.nextSibling,f++){let g;if(c.nodeType==1)g=c.getClientRects();else if(c.nodeType==3)g=zu(c).getClientRects();else continue;for(let v=0;v<g.length;v++){let x=g[v];if(x.top<=s&&x.bottom>=o){s=Math.max(x.bottom,s),o=Math.min(x.top,o);let _=x.left>e.left?x.left-e.left:x.right<e.left?e.left-x.right:0;if(_<n){r=c,n=_,i=_&&r.nodeType==3?{left:x.right<e.left?x.right:x.left,top:e.top}:e,c.nodeType==1&&_&&(a=f+(e.left>=(x.left+x.right)/2?1:0));continue}}else x.top>e.top&&!l&&x.left<=e.left&&x.right>=e.left&&(l=c,u={left:Math.max(x.left,Math.min(x.right,e.left)),top:x.top});!r&&(e.left>=x.right&&e.top>=x.top||e.left>=x.left&&e.top>=x.bottom)&&(a=f+1)}}return!r&&l&&(r=l,i=u,n=0),r&&r.nodeType==3?oH(r,i):!r||n&&r.nodeType==1?{node:t,offset:a}:M6(r,i)}function oH(t,e){let r=t.nodeValue.length,n=document.createRange(),i;for(let a=0;a<r;a++){n.setEnd(t,a+1),n.setStart(t,a);let s=Zc(n,1);if(s.top!=s.bottom&&fS(e,s)){i={node:t,offset:a+(e.left>=(s.left+s.right)/2?1:0)};break}}return n.detach(),i||{node:t,offset:0}}function fS(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function lH(t,e){let r=t.parentNode;return r&&/^li$/i.test(r.nodeName)&&e.left<t.getBoundingClientRect().left?r:t}function uH(t,e,r){let{node:n,offset:i}=M6(e,r),a=-1;if(n.nodeType==1&&!n.firstChild){let s=n.getBoundingClientRect();a=s.left!=s.right&&r.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(n,i,a)}function cH(t,e,r,n){let i=-1;for(let a=e,s=!1;a!=t.dom;){let o=t.docView.nearestDesc(a,!0),l;if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((l=o.dom.getBoundingClientRect()).width||l.height)&&(o.node.isBlock&&o.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(o.dom.nodeName)&&(!s&&l.left>n.left||l.top>n.top?i=o.posBefore:(!s&&l.right<n.left||l.bottom<n.top)&&(i=o.posAfter),s=!0),!o.contentDOM&&i<0&&!o.node.isText))return(o.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2)?o.posBefore:o.posAfter;a=o.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,r,-1)}function A6(t,e,r){let n=t.childNodes.length;if(n&&r.top<r.bottom)for(let i=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-r.top)/(r.bottom-r.top))-2)),a=i;;){let s=t.childNodes[a];if(s.nodeType==1){let o=s.getClientRects();for(let l=0;l<o.length;l++){let u=o[l];if(fS(e,u))return A6(s,e,u)}}if((a=(a+1)%n)==i)break}return t}function dH(t,e){let r=t.dom.ownerDocument,n,i=0,a=eH(r,e.left,e.top);a&&({node:n,offset:i}=a);let s=(t.root.elementFromPoint?t.root:r).elementFromPoint(e.left,e.top),o;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=t.dom.getBoundingClientRect();if(!fS(e,u)||(s=A6(t.dom,e,u),!s))return null}if(ka)for(let u=s;n&&u;u=pp(u))u.draggable&&(n=void 0);if(s=lH(s,e),n){if(Po&&n.nodeType==1&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){let c=n.childNodes[i],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let u;vv&&i&&n.nodeType==1&&(u=n.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,n==t.dom&&i==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?o=t.state.doc.content.size:(i==0||n.nodeType!=1||n.childNodes[i-1].nodeName!="BR")&&(o=cH(t,n,i,e))}o==null&&(o=uH(t,s,e));let l=t.docView.nearestDesc(s,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function kT(t){return t.top<t.bottom||t.left<t.right}function Zc(t,e){let r=t.getClientRects();if(r.length){let n=r[e<0?0:r.length-1];if(kT(n))return n}return Array.prototype.find.call(r,kT)||t.getBoundingClientRect()}const hH=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function j6(t,e,r){let{node:n,offset:i,atom:a}=t.docView.domFromPos(e,r<0?-1:1),s=vv||Po;if(n.nodeType==3)if(s&&(hH.test(n.nodeValue)||(r<0?!i:i==n.nodeValue.length))){let l=Zc(zu(n,i,i),r);if(Po&&i&&/\s/.test(n.nodeValue[i-1])&&i<n.nodeValue.length){let u=Zc(zu(n,i-1,i-1),-1);if(u.top==l.top){let c=Zc(zu(n,i,i+1),-1);if(c.top!=l.top)return eg(c,c.left<u.left)}}return l}else{let l=i,u=i,c=r<0?1:-1;return r<0&&!i?(u++,c=-1):r>=0&&i==n.nodeValue.length?(l--,c=1):r<0?l--:u++,eg(Zc(zu(n,l,u),c),c<0)}if(!t.state.doc.resolve(e-(a||0)).parent.inlineContent){if(a==null&&i&&(r<0||i==Eo(n))){let l=n.childNodes[i-1];if(l.nodeType==1)return zw(l.getBoundingClientRect(),!1)}if(a==null&&i<Eo(n)){let l=n.childNodes[i];if(l.nodeType==1)return zw(l.getBoundingClientRect(),!0)}return zw(n.getBoundingClientRect(),r>=0)}if(a==null&&i&&(r<0||i==Eo(n))){let l=n.childNodes[i-1],u=l.nodeType==3?zu(l,Eo(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(u)return eg(Zc(u,1),!1)}if(a==null&&i<Eo(n)){let l=n.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let u=l?l.nodeType==3?zu(l,0,s?0:1):l.nodeType==1?l:null:null;if(u)return eg(Zc(u,-1),!0)}return eg(Zc(n.nodeType==3?zu(n):n,-r),r>=0)}function eg(t,e){if(t.width==0)return t;let r=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:r,right:r}}function zw(t,e){if(t.height==0)return t;let r=e?t.top:t.bottom;return{top:r,bottom:r,left:t.left,right:t.right}}function R6(t,e,r){let n=t.state,i=t.root.activeElement;n!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return r()}finally{n!=e&&t.updateState(n),i!=t.dom&&i&&i.focus()}}function fH(t,e,r){let n=e.selection,i=r=="up"?n.$from:n.$to;return R6(t,e,()=>{let{node:a}=t.docView.domFromPos(i.pos,r=="up"?-1:1);for(;;){let o=t.docView.nearestDesc(a,!0);if(!o)break;if(o.node.isBlock){a=o.contentDOM||o.dom;break}a=o.dom.parentNode}let s=j6(t,i.pos,1);for(let o=a.firstChild;o;o=o.nextSibling){let l;if(o.nodeType==1)l=o.getClientRects();else if(o.nodeType==3)l=zu(o,0,o.nodeValue.length).getClientRects();else continue;for(let u=0;u<l.length;u++){let c=l[u];if(c.bottom>c.top+1&&(r=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const pH=/[\u0590-\u08ac]/;function mH(t,e,r){let{$head:n}=e.selection;if(!n.parent.isTextblock)return!1;let i=n.parentOffset,a=!i,s=i==n.parent.content.size,o=t.domSelection();return o?!pH.test(n.parent.textContent)||!o.modify?r=="left"||r=="backward"?a:s:R6(t,e,()=>{let{focusNode:l,focusOffset:u,anchorNode:c,anchorOffset:f}=t.domSelectionRange(),g=o.caretBidiLevel;o.modify("move",r,"character");let v=n.depth?t.docView.domAfterPos(n.before()):t.dom,{focusNode:x,focusOffset:_}=t.domSelectionRange(),S=x&&!v.contains(x.nodeType==1?x:x.parentNode)||l==x&&u==_;try{o.collapse(c,f),l&&(l!=c||u!=f)&&o.extend&&o.extend(l,u)}catch{}return g!=null&&(o.caretBidiLevel=g),S}):n.pos==n.start()||n.pos==n.end()}let CT=null,ET=null,NT=!1;function gH(t,e,r){return CT==e&&ET==r?NT:(CT=e,ET=r,NT=r=="up"||r=="down"?fH(t,e,r):mH(t,e,r))}const Mo=0,TT=1,_h=2,tu=3;class yv{constructor(e,r,n,i){this.parent=e,this.children=r,this.dom=n,this.contentDOM=i,this.dirty=Mo,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,r,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let r=0;r<this.children.length;r++)e+=this.children[r].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let r=0,n=this.posAtStart;;r++){let i=this.children[r];if(i==e)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,r,n){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(n<0){let a,s;if(e==this.contentDOM)a=e.childNodes[r-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.previousSibling}for(;a&&!((s=a.pmViewDesc)&&s.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(s)+s.size:this.posAtStart}else{let a,s;if(e==this.contentDOM)a=e.childNodes[r];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.nextSibling}for(;a&&!((s=a.pmViewDesc)&&s.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=r>ba(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(r==0)for(let a=e;;a=a.parentNode){if(a==this.dom){i=!1;break}if(a.previousSibling)break}if(i==null&&r==e.childNodes.length)for(let a=e;;a=a.parentNode){if(a==this.dom){i=!0;break}if(a.nextSibling)break}}return i??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,r=!1){for(let n=!0,i=e;i;i=i.parentNode){let a=this.getDesc(i),s;if(a&&(!r||a.node))if(n&&(s=a.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))n=!1;else return a}}getDesc(e){let r=e.pmViewDesc;for(let n=r;n;n=n.parent)if(n==this)return r}posFromDOM(e,r,n){for(let i=e;i;i=i.parentNode){let a=this.getDesc(i);if(a)return a.localPosFromDOM(e,r,n)}return-1}descAt(e){for(let r=0,n=0;r<this.children.length;r++){let i=this.children[r],a=n+i.size;if(n==e&&a!=n){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let o=i.children[s];if(o.size){i=o;break}}return i}if(e<a)return i.descAt(e-n-i.border);n=a}}domFromPos(e,r){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,i=0;for(let a=0;n<this.children.length;n++){let s=this.children[n],o=a+s.size;if(o>e||s instanceof O6){i=e-a;break}a=o}if(i)return this.children[n].domFromPos(i-this.children[n].border,r);for(let a;n&&!(a=this.children[n-1]).size&&a instanceof L6&&a.side>=0;n--);if(r<=0){let a,s=!0;for(;a=n?this.children[n-1]:null,!(!a||a.dom.parentNode==this.contentDOM);n--,s=!1);return a&&r&&s&&!a.border&&!a.domAtom?a.domFromPos(a.size,r):{node:this.contentDOM,offset:a?ba(a.dom)+1:0}}else{let a,s=!0;for(;a=n<this.children.length?this.children[n]:null,!(!a||a.dom.parentNode==this.contentDOM);n++,s=!1);return a&&s&&!a.border&&!a.domAtom?a.domFromPos(0,r):{node:this.contentDOM,offset:a?ba(a.dom):this.contentDOM.childNodes.length}}}parseRange(e,r,n=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:r,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,a=-1;for(let s=n,o=0;;o++){let l=this.children[o],u=s+l.size;if(i==-1&&e<=u){let c=s+l.border;if(e>=c&&r<=u-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,r,c);e=s;for(let f=o;f>0;f--){let g=this.children[f-1];if(g.size&&g.dom.parentNode==this.contentDOM&&!g.emptyChildAt(1)){i=ba(g.dom)+1;break}e-=g.size}i==-1&&(i=0)}if(i>-1&&(u>r||o==this.children.length-1)){r=u;for(let c=o+1;c<this.children.length;c++){let f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){a=ba(f.dom);break}r+=f.size}a==-1&&(a=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:r,fromOffset:i,toOffset:a}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let r=this.children[e<0?0:this.children.length-1];return r.size==0||r.emptyChildAt(e)}domAfterPos(e){let{node:r,offset:n}=this.domFromPos(e,0);if(r.nodeType!=1||n==r.childNodes.length)throw new RangeError("No node after pos "+e);return r.childNodes[n]}setSelection(e,r,n,i=!1){let a=Math.min(e,r),s=Math.max(e,r);for(let v=0,x=0;v<this.children.length;v++){let _=this.children[v],S=x+_.size;if(a>x&&s<S)return _.setSelection(e-x-_.border,r-x-_.border,n,i);x=S}let o=this.domFromPos(e,e?-1:1),l=r==e?o:this.domFromPos(r,r?-1:1),u=n.root.getSelection(),c=n.domSelectionRange(),f=!1;if((Po||ka)&&e==r){let{node:v,offset:x}=o;if(v.nodeType==3){if(f=!!(x&&v.nodeValue[x-1]==`
`),f&&x==v.nodeValue.length)for(let _=v,S;_;_=_.parentNode){if(S=_.nextSibling){S.nodeName=="BR"&&(o=l={node:S.parentNode,offset:ba(S)+1});break}let N=_.pmViewDesc;if(N&&N.node&&N.node.isBlock)break}}else{let _=v.childNodes[x-1];f=_&&(_.nodeName=="BR"||_.contentEditable=="false")}}if(Po&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let v=c.focusNode.childNodes[c.focusOffset];v&&v.contentEditable=="false"&&(i=!0)}if(!(i||f&&ka)&&Uh(o.node,o.offset,c.anchorNode,c.anchorOffset)&&Uh(l.node,l.offset,c.focusNode,c.focusOffset))return;let g=!1;if((u.extend||e==r)&&!(f&&Po)){u.collapse(o.node,o.offset);try{e!=r&&u.extend(l.node,l.offset),g=!0}catch{}}if(!g){if(e>r){let x=o;o=l,l=x}let v=document.createRange();v.setEnd(l.node,l.offset),v.setStart(o.node,o.offset),u.removeAllRanges(),u.addRange(v)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,r){for(let n=0,i=0;i<this.children.length;i++){let a=this.children[i],s=n+a.size;if(n==s?e<=s&&r>=n:e<s&&r>n){let o=n+a.border,l=s-a.border;if(e>=o&&r<=l){this.dirty=e==n||r==s?_h:TT,e==o&&r==l&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=tu:a.markDirty(e-o,r-o);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?_h:tu}n=s}this.dirty=_h}markParentsDirty(){let e=1;for(let r=this.parent;r;r=r.parent,e++){let n=e==1?_h:TT;r.dirty<n&&(r.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class L6 extends yv{constructor(e,r,n,i){let a,s=r.type.toDOM;if(typeof s=="function"&&(s=s(n,()=>{if(!a)return i;if(a.parent)return a.parent.posBeforeChild(a)})),!r.type.spec.raw){if(s.nodeType!=1){let o=document.createElement("span");o.appendChild(s),s=o}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=r,this.widget=r,a=this}matchesWidget(e){return this.dirty==Mo&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let r=this.widget.spec.stopEvent;return r?r(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class vH extends yv{constructor(e,r,n,i){super(e,[],r,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(e,r){return e!=this.textDOM?this.posAtStart+(r?this.size:0):this.posAtStart+r}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Hh extends yv{constructor(e,r,n,i,a){super(e,[],n,i),this.mark=r,this.spec=a}static create(e,r,n,i){let a=i.nodeViews[r.type.name],s=a&&a(r,i,n);return(!s||!s.dom)&&(s=Yh.renderSpec(document,r.type.spec.toDOM(r,n),null,r.attrs)),new Hh(e,r,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&tu||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=tu&&this.mark.eq(e)}markDirty(e,r){if(super.markDirty(e,r),this.dirty!=Mo){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=Mo}}slice(e,r,n){let i=Hh.create(this.parent,this.mark,!0,n),a=this.children,s=this.size;r<s&&(a=K2(a,r,s,n)),e>0&&(a=K2(a,0,e,n));for(let o=0;o<a.length;o++)a[o].parent=i;return i.children=a,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class gd extends yv{constructor(e,r,n,i,a,s,o,l,u){super(e,[],a,s),this.node=r,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=o}static create(e,r,n,i,a,s){let o=a.nodeViews[r.type.name],l,u=o&&o(r,a,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},n,i),c=u&&u.dom,f=u&&u.contentDOM;if(r.isText){if(!c)c=document.createTextNode(r.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:f}=Yh.renderSpec(document,r.type.spec.toDOM(r),null,r.attrs));!f&&!r.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),r.type.spec.draggable&&(c.draggable=!0));let g=c;return c=B6(c,n,r),u?l=new yH(e,r,n,i,c,f||null,g,u,a,s+1):r.isText?new Bx(e,r,n,i,c,g,a):new gd(e,r,n,i,c,f||null,g,a,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let r=this.children.length-1;r>=0;r--){let n=this.children[r];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Qe.empty)}return e}matchesNode(e,r,n){return this.dirty==Mo&&e.eq(this.node)&&wy(r,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,r){let n=this.node.inlineContent,i=r,a=e.composing?this.localCompositionInfo(e,r):null,s=a&&a.pos>-1?a:null,o=a&&a.pos<0,l=new bH(this,s&&s.node,e);SH(this.node,this.innerDeco,(u,c,f)=>{u.spec.marks?l.syncToMarks(u.spec.marks,n,e,c):u.type.side>=0&&!f&&l.syncToMarks(c==this.node.childCount?en.none:this.node.child(c).marks,n,e,c),l.placeWidget(u,e,i)},(u,c,f,g)=>{l.syncToMarks(u.marks,n,e,g);let v;l.findNodeMatch(u,c,f,g)||o&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(v=l.findIndexWithChild(a.node))>-1&&l.updateNodeAt(u,c,f,v,e)||l.updateNextNode(u,c,f,e,g,i)||l.addNode(u,c,f,e,i),i+=u.nodeSize}),l.syncToMarks([],n,e,0),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==_h)&&(s&&this.protectLocalComposition(e,s),D6(this.contentDOM,this.children,e),mp&&kH(this.dom))}localCompositionInfo(e,r){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof Yt)||n<r||i>r+this.node.content.size)return null;let a=e.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let s=a.nodeValue,o=CH(this.node.content,s,n-r,i-r);return o<0?null:{node:a,pos:o,text:s}}else return{node:a,pos:-1,text:""}}protectLocalComposition(e,{node:r,pos:n,text:i}){if(this.getDesc(r))return;let a=r;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let s=new vH(this,a,r,i);e.input.compositionNodes.push(s),this.children=K2(this.children,n,n+i.length,e,s)}update(e,r,n,i){return this.dirty==tu||!e.sameMarkup(this.node)?!1:(this.updateInner(e,r,n,i),!0)}updateInner(e,r,n,i){this.updateOuterDeco(r),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Mo}updateOuterDeco(e){if(wy(e,this.outerDeco))return;let r=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=I6(this.dom,this.nodeDOM,$2(this.outerDeco,this.node,r),$2(e,this.node,r)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function PT(t,e,r,n,i){B6(n,e,t);let a=new gd(void 0,t,e,r,n,n,n,i,0);return a.contentDOM&&a.updateChildren(i,0),a}class Bx extends gd{constructor(e,r,n,i,a,s,o){super(e,r,n,i,a,null,s,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,r,n,i){return this.dirty==tu||this.dirty!=Mo&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(r),(this.dirty!=Mo||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Mo,!0)}inParent(){let e=this.parent.contentDOM;for(let r=this.nodeDOM;r;r=r.parentNode)if(r==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,r,n){return e==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):super.localPosFromDOM(e,r,n)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,r,n){let i=this.node.cut(e,r),a=document.createTextNode(i.text);return new Bx(this.parent,i,this.outerDeco,this.innerDeco,a,a,n)}markDirty(e,r){super.markDirty(e,r),this.dom!=this.nodeDOM&&(e==0||r==this.nodeDOM.nodeValue.length)&&(this.dirty=tu)}get domAtom(){return!1}isText(e){return this.node.text==e}}class O6 extends yv{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Mo&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class yH extends gd{constructor(e,r,n,i,a,s,o,l,u,c){super(e,r,n,i,a,s,o,u,c),this.spec=l}update(e,r,n,i){if(this.dirty==tu)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let a=this.spec.update(e,r,n);return a&&this.updateInner(e,r,n,i),a}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,r,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,r,n,i){this.spec.setSelection?this.spec.setSelection(e,r,n.root):super.setSelection(e,r,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function D6(t,e,r){let n=t.firstChild,i=!1;for(let a=0;a<e.length;a++){let s=e[a],o=s.dom;if(o.parentNode==t){for(;o!=n;)n=MT(n),i=!0;n=n.nextSibling}else i=!0,t.insertBefore(o,n);if(s instanceof Hh){let l=n?n.previousSibling:t.lastChild;D6(s.contentDOM,s.children,r),n=l?l.nextSibling:t.firstChild}}for(;n;)n=MT(n),i=!0;i&&r.trackWrites==t&&(r.trackWrites=null)}const xg=function(t){t&&(this.nodeName=t)};xg.prototype=Object.create(null);const Sh=[new xg];function $2(t,e,r){if(t.length==0)return Sh;let n=r?Sh[0]:new xg,i=[n];for(let a=0;a<t.length;a++){let s=t[a].type.attrs;if(s){s.nodeName&&i.push(n=new xg(s.nodeName));for(let o in s){let l=s[o];l!=null&&(r&&i.length==1&&i.push(n=new xg(e.isInline?"span":"div")),o=="class"?n.class=(n.class?n.class+" ":"")+l:o=="style"?n.style=(n.style?n.style+";":"")+l:o!="nodeName"&&(n[o]=l))}}}return i}function I6(t,e,r,n){if(r==Sh&&n==Sh)return e;let i=e;for(let a=0;a<n.length;a++){let s=n[a],o=r[a];if(a){let l;o&&o.nodeName==s.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),o=Sh[0]),i=l}xH(i,o||Sh[0],s)}return i}function xH(t,e,r){for(let n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in r)&&t.removeAttribute(n);for(let n in r)n!="class"&&n!="style"&&n!="nodeName"&&r[n]!=e[n]&&t.setAttribute(n,r[n]);if(e.class!=r.class){let n=e.class?e.class.split(" ").filter(Boolean):[],i=r.class?r.class.split(" ").filter(Boolean):[];for(let a=0;a<n.length;a++)i.indexOf(n[a])==-1&&t.classList.remove(n[a]);for(let a=0;a<i.length;a++)n.indexOf(i[a])==-1&&t.classList.add(i[a]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=r.style){if(e.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=n.exec(e.style);)t.style.removeProperty(i[1])}r.style&&(t.style.cssText+=r.style)}}function B6(t,e,r){return I6(t,t,Sh,$2(e,r,t.nodeType!=1))}function wy(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].type.eq(e[r].type))return!1;return!0}function MT(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class bH{constructor(e,r,n){this.lock=r,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=wH(e.node.content,e)}destroyBetween(e,r){if(e!=r){for(let n=e;n<r;n++)this.top.children[n].destroy();this.top.children.splice(e,r-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,r,n,i){let a=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;a<o&&(a==s-1?this.top:this.stack[a+1<<1]).matchesMark(e[a])&&e[a].type.spec.spanning!==!1;)a++;for(;a<s;)this.destroyRest(),this.top.dirty=Mo,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1,u=this.top.children.length;i<this.preMatch.index&&(u=Math.min(this.index+3,u));for(let c=this.index;c<u;c++){let f=this.top.children[c];if(f.matchesMark(e[s])&&!this.isLocked(f.dom)){l=c;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let c=Hh.create(this.top,e[s],r,n);this.top.children.splice(this.index,0,c),this.top=c,this.changed=!0}this.index=0,s++}}findNodeMatch(e,r,n,i){let a=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,r,n))a=this.top.children.indexOf(s,this.index);else for(let o=this.index,l=Math.min(this.top.children.length,o+5);o<l;o++){let u=this.top.children[o];if(u.matchesNode(e,r,n)&&!this.preMatch.matched.has(u)){a=o;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(e,r,n,i,a){let s=this.top.children[i];return s.dirty==tu&&s.dom==s.contentDOM&&(s.dirty=_h),s.update(e,r,n,a)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let r=e.parentNode;if(!r)return-1;if(r==this.top.contentDOM){let n=e.pmViewDesc;if(n){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==n)return i}return-1}e=r}}updateNextNode(e,r,n,i,a,s){for(let o=this.index;o<this.top.children.length;o++){let l=this.top.children[o];if(l instanceof gd){let u=this.preMatch.matched.get(l);if(u!=null&&u!=a)return!1;let c=l.dom,f,g=this.isLocked(c)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=tu&&wy(r,l.outerDeco));if(!g&&l.update(e,r,n,i))return this.destroyBetween(this.index,o),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!g&&(f=this.recreateWrapper(l,e,r,n,i,s)))return this.destroyBetween(this.index,o),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=_h,f.updateChildren(i,s+1),f.dirty=Mo),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,r,n,i,a,s){if(e.dirty||r.isAtom||!e.children.length||!e.node.content.eq(r.content)||!wy(n,e.outerDeco)||!i.eq(e.innerDeco))return null;let o=gd.create(this.top,r,n,i,a,s);if(o.contentDOM){o.children=e.children,e.children=[];for(let l of o.children)l.parent=o}return e.destroy(),o}addNode(e,r,n,i,a){let s=gd.create(this.top,e,r,n,i,a);s.contentDOM&&s.updateChildren(i,a+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,r,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let a=new L6(this.top,e,r,n);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],r=this.top;for(;e instanceof Hh;)r=e,e=r.children[r.children.length-1];(!e||!(e instanceof Bx)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((ka||Ki)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",r),this.addHackNode("BR",this.top))}addHackNode(e,r){if(r==this.top&&this.index<r.children.length&&r.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);e=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),e=="BR"&&(n.className="ProseMirror-trailingBreak");let i=new O6(this.top,[],n,null);r!=this.top?r.children.push(i):r.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function wH(t,e){let r=e,n=r.children.length,i=t.childCount,a=new Map,s=[];e:for(;i>0;){let o;for(;;)if(n){let u=r.children[n-1];if(u instanceof Hh)r=u,n=u.children.length;else{o=u,n--;break}}else{if(r==e)break e;n=r.parent.children.indexOf(r),r=r.parent}let l=o.node;if(l){if(l!=t.child(i-1))break;--i,a.set(o,i),s.push(o)}}return{index:i,matched:a,matches:s.reverse()}}function _H(t,e){return t.type.side-e.type.side}function SH(t,e,r,n){let i=e.locals(t),a=0;if(i.length==0){for(let u=0;u<t.childCount;u++){let c=t.child(u);n(c,i,e.forChild(a,c),u),a+=c.nodeSize}return}let s=0,o=[],l=null;for(let u=0;;){let c,f;for(;s<i.length&&i[s].to==a;){let S=i[s++];S.widget&&(c?(f||(f=[c])).push(S):c=S)}if(c)if(f){f.sort(_H);for(let S=0;S<f.length;S++)r(f[S],u,!!l)}else r(c,u,!!l);let g,v;if(l)v=-1,g=l,l=null;else if(u<t.childCount)v=u,g=t.child(u++);else break;for(let S=0;S<o.length;S++)o[S].to<=a&&o.splice(S--,1);for(;s<i.length&&i[s].from<=a&&i[s].to>a;)o.push(i[s++]);let x=a+g.nodeSize;if(g.isText){let S=x;s<i.length&&i[s].from<S&&(S=i[s].from);for(let N=0;N<o.length;N++)o[N].to<S&&(S=o[N].to);S<x&&(l=g.cut(S-a),g=g.cut(0,S-a),x=S,v=-1)}else for(;s<i.length&&i[s].to<x;)s++;let _=g.isInline&&!g.isLeaf?o.filter(S=>!S.inline):o.slice();n(g,_,e.forChild(a,g),v),a=x}}function kH(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function CH(t,e,r,n){for(let i=0,a=0;i<t.childCount&&a<=n;){let s=t.child(i++),o=a;if(a+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<t.childCount;){let u=t.child(i++);if(a+=u.nodeSize,!u.isText)break;l+=u.text}if(a>=r){if(a>=n&&l.slice(n-e.length-o,n-o)==e)return n-e.length;let u=o<n?l.lastIndexOf(e,n-o-1):-1;if(u>=0&&u+e.length+o>=r)return o+u;if(r==n&&l.length>=n+e.length-o&&l.slice(n-o,n-o+e.length)==e)return n}}return-1}function K2(t,e,r,n,i){let a=[];for(let s=0,o=0;s<t.length;s++){let l=t[s],u=o,c=o+=l.size;u>=r||c<=e?a.push(l):(u<e&&a.push(l.slice(0,e-u,n)),i&&(a.push(i),i=void 0),c>r&&a.push(l.slice(r-u,l.size,n)))}return a}function pS(t,e=null){let r=t.domSelectionRange(),n=t.state.doc;if(!r.focusNode)return null;let i=t.docView.nearestDesc(r.focusNode),a=i&&i.size==0,s=t.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(s<0)return null;let o=n.resolve(s),l,u;if(Ix(r)){for(l=s;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&It.isSelectable(f)&&i.parent&&!(f.isInline&&QU(r.focusNode,r.focusOffset,i.dom))){let g=i.posBefore;u=new It(s==g?o:n.resolve(g))}}else{if(r instanceof t.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let f=s,g=s;for(let v=0;v<r.rangeCount;v++){let x=r.getRangeAt(v);f=Math.min(f,t.docView.posFromDOM(x.startContainer,x.startOffset,1)),g=Math.max(g,t.docView.posFromDOM(x.endContainer,x.endOffset,-1))}if(f<0)return null;[l,s]=g==t.state.selection.anchor?[g,f]:[f,g],o=n.resolve(s)}else l=t.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(l<0)return null}let c=n.resolve(l);if(!u){let f=e=="pointer"||t.state.selection.head<o.pos&&!a?1:-1;u=mS(t,c,o,f)}return u}function z6(t){return t.editable?t.hasFocus():V6(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Gu(t,e=!1){let r=t.state.selection;if(F6(t,r),!!z6(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Ki){let n=t.domSelectionRange(),i=t.domObserver.currentSelection;if(n.anchorNode&&i.anchorNode&&Uh(n.anchorNode,n.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)NH(t);else{let{anchor:n,head:i}=r,a,s;AT&&!(r instanceof Yt)&&(r.$from.parent.inlineContent||(a=jT(t,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(s=jT(t,r.to))),t.docView.setSelection(n,i,t,e),AT&&(a&&RT(a),s&&RT(s)),r.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&EH(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const AT=ka||Ki&&E6<63;function jT(t,e){let{node:r,offset:n}=t.docView.domFromPos(e,0),i=n<r.childNodes.length?r.childNodes[n]:null,a=n?r.childNodes[n-1]:null;if(ka&&i&&i.contentEditable=="false")return Fw(i);if((!i||i.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(i)return Fw(i);if(a)return Fw(a)}}function Fw(t){return t.contentEditable="true",ka&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function RT(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function EH(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let r=t.domSelectionRange(),n=r.anchorNode,i=r.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(r.anchorNode!=n||r.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!z6(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function NH(t){let e=t.domSelection();if(!e)return;let r=t.cursorWrapper.dom,n=r.nodeName=="IMG";n?e.collapse(r.parentNode,ba(r)+1):e.collapse(r,0),!n&&!t.state.selection.visible&&js&&md<=11&&(r.disabled=!0,r.disabled=!1)}function F6(t,e){if(e instanceof It){let r=t.docView.descAt(e.from);r!=t.lastSelectedViewDesc&&(LT(t),r&&r.selectNode(),t.lastSelectedViewDesc=r)}else LT(t)}function LT(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function mS(t,e,r,n){return t.someProp("createSelectionBetween",i=>i(t,e,r))||Yt.between(e,r,n)}function OT(t){return t.editable&&!t.hasFocus()?!1:V6(t)}function V6(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function TH(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),r=t.domSelectionRange();return Uh(e.node,e.offset,r.anchorNode,r.anchorOffset)}function Z2(t,e){let{$anchor:r,$head:n}=t.selection,i=e>0?r.max(n):r.min(n),a=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return a&&ar.findFrom(a,e)}function Xc(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function DT(t,e,r){let n=t.state.selection;if(n instanceof Yt)if(r.indexOf("s")>-1){let{$head:i}=n,a=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+a.nodeSize*(e<0?-1:1));return Xc(t,new Yt(n.$anchor,s))}else if(n.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=Z2(t.state,e);return i&&i instanceof It?Xc(t,i):!1}else if(!(ko&&r.indexOf("m")>-1)){let i=n.$head,a=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!a||a.isText)return!1;let o=e<0?i.pos-a.nodeSize:i.pos;return a.isAtom||(s=t.docView.descAt(o))&&!s.contentDOM?It.isSelectable(a)?Xc(t,new It(e<0?t.state.doc.resolve(i.pos-a.nodeSize):i)):vv?Xc(t,new Yt(t.state.doc.resolve(e<0?o:o+a.nodeSize))):!1:!1}}else return!1;else{if(n instanceof It&&n.node.isInline)return Xc(t,new Yt(e>0?n.$to:n.$from));{let i=Z2(t.state,e);return i?Xc(t,i):!1}}}function _y(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function bg(t,e){let r=t.pmViewDesc;return r&&r.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Hf(t,e){return e<0?PH(t):MH(t)}function PH(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i,a,s=!1;for(Po&&r.nodeType==1&&n<_y(r)&&bg(r.childNodes[n],-1)&&(s=!0);;)if(n>0){if(r.nodeType!=1)break;{let o=r.childNodes[n-1];if(bg(o,-1))i=r,a=--n;else if(o.nodeType==3)r=o,n=r.nodeValue.length;else break}}else{if(U6(r))break;{let o=r.previousSibling;for(;o&&bg(o,-1);)i=r.parentNode,a=ba(o),o=o.previousSibling;if(o)r=o,n=_y(r);else{if(r=r.parentNode,r==t.dom)break;n=0}}}s?Y2(t,r,n):i&&Y2(t,i,a)}function MH(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i=_y(r),a,s;for(;;)if(n<i){if(r.nodeType!=1)break;let o=r.childNodes[n];if(bg(o,1))a=r,s=++n;else break}else{if(U6(r))break;{let o=r.nextSibling;for(;o&&bg(o,1);)a=o.parentNode,s=ba(o)+1,o=o.nextSibling;if(o)r=o,n=0,i=_y(r);else{if(r=r.parentNode,r==t.dom)break;n=i=0}}}a&&Y2(t,a,s)}function U6(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function AH(t,e){for(;t&&e==t.childNodes.length&&!gv(t);)e=ba(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let r=t.childNodes[e];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=0}}function jH(t,e){for(;t&&!e&&!gv(t);)e=ba(t),t=t.parentNode;for(;t&&e;){let r=t.childNodes[e-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=t.childNodes.length}}function Y2(t,e,r){if(e.nodeType!=3){let a,s;(s=AH(e,r))?(e=s,r=0):(a=jH(e,r))&&(e=a,r=a.nodeValue.length)}let n=t.domSelection();if(!n)return;if(Ix(n)){let a=document.createRange();a.setEnd(e,r),a.setStart(e,r),n.removeAllRanges(),n.addRange(a)}else n.extend&&n.extend(e,r);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Gu(t)},50)}function IT(t,e){let r=t.state.doc.resolve(e);if(!(Ki||N6)&&r.parent.inlineContent){let i=t.coordsAtPos(e);if(e>r.start()){let a=t.coordsAtPos(e-1),s=(a.top+a.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(a.left-i.left)>1)return a.left<i.left?"ltr":"rtl"}if(e<r.end()){let a=t.coordsAtPos(e+1),s=(a.top+a.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(a.left-i.left)>1)return a.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function BT(t,e,r){let n=t.state.selection;if(n instanceof Yt&&!n.empty||r.indexOf("s")>-1||ko&&r.indexOf("m")>-1)return!1;let{$from:i,$to:a}=n;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=Z2(t.state,e);if(s&&s instanceof It)return Xc(t,s)}if(!i.parent.inlineContent){let s=e<0?i:a,o=n instanceof Xs?ar.near(s,e):ar.findFrom(s,e);return o?Xc(t,o):!1}return!1}function zT(t,e){if(!(t.state.selection instanceof Yt))return!0;let{$head:r,$anchor:n,empty:i}=t.state.selection;if(!r.sameParent(n))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let a=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(a&&!a.isText){let s=t.state.tr;return e<0?s.delete(r.pos-a.nodeSize,r.pos):s.delete(r.pos,r.pos+a.nodeSize),t.dispatch(s),!0}return!1}function FT(t,e,r){t.domObserver.stop(),e.contentEditable=r,t.domObserver.start()}function RH(t){if(!ka||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:r}=t.domSelectionRange();if(e&&e.nodeType==1&&r==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let n=e.firstChild;FT(t,n,"true"),setTimeout(()=>FT(t,n,"false"),20)}return!1}function LH(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function OH(t,e){let r=e.keyCode,n=LH(e);if(r==8||ko&&r==72&&n=="c")return zT(t,-1)||Hf(t,-1);if(r==46&&!e.shiftKey||ko&&r==68&&n=="c")return zT(t,1)||Hf(t,1);if(r==13||r==27)return!0;if(r==37||ko&&r==66&&n=="c"){let i=r==37?IT(t,t.state.selection.from)=="ltr"?-1:1:-1;return DT(t,i,n)||Hf(t,i)}else if(r==39||ko&&r==70&&n=="c"){let i=r==39?IT(t,t.state.selection.from)=="ltr"?1:-1:1;return DT(t,i,n)||Hf(t,i)}else{if(r==38||ko&&r==80&&n=="c")return BT(t,-1,n)||Hf(t,-1);if(r==40||ko&&r==78&&n=="c")return RH(t)||BT(t,1,n)||Hf(t,1);if(n==(ko?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function gS(t,e){t.someProp("transformCopied",v=>{e=v(e,t)});let r=[],{content:n,openStart:i,openEnd:a}=e;for(;i>1&&a>1&&n.childCount==1&&n.firstChild.childCount==1;){i--,a--;let v=n.firstChild;r.push(v.type.name,v.attrs!=v.type.defaultAttrs?v.attrs:null),n=v.content}let s=t.someProp("clipboardSerializer")||Yh.fromSchema(t.state.schema),o=K6(),l=o.createElement("div");l.appendChild(s.serializeFragment(n,{document:o}));let u=l.firstChild,c,f=0;for(;u&&u.nodeType==1&&(c=$6[u.nodeName.toLowerCase()]);){for(let v=c.length-1;v>=0;v--){let x=o.createElement(c[v]);for(;l.firstChild;)x.appendChild(l.firstChild);l.appendChild(x),f++}u=l.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${a}${f?` -${f}`:""} ${JSON.stringify(r)}`);let g=t.someProp("clipboardTextSerializer",v=>v(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:g,slice:e}}function H6(t,e,r,n,i){let a=i.parent.type.spec.code,s,o;if(!r&&!e)return null;let l=!!e&&(n||a||!r);if(l){if(t.someProp("transformPastedText",g=>{e=g(e,a||n,t)}),a)return o=new wt(Qe.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",g=>{o=g(o,t,!0)}),o;let f=t.someProp("clipboardTextParser",g=>g(e,i,n,t));if(f)o=f;else{let g=i.marks(),{schema:v}=t.state,x=Yh.fromSchema(v);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(_=>{let S=s.appendChild(document.createElement("p"));_&&S.appendChild(x.serializeNode(v.text(_,g)))})}}else t.someProp("transformPastedHTML",f=>{r=f(r,t)}),s=zH(r),vv&&FH(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let g=s.firstChild;for(;g&&g.nodeType!=1;)g=g.nextSibling;if(!g)break;s=g}if(o||(o=(t.someProp("clipboardParser")||t.someProp("domParser")||pd.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||c),context:i,ruleFromNode(g){return g.nodeName=="BR"&&!g.nextSibling&&g.parentNode&&!DH.test(g.parentNode.nodeName)?{ignore:!0}:null}})),c)o=VH(VT(o,+c[1],+c[2]),c[4]);else if(o=wt.maxOpen(IH(o.content,i),!0),o.openStart||o.openEnd){let f=0,g=0;for(let v=o.content.firstChild;f<o.openStart&&!v.type.spec.isolating;f++,v=v.firstChild);for(let v=o.content.lastChild;g<o.openEnd&&!v.type.spec.isolating;g++,v=v.lastChild);o=VT(o,f,g)}return t.someProp("transformPasted",f=>{o=f(o,t,l)}),o}const DH=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function IH(t,e){if(t.childCount<2)return t;for(let r=e.depth;r>=0;r--){let i=e.node(r).contentMatchAt(e.index(r)),a,s=[];if(t.forEach(o=>{if(!s)return;let l=i.findWrapping(o.type),u;if(!l)return s=null;if(u=s.length&&a.length&&q6(l,a,o,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=W6(s[s.length-1],a.length));let c=G6(o,l);s.push(c),i=i.matchType(c.type),a=l}}),s)return Qe.from(s)}return t}function G6(t,e,r=0){for(let n=e.length-1;n>=r;n--)t=e[n].create(null,Qe.from(t));return t}function q6(t,e,r,n,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let a=q6(t,e,r,n.lastChild,i+1);if(a)return n.copy(n.content.replaceChild(n.childCount-1,a));if(n.contentMatchAt(n.childCount).matchType(i==t.length-1?r.type:t[i+1]))return n.copy(n.content.append(Qe.from(G6(r,t,i+1))))}}function W6(t,e){if(e==0)return t;let r=t.content.replaceChild(t.childCount-1,W6(t.lastChild,e-1)),n=t.contentMatchAt(t.childCount).fillBefore(Qe.empty,!0);return t.copy(r.append(n))}function X2(t,e,r,n,i,a){let s=e<0?t.firstChild:t.lastChild,o=s.content;return t.childCount>1&&(a=0),i<n-1&&(o=X2(o,e,r,n,i+1,a)),i>=r&&(o=e<0?s.contentMatchAt(0).fillBefore(o,a<=i).append(o):o.append(s.contentMatchAt(s.childCount).fillBefore(Qe.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(o))}function VT(t,e,r){return e<t.openStart&&(t=new wt(X2(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),r<t.openEnd&&(t=new wt(X2(t.content,1,r,t.openEnd,0,0),t.openStart,r)),t}const $6={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let UT=null;function K6(){return UT||(UT=document.implementation.createHTMLDocument("title"))}let Vw=null;function BH(t){let e=window.trustedTypes;return e?(Vw||(Vw=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),Vw.createHTML(t)):t}function zH(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let r=K6().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(t),i;if((i=n&&$6[n[1].toLowerCase()])&&(t=i.map(a=>"<"+a+">").join("")+t+i.map(a=>"</"+a+">").reverse().join("")),r.innerHTML=BH(t),i)for(let a=0;a<i.length;a++)r=r.querySelector(i[a])||r;return r}function FH(t){let e=t.querySelectorAll(Ki?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<e.length;r++){let n=e[r];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),n)}}function VH(t,e){if(!t.size)return t;let r=t.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return t}let{content:i,openStart:a,openEnd:s}=t;for(let o=n.length-2;o>=0;o-=2){let l=r.nodes[n[o]];if(!l||l.hasRequiredAttrs())break;i=Qe.from(l.create(n[o+1],i)),a++,s++}return new wt(i,a,s)}const us={},cs={},UH={touchstart:!0,touchmove:!0};class HH{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function GH(t){for(let e in us){let r=us[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=n=>{WH(t,n)&&!vS(t,n)&&(t.editable||!(n.type in cs))&&r(t,n)},UH[e]?{passive:!0}:void 0)}ka&&t.dom.addEventListener("input",()=>null),Q2(t)}function ud(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function qH(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function Q2(t){t.someProp("handleDOMEvents",e=>{for(let r in e)t.input.eventHandlers[r]||t.dom.addEventListener(r,t.input.eventHandlers[r]=n=>vS(t,n))})}function vS(t,e){return t.someProp("handleDOMEvents",r=>{let n=r[e.type];return n?n(t,e)||e.defaultPrevented:!1})}function WH(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target;r!=t.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(e))return!1;return!0}function $H(t,e){!vS(t,e)&&us[e.type]&&(t.editable||!(e.type in cs))&&us[e.type](t,e)}cs.keydown=(t,e)=>{let r=e;if(t.input.shiftKey=r.keyCode==16||r.shiftKey,!Y6(t,r)&&(t.input.lastKeyCode=r.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Uu&&Ki&&r.keyCode==13)))if(r.keyCode!=229&&t.domObserver.forceFlush(),mp&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();t.input.lastIOSEnter=n,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==n&&(t.someProp("handleKeyDown",i=>i(t,bh(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",n=>n(t,r))||OH(t,r)?r.preventDefault():ud(t,"key")};cs.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};cs.keypress=(t,e)=>{let r=e;if(Y6(t,r)||!r.charCode||r.ctrlKey&&!r.altKey||ko&&r.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,r))){r.preventDefault();return}let n=t.state.selection;if(!(n instanceof Yt)||!n.$from.sameParent(n.$to)){let i=String.fromCharCode(r.charCode),a=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",s=>s(t,n.$from.pos,n.$to.pos,i,a))&&t.dispatch(a()),r.preventDefault()}};function zx(t){return{left:t.clientX,top:t.clientY}}function KH(t,e){let r=e.x-t.clientX,n=e.y-t.clientY;return r*r+n*n<100}function yS(t,e,r,n,i){if(n==-1)return!1;let a=t.state.doc.resolve(n);for(let s=a.depth+1;s>0;s--)if(t.someProp(e,o=>s>a.depth?o(t,r,a.nodeAfter,a.before(s),i,!0):o(t,r,a.node(s),a.before(s),i,!1)))return!0;return!1}function op(t,e,r){if(t.focused||t.focus(),t.state.selection.eq(e))return;let n=t.state.tr.setSelection(e);n.setMeta("pointer",!0),t.dispatch(n)}function ZH(t,e){if(e==-1)return!1;let r=t.state.doc.resolve(e),n=r.nodeAfter;return n&&n.isAtom&&It.isSelectable(n)?(op(t,new It(r)),!0):!1}function YH(t,e){if(e==-1)return!1;let r=t.state.selection,n,i;r instanceof It&&(n=r.node);let a=t.state.doc.resolve(e);for(let s=a.depth+1;s>0;s--){let o=s>a.depth?a.nodeAfter:a.node(s);if(It.isSelectable(o)){n&&r.$from.depth>0&&s>=r.$from.depth&&a.before(r.$from.depth+1)==r.$from.pos?i=a.before(r.$from.depth):i=a.before(s);break}}return i!=null?(op(t,It.create(t.state.doc,i)),!0):!1}function XH(t,e,r,n,i){return yS(t,"handleClickOn",e,r,n)||t.someProp("handleClick",a=>a(t,e,n))||(i?YH(t,r):ZH(t,r))}function QH(t,e,r,n){return yS(t,"handleDoubleClickOn",e,r,n)||t.someProp("handleDoubleClick",i=>i(t,e,n))}function JH(t,e,r,n){return yS(t,"handleTripleClickOn",e,r,n)||t.someProp("handleTripleClick",i=>i(t,e,n))||eG(t,r,n)}function eG(t,e,r){if(r.button!=0)return!1;let n=t.state.doc;if(e==-1)return n.inlineContent?(op(t,Yt.create(n,0,n.content.size)),!0):!1;let i=n.resolve(e);for(let a=i.depth+1;a>0;a--){let s=a>i.depth?i.nodeAfter:i.node(a),o=i.before(a);if(s.inlineContent)op(t,Yt.create(n,o+1,o+1+s.content.size));else if(It.isSelectable(s))op(t,It.create(n,o));else continue;return!0}}function xS(t){return Sy(t)}const Z6=ko?"metaKey":"ctrlKey";us.mousedown=(t,e)=>{let r=e;t.input.shiftKey=r.shiftKey;let n=xS(t),i=Date.now(),a="singleClick";i-t.input.lastClick.time<500&&KH(r,t.input.lastClick)&&!r[Z6]&&t.input.lastClick.button==r.button&&(t.input.lastClick.type=="singleClick"?a="doubleClick":t.input.lastClick.type=="doubleClick"&&(a="tripleClick")),t.input.lastClick={time:i,x:r.clientX,y:r.clientY,type:a,button:r.button};let s=t.posAtCoords(zx(r));s&&(a=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new tG(t,s,r,!!n)):(a=="doubleClick"?QH:JH)(t,s.pos,s.inside,r)?r.preventDefault():ud(t,"pointer"))};class tG{constructor(e,r,n,i){this.view=e,this.pos=r,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[Z6],this.allowDefault=n.shiftKey;let a,s;if(r.inside>-1)a=e.state.doc.nodeAt(r.inside),s=r.inside;else{let c=e.state.doc.resolve(r.pos);a=c.parent,s=c.depth?c.before():0}const o=i?null:n.target,l=o?e.docView.nearestDesc(o,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:u}=e.state;(n.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||u instanceof It&&u.from<=s&&u.to>s)&&(this.mightDrag={node:a,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Po&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ud(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Gu(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(zx(e))),this.updateAllowDefault(e),this.allowDefault||!r?ud(this.view,"pointer"):XH(this.view,r.pos,r.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||ka&&this.mightDrag&&!this.mightDrag.node.isAtom||Ki&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?(op(this.view,ar.near(this.view.state.doc.resolve(r.pos))),e.preventDefault()):ud(this.view,"pointer")}move(e){this.updateAllowDefault(e),ud(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}us.touchstart=t=>{t.input.lastTouch=Date.now(),xS(t),ud(t,"pointer")};us.touchmove=t=>{t.input.lastTouch=Date.now(),ud(t,"pointer")};us.contextmenu=t=>xS(t);function Y6(t,e){return t.composing?!0:ka&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const rG=Uu?5e3:-1;cs.compositionstart=cs.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,r=e.selection.$to;if(e.selection instanceof Yt&&(e.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)||Ki&&N6&&nG(t)))t.markCursor=t.state.storedMarks||r.marks(),Sy(t,!0),t.markCursor=null;else if(Sy(t,!e.selection.empty),Po&&e.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=t.domSelectionRange();for(let i=n.focusNode,a=n.focusOffset;i&&i.nodeType==1&&a!=0;){let s=a<0?i.lastChild:i.childNodes[a-1];if(!s)break;if(s.nodeType==3){let o=t.domSelection();o&&o.collapse(s,s.nodeValue.length);break}else i=s,a=-1}}t.input.composing=!0}X6(t,rG)};function nG(t){let{focusNode:e,focusOffset:r}=t.domSelectionRange();if(!e||e.nodeType!=1||r>=e.childNodes.length)return!1;let n=e.childNodes[r];return n.nodeType==1&&n.contentEditable=="false"}cs.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,X6(t,20))};function X6(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Sy(t),e))}function Q6(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=aG());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function iG(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let r=YU(e.focusNode,e.focusOffset),n=XU(e.focusNode,e.focusOffset);if(r&&n&&r!=n){let i=n.pmViewDesc,a=t.domObserver.lastChangedTextNode;if(r==a||n==a)return a;if(!i||!i.isText(n.nodeValue))return n;if(t.input.compositionNode==n){let s=r.pmViewDesc;if(!(!s||!s.isText(r.nodeValue)))return n}}return r||n}function aG(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Sy(t,e=!1){if(!(Uu&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),Q6(t),e||t.docView&&t.docView.dirty){let r=pS(t),n=t.state.selection;return r&&!r.eq(n)?t.dispatch(t.state.tr.setSelection(r)):(t.markCursor||e)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function sG(t,e){if(!t.dom.parentNode)return;let r=t.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(e),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),t.focus()},50)}const $g=js&&md<15||mp&&tH<604;us.copy=cs.cut=(t,e)=>{let r=e,n=t.state.selection,i=r.type=="cut";if(n.empty)return;let a=$g?null:r.clipboardData,s=n.content(),{dom:o,text:l}=gS(t,s);a?(r.preventDefault(),a.clearData(),a.setData("text/html",o.innerHTML),a.setData("text/plain",l)):sG(t,o),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function oG(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function lG(t,e){if(!t.dom.parentNode)return;let r=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,n=t.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),n.parentNode&&n.parentNode.removeChild(n),r?Kg(t,n.value,null,i,e):Kg(t,n.textContent,n.innerHTML,i,e)},50)}function Kg(t,e,r,n,i){let a=H6(t,e,r,n,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,i,a||wt.empty)))return!0;if(!a)return!1;let s=oG(a),o=s?t.state.tr.replaceSelectionWith(s,n):t.state.tr.replaceSelection(a);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function J6(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let r=t.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}cs.paste=(t,e)=>{let r=e;if(t.composing&&!Uu)return;let n=$g?null:r.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;n&&Kg(t,J6(n),n.getData("text/html"),i,r)?r.preventDefault():lG(t,r)};class eA{constructor(e,r,n){this.slice=e,this.move=r,this.node=n}}const uG=ko?"altKey":"ctrlKey";function tA(t,e){let r=t.someProp("dragCopies",n=>!n(e));return r??!e[uG]}us.dragstart=(t,e)=>{let r=e,n=t.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let i=t.state.selection,a=i.empty?null:t.posAtCoords(zx(r)),s;if(!(a&&a.pos>=i.from&&a.pos<=(i instanceof It?i.to-1:i.to))){if(n&&n.mightDrag)s=It.create(t.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let f=t.docView.nearestDesc(r.target,!0);f&&f.node.type.spec.draggable&&f!=t.docView&&(s=It.create(t.state.doc,f.posBefore))}}let o=(s||t.state.selection).content(),{dom:l,text:u,slice:c}=gS(t,o);(!r.dataTransfer.files.length||!Ki||E6>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData($g?"Text":"text/html",l.innerHTML),r.dataTransfer.effectAllowed="copyMove",$g||r.dataTransfer.setData("text/plain",u),t.dragging=new eA(c,tA(t,r),s)};us.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};cs.dragover=cs.dragenter=(t,e)=>e.preventDefault();cs.drop=(t,e)=>{try{cG(t,e,t.dragging)}finally{t.dragging=null}};function cG(t,e,r){if(!e.dataTransfer)return;let n=t.posAtCoords(zx(e));if(!n)return;let i=t.state.doc.resolve(n.pos),a=r&&r.slice;a?t.someProp("transformPasted",v=>{a=v(a,t,!1)}):a=H6(t,J6(e.dataTransfer),$g?null:e.dataTransfer.getData("text/html"),!1,i);let s=!!(r&&tA(t,e));if(t.someProp("handleDrop",v=>v(t,e,a||wt.empty,s))){e.preventDefault();return}if(!a)return;e.preventDefault();let o=a?a6(t.state.doc,i.pos,a):i.pos;o==null&&(o=i.pos);let l=t.state.tr;if(s){let{node:v}=r;v?v.replace(l):l.deleteSelection()}let u=l.mapping.map(o),c=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,f=l.doc;if(c?l.replaceRangeWith(u,u,a.content.firstChild):l.replaceRange(u,u,a),l.doc.eq(f))return;let g=l.doc.resolve(u);if(c&&It.isSelectable(a.content.firstChild)&&g.nodeAfter&&g.nodeAfter.sameMarkup(a.content.firstChild))l.setSelection(new It(g));else{let v=l.mapping.map(o);l.mapping.maps[l.mapping.maps.length-1].forEach((x,_,S,N)=>v=N),l.setSelection(mS(t,g,l.doc.resolve(v)))}t.focus(),t.dispatch(l.setMeta("uiEvent","drop"))}us.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Gu(t)},20))};us.blur=(t,e)=>{let r=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),r.relatedTarget&&t.dom.contains(r.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};us.beforeinput=(t,e)=>{if(Ki&&Uu&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:n}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=n||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",a=>a(t,bh(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in cs)us[t]=cs[t];function Zg(t,e){if(t==e)return!0;for(let r in t)if(t[r]!==e[r])return!1;for(let r in e)if(!(r in t))return!1;return!0}class ky{constructor(e,r){this.toDOM=e,this.spec=r||Ph,this.side=this.spec.side||0}map(e,r,n,i){let{pos:a,deleted:s}=e.mapResult(r.from+i,this.side<0?-1:1);return s?null:new Va(a-n,a-n,this)}valid(){return!0}eq(e){return this==e||e instanceof ky&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Zg(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class vd{constructor(e,r){this.attrs=e,this.spec=r||Ph}map(e,r,n,i){let a=e.map(r.from+i,this.spec.inclusiveStart?-1:1)-n,s=e.map(r.to+i,this.spec.inclusiveEnd?1:-1)-n;return a>=s?null:new Va(a,s,this)}valid(e,r){return r.from<r.to}eq(e){return this==e||e instanceof vd&&Zg(this.attrs,e.attrs)&&Zg(this.spec,e.spec)}static is(e){return e.type instanceof vd}destroy(){}}class bS{constructor(e,r){this.attrs=e,this.spec=r||Ph}map(e,r,n,i){let a=e.mapResult(r.from+i,1);if(a.deleted)return null;let s=e.mapResult(r.to+i,-1);return s.deleted||s.pos<=a.pos?null:new Va(a.pos-n,s.pos-n,this)}valid(e,r){let{index:n,offset:i}=e.content.findIndex(r.from),a;return i==r.from&&!(a=e.child(n)).isText&&i+a.nodeSize==r.to}eq(e){return this==e||e instanceof bS&&Zg(this.attrs,e.attrs)&&Zg(this.spec,e.spec)}destroy(){}}class Va{constructor(e,r,n){this.from=e,this.to=r,this.type=n}copy(e,r){return new Va(e,r,this.type)}eq(e,r=0){return this.type.eq(e.type)&&this.from+r==e.from&&this.to+r==e.to}map(e,r,n){return this.type.map(e,this,r,n)}static widget(e,r,n){return new Va(e,e,new ky(r,n))}static inline(e,r,n,i){return new Va(e,r,new vd(n,i))}static node(e,r,n,i){return new Va(e,r,new bS(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof vd}get widget(){return this.type instanceof ky}}const $f=[],Ph={};class An{constructor(e,r){this.local=e.length?e:$f,this.children=r.length?r:$f}static create(e,r){return r.length?Cy(r,e,0,Ph):Fa}find(e,r,n){let i=[];return this.findInner(e??0,r??1e9,i,0,n),i}findInner(e,r,n,i,a){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=r&&o.to>=e&&(!a||a(o.spec))&&n.push(o.copy(o.from+i,o.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<r&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,r-o,n,i+o,a)}}map(e,r,n){return this==Fa||e.maps.length==0?this:this.mapInner(e,r,0,0,n||Ph)}mapInner(e,r,n,i,a){let s;for(let o=0;o<this.local.length;o++){let l=this.local[o].map(e,n,i);l&&l.type.valid(r,l)?(s||(s=[])).push(l):a.onRemove&&a.onRemove(this.local[o].spec)}return this.children.length?dG(this.children,s||[],e,r,n,i,a):s?new An(s.sort(Mh),$f):Fa}add(e,r){return r.length?this==Fa?An.create(e,r):this.addInner(e,r,0):this}addInner(e,r,n){let i,a=0;e.forEach((o,l)=>{let u=l+n,c;if(c=nA(r,o,u)){for(i||(i=this.children.slice());a<i.length&&i[a]<l;)a+=3;i[a]==l?i[a+2]=i[a+2].addInner(o,c,u+1):i.splice(a,0,l,l+o.nodeSize,Cy(c,o,u+1,Ph)),a+=3}});let s=rA(a?iA(r):r,-n);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||s.splice(o--,1);return new An(s.length?this.local.concat(s).sort(Mh):this.local,i||this.children)}remove(e){return e.length==0||this==Fa?this:this.removeInner(e,0)}removeInner(e,r){let n=this.children,i=this.local;for(let a=0;a<n.length;a+=3){let s,o=n[a]+r,l=n[a+1]+r;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>o&&f.to<l&&(e[c]=null,(s||(s=[])).push(f));if(!s)continue;n==this.children&&(n=this.children.slice());let u=n[a+2].removeInner(s,o+1);u!=Fa?n[a+2]=u:(n.splice(a,3),a-=3)}if(i.length){for(let a=0,s;a<e.length;a++)if(s=e[a])for(let o=0;o<i.length;o++)i[o].eq(s,r)&&(i==this.local&&(i=this.local.slice()),i.splice(o--,1))}return n==this.children&&i==this.local?this:i.length||n.length?new An(i,n):Fa}forChild(e,r){if(this==Fa)return this;if(r.isLeaf)return An.empty;let n,i;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}let a=e+1,s=a+r.content.size;for(let o=0;o<this.local.length;o++){let l=this.local[o];if(l.from<s&&l.to>a&&l.type instanceof vd){let u=Math.max(a,l.from)-a,c=Math.min(s,l.to)-a;u<c&&(i||(i=[])).push(l.copy(u,c))}}if(i){let o=new An(i.sort(Mh),$f);return n?new ed([o,n]):o}return n||Fa}eq(e){if(this==e)return!0;if(!(e instanceof An)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(e.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=e.children[r]||this.children[r+1]!=e.children[r+1]||!this.children[r+2].eq(e.children[r+2]))return!1;return!0}locals(e){return wS(this.localsInner(e))}localsInner(e){if(this==Fa)return $f;if(e.inlineContent||!this.local.some(vd.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof vd||r.push(this.local[n]);return r}forEachSet(e){e(this)}}An.empty=new An([],[]);An.removeOverlap=wS;const Fa=An.empty;class ed{constructor(e){this.members=e}map(e,r){const n=this.members.map(i=>i.map(e,r,Ph));return ed.from(n)}forChild(e,r){if(r.isLeaf)return An.empty;let n=[];for(let i=0;i<this.members.length;i++){let a=this.members[i].forChild(e,r);a!=Fa&&(a instanceof ed?n=n.concat(a.members):n.push(a))}return ed.from(n)}eq(e){if(!(e instanceof ed)||e.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(e.members[r]))return!1;return!0}locals(e){let r,n=!0;for(let i=0;i<this.members.length;i++){let a=this.members[i].localsInner(e);if(a.length)if(!r)r=a;else{n&&(r=r.slice(),n=!1);for(let s=0;s<a.length;s++)r.push(a[s])}}return r?wS(n?r:r.sort(Mh)):$f}static from(e){switch(e.length){case 0:return Fa;case 1:return e[0];default:return new ed(e.every(r=>r instanceof An)?e:e.reduce((r,n)=>r.concat(n instanceof An?n:n.members),[]))}}forEachSet(e){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(e)}}function dG(t,e,r,n,i,a,s){let o=t.slice();for(let u=0,c=a;u<r.maps.length;u++){let f=0;r.maps[u].forEach((g,v,x,_)=>{let S=_-x-(v-g);for(let N=0;N<o.length;N+=3){let k=o[N+1];if(k<0||g>k+c-f)continue;let E=o[N]+c-f;v>=E?o[N+1]=g<=E?-2:-1:g>=c&&S&&(o[N]+=S,o[N+1]+=S)}f+=S}),c=r.maps[u].map(c,-1)}let l=!1;for(let u=0;u<o.length;u+=3)if(o[u+1]<0){if(o[u+1]==-2){l=!0,o[u+1]=-1;continue}let c=r.map(t[u]+a),f=c-i;if(f<0||f>=n.content.size){l=!0;continue}let g=r.map(t[u+1]+a,-1),v=g-i,{index:x,offset:_}=n.content.findIndex(f),S=n.maybeChild(x);if(S&&_==f&&_+S.nodeSize==v){let N=o[u+2].mapInner(r,S,c+1,t[u]+a+1,s);N!=Fa?(o[u]=f,o[u+1]=v,o[u+2]=N):(o[u+1]=-2,l=!0)}else l=!0}if(l){let u=hG(o,t,e,r,i,a,s),c=Cy(u,n,0,s);e=c.local;for(let f=0;f<o.length;f+=3)o[f+1]<0&&(o.splice(f,3),f-=3);for(let f=0,g=0;f<c.children.length;f+=3){let v=c.children[f];for(;g<o.length&&o[g]<v;)g+=3;o.splice(g,0,c.children[f],c.children[f+1],c.children[f+2])}}return new An(e.sort(Mh),o)}function rA(t,e){if(!e||!t.length)return t;let r=[];for(let n=0;n<t.length;n++){let i=t[n];r.push(new Va(i.from+e,i.to+e,i.type))}return r}function hG(t,e,r,n,i,a,s){function o(l,u){for(let c=0;c<l.local.length;c++){let f=l.local[c].map(n,i,u);f?r.push(f):s.onRemove&&s.onRemove(l.local[c].spec)}for(let c=0;c<l.children.length;c+=3)o(l.children[c+2],l.children[c]+u+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&o(t[l+2],e[l]+a+1);return r}function nA(t,e,r){if(e.isLeaf)return null;let n=r+e.nodeSize,i=null;for(let a=0,s;a<t.length;a++)(s=t[a])&&s.from>r&&s.to<n&&((i||(i=[])).push(s),t[a]=null);return i}function iA(t){let e=[];for(let r=0;r<t.length;r++)t[r]!=null&&e.push(t[r]);return e}function Cy(t,e,r,n){let i=[],a=!1;e.forEach((o,l)=>{let u=nA(t,o,l+r);if(u){a=!0;let c=Cy(u,o,r+l+1,n);c!=Fa&&i.push(l,l+o.nodeSize,c)}});let s=rA(a?iA(t):t,-r).sort(Mh);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||(n.onRemove&&n.onRemove(s[o].spec),s.splice(o--,1));return s.length||i.length?new An(s,i):Fa}function Mh(t,e){return t.from-e.from||t.to-e.to}function wS(t){let e=t;for(let r=0;r<e.length-1;r++){let n=e[r];if(n.from!=n.to)for(let i=r+1;i<e.length;i++){let a=e[i];if(a.from==n.from){a.to!=n.to&&(e==t&&(e=t.slice()),e[i]=a.copy(a.from,n.to),HT(e,i+1,a.copy(n.to,a.to)));continue}else{a.from<n.to&&(e==t&&(e=t.slice()),e[r]=n.copy(n.from,a.from),HT(e,i,n.copy(a.from,n.to)));break}}}return e}function HT(t,e,r){for(;e<t.length&&Mh(r,t[e])>0;)e++;t.splice(e,0,r)}function Uw(t){let e=[];return t.someProp("decorations",r=>{let n=r(t.state);n&&n!=Fa&&e.push(n)}),t.cursorWrapper&&e.push(An.create(t.state.doc,[t.cursorWrapper.deco])),ed.from(e)}const fG={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},pG=js&&md<=11;class mG{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class gG{constructor(e,r){this.view=e,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new mG,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let i=0;i<n.length;i++)this.queue.push(n[i]);js&&md<=11&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():ka&&e.composing&&n.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),pG&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,fG)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let r=0;r<e.length;r++)this.queue.push(e[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(OT(this.view)){if(this.suppressingSelectionUpdates)return Gu(this.view);if(js&&md<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Uh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let r=new Set,n;for(let a=e.focusNode;a;a=pp(a))r.add(a);for(let a=e.anchorNode;a;a=pp(a))if(r.has(a)){n=a;break}let i=n&&this.view.docView.nearestDesc(n);if(i&&i.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&OT(e)&&!this.ignoreSelectionChange(n),a=-1,s=-1,o=!1,l=[];if(e.editable)for(let c=0;c<r.length;c++){let f=this.registerMutation(r[c],l);f&&(a=a<0?f.from:Math.min(f.from,a),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(o=!0))}if(Po&&l.length){let c=l.filter(f=>f.nodeName=="BR");if(c.length==2){let[f,g]=c;f.parentNode&&f.parentNode.parentNode==g.parentNode?g.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let g of c){let v=g.parentNode;v&&v.nodeName=="LI"&&(!f||xG(e,f)!=v)&&g.remove()}}}else if((Ki||ka)&&l.some(c=>c.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let c of l)if(c.nodeName=="BR"&&c.parentNode){let f=c.nextSibling;f&&f.nodeType==1&&f.contentEditable=="false"&&c.parentNode.removeChild(c)}}let u=null;a<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Ix(n)&&(u=pS(e))&&u.eq(ar.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Gu(e),this.currentSelection.set(n),e.scrollToSelection()):(a>-1||i)&&(a>-1&&(e.docView.markDirty(a,s),vG(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,bG(e,l)),this.handleDOMChange(a,s,o,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||Gu(e),this.currentSelection.set(n))}registerMutation(e,r){if(r.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let f=e.addedNodes[c];r.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,a=e.nextSibling;if(js&&md<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:f,nextSibling:g}=e.addedNodes[c];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!g||Array.prototype.indexOf.call(e.addedNodes,g)<0)&&(a=g)}let s=i&&i.parentNode==e.target?ba(i)+1:0,o=n.localPosFromDOM(e.target,s,-1),l=a&&a.parentNode==e.target?ba(a):e.target.childNodes.length,u=n.localPosFromDOM(e.target,l,1);return{from:o,to:u}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let GT=new WeakMap,qT=!1;function vG(t){if(!GT.has(t)&&(GT.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Po,qT)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),qT=!0}}function WT(t,e){let r=e.startContainer,n=e.startOffset,i=e.endContainer,a=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return Uh(s.node,s.offset,i,a)&&([r,n,i,a]=[i,a,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:a}}function yG(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return WT(t,i)}let r;function n(i){i.preventDefault(),i.stopImmediatePropagation(),r=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0),r?WT(t,r):null}function xG(t,e){for(let r=e.parentNode;r&&r!=t.dom;r=r.parentNode){let n=t.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function bG(t,e){var r;let{focusNode:n,focusOffset:i}=t.domSelectionRange();for(let a of e)if(((r=a.parentNode)===null||r===void 0?void 0:r.nodeName)=="TR"){let s=a.nextSibling;for(;s&&s.nodeName!="TD"&&s.nodeName!="TH";)s=s.nextSibling;if(s){let o=s;for(;;){let l=o.firstChild;if(!l||l.nodeType!=1||l.contentEditable=="false"||/^(BR|IMG)$/.test(l.nodeName))break;o=l}o.insertBefore(a,o.firstChild),n==a&&t.domSelection().collapse(a,i)}else a.parentNode.removeChild(a)}}function wG(t,e,r){let{node:n,fromOffset:i,toOffset:a,from:s,to:o}=t.docView.parseRange(e,r),l=t.domSelectionRange(),u,c=l.anchorNode;if(c&&t.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:l.anchorOffset}],Ix(l)||u.push({node:l.focusNode,offset:l.focusOffset})),Ki&&t.input.lastKeyCode===8)for(let S=a;S>i;S--){let N=n.childNodes[S-1],k=N.pmViewDesc;if(N.nodeName=="BR"&&!k){a=S;break}if(!k||k.size)break}let f=t.state.doc,g=t.someProp("domParser")||pd.fromSchema(t.state.schema),v=f.resolve(s),x=null,_=g.parse(n,{topNode:v.parent,topMatch:v.parent.contentMatchAt(v.index()),topOpen:!0,from:i,to:a,preserveWhitespace:v.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:_G,context:v});if(u&&u[0].pos!=null){let S=u[0].pos,N=u[1]&&u[1].pos;N==null&&(N=S),x={anchor:S+s,head:N+s}}return{doc:_,sel:x,from:s,to:o}}function _G(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(ka&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(t.parentNode.lastChild==t||ka&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const SG=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function kG(t,e,r,n,i){let a=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let D=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,B=pS(t,D);if(B&&!t.state.selection.eq(B)){if(Ki&&Uu&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",V=>V(t,bh(13,"Enter"))))return;let I=t.state.tr.setSelection(B);D=="pointer"?I.setMeta("pointer",!0):D=="key"&&I.scrollIntoView(),a&&I.setMeta("composition",a),t.dispatch(I)}return}let s=t.state.doc.resolve(e),o=s.sharedDepth(r);e=s.before(o+1),r=t.state.doc.resolve(r).after(o+1);let l=t.state.selection,u=wG(t,e,r),c=t.state.doc,f=c.slice(u.from,u.to),g,v;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(g=t.state.selection.to,v="end"):(g=t.state.selection.from,v="start"),t.input.lastKeyCode=null;let x=NG(f.content,u.doc.content,u.from,g,v);if(x&&t.input.domChangeCount++,(mp&&t.input.lastIOSEnter>Date.now()-225||Uu)&&i.some(D=>D.nodeType==1&&!SG.test(D.nodeName))&&(!x||x.endA>=x.endB)&&t.someProp("handleKeyDown",D=>D(t,bh(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!x)if(n&&l instanceof Yt&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))x={start:l.from,endA:l.to,endB:l.to};else{if(u.sel){let D=$T(t,t.state.doc,u.sel);if(D&&!D.eq(t.state.selection)){let B=t.state.tr.setSelection(D);a&&B.setMeta("composition",a),t.dispatch(B)}}return}t.state.selection.from<t.state.selection.to&&x.start==x.endB&&t.state.selection instanceof Yt&&(x.start>t.state.selection.from&&x.start<=t.state.selection.from+2&&t.state.selection.from>=u.from?x.start=t.state.selection.from:x.endA<t.state.selection.to&&x.endA>=t.state.selection.to-2&&t.state.selection.to<=u.to&&(x.endB+=t.state.selection.to-x.endA,x.endA=t.state.selection.to)),js&&md<=11&&x.endB==x.start+1&&x.endA==x.start&&x.start>u.from&&u.doc.textBetween(x.start-u.from-1,x.start-u.from+1)==" "&&(x.start--,x.endA--,x.endB--);let _=u.doc.resolveNoCache(x.start-u.from),S=u.doc.resolveNoCache(x.endB-u.from),N=c.resolve(x.start),k=_.sameParent(S)&&_.parent.inlineContent&&N.end()>=x.endA;if((mp&&t.input.lastIOSEnter>Date.now()-225&&(!k||i.some(D=>D.nodeName=="DIV"||D.nodeName=="P"))||!k&&_.pos<u.doc.content.size&&(!_.sameParent(S)||!_.parent.inlineContent)&&_.pos<S.pos&&!/\S/.test(u.doc.textBetween(_.pos,S.pos,"","")))&&t.someProp("handleKeyDown",D=>D(t,bh(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>x.start&&EG(c,x.start,x.endA,_,S)&&t.someProp("handleKeyDown",D=>D(t,bh(8,"Backspace")))){Uu&&Ki&&t.domObserver.suppressSelectionUpdates();return}Ki&&x.endB==x.start&&(t.input.lastChromeDelete=Date.now()),Uu&&!k&&_.start()!=S.start()&&S.parentOffset==0&&_.depth==S.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==x.endA&&(x.endB-=2,S=u.doc.resolveNoCache(x.endB-u.from),setTimeout(()=>{t.someProp("handleKeyDown",function(D){return D(t,bh(13,"Enter"))})},20));let E=x.start,T=x.endA,R=D=>{let B=D||t.state.tr.replace(E,T,u.doc.slice(x.start-u.from,x.endB-u.from));if(u.sel){let I=$T(t,B.doc,u.sel);I&&!(Ki&&t.composing&&I.empty&&(x.start!=x.endB||t.input.lastChromeDelete<Date.now()-100)&&(I.head==E||I.head==B.mapping.map(T)-1)||js&&I.empty&&I.head==E)&&B.setSelection(I)}return a&&B.setMeta("composition",a),B.scrollIntoView()},j;if(k)if(_.pos==S.pos){js&&md<=11&&_.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Gu(t),20));let D=R(t.state.tr.delete(E,T)),B=c.resolve(x.start).marksAcross(c.resolve(x.endA));B&&D.ensureMarks(B),t.dispatch(D)}else if(x.endA==x.endB&&(j=CG(_.parent.content.cut(_.parentOffset,S.parentOffset),N.parent.content.cut(N.parentOffset,x.endA-N.start())))){let D=R(t.state.tr);j.type=="add"?D.addMark(E,T,j.mark):D.removeMark(E,T,j.mark),t.dispatch(D)}else if(_.parent.child(_.index()).isText&&_.index()==S.index()-(S.textOffset?0:1)){let D=_.parent.textBetween(_.parentOffset,S.parentOffset),B=()=>R(t.state.tr.insertText(D,E,T));t.someProp("handleTextInput",I=>I(t,E,T,D,B))||t.dispatch(B())}else t.dispatch(R());else t.dispatch(R())}function $T(t,e,r){return Math.max(r.anchor,r.head)>e.content.size?null:mS(t,e.resolve(r.anchor),e.resolve(r.head))}function CG(t,e){let r=t.firstChild.marks,n=e.firstChild.marks,i=r,a=n,s,o,l;for(let c=0;c<n.length;c++)i=n[c].removeFromSet(i);for(let c=0;c<r.length;c++)a=r[c].removeFromSet(a);if(i.length==1&&a.length==0)o=i[0],s="add",l=c=>c.mark(o.addToSet(c.marks));else if(i.length==0&&a.length==1)o=a[0],s="remove",l=c=>c.mark(o.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(l(e.child(c)));if(Qe.from(u).eq(t))return{mark:o,type:s}}function EG(t,e,r,n,i){if(r-e<=i.pos-n.pos||Hw(n,!0,!1)<i.pos)return!1;let a=t.resolve(e);if(!n.parent.isTextblock){let o=a.nodeAfter;return o!=null&&r==e+o.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let s=t.resolve(Hw(a,!0,!0));return!s.parent.isTextblock||s.pos>r||Hw(s,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(s.parent.content)}function Hw(t,e,r){let n=t.depth,i=e?t.end():t.pos;for(;n>0&&(e||t.indexAfter(n)==t.node(n).childCount);)n--,i++,e=!1;if(r){let a=t.node(n).maybeChild(t.indexAfter(n));for(;a&&!a.isLeaf;)a=a.firstChild,i++}return i}function NG(t,e,r,n,i){let a=t.findDiffStart(e,r);if(a==null)return null;let{a:s,b:o}=t.findDiffEnd(e,r+t.size,r+e.size);if(i=="end"){let l=Math.max(0,a-Math.min(s,o));n-=s+l-a}if(s<a&&t.size<e.size){let l=n<=a&&n>=s?a-n:0;a-=l,a&&a<e.size&&KT(e.textBetween(a-1,a+1))&&(a+=l?1:-1),o=a+(o-s),s=a}else if(o<a){let l=n<=a&&n>=o?a-n:0;a-=l,a&&a<t.size&&KT(t.textBetween(a-1,a+1))&&(a+=l?1:-1),s=a+(s-o),o=a}return{start:a,endA:s,endB:o}}function KT(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),r=t.charCodeAt(1);return e>=56320&&e<=57343&&r>=55296&&r<=56319}class aA{constructor(e,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new HH,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach(JT),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=XT(this),YT(this),this.nodeViews=QT(this),this.docView=PT(this.state.doc,ZT(this),Uw(this),this.dom,this),this.domObserver=new gG(this,(n,i,a,s)=>kG(this,n,i,a,s)),this.domObserver.start(),GH(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let r in e)this._props[r]=e[r];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Q2(this);let r=this._props;this._props=e,e.plugins&&(e.plugins.forEach(JT),this.directPlugins=e.plugins),this.updateStateInner(e.state,r)}setProps(e){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in e)r[n]=e[n];this.update(r)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,r){var n;let i=this.state,a=!1,s=!1;e.storedMarks&&this.composing&&(Q6(this),s=!0),this.state=e;let o=i.plugins!=e.plugins||this._props.plugins!=r.plugins;if(o||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let v=QT(this);PG(v,this.nodeViews)&&(this.nodeViews=v,a=!0)}(o||r.handleDOMEvents!=this._props.handleDOMEvents)&&Q2(this),this.editable=XT(this),YT(this);let l=Uw(this),u=ZT(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=a||!this.docView.matchesNode(e.doc,u,l);(f||!e.selection.eq(i.selection))&&(s=!0);let g=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&iH(this);if(s){this.domObserver.stop();let v=f&&(js||Ki)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&TG(i.selection,e.selection);if(f){let x=Ki?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=iG(this)),(a||!this.docView.update(e.doc,u,l,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=PT(e.doc,u,l,this.dom,this)),x&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(v=!0)}v||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&TH(this))?Gu(this,v):(F6(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((n=this.dragging)===null||n===void 0)&&n.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():g&&aH(g)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof It){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&ST(this,r.getBoundingClientRect(),e)}else ST(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,e)}}updateDraggedNode(e,r){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let a=n.from+(this.state.doc.content.size-r.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==n.node&&(i=a)}this.dragging=new eA(e.slice,e.move,i<0?void 0:It.create(this.state.doc,i))}someProp(e,r){let n=this._props&&this._props[e],i;if(n!=null&&(i=r?r(n):n))return i;for(let s=0;s<this.directPlugins.length;s++){let o=this.directPlugins[s].props[e];if(o!=null&&(i=r?r(o):o))return i}let a=this.state.plugins;if(a)for(let s=0;s<a.length;s++){let o=a[s].props[e];if(o!=null&&(i=r?r(o):o))return i}}hasFocus(){if(js){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&sH(this.dom),Gu(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return e||document}updateRoot(){this._root=null}posAtCoords(e){return dH(this,e)}coordsAtPos(e,r=1){return j6(this,e,r)}domAtPos(e,r=0){return this.docView.domFromPos(e,r)}nodeDOM(e){let r=this.docView.descAt(e);return r?r.nodeDOM:null}posAtDOM(e,r,n=-1){let i=this.docView.posFromDOM(e,r,n);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,r){return gH(this,r||this.state,e)}pasteHTML(e,r){return Kg(this,"",e,!1,r||new ClipboardEvent("paste"))}pasteText(e,r){return Kg(this,e,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(e){return gS(this,e)}destroy(){this.docView&&(qH(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Uw(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,KU())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return $H(this,e)}domSelectionRange(){let e=this.domSelection();return e?ka&&this.root.nodeType===11&&JU(this.dom.ownerDocument)==this.dom&&yG(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}aA.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function ZT(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(t.state)),r)for(let n in r)n=="class"?e.class+=" "+r[n]:n=="style"?e.style=(e.style?e.style+";":"")+r[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(r[n]))}),e.translate||(e.translate="no"),[Va.node(0,t.state.doc.content.size,e)]}function YT(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Va.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function XT(t){return!t.someProp("editable",e=>e(t.state)===!1)}function TG(t,e){let r=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(r)!=e.$anchor.start(r)}function QT(t){let e=Object.create(null);function r(n){for(let i in n)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n[i])}return t.someProp("nodeViews",r),t.someProp("markViews",r),e}function PG(t,e){let r=0,n=0;for(let i in t){if(t[i]!=e[i])return!0;r++}for(let i in e)n++;return r!=n}function JT(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var kd={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ey={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},MG=typeof navigator<"u"&&/Mac/.test(navigator.platform),AG=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var wa=0;wa<10;wa++)kd[48+wa]=kd[96+wa]=String(wa);for(var wa=1;wa<=24;wa++)kd[wa+111]="F"+wa;for(var wa=65;wa<=90;wa++)kd[wa]=String.fromCharCode(wa+32),Ey[wa]=String.fromCharCode(wa);for(var Gw in kd)Ey.hasOwnProperty(Gw)||(Ey[Gw]=kd[Gw]);function jG(t){var e=MG&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||AG&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?Ey:kd)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const RG=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),LG=typeof navigator<"u"&&/Win/.test(navigator.platform);function OG(t){let e=t.split(/-(?!$)/),r=e[e.length-1];r=="Space"&&(r=" ");let n,i,a,s;for(let o=0;o<e.length-1;o++){let l=e[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))RG?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(r="Alt-"+r),i&&(r="Ctrl-"+r),s&&(r="Meta-"+r),a&&(r="Shift-"+r),r}function DG(t){let e=Object.create(null);for(let r in t)e[OG(r)]=t[r];return e}function qw(t,e,r=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r&&e.shiftKey&&(t="Shift-"+t),t}function IG(t){return new Ln({props:{handleKeyDown:sA(t)}})}function sA(t){let e=DG(t);return function(r,n){let i=jG(n),a,s=e[qw(i,n)];if(s&&s(r.state,r.dispatch,r))return!0;if(i.length==1&&i!=" "){if(n.shiftKey){let o=e[qw(i,n,!1)];if(o&&o(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(LG&&n.ctrlKey&&n.altKey)&&(a=kd[n.keyCode])&&a!=i){let o=e[qw(a,n)];if(o&&o(r.state,r.dispatch,r))return!0}}return!1}}var BG=Object.defineProperty,_S=(t,e)=>{for(var r in e)BG(t,r,{get:e[r],enumerable:!0})};function Fx(t){const{state:e,transaction:r}=t;let{selection:n}=r,{doc:i}=r,{storedMarks:a}=r;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return n},get doc(){return i},get tr(){return n=r.selection,i=r.doc,a=r.storedMarks,r}}}var Vx=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:r}=this,{view:n}=e,{tr:i}=r,a=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([s,o])=>[s,(...u)=>{const c=o(...u)(a);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(i),c}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:r,editor:n,state:i}=this,{view:a}=n,s=[],o=!!t,l=t||i.tr,u=()=>(!o&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(l),s.every(f=>f===!0)),c={...Object.fromEntries(Object.entries(r).map(([f,g])=>[f,(...x)=>{const _=this.buildProps(l,e),S=g(...x)(_);return s.push(S),c}])),run:u};return c}createCan(t){const{rawCommands:e,state:r}=this,n=!1,i=t||r.tr,a=this.buildProps(i,n);return{...Object.fromEntries(Object.entries(e).map(([o,l])=>[o,(...u)=>l(...u)({...a,dispatch:void 0})])),chain:()=>this.createChain(i,n)}}buildProps(t,e=!0){const{rawCommands:r,editor:n,state:i}=this,{view:a}=n,s={tr:t,editor:n,view:a,state:Fx({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([o,l])=>[o,(...u)=>l(...u)(s)]))}};return s}},oA={};_S(oA,{blur:()=>zG,clearContent:()=>FG,clearNodes:()=>VG,command:()=>UG,createParagraphNear:()=>HG,cut:()=>GG,deleteCurrentNode:()=>qG,deleteNode:()=>WG,deleteRange:()=>$G,deleteSelection:()=>KG,enter:()=>ZG,exitCode:()=>YG,extendMarkRange:()=>XG,first:()=>QG,focus:()=>eq,forEach:()=>tq,insertContent:()=>rq,insertContentAt:()=>aq,joinBackward:()=>lq,joinDown:()=>oq,joinForward:()=>uq,joinItemBackward:()=>cq,joinItemForward:()=>dq,joinTextblockBackward:()=>hq,joinTextblockForward:()=>fq,joinUp:()=>sq,keyboardShortcut:()=>mq,lift:()=>gq,liftEmptyBlock:()=>vq,liftListItem:()=>yq,newlineInCode:()=>xq,resetAttributes:()=>bq,scrollIntoView:()=>wq,selectAll:()=>_q,selectNodeBackward:()=>Sq,selectNodeForward:()=>kq,selectParentNode:()=>Cq,selectTextblockEnd:()=>Eq,selectTextblockStart:()=>Nq,setContent:()=>Tq,setMark:()=>Kq,setMeta:()=>Zq,setNode:()=>Yq,setNodeSelection:()=>Xq,setTextDirection:()=>Qq,setTextSelection:()=>Jq,sinkListItem:()=>eW,splitBlock:()=>tW,splitListItem:()=>rW,toggleList:()=>nW,toggleMark:()=>iW,toggleNode:()=>aW,toggleWrap:()=>sW,undoInputRule:()=>oW,unsetAllMarks:()=>lW,unsetMark:()=>uW,unsetTextDirection:()=>cW,updateAttributes:()=>dW,wrapIn:()=>hW,wrapInList:()=>fW});var zG=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var r;t.isDestroyed||(e.dom.blur(),(r=window?.getSelection())==null||r.removeAllRanges())}),!0),FG=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),VG=()=>({state:t,tr:e,dispatch:r})=>{const{selection:n}=e,{ranges:i}=n;return r&&i.forEach(({$from:a,$to:s})=>{t.doc.nodesBetween(a.pos,s.pos,(o,l)=>{if(o.type.isText)return;const{doc:u,mapping:c}=e,f=u.resolve(c.map(l)),g=u.resolve(c.map(l+o.nodeSize)),v=f.blockRange(g);if(!v)return;const x=jp(v);if(o.type.isTextblock){const{defaultType:_}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(v.start,_)}(x||x===0)&&e.lift(v,x)})}),!0},UG=t=>e=>t(e),HG=()=>({state:t,dispatch:e})=>w6(t,e),GG=(t,e)=>({editor:r,tr:n})=>{const{state:i}=r,a=i.doc.slice(t.from,t.to);n.deleteRange(t.from,t.to);const s=n.mapping.map(e);return n.insert(s,a.content),n.setSelection(new Yt(n.doc.resolve(Math.max(s-1,0)))),!0},qG=()=>({tr:t,dispatch:e})=>{const{selection:r}=t,n=r.$anchor.node();if(n.content.size>0)return!1;const i=t.selection.$anchor;for(let a=i.depth;a>0;a-=1)if(i.node(a).type===n.type){if(e){const o=i.before(a),l=i.after(a);t.delete(o,l).scrollIntoView()}return!0}return!1};function bi(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var WG=t=>({tr:e,state:r,dispatch:n})=>{const i=bi(t,r.schema),a=e.selection.$anchor;for(let s=a.depth;s>0;s-=1)if(a.node(s).type===i){if(n){const l=a.before(s),u=a.after(s);e.delete(l,u).scrollIntoView()}return!0}return!1},$G=t=>({tr:e,dispatch:r})=>{const{from:n,to:i}=t;return r&&e.delete(n,i),!0},KG=()=>({state:t,dispatch:e})=>lS(t,e),ZG=()=>({commands:t})=>t.keyboardShortcut("Enter"),YG=()=>({state:t,dispatch:e})=>RU(t,e);function SS(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Ny(t,e,r={strict:!0}){const n=Object.keys(e);return n.length?n.every(i=>r.strict?e[i]===t[i]:SS(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function lA(t,e,r={}){return t.find(n=>n.type===e&&Ny(Object.fromEntries(Object.keys(r).map(i=>[i,n.attrs[i]])),r))}function e3(t,e,r={}){return!!lA(t,e,r)}function kS(t,e,r){var n;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(c=>c.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(c=>c.type===e)||(r=r||((n=i.node.marks[0])==null?void 0:n.attrs),!lA([...i.node.marks],e,r)))return;let s=i.index,o=t.start()+i.offset,l=s+1,u=o+i.node.nodeSize;for(;s>0&&e3([...t.parent.child(s-1).marks],e,r);)s-=1,o-=t.parent.child(s).nodeSize;for(;l<t.parent.childCount&&e3([...t.parent.child(l).marks],e,r);)u+=t.parent.child(l).nodeSize,l+=1;return{from:o,to:u}}function Qu(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var XG=(t,e={})=>({tr:r,state:n,dispatch:i})=>{const a=Qu(t,n.schema),{doc:s,selection:o}=r,{$from:l,from:u,to:c}=o;if(i){const f=kS(l,a,e);if(f&&f.from<=u&&f.to>=c){const g=Yt.create(s,f.from,f.to);r.setSelection(g)}}return!0},QG=t=>e=>{const r=typeof t=="function"?t(e):t;for(let n=0;n<r.length;n+=1)if(r[n](e))return!0;return!1};function uA(t){return t instanceof Yt}function kh(t=0,e=0,r=0){return Math.min(Math.max(t,e),r)}function cA(t,e=null){if(!e)return null;const r=ar.atStart(t),n=ar.atEnd(t);if(e==="start"||e===!0)return r;if(e==="end")return n;const i=r.from,a=n.to;return e==="all"?Yt.create(t,kh(0,i,a),kh(t.content.size,i,a)):Yt.create(t,kh(e,i,a),kh(e,i,a))}function t3(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Ty(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function JG(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var eq=(t=null,e={})=>({editor:r,view:n,tr:i,dispatch:a})=>{e={scrollIntoView:!0,...e};const s=()=>{(Ty()||t3())&&n.dom.focus(),JG()&&!Ty()&&!t3()&&n.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{r.isDestroyed||(n.focus(),e?.scrollIntoView&&r.commands.scrollIntoView())})};if(n.hasFocus()&&t===null||t===!1)return!0;if(a&&t===null&&!uA(r.state.selection))return s(),!0;const o=cA(i.doc,t)||r.state.selection,l=r.state.selection.eq(o);return a&&(l||i.setSelection(o),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},tq=(t,e)=>r=>t.every((n,i)=>e(n,{...r,index:i})),rq=(t,e)=>({tr:r,commands:n})=>n.insertContentAt({from:r.selection.from,to:r.selection.to},t,e),dA=t=>{const e=t.childNodes;for(let r=e.length-1;r>=0;r-=1){const n=e[r];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?t.removeChild(n):n.nodeType===1&&dA(n)}return t};function S0(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,r=new window.DOMParser().parseFromString(e,"text/html").body;return dA(r)}function Yg(t,e,r){if(t instanceof To||t instanceof Qe)return t;r={slice:!0,parseOptions:{},...r};const n=typeof t=="object"&&t!==null,i=typeof t=="string";if(n)try{if(Array.isArray(t)&&t.length>0)return Qe.fromArray(t.map(o=>e.nodeFromJSON(o)));const s=e.nodeFromJSON(t);return r.errorOnInvalidContent&&s.check(),s}catch(a){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",a),Yg("",e,r)}if(i){if(r.errorOnInvalidContent){let s=!1,o="";const l=new KM({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:u=>(s=!0,o=typeof u=="string"?u:u.outerHTML,null)}]}})});if(r.slice?pd.fromSchema(l).parseSlice(S0(t),r.parseOptions):pd.fromSchema(l).parse(S0(t),r.parseOptions),r.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const a=pd.fromSchema(e);return r.slice?a.parseSlice(S0(t),r.parseOptions).content:a.parse(S0(t),r.parseOptions)}return Yg("",e,r)}function nq(t,e,r){const n=t.steps.length-1;if(n<e)return;const i=t.steps[n];if(!(i instanceof $i||i instanceof Yi))return;const a=t.mapping.maps[n];let s=0;a.forEach((o,l,u,c)=>{s===0&&(s=c)}),t.setSelection(ar.near(t.doc.resolve(s),r))}var iq=t=>!("type"in t),aq=(t,e,r)=>({tr:n,dispatch:i,editor:a})=>{var s;if(i){r={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let o;const l=S=>{a.emit("contentError",{editor:a,error:S,disableCollaboration:()=>{"collaboration"in a.storage&&typeof a.storage.collaboration=="object"&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{Yg(e,a.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(S){l(S)}try{o=Yg(e,a.schema,{parseOptions:u,errorOnInvalidContent:(s=r.errorOnInvalidContent)!=null?s:a.options.enableContentCheck})}catch(S){return l(S),!1}let{from:c,to:f}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},g=!0,v=!0;if((iq(o)?o:[o]).forEach(S=>{S.check(),g=g?S.isText&&S.marks.length===0:!1,v=v?S.isBlock:!1}),c===f&&v){const{parent:S}=n.doc.resolve(c);S.isTextblock&&!S.type.spec.code&&!S.childCount&&(c-=1,f+=1)}let _;if(g){if(Array.isArray(e))_=e.map(S=>S.text||"").join("");else if(e instanceof Qe){let S="";e.forEach(N=>{N.text&&(S+=N.text)}),_=S}else typeof e=="object"&&e&&e.text?_=e.text:_=e;n.insertText(_,c,f)}else{_=o;const S=n.doc.resolve(c),N=S.node(),k=S.parentOffset===0,E=N.isText||N.isTextblock,T=N.content.size>0;k&&E&&T&&(c=Math.max(0,c-1)),n.replaceWith(c,f,_)}r.updateSelection&&nq(n,n.steps.length-1,-1),r.applyInputRules&&n.setMeta("applyInputRules",{from:c,text:_}),r.applyPasteRules&&n.setMeta("applyPasteRules",{from:c,text:_})}return!0},sq=()=>({state:t,dispatch:e})=>MU(t,e),oq=()=>({state:t,dispatch:e})=>AU(t,e),lq=()=>({state:t,dispatch:e})=>p6(t,e),uq=()=>({state:t,dispatch:e})=>y6(t,e),cq=()=>({state:t,dispatch:e,tr:r})=>{try{const n=Lx(t.doc,t.selection.$from.pos,-1);return n==null?!1:(r.join(n,2),e&&e(r),!0)}catch{return!1}},dq=()=>({state:t,dispatch:e,tr:r})=>{try{const n=Lx(t.doc,t.selection.$from.pos,1);return n==null?!1:(r.join(n,2),e&&e(r),!0)}catch{return!1}},hq=()=>({state:t,dispatch:e})=>TU(t,e),fq=()=>({state:t,dispatch:e})=>PU(t,e);function hA(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function pq(t){const e=t.split(/-(?!$)/);let r=e[e.length-1];r==="Space"&&(r=" ");let n,i,a,s;for(let o=0;o<e.length-1;o+=1){const l=e[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))Ty()||hA()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(r=`Alt-${r}`),i&&(r=`Ctrl-${r}`),s&&(r=`Meta-${r}`),a&&(r=`Shift-${r}`),r}var mq=t=>({editor:e,view:r,tr:n,dispatch:i})=>{const a=pq(t).split(/-(?!$)/),s=a.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),o=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{r.someProp("handleKeyDown",u=>u(r,o))});return l?.steps.forEach(u=>{const c=u.map(n.mapping);c&&i&&n.maybeStep(c)}),!0};function Cd(t,e,r={}){const{from:n,to:i,empty:a}=t.selection,s=e?bi(e,t.schema):null,o=[];t.doc.nodesBetween(n,i,(f,g)=>{if(f.isText)return;const v=Math.max(n,g),x=Math.min(i,g+f.nodeSize);o.push({node:f,from:v,to:x})});const l=i-n,u=o.filter(f=>s?s.name===f.node.type.name:!0).filter(f=>Ny(f.node.attrs,r,{strict:!1}));return a?!!u.length:u.reduce((f,g)=>f+g.to-g.from,0)>=l}var gq=(t,e={})=>({state:r,dispatch:n})=>{const i=bi(t,r.schema);return Cd(r,i,e)?jU(r,n):!1},vq=()=>({state:t,dispatch:e})=>_6(t,e),yq=t=>({state:e,dispatch:r})=>{const n=bi(t,e.schema);return GU(n)(e,r)},xq=()=>({state:t,dispatch:e})=>b6(t,e);function Ux(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function r3(t,e){const r=typeof e=="string"?[e]:e;return Object.keys(t).reduce((n,i)=>(r.includes(i)||(n[i]=t[i]),n),{})}var bq=(t,e)=>({tr:r,state:n,dispatch:i})=>{let a=null,s=null;const o=Ux(typeof t=="string"?t:t.name,n.schema);if(!o)return!1;o==="node"&&(a=bi(t,n.schema)),o==="mark"&&(s=Qu(t,n.schema));let l=!1;return r.selection.ranges.forEach(u=>{n.doc.nodesBetween(u.$from.pos,u.$to.pos,(c,f)=>{a&&a===c.type&&(l=!0,i&&r.setNodeMarkup(f,void 0,r3(c.attrs,e))),s&&c.marks.length&&c.marks.forEach(g=>{s===g.type&&(l=!0,i&&r.addMark(f,f+c.nodeSize,s.create(r3(g.attrs,e))))})})}),l},wq=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),_q=()=>({tr:t,dispatch:e})=>{if(e){const r=new Xs(t.doc);t.setSelection(r)}return!0},Sq=()=>({state:t,dispatch:e})=>g6(t,e),kq=()=>({state:t,dispatch:e})=>x6(t,e),Cq=()=>({state:t,dispatch:e})=>DU(t,e),Eq=()=>({state:t,dispatch:e})=>zU(t,e),Nq=()=>({state:t,dispatch:e})=>BU(t,e);function J2(t,e,r={},n={}){return Yg(t,e,{slice:!1,parseOptions:r,errorOnInvalidContent:n.errorOnInvalidContent})}var Tq=(t,{errorOnInvalidContent:e,emitUpdate:r=!0,parseOptions:n={}}={})=>({editor:i,tr:a,dispatch:s,commands:o})=>{const{doc:l}=a;if(n.preserveWhitespace!=="full"){const u=J2(t,i.schema,n,{errorOnInvalidContent:e??i.options.enableContentCheck});return s&&a.replaceWith(0,l.content.size,u).setMeta("preventUpdate",!r),!0}return s&&a.setMeta("preventUpdate",!r),o.insertContentAt({from:0,to:l.content.size},t,{parseOptions:n,errorOnInvalidContent:e??i.options.enableContentCheck})};function fA(t,e){const r=Qu(e,t.schema),{from:n,to:i,empty:a}=t.selection,s=[];a?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(n,i,l=>{s.push(...l.marks)});const o=s.find(l=>l.type.name===r.name);return o?{...o.attrs}:{}}function pA(t,e){const r=new c6(t);return e.forEach(n=>{n.steps.forEach(i=>{r.step(i)})}),r}function Pq(t){for(let e=0;e<t.edgeCount;e+=1){const{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function Mq(t,e,r){const n=[];return t.nodesBetween(e.from,e.to,(i,a)=>{r(i)&&n.push({node:i,pos:a})}),n}function Aq(t,e){for(let r=t.depth;r>0;r-=1){const n=t.node(r);if(e(n))return{pos:r>0?t.before(r):0,start:t.start(r),depth:r,node:n}}}function Hx(t){return e=>Aq(e.$from,t)}function Lt(t,e,r){return t.config[e]===void 0&&t.parent?Lt(t.parent,e,r):typeof t.config[e]=="function"?t.config[e].bind({...r,parent:t.parent?Lt(t.parent,e,r):null}):t.config[e]}function CS(t){return t.map(e=>{const r={name:e.name,options:e.options,storage:e.storage},n=Lt(e,"addExtensions",r);return n?[e,...CS(n())]:e}).flat(10)}function ES(t,e){const r=Yh.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(r),i.innerHTML}function mA(t){return typeof t=="function"}function Hr(t,e=void 0,...r){return mA(t)?e?t.bind(e)(...r):t(...r):t}function jq(t={}){return Object.keys(t).length===0&&t.constructor===Object}function gp(t){const e=t.filter(i=>i.type==="extension"),r=t.filter(i=>i.type==="node"),n=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:r,markExtensions:n}}function gA(t){const e=[],{nodeExtensions:r,markExtensions:n}=gp(t),i=[...r,...n],a={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage,extensions:i},l=Lt(s,"addGlobalAttributes",o);if(!l)return;l().forEach(c=>{c.types.forEach(f=>{Object.entries(c.attributes).forEach(([g,v])=>{e.push({type:f,name:g,attribute:{...a,...v}})})})})}),i.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage},l=Lt(s,"addAttributes",o);if(!l)return;const u=l();Object.entries(u).forEach(([c,f])=>{const g={...a,...f};typeof g?.default=="function"&&(g.default=g.default()),g?.isRequired&&g?.default===void 0&&delete g.default,e.push({type:s.name,name:c,attribute:g})})}),e}function Rn(...t){return t.filter(e=>!!e).reduce((e,r)=>{const n={...e};return Object.entries(r).forEach(([i,a])=>{if(!n[i]){n[i]=a;return}if(i==="class"){const o=a?String(a).split(" "):[],l=n[i]?n[i].split(" "):[],u=o.filter(c=>!l.includes(c));n[i]=[...l,...u].join(" ")}else if(i==="style"){const o=a?a.split(";").map(c=>c.trim()).filter(Boolean):[],l=n[i]?n[i].split(";").map(c=>c.trim()).filter(Boolean):[],u=new Map;l.forEach(c=>{const[f,g]=c.split(":").map(v=>v.trim());u.set(f,g)}),o.forEach(c=>{const[f,g]=c.split(":").map(v=>v.trim());u.set(f,g)}),n[i]=Array.from(u.entries()).map(([c,f])=>`${c}: ${f}`).join("; ")}else n[i]=a}),n},{})}function Xg(t,e){return e.filter(r=>r.type===t.type.name).filter(r=>r.attribute.rendered).map(r=>r.attribute.renderHTML?r.attribute.renderHTML(t.attrs)||{}:{[r.name]:t.attrs[r.name]}).reduce((r,n)=>Rn(r,n),{})}function Rq(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function n3(t,e){return"style"in t?t:{...t,getAttrs:r=>{const n=t.getAttrs?t.getAttrs(r):t.attrs;if(n===!1)return!1;const i=e.reduce((a,s)=>{const o=s.attribute.parseHTML?s.attribute.parseHTML(r):Rq(r.getAttribute(s.name));return o==null?a:{...a,[s.name]:o}},{});return{...n,...i}}}}function i3(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>e==="attrs"&&jq(r)?!1:r!=null))}function a3(t){var e,r;const n={};return!((e=t?.attribute)!=null&&e.isRequired)&&"default"in(t?.attribute||{})&&(n.default=t.attribute.default),((r=t?.attribute)==null?void 0:r.validate)!==void 0&&(n.validate=t.attribute.validate),[t.name,n]}function Lq(t,e){var r;const n=gA(t),{nodeExtensions:i,markExtensions:a}=gp(t),s=(r=i.find(u=>Lt(u,"topNode")))==null?void 0:r.name,o=Object.fromEntries(i.map(u=>{const c=n.filter(N=>N.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:e},g=t.reduce((N,k)=>{const E=Lt(k,"extendNodeSchema",f);return{...N,...E?E(u):{}}},{}),v=i3({...g,content:Hr(Lt(u,"content",f)),marks:Hr(Lt(u,"marks",f)),group:Hr(Lt(u,"group",f)),inline:Hr(Lt(u,"inline",f)),atom:Hr(Lt(u,"atom",f)),selectable:Hr(Lt(u,"selectable",f)),draggable:Hr(Lt(u,"draggable",f)),code:Hr(Lt(u,"code",f)),whitespace:Hr(Lt(u,"whitespace",f)),linebreakReplacement:Hr(Lt(u,"linebreakReplacement",f)),defining:Hr(Lt(u,"defining",f)),isolating:Hr(Lt(u,"isolating",f)),attrs:Object.fromEntries(c.map(a3))}),x=Hr(Lt(u,"parseHTML",f));x&&(v.parseDOM=x.map(N=>n3(N,c)));const _=Lt(u,"renderHTML",f);_&&(v.toDOM=N=>_({node:N,HTMLAttributes:Xg(N,c)}));const S=Lt(u,"renderText",f);return S&&(v.toText=S),[u.name,v]})),l=Object.fromEntries(a.map(u=>{const c=n.filter(S=>S.type===u.name),f={name:u.name,options:u.options,storage:u.storage,editor:e},g=t.reduce((S,N)=>{const k=Lt(N,"extendMarkSchema",f);return{...S,...k?k(u):{}}},{}),v=i3({...g,inclusive:Hr(Lt(u,"inclusive",f)),excludes:Hr(Lt(u,"excludes",f)),group:Hr(Lt(u,"group",f)),spanning:Hr(Lt(u,"spanning",f)),code:Hr(Lt(u,"code",f)),attrs:Object.fromEntries(c.map(a3))}),x=Hr(Lt(u,"parseHTML",f));x&&(v.parseDOM=x.map(S=>n3(S,c)));const _=Lt(u,"renderHTML",f);return _&&(v.toDOM=S=>_({mark:S,HTMLAttributes:Xg(S,c)})),[u.name,v]}));return new KM({topNode:s,nodes:o,marks:l})}function Oq(t){const e=t.filter((r,n)=>t.indexOf(r)!==n);return Array.from(new Set(e))}function Py(t){return t.sort((r,n)=>{const i=Lt(r,"priority")||100,a=Lt(n,"priority")||100;return i>a?-1:i<a?1:0})}function vA(t){const e=Py(CS(t)),r=Oq(e.map(n=>n.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),e}function yA(t,e,r){const{from:n,to:i}=e,{blockSeparator:a=`

`,textSerializers:s={}}=r||{};let o="";return t.nodesBetween(n,i,(l,u,c,f)=>{var g;l.isBlock&&u>n&&(o+=a);const v=s?.[l.type.name];if(v)return c&&(o+=v({node:l,pos:u,parent:c,index:f,range:e})),!1;l.isText&&(o+=(g=l?.text)==null?void 0:g.slice(Math.max(n,u)-u,i-u))}),o}function Dq(t,e){const r={from:0,to:t.content.size};return yA(t,r,e)}function xA(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,r])=>[e,r.spec.toText]))}function Iq(t,e){const r=bi(e,t.schema),{from:n,to:i}=t.selection,a=[];t.doc.nodesBetween(n,i,o=>{a.push(o)});const s=a.reverse().find(o=>o.type.name===r.name);return s?{...s.attrs}:{}}function bA(t,e){const r=Ux(typeof e=="string"?e:e.name,t.schema);return r==="node"?Iq(t,e):r==="mark"?fA(t,e):{}}function Bq(t,e=JSON.stringify){const r={};return t.filter(n=>{const i=e(n);return Object.prototype.hasOwnProperty.call(r,i)?!1:r[i]=!0})}function zq(t){const e=Bq(t);return e.length===1?e:e.filter((r,n)=>!e.filter((a,s)=>s!==n).some(a=>r.oldRange.from>=a.oldRange.from&&r.oldRange.to<=a.oldRange.to&&r.newRange.from>=a.newRange.from&&r.newRange.to<=a.newRange.to))}function wA(t){const{mapping:e,steps:r}=t,n=[];return e.maps.forEach((i,a)=>{const s=[];if(i.ranges.length)i.forEach((o,l)=>{s.push({from:o,to:l})});else{const{from:o,to:l}=r[a];if(o===void 0||l===void 0)return;s.push({from:o,to:l})}s.forEach(({from:o,to:l})=>{const u=e.slice(a).map(o,-1),c=e.slice(a).map(l),f=e.invert().map(u,-1),g=e.invert().map(c);n.push({oldRange:{from:f,to:g},newRange:{from:u,to:c}})})}),zq(n)}function NS(t,e,r){const n=[];return t===e?r.resolve(t).marks().forEach(i=>{const a=r.resolve(t),s=kS(a,i.type);s&&n.push({mark:i,...s})}):r.nodesBetween(t,e,(i,a)=>{!i||i?.nodeSize===void 0||n.push(...i.marks.map(s=>({from:a,to:a+i.nodeSize,mark:s})))}),n}var Fq=(t,e,r,n=20)=>{const i=t.doc.resolve(r);let a=n,s=null;for(;a>0&&s===null;){const o=i.node(a);o?.type.name===e?s=o:a-=1}return[s,a]};function k0(t,e){return e.nodes[t]||e.marks[t]||null}function Z0(t,e,r){return Object.fromEntries(Object.entries(r).filter(([n])=>{const i=t.find(a=>a.type===e&&a.name===n);return i?i.attribute.keepOnSplit:!1}))}var Vq=(t,e=500)=>{let r="";const n=t.parentOffset;return t.parent.nodesBetween(Math.max(0,n-e),n,(i,a,s,o)=>{var l,u;const c=((u=(l=i.type.spec).toText)==null?void 0:u.call(l,{node:i,pos:a,parent:s,index:o}))||i.textContent||"%leaf%";r+=i.isAtom&&!i.isText?c:c.slice(0,Math.max(0,n-a))}),r};function e_(t,e,r={}){const{empty:n,ranges:i}=t.selection,a=e?Qu(e,t.schema):null;if(n)return!!(t.storedMarks||t.selection.$from.marks()).filter(f=>a?a.name===f.type.name:!0).find(f=>Ny(f.attrs,r,{strict:!1}));let s=0;const o=[];if(i.forEach(({$from:f,$to:g})=>{const v=f.pos,x=g.pos;t.doc.nodesBetween(v,x,(_,S)=>{if(!_.isText&&!_.marks.length)return;const N=Math.max(v,S),k=Math.min(x,S+_.nodeSize),E=k-N;s+=E,o.push(..._.marks.map(T=>({mark:T,from:N,to:k})))})}),s===0)return!1;const l=o.filter(f=>a?a.name===f.mark.type.name:!0).filter(f=>Ny(f.mark.attrs,r,{strict:!1})).reduce((f,g)=>f+g.to-g.from,0),u=o.filter(f=>a?f.mark.type!==a&&f.mark.type.excludes(a):!0).reduce((f,g)=>f+g.to-g.from,0);return(l>0?l+u:l)>=s}function Uq(t,e,r={}){if(!e)return Cd(t,null,r)||e_(t,null,r);const n=Ux(e,t.schema);return n==="node"?Cd(t,e,r):n==="mark"?e_(t,e,r):!1}var Hq=(t,e)=>{const{$from:r,$to:n,$anchor:i}=t.selection;if(e){const a=Hx(o=>o.type.name===e)(t.selection);if(!a)return!1;const s=t.doc.resolve(a.pos+1);return i.pos+1===s.end()}return!(n.parentOffset<n.parent.nodeSize-2||r.pos!==n.pos)},Gq=t=>{const{$from:e,$to:r}=t.selection;return!(e.parentOffset>0||e.pos!==r.pos)};function s3(t,e){return Array.isArray(e)?e.some(r=>(typeof r=="string"?r:r.name)===t.name):e}function o3(t,e){const{nodeExtensions:r}=gp(e),n=r.find(s=>s.name===t);if(!n)return!1;const i={name:n.name,options:n.options,storage:n.storage},a=Hr(Lt(n,"group",i));return typeof a!="string"?!1:a.split(" ").includes("list")}function Gx(t,{checkChildren:e=!0,ignoreWhitespace:r=!1}={}){var n;if(r){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((n=t.text)!=null?n:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(a=>{i!==!1&&(Gx(a,{ignoreWhitespace:r,checkChildren:e})||(i=!1))}),i}return!1}function _A(t){return t instanceof It}var SA=class kA{constructor(e){this.position=e}static fromJSON(e){return new kA(e.position)}toJSON(){return{position:this.position}}};function qq(t,e){const r=e.mapping.mapResult(t.position);return{position:new SA(r.pos),mapResult:r}}function Wq(t){return new SA(t)}function $q(t,e,r){var n;const{selection:i}=e;let a=null;if(uA(i)&&(a=i.$cursor),a){const o=(n=t.storedMarks)!=null?n:a.marks();return a.parent.type.allowsMarkType(r)&&(!!r.isInSet(o)||!o.some(u=>u.type.excludes(r)))}const{ranges:s}=i;return s.some(({$from:o,$to:l})=>{let u=o.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(r):!1;return t.doc.nodesBetween(o.pos,l.pos,(c,f,g)=>{if(u)return!1;if(c.isInline){const v=!g||g.type.allowsMarkType(r),x=!!r.isInSet(c.marks)||!c.marks.some(_=>_.type.excludes(r));u=v&&x}return!u}),u})}var Kq=(t,e={})=>({tr:r,state:n,dispatch:i})=>{const{selection:a}=r,{empty:s,ranges:o}=a,l=Qu(t,n.schema);if(i)if(s){const u=fA(n,l);r.addStoredMark(l.create({...u,...e}))}else o.forEach(u=>{const c=u.$from.pos,f=u.$to.pos;n.doc.nodesBetween(c,f,(g,v)=>{const x=Math.max(v,c),_=Math.min(v+g.nodeSize,f);g.marks.find(N=>N.type===l)?g.marks.forEach(N=>{l===N.type&&r.addMark(x,_,l.create({...N.attrs,...e}))}):r.addMark(x,_,l.create(e))})});return $q(n,r,l)},Zq=(t,e)=>({tr:r})=>(r.setMeta(t,e),!0),Yq=(t,e={})=>({state:r,dispatch:n,chain:i})=>{const a=bi(t,r.schema);let s;return r.selection.$anchor.sameParent(r.selection.$head)&&(s=r.selection.$anchor.parent.attrs),a.isTextblock?i().command(({commands:o})=>bT(a,{...s,...e})(r)?!0:o.clearNodes()).command(({state:o})=>bT(a,{...s,...e})(o,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Xq=t=>({tr:e,dispatch:r})=>{if(r){const{doc:n}=e,i=kh(t,0,n.content.size),a=It.create(n,i);e.setSelection(a)}return!0},Qq=(t,e)=>({tr:r,state:n,dispatch:i})=>{const{selection:a}=n;let s,o;return typeof e=="number"?(s=e,o=e):e&&"from"in e&&"to"in e?(s=e.from,o=e.to):(s=a.from,o=a.to),i&&r.doc.nodesBetween(s,o,(l,u)=>{l.isText||r.setNodeMarkup(u,void 0,{...l.attrs,dir:t})}),!0},Jq=t=>({tr:e,dispatch:r})=>{if(r){const{doc:n}=e,{from:i,to:a}=typeof t=="number"?{from:t,to:t}:t,s=Yt.atStart(n).from,o=Yt.atEnd(n).to,l=kh(i,s,o),u=kh(a,s,o),c=Yt.create(n,l,u);e.setSelection(c)}return!0},eW=t=>({state:e,dispatch:r})=>{const n=bi(t,e.schema);return $U(n)(e,r)};function l3(t,e){const r=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(r){const n=r.filter(i=>e?.includes(i.type.name));t.tr.ensureMarks(n)}}var tW=({keepMarks:t=!0}={})=>({tr:e,state:r,dispatch:n,editor:i})=>{const{selection:a,doc:s}=e,{$from:o,$to:l}=a,u=i.extensionManager.attributes,c=Z0(u,o.node().type.name,o.node().attrs);if(a instanceof It&&a.node.isBlock)return!o.parentOffset||!Hu(s,o.pos)?!1:(n&&(t&&l3(r,i.extensionManager.splittableMarks),e.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;const f=l.parentOffset===l.parent.content.size,g=o.depth===0?void 0:Pq(o.node(-1).contentMatchAt(o.indexAfter(-1)));let v=f&&g?[{type:g,attrs:c}]:void 0,x=Hu(e.doc,e.mapping.map(o.pos),1,v);if(!v&&!x&&Hu(e.doc,e.mapping.map(o.pos),1,g?[{type:g}]:void 0)&&(x=!0,v=g?[{type:g,attrs:c}]:void 0),n){if(x&&(a instanceof Yt&&e.deleteSelection(),e.split(e.mapping.map(o.pos),1,v),g&&!f&&!o.parentOffset&&o.parent.type!==g)){const _=e.mapping.map(o.before()),S=e.doc.resolve(_);o.node(-1).canReplaceWith(S.index(),S.index()+1,g)&&e.setNodeMarkup(e.mapping.map(o.before()),g)}t&&l3(r,i.extensionManager.splittableMarks),e.scrollIntoView()}return x},rW=(t,e={})=>({tr:r,state:n,dispatch:i,editor:a})=>{var s;const o=bi(t,n.schema),{$from:l,$to:u}=n.selection,c=n.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(u))return!1;const f=l.node(-1);if(f.type!==o)return!1;const g=a.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==o||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let N=Qe.empty;const k=l.index(-1)?1:l.index(-2)?2:3;for(let B=l.depth-k;B>=l.depth-3;B-=1)N=Qe.from(l.node(B).copy(N));const E=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,T={...Z0(g,l.node().type.name,l.node().attrs),...e},R=((s=o.contentMatch.defaultType)==null?void 0:s.createAndFill(T))||void 0;N=N.append(Qe.from(o.createAndFill(null,R)||void 0));const j=l.before(l.depth-(k-1));r.replace(j,l.after(-E),new wt(N,4-k,0));let D=-1;r.doc.nodesBetween(j,r.doc.content.size,(B,I)=>{if(D>-1)return!1;B.isTextblock&&B.content.size===0&&(D=I+1)}),D>-1&&r.setSelection(Yt.near(r.doc.resolve(D))),r.scrollIntoView()}return!0}const v=u.pos===l.end()?f.contentMatchAt(0).defaultType:null,x={...Z0(g,f.type.name,f.attrs),...e},_={...Z0(g,l.node().type.name,l.node().attrs),...e};r.delete(l.pos,u.pos);const S=v?[{type:o,attrs:x},{type:v,attrs:_}]:[{type:o,attrs:x}];if(!Hu(r.doc,l.pos,2))return!1;if(i){const{selection:N,storedMarks:k}=n,{splittableMarks:E}=a.extensionManager,T=k||N.$to.parentOffset&&N.$from.marks();if(r.split(l.pos,2,S).scrollIntoView(),!T||!i)return!0;const R=T.filter(j=>E.includes(j.type.name));r.ensureMarks(R)}return!0},Ww=(t,e)=>{const r=Hx(s=>s.type===e)(t.selection);if(!r)return!0;const n=t.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(n===void 0)return!0;const i=t.doc.nodeAt(n);return r.node.type===i?.type&&Rd(t.doc,r.pos)&&t.join(r.pos),!0},$w=(t,e)=>{const r=Hx(s=>s.type===e)(t.selection);if(!r)return!0;const n=t.doc.resolve(r.start).after(r.depth);if(n===void 0)return!0;const i=t.doc.nodeAt(n);return r.node.type===i?.type&&Rd(t.doc,n)&&t.join(n),!0},nW=(t,e,r,n={})=>({editor:i,tr:a,state:s,dispatch:o,chain:l,commands:u,can:c})=>{const{extensions:f,splittableMarks:g}=i.extensionManager,v=bi(t,s.schema),x=bi(e,s.schema),{selection:_,storedMarks:S}=s,{$from:N,$to:k}=_,E=N.blockRange(k),T=S||_.$to.parentOffset&&_.$from.marks();if(!E)return!1;const R=Hx(j=>o3(j.type.name,f))(_);if(E.depth>=1&&R&&E.depth-R.depth<=1){if(R.node.type===v)return u.liftListItem(x);if(o3(R.node.type.name,f)&&v.validContent(R.node.content)&&o)return l().command(()=>(a.setNodeMarkup(R.pos,v),!0)).command(()=>Ww(a,v)).command(()=>$w(a,v)).run()}return!r||!T||!o?l().command(()=>c().wrapInList(v,n)?!0:u.clearNodes()).wrapInList(v,n).command(()=>Ww(a,v)).command(()=>$w(a,v)).run():l().command(()=>{const j=c().wrapInList(v,n),D=T.filter(B=>g.includes(B.type.name));return a.ensureMarks(D),j?!0:u.clearNodes()}).wrapInList(v,n).command(()=>Ww(a,v)).command(()=>$w(a,v)).run()},iW=(t,e={},r={})=>({state:n,commands:i})=>{const{extendEmptyMarkRange:a=!1}=r,s=Qu(t,n.schema);return e_(n,s,e)?i.unsetMark(s,{extendEmptyMarkRange:a}):i.setMark(s,e)},aW=(t,e,r={})=>({state:n,commands:i})=>{const a=bi(t,n.schema),s=bi(e,n.schema),o=Cd(n,a,r);let l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),o?i.setNode(s,l):i.setNode(a,{...l,...r})},sW=(t,e={})=>({state:r,commands:n})=>{const i=bi(t,r.schema);return Cd(r,i,e)?n.lift(i):n.wrapIn(i,e)},oW=()=>({state:t,dispatch:e})=>{const r=t.plugins;for(let n=0;n<r.length;n+=1){const i=r[n];let a;if(i.spec.isInputRules&&(a=i.getState(t))){if(e){const s=t.tr,o=a.transform;for(let l=o.steps.length-1;l>=0;l-=1)s.step(o.steps[l].invert(o.docs[l]));if(a.text){const l=s.doc.resolve(a.from).marks();s.replaceWith(a.from,a.to,t.schema.text(a.text,l))}else s.delete(a.from,a.to)}return!0}}return!1},lW=()=>({tr:t,dispatch:e})=>{const{selection:r}=t,{empty:n,ranges:i}=r;return n||e&&i.forEach(a=>{t.removeMark(a.$from.pos,a.$to.pos)}),!0},uW=(t,e={})=>({tr:r,state:n,dispatch:i})=>{var a;const{extendEmptyMarkRange:s=!1}=e,{selection:o}=r,l=Qu(t,n.schema),{$from:u,empty:c,ranges:f}=o;if(!i)return!0;if(c&&s){let{from:g,to:v}=o;const x=(a=u.marks().find(S=>S.type===l))==null?void 0:a.attrs,_=kS(u,l,x);_&&(g=_.from,v=_.to),r.removeMark(g,v,l)}else f.forEach(g=>{r.removeMark(g.$from.pos,g.$to.pos,l)});return r.removeStoredMark(l),!0},cW=t=>({tr:e,state:r,dispatch:n})=>{const{selection:i}=r;let a,s;return typeof t=="number"?(a=t,s=t):t&&"from"in t&&"to"in t?(a=t.from,s=t.to):(a=i.from,s=i.to),n&&e.doc.nodesBetween(a,s,(o,l)=>{if(o.isText)return;const u={...o.attrs};delete u.dir,e.setNodeMarkup(l,void 0,u)}),!0},dW=(t,e={})=>({tr:r,state:n,dispatch:i})=>{let a=null,s=null;const o=Ux(typeof t=="string"?t:t.name,n.schema);if(!o)return!1;o==="node"&&(a=bi(t,n.schema)),o==="mark"&&(s=Qu(t,n.schema));let l=!1;return r.selection.ranges.forEach(u=>{const c=u.$from.pos,f=u.$to.pos;let g,v,x,_;r.selection.empty?n.doc.nodesBetween(c,f,(S,N)=>{a&&a===S.type&&(l=!0,x=Math.max(N,c),_=Math.min(N+S.nodeSize,f),g=N,v=S)}):n.doc.nodesBetween(c,f,(S,N)=>{N<c&&a&&a===S.type&&(l=!0,x=Math.max(N,c),_=Math.min(N+S.nodeSize,f),g=N,v=S),N>=c&&N<=f&&(a&&a===S.type&&(l=!0,i&&r.setNodeMarkup(N,void 0,{...S.attrs,...e})),s&&S.marks.length&&S.marks.forEach(k=>{if(s===k.type&&(l=!0,i)){const E=Math.max(N,c),T=Math.min(N+S.nodeSize,f);r.addMark(E,T,s.create({...k.attrs,...e}))}}))}),v&&(g!==void 0&&i&&r.setNodeMarkup(g,void 0,{...v.attrs,...e}),s&&v.marks.length&&v.marks.forEach(S=>{s===S.type&&i&&r.addMark(x,_,s.create({...S.attrs,...e}))}))}),l},hW=(t,e={})=>({state:r,dispatch:n})=>{const i=bi(t,r.schema);return FU(i,e)(r,n)},fW=(t,e={})=>({state:r,dispatch:n})=>{const i=bi(t,r.schema);return VU(i,e)(r,n)},pW=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const r=this.callbacks[t];return r&&r.forEach(n=>n.apply(this,e)),this}off(t,e){const r=this.callbacks[t];return r&&(e?this.callbacks[t]=r.filter(n=>n!==e):delete this.callbacks[t]),this}once(t,e){const r=(...n)=>{this.off(t,r),e.apply(this,n)};return this.on(t,r)}removeAllListeners(){this.callbacks={}}},qx=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},mW=(t,e)=>{if(SS(e))return e.exec(t);const r=e(t);if(!r)return null;const n=[r.text];return n.index=r.index,n.input=t,n.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(r.replaceWith)),n};function C0(t){var e;const{editor:r,from:n,to:i,text:a,rules:s,plugin:o}=t,{view:l}=r;if(l.composing)return!1;const u=l.state.doc.resolve(n);if(u.parent.type.spec.code||(e=u.nodeBefore||u.nodeAfter)!=null&&e.marks.find(g=>g.type.spec.code))return!1;let c=!1;const f=Vq(u)+a;return s.forEach(g=>{if(c)return;const v=mW(f,g.find);if(!v)return;const x=l.state.tr,_=Fx({state:l.state,transaction:x}),S={from:n-(v[0].length-a.length),to:i},{commands:N,chain:k,can:E}=new Vx({editor:r,state:_});g.handler({state:_,range:S,match:v,commands:N,chain:k,can:E})===null||!x.steps.length||(g.undoable&&x.setMeta(o,{transform:x,from:n,to:i,text:a}),l.dispatch(x),c=!0)}),c}function gW(t){const{editor:e,rules:r}=t,n=new Ln({state:{init(){return null},apply(i,a,s){const o=i.getMeta(n);if(o)return o;const l=i.getMeta("applyInputRules");return l&&setTimeout(()=>{let{text:c}=l;typeof c=="string"?c=c:c=ES(Qe.from(c),s.schema);const{from:f}=l,g=f+c.length;C0({editor:e,from:f,to:g,text:c,rules:r,plugin:n})}),i.selectionSet||i.docChanged?null:a}},props:{handleTextInput(i,a,s,o){return C0({editor:e,from:a,to:s,text:o,rules:r,plugin:n})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:a}=i.state.selection;a&&C0({editor:e,from:a.pos,to:a.pos,text:"",rules:r,plugin:n})}),!1)},handleKeyDown(i,a){if(a.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?C0({editor:e,from:s.pos,to:s.pos,text:`
`,rules:r,plugin:n}):!1}},isInputRules:!0});return n}function vW(t){return Object.prototype.toString.call(t).slice(8,-1)}function E0(t){return vW(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function CA(t,e){const r={...t};return E0(t)&&E0(e)&&Object.keys(e).forEach(n=>{E0(e[n])&&E0(t[n])?r[n]=CA(t[n],e[n]):r[n]=e[n]}),r}var TS=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...Hr(Lt(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Hr(Lt(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>CA(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},Xh=class EA extends TS{constructor(){super(...arguments),this.type="mark"}static create(e={}){const r=typeof e=="function"?e():e;return new EA(r)}static handleExit({editor:e,mark:r}){const{tr:n}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(u=>u?.type.name===r.name))return!1;const l=s.find(u=>u?.type.name===r.name);return l&&n.removeStoredMark(l),n.insertText(" ",i.pos),e.view.dispatch(n),!0}return!1}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}};function yW(t){return typeof t=="number"}var xW=class{constructor(t){this.find=t.find,this.handler=t.handler}},bW=(t,e,r)=>{if(SS(e))return[...t.matchAll(e)];const n=e(t,r);return n?n.map(i=>{const a=[i.text];return a.index=i.index,a.input=t,a.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(i.replaceWith)),a}):[]};function wW(t){const{editor:e,state:r,from:n,to:i,rule:a,pasteEvent:s,dropEvent:o}=t,{commands:l,chain:u,can:c}=new Vx({editor:e,state:r}),f=[];return r.doc.nodesBetween(n,i,(v,x)=>{var _,S,N,k,E;if((S=(_=v.type)==null?void 0:_.spec)!=null&&S.code||!(v.isText||v.isTextblock||v.isInline))return;const T=(E=(k=(N=v.content)==null?void 0:N.size)!=null?k:v.nodeSize)!=null?E:0,R=Math.max(n,x),j=Math.min(i,x+T);if(R>=j)return;const D=v.isText?v.text||"":v.textBetween(R-x,j-x,void 0,"");bW(D,a.find,s).forEach(I=>{if(I.index===void 0)return;const V=R+I.index+1,$=V+I[0].length,Z={from:r.tr.mapping.map(V),to:r.tr.mapping.map($)},O=a.handler({state:r,range:Z,match:I,commands:l,chain:u,can:c,pasteEvent:s,dropEvent:o});f.push(O)})}),f.every(v=>v!==null)}var N0=null,_W=t=>{var e;const r=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=r.clipboardData)==null||e.setData("text/html",t),r};function SW(t){const{editor:e,rules:r}=t;let n=null,i=!1,a=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o;try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}const l=({state:c,from:f,to:g,rule:v,pasteEvt:x})=>{const _=c.tr,S=Fx({state:c,transaction:_});if(!(!wW({editor:e,state:S,from:Math.max(f-1,0),to:g.b-1,rule:v,pasteEvent:x,dropEvent:o})||!_.steps.length)){try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,_}};return r.map(c=>new Ln({view(f){const g=x=>{var _;n=(_=f.dom.parentElement)!=null&&_.contains(x.target)?f.dom.parentElement:null,n&&(N0=e)},v=()=>{N0&&(N0=null)};return window.addEventListener("dragstart",g),window.addEventListener("dragend",v),{destroy(){window.removeEventListener("dragstart",g),window.removeEventListener("dragend",v)}}},props:{handleDOMEvents:{drop:(f,g)=>{if(a=n===f.dom.parentElement,o=g,!a){const v=N0;v?.isEditable&&setTimeout(()=>{const x=v.state.selection;x&&v.commands.deleteRange({from:x.from,to:x.to})},10)}return!1},paste:(f,g)=>{var v;const x=(v=g.clipboardData)==null?void 0:v.getData("text/html");return s=g,i=!!x?.includes("data-pm-slice"),!1}}},appendTransaction:(f,g,v)=>{const x=f[0],_=x.getMeta("uiEvent")==="paste"&&!i,S=x.getMeta("uiEvent")==="drop"&&!a,N=x.getMeta("applyPasteRules"),k=!!N;if(!_&&!S&&!k)return;if(k){let{text:R}=N;typeof R=="string"?R=R:R=ES(Qe.from(R),v.schema);const{from:j}=N,D=j+R.length,B=_W(R);return l({rule:c,state:v,from:j,to:{b:D},pasteEvt:B})}const E=g.doc.content.findDiffStart(v.doc.content),T=g.doc.content.findDiffEnd(v.doc.content);if(!(!yW(E)||!T||E===T.b))return l({rule:c,state:v,from:E,to:T,pasteEvt:s})}}))}var Wx=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=vA(t),this.schema=Lq(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:k0(e.name,this.schema)},n=Lt(e,"addCommands",r);return n?{...t,...n()}:t},{})}get plugins(){const{editor:t}=this;return Py([...this.extensions].reverse()).flatMap(n=>{const i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:k0(n.name,this.schema)},a=[],s=Lt(n,"addKeyboardShortcuts",i);let o={};if(n.type==="mark"&&Lt(n,"exitable",i)&&(o.ArrowRight=()=>Xh.handleExit({editor:t,mark:n})),s){const g=Object.fromEntries(Object.entries(s()).map(([v,x])=>[v,()=>x({editor:t})]));o={...o,...g}}const l=IG(o);a.push(l);const u=Lt(n,"addInputRules",i);if(s3(n,t.options.enableInputRules)&&u){const g=u();if(g&&g.length){const v=gW({editor:t,rules:g}),x=Array.isArray(v)?v:[v];a.push(...x)}}const c=Lt(n,"addPasteRules",i);if(s3(n,t.options.enablePasteRules)&&c){const g=c();if(g&&g.length){const v=SW({editor:t,rules:g});a.push(...v)}}const f=Lt(n,"addProseMirrorPlugins",i);if(f){const g=f();a.push(...g)}return a})}get attributes(){return gA(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=gp(this.extensions);return Object.fromEntries(e.filter(r=>!!Lt(r,"addNodeView")).map(r=>{const n=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:bi(r.name,this.schema)},a=Lt(r,"addNodeView",i);if(!a)return[];const s=a();if(!s)return[];const o=(l,u,c,f,g)=>{const v=Xg(l,n);return s({node:l,view:u,getPos:c,decorations:f,innerDecorations:g,editor:t,extension:r,HTMLAttributes:v})};return[r.name,o]}))}dispatchTransaction(t){const{editor:e}=this;return Py([...this.extensions].reverse()).reduceRight((n,i)=>{const a={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:e,type:k0(i.name,this.schema)},s=Lt(i,"dispatchTransaction",a);return s?o=>{s.call(a,{transaction:o,next:n})}:n},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=gp(this.extensions);return Object.fromEntries(e.filter(r=>!!Lt(r,"addMarkView")).map(r=>{const n=this.attributes.filter(o=>o.type===r.name),i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:Qu(r.name,this.schema)},a=Lt(r,"addMarkView",i);if(!a)return[];const s=(o,l,u)=>{const c=Xg(o,n);return a()({mark:o,view:l,inline:u,editor:t,extension:r,HTMLAttributes:c,updateAttributes:f=>{IW(o,t,f)}})};return[r.name,s]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var r;const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:k0(e.name,this.schema)};e.type==="mark"&&((r=Hr(Lt(e,"keepOnSplit",n)))==null||r)&&this.splittableMarks.push(e.name);const i=Lt(e,"onBeforeCreate",n),a=Lt(e,"onCreate",n),s=Lt(e,"onUpdate",n),o=Lt(e,"onSelectionUpdate",n),l=Lt(e,"onTransaction",n),u=Lt(e,"onFocus",n),c=Lt(e,"onBlur",n),f=Lt(e,"onDestroy",n);i&&this.editor.on("beforeCreate",i),a&&this.editor.on("create",a),s&&this.editor.on("update",s),o&&this.editor.on("selectionUpdate",o),l&&this.editor.on("transaction",l),u&&this.editor.on("focus",u),c&&this.editor.on("blur",c),f&&this.editor.on("destroy",f)})}};Wx.resolve=vA;Wx.sort=Py;Wx.flatten=CS;var kW={};_S(kW,{ClipboardTextSerializer:()=>TA,Commands:()=>PA,Delete:()=>MA,Drop:()=>AA,Editable:()=>jA,FocusEvents:()=>LA,Keymap:()=>OA,Paste:()=>DA,Tabindex:()=>IA,TextDirection:()=>BA,focusEventsPluginKey:()=>RA});var li=class NA extends TS{constructor(){super(...arguments),this.type="extension"}static create(e={}){const r=typeof e=="function"?e():e;return new NA(r)}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}},TA=li.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ln({key:new oi("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:r}=t,{doc:n,selection:i}=e,{ranges:a}=i,s=Math.min(...a.map(c=>c.$from.pos)),o=Math.max(...a.map(c=>c.$to.pos)),l=xA(r);return yA(n,{from:s,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),PA=li.create({name:"commands",addCommands(){return{...oA}}}),MA=li.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var r,n,i;const a=()=>{var s,o,l,u;if((u=(l=(o=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:o.filterTransaction)==null?void 0:l.call(o,t))!=null?u:t.getMeta("y-sync$"))return;const c=pA(t.before,[t,...e]);wA(c).forEach(v=>{c.mapping.mapResult(v.oldRange.from).deletedAfter&&c.mapping.mapResult(v.oldRange.to).deletedBefore&&c.before.nodesBetween(v.oldRange.from,v.oldRange.to,(x,_)=>{const S=_+x.nodeSize-2,N=v.oldRange.from<=_&&S<=v.oldRange.to;this.editor.emit("delete",{type:"node",node:x,from:_,to:S,newFrom:c.mapping.map(_),newTo:c.mapping.map(S),deletedRange:v.oldRange,newRange:v.newRange,partial:!N,editor:this.editor,transaction:t,combinedTransform:c})})});const g=c.mapping;c.steps.forEach((v,x)=>{var _,S;if(v instanceof ul){const N=g.slice(x).map(v.from,-1),k=g.slice(x).map(v.to),E=g.invert().map(N,-1),T=g.invert().map(k),R=(_=c.doc.nodeAt(N-1))==null?void 0:_.marks.some(D=>D.eq(v.mark)),j=(S=c.doc.nodeAt(k))==null?void 0:S.marks.some(D=>D.eq(v.mark));this.editor.emit("delete",{type:"mark",mark:v.mark,from:v.from,to:v.to,deletedRange:{from:E,to:T},newRange:{from:N,to:k},partial:!!(j||R),editor:this.editor,transaction:t,combinedTransform:c})}})};(i=(n=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:n.async)==null||i?setTimeout(a,0):a()}}),AA=li.create({name:"drop",addProseMirrorPlugins(){return[new Ln({key:new oi("tiptapDrop"),props:{handleDrop:(t,e,r,n)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:r,moved:n})}}})]}}),jA=li.create({name:"editable",addProseMirrorPlugins(){return[new Ln({key:new oi("editable"),props:{editable:()=>this.editor.options.editable}})]}}),RA=new oi("focusEvents"),LA=li.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Ln({key:RA,props:{handleDOMEvents:{focus:(e,r)=>{t.isFocused=!0;const n=t.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,r)=>{t.isFocused=!1;const n=t.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}}),OA=li.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:o})=>{const{selection:l,doc:u}=o,{empty:c,$anchor:f}=l,{pos:g,parent:v}=f,x=f.parent.isTextblock&&g>0?o.doc.resolve(g-1):f,_=x.parent.type.spec.isolating,S=f.pos-f.parentOffset,N=_&&x.parent.childCount===1?S===f.pos:ar.atStart(u).from===g;return!c||!v.type.isTextblock||v.textContent.length||!N||N&&f.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},a={...n,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Ty()||hA()?a:i},addProseMirrorPlugins(){return[new Ln({key:new oi("clearDocument"),appendTransaction:(t,e,r)=>{if(t.some(_=>_.getMeta("composition")))return;const n=t.some(_=>_.docChanged)&&!e.doc.eq(r.doc),i=t.some(_=>_.getMeta("preventClearDocument"));if(!n||i)return;const{empty:a,from:s,to:o}=e.selection,l=ar.atStart(e.doc).from,u=ar.atEnd(e.doc).to;if(a||!(s===l&&o===u)||!Gx(r.doc))return;const g=r.tr,v=Fx({state:r,transaction:g}),{commands:x}=new Vx({editor:this.editor,state:v});if(x.clearNodes(),!!g.steps.length)return g}})]}}),DA=li.create({name:"paste",addProseMirrorPlugins(){return[new Ln({key:new oi("tiptapPaste"),props:{handlePaste:(t,e,r)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:r})}}})]}}),IA=li.create({name:"tabindex",addProseMirrorPlugins(){return[new Ln({key:new oi("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),BA=li.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=gp(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const r=e.getAttribute("dir");return r&&(r==="ltr"||r==="rtl"||r==="auto")?r:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new Ln({key:new oi("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),CW=class Kf{constructor(e,r,n=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=r,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let r=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}r=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:r,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),r=this.resolvedPos.doc.resolve(e);return new Kf(r,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Kf(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Kf(e,this.editor)}get children(){const e=[];return this.node.content.forEach((r,n)=>{const i=r.isBlock&&!r.isTextblock,a=r.isAtom&&!r.isText,s=this.pos+n+(a?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const o=this.resolvedPos.doc.resolve(s);if(!i&&o.depth<=this.depth)return;const l=new Kf(o,this.editor,i,i?r:null);i&&(l.actualDepth=this.depth+1),e.push(new Kf(o,this.editor,i,i?r:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,r={}){let n=null,i=this.parent;for(;i&&!n;){if(i.node.type.name===e)if(Object.keys(r).length>0){const a=i.node.attrs,s=Object.keys(r);for(let o=0;o<s.length;o+=1){const l=s[o];if(a[l]!==r[l])break}}else n=i;i=i.parent}return n}querySelector(e,r={}){return this.querySelectorAll(e,r,!0)[0]||null}querySelectorAll(e,r={},n=!1){let i=[];if(!this.children||this.children.length===0)return i;const a=Object.keys(r);return this.children.forEach(s=>{n&&i.length>0||(s.node.type.name===e&&a.every(l=>r[l]===s.node.attrs[l])&&i.push(s),!(n&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,r,n))))}),i}setAttribute(e){const{tr:r}=this.editor.state;r.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(r)}},EW=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function NW(t,e,r){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}var TW=class extends pW{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:qq,createMappablePosition:Wq},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:i,moved:a})=>this.options.onDrop(n,i,a)),this.on("paste",({event:n,slice:i})=>this.options.onPaste(n,i)),this.on("delete",this.options.onDelete);const e=this.createDoc(),r=cA(e,this.options.autofocus);this.editorState=ep.create({doc:e,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t?.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=NW(EW,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const r=mA(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let r=e;if([].concat(t).forEach(i=>{const a=typeof i=="string"?`${i}$`:i.key;r=r.filter(s=>!s.key.startsWith(a))}),e.length===r.length)return;const n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}createExtensionManager(){var t,e;const n=[...this.options.enableCoreExtensions?[jA,TA.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),PA,LA,OA,IA,AA,DA,MA,BA.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i?.type));this.extensionManager=new Wx(n,this)}createCommandManager(){this.commandManager=new Vx({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=J2(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),t=J2(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:r}=this.options,n=e.dispatchTransaction||this.dispatchTransaction.bind(this),i=r?this.extensionManager.dispatchTransaction(n):n;this.editorView=new aA(t,{...e,attributes:{role:"textbox",...e?.attributes},dispatchTransaction:i,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const a=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(a),this.prependClass(),this.injectCSS();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(u=>{var c;return(c=this.capturedTransaction)==null?void 0:c.step(u)});return}const{state:e,transactions:r}=this.state.applyTransaction(t),n=!this.state.selection.eq(e.selection),i=r.includes(t),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:r.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=r.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),o=s?.getMeta("focus"),l=s?.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),!(t.getMeta("preventUpdate")||!r.some(u=>u.docChanged)||a.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:r.slice(1)})}getAttributes(t){return bA(this.state,t)}isActive(t,e){const r=typeof t=="string"?t:null,n=typeof t=="string"?e:t;return Uq(this.state,r,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return ES(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:r={}}=t||{};return Dq(this.state.doc,{blockSeparator:e,textSerializers:{...xA(this.schema),...r}})}get isEmpty(){return Gx(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var r;return((r=this.$doc)==null?void 0:r.querySelector(t,e))||null}$nodes(t,e){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new CW(e,this)}get $doc(){return this.$pos(0)}};function vp(t){return new qx({find:t.find,handler:({state:e,range:r,match:n})=>{const i=Hr(t.getAttributes,void 0,n);if(i===!1||i===null)return null;const{tr:a}=e,s=n[n.length-1],o=n[0];if(s){const l=o.search(/\S/),u=r.from+o.indexOf(s),c=u+s.length;if(NS(r.from,r.to,e.doc).filter(v=>v.mark.type.excluded.find(_=>_===t.type&&_!==v.mark.type)).filter(v=>v.to>u).length)return null;c<r.to&&a.delete(c,r.to),u>r.from&&a.delete(r.from+l,u);const g=r.from+l+s.length;a.addMark(r.from+l,g,t.type.create(i||{})),a.removeStoredMark(t.type)}},undoable:t.undoable})}function PW(t){return new qx({find:t.find,handler:({state:e,range:r,match:n})=>{const i=Hr(t.getAttributes,void 0,n)||{},{tr:a}=e,s=r.from;let o=r.to;const l=t.type.create(i);if(n[1]){const u=n[0].lastIndexOf(n[1]);let c=s+u;c>o?c=o:o=c+n[1].length;const f=n[0][n[0].length-1];a.insertText(f,s+n[0].length-1),a.replaceWith(c,o,l)}else if(n[0]){const u=t.type.isInline?s:s-1;a.insert(u,t.type.create(i)).delete(a.mapping.map(s),a.mapping.map(o))}a.scrollIntoView()},undoable:t.undoable})}function t_(t){return new qx({find:t.find,handler:({state:e,range:r,match:n})=>{const i=e.doc.resolve(r.from),a=Hr(t.getAttributes,void 0,n)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(r.from,r.to).setBlockType(r.from,r.from,t.type,a)},undoable:t.undoable})}function yp(t){return new qx({find:t.find,handler:({state:e,range:r,match:n,chain:i})=>{const a=Hr(t.getAttributes,void 0,n)||{},s=e.tr.delete(r.from,r.to),l=s.doc.resolve(r.from).blockRange(),u=l&&sS(l,t.type,a);if(!u)return null;if(s.wrap(l,u),t.keepMarks&&t.editor){const{selection:f,storedMarks:g}=e,{splittableMarks:v}=t.editor.extensionManager,x=g||f.$to.parentOffset&&f.$from.marks();if(x){const _=x.filter(S=>v.includes(S.type.name));s.ensureMarks(_)}}if(t.keepAttributes){const f=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,a).run()}const c=s.doc.resolve(r.from-1).nodeBefore;c&&c.type===t.type&&Rd(s.doc,r.from-1)&&(!t.joinPredicate||t.joinPredicate(n,c))&&s.join(r.from-1)},undoable:t.undoable})}function MW(t,e){const{selection:r}=t,{$from:n}=r;if(r instanceof It){const a=n.index();return n.parent.canReplaceWith(a,a+1,e)}let i=n.depth;for(;i>=0;){const a=n.index(i);if(n.node(i).contentMatchAt(a).matchType(e))return!0;i-=1}return!1}function AW(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var jW={};_S(jW,{createAtomBlockMarkdownSpec:()=>RW,createBlockMarkdownSpec:()=>LW,createInlineMarkdownSpec:()=>zA,parseAttributes:()=>PS,parseIndentedBlocks:()=>r_,renderNestedMarkdownContent:()=>AS,serializeAttributes:()=>MS});function PS(t){if(!t?.trim())return{};const e={},r=[],n=t.replace(/["']([^"']*)["']/g,u=>(r.push(u),`__QUOTED_${r.length-1}__`)),i=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const u=i.map(c=>c.trim().slice(1));e.class=u.join(" ")}const a=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);a&&(e.id=a[1]);const s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(s)).forEach(([,u,c])=>{var f;const g=parseInt(((f=c.match(/__QUOTED_(\d+)__/))==null?void 0:f[1])||"0",10),v=r[g];v&&(e[u]=v.slice(1,-1))});const l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(c=>{c.match(/^[a-zA-Z][\w-]*$/)&&(e[c]=!0)}),e}function MS(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(n=>e.push(`.${n}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([r,n])=>{r==="class"||r==="id"||(n===!0?e.push(r):n!==!1&&n!=null&&e.push(`${r}="${String(n)}"`))}),e.join(" ")}function RW(t){const{nodeName:e,name:r,parseAttributes:n=PS,serializeAttributes:i=MS,defaultAttributes:a={},requiredAttributes:s=[],allowedAttributes:o}=t,l=r||e,u=c=>{if(!o)return c;const f={};return o.forEach(g=>{g in c&&(f[g]=c[g])}),f};return{parseMarkdown:(c,f)=>{const g={...a,...c.attributes};return f.createNode(e,g,[])},markdownTokenizer:{name:e,level:"block",start(c){var f;const g=new RegExp(`^:::${l}(?:\\s|$)`,"m"),v=(f=c.match(g))==null?void 0:f.index;return v!==void 0?v:-1},tokenize(c,f,g){const v=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),x=c.match(v);if(!x)return;const _=x[1]||"",S=n(_);if(!s.find(k=>!(k in S)))return{type:e,raw:x[0],attributes:S}}},renderMarkdown:c=>{const f=u(c.attrs||{}),g=i(f),v=g?` {${g}}`:"";return`:::${l}${v} :::`}}}function LW(t){const{nodeName:e,name:r,getContent:n,parseAttributes:i=PS,serializeAttributes:a=MS,defaultAttributes:s={},content:o="block",allowedAttributes:l}=t,u=r||e,c=f=>{if(!l)return f;const g={};return l.forEach(v=>{v in f&&(g[v]=f[v])}),g};return{parseMarkdown:(f,g)=>{let v;if(n){const _=n(f);v=typeof _=="string"?[{type:"text",text:_}]:_}else o==="block"?v=g.parseChildren(f.tokens||[]):v=g.parseInline(f.tokens||[]);const x={...s,...f.attributes};return g.createNode(e,x,v)},markdownTokenizer:{name:e,level:"block",start(f){var g;const v=new RegExp(`^:::${u}`,"m"),x=(g=f.match(v))==null?void 0:g.index;return x!==void 0?x:-1},tokenize(f,g,v){var x;const _=new RegExp(`^:::${u}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),S=f.match(_);if(!S)return;const[N,k=""]=S,E=i(k);let T=1;const R=N.length;let j="";const D=/^:::([\w-]*)(\s.*)?/gm,B=f.slice(R);for(D.lastIndex=0;;){const I=D.exec(B);if(I===null)break;const V=I.index,$=I[1];if(!((x=I[2])!=null&&x.endsWith(":::"))){if($)T+=1;else if(T-=1,T===0){const Z=B.slice(0,V);j=Z.trim();const O=f.slice(0,R+V+I[0].length);let W=[];if(j)if(o==="block")for(W=v.blockTokens(Z),W.forEach(F=>{F.text&&(!F.tokens||F.tokens.length===0)&&(F.tokens=v.inlineTokens(F.text))});W.length>0;){const F=W[W.length-1];if(F.type==="paragraph"&&(!F.text||F.text.trim()===""))W.pop();else break}else W=v.inlineTokens(j);return{type:e,raw:O,attributes:E,content:j,tokens:W}}}}}},renderMarkdown:(f,g)=>{const v=c(f.attrs||{}),x=a(v),_=x?` {${x}}`:"",S=g.renderChildren(f.content||[],`

`);return`:::${u}${_}

${S}

:::`}}}function OW(t){if(!t.trim())return{};const e={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(t);for(;n!==null;){const[,i,a,s]=n;e[i]=a||s,n=r.exec(t)}return e}function DW(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e}="${r}"`).join(" ")}function zA(t){const{nodeName:e,name:r,getContent:n,parseAttributes:i=OW,serializeAttributes:a=DW,defaultAttributes:s={},selfClosing:o=!1,allowedAttributes:l}=t,u=r||e,c=g=>{if(!l)return g;const v={};return l.forEach(x=>{const _=typeof x=="string"?x:x.name,S=typeof x=="string"?void 0:x.skipIfDefault;if(_ in g){const N=g[_];if(S!==void 0&&N===S)return;v[_]=N}}),v},f=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(g,v)=>{const x={...s,...g.attributes};if(o)return v.createNode(e,x);const _=n?n(g):g.content||"";return _?v.createNode(e,x,[v.createTextNode(_)]):v.createNode(e,x,[])},markdownTokenizer:{name:e,level:"inline",start(g){const v=o?new RegExp(`\\[${f}\\s*[^\\]]*\\]`):new RegExp(`\\[${f}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${f}\\]`),x=g.match(v),_=x?.index;return _!==void 0?_:-1},tokenize(g,v,x){const _=o?new RegExp(`^\\[${f}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${f}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${f}\\]`),S=g.match(_);if(!S)return;let N="",k="";if(o){const[,T]=S;k=T}else{const[,T,R]=S;k=T,N=R||""}const E=i(k.trim());return{type:e,raw:S[0],content:N.trim(),attributes:E}}},renderMarkdown:g=>{let v="";n?v=n(g):g.content&&g.content.length>0&&(v=g.content.filter(N=>N.type==="text").map(N=>N.text).join(""));const x=c(g.attrs||{}),_=a(x),S=_?` ${_}`:"";return o?`[${u}${S}]`:`[${u}${S}]${v}[/${u}]`}}}function r_(t,e,r){var n,i,a,s;const o=t.split(`
`),l=[];let u="",c=0;const f=e.baseIndentSize||2;for(;c<o.length;){const g=o[c],v=g.match(e.itemPattern);if(!v){if(l.length>0)break;if(g.trim()===""){c+=1,u=`${u}${g}
`;continue}else return}const x=e.extractItemData(v),{indentLevel:_,mainContent:S}=x;u=`${u}${g}
`;const N=[S];for(c+=1;c<o.length;){const R=o[c];if(R.trim()===""){const D=o.slice(c+1).findIndex(V=>V.trim()!=="");if(D===-1)break;if((((i=(n=o[c+1+D].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:i.length)||0)>_){N.push(R),u=`${u}${R}
`,c+=1;continue}else break}if((((s=(a=R.match(/^(\s*)/))==null?void 0:a[1])==null?void 0:s.length)||0)>_)N.push(R),u=`${u}${R}
`,c+=1;else break}let k;const E=N.slice(1);if(E.length>0){const R=E.map(j=>j.slice(_+f)).join(`
`);R.trim()&&(e.customNestedParser?k=e.customNestedParser(R):k=r.blockTokens(R))}const T=e.createToken(x,k);l.push(T)}if(l.length!==0)return{items:l,raw:u}}function AS(t,e,r,n){if(!t||!Array.isArray(t.content))return"";const i=typeof r=="function"?r(n):r,[a,...s]=t.content,o=e.renderChildren([a]),l=[`${i}${o}`];return s&&s.length>0&&s.forEach(u=>{const c=e.renderChildren([u]);if(c){const f=c.split(`
`).map(g=>g?e.indent(g):"").join(`
`);l.push(f)}}),l.join(`
`)}function IW(t,e,r={}){const{state:n}=e,{doc:i,tr:a}=n,s=t;i.descendants((o,l)=>{const u=a.mapping.map(l),c=a.mapping.map(l)+o.nodeSize;let f=null;if(o.marks.forEach(v=>{if(v!==s)return!1;f=v}),!f)return;let g=!1;if(Object.keys(r).forEach(v=>{r[v]!==f.attrs[v]&&(g=!0)}),g){const v=t.type.create({...t.attrs,...r});a.removeMark(u,c,t.type),a.addMark(u,c,v)}}),a.docChanged&&e.view.dispatch(a)}var Os=class FA extends TS{constructor(){super(...arguments),this.type="node"}static create(e={}){const r=typeof e=="function"?e():e;return new FA(r)}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}};function Gh(t){return new xW({find:t.find,handler:({state:e,range:r,match:n,pasteEvent:i})=>{const a=Hr(t.getAttributes,void 0,n,i);if(a===!1||a===null)return null;const{tr:s}=e,o=n[n.length-1],l=n[0];let u=r.to;if(o){const c=l.search(/\S/),f=r.from+l.indexOf(o),g=f+o.length;if(NS(r.from,r.to,e.doc).filter(x=>x.mark.type.excluded.find(S=>S===t.type&&S!==x.mark.type)).filter(x=>x.to>f).length)return null;g<r.to&&s.delete(g,r.to),f>r.from&&s.delete(r.from+c,f),u=r.from+c+o.length,s.addMark(r.from+c,u,t.type.create(a||{})),s.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:BW,getOwnPropertySymbols:zW}=Object,{hasOwnProperty:FW}=Object.prototype;function Kw(t,e){return function(n,i,a){return t(n,i,a)&&e(n,i,a)}}function T0(t){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return t(r,n,i);const{cache:a}=i,s=a.get(r),o=a.get(n);if(s&&o)return s===n&&o===r;a.set(r,n),a.set(n,r);const l=t(r,n,i);return a.delete(r),a.delete(n),l}}function VW(t){return t?.[Symbol.toStringTag]}function u3(t){return BW(t).concat(zW(t))}const UW=Object.hasOwn||((t,e)=>FW.call(t,e));function Qh(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const HW="__v",GW="__o",qW="_owner",{getOwnPropertyDescriptor:c3,keys:d3}=Object;function WW(t,e){return t.byteLength===e.byteLength&&My(new Uint8Array(t),new Uint8Array(e))}function $W(t,e,r){let n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!r.equals(t[n],e[n],n,n,t,e,r))return!1;return!0}function KW(t,e){return t.byteLength===e.byteLength&&My(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function ZW(t,e){return Qh(t.getTime(),e.getTime())}function YW(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function XW(t,e){return t===e}function h3(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const i=new Array(n),a=t.entries();let s,o,l=0;for(;(s=a.next())&&!s.done;){const u=e.entries();let c=!1,f=0;for(;(o=u.next())&&!o.done;){if(i[f]){f++;continue}const g=s.value,v=o.value;if(r.equals(g[0],v[0],l,f,t,e,r)&&r.equals(g[1],v[1],g[0],v[0],t,e,r)){c=i[f]=!0;break}f++}if(!c)return!1;l++}return!0}const QW=Qh;function JW(t,e,r){const n=d3(t);let i=n.length;if(d3(e).length!==i)return!1;for(;i-- >0;)if(!VA(t,e,r,n[i]))return!1;return!0}function tg(t,e,r){const n=u3(t);let i=n.length;if(u3(e).length!==i)return!1;let a,s,o;for(;i-- >0;)if(a=n[i],!VA(t,e,r,a)||(s=c3(t,a),o=c3(e,a),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function e$(t,e){return Qh(t.valueOf(),e.valueOf())}function t$(t,e){return t.source===e.source&&t.flags===e.flags}function f3(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const i=new Array(n),a=t.values();let s,o;for(;(s=a.next())&&!s.done;){const l=e.values();let u=!1,c=0;for(;(o=l.next())&&!o.done;){if(!i[c]&&r.equals(s.value,o.value,s.value,o.value,t,e,r)){u=i[c]=!0;break}c++}if(!u)return!1}return!0}function My(t,e){let r=t.byteLength;if(e.byteLength!==r||t.byteOffset!==e.byteOffset)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}function r$(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function VA(t,e,r,n){return(n===qW||n===GW||n===HW)&&(t.$$typeof||e.$$typeof)?!0:UW(e,n)&&r.equals(t[n],e[n],n,n,t,e,r)}const n$="[object ArrayBuffer]",i$="[object Arguments]",a$="[object Boolean]",s$="[object DataView]",o$="[object Date]",l$="[object Error]",u$="[object Map]",c$="[object Number]",d$="[object Object]",h$="[object RegExp]",f$="[object Set]",p$="[object String]",m$={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},g$="[object URL]",v$=Object.prototype.toString;function y$({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:i,areFunctionsEqual:a,areMapsEqual:s,areNumbersEqual:o,areObjectsEqual:l,arePrimitiveWrappersEqual:u,areRegExpsEqual:c,areSetsEqual:f,areTypedArraysEqual:g,areUrlsEqual:v,unknownTagComparators:x}){return function(S,N,k){if(S===N)return!0;if(S==null||N==null)return!1;const E=typeof S;if(E!==typeof N)return!1;if(E!=="object")return E==="number"?o(S,N,k):E==="function"?a(S,N,k):!1;const T=S.constructor;if(T!==N.constructor)return!1;if(T===Object)return l(S,N,k);if(Array.isArray(S))return e(S,N,k);if(T===Date)return n(S,N,k);if(T===RegExp)return c(S,N,k);if(T===Map)return s(S,N,k);if(T===Set)return f(S,N,k);const R=v$.call(S);if(R===o$)return n(S,N,k);if(R===h$)return c(S,N,k);if(R===u$)return s(S,N,k);if(R===f$)return f(S,N,k);if(R===d$)return typeof S.then!="function"&&typeof N.then!="function"&&l(S,N,k);if(R===g$)return v(S,N,k);if(R===l$)return i(S,N,k);if(R===i$)return l(S,N,k);if(m$[R])return g(S,N,k);if(R===n$)return t(S,N,k);if(R===s$)return r(S,N,k);if(R===a$||R===c$||R===p$)return u(S,N,k);if(x){let j=x[R];if(!j){const D=VW(S);D&&(j=x[D])}if(j)return j(S,N,k)}return!1}}function x$({circular:t,createCustomConfig:e,strict:r}){let n={areArrayBuffersEqual:WW,areArraysEqual:r?tg:$W,areDataViewsEqual:KW,areDatesEqual:ZW,areErrorsEqual:YW,areFunctionsEqual:XW,areMapsEqual:r?Kw(h3,tg):h3,areNumbersEqual:QW,areObjectsEqual:r?tg:JW,arePrimitiveWrappersEqual:e$,areRegExpsEqual:t$,areSetsEqual:r?Kw(f3,tg):f3,areTypedArraysEqual:r?Kw(My,tg):My,areUrlsEqual:r$,unknownTagComparators:void 0};if(e&&(n=Object.assign({},n,e(n))),t){const i=T0(n.areArraysEqual),a=T0(n.areMapsEqual),s=T0(n.areObjectsEqual),o=T0(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:i,areMapsEqual:a,areObjectsEqual:s,areSetsEqual:o})}return n}function b$(t){return function(e,r,n,i,a,s,o){return t(e,r,o)}}function w$({circular:t,comparator:e,createState:r,equals:n,strict:i}){if(r)return function(o,l){const{cache:u=t?new WeakMap:void 0,meta:c}=r();return e(o,l,{cache:u,equals:n,meta:c,strict:i})};if(t)return function(o,l){return e(o,l,{cache:new WeakMap,equals:n,meta:void 0,strict:i})};const a={cache:void 0,equals:n,meta:void 0,strict:i};return function(o,l){return e(o,l,a)}}const _$=Od();Od({strict:!0});Od({circular:!0});Od({circular:!0,strict:!0});Od({createInternalComparator:()=>Qh});Od({strict:!0,createInternalComparator:()=>Qh});Od({circular:!0,createInternalComparator:()=>Qh});Od({circular:!0,createInternalComparator:()=>Qh,strict:!0});function Od(t={}){const{circular:e=!1,createInternalComparator:r,createState:n,strict:i=!1}=t,a=x$(t),s=y$(a),o=r?r(s):b$(s);return w$({circular:e,comparator:s,createState:n,equals:o,strict:i})}var Zw={exports:{}},Yw={};var p3;function S$(){if(p3)return Yw;p3=1;var t=Sp(),e=AM();function r(u,c){return u===c&&(u!==0||1/u===1/c)||u!==u&&c!==c}var n=typeof Object.is=="function"?Object.is:r,i=e.useSyncExternalStore,a=t.useRef,s=t.useEffect,o=t.useMemo,l=t.useDebugValue;return Yw.useSyncExternalStoreWithSelector=function(u,c,f,g,v){var x=a(null);if(x.current===null){var _={hasValue:!1,value:null};x.current=_}else _=x.current;x=o(function(){function N(j){if(!k){if(k=!0,E=j,j=g(j),v!==void 0&&_.hasValue){var D=_.value;if(v(D,j))return T=D}return T=j}if(D=T,n(E,j))return D;var B=g(j);return v!==void 0&&v(D,B)?(E=j,D):(E=j,T=B)}var k=!1,E,T,R=f===void 0?null:f;return[function(){return N(c())},R===null?void 0:function(){return N(R())}]},[c,f,g,v]);var S=i(u,x[0],x[1]);return s(function(){_.hasValue=!0,_.value=S},[S]),l(S),S},Yw}var m3;function k$(){return m3||(m3=1,Zw.exports=S$()),Zw.exports}var C$=k$(),E$=(...t)=>e=>{t.forEach(r=>{typeof r=="function"?r(e):r&&(r.current=e)})},N$=({contentComponent:t})=>{const e=jM.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return p.jsx(p.Fragment,{children:Object.values(e)})};function T$(){const t=new Set;let e={};return{subscribe(r){return t.add(r),()=>{t.delete(r)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(r,n){e={...e,[r]:dR.createPortal(n.reactElement,n.element,r)},t.forEach(i=>i())},removeRenderer(r){const n={...e};delete n[r],e=n,t.forEach(i=>i())}}}var P$=class extends er.Component{constructor(t){var e;super(t),this.editorContentRef=er.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const r=this.editorContentRef.current;r.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:r}),e.contentComponent=T$(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const r=document.createElement("div");r.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:r})}catch{}}}render(){const{editor:t,innerRef:e,...r}=this.props;return p.jsxs(p.Fragment,{children:[p.jsx("div",{ref:E$(e,this.editorContentRef),...r}),t?.contentComponent&&p.jsx(N$,{contentComponent:t.contentComponent})]})}},M$=ce.forwardRef((t,e)=>{const r=er.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return er.createElement(P$,{key:r,innerRef:e,...t})}),A$=er.memo(M$),j$=typeof window<"u"?ce.useLayoutEffect:ce.useEffect,R$=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(n=>n())},r=this.editor;return r.on("transaction",e),()=>{r.off("transaction",e)}}}};function L$(t){var e;const[r]=ce.useState(()=>new R$(t.editor)),n=C$.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:_$);return j$(()=>r.watch(t.editor),[t.editor,r]),ce.useDebugValue(n),n}var O$=!1,n_=typeof window>"u",D$=n_||!!(typeof window<"u"&&window.next),I$=class UA{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(r=>r())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?n_||D$?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...n)=>{var i,a;return(a=(i=this.options.current).onBeforeCreate)==null?void 0:a.call(i,...n)},onBlur:(...n)=>{var i,a;return(a=(i=this.options.current).onBlur)==null?void 0:a.call(i,...n)},onCreate:(...n)=>{var i,a;return(a=(i=this.options.current).onCreate)==null?void 0:a.call(i,...n)},onDestroy:(...n)=>{var i,a;return(a=(i=this.options.current).onDestroy)==null?void 0:a.call(i,...n)},onFocus:(...n)=>{var i,a;return(a=(i=this.options.current).onFocus)==null?void 0:a.call(i,...n)},onSelectionUpdate:(...n)=>{var i,a;return(a=(i=this.options.current).onSelectionUpdate)==null?void 0:a.call(i,...n)},onTransaction:(...n)=>{var i,a;return(a=(i=this.options.current).onTransaction)==null?void 0:a.call(i,...n)},onUpdate:(...n)=>{var i,a;return(a=(i=this.options.current).onUpdate)==null?void 0:a.call(i,...n)},onContentError:(...n)=>{var i,a;return(a=(i=this.options.current).onContentError)==null?void 0:a.call(i,...n)},onDrop:(...n)=>{var i,a;return(a=(i=this.options.current).onDrop)==null?void 0:a.call(i,...n)},onPaste:(...n)=>{var i,a;return(a=(i=this.options.current).onPaste)==null?void 0:a.call(i,...n)},onDelete:(...n)=>{var i,a;return(a=(i=this.options.current).onDelete)==null?void 0:a.call(i,...n)}};return new TW(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,r){return Object.keys(e).every(n=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)?!0:n==="extensions"&&e.extensions&&r.extensions?e.extensions.length!==r.extensions.length?!1:e.extensions.every((i,a)=>{var s;return i===((s=r.extensions)==null?void 0:s[a])}):e[n]===r[n])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?UA.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((n,i)=>n===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,r=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){r&&r.setOptions(this.options.current);return}r&&!r.isDestroyed&&(r.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function B$(t={},e=[]){const r=ce.useRef(t);r.current=t;const[n]=ce.useState(()=>new I$(r)),i=jM.useSyncExternalStore(n.subscribe,n.getEditor,n.getServerSnapshot);return ce.useDebugValue(i),ce.useEffect(n.onRender(e)),L$({editor:i,selector:({transactionNumber:a})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&a===0?0:a+1}),i}var z$=ce.createContext({editor:null});z$.Consumer;var F$=ce.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),V$=()=>ce.useContext(F$);er.forwardRef((t,e)=>{const{onDragStart:r}=V$(),n=t.as||"div";return p.jsx(n,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...t.style}})});function g3(t){return!!(typeof t=="function"&&t.prototype&&t.prototype.isReactComponent)}function v3(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.forward_ref)"||t.$$typeof.description==="react.forward_ref"))}function U$(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.memo)"||t.$$typeof.description==="react.memo"))}function H$(t){if(g3(t)||v3(t))return!0;if(U$(t)){const e=t.type;if(e)return g3(e)||v3(e)}return!1}function G$(){try{if(ce.version)return parseInt(ce.version.split(".")[0],10)>=19}catch{}return!1}var q$=class{constructor(t,{editor:e,props:r={},as:n="div",className:i=""}){this.ref=null,this.destroyed=!1,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=t,this.editor=e,this.props=r,this.element=document.createElement(n),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?nu.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.destroyed||this.render()})}render(){var t;if(this.destroyed)return;const e=this.component,r=this.props,n=this.editor,i=G$(),a=H$(e),s={...r};s.ref&&!(i||a)&&delete s.ref,!s.ref&&(i||a)&&(s.ref=o=>{this.ref=o}),this.reactElement=p.jsx(e,{...s}),(t=n?.contentComponent)==null||t.setRenderer(this.id,this)}updateProps(t={}){this.destroyed||(this.props={...this.props,...t},this.render())}destroy(){var t;this.destroyed=!0;const e=this.editor;(t=e?.contentComponent)==null||t.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(t){Object.keys(t).forEach(e=>{this.element.setAttribute(e,t[e])})}};er.createContext({markViewContentRef:()=>{}});var Ay=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:r,...n}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,n,r]},W$=/^\s*>\s$/,$$=Os.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return Ay("blockquote",{...Rn(this.options.HTMLAttributes,t),children:Ay("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const r=">",n=[];return t.content.forEach(i=>{const o=e.renderChildren([i]).split(`
`).map(l=>l.trim()===""?r:`${r} ${l}`);n.push(o.join(`
`))}),n.join(`
${r}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[yp({find:W$,type:this.type})]}}),K$=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Z$=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Y$=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,X$=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Q$=Xh.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return Ay("strong",{...Rn(this.options.HTMLAttributes,t),children:Ay("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[vp({find:K$,type:this.type}),vp({find:Y$,type:this.type})]},addPasteRules(){return[Gh({find:Z$,type:this.type}),Gh({find:X$,type:this.type})]}}),J$=/(^|[^`])`([^`]+)`(?!`)$/,eK=/(^|[^`])`([^`]+)`(?!`)/g,tK=Xh.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",Rn(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[vp({find:J$,type:this.type})]},addPasteRules(){return[Gh({find:eK,type:this.type})]}}),Xw=4,rK=/^```([a-z]+)?[\s\n]$/,nK=/^~~~([a-z]+)?[\s\n]$/,iK=Os.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Xw,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:r}=this.options;if(!r)return null;const a=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(s=>s.startsWith(r)).map(s=>s.replace(r,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",Rn(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var r;return((r=t.raw)==null?void 0:r.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var r;let n="";const i=((r=t.attrs)==null?void 0:r.language)||"";return t.content?n=[`\`\`\`${i}`,e.renderChildren(t.content),"```"].join(`
`):n=`\`\`\`${i}

\`\`\``,n},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,r=e.pos===1;return!t||e.parent.type.name!==this.name?!1:r||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const r=(e=this.options.tabSize)!=null?e:Xw,{state:n}=t,{selection:i}=n,{$from:a,empty:s}=i;if(a.parent.type!==this.type)return!1;const o=" ".repeat(r);return s?t.commands.insertContent(o):t.commands.command(({tr:l})=>{const{from:u,to:c}=i,v=n.doc.textBetween(u,c,`
`,`
`).split(`
`).map(x=>o+x).join(`
`);return l.replaceWith(u,c,n.schema.text(v)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const r=(e=this.options.tabSize)!=null?e:Xw,{state:n}=t,{selection:i}=n,{$from:a,empty:s}=i;return a.parent.type!==this.type?!1:s?t.commands.command(({tr:o})=>{var l;const{pos:u}=a,c=a.start(),f=a.end(),v=n.doc.textBetween(c,f,`
`,`
`).split(`
`);let x=0,_=0;const S=u-c;for(let j=0;j<v.length;j+=1){if(_+v[j].length>=S){x=j;break}_+=v[j].length+1}const k=((l=v[x].match(/^ */))==null?void 0:l[0])||"",E=Math.min(k.length,r);if(E===0)return!0;let T=c;for(let j=0;j<x;j+=1)T+=v[j].length+1;return o.delete(T,T+E),u-T<=E&&o.setSelection(Yt.create(o.doc,T)),!0}):t.commands.command(({tr:o})=>{const{from:l,to:u}=i,g=n.doc.textBetween(l,u,`
`,`
`).split(`
`).map(v=>{var x;const _=((x=v.match(/^ */))==null?void 0:x[0])||"",S=Math.min(_.length,r);return v.slice(S)}).join(`
`);return o.replaceWith(l,u,n.schema.text(g)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:r}=e,{$from:n,empty:i}=r;if(!i||n.parent.type!==this.type)return!1;const a=n.parentOffset===n.parent.nodeSize-2,s=n.parent.textContent.endsWith(`

`);return!a||!s?!1:t.chain().command(({tr:o})=>(o.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:r,doc:n}=e,{$from:i,empty:a}=r;if(!a||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const o=i.after();return o===void 0?!1:n.nodeAt(o)?t.commands.command(({tr:u})=>(u.setSelection(ar.near(n.resolve(o))),!0)):t.commands.exitCode()}}},addInputRules(){return[t_({find:rK,type:this.type,getAttributes:t=>({language:t[1]})}),t_({find:nK,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Ln({key:new oi("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const r=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("vscode-editor-data"),i=n?JSON.parse(n):void 0,a=i?.mode;if(!r||!a)return!1;const{tr:s,schema:o}=t.state,l=o.text(r.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:a},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(Yt.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),aK=Os.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),sK=Os.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",Rn(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:r,editor:n})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:a}=r;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=n.extensionManager,l=a||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:u,dispatch:c})=>{if(c&&l&&s){const f=l.filter(g=>o.includes(g.type.name));u.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),oK=Os.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,Rn(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var r;const n=(r=t.attrs)!=null&&r.level?parseInt(t.attrs.level,10):1,i="#".repeat(n);return t.content?`${i} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>t_({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),lK=Os.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",Rn(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!MW(e,e.schema.nodes[this.name]))return!1;const{selection:r}=e,{$to:n}=r,i=t();return _A(r)?i.insertContentAt(n.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:a,tr:s,dispatch:o})=>{if(o){const{$to:l}=s.selection,u=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection(Yt.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(It.create(s.doc,l.pos)):s.setSelection(Yt.create(s.doc,l.pos));else{const c=a.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,f=c?.create();f&&(s.insert(u,f),s.setSelection(Yt.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[PW({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),uK=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,cK=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,dK=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,hK=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,fK=Xh.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",Rn(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[vp({find:uK,type:this.type}),vp({find:dK,type:this.type})]},addPasteRules(){return[Gh({find:cK,type:this.type}),Gh({find:hK,type:this.type})]}});const pK="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",mK="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",i_="numeric",a_="ascii",s_="alpha",wg="asciinumeric",fg="alphanumeric",o_="domain",HA="emoji",gK="scheme",vK="slashscheme",Qw="whitespace";function yK(t,e){return t in e||(e[t]=[]),e[t]}function Ch(t,e,r){e[i_]&&(e[wg]=!0,e[fg]=!0),e[a_]&&(e[wg]=!0,e[s_]=!0),e[wg]&&(e[fg]=!0),e[s_]&&(e[fg]=!0),e[fg]&&(e[o_]=!0),e[HA]&&(e[o_]=!0);for(const n in e){const i=yK(n,r);i.indexOf(t)<0&&i.push(t)}}function xK(t,e){const r={};for(const n in e)e[n].indexOf(t)>=0&&(r[n]=!0);return r}function Ms(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}Ms.groups={};Ms.prototype={accepts(){return!!this.t},go(t){const e=this,r=e.j[t];if(r)return r;for(let n=0;n<e.jr.length;n++){const i=e.jr[n][0],a=e.jr[n][1];if(a&&i.test(t))return a}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,r,n){for(let i=0;i<t.length;i++)this.tt(t[i],e,r,n)},tr(t,e,r,n){n=n||Ms.groups;let i;return e&&e.j?i=e:(i=new Ms(e),r&&n&&Ch(e,r,n)),this.jr.push([t,i]),i},ts(t,e,r,n){let i=this;const a=t.length;if(!a)return i;for(let s=0;s<a-1;s++)i=i.tt(t[s]);return i.tt(t[a-1],e,r,n)},tt(t,e,r,n){n=n||Ms.groups;const i=this;if(e&&e.j)return i.j[t]=e,e;const a=e;let s,o=i.go(t);if(o?(s=new Ms,Object.assign(s.j,o.j),s.jr.push.apply(s.jr,o.jr),s.jd=o.jd,s.t=o.t):s=new Ms,a){if(n)if(s.t&&typeof s.t=="string"){const l=Object.assign(xK(s.t,n),r);Ch(a,l,n)}else r&&Ch(a,r,n);s.t=a}return i.j[t]=s,s}};const ir=(t,e,r,n,i)=>t.ta(e,r,n,i),qn=(t,e,r,n,i)=>t.tr(e,r,n,i),y3=(t,e,r,n,i)=>t.ts(e,r,n,i),rt=(t,e,r,n,i)=>t.tt(e,r,n,i),Bu="WORD",l_="UWORD",GA="ASCIINUMERICAL",qA="ALPHANUMERICAL",Qg="LOCALHOST",u_="TLD",c_="UTLD",Y0="SCHEME",Zf="SLASH_SCHEME",jS="NUM",d_="WS",RS="NL",_g="OPENBRACE",Sg="CLOSEBRACE",jy="OPENBRACKET",Ry="CLOSEBRACKET",Ly="OPENPAREN",Oy="CLOSEPAREN",Dy="OPENANGLEBRACKET",Iy="CLOSEANGLEBRACKET",By="FULLWIDTHLEFTPAREN",zy="FULLWIDTHRIGHTPAREN",Fy="LEFTCORNERBRACKET",Vy="RIGHTCORNERBRACKET",Uy="LEFTWHITECORNERBRACKET",Hy="RIGHTWHITECORNERBRACKET",Gy="FULLWIDTHLESSTHAN",qy="FULLWIDTHGREATERTHAN",Wy="AMPERSAND",$y="APOSTROPHE",Ky="ASTERISK",Qc="AT",Zy="BACKSLASH",Yy="BACKTICK",Xy="CARET",td="COLON",LS="COMMA",Qy="DOLLAR",$l="DOT",Jy="EQUALS",OS="EXCLAMATION",So="HYPHEN",kg="PERCENT",ex="PIPE",tx="PLUS",rx="POUND",Cg="QUERY",DS="QUOTE",WA="FULLWIDTHMIDDLEDOT",IS="SEMI",Kl="SLASH",Eg="TILDE",nx="UNDERSCORE",$A="EMOJI",ix="SYM";var KA=Object.freeze({__proto__:null,ALPHANUMERICAL:qA,AMPERSAND:Wy,APOSTROPHE:$y,ASCIINUMERICAL:GA,ASTERISK:Ky,AT:Qc,BACKSLASH:Zy,BACKTICK:Yy,CARET:Xy,CLOSEANGLEBRACKET:Iy,CLOSEBRACE:Sg,CLOSEBRACKET:Ry,CLOSEPAREN:Oy,COLON:td,COMMA:LS,DOLLAR:Qy,DOT:$l,EMOJI:$A,EQUALS:Jy,EXCLAMATION:OS,FULLWIDTHGREATERTHAN:qy,FULLWIDTHLEFTPAREN:By,FULLWIDTHLESSTHAN:Gy,FULLWIDTHMIDDLEDOT:WA,FULLWIDTHRIGHTPAREN:zy,HYPHEN:So,LEFTCORNERBRACKET:Fy,LEFTWHITECORNERBRACKET:Uy,LOCALHOST:Qg,NL:RS,NUM:jS,OPENANGLEBRACKET:Dy,OPENBRACE:_g,OPENBRACKET:jy,OPENPAREN:Ly,PERCENT:kg,PIPE:ex,PLUS:tx,POUND:rx,QUERY:Cg,QUOTE:DS,RIGHTCORNERBRACKET:Vy,RIGHTWHITECORNERBRACKET:Hy,SCHEME:Y0,SEMI:IS,SLASH:Kl,SLASH_SCHEME:Zf,SYM:ix,TILDE:Eg,TLD:u_,UNDERSCORE:nx,UTLD:c_,UWORD:l_,WORD:Bu,WS:d_});const Du=/[a-z]/,rg=new RegExp("\\p{L}","u"),Jw=new RegExp("\\p{Emoji}","u"),Iu=/\d/,e2=/\s/,x3="\r",t2=`
`,bK="",wK="",r2="";let P0=null,M0=null;function _K(t=[]){const e={};Ms.groups=e;const r=new Ms;P0==null&&(P0=b3(pK)),M0==null&&(M0=b3(mK)),rt(r,"'",$y),rt(r,"{",_g),rt(r,"}",Sg),rt(r,"[",jy),rt(r,"]",Ry),rt(r,"(",Ly),rt(r,")",Oy),rt(r,"<",Dy),rt(r,">",Iy),rt(r,"",By),rt(r,"",zy),rt(r,"",Fy),rt(r,"",Vy),rt(r,"",Uy),rt(r,"",Hy),rt(r,"",Gy),rt(r,"",qy),rt(r,"&",Wy),rt(r,"*",Ky),rt(r,"@",Qc),rt(r,"`",Yy),rt(r,"^",Xy),rt(r,":",td),rt(r,",",LS),rt(r,"$",Qy),rt(r,".",$l),rt(r,"=",Jy),rt(r,"!",OS),rt(r,"-",So),rt(r,"%",kg),rt(r,"|",ex),rt(r,"+",tx),rt(r,"#",rx),rt(r,"?",Cg),rt(r,'"',DS),rt(r,"/",Kl),rt(r,";",IS),rt(r,"~",Eg),rt(r,"_",nx),rt(r,"\\",Zy),rt(r,"",WA);const n=qn(r,Iu,jS,{[i_]:!0});qn(n,Iu,n);const i=qn(n,Du,GA,{[wg]:!0}),a=qn(n,rg,qA,{[fg]:!0}),s=qn(r,Du,Bu,{[a_]:!0});qn(s,Iu,i),qn(s,Du,s),qn(i,Iu,i),qn(i,Du,i);const o=qn(r,rg,l_,{[s_]:!0});qn(o,Du),qn(o,Iu,a),qn(o,rg,o),qn(a,Iu,a),qn(a,Du),qn(a,rg,a);const l=rt(r,t2,RS,{[Qw]:!0}),u=rt(r,x3,d_,{[Qw]:!0}),c=qn(r,e2,d_,{[Qw]:!0});rt(r,r2,c),rt(u,t2,l),rt(u,r2,c),qn(u,e2,c),rt(c,x3),rt(c,t2),qn(c,e2,c),rt(c,r2,c);const f=qn(r,Jw,$A,{[HA]:!0});rt(f,"#"),qn(f,Jw,f),rt(f,bK,f);const g=rt(f,wK);rt(g,"#"),qn(g,Jw,f);const v=[[Du,s],[Iu,i]],x=[[Du,null],[rg,o],[Iu,a]];for(let _=0;_<P0.length;_++)Kc(r,P0[_],u_,Bu,v);for(let _=0;_<M0.length;_++)Kc(r,M0[_],c_,l_,x);Ch(u_,{tld:!0,ascii:!0},e),Ch(c_,{utld:!0,alpha:!0},e),Kc(r,"file",Y0,Bu,v),Kc(r,"mailto",Y0,Bu,v),Kc(r,"http",Zf,Bu,v),Kc(r,"https",Zf,Bu,v),Kc(r,"ftp",Zf,Bu,v),Kc(r,"ftps",Zf,Bu,v),Ch(Y0,{scheme:!0,ascii:!0},e),Ch(Zf,{slashscheme:!0,ascii:!0},e),t=t.sort((_,S)=>_[0]>S[0]?1:-1);for(let _=0;_<t.length;_++){const S=t[_][0],k=t[_][1]?{[gK]:!0}:{[vK]:!0};S.indexOf("-")>=0?k[o_]=!0:Du.test(S)?Iu.test(S)?k[wg]=!0:k[a_]=!0:k[i_]=!0,y3(r,S,S,k)}return y3(r,"localhost",Qg,{ascii:!0}),r.jd=new Ms(ix),{start:r,tokens:Object.assign({groups:e},KA)}}function ZA(t,e){const r=SK(e.replace(/[A-Z]/g,o=>o.toLowerCase())),n=r.length,i=[];let a=0,s=0;for(;s<n;){let o=t,l=null,u=0,c=null,f=-1,g=-1;for(;s<n&&(l=o.go(r[s]));)o=l,o.accepts()?(f=0,g=0,c=o):f>=0&&(f+=r[s].length,g++),u+=r[s].length,a+=r[s].length,s++;a-=f,s-=g,u-=f,i.push({t:c.t,v:e.slice(a-u,a),s:a-u,e:a})}return i}function SK(t){const e=[],r=t.length;let n=0;for(;n<r;){let i=t.charCodeAt(n),a,s=i<55296||i>56319||n+1===r||(a=t.charCodeAt(n+1))<56320||a>57343?t[n]:t.slice(n,n+2);e.push(s),n+=s.length}return e}function Kc(t,e,r,n,i){let a;const s=e.length;for(let o=0;o<s-1;o++){const l=e[o];t.j[l]?a=t.j[l]:(a=new Ms(n),a.jr=i.slice(),t.j[l]=a),t=a}return a=new Ms(r),a.jr=i.slice(),t.j[e[s-1]]=a,a}function b3(t){const e=[],r=[];let n=0,i="0123456789";for(;n<t.length;){let a=0;for(;i.indexOf(t[n+a])>=0;)a++;if(a>0){e.push(r.join(""));for(let s=parseInt(t.substring(n,n+a),10);s>0;s--)r.pop();n+=a}else r.push(t[n]),n++}return e}const Jg={defaultProtocol:"http",events:null,format:w3,formatHref:w3,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function BS(t,e=null){let r=Object.assign({},Jg);t&&(r=Object.assign(r,t instanceof BS?t.o:t));const n=r.ignoreTags,i=[];for(let a=0;a<n.length;a++)i.push(n[a].toUpperCase());this.o=r,e&&(this.defaultRender=e),this.ignoreTags=i}BS.prototype={o:Jg,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,r){const n=e!=null;let i=this.o[t];return i&&(typeof i=="object"?(i=r.t in i?i[r.t]:Jg[t],typeof i=="function"&&n&&(i=i(e,r))):typeof i=="function"&&n&&(i=i(e,r.t,r)),i)},getObj(t,e,r){let n=this.o[t];return typeof n=="function"&&e!=null&&(n=n(e,r.t,r)),n},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function w3(t){return t}function YA(t,e){this.t="token",this.v=t,this.tk=e}YA.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),r=t.get("truncate",e,this),n=t.get("format",e,this);return r&&n.length>r?n.substring(0,r)+"":n},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Jg.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,r=this.toHref(t.get("defaultProtocol")),n=t.get("formatHref",r,this),i=t.get("tagName",r,e),a=this.toFormattedString(t),s={},o=t.get("className",r,e),l=t.get("target",r,e),u=t.get("rel",r,e),c=t.getObj("attributes",r,e),f=t.getObj("events",r,e);return s.href=n,o&&(s.class=o),l&&(s.target=l),u&&(s.rel=u),c&&Object.assign(s,c),{tagName:i,attributes:s,content:a,eventListeners:f}}};function $x(t,e){class r extends YA{constructor(i,a){super(i,a),this.t=t}}for(const n in e)r.prototype[n]=e[n];return r.t=t,r}const _3=$x("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),S3=$x("text"),kK=$x("nl"),A0=$x("url",{isLink:!0,toHref(t=Jg.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Qg&&t[1].t===td}}),wo=t=>new Ms(t);function CK({groups:t}){const e=t.domain.concat([Wy,Ky,Qc,Zy,Yy,Xy,Qy,Jy,So,jS,kg,ex,tx,rx,Kl,ix,Eg,nx]),r=[$y,td,LS,$l,OS,kg,Cg,DS,IS,Dy,Iy,_g,Sg,Ry,jy,Ly,Oy,By,zy,Fy,Vy,Uy,Hy,Gy,qy],n=[Wy,$y,Ky,Zy,Yy,Xy,Qy,Jy,So,_g,Sg,kg,ex,tx,rx,Cg,Kl,ix,Eg,nx],i=wo(),a=rt(i,Eg);ir(a,n,a),ir(a,t.domain,a);const s=wo(),o=wo(),l=wo();ir(i,t.domain,s),ir(i,t.scheme,o),ir(i,t.slashscheme,l),ir(s,n,a),ir(s,t.domain,s);const u=rt(s,Qc);rt(a,Qc,u),rt(o,Qc,u),rt(l,Qc,u);const c=rt(a,$l);ir(c,n,a),ir(c,t.domain,a);const f=wo();ir(u,t.domain,f),ir(f,t.domain,f);const g=rt(f,$l);ir(g,t.domain,f);const v=wo(_3);ir(g,t.tld,v),ir(g,t.utld,v),rt(u,Qg,v);const x=rt(f,So);rt(x,So,x),ir(x,t.domain,f),ir(v,t.domain,f),rt(v,$l,g),rt(v,So,x);const _=rt(v,td);ir(_,t.numeric,_3);const S=rt(s,So),N=rt(s,$l);rt(S,So,S),ir(S,t.domain,s),ir(N,n,a),ir(N,t.domain,s);const k=wo(A0);ir(N,t.tld,k),ir(N,t.utld,k),ir(k,t.domain,s),ir(k,n,a),rt(k,$l,N),rt(k,So,S),rt(k,Qc,u);const E=rt(k,td),T=wo(A0);ir(E,t.numeric,T);const R=wo(A0),j=wo();ir(R,e,R),ir(R,r,j),ir(j,e,R),ir(j,r,j),rt(k,Kl,R),rt(T,Kl,R);const D=rt(o,td),B=rt(l,td),I=rt(B,Kl),V=rt(I,Kl);ir(o,t.domain,s),rt(o,$l,N),rt(o,So,S),ir(l,t.domain,s),rt(l,$l,N),rt(l,So,S),ir(D,t.domain,R),rt(D,Kl,R),rt(D,Cg,R),ir(V,t.domain,R),ir(V,e,R),rt(V,Kl,R);const $=[[_g,Sg],[jy,Ry],[Ly,Oy],[Dy,Iy],[By,zy],[Fy,Vy],[Uy,Hy],[Gy,qy]];for(let Z=0;Z<$.length;Z++){const[O,W]=$[Z],F=rt(R,O);rt(j,O,F),rt(F,W,R);const K=wo(A0);ir(F,e,K);const X=wo();ir(F,r),ir(K,e,K),ir(K,r,X),ir(X,e,K),ir(X,r,X),rt(K,W,R),rt(X,W,R)}return rt(i,Qg,k),rt(i,RS,kK),{start:i,tokens:KA}}function EK(t,e,r){let n=r.length,i=0,a=[],s=[];for(;i<n;){let o=t,l=null,u=null,c=0,f=null,g=-1;for(;i<n&&!(l=o.go(r[i].t));)s.push(r[i++]);for(;i<n&&(u=l||o.go(r[i].t));)l=null,o=u,o.accepts()?(g=0,f=o):g>=0&&g++,i++,c++;if(g<0)i-=c,i<n&&(s.push(r[i]),i++);else{s.length>0&&(a.push(n2(S3,e,s)),s=[]),i-=g,c-=g;const v=f.t,x=r.slice(i-c,i);a.push(n2(v,e,x))}}return s.length>0&&a.push(n2(S3,e,s)),a}function n2(t,e,r){const n=r[0].s,i=r[r.length-1].e,a=e.slice(n,i);return new t(a,r)}const NK=typeof console<"u"&&console&&console.warn||(()=>{}),TK="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",vn={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function PK(){return Ms.groups={},vn.scanner=null,vn.parser=null,vn.tokenQueue=[],vn.pluginQueue=[],vn.customSchemes=[],vn.initialized=!1,vn}function k3(t,e=!1){if(vn.initialized&&NK(`linkifyjs: already initialized - will not register custom scheme "${t}" ${TK}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);vn.customSchemes.push([t,e])}function MK(){vn.scanner=_K(vn.customSchemes);for(let t=0;t<vn.tokenQueue.length;t++)vn.tokenQueue[t][1]({scanner:vn.scanner});vn.parser=CK(vn.scanner.tokens);for(let t=0;t<vn.pluginQueue.length;t++)vn.pluginQueue[t][1]({scanner:vn.scanner,parser:vn.parser});return vn.initialized=!0,vn}function zS(t){return vn.initialized||MK(),EK(vn.parser.start,t,ZA(vn.scanner.start,t))}zS.scan=ZA;function XA(t,e=null,r=null){if(e&&typeof e=="object"){if(r)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);r=e,e=null}const n=new BS(r),i=zS(t),a=[];for(let s=0;s<i.length;s++){const o=i[s];o.isLink&&(!e||o.t===e)&&n.check(o)&&a.push(o.toFormattedObject(n))}return a}var FS="[\0- -\u2029]",AK=new RegExp(FS),jK=new RegExp(`${FS}$`),RK=new RegExp(FS,"g");function LK(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function OK(t){return new Ln({key:new oi("autolink"),appendTransaction:(e,r,n)=>{const i=e.some(u=>u.docChanged)&&!r.doc.eq(n.doc),a=e.some(u=>u.getMeta("preventAutolink"));if(!i||a)return;const{tr:s}=n,o=pA(r.doc,[...e]);if(wA(o).forEach(({newRange:u})=>{const c=Mq(n.doc,u,v=>v.isTextblock);let f,g;if(c.length>1)f=c[0],g=n.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ");else if(c.length){const v=n.doc.textBetween(u.from,u.to," "," ");if(!jK.test(v))return;f=c[0],g=n.doc.textBetween(f.pos,u.to,void 0," ")}if(f&&g){const v=g.split(AK).filter(Boolean);if(v.length<=0)return!1;const x=v[v.length-1],_=f.pos+g.lastIndexOf(x);if(!x)return!1;const S=zS(x).map(N=>N.toObject(t.defaultProtocol));if(!LK(S))return!1;S.filter(N=>N.isLink).map(N=>({...N,from:_+N.start+1,to:_+N.end+1})).filter(N=>n.schema.marks.code?!n.doc.rangeHasMark(N.from,N.to,n.schema.marks.code):!0).filter(N=>t.validate(N.value)).filter(N=>t.shouldAutoLink(N.value)).forEach(N=>{NS(N.from,N.to,n.doc).some(k=>k.mark.type===t.type)||s.addMark(N.from,N.to,t.type.create({href:N.href}))})}}),!!s.steps.length)return s}})}function DK(t){return new Ln({key:new oi("handleClickLink"),props:{handleClick:(e,r,n)=>{var i,a;if(n.button!==0||!e.editable)return!1;let s=null;if(n.target instanceof HTMLAnchorElement)s=n.target;else{const l=n.target;if(!l)return!1;const u=t.editor.view.dom;s=l.closest("a"),s&&!u.contains(s)&&(s=null)}if(!s)return!1;let o=!1;if(t.enableClickSelection&&(o=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){const l=bA(e.state,t.type.name),u=(i=s.href)!=null?i:l.href,c=(a=s.target)!=null?a:l.target;u&&(window.open(u,c),o=!0)}return o}}})}function IK(t){return new Ln({key:new oi("handlePasteLink"),props:{handlePaste:(e,r,n)=>{const{shouldAutoLink:i}=t,{state:a}=e,{selection:s}=a,{empty:o}=s;if(o)return!1;let l="";n.content.forEach(c=>{l+=c.textContent});const u=XA(l,{defaultProtocol:t.defaultProtocol}).find(c=>c.isLink&&c.value===l);return!l||!u||i!==void 0&&!i(u.value)?!1:t.editor.commands.setMark(t.type,{href:u.href})}}})}function ph(t,e){const r=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(n=>{const i=typeof n=="string"?n:n.scheme;i&&r.push(i)}),!t||t.replace(RK,"").match(new RegExp(`^(?:(?:${r.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var BK=Xh.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){k3(t);return}k3(t.scheme,t.optionalSlashes)})},onDestroy(){PK()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!ph(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),r=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||r&&!t.includes("@"))return!0;const i=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:r=>!!ph(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!ph(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",Rn(this.options.HTMLAttributes,t),0]:["a",Rn(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var r;const n=((r=t.attrs)==null?void 0:r.href)||"";return`[${e.renderChildren(t)}](${n})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:r}=t;return this.options.isAllowedUri(r,{defaultValidate:n=>!!ph(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:r}=t||{};return r&&!this.options.isAllowedUri(r,{defaultValidate:n=>!!ph(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Gh({find:t=>{const e=[];if(t){const{protocols:r,defaultProtocol:n}=this.options,i=XA(t).filter(a=>a.isLink&&this.options.isAllowedUri(a.value,{defaultValidate:s=>!!ph(s,r),protocols:r,defaultProtocol:n}));i.length&&i.forEach(a=>{this.options.shouldAutoLink(a.value)&&e.push({text:a.value,data:{href:a.href},index:a.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:r}=this.options;return this.options.autolink&&t.push(OK({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:i=>!!ph(i,e),protocols:e,defaultProtocol:r}),shouldAutoLink:this.options.shouldAutoLink})),t.push(DK({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(IK({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),zK=Object.defineProperty,FK=(t,e)=>{for(var r in e)zK(t,r,{get:e[r],enumerable:!0})},VK="listItem",C3="textStyle",E3=/^\s*([-+*])\s$/,QA=Os.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",Rn(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(VK,this.editor.getAttributes(C3)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=yp({find:E3,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=yp({find:E3,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(C3),editor:this.editor})),[t]}}),JA=Os.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",Rn(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let r=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(i=>i.type==="paragraph"))r=e.parseChildren(t.tokens);else{const i=t.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(r=[{type:"paragraph",content:e.parseInline(i.tokens)}],t.tokens.length>1){const s=t.tokens.slice(1),o=e.parseChildren(s);r.push(...o)}}else r=e.parseChildren(t.tokens)}return r.length===0&&(r=[{type:"paragraph",content:[]}]),{type:"listItem",content:r}},renderMarkdown:(t,e,r)=>AS(t,e,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",r),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),UK={};FK(UK,{findListItemPos:()=>xv,getNextListDepth:()=>VS,handleBackspace:()=>h_,handleDelete:()=>f_,hasListBefore:()=>ej,hasListItemAfter:()=>HK,hasListItemBefore:()=>tj,listItemHasSubList:()=>rj,nextListIsDeeper:()=>nj,nextListIsHigher:()=>ij});var xv=(t,e)=>{const{$from:r}=e.selection,n=bi(t,e.schema);let i=null,a=r.depth,s=r.pos,o=null;for(;a>0&&o===null;)i=r.node(a),i.type===n?o=a:(a-=1,s-=1);return o===null?null:{$pos:e.doc.resolve(s),depth:o}},VS=(t,e)=>{const r=xv(t,e);if(!r)return!1;const[,n]=Fq(e,t,r.$pos.pos+4);return n},ej=(t,e,r)=>{const{$anchor:n}=t.selection,i=Math.max(0,n.pos-2),a=t.doc.resolve(i).node();return!(!a||!r.includes(a.type.name))},tj=(t,e)=>{var r;const{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-2);return!(i.index()===0||((r=i.nodeBefore)==null?void 0:r.type.name)!==t)},rj=(t,e,r)=>{if(!r)return!1;const n=bi(t,e.schema);let i=!1;return r.descendants(a=>{a.type===n&&(i=!0)}),i},h_=(t,e,r)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!Cd(t.state,e)&&ej(t.state,e,r)){const{$anchor:o}=t.state.selection,l=t.state.doc.resolve(o.before()-1),u=[];l.node().descendants((g,v)=>{g.type.name===e&&u.push({node:g,pos:v})});const c=u.at(-1);if(!c)return!1;const f=t.state.doc.resolve(l.start()+c.pos+1);return t.chain().cut({from:o.start()-1,to:o.end()+1},f.end()).joinForward().run()}if(!Cd(t.state,e)||!Gq(t.state))return!1;const n=xv(e,t.state);if(!n)return!1;const a=t.state.doc.resolve(n.$pos.pos-2).node(n.depth),s=rj(e,t.state,a);return tj(e,t.state)&&!s?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},nj=(t,e)=>{const r=VS(t,e),n=xv(t,e);return!n||!r?!1:r>n.depth},ij=(t,e)=>{const r=VS(t,e),n=xv(t,e);return!n||!r?!1:r<n.depth},f_=(t,e)=>{if(!Cd(t.state,e)||!Hq(t.state,e))return!1;const{selection:r}=t.state,{$from:n,$to:i}=r;return!r.empty&&n.sameParent(i)?!1:nj(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():ij(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},HK=(t,e)=>{var r;const{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-n.parentOffset-2);return!(i.index()===i.parent.childCount-1||((r=i.nodeAfter)==null?void 0:r.type.name)!==t)},aj=li.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r})=>{t.state.schema.nodes[r]!==void 0&&f_(t,r)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r})=>{t.state.schema.nodes[r]!==void 0&&f_(t,r)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{t.state.schema.nodes[r]!==void 0&&h_(t,r,n)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{t.state.schema.nodes[r]!==void 0&&h_(t,r,n)&&(e=!0)}),e}}}}),N3=/^(\s*)(\d+)\.\s+(.*)$/,GK=/^\s/;function qK(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r],a=i.match(N3);if(!a)break;const[,s,o,l]=a,u=s.length;let c=l,f=r+1;const g=[i];for(;f<t.length;){const v=t[f];if(v.match(N3))break;if(v.trim()==="")g.push(v),c+=`
`,f+=1;else if(v.match(GK))g.push(v),c+=`
${v.slice(u+2)}`,f+=1;else break}e.push({indent:u,number:parseInt(o,10),content:c.trim(),raw:g.join(`
`)}),n=f,r=f}return[e,n]}function sj(t,e,r){var n;const i=[];let a=0;for(;a<t.length;){const s=t[a];if(s.indent===e){const o=s.content.split(`
`),l=((n=o[0])==null?void 0:n.trim())||"",u=[];l&&u.push({type:"paragraph",raw:l,tokens:r.inlineTokens(l)});const c=o.slice(1).join(`
`).trim();if(c){const v=r.blockTokens(c);u.push(...v)}let f=a+1;const g=[];for(;f<t.length&&t[f].indent>e;)g.push(t[f]),f+=1;if(g.length>0){const v=Math.min(...g.map(_=>_.indent)),x=sj(g,v,r);u.push({type:"list",ordered:!0,start:g[0].number,items:x,raw:g.map(_=>_.raw).join(`
`)})}i.push({type:"list_item",raw:s.raw,tokens:u}),a=f}else a+=1}return i}function WK(t,e){return t.map(r=>{if(r.type!=="list_item")return e.parseChildren([r])[0];const n=[];return r.tokens&&r.tokens.length>0&&r.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")n.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){const a=e.parseChildren([i]);n.push({type:"paragraph",content:a})}else{const a=e.parseChildren([i]);a.length>0&&n.push(...a)}}),{type:"listItem",content:n}})}var $K="listItem",T3="textStyle",P3=/^(\d+)\.\s$/,oj=Os.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...r}=t;return e===1?["ol",Rn(this.options.HTMLAttributes,r),0]:["ol",Rn(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const r=t.start||1,n=t.items?WK(t.items,e):[];return r!==1?{type:"orderedList",attrs:{start:r},content:n}:{type:"orderedList",content:n}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),r=e?.index;return r!==void 0?r:-1},tokenize:(t,e,r)=>{var n;const i=t.split(`
`),[a,s]=qK(i);if(a.length===0)return;const o=sj(a,0,r);return o.length===0?void 0:{type:"list",ordered:!0,start:((n=a[0])==null?void 0:n.number)||1,items:o,raw:i.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes($K,this.editor.getAttributes(T3)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=yp({find:P3,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=yp({find:P3,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(T3)}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1],editor:this.editor})),[t]}}),KK=/^\s*(\[([( |x])?\])\s$/,ZK=Os.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",Rn(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const r=[];if(t.tokens&&t.tokens.length>0?r.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?r.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):r.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const n=e.parseChildren(t.nestedTokens);r.push(...n)}return e.createNode("taskItem",{checked:t.checked||!1},r)},renderMarkdown:(t,e)=>{var r;const i=`- [${(r=t.attrs)!=null&&r.checked?"x":" "}] `;return AS(t,e,i)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:r,editor:n})=>{const i=document.createElement("li"),a=document.createElement("label"),s=document.createElement("span"),o=document.createElement("input"),l=document.createElement("div"),u=f=>{var g,v;o.ariaLabel=((v=(g=this.options.a11y)==null?void 0:g.checkboxLabel)==null?void 0:v.call(g,f,o.checked))||`Task item checkbox for ${f.textContent||"empty task item"}`};u(t),a.contentEditable="false",o.type="checkbox",o.addEventListener("mousedown",f=>f.preventDefault()),o.addEventListener("change",f=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){o.checked=!o.checked;return}const{checked:g}=f.target;n.isEditable&&typeof r=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:v})=>{const x=r();if(typeof x!="number")return!1;const _=v.doc.nodeAt(x);return v.setNodeMarkup(x,void 0,{..._?.attrs,checked:g}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,g)||(o.checked=!o.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([f,g])=>{i.setAttribute(f,g)}),i.dataset.checked=t.attrs.checked,o.checked=t.attrs.checked,a.append(o,s),i.append(a,l),Object.entries(e).forEach(([f,g])=>{i.setAttribute(f,g)});let c=new Set(Object.keys(e));return{dom:i,contentDOM:l,update:f=>{if(f.type!==this.type)return!1;i.dataset.checked=f.attrs.checked,o.checked=f.attrs.checked,u(f);const g=n.extensionManager.attributes,v=Xg(f,g),x=new Set(Object.keys(v)),_=this.options.HTMLAttributes;return c.forEach(S=>{x.has(S)||(S in _?i.setAttribute(S,_[S]):i.removeAttribute(S))}),Object.entries(v).forEach(([S,N])=>{N==null?S in _?i.setAttribute(S,_[S]):i.removeAttribute(S):i.setAttribute(S,N)}),c=x,!0}}}},addInputRules(){return[yp({find:KK,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),YK=Os.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",Rn(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const r=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return r!==void 0?r:-1},tokenize(t,e,r){const n=a=>{const s=r_(a,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,l)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:r.inlineTokens(o.mainContent),nestedTokens:l}),customNestedParser:n},r);return s?[{type:"taskList",raw:s.raw,items:s.items}]:r.blockTokens(a)},i=r_(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,s)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:r.inlineTokens(a.mainContent),nestedTokens:s}),customNestedParser:n},r);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});li.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(QA.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(JA.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(aj.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(oj.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(ZK.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(YK.configure(this.options.taskList)),t}});var XK=Os.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",Rn(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const r=t.tokens||[];return r.length===1&&r[0].type==="image"?e.parseChildren([r[0]]):e.createNode("paragraph",void 0,e.parseInline(r))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),QK=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,JK=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,eZ=Xh.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",Rn(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[vp({find:QK,type:this.type})]},addPasteRules(){return[Gh({find:JK,type:this.type})]}}),tZ=Os.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),rZ=Xh.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",Rn(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,r){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const a=i[2].trim();return{type:"underline",raw:i[0],text:a,tokens:r.inlineTokens(a)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function nZ(t={}){return new Ln({view(e){return new iZ(e,t)}})}class iZ{constructor(e,r){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=r.width)!==null&&n!==void 0?n:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let a=s=>{this[i](s)};return e.dom.addEventListener(i,a),{name:i,handler:a}})}destroy(){this.handlers.forEach(({name:e,handler:r})=>this.editorView.dom.removeEventListener(e,r))}update(e,r){this.cursorPos!=null&&r.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),r=!e.parent.inlineContent,n,i=this.editorView.dom,a=i.getBoundingClientRect(),s=a.width/i.offsetWidth,o=a.height/i.offsetHeight;if(r){let f=e.nodeBefore,g=e.nodeAfter;if(f||g){let v=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(v){let x=v.getBoundingClientRect(),_=f?x.bottom:x.top;f&&g&&(_=(_+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let S=this.width/2*o;n={left:x.left,right:x.right,top:_-S,bottom:_+S}}}}if(!n){let f=this.editorView.coordsAtPos(this.cursorPos),g=this.width/2*s;n={left:f.left-g,right:f.left+g,top:f.top,bottom:f.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let u,c;if(!l||l==document.body&&getComputedStyle(l).position=="static")u=-pageXOffset,c=-pageYOffset;else{let f=l.getBoundingClientRect(),g=f.width/l.offsetWidth,v=f.height/l.offsetHeight;u=f.left-l.scrollLeft*g,c=f.top-l.scrollTop*v}this.element.style.left=(n.left-u)/s+"px",this.element.style.top=(n.top-c)/o+"px",this.element.style.width=(n.right-n.left)/s+"px",this.element.style.height=(n.bottom-n.top)/o+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),i=n&&n.type.spec.disableDropCursor,a=typeof i=="function"?i(this.editorView,r,e):i;if(r&&!a){let s=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=a6(this.editorView.state.doc,s,this.editorView.dragging.slice);o!=null&&(s=o)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class Wn extends ar{constructor(e){super(e,e)}map(e,r){let n=e.resolve(r.map(this.head));return Wn.valid(n)?new Wn(n):ar.near(n)}content(){return wt.empty}eq(e){return e instanceof Wn&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Wn(e.resolve(r.pos))}getBookmark(){return new US(this.anchor)}static valid(e){let r=e.parent;if(r.isTextblock||!aZ(e)||!sZ(e))return!1;let n=r.type.spec.allowGapCursor;if(n!=null)return n;let i=r.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,r,n=!1){e:for(;;){if(!n&&Wn.valid(e))return e;let i=e.pos,a=null;for(let s=e.depth;;s--){let o=e.node(s);if(r>0?e.indexAfter(s)<o.childCount:e.index(s)>0){a=o.child(r>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=r;let l=e.doc.resolve(i);if(Wn.valid(l))return l}for(;;){let s=r>0?a.firstChild:a.lastChild;if(!s){if(a.isAtom&&!a.isText&&!It.isSelectable(a)){e=e.doc.resolve(i+a.nodeSize*r),n=!1;continue e}break}a=s,i+=r;let o=e.doc.resolve(i);if(Wn.valid(o))return o}return null}}}Wn.prototype.visible=!1;Wn.findFrom=Wn.findGapCursorFrom;ar.jsonID("gapcursor",Wn);class US{constructor(e){this.pos=e}map(e){return new US(e.map(this.pos))}resolve(e){let r=e.resolve(this.pos);return Wn.valid(r)?new Wn(r):ar.near(r)}}function lj(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function aZ(t){for(let e=t.depth;e>=0;e--){let r=t.index(e),n=t.node(e);if(r==0){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||lj(i.type))return!0;if(i.inlineContent)return!1}}return!0}function sZ(t){for(let e=t.depth;e>=0;e--){let r=t.indexAfter(e),n=t.node(e);if(r==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||lj(i.type))return!0;if(i.inlineContent)return!1}}return!0}function oZ(){return new Ln({props:{decorations:dZ,createSelectionBetween(t,e,r){return e.pos==r.pos&&Wn.valid(r)?new Wn(r):null},handleClick:uZ,handleKeyDown:lZ,handleDOMEvents:{beforeinput:cZ}}})}const lZ=sA({ArrowLeft:j0("horiz",-1),ArrowRight:j0("horiz",1),ArrowUp:j0("vert",-1),ArrowDown:j0("vert",1)});function j0(t,e){const r=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,i,a){let s=n.selection,o=e>0?s.$to:s.$from,l=s.empty;if(s instanceof Yt){if(!a.endOfTextblock(r)||o.depth==0)return!1;l=!1,o=n.doc.resolve(e>0?o.after():o.before())}let u=Wn.findGapCursorFrom(o,e,l);return u?(i&&i(n.tr.setSelection(new Wn(u))),!0):!1}}function uZ(t,e,r){if(!t||!t.editable)return!1;let n=t.state.doc.resolve(e);if(!Wn.valid(n))return!1;let i=t.posAtCoords({left:r.clientX,top:r.clientY});return i&&i.inside>-1&&It.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Wn(n))),!0)}function cZ(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Wn))return!1;let{$from:r}=t.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(t.state.schema.nodes.text);if(!n)return!1;let i=Qe.empty;for(let s=n.length-1;s>=0;s--)i=Qe.from(n[s].createAndFill(null,i));let a=t.state.tr.replace(r.pos,r.pos,new wt(i,0,0));return a.setSelection(Yt.near(a.doc.resolve(r.pos+1))),t.dispatch(a),!1}function dZ(t){if(!(t.selection instanceof Wn))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",An.create(t.doc,[Va.widget(t.selection.head,e,{key:"gapcursor"})])}var ax=200,Xi=function(){};Xi.prototype.append=function(e){return e.length?(e=Xi.from(e),!this.length&&e||e.length<ax&&this.leafAppend(e)||this.length<ax&&e.leafPrepend(this)||this.appendInner(e)):this};Xi.prototype.prepend=function(e){return e.length?Xi.from(e).append(this):this};Xi.prototype.appendInner=function(e){return new hZ(this,e)};Xi.prototype.slice=function(e,r){return e===void 0&&(e=0),r===void 0&&(r=this.length),e>=r?Xi.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,r))};Xi.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Xi.prototype.forEach=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length),r<=n?this.forEachInner(e,r,n,0):this.forEachInvertedInner(e,r,n,0)};Xi.prototype.map=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length);var i=[];return this.forEach(function(a,s){return i.push(e(a,s))},r,n),i};Xi.from=function(e){return e instanceof Xi?e:e&&e.length?new uj(e):Xi.empty};var uj=(function(t){function e(n){t.call(this),this.values=n}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,a){return i==0&&a==this.length?this:new e(this.values.slice(i,a))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,a,s,o){for(var l=a;l<s;l++)if(i(this.values[l],o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,a,s,o){for(var l=a-1;l>=s;l--)if(i(this.values[l],o+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=ax)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=ax)return new e(i.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(e.prototype,r),e})(Xi);Xi.empty=new uj([]);var hZ=(function(t){function e(r,n){t.call(this),this.left=r,this.right=n,this.length=r.length+n.length,this.depth=Math.max(r.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,i,a,s){var o=this.left.length;if(i<o&&this.left.forEachInner(n,i,Math.min(a,o),s)===!1||a>o&&this.right.forEachInner(n,Math.max(i-o,0),Math.min(this.length,a)-o,s+o)===!1)return!1},e.prototype.forEachInvertedInner=function(n,i,a,s){var o=this.left.length;if(i>o&&this.right.forEachInvertedInner(n,i-o,Math.max(a,o)-o,s+o)===!1||a<o&&this.left.forEachInvertedInner(n,Math.min(i,o),a,s)===!1)return!1},e.prototype.sliceInner=function(n,i){if(n==0&&i==this.length)return this;var a=this.left.length;return i<=a?this.left.slice(n,i):n>=a?this.right.slice(n-a,i-a):this.left.slice(n,a).append(this.right.slice(0,i-a))},e.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new e(i,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e})(Xi);const fZ=500;class ll{constructor(e,r){this.items=e,this.eventCount=r}popEvent(e,r){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let i,a;r&&(i=this.remapping(n,this.items.length),a=i.maps.length);let s=e.tr,o,l,u=[],c=[];return this.items.forEach((f,g)=>{if(!f.step){i||(i=this.remapping(n,g+1),a=i.maps.length),a--,c.push(f);return}if(i){c.push(new Zl(f.map));let v=f.step.map(i.slice(a)),x;v&&s.maybeStep(v).doc&&(x=s.mapping.maps[s.mapping.maps.length-1],u.push(new Zl(x,void 0,void 0,u.length+c.length))),a--,x&&i.appendMap(x,a)}else s.maybeStep(f.step);if(f.selection)return o=i?f.selection.map(i.slice(a)):f.selection,l=new ll(this.items.slice(0,n).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:o}}addTransform(e,r,n,i){let a=[],s=this.eventCount,o=this.items,l=!i&&o.length?o.get(o.length-1):null;for(let c=0;c<e.steps.length;c++){let f=e.steps[c].invert(e.docs[c]),g=new Zl(e.mapping.maps[c],f,r),v;(v=l&&l.merge(g))&&(g=v,c?a.pop():o=o.slice(0,o.length-1)),a.push(g),r&&(s++,r=void 0),i||(l=g)}let u=s-n.depth;return u>mZ&&(o=pZ(o,u),s-=u),new ll(o.append(a),s)}remapping(e,r){let n=new qg;return this.items.forEach((i,a)=>{let s=i.mirrorOffset!=null&&a-i.mirrorOffset>=e?n.maps.length-i.mirrorOffset:void 0;n.appendMap(i.map,s)},e,r),n}addMaps(e){return this.eventCount==0?this:new ll(this.items.append(e.map(r=>new Zl(r))),this.eventCount)}rebased(e,r){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-r),a=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach(g=>{g.selection&&o--},i);let l=r;this.items.forEach(g=>{let v=a.getMirror(--l);if(v==null)return;s=Math.min(s,v);let x=a.maps[v];if(g.step){let _=e.steps[v].invert(e.docs[v]),S=g.selection&&g.selection.map(a.slice(l+1,v));S&&o++,n.push(new Zl(x,_,S))}else n.push(new Zl(x))},i);let u=[];for(let g=r;g<s;g++)u.push(new Zl(a.maps[g]));let c=this.items.slice(0,i).append(u).append(n),f=new ll(c,o);return f.emptyItemCount()>fZ&&(f=f.compress(this.items.length-n.length)),f}emptyItemCount(){let e=0;return this.items.forEach(r=>{r.step||e++}),e}compress(e=this.items.length){let r=this.remapping(0,e),n=r.maps.length,i=[],a=0;return this.items.forEach((s,o)=>{if(o>=e)i.push(s),s.selection&&a++;else if(s.step){let l=s.step.map(r.slice(n)),u=l&&l.getMap();if(n--,u&&r.appendMap(u,n),l){let c=s.selection&&s.selection.map(r.slice(n));c&&a++;let f=new Zl(u.invert(),l,c),g,v=i.length-1;(g=i.length&&i[v].merge(f))?i[v]=g:i.push(f)}}else s.map&&n--},this.items.length,0),new ll(Xi.from(i.reverse()),a)}}ll.empty=new ll(Xi.empty,0);function pZ(t,e){let r;return t.forEach((n,i)=>{if(n.selection&&e--==0)return r=i,!1}),t.slice(r)}class Zl{constructor(e,r,n,i){this.map=e,this.step=r,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let r=e.step.merge(this.step);if(r)return new Zl(r.getMap().invert(),r,this.selection)}}}class Jc{constructor(e,r,n,i,a){this.done=e,this.undone=r,this.prevRanges=n,this.prevTime=i,this.prevComposition=a}}const mZ=20;function gZ(t,e,r,n){let i=r.getMeta(Ah),a;if(i)return i.historyState;r.getMeta(xZ)&&(t=new Jc(t.done,t.undone,null,0,-1));let s=r.getMeta("appendedTransaction");if(r.steps.length==0)return t;if(s&&s.getMeta(Ah))return s.getMeta(Ah).redo?new Jc(t.done.addTransform(r,void 0,n,X0(e)),t.undone,M3(r.mapping.maps),t.prevTime,t.prevComposition):new Jc(t.done,t.undone.addTransform(r,void 0,n,X0(e)),null,t.prevTime,t.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let o=r.getMeta("composition"),l=t.prevTime==0||!s&&t.prevComposition!=o&&(t.prevTime<(r.time||0)-n.newGroupDelay||!vZ(r,t.prevRanges)),u=s?i2(t.prevRanges,r.mapping):M3(r.mapping.maps);return new Jc(t.done.addTransform(r,l?e.selection.getBookmark():void 0,n,X0(e)),ll.empty,u,r.time,o??t.prevComposition)}else return(a=r.getMeta("rebased"))?new Jc(t.done.rebased(r,a),t.undone.rebased(r,a),i2(t.prevRanges,r.mapping),t.prevTime,t.prevComposition):new Jc(t.done.addMaps(r.mapping.maps),t.undone.addMaps(r.mapping.maps),i2(t.prevRanges,r.mapping),t.prevTime,t.prevComposition)}function vZ(t,e){if(!e)return!1;if(!t.docChanged)return!0;let r=!1;return t.mapping.maps[0].forEach((n,i)=>{for(let a=0;a<e.length;a+=2)n<=e[a+1]&&i>=e[a]&&(r=!0)}),r}function M3(t){let e=[];for(let r=t.length-1;r>=0&&e.length==0;r--)t[r].forEach((n,i,a,s)=>e.push(a,s));return e}function i2(t,e){if(!t)return null;let r=[];for(let n=0;n<t.length;n+=2){let i=e.map(t[n],1),a=e.map(t[n+1],-1);i<=a&&r.push(i,a)}return r}function yZ(t,e,r){let n=X0(e),i=Ah.get(e).spec.config,a=(r?t.undone:t.done).popEvent(e,n);if(!a)return null;let s=a.selection.resolve(a.transform.doc),o=(r?t.done:t.undone).addTransform(a.transform,e.selection.getBookmark(),i,n),l=new Jc(r?o:a.remaining,r?a.remaining:o,null,0,-1);return a.transform.setSelection(s).setMeta(Ah,{redo:r,historyState:l})}let a2=!1,A3=null;function X0(t){let e=t.plugins;if(A3!=e){a2=!1,A3=e;for(let r=0;r<e.length;r++)if(e[r].spec.historyPreserveItems){a2=!0;break}}return a2}const Ah=new oi("history"),xZ=new oi("closeHistory");function bZ(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Ln({key:Ah,state:{init(){return new Jc(ll.empty,ll.empty,null,0,-1)},apply(e,r,n){return gZ(r,n,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,r){let n=r.inputType,i=n=="historyUndo"?dj:n=="historyRedo"?hj:null;return!i||!e.editable?!1:(r.preventDefault(),i(e.state,e.dispatch))}}}})}function cj(t,e){return(r,n)=>{let i=Ah.getState(r);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(n){let a=yZ(i,r,t);a&&n(e?a.scrollIntoView():a)}return!0}}const dj=cj(!1,!0),hj=cj(!0,!0);li.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=t?.node||this.editor.state.doc;if((t?.mode||this.options.mode)==="textSize"){const n=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(n)}return e.nodeSize},this.storage.words=t=>{const e=t?.node||this.editor.state.doc,r=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let t=!1;return[new Ln({key:new oi("characterCount"),appendTransaction:(e,r,n)=>{if(t)return;const i=this.options.limit;if(i==null||i===0){t=!0;return}const a=this.storage.characters({node:n.doc});if(a>i){const s=a-i,o=0,l=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const u=n.tr.deleteRange(o,l);return t=!0,u}t=!0},filterTransaction:(e,r)=>{const n=this.options.limit;if(!e.docChanged||n===0||n===null||n===void 0)return!0;const i=this.storage.characters({node:r.doc}),a=this.storage.characters({node:e.doc});if(a<=n||i>n&&a>n&&a<=i)return!0;if(i>n&&a>n&&a>i||!e.getMeta("paste"))return!1;const o=e.selection.$head.pos,l=a-n,u=o-l,c=o;return e.deleteRange(u,c),!(this.storage.characters({node:e.doc})>n)}})]}});var wZ=li.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[nZ(this.options)]}});li.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new Ln({key:new oi("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:i}=e,a=[];if(!r||!n)return An.create(t,[]);let s=0;this.options.mode==="deepest"&&t.descendants((l,u)=>{if(l.isText)return;if(!(i>=u&&i<=u+l.nodeSize-1))return!1;s+=1});let o=0;return t.descendants((l,u)=>{if(l.isText||!(i>=u&&i<=u+l.nodeSize-1))return!1;if(o+=1,this.options.mode==="deepest"&&s-o>0||this.options.mode==="shallowest"&&o>1)return this.options.mode==="deepest";a.push(Va.node(u,u+l.nodeSize,{class:this.options.className}))}),An.create(t,a)}}})]}});var _Z=li.create({name:"gapCursor",addProseMirrorPlugins(){return[oZ()]},extendNodeSchema(t){var e;const r={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Hr(Lt(t,"allowGapCursor",r)))!=null?e:null}}}),SZ=li.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Ln({key:new oi("placeholder"),props:{decorations:({doc:t,selection:e})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=e,i=[];if(!r)return null;const a=this.editor.isEmpty;return t.descendants((s,o)=>{const l=n>=o&&n<=o+s.nodeSize,u=!s.isLeaf&&Gx(s);if((l||!this.options.showOnlyCurrent)&&u){const c=[this.options.emptyNodeClass];a&&c.push(this.options.emptyEditorClass);const f=Va.node(o,o+s.nodeSize,{class:c.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:o,hasAnchor:l}):this.options.placeholder});i.push(f)}return this.options.includeChildren}),An.create(t,i)}}})]}});li.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new Ln({key:new oi("selection"),props:{decorations(r){return r.selection.empty||t.isFocused||!t.isEditable||_A(r.selection)||t.view.dragging?null:An.create(r.doc,[Va.inline(r.selection.from,r.selection.to,{class:e.className})])}}})]}});function j3({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||e?.type===t}var kZ=li.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new oi(this.name),r=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(r).includes(i.name));return[new Ln({key:e,appendTransaction:(i,a,s)=>{const{doc:o,tr:l,schema:u}=s,c=e.getState(s),f=o.content.size,g=u.nodes[r];if(c)return l.insert(f,g.create())},state:{init:(i,a)=>{const s=a.tr.doc.lastChild;return!j3({node:s,types:n})},apply:(i,a)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return a;const s=i.doc.lastChild;return!j3({node:s,types:n})}}})]}}),CZ=li.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>dj(t,e),redo:()=>({state:t,dispatch:e})=>hj(t,e)}},addProseMirrorPlugins(){return[bZ(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),EZ=li.create({name:"starterKit",addExtensions(){var t,e,r,n;const i=[];return this.options.bold!==!1&&i.push(Q$.configure(this.options.bold)),this.options.blockquote!==!1&&i.push($$.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push(QA.configure(this.options.bulletList)),this.options.code!==!1&&i.push(tK.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(iK.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(aK.configure(this.options.document)),this.options.dropcursor!==!1&&i.push(wZ.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(_Z.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(sK.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(oK.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(CZ.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(lK.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(fK.configure(this.options.italic)),this.options.listItem!==!1&&i.push(JA.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(aj.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&i.push(BK.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(oj.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(XK.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(eZ.configure(this.options.strike)),this.options.text!==!1&&i.push(tZ.configure(this.options.text)),this.options.underline!==!1&&i.push(rZ.configure((r=this.options)==null?void 0:r.underline)),this.options.trailingNode!==!1&&i.push(kZ.configure((n=this.options)==null?void 0:n.trailingNode)),i}}),NZ=EZ,TZ=SZ;function PZ(t){var e;const{char:r,allowSpaces:n,allowToIncludeChar:i,allowedPrefixes:a,startOfLine:s,$position:o}=t,l=n&&!i,u=AW(r),c=new RegExp(`\\s${u}$`),f=s?"^":"",g=i?"":u,v=l?new RegExp(`${f}${u}.*?(?=\\s${g}|$)`,"gm"):new RegExp(`${f}(?:^)?${u}[^\\s${g}]*`,"gm"),x=((e=o.nodeBefore)==null?void 0:e.isText)&&o.nodeBefore.text;if(!x)return null;const _=o.pos-x.length,S=Array.from(x.matchAll(v)).pop();if(!S||S.input===void 0||S.index===void 0)return null;const N=S.input.slice(Math.max(0,S.index-1),S.index),k=new RegExp(`^[${a?.join("")}\0]?$`).test(N);if(a!==null&&!k)return null;const E=_+S.index;let T=E+S[0].length;return l&&c.test(x.slice(T-1,T+1))&&(S[0]+=" ",T+=1),E<o.pos&&T>=o.pos?{range:{from:E,to:T},query:S[0].slice(r.length),text:S[0]}:null}var MZ=new oi("suggestion");function AZ({pluginKey:t=MZ,editor:e,char:r="@",allowSpaces:n=!1,allowToIncludeChar:i=!1,allowedPrefixes:a=[" "],startOfLine:s=!1,decorationTag:o="span",decorationClass:l="suggestion",decorationContent:u="",decorationEmptyClass:c="is-empty",command:f=()=>null,items:g=()=>[],render:v=()=>({}),allow:x=()=>!0,findSuggestionMatch:_=PZ,shouldShow:S}){let N;const k=v?.(),E=()=>{const D=e.state.selection.$anchor.pos,B=e.view.coordsAtPos(D),{top:I,right:V,bottom:$,left:Z}=B;try{return new DOMRect(Z,I,V-Z,$-I)}catch{return null}},T=(D,B)=>B?()=>{const I=t.getState(e.state),V=I?.decorationId,$=D.dom.querySelector(`[data-decoration-id="${V}"]`);return $?.getBoundingClientRect()||null}:E;function R(D,B){var I;try{const $=t.getState(D.state),Z=$?.decorationId?D.dom.querySelector(`[data-decoration-id="${$.decorationId}"]`):null,O={editor:e,range:$?.range||{from:0,to:0},query:$?.query||null,text:$?.text||null,items:[],command:W=>f({editor:e,range:$?.range||{from:0,to:0},props:W}),decorationNode:Z,clientRect:T(D,Z)};(I=k?.onExit)==null||I.call(k,O)}catch{}const V=D.state.tr.setMeta(B,{exit:!0});D.dispatch(V)}const j=new Ln({key:t,view(){return{update:async(D,B)=>{var I,V,$,Z,O,W,F;const K=(I=this.key)==null?void 0:I.getState(B),X=(V=this.key)==null?void 0:V.getState(D.state),Q=K.active&&X.active&&K.range.from!==X.range.from,ae=!K.active&&X.active,re=K.active&&!X.active,G=!ae&&!re&&K.query!==X.query,te=ae||Q&&G,ne=G||Q,de=re||Q&&G;if(!te&&!ne&&!de)return;const me=de&&!te?K:X,ye=D.dom.querySelector(`[data-decoration-id="${me.decorationId}"]`);N={editor:e,range:me.range,query:me.query,text:me.text,items:[],command:ie=>f({editor:e,range:me.range,props:ie}),decorationNode:ye,clientRect:T(D,ye)},te&&(($=k?.onBeforeStart)==null||$.call(k,N)),ne&&((Z=k?.onBeforeUpdate)==null||Z.call(k,N)),(ne||te)&&(N.items=await g({editor:e,query:me.query})),de&&((O=k?.onExit)==null||O.call(k,N)),ne&&((W=k?.onUpdate)==null||W.call(k,N)),te&&((F=k?.onStart)==null||F.call(k,N))},destroy:()=>{var D;N&&((D=k?.onExit)==null||D.call(k,N))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(D,B,I,V){const{isEditable:$}=e,{composing:Z}=e.view,{selection:O}=D,{empty:W,from:F}=O,K={...B},X=D.getMeta(t);if(X&&X.exit)return K.active=!1,K.decorationId=null,K.range={from:0,to:0},K.query=null,K.text=null,K;if(K.composing=Z,$&&(W||e.view.composing)){(F<B.range.from||F>B.range.to)&&!Z&&!B.composing&&(K.active=!1);const Q=_({char:r,allowSpaces:n,allowToIncludeChar:i,allowedPrefixes:a,startOfLine:s,$position:O.$from}),ae=`id_${Math.floor(Math.random()*4294967295)}`;Q&&x({editor:e,state:V,range:Q.range,isActive:B.active})&&(!S||S({editor:e,range:Q.range,query:Q.query,text:Q.text,transaction:D}))?(K.active=!0,K.decorationId=B.decorationId?B.decorationId:ae,K.range=Q.range,K.query=Q.query,K.text=Q.text):K.active=!1}else K.active=!1;return K.active||(K.decorationId=null,K.range={from:0,to:0},K.query=null,K.text=null),K}},props:{handleKeyDown(D,B){var I,V,$,Z;const{active:O,range:W}=j.getState(D.state);if(!O)return!1;if(B.key==="Escape"||B.key==="Esc"){const K=j.getState(D.state),X=(I=N?.decorationNode)!=null?I:null,Q=X??(K?.decorationId?D.dom.querySelector(`[data-decoration-id="${K.decorationId}"]`):null);if(((V=k?.onKeyDown)==null?void 0:V.call(k,{view:D,event:B,range:K.range}))||!1)return!0;const re={editor:e,range:K.range,query:K.query,text:K.text,items:[],command:G=>f({editor:e,range:K.range,props:G}),decorationNode:Q,clientRect:Q?()=>Q.getBoundingClientRect()||null:null};return($=k?.onExit)==null||$.call(k,re),R(D,t),!0}return((Z=k?.onKeyDown)==null?void 0:Z.call(k,{view:D,event:B,range:W}))||!1},decorations(D){const{active:B,range:I,decorationId:V,query:$}=j.getState(D);if(!B)return null;const Z=!$?.length,O=[l];return Z&&O.push(c),An.create(D.doc,[Va.inline(I.from,I.to,{nodeName:o,class:O.join(" "),"data-decoration-id":V,"data-decoration-content":u})])}}});return j}function jZ({editor:t,overrideSuggestionOptions:e,extensionName:r,char:n="@"}){const i=new oi;return{editor:t,char:n,pluginKey:i,command:({editor:a,range:s,props:o})=>{var l,u,c;const f=a.view.state.selection.$to.nodeAfter;(l=f?.text)!=null&&l.startsWith(" ")&&(s.to+=1),a.chain().focus().insertContentAt(s,[{type:r,attrs:{...o,mentionSuggestionChar:n}},{type:"text",text:" "}]).run(),(c=(u=a.view.dom.ownerDocument.defaultView)==null?void 0:u.getSelection())==null||c.collapseToEnd()},allow:({state:a,range:s})=>{const o=a.doc.resolve(s.from),l=a.schema.nodes[r];return!!o.parent.type.contentMatch.matchType(l)},...e}}function fj(t){return(t.options.suggestions.length?t.options.suggestions:[t.options.suggestion]).map(e=>jZ({editor:t.editor,overrideSuggestionOptions:e,extensionName:t.name,char:e.char}))}function R3(t,e){const r=fj(t),n=r.find(i=>i.char===e);return n||(r.length?r[0]:null)}var RZ=Os.create({name:"mention",priority:101,addOptions(){return{HTMLAttributes:{},renderText({node:t,suggestion:e}){var r,n;return`${(r=e?.char)!=null?r:"@"}${(n=t.attrs.label)!=null?n:t.attrs.id}`},deleteTriggerWithBackspace:!1,renderHTML({options:t,node:e,suggestion:r}){var n,i;return["span",Rn(this.HTMLAttributes,t.HTMLAttributes),`${(n=r?.char)!=null?n:"@"}${(i=e.attrs.label)!=null?i:e.attrs.id}`]},suggestions:[],suggestion:{}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:t=>t.getAttribute("data-id"),renderHTML:t=>t.id?{"data-id":t.id}:{}},label:{default:null,parseHTML:t=>t.getAttribute("data-label"),renderHTML:t=>t.label?{"data-label":t.label}:{}},mentionSuggestionChar:{default:"@",parseHTML:t=>t.getAttribute("data-mention-suggestion-char"),renderHTML:t=>({"data-mention-suggestion-char":t.mentionSuggestionChar})}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:t,HTMLAttributes:e}){const r=R3(this,t.attrs.mentionSuggestionChar);if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",Rn({"data-type":this.name},this.options.HTMLAttributes,e),this.options.renderLabel({options:this.options,node:t,suggestion:r})];const n={...this.options};n.HTMLAttributes=Rn({"data-type":this.name},this.options.HTMLAttributes,e);const i=this.options.renderHTML({options:n,node:t,suggestion:r});return typeof i=="string"?["span",Rn({"data-type":this.name},this.options.HTMLAttributes,e),i]:i},...zA({nodeName:"mention",name:"@",selfClosing:!0,allowedAttributes:["id","label",{name:"mentionSuggestionChar",skipIfDefault:"@"}],parseAttributes:t=>{const e={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(t);for(;n!==null;){const[,i,a,s]=n,o=a??s;e[i==="char"?"mentionSuggestionChar":i]=o,n=r.exec(t)}return e},serializeAttributes:t=>Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e==="mentionSuggestionChar"?"char":e}="${r}"`).join(" ")}),renderText({node:t}){const e={options:this.options,node:t,suggestion:R3(this,t.attrs.mentionSuggestionChar)};return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel(e)):this.options.renderText(e)},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:t,state:e})=>{let r=!1;const{selection:n}=e,{empty:i,anchor:a}=n;if(!i)return!1;let s=new To,o=0;return e.doc.nodesBetween(a-1,a,(l,u)=>{if(l.type.name===this.name)return r=!0,s=l,o=u,!1}),r&&t.insertText(this.options.deleteTriggerWithBackspace?"":s.attrs.mentionSuggestionChar,o,o+s.nodeSize),r})}},addProseMirrorPlugins(){return fj(this).map(AZ)}}),LZ=RZ,Rs="top",jo="bottom",Ro="right",Ls="left",HS="auto",bv=[Rs,jo,Ro,Ls],xp="start",ev="end",OZ="clippingParents",pj="viewport",ng="popper",DZ="reference",L3=bv.reduce(function(t,e){return t.concat([e+"-"+xp,e+"-"+ev])},[]),mj=[].concat(bv,[HS]).reduce(function(t,e){return t.concat([e,e+"-"+xp,e+"-"+ev])},[]),IZ="beforeRead",BZ="read",zZ="afterRead",FZ="beforeMain",VZ="main",UZ="afterMain",HZ="beforeWrite",GZ="write",qZ="afterWrite",WZ=[IZ,BZ,zZ,FZ,VZ,UZ,HZ,GZ,qZ];function ru(t){return t?(t.nodeName||"").toLowerCase():null}function Qs(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function qh(t){var e=Qs(t).Element;return t instanceof e||t instanceof Element}function Ao(t){var e=Qs(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function GS(t){if(typeof ShadowRoot>"u")return!1;var e=Qs(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function $Z(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},a=e.elements[r];!Ao(a)||!ru(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function KZ(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},s=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=s.reduce(function(l,u){return l[u]="",l},{});!Ao(i)||!ru(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}const gj={name:"applyStyles",enabled:!0,phase:"write",fn:$Z,effect:KZ,requires:["computeStyles"]};function Ql(t){return t.split("-")[0]}var jh=Math.max,sx=Math.min,bp=Math.round;function p_(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function vj(){return!/^((?!chrome|android).)*safari/i.test(p_())}function wp(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&Ao(t)&&(i=t.offsetWidth>0&&bp(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&bp(n.height)/t.offsetHeight||1);var s=qh(t)?Qs(t):window,o=s.visualViewport,l=!vj()&&r,u=(n.left+(l&&o?o.offsetLeft:0))/i,c=(n.top+(l&&o?o.offsetTop:0))/a,f=n.width/i,g=n.height/a;return{width:f,height:g,top:c,right:u+f,bottom:c+g,left:u,x:u,y:c}}function qS(t){var e=wp(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function yj(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&GS(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function $u(t){return Qs(t).getComputedStyle(t)}function ZZ(t){return["table","td","th"].indexOf(ru(t))>=0}function Dd(t){return((qh(t)?t.ownerDocument:t.document)||window.document).documentElement}function Kx(t){return ru(t)==="html"?t:t.assignedSlot||t.parentNode||(GS(t)?t.host:null)||Dd(t)}function O3(t){return!Ao(t)||$u(t).position==="fixed"?null:t.offsetParent}function YZ(t){var e=/firefox/i.test(p_()),r=/Trident/i.test(p_());if(r&&Ao(t)){var n=$u(t);if(n.position==="fixed")return null}var i=Kx(t);for(GS(i)&&(i=i.host);Ao(i)&&["html","body"].indexOf(ru(i))<0;){var a=$u(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function wv(t){for(var e=Qs(t),r=O3(t);r&&ZZ(r)&&$u(r).position==="static";)r=O3(r);return r&&(ru(r)==="html"||ru(r)==="body"&&$u(r).position==="static")?e:r||YZ(t)||e}function WS(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Ng(t,e,r){return jh(t,sx(e,r))}function XZ(t,e,r){var n=Ng(t,e,r);return n>r?r:n}function xj(){return{top:0,right:0,bottom:0,left:0}}function bj(t){return Object.assign({},xj(),t)}function wj(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var QZ=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,bj(typeof e!="number"?e:wj(e,bv))};function JZ(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,s=r.modifiersData.popperOffsets,o=Ql(r.placement),l=WS(o),u=[Ls,Ro].indexOf(o)>=0,c=u?"height":"width";if(!(!a||!s)){var f=QZ(i.padding,r),g=qS(a),v=l==="y"?Rs:Ls,x=l==="y"?jo:Ro,_=r.rects.reference[c]+r.rects.reference[l]-s[l]-r.rects.popper[c],S=s[l]-r.rects.reference[l],N=wv(a),k=N?l==="y"?N.clientHeight||0:N.clientWidth||0:0,E=_/2-S/2,T=f[v],R=k-g[c]-f[x],j=k/2-g[c]/2+E,D=Ng(T,j,R),B=l;r.modifiersData[n]=(e={},e[B]=D,e.centerOffset=D-j,e)}}function eY(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||yj(e.elements.popper,i)&&(e.elements.arrow=i))}const tY={name:"arrow",enabled:!0,phase:"main",fn:JZ,effect:eY,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function _p(t){return t.split("-")[1]}var rY={top:"auto",right:"auto",bottom:"auto",left:"auto"};function nY(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:bp(r*i)/i||0,y:bp(n*i)/i||0}}function D3(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,s=t.offsets,o=t.position,l=t.gpuAcceleration,u=t.adaptive,c=t.roundOffsets,f=t.isFixed,g=s.x,v=g===void 0?0:g,x=s.y,_=x===void 0?0:x,S=typeof c=="function"?c({x:v,y:_}):{x:v,y:_};v=S.x,_=S.y;var N=s.hasOwnProperty("x"),k=s.hasOwnProperty("y"),E=Ls,T=Rs,R=window;if(u){var j=wv(r),D="clientHeight",B="clientWidth";if(j===Qs(r)&&(j=Dd(r),$u(j).position!=="static"&&o==="absolute"&&(D="scrollHeight",B="scrollWidth")),j=j,i===Rs||(i===Ls||i===Ro)&&a===ev){T=jo;var I=f&&j===R&&R.visualViewport?R.visualViewport.height:j[D];_-=I-n.height,_*=l?1:-1}if(i===Ls||(i===Rs||i===jo)&&a===ev){E=Ro;var V=f&&j===R&&R.visualViewport?R.visualViewport.width:j[B];v-=V-n.width,v*=l?1:-1}}var $=Object.assign({position:o},u&&rY),Z=c===!0?nY({x:v,y:_},Qs(r)):{x:v,y:_};if(v=Z.x,_=Z.y,l){var O;return Object.assign({},$,(O={},O[T]=k?"0":"",O[E]=N?"0":"",O.transform=(R.devicePixelRatio||1)<=1?"translate("+v+"px, "+_+"px)":"translate3d("+v+"px, "+_+"px, 0)",O))}return Object.assign({},$,(e={},e[T]=k?_+"px":"",e[E]=N?v+"px":"",e.transform="",e))}function iY(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,s=a===void 0?!0:a,o=r.roundOffsets,l=o===void 0?!0:o,u={placement:Ql(e.placement),variation:_p(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,D3(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,D3(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const aY={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:iY,data:{}};var R0={passive:!0};function sY(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,s=n.resize,o=s===void 0?!0:s,l=Qs(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&u.forEach(function(c){c.addEventListener("scroll",r.update,R0)}),o&&l.addEventListener("resize",r.update,R0),function(){a&&u.forEach(function(c){c.removeEventListener("scroll",r.update,R0)}),o&&l.removeEventListener("resize",r.update,R0)}}const oY={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:sY,data:{}};var lY={left:"right",right:"left",bottom:"top",top:"bottom"};function Q0(t){return t.replace(/left|right|bottom|top/g,function(e){return lY[e]})}var uY={start:"end",end:"start"};function I3(t){return t.replace(/start|end/g,function(e){return uY[e]})}function $S(t){var e=Qs(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function KS(t){return wp(Dd(t)).left+$S(t).scrollLeft}function cY(t,e){var r=Qs(t),n=Dd(t),i=r.visualViewport,a=n.clientWidth,s=n.clientHeight,o=0,l=0;if(i){a=i.width,s=i.height;var u=vj();(u||!u&&e==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:a,height:s,x:o+KS(t),y:l}}function dY(t){var e,r=Dd(t),n=$S(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=jh(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=jh(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+KS(t),l=-n.scrollTop;return $u(i||r).direction==="rtl"&&(o+=jh(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:l}}function ZS(t){var e=$u(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function _j(t){return["html","body","#document"].indexOf(ru(t))>=0?t.ownerDocument.body:Ao(t)&&ZS(t)?t:_j(Kx(t))}function Tg(t,e){var r;e===void 0&&(e=[]);var n=_j(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=Qs(n),s=i?[a].concat(a.visualViewport||[],ZS(n)?n:[]):n,o=e.concat(s);return i?o:o.concat(Tg(Kx(s)))}function m_(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function hY(t,e){var r=wp(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function B3(t,e,r){return e===pj?m_(cY(t,r)):qh(e)?hY(e,r):m_(dY(Dd(t)))}function fY(t){var e=Tg(Kx(t)),r=["absolute","fixed"].indexOf($u(t).position)>=0,n=r&&Ao(t)?wv(t):t;return qh(n)?e.filter(function(i){return qh(i)&&yj(i,n)&&ru(i)!=="body"}):[]}function pY(t,e,r,n){var i=e==="clippingParents"?fY(t):[].concat(e),a=[].concat(i,[r]),s=a[0],o=a.reduce(function(l,u){var c=B3(t,u,n);return l.top=jh(c.top,l.top),l.right=sx(c.right,l.right),l.bottom=sx(c.bottom,l.bottom),l.left=jh(c.left,l.left),l},B3(t,s,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function Sj(t){var e=t.reference,r=t.element,n=t.placement,i=n?Ql(n):null,a=n?_p(n):null,s=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,l;switch(i){case Rs:l={x:s,y:e.y-r.height};break;case jo:l={x:s,y:e.y+e.height};break;case Ro:l={x:e.x+e.width,y:o};break;case Ls:l={x:e.x-r.width,y:o};break;default:l={x:e.x,y:e.y}}var u=i?WS(i):null;if(u!=null){var c=u==="y"?"height":"width";switch(a){case xp:l[u]=l[u]-(e[c]/2-r[c]/2);break;case ev:l[u]=l[u]+(e[c]/2-r[c]/2);break}}return l}function tv(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.strategy,s=a===void 0?t.strategy:a,o=r.boundary,l=o===void 0?OZ:o,u=r.rootBoundary,c=u===void 0?pj:u,f=r.elementContext,g=f===void 0?ng:f,v=r.altBoundary,x=v===void 0?!1:v,_=r.padding,S=_===void 0?0:_,N=bj(typeof S!="number"?S:wj(S,bv)),k=g===ng?DZ:ng,E=t.rects.popper,T=t.elements[x?k:g],R=pY(qh(T)?T:T.contextElement||Dd(t.elements.popper),l,c,s),j=wp(t.elements.reference),D=Sj({reference:j,element:E,placement:i}),B=m_(Object.assign({},E,D)),I=g===ng?B:j,V={top:R.top-I.top+N.top,bottom:I.bottom-R.bottom+N.bottom,left:R.left-I.left+N.left,right:I.right-R.right+N.right},$=t.modifiersData.offset;if(g===ng&&$){var Z=$[i];Object.keys(V).forEach(function(O){var W=[Ro,jo].indexOf(O)>=0?1:-1,F=[Rs,jo].indexOf(O)>=0?"y":"x";V[O]+=Z[F]*W})}return V}function mY(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,s=r.padding,o=r.flipVariations,l=r.allowedAutoPlacements,u=l===void 0?mj:l,c=_p(n),f=c?o?L3:L3.filter(function(x){return _p(x)===c}):bv,g=f.filter(function(x){return u.indexOf(x)>=0});g.length===0&&(g=f);var v=g.reduce(function(x,_){return x[_]=tv(t,{placement:_,boundary:i,rootBoundary:a,padding:s})[Ql(_)],x},{});return Object.keys(v).sort(function(x,_){return v[x]-v[_]})}function gY(t){if(Ql(t)===HS)return[];var e=Q0(t);return[I3(t),e,I3(e)]}function vY(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!0:s,l=r.fallbackPlacements,u=r.padding,c=r.boundary,f=r.rootBoundary,g=r.altBoundary,v=r.flipVariations,x=v===void 0?!0:v,_=r.allowedAutoPlacements,S=e.options.placement,N=Ql(S),k=N===S,E=l||(k||!x?[Q0(S)]:gY(S)),T=[S].concat(E).reduce(function(de,me){return de.concat(Ql(me)===HS?mY(e,{placement:me,boundary:c,rootBoundary:f,padding:u,flipVariations:x,allowedAutoPlacements:_}):me)},[]),R=e.rects.reference,j=e.rects.popper,D=new Map,B=!0,I=T[0],V=0;V<T.length;V++){var $=T[V],Z=Ql($),O=_p($)===xp,W=[Rs,jo].indexOf(Z)>=0,F=W?"width":"height",K=tv(e,{placement:$,boundary:c,rootBoundary:f,altBoundary:g,padding:u}),X=W?O?Ro:Ls:O?jo:Rs;R[F]>j[F]&&(X=Q0(X));var Q=Q0(X),ae=[];if(a&&ae.push(K[Z]<=0),o&&ae.push(K[X]<=0,K[Q]<=0),ae.every(function(de){return de})){I=$,B=!1;break}D.set($,ae)}if(B)for(var re=x?3:1,G=function(me){var ye=T.find(function(ie){var pe=D.get(ie);if(pe)return pe.slice(0,me).every(function(oe){return oe})});if(ye)return I=ye,"break"},te=re;te>0;te--){var ne=G(te);if(ne==="break")break}e.placement!==I&&(e.modifiersData[n]._skip=!0,e.placement=I,e.reset=!0)}}const yY={name:"flip",enabled:!0,phase:"main",fn:vY,requiresIfExists:["offset"],data:{_skip:!1}};function z3(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function F3(t){return[Rs,Ro,jo,Ls].some(function(e){return t[e]>=0})}function xY(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=tv(e,{elementContext:"reference"}),o=tv(e,{altBoundary:!0}),l=z3(s,n),u=z3(o,i,a),c=F3(l),f=F3(u);e.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:c,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":f})}const bY={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:xY};function wY(t,e,r){var n=Ql(t),i=[Ls,Rs].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[Ls,Ro].indexOf(n)>=0?{x:o,y:s}:{x:s,y:o}}function _Y(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,s=mj.reduce(function(c,f){return c[f]=wY(f,e.rects,a),c},{}),o=s[e.placement],l=o.x,u=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[n]=s}const SY={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:_Y};function kY(t){var e=t.state,r=t.name;e.modifiersData[r]=Sj({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const CY={name:"popperOffsets",enabled:!0,phase:"read",fn:kY,data:{}};function EY(t){return t==="x"?"y":"x"}function NY(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!1:s,l=r.boundary,u=r.rootBoundary,c=r.altBoundary,f=r.padding,g=r.tether,v=g===void 0?!0:g,x=r.tetherOffset,_=x===void 0?0:x,S=tv(e,{boundary:l,rootBoundary:u,padding:f,altBoundary:c}),N=Ql(e.placement),k=_p(e.placement),E=!k,T=WS(N),R=EY(T),j=e.modifiersData.popperOffsets,D=e.rects.reference,B=e.rects.popper,I=typeof _=="function"?_(Object.assign({},e.rects,{placement:e.placement})):_,V=typeof I=="number"?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),$=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Z={x:0,y:0};if(j){if(a){var O,W=T==="y"?Rs:Ls,F=T==="y"?jo:Ro,K=T==="y"?"height":"width",X=j[T],Q=X+S[W],ae=X-S[F],re=v?-B[K]/2:0,G=k===xp?D[K]:B[K],te=k===xp?-B[K]:-D[K],ne=e.elements.arrow,de=v&&ne?qS(ne):{width:0,height:0},me=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:xj(),ye=me[W],ie=me[F],pe=Ng(0,D[K],de[K]),oe=E?D[K]/2-re-pe-ye-V.mainAxis:G-pe-ye-V.mainAxis,fe=E?-D[K]/2+re+pe+ie+V.mainAxis:te+pe+ie+V.mainAxis,ge=e.elements.arrow&&wv(e.elements.arrow),be=ge?T==="y"?ge.clientTop||0:ge.clientLeft||0:0,_e=(O=$?.[T])!=null?O:0,De=X+oe-_e-be,qe=X+fe-_e,Ue=Ng(v?sx(Q,De):Q,X,v?jh(ae,qe):ae);j[T]=Ue,Z[T]=Ue-X}if(o){var Ve,Je=T==="x"?Rs:Ls,ft=T==="x"?jo:Ro,We=j[R],Ce=R==="y"?"height":"width",ze=We+S[Je],Ke=We-S[ft],et=[Rs,Ls].indexOf(N)!==-1,ht=(Ve=$?.[R])!=null?Ve:0,Nt=et?ze:We-D[Ce]-B[Ce]-ht+V.altAxis,Mt=et?We+D[Ce]+B[Ce]-ht-V.altAxis:Ke,jt=v&&et?XZ(Nt,We,Mt):Ng(v?Nt:ze,We,v?Mt:Ke);j[R]=jt,Z[R]=jt-We}e.modifiersData[n]=Z}}const TY={name:"preventOverflow",enabled:!0,phase:"main",fn:NY,requiresIfExists:["offset"]};function PY(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function MY(t){return t===Qs(t)||!Ao(t)?$S(t):PY(t)}function AY(t){var e=t.getBoundingClientRect(),r=bp(e.width)/t.offsetWidth||1,n=bp(e.height)/t.offsetHeight||1;return r!==1||n!==1}function jY(t,e,r){r===void 0&&(r=!1);var n=Ao(e),i=Ao(e)&&AY(e),a=Dd(e),s=wp(t,i,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&((ru(e)!=="body"||ZS(a))&&(o=MY(e)),Ao(e)?(l=wp(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=KS(a))),{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}function RY(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!r.has(o)){var l=e.get(o);l&&i(l)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function LY(t){var e=RY(t);return WZ.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function OY(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function DY(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var V3={placement:"bottom",modifiers:[],strategy:"absolute"};function U3(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function IY(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?V3:i;return function(o,l,u){u===void 0&&(u=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},V3,a),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},f=[],g=!1,v={state:c,setOptions:function(N){var k=typeof N=="function"?N(c.options):N;_(),c.options=Object.assign({},a,c.options,k),c.scrollParents={reference:qh(o)?Tg(o):o.contextElement?Tg(o.contextElement):[],popper:Tg(l)};var E=LY(DY([].concat(n,c.options.modifiers)));return c.orderedModifiers=E.filter(function(T){return T.enabled}),x(),v.update()},forceUpdate:function(){if(!g){var N=c.elements,k=N.reference,E=N.popper;if(U3(k,E)){c.rects={reference:jY(k,wv(E),c.options.strategy==="fixed"),popper:qS(E)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(V){return c.modifiersData[V.name]=Object.assign({},V.data)});for(var T=0;T<c.orderedModifiers.length;T++){if(c.reset===!0){c.reset=!1,T=-1;continue}var R=c.orderedModifiers[T],j=R.fn,D=R.options,B=D===void 0?{}:D,I=R.name;typeof j=="function"&&(c=j({state:c,options:B,name:I,instance:v})||c)}}}},update:OY(function(){return new Promise(function(S){v.forceUpdate(),S(c)})}),destroy:function(){_(),g=!0}};if(!U3(o,l))return v;v.setOptions(u).then(function(S){!g&&u.onFirstUpdate&&u.onFirstUpdate(S)});function x(){c.orderedModifiers.forEach(function(S){var N=S.name,k=S.options,E=k===void 0?{}:k,T=S.effect;if(typeof T=="function"){var R=T({state:c,name:N,instance:v,options:E}),j=function(){};f.push(R||j)}})}function _(){f.forEach(function(S){return S()}),f=[]}return v}}var BY=[oY,CY,aY,gj,SY,yY,TY,tY,bY],zY=IY({defaultModifiers:BY}),FY="tippy-box",kj="tippy-content",VY="tippy-backdrop",Cj="tippy-arrow",Ej="tippy-svg-arrow",vh={passive:!0,capture:!0},Nj=function(){return document.body};function s2(t,e,r){if(Array.isArray(t)){var n=t[e];return n??(Array.isArray(r)?r[e]:r)}return t}function YS(t,e){var r={}.toString.call(t);return r.indexOf("[object")===0&&r.indexOf(e+"]")>-1}function Tj(t,e){return typeof t=="function"?t.apply(void 0,e):t}function H3(t,e){if(e===0)return t;var r;return function(n){clearTimeout(r),r=setTimeout(function(){t(n)},e)}}function UY(t){return t.split(/\s+/).filter(Boolean)}function Yf(t){return[].concat(t)}function G3(t,e){t.indexOf(e)===-1&&t.push(e)}function HY(t){return t.filter(function(e,r){return t.indexOf(e)===r})}function GY(t){return t.split("-")[0]}function ox(t){return[].slice.call(t)}function q3(t){return Object.keys(t).reduce(function(e,r){return t[r]!==void 0&&(e[r]=t[r]),e},{})}function Pg(){return document.createElement("div")}function Zx(t){return["Element","Fragment"].some(function(e){return YS(t,e)})}function qY(t){return YS(t,"NodeList")}function WY(t){return YS(t,"MouseEvent")}function $Y(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function KY(t){return Zx(t)?[t]:qY(t)?ox(t):Array.isArray(t)?t:ox(document.querySelectorAll(t))}function o2(t,e){t.forEach(function(r){r&&(r.style.transitionDuration=e+"ms")})}function W3(t,e){t.forEach(function(r){r&&r.setAttribute("data-state",e)})}function ZY(t){var e,r=Yf(t),n=r[0];return n!=null&&(e=n.ownerDocument)!=null&&e.body?n.ownerDocument:document}function YY(t,e){var r=e.clientX,n=e.clientY;return t.every(function(i){var a=i.popperRect,s=i.popperState,o=i.props,l=o.interactiveBorder,u=GY(s.placement),c=s.modifiersData.offset;if(!c)return!0;var f=u==="bottom"?c.top.y:0,g=u==="top"?c.bottom.y:0,v=u==="right"?c.left.x:0,x=u==="left"?c.right.x:0,_=a.top-n+f>l,S=n-a.bottom-g>l,N=a.left-r+v>l,k=r-a.right-x>l;return _||S||N||k})}function l2(t,e,r){var n=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[n](i,r)})}function $3(t,e){for(var r=e;r;){var n;if(t.contains(r))return!0;r=r.getRootNode==null||(n=r.getRootNode())==null?void 0:n.host}return!1}var Yl={isTouch:!1},K3=0;function XY(){Yl.isTouch||(Yl.isTouch=!0,window.performance&&document.addEventListener("mousemove",Pj))}function Pj(){var t=performance.now();t-K3<20&&(Yl.isTouch=!1,document.removeEventListener("mousemove",Pj)),K3=t}function QY(){var t=document.activeElement;if($Y(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function JY(){document.addEventListener("touchstart",XY,vh),window.addEventListener("blur",QY)}var eX=typeof window<"u"&&typeof document<"u",tX=eX?!!window.msCrypto:!1,rX={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},nX={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},cl=Object.assign({appendTo:Nj,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},rX,nX),iX=Object.keys(cl),aX=function(e){var r=Object.keys(e);r.forEach(function(n){cl[n]=e[n]})};function Mj(t){var e=t.plugins||[],r=e.reduce(function(n,i){var a=i.name,s=i.defaultValue;if(a){var o;n[a]=t[a]!==void 0?t[a]:(o=cl[a])!=null?o:s}return n},{});return Object.assign({},t,r)}function sX(t,e){var r=e?Object.keys(Mj(Object.assign({},cl,{plugins:e}))):iX,n=r.reduce(function(i,a){var s=(t.getAttribute("data-tippy-"+a)||"").trim();if(!s)return i;if(a==="content")i[a]=s;else try{i[a]=JSON.parse(s)}catch{i[a]=s}return i},{});return n}function Z3(t,e){var r=Object.assign({},e,{content:Tj(e.content,[t])},e.ignoreAttributes?{}:sX(t,e.plugins));return r.aria=Object.assign({},cl.aria,r.aria),r.aria={expanded:r.aria.expanded==="auto"?e.interactive:r.aria.expanded,content:r.aria.content==="auto"?e.interactive?null:"describedby":r.aria.content},r}var oX=function(){return"innerHTML"};function g_(t,e){t[oX()]=e}function Y3(t){var e=Pg();return t===!0?e.className=Cj:(e.className=Ej,Zx(t)?e.appendChild(t):g_(e,t)),e}function X3(t,e){Zx(e.content)?(g_(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?g_(t,e.content):t.textContent=e.content)}function v_(t){var e=t.firstElementChild,r=ox(e.children);return{box:e,content:r.find(function(n){return n.classList.contains(kj)}),arrow:r.find(function(n){return n.classList.contains(Cj)||n.classList.contains(Ej)}),backdrop:r.find(function(n){return n.classList.contains(VY)})}}function Aj(t){var e=Pg(),r=Pg();r.className=FY,r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1");var n=Pg();n.className=kj,n.setAttribute("data-state","hidden"),X3(n,t.props),e.appendChild(r),r.appendChild(n),i(t.props,t.props);function i(a,s){var o=v_(e),l=o.box,u=o.content,c=o.arrow;s.theme?l.setAttribute("data-theme",s.theme):l.removeAttribute("data-theme"),typeof s.animation=="string"?l.setAttribute("data-animation",s.animation):l.removeAttribute("data-animation"),s.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?l.setAttribute("role",s.role):l.removeAttribute("role"),(a.content!==s.content||a.allowHTML!==s.allowHTML)&&X3(u,t.props),s.arrow?c?a.arrow!==s.arrow&&(l.removeChild(c),l.appendChild(Y3(s.arrow))):l.appendChild(Y3(s.arrow)):c&&l.removeChild(c)}return{popper:e,onUpdate:i}}Aj.$$tippy=!0;var lX=1,L0=[],u2=[];function uX(t,e){var r=Z3(t,Object.assign({},cl,Mj(q3(e)))),n,i,a,s=!1,o=!1,l=!1,u=!1,c,f,g,v=[],x=H3(De,r.interactiveDebounce),_,S=lX++,N=null,k=HY(r.plugins),E={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},T={id:S,reference:t,popper:Pg(),popperInstance:N,props:r,state:E,plugins:k,clearDelayTimeouts:Nt,setProps:Mt,setContent:jt,show:Wt,hide:xt,hideWithInteractivity:st,enable:et,disable:ht,unmount:Ge,destroy:ue};if(!r.render)return T;var R=r.render(T),j=R.popper,D=R.onUpdate;j.setAttribute("data-tippy-root",""),j.id="tippy-"+T.id,T.popper=j,t._tippy=T,j._tippy=T;var B=k.map(function(ve){return ve.fn(T)}),I=t.hasAttribute("aria-expanded");return ge(),re(),X(),Q("onCreate",[T]),r.showOnCreate&&ze(),j.addEventListener("mouseenter",function(){T.props.interactive&&T.state.isVisible&&T.clearDelayTimeouts()}),j.addEventListener("mouseleave",function(){T.props.interactive&&T.props.trigger.indexOf("mouseenter")>=0&&W().addEventListener("mousemove",x)}),T;function V(){var ve=T.props.touch;return Array.isArray(ve)?ve:[ve,0]}function $(){return V()[0]==="hold"}function Z(){var ve;return!!((ve=T.props.render)!=null&&ve.$$tippy)}function O(){return _||t}function W(){var ve=O().parentNode;return ve?ZY(ve):document}function F(){return v_(j)}function K(ve){return T.state.isMounted&&!T.state.isVisible||Yl.isTouch||c&&c.type==="focus"?0:s2(T.props.delay,ve?0:1,cl.delay)}function X(ve){ve===void 0&&(ve=!1),j.style.pointerEvents=T.props.interactive&&!ve?"":"none",j.style.zIndex=""+T.props.zIndex}function Q(ve,ke,Ne){if(Ne===void 0&&(Ne=!0),B.forEach(function(Ze){Ze[ve]&&Ze[ve].apply(Ze,ke)}),Ne){var je;(je=T.props)[ve].apply(je,ke)}}function ae(){var ve=T.props.aria;if(ve.content){var ke="aria-"+ve.content,Ne=j.id,je=Yf(T.props.triggerTarget||t);je.forEach(function(Ze){var He=Ze.getAttribute(ke);if(T.state.isVisible)Ze.setAttribute(ke,He?He+" "+Ne:Ne);else{var ut=He&&He.replace(Ne,"").trim();ut?Ze.setAttribute(ke,ut):Ze.removeAttribute(ke)}})}}function re(){if(!(I||!T.props.aria.expanded)){var ve=Yf(T.props.triggerTarget||t);ve.forEach(function(ke){T.props.interactive?ke.setAttribute("aria-expanded",T.state.isVisible&&ke===O()?"true":"false"):ke.removeAttribute("aria-expanded")})}}function G(){W().removeEventListener("mousemove",x),L0=L0.filter(function(ve){return ve!==x})}function te(ve){if(!(Yl.isTouch&&(l||ve.type==="mousedown"))){var ke=ve.composedPath&&ve.composedPath()[0]||ve.target;if(!(T.props.interactive&&$3(j,ke))){if(Yf(T.props.triggerTarget||t).some(function(Ne){return $3(Ne,ke)})){if(Yl.isTouch||T.state.isVisible&&T.props.trigger.indexOf("click")>=0)return}else Q("onClickOutside",[T,ve]);T.props.hideOnClick===!0&&(T.clearDelayTimeouts(),T.hide(),o=!0,setTimeout(function(){o=!1}),T.state.isMounted||ye())}}}function ne(){l=!0}function de(){l=!1}function me(){var ve=W();ve.addEventListener("mousedown",te,!0),ve.addEventListener("touchend",te,vh),ve.addEventListener("touchstart",de,vh),ve.addEventListener("touchmove",ne,vh)}function ye(){var ve=W();ve.removeEventListener("mousedown",te,!0),ve.removeEventListener("touchend",te,vh),ve.removeEventListener("touchstart",de,vh),ve.removeEventListener("touchmove",ne,vh)}function ie(ve,ke){oe(ve,function(){!T.state.isVisible&&j.parentNode&&j.parentNode.contains(j)&&ke()})}function pe(ve,ke){oe(ve,ke)}function oe(ve,ke){var Ne=F().box;function je(Ze){Ze.target===Ne&&(l2(Ne,"remove",je),ke())}if(ve===0)return ke();l2(Ne,"remove",f),l2(Ne,"add",je),f=je}function fe(ve,ke,Ne){Ne===void 0&&(Ne=!1);var je=Yf(T.props.triggerTarget||t);je.forEach(function(Ze){Ze.addEventListener(ve,ke,Ne),v.push({node:Ze,eventType:ve,handler:ke,options:Ne})})}function ge(){$()&&(fe("touchstart",_e,{passive:!0}),fe("touchend",qe,{passive:!0})),UY(T.props.trigger).forEach(function(ve){if(ve!=="manual")switch(fe(ve,_e),ve){case"mouseenter":fe("mouseleave",qe);break;case"focus":fe(tX?"focusout":"blur",Ue);break;case"focusin":fe("focusout",Ue);break}})}function be(){v.forEach(function(ve){var ke=ve.node,Ne=ve.eventType,je=ve.handler,Ze=ve.options;ke.removeEventListener(Ne,je,Ze)}),v=[]}function _e(ve){var ke,Ne=!1;if(!(!T.state.isEnabled||Ve(ve)||o)){var je=((ke=c)==null?void 0:ke.type)==="focus";c=ve,_=ve.currentTarget,re(),!T.state.isVisible&&WY(ve)&&L0.forEach(function(Ze){return Ze(ve)}),ve.type==="click"&&(T.props.trigger.indexOf("mouseenter")<0||s)&&T.props.hideOnClick!==!1&&T.state.isVisible?Ne=!0:ze(ve),ve.type==="click"&&(s=!Ne),Ne&&!je&&Ke(ve)}}function De(ve){var ke=ve.target,Ne=O().contains(ke)||j.contains(ke);if(!(ve.type==="mousemove"&&Ne)){var je=Ce().concat(j).map(function(Ze){var He,ut=Ze._tippy,lt=(He=ut.popperInstance)==null?void 0:He.state;return lt?{popperRect:Ze.getBoundingClientRect(),popperState:lt,props:r}:null}).filter(Boolean);YY(je,ve)&&(G(),Ke(ve))}}function qe(ve){var ke=Ve(ve)||T.props.trigger.indexOf("click")>=0&&s;if(!ke){if(T.props.interactive){T.hideWithInteractivity(ve);return}Ke(ve)}}function Ue(ve){T.props.trigger.indexOf("focusin")<0&&ve.target!==O()||T.props.interactive&&ve.relatedTarget&&j.contains(ve.relatedTarget)||Ke(ve)}function Ve(ve){return Yl.isTouch?$()!==ve.type.indexOf("touch")>=0:!1}function Je(){ft();var ve=T.props,ke=ve.popperOptions,Ne=ve.placement,je=ve.offset,Ze=ve.getReferenceClientRect,He=ve.moveTransition,ut=Z()?v_(j).arrow:null,lt=Ze?{getBoundingClientRect:Ze,contextElement:Ze.contextElement||O()}:t,_t={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(vt){var Ht=vt.state;if(Z()){var qt=F(),Sr=qt.box;["placement","reference-hidden","escaped"].forEach(function(fr){fr==="placement"?Sr.setAttribute("data-placement",Ht.placement):Ht.attributes.popper["data-popper-"+fr]?Sr.setAttribute("data-"+fr,""):Sr.removeAttribute("data-"+fr)}),Ht.attributes.popper={}}}},Bt=[{name:"offset",options:{offset:je}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!He}},_t];Z()&&ut&&Bt.push({name:"arrow",options:{element:ut,padding:3}}),Bt.push.apply(Bt,ke?.modifiers||[]),T.popperInstance=zY(lt,j,Object.assign({},ke,{placement:Ne,onFirstUpdate:g,modifiers:Bt}))}function ft(){T.popperInstance&&(T.popperInstance.destroy(),T.popperInstance=null)}function We(){var ve=T.props.appendTo,ke,Ne=O();T.props.interactive&&ve===Nj||ve==="parent"?ke=Ne.parentNode:ke=Tj(ve,[Ne]),ke.contains(j)||ke.appendChild(j),T.state.isMounted=!0,Je()}function Ce(){return ox(j.querySelectorAll("[data-tippy-root]"))}function ze(ve){T.clearDelayTimeouts(),ve&&Q("onTrigger",[T,ve]),me();var ke=K(!0),Ne=V(),je=Ne[0],Ze=Ne[1];Yl.isTouch&&je==="hold"&&Ze&&(ke=Ze),ke?n=setTimeout(function(){T.show()},ke):T.show()}function Ke(ve){if(T.clearDelayTimeouts(),Q("onUntrigger",[T,ve]),!T.state.isVisible){ye();return}if(!(T.props.trigger.indexOf("mouseenter")>=0&&T.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(ve.type)>=0&&s)){var ke=K(!1);ke?i=setTimeout(function(){T.state.isVisible&&T.hide()},ke):a=requestAnimationFrame(function(){T.hide()})}}function et(){T.state.isEnabled=!0}function ht(){T.hide(),T.state.isEnabled=!1}function Nt(){clearTimeout(n),clearTimeout(i),cancelAnimationFrame(a)}function Mt(ve){if(!T.state.isDestroyed){Q("onBeforeUpdate",[T,ve]),be();var ke=T.props,Ne=Z3(t,Object.assign({},ke,q3(ve),{ignoreAttributes:!0}));T.props=Ne,ge(),ke.interactiveDebounce!==Ne.interactiveDebounce&&(G(),x=H3(De,Ne.interactiveDebounce)),ke.triggerTarget&&!Ne.triggerTarget?Yf(ke.triggerTarget).forEach(function(je){je.removeAttribute("aria-expanded")}):Ne.triggerTarget&&t.removeAttribute("aria-expanded"),re(),X(),D&&D(ke,Ne),T.popperInstance&&(Je(),Ce().forEach(function(je){requestAnimationFrame(je._tippy.popperInstance.forceUpdate)})),Q("onAfterUpdate",[T,ve])}}function jt(ve){T.setProps({content:ve})}function Wt(){var ve=T.state.isVisible,ke=T.state.isDestroyed,Ne=!T.state.isEnabled,je=Yl.isTouch&&!T.props.touch,Ze=s2(T.props.duration,0,cl.duration);if(!(ve||ke||Ne||je)&&!O().hasAttribute("disabled")&&(Q("onShow",[T],!1),T.props.onShow(T)!==!1)){if(T.state.isVisible=!0,Z()&&(j.style.visibility="visible"),X(),me(),T.state.isMounted||(j.style.transition="none"),Z()){var He=F(),ut=He.box,lt=He.content;o2([ut,lt],0)}g=function(){var Bt;if(!(!T.state.isVisible||u)){if(u=!0,j.offsetHeight,j.style.transition=T.props.moveTransition,Z()&&T.props.animation){var zt=F(),vt=zt.box,Ht=zt.content;o2([vt,Ht],Ze),W3([vt,Ht],"visible")}ae(),re(),G3(u2,T),(Bt=T.popperInstance)==null||Bt.forceUpdate(),Q("onMount",[T]),T.props.animation&&Z()&&pe(Ze,function(){T.state.isShown=!0,Q("onShown",[T])})}},We()}}function xt(){var ve=!T.state.isVisible,ke=T.state.isDestroyed,Ne=!T.state.isEnabled,je=s2(T.props.duration,1,cl.duration);if(!(ve||ke||Ne)&&(Q("onHide",[T],!1),T.props.onHide(T)!==!1)){if(T.state.isVisible=!1,T.state.isShown=!1,u=!1,s=!1,Z()&&(j.style.visibility="hidden"),G(),ye(),X(!0),Z()){var Ze=F(),He=Ze.box,ut=Ze.content;T.props.animation&&(o2([He,ut],je),W3([He,ut],"hidden"))}ae(),re(),T.props.animation?Z()&&ie(je,T.unmount):T.unmount()}}function st(ve){W().addEventListener("mousemove",x),G3(L0,x),x(ve)}function Ge(){T.state.isVisible&&T.hide(),T.state.isMounted&&(ft(),Ce().forEach(function(ve){ve._tippy.unmount()}),j.parentNode&&j.parentNode.removeChild(j),u2=u2.filter(function(ve){return ve!==T}),T.state.isMounted=!1,Q("onHidden",[T]))}function ue(){T.state.isDestroyed||(T.clearDelayTimeouts(),T.unmount(),be(),delete t._tippy,T.state.isDestroyed=!0,Q("onDestroy",[T]))}}function _v(t,e){e===void 0&&(e={});var r=cl.plugins.concat(e.plugins||[]);JY();var n=Object.assign({},e,{plugins:r}),i=KY(t),a=i.reduce(function(s,o){var l=o&&uX(o,n);return l&&s.push(l),s},[]);return Zx(t)?a[0]:a}_v.defaultProps=cl;_v.setDefaultProps=aX;_v.currentInput=Yl;Object.assign({},gj,{effect:function(e){var r=e.state,n={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(r.elements.popper.style,n.popper),r.styles=n,r.elements.arrow&&Object.assign(r.elements.arrow.style,n.arrow)}});_v.setDefaultProps({render:Aj});const cX=ce.forwardRef((t,e)=>{const[r,n]=ce.useState(0),i=l=>{const u=t.items[l];u&&t.command({id:u.id,label:u.label})},a=()=>{n((r+t.items.length-1)%t.items.length)},s=()=>{n((r+1)%t.items.length)},o=()=>{i(r)};return ce.useEffect(()=>n(0),[t.items]),ce.useImperativeHandle(e,()=>({onKeyDown:({event:l})=>l.key==="ArrowUp"?(a(),!0):l.key==="ArrowDown"?(s(),!0):l.key==="Enter"?(o(),!0):!1})),p.jsx("div",{className:"items bg-popover border border-border rounded-md shadow-lg overflow-hidden min-w-[200px] p-1",children:t.items.length?t.items.map((l,u)=>p.jsx("button",{className:`flex w-full items-center text-sm px-2 py-1.5 rounded-sm outline-none text-left ${u===r?"bg-accent text-accent-foreground":"text-popover-foreground"}`,onClick:()=>i(u),children:l.label},u)):p.jsx("div",{className:"item text-sm px-2 py-1.5 text-muted-foreground",children:"No result"})})}),dX={items:async({query:t})=>{try{return(await it.get("/world-bible/entities")).filter(r=>r.nombre.toLowerCase().startsWith(t.toLowerCase())).slice(0,5).map(r=>({id:r.id,label:r.nombre}))}catch(e){return console.error(e),[]}},render:()=>{let t,e;return{onStart:r=>{t=new q$(cX,{props:r,editor:r.editor}),r.clientRect&&(e=_v("body",{getReferenceClientRect:r.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(r){t.updateProps(r),r.clientRect&&e[0].setProps({getReferenceClientRect:r.clientRect})},onKeyDown(r){return r.event.key==="Escape"?(e[0].hide(),!0):t.ref?.onKeyDown(r)},onExit(){e[0].destroy(),t.destroy()}}}},hX=({content:t,onUpdate:e,editable:r=!0})=>{const n=B$({extensions:[NZ,TZ.configure({placeholder:"Escribe tu historia aqu... Usa @ para mencionar entidades."}),LZ.configure({HTMLAttributes:{class:"mention"},suggestion:dX})],content:t,editable:r,onUpdate:({editor:i})=>{e(i.getHTML())},editorProps:{attributes:{class:"prose prose-invert max-w-none focus:outline-none min-h-[300px] p-4 text-foreground/90 leading-relaxed font-serif text-lg"}}});return ce.useEffect(()=>{n&&t!==n.getHTML()&&n.commands.setContent(t)},[t,n]),n?p.jsxs("div",{className:"zen-editor-container w-full h-full overflow-y-auto no-scrollbar bg-card/20 rounded-lg border border-border/50",children:[p.jsx(A$,{editor:n,className:"h-full"}),p.jsx("style",{jsx:!0,global:!0,children:`
        .mention {
          @apply bg-primary/20 text-primary-light font-medium rounded-sm px-1 py-0.5 cursor-pointer hover:bg-primary/30 decoration-clone;
        }
        .tiptap p.is-editor-empty:first-child::before {
          color: #6b7280;
          content: attr(data-placeholder);
          float: left;
          height: 0;
          pointer-events: none;
        }
      `})]}):null},Q3=()=>{const{notebookId:t}=ds(),e=Ga(),{setRightPanelMode:r,setRightOpen:n}=Zu(),[i,a]=ce.useState(null),[s,o]=ce.useState([]),[l,u]=ce.useState(0),[c,f]=ce.useState(!1),[g,v]=ce.useState(!0),x=ce.useRef(null),[_,S]=ce.useState(null);ce.useEffect(()=>{r("NOTES"),n(!0),t?k(t):N()},[t]);const N=async()=>{try{v(!0);const I=await it.get("/escritura/cuadernos");I&&I.length>0?k(I[0].id):(console.warn("No notebook found for this project."),e(-1))}catch(I){console.error("Error fetching default notebook:",I),e(-1)}};ce.useEffect(()=>{const I=setInterval(()=>{const V=document.getElementById("architect-right-panel-portal");V&&(S(V),clearInterval(I))},100);return()=>clearInterval(I)},[]);const k=async I=>{try{v(!0);const V=await it.get(`/escritura/cuaderno/${I}`);a(V);const $=await it.get(`/escritura/cuaderno/${I}/hojas`);if($&&$.length>0)o($),u(0);else{const Z=await it.post(`/escritura/cuaderno/${I}/hoja`,{});o([Z]),u(0)}}catch(V){console.error("Error loading notebook/pages:",V),e(-1)}finally{v(!1)}},E=I=>{if(!s[l])return;const V=[...s];V[l].contenido=I,o(V),x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{T(V[l])},1500)},T=async I=>{f(!0);try{await it.put(`/escritura/hoja/${I.id}`,{contenido:I.contenido})}catch(V){console.error("Error saving page:",V)}finally{f(!1)}},R=async()=>{if(i)try{const I=await it.post(`/escritura/cuaderno/${i.id}/hoja`,{});o([...s,I]),u(s.length)}catch(I){console.error("Error creating page:",I)}},j=I=>{u(I)},D=()=>p.jsxs("div",{className:"flex flex-col h-full bg-[#08080A]",children:[p.jsxs("div",{className:"h-12 border-b border-white/5 flex items-center px-4 font-mono text-[10px] uppercase tracking-widest text-slate-500",children:["Library Index  ",s.length," Pages"]}),p.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:s.map((I,V)=>p.jsxs("button",{onClick:()=>j(V),className:`w-full text-left p-3 rounded-lg border transition-all group ${V===l?"bg-indigo-500/10 border-indigo-500/30 text-indigo-200":"bg-transparent border-transparent hover:bg-white/5 text-slate-400"}`,children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsxs("span",{className:"font-serif font-bold text-sm truncate",children:["Page ",I.numeroPagina]}),V===l&&p.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 shrink-0 ml-2"})]}),p.jsx("p",{className:"text-[10px] line-clamp-2 opacity-50 font-mono break-words",children:I.contenido?.replace(/<[^>]+>/g,"").substring(0,50)||"Empty page..."})]},I.id))}),p.jsx("div",{className:"p-4 border-t border-white/5",children:p.jsxs("button",{onClick:R,className:"w-full py-2 bg-white/5 hover:bg-white/10 border border-white/5 rounded-lg text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[p.jsx("span",{className:"material-symbols-outlined text-base",children:"add"}),p.jsx("span",{children:"New Page"})]})})]}),B=s[l];return g?p.jsx("div",{className:"flex-1 flex items-center justify-center bg-[#050508]",children:p.jsx("div",{className:"animate-pulse text-slate-500 font-mono",children:"Opening chronicle..."})}):p.jsxs("div",{className:"flex-1 flex w-full h-full bg-[#050508] relative overflow-hidden",children:[_&&nu.createPortal(D(),_),p.jsxs("div",{className:"flex-1 flex flex-col relative z-10",children:[p.jsxs("header",{className:"h-12 border-b border-white/5 bg-surface-dark/40 backdrop-blur-md flex items-center justify-between px-6 select-none",children:[p.jsxs("div",{className:"flex items-center gap-4 text-xs font-serif text-slate-400",children:[p.jsxs("button",{onClick:()=>e(-1),className:"hover:text-white transition-colors flex items-center gap-1",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"}),"Biblioteca"]}),p.jsx("span",{className:"opacity-20",children:"|"}),p.jsx("span",{className:"text-slate-300 font-bold tracking-wide",children:i?.titulo})]}),p.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-slate-500",children:[p.jsx("span",{children:c?"Saving...":"All Changes Saved"}),p.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${c?"bg-amber-500 animate-pulse":"bg-emerald-500/50"}`})]})]}),p.jsx("main",{className:"flex-1 overflow-y-auto custom-scrollbar flex justify-center bg-[#101012] relative",children:B&&p.jsxs("div",{className:"w-full max-w-3xl py-12 px-8 min-h-full flex flex-col",children:[p.jsx("input",{type:"text",className:"w-full bg-transparent text-4xl font-serif font-bold text-slate-200 placeholder:text-slate-700 border-none outline-none mb-8 text-center",defaultValue:`Page ${B.numeroPagina}`,readOnly:!0}),p.jsx("div",{className:"flex-1 bg-white/5 border border-white/5 rounded-sm shadow-2xl shadow-black/50 overflow-hidden relative",children:p.jsx(hX,{content:B.contenido,onUpdate:E})})]})})]})]})};function fX(){const{id:t}=ds();Ga();const[e,r]=ce.useState([]),[n,i]=ce.useState(!0),[a,s]=ce.useState(null);ce.useEffect(()=>{o()},[t]);const o=async()=>{try{i(!0);const c=await it.get("/api/papelera/items");r(c),s(null)}catch(c){console.error("Error loading trash:",c),s("Failed to load trash items.")}finally{i(!1)}},l=async(c,f)=>{try{await it.post(`/api/papelera/restaurar/${c}/${f}`),o()}catch(g){console.error("Restoration failed",g)}},u=async(c,f)=>{if(window.confirm("Are you sure you want to PERMANENTLY delete this item? This cannot be undone."))try{await it.delete(`/api/papelera/eliminar/${c}/${f}`),o()}catch(g){console.error("Deletion failed",g)}};return n?p.jsx("div",{className:"text-white p-8",children:"Loading Trash Bin..."}):p.jsxs("div",{className:"flex flex-col h-full bg-[#09090b] text-white p-8 overflow-y-auto",children:[p.jsx("h1",{className:"text-3xl font-light mb-2 text-white/90",children:"Trash Bin"}),p.jsx("p",{className:"text-white/50 mb-8 font-light text-sm",children:"Items are automatically deleted after 30 days."}),a&&p.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 p-4 rounded mb-6",children:a}),e.length===0?p.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-50 border border-dashed border-white/10 rounded-xl",children:[p.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"delete_outline"}),p.jsx("p",{children:"Trash is empty"})]}):p.jsx("div",{className:"bg-zinc-900/50 rounded-xl border border-white/5 overflow-hidden",children:p.jsxs("table",{className:"w-full text-left border-collapse",children:[p.jsx("thead",{children:p.jsxs("tr",{className:"border-b border-white/5 text-xs text-white/40 uppercase tracking-wider",children:[p.jsx("th",{className:"p-4 font-normal",children:"Name"}),p.jsx("th",{className:"p-4 font-normal",children:"Type"}),p.jsx("th",{className:"p-4 font-normal",children:"Deleted Date"}),p.jsx("th",{className:"p-4 font-normal text-right",children:"Actions"})]})}),p.jsx("tbody",{className:"divide-y divide-white/5",children:e.map(c=>p.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[p.jsx("td",{className:"p-4 text-white/80 font-medium",children:c.nombre||"Untitled"}),p.jsx("td",{className:"p-4 text-white/50 text-sm",children:c.tipo}),p.jsx("td",{className:"p-4 text-white/50 text-sm font-mono",children:c.deleted_date?new Date(c.deleted_date).toLocaleDateString():"-"}),p.jsxs("td",{className:"p-4 text-right space-x-2",children:[p.jsx("button",{onClick:()=>l(c.tipo,c.id),className:"px-3 py-1.5 text-xs bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20 rounded-md transition-colors border border-emerald-500/20",children:"RESTORE"}),p.jsx("button",{onClick:()=>u(c.tipo,c.id),className:"px-3 py-1.5 text-xs bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-md transition-colors border border-red-500/20",children:"DELETE"})]})]},`${c.tipo}-${c.id}`))})]})})]})}const pX=({attribute:t,value:e,onChange:r,onRemove:n,linkableEntities:i=[]})=>{const a=t.plantilla||t,s=()=>{switch(a.tipo){case"text":return p.jsx("textarea",{className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none resize-none no-scrollbar h-auto min-h-[100px]",value:e||"",onChange:g=>r(g.target.value),placeholder:"..."});case"short_text":return p.jsx("input",{type:"text",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none",value:e||"",onChange:g=>r(g.target.value),placeholder:"..."});case"number":return p.jsx("input",{type:"number",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none",value:e||"",onChange:g=>r(g.target.value)});case"boolean":return p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("button",{onClick:()=>r(e==="true"?"false":"true"),className:`size-6 rounded-lg border flex items-center justify-center transition-all ${e==="true"?"bg-primary border-primary text-white":"border-glass-border text-transparent hover:border-primary/50"}`,children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"check"})}),p.jsx("span",{className:"text-xs text-text-muted",children:e==="true"?"Enabled":"Disabled"})]});case"select":let o=[];try{o=(typeof a.metadata=="string"?JSON.parse(a.metadata||"{}"):a.metadata||{}).options||[]}catch{}return p.jsxs("div",{className:"relative",children:[p.jsxs("select",{className:"w-full bg-black/30 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-primary/50 appearance-none cursor-pointer",value:e||"",onChange:g=>r(g.target.value),children:[p.jsx("option",{value:"",children:"Select an option..."}),o.map((g,v)=>p.jsx("option",{value:g,className:"bg-surface-dark text-white p-2",children:g},v))]}),p.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/50",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"unfold_more"})})]});case"multi_select":let l=[];try{l=(typeof a.metadata=="string"?JSON.parse(a.metadata||"{}"):a.metadata||{}).options||[]}catch{}let u=[];try{u=e?JSON.parse(e):[],Array.isArray(u)||(u=[])}catch(g){console.error("Error parsing select values",g)}const c=g=>{const v=u.includes(g)?u.filter(x=>x!==g):[...u,g];r(JSON.stringify(v))};return p.jsxs("div",{className:"bg-black/20 border border-white/5 rounded-xl p-2 space-y-1 max-h-40 overflow-y-auto custom-scrollbar",children:[l.map((g,v)=>p.jsxs("label",{onClick:x=>{x.preventDefault(),c(g)},className:"flex items-center gap-3 p-2 hover:bg-white/5 rounded-lg cursor-pointer group transition-colors",children:[p.jsx("div",{className:`size-4 rounded border flex items-center justify-center transition-all ${u.includes(g)?"bg-primary border-primary":"border-white/10 group-hover:border-white/30"}`,children:u.includes(g)&&p.jsx("span",{className:"material-symbols-outlined text-[10px] text-white",children:"check"})}),p.jsx("span",{className:`text-xs font-medium ${u.includes(g)?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:g})]},v)),l.length===0&&p.jsx("div",{className:"text-xs text-slate-500 p-2 italic",children:"No options defined."})]});case"date":return p.jsx("input",{type:"date",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none [color-scheme:dark]",value:e||"",onChange:g=>r(g.target.value)});case"entity_link":return p.jsxs("div",{className:"relative",children:[p.jsxs("select",{className:"w-full bg-black/30 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-primary/50 appearance-none cursor-pointer",value:e||"",onChange:g=>r(g.target.value),children:[p.jsx("option",{value:"",children:"Select an Entity Link..."}),i.map(g=>p.jsx("option",{value:g.id,className:"bg-surface-dark text-white p-2",children:g.nombre},g.id))]}),p.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/50",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"link"})})]});case"image":return p.jsxs("div",{className:"space-y-2",children:[p.jsx("div",{className:"flex gap-2",children:p.jsx("input",{type:"text",className:"flex-1 bg-black/30 border border-white/5 rounded-xl px-4 py-2 text-xs text-text-muted focus:text-white focus:outline-none",placeholder:"Image URL...",value:e||"",onChange:g=>r(g.target.value)})}),e&&p.jsx("div",{className:"w-full aspect-video rounded-xl bg-black/40 border border-white/5 overflow-hidden relative group",children:p.jsx("img",{src:e,alt:"Preview",className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"})}),!e&&p.jsx("div",{className:"w-full h-20 rounded-xl bg-white/5 border border-dashed border-white/10 flex items-center justify-center text-text-muted/30",children:p.jsx("span",{className:"material-symbols-outlined",children:"image"})})]});case"table":const f=e||"[]";return p.jsxs("div",{className:"space-y-2",children:[p.jsx("textarea",{className:"w-full h-32 bg-black/30 border border-white/5 rounded-xl p-3 text-xs font-mono text-white/70 focus:outline-none focus:border-primary/50",value:f,onChange:g=>r(g.target.value),placeholder:'[{"Item": "Sword", "Qty": 1}, ...]'}),p.jsxs("div",{className:"text-[10px] text-text-muted flex justify-between",children:[p.jsx("span",{children:"JSON Format supported"}),p.jsx("span",{className:"material-symbols-outlined text-xs",children:"data_array"})]})]});default:return p.jsxs("div",{className:"text-sm font-medium text-white/70 italic p-2 rounded-lg bg-white/5 border border-white/5",children:[p.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 mr-2",children:a.tipo}),e]})}};return p.jsxs("div",{className:"p-4 border border-white/5 rounded-2xl bg-surface-dark/50 backdrop-blur-sm relative overflow-hidden h-full flex flex-col group hover:border-primary/20 transition-all",children:[p.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted mb-3 flex items-center justify-between gap-2",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-xs opacity-50",children:"label"}),a.nombre]}),n&&p.jsx("button",{onClick:o=>{o.preventDefault(),n()},className:"text-white/20 hover:text-red-400 transition-colors",title:"Remove Attribute",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]}),p.jsx("div",{className:"flex-1 nodrag",children:s()}),p.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"})]})},mX=[{value:"Individual",label:"Personaje"},{value:"Group",label:"Grupo/Faccin"},{value:"Location",label:"Lugar"},{value:"Item",label:"Objeto"},{value:"Event",label:"Evento"},{value:"Timeline",label:"Lnea de Tiempo"},{value:"Map",label:"Mapa"},{value:"Structure",label:"Construccin"},{value:"Creature",label:"Criatura"},{value:"Plant",label:"Flora"}],gX=({entityId:t,entityType:e})=>{console.log(">>> RELATIONSHIP MANAGER V2 LOADED");const[r,n]=ce.useState([]),[i,a]=ce.useState(!1),[s,o]=ce.useState(!1),[l,u]=ce.useState("Individual"),[c,f]=ce.useState([]),[g,v]=ce.useState(""),[x,_]=ce.useState(""),[S,N]=ce.useState(""),[k,E]=ce.useState(!1);ce.useEffect(()=>{t&&T()},[t,e]),ce.useEffect(()=>{s&&l&&R(l)},[s,l]);const T=async()=>{a(!0);try{const V=(await it.get("/bd/relacion")).filter(Z=>Z.nodoOrigenId===parseInt(t)&&(Z.tipoOrigen===e||Z.tipoOrigen==="GenericEntity")||Z.nodoDestinoId===parseInt(t)&&(Z.tipoDestino===e||Z.tipoDestino==="GenericEntity")),$=await Promise.all(V.map(async Z=>{const O=Z.nodoOrigenId===parseInt(t),W=O?Z.nodoDestinoId:Z.nodoOrigenId,F=await it.get(`/world-bible/entities/${W}`);if(!F)throw new Error(`Entity ${W} not found`);return{...Z,otherName:F.nombre,otherType:F.categoria||"Entity",isOutgoing:O}}));n($)}catch(I){console.error("Failed to load relationships",I)}finally{a(!1)}},R=async I=>{E(!0);try{const $=(await it.get("/world-bible/entities")).filter(Z=>(Z.categoria||"Generic").toLowerCase()===I.toLowerCase()||Z.tipoEspecial&&Z.tipoEspecial.toLowerCase()===I.toLowerCase());f($||[])}catch(V){console.error("Failed to fetch targets",V),f([])}finally{E(!1)}},j=async()=>{if(!(!g||!x))try{const I={nodoOrigenId:parseInt(t),tipoOrigen:e,nodoDestinoId:parseInt(g),tipoDestino:"GenericEntity",tipoRelacion:x,descripcion:S,metadata:JSON.stringify({originalCategory:l}),tipoEntidad:"relacion"};await it.put("/bd/insertar",I),o(!1),B(),T()}catch(I){console.error("Failed to save relationship",I),alert("Error saving relationship")}},D=async I=>{if(confirm("Are you sure?"))try{await it.delete(`/bd/relacion/${I}`),T()}catch(V){console.error("Failed to delete",V)}},B=()=>{u("Individual"),v(""),_(""),N("")};return p.jsxs("div",{className:"p-6 space-y-6",children:[p.jsxs("header",{className:"flex justify-between items-center",children:[p.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-widest",children:"Relationships"}),p.jsx(rn,{variant:"secondary",icon:"add_link",onClick:()=>o(!s),children:s?"Cancel":"Connect"})]}),s&&p.jsxs("div",{className:"p-4 rounded-2xl bg-white/5 border border-white/10 space-y-4 animate-in fade-in slide-in-from-top-4",children:[p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{className:"space-y-1",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Target Type"}),p.jsx("select",{className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:l,onChange:I=>u(I.target.value),children:mX.map(I=>p.jsx("option",{value:I.value,children:I.label},I.value))})]}),p.jsxs("div",{className:"space-y-1",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Target Entity"}),p.jsxs("select",{className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:g,onChange:I=>v(I.target.value),disabled:k,children:[p.jsx("option",{value:"",children:"Select Target..."}),c.map(I=>p.jsx("option",{value:I.id,children:I.nombre},I.id))]})]})]}),p.jsxs("div",{className:"space-y-1",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Relationship Type"}),p.jsx("input",{type:"text",placeholder:"e.g. Father of, Located in, Enemy of...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:x,onChange:I=>_(I.target.value)})]}),p.jsxs("div",{className:"space-y-1",children:[p.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Description (The Why)"}),p.jsx("textarea",{placeholder:"Explain the nature of this connection...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary h-20 resize-none",value:S,onChange:I=>N(I.target.value)})]}),p.jsx("div",{className:"flex justify-end pt-2",children:p.jsx(rn,{variant:"primary",icon:"save",onClick:j,disabled:!g||!x,children:"Save Connection"})})]}),p.jsx("div",{className:"space-y-3",children:i?p.jsx("div",{className:"text-center text-slate-500 py-8",children:"Scanning connections..."}):r.length===0?p.jsx("div",{className:"text-center text-slate-500 py-8 italic border border-dashed border-white/10 rounded-2xl",children:"No connections established"}):r.map((I,V)=>p.jsxs("div",{className:"group relative p-4 rounded-2xl bg-surface-dark border border-white/5 hover:border-primary/50 transition-all flex items-start gap-4",children:[p.jsx("div",{className:"mt-1",children:p.jsx("span",{className:"material-symbols-outlined text-slate-500",children:I.isOutgoing?"arrow_outward":"arrow_inward"})}),p.jsxs("div",{className:"flex-1",children:[p.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[p.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:I.isOutgoing?"To:":"From:"}),p.jsx("span",{className:"text-sm font-bold text-white",children:I.otherName}),p.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-white/10 text-slate-400 font-bold uppercase tracking-wider",children:I.otherType})]}),p.jsx("div",{className:"text-primary text-xs font-black uppercase tracking-widest mb-2",children:I.tipoRelacion}),I.descripcion&&p.jsxs("p",{className:"text-xs text-slate-400 leading-relaxed bg-black/20 p-2 rounded-lg border border-white/5",children:['"',I.descripcion,'"']})]}),p.jsx("button",{onClick:()=>D(I.id),className:"opacity-0 group-hover:opacity-100 p-2 text-slate-600 hover:text-red-400 transition-all",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},I.id||V))})]})},ig=({mode:t})=>{const{username:e,projectName:r,entitySlug:n,folderSlug:i,type:a}=ds(),s=Ga(),o=t==="creation",{setRightOpen:l,setAvailableTemplates:u,setRightPanelMode:c,setAddAttributeHandler:f,setEntityTabs:g,activeEntityTab:v,setActiveEntityTab:x}=Zu(),[_,S]=ce.useState({nombre:"",tipo:"entidadindividual",descripcion:"",color:"#6366f1",apariencia:"",notas:"",iconUrl:null,tipoEspecial:a||null,carpeta:null,categoria:"Individual"}),[N,k]=ce.useState([]),[E,T]=ce.useState(!0),[R,j]=ce.useState(!1),[D,B]=ce.useState([]),[I,V]=ce.useState([]),[$,Z]=ce.useState(!1);ce.useEffect(()=>(l(!0),c("ENTITY"),g(["identity","narrative","attributes"]),x("identity"),()=>{c("NOTES"),g([])}),[]),ce.useEffect(()=>{o?W():F()},[n,i,o]);const O=G=>{u(G),V(G),f(te=>{const ne=G.find(de=>de.id===te);ne&&k(de=>[...de,{id:`temp-${ne.id}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,attribute:ne,value:ne.valorDefecto||"",isTemp:!0}])})},W=async()=>{T(!0);try{const G=await it.get(`/world-bible/folders/${i}`),te=await it.get(`/world-bible/folders/${i}/templates`);O(te),S(de=>({...de,nombre:`Nuevo ${a==="map"?"Mapa":a==="timeline"?"Cronograma":"Ente"}`,carpeta:G,tipoEspecial:a||"entidadindividual",tipo:a||"entidadindividual"}));const ne=te.filter(de=>de.esObligatorio).map(de=>({id:`temp-${de.id}-${Math.random().toString(36).substr(2,9)}`,attribute:de,value:de.valorDefecto||"",isTemp:!0}));k(ne)}catch(G){console.error("Error creating draft:",G)}finally{T(!1)}},F=async()=>{T(!0);try{const G=await it.get(`/world-bible/entities/${n}`);if(S({...G,apariencia:G.apariencia||"",notas:G.notas||"",iconUrl:G.iconUrl||null,tags:G.tags||"",tipo:G.tipoEspecial||getHierarchyType(G.tipo).id,color:G.color||"#6366f1",categoria:G.categoria||"Individual",attributes:G.attributes||{}}),G.carpeta?.id){const ne=await it.get(`/world-bible/folders/${G.carpeta.id}/templates`);O(ne)}const te=(G.valores||[]).filter(ne=>ne.plantilla).map(ne=>({id:ne.id.toString(),attribute:ne.plantilla,value:ne.valor,isTemp:!1}));k(te)}catch(G){console.error("Error loading entity:",G)}finally{T(!1)}},K=(G,te)=>{S(ne=>({...ne,[G]:te}))},X=G=>{const te=G.target.files[0];if(te){const ne=new FileReader;ne.onloadend=()=>{K("iconUrl",ne.result)},ne.readAsDataURL(te)}},Q=(G,te)=>{k(ne=>ne.map(de=>de.id===G?{...de,value:te}:de))},ae=G=>{G.toString().startsWith("temp-")||B(te=>[...te,G]),k(te=>te.filter(ne=>ne.id!==G))},re=async(G=!0)=>{j(!0);try{const te={nombre:_.nombre,descripcion:_.descripcion,tags:_.tags,apariencia:_.apariencia,notas:_.notas,iconUrl:_.iconUrl,tipoEspecial:_.tipoEspecial||"entidadindividual",color:_.color,categoria:_.categoria,attributes:_.attributes};let ne=_.id;if(o){if(!_.carpeta&&!i){alert("Error: Missing context (no folder). Redirecting."),s(`/${e}/${r}/bible`);return}if(te.carpetaId=_.carpeta?.id,!te.carpetaId&&i)try{const oe=await it.get(`/world-bible/folders/${i}`);te.carpetaId=oe.id}catch(oe){console.error("Could not resolve folder",oe)}const ie=await it.post("/world-bible/entities",te);ne=ie.id;const pe=[...N];for(let oe=0;oe<pe.length;oe++){const fe=pe[oe];if(fe.isTemp)try{const ge=await it.post(`/world-bible/entities/${ie.id}/attributes`,{plantillaId:fe.attribute.id});await it.patch(`/world-bible/entities/${ie.id}/values`,[{valorId:ge.id,nuevoValor:fe.value}]),pe[oe]={...fe,id:ge.id.toString(),isTemp:!1}}catch(ge){console.error("Attr save failed",ge)}}if(k(pe),j(!1),G){const oe=ie.carpeta?ie.carpeta.slug||ie.carpeta.id:i;s(`/${e}/${r}/bible/folder/${oe}`)}else{const oe=ie.carpeta?ie.carpeta.slug||ie.carpeta.id:i;s(`/${e}/${r}/bible/folder/${oe}/entity/${ie.slug||ie.id}`,{replace:!0})}return}await it.put(`/world-bible/entities/${ne}`,{nombre:te.nombre,color:te.color,iconUrl:te.iconUrl}),await it.patch(`/world-bible/entities/${ne}/details`,{descripcion:te.descripcion,tags:te.tags,apariencia:te.apariencia,notas:te.notas,iconUrl:te.iconUrl,attributes:te.attributes}),D.length>0&&(await Promise.all(D.map(ie=>it.delete(`/world-bible/values/${ie}`))),B([]));const de=N.filter(ie=>!ie.isTemp).map(ie=>({valorId:parseInt(ie.id),nuevoValor:ie.value}));de.length>0&&await it.patch(`/world-bible/entities/${ne}/values`,de);let me=!1;const ye=[...N];for(let ie=0;ie<ye.length;ie++){const pe=ye[ie];if(pe.isTemp)try{const oe=await it.post(`/world-bible/entities/${ne}/attributes`,{plantillaId:pe.attribute.id});await it.patch(`/world-bible/entities/${ne}/values`,[{valorId:oe.id,nuevoValor:pe.value}]),ye[ie]={...pe,id:oe.id.toString(),isTemp:!1},me=!0}catch(oe){console.error("Error saving field:",pe,oe)}}if(me&&k(ye),j(!1),G){const pe=i||(_.carpeta?_.carpeta.slug||_.carpeta.id:"root")||"root";s(`/${e}/${r}/bible/folder/${pe}`)}}catch(te){console.error("Save error",te),j(!1)}};return E?p.jsx("div",{className:"p-20 text-center animate-pulse",children:"Loading Builder..."}):p.jsx("div",{className:"flex h-full w-full bg-background-dark overflow-hidden",children:p.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-y-auto custom-scrollbar relative",children:[p.jsxs("div",{className:"border-b border-white/5 p-4 flex justify-between items-center bg-background-dark/80 backdrop-blur sticky top-0 z-30",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx(ty,{url:_.iconUrl,name:_.nombre,className:"size-10 rounded-lg border border-white/10"}),p.jsxs("div",{children:[p.jsx("h1",{className:"text-lg font-bold text-white leading-tight",children:_.nombre||"Sin Nombre"}),p.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest text-slate-500",children:o?"Creando Nueva Entidad":"Editando Entidad"})]})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("button",{onClick:()=>s(`/${e}/${r}/bible/folder/${i}`),className:"px-4 py-2 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 text-xs font-bold uppercase tracking-widest transition-all",children:"Cancelar"}),p.jsxs("div",{className:"flex bg-white/5 rounded-xl p-1 gap-1 border border-white/10",children:[p.jsxs("button",{onClick:()=>re(!0),disabled:R,className:"h-9 px-4 rounded-lg bg-primary hover:bg-primary-light text-white text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 disabled:opacity-50",children:[R?p.jsx("span",{className:"material-symbols-outlined animate-spin text-sm",children:"refresh"}):p.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar"]}),p.jsx("div",{className:"w-px bg-white/10 my-1"}),p.jsx("button",{onClick:()=>re(!1),disabled:R,className:"h-9 px-3 rounded-lg bg-transparent hover:bg-white/10 text-white transition-all flex items-center justify-center disabled:opacity-50",title:"Guardar y Seguir Editando",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit_document"})})]})]})]}),p.jsxs("div",{className:"p-8 pb-32 max-w-5xl mx-auto w-full",children:[v==="identity"&&p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[p.jsxs(Rr,{className:`p-6 space-y-6 ${_.tipoEspecial==="map"?"lg:col-span-2":""}`,children:[p.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"badge"})," Identity"]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Full Name"}),p.jsx("input",{value:_.nombre,onChange:G=>K("nombre",G.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none transition-colors",placeholder:"E.g. King Alaric"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Entity Type / Category"}),p.jsxs("select",{value:_.categoria||"Individual",onChange:G=>K("categoria",G.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none transition-colors appearance-none",children:[p.jsx("option",{value:"Individual",children:"Individual (Character/Person)"}),p.jsx("option",{value:"Group",children:"Group / Faction"}),p.jsx("option",{value:"Location",children:"Location"}),p.jsx("option",{value:"Event",children:"Event"}),p.jsx("option",{value:"Object",children:"Object / Item"}),p.jsx("option",{value:"Concept",children:"Concept / Magic"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Tags (comma separated)"}),p.jsx("input",{value:_.tags,onChange:G=>K("tags",G.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-slate-300 focus:border-primary/50 outline-none transition-colors",placeholder:"Warrior, Leader, Human..."})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Icon / Portrait"}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx(ty,{url:_.iconUrl,name:_.nombre,size:"lg",className:"rounded-xl"}),p.jsxs("label",{className:"cursor-pointer px-4 py-2 bg-white/5 hover:bg-white/10 rounded-lg border border-white/10 text-xs font-bold text-slate-300 transition-colors",children:["Upload Image",p.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:X})]}),_.iconUrl&&p.jsx("button",{onClick:()=>K("iconUrl",""),className:"p-2 hover:text-red-400 transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]})]})]}),_.tipoEspecial!=="map"&&p.jsxs(Rr,{className:"p-6 space-y-6",children:[p.jsxs("div",{className:"flex justify-between items-center mb-6",children:[p.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"palette"})," Appearance"]}),p.jsx("div",{className:"flex gap-2",children:p.jsxs("label",{className:"cursor-pointer text-[10px] font-bold uppercase tracking-wider text-slate-500 hover:text-white transition-colors flex items-center gap-1",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"add_photo_alternate"}),"Insert Image",p.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:G=>{const te=G.target.files[0];if(te){const ne=new FileReader;ne.onloadend=()=>{const de=`

![${te.name}](${ne.result})
`;K("apariencia",(_.apariencia||"")+de)},ne.readAsDataURL(te)}}})]})})]}),p.jsx("textarea",{value:_.apariencia,onChange:G=>K("apariencia",G.target.value),className:"w-full h-80 bg-black/30 border border-white/10 rounded-xl p-4 text-sm text-slate-300 leading-relaxed focus:border-primary/50 outline-none transition-colors custom-scrollbar font-mono",placeholder:"Describe their physical appearance, clothing, distinct marks... (Markdown Supported)"})]}),_.tipoEspecial==="map"&&p.jsxs(Rr,{className:"p-6 lg:col-span-2 space-y-6",children:[p.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Cartography"]}),p.jsx("div",{onClick:()=>{Z(!0)},className:"w-full aspect-[21/9] bg-black/30 border border-white/10 rounded-xl overflow-hidden cursor-pointer group relative",children:(()=>{let G=_.attributes?.snapshotUrl||_.attributes?.bgImage||_.iconUrl;if(!G)try{const te=JSON.parse(_.descripcion||"{}");te.snapshotUrl&&(G=te.snapshotUrl)}catch{}return G?p.jsxs(p.Fragment,{children:[p.jsx("img",{src:G,alt:"Map Preview",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),p.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:p.jsx("span",{className:"material-symbols-outlined text-white text-3xl",children:"zoom_in"})})]}):p.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-xs italic",children:"No map preview available"})})()}),p.jsx("div",{className:"flex justify-end",children:p.jsx(rn,{variant:"secondary",size:"sm",icon:"edit",onClick:()=>window.open(`/${e}/${r}/map-editor/edit/${_.id}`,"_self"),children:"Open Editor"})})]}),_.tipoEspecial!=="map"&&p.jsxs(Rr,{className:"p-6 lg:col-span-2",children:[p.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"sticky_note_2"})," Quick Notes"]}),p.jsx("textarea",{className:"w-full h-40 bg-black/30 border border-white/10 rounded-xl p-4 text-sm text-slate-300 leading-relaxed resize-none focus:border-primary/50 outline-none transition-colors custom-scrollbar font-mono placeholder:text-slate-600",placeholder:"Quick notes about this entity...",value:_.notas||"",onChange:G=>K("notas",G.target.value)})]})]}),v==="narrative"&&p.jsxs("div",{className:"animate-in fade-in duration-500 space-y-8",children:[p.jsxs(Rr,{className:"min-h-[40vh] flex flex-col p-8",children:[p.jsxs("div",{className:"flex items-center justify-between mb-6",children:[p.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"history_edu"})," Biography"]}),p.jsx("span",{className:"text-[10px] text-slate-500 bg-white/5 px-2 py-1 rounded",children:"Markdown Supported"})]}),p.jsx("textarea",{className:"flex-1 w-full bg-transparent border-none outline-none text-slate-300 leading-relaxed resize-none focus:ring-0 placeholder:text-slate-600 custom-scrollbar text-base min-h-[300px]",placeholder:"Write the origin story...",value:_.descripcion||"",onChange:G=>K("descripcion",G.target.value)})]}),p.jsxs(Rr,{className:"min-h-[40vh]",children:[p.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary p-6 pb-0 flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})," Relationships"]}),o?p.jsxs("div",{className:"p-12 text-center text-slate-500",children:[p.jsx("span",{className:"material-symbols-outlined text-4xl mb-4",children:"save_as"}),p.jsx("p",{className:"text-sm font-bold",children:"Please save the entity first to manage relationships."})]}):p.jsx(gX,{entityId:_.id,entityType:_.tipo||"entidadindividual"})]})]}),v==="attributes"&&p.jsxs("div",{className:`animate-in fade-in duration-500 space-y-6 min-h-[50vh] transition-colors rounded-2xl p-4 ${window.isDraggingOver?"bg-primary/10 border-2 border-dashed border-primary":""}`,onDragOver:G=>{G.preventDefault(),G.dataTransfer.dropEffect="copy",G.currentTarget.classList.add("bg-primary/10","border-primary","border-dashed","border-2")},onDragLeave:G=>{G.preventDefault(),G.currentTarget.classList.remove("bg-primary/10","border-primary","border-dashed","border-2")},onDrop:G=>{if(G.preventDefault(),G.currentTarget.classList.remove("bg-primary/10","border-primary","border-dashed","border-2"),G.dataTransfer.getData("application/reactflow/type")!=="attribute")return;let ne=null;try{const de=G.dataTransfer.getData("templateData");if(de)ne=JSON.parse(de);else{const me=parseInt(G.dataTransfer.getData("templateId"));ne=I.find(ye=>ye.id===me)}}catch(de){console.error("Drop error",de)}ne&&k(de=>[...de,{id:`temp-${ne.id}-${Date.now()}`,attribute:ne,value:ne.valorDefecto||"",isTemp:!0}])},children:[p.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary border-b border-white/5 pb-4 flex items-center justify-between",children:[p.jsx("span",{children:"Atributos especiales"}),p.jsx("span",{className:"text-[10px] text-slate-500 font-normal normal-case opacity-50 hidden md:block",children:"Arraste atributos desde el panel derecho"})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 border-2 border-dashed border-white/5 rounded-2xl hover:border-primary/20 transition-colors bg-white/[0.01]",children:[N.length===0&&p.jsxs("div",{className:"col-span-full py-12 text-center text-slate-500 text-sm pointer-events-none",children:[p.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"drag_indicator"}),p.jsx("p",{children:"Arrastra plantillas aqu para aadir atributos"})]}),N.filter(G=>G.attribute).map(G=>p.jsx(pX,{attribute:G.attribute,value:G.value,onChange:te=>Q(G.id,te),onRemove:()=>ae(G.id)},G.id))]})]})]}),$&&_.iconUrl&&p.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-300",onClick:()=>Z(!1),children:p.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] p-2",children:[p.jsx("button",{onClick:()=>Z(!1),className:"absolute -top-12 right-0 p-2 text-white hover:text-primary transition-colors",children:p.jsx("span",{className:"material-symbols-outlined text-3xl",children:"close"})}),p.jsx("img",{src:_.iconUrl,alt:_.nombre,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl border border-white/10",onClick:G=>G.stopPropagation()})]})})]})})},vX=t=>{switch(t?.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},y_=({item:t,type:e,linkTo:r,onContextMenu:n,onDelete:i})=>{const a=e==="folder";return p.jsxs(Rh,{to:r,onContextMenu:n,className:"group relative flex flex-col p-4 rounded-3xl bg-surface-dark border border-glass-border hover:border-primary/50 hover:bg-white/5 transition-all duration-300 backdrop-blur-sm overflow-hidden",children:[t.iconUrl&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"absolute inset-0 z-0",children:p.jsx("img",{src:t.iconUrl,alt:"",className:"w-full h-full object-cover opacity-60 group-hover:scale-105 transition-transform duration-700"})}),p.jsx("div",{className:"absolute inset-0 z-0 bg-gradient-to-t from-[#0a0a0c] via-[#0a0a0c]/80 to-transparent"})]}),p.jsxs("div",{className:"relative z-10 flex items-start justify-between mb-4",children:[p.jsx("div",{className:`
                    size-12 rounded-2xl flex items-center justify-center text-xl transition-transform group-hover:scale-110 
                    ${a?"bg-primary/20 text-primary":"bg-white/5 text-text-muted group-hover:text-white backdrop-blur-md border border-white/5"}
                `,children:p.jsx("span",{className:"material-symbols-outlined",children:a?"folder":vX(t.tipoEspecial)})}),a&&p.jsx("div",{className:"px-2 py-1 rounded-lg bg-surface-light/50 border border-glass-border text-[10px] font-black text-white shadow-sm backdrop-blur-md",children:t.itemCount||0})]}),p.jsxs("div",{className:"relative z-10 mt-auto",children:[p.jsx("h3",{className:"text-sm font-bold text-white truncate group-hover:text-primary transition-colors drop-shadow-md",children:t.nombre}),p.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted mt-1 opacity-70 group-hover:opacity-100 transition-opacity",children:a?"Folder":t.tipoEspecial||"Entity"})]}),p.jsxs("div",{className:"absolute top-4 right-4 z-20 flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[i&&p.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),i(t)},className:"p-1.5 rounded-lg bg-red-500/10 hover:bg-red-500 text-red-500 hover:text-white transition-all border border-red-500/20 shadow-lg shadow-red-500/5 group/del backdrop-blur-md",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})}),p.jsx("span",{className:"material-symbols-outlined text-primary text-sm transform group-hover:translate-x-1 transition-transform drop-shadow-md",children:"arrow_forward"})]})]})},yX=({path:t,currentFolder:e})=>{const{username:r,projectName:n}=ds(),i=`/${r}/${n}/bible`;return!t&&!e?null:p.jsxs("nav",{className:"flex items-center gap-2 text-[10px] uppercase font-bold tracking-wider text-slate-500 mb-4 overflow-x-auto no-scrollbar whitespace-nowrap",children:[p.jsxs(Rh,{to:i,className:"hover:text-primary transition-colors flex items-center gap-1",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"home"}),"Bible"]}),t&&t.map((a,s)=>p.jsxs(er.Fragment,{children:[p.jsx("span",{className:"text-slate-700",children:"/"}),p.jsx(Rh,{to:`${i}/folder/${a.slug||a.id}`,className:"hover:text-primary transition-colors",children:a.nombre})]},a.id)),e&&p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"text-slate-700",children:"/"}),p.jsx("span",{className:"text-white bg-white/5 px-2 py-0.5 rounded",children:e.nombre})]})]})},xX=({entities:t=[],onAddEvent:e})=>{const r=[...t].sort((n,i)=>n.id-i.id);return p.jsx("div",{className:"w-full max-w-3xl mx-auto p-4 animate-slide-up",children:p.jsxs("div",{className:"relative border-l-2 border-white/10 ml-6 space-y-12 py-8",children:[r.length===0&&p.jsx("div",{className:"pl-12 opacity-50",children:p.jsx("p",{className:"text-white text-sm",children:"No events recorded in this timeline yet."})}),r.map((n,i)=>p.jsxs("div",{className:"relative pl-12 group",children:[p.jsx("div",{className:"absolute left-[-9px] top-0 size-4 rounded-full bg-background-dark border-2 border-primary group-hover:scale-125 group-hover:bg-primary transition-all shadow-[0_0_10px_rgba(99,102,241,0.3)]"}),p.jsxs(Rr,{className:"p-6 border-white/5 hover:border-primary/30 transition-all hover:-translate-y-1 cursor-pointer",children:[p.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n.nombre}),p.jsx("p",{className:"text-sm text-text-muted leading-relaxed line-clamp-3",children:n.descripcion||"No description provided."})]})]},n.id)),p.jsxs("div",{onClick:e,className:"relative pl-12 group cursor-pointer opacity-50 hover:opacity-100 transition-opacity",children:[p.jsx("div",{className:"absolute left-[-9px] top-2 size-4 rounded-full bg-background-dark border-2 border-dashed border-white/30"}),p.jsxs("div",{className:"p-4 border-2 border-dashed border-white/10 rounded-2xl flex items-center justify-center text-text-muted hover:border-primary/50 hover:text-white transition-all",children:[p.jsx("span",{className:"material-symbols-outlined mr-2",children:"add_circle"}),p.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Add Historical Event"})]})]})]})})},Eh={UNIVERSE:{id:"UNIVERSE",label:"Universo / Multiverso",description:"Contenedor supremo de realidades.",icon:"public",color:"text-purple-400",bgColor:"bg-purple-900/20"},GALAXY:{id:"GALAXY",label:"Galaxia",description:"Agrupacin masiva de sistemas estelares.",icon:"auto_awesome",color:"text-indigo-400",bgColor:"bg-indigo-900/20"},SYSTEM:{id:"SYSTEM",label:"Sistema Solar",description:"Estrella central y sus cuerpos orbitales.",icon:"wb_sunny",color:"text-yellow-400",bgColor:"bg-yellow-900/20"},PLANET:{id:"PLANET",label:"Planeta / Mundo",description:"Cuerpo celeste o plano de existencia principal.",icon:"public",color:"text-emerald-400",bgColor:"bg-emerald-900/20"},GEOGRAPHY:{id:"GEOGRAPHY",label:"Geografa",icon:"map",color:"text-green-300"},ENTITIES:{id:"ENTITIES",label:"Entidades",icon:"groups",color:"text-blue-300"},MAGIC:{id:"MAGIC",label:"Magia",icon:"auto_fix_high",color:"text-pink-300"},TIMELINE:{id:"TIMELINE",label:"Cronologa",icon:"history",color:"text-orange-300"},FACTIONS:{id:"FACTIONS",label:"Facciones",icon:"security",color:"text-red-300"},ITEMS:{id:"ITEMS",label:"Objetos",icon:"inventory_2",color:"text-gray-300"},FOLDER:{id:"FOLDER",label:"Carpeta",icon:"folder",color:"text-gray-400"}},x_=t=>Eh[t]||Eh.FOLDER,bX=()=>{const{username:t,projectName:e,folderSlug:r}=ds(),n=Ga(),{handleCreateEntity:i,handleDeleteEntity:a,handleCreateSimpleFolder:s,folderSearchTerm:o,folderFilterType:l}=Zu(),[u,c]=ce.useState([]),[f,g]=ce.useState(null),[v,x]=ce.useState([]),[_,S]=ce.useState(!0),[N,k]=ce.useState(!1),E=u.filter(D=>{const B=D.nombre.toLowerCase().includes(o||""),I=l==="ALL"||l==="MAP"&&D.tipoEspecial==="map"||l==="TIMELINE"&&D.tipoEspecial==="timeline"||l==="ENTITY"&&(!D.tipoEspecial||D.tipoEspecial==="entidadindividual");return B&&I});ce.useEffect(()=>{const D=B=>{const{folderId:I,removeId:V,type:$,item:Z,expand:O}=B.detail||{};I===(f?.id||r)&&(V?c(W=>W.filter(F=>F.id!==V)):Z&&Z.slug&&Z.slug!==r?n(`/${t}/${e}/bible/folder/${Z.slug}`,{replace:!0}):T())};return window.addEventListener("folder-update",D),()=>window.removeEventListener("folder-update",D)},[r,f?.id]),ce.useEffect(()=>{T()},[r]);const T=async()=>{S(!0);try{const[D,B]=await Promise.all([it.get(`/world-bible/folders/${r}/entities`),it.get(`/world-bible/folders/${r}`)]);c(D),B.folder?(g(B.folder),x(B.path||[])):(g(B||{name:"Folder"}),x([]))}catch(D){console.error("Error loading folder content:",D),g(null),x([])}finally{S(!1)}};if(_)return p.jsx("div",{className:"p-20 text-center animate-pulse text-text-muted",children:"Loading sector..."});if(!f)return p.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-20 text-text-muted",children:[p.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-20",children:"folder_off"}),p.jsx("h2",{className:"text-xl font-bold opacity-50",children:"Folder Not Found"}),p.jsx("p",{className:"text-sm opacity-30 mt-2",children:"The sector you are looking for does not exist or has been moved."}),p.jsx(Rh,{to:`/${t}/${e}/bible`,className:"mt-6 px-6 py-2 bg-white/5 hover:bg-white/10 rounded-full text-xs font-bold transition-colors",children:"Return to Root"})]});const R=f&&f.tipo&&(["UNIVERSE","GALAXY","SYSTEM","PLANET"].includes(f.tipo)||f.tipo==="MAGIC"),j=f?x_(f.tipo):Eh.FOLDER;return R?p.jsxs("div",{className:"flex-1 overflow-y-auto bg-[#0a0a0c] text-white w-full h-full relative",children:[p.jsxs("div",{className:`w-full min-h-[300px] ${j.bgColor} relative flex items-end p-10 border-b border-white/5`,children:[p.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0c] to-transparent opacity-80 pointer-events-none"}),p.jsx("div",{className:"absolute top-6 left-10 z-20",children:p.jsx(yX,{path:v,currentFolder:f})}),p.jsxs("div",{className:"relative z-10 flex gap-8 items-end w-full max-w-7xl mx-auto",children:[p.jsx("div",{className:`w-32 h-32 rounded-3xl ${j.bgColor} border border-white/10 flex items-center justify-center shadow-2xl`,children:p.jsx("span",{className:`material-symbols-outlined text-6xl ${j.color}`,children:j.icon})}),p.jsxs("div",{className:"flex-1 mb-2",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[p.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border border-white/10 ${j.bgColor} ${j.color}`,children:j.label}),p.jsxs("span",{className:"text-white/30 text-xs font-mono tracking-widest uppercase",children:["ID: ",f.id]})]}),p.jsx("h1",{className:"text-6xl font-black tracking-tighter text-white mb-2",children:f.nombre}),p.jsx("p",{className:"text-lg text-white/50 max-w-2xl font-light leading-relaxed",children:f.descripcion||"Sin descripcin definida para este sector cosmolgico."})]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsxs("button",{onClick:()=>n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadindividual`),className:"px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"person_add"})," Nueva Entidad"]}),p.jsxs("button",{onClick:()=>n(`/${t}/${e}/map-editor/create/${r}`,{state:{folderId:f?.id}}),className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all border border-glass-border",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Mapa"]})]})]})]}),p.jsxs("div",{className:"max-w-7xl mx-auto p-10 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-[#13141f] border border-white/5 rounded-2xl p-6",children:[p.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Estadsticas"}),p.jsx("div",{className:"grid grid-cols-2 gap-4",children:p.jsxs("div",{children:[p.jsx("div",{className:"text-2xl font-black text-white",children:u.length}),p.jsx("div",{className:"text-[10px] text-white/40 uppercase",children:"Entidades"})]})})]}),p.jsxs("div",{className:"bg-[#13141f] border border-white/5 rounded-2xl p-6 h-64 flex flex-col",children:[p.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Notas Rpidas"}),p.jsx("textarea",{className:"flex-1 bg-transparent resize-none outline-none text-sm text-white/70 placeholder-white/20",placeholder:"Escribir notas de la zona..."})]})]}),p.jsxs("div",{className:"lg:col-span-2",children:[p.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Contenido Interno"}),u.length===0&&p.jsxs("div",{className:"p-12 border border-dashed border-white/10 rounded-2xl text-center",children:[p.jsx("span",{className:"material-symbols-outlined text-4xl text-white/20 mb-2",children:"folder_open"}),p.jsx("p",{className:"text-white/30 text-sm",children:"Este sector est vaco."})]}),p.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:u.map(D=>p.jsx(y_,{item:D,type:"entity",linkTo:`/${t}/${e}/bible/folder/${f.slug||r}/entity/${D.slug||D.id}`,onDelete:()=>a(D.id,f?.id||r)},D.id))})]})]})]}):p.jsxs("div",{className:"flex-1 p-8 max-w-[1600px] mx-auto w-full h-full overflow-y-auto",children:[p.jsxs("header",{className:"mb-8 flex items-end justify-between",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[p.jsxs(Rh,{to:`/${t}/${e}/bible`,className:"text-xs font-bold text-text-muted hover:text-primary transition-colors flex items-center gap-1",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"})," Root"]}),f&&p.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] bg-white/5 border border-white/10 ${j.color}`,children:j.label})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("span",{className:`material-symbols-outlined text-3xl ${j.color}`,children:j.icon}),p.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter",children:f?.nombre||"Unnamed Folder"})]}),p.jsx("p",{className:"text-white/50 text-sm mt-2 max-w-xl",children:f?.descripcion})]}),p.jsxs("div",{className:"flex items-center gap-3 relative",children:[p.jsxs("button",{onClick:()=>k(!N),className:"h-10 px-6 rounded-xl bg-primary hover:bg-primary-light transition flex items-center gap-2 text-xs font-bold text-white shadow-lg shadow-primary/20",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"}),p.jsx("span",{children:"Aadir Elemento"})]}),N&&p.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-surface-dark border border-glass-border rounded-2xl shadow-2xl py-2 z-50 animate-in fade-in slide-in-from-top-2",children:[p.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadindividual`),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"person"})," Personaje"]}),p.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadcolectiva`),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-blue-400",children:"groups"})," Cultura / Grupo"]}),p.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/zona`),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-green-400",children:"location_on"})," Lugar / Geografa"]}),p.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/interaccion`),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-amber-400",children:"history_edu"})," Lore / Interaccin"]}),p.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/efectos`),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-purple-400",children:"magic_button"})," Objeto / Efecto"]}),p.jsx("div",{className:"h-px bg-white/5 my-1"}),p.jsxs("button",{onClick:()=>{n(`/${t}/${e}/map-editor/create/${r}`,{state:{folderId:f?.id}}),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-red-400",children:"map"})," Nuevo Mapa"]}),p.jsxs("button",{onClick:()=>{s(f,"TIMELINE"),k(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-cyan-400",children:"timeline"})," Timeline"]})]})]})]}),f?.tipo==="TIMELINE"?p.jsx(xX,{entities:E,folderId:r,onAddEvent:()=>n(`/${t}/${e}/bible/folder/${r}/entity/new/evento`)}):p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:E.map(D=>{const B=D.tipoEspecial==="map"||D.tipoEspecial==="timeline"?D.tipoEspecial:"entity";return p.jsx(y_,{item:D,type:"entity",linkTo:`/${t}/${e}/bible/folder/${f?.slug||r}/${B}/${D.slug||D.id}`,onDelete:()=>a(D.id,f?.id||r)},D.id)})}),u.length===0&&p.jsx("div",{className:"p-20 text-center border-2 border-dashed border-glass-border rounded-[3rem] opacity-30 mt-8",children:p.jsx("p",{className:"text-text-muted font-bold uppercase tracking-widest",children:"Empty Folder"})})]})},wX=t=>{switch(t?.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},_X=(t,e,r,n)=>{const i=r.slug||r.id;return`/${t}/${e}/bible/folder/${n||"root"}/entity/${i}`},jj=({folder:t,onCreateSubfolder:e,onRename:r,onDeleteFolder:n,onDeleteEntity:i,onCreateTemplate:a,onMoveEntity:s,onCreateEntity:o,onConfirmCreate:l,className:u})=>{const{username:c,projectName:f}=ds(),g=Ga(),[v,x]=ce.useState(!1),[_,S]=ce.useState({folders:[],entities:[]}),[N,k]=ce.useState(!1),[E,T]=ce.useState(null),[R,j]=ce.useState(t.nombre),[D,B]=ce.useState(!1),[I,V]=ce.useState(null);ce.useEffect(()=>{j(t.nombre)},[t.nombre]),ce.useEffect(()=>{const G=te=>{const{folderId:ne,optimisticType:de,confirmedType:me,removeId:ye,item:ie,oldId:pe,expand:oe,type:fe}=te.detail||{};if(ne===t.id){if(oe&&(x(!0),N||$()),N)if(de){const ge=de==="folder"?"folders":"entities";S(be=>({...be,[ge]:[...be[ge].filter(_e=>_e.id!==ie.id),ie]}))}else if(me){const ge=me==="folder"?"folders":"entities";S(be=>({...be,[ge]:be[ge].map(_e=>_e.id===pe?ie:_e)}))}else if(ye){const ge=fe==="folder"?"folders":"entities";S(be=>({...be,[ge]:be[ge].filter(_e=>_e.id!==ye)}))}else!de&&!me&&!ye&&$()}else te.detail?.targetFolderId===t.id&&te.detail?.type==="move-in"?N&&$():te.detail?.sourceFolderId===t.id&&te.detail?.type==="move-out"&&N&&S(ge=>({...ge,entities:ge.entities.filter(be=>be.id!==be.detail.entityId)}))};return window.addEventListener("folder-update",G),()=>window.removeEventListener("folder-update",G)},[t.id,N]);const $=async()=>{try{console.log("Loading content for folder:",t.id,"Slug:",t.slug);const[G,te]=await Promise.all([it.get(`/world-bible/folders/${t.id}/subfolders`),it.get(`/world-bible/folders/${t.id}/entities`)]);S({folders:G,entities:te}),k(!0)}catch(G){console.error("Error reloading folder content:",G),G.message&&G.message.includes("404")&&console.error(`404 for folder ${t.id} (${t.nombre})`)}},Z=G=>{G.stopPropagation(),x(!v),!N&&!v&&$()},O=()=>g(`/${c}/${f}/bible/folder/${t.slug||t.id}`),W=(G,te,ne,de)=>{G.preventDefault(),G.stopPropagation(),T({x:G.clientX,y:G.clientY,type:te,id:ne,name:de})},F=()=>T(null);ce.useEffect(()=>{if(E)return window.addEventListener("click",F),()=>window.removeEventListener("click",F)},[E]);const K=G=>{if(G.key==="Enter"){G.preventDefault();const te=G.target.value.trim();te?l(t.id,te,"folder",t.parentId,t.tipoEspecial):t.isNew&&i(t.id,t.parentId)}};if(t.isNew)return p.jsx("div",{className:"px-3 py-1 animate-in fade-in zoom-in-95 duration-200",children:p.jsx("input",{autoFocus:!0,type:"text",className:"w-full bg-surface-light border border-primary/50 rounded px-2 py-1 text-xs text-white outline-none",placeholder:"Folder Name...",onKeyDown:K,onBlur:G=>{const te=G.target.value.trim();te?l(t.id,te,"folder",t.parentId):i(t.id,t.parentId)}})});const X=({item:G,type:te})=>p.jsx("div",{className:"px-3 py-1 animate-in fade-in zoom-in-95 duration-200",children:p.jsx("input",{autoFocus:!0,type:"text",defaultValue:G.nombre||"",className:"w-full bg-surface-light border border-primary/50 rounded px-2 py-1 text-xs text-white outline-none",placeholder:"Name...",onKeyDown:ne=>{if(ne.key==="Enter"){ne.preventDefault();const de=ne.target.value.trim();de?l(G.id,de,te,t.id,G.tipoEspecial):G.isNew&&i(G.id,t.id),V(null)}else ne.key==="Escape"&&(V(null),G.isNew&&i(G.id,t.id))},onBlur:ne=>{const de=ne.target.value.trim();de?l(G.id,de,te,t.id,G.tipoEspecial):G.isNew&&i(G.id,t.id),V(null)}})}),Q=G=>{G.preventDefault(),G.stopPropagation(),G.currentTarget.classList.add("bg-primary/20")},ae=G=>{G.preventDefault(),G.stopPropagation(),G.currentTarget.classList.remove("bg-primary/20")},re=G=>{G.preventDefault(),G.stopPropagation(),G.currentTarget.classList.remove("bg-primary/20");const te=G.dataTransfer.getData("entityId"),ne=G.dataTransfer.getData("sourceFolderId");te&&ne&&ne!==String(t.id)&&s(te,t.id,ne)};return p.jsxs("div",{className:`space-y-1 select-none ${u||""}`,children:[p.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 rounded-xl text-xs font-bold text-text-muted hover:text-white hover:bg-white/5 cursor-pointer transition-all group relative",onClick:O,onContextMenu:G=>W(G,"folder",t.id,t.nombre),onDragOver:Q,onDragLeave:ae,onDrop:re,children:[p.jsx("span",{onClick:Z,className:`material-symbols-outlined text-lg transition-transform hover:text-primary ${v?"rotate-90 text-primary":"opacity-50"}`,children:"chevron_right"}),p.jsx("span",{className:`material-symbols-outlined text-lg ${x_(t.tipo).color}`,children:x_(t.tipo).icon}),D?p.jsx("input",{autoFocus:!0,className:"bg-surface-light border border-primary/50 rounded px-2 py-0.5 text-xs text-white outline-none flex-1 min-w-0",defaultValue:R,onKeyDown:async G=>{if(G.key==="Enter"){G.preventDefault(),G.stopPropagation();const te=G.target.value.trim();if(te&&te!==R)try{await r(t.id,te),j(te)}catch(ne){console.error("Rename failed",ne)}B(!1)}else G.key==="Escape"&&(G.preventDefault(),G.stopPropagation(),B(!1))},onBlur:()=>B(!1),onClick:G=>G.stopPropagation()}):p.jsx("span",{className:"truncate flex-1",children:R})]}),E&&p.jsxs("div",{className:"fixed bg-surface-dark border border-glass-border shadow-2xl rounded-xl py-2 z-50 w-48 text-xs font-medium flex flex-col",style:{top:E.y,left:E.x},onClick:G=>G.stopPropagation(),children:[p.jsx("div",{className:"px-4 py-2 border-b border-white/5 font-bold text-text-muted truncate",children:E.name}),E.type==="folder"?p.jsxs(p.Fragment,{children:[p.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{o(t.id,"entidadindividual"),F()},children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"person"})," Add Character"]}),p.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{g(`/${c}/${f}/map-editor/create/${t.id}`),F()},children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Add Map"]}),p.jsx("div",{className:"h-px bg-white/5 my-1"}),p.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{B(!0),F()},children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Rename Folder"]}),p.jsxs("button",{className:"px-4 py-2 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-2",onClick:()=>{n(t.id,t.parentId),F()},children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Delete Folder"]})]}):p.jsxs(p.Fragment,{children:[p.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2 cursor-pointer",onClick:()=>{V(E.id),F()},children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Rename"]}),p.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2 cursor-pointer",onClick:async()=>{try{await it.entityService.toggleFavorite(E.id),window.dispatchEvent(new CustomEvent("favorites-update")),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:t.id}}))}catch(G){console.error(G)}F()},children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-500",children:"star"})," Toggle Favorite"]}),p.jsxs("button",{className:"px-4 py-2 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-2",onClick:()=>{i(E.id,t.id),F()},children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Delete Entity"]})]})]}),v&&p.jsxs("div",{className:"ml-6 pl-4 border-l border-glass-border space-y-1 animate-slide-in",children:[_.folders.map(G=>p.jsx(jj,{folder:G,onCreateSubfolder:e,onRename:r,onDeleteFolder:n,onDeleteEntity:i,onCreateTemplate:a,onMoveEntity:s,onCreateEntity:o,onConfirmCreate:l},G.id)),_.entities.map(G=>G.isNew||G.id===I?p.jsx(X,{item:G,type:"entity"},G.id):p.jsxs(Rh,{to:_X(c,f,G,t.slug||t.id),onContextMenu:te=>W(te,"entity",G.id,G.nombre),className:`flex items-center gap-3 px-3 py-2 rounded-xl text-[11px] font-medium text-text-muted hover:text-white hover:bg-primary/10 transition-all group cursor-grab active:cursor-grabbing ${G.pending?"opacity-50 pointer-events-none":""}`,draggable:!G.pending,onDragStart:te=>{te.dataTransfer.setData("entityId",G.id),te.dataTransfer.setData("sourceFolderId",t.id)},children:[p.jsx("span",{className:"material-symbols-outlined text-sm opacity-70 group-hover:text-primary transition-colors",children:wX(G.tipoEspecial)}),p.jsx("span",{className:"truncate flex-1",children:G.nombre}),G.favorite&&p.jsx("span",{className:"material-symbols-outlined text-[10px] text-yellow-500",title:"Favorito",children:"star"})]},G.id)),N&&_.folders.length===0&&_.entities.length===0&&p.jsx("div",{className:"px-3 py-2 text-[10px] text-text-muted/30 uppercase font-black italic tracking-tighter",children:"Empty Sector"})]})]})},SX=({isOpen:t,onClose:e,onCreate:r,parentFolder:n})=>{const[i,a]=ce.useState({nombre:"",descripcion:"",tipo:"FOLDER",canvasType:"BLANK"});if(!t)return null;const s=()=>{r(i),e(),a({nombre:"",descripcion:"",tipo:"FOLDER",canvasType:"BLANK"})},o=[Eh.UNIVERSE,Eh.GALAXY,Eh.SYSTEM,Eh.PLANET];return p.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:p.jsxs("div",{className:"bg-[#1a1b26] w-full max-w-4xl rounded-2xl shadow-2xl border border-white/10 overflow-hidden flex flex-col max-h-[90vh]",children:[p.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-[#1f202e]",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:p.jsx("span",{className:"material-icons text-sm",children:"add"})}),p.jsx("h2",{className:"text-xl font-semibold text-white",children:n?"Crear Nuevo Espacio":"Crear Nuevo Mapa"})]}),p.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition",children:p.jsx("span",{className:"material-icons",children:"close"})})]}),p.jsx("div",{className:"p-8 overflow-y-auto flex-1",children:p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[p.jsxs("div",{className:"space-y-6",children:[p.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-indigo-400",children:"Identidad"}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-2",children:"Nombre del Espacio"}),p.jsx("input",{autoFocus:!0,type:"text",value:i.nombre,onChange:l=>a({...i,nombre:l.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-indigo-500/50 transition-all shadow-inner",placeholder:"ej. Sistema Solar"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-2",children:"Descripcin"}),p.jsx("textarea",{value:i.descripcion,onChange:l=>a({...i,descripcion:l.target.value}),className:"w-full h-32 bg-black/40 border border-white/5 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-indigo-500/50 resize-none transition-all",placeholder:"Detalles sobre este nivel jerrquico..."})]})]}),p.jsxs("div",{className:"space-y-6",children:[p.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-indigo-400",children:"Configuracin"}),p.jsxs("div",{className:"space-y-3",children:[p.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-1",children:"Tipo de Jerarqua"}),p.jsx("div",{className:"grid grid-cols-2 gap-2",children:o.concat([{id:"FOLDER",label:"Carpeta",icon:"folder",color:"text-white/50"}]).map(l=>p.jsxs("div",{onClick:()=>a({...i,tipo:l.id}),className:`flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all ${i.tipo===l.id?"bg-indigo-500/10 border-indigo-500/50":"bg-white/5 border-white/5 hover:bg-white/10"}`,children:[p.jsx("span",{className:`material-icons text-lg ${l.color||""}`,children:l.icon}),p.jsx("span",{className:"text-xs font-bold text-white/80",children:l.label})]},l.id||"FOLDER"))})]}),p.jsx("div",{className:"p-4 rounded-2xl bg-indigo-500/5 border border-indigo-500/10",children:p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:p.jsx("span",{className:"material-icons",children:"info"})}),p.jsxs("div",{children:[p.jsx("p",{className:"text-[10px] uppercase font-black text-indigo-300",children:"Ubicacin Actual"}),p.jsx("p",{className:"text-xs text-indigo-100/50",children:n?n.nombre:"Raz del Mundo"})]})]})})]})]})}),p.jsxs("div",{className:"p-6 border-t border-white/5 flex justify-end gap-3 bg-[#1f202e]",children:[p.jsx("button",{onClick:e,className:"px-6 py-3 rounded-xl text-xs font-black uppercase tracking-widest text-text-muted hover:text-white transition",children:"Cancelar"}),p.jsx("button",{onClick:s,disabled:!i.nombre,className:"px-8 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-black uppercase tracking-widest shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-30 disabled:pointer-events-none",children:"Confirmar y Crear"})]})]})})},kX=()=>{const{username:t,projectName:e}=ds(),r=Ga(),{handleCreateEntity:n,...i}=Zu()||{},[a,s]=ce.useState([]),[o,l]=ce.useState([]),[u,c]=ce.useState(!1),[f,g]=ce.useState(!1),[v,x]=ce.useState(null),[_,S]=ce.useState(!1),[N,k]=ce.useState(null),E=`/${t}/${e}/bible`;ce.useEffect(()=>{T(),R();const F=()=>R();return window.addEventListener("favorites-update",F),()=>window.removeEventListener("favorites-update",F)},[e]);const T=async()=>{try{const F=await it.get("/world-bible/folders");s(F)}catch(F){console.error("Error loading folders:",F)}},R=async()=>{try{const F=await it.get("/world-bible/favorites");l(F)}catch(F){console.error("Error loading favorites:",F)}},j=(F=null)=>{x(F),g(!0),c(!1)},D=async(F=null,K="FOLDER")=>{try{const X=F?typeof F=="object"?F.id:F:null,Q=await it.post("/world-bible/folders",{nombre:K==="TIMELINE"?"Nueva Lnea de Tiempo":"Nueva Carpeta",padreId:X,tipo:K});if(X===null){const ae=await it.get("/world-bible/folders");s(ae),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:null}}))}else window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:X,optimisticType:"folder",item:Q,expand:!0}}))}catch(X){console.error("Error creating simple folder:",X)}},B=async F=>{try{const K=v?v.id:null,X=await it.post("/world-bible/folders",{nombre:F.nombre,descripcion:F.descripcion,padreId:K,tipo:F.tipo});if(K===null){const Q=await it.get("/world-bible/folders");s(Q),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:null}}))}else X.id||console.error("CRITICAL: Created folder has no ID!",X),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:K,optimisticType:"folder",item:X,expand:!0}}))}catch(K){console.error(K),alert("Error creating folder/zone.")}},I=async(F,K="entidadindividual")=>{const X=typeof F=="object"?F.slug||F.id:F;r(`${E}/folder/${X}/entity/new/${K}`)},V=async(F,K)=>{try{await it.put(`/world-bible/folders/${F}`,{nombre:K}),s(X=>X.map(Q=>Q.id===F?{...Q,nombre:K}:Q))}catch(X){throw X}},$=(F,K=null)=>{k({id:F,parentId:K,type:"folder"}),S(!0)},Z=async()=>{if(!N)return;const{id:F,parentId:K,type:X,folderId:Q}=N;try{X==="folder"?(await it.delete(`/world-bible/folders/${F}`),K===null&&s(ae=>ae.filter(re=>re.id!==F)),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:K,removeId:F,type:"folder"}}))):X==="entity"&&(await it.delete(`/world-bible/entities/${F}`),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:Q,removeId:F,type:"entity"}})))}catch(ae){console.error("Deletion failed:",ae),alert("Error trying to delete item.")}finally{k(null)}},O=(F,K)=>{k({id:F,folderId:K,type:"entity"}),S(!0)},W=async(F,K,X,Q,ae)=>{try{if(X==="folder")typeof F=="number"&&!F.toString().startsWith("temp")&&(await it.put(`/world-bible/folders/${F}`,{nombre:K}),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:Q,confirmedType:"folder",oldId:F,item:{id:F,nombre:K,parentId:Q,tipo:ae,uiKey:Date.now()}}})),Q||s(re=>re.map(G=>G.id===F?{...G,nombre:K}:G)));else if(X==="entity")if(typeof F=="string"&&F.startsWith("new-")){const re=await it.post("/world-bible/entities",{nombre:K,carpetaId:Q,tipoEspecial:ae||"entidadindividual"});window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:Q,confirmedType:"entity",oldId:F,item:re}}))}else await it.put(`/world-bible/entities/${F}`,{nombre:K}),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:Q,confirmedType:"entity",oldId:F,item:{id:F,nombre:K,carpeta:{id:Q},tipoEspecial:ae,slug:F}}})),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:Q}}))}catch(re){console.error("Creation/Rename failed",re),X==="folder"&&$(F,Q)}};return p.jsxs("div",{className:"flex h-full w-full bg-background-dark max-w-[1920px] mx-auto",children:[p.jsxs("aside",{className:"w-80 flex-none flex flex-col border-r border-glass-border bg-surface-dark/50 z-10",children:[p.jsx("div",{className:"p-4 border-b border-glass-border",children:p.jsxs("div",{className:"relative group mb-3",children:[p.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-text-muted text-sm group-focus-within:text-primary transition-colors",children:"search"}),p.jsx("input",{type:"text",placeholder:"Buscar en Biblia...",className:"w-full bg-surface-light/50 border border-glass-border rounded-xl py-2 pl-9 pr-3 text-xs focus:border-primary/50 outline-none transition-all text-white placeholder:text-text-muted/50"})]})}),p.jsxs("div",{className:"px-2 pt-2",children:[p.jsx("div",{className:"flex items-center justify-between px-2 mb-1",children:p.jsx("h2",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted",children:"Favoritos"})}),o.length>0?p.jsx("div",{className:"space-y-0.5",children:o.map(F=>p.jsxs("div",{onClick:()=>r(`${E}/folder/${F.carpeta.slug||F.carpeta.id}/entity/${F.slug||F.id}`),className:"flex items-center gap-3 px-3 py-1.5 rounded-lg text-[11px] font-medium text-text-muted hover:text-white hover:bg-white/5 cursor-pointer transition-all group",children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-500/70 group-hover:text-yellow-400",children:"star"}),p.jsx("span",{className:"truncate",children:F.nombre})]},F.id))}):p.jsx("div",{className:"px-4 py-2 text-[10px] text-text-muted/30 italic",children:"Sin favoritos"}),p.jsx("div",{className:"h-px bg-glass-border my-2 opacity-50"})]}),p.jsx("div",{className:"p-4 border-b border-glass-border pt-0",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h2",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted",children:"Explorador"}),p.jsx("div",{className:"relative",children:p.jsx("button",{className:"transition-colors hover:text-white text-primary",onClick:()=>D(null),title:"Crear Carpeta",children:p.jsx("span",{className:"material-symbols-outlined text-sm",children:"create_new_folder"})})})]})}),p.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar p-2 space-y-0.5",children:a.length===0?p.jsxs("div",{className:"p-8 text-center opacity-30",children:[p.jsx("span",{className:"material-symbols-outlined text-3xl mb-2",children:"folder_off"}),p.jsx("p",{className:"text-[10px] uppercase font-bold",children:"Biblia Vaca"})]}):a.map(F=>p.jsx(jj,{folder:F,onCreateSubfolder:()=>{},onRename:V,onDeleteFolder:$,onDeleteEntity:$,onCreateTemplate:()=>{},onMoveEntity:(K,X,Q)=>console.log("move",K,X,Q),onCreateEntity:I,onConfirmCreate:W},F.uiKey||F.id))})]}),p.jsx("main",{className:"flex-1 overflow-hidden relative bg-gradient-to-br from-background-dark to-surface-dark/20",children:p.jsx(__,{context:{...i,folders:a,handleCreateEntity:I,handleOpenCreateModal:j,handleDeleteFolder:$,handleDeleteEntity:O,handleCreateSimpleFolder:D}})}),p.jsx(SX,{isOpen:f,onClose:()=>g(!1),onCreate:B,parentFolder:v}),p.jsx(nv,{isOpen:_,onClose:()=>S(!1),onConfirm:Z,title:N?.type==="folder"?"Borrar Carpeta":"Borrar Entidad",message:N?.type==="folder"?"Esta accin eliminar la carpeta y todo su contenido. Ests seguro?":"Ests seguro de querer eliminar esta entidad de tu mundo?",confirmText:"S, borrar"})]})},CX=()=>{const{username:t,projectName:e}=ds();Ga();const{handleOpenCreateModal:r,handleDeleteFolder:n,handleCreateSimpleFolder:i,handleRenameFolder:a,folders:s=[]}=Zu(),[o,l]=ce.useState(null),[u,c]=ce.useState(null),[f,g]=ce.useState(""),v=(S,N)=>{S.preventDefault(),S.stopPropagation(),l({x:S.clientX,y:S.clientY,folder:N})},x=()=>l(null);ce.useEffect(()=>{if(o){const S=()=>x();return window.addEventListener("click",S),()=>window.removeEventListener("click",S)}},[o]);const _=async(S,N)=>{N.trim()&&a&&await a(S,N.trim()),c(null),g("")};return s===void 0?p.jsx("div",{className:"p-20 text-center animate-pulse text-text-muted",children:"Loading World Bible..."}):p.jsxs("div",{className:"flex-1 p-8 max-w-[1600px] mx-auto w-full h-full overflow-y-auto",children:[p.jsxs("header",{className:"mb-8 flex items-end justify-between",children:[p.jsxs("div",{children:[p.jsxs("div",{className:"flex items-center gap-3 text-xs font-black uppercase tracking-widest text-primary italic mb-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"}),"World Bible"]}),p.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter",children:"Root Index"}),p.jsx("p",{className:"text-text-muted mt-2 max-w-lg text-sm",children:"The central archive of your world. Organize characters, locations, timelines, and maps."})]}),p.jsx("div",{className:"flex items-center gap-2",children:p.jsxs("button",{onClick:()=>i(null,"FOLDER"),className:"px-6 py-2 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold flex items-center gap-2 transition-all shadow-lg shadow-primary/20",children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"create_new_folder"})," Nueva Carpeta"]})})]}),p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:s.map(S=>u===S.id?p.jsx("div",{className:"p-4 rounded-3xl bg-surface-dark border border-primary/50",children:p.jsx("input",{autoFocus:!0,type:"text",value:f,onChange:N=>g(N.target.value),onKeyDown:N=>{N.key==="Enter"&&_(S.id,f),N.key==="Escape"&&(c(null),g(""))},onBlur:()=>_(S.id,f),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none",placeholder:"Folder name..."})},S.id):p.jsx(y_,{item:S,type:"folder",linkTo:`/${t}/${e}/bible/folder/${S.slug||S.id}`,onDelete:()=>n(S.id),onContextMenu:N=>v(N,S)},S.id))}),s.length===0&&p.jsxs("div",{className:"p-20 text-center border-2 border-dashed border-glass-border rounded-[3rem] opacity-30 mt-8",children:[p.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 text-text-muted",children:"library_books"}),p.jsx("h3",{className:"text-xl font-bold text-white uppercase tracking-widest",children:"Archivo Vaco"}),p.jsx("p",{className:"text-text-muted mt-2",children:"Comienza creando espacios para organizar tu mundo."})]}),o&&p.jsxs("div",{className:"fixed bg-surface-dark border border-glass-border shadow-2xl rounded-xl py-2 z-50 w-52 text-xs font-medium flex flex-col animate-in fade-in zoom-in-95 duration-150",style:{top:o.y,left:o.x},onClick:S=>S.stopPropagation(),children:[p.jsxs("div",{className:"px-4 py-2 border-b border-white/5 font-bold text-text-muted truncate flex items-center gap-2",children:[p.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"folder"}),o.folder.nombre]}),p.jsxs("button",{className:"px-4 py-2.5 hover:bg-white/5 text-left flex items-center gap-3 text-white/80 hover:text-white transition-colors",onClick:()=>{c(o.folder.id),g(o.folder.nombre),x()},children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Renombrar"]}),p.jsxs("button",{className:"px-4 py-2.5 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-3 transition-colors",onClick:()=>{n(o.folder.id),x()},children:[p.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Eliminar Carpeta"]})]})]})};function EX(){return p.jsx(cL,{children:p.jsxs(rL,{children:[p.jsx(Mn,{path:"/",element:p.jsx(t8,{})}),p.jsxs(Mn,{element:p.jsx(KL,{}),children:[p.jsx(Mn,{path:"/settings",element:p.jsx(n8,{})}),p.jsxs(Mn,{path:"/:username/:projectName",element:p.jsx(a8,{}),children:[p.jsx(Mn,{index:!0,element:p.jsx(r8,{})}),p.jsx(Mn,{path:"writing",element:p.jsx(Q3,{})}),p.jsx(Mn,{path:"writing/:notebookId",element:p.jsx(Q3,{})}),p.jsx(Mn,{path:"entities/:type/:entityId",element:p.jsx(rz,{})}),p.jsx(Mn,{path:"map-editor/create/:folderId",element:p.jsx(D2,{mode:"create"})}),p.jsx(Mn,{path:"map-editor/edit/:entityId",element:p.jsx(D2,{mode:"edit"})}),p.jsxs(Mn,{path:"bible",element:p.jsx(kX,{}),children:[p.jsx(Mn,{index:!0,element:p.jsx(CX,{})}),p.jsx(Mn,{path:"folder/:folderSlug/entity/new/:type",element:p.jsx(ig,{mode:"creation"})}),p.jsx(Mn,{path:"folder/:folderSlug",element:p.jsx(bX,{})}),p.jsx(Mn,{path:"entity/:entitySlug",element:p.jsx(ig,{})}),p.jsx(Mn,{path:"folder/:folderSlug/entity/:entitySlug",element:p.jsx(ig,{})}),p.jsx(Mn,{path:"folder/:folderSlug/map/:entitySlug",element:p.jsx(ig,{})}),p.jsx(Mn,{path:"folder/:folderSlug/timeline/:entitySlug",element:p.jsx(ig,{})})]}),p.jsx(Mn,{path:"map",element:p.jsx(NV,{})}),p.jsx(Mn,{path:"timeline",element:p.jsx(nz,{})}),p.jsx(Mn,{path:"languages",element:p.jsx(AV,{})}),p.jsx(Mn,{path:"trash",element:p.jsx(fX,{})}),p.jsx(Mn,{path:"graph",element:p.jsx(XB,{})})]})]})]})})}const XS=(t,e,r,n="")=>{fetch("/api/logs/error",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:t,message:e,stack:r,componentStack:n})}).catch(i=>console.error("Failed to send error log:",i))};window.onerror=(t,e,r,n,i)=>{XS("Global Window Error",t,i?i.stack:`${e}:${r}:${n}`)};window.onunhandledrejection=t=>{XS("Unhandled Promise Rejection",t.reason?t.reason.message:"Unknown reason",t.reason?t.reason.stack:"")};class NX extends er.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,r){this.setState({error:e,errorInfo:r}),console.error("Uncaught Error:",e,r),XS("React ErrorBoundary",e.message,e.stack,r.componentStack)}render(){return this.state.hasError?p.jsxs("div",{style:{padding:20,background:"#222",color:"red",height:"100vh"},children:[p.jsx("h1",{children:"Something went wrong."}),p.jsxs("details",{style:{whiteSpace:"pre-wrap"},children:[this.state.error&&this.state.error.toString(),p.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}):this.props.children}}const J3=document.getElementById("root");J3?cR.createRoot(J3).render(p.jsx(er.StrictMode,{children:p.jsx(NX,{children:p.jsx(EX,{})})})):console.error("React root element not found (looked for #root)");

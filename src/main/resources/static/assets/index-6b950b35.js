function iB(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var lE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var eP={exports:{}},Ay={},tP={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hp=Symbol.for("react.element"),aB=Symbol.for("react.portal"),sB=Symbol.for("react.fragment"),oB=Symbol.for("react.strict_mode"),lB=Symbol.for("react.profiler"),cB=Symbol.for("react.provider"),uB=Symbol.for("react.context"),dB=Symbol.for("react.forward_ref"),fB=Symbol.for("react.suspense"),hB=Symbol.for("react.memo"),pB=Symbol.for("react.lazy"),cE=Symbol.iterator;function mB(t){return t===null||typeof t!="object"?null:(t=cE&&t[cE]||t["@@iterator"],typeof t=="function"?t:null)}var rP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nP=Object.assign,iP={};function Qd(t,e,r){this.props=t,this.context=e,this.refs=iP,this.updater=r||rP}Qd.prototype.isReactComponent={};Qd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Qd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function aP(){}aP.prototype=Qd.prototype;function Xk(t,e,r){this.props=t,this.context=e,this.refs=iP,this.updater=r||rP}var Qk=Xk.prototype=new aP;Qk.constructor=Xk;nP(Qk,Qd.prototype);Qk.isPureReactComponent=!0;var uE=Array.isArray,sP=Object.prototype.hasOwnProperty,Jk={current:null},oP={key:!0,ref:!0,__self:!0,__source:!0};function lP(t,e,r){var n,i={},a=null,s=null;if(e!=null)for(n in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(a=""+e.key),e)sP.call(e,n)&&!oP.hasOwnProperty(n)&&(i[n]=e[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Hp,type:t,key:a,ref:s,props:i,_owner:Jk.current}}function gB(t,e){return{$$typeof:Hp,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Zk(t){return typeof t=="object"&&t!==null&&t.$$typeof===Hp}function vB(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var dE=/\/+/g;function Bb(t,e){return typeof t=="object"&&t!==null&&t.key!=null?vB(""+t.key):e.toString(36)}function mv(t,e,r,n,i){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case Hp:case aB:s=!0}}if(s)return s=t,i=i(s),t=n===""?"."+Bb(s,0):n,uE(i)?(r="",t!=null&&(r=t.replace(dE,"$&/")+"/"),mv(i,e,r,"",function(c){return c})):i!=null&&(Zk(i)&&(i=gB(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(dE,"$&/")+"/")+t)),e.push(i)),1;if(s=0,n=n===""?".":n+":",uE(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+Bb(a,o);s+=mv(a,e,r,l,i)}else if(l=mB(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+Bb(a,o++),s+=mv(a,e,r,l,i);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function hg(t,e,r){if(t==null)return t;var n=[],i=0;return mv(t,n,"","",function(a){return e.call(r,a,i++)}),n}function yB(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ni={current:null},gv={transition:null},xB={ReactCurrentDispatcher:ni,ReactCurrentBatchConfig:gv,ReactCurrentOwner:Jk};function cP(){throw Error("act(...) is not supported in production builds of React.")}wt.Children={map:hg,forEach:function(t,e,r){hg(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return hg(t,function(){e++}),e},toArray:function(t){return hg(t,function(e){return e})||[]},only:function(t){if(!Zk(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};wt.Component=Qd;wt.Fragment=sB;wt.Profiler=lB;wt.PureComponent=Xk;wt.StrictMode=oB;wt.Suspense=fB;wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xB;wt.act=cP;wt.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=nP({},t.props),i=t.key,a=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,s=Jk.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)sP.call(e,l)&&!oP.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Hp,type:t.type,key:i,ref:a,props:n,_owner:s}};wt.createContext=function(t){return t={$$typeof:uB,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:cB,_context:t},t.Consumer=t};wt.createElement=lP;wt.createFactory=function(t){var e=lP.bind(null,t);return e.type=t,e};wt.createRef=function(){return{current:null}};wt.forwardRef=function(t){return{$$typeof:dB,render:t}};wt.isValidElement=Zk;wt.lazy=function(t){return{$$typeof:pB,_payload:{_status:-1,_result:t},_init:yB}};wt.memo=function(t,e){return{$$typeof:hB,type:t,compare:e===void 0?null:e}};wt.startTransition=function(t){var e=gv.transition;gv.transition={};try{t()}finally{gv.transition=e}};wt.unstable_act=cP;wt.useCallback=function(t,e){return ni.current.useCallback(t,e)};wt.useContext=function(t){return ni.current.useContext(t)};wt.useDebugValue=function(){};wt.useDeferredValue=function(t){return ni.current.useDeferredValue(t)};wt.useEffect=function(t,e){return ni.current.useEffect(t,e)};wt.useId=function(){return ni.current.useId()};wt.useImperativeHandle=function(t,e,r){return ni.current.useImperativeHandle(t,e,r)};wt.useInsertionEffect=function(t,e){return ni.current.useInsertionEffect(t,e)};wt.useLayoutEffect=function(t,e){return ni.current.useLayoutEffect(t,e)};wt.useMemo=function(t,e){return ni.current.useMemo(t,e)};wt.useReducer=function(t,e,r){return ni.current.useReducer(t,e,r)};wt.useRef=function(t){return ni.current.useRef(t)};wt.useState=function(t){return ni.current.useState(t)};wt.useSyncExternalStore=function(t,e,r){return ni.current.useSyncExternalStore(t,e,r)};wt.useTransition=function(){return ni.current.useTransition()};wt.version="18.3.1";tP.exports=wt;var q=tP.exports;const kt=Gp(q),bB=iB({__proto__:null,default:kt},[q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wB=q,SB=Symbol.for("react.element"),kB=Symbol.for("react.fragment"),CB=Object.prototype.hasOwnProperty,NB=wB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,EB={key:!0,ref:!0,__self:!0,__source:!0};function uP(t,e,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(s=e.ref);for(n in e)CB.call(e,n)&&!EB.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:SB,type:t,key:a,ref:s,props:i,_owner:NB.current}}Ay.Fragment=kB;Ay.jsx=uP;Ay.jsxs=uP;eP.exports=Ay;var d=eP.exports,FS={},dP={exports:{}},Oi={},fP={exports:{}},hP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,Q){var K=F.length;F.push(Q);e:for(;0<K;){var L=K-1>>>1,G=F[L];if(0<i(G,Q))F[L]=Q,F[K]=G,K=L;else break e}}function r(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var Q=F[0],K=F.pop();if(K!==Q){F[0]=K;e:for(var L=0,G=F.length,ee=G>>>1;L<ee;){var re=2*(L+1)-1,se=F[re],de=re+1,W=F[de];if(0>i(se,K))de<G&&0>i(W,se)?(F[L]=W,F[de]=K,L=de):(F[L]=se,F[re]=K,L=re);else if(de<G&&0>i(W,K))F[L]=W,F[de]=K,L=de;else break e}}return Q}function i(F,Q){var K=F.sortIndex-Q.sortIndex;return K!==0?K:F.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();t.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,f=null,h=3,m=!1,v=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(F){for(var Q=r(c);Q!==null;){if(Q.callback===null)n(c);else if(Q.startTime<=F)n(c),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=r(c)}}function k(F){if(y=!1,w(F),!v)if(r(l)!==null)v=!0,z(N);else{var Q=r(c);Q!==null&&U(k,Q.startTime-F)}}function N(F,Q){v=!1,y&&(y=!1,b(M),M=-1),m=!0;var K=h;try{for(w(Q),f=r(l);f!==null&&(!(f.expirationTime>Q)||F&&!D());){var L=f.callback;if(typeof L=="function"){f.callback=null,h=f.priorityLevel;var G=L(f.expirationTime<=Q);Q=t.unstable_now(),typeof G=="function"?f.callback=G:f===r(l)&&n(l),w(Q)}else n(l);f=r(l)}if(f!==null)var ee=!0;else{var re=r(c);re!==null&&U(k,re.startTime-Q),ee=!1}return ee}finally{f=null,h=K,m=!1}}var j=!1,T=null,M=-1,A=5,_=-1;function D(){return!(t.unstable_now()-_<A)}function R(){if(T!==null){var F=t.unstable_now();_=F;var Q=!0;try{Q=T(!0,F)}finally{Q?I():(j=!1,T=null)}}else j=!1}var I;if(typeof S=="function")I=function(){S(R)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,B=$.port2;$.port1.onmessage=R,I=function(){B.postMessage(null)}}else I=function(){x(R,0)};function z(F){T=F,j||(j=!0,I())}function U(F,Q){M=x(function(){F(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,z(N))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(F){switch(h){case 1:case 2:case 3:var Q=3;break;default:Q=h}var K=h;h=Q;try{return F()}finally{h=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,Q){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var K=h;h=F;try{return Q()}finally{h=K}},t.unstable_scheduleCallback=function(F,Q,K){var L=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?L+K:L):K=L,F){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=K+G,F={id:u++,callback:Q,priorityLevel:F,startTime:K,expirationTime:G,sortIndex:-1},K>L?(F.sortIndex=K,e(c,F),r(l)===null&&F===r(c)&&(y?(b(M),M=-1):y=!0,U(k,K-L))):(F.sortIndex=G,e(l,F),v||m||(v=!0,z(N))),F},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(F){var Q=h;return function(){var K=h;h=Q;try{return F.apply(this,arguments)}finally{h=K}}}})(hP);fP.exports=hP;var Th=fP.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TB=q,Ri=Th;function Se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pP=new Set,Zh={};function Xc(t,e){Nd(t,e),Nd(t+"Capture",e)}function Nd(t,e){for(Zh[t]=e,t=0;t<e.length;t++)pP.add(e[t])}var Xs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zS=Object.prototype.hasOwnProperty,jB=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fE={},hE={};function MB(t){return zS.call(hE,t)?!0:zS.call(fE,t)?!1:jB.test(t)?hE[t]=!0:(fE[t]=!0,!1)}function PB(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function _B(t,e,r,n){if(e===null||typeof e>"u"||PB(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ii(t,e,r,n,i,a,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=s}var jn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){jn[t]=new ii(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];jn[e]=new ii(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){jn[t]=new ii(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){jn[t]=new ii(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){jn[t]=new ii(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){jn[t]=new ii(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){jn[t]=new ii(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){jn[t]=new ii(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){jn[t]=new ii(t,5,!1,t.toLowerCase(),null,!1,!1)});var eC=/[\-:]([a-z])/g;function tC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(eC,tC);jn[e]=new ii(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(eC,tC);jn[e]=new ii(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(eC,tC);jn[e]=new ii(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){jn[t]=new ii(t,1,!1,t.toLowerCase(),null,!1,!1)});jn.xlinkHref=new ii("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){jn[t]=new ii(t,1,!1,t.toLowerCase(),null,!0,!0)});function rC(t,e,r,n){var i=jn.hasOwnProperty(e)?jn[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_B(e,r,i,n)&&(r=null),n||i===null?MB(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var no=TB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pg=Symbol.for("react.element"),Ku=Symbol.for("react.portal"),Yu=Symbol.for("react.fragment"),nC=Symbol.for("react.strict_mode"),VS=Symbol.for("react.profiler"),mP=Symbol.for("react.provider"),gP=Symbol.for("react.context"),iC=Symbol.for("react.forward_ref"),$S=Symbol.for("react.suspense"),US=Symbol.for("react.suspense_list"),aC=Symbol.for("react.memo"),Ro=Symbol.for("react.lazy"),vP=Symbol.for("react.offscreen"),pE=Symbol.iterator;function Bf(t){return t===null||typeof t!="object"?null:(t=pE&&t[pE]||t["@@iterator"],typeof t=="function"?t:null)}var yr=Object.assign,Fb;function mh(t){if(Fb===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Fb=e&&e[1]||""}return`
`+Fb+t}var zb=!1;function Vb(t,e){if(!t||zb)return"";zb=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var l=`
`+i[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=s&&0<=o);break}}}finally{zb=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?mh(t):""}function AB(t){switch(t.tag){case 5:return mh(t.type);case 16:return mh("Lazy");case 13:return mh("Suspense");case 19:return mh("SuspenseList");case 0:case 2:case 15:return t=Vb(t.type,!1),t;case 11:return t=Vb(t.type.render,!1),t;case 1:return t=Vb(t.type,!0),t;default:return""}}function GS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Yu:return"Fragment";case Ku:return"Portal";case VS:return"Profiler";case nC:return"StrictMode";case $S:return"Suspense";case US:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gP:return(t.displayName||"Context")+".Consumer";case mP:return(t._context.displayName||"Context")+".Provider";case iC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case aC:return e=t.displayName||null,e!==null?e:GS(t.type)||"Memo";case Ro:e=t._payload,t=t._init;try{return GS(t(e))}catch{}}return null}function RB(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return GS(e);case 8:return e===nC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function yP(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function DB(t){var e=yP(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function mg(t){t._valueTracker||(t._valueTracker=DB(t))}function xP(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=yP(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Wv(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function HS(t,e){var r=e.checked;return yr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function mE(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=hl(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bP(t,e){e=e.checked,e!=null&&rC(t,"checked",e,!1)}function WS(t,e){bP(t,e);var r=hl(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?qS(t,e.type,r):e.hasOwnProperty("defaultValue")&&qS(t,e.type,hl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function gE(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function qS(t,e,r){(e!=="number"||Wv(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var gh=Array.isArray;function dd(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+hl(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function KS(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Se(91));return yr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function vE(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Se(92));if(gh(r)){if(1<r.length)throw Error(Se(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:hl(r)}}function wP(t,e){var r=hl(e.value),n=hl(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function yE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function SP(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function YS(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?SP(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var gg,kP=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(gg=gg||document.createElement("div"),gg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gg.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ep(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var jh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},OB=["Webkit","ms","Moz","O"];Object.keys(jh).forEach(function(t){OB.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),jh[e]=jh[t]})});function CP(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||jh.hasOwnProperty(t)&&jh[t]?(""+e).trim():e+"px"}function NP(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=CP(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var IB=yr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function XS(t,e){if(e){if(IB[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Se(62))}}function QS(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JS=null;function sC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ZS=null,fd=null,hd=null;function xE(t){if(t=Kp(t)){if(typeof ZS!="function")throw Error(Se(280));var e=t.stateNode;e&&(e=Ly(e),ZS(t.stateNode,t.type,e))}}function EP(t){fd?hd?hd.push(t):hd=[t]:fd=t}function TP(){if(fd){var t=fd,e=hd;if(hd=fd=null,xE(t),e)for(t=0;t<e.length;t++)xE(e[t])}}function jP(t,e){return t(e)}function MP(){}var $b=!1;function PP(t,e,r){if($b)return t(e,r);$b=!0;try{return jP(t,e,r)}finally{$b=!1,(fd!==null||hd!==null)&&(MP(),TP())}}function tp(t,e){var r=t.stateNode;if(r===null)return null;var n=Ly(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Se(231,e,typeof r));return r}var e5=!1;if(Xs)try{var Ff={};Object.defineProperty(Ff,"passive",{get:function(){e5=!0}}),window.addEventListener("test",Ff,Ff),window.removeEventListener("test",Ff,Ff)}catch{e5=!1}function LB(t,e,r,n,i,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var Mh=!1,qv=null,Kv=!1,t5=null,BB={onError:function(t){Mh=!0,qv=t}};function FB(t,e,r,n,i,a,s,o,l){Mh=!1,qv=null,LB.apply(BB,arguments)}function zB(t,e,r,n,i,a,s,o,l){if(FB.apply(this,arguments),Mh){if(Mh){var c=qv;Mh=!1,qv=null}else throw Error(Se(198));Kv||(Kv=!0,t5=c)}}function Qc(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function _P(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bE(t){if(Qc(t)!==t)throw Error(Se(188))}function VB(t){var e=t.alternate;if(!e){if(e=Qc(t),e===null)throw Error(Se(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return bE(i),t;if(a===n)return bE(i),e;a=a.sibling}throw Error(Se(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(Se(189))}}if(r.alternate!==n)throw Error(Se(190))}if(r.tag!==3)throw Error(Se(188));return r.stateNode.current===r?t:e}function AP(t){return t=VB(t),t!==null?RP(t):null}function RP(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=RP(t);if(e!==null)return e;t=t.sibling}return null}var DP=Ri.unstable_scheduleCallback,wE=Ri.unstable_cancelCallback,$B=Ri.unstable_shouldYield,UB=Ri.unstable_requestPaint,Ar=Ri.unstable_now,GB=Ri.unstable_getCurrentPriorityLevel,oC=Ri.unstable_ImmediatePriority,OP=Ri.unstable_UserBlockingPriority,Yv=Ri.unstable_NormalPriority,HB=Ri.unstable_LowPriority,IP=Ri.unstable_IdlePriority,Ry=null,ls=null;function WB(t){if(ls&&typeof ls.onCommitFiberRoot=="function")try{ls.onCommitFiberRoot(Ry,t,void 0,(t.current.flags&128)===128)}catch{}}var Aa=Math.clz32?Math.clz32:YB,qB=Math.log,KB=Math.LN2;function YB(t){return t>>>=0,t===0?32:31-(qB(t)/KB|0)|0}var vg=64,yg=4194304;function vh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xv(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,a=t.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=vh(o):(a&=s,a!==0&&(n=vh(a)))}else s=r&~i,s!==0?n=vh(s):a!==0&&(n=vh(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,a=e&-e,i>=a||i===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Aa(e),i=1<<r,n|=t[r],e&=~i;return n}function XB(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function QB(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,a=t.pendingLanes;0<a;){var s=31-Aa(a),o=1<<s,l=i[s];l===-1?(!(o&r)||o&n)&&(i[s]=XB(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function r5(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function LP(){var t=vg;return vg<<=1,!(vg&4194240)&&(vg=64),t}function Ub(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Wp(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Aa(e),t[e]=r}function JB(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-Aa(r),a=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~a}}function lC(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Aa(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var Ft=0;function BP(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var FP,cC,zP,VP,$P,n5=!1,xg=[],Jo=null,Zo=null,el=null,rp=new Map,np=new Map,Fo=[],ZB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function SE(t,e){switch(t){case"focusin":case"focusout":Jo=null;break;case"dragenter":case"dragleave":Zo=null;break;case"mouseover":case"mouseout":el=null;break;case"pointerover":case"pointerout":rp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":np.delete(e.pointerId)}}function zf(t,e,r,n,i,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},e!==null&&(e=Kp(e),e!==null&&cC(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function eF(t,e,r,n,i){switch(e){case"focusin":return Jo=zf(Jo,t,e,r,n,i),!0;case"dragenter":return Zo=zf(Zo,t,e,r,n,i),!0;case"mouseover":return el=zf(el,t,e,r,n,i),!0;case"pointerover":var a=i.pointerId;return rp.set(a,zf(rp.get(a)||null,t,e,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,np.set(a,zf(np.get(a)||null,t,e,r,n,i)),!0}return!1}function UP(t){var e=mc(t.target);if(e!==null){var r=Qc(e);if(r!==null){if(e=r.tag,e===13){if(e=_P(r),e!==null){t.blockedOn=e,$P(t.priority,function(){zP(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function vv(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=i5(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);JS=n,r.target.dispatchEvent(n),JS=null}else return e=Kp(r),e!==null&&cC(e),t.blockedOn=r,!1;e.shift()}return!0}function kE(t,e,r){vv(t)&&r.delete(e)}function tF(){n5=!1,Jo!==null&&vv(Jo)&&(Jo=null),Zo!==null&&vv(Zo)&&(Zo=null),el!==null&&vv(el)&&(el=null),rp.forEach(kE),np.forEach(kE)}function Vf(t,e){t.blockedOn===e&&(t.blockedOn=null,n5||(n5=!0,Ri.unstable_scheduleCallback(Ri.unstable_NormalPriority,tF)))}function ip(t){function e(i){return Vf(i,t)}if(0<xg.length){Vf(xg[0],t);for(var r=1;r<xg.length;r++){var n=xg[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Jo!==null&&Vf(Jo,t),Zo!==null&&Vf(Zo,t),el!==null&&Vf(el,t),rp.forEach(e),np.forEach(e),r=0;r<Fo.length;r++)n=Fo[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Fo.length&&(r=Fo[0],r.blockedOn===null);)UP(r),r.blockedOn===null&&Fo.shift()}var pd=no.ReactCurrentBatchConfig,Qv=!0;function rF(t,e,r,n){var i=Ft,a=pd.transition;pd.transition=null;try{Ft=1,uC(t,e,r,n)}finally{Ft=i,pd.transition=a}}function nF(t,e,r,n){var i=Ft,a=pd.transition;pd.transition=null;try{Ft=4,uC(t,e,r,n)}finally{Ft=i,pd.transition=a}}function uC(t,e,r,n){if(Qv){var i=i5(t,e,r,n);if(i===null)Zb(t,e,n,Jv,r),SE(t,n);else if(eF(i,t,e,r,n))n.stopPropagation();else if(SE(t,n),e&4&&-1<ZB.indexOf(t)){for(;i!==null;){var a=Kp(i);if(a!==null&&FP(a),a=i5(t,e,r,n),a===null&&Zb(t,e,n,Jv,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else Zb(t,e,n,null,r)}}var Jv=null;function i5(t,e,r,n){if(Jv=null,t=sC(n),t=mc(t),t!==null)if(e=Qc(t),e===null)t=null;else if(r=e.tag,r===13){if(t=_P(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Jv=t,null}function GP(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(GB()){case oC:return 1;case OP:return 4;case Yv:case HB:return 16;case IP:return 536870912;default:return 16}default:return 16}}var Uo=null,dC=null,yv=null;function HP(){if(yv)return yv;var t,e=dC,r=e.length,n,i="value"in Uo?Uo.value:Uo.textContent,a=i.length;for(t=0;t<r&&e[t]===i[t];t++);var s=r-t;for(n=1;n<=s&&e[r-n]===i[a-n];n++);return yv=i.slice(t,1<n?1-n:void 0)}function xv(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function bg(){return!0}function CE(){return!1}function Ii(t){function e(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?bg:CE,this.isPropagationStopped=CE,this}return yr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=bg)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=bg)},persist:function(){},isPersistent:bg}),e}var Jd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fC=Ii(Jd),qp=yr({},Jd,{view:0,detail:0}),iF=Ii(qp),Gb,Hb,$f,Dy=yr({},qp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hC,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$f&&($f&&t.type==="mousemove"?(Gb=t.screenX-$f.screenX,Hb=t.screenY-$f.screenY):Hb=Gb=0,$f=t),Gb)},movementY:function(t){return"movementY"in t?t.movementY:Hb}}),NE=Ii(Dy),aF=yr({},Dy,{dataTransfer:0}),sF=Ii(aF),oF=yr({},qp,{relatedTarget:0}),Wb=Ii(oF),lF=yr({},Jd,{animationName:0,elapsedTime:0,pseudoElement:0}),cF=Ii(lF),uF=yr({},Jd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),dF=Ii(uF),fF=yr({},Jd,{data:0}),EE=Ii(fF),hF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gF(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mF[t])?!!e[t]:!1}function hC(){return gF}var vF=yr({},qp,{key:function(t){if(t.key){var e=hF[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=xv(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?pF[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hC,charCode:function(t){return t.type==="keypress"?xv(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xv(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yF=Ii(vF),xF=yr({},Dy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),TE=Ii(xF),bF=yr({},qp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hC}),wF=Ii(bF),SF=yr({},Jd,{propertyName:0,elapsedTime:0,pseudoElement:0}),kF=Ii(SF),CF=yr({},Dy,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),NF=Ii(CF),EF=[9,13,27,32],pC=Xs&&"CompositionEvent"in window,Ph=null;Xs&&"documentMode"in document&&(Ph=document.documentMode);var TF=Xs&&"TextEvent"in window&&!Ph,WP=Xs&&(!pC||Ph&&8<Ph&&11>=Ph),jE=String.fromCharCode(32),ME=!1;function qP(t,e){switch(t){case"keyup":return EF.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function KP(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Xu=!1;function jF(t,e){switch(t){case"compositionend":return KP(e);case"keypress":return e.which!==32?null:(ME=!0,jE);case"textInput":return t=e.data,t===jE&&ME?null:t;default:return null}}function MF(t,e){if(Xu)return t==="compositionend"||!pC&&qP(t,e)?(t=HP(),yv=dC=Uo=null,Xu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return WP&&e.locale!=="ko"?null:e.data;default:return null}}var PF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function PE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!PF[t.type]:e==="textarea"}function YP(t,e,r,n){EP(n),e=Zv(e,"onChange"),0<e.length&&(r=new fC("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var _h=null,ap=null;function _F(t){s_(t,0)}function Oy(t){var e=Zu(t);if(xP(e))return t}function AF(t,e){if(t==="change")return e}var XP=!1;if(Xs){var qb;if(Xs){var Kb="oninput"in document;if(!Kb){var _E=document.createElement("div");_E.setAttribute("oninput","return;"),Kb=typeof _E.oninput=="function"}qb=Kb}else qb=!1;XP=qb&&(!document.documentMode||9<document.documentMode)}function AE(){_h&&(_h.detachEvent("onpropertychange",QP),ap=_h=null)}function QP(t){if(t.propertyName==="value"&&Oy(ap)){var e=[];YP(e,ap,t,sC(t)),PP(_F,e)}}function RF(t,e,r){t==="focusin"?(AE(),_h=e,ap=r,_h.attachEvent("onpropertychange",QP)):t==="focusout"&&AE()}function DF(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Oy(ap)}function OF(t,e){if(t==="click")return Oy(e)}function IF(t,e){if(t==="input"||t==="change")return Oy(e)}function LF(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ia=typeof Object.is=="function"?Object.is:LF;function sp(t,e){if(Ia(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!zS.call(e,i)||!Ia(t[i],e[i]))return!1}return!0}function RE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function DE(t,e){var r=RE(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=RE(r)}}function JP(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?JP(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ZP(){for(var t=window,e=Wv();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Wv(t.document)}return e}function mC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function BF(t){var e=ZP(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&JP(r.ownerDocument.documentElement,r)){if(n!==null&&mC(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!t.extend&&a>n&&(i=n,n=a,a=i),i=DE(r,a);var s=DE(r,n);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var FF=Xs&&"documentMode"in document&&11>=document.documentMode,Qu=null,a5=null,Ah=null,s5=!1;function OE(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;s5||Qu==null||Qu!==Wv(n)||(n=Qu,"selectionStart"in n&&mC(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ah&&sp(Ah,n)||(Ah=n,n=Zv(a5,"onSelect"),0<n.length&&(e=new fC("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Qu)))}function wg(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ju={animationend:wg("Animation","AnimationEnd"),animationiteration:wg("Animation","AnimationIteration"),animationstart:wg("Animation","AnimationStart"),transitionend:wg("Transition","TransitionEnd")},Yb={},e_={};Xs&&(e_=document.createElement("div").style,"AnimationEvent"in window||(delete Ju.animationend.animation,delete Ju.animationiteration.animation,delete Ju.animationstart.animation),"TransitionEvent"in window||delete Ju.transitionend.transition);function Iy(t){if(Yb[t])return Yb[t];if(!Ju[t])return t;var e=Ju[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in e_)return Yb[t]=e[r];return t}var t_=Iy("animationend"),r_=Iy("animationiteration"),n_=Iy("animationstart"),i_=Iy("transitionend"),a_=new Map,IE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cl(t,e){a_.set(t,e),Xc(e,[t])}for(var Xb=0;Xb<IE.length;Xb++){var Qb=IE[Xb],zF=Qb.toLowerCase(),VF=Qb[0].toUpperCase()+Qb.slice(1);Cl(zF,"on"+VF)}Cl(t_,"onAnimationEnd");Cl(r_,"onAnimationIteration");Cl(n_,"onAnimationStart");Cl("dblclick","onDoubleClick");Cl("focusin","onFocus");Cl("focusout","onBlur");Cl(i_,"onTransitionEnd");Nd("onMouseEnter",["mouseout","mouseover"]);Nd("onMouseLeave",["mouseout","mouseover"]);Nd("onPointerEnter",["pointerout","pointerover"]);Nd("onPointerLeave",["pointerout","pointerover"]);Xc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$F=new Set("cancel close invalid load scroll toggle".split(" ").concat(yh));function LE(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,zB(n,e,void 0,t),t.currentTarget=null}function s_(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;LE(i,o,c),a=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;LE(i,o,c),a=l}}}if(Kv)throw t=t5,Kv=!1,t5=null,t}function er(t,e){var r=e[d5];r===void 0&&(r=e[d5]=new Set);var n=t+"__bubble";r.has(n)||(o_(e,t,2,!1),r.add(n))}function Jb(t,e,r){var n=0;e&&(n|=4),o_(r,t,n,e)}var Sg="_reactListening"+Math.random().toString(36).slice(2);function op(t){if(!t[Sg]){t[Sg]=!0,pP.forEach(function(r){r!=="selectionchange"&&($F.has(r)||Jb(r,!1,t),Jb(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Sg]||(e[Sg]=!0,Jb("selectionchange",!1,e))}}function o_(t,e,r,n){switch(GP(e)){case 1:var i=rF;break;case 4:i=nF;break;default:i=uC}r=i.bind(null,e,r,t),i=void 0,!e5||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Zb(t,e,r,n,i){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;o!==null;){if(s=mc(o),s===null)return;if(l=s.tag,l===5||l===6){n=a=s;continue e}o=o.parentNode}}n=n.return}PP(function(){var c=a,u=sC(r),f=[];e:{var h=a_.get(t);if(h!==void 0){var m=fC,v=t;switch(t){case"keypress":if(xv(r)===0)break e;case"keydown":case"keyup":m=yF;break;case"focusin":v="focus",m=Wb;break;case"focusout":v="blur",m=Wb;break;case"beforeblur":case"afterblur":m=Wb;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=NE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=sF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=wF;break;case t_:case r_:case n_:m=cF;break;case i_:m=kF;break;case"scroll":m=iF;break;case"wheel":m=NF;break;case"copy":case"cut":case"paste":m=dF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=TE}var y=(e&4)!==0,x=!y&&t==="scroll",b=y?h!==null?h+"Capture":null:h;y=[];for(var S=c,w;S!==null;){w=S;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,b!==null&&(k=tp(S,b),k!=null&&y.push(lp(S,k,w)))),x)break;S=S.return}0<y.length&&(h=new m(h,v,null,r,u),f.push({event:h,listeners:y}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&r!==JS&&(v=r.relatedTarget||r.fromElement)&&(mc(v)||v[Qs]))break e;if((m||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=c,v=v?mc(v):null,v!==null&&(x=Qc(v),v!==x||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=c),m!==v)){if(y=NE,k="onMouseLeave",b="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(y=TE,k="onPointerLeave",b="onPointerEnter",S="pointer"),x=m==null?h:Zu(m),w=v==null?h:Zu(v),h=new y(k,S+"leave",m,r,u),h.target=x,h.relatedTarget=w,k=null,mc(u)===c&&(y=new y(b,S+"enter",v,r,u),y.target=w,y.relatedTarget=x,k=y),x=k,m&&v)t:{for(y=m,b=v,S=0,w=y;w;w=Tu(w))S++;for(w=0,k=b;k;k=Tu(k))w++;for(;0<S-w;)y=Tu(y),S--;for(;0<w-S;)b=Tu(b),w--;for(;S--;){if(y===b||b!==null&&y===b.alternate)break t;y=Tu(y),b=Tu(b)}y=null}else y=null;m!==null&&BE(f,h,m,y,!1),v!==null&&x!==null&&BE(f,x,v,y,!0)}}e:{if(h=c?Zu(c):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var N=AF;else if(PE(h))if(XP)N=IF;else{N=DF;var j=RF}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=OF);if(N&&(N=N(t,c))){YP(f,N,r,u);break e}j&&j(t,h,c),t==="focusout"&&(j=h._wrapperState)&&j.controlled&&h.type==="number"&&qS(h,"number",h.value)}switch(j=c?Zu(c):window,t){case"focusin":(PE(j)||j.contentEditable==="true")&&(Qu=j,a5=c,Ah=null);break;case"focusout":Ah=a5=Qu=null;break;case"mousedown":s5=!0;break;case"contextmenu":case"mouseup":case"dragend":s5=!1,OE(f,r,u);break;case"selectionchange":if(FF)break;case"keydown":case"keyup":OE(f,r,u)}var T;if(pC)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Xu?qP(t,r)&&(M="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(M="onCompositionStart");M&&(WP&&r.locale!=="ko"&&(Xu||M!=="onCompositionStart"?M==="onCompositionEnd"&&Xu&&(T=HP()):(Uo=u,dC="value"in Uo?Uo.value:Uo.textContent,Xu=!0)),j=Zv(c,M),0<j.length&&(M=new EE(M,t,null,r,u),f.push({event:M,listeners:j}),T?M.data=T:(T=KP(r),T!==null&&(M.data=T)))),(T=TF?jF(t,r):MF(t,r))&&(c=Zv(c,"onBeforeInput"),0<c.length&&(u=new EE("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=T))}s_(f,e)})}function lp(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Zv(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=tp(t,r),a!=null&&n.unshift(lp(t,a,i)),a=tp(t,e),a!=null&&n.push(lp(t,a,i))),t=t.return}return n}function Tu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function BE(t,e,r,n,i){for(var a=e._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=tp(r,a),l!=null&&s.unshift(lp(r,l,o))):i||(l=tp(r,a),l!=null&&s.push(lp(r,l,o)))),r=r.return}s.length!==0&&t.push({event:e,listeners:s})}var UF=/\r\n?/g,GF=/\u0000|\uFFFD/g;function FE(t){return(typeof t=="string"?t:""+t).replace(UF,`
`).replace(GF,"")}function kg(t,e,r){if(e=FE(e),FE(t)!==e&&r)throw Error(Se(425))}function e0(){}var o5=null,l5=null;function c5(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var u5=typeof setTimeout=="function"?setTimeout:void 0,HF=typeof clearTimeout=="function"?clearTimeout:void 0,zE=typeof Promise=="function"?Promise:void 0,WF=typeof queueMicrotask=="function"?queueMicrotask:typeof zE<"u"?function(t){return zE.resolve(null).then(t).catch(qF)}:u5;function qF(t){setTimeout(function(){throw t})}function ew(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),ip(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);ip(e)}function tl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function VE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Zd=Math.random().toString(36).slice(2),is="__reactFiber$"+Zd,cp="__reactProps$"+Zd,Qs="__reactContainer$"+Zd,d5="__reactEvents$"+Zd,KF="__reactListeners$"+Zd,YF="__reactHandles$"+Zd;function mc(t){var e=t[is];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Qs]||r[is]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=VE(t);t!==null;){if(r=t[is])return r;t=VE(t)}return e}t=r,r=t.parentNode}return null}function Kp(t){return t=t[is]||t[Qs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zu(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Se(33))}function Ly(t){return t[cp]||null}var f5=[],ed=-1;function Nl(t){return{current:t}}function rr(t){0>ed||(t.current=f5[ed],f5[ed]=null,ed--)}function Xt(t,e){ed++,f5[ed]=t.current,t.current=e}var pl={},Un=Nl(pl),yi=Nl(!1),Ac=pl;function Ed(t,e){var r=t.type.contextTypes;if(!r)return pl;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function xi(t){return t=t.childContextTypes,t!=null}function t0(){rr(yi),rr(Un)}function $E(t,e,r){if(Un.current!==pl)throw Error(Se(168));Xt(Un,e),Xt(yi,r)}function l_(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(Se(108,RB(t)||"Unknown",i));return yr({},r,n)}function r0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||pl,Ac=Un.current,Xt(Un,t),Xt(yi,yi.current),!0}function UE(t,e,r){var n=t.stateNode;if(!n)throw Error(Se(169));r?(t=l_(t,e,Ac),n.__reactInternalMemoizedMergedChildContext=t,rr(yi),rr(Un),Xt(Un,t)):rr(yi),Xt(yi,r)}var zs=null,By=!1,tw=!1;function c_(t){zs===null?zs=[t]:zs.push(t)}function XF(t){By=!0,c_(t)}function El(){if(!tw&&zs!==null){tw=!0;var t=0,e=Ft;try{var r=zs;for(Ft=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}zs=null,By=!1}catch(i){throw zs!==null&&(zs=zs.slice(t+1)),DP(oC,El),i}finally{Ft=e,tw=!1}}return null}var td=[],rd=0,n0=null,i0=0,Zi=[],ea=0,Rc=null,$s=1,Us="";function oc(t,e){td[rd++]=i0,td[rd++]=n0,n0=t,i0=e}function u_(t,e,r){Zi[ea++]=$s,Zi[ea++]=Us,Zi[ea++]=Rc,Rc=t;var n=$s;t=Us;var i=32-Aa(n)-1;n&=~(1<<i),r+=1;var a=32-Aa(e)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,$s=1<<32-Aa(e)+i|r<<i|n,Us=a+t}else $s=1<<a|r<<i|n,Us=t}function gC(t){t.return!==null&&(oc(t,1),u_(t,1,0))}function vC(t){for(;t===n0;)n0=td[--rd],td[rd]=null,i0=td[--rd],td[rd]=null;for(;t===Rc;)Rc=Zi[--ea],Zi[ea]=null,Us=Zi[--ea],Zi[ea]=null,$s=Zi[--ea],Zi[ea]=null}var _i=null,Pi=null,or=!1,ja=null;function d_(t,e){var r=na(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function GE(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,_i=t,Pi=tl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,_i=t,Pi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Rc!==null?{id:$s,overflow:Us}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=na(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,_i=t,Pi=null,!0):!1;default:return!1}}function h5(t){return(t.mode&1)!==0&&(t.flags&128)===0}function p5(t){if(or){var e=Pi;if(e){var r=e;if(!GE(t,e)){if(h5(t))throw Error(Se(418));e=tl(r.nextSibling);var n=_i;e&&GE(t,e)?d_(n,r):(t.flags=t.flags&-4097|2,or=!1,_i=t)}}else{if(h5(t))throw Error(Se(418));t.flags=t.flags&-4097|2,or=!1,_i=t}}}function HE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;_i=t}function Cg(t){if(t!==_i)return!1;if(!or)return HE(t),or=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!c5(t.type,t.memoizedProps)),e&&(e=Pi)){if(h5(t))throw f_(),Error(Se(418));for(;e;)d_(t,e),e=tl(e.nextSibling)}if(HE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Pi=tl(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Pi=null}}else Pi=_i?tl(t.stateNode.nextSibling):null;return!0}function f_(){for(var t=Pi;t;)t=tl(t.nextSibling)}function Td(){Pi=_i=null,or=!1}function yC(t){ja===null?ja=[t]:ja.push(t)}var QF=no.ReactCurrentBatchConfig;function Uf(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Se(309));var n=r.stateNode}if(!n)throw Error(Se(147,t));var i=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},e._stringRef=a,e)}if(typeof t!="string")throw Error(Se(284));if(!r._owner)throw Error(Se(290,t))}return t}function Ng(t,e){throw t=Object.prototype.toString.call(e),Error(Se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function WE(t){var e=t._init;return e(t._payload)}function h_(t){function e(b,S){if(t){var w=b.deletions;w===null?(b.deletions=[S],b.flags|=16):w.push(S)}}function r(b,S){if(!t)return null;for(;S!==null;)e(b,S),S=S.sibling;return null}function n(b,S){for(b=new Map;S!==null;)S.key!==null?b.set(S.key,S):b.set(S.index,S),S=S.sibling;return b}function i(b,S){return b=al(b,S),b.index=0,b.sibling=null,b}function a(b,S,w){return b.index=w,t?(w=b.alternate,w!==null?(w=w.index,w<S?(b.flags|=2,S):w):(b.flags|=2,S)):(b.flags|=1048576,S)}function s(b){return t&&b.alternate===null&&(b.flags|=2),b}function o(b,S,w,k){return S===null||S.tag!==6?(S=lw(w,b.mode,k),S.return=b,S):(S=i(S,w),S.return=b,S)}function l(b,S,w,k){var N=w.type;return N===Yu?u(b,S,w.props.children,k,w.key):S!==null&&(S.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ro&&WE(N)===S.type)?(k=i(S,w.props),k.ref=Uf(b,S,w),k.return=b,k):(k=Ev(w.type,w.key,w.props,null,b.mode,k),k.ref=Uf(b,S,w),k.return=b,k)}function c(b,S,w,k){return S===null||S.tag!==4||S.stateNode.containerInfo!==w.containerInfo||S.stateNode.implementation!==w.implementation?(S=cw(w,b.mode,k),S.return=b,S):(S=i(S,w.children||[]),S.return=b,S)}function u(b,S,w,k,N){return S===null||S.tag!==7?(S=Nc(w,b.mode,k,N),S.return=b,S):(S=i(S,w),S.return=b,S)}function f(b,S,w){if(typeof S=="string"&&S!==""||typeof S=="number")return S=lw(""+S,b.mode,w),S.return=b,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case pg:return w=Ev(S.type,S.key,S.props,null,b.mode,w),w.ref=Uf(b,null,S),w.return=b,w;case Ku:return S=cw(S,b.mode,w),S.return=b,S;case Ro:var k=S._init;return f(b,k(S._payload),w)}if(gh(S)||Bf(S))return S=Nc(S,b.mode,w,null),S.return=b,S;Ng(b,S)}return null}function h(b,S,w,k){var N=S!==null?S.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return N!==null?null:o(b,S,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case pg:return w.key===N?l(b,S,w,k):null;case Ku:return w.key===N?c(b,S,w,k):null;case Ro:return N=w._init,h(b,S,N(w._payload),k)}if(gh(w)||Bf(w))return N!==null?null:u(b,S,w,k,null);Ng(b,w)}return null}function m(b,S,w,k,N){if(typeof k=="string"&&k!==""||typeof k=="number")return b=b.get(w)||null,o(S,b,""+k,N);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case pg:return b=b.get(k.key===null?w:k.key)||null,l(S,b,k,N);case Ku:return b=b.get(k.key===null?w:k.key)||null,c(S,b,k,N);case Ro:var j=k._init;return m(b,S,w,j(k._payload),N)}if(gh(k)||Bf(k))return b=b.get(w)||null,u(S,b,k,N,null);Ng(S,k)}return null}function v(b,S,w,k){for(var N=null,j=null,T=S,M=S=0,A=null;T!==null&&M<w.length;M++){T.index>M?(A=T,T=null):A=T.sibling;var _=h(b,T,w[M],k);if(_===null){T===null&&(T=A);break}t&&T&&_.alternate===null&&e(b,T),S=a(_,S,M),j===null?N=_:j.sibling=_,j=_,T=A}if(M===w.length)return r(b,T),or&&oc(b,M),N;if(T===null){for(;M<w.length;M++)T=f(b,w[M],k),T!==null&&(S=a(T,S,M),j===null?N=T:j.sibling=T,j=T);return or&&oc(b,M),N}for(T=n(b,T);M<w.length;M++)A=m(T,b,M,w[M],k),A!==null&&(t&&A.alternate!==null&&T.delete(A.key===null?M:A.key),S=a(A,S,M),j===null?N=A:j.sibling=A,j=A);return t&&T.forEach(function(D){return e(b,D)}),or&&oc(b,M),N}function y(b,S,w,k){var N=Bf(w);if(typeof N!="function")throw Error(Se(150));if(w=N.call(w),w==null)throw Error(Se(151));for(var j=N=null,T=S,M=S=0,A=null,_=w.next();T!==null&&!_.done;M++,_=w.next()){T.index>M?(A=T,T=null):A=T.sibling;var D=h(b,T,_.value,k);if(D===null){T===null&&(T=A);break}t&&T&&D.alternate===null&&e(b,T),S=a(D,S,M),j===null?N=D:j.sibling=D,j=D,T=A}if(_.done)return r(b,T),or&&oc(b,M),N;if(T===null){for(;!_.done;M++,_=w.next())_=f(b,_.value,k),_!==null&&(S=a(_,S,M),j===null?N=_:j.sibling=_,j=_);return or&&oc(b,M),N}for(T=n(b,T);!_.done;M++,_=w.next())_=m(T,b,M,_.value,k),_!==null&&(t&&_.alternate!==null&&T.delete(_.key===null?M:_.key),S=a(_,S,M),j===null?N=_:j.sibling=_,j=_);return t&&T.forEach(function(R){return e(b,R)}),or&&oc(b,M),N}function x(b,S,w,k){if(typeof w=="object"&&w!==null&&w.type===Yu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case pg:e:{for(var N=w.key,j=S;j!==null;){if(j.key===N){if(N=w.type,N===Yu){if(j.tag===7){r(b,j.sibling),S=i(j,w.props.children),S.return=b,b=S;break e}}else if(j.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ro&&WE(N)===j.type){r(b,j.sibling),S=i(j,w.props),S.ref=Uf(b,j,w),S.return=b,b=S;break e}r(b,j);break}else e(b,j);j=j.sibling}w.type===Yu?(S=Nc(w.props.children,b.mode,k,w.key),S.return=b,b=S):(k=Ev(w.type,w.key,w.props,null,b.mode,k),k.ref=Uf(b,S,w),k.return=b,b=k)}return s(b);case Ku:e:{for(j=w.key;S!==null;){if(S.key===j)if(S.tag===4&&S.stateNode.containerInfo===w.containerInfo&&S.stateNode.implementation===w.implementation){r(b,S.sibling),S=i(S,w.children||[]),S.return=b,b=S;break e}else{r(b,S);break}else e(b,S);S=S.sibling}S=cw(w,b.mode,k),S.return=b,b=S}return s(b);case Ro:return j=w._init,x(b,S,j(w._payload),k)}if(gh(w))return v(b,S,w,k);if(Bf(w))return y(b,S,w,k);Ng(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,S!==null&&S.tag===6?(r(b,S.sibling),S=i(S,w),S.return=b,b=S):(r(b,S),S=lw(w,b.mode,k),S.return=b,b=S),s(b)):r(b,S)}return x}var jd=h_(!0),p_=h_(!1),a0=Nl(null),s0=null,nd=null,xC=null;function bC(){xC=nd=s0=null}function wC(t){var e=a0.current;rr(a0),t._currentValue=e}function m5(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function md(t,e){s0=t,xC=nd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(gi=!0),t.firstContext=null)}function ua(t){var e=t._currentValue;if(xC!==t)if(t={context:t,memoizedValue:e,next:null},nd===null){if(s0===null)throw Error(Se(308));nd=t,s0.dependencies={lanes:0,firstContext:t}}else nd=nd.next=t;return e}var gc=null;function SC(t){gc===null?gc=[t]:gc.push(t)}function m_(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,SC(e)):(r.next=i.next,i.next=r),e.interleaved=r,Js(t,n)}function Js(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Do=!1;function kC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function g_(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ws(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function rl(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,jt&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,Js(t,r)}return i=n.interleaved,i===null?(e.next=e,SC(n)):(e.next=i.next,i.next=e),n.interleaved=e,Js(t,r)}function bv(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,lC(t,r)}}function qE(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=e:a=a.next=e}else i=a=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function o0(t,e,r,n){var i=t.updateQueue;Do=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?a=c:s.next=c,s=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(a!==null){var f=i.baseState;s=0,u=c=l=null,o=a;do{var h=o.lane,m=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=t,y=o;switch(h=e,m=r,y.tag){case 1:if(v=y.payload,typeof v=="function"){f=v.call(m,f,h);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=y.payload,h=typeof v=="function"?v.call(m,f,h):v,h==null)break e;f=yr({},f,h);break e;case 2:Do=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=m,l=f):u=u.next=m,s|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else a===null&&(i.shared.lanes=0);Oc|=s,t.lanes=s,t.memoizedState=f}}function KE(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Se(191,i));i.call(n)}}}var Yp={},cs=Nl(Yp),up=Nl(Yp),dp=Nl(Yp);function vc(t){if(t===Yp)throw Error(Se(174));return t}function CC(t,e){switch(Xt(dp,e),Xt(up,t),Xt(cs,Yp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:YS(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=YS(e,t)}rr(cs),Xt(cs,e)}function Md(){rr(cs),rr(up),rr(dp)}function v_(t){vc(dp.current);var e=vc(cs.current),r=YS(e,t.type);e!==r&&(Xt(up,t),Xt(cs,r))}function NC(t){up.current===t&&(rr(cs),rr(up))}var mr=Nl(0);function l0(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var rw=[];function EC(){for(var t=0;t<rw.length;t++)rw[t]._workInProgressVersionPrimary=null;rw.length=0}var wv=no.ReactCurrentDispatcher,nw=no.ReactCurrentBatchConfig,Dc=0,gr=null,Xr=null,un=null,c0=!1,Rh=!1,fp=0,JF=0;function Bn(){throw Error(Se(321))}function TC(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ia(t[r],e[r]))return!1;return!0}function jC(t,e,r,n,i,a){if(Dc=a,gr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,wv.current=t===null||t.memoizedState===null?rz:nz,t=r(n,i),Rh){a=0;do{if(Rh=!1,fp=0,25<=a)throw Error(Se(301));a+=1,un=Xr=null,e.updateQueue=null,wv.current=iz,t=r(n,i)}while(Rh)}if(wv.current=u0,e=Xr!==null&&Xr.next!==null,Dc=0,un=Xr=gr=null,c0=!1,e)throw Error(Se(300));return t}function MC(){var t=fp!==0;return fp=0,t}function Za(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return un===null?gr.memoizedState=un=t:un=un.next=t,un}function da(){if(Xr===null){var t=gr.alternate;t=t!==null?t.memoizedState:null}else t=Xr.next;var e=un===null?gr.memoizedState:un.next;if(e!==null)un=e,Xr=t;else{if(t===null)throw Error(Se(310));Xr=t,t={memoizedState:Xr.memoizedState,baseState:Xr.baseState,baseQueue:Xr.baseQueue,queue:Xr.queue,next:null},un===null?gr.memoizedState=un=t:un=un.next=t}return un}function hp(t,e){return typeof e=="function"?e(t):e}function iw(t){var e=da(),r=e.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=t;var n=Xr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,l=null,c=a;do{var u=c.lane;if((Dc&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,s=n):l=l.next=f,gr.lanes|=u,Oc|=u}c=c.next}while(c!==null&&c!==a);l===null?s=n:l.next=o,Ia(n,e.memoizedState)||(gi=!0),e.memoizedState=n,e.baseState=s,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do a=i.lane,gr.lanes|=a,Oc|=a,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function aw(t){var e=da(),r=e.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,a=e.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=t(a,s.action),s=s.next;while(s!==i);Ia(a,e.memoizedState)||(gi=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function y_(){}function x_(t,e){var r=gr,n=da(),i=e(),a=!Ia(n.memoizedState,i);if(a&&(n.memoizedState=i,gi=!0),n=n.queue,PC(S_.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||un!==null&&un.memoizedState.tag&1){if(r.flags|=2048,pp(9,w_.bind(null,r,n,i,e),void 0,null),hn===null)throw Error(Se(349));Dc&30||b_(r,e,i)}return i}function b_(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=gr.updateQueue,e===null?(e={lastEffect:null,stores:null},gr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function w_(t,e,r,n){e.value=r,e.getSnapshot=n,k_(e)&&C_(t)}function S_(t,e,r){return r(function(){k_(e)&&C_(t)})}function k_(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ia(t,r)}catch{return!0}}function C_(t){var e=Js(t,1);e!==null&&Ra(e,t,1,-1)}function YE(t){var e=Za();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hp,lastRenderedState:t},e.queue=t,t=t.dispatch=tz.bind(null,gr,t),[e.memoizedState,t]}function pp(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=gr.updateQueue,e===null?(e={lastEffect:null,stores:null},gr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function N_(){return da().memoizedState}function Sv(t,e,r,n){var i=Za();gr.flags|=t,i.memoizedState=pp(1|e,r,void 0,n===void 0?null:n)}function Fy(t,e,r,n){var i=da();n=n===void 0?null:n;var a=void 0;if(Xr!==null){var s=Xr.memoizedState;if(a=s.destroy,n!==null&&TC(n,s.deps)){i.memoizedState=pp(e,r,a,n);return}}gr.flags|=t,i.memoizedState=pp(1|e,r,a,n)}function XE(t,e){return Sv(8390656,8,t,e)}function PC(t,e){return Fy(2048,8,t,e)}function E_(t,e){return Fy(4,2,t,e)}function T_(t,e){return Fy(4,4,t,e)}function j_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function M_(t,e,r){return r=r!=null?r.concat([t]):null,Fy(4,4,j_.bind(null,e,t),r)}function _C(){}function P_(t,e){var r=da();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&TC(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function __(t,e){var r=da();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&TC(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function A_(t,e,r){return Dc&21?(Ia(r,e)||(r=LP(),gr.lanes|=r,Oc|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,gi=!0),t.memoizedState=r)}function ZF(t,e){var r=Ft;Ft=r!==0&&4>r?r:4,t(!0);var n=nw.transition;nw.transition={};try{t(!1),e()}finally{Ft=r,nw.transition=n}}function R_(){return da().memoizedState}function ez(t,e,r){var n=il(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},D_(t))O_(e,r);else if(r=m_(t,e,r,n),r!==null){var i=Zn();Ra(r,t,n,i),I_(r,e,n)}}function tz(t,e,r){var n=il(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(D_(t))O_(e,i);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var s=e.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,Ia(o,s)){var l=e.interleaved;l===null?(i.next=i,SC(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}r=m_(t,e,i,n),r!==null&&(i=Zn(),Ra(r,t,n,i),I_(r,e,n))}}function D_(t){var e=t.alternate;return t===gr||e!==null&&e===gr}function O_(t,e){Rh=c0=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function I_(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,lC(t,r)}}var u0={readContext:ua,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useInsertionEffect:Bn,useLayoutEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useMutableSource:Bn,useSyncExternalStore:Bn,useId:Bn,unstable_isNewReconciler:!1},rz={readContext:ua,useCallback:function(t,e){return Za().memoizedState=[t,e===void 0?null:e],t},useContext:ua,useEffect:XE,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Sv(4194308,4,j_.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Sv(4194308,4,t,e)},useInsertionEffect:function(t,e){return Sv(4,2,t,e)},useMemo:function(t,e){var r=Za();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Za();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=ez.bind(null,gr,t),[n.memoizedState,t]},useRef:function(t){var e=Za();return t={current:t},e.memoizedState=t},useState:YE,useDebugValue:_C,useDeferredValue:function(t){return Za().memoizedState=t},useTransition:function(){var t=YE(!1),e=t[0];return t=ZF.bind(null,t[1]),Za().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=gr,i=Za();if(or){if(r===void 0)throw Error(Se(407));r=r()}else{if(r=e(),hn===null)throw Error(Se(349));Dc&30||b_(n,e,r)}i.memoizedState=r;var a={value:r,getSnapshot:e};return i.queue=a,XE(S_.bind(null,n,a,t),[t]),n.flags|=2048,pp(9,w_.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=Za(),e=hn.identifierPrefix;if(or){var r=Us,n=$s;r=(n&~(1<<32-Aa(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=fp++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=JF++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},nz={readContext:ua,useCallback:P_,useContext:ua,useEffect:PC,useImperativeHandle:M_,useInsertionEffect:E_,useLayoutEffect:T_,useMemo:__,useReducer:iw,useRef:N_,useState:function(){return iw(hp)},useDebugValue:_C,useDeferredValue:function(t){var e=da();return A_(e,Xr.memoizedState,t)},useTransition:function(){var t=iw(hp)[0],e=da().memoizedState;return[t,e]},useMutableSource:y_,useSyncExternalStore:x_,useId:R_,unstable_isNewReconciler:!1},iz={readContext:ua,useCallback:P_,useContext:ua,useEffect:PC,useImperativeHandle:M_,useInsertionEffect:E_,useLayoutEffect:T_,useMemo:__,useReducer:aw,useRef:N_,useState:function(){return aw(hp)},useDebugValue:_C,useDeferredValue:function(t){var e=da();return Xr===null?e.memoizedState=t:A_(e,Xr.memoizedState,t)},useTransition:function(){var t=aw(hp)[0],e=da().memoizedState;return[t,e]},useMutableSource:y_,useSyncExternalStore:x_,useId:R_,unstable_isNewReconciler:!1};function Ca(t,e){if(t&&t.defaultProps){e=yr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function g5(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:yr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var zy={isMounted:function(t){return(t=t._reactInternals)?Qc(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Zn(),i=il(t),a=Ws(n,i);a.payload=e,r!=null&&(a.callback=r),e=rl(t,a,i),e!==null&&(Ra(e,t,i,n),bv(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Zn(),i=il(t),a=Ws(n,i);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=rl(t,a,i),e!==null&&(Ra(e,t,i,n),bv(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Zn(),n=il(t),i=Ws(r,n);i.tag=2,e!=null&&(i.callback=e),e=rl(t,i,n),e!==null&&(Ra(e,t,n,r),bv(e,t,n))}};function QE(t,e,r,n,i,a,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,s):e.prototype&&e.prototype.isPureReactComponent?!sp(r,n)||!sp(i,a):!0}function L_(t,e,r){var n=!1,i=pl,a=e.contextType;return typeof a=="object"&&a!==null?a=ua(a):(i=xi(e)?Ac:Un.current,n=e.contextTypes,a=(n=n!=null)?Ed(t,i):pl),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zy,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e}function JE(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&zy.enqueueReplaceState(e,e.state,null)}function v5(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},kC(t);var a=e.contextType;typeof a=="object"&&a!==null?i.context=ua(a):(a=xi(e)?Ac:Un.current,i.context=Ed(t,a)),i.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(g5(t,e,a,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&zy.enqueueReplaceState(i,i.state,null),o0(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Pd(t,e){try{var r="",n=e;do r+=AB(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:i,digest:null}}function sw(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function y5(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var az=typeof WeakMap=="function"?WeakMap:Map;function B_(t,e,r){r=Ws(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){f0||(f0=!0,j5=n),y5(t,e)},r}function F_(t,e,r){r=Ws(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){y5(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){y5(t,e),typeof n!="function"&&(nl===null?nl=new Set([this]):nl.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),r}function ZE(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new az;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=xz.bind(null,t,e,r),e.then(t,t))}function eT(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function tT(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Ws(-1,1),e.tag=2,rl(r,e,1))),r.lanes|=1),t)}var sz=no.ReactCurrentOwner,gi=!1;function Jn(t,e,r,n){e.child=t===null?p_(e,null,r,n):jd(e,t.child,r,n)}function rT(t,e,r,n,i){r=r.render;var a=e.ref;return md(e,i),n=jC(t,e,r,n,a,i),r=MC(),t!==null&&!gi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Zs(t,e,i)):(or&&r&&gC(e),e.flags|=1,Jn(t,e,n,i),e.child)}function nT(t,e,r,n,i){if(t===null){var a=r.type;return typeof a=="function"&&!FC(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,z_(t,e,a,n,i)):(t=Ev(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:sp,r(s,n)&&t.ref===e.ref)return Zs(t,e,i)}return e.flags|=1,t=al(a,n),t.ref=e.ref,t.return=e,e.child=t}function z_(t,e,r,n,i){if(t!==null){var a=t.memoizedProps;if(sp(a,n)&&t.ref===e.ref)if(gi=!1,e.pendingProps=n=a,(t.lanes&i)!==0)t.flags&131072&&(gi=!0);else return e.lanes=t.lanes,Zs(t,e,i)}return x5(t,e,r,n,i)}function V_(t,e,r){var n=e.pendingProps,i=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xt(sd,ji),ji|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Xt(sd,ji),ji|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Xt(sd,ji),ji|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Xt(sd,ji),ji|=n;return Jn(t,e,i,r),e.child}function $_(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function x5(t,e,r,n,i){var a=xi(r)?Ac:Un.current;return a=Ed(e,a),md(e,i),r=jC(t,e,r,n,a,i),n=MC(),t!==null&&!gi?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Zs(t,e,i)):(or&&n&&gC(e),e.flags|=1,Jn(t,e,r,i),e.child)}function iT(t,e,r,n,i){if(xi(r)){var a=!0;r0(e)}else a=!1;if(md(e,i),e.stateNode===null)kv(t,e),L_(e,r,n),v5(e,r,n,i),n=!0;else if(t===null){var s=e.stateNode,o=e.memoizedProps;s.props=o;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=ua(c):(c=xi(r)?Ac:Un.current,c=Ed(e,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==c)&&JE(e,s,n,c),Do=!1;var h=e.memoizedState;s.state=h,o0(e,n,s,i),l=e.memoizedState,o!==n||h!==l||yi.current||Do?(typeof u=="function"&&(g5(e,r,u,n),l=e.memoizedState),(o=Do||QE(e,r,o,n,h,l,c))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{s=e.stateNode,g_(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Ca(e.type,o),s.props=c,f=e.pendingProps,h=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=ua(l):(l=xi(r)?Ac:Un.current,l=Ed(e,l));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==f||h!==l)&&JE(e,s,n,l),Do=!1,h=e.memoizedState,s.state=h,o0(e,n,s,i);var v=e.memoizedState;o!==f||h!==v||yi.current||Do?(typeof m=="function"&&(g5(e,r,m,n),v=e.memoizedState),(c=Do||QE(e,r,c,n,h,v,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,v,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,v,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=v),s.props=n,s.state=v,s.context=l,n=c):(typeof s.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return b5(t,e,r,n,a,i)}function b5(t,e,r,n,i,a){$_(t,e);var s=(e.flags&128)!==0;if(!n&&!s)return i&&UE(e,r,!1),Zs(t,e,a);n=e.stateNode,sz.current=e;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&s?(e.child=jd(e,t.child,null,a),e.child=jd(e,null,o,a)):Jn(t,e,o,a),e.memoizedState=n.state,i&&UE(e,r,!0),e.child}function U_(t){var e=t.stateNode;e.pendingContext?$E(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$E(t,e.context,!1),CC(t,e.containerInfo)}function aT(t,e,r,n,i){return Td(),yC(i),e.flags|=256,Jn(t,e,r,n),e.child}var w5={dehydrated:null,treeContext:null,retryLane:0};function S5(t){return{baseLanes:t,cachePool:null,transitions:null}}function G_(t,e,r){var n=e.pendingProps,i=mr.current,a=!1,s=(e.flags&128)!==0,o;if((o=s)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Xt(mr,i&1),t===null)return p5(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=n.children,t=n.fallback,a?(n=e.mode,a=e.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=Uy(s,n,0,null),t=Nc(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=S5(r),e.memoizedState=w5,t):AC(e,s));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return oz(t,e,s,n,o,i,r);if(a){a=n.fallback,s=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=al(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=al(o,a):(a=Nc(a,s,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,s=t.child.memoizedState,s=s===null?S5(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=t.childLanes&~r,e.memoizedState=w5,n}return a=t.child,t=a.sibling,n=al(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function AC(t,e){return e=Uy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Eg(t,e,r,n){return n!==null&&yC(n),jd(e,t.child,null,r),t=AC(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function oz(t,e,r,n,i,a,s){if(r)return e.flags&256?(e.flags&=-257,n=sw(Error(Se(422))),Eg(t,e,s,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,i=e.mode,n=Uy({mode:"visible",children:n.children},i,0,null),a=Nc(a,i,s,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&jd(e,t.child,null,s),e.child.memoizedState=S5(s),e.memoizedState=w5,a);if(!(e.mode&1))return Eg(t,e,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Se(419)),n=sw(a,n,void 0),Eg(t,e,s,n)}if(o=(s&t.childLanes)!==0,gi||o){if(n=hn,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Js(t,i),Ra(n,t,i,-1))}return BC(),n=sw(Error(Se(421))),Eg(t,e,s,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=bz.bind(null,t),i._reactRetry=e,null):(t=a.treeContext,Pi=tl(i.nextSibling),_i=e,or=!0,ja=null,t!==null&&(Zi[ea++]=$s,Zi[ea++]=Us,Zi[ea++]=Rc,$s=t.id,Us=t.overflow,Rc=e),e=AC(e,n.children),e.flags|=4096,e)}function sT(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),m5(t.return,e,r)}function ow(t,e,r,n,i){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function H_(t,e,r){var n=e.pendingProps,i=n.revealOrder,a=n.tail;if(Jn(t,e,n.children,r),n=mr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&sT(t,r,e);else if(t.tag===19)sT(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Xt(mr,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&l0(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),ow(e,!1,i,r,a);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&l0(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}ow(e,!0,r,null,a);break;case"together":ow(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function kv(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Zs(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Oc|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Se(153));if(e.child!==null){for(t=e.child,r=al(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=al(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function lz(t,e,r){switch(e.tag){case 3:U_(e),Td();break;case 5:v_(e);break;case 1:xi(e.type)&&r0(e);break;case 4:CC(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;Xt(a0,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Xt(mr,mr.current&1),e.flags|=128,null):r&e.child.childLanes?G_(t,e,r):(Xt(mr,mr.current&1),t=Zs(t,e,r),t!==null?t.sibling:null);Xt(mr,mr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return H_(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Xt(mr,mr.current),n)break;return null;case 22:case 23:return e.lanes=0,V_(t,e,r)}return Zs(t,e,r)}var W_,k5,q_,K_;W_=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};k5=function(){};q_=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,vc(cs.current);var a=null;switch(r){case"input":i=HS(t,i),n=HS(t,n),a=[];break;case"select":i=yr({},i,{value:void 0}),n=yr({},n,{value:void 0}),a=[];break;case"textarea":i=KS(t,i),n=KS(t,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=e0)}XS(r,n);var s;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Zh.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Zh.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&er("scroll",t),a||o===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(e.updateQueue=c)&&(e.flags|=4)}};K_=function(t,e,r,n){r!==n&&(e.flags|=4)};function Gf(t,e){if(!or)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Fn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function cz(t,e,r){var n=e.pendingProps;switch(vC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fn(e),null;case 1:return xi(e.type)&&t0(),Fn(e),null;case 3:return n=e.stateNode,Md(),rr(yi),rr(Un),EC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Cg(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ja!==null&&(_5(ja),ja=null))),k5(t,e),Fn(e),null;case 5:NC(e);var i=vc(dp.current);if(r=e.type,t!==null&&e.stateNode!=null)q_(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Se(166));return Fn(e),null}if(t=vc(cs.current),Cg(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[is]=e,n[cp]=a,t=(e.mode&1)!==0,r){case"dialog":er("cancel",n),er("close",n);break;case"iframe":case"object":case"embed":er("load",n);break;case"video":case"audio":for(i=0;i<yh.length;i++)er(yh[i],n);break;case"source":er("error",n);break;case"img":case"image":case"link":er("error",n),er("load",n);break;case"details":er("toggle",n);break;case"input":mE(n,a),er("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},er("invalid",n);break;case"textarea":vE(n,a),er("invalid",n)}XS(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&kg(n.textContent,o,t),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&kg(n.textContent,o,t),i=["children",""+o]):Zh.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&er("scroll",n)}switch(r){case"input":mg(n),gE(n,a,!0);break;case"textarea":mg(n),yE(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=e0)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=SP(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=s.createElement(r,{is:n.is}):(t=s.createElement(r),r==="select"&&(s=t,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):t=s.createElementNS(t,r),t[is]=e,t[cp]=n,W_(t,e,!1,!1),e.stateNode=t;e:{switch(s=QS(r,n),r){case"dialog":er("cancel",t),er("close",t),i=n;break;case"iframe":case"object":case"embed":er("load",t),i=n;break;case"video":case"audio":for(i=0;i<yh.length;i++)er(yh[i],t);i=n;break;case"source":er("error",t),i=n;break;case"img":case"image":case"link":er("error",t),er("load",t),i=n;break;case"details":er("toggle",t),i=n;break;case"input":mE(t,n),i=HS(t,n),er("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=yr({},n,{value:void 0}),er("invalid",t);break;case"textarea":vE(t,n),i=KS(t,n),er("invalid",t);break;default:i=n}XS(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?NP(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&kP(t,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ep(t,l):typeof l=="number"&&ep(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Zh.hasOwnProperty(a)?l!=null&&a==="onScroll"&&er("scroll",t):l!=null&&rC(t,a,l,s))}switch(r){case"input":mg(t),gE(t,n,!1);break;case"textarea":mg(t),yE(t);break;case"option":n.value!=null&&t.setAttribute("value",""+hl(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?dd(t,!!n.multiple,a,!1):n.defaultValue!=null&&dd(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=e0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Fn(e),null;case 6:if(t&&e.stateNode!=null)K_(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Se(166));if(r=vc(dp.current),vc(cs.current),Cg(e)){if(n=e.stateNode,r=e.memoizedProps,n[is]=e,(a=n.nodeValue!==r)&&(t=_i,t!==null))switch(t.tag){case 3:kg(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&kg(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[is]=e,e.stateNode=n}return Fn(e),null;case 13:if(rr(mr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(or&&Pi!==null&&e.mode&1&&!(e.flags&128))f_(),Td(),e.flags|=98560,a=!1;else if(a=Cg(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(Se(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Se(317));a[is]=e}else Td(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Fn(e),a=!1}else ja!==null&&(_5(ja),ja=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||mr.current&1?Qr===0&&(Qr=3):BC())),e.updateQueue!==null&&(e.flags|=4),Fn(e),null);case 4:return Md(),k5(t,e),t===null&&op(e.stateNode.containerInfo),Fn(e),null;case 10:return wC(e.type._context),Fn(e),null;case 17:return xi(e.type)&&t0(),Fn(e),null;case 19:if(rr(mr),a=e.memoizedState,a===null)return Fn(e),null;if(n=(e.flags&128)!==0,s=a.rendering,s===null)if(n)Gf(a,!1);else{if(Qr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=l0(t),s!==null){for(e.flags|=128,Gf(a,!1),n=s.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,t=s.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Xt(mr,mr.current&1|2),e.child}t=t.sibling}a.tail!==null&&Ar()>_d&&(e.flags|=128,n=!0,Gf(a,!1),e.lanes=4194304)}else{if(!n)if(t=l0(s),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Gf(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!or)return Fn(e),null}else 2*Ar()-a.renderingStartTime>_d&&r!==1073741824&&(e.flags|=128,n=!0,Gf(a,!1),e.lanes=4194304);a.isBackwards?(s.sibling=e.child,e.child=s):(r=a.last,r!==null?r.sibling=s:e.child=s,a.last=s)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Ar(),e.sibling=null,r=mr.current,Xt(mr,n?r&1|2:r&1),e):(Fn(e),null);case 22:case 23:return LC(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?ji&1073741824&&(Fn(e),e.subtreeFlags&6&&(e.flags|=8192)):Fn(e),null;case 24:return null;case 25:return null}throw Error(Se(156,e.tag))}function uz(t,e){switch(vC(e),e.tag){case 1:return xi(e.type)&&t0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Md(),rr(yi),rr(Un),EC(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return NC(e),null;case 13:if(rr(mr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Se(340));Td()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rr(mr),null;case 4:return Md(),null;case 10:return wC(e.type._context),null;case 22:case 23:return LC(),null;case 24:return null;default:return null}}var Tg=!1,Vn=!1,dz=typeof WeakSet=="function"?WeakSet:Set,Be=null;function ad(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Cr(t,e,n)}else r.current=null}function C5(t,e,r){try{r()}catch(n){Cr(t,e,n)}}var oT=!1;function fz(t,e){if(o5=Qv,t=ZP(),mC(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,c=0,u=0,f=t,h=null;t:for(;;){for(var m;f!==r||i!==0&&f.nodeType!==3||(o=s+i),f!==a||n!==0&&f.nodeType!==3||(l=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===t)break t;if(h===r&&++c===i&&(o=s),h===a&&++u===n&&(l=s),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(l5={focusedElem:t,selectionRange:r},Qv=!1,Be=e;Be!==null;)if(e=Be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Be=t;else for(;Be!==null;){e=Be;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var y=v.memoizedProps,x=v.memoizedState,b=e.stateNode,S=b.getSnapshotBeforeUpdate(e.elementType===e.type?y:Ca(e.type,y),x);b.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch(k){Cr(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Be=t;break}Be=e.return}return v=oT,oT=!1,v}function Dh(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var a=i.destroy;i.destroy=void 0,a!==void 0&&C5(e,r,a)}i=i.next}while(i!==n)}}function Vy(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function N5(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Y_(t){var e=t.alternate;e!==null&&(t.alternate=null,Y_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[is],delete e[cp],delete e[d5],delete e[KF],delete e[YF])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function X_(t){return t.tag===5||t.tag===3||t.tag===4}function lT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||X_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function E5(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=e0));else if(n!==4&&(t=t.child,t!==null))for(E5(t,e,r),t=t.sibling;t!==null;)E5(t,e,r),t=t.sibling}function T5(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(T5(t,e,r),t=t.sibling;t!==null;)T5(t,e,r),t=t.sibling}var wn=null,Ea=!1;function Co(t,e,r){for(r=r.child;r!==null;)Q_(t,e,r),r=r.sibling}function Q_(t,e,r){if(ls&&typeof ls.onCommitFiberUnmount=="function")try{ls.onCommitFiberUnmount(Ry,r)}catch{}switch(r.tag){case 5:Vn||ad(r,e);case 6:var n=wn,i=Ea;wn=null,Co(t,e,r),wn=n,Ea=i,wn!==null&&(Ea?(t=wn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):wn.removeChild(r.stateNode));break;case 18:wn!==null&&(Ea?(t=wn,r=r.stateNode,t.nodeType===8?ew(t.parentNode,r):t.nodeType===1&&ew(t,r),ip(t)):ew(wn,r.stateNode));break;case 4:n=wn,i=Ea,wn=r.stateNode.containerInfo,Ea=!0,Co(t,e,r),wn=n,Ea=i;break;case 0:case 11:case 14:case 15:if(!Vn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&C5(r,e,s),i=i.next}while(i!==n)}Co(t,e,r);break;case 1:if(!Vn&&(ad(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Cr(r,e,o)}Co(t,e,r);break;case 21:Co(t,e,r);break;case 22:r.mode&1?(Vn=(n=Vn)||r.memoizedState!==null,Co(t,e,r),Vn=n):Co(t,e,r);break;default:Co(t,e,r)}}function cT(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new dz),e.forEach(function(n){var i=wz.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Sa(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=t,s=e,o=s;e:for(;o!==null;){switch(o.tag){case 5:wn=o.stateNode,Ea=!1;break e;case 3:wn=o.stateNode.containerInfo,Ea=!0;break e;case 4:wn=o.stateNode.containerInfo,Ea=!0;break e}o=o.return}if(wn===null)throw Error(Se(160));Q_(a,s,i),wn=null,Ea=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Cr(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)J_(e,t),e=e.sibling}function J_(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Sa(e,t),Ka(t),n&4){try{Dh(3,t,t.return),Vy(3,t)}catch(y){Cr(t,t.return,y)}try{Dh(5,t,t.return)}catch(y){Cr(t,t.return,y)}}break;case 1:Sa(e,t),Ka(t),n&512&&r!==null&&ad(r,r.return);break;case 5:if(Sa(e,t),Ka(t),n&512&&r!==null&&ad(r,r.return),t.flags&32){var i=t.stateNode;try{ep(i,"")}catch(y){Cr(t,t.return,y)}}if(n&4&&(i=t.stateNode,i!=null)){var a=t.memoizedProps,s=r!==null?r.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&bP(i,a),QS(o,s);var c=QS(o,a);for(s=0;s<l.length;s+=2){var u=l[s],f=l[s+1];u==="style"?NP(i,f):u==="dangerouslySetInnerHTML"?kP(i,f):u==="children"?ep(i,f):rC(i,u,f,c)}switch(o){case"input":WS(i,a);break;case"textarea":wP(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?dd(i,!!a.multiple,m,!1):h!==!!a.multiple&&(a.defaultValue!=null?dd(i,!!a.multiple,a.defaultValue,!0):dd(i,!!a.multiple,a.multiple?[]:"",!1))}i[cp]=a}catch(y){Cr(t,t.return,y)}}break;case 6:if(Sa(e,t),Ka(t),n&4){if(t.stateNode===null)throw Error(Se(162));i=t.stateNode,a=t.memoizedProps;try{i.nodeValue=a}catch(y){Cr(t,t.return,y)}}break;case 3:if(Sa(e,t),Ka(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ip(e.containerInfo)}catch(y){Cr(t,t.return,y)}break;case 4:Sa(e,t),Ka(t);break;case 13:Sa(e,t),Ka(t),i=t.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(OC=Ar())),n&4&&cT(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(Vn=(c=Vn)||u,Sa(e,t),Vn=c):Sa(e,t),Ka(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Be=t,u=t.child;u!==null;){for(f=Be=u;Be!==null;){switch(h=Be,m=h.child,h.tag){case 0:case 11:case 14:case 15:Dh(4,h,h.return);break;case 1:ad(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{e=n,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(y){Cr(n,r,y)}}break;case 5:ad(h,h.return);break;case 22:if(h.memoizedState!==null){dT(f);continue}}m!==null?(m.return=h,Be=m):dT(f)}u=u.sibling}e:for(u=null,f=t;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=f.stateNode,l=f.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=CP("display",s))}catch(y){Cr(t,t.return,y)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(y){Cr(t,t.return,y)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Sa(e,t),Ka(t),n&4&&cT(t);break;case 21:break;default:Sa(e,t),Ka(t)}}function Ka(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(X_(r)){var n=r;break e}r=r.return}throw Error(Se(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(ep(i,""),n.flags&=-33);var a=lT(t);T5(t,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=lT(t);E5(t,o,s);break;default:throw Error(Se(161))}}catch(l){Cr(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hz(t,e,r){Be=t,Z_(t)}function Z_(t,e,r){for(var n=(t.mode&1)!==0;Be!==null;){var i=Be,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||Tg;if(!s){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Vn;o=Tg;var c=Vn;if(Tg=s,(Vn=l)&&!c)for(Be=i;Be!==null;)s=Be,l=s.child,s.tag===22&&s.memoizedState!==null?fT(i):l!==null?(l.return=s,Be=l):fT(i);for(;a!==null;)Be=a,Z_(a),a=a.sibling;Be=i,Tg=o,Vn=c}uT(t)}else i.subtreeFlags&8772&&a!==null?(a.return=i,Be=a):uT(t)}}function uT(t){for(;Be!==null;){var e=Be;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Vn||Vy(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Vn)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:Ca(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&KE(e,a,n);break;case 3:var s=e.updateQueue;if(s!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}KE(e,s,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&ip(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}Vn||e.flags&512&&N5(e)}catch(h){Cr(e,e.return,h)}}if(e===t){Be=null;break}if(r=e.sibling,r!==null){r.return=e.return,Be=r;break}Be=e.return}}function dT(t){for(;Be!==null;){var e=Be;if(e===t){Be=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Be=r;break}Be=e.return}}function fT(t){for(;Be!==null;){var e=Be;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Vy(4,e)}catch(l){Cr(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(l){Cr(e,i,l)}}var a=e.return;try{N5(e)}catch(l){Cr(e,a,l)}break;case 5:var s=e.return;try{N5(e)}catch(l){Cr(e,s,l)}}}catch(l){Cr(e,e.return,l)}if(e===t){Be=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Be=o;break}Be=e.return}}var pz=Math.ceil,d0=no.ReactCurrentDispatcher,RC=no.ReactCurrentOwner,aa=no.ReactCurrentBatchConfig,jt=0,hn=null,Vr=null,Nn=0,ji=0,sd=Nl(0),Qr=0,mp=null,Oc=0,$y=0,DC=0,Oh=null,fi=null,OC=0,_d=1/0,Bs=null,f0=!1,j5=null,nl=null,jg=!1,Go=null,h0=0,Ih=0,M5=null,Cv=-1,Nv=0;function Zn(){return jt&6?Ar():Cv!==-1?Cv:Cv=Ar()}function il(t){return t.mode&1?jt&2&&Nn!==0?Nn&-Nn:QF.transition!==null?(Nv===0&&(Nv=LP()),Nv):(t=Ft,t!==0||(t=window.event,t=t===void 0?16:GP(t.type)),t):1}function Ra(t,e,r,n){if(50<Ih)throw Ih=0,M5=null,Error(Se(185));Wp(t,r,n),(!(jt&2)||t!==hn)&&(t===hn&&(!(jt&2)&&($y|=r),Qr===4&&zo(t,Nn)),bi(t,n),r===1&&jt===0&&!(e.mode&1)&&(_d=Ar()+500,By&&El()))}function bi(t,e){var r=t.callbackNode;QB(t,e);var n=Xv(t,t===hn?Nn:0);if(n===0)r!==null&&wE(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&wE(r),e===1)t.tag===0?XF(hT.bind(null,t)):c_(hT.bind(null,t)),WF(function(){!(jt&6)&&El()}),r=null;else{switch(BP(n)){case 1:r=oC;break;case 4:r=OP;break;case 16:r=Yv;break;case 536870912:r=IP;break;default:r=Yv}r=oA(r,eA.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function eA(t,e){if(Cv=-1,Nv=0,jt&6)throw Error(Se(327));var r=t.callbackNode;if(gd()&&t.callbackNode!==r)return null;var n=Xv(t,t===hn?Nn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=p0(t,n);else{e=n;var i=jt;jt|=2;var a=rA();(hn!==t||Nn!==e)&&(Bs=null,_d=Ar()+500,Cc(t,e));do try{vz();break}catch(o){tA(t,o)}while(1);bC(),d0.current=a,jt=i,Vr!==null?e=0:(hn=null,Nn=0,e=Qr)}if(e!==0){if(e===2&&(i=r5(t),i!==0&&(n=i,e=P5(t,i))),e===1)throw r=mp,Cc(t,0),zo(t,n),bi(t,Ar()),r;if(e===6)zo(t,n);else{if(i=t.current.alternate,!(n&30)&&!mz(i)&&(e=p0(t,n),e===2&&(a=r5(t),a!==0&&(n=a,e=P5(t,a))),e===1))throw r=mp,Cc(t,0),zo(t,n),bi(t,Ar()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(Se(345));case 2:lc(t,fi,Bs);break;case 3:if(zo(t,n),(n&130023424)===n&&(e=OC+500-Ar(),10<e)){if(Xv(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Zn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=u5(lc.bind(null,t,fi,Bs),e);break}lc(t,fi,Bs);break;case 4:if(zo(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var s=31-Aa(n);a=1<<s,s=e[s],s>i&&(i=s),n&=~a}if(n=i,n=Ar()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*pz(n/1960))-n,10<n){t.timeoutHandle=u5(lc.bind(null,t,fi,Bs),n);break}lc(t,fi,Bs);break;case 5:lc(t,fi,Bs);break;default:throw Error(Se(329))}}}return bi(t,Ar()),t.callbackNode===r?eA.bind(null,t):null}function P5(t,e){var r=Oh;return t.current.memoizedState.isDehydrated&&(Cc(t,e).flags|=256),t=p0(t,e),t!==2&&(e=fi,fi=r,e!==null&&_5(e)),t}function _5(t){fi===null?fi=t:fi.push.apply(fi,t)}function mz(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Ia(a(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zo(t,e){for(e&=~DC,e&=~$y,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Aa(e),n=1<<r;t[r]=-1,e&=~n}}function hT(t){if(jt&6)throw Error(Se(327));gd();var e=Xv(t,0);if(!(e&1))return bi(t,Ar()),null;var r=p0(t,e);if(t.tag!==0&&r===2){var n=r5(t);n!==0&&(e=n,r=P5(t,n))}if(r===1)throw r=mp,Cc(t,0),zo(t,e),bi(t,Ar()),r;if(r===6)throw Error(Se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,lc(t,fi,Bs),bi(t,Ar()),null}function IC(t,e){var r=jt;jt|=1;try{return t(e)}finally{jt=r,jt===0&&(_d=Ar()+500,By&&El())}}function Ic(t){Go!==null&&Go.tag===0&&!(jt&6)&&gd();var e=jt;jt|=1;var r=aa.transition,n=Ft;try{if(aa.transition=null,Ft=1,t)return t()}finally{Ft=n,aa.transition=r,jt=e,!(jt&6)&&El()}}function LC(){ji=sd.current,rr(sd)}function Cc(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,HF(r)),Vr!==null)for(r=Vr.return;r!==null;){var n=r;switch(vC(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&t0();break;case 3:Md(),rr(yi),rr(Un),EC();break;case 5:NC(n);break;case 4:Md();break;case 13:rr(mr);break;case 19:rr(mr);break;case 10:wC(n.type._context);break;case 22:case 23:LC()}r=r.return}if(hn=t,Vr=t=al(t.current,null),Nn=ji=e,Qr=0,mp=null,DC=$y=Oc=0,fi=Oh=null,gc!==null){for(e=0;e<gc.length;e++)if(r=gc[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}gc=null}return t}function tA(t,e){do{var r=Vr;try{if(bC(),wv.current=u0,c0){for(var n=gr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}c0=!1}if(Dc=0,un=Xr=gr=null,Rh=!1,fp=0,RC.current=null,r===null||r.return===null){Qr=1,mp=e,Vr=null;break}e:{var a=t,s=r.return,o=r,l=e;if(e=Nn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=eT(s);if(m!==null){m.flags&=-257,tT(m,s,o,a,e),m.mode&1&&ZE(a,c,e),e=m,l=c;var v=e.updateQueue;if(v===null){var y=new Set;y.add(l),e.updateQueue=y}else v.add(l);break e}else{if(!(e&1)){ZE(a,c,e),BC();break e}l=Error(Se(426))}}else if(or&&o.mode&1){var x=eT(s);if(x!==null){!(x.flags&65536)&&(x.flags|=256),tT(x,s,o,a,e),yC(Pd(l,o));break e}}a=l=Pd(l,o),Qr!==4&&(Qr=2),Oh===null?Oh=[a]:Oh.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var b=B_(a,l,e);qE(a,b);break e;case 1:o=l;var S=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof S.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(nl===null||!nl.has(w)))){a.flags|=65536,e&=-e,a.lanes|=e;var k=F_(a,o,e);qE(a,k);break e}}a=a.return}while(a!==null)}iA(r)}catch(N){e=N,Vr===r&&r!==null&&(Vr=r=r.return);continue}break}while(1)}function rA(){var t=d0.current;return d0.current=u0,t===null?u0:t}function BC(){(Qr===0||Qr===3||Qr===2)&&(Qr=4),hn===null||!(Oc&268435455)&&!($y&268435455)||zo(hn,Nn)}function p0(t,e){var r=jt;jt|=2;var n=rA();(hn!==t||Nn!==e)&&(Bs=null,Cc(t,e));do try{gz();break}catch(i){tA(t,i)}while(1);if(bC(),jt=r,d0.current=n,Vr!==null)throw Error(Se(261));return hn=null,Nn=0,Qr}function gz(){for(;Vr!==null;)nA(Vr)}function vz(){for(;Vr!==null&&!$B();)nA(Vr)}function nA(t){var e=sA(t.alternate,t,ji);t.memoizedProps=t.pendingProps,e===null?iA(t):Vr=e,RC.current=null}function iA(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=uz(r,e),r!==null){r.flags&=32767,Vr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qr=6,Vr=null;return}}else if(r=cz(r,e,ji),r!==null){Vr=r;return}if(e=e.sibling,e!==null){Vr=e;return}Vr=e=t}while(e!==null);Qr===0&&(Qr=5)}function lc(t,e,r){var n=Ft,i=aa.transition;try{aa.transition=null,Ft=1,yz(t,e,r,n)}finally{aa.transition=i,Ft=n}return null}function yz(t,e,r,n){do gd();while(Go!==null);if(jt&6)throw Error(Se(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Se(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(JB(t,a),t===hn&&(Vr=hn=null,Nn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||jg||(jg=!0,oA(Yv,function(){return gd(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=aa.transition,aa.transition=null;var s=Ft;Ft=1;var o=jt;jt|=4,RC.current=null,fz(t,r),J_(r,t),BF(l5),Qv=!!o5,l5=o5=null,t.current=r,hz(r),UB(),jt=o,Ft=s,aa.transition=a}else t.current=r;if(jg&&(jg=!1,Go=t,h0=i),a=t.pendingLanes,a===0&&(nl=null),WB(r.stateNode),bi(t,Ar()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(f0)throw f0=!1,t=j5,j5=null,t;return h0&1&&t.tag!==0&&gd(),a=t.pendingLanes,a&1?t===M5?Ih++:(Ih=0,M5=t):Ih=0,El(),null}function gd(){if(Go!==null){var t=BP(h0),e=aa.transition,r=Ft;try{if(aa.transition=null,Ft=16>t?16:t,Go===null)var n=!1;else{if(t=Go,Go=null,h0=0,jt&6)throw Error(Se(331));var i=jt;for(jt|=4,Be=t.current;Be!==null;){var a=Be,s=a.child;if(Be.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Be=c;Be!==null;){var u=Be;switch(u.tag){case 0:case 11:case 15:Dh(8,u,a)}var f=u.child;if(f!==null)f.return=u,Be=f;else for(;Be!==null;){u=Be;var h=u.sibling,m=u.return;if(Y_(u),u===c){Be=null;break}if(h!==null){h.return=m,Be=h;break}Be=m}}}var v=a.alternate;if(v!==null){var y=v.child;if(y!==null){v.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}Be=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,Be=s;else e:for(;Be!==null;){if(a=Be,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Dh(9,a,a.return)}var b=a.sibling;if(b!==null){b.return=a.return,Be=b;break e}Be=a.return}}var S=t.current;for(Be=S;Be!==null;){s=Be;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,Be=w;else e:for(s=S;Be!==null;){if(o=Be,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Vy(9,o)}}catch(N){Cr(o,o.return,N)}if(o===s){Be=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,Be=k;break e}Be=o.return}}if(jt=i,El(),ls&&typeof ls.onPostCommitFiberRoot=="function")try{ls.onPostCommitFiberRoot(Ry,t)}catch{}n=!0}return n}finally{Ft=r,aa.transition=e}}return!1}function pT(t,e,r){e=Pd(r,e),e=B_(t,e,1),t=rl(t,e,1),e=Zn(),t!==null&&(Wp(t,1,e),bi(t,e))}function Cr(t,e,r){if(t.tag===3)pT(t,t,r);else for(;e!==null;){if(e.tag===3){pT(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(nl===null||!nl.has(n))){t=Pd(r,t),t=F_(e,t,1),e=rl(e,t,1),t=Zn(),e!==null&&(Wp(e,1,t),bi(e,t));break}}e=e.return}}function xz(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Zn(),t.pingedLanes|=t.suspendedLanes&r,hn===t&&(Nn&r)===r&&(Qr===4||Qr===3&&(Nn&130023424)===Nn&&500>Ar()-OC?Cc(t,0):DC|=r),bi(t,e)}function aA(t,e){e===0&&(t.mode&1?(e=yg,yg<<=1,!(yg&130023424)&&(yg=4194304)):e=1);var r=Zn();t=Js(t,e),t!==null&&(Wp(t,e,r),bi(t,r))}function bz(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),aA(t,r)}function wz(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Se(314))}n!==null&&n.delete(e),aA(t,r)}var sA;sA=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||yi.current)gi=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return gi=!1,lz(t,e,r);gi=!!(t.flags&131072)}else gi=!1,or&&e.flags&1048576&&u_(e,i0,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;kv(t,e),t=e.pendingProps;var i=Ed(e,Un.current);md(e,r),i=jC(null,e,n,t,i,r);var a=MC();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,xi(n)?(a=!0,r0(e)):a=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,kC(e),i.updater=zy,e.stateNode=i,i._reactInternals=e,v5(e,n,t,r),e=b5(null,e,n,!0,a,r)):(e.tag=0,or&&a&&gC(e),Jn(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(kv(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=kz(n),t=Ca(n,t),i){case 0:e=x5(null,e,n,t,r);break e;case 1:e=iT(null,e,n,t,r);break e;case 11:e=rT(null,e,n,t,r);break e;case 14:e=nT(null,e,n,Ca(n.type,t),r);break e}throw Error(Se(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ca(n,i),x5(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ca(n,i),iT(t,e,n,i,r);case 3:e:{if(U_(e),t===null)throw Error(Se(387));n=e.pendingProps,a=e.memoizedState,i=a.element,g_(t,e),o0(e,n,null,r);var s=e.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){i=Pd(Error(Se(423)),e),e=aT(t,e,n,r,i);break e}else if(n!==i){i=Pd(Error(Se(424)),e),e=aT(t,e,n,r,i);break e}else for(Pi=tl(e.stateNode.containerInfo.firstChild),_i=e,or=!0,ja=null,r=p_(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Td(),n===i){e=Zs(t,e,r);break e}Jn(t,e,n,r)}e=e.child}return e;case 5:return v_(e),t===null&&p5(e),n=e.type,i=e.pendingProps,a=t!==null?t.memoizedProps:null,s=i.children,c5(n,i)?s=null:a!==null&&c5(n,a)&&(e.flags|=32),$_(t,e),Jn(t,e,s,r),e.child;case 6:return t===null&&p5(e),null;case 13:return G_(t,e,r);case 4:return CC(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=jd(e,null,n,r):Jn(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ca(n,i),rT(t,e,n,i,r);case 7:return Jn(t,e,e.pendingProps,r),e.child;case 8:return Jn(t,e,e.pendingProps.children,r),e.child;case 12:return Jn(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,a=e.memoizedProps,s=i.value,Xt(a0,n._currentValue),n._currentValue=s,a!==null)if(Ia(a.value,s)){if(a.children===i.children&&!yi.current){e=Zs(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Ws(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),m5(a.return,r,e),o.lanes|=r;break}l=l.next}}else if(a.tag===10)s=a.type===e.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(Se(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),m5(s,r,e),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===e){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}Jn(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,md(e,r),i=ua(i),n=n(i),e.flags|=1,Jn(t,e,n,r),e.child;case 14:return n=e.type,i=Ca(n,e.pendingProps),i=Ca(n.type,i),nT(t,e,n,i,r);case 15:return z_(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:Ca(n,i),kv(t,e),e.tag=1,xi(n)?(t=!0,r0(e)):t=!1,md(e,r),L_(e,n,i),v5(e,n,i,r),b5(null,e,n,!0,t,r);case 19:return H_(t,e,r);case 22:return V_(t,e,r)}throw Error(Se(156,e.tag))};function oA(t,e){return DP(t,e)}function Sz(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function na(t,e,r,n){return new Sz(t,e,r,n)}function FC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function kz(t){if(typeof t=="function")return FC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===iC)return 11;if(t===aC)return 14}return 2}function al(t,e){var r=t.alternate;return r===null?(r=na(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Ev(t,e,r,n,i,a){var s=2;if(n=t,typeof t=="function")FC(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case Yu:return Nc(r.children,i,a,e);case nC:s=8,i|=8;break;case VS:return t=na(12,r,e,i|2),t.elementType=VS,t.lanes=a,t;case $S:return t=na(13,r,e,i),t.elementType=$S,t.lanes=a,t;case US:return t=na(19,r,e,i),t.elementType=US,t.lanes=a,t;case vP:return Uy(r,i,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case mP:s=10;break e;case gP:s=9;break e;case iC:s=11;break e;case aC:s=14;break e;case Ro:s=16,n=null;break e}throw Error(Se(130,t==null?t:typeof t,""))}return e=na(s,r,e,i),e.elementType=t,e.type=n,e.lanes=a,e}function Nc(t,e,r,n){return t=na(7,t,n,e),t.lanes=r,t}function Uy(t,e,r,n){return t=na(22,t,n,e),t.elementType=vP,t.lanes=r,t.stateNode={isHidden:!1},t}function lw(t,e,r){return t=na(6,t,null,e),t.lanes=r,t}function cw(t,e,r){return e=na(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Cz(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ub(0),this.expirationTimes=Ub(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ub(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zC(t,e,r,n,i,a,s,o,l){return t=new Cz(t,e,r,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=na(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},kC(a),t}function Nz(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ku,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function lA(t){if(!t)return pl;t=t._reactInternals;e:{if(Qc(t)!==t||t.tag!==1)throw Error(Se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(xi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Se(171))}if(t.tag===1){var r=t.type;if(xi(r))return l_(t,r,e)}return e}function cA(t,e,r,n,i,a,s,o,l){return t=zC(r,n,!0,t,i,a,s,o,l),t.context=lA(null),r=t.current,n=Zn(),i=il(r),a=Ws(n,i),a.callback=e??null,rl(r,a,i),t.current.lanes=i,Wp(t,i,n),bi(t,n),t}function Gy(t,e,r,n){var i=e.current,a=Zn(),s=il(i);return r=lA(r),e.context===null?e.context=r:e.pendingContext=r,e=Ws(a,s),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=rl(i,e,s),t!==null&&(Ra(t,i,s,a),bv(t,i,s)),s}function m0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function mT(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function VC(t,e){mT(t,e),(t=t.alternate)&&mT(t,e)}function Ez(){return null}var uA=typeof reportError=="function"?reportError:function(t){console.error(t)};function $C(t){this._internalRoot=t}Hy.prototype.render=$C.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Se(409));Gy(t,e,null,null)};Hy.prototype.unmount=$C.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ic(function(){Gy(null,t,null,null)}),e[Qs]=null}};function Hy(t){this._internalRoot=t}Hy.prototype.unstable_scheduleHydration=function(t){if(t){var e=VP();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Fo.length&&e!==0&&e<Fo[r].priority;r++);Fo.splice(r,0,t),r===0&&UP(t)}};function UC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Wy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function gT(){}function Tz(t,e,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var c=m0(s);a.call(c)}}var s=cA(e,n,t,0,null,!1,!1,"",gT);return t._reactRootContainer=s,t[Qs]=s.current,op(t.nodeType===8?t.parentNode:t),Ic(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=m0(l);o.call(c)}}var l=zC(t,0,!1,null,null,!1,!1,"",gT);return t._reactRootContainer=l,t[Qs]=l.current,op(t.nodeType===8?t.parentNode:t),Ic(function(){Gy(e,l,r,n)}),l}function qy(t,e,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var l=m0(s);o.call(l)}}Gy(e,s,t,i)}else s=Tz(r,e,t,i,n);return m0(s)}FP=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=vh(e.pendingLanes);r!==0&&(lC(e,r|1),bi(e,Ar()),!(jt&6)&&(_d=Ar()+500,El()))}break;case 13:Ic(function(){var n=Js(t,1);if(n!==null){var i=Zn();Ra(n,t,1,i)}}),VC(t,1)}};cC=function(t){if(t.tag===13){var e=Js(t,134217728);if(e!==null){var r=Zn();Ra(e,t,134217728,r)}VC(t,134217728)}};zP=function(t){if(t.tag===13){var e=il(t),r=Js(t,e);if(r!==null){var n=Zn();Ra(r,t,e,n)}VC(t,e)}};VP=function(){return Ft};$P=function(t,e){var r=Ft;try{return Ft=t,e()}finally{Ft=r}};ZS=function(t,e,r){switch(e){case"input":if(WS(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Ly(n);if(!i)throw Error(Se(90));xP(n),WS(n,i)}}}break;case"textarea":wP(t,r);break;case"select":e=r.value,e!=null&&dd(t,!!r.multiple,e,!1)}};jP=IC;MP=Ic;var jz={usingClientEntryPoint:!1,Events:[Kp,Zu,Ly,EP,TP,IC]},Hf={findFiberByHostInstance:mc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Mz={bundleType:Hf.bundleType,version:Hf.version,rendererPackageName:Hf.rendererPackageName,rendererConfig:Hf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:no.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=AP(t),t===null?null:t.stateNode},findFiberByHostInstance:Hf.findFiberByHostInstance||Ez,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mg.isDisabled&&Mg.supportsFiber)try{Ry=Mg.inject(Mz),ls=Mg}catch{}}Oi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jz;Oi.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!UC(e))throw Error(Se(200));return Nz(t,e,null,r)};Oi.createRoot=function(t,e){if(!UC(t))throw Error(Se(299));var r=!1,n="",i=uA;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=zC(t,1,!1,null,null,r,!1,n,i),t[Qs]=e.current,op(t.nodeType===8?t.parentNode:t),new $C(e)};Oi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Se(188)):(t=Object.keys(t).join(","),Error(Se(268,t)));return t=AP(e),t=t===null?null:t.stateNode,t};Oi.flushSync=function(t){return Ic(t)};Oi.hydrate=function(t,e,r){if(!Wy(e))throw Error(Se(200));return qy(null,t,e,!0,r)};Oi.hydrateRoot=function(t,e,r){if(!UC(t))throw Error(Se(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=uA;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),e=cA(e,null,t,1,r??null,i,!1,a,s),t[Qs]=e.current,op(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new Hy(e)};Oi.render=function(t,e,r){if(!Wy(e))throw Error(Se(200));return qy(null,t,e,!1,r)};Oi.unmountComponentAtNode=function(t){if(!Wy(t))throw Error(Se(40));return t._reactRootContainer?(Ic(function(){qy(null,null,t,!1,function(){t._reactRootContainer=null,t[Qs]=null})}),!0):!1};Oi.unstable_batchedUpdates=IC;Oi.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Wy(r))throw Error(Se(200));if(t==null||t._reactInternals===void 0)throw Error(Se(38));return qy(t,e,r,!1,n)};Oi.version="18.3.1-next-f1338f8080-20240426";function dA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dA)}catch(t){console.error(t)}}dA(),dP.exports=Oi;var ds=dP.exports;const Pz=Gp(ds);var vT=ds;FS.createRoot=vT.createRoot,FS.hydrateRoot=vT.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gp(){return gp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},gp.apply(this,arguments)}var Ho;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ho||(Ho={}));const yT="popstate";function _z(t){t===void 0&&(t={});function e(n,i){let{pathname:a,search:s,hash:o}=n.location;return A5("",{pathname:a,search:s,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:g0(i)}return Rz(e,r,null,t)}function Tr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function GC(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Az(){return Math.random().toString(36).substr(2,8)}function xT(t,e){return{usr:t.state,key:t.key,idx:e}}function A5(t,e,r,n){return r===void 0&&(r=null),gp({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ef(e):e,{state:r,key:e&&e.key||n||Az()})}function g0(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ef(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function Rz(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,s=i.history,o=Ho.Pop,l=null,c=u();c==null&&(c=0,s.replaceState(gp({},s.state,{idx:c}),""));function u(){return(s.state||{idx:null}).idx}function f(){o=Ho.Pop;let x=u(),b=x==null?null:x-c;c=x,l&&l({action:o,location:y.location,delta:b})}function h(x,b){o=Ho.Push;let S=A5(y.location,x,b);r&&r(S,x),c=u()+1;let w=xT(S,c),k=y.createHref(S);try{s.pushState(w,"",k)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(k)}a&&l&&l({action:o,location:y.location,delta:1})}function m(x,b){o=Ho.Replace;let S=A5(y.location,x,b);r&&r(S,x),c=u();let w=xT(S,c),k=y.createHref(S);s.replaceState(w,"",k),a&&l&&l({action:o,location:y.location,delta:0})}function v(x){let b=i.location.origin!=="null"?i.location.origin:i.location.href,S=typeof x=="string"?x:g0(x);return S=S.replace(/ $/,"%20"),Tr(b,"No window.location.(origin|href) available to create URL for href: "+S),new URL(S,b)}let y={get action(){return o},get location(){return t(i,s)},listen(x){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(yT,f),l=x,()=>{i.removeEventListener(yT,f),l=null}},createHref(x){return e(i,x)},createURL:v,encodeLocation(x){let b=v(x);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:h,replace:m,go(x){return s.go(x)}};return y}var bT;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(bT||(bT={}));function Dz(t,e,r){return r===void 0&&(r="/"),Oz(t,e,r,!1)}function Oz(t,e,r,n){let i=typeof e=="string"?ef(e):e,a=Ad(i.pathname||"/",r);if(a==null)return null;let s=fA(t);Iz(s);let o=null;for(let l=0;o==null&&l<s.length;++l){let c=qz(a);o=Hz(s[l],c,n)}return o}function fA(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,s,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:s,route:a};l.relativePath.startsWith("/")&&(Tr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=sl([n,l.relativePath]),u=r.concat(l);a.children&&a.children.length>0&&(Tr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),fA(a.children,e,u,c)),!(a.path==null&&!a.index)&&e.push({path:c,score:Uz(c,a.index),routesMeta:u})};return t.forEach((a,s)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))i(a,s);else for(let l of hA(a.path))i(a,s,l)}),e}function hA(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let s=hA(n.join("/")),o=[];return o.push(...s.map(l=>l===""?a:[a,l].join("/"))),i&&o.push(...s),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function Iz(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Gz(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Lz=/^:[\w-]+$/,Bz=3,Fz=2,zz=1,Vz=10,$z=-2,wT=t=>t==="*";function Uz(t,e){let r=t.split("/"),n=r.length;return r.some(wT)&&(n+=$z),e&&(n+=Fz),r.filter(i=>!wT(i)).reduce((i,a)=>i+(Lz.test(a)?Bz:a===""?zz:Vz),n)}function Gz(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function Hz(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,i={},a="/",s=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=a==="/"?e:e.slice(a.length)||"/",f=v0({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!f&&c&&r&&!n[n.length-1].route.index&&(f=v0({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!f)return null;Object.assign(i,f.params),s.push({params:i,pathname:sl([a,f.pathname]),pathnameBase:Jz(sl([a,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(a=sl([a,f.pathnameBase]))}return s}function v0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=Wz(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((c,u,f)=>{let{paramName:h,isOptional:m}=u;if(h==="*"){let y=o[f]||"";s=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const v=o[f];return m&&!v?c[h]=void 0:c[h]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:a,pathnameBase:s,pattern:t}}function Wz(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),GC(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function qz(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return GC(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ad(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const Kz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Yz=t=>Kz.test(t);function Xz(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?ef(t):t,a;if(r)if(Yz(r))a=r;else{if(r.includes("//")){let s=r;r=r.replace(/\/\/+/g,"/"),GC(!1,"Pathnames cannot have embedded double slashes - normalizing "+(s+" -> "+r))}r.startsWith("/")?a=ST(r.substring(1),"/"):a=ST(r,e)}else a=e;return{pathname:a,search:Zz(n),hash:eV(i)}}function ST(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function uw(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Qz(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function pA(t,e){let r=Qz(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function mA(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=ef(t):(i=gp({},t),Tr(!i.pathname||!i.pathname.includes("?"),uw("?","pathname","search",i)),Tr(!i.pathname||!i.pathname.includes("#"),uw("#","pathname","hash",i)),Tr(!i.search||!i.search.includes("#"),uw("#","search","hash",i)));let a=t===""||i.pathname==="",s=a?"/":i.pathname,o;if(s==null)o=r;else{let f=e.length-1;if(!n&&s.startsWith("..")){let h=s.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}o=f>=0?e[f]:"/"}let l=Xz(i,o),c=s&&s!=="/"&&s.endsWith("/"),u=(a||s===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const sl=t=>t.join("/").replace(/\/\/+/g,"/"),Jz=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Zz=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,eV=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function tV(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const gA=["post","put","patch","delete"];new Set(gA);const rV=["get",...gA];new Set(rV);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vp(){return vp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vp.apply(this,arguments)}const Ky=q.createContext(null),vA=q.createContext(null),Tl=q.createContext(null),Yy=q.createContext(null),io=q.createContext({outlet:null,matches:[],isDataRoute:!1}),yA=q.createContext(null);function nV(t,e){let{relative:r}=e===void 0?{}:e;Xp()||Tr(!1);let{basename:n,navigator:i}=q.useContext(Tl),{hash:a,pathname:s,search:o}=Xy(t,{relative:r}),l=s;return n!=="/"&&(l=s==="/"?n:sl([n,s])),i.createHref({pathname:l,search:o,hash:a})}function Xp(){return q.useContext(Yy)!=null}function Jc(){return Xp()||Tr(!1),q.useContext(Yy).location}function xA(t){q.useContext(Tl).static||q.useLayoutEffect(t)}function Li(){let{isDataRoute:t}=q.useContext(io);return t?vV():iV()}function iV(){Xp()||Tr(!1);let t=q.useContext(Ky),{basename:e,future:r,navigator:n}=q.useContext(Tl),{matches:i}=q.useContext(io),{pathname:a}=Jc(),s=JSON.stringify(pA(i,r.v7_relativeSplatPath)),o=q.useRef(!1);return xA(()=>{o.current=!0}),q.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let f=mA(c,JSON.parse(s),a,u.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:sl([e,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[e,n,s,a,t])}const bA=q.createContext(null);function jl(){return q.useContext(bA)}function aV(t){let e=q.useContext(io).outlet;return e&&q.createElement(bA.Provider,{value:t},e)}function Bi(){let{matches:t}=q.useContext(io),e=t[t.length-1];return e?e.params:{}}function Xy(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=q.useContext(Tl),{matches:i}=q.useContext(io),{pathname:a}=Jc(),s=JSON.stringify(pA(i,n.v7_relativeSplatPath));return q.useMemo(()=>mA(t,JSON.parse(s),a,r==="path"),[t,s,a,r])}function sV(t,e){return oV(t,e)}function oV(t,e,r,n){Xp()||Tr(!1);let{navigator:i}=q.useContext(Tl),{matches:a}=q.useContext(io),s=a[a.length-1],o=s?s.params:{};s&&s.pathname;let l=s?s.pathnameBase:"/";s&&s.route;let c=Jc(),u;if(e){var f;let x=typeof e=="string"?ef(e):e;l==="/"||(f=x.pathname)!=null&&f.startsWith(l)||Tr(!1),u=x}else u=c;let h=u.pathname||"/",m=h;if(l!=="/"){let x=l.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(x.length).join("/")}let v=Dz(t,{pathname:m}),y=fV(v&&v.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:sl([l,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:sl([l,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),a,r,n);return e&&y?q.createElement(Yy.Provider,{value:{location:vp({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Ho.Pop}},y):y}function lV(){let t=gV(),e=tV(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},a=null;return q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},e),r?q.createElement("pre",{style:i},r):null,a)}const cV=q.createElement(lV,null);class uV extends q.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?q.createElement(io.Provider,{value:this.props.routeContext},q.createElement(yA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dV(t){let{routeContext:e,match:r,children:n}=t,i=q.useContext(Ky);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),q.createElement(io.Provider,{value:e},n)}function fV(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,o=(i=r)==null?void 0:i.errors;if(o!=null){let u=s.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);u>=0||Tr(!1),s=s.slice(0,Math.min(s.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<s.length;u++){let f=s[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=u),f.route.id){let{loaderData:h,errors:m}=r,v=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||v){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((u,f,h)=>{let m,v=!1,y=null,x=null;r&&(m=o&&f.route.id?o[f.route.id]:void 0,y=f.route.errorElement||cV,l&&(c<0&&h===0?(yV("route-fallback",!1),v=!0,x=null):c===h&&(v=!0,x=f.route.hydrateFallbackElement||null)));let b=e.concat(s.slice(0,h+1)),S=()=>{let w;return m?w=y:v?w=x:f.route.Component?w=q.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=u,q.createElement(dV,{match:f,routeContext:{outlet:u,matches:b,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?q.createElement(uV,{location:r.location,revalidation:r.revalidation,component:y,error:m,children:S(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):S()},null)}var wA=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(wA||{}),y0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(y0||{});function hV(t){let e=q.useContext(Ky);return e||Tr(!1),e}function pV(t){let e=q.useContext(vA);return e||Tr(!1),e}function mV(t){let e=q.useContext(io);return e||Tr(!1),e}function SA(t){let e=mV(),r=e.matches[e.matches.length-1];return r.route.id||Tr(!1),r.route.id}function gV(){var t;let e=q.useContext(yA),r=pV(y0.UseRouteError),n=SA(y0.UseRouteError);return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function vV(){let{router:t}=hV(wA.UseNavigateStable),e=SA(y0.UseNavigateStable),r=q.useRef(!1);return xA(()=>{r.current=!0}),q.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,vp({fromRouteId:e},a)))},[t,e])}const kT={};function yV(t,e,r){!e&&!kT[t]&&(kT[t]=!0)}function xV(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function HC(t){return aV(t.context)}function pr(t){Tr(!1)}function bV(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Ho.Pop,navigator:a,static:s=!1,future:o}=t;Xp()&&Tr(!1);let l=e.replace(/^\/*/,"/"),c=q.useMemo(()=>({basename:l,navigator:a,static:s,future:vp({v7_relativeSplatPath:!1},o)}),[l,o,a,s]);typeof n=="string"&&(n=ef(n));let{pathname:u="/",search:f="",hash:h="",state:m=null,key:v="default"}=n,y=q.useMemo(()=>{let x=Ad(u,l);return x==null?null:{location:{pathname:x,search:f,hash:h,state:m,key:v},navigationType:i}},[l,u,f,h,m,v,i]);return y==null?null:q.createElement(Tl.Provider,{value:c},q.createElement(Yy.Provider,{children:r,value:y}))}function wV(t){let{children:e,location:r}=t;return sV(R5(e),r)}new Promise(()=>{});function R5(t,e){e===void 0&&(e=[]);let r=[];return q.Children.forEach(t,(n,i)=>{if(!q.isValidElement(n))return;let a=[...e,i];if(n.type===q.Fragment){r.push.apply(r,R5(n.props.children,a));return}n.type!==pr&&Tr(!1),!n.props.index||!n.props.children||Tr(!1);let s={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=R5(n.props.children,a)),r.push(s)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function x0(){return x0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},x0.apply(this,arguments)}function kA(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function SV(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function kV(t,e){return t.button===0&&(!e||e==="_self")&&!SV(t)}const CV=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],NV=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],EV="6";try{window.__reactRouterVersion=EV}catch{}const TV=q.createContext({isTransitioning:!1}),jV="startTransition",CT=bB[jV];function MV(t){let{basename:e,children:r,future:n,window:i}=t,a=q.useRef();a.current==null&&(a.current=_z({window:i,v5Compat:!0}));let s=a.current,[o,l]=q.useState({action:s.action,location:s.location}),{v7_startTransition:c}=n||{},u=q.useCallback(f=>{c&&CT?CT(()=>l(f)):l(f)},[l,c]);return q.useLayoutEffect(()=>s.listen(u),[s,u]),q.useEffect(()=>xV(n),[n]),q.createElement(bV,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:s,future:n})}const PV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_V=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Lc=q.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:a,replace:s,state:o,target:l,to:c,preventScrollReset:u,viewTransition:f}=e,h=kA(e,CV),{basename:m}=q.useContext(Tl),v,y=!1;if(typeof c=="string"&&_V.test(c)&&(v=c,PV))try{let w=new URL(window.location.href),k=c.startsWith("//")?new URL(w.protocol+c):new URL(c),N=Ad(k.pathname,m);k.origin===w.origin&&N!=null?c=N+k.search+k.hash:y=!0}catch{}let x=nV(c,{relative:i}),b=DV(c,{replace:s,state:o,target:l,preventScrollReset:u,relative:i,viewTransition:f});function S(w){n&&n(w),w.defaultPrevented||b(w)}return q.createElement("a",x0({},h,{href:v||x,onClick:y||a?n:S,ref:r,target:l}))}),AV=q.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:i=!1,className:a="",end:s=!1,style:o,to:l,viewTransition:c,children:u}=e,f=kA(e,NV),h=Xy(l,{relative:f.relative}),m=Jc(),v=q.useContext(vA),{navigator:y,basename:x}=q.useContext(Tl),b=v!=null&&OV(h)&&c===!0,S=y.encodeLocation?y.encodeLocation(h).pathname:h.pathname,w=m.pathname,k=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;i||(w=w.toLowerCase(),k=k?k.toLowerCase():null,S=S.toLowerCase()),k&&x&&(k=Ad(k,x)||k);const N=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let j=w===S||!s&&w.startsWith(S)&&w.charAt(N)==="/",T=k!=null&&(k===S||!s&&k.startsWith(S)&&k.charAt(S.length)==="/"),M={isActive:j,isPending:T,isTransitioning:b},A=j?n:void 0,_;typeof a=="function"?_=a(M):_=[a,j?"active":null,T?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let D=typeof o=="function"?o(M):o;return q.createElement(Lc,x0({},f,{"aria-current":A,className:_,ref:r,style:D,to:l,viewTransition:c}),typeof u=="function"?u(M):u)});var D5;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(D5||(D5={}));var NT;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(NT||(NT={}));function RV(t){let e=q.useContext(Ky);return e||Tr(!1),e}function DV(t,e){let{target:r,replace:n,state:i,preventScrollReset:a,relative:s,viewTransition:o}=e===void 0?{}:e,l=Li(),c=Jc(),u=Xy(t,{relative:s});return q.useCallback(f=>{if(kV(f,r)){f.preventDefault();let h=n!==void 0?n:g0(c)===g0(u);l(t,{replace:h,state:i,preventScrollReset:a,relative:s,viewTransition:o})}},[c,l,u,n,i,r,t,a,s,o])}function OV(t,e){e===void 0&&(e={});let r=q.useContext(TV);r==null&&Tr(!1);let{basename:n}=RV(D5.useViewTransitionState),i=Xy(t,{relative:e.relative});if(!r.isTransitioning)return!1;let a=Ad(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=Ad(r.nextLocation.pathname,n)||r.nextLocation.pathname;return v0(i.pathname,s)!=null||v0(i.pathname,a)!=null}const WC="-",IV=t=>{const e=BV(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:s=>{const o=s.split(WC);return o[0]===""&&o.length!==1&&o.shift(),CA(o,e)||LV(s)},getConflictingClassGroupIds:(s,o)=>{const l=r[s]||[];return o&&n[s]?[...l,...n[s]]:l}}},CA=(t,e)=>{var s;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?CA(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const a=t.join(WC);return(s=e.validators.find(({validator:o})=>o(a)))==null?void 0:s.classGroupId},ET=/^\[(.+)\]$/,LV=t=>{if(ET.test(t)){const e=ET.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},BV=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return zV(Object.entries(t.classGroups),r).forEach(([a,s])=>{O5(s,n,a,e)}),n},O5=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const a=i===""?e:TT(e,i);a.classGroupId=r;return}if(typeof i=="function"){if(FV(i)){O5(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{O5(s,TT(e,a),r,n)})})},TT=(t,e)=>{let r=t;return e.split(WC).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},FV=t=>t.isThemeGetter,zV=(t,e)=>e?t.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?e+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,o])=>[e+s,o])):a);return[r,i]}):t,VV=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),e++,e>t&&(e=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},NA="!",$V=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],a=e.length,s=o=>{const l=[];let c=0,u=0,f;for(let x=0;x<o.length;x++){let b=o[x];if(c===0){if(b===i&&(n||o.slice(x,x+a)===e)){l.push(o.slice(u,x)),u=x+a;continue}if(b==="/"){f=x;continue}}b==="["?c++:b==="]"&&c--}const h=l.length===0?o:o.substring(u),m=h.startsWith(NA),v=m?h.substring(1):h,y=f&&f>u?f-u:void 0;return{modifiers:l,hasImportantModifier:m,baseClassName:v,maybePostfixModifierPosition:y}};return r?o=>r({className:o,parseClassName:s}):s},UV=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},GV=t=>({cache:VV(t.cacheSize),parseClassName:$V(t),...IV(t)}),HV=/\s+/,WV=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,a=[],s=t.trim().split(HV);let o="";for(let l=s.length-1;l>=0;l-=1){const c=s[l],{modifiers:u,hasImportantModifier:f,baseClassName:h,maybePostfixModifierPosition:m}=r(c);let v=!!m,y=n(v?h.substring(0,m):h);if(!y){if(!v){o=c+(o.length>0?" "+o:o);continue}if(y=n(h),!y){o=c+(o.length>0?" "+o:o);continue}v=!1}const x=UV(u).join(":"),b=f?x+NA:x,S=b+y;if(a.includes(S))continue;a.push(S);const w=i(y,v);for(let k=0;k<w.length;++k){const N=w[k];a.push(b+N)}o=c+(o.length>0?" "+o:o)}return o};function qV(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=EA(e))&&(n&&(n+=" "),n+=r);return n}const EA=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=EA(t[n]))&&(r&&(r+=" "),r+=e);return r};function KV(t,...e){let r,n,i,a=s;function s(l){const c=e.reduce((u,f)=>f(u),t());return r=GV(c),n=r.cache.get,i=r.cache.set,a=o,o(l)}function o(l){const c=n(l);if(c)return c;const u=WV(l,r);return i(l,u),u}return function(){return a(qV.apply(null,arguments))}}const Zt=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},TA=/^\[(?:([a-z-]+):)?(.+)\]$/i,YV=/^\d+\/\d+$/,XV=new Set(["px","full","screen"]),QV=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,JV=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ZV=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,e$=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,t$=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ps=t=>vd(t)||XV.has(t)||YV.test(t),No=t=>tf(t,"length",c$),vd=t=>!!t&&!Number.isNaN(Number(t)),dw=t=>tf(t,"number",vd),Wf=t=>!!t&&Number.isInteger(Number(t)),r$=t=>t.endsWith("%")&&vd(t.slice(0,-1)),ut=t=>TA.test(t),Eo=t=>QV.test(t),n$=new Set(["length","size","percentage"]),i$=t=>tf(t,n$,jA),a$=t=>tf(t,"position",jA),s$=new Set(["image","url"]),o$=t=>tf(t,s$,d$),l$=t=>tf(t,"",u$),qf=()=>!0,tf=(t,e,r)=>{const n=TA.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},c$=t=>JV.test(t)&&!ZV.test(t),jA=()=>!1,u$=t=>e$.test(t),d$=t=>t$.test(t),f$=()=>{const t=Zt("colors"),e=Zt("spacing"),r=Zt("blur"),n=Zt("brightness"),i=Zt("borderColor"),a=Zt("borderRadius"),s=Zt("borderSpacing"),o=Zt("borderWidth"),l=Zt("contrast"),c=Zt("grayscale"),u=Zt("hueRotate"),f=Zt("invert"),h=Zt("gap"),m=Zt("gradientColorStops"),v=Zt("gradientColorStopPositions"),y=Zt("inset"),x=Zt("margin"),b=Zt("opacity"),S=Zt("padding"),w=Zt("saturate"),k=Zt("scale"),N=Zt("sepia"),j=Zt("skew"),T=Zt("space"),M=Zt("translate"),A=()=>["auto","contain","none"],_=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",ut,e],R=()=>[ut,e],I=()=>["",Ps,No],$=()=>["auto",vd,ut],B=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],U=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],F=()=>["start","end","center","between","around","evenly","stretch"],Q=()=>["","0",ut],K=()=>["auto","avoid","all","avoid-page","page","left","right","column"],L=()=>[vd,ut];return{cacheSize:500,separator:":",theme:{colors:[qf],spacing:[Ps,No],blur:["none","",Eo,ut],brightness:L(),borderColor:[t],borderRadius:["none","","full",Eo,ut],borderSpacing:R(),borderWidth:I(),contrast:L(),grayscale:Q(),hueRotate:L(),invert:Q(),gap:R(),gradientColorStops:[t],gradientColorStopPositions:[r$,No],inset:D(),margin:D(),opacity:L(),padding:R(),saturate:L(),scale:L(),sepia:Q(),skew:L(),space:R(),translate:R()},classGroups:{aspect:[{aspect:["auto","square","video",ut]}],container:["container"],columns:[{columns:[Eo]}],"break-after":[{"break-after":K()}],"break-before":[{"break-before":K()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...B(),ut]}],overflow:[{overflow:_()}],"overflow-x":[{"overflow-x":_()}],"overflow-y":[{"overflow-y":_()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Wf,ut]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ut]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",Wf,ut]}],"grid-cols":[{"grid-cols":[qf]}],"col-start-end":[{col:["auto",{span:["full",Wf,ut]},ut]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[qf]}],"row-start-end":[{row:["auto",{span:[Wf,ut]},ut]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ut]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ut]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...F()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...F(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...F(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[S]}],px:[{px:[S]}],py:[{py:[S]}],ps:[{ps:[S]}],pe:[{pe:[S]}],pt:[{pt:[S]}],pr:[{pr:[S]}],pb:[{pb:[S]}],pl:[{pl:[S]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[T]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[T]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ut,e]}],"min-w":[{"min-w":[ut,e,"min","max","fit"]}],"max-w":[{"max-w":[ut,e,"none","full","min","max","fit","prose",{screen:[Eo]},Eo]}],h:[{h:[ut,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ut,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ut,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ut,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Eo,No]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",dw]}],"font-family":[{font:[qf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ut]}],"line-clamp":[{"line-clamp":["none",vd,dw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ps,ut]}],"list-image":[{"list-image":["none",ut]}],"list-style-type":[{list:["none","disc","decimal",ut]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ps,No]}],"underline-offset":[{"underline-offset":["auto",Ps,ut]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ut]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ut]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...B(),a$]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",i$]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},o$]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:z()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[Ps,ut]}],"outline-w":[{outline:[Ps,No]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[Ps,No]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Eo,l$]}],"shadow-color":[{shadow:[qf]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...U(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":U()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Eo,ut]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[N]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[N]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ut]}],duration:[{duration:L()}],ease:[{ease:["linear","in","out","in-out",ut]}],delay:[{delay:L()}],animate:[{animate:["none","spin","ping","pulse","bounce",ut]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[k]}],"scale-x":[{"scale-x":[k]}],"scale-y":[{"scale-y":[k]}],rotate:[{rotate:[Wf,ut]}],"translate-x":[{"translate-x":[M]}],"translate-y":[{"translate-y":[M]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ut]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ut]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ut]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ps,No,dw]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},qC=KV(f$),Ct=({children:t,className:e,...r})=>d.jsx("div",{className:qC("bg-glass backdrop-blur-xl border border-glass-border rounded-xl",e),...r,children:t}),b0=({url:t,name:e,alt:r="User",size:n="md",className:i})=>{const a={sm:"size-8 text-xs",md:"size-10 text-sm",lg:"size-16 text-lg",xl:"size-32 text-2xl"},s=e?e.charAt(0).toUpperCase():r?r.charAt(0).toUpperCase():"?";return d.jsx("div",{className:qC("rounded-full bg-surface-light border border-white/10 flex items-center justify-center overflow-hidden shrink-0 text-slate-400 font-bold select-none",a[n],i),children:t?d.jsx("img",{src:t,alt:e||r,className:"w-full h-full object-cover"}):d.jsx("span",{children:s})})},h$=()=>d.jsx("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark relative",children:d.jsx("main",{className:"flex-1 min-w-0 relative overflow-hidden flex flex-col",children:d.jsx(HC,{})})}),p$="/api",Ne={async request(t,e={}){const r=`${p$}${t}`,n={"Content-Type":"application/json",...e.headers},i=await fetch(r,{...e,headers:n,credentials:"include"});if(!i.ok){const a=await i.json().catch(()=>({}));throw new Error(a.error||`HTTP error! status: ${i.status}`)}return i.status===204||i.headers.get("content-length")==="0"?null:i.json()},get(t,e={}){return this.request(t,{method:"GET",headers:e})},post(t,e,r={}){return this.request(t,{method:"POST",body:JSON.stringify(e),headers:r})},put(t,e,r={}){return this.request(t,{method:"PUT",body:JSON.stringify(e),headers:r})},patch(t,e,r={}){return this.request(t,{method:"PATCH",body:JSON.stringify(e),headers:r})},delete(t,e={}){return this.request(t,{method:"DELETE",headers:e})}},Kf={list:()=>Ne.get("/workspaces"),create:(t,e,r,n)=>Ne.post("/workspaces",{name:t,title:e,genre:r,imageUrl:n}),delete:t=>Ne.delete("/workspaces/"+t),update:(t,e)=>Ne.put("/workspaces/"+t,e),select:t=>Ne.post("/workspaces/select",{projectName:t})},m$=["FANTASA","SCI-FI","HORROR","LORE","MISTERIO","HISTRICO","CYBERPUNK","STEAMPUNK"],g$=({isOpen:t,onClose:e,onCreate:r})=>{if(!t)return null;const[n,i]=q.useState(!1),[a,s]=q.useState({name:"",title:"",genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"}),o=c=>{const{name:u,value:f}=c.target;s(h=>({...h,[u]:f}))},l=c=>{c.preventDefault();let u=a.name;if(!u&&a.title&&(u=a.title.toLowerCase().replace(/[^a-z0-9]/g,"-")),!u){alert("Project ID/Name is required");return}r({...a,name:u}),e(),s({name:"",title:"",genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"})};return ds.createPortal(d.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),d.jsxs("div",{className:"relative w-full max-w-2xl bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex animate-in zoom-in-95 duration-200",children:[d.jsxs("div",{className:"w-1/3 bg-black relative hidden sm:block",children:[d.jsx("img",{src:a.imageUrl,onError:()=>i(!0),className:`absolute inset-0 w-full h-full object-cover opacity-60 transition-opacity duration-500 ${n?"hidden":""}`,alt:"Preview"}),d.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-6 bg-gradient-to-t from-black to-transparent",children:[d.jsx("h4",{className:"text-white font-black text-xl leading-none",children:a.title||"Untitled"}),d.jsx("span",{className:"text-[10px] font-bold text-primary uppercase tracking-widest mt-2 block",children:a.genre})]})]}),d.jsxs("div",{className:"flex-1 p-8",children:[d.jsx("h2",{className:"text-2xl font-black text-white mb-6",children:"Nuevo Cuaderno"}),d.jsxs("form",{onSubmit:l,className:"space-y-5",children:[d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Ttulo del Proyecto"}),d.jsx("input",{type:"text",name:"title",value:a.title,onChange:o,placeholder:"e.g. Las Crnicas de Etheria",className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all",autoFocus:!0})]}),d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"ID de Archivo (Slug)"}),d.jsx("input",{type:"text",name:"name",value:a.name,onChange:o,placeholder:"e.g. etheria-v1",className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white font-mono text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all placeholder:text-white/10"}),d.jsx("p",{className:"text-[10px] text-white/20",children:"Se usar como nombre del archivo .db"})]}),d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Gnero"}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:m$.slice(0,4).map(c=>d.jsx("button",{type:"button",onClick:()=>s(u=>({...u,genre:c})),className:`px-3 py-2 rounded-lg text-[10px] font-bold border transition-all ${a.genre===c?"bg-primary text-white border-primary":"bg-[#13141f] border-white/10 text-text-muted hover:border-white/20"}`,children:c},c))})]}),d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Imagen de Portada (URL)"}),d.jsx("input",{type:"text",name:"imageUrl",value:a.imageUrl,onChange:c=>{s(u=>({...u,imageUrl:c.target.value})),i(!1)},className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all truncate"})]}),d.jsxs("div",{className:"pt-4 flex gap-3",children:[d.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-[#13141f] hover:bg-white/5 border border-white/10 rounded-xl text-xs font-bold text-text-muted transition-all",children:"Cancelar"}),d.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold transition-all shadow-lg shadow-primary/20 flex items-center justify-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"rocket_launch"}),"Crear Universo"]})]})]})]})]})]}),document.body)},v$=["FANTASA","SCI-FI","HORROR","LORE","MISTERIO","HISTRICO","CYBERPUNK","STEAMPUNK"],y$=({isOpen:t,onClose:e,onUpdate:r,project:n})=>{if(!t||!n)return null;const[i,a]=q.useState(!1),[s,o]=q.useState({name:n,title:n,genre:"FANTASA",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af9f23?auto=format&fit=crop&q=80&w=800"});q.useEffect(()=>{n&&o(c=>({...c,name:n,title:n}))},[n]);const l=c=>{c.preventDefault(),r(s.name,{title:s.title,genre:s.genre,imageUrl:s.imageUrl}),e()};return ds.createPortal(d.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),d.jsxs("div",{className:"relative w-full max-w-2xl bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl overflow-hidden flex animate-in zoom-in-95 duration-200",children:[d.jsxs("div",{className:"w-1/3 bg-black relative hidden sm:block",children:[d.jsx("img",{src:s.imageUrl,onError:()=>a(!0),className:`absolute inset-0 w-full h-full object-cover opacity-60 transition-opacity duration-500 ${i?"hidden":""}`,alt:"Preview"}),d.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-6 bg-gradient-to-t from-black to-transparent",children:[d.jsx("h4",{className:"text-white font-black text-xl leading-none",children:s.title||"Untitled"}),d.jsx("span",{className:"text-[10px] font-bold text-primary uppercase tracking-widest mt-2 block",children:s.genre})]})]}),d.jsxs("div",{className:"flex-1 p-8",children:[d.jsx("h2",{className:"text-2xl font-black text-white mb-6",children:"Editar Cuaderno"}),d.jsxs("form",{onSubmit:l,className:"space-y-5",children:[d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Ttulo del Proyecto"}),d.jsx("input",{type:"text",name:"title",value:s.title,onChange:c=>o(u=>({...u,title:c.target.value})),className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all",autoFocus:!0})]}),d.jsxs("div",{className:"space-y-1.5 opacity-50",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"ID de Archivo (Inmutable)"}),d.jsx("input",{type:"text",value:s.name,readOnly:!0,className:"w-full bg-[#0a0a0c] border border-white/5 rounded-xl px-4 py-3 text-white/50 font-mono text-xs outline-none cursor-not-allowed"})]}),d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Gnero"}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:v$.slice(0,4).map(c=>d.jsx("button",{type:"button",onClick:()=>o(u=>({...u,genre:c})),className:`px-3 py-2 rounded-lg text-[10px] font-bold border transition-all ${s.genre===c?"bg-primary text-white border-primary":"bg-[#13141f] border-white/10 text-text-muted hover:border-white/20"}`,children:c},c))})]}),d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted",children:"Imagen de Portada (URL)"}),d.jsx("input",{type:"text",value:s.imageUrl,onChange:c=>{o(u=>({...u,imageUrl:c.target.value})),a(!1)},className:"w-full bg-[#13141f] border border-white/10 rounded-xl px-4 py-3 text-white text-xs focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all truncate"})]}),d.jsxs("div",{className:"pt-4 flex gap-3",children:[d.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-3 bg-[#13141f] hover:bg-white/5 border border-white/10 rounded-xl text-xs font-bold text-text-muted transition-all",children:"Cancelar"}),d.jsxs("button",{type:"submit",className:"flex-1 px-4 py-3 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold transition-all shadow-lg shadow-primary/20 flex items-center justify-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar Cambios"]})]})]})]})]})]}),document.body)},Wt=q.forwardRef(({children:t,variant:e="primary",size:r="md",className:n,icon:i,isLoading:a,...s},o)=>{const l="inline-flex items-center justify-center rounded-lg font-medium transition-all focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed active:scale-95",c={primary:"bg-primary text-white shadow-lg shadow-primary/25 hover:bg-primary-light hover:shadow-primary/40 border border-transparent",secondary:"bg-surface-light text-slate-200 border border-white/10 hover:bg-white/5 hover:text-white hover:border-white/20",ghost:"bg-transparent text-slate-400 hover:text-white hover:bg-white/5",danger:"bg-red-500/10 text-red-500 border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/50 hover:shadow-lg hover:shadow-red-500/10",outline:"bg-transparent border border-primary/50 text-primary hover:bg-primary/10"},u={xs:"px-2.5 py-1 text-xs gap-1.5",sm:"px-3 py-1.5 text-xs gap-1.5",md:"px-4 py-2 text-sm gap-2",lg:"px-6 py-3 text-base gap-3",icon:"size-9 p-0"};return d.jsxs("button",{ref:o,className:qC(l,c[e],u[r],n),disabled:a,...s,children:[a?d.jsx("span",{className:"material-symbols-outlined animate-spin text-[18px]",children:"progress_activity"}):i?d.jsx("span",{className:"material-symbols-outlined text-[18px]",children:i}):null,t]})});Wt.displayName="Button";const MA=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirm",cancelText:s="Cancel",isDestructive:o=!0})=>t?d.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",onClick:e}),d.jsx("div",{className:"relative z-10 w-full max-w-md animate-in zoom-in-95 duration-300",children:d.jsxs(Ct,{className:"p-6 border-red-500/20 shadow-2xl shadow-black/50",children:[d.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[d.jsx("div",{className:`
                            size-12 rounded-xl flex items-center justify-center shrink-0
                            ${o?"bg-red-500/10 text-red-500":"bg-primary/10 text-primary"}
                        `,children:d.jsx("span",{className:"material-symbols-outlined text-2xl",children:o?"warning":"help"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-black text-white mb-2 leading-tight",children:n}),d.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:i})]})]}),d.jsxs("div",{className:"flex items-center justify-end gap-3",children:[d.jsx(Wt,{variant:"ghost",onClick:e,children:s}),d.jsx(Wt,{variant:o?"danger":"primary",onClick:()=>{r(),e()},icon:o?"delete":"check",children:a})]})]})})]}):null,x$=()=>{const t=Li(),[e,r]=q.useState([]),[n,i]=q.useState(!0),[a,s]=q.useState(null),[o,l]=q.useState(""),[c,u]=q.useState(!1),[f,h]=q.useState(null),[m,v]=q.useState(null);q.useEffect(()=>{y()},[]);const y=async()=>{try{i(!0);const N=await Kf.list();r(N)}catch(N){console.error("Failed to load workspaces",N),s("Error al cargar cuadernos. Est el servidor encendido?")}finally{i(!1)}},x=async N=>{try{i(!0);const j=await Kf.select(N);j.success&&j.redirect&&(localStorage.setItem("user",JSON.stringify({username:"local",success:!0})),t(j.redirect))}catch(j){s(j.message||"Fallo al entrar al cuaderno"),i(!1)}},b=async N=>{try{i(!0),(await Kf.create(N.name,N.title,N.genre,N.imageUrl)).success&&await x(N.name)}catch{s("Error al crear cuaderno"),i(!1)}},S=async()=>{if(f)try{i(!0),await Kf.delete(f),await y(),h(null)}catch{s("Error al borrar el cuaderno"),i(!1)}},w=async(N,j)=>{try{i(!0),await Kf.update(N,j),await y(),v(null)}catch{s("Error al actualizar cuaderno"),i(!1)}},k=e.filter(N=>(N.title||N.filename||"").toLowerCase().includes(o.toLowerCase()));return d.jsxs("div",{className:"h-screen w-full bg-[#0a0b14] text-white flex flex-col items-center font-sans selection:bg-indigo-500/30 overflow-hidden",children:[d.jsxs("div",{className:"w-full max-w-6xl flex-1 flex flex-col overflow-y-auto custom-scrollbar p-8",children:[d.jsxs("header",{className:"w-full mt-24 mb-12 flex flex-col lg:flex-row lg:items-end justify-between gap-8 flex-shrink-0",children:[d.jsx("div",{className:"space-y-4",children:d.jsx("div",{className:"flex items-center gap-4",children:d.jsxs("h1",{className:"text-6xl font-black tracking-tighter leading-none",children:[d.jsx("span",{className:"block text-indigo-400",children:"Mis"}),d.jsx("span",{className:"block text-white",children:"Cuadernos"})]})})}),d.jsx("div",{className:"flex items-center gap-4",children:d.jsxs("div",{className:"relative group min-w-[300px]",children:[d.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-white/20 text-xl group-focus-within:text-indigo-400 transition-colors pointer-events-none",children:"search"}),d.jsx("input",{type:"text",placeholder:"Buscar...",value:o,onChange:N=>l(N.target.value),className:"w-full bg-[#13141f] border border-white/5 rounded-2xl py-3 pl-12 pr-4 text-sm text-white focus:outline-none focus:border-indigo-500/50 transition-all placeholder:text-white/10"})]})})]}),d.jsx("section",{className:"w-full max-w-6xl",children:n?d.jsxs("div",{className:"flex flex-col items-center gap-6 py-20 opacity-20",children:[d.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),d.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em]",children:"Accediendo al Sector Local..."})]}):d.jsxs("div",{className:"flex flex-wrap gap-6 justify-start pb-20",children:[d.jsxs("div",{onClick:()=>u(!0),className:"group relative h-[380px] rounded-[2.5rem] border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-6 hover:bg-white/5 hover:border-indigo-500/30 transition-all cursor-pointer overflow-hidden animate-in fade-in duration-700 w-full md:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)]",children:[d.jsx("div",{className:"w-20 h-20 rounded-full bg-[#13141f] border border-white/5 flex items-center justify-center text-4xl text-white/20 group-hover:scale-110 group-hover:text-indigo-400 transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-4xl",children:"add"})}),d.jsxs("div",{className:"text-center",children:[d.jsx("h3",{className:"text-xl font-black tracking-tight text-white/50 group-hover:text-white transition-colors",children:"Nuevo Cuaderno"}),d.jsx("p",{className:"text-[10px] font-bold text-white/20 uppercase tracking-widest mt-2 group-hover:text-white/40",children:"Inicia un nuevo universo"})]})]}),k.map(N=>{const j=N.imageUrl||"https://images.unsplash.com/photo-1451187580459-43490279c0fa?auto=format&fit=crop&q=80&w=800";return d.jsxs("div",{onClick:()=>x(N.filename),className:"group relative h-[380px] rounded-[2.5rem] bg-[#13141f] border border-white/5 overflow-hidden transition-all hover:-translate-y-2 hover:shadow-2xl hover:shadow-indigo-500/10 cursor-pointer animate-in fade-in slide-in-from-bottom-4 w-full md:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)]",children:[d.jsxs("div",{className:"absolute inset-x-0 top-0 h-2/3",children:[d.jsx("img",{src:j,className:"w-full h-full object-cover opacity-40 group-hover:opacity-60 transition-opacity",alt:""}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#13141f] via-transparent to-transparent"})]}),d.jsxs("div",{className:"absolute top-6 right-6 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-20",children:[d.jsx("button",{onClick:T=>{T.stopPropagation(),v(N.filename)},className:"w-10 h-10 rounded-full bg-black/50 backdrop-blur-md border border-white/10 flex items-center justify-center text-white/70 hover:text-white hover:bg-indigo-500 hover:border-indigo-400 transition-all",title:"Editar",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),d.jsx("button",{onClick:T=>{T.stopPropagation(),h(N.filename)},className:"w-10 h-10 rounded-full bg-black/50 backdrop-blur-md border border-white/10 flex items-center justify-center text-white/70 hover:text-white hover:bg-red-500 hover:border-red-400 transition-all",title:"Eliminar",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),d.jsx("div",{className:"absolute inset-0 flex flex-col justify-end p-8",children:d.jsxs("div",{className:"mt-auto space-y-3",children:[d.jsx("span",{className:"inline-block px-3 py-1 bg-red-500/20 border border-red-500/30 text-[9px] font-black text-red-100 rounded-lg tracking-widest uppercase",children:N.tag}),d.jsx("h3",{className:"text-3xl font-black text-white tracking-tighter leading-tight group-hover:text-indigo-400 transition-colors",children:N.title}),N.title!==N.filename&&d.jsx("p",{className:"text-[10px] text-white/30 font-mono mb-1",children:N.filename}),d.jsx("p",{className:"text-xs text-white/40 line-clamp-2 leading-relaxed",children:"Una tierra dividida por la magia y la tecnologa antigua..."}),d.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-white/5 mt-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]"}),d.jsxs("span",{className:"text-[9px] font-black uppercase tracking-widest text-white/20",children:["ltima edicin: ",d.jsx("span",{className:"text-white/40",children:N.lastModified})]})]}),d.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-[10px] font-black text-indigo-300",children:N.initials})]})]})})]},N.filename)})]})})]}),a&&d.jsx("div",{className:"fixed bottom-8 left-1/2 -translate-x-1/2 px-6 py-3 bg-red-500/20 border border-red-500/30 text-red-200 rounded-2xl text-xs font-bold shadow-2xl animate-bounce",children:a}),d.jsx(g$,{isOpen:c,onClose:()=>u(!1),onCreate:b}),d.jsx(y$,{isOpen:!!m,onClose:()=>v(null),project:m,onUpdate:w}),d.jsx(MA,{isOpen:!!f,onClose:()=>h(null),onConfirm:S,title:"Eliminar Proyecto?",message:`Ests a punto de borrar "${f}" y todo su contenido permanentemente. Esta accin no se puede deshacer.`,confirmText:"Eliminar Universo",isDestructive:!0})]})},Pg=({icon:t,title:e,desc:r,color:n})=>d.jsxs("div",{className:"group relative p-8 rounded-[32px] bg-surface-dark border border-white/5 hover:border-white/10 transition-all cursor-pointer flex flex-col h-full gap-6 hover:shadow-2xl hover:shadow-black/40",children:[d.jsx("div",{className:`size-14 rounded-2xl ${n} flex items-center justify-center text-white shadow-lg group-hover:scale-110 transition-all duration-500`,children:d.jsx("span",{className:"material-symbols-outlined text-3xl",children:t})}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-2xl font-bold text-white tracking-tight",children:e}),d.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:r})]}),d.jsxs("div",{className:"mt-auto pt-4 border-t border-white/5 flex items-center justify-between text-slate-500 group-hover:text-white transition-colors",children:[d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Architect Tool"}),d.jsx("span",{className:"material-symbols-outlined text-xl group-hover:translate-x-1 transition-transform",children:"arrow_forward"})]})]}),b$=()=>{const{projectName:t,handleCreateEntity:e}=jl(),r=Li();return Bi(),d.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-12 gap-16 max-w-6xl mx-auto w-full",children:[d.jsxs("div",{className:"flex flex-col items-center text-center gap-8 max-w-2xl animate-in fade-in slide-in-from-bottom-8 duration-700",children:[d.jsx("div",{className:"size-20 rounded-full bg-white text-background-dark flex items-center justify-center shadow-2xl shadow-white/20",children:d.jsx("span",{className:"material-symbols-outlined text-4xl font-bold",children:"explore"})}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tighter leading-tight",children:"Bienvenido de nuevo, Viajero."}),d.jsxs("p",{className:"text-xl text-slate-400 font-medium leading-relaxed",children:["Tu mundo ",d.jsx("span",{className:"text-primary font-bold",children:t||"Cargando..."})," espera ser descubierto. El lienzo est vaco, pero tu imaginacin no tiene lmites. Cmo empezamos hoy?"]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 w-full items-stretch animate-in fade-in slide-in-from-bottom-12 duration-1000 delay-300",children:[d.jsx("div",{onClick:()=>e(null,"default"),children:d.jsx(Pg,{icon:"person_add",title:"Aadir Entidad",desc:"Agrega un personaje, lugar o item importante a tu base de datos.",color:"bg-indigo-600"})}),d.jsx("div",{onClick:()=>e(null,"map"),children:d.jsx(Pg,{icon:"map",title:"Crear Mapa",desc:"Dibuja una representacin cartogrfica de una regin.",color:"bg-purple-600"})}),d.jsx("div",{onClick:()=>r("writing"),children:d.jsx(Pg,{icon:"edit_note",title:"Empezar a Escribir",desc:"Abre el editor de texto y comienza un nuevo captulo.",color:"bg-emerald-600"})}),d.jsx("div",{onClick:()=>alert("WIP: Notas Rpidas"),children:d.jsx(Pg,{icon:"lightbulb",title:"Ver Ideas Rpidas",desc:"Revisa tus notas y fragmentos de inspiracin guardados.",color:"bg-amber-600"})})]})]})},w$=()=>{var u,f;const t=Li(),[e,r]=q.useState(null),[n,i]=q.useState("appearance"),[a,s]=q.useState({theme:"deep_space",font:"Manrope",fontSize:16,focusMode:!1,transparencyEffects:!0,vaultPath:"./data"});q.useEffect(()=>{console.log("Settings Page Mounted");try{const h=localStorage.getItem("user");h&&h!=="undefined"&&r(JSON.parse(h))}catch(h){console.error("Failed to parse user settings",h)}},[]);const o=async()=>{try{await Ne.post("/auth/logout",{})}catch(h){console.error("Logout error",h)}finally{localStorage.removeItem("user"),sessionStorage.clear(),t("/")}},l=[{id:"general",label:"General",icon:"settings"},{id:"appearance",label:"Apariencia",icon:"palette"},{id:"editor",label:"Editor",icon:"edit_note"},{id:"sync",label:"Sincronizacin",icon:"sync_lock"},{id:"notifications",label:"Notificaciones",icon:"notifications"}],c=[{id:"deep_space",label:"Deep Space",color:"#0f172a"},{id:"nebula",label:"Nebula",color:"#312e81"},{id:"high_contrast",label:"High Contrast",color:"#000000"}];return d.jsxs("div",{className:"flex w-full h-full bg-[#050508] text-white font-sans overflow-hidden",children:[d.jsxs("aside",{className:"w-64 flex-none flex flex-col border-r border-white/5 bg-[#0a0a0e]",children:[d.jsxs("div",{className:"p-8 pb-4",children:[d.jsx("div",{className:"size-10 rounded-full bg-white flex items-center justify-center text-black mb-4",children:d.jsx("span",{className:"material-symbols-outlined text-2xl",children:"settings"})}),d.jsx("h1",{className:"text-xl font-bold tracking-tight",children:"Ajustes"}),d.jsx("p",{className:"text-xs text-slate-500 font-mono mt-1",children:"v2.4.0 Local-Build"})]}),d.jsx("nav",{className:"flex-1 px-4 py-4 space-y-1",children:l.map(h=>d.jsxs("button",{onClick:()=>i(h.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold transition-all ${n===h.id?"bg-indigo-500/10 text-indigo-400":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[d.jsx("span",{className:"material-symbols-outlined text-lg",children:h.icon}),h.label]},h.id))}),d.jsx("div",{className:"p-4 border-t border-white/5",children:d.jsxs("button",{onClick:o,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold text-red-400 hover:bg-red-500/10 transition-colors",children:[d.jsx("span",{className:"material-symbols-outlined text-lg",children:"logout"}),"Cerrar Sesin"]})})]}),d.jsx("main",{className:"flex-1 overflow-y-auto p-12 custom-scrollbar",children:d.jsxs("div",{className:"max-w-3xl mx-auto space-y-12",children:[d.jsxs("header",{children:[d.jsx("h2",{className:"text-3xl font-bold mb-2",children:(u=l.find(h=>h.id===n))==null?void 0:u.label}),d.jsx("p",{className:"text-slate-500",children:"Personaliza la interfaz visual y tu entorno de escritura para maximizar tu creatividad y concentracin."})]}),n==="appearance"&&d.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4",children:[d.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8",children:[d.jsx("h3",{className:"text-lg font-bold mb-1",children:"Tema de la Interfaz"}),d.jsx("p",{className:"text-xs text-slate-500 mb-6",children:"Selecciona el esquema de colores que prefieras."}),d.jsx("div",{className:"grid grid-cols-3 gap-6",children:c.map(h=>d.jsxs("button",{onClick:()=>s({...a,theme:h.id}),className:`relative group text-left transition-all ${a.theme===h.id?"ring-2 ring-indigo-500":"hover:ring-1 hover:ring-white/20"} rounded-2xl overflow-hidden`,children:[d.jsx("div",{className:"h-32 bg-black/20 relative p-4 flex items-center justify-center",children:d.jsx("div",{className:"w-full h-full rounded-xl flex items-center justify-center",style:{backgroundColor:h.color},children:d.jsx("div",{className:"size-8 rounded-full bg-white/10 backdrop-blur-md"})})}),d.jsx("div",{className:"p-4 bg-[#18181b]",children:d.jsx("span",{className:"text-xs font-bold text-slate-300 group-hover:text-white",children:h.label})})]},h.id))})]}),d.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-8 space-y-8",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("span",{className:"material-symbols-outlined text-indigo-400",children:"text_fields"}),d.jsx("h3",{className:"text-lg font-bold",children:"Configuracin del Editor"})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-12 border-b border-white/5 pb-8",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Tipografa"}),d.jsxs("div",{className:"relative",children:[d.jsxs("select",{value:a.font,onChange:h=>s({...a,font:h.target.value}),className:"w-full bg-[#18181b] border border-white/10 rounded-xl px-4 py-3 text-sm text-white appearance-none outline-none focus:border-indigo-500 transition-colors",children:[d.jsx("option",{value:"Manrope",children:"Manrope (Sans-serif)"}),d.jsx("option",{value:"Inter",children:"Inter"}),d.jsx("option",{value:"Merriweather",children:"Merriweather (Serif)"})]}),d.jsx("span",{className:"material-symbols-outlined absolute right-4 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none text-sm",children:"expand_more"})]}),d.jsx("p",{className:"text-[10px] text-slate-600",children:"La fuente utilizada en el lienzo de escritura."})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex justify-between",children:[d.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Tamao de Fuente"}),d.jsxs("span",{className:"text-xs font-bold text-indigo-400",children:[a.fontSize,"px"]})]}),d.jsx("input",{type:"range",min:"12",max:"24",value:a.fontSize,onChange:h=>s({...a,fontSize:parseInt(h.target.value)}),className:"w-full accent-indigo-500 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer"}),d.jsxs("div",{className:"flex justify-between text-[10px] text-slate-600 font-bold uppercase",children:[d.jsx("span",{children:"Aa"}),d.jsx("span",{children:"Aa"})]})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"size-10 rounded-full bg-white/5 flex items-center justify-center text-slate-400",children:d.jsx("span",{className:"material-symbols-outlined",children:"center_focus_strong"})}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-bold text-white",children:"Modo Enfoque"}),d.jsx("p",{className:"text-xs text-slate-500",children:"Oculta todos los paneles laterales al escribir."})]})]}),d.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:a.focusMode,onChange:h=>s({...a,focusMode:h.target.checked}),className:"sr-only peer"}),d.jsx("div",{className:"w-11 h-6 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-slate-400 after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-500 peer-checked:after:bg-white"})]})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"size-10 rounded-full bg-white/5 flex items-center justify-center text-slate-400",children:d.jsx("span",{className:"material-symbols-outlined",children:"blur_on"})}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-bold text-white",children:"Efectos de Transparencia"}),d.jsx("p",{className:"text-xs text-slate-500",children:"Desactivar para mejorar el rendimiento."})]})]}),d.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:a.transparencyEffects,onChange:h=>s({...a,transparencyEffects:h.target.checked}),className:"sr-only peer"}),d.jsx("div",{className:"w-11 h-6 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-slate-400 after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-500 peer-checked:after:bg-white"})]})]})]})]}),d.jsxs("section",{className:"bg-[#0f0f13] border border-white/5 rounded-3xl p-1 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-indigo-500 rounded-l-3xl"}),d.jsxs("div",{className:"p-8",children:[d.jsxs("div",{className:"flex justify-between items-start mb-6",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx("span",{className:"material-symbols-outlined text-indigo-400 text-2xl",children:"folder_special"}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-bold text-white",children:"Almacenamiento Local"}),d.jsx("p",{className:"text-xs text-slate-500",children:"Tus datos viven en tu dispositivo. Gestiona tus copias de seguridad."})]})]}),d.jsxs("span",{className:"px-3 py-1 bg-green-500/10 text-green-400 rounded-full text-[10px] font-bold uppercase border border-green-500/20 flex items-center gap-2",children:[d.jsx("span",{className:"size-1.5 rounded-full bg-green-500 animate-pulse"})," Sincronizado"]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-bold text-slate-500 block mb-2",children:"Ruta de la Bveda"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("div",{className:"flex-1 bg-[#18181b] border border-white/10 rounded-xl px-4 py-3 text-xs font-mono text-slate-300 truncate",children:a.vaultPath}),d.jsx("button",{className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-xl text-xs font-bold transition-colors",children:"Cambiar"})]})]}),d.jsxs("div",{className:"bg-[#18181b] rounded-xl p-4 flex items-center justify-between border border-white/5",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"size-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:d.jsx("span",{className:"material-symbols-outlined",children:"history"})}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-bold text-white",children:"Copia de Seguridad Automtica"}),d.jsx("p",{className:"text-[10px] text-slate-500",children:"Ultima copia: Hace 12 minutos"})]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-lg text-xs font-bold transition-colors",children:"Restaurar"}),d.jsx("button",{className:"px-4 py-2 bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg text-xs font-bold transition-colors shadow-lg shadow-indigo-500/20",children:"Respaldar Ahora"})]})]})]})]})]}),d.jsx("div",{className:"flex justify-end pt-8 pb-20",children:d.jsx("button",{className:"px-8 py-3 bg-white text-black font-bold rounded-full hover:scale-105 transition-transform shadow-xl",children:"Guardar Cambios"})})]}),n!=="appearance"&&d.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] text-slate-600",children:[d.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-20",children:"construction"}),d.jsx("h3",{className:"text-xl font-bold text-slate-500",children:"En Construccin"}),d.jsxs("p",{className:"text-sm",children:["El mdulo ",(f=l.find(h=>h.id===n))==null?void 0:f.label," estar disponible pronto."]})]})]})})]})},Qp=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,confirmText:a="Confirmar",cancelText:s="Cancelar",type:o="danger"})=>t?ds.createPortal(d.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",onClick:e}),d.jsxs("div",{className:"relative w-full max-w-md bg-[#0a0a0c] border border-white/10 rounded-3xl shadow-2xl p-6 animate-in zoom-in-95 duration-200 overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 right-0 h-32 bg-gradient-to-b from-white/5 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 text-center",children:[d.jsx("div",{className:`mx-auto mb-4 size-16 rounded-2xl flex items-center justify-center ${o==="danger"?"bg-red-500/10 text-red-500":"bg-yellow-500/10 text-yellow-500"}`,children:d.jsx("span",{className:"material-symbols-outlined text-3xl",children:o==="danger"?"delete_forever":"warning"})}),d.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n}),d.jsx("p",{className:"text-text-muted text-sm mb-8 leading-relaxed",children:i}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{onClick:e,className:"flex-1 px-4 py-3 rounded-xl bg-surface-light hover:bg-white/10 text-text-muted hover:text-white text-xs font-bold transition-all border border-white/5",children:s}),d.jsx("button",{onClick:()=>{r(),e()},className:`flex-1 px-4 py-3 rounded-xl text-white text-xs font-bold transition-all shadow-lg flex items-center justify-center gap-2
                                ${o==="danger"?"bg-red-500 hover:bg-red-600 shadow-red-500/20":"bg-primary hover:bg-primary-light shadow-primary/20"}`,children:d.jsx("span",{children:a})})]})]})]})]}),document.body):null,jT=({compact:t=!1})=>{const[e,r]=q.useState(null),[n,i]=q.useState([]),[a,s]=q.useState(!1),[o,l]=q.useState(null);q.useEffect(()=>{c()},[]);const c=async()=>{try{const m=await Ne.get("/world-bible/folders");m.length>0&&r(m[0].id),u()}catch(m){console.error("Init error:",m)}},u=async()=>{s(!0);try{const m=await Ne.get("/world-bible/templates/global");i(m)}catch(m){console.error("Error loading templates:",m)}finally{s(!1)}},f=async m=>{if(e)try{await Ne.post(`/world-bible/folders/${e}/templates`,{nombre:m.label,tipo:m.type,required:m.required,metadata:m.metadata?JSON.stringify(m.metadata):null,global:!0}),u()}catch(v){console.error("Error creating template:",v)}},h=async()=>{if(o)try{await Ne.delete(`/world-bible/templates/${o}`),i(m=>m.filter(v=>v.id!==o))}catch(m){console.error("Error deleting template:",m)}finally{l(null)}};return d.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-right-4 duration-500",children:[d.jsxs(Ct,{className:`${t?"p-4 bg-transparent border-none shadow-none":"p-8 space-y-8"}`,children:[d.jsx("header",{className:`flex ${t?"flex-col gap-4":"justify-between items-center"}`,children:d.jsxs("div",{children:[d.jsx("h3",{className:`${t?"text-sm":"text-xl"} font-bold text-white`,children:"Atributos Globales"}),d.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Define atributos disponibles para todas las entidades."})]})}),d.jsxs("div",{className:"space-y-4",children:[a?d.jsx("div",{className:"text-center p-4 text-slate-500",children:"Cargando plantillas..."}):n.map((m,v)=>d.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-primary/50 hover:bg-white/5 transition-all cursor-grab active:cursor-grabbing group select-none",draggable:!0,onDragStart:y=>{y.dataTransfer.setData("application/reactflow/type","attribute"),y.dataTransfer.setData("templateId",m.id),y.dataTransfer.setData("templateData",JSON.stringify(m)),y.dataTransfer.effectAllowed="copy"},children:[d.jsxs("span",{className:"text-[10px] font-black text-slate-700 w-6 group-hover:text-primary transition-colors",children:["0",v+1]}),d.jsxs("div",{className:"flex-1 pointer-events-none",children:[d.jsx("div",{className:"text-sm font-bold text-white",children:m.nombre}),d.jsxs("div",{className:"text-[10px] text-slate-500 uppercase tracking-widest",children:[m.tipo," ",m.esObligatorio&&" Required"]}),m.metadata&&d.jsx("div",{className:"text-[10px] text-slate-600 font-mono mt-1 truncate",children:m.metadata})]}),d.jsx("button",{onClick:()=>l(m.id),className:"p-1.5 text-slate-500 hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",title:"Eliminar Plantilla Global",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},m.id)),d.jsx(S$,{onAdd:f})]})]}),d.jsx(Qp,{isOpen:!!o,onClose:()=>l(null),onConfirm:h,title:"Eliminar Plantilla",message:"Ests seguro de que quieres eliminar esta plantilla? Esta accin es irreversible.",confirmText:"Eliminar",type:"danger"})]})},S$=({onAdd:t})=>{const[e,r]=q.useState(""),[n,i]=q.useState("text"),[a,s]=q.useState(!1),[o,l]=q.useState([""]),c=()=>l([...o,""]),u=m=>l(o.filter((v,y)=>y!==m)),f=(m,v)=>{const y=[...o];y[m]=v,l(y)},h=()=>{if(!e)return;let m=null;["select","multi_select"].includes(n)&&(m={options:o.filter(v=>v.trim())}),t({label:e,type:n,required:a,metadata:m}),r(""),l([""])};return d.jsxs("div",{className:"p-4 rounded-2xl border-2 border-dashed border-white/10 bg-white/[0.01] space-y-4",children:[d.jsx("h4",{className:"text-xs font-black uppercase tracking-widest text-primary",children:"Add New Attribute"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsx("input",{placeholder:"Field Name",value:e,onChange:m=>r(m.target.value),className:"bg-black/20 border border-white/5 rounded-xl px-4 py-2 text-xs text-white outline-none focus:border-primary/30 min-w-0"}),d.jsxs("select",{value:n,onChange:m=>i(m.target.value),className:"bg-black/20 border border-white/5 rounded-xl px-4 py-2 text-xs text-white outline-none",children:[d.jsx("option",{value:"text",children:"Text (Long)"}),d.jsx("option",{value:"short_text",children:"Text (Short)"}),d.jsx("option",{value:"number",children:"Number"}),d.jsx("option",{value:"date",children:"Date"}),d.jsx("option",{value:"select",children:"Single Selection (Dropdown)"}),d.jsx("option",{value:"multi_select",children:"Multiple Selection"}),d.jsx("option",{value:"boolean",children:"Switch (True/False)"})]})]}),["select","multi_select"].includes(n)&&d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Options"}),d.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-2 custom-scrollbar",children:o.map((m,v)=>d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{placeholder:`Option ${v+1}`,value:m,onChange:y=>f(v,y.target.value),className:"flex-1 bg-black/20 border border-white/5 rounded-lg px-3 py-1.5 text-xs text-white outline-none focus:border-primary/30"}),d.jsx("button",{onClick:()=>u(v),className:"p-1.5 hover:bg-red-500/20 text-slate-500 hover:text-red-400 rounded-lg transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]},v))}),d.jsx("button",{onClick:c,className:"w-full py-1.5 text-[10px] font-bold uppercase tracking-widest text-primary hover:bg-primary/5 rounded-lg border border-dashed border-primary/20 transition-all",children:"+ Add Custom Option"})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:a,onChange:m=>s(m.target.checked),className:"size-4 rounded border-white/10 bg-white/5 accent-primary"}),d.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"Required Field"})]}),d.jsx("button",{onClick:h,className:"px-4 py-2 bg-primary/20 text-primary rounded-lg text-xs font-bold hover:bg-primary/30 transition-all",children:"+ Add Field"})]})]})},MT=({projectName:t,storageKey:e})=>{const[r,n]=q.useState([]),[i,a]=q.useState(!1),[s,o]=q.useState(null),l=()=>e||`notes_v2_${t}`;q.useEffect(()=>{const S=l();if(!S)return;const w=localStorage.getItem(S);if(w)n(JSON.parse(w));else if(!e){const k=localStorage.getItem(`notes_${t}`);if(k){const N={id:Date.now(),title:"Nota General",content:k};n([N]),localStorage.setItem(S,JSON.stringify([N]))}}},[t,e]);const c=S=>{n(S);const w=l();w&&localStorage.setItem(w,JSON.stringify(S))},u=()=>{const S={id:Date.now(),title:"Nueva Nota",content:""};c([...r,S]),o(S.id)},[f,h]=q.useState(null),m=S=>{h(S)},v=()=>{f&&(c(r.filter(S=>S.id!==f)),h(null))},y=(S,w,k)=>{c(r.map(N=>N.id===S?{...N,[w]:k}:N))},x=()=>a(!i),b=()=>d.jsxs("div",{className:`flex flex-col h-full bg-surface-dark/40 ${i?"":"max-h-[25vh]"}`,children:[d.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-glass-border bg-white/5",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"edit_note"}),d.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-white",children:["Notas (",r.length,")"]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:u,className:"p-1 hover:text-primary text-text-muted transition-colors",title:"Aadir Nota",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})}),d.jsx("button",{onClick:x,className:"p-1 hover:text-white text-text-muted transition-colors",title:"Pantalla Completa",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:i?"fullscreen_exit":"fullscreen"})})]})]}),d.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-2",children:r.length===0?d.jsx("div",{className:"py-8 text-center opacity-30 italic text-[10px] uppercase font-bold",children:"Sin notas"}):r.map(S=>d.jsxs("div",{className:"group bg-white/5 border border-glass-border rounded-xl overflow-hidden hover:border-primary/30 transition-all",children:[d.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white/5",children:[d.jsx("input",{className:"bg-transparent border-none text-[11px] font-bold text-white outline-none w-full",value:S.title,onChange:w=>y(S.id,"title",w.target.value),placeholder:"Ttulo..."}),d.jsx("button",{onClick:()=>m(S.id),className:"opacity-0 group-hover:opacity-100 p-1 text-text-muted hover:text-red-400 transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-xs",children:"delete"})})]}),d.jsx("textarea",{className:"w-full bg-transparent p-3 text-xs text-white/70 outline-none resize-none min-h-[80px] custom-scrollbar",value:S.content,onChange:w=>y(S.id,"content",w.target.value),placeholder:"Escribe el contenido aqu..."})]},S.id))}),d.jsx(Qp,{isOpen:!!f,onClose:()=>h(null),onConfirm:v,title:"Eliminar Nota",message:"Ests seguro de que quieres eliminar esta nota? No se podr recuperar.",confirmText:"Eliminar",type:"danger"})]});return i?d.jsx("div",{className:"fixed inset-0 z-[100] bg-background-dark/95 backdrop-blur-md p-8 flex flex-col items-center",children:d.jsx("div",{className:"w-full max-w-4xl h-full flex flex-col border border-glass-border rounded-3xl overflow-hidden shadow-2xl bg-surface-dark",children:d.jsx(b,{})})}):d.jsx("div",{className:"h-full border border-glass-border rounded-2xl overflow-hidden",children:d.jsx(b,{})})},rc=({to:t,icon:e,label:r,collapsed:n,end:i})=>d.jsxs(AV,{to:t,end:i,className:({isActive:a})=>`
            flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all group
            ${a?"bg-primary text-white shadow-lg shadow-primary/20":"text-text-muted hover:text-white hover:bg-white/5"}
            ${n?"justify-center":""}
        `,title:n?r:"",children:[d.jsx("span",{className:"material-symbols-outlined text-xl",children:e}),!n&&d.jsx("span",{className:"text-sm font-bold tracking-wide",children:r})]}),PT=t=>{switch(t==null?void 0:t.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},k$=()=>{console.log("ArchitectLayout Mounting");const{username:t,projectName:e,folderSlug:r}=Bi();Li();const n=Jc(),[i,a]=q.useState(!0),[s,o]=q.useState(!1),[l,c]=q.useState("Loading..."),[u,f]=q.useState(null),[h,m]=q.useState("NOTES"),[v,y]=q.useState(""),[x,b]=q.useState([]),[S,w]=q.useState(null),[k,N]=q.useState(null),[j,T]=q.useState({name:"",description:"",type:"regional",showGrid:!0,gridSize:50,width:800,height:600,bgImage:null}),[M,A]=q.useState(null);q.useState("identity");const[_,D]=q.useState("notes"),[R,I]=q.useState(""),[$,B]=q.useState("ALL"),z=n.pathname.includes("/bible"),U=n.pathname.includes("/writing"),[F,Q]=q.useState("index"),[K,L]=q.useState(null),[G,ee]=q.useState([]),[re,se]=q.useState("identity"),[de,W]=q.useState(null),ne=(Z,ue)=>{Z.stopPropagation(),W(ue)},ie=async()=>{if(de){try{await Ne.delete(`/world-bible/templates/${de}`),b(Z=>Z.filter(ue=>ue.id!==de))}catch(Z){console.error("Delete failed",Z)}W(null)}},V=async Z=>{Z.preventDefault();try{await Ne.put(`/world-bible/templates/${K.id}`,K),b(ue=>ue.map(ge=>ge.id===K.id?K:ge)),L(null)}catch(ue){console.error("Update failed",ue)}},Y=`/${t}/${e}`;q.useEffect(()=>{e&&te(e);const Z=()=>{e&&te(e)};return window.addEventListener("focus",Z),()=>window.removeEventListener("focus",Z)},[e]);const te=async Z=>{try{const ue=await Ne.get(`/proyectos/${Z}`);ue&&(c(ue.nombreProyecto),f(ue.id))}catch(ue){console.error("Error loading project:",ue)}};return d.jsxs("div",{className:"flex h-screen w-full overflow-hidden bg-background-dark text-text-main font-sans selection:bg-primary/30",children:[d.jsxs("aside",{className:`
                    flex-none bg-surface-dark border-r border-glass-border transition-all duration-500 relative flex flex-col z-30
                    ${i?"w-80":"w-20"}
                `,children:[d.jsxs("div",{className:"h-16 flex items-center justify-center border-b border-glass-border relative",children:[i?d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"size-8 rounded-lg bg-surface-light flex items-center justify-center text-primary shadow-inner",children:d.jsx("span",{className:"material-symbols-outlined",children:"auto_stories"})}),d.jsx("h2",{className:"text-sm font-black uppercase tracking-widest text-white truncate max-w-[150px]",children:l})]}):d.jsx("button",{onClick:()=>a(!0),className:"size-10 rounded-xl hover:bg-white/5 flex items-center justify-center text-text-muted hover:text-white transition-all",children:d.jsx("span",{className:"material-symbols-outlined",children:"menu"})}),i&&d.jsx("button",{onClick:()=>a(!1),className:"absolute right-4 text-text-muted hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"dock_to_left"})})]}),d.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar flex flex-col",children:d.jsxs("div",{className:"p-3 space-y-1",children:[d.jsx(rc,{to:Y,icon:"home",label:"Dashboard",collapsed:!i,end:!0}),d.jsx(rc,{to:`${Y}/bible`,icon:"menu_book",label:"World Bible",collapsed:!i}),d.jsx(rc,{to:`${Y}/map`,icon:"map",label:"Atlas",collapsed:!i}),d.jsx(rc,{to:`${Y}/timeline`,icon:"calendar_month",label:"Chronology",collapsed:!i}),d.jsx(rc,{to:`${Y}/graph`,icon:"hub",label:"Graph",collapsed:!i}),d.jsx("div",{className:"h-px bg-glass-border my-2 mx-2 opacity-50"}),d.jsx(rc,{to:`${Y}/writing`,icon:"edit_note",label:"Writing",collapsed:!i}),d.jsx(rc,{to:`${Y}/settings`,icon:"settings",label:"Settings",collapsed:!i})]})}),d.jsx("footer",{className:"p-4 border-t border-glass-border",children:d.jsxs("div",{className:`flex items-center gap-3 ${!i&&"justify-center"}`,children:[d.jsx("div",{className:"size-10 rounded-full border border-glass-border p-1 bg-surface-light relative",children:d.jsx("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-primary to-purple-500 flex items-center justify-center text-white font-black text-xs",children:t?t.substring(0,2).toUpperCase():"US"})}),i&&d.jsxs("div",{className:"overflow-hidden",children:[d.jsx("h4",{className:"text-xs font-bold text-white truncate",children:t||"User"}),d.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-tighter",children:"Architect"})]})]})})]}),d.jsxs("main",{className:"flex-1 flex flex-col min-w-0 bg-background-dark relative",children:[d.jsx("div",{className:"h-16 w-full absolute top-0 left-0 bg-gradient-to-b from-background-dark to-transparent pointer-events-none"}),d.jsx("div",{className:"flex-1 flex overflow-hidden relative",children:d.jsx(HC,{context:{setRightPanelMode:m,setRightOpen:o,setRightPanelTitle:y,projectName:l,projectId:u,availableTemplates:x,setAvailableTemplates:b,setAddAttributeHandler:w,setCreateTemplateHandler:N,mapSettings:j,setMapSettings:T,setOnMapSettingsChange:A,entityTabs:G,setEntityTabs:ee,activeEntityTab:re,setActiveEntityTab:se,folderSearchTerm:R,setFolderSearchTerm:I,folderFilterType:$,setFolderFilterType:B}})})]}),d.jsxs("aside",{className:`
                    flex-none bg-surface-dark border-l border-glass-border transition-all duration-500 relative flex flex-col z-30 shrink-0
                    ${s?"w-80":"w-20"}
                `,children:[d.jsx("header",{className:"h-16 flex items-center px-6 border-b border-glass-border justify-between shrink-0",children:s?d.jsxs(d.Fragment,{children:[h==="CUSTOM"&&!U?d.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-primary",children:v||"Panel"}):U?d.jsxs("div",{className:"flex bg-white/5 rounded-lg p-1 gap-1 w-full mr-4",children:[d.jsx("button",{onClick:()=>Q("index"),className:`flex-1 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${F==="index"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"ndice"}),d.jsx("button",{onClick:()=>Q("notes"),className:`flex-1 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${F==="notes"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Notas"})]}):z&&h==="NOTES"?d.jsxs("div",{className:"flex bg-white/5 rounded-lg p-1 gap-1",children:[d.jsx("button",{onClick:()=>D("notes"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${_==="notes"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Notas"}),d.jsx("button",{onClick:()=>D("templates"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${_==="templates"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Plantillas"}),d.jsx("button",{onClick:()=>D("filters"),className:`px-3 py-1 rounded-md text-[10px] uppercase font-bold transition-all ${_==="filters"?"bg-primary text-white shadow":"text-slate-500 hover:text-white"}`,children:"Explorar"})]}):d.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-white",children:v||(h==="NOTES"?"Notas Globales":"Constructor")}),d.jsx("button",{onClick:()=>o(!1),className:"text-text-muted hover:text-white transition-colors shrink-0",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"dock_to_right"})})]}):d.jsx("button",{onClick:()=>o(!0),className:"w-full h-full flex items-center justify-center text-text-muted hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined",children:h==="NOTES"||U?"edit_note":h==="MAP"?"map":h==="CUSTOM"?"build":"handyman"})})}),d.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar p-0",children:s?U?d.jsxs(d.Fragment,{children:[d.jsx("div",{id:"architect-right-panel-portal",className:`h-full relative flex flex-col ${F==="index"?"block":"hidden"}`}),d.jsx("div",{className:`h-full p-4 overflow-hidden ${F==="notes"?"block":"hidden"}`,children:d.jsx(MT,{projectName:e})})]}):h==="CUSTOM"?d.jsx("div",{id:"architect-right-panel-portal",className:"h-full relative flex flex-col"}):h==="NOTES"?_==="templates"&&z?d.jsx("div",{className:"h-full overflow-y-auto no-scrollbar",children:d.jsx(jT,{compact:!0})}):_==="filters"&&z?d.jsxs("div",{className:"h-full p-6 space-y-6 animate-in fade-in slide-in-from-right-4",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Bsqueda"}),d.jsxs("div",{className:"bg-black/20 border border-white/10 rounded-xl p-3 flex items-center gap-2 focus-within:border-primary transition-colors",children:[d.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"search"}),d.jsx("input",{value:R,onChange:Z=>I(Z.target.value),placeholder:"Buscar entidad...",className:"bg-transparent border-none outline-none text-sm text-white w-full placeholder-slate-600"}),R&&d.jsx("button",{onClick:()=>I(""),className:"text-slate-500 hover:text-white",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]})]}),d.jsx("div",{className:"h-px bg-glass-border"}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Filtrar por Tipo"}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"ALL",label:"Todos",icon:"grid_view"},{id:"ENTITY",label:"Entidades",icon:"person"},{id:"MAP",label:"Mapas",icon:"map"},{id:"TIMELINE",label:"Timelines",icon:"timeline"}].map(Z=>d.jsxs("button",{onClick:()=>B(Z.id),className:`
                                                        p-3 rounded-xl border flex flex-col items-center gap-2 transition-all
                                                        ${$===Z.id?"bg-primary text-white border-primary shadow-lg shadow-primary/20":"bg-white/5 border-transparent text-slate-500 hover:bg-white/10 hover:text-white"}
                                                    `,children:[d.jsx("span",{className:"material-symbols-outlined",children:Z.icon}),d.jsx("span",{className:"text-[10px] font-bold uppercase",children:Z.label})]},Z.id))})]})]}):d.jsx("div",{className:"h-full p-4 overflow-hidden",children:d.jsx(MT,{projectName:e})}):h==="MAP"?d.jsxs("div",{className:"p-6 space-y-8 animate-in fade-in slide-in-from-right-4",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Grid System"}),d.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:j.showGrid,onChange:Z=>{const ue={...j,showGrid:Z.target.checked};T(ue),M&&M(ue)},className:"sr-only peer"}),d.jsx("div",{className:"w-9 h-5 bg-white/10 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-primary"})]})]}),d.jsxs("div",{className:`space-y-2 transition-opacity ${j.showGrid?"opacity-100":"opacity-30 pointer-events-none"}`,children:[d.jsxs("div",{className:"flex justify-between text-xs font-bold text-white",children:[d.jsx("span",{children:"Size"}),d.jsxs("span",{className:"font-mono text-primary",children:[j.gridSize,"px"]})]}),d.jsx("input",{type:"range",min:"10",max:"200",step:"10",value:j.gridSize,onChange:Z=>{const ue={...j,gridSize:parseInt(Z.target.value)};T(ue),M&&M(ue)},className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-primary"})]})]}),d.jsx("div",{className:"h-px bg-glass-border"}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-xs font-black uppercase tracking-widest text-text-muted",children:"Canvas Data"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Width (px)"}),d.jsx("input",{type:"number",value:j.width,onChange:Z=>{const ue={...j,width:parseInt(Z.target.value)};T(ue),M&&M(ue)},className:"w-full bg-black/20 border border-white/10 rounded-lg p-2 text-white text-right font-mono text-sm focus:border-primary outline-none"})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500",children:"Height (px)"}),d.jsx("input",{type:"number",value:j.height,onChange:Z=>{const ue={...j,height:parseInt(Z.target.value)};T(ue),M&&M(ue)},className:"w-full bg-black/20 border border-white/10 rounded-lg p-2 text-white text-right font-mono text-sm focus:border-primary outline-none"})]})]})]})]}):h==="ENTITY"?d.jsxs("div",{className:"flex flex-col h-full animate-in fade-in slide-in-from-right-4",children:[d.jsx("div",{className:"p-4 border-b border-glass-border",children:d.jsx("div",{className:"bg-black/40 p-1 rounded-xl flex",children:G.map(Z=>{const ue=ge=>{switch(ge.toLowerCase()){case"identity":return"badge";case"narrative":return"auto_stories";case"attributes":return"tune";case"notes":return"edit_note";default:return"circle"}};return d.jsxs("button",{onClick:()=>se(Z),className:`
                                                        flex-1 py-2 rounded-lg transition-all group relative flex items-center justify-center
                                                        ${re===Z?"bg-primary text-white shadow-lg":"text-text-muted hover:text-white hover:bg-white/5"}
                                                    `,title:Z,children:[d.jsx("span",{className:"material-symbols-outlined text-lg",children:ue(Z)}),d.jsx("span",{className:"absolute -bottom-8 left-1/2 -translate-x-1/2 bg-black/90 text-white text-[10px] uppercase font-bold px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50",children:Z})]},Z)})})}),re==="attributes"&&d.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col bg-black/20",children:[d.jsxs("div",{className:"px-6 py-4 text-[10px] font-black uppercase text-slate-500 tracking-widest flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"drag_indicator"})," Drag Attributes"]}),d.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar px-2",children:d.jsx(jT,{compact:!0,initialFolderSlug:r})})]})]}):h==="TOOLBOX"?d.jsx("div",{className:"p-4 space-y-6",children:d.jsxs("div",{className:"space-y-3",children:[d.jsxs("h3",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted px-2 flex justify-between items-center",children:[d.jsx("span",{children:"Plantillas Disponibles"}),d.jsx("button",{className:"text-primary hover:text-white transition-colors",title:"Crear Nueva Plantilla",onClick:()=>k&&k(),children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})]}),x.length===0?d.jsx("div",{className:"p-6 text-center border border-dashed border-glass-border rounded-2xl opacity-30",children:d.jsx("p",{className:"text-[10px] uppercase font-bold",children:"Sin Plantillas"})}):x.map(Z=>d.jsxs("button",{className:"w-full flex items-center gap-3 p-3 rounded-2xl bg-white/5 border border-glass-border hover:border-primary/50 hover:bg-primary/5 transition-all text-left group relative",draggable:!0,onDragStart:ue=>{ue.dataTransfer.setData("application/reactflow/type","attribute"),ue.dataTransfer.setData("templateId",Z.id),ue.dataTransfer.effectAllowed="move"},onClick:()=>S&&S(Z.id),children:[Z.global&&d.jsx("span",{className:"absolute top-2 right-2 flex size-2 bg-blue-500 rounded-full shadow-lg shadow-blue-500/50",title:"Global"}),d.jsx("div",{className:"size-8 rounded-lg bg-surface-light flex items-center justify-center text-primary group-hover:scale-110 transition-transform",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:PT(Z.tipo)})}),d.jsxs("div",{className:"overflow-hidden",children:[d.jsx("p",{className:"text-xs font-bold text-white truncate",children:Z.nombre}),d.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-tighter",children:Z.tipo})]}),d.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[d.jsx("div",{onClick:ue=>{ue.stopPropagation(),L(Z)},className:"p-1 hover:text-white text-text-muted hover:bg-white/10 rounded cursor-pointer",title:"Edit",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),d.jsx("div",{onClick:ue=>ne(ue,Z.id),className:"p-1 hover:text-red-400 text-text-muted hover:bg-white/10 rounded cursor-pointer",title:"Delete",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]},Z.id))]})}):d.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-text-muted opacity-50",children:[d.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"dashboard"}),d.jsx("p",{className:"text-xs uppercase font-bold tracking-widest",children:"Select an item"})]}):d.jsx("div",{className:"flex flex-col items-center gap-4 py-4 w-full",children:h==="NOTES"||U?d.jsx("button",{onClick:()=>o(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Notas Globales",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"edit_note"})}):h==="MAP"?d.jsx("button",{onClick:()=>o(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Ajustes de Mapa",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"tune"})}):h==="ENTITY"?d.jsx("button",{onClick:()=>o(!0),className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white",title:"Atributos",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"fact_check"})}):h==="CUSTOM"?d.jsx("button",{onClick:()=>o(!0),className:"size-10 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center text-primary hover:bg-primary/20 transition-all",title:v||"Panel",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"extension"})}):x.slice(0,5).map(Z=>d.jsxs("button",{className:"size-10 rounded-xl bg-white/5 flex items-center justify-center text-text-muted hover:text-white hover:bg-primary/20 transition-all relative",draggable:!0,onDragStart:ue=>{ue.dataTransfer.setData("application/reactflow/type","attribute"),ue.dataTransfer.setData("templateId",Z.id)},title:Z.nombre,children:[Z.global&&d.jsx("span",{className:"absolute top-0 right-0 size-2 bg-blue-500 rounded-full border border-surface-dark"}),d.jsx("span",{className:"material-symbols-outlined text-lg",children:PT(Z.tipo)})]},Z.id))})})]}),K&&d.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-surface-dark border border-glass-border rounded-2xl p-6 w-full max-w-md shadow-2xl animate-scale-in",children:[d.jsx("h3",{className:"text-xl font-black text-white mb-4",children:"Editar Plantilla"}),d.jsxs("form",{onSubmit:V,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs uppercase font-bold text-text-muted block mb-1",children:"Nombre"}),d.jsx("input",{autoFocus:!0,className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none",value:K.nombre,onChange:Z=>L({...K,nombre:Z.target.value}),required:!0})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs uppercase font-bold text-text-muted block mb-1",children:"Tipo"}),d.jsxs("select",{className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-white focus:border-primary outline-none",value:K.tipo,onChange:Z=>L({...K,tipo:Z.target.value}),children:[d.jsx("option",{value:"text",children:"Texto Largo"}),d.jsx("option",{value:"short_text",children:"Texto Corto"}),d.jsx("option",{value:"number",children:"Nmero"}),d.jsx("option",{value:"boolean",children:"Si/No"}),d.jsx("option",{value:"date",children:"Fecha"}),d.jsx("option",{value:"entity_link",children:"Vnculo Entidad"}),d.jsx("option",{value:"image",children:"Imagen URL"})]})]}),d.jsx("div",{className:"flex items-center",children:d.jsxs("label",{className:"flex items-center gap-2 cursor-pointer p-3 bg-white/5 rounded-xl w-full hover:bg-white/10 transition-colors",children:[d.jsx("input",{type:"checkbox",checked:K.global,onChange:Z=>L({...K,global:Z.target.checked}),className:"accent-primary size-4"}),d.jsx("span",{className:"text-sm font-bold text-white",children:"Es Global?"})]})})]}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[d.jsx("button",{type:"button",onClick:()=>L(null),className:"px-4 py-2 text-text-muted hover:text-white font-bold transition-colors",children:"Cancelar"}),d.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary text-white rounded-xl font-bold shadow-lg shadow-primary/20 hover:scale-105 transition-transform",children:"Guardar"})]})]})]})}),d.jsx(Qp,{isOpen:!!de,onClose:()=>W(null),onConfirm:ie,title:"Eliminar Plantilla",message:"Ests seguro de que quieres eliminar esta plantilla? Esta accin no se puede deshacer.",confirmText:"Eliminar",type:"danger"})]})};var PA={exports:{}},C$="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",N$=C$,E$=N$;function _A(){}function AA(){}AA.resetWarningCache=_A;var T$=function(){function t(n,i,a,s,o,l){if(l!==E$){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:AA,resetWarningCache:_A};return r.PropTypes=r,r};PA.exports=T$();var j$=PA.exports;const M$=Gp(j$);function I5(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function P$(t){if(Array.isArray(t))return t}function _$(t){if(Array.isArray(t))return I5(t)}function Ml(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A$(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,DA(n.key),n)}}function Pl(t,e,r){return e&&A$(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function vi(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=KC(t))||e){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,s=!0,o=!1;return{s:function(){r=r.call(t)},n:function(){var l=r.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{s||r.return==null||r.return()}finally{if(o)throw a}}}}function RA(t,e,r){return(e=DA(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R$(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function D$(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,i,a,s,o=[],l=!0,c=!1;try{if(a=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function O$(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zr(t,e){return P$(t)||D$(t,e)||KC(t,e)||O$()}function w0(t){return _$(t)||R$(t)||KC(t)||I$()}function L$(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function DA(t){var e=L$(t,"string");return typeof e=="symbol"?e:e+""}function Zr(t){"@babel/helpers - typeof";return Zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(t)}function KC(t,e){if(t){if(typeof t=="string")return I5(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I5(t,e):void 0}}var Yr=typeof window>"u"?null:window,_T=Yr?Yr.navigator:null;Yr&&Yr.document;var B$=Zr(""),OA=Zr({}),F$=Zr(function(){}),z$=typeof HTMLElement>"u"?"undefined":Zr(HTMLElement),Jp=function(e){return e&&e.instanceString&&vr(e.instanceString)?e.instanceString():null},Ke=function(e){return e!=null&&Zr(e)==B$},vr=function(e){return e!=null&&Zr(e)===F$},Ht=function(e){return!Ai(e)&&(Array.isArray?Array.isArray(e):e!=null&&e instanceof Array)},Mt=function(e){return e!=null&&Zr(e)===OA&&!Ht(e)&&e.constructor===Object},V$=function(e){return e!=null&&Zr(e)===OA},Ee=function(e){return e!=null&&Zr(e)===Zr(1)&&!isNaN(e)},$$=function(e){return Ee(e)&&Math.floor(e)===e},S0=function(e){if(z$!=="undefined")return e!=null&&e instanceof HTMLElement},Ai=function(e){return Zp(e)||IA(e)},Zp=function(e){return Jp(e)==="collection"&&e._private.single},IA=function(e){return Jp(e)==="collection"&&!e._private.single},YC=function(e){return Jp(e)==="core"},LA=function(e){return Jp(e)==="stylesheet"},U$=function(e){return Jp(e)==="event"},ml=function(e){return e==null?!0:!!(e===""||e.match(/^\s+$/))},G$=function(e){return typeof HTMLElement>"u"?!1:e instanceof HTMLElement},H$=function(e){return Mt(e)&&Ee(e.x1)&&Ee(e.x2)&&Ee(e.y1)&&Ee(e.y2)},W$=function(e){return V$(e)&&vr(e.then)},q$=function(){return _T&&_T.userAgent.match(/msie|trident|edge/i)},Rd=function(e,r){r||(r=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var a=[],s=0;s<arguments.length;s++)a.push(arguments[s]);return a.join("$")});var n=function(){var a=this,s=arguments,o,l=r.apply(a,s),c=n.cache;return(o=c[l])||(o=c[l]=e.apply(a,s)),o};return n.cache={},n},XC=Rd(function(t){return t.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}),Qy=Rd(function(t){return t.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})}),BA=Rd(function(t,e){return t+e[0].toUpperCase()+e.substring(1)},function(t,e){return t+"$"+e}),AT=function(e){return ml(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},Wo=function(e,r){return e.slice(-1*r.length)===r},Jr="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",K$="rgb[a]?\\(("+Jr+"[%]?)\\s*,\\s*("+Jr+"[%]?)\\s*,\\s*("+Jr+"[%]?)(?:\\s*,\\s*("+Jr+"))?\\)",Y$="rgb[a]?\\((?:"+Jr+"[%]?)\\s*,\\s*(?:"+Jr+"[%]?)\\s*,\\s*(?:"+Jr+"[%]?)(?:\\s*,\\s*(?:"+Jr+"))?\\)",X$="hsl[a]?\\(("+Jr+")\\s*,\\s*("+Jr+"[%])\\s*,\\s*("+Jr+"[%])(?:\\s*,\\s*("+Jr+"))?\\)",Q$="hsl[a]?\\((?:"+Jr+")\\s*,\\s*(?:"+Jr+"[%])\\s*,\\s*(?:"+Jr+"[%])(?:\\s*,\\s*(?:"+Jr+"))?\\)",J$="\\#[0-9a-fA-F]{3}",Z$="\\#[0-9a-fA-F]{6}",FA=function(e,r){return e<r?-1:e>r?1:0},eU=function(e,r){return-1*FA(e,r)},Qe=Object.assign!=null?Object.assign.bind(Object):function(t){for(var e=arguments,r=1;r<e.length;r++){var n=e[r];if(n!=null)for(var i=Object.keys(n),a=0;a<i.length;a++){var s=i[a];t[s]=n[s]}}return t},tU=function(e){if(!(!(e.length===4||e.length===7)||e[0]!=="#")){var r=e.length===4,n,i,a,s=16;return r?(n=parseInt(e[1]+e[1],s),i=parseInt(e[2]+e[2],s),a=parseInt(e[3]+e[3],s)):(n=parseInt(e[1]+e[2],s),i=parseInt(e[3]+e[4],s),a=parseInt(e[5]+e[6],s)),[n,i,a]}},rU=function(e){var r,n,i,a,s,o,l,c;function u(v,y,x){return x<0&&(x+=1),x>1&&(x-=1),x<1/6?v+(y-v)*6*x:x<1/2?y:x<2/3?v+(y-v)*(2/3-x)*6:v}var f=new RegExp("^"+X$+"$").exec(e);if(f){if(n=parseInt(f[1]),n<0?n=(360- -1*n%360)%360:n>360&&(n=n%360),n/=360,i=parseFloat(f[2]),i<0||i>100||(i=i/100,a=parseFloat(f[3]),a<0||a>100)||(a=a/100,s=f[4],s!==void 0&&(s=parseFloat(s),s<0||s>1)))return;if(i===0)o=l=c=Math.round(a*255);else{var h=a<.5?a*(1+i):a+i-a*i,m=2*a-h;o=Math.round(255*u(m,h,n+1/3)),l=Math.round(255*u(m,h,n)),c=Math.round(255*u(m,h,n-1/3))}r=[o,l,c,s]}return r},nU=function(e){var r,n=new RegExp("^"+K$+"$").exec(e);if(n){r=[];for(var i=[],a=1;a<=3;a++){var s=n[a];if(s[s.length-1]==="%"&&(i[a]=!0),s=parseFloat(s),i[a]&&(s=s/100*255),s<0||s>255)return;r.push(Math.floor(s))}var o=i[1]||i[2]||i[3],l=i[1]&&i[2]&&i[3];if(o&&!l)return;var c=n[4];if(c!==void 0){if(c=parseFloat(c),c<0||c>1)return;r.push(c)}}return r},iU=function(e){return aU[e.toLowerCase()]},zA=function(e){return(Ht(e)?e:null)||iU(e)||tU(e)||nU(e)||rU(e)},aU={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},VA=function(e){for(var r=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var s=n[a];if(Mt(s))throw Error("Tried to set map with object key");a<n.length-1?(r[s]==null&&(r[s]={}),r=r[s]):r[s]=e.value}},$A=function(e){for(var r=e.map,n=e.keys,i=n.length,a=0;a<i;a++){var s=n[a];if(Mt(s))throw Error("Tried to get map with object key");if(r=r[s],r==null)return r}return r},_g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function em(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var fw,RT;function tm(){if(RT)return fw;RT=1;function t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}return fw=t,fw}var hw,DT;function sU(){if(DT)return hw;DT=1;var t=typeof _g=="object"&&_g&&_g.Object===Object&&_g;return hw=t,hw}var pw,OT;function Jy(){if(OT)return pw;OT=1;var t=sU(),e=typeof self=="object"&&self&&self.Object===Object&&self,r=t||e||Function("return this")();return pw=r,pw}var mw,IT;function oU(){if(IT)return mw;IT=1;var t=Jy(),e=function(){return t.Date.now()};return mw=e,mw}var gw,LT;function lU(){if(LT)return gw;LT=1;var t=/\s/;function e(r){for(var n=r.length;n--&&t.test(r.charAt(n)););return n}return gw=e,gw}var vw,BT;function cU(){if(BT)return vw;BT=1;var t=lU(),e=/^\s+/;function r(n){return n&&n.slice(0,t(n)+1).replace(e,"")}return vw=r,vw}var yw,FT;function QC(){if(FT)return yw;FT=1;var t=Jy(),e=t.Symbol;return yw=e,yw}var xw,zT;function uU(){if(zT)return xw;zT=1;var t=QC(),e=Object.prototype,r=e.hasOwnProperty,n=e.toString,i=t?t.toStringTag:void 0;function a(s){var o=r.call(s,i),l=s[i];try{s[i]=void 0;var c=!0}catch{}var u=n.call(s);return c&&(o?s[i]=l:delete s[i]),u}return xw=a,xw}var bw,VT;function dU(){if(VT)return bw;VT=1;var t=Object.prototype,e=t.toString;function r(n){return e.call(n)}return bw=r,bw}var ww,$T;function UA(){if($T)return ww;$T=1;var t=QC(),e=uU(),r=dU(),n="[object Null]",i="[object Undefined]",a=t?t.toStringTag:void 0;function s(o){return o==null?o===void 0?i:n:a&&a in Object(o)?e(o):r(o)}return ww=s,ww}var Sw,UT;function fU(){if(UT)return Sw;UT=1;function t(e){return e!=null&&typeof e=="object"}return Sw=t,Sw}var kw,GT;function rm(){if(GT)return kw;GT=1;var t=UA(),e=fU(),r="[object Symbol]";function n(i){return typeof i=="symbol"||e(i)&&t(i)==r}return kw=n,kw}var Cw,HT;function hU(){if(HT)return Cw;HT=1;var t=cU(),e=tm(),r=rm(),n=0/0,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;function l(c){if(typeof c=="number")return c;if(r(c))return n;if(e(c)){var u=typeof c.valueOf=="function"?c.valueOf():c;c=e(u)?u+"":u}if(typeof c!="string")return c===0?c:+c;c=t(c);var f=a.test(c);return f||s.test(c)?o(c.slice(2),f?2:8):i.test(c)?n:+c}return Cw=l,Cw}var Nw,WT;function pU(){if(WT)return Nw;WT=1;var t=tm(),e=oU(),r=hU(),n="Expected a function",i=Math.max,a=Math.min;function s(o,l,c){var u,f,h,m,v,y,x=0,b=!1,S=!1,w=!0;if(typeof o!="function")throw new TypeError(n);l=r(l)||0,t(c)&&(b=!!c.leading,S="maxWait"in c,h=S?i(r(c.maxWait)||0,l):h,w="trailing"in c?!!c.trailing:w);function k(I){var $=u,B=f;return u=f=void 0,x=I,m=o.apply(B,$),m}function N(I){return x=I,v=setTimeout(M,l),b?k(I):m}function j(I){var $=I-y,B=I-x,z=l-$;return S?a(z,h-B):z}function T(I){var $=I-y,B=I-x;return y===void 0||$>=l||$<0||S&&B>=h}function M(){var I=e();if(T(I))return A(I);v=setTimeout(M,j(I))}function A(I){return v=void 0,w&&u?k(I):(u=f=void 0,m)}function _(){v!==void 0&&clearTimeout(v),x=0,u=y=f=v=void 0}function D(){return v===void 0?m:A(e())}function R(){var I=e(),$=T(I);if(u=arguments,f=this,y=I,$){if(v===void 0)return N(y);if(S)return clearTimeout(v),v=setTimeout(M,l),k(y)}return v===void 0&&(v=setTimeout(M,l)),m}return R.cancel=_,R.flush=D,R}return Nw=s,Nw}var mU=pU(),nm=em(mU),Ew=Yr?Yr.performance:null,GA=Ew&&Ew.now?function(){return Ew.now()}:function(){return Date.now()},gU=function(){if(Yr){if(Yr.requestAnimationFrame)return function(t){Yr.requestAnimationFrame(t)};if(Yr.mozRequestAnimationFrame)return function(t){Yr.mozRequestAnimationFrame(t)};if(Yr.webkitRequestAnimationFrame)return function(t){Yr.webkitRequestAnimationFrame(t)};if(Yr.msRequestAnimationFrame)return function(t){Yr.msRequestAnimationFrame(t)}}return function(t){t&&setTimeout(function(){t(GA())},1e3/60)}}(),k0=function(e){return gU(e)},eo=GA,fc=9261,HA=65599,$u=5381,WA=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fc,n=r,i;i=e.next(),!i.done;)n=n*HA+i.value|0;return n},yp=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fc;return r*HA+e|0},xp=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$u;return(r<<5)+r+e|0},vU=function(e,r){return e*2097152+r},To=function(e){return e[0]*2097152+e[1]},Ag=function(e,r){return[yp(e[0],r[0]),xp(e[1],r[1])]},qT=function(e,r){var n={value:0,done:!1},i=0,a=e.length,s={next:function(){return i<a?n.value=e[i++]:n.done=!0,n}};return WA(s,r)},Bc=function(e,r){var n={value:0,done:!1},i=0,a=e.length,s={next:function(){return i<a?n.value=e.charCodeAt(i++):n.done=!0,n}};return WA(s,r)},qA=function(){return yU(arguments)},yU=function(e){for(var r,n=0;n<e.length;n++){var i=e[n];n===0?r=Bc(i):r=Bc(i,r)}return r};function xU(t,e,r,n,i){var a=i*Math.PI/180,s=Math.cos(a)*(t-r)-Math.sin(a)*(e-n)+r,o=Math.sin(a)*(t-r)+Math.cos(a)*(e-n)+n;return{x:s,y:o}}var bU=function(e,r,n,i,a,s){return{x:(e-n)*a+n,y:(r-i)*s+i}};function wU(t,e,r){if(r===0)return t;var n=(e.x1+e.x2)/2,i=(e.y1+e.y2)/2,a=e.w/e.h,s=1/a,o=xU(t.x,t.y,n,i,r),l=bU(o.x,o.y,n,i,a,s);return{x:l.x,y:l.y}}var KT=!0,SU=console.warn!=null,kU=console.trace!=null,JC=Number.MAX_SAFE_INTEGER||9007199254740991,KA=function(){return!0},C0=function(){return!1},YT=function(){return 0},ZC=function(){},lr=function(e){throw new Error(e)},YA=function(e){if(e!==void 0)KT=!!e;else return KT},Lt=function(e){YA()&&(SU?console.warn(e):(console.log(e),kU&&console.trace()))},CU=function(e){return Qe({},e)},ss=function(e){return e==null?e:Ht(e)?e.slice():Mt(e)?CU(e):e},NU=function(e){return e.slice()},XA=function(e,r){for(r=e="";e++<36;r+=e*51&52?(e^15?8^Math.random()*(e^20?16:4):4).toString(16):"-");return r},EU={},QA=function(){return EU},Pn=function(e){var r=Object.keys(e);return function(n){for(var i={},a=0;a<r.length;a++){var s=r[a],o=n==null?void 0:n[s];i[s]=o===void 0?e[s]:o}return i}},gl=function(e,r,n){for(var i=e.length-1;i>=0;i--)e[i]===r&&e.splice(i,1)},e3=function(e){e.splice(0,e.length)},TU=function(e,r){for(var n=0;n<r.length;n++){var i=r[n];e.push(i)}},hi=function(e,r,n){return n&&(r=BA(n,r)),e[r]},Vs=function(e,r,n,i){n&&(r=BA(n,r)),e[r]=i},jU=function(){function t(){Ml(this,t),this._obj={}}return Pl(t,[{key:"set",value:function(r,n){return this._obj[r]=n,this}},{key:"delete",value:function(r){return this._obj[r]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(r){return this._obj[r]!==void 0}},{key:"get",value:function(r){return this._obj[r]}}])}(),Gs=typeof Map<"u"?Map:jU,MU="undefined",PU=function(){function t(e){if(Ml(this,t),this._obj=Object.create(null),this.size=0,e!=null){var r;e.instanceString!=null&&e.instanceString()===this.instanceString()?r=e.toArray():r=e;for(var n=0;n<r.length;n++)this.add(r[n])}}return Pl(t,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(r){var n=this._obj;n[r]!==1&&(n[r]=1,this.size++)}},{key:"delete",value:function(r){var n=this._obj;n[r]===1&&(n[r]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(r){return this._obj[r]===1}},{key:"toArray",value:function(){var r=this;return Object.keys(this._obj).filter(function(n){return r.has(n)})}},{key:"forEach",value:function(r,n){return this.toArray().forEach(r,n)}}])}(),rf=(typeof Set>"u"?"undefined":Zr(Set))!==MU?Set:PU,Zy=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(e===void 0||r===void 0||!YC(e)){lr("An element must have a core reference and parameters set");return}var i=r.group;if(i==null&&(r.data&&r.data.source!=null&&r.data.target!=null?i="edges":i="nodes"),i!=="nodes"&&i!=="edges"){lr("An element must be of type `nodes` or `edges`; you specified `"+i+"`");return}this.length=1,this[0]=this;var a=this._private={cy:e,single:!0,data:r.data||{},position:r.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!r.selected,selectable:r.selectable===void 0?!0:!!r.selectable,locked:!!r.locked,grabbed:!1,grabbable:r.grabbable===void 0?!0:!!r.grabbable,pannable:r.pannable===void 0?i==="edges":!!r.pannable,active:!1,classes:new rf,animation:{current:[],queue:[]},rscratch:{},scratch:r.scratch||{},edges:[],children:[],parent:r.parent&&r.parent.isNode()?r.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(a.position.x==null&&(a.position.x=0),a.position.y==null&&(a.position.y=0),r.renderedPosition){var s=r.renderedPosition,o=e.pan(),l=e.zoom();a.position={x:(s.x-o.x)/l,y:(s.y-o.y)/l}}var c=[];Ht(r.classes)?c=r.classes:Ke(r.classes)&&(c=r.classes.split(/\s+/));for(var u=0,f=c.length;u<f;u++){var h=c[u];!h||h===""||a.classes.add(h)}this.createEmitter(),(n===void 0||n)&&this.restore();var m=r.style||r.css;m&&(Lt("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(m))},XT=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(n,i,a){var s;Mt(n)&&!Ai(n)&&(s=n,n=s.roots||s.root,i=s.visit,a=s.directed),a=arguments.length===2&&!vr(i)?i:a,i=vr(i)?i:function(){};for(var o=this._private.cy,l=n=Ke(n)?this.filter(n):n,c=[],u=[],f={},h={},m={},v=0,y,x=this.byGroup(),b=x.nodes,S=x.edges,w=0;w<l.length;w++){var k=l[w],N=k.id();k.isNode()&&(c.unshift(k),e.bfs&&(m[N]=!0,u.push(k)),h[N]=0)}for(var j=function(){var I=e.bfs?c.shift():c.pop(),$=I.id();if(e.dfs){if(m[$])return 0;m[$]=!0,u.push(I)}var B=h[$],z=f[$],U=z!=null?z.source():null,F=z!=null?z.target():null,Q=z==null?void 0:I.same(U)?F[0]:U[0],K;if(K=i(I,z,Q,v++,B),K===!0)return y=I,1;if(K===!1)return 1;for(var L=I.connectedEdges().filter(function(de){return(!a||de.source().same(I))&&S.has(de)}),G=0;G<L.length;G++){var ee=L[G],re=ee.connectedNodes().filter(function(de){return!de.same(I)&&b.has(de)}),se=re.id();re.length!==0&&!m[se]&&(re=re[0],c.push(re),e.bfs&&(m[se]=!0,u.push(re)),f[se]=ee,h[se]=h[$]+1)}},T;c.length!==0&&(T=j(),!(T!==0&&T===1)););for(var M=o.collection(),A=0;A<u.length;A++){var _=u[A],D=f[_.id()];D!=null&&M.push(D),M.push(_)}return{path:o.collection(M),found:o.collection(y)}}},bp={breadthFirstSearch:XT({bfs:!0}),depthFirstSearch:XT({dfs:!0})};bp.bfs=bp.breadthFirstSearch;bp.dfs=bp.depthFirstSearch;var Tv={exports:{}},_U=Tv.exports,QT;function AU(){return QT||(QT=1,function(t,e){(function(){var r,n,i,a,s,o,l,c,u,f,h,m,v,y,x;i=Math.floor,f=Math.min,n=function(b,S){return b<S?-1:b>S?1:0},u=function(b,S,w,k,N){var j;if(w==null&&(w=0),N==null&&(N=n),w<0)throw new Error("lo must be non-negative");for(k==null&&(k=b.length);w<k;)j=i((w+k)/2),N(S,b[j])<0?k=j:w=j+1;return[].splice.apply(b,[w,w-w].concat(S)),S},o=function(b,S,w){return w==null&&(w=n),b.push(S),y(b,0,b.length-1,w)},s=function(b,S){var w,k;return S==null&&(S=n),w=b.pop(),b.length?(k=b[0],b[0]=w,x(b,0,S)):k=w,k},c=function(b,S,w){var k;return w==null&&(w=n),k=b[0],b[0]=S,x(b,0,w),k},l=function(b,S,w){var k;return w==null&&(w=n),b.length&&w(b[0],S)<0&&(k=[b[0],S],S=k[0],b[0]=k[1],x(b,0,w)),S},a=function(b,S){var w,k,N,j,T,M;for(S==null&&(S=n),j=(function(){M=[];for(var A=0,_=i(b.length/2);0<=_?A<_:A>_;0<=_?A++:A--)M.push(A);return M}).apply(this).reverse(),T=[],k=0,N=j.length;k<N;k++)w=j[k],T.push(x(b,w,S));return T},v=function(b,S,w){var k;if(w==null&&(w=n),k=b.indexOf(S),k!==-1)return y(b,0,k,w),x(b,k,w)},h=function(b,S,w){var k,N,j,T,M;if(w==null&&(w=n),N=b.slice(0,S),!N.length)return N;for(a(N,w),M=b.slice(S),j=0,T=M.length;j<T;j++)k=M[j],l(N,k,w);return N.sort(w).reverse()},m=function(b,S,w){var k,N,j,T,M,A,_,D,R;if(w==null&&(w=n),S*10<=b.length){if(j=b.slice(0,S).sort(w),!j.length)return j;for(N=j[j.length-1],_=b.slice(S),T=0,A=_.length;T<A;T++)k=_[T],w(k,N)<0&&(u(j,k,0,null,w),j.pop(),N=j[j.length-1]);return j}for(a(b,w),R=[],M=0,D=f(S,b.length);0<=D?M<D:M>D;0<=D?++M:--M)R.push(s(b,w));return R},y=function(b,S,w,k){var N,j,T;for(k==null&&(k=n),N=b[w];w>S;){if(T=w-1>>1,j=b[T],k(N,j)<0){b[w]=j,w=T;continue}break}return b[w]=N},x=function(b,S,w){var k,N,j,T,M;for(w==null&&(w=n),N=b.length,M=S,j=b[S],k=2*S+1;k<N;)T=k+1,T<N&&!(w(b[k],b[T])<0)&&(k=T),b[S]=b[k],S=k,k=2*S+1;return b[S]=j,y(b,M,S,w)},r=function(){b.push=o,b.pop=s,b.replace=c,b.pushpop=l,b.heapify=a,b.updateItem=v,b.nlargest=h,b.nsmallest=m;function b(S){this.cmp=S??n,this.nodes=[]}return b.prototype.push=function(S){return o(this.nodes,S,this.cmp)},b.prototype.pop=function(){return s(this.nodes,this.cmp)},b.prototype.peek=function(){return this.nodes[0]},b.prototype.contains=function(S){return this.nodes.indexOf(S)!==-1},b.prototype.replace=function(S){return c(this.nodes,S,this.cmp)},b.prototype.pushpop=function(S){return l(this.nodes,S,this.cmp)},b.prototype.heapify=function(){return a(this.nodes,this.cmp)},b.prototype.updateItem=function(S){return v(this.nodes,S,this.cmp)},b.prototype.clear=function(){return this.nodes=[]},b.prototype.empty=function(){return this.nodes.length===0},b.prototype.size=function(){return this.nodes.length},b.prototype.clone=function(){var S;return S=new b,S.nodes=this.nodes.slice(0),S},b.prototype.toArray=function(){return this.nodes.slice(0)},b.prototype.insert=b.prototype.push,b.prototype.top=b.prototype.peek,b.prototype.front=b.prototype.peek,b.prototype.has=b.prototype.contains,b.prototype.copy=b.prototype.clone,b}(),function(b,S){return t.exports=S()}(this,function(){return r})}).call(_U)}(Tv)),Tv.exports}var Tw,JT;function RU(){return JT||(JT=1,Tw=AU()),Tw}var DU=RU(),im=em(DU),OU=Pn({root:null,weight:function(e){return 1},directed:!1}),IU={dijkstra:function(e){if(!Mt(e)){var r=arguments;e={root:r[0],weight:r[1],directed:r[2]}}var n=OU(e),i=n.root,a=n.weight,s=n.directed,o=this,l=a,c=Ke(i)?this.filter(i)[0]:i[0],u={},f={},h={},m=this.byGroup(),v=m.nodes,y=m.edges;y.unmergeBy(function(B){return B.isLoop()});for(var x=function(z){return u[z.id()]},b=function(z,U){u[z.id()]=U,S.updateItem(z)},S=new im(function(B,z){return x(B)-x(z)}),w=0;w<v.length;w++){var k=v[w];u[k.id()]=k.same(c)?0:1/0,S.push(k)}for(var N=function(z,U){for(var F=(s?z.edgesTo(U):z.edgesWith(U)).intersect(y),Q=1/0,K,L=0;L<F.length;L++){var G=F[L],ee=l(G);(ee<Q||!K)&&(Q=ee,K=G)}return{edge:K,dist:Q}};S.size()>0;){var j=S.pop(),T=x(j),M=j.id();if(h[M]=T,T!==1/0)for(var A=j.neighborhood().intersect(v),_=0;_<A.length;_++){var D=A[_],R=D.id(),I=N(j,D),$=T+I.dist;$<x(D)&&(b(D,$),f[R]={node:j,edge:I.edge})}}return{distanceTo:function(z){var U=Ke(z)?v.filter(z)[0]:z[0];return h[U.id()]},pathTo:function(z){var U=Ke(z)?v.filter(z)[0]:z[0],F=[],Q=U,K=Q.id();if(U.length>0)for(F.unshift(U);f[K];){var L=f[K];F.unshift(L.edge),F.unshift(L.node),Q=L.node,K=Q.id()}return o.spawn(F)}}}},LU={kruskal:function(e){e=e||function(w){return 1};for(var r=this.byGroup(),n=r.nodes,i=r.edges,a=n.length,s=new Array(a),o=n,l=function(k){for(var N=0;N<s.length;N++){var j=s[N];if(j.has(k))return N}},c=0;c<a;c++)s[c]=this.spawn(n[c]);for(var u=i.sort(function(w,k){return e(w)-e(k)}),f=0;f<u.length;f++){var h=u[f],m=h.source()[0],v=h.target()[0],y=l(m),x=l(v),b=s[y],S=s[x];y!==x&&(o.merge(h),b.merge(S),s.splice(x,1))}return o}},BU=Pn({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),FU={aStar:function(e){var r=this.cy(),n=BU(e),i=n.root,a=n.goal,s=n.heuristic,o=n.directed,l=n.weight;i=r.collection(i)[0],a=r.collection(a)[0];var c=i.id(),u=a.id(),f={},h={},m={},v=new im(function(K,L){return h[K.id()]-h[L.id()]}),y=new rf,x={},b={},S=function(L,G){v.push(L),y.add(G)},w,k,N=function(){w=v.pop(),k=w.id(),y.delete(k)},j=function(L){return y.has(L)};S(i,c),f[c]=0,h[c]=s(i);for(var T=0;v.size()>0;){if(N(),T++,k===u){for(var M=[],A=a,_=u,D=b[_];M.unshift(A),D!=null&&M.unshift(D),A=x[_],A!=null;)_=A.id(),D=b[_];return{found:!0,distance:f[k],path:this.spawn(M),steps:T}}m[k]=!0;for(var R=w._private.edges,I=0;I<R.length;I++){var $=R[I];if(this.hasElementWithId($.id())&&!(o&&$.data("source")!==k)){var B=$.source(),z=$.target(),U=B.id()!==k?B:z,F=U.id();if(this.hasElementWithId(F)&&!m[F]){var Q=f[k]+l($);if(!j(F)){f[F]=Q,h[F]=Q+s(U),S(U,F),x[F]=w,b[F]=$;continue}Q<f[F]&&(f[F]=Q,h[F]=Q+s(U),x[F]=w,b[F]=$)}}}}return{found:!1,distance:void 0,path:void 0,steps:T}}},zU=Pn({weight:function(e){return 1},directed:!1}),VU={floydWarshall:function(e){for(var r=this.cy(),n=zU(e),i=n.weight,a=n.directed,s=i,o=this.byGroup(),l=o.nodes,c=o.edges,u=l.length,f=u*u,h=function(ee){return l.indexOf(ee)},m=function(ee){return l[ee]},v=new Array(f),y=0;y<f;y++){var x=y%u,b=(y-x)/u;b===x?v[y]=0:v[y]=1/0}for(var S=new Array(f),w=new Array(f),k=0;k<c.length;k++){var N=c[k],j=N.source()[0],T=N.target()[0];if(j!==T){var M=h(j),A=h(T),_=M*u+A,D=s(N);if(v[_]>D&&(v[_]=D,S[_]=A,w[_]=N),!a){var R=A*u+M;!a&&v[R]>D&&(v[R]=D,S[R]=M,w[R]=N)}}}for(var I=0;I<u;I++)for(var $=0;$<u;$++)for(var B=$*u+I,z=0;z<u;z++){var U=$*u+z,F=I*u+z;v[B]+v[F]<v[U]&&(v[U]=v[B]+v[F],S[U]=S[B])}var Q=function(ee){return(Ke(ee)?r.filter(ee):ee)[0]},K=function(ee){return h(Q(ee))},L={distance:function(ee,re){var se=K(ee),de=K(re);return v[se*u+de]},path:function(ee,re){var se=K(ee),de=K(re),W=m(se);if(se===de)return W.collection();if(S[se*u+de]==null)return r.collection();var ne=r.collection(),ie=se,V;for(ne.merge(W);se!==de;)ie=se,se=S[se*u+de],V=w[ie*u+se],ne.merge(V),ne.merge(m(se));return ne}};return L}},$U=Pn({weight:function(e){return 1},directed:!1,root:null}),UU={bellmanFord:function(e){var r=this,n=$U(e),i=n.weight,a=n.directed,s=n.root,o=i,l=this,c=this.cy(),u=this.byGroup(),f=u.edges,h=u.nodes,m=h.length,v=new Gs,y=!1,x=[];s=c.collection(s)[0],f.unmergeBy(function(Pe){return Pe.isLoop()});for(var b=f.length,S=function(ze){var Ge=v.get(ze.id());return Ge||(Ge={},v.set(ze.id(),Ge)),Ge},w=function(ze){return(Ke(ze)?c.$(ze):ze)[0]},k=function(ze){return S(w(ze)).dist},N=function(ze){for(var Ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,Ce=w(ze),Re=[],Ve=Ce;;){if(Ve==null)return r.spawn();var We=S(Ve),Oe=We.edge,rt=We.pred;if(Re.unshift(Ve[0]),Ve.same(Ge)&&Re.length>0)break;Oe!=null&&Re.unshift(Oe),Ve=rt}return l.spawn(Re)},j=0;j<m;j++){var T=h[j],M=S(T);T.same(s)?M.dist=0:M.dist=1/0,M.pred=null,M.edge=null}for(var A=!1,_=function(ze,Ge,Ce,Re,Ve,We){var Oe=Re.dist+We;Oe<Ve.dist&&!Ce.same(Re.edge)&&(Ve.dist=Oe,Ve.pred=ze,Ve.edge=Ce,A=!0)},D=1;D<m;D++){A=!1;for(var R=0;R<b;R++){var I=f[R],$=I.source(),B=I.target(),z=o(I),U=S($),F=S(B);_($,B,I,U,F,z),a||_(B,$,I,F,U,z)}if(!A)break}if(A)for(var Q=[],K=0;K<b;K++){var L=f[K],G=L.source(),ee=L.target(),re=o(L),se=S(G).dist,de=S(ee).dist;if(se+re<de||!a&&de+re<se)if(y||(Lt("Graph contains a negative weight cycle for Bellman-Ford"),y=!0),e.findNegativeWeightCycles!==!1){var W=[];se+re<de&&W.push(G),!a&&de+re<se&&W.push(ee);for(var ne=W.length,ie=0;ie<ne;ie++){var V=W[ie],Y=[V];Y.push(S(V).edge);for(var te=S(V).pred;Y.indexOf(te)===-1;)Y.push(te),Y.push(S(te).edge),te=S(te).pred;Y=Y.slice(Y.indexOf(te));for(var Z=Y[0].id(),ue=0,ge=2;ge<Y.length;ge+=2)Y[ge].id()<Z&&(Z=Y[ge].id(),ue=ge);Y=Y.slice(ue).concat(Y.slice(0,ue)),Y.push(Y[0]);var Ue=Y.map(function(Pe){return Pe.id()}).join(",");Q.indexOf(Ue)===-1&&(x.push(l.spawn(Y)),Q.push(Ue))}}else break}return{distanceTo:k,pathTo:N,hasNegativeWeightCycle:y,negativeWeightCycles:x}}},GU=Math.sqrt(2),HU=function(e,r,n){n.length===0&&lr("Karger-Stein must be run on a connected (sub)graph");for(var i=n[e],a=i[1],s=i[2],o=r[a],l=r[s],c=n,u=c.length-1;u>=0;u--){var f=c[u],h=f[1],m=f[2];(r[h]===o&&r[m]===l||r[h]===l&&r[m]===o)&&c.splice(u,1)}for(var v=0;v<c.length;v++){var y=c[v];y[1]===l?(c[v]=y.slice(),c[v][1]=o):y[2]===l&&(c[v]=y.slice(),c[v][2]=o)}for(var x=0;x<r.length;x++)r[x]===l&&(r[x]=o);return c},jw=function(e,r,n,i){for(;n>i;){var a=Math.floor(Math.random()*r.length);r=HU(a,e,r),n--}return r},WU={kargerStein:function(){var e=this,r=this.byGroup(),n=r.nodes,i=r.edges;i.unmergeBy(function(F){return F.isLoop()});var a=n.length,s=i.length,o=Math.ceil(Math.pow(Math.log(a)/Math.LN2,2)),l=Math.floor(a/GU);if(a<2){lr("At least 2 nodes are required for Karger-Stein algorithm");return}for(var c=[],u=0;u<s;u++){var f=i[u];c.push([u,n.indexOf(f.source()),n.indexOf(f.target())])}for(var h=1/0,m=[],v=new Array(a),y=new Array(a),x=new Array(a),b=function(Q,K){for(var L=0;L<a;L++)K[L]=Q[L]},S=0;S<=o;S++){for(var w=0;w<a;w++)y[w]=w;var k=jw(y,c.slice(),a,l),N=k.slice();b(y,x);var j=jw(y,k,l,2),T=jw(x,N,l,2);j.length<=T.length&&j.length<h?(h=j.length,m=j,b(y,v)):T.length<=j.length&&T.length<h&&(h=T.length,m=T,b(x,v))}for(var M=this.spawn(m.map(function(F){return i[F[0]]})),A=this.spawn(),_=this.spawn(),D=v[0],R=0;R<v.length;R++){var I=v[R],$=n[R];I===D?A.merge($):_.merge($)}var B=function(Q){var K=e.spawn();return Q.forEach(function(L){K.merge(L),L.connectedEdges().forEach(function(G){e.contains(G)&&!M.contains(G)&&K.merge(G)})}),K},z=[B(A),B(_)],U={cut:M,components:z,partition1:A,partition2:_};return U}},Mw,qU=function(e){return{x:e.x,y:e.y}},ex=function(e,r,n){return{x:e.x*r+n.x,y:e.y*r+n.y}},JA=function(e,r,n){return{x:(e.x-n.x)/r,y:(e.y-n.y)/r}},od=function(e){return{x:e[0],y:e[1]}},KU=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=1/0,a=r;a<n;a++){var s=e[a];isFinite(s)&&(i=Math.min(s,i))}return i},YU=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=-1/0,a=r;a<n;a++){var s=e[a];isFinite(s)&&(i=Math.max(s,i))}return i},XU=function(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=0,a=0,s=r;s<n;s++){var o=e[s];isFinite(o)&&(i+=o,a++)}return i/a},QU=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.length,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;i?e=e.slice(r,n):(n<e.length&&e.splice(n,e.length-n),r>0&&e.splice(0,r));for(var o=0,l=e.length-1;l>=0;l--){var c=e[l];s?isFinite(c)||(e[l]=-1/0,o++):e.splice(l,1)}a&&e.sort(function(h,m){return h-m});var u=e.length,f=Math.floor(u/2);return u%2!==0?e[f+1+o]:(e[f-1+o]+e[f+o])/2},JU=function(e){return Math.PI*e/180},Rg=function(e,r){return Math.atan2(r,e)-Math.PI/2},t3=Math.log2||function(t){return Math.log(t)/Math.log(2)},r3=function(e){return e>0?1:e<0?-1:0},Fc=function(e,r){return Math.sqrt(cc(e,r))},cc=function(e,r){var n=r.x-e.x,i=r.y-e.y;return n*n+i*i},ZU=function(e){for(var r=e.length,n=0,i=0;i<r;i++)n+=e[i];for(var a=0;a<r;a++)e[a]=e[a]/n;return e},cn=function(e,r,n,i){return(1-i)*(1-i)*e+2*(1-i)*i*r+i*i*n},yd=function(e,r,n,i){return{x:cn(e.x,r.x,n.x,i),y:cn(e.y,r.y,n.y,i)}},eG=function(e,r,n,i){var a={x:r.x-e.x,y:r.y-e.y},s=Fc(e,r),o={x:a.x/s,y:a.y/s};return n=n??0,i=i??n*s,{x:e.x+o.x*i,y:e.y+o.y*i}},wp=function(e,r,n){return Math.max(e,Math.min(n,r))},ei=function(e){if(e==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(e.x1!=null&&e.y1!=null){if(e.x2!=null&&e.y2!=null&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(e.w!=null&&e.h!=null&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},tG=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}},rG=function(e){e.x1=1/0,e.y1=1/0,e.x2=-1/0,e.y2=-1/0,e.w=0,e.h=0},nG=function(e,r){e.x1=Math.min(e.x1,r.x1),e.x2=Math.max(e.x2,r.x2),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,r.y1),e.y2=Math.max(e.y2,r.y2),e.h=e.y2-e.y1},ZA=function(e,r,n){e.x1=Math.min(e.x1,r),e.x2=Math.max(e.x2,r),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,n),e.y2=Math.max(e.y2,n),e.h=e.y2-e.y1},jv=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return e.x1-=r,e.x2+=r,e.y1-=r,e.y2+=r,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},Mv=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],n,i,a,s;if(r.length===1)n=i=a=s=r[0];else if(r.length===2)n=a=r[0],s=i=r[1];else if(r.length===4){var o=zr(r,4);n=o[0],i=o[1],a=o[2],s=o[3]}return e.x1-=s,e.x2+=i,e.y1-=n,e.y2+=a,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},ZT=function(e,r){e.x1=r.x1,e.y1=r.y1,e.x2=r.x2,e.y2=r.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},n3=function(e,r){return!(e.x1>r.x2||r.x1>e.x2||e.x2<r.x1||r.x2<e.x1||e.y2<r.y1||r.y2<e.y1||e.y1>r.y2||r.y1>e.y2)},qo=function(e,r,n){return e.x1<=r&&r<=e.x2&&e.y1<=n&&n<=e.y2},e6=function(e,r){return qo(e,r.x,r.y)},eR=function(e,r){return qo(e,r.x1,r.y1)&&qo(e,r.x2,r.y2)},iG=(Mw=Math.hypot)!==null&&Mw!==void 0?Mw:function(t,e){return Math.sqrt(t*t+e*e)};function aG(t,e){if(t.length<3)throw new Error("Need at least 3 vertices");var r=function(M,A){return{x:M.x+A.x,y:M.y+A.y}},n=function(M,A){return{x:M.x-A.x,y:M.y-A.y}},i=function(M,A){return{x:M.x*A,y:M.y*A}},a=function(M,A){return M.x*A.y-M.y*A.x},s=function(M){var A=iG(M.x,M.y);return A===0?{x:0,y:0}:{x:M.x/A,y:M.y/A}},o=function(M){for(var A=0,_=0;_<M.length;_++){var D=M[_],R=M[(_+1)%M.length];A+=D.x*R.y-R.x*D.y}return A/2},l=function(M,A,_,D){var R=n(A,M),I=n(D,_),$=a(R,I);if(Math.abs($)<1e-9)return r(M,i(R,.5));var B=a(n(_,M),I)/$;return r(M,i(R,B))},c=t.map(function(T){return{x:T.x,y:T.y}});o(c)<0&&c.reverse();for(var u=c.length,f=[],h=0;h<u;h++){var m=c[h],v=c[(h+1)%u],y=n(v,m),x=s({x:y.y,y:-y.x});f.push(x)}for(var b=f.map(function(T,M){var A=r(c[M],i(T,e)),_=r(c[(M+1)%u],i(T,e));return{p1:A,p2:_}}),S=[],w=0;w<u;w++){var k=b[(w-1+u)%u],N=b[w],j=l(k.p1,k.p2,N.p1,N.p2);S.push(j)}return S}function sG(t,e,r,n,i,a){var s=mG(t,e,r,n,i),o=aG(s,a),l=ei();return o.forEach(function(c){return ZA(l,c.x,c.y)}),l}var tR=function(e,r,n,i,a,s,o){var l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",c=l==="auto"?vl(a,s):l,u=a/2,f=s/2;c=Math.min(c,u,f);var h=c!==u,m=c!==f,v;if(h){var y=n-u+c-o,x=i-f-o,b=n+u-c+o,S=x;if(v=Ko(e,r,n,i,y,x,b,S,!1),v.length>0)return v}if(m){var w=n+u+o,k=i-f+c-o,N=w,j=i+f-c+o;if(v=Ko(e,r,n,i,w,k,N,j,!1),v.length>0)return v}if(h){var T=n-u+c-o,M=i+f+o,A=n+u-c+o,_=M;if(v=Ko(e,r,n,i,T,M,A,_,!1),v.length>0)return v}if(m){var D=n-u-o,R=i-f+c-o,I=D,$=i+f-c+o;if(v=Ko(e,r,n,i,D,R,I,$,!1),v.length>0)return v}var B;{var z=n-u+c,U=i-f+c;if(B=xh(e,r,n,i,z,U,c+o),B.length>0&&B[0]<=z&&B[1]<=U)return[B[0],B[1]]}{var F=n+u-c,Q=i-f+c;if(B=xh(e,r,n,i,F,Q,c+o),B.length>0&&B[0]>=F&&B[1]<=Q)return[B[0],B[1]]}{var K=n+u-c,L=i+f-c;if(B=xh(e,r,n,i,K,L,c+o),B.length>0&&B[0]>=K&&B[1]>=L)return[B[0],B[1]]}{var G=n-u+c,ee=i+f-c;if(B=xh(e,r,n,i,G,ee,c+o),B.length>0&&B[0]<=G&&B[1]>=ee)return[B[0],B[1]]}return[]},oG=function(e,r,n,i,a,s,o){var l=o,c=Math.min(n,a),u=Math.max(n,a),f=Math.min(i,s),h=Math.max(i,s);return c-l<=e&&e<=u+l&&f-l<=r&&r<=h+l},lG=function(e,r,n,i,a,s,o,l,c){var u={x1:Math.min(n,o,a)-c,x2:Math.max(n,o,a)+c,y1:Math.min(i,l,s)-c,y2:Math.max(i,l,s)+c};return!(e<u.x1||e>u.x2||r<u.y1||r>u.y2)},cG=function(e,r,n,i){n-=i;var a=r*r-4*e*n;if(a<0)return[];var s=Math.sqrt(a),o=2*e,l=(-r+s)/o,c=(-r-s)/o;return[l,c]},uG=function(e,r,n,i,a){var s=1e-5;e===0&&(e=s),r/=e,n/=e,i/=e;var o,l,c,u,f,h,m,v;if(l=(3*n-r*r)/9,c=-(27*i)+r*(9*n-2*(r*r)),c/=54,o=l*l*l+c*c,a[1]=0,m=r/3,o>0){f=c+Math.sqrt(o),f=f<0?-Math.pow(-f,1/3):Math.pow(f,1/3),h=c-Math.sqrt(o),h=h<0?-Math.pow(-h,1/3):Math.pow(h,1/3),a[0]=-m+f+h,m+=(f+h)/2,a[4]=a[2]=-m,m=Math.sqrt(3)*(-h+f)/2,a[3]=m,a[5]=-m;return}if(a[5]=a[3]=0,o===0){v=c<0?-Math.pow(-c,1/3):Math.pow(c,1/3),a[0]=-m+2*v,a[4]=a[2]=-(v+m);return}l=-l,u=l*l*l,u=Math.acos(c/Math.sqrt(u)),v=2*Math.sqrt(l),a[0]=-m+v*Math.cos(u/3),a[2]=-m+v*Math.cos((u+2*Math.PI)/3),a[4]=-m+v*Math.cos((u+4*Math.PI)/3)},dG=function(e,r,n,i,a,s,o,l){var c=1*n*n-4*n*a+2*n*o+4*a*a-4*a*o+o*o+i*i-4*i*s+2*i*l+4*s*s-4*s*l+l*l,u=1*9*n*a-3*n*n-3*n*o-6*a*a+3*a*o+9*i*s-3*i*i-3*i*l-6*s*s+3*s*l,f=1*3*n*n-6*n*a+n*o-n*e+2*a*a+2*a*e-o*e+3*i*i-6*i*s+i*l-i*r+2*s*s+2*s*r-l*r,h=1*n*a-n*n+n*e-a*e+i*s-i*i+i*r-s*r,m=[];uG(c,u,f,h,m);for(var v=1e-7,y=[],x=0;x<6;x+=2)Math.abs(m[x+1])<v&&m[x]>=0&&m[x]<=1&&y.push(m[x]);y.push(1),y.push(0);for(var b=-1,S,w,k,N=0;N<y.length;N++)S=Math.pow(1-y[N],2)*n+2*(1-y[N])*y[N]*a+y[N]*y[N]*o,w=Math.pow(1-y[N],2)*i+2*(1-y[N])*y[N]*s+y[N]*y[N]*l,k=Math.pow(S-e,2)+Math.pow(w-r,2),b>=0?k<b&&(b=k):b=k;return b},fG=function(e,r,n,i,a,s){var o=[e-n,r-i],l=[a-n,s-i],c=l[0]*l[0]+l[1]*l[1],u=o[0]*o[0]+o[1]*o[1],f=o[0]*l[0]+o[1]*l[1],h=f*f/c;return f<0?u:h>c?(e-a)*(e-a)+(r-s)*(r-s):u-h},pi=function(e,r,n){for(var i,a,s,o,l,c=0,u=0;u<n.length/2;u++)if(i=n[u*2],a=n[u*2+1],u+1<n.length/2?(s=n[(u+1)*2],o=n[(u+1)*2+1]):(s=n[(u+1-n.length/2)*2],o=n[(u+1-n.length/2)*2+1]),!(i==e&&s==e))if(i>=e&&e>=s||i<=e&&e<=s)l=(e-i)/(s-i)*(o-a)+a,l>r&&c++;else continue;return c%2!==0},to=function(e,r,n,i,a,s,o,l,c){var u=new Array(n.length),f;l[0]!=null?(f=Math.atan(l[1]/l[0]),l[0]<0?f=f+Math.PI/2:f=-f-Math.PI/2):f=l;for(var h=Math.cos(-f),m=Math.sin(-f),v=0;v<u.length/2;v++)u[v*2]=s/2*(n[v*2]*h-n[v*2+1]*m),u[v*2+1]=o/2*(n[v*2+1]*h+n[v*2]*m),u[v*2]+=i,u[v*2+1]+=a;var y;if(c>0){var x=E0(u,-c);y=N0(x)}else y=u;return pi(e,r,y)},hG=function(e,r,n,i,a,s,o,l){for(var c=new Array(n.length*2),u=0;u<l.length;u++){var f=l[u];c[u*4+0]=f.startX,c[u*4+1]=f.startY,c[u*4+2]=f.stopX,c[u*4+3]=f.stopY;var h=Math.pow(f.cx-e,2)+Math.pow(f.cy-r,2);if(h<=Math.pow(f.radius,2))return!0}return pi(e,r,c)},N0=function(e){for(var r=new Array(e.length/2),n,i,a,s,o,l,c,u,f=0;f<e.length/4;f++){n=e[f*4],i=e[f*4+1],a=e[f*4+2],s=e[f*4+3],f<e.length/4-1?(o=e[(f+1)*4],l=e[(f+1)*4+1],c=e[(f+1)*4+2],u=e[(f+1)*4+3]):(o=e[0],l=e[1],c=e[2],u=e[3]);var h=Ko(n,i,a,s,o,l,c,u,!0);r[f*2]=h[0],r[f*2+1]=h[1]}return r},E0=function(e,r){for(var n=new Array(e.length*2),i,a,s,o,l=0;l<e.length/2;l++){i=e[l*2],a=e[l*2+1],l<e.length/2-1?(s=e[(l+1)*2],o=e[(l+1)*2+1]):(s=e[0],o=e[1]);var c=o-a,u=-(s-i),f=Math.sqrt(c*c+u*u),h=c/f,m=u/f;n[l*4]=i+h*r,n[l*4+1]=a+m*r,n[l*4+2]=s+h*r,n[l*4+3]=o+m*r}return n},pG=function(e,r,n,i,a,s){var o=n-e,l=i-r;o/=a,l/=s;var c=Math.sqrt(o*o+l*l),u=c-1;if(u<0)return[];var f=u/c;return[(n-e)*f+e,(i-r)*f+r]},yc=function(e,r,n,i,a,s,o){return e-=a,r-=s,e/=n/2+o,r/=i/2+o,e*e+r*r<=1},xh=function(e,r,n,i,a,s,o){var l=[n-e,i-r],c=[e-a,r-s],u=l[0]*l[0]+l[1]*l[1],f=2*(c[0]*l[0]+c[1]*l[1]),h=c[0]*c[0]+c[1]*c[1]-o*o,m=f*f-4*u*h;if(m<0)return[];var v=(-f+Math.sqrt(m))/(2*u),y=(-f-Math.sqrt(m))/(2*u),x=Math.min(v,y),b=Math.max(v,y),S=[];if(x>=0&&x<=1&&S.push(x),b>=0&&b<=1&&S.push(b),S.length===0)return[];var w=S[0]*l[0]+e,k=S[0]*l[1]+r;if(S.length>1){if(S[0]==S[1])return[w,k];var N=S[1]*l[0]+e,j=S[1]*l[1]+r;return[w,k,N,j]}else return[w,k]},Pw=function(e,r,n){return r<=e&&e<=n||n<=e&&e<=r?e:e<=r&&r<=n||n<=r&&r<=e?r:n},Ko=function(e,r,n,i,a,s,o,l,c){var u=e-a,f=n-e,h=o-a,m=r-s,v=i-r,y=l-s,x=h*m-y*u,b=f*m-v*u,S=y*f-h*v;if(S!==0){var w=x/S,k=b/S,N=.001,j=0-N,T=1+N;return j<=w&&w<=T&&j<=k&&k<=T?[e+w*f,r+w*v]:c?[e+w*f,r+w*v]:[]}else return x===0||b===0?Pw(e,n,o)===o?[o,l]:Pw(e,n,a)===a?[a,s]:Pw(a,o,n)===n?[n,i]:[]:[]},mG=function(e,r,n,i,a){var s=[],o=i/2,l=a/2,c=r,u=n;s.push({x:c+o*e[0],y:u+l*e[1]});for(var f=1;f<e.length/2;f++)s.push({x:c+o*e[f*2],y:u+l*e[f*2+1]});return s},Sp=function(e,r,n,i,a,s,o,l){var c=[],u,f=new Array(n.length),h=!0;s==null&&(h=!1);var m;if(h){for(var v=0;v<f.length/2;v++)f[v*2]=n[v*2]*s+i,f[v*2+1]=n[v*2+1]*o+a;if(l>0){var y=E0(f,-l);m=N0(y)}else m=f}else m=n;for(var x,b,S,w,k=0;k<m.length/2;k++)x=m[k*2],b=m[k*2+1],k<m.length/2-1?(S=m[(k+1)*2],w=m[(k+1)*2+1]):(S=m[0],w=m[1]),u=Ko(e,r,i,a,x,b,S,w),u.length!==0&&c.push(u[0],u[1]);return c},gG=function(e,r,n,i,a,s,o,l,c){var u=[],f,h=new Array(n.length*2);c.forEach(function(S,w){w===0?(h[h.length-2]=S.startX,h[h.length-1]=S.startY):(h[w*4-2]=S.startX,h[w*4-1]=S.startY),h[w*4]=S.stopX,h[w*4+1]=S.stopY,f=xh(e,r,i,a,S.cx,S.cy,S.radius),f.length!==0&&u.push(f[0],f[1])});for(var m=0;m<h.length/4;m++)f=Ko(e,r,i,a,h[m*4],h[m*4+1],h[m*4+2],h[m*4+3],!1),f.length!==0&&u.push(f[0],f[1]);if(u.length>2){for(var v=[u[0],u[1]],y=Math.pow(v[0]-e,2)+Math.pow(v[1]-r,2),x=1;x<u.length/2;x++){var b=Math.pow(u[x*2]-e,2)+Math.pow(u[x*2+1]-r,2);b<=y&&(v[0]=u[x*2],v[1]=u[x*2+1],y=b)}return v}return u},Dg=function(e,r,n){var i=[e[0]-r[0],e[1]-r[1]],a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=(a-n)/a;return s<0&&(s=1e-5),[r[0]+s*i[0],r[1]+s*i[1]]},Qn=function(e,r){var n=L5(e,r);return n=rR(n),n},rR=function(e){for(var r,n,i=e.length/2,a=1/0,s=1/0,o=-1/0,l=-1/0,c=0;c<i;c++)r=e[2*c],n=e[2*c+1],a=Math.min(a,r),o=Math.max(o,r),s=Math.min(s,n),l=Math.max(l,n);for(var u=2/(o-a),f=2/(l-s),h=0;h<i;h++)r=e[2*h]=e[2*h]*u,n=e[2*h+1]=e[2*h+1]*f,a=Math.min(a,r),o=Math.max(o,r),s=Math.min(s,n),l=Math.max(l,n);if(s<-1)for(var m=0;m<i;m++)n=e[2*m+1]=e[2*m+1]+(-1-s);return e},L5=function(e,r){var n=1/e*2*Math.PI,i=e%2===0?Math.PI/2+n/2:Math.PI/2;i+=r;for(var a=new Array(e*2),s,o=0;o<e;o++)s=o*n+i,a[2*o]=Math.cos(s),a[2*o+1]=Math.sin(-s);return a},vl=function(e,r){return Math.min(e/4,r/4,8)},nR=function(e,r){return Math.min(e/10,r/10,8)},i3=function(){return 8},vG=function(e,r,n){return[e-2*r+n,2*(r-e),e]},B5=function(e,r){return{heightOffset:Math.min(15,.05*r),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}};function _w(t,e){function r(f){for(var h=[],m=0;m<f.length;m++){var v=f[m],y=f[(m+1)%f.length],x={x:y.x-v.x,y:y.y-v.y},b={x:-x.y,y:x.x},S=Math.sqrt(b.x*b.x+b.y*b.y);h.push({x:b.x/S,y:b.y/S})}return h}function n(f,h){var m=1/0,v=-1/0,y=vi(f),x;try{for(y.s();!(x=y.n()).done;){var b=x.value,S=b.x*h.x+b.y*h.y;m=Math.min(m,S),v=Math.max(v,S)}}catch(w){y.e(w)}finally{y.f()}return{min:m,max:v}}function i(f,h){return!(f.max<h.min||h.max<f.min)}var a=[].concat(w0(r(t)),w0(r(e))),s=vi(a),o;try{for(s.s();!(o=s.n()).done;){var l=o.value,c=n(t,l),u=n(e,l);if(!i(c,u))return!1}}catch(f){s.e(f)}finally{s.f()}return!0}var yG=Pn({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),xG={pageRank:function(e){for(var r=yG(e),n=r.dampingFactor,i=r.precision,a=r.iterations,s=r.weight,o=this._private.cy,l=this.byGroup(),c=l.nodes,u=l.edges,f=c.length,h=f*f,m=u.length,v=new Array(h),y=new Array(f),x=(1-n)/f,b=0;b<f;b++){for(var S=0;S<f;S++){var w=b*f+S;v[w]=0}y[b]=0}for(var k=0;k<m;k++){var N=u[k],j=N.data("source"),T=N.data("target");if(j!==T){var M=c.indexOfId(j),A=c.indexOfId(T),_=s(N),D=A*f+M;v[D]+=_,y[M]+=_}}for(var R=1/f+x,I=0;I<f;I++)if(y[I]===0)for(var $=0;$<f;$++){var B=$*f+I;v[B]=R}else for(var z=0;z<f;z++){var U=z*f+I;v[U]=v[U]/y[I]+x}for(var F=new Array(f),Q=new Array(f),K,L=0;L<f;L++)F[L]=1;for(var G=0;G<a;G++){for(var ee=0;ee<f;ee++)Q[ee]=0;for(var re=0;re<f;re++)for(var se=0;se<f;se++){var de=re*f+se;Q[re]+=v[de]*F[se]}ZU(Q),K=F,F=Q,Q=K;for(var W=0,ne=0;ne<f;ne++){var ie=K[ne]-F[ne];W+=ie*ie}if(W<i)break}var V={rank:function(te){return te=o.collection(te)[0],F[c.indexOf(te)]}};return V}},t6=Pn({root:null,weight:function(e){return 1},directed:!1,alpha:0}),xd={degreeCentralityNormalized:function(e){e=t6(e);var r=this.cy(),n=this.nodes(),i=n.length;if(e.directed){for(var u={},f={},h=0,m=0,v=0;v<i;v++){var y=n[v],x=y.id();e.root=y;var b=this.degreeCentrality(e);h<b.indegree&&(h=b.indegree),m<b.outdegree&&(m=b.outdegree),u[x]=b.indegree,f[x]=b.outdegree}return{indegree:function(w){return h==0?0:(Ke(w)&&(w=r.filter(w)),u[w.id()]/h)},outdegree:function(w){return m===0?0:(Ke(w)&&(w=r.filter(w)),f[w.id()]/m)}}}else{for(var a={},s=0,o=0;o<i;o++){var l=n[o];e.root=l;var c=this.degreeCentrality(e);s<c.degree&&(s=c.degree),a[l.id()]=c.degree}return{degree:function(w){return s===0?0:(Ke(w)&&(w=r.filter(w)),a[w.id()]/s)}}}},degreeCentrality:function(e){e=t6(e);var r=this.cy(),n=this,i=e,a=i.root,s=i.weight,o=i.directed,l=i.alpha;if(a=r.collection(a)[0],o){for(var m=a.connectedEdges(),v=m.filter(function(j){return j.target().same(a)&&n.has(j)}),y=m.filter(function(j){return j.source().same(a)&&n.has(j)}),x=v.length,b=y.length,S=0,w=0,k=0;k<v.length;k++)S+=s(v[k]);for(var N=0;N<y.length;N++)w+=s(y[N]);return{indegree:Math.pow(x,1-l)*Math.pow(S,l),outdegree:Math.pow(b,1-l)*Math.pow(w,l)}}else{for(var c=a.connectedEdges().intersection(n),u=c.length,f=0,h=0;h<c.length;h++)f+=s(c[h]);return{degree:Math.pow(u,1-l)*Math.pow(f,l)}}}};xd.dc=xd.degreeCentrality;xd.dcn=xd.degreeCentralityNormalised=xd.degreeCentralityNormalized;var r6=Pn({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),bd={closenessCentralityNormalized:function(e){for(var r=r6(e),n=r.harmonic,i=r.weight,a=r.directed,s=this.cy(),o={},l=0,c=this.nodes(),u=this.floydWarshall({weight:i,directed:a}),f=0;f<c.length;f++){for(var h=0,m=c[f],v=0;v<c.length;v++)if(f!==v){var y=u.distance(m,c[v]);n?h+=1/y:h+=y}n||(h=1/h),l<h&&(l=h),o[m.id()]=h}return{closeness:function(b){return l==0?0:(Ke(b)?b=s.filter(b)[0].id():b=b.id(),o[b]/l)}}},closenessCentrality:function(e){var r=r6(e),n=r.root,i=r.weight,a=r.directed,s=r.harmonic;n=this.filter(n)[0];for(var o=this.dijkstra({root:n,weight:i,directed:a}),l=0,c=this.nodes(),u=0;u<c.length;u++){var f=c[u];if(!f.same(n)){var h=o.distanceTo(f);s?l+=1/h:l+=h}}return s?l:1/l}};bd.cc=bd.closenessCentrality;bd.ccn=bd.closenessCentralityNormalised=bd.closenessCentralityNormalized;var bG=Pn({weight:null,directed:!1}),F5={betweennessCentrality:function(e){for(var r=bG(e),n=r.directed,i=r.weight,a=i!=null,s=this.cy(),o=this.nodes(),l={},c={},u=0,f={set:function(w,k){c[w]=k,k>u&&(u=k)},get:function(w){return c[w]}},h=0;h<o.length;h++){var m=o[h],v=m.id();n?l[v]=m.outgoers().nodes():l[v]=m.openNeighborhood().nodes(),f.set(v,0)}for(var y=function(){for(var w=o[x].id(),k=[],N={},j={},T={},M=new im(function(re,se){return T[re]-T[se]}),A=0;A<o.length;A++){var _=o[A].id();N[_]=[],j[_]=0,T[_]=1/0}for(j[w]=1,T[w]=0,M.push(w);!M.empty();){var D=M.pop();if(k.push(D),a)for(var R=0;R<l[D].length;R++){var I=l[D][R],$=s.getElementById(D),B=void 0;$.edgesTo(I).length>0?B=$.edgesTo(I)[0]:B=I.edgesTo($)[0];var z=i(B);I=I.id(),T[I]>T[D]+z&&(T[I]=T[D]+z,M.nodes.indexOf(I)<0?M.push(I):M.updateItem(I),j[I]=0,N[I]=[]),T[I]==T[D]+z&&(j[I]=j[I]+j[D],N[I].push(D))}else for(var U=0;U<l[D].length;U++){var F=l[D][U].id();T[F]==1/0&&(M.push(F),T[F]=T[D]+1),T[F]==T[D]+1&&(j[F]=j[F]+j[D],N[F].push(D))}}for(var Q={},K=0;K<o.length;K++)Q[o[K].id()]=0;for(;k.length>0;){for(var L=k.pop(),G=0;G<N[L].length;G++){var ee=N[L][G];Q[ee]=Q[ee]+j[ee]/j[L]*(1+Q[L])}L!=o[x].id()&&f.set(L,f.get(L)+Q[L])}},x=0;x<o.length;x++)y();var b={betweenness:function(w){var k=s.collection(w).id();return f.get(k)},betweennessNormalized:function(w){if(u==0)return 0;var k=s.collection(w).id();return f.get(k)/u}};return b.betweennessNormalised=b.betweennessNormalized,b}};F5.bc=F5.betweennessCentrality;var wG=Pn({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(t){return 1}]}),SG=function(e){return wG(e)},kG=function(e,r){for(var n=0,i=0;i<r.length;i++)n+=r[i](e);return n},CG=function(e,r,n){for(var i=0;i<r;i++)e[i*r+i]=n},iR=function(e,r){for(var n,i=0;i<r;i++){n=0;for(var a=0;a<r;a++)n+=e[a*r+i];for(var s=0;s<r;s++)e[s*r+i]=e[s*r+i]/n}},NG=function(e,r,n){for(var i=new Array(n*n),a=0;a<n;a++){for(var s=0;s<n;s++)i[a*n+s]=0;for(var o=0;o<n;o++)for(var l=0;l<n;l++)i[a*n+l]+=e[a*n+o]*r[o*n+l]}return i},EG=function(e,r,n){for(var i=e.slice(0),a=1;a<n;a++)e=NG(e,i,r);return e},TG=function(e,r,n){for(var i=new Array(r*r),a=0;a<r*r;a++)i[a]=Math.pow(e[a],n);return iR(i,r),i},jG=function(e,r,n,i){for(var a=0;a<n;a++){var s=Math.round(e[a]*Math.pow(10,i))/Math.pow(10,i),o=Math.round(r[a]*Math.pow(10,i))/Math.pow(10,i);if(s!==o)return!1}return!0},MG=function(e,r,n,i){for(var a=[],s=0;s<r;s++){for(var o=[],l=0;l<r;l++)Math.round(e[s*r+l]*1e3)/1e3>0&&o.push(n[l]);o.length!==0&&a.push(i.collection(o))}return a},PG=function(e,r){for(var n=0;n<e.length;n++)if(!r[n]||e[n].id()!==r[n].id())return!1;return!0},_G=function(e){for(var r=0;r<e.length;r++)for(var n=0;n<e.length;n++)r!=n&&PG(e[r],e[n])&&e.splice(n,1);return e},n6=function(e){for(var r=this.nodes(),n=this.edges(),i=this.cy(),a=SG(e),s={},o=0;o<r.length;o++)s[r[o].id()]=o;for(var l=r.length,c=l*l,u=new Array(c),f,h=0;h<c;h++)u[h]=0;for(var m=0;m<n.length;m++){var v=n[m],y=s[v.source().id()],x=s[v.target().id()],b=kG(v,a.attributes);u[y*l+x]+=b,u[x*l+y]+=b}CG(u,l,a.multFactor),iR(u,l);for(var S=!0,w=0;S&&w<a.maxIterations;)S=!1,f=EG(u,l,a.expandFactor),u=TG(f,l,a.inflateFactor),jG(u,f,c,4)||(S=!0),w++;var k=MG(u,l,r,i);return k=_G(k),k},AG={markovClustering:n6,mcl:n6},RG=function(e){return e},aR=function(e,r){return Math.abs(r-e)},i6=function(e,r,n){return e+aR(r,n)},a6=function(e,r,n){return e+Math.pow(n-r,2)},DG=function(e){return Math.sqrt(e)},OG=function(e,r,n){return Math.max(e,aR(r,n))},Yf=function(e,r,n,i,a){for(var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:RG,o=i,l,c,u=0;u<e;u++)l=r(u),c=n(u),o=a(o,l,c);return s(o)},Dd={euclidean:function(e,r,n){return e>=2?Yf(e,r,n,0,a6,DG):Yf(e,r,n,0,i6)},squaredEuclidean:function(e,r,n){return Yf(e,r,n,0,a6)},manhattan:function(e,r,n){return Yf(e,r,n,0,i6)},max:function(e,r,n){return Yf(e,r,n,-1/0,OG)}};Dd["squared-euclidean"]=Dd.squaredEuclidean;Dd.squaredeuclidean=Dd.squaredEuclidean;function tx(t,e,r,n,i,a){var s;return vr(t)?s=t:s=Dd[t]||Dd.euclidean,e===0&&vr(t)?s(i,a):s(e,r,n,i,a)}var IG=Pn({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),a3=function(e){return IG(e)},T0=function(e,r,n,i,a){var s=a!=="kMedoids",o=s?function(f){return n[f]}:function(f){return i[f](n)},l=function(h){return i[h](r)},c=n,u=r;return tx(e,i.length,o,l,c,u)},Aw=function(e,r,n){for(var i=n.length,a=new Array(i),s=new Array(i),o=new Array(r),l=null,c=0;c<i;c++)a[c]=e.min(n[c]).value,s[c]=e.max(n[c]).value;for(var u=0;u<r;u++){l=[];for(var f=0;f<i;f++)l[f]=Math.random()*(s[f]-a[f])+a[f];o[u]=l}return o},sR=function(e,r,n,i,a){for(var s=1/0,o=0,l=0;l<r.length;l++){var c=T0(n,e,r[l],i,a);c<s&&(s=c,o=l)}return o},oR=function(e,r,n){for(var i=[],a=null,s=0;s<r.length;s++)a=r[s],n[a.id()]===e&&i.push(a);return i},LG=function(e,r,n){return Math.abs(r-e)<=n},BG=function(e,r,n){for(var i=0;i<e.length;i++)for(var a=0;a<e[i].length;a++){var s=Math.abs(e[i][a]-r[i][a]);if(s>n)return!1}return!0},FG=function(e,r,n){for(var i=0;i<n;i++)if(e===r[i])return!0;return!1},s6=function(e,r){var n=new Array(r);if(e.length<50)for(var i=0;i<r;i++){for(var a=e[Math.floor(Math.random()*e.length)];FG(a,n,i);)a=e[Math.floor(Math.random()*e.length)];n[i]=a}else for(var s=0;s<r;s++)n[s]=e[Math.floor(Math.random()*e.length)];return n},o6=function(e,r,n){for(var i=0,a=0;a<r.length;a++)i+=T0("manhattan",r[a],e,n,"kMedoids");return i},zG=function(e){var r=this.cy(),n=this.nodes(),i=null,a=a3(e),s=new Array(a.k),o={},l;a.testMode?typeof a.testCentroids=="number"?(a.testCentroids,l=Aw(n,a.k,a.attributes)):Zr(a.testCentroids)==="object"?l=a.testCentroids:l=Aw(n,a.k,a.attributes):l=Aw(n,a.k,a.attributes);for(var c=!0,u=0;c&&u<a.maxIterations;){for(var f=0;f<n.length;f++)i=n[f],o[i.id()]=sR(i,l,a.distance,a.attributes,"kMeans");c=!1;for(var h=0;h<a.k;h++){var m=oR(h,n,o);if(m.length!==0){for(var v=a.attributes.length,y=l[h],x=new Array(v),b=new Array(v),S=0;S<v;S++){b[S]=0;for(var w=0;w<m.length;w++)i=m[w],b[S]+=a.attributes[S](i);x[S]=b[S]/m.length,LG(x[S],y[S],a.sensitivityThreshold)||(c=!0)}l[h]=x,s[h]=r.collection(m)}}u++}return s},VG=function(e){var r=this.cy(),n=this.nodes(),i=null,a=a3(e),s=new Array(a.k),o,l={},c,u=new Array(a.k);a.testMode?typeof a.testCentroids=="number"||(Zr(a.testCentroids)==="object"?o=a.testCentroids:o=s6(n,a.k)):o=s6(n,a.k);for(var f=!0,h=0;f&&h<a.maxIterations;){for(var m=0;m<n.length;m++)i=n[m],l[i.id()]=sR(i,o,a.distance,a.attributes,"kMedoids");f=!1;for(var v=0;v<o.length;v++){var y=oR(v,n,l);if(y.length!==0){u[v]=o6(o[v],y,a.attributes);for(var x=0;x<y.length;x++)c=o6(y[x],y,a.attributes),c<u[v]&&(u[v]=c,o[v]=y[x],f=!0);s[v]=r.collection(y)}}h++}return s},$G=function(e,r,n,i,a){for(var s,o,l=0;l<r.length;l++)for(var c=0;c<e.length;c++)i[l][c]=Math.pow(n[l][c],a.m);for(var u=0;u<e.length;u++)for(var f=0;f<a.attributes.length;f++){s=0,o=0;for(var h=0;h<r.length;h++)s+=i[h][u]*a.attributes[f](r[h]),o+=i[h][u];e[u][f]=s/o}},UG=function(e,r,n,i,a){for(var s=0;s<e.length;s++)r[s]=e[s].slice();for(var o,l,c,u=2/(a.m-1),f=0;f<n.length;f++)for(var h=0;h<i.length;h++){o=0;for(var m=0;m<n.length;m++)l=T0(a.distance,i[h],n[f],a.attributes,"cmeans"),c=T0(a.distance,i[h],n[m],a.attributes,"cmeans"),o+=Math.pow(l/c,u);e[h][f]=1/o}},GG=function(e,r,n,i){for(var a=new Array(n.k),s=0;s<a.length;s++)a[s]=[];for(var o,l,c=0;c<r.length;c++){o=-1/0,l=-1;for(var u=0;u<r[0].length;u++)r[c][u]>o&&(o=r[c][u],l=u);a[l].push(e[c])}for(var f=0;f<a.length;f++)a[f]=i.collection(a[f]);return a},l6=function(e){var r=this.cy(),n=this.nodes(),i=a3(e),a,s,o,l,c;l=new Array(n.length);for(var u=0;u<n.length;u++)l[u]=new Array(i.k);o=new Array(n.length);for(var f=0;f<n.length;f++)o[f]=new Array(i.k);for(var h=0;h<n.length;h++){for(var m=0,v=0;v<i.k;v++)o[h][v]=Math.random(),m+=o[h][v];for(var y=0;y<i.k;y++)o[h][y]=o[h][y]/m}s=new Array(i.k);for(var x=0;x<i.k;x++)s[x]=new Array(i.attributes.length);c=new Array(n.length);for(var b=0;b<n.length;b++)c[b]=new Array(i.k);for(var S=!0,w=0;S&&w<i.maxIterations;)S=!1,$G(s,n,o,c,i),UG(o,l,s,n,i),BG(o,l,i.sensitivityThreshold)||(S=!0),w++;return a=GG(n,o,i,r),{clusters:a,degreeOfMembership:o}},HG={kMeans:zG,kMedoids:VG,fuzzyCMeans:l6,fcm:l6},WG=Pn({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),qG={single:"min",complete:"max"},KG=function(e){var r=WG(e),n=qG[r.linkage];return n!=null&&(r.linkage=n),r},c6=function(e,r,n,i,a){for(var s=0,o=1/0,l,c=a.attributes,u=function(A,_){return tx(a.distance,c.length,function(D){return c[D](A)},function(D){return c[D](_)},A,_)},f=0;f<e.length;f++){var h=e[f].key,m=n[h][i[h]];m<o&&(s=h,o=m)}if(a.mode==="threshold"&&o>=a.threshold||a.mode==="dendrogram"&&e.length===1)return!1;var v=r[s],y=r[i[s]],x;a.mode==="dendrogram"?x={left:v,right:y,key:v.key}:x={value:v.value.concat(y.value),key:v.key},e[v.index]=x,e.splice(y.index,1),r[v.key]=x;for(var b=0;b<e.length;b++){var S=e[b];v.key===S.key?l=1/0:a.linkage==="min"?(l=n[v.key][S.key],n[v.key][S.key]>n[y.key][S.key]&&(l=n[y.key][S.key])):a.linkage==="max"?(l=n[v.key][S.key],n[v.key][S.key]<n[y.key][S.key]&&(l=n[y.key][S.key])):a.linkage==="mean"?l=(n[v.key][S.key]*v.size+n[y.key][S.key]*y.size)/(v.size+y.size):a.mode==="dendrogram"?l=u(S.value,v.value):l=u(S.value[0],v.value[0]),n[v.key][S.key]=n[S.key][v.key]=l}for(var w=0;w<e.length;w++){var k=e[w].key;if(i[k]===v.key||i[k]===y.key){for(var N=k,j=0;j<e.length;j++){var T=e[j].key;n[k][T]<n[k][N]&&(N=T)}i[k]=N}e[w].index=w}return v.key=y.key=v.index=y.index=null,!0},ld=function(e,r,n){e&&(e.value?r.push(e.value):(e.left&&ld(e.left,r),e.right&&ld(e.right,r)))},z5=function(e,r){if(!e)return"";if(e.left&&e.right){var n=z5(e.left,r),i=z5(e.right,r),a=r.add({group:"nodes",data:{id:n+","+i}});return r.add({group:"edges",data:{source:n,target:a.id()}}),r.add({group:"edges",data:{source:i,target:a.id()}}),a.id()}else if(e.value)return e.value.id()},V5=function(e,r,n){if(!e)return[];var i=[],a=[],s=[];return r===0?(e.left&&ld(e.left,i),e.right&&ld(e.right,a),s=i.concat(a),[n.collection(s)]):r===1?e.value?[n.collection(e.value)]:(e.left&&ld(e.left,i),e.right&&ld(e.right,a),[n.collection(i),n.collection(a)]):e.value?[n.collection(e.value)]:(e.left&&(i=V5(e.left,r-1,n)),e.right&&(a=V5(e.right,r-1,n)),i.concat(a))},u6=function(e){for(var r=this.cy(),n=this.nodes(),i=KG(e),a=i.attributes,s=function(w,k){return tx(i.distance,a.length,function(N){return a[N](w)},function(N){return a[N](k)},w,k)},o=[],l=[],c=[],u=[],f=0;f<n.length;f++){var h={value:i.mode==="dendrogram"?n[f]:[n[f]],key:f,index:f};o[f]=h,u[f]=h,l[f]=[],c[f]=0}for(var m=0;m<o.length;m++)for(var v=0;v<=m;v++){var y=void 0;i.mode==="dendrogram"?y=m===v?1/0:s(o[m].value,o[v].value):y=m===v?1/0:s(o[m].value[0],o[v].value[0]),l[m][v]=y,l[v][m]=y,y<l[m][c[m]]&&(c[m]=v)}for(var x=c6(o,u,l,c,i);x;)x=c6(o,u,l,c,i);var b;return i.mode==="dendrogram"?(b=V5(o[0],i.dendrogramDepth,r),i.addDendrogram&&z5(o[0],r)):(b=new Array(o.length),o.forEach(function(S,w){S.key=S.index=null,b[w]=r.collection(S.value)})),b},YG={hierarchicalClustering:u6,hca:u6},XG=Pn({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),QG=function(e){var r=e.damping,n=e.preference;.5<=r&&r<1||lr("Damping must range on [0.5, 1).  Got: ".concat(r));var i=["median","mean","min","max"];return i.some(function(a){return a===n})||Ee(n)||lr("Preference must be one of [".concat(i.map(function(a){return"'".concat(a,"'")}).join(", "),"] or a number.  Got: ").concat(n)),XG(e)},JG=function(e,r,n,i){var a=function(o,l){return i[l](o)};return-tx(e,i.length,function(s){return a(r,s)},function(s){return a(n,s)},r,n)},ZG=function(e,r){var n=null;return r==="median"?n=QU(e):r==="mean"?n=XU(e):r==="min"?n=KU(e):r==="max"?n=YU(e):n=r,n},eH=function(e,r,n){for(var i=[],a=0;a<e;a++)r[a*e+a]+n[a*e+a]>0&&i.push(a);return i},d6=function(e,r,n){for(var i=[],a=0;a<e;a++){for(var s=-1,o=-1/0,l=0;l<n.length;l++){var c=n[l];r[a*e+c]>o&&(s=c,o=r[a*e+c])}s>0&&i.push(s)}for(var u=0;u<n.length;u++)i[n[u]]=n[u];return i},tH=function(e,r,n){for(var i=d6(e,r,n),a=0;a<n.length;a++){for(var s=[],o=0;o<i.length;o++)i[o]===n[a]&&s.push(o);for(var l=-1,c=-1/0,u=0;u<s.length;u++){for(var f=0,h=0;h<s.length;h++)f+=r[s[h]*e+s[u]];f>c&&(l=u,c=f)}n[a]=s[l]}return i=d6(e,r,n),i},f6=function(e){for(var r=this.cy(),n=this.nodes(),i=QG(e),a={},s=0;s<n.length;s++)a[n[s].id()]=s;var o,l,c,u,f,h;o=n.length,l=o*o,c=new Array(l);for(var m=0;m<l;m++)c[m]=-1/0;for(var v=0;v<o;v++)for(var y=0;y<o;y++)v!==y&&(c[v*o+y]=JG(i.distance,n[v],n[y],i.attributes));u=ZG(c,i.preference);for(var x=0;x<o;x++)c[x*o+x]=u;f=new Array(l);for(var b=0;b<l;b++)f[b]=0;h=new Array(l);for(var S=0;S<l;S++)h[S]=0;for(var w=new Array(o),k=new Array(o),N=new Array(o),j=0;j<o;j++)w[j]=0,k[j]=0,N[j]=0;for(var T=new Array(o*i.minIterations),M=0;M<T.length;M++)T[M]=0;var A;for(A=0;A<i.maxIterations;A++){for(var _=0;_<o;_++){for(var D=-1/0,R=-1/0,I=-1,$=0,B=0;B<o;B++)w[B]=f[_*o+B],$=h[_*o+B]+c[_*o+B],$>=D?(R=D,D=$,I=B):$>R&&(R=$);for(var z=0;z<o;z++)f[_*o+z]=(1-i.damping)*(c[_*o+z]-D)+i.damping*w[z];f[_*o+I]=(1-i.damping)*(c[_*o+I]-R)+i.damping*w[I]}for(var U=0;U<o;U++){for(var F=0,Q=0;Q<o;Q++)w[Q]=h[Q*o+U],k[Q]=Math.max(0,f[Q*o+U]),F+=k[Q];F-=k[U],k[U]=f[U*o+U],F+=k[U];for(var K=0;K<o;K++)h[K*o+U]=(1-i.damping)*Math.min(0,F-k[K])+i.damping*w[K];h[U*o+U]=(1-i.damping)*(F-k[U])+i.damping*w[U]}for(var L=0,G=0;G<o;G++){var ee=h[G*o+G]+f[G*o+G]>0?1:0;T[A%i.minIterations*o+G]=ee,L+=ee}if(L>0&&(A>=i.minIterations-1||A==i.maxIterations-1)){for(var re=0,se=0;se<o;se++){N[se]=0;for(var de=0;de<i.minIterations;de++)N[se]+=T[de*o+se];(N[se]===0||N[se]===i.minIterations)&&re++}if(re===o)break}}for(var W=eH(o,f,h),ne=tH(o,c,W),ie={},V=0;V<W.length;V++)ie[W[V]]=[];for(var Y=0;Y<n.length;Y++){var te=a[n[Y].id()],Z=ne[te];Z!=null&&ie[Z].push(n[Y])}for(var ue=new Array(W.length),ge=0;ge<W.length;ge++)ue[ge]=r.collection(ie[W[ge]]);return ue},rH={affinityPropagation:f6,ap:f6},nH=Pn({root:void 0,directed:!1}),iH={hierholzer:function(e){if(!Mt(e)){var r=arguments;e={root:r[0],directed:r[1]}}var n=nH(e),i=n.root,a=n.directed,s=this,o=!1,l,c,u;i&&(u=Ke(i)?this.filter(i)[0].id():i[0].id());var f={},h={};a?s.forEach(function(S){var w=S.id();if(S.isNode()){var k=S.indegree(!0),N=S.outdegree(!0),j=k-N,T=N-k;j==1?l?o=!0:l=w:T==1?c?o=!0:c=w:(T>1||j>1)&&(o=!0),f[w]=[],S.outgoers().forEach(function(M){M.isEdge()&&f[w].push(M.id())})}else h[w]=[void 0,S.target().id()]}):s.forEach(function(S){var w=S.id();if(S.isNode()){var k=S.degree(!0);k%2&&(l?c?o=!0:c=w:l=w),f[w]=[],S.connectedEdges().forEach(function(N){return f[w].push(N.id())})}else h[w]=[S.source().id(),S.target().id()]});var m={found:!1,trail:void 0};if(o)return m;if(c&&l)if(a){if(u&&c!=u)return m;u=c}else{if(u&&c!=u&&l!=u)return m;u||(u=c)}else u||(u=s[0].id());var v=function(w){for(var k=w,N=[w],j,T,M;f[k].length;)j=f[k].shift(),T=h[j][0],M=h[j][1],k!=M?(f[M]=f[M].filter(function(A){return A!=j}),k=M):!a&&k!=T&&(f[T]=f[T].filter(function(A){return A!=j}),k=T),N.unshift(j),N.unshift(k);return N},y=[],x=[];for(x=v(u);x.length!=1;)f[x[0]].length==0?(y.unshift(s.getElementById(x.shift())),y.unshift(s.getElementById(x.shift()))):x=v(x.shift()).concat(x);y.unshift(s.getElementById(x.shift()));for(var b in f)if(f[b].length)return m;return m.found=!0,m.trail=this.spawn(y,!0),m}},Og=function(){var e=this,r={},n=0,i=0,a=[],s=[],o={},l=function(h,m){for(var v=s.length-1,y=[],x=e.spawn();s[v].x!=h||s[v].y!=m;)y.push(s.pop().edge),v--;y.push(s.pop().edge),y.forEach(function(b){var S=b.connectedNodes().intersection(e);x.merge(b),S.forEach(function(w){var k=w.id(),N=w.connectedEdges().intersection(e);x.merge(w),r[k].cutVertex?x.merge(N.filter(function(j){return j.isLoop()})):x.merge(N)})}),a.push(x)},c=function(h,m,v){h===v&&(i+=1),r[m]={id:n,low:n++,cutVertex:!1};var y=e.getElementById(m).connectedEdges().intersection(e);if(y.size()===0)a.push(e.spawn(e.getElementById(m)));else{var x,b,S,w;y.forEach(function(k){x=k.source().id(),b=k.target().id(),S=x===m?b:x,S!==v&&(w=k.id(),o[w]||(o[w]=!0,s.push({x:m,y:S,edge:k})),S in r?r[m].low=Math.min(r[m].low,r[S].id):(c(h,S,m),r[m].low=Math.min(r[m].low,r[S].low),r[m].id<=r[S].low&&(r[m].cutVertex=!0,l(m,S))))})}};e.forEach(function(f){if(f.isNode()){var h=f.id();h in r||(i=0,c(h,h),r[h].cutVertex=i>1)}});var u=Object.keys(r).filter(function(f){return r[f].cutVertex}).map(function(f){return e.getElementById(f)});return{cut:e.spawn(u),components:a}},aH={hopcroftTarjanBiconnected:Og,htbc:Og,htb:Og,hopcroftTarjanBiconnectedComponents:Og},Ig=function(){var e=this,r={},n=0,i=[],a=[],s=e.spawn(e),o=function(c){a.push(c),r[c]={index:n,low:n++,explored:!1};var u=e.getElementById(c).connectedEdges().intersection(e);if(u.forEach(function(y){var x=y.target().id();x!==c&&(x in r||o(x),r[x].explored||(r[c].low=Math.min(r[c].low,r[x].low)))}),r[c].index===r[c].low){for(var f=e.spawn();;){var h=a.pop();if(f.merge(e.getElementById(h)),r[h].low=r[c].index,r[h].explored=!0,h===c)break}var m=f.edgesWith(f),v=f.merge(m);i.push(v),s=s.difference(v)}};return e.forEach(function(l){if(l.isNode()){var c=l.id();c in r||o(c)}}),{cut:s,components:i}},sH={tarjanStronglyConnected:Ig,tsc:Ig,tscc:Ig,tarjanStronglyConnectedComponents:Ig},lR={};[bp,IU,LU,FU,VU,UU,WU,xG,xd,bd,F5,AG,HG,YG,rH,iH,aH,sH].forEach(function(t){Qe(lR,t)});/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/var cR=0,uR=1,dR=2,La=function(e){if(!(this instanceof La))return new La(e);this.id="Thenable/1.0.7",this.state=cR,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof e=="function"&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};La.prototype={fulfill:function(e){return h6(this,uR,"fulfillValue",e)},reject:function(e){return h6(this,dR,"rejectReason",e)},then:function(e,r){var n=this,i=new La;return n.onFulfilled.push(m6(e,i,"fulfill")),n.onRejected.push(m6(r,i,"reject")),fR(n),i.proxy}};var h6=function(e,r,n,i){return e.state===cR&&(e.state=r,e[n]=i,fR(e)),e},fR=function(e){e.state===uR?p6(e,"onFulfilled",e.fulfillValue):e.state===dR&&p6(e,"onRejected",e.rejectReason)},p6=function(e,r,n){if(e[r].length!==0){var i=e[r];e[r]=[];var a=function(){for(var o=0;o<i.length;o++)i[o](n)};typeof setImmediate=="function"?setImmediate(a):setTimeout(a,0)}},m6=function(e,r,n){return function(i){if(typeof e!="function")r[n].call(r,i);else{var a;try{a=e(i)}catch(s){r.reject(s);return}hR(r,a)}}},hR=function(e,r){if(e===r||e.proxy===r){e.reject(new TypeError("cannot resolve promise with itself"));return}var n;if(Zr(r)==="object"&&r!==null||typeof r=="function")try{n=r.then}catch(a){e.reject(a);return}if(typeof n=="function"){var i=!1;try{n.call(r,function(a){i||(i=!0,a===r?e.reject(new TypeError("circular thenable chain")):hR(e,a))},function(a){i||(i=!0,e.reject(a))})}catch(a){i||e.reject(a)}return}e.fulfill(r)};La.all=function(t){return new La(function(e,r){for(var n=new Array(t.length),i=0,a=function(l,c){n[l]=c,i++,i===t.length&&e(n)},s=0;s<t.length;s++)(function(o){var l=t[o],c=l!=null&&l.then!=null;if(c)l.then(function(f){a(o,f)},function(f){r(f)});else{var u=l;a(o,u)}})(s)})};La.resolve=function(t){return new La(function(e,r){e(t)})};La.reject=function(t){return new La(function(e,r){r(t)})};var nf=typeof Promise<"u"?Promise:La,$5=function(e,r,n){var i=YC(e),a=!i,s=this._private=Qe({duration:1e3},r,n);if(s.target=e,s.style=s.style||s.css,s.started=!1,s.playing=!1,s.hooked=!1,s.applying=!1,s.progress=0,s.completes=[],s.frames=[],s.complete&&vr(s.complete)&&s.completes.push(s.complete),a){var o=e.position();s.startPosition=s.startPosition||{x:o.x,y:o.y},s.startStyle=s.startStyle||e.cy().style().getAnimationStartStyle(e,s.style)}if(i){var l=e.pan();s.startPan={x:l.x,y:l.y},s.startZoom=e.zoom()}this.length=1,this[0]=this},zc=$5.prototype;Qe(zc,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var r,n=e.target._private.animation;e.queue?r=n.queue:r=n.current,r.push(this),Ai(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return e.progress===1&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var r=this._private;return e===void 0?r.progress*r.duration:this.progress(e/r.duration)},progress:function(e){var r=this._private,n=r.playing;return e===void 0?r.progress:(n&&this.pause(),r.progress=e,r.started=!1,n&&this.play(),this)},completed:function(){return this._private.progress===1},reverse:function(){var e=this._private,r=e.playing;r&&this.pause(),e.progress=1-e.progress,e.started=!1;var n=function(c,u){var f=e[c];f!=null&&(e[c]=e[u],e[u]=f)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),e.style)for(var i=0;i<e.style.length;i++){var a=e.style[i],s=a.name,o=e.startStyle[s];e.startStyle[s]=a,e.style[i]=o}return r&&this.play(),this},promise:function(e){var r=this._private,n;switch(e){case"frame":n=r.frames;break;default:case"complete":case"completed":n=r.completes}return new nf(function(i,a){n.push(function(){i()})})}});zc.complete=zc.completed;zc.run=zc.play;zc.running=zc.playing;var oH={animated:function(){return function(){var r=this,n=r.length!==void 0,i=n?r:[r],a=this._private.cy||this;if(!a.styleEnabled())return!1;var s=i[0];if(s)return s._private.animation.current.length>0}},clearQueue:function(){return function(){var r=this,n=r.length!==void 0,i=n?r:[r],a=this._private.cy||this;if(!a.styleEnabled())return this;for(var s=0;s<i.length;s++){var o=i[s];o._private.animation.queue=[]}return this}},delay:function(){return function(r,n){var i=this._private.cy||this;return i.styleEnabled()?this.animate({delay:r,duration:r,complete:n}):this}},delayAnimation:function(){return function(r,n){var i=this._private.cy||this;return i.styleEnabled()?this.animation({delay:r,duration:r,complete:n}):this}},animation:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this,l=!a,c=!l;if(!o.styleEnabled())return this;var u=o.style();r=Qe({},r,n);var f=Object.keys(r).length===0;if(f)return new $5(s[0],r);switch(r.duration===void 0&&(r.duration=400),r.duration){case"slow":r.duration=600;break;case"fast":r.duration=200;break}if(c&&(r.style=u.getPropsList(r.style||r.css),r.css=void 0),c&&r.renderedPosition!=null){var h=r.renderedPosition,m=o.pan(),v=o.zoom();r.position=JA(h,v,m)}if(l&&r.panBy!=null){var y=r.panBy,x=o.pan();r.pan={x:x.x+y.x,y:x.y+y.y}}var b=r.center||r.centre;if(l&&b!=null){var S=o.getCenterPan(b.eles,r.zoom);S!=null&&(r.pan=S)}if(l&&r.fit!=null){var w=r.fit,k=o.getFitViewport(w.eles||w.boundingBox,w.padding);k!=null&&(r.pan=k.pan,r.zoom=k.zoom)}if(l&&Mt(r.zoom)){var N=o.getZoomedViewport(r.zoom);N!=null?(N.zoomed&&(r.zoom=N.zoom),N.panned&&(r.pan=N.pan)):r.zoom=null}return new $5(s[0],r)}},animate:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;n&&(r=Qe({},r,n));for(var l=0;l<s.length;l++){var c=s[l],u=c.animated()&&(r.queue===void 0||r.queue),f=c.animation(r,u?{queue:!0}:void 0);f.play()}return this}},stop:function(){return function(r,n){var i=this,a=i.length!==void 0,s=a?i:[i],o=this._private.cy||this;if(!o.styleEnabled())return this;for(var l=0;l<s.length;l++){for(var c=s[l],u=c._private,f=u.animation.current,h=0;h<f.length;h++){var m=f[h],v=m._private;n&&(v.duration=0)}r&&(u.animation.queue=[]),n||(u.animation.current=[])}return o.notify("draw"),this}}},Rw,g6;function rx(){if(g6)return Rw;g6=1;var t=Array.isArray;return Rw=t,Rw}var Dw,v6;function lH(){if(v6)return Dw;v6=1;var t=rx(),e=rm(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(t(a))return!1;var o=typeof a;return o=="number"||o=="symbol"||o=="boolean"||a==null||e(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return Dw=i,Dw}var Ow,y6;function cH(){if(y6)return Ow;y6=1;var t=UA(),e=tm(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(o){if(!e(o))return!1;var l=t(o);return l==n||l==i||l==r||l==a}return Ow=s,Ow}var Iw,x6;function uH(){if(x6)return Iw;x6=1;var t=Jy(),e=t["__core-js_shared__"];return Iw=e,Iw}var Lw,b6;function dH(){if(b6)return Lw;b6=1;var t=uH(),e=function(){var n=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function r(n){return!!e&&e in n}return Lw=r,Lw}var Bw,w6;function fH(){if(w6)return Bw;w6=1;var t=Function.prototype,e=t.toString;function r(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return Bw=r,Bw}var Fw,S6;function hH(){if(S6)return Fw;S6=1;var t=cH(),e=dH(),r=tm(),n=fH(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,o=Object.prototype,l=s.toString,c=o.hasOwnProperty,u=RegExp("^"+l.call(c).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(h){if(!r(h)||e(h))return!1;var m=t(h)?u:a;return m.test(n(h))}return Fw=f,Fw}var zw,k6;function pH(){if(k6)return zw;k6=1;function t(e,r){return e==null?void 0:e[r]}return zw=t,zw}var Vw,C6;function s3(){if(C6)return Vw;C6=1;var t=hH(),e=pH();function r(n,i){var a=e(n,i);return t(a)?a:void 0}return Vw=r,Vw}var $w,N6;function nx(){if(N6)return $w;N6=1;var t=s3(),e=t(Object,"create");return $w=e,$w}var Uw,E6;function mH(){if(E6)return Uw;E6=1;var t=nx();function e(){this.__data__=t?t(null):{},this.size=0}return Uw=e,Uw}var Gw,T6;function gH(){if(T6)return Gw;T6=1;function t(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}return Gw=t,Gw}var Hw,j6;function vH(){if(j6)return Hw;j6=1;var t=nx(),e="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(t){var o=s[a];return o===e?void 0:o}return n.call(s,a)?s[a]:void 0}return Hw=i,Hw}var Ww,M6;function yH(){if(M6)return Ww;M6=1;var t=nx(),e=Object.prototype,r=e.hasOwnProperty;function n(i){var a=this.__data__;return t?a[i]!==void 0:r.call(a,i)}return Ww=n,Ww}var qw,P6;function xH(){if(P6)return qw;P6=1;var t=nx(),e="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=t&&i===void 0?e:i,this}return qw=r,qw}var Kw,_6;function bH(){if(_6)return Kw;_6=1;var t=mH(),e=gH(),r=vH(),n=yH(),i=xH();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,Kw=a,Kw}var Yw,A6;function wH(){if(A6)return Yw;A6=1;function t(){this.__data__=[],this.size=0}return Yw=t,Yw}var Xw,R6;function pR(){if(R6)return Xw;R6=1;function t(e,r){return e===r||e!==e&&r!==r}return Xw=t,Xw}var Qw,D6;function ix(){if(D6)return Qw;D6=1;var t=pR();function e(r,n){for(var i=r.length;i--;)if(t(r[i][0],n))return i;return-1}return Qw=e,Qw}var Jw,O6;function SH(){if(O6)return Jw;O6=1;var t=ix(),e=Array.prototype,r=e.splice;function n(i){var a=this.__data__,s=t(a,i);if(s<0)return!1;var o=a.length-1;return s==o?a.pop():r.call(a,s,1),--this.size,!0}return Jw=n,Jw}var Zw,I6;function kH(){if(I6)return Zw;I6=1;var t=ix();function e(r){var n=this.__data__,i=t(n,r);return i<0?void 0:n[i][1]}return Zw=e,Zw}var e2,L6;function CH(){if(L6)return e2;L6=1;var t=ix();function e(r){return t(this.__data__,r)>-1}return e2=e,e2}var t2,B6;function NH(){if(B6)return t2;B6=1;var t=ix();function e(r,n){var i=this.__data__,a=t(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return t2=e,t2}var r2,F6;function EH(){if(F6)return r2;F6=1;var t=wH(),e=SH(),r=kH(),n=CH(),i=NH();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,r2=a,r2}var n2,z6;function TH(){if(z6)return n2;z6=1;var t=s3(),e=Jy(),r=t(e,"Map");return n2=r,n2}var i2,V6;function jH(){if(V6)return i2;V6=1;var t=bH(),e=EH(),r=TH();function n(){this.size=0,this.__data__={hash:new t,map:new(r||e),string:new t}}return i2=n,i2}var a2,$6;function MH(){if($6)return a2;$6=1;function t(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}return a2=t,a2}var s2,U6;function ax(){if(U6)return s2;U6=1;var t=MH();function e(r,n){var i=r.__data__;return t(n)?i[typeof n=="string"?"string":"hash"]:i.map}return s2=e,s2}var o2,G6;function PH(){if(G6)return o2;G6=1;var t=ax();function e(r){var n=t(this,r).delete(r);return this.size-=n?1:0,n}return o2=e,o2}var l2,H6;function _H(){if(H6)return l2;H6=1;var t=ax();function e(r){return t(this,r).get(r)}return l2=e,l2}var c2,W6;function AH(){if(W6)return c2;W6=1;var t=ax();function e(r){return t(this,r).has(r)}return c2=e,c2}var u2,q6;function RH(){if(q6)return u2;q6=1;var t=ax();function e(r,n){var i=t(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return u2=e,u2}var d2,K6;function DH(){if(K6)return d2;K6=1;var t=jH(),e=PH(),r=_H(),n=AH(),i=RH();function a(s){var o=-1,l=s==null?0:s.length;for(this.clear();++o<l;){var c=s[o];this.set(c[0],c[1])}}return a.prototype.clear=t,a.prototype.delete=e,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,d2=a,d2}var f2,Y6;function OH(){if(Y6)return f2;Y6=1;var t=DH(),e="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(e);var a=function(){var s=arguments,o=i?i.apply(this,s):s[0],l=a.cache;if(l.has(o))return l.get(o);var c=n.apply(this,s);return a.cache=l.set(o,c)||l,c};return a.cache=new(r.Cache||t),a}return r.Cache=t,f2=r,f2}var h2,X6;function IH(){if(X6)return h2;X6=1;var t=OH(),e=500;function r(n){var i=t(n,function(s){return a.size===e&&a.clear(),s}),a=i.cache;return i}return h2=r,h2}var p2,Q6;function mR(){if(Q6)return p2;Q6=1;var t=IH(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=t(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(e,function(s,o,l,c){a.push(l?c.replace(r,"$1"):o||s)}),a});return p2=n,p2}var m2,J6;function gR(){if(J6)return m2;J6=1;function t(e,r){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=r(e[n],n,e);return a}return m2=t,m2}var g2,Z6;function LH(){if(Z6)return g2;Z6=1;var t=QC(),e=gR(),r=rx(),n=rm(),i=t?t.prototype:void 0,a=i?i.toString:void 0;function s(o){if(typeof o=="string")return o;if(r(o))return e(o,s)+"";if(n(o))return a?a.call(o):"";var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return g2=s,g2}var v2,e8;function vR(){if(e8)return v2;e8=1;var t=LH();function e(r){return r==null?"":t(r)}return v2=e,v2}var y2,t8;function yR(){if(t8)return y2;t8=1;var t=rx(),e=lH(),r=mR(),n=vR();function i(a,s){return t(a)?a:e(a,s)?[a]:r(n(a))}return y2=i,y2}var x2,r8;function o3(){if(r8)return x2;r8=1;var t=rm();function e(r){if(typeof r=="string"||t(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return x2=e,x2}var b2,n8;function BH(){if(n8)return b2;n8=1;var t=yR(),e=o3();function r(n,i){i=t(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[e(i[a++])];return a&&a==s?n:void 0}return b2=r,b2}var w2,i8;function FH(){if(i8)return w2;i8=1;var t=BH();function e(r,n,i){var a=r==null?void 0:t(r,n);return a===void 0?i:a}return w2=e,w2}var zH=FH(),VH=em(zH),S2,a8;function $H(){if(a8)return S2;a8=1;var t=s3(),e=function(){try{var r=t(Object,"defineProperty");return r({},"",{}),r}catch{}}();return S2=e,S2}var k2,s8;function UH(){if(s8)return k2;s8=1;var t=$H();function e(r,n,i){n=="__proto__"&&t?t(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return k2=e,k2}var C2,o8;function GH(){if(o8)return C2;o8=1;var t=UH(),e=pR(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,o){var l=a[s];(!(n.call(a,s)&&e(l,o))||o===void 0&&!(s in a))&&t(a,s,o)}return C2=i,C2}var N2,l8;function HH(){if(l8)return N2;l8=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??t,!!i&&(a=="number"||a!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return N2=r,N2}var E2,c8;function WH(){if(c8)return E2;c8=1;var t=GH(),e=yR(),r=HH(),n=tm(),i=o3();function a(s,o,l,c){if(!n(s))return s;o=e(o,s);for(var u=-1,f=o.length,h=f-1,m=s;m!=null&&++u<f;){var v=i(o[u]),y=l;if(v==="__proto__"||v==="constructor"||v==="prototype")return s;if(u!=h){var x=m[v];y=c?c(x,v,m):void 0,y===void 0&&(y=n(x)?x:r(o[u+1])?[]:{})}t(m,v,y),m=m[v]}return s}return E2=a,E2}var T2,u8;function qH(){if(u8)return T2;u8=1;var t=WH();function e(r,n,i){return r==null?r:t(r,n,i)}return T2=e,T2}var KH=qH(),YH=em(KH),j2,d8;function XH(){if(d8)return j2;d8=1;function t(e,r){var n=-1,i=e.length;for(r||(r=Array(i));++n<i;)r[n]=e[n];return r}return j2=t,j2}var M2,f8;function QH(){if(f8)return M2;f8=1;var t=gR(),e=XH(),r=rx(),n=rm(),i=mR(),a=o3(),s=vR();function o(l){return r(l)?t(l,a):n(l)?[l]:e(i(s(l)))}return M2=o,M2}var JH=QH(),ZH=em(JH),eW={data:function(e){var r={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(i){},beforeSet:function(i,a){},onSet:function(i){},canSet:function(i){return!0}};return e=Qe({},r,e),function(i,a){var s=e,o=this,l=o.length!==void 0,c=l?o:[o],u=l?o[0]:o;if(Ke(i)){var f=i.indexOf(".")!==-1,h=f&&ZH(i);if(s.allowGetting&&a===void 0){var m;return u&&(s.beforeGet(u),h&&u._private[s.field][i]===void 0?m=VH(u._private[s.field],h):m=u._private[s.field][i]),m}else if(s.allowSetting&&a!==void 0){var v=!s.immutableKeys[i];if(v){var y=RA({},i,a);s.beforeSet(o,y);for(var x=0,b=c.length;x<b;x++){var S=c[x];s.canSet(S)&&(h&&u._private[s.field][i]===void 0?YH(S._private[s.field],h,a):S._private[s.field][i]=a)}s.updateStyle&&o.updateStyle(),s.onSet(o),s.settingTriggersEvent&&o[s.triggerFnName](s.settingEvent)}}}else if(s.allowSetting&&Mt(i)){var w=i,k,N,j=Object.keys(w);s.beforeSet(o,w);for(var T=0;T<j.length;T++){k=j[T],N=w[k];var M=!s.immutableKeys[k];if(M)for(var A=0;A<c.length;A++){var _=c[A];s.canSet(_)&&(_._private[s.field][k]=N)}}s.updateStyle&&o.updateStyle(),s.onSet(o),s.settingTriggersEvent&&o[s.triggerFnName](s.settingEvent)}else if(s.allowBinding&&vr(i)){var D=i;o.on(s.bindingEvent,D)}else if(s.allowGetting&&i===void 0){var R;return u&&(s.beforeGet(u),R=u._private[s.field]),R}return o}},removeData:function(e){var r={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return e=Qe({},r,e),function(i){var a=e,s=this,o=s.length!==void 0,l=o?s:[s];if(Ke(i)){for(var c=i.split(/\s+/),u=c.length,f=0;f<u;f++){var h=c[f];if(!ml(h)){var m=!a.immutableKeys[h];if(m)for(var v=0,y=l.length;v<y;v++)l[v]._private[a.field][h]=void 0}}a.triggerEvent&&s[a.triggerFnName](a.event)}else if(i===void 0){for(var x=0,b=l.length;x<b;x++)for(var S=l[x]._private[a.field],w=Object.keys(S),k=0;k<w.length;k++){var N=w[k],j=!a.immutableKeys[N];j&&(S[N]=void 0)}a.triggerEvent&&s[a.triggerFnName](a.event)}return s}}},tW={eventAliasesOn:function(e){var r=e;r.addListener=r.listen=r.bind=r.on,r.unlisten=r.unbind=r.off=r.removeListener,r.trigger=r.emit,r.pon=r.promiseOn=function(n,i){var a=this,s=Array.prototype.slice.call(arguments,0);return new nf(function(o,l){var c=function(m){a.off.apply(a,f),o(m)},u=s.concat([c]),f=u.concat([]);a.on.apply(a,u)})}}},It={};[oH,eW,tW].forEach(function(t){Qe(It,t)});var rW={animate:It.animate(),animation:It.animation(),animated:It.animated(),clearQueue:It.clearQueue(),delay:It.delay(),delayAnimation:It.delayAnimation(),stop:It.stop()},Pv={classes:function(e){var r=this;if(e===void 0){var n=[];return r[0]._private.classes.forEach(function(v){return n.push(v)}),n}else Ht(e)||(e=(e||"").match(/\S+/g)||[]);for(var i=[],a=new rf(e),s=0;s<r.length;s++){for(var o=r[s],l=o._private,c=l.classes,u=!1,f=0;f<e.length;f++){var h=e[f],m=c.has(h);if(!m){u=!0;break}}u||(u=c.size!==e.length),u&&(l.classes=a,i.push(o))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),r},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var r=this[0];return r!=null&&r._private.classes.has(e)},toggleClass:function(e,r){Ht(e)||(e=e.match(/\S+/g)||[]);for(var n=this,i=r===void 0,a=[],s=0,o=n.length;s<o;s++)for(var l=n[s],c=l._private.classes,u=!1,f=0;f<e.length;f++){var h=e[f],m=c.has(h),v=!1;r||i&&!m?(c.add(h),v=!0):(!r||i&&m)&&(c.delete(h),v=!0),!u&&v&&(a.push(l),u=!0)}return a.length>0&&this.spawn(a).updateStyle().emit("class"),n},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,r){var n=this;if(r==null)r=250;else if(r===0)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},r),n}};Pv.className=Pv.classNames=Pv.classes;var Tt={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number:Jr,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};Tt.variable="(?:[\\w-.]|(?:\\\\"+Tt.metaChar+"))+";Tt.className="(?:[\\w-]|(?:\\\\"+Tt.metaChar+"))+";Tt.value=Tt.string+"|"+Tt.number;Tt.id=Tt.variable;(function(){var t,e,r;for(t=Tt.comparatorOp.split("|"),r=0;r<t.length;r++)e=t[r],Tt.comparatorOp+="|@"+e;for(t=Tt.comparatorOp.split("|"),r=0;r<t.length;r++)e=t[r],!(e.indexOf("!")>=0)&&e!=="="&&(Tt.comparatorOp+="|\\!"+e)})();var zt=function(){return{checks:[]}},Fe={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},U5=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort(function(t,e){return eU(t.selector,e.selector)}),nW=function(){for(var t={},e,r=0;r<U5.length;r++)e=U5[r],t[e.selector]=e.matches;return t}(),iW=function(e,r){return nW[e](r)},aW="("+U5.map(function(t){return t.selector}).join("|")+")",ju=function(e){return e.replace(new RegExp("\\\\("+Tt.metaChar+")","g"),function(r,n){return n})},jo=function(e,r,n){e[e.length-1]=n},G5=[{name:"group",query:!0,regex:"("+Tt.group+")",populate:function(e,r,n){var i=zr(n,1),a=i[0];r.checks.push({type:Fe.GROUP,value:a==="*"?a:a+"s"})}},{name:"state",query:!0,regex:aW,populate:function(e,r,n){var i=zr(n,1),a=i[0];r.checks.push({type:Fe.STATE,value:a})}},{name:"id",query:!0,regex:"\\#("+Tt.id+")",populate:function(e,r,n){var i=zr(n,1),a=i[0];r.checks.push({type:Fe.ID,value:ju(a)})}},{name:"className",query:!0,regex:"\\.("+Tt.className+")",populate:function(e,r,n){var i=zr(n,1),a=i[0];r.checks.push({type:Fe.CLASS,value:ju(a)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+Tt.variable+")\\s*\\]",populate:function(e,r,n){var i=zr(n,1),a=i[0];r.checks.push({type:Fe.DATA_EXIST,field:ju(a)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+Tt.variable+")\\s*("+Tt.comparatorOp+")\\s*("+Tt.value+")\\s*\\]",populate:function(e,r,n){var i=zr(n,3),a=i[0],s=i[1],o=i[2],l=new RegExp("^"+Tt.string+"$").exec(o)!=null;l?o=o.substring(1,o.length-1):o=parseFloat(o),r.checks.push({type:Fe.DATA_COMPARE,field:ju(a),operator:s,value:o})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+Tt.boolOp+")\\s*("+Tt.variable+")\\s*\\]",populate:function(e,r,n){var i=zr(n,2),a=i[0],s=i[1];r.checks.push({type:Fe.DATA_BOOL,field:ju(s),operator:a})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+Tt.meta+")\\s*("+Tt.comparatorOp+")\\s*("+Tt.number+")\\s*\\]\\]",populate:function(e,r,n){var i=zr(n,3),a=i[0],s=i[1],o=i[2];r.checks.push({type:Fe.META_COMPARE,field:ju(a),operator:s,value:parseFloat(o)})}},{name:"nextQuery",separator:!0,regex:Tt.separator,populate:function(e,r){var n=e.currentSubject,i=e.edgeCount,a=e.compoundCount,s=e[e.length-1];n!=null&&(s.subject=n,e.currentSubject=null),s.edgeCount=i,s.compoundCount=a,e.edgeCount=0,e.compoundCount=0;var o=e[e.length++]=zt();return o}},{name:"directedEdge",separator:!0,regex:Tt.directedEdge,populate:function(e,r){if(e.currentSubject==null){var n=zt(),i=r,a=zt();return n.checks.push({type:Fe.DIRECTED_EDGE,source:i,target:a}),jo(e,r,n),e.edgeCount++,a}else{var s=zt(),o=r,l=zt();return s.checks.push({type:Fe.NODE_SOURCE,source:o,target:l}),jo(e,r,s),e.edgeCount++,l}}},{name:"undirectedEdge",separator:!0,regex:Tt.undirectedEdge,populate:function(e,r){if(e.currentSubject==null){var n=zt(),i=r,a=zt();return n.checks.push({type:Fe.UNDIRECTED_EDGE,nodes:[i,a]}),jo(e,r,n),e.edgeCount++,a}else{var s=zt(),o=r,l=zt();return s.checks.push({type:Fe.NODE_NEIGHBOR,node:o,neighbor:l}),jo(e,r,s),l}}},{name:"child",separator:!0,regex:Tt.child,populate:function(e,r){if(e.currentSubject==null){var n=zt(),i=zt(),a=e[e.length-1];return n.checks.push({type:Fe.CHILD,parent:a,child:i}),jo(e,r,n),e.compoundCount++,i}else if(e.currentSubject===r){var s=zt(),o=e[e.length-1],l=zt(),c=zt(),u=zt(),f=zt();return s.checks.push({type:Fe.COMPOUND_SPLIT,left:o,right:l,subject:c}),c.checks=r.checks,r.checks=[{type:Fe.TRUE}],f.checks.push({type:Fe.TRUE}),l.checks.push({type:Fe.PARENT,parent:f,child:u}),jo(e,o,s),e.currentSubject=c,e.compoundCount++,u}else{var h=zt(),m=zt(),v=[{type:Fe.PARENT,parent:h,child:m}];return h.checks=r.checks,r.checks=v,e.compoundCount++,m}}},{name:"descendant",separator:!0,regex:Tt.descendant,populate:function(e,r){if(e.currentSubject==null){var n=zt(),i=zt(),a=e[e.length-1];return n.checks.push({type:Fe.DESCENDANT,ancestor:a,descendant:i}),jo(e,r,n),e.compoundCount++,i}else if(e.currentSubject===r){var s=zt(),o=e[e.length-1],l=zt(),c=zt(),u=zt(),f=zt();return s.checks.push({type:Fe.COMPOUND_SPLIT,left:o,right:l,subject:c}),c.checks=r.checks,r.checks=[{type:Fe.TRUE}],f.checks.push({type:Fe.TRUE}),l.checks.push({type:Fe.ANCESTOR,ancestor:f,descendant:u}),jo(e,o,s),e.currentSubject=c,e.compoundCount++,u}else{var h=zt(),m=zt(),v=[{type:Fe.ANCESTOR,ancestor:h,descendant:m}];return h.checks=r.checks,r.checks=v,e.compoundCount++,m}}},{name:"subject",modifier:!0,regex:Tt.subject,populate:function(e,r){if(e.currentSubject!=null&&e.currentSubject!==r)return Lt("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=r;var n=e[e.length-1],i=n.checks[0],a=i==null?null:i.type;a===Fe.DIRECTED_EDGE?i.type=Fe.NODE_TARGET:a===Fe.UNDIRECTED_EDGE&&(i.type=Fe.NODE_NEIGHBOR,i.node=i.nodes[1],i.neighbor=i.nodes[0],i.nodes=null)}}];G5.forEach(function(t){return t.regexObj=new RegExp("^"+t.regex)});var sW=function(e){for(var r,n,i,a=0;a<G5.length;a++){var s=G5[a],o=s.name,l=e.match(s.regexObj);if(l!=null){n=l,r=s,i=o;var c=l[0];e=e.substring(c.length);break}}return{expr:r,match:n,name:i,remaining:e}},oW=function(e){var r=e.match(/^\s+/);if(r){var n=r[0];e=e.substring(n.length)}return e},lW=function(e){var r=this,n=r.inputText=e,i=r[0]=zt();for(r.length=1,n=oW(n);;){var a=sW(n);if(a.expr==null)return Lt("The selector `"+e+"`is invalid"),!1;var s=a.match.slice(1),o=a.expr.populate(r,i,s);if(o===!1)return!1;if(o!=null&&(i=o),n=a.remaining,n.match(/^\s*$/))break}var l=r[r.length-1];r.currentSubject!=null&&(l.subject=r.currentSubject),l.edgeCount=r.edgeCount,l.compoundCount=r.compoundCount;for(var c=0;c<r.length;c++){var u=r[c];if(u.compoundCount>0&&u.edgeCount>0)return Lt("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(u.edgeCount>1)return Lt("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;u.edgeCount===1&&Lt("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},cW=function(){if(this.toStringCache!=null)return this.toStringCache;for(var e=function(u){return u??""},r=function(u){return Ke(u)?'"'+u+'"':e(u)},n=function(u){return" "+u+" "},i=function(u,f){var h=u.type,m=u.value;switch(h){case Fe.GROUP:{var v=e(m);return v.substring(0,v.length-1)}case Fe.DATA_COMPARE:{var y=u.field,x=u.operator;return"["+y+n(e(x))+r(m)+"]"}case Fe.DATA_BOOL:{var b=u.operator,S=u.field;return"["+e(b)+S+"]"}case Fe.DATA_EXIST:{var w=u.field;return"["+w+"]"}case Fe.META_COMPARE:{var k=u.operator,N=u.field;return"[["+N+n(e(k))+r(m)+"]]"}case Fe.STATE:return m;case Fe.ID:return"#"+m;case Fe.CLASS:return"."+m;case Fe.PARENT:case Fe.CHILD:return a(u.parent,f)+n(">")+a(u.child,f);case Fe.ANCESTOR:case Fe.DESCENDANT:return a(u.ancestor,f)+" "+a(u.descendant,f);case Fe.COMPOUND_SPLIT:{var j=a(u.left,f),T=a(u.subject,f),M=a(u.right,f);return j+(j.length>0?" ":"")+T+M}case Fe.TRUE:return""}},a=function(u,f){return u.checks.reduce(function(h,m,v){return h+(f===u&&v===0?"$":"")+i(m,f)},"")},s="",o=0;o<this.length;o++){var l=this[o];s+=a(l,l.subject),this.length>1&&o<this.length-1&&(s+=", ")}return this.toStringCache=s,s},uW={parse:lW,toString:cW},xR=function(e,r,n){var i,a=Ke(e),s=Ee(e),o=Ke(n),l,c,u=!1,f=!1,h=!1;switch(r.indexOf("!")>=0&&(r=r.replace("!",""),f=!0),r.indexOf("@")>=0&&(r=r.replace("@",""),u=!0),(a||o||u)&&(l=!a&&!s?"":""+e,c=""+n),u&&(e=l=l.toLowerCase(),n=c=c.toLowerCase()),r){case"*=":i=l.indexOf(c)>=0;break;case"$=":i=l.indexOf(c,l.length-c.length)>=0;break;case"^=":i=l.indexOf(c)===0;break;case"=":i=e===n;break;case">":h=!0,i=e>n;break;case">=":h=!0,i=e>=n;break;case"<":h=!0,i=e<n;break;case"<=":h=!0,i=e<=n;break;default:i=!1;break}return f&&(e!=null||!h)&&(i=!i),i},dW=function(e,r){switch(r){case"?":return!!e;case"!":return!e;case"^":return e===void 0}},fW=function(e){return e!==void 0},l3=function(e,r){return e.data(r)},hW=function(e,r){return e[r]()},jr=[],nr=function(e,r){return e.checks.every(function(n){return jr[n.type](n,r)})};jr[Fe.GROUP]=function(t,e){var r=t.value;return r==="*"||r===e.group()};jr[Fe.STATE]=function(t,e){var r=t.value;return iW(r,e)};jr[Fe.ID]=function(t,e){var r=t.value;return e.id()===r};jr[Fe.CLASS]=function(t,e){var r=t.value;return e.hasClass(r)};jr[Fe.META_COMPARE]=function(t,e){var r=t.field,n=t.operator,i=t.value;return xR(hW(e,r),n,i)};jr[Fe.DATA_COMPARE]=function(t,e){var r=t.field,n=t.operator,i=t.value;return xR(l3(e,r),n,i)};jr[Fe.DATA_BOOL]=function(t,e){var r=t.field,n=t.operator;return dW(l3(e,r),n)};jr[Fe.DATA_EXIST]=function(t,e){var r=t.field;return t.operator,fW(l3(e,r))};jr[Fe.UNDIRECTED_EDGE]=function(t,e){var r=t.nodes[0],n=t.nodes[1],i=e.source(),a=e.target();return nr(r,i)&&nr(n,a)||nr(n,i)&&nr(r,a)};jr[Fe.NODE_NEIGHBOR]=function(t,e){return nr(t.node,e)&&e.neighborhood().some(function(r){return r.isNode()&&nr(t.neighbor,r)})};jr[Fe.DIRECTED_EDGE]=function(t,e){return nr(t.source,e.source())&&nr(t.target,e.target())};jr[Fe.NODE_SOURCE]=function(t,e){return nr(t.source,e)&&e.outgoers().some(function(r){return r.isNode()&&nr(t.target,r)})};jr[Fe.NODE_TARGET]=function(t,e){return nr(t.target,e)&&e.incomers().some(function(r){return r.isNode()&&nr(t.source,r)})};jr[Fe.CHILD]=function(t,e){return nr(t.child,e)&&nr(t.parent,e.parent())};jr[Fe.PARENT]=function(t,e){return nr(t.parent,e)&&e.children().some(function(r){return nr(t.child,r)})};jr[Fe.DESCENDANT]=function(t,e){return nr(t.descendant,e)&&e.ancestors().some(function(r){return nr(t.ancestor,r)})};jr[Fe.ANCESTOR]=function(t,e){return nr(t.ancestor,e)&&e.descendants().some(function(r){return nr(t.descendant,r)})};jr[Fe.COMPOUND_SPLIT]=function(t,e){return nr(t.subject,e)&&nr(t.left,e)&&nr(t.right,e)};jr[Fe.TRUE]=function(){return!0};jr[Fe.COLLECTION]=function(t,e){var r=t.value;return r.has(e)};jr[Fe.FILTER]=function(t,e){var r=t.value;return r(e)};var pW=function(e){var r=this;if(r.length===1&&r[0].checks.length===1&&r[0].checks[0].type===Fe.ID)return e.getElementById(r[0].checks[0].value).collection();var n=function(a){for(var s=0;s<r.length;s++){var o=r[s];if(nr(o,a))return!0}return!1};return r.text()==null&&(n=function(){return!0}),e.filter(n)},mW=function(e){for(var r=this,n=0;n<r.length;n++){var i=r[n];if(nr(i,e))return!0}return!1},gW={matches:mW,filter:pW},yl=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,e==null||Ke(e)&&e.match(/^\s*$/)||(Ai(e)?this.addQuery({checks:[{type:Fe.COLLECTION,value:e.collection()}]}):vr(e)?this.addQuery({checks:[{type:Fe.FILTER,value:e}]}):Ke(e)?this.parse(e)||(this.invalid=!0):lr("A selector must be created from a string; found "))},xl=yl.prototype;[uW,gW].forEach(function(t){return Qe(xl,t)});xl.text=function(){return this.inputText};xl.size=function(){return this.length};xl.eq=function(t){return this[t]};xl.sameText=function(t){return!this.invalid&&!t.invalid&&this.text()===t.text()};xl.addQuery=function(t){this[this.length++]=t};xl.selector=xl.toString;var ol={allAre:function(e){var r=new yl(e);return this.every(function(n){return r.matches(n)})},is:function(e){var r=new yl(e);return this.some(function(n){return r.matches(n)})},some:function(e,r){for(var n=0;n<this.length;n++){var i=r?e.apply(r,[this[n],n,this]):e(this[n],n,this);if(i)return!0}return!1},every:function(e,r){for(var n=0;n<this.length;n++){var i=r?e.apply(r,[this[n],n,this]):e(this[n],n,this);if(!i)return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var r=this.length,n=e.length;return r!==n?!1:r===1?this[0]===e[0]:this.every(function(i){return e.hasElementWithId(i.id())})},anySame:function(e){return e=this.cy().collection(e),this.some(function(r){return e.hasElementWithId(r.id())})},allAreNeighbors:function(e){e=this.cy().collection(e);var r=this.neighborhood();return e.every(function(n){return r.hasElementWithId(n.id())})},contains:function(e){e=this.cy().collection(e);var r=this;return e.every(function(n){return r.hasElementWithId(n.id())})}};ol.allAreNeighbours=ol.allAreNeighbors;ol.has=ol.contains;ol.equal=ol.equals=ol.same;var ia=function(e,r){return function(i,a,s,o){var l=i,c=this,u;if(l==null?u="":Ai(l)&&l.length===1&&(u=l.id()),c.length===1&&u){var f=c[0]._private,h=f.traversalCache=f.traversalCache||{},m=h[r]=h[r]||[],v=Bc(u),y=m[v];return y||(m[v]=e.call(c,i,a,s,o))}else return e.call(c,i,a,s,o)}},Od={parent:function(e){var r=[];if(this.length===1){var n=this[0]._private.parent;if(n)return n}for(var i=0;i<this.length;i++){var a=this[i],s=a._private.parent;s&&r.push(s)}return this.spawn(r,!0).filter(e)},parents:function(e){for(var r=[],n=this.parent();n.nonempty();){for(var i=0;i<n.length;i++){var a=n[i];r.push(a)}n=n.parent()}return this.spawn(r,!0).filter(e)},commonAncestors:function(e){for(var r,n=0;n<this.length;n++){var i=this[n],a=i.parents();r=r||a,r=r.intersect(a)}return r.filter(e)},orphans:function(e){return this.stdFilter(function(r){return r.isOrphan()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(r){return r.isChild()}).filter(e)},children:ia(function(t){for(var e=[],r=0;r<this.length;r++)for(var n=this[r],i=n._private.children,a=0;a<i.length;a++)e.push(i[a]);return this.spawn(e,!0).filter(t)},"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length!==0},isChildless:function(){var e=this[0];if(e)return e.isNode()&&e._private.children.length===0},isChild:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent!=null},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&e._private.parent==null},descendants:function(e){var r=[];function n(i){for(var a=0;a<i.length;a++){var s=i[a];r.push(s),s.children().nonempty()&&n(s.children())}}return n(this.children()),this.spawn(r,!0).filter(e)}};function c3(t,e,r,n){for(var i=[],a=new rf,s=t.cy(),o=s.hasCompoundNodes(),l=0;l<t.length;l++){var c=t[l];r?i.push(c):o&&n(i,a,c)}for(;i.length>0;){var u=i.shift();e(u),a.add(u.id()),o&&n(i,a,u)}return t}function bR(t,e,r){if(r.isParent())for(var n=r._private.children,i=0;i<n.length;i++){var a=n[i];e.has(a.id())||t.push(a)}}Od.forEachDown=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return c3(this,t,e,bR)};function wR(t,e,r){if(r.isChild()){var n=r._private.parent;e.has(n.id())||t.push(n)}}Od.forEachUp=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return c3(this,t,e,wR)};function vW(t,e,r){wR(t,e,r),bR(t,e,r)}Od.forEachUpAndDown=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return c3(this,t,e,vW)};Od.ancestors=Od.parents;var kp,SR;kp=SR={data:It.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:It.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:It.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:It.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:It.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:It.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}};kp.attr=kp.data;kp.removeAttr=kp.removeData;var yW=SR,sx={};function P2(t){return function(e){var r=this;if(e===void 0&&(e=!0),r.length!==0)if(r.isNode()&&!r.removed()){for(var n=0,i=r[0],a=i._private.edges,s=0;s<a.length;s++){var o=a[s];!e&&o.isLoop()||(n+=t(i,o))}return n}else return}}Qe(sx,{degree:P2(function(t,e){return e.source().same(e.target())?2:1}),indegree:P2(function(t,e){return e.target().same(t)?1:0}),outdegree:P2(function(t,e){return e.source().same(t)?1:0})});function Mu(t,e){return function(r){for(var n,i=this.nodes(),a=0;a<i.length;a++){var s=i[a],o=s[t](r);o!==void 0&&(n===void 0||e(o,n))&&(n=o)}return n}}Qe(sx,{minDegree:Mu("degree",function(t,e){return t<e}),maxDegree:Mu("degree",function(t,e){return t>e}),minIndegree:Mu("indegree",function(t,e){return t<e}),maxIndegree:Mu("indegree",function(t,e){return t>e}),minOutdegree:Mu("outdegree",function(t,e){return t<e}),maxOutdegree:Mu("outdegree",function(t,e){return t>e})});Qe(sx,{totalDegree:function(e){for(var r=0,n=this.nodes(),i=0;i<n.length;i++)r+=n[i].degree(e);return r}});var Da,kR,CR=function(e,r,n){for(var i=0;i<e.length;i++){var a=e[i];if(!a.locked()){var s=a._private.position,o={x:r.x!=null?r.x-s.x:0,y:r.y!=null?r.y-s.y:0};a.isParent()&&!(o.x===0&&o.y===0)&&a.children().shift(o,n),a.dirtyBoundingBoxCache()}}},h8={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,r){CR(e,r,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};Da=kR={position:It.data(h8),silentPosition:It.data(Qe({},h8,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,r){CR(e,r,!0)},onSet:function(e){e.dirtyCompoundBoundsCache()}})),positions:function(e,r){if(Mt(e))r?this.silentPosition(e):this.position(e);else if(vr(e)){var n=e,i=this.cy();i.startBatch();for(var a=0;a<this.length;a++){var s=this[a],o=void 0;(o=n(s,a))&&(r?s.silentPosition(o):s.position(o))}i.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,r,n){var i;if(Mt(e)?(i={x:Ee(e.x)?e.x:0,y:Ee(e.y)?e.y:0},n=r):Ke(e)&&Ee(r)&&(i={x:0,y:0},i[e]=r),i!=null){var a=this.cy();a.startBatch();for(var s=0;s<this.length;s++){var o=this[s];if(!(a.hasCompoundNodes()&&o.isChild()&&o.ancestors().anySame(this))){var l=o.position(),c={x:l.x+i.x,y:l.y+i.y};n?o.silentPosition(c):o.position(c)}}a.endBatch()}return this},silentShift:function(e,r){return Mt(e)?this.shift(e,!0):Ke(e)&&Ee(r)&&this.shift(e,r,!0),this},renderedPosition:function(e,r){var n=this[0],i=this.cy(),a=i.zoom(),s=i.pan(),o=Mt(e)?e:void 0,l=o!==void 0||r!==void 0&&Ke(e);if(n&&n.isNode())if(l)for(var c=0;c<this.length;c++){var u=this[c];r!==void 0?u.position(e,(r-s[e])/a):o!==void 0&&u.position(JA(o,a,s))}else{var f=n.position();return o=ex(f,a,s),e===void 0?o:o[e]}else if(!l)return;return this},relativePosition:function(e,r){var n=this[0],i=this.cy(),a=Mt(e)?e:void 0,s=a!==void 0||r!==void 0&&Ke(e),o=i.hasCompoundNodes();if(n&&n.isNode())if(s)for(var l=0;l<this.length;l++){var c=this[l],u=o?c.parent():null,f=u&&u.length>0,h=f;f&&(u=u[0]);var m=h?u.position():{x:0,y:0};r!==void 0?c.position(e,r+m[e]):a!==void 0&&c.position({x:a.x+m.x,y:a.y+m.y})}else{var v=n.position(),y=o?n.parent():null,x=y&&y.length>0,b=x;x&&(y=y[0]);var S=b?y.position():{x:0,y:0};return a={x:v.x-S.x,y:v.y-S.y},e===void 0?a:a[e]}else if(!s)return;return this}};Da.modelPosition=Da.point=Da.position;Da.modelPositions=Da.points=Da.positions;Da.renderedPoint=Da.renderedPosition;Da.relativePoint=Da.relativePosition;var xW=kR,wd,_l;wd=_l={};_l.renderedBoundingBox=function(t){var e=this.boundingBox(t),r=this.cy(),n=r.zoom(),i=r.pan(),a=e.x1*n+i.x,s=e.x2*n+i.x,o=e.y1*n+i.y,l=e.y2*n+i.y;return{x1:a,x2:s,y1:o,y2:l,w:s-a,h:l-o}};_l.dirtyCompoundBoundsCache=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();return!e.styleEnabled()||!e.hasCompoundNodes()?this:(this.forEachUp(function(r){if(r.isParent()){var n=r._private;n.compoundBoundsClean=!1,n.bbCache=null,t||r.emitAndNotify("bounds")}}),this)};_l.updateCompoundBounds=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!t&&e.batching())return this;function r(s){if(!s.isParent())return;var o=s._private,l=s.children(),c=s.pstyle("compound-sizing-wrt-labels").value==="include",u={width:{val:s.pstyle("min-width").pfValue,left:s.pstyle("min-width-bias-left"),right:s.pstyle("min-width-bias-right")},height:{val:s.pstyle("min-height").pfValue,top:s.pstyle("min-height-bias-top"),bottom:s.pstyle("min-height-bias-bottom")}},f=l.boundingBox({includeLabels:c,includeOverlays:!1,useCache:!1}),h=o.position;(f.w===0||f.h===0)&&(f={w:s.pstyle("width").pfValue,h:s.pstyle("height").pfValue},f.x1=h.x-f.w/2,f.x2=h.x+f.w/2,f.y1=h.y-f.h/2,f.y2=h.y+f.h/2);function m(A,_,D){var R=0,I=0,$=_+D;return A>0&&$>0&&(R=_/$*A,I=D/$*A),{biasDiff:R,biasComplementDiff:I}}function v(A,_,D,R){if(D.units==="%")switch(R){case"width":return A>0?D.pfValue*A:0;case"height":return _>0?D.pfValue*_:0;case"average":return A>0&&_>0?D.pfValue*(A+_)/2:0;case"min":return A>0&&_>0?A>_?D.pfValue*_:D.pfValue*A:0;case"max":return A>0&&_>0?A>_?D.pfValue*A:D.pfValue*_:0;default:return 0}else return D.units==="px"?D.pfValue:0}var y=u.width.left.value;u.width.left.units==="px"&&u.width.val>0&&(y=y*100/u.width.val);var x=u.width.right.value;u.width.right.units==="px"&&u.width.val>0&&(x=x*100/u.width.val);var b=u.height.top.value;u.height.top.units==="px"&&u.height.val>0&&(b=b*100/u.height.val);var S=u.height.bottom.value;u.height.bottom.units==="px"&&u.height.val>0&&(S=S*100/u.height.val);var w=m(u.width.val-f.w,y,x),k=w.biasDiff,N=w.biasComplementDiff,j=m(u.height.val-f.h,b,S),T=j.biasDiff,M=j.biasComplementDiff;o.autoPadding=v(f.w,f.h,s.pstyle("padding"),s.pstyle("padding-relative-to").value),o.autoWidth=Math.max(f.w,u.width.val),h.x=(-k+f.x1+f.x2+N)/2,o.autoHeight=Math.max(f.h,u.height.val),h.y=(-T+f.y1+f.y2+M)/2}for(var n=0;n<this.length;n++){var i=this[n],a=i._private;(!a.compoundBoundsClean||t)&&(r(i),e.batching()||(a.compoundBoundsClean=!0))}return this};var ta=function(e){return e===1/0||e===-1/0?0:e},Ta=function(e,r,n,i,a){i-r===0||a-n===0||r==null||n==null||i==null||a==null||(e.x1=r<e.x1?r:e.x1,e.x2=i>e.x2?i:e.x2,e.y1=n<e.y1?n:e.y1,e.y2=a>e.y2?a:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},Oo=function(e,r){return r==null?e:Ta(e,r.x1,r.y1,r.x2,r.y2)},Xf=function(e,r,n){return hi(e,r,n)},Lg=function(e,r,n){if(!r.cy().headless()){var i=r._private,a=i.rstyle,s=a.arrowWidth/2,o=r.pstyle(n+"-arrow-shape").value,l,c;if(o!=="none"){n==="source"?(l=a.srcX,c=a.srcY):n==="target"?(l=a.tgtX,c=a.tgtY):(l=a.midX,c=a.midY);var u=i.arrowBounds=i.arrowBounds||{},f=u[n]=u[n]||{};f.x1=l-s,f.y1=c-s,f.x2=l+s,f.y2=c+s,f.w=f.x2-f.x1,f.h=f.y2-f.y1,jv(f,1),Ta(e,f.x1,f.y1,f.x2,f.y2)}}},_2=function(e,r,n){if(!r.cy().headless()){var i;n?i=n+"-":i="";var a=r._private,s=a.rstyle,o=r.pstyle(i+"label").strValue;if(o){var l=r.pstyle("text-halign"),c=r.pstyle("text-valign"),u=Xf(s,"labelWidth",n),f=Xf(s,"labelHeight",n),h=Xf(s,"labelX",n),m=Xf(s,"labelY",n),v=r.pstyle(i+"text-margin-x").pfValue,y=r.pstyle(i+"text-margin-y").pfValue,x=r.isEdge(),b=r.pstyle(i+"text-rotation"),S=r.pstyle("text-outline-width").pfValue,w=r.pstyle("text-border-width").pfValue,k=w/2,N=r.pstyle("text-background-padding").pfValue,j=2,T=f,M=u,A=M/2,_=T/2,D,R,I,$;if(x)D=h-A,R=h+A,I=m-_,$=m+_;else{switch(l.value){case"left":D=h-M,R=h;break;case"center":D=h-A,R=h+A;break;case"right":D=h,R=h+M;break}switch(c.value){case"top":I=m-T,$=m;break;case"center":I=m-_,$=m+_;break;case"bottom":I=m,$=m+T;break}}var B=v-Math.max(S,k)-N-j,z=v+Math.max(S,k)+N+j,U=y-Math.max(S,k)-N-j,F=y+Math.max(S,k)+N+j;D+=B,R+=z,I+=U,$+=F;var Q=n||"main",K=a.labelBounds,L=K[Q]=K[Q]||{};L.x1=D,L.y1=I,L.x2=R,L.y2=$,L.w=R-D,L.h=$-I,L.leftPad=B,L.rightPad=z,L.topPad=U,L.botPad=F;var G=x&&b.strValue==="autorotate",ee=b.pfValue!=null&&b.pfValue!==0;if(G||ee){var re=G?Xf(a.rstyle,"labelAngle",n):b.pfValue,se=Math.cos(re),de=Math.sin(re),W=(D+R)/2,ne=(I+$)/2;if(!x){switch(l.value){case"left":W=R;break;case"right":W=D;break}switch(c.value){case"top":ne=$;break;case"bottom":ne=I;break}}var ie=function(Pe,ze){return Pe=Pe-W,ze=ze-ne,{x:Pe*se-ze*de+W,y:Pe*de+ze*se+ne}},V=ie(D,I),Y=ie(D,$),te=ie(R,I),Z=ie(R,$);D=Math.min(V.x,Y.x,te.x,Z.x),R=Math.max(V.x,Y.x,te.x,Z.x),I=Math.min(V.y,Y.y,te.y,Z.y),$=Math.max(V.y,Y.y,te.y,Z.y)}var ue=Q+"Rot",ge=K[ue]=K[ue]||{};ge.x1=D,ge.y1=I,ge.x2=R,ge.y2=$,ge.w=R-D,ge.h=$-I,Ta(e,D,I,R,$),Ta(a.labelBounds.all,D,I,R,$)}return e}},p8=function(e,r){if(!r.cy().headless()){var n=r.pstyle("outline-opacity").value,i=r.pstyle("outline-width").value,a=r.pstyle("outline-offset").value,s=i+a;NR(e,r,n,s,"outside",s/2)}},NR=function(e,r,n,i,a,s){if(!(n===0||i<=0||a==="inside")){var o=r.cy(),l=r.pstyle("shape").value,c=o.renderer().nodeShapes[l],u=r.position(),f=u.x,h=u.y,m=r.width(),v=r.height();if(c.hasMiterBounds){a==="center"&&(i/=2);var y=c.miterBounds(f,h,m,v,i);Oo(e,y)}else s!=null&&s>0&&Mv(e,[s,s,s,s])}},bW=function(e,r){if(!r.cy().headless()){var n=r.pstyle("border-opacity").value,i=r.pstyle("border-width").pfValue,a=r.pstyle("border-position").value;NR(e,r,n,i,a)}},wW=function(e,r){var n=e._private.cy,i=n.styleEnabled(),a=n.headless(),s=ei(),o=e._private,l=e.isNode(),c=e.isEdge(),u,f,h,m,v,y,x=o.rstyle,b=l&&i?e.pstyle("bounds-expansion").pfValue:[0],S=function(Ue){return Ue.pstyle("display").value!=="none"},w=!i||S(e)&&(!c||S(e.source())&&S(e.target()));if(w){var k=0,N=0;i&&r.includeOverlays&&(k=e.pstyle("overlay-opacity").value,k!==0&&(N=e.pstyle("overlay-padding").value));var j=0,T=0;i&&r.includeUnderlays&&(j=e.pstyle("underlay-opacity").value,j!==0&&(T=e.pstyle("underlay-padding").value));var M=Math.max(N,T),A=0,_=0;if(i&&(A=e.pstyle("width").pfValue,_=A/2),l&&r.includeNodes){var D=e.position();v=D.x,y=D.y;var R=e.outerWidth(),I=R/2,$=e.outerHeight(),B=$/2;u=v-I,f=v+I,h=y-B,m=y+B,Ta(s,u,h,f,m),i&&p8(s,e),i&&r.includeOutlines&&!a&&p8(s,e),i&&bW(s,e)}else if(c&&r.includeEdges)if(i&&!a){var z=e.pstyle("curve-style").strValue;if(u=Math.min(x.srcX,x.midX,x.tgtX),f=Math.max(x.srcX,x.midX,x.tgtX),h=Math.min(x.srcY,x.midY,x.tgtY),m=Math.max(x.srcY,x.midY,x.tgtY),u-=_,f+=_,h-=_,m+=_,Ta(s,u,h,f,m),z==="haystack"){var U=x.haystackPts;if(U&&U.length===2){if(u=U[0].x,h=U[0].y,f=U[1].x,m=U[1].y,u>f){var F=u;u=f,f=F}if(h>m){var Q=h;h=m,m=Q}Ta(s,u-_,h-_,f+_,m+_)}}else if(z==="bezier"||z==="unbundled-bezier"||Wo(z,"segments")||Wo(z,"taxi")){var K;switch(z){case"bezier":case"unbundled-bezier":K=x.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":K=x.linePts;break}if(K!=null)for(var L=0;L<K.length;L++){var G=K[L];u=G.x-_,f=G.x+_,h=G.y-_,m=G.y+_,Ta(s,u,h,f,m)}}}else{var ee=e.source(),re=ee.position(),se=e.target(),de=se.position();if(u=re.x,f=de.x,h=re.y,m=de.y,u>f){var W=u;u=f,f=W}if(h>m){var ne=h;h=m,m=ne}u-=_,f+=_,h-=_,m+=_,Ta(s,u,h,f,m)}if(i&&r.includeEdges&&c&&(Lg(s,e,"mid-source"),Lg(s,e,"mid-target"),Lg(s,e,"source"),Lg(s,e,"target")),i){var ie=e.pstyle("ghost").value==="yes";if(ie){var V=e.pstyle("ghost-offset-x").pfValue,Y=e.pstyle("ghost-offset-y").pfValue;Ta(s,s.x1+V,s.y1+Y,s.x2+V,s.y2+Y)}}var te=o.bodyBounds=o.bodyBounds||{};ZT(te,s),Mv(te,b),jv(te,1),i&&(u=s.x1,f=s.x2,h=s.y1,m=s.y2,Ta(s,u-M,h-M,f+M,m+M));var Z=o.overlayBounds=o.overlayBounds||{};ZT(Z,s),Mv(Z,b),jv(Z,1);var ue=o.labelBounds=o.labelBounds||{};ue.all!=null?rG(ue.all):ue.all=ei(),i&&r.includeLabels&&(r.includeMainLabels&&_2(s,e,null),c&&(r.includeSourceLabels&&_2(s,e,"source"),r.includeTargetLabels&&_2(s,e,"target")))}return s.x1=ta(s.x1),s.y1=ta(s.y1),s.x2=ta(s.x2),s.y2=ta(s.y2),s.w=ta(s.x2-s.x1),s.h=ta(s.y2-s.y1),s.w>0&&s.h>0&&w&&(Mv(s,b),jv(s,1)),s},ER=function(e){var r=0,n=function(s){return(s?1:0)<<r++},i=0;return i+=n(e.incudeNodes),i+=n(e.includeEdges),i+=n(e.includeLabels),i+=n(e.includeMainLabels),i+=n(e.includeSourceLabels),i+=n(e.includeTargetLabels),i+=n(e.includeOverlays),i+=n(e.includeOutlines),i},TR=function(e){var r=function(o){return Math.round(o)};if(e.isEdge()){var n=e.source().position(),i=e.target().position();return qT([r(n.x),r(n.y),r(i.x),r(i.y)])}else{var a=e.position();return qT([r(a.x),r(a.y)])}},m8=function(e,r){var n=e._private,i,a=e.isEdge(),s=r==null?g8:ER(r),o=s===g8;if(n.bbCache==null?(i=wW(e,Cp),n.bbCache=i,n.bbCachePosKey=TR(e)):i=n.bbCache,!o){var l=e.isNode();i=ei(),(r.includeNodes&&l||r.includeEdges&&!l)&&(r.includeOverlays?Oo(i,n.overlayBounds):Oo(i,n.bodyBounds)),r.includeLabels&&(r.includeMainLabels&&(!a||r.includeSourceLabels&&r.includeTargetLabels)?Oo(i,n.labelBounds.all):(r.includeMainLabels&&Oo(i,n.labelBounds.mainRot),r.includeSourceLabels&&Oo(i,n.labelBounds.sourceRot),r.includeTargetLabels&&Oo(i,n.labelBounds.targetRot))),i.w=i.x2-i.x1,i.h=i.y2-i.y1}return i},Cp={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},g8=ER(Cp),v8=Pn(Cp);_l.boundingBox=function(t){var e,r=t===void 0||t.useCache===void 0||t.useCache===!0,n=Rd(function(u){var f=u._private;return f.bbCache==null||f.styleDirty||f.bbCachePosKey!==TR(u)},function(u){return u.id()});if(r&&this.length===1&&!n(this[0]))t===void 0?t=Cp:t=v8(t),e=m8(this[0],t);else{e=ei(),t=t||Cp;var i=v8(t),a=this,s=a.cy(),o=s.styleEnabled();this.edges().forEach(n),this.nodes().forEach(n),o&&this.recalculateRenderedStyle(r),this.updateCompoundBounds(!r);for(var l=0;l<a.length;l++){var c=a[l];n(c)&&c.dirtyBoundingBoxCache(),Oo(e,m8(c,i))}}return e.x1=ta(e.x1),e.y1=ta(e.y1),e.x2=ta(e.x2),e.y2=ta(e.y2),e.w=ta(e.x2-e.x1),e.h=ta(e.y2-e.y1),e};_l.dirtyBoundingBoxCache=function(){for(var t=0;t<this.length;t++){var e=this[t]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};_l.boundingBoxAt=function(t){var e=this.nodes(),r=this.cy(),n=r.hasCompoundNodes(),i=r.collection();if(n&&(i=e.filter(function(c){return c.isParent()}),e=e.not(i)),Mt(t)){var a=t;t=function(){return a}}var s=function(u,f){return u._private.bbAtOldPos=t(u,f)},o=function(u){return u._private.bbAtOldPos};r.startBatch(),e.forEach(s).silentPositions(t),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0));var l=tG(this.boundingBox({useCache:!1}));return e.silentPositions(o),n&&(i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),i.updateCompoundBounds(!0)),r.endBatch(),l};wd.boundingbox=wd.bb=wd.boundingBox;wd.renderedBoundingbox=wd.renderedBoundingBox;var SW=_l,bh,am;bh=am={};var jR=function(e){e.uppercaseName=AT(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=AT(e.outerName),bh[e.name]=function(){var n=this[0],i=n._private,a=i.cy,s=a._private.styleEnabled;if(n)if(s){if(n.isParent())return n.updateCompoundBounds(),i[e.autoName]||0;var o=n.pstyle(e.name);switch(o.strValue){case"label":return n.recalculateRenderedStyle(),i.rstyle[e.labelName]||0;default:return o.pfValue}}else return 1},bh["outer"+e.uppercaseName]=function(){var n=this[0],i=n._private,a=i.cy,s=a._private.styleEnabled;if(n)if(s){var o=n[e.name](),l=n.pstyle("border-position").value,c;l==="center"?c=n.pstyle("border-width").pfValue:l==="outside"?c=2*n.pstyle("border-width").pfValue:c=0;var u=2*n.padding();return o+c+u}else return 1},bh["rendered"+e.uppercaseName]=function(){var n=this[0];if(n){var i=n[e.name]();return i*this.cy().zoom()}},bh["rendered"+e.uppercaseOuterName]=function(){var n=this[0];if(n){var i=n[e.outerName]();return i*this.cy().zoom()}}};jR({name:"width"});jR({name:"height"});am.padding=function(){var t=this[0],e=t._private;return t.isParent()?(t.updateCompoundBounds(),e.autoPadding!==void 0?e.autoPadding:t.pstyle("padding").pfValue):t.pstyle("padding").pfValue};am.paddedHeight=function(){var t=this[0];return t.height()+2*t.padding()};am.paddedWidth=function(){var t=this[0];return t.width()+2*t.padding()};var kW=am,CW=function(e,r){if(e.isEdge()&&e.takesUpSpace())return r(e)},NW=function(e,r){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy();return ex(r(e),n.zoom(),n.pan())}},EW=function(e,r){if(e.isEdge()&&e.takesUpSpace()){var n=e.cy(),i=n.pan(),a=n.zoom();return r(e).map(function(s){return ex(s,a,i)})}},TW=function(e){return e.renderer().getControlPoints(e)},jW=function(e){return e.renderer().getSegmentPoints(e)},MW=function(e){return e.renderer().getSourceEndpoint(e)},PW=function(e){return e.renderer().getTargetEndpoint(e)},_W=function(e){return e.renderer().getEdgeMidpoint(e)},y8={controlPoints:{get:TW,mult:!0},segmentPoints:{get:jW,mult:!0},sourceEndpoint:{get:MW},targetEndpoint:{get:PW},midpoint:{get:_W}},AW=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)},RW=Object.keys(y8).reduce(function(t,e){var r=y8[e],n=AW(e);return t[e]=function(){return CW(this,r.get)},r.mult?t[n]=function(){return EW(this,r.get)}:t[n]=function(){return NW(this,r.get)},t},{}),DW=Qe({},xW,SW,kW,RW);/*!
Event object based on jQuery events, MIT license

https://jquery.org/license/
https://tldrlegal.com/license/mit-license
https://github.com/jquery/jquery/blob/master/src/event.js
*/var MR=function(e,r){this.recycle(e,r)};function Qf(){return!1}function Bg(){return!0}MR.prototype={instanceString:function(){return"event"},recycle:function(e,r){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=Qf,e!=null&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?Bg:Qf):e!=null&&e.type?r=e:this.type=e,r!=null&&(this.originalEvent=r.originalEvent,this.type=r.type!=null?r.type:this.type,this.cy=r.cy,this.target=r.target,this.position=r.position,this.renderedPosition=r.renderedPosition,this.namespace=r.namespace,this.layout=r.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var n=this.position,i=this.cy.zoom(),a=this.cy.pan();this.renderedPosition={x:n.x*i+a.x,y:n.y*i+a.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=Bg;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=Bg;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Bg,this.stopPropagation()},isDefaultPrevented:Qf,isPropagationStopped:Qf,isImmediatePropagationStopped:Qf};var PR=/^([^.]+)(\.(?:[^.]+))?$/,OW=".*",_R={qualifierCompare:function(e,r){return e===r},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},x8=Object.keys(_R),IW={};function ox(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:IW,e=arguments.length>1?arguments[1]:void 0,r=0;r<x8.length;r++){var n=x8[r];this[n]=t[n]||_R[n]}this.context=e||this.context,this.listeners=[],this.emitting=0}var bl=ox.prototype,AR=function(e,r,n,i,a,s,o){vr(i)&&(a=i,i=null),o&&(s==null?s=o:s=Qe({},s,o));for(var l=Ht(n)?n:n.split(/\s+/),c=0;c<l.length;c++){var u=l[c];if(!ml(u)){var f=u.match(PR);if(f){var h=f[1],m=f[2]?f[2]:null,v=r(e,u,h,m,i,a,s);if(v===!1)break}}}},b8=function(e,r){return e.addEventFields(e.context,r),new MR(r.type,r)},LW=function(e,r,n){if(U$(n)){r(e,n);return}else if(Mt(n)){r(e,b8(e,n));return}for(var i=Ht(n)?n:n.split(/\s+/),a=0;a<i.length;a++){var s=i[a];if(!ml(s)){var o=s.match(PR);if(o){var l=o[1],c=o[2]?o[2]:null,u=b8(e,{type:l,namespace:c,target:e.context});r(e,u)}}}};bl.on=bl.addListener=function(t,e,r,n,i){return AR(this,function(a,s,o,l,c,u,f){vr(u)&&a.listeners.push({event:s,callback:u,type:o,namespace:l,qualifier:c,conf:f})},t,e,r,n,i),this};bl.one=function(t,e,r,n){return this.on(t,e,r,n,{one:!0})};bl.removeListener=bl.off=function(t,e,r,n){var i=this;this.emitting!==0&&(this.listeners=NU(this.listeners));for(var a=this.listeners,s=function(c){var u=a[c];AR(i,function(f,h,m,v,y,x){if((u.type===m||t==="*")&&(!v&&u.namespace!==".*"||u.namespace===v)&&(!y||f.qualifierCompare(u.qualifier,y))&&(!x||u.callback===x))return a.splice(c,1),!1},t,e,r,n)},o=a.length-1;o>=0;o--)s(o);return this};bl.removeAllListeners=function(){return this.removeListener("*")};bl.emit=bl.trigger=function(t,e,r){var n=this.listeners,i=n.length;return this.emitting++,Ht(e)||(e=[e]),LW(this,function(a,s){r!=null&&(n=[{event:s.event,type:s.type,namespace:s.namespace,callback:r}],i=n.length);for(var o=function(){var u=n[l];if(u.type===s.type&&(!u.namespace||u.namespace===s.namespace||u.namespace===OW)&&a.eventMatches(a.context,u,s)){var f=[s];e!=null&&TU(f,e),a.beforeEmit(a.context,u,s),u.conf&&u.conf.one&&(a.listeners=a.listeners.filter(function(v){return v!==u}));var h=a.callbackContext(a.context,u,s),m=u.callback.apply(h,f);a.afterEmit(a.context,u,s),m===!1&&(s.stopPropagation(),s.preventDefault())}},l=0;l<i;l++)o();a.bubble(a.context)&&!s.isPropagationStopped()&&a.parent(a.context).emit(s,e)},t),this.emitting--,this};var BW={qualifierCompare:function(e,r){return e==null||r==null?e==null&&r==null:e.sameText(r)},eventMatches:function(e,r,n){var i=r.qualifier;return i!=null?e!==n.target&&Zp(n.target)&&i.matches(n.target):!0},addEventFields:function(e,r){r.cy=e.cy(),r.target=e},callbackContext:function(e,r,n){return r.qualifier!=null?n.target:e},beforeEmit:function(e,r){r.conf&&r.conf.once&&r.conf.onceCollection.removeListener(r.event,r.qualifier,r.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},Fg=function(e){return Ke(e)?new yl(e):e},RR={createEmitter:function(){for(var e=0;e<this.length;e++){var r=this[e],n=r._private;n.emitter||(n.emitter=new ox(BW,r))}return this},emitter:function(){return this._private.emitter},on:function(e,r,n){for(var i=Fg(r),a=0;a<this.length;a++){var s=this[a];s.emitter().on(e,i,n)}return this},removeListener:function(e,r,n){for(var i=Fg(r),a=0;a<this.length;a++){var s=this[a];s.emitter().removeListener(e,i,n)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){var r=this[e];r.emitter().removeAllListeners()}return this},one:function(e,r,n){for(var i=Fg(r),a=0;a<this.length;a++){var s=this[a];s.emitter().one(e,i,n)}return this},once:function(e,r,n){for(var i=Fg(r),a=0;a<this.length;a++){var s=this[a];s.emitter().on(e,i,n,{once:!0,onceCollection:this})}},emit:function(e,r){for(var n=0;n<this.length;n++){var i=this[n];i.emitter().emit(e,r)}return this},emitAndNotify:function(e,r){if(this.length!==0)return this.cy().notify(e,this),this.emit(e,r),this}};It.eventAliasesOn(RR);var DR={nodes:function(e){return this.filter(function(r){return r.isNode()}).filter(e)},edges:function(e){return this.filter(function(r){return r.isEdge()}).filter(e)},byGroup:function(){for(var e=this.spawn(),r=this.spawn(),n=0;n<this.length;n++){var i=this[n];i.isNode()?e.push(i):r.push(i)}return{nodes:e,edges:r}},filter:function(e,r){if(e===void 0)return this;if(Ke(e)||Ai(e))return new yl(e).filter(this);if(vr(e)){for(var n=this.spawn(),i=this,a=0;a<i.length;a++){var s=i[a],o=r?e.apply(r,[s,a,i]):e(s,a,i);o&&n.push(s)}return n}return this.spawn()},not:function(e){if(e){Ke(e)&&(e=this.filter(e));for(var r=this.spawn(),n=0;n<this.length;n++){var i=this[n],a=e.has(i);a||r.push(i)}return r}else return this},absoluteComplement:function(){var e=this.cy();return e.mutableElements().not(this)},intersect:function(e){if(Ke(e)){var r=e;return this.filter(r)}for(var n=this.spawn(),i=this,a=e,s=this.length<e.length,o=s?i:a,l=s?a:i,c=0;c<o.length;c++){var u=o[c];l.has(u)&&n.push(u)}return n},xor:function(e){var r=this._private.cy;Ke(e)&&(e=r.$(e));var n=this.spawn(),i=this,a=e,s=function(l,c){for(var u=0;u<l.length;u++){var f=l[u],h=f._private.data.id,m=c.hasElementWithId(h);m||n.push(f)}};return s(i,a),s(a,i),n},diff:function(e){var r=this._private.cy;Ke(e)&&(e=r.$(e));var n=this.spawn(),i=this.spawn(),a=this.spawn(),s=this,o=e,l=function(u,f,h){for(var m=0;m<u.length;m++){var v=u[m],y=v._private.data.id,x=f.hasElementWithId(y);x?a.merge(v):h.push(v)}};return l(s,o,n),l(o,s,i),{left:n,right:i,both:a}},add:function(e){var r=this._private.cy;if(!e)return this;if(Ke(e)){var n=e;e=r.mutableElements().filter(n)}for(var i=this.spawnSelf(),a=0;a<e.length;a++){var s=e[a],o=!this.has(s);o&&i.push(s)}return i},merge:function(e){var r=this._private,n=r.cy;if(!e)return this;if(e&&Ke(e)){var i=e;e=n.mutableElements().filter(i)}for(var a=r.map,s=0;s<e.length;s++){var o=e[s],l=o._private.data.id,c=!a.has(l);if(c){var u=this.length++;this[u]=o,a.set(l,{ele:o,index:u})}}return this},unmergeAt:function(e){var r=this[e],n=r.id(),i=this._private,a=i.map;this[e]=void 0,a.delete(n);var s=e===this.length-1;if(this.length>1&&!s){var o=this.length-1,l=this[o],c=l._private.data.id;this[o]=void 0,this[e]=l,a.set(c,{ele:l,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var r=this._private,n=e._private.data.id,i=r.map,a=i.get(n);if(!a)return this;var s=a.index;return this.unmergeAt(s),this},unmerge:function(e){var r=this._private.cy;if(!e)return this;if(e&&Ke(e)){var n=e;e=r.mutableElements().filter(n)}for(var i=0;i<e.length;i++)this.unmergeOne(e[i]);return this},unmergeBy:function(e){for(var r=this.length-1;r>=0;r--){var n=this[r];e(n)&&this.unmergeAt(r)}return this},map:function(e,r){for(var n=[],i=this,a=0;a<i.length;a++){var s=i[a],o=r?e.apply(r,[s,a,i]):e(s,a,i);n.push(o)}return n},reduce:function(e,r){for(var n=r,i=this,a=0;a<i.length;a++)n=e(n,i[a],a,i);return n},max:function(e,r){for(var n=-1/0,i,a=this,s=0;s<a.length;s++){var o=a[s],l=r?e.apply(r,[o,s,a]):e(o,s,a);l>n&&(n=l,i=o)}return{value:n,ele:i}},min:function(e,r){for(var n=1/0,i,a=this,s=0;s<a.length;s++){var o=a[s],l=r?e.apply(r,[o,s,a]):e(o,s,a);l<n&&(n=l,i=o)}return{value:n,ele:i}}},Rt=DR;Rt.u=Rt["|"]=Rt["+"]=Rt.union=Rt.or=Rt.add;Rt["\\"]=Rt["!"]=Rt["-"]=Rt.difference=Rt.relativeComplement=Rt.subtract=Rt.not;Rt.n=Rt["&"]=Rt["."]=Rt.and=Rt.intersection=Rt.intersect;Rt["^"]=Rt["(+)"]=Rt["(-)"]=Rt.symmetricDifference=Rt.symdiff=Rt.xor;Rt.fnFilter=Rt.filterFn=Rt.stdFilter=Rt.filter;Rt.complement=Rt.abscomp=Rt.absoluteComplement;var FW={isNode:function(){return this.group()==="nodes"},isEdge:function(){return this.group()==="edges"},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},OR=function(e,r){var n=e.cy(),i=n.hasCompoundNodes();function a(u){var f=u.pstyle("z-compound-depth");return f.value==="auto"?i?u.zDepth():0:f.value==="bottom"?-1:f.value==="top"?JC:0}var s=a(e)-a(r);if(s!==0)return s;function o(u){var f=u.pstyle("z-index-compare");return f.value==="auto"&&u.isNode()?1:0}var l=o(e)-o(r);if(l!==0)return l;var c=e.pstyle("z-index").value-r.pstyle("z-index").value;return c!==0?c:e.poolIndex()-r.poolIndex()},j0={forEach:function(e,r){if(vr(e))for(var n=this.length,i=0;i<n;i++){var a=this[i],s=r?e.apply(r,[a,i,this]):e(a,i,this);if(s===!1)break}return this},toArray:function(){for(var e=[],r=0;r<this.length;r++)e.push(this[r]);return e},slice:function(e,r){var n=[],i=this.length;r==null&&(r=i),e==null&&(e=0),e<0&&(e=i+e),r<0&&(r=i+r);for(var a=e;a>=0&&a<r&&a<i;a++)n.push(this[a]);return this.spawn(n)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return this.length===0},nonempty:function(){return!this.empty()},sort:function(e){if(!vr(e))return this;var r=this.toArray().sort(e);return this.spawn(r)},sortByZIndex:function(){return this.sort(OR)},zDepth:function(){var e=this[0];if(e){var r=e._private,n=r.group;if(n==="nodes"){var i=r.data.parent?e.parents().size():0;return e.isParent()?i:JC-1}else{var a=r.source,s=r.target,o=a.zDepth(),l=s.zDepth();return Math.max(o,l,0)}}}};j0.each=j0.forEach;var zW=function(){var e="undefined",r=(typeof Symbol>"u"?"undefined":Zr(Symbol))!=e&&Zr(Symbol.iterator)!=e;r&&(j0[Symbol.iterator]=function(){var n=this,i={value:void 0,done:!1},a=0,s=this.length;return RA({next:function(){return a<s?i.value=n[a++]:(i.value=void 0,i.done=!0),i}},Symbol.iterator,function(){return this})})};zW();var VW=Pn({nodeDimensionsIncludeLabels:!1}),_v={layoutDimensions:function(e){e=VW(e);var r;if(!this.takesUpSpace())r={w:0,h:0};else if(e.nodeDimensionsIncludeLabels){var n=this.boundingBox();r={w:n.w,h:n.h}}else r={w:this.outerWidth(),h:this.outerHeight()};return(r.w===0||r.h===0)&&(r.w=r.h=1),r},layoutPositions:function(e,r,n){var i=this.nodes().filter(function(N){return!N.isParent()}),a=this.cy(),s=r.eles,o=function(j){return j.id()},l=Rd(n,o);e.emit({type:"layoutstart",layout:e}),e.animations=[];var c=function(j,T,M){var A={x:T.x1+T.w/2,y:T.y1+T.h/2},_={x:(M.x-A.x)*j,y:(M.y-A.y)*j};return{x:A.x+_.x,y:A.y+_.y}},u=r.spacingFactor&&r.spacingFactor!==1,f=function(){if(!u)return null;for(var j=ei(),T=0;T<i.length;T++){var M=i[T],A=l(M,T);ZA(j,A.x,A.y)}return j},h=f(),m=Rd(function(N,j){var T=l(N,j);if(u){var M=Math.abs(r.spacingFactor);T=c(M,h,T)}return r.transform!=null&&(T=r.transform(N,T)),T},o);if(r.animate){for(var v=0;v<i.length;v++){var y=i[v],x=m(y,v),b=r.animateFilter==null||r.animateFilter(y,v);if(b){var S=y.animation({position:x,duration:r.animationDuration,easing:r.animationEasing});e.animations.push(S)}else y.position(x)}if(r.fit){var w=a.animation({fit:{boundingBox:s.boundingBoxAt(m),padding:r.padding},duration:r.animationDuration,easing:r.animationEasing});e.animations.push(w)}else if(r.zoom!==void 0&&r.pan!==void 0){var k=a.animation({zoom:r.zoom,pan:r.pan,duration:r.animationDuration,easing:r.animationEasing});e.animations.push(k)}e.animations.forEach(function(N){return N.play()}),e.one("layoutready",r.ready),e.emit({type:"layoutready",layout:e}),nf.all(e.animations.map(function(N){return N.promise()})).then(function(){e.one("layoutstop",r.stop),e.emit({type:"layoutstop",layout:e})})}else i.positions(m),r.fit&&a.fit(r.eles,r.padding),r.zoom!=null&&a.zoom(r.zoom),r.pan&&a.pan(r.pan),e.one("layoutready",r.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",r.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){var r=this.cy();return r.makeLayout(Qe({},e,{eles:this}))}};_v.createLayout=_v.makeLayout=_v.layout;function IR(t,e,r){var n=r._private,i=n.styleCache=n.styleCache||[],a;return(a=i[t])!=null||(a=i[t]=e(r)),a}function lx(t,e){return t=Bc(t),function(n){return IR(t,e,n)}}function cx(t,e){t=Bc(t);var r=function(i){return e.call(i)};return function(){var i=this[0];if(i)return IR(t,r,i)}}var En={recalculateRenderedStyle:function(e){var r=this.cy(),n=r.renderer(),i=r.styleEnabled();return n&&i&&n.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e=this.cy(),r=function(a){return a._private.styleCache=null};if(e.hasCompoundNodes()){var n;n=this.spawnSelf().merge(this.descendants()).merge(this.parents()),n.merge(n.connectedEdges()),n.forEach(r)}else this.forEach(function(i){r(i),i.connectedEdges().forEach(r)});return this},updateStyle:function(e){var r=this._private.cy;if(!r.styleEnabled())return this;if(r.batching()){var n=r._private.batchStyleEles;return n.merge(this),this}var i=r.hasCompoundNodes(),a=this;e=!!(e||e===void 0),i&&(a=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var s=a;return e?s.emitAndNotify("style"):s.emit("style"),a.forEach(function(o){return o._private.styleDirty=!0}),this},cleanStyle:function(){var e=this.cy();if(e.styleEnabled())for(var r=0;r<this.length;r++){var n=this[r];n._private.styleDirty&&(n._private.styleDirty=!1,e.style().apply(n))}},parsedStyle:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this[0],i=n.cy();if(i.styleEnabled()&&n){n._private.styleDirty&&(n._private.styleDirty=!1,i.style().apply(n));var a=n._private.style[e];return a??(r?i.style().getDefaultProperty(e):null)}},numericStyle:function(e){var r=this[0];if(r.cy().styleEnabled()&&r){var n=r.pstyle(e);return n.pfValue!==void 0?n.pfValue:n.value}},numericStyleUnits:function(e){var r=this[0];if(r.cy().styleEnabled()&&r)return r.pstyle(e).units},renderedStyle:function(e){var r=this.cy();if(!r.styleEnabled())return this;var n=this[0];if(n)return r.style().getRenderedStyle(n,e)},style:function(e,r){var n=this.cy();if(!n.styleEnabled())return this;var i=!1,a=n.style();if(Mt(e)){var s=e;a.applyBypass(this,s,i),this.emitAndNotify("style")}else if(Ke(e))if(r===void 0){var o=this[0];return o?a.getStylePropertyValue(o,e):void 0}else a.applyBypass(this,e,r,i),this.emitAndNotify("style");else if(e===void 0){var l=this[0];return l?a.getRawStyle(l):void 0}return this},removeStyle:function(e){var r=this.cy();if(!r.styleEnabled())return this;var n=!1,i=r.style(),a=this;if(e===void 0)for(var s=0;s<a.length;s++){var o=a[s];i.removeAllBypasses(o,n)}else{e=e.split(/\s+/);for(var l=0;l<a.length;l++){var c=a[l];i.removeBypasses(c,e,n)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var r=e.hasCompoundNodes(),n=this[0];if(n){var i=n._private,a=n.pstyle("opacity").value;if(!r)return a;var s=i.data.parent?n.parents():null;if(s)for(var o=0;o<s.length;o++){var l=s[o],c=l.pstyle("opacity").value;a=c*a}return a}},transparent:function(){var e=this.cy();if(!e.styleEnabled())return!1;var r=this[0],n=r.cy().hasCompoundNodes();if(r)return n?r.effectiveOpacity()===0:r.pstyle("opacity").value===0},backgrounding:function(){var e=this.cy();if(!e.styleEnabled())return!1;var r=this[0];return!!r._private.backgrounding}};function A2(t,e){var r=t._private,n=r.data.parent?t.parents():null;if(n)for(var i=0;i<n.length;i++){var a=n[i];if(!e(a))return!1}return!0}function u3(t){var e=t.ok,r=t.edgeOkViaNode||t.ok,n=t.parentOk||t.ok;return function(){var i=this.cy();if(!i.styleEnabled())return!0;var a=this[0],s=i.hasCompoundNodes();if(a){var o=a._private;if(!e(a))return!1;if(a.isNode())return!s||A2(a,n);var l=o.source,c=o.target;return r(l)&&(!s||A2(l,r))&&(l===c||r(c)&&(!s||A2(c,r)))}}}var af=lx("eleTakesUpSpace",function(t){return t.pstyle("display").value==="element"&&t.width()!==0&&(t.isNode()?t.height()!==0:!0)});En.takesUpSpace=cx("takesUpSpace",u3({ok:af}));var $W=lx("eleInteractive",function(t){return t.pstyle("events").value==="yes"&&t.pstyle("visibility").value==="visible"&&af(t)}),UW=lx("parentInteractive",function(t){return t.pstyle("visibility").value==="visible"&&af(t)});En.interactive=cx("interactive",u3({ok:$W,parentOk:UW,edgeOkViaNode:af}));En.noninteractive=function(){var t=this[0];if(t)return!t.interactive()};var GW=lx("eleVisible",function(t){return t.pstyle("visibility").value==="visible"&&t.pstyle("opacity").pfValue!==0&&af(t)}),HW=af;En.visible=cx("visible",u3({ok:GW,edgeOkViaNode:HW}));En.hidden=function(){var t=this[0];if(t)return!t.visible()};En.isBundledBezier=cx("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});En.bypass=En.css=En.style;En.renderedCss=En.renderedStyle;En.removeBypass=En.removeCss=En.removeStyle;En.pstyle=En.parsedStyle;var ll={};function w8(t){return function(){var e=arguments,r=[];if(e.length===2){var n=e[0],i=e[1];this.on(t.event,n,i)}else if(e.length===1&&vr(e[0])){var a=e[0];this.on(t.event,a)}else if(e.length===0||e.length===1&&Ht(e[0])){for(var s=e.length===1?e[0]:null,o=0;o<this.length;o++){var l=this[o],c=!t.ableField||l._private[t.ableField],u=l._private[t.field]!=t.value;if(t.overrideAble){var f=t.overrideAble(l);if(f!==void 0&&(c=f,!f))return this}c&&(l._private[t.field]=t.value,u&&r.push(l))}var h=this.spawn(r);h.updateStyle(),h.emit(t.event),s&&h.emit(s)}return this}}function sf(t){ll[t.field]=function(){var e=this[0];if(e){if(t.overrideField){var r=t.overrideField(e);if(r!==void 0)return r}return e._private[t.field]}},ll[t.on]=w8({event:t.on,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!0}),ll[t.off]=w8({event:t.off,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!1})}sf({field:"locked",overrideField:function(e){return e.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});sf({field:"grabbable",overrideField:function(e){return e.cy().autoungrabify()||e.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});sf({field:"selected",ableField:"selectable",overrideAble:function(e){return e.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});sf({field:"selectable",overrideField:function(e){return e.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});ll.deselect=ll.unselect;ll.grabbed=function(){var t=this[0];if(t)return t._private.grabbed};sf({field:"active",on:"activate",off:"unactivate"});sf({field:"pannable",on:"panify",off:"unpanify"});ll.inactive=function(){var t=this[0];if(t)return!t._private.active};var Gn={},S8=function(e){return function(n){for(var i=this,a=[],s=0;s<i.length;s++){var o=i[s];if(o.isNode()){for(var l=!1,c=o.connectedEdges(),u=0;u<c.length;u++){var f=c[u],h=f.source(),m=f.target();if(e.noIncomingEdges&&m===o&&h!==o||e.noOutgoingEdges&&h===o&&m!==o){l=!0;break}}l||a.push(o)}}return this.spawn(a,!0).filter(n)}},k8=function(e){return function(r){for(var n=this,i=[],a=0;a<n.length;a++){var s=n[a];if(s.isNode())for(var o=s.connectedEdges(),l=0;l<o.length;l++){var c=o[l],u=c.source(),f=c.target();e.outgoing&&u===s?(i.push(c),i.push(f)):e.incoming&&f===s&&(i.push(c),i.push(u))}}return this.spawn(i,!0).filter(r)}},C8=function(e){return function(r){for(var n=this,i=[],a={};;){var s=e.outgoing?n.outgoers():n.incomers();if(s.length===0)break;for(var o=!1,l=0;l<s.length;l++){var c=s[l],u=c.id();a[u]||(a[u]=!0,i.push(c),o=!0)}if(!o)break;n=s}return this.spawn(i,!0).filter(r)}};Gn.clearTraversalCache=function(){for(var t=0;t<this.length;t++)this[t]._private.traversalCache=null};Qe(Gn,{roots:S8({noIncomingEdges:!0}),leaves:S8({noOutgoingEdges:!0}),outgoers:ia(k8({outgoing:!0}),"outgoers"),successors:C8({outgoing:!0}),incomers:ia(k8({incoming:!0}),"incomers"),predecessors:C8({})});Qe(Gn,{neighborhood:ia(function(t){for(var e=[],r=this.nodes(),n=0;n<r.length;n++)for(var i=r[n],a=i.connectedEdges(),s=0;s<a.length;s++){var o=a[s],l=o.source(),c=o.target(),u=i===l?c:l;u.length>0&&e.push(u[0]),e.push(o[0])}return this.spawn(e,!0).filter(t)},"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}});Gn.neighbourhood=Gn.neighborhood;Gn.closedNeighbourhood=Gn.closedNeighborhood;Gn.openNeighbourhood=Gn.openNeighborhood;Qe(Gn,{source:ia(function(e){var r=this[0],n;return r&&(n=r._private.source||r.cy().collection()),n&&e?n.filter(e):n},"source"),target:ia(function(e){var r=this[0],n;return r&&(n=r._private.target||r.cy().collection()),n&&e?n.filter(e):n},"target"),sources:N8({attr:"source"}),targets:N8({attr:"target"})});function N8(t){return function(r){for(var n=[],i=0;i<this.length;i++){var a=this[i],s=a._private[t.attr];s&&n.push(s)}return this.spawn(n,!0).filter(r)}}Qe(Gn,{edgesWith:ia(E8(),"edgesWith"),edgesTo:ia(E8({thisIsSrc:!0}),"edgesTo")});function E8(t){return function(r){var n=[],i=this._private.cy,a=t||{};Ke(r)&&(r=i.$(r));for(var s=0;s<r.length;s++)for(var o=r[s]._private.edges,l=0;l<o.length;l++){var c=o[l],u=c._private.data,f=this.hasElementWithId(u.source)&&r.hasElementWithId(u.target),h=r.hasElementWithId(u.source)&&this.hasElementWithId(u.target),m=f||h;m&&((a.thisIsSrc||a.thisIsTgt)&&(a.thisIsSrc&&!f||a.thisIsTgt&&!h)||n.push(c))}return this.spawn(n,!0)}}Qe(Gn,{connectedEdges:ia(function(t){for(var e=[],r=this,n=0;n<r.length;n++){var i=r[n];if(i.isNode())for(var a=i._private.edges,s=0;s<a.length;s++){var o=a[s];e.push(o)}}return this.spawn(e,!0).filter(t)},"connectedEdges"),connectedNodes:ia(function(t){for(var e=[],r=this,n=0;n<r.length;n++){var i=r[n];i.isEdge()&&(e.push(i.source()[0]),e.push(i.target()[0]))}return this.spawn(e,!0).filter(t)},"connectedNodes"),parallelEdges:ia(T8(),"parallelEdges"),codirectedEdges:ia(T8({codirected:!0}),"codirectedEdges")});function T8(t){var e={codirected:!1};return t=Qe({},e,t),function(n){for(var i=[],a=this.edges(),s=t,o=0;o<a.length;o++)for(var l=a[o],c=l._private,u=c.source,f=u._private.data.id,h=c.data.target,m=u._private.edges,v=0;v<m.length;v++){var y=m[v],x=y._private.data,b=x.target,S=x.source,w=b===h&&S===f,k=f===b&&h===S;(s.codirected&&w||!s.codirected&&(w||k))&&i.push(y)}return this.spawn(i,!0).filter(n)}}Qe(Gn,{components:function(e){var r=this,n=r.cy(),i=n.collection(),a=e==null?r.nodes():e.nodes(),s=[];e!=null&&a.empty()&&(a=e.sources());var o=function(u,f){i.merge(u),a.unmerge(u),f.merge(u)};if(a.empty())return r.spawn();var l=function(){var u=n.collection();s.push(u);var f=a[0];o(f,u),r.bfs({directed:!1,roots:f,visit:function(m){return o(m,u)}}),u.forEach(function(h){h.connectedEdges().forEach(function(m){r.has(m)&&u.has(m.source())&&u.has(m.target())&&u.merge(m)})})};do l();while(a.length>0);return s},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}});Gn.componentsOf=Gn.components;var Tn=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e===void 0){lr("A collection must have a reference to the core");return}var a=new Gs,s=!1;if(!r)r=[];else if(r.length>0&&Mt(r[0])&&!Zp(r[0])){s=!0;for(var o=[],l=new rf,c=0,u=r.length;c<u;c++){var f=r[c];f.data==null&&(f.data={});var h=f.data;if(h.id==null)h.id=XA();else if(e.hasElementWithId(h.id)||l.has(h.id))continue;var m=new Zy(e,f,!1);o.push(m),l.add(h.id)}r=o}this.length=0;for(var v=0,y=r.length;v<y;v++){var x=r[v][0];if(x!=null){var b=x._private.data.id;(!n||!a.has(b))&&(n&&a.set(b,{index:this.length,ele:x}),this[this.length]=x,this.length++)}}this._private={eles:this,cy:e,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(S){this.lazyMap=S},rebuildMap:function(){for(var w=this.lazyMap=new Gs,k=this.eles,N=0;N<k.length;N++){var j=k[N];w.set(j.id(),{index:N,ele:j})}}},n&&(this._private.map=a),s&&!i&&this.restore()},Qt=Zy.prototype=Tn.prototype=Object.create(Array.prototype);Qt.instanceString=function(){return"collection"};Qt.spawn=function(t,e){return new Tn(this.cy(),t,e)};Qt.spawnSelf=function(){return this.spawn(this)};Qt.cy=function(){return this._private.cy};Qt.renderer=function(){return this._private.cy.renderer()};Qt.element=function(){return this[0]};Qt.collection=function(){return IA(this)?this:new Tn(this._private.cy,[this])};Qt.unique=function(){return new Tn(this._private.cy,this,!0)};Qt.hasElementWithId=function(t){return t=""+t,this._private.map.has(t)};Qt.getElementById=function(t){t=""+t;var e=this._private.cy,r=this._private.map.get(t);return r?r.ele:new Tn(e)};Qt.$id=Qt.getElementById;Qt.poolIndex=function(){var t=this._private.cy,e=t._private.elements,r=this[0]._private.data.id;return e._private.map.get(r).index};Qt.indexOf=function(t){var e=t[0]._private.data.id;return this._private.map.get(e).index};Qt.indexOfId=function(t){return t=""+t,this._private.map.get(t).index};Qt.json=function(t){var e=this.element(),r=this.cy();if(e==null&&t)return this;if(e!=null){var n=e._private;if(Mt(t)){if(r.startBatch(),t.data){e.data(t.data);var i=n.data;if(e.isEdge()){var a=!1,s={},o=t.data.source,l=t.data.target;o!=null&&o!=i.source&&(s.source=""+o,a=!0),l!=null&&l!=i.target&&(s.target=""+l,a=!0),a&&(e=e.move(s))}else{var c="parent"in t.data,u=t.data.parent;c&&(u!=null||i.parent!=null)&&u!=i.parent&&(u===void 0&&(u=null),u!=null&&(u=""+u),e=e.move({parent:u}))}}t.position&&e.position(t.position);var f=function(y,x,b){var S=t[y];S!=null&&S!==n[y]&&(S?e[x]():e[b]())};return f("removed","remove","restore"),f("selected","select","unselect"),f("selectable","selectify","unselectify"),f("locked","lock","unlock"),f("grabbable","grabify","ungrabify"),f("pannable","panify","unpanify"),t.classes!=null&&e.classes(t.classes),r.endBatch(),this}else if(t===void 0){var h={data:ss(n.data),position:ss(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};h.classes="";var m=0;return n.classes.forEach(function(v){return h.classes+=m++===0?v:" "+v}),h}}};Qt.jsons=function(){for(var t=[],e=0;e<this.length;e++){var r=this[e],n=r.json();t.push(n)}return t};Qt.clone=function(){for(var t=this.cy(),e=[],r=0;r<this.length;r++){var n=this[r],i=n.json(),a=new Zy(t,i,!1);e.push(a)}return new Tn(t,e)};Qt.copy=Qt.clone;Qt.restore=function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,n=r.cy(),i=n._private,a=[],s=[],o,l=0,c=r.length;l<c;l++){var u=r[l];e&&!u.removed()||(u.isNode()?a.push(u):s.push(u))}o=a.concat(s);var f,h=function(){o.splice(f,1),f--};for(f=0;f<o.length;f++){var m=o[f],v=m._private,y=v.data;if(m.clearTraversalCache(),!(!e&&!v.removed)){if(y.id===void 0)y.id=XA();else if(Ee(y.id))y.id=""+y.id;else if(ml(y.id)||!Ke(y.id)){lr("Can not create element with invalid string ID `"+y.id+"`"),h();continue}else if(n.hasElementWithId(y.id)){lr("Can not create second element with ID `"+y.id+"`"),h();continue}}var x=y.id;if(m.isNode()){var b=v.position;b.x==null&&(b.x=0),b.y==null&&(b.y=0)}if(m.isEdge()){for(var S=m,w=["source","target"],k=w.length,N=!1,j=0;j<k;j++){var T=w[j],M=y[T];Ee(M)&&(M=y[T]=""+y[T]),M==null||M===""?(lr("Can not create edge `"+x+"` with unspecified "+T),N=!0):n.hasElementWithId(M)||(lr("Can not create edge `"+x+"` with nonexistant "+T+" `"+M+"`"),N=!0)}if(N){h();continue}var A=n.getElementById(y.source),_=n.getElementById(y.target);A.same(_)?A._private.edges.push(S):(A._private.edges.push(S),_._private.edges.push(S)),S._private.source=A,S._private.target=_}v.map=new Gs,v.map.set(x,{ele:m,index:0}),v.removed=!1,e&&n.addToPool(m)}for(var D=0;D<a.length;D++){var R=a[D],I=R._private.data;Ee(I.parent)&&(I.parent=""+I.parent);var $=I.parent,B=$!=null;if(B||R._private.parent){var z=R._private.parent?n.collection().merge(R._private.parent):n.getElementById($);if(z.empty())I.parent=void 0;else if(z[0].removed())Lt("Node added with missing parent, reference to parent removed"),I.parent=void 0,R._private.parent=null;else{for(var U=!1,F=z;!F.empty();){if(R.same(F)){U=!0,I.parent=void 0;break}F=F.parent()}U||(z[0]._private.children.push(R),R._private.parent=z[0],i.hasCompoundNodes=!0)}}}if(o.length>0){for(var Q=o.length===r.length?r:new Tn(n,o),K=0;K<Q.length;K++){var L=Q[K];L.isNode()||(L.parallelEdges().clearTraversalCache(),L.source().clearTraversalCache(),L.target().clearTraversalCache())}var G;i.hasCompoundNodes?G=n.collection().merge(Q).merge(Q.connectedNodes()).merge(Q.parent()):G=Q,G.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(t),t?Q.emitAndNotify("add"):e&&Q.emit("add")}return r};Qt.removed=function(){var t=this[0];return t&&t._private.removed};Qt.inside=function(){var t=this[0];return t&&!t._private.removed};Qt.remove=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this,n=[],i={},a=r._private.cy;function s($){for(var B=$._private.edges,z=0;z<B.length;z++)l(B[z])}function o($){for(var B=$._private.children,z=0;z<B.length;z++)l(B[z])}function l($){var B=i[$.id()];e&&$.removed()||B||(i[$.id()]=!0,$.isNode()?(n.push($),s($),o($)):n.unshift($))}for(var c=0,u=r.length;c<u;c++){var f=r[c];l(f)}function h($,B){var z=$._private.edges;gl(z,B),$.clearTraversalCache()}function m($){$.clearTraversalCache()}var v=[];v.ids={};function y($,B){B=B[0],$=$[0];var z=$._private.children,U=$.id();gl(z,B),B._private.parent=null,v.ids[U]||(v.ids[U]=!0,v.push($))}r.dirtyCompoundBoundsCache(),e&&a.removeFromPool(n);for(var x=0;x<n.length;x++){var b=n[x];if(b.isEdge()){var S=b.source()[0],w=b.target()[0];h(S,b),h(w,b);for(var k=b.parallelEdges(),N=0;N<k.length;N++){var j=k[N];m(j),j.isBundledBezier()&&j.dirtyBoundingBoxCache()}}else{var T=b.parent();T.length!==0&&y(T,b)}e&&(b._private.removed=!0)}var M=a._private.elements;a._private.hasCompoundNodes=!1;for(var A=0;A<M.length;A++){var _=M[A];if(_.isParent()){a._private.hasCompoundNodes=!0;break}}var D=new Tn(this.cy(),n);D.size()>0&&(t?D.emitAndNotify("remove"):e&&D.emit("remove"));for(var R=0;R<v.length;R++){var I=v[R];(!e||!I.removed())&&I.updateStyle()}return D};Qt.move=function(t){var e=this._private.cy,r=this,n=!1,i=!1,a=function(v){return v==null?v:""+v};if(t.source!==void 0||t.target!==void 0){var s=a(t.source),o=a(t.target),l=s!=null&&e.hasElementWithId(s),c=o!=null&&e.hasElementWithId(o);(l||c)&&(e.batch(function(){r.remove(n,i),r.emitAndNotify("moveout");for(var m=0;m<r.length;m++){var v=r[m],y=v._private.data;v.isEdge()&&(l&&(y.source=s),c&&(y.target=o))}r.restore(n,i)}),r.emitAndNotify("move"))}else if(t.parent!==void 0){var u=a(t.parent),f=u===null||e.hasElementWithId(u);if(f){var h=u===null?void 0:u;e.batch(function(){var m=r.remove(n,i);m.emitAndNotify("moveout");for(var v=0;v<r.length;v++){var y=r[v],x=y._private.data;y.isNode()&&(x.parent=h)}m.restore(n,i)}),r.emitAndNotify("move")}}return this};[lR,rW,Pv,ol,Od,yW,sx,DW,RR,DR,FW,j0,_v,En,ll,Gn].forEach(function(t){Qe(Qt,t)});var WW={add:function(e){var r,n=this;if(Ai(e)){var i=e;if(i._private.cy===n)r=i.restore();else{for(var a=[],s=0;s<i.length;s++){var o=i[s];a.push(o.json())}r=new Tn(n,a)}}else if(Ht(e)){var l=e;r=new Tn(n,l)}else if(Mt(e)&&(Ht(e.nodes)||Ht(e.edges))){for(var c=e,u=[],f=["nodes","edges"],h=0,m=f.length;h<m;h++){var v=f[h],y=c[v];if(Ht(y))for(var x=0,b=y.length;x<b;x++){var S=Qe({group:v},y[x]);u.push(S)}}r=new Tn(n,u)}else{var w=e;r=new Zy(n,w).collection()}return r},remove:function(e){if(!Ai(e)){if(Ke(e)){var r=e;e=this.$(r)}}return e.remove()}};/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */function qW(t,e,r,n){var i=4,a=.001,s=1e-7,o=10,l=11,c=1/(l-1),u=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var f=0;f<4;++f)if(typeof arguments[f]!="number"||isNaN(arguments[f])||!isFinite(arguments[f]))return!1;t=Math.min(t,1),r=Math.min(r,1),t=Math.max(t,0),r=Math.max(r,0);var h=u?new Float32Array(l):new Array(l);function m(_,D){return 1-3*D+3*_}function v(_,D){return 3*D-6*_}function y(_){return 3*_}function x(_,D,R){return((m(D,R)*_+v(D,R))*_+y(D))*_}function b(_,D,R){return 3*m(D,R)*_*_+2*v(D,R)*_+y(D)}function S(_,D){for(var R=0;R<i;++R){var I=b(D,t,r);if(I===0)return D;var $=x(D,t,r)-_;D-=$/I}return D}function w(){for(var _=0;_<l;++_)h[_]=x(_*c,t,r)}function k(_,D,R){var I,$,B=0;do $=D+(R-D)/2,I=x($,t,r)-_,I>0?R=$:D=$;while(Math.abs(I)>s&&++B<o);return $}function N(_){for(var D=0,R=1,I=l-1;R!==I&&h[R]<=_;++R)D+=c;--R;var $=(_-h[R])/(h[R+1]-h[R]),B=D+$*c,z=b(B,t,r);return z>=a?S(_,B):z===0?B:k(_,D,D+c)}var j=!1;function T(){j=!0,(t!==e||r!==n)&&w()}var M=function(D){return j||T(),t===e&&r===n?D:D===0?0:D===1?1:x(N(D),e,n)};M.getControlPoints=function(){return[{x:t,y:e},{x:r,y:n}]};var A="generateBezier("+[t,e,r,n]+")";return M.toString=function(){return A},M}/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */var KW=function(){function t(n){return-n.tension*n.x-n.friction*n.v}function e(n,i,a){var s={x:n.x+a.dx*i,v:n.v+a.dv*i,tension:n.tension,friction:n.friction};return{dx:s.v,dv:t(s)}}function r(n,i){var a={dx:n.v,dv:t(n)},s=e(n,i*.5,a),o=e(n,i*.5,s),l=e(n,i,o),c=1/6*(a.dx+2*(s.dx+o.dx)+l.dx),u=1/6*(a.dv+2*(s.dv+o.dv)+l.dv);return n.x=n.x+c*i,n.v=n.v+u*i,n}return function n(i,a,s){var o={x:-1,v:0,tension:null,friction:null},l=[0],c=0,u=1/1e4,f=16/1e3,h,m,v;for(i=parseFloat(i)||500,a=parseFloat(a)||20,s=s||null,o.tension=i,o.friction=a,h=s!==null,h?(c=n(i,a),m=c/s*f):m=f;v=r(v||o,m),l.push(1+v.x),c+=16,Math.abs(v.x)>u&&Math.abs(v.v)>u;);return h?function(y){return l[y*(l.length-1)|0]}:c}}(),Yt=function(e,r,n,i){var a=qW(e,r,n,i);return function(s,o,l){return s+(o-s)*a(l)}},Av={linear:function(e,r,n){return e+(r-e)*n},ease:Yt(.25,.1,.25,1),"ease-in":Yt(.42,0,1,1),"ease-out":Yt(0,0,.58,1),"ease-in-out":Yt(.42,0,.58,1),"ease-in-sine":Yt(.47,0,.745,.715),"ease-out-sine":Yt(.39,.575,.565,1),"ease-in-out-sine":Yt(.445,.05,.55,.95),"ease-in-quad":Yt(.55,.085,.68,.53),"ease-out-quad":Yt(.25,.46,.45,.94),"ease-in-out-quad":Yt(.455,.03,.515,.955),"ease-in-cubic":Yt(.55,.055,.675,.19),"ease-out-cubic":Yt(.215,.61,.355,1),"ease-in-out-cubic":Yt(.645,.045,.355,1),"ease-in-quart":Yt(.895,.03,.685,.22),"ease-out-quart":Yt(.165,.84,.44,1),"ease-in-out-quart":Yt(.77,0,.175,1),"ease-in-quint":Yt(.755,.05,.855,.06),"ease-out-quint":Yt(.23,1,.32,1),"ease-in-out-quint":Yt(.86,0,.07,1),"ease-in-expo":Yt(.95,.05,.795,.035),"ease-out-expo":Yt(.19,1,.22,1),"ease-in-out-expo":Yt(1,0,0,1),"ease-in-circ":Yt(.6,.04,.98,.335),"ease-out-circ":Yt(.075,.82,.165,1),"ease-in-out-circ":Yt(.785,.135,.15,.86),spring:function(e,r,n){if(n===0)return Av.linear;var i=KW(e,r,n);return function(a,s,o){return a+(s-a)*i(o)}},"cubic-bezier":Yt};function j8(t,e,r,n,i){if(n===1||e===r)return r;var a=i(e,r,n);return t==null||((t.roundValue||t.color)&&(a=Math.round(a)),t.min!==void 0&&(a=Math.max(a,t.min)),t.max!==void 0&&(a=Math.min(a,t.max))),a}function M8(t,e){return t.pfValue!=null||t.value!=null?t.pfValue!=null&&(e==null||e.type.units!=="%")?t.pfValue:t.value:t}function Pu(t,e,r,n,i){var a=i!=null?i.type:null;r<0?r=0:r>1&&(r=1);var s=M8(t,i),o=M8(e,i);if(Ee(s)&&Ee(o))return j8(a,s,o,r,n);if(Ht(s)&&Ht(o)){for(var l=[],c=0;c<o.length;c++){var u=s[c],f=o[c];if(u!=null&&f!=null){var h=j8(a,u,f,r,n);l.push(h)}else l.push(f)}return l}}function YW(t,e,r,n){var i=!n,a=t._private,s=e._private,o=s.easing,l=s.startTime,c=n?t:t.cy(),u=c.style();if(!s.easingImpl)if(o==null)s.easingImpl=Av.linear;else{var f;if(Ke(o)){var h=u.parse("transition-timing-function",o);f=h.value}else f=o;var m,v;Ke(f)?(m=f,v=[]):(m=f[1],v=f.slice(2).map(function(Q){return+Q})),v.length>0?(m==="spring"&&v.push(s.duration),s.easingImpl=Av[m].apply(null,v)):s.easingImpl=Av[m]}var y=s.easingImpl,x;if(s.duration===0?x=1:x=(r-l)/s.duration,s.applying&&(x=s.progress),x<0?x=0:x>1&&(x=1),s.delay==null){var b=s.startPosition,S=s.position;if(S&&i&&!t.locked()){var w={};Jf(b.x,S.x)&&(w.x=Pu(b.x,S.x,x,y)),Jf(b.y,S.y)&&(w.y=Pu(b.y,S.y,x,y)),t.position(w)}var k=s.startPan,N=s.pan,j=a.pan,T=N!=null&&n;T&&(Jf(k.x,N.x)&&(j.x=Pu(k.x,N.x,x,y)),Jf(k.y,N.y)&&(j.y=Pu(k.y,N.y,x,y)),t.emit("pan"));var M=s.startZoom,A=s.zoom,_=A!=null&&n;_&&(Jf(M,A)&&(a.zoom=wp(a.minZoom,Pu(M,A,x,y),a.maxZoom)),t.emit("zoom")),(T||_)&&t.emit("viewport");var D=s.style;if(D&&D.length>0&&i){for(var R=0;R<D.length;R++){var I=D[R],$=I.name,B=I,z=s.startStyle[$],U=u.properties[z.name],F=Pu(z,B,x,y,U);u.overrideBypass(t,$,F)}t.emit("style")}}return s.progress=x,x}function Jf(t,e){return t==null||e==null?!1:Ee(t)&&Ee(e)?!0:!!(t&&e)}function XW(t,e,r,n){var i=e._private;i.started=!0,i.startTime=r-i.progress*i.duration}function P8(t,e){var r=e._private.aniEles,n=[];function i(u,f){var h=u._private,m=h.animation.current,v=h.animation.queue,y=!1;if(m.length===0){var x=v.shift();x&&m.push(x)}for(var b=function(j){for(var T=j.length-1;T>=0;T--){var M=j[T];M()}j.splice(0,j.length)},S=m.length-1;S>=0;S--){var w=m[S],k=w._private;if(k.stopped){m.splice(S,1),k.hooked=!1,k.playing=!1,k.started=!1,b(k.frames);continue}!k.playing&&!k.applying||(k.playing&&k.applying&&(k.applying=!1),k.started||XW(u,w,t),YW(u,w,t,f),k.applying&&(k.applying=!1),b(k.frames),k.step!=null&&k.step(t),w.completed()&&(m.splice(S,1),k.hooked=!1,k.playing=!1,k.started=!1,b(k.completes)),y=!0)}return!f&&m.length===0&&v.length===0&&n.push(u),y}for(var a=!1,s=0;s<r.length;s++){var o=r[s],l=i(o);a=a||l}var c=i(e,!0);(a||c)&&(r.length>0?e.notify("draw",r):e.notify("draw")),r.unmerge(n),e.emit("step")}var QW={animate:It.animate(),animation:It.animation(),animated:It.animated(),clearQueue:It.clearQueue(),delay:It.delay(),delayAnimation:It.delayAnimation(),stop:It.stop(),addToAnimationPool:function(e){var r=this;r.styleEnabled()&&r._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,!e.styleEnabled())return;function r(){e._private.animationsRunning&&k0(function(a){P8(a,e),r()})}var n=e.renderer();n&&n.beforeRender?n.beforeRender(function(a,s){P8(s,e)},n.beforeRenderPriorities.animations):r()}},JW={qualifierCompare:function(e,r){return e==null||r==null?e==null&&r==null:e.sameText(r)},eventMatches:function(e,r,n){var i=r.qualifier;return i!=null?e!==n.target&&Zp(n.target)&&i.matches(n.target):!0},addEventFields:function(e,r){r.cy=e,r.target=e},callbackContext:function(e,r,n){return r.qualifier!=null?n.target:e}},zg=function(e){return Ke(e)?new yl(e):e},LR={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new ox(JW,this)),this},emitter:function(){return this._private.emitter},on:function(e,r,n){return this.emitter().on(e,zg(r),n),this},removeListener:function(e,r,n){return this.emitter().removeListener(e,zg(r),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,r,n){return this.emitter().one(e,zg(r),n),this},once:function(e,r,n){return this.emitter().one(e,zg(r),n),this},emit:function(e,r){return this.emitter().emit(e,r),this},emitAndNotify:function(e,r){return this.emit(e),this.notify(e,r),this}};It.eventAliasesOn(LR);var H5={png:function(e){var r=this._private.renderer;return e=e||{},r.png(e)},jpg:function(e){var r=this._private.renderer;return e=e||{},e.bg=e.bg||"#fff",r.jpg(e)}};H5.jpeg=H5.jpg;var Rv={layout:function(e){var r=this;if(e==null){lr("Layout options must be specified to make a layout");return}if(e.name==null){lr("A `name` must be specified to make a layout");return}var n=e.name,i=r.extension("layout",n);if(i==null){lr("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var a;Ke(e.eles)?a=r.$(e.eles):a=e.eles!=null?e.eles:r.$();var s=new i(Qe({},e,{cy:r,eles:a}));return s}};Rv.createLayout=Rv.makeLayout=Rv.layout;var ZW={notify:function(e,r){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var i=n.batchNotifications[e]=n.batchNotifications[e]||this.collection();r!=null&&i.merge(r);return}if(n.notificationsEnabled){var a=this.renderer();this.destroyed()||!a||a.notify(e,r)}},notifications:function(e){var r=this._private;return e===void 0?r.notificationsEnabled:(r.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return e.batchCount==null&&(e.batchCount=0),e.batchCount===0&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(e.batchCount===0)return this;if(e.batchCount--,e.batchCount===0){e.batchStyleEles.updateStyle();var r=this.renderer();Object.keys(e.batchNotifications).forEach(function(n){var i=e.batchNotifications[n];i.empty()?r.notify(n):r.notify(n,i)})}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var r=this;return this.batch(function(){for(var n=Object.keys(e),i=0;i<n.length;i++){var a=n[i],s=e[a],o=r.getElementById(a);o.data(s)}})}},eq=Pn({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),W5={renderTo:function(e,r,n,i){var a=this._private.renderer;return a.renderTo(e,r,n,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var r=this,n=r.extension("renderer",e.name);if(n==null){lr("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}e.wheelSensitivity!==void 0&&Lt("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=eq(e);i.cy=r,r._private.renderer=new n(i),this.notify("init")},destroyRenderer:function(){var e=this;e.notify("destroy");var r=e.container();if(r)for(r._cyreg=null;r.childNodes.length>0;)r.removeChild(r.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach(function(n){var i=n._private;i.rscratch={},i.rstyle={},i.animation.current=[],i.animation.queue=[]})},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};W5.invalidateDimensions=W5.resize;var Dv={collection:function(e,r){return Ke(e)?this.$(e):Ai(e)?e.collection():Ht(e)?(r||(r={}),new Tn(this,e,r.unique,r.removed)):new Tn(this)},nodes:function(e){var r=this.$(function(n){return n.isNode()});return e?r.filter(e):r},edges:function(e){var r=this.$(function(n){return n.isEdge()});return e?r.filter(e):r},$:function(e){var r=this._private.elements;return e?r.filter(e):r.spawnSelf()},mutableElements:function(){return this._private.elements}};Dv.elements=Dv.filter=Dv.$;var vn={},Lh="t",tq="f";vn.apply=function(t){for(var e=this,r=e._private,n=r.cy,i=n.collection(),a=0;a<t.length;a++){var s=t[a],o=e.getContextMeta(s);if(!o.empty){var l=e.getContextStyle(o),c=e.applyContextStyle(o,l,s);s._private.appliedInitStyle?e.updateTransitions(s,c.diffProps):s._private.appliedInitStyle=!0;var u=e.updateStyleHints(s);u&&i.push(s)}}return i};vn.getPropertiesDiff=function(t,e){var r=this,n=r._private.propDiffs=r._private.propDiffs||{},i=t+"-"+e,a=n[i];if(a)return a;for(var s=[],o={},l=0;l<r.length;l++){var c=r[l],u=t[l]===Lh,f=e[l]===Lh,h=u!==f,m=c.mappedProperties.length>0;if(h||f&&m){var v=void 0;h&&m||h?v=c.properties:m&&(v=c.mappedProperties);for(var y=0;y<v.length;y++){for(var x=v[y],b=x.name,S=!1,w=l+1;w<r.length;w++){var k=r[w],N=e[w]===Lh;if(N&&(S=k.properties[x.name]!=null,S))break}!o[b]&&!S&&(o[b]=!0,s.push(b))}}}return n[i]=s,s};vn.getContextMeta=function(t){for(var e=this,r="",n,i=t._private.styleCxtKey||"",a=0;a<e.length;a++){var s=e[a],o=s.selector&&s.selector.matches(t);o?r+=Lh:r+=tq}return n=e.getPropertiesDiff(i,r),t._private.styleCxtKey=r,{key:r,diffPropNames:n,empty:n.length===0}};vn.getContextStyle=function(t){var e=t.key,r=this,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var i={_private:{key:e}},a=0;a<r.length;a++){var s=r[a],o=e[a]===Lh;if(o)for(var l=0;l<s.properties.length;l++){var c=s.properties[l];i[c.name]=c}}return n[e]=i,i};vn.applyContextStyle=function(t,e,r){for(var n=this,i=t.diffPropNames,a={},s=n.types,o=0;o<i.length;o++){var l=i[o],c=e[l],u=r.pstyle(l);if(!c)if(u)u.bypass?c={name:l,deleteBypassed:!0}:c={name:l,delete:!0};else continue;if(u!==c){if(c.mapped===s.fn&&u!=null&&u.mapping!=null&&u.mapping.value===c.value){var f=u.mapping,h=f.fnValue=c.value(r);if(h===f.prevFnValue)continue}var m=a[l]={prev:u};n.applyParsedProperty(r,c),m.next=r.pstyle(l),m.next&&m.next.bypass&&(m.next=m.next.bypassed)}}return{diffProps:a}};vn.updateStyleHints=function(t){var e=t._private,r=this,n=r.propertyGroupNames,i=r.propertyGroupKeys,a=function(te,Z,ue){return r.getPropertiesHash(te,Z,ue)},s=e.styleKey;if(t.removed())return!1;var o=e.group==="nodes",l=t._private.style;n=Object.keys(l);for(var c=0;c<i.length;c++){var u=i[c];e.styleKeys[u]=[fc,$u]}for(var f=function(te,Z){return e.styleKeys[Z][0]=yp(te,e.styleKeys[Z][0])},h=function(te,Z){return e.styleKeys[Z][1]=xp(te,e.styleKeys[Z][1])},m=function(te,Z){f(te,Z),h(te,Z)},v=function(te,Z){for(var ue=0;ue<te.length;ue++){var ge=te.charCodeAt(ue);f(ge,Z),h(ge,Z)}},y=2e9,x=function(te){return-128<te&&te<128&&Math.floor(te)!==te?y-(te*1024|0):te},b=0;b<n.length;b++){var S=n[b],w=l[S];if(w!=null){var k=this.properties[S],N=k.type,j=k.groupKey,T=void 0;k.hashOverride!=null?T=k.hashOverride(t,w):w.pfValue!=null&&(T=w.pfValue);var M=k.enums==null?w.value:null,A=T!=null,_=M!=null,D=A||_,R=w.units;if(N.number&&D&&!N.multiple){var I=A?T:M;m(x(I),j),!A&&R!=null&&v(R,j)}else v(w.strValue,j)}}for(var $=[fc,$u],B=0;B<i.length;B++){var z=i[B],U=e.styleKeys[z];$[0]=yp(U[0],$[0]),$[1]=xp(U[1],$[1])}e.styleKey=vU($[0],$[1]);var F=e.styleKeys;e.labelDimsKey=To(F.labelDimensions);var Q=a(t,["label"],F.labelDimensions);if(e.labelKey=To(Q),e.labelStyleKey=To(Ag(F.commonLabel,Q)),!o){var K=a(t,["source-label"],F.labelDimensions);e.sourceLabelKey=To(K),e.sourceLabelStyleKey=To(Ag(F.commonLabel,K));var L=a(t,["target-label"],F.labelDimensions);e.targetLabelKey=To(L),e.targetLabelStyleKey=To(Ag(F.commonLabel,L))}if(o){var G=e.styleKeys,ee=G.nodeBody,re=G.nodeBorder,se=G.nodeOutline,de=G.backgroundImage,W=G.compound,ne=G.pie,ie=G.stripe,V=[ee,re,se,de,W,ne,ie].filter(function(Y){return Y!=null}).reduce(Ag,[fc,$u]);e.nodeKey=To(V),e.hasPie=ne!=null&&ne[0]!==fc&&ne[1]!==$u,e.hasStripe=ie!=null&&ie[0]!==fc&&ie[1]!==$u}return s!==e.styleKey};vn.clearStyleHints=function(t){var e=t._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null,e.hasStripe=null};vn.applyParsedProperty=function(t,e){var r=this,n=e,i=t._private.style,a,s=r.types,o=r.properties[n.name].type,l=n.bypass,c=i[n.name],u=c&&c.bypass,f=t._private,h="mapping",m=function(ee){return ee==null?null:ee.pfValue!=null?ee.pfValue:ee.value},v=function(){var ee=m(c),re=m(n);r.checkTriggers(t,n.name,ee,re)};if(e.name==="curve-style"&&t.isEdge()&&(e.value!=="bezier"&&t.isLoop()||e.value==="haystack"&&(t.source().isParent()||t.target().isParent()))&&(n=e=this.parse(e.name,"bezier",l)),n.delete)return i[n.name]=void 0,v(),!0;if(n.deleteBypassed)return c?c.bypass?(c.bypassed=void 0,v(),!0):!1:(v(),!0);if(n.deleteBypass)return c?c.bypass?(i[n.name]=c.bypassed,v(),!0):!1:(v(),!0);var y=function(){Lt("Do not assign mappings to elements without corresponding data (i.e. ele `"+t.id()+"` has no mapping for property `"+n.name+"` with data field `"+n.field+"`); try a `["+n.field+"]` selector to limit scope to elements with `"+n.field+"` defined")};switch(n.mapped){case s.mapData:{for(var x=n.field.split("."),b=f.data,S=0;S<x.length&&b;S++){var w=x[S];b=b[w]}if(b==null)return y(),!1;var k;if(Ee(b)){var N=n.fieldMax-n.fieldMin;N===0?k=0:k=(b-n.fieldMin)/N}else return Lt("Do not use continuous mappers without specifying numeric data (i.e. `"+n.field+": "+b+"` for `"+t.id()+"` is non-numeric)"),!1;if(k<0?k=0:k>1&&(k=1),o.color){var j=n.valueMin[0],T=n.valueMax[0],M=n.valueMin[1],A=n.valueMax[1],_=n.valueMin[2],D=n.valueMax[2],R=n.valueMin[3]==null?1:n.valueMin[3],I=n.valueMax[3]==null?1:n.valueMax[3],$=[Math.round(j+(T-j)*k),Math.round(M+(A-M)*k),Math.round(_+(D-_)*k),Math.round(R+(I-R)*k)];a={bypass:n.bypass,name:n.name,value:$,strValue:"rgb("+$[0]+", "+$[1]+", "+$[2]+")"}}else if(o.number){var B=n.valueMin+(n.valueMax-n.valueMin)*k;a=this.parse(n.name,B,n.bypass,h)}else return!1;if(!a)return y(),!1;a.mapping=n,n=a;break}case s.data:{for(var z=n.field.split("."),U=f.data,F=0;F<z.length&&U;F++){var Q=z[F];U=U[Q]}if(U!=null&&(a=this.parse(n.name,U,n.bypass,h)),!a)return y(),!1;a.mapping=n,n=a;break}case s.fn:{var K=n.value,L=n.fnValue!=null?n.fnValue:K(t);if(n.prevFnValue=L,L==null)return Lt("Custom function mappers may not return null (i.e. `"+n.name+"` for ele `"+t.id()+"` is null)"),!1;if(a=this.parse(n.name,L,n.bypass,h),!a)return Lt("Custom function mappers may not return invalid values for the property type (i.e. `"+n.name+"` for ele `"+t.id()+"` is invalid)"),!1;a.mapping=ss(n),n=a;break}case void 0:break;default:return!1}return l?(u?n.bypassed=c.bypassed:n.bypassed=c,i[n.name]=n):u?c.bypassed=n:i[n.name]=n,v(),!0};vn.cleanElements=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),!e)n._private.style={};else for(var i=n._private.style,a=Object.keys(i),s=0;s<a.length;s++){var o=a[s],l=i[o];l!=null&&(l.bypass?l.bypassed=null:i[o]=null)}}};vn.update=function(){var t=this._private.cy,e=t.mutableElements();e.updateStyle()};vn.updateTransitions=function(t,e){var r=this,n=t._private,i=t.pstyle("transition-property").value,a=t.pstyle("transition-duration").pfValue,s=t.pstyle("transition-delay").pfValue;if(i.length>0&&a>0){for(var o={},l=!1,c=0;c<i.length;c++){var u=i[c],f=t.pstyle(u),h=e[u];if(h){var m=h.prev,v=m,y=h.next!=null?h.next:f,x=!1,b=void 0,S=1e-6;v&&(Ee(v.pfValue)&&Ee(y.pfValue)?(x=y.pfValue-v.pfValue,b=v.pfValue+S*x):Ee(v.value)&&Ee(y.value)?(x=y.value-v.value,b=v.value+S*x):Ht(v.value)&&Ht(y.value)&&(x=v.value[0]!==y.value[0]||v.value[1]!==y.value[1]||v.value[2]!==y.value[2],b=v.strValue),x&&(o[u]=y.strValue,this.applyBypass(t,u,b),l=!0))}}if(!l)return;n.transitioning=!0,new nf(function(w){s>0?t.delayAnimation(s).play().promise().then(w):w()}).then(function(){return t.animation({style:o,duration:a,easing:t.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){r.removeBypasses(t,i),t.emitAndNotify("style"),n.transitioning=!1})}else n.transitioning&&(this.removeBypasses(t,i),t.emitAndNotify("style"),n.transitioning=!1)};vn.checkTrigger=function(t,e,r,n,i,a){var s=this.properties[e],o=i(s);t.removed()||o!=null&&o(r,n,t)&&a(s)};vn.checkZOrderTrigger=function(t,e,r,n){var i=this;this.checkTrigger(t,e,r,n,function(a){return a.triggersZOrder},function(){i._private.cy.notify("zorder",t)})};vn.checkBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBounds},function(i){t.dirtyCompoundBoundsCache(),t.dirtyBoundingBoxCache()})};vn.checkConnectedEdgesBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBoundsOfConnectedEdges},function(i){t.connectedEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};vn.checkParallelEdgesBoundsTrigger=function(t,e,r,n){this.checkTrigger(t,e,r,n,function(i){return i.triggersBoundsOfParallelEdges},function(i){t.parallelEdges().forEach(function(a){a.dirtyBoundingBoxCache()})})};vn.checkTriggers=function(t,e,r,n){t.dirtyStyleCache(),this.checkZOrderTrigger(t,e,r,n),this.checkBoundsTrigger(t,e,r,n),this.checkConnectedEdgesBoundsTrigger(t,e,r,n),this.checkParallelEdgesBoundsTrigger(t,e,r,n)};var sm={};sm.applyBypass=function(t,e,r,n){var i=this,a=[],s=!0;if(e==="*"||e==="**"){if(r!==void 0)for(var o=0;o<i.properties.length;o++){var l=i.properties[o],c=l.name,u=this.parse(c,r,!0);u&&a.push(u)}}else if(Ke(e)){var f=this.parse(e,r,!0);f&&a.push(f)}else if(Mt(e)){var h=e;n=r;for(var m=Object.keys(h),v=0;v<m.length;v++){var y=m[v],x=h[y];if(x===void 0&&(x=h[Qy(y)]),x!==void 0){var b=this.parse(y,x,!0);b&&a.push(b)}}}else return!1;if(a.length===0)return!1;for(var S=!1,w=0;w<t.length;w++){for(var k=t[w],N={},j=void 0,T=0;T<a.length;T++){var M=a[T];if(n){var A=k.pstyle(M.name);j=N[M.name]={prev:A}}S=this.applyParsedProperty(k,ss(M))||S,n&&(j.next=k.pstyle(M.name))}S&&this.updateStyleHints(k),n&&this.updateTransitions(k,N,s)}return S};sm.overrideBypass=function(t,e,r){e=XC(e);for(var n=0;n<t.length;n++){var i=t[n],a=i._private.style[e],s=this.properties[e].type,o=s.color,l=s.mutiple,c=a?a.pfValue!=null?a.pfValue:a.value:null;!a||!a.bypass?this.applyBypass(i,e,r):(a.value=r,a.pfValue!=null&&(a.pfValue=r),o?a.strValue="rgb("+r.join(",")+")":l?a.strValue=r.join(" "):a.strValue=""+r,this.updateStyleHints(i)),this.checkTriggers(i,e,c,r)}};sm.removeAllBypasses=function(t,e){return this.removeBypasses(t,this.propertyNames,e)};sm.removeBypasses=function(t,e,r){for(var n=!0,i=0;i<t.length;i++){for(var a=t[i],s={},o=0;o<e.length;o++){var l=e[o],c=this.properties[l],u=a.pstyle(c.name);if(!(!u||!u.bypass)){var f="",h=this.parse(l,f,!0),m=s[c.name]={prev:u};this.applyParsedProperty(a,h),m.next=a.pstyle(c.name)}}this.updateStyleHints(a),r&&this.updateTransitions(a,s,n)}};var d3={};d3.getEmSizeInPixels=function(){var t=this.containerCss("font-size");return t!=null?parseFloat(t):1};d3.containerCss=function(t){var e=this._private.cy,r=e.container(),n=e.window();if(n&&r&&n.getComputedStyle)return n.getComputedStyle(r).getPropertyValue(t)};var fs={};fs.getRenderedStyle=function(t,e){return e?this.getStylePropertyValue(t,e,!0):this.getRawStyle(t,!0)};fs.getRawStyle=function(t,e){var r=this;if(t=t[0],t){for(var n={},i=0;i<r.properties.length;i++){var a=r.properties[i],s=r.getStylePropertyValue(t,a.name,e);s!=null&&(n[a.name]=s,n[Qy(a.name)]=s)}return n}};fs.getIndexedStyle=function(t,e,r,n){var i=t.pstyle(e)[r][n];return i??t.cy().style().getDefaultProperty(e)[r][0]};fs.getStylePropertyValue=function(t,e,r){var n=this;if(t=t[0],t){var i=n.properties[e];i.alias&&(i=i.pointsTo);var a=i.type,s=t.pstyle(i.name);if(s){var o=s.value,l=s.units,c=s.strValue;if(r&&a.number&&o!=null&&Ee(o)){var u=t.cy().zoom(),f=function(x){return x*u},h=function(x,b){return f(x)+b},m=Ht(o),v=m?l.every(function(y){return y!=null}):l!=null;return v?m?o.map(function(y,x){return h(y,l[x])}).join(" "):h(o,l):m?o.map(function(y){return Ke(y)?y:""+f(y)}).join(" "):""+f(o)}else if(c!=null)return c}return null}};fs.getAnimationStartStyle=function(t,e){for(var r={},n=0;n<e.length;n++){var i=e[n],a=i.name,s=t.pstyle(a);s!==void 0&&(Mt(s)?s=this.parse(a,s.strValue):s=this.parse(a,s)),s&&(r[a]=s)}return r};fs.getPropsList=function(t){var e=this,r=[],n=t,i=e.properties;if(n)for(var a=Object.keys(n),s=0;s<a.length;s++){var o=a[s],l=n[o],c=i[o]||i[XC(o)],u=this.parse(c.name,l);u&&r.push(u)}return r};fs.getNonDefaultPropertiesHash=function(t,e,r){var n=r.slice(),i,a,s,o,l,c;for(l=0;l<e.length;l++)if(i=e[l],a=t.pstyle(i,!1),a!=null)if(a.pfValue!=null)n[0]=yp(o,n[0]),n[1]=xp(o,n[1]);else for(s=a.strValue,c=0;c<s.length;c++)o=s.charCodeAt(c),n[0]=yp(o,n[0]),n[1]=xp(o,n[1]);return n};fs.getPropertiesHash=fs.getNonDefaultPropertiesHash;var ux={};ux.appendFromJson=function(t){for(var e=this,r=0;r<t.length;r++){var n=t[r],i=n.selector,a=n.style||n.css,s=Object.keys(a);e.selector(i);for(var o=0;o<s.length;o++){var l=s[o],c=a[l];e.css(l,c)}}return e};ux.fromJson=function(t){var e=this;return e.resetToDefault(),e.appendFromJson(t),e};ux.json=function(){for(var t=[],e=this.defaultLength;e<this.length;e++){for(var r=this[e],n=r.selector,i=r.properties,a={},s=0;s<i.length;s++){var o=i[s];a[o.name]=o.strValue}t.push({selector:n?n.toString():"core",style:a})}return t};var f3={};f3.appendFromString=function(t){var e=this,r=this,n=""+t,i,a,s;n=n.replace(/[/][*](\s|.)+?[*][/]/g,"");function o(){n.length>i.length?n=n.substr(i.length):n=""}function l(){a.length>s.length?a=a.substr(s.length):a=""}for(;;){var c=n.match(/^\s*$/);if(c)break;var u=n.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!u){Lt("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+n);break}i=u[0];var f=u[1];if(f!=="core"){var h=new yl(f);if(h.invalid){Lt("Skipping parsing of block: Invalid selector found in string stylesheet: "+f),o();continue}}var m=u[2],v=!1;a=m;for(var y=[];;){var x=a.match(/^\s*$/);if(x)break;var b=a.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!b){Lt("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+m),v=!0;break}s=b[0];var S=b[1],w=b[2],k=e.properties[S];if(!k){Lt("Skipping property: Invalid property name in: "+s),l();continue}var N=r.parse(S,w);if(!N){Lt("Skipping property: Invalid property definition in: "+s),l();continue}y.push({name:S,val:w}),l()}if(v){o();break}r.selector(f);for(var j=0;j<y.length;j++){var T=y[j];r.css(T.name,T.val)}o()}return r};f3.fromString=function(t){var e=this;return e.resetToDefault(),e.appendFromString(t),e};var Fr={};(function(){var t=Jr,e=Y$,r=Q$,n=J$,i=Z$,a=function(Y){return"^"+Y+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},s=function(Y){var te=t+"|\\w+|"+e+"|"+r+"|"+n+"|"+i;return"^"+Y+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+t+")\\s*\\,\\s*("+t+")\\s*,\\s*("+te+")\\s*\\,\\s*("+te+")\\)$"},o=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];Fr.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},scratch:{mapping:!0,regex:a("scratch")},mapData:{mapping:!0,regex:s("mapData")},mapLayoutData:{mapping:!0,regex:s("mapLayoutData")},mapScratch:{mapping:!0,regex:s("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:o,singleRegexMatchValue:!0},urls:{regexes:o,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(Y,te){switch(Y.length){case 2:return te[0]!=="deg"&&te[0]!=="rad"&&te[1]!=="deg"&&te[1]!=="rad";case 1:return Ke(Y[0])||te[0]==="deg"||te[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(Y){var te=Y.length;return te===1||te===2||te===4}}};var l={zeroNonZero:function(Y,te){return(Y==null||te==null)&&Y!==te||Y==0&&te!=0?!0:Y!=0&&te==0},any:function(Y,te){return Y!=te},emptyNonEmpty:function(Y,te){var Z=ml(Y),ue=ml(te);return Z&&!ue||!Z&&ue}},c=Fr.types,u=[{name:"label",type:c.text,triggersBounds:l.any,triggersZOrder:l.emptyNonEmpty},{name:"text-rotation",type:c.textRotation,triggersBounds:l.any},{name:"text-margin-x",type:c.bidirectionalSize,triggersBounds:l.any},{name:"text-margin-y",type:c.bidirectionalSize,triggersBounds:l.any}],f=[{name:"source-label",type:c.text,triggersBounds:l.any},{name:"source-text-rotation",type:c.textRotation,triggersBounds:l.any},{name:"source-text-margin-x",type:c.bidirectionalSize,triggersBounds:l.any},{name:"source-text-margin-y",type:c.bidirectionalSize,triggersBounds:l.any},{name:"source-text-offset",type:c.size,triggersBounds:l.any}],h=[{name:"target-label",type:c.text,triggersBounds:l.any},{name:"target-text-rotation",type:c.textRotation,triggersBounds:l.any},{name:"target-text-margin-x",type:c.bidirectionalSize,triggersBounds:l.any},{name:"target-text-margin-y",type:c.bidirectionalSize,triggersBounds:l.any},{name:"target-text-offset",type:c.size,triggersBounds:l.any}],m=[{name:"font-family",type:c.fontFamily,triggersBounds:l.any},{name:"font-style",type:c.fontStyle,triggersBounds:l.any},{name:"font-weight",type:c.fontWeight,triggersBounds:l.any},{name:"font-size",type:c.size,triggersBounds:l.any},{name:"text-transform",type:c.textTransform,triggersBounds:l.any},{name:"text-wrap",type:c.textWrap,triggersBounds:l.any},{name:"text-overflow-wrap",type:c.textOverflowWrap,triggersBounds:l.any},{name:"text-max-width",type:c.size,triggersBounds:l.any},{name:"text-outline-width",type:c.size,triggersBounds:l.any},{name:"line-height",type:c.positiveNumber,triggersBounds:l.any}],v=[{name:"text-valign",type:c.valign,triggersBounds:l.any},{name:"text-halign",type:c.halign,triggersBounds:l.any},{name:"color",type:c.color},{name:"text-outline-color",type:c.color},{name:"text-outline-opacity",type:c.zeroOneNumber},{name:"text-background-color",type:c.color},{name:"text-background-opacity",type:c.zeroOneNumber},{name:"text-background-padding",type:c.size,triggersBounds:l.any},{name:"text-border-opacity",type:c.zeroOneNumber},{name:"text-border-color",type:c.color},{name:"text-border-width",type:c.size,triggersBounds:l.any},{name:"text-border-style",type:c.borderStyle,triggersBounds:l.any},{name:"text-background-shape",type:c.textBackgroundShape,triggersBounds:l.any},{name:"text-justification",type:c.justification},{name:"box-select-labels",type:c.bool,triggersBounds:l.any}],y=[{name:"events",type:c.bool,triggersZOrder:l.any},{name:"text-events",type:c.bool,triggersZOrder:l.any},{name:"box-selection",type:c.boxSelection,triggersZOrder:l.any}],x=[{name:"display",type:c.display,triggersZOrder:l.any,triggersBounds:l.any,triggersBoundsOfConnectedEdges:l.any,triggersBoundsOfParallelEdges:function(Y,te,Z){return Y===te?!1:Z.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:c.visibility,triggersZOrder:l.any},{name:"opacity",type:c.zeroOneNumber,triggersZOrder:l.zeroNonZero},{name:"text-opacity",type:c.zeroOneNumber},{name:"min-zoomed-font-size",type:c.size},{name:"z-compound-depth",type:c.zCompoundDepth,triggersZOrder:l.any},{name:"z-index-compare",type:c.zIndexCompare,triggersZOrder:l.any},{name:"z-index",type:c.number,triggersZOrder:l.any}],b=[{name:"overlay-padding",type:c.size,triggersBounds:l.any},{name:"overlay-color",type:c.color},{name:"overlay-opacity",type:c.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"overlay-shape",type:c.overlayShape,triggersBounds:l.any},{name:"overlay-corner-radius",type:c.cornerRadius}],S=[{name:"underlay-padding",type:c.size,triggersBounds:l.any},{name:"underlay-color",type:c.color},{name:"underlay-opacity",type:c.zeroOneNumber,triggersBounds:l.zeroNonZero},{name:"underlay-shape",type:c.overlayShape,triggersBounds:l.any},{name:"underlay-corner-radius",type:c.cornerRadius}],w=[{name:"transition-property",type:c.propList},{name:"transition-duration",type:c.time},{name:"transition-delay",type:c.time},{name:"transition-timing-function",type:c.easing}],k=function(Y,te){return te.value==="label"?-Y.poolIndex():te.pfValue},N=[{name:"height",type:c.nodeSize,triggersBounds:l.any,hashOverride:k},{name:"width",type:c.nodeSize,triggersBounds:l.any,hashOverride:k},{name:"shape",type:c.nodeShape,triggersBounds:l.any},{name:"shape-polygon-points",type:c.polygonPointList,triggersBounds:l.any},{name:"corner-radius",type:c.cornerRadius},{name:"background-color",type:c.color},{name:"background-fill",type:c.fill},{name:"background-opacity",type:c.zeroOneNumber},{name:"background-blacken",type:c.nOneOneNumber},{name:"background-gradient-stop-colors",type:c.colors},{name:"background-gradient-stop-positions",type:c.percentages},{name:"background-gradient-direction",type:c.gradientDirection},{name:"padding",type:c.sizeMaybePercent,triggersBounds:l.any},{name:"padding-relative-to",type:c.paddingRelativeTo,triggersBounds:l.any},{name:"bounds-expansion",type:c.boundsExpansion,triggersBounds:l.any}],j=[{name:"border-color",type:c.color},{name:"border-opacity",type:c.zeroOneNumber},{name:"border-width",type:c.size,triggersBounds:l.any},{name:"border-style",type:c.borderStyle},{name:"border-cap",type:c.lineCap},{name:"border-join",type:c.lineJoin},{name:"border-dash-pattern",type:c.numbers},{name:"border-dash-offset",type:c.number},{name:"border-position",type:c.linePosition}],T=[{name:"outline-color",type:c.color},{name:"outline-opacity",type:c.zeroOneNumber},{name:"outline-width",type:c.size,triggersBounds:l.any},{name:"outline-style",type:c.borderStyle},{name:"outline-offset",type:c.size,triggersBounds:l.any}],M=[{name:"background-image",type:c.urls},{name:"background-image-crossorigin",type:c.bgCrossOrigin},{name:"background-image-opacity",type:c.zeroOneNumbers},{name:"background-image-containment",type:c.bgContainment},{name:"background-image-smoothing",type:c.bools},{name:"background-position-x",type:c.bgPos},{name:"background-position-y",type:c.bgPos},{name:"background-width-relative-to",type:c.bgRelativeTo},{name:"background-height-relative-to",type:c.bgRelativeTo},{name:"background-repeat",type:c.bgRepeat},{name:"background-fit",type:c.bgFit},{name:"background-clip",type:c.bgClip},{name:"background-width",type:c.bgWH},{name:"background-height",type:c.bgWH},{name:"background-offset-x",type:c.bgPos},{name:"background-offset-y",type:c.bgPos}],A=[{name:"position",type:c.position,triggersBounds:l.any},{name:"compound-sizing-wrt-labels",type:c.compoundIncludeLabels,triggersBounds:l.any},{name:"min-width",type:c.size,triggersBounds:l.any},{name:"min-width-bias-left",type:c.sizeMaybePercent,triggersBounds:l.any},{name:"min-width-bias-right",type:c.sizeMaybePercent,triggersBounds:l.any},{name:"min-height",type:c.size,triggersBounds:l.any},{name:"min-height-bias-top",type:c.sizeMaybePercent,triggersBounds:l.any},{name:"min-height-bias-bottom",type:c.sizeMaybePercent,triggersBounds:l.any}],_=[{name:"line-style",type:c.lineStyle},{name:"line-color",type:c.color},{name:"line-fill",type:c.fill},{name:"line-cap",type:c.lineCap},{name:"line-opacity",type:c.zeroOneNumber},{name:"line-dash-pattern",type:c.numbers},{name:"line-dash-offset",type:c.number},{name:"line-outline-width",type:c.size},{name:"line-outline-color",type:c.color},{name:"line-gradient-stop-colors",type:c.colors},{name:"line-gradient-stop-positions",type:c.percentages},{name:"curve-style",type:c.curveStyle,triggersBounds:l.any,triggersBoundsOfParallelEdges:function(Y,te){return Y===te?!1:Y==="bezier"||te==="bezier"}},{name:"haystack-radius",type:c.zeroOneNumber,triggersBounds:l.any},{name:"source-endpoint",type:c.edgeEndpoint,triggersBounds:l.any},{name:"target-endpoint",type:c.edgeEndpoint,triggersBounds:l.any},{name:"control-point-step-size",type:c.size,triggersBounds:l.any},{name:"control-point-distances",type:c.bidirectionalSizes,triggersBounds:l.any},{name:"control-point-weights",type:c.numbers,triggersBounds:l.any},{name:"segment-distances",type:c.bidirectionalSizes,triggersBounds:l.any},{name:"segment-weights",type:c.numbers,triggersBounds:l.any},{name:"segment-radii",type:c.numbers,triggersBounds:l.any},{name:"radius-type",type:c.radiusType,triggersBounds:l.any},{name:"taxi-turn",type:c.bidirectionalSizeMaybePercent,triggersBounds:l.any},{name:"taxi-turn-min-distance",type:c.size,triggersBounds:l.any},{name:"taxi-direction",type:c.axisDirection,triggersBounds:l.any},{name:"taxi-radius",type:c.number,triggersBounds:l.any},{name:"edge-distances",type:c.edgeDistances,triggersBounds:l.any},{name:"arrow-scale",type:c.positiveNumber,triggersBounds:l.any},{name:"loop-direction",type:c.angle,triggersBounds:l.any},{name:"loop-sweep",type:c.angle,triggersBounds:l.any},{name:"source-distance-from-node",type:c.size,triggersBounds:l.any},{name:"target-distance-from-node",type:c.size,triggersBounds:l.any}],D=[{name:"ghost",type:c.bool,triggersBounds:l.any},{name:"ghost-offset-x",type:c.bidirectionalSize,triggersBounds:l.any},{name:"ghost-offset-y",type:c.bidirectionalSize,triggersBounds:l.any},{name:"ghost-opacity",type:c.zeroOneNumber}],R=[{name:"selection-box-color",type:c.color},{name:"selection-box-opacity",type:c.zeroOneNumber},{name:"selection-box-border-color",type:c.color},{name:"selection-box-border-width",type:c.size},{name:"active-bg-color",type:c.color},{name:"active-bg-opacity",type:c.zeroOneNumber},{name:"active-bg-size",type:c.size},{name:"outside-texture-bg-color",type:c.color},{name:"outside-texture-bg-opacity",type:c.zeroOneNumber}],I=[];Fr.pieBackgroundN=16,I.push({name:"pie-size",type:c.sizeMaybePercent}),I.push({name:"pie-hole",type:c.sizeMaybePercent}),I.push({name:"pie-start-angle",type:c.angle});for(var $=1;$<=Fr.pieBackgroundN;$++)I.push({name:"pie-"+$+"-background-color",type:c.color}),I.push({name:"pie-"+$+"-background-size",type:c.percent}),I.push({name:"pie-"+$+"-background-opacity",type:c.zeroOneNumber});var B=[];Fr.stripeBackgroundN=16,B.push({name:"stripe-size",type:c.sizeMaybePercent}),B.push({name:"stripe-direction",type:c.axisDirectionPrimary});for(var z=1;z<=Fr.stripeBackgroundN;z++)B.push({name:"stripe-"+z+"-background-color",type:c.color}),B.push({name:"stripe-"+z+"-background-size",type:c.percent}),B.push({name:"stripe-"+z+"-background-opacity",type:c.zeroOneNumber});var U=[],F=Fr.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:c.arrowShape,triggersBounds:l.any},{name:"arrow-color",type:c.color},{name:"arrow-fill",type:c.arrowFill},{name:"arrow-width",type:c.arrowWidth}].forEach(function(V){F.forEach(function(Y){var te=Y+"-"+V.name,Z=V.type,ue=V.triggersBounds;U.push({name:te,type:Z,triggersBounds:ue})})},{});var Q=Fr.properties=[].concat(y,w,x,b,S,D,v,m,u,f,h,N,j,T,M,I,B,A,_,U,R),K=Fr.propertyGroups={behavior:y,transition:w,visibility:x,overlay:b,underlay:S,ghost:D,commonLabel:v,labelDimensions:m,mainLabel:u,sourceLabel:f,targetLabel:h,nodeBody:N,nodeBorder:j,nodeOutline:T,backgroundImage:M,pie:I,stripe:B,compound:A,edgeLine:_,edgeArrow:U,core:R},L=Fr.propertyGroupNames={},G=Fr.propertyGroupKeys=Object.keys(K);G.forEach(function(V){L[V]=K[V].map(function(Y){return Y.name}),K[V].forEach(function(Y){return Y.groupKey=V})});var ee=Fr.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Fr.propertyNames=Q.map(function(V){return V.name});for(var re=0;re<Q.length;re++){var se=Q[re];Q[se.name]=se}for(var de=0;de<ee.length;de++){var W=ee[de],ne=Q[W.pointsTo],ie={name:W.name,alias:!0,pointsTo:ne};Q.push(ie),Q[W.name]=ie}})();Fr.getDefaultProperty=function(t){return this.getDefaultProperties()[t]};Fr.getDefaultProperties=function(){var t=this._private;if(t.defaultProperties!=null)return t.defaultProperties;for(var e=Qe({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(l,c){for(var u=1;u<=Fr.pieBackgroundN;u++){var f=c.name.replace("{{i}}",u),h=c.value;l[f]=h}return l},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(l,c){for(var u=1;u<=Fr.stripeBackgroundN;u++){var f=c.name.replace("{{i}}",u),h=c.value;l[f]=h}return l},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(l,c){return Fr.arrowPrefixes.forEach(function(u){var f=u+"-"+c.name,h=c.value;l[f]=h}),l},{})),r={},n=0;n<this.properties.length;n++){var i=this.properties[n];if(!i.pointsTo){var a=i.name,s=e[a],o=this.parse(a,s);r[a]=o}}return t.defaultProperties=r,t.defaultProperties};Fr.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var dx={};dx.parse=function(t,e,r,n){var i=this;if(vr(e))return i.parseImplWarn(t,e,r,n);var a=n==="mapping"||n===!0||n===!1||n==null?"dontcare":n,s=r?"t":"f",o=""+e,l=qA(t,o,s,a),c=i.propCache=i.propCache||[],u;return(u=c[l])||(u=c[l]=i.parseImplWarn(t,e,r,n)),(r||n==="mapping")&&(u=ss(u),u&&(u.value=ss(u.value))),u};dx.parseImplWarn=function(t,e,r,n){var i=this.parseImpl(t,e,r,n);return!i&&e!=null&&Lt("The style property `".concat(t,": ").concat(e,"` is invalid")),i&&(i.name==="width"||i.name==="height")&&e==="label"&&Lt("The style value of `label` is deprecated for `"+i.name+"`"),i};dx.parseImpl=function(t,e,r,n){var i=this;t=XC(t);var a=i.properties[t],s=e,o=i.types;if(!a||e===void 0)return null;a.alias&&(a=a.pointsTo,t=a.name);var l=Ke(e);l&&(e=e.trim());var c=a.type;if(!c)return null;if(r&&(e===""||e===null))return{name:t,value:e,bypass:!0,deleteBypass:!0};if(vr(e))return{name:t,value:e,strValue:"fn",mapped:o.fn,bypass:r};var u,f;if(!(!l||n||e.length<7||e[1]!=="a")){if(e.length>=7&&e[0]==="d"&&(u=new RegExp(o.data.regex).exec(e))){if(r)return!1;var h=o.data;return{name:t,value:u,strValue:""+e,mapped:h,field:u[1],bypass:r}}else if(e.length>=10&&e[0]==="m"&&(f=new RegExp(o.mapData.regex).exec(e))){if(r||c.multiple)return!1;var m=o.mapData;if(!(c.color||c.number))return!1;var v=this.parse(t,f[4]);if(!v||v.mapped)return!1;var y=this.parse(t,f[5]);if(!y||y.mapped)return!1;if(v.pfValue===y.pfValue||v.strValue===y.strValue)return Lt("`"+t+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+t+": "+v.strValue+"`"),this.parse(t,v.strValue);if(c.color){var x=v.value,b=y.value,S=x[0]===b[0]&&x[1]===b[1]&&x[2]===b[2]&&(x[3]===b[3]||(x[3]==null||x[3]===1)&&(b[3]==null||b[3]===1));if(S)return!1}return{name:t,value:f,strValue:""+e,mapped:m,field:f[1],fieldMin:parseFloat(f[2]),fieldMax:parseFloat(f[3]),valueMin:v.value,valueMax:y.value,bypass:r}}}if(c.multiple&&n!=="multiple"){var w;if(l?w=e.split(/\s+/):Ht(e)?w=e:w=[e],c.evenMultiple&&w.length%2!==0)return null;for(var k=[],N=[],j=[],T="",M=!1,A=0;A<w.length;A++){var _=i.parse(t,w[A],r,"multiple");M=M||Ke(_.value),k.push(_.value),j.push(_.pfValue!=null?_.pfValue:_.value),N.push(_.units),T+=(A>0?" ":"")+_.strValue}return c.validate&&!c.validate(k,N)?null:c.singleEnum&&M?k.length===1&&Ke(k[0])?{name:t,value:k[0],strValue:k[0],bypass:r}:null:{name:t,value:k,pfValue:j,strValue:T,bypass:r,units:N}}var D=function(){for(var ie=0;ie<c.enums.length;ie++){var V=c.enums[ie];if(V===e)return{name:t,value:e,strValue:""+e,bypass:r}}return null};if(c.number){var R,I="px";if(c.units&&(R=c.units),c.implicitUnits&&(I=c.implicitUnits),!c.unitless)if(l){var $="px|em"+(c.allowPercent?"|\\%":"");R&&($=R);var B=e.match("^("+Jr+")("+$+")?$");B&&(e=B[1],R=B[2]||I)}else(!R||c.implicitUnits)&&(R=I);if(e=parseFloat(e),isNaN(e)&&c.enums===void 0)return null;if(isNaN(e)&&c.enums!==void 0)return e=s,D();if(c.integer&&!$$(e)||c.min!==void 0&&(e<c.min||c.strictMin&&e===c.min)||c.max!==void 0&&(e>c.max||c.strictMax&&e===c.max))return null;var z={name:t,value:e,strValue:""+e+(R||""),units:R,bypass:r};return c.unitless||R!=="px"&&R!=="em"?z.pfValue=e:z.pfValue=R==="px"||!R?e:this.getEmSizeInPixels()*e,(R==="ms"||R==="s")&&(z.pfValue=R==="ms"?e:1e3*e),(R==="deg"||R==="rad")&&(z.pfValue=R==="rad"?e:JU(e)),R==="%"&&(z.pfValue=e/100),z}else if(c.propList){var U=[],F=""+e;if(F!=="none"){for(var Q=F.split(/\s*,\s*|\s+/),K=0;K<Q.length;K++){var L=Q[K].trim();i.properties[L]?U.push(L):Lt("`"+L+"` is not a valid property name")}if(U.length===0)return null}return{name:t,value:U,strValue:U.length===0?"none":U.join(" "),bypass:r}}else if(c.color){var G=zA(e);return G?{name:t,value:G,pfValue:G,strValue:"rgb("+G[0]+","+G[1]+","+G[2]+")",bypass:r}:null}else if(c.regex||c.regexes){if(c.enums){var ee=D();if(ee)return ee}for(var re=c.regexes?c.regexes:[c.regex],se=0;se<re.length;se++){var de=new RegExp(re[se]),W=de.exec(e);if(W)return{name:t,value:c.singleRegexMatchValue?W[1]:W,strValue:""+e,bypass:r}}return null}else return c.string?{name:t,value:""+e,strValue:""+e,bypass:r}:c.enums?D():null};var pn=function(e){if(!(this instanceof pn))return new pn(e);if(!YC(e)){lr("A style must have a core reference");return}this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()},Hn=pn.prototype;Hn.instanceString=function(){return"style"};Hn.clear=function(){for(var t=this._private,e=t.cy,r=e.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,t.contextStyles={},t.propDiffs={},this.cleanElements(r,!0),r.forEach(function(i){var a=i[0]._private;a.styleDirty=!0,a.appliedInitStyle=!1}),this};Hn.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};Hn.core=function(t){return this._private.coreStyle[t]||this.getDefaultProperty(t)};Hn.selector=function(t){var e=t==="core"?null:new yl(t),r=this.length++;return this[r]={selector:e,properties:[],mappedProperties:[],index:r},this};Hn.css=function(){var t=this,e=arguments;if(e.length===1)for(var r=e[0],n=0;n<t.properties.length;n++){var i=t.properties[n],a=r[i.name];a===void 0&&(a=r[Qy(i.name)]),a!==void 0&&this.cssRule(i.name,a)}else e.length===2&&this.cssRule(e[0],e[1]);return this};Hn.style=Hn.css;Hn.cssRule=function(t,e){var r=this.parse(t,e);if(r){var n=this.length-1;this[n].properties.push(r),this[n].properties[r.name]=r,r.name.match(/pie-(\d+)-background-size/)&&r.value&&(this._private.hasPie=!0),r.name.match(/stripe-(\d+)-background-size/)&&r.value&&(this._private.hasStripe=!0),r.mapped&&this[n].mappedProperties.push(r);var i=!this[n].selector;i&&(this._private.coreStyle[r.name]=r)}return this};Hn.append=function(t){return LA(t)?t.appendToStyle(this):Ht(t)?this.appendFromJson(t):Ke(t)&&this.appendFromString(t),this};pn.fromJson=function(t,e){var r=new pn(t);return r.fromJson(e),r};pn.fromString=function(t,e){return new pn(t).fromString(e)};[vn,sm,d3,fs,ux,f3,Fr,dx].forEach(function(t){Qe(Hn,t)});pn.types=Hn.types;pn.properties=Hn.properties;pn.propertyGroups=Hn.propertyGroups;pn.propertyGroupNames=Hn.propertyGroupNames;pn.propertyGroupKeys=Hn.propertyGroupKeys;var rq={style:function(e){if(e){var r=this.setStyle(e);r.update()}return this._private.style},setStyle:function(e){var r=this._private;return LA(e)?r.style=e.generateStyle(this):Ht(e)?r.style=pn.fromJson(this,e):Ke(e)?r.style=pn.fromString(this,e):r.style=pn(this),r.style},updateStyle:function(){this.mutableElements().updateStyle()}},nq="single",Vc={autolock:function(e){if(e!==void 0)this._private.autolock=!!e;else return this._private.autolock;return this},autoungrabify:function(e){if(e!==void 0)this._private.autoungrabify=!!e;else return this._private.autoungrabify;return this},autounselectify:function(e){if(e!==void 0)this._private.autounselectify=!!e;else return this._private.autounselectify;return this},selectionType:function(e){var r=this._private;if(r.selectionType==null&&(r.selectionType=nq),e!==void 0)(e==="additive"||e==="single")&&(r.selectionType=e);else return r.selectionType;return this},panningEnabled:function(e){if(e!==void 0)this._private.panningEnabled=!!e;else return this._private.panningEnabled;return this},userPanningEnabled:function(e){if(e!==void 0)this._private.userPanningEnabled=!!e;else return this._private.userPanningEnabled;return this},zoomingEnabled:function(e){if(e!==void 0)this._private.zoomingEnabled=!!e;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function(e){if(e!==void 0)this._private.userZoomingEnabled=!!e;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function(e){if(e!==void 0)this._private.boxSelectionEnabled=!!e;else return this._private.boxSelectionEnabled;return this},pan:function(){var e=arguments,r=this._private.pan,n,i,a,s,o;switch(e.length){case 0:return r;case 1:if(Ke(e[0]))return n=e[0],r[n];if(Mt(e[0])){if(!this._private.panningEnabled)return this;a=e[0],s=a.x,o=a.y,Ee(s)&&(r.x=s),Ee(o)&&(r.y=o),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;n=e[0],i=e[1],(n==="x"||n==="y")&&Ee(i)&&(r[n]=i),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function(e,r){var n=arguments,i=this._private.pan,a,s,o,l,c;if(!this._private.panningEnabled)return this;switch(n.length){case 1:Mt(e)&&(o=n[0],l=o.x,c=o.y,Ee(l)&&(i.x+=l),Ee(c)&&(i.y+=c),this.emit("pan viewport"));break;case 2:a=e,s=r,(a==="x"||a==="y")&&Ee(s)&&(i[a]+=s),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function(){this.notify("gc")},fit:function(e,r){var n=this.getFitViewport(e,r);if(n){var i=this._private;i.zoom=n.zoom,i.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,r){if(Ee(e)&&r===void 0&&(r=e,e=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var n;if(Ke(e)){var i=e;e=this.$(i)}else if(H$(e)){var a=e;n={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},n.w=n.x2-n.x1,n.h=n.y2-n.y1}else Ai(e)||(e=this.mutableElements());if(!(Ai(e)&&e.empty())){n=n||e.boundingBox();var s=this.width(),o=this.height(),l;if(r=Ee(r)?r:0,!isNaN(s)&&!isNaN(o)&&s>0&&o>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0){l=Math.min((s-2*r)/n.w,(o-2*r)/n.h),l=l>this._private.maxZoom?this._private.maxZoom:l,l=l<this._private.minZoom?this._private.minZoom:l;var c={x:(s-l*(n.x1+n.x2))/2,y:(o-l*(n.y1+n.y2))/2};return{zoom:l,pan:c}}}}},zoomRange:function(e,r){var n=this._private;if(r==null){var i=e;e=i.min,r=i.max}return Ee(e)&&Ee(r)&&e<=r?(n.minZoom=e,n.maxZoom=r):Ee(e)&&r===void 0&&e<=n.maxZoom?n.minZoom=e:Ee(r)&&e===void 0&&r>=n.minZoom&&(n.maxZoom=r),this},minZoom:function(e){return e===void 0?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return e===void 0?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var r=this._private,n=r.pan,i=r.zoom,a,s,o=!1;if(r.zoomingEnabled||(o=!0),Ee(e)?s=e:Mt(e)&&(s=e.level,e.position!=null?a=ex(e.position,i,n):e.renderedPosition!=null&&(a=e.renderedPosition),a!=null&&!r.panningEnabled&&(o=!0)),s=s>r.maxZoom?r.maxZoom:s,s=s<r.minZoom?r.minZoom:s,o||!Ee(s)||s===i||a!=null&&(!Ee(a.x)||!Ee(a.y)))return null;if(a!=null){var l=n,c=i,u=s,f={x:-u/c*(a.x-l.x)+a.x,y:-u/c*(a.y-l.y)+a.y};return{zoomed:!0,panned:!0,zoom:u,pan:f}}else return{zoomed:!0,panned:!1,zoom:s,pan:n}},zoom:function(e){if(e===void 0)return this._private.zoom;var r=this.getZoomedViewport(e),n=this._private;return r==null||!r.zoomed?this:(n.zoom=r.zoom,r.panned&&(n.pan.x=r.pan.x,n.pan.y=r.pan.y),this.emit("zoom"+(r.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function(e){var r=this._private,n=!0,i=!0,a=[],s=!1,o=!1;if(!e)return this;if(Ee(e.zoom)||(n=!1),Mt(e.pan)||(i=!1),!n&&!i)return this;if(n){var l=e.zoom;l<r.minZoom||l>r.maxZoom||!r.zoomingEnabled?s=!0:(r.zoom=l,a.push("zoom"))}if(i&&(!s||!e.cancelOnFailedZoom)&&r.panningEnabled){var c=e.pan;Ee(c.x)&&(r.pan.x=c.x,o=!1),Ee(c.y)&&(r.pan.y=c.y,o=!1),o||a.push("pan")}return a.length>0&&(a.push("viewport"),this.emit(a.join(" ")),this.notify("viewport")),this},center:function(e){var r=this.getCenterPan(e);return r&&(this._private.pan=r,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,r){if(this._private.panningEnabled){if(Ke(e)){var n=e;e=this.mutableElements().filter(n)}else Ai(e)||(e=this.mutableElements());if(e.length!==0){var i=e.boundingBox(),a=this.width(),s=this.height();r=r===void 0?this._private.zoom:r;var o={x:(a-r*(i.x1+i.x2))/2,y:(s-r*(i.y1+i.y2))/2};return o}}},reset:function(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e=this._private,r=e.container,n=this;return e.sizeCache=e.sizeCache||(r?function(){var i=n.window().getComputedStyle(r),a=function(o){return parseFloat(i.getPropertyValue(o))};return{width:r.clientWidth-a("padding-left")-a("padding-right"),height:r.clientHeight-a("padding-top")-a("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,r=this._private.zoom,n=this.renderedExtent(),i={x1:(n.x1-e.x)/r,x2:(n.x2-e.x)/r,y1:(n.y1-e.y)/r,y2:(n.y2-e.y)/r};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var e=this.width(),r=this.height();return{x1:0,y1:0,x2:e,y2:r,w:e,h:r}},multiClickDebounceTime:function(e){if(e)this._private.multiClickDebounceTime=e;else return this._private.multiClickDebounceTime;return this}};Vc.centre=Vc.center;Vc.autolockNodes=Vc.autolock;Vc.autoungrabifyNodes=Vc.autoungrabify;var Np={data:It.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:It.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:It.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:It.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};Np.attr=Np.data;Np.removeAttr=Np.removeData;var Ep=function(e){var r=this;e=Qe({},e);var n=e.container;n&&!S0(n)&&S0(n[0])&&(n=n[0]);var i=n?n._cyreg:null;i=i||{},i&&i.cy&&(i.cy.destroy(),i={});var a=i.readies=i.readies||[];n&&(n._cyreg=i),i.cy=r;var s=Yr!==void 0&&n!==void 0&&!e.headless,o=e;o.layout=Qe({name:s?"grid":"null"},o.layout),o.renderer=Qe({name:s?"canvas":"null"},o.renderer);var l=function(v,y,x){return y!==void 0?y:x!==void 0?x:v},c=this._private={container:n,ready:!1,options:o,elements:new Tn(this),listeners:[],aniEles:new Tn(this),data:o.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:l(!0,o.zoomingEnabled),userZoomingEnabled:l(!0,o.userZoomingEnabled),panningEnabled:l(!0,o.panningEnabled),userPanningEnabled:l(!0,o.userPanningEnabled),boxSelectionEnabled:l(!0,o.boxSelectionEnabled),autolock:l(!1,o.autolock,o.autolockNodes),autoungrabify:l(!1,o.autoungrabify,o.autoungrabifyNodes),autounselectify:l(!1,o.autounselectify),styleEnabled:o.styleEnabled===void 0?s:o.styleEnabled,zoom:Ee(o.zoom)?o.zoom:1,pan:{x:Mt(o.pan)&&Ee(o.pan.x)?o.pan.x:0,y:Mt(o.pan)&&Ee(o.pan.y)?o.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:l(250,o.multiClickDebounceTime)};this.createEmitter(),this.selectionType(o.selectionType),this.zoomRange({min:o.minZoom,max:o.maxZoom});var u=function(v,y){var x=v.some(W$);if(x)return nf.all(v).then(y);y(v)};c.styleEnabled&&r.setStyle([]);var f=Qe({},o,o.renderer);r.initRenderer(f);var h=function(v,y,x){r.notifications(!1);var b=r.mutableElements();b.length>0&&b.remove(),v!=null&&(Mt(v)||Ht(v))&&r.add(v),r.one("layoutready",function(w){r.notifications(!0),r.emit(w),r.one("load",y),r.emitAndNotify("load")}).one("layoutstop",function(){r.one("done",x),r.emit("done")});var S=Qe({},r._private.options.layout);S.eles=r.elements(),r.layout(S).run()};u([o.style,o.elements],function(m){var v=m[0],y=m[1];c.styleEnabled&&r.style().append(v),h(y,function(){r.startAnimationLoop(),c.ready=!0,vr(o.ready)&&r.on("ready",o.ready);for(var x=0;x<a.length;x++){var b=a[x];r.on("ready",b)}i&&(i.readies=[]),r.emit("ready")},o.done)})},M0=Ep.prototype;Qe(M0,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},window:function(){var e=this._private.container;if(e==null)return Yr;var r=this._private.container.ownerDocument;return r===void 0||r==null?Yr:r.defaultView||Yr},mount:function(e){if(e!=null){var r=this,n=r._private,i=n.options;return!S0(e)&&S0(e[0])&&(e=e[0]),r.stopAnimationLoop(),r.destroyRenderer(),n.container=e,n.styleEnabled=!0,r.invalidateSize(),r.initRenderer(Qe({},i,i.renderer,{name:i.renderer.name==="null"?"canvas":i.renderer.name})),r.startAnimationLoop(),r.style(i.style),r.emit("mount"),r}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return ss(this._private.options)},json:function(e){var r=this,n=r._private,i=r.mutableElements(),a=function(k){return r.getElementById(k.id())};if(Mt(e)){if(r.startBatch(),e.elements){var s={},o=function(k,N){for(var j=[],T=[],M=0;M<k.length;M++){var A=k[M];if(!A.data.id){Lt("cy.json() cannot handle elements without an ID attribute");continue}var _=""+A.data.id,D=r.getElementById(_);s[_]=!0,D.length!==0?T.push({ele:D,json:A}):(N&&(A.group=N),j.push(A))}r.add(j);for(var R=0;R<T.length;R++){var I=T[R],$=I.ele,B=I.json;$.json(B)}};if(Ht(e.elements))o(e.elements);else for(var l=["nodes","edges"],c=0;c<l.length;c++){var u=l[c],f=e.elements[u];Ht(f)&&o(f,u)}var h=r.collection();i.filter(function(w){return!s[w.id()]}).forEach(function(w){w.isParent()?h.merge(w):w.remove()}),h.forEach(function(w){return w.children().move({parent:null})}),h.forEach(function(w){return a(w).remove()})}e.style&&r.style(e.style),e.zoom!=null&&e.zoom!==n.zoom&&r.zoom(e.zoom),e.pan&&(e.pan.x!==n.pan.x||e.pan.y!==n.pan.y)&&r.pan(e.pan),e.data&&r.data(e.data);for(var m=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],v=0;v<m.length;v++){var y=m[v];e[y]!=null&&r[y](e[y])}return r.endBatch(),this}else{var x=!!e,b={};x?b.elements=this.elements().map(function(w){return w.json()}):(b.elements={},i.forEach(function(w){var k=w.group();b.elements[k]||(b.elements[k]=[]),b.elements[k].push(w.json())})),this._private.styleEnabled&&(b.style=r.style().json()),b.data=ss(r.data());var S=n.options;return b.zoomingEnabled=n.zoomingEnabled,b.userZoomingEnabled=n.userZoomingEnabled,b.zoom=n.zoom,b.minZoom=n.minZoom,b.maxZoom=n.maxZoom,b.panningEnabled=n.panningEnabled,b.userPanningEnabled=n.userPanningEnabled,b.pan=ss(n.pan),b.boxSelectionEnabled=n.boxSelectionEnabled,b.renderer=ss(S.renderer),b.hideEdgesOnViewport=S.hideEdgesOnViewport,b.textureOnViewport=S.textureOnViewport,b.wheelSensitivity=S.wheelSensitivity,b.motionBlur=S.motionBlur,b.multiClickDebounceTime=S.multiClickDebounceTime,b}}});M0.$id=M0.getElementById;[WW,QW,LR,H5,Rv,ZW,W5,Dv,rq,Vc,Np].forEach(function(t){Qe(M0,t)});var iq={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}},aq={maximal:!1,acyclic:!1},_u=function(e){return e.scratch("breadthfirst")},_8=function(e,r){return e.scratch("breadthfirst",r)};function BR(t){this.options=Qe({},iq,aq,t)}BR.prototype.run=function(){var t=this.options,e=t.cy,r=t.eles,n=r.nodes().filter(function(Ge){return Ge.isChildless()}),i=r,a=t.directed,s=t.acyclic||t.maximal||t.maximalAdjustments>0,o=!!t.boundingBox,l=ei(o?t.boundingBox:structuredClone(e.extent())),c;if(Ai(t.roots))c=t.roots;else if(Ht(t.roots)){for(var u=[],f=0;f<t.roots.length;f++){var h=t.roots[f],m=e.getElementById(h);u.push(m)}c=e.collection(u)}else if(Ke(t.roots))c=e.$(t.roots);else if(a)c=n.roots();else{var v=r.components();c=e.collection();for(var y=function(){var Ce=v[x],Re=Ce.maxDegree(!1),Ve=Ce.filter(function(We){return We.degree(!1)===Re});c=c.add(Ve)},x=0;x<v.length;x++)y()}var b=[],S={},w=function(Ce,Re){b[Re]==null&&(b[Re]=[]);var Ve=b[Re].length;b[Re].push(Ce),_8(Ce,{index:Ve,depth:Re})},k=function(Ce,Re){var Ve=_u(Ce),We=Ve.depth,Oe=Ve.index;b[We][Oe]=null,Ce.isChildless()&&w(Ce,Re)};i.bfs({roots:c,directed:t.directed,visit:function(Ce,Re,Ve,We,Oe){var rt=Ce[0],ct=rt.id();rt.isChildless()&&w(rt,Oe),S[ct]=!0}});for(var N=[],j=0;j<n.length;j++){var T=n[j];S[T.id()]||N.push(T)}var M=function(Ce){for(var Re=b[Ce],Ve=0;Ve<Re.length;Ve++){var We=Re[Ve];if(We==null){Re.splice(Ve,1),Ve--;continue}_8(We,{depth:Ce,index:Ve})}},A=function(Ce,Re){for(var Ve=_u(Ce),We=Ce.incomers().filter(function(Je){return Je.isNode()&&r.has(Je)}),Oe=-1,rt=Ce.id(),ct=0;ct<We.length;ct++){var xt=We[ct],bt=_u(xt);Oe=Math.max(Oe,bt.depth)}if(Ve.depth<=Oe){if(!t.acyclic&&Re[rt])return null;var Et=Oe+1;return k(Ce,Et),Re[rt]=Et,!0}return!1};if(a&&s){var _=[],D={},R=function(Ce){return _.push(Ce)},I=function(){return _.shift()};for(n.forEach(function(Ge){return _.push(Ge)});_.length>0;){var $=I(),B=A($,D);if(B)$.outgoers().filter(function(Ge){return Ge.isNode()&&r.has(Ge)}).forEach(R);else if(B===null){Lt("Detected double maximal shift for node `"+$.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var z=0;if(t.avoidOverlap)for(var U=0;U<n.length;U++){var F=n[U],Q=F.layoutDimensions(t),K=Q.w,L=Q.h;z=Math.max(z,K,L)}var G={},ee=function(Ce){if(G[Ce.id()])return G[Ce.id()];for(var Re=_u(Ce).depth,Ve=Ce.neighborhood(),We=0,Oe=0,rt=0;rt<Ve.length;rt++){var ct=Ve[rt];if(!(ct.isEdge()||ct.isParent()||!n.has(ct))){var xt=_u(ct);if(xt!=null){var bt=xt.index,Et=xt.depth;if(!(bt==null||Et==null)){var Je=b[Et].length;Et<Re&&(We+=bt/Je,Oe++)}}}}return Oe=Math.max(1,Oe),We=We/Oe,Oe===0&&(We=0),G[Ce.id()]=We,We},re=function(Ce,Re){var Ve=ee(Ce),We=ee(Re),Oe=Ve-We;return Oe===0?FA(Ce.id(),Re.id()):Oe};t.depthSort!==void 0&&(re=t.depthSort);for(var se=b.length,de=0;de<se;de++)b[de].sort(re),M(de);for(var W=[],ne=0;ne<N.length;ne++)W.push(N[ne]);var ie=function(){for(var Ce=0;Ce<se;Ce++)M(Ce)};W.length&&(b.unshift(W),se=b.length,ie());for(var V=0,Y=0;Y<se;Y++)V=Math.max(b[Y].length,V);var te={x:l.x1+l.w/2,y:l.y1+l.h/2},Z=n.reduce(function(Ge,Ce){return function(Re){return{w:Ge.w===-1?Re.w:(Ge.w+Re.w)/2,h:Ge.h===-1?Re.h:(Ge.h+Re.h)/2}}(Ce.boundingBox({includeLabels:t.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),ue=Math.max(se===1?0:o?(l.h-t.padding*2-Z.h)/(se-1):(l.h-t.padding*2-Z.h)/(se+1),z),ge=b.reduce(function(Ge,Ce){return Math.max(Ge,Ce.length)},0),Ue=function(Ce){var Re=_u(Ce),Ve=Re.depth,We=Re.index;if(t.circle){var Oe=Math.min(l.w/2/se,l.h/2/se);Oe=Math.max(Oe,z);var rt=Oe*Ve+Oe-(se>0&&b[0].length<=3?Oe/2:0),ct=2*Math.PI/b[Ve].length*We;return Ve===0&&b[0].length===1&&(rt=1),{x:te.x+rt*Math.cos(ct),y:te.y+rt*Math.sin(ct)}}else{var xt=b[Ve].length,bt=Math.max(xt===1?0:o?(l.w-t.padding*2-Z.w)/((t.grid?ge:xt)-1):(l.w-t.padding*2-Z.w)/((t.grid?ge:xt)+1),z),Et={x:te.x+(We+1-(xt+1)/2)*bt,y:te.y+(Ve+1-(se+1)/2)*ue};return Et}},Pe={downward:0,leftward:90,upward:180,rightward:-90};Object.keys(Pe).indexOf(t.direction)===-1&&lr("Invalid direction '".concat(t.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(Pe).join(", ")));var ze=function(Ce){return wU(Ue(Ce),l,Pe[t.direction])};return r.nodes().layoutPositions(this,t,ze),this};var sq={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function FR(t){this.options=Qe({},sq,t)}FR.prototype.run=function(){var t=this.options,e=t,r=t.cy,n=e.eles,i=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,a=n.nodes().not(":parent");e.sort&&(a=a.sort(e.sort));for(var s=ei(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()}),o={x:s.x1+s.w/2,y:s.y1+s.h/2},l=e.sweep===void 0?2*Math.PI-2*Math.PI/a.length:e.sweep,c=l/Math.max(1,a.length-1),u,f=0,h=0;h<a.length;h++){var m=a[h],v=m.layoutDimensions(e),y=v.w,x=v.h;f=Math.max(f,y,x)}if(Ee(e.radius)?u=e.radius:a.length<=1?u=0:u=Math.min(s.h,s.w)/2-f,a.length>1&&e.avoidOverlap){f*=1.75;var b=Math.cos(c)-Math.cos(0),S=Math.sin(c)-Math.sin(0),w=Math.sqrt(f*f/(b*b+S*S));u=Math.max(w,u)}var k=function(j,T){var M=e.startAngle+T*c*(i?1:-1),A=u*Math.cos(M),_=u*Math.sin(M),D={x:o.x+A,y:o.y+_};return D};return n.nodes().layoutPositions(this,e,k),this};var oq={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function zR(t){this.options=Qe({},oq,t)}zR.prototype.run=function(){for(var t=this.options,e=t,r=e.counterclockwise!==void 0?!e.counterclockwise:e.clockwise,n=t.cy,i=e.eles,a=i.nodes().not(":parent"),s=ei(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),o={x:s.x1+s.w/2,y:s.y1+s.h/2},l=[],c=0,u=0;u<a.length;u++){var f=a[u],h=void 0;h=e.concentric(f),l.push({value:h,node:f}),f._private.scratch.concentric=h}a.updateStyle();for(var m=0;m<a.length;m++){var v=a[m],y=v.layoutDimensions(e);c=Math.max(c,y.w,y.h)}l.sort(function(ue,ge){return ge.value-ue.value});for(var x=e.levelWidth(a),b=[[]],S=b[0],w=0;w<l.length;w++){var k=l[w];if(S.length>0){var N=Math.abs(S[0].value-k.value);N>=x&&(S=[],b.push(S))}S.push(k)}var j=c+e.minNodeSpacing;if(!e.avoidOverlap){var T=b.length>0&&b[0].length>1,M=Math.min(s.w,s.h)/2-j,A=M/(b.length+T?1:0);j=Math.min(j,A)}for(var _=0,D=0;D<b.length;D++){var R=b[D],I=e.sweep===void 0?2*Math.PI-2*Math.PI/R.length:e.sweep,$=R.dTheta=I/Math.max(1,R.length-1);if(R.length>1&&e.avoidOverlap){var B=Math.cos($)-Math.cos(0),z=Math.sin($)-Math.sin(0),U=Math.sqrt(j*j/(B*B+z*z));_=Math.max(U,_)}R.r=_,_+=j}if(e.equidistant){for(var F=0,Q=0,K=0;K<b.length;K++){var L=b[K],G=L.r-Q;F=Math.max(F,G)}Q=0;for(var ee=0;ee<b.length;ee++){var re=b[ee];ee===0&&(Q=re.r),re.r=Q,Q+=F}}for(var se={},de=0;de<b.length;de++)for(var W=b[de],ne=W.dTheta,ie=W.r,V=0;V<W.length;V++){var Y=W[V],te=e.startAngle+(r?1:-1)*ne*V,Z={x:o.x+ie*Math.cos(te),y:o.y+ie*Math.sin(te)};se[Y.node.id()]=Z}return i.nodes().layoutPositions(this,e,function(ue){var ge=ue.id();return se[ge]}),this};var R2,lq={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,r){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function fx(t){this.options=Qe({},lq,t),this.options.layout=this;var e=this.options.eles.nodes(),r=this.options.eles.edges(),n=r.filter(function(i){var a=i.source().data("id"),s=i.target().data("id"),o=e.some(function(c){return c.data("id")===a}),l=e.some(function(c){return c.data("id")===s});return!o||!l});this.options.eles=this.options.eles.not(n)}fx.prototype.run=function(){var t=this.options,e=t.cy,r=this;r.stopped=!1,(t.animate===!0||t.animate===!1)&&r.emit({type:"layoutstart",layout:r}),t.debug===!0?R2=!0:R2=!1;var n=cq(e,r,t);R2&&dq(n),t.randomize&&fq(n);var i=eo(),a=function(){hq(n,e,t),t.fit===!0&&e.fit(t.padding)},s=function(h){return!(r.stopped||h>=t.numIter||(pq(n,t),n.temperature=n.temperature*t.coolingFactor,n.temperature<t.minTemp))},o=function(){if(t.animate===!0||t.animate===!1)a(),r.one("layoutstop",t.stop),r.emit({type:"layoutstop",layout:r});else{var h=t.eles.nodes(),m=$R(n,t,h);h.layoutPositions(r,t,m)}},l=0,c=!0;if(t.animate===!0){var u=function(){for(var h=0;c&&h<t.refresh;)c=s(l),l++,h++;if(!c)R8(n,t),o();else{var m=eo();m-i>=t.animationThreshold&&a(),k0(u)}};u()}else{for(;c;)c=s(l),l++;R8(n,t),o()}return this};fx.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};fx.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var cq=function(e,r,n){for(var i=n.eles.edges(),a=n.eles.nodes(),s=ei(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),o={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:n.initialTemp,clientWidth:s.w,clientHeight:s.h,boundingBox:s},l=n.eles.components(),c={},u=0;u<l.length;u++)for(var f=l[u],h=0;h<f.length;h++){var m=f[h];c[m.id()]=u}for(var u=0;u<o.nodeSize;u++){var v=a[u],y=v.layoutDimensions(n),x={};x.isLocked=v.locked(),x.id=v.data("id"),x.parentId=v.data("parent"),x.cmptId=c[v.id()],x.children=[],x.positionX=v.position("x"),x.positionY=v.position("y"),x.offsetX=0,x.offsetY=0,x.height=y.w,x.width=y.h,x.maxX=x.positionX+x.width/2,x.minX=x.positionX-x.width/2,x.maxY=x.positionY+x.height/2,x.minY=x.positionY-x.height/2,x.padLeft=parseFloat(v.style("padding")),x.padRight=parseFloat(v.style("padding")),x.padTop=parseFloat(v.style("padding")),x.padBottom=parseFloat(v.style("padding")),x.nodeRepulsion=vr(n.nodeRepulsion)?n.nodeRepulsion(v):n.nodeRepulsion,o.layoutNodes.push(x),o.idToIndex[x.id]=u}for(var b=[],S=0,w=-1,k=[],u=0;u<o.nodeSize;u++){var v=o.layoutNodes[u],N=v.parentId;N!=null?o.layoutNodes[o.idToIndex[N]].children.push(v.id):(b[++w]=v.id,k.push(v.id))}for(o.graphSet.push(k);S<=w;){var j=b[S++],T=o.idToIndex[j],m=o.layoutNodes[T],M=m.children;if(M.length>0){o.graphSet.push(M);for(var u=0;u<M.length;u++)b[++w]=M[u]}}for(var u=0;u<o.graphSet.length;u++)for(var A=o.graphSet[u],h=0;h<A.length;h++){var _=o.idToIndex[A[h]];o.indexToGraph[_]=u}for(var u=0;u<o.edgeSize;u++){var D=i[u],R={};R.id=D.data("id"),R.sourceId=D.data("source"),R.targetId=D.data("target");var I=vr(n.idealEdgeLength)?n.idealEdgeLength(D):n.idealEdgeLength,$=vr(n.edgeElasticity)?n.edgeElasticity(D):n.edgeElasticity,B=o.idToIndex[R.sourceId],z=o.idToIndex[R.targetId],U=o.indexToGraph[B],F=o.indexToGraph[z];if(U!=F){for(var Q=uq(R.sourceId,R.targetId,o),K=o.graphSet[Q],L=0,x=o.layoutNodes[B];K.indexOf(x.id)===-1;)x=o.layoutNodes[o.idToIndex[x.parentId]],L++;for(x=o.layoutNodes[z];K.indexOf(x.id)===-1;)x=o.layoutNodes[o.idToIndex[x.parentId]],L++;I*=L*n.nestingFactor}R.idealLength=I,R.elasticity=$,o.layoutEdges.push(R)}return o},uq=function(e,r,n){var i=VR(e,r,0,n);return 2>i.count?0:i.graph},VR=function(e,r,n,i){var a=i.graphSet[n];if(-1<a.indexOf(e)&&-1<a.indexOf(r))return{count:2,graph:n};for(var s=0,o=0;o<a.length;o++){var l=a[o],c=i.idToIndex[l],u=i.layoutNodes[c].children;if(u.length!==0){var f=i.indexToGraph[i.idToIndex[u[0]]],h=VR(e,r,f,i);if(h.count!==0)if(h.count===1){if(s++,s===2)break}else return h}}return{count:s,graph:n}},dq,fq=function(e,r){for(var n=e.clientWidth,i=e.clientHeight,a=0;a<e.nodeSize;a++){var s=e.layoutNodes[a];s.children.length===0&&!s.isLocked&&(s.positionX=Math.random()*n,s.positionY=Math.random()*i)}},$R=function(e,r,n){var i=e.boundingBox,a={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return r.boundingBox&&(n.forEach(function(s){var o=e.layoutNodes[e.idToIndex[s.data("id")]];a.x1=Math.min(a.x1,o.positionX),a.x2=Math.max(a.x2,o.positionX),a.y1=Math.min(a.y1,o.positionY),a.y2=Math.max(a.y2,o.positionY)}),a.w=a.x2-a.x1,a.h=a.y2-a.y1),function(s,o){var l=e.layoutNodes[e.idToIndex[s.data("id")]];if(r.boundingBox){var c=a.w===0?.5:(l.positionX-a.x1)/a.w,u=a.h===0?.5:(l.positionY-a.y1)/a.h;return{x:i.x1+c*i.w,y:i.y1+u*i.h}}else return{x:l.positionX,y:l.positionY}}},hq=function(e,r,n){var i=n.layout,a=n.eles.nodes(),s=$R(e,n,a);a.positions(s),e.ready!==!0&&(e.ready=!0,i.one("layoutready",n.ready),i.emit({type:"layoutready",layout:this}))},pq=function(e,r,n){mq(e,r),yq(e),xq(e,r),bq(e),wq(e)},mq=function(e,r){for(var n=0;n<e.graphSet.length;n++)for(var i=e.graphSet[n],a=i.length,s=0;s<a;s++)for(var o=e.layoutNodes[e.idToIndex[i[s]]],l=s+1;l<a;l++){var c=e.layoutNodes[e.idToIndex[i[l]]];gq(o,c,e,r)}},A8=function(e){return-1+2*e*Math.random()},gq=function(e,r,n,i){var a=e.cmptId,s=r.cmptId;if(!(a!==s&&!n.isCompound)){var o=r.positionX-e.positionX,l=r.positionY-e.positionY,c=1;o===0&&l===0&&(o=A8(c),l=A8(c));var u=vq(e,r,o,l);if(u>0)var f=i.nodeOverlap*u,h=Math.sqrt(o*o+l*l),m=f*o/h,v=f*l/h;else var y=P0(e,o,l),x=P0(r,-1*o,-1*l),b=x.x-y.x,S=x.y-y.y,w=b*b+S*S,h=Math.sqrt(w),f=(e.nodeRepulsion+r.nodeRepulsion)/w,m=f*b/h,v=f*S/h;e.isLocked||(e.offsetX-=m,e.offsetY-=v),r.isLocked||(r.offsetX+=m,r.offsetY+=v)}},vq=function(e,r,n,i){if(n>0)var a=e.maxX-r.minX;else var a=r.maxX-e.minX;if(i>0)var s=e.maxY-r.minY;else var s=r.maxY-e.minY;return a>=0&&s>=0?Math.sqrt(a*a+s*s):0},P0=function(e,r,n){var i=e.positionX,a=e.positionY,s=e.height||1,o=e.width||1,l=n/r,c=s/o,u={};return r===0&&0<n||r===0&&0>n?(u.x=i,u.y=a+s/2,u):0<r&&-1*c<=l&&l<=c?(u.x=i+o/2,u.y=a+o*n/2/r,u):0>r&&-1*c<=l&&l<=c?(u.x=i-o/2,u.y=a-o*n/2/r,u):0<n&&(l<=-1*c||l>=c)?(u.x=i+s*r/2/n,u.y=a+s/2,u):(0>n&&(l<=-1*c||l>=c)&&(u.x=i-s*r/2/n,u.y=a-s/2),u)},yq=function(e,r){for(var n=0;n<e.edgeSize;n++){var i=e.layoutEdges[n],a=e.idToIndex[i.sourceId],s=e.layoutNodes[a],o=e.idToIndex[i.targetId],l=e.layoutNodes[o],c=l.positionX-s.positionX,u=l.positionY-s.positionY;if(!(c===0&&u===0)){var f=P0(s,c,u),h=P0(l,-1*c,-1*u),m=h.x-f.x,v=h.y-f.y,y=Math.sqrt(m*m+v*v),x=Math.pow(i.idealLength-y,2)/i.elasticity;if(y!==0)var b=x*m/y,S=x*v/y;else var b=0,S=0;s.isLocked||(s.offsetX+=b,s.offsetY+=S),l.isLocked||(l.offsetX-=b,l.offsetY-=S)}}},xq=function(e,r){if(r.gravity!==0)for(var n=1,i=0;i<e.graphSet.length;i++){var a=e.graphSet[i],s=a.length;if(i===0)var o=e.clientHeight/2,l=e.clientWidth/2;else var c=e.layoutNodes[e.idToIndex[a[0]]],u=e.layoutNodes[e.idToIndex[c.parentId]],o=u.positionX,l=u.positionY;for(var f=0;f<s;f++){var h=e.layoutNodes[e.idToIndex[a[f]]];if(!h.isLocked){var m=o-h.positionX,v=l-h.positionY,y=Math.sqrt(m*m+v*v);if(y>n){var x=r.gravity*m/y,b=r.gravity*v/y;h.offsetX+=x,h.offsetY+=b}}}}},bq=function(e,r){var n=[],i=0,a=-1;for(n.push.apply(n,e.graphSet[0]),a+=e.graphSet[0].length;i<=a;){var s=n[i++],o=e.idToIndex[s],l=e.layoutNodes[o],c=l.children;if(0<c.length&&!l.isLocked){for(var u=l.offsetX,f=l.offsetY,h=0;h<c.length;h++){var m=e.layoutNodes[e.idToIndex[c[h]]];m.offsetX+=u,m.offsetY+=f,n[++a]=c[h]}l.offsetX=0,l.offsetY=0}}},wq=function(e,r){for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];if(!(0<i.children.length||i.isLocked)){var a=Sq(i.offsetX,i.offsetY,e.temperature);i.positionX+=a.x,i.positionY+=a.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,UR(i,e)}}for(var n=0;n<e.nodeSize;n++){var i=e.layoutNodes[n];0<i.children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},Sq=function(e,r,n){var i=Math.sqrt(e*e+r*r);if(i>n)var a={x:n*e/i,y:n*r/i};else var a={x:e,y:r};return a},UR=function(e,r){var n=e.parentId;if(n!=null){var i=r.layoutNodes[r.idToIndex[n]],a=!1;if((i.maxX==null||e.maxX+i.padRight>i.maxX)&&(i.maxX=e.maxX+i.padRight,a=!0),(i.minX==null||e.minX-i.padLeft<i.minX)&&(i.minX=e.minX-i.padLeft,a=!0),(i.maxY==null||e.maxY+i.padBottom>i.maxY)&&(i.maxY=e.maxY+i.padBottom,a=!0),(i.minY==null||e.minY-i.padTop<i.minY)&&(i.minY=e.minY-i.padTop,a=!0),a)return UR(i,r)}},R8=function(e,r){for(var n=e.layoutNodes,i=[],a=0;a<n.length;a++){var s=n[a],o=s.cmptId,l=i[o]=i[o]||[];l.push(s)}for(var c=0,a=0;a<i.length;a++){var u=i[a];if(u){u.x1=1/0,u.x2=-1/0,u.y1=1/0,u.y2=-1/0;for(var f=0;f<u.length;f++){var h=u[f];u.x1=Math.min(u.x1,h.positionX-h.width/2),u.x2=Math.max(u.x2,h.positionX+h.width/2),u.y1=Math.min(u.y1,h.positionY-h.height/2),u.y2=Math.max(u.y2,h.positionY+h.height/2)}u.w=u.x2-u.x1,u.h=u.y2-u.y1,c+=u.w*u.h}}i.sort(function(S,w){return w.w*w.h-S.w*S.h});for(var m=0,v=0,y=0,x=0,b=Math.sqrt(c)*e.clientWidth/e.clientHeight,a=0;a<i.length;a++){var u=i[a];if(u){for(var f=0;f<u.length;f++){var h=u[f];h.isLocked||(h.positionX+=m-u.x1,h.positionY+=v-u.y1)}m+=u.w+r.componentSpacing,y+=u.w+r.componentSpacing,x=Math.max(x,u.h),y>b&&(v+=x+r.componentSpacing,m=0,y=0,x=0)}}},kq={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function GR(t){this.options=Qe({},kq,t)}GR.prototype.run=function(){var t=this.options,e=t,r=t.cy,n=e.eles,i=n.nodes().not(":parent");e.sort&&(i=i.sort(e.sort));var a=ei(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:r.width(),h:r.height()});if(a.h===0||a.w===0)n.nodes().layoutPositions(this,e,function(ee){return{x:a.x1,y:a.y1}});else{var s=i.size(),o=Math.sqrt(s*a.h/a.w),l=Math.round(o),c=Math.round(a.w/a.h*o),u=function(re){if(re==null)return Math.min(l,c);var se=Math.min(l,c);se==l?l=re:c=re},f=function(re){if(re==null)return Math.max(l,c);var se=Math.max(l,c);se==l?l=re:c=re},h=e.rows,m=e.cols!=null?e.cols:e.columns;if(h!=null&&m!=null)l=h,c=m;else if(h!=null&&m==null)l=h,c=Math.ceil(s/l);else if(h==null&&m!=null)c=m,l=Math.ceil(s/c);else if(c*l>s){var v=u(),y=f();(v-1)*y>=s?u(v-1):(y-1)*v>=s&&f(y-1)}else for(;c*l<s;){var x=u(),b=f();(b+1)*x>=s?f(b+1):u(x+1)}var S=a.w/c,w=a.h/l;if(e.condense&&(S=0,w=0),e.avoidOverlap)for(var k=0;k<i.length;k++){var N=i[k],j=N._private.position;(j.x==null||j.y==null)&&(j.x=0,j.y=0);var T=N.layoutDimensions(e),M=e.avoidOverlapPadding,A=T.w+M,_=T.h+M;S=Math.max(S,A),w=Math.max(w,_)}for(var D={},R=function(re,se){return!!D["c-"+re+"-"+se]},I=function(re,se){D["c-"+re+"-"+se]=!0},$=0,B=0,z=function(){B++,B>=c&&(B=0,$++)},U={},F=0;F<i.length;F++){var Q=i[F],K=e.position(Q);if(K&&(K.row!==void 0||K.col!==void 0)){var L={row:K.row,col:K.col};if(L.col===void 0)for(L.col=0;R(L.row,L.col);)L.col++;else if(L.row===void 0)for(L.row=0;R(L.row,L.col);)L.row++;U[Q.id()]=L,I(L.row,L.col)}}var G=function(re,se){var de,W;if(re.locked()||re.isParent())return!1;var ne=U[re.id()];if(ne)de=ne.col*S+S/2+a.x1,W=ne.row*w+w/2+a.y1;else{for(;R($,B);)z();de=B*S+S/2+a.x1,W=$*w+w/2+a.y1,I($,B),z()}return{x:de,y:W}};i.layoutPositions(this,e,G)}return this};var Cq={ready:function(){},stop:function(){}};function h3(t){this.options=Qe({},Cq,t)}h3.prototype.run=function(){var t=this.options,e=t.eles,r=this;return t.cy,r.emit("layoutstart"),e.nodes().positions(function(){return{x:0,y:0}}),r.one("layoutready",t.ready),r.emit("layoutready"),r.one("layoutstop",t.stop),r.emit("layoutstop"),this};h3.prototype.stop=function(){return this};var Nq={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function HR(t){this.options=Qe({},Nq,t)}HR.prototype.run=function(){var t=this.options,e=t.eles,r=e.nodes(),n=vr(t.positions);function i(a){if(t.positions==null)return qU(a.position());if(n)return t.positions(a);var s=t.positions[a._private.data.id];return s??null}return r.layoutPositions(this,t,function(a,s){var o=i(a);return a.locked()||o==null?!1:o}),this};var Eq={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,r){return!0},ready:void 0,stop:void 0,transform:function(e,r){return r}};function WR(t){this.options=Qe({},Eq,t)}WR.prototype.run=function(){var t=this.options,e=t.cy,r=t.eles,n=ei(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()}),i=function(s,o){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}};return r.nodes().layoutPositions(this,t,i),this};var Tq=[{name:"breadthfirst",impl:BR},{name:"circle",impl:FR},{name:"concentric",impl:zR},{name:"cose",impl:fx},{name:"grid",impl:GR},{name:"null",impl:h3},{name:"preset",impl:HR},{name:"random",impl:WR}];function qR(t){this.options=t,this.notifications=0}var D8=function(){},O8=function(){throw new Error("A headless instance can not render images")};qR.prototype={recalculateRenderedStyle:D8,notify:function(){this.notifications++},init:D8,isHeadless:function(){return!0},png:O8,jpg:O8};var p3={};p3.arrowShapeWidth=.3;p3.registerArrowShapes=function(){var t=this.arrowShapes={},e=this,r=function(c,u,f,h,m,v,y){var x=m.x-f/2-y,b=m.x+f/2+y,S=m.y-f/2-y,w=m.y+f/2+y,k=x<=c&&c<=b&&S<=u&&u<=w;return k},n=function(c,u,f,h,m){var v=c*Math.cos(h)-u*Math.sin(h),y=c*Math.sin(h)+u*Math.cos(h),x=v*f,b=y*f,S=x+m.x,w=b+m.y;return{x:S,y:w}},i=function(c,u,f,h){for(var m=[],v=0;v<c.length;v+=2){var y=c[v],x=c[v+1];m.push(n(y,x,u,f,h))}return m},a=function(c){for(var u=[],f=0;f<c.length;f++){var h=c[f];u.push(h.x,h.y)}return u},s=function(c){return c.pstyle("width").pfValue*c.pstyle("arrow-scale").pfValue*2},o=function(c,u){Ke(u)&&(u=t[u]),t[c]=Qe({name:c,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(h,m,v,y,x,b){var S=a(i(this.points,v+2*b,y,x)),w=pi(h,m,S);return w},roughCollide:r,draw:function(h,m,v,y){var x=i(this.points,m,v,y);e.arrowShapeImpl("polygon")(h,x)},spacing:function(h){return 0},gap:s},u)};o("none",{collide:C0,roughCollide:C0,draw:ZC,spacing:YT,gap:YT}),o("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),o("arrow","triangle"),o("triangle-backcurve",{points:t.triangle.points,controlPoint:[0,-.15],roughCollide:r,draw:function(c,u,f,h,m){var v=i(this.points,u,f,h),y=this.controlPoint,x=n(y[0],y[1],u,f,h);e.arrowShapeImpl(this.name)(c,v,x)},gap:function(c){return s(c)*.8}}),o("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(c,u,f,h,m,v,y){var x=a(i(this.points,f+2*y,h,m)),b=a(i(this.pointsTee,f+2*y,h,m)),S=pi(c,u,x)||pi(c,u,b);return S},draw:function(c,u,f,h,m){var v=i(this.points,u,f,h),y=i(this.pointsTee,u,f,h);e.arrowShapeImpl(this.name)(c,v,y)}}),o("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(c,u,f,h,m,v,y){var x=m,b=Math.pow(x.x-c,2)+Math.pow(x.y-u,2)<=Math.pow((f+2*y)*this.radius,2),S=a(i(this.points,f+2*y,h,m));return pi(c,u,S)||b},draw:function(c,u,f,h,m){var v=i(this.pointsTr,u,f,h);e.arrowShapeImpl(this.name)(c,v,h.x,h.y,this.radius*u)},spacing:function(c){return e.getArrowWidth(c.pstyle("width").pfValue,c.pstyle("arrow-scale").value)*this.radius}}),o("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(c,u){var f=this.baseCrossLinePts.slice(),h=u/c,m=3,v=5;return f[m]=f[m]-h,f[v]=f[v]-h,f},collide:function(c,u,f,h,m,v,y){var x=a(i(this.points,f+2*y,h,m)),b=a(i(this.crossLinePts(f,v),f+2*y,h,m)),S=pi(c,u,x)||pi(c,u,b);return S},draw:function(c,u,f,h,m){var v=i(this.points,u,f,h),y=i(this.crossLinePts(u,m),u,f,h);e.arrowShapeImpl(this.name)(c,v,y)}}),o("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(c){return s(c)*.525}}),o("circle",{radius:.15,collide:function(c,u,f,h,m,v,y){var x=m,b=Math.pow(x.x-c,2)+Math.pow(x.y-u,2)<=Math.pow((f+2*y)*this.radius,2);return b},draw:function(c,u,f,h,m){e.arrowShapeImpl(this.name)(c,h.x,h.y,this.radius*u)},spacing:function(c){return e.getArrowWidth(c.pstyle("width").pfValue,c.pstyle("arrow-scale").value)*this.radius}}),o("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(c){return 1},gap:function(c){return 1}}),o("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),o("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(c){return c.pstyle("width").pfValue*c.pstyle("arrow-scale").value}}),o("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(c){return .95*c.pstyle("width").pfValue*c.pstyle("arrow-scale").value}})};var Zc={};Zc.projectIntoViewport=function(t,e){var r=this.cy,n=this.findContainerClientCoords(),i=n[0],a=n[1],s=n[4],o=r.pan(),l=r.zoom(),c=((t-i)/s-o.x)/l,u=((e-a)/s-o.y)/l;return[c,u]};Zc.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var t=this.container,e=t.getBoundingClientRect(),r=this.cy.window().getComputedStyle(t),n=function(b){return parseFloat(r.getPropertyValue(b))},i={left:n("padding-left"),right:n("padding-right"),top:n("padding-top"),bottom:n("padding-bottom")},a={left:n("border-left-width"),right:n("border-right-width"),top:n("border-top-width"),bottom:n("border-bottom-width")},s=t.clientWidth,o=t.clientHeight,l=i.left+i.right,c=i.top+i.bottom,u=a.left+a.right,f=e.width/(s+u),h=s-l,m=o-c,v=e.left+i.left+a.left,y=e.top+i.top+a.top;return this.containerBB=[v,y,h,m,f]};Zc.invalidateContainerClientCoordsCache=function(){this.containerBB=null};Zc.findNearestElement=function(t,e,r,n){return this.findNearestElements(t,e,r,n)[0]};Zc.findNearestElements=function(t,e,r,n){var i=this,a=this,s=a.getCachedZSortedEles(),o=[],l=a.cy.zoom(),c=a.cy.hasCompoundNodes(),u=(n?24:8)/l,f=(n?8:2)/l,h=(n?8:2)/l,m=1/0,v,y;r&&(s=s.interactive);function x(T,M){if(T.isNode()){if(y)return;y=T,o.push(T)}if(T.isEdge()&&(M==null||M<m))if(v){if(v.pstyle("z-compound-depth").value===T.pstyle("z-compound-depth").value&&v.pstyle("z-compound-depth").value===T.pstyle("z-compound-depth").value){for(var A=0;A<o.length;A++)if(o[A].isEdge()){o[A]=T,v=T,m=M??m;break}}}else o.push(T),v=T,m=M??m}function b(T){var M=T.outerWidth()+2*f,A=T.outerHeight()+2*f,_=M/2,D=A/2,R=T.position(),I=T.pstyle("corner-radius").value==="auto"?"auto":T.pstyle("corner-radius").pfValue,$=T._private.rscratch;if(R.x-_<=t&&t<=R.x+_&&R.y-D<=e&&e<=R.y+D){var B=a.nodeShapes[i.getNodeShape(T)];if(B.checkPoint(t,e,0,M,A,R.x,R.y,I,$))return x(T,0),!0}}function S(T){var M=T._private,A=M.rscratch,_=T.pstyle("width").pfValue,D=T.pstyle("arrow-scale").value,R=_/2+u,I=R*R,$=R*2,F=M.source,Q=M.target,B;if(A.edgeType==="segments"||A.edgeType==="straight"||A.edgeType==="haystack"){for(var z=A.allpts,U=0;U+3<z.length;U+=2)if(oG(t,e,z[U],z[U+1],z[U+2],z[U+3],$)&&I>(B=fG(t,e,z[U],z[U+1],z[U+2],z[U+3])))return x(T,B),!0}else if(A.edgeType==="bezier"||A.edgeType==="multibezier"||A.edgeType==="self"||A.edgeType==="compound"){for(var z=A.allpts,U=0;U+5<A.allpts.length;U+=4)if(lG(t,e,z[U],z[U+1],z[U+2],z[U+3],z[U+4],z[U+5],$)&&I>(B=dG(t,e,z[U],z[U+1],z[U+2],z[U+3],z[U+4],z[U+5])))return x(T,B),!0}for(var F=F||M.source,Q=Q||M.target,K=i.getArrowWidth(_,D),L=[{name:"source",x:A.arrowStartX,y:A.arrowStartY,angle:A.srcArrowAngle},{name:"target",x:A.arrowEndX,y:A.arrowEndY,angle:A.tgtArrowAngle},{name:"mid-source",x:A.midX,y:A.midY,angle:A.midsrcArrowAngle},{name:"mid-target",x:A.midX,y:A.midY,angle:A.midtgtArrowAngle}],U=0;U<L.length;U++){var G=L[U],ee=a.arrowShapes[T.pstyle(G.name+"-arrow-shape").value],re=T.pstyle("width").pfValue;if(ee.roughCollide(t,e,K,G.angle,{x:G.x,y:G.y},re,u)&&ee.collide(t,e,K,G.angle,{x:G.x,y:G.y},re,u))return x(T),!0}c&&o.length>0&&(b(F),b(Q))}function w(T,M,A){return hi(T,M,A)}function k(T,M){var A=T._private,_=h,D;M?D=M+"-":D="",T.boundingBox();var R=A.labelBounds[M||"main"],I=T.pstyle(D+"label").value,$=T.pstyle("text-events").strValue==="yes";if(!(!$||!I)){var B=w(A.rscratch,"labelX",M),z=w(A.rscratch,"labelY",M),U=w(A.rscratch,"labelAngle",M),F=T.pstyle(D+"text-margin-x").pfValue,Q=T.pstyle(D+"text-margin-y").pfValue,K=R.x1-_-F,L=R.x2+_-F,G=R.y1-_-Q,ee=R.y2+_-Q;if(U){var re=Math.cos(U),se=Math.sin(U),de=function(Z,ue){return Z=Z-B,ue=ue-z,{x:Z*re-ue*se+B,y:Z*se+ue*re+z}},W=de(K,G),ne=de(K,ee),ie=de(L,G),V=de(L,ee),Y=[W.x+F,W.y+Q,ie.x+F,ie.y+Q,V.x+F,V.y+Q,ne.x+F,ne.y+Q];if(pi(t,e,Y))return x(T),!0}else if(qo(R,t,e))return x(T),!0}}for(var N=s.length-1;N>=0;N--){var j=s[N];j.isNode()?b(j)||k(j):S(j)||k(j)||k(j,"source")||k(j,"target")}return o};Zc.getAllInBox=function(t,e,r,n){var i=this.getCachedZSortedEles().interactive,a=this.cy.zoom(),s=2/a,o=[],l=Math.min(t,r),c=Math.max(t,r),u=Math.min(e,n),f=Math.max(e,n);t=l,r=c,e=u,n=f;var h=ei({x1:t,y1:e,x2:r,y2:n}),m=[{x:h.x1,y:h.y1},{x:h.x2,y:h.y1},{x:h.x2,y:h.y2},{x:h.x1,y:h.y2}],v=[[m[0],m[1]],[m[1],m[2]],[m[2],m[3]],[m[3],m[0]]];function y(Z,ue,ge){return hi(Z,ue,ge)}function x(Z,ue){var ge=Z._private,Ue=s,Pe="";Z.boundingBox();var ze=ge.labelBounds.main;if(!ze)return null;var Ge=y(ge.rscratch,"labelX",ue),Ce=y(ge.rscratch,"labelY",ue),Re=y(ge.rscratch,"labelAngle",ue),Ve=Z.pstyle(Pe+"text-margin-x").pfValue,We=Z.pstyle(Pe+"text-margin-y").pfValue,Oe=ze.x1-Ue-Ve,rt=ze.x2+Ue-Ve,ct=ze.y1-Ue-We,xt=ze.y2+Ue-We;if(Re){var bt=Math.cos(Re),Et=Math.sin(Re),Je=function(ve,H){return ve=ve-Ge,H=H-Ce,{x:ve*bt-H*Et+Ge,y:ve*Et+H*bt+Ce}};return[Je(Oe,ct),Je(rt,ct),Je(rt,xt),Je(Oe,xt)]}else return[{x:Oe,y:ct},{x:rt,y:ct},{x:rt,y:xt},{x:Oe,y:xt}]}function b(Z,ue,ge,Ue){function Pe(ze,Ge,Ce){return(Ce.y-ze.y)*(Ge.x-ze.x)>(Ge.y-ze.y)*(Ce.x-ze.x)}return Pe(Z,ge,Ue)!==Pe(ue,ge,Ue)&&Pe(Z,ue,ge)!==Pe(Z,ue,Ue)}for(var S=0;S<i.length;S++){var w=i[S];if(w.isNode()){var k=w,N=k.pstyle("text-events").strValue==="yes",j=k.pstyle("box-selection").strValue,T=k.pstyle("box-select-labels").strValue==="yes";if(j==="none")continue;var M=(j==="overlap"||T)&&N,A=k.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:M});if(j==="contain"){var _=!1;if(T&&N){var D=x(k);D&&_w(D,m)&&(o.push(k),_=!0)}!_&&eR(h,A)&&o.push(k)}else if(j==="overlap"&&n3(h,A)){var R=k.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1}),I=[{x:R.x1,y:R.y1},{x:R.x2,y:R.y1},{x:R.x2,y:R.y2},{x:R.x1,y:R.y2}];if(_w(I,m))o.push(k);else{var $=x(k);$&&_w($,m)&&o.push(k)}}}else{var B=w,z=B._private,U=z.rscratch,F=B.pstyle("box-selection").strValue;if(F==="none")continue;if(F==="contain"){if(U.startX!=null&&U.startY!=null&&!qo(h,U.startX,U.startY)||U.endX!=null&&U.endY!=null&&!qo(h,U.endX,U.endY))continue;if(U.edgeType==="bezier"||U.edgeType==="multibezier"||U.edgeType==="self"||U.edgeType==="compound"||U.edgeType==="segments"||U.edgeType==="haystack"){for(var Q=z.rstyle.bezierPts||z.rstyle.linePts||z.rstyle.haystackPts,K=!0,L=0;L<Q.length;L++)if(!e6(h,Q[L])){K=!1;break}K&&o.push(B)}else U.edgeType==="straight"&&o.push(B)}else if(F==="overlap"){var G=!1;if(U.startX!=null&&U.startY!=null&&U.endX!=null&&U.endY!=null&&(qo(h,U.startX,U.startY)||qo(h,U.endX,U.endY)))o.push(B),G=!0;else if(!G&&U.edgeType==="haystack"){for(var ee=z.rstyle.haystackPts,re=0;re<ee.length;re++)if(e6(h,ee[re])){o.push(B),G=!0;break}}if(!G){var se=z.rstyle.bezierPts||z.rstyle.linePts||z.rstyle.haystackPts;if((!se||se.length<2)&&U.edgeType==="straight"&&U.startX!=null&&U.startY!=null&&U.endX!=null&&U.endY!=null&&(se=[{x:U.startX,y:U.startY},{x:U.endX,y:U.endY}]),!se||se.length<2)continue;for(var de=0;de<se.length-1;de++){for(var W=se[de],ne=se[de+1],ie=0;ie<v.length;ie++){var V=zr(v[ie],2),Y=V[0],te=V[1];if(b(W,ne,Y,te)){o.push(B),G=!0;break}}if(G)break}}}}}return o};var _0={};_0.calculateArrowAngles=function(t){var e=t._private.rscratch,r=e.edgeType==="haystack",n=e.edgeType==="bezier",i=e.edgeType==="multibezier",a=e.edgeType==="segments",s=e.edgeType==="compound",o=e.edgeType==="self",l,c,u,f,h,m,b,S;if(r?(u=e.haystackPts[0],f=e.haystackPts[1],h=e.haystackPts[2],m=e.haystackPts[3]):(u=e.arrowStartX,f=e.arrowStartY,h=e.arrowEndX,m=e.arrowEndY),b=e.midX,S=e.midY,a)l=u-e.segpts[0],c=f-e.segpts[1];else if(i||s||o||n){var v=e.allpts,y=cn(v[0],v[2],v[4],.1),x=cn(v[1],v[3],v[5],.1);l=u-y,c=f-x}else l=u-b,c=f-S;e.srcArrowAngle=Rg(l,c);var b=e.midX,S=e.midY;if(r&&(b=(u+h)/2,S=(f+m)/2),l=h-u,c=m-f,a){var v=e.allpts;if(v.length/2%2===0){var w=v.length/2,k=w-2;l=v[w]-v[k],c=v[w+1]-v[k+1]}else if(e.isRound)l=e.midVector[1],c=-e.midVector[0];else{var w=v.length/2-1,k=w-2;l=v[w]-v[k],c=v[w+1]-v[k+1]}}else if(i||s||o){var v=e.allpts,N=e.ctrlpts,j,T,M,A;if(N.length/2%2===0){var _=v.length/2-1,D=_+2,R=D+2;j=cn(v[_],v[D],v[R],0),T=cn(v[_+1],v[D+1],v[R+1],0),M=cn(v[_],v[D],v[R],1e-4),A=cn(v[_+1],v[D+1],v[R+1],1e-4)}else{var D=v.length/2-1,_=D-2,R=D+2;j=cn(v[_],v[D],v[R],.4999),T=cn(v[_+1],v[D+1],v[R+1],.4999),M=cn(v[_],v[D],v[R],.5),A=cn(v[_+1],v[D+1],v[R+1],.5)}l=M-j,c=A-T}if(e.midtgtArrowAngle=Rg(l,c),e.midDispX=l,e.midDispY=c,l*=-1,c*=-1,a){var v=e.allpts;if(v.length/2%2!==0){if(!e.isRound){var w=v.length/2-1,I=w+2;l=-(v[I]-v[w]),c=-(v[I+1]-v[w+1])}}}if(e.midsrcArrowAngle=Rg(l,c),a)l=h-e.segpts[e.segpts.length-2],c=m-e.segpts[e.segpts.length-1];else if(i||s||o||n){var v=e.allpts,$=v.length,y=cn(v[$-6],v[$-4],v[$-2],.9),x=cn(v[$-5],v[$-3],v[$-1],.9);l=h-y,c=m-x}else l=h-b,c=m-S;e.tgtArrowAngle=Rg(l,c)};_0.getArrowWidth=_0.getArrowHeight=function(t,e){var r=this.arrowWidthCache=this.arrowWidthCache||{},n=r[t+", "+e];return n||(n=Math.max(Math.pow(t*13.37,.9),29)*e,r[t+", "+e]=n,n)};var q5,K5,Ja={},Xi={},I8,L8,hc,Ov,_s,nc,uc,Ya,Au,Vg,KR,YR,Y5,X5,B8,F8=function(e,r,n){n.x=r.x-e.x,n.y=r.y-e.y,n.len=Math.sqrt(n.x*n.x+n.y*n.y),n.nx=n.x/n.len,n.ny=n.y/n.len,n.ang=Math.atan2(n.ny,n.nx)},jq=function(e,r){r.x=e.x*-1,r.y=e.y*-1,r.nx=e.nx*-1,r.ny=e.ny*-1,r.ang=e.ang>0?-(Math.PI-e.ang):Math.PI+e.ang},Mq=function(e,r,n,i,a){if(e!==B8?F8(r,e,Ja):jq(Xi,Ja),F8(r,n,Xi),I8=Ja.nx*Xi.ny-Ja.ny*Xi.nx,L8=Ja.nx*Xi.nx-Ja.ny*-Xi.ny,_s=Math.asin(Math.max(-1,Math.min(1,I8))),Math.abs(_s)<1e-6){q5=r.x,K5=r.y,uc=Au=0;return}hc=1,Ov=!1,L8<0?_s<0?_s=Math.PI+_s:(_s=Math.PI-_s,hc=-1,Ov=!0):_s>0&&(hc=-1,Ov=!0),r.radius!==void 0?Au=r.radius:Au=i,nc=_s/2,Vg=Math.min(Ja.len/2,Xi.len/2),a?(Ya=Math.abs(Math.cos(nc)*Au/Math.sin(nc)),Ya>Vg?(Ya=Vg,uc=Math.abs(Ya*Math.sin(nc)/Math.cos(nc))):uc=Au):(Ya=Math.min(Vg,Au),uc=Math.abs(Ya*Math.sin(nc)/Math.cos(nc))),Y5=r.x+Xi.nx*Ya,X5=r.y+Xi.ny*Ya,q5=Y5-Xi.ny*uc*hc,K5=X5+Xi.nx*uc*hc,KR=r.x+Ja.nx*Ya,YR=r.y+Ja.ny*Ya,B8=r};function XR(t,e){e.radius===0?t.lineTo(e.cx,e.cy):t.arc(e.cx,e.cy,e.radius,e.startAngle,e.endAngle,e.counterClockwise)}function m3(t,e,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return n===0||e.radius===0?{cx:e.x,cy:e.y,radius:0,startX:e.x,startY:e.y,stopX:e.x,stopY:e.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(Mq(t,e,r,n,i),{cx:q5,cy:K5,radius:uc,startX:KR,startY:YR,stopX:Y5,stopY:X5,startAngle:Ja.ang+Math.PI/2*hc,endAngle:Xi.ang-Math.PI/2*hc,counterClockwise:Ov})}var Tp=.01,Pq=Math.sqrt(2*Tp),Wn={};Wn.findMidptPtsEtc=function(t,e){var r=e.posPts,n=e.intersectionPts,i=e.vectorNormInverse,a,s=t.pstyle("source-endpoint"),o=t.pstyle("target-endpoint"),l=s.units!=null&&o.units!=null,c=function(N,j,T,M){var A=M-j,_=T-N,D=Math.sqrt(_*_+A*A);return{x:-A/D,y:_/D}},u=t.pstyle("edge-distances").value;switch(u){case"node-position":a=r;break;case"intersection":a=n;break;case"endpoints":{if(l){var f=this.manualEndptToPx(t.source()[0],s),h=zr(f,2),m=h[0],v=h[1],y=this.manualEndptToPx(t.target()[0],o),x=zr(y,2),b=x[0],S=x[1],w={x1:m,y1:v,x2:b,y2:S};i=c(m,v,b,S),a=w}else Lt("Edge ".concat(t.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),a=n;break}}return{midptPts:a,vectorNormInverse:i}};Wn.findHaystackPoints=function(t){for(var e=0;e<t.length;e++){var r=t[e],n=r._private,i=n.rscratch;if(!i.haystack){var a=Math.random()*2*Math.PI;i.source={x:Math.cos(a),y:Math.sin(a)},a=Math.random()*2*Math.PI,i.target={x:Math.cos(a),y:Math.sin(a)}}var s=n.source,o=n.target,l=s.position(),c=o.position(),u=s.width(),f=o.width(),h=s.height(),m=o.height(),v=r.pstyle("haystack-radius").value,y=v/2;i.haystackPts=i.allpts=[i.source.x*u*y+l.x,i.source.y*h*y+l.y,i.target.x*f*y+c.x,i.target.y*m*y+c.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(r),this.calculateArrowAngles(r),this.recalculateEdgeLabelProjections(r),this.calculateLabelAngles(r)}};Wn.findSegmentsPoints=function(t,e){var r=t._private.rscratch,n=t.pstyle("segment-weights"),i=t.pstyle("segment-distances"),a=t.pstyle("segment-radii"),s=t.pstyle("radius-type"),o=Math.min(n.pfValue.length,i.pfValue.length),l=a.pfValue[a.pfValue.length-1],c=s.pfValue[s.pfValue.length-1];r.edgeType="segments",r.segpts=[],r.radii=[],r.isArcRadius=[];for(var u=0;u<o;u++){var f=n.pfValue[u],h=i.pfValue[u],m=1-f,v=f,y=this.findMidptPtsEtc(t,e),x=y.midptPts,b=y.vectorNormInverse,S={x:x.x1*m+x.x2*v,y:x.y1*m+x.y2*v};r.segpts.push(S.x+b.x*h,S.y+b.y*h),r.radii.push(a.pfValue[u]!==void 0?a.pfValue[u]:l),r.isArcRadius.push((s.pfValue[u]!==void 0?s.pfValue[u]:c)==="arc-radius")}};Wn.findLoopPoints=function(t,e,r,n){var i=t._private.rscratch,a=e.dirCounts,s=e.srcPos,o=t.pstyle("control-point-distances"),l=o?o.pfValue[0]:void 0,c=t.pstyle("loop-direction").pfValue,u=t.pstyle("loop-sweep").pfValue,f=t.pstyle("control-point-step-size").pfValue;i.edgeType="self";var h=r,m=f;n&&(h=0,m=l);var v=c-Math.PI/2,y=v-u/2,x=v+u/2,b=c+"_"+u;h=a[b]===void 0?a[b]=0:++a[b],i.ctrlpts=[s.x+Math.cos(y)*1.4*m*(h/3+1),s.y+Math.sin(y)*1.4*m*(h/3+1),s.x+Math.cos(x)*1.4*m*(h/3+1),s.y+Math.sin(x)*1.4*m*(h/3+1)]};Wn.findCompoundLoopPoints=function(t,e,r,n){var i=t._private.rscratch;i.edgeType="compound";var a=e.srcPos,s=e.tgtPos,o=e.srcW,l=e.srcH,c=e.tgtW,u=e.tgtH,f=t.pstyle("control-point-step-size").pfValue,h=t.pstyle("control-point-distances"),m=h?h.pfValue[0]:void 0,v=r,y=f;n&&(v=0,y=m);var x=50,b={x:a.x-o/2,y:a.y-l/2},S={x:s.x-c/2,y:s.y-u/2},w={x:Math.min(b.x,S.x),y:Math.min(b.y,S.y)},k=.5,N=Math.max(k,Math.log(o*Tp)),j=Math.max(k,Math.log(c*Tp));i.ctrlpts=[w.x,w.y-(1+Math.pow(x,1.12)/100)*y*(v/3+1)*N,w.x-(1+Math.pow(x,1.12)/100)*y*(v/3+1)*j,w.y]};Wn.findStraightEdgePoints=function(t){t._private.rscratch.edgeType="straight"};Wn.findBezierPoints=function(t,e,r,n,i){var a=t._private.rscratch,s=t.pstyle("control-point-step-size").pfValue,o=t.pstyle("control-point-distances"),l=t.pstyle("control-point-weights"),c=o&&l?Math.min(o.value.length,l.value.length):1,u=o?o.pfValue[0]:void 0,f=l.value[0],h=n;a.edgeType=h?"multibezier":"bezier",a.ctrlpts=[];for(var m=0;m<c;m++){var v=(.5-e.eles.length/2+r)*s*(i?-1:1),y=void 0,x=r3(v);h&&(u=o?o.pfValue[m]:s,f=l.value[m]),n?y=u:y=u!==void 0?x*u:void 0;var b=y!==void 0?y:v,S=1-f,w=f,k=this.findMidptPtsEtc(t,e),N=k.midptPts,j=k.vectorNormInverse,T={x:N.x1*S+N.x2*w,y:N.y1*S+N.y2*w};a.ctrlpts.push(T.x+j.x*b,T.y+j.y*b)}};Wn.findTaxiPoints=function(t,e){var r=t._private.rscratch;r.edgeType="segments";var n="vertical",i="horizontal",a="leftward",s="rightward",o="downward",l="upward",c="auto",u=e.posPts,f=e.srcW,h=e.srcH,m=e.tgtW,v=e.tgtH,y=t.pstyle("edge-distances").value,x=y!=="node-position",b=t.pstyle("taxi-direction").value,S=b,w=t.pstyle("taxi-turn"),k=w.units==="%",N=w.pfValue,j=N<0,T=t.pstyle("taxi-turn-min-distance").pfValue,M=x?(f+m)/2:0,A=x?(h+v)/2:0,_=u.x2-u.x1,D=u.y2-u.y1,R=function(H,J){return H>0?Math.max(H-J,0):Math.min(H+J,0)},I=R(_,M),$=R(D,A),B=!1;S===c?b=Math.abs(I)>Math.abs($)?i:n:S===l||S===o?(b=n,B=!0):(S===a||S===s)&&(b=i,B=!0);var z=b===n,U=z?$:I,F=z?D:_,Q=r3(F),K=!1;!(B&&(k||j))&&(S===o&&F<0||S===l&&F>0||S===a&&F>0||S===s&&F<0)&&(Q*=-1,U=Q*Math.abs(U),K=!0);var L;if(k){var G=N<0?1+N:N;L=G*U}else{var ee=N<0?U:0;L=ee+N*Q}var re=function(H){return Math.abs(H)<T||Math.abs(H)>=Math.abs(U)},se=re(L),de=re(Math.abs(U)-Math.abs(L)),W=se||de;if(W&&!K)if(z){var ne=Math.abs(F)<=h/2,ie=Math.abs(_)<=m/2;if(ne){var V=(u.x1+u.x2)/2,Y=u.y1,te=u.y2;r.segpts=[V,Y,V,te]}else if(ie){var Z=(u.y1+u.y2)/2,ue=u.x1,ge=u.x2;r.segpts=[ue,Z,ge,Z]}else r.segpts=[u.x1,u.y2]}else{var Ue=Math.abs(F)<=f/2,Pe=Math.abs(D)<=v/2;if(Ue){var ze=(u.y1+u.y2)/2,Ge=u.x1,Ce=u.x2;r.segpts=[Ge,ze,Ce,ze]}else if(Pe){var Re=(u.x1+u.x2)/2,Ve=u.y1,We=u.y2;r.segpts=[Re,Ve,Re,We]}else r.segpts=[u.x2,u.y1]}else if(z){var Oe=u.y1+L+(x?h/2*Q:0),rt=u.x1,ct=u.x2;r.segpts=[rt,Oe,ct,Oe]}else{var xt=u.x1+L+(x?f/2*Q:0),bt=u.y1,Et=u.y2;r.segpts=[xt,bt,xt,Et]}if(r.isRound){var Je=t.pstyle("taxi-radius").value,De=t.pstyle("radius-type").value[0]==="arc-radius";r.radii=new Array(r.segpts.length/2).fill(Je),r.isArcRadius=new Array(r.segpts.length/2).fill(De)}};Wn.tryToCorrectInvalidPoints=function(t,e){var r=t._private.rscratch;if(r.edgeType==="bezier"){var n=e.srcPos,i=e.tgtPos,a=e.srcW,s=e.srcH,o=e.tgtW,l=e.tgtH,c=e.srcShape,u=e.tgtShape,f=e.srcCornerRadius,h=e.tgtCornerRadius,m=e.srcRs,v=e.tgtRs,y=!Ee(r.startX)||!Ee(r.startY),x=!Ee(r.arrowStartX)||!Ee(r.arrowStartY),b=!Ee(r.endX)||!Ee(r.endY),S=!Ee(r.arrowEndX)||!Ee(r.arrowEndY),w=3,k=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth,N=w*k,j=Fc({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.startX,y:r.startY}),T=j<N,M=Fc({x:r.ctrlpts[0],y:r.ctrlpts[1]},{x:r.endX,y:r.endY}),A=M<N,_=!1;if(y||x||T){_=!0;var D={x:r.ctrlpts[0]-n.x,y:r.ctrlpts[1]-n.y},R=Math.sqrt(D.x*D.x+D.y*D.y),I={x:D.x/R,y:D.y/R},$=Math.max(a,s),B={x:r.ctrlpts[0]+I.x*2*$,y:r.ctrlpts[1]+I.y*2*$},z=c.intersectLine(n.x,n.y,a,s,B.x,B.y,0,f,m);T?(r.ctrlpts[0]=r.ctrlpts[0]+I.x*(N-j),r.ctrlpts[1]=r.ctrlpts[1]+I.y*(N-j)):(r.ctrlpts[0]=z[0]+I.x*N,r.ctrlpts[1]=z[1]+I.y*N)}if(b||S||A){_=!0;var U={x:r.ctrlpts[0]-i.x,y:r.ctrlpts[1]-i.y},F=Math.sqrt(U.x*U.x+U.y*U.y),Q={x:U.x/F,y:U.y/F},K=Math.max(a,s),L={x:r.ctrlpts[0]+Q.x*2*K,y:r.ctrlpts[1]+Q.y*2*K},G=u.intersectLine(i.x,i.y,o,l,L.x,L.y,0,h,v);A?(r.ctrlpts[0]=r.ctrlpts[0]+Q.x*(N-M),r.ctrlpts[1]=r.ctrlpts[1]+Q.y*(N-M)):(r.ctrlpts[0]=G[0]+Q.x*N,r.ctrlpts[1]=G[1]+Q.y*N)}_&&this.findEndpoints(t)}};Wn.storeAllpts=function(t){var e=t._private.rscratch;if(e.edgeType==="multibezier"||e.edgeType==="bezier"||e.edgeType==="self"||e.edgeType==="compound"){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var r=0;r+1<e.ctrlpts.length;r+=2)e.allpts.push(e.ctrlpts[r],e.ctrlpts[r+1]),r+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[r]+e.ctrlpts[r+2])/2,(e.ctrlpts[r+1]+e.ctrlpts[r+3])/2);e.allpts.push(e.endX,e.endY);var n,i;e.ctrlpts.length/2%2===0?(n=e.allpts.length/2-1,e.midX=e.allpts[n],e.midY=e.allpts[n+1]):(n=e.allpts.length/2-3,i=.5,e.midX=cn(e.allpts[n],e.allpts[n+2],e.allpts[n+4],i),e.midY=cn(e.allpts[n+1],e.allpts[n+3],e.allpts[n+5],i))}else if(e.edgeType==="straight")e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if(e.edgeType==="segments"){if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.isRound){e.roundCorners=[];for(var a=2;a+3<e.allpts.length;a+=2){var s=e.radii[a/2-1],o=e.isArcRadius[a/2-1];e.roundCorners.push(m3({x:e.allpts[a-2],y:e.allpts[a-1]},{x:e.allpts[a],y:e.allpts[a+1],radius:s},{x:e.allpts[a+2],y:e.allpts[a+3]},s,o))}}if(e.segpts.length%4===0){var l=e.segpts.length/2,c=l-2;e.midX=(e.segpts[c]+e.segpts[l])/2,e.midY=(e.segpts[c+1]+e.segpts[l+1])/2}else{var u=e.segpts.length/2-1;if(!e.isRound)e.midX=e.segpts[u],e.midY=e.segpts[u+1];else{var f={x:e.segpts[u],y:e.segpts[u+1]},h=e.roundCorners[u/2];if(h.radius===0){var m={x:e.segpts[u+2],y:e.segpts[u+3]};e.midX=f.x,e.midY=f.y,e.midVector=[f.y-m.y,m.x-f.x]}else{var v=[f.x-h.cx,f.y-h.cy],y=h.radius/Math.sqrt(Math.pow(v[0],2)+Math.pow(v[1],2));v=v.map(function(x){return x*y}),e.midX=h.cx+v[0],e.midY=h.cy+v[1],e.midVector=v}}}}};Wn.checkForInvalidEdgeWarning=function(t){var e=t[0]._private.rscratch;e.nodesOverlap||Ee(e.startX)&&Ee(e.startY)&&Ee(e.endX)&&Ee(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,Lt("Edge `"+t.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};Wn.findEdgeControlPoints=function(t){var e=this;if(!(!t||t.length===0)){for(var r=this,n=r.cy,i=n.hasCompoundNodes(),a=new Gs,s=function(A,_){return[].concat(w0(A),[_?1:0]).join("-")},o=[],l=[],c=0;c<t.length;c++){var u=t[c],f=u._private,h=u.pstyle("curve-style").value;if(!(u.removed()||!u.takesUpSpace())){if(h==="haystack"){l.push(u);continue}var m=h==="unbundled-bezier"||Wo(h,"segments")||h==="straight"||h==="straight-triangle"||Wo(h,"taxi"),v=h==="unbundled-bezier"||h==="bezier",y=f.source,x=f.target,b=y.poolIndex(),S=x.poolIndex(),w=[b,S].sort(),k=s(w,m),N=a.get(k);N==null&&(N={eles:[]},o.push({pairId:w,edgeIsUnbundled:m}),a.set(k,N)),N.eles.push(u),m&&(N.hasUnbundled=!0),v&&(N.hasBezier=!0)}}for(var j=function(){var A=o[T],_=A.pairId,D=A.edgeIsUnbundled,R=s(_,D),I=a.get(R),$;if(!I.hasUnbundled){var B=I.eles[0].parallelEdges().filter(function(De){return De.isBundledBezier()});e3(I.eles),B.forEach(function(De){return I.eles.push(De)}),I.eles.sort(function(De,ve){return De.poolIndex()-ve.poolIndex()})}var z=I.eles[0],U=z.source(),F=z.target();if(U.poolIndex()>F.poolIndex()){var Q=U;U=F,F=Q}var K=I.srcPos=U.position(),L=I.tgtPos=F.position(),G=I.srcW=U.outerWidth(),ee=I.srcH=U.outerHeight(),re=I.tgtW=F.outerWidth(),se=I.tgtH=F.outerHeight(),de=I.srcShape=r.nodeShapes[e.getNodeShape(U)],W=I.tgtShape=r.nodeShapes[e.getNodeShape(F)],ne=I.srcCornerRadius=U.pstyle("corner-radius").value==="auto"?"auto":U.pstyle("corner-radius").pfValue,ie=I.tgtCornerRadius=F.pstyle("corner-radius").value==="auto"?"auto":F.pstyle("corner-radius").pfValue,V=I.tgtRs=F._private.rscratch,Y=I.srcRs=U._private.rscratch;I.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var te=0;te<I.eles.length;te++){var Z=I.eles[te],ue=Z[0]._private.rscratch,ge=Z.pstyle("curve-style").value,Ue=ge==="unbundled-bezier"||Wo(ge,"segments")||Wo(ge,"taxi"),Pe=!U.same(Z.source());if(!I.calculatedIntersection&&U!==F&&(I.hasBezier||I.hasUnbundled)){I.calculatedIntersection=!0;var ze=de.intersectLine(K.x,K.y,G,ee,L.x,L.y,0,ne,Y),Ge=I.srcIntn=ze,Ce=W.intersectLine(L.x,L.y,re,se,K.x,K.y,0,ie,V),Re=I.tgtIntn=Ce,Ve=I.intersectionPts={x1:ze[0],x2:Ce[0],y1:ze[1],y2:Ce[1]},We=I.posPts={x1:K.x,x2:L.x,y1:K.y,y2:L.y},Oe=Ce[1]-ze[1],rt=Ce[0]-ze[0],ct=Math.sqrt(rt*rt+Oe*Oe);Ee(ct)&&ct>=Pq||(ct=Math.sqrt(Math.max(rt*rt,Tp)+Math.max(Oe*Oe,Tp)));var xt=I.vector={x:rt,y:Oe},bt=I.vectorNorm={x:xt.x/ct,y:xt.y/ct},Et={x:-bt.y,y:bt.x};I.nodesOverlap=!Ee(ct)||W.checkPoint(ze[0],ze[1],0,re,se,L.x,L.y,ie,V)||de.checkPoint(Ce[0],Ce[1],0,G,ee,K.x,K.y,ne,Y),I.vectorNormInverse=Et,$={nodesOverlap:I.nodesOverlap,dirCounts:I.dirCounts,calculatedIntersection:!0,hasBezier:I.hasBezier,hasUnbundled:I.hasUnbundled,eles:I.eles,srcPos:L,srcRs:V,tgtPos:K,tgtRs:Y,srcW:re,srcH:se,tgtW:G,tgtH:ee,srcIntn:Re,tgtIntn:Ge,srcShape:W,tgtShape:de,posPts:{x1:We.x2,y1:We.y2,x2:We.x1,y2:We.y1},intersectionPts:{x1:Ve.x2,y1:Ve.y2,x2:Ve.x1,y2:Ve.y1},vector:{x:-xt.x,y:-xt.y},vectorNorm:{x:-bt.x,y:-bt.y},vectorNormInverse:{x:-Et.x,y:-Et.y}}}var Je=Pe?$:I;ue.nodesOverlap=Je.nodesOverlap,ue.srcIntn=Je.srcIntn,ue.tgtIntn=Je.tgtIntn,ue.isRound=ge.startsWith("round"),i&&(U.isParent()||U.isChild()||F.isParent()||F.isChild())&&(U.parents().anySame(F)||F.parents().anySame(U)||U.same(F)&&U.isParent())?e.findCompoundLoopPoints(Z,Je,te,Ue):U===F?e.findLoopPoints(Z,Je,te,Ue):ge.endsWith("segments")?e.findSegmentsPoints(Z,Je):ge.endsWith("taxi")?e.findTaxiPoints(Z,Je):ge==="straight"||!Ue&&I.eles.length%2===1&&te===Math.floor(I.eles.length/2)?e.findStraightEdgePoints(Z):e.findBezierPoints(Z,Je,te,Ue,Pe),e.findEndpoints(Z),e.tryToCorrectInvalidPoints(Z,Je),e.checkForInvalidEdgeWarning(Z),e.storeAllpts(Z),e.storeEdgeProjections(Z),e.calculateArrowAngles(Z),e.recalculateEdgeLabelProjections(Z),e.calculateLabelAngles(Z)}},T=0;T<o.length;T++)j();this.findHaystackPoints(l)}};function QR(t){var e=[];if(t!=null){for(var r=0;r<t.length;r+=2){var n=t[r],i=t[r+1];e.push({x:n,y:i})}return e}}Wn.getSegmentPoints=function(t){var e=t[0]._private.rscratch;this.recalculateRenderedStyle(t);var r=e.edgeType;if(r==="segments")return QR(e.segpts)};Wn.getControlPoints=function(t){var e=t[0]._private.rscratch;this.recalculateRenderedStyle(t);var r=e.edgeType;if(r==="bezier"||r==="multibezier"||r==="self"||r==="compound")return QR(e.ctrlpts)};Wn.getEdgeMidpoint=function(t){var e=t[0]._private.rscratch;return this.recalculateRenderedStyle(t),{x:e.midX,y:e.midY}};var om={};om.manualEndptToPx=function(t,e){var r=this,n=t.position(),i=t.outerWidth(),a=t.outerHeight(),s=t._private.rscratch;if(e.value.length===2){var o=[e.pfValue[0],e.pfValue[1]];return e.units[0]==="%"&&(o[0]=o[0]*i),e.units[1]==="%"&&(o[1]=o[1]*a),o[0]+=n.x,o[1]+=n.y,o}else{var l=e.pfValue[0];l=-Math.PI/2+l;var c=2*Math.max(i,a),u=[n.x+Math.cos(l)*c,n.y+Math.sin(l)*c];return r.nodeShapes[this.getNodeShape(t)].intersectLine(n.x,n.y,i,a,u[0],u[1],0,t.pstyle("corner-radius").value==="auto"?"auto":t.pstyle("corner-radius").pfValue,s)}};om.findEndpoints=function(t){var e,r,n,i,a=this,s,o=t.source()[0],l=t.target()[0],c=o.position(),u=l.position(),f=t.pstyle("target-arrow-shape").value,h=t.pstyle("source-arrow-shape").value,m=t.pstyle("target-distance-from-node").pfValue,v=t.pstyle("source-distance-from-node").pfValue,y=o._private.rscratch,x=l._private.rscratch,b=t.pstyle("curve-style").value,S=t._private.rscratch,w=S.edgeType,k=Wo(b,"taxi"),N=w==="self"||w==="compound",j=w==="bezier"||w==="multibezier"||N,T=w!=="bezier",M=w==="straight"||w==="segments",A=w==="segments",_=j||T||M,D=N||k,R=t.pstyle("source-endpoint"),I=D?"outside-to-node":R.value,$=o.pstyle("corner-radius").value==="auto"?"auto":o.pstyle("corner-radius").pfValue,B=t.pstyle("target-endpoint"),z=D?"outside-to-node":B.value,U=l.pstyle("corner-radius").value==="auto"?"auto":l.pstyle("corner-radius").pfValue;S.srcManEndpt=R,S.tgtManEndpt=B;var F,Q,K,L,G=(e=(B==null||(r=B.pfValue)===null||r===void 0?void 0:r.length)===2?B.pfValue:null)!==null&&e!==void 0?e:[0,0],ee=(n=(R==null||(i=R.pfValue)===null||i===void 0?void 0:i.length)===2?R.pfValue:null)!==null&&n!==void 0?n:[0,0];if(j){var re=[S.ctrlpts[0],S.ctrlpts[1]],se=T?[S.ctrlpts[S.ctrlpts.length-2],S.ctrlpts[S.ctrlpts.length-1]]:re;F=se,Q=re}else if(M){var de=A?S.segpts.slice(0,2):[u.x+G[0],u.y+G[1]],W=A?S.segpts.slice(S.segpts.length-2):[c.x+ee[0],c.y+ee[1]];F=W,Q=de}if(z==="inside-to-node")s=[u.x,u.y];else if(B.units)s=this.manualEndptToPx(l,B);else if(z==="outside-to-line")s=S.tgtIntn;else if(z==="outside-to-node"||z==="outside-to-node-or-label"?K=F:(z==="outside-to-line"||z==="outside-to-line-or-label")&&(K=[c.x,c.y]),s=a.nodeShapes[this.getNodeShape(l)].intersectLine(u.x,u.y,l.outerWidth(),l.outerHeight(),K[0],K[1],0,U,x),z==="outside-to-node-or-label"||z==="outside-to-line-or-label"){var ne=l._private.rscratch,ie=ne.labelWidth,V=ne.labelHeight,Y=ne.labelX,te=ne.labelY,Z=ie/2,ue=V/2,ge=l.pstyle("text-valign").value;ge==="top"?te-=ue:ge==="bottom"&&(te+=ue);var Ue=l.pstyle("text-halign").value;Ue==="left"?Y-=Z:Ue==="right"&&(Y+=Z);var Pe=Sp(K[0],K[1],[Y-Z,te-ue,Y+Z,te-ue,Y+Z,te+ue,Y-Z,te+ue],u.x,u.y);if(Pe.length>0){var ze=c,Ge=cc(ze,od(s)),Ce=cc(ze,od(Pe)),Re=Ge;if(Ce<Ge&&(s=Pe,Re=Ce),Pe.length>2){var Ve=cc(ze,{x:Pe[2],y:Pe[3]});Ve<Re&&(s=[Pe[2],Pe[3]])}}}var We=Dg(s,F,a.arrowShapes[f].spacing(t)+m),Oe=Dg(s,F,a.arrowShapes[f].gap(t)+m);if(S.endX=Oe[0],S.endY=Oe[1],S.arrowEndX=We[0],S.arrowEndY=We[1],I==="inside-to-node")s=[c.x,c.y];else if(R.units)s=this.manualEndptToPx(o,R);else if(I==="outside-to-line")s=S.srcIntn;else if(I==="outside-to-node"||I==="outside-to-node-or-label"?L=Q:(I==="outside-to-line"||I==="outside-to-line-or-label")&&(L=[u.x,u.y]),s=a.nodeShapes[this.getNodeShape(o)].intersectLine(c.x,c.y,o.outerWidth(),o.outerHeight(),L[0],L[1],0,$,y),I==="outside-to-node-or-label"||I==="outside-to-line-or-label"){var rt=o._private.rscratch,ct=rt.labelWidth,xt=rt.labelHeight,bt=rt.labelX,Et=rt.labelY,Je=ct/2,De=xt/2,ve=o.pstyle("text-valign").value;ve==="top"?Et-=De:ve==="bottom"&&(Et+=De);var H=o.pstyle("text-halign").value;H==="left"?bt-=Je:H==="right"&&(bt+=Je);var J=Sp(L[0],L[1],[bt-Je,Et-De,bt+Je,Et-De,bt+Je,Et+De,bt-Je,Et+De],c.x,c.y);if(J.length>0){var ae=u,le=cc(ae,od(s)),fe=cc(ae,od(J)),xe=le;if(fe<le&&(s=[J[0],J[1]],xe=fe),J.length>2){var ye=cc(ae,{x:J[2],y:J[3]});ye<xe&&(s=[J[2],J[3]])}}}var Te=Dg(s,Q,a.arrowShapes[h].spacing(t)+v),je=Dg(s,Q,a.arrowShapes[h].gap(t)+v);S.startX=je[0],S.startY=je[1],S.arrowStartX=Te[0],S.arrowStartY=Te[1],_&&(!Ee(S.startX)||!Ee(S.startY)||!Ee(S.endX)||!Ee(S.endY)?S.badLine=!0:S.badLine=!1)};om.getSourceEndpoint=function(t){var e=t[0]._private.rscratch;switch(this.recalculateRenderedStyle(t),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}};om.getTargetEndpoint=function(t){var e=t[0]._private.rscratch;switch(this.recalculateRenderedStyle(t),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}};var g3={};function _q(t,e,r){for(var n=function(c,u,f,h){return cn(c,u,f,h)},i=e._private,a=i.rstyle.bezierPts,s=0;s<t.bezierProjPcts.length;s++){var o=t.bezierProjPcts[s];a.push({x:n(r[0],r[2],r[4],o),y:n(r[1],r[3],r[5],o)})}}g3.storeEdgeProjections=function(t){var e=t._private,r=e.rscratch,n=r.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,n==="multibezier"||n==="bezier"||n==="self"||n==="compound"){e.rstyle.bezierPts=[];for(var i=0;i+5<r.allpts.length;i+=4)_q(this,t,r.allpts.slice(i,i+6))}else if(n==="segments")for(var a=e.rstyle.linePts=[],i=0;i+1<r.allpts.length;i+=2)a.push({x:r.allpts[i],y:r.allpts[i+1]});else if(n==="haystack"){var s=r.haystackPts;e.rstyle.haystackPts=[{x:s[0],y:s[1]},{x:s[2],y:s[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth};g3.recalculateEdgeProjections=function(t){this.findEdgeControlPoints(t)};var gs={};gs.recalculateNodeLabelProjection=function(t){var e=t.pstyle("label").strValue;if(!ml(e)){var r,n,i=t._private,a=t.width(),s=t.height(),o=t.padding(),l=t.position(),c=t.pstyle("text-halign").strValue,u=t.pstyle("text-valign").strValue,f=i.rscratch,h=i.rstyle;switch(c){case"left":r=l.x-a/2-o;break;case"right":r=l.x+a/2+o;break;default:r=l.x}switch(u){case"top":n=l.y-s/2-o;break;case"bottom":n=l.y+s/2+o;break;default:n=l.y}f.labelX=r,f.labelY=n,h.labelX=r,h.labelY=n,this.calculateLabelAngles(t),this.applyLabelDimensions(t)}};var JR=function(e,r){var n=Math.atan(r/e);return e===0&&n<0&&(n=n*-1),n},ZR=function(e,r){var n=r.x-e.x,i=r.y-e.y;return JR(n,i)},Aq=function(e,r,n,i){var a=wp(0,i-.001,1),s=wp(0,i+.001,1),o=yd(e,r,n,a),l=yd(e,r,n,s);return ZR(o,l)};gs.recalculateEdgeLabelProjections=function(t){var e,r=t._private,n=r.rscratch,i=this,a={mid:t.pstyle("label").strValue,source:t.pstyle("source-label").strValue,target:t.pstyle("target-label").strValue};if(a.mid||a.source||a.target){e={x:n.midX,y:n.midY};var s=function(f,h,m){Vs(r.rscratch,f,h,m),Vs(r.rstyle,f,h,m)};s("labelX",null,e.x),s("labelY",null,e.y);var o=JR(n.midDispX,n.midDispY);s("labelAutoAngle",null,o);var l=function(){if(l.cache)return l.cache;for(var f=[],h=0;h+5<n.allpts.length;h+=4){var m={x:n.allpts[h],y:n.allpts[h+1]},v={x:n.allpts[h+2],y:n.allpts[h+3]},y={x:n.allpts[h+4],y:n.allpts[h+5]};f.push({p0:m,p1:v,p2:y,startDist:0,length:0,segments:[]})}var x=r.rstyle.bezierPts,b=i.bezierProjPcts.length;function S(T,M,A,_,D){var R=Fc(M,A),I=T.segments[T.segments.length-1],$={p0:M,p1:A,t0:_,t1:D,startDist:I?I.startDist+I.length:0,length:R};T.segments.push($),T.length+=R}for(var w=0;w<f.length;w++){var k=f[w],N=f[w-1];N&&(k.startDist=N.startDist+N.length),S(k,k.p0,x[w*b],0,i.bezierProjPcts[0]);for(var j=0;j<b-1;j++)S(k,x[w*b+j],x[w*b+j+1],i.bezierProjPcts[j],i.bezierProjPcts[j+1]);S(k,x[w*b+b-1],k.p2,i.bezierProjPcts[b-1],1)}return l.cache=f},c=function(f){var h,m=f==="source";if(a[f]){var v=t.pstyle(f+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var y=l(),x,b=0,S=0,w=0;w<y.length;w++){for(var k=y[m?w:y.length-1-w],N=0;N<k.segments.length;N++){var j=k.segments[m?N:k.segments.length-1-N],T=w===y.length-1&&N===k.segments.length-1;if(b=S,S+=j.length,S>=v||T){x={cp:k,segment:j};break}}if(x)break}var M=x.cp,A=x.segment,_=(v-b)/A.length,D=A.t1-A.t0,R=m?A.t0+D*_:A.t1-D*_;R=wp(0,R,1),e=yd(M.p0,M.p1,M.p2,R),h=Aq(M.p0,M.p1,M.p2,R);break}case"straight":case"segments":case"haystack":{for(var I=0,$,B,z,U,F=n.allpts.length,Q=0;Q+3<F&&(m?(z={x:n.allpts[Q],y:n.allpts[Q+1]},U={x:n.allpts[Q+2],y:n.allpts[Q+3]}):(z={x:n.allpts[F-2-Q],y:n.allpts[F-1-Q]},U={x:n.allpts[F-4-Q],y:n.allpts[F-3-Q]}),$=Fc(z,U),B=I,I+=$,!(I>=v));Q+=2);var K=v-B,L=K/$;L=wp(0,L,1),e=eG(z,U,L),h=ZR(z,U);break}}s("labelX",f,e.x),s("labelY",f,e.y),s("labelAutoAngle",f,h)}};c("source"),c("target"),this.applyLabelDimensions(t)}};gs.applyLabelDimensions=function(t){this.applyPrefixedLabelDimensions(t),t.isEdge()&&(this.applyPrefixedLabelDimensions(t,"source"),this.applyPrefixedLabelDimensions(t,"target"))};gs.applyPrefixedLabelDimensions=function(t,e){var r=t._private,n=this.getLabelText(t,e),i=Bc(n,t._private.labelDimsKey);if(hi(r.rscratch,"prefixedLabelDimsKey",e)!==i){Vs(r.rscratch,"prefixedLabelDimsKey",e,i);var a=this.calculateLabelDimensions(t,n),s=t.pstyle("line-height").pfValue,o=t.pstyle("text-wrap").strValue,l=hi(r.rscratch,"labelWrapCachedLines",e)||[],c=o!=="wrap"?1:Math.max(l.length,1),u=a.height/c,f=u*s,h=a.width,m=a.height+(c-1)*(s-1)*u;Vs(r.rstyle,"labelWidth",e,h),Vs(r.rscratch,"labelWidth",e,h),Vs(r.rstyle,"labelHeight",e,m),Vs(r.rscratch,"labelHeight",e,m),Vs(r.rscratch,"labelLineHeight",e,f)}};gs.getLabelText=function(t,e){var r=t._private,n=e?e+"-":"",i=t.pstyle(n+"label").strValue,a=t.pstyle("text-transform").value,s=function(ee,re){return re?(Vs(r.rscratch,ee,e,re),re):hi(r.rscratch,ee,e)};if(!i)return"";a=="none"||(a=="uppercase"?i=i.toUpperCase():a=="lowercase"&&(i=i.toLowerCase()));var o=t.pstyle("text-wrap").value;if(o==="wrap"){var l=s("labelKey");if(l!=null&&s("labelWrapKey")===l)return s("labelWrapCachedText");for(var c="",u=i.split(`
`),f=t.pstyle("text-max-width").pfValue,h=t.pstyle("text-overflow-wrap").value,m=h==="anywhere",v=[],y=/[\s\u200b]+|$/g,x=0;x<u.length;x++){var b=u[x],S=this.calculateLabelDimensions(t,b),w=S.width;if(m){var k=b.split("").join(c);b=k}if(w>f){var N=b.matchAll(y),j="",T=0,M=vi(N),A;try{for(M.s();!(A=M.n()).done;){var _=A.value,D=_[0],R=b.substring(T,_.index);T=_.index+D.length;var I=j.length===0?R:j+R+D,$=this.calculateLabelDimensions(t,I),B=$.width;B<=f?j+=R+D:(j&&v.push(j),j=R+D)}}catch(G){M.e(G)}finally{M.f()}j.match(/^[\s\u200b]+$/)||v.push(j)}else v.push(b)}s("labelWrapCachedLines",v),i=s("labelWrapCachedText",v.join(`
`)),s("labelWrapKey",l)}else if(o==="ellipsis"){var z=t.pstyle("text-max-width").pfValue,U="",F="",Q=!1;if(this.calculateLabelDimensions(t,i).width<z)return i;for(var K=0;K<i.length;K++){var L=this.calculateLabelDimensions(t,U+i[K]+F).width;if(L>z)break;U+=i[K],K===i.length-1&&(Q=!0)}return Q||(U+=F),U}return i};gs.getLabelJustification=function(t){var e=t.pstyle("text-justification").strValue,r=t.pstyle("text-halign").strValue;if(e==="auto")if(t.isNode())switch(r){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return e};gs.calculateLabelDimensions=function(t,e){var r=this,n=r.cy.window(),i=n.document,a=0,s=t.pstyle("font-style").strValue,o=t.pstyle("font-size").pfValue,l=t.pstyle("font-family").strValue,c=t.pstyle("font-weight").strValue,u=this.labelCalcCanvas,f=this.labelCalcCanvasContext;if(!u){u=this.labelCalcCanvas=i.createElement("canvas"),f=this.labelCalcCanvasContext=u.getContext("2d");var h=u.style;h.position="absolute",h.left="-9999px",h.top="-9999px",h.zIndex="-1",h.visibility="hidden",h.pointerEvents="none"}f.font="".concat(s," ").concat(c," ").concat(o,"px ").concat(l);for(var m=0,v=0,y=e.split(`
`),x=0;x<y.length;x++){var b=y[x],S=f.measureText(b),w=Math.ceil(S.width),k=o;m=Math.max(w,m),v+=k}return m+=a,v+=a,{width:m,height:v}};gs.calculateLabelAngle=function(t,e){var r=t._private,n=r.rscratch,i=t.isEdge(),a=e?e+"-":"",s=t.pstyle(a+"text-rotation"),o=s.strValue;return o==="none"?0:i&&o==="autorotate"?n.labelAutoAngle:o==="autorotate"?0:s.pfValue};gs.calculateLabelAngles=function(t){var e=this,r=t.isEdge(),n=t._private,i=n.rscratch;i.labelAngle=e.calculateLabelAngle(t),r&&(i.sourceLabelAngle=e.calculateLabelAngle(t,"source"),i.targetLabelAngle=e.calculateLabelAngle(t,"target"))};var e7={},z8=28,V8=!1;e7.getNodeShape=function(t){var e=this,r=t.pstyle("shape").value;if(r==="cutrectangle"&&(t.width()<z8||t.height()<z8))return V8||(Lt("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),V8=!0),"rectangle";if(t.isParent())return r==="rectangle"||r==="roundrectangle"||r==="round-rectangle"||r==="cutrectangle"||r==="cut-rectangle"||r==="barrel"?r:"rectangle";if(r==="polygon"){var n=t.pstyle("shape-polygon-points").value;return e.nodeShapes.makePolygon(n).name}return r};var hx={};hx.registerCalculationListeners=function(){var t=this.cy,e=t.collection(),r=this,n=function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.merge(s),o)for(var l=0;l<s.length;l++){var c=s[l],u=c._private,f=u.rstyle;f.clean=!1,f.cleanConnected=!1}};r.binder(t).on("bounds.* dirty.*",function(s){var o=s.target;n(o)}).on("style.* background.*",function(s){var o=s.target;n(o,!1)});var i=function(s){if(s){var o=r.onUpdateEleCalcsFns;e.cleanStyle();for(var l=0;l<e.length;l++){var c=e[l],u=c._private.rstyle;c.isNode()&&!u.cleanConnected&&(n(c.connectedEdges()),u.cleanConnected=!0)}if(o)for(var f=0;f<o.length;f++){var h=o[f];h(s,e)}r.recalculateRenderedStyle(e),e=t.collection()}};r.flushRenderedStyleQueue=function(){i(!0)},r.beforeRender(i,r.beforeRenderPriorities.eleCalcs)};hx.onUpdateEleCalcs=function(t){var e=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];e.push(t)};hx.recalculateRenderedStyle=function(t,e){var r=function(k){return k._private.rstyle.cleanConnected};if(t.length!==0){var n=[],i=[];if(!this.destroyed){e===void 0&&(e=!0);for(var a=0;a<t.length;a++){var s=t[a],o=s._private,l=o.rstyle;s.isEdge()&&(!r(s.source())||!r(s.target()))&&(l.clean=!1),s.isEdge()&&s.isBundledBezier()&&s.parallelEdges().some(function(w){return!w._private.rstyle.clean&&w.isBundledBezier()})&&(l.clean=!1),!(e&&l.clean||s.removed())&&s.pstyle("display").value!=="none"&&(o.group==="nodes"?i.push(s):n.push(s),l.clean=!0)}for(var c=0;c<i.length;c++){var u=i[c],f=u._private,h=f.rstyle,m=u.position();this.recalculateNodeLabelProjection(u),h.nodeX=m.x,h.nodeY=m.y,h.nodeW=u.pstyle("width").pfValue,h.nodeH=u.pstyle("height").pfValue}this.recalculateEdgeProjections(n);for(var v=0;v<n.length;v++){var y=n[v],x=y._private,b=x.rstyle,S=x.rscratch;b.srcX=S.arrowStartX,b.srcY=S.arrowStartY,b.tgtX=S.arrowEndX,b.tgtY=S.arrowEndY,b.midX=S.midX,b.midY=S.midY,b.labelAngle=S.labelAngle,b.sourceLabelAngle=S.sourceLabelAngle,b.targetLabelAngle=S.targetLabelAngle}}}};var px={};px.updateCachedGrabbedEles=function(){var t=this.cachedZSortedEles;if(t){t.drag=[],t.nondrag=[];for(var e=[],r=0;r<t.length;r++){var n=t[r],i=n._private.rscratch;n.grabbed()&&!n.isParent()?e.push(n):i.inDragLayer?t.drag.push(n):t.nondrag.push(n)}for(var r=0;r<e.length;r++){var n=e[r];t.drag.push(n)}}};px.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};px.getCachedZSortedEles=function(t){if(t||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(OR),e.interactive=e.filter(function(r){return r.interactive()}),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e};var t7={};[Zc,_0,Wn,om,g3,gs,e7,hx,px].forEach(function(t){Qe(t7,t)});var r7={};r7.getCachedImage=function(t,e,r){var n=this,i=n.imageCache=n.imageCache||{},a=i[t];if(a)return a.image.complete||a.image.addEventListener("load",r),a.image;a=i[t]=i[t]||{};var s=a.image=new Image;s.addEventListener("load",r),s.addEventListener("error",function(){s.error=!0});var o="data:",l=t.substring(0,o.length).toLowerCase()===o;return l||(e=e==="null"?null:e,s.crossOrigin=e),s.src=t,s};var of={};of.registerBinding=function(t,e,r,n){var i=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(t)){for(var a=[],s=0;s<t.length;s++){var o=t[s];if(o!==void 0){var l=this.binder(o);a.push(l.on.apply(l,i))}}return a}var l=this.binder(t);return l.on.apply(l,i)};of.binder=function(t){var e=this,r=e.cy.window(),n=t===r||t===r.document||t===r.document.body||G$(t);if(e.supportsPassiveEvents==null){var i=!1;try{var a=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});r.addEventListener("test",null,a)}catch{}e.supportsPassiveEvents=i}var s=function(l,c,u){var f=Array.prototype.slice.call(arguments);return n&&e.supportsPassiveEvents&&(f[2]={capture:u??!1,passive:!1,once:!1}),e.bindings.push({target:t,args:f}),(t.addEventListener||t.on).apply(t,f),this};return{on:s,addEventListener:s,addListener:s,bind:s}};of.nodeIsDraggable=function(t){return t&&t.isNode()&&!t.locked()&&t.grabbable()};of.nodeIsGrabbable=function(t){return this.nodeIsDraggable(t)&&t.interactive()};of.load=function(){var t=this,e=t.cy.window(),r=function(H){return H.selected()},n=function(H){var J=H.getRootNode();if(J&&J.nodeType===11&&J.host!==void 0)return J},i=function(H,J,ae,le){H==null&&(H=t.cy);for(var fe=0;fe<J.length;fe++){var xe=J[fe];H.emit({originalEvent:ae,type:xe,position:le})}},a=function(H){return H.shiftKey||H.metaKey||H.ctrlKey},s=function(H,J){var ae=!0;if(t.cy.hasCompoundNodes()&&H&&H.pannable())for(var le=0;J&&le<J.length;le++){var H=J[le];if(H.isNode()&&H.isParent()&&!H.pannable()){ae=!1;break}}else ae=!0;return ae},o=function(H){H[0]._private.grabbed=!0},l=function(H){H[0]._private.grabbed=!1},c=function(H){H[0]._private.rscratch.inDragLayer=!0},u=function(H){H[0]._private.rscratch.inDragLayer=!1},f=function(H){H[0]._private.rscratch.isGrabTarget=!0},h=function(H){H[0]._private.rscratch.isGrabTarget=!1},m=function(H,J){var ae=J.addToList,le=ae.has(H);!le&&H.grabbable()&&!H.locked()&&(ae.merge(H),o(H))},v=function(H,J){if(H.cy().hasCompoundNodes()&&!(J.inDragLayer==null&&J.addToList==null)){var ae=H.descendants();J.inDragLayer&&(ae.forEach(c),ae.connectedEdges().forEach(c)),J.addToList&&m(ae,J)}},y=function(H,J){J=J||{};var ae=H.cy().hasCompoundNodes();J.inDragLayer&&(H.forEach(c),H.neighborhood().stdFilter(function(le){return!ae||le.isEdge()}).forEach(c)),J.addToList&&H.forEach(function(le){m(le,J)}),v(H,J),S(H,{inDragLayer:J.inDragLayer}),t.updateCachedGrabbedEles()},x=y,b=function(H){H&&(t.getCachedZSortedEles().forEach(function(J){l(J),u(J),h(J)}),t.updateCachedGrabbedEles())},S=function(H,J){if(!(J.inDragLayer==null&&J.addToList==null)&&H.cy().hasCompoundNodes()){var ae=H.ancestors().orphans();if(!ae.same(H)){var le=ae.descendants().spawnSelf().merge(ae).unmerge(H).unmerge(H.descendants()),fe=le.connectedEdges();J.inDragLayer&&(fe.forEach(c),le.forEach(c)),J.addToList&&le.forEach(function(xe){m(xe,J)})}}},w=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},k=typeof MutationObserver<"u",N=typeof ResizeObserver<"u";k?(t.removeObserver=new MutationObserver(function(ve){for(var H=0;H<ve.length;H++){var J=ve[H],ae=J.removedNodes;if(ae)for(var le=0;le<ae.length;le++){var fe=ae[le];if(fe===t.container){t.destroy();break}}}}),t.container.parentNode&&t.removeObserver.observe(t.container.parentNode,{childList:!0})):t.registerBinding(t.container,"DOMNodeRemoved",function(ve){t.destroy()});var j=nm(function(){t.cy.resize()},100);k&&(t.styleObserver=new MutationObserver(j),t.styleObserver.observe(t.container,{attributes:!0})),t.registerBinding(e,"resize",j),N&&(t.resizeObserver=new ResizeObserver(j),t.resizeObserver.observe(t.container));var T=function(H,J){for(;H!=null;)J(H),H=H.parentNode},M=function(){t.invalidateContainerClientCoordsCache()};T(t.container,function(ve){t.registerBinding(ve,"transitionend",M),t.registerBinding(ve,"animationend",M),t.registerBinding(ve,"scroll",M)}),t.registerBinding(t.container,"contextmenu",function(ve){ve.preventDefault()});var A=function(){return t.selection[4]!==0},_=function(H){for(var J=t.findContainerClientCoords(),ae=J[0],le=J[1],fe=J[2],xe=J[3],ye=H.touches?H.touches:[H],Te=!1,je=0;je<ye.length;je++){var He=ye[je];if(ae<=He.clientX&&He.clientX<=ae+fe&&le<=He.clientY&&He.clientY<=le+xe){Te=!0;break}}if(!Te)return!1;for(var et=t.container,tt=H.target,Ie=tt.parentNode,nt=!1;Ie;){if(Ie===et){nt=!0;break}Ie=Ie.parentNode}return!!nt};t.registerBinding(t.container,"mousedown",function(H){if(_(H)&&!(t.hoverData.which===1&&H.which!==1)){H.preventDefault(),w(),t.hoverData.capture=!0,t.hoverData.which=H.which;var J=t.cy,ae=[H.clientX,H.clientY],le=t.projectIntoViewport(ae[0],ae[1]),fe=t.selection,xe=t.findNearestElements(le[0],le[1],!0,!1),ye=xe[0],Te=t.dragData.possibleDragElements;t.hoverData.mdownPos=le,t.hoverData.mdownGPos=ae;var je=function(st){return{originalEvent:H,type:st,position:{x:le[0],y:le[1]}}},He=function(){t.hoverData.tapholdCancelled=!1,clearTimeout(t.hoverData.tapholdTimeout),t.hoverData.tapholdTimeout=setTimeout(function(){if(!t.hoverData.tapholdCancelled){var st=t.hoverData.down;st?st.emit(je("taphold")):J.emit(je("taphold"))}},t.tapholdDuration)};if(H.which==3){t.hoverData.cxtStarted=!0;var et={originalEvent:H,type:"cxttapstart",position:{x:le[0],y:le[1]}};ye?(ye.activate(),ye.emit(et),t.hoverData.down=ye):J.emit(et),t.hoverData.downTime=new Date().getTime(),t.hoverData.cxtDragged=!1}else if(H.which==1){ye&&ye.activate();{if(ye!=null&&t.nodeIsGrabbable(ye)){var tt=function(st){st.emit(je("grab"))};if(f(ye),!ye.selected())Te=t.dragData.possibleDragElements=J.collection(),x(ye,{addToList:Te}),ye.emit(je("grabon")).emit(je("grab"));else{Te=t.dragData.possibleDragElements=J.collection();var Ie=J.$(function(nt){return nt.isNode()&&nt.selected()&&t.nodeIsGrabbable(nt)});y(Ie,{addToList:Te}),ye.emit(je("grabon")),Ie.forEach(tt)}t.redrawHint("eles",!0),t.redrawHint("drag",!0)}t.hoverData.down=ye,t.hoverData.downs=xe,t.hoverData.downTime=new Date().getTime()}i(ye,["mousedown","tapstart","vmousedown"],H,{x:le[0],y:le[1]}),ye==null?(fe[4]=1,t.data.bgActivePosistion={x:le[0],y:le[1]},t.redrawHint("select",!0),t.redraw()):ye.pannable()&&(fe[4]=1),He()}fe[0]=fe[2]=le[0],fe[1]=fe[3]=le[1]}},!1);var D=n(t.container);t.registerBinding([e,D],"mousemove",function(H){var J=t.hoverData.capture;if(!(!J&&!_(H))){var ae=!1,le=t.cy,fe=le.zoom(),xe=[H.clientX,H.clientY],ye=t.projectIntoViewport(xe[0],xe[1]),Te=t.hoverData.mdownPos,je=t.hoverData.mdownGPos,He=t.selection,et=null;!t.hoverData.draggingEles&&!t.hoverData.dragging&&!t.hoverData.selecting&&(et=t.findNearestElement(ye[0],ye[1],!0,!1));var tt=t.hoverData.last,Ie=t.hoverData.down,nt=[ye[0]-He[2],ye[1]-He[3]],st=t.dragData.possibleDragElements,Kt;if(je){var Ot=xe[0]-je[0],yn=Ot*Ot,br=xe[1]-je[1],Ir=br*br,wr=yn+Ir;t.hoverData.isOverThresholdDrag=Kt=wr>=t.desktopTapThreshold2}var Pr=a(H);Kt&&(t.hoverData.tapholdCancelled=!0);var Fa=function(){var oi=t.hoverData.dragDelta=t.hoverData.dragDelta||[];oi.length===0?(oi.push(nt[0]),oi.push(nt[1])):(oi[0]+=nt[0],oi[1]+=nt[1])};ae=!0,i(et,["mousemove","vmousemove","tapdrag"],H,{x:ye[0],y:ye[1]});var Sr=function(oi){return{originalEvent:H,type:oi,position:{x:ye[0],y:ye[1]}}},si=function(){t.data.bgActivePosistion=void 0,t.hoverData.selecting||le.emit(Sr("boxstart")),He[4]=1,t.hoverData.selecting=!0,t.redrawHint("select",!0),t.redraw()};if(t.hoverData.which===3){if(Kt){var pa=Sr("cxtdrag");Ie?Ie.emit(pa):le.emit(pa),t.hoverData.cxtDragged=!0,(!t.hoverData.cxtOver||et!==t.hoverData.cxtOver)&&(t.hoverData.cxtOver&&t.hoverData.cxtOver.emit(Sr("cxtdragout")),t.hoverData.cxtOver=et,et&&et.emit(Sr("cxtdragover")))}}else if(t.hoverData.dragging){if(ae=!0,le.panningEnabled()&&le.userPanningEnabled()){var ho;if(t.hoverData.justStartedPan){var hu=t.hoverData.mdownPos;ho={x:(ye[0]-hu[0])*fe,y:(ye[1]-hu[1])*fe},t.hoverData.justStartedPan=!1}else ho={x:nt[0]*fe,y:nt[1]*fe};le.panBy(ho),le.emit(Sr("dragpan")),t.hoverData.dragged=!0}ye=t.projectIntoViewport(H.clientX,H.clientY)}else if(He[4]==1&&(Ie==null||Ie.pannable())){if(Kt){if(!t.hoverData.dragging&&le.boxSelectionEnabled()&&(Pr||!le.panningEnabled()||!le.userPanningEnabled()))si();else if(!t.hoverData.selecting&&le.panningEnabled()&&le.userPanningEnabled()){var bs=s(Ie,t.hoverData.downs);bs&&(t.hoverData.dragging=!0,t.hoverData.justStartedPan=!0,He[4]=0,t.data.bgActivePosistion=od(Te),t.redrawHint("select",!0),t.redraw())}Ie&&Ie.pannable()&&Ie.active()&&Ie.unactivate()}}else{if(Ie&&Ie.pannable()&&Ie.active()&&Ie.unactivate(),(!Ie||!Ie.grabbed())&&et!=tt&&(tt&&i(tt,["mouseout","tapdragout"],H,{x:ye[0],y:ye[1]}),et&&i(et,["mouseover","tapdragover"],H,{x:ye[0],y:ye[1]}),t.hoverData.last=et),Ie)if(Kt){if(le.boxSelectionEnabled()&&Pr)Ie&&Ie.grabbed()&&(b(st),Ie.emit(Sr("freeon")),st.emit(Sr("free")),t.dragData.didDrag&&(Ie.emit(Sr("dragfreeon")),st.emit(Sr("dragfree")))),si();else if(Ie&&Ie.grabbed()&&t.nodeIsDraggable(Ie)){var An=!t.dragData.didDrag;An&&t.redrawHint("eles",!0),t.dragData.didDrag=!0,t.hoverData.draggingEles||y(st,{inDragLayer:!0});var nn={x:0,y:0};if(Ee(nt[0])&&Ee(nt[1])&&(nn.x+=nt[0],nn.y+=nt[1],An)){var Rn=t.hoverData.dragDelta;Rn&&Ee(Rn[0])&&Ee(Rn[1])&&(nn.x+=Rn[0],nn.y+=Rn[1])}t.hoverData.draggingEles=!0,st.silentShift(nn).emit(Sr("position")).emit(Sr("drag")),t.redrawHint("drag",!0),t.redraw()}}else Fa();ae=!0}if(He[2]=ye[0],He[3]=ye[1],ae)return H.stopPropagation&&H.stopPropagation(),H.preventDefault&&H.preventDefault(),!1}},!1);var R,I,$;t.registerBinding(e,"mouseup",function(H){if(!(t.hoverData.which===1&&H.which!==1&&t.hoverData.capture)){var J=t.hoverData.capture;if(J){t.hoverData.capture=!1;var ae=t.cy,le=t.projectIntoViewport(H.clientX,H.clientY),fe=t.selection,xe=t.findNearestElement(le[0],le[1],!0,!1),ye=t.dragData.possibleDragElements,Te=t.hoverData.down,je=a(H);t.data.bgActivePosistion&&(t.redrawHint("select",!0),t.redraw()),t.hoverData.tapholdCancelled=!0,t.data.bgActivePosistion=void 0,Te&&Te.unactivate();var He=function(Ot){return{originalEvent:H,type:Ot,position:{x:le[0],y:le[1]}}};if(t.hoverData.which===3){var et=He("cxttapend");if(Te?Te.emit(et):ae.emit(et),!t.hoverData.cxtDragged){var tt=He("cxttap");Te?Te.emit(tt):ae.emit(tt)}t.hoverData.cxtDragged=!1,t.hoverData.which=null}else if(t.hoverData.which===1){if(i(xe,["mouseup","tapend","vmouseup"],H,{x:le[0],y:le[1]}),!t.dragData.didDrag&&!t.hoverData.dragged&&!t.hoverData.selecting&&!t.hoverData.isOverThresholdDrag&&(i(Te,["click","tap","vclick"],H,{x:le[0],y:le[1]}),I=!1,H.timeStamp-$<=ae.multiClickDebounceTime()?(R&&clearTimeout(R),I=!0,$=null,i(Te,["dblclick","dbltap","vdblclick"],H,{x:le[0],y:le[1]})):(R=setTimeout(function(){I||i(Te,["oneclick","onetap","voneclick"],H,{x:le[0],y:le[1]})},ae.multiClickDebounceTime()),$=H.timeStamp)),Te==null&&!t.dragData.didDrag&&!t.hoverData.selecting&&!t.hoverData.dragged&&!a(H)&&(ae.$(r).unselect(["tapunselect"]),ye.length>0&&t.redrawHint("eles",!0),t.dragData.possibleDragElements=ye=ae.collection()),xe==Te&&!t.dragData.didDrag&&!t.hoverData.selecting&&xe!=null&&xe._private.selectable&&(t.hoverData.dragging||(ae.selectionType()==="additive"||je?xe.selected()?xe.unselect(["tapunselect"]):xe.select(["tapselect"]):je||(ae.$(r).unmerge(xe).unselect(["tapunselect"]),xe.select(["tapselect"]))),t.redrawHint("eles",!0)),t.hoverData.selecting){var Ie=ae.collection(t.getAllInBox(fe[0],fe[1],fe[2],fe[3]));t.redrawHint("select",!0),Ie.length>0&&t.redrawHint("eles",!0),ae.emit(He("boxend"));var nt=function(Ot){return Ot.selectable()&&!Ot.selected()};ae.selectionType()==="additive"||je||ae.$(r).unmerge(Ie).unselect(),Ie.emit(He("box")).stdFilter(nt).select().emit(He("boxselect")),t.redraw()}if(t.hoverData.dragging&&(t.hoverData.dragging=!1,t.redrawHint("select",!0),t.redrawHint("eles",!0),t.redraw()),!fe[4]){t.redrawHint("drag",!0),t.redrawHint("eles",!0);var st=Te&&Te.grabbed();b(ye),st&&(Te.emit(He("freeon")),ye.emit(He("free")),t.dragData.didDrag&&(Te.emit(He("dragfreeon")),ye.emit(He("dragfree"))))}}fe[4]=0,t.hoverData.down=null,t.hoverData.cxtStarted=!1,t.hoverData.draggingEles=!1,t.hoverData.selecting=!1,t.hoverData.isOverThresholdDrag=!1,t.dragData.didDrag=!1,t.hoverData.dragged=!1,t.hoverData.dragDelta=[],t.hoverData.mdownPos=null,t.hoverData.mdownGPos=null,t.hoverData.which=null}}},!1);var B=[],z=4,U,F=1e5,Q=function(H,J){for(var ae=0;ae<H.length;ae++)if(H[ae]%J!==0)return!1;return!0},K=function(H){for(var J=Math.abs(H[0]),ae=1;ae<H.length;ae++)if(Math.abs(H[ae])!==J)return!1;return!0},L=function(H){var J=!1,ae=H.deltaY;if(ae==null&&(H.wheelDeltaY!=null?ae=H.wheelDeltaY/4:H.wheelDelta!=null&&(ae=H.wheelDelta/4)),ae!==0){if(U==null)if(B.length>=z){var le=B;if(U=Q(le,5),!U){var fe=Math.abs(le[0]);U=K(le)&&fe>5}if(U)for(var xe=0;xe<le.length;xe++)F=Math.min(Math.abs(le[xe]),F)}else B.push(ae),J=!0;else U&&(F=Math.min(Math.abs(ae),F));if(!t.scrollingPage){var ye=t.cy,Te=ye.zoom(),je=ye.pan(),He=t.projectIntoViewport(H.clientX,H.clientY),et=[He[0]*Te+je.x,He[1]*Te+je.y];if(t.hoverData.draggingEles||t.hoverData.dragging||t.hoverData.cxtStarted||A()){H.preventDefault();return}if(ye.panningEnabled()&&ye.userPanningEnabled()&&ye.zoomingEnabled()&&ye.userZoomingEnabled()){H.preventDefault(),t.data.wheelZooming=!0,clearTimeout(t.data.wheelTimeout),t.data.wheelTimeout=setTimeout(function(){t.data.wheelZooming=!1,t.redrawHint("eles",!0),t.redraw()},150);var tt;J&&Math.abs(ae)>5&&(ae=r3(ae)*5),tt=ae/-250,U&&(tt/=F,tt*=3),tt=tt*t.wheelSensitivity;var Ie=H.deltaMode===1;Ie&&(tt*=33);var nt=ye.zoom()*Math.pow(10,tt);H.type==="gesturechange"&&(nt=t.gestureStartZoom*H.scale),ye.zoom({level:nt,renderedPosition:{x:et[0],y:et[1]}}),ye.emit({type:H.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:H,position:{x:He[0],y:He[1]}})}}}};t.registerBinding(t.container,"wheel",L,!0),t.registerBinding(e,"scroll",function(H){t.scrollingPage=!0,clearTimeout(t.scrollingPageTimeout),t.scrollingPageTimeout=setTimeout(function(){t.scrollingPage=!1},250)},!0),t.registerBinding(t.container,"gesturestart",function(H){t.gestureStartZoom=t.cy.zoom(),t.hasTouchStarted||H.preventDefault()},!0),t.registerBinding(t.container,"gesturechange",function(ve){t.hasTouchStarted||L(ve)},!0),t.registerBinding(t.container,"mouseout",function(H){var J=t.projectIntoViewport(H.clientX,H.clientY);t.cy.emit({originalEvent:H,type:"mouseout",position:{x:J[0],y:J[1]}})},!1),t.registerBinding(t.container,"mouseover",function(H){var J=t.projectIntoViewport(H.clientX,H.clientY);t.cy.emit({originalEvent:H,type:"mouseover",position:{x:J[0],y:J[1]}})},!1);var G,ee,re,se,de,W,ne,ie,V,Y,te,Z,ue,ge=function(H,J,ae,le){return Math.sqrt((ae-H)*(ae-H)+(le-J)*(le-J))},Ue=function(H,J,ae,le){return(ae-H)*(ae-H)+(le-J)*(le-J)},Pe;t.registerBinding(t.container,"touchstart",Pe=function(H){if(t.hasTouchStarted=!0,!!_(H)){w(),t.touchData.capture=!0,t.data.bgActivePosistion=void 0;var J=t.cy,ae=t.touchData.now,le=t.touchData.earlier;if(H.touches[0]){var fe=t.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);ae[0]=fe[0],ae[1]=fe[1]}if(H.touches[1]){var fe=t.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);ae[2]=fe[0],ae[3]=fe[1]}if(H.touches[2]){var fe=t.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);ae[4]=fe[0],ae[5]=fe[1]}var xe=function(Pr){return{originalEvent:H,type:Pr,position:{x:ae[0],y:ae[1]}}};if(H.touches[1]){t.touchData.singleTouchMoved=!0,b(t.dragData.touchDragEles);var ye=t.findContainerClientCoords();V=ye[0],Y=ye[1],te=ye[2],Z=ye[3],G=H.touches[0].clientX-V,ee=H.touches[0].clientY-Y,re=H.touches[1].clientX-V,se=H.touches[1].clientY-Y,ue=0<=G&&G<=te&&0<=re&&re<=te&&0<=ee&&ee<=Z&&0<=se&&se<=Z;var Te=J.pan(),je=J.zoom();de=ge(G,ee,re,se),W=Ue(G,ee,re,se),ne=[(G+re)/2,(ee+se)/2],ie=[(ne[0]-Te.x)/je,(ne[1]-Te.y)/je];var He=200,et=He*He;if(W<et&&!H.touches[2]){var tt=t.findNearestElement(ae[0],ae[1],!0,!0),Ie=t.findNearestElement(ae[2],ae[3],!0,!0);tt&&tt.isNode()?(tt.activate().emit(xe("cxttapstart")),t.touchData.start=tt):Ie&&Ie.isNode()?(Ie.activate().emit(xe("cxttapstart")),t.touchData.start=Ie):J.emit(xe("cxttapstart")),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!0,t.touchData.cxtDragged=!1,t.data.bgActivePosistion=void 0,t.redraw();return}}if(H.touches[2])J.boxSelectionEnabled()&&H.preventDefault();else if(!H.touches[1]){if(H.touches[0]){var nt=t.findNearestElements(ae[0],ae[1],!0,!0),st=nt[0];if(st!=null&&(st.activate(),t.touchData.start=st,t.touchData.starts=nt,t.nodeIsGrabbable(st))){var Kt=t.dragData.touchDragEles=J.collection(),Ot=null;t.redrawHint("eles",!0),t.redrawHint("drag",!0),st.selected()?(Ot=J.$(function(wr){return wr.selected()&&t.nodeIsGrabbable(wr)}),y(Ot,{addToList:Kt})):x(st,{addToList:Kt}),f(st),st.emit(xe("grabon")),Ot?Ot.forEach(function(wr){wr.emit(xe("grab"))}):st.emit(xe("grab"))}i(st,["touchstart","tapstart","vmousedown"],H,{x:ae[0],y:ae[1]}),st==null&&(t.data.bgActivePosistion={x:fe[0],y:fe[1]},t.redrawHint("select",!0),t.redraw()),t.touchData.singleTouchMoved=!1,t.touchData.singleTouchStartTime=+new Date,clearTimeout(t.touchData.tapholdTimeout),t.touchData.tapholdTimeout=setTimeout(function(){t.touchData.singleTouchMoved===!1&&!t.pinching&&!t.touchData.selecting&&i(t.touchData.start,["taphold"],H,{x:ae[0],y:ae[1]})},t.tapholdDuration)}}if(H.touches.length>=1){for(var yn=t.touchData.startPosition=[null,null,null,null,null,null],br=0;br<ae.length;br++)yn[br]=le[br]=ae[br];var Ir=H.touches[0];t.touchData.startGPosition=[Ir.clientX,Ir.clientY]}}},!1);var ze;t.registerBinding(e,"touchmove",ze=function(H){var J=t.touchData.capture;if(!(!J&&!_(H))){var ae=t.selection,le=t.cy,fe=t.touchData.now,xe=t.touchData.earlier,ye=le.zoom();if(H.touches[0]){var Te=t.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);fe[0]=Te[0],fe[1]=Te[1]}if(H.touches[1]){var Te=t.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);fe[2]=Te[0],fe[3]=Te[1]}if(H.touches[2]){var Te=t.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);fe[4]=Te[0],fe[5]=Te[1]}var je=function(pu){return{originalEvent:H,type:pu,position:{x:fe[0],y:fe[1]}}},He=t.touchData.startGPosition,et;if(J&&H.touches[0]&&He){for(var tt=[],Ie=0;Ie<fe.length;Ie++)tt[Ie]=fe[Ie]-xe[Ie];var nt=H.touches[0].clientX-He[0],st=nt*nt,Kt=H.touches[0].clientY-He[1],Ot=Kt*Kt,yn=st+Ot;et=yn>=t.touchTapThreshold2}if(J&&t.touchData.cxt){H.preventDefault();var br=H.touches[0].clientX-V,Ir=H.touches[0].clientY-Y,wr=H.touches[1].clientX-V,Pr=H.touches[1].clientY-Y,Fa=Ue(br,Ir,wr,Pr),Sr=Fa/W,si=150,pa=si*si,ho=1.5,hu=ho*ho;if(Sr>=hu||Fa>=pa){t.touchData.cxt=!1,t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var bs=je("cxttapend");t.touchData.start?(t.touchData.start.unactivate().emit(bs),t.touchData.start=null):le.emit(bs)}}if(J&&t.touchData.cxt){var bs=je("cxtdrag");t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.touchData.start?t.touchData.start.emit(bs):le.emit(bs),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxtDragged=!0;var An=t.findNearestElement(fe[0],fe[1],!0,!0);(!t.touchData.cxtOver||An!==t.touchData.cxtOver)&&(t.touchData.cxtOver&&t.touchData.cxtOver.emit(je("cxtdragout")),t.touchData.cxtOver=An,An&&An.emit(je("cxtdragover")))}else if(J&&H.touches[2]&&le.boxSelectionEnabled())H.preventDefault(),t.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,t.touchData.selecting||le.emit(je("boxstart")),t.touchData.selecting=!0,t.touchData.didSelect=!0,ae[4]=1,!ae||ae.length===0||ae[0]===void 0?(ae[0]=(fe[0]+fe[2]+fe[4])/3,ae[1]=(fe[1]+fe[3]+fe[5])/3,ae[2]=(fe[0]+fe[2]+fe[4])/3+1,ae[3]=(fe[1]+fe[3]+fe[5])/3+1):(ae[2]=(fe[0]+fe[2]+fe[4])/3,ae[3]=(fe[1]+fe[3]+fe[5])/3),t.redrawHint("select",!0),t.redraw();else if(J&&H.touches[1]&&!t.touchData.didSelect&&le.zoomingEnabled()&&le.panningEnabled()&&le.userZoomingEnabled()&&le.userPanningEnabled()){H.preventDefault(),t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var nn=t.dragData.touchDragEles;if(nn){t.redrawHint("drag",!0);for(var Rn=0;Rn<nn.length;Rn++){var Hl=nn[Rn]._private;Hl.grabbed=!1,Hl.rscratch.inDragLayer=!1}}var oi=t.touchData.start,br=H.touches[0].clientX-V,Ir=H.touches[0].clientY-Y,wr=H.touches[1].clientX-V,Pr=H.touches[1].clientY-Y,Sm=ge(br,Ir,wr,Pr),E1=Sm/de;if(ue){var T1=br-G,j1=Ir-ee,M1=wr-re,vf=Pr-se,Wl=(T1+M1)/2,yf=(j1+vf)/2,ws=le.zoom(),xf=ws*E1,po=le.pan(),Ss=ie[0]*ws+po.x,ma=ie[1]*ws+po.y,$t={x:-xf/ws*(Ss-po.x-Wl)+Ss,y:-xf/ws*(ma-po.y-yf)+ma};if(oi&&oi.active()){var nn=t.dragData.touchDragEles;b(nn),t.redrawHint("drag",!0),t.redrawHint("eles",!0),oi.unactivate().emit(je("freeon")),nn.emit(je("free")),t.dragData.didDrag&&(oi.emit(je("dragfreeon")),nn.emit(je("dragfree")))}le.viewport({zoom:xf,pan:$t,cancelOnFailedZoom:!0}),le.emit(je("pinchzoom")),de=Sm,G=br,ee=Ir,re=wr,se=Pr,t.pinching=!0}if(H.touches[0]){var Te=t.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);fe[0]=Te[0],fe[1]=Te[1]}if(H.touches[1]){var Te=t.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);fe[2]=Te[0],fe[3]=Te[1]}if(H.touches[2]){var Te=t.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);fe[4]=Te[0],fe[5]=Te[1]}}else if(H.touches[0]&&!t.touchData.didSelect){var vt=t.touchData.start,Fi=t.touchData.last,An;if(!t.hoverData.draggingEles&&!t.swipePanning&&(An=t.findNearestElement(fe[0],fe[1],!0,!0)),J&&vt!=null&&H.preventDefault(),J&&vt!=null&&t.nodeIsDraggable(vt))if(et){var nn=t.dragData.touchDragEles,Gr=!t.dragData.didDrag;Gr&&y(nn,{inDragLayer:!0}),t.dragData.didDrag=!0;var Lr={x:0,y:0};if(Ee(tt[0])&&Ee(tt[1])&&(Lr.x+=tt[0],Lr.y+=tt[1],Gr)){t.redrawHint("eles",!0);var Hr=t.touchData.dragDelta;Hr&&Ee(Hr[0])&&Ee(Hr[1])&&(Lr.x+=Hr[0],Lr.y+=Hr[1])}t.hoverData.draggingEles=!0,nn.silentShift(Lr).emit(je("position")).emit(je("drag")),t.redrawHint("drag",!0),t.touchData.startPosition[0]==xe[0]&&t.touchData.startPosition[1]==xe[1]&&t.redrawHint("eles",!0),t.redraw()}else{var Hr=t.touchData.dragDelta=t.touchData.dragDelta||[];Hr.length===0?(Hr.push(tt[0]),Hr.push(tt[1])):(Hr[0]+=tt[0],Hr[1]+=tt[1])}if(i(vt||An,["touchmove","tapdrag","vmousemove"],H,{x:fe[0],y:fe[1]}),(!vt||!vt.grabbed())&&An!=Fi&&(Fi&&Fi.emit(je("tapdragout")),An&&An.emit(je("tapdragover"))),t.touchData.last=An,J)for(var Rn=0;Rn<fe.length;Rn++)fe[Rn]&&t.touchData.startPosition[Rn]&&et&&(t.touchData.singleTouchMoved=!0);if(J&&(vt==null||vt.pannable())&&le.panningEnabled()&&le.userPanningEnabled()){var mo=s(vt,t.touchData.starts);mo&&(H.preventDefault(),t.data.bgActivePosistion||(t.data.bgActivePosistion=od(t.touchData.startPosition)),t.swipePanning?(le.panBy({x:tt[0]*ye,y:tt[1]*ye}),le.emit(je("dragpan"))):et&&(t.swipePanning=!0,le.panBy({x:nt*ye,y:Kt*ye}),le.emit(je("dragpan")),vt&&(vt.unactivate(),t.redrawHint("select",!0),t.touchData.start=null)));var Te=t.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);fe[0]=Te[0],fe[1]=Te[1]}}for(var Ie=0;Ie<fe.length;Ie++)xe[Ie]=fe[Ie];J&&H.touches.length>0&&!t.hoverData.draggingEles&&!t.swipePanning&&t.data.bgActivePosistion!=null&&(t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.redraw())}},!1);var Ge;t.registerBinding(e,"touchcancel",Ge=function(H){var J=t.touchData.start;t.touchData.capture=!1,J&&J.unactivate()});var Ce,Re,Ve,We;if(t.registerBinding(e,"touchend",Ce=function(H){var J=t.touchData.start,ae=t.touchData.capture;if(ae)H.touches.length===0&&(t.touchData.capture=!1),H.preventDefault();else return;var le=t.selection;t.swipePanning=!1,t.hoverData.draggingEles=!1;var fe=t.cy,xe=fe.zoom(),ye=t.touchData.now,Te=t.touchData.earlier;if(H.touches[0]){var je=t.projectIntoViewport(H.touches[0].clientX,H.touches[0].clientY);ye[0]=je[0],ye[1]=je[1]}if(H.touches[1]){var je=t.projectIntoViewport(H.touches[1].clientX,H.touches[1].clientY);ye[2]=je[0],ye[3]=je[1]}if(H.touches[2]){var je=t.projectIntoViewport(H.touches[2].clientX,H.touches[2].clientY);ye[4]=je[0],ye[5]=je[1]}var He=function(pa){return{originalEvent:H,type:pa,position:{x:ye[0],y:ye[1]}}};J&&J.unactivate();var et;if(t.touchData.cxt){if(et=He("cxttapend"),J?J.emit(et):fe.emit(et),!t.touchData.cxtDragged){var tt=He("cxttap");J?J.emit(tt):fe.emit(tt)}t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!1,t.touchData.start=null,t.redraw();return}if(!H.touches[2]&&fe.boxSelectionEnabled()&&t.touchData.selecting){t.touchData.selecting=!1;var Ie=fe.collection(t.getAllInBox(le[0],le[1],le[2],le[3]));le[0]=void 0,le[1]=void 0,le[2]=void 0,le[3]=void 0,le[4]=0,t.redrawHint("select",!0),fe.emit(He("boxend"));var nt=function(pa){return pa.selectable()&&!pa.selected()};Ie.emit(He("box")).stdFilter(nt).select().emit(He("boxselect")),Ie.nonempty()&&t.redrawHint("eles",!0),t.redraw()}if(J!=null&&J.unactivate(),H.touches[2])t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);else if(!H.touches[1]){if(!H.touches[0]){if(!H.touches[0]){t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var st=t.dragData.touchDragEles;if(J!=null){var Kt=J._private.grabbed;b(st),t.redrawHint("drag",!0),t.redrawHint("eles",!0),Kt&&(J.emit(He("freeon")),st.emit(He("free")),t.dragData.didDrag&&(J.emit(He("dragfreeon")),st.emit(He("dragfree")))),i(J,["touchend","tapend","vmouseup","tapdragout"],H,{x:ye[0],y:ye[1]}),J.unactivate(),t.touchData.start=null}else{var Ot=t.findNearestElement(ye[0],ye[1],!0,!0);i(Ot,["touchend","tapend","vmouseup","tapdragout"],H,{x:ye[0],y:ye[1]})}var yn=t.touchData.startPosition[0]-ye[0],br=yn*yn,Ir=t.touchData.startPosition[1]-ye[1],wr=Ir*Ir,Pr=br+wr,Fa=Pr*xe*xe;t.touchData.singleTouchMoved||(J||fe.$(":selected").unselect(["tapunselect"]),i(J,["tap","vclick"],H,{x:ye[0],y:ye[1]}),Re=!1,H.timeStamp-We<=fe.multiClickDebounceTime()?(Ve&&clearTimeout(Ve),Re=!0,We=null,i(J,["dbltap","vdblclick"],H,{x:ye[0],y:ye[1]})):(Ve=setTimeout(function(){Re||i(J,["onetap","voneclick"],H,{x:ye[0],y:ye[1]})},fe.multiClickDebounceTime()),We=H.timeStamp)),J!=null&&!t.dragData.didDrag&&J._private.selectable&&Fa<t.touchTapThreshold2&&!t.pinching&&(fe.selectionType()==="single"?(fe.$(r).unmerge(J).unselect(["tapunselect"]),J.select(["tapselect"])):J.selected()?J.unselect(["tapunselect"]):J.select(["tapselect"]),t.redrawHint("eles",!0)),t.touchData.singleTouchMoved=!0}}}for(var Sr=0;Sr<ye.length;Sr++)Te[Sr]=ye[Sr];t.dragData.didDrag=!1,H.touches.length===0&&(t.touchData.dragDelta=[],t.touchData.startPosition=[null,null,null,null,null,null],t.touchData.startGPosition=null,t.touchData.didSelect=!1),H.touches.length<2&&(H.touches.length===1&&(t.touchData.startGPosition=[H.touches[0].clientX,H.touches[0].clientY]),t.pinching=!1,t.redrawHint("eles",!0),t.redraw())},!1),typeof TouchEvent>"u"){var Oe=[],rt=function(H){return{clientX:H.clientX,clientY:H.clientY,force:1,identifier:H.pointerId,pageX:H.pageX,pageY:H.pageY,radiusX:H.width/2,radiusY:H.height/2,screenX:H.screenX,screenY:H.screenY,target:H.target}},ct=function(H){return{event:H,touch:rt(H)}},xt=function(H){Oe.push(ct(H))},bt=function(H){for(var J=0;J<Oe.length;J++){var ae=Oe[J];if(ae.event.pointerId===H.pointerId){Oe.splice(J,1);return}}},Et=function(H){var J=Oe.filter(function(ae){return ae.event.pointerId===H.pointerId})[0];J.event=H,J.touch=rt(H)},Je=function(H){H.touches=Oe.map(function(J){return J.touch})},De=function(H){return H.pointerType==="mouse"||H.pointerType===4};t.registerBinding(t.container,"pointerdown",function(ve){De(ve)||(ve.preventDefault(),xt(ve),Je(ve),Pe(ve))}),t.registerBinding(t.container,"pointerup",function(ve){De(ve)||(bt(ve),Je(ve),Ce(ve))}),t.registerBinding(t.container,"pointercancel",function(ve){De(ve)||(bt(ve),Je(ve),Ge(ve))}),t.registerBinding(t.container,"pointermove",function(ve){De(ve)||(ve.preventDefault(),Et(ve),Je(ve),ze(ve))})}};var ao={};ao.generatePolygon=function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,draw:function(n,i,a,s,o,l){this.renderer.nodeShapeImpl("polygon",n,i,a,s,o,this.points)},intersectLine:function(n,i,a,s,o,l,c,u){return Sp(o,l,this.points,n,i,a/2,s/2,c)},checkPoint:function(n,i,a,s,o,l,c,u){return to(n,i,this.points,l,c,s,o,[0,-1],a)},hasMiterBounds:t!=="rectangle",miterBounds:function(n,i,a,s,o,l){return sG(this.points,n,i,a,s,o)}}};ao.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a)},intersectLine:function(e,r,n,i,a,s,o,l){return pG(a,s,e,r,n/2+o,i/2+o)},checkPoint:function(e,r,n,i,a,s,o,l){return yc(e,r,i,a,s,o,n)}}};ao.generateRoundPolygon=function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,getOrCreateCorners:function(n,i,a,s,o,l,c){if(l[c]!==void 0&&l[c+"-cx"]===n&&l[c+"-cy"]===i)return l[c];l[c]=new Array(e.length/2),l[c+"-cx"]=n,l[c+"-cy"]=i;var u=a/2,f=s/2;o=o==="auto"?nR(a,s):o;for(var h=new Array(e.length/2),m=0;m<e.length/2;m++)h[m]={x:n+u*e[m*2],y:i+f*e[m*2+1]};var v,y,x,b,S=h.length;for(y=h[S-1],v=0;v<S;v++)x=h[v%S],b=h[(v+1)%S],l[c][v]=m3(y,x,b,o),y=x,x=b;return l[c]},draw:function(n,i,a,s,o,l,c){this.renderer.nodeShapeImpl("round-polygon",n,i,a,s,o,this.points,this.getOrCreateCorners(i,a,s,o,l,c,"drawCorners"))},intersectLine:function(n,i,a,s,o,l,c,u,f){return gG(o,l,this.points,n,i,a,s,c,this.getOrCreateCorners(n,i,a,s,u,f,"corners"))},checkPoint:function(n,i,a,s,o,l,c,u,f){return hG(n,i,this.points,l,c,s,o,this.getOrCreateCorners(l,c,s,o,u,f,"corners"))}}};ao.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Qn(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,this.points,s)},intersectLine:function(e,r,n,i,a,s,o,l){return tR(a,s,e,r,n,i,o,l)},checkPoint:function(e,r,n,i,a,s,o,l){var c=i/2,u=a/2;l=l==="auto"?vl(i,a):l,l=Math.min(c,u,l);var f=l*2;return!!(to(e,r,this.points,s,o,i,a-f,[0,-1],n)||to(e,r,this.points,s,o,i-f,a,[0,-1],n)||yc(e,r,f,f,s-c+l,o-u+l,n)||yc(e,r,f,f,s+c-l,o-u+l,n)||yc(e,r,f,f,s+c-l,o+u-l,n)||yc(e,r,f,f,s-c+l,o+u-l,n))}}};ao.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:i3(),points:Qn(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,null,s)},generateCutTrianglePts:function(e,r,n,i,a){var s=a==="auto"?this.cornerLength:a,o=r/2,l=e/2,c=n-l,u=n+l,f=i-o,h=i+o;return{topLeft:[c,f+s,c+s,f,c+s,f+s],topRight:[u-s,f,u,f+s,u-s,f+s],bottomRight:[u,h-s,u-s,h,u-s,h-s],bottomLeft:[c+s,h,c,h-s,c+s,h-s]}},intersectLine:function(e,r,n,i,a,s,o,l){var c=this.generateCutTrianglePts(n+2*o,i+2*o,e,r,l),u=[].concat.apply([],[c.topLeft.splice(0,4),c.topRight.splice(0,4),c.bottomRight.splice(0,4),c.bottomLeft.splice(0,4)]);return Sp(a,s,u,e,r)},checkPoint:function(e,r,n,i,a,s,o,l){var c=l==="auto"?this.cornerLength:l;if(to(e,r,this.points,s,o,i,a-2*c,[0,-1],n)||to(e,r,this.points,s,o,i-2*c,a,[0,-1],n))return!0;var u=this.generateCutTrianglePts(i,a,s,o);return pi(e,r,u.topLeft)||pi(e,r,u.topRight)||pi(e,r,u.bottomRight)||pi(e,r,u.bottomLeft)}}};ao.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Qn(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a)},intersectLine:function(e,r,n,i,a,s,o,l){var c=.15,u=.5,f=.85,h=this.generateBarrelBezierPts(n+2*o,i+2*o,e,r),m=function(x){var b=yd({x:x[0],y:x[1]},{x:x[2],y:x[3]},{x:x[4],y:x[5]},c),S=yd({x:x[0],y:x[1]},{x:x[2],y:x[3]},{x:x[4],y:x[5]},u),w=yd({x:x[0],y:x[1]},{x:x[2],y:x[3]},{x:x[4],y:x[5]},f);return[x[0],x[1],b.x,b.y,S.x,S.y,w.x,w.y,x[4],x[5]]},v=[].concat(m(h.topLeft),m(h.topRight),m(h.bottomRight),m(h.bottomLeft));return Sp(a,s,v,e,r)},generateBarrelBezierPts:function(e,r,n,i){var a=r/2,s=e/2,o=n-s,l=n+s,c=i-a,u=i+a,f=B5(e,r),h=f.heightOffset,m=f.widthOffset,v=f.ctrlPtOffsetPct*e,y={topLeft:[o,c+h,o+v,c,o+m,c],topRight:[l-m,c,l-v,c,l,c+h],bottomRight:[l,u-h,l-v,u,l-m,u],bottomLeft:[o+m,u,o+v,u,o,u-h]};return y.topLeft.isTop=!0,y.topRight.isTop=!0,y.bottomLeft.isBottom=!0,y.bottomRight.isBottom=!0,y},checkPoint:function(e,r,n,i,a,s,o,l){var c=B5(i,a),u=c.heightOffset,f=c.widthOffset;if(to(e,r,this.points,s,o,i,a-2*u,[0,-1],n)||to(e,r,this.points,s,o,i-2*f,a,[0,-1],n))return!0;for(var h=this.generateBarrelBezierPts(i,a,s,o),m=function(M,A,_){var D=_[4],R=_[2],I=_[0],$=_[5],B=_[1],z=Math.min(D,I),U=Math.max(D,I),F=Math.min($,B),Q=Math.max($,B);if(z<=M&&M<=U&&F<=A&&A<=Q){var K=vG(D,R,I),L=cG(K[0],K[1],K[2],M),G=L.filter(function(ee){return 0<=ee&&ee<=1});if(G.length>0)return G[0]}return null},v=Object.keys(h),y=0;y<v.length;y++){var x=v[y],b=h[x],S=m(e,r,b);if(S!=null){var w=b[5],k=b[3],N=b[1],j=cn(w,k,N,S);if(b.isTop&&j<=r||b.isBottom&&r<=j)return!0}}return!1}}};ao.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Qn(4,0),draw:function(e,r,n,i,a,s){this.renderer.nodeShapeImpl(this.name,e,r,n,i,a,this.points,s)},intersectLine:function(e,r,n,i,a,s,o,l){var c=e-(n/2+o),u=r-(i/2+o),f=u,h=e+(n/2+o),m=Ko(a,s,e,r,c,u,h,f,!1);return m.length>0?m:tR(a,s,e,r,n,i,o,l)},checkPoint:function(e,r,n,i,a,s,o,l){l=l==="auto"?vl(i,a):l;var c=2*l;if(to(e,r,this.points,s,o,i,a-c,[0,-1],n)||to(e,r,this.points,s,o,i-c,a,[0,-1],n))return!0;var u=i/2+2*n,f=a/2+2*n,h=[s-u,o-f,s-u,o,s+u,o,s+u,o-f];return!!(pi(e,r,h)||yc(e,r,c,c,s+i/2-l,o+a/2-l,n)||yc(e,r,c,c,s-i/2+l,o+a/2-l,n))}}};ao.registerNodeShapes=function(){var t=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",Qn(3,0)),this.generateRoundPolygon("round-triangle",Qn(3,0)),this.generatePolygon("rectangle",Qn(4,0)),t.square=t.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var r=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",r),this.generateRoundPolygon("round-diamond",r)}this.generatePolygon("pentagon",Qn(5,0)),this.generateRoundPolygon("round-pentagon",Qn(5,0)),this.generatePolygon("hexagon",Qn(6,0)),this.generateRoundPolygon("round-hexagon",Qn(6,0)),this.generatePolygon("heptagon",Qn(7,0)),this.generateRoundPolygon("round-heptagon",Qn(7,0)),this.generatePolygon("octagon",Qn(8,0)),this.generateRoundPolygon("round-octagon",Qn(8,0));var n=new Array(20);{var i=L5(5,0),a=L5(5,Math.PI/5),s=.5*(3-Math.sqrt(5));s*=1.57;for(var o=0;o<a.length/2;o++)a[o*2]*=s,a[o*2+1]*=s;for(var o=0;o<20/4;o++)n[o*4]=i[o*2],n[o*4+1]=i[o*2+1],n[o*4+2]=a[o*2],n[o*4+3]=a[o*2+1]}n=rR(n),this.generatePolygon("star",n),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l)}t.makePolygon=function(c){var u=c.join("$"),f="polygon-"+u,h;return(h=this[f])?h:e.generatePolygon(f,c)}};var lm={};lm.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};lm.redraw=function(t){t=t||QA();var e=this;e.averageRedrawTime===void 0&&(e.averageRedrawTime=0),e.lastRedrawTime===void 0&&(e.lastRedrawTime=0),e.lastDrawTime===void 0&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=t};lm.beforeRender=function(t,e){if(!this.destroyed){e==null&&lr("Priority is not optional for beforeRender");var r=this.beforeRenderCallbacks;r.push({fn:t,priority:e}),r.sort(function(n,i){return i.priority-n.priority})}};var $8=function(e,r,n){for(var i=e.beforeRenderCallbacks,a=0;a<i.length;a++)i[a].fn(r,n)};lm.startRenderLoop=function(){var t=this,e=t.cy;if(!t.renderLoopStarted){t.renderLoopStarted=!0;var r=function(i){if(!t.destroyed){if(!e.batching())if(t.requestedFrame&&!t.skipFrame){$8(t,!0,i);var a=eo();t.render(t.renderOptions);var s=t.lastDrawTime=eo();t.averageRedrawTime===void 0&&(t.averageRedrawTime=s-a),t.redrawCount===void 0&&(t.redrawCount=0),t.redrawCount++,t.redrawTotalTime===void 0&&(t.redrawTotalTime=0);var o=s-a;t.redrawTotalTime+=o,t.lastRedrawTime=o,t.averageRedrawTime=t.averageRedrawTime/2+o/2,t.requestedFrame=!1}else $8(t,!1,i);t.skipFrame=!1,k0(r)}};k0(r)}};var Rq=function(e){this.init(e)},n7=Rq,lf=n7.prototype;lf.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];lf.init=function(t){var e=this;e.options=t,e.cy=t.cy;var r=e.container=t.cy.container(),n=e.cy.window();if(n){var i=n.document,a=i.head,s="__________cytoscape_stylesheet",o="__________cytoscape_container",l=i.getElementById(s)!=null;if(r.className.indexOf(o)<0&&(r.className=(r.className||"")+" "+o),!l){var c=i.createElement("style");c.id=s,c.textContent="."+o+" { position: relative; }",a.insertBefore(c,a.children[0])}var u=n.getComputedStyle(r),f=u.getPropertyValue("position");f==="static"&&Lt("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=t.showFps,e.debug=t.debug,e.webgl=t.webgl,e.hideEdgesOnViewport=t.hideEdgesOnViewport,e.textureOnViewport=t.textureOnViewport,e.wheelSensitivity=t.wheelSensitivity,e.motionBlurEnabled=t.motionBlur,e.forcedPixelRatio=Ee(t.pixelRatio)?t.pixelRatio:null,e.motionBlur=t.motionBlur,e.motionBlurOpacity=t.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=t.desktopTapThreshold,e.desktopTapThreshold2=t.desktopTapThreshold*t.desktopTapThreshold,e.touchTapThreshold=t.touchTapThreshold,e.touchTapThreshold2=t.touchTapThreshold*t.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()};lf.notify=function(t,e){var r=this,n=r.cy;if(!this.destroyed){if(t==="init"){r.load();return}if(t==="destroy"){r.destroy();return}(t==="add"||t==="remove"||t==="move"&&n.hasCompoundNodes()||t==="load"||t==="zorder"||t==="mount")&&r.invalidateCachedZSortedEles(),t==="viewport"&&r.redrawHint("select",!0),t==="gc"&&r.redrawHint("gc",!0),(t==="load"||t==="resize"||t==="mount")&&(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container)),r.redrawHint("eles",!0),r.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};lf.destroy=function(){var t=this;t.destroyed=!0,t.cy.stopAnimationLoop();for(var e=0;e<t.bindings.length;e++){var r=t.bindings[e],n=r,i=n.target;(i.off||i.removeEventListener).apply(i,n.args)}if(t.bindings=[],t.beforeRenderCallbacks=[],t.onUpdateEleCalcsFns=[],t.removeObserver&&t.removeObserver.disconnect(),t.styleObserver&&t.styleObserver.disconnect(),t.resizeObserver&&t.resizeObserver.disconnect(),t.labelCalcDiv)try{document.body.removeChild(t.labelCalcDiv)}catch{}};lf.isHeadless=function(){return!1};[p3,t7,r7,of,ao,lm].forEach(function(t){Qe(lf,t)});var D2=1e3/60,i7={setupDequeueing:function(e){return function(){var n=this,i=this.renderer;if(!n.dequeueingSetup){n.dequeueingSetup=!0;var a=nm(function(){i.redrawHint("eles",!0),i.redrawHint("drag",!0),i.redraw()},e.deqRedrawThreshold),s=function(c,u){var f=eo(),h=i.averageRedrawTime,m=i.lastRedrawTime,v=[],y=i.cy.extent(),x=i.getPixelRatio();for(c||i.flushRenderedStyleQueue();;){var b=eo(),S=b-f,w=b-u;if(m<D2){var k=D2-(c?h:0);if(w>=e.deqFastCost*k)break}else if(c){if(S>=e.deqCost*m||S>=e.deqAvgCost*h)break}else if(w>=e.deqNoDrawCost*D2)break;var N=e.deq(n,x,y);if(N.length>0)for(var j=0;j<N.length;j++)v.push(N[j]);else break}v.length>0&&(e.onDeqd(n,v),!c&&e.shouldRedraw(n,v,x,y)&&a())},o=e.priority||ZC;i.beforeRender(s,o(n))}}}},Dq=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:C0;Ml(this,t),this.idsByKey=new Gs,this.keyForId=new Gs,this.cachesByLvl=new Gs,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=r}return Pl(t,[{key:"getIdsFor",value:function(r){r==null&&lr("Can not get id list for null key");var n=this.idsByKey,i=this.idsByKey.get(r);return i||(i=new rf,n.set(r,i)),i}},{key:"addIdForKey",value:function(r,n){r!=null&&this.getIdsFor(r).add(n)}},{key:"deleteIdForKey",value:function(r,n){r!=null&&this.getIdsFor(r).delete(n)}},{key:"getNumberOfIdsForKey",value:function(r){return r==null?0:this.getIdsFor(r).size}},{key:"updateKeyMappingFor",value:function(r){var n=r.id(),i=this.keyForId.get(n),a=this.getKey(r);this.deleteIdForKey(i,n),this.addIdForKey(a,n),this.keyForId.set(n,a)}},{key:"deleteKeyMappingFor",value:function(r){var n=r.id(),i=this.keyForId.get(n);this.deleteIdForKey(i,n),this.keyForId.delete(n)}},{key:"keyHasChangedFor",value:function(r){var n=r.id(),i=this.keyForId.get(n),a=this.getKey(r);return i!==a}},{key:"isInvalid",value:function(r){return this.keyHasChangedFor(r)||this.doesEleInvalidateKey(r)}},{key:"getCachesAt",value:function(r){var n=this.cachesByLvl,i=this.lvls,a=n.get(r);return a||(a=new Gs,n.set(r,a),i.push(r)),a}},{key:"getCache",value:function(r,n){return this.getCachesAt(n).get(r)}},{key:"get",value:function(r,n){var i=this.getKey(r),a=this.getCache(i,n);return a!=null&&this.updateKeyMappingFor(r),a}},{key:"getForCachedKey",value:function(r,n){var i=this.keyForId.get(r.id()),a=this.getCache(i,n);return a}},{key:"hasCache",value:function(r,n){return this.getCachesAt(n).has(r)}},{key:"has",value:function(r,n){var i=this.getKey(r);return this.hasCache(i,n)}},{key:"setCache",value:function(r,n,i){i.key=r,this.getCachesAt(n).set(r,i)}},{key:"set",value:function(r,n,i){var a=this.getKey(r);this.setCache(a,n,i),this.updateKeyMappingFor(r)}},{key:"deleteCache",value:function(r,n){this.getCachesAt(n).delete(r)}},{key:"delete",value:function(r,n){var i=this.getKey(r);this.deleteCache(i,n)}},{key:"invalidateKey",value:function(r){var n=this;this.lvls.forEach(function(i){return n.deleteCache(r,i)})}},{key:"invalidate",value:function(r){var n=r.id(),i=this.keyForId.get(n);this.deleteKeyMappingFor(r);var a=this.doesEleInvalidateKey(r);return a&&this.invalidateKey(i),a||this.getNumberOfIdsForKey(i)===0}}])}(),U8=25,$g=50,Iv=-4,Q5=3,a7=7.99,Oq=8,Iq=1024,Lq=1024,Bq=1024,Fq=.2,zq=.8,Vq=10,$q=.15,Uq=.1,Gq=.9,Hq=.9,Wq=100,qq=1,cd={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},Kq=Pn({getKey:null,doesEleInvalidateKey:C0,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:KA,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),wh=function(e,r){var n=this;n.renderer=e,n.onDequeues=[];var i=Kq(r);Qe(n,i),n.lookup=new Dq(i.getKey,i.doesEleInvalidateKey),n.setupDequeueing()},en=wh.prototype;en.reasons=cd;en.getTextureQueue=function(t){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[t]=e.eleImgCaches[t]||[]};en.getRetiredTextureQueue=function(t){var e=this,r=e.eleImgCaches.retired=e.eleImgCaches.retired||{},n=r[t]=r[t]||[];return n};en.getElementQueue=function(){var t=this,e=t.eleCacheQueue=t.eleCacheQueue||new im(function(r,n){return n.reqs-r.reqs});return e};en.getElementKeyToQueue=function(){var t=this,e=t.eleKeyToCacheQueue=t.eleKeyToCacheQueue||{};return e};en.getElement=function(t,e,r,n,i){var a=this,s=this.renderer,o=s.cy.zoom(),l=this.lookup;if(!e||e.w===0||e.h===0||isNaN(e.w)||isNaN(e.h)||!t.visible()||t.removed()||!a.allowEdgeTxrCaching&&t.isEdge()||!a.allowParentTxrCaching&&t.isParent())return null;if(n==null&&(n=Math.ceil(t3(o*r))),n<Iv)n=Iv;else if(o>=a7||n>Q5)return null;var c=Math.pow(2,n),u=e.h*c,f=e.w*c,h=s.eleTextBiggerThanMin(t,c);if(!this.isVisible(t,h))return null;var m=l.get(t,n);if(m&&m.invalidated&&(m.invalidated=!1,m.texture.invalidatedWidth-=m.width),m)return m;var v;if(u<=U8?v=U8:u<=$g?v=$g:v=Math.ceil(u/$g)*$g,u>Bq||f>Lq)return null;var y=a.getTextureQueue(v),x=y[y.length-2],b=function(){return a.recycleTexture(v,f)||a.addTexture(v,f)};x||(x=y[y.length-1]),x||(x=b()),x.width-x.usedWidth<f&&(x=b());for(var S=function(z){return z&&z.scaledLabelShown===h},w=i&&i===cd.dequeue,k=i&&i===cd.highQuality,N=i&&i===cd.downscale,j,T=n+1;T<=Q5;T++){var M=l.get(t,T);if(M){j=M;break}}var A=j&&j.level===n+1?j:null,_=function(){x.context.drawImage(A.texture.canvas,A.x,0,A.width,A.height,x.usedWidth,0,f,u)};if(x.context.setTransform(1,0,0,1,0,0),x.context.clearRect(x.usedWidth,0,f,v),S(A))_();else if(S(j))if(k){for(var D=j.level;D>n;D--)A=a.getElement(t,e,r,D,cd.downscale);_()}else return a.queueElement(t,j.level-1),j;else{var R;if(!w&&!k&&!N)for(var I=n-1;I>=Iv;I--){var $=l.get(t,I);if($){R=$;break}}if(S(R))return a.queueElement(t,n),R;x.context.translate(x.usedWidth,0),x.context.scale(c,c),this.drawElement(x.context,t,e,h,!1),x.context.scale(1/c,1/c),x.context.translate(-x.usedWidth,0)}return m={x:x.usedWidth,texture:x,level:n,scale:c,width:f,height:u,scaledLabelShown:h},x.usedWidth+=Math.ceil(f+Oq),x.eleCaches.push(m),l.set(t,n,m),a.checkTextureFullness(x),m};en.invalidateElements=function(t){for(var e=0;e<t.length;e++)this.invalidateElement(t[e])};en.invalidateElement=function(t){var e=this,r=e.lookup,n=[],i=r.isInvalid(t);if(i){for(var a=Iv;a<=Q5;a++){var s=r.getForCachedKey(t,a);s&&n.push(s)}var o=r.invalidate(t);if(o)for(var l=0;l<n.length;l++){var c=n[l],u=c.texture;u.invalidatedWidth+=c.width,c.invalidated=!0,e.checkTextureUtility(u)}e.removeFromQueue(t)}};en.checkTextureUtility=function(t){t.invalidatedWidth>=Fq*t.width&&this.retireTexture(t)};en.checkTextureFullness=function(t){var e=this,r=e.getTextureQueue(t.height);t.usedWidth/t.width>zq&&t.fullnessChecks>=Vq?gl(r,t):t.fullnessChecks++};en.retireTexture=function(t){var e=this,r=t.height,n=e.getTextureQueue(r),i=this.lookup;gl(n,t),t.retired=!0;for(var a=t.eleCaches,s=0;s<a.length;s++){var o=a[s];i.deleteCache(o.key,o.level)}e3(a);var l=e.getRetiredTextureQueue(r);l.push(t)};en.addTexture=function(t,e){var r=this,n=r.getTextureQueue(t),i={};return n.push(i),i.eleCaches=[],i.height=t,i.width=Math.max(Iq,e),i.usedWidth=0,i.invalidatedWidth=0,i.fullnessChecks=0,i.canvas=r.renderer.makeOffscreenCanvas(i.width,i.height),i.context=i.canvas.getContext("2d"),i};en.recycleTexture=function(t,e){for(var r=this,n=r.getTextureQueue(t),i=r.getRetiredTextureQueue(t),a=0;a<i.length;a++){var s=i[a];if(s.width>=e)return s.retired=!1,s.usedWidth=0,s.invalidatedWidth=0,s.fullnessChecks=0,e3(s.eleCaches),s.context.setTransform(1,0,0,1,0,0),s.context.clearRect(0,0,s.width,s.height),gl(i,s),n.push(s),s}};en.queueElement=function(t,e){var r=this,n=r.getElementQueue(),i=r.getElementKeyToQueue(),a=this.getKey(t),s=i[a];if(s)s.level=Math.max(s.level,e),s.eles.merge(t),s.reqs++,n.updateItem(s);else{var o={eles:t.spawn().merge(t),level:e,reqs:1,key:a};n.push(o),i[a]=o}};en.dequeue=function(t){for(var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),i=[],a=e.lookup,s=0;s<qq&&r.size()>0;s++){var o=r.pop(),l=o.key,c=o.eles[0],u=a.hasCache(c,o.level);if(n[l]=null,u)continue;i.push(o);var f=e.getBoundingBox(c);e.getElement(c,f,t,o.level,cd.dequeue)}return i};en.removeFromQueue=function(t){var e=this,r=e.getElementQueue(),n=e.getElementKeyToQueue(),i=this.getKey(t),a=n[i];a!=null&&(a.eles.length===1?(a.reqs=JC,r.updateItem(a),r.pop(),n[i]=null):a.eles.unmerge(t))};en.onDequeue=function(t){this.onDequeues.push(t)};en.offDequeue=function(t){gl(this.onDequeues,t)};en.setupDequeueing=i7.setupDequeueing({deqRedrawThreshold:Wq,deqCost:$q,deqAvgCost:Uq,deqNoDrawCost:Gq,deqFastCost:Hq,deq:function(e,r,n){return e.dequeue(r,n)},onDeqd:function(e,r){for(var n=0;n<e.onDequeues.length;n++){var i=e.onDequeues[n];i(r)}},shouldRedraw:function(e,r,n,i){for(var a=0;a<r.length;a++)for(var s=r[a].eles,o=0;o<s.length;o++){var l=s[o].boundingBox();if(n3(l,i))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var Yq=1,Bh=-4,A0=2,Xq=3.99,Qq=50,Jq=50,Zq=.15,eK=.1,tK=.9,rK=.9,nK=1,G8=250,iK=4e3*4e3,H8=32767,aK=!0,s7=function(e){var r=this,n=r.renderer=e,i=n.cy;r.layersByLevel={},r.firstGet=!0,r.lastInvalidationTime=eo()-2*G8,r.skipping=!1,r.eleTxrDeqs=i.collection(),r.scheduleElementRefinement=nm(function(){r.refineElementTextures(r.eleTxrDeqs),r.eleTxrDeqs.unmerge(r.eleTxrDeqs)},Jq),n.beforeRender(function(s,o){o-r.lastInvalidationTime<=G8?r.skipping=!0:r.skipping=!1},n.beforeRenderPriorities.lyrTxrSkip);var a=function(o,l){return l.reqs-o.reqs};r.layersQueue=new im(a),r.setupDequeueing()},_n=s7.prototype,W8=0,sK=Math.pow(2,53)-1;_n.makeLayer=function(t,e){var r=Math.pow(2,e),n=Math.ceil(t.w*r),i=Math.ceil(t.h*r),a=this.renderer.makeOffscreenCanvas(n,i),s={id:W8=++W8%sK,bb:t,level:e,width:n,height:i,canvas:a,context:a.getContext("2d"),eles:[],elesQueue:[],reqs:0},o=s.context,l=-s.bb.x1,c=-s.bb.y1;return o.scale(r,r),o.translate(l,c),s};_n.getLayers=function(t,e,r){var n=this,i=n.renderer,a=i.cy,s=a.zoom(),o=n.firstGet;if(n.firstGet=!1,r==null){if(r=Math.ceil(t3(s*e)),r<Bh)r=Bh;else if(s>=Xq||r>A0)return null}n.validateLayersElesOrdering(r,t);var l=n.layersByLevel,c=Math.pow(2,r),u=l[r]=l[r]||[],f,h=n.levelIsComplete(r,t),m,v=function(){var _=function(B){if(n.validateLayersElesOrdering(B,t),n.levelIsComplete(B,t))return m=l[B],!0},D=function(B){if(!m)for(var z=r+B;Bh<=z&&z<=A0&&!_(z);z+=B);};D(1),D(-1);for(var R=u.length-1;R>=0;R--){var I=u[R];I.invalid&&gl(u,I)}};if(!h)v();else return u;var y=function(){if(!f){f=ei();for(var _=0;_<t.length;_++)nG(f,t[_].boundingBox())}return f},x=function(_){_=_||{};var D=_.after;y();var R=Math.ceil(f.w*c),I=Math.ceil(f.h*c);if(R>H8||I>H8)return null;var $=R*I;if($>iK)return null;var B=n.makeLayer(f,r);if(D!=null){var z=u.indexOf(D)+1;u.splice(z,0,B)}else(_.insert===void 0||_.insert)&&u.unshift(B);return B};if(n.skipping&&!o)return null;for(var b=null,S=t.length/Yq,w=!o,k=0;k<t.length;k++){var N=t[k],j=N._private.rscratch,T=j.imgLayerCaches=j.imgLayerCaches||{},M=T[r];if(M){b=M;continue}if((!b||b.eles.length>=S||!eR(b.bb,N.boundingBox()))&&(b=x({insert:!0,after:b}),!b))return null;m||w?n.queueLayer(b,N):n.drawEleInLayer(b,N,r,e),b.eles.push(N),T[r]=b}return m||(w?null:u)};_n.getEleLevelForLayerLevel=function(t,e){return t};_n.drawEleInLayer=function(t,e,r,n){var i=this,a=this.renderer,s=t.context,o=e.boundingBox();o.w===0||o.h===0||!e.visible()||(r=i.getEleLevelForLayerLevel(r,n),a.setImgSmoothing(s,!1),a.drawCachedElement(s,e,null,null,r,aK),a.setImgSmoothing(s,!0))};_n.levelIsComplete=function(t,e){var r=this,n=r.layersByLevel[t];if(!n||n.length===0)return!1;for(var i=0,a=0;a<n.length;a++){var s=n[a];if(s.reqs>0||s.invalid)return!1;i+=s.eles.length}return i===e.length};_n.validateLayersElesOrdering=function(t,e){var r=this.layersByLevel[t];if(r)for(var n=0;n<r.length;n++){for(var i=r[n],a=-1,s=0;s<e.length;s++)if(i.eles[0]===e[s]){a=s;break}if(a<0){this.invalidateLayer(i);continue}for(var o=a,s=0;s<i.eles.length;s++)if(i.eles[s]!==e[o+s]){this.invalidateLayer(i);break}}};_n.updateElementsInLayers=function(t,e){for(var r=this,n=Zp(t[0]),i=0;i<t.length;i++)for(var a=n?null:t[i],s=n?t[i]:t[i].ele,o=s._private.rscratch,l=o.imgLayerCaches=o.imgLayerCaches||{},c=Bh;c<=A0;c++){var u=l[c];u&&(a&&r.getEleLevelForLayerLevel(u.level)!==a.level||e(u,s,a))}};_n.haveLayers=function(){for(var t=this,e=!1,r=Bh;r<=A0;r++){var n=t.layersByLevel[r];if(n&&n.length>0){e=!0;break}}return e};_n.invalidateElements=function(t){var e=this;t.length!==0&&(e.lastInvalidationTime=eo(),!(t.length===0||!e.haveLayers())&&e.updateElementsInLayers(t,function(n,i,a){e.invalidateLayer(n)}))};_n.invalidateLayer=function(t){if(this.lastInvalidationTime=eo(),!t.invalid){var e=t.level,r=t.eles,n=this.layersByLevel[e];gl(n,t),t.elesQueue=[],t.invalid=!0,t.replacement&&(t.replacement.invalid=!0);for(var i=0;i<r.length;i++){var a=r[i]._private.rscratch.imgLayerCaches;a&&(a[e]=null)}}};_n.refineElementTextures=function(t){var e=this;e.updateElementsInLayers(t,function(n,i,a){var s=n.replacement;if(s||(s=n.replacement=e.makeLayer(n.bb,n.level),s.replaces=n,s.eles=n.eles),!s.reqs)for(var o=0;o<s.eles.length;o++)e.queueLayer(s,s.eles[o])})};_n.enqueueElementRefinement=function(t){this.eleTxrDeqs.merge(t),this.scheduleElementRefinement()};_n.queueLayer=function(t,e){var r=this,n=r.layersQueue,i=t.elesQueue,a=i.hasId=i.hasId||{};if(!t.replacement){if(e){if(a[e.id()])return;i.push(e),a[e.id()]=!0}t.reqs?(t.reqs++,n.updateItem(t)):(t.reqs=1,n.push(t))}};_n.dequeue=function(t){for(var e=this,r=e.layersQueue,n=[],i=0;i<nK&&r.size()!==0;){var a=r.peek();if(a.replacement){r.pop();continue}if(a.replaces&&a!==a.replaces.replacement){r.pop();continue}if(a.invalid){r.pop();continue}var s=a.elesQueue.shift();s&&(e.drawEleInLayer(a,s,a.level,t),i++),n.length===0&&n.push(!0),a.elesQueue.length===0&&(r.pop(),a.reqs=0,a.replaces&&e.applyLayerReplacement(a),e.requestRedraw())}return n};_n.applyLayerReplacement=function(t){var e=this,r=e.layersByLevel[t.level],n=t.replaces,i=r.indexOf(n);if(!(i<0||n.invalid)){r[i]=t;for(var a=0;a<t.eles.length;a++){var s=t.eles[a]._private,o=s.imgLayerCaches=s.imgLayerCaches||{};o&&(o[t.level]=t)}e.requestRedraw()}};_n.requestRedraw=nm(function(){var t=this.renderer;t.redrawHint("eles",!0),t.redrawHint("drag",!0),t.redraw()},100);_n.setupDequeueing=i7.setupDequeueing({deqRedrawThreshold:Qq,deqCost:Zq,deqAvgCost:eK,deqNoDrawCost:tK,deqFastCost:rK,deq:function(e,r){return e.dequeue(r)},onDeqd:ZC,shouldRedraw:KA,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var o7={},q8;function oK(t,e){for(var r=0;r<e.length;r++){var n=e[r];t.lineTo(n.x,n.y)}}function lK(t,e,r){for(var n,i=0;i<e.length;i++){var a=e[i];i===0&&(n=a),t.lineTo(a.x,a.y)}t.quadraticCurveTo(r.x,r.y,n.x,n.y)}function K8(t,e,r){t.beginPath&&t.beginPath();for(var n=e,i=0;i<n.length;i++){var a=n[i];t.lineTo(a.x,a.y)}var s=r,o=r[0];t.moveTo(o.x,o.y);for(var i=1;i<s.length;i++){var a=s[i];t.lineTo(a.x,a.y)}t.closePath&&t.closePath()}function cK(t,e,r,n,i){t.beginPath&&t.beginPath(),t.arc(r,n,i,0,Math.PI*2,!1);var a=e,s=a[0];t.moveTo(s.x,s.y);for(var o=0;o<a.length;o++){var l=a[o];t.lineTo(l.x,l.y)}t.closePath&&t.closePath()}function uK(t,e,r,n){t.arc(e,r,n,0,Math.PI*2,!1)}o7.arrowShapeImpl=function(t){return(q8||(q8={polygon:oK,"triangle-backcurve":lK,"triangle-tee":K8,"circle-triangle":cK,"triangle-cross":K8,circle:uK}))[t]};var vs={};vs.drawElement=function(t,e,r,n,i,a){var s=this;e.isNode()?s.drawNode(t,e,r,n,i,a):s.drawEdge(t,e,r,n,i,a)};vs.drawElementOverlay=function(t,e){var r=this;e.isNode()?r.drawNodeOverlay(t,e):r.drawEdgeOverlay(t,e)};vs.drawElementUnderlay=function(t,e){var r=this;e.isNode()?r.drawNodeUnderlay(t,e):r.drawEdgeUnderlay(t,e)};vs.drawCachedElementPortion=function(t,e,r,n,i,a,s,o){var l=this,c=r.getBoundingBox(e);if(!(c.w===0||c.h===0)){var u=r.getElement(e,c,n,i,a);if(u!=null){var f=o(l,e);if(f===0)return;var h=s(l,e),m=c.x1,v=c.y1,y=c.w,x=c.h,b,S,w,k,N;if(h!==0){var j=r.getRotationPoint(e);w=j.x,k=j.y,t.translate(w,k),t.rotate(h),N=l.getImgSmoothing(t),N||l.setImgSmoothing(t,!0);var T=r.getRotationOffset(e);b=T.x,S=T.y}else b=m,S=v;var M;f!==1&&(M=t.globalAlpha,t.globalAlpha=M*f),t.drawImage(u.texture.canvas,u.x,0,u.width,u.height,b,S,y,x),f!==1&&(t.globalAlpha=M),h!==0&&(t.rotate(-h),t.translate(-w,-k),N||l.setImgSmoothing(t,!1))}else r.drawElement(t,e)}};var dK=function(){return 0},fK=function(e,r){return e.getTextAngle(r,null)},hK=function(e,r){return e.getTextAngle(r,"source")},pK=function(e,r){return e.getTextAngle(r,"target")},mK=function(e,r){return r.effectiveOpacity()},O2=function(e,r){return r.pstyle("text-opacity").pfValue*r.effectiveOpacity()};vs.drawCachedElement=function(t,e,r,n,i,a){var s=this,o=s.data,l=o.eleTxrCache,c=o.lblTxrCache,u=o.slbTxrCache,f=o.tlbTxrCache,h=e.boundingBox(),m=a===!0?l.reasons.highQuality:null;if(!(h.w===0||h.h===0||!e.visible())&&(!n||n3(h,n))){var v=e.isEdge(),y=e.element()._private.rscratch.badLine;s.drawElementUnderlay(t,e),s.drawCachedElementPortion(t,e,l,r,i,m,dK,mK),(!v||!y)&&s.drawCachedElementPortion(t,e,c,r,i,m,fK,O2),v&&!y&&(s.drawCachedElementPortion(t,e,u,r,i,m,hK,O2),s.drawCachedElementPortion(t,e,f,r,i,m,pK,O2)),s.drawElementOverlay(t,e)}};vs.drawElements=function(t,e){for(var r=this,n=0;n<e.length;n++){var i=e[n];r.drawElement(t,i)}};vs.drawCachedElements=function(t,e,r,n){for(var i=this,a=0;a<e.length;a++){var s=e[a];i.drawCachedElement(t,s,r,n)}};vs.drawCachedNodes=function(t,e,r,n){for(var i=this,a=0;a<e.length;a++){var s=e[a];s.isNode()&&i.drawCachedElement(t,s,r,n)}};vs.drawLayeredElements=function(t,e,r,n){var i=this,a=i.data.lyrTxrCache.getLayers(e,r);if(a)for(var s=0;s<a.length;s++){var o=a[s],l=o.bb;l.w===0||l.h===0||t.drawImage(o.canvas,l.x1,l.y1,l.w,l.h)}else i.drawCachedElements(t,e,r,n)};var so={};so.drawEdge=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,o=e._private.rscratch;if(!(a&&!e.visible())&&!(o.badLine||o.allpts==null||isNaN(o.allpts[0]))){var l;r&&(l=r,t.translate(-l.x1,-l.y1));var c=a?e.pstyle("opacity").value:1,u=a?e.pstyle("line-opacity").value:1,f=e.pstyle("curve-style").value,h=e.pstyle("line-style").value,m=e.pstyle("width").pfValue,v=e.pstyle("line-cap").value,y=e.pstyle("line-outline-width").value,x=e.pstyle("line-outline-color").value,b=c*u,S=c*u,w=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b;f==="straight-triangle"?(s.eleStrokeStyle(t,e,B),s.drawEdgeTrianglePath(e,t,o.allpts)):(t.lineWidth=m,t.lineCap=v,s.eleStrokeStyle(t,e,B),s.drawEdgePath(e,t,o.allpts,h),t.lineCap="butt")},k=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b;if(t.lineWidth=m+y,t.lineCap=v,y>0)s.colorStrokeStyle(t,x[0],x[1],x[2],B);else{t.lineCap="butt";return}f==="straight-triangle"?s.drawEdgeTrianglePath(e,t,o.allpts):(s.drawEdgePath(e,t,o.allpts,h),t.lineCap="butt")},N=function(){i&&s.drawEdgeOverlay(t,e)},j=function(){i&&s.drawEdgeUnderlay(t,e)},T=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:S;s.drawArrowheads(t,e,B)},M=function(){s.drawElementText(t,e,null,n)};t.lineJoin="round";var A=e.pstyle("ghost").value==="yes";if(A){var _=e.pstyle("ghost-offset-x").pfValue,D=e.pstyle("ghost-offset-y").pfValue,R=e.pstyle("ghost-opacity").value,I=b*R;t.translate(_,D),w(I),T(I),t.translate(-_,-D)}else k();j(),w(),T(),N(),M(),r&&t.translate(l.x1,l.y1)}};var l7=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(r,n){if(n.visible()){var i=n.pstyle("".concat(e,"-opacity")).value;if(i!==0){var a=this,s=a.usePaths(),o=n._private.rscratch,l=n.pstyle("".concat(e,"-padding")).pfValue,c=2*l,u=n.pstyle("".concat(e,"-color")).value;r.lineWidth=c,o.edgeType==="self"&&!s?r.lineCap="butt":r.lineCap="round",a.colorStrokeStyle(r,u[0],u[1],u[2],i),a.drawEdgePath(n,r,o.allpts,"solid")}}}};so.drawEdgeOverlay=l7("overlay");so.drawEdgeUnderlay=l7("underlay");so.drawEdgePath=function(t,e,r,n){var i=t._private.rscratch,a=e,s,o=!1,l=this.usePaths(),c=t.pstyle("line-dash-pattern").pfValue,u=t.pstyle("line-dash-offset").pfValue;if(l){var f=r.join("$"),h=i.pathCacheKey&&i.pathCacheKey===f;h?(s=e=i.pathCache,o=!0):(s=e=new Path2D,i.pathCacheKey=f,i.pathCache=s)}if(a.setLineDash)switch(n){case"dotted":a.setLineDash([1,1]);break;case"dashed":a.setLineDash(c),a.lineDashOffset=u;break;case"solid":a.setLineDash([]);break}if(!o&&!i.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(r[0],r[1]),i.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var m=2;m+3<r.length;m+=4)e.quadraticCurveTo(r[m],r[m+1],r[m+2],r[m+3]);break;case"straight":case"haystack":for(var v=2;v+1<r.length;v+=2)e.lineTo(r[v],r[v+1]);break;case"segments":if(i.isRound){var y=vi(i.roundCorners),x;try{for(y.s();!(x=y.n()).done;){var b=x.value;XR(e,b)}}catch(w){y.e(w)}finally{y.f()}e.lineTo(r[r.length-2],r[r.length-1])}else for(var S=2;S+1<r.length;S+=2)e.lineTo(r[S],r[S+1]);break}e=a,l?e.stroke(s):e.stroke(),e.setLineDash&&e.setLineDash([])};so.drawEdgeTrianglePath=function(t,e,r){e.fillStyle=e.strokeStyle;for(var n=t.pstyle("width").pfValue,i=0;i+1<r.length;i+=2){var a=[r[i+2]-r[i],r[i+3]-r[i+1]],s=Math.sqrt(a[0]*a[0]+a[1]*a[1]),o=[a[1]/s,-a[0]/s],l=[o[0]*n/2,o[1]*n/2];e.beginPath(),e.moveTo(r[i]-l[0],r[i+1]-l[1]),e.lineTo(r[i]+l[0],r[i+1]+l[1]),e.lineTo(r[i+2],r[i+3]),e.closePath(),e.fill()}};so.drawArrowheads=function(t,e,r){var n=e._private.rscratch,i=n.edgeType==="haystack";i||this.drawArrowhead(t,e,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,r),this.drawArrowhead(t,e,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,r),this.drawArrowhead(t,e,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,r),i||this.drawArrowhead(t,e,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,r)};so.drawArrowhead=function(t,e,r,n,i,a,s){if(!(isNaN(n)||n==null||isNaN(i)||i==null||isNaN(a)||a==null)){var o=this,l=e.pstyle(r+"-arrow-shape").value;if(l!=="none"){var c=e.pstyle(r+"-arrow-fill").value==="hollow"?"both":"filled",u=e.pstyle(r+"-arrow-fill").value,f=e.pstyle("width").pfValue,h=e.pstyle(r+"-arrow-width"),m=h.value==="match-line"?f:h.pfValue;h.units==="%"&&(m*=f);var v=e.pstyle("opacity").value;s===void 0&&(s=v);var y=t.globalCompositeOperation;(s!==1||u==="hollow")&&(t.globalCompositeOperation="destination-out",o.colorFillStyle(t,255,255,255,1),o.colorStrokeStyle(t,255,255,255,1),o.drawArrowShape(e,t,c,f,l,m,n,i,a),t.globalCompositeOperation=y);var x=e.pstyle(r+"-arrow-color").value;o.colorFillStyle(t,x[0],x[1],x[2],s),o.colorStrokeStyle(t,x[0],x[1],x[2],s),o.drawArrowShape(e,t,u,f,l,m,n,i,a)}}};so.drawArrowShape=function(t,e,r,n,i,a,s,o,l){var c=this,u=this.usePaths()&&i!=="triangle-cross",f=!1,h,m=e,v={x:s,y:o},y=t.pstyle("arrow-scale").value,x=this.getArrowWidth(n,y),b=c.arrowShapes[i];if(u){var S=c.arrowPathCache=c.arrowPathCache||[],w=Bc(i),k=S[w];k!=null?(h=e=k,f=!0):(h=e=new Path2D,S[w]=h)}f||(e.beginPath&&e.beginPath(),u?b.draw(e,1,0,{x:0,y:0},1):b.draw(e,x,l,v,n),e.closePath&&e.closePath()),e=m,u&&(e.translate(s,o),e.rotate(l),e.scale(x,x)),(r==="filled"||r==="both")&&(u?e.fill(h):e.fill()),(r==="hollow"||r==="both")&&(e.lineWidth=a/(u?x:1),e.lineJoin="miter",u?e.stroke(h):e.stroke()),u&&(e.scale(1/x,1/x),e.rotate(-l),e.translate(-s,-o))};var v3={};v3.safeDrawImage=function(t,e,r,n,i,a,s,o,l,c){if(!(i<=0||a<=0||l<=0||c<=0))try{t.drawImage(e,r,n,i,a,s,o,l,c)}catch(u){Lt(u)}};v3.drawInscribedImage=function(t,e,r,n,i){var a=this,s=r.position(),o=s.x,l=s.y,c=r.cy().style(),u=c.getIndexedStyle.bind(c),f=u(r,"background-fit","value",n),h=u(r,"background-repeat","value",n),m=r.width(),v=r.height(),y=r.padding()*2,x=m+(u(r,"background-width-relative-to","value",n)==="inner"?0:y),b=v+(u(r,"background-height-relative-to","value",n)==="inner"?0:y),S=r._private.rscratch,w=u(r,"background-clip","value",n),k=w==="node",N=u(r,"background-image-opacity","value",n)*i,j=u(r,"background-image-smoothing","value",n),T=r.pstyle("corner-radius").value;T!=="auto"&&(T=r.pstyle("corner-radius").pfValue);var M=e.width||e.cachedW,A=e.height||e.cachedH;(M==null||A==null)&&(document.body.appendChild(e),M=e.cachedW=e.width||e.offsetWidth,A=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var _=M,D=A;if(u(r,"background-width","value",n)!=="auto"&&(u(r,"background-width","units",n)==="%"?_=u(r,"background-width","pfValue",n)*x:_=u(r,"background-width","pfValue",n)),u(r,"background-height","value",n)!=="auto"&&(u(r,"background-height","units",n)==="%"?D=u(r,"background-height","pfValue",n)*b:D=u(r,"background-height","pfValue",n)),!(_===0||D===0)){if(f==="contain"){var R=Math.min(x/_,b/D);_*=R,D*=R}else if(f==="cover"){var R=Math.max(x/_,b/D);_*=R,D*=R}var I=o-x/2,$=u(r,"background-position-x","units",n),B=u(r,"background-position-x","pfValue",n);$==="%"?I+=(x-_)*B:I+=B;var z=u(r,"background-offset-x","units",n),U=u(r,"background-offset-x","pfValue",n);z==="%"?I+=(x-_)*U:I+=U;var F=l-b/2,Q=u(r,"background-position-y","units",n),K=u(r,"background-position-y","pfValue",n);Q==="%"?F+=(b-D)*K:F+=K;var L=u(r,"background-offset-y","units",n),G=u(r,"background-offset-y","pfValue",n);L==="%"?F+=(b-D)*G:F+=G,S.pathCache&&(I-=o,F-=l,o=0,l=0);var ee=t.globalAlpha;t.globalAlpha=N;var re=a.getImgSmoothing(t),se=!1;if(j==="no"&&re?(a.setImgSmoothing(t,!1),se=!0):j==="yes"&&!re&&(a.setImgSmoothing(t,!0),se=!0),h==="no-repeat")k&&(t.save(),S.pathCache?t.clip(S.pathCache):(a.nodeShapes[a.getNodeShape(r)].draw(t,o,l,x,b,T,S),t.clip())),a.safeDrawImage(t,e,0,0,M,A,I,F,_,D),k&&t.restore();else{var de=t.createPattern(e,h);t.fillStyle=de,a.nodeShapes[a.getNodeShape(r)].draw(t,o,l,x,b,T,S),t.translate(I,F),t.fill(),t.translate(-I,-F)}t.globalAlpha=ee,se&&a.setImgSmoothing(t,re)}};var eu={};eu.eleTextBiggerThanMin=function(t,e){if(!e){var r=t.cy().zoom(),n=this.getPixelRatio(),i=Math.ceil(t3(r*n));e=Math.pow(2,i)}var a=t.pstyle("font-size").pfValue*e,s=t.pstyle("min-zoomed-font-size").pfValue;return!(a<s)};eu.drawElementText=function(t,e,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this;if(n==null){if(a&&!s.eleTextBiggerThanMin(e))return}else if(n===!1)return;if(e.isNode()){var o=e.pstyle("label");if(!o||!o.value)return;var l=s.getLabelJustification(e);t.textAlign=l,t.textBaseline="bottom"}else{var c=e.element()._private.rscratch.badLine,u=e.pstyle("label"),f=e.pstyle("source-label"),h=e.pstyle("target-label");if(c||(!u||!u.value)&&(!f||!f.value)&&(!h||!h.value))return;t.textAlign="center",t.textBaseline="bottom"}var m=!r,v;r&&(v=r,t.translate(-v.x1,-v.y1)),i==null?(s.drawText(t,e,null,m,a),e.isEdge()&&(s.drawText(t,e,"source",m,a),s.drawText(t,e,"target",m,a))):s.drawText(t,e,i,m,a),r&&t.translate(v.x1,v.y1)};eu.getFontCache=function(t){var e;this.fontCaches=this.fontCaches||[];for(var r=0;r<this.fontCaches.length;r++)if(e=this.fontCaches[r],e.context===t)return e;return e={context:t},this.fontCaches.push(e),e};eu.setupTextStyle=function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,n=e.pstyle("font-style").strValue,i=e.pstyle("font-size").pfValue+"px",a=e.pstyle("font-family").strValue,s=e.pstyle("font-weight").strValue,o=r?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,l=e.pstyle("text-outline-opacity").value*o,c=e.pstyle("color").value,u=e.pstyle("text-outline-color").value;t.font=n+" "+s+" "+i+" "+a,t.lineJoin="round",this.colorFillStyle(t,c[0],c[1],c[2],o),this.colorStrokeStyle(t,u[0],u[1],u[2],l)};function gK(t,e,r,n,i){var a=Math.min(n,i),s=a/2,o=e+n/2,l=r+i/2;t.beginPath(),t.arc(o,l,s,0,Math.PI*2),t.closePath()}function Y8(t,e,r,n,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,s=Math.min(a,n/2,i/2);t.beginPath(),t.moveTo(e+s,r),t.lineTo(e+n-s,r),t.quadraticCurveTo(e+n,r,e+n,r+s),t.lineTo(e+n,r+i-s),t.quadraticCurveTo(e+n,r+i,e+n-s,r+i),t.lineTo(e+s,r+i),t.quadraticCurveTo(e,r+i,e,r+i-s),t.lineTo(e,r+s),t.quadraticCurveTo(e,r,e+s,r),t.closePath()}eu.getTextAngle=function(t,e){var r,n=t._private,i=n.rscratch,a=e?e+"-":"",s=t.pstyle(a+"text-rotation");if(s.strValue==="autorotate"){var o=hi(i,"labelAngle",e);r=t.isEdge()?o:0}else s.strValue==="none"?r=0:r=s.pfValue;return r};eu.drawText=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=e._private,s=a.rscratch,o=i?e.effectiveOpacity():1;if(!(i&&(o===0||e.pstyle("text-opacity").value===0))){r==="main"&&(r=null);var l=hi(s,"labelX",r),c=hi(s,"labelY",r),u,f,h=this.getLabelText(e,r);if(h!=null&&h!==""&&!isNaN(l)&&!isNaN(c)){this.setupTextStyle(t,e,i);var m=r?r+"-":"",v=hi(s,"labelWidth",r),y=hi(s,"labelHeight",r),x=e.pstyle(m+"text-margin-x").pfValue,b=e.pstyle(m+"text-margin-y").pfValue,S=e.isEdge(),w=e.pstyle("text-halign").value,k=e.pstyle("text-valign").value;S&&(w="center",k="center"),l+=x,c+=b;var N;switch(n?N=this.getTextAngle(e,r):N=0,N!==0&&(u=l,f=c,t.translate(u,f),t.rotate(N),l=0,c=0),k){case"top":break;case"center":c+=y/2;break;case"bottom":c+=y;break}var j=e.pstyle("text-background-opacity").value,T=e.pstyle("text-border-opacity").value,M=e.pstyle("text-border-width").pfValue,A=e.pstyle("text-background-padding").pfValue,_=e.pstyle("text-background-shape").strValue,D=_==="round-rectangle"||_==="roundrectangle",R=_==="circle",I=2;if(j>0||M>0&&T>0){var $=t.fillStyle,B=t.strokeStyle,z=t.lineWidth,U=e.pstyle("text-background-color").value,F=e.pstyle("text-border-color").value,Q=e.pstyle("text-border-style").value,K=j>0,L=M>0&&T>0,G=l-A;switch(w){case"left":G-=v;break;case"center":G-=v/2;break}var ee=c-y-A,re=v+2*A,se=y+2*A;if(K&&(t.fillStyle="rgba(".concat(U[0],",").concat(U[1],",").concat(U[2],",").concat(j*o,")")),L&&(t.strokeStyle="rgba(".concat(F[0],",").concat(F[1],",").concat(F[2],",").concat(T*o,")"),t.lineWidth=M,t.setLineDash))switch(Q){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"double":t.lineWidth=M/4,t.setLineDash([]);break;case"solid":default:t.setLineDash([]);break}if(D?(t.beginPath(),Y8(t,G,ee,re,se,I)):R?(t.beginPath(),gK(t,G,ee,re,se)):(t.beginPath(),t.rect(G,ee,re,se)),K&&t.fill(),L&&t.stroke(),L&&Q==="double"){var de=M/2;t.beginPath(),D?Y8(t,G+de,ee+de,re-2*de,se-2*de,I):t.rect(G+de,ee+de,re-2*de,se-2*de),t.stroke()}t.fillStyle=$,t.strokeStyle=B,t.lineWidth=z,t.setLineDash&&t.setLineDash([])}var W=2*e.pstyle("text-outline-width").pfValue;if(W>0&&(t.lineWidth=W),e.pstyle("text-wrap").value==="wrap"){var ne=hi(s,"labelWrapCachedLines",r),ie=hi(s,"labelLineHeight",r),V=v/2,Y=this.getLabelJustification(e);switch(Y==="auto"||(w==="left"?Y==="left"?l+=-v:Y==="center"&&(l+=-V):w==="center"?Y==="left"?l+=-V:Y==="right"&&(l+=V):w==="right"&&(Y==="center"?l+=V:Y==="right"&&(l+=v))),k){case"top":c-=(ne.length-1)*ie;break;case"center":case"bottom":c-=(ne.length-1)*ie;break}for(var te=0;te<ne.length;te++)W>0&&t.strokeText(ne[te],l,c),t.fillText(ne[te],l,c),c+=ie}else W>0&&t.strokeText(h,l,c),t.fillText(h,l,c);N!==0&&(t.rotate(-N),t.translate(-u,-f))}}};var Al={};Al.drawNode=function(t,e,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,s=this,o,l,c=e._private,u=c.rscratch,f=e.position();if(!(!Ee(f.x)||!Ee(f.y))&&!(a&&!e.visible())){var h=a?e.effectiveOpacity():1,m=s.usePaths(),v,y=!1,x=e.padding();o=e.width()+2*x,l=e.height()+2*x;var b;r&&(b=r,t.translate(-b.x1,-b.y1));for(var S=e.pstyle("background-image"),w=S.value,k=new Array(w.length),N=new Array(w.length),j=0,T=0;T<w.length;T++){var M=w[T],A=k[T]=M!=null&&M!=="none";if(A){var _=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",T);j++,N[T]=s.getCachedImage(M,_,function(){c.backgroundTimestamp=Date.now(),e.emitAndNotify("background")})}}var D=e.pstyle("background-blacken").value,R=e.pstyle("border-width").pfValue,I=e.pstyle("background-opacity").value*h,$=e.pstyle("border-color").value,B=e.pstyle("border-style").value,z=e.pstyle("border-join").value,U=e.pstyle("border-cap").value,F=e.pstyle("border-position").value,Q=e.pstyle("border-dash-pattern").pfValue,K=e.pstyle("border-dash-offset").pfValue,L=e.pstyle("border-opacity").value*h,G=e.pstyle("outline-width").pfValue,ee=e.pstyle("outline-color").value,re=e.pstyle("outline-style").value,se=e.pstyle("outline-opacity").value*h,de=e.pstyle("outline-offset").value,W=e.pstyle("corner-radius").value;W!=="auto"&&(W=e.pstyle("corner-radius").pfValue);var ne=function(){var De=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I;s.eleFillStyle(t,e,De)},ie=function(){var De=arguments.length>0&&arguments[0]!==void 0?arguments[0]:L;s.colorStrokeStyle(t,$[0],$[1],$[2],De)},V=function(){var De=arguments.length>0&&arguments[0]!==void 0?arguments[0]:se;s.colorStrokeStyle(t,ee[0],ee[1],ee[2],De)},Y=function(De,ve,H,J){var ae=s.nodePathCache=s.nodePathCache||[],le=qA(H==="polygon"?H+","+J.join(","):H,""+ve,""+De,""+W),fe=ae[le],xe,ye=!1;return fe!=null?(xe=fe,ye=!0,u.pathCache=xe):(xe=new Path2D,ae[le]=u.pathCache=xe),{path:xe,cacheHit:ye}},te=e.pstyle("shape").strValue,Z=e.pstyle("shape-polygon-points").pfValue;if(m){t.translate(f.x,f.y);var ue=Y(o,l,te,Z);v=ue.path,y=ue.cacheHit}var ge=function(){if(!y){var De=f;m&&(De={x:0,y:0}),s.nodeShapes[s.getNodeShape(e)].draw(v||t,De.x,De.y,o,l,W,u)}m?t.fill(v):t.fill()},Ue=function(){for(var De=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h,ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,H=c.backgrounding,J=0,ae=0;ae<N.length;ae++){var le=e.cy().style().getIndexedStyle(e,"background-image-containment","value",ae);if(ve&&le==="over"||!ve&&le==="inside"){J++;continue}k[ae]&&N[ae].complete&&!N[ae].error&&(J++,s.drawInscribedImage(t,N[ae],e,ae,De))}c.backgrounding=J!==j,H!==c.backgrounding&&e.updateStyle(!1)},Pe=function(){var De=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;s.hasPie(e)&&(s.drawPie(t,e,ve),De&&(m||s.nodeShapes[s.getNodeShape(e)].draw(t,f.x,f.y,o,l,W,u)))},ze=function(){var De=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h;s.hasStripe(e)&&(t.save(),m?t.clip(u.pathCache):(s.nodeShapes[s.getNodeShape(e)].draw(t,f.x,f.y,o,l,W,u),t.clip()),s.drawStripe(t,e,ve),t.restore(),De&&(m||s.nodeShapes[s.getNodeShape(e)].draw(t,f.x,f.y,o,l,W,u)))},Ge=function(){var De=arguments.length>0&&arguments[0]!==void 0?arguments[0]:h,ve=(D>0?D:-D)*De,H=D>0?0:255;D!==0&&(s.colorFillStyle(t,H,H,H,ve),m?t.fill(v):t.fill())},Ce=function(){if(R>0){if(t.lineWidth=R,t.lineCap=U,t.lineJoin=z,t.setLineDash)switch(B){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash(Q),t.lineDashOffset=K;break;case"solid":case"double":t.setLineDash([]);break}if(F!=="center"){if(t.save(),t.lineWidth*=2,F==="inside")m?t.clip(v):t.clip();else{var De=new Path2D;De.rect(-o/2-R,-l/2-R,o+2*R,l+2*R),De.addPath(v),t.clip(De,"evenodd")}m?t.stroke(v):t.stroke(),t.restore()}else m?t.stroke(v):t.stroke();if(B==="double"){t.lineWidth=R/3;var ve=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",m?t.stroke(v):t.stroke(),t.globalCompositeOperation=ve}t.setLineDash&&t.setLineDash([])}},Re=function(){if(G>0){if(t.lineWidth=G,t.lineCap="butt",t.setLineDash)switch(re){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"solid":case"double":t.setLineDash([]);break}var De=f;m&&(De={x:0,y:0});var ve=s.getNodeShape(e),H=R;F==="inside"&&(H=0),F==="outside"&&(H*=2);var J=(o+H+(G+de))/o,ae=(l+H+(G+de))/l,le=o*J,fe=l*ae,xe=s.nodeShapes[ve].points,ye;if(m){var Te=Y(le,fe,ve,xe);ye=Te.path}if(ve==="ellipse")s.drawEllipsePath(ye||t,De.x,De.y,le,fe);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(ve)){var je=0,He=0,et=0;ve==="round-diamond"?je=(H+de+G)*1.4:ve==="round-heptagon"?(je=(H+de+G)*1.075,et=-(H/2+de+G)/35):ve==="round-hexagon"?je=(H+de+G)*1.12:ve==="round-pentagon"?(je=(H+de+G)*1.13,et=-(H/2+de+G)/15):ve==="round-tag"?(je=(H+de+G)*1.12,He=(H/2+G+de)*.07):ve==="round-triangle"&&(je=(H+de+G)*(Math.PI/2),et=-(H+de/2+G)/Math.PI),je!==0&&(J=(o+je)/o,le=o*J,["round-hexagon","round-tag"].includes(ve)||(ae=(l+je)/l,fe=l*ae)),W=W==="auto"?nR(le,fe):W;for(var tt=le/2,Ie=fe/2,nt=W+(H+G+de)/2,st=new Array(xe.length/2),Kt=new Array(xe.length/2),Ot=0;Ot<xe.length/2;Ot++)st[Ot]={x:De.x+He+tt*xe[Ot*2],y:De.y+et+Ie*xe[Ot*2+1]};var yn,br,Ir,wr,Pr=st.length;for(br=st[Pr-1],yn=0;yn<Pr;yn++)Ir=st[yn%Pr],wr=st[(yn+1)%Pr],Kt[yn]=m3(br,Ir,wr,nt),br=Ir,Ir=wr;s.drawRoundPolygonPath(ye||t,De.x+He,De.y+et,o*J,l*ae,xe,Kt)}else if(["roundrectangle","round-rectangle"].includes(ve))W=W==="auto"?vl(le,fe):W,s.drawRoundRectanglePath(ye||t,De.x,De.y,le,fe,W+(H+G+de)/2);else if(["cutrectangle","cut-rectangle"].includes(ve))W=W==="auto"?i3():W,s.drawCutRectanglePath(ye||t,De.x,De.y,le,fe,null,W+(H+G+de)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(ve))W=W==="auto"?vl(le,fe):W,s.drawBottomRoundRectanglePath(ye||t,De.x,De.y,le,fe,W+(H+G+de)/2);else if(ve==="barrel")s.drawBarrelPath(ye||t,De.x,De.y,le,fe);else if(ve.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(ve)){var Fa=(H+G+de)/o;xe=N0(E0(xe,Fa)),s.drawPolygonPath(ye||t,De.x,De.y,o,l,xe)}else{var Sr=(H+G+de)/o;xe=N0(E0(xe,-Sr)),s.drawPolygonPath(ye||t,De.x,De.y,o,l,xe)}if(m?t.stroke(ye):t.stroke(),re==="double"){t.lineWidth=H/3;var si=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",m?t.stroke(ye):t.stroke(),t.globalCompositeOperation=si}t.setLineDash&&t.setLineDash([])}},Ve=function(){i&&s.drawNodeOverlay(t,e,f,o,l)},We=function(){i&&s.drawNodeUnderlay(t,e,f,o,l)},Oe=function(){s.drawElementText(t,e,null,n)},rt=e.pstyle("ghost").value==="yes";if(rt){var ct=e.pstyle("ghost-offset-x").pfValue,xt=e.pstyle("ghost-offset-y").pfValue,bt=e.pstyle("ghost-opacity").value,Et=bt*h;t.translate(ct,xt),V(),Re(),ne(bt*I),ge(),Ue(Et,!0),ie(bt*L),Ce(),Pe(D!==0||R!==0),ze(D!==0||R!==0),Ue(Et,!1),Ge(Et),t.translate(-ct,-xt)}m&&t.translate(-f.x,-f.y),We(),m&&t.translate(f.x,f.y),V(),Re(),ne(),ge(),Ue(h,!0),ie(),Ce(),Pe(D!==0||R!==0),ze(D!==0||R!==0),Ue(h,!1),Ge(),m&&t.translate(-f.x,-f.y),Oe(),Ve(),r&&t.translate(b.x1,b.y1)}};var c7=function(e){if(!["overlay","underlay"].includes(e))throw new Error("Invalid state");return function(r,n,i,a,s){var o=this;if(n.visible()){var l=n.pstyle("".concat(e,"-padding")).pfValue,c=n.pstyle("".concat(e,"-opacity")).value,u=n.pstyle("".concat(e,"-color")).value,f=n.pstyle("".concat(e,"-shape")).value,h=n.pstyle("".concat(e,"-corner-radius")).value;if(c>0){if(i=i||n.position(),a==null||s==null){var m=n.padding();a=n.width()+2*m,s=n.height()+2*m}o.colorFillStyle(r,u[0],u[1],u[2],c),o.nodeShapes[f].draw(r,i.x,i.y,a+l*2,s+l*2,h),r.fill()}}}};Al.drawNodeOverlay=c7("overlay");Al.drawNodeUnderlay=c7("underlay");Al.hasPie=function(t){return t=t[0],t._private.hasPie};Al.hasStripe=function(t){return t=t[0],t._private.hasStripe};Al.drawPie=function(t,e,r,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=e.pstyle("pie-size"),s=e.pstyle("pie-hole"),o=e.pstyle("pie-start-angle").pfValue,l=n.x,c=n.y,u=e.width(),f=e.height(),h=Math.min(u,f)/2,m,v=0,y=this.usePaths();if(y&&(l=0,c=0),a.units==="%"?h=h*a.pfValue:a.pfValue!==void 0&&(h=a.pfValue/2),s.units==="%"?m=h*s.pfValue:s.pfValue!==void 0&&(m=s.pfValue/2),!(m>=h))for(var x=1;x<=i.pieBackgroundN;x++){var b=e.pstyle("pie-"+x+"-background-size").value,S=e.pstyle("pie-"+x+"-background-color").value,w=e.pstyle("pie-"+x+"-background-opacity").value*r,k=b/100;k+v>1&&(k=1-v);var N=1.5*Math.PI+2*Math.PI*v;N+=o;var j=2*Math.PI*k,T=N+j;b===0||v>=1||v+k>1||(m===0?(t.beginPath(),t.moveTo(l,c),t.arc(l,c,h,N,T),t.closePath()):(t.beginPath(),t.arc(l,c,h,N,T),t.arc(l,c,m,T,N,!0),t.closePath()),this.colorFillStyle(t,S[0],S[1],S[2],w),t.fill(),v+=k)}};Al.drawStripe=function(t,e,r,n){e=e[0],n=n||e.position();var i=e.cy().style(),a=n.x,s=n.y,o=e.width(),l=e.height(),c=0,u=this.usePaths();t.save();var f=e.pstyle("stripe-direction").value,h=e.pstyle("stripe-size");switch(f){case"vertical":break;case"righward":t.rotate(-Math.PI/2);break}var m=o,v=l;h.units==="%"?(m=m*h.pfValue,v=v*h.pfValue):h.pfValue!==void 0&&(m=h.pfValue,v=h.pfValue),u&&(a=0,s=0),s-=m/2,a-=v/2;for(var y=1;y<=i.stripeBackgroundN;y++){var x=e.pstyle("stripe-"+y+"-background-size").value,b=e.pstyle("stripe-"+y+"-background-color").value,S=e.pstyle("stripe-"+y+"-background-opacity").value*r,w=x/100;w+c>1&&(w=1-c),!(x===0||c>=1||c+w>1)&&(t.beginPath(),t.rect(a,s+v*c,m,v*w),t.closePath(),this.colorFillStyle(t,b[0],b[1],b[2],S),t.fill(),c+=w)}t.restore()};var ai={},vK=100;ai.getPixelRatio=function(){var t=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var e=this.cy.window(),r=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(e.devicePixelRatio||1)/r};ai.paintCache=function(t){for(var e=this.paintCaches=this.paintCaches||[],r=!0,n,i=0;i<e.length;i++)if(n=e[i],n.context===t){r=!1;break}return r&&(n={context:t},e.push(n)),n};ai.createGradientStyleFor=function(t,e,r,n,i){var a,s=this.usePaths(),o=r.pstyle(e+"-gradient-stop-colors").value,l=r.pstyle(e+"-gradient-stop-positions").pfValue;if(n==="radial-gradient")if(r.isEdge()){var c=r.sourceEndpoint(),u=r.targetEndpoint(),f=r.midpoint(),h=Fc(c,f),m=Fc(u,f);a=t.createRadialGradient(f.x,f.y,0,f.x,f.y,Math.max(h,m))}else{var v=s?{x:0,y:0}:r.position(),y=r.paddedWidth(),x=r.paddedHeight();a=t.createRadialGradient(v.x,v.y,0,v.x,v.y,Math.max(y,x))}else if(r.isEdge()){var b=r.sourceEndpoint(),S=r.targetEndpoint();a=t.createLinearGradient(b.x,b.y,S.x,S.y)}else{var w=s?{x:0,y:0}:r.position(),k=r.paddedWidth(),N=r.paddedHeight(),j=k/2,T=N/2,M=r.pstyle("background-gradient-direction").value;switch(M){case"to-bottom":a=t.createLinearGradient(w.x,w.y-T,w.x,w.y+T);break;case"to-top":a=t.createLinearGradient(w.x,w.y+T,w.x,w.y-T);break;case"to-left":a=t.createLinearGradient(w.x+j,w.y,w.x-j,w.y);break;case"to-right":a=t.createLinearGradient(w.x-j,w.y,w.x+j,w.y);break;case"to-bottom-right":case"to-right-bottom":a=t.createLinearGradient(w.x-j,w.y-T,w.x+j,w.y+T);break;case"to-top-right":case"to-right-top":a=t.createLinearGradient(w.x-j,w.y+T,w.x+j,w.y-T);break;case"to-bottom-left":case"to-left-bottom":a=t.createLinearGradient(w.x+j,w.y-T,w.x-j,w.y+T);break;case"to-top-left":case"to-left-top":a=t.createLinearGradient(w.x+j,w.y+T,w.x-j,w.y-T);break}}if(!a)return null;for(var A=l.length===o.length,_=o.length,D=0;D<_;D++)a.addColorStop(A?l[D]:D/(_-1),"rgba("+o[D][0]+","+o[D][1]+","+o[D][2]+","+i+")");return a};ai.gradientFillStyle=function(t,e,r,n){var i=this.createGradientStyleFor(t,"background",e,r,n);if(!i)return null;t.fillStyle=i};ai.colorFillStyle=function(t,e,r,n,i){t.fillStyle="rgba("+e+","+r+","+n+","+i+")"};ai.eleFillStyle=function(t,e,r){var n=e.pstyle("background-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientFillStyle(t,e,n,r);else{var i=e.pstyle("background-color").value;this.colorFillStyle(t,i[0],i[1],i[2],r)}};ai.gradientStrokeStyle=function(t,e,r,n){var i=this.createGradientStyleFor(t,"line",e,r,n);if(!i)return null;t.strokeStyle=i};ai.colorStrokeStyle=function(t,e,r,n,i){t.strokeStyle="rgba("+e+","+r+","+n+","+i+")"};ai.eleStrokeStyle=function(t,e,r){var n=e.pstyle("line-fill").value;if(n==="linear-gradient"||n==="radial-gradient")this.gradientStrokeStyle(t,e,n,r);else{var i=e.pstyle("line-color").value;this.colorStrokeStyle(t,i[0],i[1],i[2],r)}};ai.matchCanvasSize=function(t){var e=this,r=e.data,n=e.findContainerClientCoords(),i=n[2],a=n[3],s=e.getPixelRatio(),o=e.motionBlurPxRatio;(t===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]||t===e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG])&&(s=o);var l=i*s,c=a*s,u;if(!(l===e.canvasWidth&&c===e.canvasHeight)){e.fontCaches=null;var f=r.canvasContainer;f.style.width=i+"px",f.style.height=a+"px";for(var h=0;h<e.CANVAS_LAYERS;h++)u=r.canvases[h],u.width=l,u.height=c,u.style.width=i+"px",u.style.height=a+"px";for(var h=0;h<e.BUFFER_COUNT;h++)u=r.bufferCanvases[h],u.width=l,u.height=c,u.style.width=i+"px",u.style.height=a+"px";e.textureMult=1,s<=1&&(u=r.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,u.width=l*e.textureMult,u.height=c*e.textureMult),e.canvasWidth=l,e.canvasHeight=c,e.pixelRatio=s}};ai.renderTo=function(t,e,r,n){this.render({forcedContext:t,forcedZoom:e,forcedPan:r,drawAllLayers:!0,forcedPxRatio:n})};ai.clearCanvas=function(){var t=this,e=t.data;function r(n){n.clearRect(0,0,t.canvasWidth,t.canvasHeight)}r(e.contexts[t.NODE]),r(e.contexts[t.DRAG])};ai.render=function(t){var e=this;t=t||QA();var r=e.cy,n=t.forcedContext,i=t.drawAllLayers,a=t.drawOnlyNodeLayer,s=t.forcedZoom,o=t.forcedPan,l=t.forcedPxRatio===void 0?this.getPixelRatio():t.forcedPxRatio,c=e.data,u=c.canvasNeedsRedraw,f=e.textureOnViewport&&!n&&(e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming),h=t.motionBlur!==void 0?t.motionBlur:e.motionBlur,m=e.motionBlurPxRatio,v=r.hasCompoundNodes(),y=e.hoverData.draggingEles,x=!!(e.hoverData.selecting||e.touchData.selecting);h=h&&!n&&e.motionBlurEnabled&&!x;var b=h;n||(e.prevPxRatio!==l&&(e.invalidateContainerClientCoordsCache(),e.matchCanvasSize(e.container),e.redrawHint("eles",!0),e.redrawHint("drag",!0)),e.prevPxRatio=l),!n&&e.motionBlurTimeout&&clearTimeout(e.motionBlurTimeout),h&&(e.mbFrames==null&&(e.mbFrames=0),e.mbFrames++,e.mbFrames<3&&(b=!1),e.mbFrames>e.minMbLowQualFrames&&(e.motionBlurPxRatio=e.mbPxRBlurry)),e.clearingMotionBlur&&(e.motionBlurPxRatio=1),e.textureDrawLastFrame&&!f&&(u[e.NODE]=!0,u[e.SELECT_BOX]=!0);var S=r.style(),w=r.zoom(),k=s!==void 0?s:w,N=r.pan(),j={x:N.x,y:N.y},T={zoom:w,pan:{x:N.x,y:N.y}},M=e.prevViewport,A=M===void 0||T.zoom!==M.zoom||T.pan.x!==M.pan.x||T.pan.y!==M.pan.y;!A&&!(y&&!v)&&(e.motionBlurPxRatio=1),o&&(j=o),k*=l,j.x*=l,j.y*=l;var _=e.getCachedZSortedEles();function D(ie,V,Y,te,Z){var ue=ie.globalCompositeOperation;ie.globalCompositeOperation="destination-out",e.colorFillStyle(ie,255,255,255,e.motionBlurTransparency),ie.fillRect(V,Y,te,Z),ie.globalCompositeOperation=ue}function R(ie,V){var Y,te,Z,ue;!e.clearingMotionBlur&&(ie===c.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]||ie===c.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG])?(Y={x:N.x*m,y:N.y*m},te=w*m,Z=e.canvasWidth*m,ue=e.canvasHeight*m):(Y=j,te=k,Z=e.canvasWidth,ue=e.canvasHeight),ie.setTransform(1,0,0,1,0,0),V==="motionBlur"?D(ie,0,0,Z,ue):!n&&(V===void 0||V)&&ie.clearRect(0,0,Z,ue),i||(ie.translate(Y.x,Y.y),ie.scale(te,te)),o&&ie.translate(o.x,o.y),s&&ie.scale(s,s)}if(f||(e.textureDrawLastFrame=!1),f){if(e.textureDrawLastFrame=!0,!e.textureCache){e.textureCache={},e.textureCache.bb=r.mutableElements().boundingBox(),e.textureCache.texture=e.data.bufferCanvases[e.TEXTURE_BUFFER];var I=e.data.bufferContexts[e.TEXTURE_BUFFER];I.setTransform(1,0,0,1,0,0),I.clearRect(0,0,e.canvasWidth*e.textureMult,e.canvasHeight*e.textureMult),e.render({forcedContext:I,drawOnlyNodeLayer:!0,forcedPxRatio:l*e.textureMult});var T=e.textureCache.viewport={zoom:r.zoom(),pan:r.pan(),width:e.canvasWidth,height:e.canvasHeight};T.mpan={x:(0-T.pan.x)/T.zoom,y:(0-T.pan.y)/T.zoom}}u[e.DRAG]=!1,u[e.NODE]=!1;var $=c.contexts[e.NODE],B=e.textureCache.texture,T=e.textureCache.viewport;$.setTransform(1,0,0,1,0,0),h?D($,0,0,T.width,T.height):$.clearRect(0,0,T.width,T.height);var z=S.core("outside-texture-bg-color").value,U=S.core("outside-texture-bg-opacity").value;e.colorFillStyle($,z[0],z[1],z[2],U),$.fillRect(0,0,T.width,T.height);var w=r.zoom();R($,!1),$.clearRect(T.mpan.x,T.mpan.y,T.width/T.zoom/l,T.height/T.zoom/l),$.drawImage(B,T.mpan.x,T.mpan.y,T.width/T.zoom/l,T.height/T.zoom/l)}else e.textureOnViewport&&!n&&(e.textureCache=null);var F=r.extent(),Q=e.pinching||e.hoverData.dragging||e.swipePanning||e.data.wheelZooming||e.hoverData.draggingEles||e.cy.animated(),K=e.hideEdgesOnViewport&&Q,L=[];if(L[e.NODE]=!u[e.NODE]&&h&&!e.clearedForMotionBlur[e.NODE]||e.clearingMotionBlur,L[e.NODE]&&(e.clearedForMotionBlur[e.NODE]=!0),L[e.DRAG]=!u[e.DRAG]&&h&&!e.clearedForMotionBlur[e.DRAG]||e.clearingMotionBlur,L[e.DRAG]&&(e.clearedForMotionBlur[e.DRAG]=!0),u[e.NODE]||i||a||L[e.NODE]){var G=h&&!L[e.NODE]&&m!==1,$=n||(G?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_NODE]:c.contexts[e.NODE]),ee=h&&!G?"motionBlur":void 0;R($,ee),K?e.drawCachedNodes($,_.nondrag,l,F):e.drawLayeredElements($,_.nondrag,l,F),e.debug&&e.drawDebugPoints($,_.nondrag),!i&&!h&&(u[e.NODE]=!1)}if(!a&&(u[e.DRAG]||i||L[e.DRAG])){var G=h&&!L[e.DRAG]&&m!==1,$=n||(G?e.data.bufferContexts[e.MOTIONBLUR_BUFFER_DRAG]:c.contexts[e.DRAG]);R($,h&&!G?"motionBlur":void 0),K?e.drawCachedNodes($,_.drag,l,F):e.drawCachedElements($,_.drag,l,F),e.debug&&e.drawDebugPoints($,_.drag),!i&&!h&&(u[e.DRAG]=!1)}if(this.drawSelectionRectangle(t,R),h&&m!==1){var re=c.contexts[e.NODE],se=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE],de=c.contexts[e.DRAG],W=e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG],ne=function(V,Y,te){V.setTransform(1,0,0,1,0,0),te||!b?V.clearRect(0,0,e.canvasWidth,e.canvasHeight):D(V,0,0,e.canvasWidth,e.canvasHeight);var Z=m;V.drawImage(Y,0,0,e.canvasWidth*Z,e.canvasHeight*Z,0,0,e.canvasWidth,e.canvasHeight)};(u[e.NODE]||L[e.NODE])&&(ne(re,se,L[e.NODE]),u[e.NODE]=!1),(u[e.DRAG]||L[e.DRAG])&&(ne(de,W,L[e.DRAG]),u[e.DRAG]=!1)}e.prevViewport=T,e.clearingMotionBlur&&(e.clearingMotionBlur=!1,e.motionBlurCleared=!0,e.motionBlur=!0),h&&(e.motionBlurTimeout=setTimeout(function(){e.motionBlurTimeout=null,e.clearedForMotionBlur[e.NODE]=!1,e.clearedForMotionBlur[e.DRAG]=!1,e.motionBlur=!1,e.clearingMotionBlur=!f,e.mbFrames=0,u[e.NODE]=!0,u[e.DRAG]=!0,e.redraw()},vK)),n||r.emit("render")};var Zf;ai.drawSelectionRectangle=function(t,e){var r=this,n=r.cy,i=r.data,a=n.style(),s=t.drawOnlyNodeLayer,o=t.drawAllLayers,l=i.canvasNeedsRedraw,c=t.forcedContext;if(r.showFps||!s&&l[r.SELECT_BOX]&&!o){var u=c||i.contexts[r.SELECT_BOX];if(e(u),r.selection[4]==1&&(r.hoverData.selecting||r.touchData.selecting)){var f=r.cy.zoom(),h=a.core("selection-box-border-width").value/f;u.lineWidth=h,u.fillStyle="rgba("+a.core("selection-box-color").value[0]+","+a.core("selection-box-color").value[1]+","+a.core("selection-box-color").value[2]+","+a.core("selection-box-opacity").value+")",u.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]),h>0&&(u.strokeStyle="rgba("+a.core("selection-box-border-color").value[0]+","+a.core("selection-box-border-color").value[1]+","+a.core("selection-box-border-color").value[2]+","+a.core("selection-box-opacity").value+")",u.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]))}if(i.bgActivePosistion&&!r.hoverData.selecting){var f=r.cy.zoom(),m=i.bgActivePosistion;u.fillStyle="rgba("+a.core("active-bg-color").value[0]+","+a.core("active-bg-color").value[1]+","+a.core("active-bg-color").value[2]+","+a.core("active-bg-opacity").value+")",u.beginPath(),u.arc(m.x,m.y,a.core("active-bg-size").pfValue/f,0,2*Math.PI),u.fill()}var v=r.lastRedrawTime;if(r.showFps&&v){v=Math.round(v);var y=Math.round(1e3/v),x="1 frame = "+v+" ms = "+y+" fps";if(u.setTransform(1,0,0,1,0,0),u.fillStyle="rgba(255, 0, 0, 0.75)",u.strokeStyle="rgba(255, 0, 0, 0.75)",u.font="30px Arial",!Zf){var b=u.measureText(x);Zf=b.actualBoundingBoxAscent}u.fillText(x,0,Zf);var S=60;u.strokeRect(0,Zf+10,250,20),u.fillRect(0,Zf+10,250*Math.min(y/S,1),20)}o||(l[r.SELECT_BOX]=!1)}};function X8(t,e,r){var n=t.createShader(e);if(t.shaderSource(n,r),t.compileShader(n),!t.getShaderParameter(n,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(n));return n}function yK(t,e,r){var n=X8(t,t.VERTEX_SHADER,e),i=X8(t,t.FRAGMENT_SHADER,r),a=t.createProgram();if(t.attachShader(a,n),t.attachShader(a,i),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new Error("Could not initialize shaders");return a}function xK(t,e,r){r===void 0&&(r=e);var n=t.makeOffscreenCanvas(e,r),i=n.context=n.getContext("2d");return n.clear=function(){return i.clearRect(0,0,n.width,n.height)},n.clear(),n}function y3(t){var e=t.pixelRatio,r=t.cy.zoom(),n=t.cy.pan();return{zoom:r*e,pan:{x:n.x*e,y:n.y*e}}}function bK(t){var e=t.pixelRatio,r=t.cy.zoom();return r*e}function wK(t,e,r,n,i){var a=n*r+e.x,s=i*r+e.y;return s=Math.round(t.canvasHeight-s),[a,s]}function SK(t){return t.pstyle("background-fill").value!=="solid"||t.pstyle("background-image").strValue!=="none"?!1:t.pstyle("border-width").value===0||t.pstyle("border-opacity").value===0?!0:t.pstyle("border-style").value==="solid"}function kK(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function ic(t,e,r){var n=t[0]/255,i=t[1]/255,a=t[2]/255,s=e,o=r||new Array(4);return o[0]=n*s,o[1]=i*s,o[2]=a*s,o[3]=s,o}function Ru(t,e){var r=e||new Array(4);return r[0]=(t>>0&255)/255,r[1]=(t>>8&255)/255,r[2]=(t>>16&255)/255,r[3]=(t>>24&255)/255,r}function CK(t){return t[0]+(t[1]<<8)+(t[2]<<16)+(t[3]<<24)}function NK(t,e){var r=t.createTexture();return r.buffer=function(n){t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n),t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null)},r.deleteTexture=function(){t.deleteTexture(r)},r}function u7(t,e){switch(e){case"float":return[1,t.FLOAT,4];case"vec2":return[2,t.FLOAT,4];case"vec3":return[3,t.FLOAT,4];case"vec4":return[4,t.FLOAT,4];case"int":return[1,t.INT,4];case"ivec2":return[2,t.INT,4]}}function d7(t,e,r){switch(e){case t.FLOAT:return new Float32Array(r);case t.INT:return new Int32Array(r)}}function EK(t,e,r,n,i,a){switch(e){case t.FLOAT:return new Float32Array(r.buffer,a*n,i);case t.INT:return new Int32Array(r.buffer,a*n,i)}}function TK(t,e,r,n){var i=u7(t,e),a=zr(i,2),s=a[0],o=a[1],l=d7(t,o,n),c=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,c),t.bufferData(t.ARRAY_BUFFER,l,t.STATIC_DRAW),o===t.FLOAT?t.vertexAttribPointer(r,s,o,!1,0,0):o===t.INT&&t.vertexAttribIPointer(r,s,o,0,0),t.enableVertexAttribArray(r),t.bindBuffer(t.ARRAY_BUFFER,null),c}function Xa(t,e,r,n){var i=u7(t,r),a=zr(i,3),s=a[0],o=a[1],l=a[2],c=d7(t,o,e*s),u=s*l,f=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,f),t.bufferData(t.ARRAY_BUFFER,e*u,t.DYNAMIC_DRAW),t.enableVertexAttribArray(n),o===t.FLOAT?t.vertexAttribPointer(n,s,o,!1,u,0):o===t.INT&&t.vertexAttribIPointer(n,s,o,u,0),t.vertexAttribDivisor(n,1),t.bindBuffer(t.ARRAY_BUFFER,null);for(var h=new Array(e),m=0;m<e;m++)h[m]=EK(t,o,c,u,s,m);return f.dataArray=c,f.stride=u,f.size=s,f.getView=function(v){return h[v]},f.setPoint=function(v,y,x){var b=h[v];b[0]=y,b[1]=x},f.bufferSubData=function(v){t.bindBuffer(t.ARRAY_BUFFER,f),v?t.bufferSubData(t.ARRAY_BUFFER,0,c,0,v*s):t.bufferSubData(t.ARRAY_BUFFER,0,c)},f}function jK(t,e,r){for(var n=9,i=new Float32Array(e*n),a=new Array(e),s=0;s<e;s++){var o=s*n*4;a[s]=new Float32Array(i.buffer,o,n)}var l=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferData(t.ARRAY_BUFFER,i.byteLength,t.DYNAMIC_DRAW);for(var c=0;c<3;c++){var u=r+c;t.enableVertexAttribArray(u),t.vertexAttribPointer(u,3,t.FLOAT,!1,3*12,c*12),t.vertexAttribDivisor(u,1)}return t.bindBuffer(t.ARRAY_BUFFER,null),l.getMatrixView=function(f){return a[f]},l.setData=function(f,h){a[h].set(f,0)},l.bufferSubData=function(){t.bindBuffer(t.ARRAY_BUFFER,l),t.bufferSubData(t.ARRAY_BUFFER,0,i)},l}function MK(t){var e=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);var r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.bindFramebuffer(t.FRAMEBUFFER,null),e.setFramebufferAttachmentSizes=function(n,i){t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n,i,0,t.RGBA,t.UNSIGNED_BYTE,null)},e}var Q8=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function I2(){var t=new Q8(9);return Q8!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function J8(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function PK(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=r[0],m=r[1],v=r[2],y=r[3],x=r[4],b=r[5],S=r[6],w=r[7],k=r[8];return t[0]=h*n+m*s+v*c,t[1]=h*i+m*o+v*u,t[2]=h*a+m*l+v*f,t[3]=y*n+x*s+b*c,t[4]=y*i+x*o+b*u,t[5]=y*a+x*l+b*f,t[6]=S*n+w*s+k*c,t[7]=S*i+w*o+k*u,t[8]=S*a+w*l+k*f,t}function Lv(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=r[0],m=r[1];return t[0]=n,t[1]=i,t[2]=a,t[3]=s,t[4]=o,t[5]=l,t[6]=h*n+m*s+c,t[7]=h*i+m*o+u,t[8]=h*a+m*l+f,t}function Z8(t,e,r){var n=e[0],i=e[1],a=e[2],s=e[3],o=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=Math.sin(r),m=Math.cos(r);return t[0]=m*n+h*s,t[1]=m*i+h*o,t[2]=m*a+h*l,t[3]=m*s-h*n,t[4]=m*o-h*i,t[5]=m*l-h*a,t[6]=c,t[7]=u,t[8]=f,t}function J5(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function _K(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}var AK=function(){function t(e,r,n,i){Ml(this,t),this.debugID=Math.floor(Math.random()*1e4),this.r=e,this.texSize=r,this.texRows=n,this.texHeight=Math.floor(r/n),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=i(e,r,r),this.scratch=i(e,r,this.texHeight,"scratch")}return Pl(t,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(r){var n=r.w,i=r.h,a=this.texHeight,s=this.texSize,o=a/i,l=n*o,c=i*o;return l>s&&(o=s/n,l=n*o,c=i*o),{scale:o,texW:l,texH:c}}},{key:"draw",value:function(r,n,i){var a=this;if(this.locked)throw new Error("can't draw, atlas is locked");var s=this.texSize,o=this.texRows,l=this.texHeight,c=this.getScale(n),u=c.scale,f=c.texW,h=c.texH,m=function(w,k){if(i&&k){var N=k.context,j=w.x,T=w.row,M=j,A=l*T;N.save(),N.translate(M,A),N.scale(u,u),i(N,n),N.restore()}},v=[null,null],y=function(){m(a.freePointer,a.canvas),v[0]={x:a.freePointer.x,y:a.freePointer.row*l,w:f,h},v[1]={x:a.freePointer.x+f,y:a.freePointer.row*l,w:0,h},a.freePointer.x+=f,a.freePointer.x==s&&(a.freePointer.x=0,a.freePointer.row++)},x=function(){var w=a.scratch,k=a.canvas;w.clear(),m({x:0,row:0},w);var N=s-a.freePointer.x,j=f-N,T=l;{var M=a.freePointer.x,A=a.freePointer.row*l,_=N;k.context.drawImage(w,0,0,_,T,M,A,_,T),v[0]={x:M,y:A,w:_,h}}{var D=N,R=(a.freePointer.row+1)*l,I=j;k&&k.context.drawImage(w,D,0,I,T,0,R,I,T),v[1]={x:0,y:R,w:I,h}}a.freePointer.x=j,a.freePointer.row++},b=function(){a.freePointer.x=0,a.freePointer.row++};if(this.freePointer.x+f<=s)y();else{if(this.freePointer.row>=o-1)return!1;this.freePointer.x===s?(b(),y()):this.enableWrapping?x():(b(),y())}return this.keyToLocation.set(r,v),this.needsBuffer=!0,v}},{key:"getOffsets",value:function(r){return this.keyToLocation.get(r)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(r){if(this.locked)return!1;var n=this.texSize,i=this.texRows,a=this.getScale(r),s=a.texW;return this.freePointer.x+s>n?this.freePointer.row<i-1:!0}},{key:"bufferIfNeeded",value:function(r){this.texture||(this.texture=NK(r,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])}(),RK=function(){function t(e,r,n,i){Ml(this,t),this.r=e,this.texSize=r,this.texRows=n,this.createTextureCanvas=i,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return Pl(t,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var r=this.r,n=this.texSize,i=this.texRows,a=this.createTextureCanvas;return new AK(r,n,i,a)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var r=this.r,n=this.texSize,i=this.texRows,a=this.createTextureCanvas,s=Math.floor(n/i);this.scratch=a(r,n,s,"scratch")}return this.scratch}},{key:"draw",value:function(r,n,i){var a=this.styleKeyToAtlas.get(r);return a||(a=this.atlases[this.atlases.length-1],(!a||!a.canFit(n))&&(a&&a.lock(),a=this._createAtlas(),this.atlases.push(a)),a.draw(r,n,i),this.styleKeyToAtlas.set(r,a)),a}},{key:"getAtlas",value:function(r){return this.styleKeyToAtlas.get(r)}},{key:"hasAtlas",value:function(r){return this.styleKeyToAtlas.has(r)}},{key:"markKeyForGC",value:function(r){this.markedKeys.add(r)}},{key:"gc",value:function(){var r=this,n=this.markedKeys;if(n.size===0){console.log("nothing to garbage collect");return}var i=[],a=new Map,s=null,o=vi(this.atlases),l;try{var c=function(){var f=l.value,h=f.getKeys(),m=DK(n,h);if(m.size===0)return i.push(f),h.forEach(function(N){return a.set(N,f)}),1;s||(s=r._createAtlas(),i.push(s));var v=vi(h),y;try{for(v.s();!(y=v.n()).done;){var x=y.value;if(!m.has(x)){var b=f.getOffsets(x),S=zr(b,2),w=S[0],k=S[1];s.canFit({w:w.w+k.w,h:w.h})||(s.lock(),s=r._createAtlas(),i.push(s)),f.canvas&&(r._copyTextureToNewAtlas(x,f,s),a.set(x,s))}}}catch(N){v.e(N)}finally{v.f()}f.dispose()};for(o.s();!(l=o.n()).done;)c()}catch(u){o.e(u)}finally{o.f()}this.atlases=i,this.styleKeyToAtlas=a,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(r,n,i){var a=n.getOffsets(r),s=zr(a,2),o=s[0],l=s[1];if(l.w===0)i.draw(r,o,function(h){h.drawImage(n.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h)});else{var c=this._getScratchCanvas();c.clear(),c.context.drawImage(n.canvas,o.x,o.y,o.w,o.h,0,0,o.w,o.h),c.context.drawImage(n.canvas,l.x,l.y,l.w,l.h,o.w,0,l.w,l.h);var u=o.w+l.w,f=o.h;i.draw(r,{w:u,h:f},function(h){h.drawImage(c,0,0,u,f,0,0,u,f)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])}();function DK(t,e){return t.intersection?t.intersection(e):new Set(w0(t).filter(function(r){return e.has(r)}))}var OK=function(){function t(e,r){Ml(this,t),this.r=e,this.globalOptions=r,this.atlasSize=r.webglTexSize,this.maxAtlasesPerBatch=r.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return Pl(t,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(r,n){var i=this.globalOptions,a=i.webglTexSize,s=i.createTextureCanvas,o=n.texRows,l=this._cacheScratchCanvas(s),c=new RK(this.r,a,o,l);this.collections.set(r,c)}},{key:"addRenderType",value:function(r,n){var i=n.collection;if(!this.collections.has(i))throw new Error("invalid atlas collection name '".concat(i,"'"));var a=this.collections.get(i),s=Qe({type:r,atlasCollection:a},n);this.renderTypes.set(r,s)}},{key:"getRenderTypeOpts",value:function(r){return this.renderTypes.get(r)}},{key:"getAtlasCollection",value:function(r){return this.collections.get(r)}},{key:"_cacheScratchCanvas",value:function(r){var n=-1,i=-1,a=null;return function(s,o,l,c){return c?((!a||o!=n||l!=i)&&(n=o,i=l,a=r(s,o,l)),a):r(s,o,l)}}},{key:"_key",value:function(r,n){return"".concat(r,"-").concat(n)}},{key:"invalidate",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.forceRedraw,s=a===void 0?!1:a,o=i.filterEle,l=o===void 0?function(){return!0}:o,c=i.filterType,u=c===void 0?function(){return!0}:c,f=!1,h=!1,m=vi(r),v;try{for(m.s();!(v=m.n()).done;){var y=v.value;if(l(y)){var x=vi(this.renderTypes.values()),b;try{var S=function(){var k=b.value,N=k.type;if(u(N)){var j=n.collections.get(k.collection),T=k.getKey(y),M=Array.isArray(T)?T:[T];if(s)M.forEach(function(R){return j.markKeyForGC(R)}),h=!0;else{var A=k.getID?k.getID(y):y.id(),_=n._key(N,A),D=n.typeAndIdToKey.get(_);D!==void 0&&!kK(M,D)&&(f=!0,n.typeAndIdToKey.delete(_),D.forEach(function(R){return j.markKeyForGC(R)}))}}};for(x.s();!(b=x.n()).done;)S()}catch(w){x.e(w)}finally{x.f()}}}}catch(w){m.e(w)}finally{m.f()}return h&&(this.gc(),f=!1),f}},{key:"gc",value:function(){var r=vi(this.collections.values()),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;i.gc()}}catch(a){r.e(a)}finally{r.f()}}},{key:"getOrCreateAtlas",value:function(r,n,i,a){var s=this.renderTypes.get(n),o=this.collections.get(s.collection),l=!1,c=o.draw(a,i,function(h){s.drawClipped?(h.save(),h.beginPath(),h.rect(0,0,i.w,i.h),h.clip(),s.drawElement(h,r,i,!0,!0),h.restore()):s.drawElement(h,r,i,!0,!0),l=!0});if(l){var u=s.getID?s.getID(r):r.id(),f=this._key(n,u);this.typeAndIdToKey.has(f)?this.typeAndIdToKey.get(f).push(a):this.typeAndIdToKey.set(f,[a])}return c}},{key:"getAtlasInfo",value:function(r,n){var i=this,a=this.renderTypes.get(n),s=a.getKey(r),o=Array.isArray(s)?s:[s];return o.map(function(l){var c=a.getBoundingBox(r,l),u=i.getOrCreateAtlas(r,n,c,l),f=u.getOffsets(l),h=zr(f,2),m=h[0],v=h[1];return{atlas:u,tex:m,tex1:m,tex2:v,bb:c}})}},{key:"getDebugInfo",value:function(){var r=[],n=vi(this.collections),i;try{for(n.s();!(i=n.n()).done;){var a=zr(i.value,2),s=a[0],o=a[1],l=o.getCounts(),c=l.keyCount,u=l.atlasCount;r.push({type:s,keyCount:c,atlasCount:u})}}catch(f){n.e(f)}finally{n.f()}return r}}])}(),IK=function(){function t(e){Ml(this,t),this.globalOptions=e,this.atlasSize=e.webglTexSize,this.maxAtlasesPerBatch=e.webglTexPerBatch,this.batchAtlases=[]}return Pl(t,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(r,n){return n})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(r){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(r):!0}},{key:"getAtlasIndexForBatch",value:function(r){var n=this.batchAtlases.indexOf(r);if(n<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(r),n=this.batchAtlases.length-1}return n}}])}(),LK=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,BK=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,FK=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,zK=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,Fh={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},R0={IGNORE:1,USE_BB:2},L2=0,ej=1,tj=2,B2=3,Du=4,Ug=5,eh=6,th=7,VK=function(){function t(e,r,n){Ml(this,t),this.r=e,this.gl=r,this.maxInstances=n.webglBatchSize,this.atlasSize=n.webglTexSize,this.bgColor=n.bgColor,this.debug=n.webglDebug,this.batchDebugInfo=[],n.enableWrapping=!0,n.createTextureCanvas=xK,this.atlasManager=new OK(e,n),this.batchManager=new IK(n),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(Fh.SCREEN),this.pickingProgram=this._createShaderProgram(Fh.PICKING),this.vao=this._createVAO()}return Pl(t,[{key:"addAtlasCollection",value:function(r,n){this.atlasManager.addAtlasCollection(r,n)}},{key:"addTextureAtlasRenderType",value:function(r,n){this.atlasManager.addRenderType(r,n)}},{key:"addSimpleShapeRenderType",value:function(r,n){this.simpleShapeOptions.set(r,n)}},{key:"invalidate",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.type,a=this.atlasManager;return i?a.invalidate(r,{filterType:function(o){return o===i},forceRedraw:!0}):a.invalidate(r)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(r){var n=this.gl,i=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(L2,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(Du," || aVertType == ").concat(th,` 
             || aVertType == `).concat(Ug," || aVertType == ").concat(eh,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(ej,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(tj,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(B2,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),a=this.batchManager.getIndexArray(),s=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(a.map(function(c){return"uniform sampler2D uTexture".concat(c,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(LK,`
      `).concat(BK,`
      `).concat(FK,`
      `).concat(zK,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(L2,`) {
          // look up the texel from the texture unit
          `).concat(a.map(function(c){return"if(vAtlasId == ".concat(c,") outColor = texture(uTexture").concat(c,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(B2,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(Du,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(Du," || vVertType == ").concat(th,` 
          || vVertType == `).concat(Ug," || vVertType == ").concat(eh,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(Du,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(th,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(th,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(r.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),o=yK(n,i,s);o.aPosition=n.getAttribLocation(o,"aPosition"),o.aIndex=n.getAttribLocation(o,"aIndex"),o.aVertType=n.getAttribLocation(o,"aVertType"),o.aTransform=n.getAttribLocation(o,"aTransform"),o.aAtlasId=n.getAttribLocation(o,"aAtlasId"),o.aTex=n.getAttribLocation(o,"aTex"),o.aPointAPointB=n.getAttribLocation(o,"aPointAPointB"),o.aPointCPointD=n.getAttribLocation(o,"aPointCPointD"),o.aLineWidth=n.getAttribLocation(o,"aLineWidth"),o.aColor=n.getAttribLocation(o,"aColor"),o.aCornerRadius=n.getAttribLocation(o,"aCornerRadius"),o.aBorderColor=n.getAttribLocation(o,"aBorderColor"),o.uPanZoomMatrix=n.getUniformLocation(o,"uPanZoomMatrix"),o.uAtlasSize=n.getUniformLocation(o,"uAtlasSize"),o.uBGColor=n.getUniformLocation(o,"uBGColor"),o.uZoom=n.getUniformLocation(o,"uZoom"),o.uTextures=[];for(var l=0;l<this.batchManager.getMaxAtlasesPerBatch();l++)o.uTextures.push(n.getUniformLocation(o,"uTexture".concat(l)));return o}},{key:"_createVAO",value:function(){var r=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=r.length/2;var n=this.maxInstances,i=this.gl,a=this.program,s=i.createVertexArray();return i.bindVertexArray(s),TK(i,"vec2",a.aPosition,r),this.transformBuffer=jK(i,n,a.aTransform),this.indexBuffer=Xa(i,n,"vec4",a.aIndex),this.vertTypeBuffer=Xa(i,n,"int",a.aVertType),this.atlasIdBuffer=Xa(i,n,"int",a.aAtlasId),this.texBuffer=Xa(i,n,"vec4",a.aTex),this.pointAPointBBuffer=Xa(i,n,"vec4",a.aPointAPointB),this.pointCPointDBuffer=Xa(i,n,"vec4",a.aPointCPointD),this.lineWidthBuffer=Xa(i,n,"vec2",a.aLineWidth),this.colorBuffer=Xa(i,n,"vec4",a.aColor),this.cornerRadiusBuffer=Xa(i,n,"vec4",a.aCornerRadius),this.borderColorBuffer=Xa(i,n,"vec4",a.aBorderColor),i.bindVertexArray(null),s}},{key:"buffers",get:function(){var r=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(n){return Wo(n,"Buffer")}).map(function(n){return r[n]})),this._buffers}},{key:"startFrame",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fh.SCREEN;this.panZoomMatrix=r,this.renderTarget=n,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(r,n){return r.visible()?n&&n.isVisible?n.isVisible(r):!0:!1}},{key:"drawTexture",value:function(r,n,i){var a=this.atlasManager,s=this.batchManager,o=a.getRenderTypeOpts(i);if(this._isVisible(r,o)&&!(r.isEdge()&&!this._isValidEdge(r))){if(this.renderTarget.picking&&o.getTexPickingMode){var l=o.getTexPickingMode(r);if(l===R0.IGNORE)return;if(l==R0.USE_BB){this.drawPickingRectangle(r,n,i);return}}var c=a.getAtlasInfo(r,i),u=vi(c),f;try{for(u.s();!(f=u.n()).done;){var h=f.value,m=h.atlas,v=h.tex1,y=h.tex2;s.canAddToCurrentBatch(m)||this.endBatch();for(var x=s.getAtlasIndexForBatch(m),b=0,S=[[v,!0],[y,!1]];b<S.length;b++){var w=zr(S[b],2),k=w[0],N=w[1];if(k.w!=0){var j=this.instanceCount;this.vertTypeBuffer.getView(j)[0]=L2;var T=this.indexBuffer.getView(j);Ru(n,T);var M=this.atlasIdBuffer.getView(j);M[0]=x;var A=this.texBuffer.getView(j);A[0]=k.x,A[1]=k.y,A[2]=k.w,A[3]=k.h;var _=this.transformBuffer.getMatrixView(j);this.setTransformMatrix(r,_,o,h,N),this.instanceCount++,N||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(D){u.e(D)}finally{u.f()}}}},{key:"setTransformMatrix",value:function(r,n,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=0;if(i.shapeProps&&i.shapeProps.padding&&(o=r.pstyle(i.shapeProps.padding).pfValue),a){var l=a.bb,c=a.tex1,u=a.tex2,f=c.w/(c.w+u.w);s||(f=1-f);var h=this._getAdjustedBB(l,o,s,f);this._applyTransformMatrix(n,h,i,r)}else{var m=i.getBoundingBox(r),v=this._getAdjustedBB(m,o,!0,1);this._applyTransformMatrix(n,v,i,r)}}},{key:"_applyTransformMatrix",value:function(r,n,i,a){var s,o;J8(r);var l=i.getRotation?i.getRotation(a):0;if(l!==0){var c=i.getRotationPoint(a),u=c.x,f=c.y;Lv(r,r,[u,f]),Z8(r,r,l);var h=i.getRotationOffset(a);s=h.x+(n.xOffset||0),o=h.y+(n.yOffset||0)}else s=n.x1,o=n.y1;Lv(r,r,[s,o]),J5(r,r,[n.w,n.h])}},{key:"_getAdjustedBB",value:function(r,n,i,a){var s=r.x1,o=r.y1,l=r.w,c=r.h,u=r.yOffset;n&&(s-=n,o-=n,l+=2*n,c+=2*n);var f=0,h=l*a;return i&&a<1?l=h:!i&&a<1&&(f=l-h,s+=f,l=h),{x1:s,y1:o,w:l,h:c,xOffset:f,yOffset:u}}},{key:"drawPickingRectangle",value:function(r,n,i){var a=this.atlasManager.getRenderTypeOpts(i),s=this.instanceCount;this.vertTypeBuffer.getView(s)[0]=Du;var o=this.indexBuffer.getView(s);Ru(n,o);var l=this.colorBuffer.getView(s);ic([0,0,0],1,l);var c=this.transformBuffer.getMatrixView(s);this.setTransformMatrix(r,c,a),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(r,n,i){var a=this.simpleShapeOptions.get(i);if(this._isVisible(r,a)){var s=a.shapeProps,o=this._getVertTypeForShape(r,s.shape);if(o===void 0||a.isSimple&&!a.isSimple(r)){this.drawTexture(r,n,i);return}var l=this.instanceCount;if(this.vertTypeBuffer.getView(l)[0]=o,o===Ug||o===eh){var c=a.getBoundingBox(r),u=this._getCornerRadius(r,s.radius,c),f=this.cornerRadiusBuffer.getView(l);f[0]=u,f[1]=u,f[2]=u,f[3]=u,o===eh&&(f[0]=0,f[2]=0)}var h=this.indexBuffer.getView(l);Ru(n,h);var m=r.pstyle(s.color).value,v=r.pstyle(s.opacity).value,y=this.colorBuffer.getView(l);ic(m,v,y);var x=this.lineWidthBuffer.getView(l);if(x[0]=0,x[1]=0,s.border){var b=r.pstyle("border-width").value;if(b>0){var S=r.pstyle("border-color").value,w=r.pstyle("border-opacity").value,k=this.borderColorBuffer.getView(l);ic(S,w,k);var N=r.pstyle("border-position").value;if(N==="inside")x[0]=0,x[1]=-b;else if(N==="outside")x[0]=b,x[1]=0;else{var j=b/2;x[0]=j,x[1]=-j}}}var T=this.transformBuffer.getMatrixView(l);this.setTransformMatrix(r,T,a),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(r,n){var i=r.pstyle(n).value;switch(i){case"rectangle":return Du;case"ellipse":return th;case"roundrectangle":case"round-rectangle":return Ug;case"bottom-round-rectangle":return eh;default:return}}},{key:"_getCornerRadius",value:function(r,n,i){var a=i.w,s=i.h;if(r.pstyle(n).value==="auto")return vl(a,s);var o=r.pstyle(n).pfValue,l=a/2,c=s/2;return Math.min(o,c,l)}},{key:"drawEdgeArrow",value:function(r,n,i){if(r.visible()){var a=r._private.rscratch,s,o,l;if(i==="source"?(s=a.arrowStartX,o=a.arrowStartY,l=a.srcArrowAngle):(s=a.arrowEndX,o=a.arrowEndY,l=a.tgtArrowAngle),!(isNaN(s)||s==null||isNaN(o)||o==null||isNaN(l)||l==null)){var c=r.pstyle(i+"-arrow-shape").value;if(c!=="none"){var u=r.pstyle(i+"-arrow-color").value,f=r.pstyle("opacity").value,h=r.pstyle("line-opacity").value,m=f*h,v=r.pstyle("width").pfValue,y=r.pstyle("arrow-scale").value,x=this.r.getArrowWidth(v,y),b=this.instanceCount,S=this.transformBuffer.getMatrixView(b);J8(S),Lv(S,S,[s,o]),J5(S,S,[x,x]),Z8(S,S,l),this.vertTypeBuffer.getView(b)[0]=B2;var w=this.indexBuffer.getView(b);Ru(n,w);var k=this.colorBuffer.getView(b);ic(u,m,k),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(r,n){if(r.visible()){var i=this._getEdgePoints(r);if(i){var a=r.pstyle("opacity").value,s=r.pstyle("line-opacity").value,o=r.pstyle("width").pfValue,l=r.pstyle("line-color").value,c=a*s;if(i.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),i.length==4){var u=this.instanceCount;this.vertTypeBuffer.getView(u)[0]=ej;var f=this.indexBuffer.getView(u);Ru(n,f);var h=this.colorBuffer.getView(u);ic(l,c,h);var m=this.lineWidthBuffer.getView(u);m[0]=o;var v=this.pointAPointBBuffer.getView(u);v[0]=i[0],v[1]=i[1],v[2]=i[2],v[3]=i[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var y=0;y<i.length-2;y+=2){var x=this.instanceCount;this.vertTypeBuffer.getView(x)[0]=tj;var b=this.indexBuffer.getView(x);Ru(n,b);var S=this.colorBuffer.getView(x);ic(l,c,S);var w=this.lineWidthBuffer.getView(x);w[0]=o;var k=i[y-2],N=i[y-1],j=i[y],T=i[y+1],M=i[y+2],A=i[y+3],_=i[y+4],D=i[y+5];y==0&&(k=2*j-M+.001,N=2*T-A+.001),y==i.length-4&&(_=2*M-j+.001,D=2*A-T+.001);var R=this.pointAPointBBuffer.getView(x);R[0]=k,R[1]=N,R[2]=j,R[3]=T;var I=this.pointCPointDBuffer.getView(x);I[0]=M,I[1]=A,I[2]=_,I[3]=D,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_isValidEdge",value:function(r){var n=r._private.rscratch;return!(n.badLine||n.allpts==null||isNaN(n.allpts[0]))}},{key:"_getEdgePoints",value:function(r){var n=r._private.rscratch;if(this._isValidEdge(r)){var i=n.allpts;if(i.length==4)return i;var a=this._getNumSegments(r);return this._getCurveSegmentPoints(i,a)}}},{key:"_getNumSegments",value:function(r){var n=15;return Math.min(Math.max(n,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(r,n){if(r.length==4)return r;for(var i=Array((n+1)*2),a=0;a<=n;a++)if(a==0)i[0]=r[0],i[1]=r[1];else if(a==n)i[a*2]=r[r.length-2],i[a*2+1]=r[r.length-1];else{var s=a/n;this._setCurvePoint(r,s,i,a*2)}return i}},{key:"_setCurvePoint",value:function(r,n,i,a){if(r.length<=2)i[a]=r[0],i[a+1]=r[1];else{for(var s=Array(r.length-2),o=0;o<s.length;o+=2){var l=(1-n)*r[o]+n*r[o+2],c=(1-n)*r[o+1]+n*r[o+3];s[o]=l,s[o+1]=c}return this._setCurvePoint(s,n,i,a)}}},{key:"endBatch",value:function(){var r=this.gl,n=this.vao,i=this.vertexCount,a=this.instanceCount;if(a!==0){var s=this.renderTarget.picking?this.pickingProgram:this.program;r.useProgram(s),r.bindVertexArray(n);var o=vi(this.buffers),l;try{for(o.s();!(l=o.n()).done;){var c=l.value;c.bufferSubData(a)}}catch(v){o.e(v)}finally{o.f()}for(var u=this.batchManager.getAtlases(),f=0;f<u.length;f++)u[f].bufferIfNeeded(r);for(var h=0;h<u.length;h++)r.activeTexture(r.TEXTURE0+h),r.bindTexture(r.TEXTURE_2D,u[h].texture),r.uniform1i(s.uTextures[h],h);r.uniform1f(s.uZoom,bK(this.r)),r.uniformMatrix3fv(s.uPanZoomMatrix,!1,this.panZoomMatrix),r.uniform1i(s.uAtlasSize,this.batchManager.getAtlasSize());var m=ic(this.bgColor,1);r.uniform4fv(s.uBGColor,m),r.drawArraysInstanced(r.TRIANGLES,0,i,a),r.bindVertexArray(null),r.bindTexture(r.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:a,atlasCount:u.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var r=this.atlasManager.getDebugInfo(),n=r.reduce(function(s,o){return s+o.atlasCount},0),i=this.batchDebugInfo,a=i.reduce(function(s,o){return s+o.count},0);return{atlasInfo:r,totalAtlases:n,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:i.length,batchInfo:i,totalInstances:a}}}])}(),f7={};f7.initWebgl=function(t,e){var r=this,n=r.data.contexts[r.WEBGL];t.bgColor=$K(r),t.webglTexSize=Math.min(t.webglTexSize,n.getParameter(n.MAX_TEXTURE_SIZE)),t.webglTexRows=Math.min(t.webglTexRows,54),t.webglTexRowsNodes=Math.min(t.webglTexRowsNodes,54),t.webglBatchSize=Math.min(t.webglBatchSize,16384),t.webglTexPerBatch=Math.min(t.webglTexPerBatch,n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS)),r.webglDebug=t.webglDebug,r.webglDebugShowAtlases=t.webglDebugShowAtlases,r.pickingFrameBuffer=MK(n),r.pickingFrameBuffer.needsDraw=!0,r.drawing=new VK(r,n,t);var i=function(f){return function(h){return r.getTextAngle(h,f)}},a=function(f){return function(h){var m=h.pstyle(f);return m&&m.value}},s=function(f){return function(h){return h.pstyle("".concat(f,"-opacity")).value>0}},o=function(f){var h=f.pstyle("text-events").strValue==="yes";return h?R0.USE_BB:R0.IGNORE},l=function(f){var h=f.position(),m=h.x,v=h.y,y=f.outerWidth(),x=f.outerHeight();return{w:y,h:x,x1:m-y/2,y1:v-x/2}};r.drawing.addAtlasCollection("node",{texRows:t.webglTexRowsNodes}),r.drawing.addAtlasCollection("label",{texRows:t.webglTexRows}),r.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:e.getStyleKey,getBoundingBox:e.getElementBox,drawElement:e.drawElement}),r.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:l,isSimple:SK,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),r.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:l,isVisible:s("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),r.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:l,isVisible:s("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),r.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:o,getKey:F2(e.getLabelKey,null),getBoundingBox:z2(e.getLabelBox,null),drawClipped:!0,drawElement:e.drawLabel,getRotation:i(null),getRotationPoint:e.getLabelRotationPoint,getRotationOffset:e.getLabelRotationOffset,isVisible:a("label")}),r.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:o,getKey:F2(e.getSourceLabelKey,"source"),getBoundingBox:z2(e.getSourceLabelBox,"source"),drawClipped:!0,drawElement:e.drawSourceLabel,getRotation:i("source"),getRotationPoint:e.getSourceLabelRotationPoint,getRotationOffset:e.getSourceLabelRotationOffset,isVisible:a("source-label")}),r.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:o,getKey:F2(e.getTargetLabelKey,"target"),getBoundingBox:z2(e.getTargetLabelBox,"target"),drawClipped:!0,drawElement:e.drawTargetLabel,getRotation:i("target"),getRotationPoint:e.getTargetLabelRotationPoint,getRotationOffset:e.getTargetLabelRotationOffset,isVisible:a("target-label")});var c=nm(function(){console.log("garbage collect flag set"),r.data.gc=!0},1e4);r.onUpdateEleCalcs(function(u,f){var h=!1;f&&f.length>0&&(h|=r.drawing.invalidate(f)),h&&c()}),UK(r)};function $K(t){var e=t.cy.container(),r=e&&e.style&&e.style.backgroundColor||"white";return zA(r)}function h7(t,e){var r=t._private.rscratch;return hi(r,"labelWrapCachedLines",e)||[]}var F2=function(e,r){return function(n){var i=e(n),a=h7(n,r);return a.length>1?a.map(function(s,o){return"".concat(i,"_").concat(o)}):i}},z2=function(e,r){return function(n,i){var a=e(n);if(typeof i=="string"){var s=i.indexOf("_");if(s>0){var o=Number(i.substring(s+1)),l=h7(n,r),c=a.h/l.length,u=c*o,f=a.y1+u;return{x1:a.x1,w:a.w,y1:f,h:c,yOffset:u}}}return a}};function UK(t){{var e=t.render;t.render=function(a){a=a||{};var s=t.cy;t.webgl&&(s.zoom()>a7?(GK(t),e.call(t,a)):(HK(t),m7(t,a,Fh.SCREEN)))}}{var r=t.matchCanvasSize;t.matchCanvasSize=function(a){r.call(t,a),t.pickingFrameBuffer.setFramebufferAttachmentSizes(t.canvasWidth,t.canvasHeight),t.pickingFrameBuffer.needsDraw=!0}}t.findNearestElements=function(a,s,o,l){return QK(t,a,s)};{var n=t.invalidateCachedZSortedEles;t.invalidateCachedZSortedEles=function(){n.call(t),t.pickingFrameBuffer.needsDraw=!0}}{var i=t.notify;t.notify=function(a,s){i.call(t,a,s),a==="viewport"||a==="bounds"?t.pickingFrameBuffer.needsDraw=!0:a==="background"&&t.drawing.invalidate(s,{type:"node-body"})}}}function GK(t){var e=t.data.contexts[t.WEBGL];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function HK(t){var e=function(n){n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.canvasWidth,t.canvasHeight),n.restore()};e(t.data.contexts[t.NODE]),e(t.data.contexts[t.DRAG])}function WK(t){var e=t.canvasWidth,r=t.canvasHeight,n=y3(t),i=n.pan,a=n.zoom,s=I2();Lv(s,s,[i.x,i.y]),J5(s,s,[a,a]);var o=I2();_K(o,e,r);var l=I2();return PK(l,o,s),l}function p7(t,e){var r=t.canvasWidth,n=t.canvasHeight,i=y3(t),a=i.pan,s=i.zoom;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,r,n),e.translate(a.x,a.y),e.scale(s,s)}function qK(t,e){t.drawSelectionRectangle(e,function(r){return p7(t,r)})}function KK(t){var e=t.data.contexts[t.NODE];e.save(),p7(t,e),e.strokeStyle="rgba(0, 0, 0, 0.3)",e.beginPath(),e.moveTo(-1e3,0),e.lineTo(1e3,0),e.stroke(),e.beginPath(),e.moveTo(0,-1e3),e.lineTo(0,1e3),e.stroke(),e.restore()}function YK(t){var e=function(i,a,s){for(var o=i.atlasManager.getAtlasCollection(a),l=t.data.contexts[t.NODE],c=o.atlases,u=0;u<c.length;u++){var f=c[u],h=f.canvas;if(h){var m=h.width,v=h.height,y=m*u,x=h.height*s,b=.4;l.save(),l.scale(b,b),l.drawImage(h,y,x),l.strokeStyle="black",l.rect(y,x,m,v),l.stroke(),l.restore()}}},r=0;e(t.drawing,"node",r++),e(t.drawing,"label",r++)}function XK(t,e,r,n,i){var a,s,o,l,c=y3(t),u=c.pan,f=c.zoom;{var h=wK(t,u,f,e,r),m=zr(h,2),v=m[0],y=m[1],x=6;a=v-x/2,s=y-x/2,o=x,l=x}if(o===0||l===0)return[];var b=t.data.contexts[t.WEBGL];b.bindFramebuffer(b.FRAMEBUFFER,t.pickingFrameBuffer),t.pickingFrameBuffer.needsDraw&&(b.viewport(0,0,b.canvas.width,b.canvas.height),m7(t,null,Fh.PICKING),t.pickingFrameBuffer.needsDraw=!1);var S=o*l,w=new Uint8Array(S*4);b.readPixels(a,s,o,l,b.RGBA,b.UNSIGNED_BYTE,w),b.bindFramebuffer(b.FRAMEBUFFER,null);for(var k=new Set,N=0;N<S;N++){var j=w.slice(N*4,N*4+4),T=CK(j)-1;T>=0&&k.add(T)}return k}function QK(t,e,r){var n=XK(t,e,r),i=t.getCachedZSortedEles(),a,s,o=vi(n),l;try{for(o.s();!(l=o.n()).done;){var c=l.value,u=i[c];if(!a&&u.isNode()&&(a=u),!s&&u.isEdge()&&(s=u),a&&s)break}}catch(f){o.e(f)}finally{o.f()}return[a,s].filter(Boolean)}function V2(t,e,r){var n=t.drawing;e+=1,r.isNode()?(n.drawNode(r,e,"node-underlay"),n.drawNode(r,e,"node-body"),n.drawTexture(r,e,"label"),n.drawNode(r,e,"node-overlay")):(n.drawEdgeLine(r,e),n.drawEdgeArrow(r,e,"source"),n.drawEdgeArrow(r,e,"target"),n.drawTexture(r,e,"label"),n.drawTexture(r,e,"edge-source-label"),n.drawTexture(r,e,"edge-target-label"))}function m7(t,e,r){var n;t.webglDebug&&(n=performance.now());var i=t.drawing,a=0;if(r.screen&&t.data.canvasNeedsRedraw[t.SELECT_BOX]&&qK(t,e),t.data.canvasNeedsRedraw[t.NODE]||r.picking){var s=t.data.contexts[t.WEBGL];r.screen?(s.clearColor(0,0,0,0),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA)):s.disable(s.BLEND),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.viewport(0,0,s.canvas.width,s.canvas.height);var o=WK(t),l=t.getCachedZSortedEles();if(a=l.length,i.startFrame(o,r),r.screen){for(var c=0;c<l.nondrag.length;c++)V2(t,c,l.nondrag[c]);for(var u=0;u<l.drag.length;u++)V2(t,u,l.drag[u])}else if(r.picking)for(var f=0;f<l.length;f++)V2(t,f,l[f]);i.endFrame(),r.screen&&t.webglDebugShowAtlases&&(KK(t),YK(t)),t.data.canvasNeedsRedraw[t.NODE]=!1,t.data.canvasNeedsRedraw[t.DRAG]=!1}if(t.webglDebug){var h=performance.now(),m=!1,v=Math.ceil(h-n),y=i.getDebugInfo(),x=["".concat(a," elements"),"".concat(y.totalInstances," instances"),"".concat(y.batchCount," batches"),"".concat(y.totalAtlases," atlases"),"".concat(y.wrappedCount," wrapped textures"),"".concat(y.simpleCount," simple shapes")].join(", ");if(m)console.log("WebGL (".concat(r.name,") - time ").concat(v,"ms, ").concat(x));else{console.log("WebGL (".concat(r.name,") - frame time ").concat(v,"ms")),console.log("Totals:"),console.log("  ".concat(x)),console.log("Texture Atlases Used:");var b=y.atlasInfo,S=vi(b),w;try{for(S.s();!(w=S.n()).done;){var k=w.value;console.log("  ".concat(k.type,": ").concat(k.keyCount," keys, ").concat(k.atlasCount," atlases"))}}catch(N){S.e(N)}finally{S.f()}console.log("")}}t.data.gc&&(console.log("Garbage Collect!"),t.data.gc=!1,i.gc())}var Rl={};Rl.drawPolygonPath=function(t,e,r,n,i,a){var s=n/2,o=i/2;t.beginPath&&t.beginPath(),t.moveTo(e+s*a[0],r+o*a[1]);for(var l=1;l<a.length/2;l++)t.lineTo(e+s*a[l*2],r+o*a[l*2+1]);t.closePath()};Rl.drawRoundPolygonPath=function(t,e,r,n,i,a,s){s.forEach(function(o){return XR(t,o)}),t.closePath()};Rl.drawRoundRectanglePath=function(t,e,r,n,i,a){var s=n/2,o=i/2,l=a==="auto"?vl(n,i):Math.min(a,o,s);t.beginPath&&t.beginPath(),t.moveTo(e,r-o),t.arcTo(e+s,r-o,e+s,r,l),t.arcTo(e+s,r+o,e,r+o,l),t.arcTo(e-s,r+o,e-s,r,l),t.arcTo(e-s,r-o,e,r-o,l),t.lineTo(e,r-o),t.closePath()};Rl.drawBottomRoundRectanglePath=function(t,e,r,n,i,a){var s=n/2,o=i/2,l=a==="auto"?vl(n,i):a;t.beginPath&&t.beginPath(),t.moveTo(e,r-o),t.lineTo(e+s,r-o),t.lineTo(e+s,r),t.arcTo(e+s,r+o,e,r+o,l),t.arcTo(e-s,r+o,e-s,r,l),t.lineTo(e-s,r-o),t.lineTo(e,r-o),t.closePath()};Rl.drawCutRectanglePath=function(t,e,r,n,i,a,s){var o=n/2,l=i/2,c=s==="auto"?i3():s;t.beginPath&&t.beginPath(),t.moveTo(e-o+c,r-l),t.lineTo(e+o-c,r-l),t.lineTo(e+o,r-l+c),t.lineTo(e+o,r+l-c),t.lineTo(e+o-c,r+l),t.lineTo(e-o+c,r+l),t.lineTo(e-o,r+l-c),t.lineTo(e-o,r-l+c),t.closePath()};Rl.drawBarrelPath=function(t,e,r,n,i){var a=n/2,s=i/2,o=e-a,l=e+a,c=r-s,u=r+s,f=B5(n,i),h=f.widthOffset,m=f.heightOffset,v=f.ctrlPtOffsetPct*h;t.beginPath&&t.beginPath(),t.moveTo(o,c+m),t.lineTo(o,u-m),t.quadraticCurveTo(o+v,u,o+h,u),t.lineTo(l-h,u),t.quadraticCurveTo(l-v,u,l,u-m),t.lineTo(l,c+m),t.quadraticCurveTo(l-v,c,l-h,c),t.lineTo(o+h,c),t.quadraticCurveTo(o+v,c,o,c+m),t.closePath()};var rj=Math.sin(0),nj=Math.cos(0),Z5={},ek={},g7=Math.PI/40;for(var Ou=0*Math.PI;Ou<2*Math.PI;Ou+=g7)Z5[Ou]=Math.sin(Ou),ek[Ou]=Math.cos(Ou);Rl.drawEllipsePath=function(t,e,r,n,i){if(t.beginPath&&t.beginPath(),t.ellipse)t.ellipse(e,r,n/2,i/2,0,0,2*Math.PI);else for(var a,s,o=n/2,l=i/2,c=0*Math.PI;c<2*Math.PI;c+=g7)a=e-o*Z5[c]*rj+o*ek[c]*nj,s=r+l*ek[c]*rj+l*Z5[c]*nj,c===0?t.moveTo(a,s):t.lineTo(a,s);t.closePath()};var cm={};cm.createBuffer=function(t,e){var r=document.createElement("canvas");return r.width=t,r.height=e,[r,r.getContext("2d")]};cm.bufferCanvasImage=function(t){var e=this.cy,r=e.mutableElements(),n=r.boundingBox(),i=this.findContainerClientCoords(),a=t.full?Math.ceil(n.w):i[2],s=t.full?Math.ceil(n.h):i[3],o=Ee(t.maxWidth)||Ee(t.maxHeight),l=this.getPixelRatio(),c=1;if(t.scale!==void 0)a*=t.scale,s*=t.scale,c=t.scale;else if(o){var u=1/0,f=1/0;Ee(t.maxWidth)&&(u=c*t.maxWidth/a),Ee(t.maxHeight)&&(f=c*t.maxHeight/s),c=Math.min(u,f),a*=c,s*=c}o||(a*=l,s*=l,c*=l);var h=document.createElement("canvas");h.width=a,h.height=s,h.style.width=a+"px",h.style.height=s+"px";var m=h.getContext("2d");if(a>0&&s>0){m.clearRect(0,0,a,s),m.globalCompositeOperation="source-over";var v=this.getCachedZSortedEles();if(t.full)m.translate(-n.x1*c,-n.y1*c),m.scale(c,c),this.drawElements(m,v),m.scale(1/c,1/c),m.translate(n.x1*c,n.y1*c);else{var y=e.pan(),x={x:y.x*c,y:y.y*c};c*=e.zoom(),m.translate(x.x,x.y),m.scale(c,c),this.drawElements(m,v),m.scale(1/c,1/c),m.translate(-x.x,-x.y)}t.bg&&(m.globalCompositeOperation="destination-over",m.fillStyle=t.bg,m.rect(0,0,a,s),m.fill())}return h};function JK(t,e){for(var r=atob(t),n=new ArrayBuffer(r.length),i=new Uint8Array(n),a=0;a<r.length;a++)i[a]=r.charCodeAt(a);return new Blob([n],{type:e})}function ij(t){var e=t.indexOf(",");return t.substr(e+1)}function v7(t,e,r){var n=function(){return e.toDataURL(r,t.quality)};switch(t.output){case"blob-promise":return new nf(function(i,a){try{e.toBlob(function(s){s!=null?i(s):a(new Error("`canvas.toBlob()` sent a null value in its callback"))},r,t.quality)}catch(s){a(s)}});case"blob":return JK(ij(n()),r);case"base64":return ij(n());case"base64uri":default:return n()}}cm.png=function(t){return v7(t,this.bufferCanvasImage(t),"image/png")};cm.jpg=function(t){return v7(t,this.bufferCanvasImage(t),"image/jpeg")};var y7={};y7.nodeShapeImpl=function(t,e,r,n,i,a,s,o){switch(t){case"ellipse":return this.drawEllipsePath(e,r,n,i,a);case"polygon":return this.drawPolygonPath(e,r,n,i,a,s);case"round-polygon":return this.drawRoundPolygonPath(e,r,n,i,a,s,o);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,r,n,i,a,o);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,r,n,i,a,s,o);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,r,n,i,a,o);case"barrel":return this.drawBarrelPath(e,r,n,i,a)}};var ZK=x7,mt=x7.prototype;mt.CANVAS_LAYERS=3;mt.SELECT_BOX=0;mt.DRAG=1;mt.NODE=2;mt.WEBGL=3;mt.CANVAS_TYPES=["2d","2d","2d","webgl2"];mt.BUFFER_COUNT=3;mt.TEXTURE_BUFFER=0;mt.MOTIONBLUR_BUFFER_NODE=1;mt.MOTIONBLUR_BUFFER_DRAG=2;function x7(t){var e=this,r=e.cy.window(),n=r.document;t.webgl&&(mt.CANVAS_LAYERS=e.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),e.data={canvases:new Array(mt.CANVAS_LAYERS),contexts:new Array(mt.CANVAS_LAYERS),canvasNeedsRedraw:new Array(mt.CANVAS_LAYERS),bufferCanvases:new Array(mt.BUFFER_COUNT),bufferContexts:new Array(mt.CANVAS_LAYERS)};var i="-webkit-tap-highlight-color",a="rgba(0,0,0,0)";e.data.canvasContainer=n.createElement("div");var s=e.data.canvasContainer.style;e.data.canvasContainer.style[i]=a,s.position="relative",s.zIndex="0",s.overflow="hidden";var o=t.cy.container();o.appendChild(e.data.canvasContainer),o.style[i]=a;var l={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};q$()&&(l["-ms-touch-action"]="none",l["touch-action"]="none");for(var c=0;c<mt.CANVAS_LAYERS;c++){var u=e.data.canvases[c]=n.createElement("canvas"),f=mt.CANVAS_TYPES[c];e.data.contexts[c]=u.getContext(f),e.data.contexts[c]||lr("Could not create canvas of type "+f),Object.keys(l).forEach(function(ie){u.style[ie]=l[ie]}),u.style.position="absolute",u.setAttribute("data-id","layer"+c),u.style.zIndex=String(mt.CANVAS_LAYERS-c),e.data.canvasContainer.appendChild(u),e.data.canvasNeedsRedraw[c]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[mt.NODE].setAttribute("data-id","layer"+mt.NODE+"-node"),e.data.canvases[mt.SELECT_BOX].setAttribute("data-id","layer"+mt.SELECT_BOX+"-selectbox"),e.data.canvases[mt.DRAG].setAttribute("data-id","layer"+mt.DRAG+"-drag"),e.data.canvases[mt.WEBGL]&&e.data.canvases[mt.WEBGL].setAttribute("data-id","layer"+mt.WEBGL+"-webgl");for(var c=0;c<mt.BUFFER_COUNT;c++)e.data.bufferCanvases[c]=n.createElement("canvas"),e.data.bufferContexts[c]=e.data.bufferCanvases[c].getContext("2d"),e.data.bufferCanvases[c].style.position="absolute",e.data.bufferCanvases[c].setAttribute("data-id","buffer"+c),e.data.bufferCanvases[c].style.zIndex=String(-c-1),e.data.bufferCanvases[c].style.visibility="hidden";e.pathsEnabled=!0;var h=ei(),m=function(V){return{x:(V.x1+V.x2)/2,y:(V.y1+V.y2)/2}},v=function(V){return{x:-V.w/2,y:-V.h/2}},y=function(V){var Y=V[0]._private,te=Y.oldBackgroundTimestamp===Y.backgroundTimestamp;return!te},x=function(V){return V[0]._private.nodeKey},b=function(V){return V[0]._private.labelStyleKey},S=function(V){return V[0]._private.sourceLabelStyleKey},w=function(V){return V[0]._private.targetLabelStyleKey},k=function(V,Y,te,Z,ue){return e.drawElement(V,Y,te,!1,!1,ue)},N=function(V,Y,te,Z,ue){return e.drawElementText(V,Y,te,Z,"main",ue)},j=function(V,Y,te,Z,ue){return e.drawElementText(V,Y,te,Z,"source",ue)},T=function(V,Y,te,Z,ue){return e.drawElementText(V,Y,te,Z,"target",ue)},M=function(V){return V.boundingBox(),V[0]._private.bodyBounds},A=function(V){return V.boundingBox(),V[0]._private.labelBounds.main||h},_=function(V){return V.boundingBox(),V[0]._private.labelBounds.source||h},D=function(V){return V.boundingBox(),V[0]._private.labelBounds.target||h},R=function(V,Y){return Y},I=function(V){return m(M(V))},$=function(V,Y,te){var Z=V?V+"-":"";return{x:Y.x+te.pstyle(Z+"text-margin-x").pfValue,y:Y.y+te.pstyle(Z+"text-margin-y").pfValue}},B=function(V,Y,te){var Z=V[0]._private.rscratch;return{x:Z[Y],y:Z[te]}},z=function(V){return $("",B(V,"labelX","labelY"),V)},U=function(V){return $("source",B(V,"sourceLabelX","sourceLabelY"),V)},F=function(V){return $("target",B(V,"targetLabelX","targetLabelY"),V)},Q=function(V){return v(M(V))},K=function(V){return v(_(V))},L=function(V){return v(D(V))},G=function(V){var Y=A(V),te=v(A(V));if(V.isNode()){switch(V.pstyle("text-halign").value){case"left":te.x=-Y.w-(Y.leftPad||0);break;case"right":te.x=-(Y.rightPad||0);break}switch(V.pstyle("text-valign").value){case"top":te.y=-Y.h-(Y.topPad||0);break;case"bottom":te.y=-(Y.botPad||0);break}}return te},ee=e.data.eleTxrCache=new wh(e,{getKey:x,doesEleInvalidateKey:y,drawElement:k,getBoundingBox:M,getRotationPoint:I,getRotationOffset:Q,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),re=e.data.lblTxrCache=new wh(e,{getKey:b,drawElement:N,getBoundingBox:A,getRotationPoint:z,getRotationOffset:G,isVisible:R}),se=e.data.slbTxrCache=new wh(e,{getKey:S,drawElement:j,getBoundingBox:_,getRotationPoint:U,getRotationOffset:K,isVisible:R}),de=e.data.tlbTxrCache=new wh(e,{getKey:w,drawElement:T,getBoundingBox:D,getRotationPoint:F,getRotationOffset:L,isVisible:R}),W=e.data.lyrTxrCache=new s7(e);e.onUpdateEleCalcs(function(V,Y){ee.invalidateElements(Y),re.invalidateElements(Y),se.invalidateElements(Y),de.invalidateElements(Y),W.invalidateElements(Y);for(var te=0;te<Y.length;te++){var Z=Y[te]._private;Z.oldBackgroundTimestamp=Z.backgroundTimestamp}});var ne=function(V){for(var Y=0;Y<V.length;Y++)W.enqueueElementRefinement(V[Y].ele)};ee.onDequeue(ne),re.onDequeue(ne),se.onDequeue(ne),de.onDequeue(ne),t.webgl&&e.initWebgl(t,{getStyleKey:x,getLabelKey:b,getSourceLabelKey:S,getTargetLabelKey:w,drawElement:k,drawLabel:N,drawSourceLabel:j,drawTargetLabel:T,getElementBox:M,getLabelBox:A,getSourceLabelBox:_,getTargetLabelBox:D,getElementRotationPoint:I,getElementRotationOffset:Q,getLabelRotationPoint:z,getSourceLabelRotationPoint:U,getTargetLabelRotationPoint:F,getLabelRotationOffset:G,getSourceLabelRotationOffset:K,getTargetLabelRotationOffset:L})}mt.redrawHint=function(t,e){var r=this;switch(t){case"eles":r.data.canvasNeedsRedraw[mt.NODE]=e;break;case"drag":r.data.canvasNeedsRedraw[mt.DRAG]=e;break;case"select":r.data.canvasNeedsRedraw[mt.SELECT_BOX]=e;break;case"gc":r.data.gc=!0;break}};var eY=typeof Path2D<"u";mt.path2dEnabled=function(t){if(t===void 0)return this.pathsEnabled;this.pathsEnabled=!!t};mt.usePaths=function(){return eY&&this.pathsEnabled};mt.setImgSmoothing=function(t,e){t.imageSmoothingEnabled!=null?t.imageSmoothingEnabled=e:(t.webkitImageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e)};mt.getImgSmoothing=function(t){return t.imageSmoothingEnabled!=null?t.imageSmoothingEnabled:t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled};mt.makeOffscreenCanvas=function(t,e){var r;if((typeof OffscreenCanvas>"u"?"undefined":Zr(OffscreenCanvas))!=="undefined")r=new OffscreenCanvas(t,e);else{var n=this.cy.window(),i=n.document;r=i.createElement("canvas"),r.width=t,r.height=e}return r};[o7,vs,so,v3,eu,Al,ai,f7,Rl,cm,y7].forEach(function(t){Qe(mt,t)});var tY=[{name:"null",impl:qR},{name:"base",impl:n7},{name:"canvas",impl:ZK}],rY=[{type:"layout",extensions:Tq},{type:"renderer",extensions:tY}],b7={},w7={};function S7(t,e,r){var n=r,i=function(M){Lt("Can not register `"+e+"` for `"+t+"` since `"+M+"` already exists in the prototype and can not be overridden")};if(t==="core"){if(Ep.prototype[e])return i(e);Ep.prototype[e]=r}else if(t==="collection"){if(Tn.prototype[e])return i(e);Tn.prototype[e]=r}else if(t==="layout"){for(var a=function(M){this.options=M,r.call(this,M),Mt(this._private)||(this._private={}),this._private.cy=M.cy,this._private.listeners=[],this.createEmitter()},s=a.prototype=Object.create(r.prototype),o=[],l=0;l<o.length;l++){var c=o[l];s[c]=s[c]||function(){return this}}s.start&&!s.run?s.run=function(){return this.start(),this}:!s.start&&s.run&&(s.start=function(){return this.run(),this});var u=r.prototype.stop;s.stop=function(){var T=this.options;if(T&&T.animate){var M=this.animations;if(M)for(var A=0;A<M.length;A++)M[A].stop()}return u?u.call(this):this.emit("layoutstop"),this},s.destroy||(s.destroy=function(){return this}),s.cy=function(){return this._private.cy};var f=function(M){return M._private.cy},h={addEventFields:function(M,A){A.layout=M,A.cy=f(M),A.target=M},bubble:function(){return!0},parent:function(M){return f(M)}};Qe(s,{createEmitter:function(){return this._private.emitter=new ox(h,this),this},emitter:function(){return this._private.emitter},on:function(M,A){return this.emitter().on(M,A),this},one:function(M,A){return this.emitter().one(M,A),this},once:function(M,A){return this.emitter().one(M,A),this},removeListener:function(M,A){return this.emitter().removeListener(M,A),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(M,A){return this.emitter().emit(M,A),this}}),It.eventAliasesOn(s),n=a}else if(t==="renderer"&&e!=="null"&&e!=="base"){var m=k7("renderer","base"),v=m.prototype,y=r,x=r.prototype,b=function(){m.apply(this,arguments),y.apply(this,arguments)},S=b.prototype;for(var w in v){var k=v[w],N=x[w]!=null;if(N)return i(w);S[w]=k}for(var j in x)S[j]=x[j];v.clientFunctions.forEach(function(T){S[T]=S[T]||function(){lr("Renderer does not implement `renderer."+T+"()` on its prototype")}}),n=b}else if(t==="__proto__"||t==="constructor"||t==="prototype")return lr(t+" is an illegal type to be registered, possibly lead to prototype pollutions");return VA({map:b7,keys:[t,e],value:n})}function k7(t,e){return $A({map:b7,keys:[t,e]})}function nY(t,e,r,n,i){return VA({map:w7,keys:[t,e,r,n],value:i})}function iY(t,e,r,n){return $A({map:w7,keys:[t,e,r,n]})}var tk=function(){if(arguments.length===2)return k7.apply(null,arguments);if(arguments.length===3)return S7.apply(null,arguments);if(arguments.length===4)return iY.apply(null,arguments);if(arguments.length===5)return nY.apply(null,arguments);lr("Invalid extension access syntax")};Ep.prototype.extension=tk;rY.forEach(function(t){t.extensions.forEach(function(e){S7(t.type,e.name,e.impl)})});var D0=function(){if(!(this instanceof D0))return new D0;this.length=0},$c=D0.prototype;$c.instanceString=function(){return"stylesheet"};$c.selector=function(t){var e=this.length++;return this[e]={selector:t,properties:[]},this};$c.css=function(t,e){var r=this.length-1;if(Ke(t))this[r].properties.push({name:t,value:e});else if(Mt(t))for(var n=t,i=Object.keys(n),a=0;a<i.length;a++){var s=i[a],o=n[s];if(o!=null){var l=pn.properties[s]||pn.properties[Qy(s)];if(l!=null){var c=l.name,u=o;this[r].properties.push({name:c,value:u})}}}return this};$c.style=$c.css;$c.generateStyle=function(t){var e=new pn(t);return this.appendToStyle(e)};$c.appendToStyle=function(t){for(var e=0;e<this.length;e++){var r=this[e],n=r.selector,i=r.properties;t.selector(n);for(var a=0;a<i.length;a++){var s=i[a];t.css(s.name,s.value)}}return t};var aY="3.33.1",Uc=function(e){if(e===void 0&&(e={}),Mt(e))return new Ep(e);if(Ke(e))return tk.apply(tk,arguments)};Uc.use=function(t){var e=Array.prototype.slice.call(arguments,1);return e.unshift(Uc),t.apply(null,e),this};Uc.warnings=function(t){return YA(t)};Uc.version=aY;Uc.stylesheet=Uc.Stylesheet=D0;const{string:Gg,array:aj,object:Hg,number:rh,bool:Ti,oneOfType:Iu,any:Wg,func:nh}=M$,sY={id:Gg,className:Gg,style:Iu([Gg,Hg]),elements:Iu([aj,Wg]),stylesheet:Iu([aj,Wg]),layout:Iu([Hg,Wg]),pan:Iu([Hg,Wg]),zoom:rh,panningEnabled:Ti,userPanningEnabled:Ti,minZoom:rh,maxZoom:rh,zoomingEnabled:Ti,userZoomingEnabled:Ti,boxSelectionEnabled:Ti,autoungrabify:Ti,autolock:Ti,autounselectify:Ti,get:nh,toJson:nh,diff:nh,forEach:nh,cy:nh,headless:Ti,styleEnabled:Ti,hideEdgesOnViewport:Ti,textureOnViewport:Ti,motionBlur:Ti,motionBlurOpacity:rh,wheelSensitivity:rh,pixelRatio:Iu([Gg,Hg])},C7=(t,e)=>{if(((a,s)=>a==null||s==null)(t,e)&&(t!=null||e!=null))return!0;if(t===e)return!1;if(typeof t!="object"||typeof e!="object")return t!==e;const r=Object.keys(t),n=Object.keys(e),i=a=>t[a]!==e[a];return r.length!==n.length||!(!r.some(i)&&!n.some(i))},Na=(t,e)=>t!=null?t[e]:null,oY={diff:C7,get:Na,toJson:t=>t,forEach:(t,e)=>t.forEach(e),elements:[{data:{id:"a",label:"Example node A"}},{data:{id:"b",label:"Example node B"}},{data:{id:"e",source:"a",target:"b"}}],stylesheet:[{selector:"node",style:{label:"data(label)"}}],zoom:1,pan:{x:0,y:0}},qg=(t,e,r,n)=>r(Na(t,n),Na(e,n)),lY=(t,e,r,n,i,a,s)=>{t.batch(()=>{(n===C7||qg(e,r,n,"elements"))&&fY(t,Na(e,"elements"),Na(r,"elements"),i,a,s,n),qg(e,r,n,"stylesheet")&&dY(t,Na(e,"stylesheet"),Na(r,"stylesheet"),i),["zoom","minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","pan","panningEnabled","userPanningEnabled","boxSelectionEnabled","autoungrabify","autolock","autounselectify"].forEach(o=>{qg(e,r,n,o)&&cY(t,o,Na(e,o),Na(r,o),i)})}),qg(e,r,n,"layout")&&uY(t,Na(e,"layout"),Na(r,"layout"),i)},cY=(t,e,r,n,i)=>{t[e](i(n))},uY=(t,e,r,n)=>{const i=n(r);i!=null&&t.layout(i).run()},dY=(t,e,r,n)=>{const i=t.style();i!=null&&i.fromJson(n(r)).update()},fY=(t,e,r,n,i,a,s)=>{const o=[],l=t.collection(),c=[],u={},f={},h=m=>i(i(m,"data"),"id");a(r,m=>{const v=h(m);f[v]=m}),e!=null&&a(e,m=>{const v=h(m);u[v]=m,(y=>f[y]!=null)(v)||l.merge(t.getElementById(v))}),a(r,m=>{const v=h(m),y=(x=>u[x])(v);(x=>u[x]!=null)(v)?c.push({ele1:y,ele2:m}):o.push(n(m))}),l.length>0&&t.remove(l),o.length>0&&t.add(o),c.forEach(({ele1:m,ele2:v})=>hY(t,m,v,n,i,s))},hY=(t,e,r,n,i,a)=>{const s=i(i(r,"data"),"id"),o=t.getElementById(s),l={};["data","position","selected","selectable","locked","grabbable","classes"].forEach(u=>{const f=i(r,u);a(f,i(e,u))&&(l[u]=n(f))});const c=i(r,"scratch");a(c,i(e,"scratch"))&&o.scratch(n(c)),Object.keys(l).length>0&&o.json(l)};class pY extends kt.Component{static get propTypes(){return sY}static get defaultProps(){return oY}static normalizeElements(e){if(e.length!=null)return e;{let{nodes:r,edges:n}=e;return r==null&&(r=[]),n==null&&(n=[]),r.concat(n)}}constructor(e){super(e),this.displayName="CytoscapeComponent",this.containerRef=kt.createRef()}componentDidMount(){const e=this.containerRef.current,{global:r,headless:n,styleEnabled:i,hideEdgesOnViewport:a,textureOnViewport:s,motionBlur:o,motionBlurOpacity:l,wheelSensitivity:c,pixelRatio:u}=this.props,f=this._cy=new Uc({container:e,headless:n,styleEnabled:i,hideEdgesOnViewport:a,textureOnViewport:s,motionBlur:o,motionBlurOpacity:l,wheelSensitivity:c,pixelRatio:u});r&&(window[r]=f),this.updateCytoscape(null,this.props)}updateCytoscape(e,r){const n=this._cy,{diff:i,toJson:a,get:s,forEach:o}=r;lY(n,e,r,i,a,s,o),r.cy!=null&&r.cy(n)}componentDidUpdate(e){this.updateCytoscape(e,this.props)}componentWillUnmount(){this._cy.destroy()}render(){const{id:e,className:r,style:n}=this.props;return kt.createElement("div",{ref:this.containerRef,id:e,className:r,style:n})}}const mY=[{selector:"node",style:{"background-color":"#1f2937",label:"data(label)",color:"#cbd5e1","font-family":"Outfit, sans-serif","font-size":"12px","text-valign":"bottom","text-margin-y":8,width:40,height:40,"border-width":2,"border-color":"#475569","text-outline-width":2,"text-outline-color":"#050508","overlay-padding":6,"z-index":10}},{selector:'node[category="Individual"]',style:{"background-color":"rgba(49, 46, 129, 0.9)","border-color":"#6366f1",shape:"ellipse",width:50,height:50}},{selector:'node[category="Location"]',style:{"background-color":"rgba(6, 78, 59, 0.9)","border-color":"#10b981",shape:"hexagon",width:60,height:60}},{selector:'node[category="Group"]',style:{"background-color":"rgba(88, 28, 135, 0.9)","border-color":"#a855f7",shape:"round-rectangle"}},{selector:"edge",style:{width:2,"line-color":"#334155","target-arrow-color":"#334155","target-arrow-shape":"triangle","curve-style":"bezier"}},{selector:":selected",style:{"border-width":4,"border-color":"#fafafa","line-color":"#fafafa","target-arrow-color":"#fafafa","z-index":999}}],gY=()=>{Bi();const[t,e]=q.useState([]),[r,n]=q.useState([]),[i,a]=q.useState(""),[s,o]=q.useState(!0),l=q.useRef(null);q.useEffect(()=>{c()},[]);const c=async()=>{o(!0);try{const m=await Ne.get("/world-bible/entities");n(m),u(m)}catch(m){console.error("Failed to load graph data",m)}finally{o(!1)}},u=m=>{const v=m.map(x=>({data:{id:x.id.toString(),label:x.nombre,category:x.categoria||"Generic",type:x.tipoEspecial}})),y=[];m.forEach(x=>{x.valores&&Array.isArray(x.valores)&&x.valores.forEach(b=>{var S;((S=b.plantilla)==null?void 0:S.tipo)==="entity_link"&&b.valor&&y.push({data:{source:x.id.toString(),target:b.valor.toString()}})})}),e([...v,...y])},f=()=>{if(!l.current)return;l.current.layout({name:"cose",animate:!0,padding:50,nodeOverlap:20,componentSpacing:100}).run()};q.useEffect(()=>{l.current&&f()},[t]);const h=()=>{if(!l.current||!i)return;const m=l.current;if(m.elements().removeClass("highlighted faded"),i.length>0){const v=m.nodes().filter(y=>y.data("label").toLowerCase().includes(i.toLowerCase()));v.length>0&&(m.elements().not(v).addClass("faded"),v.addClass("highlighted"),m.animate({fit:{eles:v,padding:50}}))}};return d.jsxs("div",{className:"w-full h-full flex bg-background-dark relative overflow-hidden font-display text-foreground",children:[d.jsx("div",{className:"absolute top-4 left-4 z-20 w-80 pointer-events-none",children:d.jsxs("div",{className:"bg-card/90 backdrop-blur-md border border-border/50 rounded-xl p-4 shadow-2xl pointer-events-auto space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"size-8 rounded bg-primary flex items-center justify-center",children:d.jsx("span",{className:"material-symbols-outlined text-primary-foreground",children:"hub"})}),d.jsx("h2",{className:"font-bold text-lg tracking-tight",children:"Graph View"})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{className:"bg-accent/50 border border-input rounded-md px-3 py-2 text-sm w-full outline-none focus:ring-1 focus:ring-primary",placeholder:"Find node...",value:i,onChange:m=>a(m.target.value),onKeyDown:m=>m.key==="Enter"&&h()}),d.jsx("button",{onClick:h,className:"bg-primary/20 hover:bg-primary/30 text-primary border border-primary/50 rounded-md px-3 transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"search"})})]}),d.jsxs("div",{className:"flex flex-wrap gap-2 text-[10px] uppercase font-bold text-muted-foreground pt-2 border-t border-border/50",children:[d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("div",{className:"size-2 rounded-full bg-indigo-500"})," Individual"]}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("div",{className:"size-2 rounded-full bg-emerald-500"})," Location"]}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("div",{className:"size-2 rounded-full bg-purple-500"})," Group"]})]}),d.jsx("div",{className:"pt-2",children:d.jsxs(Wt,{onClick:f,size:"sm",variant:"outline",className:"w-full text-xs",children:[d.jsx("span",{className:"material-symbols-outlined text-sm mr-2",children:"refresh"}),"Re-Layout"]})})]})}),t.length===0&&!s&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10 pointer-events-none",children:d.jsx("div",{className:"text-muted text-lg",children:"No entities found. Create some in the Bible!"})}),d.jsx(pY,{elements:t,stylesheet:mY,style:{width:"100%",height:"100%"},cy:m=>{l.current=m},minZoom:.2,maxZoom:3,wheelSensitivity:.3,className:"bg-background-dark"})]})},vY=({id:t})=>{const{id:e}=Bi(),r=Li(),[n,i]=q.useState("overview"),[a,s]=q.useState(null),[o,l]=q.useState(!0),[c,u]=q.useState(!1);q.useEffect(()=>{f()},[t]);const f=async()=>{l(!0);try{const y=await Ne.get(`/bd/entidadindividual/${t}`);s(y)}catch(y){console.error("Error loading character:",y)}finally{l(!1)}},h=async()=>{try{await Ne.patch("/bd/modificar",{...a,tipoEntidad:"entidadindividual"}),u(!1)}catch(y){console.error("Error saving:",y)}},m=async()=>{if(window.confirm("Move this character to the Trash Bin?"))try{await Ne.delete(`/bd/entidadindividual/${t}`),r(`/project/${e}`)}catch(y){console.error(y)}},v=(y,x)=>{s(b=>({...b,[y]:x}))};return o?d.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Summoning entity..."}):a?d.jsxs("div",{className:"flex h-full",children:[d.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto custom-scrollbar p-8 gap-6",children:[d.jsxs("div",{className:"flex items-start gap-6",children:[d.jsx("div",{className:"relative",children:d.jsx(b0,{url:a.imagenUrl||"https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=1976&auto=format&fit=crop",size:"xl",className:"rounded-2xl border-2 border-primary shadow-[0_0_30px_rgba(99,102,242,0.3)]"})}),d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[d.jsx("span",{className:"text-xs font-bold text-primary bg-primary/10 px-2 py-0.5 rounded border border-primary/20",children:a.estado||"ACTIVE"}),d.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:a.tipo||"Unknown"})]}),d.jsxs("h1",{className:"text-4xl font-bold text-white mb-2",children:[a.nombre," ",a.apellidos]}),d.jsx("p",{className:"text-lg text-slate-300",children:a.origen||"Traveling the void"})]}),d.jsxs("div",{className:"flex gap-2",children:[!c&&d.jsx(Wt,{className:"border-red-500/30 text-red-400 hover:bg-red-500/10",icon:"delete",onClick:m,children:"Delete"}),d.jsx(Wt,{variant:"secondary",icon:c?"close":"edit",onClick:()=>u(!c),children:c?"Cancel":"Edit Profile"}),c&&d.jsx(Wt,{variant:"primary",icon:"save",onClick:h,children:"Save Changes"})]})]}),d.jsx("div",{className:"border-b border-glass-border flex gap-6",children:["Overview","Biography","Attributes & Stats","Relationships"].map(y=>d.jsx("button",{onClick:()=>i(y.toLowerCase()),className:`pb-4 px-2 text-sm font-bold border-b-2 transition-colors ${n===y.toLowerCase()?"text-primary border-primary":"text-slate-500 border-transparent hover:text-white"}`,children:y},y))}),d.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[d.jsx("div",{className:"col-span-1 space-y-6",children:d.jsxs(Ct,{className:"p-4",children:[d.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"fingerprint"})," Identity"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Name"}),d.jsx("input",{type:"text",value:a.nombre,onChange:y=>v("nombre",y.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!c})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Surnames"}),d.jsx("input",{type:"text",value:a.apellidos||"",onChange:y=>v("apellidos",y.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!c})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Type / Species"}),d.jsx("input",{type:"text",value:a.tipo||"",onChange:y=>v("tipo",y.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!c})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Origin"}),d.jsx("input",{type:"text",value:a.origen||"",onChange:y=>v("origen",y.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!c})]})]})]})}),d.jsx("div",{className:"col-span-2 space-y-6",children:d.jsxs(Ct,{className:"p-6 relative overflow-hidden group",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"})," Narrative & Connections"]}),!c&&d.jsx("span",{className:"text-[10px] text-slate-600 bg-white/5 px-2 py-1 rounded",children:"Read Only"})]}),d.jsxs("div",{className:"mb-8",children:[d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mb-3 opacity-80",children:"Biography"}),d.jsx("textarea",{value:a.descripcion||"",onChange:y=>v("descripcion",y.target.value),readOnly:!c,className:`w-full bg-transparent border-none outline-none text-slate-300 text-sm leading-relaxed resize-none custom-scrollbar ${c?"min-h-[150px] placeholder-white/20":"h-auto overflow-hidden"}`,placeholder:"Write the history of this person..."}),d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mt-6 mb-3 opacity-80",children:"Behavior & Personality"}),d.jsx("textarea",{value:a.comportamiento||"",onChange:y=>v("comportamiento",y.target.value),readOnly:!c,className:`w-full bg-transparent border-none outline-none text-slate-300 text-sm leading-relaxed resize-none custom-scrollbar ${c?"min-h-[100px]":"h-auto overflow-hidden"}`,placeholder:"How does this person act?"})]}),d.jsxs("div",{className:"pt-6 border-t border-white/5",children:[d.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary mb-4 flex items-center gap-2 opacity-80",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})," Established Connections"]}),a.relaciones&&a.relaciones.length>0?d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.relaciones.map((y,x)=>{var b,S,w;return d.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-xl border border-white/5 hover:border-primary/30 transition-colors",children:[d.jsx("div",{className:"size-8 rounded-full bg-white/10 flex items-center justify-center text-xs font-bold",children:((S=(b=y.entidadDestino)==null?void 0:b.nombre)==null?void 0:S.charAt(0))||"?"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-bold text-white truncate",children:((w=y.entidadDestino)==null?void 0:w.nombre)||"Unknown"}),d.jsx("div",{className:"text-[10px] text-primary truncate",children:y.tipoRelacion||"Connected"})]})]},x)})}):d.jsx("div",{className:"p-6 text-center bg-white/5 rounded-xl border border-dashed border-white/10",children:d.jsx("p",{className:"text-xs text-slate-500 italic",children:"No relationships recorded yet."})})]})]})})]})]}),d.jsxs("div",{className:"w-80 border-l border-glass-border bg-surface-dark/50 hidden xl:flex flex-col",children:[d.jsxs("div",{className:"p-4 border-b border-glass-border flex justify-between items-center",children:[d.jsx("span",{className:"text-xs font-bold text-slate-500",children:"QUICK NOTES"}),d.jsx("button",{className:"text-slate-400 hover:text-white",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"})})]}),d.jsx("div",{className:"p-4 flex-1",children:d.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none text-sm text-slate-300 placeholder-slate-600 resize-none",placeholder:"Draft a quick scene or jot down notes for Elara here..."})}),d.jsx("div",{className:"p-2 border-t border-glass-border text-right text-[10px] text-slate-600",children:"0 words"})]})]}):d.jsx("div",{className:"p-20 text-center text-red-500",children:"Character not found in the archives."})},sj=({id:t})=>{const[e,r]=q.useState(null),[n,i]=q.useState(!0),[a,s]=q.useState(!1);q.useEffect(()=>{o()},[t]);const o=async()=>{i(!0);try{const u=await Ne.get(`/bd/zona/${t}`);r(u)}catch(u){console.error("Error loading location:",u)}finally{i(!1)}},l=async()=>{try{await Ne.patch("/bd/modificar",{...e,tipoEntidad:"zona"}),s(!1)}catch(u){console.error("Error saving:",u)}},c=(u,f)=>{r(h=>({...h,[u]:f}))};return n?d.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Scanning terrain..."}):e?d.jsxs("div",{className:"flex h-full overflow-y-auto custom-scrollbar p-8 flex-col gap-8",children:[d.jsxs("header",{className:"flex justify-between items-end",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("span",{className:"text-xs font-bold text-emerald-400 bg-emerald-400/10 px-2 py-0.5 rounded border border-emerald-400/20",children:"LOCATION"}),d.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:e.tipo||"Wilderness"})]}),d.jsx("h1",{className:"text-5xl font-manrope font-black text-white tracking-tight",children:e.nombre}),d.jsx("p",{className:"text-slate-400 mt-2",children:e.apellidos||"Uncharted territory"})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(Wt,{variant:"secondary",icon:a?"close":"edit",onClick:()=>s(!a),children:a?"Cancel":"Edit Location"}),a&&d.jsx(Wt,{variant:"primary",icon:"save",onClick:l,children:"Update Records"})]})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[d.jsxs("div",{className:"col-span-1 space-y-6",children:[d.jsxs(Ct,{className:"p-6",children:[d.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"straighten"})," Geography & Scale"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Size / Scale"}),d.jsx("input",{type:"text",value:e.tamanno||"",onChange:u=>c("tamanno",u.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Development Level"}),d.jsx("input",{type:"text",value:e.desarrollo||"",onChange:u=>c("desarrollo",u.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]})]})]}),d.jsxs(Ct,{className:"p-6",children:[d.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4",children:"Quick Stats"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[d.jsx("span",{className:"text-[10px] text-slate-500 block",children:"Density"}),d.jsx("span",{className:"text-white font-bold",children:"Medium"})]}),d.jsxs("div",{className:"bg-white/5 p-3 rounded-xl border border-white/5",children:[d.jsx("span",{className:"text-[10px] text-slate-500 block",children:"Security"}),d.jsx("span",{className:"text-emerald-400 font-bold",children:"Stable"})]})]})]})]}),d.jsx("div",{className:"col-span-2 space-y-6",children:d.jsxs(Ct,{className:"p-8",children:[d.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"description"})," Topographic Records & Lore"]}),d.jsx("textarea",{value:e.descripcion||"",onChange:u=>c("descripcion",u.target.value),readOnly:!a,className:"w-full bg-transparent border-none outline-none text-slate-300 text-lg leading-relaxed min-h-[400px] resize-none",placeholder:"Describe the vistas, the smells, and the secrets of this place..."})]})})]})]}):d.jsx("div",{className:"p-20 text-center text-red-500",children:"Location not found in the maps."})},yY=({id:t})=>{const[e,r]=q.useState(null),[n,i]=q.useState(!0),[a,s]=q.useState(!1);q.useEffect(()=>{o()},[t]);const o=async()=>{i(!0);try{const u=await Ne.get(`/bd/entidadcolectiva/${t}`);r(u)}catch(u){console.error("Error loading collective:",u)}finally{i(!1)}},l=async()=>{try{await Ne.patch("/bd/modificar",{...e,tipoEntidad:"entidadcolectiva"}),s(!1)}catch(u){console.error("Error saving:",u)}},c=(u,f)=>{r(h=>({...h,[u]:f}))};return n?d.jsx("div",{className:"p-20 text-center text-slate-500 animate-pulse",children:"Gathering intelligence..."}):e?d.jsxs("div",{className:"flex h-full overflow-y-auto custom-scrollbar p-8 flex-col gap-8",children:[d.jsxs("header",{className:"flex justify-between items-end",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("span",{className:"text-xs font-bold text-indigo-400 bg-indigo-400/10 px-2 py-0.5 rounded border border-indigo-400/20",children:"COLLECTIVE"}),d.jsx("span",{className:"text-xs font-bold text-slate-400 bg-surface-light px-2 py-0.5 rounded border border-white/5",children:e.tipo||"Organization"})]}),d.jsx("h1",{className:"text-5xl font-manrope font-black text-white tracking-tight",children:e.nombre}),d.jsxs("p",{className:"text-slate-400 mt-2",children:[e.cantidadMiembros||"Unknown"," members"]})]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx(Wt,{variant:"secondary",icon:a?"close":"edit",onClick:()=>s(!a),children:a?"Cancel":"Edit Collective"}),a&&d.jsx(Wt,{variant:"primary",icon:"save",onClick:l,children:"Update Dossier"})]})]}),d.jsxs("div",{className:"grid grid-cols-3 gap-8",children:[d.jsx("div",{className:"col-span-1 space-y-6",children:d.jsxs(Ct,{className:"p-6",children:[d.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"group_work"})," Group Dynamics"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Scale / Members"}),d.jsx("input",{type:"text",value:e.cantidadMiembros||"",onChange:u=>c("cantidadMiembros",u.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-slate-400 block mb-1",children:"Behavior / Alignment"}),d.jsx("input",{type:"text",value:e.comportamiento||"",onChange:u=>c("comportamiento",u.target.value),className:"w-full bg-surface-light border border-white/10 rounded px-3 py-2 text-white text-sm",readOnly:!a})]})]})]})}),d.jsx("div",{className:"col-span-2 space-y-6",children:d.jsxs(Ct,{className:"p-8",children:[d.jsxs("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"history_edu"})," Mandate & History"]}),d.jsx("textarea",{value:e.descripcion||"",onChange:u=>c("descripcion",u.target.value),readOnly:!a,className:"w-full bg-transparent border-none outline-none text-slate-300 text-lg leading-relaxed min-h-[400px] resize-none",placeholder:"Detail the motives, the structure, and the legacy of this group..."})]})})]})]}):d.jsx("div",{className:"p-20 text-center text-red-500",children:"Collective not found in the records."})},xY=()=>d.jsx("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300",children:d.jsxs("main",{className:"flex-1 flex flex-col p-12 overflow-y-auto custom-scrollbar relative",children:[d.jsxs("header",{className:"mb-12 space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold text-[10px] tracking-widest uppercase",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"grid_view"}),d.jsx("span",{children:"Universo Alpha"}),d.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),d.jsx("span",{children:"Galaxia Andrmeda"}),d.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),d.jsx("span",{className:"text-white",children:"Sistema Solar"})]}),d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{className:"space-y-4 max-w-3xl",children:[d.jsxs("div",{className:"flex items-center gap-3 px-3 py-1 rounded bg-orange-500/10 text-orange-400 border border-orange-500/20 inline-block",children:[d.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"sunny"}),d.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Sistema Planetario"}),d.jsx("span",{className:"text-[9px] font-bold text-slate-600 tracking-widest ml-2",children:"ID: SYS-SOL-001"})]}),d.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:"Sistema Solar"}),d.jsx("p",{className:"text-slate-400 text-lg leading-relaxed",children:"Sistema planetario principal ubicado en el Brazo de Orin, hogar de la nica vida biolgica compleja confirmada en el sector galctico Alpha-9."})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{className:"p-3 rounded-2xl bg-white/5 hover:bg-red-500/10 text-slate-500 hover:text-red-400 border border-white/5 transition-all outline-none",children:d.jsx("span",{className:"material-symbols-outlined",children:"delete"})}),d.jsx(Wt,{variant:"primary",icon:"save",children:"Guardar"})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[d.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[d.jsxs("section",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"sell"}),d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Etiquetas"}),d.jsx("span",{className:"ml-auto text-[9px] font-bold text-slate-600 px-1.5 py-0.5 rounded bg-white/5",children:"3 ACTIVAS"})]}),d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsx($2,{label:"Estrella Tipo G",color:"amber",icon:"star"}),d.jsx($2,{label:"Vida Confirmada",color:"emerald",icon:"tempest"}),d.jsx($2,{label:"Rico en Agua",color:"cyan",icon:"water_drop"}),d.jsx("button",{className:"size-8 rounded-full border border-dashed border-white/10 flex items-center justify-center text-slate-600 hover:text-white hover:border-white/30 transition-all",children:"+"})]})]}),d.jsxs("section",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"analytics"}),d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Atributos Principales"}),d.jsx("button",{className:"ml-auto text-slate-600 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"settings"})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx(Kg,{label:"Forma / Estructura",value:"Heliosfrica Estndar",icon:"hive"}),d.jsx(Kg,{label:"Composicin",value:"Hidrgeno (74%), Helio (24%)",icon:"experiment"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsx(Kg,{label:"Edad (Aos)",value:"4.6 MM",unit:"Aos"}),d.jsx(Kg,{label:"Ciclo Orbital",value:"230 MM",unit:"Aos"})]})]})]}),d.jsxs("section",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-primary text-lg",children:"menu_book"}),d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Notas de Lore"})]}),d.jsx("textarea",{className:"w-full h-48 bg-white/5 border border-white/5 rounded-[2rem] p-6 text-sm text-slate-400 placeholder:text-slate-700 focus:border-primary/50 outline-none transition-all resize-none leading-relaxed italic shadow-inner",defaultValue:"El sistema contiene un cinturn de asteroides inusualmente denso entre el 4 y 5 planeta. Se teoriza que es el remanente de una colisin planetaria antigua conocida como 'El Gran Impacto' en las escrituras sagradas de los habitantes de Terra."})]})]}),d.jsx("div",{className:"lg:col-span-2",children:d.jsxs(Ct,{className:"h-full border-white/5 bg-surface-dark/40 overflow-hidden flex flex-col shadow-2xl",children:[d.jsxs("header",{className:"p-8 border-b border-white/5 flex justify-between items-center",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"size-10 rounded-xl bg-primary/20 text-primary flex items-center justify-center",children:d.jsx("span",{className:"material-symbols-outlined",children:"hub"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-white text-lg tracking-tight",children:"Contenido Interno (Planetas)"}),d.jsx("p",{className:"text-[10px] font-medium text-slate-500 mt-0.5",children:"Arrastra para reordenar la jerarqua orbital"})]})]}),d.jsxs("div",{className:"px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[10px] font-black uppercase tracking-widest flex items-center gap-2",children:[d.jsx("div",{className:"size-1.5 rounded-full bg-emerald-500 animate-pulse"}),"8 Entidades"]})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-3",children:[d.jsx(ih,{name:"Mercurio",type:"Rocoso",stats:"430C | 88 Das",icon:"public"}),d.jsx(ih,{name:"Venus",type:"Atmsfera",stats:"462C | 225 Das",icon:"public"}),d.jsx(ih,{name:"Tierra",type:"Habitable",stats:"8B Hab | 1 Luna",icon:"public",active:!0}),d.jsx(ih,{name:"Marte",type:"Desierto",stats:"-60C | 2 Lunas",icon:"public"}),d.jsx(ih,{name:"Cinturn Asteroides",type:"Anillo",stats:">1M Obj",icon:"grain"})]}),d.jsx("div",{className:"p-8 bg-black/20 border-t border-white/5",children:d.jsxs("button",{className:"w-full py-4 rounded-[1.5rem] border-2 border-dashed border-white/10 text-slate-500 hover:text-white hover:border-primary/50 hover:bg-primary/5 transition-all flex items-center justify-center gap-3 font-black uppercase text-[10px] tracking-[0.2em]",children:[d.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Aadir Nueva Entidad"]})})]})})]})]})}),$2=({label:t,color:e,icon:r})=>d.jsxs("div",{className:`px-4 py-1.5 rounded-xl bg-${e}-500/10 text-${e}-400 border border-${e}-500/20 flex items-center gap-2 text-[10px] font-black uppercase tracking-widest shadow-lg`,children:[d.jsx("span",{className:"material-symbols-outlined text-[14px]",children:r}),t]}),Kg=({label:t,value:e,unit:r,icon:n})=>d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-slate-600 ml-1",children:t}),d.jsxs("div",{className:"w-full bg-white/5 border border-white/5 rounded-2xl px-5 py-3.5 flex items-center justify-between group hover:border-white/10 transition-all",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[n&&d.jsx("span",{className:"material-symbols-outlined text-slate-500 text-lg group-hover:text-primary transition-colors",children:n}),d.jsx("span",{className:"text-sm font-bold text-slate-300",children:e})]}),r&&d.jsx("span",{className:"text-[10px] font-black text-slate-600 uppercase tracking-widest",children:r})]})]}),ih=({name:t,type:e,stats:r,icon:n,active:i})=>d.jsxs("div",{className:`group flex items-center gap-6 p-4 rounded-2xl transition-all cursor-pointer ${i?"bg-primary/10 border border-primary/20 shadow-xl":"hover:bg-white/5 border border-transparent"}`,children:[d.jsx("span",{className:"material-symbols-outlined text-slate-700 group-hover:text-slate-500",children:"drag_indicator"}),d.jsx("div",{className:`size-12 rounded-xl flex items-center justify-center ${i?"bg-primary text-white shadow-lg shadow-primary/30":"bg-surface-dark border border-white/5 text-slate-500"}`,children:d.jsx("span",{className:"material-symbols-outlined text-3xl",children:n})}),d.jsx("div",{className:"flex-1",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("h4",{className:"text-sm font-bold text-white group-hover:text-primary transition-colors",children:t}),d.jsx("span",{className:`text-[8px] font-black px-1.5 py-0.5 rounded uppercase tracking-widest ${i?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-white/5 text-slate-600"}`,children:e})]})}),d.jsx("div",{className:"flex flex-col items-end gap-1",children:d.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[d.jsx("span",{className:"material-symbols-outlined text-[12px]",children:"analytics"}),d.jsx("span",{className:"text-[10px] font-mono tracking-tight group-hover:text-slate-300",children:r})]})}),d.jsxs("div",{className:"flex gap-2 ml-4",children:[d.jsx("button",{className:"p-2 rounded-lg text-slate-700 hover:text-white hover:bg-white/5 transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit_note"})}),i?d.jsx("button",{className:"size-8 rounded-full bg-primary text-white flex items-center justify-center shadow-lg",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"arrow_forward"})}):d.jsx("button",{className:"p-2 rounded-lg text-slate-700 hover:text-white hover:bg-white/5 transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"open_in_new"})})]})]}),bY=()=>d.jsx("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300",children:d.jsxs("main",{className:"flex-1 flex flex-col p-12 overflow-y-auto custom-scrollbar relative",children:[d.jsxs("header",{className:"mb-12 space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold text-[10px] tracking-widest uppercase",children:[d.jsx("span",{children:"Sistema Solar"}),d.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),d.jsx("span",{children:"Kepler-186f"}),d.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),d.jsx("span",{className:"text-white",children:"Territorios"})]}),d.jsxs("div",{className:"flex justify-between items-end",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[d.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:"Kepler-186f"}),d.jsx("span",{className:"material-symbols-outlined text-4xl text-primary",children:"public"})]}),d.jsx("p",{className:"text-slate-400 text-lg max-w-2xl leading-relaxed",children:"Gestin geopoltica y geogrfica de la superficie planetaria. Administra biomas, asentamientos y recursos estratgicos."})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx(Wt,{variant:"secondary",icon:"map",children:"Ver Atlas"}),d.jsx(Wt,{variant:"primary",icon:"add",children:"Nuevo Territorio"})]})]})]}),d.jsxs("section",{className:"space-y-8",children:[d.jsxs(Ct,{className:"p-2 flex items-center justify-between border-white/5",children:[d.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[d.jsxs("div",{className:"relative flex-1 max-w-sm",children:[d.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm",children:"search"}),d.jsx("input",{type:"text",placeholder:"Buscar por nombre...",className:"w-full bg-transparent border-none rounded-xl py-2 pl-9 pr-4 text-xs focus:ring-1 focus:ring-primary/30 outline-none transition-all"})]}),d.jsx("div",{className:"w-px h-6 bg-white/5 mx-2"}),d.jsx(U2,{label:"Bioma: Todos"}),d.jsx(U2,{label:"Poblacin"}),d.jsx(U2,{label:"Estado"})]}),d.jsxs("div",{className:"flex items-center gap-1 p-1 bg-white/5 rounded-lg",children:[d.jsx("button",{className:"p-1.5 rounded-md text-slate-500 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"format_list_bulleted"})}),d.jsx("button",{className:"p-1.5 rounded-md bg-white/10 text-white shadow-sm",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_view"})})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[d.jsx(G2,{title:"Nueva Neo-Tokyo",desc:"Metrpolis vertical construida sobre las...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuAYF5Q6W3o1w1f1",badges:["Capital"],stats:["15M","Templado","Costero"],color:"cyan"}),d.jsx(G2,{title:"Mar de Dunas",desc:"Extensin rida rica en especia slica...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuBYG6R7X4p2x2g2",stats:["Hostil","rido"],color:"amber"}),d.jsx(G2,{title:"Sanctum Bio-Domo",desc:"Instalacin de investigacin...",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuCZ H7S8Y5q3z3h3",badges:["Ciencia"],stats:["5K","Jungla"],color:"purple"}),d.jsxs("div",{className:"group border-2 border-dashed border-white/5 rounded-[2.5rem] flex flex-col items-center justify-center p-12 gap-4 hover:border-primary/30 hover:bg-primary/5 transition-all cursor-pointer",children:[d.jsx("div",{className:"size-16 rounded-3xl bg-white/5 flex items-center justify-center group-hover:scale-110 transition-transform",children:d.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-600 group-hover:text-primary",children:"add_location_alt"})}),d.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-slate-600 group-hover:text-white",children:"Aadir Territorio"})]})]})]})]})}),U2=({label:t})=>d.jsxs("button",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl hover:bg-white/5 transition-all group",children:[d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-white",children:t}),d.jsx("span",{className:"material-symbols-outlined text-slate-600 text-[14px]",children:"expand_more"})]}),G2=({title:t,desc:e,image:r,badges:n=[],stats:i=[],color:a})=>d.jsxs("div",{className:"group relative rounded-[2.5rem] overflow-hidden border border-white/5 bg-surface-dark/50 hover:border-white/10 transition-all shadow-2xl",children:[d.jsxs("div",{className:"h-48 overflow-hidden relative",children:[d.jsx("img",{src:r,alt:t,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110 opacity-60 group-hover:opacity-100"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-surface-dark via-transparent to-transparent"}),d.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:n.map(s=>d.jsxs("span",{className:`px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest bg-${a==="cyan"?"primary":a==="amber"?"amber-500":"purple-500"}/20 text-${a==="cyan"?"primary":a==="amber"?"amber-400":"purple-400"} border border-white/10 backdrop-blur-md flex items-center gap-1.5`,children:[d.jsx("span",{className:"material-symbols-outlined text-[12px]",children:s==="Capital"?"star":"science"}),s]},s))})]}),d.jsxs("div",{className:"p-8 space-y-6",children:[d.jsxs("header",{className:"flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-2xl font-manrope font-black text-white mb-2 group-hover:text-primary transition-colors",children:t}),d.jsx("p",{className:"text-xs text-slate-500 leading-relaxed line-clamp-2",children:e})]}),d.jsx("button",{className:"p-2 text-slate-700 hover:text-white",children:d.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})]}),d.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(s=>d.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-white/5 border border-white/5 text-[9px] font-black text-slate-400 uppercase tracking-widest",children:[d.jsx("div",{className:`size-1.5 rounded-full bg-${a==="cyan"?"primary":a==="amber"?"amber-500":"purple-500"}/50`}),s]},s))}),d.jsxs("div",{className:"flex gap-3 pt-2",children:[d.jsxs("button",{className:"flex-1 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[d.jsx("span",{className:"material-symbols-outlined text-sm opacity-50",children:"edit"})," Editar"]}),d.jsxs("button",{className:"flex-1 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[d.jsx("span",{className:"material-symbols-outlined text-sm opacity-50",children:"map"})," Ubicacin"]})]})]})]}),wY=()=>{const{type:t,entityId:e}=Bi(),r=()=>{const n=t==null?void 0:t.toLowerCase();switch(n){case"character":case"entidadindividual":return d.jsx(vY,{id:e});case"location":case"zona":return d.jsx(sj,{id:e});case"culture":case"entidadcolectiva":return d.jsx(yY,{id:e});case"universe":case"galaxy":case"system":return d.jsx(xY,{id:e,type:n});case"planet":return d.jsx(bY,{id:e});case"construccion":return d.jsx(sj,{id:e});case"efectos":return d.jsxs("div",{className:"p-8 text-white",children:["Effect/Spell View for ID: ",id]});case"interaccion":return d.jsxs("div",{className:"p-8 text-white",children:["Interaction/Event View for ID: ",id]});case"magic":return d.jsxs("div",{className:"p-8 text-white",children:["Magic System View for ID: ",id]});default:return d.jsxs("div",{className:"p-8 text-white",children:["Unknown Entity Type: ",t]})}};return d.jsx("div",{className:"flex-1 bg-background-dark overflow-hidden",children:r()})},SY=()=>{var W,ne,ie;const{setRightPanelMode:t,setRightOpen:e,setRightPanelTitle:r}=jl(),[n,i]=q.useState([]),[a,s]=q.useState(null),[o,l]=q.useState([]),[c,u]=q.useState(!0);q.useState(!1);const[f,h]=q.useState(!1),[m,v]=q.useState({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0}),[y,x]=q.useState({nombre:"",descripcion:""}),[b,S]=q.useState(null);q.useState(null);const[w,k]=q.useState("eventos"),[N,j]=q.useState([]),[T,M]=q.useState([]),[A,_]=q.useState(null),D=kt.useRef(!1),R=async V=>{try{return(await Ne.get("/bd/relacion")).filter(ue=>ue.tipoOrigen==="lineatiempo"&&ue.idOrigen===V||ue.tipoDestino==="lineatiempo"&&ue.idDestino===V).map(ue=>ue.idOrigen===V?ue.idDestino:ue.idOrigen)}catch(Y){return console.error(Y),[]}},I=async(V,Y)=>{const te=await R(V),Z=Y.filter(ge=>te.includes(ge.id));j(Z);const ue=Y.filter(ge=>ge.id!==V&&!te.includes(ge.id));M(ue)},$=async V=>{if(!(!a||!V))try{await Ne.put("/bd/insertar",{tipoEntidad:"relacion",tipoOrigen:"lineatiempo",idOrigen:a,tipoDestino:"lineatiempo",idDestino:V,descripcion:"Anexo de lnea de tiempo"}),I(a,n)}catch(Y){console.error(Y)}},B=async V=>{const te=(await Ne.get("/bd/relacion")).find(Z=>Z.tipoOrigen==="lineatiempo"&&Z.idOrigen===a&&Z.idDestino===V||Z.tipoDestino==="lineatiempo"&&Z.idDestino===a&&Z.idOrigen===V);te&&(await Ne.delete(`/bd/relacion/${te.id}`),I(a,n))};q.useEffect(()=>{t("CUSTOM"),r("Lnea de Tiempo"),e(!0);const V=setInterval(()=>{const Y=document.getElementById("architect-right-panel-portal");Y&&(_(Y),clearInterval(V))},50);return()=>{clearInterval(V),t("NOTES"),r("")}},[]),q.useEffect(()=>{D.current||(D.current=!0,z())},[]),q.useEffect(()=>{a?(U(a),I(a,n),S(null),v({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0})):l([])},[a]),q.useEffect(()=>{if(w==="eventos"&&!b){const V=o.length>0?Math.max(...o.map(Y=>Y.ordenAbsoluto||0)):0;v(Y=>({...Y,ordenAbsoluto:V+1}))}},[w,o,b]);const z=async(V=null)=>{u(!0);try{const Y=await Ne.get("/timeline/list"),te=Y.find(Z=>Z.esRaiz);Y.length===0?(i([]),s(null)):(i(Y),V?s(V):a||s(te?te.id:Y[0].id))}catch(Y){console.error("Failed to load timelines",Y)}finally{u(!1)}},U=async V=>{try{const Y=await Ne.get(`/timeline/linea/${V}/eventos`);Y.sort((te,Z)=>(te.ordenAbsoluto||0)-(Z.ordenAbsoluto||0)),l(Y)}catch(Y){console.error("Failed to load events",Y)}},F=async()=>{if(!a||!m.nombre)return;const V={...m,ordenAbsoluto:parseInt(m.ordenAbsoluto)||0};try{b?await Ne.put(`/timeline/evento/${b.id}`,{...V,lineaTiempo:{id:a}}):await Ne.post("/timeline/evento",{...V,lineaTiempo:{id:a}}),v({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:0}),S(null),U(a)}catch(Y){console.error(Y)}},Q=V=>{S(V),v({nombre:V.nombre,descripcion:V.descripcion,fechaTexto:V.fechaTexto,ordenAbsoluto:V.ordenAbsoluto||0}),k("eventos"),e(!0)},K=async()=>{if(y.nombre)try{const V=await Ne.post("/timeline/linea",{...y,esRaiz:!1});h(!1),x({nombre:"",descripcion:""}),await z(V.id)}catch(V){console.error(V)}},[L,G]=q.useState({open:!1,type:null,id:null,title:"",message:""}),ee=(V,Y)=>{Y.stopPropagation(),G({open:!0,type:"TIMELINE",id:V,title:"Delete Timeline",message:"Are you sure you want to delete this timeline? All events will be lost."})},re=(V,Y)=>{Y.stopPropagation(),G({open:!0,type:"EVENT",id:V,title:"Delete Event",message:"Are you sure you want to delete this event?"})},se=async()=>{const{type:V,id:Y}=L;if(!(!V||!Y))try{if(V==="TIMELINE"){if(await Ne.delete(`/timeline/linea/${Y}`),a===Y){const te=n.filter(Z=>Z.id!==Y);s(te.length>0?te[0].id:null)}z()}else V==="EVENT"&&(await Ne.delete(`/timeline/evento/${Y}`),U(a),b&&b.id===Y&&S(null))}catch(te){console.error(te),alert("Error deleting item")}},de=d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"p-4 border-b border-white/5",children:d.jsxs("div",{className:"flex bg-black/40 rounded-lg p-1",children:[d.jsx("button",{onClick:()=>k("eventos"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${w==="eventos"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Eventos"}),d.jsx("button",{onClick:()=>k("anexos"),className:`flex-1 py-2 text-xs font-bold uppercase tracking-wider rounded-md transition-all ${w==="anexos"?"bg-primary text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Anexos"})]})}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[w==="eventos"&&d.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:d.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[d.jsxs("h3",{className:"text-xs font-black uppercase text-primary mb-4 flex items-center justify-between",children:[b?"Edit Event":"New Event",b&&d.jsx("button",{onClick:()=>{S(null),v({nombre:"",descripcion:"",fechaTexto:"",ordenAbsoluto:o.length+1})},className:"text-[10px] text-slate-500 hover:text-white underline",children:"CANCEL"})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Title"}),d.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:m.nombre,onChange:V=>v({...m,nombre:V.target.value}),placeholder:"Event Name"})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Date Label"}),d.jsx("input",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:m.fechaTexto,onChange:V=>v({...m,fechaTexto:V.target.value}),placeholder:"e.g. Year 500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Order (Sort)"}),d.jsx("input",{type:"text",className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary",value:m.ordenAbsoluto,onChange:V=>{const Y=V.target.value;/^[-+]?\d*$/.test(Y)&&v({...m,ordenAbsoluto:Y})},placeholder:"+/- Num"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] text-slate-500 uppercase font-bold mb-1 block",children:"Description"}),d.jsx("textarea",{className:"w-full bg-background-dark border border-white/10 rounded-lg p-2 text-sm text-white outline-none focus:border-primary h-24 resize-none",value:m.descripcion,onChange:V=>v({...m,descripcion:V.target.value}),placeholder:"Describe what happened..."})]}),d.jsx("div",{className:"pt-2",children:d.jsx(Wt,{variant:"primary",onClick:F,className:"w-full justify-center",children:b?"Save Changes":"Create Event"})}),b&&d.jsx("button",{onClick:V=>re(b.id,V),className:"w-full text-center text-xs text-red-500 hover:text-red-400 py-2 border border-red-500/20 rounded-lg hover:bg-red-500/10 transition-colors",children:"Delete Event"})]})]})}),w==="anexos"&&d.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4",children:d.jsxs("div",{className:"bg-black/20 rounded-xl p-4 border border-white/5",children:[d.jsx("h3",{className:"text-xs font-black uppercase text-primary mb-4",children:"Annexed Timelines"}),d.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Link other localized timelines to this one to verify chronological consistency."}),d.jsxs("div",{className:"space-y-2 mb-6",children:[N.map(V=>d.jsxs("div",{className:"flex items-center justify-between p-2 bg-white/5 rounded-lg border border-white/5",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-xs text-slate-400",children:"timeline"}),d.jsx("span",{className:"text-xs font-bold text-slate-300",children:V.nombre})]}),d.jsx("button",{onClick:()=>B(V.id),className:"text-slate-500 hover:text-red-500",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"link_off"})})]},V.id)),N.length===0&&d.jsx("span",{className:"text-xs text-slate-600 italic",children:"No linked timelines."})]}),d.jsx("h4",{className:"text-[10px] font-bold uppercase text-slate-400 mb-2",children:"Available to Link"}),d.jsxs("div",{className:"space-y-1",children:[T.map(V=>d.jsxs("button",{onClick:()=>$(V.id),className:"w-full flex items-center gap-2 p-2 hover:bg-white/5 rounded-lg text-left transition-colors group",children:[d.jsx("span",{className:"material-symbols-outlined text-xs text-green-500/50 group-hover:text-green-500",children:"add_link"}),d.jsx("span",{className:"text-xs text-slate-400 group-hover:text-white",children:V.nombre})]},V.id)),T.length===0&&d.jsx("span",{className:"text-xs text-slate-600 italic",children:"No other timelines available."})]})]})})]})]});return d.jsxs("div",{className:"flex h-screen bg-background-dark text-white overflow-hidden",children:[A&&ds.createPortal(de,A),d.jsxs("aside",{className:"w-64 bg-surface-dark border-r border-white/5 flex flex-col p-4 z-20 shrink-0",children:[d.jsxs("header",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-primary",children:"Timelines"}),d.jsx("button",{onClick:()=>h(!f),className:"text-slate-400 hover:text-white",children:d.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),f&&d.jsxs("div",{className:"mb-4 p-3 bg-black/20 rounded-xl space-y-2 border border-white/10 animate-in fade-in slide-in-from-left-2",children:[d.jsx("input",{className:"w-full bg-transparent border-b border-white/20 text-sm p-1 outline-none focus:border-primary",placeholder:"Name",value:y.nombre,onChange:V=>x({...y,nombre:V.target.value})}),d.jsx("div",{className:"flex justify-end",children:d.jsx("button",{onClick:K,className:"text-xs font-bold text-primary",children:"CREATE"})})]}),d.jsx("div",{className:"space-y-2 overflow-y-auto flex-1 custom-scrollbar",children:n.map(V=>d.jsxs("div",{onClick:()=>s(V.id),className:`group flex items-center justify-between p-3 rounded-xl cursor-pointer transition-all border ${a===V.id?"bg-primary/10 border-primary text-white shadow-[0_0_15px_rgba(var(--primary-rgb),0.1)]":"bg-transparent border-transparent hover:bg-white/5 text-slate-400"}`,children:[d.jsxs("div",{className:"flex items-center gap-2 truncate",children:[d.jsx("span",{className:`material-symbols-outlined text-sm shrink-0 ${V.esRaiz?"text-amber-400":""}`,children:V.esRaiz?"public":"timeline"}),d.jsx("span",{className:"text-xs font-bold uppercase tracking-wide truncate",children:V.nombre})]}),d.jsx("button",{onClick:Y=>ee(V.id,Y),className:"opacity-0 group-hover:opacity-100 text-slate-500 hover:text-red-500 transition-opacity",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},V.id))})]}),d.jsxs("main",{className:"flex-1 relative flex flex-col h-full overflow-hidden bg-background-dark",children:[d.jsx("div",{className:"h-16 border-b border-white/5 bg-background-dark/80 backdrop-blur flex items-center px-8 z-10 shrink-0",children:d.jsxs("div",{children:[d.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[((W=n.find(V=>V.id===a))==null?void 0:W.esRaiz)&&d.jsx("span",{className:"text-amber-400 material-symbols-outlined",children:"star"}),((ne=n.find(V=>V.id===a))==null?void 0:ne.nombre)||"Select Timeline"]}),d.jsx("p",{className:"text-xs text-slate-500",children:(ie=n.find(V=>V.id===a))==null?void 0:ie.descripcion})]})}),d.jsx("div",{className:"flex-1 overflow-y-auto p-8 relative custom-scrollbar z-10",children:d.jsxs("div",{className:"max-w-2xl mx-auto relative pl-8 border-l-2 border-white/10 space-y-8 pb-32",children:[o.length===0&&d.jsx("div",{className:"text-center text-slate-600 italic py-20",children:"No events yet. Use the right panel to add one."}),o.map((V,Y)=>d.jsxs("div",{className:"relative group animate-in fade-in slide-in-from-bottom-4",style:{animationDelay:`${Y*50}ms`},children:[d.jsx("div",{className:"absolute top-6 -left-[41px] size-4 rounded-full bg-white/20 border-4 border-background-dark group-hover:bg-primary transition-colors cursor-pointer",onClick:()=>Q(V)}),d.jsxs("div",{className:"ml-4 bg-surface-dark/50 border border-white/5 p-5 rounded-2xl hover:border-primary/30 transition-all hover:bg-surface-dark group-hover:translate-x-1 duration-300 relative group/card",children:[d.jsxs("div",{className:"absolute top-3 right-3 opacity-0 group-hover/card:opacity-100 transition-opacity flex gap-1 bg-black/50 rounded-lg backdrop-blur-sm border border-white/5 p-1",children:[d.jsx("button",{onClick:()=>Q(V),className:"p-1.5 text-slate-400 hover:text-white hover:bg-white/10 rounded transition-colors",title:"Edit",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),d.jsx("button",{onClick:te=>re(V.id,te),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-500/10 rounded transition-colors",title:"Delete",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]}),d.jsx("div",{className:"flex justify-between items-start",children:d.jsxs("div",{children:[d.jsxs("div",{className:"flex flex-col mb-1",children:[d.jsx("h3",{className:"text-lg font-bold text-white",children:V.nombre}),d.jsx("span",{className:"text-xs font-mono font-bold text-primary opacity-80",children:V.fechaTexto})]}),d.jsx("p",{className:"text-sm text-slate-400 leading-relaxed",children:V.descripcion})]})})]})]},V.id))]})})]}),d.jsx(Qp,{isOpen:L.open,onClose:()=>G({...L,open:!1}),onConfirm:se,title:L.title,message:L.message,confirmText:"Delete",type:"danger"})]})},kY=({onCancel:t,onCreate:e})=>{const[r,n]=q.useState(1),[i,a]=q.useState("regional"),[s,o]=q.useState("upload");return d.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-xl animate-in fade-in duration-300",children:d.jsx("div",{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto no-scrollbar relative animate-in zoom-in-95 duration-500",children:d.jsxs(Ct,{className:"p-0 border-white/10 shadow-[0_0_100px_rgba(0,0,0,0.5)] overflow-hidden",children:[d.jsxs("header",{className:"p-8 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"size-12 rounded-2xl bg-primary/20 text-primary flex items-center justify-center",children:d.jsx("span",{className:"material-symbols-outlined text-2xl",children:"add_location_alt"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-manrope font-black text-white tracking-tight",children:"Crear Nuevo Mapa / Zona"}),d.jsx("p",{className:"text-xs text-slate-500 font-medium",children:"Configura los detalles para tu nueva entrada cartogrfica."})]})]}),d.jsx("button",{onClick:t,className:"text-slate-500 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),d.jsxs("div",{className:"p-12 space-y-12",children:[d.jsxs("section",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===1?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"1"}),d.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Identidad y Jerarqua"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pl-12",children:[d.jsx(CY,{label:"Nombre del Mapa",placeholder:"ej. La Costa de Zafiro"}),d.jsxs("div",{className:"space-y-1.5 row-span-2",children:[d.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Descripcin"}),d.jsx("textarea",{placeholder:"Breve descripcin de la geografa, clima o importancia...",className:"w-full h-[120px] bg-white/5 border border-white/5 rounded-2xl p-4 text-sm text-white focus:border-primary/50 outline-none transition-all resize-none"})]}),d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:"Zona Padre (Opcional)"}),d.jsxs("select",{className:"w-full bg-white/5 border border-white/5 rounded-2xl px-4 py-3 text-sm text-white focus:border-primary/50 outline-none appearance-none",children:[d.jsx("option",{children:"Ninguna (Nivel Superior)"}),d.jsx("option",{children:"Reino de Aethelgard"}),d.jsx("option",{children:"Continente de Aurum"})]}),d.jsx("p",{className:"text-[9px] text-slate-500 italic mt-1 ml-1 text-primary/70",children:"Seleccionar un padre convierte esto en sub-zona."})]})]})]}),d.jsx("div",{className:"h-px w-full bg-white/5"}),d.jsxs("section",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===2?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"2"}),d.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Tipo de Mapa"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 pl-12",children:[d.jsx(H2,{active:i==="world",onClick:()=>a("world"),icon:"public",label:"Mapa Mundial",desc:"Continentes, ocanos, escala global."}),d.jsx(H2,{active:i==="regional",onClick:()=>a("regional"),icon:"map",label:"Mapa Regional",desc:"Reinos, provincias, biomas."}),d.jsx(H2,{active:i==="local",onClick:()=>a("local"),icon:"location_city",label:"Ciudad / Local",desc:"Ciudades, mazmorras, mapas de batalla."})]})]}),d.jsx("div",{className:"h-px w-full bg-white/5"}),d.jsxs("section",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`size-8 rounded-full flex items-center justify-center text-[10px] font-black ${r===3?"bg-primary text-white shadow-lg shadow-primary/30":"bg-white/10 text-slate-500"}`,children:"3"}),d.jsx("h2",{className:"text-sm font-black uppercase tracking-[0.2em] text-white",children:"Fuente del Lienzo"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pl-12",children:[d.jsx(oj,{active:s==="upload",onClick:()=>o("upload"),icon:"cloud_upload",label:"Cargar Archivo de Imagen",desc:"Arrastra y suelta o haz clic para buscar",subdesc:"JPG, PNG, WEBP  MAX 25MB"}),d.jsx(oj,{active:s==="blank",onClick:()=>o("blank"),icon:"brush",label:"Lienzo en Blanco",desc:"Crear un nuevo dibujo desde cero",subdesc:"4096 px x 4096 px"})]})]})]}),d.jsxs("footer",{className:"p-8 bg-white/[0.02] border-t border-white/5 flex justify-between items-center",children:[d.jsx("button",{onClick:t,className:"text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"Cancelar"}),d.jsxs("div",{className:"flex items-center gap-6",children:[d.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-600",children:"Cambios guardados localmente"}),d.jsx(Wt,{variant:"primary",className:"px-10 py-3 shadow-xl",onClick:()=>e(s),children:"Crear Mapa"})]})]})]})})})},CY=({label:t,placeholder:e})=>d.jsxs("div",{className:"space-y-1.5",children:[d.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 ml-1",children:t}),d.jsx("input",{type:"text",placeholder:e,className:"w-full bg-white/5 border border-white/5 rounded-2xl px-4 py-3 text-sm text-white focus:border-primary/50 transition-all outline-none"})]}),H2=({active:t,onClick:e,icon:r,label:n,desc:i})=>d.jsxs("div",{onClick:e,className:`p-6 rounded-3xl border transition-all cursor-pointer group ${t?"bg-primary/10 border-primary shadow-lg shadow-primary/10":"bg-white/5 border-white/5 hover:border-white/10"}`,children:[d.jsx("div",{className:`size-10 rounded-xl mb-4 flex items-center justify-center transition-all ${t?"bg-primary text-white":"bg-white/5 text-slate-500 group-hover:text-slate-300"}`,children:d.jsx("span",{className:"material-symbols-outlined",children:r})}),d.jsx("h3",{className:`text-sm font-bold mb-1 transition-colors ${t?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:n}),d.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-medium",children:i})]}),oj=({active:t,onClick:e,icon:r,label:n,desc:i,subdesc:a})=>d.jsxs("div",{onClick:e,className:`p-10 rounded-[2.5rem] border transition-all cursor-pointer group flex flex-col items-center text-center gap-4 ${t?"bg-primary/5 border-primary shadow-lg":"bg-white/[0.02] border-white/5 hover:border-white/10 hover:bg-white/[0.04]"}`,children:[d.jsx("div",{className:`size-16 rounded-[2rem] flex items-center justify-center transition-all ${t?"bg-primary text-white shadow-xl shadow-primary/20":"bg-white/5 text-slate-600 group-hover:text-slate-400"}`,children:d.jsx("span",{className:"material-symbols-outlined text-3xl",children:r})}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("h3",{className:`font-bold transition-colors ${t?"text-white":"text-slate-400"}`,children:n}),d.jsx("p",{className:"text-xs text-slate-500 font-medium",children:i})]}),d.jsx("div",{className:"flex gap-2 mt-2",children:a.split("").map((s,o)=>d.jsx("span",{className:"px-2 py-1 rounded bg-black/20 text-[8px] font-black text-slate-600 tracking-tighter uppercase whitespace-nowrap",children:s.trim()},o))})]}),NY=({mapTitle:t="Reino de Aethelgard",onSave:e,onBack:r})=>{const[n,i]=q.useState(100),[a,s]=q.useState(24),[o,l]=q.useState("#000000"),[c,u]=q.useState("brush"),[f,h]=q.useState(1),[m,v]=q.useState([{id:1,name:"Terreno Base",visible:!0,locked:!1,type:"raster"},{id:2,name:"Ros y Lagos",visible:!0,locked:!1,type:"vector"}]),y=kt.useRef(null),[x,b]=q.useState(!1),S=[{id:"select",icon:"near_me"},{id:"brush",icon:"brush"},{id:"eraser",icon:"ink_eraser"},{id:"fill",icon:"format_color_fill"},{id:"measure",icon:"straighten"},{id:"text",icon:"title"}],w=()=>{var R;return(R=y.current)==null?void 0:R.getContext("2d")},k=R=>{const I=m.find(B=>B.id===f);if(!I||!I.visible||I.locked)return;const $=w();$&&(b(!0),$.beginPath(),$.moveTo(R.nativeEvent.offsetX,R.nativeEvent.offsetY),$.lineWidth=a,$.lineCap="round",$.lineJoin="round",$.globalAlpha=n/100,c==="eraser"?$.globalCompositeOperation="destination-out":($.globalCompositeOperation="source-over",$.strokeStyle=o))},N=R=>{if(!x)return;const I=w();I&&(I.lineTo(R.nativeEvent.offsetX,R.nativeEvent.offsetY),I.stroke())},j=()=>{var R;x&&(b(!1),(R=w())==null||R.closePath())},T=R=>{v(I=>I.map($=>$.id===R?{...$,visible:!$.visible}:$))},M=R=>{v(I=>I.map($=>$.id===R?{...$,locked:!$.locked}:$))},A=()=>{const R={id:Date.now(),name:`Capa ${m.length+1}`,visible:!0,locked:!1,type:"raster"};v([R,...m]),h(R.id)},_=R=>{m.length<=1||(v(I=>I.filter($=>$.id!==R)),f===R&&h(m[0].id))},D=(R=!0)=>{var $;const I=($=y.current)==null?void 0:$.toDataURL();console.log("Saving Map Data:",I?"Data present":"Empty"),R&&e&&e(I)};return d.jsxs("div",{className:"flex-1 flex flex-col bg-[#050508] text-slate-300 font-sans h-full overflow-hidden relative",children:[d.jsxs("header",{className:"h-20 flex-none border-b border-white/5 flex items-center justify-between px-8 bg-surface-dark/80 backdrop-blur-md z-30",children:[d.jsxs("div",{className:"flex items-center gap-6",children:[d.jsx("button",{onClick:r,className:"p-2 rounded-xl bg-white/5 hover:bg-white/10 transition-colors",children:d.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),d.jsx("div",{className:"w-px h-8 bg-white/10"}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-bold text-white tracking-tight",children:t}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"size-1.5 rounded-full bg-primary"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Guardado localmente"})]})]})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("button",{onClick:r,className:"px-4 py-2 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 text-xs font-bold uppercase tracking-widest transition-all",children:"Cancelar"}),d.jsxs("div",{className:"flex bg-white/5 rounded-xl p-1 gap-1 border border-white/10",children:[d.jsxs("button",{onClick:()=>D(!0),className:"h-9 px-4 rounded-lg bg-primary hover:bg-primary-light text-white text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar"]}),d.jsx("div",{className:"w-px bg-white/10 my-1"}),d.jsx("button",{onClick:()=>D(!1),className:"h-9 px-3 rounded-lg bg-transparent hover:bg-white/10 text-white transition-all flex items-center justify-center",title:"Guardar y Seguir Editando",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit_document"})})]})]})]}),d.jsxs("div",{className:"flex-1 flex relative overflow-hidden",children:[d.jsx("aside",{className:"absolute left-8 top-1/2 -translate-y-1/2 z-40",children:d.jsxs(Ct,{className:"p-2 flex flex-col gap-2 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[S.map(R=>d.jsx("button",{onClick:()=>u(R.id),className:`size-12 rounded-xl flex items-center justify-center transition-all ${c===R.id?"bg-primary text-white shadow-lg shadow-primary/30":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:R.icon})},R.id)),d.jsx("div",{className:"w-8 h-px bg-white/10 mx-auto my-1"}),d.jsxs("div",{className:"relative group",children:[d.jsx("input",{type:"color",value:o,onChange:R=>l(R.target.value),className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full"}),d.jsx("div",{className:"size-12 rounded-xl flex items-center justify-center cursor-pointer",children:d.jsx("div",{className:"size-7 rounded-full border-2 border-white/20 shadow-inner group-hover:scale-110 transition-transform",style:{backgroundColor:o}})})]})]})}),d.jsxs("main",{className:"flex-1 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-repeat relative overflow-hidden flex items-center justify-center p-20 no-scrollbar",children:[d.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:"radial-gradient(circle, white 1px, transparent 1px)",backgroundSize:"30px 30px"}}),d.jsxs("div",{className:"relative group animate-in zoom-in-95 duration-700",children:[d.jsx("p",{className:"absolute -top-10 left-0 text-[10px] font-black uppercase tracking-[0.2em] text-slate-600",children:"Lienzo: 800x600px  RGB"}),d.jsx("div",{className:"relative bg-white rounded shadow-[0_0_100px_rgba(0,0,0,0.5)] overflow-hidden border border-white/10 cursor-crosshair",children:d.jsx("canvas",{ref:y,width:800,height:600,onMouseDown:k,onMouseMove:N,onMouseUp:j,onMouseLeave:j})})]})]}),d.jsxs("aside",{className:"absolute right-8 top-1/2 -translate-y-1/2 z-40 flex flex-col gap-6 w-80",children:[d.jsxs(Ct,{className:"p-6 space-y-6 rounded-3xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[d.jsxs("header",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Propiedades"}),d.jsx("button",{className:"text-slate-600 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"settings_input_component"})})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Tamao del Pincel"}),d.jsxs("span",{className:"text-xs font-black text-white",children:[a,"px"]})]}),d.jsx("input",{type:"range",min:"1",max:"100",value:a,onChange:R=>s(R.target.value),className:"w-full accent-primary h-1 bg-white/5 rounded-full appearance-none cursor-pointer"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Opacidad"}),d.jsxs("span",{className:"text-xs font-black text-white",children:[n,"%"]})]}),d.jsx("input",{type:"range",min:"0",max:"100",value:n,onChange:R=>i(R.target.value),className:"w-full accent-primary h-1 bg-white/5 rounded-full appearance-none cursor-pointer"})]})]})]}),d.jsxs(Ct,{className:"p-6 space-y-6 rounded-3xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl flex-1 max-h-[400px] overflow-hidden flex flex-col",children:[d.jsxs("header",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Capas"}),d.jsx("div",{className:"flex gap-2 text-slate-600",children:d.jsx("button",{onClick:A,className:"hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})})]}),d.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar space-y-2",children:m.map(R=>d.jsxs("div",{onClick:()=>h(R.id),className:`flex items-center gap-3 p-3 rounded-2xl transition-all cursor-pointer group select-none ${f===R.id?"bg-primary/10 border border-primary/20":"bg-transparent border border-transparent hover:bg-white/5"}`,children:[d.jsx("button",{onClick:I=>{I.stopPropagation(),T(R.id)},className:`material-symbols-outlined text-lg ${R.visible?"text-slate-500 hover:text-white":"text-slate-700"}`,children:R.locked?"lock":R.visible?"visibility":"visibility_off"}),d.jsx("div",{className:"size-10 rounded-lg bg-surface-light border border-white/5 flex items-center justify-center overflow-hidden",children:d.jsx("span",{className:"material-symbols-outlined opacity-30 text-xl",children:R.type==="raster"?"texture":"water_drop"})}),d.jsx("div",{className:"flex-1 min-w-0",children:d.jsx("p",{className:`text-xs font-bold truncate ${f===R.id?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:R.name})}),d.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[d.jsx("button",{onClick:I=>{I.stopPropagation(),M(R.id)},className:"material-symbols-outlined text-sm text-slate-700 hover:text-white transition-colors",children:R.locked?"lock_open":"lock"}),d.jsx("button",{onClick:I=>{I.stopPropagation(),_(R.id)},className:"material-symbols-outlined text-sm text-red-900/50 hover:text-red-400 transition-colors",children:"delete"})]})]},R.id))})]})]}),d.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-40",children:d.jsxs(Ct,{className:"px-6 py-3 flex items-center gap-8 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[d.jsxs("div",{className:"flex items-center gap-4 text-slate-500 border-r border-white/10 pr-6",children:[d.jsx("button",{className:"hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined",children:"undo"})}),d.jsx("button",{className:"hover:text-white transition-colors opacity-30 cursor-not-allowed",children:d.jsx("span",{className:"material-symbols-outlined",children:"redo"})})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined",children:"remove"})}),d.jsx("span",{className:"text-[10px] font-black text-white w-10 text-center",children:"100%"}),d.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined",children:"add"})})]})]})})]})]})},EY=({map:t})=>{const[e,r]=q.useState(null);t!=null&&t.nombre;const n=[{id:1,name:"Torre Carmes",type:"location",x:"45%",y:"42%",color:"bg-primary"},{id:2,name:"Costa de Zafiro",type:"region",x:"55%",y:"35%",color:"bg-cyan-500"},{id:3,name:"Pramos de Hierro",type:"danger",x:"62%",y:"58%",color:"bg-amber-500"}];return d.jsxs("div",{className:"flex-1 flex overflow-hidden bg-background-dark font-sans text-slate-300 relative",children:[d.jsxs("main",{className:"flex-1 overflow-hidden relative group",children:[d.jsxs("div",{className:"absolute inset-4 rounded-[2.5rem] overflow-hidden border border-white/5 shadow-2xl bg-surface-dark",children:[d.jsx("img",{src:"https://images.unsplash.com/photo-1521295121783-8a321d551ad2?auto=format&fit=crop&w=2000&q=80",alt:"Background Map",className:"w-full h-full object-cover opacity-60 mix-blend-luminosity grayscale-[0.2]"}),d.jsx("div",{className:"absolute inset-0",children:n.map(i=>d.jsx("div",{onClick:()=>r(i),className:`absolute size-10 -translate-x-1/2 -translate-y-1/2 cursor-pointer transition-all hover:scale-125 z-10 ${(e==null?void 0:e.id)===i.id?"scale-125":""}`,style:{left:i.x,top:i.y},children:d.jsxs("div",{className:`size-full rounded-2xl ${i.color} border-4 border-background-dark shadow-[0_0_20px_rgba(0,0,0,0.5)] flex items-center justify-center text-white relative group/marker`,children:[d.jsx("span",{className:"material-symbols-outlined text-lg",children:i.type==="location"?"fort":i.type==="region"?"terrain":"skull"}),d.jsx("div",{className:"absolute top-12 left-1/2 -translate-x-1/2 px-3 py-1.5 rounded-lg bg-surface-dark border border-white/10 text-[9px] font-black uppercase tracking-widest text-white whitespace-nowrap opacity-0 group-hover/marker:opacity-100 transition-opacity",children:i.name}),d.jsx("div",{className:`absolute -inset-2 rounded-[1.5rem] opacity-20 animate-ping -z-10 ${i.color}`})]})},i.id))})]}),d.jsx("aside",{className:"absolute left-12 top-1/2 -translate-y-1/2 z-20 flex flex-col gap-4",children:d.jsxs(Ct,{className:"p-2 flex flex-col gap-2 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[d.jsx(ah,{icon:"near_me",active:!0}),d.jsx(ah,{icon:"location_on"}),d.jsx(ah,{icon:"brush"}),d.jsx(ah,{icon:"layers"}),d.jsx("div",{className:"w-8 h-px bg-white/10 mx-auto my-1"}),d.jsx(ah,{icon:"tune"})]})}),d.jsx("div",{className:"absolute bottom-12 left-12 z-20 px-4 py-2 rounded-xl bg-black/40 border border-white/10 backdrop-blur-md text-[10px] font-black tracking-widest text-slate-400",children:"125%"})]}),d.jsx("aside",{className:`flex-none bg-surface-dark border-l border-white/5 transition-all duration-700 relative z-30 ${e?"w-96 p-8 opacity-100":"w-0 p-0 opacity-0 overflow-hidden"}`,children:e&&d.jsxs("div",{className:"flex flex-col h-full gap-8 animate-in slide-in-from-right-8 duration-500",children:[d.jsxs("header",{className:"space-y-6",children:[d.jsxs("div",{className:"relative aspect-[4/3] rounded-3xl overflow-hidden border border-white/10 shadow-xl group",children:[d.jsx("img",{src:"https://images.unsplash.com/photo-1533154683836-84ea7a0bc310?auto=format&fit=crop&w=500&q=80",alt:"Detail",className:"w-full h-full object-cover grayscale-[0.4] group-hover:grayscale-0 transition-all duration-700"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background-dark via-transparent to-transparent"}),d.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:d.jsx("button",{onClick:()=>r(null),className:"size-8 rounded-lg bg-black/40 border border-white/10 backdrop-blur-md text-white flex items-center justify-center hover:bg-black/60 transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})}),d.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[d.jsx("span",{className:"px-3 py-1 rounded bg-primary/20 text-primary border border-primary/20 text-[8px] font-black uppercase tracking-widest backdrop-blur-md",children:"Lugar"}),d.jsx("span",{className:"px-3 py-1 rounded bg-emerald-500/20 text-emerald-400 border border-emerald-500/20 text-[8px] font-black uppercase tracking-widest backdrop-blur-md",children:"Capital"})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("h2",{className:"text-3xl font-manrope font-black text-white tracking-tight leading-none",children:e.name}),d.jsx("button",{className:"text-slate-500 hover:text-white transition-colors p-2 rounded-xl hover:bg-white/5",children:d.jsx("span",{className:"material-symbols-outlined",children:"edit"})})]}),d.jsx("p",{className:"text-sm text-slate-400 leading-relaxed font-manrope",children:"La antigua sede de los Magos de Fuego, erigida sobre la caldera inactiva del Monte Ignis. Sus muros estn imbuidos de magia protectora."})]})]}),d.jsxs("div",{className:"space-y-8 flex-1 overflow-y-auto no-scrollbar",children:[d.jsxs("section",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center px-1",children:[d.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Habitantes Clave"}),d.jsx("button",{className:"text-[10px] font-bold text-primary hover:underline transition-all",children:"Ver todos"})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx(lj,{name:"Lyra Ignis",role:"Gran Maga"}),d.jsx(lj,{name:"Kaelen",role:"Capitn de la Guardia"})]})]}),d.jsxs("section",{className:"space-y-4",children:[d.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 px-1",children:"Eventos Relacionados"}),d.jsx(Ct,{className:"p-4 border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:d.jsxs("div",{className:"flex gap-4 items-center",children:[d.jsx("div",{className:"size-10 rounded-xl bg-amber-500/10 text-amber-500 border border-amber-500/20 flex items-center justify-center",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"history_edu"})}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-xs font-bold text-white group-hover:text-primary transition-colors",children:"El Asedio de Ceniza"}),d.jsx("p",{className:"text-[10px] text-slate-500 font-medium",children:"Hace 300 aos"})]})]})})]})]}),d.jsx("footer",{className:"pt-6 border-t border-white/5",children:d.jsx(Wt,{variant:"primary",icon:"auto_stories",className:"w-full py-4 rounded-2xl shadow-xl shadow-primary/20",children:"Abrir en la Biblia"})})]})})]})},ah=({icon:t,active:e})=>d.jsx("button",{className:`size-12 rounded-xl flex items-center justify-center transition-all ${e?"bg-primary text-white shadow-lg shadow-primary/30":"text-slate-500 hover:text-white hover:bg-white/5"}`,children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:t})}),lj=({name:t,role:e})=>d.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-2xl bg-white/[0.02] border border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:[d.jsx(b0,{name:t,size:"sm",className:"border-white/10 group-hover:border-primary/50 transition-all"}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h4",{className:"text-xs font-bold text-white truncate",children:t}),d.jsx("p",{className:"text-[10px] text-slate-500 font-medium truncate",children:e})]}),d.jsx("span",{className:"material-symbols-outlined text-slate-700 text-sm group-hover:text-white transition-colors",children:"chevron_right"})]}),TY=({maps:t,onSelect:e,onCreateNew:r,onClose:n})=>d.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-background-dark/80 backdrop-blur-xl animate-in fade-in duration-300",children:d.jsx("div",{className:"w-full max-w-3xl animate-in zoom-in-95 duration-500",children:d.jsxs(Ct,{className:"overflow-hidden border-white/10 shadow-2xl",children:[d.jsxs("header",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"material-symbols-outlined text-primary",children:"map"}),d.jsx("h2",{className:"text-xl font-manrope font-black text-white",children:"Cartografa del Proyecto"})]}),d.jsx("button",{onClick:n,className:"text-slate-500 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),d.jsxs("div",{className:"p-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-[60vh] overflow-y-auto custom-scrollbar",children:[d.jsxs("div",{onClick:r,className:"group p-6 rounded-2xl border-2 border-dashed border-white/5 hover:border-primary/50 hover:bg-primary/5 transition-all cursor-pointer flex flex-col items-center justify-center text-center gap-3",children:[d.jsx("div",{className:"size-12 rounded-full bg-primary/10 text-primary flex items-center justify-center group-hover:scale-110 transition-transform",children:d.jsx("span",{className:"material-symbols-outlined",children:"add"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-bold text-white",children:"Nuevo Mapa"}),d.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-tighter",children:"Crear desde cero"})]})]}),t.map(i=>d.jsxs("div",{onClick:()=>e(i),className:"group p-4 rounded-2xl bg-white/5 border border-white/5 hover:border-primary/50 hover:bg-white/10 transition-all cursor-pointer space-y-3",children:[d.jsx("div",{className:"aspect-video rounded-xl bg-surface-light border border-white/5 flex items-center justify-center overflow-hidden",children:d.jsx("span",{className:"material-symbols-outlined text-4xl opacity-20 group-hover:opacity-40 transition-opacity",children:"image"})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-bold text-white truncate",children:i.nombre}),d.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-black tracking-tighter",children:"ltima edicin: Reciente"})]})]},i.id))]}),d.jsx("footer",{className:"p-6 bg-white/[0.02] border-t border-white/5 flex justify-end",children:d.jsx("p",{className:"text-[10px] text-slate-600 font-bold uppercase tracking-widest",children:"Selecciona un mapa para cargar el visor"})})]})})}),jY=()=>{const[t,e]=q.useState("viewer"),[r,n]=q.useState([]),[i,a]=q.useState(null),[s,o]=q.useState(!1);q.useEffect(()=>{l()},[]);const l=async()=>{try{const f=(await Ne.get("/world-bible/entities")).filter(h=>h.tipoEspecial==="map");n(f),f.length>0&&!i&&a(f[0])}catch(u){console.error("Error loading maps",u)}},c=u=>{u==="blank"?e("editor"):(l(),e("viewer"))};return d.jsxs("div",{className:"flex-1 flex flex-col h-full bg-background-dark overflow-hidden",children:[t==="viewer"&&d.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[d.jsx("button",{onClick:()=>o(!0),className:"absolute right-12 bottom-12 z-50 size-16 rounded-3xl bg-primary text-white flex items-center justify-center shadow-2xl shadow-primary/40 hover:scale-110 active:scale-95 transition-all group",children:d.jsx("span",{className:"material-symbols-outlined text-3xl group-hover:rotate-90 transition-transform duration-300",children:"add"})}),d.jsx(EY,{map:i}),s&&d.jsx(TY,{maps:r,onSelect:u=>{a(u),o(!1)},onCreateNew:()=>{o(!1),e("wizard")},onClose:()=>o(!1)})]}),t==="wizard"&&d.jsx(kY,{onCancel:()=>e("viewer"),onCreate:c}),t==="editor"&&d.jsx(NY,{onBack:()=>e("viewer"),onSave:()=>e("viewer")})]})},MY=()=>{const[t,e]=q.useState("Loading..."),[r,n]=q.useState({words:0,rules:0,glyphs:0}),[i,a]=q.useState("Standard Tongue");q.useEffect(()=>{s()},[]);const s=async()=>{try{const o=await Ne.get("/bd/proyecto-activo");e(o.nombreProyecto);const l=await Ne.get("/conlang/stats");n(l);const c=await Ne.get("/conlang/lenguas");c&&c.length>0&&a(c[0].nombre)}catch(o){console.error("Error loading conlang data:",o),e("Default Project")}};return d.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#0a0a0f] text-slate-300 font-sans overflow-y-auto no-scrollbar p-12 lg:p-16 gap-16",children:[d.jsxs("header",{className:"space-y-6",children:[d.jsxs("nav",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-slate-500",children:[d.jsx("span",{children:t}),d.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),d.jsxs("span",{className:"text-white",children:["Conlang: ",i]})]}),d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{className:"space-y-4 max-w-2xl",children:[d.jsx("h1",{className:"text-6xl font-manrope font-black text-white tracking-tight",children:i}),d.jsxs("p",{className:"text-lg text-slate-400 leading-relaxed",children:["A conlang belonging to ",t,". Manage its lexicon, grammar rules, and writing systems here."]}),d.jsxs("div",{className:"flex gap-4 pt-2",children:[d.jsx("span",{className:"px-3 py-1 rounded bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 text-[9px] font-black uppercase tracking-widest",children:"Complete: 45%"}),d.jsx("span",{className:"px-3 py-1 rounded bg-primary/10 text-primary border border-primary/20 text-[9px] font-black uppercase tracking-widest",children:"Type: Agglutinative"})]})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("div",{className:"flex items-center gap-3 text-slate-500 border-r border-white/5 pr-6 mr-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm animate-pulse text-emerald-500",children:"save"}),d.jsx("span",{className:"text-[10px] font-bold",children:"Auto-Saved"}),d.jsx("span",{className:"material-symbols-outlined hover:text-white transition-colors cursor-pointer",children:"dark_mode"})]}),d.jsx(Wt,{variant:"primary",icon:"add",size:"md",children:"Create Element"})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-12",children:[d.jsxs("section",{className:"xl:col-span-2 space-y-8",children:[d.jsxs("div",{className:"flex justify-between items-center px-2",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"menu_book"}),d.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Lexicon"})]}),d.jsxs("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest hover:text-primary transition-all cursor-pointer",children:["View All (",r.words,")"]})]}),d.jsxs(Ct,{className:"p-0 border-white/5 bg-surface-dark/40 overflow-hidden shadow-2xl",children:[d.jsxs("div",{className:"p-4 border-b border-white/5 flex items-center gap-4",children:[d.jsxs("div",{className:"flex-1 relative",children:[d.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 text-lg",children:"search"}),d.jsx("input",{type:"text",placeholder:"Search word or meaning...",className:"w-full bg-white/5 border border-white/5 rounded-2xl py-3 pl-12 pr-4 text-xs focus:ring-1 focus:ring-primary/30 outline-none transition-all"})]}),d.jsx("button",{className:"size-10 rounded-xl bg-white/5 border border-white/5 flex items-center justify-center text-slate-500 hover:text-white transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"tune"})})]}),d.jsxs("div",{className:"p-6 space-y-4",children:[d.jsx(W2,{word:"Ael'or",type:"noun",gender:"neutral",def:"Starlight; specifically the light from the twin moons."}),d.jsx(W2,{word:"Vexi",type:"verb",gender:"transitive",def:"To weave magic; to create something from nothing."}),d.jsx(W2,{word:"Dra'kan",type:"adj",gender:"",def:"Ancient; belonging to the era of dragons."})]}),d.jsx("div",{className:"p-6 bg-black/20 border-t border-white/5",children:d.jsxs("button",{className:"w-full py-4 rounded-3xl border-2 border-dashed border-white/5 text-slate-600 hover:text-white hover:border-primary/50 hover:bg-primary/5 transition-all text-[10px] font-black uppercase tracking-[0.2em] flex items-center justify-center gap-3",children:[d.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Add New Word"]})})]})]}),d.jsxs("section",{className:"space-y-8",children:[d.jsxs("div",{className:"flex justify-between items-center px-2",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"architecture"}),d.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Grammar Rules"})]}),d.jsx("span",{className:"text-[10px] font-bold text-slate-600 uppercase tracking-widest hover:text-primary transition-all cursor-pointer",children:"Manage"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx(cj,{title:"Sentence Structure",status:"active",statusColor:"emerald",desc:"Standard order is SOV (Subject-Object-Verb), but poetry uses VSO for emphasis on action.",tags:["Syntax","Basic"]}),d.jsx(cj,{title:"Noun Declensions",status:"pending",statusColor:"amber",desc:"Seven cases marked by suffixes. Pluralization shifts the stress to the final syllable.",tags:["Morphology"]}),d.jsxs("button",{className:"w-full h-32 rounded-[2.5rem] border-2 border-dashed border-white/5 flex flex-col items-center justify-center gap-2 text-slate-600 hover:text-white hover:border-primary/30 hover:bg-primary/5 transition-all",children:[d.jsx("span",{className:"material-symbols-outlined",children:"add_circle"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Define New Rule"})]})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-12",children:[d.jsxs("section",{className:"space-y-8",children:[d.jsxs("div",{className:"flex justify-between items-center px-2",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"draw"}),d.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Writing System"})]}),d.jsxs("div",{className:"flex gap-2 text-slate-600",children:[d.jsx("button",{className:"p-1 rounded hover:bg-white/5 hover:text-white",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_view"})}),d.jsx("button",{className:"p-1 rounded hover:bg-white/5 hover:text-white",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"title"})})]})]}),d.jsxs(Ct,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-8 shadow-2xl",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-2xl font-black text-white tracking-tight mb-1",children:"Moon Script"}),d.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest",children:"Abugida  Left-to-Right"})]}),d.jsx(Wt,{variant:"secondary",size:"sm",className:"bg-primary/10 border-primary/20 text-primary",children:"Open Editor"})]}),d.jsxs("div",{className:"grid grid-cols-6 gap-3",children:[["","","","",""].map(o=>d.jsx("div",{className:"aspect-square rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-3xl font-serif text-white hover:bg-white/10 transition-all cursor-pointer",children:o},o)),d.jsx("div",{className:"aspect-square rounded-2xl border-2 border-dashed border-white/5 flex items-center justify-center text-slate-600 hover:border-primary/50 hover:text-white transition-all cursor-pointer",children:d.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"flex justify-between text-[8px] font-black uppercase tracking-widest text-slate-600",children:[d.jsx("span",{children:"Glyph Set"}),d.jsx("span",{children:"24/32 Completed"})]}),d.jsx("div",{className:"h-1.5 w-full bg-white/5 rounded-full overflow-hidden",children:d.jsx("div",{className:"h-full bg-primary w-[75%] rounded-full shadow-[0_0_10px_rgba(99,102,242,0.5)]"})})]})]})]}),d.jsxs("section",{className:"space-y-8",children:[d.jsxs("div",{className:"flex items-center gap-3 px-2",children:[d.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"graphic_eq"}),d.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Translator & Phonology"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[d.jsxs(Ct,{className:"p-8 border-primary/20 bg-primary/5 rounded-[3rem] space-y-6 shadow-2xl shadow-primary/10",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-primary",children:"Live Logographic Stream"}),d.jsx("span",{className:"material-symbols-outlined text-primary animate-pulse",children:"sync_alt"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("input",{type:"text",placeholder:"Source text here...",className:"w-full bg-black/40 border border-white/10 rounded-2xl p-4 text-xs font-bold text-white focus:border-primary/50 outline-none transition-all"}),d.jsxs("div",{className:"h-24 rounded-2xl bg-black/60 border border-white/5 flex items-center justify-center relative overflow-hidden group",children:[d.jsx("span",{className:"text-5xl font-serif text-white opacity-40 group-hover:opacity-100 transition-opacity",children:"   "}),d.jsx("div",{className:"absolute top-2 right-4 text-[7px] font-black uppercase tracking-widest text-slate-700",children:"Rendered Output"})]})]})]}),d.jsxs(Ct,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-6",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Vowel Inventory"}),d.jsx("button",{className:"text-primary text-lg",children:d.jsx("span",{className:"material-symbols-outlined",children:"add"})})]}),d.jsx("div",{className:"flex flex-wrap gap-2",children:["/a/","/e/","/i/","/o/","/u/","/y/"].map(o=>d.jsx("div",{className:"px-3 py-1.5 rounded-xl bg-white/5 border border-white/5 text-[11px] font-mono font-bold text-slate-300 hover:text-white transition-colors cursor-pointer",children:o},o))})]}),d.jsxs(Ct,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[3rem] space-y-6",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Vector Symbols"}),d.jsx("button",{className:"text-[8px] font-bold text-primary hover:underline transition-all",children:"Upload SVG"})]}),d.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[[{id:1,icon:"filter_vintage"},{id:2,icon:"auto_awesome"},{id:3,icon:"infinite"}].map(o=>d.jsx("div",{className:"aspect-square rounded-2xl bg-white/5 border border-white/5 flex items-center justify-center text-slate-400 hover:text-white transition-all cursor-pointer",children:d.jsx("span",{className:"material-symbols-outlined text-2xl",children:o.icon})},o.id)),d.jsxs("div",{className:"aspect-square rounded-2xl border-2 border-dashed border-white/5 flex flex-col items-center justify-center text-slate-700 hover:border-primary/50 hover:text-white transition-all cursor-pointer",children:[d.jsx("span",{className:"material-symbols-outlined text-lg",children:"cloud_upload"}),d.jsx("span",{className:"text-[7px] font-bold uppercase mt-1",children:"Add"})]})]})]})]})]})]})]})},W2=({word:t,type:e,gender:r,def:n})=>d.jsxs("div",{className:"p-4 rounded-2xl border border-transparent hover:bg-white/5 hover:border-white/5 transition-all group cursor-pointer relative",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[d.jsx("h4",{className:"text-xl font-manrope font-black text-white group-hover:text-primary transition-colors",children:t}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("span",{className:"text-[9px] font-bold text-slate-600 italic",children:e}),r&&d.jsxs("span",{className:"text-[9px] font-bold text-slate-700 uppercase",children:["(",r,")"]})]})]}),d.jsx("p",{className:"text-sm text-slate-400 leading-relaxed font-manrope",children:n}),d.jsx("button",{className:"absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity p-2 text-slate-600 hover:text-white",children:d.jsx("span",{className:"material-symbols-outlined",children:"edit_note"})})]}),cj=({title:t,status:e,statusColor:r,desc:n,tags:i})=>d.jsxs(Ct,{className:"p-8 border-white/5 hover:border-white/10 transition-all cursor-pointer group space-y-4",children:[d.jsxs("header",{className:"flex justify-between items-start",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:`size-2 rounded-full bg-${r}-500 shadow-[0_0_10px_rgba(var(--${r}-rgb),0.5)]`}),d.jsx("h4",{className:"font-bold text-white group-hover:text-primary transition-colors",children:t})]}),d.jsx("button",{className:"text-slate-700 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})]}),d.jsx("p",{className:"text-[11px] text-slate-500 leading-relaxed font-manrope",children:n}),d.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(a=>d.jsx("span",{className:"px-2 py-0.5 rounded bg-white/5 border border-white/5 text-[8px] font-black uppercase tracking-widest text-slate-600",children:a},a))})]}),PY=()=>d.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#050B0D] text-[#00E5FF] font-mono overflow-hidden",children:[d.jsxs("header",{className:"h-20 border-b border-[#00E5FF]/20 flex items-center justify-between px-10 bg-black/40 backdrop-blur-xl",children:[d.jsxs("div",{className:"flex items-center gap-10",children:[d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"text-[10px] opacity-40 uppercase tracking-[0.4em] font-bold",children:"Datastream_Nav"}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"material-symbols-outlined text-2xl",children:"language"}),d.jsx("span",{className:"text-2xl font-black italic tracking-tighter",children:"Chronos Atlas"})]})]}),d.jsxs("div",{className:"flex items-center gap-4 border-l border-[#00E5FF]/20 pl-10",children:[d.jsx("span",{className:"text-3xl font-black tracking-[0.2em] italic opacity-80",children:"DIGITAL RUNE COMPILER"}),d.jsx("div",{className:"px-3 py-1 rounded-sm bg-[#00E5FF]/10 border border-[#00E5FF]/30 text-[10px] font-black uppercase tracking-widest animate-pulse",children:"Data Ready"})]})]}),d.jsxs("div",{className:"flex items-center gap-8",children:[d.jsxs("div",{className:"flex items-center gap-2 opacity-60 hover:opacity-100 transition-opacity cursor-pointer",children:[d.jsx("span",{className:"material-symbols-outlined text-lg",children:"help"}),d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Protocol"})]}),d.jsxs("button",{className:"flex items-center gap-3 px-6 py-2.5 bg-[#00E5FF] text-black font-black uppercase text-xs tracking-widest rounded-sm hover:shadow-[0_0_20px_rgba(0,229,255,0.4)] transition-all",children:[d.jsx("span",{className:"material-symbols-outlined",children:"save"}),"Commit Data"]}),d.jsx("div",{className:"size-10 rounded-full bg-gradient-to-tr from-[#00E5FF] to-blue-600 border border-white/20 shadow-lg"})]})]}),d.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[d.jsxs("main",{className:"flex-1 flex flex-col p-12 gap-12 overflow-y-auto no-scrollbar relative",children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-[2px] bg-white/5 overflow-hidden",children:d.jsx("div",{className:"h-full bg-[#00E5FF] w-[64%] shadow-[0_0_10px_#00E5FF]"})}),d.jsxs("section",{className:"space-y-6",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"size-2 bg-[#00E5FF] rounded-full shadow-[0_0_10px_#00E5FF]"}),d.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.4em]",children:"Glyph Set (Scan)"})]}),d.jsxs("div",{className:"flex gap-4 opacity-40",children:[d.jsx("span",{className:"material-symbols-outlined text-xl",children:"grid_view"}),d.jsx("span",{className:"material-symbols-outlined text-xl",children:"view_list"})]})]}),d.jsxs("div",{className:"p-10 rounded-sm border border-[#00E5FF]/10 bg-[#00E5FF]/[0.02] grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-6",children:[d.jsx(Qa,{symbol:"",keyLabel:"A"}),d.jsx(Qa,{symbol:"",keyLabel:"B"}),d.jsx(Qa,{symbol:"",keyLabel:"C"}),d.jsx(Qa,{symbol:"",keyLabel:"D",active:!0}),d.jsx(Qa,{}),d.jsx(Qa,{}),d.jsx(Qa,{}),d.jsx(Qa,{}),d.jsx(Qa,{}),d.jsx(Qa,{}),d.jsx("div",{className:"aspect-square rounded shadow-inner border border-dashed border-[#00E5FF]/20 flex items-center justify-center hover:bg-[#00E5FF]/5 transition-colors cursor-pointer group",children:d.jsx("span",{className:"material-symbols-outlined opacity-20 group-hover:opacity-100 transition-opacity",children:"add"})})]}),d.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-[0.2em] opacity-40",children:[d.jsx("span",{children:"26 Glyphs Mapped"}),d.jsxs("div",{className:"flex gap-10",children:[d.jsxs("button",{className:"hover:text-[#00E5FF] flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"tune"})," Manage"]}),d.jsxs("button",{className:"hover:text-[#00E5FF] flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"settings_input_component"})," Ranges"]})]})]})]}),d.jsxs("section",{className:"flex-1 flex flex-col gap-6",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"size-2 bg-[#00E5FF] rounded-full shadow-[0_0_10px_#00E5FF] opacity-40"}),d.jsx("h3",{className:"text-sm font-black uppercase tracking-[0.4em] opacity-40",children:"Live Preview Stream"})]}),d.jsxs("div",{className:"flex-1 rounded-sm border border-[#00E5FF]/10 bg-black/40 flex flex-col p-12 items-center justify-center relative group min-h-[300px]",children:[d.jsx("div",{className:"absolute top-4 left-4 text-[8px] opacity-20 uppercase tracking-widest font-black",children:"Buffer Status: Active"}),d.jsx("textarea",{className:"w-full h-full bg-transparent border-none outline-none text-center text-7xl font-bold tracking-widest text-[#00E5FF]/10 group-hover:text-[#00E5FF]/40 transition-all placeholder:text-[#00E5FF]/5 resize-none italic",placeholder:"Input your data stream here..."}),d.jsxs("div",{className:"absolute bottom-6 right-8 flex gap-6 text-[8px] font-black uppercase tracking-widest opacity-20",children:[d.jsx("span",{children:"48px"}),d.jsx("span",{children:"Regular"}),d.jsx("span",{children:"UTF-8"})]}),d.jsx("div",{className:"absolute inset-x-12 top-1/2 h-px bg-[#00E5FF]/10 -translate-y-1/2 pointer-events-none"})]})]})]}),d.jsxs("aside",{className:"w-[450px] border-l border-[#00E5FF]/10 p-10 flex flex-col gap-10 bg-black/40 backdrop-blur-xl relative z-20",children:[d.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.4em] opacity-60 mb-2",children:"Configuration Matrix"}),d.jsxs(Ct,{className:"p-8 border-[#00E5FF]/20 bg-[#00E5FF]/[0.02] space-y-8 rounded-sm",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Font Name"}),d.jsx("input",{type:"text",defaultValue:"NEURALINK CIPHER",className:"w-full bg-black/60 border border-[#00E5FF]/30 px-6 py-4 text-xs font-black text-[#00E5FF] focus:border-[#00E5FF] outline-none transition-all tracking-widest uppercase italic"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Author / Metadata"}),d.jsx("input",{type:"text",placeholder:"YOUR SYNTHETIC ID",className:"w-full bg-black/60 border border-[#00E5FF]/30 px-6 py-4 text-xs font-black text-[#00E5FF] focus:border-[#00E5FF] outline-none transition-all tracking-widest uppercase italic"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-[#00E5FF]/60 block ml-1",children:"Format"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsx("button",{className:"py-4 border border-[#00E5FF] bg-[#00E5FF]/10 text-[#00E5FF] text-xs font-black tracking-widest shadow-[0_0_15px_rgba(0,229,255,0.2)]",children:".TTF"}),d.jsx("button",{className:"py-4 border border-[#00E5FF]/20 text-[#00E5FF]/40 text-xs font-black tracking-widest hover:border-[#00E5FF]/40 transition-all",children:".OTF"})]})]}),d.jsxs("div",{className:"pt-4 space-y-6",children:[d.jsx(uj,{label:"Ligatures",active:!0}),d.jsx(uj,{label:"Kerning",active:!0})]}),d.jsxs("button",{className:"w-full py-6 mt-6 bg-gradient-to-r from-blue-600 to-fuchsia-500 text-white font-black uppercase text-xs tracking-[0.3em] flex items-center justify-center gap-4 hover:shadow-[0_0_30px_rgba(255,0,255,0.3)] transition-all animate-pulse",children:[d.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Compile & Download"]})]}),d.jsxs("div",{className:"flex-1 flex flex-col gap-6 opacity-30 pointer-events-none",children:[d.jsxs("div",{className:"flex justify-between text-[10px] uppercase font-black",children:[d.jsx("span",{children:"Compiler Logs"}),d.jsx("span",{children:"V2.0.4"})]}),d.jsxs("div",{className:"flex-1 border border-[#00E5FF]/10 bg-black/20 p-6 flex flex-col font-mono text-[9px] gap-2 overflow-hidden",children:[d.jsx("p",{children:"[SCN] Initializing Glyph Buffer..."}),d.jsx("p",{children:"[MAP] Vector data detected for U+0394"}),d.jsx("p",{children:"[SYS] Memory allocation optimized"}),d.jsx("p",{className:"animate-pulse",children:"_"})]})]})]})]})]}),Qa=({symbol:t,keyLabel:e,active:r})=>d.jsxs("div",{className:`aspect-square rounded border transition-all cursor-pointer flex items-center justify-center relative group ${r?"bg-[#00E5FF]/20 border-[#00E5FF] shadow-[0_0_20px_rgba(0,229,255,0.3)]":"bg-black/40 border-[#00E5FF]/10 hover:border-[#00E5FF]/40"}`,children:[d.jsx("span",{className:`text-3xl font-serif ${r?"text-white":"opacity-20 group-hover:opacity-60"}`,children:t||"..."}),e&&d.jsx("span",{className:`absolute top-1 right-1 text-[8px] font-black uppercase ${r?"text-[#00E5FF]/80":"opacity-20"}`,children:e})]}),uj=({label:t,active:e})=>d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest opacity-60",children:t}),d.jsx("button",{className:`w-12 h-6 rounded-full p-1 transition-colors relative ${e?"bg-[#00E5FF]/40":"bg-white/5"}`,children:d.jsx("div",{className:`size-4 rounded-full bg-[#00E5FF] shadow-[0_0_10px_#00E5FF] transition-transform ${e?"translate-x-6":"translate-x-0"}`})})]}),_Y=({onBack:t,onSave:e})=>{const[r,n]=q.useState(4),[i,a]=q.useState("curve"),[s,o]=q.useState(1),l=[{id:"select",icon:"near_me"},{id:"curve",icon:"gesture"},{id:"eraser",icon:"ink_eraser"},{id:"line",icon:"horizontal_rule"},{id:"shape",icon:"pentagon"},{id:"text",icon:"title"}],c=[{id:1,name:"Trazo Principal",type:"Vector",locked:!0,visible:!0},{id:2,name:"Detalles Secundarios",type:"Vector",locked:!0,visible:!0},{id:3,name:"Boceto Ref.",type:"Imagen (Raster)",locked:!0,visible:!1}];return d.jsxs("div",{className:"flex-1 flex flex-col bg-[#0a0a0f] text-slate-300 font-sans h-full overflow-hidden relative",children:[d.jsxs("header",{className:"h-20 flex-none border-b border-white/5 flex items-center justify-between px-8 bg-surface-dark/80 backdrop-blur-md z-30",children:[d.jsxs("div",{className:"flex items-center gap-6",children:[d.jsx("button",{onClick:t,className:"p-2 rounded-xl bg-white/5 hover:bg-white/10 transition-colors",children:d.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),d.jsx("div",{className:"w-px h-8 bg-white/10"}),d.jsxs("div",{children:[d.jsxs("nav",{className:"flex items-center gap-2 text-[10px] font-black uppercase tracking-widest text-slate-500 mb-0.5",children:[d.jsx("span",{children:"Idiomas"}),d.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"}),d.jsx("span",{className:"text-white",children:"Editor Grfico"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("div",{className:"flex items-center gap-4 text-slate-500",children:[d.jsx("button",{className:"hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"undo"})}),d.jsx("button",{className:"hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"redo"})})]}),d.jsx("div",{className:"w-px h-4 bg-white/10 mx-2"}),d.jsxs("div",{className:"flex gap-1",children:[d.jsx("button",{className:"p-1 rounded hover:bg-white/5 text-slate-500 hover:text-white",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"grid_on"})}),d.jsx("button",{className:"p-1 rounded bg-white/10 text-primary",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})})]})]})]})]}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsxs("button",{className:"flex items-center gap-2 px-6 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/5 transition-all text-xs font-black uppercase tracking-widest text-slate-400",children:[d.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Exportar SVG"]}),d.jsx(Wt,{variant:"primary",icon:"save",className:"px-8 py-3 shadow-xl shadow-primary/30",onClick:e,children:"Guardar Glifo"}),d.jsx("div",{className:"size-10 rounded-full bg-gradient-to-br from-primary to-orange-400 border-2 border-white/10 shadow-lg ml-2"})]})]}),d.jsxs("div",{className:"flex-1 flex relative overflow-hidden",children:[d.jsxs("aside",{className:"h-full w-20 flex-none border-r border-white/5 bg-surface-dark/40 backdrop-blur-xl flex flex-col items-center py-6 gap-2 z-40",children:[l.map(u=>d.jsx("button",{onClick:()=>a(u.id),className:`size-12 rounded-2xl flex items-center justify-center transition-all ${i===u.id?"bg-primary text-white shadow-lg shadow-primary/30":"text-slate-600 hover:text-white hover:bg-white/5"}`,children:d.jsx("span",{className:"material-symbols-outlined text-2xl",children:u.icon})},u.id)),d.jsx("div",{className:"flex-1"}),d.jsx("button",{className:"size-12 rounded-2xl flex items-center justify-center text-slate-600 hover:text-white transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-2xl",children:"add_photo_alternate"})}),d.jsx("button",{className:"size-12 rounded-2xl flex items-center justify-center text-slate-600 hover:text-white transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-2xl",children:"settings"})})]}),d.jsxs("main",{className:"flex-1 bg-[#050508] relative overflow-hidden flex items-center justify-center no-scrollbar",children:[d.jsx("div",{className:"absolute inset-x-20 top-1/2 h-px bg-red-500/20 pointer-events-none"}),d.jsxs("div",{className:"relative group animate-in zoom-in-95 duration-700",children:[d.jsx("div",{className:"absolute inset-x-0 top-10 h-px bg-white/10"}),d.jsx("div",{className:"absolute inset-x-0 bottom-10 h-px bg-white/10"}),d.jsxs("div",{className:"w-[600px] h-[600px] border border-white/5 rounded-3xl bg-black/40 flex items-center justify-center relative overflow-hidden",children:[d.jsxs("svg",{width:"400",height:"400",className:"drop-shadow-[0_0_20px_rgba(99,102,242,0.5)] scale-125",children:[d.jsx("circle",{cx:"200",cy:"230",r:"100",fill:"none",stroke:"#6366f1",strokeWidth:"6",strokeLinecap:"round"}),d.jsx("line",{x1:"200",y1:"230",x2:"200",y2:"380",stroke:"#6366f1",strokeWidth:"6",strokeLinecap:"round"}),d.jsx("circle",{cx:"200",cy:"230",r:"4",fill:"white"}),d.jsx("rect",{x:"196",y:"376",width:"8",height:"8",fill:"white"}),d.jsx("rect",{x:"96",y:"226",width:"8",height:"8",fill:"#6366f1"}),d.jsx("rect",{x:"296",y:"226",width:"8",height:"8",fill:"#6366f1"}),d.jsx("rect",{x:"136",y:"160",width:"6",height:"6",fill:"#6366f1",className:"opacity-40"}),d.jsx("rect",{x:"256",y:"160",width:"6",height:"6",fill:"#6366f1",className:"opacity-40"})]}),d.jsx("div",{className:"absolute top-[160px] left-[136px] size-1 border border-primary/40 border-dashed w-[20px] h-[100px] pointer-events-none"}),d.jsx("div",{className:"absolute top-[160px] right-[136px] size-1 border border-primary/40 border-dashed w-[20px] h-[100px] pointer-events-none"})]})]}),d.jsx("div",{className:"absolute bottom-10 left-1/2 -translate-x-1/2",children:d.jsxs(Ct,{className:"px-6 py-2.5 flex items-center gap-6 rounded-2xl border-white/10 bg-surface-dark/40 backdrop-blur-2xl shadow-2xl",children:[d.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"remove"})}),d.jsx("span",{className:"text-[10px] font-black text-white w-12 text-center uppercase tracking-widest",children:"120%"}),d.jsx("button",{className:"text-slate-500 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"add"})})]})})]}),d.jsxs("aside",{className:"w-96 flex-none flex flex-col p-10 gap-10 bg-surface-dark/20 backdrop-blur-xl border-l border-white/5 z-40 overflow-y-auto no-scrollbar",children:[d.jsxs("section",{className:"space-y-6",children:[d.jsxs("header",{className:"flex justify-between items-center group cursor-pointer",children:[d.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Propiedades"}),d.jsx("span",{className:"material-symbols-outlined text-slate-700 text-sm",children:"more_horiz"})]}),d.jsxs(Ct,{className:"p-8 border-white/5 bg-surface-dark/40 rounded-[2rem] space-y-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Grosor de Trazo"}),d.jsxs("span",{className:"px-2 py-0.5 rounded bg-white/5 text-[10px] font-black text-white",children:[r,"px"]})]}),d.jsx("input",{type:"range",min:"1",max:"20",value:r,onChange:u=>n(u.target.value),className:"w-full accent-primary h-1 bg-white/5 rounded-full appearance-none cursor-pointer"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 block ml-1",children:"Color / Relleno"}),d.jsxs("div",{className:"flex items-center gap-4 bg-black/40 rounded-2xl p-4 border border-white/5",children:[d.jsx("div",{className:"size-10 rounded-full bg-primary shadow-[0_0_15px_rgba(99,102,242,0.4)] border-2 border-white/20"}),d.jsx("input",{type:"text",defaultValue:"#2F2CED",className:"bg-transparent border-none outline-none text-xs font-mono text-slate-300 w-full"})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-600 block ml-1",children:"Terminacin (Cap)"}),d.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[d.jsx(q2,{icon:"square"}),d.jsx(q2,{icon:"circle",active:!0}),d.jsx(q2,{icon:"rectangle"})]})]}),d.jsxs("button",{className:"w-full py-4 rounded-2xl bg-white/5 border border-white/5 text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-3 hover:bg-white/10 transition-all",children:[d.jsx("span",{className:"material-symbols-outlined text-lg",children:"gesture"}),"Suavizar Trazo"]})]})]}),d.jsxs("section",{className:"flex-1 flex flex-col gap-6",children:[d.jsxs("header",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500",children:"Capas"}),d.jsx("button",{className:"p-1 rounded bg-white/5 text-slate-500 hover:text-white transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"})})]}),d.jsx("div",{className:"space-y-3 overflow-y-auto no-scrollbar flex-1",children:c.map(u=>d.jsxs("div",{onClick:()=>o(u.id),className:`flex items-center gap-4 p-4 rounded-2xl transition-all cursor-pointer group ${s===u.id?"bg-primary/10 border border-primary/20":"bg-white/[0.02] border border-white/5 opacity-60 hover:opacity-100 hover:border-white/10"}`,children:[d.jsx("button",{className:"material-symbols-outlined text-sm text-slate-500 hover:text-white",children:u.visible?"visibility":"visibility_off"}),d.jsx("div",{className:"size-10 rounded-xl bg-black border border-white/10 flex items-center justify-center",children:d.jsx("span",{className:"material-symbols-outlined text-slate-600 group-hover:text-primary transition-colors text-xl",children:u.type.includes("Vector")?"timeline":"image"})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("h4",{className:"text-xs font-bold text-white truncate",children:u.name}),d.jsx("p",{className:"text-[9px] text-slate-600 font-bold uppercase tracking-widest",children:u.type})]}),d.jsx("button",{className:"material-symbols-outlined text-slate-700 text-sm",children:"lock"})]},u.id))}),d.jsxs("div",{className:"flex gap-4 p-3 rounded-2xl bg-black/20 border border-white/5",children:[d.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})}),d.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"content_copy"})}),d.jsx("button",{className:"flex-1 p-2 rounded-xl hover:bg-white/5 text-slate-700 hover:text-white transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"folder"})})]})]}),d.jsxs("div",{className:"p-6 rounded-[2rem] bg-gradient-to-br from-primary/20 to-orange-500/20 border border-white/10 space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:"material-symbols-outlined text-primary",children:"auto_fix_high"}),d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-white",children:"Vectorizacin Inteligente"})]}),d.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed font-manrope",children:"Arrastra una imagen para convertirla automticamente en nodos editables."}),d.jsx(Wt,{variant:"primary",size:"sm",className:"w-full text-[9px] py-3 rounded-xl shadow-lg",children:"Importar y Procesar"})]})]})]})]})},q2=({icon:t,active:e})=>d.jsx("button",{className:`py-4 rounded-xl border transition-all flex items-center justify-center ${e?"bg-primary/20 border-primary shadow-lg shadow-primary/20":"bg-white/5 border-white/5 hover:border-white/10"}`,children:d.jsx("span",{className:`material-symbols-outlined text-lg ${e?"text-white":"text-slate-600"}`,children:t})}),AY=()=>{const[t,e]=q.useState("hub");return d.jsxs("div",{className:"flex-1 flex flex-col h-full bg-[#050508] overflow-hidden",children:[t==="hub"&&d.jsxs("div",{className:"flex-1 flex flex-col h-full relative",children:[d.jsx("button",{onClick:()=>e("foundry"),className:"absolute right-12 bottom-12 z-50 size-16 rounded-3xl bg-primary text-white flex items-center justify-center shadow-2xl shadow-primary/40 hover:scale-110 active:scale-95 transition-all group",title:"Glyph Foundry",children:d.jsx("span",{className:"material-symbols-outlined text-3xl group-hover:rotate-12 transition-transform duration-300",children:"font_download"})}),d.jsx(MY,{onOpenEditor:()=>e("editor")})]}),t==="foundry"&&d.jsx(PY,{onBack:()=>e("hub")}),t==="editor"&&d.jsx(_Y,{onBack:()=>e("hub"),onSave:()=>e("hub")})]})};var N7={exports:{}},E7={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Id=q;function RY(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var DY=typeof Object.is=="function"?Object.is:RY,OY=Id.useState,IY=Id.useEffect,LY=Id.useLayoutEffect,BY=Id.useDebugValue;function FY(t,e){var r=e(),n=OY({inst:{value:r,getSnapshot:e}}),i=n[0].inst,a=n[1];return LY(function(){i.value=r,i.getSnapshot=e,K2(i)&&a({inst:i})},[t,r,e]),IY(function(){return K2(i)&&a({inst:i}),t(function(){K2(i)&&a({inst:i})})},[t]),BY(r),r}function K2(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!DY(t,r)}catch{return!0}}function zY(t,e){return e()}var VY=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?zY:FY;E7.useSyncExternalStore=Id.useSyncExternalStore!==void 0?Id.useSyncExternalStore:VY;N7.exports=E7;var x3=N7.exports;function Sn(t){this.content=t}Sn.prototype={constructor:Sn,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,r){var n=r&&r!=t?this.remove(r):this,i=n.find(t),a=n.content.slice();return i==-1?a.push(r||t,e):(a[i+1]=e,r&&(a[i]=r)),new Sn(a)},remove:function(t){var e=this.find(t);if(e==-1)return this;var r=this.content.slice();return r.splice(e,2),new Sn(r)},addToStart:function(t,e){return new Sn([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var r=this.remove(t).content.slice();return r.push(t,e),new Sn(r)},addBefore:function(t,e,r){var n=this.remove(e),i=n.content.slice(),a=n.find(t);return i.splice(a==-1?i.length:a,0,e,r),new Sn(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Sn.from(t),t.size?new Sn(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Sn.from(t),t.size?new Sn(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Sn.from(t);for(var r=0;r<t.content.length;r+=2)e=e.remove(t.content[r]);return e},toObject:function(){var t={};return this.forEach(function(e,r){t[e]=r}),t},get size(){return this.content.length>>1}};Sn.from=function(t){if(t instanceof Sn)return t;var e=[];if(t)for(var r in t)e.push(r,t[r]);return new Sn(e)};function T7(t,e,r){for(let n=0;;n++){if(n==t.childCount||n==e.childCount)return t.childCount==e.childCount?null:r;let i=t.child(n),a=e.child(n);if(i==a){r+=i.nodeSize;continue}if(!i.sameMarkup(a))return r;if(i.isText&&i.text!=a.text){for(let s=0;i.text[s]==a.text[s];s++)r++;return r}if(i.content.size||a.content.size){let s=T7(i.content,a.content,r+1);if(s!=null)return s}r+=i.nodeSize}}function j7(t,e,r,n){for(let i=t.childCount,a=e.childCount;;){if(i==0||a==0)return i==a?null:{a:r,b:n};let s=t.child(--i),o=e.child(--a),l=s.nodeSize;if(s==o){r-=l,n-=l;continue}if(!s.sameMarkup(o))return{a:r,b:n};if(s.isText&&s.text!=o.text){let c=0,u=Math.min(s.text.length,o.text.length);for(;c<u&&s.text[s.text.length-c-1]==o.text[o.text.length-c-1];)c++,r--,n--;return{a:r,b:n}}if(s.content.size||o.content.size){let c=j7(s.content,o.content,r-1,n-1);if(c)return c}r-=l,n-=l}}class be{constructor(e,r){if(this.content=e,this.size=r||0,r==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,r,n,i=0,a){for(let s=0,o=0;o<r;s++){let l=this.content[s],c=o+l.nodeSize;if(c>e&&n(l,i+o,a||null,s)!==!1&&l.content.size){let u=o+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,r-u),n,i+u)}o=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,r,n,i){let a="",s=!0;return this.nodesBetween(e,r,(o,l)=>{let c=o.isText?o.text.slice(Math.max(e,l)-l,r-l):o.isLeaf?i?typeof i=="function"?i(o):i:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&c||o.isTextblock)&&n&&(s?s=!1:a+=n),a+=c},0),a}append(e){if(!e.size)return this;if(!this.size)return e;let r=this.lastChild,n=e.firstChild,i=this.content.slice(),a=0;for(r.isText&&r.sameMarkup(n)&&(i[i.length-1]=r.withText(r.text+n.text),a=1);a<e.content.length;a++)i.push(e.content[a]);return new be(i,this.size+e.size)}cut(e,r=this.size){if(e==0&&r==this.size)return this;let n=[],i=0;if(r>e)for(let a=0,s=0;s<r;a++){let o=this.content[a],l=s+o.nodeSize;l>e&&((s<e||l>r)&&(o.isText?o=o.cut(Math.max(0,e-s),Math.min(o.text.length,r-s)):o=o.cut(Math.max(0,e-s-1),Math.min(o.content.size,r-s-1))),n.push(o),i+=o.nodeSize),s=l}return new be(n,i)}cutByIndex(e,r){return e==r?be.empty:e==0&&r==this.content.length?this:new be(this.content.slice(e,r))}replaceChild(e,r){let n=this.content[e];if(n==r)return this;let i=this.content.slice(),a=this.size+r.nodeSize-n.nodeSize;return i[e]=r,new be(i,a)}addToStart(e){return new be([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new be(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let r=0;r<this.content.length;r++)if(!this.content[r].eq(e.content[r]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let r=this.content[e];if(!r)throw new RangeError("Index "+e+" out of range for "+this);return r}maybeChild(e){return this.content[e]||null}forEach(e){for(let r=0,n=0;r<this.content.length;r++){let i=this.content[r];e(i,n,r),n+=i.nodeSize}}findDiffStart(e,r=0){return T7(this,e,r)}findDiffEnd(e,r=this.size,n=e.size){return j7(this,e,r,n)}findIndex(e){if(e==0)return Yg(0,e);if(e==this.size)return Yg(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,n=0;;r++){let i=this.child(r),a=n+i.nodeSize;if(a>=e)return a==e?Yg(r+1,a):Yg(r,n);n=a}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,r){if(!r)return be.empty;if(!Array.isArray(r))throw new RangeError("Invalid input for Fragment.fromJSON");return new be(r.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return be.empty;let r,n=0;for(let i=0;i<e.length;i++){let a=e[i];n+=a.nodeSize,i&&a.isText&&e[i-1].sameMarkup(a)?(r||(r=e.slice(0,i)),r[r.length-1]=a.withText(r[r.length-1].text+a.text)):r&&r.push(a)}return new be(r||e,n)}static from(e){if(!e)return be.empty;if(e instanceof be)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new be([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}be.empty=new be([],0);const Y2={index:0,offset:0};function Yg(t,e){return Y2.index=t,Y2.offset=e,Y2}function O0(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let r=Array.isArray(t);if(Array.isArray(e)!=r)return!1;if(r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!O0(t[n],e[n]))return!1}else{for(let n in t)if(!(n in e)||!O0(t[n],e[n]))return!1;for(let n in e)if(!(n in t))return!1}return!0}let Gt=class rk{constructor(e,r){this.type=e,this.attrs=r}addToSet(e){let r,n=!1;for(let i=0;i<e.length;i++){let a=e[i];if(this.eq(a))return e;if(this.type.excludes(a.type))r||(r=e.slice(0,i));else{if(a.type.excludes(this.type))return e;!n&&a.type.rank>this.type.rank&&(r||(r=e.slice(0,i)),r.push(this),n=!0),r&&r.push(a)}}return r||(r=e.slice()),n||r.push(this),r}removeFromSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return e.slice(0,r).concat(e.slice(r+1));return e}isInSet(e){for(let r=0;r<e.length;r++)if(this.eq(e[r]))return!0;return!1}eq(e){return this==e||this.type==e.type&&O0(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[r.type];if(!n)throw new RangeError(`There is no mark type ${r.type} in this schema`);let i=n.create(r.attrs);return n.checkAttrs(i.attrs),i}static sameSet(e,r){if(e==r)return!0;if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(r[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return rk.none;if(e instanceof rk)return[e];let r=e.slice();return r.sort((n,i)=>n.type.rank-i.type.rank),r}};Gt.none=[];class I0 extends Error{}class Ae{constructor(e,r,n){this.content=e,this.openStart=r,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,r){let n=P7(this.content,e+this.openStart,r);return n&&new Ae(n,this.openStart,this.openEnd)}removeBetween(e,r){return new Ae(M7(this.content,e+this.openStart,r+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,r){if(!r)return Ae.empty;let n=r.openStart||0,i=r.openEnd||0;if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Ae(be.fromJSON(e,r.content),n,i)}static maxOpen(e,r=!0){let n=0,i=0;for(let a=e.firstChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.firstChild)n++;for(let a=e.lastChild;a&&!a.isLeaf&&(r||!a.type.spec.isolating);a=a.lastChild)i++;return new Ae(e,n,i)}}Ae.empty=new Ae(be.empty,0,0);function M7(t,e,r){let{index:n,offset:i}=t.findIndex(e),a=t.maybeChild(n),{index:s,offset:o}=t.findIndex(r);if(i==e||a.isText){if(o!=r&&!t.child(s).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(r))}if(n!=s)throw new RangeError("Removing non-flat range");return t.replaceChild(n,a.copy(M7(a.content,e-i-1,r-i-1)))}function P7(t,e,r,n){let{index:i,offset:a}=t.findIndex(e),s=t.maybeChild(i);if(a==e||s.isText)return n&&!n.canReplace(i,i,r)?null:t.cut(0,e).append(r).append(t.cut(e));let o=P7(s.content,e-a-1,r,s);return o&&t.replaceChild(i,s.copy(o))}function $Y(t,e,r){if(r.openStart>t.depth)throw new I0("Inserted content deeper than insertion position");if(t.depth-r.openStart!=e.depth-r.openEnd)throw new I0("Inconsistent open depths");return _7(t,e,r,0)}function _7(t,e,r,n){let i=t.index(n),a=t.node(n);if(i==e.index(n)&&n<t.depth-r.openStart){let s=_7(t,e,r,n+1);return a.copy(a.content.replaceChild(i,s))}else if(r.content.size)if(!r.openStart&&!r.openEnd&&t.depth==n&&e.depth==n){let s=t.parent,o=s.content;return Tc(s,o.cut(0,t.parentOffset).append(r.content).append(o.cut(e.parentOffset)))}else{let{start:s,end:o}=UY(r,t);return Tc(a,R7(t,s,o,e,n))}else return Tc(a,L0(t,e,n))}function A7(t,e){if(!e.type.compatibleContent(t.type))throw new I0("Cannot join "+e.type.name+" onto "+t.type.name)}function nk(t,e,r){let n=t.node(r);return A7(n,e.node(r)),n}function Ec(t,e){let r=e.length-1;r>=0&&t.isText&&t.sameMarkup(e[r])?e[r]=t.withText(e[r].text+t.text):e.push(t)}function zh(t,e,r,n){let i=(e||t).node(r),a=0,s=e?e.index(r):i.childCount;t&&(a=t.index(r),t.depth>r?a++:t.textOffset&&(Ec(t.nodeAfter,n),a++));for(let o=a;o<s;o++)Ec(i.child(o),n);e&&e.depth==r&&e.textOffset&&Ec(e.nodeBefore,n)}function Tc(t,e){return t.type.checkContent(e),t.copy(e)}function R7(t,e,r,n,i){let a=t.depth>i&&nk(t,e,i+1),s=n.depth>i&&nk(r,n,i+1),o=[];return zh(null,t,i,o),a&&s&&e.index(i)==r.index(i)?(A7(a,s),Ec(Tc(a,R7(t,e,r,n,i+1)),o)):(a&&Ec(Tc(a,L0(t,e,i+1)),o),zh(e,r,i,o),s&&Ec(Tc(s,L0(r,n,i+1)),o)),zh(n,null,i,o),new be(o)}function L0(t,e,r){let n=[];if(zh(null,t,r,n),t.depth>r){let i=nk(t,e,r+1);Ec(Tc(i,L0(t,e,r+1)),n)}return zh(e,null,r,n),new be(n)}function UY(t,e){let r=e.depth-t.openStart,i=e.node(r).copy(t.content);for(let a=r-1;a>=0;a--)i=e.node(a).copy(be.from(i));return{start:i.resolveNoCache(t.openStart+r),end:i.resolveNoCache(i.content.size-t.openEnd-r)}}class jp{constructor(e,r,n){this.pos=e,this.path=r,this.parentOffset=n,this.depth=r.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,r=this.index(this.depth);if(r==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(r);return n?e.child(r).cut(n):i}get nodeBefore(){let e=this.index(this.depth),r=this.pos-this.path[this.path.length-1];return r?this.parent.child(e).cut(0,r):e==0?null:this.parent.child(e-1)}posAtIndex(e,r){r=this.resolveDepth(r);let n=this.path[r*3],i=r==0?0:this.path[r*3-1]+1;for(let a=0;a<e;a++)i+=n.child(a).nodeSize;return i}marks(){let e=this.parent,r=this.index();if(e.content.size==0)return Gt.none;if(this.textOffset)return e.child(r).marks;let n=e.maybeChild(r-1),i=e.maybeChild(r);if(!n){let o=n;n=i,i=o}let a=n.marks;for(var s=0;s<a.length;s++)a[s].type.spec.inclusive===!1&&(!i||!a[s].isInSet(i.marks))&&(a=a[s--].removeFromSet(a));return a}marksAcross(e){let r=this.parent.maybeChild(this.index());if(!r||!r.isInline)return null;let n=r.marks,i=e.parent.maybeChild(e.index());for(var a=0;a<n.length;a++)n[a].type.spec.inclusive===!1&&(!i||!n[a].isInSet(i.marks))&&(n=n[a--].removeFromSet(n));return n}sharedDepth(e){for(let r=this.depth;r>0;r--)if(this.start(r)<=e&&this.end(r)>=e)return r;return 0}blockRange(e=this,r){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!r||r(this.node(n))))return new B0(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let r=1;r<=this.depth;r++)e+=(e?"/":"")+this.node(r).type.name+"_"+this.index(r-1);return e+":"+this.parentOffset}static resolve(e,r){if(!(r>=0&&r<=e.content.size))throw new RangeError("Position "+r+" out of range");let n=[],i=0,a=r;for(let s=e;;){let{index:o,offset:l}=s.content.findIndex(a),c=a-l;if(n.push(s,o,i+l),!c||(s=s.child(o),s.isText))break;a=c-1,i+=l+1}return new jp(r,n,a)}static resolveCached(e,r){let n=dj.get(e);if(n)for(let a=0;a<n.elts.length;a++){let s=n.elts[a];if(s.pos==r)return s}else dj.set(e,n=new GY);let i=n.elts[n.i]=jp.resolve(e,r);return n.i=(n.i+1)%HY,i}}class GY{constructor(){this.elts=[],this.i=0}}const HY=12,dj=new WeakMap;class B0{constructor(e,r,n){this.$from=e,this.$to=r,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const WY=Object.create(null);let qs=class ik{constructor(e,r,n,i=Gt.none){this.type=e,this.attrs=r,this.marks=i,this.content=n||be.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,r,n,i=0){this.content.nodesBetween(e,r,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,r,n,i){return this.content.textBetween(e,r,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,r,n){return this.type==e&&O0(this.attrs,r||e.defaultAttrs||WY)&&Gt.sameSet(this.marks,n||Gt.none)}copy(e=null){return e==this.content?this:new ik(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new ik(this.type,this.attrs,this.content,e)}cut(e,r=this.content.size){return e==0&&r==this.content.size?this:this.copy(this.content.cut(e,r))}slice(e,r=this.content.size,n=!1){if(e==r)return Ae.empty;let i=this.resolve(e),a=this.resolve(r),s=n?0:i.sharedDepth(r),o=i.start(s),c=i.node(s).content.cut(i.pos-o,a.pos-o);return new Ae(c,i.depth-s,a.depth-s)}replace(e,r,n){return $Y(this.resolve(e),this.resolve(r),n)}nodeAt(e){for(let r=this;;){let{index:n,offset:i}=r.content.findIndex(e);if(r=r.maybeChild(n),!r)return null;if(i==e||r.isText)return r;e-=i+1}}childAfter(e){let{index:r,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(r),index:r,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:r,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(r),index:r,offset:n};let i=this.content.child(r-1);return{node:i,index:r-1,offset:n-i.nodeSize}}resolve(e){return jp.resolveCached(this,e)}resolveNoCache(e){return jp.resolve(this,e)}rangeHasMark(e,r,n){let i=!1;return r>e&&this.nodesBetween(e,r,a=>(n.isInSet(a.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),D7(this.marks,e)}contentMatchAt(e){let r=this.type.contentMatch.matchFragment(this.content,0,e);if(!r)throw new Error("Called contentMatchAt on a node with invalid content");return r}canReplace(e,r,n=be.empty,i=0,a=n.childCount){let s=this.contentMatchAt(e).matchFragment(n,i,a),o=s&&s.matchFragment(this.content,r);if(!o||!o.validEnd)return!1;for(let l=i;l<a;l++)if(!this.type.allowsMarks(n.child(l).marks))return!1;return!0}canReplaceWith(e,r,n,i){if(i&&!this.type.allowsMarks(i))return!1;let a=this.contentMatchAt(e).matchType(n),s=a&&a.matchFragment(this.content,r);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Gt.none;for(let r=0;r<this.marks.length;r++){let n=this.marks[r];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!Gt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(r=>r.type.name)}`);this.content.forEach(r=>r.check())}toJSON(){let e={type:this.type.name};for(let r in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(r=>r.toJSON())),e}static fromJSON(e,r){if(!r)throw new RangeError("Invalid input for Node.fromJSON");let n;if(r.marks){if(!Array.isArray(r.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=r.marks.map(e.markFromJSON)}if(r.type=="text"){if(typeof r.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(r.text,n)}let i=be.fromJSON(e,r.content),a=e.nodeType(r.type).create(r.attrs,i,n);return a.type.checkAttrs(a.attrs),a}};qs.prototype.text=void 0;class F0 extends qs{constructor(e,r,n,i){if(super(e,r,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):D7(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,r){return this.text.slice(e,r)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new F0(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new F0(this.type,this.attrs,e,this.marks)}cut(e=0,r=this.text.length){return e==0&&r==this.text.length?this:this.withText(this.text.slice(e,r))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function D7(t,e){for(let r=t.length-1;r>=0;r--)e=t[r].type.name+"("+e+")";return e}class Gc{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,r){let n=new qY(e,r);if(n.next==null)return Gc.empty;let i=O7(n);n.next&&n.err("Unexpected trailing text");let a=eX(ZY(i));return tX(a,n),a}matchType(e){for(let r=0;r<this.next.length;r++)if(this.next[r].type==e)return this.next[r].next;return null}matchFragment(e,r=0,n=e.childCount){let i=this;for(let a=r;i&&a<n;a++)i=i.matchType(e.child(a).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:r}=this.next[e];if(!(r.isText||r.hasRequiredAttrs()))return r}return null}compatible(e){for(let r=0;r<this.next.length;r++)for(let n=0;n<e.next.length;n++)if(this.next[r].type==e.next[n].type)return!0;return!1}fillBefore(e,r=!1,n=0){let i=[this];function a(s,o){let l=s.matchFragment(e,n);if(l&&(!r||l.validEnd))return be.from(o.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:f}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let h=a(f,o.concat(u));if(h)return h}}return null}return a(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let r=this.computeWrapping(e);return this.wrapCache.push(e,r),r}computeWrapping(e){let r=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),a=i.match;if(a.matchType(e)){let s=[];for(let o=i;o.type;o=o.via)s.push(o.type);return s.reverse()}for(let s=0;s<a.next.length;s++){let{type:o,next:l}=a.next[s];!o.isLeaf&&!o.hasRequiredAttrs()&&!(o.name in r)&&(!i.type||l.validEnd)&&(n.push({match:o.contentMatch,type:o,via:i}),r[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function r(n){e.push(n);for(let i=0;i<n.next.length;i++)e.indexOf(n.next[i].next)==-1&&r(n.next[i].next)}return r(this),e.map((n,i)=>{let a=i+(n.validEnd?"*":" ")+" ";for(let s=0;s<n.next.length;s++)a+=(s?", ":"")+n.next[s].type.name+"->"+e.indexOf(n.next[s].next);return a}).join(`
`)}}Gc.empty=new Gc(!0);class qY{constructor(e,r){this.string=e,this.nodeTypes=r,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function O7(t){let e=[];do e.push(KY(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function KY(t){let e=[];do e.push(YY(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function YY(t){let e=JY(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=XY(t,e);else break;return e}function fj(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function XY(t,e){let r=fj(t),n=r;return t.eat(",")&&(t.next!="}"?n=fj(t):n=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:r,max:n,expr:e}}function QY(t,e){let r=t.nodeTypes,n=r[e];if(n)return[n];let i=[];for(let a in r){let s=r[a];s.isInGroup(e)&&i.push(s)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function JY(t){if(t.eat("(")){let e=O7(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=QY(t,t.next).map(r=>(t.inline==null?t.inline=r.isInline:t.inline!=r.isInline&&t.err("Mixing inline and block content"),{type:"name",value:r}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function ZY(t){let e=[[]];return i(a(t,0),r()),e;function r(){return e.push([])-1}function n(s,o,l){let c={term:l,to:o};return e[s].push(c),c}function i(s,o){s.forEach(l=>l.to=o)}function a(s,o){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(a(c,o)),[]);if(s.type=="seq")for(let l=0;;l++){let c=a(s.exprs[l],o);if(l==s.exprs.length-1)return c;i(c,o=r())}else if(s.type=="star"){let l=r();return n(o,l),i(a(s.expr,l),l),[n(l)]}else if(s.type=="plus"){let l=r();return i(a(s.expr,o),l),i(a(s.expr,l),l),[n(l)]}else{if(s.type=="opt")return[n(o)].concat(a(s.expr,o));if(s.type=="range"){let l=o;for(let c=0;c<s.min;c++){let u=r();i(a(s.expr,l),u),l=u}if(s.max==-1)i(a(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let u=r();n(l,u),i(a(s.expr,l),u),l=u}return[n(l)]}else{if(s.type=="name")return[n(o,void 0,s.value)];throw new Error("Unknown expr type")}}}}function I7(t,e){return e-t}function hj(t,e){let r=[];return n(e),r.sort(I7);function n(i){let a=t[i];if(a.length==1&&!a[0].term)return n(a[0].to);r.push(i);for(let s=0;s<a.length;s++){let{term:o,to:l}=a[s];!o&&r.indexOf(l)==-1&&n(l)}}}function eX(t){let e=Object.create(null);return r(hj(t,0));function r(n){let i=[];n.forEach(s=>{t[s].forEach(({term:o,to:l})=>{if(!o)return;let c;for(let u=0;u<i.length;u++)i[u][0]==o&&(c=i[u][1]);hj(t,l).forEach(u=>{c||i.push([o,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let a=e[n.join(",")]=new Gc(n.indexOf(t.length-1)>-1);for(let s=0;s<i.length;s++){let o=i[s][1].sort(I7);a.next.push({type:i[s][0],next:e[o.join(",")]||r(o)})}return a}}function tX(t,e){for(let r=0,n=[t];r<n.length;r++){let i=n[r],a=!i.validEnd,s=[];for(let o=0;o<i.next.length;o++){let{type:l,next:c}=i.next[o];s.push(l.name),a&&!(l.isText||l.hasRequiredAttrs())&&(a=!1),n.indexOf(c)==-1&&n.push(c)}a&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function L7(t){let e=Object.create(null);for(let r in t){let n=t[r];if(!n.hasDefault)return null;e[r]=n.default}return e}function B7(t,e){let r=Object.create(null);for(let n in t){let i=e&&e[n];if(i===void 0){let a=t[n];if(a.hasDefault)i=a.default;else throw new RangeError("No value supplied for attribute "+n)}r[n]=i}return r}function F7(t,e,r,n){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${r} of type ${i}`);for(let i in t){let a=t[i];a.validate&&a.validate(e[i])}}function z7(t,e){let r=Object.create(null);if(e)for(let n in e)r[n]=new nX(t,n,e[n]);return r}let pj=class V7{constructor(e,r,n){this.name=e,this.schema=r,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=z7(e,n.attrs),this.defaultAttrs=L7(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Gc.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:B7(this.attrs,e)}create(e=null,r,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new qs(this,this.computeAttrs(e),be.from(r),Gt.setFrom(n))}createChecked(e=null,r,n){return r=be.from(r),this.checkContent(r),new qs(this,this.computeAttrs(e),r,Gt.setFrom(n))}createAndFill(e=null,r,n){if(e=this.computeAttrs(e),r=be.from(r),r.size){let s=this.contentMatch.fillBefore(r);if(!s)return null;r=s.append(r)}let i=this.contentMatch.matchFragment(r),a=i&&i.fillBefore(be.empty,!0);return a?new qs(this,e,r.append(a),Gt.setFrom(n)):null}validContent(e){let r=this.contentMatch.matchFragment(e);if(!r||!r.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){F7(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let r=0;r<e.length;r++)if(!this.allowsMarkType(e[r].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let r;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?r&&r.push(e[n]):r||(r=e.slice(0,n));return r?r.length?r:Gt.none:e}static compile(e,r){let n=Object.create(null);e.forEach((a,s)=>n[a]=new V7(a,r,s));let i=r.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let a in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}};function rX(t,e,r){let n=r.split("|");return i=>{let a=i===null?"null":typeof i;if(n.indexOf(a)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${t}, got ${a}`)}}class nX{constructor(e,r,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?rX(e,r,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class mx{constructor(e,r,n,i){this.name=e,this.rank=r,this.schema=n,this.spec=i,this.attrs=z7(e,i.attrs),this.excluded=null;let a=L7(this.attrs);this.instance=a?new Gt(this,a):null}create(e=null){return!e&&this.instance?this.instance:new Gt(this,B7(this.attrs,e))}static compile(e,r){let n=Object.create(null),i=0;return e.forEach((a,s)=>n[a]=new mx(a,i++,r,s)),n}removeFromSet(e){for(var r=0;r<e.length;r++)e[r].type==this&&(e=e.slice(0,r).concat(e.slice(r+1)),r--);return e}isInSet(e){for(let r=0;r<e.length;r++)if(e[r].type==this)return e[r]}checkAttrs(e){F7(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class $7{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let r=this.spec={};for(let i in e)r[i]=e[i];r.nodes=Sn.from(e.nodes),r.marks=Sn.from(e.marks||{}),this.nodes=pj.compile(this.spec.nodes,this),this.marks=mx.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let a=this.nodes[i],s=a.spec.content||"",o=a.spec.marks;if(a.contentMatch=n[s]||(n[s]=Gc.parse(s,this.nodes)),a.inlineContent=a.contentMatch.inlineContent,a.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!a.isInline||!a.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=a}a.markSet=o=="_"?null:o?mj(this,o.split(" ")):o==""||!a.inlineContent?[]:null}for(let i in this.marks){let a=this.marks[i],s=a.spec.excludes;a.excluded=s==null?[a]:s==""?[]:mj(this,s.split(" "))}this.nodeFromJSON=i=>qs.fromJSON(this,i),this.markFromJSON=i=>Gt.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,r=null,n,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof pj){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(r,n,i)}text(e,r){let n=this.nodes.text;return new F0(n,n.defaultAttrs,e,Gt.setFrom(r))}mark(e,r){return typeof e=="string"&&(e=this.marks[e]),e.create(r)}nodeType(e){let r=this.nodes[e];if(!r)throw new RangeError("Unknown node type: "+e);return r}}function mj(t,e){let r=[];for(let n=0;n<e.length;n++){let i=e[n],a=t.marks[i],s=a;if(a)r.push(a);else for(let o in t.marks){let l=t.marks[o];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&r.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return r}function iX(t){return t.tag!=null}function aX(t){return t.style!=null}class cl{constructor(e,r){this.schema=e,this.rules=r,this.tags=[],this.styles=[];let n=this.matchedStyles=[];r.forEach(i=>{if(iX(i))this.tags.push(i);else if(aX(i)){let a=/[^=]*/.exec(i.style)[0];n.indexOf(a)<0&&n.push(a),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let a=e.nodes[i.node];return a.contentMatch.matchType(a)})}parse(e,r={}){let n=new vj(this,r,!1);return n.addAll(e,Gt.none,r.from,r.to),n.finish()}parseSlice(e,r={}){let n=new vj(this,r,!0);return n.addAll(e,Gt.none,r.from,r.to),Ae.maxOpen(n.finish())}matchTag(e,r,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let a=this.tags[i];if(lX(e,a.tag)&&(a.namespace===void 0||e.namespaceURI==a.namespace)&&(!a.context||r.matchesContext(a.context))){if(a.getAttrs){let s=a.getAttrs(e);if(s===!1)continue;a.attrs=s||void 0}return a}}}matchStyle(e,r,n,i){for(let a=i?this.styles.indexOf(i)+1:0;a<this.styles.length;a++){let s=this.styles[a],o=s.style;if(!(o.indexOf(e)!=0||s.context&&!n.matchesContext(s.context)||o.length>e.length&&(o.charCodeAt(e.length)!=61||o.slice(e.length+1)!=r))){if(s.getAttrs){let l=s.getAttrs(r);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let r=[];function n(i){let a=i.priority==null?50:i.priority,s=0;for(;s<r.length;s++){let o=r[s];if((o.priority==null?50:o.priority)<a)break}r.splice(s,0,i)}for(let i in e.marks){let a=e.marks[i].spec.parseDOM;a&&a.forEach(s=>{n(s=yj(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let a=e.nodes[i].spec.parseDOM;a&&a.forEach(s=>{n(s=yj(s)),s.node||s.ignore||s.mark||(s.node=i)})}return r}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new cl(e,cl.schemaRules(e)))}}const U7={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},sX={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},G7={ol:!0,ul:!0},Mp=1,ak=2,Vh=4;function gj(t,e,r){return e!=null?(e?Mp:0)|(e==="full"?ak:0):t&&t.whitespace=="pre"?Mp|ak:r&~Vh}class Xg{constructor(e,r,n,i,a,s){this.type=e,this.attrs=r,this.marks=n,this.solid=i,this.options=s,this.content=[],this.activeMarks=Gt.none,this.match=a||(s&Vh?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let r=this.type.contentMatch.fillBefore(be.from(e));if(r)this.match=this.type.contentMatch.matchFragment(r);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Mp)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let a=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=a.withText(a.text.slice(0,a.text.length-i[0].length))}}let r=be.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(be.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!U7.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class vj{constructor(e,r,n){this.parser=e,this.options=r,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let i=r.topNode,a,s=gj(null,r.preserveWhitespace,0)|(n?Vh:0);i?a=new Xg(i.type,i.attrs,Gt.none,!0,r.topMatch||i.type.contentMatch,s):n?a=new Xg(null,null,Gt.none,!0,null,s):a=new Xg(e.schema.topNodeType,null,Gt.none,!0,null,s),this.nodes=[a],this.find=r.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,r){e.nodeType==3?this.addTextNode(e,r):e.nodeType==1&&this.addElement(e,r)}addTextNode(e,r){let n=e.nodeValue,i=this.top,a=i.options&ak?"full":this.localPreserveWS||(i.options&Mp)>0,{schema:s}=this.parser;if(a==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(a)if(a==="full")n=n.replace(/\r\n?/g,`
`);else if(s.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(s.linebreakReplacement.create())){let o=n.split(/\r?\n|\r/);for(let l=0;l<o.length;l++)l&&this.insertNode(s.linebreakReplacement.create(),r,!0),o[l]&&this.insertNode(s.text(o[l]),r,!/\S/.test(o[l]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let o=i.content[i.content.length-1],l=e.previousSibling;(!o||l&&l.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(n=n.slice(1))}n&&this.insertNode(s.text(n),r,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,r,n){let i=this.localPreserveWS,a=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),o;G7.hasOwnProperty(s)&&this.parser.normalizeLists&&oX(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,n));e:if(l?l.ignore:sX.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,r);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(U7.hasOwnProperty(s))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),c=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,r);break e}let f=l&&l.skip?r:this.readStyles(e,r);f&&this.addAll(e,f),c&&this.sync(a),this.needsBlock=u}else{let c=this.readStyles(e,r);c&&this.addElementByRule(e,l,c,l.consuming===!1?o:void 0)}this.localPreserveWS=i}leafFallback(e,r){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),r)}ignoreFallback(e,r){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),r,!0)}readStyles(e,r){let n=e.style;if(n&&n.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let a=this.parser.matchedStyles[i],s=n.getPropertyValue(a);if(s)for(let o=void 0;;){let l=this.parser.matchStyle(a,s,this,o);if(!l)break;if(l.ignore)return null;if(l.clearMark?r=r.filter(c=>!l.clearMark(c)):r=r.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)o=l;else break}}return r}addElementByRule(e,r,n,i){let a,s;if(r.node)if(s=this.parser.schema.nodes[r.node],s.isLeaf)this.insertNode(s.create(r.attrs),n,e.nodeName=="BR")||this.leafFallback(e,n);else{let l=this.enter(s,r.attrs||null,n,r.preserveWhitespace);l&&(a=!0,n=l)}else{let l=this.parser.schema.marks[r.mark];n=n.concat(l.create(r.attrs))}let o=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,n,i);else if(r.getContent)this.findInside(e),r.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,n,!1));else{let l=e;typeof r.contentElement=="string"?l=e.querySelector(r.contentElement):typeof r.contentElement=="function"?l=r.contentElement(e):r.contentElement&&(l=r.contentElement),this.findAround(e,l,!0),this.addAll(l,n),this.findAround(e,l,!1)}a&&this.sync(o)&&this.open--}addAll(e,r,n,i){let a=n||0;for(let s=n?e.childNodes[n]:e.firstChild,o=i==null?null:e.childNodes[i];s!=o;s=s.nextSibling,++a)this.findAtPoint(e,a),this.addDOM(s,r);this.findAtPoint(e,a)}findPlace(e,r,n){let i,a;for(let s=this.open,o=0;s>=0;s--){let l=this.nodes[s],c=l.findWrapping(e);if(c&&(!i||i.length>c.length+o)&&(i=c,a=l,!c.length))break;if(l.solid){if(n)break;o+=2}}if(!i)return null;this.sync(a);for(let s=0;s<i.length;s++)r=this.enterInner(i[s],null,r,!1);return r}insertNode(e,r,n){if(e.isInline&&this.needsBlock&&!this.top.type){let a=this.textblockFromContext();a&&(r=this.enterInner(a,null,r))}let i=this.findPlace(e,r,n);if(i){this.closeExtra();let a=this.top;a.match&&(a.match=a.match.matchType(e.type));let s=Gt.none;for(let o of i.concat(e.marks))(a.type?a.type.allowsMarkType(o.type):xj(o.type,e.type))&&(s=o.addToSet(s));return a.content.push(e.mark(s)),!0}return!1}enter(e,r,n,i){let a=this.findPlace(e.create(r),n,!1);return a&&(a=this.enterInner(e,r,n,!0,i)),a}enterInner(e,r,n,i=!1,a){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let o=gj(e,a,s.options);s.options&Vh&&s.content.length==0&&(o|=Vh);let l=Gt.none;return n=n.filter(c=>(s.type?s.type.allowsMarkType(c.type):xj(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Xg(e,r,l,i,null,o)),this.open++,n}closeExtra(e=!1){let r=this.nodes.length-1;if(r>this.open){for(;r>this.open;r--)this.nodes[r-1].content.push(this.nodes[r].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let r=this.open;r>=0;r--){if(this.nodes[r]==e)return this.open=r,!0;this.localPreserveWS&&(this.nodes[r].options|=Mp)}return!1}get currentPos(){this.closeExtra();let e=0;for(let r=this.open;r>=0;r--){let n=this.nodes[r].content;for(let i=n.length-1;i>=0;i--)e+=n[i].nodeSize;r&&e++}return e}findAtPoint(e,r){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==r&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].pos==null&&e.nodeType==1&&e.contains(this.find[r].node)&&(this.find[r].pos=this.currentPos)}findAround(e,r,n){if(e!=r&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&r.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&(this.find[r].pos=this.currentPos-(e.nodeValue.length-this.find[r].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let r=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),a=-(n?n.depth+1:0)+(i?0:1),s=(o,l)=>{for(;o>=0;o--){let c=r[o];if(c==""){if(o==r.length-1||o==0)continue;for(;l>=a;l--)if(s(o-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:n&&l>=a?n.node(l-a).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return s(r.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let r=e.depth;r>=0;r--){let n=e.node(r).contentMatchAt(e.indexAfter(r)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let r in this.parser.schema.nodes){let n=this.parser.schema.nodes[r];if(n.isTextblock&&n.defaultAttrs)return n}}}function oX(t){for(let e=t.firstChild,r=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&G7.hasOwnProperty(n)&&r?(r.appendChild(e),e=r):n=="li"?r=e:n&&(r=null)}}function lX(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function yj(t){let e={};for(let r in t)e[r]=t[r];return e}function xj(t,e){let r=e.schema.nodes;for(let n in r){let i=r[n];if(!i.allowsMarkType(t))continue;let a=[],s=o=>{a.push(o);for(let l=0;l<o.edgeCount;l++){let{type:c,next:u}=o.edge(l);if(c==e||a.indexOf(u)<0&&s(u))return!0}};if(s(i.contentMatch))return!0}}class tu{constructor(e,r){this.nodes=e,this.marks=r}serializeFragment(e,r={},n){n||(n=X2(r).createDocumentFragment());let i=n,a=[];return e.forEach(s=>{if(a.length||s.marks.length){let o=0,l=0;for(;o<a.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(a[o][0])||c.type.spec.spanning===!1)break;o++,l++}for(;o<a.length;)i=a.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],u=this.serializeMark(c,s.isInline,r);u&&(a.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(s,r))}),n}serializeNodeInner(e,r){let{dom:n,contentDOM:i}=Bv(X2(r),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,r,i)}return n}serializeNode(e,r={}){let n=this.serializeNodeInner(e,r);for(let i=e.marks.length-1;i>=0;i--){let a=this.serializeMark(e.marks[i],e.isInline,r);a&&((a.contentDOM||a.dom).appendChild(n),n=a.dom)}return n}serializeMark(e,r,n={}){let i=this.marks[e.type.name];return i&&Bv(X2(n),i(e,r),null,e.attrs)}static renderSpec(e,r,n=null,i){return Bv(e,r,n,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new tu(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let r=bj(e.nodes);return r.text||(r.text=n=>n.text),r}static marksFromSchema(e){return bj(e.marks)}}function bj(t){let e={};for(let r in t){let n=t[r].spec.toDOM;n&&(e[r]=n)}return e}function X2(t){return t.document||window.document}const wj=new WeakMap;function cX(t){let e=wj.get(t);return e===void 0&&wj.set(t,e=uX(t)),e}function uX(t){let e=null;function r(n){if(n&&typeof n=="object")if(Array.isArray(n))if(typeof n[0]=="string")e||(e=[]),e.push(n);else for(let i=0;i<n.length;i++)r(n[i]);else for(let i in n)r(n[i])}return r(t),e}function Bv(t,e,r,n){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],a;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(n&&(a=cX(n))&&a.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,l=r?t.createElementNS(r,i):t.createElement(i),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let f in c)if(c[f]!=null){let h=f.indexOf(" ");h>0?l.setAttributeNS(f.slice(0,h),f.slice(h+1),c[f]):f=="style"&&l.style?l.style.cssText=c[f]:l.setAttribute(f,c[f])}}for(let f=u;f<e.length;f++){let h=e[f];if(h===0){if(f<e.length-1||f>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:m,contentDOM:v}=Bv(t,h,r,n);if(l.appendChild(m),v){if(o)throw new RangeError("Multiple content holes");o=v}}}return{dom:l,contentDOM:o}}const H7=65535,W7=Math.pow(2,16);function dX(t,e){return t+e*W7}function Sj(t){return t&H7}function fX(t){return(t-(t&H7))/W7}const q7=1,K7=2,Fv=4,Y7=8;class sk{constructor(e,r,n){this.pos=e,this.delInfo=r,this.recover=n}get deleted(){return(this.delInfo&Y7)>0}get deletedBefore(){return(this.delInfo&(q7|Fv))>0}get deletedAfter(){return(this.delInfo&(K7|Fv))>0}get deletedAcross(){return(this.delInfo&Fv)>0}}class Mi{constructor(e,r=!1){if(this.ranges=e,this.inverted=r,!e.length&&Mi.empty)return Mi.empty}recover(e){let r=0,n=Sj(e);if(!this.inverted)for(let i=0;i<n;i++)r+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[n*3]+r+fX(e)}mapResult(e,r=1){return this._map(e,r,!1)}map(e,r=1){return this._map(e,r,!0)}_map(e,r,n){let i=0,a=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[o+a],u=this.ranges[o+s],f=l+c;if(e<=f){let h=c?e==l?-1:e==f?1:r:r,m=l+i+(h<0?0:u);if(n)return m;let v=e==(r<0?l:f)?null:dX(o/3,e-l),y=e==l?K7:e==f?q7:Fv;return(r<0?e!=l:e!=f)&&(y|=Y7),new sk(m,y,v)}i+=u-c}return n?e+i:new sk(e+i,0,null)}touches(e,r){let n=0,i=Sj(r),a=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let l=this.ranges[o]-(this.inverted?n:0);if(l>e)break;let c=this.ranges[o+a],u=l+c;if(e<=u&&o==i*3)return!0;n+=this.ranges[o+s]-c}return!1}forEach(e){let r=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,a=0;i<this.ranges.length;i+=3){let s=this.ranges[i],o=s-(this.inverted?a:0),l=s+(this.inverted?0:a),c=this.ranges[i+r],u=this.ranges[i+n];e(o,o+c,l,l+u),a+=u-c}}invert(){return new Mi(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Mi.empty:new Mi(e<0?[0,-e,0]:[0,0,e])}}Mi.empty=new Mi([]);class Pp{constructor(e,r,n=0,i=e?e.length:0){this.mirror=r,this.from=n,this.to=i,this._maps=e||[],this.ownData=!(e||r)}get maps(){return this._maps}slice(e=0,r=this.maps.length){return new Pp(this._maps,this.mirror,e,r)}appendMap(e,r){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),r!=null&&this.setMirror(this._maps.length-1,r)}appendMapping(e){for(let r=0,n=this._maps.length;r<e._maps.length;r++){let i=e.getMirror(r);this.appendMap(e._maps[r],i!=null&&i<r?n+i:void 0)}}getMirror(e){if(this.mirror){for(let r=0;r<this.mirror.length;r++)if(this.mirror[r]==e)return this.mirror[r+(r%2?-1:1)]}}setMirror(e,r){this.mirror||(this.mirror=[]),this.mirror.push(e,r)}appendMappingInverted(e){for(let r=e.maps.length-1,n=this._maps.length+e._maps.length;r>=0;r--){let i=e.getMirror(r);this.appendMap(e._maps[r].invert(),i!=null&&i>r?n-i-1:void 0)}}invert(){let e=new Pp;return e.appendMappingInverted(this),e}map(e,r=1){if(this.mirror)return this._map(e,r,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,r);return e}mapResult(e,r=1){return this._map(e,r,!1)}_map(e,r,n){let i=0;for(let a=this.from;a<this.to;a++){let s=this._maps[a],o=s.mapResult(e,r);if(o.recover!=null){let l=this.getMirror(a);if(l!=null&&l>a&&l<this.to){a=l,e=this._maps[l].recover(o.recover);continue}}i|=o.delInfo,e=o.pos}return n?e:new sk(e,i,null)}}const Q2=Object.create(null);class qn{getMap(){return Mi.empty}merge(e){return null}static fromJSON(e,r){if(!r||!r.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=Q2[r.stepType];if(!n)throw new RangeError(`No step type ${r.stepType} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in Q2)throw new RangeError("Duplicate use of step JSON ID "+e);return Q2[e]=r,r.prototype.jsonID=e,r}}class $r{constructor(e,r){this.doc=e,this.failed=r}static ok(e){return new $r(e,null)}static fail(e){return new $r(null,e)}static fromReplace(e,r,n,i){try{return $r.ok(e.replace(r,n,i))}catch(a){if(a instanceof I0)return $r.fail(a.message);throw a}}}function b3(t,e,r){let n=[];for(let i=0;i<t.childCount;i++){let a=t.child(i);a.content.size&&(a=a.copy(b3(a.content,e,a))),a.isInline&&(a=e(a,r,i)),n.push(a)}return be.fromArray(n)}class Yo extends qn{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),a=new Ae(b3(r.content,(s,o)=>!s.isAtom||!o.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),r.openStart,r.openEnd);return $r.fromReplace(e,this.from,this.to,a)}invert(){return new Pa(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new Yo(r.pos,n.pos,this.mark)}merge(e){return e instanceof Yo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Yo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Yo(r.from,r.to,e.markFromJSON(r.mark))}}qn.jsonID("addMark",Yo);class Pa extends qn{constructor(e,r,n){super(),this.from=e,this.to=r,this.mark=n}apply(e){let r=e.slice(this.from,this.to),n=new Ae(b3(r.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),r.openStart,r.openEnd);return $r.fromReplace(e,this.from,this.to,n)}invert(){return new Yo(this.from,this.to,this.mark)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deleted&&n.deleted||r.pos>=n.pos?null:new Pa(r.pos,n.pos,this.mark)}merge(e){return e instanceof Pa&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Pa(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Pa(r.from,r.to,e.markFromJSON(r.mark))}}qn.jsonID("removeMark",Pa);class Xo extends qn{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return $r.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.addToSet(r.marks));return $r.fromReplace(e,this.pos,this.pos+1,new Ae(be.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);if(r){let n=this.mark.addToSet(r.marks);if(n.length==r.marks.length){for(let i=0;i<r.marks.length;i++)if(!r.marks[i].isInSet(n))return new Xo(this.pos,r.marks[i]);return new Xo(this.pos,this.mark)}}return new Hc(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new Xo(r.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Xo(r.pos,e.markFromJSON(r.mark))}}qn.jsonID("addNodeMark",Xo);class Hc extends qn{constructor(e,r){super(),this.pos=e,this.mark=r}apply(e){let r=e.nodeAt(this.pos);if(!r)return $r.fail("No node at mark step's position");let n=r.type.create(r.attrs,null,this.mark.removeFromSet(r.marks));return $r.fromReplace(e,this.pos,this.pos+1,new Ae(be.from(n),0,r.isLeaf?0:1))}invert(e){let r=e.nodeAt(this.pos);return!r||!this.mark.isInSet(r.marks)?this:new Xo(this.pos,this.mark)}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new Hc(r.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Hc(r.pos,e.markFromJSON(r.mark))}}qn.jsonID("removeNodeMark",Hc);class dn extends qn{constructor(e,r,n,i=!1){super(),this.from=e,this.to=r,this.slice=n,this.structure=i}apply(e){return this.structure&&ok(e,this.from,this.to)?$r.fail("Structure replace would overwrite content"):$r.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Mi([this.from,this.to-this.from,this.slice.size])}invert(e){return new dn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return r.deletedAcross&&n.deletedAcross?null:new dn(r.pos,Math.max(r.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof dn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let r=this.slice.size+e.slice.size==0?Ae.empty:new Ae(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new dn(this.from,this.to+(e.to-e.from),r,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let r=this.slice.size+e.slice.size==0?Ae.empty:new Ae(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new dn(e.from,this.to,r,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new dn(r.from,r.to,Ae.fromJSON(e,r.slice),!!r.structure)}}qn.jsonID("replace",dn);class mn extends qn{constructor(e,r,n,i,a,s,o=!1){super(),this.from=e,this.to=r,this.gapFrom=n,this.gapTo=i,this.slice=a,this.insert=s,this.structure=o}apply(e){if(this.structure&&(ok(e,this.from,this.gapFrom)||ok(e,this.gapTo,this.to)))return $r.fail("Structure gap-replace would overwrite content");let r=e.slice(this.gapFrom,this.gapTo);if(r.openStart||r.openEnd)return $r.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,r.content);return n?$r.fromReplace(e,this.from,this.to,n):$r.fail("Content does not fit in gap")}getMap(){return new Mi([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let r=this.gapTo-this.gapFrom;return new mn(this.from,this.from+this.slice.size+r,this.from+this.insert,this.from+this.insert+r,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let r=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=this.from==this.gapFrom?r.pos:e.map(this.gapFrom,-1),a=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return r.deletedAcross&&n.deletedAcross||i<r.pos||a>n.pos?null:new mn(r.pos,n.pos,i,a,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,r){if(typeof r.from!="number"||typeof r.to!="number"||typeof r.gapFrom!="number"||typeof r.gapTo!="number"||typeof r.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new mn(r.from,r.to,r.gapFrom,r.gapTo,Ae.fromJSON(e,r.slice),r.insert,!!r.structure)}}qn.jsonID("replaceAround",mn);function ok(t,e,r){let n=t.resolve(e),i=r-e,a=n.depth;for(;i>0&&a>0&&n.indexAfter(a)==n.node(a).childCount;)a--,i--;if(i>0){let s=n.node(a).maybeChild(n.indexAfter(a));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function hX(t,e,r,n){let i=[],a=[],s,o;t.doc.nodesBetween(e,r,(l,c,u)=>{if(!l.isInline)return;let f=l.marks;if(!n.isInSet(f)&&u.type.allowsMarkType(n.type)){let h=Math.max(c,e),m=Math.min(c+l.nodeSize,r),v=n.addToSet(f);for(let y=0;y<f.length;y++)f[y].isInSet(v)||(s&&s.to==h&&s.mark.eq(f[y])?s.to=m:i.push(s=new Pa(h,m,f[y])));o&&o.to==h?o.to=m:a.push(o=new Yo(h,m,n))}}),i.forEach(l=>t.step(l)),a.forEach(l=>t.step(l))}function pX(t,e,r,n){let i=[],a=0;t.doc.nodesBetween(e,r,(s,o)=>{if(!s.isInline)return;a++;let l=null;if(n instanceof mx){let c=s.marks,u;for(;u=n.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else n?n.isInSet(s.marks)&&(l=[n]):l=s.marks;if(l&&l.length){let c=Math.min(o+s.nodeSize,r);for(let u=0;u<l.length;u++){let f=l[u],h;for(let m=0;m<i.length;m++){let v=i[m];v.step==a-1&&f.eq(i[m].style)&&(h=v)}h?(h.to=c,h.step=a):i.push({style:f,from:Math.max(o,e),to:c,step:a})}}}),i.forEach(s=>t.step(new Pa(s.from,s.to,s.style)))}function w3(t,e,r,n=r.contentMatch,i=!0){let a=t.doc.nodeAt(e),s=[],o=e+1;for(let l=0;l<a.childCount;l++){let c=a.child(l),u=o+c.nodeSize,f=n.matchType(c.type);if(!f)s.push(new dn(o,u,Ae.empty));else{n=f;for(let h=0;h<c.marks.length;h++)r.allowsMarkType(c.marks[h].type)||t.step(new Pa(o,u,c.marks[h]));if(i&&c.isText&&r.whitespace!="pre"){let h,m=/\r?\n|\r/g,v;for(;h=m.exec(c.text);)v||(v=new Ae(be.from(r.schema.text(" ",r.allowedMarks(c.marks))),0,0)),s.push(new dn(o+h.index,o+h.index+h[0].length,v))}}o=u}if(!n.validEnd){let l=n.fillBefore(be.empty,!0);t.replace(o,o,new Ae(l,0,0))}for(let l=s.length-1;l>=0;l--)t.step(s[l])}function mX(t,e,r){return(e==0||t.canReplace(e,t.childCount))&&(r==t.childCount||t.canReplace(0,r))}function cf(t){let r=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let n=t.depth,i=0,a=0;;--n){let s=t.$from.node(n),o=t.$from.index(n)+i,l=t.$to.indexAfter(n)-a;if(n<t.depth&&s.canReplace(o,l,r))return n;if(n==0||s.type.spec.isolating||!mX(s,o,l))break;o&&(i=1),l<s.childCount&&(a=1)}return null}function gX(t,e,r){let{$from:n,$to:i,depth:a}=e,s=n.before(a+1),o=i.after(a+1),l=s,c=o,u=be.empty,f=0;for(let v=a,y=!1;v>r;v--)y||n.index(v)>0?(y=!0,u=be.from(n.node(v).copy(u)),f++):l--;let h=be.empty,m=0;for(let v=a,y=!1;v>r;v--)y||i.after(v+1)<i.end(v)?(y=!0,h=be.from(i.node(v).copy(h)),m++):c++;t.step(new mn(l,c,s,o,new Ae(u.append(h),f,m),u.size-f,!0))}function S3(t,e,r=null,n=t){let i=vX(t,e),a=i&&yX(n,e);return a?i.map(kj).concat({type:e,attrs:r}).concat(a.map(kj)):null}function kj(t){return{type:t,attrs:null}}function vX(t,e){let{parent:r,startIndex:n,endIndex:i}=t,a=r.contentMatchAt(n).findWrapping(e);if(!a)return null;let s=a.length?a[0]:e;return r.canReplaceWith(n,i,s)?a:null}function yX(t,e){let{parent:r,startIndex:n,endIndex:i}=t,a=r.child(n),s=e.contentMatch.findWrapping(a.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=n;l&&c<i;c++)l=l.matchType(r.child(c).type);return!l||!l.validEnd?null:s}function xX(t,e,r){let n=be.empty;for(let s=r.length-1;s>=0;s--){if(n.size){let o=r[s].type.contentMatch.matchFragment(n);if(!o||!o.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=be.from(r[s].type.create(r[s].attrs,n))}let i=e.start,a=e.end;t.step(new mn(i,a,i,a,new Ae(n,0,0),r.length,!0))}function bX(t,e,r,n,i){if(!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let a=t.steps.length;t.doc.nodesBetween(e,r,(s,o)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(n,l)&&wX(t.doc,t.mapping.slice(a).map(o),n)){let c=null;if(n.schema.linebreakReplacement){let m=n.whitespace=="pre",v=!!n.contentMatch.matchType(n.schema.linebreakReplacement);m&&!v?c=!1:!m&&v&&(c=!0)}c===!1&&Q7(t,s,o,a),w3(t,t.mapping.slice(a).map(o,1),n,void 0,c===null);let u=t.mapping.slice(a),f=u.map(o,1),h=u.map(o+s.nodeSize,1);return t.step(new mn(f,h,f+1,h-1,new Ae(be.from(n.create(l,null,s.marks)),0,0),1,!0)),c===!0&&X7(t,s,o,a),!1}})}function X7(t,e,r,n){e.forEach((i,a)=>{if(i.isText){let s,o=/\r?\n|\r/g;for(;s=o.exec(i.text);){let l=t.mapping.slice(n).map(r+1+a+s.index);t.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function Q7(t,e,r,n){e.forEach((i,a)=>{if(i.type==i.type.schema.linebreakReplacement){let s=t.mapping.slice(n).map(r+1+a);t.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function wX(t,e,r){let n=t.resolve(e),i=n.index();return n.parent.canReplaceWith(i,i+1,r)}function SX(t,e,r,n,i){let a=t.doc.nodeAt(e);if(!a)throw new RangeError("No node at given position");r||(r=a.type);let s=r.create(n,null,i||a.marks);if(a.isLeaf)return t.replaceWith(e,e+a.nodeSize,s);if(!r.validContent(a.content))throw new RangeError("Invalid content for node type "+r.name);t.step(new mn(e,e+a.nodeSize,e+1,e+a.nodeSize-1,new Ae(be.from(s),0,0),1,!0))}function Sd(t,e,r=1,n){let i=t.resolve(e),a=i.depth-r,s=n&&n[n.length-1]||i.parent;if(a<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=r-2;c>a;c--,u--){let f=i.node(c),h=i.index(c);if(f.type.spec.isolating)return!1;let m=f.content.cutByIndex(h,f.childCount),v=n&&n[u+1];v&&(m=m.replaceChild(0,v.type.create(v.attrs)));let y=n&&n[u]||f;if(!f.canReplace(h+1,f.childCount)||!y.type.validContent(m))return!1}let o=i.indexAfter(a),l=n&&n[0];return i.node(a).canReplaceWith(o,o,l?l.type:i.node(a+1).type)}function kX(t,e,r=1,n){let i=t.doc.resolve(e),a=be.empty,s=be.empty;for(let o=i.depth,l=i.depth-r,c=r-1;o>l;o--,c--){a=be.from(i.node(o).copy(a));let u=n&&n[c];s=be.from(u?u.type.create(u.attrs,s):i.node(o).copy(s))}t.step(new dn(e,e,new Ae(a.append(s),r,r),!0))}function Dl(t,e){let r=t.resolve(e),n=r.index();return J7(r.nodeBefore,r.nodeAfter)&&r.parent.canReplace(n,n+1)}function CX(t,e){e.content.size||t.type.compatibleContent(e.type);let r=t.contentMatchAt(t.childCount),{linebreakReplacement:n}=t.type.schema;for(let i=0;i<e.childCount;i++){let a=e.child(i),s=a.type==n?t.type.schema.nodes.text:a.type;if(r=r.matchType(s),!r||!t.type.allowsMarks(a.marks))return!1}return r.validEnd}function J7(t,e){return!!(t&&e&&!t.isLeaf&&CX(t,e))}function gx(t,e,r=-1){let n=t.resolve(e);for(let i=n.depth;;i--){let a,s,o=n.index(i);if(i==n.depth?(a=n.nodeBefore,s=n.nodeAfter):r>0?(a=n.node(i+1),o++,s=n.node(i).maybeChild(o)):(a=n.node(i).maybeChild(o-1),s=n.node(i+1)),a&&!a.isTextblock&&J7(a,s)&&n.node(i).canReplace(o,o+1))return e;if(i==0)break;e=r<0?n.before(i):n.after(i)}}function NX(t,e,r){let n=null,{linebreakReplacement:i}=t.doc.type.schema,a=t.doc.resolve(e-r),s=a.node().type;if(i&&s.inlineContent){let u=s.whitespace=="pre",f=!!s.contentMatch.matchType(i);u&&!f?n=!1:!u&&f&&(n=!0)}let o=t.steps.length;if(n===!1){let u=t.doc.resolve(e+r);Q7(t,u.node(),u.before(),o)}s.inlineContent&&w3(t,e+r-1,s,a.node().contentMatchAt(a.index()),n==null);let l=t.mapping.slice(o),c=l.map(e-r);if(t.step(new dn(c,l.map(e+r,-1),Ae.empty,!0)),n===!0){let u=t.doc.resolve(c);X7(t,u.node(),u.before(),t.steps.length)}return t}function EX(t,e,r){let n=t.resolve(e);if(n.parent.canReplaceWith(n.index(),n.index(),r))return e;if(n.parentOffset==0)for(let i=n.depth-1;i>=0;i--){let a=n.index(i);if(n.node(i).canReplaceWith(a,a,r))return n.before(i+1);if(a>0)return null}if(n.parentOffset==n.parent.content.size)for(let i=n.depth-1;i>=0;i--){let a=n.indexAfter(i);if(n.node(i).canReplaceWith(a,a,r))return n.after(i+1);if(a<n.node(i).childCount)return null}return null}function Z7(t,e,r){let n=t.resolve(e);if(!r.content.size)return e;let i=r.content;for(let a=0;a<r.openStart;a++)i=i.firstChild.content;for(let a=1;a<=(r.openStart==0&&r.size?2:1);a++)for(let s=n.depth;s>=0;s--){let o=s==n.depth?0:n.pos<=(n.start(s+1)+n.end(s+1))/2?-1:1,l=n.index(s)+(o>0?1:0),c=n.node(s),u=!1;if(a==1)u=c.canReplace(l,l,i);else{let f=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=f&&c.canReplaceWith(l,l,f[0])}if(u)return o==0?n.pos:o<0?n.before(s+1):n.after(s+1)}return null}function vx(t,e,r=e,n=Ae.empty){if(e==r&&!n.size)return null;let i=t.resolve(e),a=t.resolve(r);return eD(i,a,n)?new dn(e,r,n):new TX(i,a,n).fit()}function eD(t,e,r){return!r.openStart&&!r.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),r.content)}class TX{constructor(e,r,n){this.$from=e,this.$to=r,this.unplaced=n,this.frontier=[],this.placed=be.empty;for(let i=0;i<=e.depth;i++){let a=e.node(i);this.frontier.push({type:a.type,match:a.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=be.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let a=this.placed,s=n.depth,o=i.depth;for(;s&&o&&a.childCount==1;)a=a.firstChild.content,s--,o--;let l=new Ae(a,s,o);return e>-1?new mn(n.pos,e,this.$to.pos,this.$to.end(),l,r):l.size||n.pos!=this.$to.pos?new dn(n.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let r=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let a=r.firstChild;if(r.childCount>1&&(i=0),a.type.spec.isolating&&i<=n){e=n;break}r=a.content}for(let r=1;r<=2;r++)for(let n=r==1?e:this.unplaced.openStart;n>=0;n--){let i,a=null;n?(a=J2(this.unplaced.content,n-1).firstChild,i=a.content):i=this.unplaced.content;let s=i.firstChild;for(let o=this.depth;o>=0;o--){let{type:l,match:c}=this.frontier[o],u,f=null;if(r==1&&(s?c.matchType(s.type)||(f=c.fillBefore(be.from(s),!1)):a&&l.compatibleContent(a.type)))return{sliceDepth:n,frontierDepth:o,parent:a,inject:f};if(r==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:o,parent:a,wrap:u};if(a&&c.matchType(a.type))break}}}openMore(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=J2(e,r);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new Ae(e,r+1,Math.max(n,i.size+r>=e.size-n?r+1:0)),!0)}dropNode(){let{content:e,openStart:r,openEnd:n}=this.unplaced,i=J2(e,r);if(i.childCount<=1&&r>0){let a=e.size-r<=r+i.size;this.unplaced=new Ae(Sh(e,r-1,1),r-1,a?r-1:n)}else this.unplaced=new Ae(Sh(e,r,1),r,n)}placeNodes({sliceDepth:e,frontierDepth:r,parent:n,inject:i,wrap:a}){for(;this.depth>r;)this.closeFrontierNode();if(a)for(let y=0;y<a.length;y++)this.openFrontierNode(a[y]);let s=this.unplaced,o=n?n.content:s.content,l=s.openStart-e,c=0,u=[],{match:f,type:h}=this.frontier[r];if(i){for(let y=0;y<i.childCount;y++)u.push(i.child(y));f=f.matchFragment(i)}let m=o.size+e-(s.content.size-s.openEnd);for(;c<o.childCount;){let y=o.child(c),x=f.matchType(y.type);if(!x)break;c++,(c>1||l==0||y.content.size)&&(f=x,u.push(tD(y.mark(h.allowedMarks(y.marks)),c==1?l:0,c==o.childCount?m:-1)))}let v=c==o.childCount;v||(m=-1),this.placed=kh(this.placed,r,be.from(u)),this.frontier[r].match=f,v&&m<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let y=0,x=o;y<m;y++){let b=x.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),x=b.content}this.unplaced=v?e==0?Ae.empty:new Ae(Sh(s.content,e-1,1),e-1,m<0?s.openEnd:e-1):new Ae(Sh(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],r;if(!e.type.isTextblock||!Z2(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(r=this.findCloseLevel(this.$to))&&r.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let r=Math.min(this.depth,e.depth);r>=0;r--){let{match:n,type:i}=this.frontier[r],a=r<e.depth&&e.end(r+1)==e.pos+(e.depth-(r+1)),s=Z2(e,r,i,n,a);if(s){for(let o=r-1;o>=0;o--){let{match:l,type:c}=this.frontier[o],u=Z2(e,o,c,l,!0);if(!u||u.childCount)continue e}return{depth:r,fit:s,move:a?e.doc.resolve(e.after(r+1)):e}}}}close(e){let r=this.findCloseLevel(e);if(!r)return null;for(;this.depth>r.depth;)this.closeFrontierNode();r.fit.childCount&&(this.placed=kh(this.placed,r.depth,r.fit)),e=r.move;for(let n=r.depth+1;n<=e.depth;n++){let i=e.node(n),a=i.type.contentMatch.fillBefore(i.content,!0,e.index(n));this.openFrontierNode(i.type,i.attrs,a)}return e}openFrontierNode(e,r=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=kh(this.placed,this.depth,be.from(e.create(r,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let r=this.frontier.pop().match.fillBefore(be.empty,!0);r.childCount&&(this.placed=kh(this.placed,this.frontier.length,r))}}function Sh(t,e,r){return e==0?t.cutByIndex(r,t.childCount):t.replaceChild(0,t.firstChild.copy(Sh(t.firstChild.content,e-1,r)))}function kh(t,e,r){return e==0?t.append(r):t.replaceChild(t.childCount-1,t.lastChild.copy(kh(t.lastChild.content,e-1,r)))}function J2(t,e){for(let r=0;r<e;r++)t=t.firstChild.content;return t}function tD(t,e,r){if(e<=0)return t;let n=t.content;return e>1&&(n=n.replaceChild(0,tD(n.firstChild,e-1,n.childCount==1?r-1:0))),e>0&&(n=t.type.contentMatch.fillBefore(n).append(n),r<=0&&(n=n.append(t.type.contentMatch.matchFragment(n).fillBefore(be.empty,!0)))),t.copy(n)}function Z2(t,e,r,n,i){let a=t.node(e),s=i?t.indexAfter(e):t.index(e);if(s==a.childCount&&!r.compatibleContent(a.type))return null;let o=n.fillBefore(a.content,!0,s);return o&&!jX(r,a.content,s)?o:null}function jX(t,e,r){for(let n=r;n<e.childCount;n++)if(!t.allowsMarks(e.child(n).marks))return!0;return!1}function MX(t){return t.spec.defining||t.spec.definingForContent}function PX(t,e,r,n){if(!n.size)return t.deleteRange(e,r);let i=t.doc.resolve(e),a=t.doc.resolve(r);if(eD(i,a,n))return t.step(new dn(e,r,n));let s=nD(i,a);s[s.length-1]==0&&s.pop();let o=-(i.depth+1);s.unshift(o);for(let h=i.depth,m=i.pos-1;h>0;h--,m--){let v=i.node(h).type.spec;if(v.defining||v.definingAsContext||v.isolating)break;s.indexOf(h)>-1?o=h:i.before(h)==m&&s.splice(1,0,-h)}let l=s.indexOf(o),c=[],u=n.openStart;for(let h=n.content,m=0;;m++){let v=h.firstChild;if(c.push(v),m==n.openStart)break;h=v.content}for(let h=u-1;h>=0;h--){let m=c[h],v=MX(m.type);if(v&&!m.sameMarkup(i.node(Math.abs(o)-1)))u=h;else if(v||!m.type.isTextblock)break}for(let h=n.openStart;h>=0;h--){let m=(h+u+1)%(n.openStart+1),v=c[m];if(v)for(let y=0;y<s.length;y++){let x=s[(y+l)%s.length],b=!0;x<0&&(b=!1,x=-x);let S=i.node(x-1),w=i.index(x-1);if(S.canReplaceWith(w,w,v.type,v.marks))return t.replace(i.before(x),b?a.after(x):r,new Ae(rD(n.content,0,n.openStart,m),m,n.openEnd))}}let f=t.steps.length;for(let h=s.length-1;h>=0&&(t.replace(e,r,n),!(t.steps.length>f));h--){let m=s[h];m<0||(e=i.before(m),r=a.after(m))}}function rD(t,e,r,n,i){if(e<r){let a=t.firstChild;t=t.replaceChild(0,a.copy(rD(a.content,e+1,r,n,a)))}if(e>n){let a=i.contentMatchAt(0),s=a.fillBefore(t).append(t);t=s.append(a.matchFragment(s).fillBefore(be.empty,!0))}return t}function _X(t,e,r,n){if(!n.isInline&&e==r&&t.doc.resolve(e).parent.content.size){let i=EX(t.doc,e,n.type);i!=null&&(e=r=i)}t.replaceRange(e,r,new Ae(be.from(n),0,0))}function AX(t,e,r){let n=t.doc.resolve(e),i=t.doc.resolve(r),a=nD(n,i);for(let s=0;s<a.length;s++){let o=a[s],l=s==a.length-1;if(l&&o==0||n.node(o).type.contentMatch.validEnd)return t.delete(n.start(o),i.end(o));if(o>0&&(l||n.node(o-1).canReplace(n.index(o-1),i.indexAfter(o-1))))return t.delete(n.before(o),i.after(o))}for(let s=1;s<=n.depth&&s<=i.depth;s++)if(e-n.start(s)==n.depth-s&&r>n.end(s)&&i.end(s)-r!=i.depth-s&&n.start(s-1)==i.start(s-1)&&n.node(s-1).canReplace(n.index(s-1),i.index(s-1)))return t.delete(n.before(s),r);t.delete(e,r)}function nD(t,e){let r=[],n=Math.min(t.depth,e.depth);for(let i=n;i>=0;i--){let a=t.start(i);if(a<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(a==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==a-1)&&r.push(i)}return r}class kd extends qn{constructor(e,r,n){super(),this.pos=e,this.attr=r,this.value=n}apply(e){let r=e.nodeAt(this.pos);if(!r)return $r.fail("No node at attribute step's position");let n=Object.create(null);for(let a in r.attrs)n[a]=r.attrs[a];n[this.attr]=this.value;let i=r.type.create(n,null,r.marks);return $r.fromReplace(e,this.pos,this.pos+1,new Ae(be.from(i),0,r.isLeaf?0:1))}getMap(){return Mi.empty}invert(e){return new kd(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let r=e.mapResult(this.pos,1);return r.deletedAfter?null:new kd(r.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.pos!="number"||typeof r.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new kd(r.pos,r.attr,r.value)}}qn.jsonID("attr",kd);class _p extends qn{constructor(e,r){super(),this.attr=e,this.value=r}apply(e){let r=Object.create(null);for(let i in e.attrs)r[i]=e.attrs[i];r[this.attr]=this.value;let n=e.type.create(r,e.content,e.marks);return $r.ok(n)}getMap(){return Mi.empty}invert(e){return new _p(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,r){if(typeof r.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new _p(r.attr,r.value)}}qn.jsonID("docAttr",_p);let Ld=class extends Error{};Ld=function t(e){let r=Error.call(this,e);return r.__proto__=t.prototype,r};Ld.prototype=Object.create(Error.prototype);Ld.prototype.constructor=Ld;Ld.prototype.name="TransformError";class iD{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Pp}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let r=this.maybeStep(e);if(r.failed)throw new Ld(r.failed);return this}maybeStep(e){let r=e.apply(this.doc);return r.failed||this.addStep(e,r.doc),r}get docChanged(){return this.steps.length>0}changedRange(){let e=1e9,r=-1e9;for(let n=0;n<this.mapping.maps.length;n++){let i=this.mapping.maps[n];n&&(e=i.map(e,1),r=i.map(r,-1)),i.forEach((a,s,o,l)=>{e=Math.min(e,o),r=Math.max(r,l)})}return e==1e9?null:{from:e,to:r}}addStep(e,r){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=r}replace(e,r=e,n=Ae.empty){let i=vx(this.doc,e,r,n);return i&&this.step(i),this}replaceWith(e,r,n){return this.replace(e,r,new Ae(be.from(n),0,0))}delete(e,r){return this.replace(e,r,Ae.empty)}insert(e,r){return this.replaceWith(e,e,r)}replaceRange(e,r,n){return PX(this,e,r,n),this}replaceRangeWith(e,r,n){return _X(this,e,r,n),this}deleteRange(e,r){return AX(this,e,r),this}lift(e,r){return gX(this,e,r),this}join(e,r=1){return NX(this,e,r),this}wrap(e,r){return xX(this,e,r),this}setBlockType(e,r=e,n,i=null){return bX(this,e,r,n,i),this}setNodeMarkup(e,r,n=null,i){return SX(this,e,r,n,i),this}setNodeAttribute(e,r,n){return this.step(new kd(e,r,n)),this}setDocAttribute(e,r){return this.step(new _p(e,r)),this}addNodeMark(e,r){return this.step(new Xo(e,r)),this}removeNodeMark(e,r){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(r instanceof Gt)r.isInSet(n.marks)&&this.step(new Hc(e,r));else{let i=n.marks,a,s=[];for(;a=r.isInSet(i);)s.push(new Hc(e,a)),i=a.removeFromSet(i);for(let o=s.length-1;o>=0;o--)this.step(s[o])}return this}split(e,r=1,n){return kX(this,e,r,n),this}addMark(e,r,n){return hX(this,e,r,n),this}removeMark(e,r,n){return pX(this,e,r,n),this}clearIncompatible(e,r,n){return w3(this,e,r,n),this}}const eS=Object.create(null);class ht{constructor(e,r,n){this.$anchor=e,this.$head=r,this.ranges=n||[new RX(e.min(r),e.max(r))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let r=0;r<e.length;r++)if(e[r].$from.pos!=e[r].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,r=Ae.empty){let n=r.content.lastChild,i=null;for(let o=0;o<r.openEnd;o++)i=n,n=n.lastChild;let a=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:l,$to:c}=s[o],u=e.mapping.slice(a);e.replaceRange(u.map(l.pos),u.map(c.pos),o?Ae.empty:r),o==0&&Ej(e,a,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,r){let n=e.steps.length,i=this.ranges;for(let a=0;a<i.length;a++){let{$from:s,$to:o}=i[a],l=e.mapping.slice(n),c=l.map(s.pos),u=l.map(o.pos);a?e.deleteRange(c,u):(e.replaceRangeWith(c,u,r),Ej(e,n,r.isInline?-1:1))}}static findFrom(e,r,n=!1){let i=e.parent.inlineContent?new at(e):Uu(e.node(0),e.parent,e.pos,e.index(),r,n);if(i)return i;for(let a=e.depth-1;a>=0;a--){let s=r<0?Uu(e.node(0),e.node(a),e.before(a+1),e.index(a),r,n):Uu(e.node(0),e.node(a),e.after(a+1),e.index(a)+1,r,n);if(s)return s}return null}static near(e,r=1){return this.findFrom(e,r)||this.findFrom(e,-r)||new sa(e.node(0))}static atStart(e){return Uu(e,e,0,0,1)||new sa(e)}static atEnd(e){return Uu(e,e,e.content.size,e.childCount,-1)||new sa(e)}static fromJSON(e,r){if(!r||!r.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=eS[r.type];if(!n)throw new RangeError(`No selection type ${r.type} defined`);return n.fromJSON(e,r)}static jsonID(e,r){if(e in eS)throw new RangeError("Duplicate use of selection JSON ID "+e);return eS[e]=r,r.prototype.jsonID=e,r}getBookmark(){return at.between(this.$anchor,this.$head).getBookmark()}}ht.prototype.visible=!0;class RX{constructor(e,r){this.$from=e,this.$to=r}}let Cj=!1;function Nj(t){!Cj&&!t.parent.inlineContent&&(Cj=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class at extends ht{constructor(e,r=e){Nj(e),Nj(r),super(e,r)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,r){let n=e.resolve(r.map(this.head));if(!n.parent.inlineContent)return ht.near(n);let i=e.resolve(r.map(this.anchor));return new at(i.parent.inlineContent?i:n,n)}replace(e,r=Ae.empty){if(super.replace(e,r),r==Ae.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof at&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new yx(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,r){if(typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new at(e.resolve(r.anchor),e.resolve(r.head))}static create(e,r,n=r){let i=e.resolve(r);return new this(i,n==r?i:e.resolve(n))}static between(e,r,n){let i=e.pos-r.pos;if((!n||i)&&(n=i>=0?1:-1),!r.parent.inlineContent){let a=ht.findFrom(r,n,!0)||ht.findFrom(r,-n,!0);if(a)r=a.$head;else return ht.near(r,n)}return e.parent.inlineContent||(i==0?e=r:(e=(ht.findFrom(e,-n,!0)||ht.findFrom(e,n,!0)).$anchor,e.pos<r.pos!=i<0&&(e=r))),new at(e,r)}}ht.jsonID("text",at);class yx{constructor(e,r){this.anchor=e,this.head=r}map(e){return new yx(e.map(this.anchor),e.map(this.head))}resolve(e){return at.between(e.resolve(this.anchor),e.resolve(this.head))}}class Ye extends ht{constructor(e){let r=e.nodeAfter,n=e.node(0).resolve(e.pos+r.nodeSize);super(e,n),this.node=r}map(e,r){let{deleted:n,pos:i}=r.mapResult(this.anchor),a=e.resolve(i);return n?ht.near(a):new Ye(a)}content(){return new Ae(be.from(this.node),0,0)}eq(e){return e instanceof Ye&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new k3(this.anchor)}static fromJSON(e,r){if(typeof r.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ye(e.resolve(r.anchor))}static create(e,r){return new Ye(e.resolve(r))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}Ye.prototype.visible=!1;ht.jsonID("node",Ye);class k3{constructor(e){this.anchor=e}map(e){let{deleted:r,pos:n}=e.mapResult(this.anchor);return r?new yx(n,n):new k3(n)}resolve(e){let r=e.resolve(this.anchor),n=r.nodeAfter;return n&&Ye.isSelectable(n)?new Ye(r):ht.near(r)}}class sa extends ht{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,r=Ae.empty){if(r==Ae.empty){e.delete(0,e.doc.content.size);let n=ht.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,r)}toJSON(){return{type:"all"}}static fromJSON(e){return new sa(e)}map(e){return new sa(e)}eq(e){return e instanceof sa}getBookmark(){return DX}}ht.jsonID("all",sa);const DX={map(){return this},resolve(t){return new sa(t)}};function Uu(t,e,r,n,i,a=!1){if(e.inlineContent)return at.create(t,r);for(let s=n-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let o=e.child(s);if(o.isAtom){if(!a&&Ye.isSelectable(o))return Ye.create(t,r-(i<0?o.nodeSize:0))}else{let l=Uu(t,o,r+i,i<0?o.childCount:0,i,a);if(l)return l}r+=o.nodeSize*i}return null}function Ej(t,e,r){let n=t.steps.length-1;if(n<e)return;let i=t.steps[n];if(!(i instanceof dn||i instanceof mn))return;let a=t.mapping.maps[n],s;a.forEach((o,l,c,u)=>{s==null&&(s=u)}),t.setSelection(ht.near(t.doc.resolve(s),r))}const Tj=1,Qg=2,jj=4;class OX extends iD{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Tj)&~Qg,this.storedMarks=null,this}get selectionSet(){return(this.updated&Tj)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Qg,this}ensureMarks(e){return Gt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Qg)>0}addStep(e,r){super.addStep(e,r),this.updated=this.updated&~Qg,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,r=!0){let n=this.selection;return r&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Gt.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,r,n){let i=this.doc.type.schema;if(r==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(n==null&&(n=r),!e)return this.deleteRange(r,n);let a=this.storedMarks;if(!a){let s=this.doc.resolve(r);a=n==r?s.marks():s.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(r,n,i.text(e,a)),!this.selection.empty&&this.selection.to==r+e.length&&this.setSelection(ht.near(this.selection.$to)),this}}setMeta(e,r){return this.meta[typeof e=="string"?e:e.key]=r,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=jj,this}get scrolledIntoView(){return(this.updated&jj)>0}}function Mj(t,e){return!e||!t?t:t.bind(e)}class Ch{constructor(e,r,n){this.name=e,this.init=Mj(r.init,n),this.apply=Mj(r.apply,n)}}const IX=[new Ch("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Ch("selection",{init(t,e){return t.selection||ht.atStart(e.doc)},apply(t){return t.selection}}),new Ch("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,r,n){return n.selection.$cursor?t.storedMarks:null}}),new Ch("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class tS{constructor(e,r){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=IX.slice(),r&&r.forEach(n=>{if(this.pluginsByKey[n.key])throw new RangeError("Adding different instances of a keyed plugin ("+n.key+")");this.plugins.push(n),this.pluginsByKey[n.key]=n,n.spec.state&&this.fields.push(new Ch(n.key,n.spec.state,n))})}}class ud{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,r=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=r){let i=this.config.plugins[n];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let r=[e],n=this.applyInner(e),i=null;for(;;){let a=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let l=i?i[s].n:0,c=i?i[s].state:this,u=l<r.length&&o.spec.appendTransaction.call(o,l?r.slice(l):r,c,n);if(u&&n.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<s?{state:n,n:r.length}:{state:this,n:0})}r.push(u),n=n.applyInner(u),a=!0}i&&(i[s]={state:n,n:r.length})}}if(!a)return{state:n,transactions:r}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let r=new ud(this.config),n=this.config.fields;for(let i=0;i<n.length;i++){let a=n[i];r[a.name]=a.apply(e,this[a.name],this,r)}return r}get tr(){return new OX(this)}static create(e){let r=new tS(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new ud(r);for(let i=0;i<r.fields.length;i++)n[r.fields[i].name]=r.fields[i].init(e,n);return n}reconfigure(e){let r=new tS(this.schema,e.plugins),n=r.fields,i=new ud(r);for(let a=0;a<n.length;a++){let s=n[a].name;i[s]=this.hasOwnProperty(s)?this[s]:n[a].init(e,i)}return i}toJSON(e){let r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(n=>n.toJSON())),e&&typeof e=="object")for(let n in e){if(n=="doc"||n=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[n],a=i.spec.state;a&&a.toJSON&&(r[n]=a.toJSON.call(i,this[i.key]))}return r}static fromJSON(e,r,n){if(!r)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new tS(e.schema,e.plugins),a=new ud(i);return i.fields.forEach(s=>{if(s.name=="doc")a.doc=qs.fromJSON(e.schema,r.doc);else if(s.name=="selection")a.selection=ht.fromJSON(a.doc,r.selection);else if(s.name=="storedMarks")r.storedMarks&&(a.storedMarks=r.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let o in n){let l=n[o],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(r,o)){a[s.name]=c.fromJSON.call(l,e,r[o],a);return}}a[s.name]=s.init(e,a)}}),a}}function aD(t,e,r){for(let n in t){let i=t[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=aD(i,e,{})),r[n]=i}return r}class ur{constructor(e){this.spec=e,this.props={},e.props&&aD(e.props,this,this.props),this.key=e.key?e.key.key:sD("plugin")}getState(e){return e[this.key]}}const rS=Object.create(null);function sD(t){return t in rS?t+"$"+ ++rS[t]:(rS[t]=0,t+"$")}class Rr{constructor(e="key"){this.key=sD(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const LX=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function oD(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("backward",t):r.parentOffset>0)?null:r}const BX=(t,e,r)=>{let n=oD(t,r);if(!n)return!1;let i=C3(n);if(!i){let s=n.blockRange(),o=s&&cf(s);return o==null?!1:(e&&e(t.tr.lift(s,o).scrollIntoView()),!0)}let a=i.nodeBefore;if(dD(t,i,e,-1))return!0;if(n.parent.content.size==0&&(Bd(a,"end")||Ye.isSelectable(a)))for(let s=n.depth;;s--){let o=vx(t.doc,n.before(s),n.after(s),Ae.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Bd(a,"end")?ht.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):Ye.create(l.doc,i.pos-a.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||n.node(s-1).childCount>1)break}return a.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos-a.nodeSize,i.pos).scrollIntoView()),!0):!1},FX=(t,e,r)=>{let n=oD(t,r);if(!n)return!1;let i=C3(n);return i?lD(t,i,e):!1},zX=(t,e,r)=>{let n=cD(t,r);if(!n)return!1;let i=N3(n);return i?lD(t,i,e):!1};function lD(t,e,r){let n=e.nodeBefore,i=n,a=e.pos-1;for(;!i.isTextblock;a--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let s=e.nodeAfter,o=s,l=e.pos+1;for(;!o.isTextblock;l++){if(o.type.spec.isolating)return!1;let u=o.firstChild;if(!u)return!1;o=u}let c=vx(t.doc,a,l,Ae.empty);if(!c||c.from!=a||c instanceof dn&&c.slice.size>=l-a)return!1;if(r){let u=t.tr.step(c);u.setSelection(at.create(u.doc,a)),r(u.scrollIntoView())}return!0}function Bd(t,e,r=!1){for(let n=t;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(r&&n.childCount!=1)return!1}return!1}const VX=(t,e,r)=>{let{$head:n,empty:i}=t.selection,a=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("backward",t):n.parentOffset>0)return!1;a=C3(n)}let s=a&&a.nodeBefore;return!s||!Ye.isSelectable(s)?!1:(e&&e(t.tr.setSelection(Ye.create(t.doc,a.pos-s.nodeSize)).scrollIntoView()),!0)};function C3(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function cD(t,e){let{$cursor:r}=t.selection;return!r||(e?!e.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)?null:r}const $X=(t,e,r)=>{let n=cD(t,r);if(!n)return!1;let i=N3(n);if(!i)return!1;let a=i.nodeAfter;if(dD(t,i,e,1))return!0;if(n.parent.content.size==0&&(Bd(a,"start")||Ye.isSelectable(a))){let s=vx(t.doc,n.before(),n.after(),Ae.empty);if(s&&s.slice.size<s.to-s.from){if(e){let o=t.tr.step(s);o.setSelection(Bd(a,"start")?ht.findFrom(o.doc.resolve(o.mapping.map(i.pos)),1):Ye.create(o.doc,o.mapping.map(i.pos))),e(o.scrollIntoView())}return!0}}return a.isAtom&&i.depth==n.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+a.nodeSize).scrollIntoView()),!0):!1},UX=(t,e,r)=>{let{$head:n,empty:i}=t.selection,a=n;if(!i)return!1;if(n.parent.isTextblock){if(r?!r.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)return!1;a=N3(n)}let s=a&&a.nodeAfter;return!s||!Ye.isSelectable(s)?!1:(e&&e(t.tr.setSelection(Ye.create(t.doc,a.pos)).scrollIntoView()),!0)};function N3(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let r=t.node(e);if(t.index(e)+1<r.childCount)return t.doc.resolve(t.after(e+1));if(r.type.spec.isolating)break}return null}const GX=(t,e)=>{let r=t.selection,n=r instanceof Ye,i;if(n){if(r.node.isTextblock||!Dl(t.doc,r.from))return!1;i=r.from}else if(i=gx(t.doc,r.from,-1),i==null)return!1;if(e){let a=t.tr.join(i);n&&a.setSelection(Ye.create(a.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(a.scrollIntoView())}return!0},HX=(t,e)=>{let r=t.selection,n;if(r instanceof Ye){if(r.node.isTextblock||!Dl(t.doc,r.to))return!1;n=r.to}else if(n=gx(t.doc,r.to,1),n==null)return!1;return e&&e(t.tr.join(n).scrollIntoView()),!0},WX=(t,e)=>{let{$from:r,$to:n}=t.selection,i=r.blockRange(n),a=i&&cf(i);return a==null?!1:(e&&e(t.tr.lift(i,a).scrollIntoView()),!0)},qX=(t,e)=>{let{$head:r,$anchor:n}=t.selection;return!r.parent.type.spec.code||!r.sameParent(n)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function uD(t){for(let e=0;e<t.edgeCount;e++){let{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}const KX=(t,e)=>{let{$head:r,$anchor:n}=t.selection;if(!r.parent.type.spec.code||!r.sameParent(n))return!1;let i=r.node(-1),a=r.indexAfter(-1),s=uD(i.contentMatchAt(a));if(!s||!i.canReplaceWith(a,a,s))return!1;if(e){let o=r.after(),l=t.tr.replaceWith(o,o,s.createAndFill());l.setSelection(ht.near(l.doc.resolve(o),1)),e(l.scrollIntoView())}return!0},YX=(t,e)=>{let r=t.selection,{$from:n,$to:i}=r;if(r instanceof sa||n.parent.inlineContent||i.parent.inlineContent)return!1;let a=uD(i.parent.contentMatchAt(i.indexAfter()));if(!a||!a.isTextblock)return!1;if(e){let s=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,o=t.tr.insert(s,a.createAndFill());o.setSelection(at.create(o.doc,s+1)),e(o.scrollIntoView())}return!0},XX=(t,e)=>{let{$cursor:r}=t.selection;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){let a=r.before();if(Sd(t.doc,a))return e&&e(t.tr.split(a).scrollIntoView()),!0}let n=r.blockRange(),i=n&&cf(n);return i==null?!1:(e&&e(t.tr.lift(n,i).scrollIntoView()),!0)},QX=(t,e)=>{let{$from:r,to:n}=t.selection,i,a=r.sharedDepth(n);return a==0?!1:(i=r.before(a),e&&e(t.tr.setSelection(Ye.create(t.doc,i))),!0)};function JX(t,e,r){let n=e.nodeBefore,i=e.nodeAfter,a=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(a-1,a)?(r&&r(t.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(a,a+1)||!(i.isTextblock||Dl(t.doc,e.pos))?!1:(r&&r(t.tr.join(e.pos).scrollIntoView()),!0)}function dD(t,e,r,n){let i=e.nodeBefore,a=e.nodeAfter,s,o,l=i.type.spec.isolating||a.type.spec.isolating;if(!l&&JX(t,e,r))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(o=i.contentMatchAt(i.childCount)).findWrapping(a.type))&&o.matchType(s[0]||a.type).validEnd){if(r){let m=e.pos+a.nodeSize,v=be.empty;for(let b=s.length-1;b>=0;b--)v=be.from(s[b].create(null,v));v=be.from(i.copy(v));let y=t.tr.step(new mn(e.pos-1,m,e.pos,m,new Ae(v,1,0),s.length,!0)),x=y.doc.resolve(m+2*s.length);x.nodeAfter&&x.nodeAfter.type==i.type&&Dl(y.doc,x.pos)&&y.join(x.pos),r(y.scrollIntoView())}return!0}let u=a.type.spec.isolating||n>0&&l?null:ht.findFrom(e,1),f=u&&u.$from.blockRange(u.$to),h=f&&cf(f);if(h!=null&&h>=e.depth)return r&&r(t.tr.lift(f,h).scrollIntoView()),!0;if(c&&Bd(a,"start",!0)&&Bd(i,"end")){let m=i,v=[];for(;v.push(m),!m.isTextblock;)m=m.lastChild;let y=a,x=1;for(;!y.isTextblock;y=y.firstChild)x++;if(m.canReplace(m.childCount,m.childCount,y.content)){if(r){let b=be.empty;for(let w=v.length-1;w>=0;w--)b=be.from(v[w].copy(b));let S=t.tr.step(new mn(e.pos-v.length,e.pos+a.nodeSize,e.pos+x,e.pos+a.nodeSize-x,new Ae(b,v.length,0),0,!0));r(S.scrollIntoView())}return!0}}return!1}function fD(t){return function(e,r){let n=e.selection,i=t<0?n.$from:n.$to,a=i.depth;for(;i.node(a).isInline;){if(!a)return!1;a--}return i.node(a).isTextblock?(r&&r(e.tr.setSelection(at.create(e.doc,t<0?i.start(a):i.end(a)))),!0):!1}}const ZX=fD(-1),eQ=fD(1);function tQ(t,e=null){return function(r,n){let{$from:i,$to:a}=r.selection,s=i.blockRange(a),o=s&&S3(s,t,e);return o?(n&&n(r.tr.wrap(s,o).scrollIntoView()),!0):!1}}function Pj(t,e=null){return function(r,n){let i=!1;for(let a=0;a<r.selection.ranges.length&&!i;a++){let{$from:{pos:s},$to:{pos:o}}=r.selection.ranges[a];r.doc.nodesBetween(s,o,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(t,e)))if(l.type==t)i=!0;else{let u=r.doc.resolve(c),f=u.index();i=u.parent.canReplaceWith(f,f+1,t)}})}if(!i)return!1;if(n){let a=r.tr;for(let s=0;s<r.selection.ranges.length;s++){let{$from:{pos:o},$to:{pos:l}}=r.selection.ranges[s];a.setBlockType(o,l,t,e)}n(a.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function rQ(t,e=null){return function(r,n){let{$from:i,$to:a}=r.selection,s=i.blockRange(a);if(!s)return!1;let o=n?r.tr:null;return nQ(o,s,t,e)?(n&&n(o.scrollIntoView()),!0):!1}}function nQ(t,e,r,n=null){let i=!1,a=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(r)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);a=new B0(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new B0(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let o=S3(a,r,n,e);return o?(t&&iQ(t,e,o,i,r),!0):!1}function iQ(t,e,r,n,i){let a=be.empty;for(let u=r.length-1;u>=0;u--)a=be.from(r[u].type.create(r[u].attrs,a));t.step(new mn(e.start-(n?2:0),e.end,e.start,e.end,new Ae(a,0,0),r.length,!0));let s=0;for(let u=0;u<r.length;u++)r[u].type==i&&(s=u+1);let o=r.length-s,l=e.start+r.length-(n?2:0),c=e.parent;for(let u=e.startIndex,f=e.endIndex,h=!0;u<f;u++,h=!1)!h&&Sd(t.doc,l,o)&&(t.split(l,o),l+=2*o),l+=c.child(u).nodeSize;return t}function aQ(t){return function(e,r){let{$from:n,$to:i}=e.selection,a=n.blockRange(i,s=>s.childCount>0&&s.firstChild.type==t);return a?r?n.node(a.depth-1).type==t?sQ(e,r,t,a):oQ(e,r,a):!0:!1}}function sQ(t,e,r,n){let i=t.tr,a=n.end,s=n.$to.end(n.depth);a<s&&(i.step(new mn(a-1,s,a,s,new Ae(be.from(r.create(null,n.parent.copy())),1,0),1,!0)),n=new B0(i.doc.resolve(n.$from.pos),i.doc.resolve(s),n.depth));const o=cf(n);if(o==null)return!1;i.lift(n,o);let l=i.doc.resolve(i.mapping.map(a,-1)-1);return Dl(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function oQ(t,e,r){let n=t.tr,i=r.parent;for(let m=r.end,v=r.endIndex-1,y=r.startIndex;v>y;v--)m-=i.child(v).nodeSize,n.delete(m-1,m+1);let a=n.doc.resolve(r.start),s=a.nodeAfter;if(n.mapping.map(r.end)!=r.start+a.nodeAfter.nodeSize)return!1;let o=r.startIndex==0,l=r.endIndex==i.childCount,c=a.node(-1),u=a.index(-1);if(!c.canReplace(u+(o?0:1),u+1,s.content.append(l?be.empty:be.from(i))))return!1;let f=a.pos,h=f+s.nodeSize;return n.step(new mn(f-(o?1:0),h+(l?1:0),f+1,h-1,new Ae((o?be.empty:be.from(i.copy(be.empty))).append(l?be.empty:be.from(i.copy(be.empty))),o?0:1,l?0:1),o?0:1)),e(n.scrollIntoView()),!0}function lQ(t){return function(e,r){let{$from:n,$to:i}=e.selection,a=n.blockRange(i,c=>c.childCount>0&&c.firstChild.type==t);if(!a)return!1;let s=a.startIndex;if(s==0)return!1;let o=a.parent,l=o.child(s-1);if(l.type!=t)return!1;if(r){let c=l.lastChild&&l.lastChild.type==o.type,u=be.from(c?t.create():null),f=new Ae(be.from(t.create(null,be.from(o.type.create(null,u)))),c?3:1,0),h=a.start,m=a.end;r(e.tr.step(new mn(h-(c?3:1),m,h,m,f,1,!0)).scrollIntoView())}return!0}}const kn=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Fd=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let lk=null;const Fs=function(t,e,r){let n=lk||(lk=document.createRange());return n.setEnd(t,r??t.nodeValue.length),n.setStart(t,e||0),n},cQ=function(){lk=null},Wc=function(t,e,r,n){return r&&(_j(t,e,r,n,-1)||_j(t,e,r,n,1))},uQ=/^(img|br|input|textarea|hr)$/i;function _j(t,e,r,n,i){for(var a;;){if(t==r&&e==n)return!0;if(e==(i<0?0:ra(t))){let s=t.parentNode;if(!s||s.nodeType!=1||um(t)||uQ.test(t.nodeName)||t.contentEditable=="false")return!1;e=kn(t)+(i<0?0:1),t=s}else if(t.nodeType==1){let s=t.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((a=s.pmViewDesc)===null||a===void 0)&&a.ignoreForSelection)e+=i;else return!1;else t=s,e=i<0?ra(t):0}else return!1}}function ra(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function dQ(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=ra(t)}else if(t.parentNode&&!um(t))e=kn(t),t=t.parentNode;else return null}}function fQ(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!um(t))e=kn(t)+1,t=t.parentNode;else return null}}function hQ(t,e,r){for(let n=e==0,i=e==ra(t);n||i;){if(t==r)return!0;let a=kn(t);if(t=t.parentNode,!t)return!1;n=n&&a==0,i=i&&a==ra(t)}}function um(t){let e;for(let r=t;r&&!(e=r.pmViewDesc);r=r.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const xx=function(t){return t.focusNode&&Wc(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function pc(t,e){let r=document.createEvent("Event");return r.initEvent("keydown",!0,!0),r.keyCode=t,r.key=r.code=e,r}function pQ(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function mQ(t,e,r){if(t.caretPositionFromPoint)try{let n=t.caretPositionFromPoint(e,r);if(n)return{node:n.offsetNode,offset:Math.min(ra(n.offsetNode),n.offset)}}catch{}if(t.caretRangeFromPoint){let n=t.caretRangeFromPoint(e,r);if(n)return{node:n.startContainer,offset:Math.min(ra(n.startContainer),n.startOffset)}}}const hs=typeof navigator<"u"?navigator:null,Aj=typeof document<"u"?document:null,Ol=hs&&hs.userAgent||"",ck=/Edge\/(\d+)/.exec(Ol),hD=/MSIE \d/.exec(Ol),uk=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ol),wi=!!(hD||uk||ck),ul=hD?document.documentMode:uk?+uk[1]:ck?+ck[1]:0,oa=!wi&&/gecko\/(\d+)/i.test(Ol);oa&&+(/Firefox\/(\d+)/.exec(Ol)||[0,0])[1];const dk=!wi&&/Chrome\/(\d+)/.exec(Ol),fn=!!dk,pD=dk?+dk[1]:0,Mn=!wi&&!!hs&&/Apple Computer/.test(hs.vendor),zd=Mn&&(/Mobile\/\w+/.test(Ol)||!!hs&&hs.maxTouchPoints>2),Ji=zd||(hs?/Mac/.test(hs.platform):!1),mD=hs?/Win/.test(hs.platform):!1,Hs=/Android \d/.test(Ol),dm=!!Aj&&"webkitFontSmoothing"in Aj.documentElement.style,gQ=dm?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function vQ(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function As(t,e){return typeof t=="number"?t:t[e]}function yQ(t){let e=t.getBoundingClientRect(),r=e.width/t.offsetWidth||1,n=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*r,top:e.top,bottom:e.top+t.clientHeight*n}}function Rj(t,e,r){let n=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,a=t.dom.ownerDocument;for(let s=r||t.dom;s;){if(s.nodeType!=1){s=Fd(s);continue}let o=s,l=o==a.body,c=l?vQ(a):yQ(o),u=0,f=0;if(e.top<c.top+As(n,"top")?f=-(c.top-e.top+As(i,"top")):e.bottom>c.bottom-As(n,"bottom")&&(f=e.bottom-e.top>c.bottom-c.top?e.top+As(i,"top")-c.top:e.bottom-c.bottom+As(i,"bottom")),e.left<c.left+As(n,"left")?u=-(c.left-e.left+As(i,"left")):e.right>c.right-As(n,"right")&&(u=e.right-c.right+As(i,"right")),u||f)if(l)a.defaultView.scrollBy(u,f);else{let m=o.scrollLeft,v=o.scrollTop;f&&(o.scrollTop+=f),u&&(o.scrollLeft+=u);let y=o.scrollLeft-m,x=o.scrollTop-v;e={left:e.left-y,top:e.top-x,right:e.right-y,bottom:e.bottom-x}}let h=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(h))break;s=h=="absolute"?s.offsetParent:Fd(s)}}function xQ(t){let e=t.dom.getBoundingClientRect(),r=Math.max(0,e.top),n,i;for(let a=(e.left+e.right)/2,s=r+1;s<Math.min(innerHeight,e.bottom);s+=5){let o=t.root.elementFromPoint(a,s);if(!o||o==t.dom||!t.dom.contains(o))continue;let l=o.getBoundingClientRect();if(l.top>=r-20){n=o,i=l.top;break}}return{refDOM:n,refTop:i,stack:gD(t.dom)}}function gD(t){let e=[],r=t.ownerDocument;for(let n=t;n&&(e.push({dom:n,top:n.scrollTop,left:n.scrollLeft}),t!=r);n=Fd(n));return e}function bQ({refDOM:t,refTop:e,stack:r}){let n=t?t.getBoundingClientRect().top:0;vD(r,n==0?0:n-e)}function vD(t,e){for(let r=0;r<t.length;r++){let{dom:n,top:i,left:a}=t[r];n.scrollTop!=i+e&&(n.scrollTop=i+e),n.scrollLeft!=a&&(n.scrollLeft=a)}}let Lu=null;function wQ(t){if(t.setActive)return t.setActive();if(Lu)return t.focus(Lu);let e=gD(t);t.focus(Lu==null?{get preventScroll(){return Lu={preventScroll:!0},!0}}:void 0),Lu||(Lu=!1,vD(e,0))}function yD(t,e){let r,n=2e8,i,a=0,s=e.top,o=e.top,l,c;for(let u=t.firstChild,f=0;u;u=u.nextSibling,f++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=Fs(u).getClientRects();else continue;for(let m=0;m<h.length;m++){let v=h[m];if(v.top<=s&&v.bottom>=o){s=Math.max(v.bottom,s),o=Math.min(v.top,o);let y=v.left>e.left?v.left-e.left:v.right<e.left?e.left-v.right:0;if(y<n){r=u,n=y,i=y&&r.nodeType==3?{left:v.right<e.left?v.right:v.left,top:e.top}:e,u.nodeType==1&&y&&(a=f+(e.left>=(v.left+v.right)/2?1:0));continue}}else v.top>e.top&&!l&&v.left<=e.left&&v.right>=e.left&&(l=u,c={left:Math.max(v.left,Math.min(v.right,e.left)),top:v.top});!r&&(e.left>=v.right&&e.top>=v.top||e.left>=v.left&&e.top>=v.bottom)&&(a=f+1)}}return!r&&l&&(r=l,i=c,n=0),r&&r.nodeType==3?SQ(r,i):!r||n&&r.nodeType==1?{node:t,offset:a}:yD(r,i)}function SQ(t,e){let r=t.nodeValue.length,n=document.createRange(),i;for(let a=0;a<r;a++){n.setEnd(t,a+1),n.setStart(t,a);let s=_o(n,1);if(s.top!=s.bottom&&E3(e,s)){i={node:t,offset:a+(e.left>=(s.left+s.right)/2?1:0)};break}}return n.detach(),i||{node:t,offset:0}}function E3(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function kQ(t,e){let r=t.parentNode;return r&&/^li$/i.test(r.nodeName)&&e.left<t.getBoundingClientRect().left?r:t}function CQ(t,e,r){let{node:n,offset:i}=yD(e,r),a=-1;if(n.nodeType==1&&!n.firstChild){let s=n.getBoundingClientRect();a=s.left!=s.right&&r.left>(s.left+s.right)/2?1:-1}return t.docView.posFromDOM(n,i,a)}function NQ(t,e,r,n){let i=-1;for(let a=e,s=!1;a!=t.dom;){let o=t.docView.nearestDesc(a,!0),l;if(!o)return null;if(o.dom.nodeType==1&&(o.node.isBlock&&o.parent||!o.contentDOM)&&((l=o.dom.getBoundingClientRect()).width||l.height)&&(o.node.isBlock&&o.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(o.dom.nodeName)&&(!s&&l.left>n.left||l.top>n.top?i=o.posBefore:(!s&&l.right<n.left||l.bottom<n.top)&&(i=o.posAfter),s=!0),!o.contentDOM&&i<0&&!o.node.isText))return(o.node.isBlock?n.top<(l.top+l.bottom)/2:n.left<(l.left+l.right)/2)?o.posBefore:o.posAfter;a=o.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,r,-1)}function xD(t,e,r){let n=t.childNodes.length;if(n&&r.top<r.bottom)for(let i=Math.max(0,Math.min(n-1,Math.floor(n*(e.top-r.top)/(r.bottom-r.top))-2)),a=i;;){let s=t.childNodes[a];if(s.nodeType==1){let o=s.getClientRects();for(let l=0;l<o.length;l++){let c=o[l];if(E3(e,c))return xD(s,e,c)}}if((a=(a+1)%n)==i)break}return t}function EQ(t,e){let r=t.dom.ownerDocument,n,i=0,a=mQ(r,e.left,e.top);a&&({node:n,offset:i}=a);let s=(t.root.elementFromPoint?t.root:r).elementFromPoint(e.left,e.top),o;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=t.dom.getBoundingClientRect();if(!E3(e,c)||(s=xD(t.dom,e,c),!s))return null}if(Mn)for(let c=s;n&&c;c=Fd(c))c.draggable&&(n=void 0);if(s=kQ(s,e),n){if(oa&&n.nodeType==1&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){let u=n.childNodes[i],f;u.nodeName=="IMG"&&(f=u.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let c;dm&&i&&n.nodeType==1&&(c=n.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,n==t.dom&&i==n.childNodes.length-1&&n.lastChild.nodeType==1&&e.top>n.lastChild.getBoundingClientRect().bottom?o=t.state.doc.content.size:(i==0||n.nodeType!=1||n.childNodes[i-1].nodeName!="BR")&&(o=NQ(t,n,i,e))}o==null&&(o=CQ(t,s,e));let l=t.docView.nearestDesc(s,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function Dj(t){return t.top<t.bottom||t.left<t.right}function _o(t,e){let r=t.getClientRects();if(r.length){let n=r[e<0?0:r.length-1];if(Dj(n))return n}return Array.prototype.find.call(r,Dj)||t.getBoundingClientRect()}const TQ=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function bD(t,e,r){let{node:n,offset:i,atom:a}=t.docView.domFromPos(e,r<0?-1:1),s=dm||oa;if(n.nodeType==3)if(s&&(TQ.test(n.nodeValue)||(r<0?!i:i==n.nodeValue.length))){let l=_o(Fs(n,i,i),r);if(oa&&i&&/\s/.test(n.nodeValue[i-1])&&i<n.nodeValue.length){let c=_o(Fs(n,i-1,i-1),-1);if(c.top==l.top){let u=_o(Fs(n,i,i+1),-1);if(u.top!=l.top)return sh(u,u.left<c.left)}}return l}else{let l=i,c=i,u=r<0?1:-1;return r<0&&!i?(c++,u=-1):r>=0&&i==n.nodeValue.length?(l--,u=1):r<0?l--:c++,sh(_o(Fs(n,l,c),u),u<0)}if(!t.state.doc.resolve(e-(a||0)).parent.inlineContent){if(a==null&&i&&(r<0||i==ra(n))){let l=n.childNodes[i-1];if(l.nodeType==1)return nS(l.getBoundingClientRect(),!1)}if(a==null&&i<ra(n)){let l=n.childNodes[i];if(l.nodeType==1)return nS(l.getBoundingClientRect(),!0)}return nS(n.getBoundingClientRect(),r>=0)}if(a==null&&i&&(r<0||i==ra(n))){let l=n.childNodes[i-1],c=l.nodeType==3?Fs(l,ra(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return sh(_o(c,1),!1)}if(a==null&&i<ra(n)){let l=n.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Fs(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return sh(_o(c,-1),!0)}return sh(_o(n.nodeType==3?Fs(n):n,-r),r>=0)}function sh(t,e){if(t.width==0)return t;let r=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:r,right:r}}function nS(t,e){if(t.height==0)return t;let r=e?t.top:t.bottom;return{top:r,bottom:r,left:t.left,right:t.right}}function wD(t,e,r){let n=t.state,i=t.root.activeElement;n!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return r()}finally{n!=e&&t.updateState(n),i!=t.dom&&i&&i.focus()}}function jQ(t,e,r){let n=e.selection,i=r=="up"?n.$from:n.$to;return wD(t,e,()=>{let{node:a}=t.docView.domFromPos(i.pos,r=="up"?-1:1);for(;;){let o=t.docView.nearestDesc(a,!0);if(!o)break;if(o.node.isBlock){a=o.contentDOM||o.dom;break}a=o.dom.parentNode}let s=bD(t,i.pos,1);for(let o=a.firstChild;o;o=o.nextSibling){let l;if(o.nodeType==1)l=o.getClientRects();else if(o.nodeType==3)l=Fs(o,0,o.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(r=="up"?s.top-u.top>(u.bottom-s.top)*2:u.bottom-s.bottom>(s.bottom-u.top)*2))return!1}}return!0})}const MQ=/[\u0590-\u08ac]/;function PQ(t,e,r){let{$head:n}=e.selection;if(!n.parent.isTextblock)return!1;let i=n.parentOffset,a=!i,s=i==n.parent.content.size,o=t.domSelection();return o?!MQ.test(n.parent.textContent)||!o.modify?r=="left"||r=="backward"?a:s:wD(t,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:f}=t.domSelectionRange(),h=o.caretBidiLevel;o.modify("move",r,"character");let m=n.depth?t.docView.domAfterPos(n.before()):t.dom,{focusNode:v,focusOffset:y}=t.domSelectionRange(),x=v&&!m.contains(v.nodeType==1?v:v.parentNode)||l==v&&c==y;try{o.collapse(u,f),l&&(l!=u||c!=f)&&o.extend&&o.extend(l,c)}catch{}return h!=null&&(o.caretBidiLevel=h),x}):n.pos==n.start()||n.pos==n.end()}let Oj=null,Ij=null,Lj=!1;function _Q(t,e,r){return Oj==e&&Ij==r?Lj:(Oj=e,Ij=r,Lj=r=="up"||r=="down"?jQ(t,e,r):PQ(t,e,r))}const la=0,Bj=1,xc=2,ps=3;class fm{constructor(e,r,n,i){this.parent=e,this.children=r,this.dom=n,this.contentDOM=i,this.dirty=la,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,r,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let r=0;r<this.children.length;r++)e+=this.children[r].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let r=0,n=this.posAtStart;;r++){let i=this.children[r];if(i==e)return n;n+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,r,n){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(n<0){let a,s;if(e==this.contentDOM)a=e.childNodes[r-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.previousSibling}for(;a&&!((s=a.pmViewDesc)&&s.parent==this);)a=a.previousSibling;return a?this.posBeforeChild(s)+s.size:this.posAtStart}else{let a,s;if(e==this.contentDOM)a=e.childNodes[r];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;a=e.nextSibling}for(;a&&!((s=a.pmViewDesc)&&s.parent==this);)a=a.nextSibling;return a?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=r>kn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(r==0)for(let a=e;;a=a.parentNode){if(a==this.dom){i=!1;break}if(a.previousSibling)break}if(i==null&&r==e.childNodes.length)for(let a=e;;a=a.parentNode){if(a==this.dom){i=!0;break}if(a.nextSibling)break}}return i??n>0?this.posAtEnd:this.posAtStart}nearestDesc(e,r=!1){for(let n=!0,i=e;i;i=i.parentNode){let a=this.getDesc(i),s;if(a&&(!r||a.node))if(n&&(s=a.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))n=!1;else return a}}getDesc(e){let r=e.pmViewDesc;for(let n=r;n;n=n.parent)if(n==this)return r}posFromDOM(e,r,n){for(let i=e;i;i=i.parentNode){let a=this.getDesc(i);if(a)return a.localPosFromDOM(e,r,n)}return-1}descAt(e){for(let r=0,n=0;r<this.children.length;r++){let i=this.children[r],a=n+i.size;if(n==e&&a!=n){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let o=i.children[s];if(o.size){i=o;break}}return i}if(e<a)return i.descAt(e-n-i.border);n=a}}domFromPos(e,r){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,i=0;for(let a=0;n<this.children.length;n++){let s=this.children[n],o=a+s.size;if(o>e||s instanceof kD){i=e-a;break}a=o}if(i)return this.children[n].domFromPos(i-this.children[n].border,r);for(let a;n&&!(a=this.children[n-1]).size&&a instanceof SD&&a.side>=0;n--);if(r<=0){let a,s=!0;for(;a=n?this.children[n-1]:null,!(!a||a.dom.parentNode==this.contentDOM);n--,s=!1);return a&&r&&s&&!a.border&&!a.domAtom?a.domFromPos(a.size,r):{node:this.contentDOM,offset:a?kn(a.dom)+1:0}}else{let a,s=!0;for(;a=n<this.children.length?this.children[n]:null,!(!a||a.dom.parentNode==this.contentDOM);n++,s=!1);return a&&s&&!a.border&&!a.domAtom?a.domFromPos(0,r):{node:this.contentDOM,offset:a?kn(a.dom):this.contentDOM.childNodes.length}}}parseRange(e,r,n=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:r,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,a=-1;for(let s=n,o=0;;o++){let l=this.children[o],c=s+l.size;if(i==-1&&e<=c){let u=s+l.border;if(e>=u&&r<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,r,u);e=s;for(let f=o;f>0;f--){let h=this.children[f-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){i=kn(h.dom)+1;break}e-=h.size}i==-1&&(i=0)}if(i>-1&&(c>r||o==this.children.length-1)){r=c;for(let u=o+1;u<this.children.length;u++){let f=this.children[u];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){a=kn(f.dom);break}r+=f.size}a==-1&&(a=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:r,fromOffset:i,toOffset:a}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let r=this.children[e<0?0:this.children.length-1];return r.size==0||r.emptyChildAt(e)}domAfterPos(e){let{node:r,offset:n}=this.domFromPos(e,0);if(r.nodeType!=1||n==r.childNodes.length)throw new RangeError("No node after pos "+e);return r.childNodes[n]}setSelection(e,r,n,i=!1){let a=Math.min(e,r),s=Math.max(e,r);for(let m=0,v=0;m<this.children.length;m++){let y=this.children[m],x=v+y.size;if(a>v&&s<x)return y.setSelection(e-v-y.border,r-v-y.border,n,i);v=x}let o=this.domFromPos(e,e?-1:1),l=r==e?o:this.domFromPos(r,r?-1:1),c=n.root.getSelection(),u=n.domSelectionRange(),f=!1;if((oa||Mn)&&e==r){let{node:m,offset:v}=o;if(m.nodeType==3){if(f=!!(v&&m.nodeValue[v-1]==`
`),f&&v==m.nodeValue.length)for(let y=m,x;y;y=y.parentNode){if(x=y.nextSibling){x.nodeName=="BR"&&(o=l={node:x.parentNode,offset:kn(x)+1});break}let b=y.pmViewDesc;if(b&&b.node&&b.node.isBlock)break}}else{let y=m.childNodes[v-1];f=y&&(y.nodeName=="BR"||y.contentEditable=="false")}}if(oa&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let m=u.focusNode.childNodes[u.focusOffset];m&&m.contentEditable=="false"&&(i=!0)}if(!(i||f&&Mn)&&Wc(o.node,o.offset,u.anchorNode,u.anchorOffset)&&Wc(l.node,l.offset,u.focusNode,u.focusOffset))return;let h=!1;if((c.extend||e==r)&&!(f&&oa)){c.collapse(o.node,o.offset);try{e!=r&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>r){let v=o;o=l,l=v}let m=document.createRange();m.setEnd(l.node,l.offset),m.setStart(o.node,o.offset),c.removeAllRanges(),c.addRange(m)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,r){for(let n=0,i=0;i<this.children.length;i++){let a=this.children[i],s=n+a.size;if(n==s?e<=s&&r>=n:e<s&&r>n){let o=n+a.border,l=s-a.border;if(e>=o&&r<=l){this.dirty=e==n||r==s?xc:Bj,e==o&&r==l&&(a.contentLost||a.dom.parentNode!=this.contentDOM)?a.dirty=ps:a.markDirty(e-o,r-o);return}else a.dirty=a.dom==a.contentDOM&&a.dom.parentNode==this.contentDOM&&!a.children.length?xc:ps}n=s}this.dirty=xc}markParentsDirty(){let e=1;for(let r=this.parent;r;r=r.parent,e++){let n=e==1?xc:Bj;r.dirty<n&&(r.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class SD extends fm{constructor(e,r,n,i){let a,s=r.type.toDOM;if(typeof s=="function"&&(s=s(n,()=>{if(!a)return i;if(a.parent)return a.parent.posBeforeChild(a)})),!r.type.spec.raw){if(s.nodeType!=1){let o=document.createElement("span");o.appendChild(s),s=o}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=r,this.widget=r,a=this}matchesWidget(e){return this.dirty==la&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let r=this.widget.spec.stopEvent;return r?r(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class AQ extends fm{constructor(e,r,n,i){super(e,[],r,null),this.textDOM=n,this.text=i}get size(){return this.text.length}localPosFromDOM(e,r){return e!=this.textDOM?this.posAtStart+(r?this.size:0):this.posAtStart+r}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class qc extends fm{constructor(e,r,n,i,a){super(e,[],n,i),this.mark=r,this.spec=a}static create(e,r,n,i){let a=i.nodeViews[r.type.name],s=a&&a(r,i,n);return(!s||!s.dom)&&(s=tu.renderSpec(document,r.type.spec.toDOM(r,n),null,r.attrs)),new qc(e,r,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&ps||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=ps&&this.mark.eq(e)}markDirty(e,r){if(super.markDirty(e,r),this.dirty!=la){let n=this.parent;for(;!n.node;)n=n.parent;n.dirty<this.dirty&&(n.dirty=this.dirty),this.dirty=la}}slice(e,r,n){let i=qc.create(this.parent,this.mark,!0,n),a=this.children,s=this.size;r<s&&(a=hk(a,r,s,n)),e>0&&(a=hk(a,0,e,n));for(let o=0;o<a.length;o++)a[o].parent=i;return i.children=a,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class dl extends fm{constructor(e,r,n,i,a,s,o,l,c){super(e,[],a,s),this.node=r,this.outerDeco=n,this.innerDeco=i,this.nodeDOM=o}static create(e,r,n,i,a,s){let o=a.nodeViews[r.type.name],l,c=o&&o(r,a,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},n,i),u=c&&c.dom,f=c&&c.contentDOM;if(r.isText){if(!u)u=document.createTextNode(r.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:f}=tu.renderSpec(document,r.type.spec.toDOM(r),null,r.attrs));!f&&!r.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),r.type.spec.draggable&&(u.draggable=!0));let h=u;return u=ED(u,n,r),c?l=new RQ(e,r,n,i,u,f||null,h,c,a,s+1):r.isText?new bx(e,r,n,i,u,h,a):new dl(e,r,n,i,u,f||null,h,a,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let r=this.children.length-1;r>=0;r--){let n=this.children[r];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>be.empty)}return e}matchesNode(e,r,n){return this.dirty==la&&e.eq(this.node)&&z0(r,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,r){let n=this.node.inlineContent,i=r,a=e.composing?this.localCompositionInfo(e,r):null,s=a&&a.pos>-1?a:null,o=a&&a.pos<0,l=new OQ(this,s&&s.node,e);BQ(this.node,this.innerDeco,(c,u,f)=>{c.spec.marks?l.syncToMarks(c.spec.marks,n,e,u):c.type.side>=0&&!f&&l.syncToMarks(u==this.node.childCount?Gt.none:this.node.child(u).marks,n,e,u),l.placeWidget(c,e,i)},(c,u,f,h)=>{l.syncToMarks(c.marks,n,e,h);let m;l.findNodeMatch(c,u,f,h)||o&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(m=l.findIndexWithChild(a.node))>-1&&l.updateNodeAt(c,u,f,m,e)||l.updateNextNode(c,u,f,e,h,i)||l.addNode(c,u,f,e,i),i+=c.nodeSize}),l.syncToMarks([],n,e,0),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==xc)&&(s&&this.protectLocalComposition(e,s),CD(this.contentDOM,this.children,e),zd&&FQ(this.dom))}localCompositionInfo(e,r){let{from:n,to:i}=e.state.selection;if(!(e.state.selection instanceof at)||n<r||i>r+this.node.content.size)return null;let a=e.input.compositionNode;if(!a||!this.dom.contains(a.parentNode))return null;if(this.node.inlineContent){let s=a.nodeValue,o=zQ(this.node.content,s,n-r,i-r);return o<0?null:{node:a,pos:o,text:s}}else return{node:a,pos:-1,text:""}}protectLocalComposition(e,{node:r,pos:n,text:i}){if(this.getDesc(r))return;let a=r;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let s=new AQ(this,a,r,i);e.input.compositionNodes.push(s),this.children=hk(this.children,n,n+i.length,e,s)}update(e,r,n,i){return this.dirty==ps||!e.sameMarkup(this.node)?!1:(this.updateInner(e,r,n,i),!0)}updateInner(e,r,n,i){this.updateOuterDeco(r),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=la}updateOuterDeco(e){if(z0(e,this.outerDeco))return;let r=this.nodeDOM.nodeType!=1,n=this.dom;this.dom=ND(this.dom,this.nodeDOM,fk(this.outerDeco,this.node,r),fk(e,this.node,r)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Fj(t,e,r,n,i){ED(n,e,t);let a=new dl(void 0,t,e,r,n,n,n,i,0);return a.contentDOM&&a.updateChildren(i,0),a}class bx extends dl{constructor(e,r,n,i,a,s,o){super(e,r,n,i,a,null,s,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,r,n,i){return this.dirty==ps||this.dirty!=la&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(r),(this.dirty!=la||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=la,!0)}inParent(){let e=this.parent.contentDOM;for(let r=this.nodeDOM;r;r=r.parentNode)if(r==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,r,n){return e==this.nodeDOM?this.posAtStart+Math.min(r,this.node.text.length):super.localPosFromDOM(e,r,n)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,r,n){let i=this.node.cut(e,r),a=document.createTextNode(i.text);return new bx(this.parent,i,this.outerDeco,this.innerDeco,a,a,n)}markDirty(e,r){super.markDirty(e,r),this.dom!=this.nodeDOM&&(e==0||r==this.nodeDOM.nodeValue.length)&&(this.dirty=ps)}get domAtom(){return!1}isText(e){return this.node.text==e}}class kD extends fm{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==la&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class RQ extends dl{constructor(e,r,n,i,a,s,o,l,c,u){super(e,r,n,i,a,s,o,c,u),this.spec=l}update(e,r,n,i){if(this.dirty==ps)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let a=this.spec.update(e,r,n);return a&&this.updateInner(e,r,n,i),a}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,r,n,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,r,n,i){this.spec.setSelection?this.spec.setSelection(e,r,n.root):super.setSelection(e,r,n,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function CD(t,e,r){let n=t.firstChild,i=!1;for(let a=0;a<e.length;a++){let s=e[a],o=s.dom;if(o.parentNode==t){for(;o!=n;)n=zj(n),i=!0;n=n.nextSibling}else i=!0,t.insertBefore(o,n);if(s instanceof qc){let l=n?n.previousSibling:t.lastChild;CD(s.contentDOM,s.children,r),n=l?l.nextSibling:t.firstChild}}for(;n;)n=zj(n),i=!0;i&&r.trackWrites==t&&(r.trackWrites=null)}const $h=function(t){t&&(this.nodeName=t)};$h.prototype=Object.create(null);const bc=[new $h];function fk(t,e,r){if(t.length==0)return bc;let n=r?bc[0]:new $h,i=[n];for(let a=0;a<t.length;a++){let s=t[a].type.attrs;if(s){s.nodeName&&i.push(n=new $h(s.nodeName));for(let o in s){let l=s[o];l!=null&&(r&&i.length==1&&i.push(n=new $h(e.isInline?"span":"div")),o=="class"?n.class=(n.class?n.class+" ":"")+l:o=="style"?n.style=(n.style?n.style+";":"")+l:o!="nodeName"&&(n[o]=l))}}}return i}function ND(t,e,r,n){if(r==bc&&n==bc)return e;let i=e;for(let a=0;a<n.length;a++){let s=n[a],o=r[a];if(a){let l;o&&o.nodeName==s.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),o=bc[0]),i=l}DQ(i,o||bc[0],s)}return i}function DQ(t,e,r){for(let n in e)n!="class"&&n!="style"&&n!="nodeName"&&!(n in r)&&t.removeAttribute(n);for(let n in r)n!="class"&&n!="style"&&n!="nodeName"&&r[n]!=e[n]&&t.setAttribute(n,r[n]);if(e.class!=r.class){let n=e.class?e.class.split(" ").filter(Boolean):[],i=r.class?r.class.split(" ").filter(Boolean):[];for(let a=0;a<n.length;a++)i.indexOf(n[a])==-1&&t.classList.remove(n[a]);for(let a=0;a<i.length;a++)n.indexOf(i[a])==-1&&t.classList.add(i[a]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=r.style){if(e.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=n.exec(e.style);)t.style.removeProperty(i[1])}r.style&&(t.style.cssText+=r.style)}}function ED(t,e,r){return ND(t,t,bc,fk(e,r,t.nodeType!=1))}function z0(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].type.eq(e[r].type))return!1;return!0}function zj(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class OQ{constructor(e,r,n){this.lock=r,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=IQ(e.node.content,e)}destroyBetween(e,r){if(e!=r){for(let n=e;n<r;n++)this.top.children[n].destroy();this.top.children.splice(e,r-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,r,n,i){let a=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;a<o&&(a==s-1?this.top:this.stack[a+1<<1]).matchesMark(e[a])&&e[a].type.spec.spanning!==!1;)a++;for(;a<s;)this.destroyRest(),this.top.dirty=la,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1,c=this.top.children.length;i<this.preMatch.index&&(c=Math.min(this.index+3,c));for(let u=this.index;u<c;u++){let f=this.top.children[u];if(f.matchesMark(e[s])&&!this.isLocked(f.dom)){l=u;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let u=qc.create(this.top,e[s],r,n);this.top.children.splice(this.index,0,u),this.top=u,this.changed=!0}this.index=0,s++}}findNodeMatch(e,r,n,i){let a=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,r,n))a=this.top.children.indexOf(s,this.index);else for(let o=this.index,l=Math.min(this.top.children.length,o+5);o<l;o++){let c=this.top.children[o];if(c.matchesNode(e,r,n)&&!this.preMatch.matched.has(c)){a=o;break}}return a<0?!1:(this.destroyBetween(this.index,a),this.index++,!0)}updateNodeAt(e,r,n,i,a){let s=this.top.children[i];return s.dirty==ps&&s.dom==s.contentDOM&&(s.dirty=xc),s.update(e,r,n,a)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let r=e.parentNode;if(!r)return-1;if(r==this.top.contentDOM){let n=e.pmViewDesc;if(n){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==n)return i}return-1}e=r}}updateNextNode(e,r,n,i,a,s){for(let o=this.index;o<this.top.children.length;o++){let l=this.top.children[o];if(l instanceof dl){let c=this.preMatch.matched.get(l);if(c!=null&&c!=a)return!1;let u=l.dom,f,h=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=ps&&z0(r,l.outerDeco));if(!h&&l.update(e,r,n,i))return this.destroyBetween(this.index,o),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(f=this.recreateWrapper(l,e,r,n,i,s)))return this.destroyBetween(this.index,o),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=xc,f.updateChildren(i,s+1),f.dirty=la),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,r,n,i,a,s){if(e.dirty||r.isAtom||!e.children.length||!e.node.content.eq(r.content)||!z0(n,e.outerDeco)||!i.eq(e.innerDeco))return null;let o=dl.create(this.top,r,n,i,a,s);if(o.contentDOM){o.children=e.children,e.children=[];for(let l of o.children)l.parent=o}return e.destroy(),o}addNode(e,r,n,i,a){let s=dl.create(this.top,e,r,n,i,a);s.contentDOM&&s.updateChildren(i,a+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,r,n){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let a=new SD(this.top,e,r,n);this.top.children.splice(this.index++,0,a),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],r=this.top;for(;e instanceof qc;)r=e,e=r.children[r.children.length-1];(!e||!(e instanceof bx)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Mn||fn)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",r),this.addHackNode("BR",this.top))}addHackNode(e,r){if(r==this.top&&this.index<r.children.length&&r.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);e=="IMG"&&(n.className="ProseMirror-separator",n.alt=""),e=="BR"&&(n.className="ProseMirror-trailingBreak");let i=new kD(this.top,[],n,null);r!=this.top?r.children.push(i):r.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function IQ(t,e){let r=e,n=r.children.length,i=t.childCount,a=new Map,s=[];e:for(;i>0;){let o;for(;;)if(n){let c=r.children[n-1];if(c instanceof qc)r=c,n=c.children.length;else{o=c,n--;break}}else{if(r==e)break e;n=r.parent.children.indexOf(r),r=r.parent}let l=o.node;if(l){if(l!=t.child(i-1))break;--i,a.set(o,i),s.push(o)}}return{index:i,matched:a,matches:s.reverse()}}function LQ(t,e){return t.type.side-e.type.side}function BQ(t,e,r,n){let i=e.locals(t),a=0;if(i.length==0){for(let c=0;c<t.childCount;c++){let u=t.child(c);n(u,i,e.forChild(a,u),c),a+=u.nodeSize}return}let s=0,o=[],l=null;for(let c=0;;){let u,f;for(;s<i.length&&i[s].to==a;){let x=i[s++];x.widget&&(u?(f||(f=[u])).push(x):u=x)}if(u)if(f){f.sort(LQ);for(let x=0;x<f.length;x++)r(f[x],c,!!l)}else r(u,c,!!l);let h,m;if(l)m=-1,h=l,l=null;else if(c<t.childCount)m=c,h=t.child(c++);else break;for(let x=0;x<o.length;x++)o[x].to<=a&&o.splice(x--,1);for(;s<i.length&&i[s].from<=a&&i[s].to>a;)o.push(i[s++]);let v=a+h.nodeSize;if(h.isText){let x=v;s<i.length&&i[s].from<x&&(x=i[s].from);for(let b=0;b<o.length;b++)o[b].to<x&&(x=o[b].to);x<v&&(l=h.cut(x-a),h=h.cut(0,x-a),v=x,m=-1)}else for(;s<i.length&&i[s].to<v;)s++;let y=h.isInline&&!h.isLeaf?o.filter(x=>!x.inline):o.slice();n(h,y,e.forChild(a,h),m),a=v}}function FQ(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function zQ(t,e,r,n){for(let i=0,a=0;i<t.childCount&&a<=n;){let s=t.child(i++),o=a;if(a+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<t.childCount;){let c=t.child(i++);if(a+=c.nodeSize,!c.isText)break;l+=c.text}if(a>=r){if(a>=n&&l.slice(n-e.length-o,n-o)==e)return n-e.length;let c=o<n?l.lastIndexOf(e,n-o-1):-1;if(c>=0&&c+e.length+o>=r)return o+c;if(r==n&&l.length>=n+e.length-o&&l.slice(n-o,n-o+e.length)==e)return n}}return-1}function hk(t,e,r,n,i){let a=[];for(let s=0,o=0;s<t.length;s++){let l=t[s],c=o,u=o+=l.size;c>=r||u<=e?a.push(l):(c<e&&a.push(l.slice(0,e-c,n)),i&&(a.push(i),i=void 0),u>r&&a.push(l.slice(r-c,l.size,n)))}return a}function T3(t,e=null){let r=t.domSelectionRange(),n=t.state.doc;if(!r.focusNode)return null;let i=t.docView.nearestDesc(r.focusNode),a=i&&i.size==0,s=t.docView.posFromDOM(r.focusNode,r.focusOffset,1);if(s<0)return null;let o=n.resolve(s),l,c;if(xx(r)){for(l=s;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&Ye.isSelectable(f)&&i.parent&&!(f.isInline&&hQ(r.focusNode,r.focusOffset,i.dom))){let h=i.posBefore;c=new Ye(s==h?o:n.resolve(h))}}else{if(r instanceof t.dom.ownerDocument.defaultView.Selection&&r.rangeCount>1){let f=s,h=s;for(let m=0;m<r.rangeCount;m++){let v=r.getRangeAt(m);f=Math.min(f,t.docView.posFromDOM(v.startContainer,v.startOffset,1)),h=Math.max(h,t.docView.posFromDOM(v.endContainer,v.endOffset,-1))}if(f<0)return null;[l,s]=h==t.state.selection.anchor?[h,f]:[f,h],o=n.resolve(s)}else l=t.docView.posFromDOM(r.anchorNode,r.anchorOffset,1);if(l<0)return null}let u=n.resolve(l);if(!c){let f=e=="pointer"||t.state.selection.head<o.pos&&!a?1:-1;c=j3(t,u,o,f)}return c}function TD(t){return t.editable?t.hasFocus():MD(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Ks(t,e=!1){let r=t.state.selection;if(jD(t,r),!!TD(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&fn){let n=t.domSelectionRange(),i=t.domObserver.currentSelection;if(n.anchorNode&&i.anchorNode&&Wc(n.anchorNode,n.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)$Q(t);else{let{anchor:n,head:i}=r,a,s;Vj&&!(r instanceof at)&&(r.$from.parent.inlineContent||(a=$j(t,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(s=$j(t,r.to))),t.docView.setSelection(n,i,t,e),Vj&&(a&&Uj(a),s&&Uj(s)),r.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&VQ(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const Vj=Mn||fn&&pD<63;function $j(t,e){let{node:r,offset:n}=t.docView.domFromPos(e,0),i=n<r.childNodes.length?r.childNodes[n]:null,a=n?r.childNodes[n-1]:null;if(Mn&&i&&i.contentEditable=="false")return iS(i);if((!i||i.contentEditable=="false")&&(!a||a.contentEditable=="false")){if(i)return iS(i);if(a)return iS(a)}}function iS(t){return t.contentEditable="true",Mn&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Uj(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function VQ(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let r=t.domSelectionRange(),n=r.anchorNode,i=r.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(r.anchorNode!=n||r.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!TD(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function $Q(t){let e=t.domSelection();if(!e)return;let r=t.cursorWrapper.dom,n=r.nodeName=="IMG";n?e.collapse(r.parentNode,kn(r)+1):e.collapse(r,0),!n&&!t.state.selection.visible&&wi&&ul<=11&&(r.disabled=!0,r.disabled=!1)}function jD(t,e){if(e instanceof Ye){let r=t.docView.descAt(e.from);r!=t.lastSelectedViewDesc&&(Gj(t),r&&r.selectNode(),t.lastSelectedViewDesc=r)}else Gj(t)}function Gj(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function j3(t,e,r,n){return t.someProp("createSelectionBetween",i=>i(t,e,r))||at.between(e,r,n)}function Hj(t){return t.editable&&!t.hasFocus()?!1:MD(t)}function MD(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function UQ(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),r=t.domSelectionRange();return Wc(e.node,e.offset,r.anchorNode,r.anchorOffset)}function pk(t,e){let{$anchor:r,$head:n}=t.selection,i=e>0?r.max(n):r.min(n),a=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return a&&ht.findFrom(a,e)}function Io(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Wj(t,e,r){let n=t.state.selection;if(n instanceof at)if(r.indexOf("s")>-1){let{$head:i}=n,a=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!a||a.isText||!a.isLeaf)return!1;let s=t.state.doc.resolve(i.pos+a.nodeSize*(e<0?-1:1));return Io(t,new at(n.$anchor,s))}else if(n.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=pk(t.state,e);return i&&i instanceof Ye?Io(t,i):!1}else if(!(Ji&&r.indexOf("m")>-1)){let i=n.$head,a=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!a||a.isText)return!1;let o=e<0?i.pos-a.nodeSize:i.pos;return a.isAtom||(s=t.docView.descAt(o))&&!s.contentDOM?Ye.isSelectable(a)?Io(t,new Ye(e<0?t.state.doc.resolve(i.pos-a.nodeSize):i)):dm?Io(t,new at(t.state.doc.resolve(e<0?o:o+a.nodeSize))):!1:!1}}else return!1;else{if(n instanceof Ye&&n.node.isInline)return Io(t,new at(e>0?n.$to:n.$from));{let i=pk(t.state,e);return i?Io(t,i):!1}}}function V0(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Uh(t,e){let r=t.pmViewDesc;return r&&r.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function Bu(t,e){return e<0?GQ(t):HQ(t)}function GQ(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i,a,s=!1;for(oa&&r.nodeType==1&&n<V0(r)&&Uh(r.childNodes[n],-1)&&(s=!0);;)if(n>0){if(r.nodeType!=1)break;{let o=r.childNodes[n-1];if(Uh(o,-1))i=r,a=--n;else if(o.nodeType==3)r=o,n=r.nodeValue.length;else break}}else{if(PD(r))break;{let o=r.previousSibling;for(;o&&Uh(o,-1);)i=r.parentNode,a=kn(o),o=o.previousSibling;if(o)r=o,n=V0(r);else{if(r=r.parentNode,r==t.dom)break;n=0}}}s?mk(t,r,n):i&&mk(t,i,a)}function HQ(t){let e=t.domSelectionRange(),r=e.focusNode,n=e.focusOffset;if(!r)return;let i=V0(r),a,s;for(;;)if(n<i){if(r.nodeType!=1)break;let o=r.childNodes[n];if(Uh(o,1))a=r,s=++n;else break}else{if(PD(r))break;{let o=r.nextSibling;for(;o&&Uh(o,1);)a=o.parentNode,s=kn(o)+1,o=o.nextSibling;if(o)r=o,n=0,i=V0(r);else{if(r=r.parentNode,r==t.dom)break;n=i=0}}}a&&mk(t,a,s)}function PD(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function WQ(t,e){for(;t&&e==t.childNodes.length&&!um(t);)e=kn(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let r=t.childNodes[e];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=0}}function qQ(t,e){for(;t&&!e&&!um(t);)e=kn(t),t=t.parentNode;for(;t&&e;){let r=t.childNodes[e-1];if(r.nodeType==3)return r;if(r.nodeType==1&&r.contentEditable=="false")break;t=r,e=t.childNodes.length}}function mk(t,e,r){if(e.nodeType!=3){let a,s;(s=WQ(e,r))?(e=s,r=0):(a=qQ(e,r))&&(e=a,r=a.nodeValue.length)}let n=t.domSelection();if(!n)return;if(xx(n)){let a=document.createRange();a.setEnd(e,r),a.setStart(e,r),n.removeAllRanges(),n.addRange(a)}else n.extend&&n.extend(e,r);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Ks(t)},50)}function qj(t,e){let r=t.state.doc.resolve(e);if(!(fn||mD)&&r.parent.inlineContent){let i=t.coordsAtPos(e);if(e>r.start()){let a=t.coordsAtPos(e-1),s=(a.top+a.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(a.left-i.left)>1)return a.left<i.left?"ltr":"rtl"}if(e<r.end()){let a=t.coordsAtPos(e+1),s=(a.top+a.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(a.left-i.left)>1)return a.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function Kj(t,e,r){let n=t.state.selection;if(n instanceof at&&!n.empty||r.indexOf("s")>-1||Ji&&r.indexOf("m")>-1)return!1;let{$from:i,$to:a}=n;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let s=pk(t.state,e);if(s&&s instanceof Ye)return Io(t,s)}if(!i.parent.inlineContent){let s=e<0?i:a,o=n instanceof sa?ht.near(s,e):ht.findFrom(s,e);return o?Io(t,o):!1}return!1}function Yj(t,e){if(!(t.state.selection instanceof at))return!0;let{$head:r,$anchor:n,empty:i}=t.state.selection;if(!r.sameParent(n))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let a=!r.textOffset&&(e<0?r.nodeBefore:r.nodeAfter);if(a&&!a.isText){let s=t.state.tr;return e<0?s.delete(r.pos-a.nodeSize,r.pos):s.delete(r.pos,r.pos+a.nodeSize),t.dispatch(s),!0}return!1}function Xj(t,e,r){t.domObserver.stop(),e.contentEditable=r,t.domObserver.start()}function KQ(t){if(!Mn||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:r}=t.domSelectionRange();if(e&&e.nodeType==1&&r==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let n=e.firstChild;Xj(t,n,"true"),setTimeout(()=>Xj(t,n,"false"),20)}return!1}function YQ(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function XQ(t,e){let r=e.keyCode,n=YQ(e);if(r==8||Ji&&r==72&&n=="c")return Yj(t,-1)||Bu(t,-1);if(r==46&&!e.shiftKey||Ji&&r==68&&n=="c")return Yj(t,1)||Bu(t,1);if(r==13||r==27)return!0;if(r==37||Ji&&r==66&&n=="c"){let i=r==37?qj(t,t.state.selection.from)=="ltr"?-1:1:-1;return Wj(t,i,n)||Bu(t,i)}else if(r==39||Ji&&r==70&&n=="c"){let i=r==39?qj(t,t.state.selection.from)=="ltr"?1:-1:1;return Wj(t,i,n)||Bu(t,i)}else{if(r==38||Ji&&r==80&&n=="c")return Kj(t,-1,n)||Bu(t,-1);if(r==40||Ji&&r==78&&n=="c")return KQ(t)||Kj(t,1,n)||Bu(t,1);if(n==(Ji?"m":"c")&&(r==66||r==73||r==89||r==90))return!0}return!1}function M3(t,e){t.someProp("transformCopied",m=>{e=m(e,t)});let r=[],{content:n,openStart:i,openEnd:a}=e;for(;i>1&&a>1&&n.childCount==1&&n.firstChild.childCount==1;){i--,a--;let m=n.firstChild;r.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),n=m.content}let s=t.someProp("clipboardSerializer")||tu.fromSchema(t.state.schema),o=ID(),l=o.createElement("div");l.appendChild(s.serializeFragment(n,{document:o}));let c=l.firstChild,u,f=0;for(;c&&c.nodeType==1&&(u=OD[c.nodeName.toLowerCase()]);){for(let m=u.length-1;m>=0;m--){let v=o.createElement(u[m]);for(;l.firstChild;)v.appendChild(l.firstChild);l.appendChild(v),f++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${a}${f?` -${f}`:""} ${JSON.stringify(r)}`);let h=t.someProp("clipboardTextSerializer",m=>m(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function _D(t,e,r,n,i){let a=i.parent.type.spec.code,s,o;if(!r&&!e)return null;let l=!!e&&(n||a||!r);if(l){if(t.someProp("transformPastedText",h=>{e=h(e,a||n,t)}),a)return o=new Ae(be.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",h=>{o=h(o,t,!0)}),o;let f=t.someProp("clipboardTextParser",h=>h(e,i,n,t));if(f)o=f;else{let h=i.marks(),{schema:m}=t.state,v=tu.fromSchema(m);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(y=>{let x=s.appendChild(document.createElement("p"));y&&x.appendChild(v.serializeNode(m.text(y,h)))})}}else t.someProp("transformPastedHTML",f=>{r=f(r,t)}),s=eJ(r),dm&&tJ(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let f=+u[3];f>0;f--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(o||(o=(t.someProp("clipboardParser")||t.someProp("domParser")||cl.fromSchema(t.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!QQ.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)o=rJ(Qj(o,+u[1],+u[2]),u[4]);else if(o=Ae.maxOpen(JQ(o.content,i),!0),o.openStart||o.openEnd){let f=0,h=0;for(let m=o.content.firstChild;f<o.openStart&&!m.type.spec.isolating;f++,m=m.firstChild);for(let m=o.content.lastChild;h<o.openEnd&&!m.type.spec.isolating;h++,m=m.lastChild);o=Qj(o,f,h)}return t.someProp("transformPasted",f=>{o=f(o,t,l)}),o}const QQ=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function JQ(t,e){if(t.childCount<2)return t;for(let r=e.depth;r>=0;r--){let i=e.node(r).contentMatchAt(e.index(r)),a,s=[];if(t.forEach(o=>{if(!s)return;let l=i.findWrapping(o.type),c;if(!l)return s=null;if(c=s.length&&a.length&&RD(l,a,o,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=DD(s[s.length-1],a.length));let u=AD(o,l);s.push(u),i=i.matchType(u.type),a=l}}),s)return be.from(s)}return t}function AD(t,e,r=0){for(let n=e.length-1;n>=r;n--)t=e[n].create(null,be.from(t));return t}function RD(t,e,r,n,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let a=RD(t,e,r,n.lastChild,i+1);if(a)return n.copy(n.content.replaceChild(n.childCount-1,a));if(n.contentMatchAt(n.childCount).matchType(i==t.length-1?r.type:t[i+1]))return n.copy(n.content.append(be.from(AD(r,t,i+1))))}}function DD(t,e){if(e==0)return t;let r=t.content.replaceChild(t.childCount-1,DD(t.lastChild,e-1)),n=t.contentMatchAt(t.childCount).fillBefore(be.empty,!0);return t.copy(r.append(n))}function gk(t,e,r,n,i,a){let s=e<0?t.firstChild:t.lastChild,o=s.content;return t.childCount>1&&(a=0),i<n-1&&(o=gk(o,e,r,n,i+1,a)),i>=r&&(o=e<0?s.contentMatchAt(0).fillBefore(o,a<=i).append(o):o.append(s.contentMatchAt(s.childCount).fillBefore(be.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,s.copy(o))}function Qj(t,e,r){return e<t.openStart&&(t=new Ae(gk(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),r<t.openEnd&&(t=new Ae(gk(t.content,1,r,t.openEnd,0,0),t.openStart,r)),t}const OD={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Jj=null;function ID(){return Jj||(Jj=document.implementation.createHTMLDocument("title"))}let aS=null;function ZQ(t){let e=window.trustedTypes;return e?(aS||(aS=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:r=>r})),aS.createHTML(t)):t}function eJ(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let r=ID().createElement("div"),n=/<([a-z][^>\s]+)/i.exec(t),i;if((i=n&&OD[n[1].toLowerCase()])&&(t=i.map(a=>"<"+a+">").join("")+t+i.map(a=>"</"+a+">").reverse().join("")),r.innerHTML=ZQ(t),i)for(let a=0;a<i.length;a++)r=r.querySelector(i[a])||r;return r}function tJ(t){let e=t.querySelectorAll(fn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let r=0;r<e.length;r++){let n=e[r];n.childNodes.length==1&&n.textContent==""&&n.parentNode&&n.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),n)}}function rJ(t,e){if(!t.size)return t;let r=t.content.firstChild.type.schema,n;try{n=JSON.parse(e)}catch{return t}let{content:i,openStart:a,openEnd:s}=t;for(let o=n.length-2;o>=0;o-=2){let l=r.nodes[n[o]];if(!l||l.hasRequiredAttrs())break;i=be.from(l.create(n[o+1],i)),a++,s++}return new Ae(i,a,s)}const ti={},ri={},nJ={touchstart:!0,touchmove:!0};class iJ{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.badSafariComposition=!1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function aJ(t){for(let e in ti){let r=ti[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=n=>{oJ(t,n)&&!P3(t,n)&&(t.editable||!(n.type in ri))&&r(t,n)},nJ[e]?{passive:!0}:void 0)}Mn&&t.dom.addEventListener("input",()=>null),vk(t)}function Qo(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function sJ(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function vk(t){t.someProp("handleDOMEvents",e=>{for(let r in e)t.input.eventHandlers[r]||t.dom.addEventListener(r,t.input.eventHandlers[r]=n=>P3(t,n))})}function P3(t,e){return t.someProp("handleDOMEvents",r=>{let n=r[e.type];return n?n(t,e)||e.defaultPrevented:!1})}function oJ(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target;r!=t.dom;r=r.parentNode)if(!r||r.nodeType==11||r.pmViewDesc&&r.pmViewDesc.stopEvent(e))return!1;return!0}function lJ(t,e){!P3(t,e)&&ti[e.type]&&(t.editable||!(e.type in ri))&&ti[e.type](t,e)}ri.keydown=(t,e)=>{let r=e;if(t.input.shiftKey=r.keyCode==16||r.shiftKey,!BD(t,r)&&(t.input.lastKeyCode=r.keyCode,t.input.lastKeyCodeTime=Date.now(),!(Hs&&fn&&r.keyCode==13)))if(r.keyCode!=229&&t.domObserver.forceFlush(),zd&&r.keyCode==13&&!r.ctrlKey&&!r.altKey&&!r.metaKey){let n=Date.now();t.input.lastIOSEnter=n,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==n&&(t.someProp("handleKeyDown",i=>i(t,pc(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",n=>n(t,r))||XQ(t,r)?r.preventDefault():Qo(t,"key")};ri.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};ri.keypress=(t,e)=>{let r=e;if(BD(t,r)||!r.charCode||r.ctrlKey&&!r.altKey||Ji&&r.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,r))){r.preventDefault();return}let n=t.state.selection;if(!(n instanceof at)||!n.$from.sameParent(n.$to)){let i=String.fromCharCode(r.charCode),a=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",s=>s(t,n.$from.pos,n.$to.pos,i,a))&&t.dispatch(a()),r.preventDefault()}};function wx(t){return{left:t.clientX,top:t.clientY}}function cJ(t,e){let r=e.x-t.clientX,n=e.y-t.clientY;return r*r+n*n<100}function _3(t,e,r,n,i){if(n==-1)return!1;let a=t.state.doc.resolve(n);for(let s=a.depth+1;s>0;s--)if(t.someProp(e,o=>s>a.depth?o(t,r,a.nodeAfter,a.before(s),i,!0):o(t,r,a.node(s),a.before(s),i,!1)))return!0;return!1}function Cd(t,e,r){if(t.focused||t.focus(),t.state.selection.eq(e))return;let n=t.state.tr.setSelection(e);r=="pointer"&&n.setMeta("pointer",!0),t.dispatch(n)}function uJ(t,e){if(e==-1)return!1;let r=t.state.doc.resolve(e),n=r.nodeAfter;return n&&n.isAtom&&Ye.isSelectable(n)?(Cd(t,new Ye(r),"pointer"),!0):!1}function dJ(t,e){if(e==-1)return!1;let r=t.state.selection,n,i;r instanceof Ye&&(n=r.node);let a=t.state.doc.resolve(e);for(let s=a.depth+1;s>0;s--){let o=s>a.depth?a.nodeAfter:a.node(s);if(Ye.isSelectable(o)){n&&r.$from.depth>0&&s>=r.$from.depth&&a.before(r.$from.depth+1)==r.$from.pos?i=a.before(r.$from.depth):i=a.before(s);break}}return i!=null?(Cd(t,Ye.create(t.state.doc,i),"pointer"),!0):!1}function fJ(t,e,r,n,i){return _3(t,"handleClickOn",e,r,n)||t.someProp("handleClick",a=>a(t,e,n))||(i?dJ(t,r):uJ(t,r))}function hJ(t,e,r,n){return _3(t,"handleDoubleClickOn",e,r,n)||t.someProp("handleDoubleClick",i=>i(t,e,n))}function pJ(t,e,r,n){return _3(t,"handleTripleClickOn",e,r,n)||t.someProp("handleTripleClick",i=>i(t,e,n))||mJ(t,r,n)}function mJ(t,e,r){if(r.button!=0)return!1;let n=t.state.doc;if(e==-1)return n.inlineContent?(Cd(t,at.create(n,0,n.content.size),"pointer"),!0):!1;let i=n.resolve(e);for(let a=i.depth+1;a>0;a--){let s=a>i.depth?i.nodeAfter:i.node(a),o=i.before(a);if(s.inlineContent)Cd(t,at.create(n,o+1,o+1+s.content.size),"pointer");else if(Ye.isSelectable(s))Cd(t,Ye.create(n,o),"pointer");else continue;return!0}}function A3(t){return $0(t)}const LD=Ji?"metaKey":"ctrlKey";ti.mousedown=(t,e)=>{let r=e;t.input.shiftKey=r.shiftKey;let n=A3(t),i=Date.now(),a="singleClick";i-t.input.lastClick.time<500&&cJ(r,t.input.lastClick)&&!r[LD]&&t.input.lastClick.button==r.button&&(t.input.lastClick.type=="singleClick"?a="doubleClick":t.input.lastClick.type=="doubleClick"&&(a="tripleClick")),t.input.lastClick={time:i,x:r.clientX,y:r.clientY,type:a,button:r.button};let s=t.posAtCoords(wx(r));s&&(a=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new gJ(t,s,r,!!n)):(a=="doubleClick"?hJ:pJ)(t,s.pos,s.inside,r)?r.preventDefault():Qo(t,"pointer"))};class gJ{constructor(e,r,n,i){this.view=e,this.pos=r,this.event=n,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[LD],this.allowDefault=n.shiftKey;let a,s;if(r.inside>-1)a=e.state.doc.nodeAt(r.inside),s=r.inside;else{let u=e.state.doc.resolve(r.pos);a=u.parent,s=u.depth?u.before():0}const o=i?null:n.target,l=o?e.docView.nearestDesc(o,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=e.state;(n.button==0&&a.type.spec.draggable&&a.type.spec.selectable!==!1||c instanceof Ye&&c.from<=s&&c.to>s)&&(this.mightDrag={node:a,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&oa&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Qo(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ks(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let r=this.pos;this.view.state.doc!=this.startDoc&&(r=this.view.posAtCoords(wx(e))),this.updateAllowDefault(e),this.allowDefault||!r?Qo(this.view,"pointer"):fJ(this.view,r.pos,r.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Mn&&this.mightDrag&&!this.mightDrag.node.isAtom||fn&&!this.view.state.selection.visible&&Math.min(Math.abs(r.pos-this.view.state.selection.from),Math.abs(r.pos-this.view.state.selection.to))<=2)?(Cd(this.view,ht.near(this.view.state.doc.resolve(r.pos)),"pointer"),e.preventDefault()):Qo(this.view,"pointer")}move(e){this.updateAllowDefault(e),Qo(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}ti.touchstart=t=>{t.input.lastTouch=Date.now(),A3(t),Qo(t,"pointer")};ti.touchmove=t=>{t.input.lastTouch=Date.now(),Qo(t,"pointer")};ti.contextmenu=t=>A3(t);function BD(t,e){return t.composing?!0:Mn&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const vJ=Hs?5e3:-1;ri.compositionstart=ri.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,r=e.selection.$to;if(e.selection instanceof at&&(e.storedMarks||!r.textOffset&&r.parentOffset&&r.nodeBefore.marks.some(n=>n.type.spec.inclusive===!1)||fn&&mD&&yJ(t)))t.markCursor=t.state.storedMarks||r.marks(),$0(t,!0),t.markCursor=null;else if($0(t,!e.selection.empty),oa&&e.selection.empty&&r.parentOffset&&!r.textOffset&&r.nodeBefore.marks.length){let n=t.domSelectionRange();for(let i=n.focusNode,a=n.focusOffset;i&&i.nodeType==1&&a!=0;){let s=a<0?i.lastChild:i.childNodes[a-1];if(!s)break;if(s.nodeType==3){let o=t.domSelection();o&&o.collapse(s,s.nodeValue.length);break}else i=s,a=-1}}t.input.composing=!0}FD(t,vJ)};function yJ(t){let{focusNode:e,focusOffset:r}=t.domSelectionRange();if(!e||e.nodeType!=1||r>=e.childNodes.length)return!1;let n=e.childNodes[r];return n.nodeType==1&&n.contentEditable=="false"}ri.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.badSafariComposition?t.domObserver.forceFlush():t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,FD(t,20))};function FD(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>$0(t),e))}function zD(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=bJ());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function xJ(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let r=dQ(e.focusNode,e.focusOffset),n=fQ(e.focusNode,e.focusOffset);if(r&&n&&r!=n){let i=n.pmViewDesc,a=t.domObserver.lastChangedTextNode;if(r==a||n==a)return a;if(!i||!i.isText(n.nodeValue))return n;if(t.input.compositionNode==n){let s=r.pmViewDesc;if(!(!s||!s.isText(r.nodeValue)))return n}}return r||n}function bJ(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function $0(t,e=!1){if(!(Hs&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),zD(t),e||t.docView&&t.docView.dirty){let r=T3(t),n=t.state.selection;return r&&!r.eq(n)?t.dispatch(t.state.tr.setSelection(r)):(t.markCursor||e)&&!n.$from.node(n.$from.sharedDepth(n.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function wJ(t,e){if(!t.dom.parentNode)return;let r=t.dom.parentNode.appendChild(document.createElement("div"));r.appendChild(e),r.style.cssText="position: fixed; left: -10000px; top: 10px";let n=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),n.removeAllRanges(),n.addRange(i),setTimeout(()=>{r.parentNode&&r.parentNode.removeChild(r),t.focus()},50)}const Ap=wi&&ul<15||zd&&gQ<604;ti.copy=ri.cut=(t,e)=>{let r=e,n=t.state.selection,i=r.type=="cut";if(n.empty)return;let a=Ap?null:r.clipboardData,s=n.content(),{dom:o,text:l}=M3(t,s);a?(r.preventDefault(),a.clearData(),a.setData("text/html",o.innerHTML),a.setData("text/plain",l)):wJ(t,o),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function SJ(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function kJ(t,e){if(!t.dom.parentNode)return;let r=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,n=t.dom.parentNode.appendChild(document.createElement(r?"textarea":"div"));r||(n.contentEditable="true"),n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),n.parentNode&&n.parentNode.removeChild(n),r?Rp(t,n.value,null,i,e):Rp(t,n.textContent,n.innerHTML,i,e)},50)}function Rp(t,e,r,n,i){let a=_D(t,e,r,n,t.state.selection.$from);if(t.someProp("handlePaste",l=>l(t,i,a||Ae.empty)))return!0;if(!a)return!1;let s=SJ(a),o=s?t.state.tr.replaceSelectionWith(s,n):t.state.tr.replaceSelection(a);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function VD(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let r=t.getData("text/uri-list");return r?r.replace(/\r?\n/g," "):""}ri.paste=(t,e)=>{let r=e;if(t.composing&&!Hs)return;let n=Ap?null:r.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;n&&Rp(t,VD(n),n.getData("text/html"),i,r)?r.preventDefault():kJ(t,r)};class $D{constructor(e,r,n){this.slice=e,this.move=r,this.node=n}}const CJ=Ji?"altKey":"ctrlKey";function UD(t,e){let r=t.someProp("dragCopies",n=>!n(e));return r??!e[CJ]}ti.dragstart=(t,e)=>{let r=e,n=t.input.mouseDown;if(n&&n.done(),!r.dataTransfer)return;let i=t.state.selection,a=i.empty?null:t.posAtCoords(wx(r)),s;if(!(a&&a.pos>=i.from&&a.pos<=(i instanceof Ye?i.to-1:i.to))){if(n&&n.mightDrag)s=Ye.create(t.state.doc,n.mightDrag.pos);else if(r.target&&r.target.nodeType==1){let f=t.docView.nearestDesc(r.target,!0);f&&f.node.type.spec.draggable&&f!=t.docView&&(s=Ye.create(t.state.doc,f.posBefore))}}let o=(s||t.state.selection).content(),{dom:l,text:c,slice:u}=M3(t,o);(!r.dataTransfer.files.length||!fn||pD>120)&&r.dataTransfer.clearData(),r.dataTransfer.setData(Ap?"Text":"text/html",l.innerHTML),r.dataTransfer.effectAllowed="copyMove",Ap||r.dataTransfer.setData("text/plain",c),t.dragging=new $D(u,UD(t,r),s)};ti.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};ri.dragover=ri.dragenter=(t,e)=>e.preventDefault();ri.drop=(t,e)=>{try{NJ(t,e,t.dragging)}finally{t.dragging=null}};function NJ(t,e,r){if(!e.dataTransfer)return;let n=t.posAtCoords(wx(e));if(!n)return;let i=t.state.doc.resolve(n.pos),a=r&&r.slice;a?t.someProp("transformPasted",m=>{a=m(a,t,!1)}):a=_D(t,VD(e.dataTransfer),Ap?null:e.dataTransfer.getData("text/html"),!1,i);let s=!!(r&&UD(t,e));if(t.someProp("handleDrop",m=>m(t,e,a||Ae.empty,s))){e.preventDefault();return}if(!a)return;e.preventDefault();let o=a?Z7(t.state.doc,i.pos,a):i.pos;o==null&&(o=i.pos);let l=t.state.tr;if(s){let{node:m}=r;m?m.replace(l):l.deleteSelection()}let c=l.mapping.map(o),u=a.openStart==0&&a.openEnd==0&&a.content.childCount==1,f=l.doc;if(u?l.replaceRangeWith(c,c,a.content.firstChild):l.replaceRange(c,c,a),l.doc.eq(f))return;let h=l.doc.resolve(c);if(u&&Ye.isSelectable(a.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(a.content.firstChild))l.setSelection(new Ye(h));else{let m=l.mapping.map(o);l.mapping.maps[l.mapping.maps.length-1].forEach((v,y,x,b)=>m=b),l.setSelection(j3(t,h,l.doc.resolve(m)))}t.focus(),t.dispatch(l.setMeta("uiEvent","drop"))}ti.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Ks(t)},20))};ti.blur=(t,e)=>{let r=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),r.relatedTarget&&t.dom.contains(r.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};ti.beforeinput=(t,e)=>{if(fn&&Hs&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:n}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=n||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",a=>a(t,pc(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in ri)ti[t]=ri[t];function Dp(t,e){if(t==e)return!0;for(let r in t)if(t[r]!==e[r])return!1;for(let r in e)if(!(r in t))return!1;return!0}class U0{constructor(e,r){this.toDOM=e,this.spec=r||jc,this.side=this.spec.side||0}map(e,r,n,i){let{pos:a,deleted:s}=e.mapResult(r.from+i,this.side<0?-1:1);return s?null:new $n(a-n,a-n,this)}valid(){return!0}eq(e){return this==e||e instanceof U0&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Dp(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class fl{constructor(e,r){this.attrs=e,this.spec=r||jc}map(e,r,n,i){let a=e.map(r.from+i,this.spec.inclusiveStart?-1:1)-n,s=e.map(r.to+i,this.spec.inclusiveEnd?1:-1)-n;return a>=s?null:new $n(a,s,this)}valid(e,r){return r.from<r.to}eq(e){return this==e||e instanceof fl&&Dp(this.attrs,e.attrs)&&Dp(this.spec,e.spec)}static is(e){return e.type instanceof fl}destroy(){}}class R3{constructor(e,r){this.attrs=e,this.spec=r||jc}map(e,r,n,i){let a=e.mapResult(r.from+i,1);if(a.deleted)return null;let s=e.mapResult(r.to+i,-1);return s.deleted||s.pos<=a.pos?null:new $n(a.pos-n,s.pos-n,this)}valid(e,r){let{index:n,offset:i}=e.content.findIndex(r.from),a;return i==r.from&&!(a=e.child(n)).isText&&i+a.nodeSize==r.to}eq(e){return this==e||e instanceof R3&&Dp(this.attrs,e.attrs)&&Dp(this.spec,e.spec)}destroy(){}}class $n{constructor(e,r,n){this.from=e,this.to=r,this.type=n}copy(e,r){return new $n(e,r,this.type)}eq(e,r=0){return this.type.eq(e.type)&&this.from+r==e.from&&this.to+r==e.to}map(e,r,n){return this.type.map(e,this,r,n)}static widget(e,r,n){return new $n(e,e,new U0(r,n))}static inline(e,r,n,i){return new $n(e,r,new fl(n,i))}static node(e,r,n,i){return new $n(e,r,new R3(n,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof fl}get widget(){return this.type instanceof U0}}const Gu=[],jc={};class sr{constructor(e,r){this.local=e.length?e:Gu,this.children=r.length?r:Gu}static create(e,r){return r.length?G0(r,e,0,jc):zn}find(e,r,n){let i=[];return this.findInner(e??0,r??1e9,i,0,n),i}findInner(e,r,n,i,a){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=r&&o.to>=e&&(!a||a(o.spec))&&n.push(o.copy(o.from+i,o.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<r&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,r-o,n,i+o,a)}}map(e,r,n){return this==zn||e.maps.length==0?this:this.mapInner(e,r,0,0,n||jc)}mapInner(e,r,n,i,a){let s;for(let o=0;o<this.local.length;o++){let l=this.local[o].map(e,n,i);l&&l.type.valid(r,l)?(s||(s=[])).push(l):a.onRemove&&a.onRemove(this.local[o].spec)}return this.children.length?EJ(this.children,s||[],e,r,n,i,a):s?new sr(s.sort(Mc),Gu):zn}add(e,r){return r.length?this==zn?sr.create(e,r):this.addInner(e,r,0):this}addInner(e,r,n){let i,a=0;e.forEach((o,l)=>{let c=l+n,u;if(u=HD(r,o,c)){for(i||(i=this.children.slice());a<i.length&&i[a]<l;)a+=3;i[a]==l?i[a+2]=i[a+2].addInner(o,u,c+1):i.splice(a,0,l,l+o.nodeSize,G0(u,o,c+1,jc)),a+=3}});let s=GD(a?WD(r):r,-n);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||s.splice(o--,1);return new sr(s.length?this.local.concat(s).sort(Mc):this.local,i||this.children)}remove(e){return e.length==0||this==zn?this:this.removeInner(e,0)}removeInner(e,r){let n=this.children,i=this.local;for(let a=0;a<n.length;a+=3){let s,o=n[a]+r,l=n[a+1]+r;for(let u=0,f;u<e.length;u++)(f=e[u])&&f.from>o&&f.to<l&&(e[u]=null,(s||(s=[])).push(f));if(!s)continue;n==this.children&&(n=this.children.slice());let c=n[a+2].removeInner(s,o+1);c!=zn?n[a+2]=c:(n.splice(a,3),a-=3)}if(i.length){for(let a=0,s;a<e.length;a++)if(s=e[a])for(let o=0;o<i.length;o++)i[o].eq(s,r)&&(i==this.local&&(i=this.local.slice()),i.splice(o--,1))}return n==this.children&&i==this.local?this:i.length||n.length?new sr(i,n):zn}forChild(e,r){if(this==zn)return this;if(r.isLeaf)return sr.empty;let n,i;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}let a=e+1,s=a+r.content.size;for(let o=0;o<this.local.length;o++){let l=this.local[o];if(l.from<s&&l.to>a&&l.type instanceof fl){let c=Math.max(a,l.from)-a,u=Math.min(s,l.to)-a;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let o=new sr(i.sort(Mc),Gu);return n?new Vo([o,n]):o}return n||zn}eq(e){if(this==e)return!0;if(!(e instanceof sr)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let r=0;r<this.local.length;r++)if(!this.local[r].eq(e.local[r]))return!1;for(let r=0;r<this.children.length;r+=3)if(this.children[r]!=e.children[r]||this.children[r+1]!=e.children[r+1]||!this.children[r+2].eq(e.children[r+2]))return!1;return!0}locals(e){return D3(this.localsInner(e))}localsInner(e){if(this==zn)return Gu;if(e.inlineContent||!this.local.some(fl.is))return this.local;let r=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof fl||r.push(this.local[n]);return r}forEachSet(e){e(this)}}sr.empty=new sr([],[]);sr.removeOverlap=D3;const zn=sr.empty;class Vo{constructor(e){this.members=e}map(e,r){const n=this.members.map(i=>i.map(e,r,jc));return Vo.from(n)}forChild(e,r){if(r.isLeaf)return sr.empty;let n=[];for(let i=0;i<this.members.length;i++){let a=this.members[i].forChild(e,r);a!=zn&&(a instanceof Vo?n=n.concat(a.members):n.push(a))}return Vo.from(n)}eq(e){if(!(e instanceof Vo)||e.members.length!=this.members.length)return!1;for(let r=0;r<this.members.length;r++)if(!this.members[r].eq(e.members[r]))return!1;return!0}locals(e){let r,n=!0;for(let i=0;i<this.members.length;i++){let a=this.members[i].localsInner(e);if(a.length)if(!r)r=a;else{n&&(r=r.slice(),n=!1);for(let s=0;s<a.length;s++)r.push(a[s])}}return r?D3(n?r:r.sort(Mc)):Gu}static from(e){switch(e.length){case 0:return zn;case 1:return e[0];default:return new Vo(e.every(r=>r instanceof sr)?e:e.reduce((r,n)=>r.concat(n instanceof sr?n:n.members),[]))}}forEachSet(e){for(let r=0;r<this.members.length;r++)this.members[r].forEachSet(e)}}function EJ(t,e,r,n,i,a,s){let o=t.slice();for(let c=0,u=a;c<r.maps.length;c++){let f=0;r.maps[c].forEach((h,m,v,y)=>{let x=y-v-(m-h);for(let b=0;b<o.length;b+=3){let S=o[b+1];if(S<0||h>S+u-f)continue;let w=o[b]+u-f;m>=w?o[b+1]=h<=w?-2:-1:h>=u&&x&&(o[b]+=x,o[b+1]+=x)}f+=x}),u=r.maps[c].map(u,-1)}let l=!1;for(let c=0;c<o.length;c+=3)if(o[c+1]<0){if(o[c+1]==-2){l=!0,o[c+1]=-1;continue}let u=r.map(t[c]+a),f=u-i;if(f<0||f>=n.content.size){l=!0;continue}let h=r.map(t[c+1]+a,-1),m=h-i,{index:v,offset:y}=n.content.findIndex(f),x=n.maybeChild(v);if(x&&y==f&&y+x.nodeSize==m){let b=o[c+2].mapInner(r,x,u+1,t[c]+a+1,s);b!=zn?(o[c]=f,o[c+1]=m,o[c+2]=b):(o[c+1]=-2,l=!0)}else l=!0}if(l){let c=TJ(o,t,e,r,i,a,s),u=G0(c,n,0,s);e=u.local;for(let f=0;f<o.length;f+=3)o[f+1]<0&&(o.splice(f,3),f-=3);for(let f=0,h=0;f<u.children.length;f+=3){let m=u.children[f];for(;h<o.length&&o[h]<m;)h+=3;o.splice(h,0,u.children[f],u.children[f+1],u.children[f+2])}}return new sr(e.sort(Mc),o)}function GD(t,e){if(!e||!t.length)return t;let r=[];for(let n=0;n<t.length;n++){let i=t[n];r.push(new $n(i.from+e,i.to+e,i.type))}return r}function TJ(t,e,r,n,i,a,s){function o(l,c){for(let u=0;u<l.local.length;u++){let f=l.local[u].map(n,i,c);f?r.push(f):s.onRemove&&s.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)o(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&o(t[l+2],e[l]+a+1);return r}function HD(t,e,r){if(e.isLeaf)return null;let n=r+e.nodeSize,i=null;for(let a=0,s;a<t.length;a++)(s=t[a])&&s.from>r&&s.to<n&&((i||(i=[])).push(s),t[a]=null);return i}function WD(t){let e=[];for(let r=0;r<t.length;r++)t[r]!=null&&e.push(t[r]);return e}function G0(t,e,r,n){let i=[],a=!1;e.forEach((o,l)=>{let c=HD(t,o,l+r);if(c){a=!0;let u=G0(c,o,r+l+1,n);u!=zn&&i.push(l,l+o.nodeSize,u)}});let s=GD(a?WD(t):t,-r).sort(Mc);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||(n.onRemove&&n.onRemove(s[o].spec),s.splice(o--,1));return s.length||i.length?new sr(s,i):zn}function Mc(t,e){return t.from-e.from||t.to-e.to}function D3(t){let e=t;for(let r=0;r<e.length-1;r++){let n=e[r];if(n.from!=n.to)for(let i=r+1;i<e.length;i++){let a=e[i];if(a.from==n.from){a.to!=n.to&&(e==t&&(e=t.slice()),e[i]=a.copy(a.from,n.to),Zj(e,i+1,a.copy(n.to,a.to)));continue}else{a.from<n.to&&(e==t&&(e=t.slice()),e[r]=n.copy(n.from,a.from),Zj(e,i,n.copy(a.from,n.to)));break}}}return e}function Zj(t,e,r){for(;e<t.length&&Mc(r,t[e])>0;)e++;t.splice(e,0,r)}function sS(t){let e=[];return t.someProp("decorations",r=>{let n=r(t.state);n&&n!=zn&&e.push(n)}),t.cursorWrapper&&e.push(sr.create(t.state.doc,[t.cursorWrapper.deco])),Vo.from(e)}const jJ={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},MJ=wi&&ul<=11;class PJ{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class _J{constructor(e,r){this.view=e,this.handleDOMChange=r,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new PJ,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(n=>{for(let i=0;i<n.length;i++)this.queue.push(n[i]);wi&&ul<=11&&n.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():Mn&&e.composing&&n.some(i=>i.type=="childList"&&i.target.nodeName=="TR")?(e.input.badSafariComposition=!0,this.flushSoon()):this.flush()}),MJ&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,jJ)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let r=0;r<e.length;r++)this.queue.push(e[r]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Hj(this.view)){if(this.suppressingSelectionUpdates)return Ks(this.view);if(wi&&ul<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Wc(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let r=new Set,n;for(let a=e.focusNode;a;a=Fd(a))r.add(a);for(let a=e.anchorNode;a;a=Fd(a))if(r.has(a)){n=a;break}let i=n&&this.view.docView.nearestDesc(n);if(i&&i.ignoreMutation({type:"selection",target:n.nodeType==3?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let r=this.pendingRecords();r.length&&(this.queue=[]);let n=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Hj(e)&&!this.ignoreSelectionChange(n),a=-1,s=-1,o=!1,l=[];if(e.editable)for(let u=0;u<r.length;u++){let f=this.registerMutation(r[u],l);f&&(a=a<0?f.from:Math.min(f.from,a),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(o=!0))}if(oa&&l.length){let u=l.filter(f=>f.nodeName=="BR");if(u.length==2){let[f,h]=u;f.parentNode&&f.parentNode.parentNode==h.parentNode?h.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let h of u){let m=h.parentNode;m&&m.nodeName=="LI"&&(!f||DJ(e,f)!=m)&&h.remove()}}}else if((fn||Mn)&&l.some(u=>u.nodeName=="BR")&&(e.input.lastKeyCode==8||e.input.lastKeyCode==46)){for(let u of l)if(u.nodeName=="BR"&&u.parentNode){let f=u.nextSibling;f&&f.nodeType==1&&f.contentEditable=="false"&&u.parentNode.removeChild(u)}}let c=null;a<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&xx(n)&&(c=T3(e))&&c.eq(ht.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ks(e),this.currentSelection.set(n),e.scrollToSelection()):(a>-1||i)&&(a>-1&&(e.docView.markDirty(a,s),AJ(e)),e.input.badSafariComposition&&(e.input.badSafariComposition=!1,OJ(e,l)),this.handleDOMChange(a,s,o,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||Ks(e),this.currentSelection.set(n))}registerMutation(e,r){if(r.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(n==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let f=e.addedNodes[u];r.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let i=e.previousSibling,a=e.nextSibling;if(wi&&ul<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:f,nextSibling:h}=e.addedNodes[u];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(a=h)}let s=i&&i.parentNode==e.target?kn(i)+1:0,o=n.localPosFromDOM(e.target,s,-1),l=a&&a.parentNode==e.target?kn(a):e.target.childNodes.length,c=n.localPosFromDOM(e.target,l,1);return{from:o,to:c}}else return e.type=="attributes"?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let e9=new WeakMap,t9=!1;function AJ(t){if(!e9.has(t)&&(e9.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=oa,t9)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),t9=!0}}function r9(t,e){let r=e.startContainer,n=e.startOffset,i=e.endContainer,a=e.endOffset,s=t.domAtPos(t.state.selection.anchor);return Wc(s.node,s.offset,i,a)&&([r,n,i,a]=[i,a,r,n]),{anchorNode:r,anchorOffset:n,focusNode:i,focusOffset:a}}function RJ(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return r9(t,i)}let r;function n(i){i.preventDefault(),i.stopImmediatePropagation(),r=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0),r?r9(t,r):null}function DJ(t,e){for(let r=e.parentNode;r&&r!=t.dom;r=r.parentNode){let n=t.docView.nearestDesc(r,!0);if(n&&n.node.isBlock)return r}return null}function OJ(t,e){var r;let{focusNode:n,focusOffset:i}=t.domSelectionRange();for(let a of e)if(((r=a.parentNode)===null||r===void 0?void 0:r.nodeName)=="TR"){let s=a.nextSibling;for(;s&&s.nodeName!="TD"&&s.nodeName!="TH";)s=s.nextSibling;if(s){let o=s;for(;;){let l=o.firstChild;if(!l||l.nodeType!=1||l.contentEditable=="false"||/^(BR|IMG)$/.test(l.nodeName))break;o=l}o.insertBefore(a,o.firstChild),n==a&&t.domSelection().collapse(a,i)}else a.parentNode.removeChild(a)}}function IJ(t,e,r){let{node:n,fromOffset:i,toOffset:a,from:s,to:o}=t.docView.parseRange(e,r),l=t.domSelectionRange(),c,u=l.anchorNode;if(u&&t.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],xx(l)||c.push({node:l.focusNode,offset:l.focusOffset})),fn&&t.input.lastKeyCode===8)for(let x=a;x>i;x--){let b=n.childNodes[x-1],S=b.pmViewDesc;if(b.nodeName=="BR"&&!S){a=x;break}if(!S||S.size)break}let f=t.state.doc,h=t.someProp("domParser")||cl.fromSchema(t.state.schema),m=f.resolve(s),v=null,y=h.parse(n,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:i,to:a,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:LJ,context:m});if(c&&c[0].pos!=null){let x=c[0].pos,b=c[1]&&c[1].pos;b==null&&(b=x),v={anchor:x+s,head:b+s}}return{doc:y,sel:v,from:s,to:o}}function LJ(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Mn&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let r=document.createElement("div");return r.appendChild(document.createElement("li")),{skip:r}}else if(t.parentNode.lastChild==t||Mn&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const BJ=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function FJ(t,e,r,n,i){let a=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let T=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,M=T3(t,T);if(M&&!t.state.selection.eq(M)){if(fn&&Hs&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",_=>_(t,pc(13,"Enter"))))return;let A=t.state.tr.setSelection(M);T=="pointer"?A.setMeta("pointer",!0):T=="key"&&A.scrollIntoView(),a&&A.setMeta("composition",a),t.dispatch(A)}return}let s=t.state.doc.resolve(e),o=s.sharedDepth(r);e=s.before(o+1),r=t.state.doc.resolve(r).after(o+1);let l=t.state.selection,c=IJ(t,e,r),u=t.state.doc,f=u.slice(c.from,c.to),h,m;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(h=t.state.selection.to,m="end"):(h=t.state.selection.from,m="start"),t.input.lastKeyCode=null;let v=$J(f.content,c.doc.content,c.from,h,m);if(v&&t.input.domChangeCount++,(zd&&t.input.lastIOSEnter>Date.now()-225||Hs)&&i.some(T=>T.nodeType==1&&!BJ.test(T.nodeName))&&(!v||v.endA>=v.endB)&&t.someProp("handleKeyDown",T=>T(t,pc(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!v)if(n&&l instanceof at&&!l.empty&&l.$head.sameParent(l.$anchor)&&!t.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))v={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let T=n9(t,t.state.doc,c.sel);if(T&&!T.eq(t.state.selection)){let M=t.state.tr.setSelection(T);a&&M.setMeta("composition",a),t.dispatch(M)}}return}t.state.selection.from<t.state.selection.to&&v.start==v.endB&&t.state.selection instanceof at&&(v.start>t.state.selection.from&&v.start<=t.state.selection.from+2&&t.state.selection.from>=c.from?v.start=t.state.selection.from:v.endA<t.state.selection.to&&v.endA>=t.state.selection.to-2&&t.state.selection.to<=c.to&&(v.endB+=t.state.selection.to-v.endA,v.endA=t.state.selection.to)),wi&&ul<=11&&v.endB==v.start+1&&v.endA==v.start&&v.start>c.from&&c.doc.textBetween(v.start-c.from-1,v.start-c.from+1)==" "&&(v.start--,v.endA--,v.endB--);let y=c.doc.resolveNoCache(v.start-c.from),x=c.doc.resolveNoCache(v.endB-c.from),b=u.resolve(v.start),S=y.sameParent(x)&&y.parent.inlineContent&&b.end()>=v.endA;if((zd&&t.input.lastIOSEnter>Date.now()-225&&(!S||i.some(T=>T.nodeName=="DIV"||T.nodeName=="P"))||!S&&y.pos<c.doc.content.size&&(!y.sameParent(x)||!y.parent.inlineContent)&&y.pos<x.pos&&!/\S/.test(c.doc.textBetween(y.pos,x.pos,"","")))&&t.someProp("handleKeyDown",T=>T(t,pc(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>v.start&&VJ(u,v.start,v.endA,y,x)&&t.someProp("handleKeyDown",T=>T(t,pc(8,"Backspace")))){Hs&&fn&&t.domObserver.suppressSelectionUpdates();return}fn&&v.endB==v.start&&(t.input.lastChromeDelete=Date.now()),Hs&&!S&&y.start()!=x.start()&&x.parentOffset==0&&y.depth==x.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==v.endA&&(v.endB-=2,x=c.doc.resolveNoCache(v.endB-c.from),setTimeout(()=>{t.someProp("handleKeyDown",function(T){return T(t,pc(13,"Enter"))})},20));let w=v.start,k=v.endA,N=T=>{let M=T||t.state.tr.replace(w,k,c.doc.slice(v.start-c.from,v.endB-c.from));if(c.sel){let A=n9(t,M.doc,c.sel);A&&!(fn&&t.composing&&A.empty&&(v.start!=v.endB||t.input.lastChromeDelete<Date.now()-100)&&(A.head==w||A.head==M.mapping.map(k)-1)||wi&&A.empty&&A.head==w)&&M.setSelection(A)}return a&&M.setMeta("composition",a),M.scrollIntoView()},j;if(S)if(y.pos==x.pos){wi&&ul<=11&&y.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Ks(t),20));let T=N(t.state.tr.delete(w,k)),M=u.resolve(v.start).marksAcross(u.resolve(v.endA));M&&T.ensureMarks(M),t.dispatch(T)}else if(v.endA==v.endB&&(j=zJ(y.parent.content.cut(y.parentOffset,x.parentOffset),b.parent.content.cut(b.parentOffset,v.endA-b.start())))){let T=N(t.state.tr);j.type=="add"?T.addMark(w,k,j.mark):T.removeMark(w,k,j.mark),t.dispatch(T)}else if(y.parent.child(y.index()).isText&&y.index()==x.index()-(x.textOffset?0:1)){let T=y.parent.textBetween(y.parentOffset,x.parentOffset),M=()=>N(t.state.tr.insertText(T,w,k));t.someProp("handleTextInput",A=>A(t,w,k,T,M))||t.dispatch(M())}else t.dispatch(N());else t.dispatch(N())}function n9(t,e,r){return Math.max(r.anchor,r.head)>e.content.size?null:j3(t,e.resolve(r.anchor),e.resolve(r.head))}function zJ(t,e){let r=t.firstChild.marks,n=e.firstChild.marks,i=r,a=n,s,o,l;for(let u=0;u<n.length;u++)i=n[u].removeFromSet(i);for(let u=0;u<r.length;u++)a=r[u].removeFromSet(a);if(i.length==1&&a.length==0)o=i[0],s="add",l=u=>u.mark(o.addToSet(u.marks));else if(i.length==0&&a.length==1)o=a[0],s="remove",l=u=>u.mark(o.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(be.from(c).eq(t))return{mark:o,type:s}}function VJ(t,e,r,n,i){if(r-e<=i.pos-n.pos||oS(n,!0,!1)<i.pos)return!1;let a=t.resolve(e);if(!n.parent.isTextblock){let o=a.nodeAfter;return o!=null&&r==e+o.nodeSize}if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let s=t.resolve(oS(a,!0,!0));return!s.parent.isTextblock||s.pos>r||oS(s,!0,!1)<r?!1:n.parent.content.cut(n.parentOffset).eq(s.parent.content)}function oS(t,e,r){let n=t.depth,i=e?t.end():t.pos;for(;n>0&&(e||t.indexAfter(n)==t.node(n).childCount);)n--,i++,e=!1;if(r){let a=t.node(n).maybeChild(t.indexAfter(n));for(;a&&!a.isLeaf;)a=a.firstChild,i++}return i}function $J(t,e,r,n,i){let a=t.findDiffStart(e,r);if(a==null)return null;let{a:s,b:o}=t.findDiffEnd(e,r+t.size,r+e.size);if(i=="end"){let l=Math.max(0,a-Math.min(s,o));n-=s+l-a}if(s<a&&t.size<e.size){let l=n<=a&&n>=s?a-n:0;a-=l,a&&a<e.size&&i9(e.textBetween(a-1,a+1))&&(a+=l?1:-1),o=a+(o-s),s=a}else if(o<a){let l=n<=a&&n>=o?a-n:0;a-=l,a&&a<t.size&&i9(t.textBetween(a-1,a+1))&&(a+=l?1:-1),s=a+(s-o),o=a}return{start:a,endA:s,endB:o}}function i9(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),r=t.charCodeAt(1);return e>=56320&&e<=57343&&r>=55296&&r<=56319}class qD{constructor(e,r){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new iJ,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=r,this.state=r.state,this.directPlugins=r.plugins||[],this.directPlugins.forEach(c9),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=o9(this),s9(this),this.nodeViews=l9(this),this.docView=Fj(this.state.doc,a9(this),sS(this),this.dom,this),this.domObserver=new _J(this,(n,i,a,s)=>FJ(this,n,i,a,s)),this.domObserver.start(),aJ(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let r in e)this._props[r]=e[r];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&vk(this);let r=this._props;this._props=e,e.plugins&&(e.plugins.forEach(c9),this.directPlugins=e.plugins),this.updateStateInner(e.state,r)}setProps(e){let r={};for(let n in this._props)r[n]=this._props[n];r.state=this.state;for(let n in e)r[n]=e[n];this.update(r)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,r){var n;let i=this.state,a=!1,s=!1;e.storedMarks&&this.composing&&(zD(this),s=!0),this.state=e;let o=i.plugins!=e.plugins||this._props.plugins!=r.plugins;if(o||this._props.plugins!=r.plugins||this._props.nodeViews!=r.nodeViews){let m=l9(this);GJ(m,this.nodeViews)&&(this.nodeViews=m,a=!0)}(o||r.handleDOMEvents!=this._props.handleDOMEvents)&&vk(this),this.editable=o9(this),s9(this);let l=sS(this),c=a9(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=a||!this.docView.matchesNode(e.doc,c,l);(f||!e.selection.eq(i.selection))&&(s=!0);let h=u=="preserve"&&s&&this.dom.style.overflowAnchor==null&&xQ(this);if(s){this.domObserver.stop();let m=f&&(wi||fn)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&UJ(i.selection,e.selection);if(f){let v=fn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=xJ(this)),(a||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=Fj(e.doc,c,l,this.dom,this)),v&&(!this.trackWrites||!this.dom.contains(this.trackWrites))&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&UQ(this))?Ks(this,m):(jD(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((n=this.dragging)===null||n===void 0)&&n.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&bQ(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",r=>r(this)))if(this.state.selection instanceof Ye){let r=this.docView.domAfterPos(this.state.selection.from);r.nodeType==1&&Rj(this,r.getBoundingClientRect(),e)}else Rj(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let r=0;r<this.directPlugins.length;r++){let n=this.directPlugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}for(let r=0;r<this.state.plugins.length;r++){let n=this.state.plugins[r];n.spec.view&&this.pluginViews.push(n.spec.view(this))}}else for(let r=0;r<this.pluginViews.length;r++){let n=this.pluginViews[r];n.update&&n.update(this,e)}}updateDraggedNode(e,r){let n=e.node,i=-1;if(this.state.doc.nodeAt(n.from)==n.node)i=n.from;else{let a=n.from+(this.state.doc.content.size-r.doc.content.size);(a>0&&this.state.doc.nodeAt(a))==n.node&&(i=a)}this.dragging=new $D(e.slice,e.move,i<0?void 0:Ye.create(this.state.doc,i))}someProp(e,r){let n=this._props&&this._props[e],i;if(n!=null&&(i=r?r(n):n))return i;for(let s=0;s<this.directPlugins.length;s++){let o=this.directPlugins[s].props[e];if(o!=null&&(i=r?r(o):o))return i}let a=this.state.plugins;if(a)for(let s=0;s<a.length;s++){let o=a[s].props[e];if(o!=null&&(i=r?r(o):o))return i}}hasFocus(){if(wi){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&wQ(this.dom),Ks(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let r=this.dom.parentNode;r;r=r.parentNode)if(r.nodeType==9||r.nodeType==11&&r.host)return r.getSelection||(Object.getPrototypeOf(r).getSelection=()=>r.ownerDocument.getSelection()),this._root=r}return e||document}updateRoot(){this._root=null}posAtCoords(e){return EQ(this,e)}coordsAtPos(e,r=1){return bD(this,e,r)}domAtPos(e,r=0){return this.docView.domFromPos(e,r)}nodeDOM(e){let r=this.docView.descAt(e);return r?r.nodeDOM:null}posAtDOM(e,r,n=-1){let i=this.docView.posFromDOM(e,r,n);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,r){return _Q(this,r||this.state,e)}pasteHTML(e,r){return Rp(this,"",e,!1,r||new ClipboardEvent("paste"))}pasteText(e,r){return Rp(this,e,null,!0,r||new ClipboardEvent("paste"))}serializeForClipboard(e){return M3(this,e)}destroy(){this.docView&&(sJ(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],sS(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,cQ())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return lJ(this,e)}domSelectionRange(){let e=this.domSelection();return e?Mn&&this.root.nodeType===11&&pQ(this.dom.ownerDocument)==this.dom&&RJ(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}qD.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function a9(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",r=>{if(typeof r=="function"&&(r=r(t.state)),r)for(let n in r)n=="class"?e.class+=" "+r[n]:n=="style"?e.style=(e.style?e.style+";":"")+r[n]:!e[n]&&n!="contenteditable"&&n!="nodeName"&&(e[n]=String(r[n]))}),e.translate||(e.translate="no"),[$n.node(0,t.state.doc.content.size,e)]}function s9(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:$n.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function o9(t){return!t.someProp("editable",e=>e(t.state)===!1)}function UJ(t,e){let r=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(r)!=e.$anchor.start(r)}function l9(t){let e=Object.create(null);function r(n){for(let i in n)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=n[i])}return t.someProp("nodeViews",r),t.someProp("markViews",r),e}function GJ(t,e){let r=0,n=0;for(let i in t){if(t[i]!=e[i])return!0;r++}for(let i in e)n++;return r!=n}function c9(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var wl={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},H0={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},HJ=typeof navigator<"u"&&/Mac/.test(navigator.platform),WJ=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Cn=0;Cn<10;Cn++)wl[48+Cn]=wl[96+Cn]=String(Cn);for(var Cn=1;Cn<=24;Cn++)wl[Cn+111]="F"+Cn;for(var Cn=65;Cn<=90;Cn++)wl[Cn]=String.fromCharCode(Cn+32),H0[Cn]=String.fromCharCode(Cn);for(var lS in wl)H0.hasOwnProperty(lS)||(H0[lS]=wl[lS]);function qJ(t){var e=HJ&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||WJ&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?H0:wl)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}const KJ=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),YJ=typeof navigator<"u"&&/Win/.test(navigator.platform);function XJ(t){let e=t.split(/-(?!$)/),r=e[e.length-1];r=="Space"&&(r=" ");let n,i,a,s;for(let o=0;o<e.length-1;o++){let l=e[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))KJ?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return n&&(r="Alt-"+r),i&&(r="Ctrl-"+r),s&&(r="Meta-"+r),a&&(r="Shift-"+r),r}function QJ(t){let e=Object.create(null);for(let r in t)e[XJ(r)]=t[r];return e}function cS(t,e,r=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r&&e.shiftKey&&(t="Shift-"+t),t}function JJ(t){return new ur({props:{handleKeyDown:KD(t)}})}function KD(t){let e=QJ(t);return function(r,n){let i=qJ(n),a,s=e[cS(i,n)];if(s&&s(r.state,r.dispatch,r))return!0;if(i.length==1&&i!=" "){if(n.shiftKey){let o=e[cS(i,n,!1)];if(o&&o(r.state,r.dispatch,r))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(YJ&&n.ctrlKey&&n.altKey)&&(a=wl[n.keyCode])&&a!=i){let o=e[cS(a,n)];if(o&&o(r.state,r.dispatch,r))return!0}}return!1}}var ZJ=Object.defineProperty,O3=(t,e)=>{for(var r in e)ZJ(t,r,{get:e[r],enumerable:!0})};function Sx(t){const{state:e,transaction:r}=t;let{selection:n}=r,{doc:i}=r,{storedMarks:a}=r;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return a},get selection(){return n},get doc(){return i},get tr(){return n=r.selection,i=r.doc,a=r.storedMarks,r}}}var kx=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:r}=this,{view:n}=e,{tr:i}=r,a=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([s,o])=>[s,(...c)=>{const u=o(...c)(a);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&n.dispatch(i),u}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:r,editor:n,state:i}=this,{view:a}=n,s=[],o=!!t,l=t||i.tr,c=()=>(!o&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&a.dispatch(l),s.every(f=>f===!0)),u={...Object.fromEntries(Object.entries(r).map(([f,h])=>[f,(...v)=>{const y=this.buildProps(l,e),x=h(...v)(y);return s.push(x),u}])),run:c};return u}createCan(t){const{rawCommands:e,state:r}=this,n=!1,i=t||r.tr,a=this.buildProps(i,n);return{...Object.fromEntries(Object.entries(e).map(([o,l])=>[o,(...c)=>l(...c)({...a,dispatch:void 0})])),chain:()=>this.createChain(i,n)}}buildProps(t,e=!0){const{rawCommands:r,editor:n,state:i}=this,{view:a}=n,s={tr:t,editor:n,view:a,state:Sx({state:i,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([o,l])=>[o,(...c)=>l(...c)(s)]))}};return s}},YD={};O3(YD,{blur:()=>eZ,clearContent:()=>tZ,clearNodes:()=>rZ,command:()=>nZ,createParagraphNear:()=>iZ,cut:()=>aZ,deleteCurrentNode:()=>sZ,deleteNode:()=>oZ,deleteRange:()=>lZ,deleteSelection:()=>cZ,enter:()=>uZ,exitCode:()=>dZ,extendMarkRange:()=>fZ,first:()=>hZ,focus:()=>mZ,forEach:()=>gZ,insertContent:()=>vZ,insertContentAt:()=>bZ,joinBackward:()=>kZ,joinDown:()=>SZ,joinForward:()=>CZ,joinItemBackward:()=>NZ,joinItemForward:()=>EZ,joinTextblockBackward:()=>TZ,joinTextblockForward:()=>jZ,joinUp:()=>wZ,keyboardShortcut:()=>PZ,lift:()=>_Z,liftEmptyBlock:()=>AZ,liftListItem:()=>RZ,newlineInCode:()=>DZ,resetAttributes:()=>OZ,scrollIntoView:()=>IZ,selectAll:()=>LZ,selectNodeBackward:()=>BZ,selectNodeForward:()=>FZ,selectParentNode:()=>zZ,selectTextblockEnd:()=>VZ,selectTextblockStart:()=>$Z,setContent:()=>UZ,setMark:()=>cee,setMeta:()=>uee,setNode:()=>dee,setNodeSelection:()=>fee,setTextDirection:()=>hee,setTextSelection:()=>pee,sinkListItem:()=>mee,splitBlock:()=>gee,splitListItem:()=>vee,toggleList:()=>yee,toggleMark:()=>xee,toggleNode:()=>bee,toggleWrap:()=>wee,undoInputRule:()=>See,unsetAllMarks:()=>kee,unsetMark:()=>Cee,unsetTextDirection:()=>Nee,updateAttributes:()=>Eee,wrapIn:()=>Tee,wrapInList:()=>jee});var eZ=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var r;t.isDestroyed||(e.dom.blur(),(r=window==null?void 0:window.getSelection())==null||r.removeAllRanges())}),!0),tZ=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),rZ=()=>({state:t,tr:e,dispatch:r})=>{const{selection:n}=e,{ranges:i}=n;return r&&i.forEach(({$from:a,$to:s})=>{t.doc.nodesBetween(a.pos,s.pos,(o,l)=>{if(o.type.isText)return;const{doc:c,mapping:u}=e,f=c.resolve(u.map(l)),h=c.resolve(u.map(l+o.nodeSize)),m=f.blockRange(h);if(!m)return;const v=cf(m);if(o.type.isTextblock){const{defaultType:y}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(m.start,y)}(v||v===0)&&e.lift(m,v)})}),!0},nZ=t=>e=>t(e),iZ=()=>({state:t,dispatch:e})=>YX(t,e),aZ=(t,e)=>({editor:r,tr:n})=>{const{state:i}=r,a=i.doc.slice(t.from,t.to);n.deleteRange(t.from,t.to);const s=n.mapping.map(e);return n.insert(s,a.content),n.setSelection(new at(n.doc.resolve(Math.max(s-1,0)))),!0},sZ=()=>({tr:t,dispatch:e})=>{const{selection:r}=t,n=r.$anchor.node();if(n.content.size>0)return!1;const i=t.selection.$anchor;for(let a=i.depth;a>0;a-=1)if(i.node(a).type===n.type){if(e){const o=i.before(a),l=i.after(a);t.delete(o,l).scrollIntoView()}return!0}return!1};function Ur(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var oZ=t=>({tr:e,state:r,dispatch:n})=>{const i=Ur(t,r.schema),a=e.selection.$anchor;for(let s=a.depth;s>0;s-=1)if(a.node(s).type===i){if(n){const l=a.before(s),c=a.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},lZ=t=>({tr:e,dispatch:r})=>{const{from:n,to:i}=t;return r&&e.delete(n,i),!0},cZ=()=>({state:t,dispatch:e})=>LX(t,e),uZ=()=>({commands:t})=>t.keyboardShortcut("Enter"),dZ=()=>({state:t,dispatch:e})=>KX(t,e);function I3(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function W0(t,e,r={strict:!0}){const n=Object.keys(e);return n.length?n.every(i=>r.strict?e[i]===t[i]:I3(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function XD(t,e,r={}){return t.find(n=>n.type===e&&W0(Object.fromEntries(Object.keys(r).map(i=>[i,n.attrs[i]])),r))}function u9(t,e,r={}){return!!XD(t,e,r)}function L3(t,e,r){var n;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(u=>u.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(u=>u.type===e)||(r=r||((n=i.node.marks[0])==null?void 0:n.attrs),!XD([...i.node.marks],e,r)))return;let s=i.index,o=t.start()+i.offset,l=s+1,c=o+i.node.nodeSize;for(;s>0&&u9([...t.parent.child(s-1).marks],e,r);)s-=1,o-=t.parent.child(s).nodeSize;for(;l<t.parent.childCount&&u9([...t.parent.child(l).marks],e,r);)c+=t.parent.child(l).nodeSize,l+=1;return{from:o,to:c}}function oo(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var fZ=(t,e={})=>({tr:r,state:n,dispatch:i})=>{const a=oo(t,n.schema),{doc:s,selection:o}=r,{$from:l,from:c,to:u}=o;if(i){const f=L3(l,a,e);if(f&&f.from<=c&&f.to>=u){const h=at.create(s,f.from,f.to);r.setSelection(h)}}return!0},hZ=t=>e=>{const r=typeof t=="function"?t(e):t;for(let n=0;n<r.length;n+=1)if(r[n](e))return!0;return!1};function QD(t){return t instanceof at}function wc(t=0,e=0,r=0){return Math.min(Math.max(t,e),r)}function JD(t,e=null){if(!e)return null;const r=ht.atStart(t),n=ht.atEnd(t);if(e==="start"||e===!0)return r;if(e==="end")return n;const i=r.from,a=n.to;return e==="all"?at.create(t,wc(0,i,a),wc(t.content.size,i,a)):at.create(t,wc(e,i,a),wc(e,i,a))}function d9(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function q0(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function pZ(){return typeof navigator<"u"?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1}var mZ=(t=null,e={})=>({editor:r,view:n,tr:i,dispatch:a})=>{e={scrollIntoView:!0,...e};const s=()=>{(q0()||d9())&&n.dom.focus(),pZ()&&!q0()&&!d9()&&n.dom.focus({preventScroll:!0}),requestAnimationFrame(()=>{r.isDestroyed||(n.focus(),e!=null&&e.scrollIntoView&&r.commands.scrollIntoView())})};if(n.hasFocus()&&t===null||t===!1)return!0;if(a&&t===null&&!QD(r.state.selection))return s(),!0;const o=JD(i.doc,t)||r.state.selection,l=r.state.selection.eq(o);return a&&(l||i.setSelection(o),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},gZ=(t,e)=>r=>t.every((n,i)=>e(n,{...r,index:i})),vZ=(t,e)=>({tr:r,commands:n})=>n.insertContentAt({from:r.selection.from,to:r.selection.to},t,e),ZD=t=>{const e=t.childNodes;for(let r=e.length-1;r>=0;r-=1){const n=e[r];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?t.removeChild(n):n.nodeType===1&&ZD(n)}return t};function Jg(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,r=new window.DOMParser().parseFromString(e,"text/html").body;return ZD(r)}function Op(t,e,r){if(t instanceof qs||t instanceof be)return t;r={slice:!0,parseOptions:{},...r};const n=typeof t=="object"&&t!==null,i=typeof t=="string";if(n)try{if(Array.isArray(t)&&t.length>0)return be.fromArray(t.map(o=>e.nodeFromJSON(o)));const s=e.nodeFromJSON(t);return r.errorOnInvalidContent&&s.check(),s}catch(a){if(r.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:a});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",a),Op("",e,r)}if(i){if(r.errorOnInvalidContent){let s=!1,o="";const l=new $7({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,o=typeof c=="string"?c:c.outerHTML,null)}]}})});if(r.slice?cl.fromSchema(l).parseSlice(Jg(t),r.parseOptions):cl.fromSchema(l).parse(Jg(t),r.parseOptions),r.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${o}`)})}const a=cl.fromSchema(e);return r.slice?a.parseSlice(Jg(t),r.parseOptions).content:a.parse(Jg(t),r.parseOptions)}return Op("",e,r)}function yZ(t,e,r){const n=t.steps.length-1;if(n<e)return;const i=t.steps[n];if(!(i instanceof dn||i instanceof mn))return;const a=t.mapping.maps[n];let s=0;a.forEach((o,l,c,u)=>{s===0&&(s=u)}),t.setSelection(ht.near(t.doc.resolve(s),r))}var xZ=t=>!("type"in t),bZ=(t,e,r)=>({tr:n,dispatch:i,editor:a})=>{var s;if(i){r={parseOptions:a.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...r};let o;const l=x=>{a.emit("contentError",{editor:a,error:x,disableCollaboration:()=>{"collaboration"in a.storage&&typeof a.storage.collaboration=="object"&&a.storage.collaboration&&(a.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...r.parseOptions};if(!r.errorOnInvalidContent&&!a.options.enableContentCheck&&a.options.emitContentError)try{Op(e,a.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(x){l(x)}try{o=Op(e,a.schema,{parseOptions:c,errorOnInvalidContent:(s=r.errorOnInvalidContent)!=null?s:a.options.enableContentCheck})}catch(x){return l(x),!1}let{from:u,to:f}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},h=!0,m=!0;if((xZ(o)?o:[o]).forEach(x=>{x.check(),h=h?x.isText&&x.marks.length===0:!1,m=m?x.isBlock:!1}),u===f&&m){const{parent:x}=n.doc.resolve(u);x.isTextblock&&!x.type.spec.code&&!x.childCount&&(u-=1,f+=1)}let y;if(h){if(Array.isArray(e))y=e.map(x=>x.text||"").join("");else if(e instanceof be){let x="";e.forEach(b=>{b.text&&(x+=b.text)}),y=x}else typeof e=="object"&&e&&e.text?y=e.text:y=e;n.insertText(y,u,f)}else{y=o;const x=n.doc.resolve(u),b=x.node(),S=x.parentOffset===0,w=b.isText||b.isTextblock,k=b.content.size>0;S&&w&&k&&(u=Math.max(0,u-1)),n.replaceWith(u,f,y)}r.updateSelection&&yZ(n,n.steps.length-1,-1),r.applyInputRules&&n.setMeta("applyInputRules",{from:u,text:y}),r.applyPasteRules&&n.setMeta("applyPasteRules",{from:u,text:y})}return!0},wZ=()=>({state:t,dispatch:e})=>GX(t,e),SZ=()=>({state:t,dispatch:e})=>HX(t,e),kZ=()=>({state:t,dispatch:e})=>BX(t,e),CZ=()=>({state:t,dispatch:e})=>$X(t,e),NZ=()=>({state:t,dispatch:e,tr:r})=>{try{const n=gx(t.doc,t.selection.$from.pos,-1);return n==null?!1:(r.join(n,2),e&&e(r),!0)}catch{return!1}},EZ=()=>({state:t,dispatch:e,tr:r})=>{try{const n=gx(t.doc,t.selection.$from.pos,1);return n==null?!1:(r.join(n,2),e&&e(r),!0)}catch{return!1}},TZ=()=>({state:t,dispatch:e})=>FX(t,e),jZ=()=>({state:t,dispatch:e})=>zX(t,e);function eO(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function MZ(t){const e=t.split(/-(?!$)/);let r=e[e.length-1];r==="Space"&&(r=" ");let n,i,a,s;for(let o=0;o<e.length-1;o+=1){const l=e[o];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))a=!0;else if(/^mod$/i.test(l))q0()||eO()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return n&&(r=`Alt-${r}`),i&&(r=`Ctrl-${r}`),s&&(r=`Meta-${r}`),a&&(r=`Shift-${r}`),r}var PZ=t=>({editor:e,view:r,tr:n,dispatch:i})=>{const a=MZ(t).split(/-(?!$)/),s=a.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),o=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{r.someProp("handleKeyDown",c=>c(r,o))});return l==null||l.steps.forEach(c=>{const u=c.map(n.mapping);u&&i&&n.maybeStep(u)}),!0};function Sl(t,e,r={}){const{from:n,to:i,empty:a}=t.selection,s=e?Ur(e,t.schema):null,o=[];t.doc.nodesBetween(n,i,(f,h)=>{if(f.isText)return;const m=Math.max(n,h),v=Math.min(i,h+f.nodeSize);o.push({node:f,from:m,to:v})});const l=i-n,c=o.filter(f=>s?s.name===f.node.type.name:!0).filter(f=>W0(f.node.attrs,r,{strict:!1}));return a?!!c.length:c.reduce((f,h)=>f+h.to-h.from,0)>=l}var _Z=(t,e={})=>({state:r,dispatch:n})=>{const i=Ur(t,r.schema);return Sl(r,i,e)?WX(r,n):!1},AZ=()=>({state:t,dispatch:e})=>XX(t,e),RZ=t=>({state:e,dispatch:r})=>{const n=Ur(t,e.schema);return aQ(n)(e,r)},DZ=()=>({state:t,dispatch:e})=>qX(t,e);function Cx(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function f9(t,e){const r=typeof e=="string"?[e]:e;return Object.keys(t).reduce((n,i)=>(r.includes(i)||(n[i]=t[i]),n),{})}var OZ=(t,e)=>({tr:r,state:n,dispatch:i})=>{let a=null,s=null;const o=Cx(typeof t=="string"?t:t.name,n.schema);if(!o)return!1;o==="node"&&(a=Ur(t,n.schema)),o==="mark"&&(s=oo(t,n.schema));let l=!1;return r.selection.ranges.forEach(c=>{n.doc.nodesBetween(c.$from.pos,c.$to.pos,(u,f)=>{a&&a===u.type&&(l=!0,i&&r.setNodeMarkup(f,void 0,f9(u.attrs,e))),s&&u.marks.length&&u.marks.forEach(h=>{s===h.type&&(l=!0,i&&r.addMark(f,f+u.nodeSize,s.create(f9(h.attrs,e))))})})}),l},IZ=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),LZ=()=>({tr:t,dispatch:e})=>{if(e){const r=new sa(t.doc);t.setSelection(r)}return!0},BZ=()=>({state:t,dispatch:e})=>VX(t,e),FZ=()=>({state:t,dispatch:e})=>UX(t,e),zZ=()=>({state:t,dispatch:e})=>QX(t,e),VZ=()=>({state:t,dispatch:e})=>eQ(t,e),$Z=()=>({state:t,dispatch:e})=>ZX(t,e);function yk(t,e,r={},n={}){return Op(t,e,{slice:!1,parseOptions:r,errorOnInvalidContent:n.errorOnInvalidContent})}var UZ=(t,{errorOnInvalidContent:e,emitUpdate:r=!0,parseOptions:n={}}={})=>({editor:i,tr:a,dispatch:s,commands:o})=>{const{doc:l}=a;if(n.preserveWhitespace!=="full"){const c=yk(t,i.schema,n,{errorOnInvalidContent:e??i.options.enableContentCheck});return s&&a.replaceWith(0,l.content.size,c).setMeta("preventUpdate",!r),!0}return s&&a.setMeta("preventUpdate",!r),o.insertContentAt({from:0,to:l.content.size},t,{parseOptions:n,errorOnInvalidContent:e??i.options.enableContentCheck})};function tO(t,e){const r=oo(e,t.schema),{from:n,to:i,empty:a}=t.selection,s=[];a?(t.storedMarks&&s.push(...t.storedMarks),s.push(...t.selection.$head.marks())):t.doc.nodesBetween(n,i,l=>{s.push(...l.marks)});const o=s.find(l=>l.type.name===r.name);return o?{...o.attrs}:{}}function rO(t,e){const r=new iD(t);return e.forEach(n=>{n.steps.forEach(i=>{r.step(i)})}),r}function GZ(t){for(let e=0;e<t.edgeCount;e+=1){const{type:r}=t.edge(e);if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function HZ(t,e,r){const n=[];return t.nodesBetween(e.from,e.to,(i,a)=>{r(i)&&n.push({node:i,pos:a})}),n}function WZ(t,e){for(let r=t.depth;r>0;r-=1){const n=t.node(r);if(e(n))return{pos:r>0?t.before(r):0,start:t.start(r),depth:r,node:n}}}function Nx(t){return e=>WZ(e.$from,t)}function qe(t,e,r){return t.config[e]===void 0&&t.parent?qe(t.parent,e,r):typeof t.config[e]=="function"?t.config[e].bind({...r,parent:t.parent?qe(t.parent,e,r):null}):t.config[e]}function B3(t){return t.map(e=>{const r={name:e.name,options:e.options,storage:e.storage},n=qe(e,"addExtensions",r);return n?[e,...B3(n())]:e}).flat(10)}function F3(t,e){const r=tu.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(r),i.innerHTML}function nO(t){return typeof t=="function"}function Bt(t,e=void 0,...r){return nO(t)?e?t.bind(e)(...r):t(...r):t}function qZ(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Vd(t){const e=t.filter(i=>i.type==="extension"),r=t.filter(i=>i.type==="node"),n=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:r,markExtensions:n}}function iO(t){const e=[],{nodeExtensions:r,markExtensions:n}=Vd(t),i=[...r,...n],a={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage,extensions:i},l=qe(s,"addGlobalAttributes",o);if(!l)return;l().forEach(u=>{u.types.forEach(f=>{Object.entries(u.attributes).forEach(([h,m])=>{e.push({type:f,name:h,attribute:{...a,...m}})})})})}),i.forEach(s=>{const o={name:s.name,options:s.options,storage:s.storage},l=qe(s,"addAttributes",o);if(!l)return;const c=l();Object.entries(c).forEach(([u,f])=>{const h={...a,...f};typeof(h==null?void 0:h.default)=="function"&&(h.default=h.default()),h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete h.default,e.push({type:s.name,name:u,attribute:h})})}),e}function cr(...t){return t.filter(e=>!!e).reduce((e,r)=>{const n={...e};return Object.entries(r).forEach(([i,a])=>{if(!n[i]){n[i]=a;return}if(i==="class"){const o=a?String(a).split(" "):[],l=n[i]?n[i].split(" "):[],c=o.filter(u=>!l.includes(u));n[i]=[...l,...c].join(" ")}else if(i==="style"){const o=a?a.split(";").map(u=>u.trim()).filter(Boolean):[],l=n[i]?n[i].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[f,h]=u.split(":").map(m=>m.trim());c.set(f,h)}),o.forEach(u=>{const[f,h]=u.split(":").map(m=>m.trim());c.set(f,h)}),n[i]=Array.from(c.entries()).map(([u,f])=>`${u}: ${f}`).join("; ")}else n[i]=a}),n},{})}function Ip(t,e){return e.filter(r=>r.type===t.type.name).filter(r=>r.attribute.rendered).map(r=>r.attribute.renderHTML?r.attribute.renderHTML(t.attrs)||{}:{[r.name]:t.attrs[r.name]}).reduce((r,n)=>cr(r,n),{})}function KZ(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function h9(t,e){return"style"in t?t:{...t,getAttrs:r=>{const n=t.getAttrs?t.getAttrs(r):t.attrs;if(n===!1)return!1;const i=e.reduce((a,s)=>{const o=s.attribute.parseHTML?s.attribute.parseHTML(r):KZ(r.getAttribute(s.name));return o==null?a:{...a,[s.name]:o}},{});return{...n,...i}}}}function p9(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>e==="attrs"&&qZ(r)?!1:r!=null))}function m9(t){var e,r;const n={};return!((e=t==null?void 0:t.attribute)!=null&&e.isRequired)&&"default"in((t==null?void 0:t.attribute)||{})&&(n.default=t.attribute.default),((r=t==null?void 0:t.attribute)==null?void 0:r.validate)!==void 0&&(n.validate=t.attribute.validate),[t.name,n]}function YZ(t,e){var r;const n=iO(t),{nodeExtensions:i,markExtensions:a}=Vd(t),s=(r=i.find(c=>qe(c,"topNode")))==null?void 0:r.name,o=Object.fromEntries(i.map(c=>{const u=n.filter(b=>b.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((b,S)=>{const w=qe(S,"extendNodeSchema",f);return{...b,...w?w(c):{}}},{}),m=p9({...h,content:Bt(qe(c,"content",f)),marks:Bt(qe(c,"marks",f)),group:Bt(qe(c,"group",f)),inline:Bt(qe(c,"inline",f)),atom:Bt(qe(c,"atom",f)),selectable:Bt(qe(c,"selectable",f)),draggable:Bt(qe(c,"draggable",f)),code:Bt(qe(c,"code",f)),whitespace:Bt(qe(c,"whitespace",f)),linebreakReplacement:Bt(qe(c,"linebreakReplacement",f)),defining:Bt(qe(c,"defining",f)),isolating:Bt(qe(c,"isolating",f)),attrs:Object.fromEntries(u.map(m9))}),v=Bt(qe(c,"parseHTML",f));v&&(m.parseDOM=v.map(b=>h9(b,u)));const y=qe(c,"renderHTML",f);y&&(m.toDOM=b=>y({node:b,HTMLAttributes:Ip(b,u)}));const x=qe(c,"renderText",f);return x&&(m.toText=x),[c.name,m]})),l=Object.fromEntries(a.map(c=>{const u=n.filter(x=>x.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},h=t.reduce((x,b)=>{const S=qe(b,"extendMarkSchema",f);return{...x,...S?S(c):{}}},{}),m=p9({...h,inclusive:Bt(qe(c,"inclusive",f)),excludes:Bt(qe(c,"excludes",f)),group:Bt(qe(c,"group",f)),spanning:Bt(qe(c,"spanning",f)),code:Bt(qe(c,"code",f)),attrs:Object.fromEntries(u.map(m9))}),v=Bt(qe(c,"parseHTML",f));v&&(m.parseDOM=v.map(x=>h9(x,u)));const y=qe(c,"renderHTML",f);return y&&(m.toDOM=x=>y({mark:x,HTMLAttributes:Ip(x,u)})),[c.name,m]}));return new $7({topNode:s,nodes:o,marks:l})}function XZ(t){const e=t.filter((r,n)=>t.indexOf(r)!==n);return Array.from(new Set(e))}function K0(t){return t.sort((r,n)=>{const i=qe(r,"priority")||100,a=qe(n,"priority")||100;return i>a?-1:i<a?1:0})}function aO(t){const e=K0(B3(t)),r=XZ(e.map(n=>n.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(n=>`'${n}'`).join(", ")}]. This can lead to issues.`),e}function sO(t,e,r){const{from:n,to:i}=e,{blockSeparator:a=`

`,textSerializers:s={}}=r||{};let o="";return t.nodesBetween(n,i,(l,c,u,f)=>{var h;l.isBlock&&c>n&&(o+=a);const m=s==null?void 0:s[l.type.name];if(m)return u&&(o+=m({node:l,pos:c,parent:u,index:f,range:e})),!1;l.isText&&(o+=(h=l==null?void 0:l.text)==null?void 0:h.slice(Math.max(n,c)-c,i-c))}),o}function QZ(t,e){const r={from:0,to:t.content.size};return sO(t,r,e)}function oO(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,r])=>[e,r.spec.toText]))}function JZ(t,e){const r=Ur(e,t.schema),{from:n,to:i}=t.selection,a=[];t.doc.nodesBetween(n,i,o=>{a.push(o)});const s=a.reverse().find(o=>o.type.name===r.name);return s?{...s.attrs}:{}}function lO(t,e){const r=Cx(typeof e=="string"?e:e.name,t.schema);return r==="node"?JZ(t,e):r==="mark"?tO(t,e):{}}function ZZ(t,e=JSON.stringify){const r={};return t.filter(n=>{const i=e(n);return Object.prototype.hasOwnProperty.call(r,i)?!1:r[i]=!0})}function eee(t){const e=ZZ(t);return e.length===1?e:e.filter((r,n)=>!e.filter((a,s)=>s!==n).some(a=>r.oldRange.from>=a.oldRange.from&&r.oldRange.to<=a.oldRange.to&&r.newRange.from>=a.newRange.from&&r.newRange.to<=a.newRange.to))}function cO(t){const{mapping:e,steps:r}=t,n=[];return e.maps.forEach((i,a)=>{const s=[];if(i.ranges.length)i.forEach((o,l)=>{s.push({from:o,to:l})});else{const{from:o,to:l}=r[a];if(o===void 0||l===void 0)return;s.push({from:o,to:l})}s.forEach(({from:o,to:l})=>{const c=e.slice(a).map(o,-1),u=e.slice(a).map(l),f=e.invert().map(c,-1),h=e.invert().map(u);n.push({oldRange:{from:f,to:h},newRange:{from:c,to:u}})})}),eee(n)}function z3(t,e,r){const n=[];return t===e?r.resolve(t).marks().forEach(i=>{const a=r.resolve(t),s=L3(a,i.type);s&&n.push({mark:i,...s})}):r.nodesBetween(t,e,(i,a)=>{!i||(i==null?void 0:i.nodeSize)===void 0||n.push(...i.marks.map(s=>({from:a,to:a+i.nodeSize,mark:s})))}),n}var tee=(t,e,r,n=20)=>{const i=t.doc.resolve(r);let a=n,s=null;for(;a>0&&s===null;){const o=i.node(a);(o==null?void 0:o.type.name)===e?s=o:a-=1}return[s,a]};function Zg(t,e){return e.nodes[t]||e.marks[t]||null}function zv(t,e,r){return Object.fromEntries(Object.entries(r).filter(([n])=>{const i=t.find(a=>a.type===e&&a.name===n);return i?i.attribute.keepOnSplit:!1}))}var ree=(t,e=500)=>{let r="";const n=t.parentOffset;return t.parent.nodesBetween(Math.max(0,n-e),n,(i,a,s,o)=>{var l,c;const u=((c=(l=i.type.spec).toText)==null?void 0:c.call(l,{node:i,pos:a,parent:s,index:o}))||i.textContent||"%leaf%";r+=i.isAtom&&!i.isText?u:u.slice(0,Math.max(0,n-a))}),r};function xk(t,e,r={}){const{empty:n,ranges:i}=t.selection,a=e?oo(e,t.schema):null;if(n)return!!(t.storedMarks||t.selection.$from.marks()).filter(f=>a?a.name===f.type.name:!0).find(f=>W0(f.attrs,r,{strict:!1}));let s=0;const o=[];if(i.forEach(({$from:f,$to:h})=>{const m=f.pos,v=h.pos;t.doc.nodesBetween(m,v,(y,x)=>{if(!y.isText&&!y.marks.length)return;const b=Math.max(m,x),S=Math.min(v,x+y.nodeSize),w=S-b;s+=w,o.push(...y.marks.map(k=>({mark:k,from:b,to:S})))})}),s===0)return!1;const l=o.filter(f=>a?a.name===f.mark.type.name:!0).filter(f=>W0(f.mark.attrs,r,{strict:!1})).reduce((f,h)=>f+h.to-h.from,0),c=o.filter(f=>a?f.mark.type!==a&&f.mark.type.excludes(a):!0).reduce((f,h)=>f+h.to-h.from,0);return(l>0?l+c:l)>=s}function nee(t,e,r={}){if(!e)return Sl(t,null,r)||xk(t,null,r);const n=Cx(e,t.schema);return n==="node"?Sl(t,e,r):n==="mark"?xk(t,e,r):!1}var iee=(t,e)=>{const{$from:r,$to:n,$anchor:i}=t.selection;if(e){const a=Nx(o=>o.type.name===e)(t.selection);if(!a)return!1;const s=t.doc.resolve(a.pos+1);return i.pos+1===s.end()}return!(n.parentOffset<n.parent.nodeSize-2||r.pos!==n.pos)},aee=t=>{const{$from:e,$to:r}=t.selection;return!(e.parentOffset>0||e.pos!==r.pos)};function g9(t,e){return Array.isArray(e)?e.some(r=>(typeof r=="string"?r:r.name)===t.name):e}function v9(t,e){const{nodeExtensions:r}=Vd(e),n=r.find(s=>s.name===t);if(!n)return!1;const i={name:n.name,options:n.options,storage:n.storage},a=Bt(qe(n,"group",i));return typeof a!="string"?!1:a.split(" ").includes("list")}function Ex(t,{checkChildren:e=!0,ignoreWhitespace:r=!1}={}){var n;if(r){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((n=t.text)!=null?n:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(a=>{i!==!1&&(Ex(a,{ignoreWhitespace:r,checkChildren:e})||(i=!1))}),i}return!1}function uO(t){return t instanceof Ye}var dO=class fO{constructor(e){this.position=e}static fromJSON(e){return new fO(e.position)}toJSON(){return{position:this.position}}};function see(t,e){const r=e.mapping.mapResult(t.position);return{position:new dO(r.pos),mapResult:r}}function oee(t){return new dO(t)}function lee(t,e,r){var n;const{selection:i}=e;let a=null;if(QD(i)&&(a=i.$cursor),a){const o=(n=t.storedMarks)!=null?n:a.marks();return a.parent.type.allowsMarkType(r)&&(!!r.isInSet(o)||!o.some(c=>c.type.excludes(r)))}const{ranges:s}=i;return s.some(({$from:o,$to:l})=>{let c=o.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(r):!1;return t.doc.nodesBetween(o.pos,l.pos,(u,f,h)=>{if(c)return!1;if(u.isInline){const m=!h||h.type.allowsMarkType(r),v=!!r.isInSet(u.marks)||!u.marks.some(y=>y.type.excludes(r));c=m&&v}return!c}),c})}var cee=(t,e={})=>({tr:r,state:n,dispatch:i})=>{const{selection:a}=r,{empty:s,ranges:o}=a,l=oo(t,n.schema);if(i)if(s){const c=tO(n,l);r.addStoredMark(l.create({...c,...e}))}else o.forEach(c=>{const u=c.$from.pos,f=c.$to.pos;n.doc.nodesBetween(u,f,(h,m)=>{const v=Math.max(m,u),y=Math.min(m+h.nodeSize,f);h.marks.find(b=>b.type===l)?h.marks.forEach(b=>{l===b.type&&r.addMark(v,y,l.create({...b.attrs,...e}))}):r.addMark(v,y,l.create(e))})});return lee(n,r,l)},uee=(t,e)=>({tr:r})=>(r.setMeta(t,e),!0),dee=(t,e={})=>({state:r,dispatch:n,chain:i})=>{const a=Ur(t,r.schema);let s;return r.selection.$anchor.sameParent(r.selection.$head)&&(s=r.selection.$anchor.parent.attrs),a.isTextblock?i().command(({commands:o})=>Pj(a,{...s,...e})(r)?!0:o.clearNodes()).command(({state:o})=>Pj(a,{...s,...e})(o,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},fee=t=>({tr:e,dispatch:r})=>{if(r){const{doc:n}=e,i=wc(t,0,n.content.size),a=Ye.create(n,i);e.setSelection(a)}return!0},hee=(t,e)=>({tr:r,state:n,dispatch:i})=>{const{selection:a}=n;let s,o;return typeof e=="number"?(s=e,o=e):e&&"from"in e&&"to"in e?(s=e.from,o=e.to):(s=a.from,o=a.to),i&&r.doc.nodesBetween(s,o,(l,c)=>{l.isText||r.setNodeMarkup(c,void 0,{...l.attrs,dir:t})}),!0},pee=t=>({tr:e,dispatch:r})=>{if(r){const{doc:n}=e,{from:i,to:a}=typeof t=="number"?{from:t,to:t}:t,s=at.atStart(n).from,o=at.atEnd(n).to,l=wc(i,s,o),c=wc(a,s,o),u=at.create(n,l,c);e.setSelection(u)}return!0},mee=t=>({state:e,dispatch:r})=>{const n=Ur(t,e.schema);return lQ(n)(e,r)};function y9(t,e){const r=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(r){const n=r.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(n)}}var gee=({keepMarks:t=!0}={})=>({tr:e,state:r,dispatch:n,editor:i})=>{const{selection:a,doc:s}=e,{$from:o,$to:l}=a,c=i.extensionManager.attributes,u=zv(c,o.node().type.name,o.node().attrs);if(a instanceof Ye&&a.node.isBlock)return!o.parentOffset||!Sd(s,o.pos)?!1:(n&&(t&&y9(r,i.extensionManager.splittableMarks),e.split(o.pos).scrollIntoView()),!0);if(!o.parent.isBlock)return!1;const f=l.parentOffset===l.parent.content.size,h=o.depth===0?void 0:GZ(o.node(-1).contentMatchAt(o.indexAfter(-1)));let m=f&&h?[{type:h,attrs:u}]:void 0,v=Sd(e.doc,e.mapping.map(o.pos),1,m);if(!m&&!v&&Sd(e.doc,e.mapping.map(o.pos),1,h?[{type:h}]:void 0)&&(v=!0,m=h?[{type:h,attrs:u}]:void 0),n){if(v&&(a instanceof at&&e.deleteSelection(),e.split(e.mapping.map(o.pos),1,m),h&&!f&&!o.parentOffset&&o.parent.type!==h)){const y=e.mapping.map(o.before()),x=e.doc.resolve(y);o.node(-1).canReplaceWith(x.index(),x.index()+1,h)&&e.setNodeMarkup(e.mapping.map(o.before()),h)}t&&y9(r,i.extensionManager.splittableMarks),e.scrollIntoView()}return v},vee=(t,e={})=>({tr:r,state:n,dispatch:i,editor:a})=>{var s;const o=Ur(t,n.schema),{$from:l,$to:c}=n.selection,u=n.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const f=l.node(-1);if(f.type!==o)return!1;const h=a.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==o||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let b=be.empty;const S=l.index(-1)?1:l.index(-2)?2:3;for(let M=l.depth-S;M>=l.depth-3;M-=1)b=be.from(l.node(M).copy(b));const w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,k={...zv(h,l.node().type.name,l.node().attrs),...e},N=((s=o.contentMatch.defaultType)==null?void 0:s.createAndFill(k))||void 0;b=b.append(be.from(o.createAndFill(null,N)||void 0));const j=l.before(l.depth-(S-1));r.replace(j,l.after(-w),new Ae(b,4-S,0));let T=-1;r.doc.nodesBetween(j,r.doc.content.size,(M,A)=>{if(T>-1)return!1;M.isTextblock&&M.content.size===0&&(T=A+1)}),T>-1&&r.setSelection(at.near(r.doc.resolve(T))),r.scrollIntoView()}return!0}const m=c.pos===l.end()?f.contentMatchAt(0).defaultType:null,v={...zv(h,f.type.name,f.attrs),...e},y={...zv(h,l.node().type.name,l.node().attrs),...e};r.delete(l.pos,c.pos);const x=m?[{type:o,attrs:v},{type:m,attrs:y}]:[{type:o,attrs:v}];if(!Sd(r.doc,l.pos,2))return!1;if(i){const{selection:b,storedMarks:S}=n,{splittableMarks:w}=a.extensionManager,k=S||b.$to.parentOffset&&b.$from.marks();if(r.split(l.pos,2,x).scrollIntoView(),!k||!i)return!0;const N=k.filter(j=>w.includes(j.type.name));r.ensureMarks(N)}return!0},uS=(t,e)=>{const r=Nx(s=>s.type===e)(t.selection);if(!r)return!0;const n=t.doc.resolve(Math.max(0,r.pos-1)).before(r.depth);if(n===void 0)return!0;const i=t.doc.nodeAt(n);return r.node.type===(i==null?void 0:i.type)&&Dl(t.doc,r.pos)&&t.join(r.pos),!0},dS=(t,e)=>{const r=Nx(s=>s.type===e)(t.selection);if(!r)return!0;const n=t.doc.resolve(r.start).after(r.depth);if(n===void 0)return!0;const i=t.doc.nodeAt(n);return r.node.type===(i==null?void 0:i.type)&&Dl(t.doc,n)&&t.join(n),!0},yee=(t,e,r,n={})=>({editor:i,tr:a,state:s,dispatch:o,chain:l,commands:c,can:u})=>{const{extensions:f,splittableMarks:h}=i.extensionManager,m=Ur(t,s.schema),v=Ur(e,s.schema),{selection:y,storedMarks:x}=s,{$from:b,$to:S}=y,w=b.blockRange(S),k=x||y.$to.parentOffset&&y.$from.marks();if(!w)return!1;const N=Nx(j=>v9(j.type.name,f))(y);if(w.depth>=1&&N&&w.depth-N.depth<=1){if(N.node.type===m)return c.liftListItem(v);if(v9(N.node.type.name,f)&&m.validContent(N.node.content)&&o)return l().command(()=>(a.setNodeMarkup(N.pos,m),!0)).command(()=>uS(a,m)).command(()=>dS(a,m)).run()}return!r||!k||!o?l().command(()=>u().wrapInList(m,n)?!0:c.clearNodes()).wrapInList(m,n).command(()=>uS(a,m)).command(()=>dS(a,m)).run():l().command(()=>{const j=u().wrapInList(m,n),T=k.filter(M=>h.includes(M.type.name));return a.ensureMarks(T),j?!0:c.clearNodes()}).wrapInList(m,n).command(()=>uS(a,m)).command(()=>dS(a,m)).run()},xee=(t,e={},r={})=>({state:n,commands:i})=>{const{extendEmptyMarkRange:a=!1}=r,s=oo(t,n.schema);return xk(n,s,e)?i.unsetMark(s,{extendEmptyMarkRange:a}):i.setMark(s,e)},bee=(t,e,r={})=>({state:n,commands:i})=>{const a=Ur(t,n.schema),s=Ur(e,n.schema),o=Sl(n,a,r);let l;return n.selection.$anchor.sameParent(n.selection.$head)&&(l=n.selection.$anchor.parent.attrs),o?i.setNode(s,l):i.setNode(a,{...l,...r})},wee=(t,e={})=>({state:r,commands:n})=>{const i=Ur(t,r.schema);return Sl(r,i,e)?n.lift(i):n.wrapIn(i,e)},See=()=>({state:t,dispatch:e})=>{const r=t.plugins;for(let n=0;n<r.length;n+=1){const i=r[n];let a;if(i.spec.isInputRules&&(a=i.getState(t))){if(e){const s=t.tr,o=a.transform;for(let l=o.steps.length-1;l>=0;l-=1)s.step(o.steps[l].invert(o.docs[l]));if(a.text){const l=s.doc.resolve(a.from).marks();s.replaceWith(a.from,a.to,t.schema.text(a.text,l))}else s.delete(a.from,a.to)}return!0}}return!1},kee=()=>({tr:t,dispatch:e})=>{const{selection:r}=t,{empty:n,ranges:i}=r;return n||e&&i.forEach(a=>{t.removeMark(a.$from.pos,a.$to.pos)}),!0},Cee=(t,e={})=>({tr:r,state:n,dispatch:i})=>{var a;const{extendEmptyMarkRange:s=!1}=e,{selection:o}=r,l=oo(t,n.schema),{$from:c,empty:u,ranges:f}=o;if(!i)return!0;if(u&&s){let{from:h,to:m}=o;const v=(a=c.marks().find(x=>x.type===l))==null?void 0:a.attrs,y=L3(c,l,v);y&&(h=y.from,m=y.to),r.removeMark(h,m,l)}else f.forEach(h=>{r.removeMark(h.$from.pos,h.$to.pos,l)});return r.removeStoredMark(l),!0},Nee=t=>({tr:e,state:r,dispatch:n})=>{const{selection:i}=r;let a,s;return typeof t=="number"?(a=t,s=t):t&&"from"in t&&"to"in t?(a=t.from,s=t.to):(a=i.from,s=i.to),n&&e.doc.nodesBetween(a,s,(o,l)=>{if(o.isText)return;const c={...o.attrs};delete c.dir,e.setNodeMarkup(l,void 0,c)}),!0},Eee=(t,e={})=>({tr:r,state:n,dispatch:i})=>{let a=null,s=null;const o=Cx(typeof t=="string"?t:t.name,n.schema);if(!o)return!1;o==="node"&&(a=Ur(t,n.schema)),o==="mark"&&(s=oo(t,n.schema));let l=!1;return r.selection.ranges.forEach(c=>{const u=c.$from.pos,f=c.$to.pos;let h,m,v,y;r.selection.empty?n.doc.nodesBetween(u,f,(x,b)=>{a&&a===x.type&&(l=!0,v=Math.max(b,u),y=Math.min(b+x.nodeSize,f),h=b,m=x)}):n.doc.nodesBetween(u,f,(x,b)=>{b<u&&a&&a===x.type&&(l=!0,v=Math.max(b,u),y=Math.min(b+x.nodeSize,f),h=b,m=x),b>=u&&b<=f&&(a&&a===x.type&&(l=!0,i&&r.setNodeMarkup(b,void 0,{...x.attrs,...e})),s&&x.marks.length&&x.marks.forEach(S=>{if(s===S.type&&(l=!0,i)){const w=Math.max(b,u),k=Math.min(b+x.nodeSize,f);r.addMark(w,k,s.create({...S.attrs,...e}))}}))}),m&&(h!==void 0&&i&&r.setNodeMarkup(h,void 0,{...m.attrs,...e}),s&&m.marks.length&&m.marks.forEach(x=>{s===x.type&&i&&r.addMark(v,y,s.create({...x.attrs,...e}))}))}),l},Tee=(t,e={})=>({state:r,dispatch:n})=>{const i=Ur(t,r.schema);return tQ(i,e)(r,n)},jee=(t,e={})=>({state:r,dispatch:n})=>{const i=Ur(t,r.schema);return rQ(i,e)(r,n)},Mee=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const r=this.callbacks[t];return r&&r.forEach(n=>n.apply(this,e)),this}off(t,e){const r=this.callbacks[t];return r&&(e?this.callbacks[t]=r.filter(n=>n!==e):delete this.callbacks[t]),this}once(t,e){const r=(...n)=>{this.off(t,r),e.apply(this,n)};return this.on(t,r)}removeAllListeners(){this.callbacks={}}},Tx=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},Pee=(t,e)=>{if(I3(e))return e.exec(t);const r=e(t);if(!r)return null;const n=[r.text];return n.index=r.index,n.input=t,n.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),n.push(r.replaceWith)),n};function ev(t){var e;const{editor:r,from:n,to:i,text:a,rules:s,plugin:o}=t,{view:l}=r;if(l.composing)return!1;const c=l.state.doc.resolve(n);if(c.parent.type.spec.code||(e=c.nodeBefore||c.nodeAfter)!=null&&e.marks.find(h=>h.type.spec.code))return!1;let u=!1;const f=ree(c)+a;return s.forEach(h=>{if(u)return;const m=Pee(f,h.find);if(!m)return;const v=l.state.tr,y=Sx({state:l.state,transaction:v}),x={from:n-(m[0].length-a.length),to:i},{commands:b,chain:S,can:w}=new kx({editor:r,state:y});h.handler({state:y,range:x,match:m,commands:b,chain:S,can:w})===null||!v.steps.length||(h.undoable&&v.setMeta(o,{transform:v,from:n,to:i,text:a}),l.dispatch(v),u=!0)}),u}function _ee(t){const{editor:e,rules:r}=t,n=new ur({state:{init(){return null},apply(i,a,s){const o=i.getMeta(n);if(o)return o;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=F3(be.from(u),s.schema);const{from:f}=l,h=f+u.length;ev({editor:e,from:f,to:h,text:u,rules:r,plugin:n})}),i.selectionSet||i.docChanged?null:a}},props:{handleTextInput(i,a,s,o){return ev({editor:e,from:a,to:s,text:o,rules:r,plugin:n})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:a}=i.state.selection;a&&ev({editor:e,from:a.pos,to:a.pos,text:"",rules:r,plugin:n})}),!1)},handleKeyDown(i,a){if(a.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?ev({editor:e,from:s.pos,to:s.pos,text:`
`,rules:r,plugin:n}):!1}},isInputRules:!0});return n}function Aee(t){return Object.prototype.toString.call(t).slice(8,-1)}function tv(t){return Aee(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function hO(t,e){const r={...t};return tv(t)&&tv(e)&&Object.keys(e).forEach(n=>{tv(e[n])&&tv(t[n])?r[n]=hO(t[n],e[n]):r[n]=e[n]}),r}var V3=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...Bt(qe(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...Bt(qe(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>hO(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},ru=class pO extends V3{constructor(){super(...arguments),this.type="mark"}static create(e={}){const r=typeof e=="function"?e():e;return new pO(r)}static handleExit({editor:e,mark:r}){const{tr:n}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(c=>(c==null?void 0:c.type.name)===r.name))return!1;const l=s.find(c=>(c==null?void 0:c.type.name)===r.name);return l&&n.removeStoredMark(l),n.insertText(" ",i.pos),e.view.dispatch(n),!0}return!1}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}};function Ree(t){return typeof t=="number"}var Dee=class{constructor(t){this.find=t.find,this.handler=t.handler}},Oee=(t,e,r)=>{if(I3(e))return[...t.matchAll(e)];const n=e(t,r);return n?n.map(i=>{const a=[i.text];return a.index=i.index,a.input=t,a.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),a.push(i.replaceWith)),a}):[]};function Iee(t){const{editor:e,state:r,from:n,to:i,rule:a,pasteEvent:s,dropEvent:o}=t,{commands:l,chain:c,can:u}=new kx({editor:e,state:r}),f=[];return r.doc.nodesBetween(n,i,(m,v)=>{var y,x,b,S,w;if((x=(y=m.type)==null?void 0:y.spec)!=null&&x.code||!(m.isText||m.isTextblock||m.isInline))return;const k=(w=(S=(b=m.content)==null?void 0:b.size)!=null?S:m.nodeSize)!=null?w:0,N=Math.max(n,v),j=Math.min(i,v+k);if(N>=j)return;const T=m.isText?m.text||"":m.textBetween(N-v,j-v,void 0,"");Oee(T,a.find,s).forEach(A=>{if(A.index===void 0)return;const _=N+A.index+1,D=_+A[0].length,R={from:r.tr.mapping.map(_),to:r.tr.mapping.map(D)},I=a.handler({state:r,range:R,match:A,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:o});f.push(I)})}),f.every(m=>m!==null)}var rv=null,Lee=t=>{var e;const r=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=r.clipboardData)==null||e.setData("text/html",t),r};function Bee(t){const{editor:e,rules:r}=t;let n=null,i=!1,a=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,o;try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}const l=({state:u,from:f,to:h,rule:m,pasteEvt:v})=>{const y=u.tr,x=Sx({state:u,transaction:y});if(!(!Iee({editor:e,state:x,from:Math.max(f-1,0),to:h.b-1,rule:m,pasteEvent:v,dropEvent:o})||!y.steps.length)){try{o=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{o=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,y}};return r.map(u=>new ur({view(f){const h=v=>{var y;n=(y=f.dom.parentElement)!=null&&y.contains(v.target)?f.dom.parentElement:null,n&&(rv=e)},m=()=>{rv&&(rv=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",m),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",m)}}},props:{handleDOMEvents:{drop:(f,h)=>{if(a=n===f.dom.parentElement,o=h,!a){const m=rv;m!=null&&m.isEditable&&setTimeout(()=>{const v=m.state.selection;v&&m.commands.deleteRange({from:v.from,to:v.to})},10)}return!1},paste:(f,h)=>{var m;const v=(m=h.clipboardData)==null?void 0:m.getData("text/html");return s=h,i=!!(v!=null&&v.includes("data-pm-slice")),!1}}},appendTransaction:(f,h,m)=>{const v=f[0],y=v.getMeta("uiEvent")==="paste"&&!i,x=v.getMeta("uiEvent")==="drop"&&!a,b=v.getMeta("applyPasteRules"),S=!!b;if(!y&&!x&&!S)return;if(S){let{text:N}=b;typeof N=="string"?N=N:N=F3(be.from(N),m.schema);const{from:j}=b,T=j+N.length,M=Lee(N);return l({rule:u,state:m,from:j,to:{b:T},pasteEvt:M})}const w=h.doc.content.findDiffStart(m.doc.content),k=h.doc.content.findDiffEnd(m.doc.content);if(!(!Ree(w)||!k||w===k.b))return l({rule:u,state:m,from:w,to:k,pasteEvt:s})}}))}var jx=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=aO(t),this.schema=YZ(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Zg(e.name,this.schema)},n=qe(e,"addCommands",r);return n?{...t,...n()}:t},{})}get plugins(){const{editor:t}=this;return K0([...this.extensions].reverse()).flatMap(n=>{const i={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:Zg(n.name,this.schema)},a=[],s=qe(n,"addKeyboardShortcuts",i);let o={};if(n.type==="mark"&&qe(n,"exitable",i)&&(o.ArrowRight=()=>ru.handleExit({editor:t,mark:n})),s){const h=Object.fromEntries(Object.entries(s()).map(([m,v])=>[m,()=>v({editor:t})]));o={...o,...h}}const l=JJ(o);a.push(l);const c=qe(n,"addInputRules",i);if(g9(n,t.options.enableInputRules)&&c){const h=c();if(h&&h.length){const m=_ee({editor:t,rules:h}),v=Array.isArray(m)?m:[m];a.push(...v)}}const u=qe(n,"addPasteRules",i);if(g9(n,t.options.enablePasteRules)&&u){const h=u();if(h&&h.length){const m=Bee({editor:t,rules:h});a.push(...m)}}const f=qe(n,"addProseMirrorPlugins",i);if(f){const h=f();a.push(...h)}return a})}get attributes(){return iO(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Vd(this.extensions);return Object.fromEntries(e.filter(r=>!!qe(r,"addNodeView")).map(r=>{const n=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:Ur(r.name,this.schema)},a=qe(r,"addNodeView",i);if(!a)return[];const s=a();if(!s)return[];const o=(l,c,u,f,h)=>{const m=Ip(l,n);return s({node:l,view:c,getPos:u,decorations:f,innerDecorations:h,editor:t,extension:r,HTMLAttributes:m})};return[r.name,o]}))}dispatchTransaction(t){const{editor:e}=this;return K0([...this.extensions].reverse()).reduceRight((n,i)=>{const a={name:i.name,options:i.options,storage:this.editor.extensionStorage[i.name],editor:e,type:Zg(i.name,this.schema)},s=qe(i,"dispatchTransaction",a);return s?o=>{s.call(a,{transaction:o,next:n})}:n},t)}get markViews(){const{editor:t}=this,{markExtensions:e}=Vd(this.extensions);return Object.fromEntries(e.filter(r=>!!qe(r,"addMarkView")).map(r=>{const n=this.attributes.filter(o=>o.type===r.name),i={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:oo(r.name,this.schema)},a=qe(r,"addMarkView",i);if(!a)return[];const s=(o,l,c)=>{const u=Ip(o,n);return a()({mark:o,view:l,inline:c,editor:t,extension:r,HTMLAttributes:u,updateAttributes:f=>{Jee(o,t,f)}})};return[r.name,s]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var r;const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Zg(e.name,this.schema)};e.type==="mark"&&((r=Bt(qe(e,"keepOnSplit",n)))==null||r)&&this.splittableMarks.push(e.name);const i=qe(e,"onBeforeCreate",n),a=qe(e,"onCreate",n),s=qe(e,"onUpdate",n),o=qe(e,"onSelectionUpdate",n),l=qe(e,"onTransaction",n),c=qe(e,"onFocus",n),u=qe(e,"onBlur",n),f=qe(e,"onDestroy",n);i&&this.editor.on("beforeCreate",i),a&&this.editor.on("create",a),s&&this.editor.on("update",s),o&&this.editor.on("selectionUpdate",o),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),f&&this.editor.on("destroy",f)})}};jx.resolve=aO;jx.sort=K0;jx.flatten=B3;var Fee={};O3(Fee,{ClipboardTextSerializer:()=>gO,Commands:()=>vO,Delete:()=>yO,Drop:()=>xO,Editable:()=>bO,FocusEvents:()=>SO,Keymap:()=>kO,Paste:()=>CO,Tabindex:()=>NO,TextDirection:()=>EO,focusEventsPluginKey:()=>wO});var Dr=class mO extends V3{constructor(){super(...arguments),this.type="extension"}static create(e={}){const r=typeof e=="function"?e():e;return new mO(r)}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}},gO=Dr.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new ur({key:new Rr("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:r}=t,{doc:n,selection:i}=e,{ranges:a}=i,s=Math.min(...a.map(u=>u.$from.pos)),o=Math.max(...a.map(u=>u.$to.pos)),l=oO(r);return sO(n,{from:s,to:o},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),vO=Dr.create({name:"commands",addCommands(){return{...YD}}}),yO=Dr.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var r,n,i;const a=()=>{var s,o,l,c;if((c=(l=(o=(s=this.editor.options.coreExtensionOptions)==null?void 0:s.delete)==null?void 0:o.filterTransaction)==null?void 0:l.call(o,t))!=null?c:t.getMeta("y-sync$"))return;const u=rO(t.before,[t,...e]);cO(u).forEach(m=>{u.mapping.mapResult(m.oldRange.from).deletedAfter&&u.mapping.mapResult(m.oldRange.to).deletedBefore&&u.before.nodesBetween(m.oldRange.from,m.oldRange.to,(v,y)=>{const x=y+v.nodeSize-2,b=m.oldRange.from<=y&&x<=m.oldRange.to;this.editor.emit("delete",{type:"node",node:v,from:y,to:x,newFrom:u.mapping.map(y),newTo:u.mapping.map(x),deletedRange:m.oldRange,newRange:m.newRange,partial:!b,editor:this.editor,transaction:t,combinedTransform:u})})});const h=u.mapping;u.steps.forEach((m,v)=>{var y,x;if(m instanceof Pa){const b=h.slice(v).map(m.from,-1),S=h.slice(v).map(m.to),w=h.invert().map(b,-1),k=h.invert().map(S),N=(y=u.doc.nodeAt(b-1))==null?void 0:y.marks.some(T=>T.eq(m.mark)),j=(x=u.doc.nodeAt(S))==null?void 0:x.marks.some(T=>T.eq(m.mark));this.editor.emit("delete",{type:"mark",mark:m.mark,from:m.from,to:m.to,deletedRange:{from:w,to:k},newRange:{from:b,to:S},partial:!!(j||N),editor:this.editor,transaction:t,combinedTransform:u})}})};(i=(n=(r=this.editor.options.coreExtensionOptions)==null?void 0:r.delete)==null?void 0:n.async)==null||i?setTimeout(a,0):a()}}),xO=Dr.create({name:"drop",addProseMirrorPlugins(){return[new ur({key:new Rr("tiptapDrop"),props:{handleDrop:(t,e,r,n)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:r,moved:n})}}})]}}),bO=Dr.create({name:"editable",addProseMirrorPlugins(){return[new ur({key:new Rr("editable"),props:{editable:()=>this.editor.options.editable}})]}}),wO=new Rr("focusEvents"),SO=Dr.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new ur({key:wO,props:{handleDOMEvents:{focus:(e,r)=>{t.isFocused=!0;const n=t.state.tr.setMeta("focus",{event:r}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,r)=>{t.isFocused=!1;const n=t.state.tr.setMeta("blur",{event:r}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}}),kO=Dr.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:o})=>{const{selection:l,doc:c}=o,{empty:u,$anchor:f}=l,{pos:h,parent:m}=f,v=f.parent.isTextblock&&h>0?o.doc.resolve(h-1):f,y=v.parent.type.spec.isolating,x=f.pos-f.parentOffset,b=y&&v.parent.childCount===1?x===f.pos:ht.atStart(c).from===h;return!u||!m.type.isTextblock||m.textContent.length||!b||b&&f.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},a={...n,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return q0()||eO()?a:i},addProseMirrorPlugins(){return[new ur({key:new Rr("clearDocument"),appendTransaction:(t,e,r)=>{if(t.some(y=>y.getMeta("composition")))return;const n=t.some(y=>y.docChanged)&&!e.doc.eq(r.doc),i=t.some(y=>y.getMeta("preventClearDocument"));if(!n||i)return;const{empty:a,from:s,to:o}=e.selection,l=ht.atStart(e.doc).from,c=ht.atEnd(e.doc).to;if(a||!(s===l&&o===c)||!Ex(r.doc))return;const h=r.tr,m=Sx({state:r,transaction:h}),{commands:v}=new kx({editor:this.editor,state:m});if(v.clearNodes(),!!h.steps.length)return h}})]}}),CO=Dr.create({name:"paste",addProseMirrorPlugins(){return[new ur({key:new Rr("tiptapPaste"),props:{handlePaste:(t,e,r)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:r})}}})]}}),NO=Dr.create({name:"tabindex",addProseMirrorPlugins(){return[new ur({key:new Rr("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),EO=Dr.create({name:"textDirection",addOptions(){return{direction:void 0}},addGlobalAttributes(){if(!this.options.direction)return[];const{nodeExtensions:t}=Vd(this.extensions);return[{types:t.filter(e=>e.name!=="text").map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{const r=e.getAttribute("dir");return r&&(r==="ltr"||r==="rtl"||r==="auto")?r:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new ur({key:new Rr("textDirection"),props:{attributes:()=>{const t=this.options.direction;return t?{dir:t}:{}}}})]}}),zee=class Hu{constructor(e,r,n=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=r,this.currentNode=i}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let r=this.from,n=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}r=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:r,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),r=this.resolvedPos.doc.resolve(e);return new Hu(r,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Hu(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Hu(e,this.editor)}get children(){const e=[];return this.node.content.forEach((r,n)=>{const i=r.isBlock&&!r.isTextblock,a=r.isAtom&&!r.isText,s=this.pos+n+(a?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const o=this.resolvedPos.doc.resolve(s);if(!i&&o.depth<=this.depth)return;const l=new Hu(o,this.editor,i,i?r:null);i&&(l.actualDepth=this.depth+1),e.push(new Hu(o,this.editor,i,i?r:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,r={}){let n=null,i=this.parent;for(;i&&!n;){if(i.node.type.name===e)if(Object.keys(r).length>0){const a=i.node.attrs,s=Object.keys(r);for(let o=0;o<s.length;o+=1){const l=s[o];if(a[l]!==r[l])break}}else n=i;i=i.parent}return n}querySelector(e,r={}){return this.querySelectorAll(e,r,!0)[0]||null}querySelectorAll(e,r={},n=!1){let i=[];if(!this.children||this.children.length===0)return i;const a=Object.keys(r);return this.children.forEach(s=>{n&&i.length>0||(s.node.type.name===e&&a.every(l=>r[l]===s.node.attrs[l])&&i.push(s),!(n&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,r,n))))}),i}setAttribute(e){const{tr:r}=this.editor.state;r.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(r)}},Vee=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function $ee(t,e,r){const n=document.querySelector(`style[data-tiptap-style${r?`-${r}`:""}]`);if(n!==null)return n;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute(`data-tiptap-style${r?`-${r}`:""}`,""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}var Uee=class extends Mee{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null,enableExtensionDispatchTransaction:!0},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:see,createMappablePosition:oee},this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:i,moved:a})=>this.options.onDrop(n,i,a)),this.on("paste",({event:n,slice:i})=>this.options.onPaste(n,i)),this.on("delete",this.options.onDelete);const e=this.createDoc(),r=JD(e,this.options.autofocus);this.editorState=ud.create({doc:e,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.options.autofocus!==!1&&this.options.autofocus!==null&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t!=null&&t.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=$ee(Vee,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const r=nO(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let r=e;if([].concat(t).forEach(i=>{const a=typeof i=="string"?`${i}$`:i.key;r=r.filter(s=>!s.key.startsWith(a))}),e.length===r.length)return;const n=this.state.reconfigure({plugins:r});return this.view.updateState(n),n}createExtensionManager(){var t,e;const n=[...this.options.enableCoreExtensions?[bO,gO.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),vO,SO,kO,NO,xO,CO,yO,EO.configure({direction:this.options.textDirection})].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new jx(n,this)}createCommandManager(){this.commandManager=new kx({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=yk(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),t=yk(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){const{editorProps:e,enableExtensionDispatchTransaction:r}=this.options,n=e.dispatchTransaction||this.dispatchTransaction.bind(this),i=r?this.extensionManager.dispatchTransaction(n):n;this.editorView=new qD(t,{...e,attributes:{role:"textbox",...e==null?void 0:e.attributes},dispatchTransaction:i,state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const a=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(a),this.prependClass(),this.injectCSS();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(c=>{var u;return(u=this.capturedTransaction)==null?void 0:u.step(c)});return}const{state:e,transactions:r}=this.state.applyTransaction(t),n=!this.state.selection.eq(e.selection),i=r.includes(t),a=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!i)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:r.slice(1)}),n&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=r.findLast(c=>c.getMeta("focus")||c.getMeta("blur")),o=s==null?void 0:s.getMeta("focus"),l=s==null?void 0:s.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:s}),l&&this.emit("blur",{editor:this,event:l.event,transaction:s}),!(t.getMeta("preventUpdate")||!r.some(c=>c.docChanged)||a.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:r.slice(1)})}getAttributes(t){return lO(this.state,t)}isActive(t,e){const r=typeof t=="string"?t:null,n=typeof t=="string"?e:t;return nee(this.state,r,n)}getJSON(){return this.state.doc.toJSON()}getHTML(){return F3(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:r={}}=t||{};return QZ(this.state.doc,{blockSeparator:e,textSerializers:{...oO(this.schema),...r}})}get isEmpty(){return Ex(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var r;return((r=this.$doc)==null?void 0:r.querySelector(t,e))||null}$nodes(t,e){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new zee(e,this)}get $doc(){return this.$pos(0)}};function $d(t){return new Tx({find:t.find,handler:({state:e,range:r,match:n})=>{const i=Bt(t.getAttributes,void 0,n);if(i===!1||i===null)return null;const{tr:a}=e,s=n[n.length-1],o=n[0];if(s){const l=o.search(/\S/),c=r.from+o.indexOf(s),u=c+s.length;if(z3(r.from,r.to,e.doc).filter(m=>m.mark.type.excluded.find(y=>y===t.type&&y!==m.mark.type)).filter(m=>m.to>c).length)return null;u<r.to&&a.delete(u,r.to),c>r.from&&a.delete(r.from+l,c);const h=r.from+l+s.length;a.addMark(r.from+l,h,t.type.create(i||{})),a.removeStoredMark(t.type)}},undoable:t.undoable})}function Gee(t){return new Tx({find:t.find,handler:({state:e,range:r,match:n})=>{const i=Bt(t.getAttributes,void 0,n)||{},{tr:a}=e,s=r.from;let o=r.to;const l=t.type.create(i);if(n[1]){const c=n[0].lastIndexOf(n[1]);let u=s+c;u>o?u=o:o=u+n[1].length;const f=n[0][n[0].length-1];a.insertText(f,s+n[0].length-1),a.replaceWith(u,o,l)}else if(n[0]){const c=t.type.isInline?s:s-1;a.insert(c,t.type.create(i)).delete(a.mapping.map(s),a.mapping.map(o))}a.scrollIntoView()},undoable:t.undoable})}function bk(t){return new Tx({find:t.find,handler:({state:e,range:r,match:n})=>{const i=e.doc.resolve(r.from),a=Bt(t.getAttributes,void 0,n)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(r.from,r.to).setBlockType(r.from,r.from,t.type,a)},undoable:t.undoable})}function Ud(t){return new Tx({find:t.find,handler:({state:e,range:r,match:n,chain:i})=>{const a=Bt(t.getAttributes,void 0,n)||{},s=e.tr.delete(r.from,r.to),l=s.doc.resolve(r.from).blockRange(),c=l&&S3(l,t.type,a);if(!c)return null;if(s.wrap(l,c),t.keepMarks&&t.editor){const{selection:f,storedMarks:h}=e,{splittableMarks:m}=t.editor.extensionManager,v=h||f.$to.parentOffset&&f.$from.marks();if(v){const y=v.filter(x=>m.includes(x.type.name));s.ensureMarks(y)}}if(t.keepAttributes){const f=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,a).run()}const u=s.doc.resolve(r.from-1).nodeBefore;u&&u.type===t.type&&Dl(s.doc,r.from-1)&&(!t.joinPredicate||t.joinPredicate(n,u))&&s.join(r.from-1)},undoable:t.undoable})}function Hee(t,e){const{selection:r}=t,{$from:n}=r;if(r instanceof Ye){const a=n.index();return n.parent.canReplaceWith(a,a+1,e)}let i=n.depth;for(;i>=0;){const a=n.index(i);if(n.node(i).contentMatchAt(a).matchType(e))return!0;i-=1}return!1}function Wee(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}var qee={};O3(qee,{createAtomBlockMarkdownSpec:()=>Kee,createBlockMarkdownSpec:()=>Yee,createInlineMarkdownSpec:()=>TO,parseAttributes:()=>$3,parseIndentedBlocks:()=>wk,renderNestedMarkdownContent:()=>G3,serializeAttributes:()=>U3});function $3(t){if(!(t!=null&&t.trim()))return{};const e={},r=[],n=t.replace(/["']([^"']*)["']/g,c=>(r.push(c),`__QUOTED_${r.length-1}__`)),i=n.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(i){const c=i.map(u=>u.trim().slice(1));e.class=c.join(" ")}const a=n.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);a&&(e.id=a[1]);const s=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(n.matchAll(s)).forEach(([,c,u])=>{var f;const h=parseInt(((f=u.match(/__QUOTED_(\d+)__/))==null?void 0:f[1])||"0",10),m=r[h];m&&(e[c]=m.slice(1,-1))});const l=n.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(u=>{u.match(/^[a-zA-Z][\w-]*$/)&&(e[u]=!0)}),e}function U3(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(n=>e.push(`.${n}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([r,n])=>{r==="class"||r==="id"||(n===!0?e.push(r):n!==!1&&n!=null&&e.push(`${r}="${String(n)}"`))}),e.join(" ")}function Kee(t){const{nodeName:e,name:r,parseAttributes:n=$3,serializeAttributes:i=U3,defaultAttributes:a={},requiredAttributes:s=[],allowedAttributes:o}=t,l=r||e,c=u=>{if(!o)return u;const f={};return o.forEach(h=>{h in u&&(f[h]=u[h])}),f};return{parseMarkdown:(u,f)=>{const h={...a,...u.attributes};return f.createNode(e,h,[])},markdownTokenizer:{name:e,level:"block",start(u){var f;const h=new RegExp(`^:::${l}(?:\\s|$)`,"m"),m=(f=u.match(h))==null?void 0:f.index;return m!==void 0?m:-1},tokenize(u,f,h){const m=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),v=u.match(m);if(!v)return;const y=v[1]||"",x=n(y);if(!s.find(S=>!(S in x)))return{type:e,raw:v[0],attributes:x}}},renderMarkdown:u=>{const f=c(u.attrs||{}),h=i(f),m=h?` {${h}}`:"";return`:::${l}${m} :::`}}}function Yee(t){const{nodeName:e,name:r,getContent:n,parseAttributes:i=$3,serializeAttributes:a=U3,defaultAttributes:s={},content:o="block",allowedAttributes:l}=t,c=r||e,u=f=>{if(!l)return f;const h={};return l.forEach(m=>{m in f&&(h[m]=f[m])}),h};return{parseMarkdown:(f,h)=>{let m;if(n){const y=n(f);m=typeof y=="string"?[{type:"text",text:y}]:y}else o==="block"?m=h.parseChildren(f.tokens||[]):m=h.parseInline(f.tokens||[]);const v={...s,...f.attributes};return h.createNode(e,v,m)},markdownTokenizer:{name:e,level:"block",start(f){var h;const m=new RegExp(`^:::${c}`,"m"),v=(h=f.match(m))==null?void 0:h.index;return v!==void 0?v:-1},tokenize(f,h,m){var v;const y=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),x=f.match(y);if(!x)return;const[b,S=""]=x,w=i(S);let k=1;const N=b.length;let j="";const T=/^:::([\w-]*)(\s.*)?/gm,M=f.slice(N);for(T.lastIndex=0;;){const A=T.exec(M);if(A===null)break;const _=A.index,D=A[1];if(!((v=A[2])!=null&&v.endsWith(":::"))){if(D)k+=1;else if(k-=1,k===0){const R=M.slice(0,_);j=R.trim();const I=f.slice(0,N+_+A[0].length);let $=[];if(j)if(o==="block")for($=m.blockTokens(R),$.forEach(B=>{B.text&&(!B.tokens||B.tokens.length===0)&&(B.tokens=m.inlineTokens(B.text))});$.length>0;){const B=$[$.length-1];if(B.type==="paragraph"&&(!B.text||B.text.trim()===""))$.pop();else break}else $=m.inlineTokens(j);return{type:e,raw:I,attributes:w,content:j,tokens:$}}}}}},renderMarkdown:(f,h)=>{const m=u(f.attrs||{}),v=a(m),y=v?` {${v}}`:"",x=h.renderChildren(f.content||[],`

`);return`:::${c}${y}

${x}

:::`}}}function Xee(t){if(!t.trim())return{};const e={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(t);for(;n!==null;){const[,i,a,s]=n;e[i]=a||s,n=r.exec(t)}return e}function Qee(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e}="${r}"`).join(" ")}function TO(t){const{nodeName:e,name:r,getContent:n,parseAttributes:i=Xee,serializeAttributes:a=Qee,defaultAttributes:s={},selfClosing:o=!1,allowedAttributes:l}=t,c=r||e,u=h=>{if(!l)return h;const m={};return l.forEach(v=>{const y=typeof v=="string"?v:v.name,x=typeof v=="string"?void 0:v.skipIfDefault;if(y in h){const b=h[y];if(x!==void 0&&b===x)return;m[y]=b}}),m},f=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(h,m)=>{const v={...s,...h.attributes};if(o)return m.createNode(e,v);const y=n?n(h):h.content||"";return y?m.createNode(e,v,[m.createTextNode(y)]):m.createNode(e,v,[])},markdownTokenizer:{name:e,level:"inline",start(h){const m=o?new RegExp(`\\[${f}\\s*[^\\]]*\\]`):new RegExp(`\\[${f}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${f}\\]`),v=h.match(m),y=v==null?void 0:v.index;return y!==void 0?y:-1},tokenize(h,m,v){const y=o?new RegExp(`^\\[${f}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${f}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${f}\\]`),x=h.match(y);if(!x)return;let b="",S="";if(o){const[,k]=x;S=k}else{const[,k,N]=x;S=k,b=N||""}const w=i(S.trim());return{type:e,raw:x[0],content:b.trim(),attributes:w}}},renderMarkdown:h=>{let m="";n?m=n(h):h.content&&h.content.length>0&&(m=h.content.filter(b=>b.type==="text").map(b=>b.text).join(""));const v=u(h.attrs||{}),y=a(v),x=y?` ${y}`:"";return o?`[${c}${x}]`:`[${c}${x}]${m}[/${c}]`}}}function wk(t,e,r){var n,i,a,s;const o=t.split(`
`),l=[];let c="",u=0;const f=e.baseIndentSize||2;for(;u<o.length;){const h=o[u],m=h.match(e.itemPattern);if(!m){if(l.length>0)break;if(h.trim()===""){u+=1,c=`${c}${h}
`;continue}else return}const v=e.extractItemData(m),{indentLevel:y,mainContent:x}=v;c=`${c}${h}
`;const b=[x];for(u+=1;u<o.length;){const N=o[u];if(N.trim()===""){const T=o.slice(u+1).findIndex(_=>_.trim()!=="");if(T===-1)break;if((((i=(n=o[u+1+T].match(/^(\s*)/))==null?void 0:n[1])==null?void 0:i.length)||0)>y){b.push(N),c=`${c}${N}
`,u+=1;continue}else break}if((((s=(a=N.match(/^(\s*)/))==null?void 0:a[1])==null?void 0:s.length)||0)>y)b.push(N),c=`${c}${N}
`,u+=1;else break}let S;const w=b.slice(1);if(w.length>0){const N=w.map(j=>j.slice(y+f)).join(`
`);N.trim()&&(e.customNestedParser?S=e.customNestedParser(N):S=r.blockTokens(N))}const k=e.createToken(v,S);l.push(k)}if(l.length!==0)return{items:l,raw:c}}function G3(t,e,r,n){if(!t||!Array.isArray(t.content))return"";const i=typeof r=="function"?r(n):r,[a,...s]=t.content,o=e.renderChildren([a]),l=[`${i}${o}`];return s&&s.length>0&&s.forEach(c=>{const u=e.renderChildren([c]);if(u){const f=u.split(`
`).map(h=>h?e.indent(h):"").join(`
`);l.push(f)}}),l.join(`
`)}function Jee(t,e,r={}){const{state:n}=e,{doc:i,tr:a}=n,s=t;i.descendants((o,l)=>{const c=a.mapping.map(l),u=a.mapping.map(l)+o.nodeSize;let f=null;if(o.marks.forEach(m=>{if(m!==s)return!1;f=m}),!f)return;let h=!1;if(Object.keys(r).forEach(m=>{r[m]!==f.attrs[m]&&(h=!0)}),h){const m=t.type.create({...t.attrs,...r});a.removeMark(c,u,t.type),a.addMark(c,u,m)}}),a.docChanged&&e.view.dispatch(a)}var Ci=class jO extends V3{constructor(){super(...arguments),this.type="node"}static create(e={}){const r=typeof e=="function"?e():e;return new jO(r)}configure(e){return super.configure(e)}extend(e){const r=typeof e=="function"?e():e;return super.extend(r)}};function Kc(t){return new Dee({find:t.find,handler:({state:e,range:r,match:n,pasteEvent:i})=>{const a=Bt(t.getAttributes,void 0,n,i);if(a===!1||a===null)return null;const{tr:s}=e,o=n[n.length-1],l=n[0];let c=r.to;if(o){const u=l.search(/\S/),f=r.from+l.indexOf(o),h=f+o.length;if(z3(r.from,r.to,e.doc).filter(v=>v.mark.type.excluded.find(x=>x===t.type&&x!==v.mark.type)).filter(v=>v.to>f).length)return null;h<r.to&&s.delete(h,r.to),f>r.from&&s.delete(r.from+u,f),c=r.from+u+o.length,s.addMark(r.from+u,c,t.type.create(a||{})),s.removeStoredMark(t.type)}}})}const{getOwnPropertyNames:Zee,getOwnPropertySymbols:ete}=Object,{hasOwnProperty:tte}=Object.prototype;function fS(t,e){return function(n,i,a){return t(n,i,a)&&e(n,i,a)}}function nv(t){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return t(r,n,i);const{cache:a}=i,s=a.get(r),o=a.get(n);if(s&&o)return s===n&&o===r;a.set(r,n),a.set(n,r);const l=t(r,n,i);return a.delete(r),a.delete(n),l}}function rte(t){return t!=null?t[Symbol.toStringTag]:void 0}function x9(t){return Zee(t).concat(ete(t))}const nte=Object.hasOwn||((t,e)=>tte.call(t,e));function nu(t,e){return t===e||!t&&!e&&t!==t&&e!==e}const ite="__v",ate="__o",ste="_owner",{getOwnPropertyDescriptor:b9,keys:w9}=Object;function ote(t,e){return t.byteLength===e.byteLength&&Y0(new Uint8Array(t),new Uint8Array(e))}function lte(t,e,r){let n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(!r.equals(t[n],e[n],n,n,t,e,r))return!1;return!0}function cte(t,e){return t.byteLength===e.byteLength&&Y0(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function ute(t,e){return nu(t.getTime(),e.getTime())}function dte(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function fte(t,e){return t===e}function S9(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const i=new Array(n),a=t.entries();let s,o,l=0;for(;(s=a.next())&&!s.done;){const c=e.entries();let u=!1,f=0;for(;(o=c.next())&&!o.done;){if(i[f]){f++;continue}const h=s.value,m=o.value;if(r.equals(h[0],m[0],l,f,t,e,r)&&r.equals(h[1],m[1],h[0],m[0],t,e,r)){u=i[f]=!0;break}f++}if(!u)return!1;l++}return!0}const hte=nu;function pte(t,e,r){const n=w9(t);let i=n.length;if(w9(e).length!==i)return!1;for(;i-- >0;)if(!MO(t,e,r,n[i]))return!1;return!0}function oh(t,e,r){const n=x9(t);let i=n.length;if(x9(e).length!==i)return!1;let a,s,o;for(;i-- >0;)if(a=n[i],!MO(t,e,r,a)||(s=b9(t,a),o=b9(e,a),(s||o)&&(!s||!o||s.configurable!==o.configurable||s.enumerable!==o.enumerable||s.writable!==o.writable)))return!1;return!0}function mte(t,e){return nu(t.valueOf(),e.valueOf())}function gte(t,e){return t.source===e.source&&t.flags===e.flags}function k9(t,e,r){const n=t.size;if(n!==e.size)return!1;if(!n)return!0;const i=new Array(n),a=t.values();let s,o;for(;(s=a.next())&&!s.done;){const l=e.values();let c=!1,u=0;for(;(o=l.next())&&!o.done;){if(!i[u]&&r.equals(s.value,o.value,s.value,o.value,t,e,r)){c=i[u]=!0;break}u++}if(!c)return!1}return!0}function Y0(t,e){let r=t.byteLength;if(e.byteLength!==r||t.byteOffset!==e.byteOffset)return!1;for(;r-- >0;)if(t[r]!==e[r])return!1;return!0}function vte(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function MO(t,e,r,n){return(n===ste||n===ate||n===ite)&&(t.$$typeof||e.$$typeof)?!0:nte(e,n)&&r.equals(t[n],e[n],n,n,t,e,r)}const yte="[object ArrayBuffer]",xte="[object Arguments]",bte="[object Boolean]",wte="[object DataView]",Ste="[object Date]",kte="[object Error]",Cte="[object Map]",Nte="[object Number]",Ete="[object Object]",Tte="[object RegExp]",jte="[object Set]",Mte="[object String]",Pte={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},_te="[object URL]",Ate=Object.prototype.toString;function Rte({areArrayBuffersEqual:t,areArraysEqual:e,areDataViewsEqual:r,areDatesEqual:n,areErrorsEqual:i,areFunctionsEqual:a,areMapsEqual:s,areNumbersEqual:o,areObjectsEqual:l,arePrimitiveWrappersEqual:c,areRegExpsEqual:u,areSetsEqual:f,areTypedArraysEqual:h,areUrlsEqual:m,unknownTagComparators:v}){return function(x,b,S){if(x===b)return!0;if(x==null||b==null)return!1;const w=typeof x;if(w!==typeof b)return!1;if(w!=="object")return w==="number"?o(x,b,S):w==="function"?a(x,b,S):!1;const k=x.constructor;if(k!==b.constructor)return!1;if(k===Object)return l(x,b,S);if(Array.isArray(x))return e(x,b,S);if(k===Date)return n(x,b,S);if(k===RegExp)return u(x,b,S);if(k===Map)return s(x,b,S);if(k===Set)return f(x,b,S);const N=Ate.call(x);if(N===Ste)return n(x,b,S);if(N===Tte)return u(x,b,S);if(N===Cte)return s(x,b,S);if(N===jte)return f(x,b,S);if(N===Ete)return typeof x.then!="function"&&typeof b.then!="function"&&l(x,b,S);if(N===_te)return m(x,b,S);if(N===kte)return i(x,b,S);if(N===xte)return l(x,b,S);if(Pte[N])return h(x,b,S);if(N===yte)return t(x,b,S);if(N===wte)return r(x,b,S);if(N===bte||N===Nte||N===Mte)return c(x,b,S);if(v){let j=v[N];if(!j){const T=rte(x);T&&(j=v[T])}if(j)return j(x,b,S)}return!1}}function Dte({circular:t,createCustomConfig:e,strict:r}){let n={areArrayBuffersEqual:ote,areArraysEqual:r?oh:lte,areDataViewsEqual:cte,areDatesEqual:ute,areErrorsEqual:dte,areFunctionsEqual:fte,areMapsEqual:r?fS(S9,oh):S9,areNumbersEqual:hte,areObjectsEqual:r?oh:pte,arePrimitiveWrappersEqual:mte,areRegExpsEqual:gte,areSetsEqual:r?fS(k9,oh):k9,areTypedArraysEqual:r?fS(Y0,oh):Y0,areUrlsEqual:vte,unknownTagComparators:void 0};if(e&&(n=Object.assign({},n,e(n))),t){const i=nv(n.areArraysEqual),a=nv(n.areMapsEqual),s=nv(n.areObjectsEqual),o=nv(n.areSetsEqual);n=Object.assign({},n,{areArraysEqual:i,areMapsEqual:a,areObjectsEqual:s,areSetsEqual:o})}return n}function Ote(t){return function(e,r,n,i,a,s,o){return t(e,r,o)}}function Ite({circular:t,comparator:e,createState:r,equals:n,strict:i}){if(r)return function(o,l){const{cache:c=t?new WeakMap:void 0,meta:u}=r();return e(o,l,{cache:c,equals:n,meta:u,strict:i})};if(t)return function(o,l){return e(o,l,{cache:new WeakMap,equals:n,meta:void 0,strict:i})};const a={cache:void 0,equals:n,meta:void 0,strict:i};return function(o,l){return e(o,l,a)}}const Lte=Il();Il({strict:!0});Il({circular:!0});Il({circular:!0,strict:!0});Il({createInternalComparator:()=>nu});Il({strict:!0,createInternalComparator:()=>nu});Il({circular:!0,createInternalComparator:()=>nu});Il({circular:!0,createInternalComparator:()=>nu,strict:!0});function Il(t={}){const{circular:e=!1,createInternalComparator:r,createState:n,strict:i=!1}=t,a=Dte(t),s=Rte(a),o=r?r(s):Ote(s);return Ite({circular:e,comparator:s,createState:n,equals:o,strict:i})}var PO={exports:{}},_O={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mx=q,Bte=x3;function Fte(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zte=typeof Object.is=="function"?Object.is:Fte,Vte=Bte.useSyncExternalStore,$te=Mx.useRef,Ute=Mx.useEffect,Gte=Mx.useMemo,Hte=Mx.useDebugValue;_O.useSyncExternalStoreWithSelector=function(t,e,r,n,i){var a=$te(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=Gte(function(){function l(m){if(!c){if(c=!0,u=m,m=n(m),i!==void 0&&s.hasValue){var v=s.value;if(i(v,m))return f=v}return f=m}if(v=f,zte(u,m))return v;var y=n(m);return i!==void 0&&i(v,y)?(u=m,v):(u=m,f=y)}var c=!1,u,f,h=r===void 0?null:r;return[function(){return l(e())},h===null?void 0:function(){return l(h())}]},[e,r,n,i]);var o=Vte(t,a[0],a[1]);return Ute(function(){s.hasValue=!0,s.value=o},[o]),Hte(o),o};PO.exports=_O;var Wte=PO.exports,qte=(...t)=>e=>{t.forEach(r=>{typeof r=="function"?r(e):r&&(r.current=e)})},Kte=({contentComponent:t})=>{const e=x3.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return d.jsx(d.Fragment,{children:Object.values(e)})};function Yte(){const t=new Set;let e={};return{subscribe(r){return t.add(r),()=>{t.delete(r)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(r,n){e={...e,[r]:Pz.createPortal(n.reactElement,n.element,r)},t.forEach(i=>i())},removeRenderer(r){const n={...e};delete n[r],e=n,t.forEach(i=>i())}}}var Xte=class extends kt.Component{constructor(t){var e;super(t),this.editorContentRef=kt.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var t;const e=this.props.editor;if(e&&!e.isDestroyed&&((t=e.view.dom)!=null&&t.parentNode)){if(e.contentComponent)return;const r=this.editorContentRef.current;r.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:r}),e.contentComponent=Yte(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.parentNode))return;const r=document.createElement("div");r.append(...e.view.dom.parentNode.childNodes),e.setOptions({element:r})}catch{}}}render(){const{editor:t,innerRef:e,...r}=this.props;return d.jsxs(d.Fragment,{children:[d.jsx("div",{ref:qte(e,this.editorContentRef),...r}),(t==null?void 0:t.contentComponent)&&d.jsx(Kte,{contentComponent:t.contentComponent})]})}},Qte=q.forwardRef((t,e)=>{const r=kt.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return kt.createElement(Xte,{key:r,innerRef:e,...t})}),Jte=kt.memo(Qte),Zte=typeof window<"u"?q.useLayoutEffect:q.useEffect,ere=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(n=>n())},r=this.editor;return r.on("transaction",e),()=>{r.off("transaction",e)}}}};function tre(t){var e;const[r]=q.useState(()=>new ere(t.editor)),n=Wte.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:Lte);return Zte(()=>r.watch(t.editor),[t.editor,r]),q.useDebugValue(n),n}var rre=!1,Sk=typeof window>"u",nre=Sk||!!(typeof window<"u"&&window.next),ire=class AO{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(r=>r())}getInitialEditor(){if(this.options.current.immediatelyRender===void 0)return Sk||nre?null:this.createEditor();if(this.options.current.immediatelyRender&&Sk&&rre)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return this.options.current.immediatelyRender?this.createEditor():null}createEditor(){const e={...this.options.current,onBeforeCreate:(...n)=>{var i,a;return(a=(i=this.options.current).onBeforeCreate)==null?void 0:a.call(i,...n)},onBlur:(...n)=>{var i,a;return(a=(i=this.options.current).onBlur)==null?void 0:a.call(i,...n)},onCreate:(...n)=>{var i,a;return(a=(i=this.options.current).onCreate)==null?void 0:a.call(i,...n)},onDestroy:(...n)=>{var i,a;return(a=(i=this.options.current).onDestroy)==null?void 0:a.call(i,...n)},onFocus:(...n)=>{var i,a;return(a=(i=this.options.current).onFocus)==null?void 0:a.call(i,...n)},onSelectionUpdate:(...n)=>{var i,a;return(a=(i=this.options.current).onSelectionUpdate)==null?void 0:a.call(i,...n)},onTransaction:(...n)=>{var i,a;return(a=(i=this.options.current).onTransaction)==null?void 0:a.call(i,...n)},onUpdate:(...n)=>{var i,a;return(a=(i=this.options.current).onUpdate)==null?void 0:a.call(i,...n)},onContentError:(...n)=>{var i,a;return(a=(i=this.options.current).onContentError)==null?void 0:a.call(i,...n)},onDrop:(...n)=>{var i,a;return(a=(i=this.options.current).onDrop)==null?void 0:a.call(i,...n)},onPaste:(...n)=>{var i,a;return(a=(i=this.options.current).onPaste)==null?void 0:a.call(i,...n)},onDelete:(...n)=>{var i,a;return(a=(i=this.options.current).onDelete)==null?void 0:a.call(i,...n)}};return new Uee(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,r){return Object.keys(e).every(n=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)?!0:n==="extensions"&&e.extensions&&r.extensions?e.extensions.length!==r.extensions.length?!1:e.extensions.every((i,a)=>{var s;return i===((s=r.extensions)==null?void 0:s[a])}):e[n]===r[n])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?AO.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((n,i)=>n===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,r=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){r&&r.setOptions(this.options.current);return}r&&!r.isDestroyed&&(r.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function are(t={},e=[]){const r=q.useRef(t);r.current=t;const[n]=q.useState(()=>new ire(r)),i=x3.useSyncExternalStore(n.subscribe,n.getEditor,n.getServerSnapshot);return q.useDebugValue(i),q.useEffect(n.onRender(e)),tre({editor:i,selector:({transactionNumber:a})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&a===0?0:a+1}),i}var sre=q.createContext({editor:null});sre.Consumer;var ore=q.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),lre=()=>q.useContext(ore);kt.forwardRef((t,e)=>{const{onDragStart:r}=lre(),n=t.as||"div";return d.jsx(n,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:r,style:{whiteSpace:"normal",...t.style}})});function C9(t){return!!(typeof t=="function"&&t.prototype&&t.prototype.isReactComponent)}function N9(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.forward_ref)"||t.$$typeof.description==="react.forward_ref"))}function cre(t){return!!(typeof t=="object"&&t.$$typeof&&(t.$$typeof.toString()==="Symbol(react.memo)"||t.$$typeof.description==="react.memo"))}function ure(t){if(C9(t)||N9(t))return!0;if(cre(t)){const e=t.type;if(e)return C9(e)||N9(e)}return!1}function dre(){try{if(q.version)return parseInt(q.version.split(".")[0],10)>=19}catch{}return!1}var fre=class{constructor(t,{editor:e,props:r={},as:n="div",className:i=""}){this.ref=null,this.destroyed=!1,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=t,this.editor=e,this.props=r,this.element=document.createElement(n),this.element.classList.add("react-renderer"),i&&this.element.classList.add(...i.split(" ")),this.editor.isInitialized?ds.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.destroyed||this.render()})}render(){var t;if(this.destroyed)return;const e=this.component,r=this.props,n=this.editor,i=dre(),a=ure(e),s={...r};s.ref&&!(i||a)&&delete s.ref,!s.ref&&(i||a)&&(s.ref=o=>{this.ref=o}),this.reactElement=d.jsx(e,{...s}),(t=n==null?void 0:n.contentComponent)==null||t.setRenderer(this.id,this)}updateProps(t={}){this.destroyed||(this.props={...this.props,...t},this.render())}destroy(){var t;this.destroyed=!0;const e=this.editor;(t=e==null?void 0:e.contentComponent)==null||t.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(t){Object.keys(t).forEach(e=>{this.element.setAttribute(e,t[e])})}};kt.createContext({markViewContentRef:()=>{}});var X0=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:r,...n}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,n,r]},hre=/^\s*>\s$/,pre=Ci.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return X0("blockquote",{...cr(this.options.HTMLAttributes,t),children:X0("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const r=">",n=[];return t.content.forEach(i=>{const o=e.renderChildren([i]).split(`
`).map(l=>l.trim()===""?r:`${r} ${l}`);n.push(o.join(`
`))}),n.join(`
${r}
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Ud({find:hre,type:this.type})]}}),mre=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,gre=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,vre=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,yre=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,xre=ru.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return X0("strong",{...cr(this.options.HTMLAttributes,t),children:X0("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[$d({find:mre,type:this.type}),$d({find:vre,type:this.type})]},addPasteRules(){return[Kc({find:gre,type:this.type}),Kc({find:yre,type:this.type})]}}),bre=/(^|[^`])`([^`]+)`(?!`)$/,wre=/(^|[^`])`([^`]+)`(?!`)/g,Sre=ru.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",cr(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[$d({find:bre,type:this.type})]},addPasteRules(){return[Kc({find:wre,type:this.type})]}}),hS=4,kre=/^```([a-z]+)?[\s\n]$/,Cre=/^~~~([a-z]+)?[\s\n]$/,Nre=Ci.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:hS,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:r}=this.options;if(!r)return null;const a=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(s=>s.startsWith(r)).map(s=>s.replace(r,""))[0];return a||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",cr(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var r;return((r=t.raw)==null?void 0:r.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var r;let n="";const i=((r=t.attrs)==null?void 0:r.language)||"";return t.content?n=[`\`\`\`${i}`,e.renderChildren(t.content),"```"].join(`
`):n=`\`\`\`${i}

\`\`\``,n},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,r=e.pos===1;return!t||e.parent.type.name!==this.name?!1:r||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const r=(e=this.options.tabSize)!=null?e:hS,{state:n}=t,{selection:i}=n,{$from:a,empty:s}=i;if(a.parent.type!==this.type)return!1;const o=" ".repeat(r);return s?t.commands.insertContent(o):t.commands.command(({tr:l})=>{const{from:c,to:u}=i,m=n.doc.textBetween(c,u,`
`,`
`).split(`
`).map(v=>o+v).join(`
`);return l.replaceWith(c,u,n.schema.text(m)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const r=(e=this.options.tabSize)!=null?e:hS,{state:n}=t,{selection:i}=n,{$from:a,empty:s}=i;return a.parent.type!==this.type?!1:s?t.commands.command(({tr:o})=>{var l;const{pos:c}=a,u=a.start(),f=a.end(),m=n.doc.textBetween(u,f,`
`,`
`).split(`
`);let v=0,y=0;const x=c-u;for(let j=0;j<m.length;j+=1){if(y+m[j].length>=x){v=j;break}y+=m[j].length+1}const S=((l=m[v].match(/^ */))==null?void 0:l[0])||"",w=Math.min(S.length,r);if(w===0)return!0;let k=u;for(let j=0;j<v;j+=1)k+=m[j].length+1;return o.delete(k,k+w),c-k<=w&&o.setSelection(at.create(o.doc,k)),!0}):t.commands.command(({tr:o})=>{const{from:l,to:c}=i,h=n.doc.textBetween(l,c,`
`,`
`).split(`
`).map(m=>{var v;const y=((v=m.match(/^ */))==null?void 0:v[0])||"",x=Math.min(y.length,r);return m.slice(x)}).join(`
`);return o.replaceWith(l,c,n.schema.text(h)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:r}=e,{$from:n,empty:i}=r;if(!i||n.parent.type!==this.type)return!1;const a=n.parentOffset===n.parent.nodeSize-2,s=n.parent.textContent.endsWith(`

`);return!a||!s?!1:t.chain().command(({tr:o})=>(o.delete(n.pos-2,n.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:r,doc:n}=e,{$from:i,empty:a}=r;if(!a||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const o=i.after();return o===void 0?!1:n.nodeAt(o)?t.commands.command(({tr:c})=>(c.setSelection(ht.near(n.resolve(o))),!0)):t.commands.exitCode()}}},addInputRules(){return[bk({find:kre,type:this.type,getAttributes:t=>({language:t[1]})}),bk({find:Cre,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new ur({key:new Rr("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const r=e.clipboardData.getData("text/plain"),n=e.clipboardData.getData("vscode-editor-data"),i=n?JSON.parse(n):void 0,a=i==null?void 0:i.mode;if(!r||!a)return!1;const{tr:s,schema:o}=t.state,l=o.text(r.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:a},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(at.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),t.dispatch(s),!0}}})]}}),Ere=Ci.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),Tre=Ci.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",cr(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:()=>`  
`,parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:r,editor:n})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:a}=r;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=n.extensionManager,l=a||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&s){const f=l.filter(h=>o.includes(h.type.name));c.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),jre=Ci.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,cr(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var r;const n=(r=t.attrs)!=null&&r.level?parseInt(t.attrs.level,10):1,i="#".repeat(n);return t.content?`${i} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>bk({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),Mre=Ci.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",cr(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!Hee(e,e.schema.nodes[this.name]))return!1;const{selection:r}=e,{$to:n}=r,i=t();return uO(r)?i.insertContentAt(n.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({state:a,tr:s,dispatch:o})=>{if(o){const{$to:l}=s.selection,c=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?s.setSelection(at.create(s.doc,l.pos+1)):l.nodeAfter.isBlock?s.setSelection(Ye.create(s.doc,l.pos)):s.setSelection(at.create(s.doc,l.pos));else{const u=a.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,f=u==null?void 0:u.create();f&&(s.insert(c,f),s.setSelection(at.create(s.doc,c+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Gee({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),Pre=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,_re=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Are=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Rre=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Dre=ru.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",cr(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[$d({find:Pre,type:this.type}),$d({find:Are,type:this.type})]},addPasteRules(){return[Kc({find:_re,type:this.type}),Kc({find:Rre,type:this.type})]}});const Ore="aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",Ire="121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",kk="numeric",Ck="ascii",Nk="alpha",Gh="asciinumeric",Nh="alphanumeric",Ek="domain",RO="emoji",Lre="scheme",Bre="slashscheme",pS="whitespace";function Fre(t,e){return t in e||(e[t]=[]),e[t]}function Sc(t,e,r){e[kk]&&(e[Gh]=!0,e[Nh]=!0),e[Ck]&&(e[Gh]=!0,e[Nk]=!0),e[Gh]&&(e[Nh]=!0),e[Nk]&&(e[Nh]=!0),e[Nh]&&(e[Ek]=!0),e[RO]&&(e[Ek]=!0);for(const n in e){const i=Fre(n,r);i.indexOf(t)<0&&i.push(t)}}function zre(t,e){const r={};for(const n in e)e[n].indexOf(t)>=0&&(r[n]=!0);return r}function mi(t=null){this.j={},this.jr=[],this.jd=null,this.t=t}mi.groups={};mi.prototype={accepts(){return!!this.t},go(t){const e=this,r=e.j[t];if(r)return r;for(let n=0;n<e.jr.length;n++){const i=e.jr[n][0],a=e.jr[n][1];if(a&&i.test(t))return a}return e.jd},has(t,e=!1){return e?t in this.j:!!this.go(t)},ta(t,e,r,n){for(let i=0;i<t.length;i++)this.tt(t[i],e,r,n)},tr(t,e,r,n){n=n||mi.groups;let i;return e&&e.j?i=e:(i=new mi(e),r&&n&&Sc(e,r,n)),this.jr.push([t,i]),i},ts(t,e,r,n){let i=this;const a=t.length;if(!a)return i;for(let s=0;s<a-1;s++)i=i.tt(t[s]);return i.tt(t[a-1],e,r,n)},tt(t,e,r,n){n=n||mi.groups;const i=this;if(e&&e.j)return i.j[t]=e,e;const a=e;let s,o=i.go(t);if(o?(s=new mi,Object.assign(s.j,o.j),s.jr.push.apply(s.jr,o.jr),s.jd=o.jd,s.t=o.t):s=new mi,a){if(n)if(s.t&&typeof s.t=="string"){const l=Object.assign(zre(s.t,n),r);Sc(a,l,n)}else r&&Sc(a,r,n);s.t=a}return i.j[t]=s,s}};const ft=(t,e,r,n,i)=>t.ta(e,r,n,i),kr=(t,e,r,n,i)=>t.tr(e,r,n,i),E9=(t,e,r,n,i)=>t.ts(e,r,n,i),we=(t,e,r,n,i)=>t.tt(e,r,n,i),Is="WORD",Tk="UWORD",DO="ASCIINUMERICAL",OO="ALPHANUMERICAL",Lp="LOCALHOST",jk="TLD",Mk="UTLD",Vv="SCHEME",Wu="SLASH_SCHEME",H3="NUM",Pk="WS",W3="NL",Hh="OPENBRACE",Wh="CLOSEBRACE",Q0="OPENBRACKET",J0="CLOSEBRACKET",Z0="OPENPAREN",ey="CLOSEPAREN",ty="OPENANGLEBRACKET",ry="CLOSEANGLEBRACKET",ny="FULLWIDTHLEFTPAREN",iy="FULLWIDTHRIGHTPAREN",ay="LEFTCORNERBRACKET",sy="RIGHTCORNERBRACKET",oy="LEFTWHITECORNERBRACKET",ly="RIGHTWHITECORNERBRACKET",cy="FULLWIDTHLESSTHAN",uy="FULLWIDTHGREATERTHAN",dy="AMPERSAND",fy="APOSTROPHE",hy="ASTERISK",Lo="AT",py="BACKSLASH",my="BACKTICK",gy="CARET",$o="COLON",q3="COMMA",vy="DOLLAR",es="DOT",yy="EQUALS",K3="EXCLAMATION",Qi="HYPHEN",qh="PERCENT",xy="PIPE",by="PLUS",wy="POUND",Kh="QUERY",Y3="QUOTE",IO="FULLWIDTHMIDDLEDOT",X3="SEMI",ts="SLASH",Yh="TILDE",Sy="UNDERSCORE",LO="EMOJI",ky="SYM";var BO=Object.freeze({__proto__:null,ALPHANUMERICAL:OO,AMPERSAND:dy,APOSTROPHE:fy,ASCIINUMERICAL:DO,ASTERISK:hy,AT:Lo,BACKSLASH:py,BACKTICK:my,CARET:gy,CLOSEANGLEBRACKET:ry,CLOSEBRACE:Wh,CLOSEBRACKET:J0,CLOSEPAREN:ey,COLON:$o,COMMA:q3,DOLLAR:vy,DOT:es,EMOJI:LO,EQUALS:yy,EXCLAMATION:K3,FULLWIDTHGREATERTHAN:uy,FULLWIDTHLEFTPAREN:ny,FULLWIDTHLESSTHAN:cy,FULLWIDTHMIDDLEDOT:IO,FULLWIDTHRIGHTPAREN:iy,HYPHEN:Qi,LEFTCORNERBRACKET:ay,LEFTWHITECORNERBRACKET:oy,LOCALHOST:Lp,NL:W3,NUM:H3,OPENANGLEBRACKET:ty,OPENBRACE:Hh,OPENBRACKET:Q0,OPENPAREN:Z0,PERCENT:qh,PIPE:xy,PLUS:by,POUND:wy,QUERY:Kh,QUOTE:Y3,RIGHTCORNERBRACKET:sy,RIGHTWHITECORNERBRACKET:ly,SCHEME:Vv,SEMI:X3,SLASH:ts,SLASH_SCHEME:Wu,SYM:ky,TILDE:Yh,TLD:jk,UNDERSCORE:Sy,UTLD:Mk,UWORD:Tk,WORD:Is,WS:Pk});const Rs=/[a-z]/,lh=/\p{L}/u,mS=/\p{Emoji}/u,Ds=/\d/,gS=/\s/,T9="\r",vS=`
`,Vre="",$re="",yS="";let iv=null,av=null;function Ure(t=[]){const e={};mi.groups=e;const r=new mi;iv==null&&(iv=j9(Ore)),av==null&&(av=j9(Ire)),we(r,"'",fy),we(r,"{",Hh),we(r,"}",Wh),we(r,"[",Q0),we(r,"]",J0),we(r,"(",Z0),we(r,")",ey),we(r,"<",ty),we(r,">",ry),we(r,"",ny),we(r,"",iy),we(r,"",ay),we(r,"",sy),we(r,"",oy),we(r,"",ly),we(r,"",cy),we(r,"",uy),we(r,"&",dy),we(r,"*",hy),we(r,"@",Lo),we(r,"`",my),we(r,"^",gy),we(r,":",$o),we(r,",",q3),we(r,"$",vy),we(r,".",es),we(r,"=",yy),we(r,"!",K3),we(r,"-",Qi),we(r,"%",qh),we(r,"|",xy),we(r,"+",by),we(r,"#",wy),we(r,"?",Kh),we(r,'"',Y3),we(r,"/",ts),we(r,";",X3),we(r,"~",Yh),we(r,"_",Sy),we(r,"\\",py),we(r,"",IO);const n=kr(r,Ds,H3,{[kk]:!0});kr(n,Ds,n);const i=kr(n,Rs,DO,{[Gh]:!0}),a=kr(n,lh,OO,{[Nh]:!0}),s=kr(r,Rs,Is,{[Ck]:!0});kr(s,Ds,i),kr(s,Rs,s),kr(i,Ds,i),kr(i,Rs,i);const o=kr(r,lh,Tk,{[Nk]:!0});kr(o,Rs),kr(o,Ds,a),kr(o,lh,o),kr(a,Ds,a),kr(a,Rs),kr(a,lh,a);const l=we(r,vS,W3,{[pS]:!0}),c=we(r,T9,Pk,{[pS]:!0}),u=kr(r,gS,Pk,{[pS]:!0});we(r,yS,u),we(c,vS,l),we(c,yS,u),kr(c,gS,u),we(u,T9),we(u,vS),kr(u,gS,u),we(u,yS,u);const f=kr(r,mS,LO,{[RO]:!0});we(f,"#"),kr(f,mS,f),we(f,Vre,f);const h=we(f,$re);we(h,"#"),kr(h,mS,f);const m=[[Rs,s],[Ds,i]],v=[[Rs,null],[lh,o],[Ds,a]];for(let y=0;y<iv.length;y++)Mo(r,iv[y],jk,Is,m);for(let y=0;y<av.length;y++)Mo(r,av[y],Mk,Tk,v);Sc(jk,{tld:!0,ascii:!0},e),Sc(Mk,{utld:!0,alpha:!0},e),Mo(r,"file",Vv,Is,m),Mo(r,"mailto",Vv,Is,m),Mo(r,"http",Wu,Is,m),Mo(r,"https",Wu,Is,m),Mo(r,"ftp",Wu,Is,m),Mo(r,"ftps",Wu,Is,m),Sc(Vv,{scheme:!0,ascii:!0},e),Sc(Wu,{slashscheme:!0,ascii:!0},e),t=t.sort((y,x)=>y[0]>x[0]?1:-1);for(let y=0;y<t.length;y++){const x=t[y][0],S=t[y][1]?{[Lre]:!0}:{[Bre]:!0};x.indexOf("-")>=0?S[Ek]=!0:Rs.test(x)?Ds.test(x)?S[Gh]=!0:S[Ck]=!0:S[kk]=!0,E9(r,x,x,S)}return E9(r,"localhost",Lp,{ascii:!0}),r.jd=new mi(ky),{start:r,tokens:Object.assign({groups:e},BO)}}function FO(t,e){const r=Gre(e.replace(/[A-Z]/g,o=>o.toLowerCase())),n=r.length,i=[];let a=0,s=0;for(;s<n;){let o=t,l=null,c=0,u=null,f=-1,h=-1;for(;s<n&&(l=o.go(r[s]));)o=l,o.accepts()?(f=0,h=0,u=o):f>=0&&(f+=r[s].length,h++),c+=r[s].length,a+=r[s].length,s++;a-=f,s-=h,c-=f,i.push({t:u.t,v:e.slice(a-c,a),s:a-c,e:a})}return i}function Gre(t){const e=[],r=t.length;let n=0;for(;n<r;){let i=t.charCodeAt(n),a,s=i<55296||i>56319||n+1===r||(a=t.charCodeAt(n+1))<56320||a>57343?t[n]:t.slice(n,n+2);e.push(s),n+=s.length}return e}function Mo(t,e,r,n,i){let a;const s=e.length;for(let o=0;o<s-1;o++){const l=e[o];t.j[l]?a=t.j[l]:(a=new mi(n),a.jr=i.slice(),t.j[l]=a),t=a}return a=new mi(r),a.jr=i.slice(),t.j[e[s-1]]=a,a}function j9(t){const e=[],r=[];let n=0,i="0123456789";for(;n<t.length;){let a=0;for(;i.indexOf(t[n+a])>=0;)a++;if(a>0){e.push(r.join(""));for(let s=parseInt(t.substring(n,n+a),10);s>0;s--)r.pop();n+=a}else r.push(t[n]),n++}return e}const Bp={defaultProtocol:"http",events:null,format:M9,formatHref:M9,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function Q3(t,e=null){let r=Object.assign({},Bp);t&&(r=Object.assign(r,t instanceof Q3?t.o:t));const n=r.ignoreTags,i=[];for(let a=0;a<n.length;a++)i.push(n[a].toUpperCase());this.o=r,e&&(this.defaultRender=e),this.ignoreTags=i}Q3.prototype={o:Bp,ignoreTags:[],defaultRender(t){return t},check(t){return this.get("validate",t.toString(),t)},get(t,e,r){const n=e!=null;let i=this.o[t];return i&&(typeof i=="object"?(i=r.t in i?i[r.t]:Bp[t],typeof i=="function"&&n&&(i=i(e,r))):typeof i=="function"&&n&&(i=i(e,r.t,r)),i)},getObj(t,e,r){let n=this.o[t];return typeof n=="function"&&e!=null&&(n=n(e,r.t,r)),n},render(t){const e=t.render(this);return(this.get("render",null,t)||this.defaultRender)(e,t.t,t)}};function M9(t){return t}function zO(t,e){this.t="token",this.v=t,this.tk=e}zO.prototype={isLink:!1,toString(){return this.v},toHref(t){return this.toString()},toFormattedString(t){const e=this.toString(),r=t.get("truncate",e,this),n=t.get("format",e,this);return r&&n.length>r?n.substring(0,r)+"":n},toFormattedHref(t){return t.get("formatHref",this.toHref(t.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(t=Bp.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(t),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(t){return{type:this.t,value:this.toFormattedString(t),isLink:this.isLink,href:this.toFormattedHref(t),start:this.startIndex(),end:this.endIndex()}},validate(t){return t.get("validate",this.toString(),this)},render(t){const e=this,r=this.toHref(t.get("defaultProtocol")),n=t.get("formatHref",r,this),i=t.get("tagName",r,e),a=this.toFormattedString(t),s={},o=t.get("className",r,e),l=t.get("target",r,e),c=t.get("rel",r,e),u=t.getObj("attributes",r,e),f=t.getObj("events",r,e);return s.href=n,o&&(s.class=o),l&&(s.target=l),c&&(s.rel=c),u&&Object.assign(s,u),{tagName:i,attributes:s,content:a,eventListeners:f}}};function Px(t,e){class r extends zO{constructor(i,a){super(i,a),this.t=t}}for(const n in e)r.prototype[n]=e[n];return r.t=t,r}const P9=Px("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),_9=Px("text"),Hre=Px("nl"),sv=Px("url",{isLink:!0,toHref(t=Bp.defaultProtocol){return this.hasProtocol()?this.v:`${t}://${this.v}`},hasProtocol(){const t=this.tk;return t.length>=2&&t[0].t!==Lp&&t[1].t===$o}}),Ki=t=>new mi(t);function Wre({groups:t}){const e=t.domain.concat([dy,hy,Lo,py,my,gy,vy,yy,Qi,H3,qh,xy,by,wy,ts,ky,Yh,Sy]),r=[fy,$o,q3,es,K3,qh,Kh,Y3,X3,ty,ry,Hh,Wh,J0,Q0,Z0,ey,ny,iy,ay,sy,oy,ly,cy,uy],n=[dy,fy,hy,py,my,gy,vy,yy,Qi,Hh,Wh,qh,xy,by,wy,Kh,ts,ky,Yh,Sy],i=Ki(),a=we(i,Yh);ft(a,n,a),ft(a,t.domain,a);const s=Ki(),o=Ki(),l=Ki();ft(i,t.domain,s),ft(i,t.scheme,o),ft(i,t.slashscheme,l),ft(s,n,a),ft(s,t.domain,s);const c=we(s,Lo);we(a,Lo,c),we(o,Lo,c),we(l,Lo,c);const u=we(a,es);ft(u,n,a),ft(u,t.domain,a);const f=Ki();ft(c,t.domain,f),ft(f,t.domain,f);const h=we(f,es);ft(h,t.domain,f);const m=Ki(P9);ft(h,t.tld,m),ft(h,t.utld,m),we(c,Lp,m);const v=we(f,Qi);we(v,Qi,v),ft(v,t.domain,f),ft(m,t.domain,f),we(m,es,h),we(m,Qi,v);const y=we(m,$o);ft(y,t.numeric,P9);const x=we(s,Qi),b=we(s,es);we(x,Qi,x),ft(x,t.domain,s),ft(b,n,a),ft(b,t.domain,s);const S=Ki(sv);ft(b,t.tld,S),ft(b,t.utld,S),ft(S,t.domain,s),ft(S,n,a),we(S,es,b),we(S,Qi,x),we(S,Lo,c);const w=we(S,$o),k=Ki(sv);ft(w,t.numeric,k);const N=Ki(sv),j=Ki();ft(N,e,N),ft(N,r,j),ft(j,e,N),ft(j,r,j),we(S,ts,N),we(k,ts,N);const T=we(o,$o),M=we(l,$o),A=we(M,ts),_=we(A,ts);ft(o,t.domain,s),we(o,es,b),we(o,Qi,x),ft(l,t.domain,s),we(l,es,b),we(l,Qi,x),ft(T,t.domain,N),we(T,ts,N),we(T,Kh,N),ft(_,t.domain,N),ft(_,e,N),we(_,ts,N);const D=[[Hh,Wh],[Q0,J0],[Z0,ey],[ty,ry],[ny,iy],[ay,sy],[oy,ly],[cy,uy]];for(let R=0;R<D.length;R++){const[I,$]=D[R],B=we(N,I);we(j,I,B),we(B,$,N);const z=Ki(sv);ft(B,e,z);const U=Ki();ft(B,r),ft(z,e,z),ft(z,r,U),ft(U,e,z),ft(U,r,U),we(z,$,N),we(U,$,N)}return we(i,Lp,S),we(i,W3,Hre),{start:i,tokens:BO}}function qre(t,e,r){let n=r.length,i=0,a=[],s=[];for(;i<n;){let o=t,l=null,c=null,u=0,f=null,h=-1;for(;i<n&&!(l=o.go(r[i].t));)s.push(r[i++]);for(;i<n&&(c=l||o.go(r[i].t));)l=null,o=c,o.accepts()?(h=0,f=o):h>=0&&h++,i++,u++;if(h<0)i-=u,i<n&&(s.push(r[i]),i++);else{s.length>0&&(a.push(xS(_9,e,s)),s=[]),i-=h,u-=h;const m=f.t,v=r.slice(i-u,i);a.push(xS(m,e,v))}}return s.length>0&&a.push(xS(_9,e,s)),a}function xS(t,e,r){const n=r[0].s,i=r[r.length-1].e,a=e.slice(n,i);return new t(a,r)}const Kre=typeof console<"u"&&console&&console.warn||(()=>{}),Yre="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",tr={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Xre(){return mi.groups={},tr.scanner=null,tr.parser=null,tr.tokenQueue=[],tr.pluginQueue=[],tr.customSchemes=[],tr.initialized=!1,tr}function A9(t,e=!1){if(tr.initialized&&Kre(`linkifyjs: already initialized - will not register custom scheme "${t}" ${Yre}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(t))throw new Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);tr.customSchemes.push([t,e])}function Qre(){tr.scanner=Ure(tr.customSchemes);for(let t=0;t<tr.tokenQueue.length;t++)tr.tokenQueue[t][1]({scanner:tr.scanner});tr.parser=Wre(tr.scanner.tokens);for(let t=0;t<tr.pluginQueue.length;t++)tr.pluginQueue[t][1]({scanner:tr.scanner,parser:tr.parser});return tr.initialized=!0,tr}function J3(t){return tr.initialized||Qre(),qre(tr.parser.start,t,FO(tr.scanner.start,t))}J3.scan=FO;function VO(t,e=null,r=null){if(e&&typeof e=="object"){if(r)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);r=e,e=null}const n=new Q3(r),i=J3(t),a=[];for(let s=0;s<i.length;s++){const o=i[s];o.isLink&&(!e||o.t===e)&&n.check(o)&&a.push(o.toFormattedObject(n))}return a}var Z3="[\0- -\u2029]",Jre=new RegExp(Z3),Zre=new RegExp(`${Z3}$`),ene=new RegExp(Z3,"g");function tne(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function rne(t){return new ur({key:new Rr("autolink"),appendTransaction:(e,r,n)=>{const i=e.some(c=>c.docChanged)&&!r.doc.eq(n.doc),a=e.some(c=>c.getMeta("preventAutolink"));if(!i||a)return;const{tr:s}=n,o=rO(r.doc,[...e]);if(cO(o).forEach(({newRange:c})=>{const u=HZ(n.doc,c,m=>m.isTextblock);let f,h;if(u.length>1)f=u[0],h=n.doc.textBetween(f.pos,f.pos+f.node.nodeSize,void 0," ");else if(u.length){const m=n.doc.textBetween(c.from,c.to," "," ");if(!Zre.test(m))return;f=u[0],h=n.doc.textBetween(f.pos,c.to,void 0," ")}if(f&&h){const m=h.split(Jre).filter(Boolean);if(m.length<=0)return!1;const v=m[m.length-1],y=f.pos+h.lastIndexOf(v);if(!v)return!1;const x=J3(v).map(b=>b.toObject(t.defaultProtocol));if(!tne(x))return!1;x.filter(b=>b.isLink).map(b=>({...b,from:y+b.start+1,to:y+b.end+1})).filter(b=>n.schema.marks.code?!n.doc.rangeHasMark(b.from,b.to,n.schema.marks.code):!0).filter(b=>t.validate(b.value)).filter(b=>t.shouldAutoLink(b.value)).forEach(b=>{z3(b.from,b.to,n.doc).some(S=>S.mark.type===t.type)||s.addMark(b.from,b.to,t.type.create({href:b.href}))})}}),!!s.steps.length)return s}})}function nne(t){return new ur({key:new Rr("handleClickLink"),props:{handleClick:(e,r,n)=>{var i,a;if(n.button!==0||!e.editable)return!1;let s=null;if(n.target instanceof HTMLAnchorElement)s=n.target;else{const l=n.target;if(!l)return!1;const c=t.editor.view.dom;s=l.closest("a"),s&&!c.contains(s)&&(s=null)}if(!s)return!1;let o=!1;if(t.enableClickSelection&&(o=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){const l=lO(e.state,t.type.name),c=(i=s.href)!=null?i:l.href,u=(a=s.target)!=null?a:l.target;c&&(window.open(c,u),o=!0)}return o}}})}function ine(t){return new ur({key:new Rr("handlePasteLink"),props:{handlePaste:(e,r,n)=>{const{shouldAutoLink:i}=t,{state:a}=e,{selection:s}=a,{empty:o}=s;if(o)return!1;let l="";n.content.forEach(u=>{l+=u.textContent});const c=VO(l,{defaultProtocol:t.defaultProtocol}).find(u=>u.isLink&&u.value===l);return!l||!c||i!==void 0&&!i(c.value)?!1:t.editor.commands.setMark(t.type,{href:c.href})}}})}function ac(t,e){const r=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(n=>{const i=typeof n=="string"?n:n.scheme;i&&r.push(i)}),!t||t.replace(ene,"").match(new RegExp(`^(?:(?:${r.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var ane=ru.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){A9(t);return}A9(t.scheme,t.optionalSlashes)})},onDestroy(){Xre()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!ac(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>{const e=/^[a-z][a-z0-9+.-]*:\/\//i.test(t),r=/^[a-z][a-z0-9+.-]*:/i.test(t);if(e||r&&!t.includes("@"))return!0;const i=(t.includes("@")?t.split("@").pop():t).split(/[/?#:]/)[0];return!(/^\d{1,3}(\.\d{1,3}){3}$/.test(i)||!/\./.test(i))}}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:r=>!!ac(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!ac(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",cr(this.options.HTMLAttributes,t),0]:["a",cr(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var r;const n=((r=t.attrs)==null?void 0:r.href)||"";return`[${e.renderChildren(t)}](${n})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:r}=t;return this.options.isAllowedUri(r,{defaultValidate:n=>!!ac(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:r}=t||{};return r&&!this.options.isAllowedUri(r,{defaultValidate:n=>!!ac(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[Kc({find:t=>{const e=[];if(t){const{protocols:r,defaultProtocol:n}=this.options,i=VO(t).filter(a=>a.isLink&&this.options.isAllowedUri(a.value,{defaultValidate:s=>!!ac(s,r),protocols:r,defaultProtocol:n}));i.length&&i.forEach(a=>{this.options.shouldAutoLink(a.value)&&e.push({text:a.value,data:{href:a.href},index:a.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:r}=this.options;return this.options.autolink&&t.push(rne({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:n=>this.options.isAllowedUri(n,{defaultValidate:i=>!!ac(i,e),protocols:e,defaultProtocol:r}),shouldAutoLink:this.options.shouldAutoLink})),t.push(nne({type:this.type,editor:this.editor,openOnClick:this.options.openOnClick==="whenNotEditable"?!0:this.options.openOnClick,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(ine({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),sne=Object.defineProperty,one=(t,e)=>{for(var r in e)sne(t,r,{get:e[r],enumerable:!0})},lne="listItem",R9="textStyle",D9=/^\s*([-+*])\s$/,$O=Ci.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",cr(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(lne,this.editor.getAttributes(R9)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Ud({find:D9,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ud({find:D9,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(R9),editor:this.editor})),[t]}}),UO=Ci.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",cr(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let r=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(i=>i.type==="paragraph"))r=e.parseChildren(t.tokens);else{const i=t.tokens[0];if(i&&i.type==="text"&&i.tokens&&i.tokens.length>0){if(r=[{type:"paragraph",content:e.parseInline(i.tokens)}],t.tokens.length>1){const s=t.tokens.slice(1),o=e.parseChildren(s);r.push(...o)}}else r=e.parseChildren(t.tokens)}return r.length===0&&(r=[{type:"paragraph",content:[]}]),{type:"listItem",content:r}},renderMarkdown:(t,e,r)=>G3(t,e,n=>n.parentType==="bulletList"?"- ":n.parentType==="orderedList"?`${n.index+1}. `:"- ",r),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),cne={};one(cne,{findListItemPos:()=>hm,getNextListDepth:()=>eN,handleBackspace:()=>_k,handleDelete:()=>Ak,hasListBefore:()=>GO,hasListItemAfter:()=>une,hasListItemBefore:()=>HO,listItemHasSubList:()=>WO,nextListIsDeeper:()=>qO,nextListIsHigher:()=>KO});var hm=(t,e)=>{const{$from:r}=e.selection,n=Ur(t,e.schema);let i=null,a=r.depth,s=r.pos,o=null;for(;a>0&&o===null;)i=r.node(a),i.type===n?o=a:(a-=1,s-=1);return o===null?null:{$pos:e.doc.resolve(s),depth:o}},eN=(t,e)=>{const r=hm(t,e);if(!r)return!1;const[,n]=tee(e,t,r.$pos.pos+4);return n},GO=(t,e,r)=>{const{$anchor:n}=t.selection,i=Math.max(0,n.pos-2),a=t.doc.resolve(i).node();return!(!a||!r.includes(a.type.name))},HO=(t,e)=>{var r;const{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-2);return!(i.index()===0||((r=i.nodeBefore)==null?void 0:r.type.name)!==t)},WO=(t,e,r)=>{if(!r)return!1;const n=Ur(t,e.schema);let i=!1;return r.descendants(a=>{a.type===n&&(i=!0)}),i},_k=(t,e,r)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!Sl(t.state,e)&&GO(t.state,e,r)){const{$anchor:o}=t.state.selection,l=t.state.doc.resolve(o.before()-1),c=[];l.node().descendants((h,m)=>{h.type.name===e&&c.push({node:h,pos:m})});const u=c.at(-1);if(!u)return!1;const f=t.state.doc.resolve(l.start()+u.pos+1);return t.chain().cut({from:o.start()-1,to:o.end()+1},f.end()).joinForward().run()}if(!Sl(t.state,e)||!aee(t.state))return!1;const n=hm(e,t.state);if(!n)return!1;const a=t.state.doc.resolve(n.$pos.pos-2).node(n.depth),s=WO(e,t.state,a);return HO(e,t.state)&&!s?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},qO=(t,e)=>{const r=eN(t,e),n=hm(t,e);return!n||!r?!1:r>n.depth},KO=(t,e)=>{const r=eN(t,e),n=hm(t,e);return!n||!r?!1:r<n.depth},Ak=(t,e)=>{if(!Sl(t.state,e)||!iee(t.state,e))return!1;const{selection:r}=t.state,{$from:n,$to:i}=r;return!r.empty&&n.sameParent(i)?!1:qO(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():KO(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},une=(t,e)=>{var r;const{$anchor:n}=e.selection,i=e.doc.resolve(n.pos-n.parentOffset-2);return!(i.index()===i.parent.childCount-1||((r=i.nodeAfter)==null?void 0:r.type.name)!==t)},YO=Dr.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r})=>{t.state.schema.nodes[r]!==void 0&&Ak(t,r)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r})=>{t.state.schema.nodes[r]!==void 0&&Ak(t,r)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{t.state.schema.nodes[r]!==void 0&&_k(t,r,n)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:r,wrapperNames:n})=>{t.state.schema.nodes[r]!==void 0&&_k(t,r,n)&&(e=!0)}),e}}}}),O9=/^(\s*)(\d+)\.\s+(.*)$/,dne=/^\s/;function fne(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r],a=i.match(O9);if(!a)break;const[,s,o,l]=a,c=s.length;let u=l,f=r+1;const h=[i];for(;f<t.length;){const m=t[f];if(m.match(O9))break;if(m.trim()==="")h.push(m),u+=`
`,f+=1;else if(m.match(dne))h.push(m),u+=`
${m.slice(c+2)}`,f+=1;else break}e.push({indent:c,number:parseInt(o,10),content:u.trim(),raw:h.join(`
`)}),n=f,r=f}return[e,n]}function XO(t,e,r){var n;const i=[];let a=0;for(;a<t.length;){const s=t[a];if(s.indent===e){const o=s.content.split(`
`),l=((n=o[0])==null?void 0:n.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:r.inlineTokens(l)});const u=o.slice(1).join(`
`).trim();if(u){const m=r.blockTokens(u);c.push(...m)}let f=a+1;const h=[];for(;f<t.length&&t[f].indent>e;)h.push(t[f]),f+=1;if(h.length>0){const m=Math.min(...h.map(y=>y.indent)),v=XO(h,m,r);c.push({type:"list",ordered:!0,start:h[0].number,items:v,raw:h.map(y=>y.raw).join(`
`)})}i.push({type:"list_item",raw:s.raw,tokens:c}),a=f}else a+=1}return i}function hne(t,e){return t.map(r=>{if(r.type!=="list_item")return e.parseChildren([r])[0];const n=[];return r.tokens&&r.tokens.length>0&&r.tokens.forEach(i=>{if(i.type==="paragraph"||i.type==="list"||i.type==="blockquote"||i.type==="code")n.push(...e.parseChildren([i]));else if(i.type==="text"&&i.tokens){const a=e.parseChildren([i]);n.push({type:"paragraph",content:a})}else{const a=e.parseChildren([i]);a.length>0&&n.push(...a)}}),{type:"listItem",content:n}})}var pne="listItem",I9="textStyle",L9=/^(\d+)\.\s$/,QO=Ci.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...r}=t;return e===1?["ol",cr(this.options.HTMLAttributes,r),0]:["ol",cr(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const r=t.start||1,n=t.items?hne(t.items,e):[];return r!==1?{type:"orderedList",attrs:{start:r},content:n}:{type:"orderedList",content:n}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),r=e==null?void 0:e.index;return r!==void 0?r:-1},tokenize:(t,e,r)=>{var n;const i=t.split(`
`),[a,s]=fne(i);if(a.length===0)return;const o=XO(a,0,r);return o.length===0?void 0:{type:"list",ordered:!0,start:((n=a[0])==null?void 0:n.number)||1,items:o,raw:i.slice(0,s).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(pne,this.editor.getAttributes(I9)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Ud({find:L9,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Ud({find:L9,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(I9)}),joinPredicate:(e,r)=>r.childCount+r.attrs.start===+e[1],editor:this.editor})),[t]}}),mne=/^\s*(\[([( |x])?\])\s$/,gne=Ci.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",cr(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const r=[];if(t.tokens&&t.tokens.length>0?r.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?r.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):r.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const n=e.parseChildren(t.nestedTokens);r.push(...n)}return e.createNode("taskItem",{checked:t.checked||!1},r)},renderMarkdown:(t,e)=>{var r;const i=`- [${(r=t.attrs)!=null&&r.checked?"x":" "}] `;return G3(t,e,i)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:r,editor:n})=>{const i=document.createElement("li"),a=document.createElement("label"),s=document.createElement("span"),o=document.createElement("input"),l=document.createElement("div"),c=f=>{var h,m;o.ariaLabel=((m=(h=this.options.a11y)==null?void 0:h.checkboxLabel)==null?void 0:m.call(h,f,o.checked))||`Task item checkbox for ${f.textContent||"empty task item"}`};c(t),a.contentEditable="false",o.type="checkbox",o.addEventListener("mousedown",f=>f.preventDefault()),o.addEventListener("change",f=>{if(!n.isEditable&&!this.options.onReadOnlyChecked){o.checked=!o.checked;return}const{checked:h}=f.target;n.isEditable&&typeof r=="function"&&n.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:m})=>{const v=r();if(typeof v!="number")return!1;const y=m.doc.nodeAt(v);return m.setNodeMarkup(v,void 0,{...y==null?void 0:y.attrs,checked:h}),!0}).run(),!n.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,h)||(o.checked=!o.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([f,h])=>{i.setAttribute(f,h)}),i.dataset.checked=t.attrs.checked,o.checked=t.attrs.checked,a.append(o,s),i.append(a,l),Object.entries(e).forEach(([f,h])=>{i.setAttribute(f,h)});let u=new Set(Object.keys(e));return{dom:i,contentDOM:l,update:f=>{if(f.type!==this.type)return!1;i.dataset.checked=f.attrs.checked,o.checked=f.attrs.checked,c(f);const h=n.extensionManager.attributes,m=Ip(f,h),v=new Set(Object.keys(m)),y=this.options.HTMLAttributes;return u.forEach(x=>{v.has(x)||(x in y?i.setAttribute(x,y[x]):i.removeAttribute(x))}),Object.entries(m).forEach(([x,b])=>{b==null?x in y?i.setAttribute(x,y[x]):i.removeAttribute(x):i.setAttribute(x,b)}),u=v,!0}}}},addInputRules(){return[Ud({find:mne,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),vne=Ci.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",cr(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const r=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return r!==void 0?r:-1},tokenize(t,e,r){const n=a=>{const s=wk(a,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,l)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:r.inlineTokens(o.mainContent),nestedTokens:l}),customNestedParser:n},r);return s?[{type:"taskList",raw:s.raw,items:s.items}]:r.blockTokens(a)},i=wk(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,s)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:r.inlineTokens(a.mainContent),nestedTokens:s}),customNestedParser:n},r);if(i)return{type:"taskList",raw:i.raw,items:i.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});Dr.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push($O.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(UO.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(YO.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(QO.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(gne.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(vne.configure(this.options.taskList)),t}});var yne=Ci.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",cr(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const r=t.tokens||[];return r.length===1&&r[0].type==="image"?e.parseChildren([r[0]]):e.createNode("paragraph",void 0,e.parseInline(r))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),xne=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,bne=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,wne=ru.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",cr(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[$d({find:xne,type:this.type})]},addPasteRules(){return[Kc({find:bne,type:this.type})]}}),Sne=Ci.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),kne=ru.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",cr(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,r){const i=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!i)return;const a=i[2].trim();return{type:"underline",raw:i[0],text:a,tokens:r.inlineTokens(a)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});function Cne(t={}){return new ur({view(e){return new Nne(e,t)}})}class Nne{constructor(e,r){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=r.width)!==null&&n!==void 0?n:1,this.color=r.color===!1?void 0:r.color||"black",this.class=r.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let a=s=>{this[i](s)};return e.dom.addEventListener(i,a),{name:i,handler:a}})}destroy(){this.handlers.forEach(({name:e,handler:r})=>this.editorView.dom.removeEventListener(e,r))}update(e,r){this.cursorPos!=null&&r.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),r=!e.parent.inlineContent,n,i=this.editorView.dom,a=i.getBoundingClientRect(),s=a.width/i.offsetWidth,o=a.height/i.offsetHeight;if(r){let f=e.nodeBefore,h=e.nodeAfter;if(f||h){let m=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(m){let v=m.getBoundingClientRect(),y=f?v.bottom:v.top;f&&h&&(y=(y+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let x=this.width/2*o;n={left:v.left,right:v.right,top:y-x,bottom:y+x}}}}if(!n){let f=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*s;n={left:f.left-h,right:f.left+h,top:f.top,bottom:f.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let f=l.getBoundingClientRect(),h=f.width/l.offsetWidth,m=f.height/l.offsetHeight;c=f.left-l.scrollLeft*h,u=f.top-l.scrollTop*m}this.element.style.left=(n.left-c)/s+"px",this.element.style.top=(n.top-u)/o+"px",this.element.style.width=(n.right-n.left)/s+"px",this.element.style.height=(n.bottom-n.top)/o+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let r=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=r&&r.inside>=0&&this.editorView.state.doc.nodeAt(r.inside),i=n&&n.type.spec.disableDropCursor,a=typeof i=="function"?i(this.editorView,r,e):i;if(r&&!a){let s=r.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let o=Z7(this.editorView.state.doc,s,this.editorView.dragging.slice);o!=null&&(s=o)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}class Nr extends ht{constructor(e){super(e,e)}map(e,r){let n=e.resolve(r.map(this.head));return Nr.valid(n)?new Nr(n):ht.near(n)}content(){return Ae.empty}eq(e){return e instanceof Nr&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,r){if(typeof r.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Nr(e.resolve(r.pos))}getBookmark(){return new tN(this.anchor)}static valid(e){let r=e.parent;if(r.isTextblock||!Ene(e)||!Tne(e))return!1;let n=r.type.spec.allowGapCursor;if(n!=null)return n;let i=r.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,r,n=!1){e:for(;;){if(!n&&Nr.valid(e))return e;let i=e.pos,a=null;for(let s=e.depth;;s--){let o=e.node(s);if(r>0?e.indexAfter(s)<o.childCount:e.index(s)>0){a=o.child(r>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=r;let l=e.doc.resolve(i);if(Nr.valid(l))return l}for(;;){let s=r>0?a.firstChild:a.lastChild;if(!s){if(a.isAtom&&!a.isText&&!Ye.isSelectable(a)){e=e.doc.resolve(i+a.nodeSize*r),n=!1;continue e}break}a=s,i+=r;let o=e.doc.resolve(i);if(Nr.valid(o))return o}return null}}}Nr.prototype.visible=!1;Nr.findFrom=Nr.findGapCursorFrom;ht.jsonID("gapcursor",Nr);class tN{constructor(e){this.pos=e}map(e){return new tN(e.map(this.pos))}resolve(e){let r=e.resolve(this.pos);return Nr.valid(r)?new Nr(r):ht.near(r)}}function JO(t){return t.isAtom||t.spec.isolating||t.spec.createGapCursor}function Ene(t){for(let e=t.depth;e>=0;e--){let r=t.index(e),n=t.node(e);if(r==0){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||JO(i.type))return!0;if(i.inlineContent)return!1}}return!0}function Tne(t){for(let e=t.depth;e>=0;e--){let r=t.indexAfter(e),n=t.node(e);if(r==n.childCount){if(n.type.spec.isolating)return!0;continue}for(let i=n.child(r);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||JO(i.type))return!0;if(i.inlineContent)return!1}}return!0}function jne(){return new ur({props:{decorations:Ane,createSelectionBetween(t,e,r){return e.pos==r.pos&&Nr.valid(r)?new Nr(r):null},handleClick:Pne,handleKeyDown:Mne,handleDOMEvents:{beforeinput:_ne}}})}const Mne=KD({ArrowLeft:ov("horiz",-1),ArrowRight:ov("horiz",1),ArrowUp:ov("vert",-1),ArrowDown:ov("vert",1)});function ov(t,e){const r=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(n,i,a){let s=n.selection,o=e>0?s.$to:s.$from,l=s.empty;if(s instanceof at){if(!a.endOfTextblock(r)||o.depth==0)return!1;l=!1,o=n.doc.resolve(e>0?o.after():o.before())}let c=Nr.findGapCursorFrom(o,e,l);return c?(i&&i(n.tr.setSelection(new Nr(c))),!0):!1}}function Pne(t,e,r){if(!t||!t.editable)return!1;let n=t.state.doc.resolve(e);if(!Nr.valid(n))return!1;let i=t.posAtCoords({left:r.clientX,top:r.clientY});return i&&i.inside>-1&&Ye.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Nr(n))),!0)}function _ne(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Nr))return!1;let{$from:r}=t.state.selection,n=r.parent.contentMatchAt(r.index()).findWrapping(t.state.schema.nodes.text);if(!n)return!1;let i=be.empty;for(let s=n.length-1;s>=0;s--)i=be.from(n[s].createAndFill(null,i));let a=t.state.tr.replace(r.pos,r.pos,new Ae(i,0,0));return a.setSelection(at.near(a.doc.resolve(r.pos+1))),t.dispatch(a),!1}function Ane(t){if(!(t.selection instanceof Nr))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",sr.create(t.doc,[$n.widget(t.selection.head,e,{key:"gapcursor"})])}var Cy=200,gn=function(){};gn.prototype.append=function(e){return e.length?(e=gn.from(e),!this.length&&e||e.length<Cy&&this.leafAppend(e)||this.length<Cy&&e.leafPrepend(this)||this.appendInner(e)):this};gn.prototype.prepend=function(e){return e.length?gn.from(e).append(this):this};gn.prototype.appendInner=function(e){return new Rne(this,e)};gn.prototype.slice=function(e,r){return e===void 0&&(e=0),r===void 0&&(r=this.length),e>=r?gn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,r))};gn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};gn.prototype.forEach=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length),r<=n?this.forEachInner(e,r,n,0):this.forEachInvertedInner(e,r,n,0)};gn.prototype.map=function(e,r,n){r===void 0&&(r=0),n===void 0&&(n=this.length);var i=[];return this.forEach(function(a,s){return i.push(e(a,s))},r,n),i};gn.from=function(e){return e instanceof gn?e:e&&e.length?new ZO(e):gn.empty};var ZO=function(t){function e(n){t.call(this),this.values=n}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,a){return i==0&&a==this.length?this:new e(this.values.slice(i,a))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,a,s,o){for(var l=a;l<s;l++)if(i(this.values[l],o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,a,s,o){for(var l=a-1;l>=s;l--)if(i(this.values[l],o+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Cy)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Cy)return new e(i.flatten().concat(this.values))},r.length.get=function(){return this.values.length},r.depth.get=function(){return 0},Object.defineProperties(e.prototype,r),e}(gn);gn.empty=new ZO([]);var Rne=function(t){function e(r,n){t.call(this),this.left=r,this.right=n,this.length=r.length+n.length,this.depth=Math.max(r.depth,n.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(n){return n<this.left.length?this.left.get(n):this.right.get(n-this.left.length)},e.prototype.forEachInner=function(n,i,a,s){var o=this.left.length;if(i<o&&this.left.forEachInner(n,i,Math.min(a,o),s)===!1||a>o&&this.right.forEachInner(n,Math.max(i-o,0),Math.min(this.length,a)-o,s+o)===!1)return!1},e.prototype.forEachInvertedInner=function(n,i,a,s){var o=this.left.length;if(i>o&&this.right.forEachInvertedInner(n,i-o,Math.max(a,o)-o,s+o)===!1||a<o&&this.left.forEachInvertedInner(n,Math.min(i,o),a,s)===!1)return!1},e.prototype.sliceInner=function(n,i){if(n==0&&i==this.length)return this;var a=this.left.length;return i<=a?this.left.slice(n,i):n>=a?this.right.slice(n-a,i-a):this.left.slice(n,a).append(this.right.slice(0,i-a))},e.prototype.leafAppend=function(n){var i=this.right.leafAppend(n);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(n){var i=this.left.leafPrepend(n);if(i)return new e(i,this.right)},e.prototype.appendInner=function(n){return this.left.depth>=Math.max(this.right.depth,n.depth)+1?new e(this.left,new e(this.right,n)):new e(this,n)},e}(gn);const Dne=500;class Ma{constructor(e,r){this.items=e,this.eventCount=r}popEvent(e,r){if(this.eventCount==0)return null;let n=this.items.length;for(;;n--)if(this.items.get(n-1).selection){--n;break}let i,a;r&&(i=this.remapping(n,this.items.length),a=i.maps.length);let s=e.tr,o,l,c=[],u=[];return this.items.forEach((f,h)=>{if(!f.step){i||(i=this.remapping(n,h+1),a=i.maps.length),a--,u.push(f);return}if(i){u.push(new rs(f.map));let m=f.step.map(i.slice(a)),v;m&&s.maybeStep(m).doc&&(v=s.mapping.maps[s.mapping.maps.length-1],c.push(new rs(v,void 0,void 0,c.length+u.length))),a--,v&&i.appendMap(v,a)}else s.maybeStep(f.step);if(f.selection)return o=i?f.selection.map(i.slice(a)):f.selection,l=new Ma(this.items.slice(0,n).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:o}}addTransform(e,r,n,i){let a=[],s=this.eventCount,o=this.items,l=!i&&o.length?o.get(o.length-1):null;for(let u=0;u<e.steps.length;u++){let f=e.steps[u].invert(e.docs[u]),h=new rs(e.mapping.maps[u],f,r),m;(m=l&&l.merge(h))&&(h=m,u?a.pop():o=o.slice(0,o.length-1)),a.push(h),r&&(s++,r=void 0),i||(l=h)}let c=s-n.depth;return c>Ine&&(o=One(o,c),s-=c),new Ma(o.append(a),s)}remapping(e,r){let n=new Pp;return this.items.forEach((i,a)=>{let s=i.mirrorOffset!=null&&a-i.mirrorOffset>=e?n.maps.length-i.mirrorOffset:void 0;n.appendMap(i.map,s)},e,r),n}addMaps(e){return this.eventCount==0?this:new Ma(this.items.append(e.map(r=>new rs(r))),this.eventCount)}rebased(e,r){if(!this.eventCount)return this;let n=[],i=Math.max(0,this.items.length-r),a=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach(h=>{h.selection&&o--},i);let l=r;this.items.forEach(h=>{let m=a.getMirror(--l);if(m==null)return;s=Math.min(s,m);let v=a.maps[m];if(h.step){let y=e.steps[m].invert(e.docs[m]),x=h.selection&&h.selection.map(a.slice(l+1,m));x&&o++,n.push(new rs(v,y,x))}else n.push(new rs(v))},i);let c=[];for(let h=r;h<s;h++)c.push(new rs(a.maps[h]));let u=this.items.slice(0,i).append(c).append(n),f=new Ma(u,o);return f.emptyItemCount()>Dne&&(f=f.compress(this.items.length-n.length)),f}emptyItemCount(){let e=0;return this.items.forEach(r=>{r.step||e++}),e}compress(e=this.items.length){let r=this.remapping(0,e),n=r.maps.length,i=[],a=0;return this.items.forEach((s,o)=>{if(o>=e)i.push(s),s.selection&&a++;else if(s.step){let l=s.step.map(r.slice(n)),c=l&&l.getMap();if(n--,c&&r.appendMap(c,n),l){let u=s.selection&&s.selection.map(r.slice(n));u&&a++;let f=new rs(c.invert(),l,u),h,m=i.length-1;(h=i.length&&i[m].merge(f))?i[m]=h:i.push(f)}}else s.map&&n--},this.items.length,0),new Ma(gn.from(i.reverse()),a)}}Ma.empty=new Ma(gn.empty,0);function One(t,e){let r;return t.forEach((n,i)=>{if(n.selection&&e--==0)return r=i,!1}),t.slice(r)}class rs{constructor(e,r,n,i){this.map=e,this.step=r,this.selection=n,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let r=e.step.merge(this.step);if(r)return new rs(r.getMap().invert(),r,this.selection)}}}class Bo{constructor(e,r,n,i,a){this.done=e,this.undone=r,this.prevRanges=n,this.prevTime=i,this.prevComposition=a}}const Ine=20;function Lne(t,e,r,n){let i=r.getMeta(Pc),a;if(i)return i.historyState;r.getMeta(zne)&&(t=new Bo(t.done,t.undone,null,0,-1));let s=r.getMeta("appendedTransaction");if(r.steps.length==0)return t;if(s&&s.getMeta(Pc))return s.getMeta(Pc).redo?new Bo(t.done.addTransform(r,void 0,n,$v(e)),t.undone,B9(r.mapping.maps),t.prevTime,t.prevComposition):new Bo(t.done,t.undone.addTransform(r,void 0,n,$v(e)),null,t.prevTime,t.prevComposition);if(r.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let o=r.getMeta("composition"),l=t.prevTime==0||!s&&t.prevComposition!=o&&(t.prevTime<(r.time||0)-n.newGroupDelay||!Bne(r,t.prevRanges)),c=s?bS(t.prevRanges,r.mapping):B9(r.mapping.maps);return new Bo(t.done.addTransform(r,l?e.selection.getBookmark():void 0,n,$v(e)),Ma.empty,c,r.time,o??t.prevComposition)}else return(a=r.getMeta("rebased"))?new Bo(t.done.rebased(r,a),t.undone.rebased(r,a),bS(t.prevRanges,r.mapping),t.prevTime,t.prevComposition):new Bo(t.done.addMaps(r.mapping.maps),t.undone.addMaps(r.mapping.maps),bS(t.prevRanges,r.mapping),t.prevTime,t.prevComposition)}function Bne(t,e){if(!e)return!1;if(!t.docChanged)return!0;let r=!1;return t.mapping.maps[0].forEach((n,i)=>{for(let a=0;a<e.length;a+=2)n<=e[a+1]&&i>=e[a]&&(r=!0)}),r}function B9(t){let e=[];for(let r=t.length-1;r>=0&&e.length==0;r--)t[r].forEach((n,i,a,s)=>e.push(a,s));return e}function bS(t,e){if(!t)return null;let r=[];for(let n=0;n<t.length;n+=2){let i=e.map(t[n],1),a=e.map(t[n+1],-1);i<=a&&r.push(i,a)}return r}function Fne(t,e,r){let n=$v(e),i=Pc.get(e).spec.config,a=(r?t.undone:t.done).popEvent(e,n);if(!a)return null;let s=a.selection.resolve(a.transform.doc),o=(r?t.done:t.undone).addTransform(a.transform,e.selection.getBookmark(),i,n),l=new Bo(r?o:a.remaining,r?a.remaining:o,null,0,-1);return a.transform.setSelection(s).setMeta(Pc,{redo:r,historyState:l})}let wS=!1,F9=null;function $v(t){let e=t.plugins;if(F9!=e){wS=!1,F9=e;for(let r=0;r<e.length;r++)if(e[r].spec.historyPreserveItems){wS=!0;break}}return wS}const Pc=new Rr("history"),zne=new Rr("closeHistory");function Vne(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new ur({key:Pc,state:{init(){return new Bo(Ma.empty,Ma.empty,null,0,-1)},apply(e,r,n){return Lne(r,n,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,r){let n=r.inputType,i=n=="historyUndo"?tI:n=="historyRedo"?rI:null;return!i||!e.editable?!1:(r.preventDefault(),i(e.state,e.dispatch))}}}})}function eI(t,e){return(r,n)=>{let i=Pc.getState(r);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(n){let a=Fne(i,r,t);a&&n(e?a.scrollIntoView():a)}return!0}}const tI=eI(!1,!0),rI=eI(!0,!0);Dr.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc;if(((t==null?void 0:t.mode)||this.options.mode)==="textSize"){const n=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(n)}return e.nodeSize},this.storage.words=t=>{const e=(t==null?void 0:t.node)||this.editor.state.doc,r=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(r)}},addProseMirrorPlugins(){let t=!1;return[new ur({key:new Rr("characterCount"),appendTransaction:(e,r,n)=>{if(t)return;const i=this.options.limit;if(i==null||i===0){t=!0;return}const a=this.storage.characters({node:n.doc});if(a>i){const s=a-i,o=0,l=s;console.warn(`[CharacterCount] Initial content exceeded limit of ${i} characters. Content was automatically trimmed.`);const c=n.tr.deleteRange(o,l);return t=!0,c}t=!0},filterTransaction:(e,r)=>{const n=this.options.limit;if(!e.docChanged||n===0||n===null||n===void 0)return!0;const i=this.storage.characters({node:r.doc}),a=this.storage.characters({node:e.doc});if(a<=n||i>n&&a>n&&a<=i)return!0;if(i>n&&a>n&&a>i||!e.getMeta("paste"))return!1;const o=e.selection.$head.pos,l=a-n,c=o-l,u=o;return e.deleteRange(c,u),!(this.storage.characters({node:e.doc})>n)}})]}});var $ne=Dr.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Cne(this.options)]}});Dr.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new ur({key:new Rr("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:r,isFocused:n}=this.editor,{anchor:i}=e,a=[];if(!r||!n)return sr.create(t,[]);let s=0;this.options.mode==="deepest"&&t.descendants((l,c)=>{if(l.isText)return;if(!(i>=c&&i<=c+l.nodeSize-1))return!1;s+=1});let o=0;return t.descendants((l,c)=>{if(l.isText||!(i>=c&&i<=c+l.nodeSize-1))return!1;if(o+=1,this.options.mode==="deepest"&&s-o>0||this.options.mode==="shallowest"&&o>1)return this.options.mode==="deepest";a.push($n.node(c,c+l.nodeSize,{class:this.options.className}))}),sr.create(t,a)}}})]}});var Une=Dr.create({name:"gapCursor",addProseMirrorPlugins(){return[jne()]},extendNodeSchema(t){var e;const r={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Bt(qe(t,"allowGapCursor",r)))!=null?e:null}}}),Gne=Dr.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new ur({key:new Rr("placeholder"),props:{decorations:({doc:t,selection:e})=>{const r=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:n}=e,i=[];if(!r)return null;const a=this.editor.isEmpty;return t.descendants((s,o)=>{const l=n>=o&&n<=o+s.nodeSize,c=!s.isLeaf&&Ex(s);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];a&&u.push(this.options.emptyEditorClass);const f=$n.node(o,o+s.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:o,hasAnchor:l}):this.options.placeholder});i.push(f)}return this.options.includeChildren}),sr.create(t,i)}}})]}});Dr.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new ur({key:new Rr("selection"),props:{decorations(r){return r.selection.empty||t.isFocused||!t.isEditable||uO(r.selection)||t.view.dragging?null:sr.create(r.doc,[$n.inline(r.selection.from,r.selection.to,{class:e.className})])}}})]}});function z9({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||(e==null?void 0:e.type)===t}var Hne=Dr.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new Rr(this.name),r=this.options.node||((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||"paragraph",n=Object.entries(this.editor.schema.nodes).map(([,i])=>i).filter(i=>(this.options.notAfter||[]).concat(r).includes(i.name));return[new ur({key:e,appendTransaction:(i,a,s)=>{const{doc:o,tr:l,schema:c}=s,u=e.getState(s),f=o.content.size,h=c.nodes[r];if(u)return l.insert(f,h.create())},state:{init:(i,a)=>{const s=a.tr.doc.lastChild;return!z9({node:s,types:n})},apply:(i,a)=>{if(!i.docChanged||i.getMeta("__uniqueIDTransaction"))return a;const s=i.doc.lastChild;return!z9({node:s,types:n})}}})]}}),Wne=Dr.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>tI(t,e),redo:()=>({state:t,dispatch:e})=>rI(t,e)}},addProseMirrorPlugins(){return[Vne(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),qne=Dr.create({name:"starterKit",addExtensions(){var t,e,r,n;const i=[];return this.options.bold!==!1&&i.push(xre.configure(this.options.bold)),this.options.blockquote!==!1&&i.push(pre.configure(this.options.blockquote)),this.options.bulletList!==!1&&i.push($O.configure(this.options.bulletList)),this.options.code!==!1&&i.push(Sre.configure(this.options.code)),this.options.codeBlock!==!1&&i.push(Nre.configure(this.options.codeBlock)),this.options.document!==!1&&i.push(Ere.configure(this.options.document)),this.options.dropcursor!==!1&&i.push($ne.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&i.push(Une.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&i.push(Tre.configure(this.options.hardBreak)),this.options.heading!==!1&&i.push(jre.configure(this.options.heading)),this.options.undoRedo!==!1&&i.push(Wne.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&i.push(Mre.configure(this.options.horizontalRule)),this.options.italic!==!1&&i.push(Dre.configure(this.options.italic)),this.options.listItem!==!1&&i.push(UO.configure(this.options.listItem)),this.options.listKeymap!==!1&&i.push(YO.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&i.push(ane.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&i.push(QO.configure(this.options.orderedList)),this.options.paragraph!==!1&&i.push(yne.configure(this.options.paragraph)),this.options.strike!==!1&&i.push(wne.configure(this.options.strike)),this.options.text!==!1&&i.push(Sne.configure(this.options.text)),this.options.underline!==!1&&i.push(kne.configure((r=this.options)==null?void 0:r.underline)),this.options.trailingNode!==!1&&i.push(Hne.configure((n=this.options)==null?void 0:n.trailingNode)),i}}),Kne=qne,Yne=Gne;function Xne(t){var e;const{char:r,allowSpaces:n,allowToIncludeChar:i,allowedPrefixes:a,startOfLine:s,$position:o}=t,l=n&&!i,c=Wee(r),u=new RegExp(`\\s${c}$`),f=s?"^":"",h=i?"":c,m=l?new RegExp(`${f}${c}.*?(?=\\s${h}|$)`,"gm"):new RegExp(`${f}(?:^)?${c}[^\\s${h}]*`,"gm"),v=((e=o.nodeBefore)==null?void 0:e.isText)&&o.nodeBefore.text;if(!v)return null;const y=o.pos-v.length,x=Array.from(v.matchAll(m)).pop();if(!x||x.input===void 0||x.index===void 0)return null;const b=x.input.slice(Math.max(0,x.index-1),x.index),S=new RegExp(`^[${a==null?void 0:a.join("")}\0]?$`).test(b);if(a!==null&&!S)return null;const w=y+x.index;let k=w+x[0].length;return l&&u.test(v.slice(k-1,k+1))&&(x[0]+=" ",k+=1),w<o.pos&&k>=o.pos?{range:{from:w,to:k},query:x[0].slice(r.length),text:x[0]}:null}var Qne=new Rr("suggestion");function Jne({pluginKey:t=Qne,editor:e,char:r="@",allowSpaces:n=!1,allowToIncludeChar:i=!1,allowedPrefixes:a=[" "],startOfLine:s=!1,decorationTag:o="span",decorationClass:l="suggestion",decorationContent:c="",decorationEmptyClass:u="is-empty",command:f=()=>null,items:h=()=>[],render:m=()=>({}),allow:v=()=>!0,findSuggestionMatch:y=Xne,shouldShow:x}){let b;const S=m==null?void 0:m(),w=()=>{const T=e.state.selection.$anchor.pos,M=e.view.coordsAtPos(T),{top:A,right:_,bottom:D,left:R}=M;try{return new DOMRect(R,A,_-R,D-A)}catch{return null}},k=(T,M)=>M?()=>{const A=t.getState(e.state),_=A==null?void 0:A.decorationId,D=T.dom.querySelector(`[data-decoration-id="${_}"]`);return(D==null?void 0:D.getBoundingClientRect())||null}:w;function N(T,M){var A;try{const D=t.getState(T.state),R=D!=null&&D.decorationId?T.dom.querySelector(`[data-decoration-id="${D.decorationId}"]`):null,I={editor:e,range:(D==null?void 0:D.range)||{from:0,to:0},query:(D==null?void 0:D.query)||null,text:(D==null?void 0:D.text)||null,items:[],command:$=>f({editor:e,range:(D==null?void 0:D.range)||{from:0,to:0},props:$}),decorationNode:R,clientRect:k(T,R)};(A=S==null?void 0:S.onExit)==null||A.call(S,I)}catch{}const _=T.state.tr.setMeta(M,{exit:!0});T.dispatch(_)}const j=new ur({key:t,view(){return{update:async(T,M)=>{var A,_,D,R,I,$,B;const z=(A=this.key)==null?void 0:A.getState(M),U=(_=this.key)==null?void 0:_.getState(T.state),F=z.active&&U.active&&z.range.from!==U.range.from,Q=!z.active&&U.active,K=z.active&&!U.active,L=!Q&&!K&&z.query!==U.query,G=Q||F&&L,ee=L||F,re=K||F&&L;if(!G&&!ee&&!re)return;const se=re&&!G?z:U,de=T.dom.querySelector(`[data-decoration-id="${se.decorationId}"]`);b={editor:e,range:se.range,query:se.query,text:se.text,items:[],command:W=>f({editor:e,range:se.range,props:W}),decorationNode:de,clientRect:k(T,de)},G&&((D=S==null?void 0:S.onBeforeStart)==null||D.call(S,b)),ee&&((R=S==null?void 0:S.onBeforeUpdate)==null||R.call(S,b)),(ee||G)&&(b.items=await h({editor:e,query:se.query})),re&&((I=S==null?void 0:S.onExit)==null||I.call(S,b)),ee&&(($=S==null?void 0:S.onUpdate)==null||$.call(S,b)),G&&((B=S==null?void 0:S.onStart)==null||B.call(S,b))},destroy:()=>{var T;b&&((T=S==null?void 0:S.onExit)==null||T.call(S,b))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(T,M,A,_){const{isEditable:D}=e,{composing:R}=e.view,{selection:I}=T,{empty:$,from:B}=I,z={...M},U=T.getMeta(t);if(U&&U.exit)return z.active=!1,z.decorationId=null,z.range={from:0,to:0},z.query=null,z.text=null,z;if(z.composing=R,D&&($||e.view.composing)){(B<M.range.from||B>M.range.to)&&!R&&!M.composing&&(z.active=!1);const F=y({char:r,allowSpaces:n,allowToIncludeChar:i,allowedPrefixes:a,startOfLine:s,$position:I.$from}),Q=`id_${Math.floor(Math.random()*4294967295)}`;F&&v({editor:e,state:_,range:F.range,isActive:M.active})&&(!x||x({editor:e,range:F.range,query:F.query,text:F.text,transaction:T}))?(z.active=!0,z.decorationId=M.decorationId?M.decorationId:Q,z.range=F.range,z.query=F.query,z.text=F.text):z.active=!1}else z.active=!1;return z.active||(z.decorationId=null,z.range={from:0,to:0},z.query=null,z.text=null),z}},props:{handleKeyDown(T,M){var A,_,D,R;const{active:I,range:$}=j.getState(T.state);if(!I)return!1;if(M.key==="Escape"||M.key==="Esc"){const z=j.getState(T.state),U=(A=b==null?void 0:b.decorationNode)!=null?A:null,F=U??(z!=null&&z.decorationId?T.dom.querySelector(`[data-decoration-id="${z.decorationId}"]`):null);if(((_=S==null?void 0:S.onKeyDown)==null?void 0:_.call(S,{view:T,event:M,range:z.range}))||!1)return!0;const K={editor:e,range:z.range,query:z.query,text:z.text,items:[],command:L=>f({editor:e,range:z.range,props:L}),decorationNode:F,clientRect:F?()=>F.getBoundingClientRect()||null:null};return(D=S==null?void 0:S.onExit)==null||D.call(S,K),N(T,t),!0}return((R=S==null?void 0:S.onKeyDown)==null?void 0:R.call(S,{view:T,event:M,range:$}))||!1},decorations(T){const{active:M,range:A,decorationId:_,query:D}=j.getState(T);if(!M)return null;const R=!(D!=null&&D.length),I=[l];return R&&I.push(u),sr.create(T.doc,[$n.inline(A.from,A.to,{nodeName:o,class:I.join(" "),"data-decoration-id":_,"data-decoration-content":c})])}}});return j}function Zne({editor:t,overrideSuggestionOptions:e,extensionName:r,char:n="@"}){const i=new Rr;return{editor:t,char:n,pluginKey:i,command:({editor:a,range:s,props:o})=>{var l,c,u;const f=a.view.state.selection.$to.nodeAfter;((l=f==null?void 0:f.text)==null?void 0:l.startsWith(" "))&&(s.to+=1),a.chain().focus().insertContentAt(s,[{type:r,attrs:{...o,mentionSuggestionChar:n}},{type:"text",text:" "}]).run(),(u=(c=a.view.dom.ownerDocument.defaultView)==null?void 0:c.getSelection())==null||u.collapseToEnd()},allow:({state:a,range:s})=>{const o=a.doc.resolve(s.from),l=a.schema.nodes[r];return!!o.parent.type.contentMatch.matchType(l)},...e}}function nI(t){return(t.options.suggestions.length?t.options.suggestions:[t.options.suggestion]).map(e=>Zne({editor:t.editor,overrideSuggestionOptions:e,extensionName:t.name,char:e.char}))}function V9(t,e){const r=nI(t),n=r.find(i=>i.char===e);return n||(r.length?r[0]:null)}var eie=Ci.create({name:"mention",priority:101,addOptions(){return{HTMLAttributes:{},renderText({node:t,suggestion:e}){var r,n;return`${(r=e==null?void 0:e.char)!=null?r:"@"}${(n=t.attrs.label)!=null?n:t.attrs.id}`},deleteTriggerWithBackspace:!1,renderHTML({options:t,node:e,suggestion:r}){var n,i;return["span",cr(this.HTMLAttributes,t.HTMLAttributes),`${(n=r==null?void 0:r.char)!=null?n:"@"}${(i=e.attrs.label)!=null?i:e.attrs.id}`]},suggestions:[],suggestion:{}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:t=>t.getAttribute("data-id"),renderHTML:t=>t.id?{"data-id":t.id}:{}},label:{default:null,parseHTML:t=>t.getAttribute("data-label"),renderHTML:t=>t.label?{"data-label":t.label}:{}},mentionSuggestionChar:{default:"@",parseHTML:t=>t.getAttribute("data-mention-suggestion-char"),renderHTML:t=>({"data-mention-suggestion-char":t.mentionSuggestionChar})}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:t,HTMLAttributes:e}){const r=V9(this,t.attrs.mentionSuggestionChar);if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",cr({"data-type":this.name},this.options.HTMLAttributes,e),this.options.renderLabel({options:this.options,node:t,suggestion:r})];const n={...this.options};n.HTMLAttributes=cr({"data-type":this.name},this.options.HTMLAttributes,e);const i=this.options.renderHTML({options:n,node:t,suggestion:r});return typeof i=="string"?["span",cr({"data-type":this.name},this.options.HTMLAttributes,e),i]:i},...TO({nodeName:"mention",name:"@",selfClosing:!0,allowedAttributes:["id","label",{name:"mentionSuggestionChar",skipIfDefault:"@"}],parseAttributes:t=>{const e={},r=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let n=r.exec(t);for(;n!==null;){const[,i,a,s]=n,o=a??s;e[i==="char"?"mentionSuggestionChar":i]=o,n=r.exec(t)}return e},serializeAttributes:t=>Object.entries(t).filter(([,e])=>e!=null).map(([e,r])=>`${e==="mentionSuggestionChar"?"char":e}="${r}"`).join(" ")}),renderText({node:t}){const e={options:this.options,node:t,suggestion:V9(this,t.attrs.mentionSuggestionChar)};return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel(e)):this.options.renderText(e)},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:t,state:e})=>{let r=!1;const{selection:n}=e,{empty:i,anchor:a}=n;if(!i)return!1;let s=new qs,o=0;return e.doc.nodesBetween(a-1,a,(l,c)=>{if(l.type.name===this.name)return r=!0,s=l,o=c,!1}),r&&t.insertText(this.options.deleteTriggerWithBackspace?"":s.attrs.mentionSuggestionChar,o,o+s.nodeSize),r})}},addProseMirrorPlugins(){return nI(this).map(Jne)}}),tie=eie,Si="top",fa="bottom",ha="right",ki="left",rN="auto",pm=[Si,fa,ha,ki],Gd="start",Fp="end",rie="clippingParents",iI="viewport",ch="popper",nie="reference",$9=pm.reduce(function(t,e){return t.concat([e+"-"+Gd,e+"-"+Fp])},[]),aI=[].concat(pm,[rN]).reduce(function(t,e){return t.concat([e,e+"-"+Gd,e+"-"+Fp])},[]),iie="beforeRead",aie="read",sie="afterRead",oie="beforeMain",lie="main",cie="afterMain",uie="beforeWrite",die="write",fie="afterWrite",hie=[iie,aie,sie,oie,lie,cie,uie,die,fie];function ms(t){return t?(t.nodeName||"").toLowerCase():null}function Di(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Yc(t){var e=Di(t).Element;return t instanceof e||t instanceof Element}function ca(t){var e=Di(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function nN(t){if(typeof ShadowRoot>"u")return!1;var e=Di(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function pie(t){var e=t.state;Object.keys(e.elements).forEach(function(r){var n=e.styles[r]||{},i=e.attributes[r]||{},a=e.elements[r];!ca(a)||!ms(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function mie(t){var e=t.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(n){var i=e.elements[n],a=e.attributes[n]||{},s=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:r[n]),o=s.reduce(function(l,c){return l[c]="",l},{});!ca(i)||!ms(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}const sI={name:"applyStyles",enabled:!0,phase:"write",fn:pie,effect:mie,requires:["computeStyles"]};function us(t){return t.split("-")[0]}var _c=Math.max,Ny=Math.min,Hd=Math.round;function Rk(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function oI(){return!/^((?!chrome|android).)*safari/i.test(Rk())}function Wd(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var n=t.getBoundingClientRect(),i=1,a=1;e&&ca(t)&&(i=t.offsetWidth>0&&Hd(n.width)/t.offsetWidth||1,a=t.offsetHeight>0&&Hd(n.height)/t.offsetHeight||1);var s=Yc(t)?Di(t):window,o=s.visualViewport,l=!oI()&&r,c=(n.left+(l&&o?o.offsetLeft:0))/i,u=(n.top+(l&&o?o.offsetTop:0))/a,f=n.width/i,h=n.height/a;return{width:f,height:h,top:u,right:c+f,bottom:u+h,left:c,x:c,y:u}}function iN(t){var e=Wd(t),r=t.offsetWidth,n=t.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:t.offsetLeft,y:t.offsetTop,width:r,height:n}}function lI(t,e){var r=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(r&&nN(r)){var n=e;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function ro(t){return Di(t).getComputedStyle(t)}function gie(t){return["table","td","th"].indexOf(ms(t))>=0}function Ll(t){return((Yc(t)?t.ownerDocument:t.document)||window.document).documentElement}function _x(t){return ms(t)==="html"?t:t.assignedSlot||t.parentNode||(nN(t)?t.host:null)||Ll(t)}function U9(t){return!ca(t)||ro(t).position==="fixed"?null:t.offsetParent}function vie(t){var e=/firefox/i.test(Rk()),r=/Trident/i.test(Rk());if(r&&ca(t)){var n=ro(t);if(n.position==="fixed")return null}var i=_x(t);for(nN(i)&&(i=i.host);ca(i)&&["html","body"].indexOf(ms(i))<0;){var a=ro(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function mm(t){for(var e=Di(t),r=U9(t);r&&gie(r)&&ro(r).position==="static";)r=U9(r);return r&&(ms(r)==="html"||ms(r)==="body"&&ro(r).position==="static")?e:r||vie(t)||e}function aN(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Xh(t,e,r){return _c(t,Ny(e,r))}function yie(t,e,r){var n=Xh(t,e,r);return n>r?r:n}function cI(){return{top:0,right:0,bottom:0,left:0}}function uI(t){return Object.assign({},cI(),t)}function dI(t,e){return e.reduce(function(r,n){return r[n]=t,r},{})}var xie=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,uI(typeof e!="number"?e:dI(e,pm))};function bie(t){var e,r=t.state,n=t.name,i=t.options,a=r.elements.arrow,s=r.modifiersData.popperOffsets,o=us(r.placement),l=aN(o),c=[ki,ha].indexOf(o)>=0,u=c?"height":"width";if(!(!a||!s)){var f=xie(i.padding,r),h=iN(a),m=l==="y"?Si:ki,v=l==="y"?fa:ha,y=r.rects.reference[u]+r.rects.reference[l]-s[l]-r.rects.popper[u],x=s[l]-r.rects.reference[l],b=mm(a),S=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,w=y/2-x/2,k=f[m],N=S-h[u]-f[v],j=S/2-h[u]/2+w,T=Xh(k,j,N),M=l;r.modifiersData[n]=(e={},e[M]=T,e.centerOffset=T-j,e)}}function wie(t){var e=t.state,r=t.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||lI(e.elements.popper,i)&&(e.elements.arrow=i))}const Sie={name:"arrow",enabled:!0,phase:"main",fn:bie,effect:wie,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function qd(t){return t.split("-")[1]}var kie={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Cie(t,e){var r=t.x,n=t.y,i=e.devicePixelRatio||1;return{x:Hd(r*i)/i||0,y:Hd(n*i)/i||0}}function G9(t){var e,r=t.popper,n=t.popperRect,i=t.placement,a=t.variation,s=t.offsets,o=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,f=t.isFixed,h=s.x,m=h===void 0?0:h,v=s.y,y=v===void 0?0:v,x=typeof u=="function"?u({x:m,y}):{x:m,y};m=x.x,y=x.y;var b=s.hasOwnProperty("x"),S=s.hasOwnProperty("y"),w=ki,k=Si,N=window;if(c){var j=mm(r),T="clientHeight",M="clientWidth";if(j===Di(r)&&(j=Ll(r),ro(j).position!=="static"&&o==="absolute"&&(T="scrollHeight",M="scrollWidth")),j=j,i===Si||(i===ki||i===ha)&&a===Fp){k=fa;var A=f&&j===N&&N.visualViewport?N.visualViewport.height:j[T];y-=A-n.height,y*=l?1:-1}if(i===ki||(i===Si||i===fa)&&a===Fp){w=ha;var _=f&&j===N&&N.visualViewport?N.visualViewport.width:j[M];m-=_-n.width,m*=l?1:-1}}var D=Object.assign({position:o},c&&kie),R=u===!0?Cie({x:m,y},Di(r)):{x:m,y};if(m=R.x,y=R.y,l){var I;return Object.assign({},D,(I={},I[k]=S?"0":"",I[w]=b?"0":"",I.transform=(N.devicePixelRatio||1)<=1?"translate("+m+"px, "+y+"px)":"translate3d("+m+"px, "+y+"px, 0)",I))}return Object.assign({},D,(e={},e[k]=S?y+"px":"",e[w]=b?m+"px":"",e.transform="",e))}function Nie(t){var e=t.state,r=t.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,s=a===void 0?!0:a,o=r.roundOffsets,l=o===void 0?!0:o,c={placement:us(e.placement),variation:qd(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,G9(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,G9(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Eie={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Nie,data:{}};var lv={passive:!0};function Tie(t){var e=t.state,r=t.instance,n=t.options,i=n.scroll,a=i===void 0?!0:i,s=n.resize,o=s===void 0?!0:s,l=Di(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&c.forEach(function(u){u.addEventListener("scroll",r.update,lv)}),o&&l.addEventListener("resize",r.update,lv),function(){a&&c.forEach(function(u){u.removeEventListener("scroll",r.update,lv)}),o&&l.removeEventListener("resize",r.update,lv)}}const jie={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Tie,data:{}};var Mie={left:"right",right:"left",bottom:"top",top:"bottom"};function Uv(t){return t.replace(/left|right|bottom|top/g,function(e){return Mie[e]})}var Pie={start:"end",end:"start"};function H9(t){return t.replace(/start|end/g,function(e){return Pie[e]})}function sN(t){var e=Di(t),r=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:r,scrollTop:n}}function oN(t){return Wd(Ll(t)).left+sN(t).scrollLeft}function _ie(t,e){var r=Di(t),n=Ll(t),i=r.visualViewport,a=n.clientWidth,s=n.clientHeight,o=0,l=0;if(i){a=i.width,s=i.height;var c=oI();(c||!c&&e==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:a,height:s,x:o+oN(t),y:l}}function Aie(t){var e,r=Ll(t),n=sN(t),i=(e=t.ownerDocument)==null?void 0:e.body,a=_c(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=_c(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+oN(t),l=-n.scrollTop;return ro(i||r).direction==="rtl"&&(o+=_c(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:l}}function lN(t){var e=ro(t),r=e.overflow,n=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function fI(t){return["html","body","#document"].indexOf(ms(t))>=0?t.ownerDocument.body:ca(t)&&lN(t)?t:fI(_x(t))}function Qh(t,e){var r;e===void 0&&(e=[]);var n=fI(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),a=Di(n),s=i?[a].concat(a.visualViewport||[],lN(n)?n:[]):n,o=e.concat(s);return i?o:o.concat(Qh(_x(s)))}function Dk(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Rie(t,e){var r=Wd(t,!1,e==="fixed");return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function W9(t,e,r){return e===iI?Dk(_ie(t,r)):Yc(e)?Rie(e,r):Dk(Aie(Ll(t)))}function Die(t){var e=Qh(_x(t)),r=["absolute","fixed"].indexOf(ro(t).position)>=0,n=r&&ca(t)?mm(t):t;return Yc(n)?e.filter(function(i){return Yc(i)&&lI(i,n)&&ms(i)!=="body"}):[]}function Oie(t,e,r,n){var i=e==="clippingParents"?Die(t):[].concat(e),a=[].concat(i,[r]),s=a[0],o=a.reduce(function(l,c){var u=W9(t,c,n);return l.top=_c(u.top,l.top),l.right=Ny(u.right,l.right),l.bottom=Ny(u.bottom,l.bottom),l.left=_c(u.left,l.left),l},W9(t,s,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function hI(t){var e=t.reference,r=t.element,n=t.placement,i=n?us(n):null,a=n?qd(n):null,s=e.x+e.width/2-r.width/2,o=e.y+e.height/2-r.height/2,l;switch(i){case Si:l={x:s,y:e.y-r.height};break;case fa:l={x:s,y:e.y+e.height};break;case ha:l={x:e.x+e.width,y:o};break;case ki:l={x:e.x-r.width,y:o};break;default:l={x:e.x,y:e.y}}var c=i?aN(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(a){case Gd:l[c]=l[c]-(e[u]/2-r[u]/2);break;case Fp:l[c]=l[c]+(e[u]/2-r[u]/2);break}}return l}function zp(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=n===void 0?t.placement:n,a=r.strategy,s=a===void 0?t.strategy:a,o=r.boundary,l=o===void 0?rie:o,c=r.rootBoundary,u=c===void 0?iI:c,f=r.elementContext,h=f===void 0?ch:f,m=r.altBoundary,v=m===void 0?!1:m,y=r.padding,x=y===void 0?0:y,b=uI(typeof x!="number"?x:dI(x,pm)),S=h===ch?nie:ch,w=t.rects.popper,k=t.elements[v?S:h],N=Oie(Yc(k)?k:k.contextElement||Ll(t.elements.popper),l,u,s),j=Wd(t.elements.reference),T=hI({reference:j,element:w,strategy:"absolute",placement:i}),M=Dk(Object.assign({},w,T)),A=h===ch?M:j,_={top:N.top-A.top+b.top,bottom:A.bottom-N.bottom+b.bottom,left:N.left-A.left+b.left,right:A.right-N.right+b.right},D=t.modifiersData.offset;if(h===ch&&D){var R=D[i];Object.keys(_).forEach(function(I){var $=[ha,fa].indexOf(I)>=0?1:-1,B=[Si,fa].indexOf(I)>=0?"y":"x";_[I]+=R[B]*$})}return _}function Iie(t,e){e===void 0&&(e={});var r=e,n=r.placement,i=r.boundary,a=r.rootBoundary,s=r.padding,o=r.flipVariations,l=r.allowedAutoPlacements,c=l===void 0?aI:l,u=qd(n),f=u?o?$9:$9.filter(function(v){return qd(v)===u}):pm,h=f.filter(function(v){return c.indexOf(v)>=0});h.length===0&&(h=f);var m=h.reduce(function(v,y){return v[y]=zp(t,{placement:y,boundary:i,rootBoundary:a,padding:s})[us(y)],v},{});return Object.keys(m).sort(function(v,y){return m[v]-m[y]})}function Lie(t){if(us(t)===rN)return[];var e=Uv(t);return[H9(t),e,H9(e)]}function Bie(t){var e=t.state,r=t.options,n=t.name;if(!e.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!0:s,l=r.fallbackPlacements,c=r.padding,u=r.boundary,f=r.rootBoundary,h=r.altBoundary,m=r.flipVariations,v=m===void 0?!0:m,y=r.allowedAutoPlacements,x=e.options.placement,b=us(x),S=b===x,w=l||(S||!v?[Uv(x)]:Lie(x)),k=[x].concat(w).reduce(function(re,se){return re.concat(us(se)===rN?Iie(e,{placement:se,boundary:u,rootBoundary:f,padding:c,flipVariations:v,allowedAutoPlacements:y}):se)},[]),N=e.rects.reference,j=e.rects.popper,T=new Map,M=!0,A=k[0],_=0;_<k.length;_++){var D=k[_],R=us(D),I=qd(D)===Gd,$=[Si,fa].indexOf(R)>=0,B=$?"width":"height",z=zp(e,{placement:D,boundary:u,rootBoundary:f,altBoundary:h,padding:c}),U=$?I?ha:ki:I?fa:Si;N[B]>j[B]&&(U=Uv(U));var F=Uv(U),Q=[];if(a&&Q.push(z[R]<=0),o&&Q.push(z[U]<=0,z[F]<=0),Q.every(function(re){return re})){A=D,M=!1;break}T.set(D,Q)}if(M)for(var K=v?3:1,L=function(se){var de=k.find(function(W){var ne=T.get(W);if(ne)return ne.slice(0,se).every(function(ie){return ie})});if(de)return A=de,"break"},G=K;G>0;G--){var ee=L(G);if(ee==="break")break}e.placement!==A&&(e.modifiersData[n]._skip=!0,e.placement=A,e.reset=!0)}}const Fie={name:"flip",enabled:!0,phase:"main",fn:Bie,requiresIfExists:["offset"],data:{_skip:!1}};function q9(t,e,r){return r===void 0&&(r={x:0,y:0}),{top:t.top-e.height-r.y,right:t.right-e.width+r.x,bottom:t.bottom-e.height+r.y,left:t.left-e.width-r.x}}function K9(t){return[Si,ha,fa,ki].some(function(e){return t[e]>=0})}function zie(t){var e=t.state,r=t.name,n=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,s=zp(e,{elementContext:"reference"}),o=zp(e,{altBoundary:!0}),l=q9(s,n),c=q9(o,i,a),u=K9(l),f=K9(c);e.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":f})}const Vie={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:zie};function $ie(t,e,r){var n=us(t),i=[ki,Si].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},e,{placement:t})):r,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[ki,ha].indexOf(n)>=0?{x:o,y:s}:{x:s,y:o}}function Uie(t){var e=t.state,r=t.options,n=t.name,i=r.offset,a=i===void 0?[0,0]:i,s=aI.reduce(function(u,f){return u[f]=$ie(f,e.rects,a),u},{}),o=s[e.placement],l=o.x,c=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[n]=s}const Gie={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Uie};function Hie(t){var e=t.state,r=t.name;e.modifiersData[r]=hI({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Wie={name:"popperOffsets",enabled:!0,phase:"read",fn:Hie,data:{}};function qie(t){return t==="x"?"y":"x"}function Kie(t){var e=t.state,r=t.options,n=t.name,i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!1:s,l=r.boundary,c=r.rootBoundary,u=r.altBoundary,f=r.padding,h=r.tether,m=h===void 0?!0:h,v=r.tetherOffset,y=v===void 0?0:v,x=zp(e,{boundary:l,rootBoundary:c,padding:f,altBoundary:u}),b=us(e.placement),S=qd(e.placement),w=!S,k=aN(b),N=qie(k),j=e.modifiersData.popperOffsets,T=e.rects.reference,M=e.rects.popper,A=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,_=typeof A=="number"?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),D=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,R={x:0,y:0};if(j){if(a){var I,$=k==="y"?Si:ki,B=k==="y"?fa:ha,z=k==="y"?"height":"width",U=j[k],F=U+x[$],Q=U-x[B],K=m?-M[z]/2:0,L=S===Gd?T[z]:M[z],G=S===Gd?-M[z]:-T[z],ee=e.elements.arrow,re=m&&ee?iN(ee):{width:0,height:0},se=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:cI(),de=se[$],W=se[B],ne=Xh(0,T[z],re[z]),ie=w?T[z]/2-K-ne-de-_.mainAxis:L-ne-de-_.mainAxis,V=w?-T[z]/2+K+ne+W+_.mainAxis:G+ne+W+_.mainAxis,Y=e.elements.arrow&&mm(e.elements.arrow),te=Y?k==="y"?Y.clientTop||0:Y.clientLeft||0:0,Z=(I=D==null?void 0:D[k])!=null?I:0,ue=U+ie-Z-te,ge=U+V-Z,Ue=Xh(m?Ny(F,ue):F,U,m?_c(Q,ge):Q);j[k]=Ue,R[k]=Ue-U}if(o){var Pe,ze=k==="x"?Si:ki,Ge=k==="x"?fa:ha,Ce=j[N],Re=N==="y"?"height":"width",Ve=Ce+x[ze],We=Ce-x[Ge],Oe=[Si,ki].indexOf(b)!==-1,rt=(Pe=D==null?void 0:D[N])!=null?Pe:0,ct=Oe?Ve:Ce-T[Re]-M[Re]-rt+_.altAxis,xt=Oe?Ce+T[Re]+M[Re]-rt-_.altAxis:We,bt=m&&Oe?yie(ct,Ce,xt):Xh(m?ct:Ve,Ce,m?xt:We);j[N]=bt,R[N]=bt-Ce}e.modifiersData[n]=R}}const Yie={name:"preventOverflow",enabled:!0,phase:"main",fn:Kie,requiresIfExists:["offset"]};function Xie(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Qie(t){return t===Di(t)||!ca(t)?sN(t):Xie(t)}function Jie(t){var e=t.getBoundingClientRect(),r=Hd(e.width)/t.offsetWidth||1,n=Hd(e.height)/t.offsetHeight||1;return r!==1||n!==1}function Zie(t,e,r){r===void 0&&(r=!1);var n=ca(e),i=ca(e)&&Jie(e),a=Ll(e),s=Wd(t,i,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&((ms(e)!=="body"||lN(a))&&(o=Qie(e)),ca(e)?(l=Wd(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=oN(a))),{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}function eae(t){var e=new Map,r=new Set,n=[];t.forEach(function(a){e.set(a.name,a)});function i(a){r.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!r.has(o)){var l=e.get(o);l&&i(l)}}),n.push(a)}return t.forEach(function(a){r.has(a.name)||i(a)}),n}function tae(t){var e=eae(t);return hie.reduce(function(r,n){return r.concat(e.filter(function(i){return i.phase===n}))},[])}function rae(t){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(t())})})),e}}function nae(t){var e=t.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(e).map(function(r){return e[r]})}var Y9={placement:"bottom",modifiers:[],strategy:"absolute"};function X9(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function iae(t){t===void 0&&(t={});var e=t,r=e.defaultModifiers,n=r===void 0?[]:r,i=e.defaultOptions,a=i===void 0?Y9:i;return function(o,l,c){c===void 0&&(c=a);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Y9,a),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},f=[],h=!1,m={state:u,setOptions:function(b){var S=typeof b=="function"?b(u.options):b;y(),u.options=Object.assign({},a,u.options,S),u.scrollParents={reference:Yc(o)?Qh(o):o.contextElement?Qh(o.contextElement):[],popper:Qh(l)};var w=tae(nae([].concat(n,u.options.modifiers)));return u.orderedModifiers=w.filter(function(k){return k.enabled}),v(),m.update()},forceUpdate:function(){if(!h){var b=u.elements,S=b.reference,w=b.popper;if(X9(S,w)){u.rects={reference:Zie(S,mm(w),u.options.strategy==="fixed"),popper:iN(w)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(_){return u.modifiersData[_.name]=Object.assign({},_.data)});for(var k=0;k<u.orderedModifiers.length;k++){if(u.reset===!0){u.reset=!1,k=-1;continue}var N=u.orderedModifiers[k],j=N.fn,T=N.options,M=T===void 0?{}:T,A=N.name;typeof j=="function"&&(u=j({state:u,options:M,name:A,instance:m})||u)}}}},update:rae(function(){return new Promise(function(x){m.forceUpdate(),x(u)})}),destroy:function(){y(),h=!0}};if(!X9(o,l))return m;m.setOptions(c).then(function(x){!h&&c.onFirstUpdate&&c.onFirstUpdate(x)});function v(){u.orderedModifiers.forEach(function(x){var b=x.name,S=x.options,w=S===void 0?{}:S,k=x.effect;if(typeof k=="function"){var N=k({state:u,name:b,instance:m,options:w}),j=function(){};f.push(N||j)}})}function y(){f.forEach(function(x){return x()}),f=[]}return m}}var aae=[jie,Wie,Eie,sI,Gie,Fie,Yie,Sie,Vie],sae=iae({defaultModifiers:aae}),oae="tippy-box",pI="tippy-content",lae="tippy-backdrop",mI="tippy-arrow",gI="tippy-svg-arrow",dc={passive:!0,capture:!0},vI=function(){return document.body};function SS(t,e,r){if(Array.isArray(t)){var n=t[e];return n??(Array.isArray(r)?r[e]:r)}return t}function cN(t,e){var r={}.toString.call(t);return r.indexOf("[object")===0&&r.indexOf(e+"]")>-1}function yI(t,e){return typeof t=="function"?t.apply(void 0,e):t}function Q9(t,e){if(e===0)return t;var r;return function(n){clearTimeout(r),r=setTimeout(function(){t(n)},e)}}function cae(t){return t.split(/\s+/).filter(Boolean)}function qu(t){return[].concat(t)}function J9(t,e){t.indexOf(e)===-1&&t.push(e)}function uae(t){return t.filter(function(e,r){return t.indexOf(e)===r})}function dae(t){return t.split("-")[0]}function Ey(t){return[].slice.call(t)}function Z9(t){return Object.keys(t).reduce(function(e,r){return t[r]!==void 0&&(e[r]=t[r]),e},{})}function Jh(){return document.createElement("div")}function Ax(t){return["Element","Fragment"].some(function(e){return cN(t,e)})}function fae(t){return cN(t,"NodeList")}function hae(t){return cN(t,"MouseEvent")}function pae(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function mae(t){return Ax(t)?[t]:fae(t)?Ey(t):Array.isArray(t)?t:Ey(document.querySelectorAll(t))}function kS(t,e){t.forEach(function(r){r&&(r.style.transitionDuration=e+"ms")})}function eM(t,e){t.forEach(function(r){r&&r.setAttribute("data-state",e)})}function gae(t){var e,r=qu(t),n=r[0];return n!=null&&(e=n.ownerDocument)!=null&&e.body?n.ownerDocument:document}function vae(t,e){var r=e.clientX,n=e.clientY;return t.every(function(i){var a=i.popperRect,s=i.popperState,o=i.props,l=o.interactiveBorder,c=dae(s.placement),u=s.modifiersData.offset;if(!u)return!0;var f=c==="bottom"?u.top.y:0,h=c==="top"?u.bottom.y:0,m=c==="right"?u.left.x:0,v=c==="left"?u.right.x:0,y=a.top-n+f>l,x=n-a.bottom-h>l,b=a.left-r+m>l,S=r-a.right-v>l;return y||x||b||S})}function CS(t,e,r){var n=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[n](i,r)})}function tM(t,e){for(var r=e;r;){var n;if(t.contains(r))return!0;r=r.getRootNode==null||(n=r.getRootNode())==null?void 0:n.host}return!1}var ns={isTouch:!1},rM=0;function yae(){ns.isTouch||(ns.isTouch=!0,window.performance&&document.addEventListener("mousemove",xI))}function xI(){var t=performance.now();t-rM<20&&(ns.isTouch=!1,document.removeEventListener("mousemove",xI)),rM=t}function xae(){var t=document.activeElement;if(pae(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function bae(){document.addEventListener("touchstart",yae,dc),window.addEventListener("blur",xae)}var wae=typeof window<"u"&&typeof document<"u",Sae=wae?!!window.msCrypto:!1,kae={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},Cae={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},_a=Object.assign({appendTo:vI,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},kae,Cae),Nae=Object.keys(_a),Eae=function(e){var r=Object.keys(e);r.forEach(function(n){_a[n]=e[n]})};function bI(t){var e=t.plugins||[],r=e.reduce(function(n,i){var a=i.name,s=i.defaultValue;if(a){var o;n[a]=t[a]!==void 0?t[a]:(o=_a[a])!=null?o:s}return n},{});return Object.assign({},t,r)}function Tae(t,e){var r=e?Object.keys(bI(Object.assign({},_a,{plugins:e}))):Nae,n=r.reduce(function(i,a){var s=(t.getAttribute("data-tippy-"+a)||"").trim();if(!s)return i;if(a==="content")i[a]=s;else try{i[a]=JSON.parse(s)}catch{i[a]=s}return i},{});return n}function nM(t,e){var r=Object.assign({},e,{content:yI(e.content,[t])},e.ignoreAttributes?{}:Tae(t,e.plugins));return r.aria=Object.assign({},_a.aria,r.aria),r.aria={expanded:r.aria.expanded==="auto"?e.interactive:r.aria.expanded,content:r.aria.content==="auto"?e.interactive?null:"describedby":r.aria.content},r}var jae=function(){return"innerHTML"};function Ok(t,e){t[jae()]=e}function iM(t){var e=Jh();return t===!0?e.className=mI:(e.className=gI,Ax(t)?e.appendChild(t):Ok(e,t)),e}function aM(t,e){Ax(e.content)?(Ok(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?Ok(t,e.content):t.textContent=e.content)}function Ik(t){var e=t.firstElementChild,r=Ey(e.children);return{box:e,content:r.find(function(n){return n.classList.contains(pI)}),arrow:r.find(function(n){return n.classList.contains(mI)||n.classList.contains(gI)}),backdrop:r.find(function(n){return n.classList.contains(lae)})}}function wI(t){var e=Jh(),r=Jh();r.className=oae,r.setAttribute("data-state","hidden"),r.setAttribute("tabindex","-1");var n=Jh();n.className=pI,n.setAttribute("data-state","hidden"),aM(n,t.props),e.appendChild(r),r.appendChild(n),i(t.props,t.props);function i(a,s){var o=Ik(e),l=o.box,c=o.content,u=o.arrow;s.theme?l.setAttribute("data-theme",s.theme):l.removeAttribute("data-theme"),typeof s.animation=="string"?l.setAttribute("data-animation",s.animation):l.removeAttribute("data-animation"),s.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof s.maxWidth=="number"?s.maxWidth+"px":s.maxWidth,s.role?l.setAttribute("role",s.role):l.removeAttribute("role"),(a.content!==s.content||a.allowHTML!==s.allowHTML)&&aM(c,t.props),s.arrow?u?a.arrow!==s.arrow&&(l.removeChild(u),l.appendChild(iM(s.arrow))):l.appendChild(iM(s.arrow)):u&&l.removeChild(u)}return{popper:e,onUpdate:i}}wI.$$tippy=!0;var Mae=1,cv=[],NS=[];function Pae(t,e){var r=nM(t,Object.assign({},_a,bI(Z9(e)))),n,i,a,s=!1,o=!1,l=!1,c=!1,u,f,h,m=[],v=Q9(ue,r.interactiveDebounce),y,x=Mae++,b=null,S=uae(r.plugins),w={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},k={id:x,reference:t,popper:Jh(),popperInstance:b,props:r,state:w,plugins:S,clearDelayTimeouts:ct,setProps:xt,setContent:bt,show:Et,hide:Je,hideWithInteractivity:De,enable:Oe,disable:rt,unmount:ve,destroy:H};if(!r.render)return k;var N=r.render(k),j=N.popper,T=N.onUpdate;j.setAttribute("data-tippy-root",""),j.id="tippy-"+k.id,k.popper=j,t._tippy=k,j._tippy=k;var M=S.map(function(J){return J.fn(k)}),A=t.hasAttribute("aria-expanded");return Y(),K(),U(),F("onCreate",[k]),r.showOnCreate&&Ve(),j.addEventListener("mouseenter",function(){k.props.interactive&&k.state.isVisible&&k.clearDelayTimeouts()}),j.addEventListener("mouseleave",function(){k.props.interactive&&k.props.trigger.indexOf("mouseenter")>=0&&$().addEventListener("mousemove",v)}),k;function _(){var J=k.props.touch;return Array.isArray(J)?J:[J,0]}function D(){return _()[0]==="hold"}function R(){var J;return!!((J=k.props.render)!=null&&J.$$tippy)}function I(){return y||t}function $(){var J=I().parentNode;return J?gae(J):document}function B(){return Ik(j)}function z(J){return k.state.isMounted&&!k.state.isVisible||ns.isTouch||u&&u.type==="focus"?0:SS(k.props.delay,J?0:1,_a.delay)}function U(J){J===void 0&&(J=!1),j.style.pointerEvents=k.props.interactive&&!J?"":"none",j.style.zIndex=""+k.props.zIndex}function F(J,ae,le){if(le===void 0&&(le=!0),M.forEach(function(xe){xe[J]&&xe[J].apply(xe,ae)}),le){var fe;(fe=k.props)[J].apply(fe,ae)}}function Q(){var J=k.props.aria;if(J.content){var ae="aria-"+J.content,le=j.id,fe=qu(k.props.triggerTarget||t);fe.forEach(function(xe){var ye=xe.getAttribute(ae);if(k.state.isVisible)xe.setAttribute(ae,ye?ye+" "+le:le);else{var Te=ye&&ye.replace(le,"").trim();Te?xe.setAttribute(ae,Te):xe.removeAttribute(ae)}})}}function K(){if(!(A||!k.props.aria.expanded)){var J=qu(k.props.triggerTarget||t);J.forEach(function(ae){k.props.interactive?ae.setAttribute("aria-expanded",k.state.isVisible&&ae===I()?"true":"false"):ae.removeAttribute("aria-expanded")})}}function L(){$().removeEventListener("mousemove",v),cv=cv.filter(function(J){return J!==v})}function G(J){if(!(ns.isTouch&&(l||J.type==="mousedown"))){var ae=J.composedPath&&J.composedPath()[0]||J.target;if(!(k.props.interactive&&tM(j,ae))){if(qu(k.props.triggerTarget||t).some(function(le){return tM(le,ae)})){if(ns.isTouch||k.state.isVisible&&k.props.trigger.indexOf("click")>=0)return}else F("onClickOutside",[k,J]);k.props.hideOnClick===!0&&(k.clearDelayTimeouts(),k.hide(),o=!0,setTimeout(function(){o=!1}),k.state.isMounted||de())}}}function ee(){l=!0}function re(){l=!1}function se(){var J=$();J.addEventListener("mousedown",G,!0),J.addEventListener("touchend",G,dc),J.addEventListener("touchstart",re,dc),J.addEventListener("touchmove",ee,dc)}function de(){var J=$();J.removeEventListener("mousedown",G,!0),J.removeEventListener("touchend",G,dc),J.removeEventListener("touchstart",re,dc),J.removeEventListener("touchmove",ee,dc)}function W(J,ae){ie(J,function(){!k.state.isVisible&&j.parentNode&&j.parentNode.contains(j)&&ae()})}function ne(J,ae){ie(J,ae)}function ie(J,ae){var le=B().box;function fe(xe){xe.target===le&&(CS(le,"remove",fe),ae())}if(J===0)return ae();CS(le,"remove",f),CS(le,"add",fe),f=fe}function V(J,ae,le){le===void 0&&(le=!1);var fe=qu(k.props.triggerTarget||t);fe.forEach(function(xe){xe.addEventListener(J,ae,le),m.push({node:xe,eventType:J,handler:ae,options:le})})}function Y(){D()&&(V("touchstart",Z,{passive:!0}),V("touchend",ge,{passive:!0})),cae(k.props.trigger).forEach(function(J){if(J!=="manual")switch(V(J,Z),J){case"mouseenter":V("mouseleave",ge);break;case"focus":V(Sae?"focusout":"blur",Ue);break;case"focusin":V("focusout",Ue);break}})}function te(){m.forEach(function(J){var ae=J.node,le=J.eventType,fe=J.handler,xe=J.options;ae.removeEventListener(le,fe,xe)}),m=[]}function Z(J){var ae,le=!1;if(!(!k.state.isEnabled||Pe(J)||o)){var fe=((ae=u)==null?void 0:ae.type)==="focus";u=J,y=J.currentTarget,K(),!k.state.isVisible&&hae(J)&&cv.forEach(function(xe){return xe(J)}),J.type==="click"&&(k.props.trigger.indexOf("mouseenter")<0||s)&&k.props.hideOnClick!==!1&&k.state.isVisible?le=!0:Ve(J),J.type==="click"&&(s=!le),le&&!fe&&We(J)}}function ue(J){var ae=J.target,le=I().contains(ae)||j.contains(ae);if(!(J.type==="mousemove"&&le)){var fe=Re().concat(j).map(function(xe){var ye,Te=xe._tippy,je=(ye=Te.popperInstance)==null?void 0:ye.state;return je?{popperRect:xe.getBoundingClientRect(),popperState:je,props:r}:null}).filter(Boolean);vae(fe,J)&&(L(),We(J))}}function ge(J){var ae=Pe(J)||k.props.trigger.indexOf("click")>=0&&s;if(!ae){if(k.props.interactive){k.hideWithInteractivity(J);return}We(J)}}function Ue(J){k.props.trigger.indexOf("focusin")<0&&J.target!==I()||k.props.interactive&&J.relatedTarget&&j.contains(J.relatedTarget)||We(J)}function Pe(J){return ns.isTouch?D()!==J.type.indexOf("touch")>=0:!1}function ze(){Ge();var J=k.props,ae=J.popperOptions,le=J.placement,fe=J.offset,xe=J.getReferenceClientRect,ye=J.moveTransition,Te=R()?Ik(j).arrow:null,je=xe?{getBoundingClientRect:xe,contextElement:xe.contextElement||I()}:t,He={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Ie){var nt=Ie.state;if(R()){var st=B(),Kt=st.box;["placement","reference-hidden","escaped"].forEach(function(Ot){Ot==="placement"?Kt.setAttribute("data-placement",nt.placement):nt.attributes.popper["data-popper-"+Ot]?Kt.setAttribute("data-"+Ot,""):Kt.removeAttribute("data-"+Ot)}),nt.attributes.popper={}}}},et=[{name:"offset",options:{offset:fe}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!ye}},He];R()&&Te&&et.push({name:"arrow",options:{element:Te,padding:3}}),et.push.apply(et,(ae==null?void 0:ae.modifiers)||[]),k.popperInstance=sae(je,j,Object.assign({},ae,{placement:le,onFirstUpdate:h,modifiers:et}))}function Ge(){k.popperInstance&&(k.popperInstance.destroy(),k.popperInstance=null)}function Ce(){var J=k.props.appendTo,ae,le=I();k.props.interactive&&J===vI||J==="parent"?ae=le.parentNode:ae=yI(J,[le]),ae.contains(j)||ae.appendChild(j),k.state.isMounted=!0,ze()}function Re(){return Ey(j.querySelectorAll("[data-tippy-root]"))}function Ve(J){k.clearDelayTimeouts(),J&&F("onTrigger",[k,J]),se();var ae=z(!0),le=_(),fe=le[0],xe=le[1];ns.isTouch&&fe==="hold"&&xe&&(ae=xe),ae?n=setTimeout(function(){k.show()},ae):k.show()}function We(J){if(k.clearDelayTimeouts(),F("onUntrigger",[k,J]),!k.state.isVisible){de();return}if(!(k.props.trigger.indexOf("mouseenter")>=0&&k.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(J.type)>=0&&s)){var ae=z(!1);ae?i=setTimeout(function(){k.state.isVisible&&k.hide()},ae):a=requestAnimationFrame(function(){k.hide()})}}function Oe(){k.state.isEnabled=!0}function rt(){k.hide(),k.state.isEnabled=!1}function ct(){clearTimeout(n),clearTimeout(i),cancelAnimationFrame(a)}function xt(J){if(!k.state.isDestroyed){F("onBeforeUpdate",[k,J]),te();var ae=k.props,le=nM(t,Object.assign({},ae,Z9(J),{ignoreAttributes:!0}));k.props=le,Y(),ae.interactiveDebounce!==le.interactiveDebounce&&(L(),v=Q9(ue,le.interactiveDebounce)),ae.triggerTarget&&!le.triggerTarget?qu(ae.triggerTarget).forEach(function(fe){fe.removeAttribute("aria-expanded")}):le.triggerTarget&&t.removeAttribute("aria-expanded"),K(),U(),T&&T(ae,le),k.popperInstance&&(ze(),Re().forEach(function(fe){requestAnimationFrame(fe._tippy.popperInstance.forceUpdate)})),F("onAfterUpdate",[k,J])}}function bt(J){k.setProps({content:J})}function Et(){var J=k.state.isVisible,ae=k.state.isDestroyed,le=!k.state.isEnabled,fe=ns.isTouch&&!k.props.touch,xe=SS(k.props.duration,0,_a.duration);if(!(J||ae||le||fe)&&!I().hasAttribute("disabled")&&(F("onShow",[k],!1),k.props.onShow(k)!==!1)){if(k.state.isVisible=!0,R()&&(j.style.visibility="visible"),U(),se(),k.state.isMounted||(j.style.transition="none"),R()){var ye=B(),Te=ye.box,je=ye.content;kS([Te,je],0)}h=function(){var et;if(!(!k.state.isVisible||c)){if(c=!0,j.offsetHeight,j.style.transition=k.props.moveTransition,R()&&k.props.animation){var tt=B(),Ie=tt.box,nt=tt.content;kS([Ie,nt],xe),eM([Ie,nt],"visible")}Q(),K(),J9(NS,k),(et=k.popperInstance)==null||et.forceUpdate(),F("onMount",[k]),k.props.animation&&R()&&ne(xe,function(){k.state.isShown=!0,F("onShown",[k])})}},Ce()}}function Je(){var J=!k.state.isVisible,ae=k.state.isDestroyed,le=!k.state.isEnabled,fe=SS(k.props.duration,1,_a.duration);if(!(J||ae||le)&&(F("onHide",[k],!1),k.props.onHide(k)!==!1)){if(k.state.isVisible=!1,k.state.isShown=!1,c=!1,s=!1,R()&&(j.style.visibility="hidden"),L(),de(),U(!0),R()){var xe=B(),ye=xe.box,Te=xe.content;k.props.animation&&(kS([ye,Te],fe),eM([ye,Te],"hidden"))}Q(),K(),k.props.animation?R()&&W(fe,k.unmount):k.unmount()}}function De(J){$().addEventListener("mousemove",v),J9(cv,v),v(J)}function ve(){k.state.isVisible&&k.hide(),k.state.isMounted&&(Ge(),Re().forEach(function(J){J._tippy.unmount()}),j.parentNode&&j.parentNode.removeChild(j),NS=NS.filter(function(J){return J!==k}),k.state.isMounted=!1,F("onHidden",[k]))}function H(){k.state.isDestroyed||(k.clearDelayTimeouts(),k.unmount(),te(),delete t._tippy,k.state.isDestroyed=!0,F("onDestroy",[k]))}}function gm(t,e){e===void 0&&(e={});var r=_a.plugins.concat(e.plugins||[]);bae();var n=Object.assign({},e,{plugins:r}),i=mae(t),a=i.reduce(function(s,o){var l=o&&Pae(o,n);return l&&s.push(l),s},[]);return Ax(t)?a[0]:a}gm.defaultProps=_a;gm.setDefaultProps=Eae;gm.currentInput=ns;Object.assign({},sI,{effect:function(e){var r=e.state,n={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(r.elements.popper.style,n.popper),r.styles=n,r.elements.arrow&&Object.assign(r.elements.arrow.style,n.arrow)}});gm.setDefaultProps({render:wI});const _ae=q.forwardRef((t,e)=>{const[r,n]=q.useState(0),i=l=>{const c=t.items[l];c&&t.command({id:c.id,label:c.label})},a=()=>{n((r+t.items.length-1)%t.items.length)},s=()=>{n((r+1)%t.items.length)},o=()=>{i(r)};return q.useEffect(()=>n(0),[t.items]),q.useImperativeHandle(e,()=>({onKeyDown:({event:l})=>l.key==="ArrowUp"?(a(),!0):l.key==="ArrowDown"?(s(),!0):l.key==="Enter"?(o(),!0):!1})),d.jsx("div",{className:"items bg-popover border border-border rounded-md shadow-lg overflow-hidden min-w-[200px] p-1",children:t.items.length?t.items.map((l,c)=>d.jsx("button",{className:`flex w-full items-center text-sm px-2 py-1.5 rounded-sm outline-none text-left ${c===r?"bg-accent text-accent-foreground":"text-popover-foreground"}`,onClick:()=>i(c),children:l.label},c)):d.jsx("div",{className:"item text-sm px-2 py-1.5 text-muted-foreground",children:"No result"})})}),Aae={items:async({query:t})=>{try{return(await Ne.get("/world-bible/entities")).filter(r=>r.nombre.toLowerCase().startsWith(t.toLowerCase())).slice(0,5).map(r=>({id:r.id,label:r.nombre}))}catch(e){return console.error(e),[]}},render:()=>{let t,e;return{onStart:r=>{t=new fre(_ae,{props:r,editor:r.editor}),r.clientRect&&(e=gm("body",{getReferenceClientRect:r.clientRect,appendTo:()=>document.body,content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(r){t.updateProps(r),r.clientRect&&e[0].setProps({getReferenceClientRect:r.clientRect})},onKeyDown(r){var n;return r.event.key==="Escape"?(e[0].hide(),!0):(n=t.ref)==null?void 0:n.onKeyDown(r)},onExit(){e[0].destroy(),t.destroy()}}}},Rae=({content:t,onUpdate:e,editable:r=!0})=>{const n=are({extensions:[Kne,Yne.configure({placeholder:"Escribe tu historia aqu... Usa @ para mencionar entidades."}),tie.configure({HTMLAttributes:{class:"mention"},suggestion:Aae})],content:t,editable:r,onUpdate:({editor:i})=>{e(i.getHTML())},editorProps:{attributes:{class:"prose prose-invert max-w-none focus:outline-none min-h-[300px] p-4 text-foreground/90 leading-relaxed font-serif text-lg"}}});return q.useEffect(()=>{n&&t!==n.getHTML()&&n.commands.setContent(t)},[t,n]),n?d.jsxs("div",{className:"zen-editor-container w-full h-full overflow-y-auto no-scrollbar bg-card/20 rounded-lg border border-border/50",children:[d.jsx(Jte,{editor:n,className:"h-full"}),d.jsx("style",{jsx:!0,global:!0,children:`
        .mention {
          @apply bg-primary/20 text-primary-light font-medium rounded-sm px-1 py-0.5 cursor-pointer hover:bg-primary/30 decoration-clone;
        }
        .tiptap p.is-editor-empty:first-child::before {
          color: #6b7280;
          content: attr(data-placeholder);
          float: left;
          height: 0;
          pointer-events: none;
        }
      `})]}):null},Lk=({isOpen:t,onClose:e,onConfirm:r,title:n,message:i,initialValue:a="",placeholder:s="",confirmText:o="Confirmar",cancelText:l="Cancelar"})=>{const[c,u]=q.useState(a),f=q.useRef(null);if(q.useEffect(()=>{u(a)},[a,t]),q.useEffect(()=>{t&&f.current&&setTimeout(()=>f.current.focus(),50)},[t]),!t)return null;const h=m=>{m.preventDefault(),r(c),e()};return ds.createPortal(d.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-md animate-in fade-in duration-300",children:d.jsxs("div",{className:"bg-[#0f0f13] border border-white/10 rounded-2xl p-6 shadow-2xl shadow-black/50 w-full max-w-md space-y-5 animate-in zoom-in-95 slide-in-from-bottom-2 duration-300 relative overflow-hidden ring-1 ring-white/5",onClick:m=>m.stopPropagation(),children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-primary to-transparent opacity-70"}),d.jsx("div",{className:"absolute -top-10 -right-10 size-40 bg-primary/5 rounded-full blur-3xl pointer-events-none"}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-bold text-white tracking-tight",children:n}),i&&d.jsx("p",{className:"text-sm text-slate-400 leading-relaxed mt-2",children:i})]}),d.jsxs("form",{onSubmit:h,className:"space-y-6",children:[d.jsx("input",{ref:f,type:"text",value:c,onChange:m=>u(m.target.value),placeholder:s,className:"w-full bg-black/30 border border-white/10 rounded-xl px-4 py-3.5 text-white placeholder-slate-600 focus:border-primary/50 focus:ring-1 focus:ring-primary/50 outline-none transition-all font-sans text-sm shadow-inner"}),d.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[d.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors",children:l}),d.jsx(Wt,{type:"submit",variant:"primary",disabled:!c.trim(),children:o})]})]})]})}),document.body)},Dae=({notebooks:t,loading:e,onSelectNotebook:r,onCreateNotebook:n,onDeleteNotebook:i,onUpdateNotebook:a})=>{const[s,o]=q.useState(!1),[l,c]=q.useState(null),[u,f]=q.useState(null),h=y=>{n(y)},m=()=>{l&&(i(l.id),c(null))},v=y=>{u&&(a(u.id,y,u.descripcion),f(null))};return d.jsxs("div",{className:"p-8 w-full h-full overflow-y-auto",children:[d.jsxs("div",{className:"max-w-7xl mx-auto",children:[d.jsxs("header",{className:"flex justify-between items-center mb-12",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-4xl font-serif text-slate-200 mb-2",children:"Your Notebooks"}),d.jsx("p",{className:"text-slate-500 font-mono text-sm",children:"Select a chronicle to begin writing"})]}),d.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl transition-all shadow-lg shadow-indigo-500/20",children:[d.jsx("span",{className:"material-symbols-outlined",children:"add"}),d.jsx("span",{className:"font-bold tracking-wide text-sm",children:"NEW NOTEBOOK"})]})]}),e?d.jsx("div",{className:"text-slate-500",children:"Loading chronicles..."}):d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.map(y=>d.jsxs("div",{onClick:()=>r(y),className:"group relative bg-[#050508] border border-white/10 rounded-2xl p-6 cursor-pointer hover:border-indigo-500/50 hover:shadow-2xl hover:shadow-indigo-900/10 transition-all duration-300 h-64 flex flex-col",children:[d.jsxs("div",{className:"flex-1 relative",children:[d.jsxs("div",{className:"flex justify-between items-start",children:[d.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/5 flex items-center justify-center text-slate-400 group-hover:bg-indigo-500/10 group-hover:text-indigo-400 transition-colors mb-6",children:d.jsx("span",{className:"material-symbols-outlined text-2xl",children:"menu_book"})}),d.jsxs("div",{className:"flex items-center gap-1 transition-opacity duration-200",children:[d.jsx("button",{onClick:x=>{x.stopPropagation(),f(y)},className:"p-2 text-slate-500 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-all",title:"Rename Notebook",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit"})}),d.jsx("button",{onClick:x=>{x.stopPropagation(),c(y)},className:"p-2 text-slate-500 hover:text-red-500 hover:bg-red-500/10 rounded-lg transition-all",title:"Delete Notebook",children:d.jsx("span",{className:"material-symbols-outlined text-xl",children:"delete"})})]})]}),d.jsx("h3",{className:"text-xl font-serif text-slate-200 group-hover:text-white mb-2 line-clamp-2",children:y.titulo}),d.jsx("p",{className:"text-slate-500 text-sm line-clamp-3",children:y.descripcion||"No description"})]}),d.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 flex justify-between items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[d.jsx("span",{className:"text-xs font-mono text-slate-500",children:"OPEN CHRONICLE"}),d.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"arrow_forward"})]})]},y.id)),d.jsxs("button",{onClick:()=>o(!0),className:"border-2 border-dashed border-white/5 rounded-2xl p-6 h-64 flex flex-col items-center justify-center gap-4 text-slate-600 hover:text-slate-400 hover:border-white/10 transition-all",children:[d.jsx("span",{className:"material-symbols-outlined text-4xl",children:"add"}),d.jsx("span",{className:"font-mono text-xs uppercase tracking-widest",children:"Create New"})]})]})]}),d.jsx(Lk,{isOpen:s,onClose:()=>o(!1),onConfirm:h,title:"New Notebook",message:"Give a title to your new chronicle.",placeholder:"Ex: The Lost Kingdom",confirmText:"Create Notebook"}),d.jsx(Lk,{isOpen:!!u,onClose:()=>f(null),onConfirm:v,title:"Rename Notebook",message:`Enter a new title for "${u==null?void 0:u.titulo}".`,placeholder:u==null?void 0:u.titulo,confirmText:"Update"}),d.jsx(MA,{isOpen:!!l,onClose:()=>c(null),onConfirm:m,title:"Delete Notebook?",message:`Are you sure you want to delete "${l==null?void 0:l.titulo}"? This action cannot be undone and will delete all pages inside.`,confirmText:"Delete Forever",isDestructive:!0})]})},Oae=()=>{const{setRightPanelMode:t,setRightOpen:e,setRightPanelTitle:r}=jl(),[n,i]=q.useState("dashboard"),[a,s]=q.useState(null),[o,l]=q.useState([]),[c,u]=q.useState(0),[f,h]=q.useState(!1),m=q.useRef(null),[v,y]=q.useState([]),[x,b]=q.useState(!0),[S,w]=q.useState(null);q.useEffect(()=>{t("NOTES"),k()},[]),q.useEffect(()=>{const F=setInterval(()=>{const Q=document.getElementById("architect-right-panel-portal");Q&&(w(Q),clearInterval(F))},100);return()=>clearInterval(F)},[n]);const k=async()=>{try{b(!0);const F=await Ne.get("/escritura/cuadernos");y(F)}catch(F){console.error("Error loading notebooks:",F)}finally{b(!1)}},N=async F=>{try{const Q=await Ne.post("/escritura/cuaderno",{titulo:F});y([...v,Q])}catch(Q){console.error(Q),alert("Error creating notebook")}},j=async F=>{try{await Ne.delete(`/escritura/cuaderno/${F}`),y(v.filter(Q=>Q.id!==F))}catch(Q){console.error(Q),alert("Error deleting notebook")}},T=async(F,Q,K)=>{try{const L=await Ne.put(`/escritura/cuaderno/${F}`,{titulo:Q,descripcion:K});y(v.map(G=>G.id===F?L:G))}catch(L){console.error(L),alert("Error updating notebook")}},M=async F=>{s(F),await _(F.id),i("editor")},A=()=>{i("dashboard"),s(null),l([])},_=async F=>{try{const Q=await Ne.get(`/escritura/cuaderno/${F}/hojas`);if(Q&&Q.length>0)l(Q),u(0);else{const K=await Ne.post(`/escritura/cuaderno/${F}/hoja`,{});l([K]),u(0)}}catch(Q){console.error("Error loading pages:",Q),l([])}},D=F=>{if(!o[c])return;const Q=[...o];Q[c].contenido=F,l(Q),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{R(Q[c])},1500)},R=async F=>{h(!0);try{await Ne.put(`/escritura/hoja/${F.id}`,{contenido:F.contenido})}catch(Q){console.error("Error saving page:",Q)}finally{h(!1)}},I=async()=>{if(a)try{const F=await Ne.post(`/escritura/cuaderno/${a.id}/hoja`,{});l([...o,F]),u(o.length)}catch(F){console.error("Error creating page:",F)}},$=F=>{u(F)},B=()=>d.jsxs("div",{className:"flex flex-col h-full bg-[#08080A]",children:[d.jsxs("div",{className:"h-12 border-b border-white/5 flex items-center px-4 font-mono text-[10px] uppercase tracking-widest text-slate-500 whitespace-nowrap overflow-hidden text-ellipsis",children:["Library  ",v.length," Notebooks"]}),d.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:v.map(F=>d.jsx("button",{onClick:()=>M(F),className:"w-full text-left p-3 rounded-lg border-b border-white/5 hover:bg-white/5 transition-all group",children:d.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[d.jsx("div",{className:"text-slate-500 group-hover:text-indigo-400 transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-lg",children:"book"})}),d.jsx("span",{className:"font-serif font-bold text-sm text-slate-300 group-hover:text-white truncate",children:F.titulo})]})},F.id))})]}),z=()=>d.jsxs("div",{className:"flex flex-col h-full bg-[#08080A]",children:[d.jsxs("div",{className:"h-12 border-b border-white/5 flex items-center px-4 font-mono text-[10px] uppercase tracking-widest text-slate-500 whitespace-nowrap overflow-hidden text-ellipsis",children:["Index  ",o.length," Pages"]}),d.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 custom-scrollbar",children:o.map((F,Q)=>{var K;return d.jsxs("button",{onClick:()=>$(Q),className:`w-full text-left p-3 rounded-lg border transition-all group ${Q===c?"bg-indigo-500/10 border-indigo-500/30 text-indigo-200":"bg-transparent border-transparent hover:bg-white/5 text-slate-400"}`,children:[d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsxs("span",{className:"font-serif font-bold text-sm truncate",children:["Page ",F.numeroPagina]}),Q===c&&d.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 shrink-0 ml-2"})]}),d.jsx("p",{className:"text-[10px] line-clamp-2 opacity-50 font-mono break-words",children:((K=F.contenido)==null?void 0:K.replace(/<[^>]+>/g,"").substring(0,50))||"Empty page..."})]},F.id)})}),d.jsx("div",{className:"p-4 border-t border-white/5",children:d.jsxs("button",{onClick:I,className:"w-full py-2 bg-white/5 hover:bg-white/10 border border-white/5 rounded-lg text-[10px] font-black uppercase tracking-widest text-slate-300 flex items-center justify-center gap-2 transition-all",children:[d.jsx("span",{className:"material-symbols-outlined text-base",children:"add"}),d.jsx("span",{children:"New Page"})]})})]}),U=o[c];return n==="dashboard"?d.jsxs(d.Fragment,{children:[S&&ds.createPortal(B(),S),d.jsx(Dae,{notebooks:v,loading:x,onSelectNotebook:M,onCreateNotebook:N,onDeleteNotebook:j,onUpdateNotebook:T})]}):d.jsxs("div",{className:"flex-1 flex w-full h-full bg-[#050508] relative overflow-hidden",children:[S&&ds.createPortal(z(),S),d.jsxs("div",{className:"flex-1 flex flex-col relative z-10 transition-all duration-300",children:[d.jsxs("header",{className:"h-12 border-b border-white/5 bg-surface-dark/40 backdrop-blur-md flex items-center justify-between px-6 select-none",children:[d.jsxs("div",{className:"flex items-center gap-4 text-xs font-serif text-slate-400",children:[d.jsxs("button",{onClick:A,className:"hover:text-white transition-colors flex items-center gap-1",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"}),"Dashboard"]}),d.jsx("span",{className:"opacity-20",children:"|"}),d.jsx("span",{className:"text-slate-300 font-bold tracking-wide",children:a==null?void 0:a.titulo}),d.jsx("span",{className:"opacity-20",children:"|"}),d.jsx("span",{children:new Date().toLocaleDateString()})]}),d.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-slate-500",children:[d.jsx("span",{children:(a==null?void 0:a.nombreProyecto)||"Workspace"}),d.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${f?"bg-amber-500 animate-pulse":"bg-emerald-500/50"}`})]})]}),d.jsx("main",{className:"flex-1 overflow-y-auto custom-scrollbar flex justify-center bg-[#101012] relative",children:U&&d.jsxs("div",{className:"w-full max-w-3xl py-12 px-8 min-h-full flex flex-col",children:[d.jsx("input",{type:"text",placeholder:"Untitled Page",className:"w-full bg-transparent text-4xl font-serif font-bold text-slate-200 placeholder:text-slate-700 border-none outline-none mb-8 text-center",defaultValue:`Page ${U.numeroPagina}`,readOnly:!0}),d.jsx("div",{className:"flex-1 bg-white/5 border border-white/5 rounded-sm shadow-2xl shadow-black/50 overflow-hidden relative",children:d.jsx(Rae,{content:U.contenido,onUpdate:D})})]})})]})]})};function Iae(){const{id:t}=Bi();Li();const[e,r]=q.useState([]),[n,i]=q.useState(!0),[a,s]=q.useState(null);q.useEffect(()=>{o()},[t]);const o=async()=>{try{i(!0);const u=await Ne.get("/api/papelera/items");r(u),s(null)}catch(u){console.error("Error loading trash:",u),s("Failed to load trash items.")}finally{i(!1)}},l=async(u,f)=>{try{await Ne.post(`/api/papelera/restaurar/${u}/${f}`),o()}catch(h){console.error("Restoration failed",h)}},c=async(u,f)=>{if(window.confirm("Are you sure you want to PERMANENTLY delete this item? This cannot be undone."))try{await Ne.delete(`/api/papelera/eliminar/${u}/${f}`),o()}catch(h){console.error("Deletion failed",h)}};return n?d.jsx("div",{className:"text-white p-8",children:"Loading Trash Bin..."}):d.jsxs("div",{className:"flex flex-col h-full bg-[#09090b] text-white p-8 overflow-y-auto",children:[d.jsx("h1",{className:"text-3xl font-light mb-2 text-white/90",children:"Trash Bin"}),d.jsx("p",{className:"text-white/50 mb-8 font-light text-sm",children:"Items are automatically deleted after 30 days."}),a&&d.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 p-4 rounded mb-6",children:a}),e.length===0?d.jsxs("div",{className:"flex flex-col items-center justify-center py-20 opacity-50 border border-dashed border-white/10 rounded-xl",children:[d.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"delete_outline"}),d.jsx("p",{children:"Trash is empty"})]}):d.jsx("div",{className:"bg-zinc-900/50 rounded-xl border border-white/5 overflow-hidden",children:d.jsxs("table",{className:"w-full text-left border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"border-b border-white/5 text-xs text-white/40 uppercase tracking-wider",children:[d.jsx("th",{className:"p-4 font-normal",children:"Name"}),d.jsx("th",{className:"p-4 font-normal",children:"Type"}),d.jsx("th",{className:"p-4 font-normal",children:"Deleted Date"}),d.jsx("th",{className:"p-4 font-normal text-right",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-white/5",children:e.map(u=>d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"p-4 text-white/80 font-medium",children:u.nombre||"Untitled"}),d.jsx("td",{className:"p-4 text-white/50 text-sm",children:u.tipo}),d.jsx("td",{className:"p-4 text-white/50 text-sm font-mono",children:u.deleted_date?new Date(u.deleted_date).toLocaleDateString():"-"}),d.jsxs("td",{className:"p-4 text-right space-x-2",children:[d.jsx("button",{onClick:()=>l(u.tipo,u.id),className:"px-3 py-1.5 text-xs bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20 rounded-md transition-colors border border-emerald-500/20",children:"RESTORE"}),d.jsx("button",{onClick:()=>c(u.tipo,u.id),className:"px-3 py-1.5 text-xs bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-md transition-colors border border-red-500/20",children:"DELETE"})]})]},`${u.tipo}-${u.id}`))})]})})]})}const Lae=({attribute:t,value:e,onChange:r,onRemove:n,linkableEntities:i=[]})=>{const a=t.plantilla||t,s=()=>{switch(a.tipo){case"text":return d.jsx("textarea",{className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none resize-none no-scrollbar h-auto min-h-[100px]",value:e||"",onChange:h=>r(h.target.value),placeholder:"..."});case"short_text":return d.jsx("input",{type:"text",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none",value:e||"",onChange:h=>r(h.target.value),placeholder:"..."});case"number":return d.jsx("input",{type:"number",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none",value:e||"",onChange:h=>r(h.target.value)});case"boolean":return d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("button",{onClick:()=>r(e==="true"?"false":"true"),className:`size-6 rounded-lg border flex items-center justify-center transition-all ${e==="true"?"bg-primary border-primary text-white":"border-glass-border text-transparent hover:border-primary/50"}`,children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"check"})}),d.jsx("span",{className:"text-xs text-text-muted",children:e==="true"?"Enabled":"Disabled"})]});case"select":let o=[];try{o=(typeof a.metadata=="string"?JSON.parse(a.metadata||"{}"):a.metadata||{}).options||[]}catch{}return d.jsxs("div",{className:"relative",children:[d.jsxs("select",{className:"w-full bg-black/30 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-primary/50 appearance-none cursor-pointer",value:e||"",onChange:h=>r(h.target.value),children:[d.jsx("option",{value:"",children:"Select an option..."}),o.map((h,m)=>d.jsx("option",{value:h,className:"bg-surface-dark text-white p-2",children:h},m))]}),d.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/50",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"unfold_more"})})]});case"multi_select":let l=[];try{l=(typeof a.metadata=="string"?JSON.parse(a.metadata||"{}"):a.metadata||{}).options||[]}catch{}let c=[];try{c=e?JSON.parse(e):[],Array.isArray(c)||(c=[])}catch(h){console.error("Error parsing select values",h)}const u=h=>{const m=c.includes(h)?c.filter(v=>v!==h):[...c,h];r(JSON.stringify(m))};return d.jsxs("div",{className:"bg-black/20 border border-white/5 rounded-xl p-2 space-y-1 max-h-40 overflow-y-auto custom-scrollbar",children:[l.map((h,m)=>d.jsxs("label",{onClick:v=>{v.preventDefault(),u(h)},className:"flex items-center gap-3 p-2 hover:bg-white/5 rounded-lg cursor-pointer group transition-colors",children:[d.jsx("div",{className:`size-4 rounded border flex items-center justify-center transition-all ${c.includes(h)?"bg-primary border-primary":"border-white/10 group-hover:border-white/30"}`,children:c.includes(h)&&d.jsx("span",{className:"material-symbols-outlined text-[10px] text-white",children:"check"})}),d.jsx("span",{className:`text-xs font-medium ${c.includes(h)?"text-white":"text-slate-400 group-hover:text-slate-200"}`,children:h})]},m)),l.length===0&&d.jsx("div",{className:"text-xs text-slate-500 p-2 italic",children:"No options defined."})]});case"date":return d.jsx("input",{type:"date",className:"w-full bg-transparent text-white text-sm font-medium focus:outline-none [color-scheme:dark]",value:e||"",onChange:h=>r(h.target.value)});case"entity_link":return d.jsxs("div",{className:"relative",children:[d.jsxs("select",{className:"w-full bg-black/30 border border-white/5 rounded-xl px-4 py-2.5 text-sm text-white focus:outline-none focus:border-primary/50 appearance-none cursor-pointer",value:e||"",onChange:h=>r(h.target.value),children:[d.jsx("option",{value:"",children:"Select an Entity Link..."}),i.map(h=>d.jsx("option",{value:h.id,className:"bg-surface-dark text-white p-2",children:h.nombre},h.id))]}),d.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-white/50",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"link"})})]});case"image":return d.jsxs("div",{className:"space-y-2",children:[d.jsx("div",{className:"flex gap-2",children:d.jsx("input",{type:"text",className:"flex-1 bg-black/30 border border-white/5 rounded-xl px-4 py-2 text-xs text-text-muted focus:text-white focus:outline-none",placeholder:"Image URL...",value:e||"",onChange:h=>r(h.target.value)})}),e&&d.jsx("div",{className:"w-full aspect-video rounded-xl bg-black/40 border border-white/5 overflow-hidden relative group",children:d.jsx("img",{src:e,alt:"Preview",className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"})}),!e&&d.jsx("div",{className:"w-full h-20 rounded-xl bg-white/5 border border-dashed border-white/10 flex items-center justify-center text-text-muted/30",children:d.jsx("span",{className:"material-symbols-outlined",children:"image"})})]});case"table":const f=e||"[]";return d.jsxs("div",{className:"space-y-2",children:[d.jsx("textarea",{className:"w-full h-32 bg-black/30 border border-white/5 rounded-xl p-3 text-xs font-mono text-white/70 focus:outline-none focus:border-primary/50",value:f,onChange:h=>r(h.target.value),placeholder:'[{"Item": "Sword", "Qty": 1}, ...]'}),d.jsxs("div",{className:"text-[10px] text-text-muted flex justify-between",children:[d.jsx("span",{children:"JSON Format supported"}),d.jsx("span",{className:"material-symbols-outlined text-xs",children:"data_array"})]})]});default:return d.jsxs("div",{className:"text-sm font-medium text-white/70 italic p-2 rounded-lg bg-white/5 border border-white/5",children:[d.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 mr-2",children:a.tipo}),e]})}};return d.jsxs("div",{className:"p-4 border border-white/5 rounded-2xl bg-surface-dark/50 backdrop-blur-sm relative overflow-hidden h-full flex flex-col group hover:border-primary/20 transition-all",children:[d.jsxs("label",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted mb-3 flex items-center justify-between gap-2",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-xs opacity-50",children:"label"}),a.nombre]}),n&&d.jsx("button",{onClick:o=>{o.preventDefault(),n()},className:"text-white/20 hover:text-red-400 transition-colors",title:"Remove Attribute",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]}),d.jsx("div",{className:"flex-1 nodrag",children:s()}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"})]})},Bae=[{value:"entidadIndividual",label:"Character"},{value:"entidadColectiva",label:"Group"},{value:"zona",label:"Location"},{value:"construccion",label:"Building"},{value:"efectos",label:"Effect"},{value:"interaccion",label:"Interaction"},{value:"lineatiempo",label:"Timeline"},{value:"eventotiempo",label:"Event"},{value:"mapa",label:"Map"}],Fae=({entityId:t,entityType:e})=>{const[r,n]=q.useState([]),[i,a]=q.useState(!1),[s,o]=q.useState(!1),[l,c]=q.useState("entidadIndividual"),[u,f]=q.useState([]),[h,m]=q.useState(""),[v,y]=q.useState(""),[x,b]=q.useState(""),[S,w]=q.useState(!1);q.useEffect(()=>{t&&k()},[t,e]),q.useEffect(()=>{s&&l&&N(l)},[s,l]);const k=async()=>{a(!0);try{const _=(await Ne.get("/bd/relacion")).filter(R=>R.nodoOrigenId===parseInt(t)&&R.tipoOrigen===e||R.nodoDestinoId===parseInt(t)&&R.tipoDestino===e),D=await Promise.all(_.map(async R=>{const I=R.nodoOrigenId===parseInt(t),$=I?R.nodoDestinoId:R.nodoOrigenId,B=I?R.tipoDestino:R.tipoOrigen;try{const z=await Ne.get(`/bd/${B}/${$}`);return{...R,otherName:z.nombre,otherType:B,isOutgoing:I}}catch{return{...R,otherName:"Unknown/Deleted",otherType:B,isOutgoing:I}}}));n(D)}catch(A){console.error("Failed to load relationships",A)}finally{a(!1)}},N=async A=>{w(!0);try{const _=await Ne.get(`/bd/${A}`);f(_||[])}catch(_){console.error("Failed to fetch targets",_),f([])}finally{w(!1)}},j=async()=>{if(!(!h||!v))try{const A={nodoOrigenId:parseInt(t),tipoOrigen:e,nodoDestinoId:parseInt(h),tipoDestino:l,tipoRelacion:v,descripcion:x,tipoEntidad:"relacion"};await Ne.put("/bd/insertar",A),o(!1),M(),k()}catch(A){console.error("Failed to save relationship",A),alert("Error saving relationship")}},T=async A=>{if(confirm("Are you sure?"))try{await Ne.delete(`/bd/relacion/${A}`),k()}catch(_){console.error("Failed to delete",_)}},M=()=>{c("entidadIndividual"),m(""),y(""),b("")};return d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("header",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-lg font-bold text-white uppercase tracking-widest",children:"Relationships"}),d.jsx(Wt,{variant:"secondary",icon:"add_link",onClick:()=>o(!s),children:s?"Cancel":"Connect"})]}),s&&d.jsxs("div",{className:"p-4 rounded-2xl bg-white/5 border border-white/10 space-y-4 animate-in fade-in slide-in-from-top-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Target Type"}),d.jsx("select",{className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:l,onChange:A=>c(A.target.value),children:Bae.map(A=>d.jsx("option",{value:A.value,children:A.label},A.value))})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Target Entity"}),d.jsxs("select",{className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:h,onChange:A=>m(A.target.value),disabled:S,children:[d.jsx("option",{value:"",children:"Select Target..."}),u.map(A=>d.jsx("option",{value:A.id,children:A.nombre},A.id))]})]})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Relationship Type"}),d.jsx("input",{type:"text",placeholder:"e.g. Father of, Located in, Enemy of...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary",value:v,onChange:A=>y(A.target.value)})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-500",children:"Description (The Why)"}),d.jsx("textarea",{placeholder:"Explain the nature of this connection...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-2 text-sm text-white outline-none focus:border-primary h-20 resize-none",value:x,onChange:A=>b(A.target.value)})]}),d.jsx("div",{className:"flex justify-end pt-2",children:d.jsx(Wt,{variant:"primary",icon:"save",onClick:j,disabled:!h||!v,children:"Save Connection"})})]}),d.jsx("div",{className:"space-y-3",children:i?d.jsx("div",{className:"text-center text-slate-500 py-8",children:"Scanning connections..."}):r.length===0?d.jsx("div",{className:"text-center text-slate-500 py-8 italic border border-dashed border-white/10 rounded-2xl",children:"No connections established"}):r.map((A,_)=>d.jsxs("div",{className:"group relative p-4 rounded-2xl bg-surface-dark border border-white/5 hover:border-primary/50 transition-all flex items-start gap-4",children:[d.jsx("div",{className:"mt-1",children:d.jsx("span",{className:"material-symbols-outlined text-slate-500",children:A.isOutgoing?"arrow_outward":"arrow_inward"})}),d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:A.isOutgoing?"To:":"From:"}),d.jsx("span",{className:"text-sm font-bold text-white",children:A.otherName}),d.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-white/10 text-slate-400 font-bold uppercase tracking-wider",children:A.otherType})]}),d.jsx("div",{className:"text-primary text-xs font-black uppercase tracking-widest mb-2",children:A.tipoRelacion}),A.descripcion&&d.jsxs("p",{className:"text-xs text-slate-400 leading-relaxed bg-black/20 p-2 rounded-lg border border-white/5",children:['"',A.descripcion,'"']})]}),d.jsx("button",{onClick:()=>T(A.id),className:"opacity-0 group-hover:opacity-100 p-2 text-slate-600 hover:text-red-400 transition-all",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]},A.id||_))})]})},uh=({mode:t})=>{const{username:e,projectName:r,entitySlug:n,folderSlug:i,type:a}=Bi(),s=Li(),o=t==="creation",{setRightOpen:l,setAvailableTemplates:c,setRightPanelMode:u,setAddAttributeHandler:f,setEntityTabs:h,activeEntityTab:m,setActiveEntityTab:v}=jl(),[y,x]=q.useState({nombre:"",tipo:"entidadindividual",descripcion:"",color:"#6366f1",apariencia:"",notas:"",iconUrl:null,tipoEspecial:a||null,carpeta:null,categoria:"Individual"}),[b,S]=q.useState([]),[w,k]=q.useState(!0),[N,j]=q.useState(!1),[T,M]=q.useState([]),[A,_]=q.useState([]),[D,R]=q.useState(!1);q.useEffect(()=>(l(!0),u("ENTITY"),h(["identity","narrative","attributes"]),v("identity"),()=>{u("NOTES"),h([])}),[]),q.useEffect(()=>{o?$():B()},[n,i,o]);const I=L=>{c(L),_(L),f(G=>{const ee=L.find(re=>re.id===G);ee&&S(re=>[...re,{id:`temp-${ee.id}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,attribute:ee,value:ee.valorDefecto||"",isTemp:!0}])})},$=async()=>{k(!0);try{const L=await Ne.get(`/world-bible/folders/${i}`),G=await Ne.get(`/world-bible/folders/${i}/templates`);I(G),x(re=>({...re,nombre:`Nuevo ${a==="map"?"Mapa":a==="timeline"?"Cronograma":"Ente"}`,carpeta:L,tipoEspecial:a||"entidadindividual",tipo:a||"entidadindividual"}));const ee=G.filter(re=>re.esObligatorio).map(re=>({id:`temp-${re.id}-${Math.random().toString(36).substr(2,9)}`,attribute:re,value:re.valorDefecto||"",isTemp:!0}));S(ee)}catch(L){console.error("Error creating draft:",L)}finally{k(!1)}},B=async()=>{var L;k(!0);try{const G=await Ne.get(`/world-bible/entities/${n}`);if(x({...G,apariencia:G.apariencia||"",notas:G.notas||"",iconUrl:G.iconUrl||null,tags:G.tags||"",tipo:G.tipoEspecial||getHierarchyType(G.tipo).id,color:G.color||"#6366f1",categoria:G.categoria||"Individual",attributes:G.attributes||{}}),(L=G.carpeta)!=null&&L.id){const re=await Ne.get(`/world-bible/folders/${G.carpeta.id}/templates`);I(re)}const ee=(G.valores||[]).filter(re=>re.plantilla).map(re=>({id:re.id.toString(),attribute:re.plantilla,value:re.valor,isTemp:!1}));S(ee)}catch(G){console.error("Error loading entity:",G)}finally{k(!1)}},z=(L,G)=>{x(ee=>({...ee,[L]:G}))},U=L=>{const G=L.target.files[0];if(G){const ee=new FileReader;ee.onloadend=()=>{z("iconUrl",ee.result)},ee.readAsDataURL(G)}},F=(L,G)=>{S(ee=>ee.map(re=>re.id===L?{...re,value:G}:re))},Q=L=>{L.toString().startsWith("temp-")||M(G=>[...G,L]),S(G=>G.filter(ee=>ee.id!==L))},K=async(L=!0)=>{j(!0);try{const G={nombre:y.nombre,descripcion:y.descripcion,tags:y.tags,apariencia:y.apariencia,notas:y.notas,iconUrl:y.iconUrl,tipoEspecial:y.tipoEspecial||"entidadindividual",color:y.color,categoria:y.categoria,attributes:y.attributes};let ee=y.id;if(o){if(!y.carpeta||!y.carpeta.id){alert("Error: No folder selected or folder not found."),j(!1);return}G.carpetaId=y.carpeta.id;const W=await Ne.post("/world-bible/entities",G);ee=W.id;const ne=[...b];for(let ie=0;ie<ne.length;ie++){const V=ne[ie];if(V.isTemp){const Y=await Ne.post(`/world-bible/entities/${W.id}/attributes`,{plantillaId:V.attribute.id});await Ne.patch(`/world-bible/entities/${W.id}/values`,[{valorId:Y.id,nuevoValor:V.value}]),ne[ie]={...V,id:Y.id.toString(),isTemp:!1}}}S(ne),j(!1),L?s(`/${e}/${r}/bible/folder/${i}`):s(`/${e}/${r}/bible/folder/${i}/entity/${W.slug||W.id}`,{replace:!0});return}await Ne.put(`/world-bible/entities/${ee}`,{nombre:G.nombre,color:G.color,iconUrl:G.iconUrl}),await Ne.patch(`/world-bible/entities/${ee}/details`,{descripcion:G.descripcion,tags:G.tags,apariencia:G.apariencia,notas:G.notas,iconUrl:G.iconUrl}),T.length>0&&(await Promise.all(T.map(W=>Ne.delete(`/world-bible/values/${W}`))),M([]));const re=b.filter(W=>!W.isTemp).map(W=>({valorId:parseInt(W.id),nuevoValor:W.value}));re.length>0&&await Ne.patch(`/world-bible/entities/${ee}/values`,re);let se=!1;const de=[...b];console.log("Saving fields...",b);for(let W=0;W<de.length;W++){const ne=de[W];if(ne.isTemp){console.log("Processing temp field:",ne);try{const ie=await Ne.post(`/world-bible/entities/${ee}/attributes`,{plantillaId:ne.attribute.id});console.log("Created attribute value:",ie),await Ne.patch(`/world-bible/entities/${ee}/values`,[{valorId:ie.id,nuevoValor:ne.value}]),de[W]={...ne,id:ie.id.toString(),isTemp:!1},se=!0}catch(ie){console.error("Error saving field:",ne,ie)}}}se&&S(de),j(!1)}catch(G){console.error("Save error",G),j(!1)}};return w?d.jsx("div",{className:"p-20 text-center animate-pulse",children:"Loading Builder..."}):d.jsx("div",{className:"flex h-full w-full bg-background-dark overflow-hidden",children:d.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-y-auto custom-scrollbar relative",children:[d.jsxs("div",{className:"border-b border-white/5 p-4 flex justify-between items-center bg-background-dark/80 backdrop-blur sticky top-0 z-30",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx(b0,{url:y.iconUrl,name:y.nombre,className:"size-10 rounded-lg border border-white/10"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-lg font-bold text-white leading-tight",children:y.nombre||"Sin Nombre"}),d.jsx("span",{className:"text-[10px] uppercase font-black tracking-widest text-slate-500",children:o?"Creando Nueva Entidad":"Editando Entidad"})]})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("button",{onClick:()=>s(`/${e}/${r}/bible/folder/${i}`),className:"px-4 py-2 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 text-xs font-bold uppercase tracking-widest transition-all",children:"Cancelar"}),d.jsxs("div",{className:"flex bg-white/5 rounded-xl p-1 gap-1 border border-white/10",children:[d.jsxs("button",{onClick:()=>K(!0),disabled:N,className:"h-9 px-4 rounded-lg bg-primary hover:bg-primary-light text-white text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 disabled:opacity-50",children:[N?d.jsx("span",{className:"material-symbols-outlined animate-spin text-sm",children:"refresh"}):d.jsx("span",{className:"material-symbols-outlined text-sm",children:"save"}),"Guardar"]}),d.jsx("div",{className:"w-px bg-white/10 my-1"}),d.jsx("button",{onClick:()=>K(!1),disabled:N,className:"h-9 px-3 rounded-lg bg-transparent hover:bg-white/10 text-white transition-all flex items-center justify-center disabled:opacity-50",title:"Guardar y Seguir Editando",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit_document"})})]})]})]}),d.jsxs("div",{className:"p-8 pb-32 max-w-5xl mx-auto w-full",children:[m==="identity"&&d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[d.jsxs(Ct,{className:`p-6 space-y-6 ${y.tipoEspecial==="map"?"lg:col-span-2":""}`,children:[d.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"badge"})," Identity"]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Full Name"}),d.jsx("input",{value:y.nombre,onChange:L=>z("nombre",L.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none transition-colors",placeholder:"E.g. King Alaric"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Entity Type / Category"}),d.jsxs("select",{value:y.categoria||"Individual",onChange:L=>z("categoria",L.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none transition-colors appearance-none",children:[d.jsx("option",{value:"Individual",children:"Individual (Character/Person)"}),d.jsx("option",{value:"Group",children:"Group / Faction"}),d.jsx("option",{value:"Location",children:"Location"}),d.jsx("option",{value:"Event",children:"Event"}),d.jsx("option",{value:"Object",children:"Object / Item"}),d.jsx("option",{value:"Concept",children:"Concept / Magic"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Tags (comma separated)"}),d.jsx("input",{value:y.tags,onChange:L=>z("tags",L.target.value),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-slate-300 focus:border-primary/50 outline-none transition-colors",placeholder:"Warrior, Leader, Human..."})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-1 block",children:"Icon / Portrait"}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx(b0,{url:y.iconUrl,name:y.nombre,size:"lg",className:"rounded-xl"}),d.jsxs("label",{className:"cursor-pointer px-4 py-2 bg-white/5 hover:bg-white/10 rounded-lg border border-white/10 text-xs font-bold text-slate-300 transition-colors",children:["Upload Image",d.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:U})]}),y.iconUrl&&d.jsx("button",{onClick:()=>z("iconUrl",""),className:"p-2 hover:text-red-400 transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-[10px] uppercase font-bold text-indigo-400 mb-1 flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-xs",children:"data_object"}),"Extended Attributes (JSON)"]}),d.jsx("textarea",{value:JSON.stringify(y.attributes||{},null,2),onChange:L=>{try{const G=JSON.parse(L.target.value);z("attributes",G)}catch{}},onBlur:L=>{try{const G=JSON.parse(L.target.value);z("attributes",G)}catch{alert("Invalid JSON syntax")}},className:"w-full h-32 bg-black/50 border border-indigo-500/30 rounded-xl p-3 text-xs text-indigo-100 font-mono focus:border-indigo-500 outline-none transition-colors",placeholder:"{}"})]})]})]}),y.tipoEspecial!=="map"&&d.jsxs(Ct,{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"palette"})," Appearance"]}),d.jsx("div",{className:"flex gap-2",children:d.jsxs("label",{className:"cursor-pointer text-[10px] font-bold uppercase tracking-wider text-slate-500 hover:text-white transition-colors flex items-center gap-1",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"add_photo_alternate"}),"Insert Image",d.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:L=>{const G=L.target.files[0];if(G){const ee=new FileReader;ee.onloadend=()=>{const re=`

![${G.name}](${ee.result})
`;z("apariencia",(y.apariencia||"")+re)},ee.readAsDataURL(G)}}})]})})]}),d.jsx("textarea",{value:y.apariencia,onChange:L=>z("apariencia",L.target.value),className:"w-full h-80 bg-black/30 border border-white/10 rounded-xl p-4 text-sm text-slate-300 leading-relaxed focus:border-primary/50 outline-none transition-colors custom-scrollbar font-mono",placeholder:"Describe their physical appearance, clothing, distinct marks... (Markdown Supported)"})]}),y.tipoEspecial==="map"?d.jsxs(Ct,{className:"p-6 lg:col-span-2 space-y-6",children:[d.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Cartography"]}),d.jsx("div",{onClick:()=>{let L=y.iconUrl;try{const G=JSON.parse(y.descripcion||"{}");G.snapshotUrl&&(L=G.snapshotUrl)}catch{}R(!0)},className:"w-full aspect-[21/9] bg-black/30 border border-white/10 rounded-xl overflow-hidden cursor-pointer group relative",children:(()=>{let L=y.iconUrl;try{const G=JSON.parse(y.descripcion||"{}");G.snapshotUrl&&(L=G.snapshotUrl)}catch{}return L?d.jsxs(d.Fragment,{children:[d.jsx("img",{src:L,alt:"Map Preview",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),d.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:d.jsx("span",{className:"material-symbols-outlined text-white text-3xl",children:"zoom_in"})})]}):d.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-500 text-xs italic",children:"No map preview available"})})()}),d.jsx("div",{className:"flex justify-end",children:d.jsx(Wt,{variant:"secondary",size:"sm",icon:"edit",onClick:()=>window.open(`/${e}/${r}/map-editor/edit/${y.id}`,"_self"),children:"Open Editor"})})]}):d.jsxs(Ct,{className:"p-6 lg:col-span-2",children:[d.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2 mb-6",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"sticky_note_2"})," Quick Notes"]}),d.jsx("textarea",{className:"w-full h-40 bg-black/30 border border-white/10 rounded-xl p-4 text-sm text-slate-300 leading-relaxed resize-none focus:border-primary/50 outline-none transition-colors custom-scrollbar font-mono placeholder:text-slate-600",placeholder:"Quick notes about this entity...",value:y.notas||"",onChange:L=>z("notas",L.target.value)})]})]}),m==="narrative"&&d.jsxs("div",{className:"animate-in fade-in duration-500 space-y-8",children:[d.jsxs(Ct,{className:"min-h-[40vh] flex flex-col p-8",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"history_edu"})," Biography"]}),d.jsx("span",{className:"text-[10px] text-slate-500 bg-white/5 px-2 py-1 rounded",children:"Markdown Supported"})]}),d.jsx("textarea",{className:"flex-1 w-full bg-transparent border-none outline-none text-slate-300 leading-relaxed resize-none focus:ring-0 placeholder:text-slate-600 custom-scrollbar text-base min-h-[300px]",placeholder:"Write the origin story...",value:y.descripcion||"",onChange:L=>z("descripcion",L.target.value)})]}),d.jsxs(Ct,{className:"min-h-[40vh]",children:[d.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary p-6 pb-0 flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})," Relationships"]}),o?d.jsxs("div",{className:"p-12 text-center text-slate-500",children:[d.jsx("span",{className:"material-symbols-outlined text-4xl mb-4",children:"save_as"}),d.jsx("p",{className:"text-sm font-bold",children:"Please save the entity first to manage relationships."})]}):d.jsx(Fae,{entityId:y.id,entityType:y.tipo||"entidadindividual"})]})]}),m==="attributes"&&d.jsxs("div",{className:`animate-in fade-in duration-500 space-y-6 min-h-[50vh] transition-colors rounded-2xl p-4 ${window.isDraggingOver?"bg-primary/10 border-2 border-dashed border-primary":""}`,onDragOver:L=>{L.preventDefault(),L.dataTransfer.dropEffect="copy",L.currentTarget.classList.add("bg-primary/10","border-primary","border-dashed","border-2")},onDragLeave:L=>{L.preventDefault(),L.currentTarget.classList.remove("bg-primary/10","border-primary","border-dashed","border-2")},onDrop:L=>{if(L.preventDefault(),L.currentTarget.classList.remove("bg-primary/10","border-primary","border-dashed","border-2"),L.dataTransfer.getData("application/reactflow/type")!=="attribute")return;let ee=null;try{const re=L.dataTransfer.getData("templateData");if(re)ee=JSON.parse(re);else{const se=parseInt(L.dataTransfer.getData("templateId"));ee=A.find(de=>de.id===se)}}catch(re){console.error("Drop error",re)}ee&&S(re=>[...re,{id:`temp-${ee.id}-${Date.now()}`,attribute:ee,value:ee.valorDefecto||"",isTemp:!0}])},children:[d.jsxs("h3",{className:"text-xs font-black uppercase tracking-widest text-primary border-b border-white/5 pb-4 flex items-center justify-between",children:[d.jsx("span",{children:"Atributos especiales"}),d.jsx("span",{className:"text-[10px] text-slate-500 font-normal normal-case opacity-50 hidden md:block",children:"Arraste atributos desde el panel derecho"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 border-2 border-dashed border-white/5 rounded-2xl hover:border-primary/20 transition-colors bg-white/[0.01]",children:[b.length===0&&d.jsxs("div",{className:"col-span-full py-12 text-center text-slate-500 text-sm pointer-events-none",children:[d.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"drag_indicator"}),d.jsx("p",{children:"Arrastra plantillas aqu para aadir atributos"})]}),b.filter(L=>L.attribute).map(L=>d.jsx(Lae,{attribute:L.attribute,value:L.value,onChange:G=>F(L.id,G),onRemove:()=>Q(L.id)},L.id))]})]})]}),D&&y.iconUrl&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in duration-300",onClick:()=>R(!1),children:d.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh] p-2",children:[d.jsx("button",{onClick:()=>R(!1),className:"absolute -top-12 right-0 p-2 text-white hover:text-primary transition-colors",children:d.jsx("span",{className:"material-symbols-outlined text-3xl",children:"close"})}),d.jsx("img",{src:y.iconUrl,alt:y.nombre,className:"max-w-full max-h-[85vh] object-contain rounded-lg shadow-2xl border border-white/10",onClick:L=>L.stopPropagation()})]})})]})})},zae=t=>{switch(t==null?void 0:t.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},Bk=({item:t,type:e,linkTo:r,onContextMenu:n,onDelete:i})=>{const a=e==="folder";return d.jsxs(Lc,{to:r,onContextMenu:n,className:"group relative flex flex-col p-4 rounded-3xl bg-surface-dark border border-glass-border hover:border-primary/50 hover:bg-white/5 transition-all duration-300 backdrop-blur-sm overflow-hidden",children:[t.iconUrl&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"absolute inset-0 z-0",children:d.jsx("img",{src:t.iconUrl,alt:"",className:"w-full h-full object-cover opacity-60 group-hover:scale-105 transition-transform duration-700"})}),d.jsx("div",{className:"absolute inset-0 z-0 bg-gradient-to-t from-[#0a0a0c] via-[#0a0a0c]/80 to-transparent"})]}),d.jsxs("div",{className:"relative z-10 flex items-start justify-between mb-4",children:[d.jsx("div",{className:`
                    size-12 rounded-2xl flex items-center justify-center text-xl transition-transform group-hover:scale-110 
                    ${a?"bg-primary/20 text-primary":"bg-white/5 text-text-muted group-hover:text-white backdrop-blur-md border border-white/5"}
                `,children:d.jsx("span",{className:"material-symbols-outlined",children:a?"folder":zae(t.tipoEspecial)})}),a&&d.jsx("div",{className:"px-2 py-1 rounded-lg bg-surface-light/50 border border-glass-border text-[10px] font-black text-white shadow-sm backdrop-blur-md",children:t.itemCount||0})]}),d.jsxs("div",{className:"relative z-10 mt-auto",children:[d.jsx("h3",{className:"text-sm font-bold text-white truncate group-hover:text-primary transition-colors drop-shadow-md",children:t.nombre}),d.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest text-text-muted mt-1 opacity-70 group-hover:opacity-100 transition-opacity",children:a?"Folder":t.tipoEspecial||"Entity"})]}),d.jsxs("div",{className:"absolute top-4 right-4 z-20 flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[i&&d.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),i(t)},className:"p-1.5 rounded-lg bg-red-500/10 hover:bg-red-500 text-red-500 hover:text-white transition-all border border-red-500/20 shadow-lg shadow-red-500/5 group/del backdrop-blur-md",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})}),d.jsx("span",{className:"material-symbols-outlined text-primary text-sm transform group-hover:translate-x-1 transition-transform drop-shadow-md",children:"arrow_forward"})]})]})},Vae=({path:t,currentFolder:e})=>{const{username:r,projectName:n}=Bi(),i=`/${r}/${n}/bible`;return!t&&!e?null:d.jsxs("nav",{className:"flex items-center gap-2 text-[10px] uppercase font-bold tracking-wider text-slate-500 mb-4 overflow-x-auto no-scrollbar whitespace-nowrap",children:[d.jsxs(Lc,{to:i,className:"hover:text-primary transition-colors flex items-center gap-1",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"home"}),"Bible"]}),t&&t.map((a,s)=>d.jsxs(kt.Fragment,{children:[d.jsx("span",{className:"text-slate-700",children:"/"}),d.jsx(Lc,{to:`${i}/folder/${a.slug||a.id}`,className:"hover:text-primary transition-colors",children:a.nombre})]},a.id)),e&&d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"text-slate-700",children:"/"}),d.jsx("span",{className:"text-white bg-white/5 px-2 py-0.5 rounded",children:e.nombre})]})]})},$ae=({entities:t=[],onAddEvent:e})=>{const r=[...t].sort((n,i)=>n.id-i.id);return d.jsx("div",{className:"w-full max-w-3xl mx-auto p-4 animate-slide-up",children:d.jsxs("div",{className:"relative border-l-2 border-white/10 ml-6 space-y-12 py-8",children:[r.length===0&&d.jsx("div",{className:"pl-12 opacity-50",children:d.jsx("p",{className:"text-white text-sm",children:"No events recorded in this timeline yet."})}),r.map((n,i)=>d.jsxs("div",{className:"relative pl-12 group",children:[d.jsx("div",{className:"absolute left-[-9px] top-0 size-4 rounded-full bg-background-dark border-2 border-primary group-hover:scale-125 group-hover:bg-primary transition-all shadow-[0_0_10px_rgba(99,102,241,0.3)]"}),d.jsxs(Ct,{className:"p-6 border-white/5 hover:border-primary/30 transition-all hover:-translate-y-1 cursor-pointer",children:[d.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:n.nombre}),d.jsx("p",{className:"text-sm text-text-muted leading-relaxed line-clamp-3",children:n.descripcion||"No description provided."})]})]},n.id)),d.jsxs("div",{onClick:e,className:"relative pl-12 group cursor-pointer opacity-50 hover:opacity-100 transition-opacity",children:[d.jsx("div",{className:"absolute left-[-9px] top-2 size-4 rounded-full bg-background-dark border-2 border-dashed border-white/30"}),d.jsxs("div",{className:"p-4 border-2 border-dashed border-white/10 rounded-2xl flex items-center justify-center text-text-muted hover:border-primary/50 hover:text-white transition-all",children:[d.jsx("span",{className:"material-symbols-outlined mr-2",children:"add_circle"}),d.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Add Historical Event"})]})]})]})})},kc={UNIVERSE:{id:"UNIVERSE",label:"Universo / Multiverso",description:"Contenedor supremo de realidades.",icon:"public",color:"text-purple-400",bgColor:"bg-purple-900/20"},GALAXY:{id:"GALAXY",label:"Galaxia",description:"Agrupacin masiva de sistemas estelares.",icon:"auto_awesome",color:"text-indigo-400",bgColor:"bg-indigo-900/20"},SYSTEM:{id:"SYSTEM",label:"Sistema Solar",description:"Estrella central y sus cuerpos orbitales.",icon:"wb_sunny",color:"text-yellow-400",bgColor:"bg-yellow-900/20"},PLANET:{id:"PLANET",label:"Planeta / Mundo",description:"Cuerpo celeste o plano de existencia principal.",icon:"public",color:"text-emerald-400",bgColor:"bg-emerald-900/20"},GEOGRAPHY:{id:"GEOGRAPHY",label:"Geografa",icon:"map",color:"text-green-300"},ENTITIES:{id:"ENTITIES",label:"Entidades",icon:"groups",color:"text-blue-300"},MAGIC:{id:"MAGIC",label:"Magia",icon:"auto_fix_high",color:"text-pink-300"},TIMELINE:{id:"TIMELINE",label:"Cronologa",icon:"history",color:"text-orange-300"},FACTIONS:{id:"FACTIONS",label:"Facciones",icon:"security",color:"text-red-300"},ITEMS:{id:"ITEMS",label:"Objetos",icon:"inventory_2",color:"text-gray-300"},FOLDER:{id:"FOLDER",label:"Carpeta",icon:"folder",color:"text-gray-400"}},Fk=t=>kc[t]||kc.FOLDER,Uae=()=>{const{username:t,projectName:e,folderSlug:r}=Bi(),n=Li(),{handleCreateEntity:i,handleDeleteEntity:a,handleCreateSimpleFolder:s,folderSearchTerm:o,folderFilterType:l}=jl(),[c,u]=q.useState([]),[f,h]=q.useState(null),[m,v]=q.useState([]),[y,x]=q.useState(!0),[b,S]=q.useState(!1),w=c.filter(T=>{const M=T.nombre.toLowerCase().includes(o||""),A=l==="ALL"||l==="MAP"&&T.tipoEspecial==="map"||l==="TIMELINE"&&T.tipoEspecial==="timeline"||l==="ENTITY"&&(!T.tipoEspecial||T.tipoEspecial==="entidadindividual");return M&&A});q.useEffect(()=>{const T=M=>{const{folderId:A,removeId:_,type:D,item:R,expand:I}=M.detail||{};A===((f==null?void 0:f.id)||r)&&(_?u($=>$.filter(B=>B.id!==_)):R&&R.slug&&R.slug!==r?n(`/${t}/${e}/bible/folder/${R.slug}`,{replace:!0}):k())};return window.addEventListener("folder-update",T),()=>window.removeEventListener("folder-update",T)},[r,f==null?void 0:f.id]),q.useEffect(()=>{k()},[r]);const k=async()=>{x(!0);try{const[T,M]=await Promise.all([Ne.get(`/world-bible/folders/${r}/entities`),Ne.get(`/world-bible/folders/${r}`)]);u(T),M.folder?(h(M.folder),v(M.path||[])):(h(M||{name:"Folder"}),v([]))}catch(T){console.error("Error loading folder content:",T),h(null),v([])}finally{x(!1)}};if(y)return d.jsx("div",{className:"p-20 text-center animate-pulse text-text-muted",children:"Loading sector..."});if(!f)return d.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-20 text-text-muted",children:[d.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-20",children:"folder_off"}),d.jsx("h2",{className:"text-xl font-bold opacity-50",children:"Folder Not Found"}),d.jsx("p",{className:"text-sm opacity-30 mt-2",children:"The sector you are looking for does not exist or has been moved."}),d.jsx(Lc,{to:`/${t}/${e}/bible`,className:"mt-6 px-6 py-2 bg-white/5 hover:bg-white/10 rounded-full text-xs font-bold transition-colors",children:"Return to Root"})]});const N=f&&f.tipo&&(["UNIVERSE","GALAXY","SYSTEM","PLANET"].includes(f.tipo)||f.tipo==="MAGIC"),j=f?Fk(f.tipo):kc.FOLDER;return N?d.jsxs("div",{className:"flex-1 overflow-y-auto bg-[#0a0a0c] text-white w-full h-full relative",children:[d.jsxs("div",{className:`w-full min-h-[300px] ${j.bgColor} relative flex items-end p-10 border-b border-white/5`,children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#0a0a0c] to-transparent opacity-80 pointer-events-none"}),d.jsx("div",{className:"absolute top-6 left-10 z-20",children:d.jsx(Vae,{path:m,currentFolder:f})}),d.jsxs("div",{className:"relative z-10 flex gap-8 items-end w-full max-w-7xl mx-auto",children:[d.jsx("div",{className:`w-32 h-32 rounded-3xl ${j.bgColor} border border-white/10 flex items-center justify-center shadow-2xl`,children:d.jsx("span",{className:`material-symbols-outlined text-6xl ${j.color}`,children:j.icon})}),d.jsxs("div",{className:"flex-1 mb-2",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[d.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border border-white/10 ${j.bgColor} ${j.color}`,children:j.label}),d.jsxs("span",{className:"text-white/30 text-xs font-mono tracking-widest uppercase",children:["ID: ",f.id]})]}),d.jsx("h1",{className:"text-6xl font-black tracking-tighter text-white mb-2",children:f.nombre}),d.jsx("p",{className:"text-lg text-white/50 max-w-2xl font-light leading-relaxed",children:f.descripcion||"Sin descripcin definida para este sector cosmolgico."})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("button",{onClick:()=>n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadindividual`),className:"px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"person_add"})," Nueva Entidad"]}),d.jsxs("button",{onClick:()=>n(`/${t}/${e}/map-editor/create/${r}`,{state:{folderId:f==null?void 0:f.id}}),className:"px-4 py-2 bg-white/5 hover:bg-white/10 text-white rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all border border-glass-border",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Mapa"]})]})]})]}),d.jsxs("div",{className:"max-w-7xl mx-auto p-10 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"bg-[#13141f] border border-white/5 rounded-2xl p-6",children:[d.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Estadsticas"}),d.jsx("div",{className:"grid grid-cols-2 gap-4",children:d.jsxs("div",{children:[d.jsx("div",{className:"text-2xl font-black text-white",children:c.length}),d.jsx("div",{className:"text-[10px] text-white/40 uppercase",children:"Entidades"})]})})]}),d.jsxs("div",{className:"bg-[#13141f] border border-white/5 rounded-2xl p-6 h-64 flex flex-col",children:[d.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Notas Rpidas"}),d.jsx("textarea",{className:"flex-1 bg-transparent resize-none outline-none text-sm text-white/70 placeholder-white/20",placeholder:"Escribir notas de la zona..."})]})]}),d.jsxs("div",{className:"lg:col-span-2",children:[d.jsx("h3",{className:"text-xs font-bold text-white/40 uppercase tracking-widest mb-4",children:"Contenido Interno"}),c.length===0&&d.jsxs("div",{className:"p-12 border border-dashed border-white/10 rounded-2xl text-center",children:[d.jsx("span",{className:"material-symbols-outlined text-4xl text-white/20 mb-2",children:"folder_open"}),d.jsx("p",{className:"text-white/30 text-sm",children:"Este sector est vaco."})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:c.map(T=>d.jsx(Bk,{item:T,type:"entity",linkTo:`/${t}/${e}/bible/folder/${f.slug||r}/entity/${T.slug||T.id}`,onDelete:()=>a(T.id,(f==null?void 0:f.id)||r)},T.id))})]})]})]}):d.jsxs("div",{className:"flex-1 p-8 max-w-[1600px] mx-auto w-full h-full overflow-y-auto",children:[d.jsxs("header",{className:"mb-8 flex items-end justify-between",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsxs(Lc,{to:`/${t}/${e}/bible`,className:"text-xs font-bold text-text-muted hover:text-primary transition-colors flex items-center gap-1",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"})," Root"]}),f&&d.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] bg-white/5 border border-white/10 ${j.color}`,children:j.label})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("span",{className:`material-symbols-outlined text-3xl ${j.color}`,children:j.icon}),d.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter",children:(f==null?void 0:f.nombre)||"Unnamed Folder"})]}),d.jsx("p",{className:"text-white/50 text-sm mt-2 max-w-xl",children:f==null?void 0:f.descripcion})]}),d.jsxs("div",{className:"flex items-center gap-3 relative",children:[d.jsxs("button",{onClick:()=>S(!b),className:"h-10 px-6 rounded-xl bg-primary hover:bg-primary-light transition flex items-center gap-2 text-xs font-bold text-white shadow-lg shadow-primary/20",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"}),d.jsx("span",{children:"Aadir Elemento"})]}),b&&d.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-surface-dark border border-glass-border rounded-2xl shadow-2xl py-2 z-50 animate-in fade-in slide-in-from-top-2",children:[d.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadindividual`),S(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"person"})," Personaje"]}),d.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/entidadcolectiva`),S(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-blue-400",children:"groups"})," Cultura / Grupo"]}),d.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/zona`),S(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-green-400",children:"location_on"})," Lugar / Geografa"]}),d.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/interaccion`),S(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-amber-400",children:"history_edu"})," Lore / Interaccin"]}),d.jsxs("button",{onClick:()=>{n(`/${t}/${e}/bible/folder/${r}/entity/new/efectos`),S(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-purple-400",children:"magic_button"})," Objeto / Efecto"]}),d.jsx("div",{className:"h-px bg-white/5 my-1"}),d.jsxs("button",{onClick:()=>{n(`/${t}/${e}/map-editor/create/${r}`,{state:{folderId:f==null?void 0:f.id}}),S(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-red-400",children:"map"})," Nuevo Mapa"]}),d.jsxs("button",{onClick:()=>{s(f,"TIMELINE"),S(!1)},className:"w-full px-4 py-2.5 hover:bg-white/5 text-left text-xs font-bold flex items-center gap-3 text-white/70 hover:text-white",children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-cyan-400",children:"timeline"})," Timeline"]})]})]})]}),(f==null?void 0:f.tipo)==="TIMELINE"?d.jsx($ae,{entities:w,folderId:r,onAddEvent:()=>n(`/${t}/${e}/bible/folder/${r}/entity/new/evento`)}):d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:w.map(T=>{const M=T.tipoEspecial==="map"||T.tipoEspecial==="timeline"?T.tipoEspecial:"entity";return d.jsx(Bk,{item:T,type:"entity",linkTo:`/${t}/${e}/bible/folder/${(f==null?void 0:f.slug)||r}/${M}/${T.slug||T.id}`,onDelete:()=>a(T.id,(f==null?void 0:f.id)||r)},T.id)})}),c.length===0&&d.jsx("div",{className:"p-20 text-center border-2 border-dashed border-glass-border rounded-[3rem] opacity-30 mt-8",children:d.jsx("p",{className:"text-text-muted font-bold uppercase tracking-widest",children:"Empty Folder"})})]})},Gae=t=>{switch(t==null?void 0:t.toLowerCase()){case"text":return"notes";case"short_text":return"short_text";case"number":return"pin";case"date":return"calendar_today";case"select":return"list";case"boolean":return"check_box";case"map":return"map";case"timeline":return"timeline";case"character":case"entidadindividual":return"person";case"location":case"zona":case"construccion":return"location_on";case"culture":case"entidadcolectiva":return"groups";case"universe":case"galaxy":case"system":case"planet":return"public";case"entity_link":return"link";default:return"description"}},Hae=(t,e,r,n)=>{const i=r.slug||r.id;return`/${t}/${e}/bible/folder/${n||"root"}/entity/${i}`},SI=({folder:t,onCreateSubfolder:e,onRename:r,onDeleteFolder:n,onDeleteEntity:i,onCreateTemplate:a,onMoveEntity:s,onCreateEntity:o,onConfirmCreate:l,className:c})=>{const{username:u,projectName:f}=Bi(),h=Li(),[m,v]=q.useState(!1),[y,x]=q.useState({folders:[],entities:[]}),[b,S]=q.useState(!1),[w,k]=q.useState(null),[N,j]=q.useState(t.nombre),[T,M]=q.useState(!1),[A,_]=q.useState(null);q.useEffect(()=>{j(t.nombre)},[t.nombre]),q.useEffect(()=>{const L=G=>{var Y,te,Z,ue;const{folderId:ee,optimisticType:re,confirmedType:se,removeId:de,item:W,oldId:ne,expand:ie,type:V}=G.detail||{};if(ee===t.id){if(ie&&(v(!0),b||D()),b)if(re){const ge=re==="folder"?"folders":"entities";x(Ue=>({...Ue,[ge]:[...Ue[ge].filter(Pe=>Pe.id!==W.id),W]}))}else if(se){const ge=se==="folder"?"folders":"entities";x(Ue=>({...Ue,[ge]:Ue[ge].map(Pe=>Pe.id===ne?W:Pe)}))}else if(de){const ge=V==="folder"?"folders":"entities";x(Ue=>({...Ue,[ge]:Ue[ge].filter(Pe=>Pe.id!==de)}))}else!re&&!se&&!de&&D()}else((Y=G.detail)==null?void 0:Y.targetFolderId)===t.id&&((te=G.detail)==null?void 0:te.type)==="move-in"?b&&D():((Z=G.detail)==null?void 0:Z.sourceFolderId)===t.id&&((ue=G.detail)==null?void 0:ue.type)==="move-out"&&b&&x(ge=>({...ge,entities:ge.entities.filter(Ue=>Ue.id!==Ue.detail.entityId)}))};return window.addEventListener("folder-update",L),()=>window.removeEventListener("folder-update",L)},[t.id,b]);const D=async()=>{try{console.log("Loading content for folder:",t.id,"Slug:",t.slug);const[L,G]=await Promise.all([Ne.get(`/world-bible/folders/${t.id}/subfolders`),Ne.get(`/world-bible/folders/${t.id}/entities`)]);x({folders:L,entities:G}),S(!0)}catch(L){console.error("Error reloading folder content:",L),L.message&&L.message.includes("404")&&console.error(`404 for folder ${t.id} (${t.nombre})`)}},R=L=>{L.stopPropagation(),v(!m),!b&&!m&&D()},I=()=>h(`/${u}/${f}/bible/folder/${t.slug||t.id}`),$=(L,G,ee,re)=>{L.preventDefault(),L.stopPropagation(),k({x:L.clientX,y:L.clientY,type:G,id:ee,name:re})},B=()=>k(null);q.useEffect(()=>{if(w)return window.addEventListener("click",B),()=>window.removeEventListener("click",B)},[w]);const z=L=>{if(L.key==="Enter"){L.preventDefault();const G=L.target.value.trim();G?l(t.id,G,"folder",t.parentId,t.tipoEspecial):t.isNew&&i(t.id,t.parentId)}};if(t.isNew)return d.jsx("div",{className:"px-3 py-1 animate-in fade-in zoom-in-95 duration-200",children:d.jsx("input",{autoFocus:!0,type:"text",className:"w-full bg-surface-light border border-primary/50 rounded px-2 py-1 text-xs text-white outline-none",placeholder:"Folder Name...",onKeyDown:z,onBlur:L=>{const G=L.target.value.trim();G?l(t.id,G,"folder",t.parentId):i(t.id,t.parentId)}})});const U=({item:L,type:G})=>d.jsx("div",{className:"px-3 py-1 animate-in fade-in zoom-in-95 duration-200",children:d.jsx("input",{autoFocus:!0,type:"text",defaultValue:L.nombre||"",className:"w-full bg-surface-light border border-primary/50 rounded px-2 py-1 text-xs text-white outline-none",placeholder:"Name...",onKeyDown:ee=>{if(ee.key==="Enter"){ee.preventDefault();const re=ee.target.value.trim();re?l(L.id,re,G,t.id,L.tipoEspecial):L.isNew&&i(L.id,t.id),_(null)}else ee.key==="Escape"&&(_(null),L.isNew&&i(L.id,t.id))},onBlur:ee=>{const re=ee.target.value.trim();re?l(L.id,re,G,t.id,L.tipoEspecial):L.isNew&&i(L.id,t.id),_(null)}})}),F=L=>{L.preventDefault(),L.stopPropagation(),L.currentTarget.classList.add("bg-primary/20")},Q=L=>{L.preventDefault(),L.stopPropagation(),L.currentTarget.classList.remove("bg-primary/20")},K=L=>{L.preventDefault(),L.stopPropagation(),L.currentTarget.classList.remove("bg-primary/20");const G=L.dataTransfer.getData("entityId"),ee=L.dataTransfer.getData("sourceFolderId");G&&ee&&ee!==String(t.id)&&s(G,t.id,ee)};return d.jsxs("div",{className:`space-y-1 select-none ${c||""}`,children:[d.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 rounded-xl text-xs font-bold text-text-muted hover:text-white hover:bg-white/5 cursor-pointer transition-all group relative",onClick:I,onContextMenu:L=>$(L,"folder",t.id,t.nombre),onDragOver:F,onDragLeave:Q,onDrop:K,children:[d.jsx("span",{onClick:R,className:`material-symbols-outlined text-lg transition-transform hover:text-primary ${m?"rotate-90 text-primary":"opacity-50"}`,children:"chevron_right"}),d.jsx("span",{className:`material-symbols-outlined text-lg ${Fk(t.tipo).color}`,children:Fk(t.tipo).icon}),T?d.jsx("input",{autoFocus:!0,className:"bg-surface-light border border-primary/50 rounded px-2 py-0.5 text-xs text-white outline-none flex-1 min-w-0",defaultValue:N,onKeyDown:async L=>{if(L.key==="Enter"){const G=L.target.value.trim();if(G&&G!==N)try{await r(t.id,G),j(G)}catch(ee){console.error(ee)}M(!1)}else L.key==="Escape"&&M(!1)},onBlur:()=>M(!1),onClick:L=>L.stopPropagation()}):d.jsx("span",{className:"truncate flex-1",children:N})]}),w&&d.jsxs("div",{className:"fixed bg-surface-dark border border-glass-border shadow-2xl rounded-xl py-2 z-50 w-48 text-xs font-medium flex flex-col",style:{top:w.y,left:w.x},onClick:L=>L.stopPropagation(),children:[d.jsx("div",{className:"px-4 py-2 border-b border-white/5 font-bold text-text-muted truncate",children:w.name}),w.type==="folder"?d.jsxs(d.Fragment,{children:[d.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{o(t.id,"entidadindividual"),B()},children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"person"})," Add Character"]}),d.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{h(`/${u}/${f}/map-editor/create/${t.id}`),B()},children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"map"})," Add Map"]}),d.jsx("div",{className:"h-px bg-white/5 my-1"}),d.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2",onClick:()=>{M(!0),B()},children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Rename Folder"]}),d.jsxs("button",{className:"px-4 py-2 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-2",onClick:()=>{n(t.id,t.parentId),B()},children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Delete Folder"]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2 cursor-pointer",onClick:()=>{_(w.id),B()},children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Rename"]}),d.jsxs("button",{className:"px-4 py-2 hover:bg-white/5 text-left flex items-center gap-2 cursor-pointer",onClick:async()=>{try{await Ne.entityService.toggleFavorite(w.id),window.dispatchEvent(new CustomEvent("favorites-update")),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:t.id}}))}catch(L){console.error(L)}B()},children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-500",children:"star"})," Toggle Favorite"]}),d.jsxs("button",{className:"px-4 py-2 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-2",onClick:()=>{i(w.id,t.id),B()},children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Delete Entity"]})]})]}),m&&d.jsxs("div",{className:"ml-6 pl-4 border-l border-glass-border space-y-1 animate-slide-in",children:[y.folders.map(L=>d.jsx(SI,{folder:L,onCreateSubfolder:e,onRename:r,onDeleteFolder:n,onDeleteEntity:i,onCreateTemplate:a,onMoveEntity:s,onCreateEntity:o,onConfirmCreate:l},L.id)),y.entities.map(L=>L.isNew||L.id===A?d.jsx(U,{item:L,type:"entity"},L.id):d.jsxs(Lc,{to:Hae(u,f,L,t.slug||t.id),onContextMenu:G=>$(G,"entity",L.id,L.nombre),className:`flex items-center gap-3 px-3 py-2 rounded-xl text-[11px] font-medium text-text-muted hover:text-white hover:bg-primary/10 transition-all group cursor-grab active:cursor-grabbing ${L.pending?"opacity-50 pointer-events-none":""}`,draggable:!L.pending,onDragStart:G=>{G.dataTransfer.setData("entityId",L.id),G.dataTransfer.setData("sourceFolderId",t.id)},children:[d.jsx("span",{className:"material-symbols-outlined text-sm opacity-70 group-hover:text-primary transition-colors",children:Gae(L.tipoEspecial)}),d.jsx("span",{className:"truncate flex-1",children:L.nombre}),L.favorite&&d.jsx("span",{className:"material-symbols-outlined text-[10px] text-yellow-500",title:"Favorito",children:"star"})]},L.id)),b&&y.folders.length===0&&y.entities.length===0&&d.jsx("div",{className:"px-3 py-2 text-[10px] text-text-muted/30 uppercase font-black italic tracking-tighter",children:"Empty Sector"})]})]})},Wae=({isOpen:t,onClose:e,onCreate:r,parentFolder:n})=>{const[i,a]=q.useState({nombre:"",descripcion:"",tipo:"FOLDER",canvasType:"BLANK"});if(!t)return null;const s=()=>{r(i),e(),a({nombre:"",descripcion:"",tipo:"FOLDER",canvasType:"BLANK"})},o=[kc.UNIVERSE,kc.GALAXY,kc.SYSTEM,kc.PLANET];return d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:d.jsxs("div",{className:"bg-[#1a1b26] w-full max-w-4xl rounded-2xl shadow-2xl border border-white/10 overflow-hidden flex flex-col max-h-[90vh]",children:[d.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-[#1f202e]",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-8 h-8 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:d.jsx("span",{className:"material-icons text-sm",children:"add"})}),d.jsx("h2",{className:"text-xl font-semibold text-white",children:n?"Crear Nuevo Espacio":"Crear Nuevo Mapa"})]}),d.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition",children:d.jsx("span",{className:"material-icons",children:"close"})})]}),d.jsx("div",{className:"p-8 overflow-y-auto flex-1",children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-indigo-400",children:"Identidad"}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-2",children:"Nombre del Espacio"}),d.jsx("input",{autoFocus:!0,type:"text",value:i.nombre,onChange:l=>a({...i,nombre:l.target.value}),className:"w-full bg-black/40 border border-white/5 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-indigo-500/50 transition-all shadow-inner",placeholder:"ej. Sistema Solar"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-2",children:"Descripcin"}),d.jsx("textarea",{value:i.descripcion,onChange:l=>a({...i,descripcion:l.target.value}),className:"w-full h-32 bg-black/40 border border-white/5 rounded-2xl px-5 py-4 text-white focus:outline-none focus:border-indigo-500/50 resize-none transition-all",placeholder:"Detalles sobre este nivel jerrquico..."})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-indigo-400",children:"Configuracin"}),d.jsxs("div",{className:"space-y-3",children:[d.jsx("label",{className:"block text-[10px] font-black text-white/30 uppercase mb-1",children:"Tipo de Jerarqua"}),d.jsx("div",{className:"grid grid-cols-2 gap-2",children:o.concat([{id:"FOLDER",label:"Carpeta",icon:"folder",color:"text-white/50"}]).map(l=>d.jsxs("div",{onClick:()=>a({...i,tipo:l.id}),className:`flex items-center gap-3 p-3 rounded-xl border cursor-pointer transition-all ${i.tipo===l.id?"bg-indigo-500/10 border-indigo-500/50":"bg-white/5 border-white/5 hover:bg-white/10"}`,children:[d.jsx("span",{className:`material-icons text-lg ${l.color||""}`,children:l.icon}),d.jsx("span",{className:"text-xs font-bold text-white/80",children:l.label})]},l.id||"FOLDER"))})]}),d.jsx("div",{className:"p-4 rounded-2xl bg-indigo-500/5 border border-indigo-500/10",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400",children:d.jsx("span",{className:"material-icons",children:"info"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] uppercase font-black text-indigo-300",children:"Ubicacin Actual"}),d.jsx("p",{className:"text-xs text-indigo-100/50",children:n?n.nombre:"Raz del Mundo"})]})]})})]})]})}),d.jsxs("div",{className:"p-6 border-t border-white/5 flex justify-end gap-3 bg-[#1f202e]",children:[d.jsx("button",{onClick:e,className:"px-6 py-3 rounded-xl text-xs font-black uppercase tracking-widest text-text-muted hover:text-white transition",children:"Cancelar"}),d.jsx("button",{onClick:s,disabled:!i.nombre,className:"px-8 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white text-xs font-black uppercase tracking-widest shadow-lg shadow-indigo-500/20 transition-all disabled:opacity-30 disabled:pointer-events-none",children:"Confirmar y Crear"})]})]})})},qae=()=>{const{username:t,projectName:e}=Bi(),r=Li(),{handleCreateEntity:n,...i}=jl()||{},[a,s]=q.useState([]),[o,l]=q.useState([]),[c,u]=q.useState(!1),[f,h]=q.useState(!1),[m,v]=q.useState(null),[y,x]=q.useState(!1),[b,S]=q.useState(null),w=`/${t}/${e}/bible`;q.useEffect(()=>{k(),N();const B=()=>N();return window.addEventListener("favorites-update",B),()=>window.removeEventListener("favorites-update",B)},[e]);const k=async()=>{try{const B=await Ne.get("/world-bible/folders");s(B)}catch(B){console.error("Error loading folders:",B)}},N=async()=>{try{const B=await Ne.get("/world-bible/favorites");l(B)}catch(B){console.error("Error loading favorites:",B)}},j=(B=null)=>{v(B),h(!0),u(!1)},T=async(B=null,z="FOLDER")=>{try{const U=B?typeof B=="object"?B.id:B:null,F=await Ne.post("/world-bible/folders",{nombre:z==="TIMELINE"?"Nueva Lnea de Tiempo":"Nueva Carpeta",padreId:U,tipo:z});if(U===null){const Q=await Ne.get("/world-bible/folders");s(Q),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:null}}))}else window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:U,optimisticType:"folder",item:F,expand:!0}}))}catch(U){console.error("Error creating simple folder:",U)}},M=async B=>{try{const z=m?m.id:null,U=await Ne.post("/world-bible/folders",{nombre:B.nombre,descripcion:B.descripcion,padreId:z,tipo:B.tipo});if(z===null){const F=await Ne.get("/world-bible/folders");s(F),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:null}}))}else U.id||console.error("CRITICAL: Created folder has no ID!",U),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:z,optimisticType:"folder",item:U,expand:!0}}))}catch(z){console.error(z),alert("Error creating folder/zone.")}},A=async(B,z="entidadindividual")=>{const U=typeof B=="object"?B.slug||B.id:B;r(`${w}/folder/${U}/entity/new/${z}`)},_=async(B,z)=>{try{await Ne.put(`/world-bible/folders/${B}`,{nombre:z}),s(U=>U.map(F=>F.id===B?{...F,nombre:z}:F))}catch(U){throw U}},D=(B,z=null)=>{S({id:B,parentId:z,type:"folder"}),x(!0)},R=async()=>{if(!b)return;const{id:B,parentId:z,type:U,folderId:F}=b;try{U==="folder"?(await Ne.delete(`/world-bible/folders/${B}`),z===null&&s(Q=>Q.filter(K=>K.id!==B)),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:z,removeId:B,type:"folder"}}))):U==="entity"&&(await Ne.delete(`/world-bible/entities/${B}`),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:F,removeId:B,type:"entity"}})))}catch(Q){console.error("Deletion failed:",Q),alert("Error trying to delete item.")}finally{S(null)}},I=(B,z)=>{S({id:B,folderId:z,type:"entity"}),x(!0)},$=async(B,z,U,F,Q)=>{try{if(U==="folder")typeof B=="number"&&!B.toString().startsWith("temp")&&(await Ne.put(`/world-bible/folders/${B}`,{nombre:z}),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:F,confirmedType:"folder",oldId:B,item:{id:B,nombre:z,parentId:F,tipo:Q,uiKey:Date.now()}}})),F||s(K=>K.map(L=>L.id===B?{...L,nombre:z}:L)));else if(U==="entity")if(typeof B=="string"&&B.startsWith("new-")){const K=await Ne.post("/world-bible/entities",{nombre:z,carpetaId:F,tipoEspecial:Q||"entidadindividual"});window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:F,confirmedType:"entity",oldId:B,item:K}}))}else await Ne.put(`/world-bible/entities/${B}`,{nombre:z}),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:F,confirmedType:"entity",oldId:B,item:{id:B,nombre:z,carpeta:{id:F},tipoEspecial:Q,slug:B}}})),window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:F}}))}catch(K){console.error("Creation/Rename failed",K),U==="folder"&&D(B,F)}};return d.jsxs("div",{className:"flex h-full w-full bg-background-dark max-w-[1920px] mx-auto",children:[d.jsxs("aside",{className:"w-80 flex-none flex flex-col border-r border-glass-border bg-surface-dark/50 z-10",children:[d.jsx("div",{className:"p-4 border-b border-glass-border",children:d.jsxs("div",{className:"relative group mb-3",children:[d.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-text-muted text-sm group-focus-within:text-primary transition-colors",children:"search"}),d.jsx("input",{type:"text",placeholder:"Buscar en Biblia...",className:"w-full bg-surface-light/50 border border-glass-border rounded-xl py-2 pl-9 pr-3 text-xs focus:border-primary/50 outline-none transition-all text-white placeholder:text-text-muted/50"})]})}),d.jsxs("div",{className:"px-2 pt-2",children:[d.jsx("div",{className:"flex items-center justify-between px-2 mb-1",children:d.jsx("h2",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted",children:"Favoritos"})}),o.length>0?d.jsx("div",{className:"space-y-0.5",children:o.map(B=>d.jsxs("div",{onClick:()=>r(`${w}/folder/${B.carpeta.slug||B.carpeta.id}/entity/${B.slug||B.id}`),className:"flex items-center gap-3 px-3 py-1.5 rounded-lg text-[11px] font-medium text-text-muted hover:text-white hover:bg-white/5 cursor-pointer transition-all group",children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-yellow-500/70 group-hover:text-yellow-400",children:"star"}),d.jsx("span",{className:"truncate",children:B.nombre})]},B.id))}):d.jsx("div",{className:"px-4 py-2 text-[10px] text-text-muted/30 italic",children:"Sin favoritos"}),d.jsx("div",{className:"h-px bg-glass-border my-2 opacity-50"})]}),d.jsx("div",{className:"p-4 border-b border-glass-border pt-0",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-[10px] font-black uppercase tracking-widest text-text-muted",children:"Explorador"}),d.jsx("div",{className:"relative",children:d.jsx("button",{className:"transition-colors hover:text-white text-primary",onClick:()=>T(null),title:"Crear Carpeta",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"create_new_folder"})})})]})}),d.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar p-2 space-y-0.5",children:a.length===0?d.jsxs("div",{className:"p-8 text-center opacity-30",children:[d.jsx("span",{className:"material-symbols-outlined text-3xl mb-2",children:"folder_off"}),d.jsx("p",{className:"text-[10px] uppercase font-bold",children:"Biblia Vaca"})]}):a.map(B=>d.jsx(SI,{folder:B,onCreateSubfolder:()=>{},onRename:_,onDeleteFolder:D,onDeleteEntity:D,onCreateTemplate:()=>{},onMoveEntity:(z,U,F)=>console.log("move",z,U,F),onCreateEntity:A,onConfirmCreate:$},B.uiKey||B.id))})]}),d.jsx("main",{className:"flex-1 overflow-hidden relative bg-gradient-to-br from-background-dark to-surface-dark/20",children:d.jsx(HC,{context:{...i,folders:a,handleCreateEntity:A,handleOpenCreateModal:j,handleDeleteFolder:D,handleDeleteEntity:I,handleCreateSimpleFolder:T}})}),d.jsx(Wae,{isOpen:f,onClose:()=>h(!1),onCreate:M,parentFolder:m}),d.jsx(Qp,{isOpen:y,onClose:()=>x(!1),onConfirm:R,title:(b==null?void 0:b.type)==="folder"?"Borrar Carpeta":"Borrar Entidad",message:(b==null?void 0:b.type)==="folder"?"Esta accin eliminar la carpeta y todo su contenido. Ests seguro?":"Ests seguro de querer eliminar esta entidad de tu mundo?",confirmText:"S, borrar"})]})},Kae=()=>{const{username:t,projectName:e}=Bi();Li();const{handleOpenCreateModal:r,handleDeleteFolder:n,handleCreateSimpleFolder:i,handleRenameFolder:a,folders:s=[]}=jl(),[o,l]=q.useState(null),[c,u]=q.useState(null),[f,h]=q.useState(""),m=(x,b)=>{x.preventDefault(),x.stopPropagation(),l({x:x.clientX,y:x.clientY,folder:b})},v=()=>l(null);q.useEffect(()=>{if(o){const x=()=>v();return window.addEventListener("click",x),()=>window.removeEventListener("click",x)}},[o]);const y=async(x,b)=>{b.trim()&&a&&await a(x,b.trim()),u(null),h("")};return s===void 0?d.jsx("div",{className:"p-20 text-center animate-pulse text-text-muted",children:"Loading World Bible..."}):d.jsxs("div",{className:"flex-1 p-8 max-w-[1600px] mx-auto w-full h-full overflow-y-auto",children:[d.jsxs("header",{className:"mb-8 flex items-end justify-between",children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-3 text-xs font-black uppercase tracking-widest text-primary italic mb-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_stories"}),"World Bible"]}),d.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter",children:"Root Index"}),d.jsx("p",{className:"text-text-muted mt-2 max-w-lg text-sm",children:"The central archive of your world. Organize characters, locations, timelines, and maps."})]}),d.jsx("div",{className:"flex items-center gap-2",children:d.jsxs("button",{onClick:()=>i(null,"FOLDER"),className:"px-6 py-2 bg-primary hover:bg-primary-light text-white rounded-xl text-xs font-bold flex items-center gap-2 transition-all shadow-lg shadow-primary/20",children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"create_new_folder"})," Nueva Carpeta"]})})]}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:s.map(x=>c===x.id?d.jsx("div",{className:"p-4 rounded-3xl bg-surface-dark border border-primary/50",children:d.jsx("input",{autoFocus:!0,type:"text",value:f,onChange:b=>h(b.target.value),onKeyDown:b=>{b.key==="Enter"&&y(x.id,f),b.key==="Escape"&&(u(null),h(""))},onBlur:()=>y(x.id,f),className:"w-full bg-black/30 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-primary/50 outline-none",placeholder:"Folder name..."})},x.id):d.jsx(Bk,{item:x,type:"folder",linkTo:`/${t}/${e}/bible/folder/${x.slug||x.id}`,onDelete:()=>n(x.id),onContextMenu:b=>m(b,x)},x.id))}),s.length===0&&d.jsxs("div",{className:"p-20 text-center border-2 border-dashed border-glass-border rounded-[3rem] opacity-30 mt-8",children:[d.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 text-text-muted",children:"library_books"}),d.jsx("h3",{className:"text-xl font-bold text-white uppercase tracking-widest",children:"Archivo Vaco"}),d.jsx("p",{className:"text-text-muted mt-2",children:"Comienza creando espacios para organizar tu mundo."})]}),o&&d.jsxs("div",{className:"fixed bg-surface-dark border border-glass-border shadow-2xl rounded-xl py-2 z-50 w-52 text-xs font-medium flex flex-col animate-in fade-in zoom-in-95 duration-150",style:{top:o.y,left:o.x},onClick:x=>x.stopPropagation(),children:[d.jsxs("div",{className:"px-4 py-2 border-b border-white/5 font-bold text-text-muted truncate flex items-center gap-2",children:[d.jsx("span",{className:"material-symbols-outlined text-sm text-primary",children:"folder"}),o.folder.nombre]}),d.jsxs("button",{className:"px-4 py-2.5 hover:bg-white/5 text-left flex items-center gap-3 text-white/80 hover:text-white transition-colors",onClick:()=>{u(o.folder.id),h(o.folder.nombre),v()},children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})," Renombrar"]}),d.jsxs("button",{className:"px-4 py-2.5 hover:bg-red-500/10 text-red-400 text-left flex items-center gap-3 transition-colors",onClick:()=>{n(o.folder.id),v()},children:[d.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})," Eliminar Carpeta"]})]})]})};var kI={exports:{}},Rx={},Ty={},pt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof lE<"u"?lE:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.16",isBrowser:r(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return t.Konva.angleDeg?i*e:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var i;return(i=t.Konva.Transformer)===null||i===void 0?void 0:i.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(i){t.glob.Konva=i}};const n=i=>{t.Konva[i.prototype.getClassName()]=i};t._registerNode=n,t.Konva._injectGlobal(t.Konva)})(pt);var xr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=pt;class r{constructor(k=[1,0,0,1,0,0]){this.dirty=!1,this.m=k&&k.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(k){k.m[0]=this.m[0],k.m[1]=this.m[1],k.m[2]=this.m[2],k.m[3]=this.m[3],k.m[4]=this.m[4],k.m[5]=this.m[5]}point(k){const N=this.m;return{x:N[0]*k.x+N[2]*k.y+N[4],y:N[1]*k.x+N[3]*k.y+N[5]}}translate(k,N){return this.m[4]+=this.m[0]*k+this.m[2]*N,this.m[5]+=this.m[1]*k+this.m[3]*N,this}scale(k,N){return this.m[0]*=k,this.m[1]*=k,this.m[2]*=N,this.m[3]*=N,this}rotate(k){const N=Math.cos(k),j=Math.sin(k),T=this.m[0]*N+this.m[2]*j,M=this.m[1]*N+this.m[3]*j,A=this.m[0]*-j+this.m[2]*N,_=this.m[1]*-j+this.m[3]*N;return this.m[0]=T,this.m[1]=M,this.m[2]=A,this.m[3]=_,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(k,N){const j=this.m[0]+this.m[2]*N,T=this.m[1]+this.m[3]*N,M=this.m[2]+this.m[0]*k,A=this.m[3]+this.m[1]*k;return this.m[0]=j,this.m[1]=T,this.m[2]=M,this.m[3]=A,this}multiply(k){const N=this.m[0]*k.m[0]+this.m[2]*k.m[1],j=this.m[1]*k.m[0]+this.m[3]*k.m[1],T=this.m[0]*k.m[2]+this.m[2]*k.m[3],M=this.m[1]*k.m[2]+this.m[3]*k.m[3],A=this.m[0]*k.m[4]+this.m[2]*k.m[5]+this.m[4],_=this.m[1]*k.m[4]+this.m[3]*k.m[5]+this.m[5];return this.m[0]=N,this.m[1]=j,this.m[2]=T,this.m[3]=M,this.m[4]=A,this.m[5]=_,this}invert(){const k=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),N=this.m[3]*k,j=-this.m[1]*k,T=-this.m[2]*k,M=this.m[0]*k,A=k*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),_=k*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=N,this.m[1]=j,this.m[2]=T,this.m[3]=M,this.m[4]=A,this.m[5]=_,this}getMatrix(){return this.m}decompose(){const k=this.m[0],N=this.m[1],j=this.m[2],T=this.m[3],M=this.m[4],A=this.m[5],_=k*T-N*j,D={x:M,y:A,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(k!=0||N!=0){const R=Math.sqrt(k*k+N*N);D.rotation=N>0?Math.acos(k/R):-Math.acos(k/R),D.scaleX=R,D.scaleY=_/R,D.skewX=(k*j+N*T)/_,D.skewY=0}else if(j!=0||T!=0){const R=Math.sqrt(j*j+T*T);D.rotation=Math.PI/2-(T>0?Math.acos(-j/R):-Math.acos(j/R)),D.scaleX=_/R,D.scaleY=R,D.skewX=0,D.skewY=(k*j+N*T)/_}return D.rotation=t.Util._getRotation(D.rotation),D}}t.Transform=r;let n="[object Array]",i="[object Number]",a="[object String]",s="[object Boolean]",o=Math.PI/180,l=180/Math.PI,c="#",u="",f="0",h="Konva warning: ",m="Konva error: ",v="rgb(",y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},x=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,b=[];const S=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(w){setTimeout(w,60)};t.Util={_isElement(w){return!!(w&&w.nodeType==1)},_isFunction(w){return!!(w&&w.constructor&&w.call&&w.apply)},_isPlainObject(w){return!!w&&w.constructor===Object},_isArray(w){return Object.prototype.toString.call(w)===n},_isNumber(w){return Object.prototype.toString.call(w)===i&&!isNaN(w)&&isFinite(w)},_isString(w){return Object.prototype.toString.call(w)===a},_isBoolean(w){return Object.prototype.toString.call(w)===s},isObject(w){return w instanceof Object},isValidSelector(w){if(typeof w!="string")return!1;const k=w[0];return k==="#"||k==="."||k===k.toUpperCase()},_sign(w){return w===0||w>0?1:-1},requestAnimFrame(w){b.push(w),b.length===1&&S(function(){const k=b;b=[],k.forEach(function(N){N()})})},createCanvasElement(){const w=document.createElement("canvas");try{w.style=w.style||{}}catch{}return w},createImageElement(){return document.createElement("img")},_isInDocument(w){for(;w=w.parentNode;)if(w==document)return!0;return!1},_urlToImage(w,k){const N=t.Util.createImageElement();N.onload=function(){k(N)},N.src=w},_rgbToHex(w,k,N){return((1<<24)+(w<<16)+(k<<8)+N).toString(16).slice(1)},_hexToRgb(w){w=w.replace(c,u);const k=parseInt(w,16);return{r:k>>16&255,g:k>>8&255,b:k&255}},getRandomColor(){let w=(Math.random()*16777215<<0).toString(16);for(;w.length<6;)w=f+w;return c+w},getRGB(w){let k;return w in y?(k=y[w],{r:k[0],g:k[1],b:k[2]}):w[0]===c?this._hexToRgb(w.substring(1)):w.substr(0,4)===v?(k=x.exec(w.replace(/ /g,"")),{r:parseInt(k[1],10),g:parseInt(k[2],10),b:parseInt(k[3],10)}):{r:0,g:0,b:0}},colorToRGBA(w){return w=w||"black",t.Util._namedColorToRBA(w)||t.Util._hex3ColorToRGBA(w)||t.Util._hex4ColorToRGBA(w)||t.Util._hex6ColorToRGBA(w)||t.Util._hex8ColorToRGBA(w)||t.Util._rgbColorToRGBA(w)||t.Util._rgbaColorToRGBA(w)||t.Util._hslColorToRGBA(w)},_namedColorToRBA(w){const k=y[w.toLowerCase()];return k?{r:k[0],g:k[1],b:k[2],a:1}:null},_rgbColorToRGBA(w){if(w.indexOf("rgb(")===0){w=w.match(/rgb\(([^)]+)\)/)[1];const k=w.split(/ *, */).map(Number);return{r:k[0],g:k[1],b:k[2],a:1}}},_rgbaColorToRGBA(w){if(w.indexOf("rgba(")===0){w=w.match(/rgba\(([^)]+)\)/)[1];const k=w.split(/ *, */).map((N,j)=>N.slice(-1)==="%"?j===3?parseInt(N)/100:parseInt(N)/100*255:Number(N));return{r:k[0],g:k[1],b:k[2],a:k[3]}}},_hex8ColorToRGBA(w){if(w[0]==="#"&&w.length===9)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:parseInt(w.slice(7,9),16)/255}},_hex6ColorToRGBA(w){if(w[0]==="#"&&w.length===7)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:1}},_hex4ColorToRGBA(w){if(w[0]==="#"&&w.length===5)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:parseInt(w[4]+w[4],16)/255}},_hex3ColorToRGBA(w){if(w[0]==="#"&&w.length===4)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:1}},_hslColorToRGBA(w){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(w)){const[k,...N]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(w),j=Number(N[0])/360,T=Number(N[1])/100,M=Number(N[2])/100;let A,_,D;if(T===0)return D=M*255,{r:Math.round(D),g:Math.round(D),b:Math.round(D),a:1};M<.5?A=M*(1+T):A=M+T-M*T;const R=2*M-A,I=[0,0,0];for(let $=0;$<3;$++)_=j+1/3*-($-1),_<0&&_++,_>1&&_--,6*_<1?D=R+(A-R)*6*_:2*_<1?D=A:3*_<2?D=R+(A-R)*(2/3-_)*6:D=R,I[$]=D*255;return{r:Math.round(I[0]),g:Math.round(I[1]),b:Math.round(I[2]),a:1}}},haveIntersection(w,k){return!(k.x>w.x+w.width||k.x+k.width<w.x||k.y>w.y+w.height||k.y+k.height<w.y)},cloneObject(w){const k={};for(const N in w)this._isPlainObject(w[N])?k[N]=this.cloneObject(w[N]):this._isArray(w[N])?k[N]=this.cloneArray(w[N]):k[N]=w[N];return k},cloneArray(w){return w.slice(0)},degToRad(w){return w*o},radToDeg(w){return w*l},_degToRad(w){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(w)},_radToDeg(w){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(w)},_getRotation(w){return e.Konva.angleDeg?t.Util.radToDeg(w):w},_capitalize(w){return w.charAt(0).toUpperCase()+w.slice(1)},throw(w){throw new Error(m+w)},error(w){console.error(m+w)},warn(w){e.Konva.showWarnings&&console.warn(h+w)},each(w,k){for(const N in w)k(N,w[N])},_inRange(w,k,N){return k<=w&&w<N},_getProjectionToSegment(w,k,N,j,T,M){let A,_,D;const R=(w-N)*(w-N)+(k-j)*(k-j);if(R==0)A=w,_=k,D=(T-N)*(T-N)+(M-j)*(M-j);else{const I=((T-w)*(N-w)+(M-k)*(j-k))/R;I<0?(A=w,_=k,D=(w-T)*(w-T)+(k-M)*(k-M)):I>1?(A=N,_=j,D=(N-T)*(N-T)+(j-M)*(j-M)):(A=w+I*(N-w),_=k+I*(j-k),D=(A-T)*(A-T)+(_-M)*(_-M))}return[A,_,D]},_getProjectionToLine(w,k,N){const j=t.Util.cloneObject(w);let T=Number.MAX_VALUE;return k.forEach(function(M,A){if(!N&&A===k.length-1)return;const _=k[(A+1)%k.length],D=t.Util._getProjectionToSegment(M.x,M.y,_.x,_.y,w.x,w.y),R=D[0],I=D[1],$=D[2];$<T&&(j.x=R,j.y=I,T=$)}),j},_prepareArrayForTween(w,k,N){let j,T=[],M=[];if(w.length>k.length){const _=k;k=w,w=_}for(j=0;j<w.length;j+=2)T.push({x:w[j],y:w[j+1]});for(j=0;j<k.length;j+=2)M.push({x:k[j],y:k[j+1]});const A=[];return M.forEach(function(_){const D=t.Util._getProjectionToLine(_,T,N);A.push(D.x),A.push(D.y)}),A},_prepareToStringify(w){let k;w.visitedByCircularReferenceRemoval=!0;for(const N in w)if(w.hasOwnProperty(N)&&w[N]&&typeof w[N]=="object"){if(k=Object.getOwnPropertyDescriptor(w,N),w[N].visitedByCircularReferenceRemoval||t.Util._isElement(w[N]))if(k.configurable)delete w[N];else return null;else if(t.Util._prepareToStringify(w[N])===null)if(k.configurable)delete w[N];else return null}return delete w.visitedByCircularReferenceRemoval,w},_assign(w,k){for(const N in k)w[N]=k[N];return w},_getFirstPointerId(w){return w.touches?w.changedTouches[0].identifier:w.pointerId||999},releaseCanvas(...w){e.Konva.releaseCanvasOnDestroy&&w.forEach(k=>{k.width=0,k.height=0})},drawRoundedRectPath(w,k,N,j){let T=0,M=0,A=0,_=0;typeof j=="number"?T=M=A=_=Math.min(j,k/2,N/2):(T=Math.min(j[0]||0,k/2,N/2),M=Math.min(j[1]||0,k/2,N/2),_=Math.min(j[2]||0,k/2,N/2),A=Math.min(j[3]||0,k/2,N/2)),w.moveTo(T,0),w.lineTo(k-M,0),w.arc(k-M,M,M,Math.PI*3/2,0,!1),w.lineTo(k,N-_),w.arc(k-_,N-_,_,0,Math.PI/2,!1),w.lineTo(A,N),w.arc(A,N-A,A,Math.PI/2,Math.PI,!1),w.lineTo(0,T),w.arc(T,T,T,Math.PI,Math.PI*3/2,!1)}}})(xr);var dr={},gt={},Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.RGBComponent=Yae;Ze.alphaComponent=Xae;Ze.getNumberValidator=Qae;Ze.getNumberOrArrayOfNumbersValidator=Jae;Ze.getNumberOrAutoValidator=Zae;Ze.getStringValidator=ese;Ze.getStringOrGradientValidator=tse;Ze.getFunctionValidator=rse;Ze.getNumberArrayValidator=nse;Ze.getBooleanValidator=ise;Ze.getComponentValidator=ase;const lo=pt,Er=xr;function co(t){return Er.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||Er.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function Yae(t){return t>255?255:t<0?0:Math.round(t)}function Xae(t){return t>1?1:t<1e-4?1e-4:t}function Qae(){if(lo.Konva.isUnminified)return function(t,e){return Er.Util._isNumber(t)||Er.Util.warn(co(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function Jae(t){if(lo.Konva.isUnminified)return function(e,r){const n=Er.Util._isNumber(e),i=Er.Util._isArray(e)&&e.length==t;return!n&&!i&&Er.Util.warn(co(e)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function Zae(){if(lo.Konva.isUnminified)return function(t,e){return Er.Util._isNumber(t)||t==="auto"||Er.Util.warn(co(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function ese(){if(lo.Konva.isUnminified)return function(t,e){return Er.Util._isString(t)||Er.Util.warn(co(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function tse(){if(lo.Konva.isUnminified)return function(t,e){const r=Er.Util._isString(t),n=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return r||n||Er.Util.warn(co(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function rse(){if(lo.Konva.isUnminified)return function(t,e){return Er.Util._isFunction(t)||Er.Util.warn(co(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function nse(){if(lo.Konva.isUnminified)return function(t,e){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&t instanceof r||(Er.Util._isArray(t)?t.forEach(function(n){Er.Util._isNumber(n)||Er.Util.warn('"'+e+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):Er.Util.warn(co(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function ise(){if(lo.Konva.isUnminified)return function(t,e){return t===!0||t===!1||Er.Util.warn(co(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function ase(t){if(lo.Konva.isUnminified)return function(e,r){return e==null||Er.Util.isObject(e)||Er.Util.warn(co(e)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+t),e}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=xr,r=Ze,n="get",i="set";t.Factory={addGetterSetter(a,s,o,l,c){t.Factory.addGetter(a,s,o),t.Factory.addSetter(a,s,l,c),t.Factory.addOverloadedGetterSetter(a,s)},addGetter(a,s,o){const l=n+e.Util._capitalize(s);a.prototype[l]=a.prototype[l]||function(){const c=this.attrs[s];return c===void 0?o:c}},addSetter(a,s,o,l){const c=i+e.Util._capitalize(s);a.prototype[c]||t.Factory.overWriteSetter(a,s,o,l)},overWriteSetter(a,s,o,l){const c=i+e.Util._capitalize(s);a.prototype[c]=function(u){return o&&u!==void 0&&u!==null&&(u=o.call(this,u,s)),this._setAttr(s,u),l&&l.call(this),this}},addComponentsGetterSetter(a,s,o,l,c){let u=o.length,f=e.Util._capitalize,h=n+f(s),m=i+f(s),v,y;a.prototype[h]=function(){const b={};for(v=0;v<u;v++)y=o[v],b[y]=this.getAttr(s+f(y));return b};const x=(0,r.getComponentValidator)(o);a.prototype[m]=function(b){let S=this.attrs[s],w;l&&(b=l.call(this,b)),x&&x.call(this,b,s);for(w in b)b.hasOwnProperty(w)&&this._setAttr(s+f(w),b[w]);return b||o.forEach(k=>{this._setAttr(s+f(k),void 0)}),this._fireChangeEvent(s,S,b),c&&c.call(this),this},t.Factory.addOverloadedGetterSetter(a,s)},addOverloadedGetterSetter(a,s){const o=e.Util._capitalize(s),l=i+o,c=n+o;a.prototype[s]=function(){return arguments.length?(this[l](arguments[0]),this):this[c]()}},addDeprecatedGetterSetter(a,s,o,l){e.Util.error("Adding deprecated "+s);const c=n+e.Util._capitalize(s),u=s+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[c]=function(){e.Util.error(u);const f=this.attrs[s];return f===void 0?o:f},t.Factory.addSetter(a,s,l,function(){e.Util.error(u)}),t.Factory.addOverloadedGetterSetter(a,s)},backCompat(a,s){e.Util.each(s,function(o,l){const c=a.prototype[l],u=n+e.Util._capitalize(o),f=i+e.Util._capitalize(o);function h(){c.apply(this,arguments),e.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}a.prototype[o]=h,a.prototype[u]=h,a.prototype[f]=h})},afterSetFilter(){this._filterUpToDate=!1}}})(gt);var Oa={},Ys={};Object.defineProperty(Ys,"__esModule",{value:!0});Ys.HitContext=Ys.SceneContext=Ys.Context=void 0;const CI=xr,sse=pt;function ose(t){let e=[],r=t.length,n=CI.Util,i,a;for(i=0;i<r;i++)a=t[i],n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),e.push(a);return e}const sM=",",lse="(",cse=")",use="([",dse="])",fse=";",hse="()",pse="=",oM=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],mse=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],gse=100;class Dx{constructor(e){this.canvas=e,sse.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,r){let n=this.traceArr,i=n.length,a="",s,o,l,c;for(s=0;s<i;s++)o=n[s],l=o.method,l?(c=o.args,a+=l,e?a+=hse:CI.Util._isArray(c[0])?a+=use+c.join(sM)+dse:(r&&(c=c.map(u=>typeof u=="number"?Math.floor(u):u)),a+=lse+c.join(sM)+cse)):(a+=o.property,e||(a+=pse+o.val)),a+=fse;return a}clearTrace(){this.traceArr=[]}_trace(e){let r=this.traceArr,n;r.push(e),n=r.length,n>=gse&&r.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const r=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(e){const r=e.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(e){const r=e.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(e){const r=e.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(e,r){this._context[e]=r}arc(e,r,n,i,a,s){this._context.arc(e,r,n,i,a,s)}arcTo(e,r,n,i,a){this._context.arcTo(e,r,n,i,a)}beginPath(){this._context.beginPath()}bezierCurveTo(e,r,n,i,a,s){this._context.bezierCurveTo(e,r,n,i,a,s)}clearRect(e,r,n,i){this._context.clearRect(e,r,n,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,r){const n=arguments;if(n.length===2)return this._context.createImageData(e,r);if(n.length===1)return this._context.createImageData(e)}createLinearGradient(e,r,n,i){return this._context.createLinearGradient(e,r,n,i)}createPattern(e,r){return this._context.createPattern(e,r)}createRadialGradient(e,r,n,i,a,s){return this._context.createRadialGradient(e,r,n,i,a,s)}drawImage(e,r,n,i,a,s,o,l,c){const u=arguments,f=this._context;u.length===3?f.drawImage(e,r,n):u.length===5?f.drawImage(e,r,n,i,a):u.length===9&&f.drawImage(e,r,n,i,a,s,o,l,c)}ellipse(e,r,n,i,a,s,o,l){this._context.ellipse(e,r,n,i,a,s,o,l)}isPointInPath(e,r,n,i){return n?this._context.isPointInPath(n,e,r,i):this._context.isPointInPath(e,r,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,r,n,i){this._context.fillRect(e,r,n,i)}strokeRect(e,r,n,i){this._context.strokeRect(e,r,n,i)}fillText(e,r,n,i){i?this._context.fillText(e,r,n,i):this._context.fillText(e,r,n)}measureText(e){return this._context.measureText(e)}getImageData(e,r,n,i){return this._context.getImageData(e,r,n,i)}lineTo(e,r){this._context.lineTo(e,r)}moveTo(e,r){this._context.moveTo(e,r)}rect(e,r,n,i){this._context.rect(e,r,n,i)}roundRect(e,r,n,i,a){this._context.roundRect(e,r,n,i,a)}putImageData(e,r,n){this._context.putImageData(e,r,n)}quadraticCurveTo(e,r,n,i){this._context.quadraticCurveTo(e,r,n,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,r){this._context.scale(e,r)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,r,n,i,a,s){this._context.setTransform(e,r,n,i,a,s)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,r,n,i){this._context.strokeText(e,r,n,i)}transform(e,r,n,i,a,s){this._context.transform(e,r,n,i,a,s)}translate(e,r){this._context.translate(e,r)}_enableTrace(){let e=this,r=oM.length,n=this.setAttr,i,a;const s=function(o){let l=e[o],c;e[o]=function(){return a=ose(Array.prototype.slice.call(arguments,0)),c=l.apply(e,arguments),e._trace({method:o,args:a}),c}};for(i=0;i<r;i++)s(oM[i]);e.setAttr=function(){n.apply(e,arguments);const o=arguments[0];let l=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),e._trace({property:o,val:l})}}_applyGlobalCompositeOperation(e){const r=e.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}Ys.Context=Dx;mse.forEach(function(t){Object.defineProperty(Dx.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class vse extends Dx{constructor(e,{willReadFrequently:r=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(e){const r=e.fill();this.setAttr("fillStyle",r),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const r=e._getLinearGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fillRadialGradient(e){const r=e._getRadialGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fill(e){const r=e.fill(),n=e.getFillPriority();if(r&&n==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&n==="pattern"){this._fillPattern(e);return}const a=e.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(e);return}const s=e.getFillRadialGradientColorStops();if(s&&n==="radial-gradient"){this._fillRadialGradient(e);return}r?this._fillColor(e):i?this._fillPattern(e):a?this._fillLinearGradient(e):s&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const r=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(i){for(let s=0;s<i.length;s+=2)a.addColorStop(i[s],i[s+1]);this.setAttr("strokeStyle",a)}}_stroke(e){const r=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e),r&&e.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var r,n,i;const a=(r=e.getShadowRGBA())!==null&&r!==void 0?r:"black",s=(n=e.getShadowBlur())!==null&&n!==void 0?n:5,o=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},l=e.getAbsoluteScale(),c=this.canvas.getPixelRatio(),u=l.x*c,f=l.y*c;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",s*Math.min(Math.abs(u),Math.abs(f))),this.setAttr("shadowOffsetX",o.x*u),this.setAttr("shadowOffsetY",o.y*f)}}Ys.SceneContext=vse;class yse extends Dx{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const r=e.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e);const n=e.hitStrokeWidth(),i=n==="auto"?e.strokeWidth():n;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),r||this.restore()}}}Ys.HitContext=yse;Object.defineProperty(Oa,"__esModule",{value:!0});Oa.HitCanvas=Oa.SceneCanvas=Oa.Canvas=void 0;const jy=xr,NI=Ys,EI=pt,xse=gt,bse=Ze;let uv;function wse(){if(uv)return uv;const t=jy.Util.createCanvasElement(),e=t.getContext("2d");return uv=function(){const r=EI.Konva._global.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return r/n}(),jy.Util.releaseCanvas(t),uv}class Ox{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(e||{}).pixelRatio||EI.Konva.pixelRatio||wse();this.pixelRatio=n,this._canvas=jy.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const r=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,r){this.setWidth(e||0),this.setHeight(r||0)}toDataURL(e,r){try{return this._canvas.toDataURL(e,r)}catch{try{return this._canvas.toDataURL()}catch(i){return jy.Util.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Oa.Canvas=Ox;xse.Factory.addGetterSetter(Ox,"pixelRatio",void 0,(0,bse.getNumberValidator)());class Sse extends Ox{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new NI.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}Oa.SceneCanvas=Sse;class kse extends Ox{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new NI.HitContext(this),this.setSize(e.width,e.height)}}Oa.HitCanvas=kse;var Ix={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=pt,r=xr;t.DD={get isDragging(){let n=!1;return t.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return t.DD._dragElements.forEach(i=>{n=i.node}),n},_dragElements:new Map,_drag(n){const i=[];t.DD._dragElements.forEach((a,s)=>{const{node:o}=a,l=o.getStage();l.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const c=l._changedPointerPositions.find(u=>u.id===a.pointerId);if(c){if(a.dragStatus!=="dragging"){const u=o.dragDistance();if(Math.max(Math.abs(c.x-a.startPointerPos.x),Math.abs(c.y-a.startPointerPos.y))<u||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),i.push(o)}}),i.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const i=[];t.DD._dragElements.forEach(a=>{const{node:s}=a,o=s.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(u=>u.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,a.dragStatus="stopped");const c=a.node.getLayer()||a.node instanceof e.Konva.Stage&&a.node;c&&i.indexOf(c)===-1&&i.push(c)}),i.forEach(a=>{a.draw()})},_endDragAfter(n){t.DD._dragElements.forEach((i,a)=>{i.dragStatus==="stopped"&&i.node.fire("dragend",{type:"dragend",target:i.node,evt:n},!0),i.dragStatus!=="dragging"&&t.DD._dragElements.delete(a)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(Ix);Object.defineProperty(dr,"__esModule",{value:!0});dr.Node=void 0;const St=xr,vm=gt,dh=Oa,Po=pt,Yi=Ix,Or=Ze,Gv="absoluteOpacity",dv="allEventListeners",Ls="absoluteTransform",lM="absoluteScale",sc="canvas",Cse="Change",Nse="children",Ese="konva",zk="listening",cM="mouseenter",uM="mouseleave",dM="set",fM="Shape",Hv=" ",hM="stage",Ao="transform",Tse="Stage",Vk="visible",jse=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Hv);let Mse=1;class it{constructor(e){this._id=Mse++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Ao||e===Ls)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,r){let n=this._cache.get(e);return(n===void 0||(e===Ao||e===Ls)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(e,n)),n}_calculate(e,r,n){if(!this._attachedDepsListeners.get(e)){const i=r.map(a=>a+"Change.konva").join(Hv);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(sc)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Ls&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(sc)){const{scene:e,filter:r,hit:n}=this._cache.get(sc);St.Util.releaseCanvas(e,r,n),this._cache.delete(sc)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const r=e||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),s=r.pixelRatio,o=r.x===void 0?Math.floor(n.x):r.x,l=r.y===void 0?Math.floor(n.y):r.y,c=r.offset||0,u=r.drawBorder||!1,f=r.hitCanvasPixelRatio||1;if(!i||!a){St.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const h=Math.abs(Math.round(n.x)-o)>.5?1:0,m=Math.abs(Math.round(n.y)-l)>.5?1:0;i+=c*2+h,a+=c*2+m,o-=c,l-=c;const v=new dh.SceneCanvas({pixelRatio:s,width:i,height:a}),y=new dh.SceneCanvas({pixelRatio:s,width:0,height:0,willReadFrequently:!0}),x=new dh.HitCanvas({pixelRatio:f,width:i,height:a}),b=v.getContext(),S=x.getContext();return x.isCache=!0,v.isCache=!0,this._cache.delete(sc),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,y.getContext()._context.imageSmoothingEnabled=!1),b.save(),S.save(),b.translate(-o,-l),S.translate(-o,-l),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Gv),this._clearSelfAndDescendantCache(lM),this.drawScene(v,this),this.drawHit(x,this),this._isUnderCache=!1,b.restore(),S.restore(),u&&(b.save(),b.beginPath(),b.rect(0,0,i,a),b.closePath(),b.setAttr("strokeStyle","red"),b.setAttr("lineWidth",5),b.stroke(),b.restore()),this._cache.set(sc,{scene:v,filter:y,hit:x,x:o,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(sc)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,r){const n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,a=1/0,s=-1/0,o=-1/0;const l=this.getAbsoluteTransform(r);return n.forEach(function(c){const u=l.point(c);i===void 0&&(i=s=u.x,a=o=u.y),i=Math.min(i,u.x),a=Math.min(a,u.y),s=Math.max(s,u.x),o=Math.max(o,u.y)}),{x:i,y:a,width:s-i,height:o-a}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();e.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),i=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/i,n.height/i),e.restore()}_drawCachedHitCanvas(e){const r=this._getCanvasCache(),n=r.hit;e.save(),e.translate(r.x,r.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),r=this._getCanvasCache(),n=r.scene,i=r.filter,a=i.getContext(),s,o,l,c;if(e){if(!this._filterUpToDate){const u=n.pixelRatio;i.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(s=e.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/u,n.getHeight()/u),o=a.getImageData(0,0,i.getWidth(),i.getHeight()),l=0;l<s;l++){if(c=e[l],typeof c!="function"){St.Util.error("Filter should be type of function, but got "+typeof c+" instead. Please check correct filters");continue}c.call(this,o),a.putImageData(o,0,0)}}catch(f){St.Util.error("Unable to apply filter. "+f.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return i}return n}on(e,r){if(this._cache&&this._cache.delete(dv),arguments.length===3)return this._delegate.apply(this,arguments);let n=e.split(Hv),i=n.length,a,s,o,l,c;for(a=0;a<i;a++)s=n[a],o=s.split("."),l=o[0],c=o[1]||"",this.eventListeners[l]||(this.eventListeners[l]=[]),this.eventListeners[l].push({name:c,handler:r});return this}off(e,r){let n=(e||"").split(Hv),i=n.length,a,s,o,l,c,u;if(this._cache&&this._cache.delete(dv),!e)for(s in this.eventListeners)this._off(s);for(a=0;a<i;a++)if(o=n[a],l=o.split("."),c=l[0],u=l[1],c)this.eventListeners[c]&&this._off(c,u,r);else for(s in this.eventListeners)this._off(s,u,r);return this}dispatchEvent(e){const r={target:this,type:e.type,evt:e};return this.fire(e.type,r),this}addEventListener(e,r){return this.on(e,function(n){r.call(this,n.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,r,n){const i=this;this.on(e,function(a){const s=a.target.findAncestors(r,!0,i);for(let o=0;o<s.length;o++)a=St.Util.cloneObject(a),a.currentTarget=s[o],n.call(s[o],a)})}remove(){return this.isDragging()&&this.stopDrag(),Yi.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ls),this._clearSelfAndDescendantCache(Gv),this._clearSelfAndDescendantCache(lM),this._clearSelfAndDescendantCache(hM),this._clearSelfAndDescendantCache(Vk),this._clearSelfAndDescendantCache(zk)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const r="get"+St.Util._capitalize(e);return St.Util._isFunction(this[r])?this[r]():this.attrs[e]}getAncestors(){let e=this.getParent(),r=[];for(;e;)r.push(e),e=e.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let r,n;if(!e)return this;for(r in e)r!==Nse&&(n=dM+St.Util._capitalize(r),St.Util._isFunction(this[n])?this[n](e[r]):this._setAttr(r,e[r]))}),this}isListening(){return this._getCache(zk,this._isListening)}_isListening(e){if(!this.listening())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(Vk,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,r=!1){if(e)return this._isVisible(e)&&this._isListening(e);const n=this.getLayer();let i=!1;Yi.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(s.node.nodeType==="Stage"||s.node.getLayer()===n)&&(i=!0)});const a=!r&&!Po.Konva.hitOnDragEnabled&&(i||Po.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),r=this,n=0,i,a,s,o;function l(u){for(i=[],a=u.length,s=0;s<a;s++)o=u[s],n++,o.nodeType!==fM&&(i=i.concat(o.getChildren().slice())),o._id===r._id&&(s=a);i.length>0&&i[0].getDepth()<=e&&l(i)}const c=this.getStage();return r.nodeType!==Tse&&c&&l(c.getChildren()),n}getDepth(){let e=0,r=this.parent;for(;r;)e++,r=r.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Ao),this._clearSelfAndDescendantCache(Ls)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const r=e.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(e){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),a=new St.Transform,s=this.offset();return a.m=i.slice(),a.translate(s.x,s.y),a.getTranslation()}setAbsolutePosition(e){const{x:r,y:n,...i}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(Ao);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(e.x,e.y),e={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(Ao),this._clearSelfAndDescendantCache(Ls),this}_setTransform(e){let r;for(r in e)this.attrs[r]=e[r]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let r=e.x,n=e.y,i=this.x(),a=this.y();return r!==void 0&&(i+=r),n!==void 0&&(a+=n),this.setPosition({x:i,y:a}),this}_eachAncestorReverse(e,r){let n=[],i=this.getParent(),a,s;if(!(r&&r._id===this._id)){for(n.unshift(this);i&&(!r||i._id!==r._id);)n.unshift(i),i=i.parent;for(a=n.length,s=0;s<a;s++)e(n[s])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return St.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return St.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return St.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return St.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return St.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&St.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Gv,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(e*=r.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),r,n,i,a,s;const o={attrs:{},className:this.getClassName()};for(r in e)n=e[r],s=St.Util.isObject(n)&&!St.Util._isPlainObject(n)&&!St.Util._isArray(n),!s&&(i=typeof this[r]=="function"&&this[r],delete e[r],a=i?i.call(this):null,e[r]=n,a!==n&&(o.attrs[r]=n));return St.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,r,n){const i=[];r&&this._isMatch(e)&&i.push(this);let a=this.parent;for(;a;){if(a===n)return i;a._isMatch(e)&&i.push(a),a=a.parent}return i}isAncestorOf(e){return!1}findAncestor(e,r,n){return this.findAncestors(e,r,n)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let r=e.replace(/ /g,"").split(","),n=r.length,i,a;for(i=0;i<n;i++)if(a=r[i],St.Util.isValidSelector(a)||(St.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),St.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),St.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(hM,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,r={},n){return r.target=r.target||this,n?this._fireAndBubble(e,r):this._fire(e,r),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Ls,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let r;if(e)return r=new St.Transform,this._eachAncestorReverse(function(n){const i=n.transformsEnabled();i==="all"?r.multiply(n.getTransform()):i==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},e),r;{r=this._cache.get(Ls)||new St.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const i=this.attrs.x||0,a=this.attrs.y||0,s=this.attrs.offsetX||0,o=this.attrs.offsetY||0;r.translate(i-s,a-o)}return r.dirty=!1,r}}getAbsoluteScale(e){let r=this;for(;r;)r._isUnderCache&&(e=r),r=r.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Ao,this._getTransform)}_getTransform(){var e,r;const n=this._cache.get(Ao)||new St.Transform;n.reset();const i=this.x(),a=this.y(),s=Po.Konva.getAngle(this.rotation()),o=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,l=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,c=this.attrs.skewX||0,u=this.attrs.skewY||0,f=this.attrs.offsetX||0,h=this.attrs.offsetY||0;return(i!==0||a!==0)&&n.translate(i,a),s!==0&&n.rotate(s),(c!==0||u!==0)&&n.skew(c,u),(o!==1||l!==1)&&n.scale(o,l),(f!==0||h!==0)&&n.translate(-1*f,-1*h),n.dirty=!1,n}clone(e){let r=St.Util.cloneObject(this.attrs),n,i,a,s,o;for(n in e)r[n]=e[n];const l=new this.constructor(r);for(n in this.eventListeners)for(i=this.eventListeners[n],a=i.length,s=0;s<a;s++)o=i[s],o.name.indexOf(Ese)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(o));return l}_toKonvaCanvas(e){e=e||{};const r=this.getClientRect(),n=this.getStage(),i=e.x!==void 0?e.x:Math.floor(r.x),a=e.y!==void 0?e.y:Math.floor(r.y),s=e.pixelRatio||1,o=new dh.SceneCanvas({width:e.width||Math.ceil(r.width)||(n?n.width():0),height:e.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:s}),l=o.getContext(),c=new dh.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(i),height:o.height/o.pixelRatio+Math.abs(a),pixelRatio:o.pixelRatio});return e.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(i||a)&&l.translate(-1*i,-1*a),this.drawScene(o,void 0,c),l.restore(),o}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const r=e.mimeType||null,n=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(r,n);return e.callback&&e.callback(i),i}toImage(e){return new Promise((r,n)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,St.Util._urlToImage(this.toDataURL(e),function(a){r(a),i==null||i(a)})}catch(i){n(i)}})}toBlob(e){return new Promise((r,n)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(a=>{r(a),i==null||i(a)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){n(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Po.Konva.dragDistance}_off(e,r,n){let i=this.eventListeners[e],a,s,o;for(a=0;a<i.length;a++)if(s=i[a].name,o=i[a].handler,(s!=="konva"||r==="konva")&&(!r||s===r)&&(!n||n===o)){if(i.splice(a,1),i.length===0){delete this.eventListeners[e];break}a--}}_fireChangeEvent(e,r,n){this._fire(e+Cse,{oldVal:r,newVal:n})}addName(e){if(!this.hasName(e)){const r=this.name(),n=r?r+" "+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const r=(this.name()||"").split(/\s/g),n=r.indexOf(e);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(e,r){const n=this[dM+St.Util._capitalize(e)];return St.Util._isFunction(n)?n.call(this,r):this._setAttr(e,r),this}_requestDraw(){if(Po.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,r){const n=this.attrs[e];n===r&&!St.Util.isObject(r)||(r==null?delete this.attrs[e]:this.attrs[e]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,r),this._requestDraw())}_setComponentAttr(e,r,n){let i;n!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][r]=n,this._fireChangeEvent(e,i,n))}_fireAndBubble(e,r,n){if(r&&this.nodeType===fM&&(r.target=this),!((e===cM||e===uM)&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(e,r);const a=(e===cM||e===uM)&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!a&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,r,n):this._fireAndBubble.call(this.parent,e,r))}}_getProtoListeners(e){var r,n,i;const a=(r=this._cache.get(dv))!==null&&r!==void 0?r:{};let s=a==null?void 0:a[e];if(s===void 0){s=[];let o=Object.getPrototypeOf(this);for(;o;){const l=(i=(n=o.eventListeners)===null||n===void 0?void 0:n[e])!==null&&i!==void 0?i:[];s.push(...l),o=Object.getPrototypeOf(o)}a[e]=s,this._cache.set(dv,a)}return s}_fire(e,r){r=r||{},r.currentTarget=this,r.type=e;const n=this._getProtoListeners(e);if(n)for(var i=0;i<n.length;i++)n[i].handler.call(this,r);const a=this.eventListeners[e];if(a)for(var i=0;i<a.length;i++)a[i].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const r=e?e.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||i;Yi.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-i.x,y:a.y-i.y},dragStatus:"ready",pointerId:r})}startDrag(e,r=!0){Yi.DD._dragElements.has(this._id)||this._createDragElement(e);const n=Yi.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},r)}_setDragPosition(e,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let i={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const s=a.call(this,i,e);s?i=s:St.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const r=Yi.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),Yi.DD._endDragBefore(e),Yi.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Yi.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||Po.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;Yi.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=Yi.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",i=r&&r.dragStatus==="ready";n?this.stopDrag():i&&Yi.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-e.x,y:-e.y,width:r.width()+2*e.x,height:r.height()+2*e.y};return St.Util.haveIntersection(n,this.getClientRect())}static create(e,r){return St.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,r)}static _createNode(e,r){let n=it.prototype.getClassName.call(e),i=e.children,a,s,o;r&&(e.attrs.container=r),Po.Konva[n]||(St.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const l=Po.Konva[n];if(a=new l(e.attrs),i)for(s=i.length,o=0;o<s;o++)a.add(it._createNode(i[o]));return a}}dr.Node=it;it.prototype.nodeType="Node";it.prototype._attrsAffectingSize=[];it.prototype.eventListeners={};it.prototype.on.call(it.prototype,jse,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Ao),this._clearSelfAndDescendantCache(Ls)});it.prototype.on.call(it.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Vk)});it.prototype.on.call(it.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(zk)});it.prototype.on.call(it.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Gv)});const qt=vm.Factory.addGetterSetter;qt(it,"zIndex");qt(it,"absolutePosition");qt(it,"position");qt(it,"x",0,(0,Or.getNumberValidator)());qt(it,"y",0,(0,Or.getNumberValidator)());qt(it,"globalCompositeOperation","source-over",(0,Or.getStringValidator)());qt(it,"opacity",1,(0,Or.getNumberValidator)());qt(it,"name","",(0,Or.getStringValidator)());qt(it,"id","",(0,Or.getStringValidator)());qt(it,"rotation",0,(0,Or.getNumberValidator)());vm.Factory.addComponentsGetterSetter(it,"scale",["x","y"]);qt(it,"scaleX",1,(0,Or.getNumberValidator)());qt(it,"scaleY",1,(0,Or.getNumberValidator)());vm.Factory.addComponentsGetterSetter(it,"skew",["x","y"]);qt(it,"skewX",0,(0,Or.getNumberValidator)());qt(it,"skewY",0,(0,Or.getNumberValidator)());vm.Factory.addComponentsGetterSetter(it,"offset",["x","y"]);qt(it,"offsetX",0,(0,Or.getNumberValidator)());qt(it,"offsetY",0,(0,Or.getNumberValidator)());qt(it,"dragDistance",null,(0,Or.getNumberValidator)());qt(it,"width",0,(0,Or.getNumberValidator)());qt(it,"height",0,(0,Or.getNumberValidator)());qt(it,"listening",!0,(0,Or.getBooleanValidator)());qt(it,"preventDefault",!0,(0,Or.getBooleanValidator)());qt(it,"filters",null,function(t){return this._filterUpToDate=!1,t});qt(it,"visible",!0,(0,Or.getBooleanValidator)());qt(it,"transformsEnabled","all",(0,Or.getStringValidator)());qt(it,"size");qt(it,"dragBoundFunc");qt(it,"draggable",!1,(0,Or.getBooleanValidator)());vm.Factory.backCompat(it,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var iu={};Object.defineProperty(iu,"__esModule",{value:!0});iu.Container=void 0;const uf=gt,ES=dr,Lx=Ze;class au extends ES.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const r=this.children||[],n=[];return r.forEach(function(i){e(i)&&n.push(i)}),n}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let n=0;n<e.length;n++)this.add(e[n]);return this}const r=e[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const r=this._generalFind(e,!0);return r.length>0?r[0]:void 0}_generalFind(e,r){const n=[];return this._descendants(i=>{const a=i._isMatch(e);return a&&n.push(i),!!(a&&r)}),n}_descendants(e){let r=!1;const n=this.getChildren();for(const i of n){if(r=e(i),r)return!0;if(i.hasChildren()&&(r=i._descendants(e),r))return!0}return!1}toObject(){const e=ES.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(r=>{e.children.push(r.toObject())}),e}isAncestorOf(e){let r=e.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(e){const r=ES.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(e){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(e)&&r.push(n)}),r}_clearSelfAndDescendantCache(e){var r;super._clearSelfAndDescendantCache(e),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(e,r,n){const i=this.getLayer(),a=e||i&&i.getCanvas(),s=a&&a.getContext(),o=this._getCanvasCache(),l=o&&o.scene,c=a&&a.isCache;if(!this.isVisible()&&!c)return this;if(l){s.save();const u=this.getAbsoluteTransform(r).getMatrix();s.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedSceneCanvas(s),s.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(e,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),i=e||n&&n.hitCanvas,a=i&&i.getContext(),s=this._getCanvasCache();if(s&&s.hit){a.save();const l=this.getAbsoluteTransform(r).getMatrix();a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",i,r);return this}_drawChildren(e,r,n,i){var a;const s=r&&r.getContext(),o=this.clipWidth(),l=this.clipHeight(),c=this.clipFunc(),u=typeof o=="number"&&typeof l=="number"||c,f=n===this;if(u){s.save();const m=this.getAbsoluteTransform(n);let v=m.getMatrix();s.transform(v[0],v[1],v[2],v[3],v[4],v[5]),s.beginPath();let y;if(c)y=c.call(this,s,this);else{const x=this.clipX(),b=this.clipY();s.rect(x||0,b||0,o,l)}s.clip.apply(s,y),v=m.copy().invert().getMatrix(),s.transform(v[0],v[1],v[2],v[3],v[4],v[5])}const h=!f&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";h&&(s.save(),s._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(m){m[e](r,n,i)}),h&&s.restore(),u&&s.restore()}getClientRect(e={}){var r;const n=e.skipTransform,i=e.relativeTo;let a,s,o,l,c={x:1/0,y:1/0,width:0,height:0};const u=this;(r=this.children)===null||r===void 0||r.forEach(function(m){if(!m.visible())return;const v=m.getClientRect({relativeTo:u,skipShadow:e.skipShadow,skipStroke:e.skipStroke});v.width===0&&v.height===0||(a===void 0?(a=v.x,s=v.y,o=v.x+v.width,l=v.y+v.height):(a=Math.min(a,v.x),s=Math.min(s,v.y),o=Math.max(o,v.x+v.width),l=Math.max(l,v.y+v.height)))});const f=this.find("Shape");let h=!1;for(let m=0;m<f.length;m++)if(f[m]._isVisible(this)){h=!0;break}return h&&a!==void 0?c={x:a,y:s,width:o-a,height:l-s}:c={x:0,y:0,width:0,height:0},n?c:this._transformedRect(c,i)}}iu.Container=au;uf.Factory.addComponentsGetterSetter(au,"clip",["x","y","width","height"]);uf.Factory.addGetterSetter(au,"clipX",void 0,(0,Lx.getNumberValidator)());uf.Factory.addGetterSetter(au,"clipY",void 0,(0,Lx.getNumberValidator)());uf.Factory.addGetterSetter(au,"clipWidth",void 0,(0,Lx.getNumberValidator)());uf.Factory.addGetterSetter(au,"clipHeight",void 0,(0,Lx.getNumberValidator)());uf.Factory.addGetterSetter(au,"clipFunc");var TI={},Bl={};Object.defineProperty(Bl,"__esModule",{value:!0});Bl.getCapturedShape=_se;Bl.createEvent=uN;Bl.hasPointerCapture=Ase;Bl.setPointerCapture=Rse;Bl.releaseCapture=MI;const Pse=pt,Vp=new Map,jI=Pse.Konva._global.PointerEvent!==void 0;function _se(t){return Vp.get(t)}function uN(t){return{evt:t,pointerId:t.pointerId}}function Ase(t,e){return Vp.get(t)===e}function Rse(t,e){MI(t),e.getStage()&&(Vp.set(t,e),jI&&e._fire("gotpointercapture",uN(new PointerEvent("gotpointercapture"))))}function MI(t,e){const r=Vp.get(t);if(!r)return;const n=r.getStage();n&&n.content,Vp.delete(t),jI&&r._fire("lostpointercapture",uN(new PointerEvent("lostpointercapture")))}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=xr,r=gt,n=iu,i=pt,a=Oa,s=Ix,o=pt,l=Bl,c="Stage",u="string",f="px",h="mouseout",m="mouseleave",v="mouseover",y="mouseenter",x="mousemove",b="mousedown",S="mouseup",w="pointermove",k="pointerdown",N="pointerup",j="pointercancel",T="lostpointercapture",M="pointerout",A="pointerleave",_="pointerover",D="pointerenter",R="contextmenu",I="touchstart",$="touchend",B="touchmove",z="touchcancel",U="wheel",F=5,Q=[[y,"_pointerenter"],[b,"_pointerdown"],[x,"_pointermove"],[S,"_pointerup"],[m,"_pointerleave"],[I,"_pointerdown"],[B,"_pointermove"],[$,"_pointerup"],[z,"_pointercancel"],[v,"_pointerover"],[U,"_wheel"],[R,"_contextmenu"],[k,"_pointerdown"],[w,"_pointermove"],[N,"_pointerup"],[j,"_pointercancel"],[T,"_lostpointercapture"]],K={mouse:{[M]:h,[A]:m,[_]:v,[D]:y,[w]:x,[k]:b,[N]:S,[j]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[M]:"touchout",[A]:"touchleave",[_]:"touchover",[D]:"touchenter",[w]:B,[k]:I,[N]:$,[j]:z,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[M]:M,[A]:A,[_]:_,[D]:D,[w]:w,[k]:k,[N]:N,[j]:j,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},L=de=>de.indexOf("pointer")>=0?"pointer":de.indexOf("touch")>=0?"touch":"mouse",G=de=>{const W=L(de);if(W==="pointer")return i.Konva.pointerEventsEnabled&&K.pointer;if(W==="touch")return K.touch;if(W==="mouse")return K.mouse};function ee(de={}){return(de.clipFunc||de.clipWidth||de.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),de}const re="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class se extends n.Container{constructor(W){super(ee(W)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ee(this.attrs)}),this._checkVisibility()}_validateAdd(W){const ne=W.getType()==="Layer",ie=W.getType()==="FastLayer";ne||ie||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const W=this.visible()?"":"none";this.content.style.display=W}setContainer(W){if(typeof W===u){if(W.charAt(0)==="."){const ie=W.slice(1);W=document.getElementsByClassName(ie)[0]}else{var ne;W.charAt(0)!=="#"?ne=W:ne=W.slice(1),W=document.getElementById(ne)}if(!W)throw"Can not find container in document with id "+ne}return this._setAttr("container",W),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),W.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let W=this.children,ne=W.length,ie;for(ie=0;ie<ne;ie++)W[ie].clear();return this}clone(W){return W||(W={}),W.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,W)}destroy(){super.destroy();const W=this.content;W&&e.Util._isInDocument(W)&&this.container().removeChild(W);const ne=t.stages.indexOf(this);return ne>-1&&t.stages.splice(ne,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const W=this._pointerPositions[0]||this._changedPointerPositions[0];return W?{x:W.x,y:W.y}:(e.Util.warn(re),null)}_getPointerById(W){return this._pointerPositions.find(ne=>ne.id===W)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(W){W=W||{},W.x=W.x||0,W.y=W.y||0,W.width=W.width||this.width(),W.height=W.height||this.height();const ne=new a.SceneCanvas({width:W.width,height:W.height,pixelRatio:W.pixelRatio||1}),ie=ne.getContext()._context,V=this.children;return(W.x||W.y)&&ie.translate(-1*W.x,-1*W.y),V.forEach(function(Y){if(!Y.isVisible())return;const te=Y._toKonvaCanvas(W);ie.drawImage(te._canvas,W.x,W.y,te.getWidth()/te.getPixelRatio(),te.getHeight()/te.getPixelRatio())}),ne}getIntersection(W){if(!W)return null;let ne=this.children,ie=ne.length,V=ie-1,Y;for(Y=V;Y>=0;Y--){const te=ne[Y].getIntersection(W);if(te)return te}return null}_resizeDOM(){const W=this.width(),ne=this.height();this.content&&(this.content.style.width=W+f,this.content.style.height=ne+f),this.bufferCanvas.setSize(W,ne),this.bufferHitCanvas.setSize(W,ne),this.children.forEach(ie=>{ie.setSize({width:W,height:ne}),ie.draw()})}add(W,...ne){if(arguments.length>1){for(let V=0;V<arguments.length;V++)this.add(arguments[V]);return this}super.add(W);const ie=this.children.length;return ie>F&&e.Util.warn("The stage has "+ie+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),W.setSize({width:this.width(),height:this.height()}),W.draw(),i.Konva.isBrowser&&this.content.appendChild(W.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(W){return l.hasPointerCapture(W,this)}setPointerCapture(W){l.setPointerCapture(W,this)}releaseCapture(W){l.releaseCapture(W,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&Q.forEach(([W,ne])=>{this.content.addEventListener(W,ie=>{this[ne](ie)},{passive:!1})})}_pointerenter(W){this.setPointersPositions(W);const ne=G(W.type);ne&&this._fire(ne.pointerenter,{evt:W,target:this,currentTarget:this})}_pointerover(W){this.setPointersPositions(W);const ne=G(W.type);ne&&this._fire(ne.pointerover,{evt:W,target:this,currentTarget:this})}_getTargetShape(W){let ne=this[W+"targetShape"];return ne&&!ne.getStage()&&(ne=null),ne}_pointerleave(W){const ne=G(W.type),ie=L(W.type);if(!ne)return;this.setPointersPositions(W);const V=this._getTargetShape(ie),Y=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;V&&Y?(V._fireAndBubble(ne.pointerout,{evt:W}),V._fireAndBubble(ne.pointerleave,{evt:W}),this._fire(ne.pointerleave,{evt:W,target:this,currentTarget:this}),this[ie+"targetShape"]=null):Y&&(this._fire(ne.pointerleave,{evt:W,target:this,currentTarget:this}),this._fire(ne.pointerout,{evt:W,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(W){const ne=G(W.type),ie=L(W.type);if(!ne)return;this.setPointersPositions(W);let V=!1;this._changedPointerPositions.forEach(Y=>{const te=this.getIntersection(Y);if(s.DD.justDragged=!1,i.Konva["_"+ie+"ListenClick"]=!0,!te||!te.isListening()){this[ie+"ClickStartShape"]=void 0;return}i.Konva.capturePointerEventsEnabled&&te.setPointerCapture(Y.id),this[ie+"ClickStartShape"]=te,te._fireAndBubble(ne.pointerdown,{evt:W,pointerId:Y.id}),V=!0;const Z=W.type.indexOf("touch")>=0;te.preventDefault()&&W.cancelable&&Z&&W.preventDefault()}),V||this._fire(ne.pointerdown,{evt:W,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(W){const ne=G(W.type),ie=L(W.type);if(!ne||(i.Konva.isDragging()&&s.DD.node.preventDefault()&&W.cancelable&&W.preventDefault(),this.setPointersPositions(W),!(!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled)))return;const Y={};let te=!1;const Z=this._getTargetShape(ie);this._changedPointerPositions.forEach(ue=>{const ge=l.getCapturedShape(ue.id)||this.getIntersection(ue),Ue=ue.id,Pe={evt:W,pointerId:Ue},ze=Z!==ge;if(ze&&Z&&(Z._fireAndBubble(ne.pointerout,{...Pe},ge),Z._fireAndBubble(ne.pointerleave,{...Pe},ge)),ge){if(Y[ge._id])return;Y[ge._id]=!0}ge&&ge.isListening()?(te=!0,ze&&(ge._fireAndBubble(ne.pointerover,{...Pe},Z),ge._fireAndBubble(ne.pointerenter,{...Pe},Z),this[ie+"targetShape"]=ge),ge._fireAndBubble(ne.pointermove,{...Pe})):Z&&(this._fire(ne.pointerover,{evt:W,target:this,currentTarget:this,pointerId:Ue}),this[ie+"targetShape"]=null)}),te||this._fire(ne.pointermove,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(W){const ne=G(W.type),ie=L(W.type);if(!ne)return;this.setPointersPositions(W);const V=this[ie+"ClickStartShape"],Y=this[ie+"ClickEndShape"],te={};let Z=!1;this._changedPointerPositions.forEach(ue=>{const ge=l.getCapturedShape(ue.id)||this.getIntersection(ue);if(ge){if(ge.releaseCapture(ue.id),te[ge._id])return;te[ge._id]=!0}const Ue=ue.id,Pe={evt:W,pointerId:Ue};let ze=!1;i.Konva["_"+ie+"InDblClickWindow"]?(ze=!0,clearTimeout(this[ie+"DblTimeout"])):s.DD.justDragged||(i.Konva["_"+ie+"InDblClickWindow"]=!0,clearTimeout(this[ie+"DblTimeout"])),this[ie+"DblTimeout"]=setTimeout(function(){i.Konva["_"+ie+"InDblClickWindow"]=!1},i.Konva.dblClickWindow),ge&&ge.isListening()?(Z=!0,this[ie+"ClickEndShape"]=ge,ge._fireAndBubble(ne.pointerup,{...Pe}),i.Konva["_"+ie+"ListenClick"]&&V&&V===ge&&(ge._fireAndBubble(ne.pointerclick,{...Pe}),ze&&Y&&Y===ge&&ge._fireAndBubble(ne.pointerdblclick,{...Pe}))):(this[ie+"ClickEndShape"]=null,i.Konva["_"+ie+"ListenClick"]&&this._fire(ne.pointerclick,{evt:W,target:this,currentTarget:this,pointerId:Ue}),ze&&this._fire(ne.pointerdblclick,{evt:W,target:this,currentTarget:this,pointerId:Ue}))}),Z||this._fire(ne.pointerup,{evt:W,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva["_"+ie+"ListenClick"]=!1,W.cancelable&&ie!=="touch"&&W.preventDefault()}_contextmenu(W){this.setPointersPositions(W);const ne=this.getIntersection(this.getPointerPosition());ne&&ne.isListening()?ne._fireAndBubble(R,{evt:W}):this._fire(R,{evt:W,target:this,currentTarget:this})}_wheel(W){this.setPointersPositions(W);const ne=this.getIntersection(this.getPointerPosition());ne&&ne.isListening()?ne._fireAndBubble(U,{evt:W}):this._fire(U,{evt:W,target:this,currentTarget:this})}_pointercancel(W){this.setPointersPositions(W);const ne=l.getCapturedShape(W.pointerId)||this.getIntersection(this.getPointerPosition());ne&&ne._fireAndBubble(N,l.createEvent(W)),l.releaseCapture(W.pointerId)}_lostpointercapture(W){l.releaseCapture(W.pointerId)}setPointersPositions(W){let ne=this._getContentPosition(),ie=null,V=null;W=W||window.event,W.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(W.touches,Y=>{this._pointerPositions.push({id:Y.identifier,x:(Y.clientX-ne.left)/ne.scaleX,y:(Y.clientY-ne.top)/ne.scaleY})}),Array.prototype.forEach.call(W.changedTouches||W.touches,Y=>{this._changedPointerPositions.push({id:Y.identifier,x:(Y.clientX-ne.left)/ne.scaleX,y:(Y.clientY-ne.top)/ne.scaleY})})):(ie=(W.clientX-ne.left)/ne.scaleX,V=(W.clientY-ne.top)/ne.scaleY,this.pointerPos={x:ie,y:V},this._pointerPositions=[{x:ie,y:V,id:e.Util._getFirstPointerId(W)}],this._changedPointerPositions=[{x:ie,y:V,id:e.Util._getFirstPointerId(W)}])}_setPointerPosition(W){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(W)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const W=this.content.getBoundingClientRect();return{top:W.top,left:W.left,scaleX:W.width/this.content.clientWidth||1,scaleY:W.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;const W=this.container();if(!W)throw"Stage has no container. A container is required.";W.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),W.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(W){W.batchDraw()}),this}}t.Stage=se,se.prototype.nodeType=c,(0,o._registerNode)(se),r.Factory.addGetterSetter(se,"container"),i.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(de=>{de.batchDraw()})})})(TI);var ym={},tn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=pt,r=xr,n=gt,i=dr,a=Ze,s=pt,o=Bl,l="hasShadow",c="shadowRGBA",u="patternImage",f="linearGradient",h="radialGradient";let m;function v(){return m||(m=r.Util.createCanvasElement().getContext("2d"),m)}t.shapes={};function y(A){const _=this.attrs.fillRule;_?A.fill(_):A.fill()}function x(A){A.stroke()}function b(A){const _=this.attrs.fillRule;_?A.fill(_):A.fill()}function S(A){A.stroke()}function w(){this._clearCache(l)}function k(){this._clearCache(c)}function N(){this._clearCache(u)}function j(){this._clearCache(f)}function T(){this._clearCache(h)}class M extends i.Node{constructor(_){super(_);let D;for(;D=r.Util.getRandomColor(),!(D&&!(D in t.shapes)););this.colorKey=D,t.shapes[D]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(u,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const D=v().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(D&&D.setTransform){const R=new r.Transform;R.translate(this.fillPatternX(),this.fillPatternY()),R.rotate(e.Konva.getAngle(this.fillPatternRotation())),R.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),R.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const I=R.getMatrix(),$=typeof DOMMatrix>"u"?{a:I[0],b:I[1],c:I[2],d:I[3],e:I[4],f:I[5]}:new DOMMatrix(I);D.setTransform($)}return D}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){const _=this.fillLinearGradientColorStops();if(_){const D=v(),R=this.fillLinearGradientStartPoint(),I=this.fillLinearGradientEndPoint(),$=D.createLinearGradient(R.x,R.y,I.x,I.y);for(let B=0;B<_.length;B+=2)$.addColorStop(_[B],_[B+1]);return $}}_getRadialGradient(){return this._getCache(h,this.__getRadialGradient)}__getRadialGradient(){const _=this.fillRadialGradientColorStops();if(_){const D=v(),R=this.fillRadialGradientStartPoint(),I=this.fillRadialGradientEndPoint(),$=D.createRadialGradient(R.x,R.y,this.fillRadialGradientStartRadius(),I.x,I.y,this.fillRadialGradientEndRadius());for(let B=0;B<_.length;B+=2)$.addColorStop(_[B],_[B+1]);return $}}getShadowRGBA(){return this._getCache(c,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const _=r.Util.colorToRGBA(this.shadowColor());if(_)return"rgba("+_.r+","+_.g+","+_.b+","+_.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const _=this.hitStrokeWidth();return _==="auto"?this.hasStroke():this.strokeEnabled()&&!!_}intersects(_){const D=this.getStage();if(!D)return!1;const R=D.bufferHitCanvas;return R.getContext().clear(),this.drawHit(R,void 0,!0),R.context.getImageData(Math.round(_.x),Math.round(_.y),1,1).data[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(_){var D;if(!((D=this.attrs.perfectDrawEnabled)!==null&&D!==void 0?D:!0))return!1;const I=_||this.hasFill(),$=this.hasStroke(),B=this.getAbsoluteOpacity()!==1;if(I&&$&&B)return!0;const z=this.hasShadow(),U=this.shadowForStrokeEnabled();return!!(I&&$&&z&&U)}setStrokeHitEnabled(_){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),_?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const _=this.size();return{x:this._centroid?-_.width/2:0,y:this._centroid?-_.height/2:0,width:_.width,height:_.height}}getClientRect(_={}){let D=!1,R=this.getParent();for(;R;){if(R.isCached()){D=!0;break}R=R.getParent()}const I=_.skipTransform,$=_.relativeTo||D&&this.getStage()||void 0,B=this.getSelfRect(),U=!_.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,F=B.width+U,Q=B.height+U,K=!_.skipShadow&&this.hasShadow(),L=K?this.shadowOffsetX():0,G=K?this.shadowOffsetY():0,ee=F+Math.abs(L),re=Q+Math.abs(G),se=K&&this.shadowBlur()||0,de=ee+se*2,W=re+se*2,ne={width:de,height:W,x:-(U/2+se)+Math.min(L,0)+B.x,y:-(U/2+se)+Math.min(G,0)+B.y};return I?ne:this._transformedRect(ne,$)}drawScene(_,D,R){const I=this.getLayer();let $=_||I.getCanvas(),B=$.getContext(),z=this._getCanvasCache(),U=this.getSceneFunc(),F=this.hasShadow(),Q,K;const L=$.isCache,G=D===this;if(!this.isVisible()&&!G)return this;if(z){B.save();const re=this.getAbsoluteTransform(D).getMatrix();return B.transform(re[0],re[1],re[2],re[3],re[4],re[5]),this._drawCachedSceneCanvas(B),B.restore(),this}if(!U)return this;if(B.save(),this._useBufferCanvas()&&!L){Q=this.getStage();const re=R||Q.bufferCanvas;K=re.getContext(),K.clear(),K.save(),K._applyLineJoin(this);var ee=this.getAbsoluteTransform(D).getMatrix();K.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]),U.call(this,K,this),K.restore();const se=re.pixelRatio;F&&B._applyShadow(this),B._applyOpacity(this),B._applyGlobalCompositeOperation(this),B.drawImage(re._canvas,0,0,re.width/se,re.height/se)}else{if(B._applyLineJoin(this),!G){var ee=this.getAbsoluteTransform(D).getMatrix();B.transform(ee[0],ee[1],ee[2],ee[3],ee[4],ee[5]),B._applyOpacity(this),B._applyGlobalCompositeOperation(this)}F&&B._applyShadow(this),U.call(this,B,this)}return B.restore(),this}drawHit(_,D,R=!1){if(!this.shouldDrawHit(D,R))return this;const I=this.getLayer(),$=_||I.hitCanvas,B=$&&$.getContext(),z=this.hitFunc()||this.sceneFunc(),U=this._getCanvasCache(),F=U&&U.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),F){B.save();const K=this.getAbsoluteTransform(D).getMatrix();return B.transform(K[0],K[1],K[2],K[3],K[4],K[5]),this._drawCachedHitCanvas(B),B.restore(),this}if(!z)return this;if(B.save(),B._applyLineJoin(this),!(this===D)){const K=this.getAbsoluteTransform(D).getMatrix();B.transform(K[0],K[1],K[2],K[3],K[4],K[5])}return z.call(this,B,this),B.restore(),this}drawHitFromCache(_=0){let D=this._getCanvasCache(),R=this._getCachedSceneCanvas(),I=D.hit,$=I.getContext(),B=I.getWidth(),z=I.getHeight(),U,F,Q,K,L,G;$.clear(),$.drawImage(R._canvas,0,0,B,z);try{for(U=$.getImageData(0,0,B,z),F=U.data,Q=F.length,K=r.Util._hexToRgb(this.colorKey),L=0;L<Q;L+=4)G=F[L+3],G>_?(F[L]=K.r,F[L+1]=K.g,F[L+2]=K.b,F[L+3]=255):F[L+3]=0;$.putImageData(U,0,0)}catch(ee){r.Util.error("Unable to draw hit graph from cached scene canvas. "+ee.message)}return this}hasPointerCapture(_){return o.hasPointerCapture(_,this)}setPointerCapture(_){o.setPointerCapture(_,this)}releaseCapture(_){o.releaseCapture(_,this)}}t.Shape=M,M.prototype._fillFunc=y,M.prototype._strokeFunc=x,M.prototype._fillFuncHit=b,M.prototype._strokeFuncHit=S,M.prototype._centroid=!1,M.prototype.nodeType="Shape",(0,s._registerNode)(M),M.prototype.eventListeners={},M.prototype.on.call(M.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),M.prototype.on.call(M.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",k),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",N),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",j),M.prototype.on.call(M.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",T),n.Factory.addGetterSetter(M,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(M,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(M,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(M,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(M,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(M,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(M,"lineJoin"),n.Factory.addGetterSetter(M,"lineCap"),n.Factory.addGetterSetter(M,"sceneFunc"),n.Factory.addGetterSetter(M,"hitFunc"),n.Factory.addGetterSetter(M,"dash"),n.Factory.addGetterSetter(M,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(M,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(M,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(M,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillPatternImage"),n.Factory.addGetterSetter(M,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(M,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(M,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(M,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(M,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(M,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(M,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(M,"fillEnabled",!0),n.Factory.addGetterSetter(M,"strokeEnabled",!0),n.Factory.addGetterSetter(M,"shadowEnabled",!0),n.Factory.addGetterSetter(M,"dashEnabled",!0),n.Factory.addGetterSetter(M,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(M,"fillPriority","color"),n.Factory.addComponentsGetterSetter(M,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(M,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(M,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(M,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(M,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(M,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(M,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(M,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(M,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(M,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(M,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(M,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(M,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(M,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(M,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(M,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(M,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(M,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(M,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(M,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(M,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(M,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(M,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(M,"fillPatternRotation",0),n.Factory.addGetterSetter(M,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(M,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(tn);Object.defineProperty(ym,"__esModule",{value:!0});ym.Layer=void 0;const Os=xr,TS=iu,Fu=dr,dN=gt,pM=Oa,Dse=Ze,Ose=tn,Ise=pt,Lse="#",Bse="beforeDraw",Fse="draw",PI=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],zse=PI.length;let df=class extends TS.Container{constructor(e){super(e),this.canvas=new pM.SceneCanvas,this.hitCanvas=new pM.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),e<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[e+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Fu.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Fu.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Fu.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Fu.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return Fu.Node.prototype.remove.call(this),e&&e.parentNode&&Os.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:r}){return this.canvas.setSize(e,r),this.hitCanvas.setSize(e,r),this._setSmoothEnabled(),this}_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&Os.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),Fu.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Os.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Os.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Os.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let i=0;i<zse;i++){const a=PI[i],s=this._getIntersection({x:e.x+a.x*r,y:e.y+a.y*r}),o=s.shape;if(o)return o;if(n=!!s.antialiased,!s.antialiased)break}if(n)r+=1;else return null}}_getIntersection(e){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(e.x*r),Math.round(e.y*r),1,1).data,i=n[3];if(i===255){const a=Os.Util._rgbToHex(n[0],n[1],n[2]),s=Ose.shapes[Lse+a];return s?{shape:s}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,r){const n=this.getLayer(),i=e||n&&n.getCanvas();return this._fire(Bse,{node:this}),this.clearBeforeDraw()&&i.getContext().clear(),TS.Container.prototype.drawScene.call(this,i,r),this._fire(Fse,{node:this}),this}drawHit(e,r){const n=this.getLayer(),i=e||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),TS.Container.prototype.drawHit.call(this,i,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Os.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Os.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Os.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};ym.Layer=df;df.prototype.nodeType="Layer";(0,Ise._registerNode)(df);dN.Factory.addGetterSetter(df,"imageSmoothingEnabled",!0);dN.Factory.addGetterSetter(df,"clearBeforeDraw",!0);dN.Factory.addGetterSetter(df,"hitGraphEnabled",!0,(0,Dse.getBooleanValidator)());var Bx={};Object.defineProperty(Bx,"__esModule",{value:!0});Bx.FastLayer=void 0;const Vse=xr,$se=ym,Use=pt;class fN extends $se.Layer{constructor(e){super(e),this.listening(!1),Vse.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Bx.FastLayer=fN;fN.prototype.nodeType="FastLayer";(0,Use._registerNode)(fN);var ff={};Object.defineProperty(ff,"__esModule",{value:!0});ff.Group=void 0;const Gse=xr,Hse=iu,Wse=pt;class hN extends Hse.Container{_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&Gse.Util.throw("You may only add groups and shapes to groups.")}}ff.Group=hN;hN.prototype.nodeType="Group";(0,Wse._registerNode)(hN);var hf={};Object.defineProperty(hf,"__esModule",{value:!0});hf.Animation=void 0;const jS=pt,mM=xr,MS=function(){return jS.glob.performance&&jS.glob.performance.now?function(){return jS.glob.performance.now()}:function(){return new Date().getTime()}}();class as{constructor(e,r){this.id=as.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:MS(),frameRate:0},this.func=e,this.setLayers(r)}setLayers(e){let r=[];return e&&(r=Array.isArray(e)?e:[e]),this.layers=r,this}getLayers(){return this.layers}addLayer(e){const r=this.layers,n=r.length;for(let i=0;i<n;i++)if(r[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const r=as.animations,n=r.length;for(let i=0;i<n;i++)if(r[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=MS(),as._addAnimation(this),this}stop(){return as._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const r=e.id,n=this.animations,i=n.length;for(let a=0;a<i;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const e={},r=this.animations;for(let n=0;n<r.length;n++){const i=r[n],a=i.layers,s=i.func;i._updateFrameObject(MS());const o=a.length;let l;if(s?l=s.call(i,i.frame)!==!1:l=!0,!!l)for(let c=0;c<o;c++){const u=a[c];u._id!==void 0&&(e[u._id]=u)}}for(const n in e)e.hasOwnProperty(n)&&e[n].batchDraw()}static _animationLoop(){const e=as;e.animations.length?(e._runFrames(),mM.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,mM.Util.requestAnimFrame(this._animationLoop))}}hf.Animation=as;as.animations=[];as.animIdCounter=0;as.animRunning=!1;var _I={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=xr,r=hf,n=dr,i=pt;let a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},s=1,o=2,l=3,c=0,u=["fill","stroke","shadowColor"];class f{constructor(v,y,x,b,S,w,k){this.prop=v,this.propFunc=y,this.begin=b,this._pos=b,this.duration=w,this._change=0,this.prevPos=0,this.yoyo=k,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=x,this._change=S-this.begin,this.pause()}fire(v){const y=this[v];y&&y()}setTime(v){v>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():v<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=v,this.update())}getTime(){return this._time}setPosition(v){this.prevPos=this._pos,this.propFunc(v),this._pos=v}getPosition(v){return v===void 0&&(v=this._time),this.func(v,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(v){this.pause(),this._time=v,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const v=this.getTimer()-this._startTime;this.state===o?this.setTime(v):this.state===l&&this.setTime(this.duration-v)}pause(){this.state=s,this.fire("onPause")}getTimer(){return new Date().getTime()}}class h{constructor(v){let y=this,x=v.node,b=x._id,S,w=v.easing||t.Easings.Linear,k=!!v.yoyo,N;typeof v.duration>"u"?S=.3:v.duration===0?S=.001:S=v.duration,this.node=x,this._id=c++;const j=x.getLayer()||(x instanceof i.Konva.Stage?x.getLayers():null);j||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){y.tween.onEnterFrame()},j),this.tween=new f(N,function(T){y._tweenFunc(T)},w,0,1,S*1e3,k),this._addListeners(),h.attrs[b]||(h.attrs[b]={}),h.attrs[b][this._id]||(h.attrs[b][this._id]={}),h.tweens[b]||(h.tweens[b]={});for(N in v)a[N]===void 0&&this._addAttr(N,v[N]);this.reset(),this.onFinish=v.onFinish,this.onReset=v.onReset,this.onUpdate=v.onUpdate}_addAttr(v,y){let x=this.node,b=x._id,S,w,k,N,j,T,M,A;if(k=h.tweens[b][v],k&&delete h.attrs[b][k][v],S=x.getAttr(v),e.Util._isArray(y))if(w=[],j=Math.max(y.length,S.length),v==="points"&&y.length!==S.length&&(y.length>S.length?(M=S,S=e.Util._prepareArrayForTween(S,y,x.closed())):(T=y,y=e.Util._prepareArrayForTween(y,S,x.closed()))),v.indexOf("fill")===0)for(N=0;N<j;N++)if(N%2===0)w.push(y[N]-S[N]);else{const _=e.Util.colorToRGBA(S[N]);A=e.Util.colorToRGBA(y[N]),S[N]=_,w.push({r:A.r-_.r,g:A.g-_.g,b:A.b-_.b,a:A.a-_.a})}else for(N=0;N<j;N++)w.push(y[N]-S[N]);else u.indexOf(v)!==-1?(S=e.Util.colorToRGBA(S),A=e.Util.colorToRGBA(y),w={r:A.r-S.r,g:A.g-S.g,b:A.b-S.b,a:A.a-S.a}):w=y-S;h.attrs[b][this._id][v]={start:S,diff:w,end:y,trueEnd:T,trueStart:M},h.tweens[b][v]=this._id}_tweenFunc(v){let y=this.node,x=h.attrs[y._id][this._id],b,S,w,k,N,j,T,M;for(b in x){if(S=x[b],w=S.start,k=S.diff,M=S.end,e.Util._isArray(w))if(N=[],T=Math.max(w.length,M.length),b.indexOf("fill")===0)for(j=0;j<T;j++)j%2===0?N.push((w[j]||0)+k[j]*v):N.push("rgba("+Math.round(w[j].r+k[j].r*v)+","+Math.round(w[j].g+k[j].g*v)+","+Math.round(w[j].b+k[j].b*v)+","+(w[j].a+k[j].a*v)+")");else for(j=0;j<T;j++)N.push((w[j]||0)+k[j]*v);else u.indexOf(b)!==-1?N="rgba("+Math.round(w.r+k.r*v)+","+Math.round(w.g+k.g*v)+","+Math.round(w.b+k.b*v)+","+(w.a+k.a*v)+")":N=w+k*v;y.setAttr(b,N)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const v=this.node,y=h.attrs[v._id][this._id];y.points&&y.points.trueEnd&&v.setAttr("points",y.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const v=this.node,y=h.attrs[v._id][this._id];y.points&&y.points.trueStart&&v.points(y.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(v){return this.tween.seek(v*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let v=this.node._id,y=this._id,x=h.tweens[v],b;this.pause();for(b in x)delete h.tweens[v][b];delete h.attrs[v][y]}}t.Tween=h,h.attrs={},h.tweens={},n.Node.prototype.to=function(m){const v=m.onFinish;m.node=this,m.onFinish=function(){this.destroy(),v&&v()},new h(m).play()},t.Easings={BackEaseIn(m,v,y,x){return y*(m/=x)*m*((1.70158+1)*m-1.70158)+v},BackEaseOut(m,v,y,x){return y*((m=m/x-1)*m*((1.70158+1)*m+1.70158)+1)+v},BackEaseInOut(m,v,y,x){let b=1.70158;return(m/=x/2)<1?y/2*(m*m*(((b*=1.525)+1)*m-b))+v:y/2*((m-=2)*m*(((b*=1.525)+1)*m+b)+2)+v},ElasticEaseIn(m,v,y,x,b,S){let w=0;return m===0?v:(m/=x)===1?v+y:(S||(S=x*.3),!b||b<Math.abs(y)?(b=y,w=S/4):w=S/(2*Math.PI)*Math.asin(y/b),-(b*Math.pow(2,10*(m-=1))*Math.sin((m*x-w)*(2*Math.PI)/S))+v)},ElasticEaseOut(m,v,y,x,b,S){let w=0;return m===0?v:(m/=x)===1?v+y:(S||(S=x*.3),!b||b<Math.abs(y)?(b=y,w=S/4):w=S/(2*Math.PI)*Math.asin(y/b),b*Math.pow(2,-10*m)*Math.sin((m*x-w)*(2*Math.PI)/S)+y+v)},ElasticEaseInOut(m,v,y,x,b,S){let w=0;return m===0?v:(m/=x/2)===2?v+y:(S||(S=x*(.3*1.5)),!b||b<Math.abs(y)?(b=y,w=S/4):w=S/(2*Math.PI)*Math.asin(y/b),m<1?-.5*(b*Math.pow(2,10*(m-=1))*Math.sin((m*x-w)*(2*Math.PI)/S))+v:b*Math.pow(2,-10*(m-=1))*Math.sin((m*x-w)*(2*Math.PI)/S)*.5+y+v)},BounceEaseOut(m,v,y,x){return(m/=x)<1/2.75?y*(7.5625*m*m)+v:m<2/2.75?y*(7.5625*(m-=1.5/2.75)*m+.75)+v:m<2.5/2.75?y*(7.5625*(m-=2.25/2.75)*m+.9375)+v:y*(7.5625*(m-=2.625/2.75)*m+.984375)+v},BounceEaseIn(m,v,y,x){return y-t.Easings.BounceEaseOut(x-m,0,y,x)+v},BounceEaseInOut(m,v,y,x){return m<x/2?t.Easings.BounceEaseIn(m*2,0,y,x)*.5+v:t.Easings.BounceEaseOut(m*2-x,0,y,x)*.5+y*.5+v},EaseIn(m,v,y,x){return y*(m/=x)*m+v},EaseOut(m,v,y,x){return-y*(m/=x)*(m-2)+v},EaseInOut(m,v,y,x){return(m/=x/2)<1?y/2*m*m+v:-y/2*(--m*(m-2)-1)+v},StrongEaseIn(m,v,y,x){return y*(m/=x)*m*m*m*m+v},StrongEaseOut(m,v,y,x){return y*((m=m/x-1)*m*m*m*m+1)+v},StrongEaseInOut(m,v,y,x){return(m/=x/2)<1?y/2*m*m*m*m*m+v:y/2*((m-=2)*m*m*m*m+2)+v},Linear(m,v,y,x){return y*m/x+v}}})(_I);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=pt,r=xr,n=dr,i=iu,a=TI,s=ym,o=Bx,l=ff,c=Ix,u=tn,f=hf,h=_I,m=Ys,v=Oa;t.Konva=r.Util._assign(e.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:s.Layer,FastLayer:o.FastLayer,Group:l.Group,DD:c.DD,Shape:u.Shape,shapes:u.shapes,Animation:f.Animation,Tween:h.Tween,Easings:h.Easings,Context:m.Context,Canvas:v.Canvas}),t.default=t.Konva})(Ty);var Fx={};Object.defineProperty(Fx,"__esModule",{value:!0});Fx.Arc=void 0;const zx=gt,qse=tn,gM=pt,Vx=Ze,Kse=pt;class uo extends qse.Shape{_sceneFunc(e){const r=gM.Konva.getAngle(this.angle()),n=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,r,n),e.arc(0,0,this.innerRadius(),r,0,!n),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),i=gM.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(i,Math.PI)),s=1,o=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),l=Math.sin(Math.min(i,Math.PI/2)),c=a*(a>0?e:r),u=s*r,f=o*(o>0?e:r),h=l*(l>0?r:e);return{x:c,y:n?-1*h:f,width:u-c,height:h-f}}}Fx.Arc=uo;uo.prototype._centroid=!0;uo.prototype.className="Arc";uo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,Kse._registerNode)(uo);zx.Factory.addGetterSetter(uo,"innerRadius",0,(0,Vx.getNumberValidator)());zx.Factory.addGetterSetter(uo,"outerRadius",0,(0,Vx.getNumberValidator)());zx.Factory.addGetterSetter(uo,"angle",0,(0,Vx.getNumberValidator)());zx.Factory.addGetterSetter(uo,"clockwise",!1,(0,Vx.getBooleanValidator)());var $x={},xm={};Object.defineProperty(xm,"__esModule",{value:!0});xm.Line=void 0;const Ux=gt,Yse=pt,Xse=tn,AI=Ze;function $k(t,e,r,n,i,a,s){const o=Math.sqrt(Math.pow(r-t,2)+Math.pow(n-e,2)),l=Math.sqrt(Math.pow(i-r,2)+Math.pow(a-n,2)),c=s*o/(o+l),u=s*l/(o+l),f=r-c*(i-t),h=n-c*(a-e),m=r+u*(i-t),v=n+u*(a-e);return[f,h,m,v]}function vM(t,e){const r=t.length,n=[];for(let i=2;i<r-2;i+=2){const a=$k(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(t[i]),n.push(t[i+1]),n.push(a[2]),n.push(a[3]))}return n}let Fl=class extends Xse.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){let r=this.points(),n=r.length,i=this.tension(),a=this.closed(),s=this.bezier(),o,l,c;if(n){if(e.beginPath(),e.moveTo(r[0],r[1]),i!==0&&n>4){for(o=this.getTensionPoints(),l=o.length,c=a?0:4,a||e.quadraticCurveTo(o[0],o[1],o[2],o[3]);c<l-2;)e.bezierCurveTo(o[c++],o[c++],o[c++],o[c++],o[c++],o[c++]);a||e.quadraticCurveTo(o[l-2],o[l-1],r[n-2],r[n-1])}else if(s)for(c=2;c<n;)e.bezierCurveTo(r[c++],r[c++],r[c++],r[c++],r[c++],r[c++]);else for(c=2;c<n;c+=2)e.lineTo(r[c],r[c+1]);a?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():vM(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),r=e.length,n=this.tension(),i=$k(e[r-2],e[r-1],e[0],e[1],e[2],e[3],n),a=$k(e[r-4],e[r-3],e[r-2],e[r-1],e[0],e[1],n),s=vM(e,n);return[i[2],i[3]].concat(s).concat([a[0],a[1],e[r-2],e[r-1],a[2],a[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let r=e[0],n=e[0],i=e[1],a=e[1],s,o;for(let l=0;l<e.length/2;l++)s=e[l*2],o=e[l*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);return{x:r,y:i,width:n-r,height:a-i}}};xm.Line=Fl;Fl.prototype.className="Line";Fl.prototype._attrsAffectingSize=["points","bezier","tension"];(0,Yse._registerNode)(Fl);Ux.Factory.addGetterSetter(Fl,"closed",!1);Ux.Factory.addGetterSetter(Fl,"bezier",!1);Ux.Factory.addGetterSetter(Fl,"tension",0,(0,AI.getNumberValidator)());Ux.Factory.addGetterSetter(Fl,"points",[],(0,AI.getNumberArrayValidator)());var pf={},RI={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(s,o,l)=>{let c,u;const h=l/2;c=0;for(let m=0;m<20;m++)u=h*t.tValues[20][m]+h,c+=t.cValues[20][m]*n(s,o,u);return h*c};t.getCubicArcLength=e;const r=(s,o,l)=>{l===void 0&&(l=1);const c=s[0]-2*s[1]+s[2],u=o[0]-2*o[1]+o[2],f=2*s[1]-2*s[0],h=2*o[1]-2*o[0],m=4*(c*c+u*u),v=4*(c*f+u*h),y=f*f+h*h;if(m===0)return l*Math.sqrt(Math.pow(s[2]-s[0],2)+Math.pow(o[2]-o[0],2));const x=v/(2*m),b=y/m,S=l+x,w=b-x*x,k=S*S+w>0?Math.sqrt(S*S+w):0,N=x*x+w>0?Math.sqrt(x*x+w):0,j=x+Math.sqrt(x*x+w)!==0?w*Math.log(Math.abs((S+k)/(x+N))):0;return Math.sqrt(m)/2*(S*k-x*N+j)};t.getQuadraticArcLength=r;function n(s,o,l){const c=i(1,l,s),u=i(1,l,o),f=c*c+u*u;return Math.sqrt(f)}const i=(s,o,l)=>{const c=l.length-1;let u,f;if(c===0)return 0;if(s===0){f=0;for(let h=0;h<=c;h++)f+=t.binomialCoefficients[c][h]*Math.pow(1-o,c-h)*Math.pow(o,h)*l[h];return f}else{u=new Array(c);for(let h=0;h<c;h++)u[h]=c*(l[h+1]-l[h]);return i(s-1,o,u)}},a=(s,o,l)=>{let c=1,u=s/o,f=(s-l(u))/o,h=0;for(;c>.001;){const m=l(u+f),v=Math.abs(s-m)/o;if(v<c)c=v,u+=f;else{const y=l(u-f),x=Math.abs(s-y)/o;x<c?(c=x,u-=f):f/=2}if(h++,h>500)break}return u};t.t2length=a})(RI);Object.defineProperty(pf,"__esModule",{value:!0});pf.Path=void 0;const Qse=gt,Jse=tn,Zse=pt,zu=RI;class Kr extends Jse.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=Kr.parsePathData(this.data()),this.pathLength=Kr.getPathLength(this.dataArray)}_sceneFunc(e){const r=this.dataArray;e.beginPath();let n=!1;for(let y=0;y<r.length;y++){const x=r[y].command,b=r[y].points;switch(x){case"L":e.lineTo(b[0],b[1]);break;case"M":e.moveTo(b[0],b[1]);break;case"C":e.bezierCurveTo(b[0],b[1],b[2],b[3],b[4],b[5]);break;case"Q":e.quadraticCurveTo(b[0],b[1],b[2],b[3]);break;case"A":var i=b[0],a=b[1],s=b[2],o=b[3],l=b[4],c=b[5],u=b[6],f=b[7],h=s>o?s:o,m=s>o?1:s/o,v=s>o?o/s:1;e.translate(i,a),e.rotate(u),e.scale(m,v),e.arc(0,0,h,l,l+c,1-f),e.scale(1/m,1/v),e.rotate(-u),e.translate(-i,-a);break;case"z":n=!0,e.closePath();break}}!n&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(l){if(l.command==="A"){const c=l.points[4],u=l.points[5],f=l.points[4]+u;let h=Math.PI/180;if(Math.abs(c-f)<h&&(h=Math.abs(c-f)),u<0)for(let m=c-h;m>f;m-=h){const v=Kr.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],m,0);e.push(v.x,v.y)}else for(let m=c+h;m<f;m+=h){const v=Kr.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],m,0);e.push(v.x,v.y)}}else if(l.command==="C")for(let c=0;c<=1;c+=.01){const u=Kr.getPointOnCubicBezier(c,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);e.push(u.x,u.y)}else e=e.concat(l.points)});let r=e[0],n=e[0],i=e[1],a=e[1],s,o;for(let l=0;l<e.length/2;l++)s=e[l*2],o=e[l*2+1],isNaN(s)||(r=Math.min(r,s),n=Math.max(n,s)),isNaN(o)||(i=Math.min(i,o),a=Math.max(a,o));return{x:r,y:i,width:n-r,height:a-i}}getLength(){return this.pathLength}getPointAtLength(e){return Kr.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,r,n,i){return Math.sqrt((n-e)*(n-e)+(i-r)*(i-r))}static getPathLength(e){let r=0;for(let n=0;n<e.length;++n)r+=e[n].pathLength;return r}static getPointAtLengthOfDataArray(e,r){let n,i=0,a=r.length;if(!a)return null;for(;i<a&&e>r[i].pathLength;)e-=r[i].pathLength,++i;if(i===a)return n=r[i-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return n=r[i].points.slice(0,2),{x:n[0],y:n[1]};const s=r[i],o=s.points;switch(s.command){case"L":return Kr.getPointOnLine(e,s.start.x,s.start.y,o[0],o[1]);case"C":return Kr.getPointOnCubicBezier((0,zu.t2length)(e,Kr.getPathLength(r),y=>(0,zu.getCubicArcLength)([s.start.x,o[0],o[2],o[4]],[s.start.y,o[1],o[3],o[5]],y)),s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Kr.getPointOnQuadraticBezier((0,zu.t2length)(e,Kr.getPathLength(r),y=>(0,zu.getQuadraticArcLength)([s.start.x,o[0],o[2]],[s.start.y,o[1],o[3]],y)),s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":var l=o[0],c=o[1],u=o[2],f=o[3],h=o[4],m=o[5],v=o[6];return h+=m*e/s.pathLength,Kr.getPointOnEllipticalArc(l,c,u,f,h,v)}return null}static getPointOnLine(e,r,n,i,a,s,o){s=s??r,o=o??n;const l=this.getLineLength(r,n,i,a);if(l<1e-10)return{x:r,y:n};if(i===r)return{x:s,y:o+(a>n?e:-e)};const c=(a-n)/(i-r),u=Math.sqrt(e*e/(1+c*c))*(i<r?-1:1),f=c*u;if(Math.abs(o-n-c*(s-r))<1e-10)return{x:s+u,y:o+f};const h=((s-r)*(i-r)+(o-n)*(a-n))/(l*l),m=r+h*(i-r),v=n+h*(a-n),y=this.getLineLength(s,o,m,v),x=Math.sqrt(e*e-y*y),b=Math.sqrt(x*x/(1+c*c))*(i<r?-1:1),S=c*b;return{x:m+b,y:v+S}}static getPointOnCubicBezier(e,r,n,i,a,s,o,l,c){function u(x){return x*x*x}function f(x){return 3*x*x*(1-x)}function h(x){return 3*x*(1-x)*(1-x)}function m(x){return(1-x)*(1-x)*(1-x)}const v=l*u(e)+s*f(e)+i*h(e)+r*m(e),y=c*u(e)+o*f(e)+a*h(e)+n*m(e);return{x:v,y}}static getPointOnQuadraticBezier(e,r,n,i,a,s,o){function l(m){return m*m}function c(m){return 2*m*(1-m)}function u(m){return(1-m)*(1-m)}const f=s*l(e)+i*c(e)+r*u(e),h=o*l(e)+a*c(e)+n*u(e);return{x:f,y:h}}static getPointOnEllipticalArc(e,r,n,i,a,s){const o=Math.cos(s),l=Math.sin(s),c={x:n*Math.cos(a),y:i*Math.sin(a)};return{x:e+(c.x*o-c.y*l),y:r+(c.x*l+c.y*o)}}static parsePathData(e){if(!e)return[];let r=e;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(var i=0;i<n.length;i++)r=r.replace(new RegExp(n[i],"g"),"|"+n[i]);const a=r.split("|"),s=[],o=[];let l=0,c=0;const u=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let f;for(i=1;i<a.length;i++){let M=a[i],A=M.charAt(0);for(M=M.slice(1),o.length=0;f=u.exec(M);)o.push(f[0]);const _=[];for(let D=0,R=o.length;D<R;D++){if(o[D]==="00"){_.push(0,0);continue}const I=parseFloat(o[D]);isNaN(I)?_.push(0):_.push(I)}for(;_.length>0&&!isNaN(_[0]);){let D="",R=[];const I=l,$=c;var h,m,v,y,x,b,S,w,k,N;switch(A){case"l":l+=_.shift(),c+=_.shift(),D="L",R.push(l,c);break;case"L":l=_.shift(),c=_.shift(),R.push(l,c);break;case"m":var j=_.shift(),T=_.shift();if(l+=j,c+=T,D="M",s.length>2&&s[s.length-1].command==="z"){for(let B=s.length-2;B>=0;B--)if(s[B].command==="M"){l=s[B].points[0]+j,c=s[B].points[1]+T;break}}R.push(l,c),A="l";break;case"M":l=_.shift(),c=_.shift(),D="M",R.push(l,c),A="L";break;case"h":l+=_.shift(),D="L",R.push(l,c);break;case"H":l=_.shift(),D="L",R.push(l,c);break;case"v":c+=_.shift(),D="L",R.push(l,c);break;case"V":c=_.shift(),D="L",R.push(l,c);break;case"C":R.push(_.shift(),_.shift(),_.shift(),_.shift()),l=_.shift(),c=_.shift(),R.push(l,c);break;case"c":R.push(l+_.shift(),c+_.shift(),l+_.shift(),c+_.shift()),l+=_.shift(),c+=_.shift(),D="C",R.push(l,c);break;case"S":m=l,v=c,h=s[s.length-1],h.command==="C"&&(m=l+(l-h.points[2]),v=c+(c-h.points[3])),R.push(m,v,_.shift(),_.shift()),l=_.shift(),c=_.shift(),D="C",R.push(l,c);break;case"s":m=l,v=c,h=s[s.length-1],h.command==="C"&&(m=l+(l-h.points[2]),v=c+(c-h.points[3])),R.push(m,v,l+_.shift(),c+_.shift()),l+=_.shift(),c+=_.shift(),D="C",R.push(l,c);break;case"Q":R.push(_.shift(),_.shift()),l=_.shift(),c=_.shift(),R.push(l,c);break;case"q":R.push(l+_.shift(),c+_.shift()),l+=_.shift(),c+=_.shift(),D="Q",R.push(l,c);break;case"T":m=l,v=c,h=s[s.length-1],h.command==="Q"&&(m=l+(l-h.points[0]),v=c+(c-h.points[1])),l=_.shift(),c=_.shift(),D="Q",R.push(m,v,l,c);break;case"t":m=l,v=c,h=s[s.length-1],h.command==="Q"&&(m=l+(l-h.points[0]),v=c+(c-h.points[1])),l+=_.shift(),c+=_.shift(),D="Q",R.push(m,v,l,c);break;case"A":y=_.shift(),x=_.shift(),b=_.shift(),S=_.shift(),w=_.shift(),k=l,N=c,l=_.shift(),c=_.shift(),D="A",R=this.convertEndpointToCenterParameterization(k,N,l,c,S,w,y,x,b);break;case"a":y=_.shift(),x=_.shift(),b=_.shift(),S=_.shift(),w=_.shift(),k=l,N=c,l+=_.shift(),c+=_.shift(),D="A",R=this.convertEndpointToCenterParameterization(k,N,l,c,S,w,y,x,b);break}s.push({command:D||A,points:R,start:{x:I,y:$},pathLength:this.calcLength(I,$,D||A,R)})}(A==="z"||A==="Z")&&s.push({command:"z",points:[],start:void 0,pathLength:0})}return s}static calcLength(e,r,n,i){let a,s,o,l;const c=Kr;switch(n){case"L":return c.getLineLength(e,r,i[0],i[1]);case"C":return(0,zu.getCubicArcLength)([e,i[0],i[2],i[4]],[r,i[1],i[3],i[5]],1);case"Q":return(0,zu.getQuadraticArcLength)([e,i[0],i[2]],[r,i[1],i[3]],1);case"A":a=0;var u=i[4],f=i[5],h=i[4]+f,m=Math.PI/180;if(Math.abs(u-h)<m&&(m=Math.abs(u-h)),s=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),f<0)for(l=u-m;l>h;l-=m)o=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],l,0),a+=c.getLineLength(s.x,s.y,o.x,o.y),s=o;else for(l=u+m;l<h;l+=m)o=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],l,0),a+=c.getLineLength(s.x,s.y,o.x,o.y),s=o;return o=c.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],h,0),a+=c.getLineLength(s.x,s.y,o.x,o.y),a}return 0}static convertEndpointToCenterParameterization(e,r,n,i,a,s,o,l,c){const u=c*(Math.PI/180),f=Math.cos(u)*(e-n)/2+Math.sin(u)*(r-i)/2,h=-1*Math.sin(u)*(e-n)/2+Math.cos(u)*(r-i)/2,m=f*f/(o*o)+h*h/(l*l);m>1&&(o*=Math.sqrt(m),l*=Math.sqrt(m));let v=Math.sqrt((o*o*(l*l)-o*o*(h*h)-l*l*(f*f))/(o*o*(h*h)+l*l*(f*f)));a===s&&(v*=-1),isNaN(v)&&(v=0);const y=v*o*h/l,x=v*-l*f/o,b=(e+n)/2+Math.cos(u)*y-Math.sin(u)*x,S=(r+i)/2+Math.sin(u)*y+Math.cos(u)*x,w=function(_){return Math.sqrt(_[0]*_[0]+_[1]*_[1])},k=function(_,D){return(_[0]*D[0]+_[1]*D[1])/(w(_)*w(D))},N=function(_,D){return(_[0]*D[1]<_[1]*D[0]?-1:1)*Math.acos(k(_,D))},j=N([1,0],[(f-y)/o,(h-x)/l]),T=[(f-y)/o,(h-x)/l],M=[(-1*f-y)/o,(-1*h-x)/l];let A=N(T,M);return k(T,M)<=-1&&(A=Math.PI),k(T,M)>=1&&(A=0),s===0&&A>0&&(A=A-2*Math.PI),s===1&&A<0&&(A=A+2*Math.PI),[b,S,o,l,j,A,u,s]}}pf.Path=Kr;Kr.prototype.className="Path";Kr.prototype._attrsAffectingSize=["data"];(0,Zse._registerNode)(Kr);Qse.Factory.addGetterSetter(Kr,"data");Object.defineProperty($x,"__esModule",{value:!0});$x.Arrow=void 0;const Gx=gt,eoe=xm,DI=Ze,toe=pt,yM=pf;class su extends eoe.Line{_sceneFunc(e){super._sceneFunc(e);const r=Math.PI*2,n=this.points();let i=n;const a=this.tension()!==0&&n.length>4;a&&(i=this.getTensionPoints());const s=this.pointerLength(),o=n.length;let l,c;if(a){const h=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],n[o-2],n[o-1]],m=yM.Path.calcLength(i[i.length-4],i[i.length-3],"C",h),v=yM.Path.getPointOnQuadraticBezier(Math.min(1,1-s/m),h[0],h[1],h[2],h[3],h[4],h[5]);l=n[o-2]-v.x,c=n[o-1]-v.y}else l=n[o-2]-n[o-4],c=n[o-1]-n[o-3];const u=(Math.atan2(c,l)+r)%r,f=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(n[o-2],n[o-1]),e.rotate(u),e.moveTo(0,0),e.lineTo(-s,f/2),e.lineTo(-s,-f/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(n[0],n[1]),a?(l=(i[0]+i[2])/2-n[0],c=(i[1]+i[3])/2-n[1]):(l=n[2]-n[0],c=n[3]-n[1]),e.rotate((Math.atan2(-c,-l)+r)%r),e.moveTo(0,0),e.lineTo(-s,f/2),e.lineTo(-s,-f/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),r=this.pointerWidth()/2;return{x:e.x-r,y:e.y-r,width:e.width+r*2,height:e.height+r*2}}}$x.Arrow=su;su.prototype.className="Arrow";(0,toe._registerNode)(su);Gx.Factory.addGetterSetter(su,"pointerLength",10,(0,DI.getNumberValidator)());Gx.Factory.addGetterSetter(su,"pointerWidth",10,(0,DI.getNumberValidator)());Gx.Factory.addGetterSetter(su,"pointerAtBeginning",!1);Gx.Factory.addGetterSetter(su,"pointerAtEnding",!0);var Hx={};Object.defineProperty(Hx,"__esModule",{value:!0});Hx.Circle=void 0;const roe=gt,noe=tn,ioe=Ze,aoe=pt;class mf extends noe.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}Hx.Circle=mf;mf.prototype._centroid=!0;mf.prototype.className="Circle";mf.prototype._attrsAffectingSize=["radius"];(0,aoe._registerNode)(mf);roe.Factory.addGetterSetter(mf,"radius",0,(0,ioe.getNumberValidator)());var Wx={};Object.defineProperty(Wx,"__esModule",{value:!0});Wx.Ellipse=void 0;const pN=gt,soe=tn,OI=Ze,ooe=pt;class zl extends soe.Shape{_sceneFunc(e){const r=this.radiusX(),n=this.radiusY();e.beginPath(),e.save(),r!==n&&e.scale(1,n/r),e.arc(0,0,r,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}Wx.Ellipse=zl;zl.prototype.className="Ellipse";zl.prototype._centroid=!0;zl.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,ooe._registerNode)(zl);pN.Factory.addComponentsGetterSetter(zl,"radius",["x","y"]);pN.Factory.addGetterSetter(zl,"radiusX",0,(0,OI.getNumberValidator)());pN.Factory.addGetterSetter(zl,"radiusY",0,(0,OI.getNumberValidator)());var qx={};Object.defineProperty(qx,"__esModule",{value:!0});qx.Image=void 0;const PS=xr,ou=gt,loe=tn,coe=pt,bm=Ze;let ys=class II extends loe.Shape{constructor(e){super(e),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){const e=!!this.cornerRadius(),r=this.hasShadow();return e&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const r=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image;let s;if(a){const o=this.attrs.cropWidth,l=this.attrs.cropHeight;o&&l?s=[a,this.cropX(),this.cropY(),o,l,0,0,r,n]:s=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?PS.Util.drawRoundedRectPath(e,r,n,i):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)),a&&(i&&e.clip(),e.drawImage.apply(e,s))}_hitFunc(e){const r=this.width(),n=this.height(),i=this.cornerRadius();e.beginPath(),i?PS.Util.drawRoundedRectPath(e,r,n,i):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,r;return(e=this.attrs.width)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var e,r;return(e=this.attrs.height)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(e,r,n=null){const i=PS.Util.createImageElement();i.onload=function(){const a=new II({image:i});r(a)},i.onerror=n,i.crossOrigin="Anonymous",i.src=e}};qx.Image=ys;ys.prototype.className="Image";(0,coe._registerNode)(ys);ou.Factory.addGetterSetter(ys,"cornerRadius",0,(0,bm.getNumberOrArrayOfNumbersValidator)(4));ou.Factory.addGetterSetter(ys,"image");ou.Factory.addComponentsGetterSetter(ys,"crop",["x","y","width","height"]);ou.Factory.addGetterSetter(ys,"cropX",0,(0,bm.getNumberValidator)());ou.Factory.addGetterSetter(ys,"cropY",0,(0,bm.getNumberValidator)());ou.Factory.addGetterSetter(ys,"cropWidth",0,(0,bm.getNumberValidator)());ou.Factory.addGetterSetter(ys,"cropHeight",0,(0,bm.getNumberValidator)());var Kd={};Object.defineProperty(Kd,"__esModule",{value:!0});Kd.Tag=Kd.Label=void 0;const Kx=gt,uoe=tn,doe=ff,mN=Ze,LI=pt,BI=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],foe="Change.konva",hoe="none",Uk="up",Gk="right",Hk="down",Wk="left",poe=BI.length;class gN extends doe.Group{constructor(e){super(e),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let r=this,n;const i=function(){r._sync()};for(n=0;n<poe;n++)e.on(BI[n]+foe,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),r=this.getTag(),n,i,a,s,o,l,c;if(e&&r){switch(n=e.width(),i=e.height(),a=r.pointerDirection(),s=r.pointerWidth(),c=r.pointerHeight(),o=0,l=0,a){case Uk:o=n/2,l=-1*c;break;case Gk:o=n+s,l=i/2;break;case Hk:o=n/2,l=i+c;break;case Wk:o=-1*s,l=i/2;break}r.setAttrs({x:-1*o,y:-1*l,width:n,height:i}),e.setAttrs({x:-1*o,y:-1*l})}}}Kd.Label=gN;gN.prototype.className="Label";(0,LI._registerNode)(gN);class lu extends uoe.Shape{_sceneFunc(e){const r=this.width(),n=this.height(),i=this.pointerDirection(),a=this.pointerWidth(),s=this.pointerHeight(),o=this.cornerRadius();let l=0,c=0,u=0,f=0;typeof o=="number"?l=c=u=f=Math.min(o,r/2,n/2):(l=Math.min(o[0]||0,r/2,n/2),c=Math.min(o[1]||0,r/2,n/2),f=Math.min(o[2]||0,r/2,n/2),u=Math.min(o[3]||0,r/2,n/2)),e.beginPath(),e.moveTo(l,0),i===Uk&&(e.lineTo((r-a)/2,0),e.lineTo(r/2,-1*s),e.lineTo((r+a)/2,0)),e.lineTo(r-c,0),e.arc(r-c,c,c,Math.PI*3/2,0,!1),i===Gk&&(e.lineTo(r,(n-s)/2),e.lineTo(r+a,n/2),e.lineTo(r,(n+s)/2)),e.lineTo(r,n-f),e.arc(r-f,n-f,f,0,Math.PI/2,!1),i===Hk&&(e.lineTo((r+a)/2,n),e.lineTo(r/2,n+s),e.lineTo((r-a)/2,n)),e.lineTo(u,n),e.arc(u,n-u,u,Math.PI/2,Math.PI,!1),i===Wk&&(e.lineTo(0,(n+s)/2),e.lineTo(-1*a,n/2),e.lineTo(0,(n-s)/2)),e.lineTo(0,l),e.arc(l,l,l,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,r=0,n=this.pointerWidth(),i=this.pointerHeight(),a=this.pointerDirection(),s=this.width(),o=this.height();return a===Uk?(r-=i,o+=i):a===Hk?o+=i:a===Wk?(e-=n*1.5,s+=n):a===Gk&&(s+=n*1.5),{x:e,y:r,width:s,height:o}}}Kd.Tag=lu;lu.prototype.className="Tag";(0,LI._registerNode)(lu);Kx.Factory.addGetterSetter(lu,"pointerDirection",hoe);Kx.Factory.addGetterSetter(lu,"pointerWidth",0,(0,mN.getNumberValidator)());Kx.Factory.addGetterSetter(lu,"pointerHeight",0,(0,mN.getNumberValidator)());Kx.Factory.addGetterSetter(lu,"cornerRadius",0,(0,mN.getNumberOrArrayOfNumbersValidator)(4));var wm={};Object.defineProperty(wm,"__esModule",{value:!0});wm.Rect=void 0;const moe=gt,goe=tn,voe=pt,yoe=xr,xoe=Ze;let Yx=class extends goe.Shape{_sceneFunc(e){const r=this.cornerRadius(),n=this.width(),i=this.height();e.beginPath(),r?yoe.Util.drawRoundedRectPath(e,n,i,r):e.rect(0,0,n,i),e.closePath(),e.fillStrokeShape(this)}};wm.Rect=Yx;Yx.prototype.className="Rect";(0,voe._registerNode)(Yx);moe.Factory.addGetterSetter(Yx,"cornerRadius",0,(0,xoe.getNumberOrArrayOfNumbersValidator)(4));var Xx={};Object.defineProperty(Xx,"__esModule",{value:!0});Xx.RegularPolygon=void 0;const FI=gt,boe=tn,zI=Ze,woe=pt;class cu extends boe.Shape{_sceneFunc(e){const r=this._getPoints();e.beginPath(),e.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)e.lineTo(r[n].x,r[n].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let i=0;i<e;i++)n.push({x:r*Math.sin(i*2*Math.PI/e),y:-1*r*Math.cos(i*2*Math.PI/e)});return n}getSelfRect(){const e=this._getPoints();let r=e[0].x,n=e[0].y,i=e[0].x,a=e[0].y;return e.forEach(s=>{r=Math.min(r,s.x),n=Math.max(n,s.x),i=Math.min(i,s.y),a=Math.max(a,s.y)}),{x:r,y:i,width:n-r,height:a-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Xx.RegularPolygon=cu;cu.prototype.className="RegularPolygon";cu.prototype._centroid=!0;cu.prototype._attrsAffectingSize=["radius"];(0,woe._registerNode)(cu);FI.Factory.addGetterSetter(cu,"radius",0,(0,zI.getNumberValidator)());FI.Factory.addGetterSetter(cu,"sides",0,(0,zI.getNumberValidator)());var Qx={};Object.defineProperty(Qx,"__esModule",{value:!0});Qx.Ring=void 0;const VI=gt,Soe=tn,$I=Ze,koe=pt,xM=Math.PI*2;class uu extends Soe.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,xM,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),xM,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Qx.Ring=uu;uu.prototype.className="Ring";uu.prototype._centroid=!0;uu.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,koe._registerNode)(uu);VI.Factory.addGetterSetter(uu,"innerRadius",0,(0,$I.getNumberValidator)());VI.Factory.addGetterSetter(uu,"outerRadius",0,(0,$I.getNumberValidator)());var Jx={};Object.defineProperty(Jx,"__esModule",{value:!0});Jx.Sprite=void 0;const du=gt,Coe=tn,Noe=hf,UI=Ze,Eoe=pt;class xs extends Coe.Shape{constructor(e){super(e),this._updated=!0,this.anim=new Noe.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+0],l=a[i+1],c=a[i+2],u=a[i+3],f=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,c,u),e.closePath(),e.fillStrokeShape(this)),f)if(s){const h=s[r],m=n*2;e.drawImage(f,o,l,c,u,h[m+0],h[m+1],c,u)}else e.drawImage(f,o,l,c,u,0,0,c,u)}_hitFunc(e){const r=this.animation(),n=this.frameIndex(),i=n*4,a=this.animations()[r],s=this.frameOffsets(),o=a[i+2],l=a[i+3];if(e.beginPath(),s){const c=s[r],u=n*2;e.rect(c[u+0],c[u+1],o,l)}else e.rect(0,0,o,l);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),r=this.animation(),n=this.animations(),i=n[r],a=i.length/4;e<a-1?this.frameIndex(e+1):this.frameIndex(0)}}Jx.Sprite=xs;xs.prototype.className="Sprite";(0,Eoe._registerNode)(xs);du.Factory.addGetterSetter(xs,"animation");du.Factory.addGetterSetter(xs,"animations");du.Factory.addGetterSetter(xs,"frameOffsets");du.Factory.addGetterSetter(xs,"image");du.Factory.addGetterSetter(xs,"frameIndex",0,(0,UI.getNumberValidator)());du.Factory.addGetterSetter(xs,"frameRate",17,(0,UI.getNumberValidator)());du.Factory.backCompat(xs,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Zx={};Object.defineProperty(Zx,"__esModule",{value:!0});Zx.Star=void 0;const vN=gt,Toe=tn,yN=Ze,joe=pt;class Vl extends Toe.Shape{_sceneFunc(e){const r=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-n);for(let a=1;a<i*2;a++){const s=a%2===0?n:r,o=s*Math.sin(a*Math.PI/i),l=-1*s*Math.cos(a*Math.PI/i);e.lineTo(o,l)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Zx.Star=Vl;Vl.prototype.className="Star";Vl.prototype._centroid=!0;Vl.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,joe._registerNode)(Vl);vN.Factory.addGetterSetter(Vl,"numPoints",5,(0,yN.getNumberValidator)());vN.Factory.addGetterSetter(Vl,"innerRadius",0,(0,yN.getNumberValidator)());vN.Factory.addGetterSetter(Vl,"outerRadius",0,(0,yN.getNumberValidator)());var gf={};Object.defineProperty(gf,"__esModule",{value:!0});gf.Text=void 0;gf.stringToArray=GI;const qk=xr,Kn=gt,Moe=tn,_S=pt,$l=Ze,Poe=pt;function GI(t){return[...t].reduce((e,r,n,i)=>(/\p{Emoji_Modifier_Base}\p{Emoji_Modifier}?(?:\u200D\p{Emoji_Presentation})+/u.test(r)?e.push(r):/\p{Regional_Indicator}{2}/u.test(r+(i[n+1]||""))?e.push(r+i[n+1]):n>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(r)?e[e.length-1]+=r:e.push(r),e),[])}const Vu="auto",_oe="center",HI="inherit",fh="justify",Aoe="Change.konva",Roe="2d",bM="-",WI="left",Doe="text",Ooe="Text",Ioe="top",Loe="bottom",wM="middle",qI="normal",Boe="px ",fv=" ",Foe="right",SM="rtl",zoe="word",Voe="char",kM="none",AS="",KI=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],$oe=KI.length;function Uoe(t){return t.split(",").map(e=>{e=e.trim();const r=e.indexOf(" ")>=0,n=e.indexOf('"')>=0||e.indexOf("'")>=0;return r&&!n&&(e=`"${e}"`),e}).join(", ")}let hv;function RS(){return hv||(hv=qk.Util.createCanvasElement().getContext(Roe),hv)}function Goe(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function Hoe(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Woe(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}let Mr=class extends Moe.Shape{constructor(e){super(Woe(e)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<$oe;r++)this.on(KI[r]+Aoe,this._setTextData);this._setTextData()}_sceneFunc(e){const r=this.textArr,n=r.length;if(!this.text())return;let i=this.padding(),a=this.fontSize(),s=this.lineHeight()*a,o=this.verticalAlign(),l=this.direction(),c=0,u=this.align(),f=this.getWidth(),h=this.letterSpacing(),m=this.fill(),v=this.textDecoration(),y=v.indexOf("underline")!==-1,x=v.indexOf("line-through")!==-1,b;l=l===HI?e.direction:l;let S=s/2,w=wM;if(_S.Konva._fixTextRendering){const I=this.measureSize("M");w="alphabetic",S=(I.fontBoundingBoxAscent-I.fontBoundingBoxDescent)/2+s/2}var k=0,N=0;for(l===SM&&e.setAttr("direction",l),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",w),e.setAttr("textAlign",WI),o===wM?c=(this.getHeight()-n*s-i*2)/2:o===Loe&&(c=this.getHeight()-n*s-i*2),e.translate(i,c+i),b=0;b<n;b++){var k=0,N=0,j=r[b],T=j.text,M=j.width,A=j.lastInParagraph,_,D,R;if(e.save(),u===Foe?k+=f-M-i*2:u===_oe&&(k+=(f-M-i*2)/2),y){e.save(),e.beginPath();const B=_S.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),z=k,U=S+N+B;e.moveTo(z,U),_=T.split(" ").length-1,D=_===0,R=u===fh&&!A?f-i*2:M,e.lineTo(z+Math.round(R),U),e.lineWidth=a/15;const F=this._getLinearGradient();e.strokeStyle=F||m,e.stroke(),e.restore()}if(x){e.save(),e.beginPath();const B=_S.Konva._fixTextRendering?-Math.round(a/4):0;e.moveTo(k,S+N+B),_=T.split(" ").length-1,D=_===0,R=u===fh&&A&&!D?f-i*2:M,e.lineTo(k+Math.round(R),S+N+B),e.lineWidth=a/15;const z=this._getLinearGradient();e.strokeStyle=z||m,e.stroke(),e.restore()}if(l!==SM&&(h!==0||u===fh)){_=T.split(" ").length-1;const B=GI(T);for(let z=0;z<B.length;z++){const U=B[z];U===" "&&!A&&u===fh&&(k+=(f-i*2-M)/_),this._partialTextX=k,this._partialTextY=S+N,this._partialText=U,e.fillStrokeShape(this),k+=this.measureSize(U).width+h}}else h!==0&&e.setAttr("letterSpacing",`${h}px`),this._partialTextX=k,this._partialTextY=S+N,this._partialText=T,e.fillStrokeShape(this);e.restore(),n>1&&(S+=s)}}_hitFunc(e){const r=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}setText(e){const r=qk.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(Doe,r),this}getWidth(){return this.attrs.width===Vu||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Vu||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return qk.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var r,n,i,a,s,o,l,c,u,f,h;let m=RS(),v=this.fontSize(),y;m.save(),m.font=this._getContextFont(),y=m.measureText(e),m.restore();const x=v/100;return{actualBoundingBoxAscent:(r=y.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*x,actualBoundingBoxDescent:(n=y.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(i=y.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*x,actualBoundingBoxRight:(a=y.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*x,alphabeticBaseline:(s=y.alphabeticBaseline)!==null&&s!==void 0?s:0,emHeightAscent:(o=y.emHeightAscent)!==null&&o!==void 0?o:100*x,emHeightDescent:(l=y.emHeightDescent)!==null&&l!==void 0?l:-20*x,fontBoundingBoxAscent:(c=y.fontBoundingBoxAscent)!==null&&c!==void 0?c:91*x,fontBoundingBoxDescent:(u=y.fontBoundingBoxDescent)!==null&&u!==void 0?u:21*x,hangingBaseline:(f=y.hangingBaseline)!==null&&f!==void 0?f:72.80000305175781*x,ideographicBaseline:(h=y.ideographicBaseline)!==null&&h!==void 0?h:-21*x,width:y.width,height:v}}_getContextFont(){return this.fontStyle()+fv+this.fontVariant()+fv+(this.fontSize()+Boe)+Uoe(this.fontFamily())}_addTextLine(e){this.align()===fh&&(e=e.trim());const n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){const r=this.letterSpacing(),n=e.length;return RS().measureText(e).width+(n?r*(n-1):0)}_setTextData(){let e=this.text().split(`
`),r=+this.fontSize(),n=0,i=this.lineHeight()*r,a=this.attrs.width,s=this.attrs.height,o=a!==Vu&&a!==void 0,l=s!==Vu&&s!==void 0,c=this.padding(),u=a-c*2,f=s-c*2,h=0,m=this.wrap(),v=m!==kM,y=m!==Voe&&v,x=this.ellipsis();this.textArr=[],RS().font=this._getContextFont();const b=x?this._getTextWidth(AS):0;for(let w=0,k=e.length;w<k;++w){let N=e[w],j=this._getTextWidth(N);if(o&&j>u)for(;N.length>0;){let T=0,M=N.length,A="",_=0;for(;T<M;){const D=T+M>>>1,R=N.slice(0,D+1),I=this._getTextWidth(R)+b;I<=u?(T=D+1,A=R,_=I):M=D}if(A){if(y){var S;const R=N[A.length];(R===fv||R===bM)&&_<=u?S=A.length:S=Math.max(A.lastIndexOf(fv),A.lastIndexOf(bM))+1,S>0&&(T=S,A=A.slice(0,T),_=this._getTextWidth(A))}if(A=A.trimRight(),this._addTextLine(A),n=Math.max(n,_),h+=i,this._shouldHandleEllipsis(h)){this._tryToAddEllipsisToLastLine();break}if(N=N.slice(T),N=N.trimLeft(),N.length>0&&(j=this._getTextWidth(N),j<=u)){this._addTextLine(N),h+=i,n=Math.max(n,j);break}}else break}else this._addTextLine(N),h+=i,n=Math.max(n,j),this._shouldHandleEllipsis(h)&&w<k-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&h+i>f)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(e){const r=+this.fontSize(),n=this.lineHeight()*r,i=this.attrs.height,a=i!==Vu&&i!==void 0,s=this.padding(),o=i-s*2;return!(this.wrap()!==kM)||a&&e+n>o}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,r=e!==Vu&&e!==void 0,n=this.padding(),i=e-n*2,a=this.ellipsis(),s=this.textArr[this.textArr.length-1];!s||!a||(r&&(this._getTextWidth(s.text+AS)<i||(s.text=s.text.slice(0,s.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(s.text+AS))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return e&&r?!0:super._useBufferCanvas()}};gf.Text=Mr;Mr.prototype._fillFunc=Goe;Mr.prototype._strokeFunc=Hoe;Mr.prototype.className=Ooe;Mr.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,Poe._registerNode)(Mr);Kn.Factory.overWriteSetter(Mr,"width",(0,$l.getNumberOrAutoValidator)());Kn.Factory.overWriteSetter(Mr,"height",(0,$l.getNumberOrAutoValidator)());Kn.Factory.addGetterSetter(Mr,"direction",HI);Kn.Factory.addGetterSetter(Mr,"fontFamily","Arial");Kn.Factory.addGetterSetter(Mr,"fontSize",12,(0,$l.getNumberValidator)());Kn.Factory.addGetterSetter(Mr,"fontStyle",qI);Kn.Factory.addGetterSetter(Mr,"fontVariant",qI);Kn.Factory.addGetterSetter(Mr,"padding",0,(0,$l.getNumberValidator)());Kn.Factory.addGetterSetter(Mr,"align",WI);Kn.Factory.addGetterSetter(Mr,"verticalAlign",Ioe);Kn.Factory.addGetterSetter(Mr,"lineHeight",1,(0,$l.getNumberValidator)());Kn.Factory.addGetterSetter(Mr,"wrap",zoe);Kn.Factory.addGetterSetter(Mr,"ellipsis",!1,(0,$l.getBooleanValidator)());Kn.Factory.addGetterSetter(Mr,"letterSpacing",0,(0,$l.getNumberValidator)());Kn.Factory.addGetterSetter(Mr,"text","",(0,$l.getStringValidator)());Kn.Factory.addGetterSetter(Mr,"textDecoration","");var e1={};Object.defineProperty(e1,"__esModule",{value:!0});e1.TextPath=void 0;const DS=xr,Ba=gt,qoe=tn,hh=pf,OS=gf,YI=Ze,Koe=pt,Yoe="",XI="normal";function QI(t){t.fillText(this.partialText,0,0)}function JI(t){t.strokeText(this.partialText,0,0)}class rn extends qoe.Shape{constructor(e){super(e),this.dummyCanvas=DS.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return hh.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const r=this.pathLength;return e-1>r?null:hh.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=hh.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const r=this.textDecoration(),n=this.fill(),i=this.fontSize(),a=this.glyphInfo;r==="underline"&&e.beginPath();for(let s=0;s<a.length;s++){e.save();const o=a[s].p0;e.translate(o.x,o.y),e.rotate(a[s].rotation),this.partialText=a[s].text,e.fillStrokeShape(this),r==="underline"&&(s===0&&e.moveTo(0,i/2+1),e.lineTo(i,i/2+1)),e.restore()}r==="underline"&&(e.strokeStyle=n,e.lineWidth=i/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;e.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const i=r[n].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return DS.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return OS.Text.prototype.setText.call(this,e)}_getContextFont(){return OS.Text.prototype._getContextFont.call(this)}_getTextSize(e){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const i=n.measureText(e);return n.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),i=this.align(),a=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let o=0;i==="center"&&(o=Math.max(0,this.pathLength/2-s/2)),i==="right"&&(o=Math.max(0,this.pathLength-s));const l=(0,OS.stringToArray)(this.text());let c=o;for(let u=0;u<l.length;u++){const f=this._getPointAtLength(c);if(!f)return;let h=this._getTextSize(l[u]).width+n;if(l[u]===" "&&i==="justify"){const S=this.text().split(" ").length-1;h+=(this.pathLength-s)/S}const m=this._getPointAtLength(c+h);if(!m)return;const v=hh.Path.getLineLength(f.x,f.y,m.x,m.y);let y=0;if(a)try{y=a(l[u-1],l[u])*this.fontSize()}catch{y=0}f.x+=y,m.x+=y,this.textWidth+=y;const x=hh.Path.getPointOnLine(y+v/2,f.x,f.y,m.x,m.y),b=Math.atan2(m.y-f.y,m.x-f.x);this.glyphInfo.push({transposeX:x.x,transposeY:x.y,text:l[u],rotation:b,p0:f,p1:m}),c+=h}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(c){e.push(c.p0.x),e.push(c.p0.y),e.push(c.p1.x),e.push(c.p1.y)});let r=e[0]||0,n=e[0]||0,i=e[1]||0,a=e[1]||0,s,o;for(let c=0;c<e.length/2;c++)s=e[c*2],o=e[c*2+1],r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),a=Math.max(a,o);const l=this.fontSize();return{x:r-l/2,y:i-l/2,width:n-r+l,height:a-i+l}}destroy(){return DS.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}e1.TextPath=rn;rn.prototype._fillFunc=QI;rn.prototype._strokeFunc=JI;rn.prototype._fillFuncHit=QI;rn.prototype._strokeFuncHit=JI;rn.prototype.className="TextPath";rn.prototype._attrsAffectingSize=["text","fontSize","data"];(0,Koe._registerNode)(rn);Ba.Factory.addGetterSetter(rn,"data");Ba.Factory.addGetterSetter(rn,"fontFamily","Arial");Ba.Factory.addGetterSetter(rn,"fontSize",12,(0,YI.getNumberValidator)());Ba.Factory.addGetterSetter(rn,"fontStyle",XI);Ba.Factory.addGetterSetter(rn,"align","left");Ba.Factory.addGetterSetter(rn,"letterSpacing",0,(0,YI.getNumberValidator)());Ba.Factory.addGetterSetter(rn,"textBaseline","middle");Ba.Factory.addGetterSetter(rn,"fontVariant",XI);Ba.Factory.addGetterSetter(rn,"text",Yoe);Ba.Factory.addGetterSetter(rn,"textDecoration",null);Ba.Factory.addGetterSetter(rn,"kerningFunc",null);var t1={};Object.defineProperty(t1,"__esModule",{value:!0});t1.Transformer=void 0;const Vt=xr,Dt=gt,CM=dr,Xoe=tn,Qoe=wm,NM=ff,ka=pt,Ul=Ze,Joe=pt,ZI="tr-konva",Zoe=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${ZI}`).join(" "),EM="nodesRect",ele=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],tle={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},rle="ontouchstart"in ka.Konva._global;function nle(t,e,r){if(t==="rotater")return r;e+=Vt.Util.degToRad(tle[t]||0);const n=(Vt.Util.radToDeg(e)%360+360)%360;return Vt.Util._inRange(n,315+22.5,360)||Vt.Util._inRange(n,0,22.5)?"ns-resize":Vt.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":Vt.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":Vt.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":Vt.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":Vt.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":Vt.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":Vt.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(Vt.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const My=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],TM=1e8;function ile(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function eL(t,e,r){const n=r.x+(t.x-r.x)*Math.cos(e)-(t.y-r.y)*Math.sin(e),i=r.y+(t.x-r.x)*Math.sin(e)+(t.y-r.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:n,y:i}}function ale(t,e){const r=ile(t);return eL(t,e,r)}function sle(t,e,r){let n=e;for(let i=0;i<t.length;i++){const a=ka.Konva.getAngle(t[i]),s=Math.abs(a-e)%(Math.PI*2);Math.min(s,Math.PI*2-s)<r&&(n=a)}return n}let Kk=0,Nt=class extends NM.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(Zoe,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return Vt.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return ZI+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const r=e.filter(i=>i.isAncestorOf(this)?(Vt.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=r,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},s=i._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");i.on(s,a),i.on(ele.map(o=>o+`.${this._getEventNamespace()}`).join(" "),a),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let r;e.on(`dragstart.${this._getEventNamespace()}`,n=>{r=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(n,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const i=e.getAbsolutePosition(),a=i.x-r.x,s=i.y-r.y;this.nodes().forEach(o=>{if(o===e||o.isDragging())return;const l=o.getAbsolutePosition();o.setAbsolutePosition({x:l.x+a,y:l.y+s}),o.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(EM),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(EM,this.__getNodeRect)}__getNodeShape(e,r=this.rotation(),n){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=e.getAbsoluteScale(n),s=e.getAbsolutePosition(n),o=i.x*a.x-e.offsetX()*a.x,l=i.y*a.y-e.offsetY()*a.y,c=(ka.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),u={x:s.x+o*Math.cos(c)+l*Math.sin(-c),y:s.y+l*Math.cos(c)+o*Math.sin(c),width:i.width*a.x,height:i.height*a.y,rotation:c};return eL(u,-ka.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-TM,y:-TM,width:0,height:0,rotation:0};const r=[];this.nodes().map(c=>{const u=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),f=[{x:u.x,y:u.y},{x:u.x+u.width,y:u.y},{x:u.x+u.width,y:u.y+u.height},{x:u.x,y:u.y+u.height}],h=c.getAbsoluteTransform();f.forEach(function(m){const v=h.point(m);r.push(v)})});const n=new Vt.Transform;n.rotate(-ka.Konva.getAngle(this.rotation()));let i=1/0,a=1/0,s=-1/0,o=-1/0;r.forEach(function(c){const u=n.point(c);i===void 0&&(i=s=u.x,a=o=u.y),i=Math.min(i,u.x),a=Math.min(a,u.y),s=Math.max(s,u.x),o=Math.max(o,u.y)}),n.invert();const l=n.point({x:i,y:a});return{x:l.x,y:l.y,width:s-i,height:o-a,rotation:ka.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),My.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const r=new Qoe.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:rle?10:"auto"}),n=this;r.on("mousedown touchstart",function(i){n._handleMouseDown(i)}),r.on("dragstart",i=>{r.stopDrag(),i.cancelBubble=!0}),r.on("dragend",i=>{i.cancelBubble=!0}),r.on("mouseenter",()=>{const i=ka.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),s=nle(e,i,a);r.getStage().content&&(r.getStage().content.style.cursor=s),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const e=new Xoe.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const i=n.getParent(),a=i.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),i.rotateEnabled()&&i.rotateLineVisible()&&r.lineTo(n.width()/2,-i.rotateAnchorOffset()*Vt.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();r.beginPath(),r.rect(-i,-i,n.width()+i*2,n.height()+i*2),r.fillStrokeShape(n)}});this.add(e),this._proxyDrag(e),e.on("dragstart",r=>{r.cancelBubble=!0}),e.on("dragmove",r=>{r.cancelBubble=!0}),e.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,i=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.sin=Math.abs(i/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const s=e.target.getAbsolutePosition(),o=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-s.x,y:o.y-s.y},Kk++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:e.evt,target:l})})}_handleMouseMove(e){let r,n,i;const a=this.findOne("."+this._movingAnchorName),s=a.getStage();s.setPointersPositions(e);const o=s.getPointerPosition();let l={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const c=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(c,l,e)),a.setAbsolutePosition(l);const u=a.getAbsolutePosition();if(c.x===u.x&&c.y===u.y)return;if(this._movingAnchorName==="rotater"){const N=this._getNodeRect();r=a.x()-N.width/2,n=-a.y()+N.height/2;let j=Math.atan2(-n,r)+Math.PI/2;N.height<0&&(j-=Math.PI);const M=ka.Konva.getAngle(this.rotation())+j,A=ka.Konva.getAngle(this.rotationSnapTolerance()),D=sle(this.rotationSnaps(),M,A)-N.rotation,R=ale(N,D);this._fitNodesInto(R,e);return}const f=this.shiftBehavior();let h;f==="inverted"?h=this.keepRatio()&&!e.shiftKey:f==="none"?h=this.keepRatio():h=this.keepRatio()||e.shiftKey;var b=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(h){var m=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(m.x-a.x(),2)+Math.pow(m.y-a.y(),2));var v=this.findOne(".top-left").x()>m.x?-1:1,y=this.findOne(".top-left").y()>m.y?-1:1;r=i*this.cos*v,n=i*this.sin*y,this.findOne(".top-left").x(m.x-r),this.findOne(".top-left").y(m.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(h){var m=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(a.x()-m.x,2)+Math.pow(m.y-a.y(),2));var v=this.findOne(".top-right").x()<m.x?-1:1,y=this.findOne(".top-right").y()>m.y?-1:1;r=i*this.cos*v,n=i*this.sin*y,this.findOne(".top-right").x(m.x+r),this.findOne(".top-right").y(m.y-n)}var x=a.position();this.findOne(".top-left").y(x.y),this.findOne(".bottom-right").x(x.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(h){var m=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(m.x-a.x(),2)+Math.pow(a.y()-m.y,2));var v=m.x<a.x()?-1:1,y=a.y()<m.y?-1:1;r=i*this.cos*v,n=i*this.sin*y,a.x(m.x-r),a.y(m.y+n)}x=a.position(),this.findOne(".top-left").x(x.x),this.findOne(".bottom-right").y(x.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(h){var m=b?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(a.x()-m.x,2)+Math.pow(a.y()-m.y,2));var v=this.findOne(".bottom-right").x()<m.x?-1:1,y=this.findOne(".bottom-right").y()<m.y?-1:1;r=i*this.cos*v,n=i*this.sin*y,this.findOne(".bottom-right").x(m.x+r),this.findOne(".bottom-right").y(m.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var b=this.centeredScaling()||e.altKey;if(b){const N=this.findOne(".top-left"),j=this.findOne(".bottom-right"),T=N.x(),M=N.y(),A=this.getWidth()-j.x(),_=this.getHeight()-j.y();j.move({x:-T,y:-M}),N.move({x:A,y:_})}const S=this.findOne(".top-left").getAbsolutePosition();r=S.x,n=S.y;const w=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),k=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:w,height:k,rotation:ka.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();Kk--,this._fire("transformend",{evt:e,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(i=>{var a;i._fire("transformend",{evt:e,target:i}),(a=i.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,r){const n=this._getNodeRect(),i=1;if(Vt.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(Vt.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const a=new Vt.Transform;if(a.rotate(ka.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const h=a.point({x:-this.padding()*2,y:0});e.x+=h.x,e.y+=h.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const h=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const h=a.point({x:0,y:-this.padding()*2});e.x+=h.x,e.y+=h.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const h=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const h=this.boundBoxFunc()(n,e);h?e=h:Vt.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const s=1e7,o=new Vt.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/s,n.height/s);const l=new Vt.Transform,c=e.width/s,u=e.height/s;this.flipEnabled()===!1?(l.translate(e.x,e.y),l.rotate(e.rotation),l.translate(e.width<0?e.width:0,e.height<0?e.height:0),l.scale(Math.abs(c),Math.abs(u))):(l.translate(e.x,e.y),l.rotate(e.rotation),l.scale(c,u));const f=l.multiply(o.invert());this._nodes.forEach(h=>{var m;const v=h.getParent().getAbsoluteTransform(),y=h.getTransform().copy();y.translate(h.offsetX(),h.offsetY());const x=new Vt.Transform;x.multiply(v.copy().invert()).multiply(f).multiply(v).multiply(y);const b=x.decompose();h.setAttrs(b),(m=h.getLayer())===null||m===void 0||m.batchDraw()}),this.rotation(Vt.Util._getRotation(e.rotation)),this._nodes.forEach(h=>{this._fire("transform",{evt:r,target:h}),h._fire("transform",{evt:r,target:h})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,r){this.findOne(e).setAttrs(r)}update(){var e;const r=this._getNodeRect();this.rotation(Vt.Util._getRotation(r.rotation));const n=r.width,i=r.height,a=this.enabledAnchors(),s=this.resizeEnabled(),o=this.padding(),l=this.anchorSize(),c=this.find("._anchor");c.forEach(f=>{f.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+o,offsetY:l/2+o,visible:s&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+o,visible:s&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-o,offsetY:l/2+o,visible:s&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:l/2+o,visible:s&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:i/2,offsetX:l/2-o,visible:s&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:l/2+o,offsetY:l/2-o,visible:s&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:i,offsetY:l/2-o,visible:s&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:i,offsetX:l/2-o,offsetY:l/2-o,visible:s&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*Vt.Util._sign(i)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const u=this.anchorStyleFunc();u&&c.forEach(f=>{u(f)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),NM.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return CM.Node.prototype.toObject.call(this)}clone(e){return CM.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};t1.Transformer=Nt;Nt.isTransforming=()=>Kk>0;function ole(t){return t instanceof Array||Vt.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){My.indexOf(e)===-1&&Vt.Util.warn("Unknown anchor name: "+e+". Available names are: "+My.join(", "))}),t||[]}Nt.prototype.className="Transformer";(0,Joe._registerNode)(Nt);Dt.Factory.addGetterSetter(Nt,"enabledAnchors",My,ole);Dt.Factory.addGetterSetter(Nt,"flipEnabled",!0,(0,Ul.getBooleanValidator)());Dt.Factory.addGetterSetter(Nt,"resizeEnabled",!0);Dt.Factory.addGetterSetter(Nt,"anchorSize",10,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Nt,"rotateEnabled",!0);Dt.Factory.addGetterSetter(Nt,"rotateLineVisible",!0);Dt.Factory.addGetterSetter(Nt,"rotationSnaps",[]);Dt.Factory.addGetterSetter(Nt,"rotateAnchorOffset",50,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Nt,"rotateAnchorCursor","crosshair");Dt.Factory.addGetterSetter(Nt,"rotationSnapTolerance",5,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Nt,"borderEnabled",!0);Dt.Factory.addGetterSetter(Nt,"anchorStroke","rgb(0, 161, 255)");Dt.Factory.addGetterSetter(Nt,"anchorStrokeWidth",1,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Nt,"anchorFill","white");Dt.Factory.addGetterSetter(Nt,"anchorCornerRadius",0,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Nt,"borderStroke","rgb(0, 161, 255)");Dt.Factory.addGetterSetter(Nt,"borderStrokeWidth",1,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Nt,"borderDash");Dt.Factory.addGetterSetter(Nt,"keepRatio",!0);Dt.Factory.addGetterSetter(Nt,"shiftBehavior","default");Dt.Factory.addGetterSetter(Nt,"centeredScaling",!1);Dt.Factory.addGetterSetter(Nt,"ignoreStroke",!1);Dt.Factory.addGetterSetter(Nt,"padding",0,(0,Ul.getNumberValidator)());Dt.Factory.addGetterSetter(Nt,"node");Dt.Factory.addGetterSetter(Nt,"nodes");Dt.Factory.addGetterSetter(Nt,"boundBoxFunc");Dt.Factory.addGetterSetter(Nt,"anchorDragBoundFunc");Dt.Factory.addGetterSetter(Nt,"anchorStyleFunc");Dt.Factory.addGetterSetter(Nt,"shouldOverdrawWholeArea",!1);Dt.Factory.addGetterSetter(Nt,"useSingleNodeRotation",!0);Dt.Factory.backCompat(Nt,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var r1={};Object.defineProperty(r1,"__esModule",{value:!0});r1.Wedge=void 0;const n1=gt,lle=tn,cle=pt,tL=Ze,ule=pt;class fo extends lle.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,cle.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}r1.Wedge=fo;fo.prototype.className="Wedge";fo.prototype._centroid=!0;fo.prototype._attrsAffectingSize=["radius"];(0,ule._registerNode)(fo);n1.Factory.addGetterSetter(fo,"radius",0,(0,tL.getNumberValidator)());n1.Factory.addGetterSetter(fo,"angle",0,(0,tL.getNumberValidator)());n1.Factory.addGetterSetter(fo,"clockwise",!1);n1.Factory.backCompat(fo,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var i1={};Object.defineProperty(i1,"__esModule",{value:!0});i1.Blur=void 0;const jM=gt,dle=dr,fle=Ze;function MM(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const hle=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],ple=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function mle(t,e){const r=t.data,n=t.width,i=t.height;let a,s,o,l,c,u,f,h,m,v,y,x,b,S,w,k,N,j,T,M,A,_,D,R,I=e+e+1,$=n-1,B=i-1,z=e+1,U=z*(z+1)/2,F=new MM,Q=null,K=F,L=null,G=null,ee=hle[e],re=ple[e];for(o=1;o<I;o++)K=K.next=new MM,o===z&&(Q=K);for(K.next=F,f=u=0,s=0;s<i;s++){for(k=N=j=T=h=m=v=y=0,x=z*(M=r[u]),b=z*(A=r[u+1]),S=z*(_=r[u+2]),w=z*(D=r[u+3]),h+=U*M,m+=U*A,v+=U*_,y+=U*D,K=F,o=0;o<z;o++)K.r=M,K.g=A,K.b=_,K.a=D,K=K.next;for(o=1;o<z;o++)l=u+(($<o?$:o)<<2),h+=(K.r=M=r[l])*(R=z-o),m+=(K.g=A=r[l+1])*R,v+=(K.b=_=r[l+2])*R,y+=(K.a=D=r[l+3])*R,k+=M,N+=A,j+=_,T+=D,K=K.next;for(L=F,G=Q,a=0;a<n;a++)r[u+3]=D=y*ee>>re,D!==0?(D=255/D,r[u]=(h*ee>>re)*D,r[u+1]=(m*ee>>re)*D,r[u+2]=(v*ee>>re)*D):r[u]=r[u+1]=r[u+2]=0,h-=x,m-=b,v-=S,y-=w,x-=L.r,b-=L.g,S-=L.b,w-=L.a,l=f+((l=a+e+1)<$?l:$)<<2,k+=L.r=r[l],N+=L.g=r[l+1],j+=L.b=r[l+2],T+=L.a=r[l+3],h+=k,m+=N,v+=j,y+=T,L=L.next,x+=M=G.r,b+=A=G.g,S+=_=G.b,w+=D=G.a,k-=M,N-=A,j-=_,T-=D,G=G.next,u+=4;f+=n}for(a=0;a<n;a++){for(N=j=T=k=m=v=y=h=0,u=a<<2,x=z*(M=r[u]),b=z*(A=r[u+1]),S=z*(_=r[u+2]),w=z*(D=r[u+3]),h+=U*M,m+=U*A,v+=U*_,y+=U*D,K=F,o=0;o<z;o++)K.r=M,K.g=A,K.b=_,K.a=D,K=K.next;for(c=n,o=1;o<=e;o++)u=c+a<<2,h+=(K.r=M=r[u])*(R=z-o),m+=(K.g=A=r[u+1])*R,v+=(K.b=_=r[u+2])*R,y+=(K.a=D=r[u+3])*R,k+=M,N+=A,j+=_,T+=D,K=K.next,o<B&&(c+=n);for(u=a,L=F,G=Q,s=0;s<i;s++)l=u<<2,r[l+3]=D=y*ee>>re,D>0?(D=255/D,r[l]=(h*ee>>re)*D,r[l+1]=(m*ee>>re)*D,r[l+2]=(v*ee>>re)*D):r[l]=r[l+1]=r[l+2]=0,h-=x,m-=b,v-=S,y-=w,x-=L.r,b-=L.g,S-=L.b,w-=L.a,l=a+((l=s+z)<B?l:B)*n<<2,h+=k+=L.r=r[l],m+=N+=L.g=r[l+1],v+=j+=L.b=r[l+2],y+=T+=L.a=r[l+3],L=L.next,x+=M=G.r,b+=A=G.g,S+=_=G.b,w+=D=G.a,k-=M,N-=A,j-=_,T-=D,G=G.next,u+=n}}const gle=function(e){const r=Math.round(this.blurRadius());r>0&&mle(e,r)};i1.Blur=gle;jM.Factory.addGetterSetter(dle.Node,"blurRadius",0,(0,fle.getNumberValidator)(),jM.Factory.afterSetFilter);var a1={};Object.defineProperty(a1,"__esModule",{value:!0});a1.Brighten=void 0;const PM=gt,vle=dr,yle=Ze,xle=function(t){let e=this.brightness()*255,r=t.data,n=r.length,i;for(i=0;i<n;i+=4)r[i]+=e,r[i+1]+=e,r[i+2]+=e};a1.Brighten=xle;PM.Factory.addGetterSetter(vle.Node,"brightness",0,(0,yle.getNumberValidator)(),PM.Factory.afterSetFilter);var s1={};Object.defineProperty(s1,"__esModule",{value:!0});s1.Contrast=void 0;const _M=gt,ble=dr,wle=Ze,Sle=function(t){const e=Math.pow((this.contrast()+100)/100,2);let r=t.data,n=r.length,i=150,a=150,s=150,o;for(o=0;o<n;o+=4)i=r[o],a=r[o+1],s=r[o+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,s/=255,s-=.5,s*=e,s+=.5,s*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,s=s<0?0:s>255?255:s,r[o]=i,r[o+1]=a,r[o+2]=s};s1.Contrast=Sle;_M.Factory.addGetterSetter(ble.Node,"contrast",0,(0,wle.getNumberValidator)(),_M.Factory.afterSetFilter);var o1={};Object.defineProperty(o1,"__esModule",{value:!0});o1.Emboss=void 0;const kl=gt,l1=dr,kle=xr,rL=Ze,Cle=function(t){let e=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),i=this.embossBlend(),a=0,s=0,o=t.data,l=t.width,c=t.height,u=l*4,f=c;switch(n){case"top-left":a=-1,s=-1;break;case"top":a=-1,s=0;break;case"top-right":a=-1,s=1;break;case"right":a=0,s=1;break;case"bottom-right":a=1,s=1;break;case"bottom":a=1,s=0;break;case"bottom-left":a=1,s=-1;break;case"left":a=0,s=-1;break;default:kle.Util.error("Unknown emboss direction: "+n)}do{const h=(f-1)*u;let m=a;f+m<1&&(m=0),f+m>c&&(m=0);const v=(f-1+m)*l*4;let y=l;do{const x=h+(y-1)*4;let b=s;y+b<1&&(b=0),y+b>l&&(b=0);const S=v+(y-1+b)*4,w=o[x]-o[S],k=o[x+1]-o[S+1],N=o[x+2]-o[S+2];let j=w;const T=j>0?j:-j,M=k>0?k:-k,A=N>0?N:-N;if(M>T&&(j=k),A>T&&(j=N),j*=e,i){const _=o[x]+j,D=o[x+1]+j,R=o[x+2]+j;o[x]=_>255?255:_<0?0:_,o[x+1]=D>255?255:D<0?0:D,o[x+2]=R>255?255:R<0?0:R}else{let _=r-j;_<0?_=0:_>255&&(_=255),o[x]=o[x+1]=o[x+2]=_}}while(--y)}while(--f)};o1.Emboss=Cle;kl.Factory.addGetterSetter(l1.Node,"embossStrength",.5,(0,rL.getNumberValidator)(),kl.Factory.afterSetFilter);kl.Factory.addGetterSetter(l1.Node,"embossWhiteLevel",.5,(0,rL.getNumberValidator)(),kl.Factory.afterSetFilter);kl.Factory.addGetterSetter(l1.Node,"embossDirection","top-left",null,kl.Factory.afterSetFilter);kl.Factory.addGetterSetter(l1.Node,"embossBlend",!1,null,kl.Factory.afterSetFilter);var c1={};Object.defineProperty(c1,"__esModule",{value:!0});c1.Enhance=void 0;const AM=gt,Nle=dr,Ele=Ze;function IS(t,e,r,n,i){let a=r-e,s=i-n,o;return a===0?n+s/2:s===0?n:(o=(t-e)/a,o=s*o+n,o)}const Tle=function(t){let e=t.data,r=e.length,n=e[0],i=n,a,s=e[1],o=s,l,c=e[2],u=c,f,h;const m=this.enhance();if(m===0)return;for(h=0;h<r;h+=4)a=e[h+0],a<n?n=a:a>i&&(i=a),l=e[h+1],l<s?s=l:l>o&&(o=l),f=e[h+2],f<c?c=f:f>u&&(u=f);i===n&&(i=255,n=0),o===s&&(o=255,s=0),u===c&&(u=255,c=0);let v,y,x,b,S,w,k,N,j;for(m>0?(y=i+m*(255-i),x=n-m*(n-0),S=o+m*(255-o),w=s-m*(s-0),N=u+m*(255-u),j=c-m*(c-0)):(v=(i+n)*.5,y=i+m*(i-v),x=n+m*(n-v),b=(o+s)*.5,S=o+m*(o-b),w=s+m*(s-b),k=(u+c)*.5,N=u+m*(u-k),j=c+m*(c-k)),h=0;h<r;h+=4)e[h+0]=IS(e[h+0],n,i,x,y),e[h+1]=IS(e[h+1],s,o,w,S),e[h+2]=IS(e[h+2],c,u,j,N)};c1.Enhance=Tle;AM.Factory.addGetterSetter(Nle.Node,"enhance",0,(0,Ele.getNumberValidator)(),AM.Factory.afterSetFilter);var u1={};Object.defineProperty(u1,"__esModule",{value:!0});u1.Grayscale=void 0;const jle=function(t){let e=t.data,r=e.length,n,i;for(n=0;n<r;n+=4)i=.34*e[n]+.5*e[n+1]+.16*e[n+2],e[n]=i,e[n+1]=i,e[n+2]=i};u1.Grayscale=jle;var d1={};Object.defineProperty(d1,"__esModule",{value:!0});d1.HSL=void 0;const Yd=gt,xN=dr,bN=Ze;Yd.Factory.addGetterSetter(xN.Node,"hue",0,(0,bN.getNumberValidator)(),Yd.Factory.afterSetFilter);Yd.Factory.addGetterSetter(xN.Node,"saturation",0,(0,bN.getNumberValidator)(),Yd.Factory.afterSetFilter);Yd.Factory.addGetterSetter(xN.Node,"luminance",0,(0,bN.getNumberValidator)(),Yd.Factory.afterSetFilter);const Mle=function(t){let e=t.data,r=e.length,n=1,i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=this.luminance()*127,o;const l=n*i*Math.cos(a*Math.PI/180),c=n*i*Math.sin(a*Math.PI/180),u=.299*n+.701*l+.167*c,f=.587*n-.587*l+.33*c,h=.114*n-.114*l-.497*c,m=.299*n-.299*l-.328*c,v=.587*n+.413*l+.035*c,y=.114*n-.114*l+.293*c,x=.299*n-.3*l+1.25*c,b=.587*n-.586*l-1.05*c,S=.114*n+.886*l-.2*c;let w,k,N,j;for(o=0;o<r;o+=4)w=e[o+0],k=e[o+1],N=e[o+2],j=e[o+3],e[o+0]=u*w+f*k+h*N+s,e[o+1]=m*w+v*k+y*N+s,e[o+2]=x*w+b*k+S*N+s,e[o+3]=j};d1.HSL=Mle;var f1={};Object.defineProperty(f1,"__esModule",{value:!0});f1.HSV=void 0;const Xd=gt,wN=dr,SN=Ze,Ple=function(t){const e=t.data,r=e.length,n=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,s=n*i*Math.cos(a*Math.PI/180),o=n*i*Math.sin(a*Math.PI/180),l=.299*n+.701*s+.167*o,c=.587*n-.587*s+.33*o,u=.114*n-.114*s-.497*o,f=.299*n-.299*s-.328*o,h=.587*n+.413*s+.035*o,m=.114*n-.114*s+.293*o,v=.299*n-.3*s+1.25*o,y=.587*n-.586*s-1.05*o,x=.114*n+.886*s-.2*o;let b,S,w,k;for(let N=0;N<r;N+=4)b=e[N+0],S=e[N+1],w=e[N+2],k=e[N+3],e[N+0]=l*b+c*S+u*w,e[N+1]=f*b+h*S+m*w,e[N+2]=v*b+y*S+x*w,e[N+3]=k};f1.HSV=Ple;Xd.Factory.addGetterSetter(wN.Node,"hue",0,(0,SN.getNumberValidator)(),Xd.Factory.afterSetFilter);Xd.Factory.addGetterSetter(wN.Node,"saturation",0,(0,SN.getNumberValidator)(),Xd.Factory.afterSetFilter);Xd.Factory.addGetterSetter(wN.Node,"value",0,(0,SN.getNumberValidator)(),Xd.Factory.afterSetFilter);var h1={};Object.defineProperty(h1,"__esModule",{value:!0});h1.Invert=void 0;const _le=function(t){let e=t.data,r=e.length,n;for(n=0;n<r;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]};h1.Invert=_le;var p1={};Object.defineProperty(p1,"__esModule",{value:!0});p1.Kaleidoscope=void 0;const Py=gt,nL=dr,RM=xr,iL=Ze,Ale=function(t,e,r){let n=t.data,i=e.data,a=t.width,s=t.height,o=r.polarCenterX||a/2,l=r.polarCenterY||s/2,c,u,f,h=0,m=0,v=0,y=0,x,b=Math.sqrt(o*o+l*l);u=a-o,f=s-l,x=Math.sqrt(u*u+f*f),b=x>b?x:b;let S=s,w=a,k,N,j=360/w*Math.PI/180,T,M;for(N=0;N<w;N+=1)for(T=Math.sin(N*j),M=Math.cos(N*j),k=0;k<S;k+=1)u=Math.floor(o+b*k/S*M),f=Math.floor(l+b*k/S*T),c=(f*a+u)*4,h=n[c+0],m=n[c+1],v=n[c+2],y=n[c+3],c=(N+k*a)*4,i[c+0]=h,i[c+1]=m,i[c+2]=v,i[c+3]=y},Rle=function(t,e,r){let n=t.data,i=e.data,a=t.width,s=t.height,o=r.polarCenterX||a/2,l=r.polarCenterY||s/2,c,u,f,h,m,v=0,y=0,x=0,b=0,S,w=Math.sqrt(o*o+l*l);u=a-o,f=s-l,S=Math.sqrt(u*u+f*f),w=S>w?S:w;let k=s,N=a,j,T,M=r.polarRotation||0,A,_;for(u=0;u<a;u+=1)for(f=0;f<s;f+=1)h=u-o,m=f-l,j=Math.sqrt(h*h+m*m)*k/w,T=(Math.atan2(m,h)*180/Math.PI+360+M)%360,T=T*N/360,A=Math.floor(T),_=Math.floor(j),c=(_*a+A)*4,v=n[c+0],y=n[c+1],x=n[c+2],b=n[c+3],c=(f*a+u)*4,i[c+0]=v,i[c+1]=y,i[c+2]=x,i[c+3]=b},Dle=function(t){const e=t.width,r=t.height;let n,i,a,s,o,l,c,u,f,h,m=Math.round(this.kaleidoscopePower());const v=Math.round(this.kaleidoscopeAngle()),y=Math.floor(e*(v%360)/360);if(m<1)return;const x=RM.Util.createCanvasElement();x.width=e,x.height=r;const b=x.getContext("2d").getImageData(0,0,e,r);RM.Util.releaseCanvas(x),Ale(t,b,{polarCenterX:e/2,polarCenterY:r/2});let S=e/Math.pow(2,m);for(;S<=8;)S=S*2,m-=1;S=Math.ceil(S);let w=S,k=0,N=w,j=1;for(y+S>e&&(k=w,N=0,j=-1),i=0;i<r;i+=1)for(n=k;n!==N;n+=j)a=Math.round(n+y)%e,f=(e*i+a)*4,o=b.data[f+0],l=b.data[f+1],c=b.data[f+2],u=b.data[f+3],h=(e*i+n)*4,b.data[h+0]=o,b.data[h+1]=l,b.data[h+2]=c,b.data[h+3]=u;for(i=0;i<r;i+=1)for(w=Math.floor(S),s=0;s<m;s+=1){for(n=0;n<w+1;n+=1)f=(e*i+n)*4,o=b.data[f+0],l=b.data[f+1],c=b.data[f+2],u=b.data[f+3],h=(e*i+w*2-n-1)*4,b.data[h+0]=o,b.data[h+1]=l,b.data[h+2]=c,b.data[h+3]=u;w*=2}Rle(b,t,{polarRotation:0})};p1.Kaleidoscope=Dle;Py.Factory.addGetterSetter(nL.Node,"kaleidoscopePower",2,(0,iL.getNumberValidator)(),Py.Factory.afterSetFilter);Py.Factory.addGetterSetter(nL.Node,"kaleidoscopeAngle",0,(0,iL.getNumberValidator)(),Py.Factory.afterSetFilter);var m1={};Object.defineProperty(m1,"__esModule",{value:!0});m1.Mask=void 0;const DM=gt,Ole=dr,Ile=Ze;function pv(t,e,r){let n=(r*t.width+e)*4;const i=[];return i.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),i}function ph(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function Lle(t){const e=[0,0,0];for(let r=0;r<t.length;r++)e[0]+=t[r][0],e[1]+=t[r][1],e[2]+=t[r][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function Ble(t,e){const r=pv(t,0,0),n=pv(t,t.width-1,0),i=pv(t,0,t.height-1),a=pv(t,t.width-1,t.height-1),s=e||10;if(ph(r,n)<s&&ph(n,a)<s&&ph(a,i)<s&&ph(i,r)<s){const o=Lle([n,r,a,i]),l=[];for(let c=0;c<t.width*t.height;c++){const u=ph(o,[t.data[c*4],t.data[c*4+1],t.data[c*4+2]]);l[c]=u<s?0:255}return l}}function Fle(t,e){for(let r=0;r<t.width*t.height;r++)t.data[4*r+3]=e[r]}function zle(t,e,r){const n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const c=o*e+l;let u=0;for(let f=0;f<i;f++)for(let h=0;h<i;h++){const m=o+f-a,v=l+h-a;if(m>=0&&m<r&&v>=0&&v<e){const y=m*e+v,x=n[f*i+h];u+=t[y]*x}}s[c]=u===255*8?255:0}return s}function Vle(t,e,r){const n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const c=o*e+l;let u=0;for(let f=0;f<i;f++)for(let h=0;h<i;h++){const m=o+f-a,v=l+h-a;if(m>=0&&m<r&&v>=0&&v<e){const y=m*e+v,x=n[f*i+h];u+=t[y]*x}}s[c]=u>=255*4?255:0}return s}function $le(t,e,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(n.length)),a=Math.floor(i/2),s=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const c=o*e+l;let u=0;for(let f=0;f<i;f++)for(let h=0;h<i;h++){const m=o+f-a,v=l+h-a;if(m>=0&&m<r&&v>=0&&v<e){const y=m*e+v,x=n[f*i+h];u+=t[y]*x}}s[c]=u}return s}const Ule=function(t){let e=this.threshold(),r=Ble(t,e);return r&&(r=zle(r,t.width,t.height),r=Vle(r,t.width,t.height),r=$le(r,t.width,t.height),Fle(t,r)),t};m1.Mask=Ule;DM.Factory.addGetterSetter(Ole.Node,"threshold",0,(0,Ile.getNumberValidator)(),DM.Factory.afterSetFilter);var g1={};Object.defineProperty(g1,"__esModule",{value:!0});g1.Noise=void 0;const OM=gt,Gle=dr,Hle=Ze,Wle=function(t){const e=this.noise()*255,r=t.data,n=r.length,i=e/2;for(let a=0;a<n;a+=4)r[a+0]+=i-2*i*Math.random(),r[a+1]+=i-2*i*Math.random(),r[a+2]+=i-2*i*Math.random()};g1.Noise=Wle;OM.Factory.addGetterSetter(Gle.Node,"noise",.2,(0,Hle.getNumberValidator)(),OM.Factory.afterSetFilter);var v1={};Object.defineProperty(v1,"__esModule",{value:!0});v1.Pixelate=void 0;const IM=gt,qle=xr,Kle=dr,Yle=Ze,Xle=function(t){let e=Math.ceil(this.pixelSize()),r=t.width,n=t.height,i,a,s,o,l,c,u,f=Math.ceil(r/e),h=Math.ceil(n/e),m,v,y,x,b,S,w,k=t.data;if(e<=0){qle.Util.error("pixelSize value can not be <= 0");return}for(b=0;b<f;b+=1)for(S=0;S<h;S+=1){for(o=0,l=0,c=0,u=0,m=b*e,v=m+e,y=S*e,x=y+e,w=0,i=m;i<v;i+=1)if(!(i>=r))for(a=y;a<x;a+=1)a>=n||(s=(r*a+i)*4,o+=k[s+0],l+=k[s+1],c+=k[s+2],u+=k[s+3],w+=1);for(o=o/w,l=l/w,c=c/w,u=u/w,i=m;i<v;i+=1)if(!(i>=r))for(a=y;a<x;a+=1)a>=n||(s=(r*a+i)*4,k[s+0]=o,k[s+1]=l,k[s+2]=c,k[s+3]=u)}};v1.Pixelate=Xle;IM.Factory.addGetterSetter(Kle.Node,"pixelSize",8,(0,Yle.getNumberValidator)(),IM.Factory.afterSetFilter);var y1={};Object.defineProperty(y1,"__esModule",{value:!0});y1.Posterize=void 0;const LM=gt,Qle=dr,Jle=Ze,Zle=function(t){let e=Math.round(this.levels()*254)+1,r=t.data,n=r.length,i=255/e,a;for(a=0;a<n;a+=1)r[a]=Math.floor(r[a]/i)*i};y1.Posterize=Zle;LM.Factory.addGetterSetter(Qle.Node,"levels",.5,(0,Jle.getNumberValidator)(),LM.Factory.afterSetFilter);var x1={};Object.defineProperty(x1,"__esModule",{value:!0});x1.RGB=void 0;const _y=gt,kN=dr,ece=Ze,tce=function(t){let e=t.data,r=e.length,n=this.red(),i=this.green(),a=this.blue(),s,o;for(s=0;s<r;s+=4)o=(.34*e[s]+.5*e[s+1]+.16*e[s+2])/255,e[s]=o*n,e[s+1]=o*i,e[s+2]=o*a,e[s+3]=e[s+3]};x1.RGB=tce;_y.Factory.addGetterSetter(kN.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});_y.Factory.addGetterSetter(kN.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});_y.Factory.addGetterSetter(kN.Node,"blue",0,ece.RGBComponent,_y.Factory.afterSetFilter);var b1={};Object.defineProperty(b1,"__esModule",{value:!0});b1.RGBA=void 0;const $p=gt,w1=dr,rce=Ze,nce=function(t){const e=t.data,r=e.length,n=this.red(),i=this.green(),a=this.blue(),s=this.alpha();for(let o=0;o<r;o+=4){const l=1-s;e[o]=n*s+e[o]*l,e[o+1]=i*s+e[o+1]*l,e[o+2]=a*s+e[o+2]*l}};b1.RGBA=nce;$p.Factory.addGetterSetter(w1.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});$p.Factory.addGetterSetter(w1.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});$p.Factory.addGetterSetter(w1.Node,"blue",0,rce.RGBComponent,$p.Factory.afterSetFilter);$p.Factory.addGetterSetter(w1.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var S1={};Object.defineProperty(S1,"__esModule",{value:!0});S1.Sepia=void 0;const ice=function(t){let e=t.data,r=e.length,n,i,a,s;for(n=0;n<r;n+=4)i=e[n+0],a=e[n+1],s=e[n+2],e[n+0]=Math.min(255,i*.393+a*.769+s*.189),e[n+1]=Math.min(255,i*.349+a*.686+s*.168),e[n+2]=Math.min(255,i*.272+a*.534+s*.131)};S1.Sepia=ice;var k1={};Object.defineProperty(k1,"__esModule",{value:!0});k1.Solarize=void 0;const ace=function(t){const e=t.data,r=t.width,n=t.height,i=r*4;let a=n;do{const s=(a-1)*i;let o=r;do{const l=s+(o-1)*4;let c=e[l],u=e[l+1],f=e[l+2];c>127&&(c=255-c),u>127&&(u=255-u),f>127&&(f=255-f),e[l]=c,e[l+1]=u,e[l+2]=f}while(--o)}while(--a)};k1.Solarize=ace;var C1={};Object.defineProperty(C1,"__esModule",{value:!0});C1.Threshold=void 0;const BM=gt,sce=dr,oce=Ze,lce=function(t){const e=this.threshold()*255,r=t.data,n=r.length;for(let i=0;i<n;i+=1)r[i]=r[i]<e?0:255};C1.Threshold=lce;BM.Factory.addGetterSetter(sce.Node,"threshold",.5,(0,oce.getNumberValidator)(),BM.Factory.afterSetFilter);Object.defineProperty(Rx,"__esModule",{value:!0});Rx.Konva=void 0;const FM=Ty,cce=Fx,uce=$x,dce=Hx,fce=Wx,hce=qx,zM=Kd,pce=xm,mce=pf,gce=wm,vce=Xx,yce=Qx,xce=Jx,bce=Zx,wce=gf,Sce=e1,kce=t1,Cce=r1,Nce=i1,Ece=a1,Tce=s1,jce=o1,Mce=c1,Pce=u1,_ce=d1,Ace=f1,Rce=h1,Dce=p1,Oce=m1,Ice=g1,Lce=v1,Bce=y1,Fce=x1,zce=b1,Vce=S1,$ce=k1,Uce=C1;Rx.Konva=FM.Konva.Util._assign(FM.Konva,{Arc:cce.Arc,Arrow:uce.Arrow,Circle:dce.Circle,Ellipse:fce.Ellipse,Image:hce.Image,Label:zM.Label,Tag:zM.Tag,Line:pce.Line,Path:mce.Path,Rect:gce.Rect,RegularPolygon:vce.RegularPolygon,Ring:yce.Ring,Sprite:xce.Sprite,Star:bce.Star,Text:wce.Text,TextPath:Sce.TextPath,Transformer:kce.Transformer,Wedge:Cce.Wedge,Filters:{Blur:Nce.Blur,Brighten:Ece.Brighten,Contrast:Tce.Contrast,Emboss:jce.Emboss,Enhance:Mce.Enhance,Grayscale:Pce.Grayscale,HSL:_ce.HSL,HSV:Ace.HSV,Invert:Rce.Invert,Kaleidoscope:Dce.Kaleidoscope,Mask:Oce.Mask,Noise:Ice.Noise,Pixelate:Lce.Pixelate,Posterize:Bce.Posterize,RGB:Fce.RGB,RGBA:zce.RGBA,Sepia:Vce.Sepia,Solarize:$ce.Solarize,Threshold:Uce.Threshold}});var Gce=kI.exports;Object.defineProperty(Gce,"__esModule",{value:!0});const Hce=Rx;kI.exports=Hce.Konva;var Yk={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var r=Ty;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=Ty;t.exports=n.Konva})(Yk,Yk.exports);var Wce=Yk.exports;const Up=Gp(Wce);var aL={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qce=function(e){var r={},n=q,i=Th,a=Object.assign;function s(p){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+p,C=1;C<arguments.length;C++)g+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),v=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),b=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),k=Symbol.for("react.offscreen"),N=Symbol.iterator;function j(p){return p===null||typeof p!="object"?null:(p=N&&p[N]||p["@@iterator"],typeof p=="function"?p:null)}function T(p){if(p==null)return null;if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case u:return"Fragment";case c:return"Portal";case h:return"Profiler";case f:return"StrictMode";case x:return"Suspense";case b:return"SuspenseList"}if(typeof p=="object")switch(p.$$typeof){case v:return(p.displayName||"Context")+".Consumer";case m:return(p._context.displayName||"Context")+".Provider";case y:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case S:return g=p.displayName||null,g!==null?g:T(p.type)||"Memo";case w:g=p._payload,p=p._init;try{return T(p(g))}catch{}}return null}function M(p){var g=p.type;switch(p.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return p=g.render,p=p.displayName||p.name||"",g.displayName||(p!==""?"ForwardRef("+p+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return T(g);case 8:return g===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function A(p){var g=p,C=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,g.flags&4098&&(C=g.return),p=g.return;while(p)}return g.tag===3?C:null}function _(p){if(A(p)!==p)throw Error(s(188))}function D(p){var g=p.alternate;if(!g){if(g=A(p),g===null)throw Error(s(188));return g!==p?null:p}for(var C=p,E=g;;){var P=C.return;if(P===null)break;var O=P.alternate;if(O===null){if(E=P.return,E!==null){C=E;continue}break}if(P.child===O.child){for(O=P.child;O;){if(O===C)return _(P),p;if(O===E)return _(P),g;O=O.sibling}throw Error(s(188))}if(C.return!==E.return)C=P,E=O;else{for(var X=!1,oe=P.child;oe;){if(oe===C){X=!0,C=P,E=O;break}if(oe===E){X=!0,E=P,C=O;break}oe=oe.sibling}if(!X){for(oe=O.child;oe;){if(oe===C){X=!0,C=O,E=P;break}if(oe===E){X=!0,E=O,C=P;break}oe=oe.sibling}if(!X)throw Error(s(189))}}if(C.alternate!==E)throw Error(s(190))}if(C.tag!==3)throw Error(s(188));return C.stateNode.current===C?p:g}function R(p){return p=D(p),p!==null?I(p):null}function I(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){var g=I(p);if(g!==null)return g;p=p.sibling}return null}function $(p){if(p.tag===5||p.tag===6)return p;for(p=p.child;p!==null;){if(p.tag!==4){var g=$(p);if(g!==null)return g}p=p.sibling}return null}var B=Array.isArray,z=e.getPublicInstance,U=e.getRootHostContext,F=e.getChildHostContext,Q=e.prepareForCommit,K=e.resetAfterCommit,L=e.createInstance,G=e.appendInitialChild,ee=e.finalizeInitialChildren,re=e.prepareUpdate,se=e.shouldSetTextContent,de=e.createTextInstance,W=e.scheduleTimeout,ne=e.cancelTimeout,ie=e.noTimeout,V=e.isPrimaryRenderer,Y=e.supportsMutation,te=e.supportsPersistence,Z=e.supportsHydration,ue=e.getInstanceFromNode,ge=e.preparePortalMount,Ue=e.getCurrentEventPriority,Pe=e.detachDeletedInstance,ze=e.supportsMicrotasks,Ge=e.scheduleMicrotask,Ce=e.supportsTestSelectors,Re=e.findFiberRoot,Ve=e.getBoundingRect,We=e.getTextContent,Oe=e.isHiddenSubtree,rt=e.matchAccessibilityRole,ct=e.setFocusIfFocusable,xt=e.setupIntersectionObserver,bt=e.appendChild,Et=e.appendChildToContainer,Je=e.commitTextUpdate,De=e.commitMount,ve=e.commitUpdate,H=e.insertBefore,J=e.insertInContainerBefore,ae=e.removeChild,le=e.removeChildFromContainer,fe=e.resetTextContent,xe=e.hideInstance,ye=e.hideTextInstance,Te=e.unhideInstance,je=e.unhideTextInstance,He=e.clearContainer,et=e.cloneInstance,tt=e.createContainerChildSet,Ie=e.appendChildToContainerChildSet,nt=e.finalizeContainerChildren,st=e.replaceContainerChildren,Kt=e.cloneHiddenInstance,Ot=e.cloneHiddenTextInstance,yn=e.canHydrateInstance,br=e.canHydrateTextInstance,Ir=e.canHydrateSuspenseInstance,wr=e.isSuspenseInstancePending,Pr=e.isSuspenseInstanceFallback,Fa=e.getSuspenseInstanceFallbackErrorDetails,Sr=e.registerSuspenseInstanceRetry,si=e.getNextHydratableSibling,pa=e.getFirstHydratableChild,ho=e.getFirstHydratableChildWithinContainer,hu=e.getFirstHydratableChildWithinSuspenseInstance,bs=e.hydrateInstance,An=e.hydrateTextInstance,nn=e.hydrateSuspenseInstance,Rn=e.getNextHydratableInstanceAfterSuspenseInstance,Hl=e.commitHydratedContainer,oi=e.commitHydratedSuspenseInstance,Sm=e.clearSuspenseBoundary,E1=e.clearSuspenseBoundaryFromContainer,T1=e.shouldDeleteUnhydratedTailInstances,j1=e.didNotMatchHydratedContainerTextInstance,M1=e.didNotMatchHydratedTextInstance,vf;function Wl(p){if(vf===void 0)try{throw Error()}catch(C){var g=C.stack.trim().match(/\n( *(at )?)/);vf=g&&g[1]||""}return`
`+vf+p}var yf=!1;function ws(p,g){if(!p||yf)return"";yf=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(ke){var E=ke}Reflect.construct(p,[],g)}else{try{g.call()}catch(ke){E=ke}p.call(g.prototype)}else{try{throw Error()}catch(ke){E=ke}p()}}catch(ke){if(ke&&E&&typeof ke.stack=="string"){for(var P=ke.stack.split(`
`),O=E.stack.split(`
`),X=P.length-1,oe=O.length-1;1<=X&&0<=oe&&P[X]!==O[oe];)oe--;for(;1<=X&&0<=oe;X--,oe--)if(P[X]!==O[oe]){if(X!==1||oe!==1)do if(X--,oe--,0>oe||P[X]!==O[oe]){var pe=`
`+P[X].replace(" at new "," at ");return p.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",p.displayName)),pe}while(1<=X&&0<=oe);break}}}finally{yf=!1,Error.prepareStackTrace=C}return(p=p?p.displayName||p.name:"")?Wl(p):""}var xf=Object.prototype.hasOwnProperty,po=[],Ss=-1;function ma(p){return{current:p}}function $t(p){0>Ss||(p.current=po[Ss],po[Ss]=null,Ss--)}function vt(p,g){Ss++,po[Ss]=p.current,p.current=g}var Fi={},Gr=ma(Fi),Lr=ma(!1),Hr=Fi;function mo(p,g){var C=p.type.contextTypes;if(!C)return Fi;var E=p.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===g)return E.__reactInternalMemoizedMaskedChildContext;var P={},O;for(O in C)P[O]=g[O];return E&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=g,p.__reactInternalMemoizedMaskedChildContext=P),P}function Yn(p){return p=p.childContextTypes,p!=null}function pu(){$t(Lr),$t(Gr)}function TN(p,g,C){if(Gr.current!==Fi)throw Error(s(168));vt(Gr,g),vt(Lr,C)}function jN(p,g,C){var E=p.stateNode;if(g=g.childContextTypes,typeof E.getChildContext!="function")return C;E=E.getChildContext();for(var P in E)if(!(P in g))throw Error(s(108,M(p)||"Unknown",P));return a({},C,E)}function km(p){return p=(p=p.stateNode)&&p.__reactInternalMemoizedMergedChildContext||Fi,Hr=Gr.current,vt(Gr,p),vt(Lr,Lr.current),!0}function MN(p,g,C){var E=p.stateNode;if(!E)throw Error(s(169));C?(p=jN(p,g,Hr),E.__reactInternalMemoizedMergedChildContext=p,$t(Lr),$t(Gr),vt(Gr,p)):$t(Lr),vt(Lr,C)}var ga=Math.clz32?Math.clz32:mL,hL=Math.log,pL=Math.LN2;function mL(p){return p>>>=0,p===0?32:31-(hL(p)/pL|0)|0}var Cm=64,Nm=4194304;function bf(p){switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return p&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return p}}function Em(p,g){var C=p.pendingLanes;if(C===0)return 0;var E=0,P=p.suspendedLanes,O=p.pingedLanes,X=C&268435455;if(X!==0){var oe=X&~P;oe!==0?E=bf(oe):(O&=X,O!==0&&(E=bf(O)))}else X=C&~P,X!==0?E=bf(X):O!==0&&(E=bf(O));if(E===0)return 0;if(g!==0&&g!==E&&!(g&P)&&(P=E&-E,O=g&-g,P>=O||P===16&&(O&4194240)!==0))return g;if(E&4&&(E|=C&16),g=p.entangledLanes,g!==0)for(p=p.entanglements,g&=E;0<g;)C=31-ga(g),P=1<<C,E|=p[C],g&=~P;return E}function gL(p,g){switch(p){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vL(p,g){for(var C=p.suspendedLanes,E=p.pingedLanes,P=p.expirationTimes,O=p.pendingLanes;0<O;){var X=31-ga(O),oe=1<<X,pe=P[X];pe===-1?(!(oe&C)||oe&E)&&(P[X]=gL(oe,g)):pe<=g&&(p.expiredLanes|=oe),O&=~oe}}function P1(p){return p=p.pendingLanes&-1073741825,p!==0?p:p&1073741824?1073741824:0}function PN(){var p=Cm;return Cm<<=1,!(Cm&4194240)&&(Cm=64),p}function _1(p){for(var g=[],C=0;31>C;C++)g.push(p);return g}function wf(p,g,C){p.pendingLanes|=g,g!==536870912&&(p.suspendedLanes=0,p.pingedLanes=0),p=p.eventTimes,g=31-ga(g),p[g]=C}function yL(p,g){var C=p.pendingLanes&~g;p.pendingLanes=g,p.suspendedLanes=0,p.pingedLanes=0,p.expiredLanes&=g,p.mutableReadLanes&=g,p.entangledLanes&=g,g=p.entanglements;var E=p.eventTimes;for(p=p.expirationTimes;0<C;){var P=31-ga(C),O=1<<P;g[P]=0,E[P]=-1,p[P]=-1,C&=~O}}function A1(p,g){var C=p.entangledLanes|=g;for(p=p.entanglements;C;){var E=31-ga(C),P=1<<E;P&g|p[E]&g&&(p[E]|=g),C&=~P}}var Pt=0;function _N(p){return p&=-p,1<p?4<p?p&268435455?16:536870912:4:1}var R1=i.unstable_scheduleCallback,AN=i.unstable_cancelCallback,xL=i.unstable_shouldYield,bL=i.unstable_requestPaint,an=i.unstable_now,D1=i.unstable_ImmediatePriority,wL=i.unstable_UserBlockingPriority,O1=i.unstable_NormalPriority,SL=i.unstable_IdlePriority,Tm=null,za=null;function kL(p){if(za&&typeof za.onCommitFiberRoot=="function")try{za.onCommitFiberRoot(Tm,p,void 0,(p.current.flags&128)===128)}catch{}}function CL(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var va=typeof Object.is=="function"?Object.is:CL,ks=null,jm=!1,I1=!1;function RN(p){ks===null?ks=[p]:ks.push(p)}function NL(p){jm=!0,RN(p)}function Va(){if(!I1&&ks!==null){I1=!0;var p=0,g=Pt;try{var C=ks;for(Pt=1;p<C.length;p++){var E=C[p];do E=E(!0);while(E!==null)}ks=null,jm=!1}catch(P){throw ks!==null&&(ks=ks.slice(p+1)),R1(D1,Va),P}finally{Pt=g,I1=!1}}return null}var mu=[],gu=0,Mm=null,Pm=0,zi=[],Vi=0,ql=null,Cs=1,Ns="";function Kl(p,g){mu[gu++]=Pm,mu[gu++]=Mm,Mm=p,Pm=g}function DN(p,g,C){zi[Vi++]=Cs,zi[Vi++]=Ns,zi[Vi++]=ql,ql=p;var E=Cs;p=Ns;var P=32-ga(E)-1;E&=~(1<<P),C+=1;var O=32-ga(g)+P;if(30<O){var X=P-P%5;O=(E&(1<<X)-1).toString(32),E>>=X,P-=X,Cs=1<<32-ga(g)+P|C<<P|E,Ns=O+p}else Cs=1<<O|C<<P|E,Ns=p}function L1(p){p.return!==null&&(Kl(p,1),DN(p,1,0))}function B1(p){for(;p===Mm;)Mm=mu[--gu],mu[gu]=null,Pm=mu[--gu],mu[gu]=null;for(;p===ql;)ql=zi[--Vi],zi[Vi]=null,Ns=zi[--Vi],zi[Vi]=null,Cs=zi[--Vi],zi[Vi]=null}var Ni=null,$i=null,ir=!1,Sf=!1,ya=null;function ON(p,g){var C=qi(5,null,null,0);C.elementType="DELETED",C.stateNode=g,C.return=p,g=p.deletions,g===null?(p.deletions=[C],p.flags|=16):g.push(C)}function IN(p,g){switch(p.tag){case 5:return g=yn(g,p.type,p.pendingProps),g!==null?(p.stateNode=g,Ni=p,$i=pa(g),!0):!1;case 6:return g=br(g,p.pendingProps),g!==null?(p.stateNode=g,Ni=p,$i=null,!0):!1;case 13:if(g=Ir(g),g!==null){var C=ql!==null?{id:Cs,overflow:Ns}:null;return p.memoizedState={dehydrated:g,treeContext:C,retryLane:1073741824},C=qi(18,null,null,0),C.stateNode=g,C.return=p,p.child=C,Ni=p,$i=null,!0}return!1;default:return!1}}function F1(p){return(p.mode&1)!==0&&(p.flags&128)===0}function z1(p){if(ir){var g=$i;if(g){var C=g;if(!IN(p,g)){if(F1(p))throw Error(s(418));g=si(C);var E=Ni;g&&IN(p,g)?ON(E,C):(p.flags=p.flags&-4097|2,ir=!1,Ni=p)}}else{if(F1(p))throw Error(s(418));p.flags=p.flags&-4097|2,ir=!1,Ni=p}}}function LN(p){for(p=p.return;p!==null&&p.tag!==5&&p.tag!==3&&p.tag!==13;)p=p.return;Ni=p}function _m(p){if(!Z||p!==Ni)return!1;if(!ir)return LN(p),ir=!0,!1;if(p.tag!==3&&(p.tag!==5||T1(p.type)&&!se(p.type,p.memoizedProps))){var g=$i;if(g){if(F1(p))throw BN(),Error(s(418));for(;g;)ON(p,g),g=si(g)}}if(LN(p),p.tag===13){if(!Z)throw Error(s(316));if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(s(317));$i=Rn(p)}else $i=Ni?si(p.stateNode):null;return!0}function BN(){for(var p=$i;p;)p=si(p)}function vu(){Z&&($i=Ni=null,Sf=ir=!1)}function V1(p){ya===null?ya=[p]:ya.push(p)}var EL=o.ReactCurrentBatchConfig;function Am(p,g){if(va(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var C=Object.keys(p),E=Object.keys(g);if(C.length!==E.length)return!1;for(E=0;E<C.length;E++){var P=C[E];if(!xf.call(g,P)||!va(p[P],g[P]))return!1}return!0}function TL(p){switch(p.tag){case 5:return Wl(p.type);case 16:return Wl("Lazy");case 13:return Wl("Suspense");case 19:return Wl("SuspenseList");case 0:case 2:case 15:return p=ws(p.type,!1),p;case 11:return p=ws(p.type.render,!1),p;case 1:return p=ws(p.type,!0),p;default:return""}}function kf(p,g,C){if(p=C.ref,p!==null&&typeof p!="function"&&typeof p!="object"){if(C._owner){if(C=C._owner,C){if(C.tag!==1)throw Error(s(309));var E=C.stateNode}if(!E)throw Error(s(147,p));var P=E,O=""+p;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===O?g.ref:(g=function(X){var oe=P.refs;X===null?delete oe[O]:oe[O]=X},g._stringRef=O,g)}if(typeof p!="string")throw Error(s(284));if(!C._owner)throw Error(s(290,p))}return p}function Rm(p,g){throw p=Object.prototype.toString.call(g),Error(s(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p))}function FN(p){var g=p._init;return g(p._payload)}function zN(p){function g(he,ce){if(p){var me=he.deletions;me===null?(he.deletions=[ce],he.flags|=16):me.push(ce)}}function C(he,ce){if(!p)return null;for(;ce!==null;)g(he,ce),ce=ce.sibling;return null}function E(he,ce){for(he=new Map;ce!==null;)ce.key!==null?he.set(ce.key,ce):he.set(ce.index,ce),ce=ce.sibling;return he}function P(he,ce){return he=So(he,ce),he.index=0,he.sibling=null,he}function O(he,ce,me){return he.index=me,p?(me=he.alternate,me!==null?(me=me.index,me<ce?(he.flags|=2,ce):me):(he.flags|=2,ce)):(he.flags|=1048576,ce)}function X(he){return p&&he.alternate===null&&(he.flags|=2),he}function oe(he,ce,me,_e){return ce===null||ce.tag!==6?(ce=Ib(me,he.mode,_e),ce.return=he,ce):(ce=P(ce,me),ce.return=he,ce)}function pe(he,ce,me,_e){var Xe=me.type;return Xe===u?$e(he,ce,me.props.children,_e,me.key):ce!==null&&(ce.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===w&&FN(Xe)===ce.type)?(_e=P(ce,me.props),_e.ref=kf(he,ce,me),_e.return=he,_e):(_e=ug(me.type,me.key,me.props,null,he.mode,_e),_e.ref=kf(he,ce,me),_e.return=he,_e)}function ke(he,ce,me,_e){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==me.containerInfo||ce.stateNode.implementation!==me.implementation?(ce=Lb(me,he.mode,_e),ce.return=he,ce):(ce=P(ce,me.children||[]),ce.return=he,ce)}function $e(he,ce,me,_e,Xe){return ce===null||ce.tag!==7?(ce=tc(me,he.mode,_e,Xe),ce.return=he,ce):(ce=P(ce,me),ce.return=he,ce)}function ot(he,ce,me){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return ce=Ib(""+ce,he.mode,me),ce.return=he,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case l:return me=ug(ce.type,ce.key,ce.props,null,he.mode,me),me.ref=kf(he,null,ce),me.return=he,me;case c:return ce=Lb(ce,he.mode,me),ce.return=he,ce;case w:var _e=ce._init;return ot(he,_e(ce._payload),me)}if(B(ce)||j(ce))return ce=tc(ce,he.mode,me,null),ce.return=he,ce;Rm(he,ce)}return null}function Me(he,ce,me,_e){var Xe=ce!==null?ce.key:null;if(typeof me=="string"&&me!==""||typeof me=="number")return Xe!==null?null:oe(he,ce,""+me,_e);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case l:return me.key===Xe?pe(he,ce,me,_e):null;case c:return me.key===Xe?ke(he,ce,me,_e):null;case w:return Xe=me._init,Me(he,ce,Xe(me._payload),_e)}if(B(me)||j(me))return Xe!==null?null:$e(he,ce,me,_e,null);Rm(he,me)}return null}function Jt(he,ce,me,_e,Xe){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return he=he.get(me)||null,oe(ce,he,""+_e,Xe);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case l:return he=he.get(_e.key===null?me:_e.key)||null,pe(ce,he,_e,Xe);case c:return he=he.get(_e.key===null?me:_e.key)||null,ke(ce,he,_e,Xe);case w:var dt=_e._init;return Jt(he,ce,me,dt(_e._payload),Xe)}if(B(_e)||j(_e))return he=he.get(me)||null,$e(ce,he,_e,Xe,null);Rm(ce,_e)}return null}function Ut(he,ce,me,_e){for(var Xe=null,dt=null,lt=ce,_t=ce=0,ln=null;lt!==null&&_t<me.length;_t++){lt.index>_t?(ln=lt,lt=null):ln=lt.sibling;var At=Me(he,lt,me[_t],_e);if(At===null){lt===null&&(lt=ln);break}p&&lt&&At.alternate===null&&g(he,lt),ce=O(At,ce,_t),dt===null?Xe=At:dt.sibling=At,dt=At,lt=ln}if(_t===me.length)return C(he,lt),ir&&Kl(he,_t),Xe;if(lt===null){for(;_t<me.length;_t++)lt=ot(he,me[_t],_e),lt!==null&&(ce=O(lt,ce,_t),dt===null?Xe=lt:dt.sibling=lt,dt=lt);return ir&&Kl(he,_t),Xe}for(lt=E(he,lt);_t<me.length;_t++)ln=Jt(lt,he,_t,me[_t],_e),ln!==null&&(p&&ln.alternate!==null&&lt.delete(ln.key===null?_t:ln.key),ce=O(ln,ce,_t),dt===null?Xe=ln:dt.sibling=ln,dt=ln);return p&&lt.forEach(function(ko){return g(he,ko)}),ir&&Kl(he,_t),Xe}function di(he,ce,me,_e){var Xe=j(me);if(typeof Xe!="function")throw Error(s(150));if(me=Xe.call(me),me==null)throw Error(s(151));for(var dt=Xe=null,lt=ce,_t=ce=0,ln=null,At=me.next();lt!==null&&!At.done;_t++,At=me.next()){lt.index>_t?(ln=lt,lt=null):ln=lt.sibling;var ko=Me(he,lt,At.value,_e);if(ko===null){lt===null&&(lt=ln);break}p&&lt&&ko.alternate===null&&g(he,lt),ce=O(ko,ce,_t),dt===null?Xe=ko:dt.sibling=ko,dt=ko,lt=ln}if(At.done)return C(he,lt),ir&&Kl(he,_t),Xe;if(lt===null){for(;!At.done;_t++,At=me.next())At=ot(he,At.value,_e),At!==null&&(ce=O(At,ce,_t),dt===null?Xe=At:dt.sibling=At,dt=At);return ir&&Kl(he,_t),Xe}for(lt=E(he,lt);!At.done;_t++,At=me.next())At=Jt(lt,he,_t,At.value,_e),At!==null&&(p&&At.alternate!==null&&lt.delete(At.key===null?_t:At.key),ce=O(At,ce,_t),dt===null?Xe=At:dt.sibling=At,dt=At);return p&&lt.forEach(function(nB){return g(he,nB)}),ir&&Kl(he,_t),Xe}function Ms(he,ce,me,_e){if(typeof me=="object"&&me!==null&&me.type===u&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case l:e:{for(var Xe=me.key,dt=ce;dt!==null;){if(dt.key===Xe){if(Xe=me.type,Xe===u){if(dt.tag===7){C(he,dt.sibling),ce=P(dt,me.props.children),ce.return=he,he=ce;break e}}else if(dt.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===w&&FN(Xe)===dt.type){C(he,dt.sibling),ce=P(dt,me.props),ce.ref=kf(he,dt,me),ce.return=he,he=ce;break e}C(he,dt);break}else g(he,dt);dt=dt.sibling}me.type===u?(ce=tc(me.props.children,he.mode,_e,me.key),ce.return=he,he=ce):(_e=ug(me.type,me.key,me.props,null,he.mode,_e),_e.ref=kf(he,ce,me),_e.return=he,he=_e)}return X(he);case c:e:{for(dt=me.key;ce!==null;){if(ce.key===dt)if(ce.tag===4&&ce.stateNode.containerInfo===me.containerInfo&&ce.stateNode.implementation===me.implementation){C(he,ce.sibling),ce=P(ce,me.children||[]),ce.return=he,he=ce;break e}else{C(he,ce);break}else g(he,ce);ce=ce.sibling}ce=Lb(me,he.mode,_e),ce.return=he,he=ce}return X(he);case w:return dt=me._init,Ms(he,ce,dt(me._payload),_e)}if(B(me))return Ut(he,ce,me,_e);if(j(me))return di(he,ce,me,_e);Rm(he,me)}return typeof me=="string"&&me!==""||typeof me=="number"?(me=""+me,ce!==null&&ce.tag===6?(C(he,ce.sibling),ce=P(ce,me),ce.return=he,he=ce):(C(he,ce),ce=Ib(me,he.mode,_e),ce.return=he,he=ce),X(he)):C(he,ce)}return Ms}var yu=zN(!0),VN=zN(!1),Dm=ma(null),Om=null,xu=null,$1=null;function U1(){$1=xu=Om=null}function $N(p,g,C){V?(vt(Dm,g._currentValue),g._currentValue=C):(vt(Dm,g._currentValue2),g._currentValue2=C)}function G1(p){var g=Dm.current;$t(Dm),V?p._currentValue=g:p._currentValue2=g}function H1(p,g,C){for(;p!==null;){var E=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,E!==null&&(E.childLanes|=g)):E!==null&&(E.childLanes&g)!==g&&(E.childLanes|=g),p===C)break;p=p.return}}function bu(p,g){Om=p,$1=xu=null,p=p.dependencies,p!==null&&p.firstContext!==null&&(p.lanes&g&&(li=!0),p.firstContext=null)}function Ui(p){var g=V?p._currentValue:p._currentValue2;if($1!==p)if(p={context:p,memoizedValue:g,next:null},xu===null){if(Om===null)throw Error(s(308));xu=p,Om.dependencies={lanes:0,firstContext:p}}else xu=xu.next=p;return g}var Yl=null;function W1(p){Yl===null?Yl=[p]:Yl.push(p)}function UN(p,g,C,E){var P=g.interleaved;return P===null?(C.next=C,W1(g)):(C.next=P.next,P.next=C),g.interleaved=C,$a(p,E)}function $a(p,g){p.lanes|=g;var C=p.alternate;for(C!==null&&(C.lanes|=g),C=p,p=p.return;p!==null;)p.childLanes|=g,C=p.alternate,C!==null&&(C.childLanes|=g),C=p,p=p.return;return C.tag===3?C.stateNode:null}var go=!1;function q1(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function GN(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,effects:p.effects})}function Es(p,g){return{eventTime:p,lane:g,tag:0,payload:null,callback:null,next:null}}function vo(p,g,C){var E=p.updateQueue;if(E===null)return null;if(E=E.shared,yt&2){var P=E.pending;return P===null?g.next=g:(g.next=P.next,P.next=g),E.pending=g,$a(p,C)}return P=E.interleaved,P===null?(g.next=g,W1(E)):(g.next=P.next,P.next=g),E.interleaved=g,$a(p,C)}function Im(p,g,C){if(g=g.updateQueue,g!==null&&(g=g.shared,(C&4194240)!==0)){var E=g.lanes;E&=p.pendingLanes,C|=E,g.lanes=C,A1(p,C)}}function HN(p,g){var C=p.updateQueue,E=p.alternate;if(E!==null&&(E=E.updateQueue,C===E)){var P=null,O=null;if(C=C.firstBaseUpdate,C!==null){do{var X={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};O===null?P=O=X:O=O.next=X,C=C.next}while(C!==null);O===null?P=O=g:O=O.next=g}else P=O=g;C={baseState:E.baseState,firstBaseUpdate:P,lastBaseUpdate:O,shared:E.shared,effects:E.effects},p.updateQueue=C;return}p=C.lastBaseUpdate,p===null?C.firstBaseUpdate=g:p.next=g,C.lastBaseUpdate=g}function Lm(p,g,C,E){var P=p.updateQueue;go=!1;var O=P.firstBaseUpdate,X=P.lastBaseUpdate,oe=P.shared.pending;if(oe!==null){P.shared.pending=null;var pe=oe,ke=pe.next;pe.next=null,X===null?O=ke:X.next=ke,X=pe;var $e=p.alternate;$e!==null&&($e=$e.updateQueue,oe=$e.lastBaseUpdate,oe!==X&&(oe===null?$e.firstBaseUpdate=ke:oe.next=ke,$e.lastBaseUpdate=pe))}if(O!==null){var ot=P.baseState;X=0,$e=ke=pe=null,oe=O;do{var Me=oe.lane,Jt=oe.eventTime;if((E&Me)===Me){$e!==null&&($e=$e.next={eventTime:Jt,lane:0,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null});e:{var Ut=p,di=oe;switch(Me=g,Jt=C,di.tag){case 1:if(Ut=di.payload,typeof Ut=="function"){ot=Ut.call(Jt,ot,Me);break e}ot=Ut;break e;case 3:Ut.flags=Ut.flags&-65537|128;case 0:if(Ut=di.payload,Me=typeof Ut=="function"?Ut.call(Jt,ot,Me):Ut,Me==null)break e;ot=a({},ot,Me);break e;case 2:go=!0}}oe.callback!==null&&oe.lane!==0&&(p.flags|=64,Me=P.effects,Me===null?P.effects=[oe]:Me.push(oe))}else Jt={eventTime:Jt,lane:Me,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null},$e===null?(ke=$e=Jt,pe=ot):$e=$e.next=Jt,X|=Me;if(oe=oe.next,oe===null){if(oe=P.shared.pending,oe===null)break;Me=oe,oe=Me.next,Me.next=null,P.lastBaseUpdate=Me,P.shared.pending=null}}while(1);if($e===null&&(pe=ot),P.baseState=pe,P.firstBaseUpdate=ke,P.lastBaseUpdate=$e,g=P.shared.interleaved,g!==null){P=g;do X|=P.lane,P=P.next;while(P!==g)}else O===null&&(P.shared.lanes=0);Ql|=X,p.lanes=X,p.memoizedState=ot}}function WN(p,g,C){if(p=g.effects,g.effects=null,p!==null)for(g=0;g<p.length;g++){var E=p[g],P=E.callback;if(P!==null){if(E.callback=null,E=C,typeof P!="function")throw Error(s(191,P));P.call(E)}}}var Cf={},Gi=ma(Cf),Nf=ma(Cf),wu=ma(Cf);function Ua(p){if(p===Cf)throw Error(s(174));return p}function K1(p,g){vt(wu,g),vt(Nf,p),vt(Gi,Cf),p=U(g),$t(Gi),vt(Gi,p)}function Su(){$t(Gi),$t(Nf),$t(wu)}function qN(p){var g=Ua(wu.current),C=Ua(Gi.current);g=F(C,p.type,g),C!==g&&(vt(Nf,p),vt(Gi,g))}function Y1(p){Nf.current===p&&($t(Gi),$t(Nf))}var fr=ma(0);function Bm(p){for(var g=p;g!==null;){if(g.tag===13){var C=g.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||wr(C)||Pr(C)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var X1=[];function Q1(){for(var p=0;p<X1.length;p++){var g=X1[p];V?g._workInProgressVersionPrimary=null:g._workInProgressVersionSecondary=null}X1.length=0}var Fm=o.ReactCurrentDispatcher,J1=o.ReactCurrentBatchConfig,Xl=0,hr=null,Wr=null,sn=null,zm=!1,Ef=!1,Tf=0,jL=0;function Dn(){throw Error(s(321))}function Z1(p,g){if(g===null)return!1;for(var C=0;C<g.length&&C<p.length;C++)if(!va(p[C],g[C]))return!1;return!0}function eb(p,g,C,E,P,O){if(Xl=O,hr=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Fm.current=p===null||p.memoizedState===null?AL:RL,p=C(E,P),Ef){O=0;do{if(Ef=!1,Tf=0,25<=O)throw Error(s(301));O+=1,sn=Wr=null,g.updateQueue=null,Fm.current=DL,p=C(E,P)}while(Ef)}if(Fm.current=Um,g=Wr!==null&&Wr.next!==null,Xl=0,sn=Wr=hr=null,zm=!1,g)throw Error(s(300));return p}function tb(){var p=Tf!==0;return Tf=0,p}function Ga(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?hr.memoizedState=sn=p:sn=sn.next=p,sn}function Hi(){if(Wr===null){var p=hr.alternate;p=p!==null?p.memoizedState:null}else p=Wr.next;var g=sn===null?hr.memoizedState:sn.next;if(g!==null)sn=g,Wr=p;else{if(p===null)throw Error(s(310));Wr=p,p={memoizedState:Wr.memoizedState,baseState:Wr.baseState,baseQueue:Wr.baseQueue,queue:Wr.queue,next:null},sn===null?hr.memoizedState=sn=p:sn=sn.next=p}return sn}function jf(p,g){return typeof g=="function"?g(p):g}function rb(p){var g=Hi(),C=g.queue;if(C===null)throw Error(s(311));C.lastRenderedReducer=p;var E=Wr,P=E.baseQueue,O=C.pending;if(O!==null){if(P!==null){var X=P.next;P.next=O.next,O.next=X}E.baseQueue=P=O,C.pending=null}if(P!==null){O=P.next,E=E.baseState;var oe=X=null,pe=null,ke=O;do{var $e=ke.lane;if((Xl&$e)===$e)pe!==null&&(pe=pe.next={lane:0,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),E=ke.hasEagerState?ke.eagerState:p(E,ke.action);else{var ot={lane:$e,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null};pe===null?(oe=pe=ot,X=E):pe=pe.next=ot,hr.lanes|=$e,Ql|=$e}ke=ke.next}while(ke!==null&&ke!==O);pe===null?X=E:pe.next=oe,va(E,g.memoizedState)||(li=!0),g.memoizedState=E,g.baseState=X,g.baseQueue=pe,C.lastRenderedState=E}if(p=C.interleaved,p!==null){P=p;do O=P.lane,hr.lanes|=O,Ql|=O,P=P.next;while(P!==p)}else P===null&&(C.lanes=0);return[g.memoizedState,C.dispatch]}function nb(p){var g=Hi(),C=g.queue;if(C===null)throw Error(s(311));C.lastRenderedReducer=p;var E=C.dispatch,P=C.pending,O=g.memoizedState;if(P!==null){C.pending=null;var X=P=P.next;do O=p(O,X.action),X=X.next;while(X!==P);va(O,g.memoizedState)||(li=!0),g.memoizedState=O,g.baseQueue===null&&(g.baseState=O),C.lastRenderedState=O}return[O,E]}function KN(){}function YN(p,g){var C=hr,E=Hi(),P=g(),O=!va(E.memoizedState,P);if(O&&(E.memoizedState=P,li=!0),E=E.queue,ib(JN.bind(null,C,E,p),[p]),E.getSnapshot!==g||O||sn!==null&&sn.memoizedState.tag&1){if(C.flags|=2048,Mf(9,QN.bind(null,C,E,P,g),void 0,null),on===null)throw Error(s(349));Xl&30||XN(C,g,P)}return P}function XN(p,g,C){p.flags|=16384,p={getSnapshot:g,value:C},g=hr.updateQueue,g===null?(g={lastEffect:null,stores:null},hr.updateQueue=g,g.stores=[p]):(C=g.stores,C===null?g.stores=[p]:C.push(p))}function QN(p,g,C,E){g.value=C,g.getSnapshot=E,ZN(g)&&e4(p)}function JN(p,g,C){return C(function(){ZN(g)&&e4(p)})}function ZN(p){var g=p.getSnapshot;p=p.value;try{var C=g();return!va(p,C)}catch{return!0}}function e4(p){var g=$a(p,1);g!==null&&Wi(g,p,1,-1)}function t4(p){var g=Ga();return typeof p=="function"&&(p=p()),g.memoizedState=g.baseState=p,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jf,lastRenderedState:p},g.queue=p,p=p.dispatch=_L.bind(null,hr,p),[g.memoizedState,p]}function Mf(p,g,C,E){return p={tag:p,create:g,destroy:C,deps:E,next:null},g=hr.updateQueue,g===null?(g={lastEffect:null,stores:null},hr.updateQueue=g,g.lastEffect=p.next=p):(C=g.lastEffect,C===null?g.lastEffect=p.next=p:(E=C.next,C.next=p,p.next=E,g.lastEffect=p)),p}function r4(){return Hi().memoizedState}function Vm(p,g,C,E){var P=Ga();hr.flags|=p,P.memoizedState=Mf(1|g,C,void 0,E===void 0?null:E)}function $m(p,g,C,E){var P=Hi();E=E===void 0?null:E;var O=void 0;if(Wr!==null){var X=Wr.memoizedState;if(O=X.destroy,E!==null&&Z1(E,X.deps)){P.memoizedState=Mf(g,C,O,E);return}}hr.flags|=p,P.memoizedState=Mf(1|g,C,O,E)}function n4(p,g){return Vm(8390656,8,p,g)}function ib(p,g){return $m(2048,8,p,g)}function i4(p,g){return $m(4,2,p,g)}function a4(p,g){return $m(4,4,p,g)}function s4(p,g){if(typeof g=="function")return p=p(),g(p),function(){g(null)};if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function o4(p,g,C){return C=C!=null?C.concat([p]):null,$m(4,4,s4.bind(null,g,p),C)}function ab(){}function l4(p,g){var C=Hi();g=g===void 0?null:g;var E=C.memoizedState;return E!==null&&g!==null&&Z1(g,E[1])?E[0]:(C.memoizedState=[p,g],p)}function c4(p,g){var C=Hi();g=g===void 0?null:g;var E=C.memoizedState;return E!==null&&g!==null&&Z1(g,E[1])?E[0]:(p=p(),C.memoizedState=[p,g],p)}function u4(p,g,C){return Xl&21?(va(C,g)||(C=PN(),hr.lanes|=C,Ql|=C,p.baseState=!0),g):(p.baseState&&(p.baseState=!1,li=!0),p.memoizedState=C)}function ML(p,g){var C=Pt;Pt=C!==0&&4>C?C:4,p(!0);var E=J1.transition;J1.transition={};try{p(!1),g()}finally{Pt=C,J1.transition=E}}function d4(){return Hi().memoizedState}function PL(p,g,C){var E=bo(p);if(C={lane:E,action:C,hasEagerState:!1,eagerState:null,next:null},f4(p))h4(g,C);else if(C=UN(p,g,C,E),C!==null){var P=Ln();Wi(C,p,E,P),p4(C,g,E)}}function _L(p,g,C){var E=bo(p),P={lane:E,action:C,hasEagerState:!1,eagerState:null,next:null};if(f4(p))h4(g,P);else{var O=p.alternate;if(p.lanes===0&&(O===null||O.lanes===0)&&(O=g.lastRenderedReducer,O!==null))try{var X=g.lastRenderedState,oe=O(X,C);if(P.hasEagerState=!0,P.eagerState=oe,va(oe,X)){var pe=g.interleaved;pe===null?(P.next=P,W1(g)):(P.next=pe.next,pe.next=P),g.interleaved=P;return}}catch{}finally{}C=UN(p,g,P,E),C!==null&&(P=Ln(),Wi(C,p,E,P),p4(C,g,E))}}function f4(p){var g=p.alternate;return p===hr||g!==null&&g===hr}function h4(p,g){Ef=zm=!0;var C=p.pending;C===null?g.next=g:(g.next=C.next,C.next=g),p.pending=g}function p4(p,g,C){if(C&4194240){var E=g.lanes;E&=p.pendingLanes,C|=E,g.lanes=C,A1(p,C)}}var Um={readContext:Ui,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useInsertionEffect:Dn,useLayoutEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useMutableSource:Dn,useSyncExternalStore:Dn,useId:Dn,unstable_isNewReconciler:!1},AL={readContext:Ui,useCallback:function(p,g){return Ga().memoizedState=[p,g===void 0?null:g],p},useContext:Ui,useEffect:n4,useImperativeHandle:function(p,g,C){return C=C!=null?C.concat([p]):null,Vm(4194308,4,s4.bind(null,g,p),C)},useLayoutEffect:function(p,g){return Vm(4194308,4,p,g)},useInsertionEffect:function(p,g){return Vm(4,2,p,g)},useMemo:function(p,g){var C=Ga();return g=g===void 0?null:g,p=p(),C.memoizedState=[p,g],p},useReducer:function(p,g,C){var E=Ga();return g=C!==void 0?C(g):g,E.memoizedState=E.baseState=g,p={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:g},E.queue=p,p=p.dispatch=PL.bind(null,hr,p),[E.memoizedState,p]},useRef:function(p){var g=Ga();return p={current:p},g.memoizedState=p},useState:t4,useDebugValue:ab,useDeferredValue:function(p){return Ga().memoizedState=p},useTransition:function(){var p=t4(!1),g=p[0];return p=ML.bind(null,p[1]),Ga().memoizedState=p,[g,p]},useMutableSource:function(){},useSyncExternalStore:function(p,g,C){var E=hr,P=Ga();if(ir){if(C===void 0)throw Error(s(407));C=C()}else{if(C=g(),on===null)throw Error(s(349));Xl&30||XN(E,g,C)}P.memoizedState=C;var O={value:C,getSnapshot:g};return P.queue=O,n4(JN.bind(null,E,O,p),[p]),E.flags|=2048,Mf(9,QN.bind(null,E,O,C,g),void 0,null),C},useId:function(){var p=Ga(),g=on.identifierPrefix;if(ir){var C=Ns,E=Cs;C=(E&~(1<<32-ga(E)-1)).toString(32)+C,g=":"+g+"R"+C,C=Tf++,0<C&&(g+="H"+C.toString(32)),g+=":"}else C=jL++,g=":"+g+"r"+C.toString(32)+":";return p.memoizedState=g},unstable_isNewReconciler:!1},RL={readContext:Ui,useCallback:l4,useContext:Ui,useEffect:ib,useImperativeHandle:o4,useInsertionEffect:i4,useLayoutEffect:a4,useMemo:c4,useReducer:rb,useRef:r4,useState:function(){return rb(jf)},useDebugValue:ab,useDeferredValue:function(p){var g=Hi();return u4(g,Wr.memoizedState,p)},useTransition:function(){var p=rb(jf)[0],g=Hi().memoizedState;return[p,g]},useMutableSource:KN,useSyncExternalStore:YN,useId:d4,unstable_isNewReconciler:!1},DL={readContext:Ui,useCallback:l4,useContext:Ui,useEffect:ib,useImperativeHandle:o4,useInsertionEffect:i4,useLayoutEffect:a4,useMemo:c4,useReducer:nb,useRef:r4,useState:function(){return nb(jf)},useDebugValue:ab,useDeferredValue:function(p){var g=Hi();return Wr===null?g.memoizedState=p:u4(g,Wr.memoizedState,p)},useTransition:function(){var p=nb(jf)[0],g=Hi().memoizedState;return[p,g]},useMutableSource:KN,useSyncExternalStore:YN,useId:d4,unstable_isNewReconciler:!1};function xa(p,g){if(p&&p.defaultProps){g=a({},g),p=p.defaultProps;for(var C in p)g[C]===void 0&&(g[C]=p[C]);return g}return g}function sb(p,g,C,E){g=p.memoizedState,C=C(E,g),C=C==null?g:a({},g,C),p.memoizedState=C,p.lanes===0&&(p.updateQueue.baseState=C)}var Gm={isMounted:function(p){return(p=p._reactInternals)?A(p)===p:!1},enqueueSetState:function(p,g,C){p=p._reactInternals;var E=Ln(),P=bo(p),O=Es(E,P);O.payload=g,C!=null&&(O.callback=C),g=vo(p,O,P),g!==null&&(Wi(g,p,P,E),Im(g,p,P))},enqueueReplaceState:function(p,g,C){p=p._reactInternals;var E=Ln(),P=bo(p),O=Es(E,P);O.tag=1,O.payload=g,C!=null&&(O.callback=C),g=vo(p,O,P),g!==null&&(Wi(g,p,P,E),Im(g,p,P))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var C=Ln(),E=bo(p),P=Es(C,E);P.tag=2,g!=null&&(P.callback=g),g=vo(p,P,E),g!==null&&(Wi(g,p,E,C),Im(g,p,E))}};function m4(p,g,C,E,P,O,X){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(E,O,X):g.prototype&&g.prototype.isPureReactComponent?!Am(C,E)||!Am(P,O):!0}function g4(p,g,C){var E=!1,P=Fi,O=g.contextType;return typeof O=="object"&&O!==null?O=Ui(O):(P=Yn(g)?Hr:Gr.current,E=g.contextTypes,O=(E=E!=null)?mo(p,P):Fi),g=new g(C,O),p.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Gm,p.stateNode=g,g._reactInternals=p,E&&(p=p.stateNode,p.__reactInternalMemoizedUnmaskedChildContext=P,p.__reactInternalMemoizedMaskedChildContext=O),g}function v4(p,g,C,E){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(C,E),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(C,E),g.state!==p&&Gm.enqueueReplaceState(g,g.state,null)}function ob(p,g,C,E){var P=p.stateNode;P.props=C,P.state=p.memoizedState,P.refs={},q1(p);var O=g.contextType;typeof O=="object"&&O!==null?P.context=Ui(O):(O=Yn(g)?Hr:Gr.current,P.context=mo(p,O)),P.state=p.memoizedState,O=g.getDerivedStateFromProps,typeof O=="function"&&(sb(p,g,O,C),P.state=p.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(g=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),g!==P.state&&Gm.enqueueReplaceState(P,P.state,null),Lm(p,C,P,E),P.state=p.memoizedState),typeof P.componentDidMount=="function"&&(p.flags|=4194308)}function ku(p,g){try{var C="",E=g;do C+=TL(E),E=E.return;while(E);var P=C}catch(O){P=`
Error generating stack: `+O.message+`
`+O.stack}return{value:p,source:g,stack:P,digest:null}}function lb(p,g,C){return{value:p,source:null,stack:C??null,digest:g??null}}function cb(p,g){try{console.error(g.value)}catch(C){setTimeout(function(){throw C})}}var OL=typeof WeakMap=="function"?WeakMap:Map;function y4(p,g,C){C=Es(-1,C),C.tag=3,C.payload={element:null};var E=g.value;return C.callback=function(){ig||(ig=!0,Mb=E),cb(p,g)},C}function x4(p,g,C){C=Es(-1,C),C.tag=3;var E=p.type.getDerivedStateFromError;if(typeof E=="function"){var P=g.value;C.payload=function(){return E(P)},C.callback=function(){cb(p,g)}}var O=p.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(C.callback=function(){cb(p,g),typeof E!="function"&&(yo===null?yo=new Set([this]):yo.add(this));var X=g.stack;this.componentDidCatch(g.value,{componentStack:X!==null?X:""})}),C}function b4(p,g,C){var E=p.pingCache;if(E===null){E=p.pingCache=new OL;var P=new Set;E.set(g,P)}else P=E.get(g),P===void 0&&(P=new Set,E.set(g,P));P.has(C)||(P.add(C),p=YL.bind(null,p,g,C),g.then(p,p))}function w4(p){do{var g;if((g=p.tag===13)&&(g=p.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return p;p=p.return}while(p!==null);return null}function S4(p,g,C,E,P){return p.mode&1?(p.flags|=65536,p.lanes=P,p):(p===g?p.flags|=65536:(p.flags|=128,C.flags|=131072,C.flags&=-52805,C.tag===1&&(C.alternate===null?C.tag=17:(g=Es(-1,1),g.tag=2,vo(C,g,1))),C.lanes|=1),p)}var IL=o.ReactCurrentOwner,li=!1;function Xn(p,g,C,E){g.child=p===null?VN(g,null,C,E):yu(g,p.child,C,E)}function k4(p,g,C,E,P){C=C.render;var O=g.ref;return bu(g,P),E=eb(p,g,C,E,O,P),C=tb(),p!==null&&!li?(g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~P,Ts(p,g,P)):(ir&&C&&L1(g),g.flags|=1,Xn(p,g,E,P),g.child)}function C4(p,g,C,E,P){if(p===null){var O=C.type;return typeof O=="function"&&!Ob(O)&&O.defaultProps===void 0&&C.compare===null&&C.defaultProps===void 0?(g.tag=15,g.type=O,N4(p,g,O,E,P)):(p=ug(C.type,null,E,g,g.mode,P),p.ref=g.ref,p.return=g,g.child=p)}if(O=p.child,!(p.lanes&P)){var X=O.memoizedProps;if(C=C.compare,C=C!==null?C:Am,C(X,E)&&p.ref===g.ref)return Ts(p,g,P)}return g.flags|=1,p=So(O,E),p.ref=g.ref,p.return=g,g.child=p}function N4(p,g,C,E,P){if(p!==null){var O=p.memoizedProps;if(Am(O,E)&&p.ref===g.ref)if(li=!1,g.pendingProps=E=O,(p.lanes&P)!==0)p.flags&131072&&(li=!0);else return g.lanes=p.lanes,Ts(p,g,P)}return ub(p,g,C,E,P)}function E4(p,g,C){var E=g.pendingProps,P=E.children,O=p!==null?p.memoizedState:null;if(E.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null,transitions:null},vt(Nu,Ei),Ei|=C;else{if(!(C&1073741824))return p=O!==null?O.baseLanes|C:C,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:p,cachePool:null,transitions:null},g.updateQueue=null,vt(Nu,Ei),Ei|=p,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},E=O!==null?O.baseLanes:C,vt(Nu,Ei),Ei|=E}else O!==null?(E=O.baseLanes|C,g.memoizedState=null):E=C,vt(Nu,Ei),Ei|=E;return Xn(p,g,P,C),g.child}function T4(p,g){var C=g.ref;(p===null&&C!==null||p!==null&&p.ref!==C)&&(g.flags|=512,g.flags|=2097152)}function ub(p,g,C,E,P){var O=Yn(C)?Hr:Gr.current;return O=mo(g,O),bu(g,P),C=eb(p,g,C,E,O,P),E=tb(),p!==null&&!li?(g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~P,Ts(p,g,P)):(ir&&E&&L1(g),g.flags|=1,Xn(p,g,C,P),g.child)}function j4(p,g,C,E,P){if(Yn(C)){var O=!0;km(g)}else O=!1;if(bu(g,P),g.stateNode===null)Wm(p,g),g4(g,C,E),ob(g,C,E,P),E=!0;else if(p===null){var X=g.stateNode,oe=g.memoizedProps;X.props=oe;var pe=X.context,ke=C.contextType;typeof ke=="object"&&ke!==null?ke=Ui(ke):(ke=Yn(C)?Hr:Gr.current,ke=mo(g,ke));var $e=C.getDerivedStateFromProps,ot=typeof $e=="function"||typeof X.getSnapshotBeforeUpdate=="function";ot||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(oe!==E||pe!==ke)&&v4(g,X,E,ke),go=!1;var Me=g.memoizedState;X.state=Me,Lm(g,E,X,P),pe=g.memoizedState,oe!==E||Me!==pe||Lr.current||go?(typeof $e=="function"&&(sb(g,C,$e,E),pe=g.memoizedState),(oe=go||m4(g,C,oe,E,Me,pe,ke))?(ot||typeof X.UNSAFE_componentWillMount!="function"&&typeof X.componentWillMount!="function"||(typeof X.componentWillMount=="function"&&X.componentWillMount(),typeof X.UNSAFE_componentWillMount=="function"&&X.UNSAFE_componentWillMount()),typeof X.componentDidMount=="function"&&(g.flags|=4194308)):(typeof X.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=E,g.memoizedState=pe),X.props=E,X.state=pe,X.context=ke,E=oe):(typeof X.componentDidMount=="function"&&(g.flags|=4194308),E=!1)}else{X=g.stateNode,GN(p,g),oe=g.memoizedProps,ke=g.type===g.elementType?oe:xa(g.type,oe),X.props=ke,ot=g.pendingProps,Me=X.context,pe=C.contextType,typeof pe=="object"&&pe!==null?pe=Ui(pe):(pe=Yn(C)?Hr:Gr.current,pe=mo(g,pe));var Jt=C.getDerivedStateFromProps;($e=typeof Jt=="function"||typeof X.getSnapshotBeforeUpdate=="function")||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(oe!==ot||Me!==pe)&&v4(g,X,E,pe),go=!1,Me=g.memoizedState,X.state=Me,Lm(g,E,X,P);var Ut=g.memoizedState;oe!==ot||Me!==Ut||Lr.current||go?(typeof Jt=="function"&&(sb(g,C,Jt,E),Ut=g.memoizedState),(ke=go||m4(g,C,ke,E,Me,Ut,pe)||!1)?($e||typeof X.UNSAFE_componentWillUpdate!="function"&&typeof X.componentWillUpdate!="function"||(typeof X.componentWillUpdate=="function"&&X.componentWillUpdate(E,Ut,pe),typeof X.UNSAFE_componentWillUpdate=="function"&&X.UNSAFE_componentWillUpdate(E,Ut,pe)),typeof X.componentDidUpdate=="function"&&(g.flags|=4),typeof X.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof X.componentDidUpdate!="function"||oe===p.memoizedProps&&Me===p.memoizedState||(g.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||oe===p.memoizedProps&&Me===p.memoizedState||(g.flags|=1024),g.memoizedProps=E,g.memoizedState=Ut),X.props=E,X.state=Ut,X.context=pe,E=ke):(typeof X.componentDidUpdate!="function"||oe===p.memoizedProps&&Me===p.memoizedState||(g.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||oe===p.memoizedProps&&Me===p.memoizedState||(g.flags|=1024),E=!1)}return db(p,g,C,E,O,P)}function db(p,g,C,E,P,O){T4(p,g);var X=(g.flags&128)!==0;if(!E&&!X)return P&&MN(g,C,!1),Ts(p,g,O);E=g.stateNode,IL.current=g;var oe=X&&typeof C.getDerivedStateFromError!="function"?null:E.render();return g.flags|=1,p!==null&&X?(g.child=yu(g,p.child,null,O),g.child=yu(g,null,oe,O)):Xn(p,g,oe,O),g.memoizedState=E.state,P&&MN(g,C,!0),g.child}function M4(p){var g=p.stateNode;g.pendingContext?TN(p,g.pendingContext,g.pendingContext!==g.context):g.context&&TN(p,g.context,!1),K1(p,g.containerInfo)}function P4(p,g,C,E,P){return vu(),V1(P),g.flags|=256,Xn(p,g,C,E),g.child}var fb={dehydrated:null,treeContext:null,retryLane:0};function hb(p){return{baseLanes:p,cachePool:null,transitions:null}}function _4(p,g,C){var E=g.pendingProps,P=fr.current,O=!1,X=(g.flags&128)!==0,oe;if((oe=X)||(oe=p!==null&&p.memoizedState===null?!1:(P&2)!==0),oe?(O=!0,g.flags&=-129):(p===null||p.memoizedState!==null)&&(P|=1),vt(fr,P&1),p===null)return z1(g),p=g.memoizedState,p!==null&&(p=p.dehydrated,p!==null)?(g.mode&1?Pr(p)?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(X=E.children,p=E.fallback,O?(E=g.mode,O=g.child,X={mode:"hidden",children:X},!(E&1)&&O!==null?(O.childLanes=0,O.pendingProps=X):O=dg(X,E,0,null),p=tc(p,E,C,null),O.return=g,p.return=g,O.sibling=p,g.child=O,g.child.memoizedState=hb(C),g.memoizedState=fb,p):pb(g,X));if(P=p.memoizedState,P!==null&&(oe=P.dehydrated,oe!==null))return LL(p,g,X,E,oe,P,C);if(O){O=E.fallback,X=g.mode,P=p.child,oe=P.sibling;var pe={mode:"hidden",children:E.children};return!(X&1)&&g.child!==P?(E=g.child,E.childLanes=0,E.pendingProps=pe,g.deletions=null):(E=So(P,pe),E.subtreeFlags=P.subtreeFlags&14680064),oe!==null?O=So(oe,O):(O=tc(O,X,C,null),O.flags|=2),O.return=g,E.return=g,E.sibling=O,g.child=E,E=O,O=g.child,X=p.child.memoizedState,X=X===null?hb(C):{baseLanes:X.baseLanes|C,cachePool:null,transitions:X.transitions},O.memoizedState=X,O.childLanes=p.childLanes&~C,g.memoizedState=fb,E}return O=p.child,p=O.sibling,E=So(O,{mode:"visible",children:E.children}),!(g.mode&1)&&(E.lanes=C),E.return=g,E.sibling=null,p!==null&&(C=g.deletions,C===null?(g.deletions=[p],g.flags|=16):C.push(p)),g.child=E,g.memoizedState=null,E}function pb(p,g){return g=dg({mode:"visible",children:g},p.mode,0,null),g.return=p,p.child=g}function Hm(p,g,C,E){return E!==null&&V1(E),yu(g,p.child,null,C),p=pb(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function LL(p,g,C,E,P,O,X){if(C)return g.flags&256?(g.flags&=-257,E=lb(Error(s(422))),Hm(p,g,X,E)):g.memoizedState!==null?(g.child=p.child,g.flags|=128,null):(O=E.fallback,P=g.mode,E=dg({mode:"visible",children:E.children},P,0,null),O=tc(O,P,X,null),O.flags|=2,E.return=g,O.return=g,E.sibling=O,g.child=E,g.mode&1&&yu(g,p.child,null,X),g.child.memoizedState=hb(X),g.memoizedState=fb,O);if(!(g.mode&1))return Hm(p,g,X,null);if(Pr(P))return E=Fa(P).digest,O=Error(s(419)),E=lb(O,E,void 0),Hm(p,g,X,E);if(C=(X&p.childLanes)!==0,li||C){if(E=on,E!==null){switch(X&-X){case 4:P=2;break;case 16:P=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:P=32;break;case 536870912:P=268435456;break;default:P=0}P=P&(E.suspendedLanes|X)?0:P,P!==0&&P!==O.retryLane&&(O.retryLane=P,$a(p,P),Wi(E,p,P,-1))}return Db(),E=lb(Error(s(421))),Hm(p,g,X,E)}return wr(P)?(g.flags|=128,g.child=p.child,g=XL.bind(null,p),Sr(P,g),null):(p=O.treeContext,Z&&($i=hu(P),Ni=g,ir=!0,ya=null,Sf=!1,p!==null&&(zi[Vi++]=Cs,zi[Vi++]=Ns,zi[Vi++]=ql,Cs=p.id,Ns=p.overflow,ql=g)),g=pb(g,E.children),g.flags|=4096,g)}function A4(p,g,C){p.lanes|=g;var E=p.alternate;E!==null&&(E.lanes|=g),H1(p.return,g,C)}function mb(p,g,C,E,P){var O=p.memoizedState;O===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:E,tail:C,tailMode:P}:(O.isBackwards=g,O.rendering=null,O.renderingStartTime=0,O.last=E,O.tail=C,O.tailMode=P)}function R4(p,g,C){var E=g.pendingProps,P=E.revealOrder,O=E.tail;if(Xn(p,g,E.children,C),E=fr.current,E&2)E=E&1|2,g.flags|=128;else{if(p!==null&&p.flags&128)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&A4(p,C,g);else if(p.tag===19)A4(p,C,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}E&=1}if(vt(fr,E),!(g.mode&1))g.memoizedState=null;else switch(P){case"forwards":for(C=g.child,P=null;C!==null;)p=C.alternate,p!==null&&Bm(p)===null&&(P=C),C=C.sibling;C=P,C===null?(P=g.child,g.child=null):(P=C.sibling,C.sibling=null),mb(g,!1,P,C,O);break;case"backwards":for(C=null,P=g.child,g.child=null;P!==null;){if(p=P.alternate,p!==null&&Bm(p)===null){g.child=P;break}p=P.sibling,P.sibling=C,C=P,P=p}mb(g,!0,C,null,O);break;case"together":mb(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Wm(p,g){!(g.mode&1)&&p!==null&&(p.alternate=null,g.alternate=null,g.flags|=2)}function Ts(p,g,C){if(p!==null&&(g.dependencies=p.dependencies),Ql|=g.lanes,!(C&g.childLanes))return null;if(p!==null&&g.child!==p.child)throw Error(s(153));if(g.child!==null){for(p=g.child,C=So(p,p.pendingProps),g.child=C,C.return=g;p.sibling!==null;)p=p.sibling,C=C.sibling=So(p,p.pendingProps),C.return=g;C.sibling=null}return g.child}function BL(p,g,C){switch(g.tag){case 3:M4(g),vu();break;case 5:qN(g);break;case 1:Yn(g.type)&&km(g);break;case 4:K1(g,g.stateNode.containerInfo);break;case 10:$N(g,g.type._context,g.memoizedProps.value);break;case 13:var E=g.memoizedState;if(E!==null)return E.dehydrated!==null?(vt(fr,fr.current&1),g.flags|=128,null):C&g.child.childLanes?_4(p,g,C):(vt(fr,fr.current&1),p=Ts(p,g,C),p!==null?p.sibling:null);vt(fr,fr.current&1);break;case 19:if(E=(C&g.childLanes)!==0,p.flags&128){if(E)return R4(p,g,C);g.flags|=128}var P=g.memoizedState;if(P!==null&&(P.rendering=null,P.tail=null,P.lastEffect=null),vt(fr,fr.current),E)break;return null;case 22:case 23:return g.lanes=0,E4(p,g,C)}return Ts(p,g,C)}function Ha(p){p.flags|=4}function D4(p,g){if(p!==null&&p.child===g.child)return!0;if(g.flags&16)return!1;for(p=g.child;p!==null;){if(p.flags&12854||p.subtreeFlags&12854)return!1;p=p.sibling}return!0}var Pf,_f,qm,Km;if(Y)Pf=function(p,g){for(var C=g.child;C!==null;){if(C.tag===5||C.tag===6)G(p,C.stateNode);else if(C.tag!==4&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===g)break;for(;C.sibling===null;){if(C.return===null||C.return===g)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},_f=function(){},qm=function(p,g,C,E,P){if(p=p.memoizedProps,p!==E){var O=g.stateNode,X=Ua(Gi.current);C=re(O,C,p,E,P,X),(g.updateQueue=C)&&Ha(g)}},Km=function(p,g,C,E){C!==E&&Ha(g)};else if(te){Pf=function(p,g,C,E){for(var P=g.child;P!==null;){if(P.tag===5){var O=P.stateNode;C&&E&&(O=Kt(O,P.type,P.memoizedProps,P)),G(p,O)}else if(P.tag===6)O=P.stateNode,C&&E&&(O=Ot(O,P.memoizedProps,P)),G(p,O);else if(P.tag!==4){if(P.tag===22&&P.memoizedState!==null)O=P.child,O!==null&&(O.return=P),Pf(p,P,!0,!0);else if(P.child!==null){P.child.return=P,P=P.child;continue}}if(P===g)break;for(;P.sibling===null;){if(P.return===null||P.return===g)return;P=P.return}P.sibling.return=P.return,P=P.sibling}};var O4=function(p,g,C,E){for(var P=g.child;P!==null;){if(P.tag===5){var O=P.stateNode;C&&E&&(O=Kt(O,P.type,P.memoizedProps,P)),Ie(p,O)}else if(P.tag===6)O=P.stateNode,C&&E&&(O=Ot(O,P.memoizedProps,P)),Ie(p,O);else if(P.tag!==4){if(P.tag===22&&P.memoizedState!==null)O=P.child,O!==null&&(O.return=P),O4(p,P,!0,!0);else if(P.child!==null){P.child.return=P,P=P.child;continue}}if(P===g)break;for(;P.sibling===null;){if(P.return===null||P.return===g)return;P=P.return}P.sibling.return=P.return,P=P.sibling}};_f=function(p,g){var C=g.stateNode;if(!D4(p,g)){p=C.containerInfo;var E=tt(p);O4(E,g,!1,!1),C.pendingChildren=E,Ha(g),nt(p,E)}},qm=function(p,g,C,E,P){var O=p.stateNode,X=p.memoizedProps;if((p=D4(p,g))&&X===E)g.stateNode=O;else{var oe=g.stateNode,pe=Ua(Gi.current),ke=null;X!==E&&(ke=re(oe,C,X,E,P,pe)),p&&ke===null?g.stateNode=O:(O=et(O,ke,C,X,E,g,p,oe),ee(O,C,E,P,pe)&&Ha(g),g.stateNode=O,p?Ha(g):Pf(O,g,!1,!1))}},Km=function(p,g,C,E){C!==E?(p=Ua(wu.current),C=Ua(Gi.current),g.stateNode=de(E,p,C,g),Ha(g)):g.stateNode=p.stateNode}}else _f=function(){},qm=function(){},Km=function(){};function Af(p,g){if(!ir)switch(p.tailMode){case"hidden":g=p.tail;for(var C=null;g!==null;)g.alternate!==null&&(C=g),g=g.sibling;C===null?p.tail=null:C.sibling=null;break;case"collapsed":C=p.tail;for(var E=null;C!==null;)C.alternate!==null&&(E=C),C=C.sibling;E===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:E.sibling=null}}function On(p){var g=p.alternate!==null&&p.alternate.child===p.child,C=0,E=0;if(g)for(var P=p.child;P!==null;)C|=P.lanes|P.childLanes,E|=P.subtreeFlags&14680064,E|=P.flags&14680064,P.return=p,P=P.sibling;else for(P=p.child;P!==null;)C|=P.lanes|P.childLanes,E|=P.subtreeFlags,E|=P.flags,P.return=p,P=P.sibling;return p.subtreeFlags|=E,p.childLanes=C,g}function FL(p,g,C){var E=g.pendingProps;switch(B1(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return On(g),null;case 1:return Yn(g.type)&&pu(),On(g),null;case 3:return C=g.stateNode,Su(),$t(Lr),$t(Gr),Q1(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(p===null||p.child===null)&&(_m(g)?Ha(g):p===null||p.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,ya!==null&&(Ab(ya),ya=null))),_f(p,g),On(g),null;case 5:Y1(g),C=Ua(wu.current);var P=g.type;if(p!==null&&g.stateNode!=null)qm(p,g,P,E,C),p.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!E){if(g.stateNode===null)throw Error(s(166));return On(g),null}if(p=Ua(Gi.current),_m(g)){if(!Z)throw Error(s(175));p=bs(g.stateNode,g.type,g.memoizedProps,C,p,g,!Sf),g.updateQueue=p,p!==null&&Ha(g)}else{var O=L(P,E,C,p,g);Pf(O,g,!1,!1),g.stateNode=O,ee(O,P,E,C,p)&&Ha(g)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return On(g),null;case 6:if(p&&g.stateNode!=null)Km(p,g,p.memoizedProps,E);else{if(typeof E!="string"&&g.stateNode===null)throw Error(s(166));if(p=Ua(wu.current),C=Ua(Gi.current),_m(g)){if(!Z)throw Error(s(176));if(p=g.stateNode,C=g.memoizedProps,(E=An(p,C,g,!Sf))&&(P=Ni,P!==null))switch(P.tag){case 3:j1(P.stateNode.containerInfo,p,C,(P.mode&1)!==0);break;case 5:M1(P.type,P.memoizedProps,P.stateNode,p,C,(P.mode&1)!==0)}E&&Ha(g)}else g.stateNode=de(E,p,C,g)}return On(g),null;case 13:if($t(fr),E=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(ir&&$i!==null&&g.mode&1&&!(g.flags&128))BN(),vu(),g.flags|=98560,P=!1;else if(P=_m(g),E!==null&&E.dehydrated!==null){if(p===null){if(!P)throw Error(s(318));if(!Z)throw Error(s(344));if(P=g.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(s(317));nn(P,g)}else vu(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;On(g),P=!1}else ya!==null&&(Ab(ya),ya=null),P=!0;if(!P)return g.flags&65536?g:null}return g.flags&128?(g.lanes=C,g):(C=E!==null,C!==(p!==null&&p.memoizedState!==null)&&C&&(g.child.flags|=8192,g.mode&1&&(p===null||fr.current&1?qr===0&&(qr=3):Db())),g.updateQueue!==null&&(g.flags|=4),On(g),null);case 4:return Su(),_f(p,g),p===null&&ge(g.stateNode.containerInfo),On(g),null;case 10:return G1(g.type._context),On(g),null;case 17:return Yn(g.type)&&pu(),On(g),null;case 19:if($t(fr),P=g.memoizedState,P===null)return On(g),null;if(E=(g.flags&128)!==0,O=P.rendering,O===null)if(E)Af(P,!1);else{if(qr!==0||p!==null&&p.flags&128)for(p=g.child;p!==null;){if(O=Bm(p),O!==null){for(g.flags|=128,Af(P,!1),p=O.updateQueue,p!==null&&(g.updateQueue=p,g.flags|=4),g.subtreeFlags=0,p=C,C=g.child;C!==null;)E=C,P=p,E.flags&=14680066,O=E.alternate,O===null?(E.childLanes=0,E.lanes=P,E.child=null,E.subtreeFlags=0,E.memoizedProps=null,E.memoizedState=null,E.updateQueue=null,E.dependencies=null,E.stateNode=null):(E.childLanes=O.childLanes,E.lanes=O.lanes,E.child=O.child,E.subtreeFlags=0,E.deletions=null,E.memoizedProps=O.memoizedProps,E.memoizedState=O.memoizedState,E.updateQueue=O.updateQueue,E.type=O.type,P=O.dependencies,E.dependencies=P===null?null:{lanes:P.lanes,firstContext:P.firstContext}),C=C.sibling;return vt(fr,fr.current&1|2),g.child}p=p.sibling}P.tail!==null&&an()>jb&&(g.flags|=128,E=!0,Af(P,!1),g.lanes=4194304)}else{if(!E)if(p=Bm(O),p!==null){if(g.flags|=128,E=!0,p=p.updateQueue,p!==null&&(g.updateQueue=p,g.flags|=4),Af(P,!0),P.tail===null&&P.tailMode==="hidden"&&!O.alternate&&!ir)return On(g),null}else 2*an()-P.renderingStartTime>jb&&C!==1073741824&&(g.flags|=128,E=!0,Af(P,!1),g.lanes=4194304);P.isBackwards?(O.sibling=g.child,g.child=O):(p=P.last,p!==null?p.sibling=O:g.child=O,P.last=O)}return P.tail!==null?(g=P.tail,P.rendering=g,P.tail=g.sibling,P.renderingStartTime=an(),g.sibling=null,p=fr.current,vt(fr,E?p&1|2:p&1),g):(On(g),null);case 22:case 23:return Rb(),C=g.memoizedState!==null,p!==null&&p.memoizedState!==null!==C&&(g.flags|=8192),C&&g.mode&1?Ei&1073741824&&(On(g),Y&&g.subtreeFlags&6&&(g.flags|=8192)):On(g),null;case 24:return null;case 25:return null}throw Error(s(156,g.tag))}function zL(p,g){switch(B1(g),g.tag){case 1:return Yn(g.type)&&pu(),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return Su(),$t(Lr),$t(Gr),Q1(),p=g.flags,p&65536&&!(p&128)?(g.flags=p&-65537|128,g):null;case 5:return Y1(g),null;case 13:if($t(fr),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(s(340));vu()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return $t(fr),null;case 4:return Su(),null;case 10:return G1(g.type._context),null;case 22:case 23:return Rb(),null;case 24:return null;default:return null}}var Ym=!1,In=!1,VL=typeof WeakSet=="function"?WeakSet:Set,Le=null;function Cu(p,g){var C=p.ref;if(C!==null)if(typeof C=="function")try{C(null)}catch(E){ar(p,g,E)}else C.current=null}function gb(p,g,C){try{C()}catch(E){ar(p,g,E)}}var I4=!1;function $L(p,g){for(Q(p.containerInfo),Le=g;Le!==null;)if(p=Le,g=p.child,(p.subtreeFlags&1028)!==0&&g!==null)g.return=p,Le=g;else for(;Le!==null;){p=Le;try{var C=p.alternate;if(p.flags&1024)switch(p.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var E=C.memoizedProps,P=C.memoizedState,O=p.stateNode,X=O.getSnapshotBeforeUpdate(p.elementType===p.type?E:xa(p.type,E),P);O.__reactInternalSnapshotBeforeUpdate=X}break;case 3:Y&&He(p.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(oe){ar(p,p.return,oe)}if(g=p.sibling,g!==null){g.return=p.return,Le=g;break}Le=p.return}return C=I4,I4=!1,C}function Rf(p,g,C){var E=g.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var P=E=E.next;do{if((P.tag&p)===p){var O=P.destroy;P.destroy=void 0,O!==void 0&&gb(g,C,O)}P=P.next}while(P!==E)}}function Xm(p,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var C=g=g.next;do{if((C.tag&p)===p){var E=C.create;C.destroy=E()}C=C.next}while(C!==g)}}function vb(p){var g=p.ref;if(g!==null){var C=p.stateNode;switch(p.tag){case 5:p=z(C);break;default:p=C}typeof g=="function"?g(p):g.current=p}}function L4(p){var g=p.alternate;g!==null&&(p.alternate=null,L4(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&Pe(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}function B4(p){return p.tag===5||p.tag===3||p.tag===4}function F4(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||B4(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function yb(p,g,C){var E=p.tag;if(E===5||E===6)p=p.stateNode,g?J(C,p,g):Et(C,p);else if(E!==4&&(p=p.child,p!==null))for(yb(p,g,C),p=p.sibling;p!==null;)yb(p,g,C),p=p.sibling}function xb(p,g,C){var E=p.tag;if(E===5||E===6)p=p.stateNode,g?H(C,p,g):bt(C,p);else if(E!==4&&(p=p.child,p!==null))for(xb(p,g,C),p=p.sibling;p!==null;)xb(p,g,C),p=p.sibling}var xn=null,ba=!1;function Wa(p,g,C){for(C=C.child;C!==null;)bb(p,g,C),C=C.sibling}function bb(p,g,C){if(za&&typeof za.onCommitFiberUnmount=="function")try{za.onCommitFiberUnmount(Tm,C)}catch{}switch(C.tag){case 5:In||Cu(C,g);case 6:if(Y){var E=xn,P=ba;xn=null,Wa(p,g,C),xn=E,ba=P,xn!==null&&(ba?le(xn,C.stateNode):ae(xn,C.stateNode))}else Wa(p,g,C);break;case 18:Y&&xn!==null&&(ba?E1(xn,C.stateNode):Sm(xn,C.stateNode));break;case 4:Y?(E=xn,P=ba,xn=C.stateNode.containerInfo,ba=!0,Wa(p,g,C),xn=E,ba=P):(te&&(E=C.stateNode.containerInfo,P=tt(E),st(E,P)),Wa(p,g,C));break;case 0:case 11:case 14:case 15:if(!In&&(E=C.updateQueue,E!==null&&(E=E.lastEffect,E!==null))){P=E=E.next;do{var O=P,X=O.destroy;O=O.tag,X!==void 0&&(O&2||O&4)&&gb(C,g,X),P=P.next}while(P!==E)}Wa(p,g,C);break;case 1:if(!In&&(Cu(C,g),E=C.stateNode,typeof E.componentWillUnmount=="function"))try{E.props=C.memoizedProps,E.state=C.memoizedState,E.componentWillUnmount()}catch(oe){ar(C,g,oe)}Wa(p,g,C);break;case 21:Wa(p,g,C);break;case 22:C.mode&1?(In=(E=In)||C.memoizedState!==null,Wa(p,g,C),In=E):Wa(p,g,C);break;default:Wa(p,g,C)}}function z4(p){var g=p.updateQueue;if(g!==null){p.updateQueue=null;var C=p.stateNode;C===null&&(C=p.stateNode=new VL),g.forEach(function(E){var P=QL.bind(null,p,E);C.has(E)||(C.add(E),E.then(P,P))})}}function wa(p,g){var C=g.deletions;if(C!==null)for(var E=0;E<C.length;E++){var P=C[E];try{var O=p,X=g;if(Y){var oe=X;e:for(;oe!==null;){switch(oe.tag){case 5:xn=oe.stateNode,ba=!1;break e;case 3:xn=oe.stateNode.containerInfo,ba=!0;break e;case 4:xn=oe.stateNode.containerInfo,ba=!0;break e}oe=oe.return}if(xn===null)throw Error(s(160));bb(O,X,P),xn=null,ba=!1}else bb(O,X,P);var pe=P.alternate;pe!==null&&(pe.return=null),P.return=null}catch(ke){ar(P,g,ke)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)V4(g,p),g=g.sibling}function V4(p,g){var C=p.alternate,E=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:if(wa(g,p),qa(p),E&4){try{Rf(3,p,p.return),Xm(3,p)}catch(Me){ar(p,p.return,Me)}try{Rf(5,p,p.return)}catch(Me){ar(p,p.return,Me)}}break;case 1:wa(g,p),qa(p),E&512&&C!==null&&Cu(C,C.return);break;case 5:if(wa(g,p),qa(p),E&512&&C!==null&&Cu(C,C.return),Y){if(p.flags&32){var P=p.stateNode;try{fe(P)}catch(Me){ar(p,p.return,Me)}}if(E&4&&(P=p.stateNode,P!=null)){var O=p.memoizedProps;if(C=C!==null?C.memoizedProps:O,E=p.type,g=p.updateQueue,p.updateQueue=null,g!==null)try{ve(P,g,E,C,O,p)}catch(Me){ar(p,p.return,Me)}}}break;case 6:if(wa(g,p),qa(p),E&4&&Y){if(p.stateNode===null)throw Error(s(162));P=p.stateNode,O=p.memoizedProps,C=C!==null?C.memoizedProps:O;try{Je(P,C,O)}catch(Me){ar(p,p.return,Me)}}break;case 3:if(wa(g,p),qa(p),E&4){if(Y&&Z&&C!==null&&C.memoizedState.isDehydrated)try{Hl(g.containerInfo)}catch(Me){ar(p,p.return,Me)}if(te){P=g.containerInfo,O=g.pendingChildren;try{st(P,O)}catch(Me){ar(p,p.return,Me)}}}break;case 4:if(wa(g,p),qa(p),E&4&&te){O=p.stateNode,P=O.containerInfo,O=O.pendingChildren;try{st(P,O)}catch(Me){ar(p,p.return,Me)}}break;case 13:wa(g,p),qa(p),P=p.child,P.flags&8192&&(O=P.memoizedState!==null,P.stateNode.isHidden=O,!O||P.alternate!==null&&P.alternate.memoizedState!==null||(Tb=an())),E&4&&z4(p);break;case 22:var X=C!==null&&C.memoizedState!==null;if(p.mode&1?(In=(C=In)||X,wa(g,p),In=C):wa(g,p),qa(p),E&8192){if(C=p.memoizedState!==null,(p.stateNode.isHidden=C)&&!X&&p.mode&1)for(Le=p,E=p.child;E!==null;){for(g=Le=E;Le!==null;){X=Le;var oe=X.child;switch(X.tag){case 0:case 11:case 14:case 15:Rf(4,X,X.return);break;case 1:Cu(X,X.return);var pe=X.stateNode;if(typeof pe.componentWillUnmount=="function"){var ke=X,$e=X.return;try{var ot=ke;pe.props=ot.memoizedProps,pe.state=ot.memoizedState,pe.componentWillUnmount()}catch(Me){ar(ke,$e,Me)}}break;case 5:Cu(X,X.return);break;case 22:if(X.memoizedState!==null){G4(g);continue}}oe!==null?(oe.return=X,Le=oe):G4(g)}E=E.sibling}if(Y){e:if(E=null,Y)for(g=p;;){if(g.tag===5){if(E===null){E=g;try{P=g.stateNode,C?xe(P):Te(g.stateNode,g.memoizedProps)}catch(Me){ar(p,p.return,Me)}}}else if(g.tag===6){if(E===null)try{O=g.stateNode,C?ye(O):je(O,g.memoizedProps)}catch(Me){ar(p,p.return,Me)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;E===g&&(E=null),g=g.return}E===g&&(E=null),g.sibling.return=g.return,g=g.sibling}}}break;case 19:wa(g,p),qa(p),E&4&&z4(p);break;case 21:break;default:wa(g,p),qa(p)}}function qa(p){var g=p.flags;if(g&2){try{if(Y){e:{for(var C=p.return;C!==null;){if(B4(C)){var E=C;break e}C=C.return}throw Error(s(160))}switch(E.tag){case 5:var P=E.stateNode;E.flags&32&&(fe(P),E.flags&=-33);var O=F4(p);xb(p,O,P);break;case 3:case 4:var X=E.stateNode.containerInfo,oe=F4(p);yb(p,oe,X);break;default:throw Error(s(161))}}}catch(pe){ar(p,p.return,pe)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function UL(p,g,C){Le=p,$4(p)}function $4(p,g,C){for(var E=(p.mode&1)!==0;Le!==null;){var P=Le,O=P.child;if(P.tag===22&&E){var X=P.memoizedState!==null||Ym;if(!X){var oe=P.alternate,pe=oe!==null&&oe.memoizedState!==null||In;oe=Ym;var ke=In;if(Ym=X,(In=pe)&&!ke)for(Le=P;Le!==null;)X=Le,pe=X.child,X.tag===22&&X.memoizedState!==null?H4(P):pe!==null?(pe.return=X,Le=pe):H4(P);for(;O!==null;)Le=O,$4(O),O=O.sibling;Le=P,Ym=oe,In=ke}U4(p)}else P.subtreeFlags&8772&&O!==null?(O.return=P,Le=O):U4(p)}}function U4(p){for(;Le!==null;){var g=Le;if(g.flags&8772){var C=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:In||Xm(5,g);break;case 1:var E=g.stateNode;if(g.flags&4&&!In)if(C===null)E.componentDidMount();else{var P=g.elementType===g.type?C.memoizedProps:xa(g.type,C.memoizedProps);E.componentDidUpdate(P,C.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var O=g.updateQueue;O!==null&&WN(g,O,E);break;case 3:var X=g.updateQueue;if(X!==null){if(C=null,g.child!==null)switch(g.child.tag){case 5:C=z(g.child.stateNode);break;case 1:C=g.child.stateNode}WN(g,X,C)}break;case 5:var oe=g.stateNode;C===null&&g.flags&4&&De(oe,g.type,g.memoizedProps,g);break;case 6:break;case 4:break;case 12:break;case 13:if(Z&&g.memoizedState===null){var pe=g.alternate;if(pe!==null){var ke=pe.memoizedState;if(ke!==null){var $e=ke.dehydrated;$e!==null&&oi($e)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}In||g.flags&512&&vb(g)}catch(ot){ar(g,g.return,ot)}}if(g===p){Le=null;break}if(C=g.sibling,C!==null){C.return=g.return,Le=C;break}Le=g.return}}function G4(p){for(;Le!==null;){var g=Le;if(g===p){Le=null;break}var C=g.sibling;if(C!==null){C.return=g.return,Le=C;break}Le=g.return}}function H4(p){for(;Le!==null;){var g=Le;try{switch(g.tag){case 0:case 11:case 15:var C=g.return;try{Xm(4,g)}catch(pe){ar(g,C,pe)}break;case 1:var E=g.stateNode;if(typeof E.componentDidMount=="function"){var P=g.return;try{E.componentDidMount()}catch(pe){ar(g,P,pe)}}var O=g.return;try{vb(g)}catch(pe){ar(g,O,pe)}break;case 5:var X=g.return;try{vb(g)}catch(pe){ar(g,X,pe)}}}catch(pe){ar(g,g.return,pe)}if(g===p){Le=null;break}var oe=g.sibling;if(oe!==null){oe.return=g.return,Le=oe;break}Le=g.return}}var Qm=0,Jm=1,Zm=2,eg=3,tg=4;if(typeof Symbol=="function"&&Symbol.for){var Df=Symbol.for;Qm=Df("selector.component"),Jm=Df("selector.has_pseudo_class"),Zm=Df("selector.role"),eg=Df("selector.test_id"),tg=Df("selector.text")}function wb(p){var g=ue(p);if(g!=null){if(typeof g.memoizedProps["data-testname"]!="string")throw Error(s(364));return g}if(p=Re(p),p===null)throw Error(s(362));return p.stateNode.current}function Sb(p,g){switch(g.$$typeof){case Qm:if(p.type===g.value)return!0;break;case Jm:e:{g=g.value,p=[p,0];for(var C=0;C<p.length;){var E=p[C++],P=p[C++],O=g[P];if(E.tag!==5||!Oe(E)){for(;O!=null&&Sb(E,O);)P++,O=g[P];if(P===g.length){g=!0;break e}else for(E=E.child;E!==null;)p.push(E,P),E=E.sibling}}g=!1}return g;case Zm:if(p.tag===5&&rt(p.stateNode,g.value))return!0;break;case tg:if((p.tag===5||p.tag===6)&&(p=We(p),p!==null&&0<=p.indexOf(g.value)))return!0;break;case eg:if(p.tag===5&&(p=p.memoizedProps["data-testname"],typeof p=="string"&&p.toLowerCase()===g.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function kb(p){switch(p.$$typeof){case Qm:return"<"+(T(p.value)||"Unknown")+">";case Jm:return":has("+(kb(p)||"")+")";case Zm:return'[role="'+p.value+'"]';case tg:return'"'+p.value+'"';case eg:return'[data-testname="'+p.value+'"]';default:throw Error(s(365))}}function W4(p,g){var C=[];p=[p,0];for(var E=0;E<p.length;){var P=p[E++],O=p[E++],X=g[O];if(P.tag!==5||!Oe(P)){for(;X!=null&&Sb(P,X);)O++,X=g[O];if(O===g.length)C.push(P);else for(P=P.child;P!==null;)p.push(P,O),P=P.sibling}}return C}function Cb(p,g){if(!Ce)throw Error(s(363));p=wb(p),p=W4(p,g),g=[],p=Array.from(p);for(var C=0;C<p.length;){var E=p[C++];if(E.tag===5)Oe(E)||g.push(E.stateNode);else for(E=E.child;E!==null;)p.push(E),E=E.sibling}return g}var GL=Math.ceil,rg=o.ReactCurrentDispatcher,Nb=o.ReactCurrentOwner,_r=o.ReactCurrentBatchConfig,yt=0,on=null,Br=null,bn=0,Ei=0,Nu=ma(0),qr=0,Of=null,Ql=0,ng=0,Eb=0,If=null,ci=null,Tb=0,jb=1/0,js=null;function Eu(){jb=an()+500}var ig=!1,Mb=null,yo=null,ag=!1,xo=null,sg=0,Lf=0,Pb=null,og=-1,lg=0;function Ln(){return yt&6?an():og!==-1?og:og=an()}function bo(p){return p.mode&1?yt&2&&bn!==0?bn&-bn:EL.transition!==null?(lg===0&&(lg=PN()),lg):(p=Pt,p!==0?p:Ue()):1}function Wi(p,g,C,E){if(50<Lf)throw Lf=0,Pb=null,Error(s(185));wf(p,C,E),(!(yt&2)||p!==on)&&(p===on&&(!(yt&2)&&(ng|=C),qr===4&&wo(p,bn)),ui(p,E),C===1&&yt===0&&!(g.mode&1)&&(Eu(),jm&&Va()))}function ui(p,g){var C=p.callbackNode;vL(p,g);var E=Em(p,p===on?bn:0);if(E===0)C!==null&&AN(C),p.callbackNode=null,p.callbackPriority=0;else if(g=E&-E,p.callbackPriority!==g){if(C!=null&&AN(C),g===1)p.tag===0?NL(K4.bind(null,p)):RN(K4.bind(null,p)),ze?Ge(function(){!(yt&6)&&Va()}):R1(D1,Va),C=null;else{switch(_N(E)){case 1:C=D1;break;case 4:C=wL;break;case 16:C=O1;break;case 536870912:C=SL;break;default:C=O1}C=nE(C,q4.bind(null,p))}p.callbackPriority=g,p.callbackNode=C}}function q4(p,g){if(og=-1,lg=0,yt&6)throw Error(s(327));var C=p.callbackNode;if(ec()&&p.callbackNode!==C)return null;var E=Em(p,p===on?bn:0);if(E===0)return null;if(E&30||E&p.expiredLanes||g)g=cg(p,E);else{g=E;var P=yt;yt|=2;var O=Q4();(on!==p||bn!==g)&&(js=null,Eu(),Jl(p,g));do try{qL();break}catch(oe){X4(p,oe)}while(1);U1(),rg.current=O,yt=P,Br!==null?g=0:(on=null,bn=0,g=qr)}if(g!==0){if(g===2&&(P=P1(p),P!==0&&(E=P,g=_b(p,P))),g===1)throw C=Of,Jl(p,0),wo(p,E),ui(p,an()),C;if(g===6)wo(p,E);else{if(P=p.current.alternate,!(E&30)&&!HL(P)&&(g=cg(p,E),g===2&&(O=P1(p),O!==0&&(E=O,g=_b(p,O))),g===1))throw C=Of,Jl(p,0),wo(p,E),ui(p,an()),C;switch(p.finishedWork=P,p.finishedLanes=E,g){case 0:case 1:throw Error(s(345));case 2:Zl(p,ci,js);break;case 3:if(wo(p,E),(E&130023424)===E&&(g=Tb+500-an(),10<g)){if(Em(p,0)!==0)break;if(P=p.suspendedLanes,(P&E)!==E){Ln(),p.pingedLanes|=p.suspendedLanes&P;break}p.timeoutHandle=W(Zl.bind(null,p,ci,js),g);break}Zl(p,ci,js);break;case 4:if(wo(p,E),(E&4194240)===E)break;for(g=p.eventTimes,P=-1;0<E;){var X=31-ga(E);O=1<<X,X=g[X],X>P&&(P=X),E&=~O}if(E=P,E=an()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*GL(E/1960))-E,10<E){p.timeoutHandle=W(Zl.bind(null,p,ci,js),E);break}Zl(p,ci,js);break;case 5:Zl(p,ci,js);break;default:throw Error(s(329))}}}return ui(p,an()),p.callbackNode===C?q4.bind(null,p):null}function _b(p,g){var C=If;return p.current.memoizedState.isDehydrated&&(Jl(p,g).flags|=256),p=cg(p,g),p!==2&&(g=ci,ci=C,g!==null&&Ab(g)),p}function Ab(p){ci===null?ci=p:ci.push.apply(ci,p)}function HL(p){for(var g=p;;){if(g.flags&16384){var C=g.updateQueue;if(C!==null&&(C=C.stores,C!==null))for(var E=0;E<C.length;E++){var P=C[E],O=P.getSnapshot;P=P.value;try{if(!va(O(),P))return!1}catch{return!1}}}if(C=g.child,g.subtreeFlags&16384&&C!==null)C.return=g,g=C;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function wo(p,g){for(g&=~Eb,g&=~ng,p.suspendedLanes|=g,p.pingedLanes&=~g,p=p.expirationTimes;0<g;){var C=31-ga(g),E=1<<C;p[C]=-1,g&=~E}}function K4(p){if(yt&6)throw Error(s(327));ec();var g=Em(p,0);if(!(g&1))return ui(p,an()),null;var C=cg(p,g);if(p.tag!==0&&C===2){var E=P1(p);E!==0&&(g=E,C=_b(p,E))}if(C===1)throw C=Of,Jl(p,0),wo(p,g),ui(p,an()),C;if(C===6)throw Error(s(345));return p.finishedWork=p.current.alternate,p.finishedLanes=g,Zl(p,ci,js),ui(p,an()),null}function Y4(p){xo!==null&&xo.tag===0&&!(yt&6)&&ec();var g=yt;yt|=1;var C=_r.transition,E=Pt;try{if(_r.transition=null,Pt=1,p)return p()}finally{Pt=E,_r.transition=C,yt=g,!(yt&6)&&Va()}}function Rb(){Ei=Nu.current,$t(Nu)}function Jl(p,g){p.finishedWork=null,p.finishedLanes=0;var C=p.timeoutHandle;if(C!==ie&&(p.timeoutHandle=ie,ne(C)),Br!==null)for(C=Br.return;C!==null;){var E=C;switch(B1(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&pu();break;case 3:Su(),$t(Lr),$t(Gr),Q1();break;case 5:Y1(E);break;case 4:Su();break;case 13:$t(fr);break;case 19:$t(fr);break;case 10:G1(E.type._context);break;case 22:case 23:Rb()}C=C.return}if(on=p,Br=p=So(p.current,null),bn=Ei=g,qr=0,Of=null,Eb=ng=Ql=0,ci=If=null,Yl!==null){for(g=0;g<Yl.length;g++)if(C=Yl[g],E=C.interleaved,E!==null){C.interleaved=null;var P=E.next,O=C.pending;if(O!==null){var X=O.next;O.next=P,E.next=X}C.pending=E}Yl=null}return p}function X4(p,g){do{var C=Br;try{if(U1(),Fm.current=Um,zm){for(var E=hr.memoizedState;E!==null;){var P=E.queue;P!==null&&(P.pending=null),E=E.next}zm=!1}if(Xl=0,sn=Wr=hr=null,Ef=!1,Tf=0,Nb.current=null,C===null||C.return===null){qr=1,Of=g,Br=null;break}e:{var O=p,X=C.return,oe=C,pe=g;if(g=bn,oe.flags|=32768,pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var ke=pe,$e=oe,ot=$e.tag;if(!($e.mode&1)&&(ot===0||ot===11||ot===15)){var Me=$e.alternate;Me?($e.updateQueue=Me.updateQueue,$e.memoizedState=Me.memoizedState,$e.lanes=Me.lanes):($e.updateQueue=null,$e.memoizedState=null)}var Jt=w4(X);if(Jt!==null){Jt.flags&=-257,S4(Jt,X,oe,O,g),Jt.mode&1&&b4(O,ke,g),g=Jt,pe=ke;var Ut=g.updateQueue;if(Ut===null){var di=new Set;di.add(pe),g.updateQueue=di}else Ut.add(pe);break e}else{if(!(g&1)){b4(O,ke,g),Db();break e}pe=Error(s(426))}}else if(ir&&oe.mode&1){var Ms=w4(X);if(Ms!==null){!(Ms.flags&65536)&&(Ms.flags|=256),S4(Ms,X,oe,O,g),V1(ku(pe,oe));break e}}O=pe=ku(pe,oe),qr!==4&&(qr=2),If===null?If=[O]:If.push(O),O=X;do{switch(O.tag){case 3:O.flags|=65536,g&=-g,O.lanes|=g;var he=y4(O,pe,g);HN(O,he);break e;case 1:oe=pe;var ce=O.type,me=O.stateNode;if(!(O.flags&128)&&(typeof ce.getDerivedStateFromError=="function"||me!==null&&typeof me.componentDidCatch=="function"&&(yo===null||!yo.has(me)))){O.flags|=65536,g&=-g,O.lanes|=g;var _e=x4(O,oe,g);HN(O,_e);break e}}O=O.return}while(O!==null)}Z4(C)}catch(Xe){g=Xe,Br===C&&C!==null&&(Br=C=C.return);continue}break}while(1)}function Q4(){var p=rg.current;return rg.current=Um,p===null?Um:p}function Db(){(qr===0||qr===3||qr===2)&&(qr=4),on===null||!(Ql&268435455)&&!(ng&268435455)||wo(on,bn)}function cg(p,g){var C=yt;yt|=2;var E=Q4();(on!==p||bn!==g)&&(js=null,Jl(p,g));do try{WL();break}catch(P){X4(p,P)}while(1);if(U1(),yt=C,rg.current=E,Br!==null)throw Error(s(261));return on=null,bn=0,qr}function WL(){for(;Br!==null;)J4(Br)}function qL(){for(;Br!==null&&!xL();)J4(Br)}function J4(p){var g=rE(p.alternate,p,Ei);p.memoizedProps=p.pendingProps,g===null?Z4(p):Br=g,Nb.current=null}function Z4(p){var g=p;do{var C=g.alternate;if(p=g.return,g.flags&32768){if(C=zL(C,g),C!==null){C.flags&=32767,Br=C;return}if(p!==null)p.flags|=32768,p.subtreeFlags=0,p.deletions=null;else{qr=6,Br=null;return}}else if(C=FL(C,g,Ei),C!==null){Br=C;return}if(g=g.sibling,g!==null){Br=g;return}Br=g=p}while(g!==null);qr===0&&(qr=5)}function Zl(p,g,C){var E=Pt,P=_r.transition;try{_r.transition=null,Pt=1,KL(p,g,C,E)}finally{_r.transition=P,Pt=E}return null}function KL(p,g,C,E){do ec();while(xo!==null);if(yt&6)throw Error(s(327));C=p.finishedWork;var P=p.finishedLanes;if(C===null)return null;if(p.finishedWork=null,p.finishedLanes=0,C===p.current)throw Error(s(177));p.callbackNode=null,p.callbackPriority=0;var O=C.lanes|C.childLanes;if(yL(p,O),p===on&&(Br=on=null,bn=0),!(C.subtreeFlags&2064)&&!(C.flags&2064)||ag||(ag=!0,nE(O1,function(){return ec(),null})),O=(C.flags&15990)!==0,C.subtreeFlags&15990||O){O=_r.transition,_r.transition=null;var X=Pt;Pt=1;var oe=yt;yt|=4,Nb.current=null,$L(p,C),V4(C,p),K(p.containerInfo),p.current=C,UL(C),bL(),yt=oe,Pt=X,_r.transition=O}else p.current=C;if(ag&&(ag=!1,xo=p,sg=P),O=p.pendingLanes,O===0&&(yo=null),kL(C.stateNode),ui(p,an()),g!==null)for(E=p.onRecoverableError,C=0;C<g.length;C++)P=g[C],E(P.value,{componentStack:P.stack,digest:P.digest});if(ig)throw ig=!1,p=Mb,Mb=null,p;return sg&1&&p.tag!==0&&ec(),O=p.pendingLanes,O&1?p===Pb?Lf++:(Lf=0,Pb=p):Lf=0,Va(),null}function ec(){if(xo!==null){var p=_N(sg),g=_r.transition,C=Pt;try{if(_r.transition=null,Pt=16>p?16:p,xo===null)var E=!1;else{if(p=xo,xo=null,sg=0,yt&6)throw Error(s(331));var P=yt;for(yt|=4,Le=p.current;Le!==null;){var O=Le,X=O.child;if(Le.flags&16){var oe=O.deletions;if(oe!==null){for(var pe=0;pe<oe.length;pe++){var ke=oe[pe];for(Le=ke;Le!==null;){var $e=Le;switch($e.tag){case 0:case 11:case 15:Rf(8,$e,O)}var ot=$e.child;if(ot!==null)ot.return=$e,Le=ot;else for(;Le!==null;){$e=Le;var Me=$e.sibling,Jt=$e.return;if(L4($e),$e===ke){Le=null;break}if(Me!==null){Me.return=Jt,Le=Me;break}Le=Jt}}}var Ut=O.alternate;if(Ut!==null){var di=Ut.child;if(di!==null){Ut.child=null;do{var Ms=di.sibling;di.sibling=null,di=Ms}while(di!==null)}}Le=O}}if(O.subtreeFlags&2064&&X!==null)X.return=O,Le=X;else e:for(;Le!==null;){if(O=Le,O.flags&2048)switch(O.tag){case 0:case 11:case 15:Rf(9,O,O.return)}var he=O.sibling;if(he!==null){he.return=O.return,Le=he;break e}Le=O.return}}var ce=p.current;for(Le=ce;Le!==null;){X=Le;var me=X.child;if(X.subtreeFlags&2064&&me!==null)me.return=X,Le=me;else e:for(X=ce;Le!==null;){if(oe=Le,oe.flags&2048)try{switch(oe.tag){case 0:case 11:case 15:Xm(9,oe)}}catch(Xe){ar(oe,oe.return,Xe)}if(oe===X){Le=null;break e}var _e=oe.sibling;if(_e!==null){_e.return=oe.return,Le=_e;break e}Le=oe.return}}if(yt=P,Va(),za&&typeof za.onPostCommitFiberRoot=="function")try{za.onPostCommitFiberRoot(Tm,p)}catch{}E=!0}return E}finally{Pt=C,_r.transition=g}}return!1}function eE(p,g,C){g=ku(C,g),g=y4(p,g,1),p=vo(p,g,1),g=Ln(),p!==null&&(wf(p,1,g),ui(p,g))}function ar(p,g,C){if(p.tag===3)eE(p,p,C);else for(;g!==null;){if(g.tag===3){eE(g,p,C);break}else if(g.tag===1){var E=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(yo===null||!yo.has(E))){p=ku(C,p),p=x4(g,p,1),g=vo(g,p,1),p=Ln(),g!==null&&(wf(g,1,p),ui(g,p));break}}g=g.return}}function YL(p,g,C){var E=p.pingCache;E!==null&&E.delete(g),g=Ln(),p.pingedLanes|=p.suspendedLanes&C,on===p&&(bn&C)===C&&(qr===4||qr===3&&(bn&130023424)===bn&&500>an()-Tb?Jl(p,0):Eb|=C),ui(p,g)}function tE(p,g){g===0&&(p.mode&1?(g=Nm,Nm<<=1,!(Nm&130023424)&&(Nm=4194304)):g=1);var C=Ln();p=$a(p,g),p!==null&&(wf(p,g,C),ui(p,C))}function XL(p){var g=p.memoizedState,C=0;g!==null&&(C=g.retryLane),tE(p,C)}function QL(p,g){var C=0;switch(p.tag){case 13:var E=p.stateNode,P=p.memoizedState;P!==null&&(C=P.retryLane);break;case 19:E=p.stateNode;break;default:throw Error(s(314))}E!==null&&E.delete(g),tE(p,C)}var rE;rE=function(p,g,C){if(p!==null)if(p.memoizedProps!==g.pendingProps||Lr.current)li=!0;else{if(!(p.lanes&C)&&!(g.flags&128))return li=!1,BL(p,g,C);li=!!(p.flags&131072)}else li=!1,ir&&g.flags&1048576&&DN(g,Pm,g.index);switch(g.lanes=0,g.tag){case 2:var E=g.type;Wm(p,g),p=g.pendingProps;var P=mo(g,Gr.current);bu(g,C),P=eb(null,g,E,p,P,C);var O=tb();return g.flags|=1,typeof P=="object"&&P!==null&&typeof P.render=="function"&&P.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Yn(E)?(O=!0,km(g)):O=!1,g.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,q1(g),P.updater=Gm,g.stateNode=P,P._reactInternals=g,ob(g,E,p,C),g=db(null,g,E,!0,O,C)):(g.tag=0,ir&&O&&L1(g),Xn(null,g,P,C),g=g.child),g;case 16:E=g.elementType;e:{switch(Wm(p,g),p=g.pendingProps,P=E._init,E=P(E._payload),g.type=E,P=g.tag=ZL(E),p=xa(E,p),P){case 0:g=ub(null,g,E,p,C);break e;case 1:g=j4(null,g,E,p,C);break e;case 11:g=k4(null,g,E,p,C);break e;case 14:g=C4(null,g,E,xa(E.type,p),C);break e}throw Error(s(306,E,""))}return g;case 0:return E=g.type,P=g.pendingProps,P=g.elementType===E?P:xa(E,P),ub(p,g,E,P,C);case 1:return E=g.type,P=g.pendingProps,P=g.elementType===E?P:xa(E,P),j4(p,g,E,P,C);case 3:e:{if(M4(g),p===null)throw Error(s(387));E=g.pendingProps,O=g.memoizedState,P=O.element,GN(p,g),Lm(g,E,null,C);var X=g.memoizedState;if(E=X.element,Z&&O.isDehydrated)if(O={element:E,isDehydrated:!1,cache:X.cache,pendingSuspenseBoundaries:X.pendingSuspenseBoundaries,transitions:X.transitions},g.updateQueue.baseState=O,g.memoizedState=O,g.flags&256){P=ku(Error(s(423)),g),g=P4(p,g,E,C,P);break e}else if(E!==P){P=ku(Error(s(424)),g),g=P4(p,g,E,C,P);break e}else for(Z&&($i=ho(g.stateNode.containerInfo),Ni=g,ir=!0,ya=null,Sf=!1),C=VN(g,null,E,C),g.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(vu(),E===P){g=Ts(p,g,C);break e}Xn(p,g,E,C)}g=g.child}return g;case 5:return qN(g),p===null&&z1(g),E=g.type,P=g.pendingProps,O=p!==null?p.memoizedProps:null,X=P.children,se(E,P)?X=null:O!==null&&se(E,O)&&(g.flags|=32),T4(p,g),Xn(p,g,X,C),g.child;case 6:return p===null&&z1(g),null;case 13:return _4(p,g,C);case 4:return K1(g,g.stateNode.containerInfo),E=g.pendingProps,p===null?g.child=yu(g,null,E,C):Xn(p,g,E,C),g.child;case 11:return E=g.type,P=g.pendingProps,P=g.elementType===E?P:xa(E,P),k4(p,g,E,P,C);case 7:return Xn(p,g,g.pendingProps,C),g.child;case 8:return Xn(p,g,g.pendingProps.children,C),g.child;case 12:return Xn(p,g,g.pendingProps.children,C),g.child;case 10:e:{if(E=g.type._context,P=g.pendingProps,O=g.memoizedProps,X=P.value,$N(g,E,X),O!==null)if(va(O.value,X)){if(O.children===P.children&&!Lr.current){g=Ts(p,g,C);break e}}else for(O=g.child,O!==null&&(O.return=g);O!==null;){var oe=O.dependencies;if(oe!==null){X=O.child;for(var pe=oe.firstContext;pe!==null;){if(pe.context===E){if(O.tag===1){pe=Es(-1,C&-C),pe.tag=2;var ke=O.updateQueue;if(ke!==null){ke=ke.shared;var $e=ke.pending;$e===null?pe.next=pe:(pe.next=$e.next,$e.next=pe),ke.pending=pe}}O.lanes|=C,pe=O.alternate,pe!==null&&(pe.lanes|=C),H1(O.return,C,g),oe.lanes|=C;break}pe=pe.next}}else if(O.tag===10)X=O.type===g.type?null:O.child;else if(O.tag===18){if(X=O.return,X===null)throw Error(s(341));X.lanes|=C,oe=X.alternate,oe!==null&&(oe.lanes|=C),H1(X,C,g),X=O.sibling}else X=O.child;if(X!==null)X.return=O;else for(X=O;X!==null;){if(X===g){X=null;break}if(O=X.sibling,O!==null){O.return=X.return,X=O;break}X=X.return}O=X}Xn(p,g,P.children,C),g=g.child}return g;case 9:return P=g.type,E=g.pendingProps.children,bu(g,C),P=Ui(P),E=E(P),g.flags|=1,Xn(p,g,E,C),g.child;case 14:return E=g.type,P=xa(E,g.pendingProps),P=xa(E.type,P),C4(p,g,E,P,C);case 15:return N4(p,g,g.type,g.pendingProps,C);case 17:return E=g.type,P=g.pendingProps,P=g.elementType===E?P:xa(E,P),Wm(p,g),g.tag=1,Yn(E)?(p=!0,km(g)):p=!1,bu(g,C),g4(g,E,P),ob(g,E,P,C),db(null,g,E,!0,p,C);case 19:return R4(p,g,C);case 22:return E4(p,g,C)}throw Error(s(156,g.tag))};function nE(p,g){return R1(p,g)}function JL(p,g,C,E){this.tag=p,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qi(p,g,C,E){return new JL(p,g,C,E)}function Ob(p){return p=p.prototype,!(!p||!p.isReactComponent)}function ZL(p){if(typeof p=="function")return Ob(p)?1:0;if(p!=null){if(p=p.$$typeof,p===y)return 11;if(p===S)return 14}return 2}function So(p,g){var C=p.alternate;return C===null?(C=qi(p.tag,g,p.key,p.mode),C.elementType=p.elementType,C.type=p.type,C.stateNode=p.stateNode,C.alternate=p,p.alternate=C):(C.pendingProps=g,C.type=p.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=p.flags&14680064,C.childLanes=p.childLanes,C.lanes=p.lanes,C.child=p.child,C.memoizedProps=p.memoizedProps,C.memoizedState=p.memoizedState,C.updateQueue=p.updateQueue,g=p.dependencies,C.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},C.sibling=p.sibling,C.index=p.index,C.ref=p.ref,C}function ug(p,g,C,E,P,O){var X=2;if(E=p,typeof p=="function")Ob(p)&&(X=1);else if(typeof p=="string")X=5;else e:switch(p){case u:return tc(C.children,P,O,g);case f:X=8,P|=8;break;case h:return p=qi(12,C,g,P|2),p.elementType=h,p.lanes=O,p;case x:return p=qi(13,C,g,P),p.elementType=x,p.lanes=O,p;case b:return p=qi(19,C,g,P),p.elementType=b,p.lanes=O,p;case k:return dg(C,P,O,g);default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case m:X=10;break e;case v:X=9;break e;case y:X=11;break e;case S:X=14;break e;case w:X=16,E=null;break e}throw Error(s(130,p==null?p:typeof p,""))}return g=qi(X,C,g,P),g.elementType=p,g.type=E,g.lanes=O,g}function tc(p,g,C,E){return p=qi(7,p,E,g),p.lanes=C,p}function dg(p,g,C,E){return p=qi(22,p,E,g),p.elementType=k,p.lanes=C,p.stateNode={isHidden:!1},p}function Ib(p,g,C){return p=qi(6,p,null,g),p.lanes=C,p}function Lb(p,g,C){return g=qi(4,p.children!==null?p.children:[],p.key,g),g.lanes=C,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}function eB(p,g,C,E,P){this.tag=g,this.containerInfo=p,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ie,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_1(0),this.expirationTimes=_1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_1(0),this.identifierPrefix=E,this.onRecoverableError=P,Z&&(this.mutableSourceEagerHydrationData=null)}function iE(p,g,C,E,P,O,X,oe,pe){return p=new eB(p,g,C,oe,pe),g===1?(g=1,O===!0&&(g|=8)):g=0,O=qi(3,null,null,g),p.current=O,O.stateNode=p,O.memoizedState={element:E,isDehydrated:C,cache:null,transitions:null,pendingSuspenseBoundaries:null},q1(O),p}function aE(p){if(!p)return Fi;p=p._reactInternals;e:{if(A(p)!==p||p.tag!==1)throw Error(s(170));var g=p;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Yn(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(s(171))}if(p.tag===1){var C=p.type;if(Yn(C))return jN(p,C,g)}return g}function sE(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(s(188)):(p=Object.keys(p).join(","),Error(s(268,p)));return p=R(g),p===null?null:p.stateNode}function oE(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var C=p.retryLane;p.retryLane=C!==0&&C<g?C:g}}function fg(p,g){oE(p,g),(p=p.alternate)&&oE(p,g)}function tB(p){return p=R(p),p===null?null:p.stateNode}function rB(){return null}return r.attemptContinuousHydration=function(p){if(p.tag===13){var g=$a(p,134217728);if(g!==null){var C=Ln();Wi(g,p,134217728,C)}fg(p,134217728)}},r.attemptDiscreteHydration=function(p){if(p.tag===13){var g=$a(p,1);if(g!==null){var C=Ln();Wi(g,p,1,C)}fg(p,1)}},r.attemptHydrationAtCurrentPriority=function(p){if(p.tag===13){var g=bo(p),C=$a(p,g);if(C!==null){var E=Ln();Wi(C,p,g,E)}fg(p,g)}},r.attemptSynchronousHydration=function(p){switch(p.tag){case 3:var g=p.stateNode;if(g.current.memoizedState.isDehydrated){var C=bf(g.pendingLanes);C!==0&&(A1(g,C|1),ui(g,an()),!(yt&6)&&(Eu(),Va()))}break;case 13:Y4(function(){var E=$a(p,1);if(E!==null){var P=Ln();Wi(E,p,1,P)}}),fg(p,1)}},r.batchedUpdates=function(p,g){var C=yt;yt|=1;try{return p(g)}finally{yt=C,yt===0&&(Eu(),jm&&Va())}},r.createComponentSelector=function(p){return{$$typeof:Qm,value:p}},r.createContainer=function(p,g,C,E,P,O,X){return iE(p,g,!1,null,C,E,P,O,X)},r.createHasPseudoClassSelector=function(p){return{$$typeof:Jm,value:p}},r.createHydrationContainer=function(p,g,C,E,P,O,X,oe,pe){return p=iE(C,E,!0,p,P,O,X,oe,pe),p.context=aE(null),C=p.current,E=Ln(),P=bo(C),O=Es(E,P),O.callback=g??null,vo(C,O,P),p.current.lanes=P,wf(p,P,E),ui(p,E),p},r.createPortal=function(p,g,C){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:E==null?null:""+E,children:p,containerInfo:g,implementation:C}},r.createRoleSelector=function(p){return{$$typeof:Zm,value:p}},r.createTestNameSelector=function(p){return{$$typeof:eg,value:p}},r.createTextSelector=function(p){return{$$typeof:tg,value:p}},r.deferredUpdates=function(p){var g=Pt,C=_r.transition;try{return _r.transition=null,Pt=16,p()}finally{Pt=g,_r.transition=C}},r.discreteUpdates=function(p,g,C,E,P){var O=Pt,X=_r.transition;try{return _r.transition=null,Pt=1,p(g,C,E,P)}finally{Pt=O,_r.transition=X,yt===0&&Eu()}},r.findAllNodes=Cb,r.findBoundingRects=function(p,g){if(!Ce)throw Error(s(363));g=Cb(p,g),p=[];for(var C=0;C<g.length;C++)p.push(Ve(g[C]));for(g=p.length-1;0<g;g--){C=p[g];for(var E=C.x,P=E+C.width,O=C.y,X=O+C.height,oe=g-1;0<=oe;oe--)if(g!==oe){var pe=p[oe],ke=pe.x,$e=ke+pe.width,ot=pe.y,Me=ot+pe.height;if(E>=ke&&O>=ot&&P<=$e&&X<=Me){p.splice(g,1);break}else if(E!==ke||C.width!==pe.width||Me<O||ot>X){if(!(O!==ot||C.height!==pe.height||$e<E||ke>P)){ke>E&&(pe.width+=ke-E,pe.x=E),$e<P&&(pe.width=P-ke),p.splice(g,1);break}}else{ot>O&&(pe.height+=ot-O,pe.y=O),Me<X&&(pe.height=X-ot),p.splice(g,1);break}}}return p},r.findHostInstance=sE,r.findHostInstanceWithNoPortals=function(p){return p=D(p),p=p!==null?$(p):null,p===null?null:p.stateNode},r.findHostInstanceWithWarning=function(p){return sE(p)},r.flushControlled=function(p){var g=yt;yt|=1;var C=_r.transition,E=Pt;try{_r.transition=null,Pt=1,p()}finally{Pt=E,_r.transition=C,yt=g,yt===0&&(Eu(),Va())}},r.flushPassiveEffects=ec,r.flushSync=Y4,r.focusWithin=function(p,g){if(!Ce)throw Error(s(363));for(p=wb(p),g=W4(p,g),g=Array.from(g),p=0;p<g.length;){var C=g[p++];if(!Oe(C)){if(C.tag===5&&ct(C.stateNode))return!0;for(C=C.child;C!==null;)g.push(C),C=C.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Pt},r.getFindAllNodesFailureDescription=function(p,g){if(!Ce)throw Error(s(363));var C=0,E=[];p=[wb(p),0];for(var P=0;P<p.length;){var O=p[P++],X=p[P++],oe=g[X];if((O.tag!==5||!Oe(O))&&(Sb(O,oe)&&(E.push(kb(oe)),X++,X>C&&(C=X)),X<g.length))for(O=O.child;O!==null;)p.push(O,X),O=O.sibling}if(C<g.length){for(p=[];C<g.length;C++)p.push(kb(g[C]));return`findAllNodes was able to match part of the selector:
  `+(E.join(" > ")+`

No matching component was found for:
  `)+p.join(" > ")}return null},r.getPublicRootInstance=function(p){if(p=p.current,!p.child)return null;switch(p.child.tag){case 5:return z(p.child.stateNode);default:return p.child.stateNode}},r.injectIntoDevTools=function(p){if(p={bundleType:p.bundleType,version:p.version,rendererPackageName:p.rendererPackageName,rendererConfig:p.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:tB,findFiberByHostInstance:p.findFiberByHostInstance||rB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")p=!1;else{var g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(g.isDisabled||!g.supportsFiber)p=!0;else{try{Tm=g.inject(p),za=g}catch{}p=!!g.checkDCE}}return p},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(p,g,C,E){if(!Ce)throw Error(s(363));p=Cb(p,g);var P=xt(p,C,E).disconnect;return{disconnect:function(){P()}}},r.registerMutableSourceForHydration=function(p,g){var C=g._getVersion;C=C(g._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[g,C]:p.mutableSourceEagerHydrationData.push(g,C)},r.runWithPriority=function(p,g){var C=Pt;try{return Pt=p,g()}finally{Pt=C}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(p,g,C,E){var P=g.current,O=Ln(),X=bo(P);return C=aE(C),g.context===null?g.context=C:g.pendingContext=C,g=Es(O,X),g.payload={element:p},E=E===void 0?null:E,E!==null&&(g.callback=E),p=vo(P,g,X),p!==null&&(Wi(p,P,X,O),Im(p,P,X)),X},r};aL.exports=qce;var Kce=aL.exports;const Yce=Gp(Kce);var sL={exports:{}},fu={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */fu.ConcurrentRoot=1;fu.ContinuousEventPriority=4;fu.DefaultEventPriority=16;fu.DiscreteEventPriority=1;fu.IdleEventPriority=536870912;fu.LegacyRoot=0;sL.exports=fu;var oL=sL.exports;const VM={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let $M=!1,UM=!1;const CN=".react-konva-event",Xce=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,Qce=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,Jce={};function N1(t,e,r=Jce){if(!$M&&"zIndex"in e&&(console.warn(Qce),$M=!0),!UM&&e.draggable){var n=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;n&&!i&&(console.warn(Xce),UM=!0)}for(var a in r)if(!VM[a]){var s=a.slice(0,2)==="on",o=r[a]!==e[a];if(s&&o){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),t.off(l,r[a])}var c=!e.hasOwnProperty(a);c&&t.setAttr(a,void 0)}var u=e._useStrictMode,f={},h=!1;const m={};for(var a in e)if(!VM[a]){var s=a.slice(0,2)==="on",v=r[a]!==e[a];if(s&&v){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e[a]&&(m[l]=e[a])}!s&&(e[a]!==r[a]||u&&e[a]!==t.getAttr(a))&&(h=!0,f[a]=e[a])}h&&(t.setAttrs(f),Gl(t));for(var l in m)t.on(l+CN,m[l])}function Gl(t){if(!pt.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const lL={},Zce={};Up.Node.prototype._applyProps=N1;function eue(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),Gl(t)}function tue(t,e,r){let n=Up[t];n||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=Up.Group);const i={},a={};for(var s in e){var o=s.slice(0,2)==="on";o?a[s]=e[s]:i[s]=e[s]}const l=new n(i);return N1(l,a),l}function rue(t,e,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function nue(t,e,r){return!1}function iue(t){return t}function aue(){return null}function sue(){return null}function oue(t,e,r,n){return Zce}function lue(){}function cue(t){}function uue(t,e){return!1}function due(){return lL}function fue(){return lL}const hue=setTimeout,pue=clearTimeout,mue=-1;function gue(t,e){return!1}const vue=!1,yue=!0,xue=!0;function bue(t,e){e.parent===t?e.moveToTop():t.add(e),Gl(t)}function wue(t,e){e.parent===t?e.moveToTop():t.add(e),Gl(t)}function cL(t,e,r){e._remove(),t.add(e),e.setZIndex(r.getZIndex()),Gl(t)}function Sue(t,e,r){cL(t,e,r)}function kue(t,e){e.destroy(),e.off(CN),Gl(t)}function Cue(t,e){e.destroy(),e.off(CN),Gl(t)}function Nue(t,e,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function Eue(t,e,r){}function Tue(t,e,r,n,i){N1(t,i,n)}function jue(t){t.hide(),Gl(t)}function Mue(t){}function Pue(t,e){(e.visible==null||e.visible)&&t.show()}function _ue(t,e){}function Aue(t){}function Rue(){}const Due=()=>oL.DefaultEventPriority,Oue=Object.freeze(Object.defineProperty({__proto__:null,appendChild:bue,appendChildToContainer:wue,appendInitialChild:eue,cancelTimeout:pue,clearContainer:Aue,commitMount:Eue,commitTextUpdate:Nue,commitUpdate:Tue,createInstance:tue,createTextInstance:rue,detachDeletedInstance:Rue,finalizeInitialChildren:nue,getChildHostContext:fue,getCurrentEventPriority:Due,getPublicInstance:iue,getRootHostContext:due,hideInstance:jue,hideTextInstance:Mue,idlePriority:Th.unstable_IdlePriority,insertBefore:cL,insertInContainerBefore:Sue,isPrimaryRenderer:vue,noTimeout:mue,now:Th.unstable_now,prepareForCommit:aue,preparePortalMount:sue,prepareUpdate:oue,removeChild:kue,removeChildFromContainer:Cue,resetAfterCommit:lue,resetTextContent:cue,run:Th.unstable_runWithPriority,scheduleTimeout:hue,shouldDeprioritizeSubtree:uue,shouldSetTextContent:gue,supportsMutation:xue,unhideInstance:Pue,unhideTextInstance:_ue,warnsIfNotActing:yue},Symbol.toStringTag,{value:"Module"}));var Iue=Object.defineProperty,Lue=Object.defineProperties,Bue=Object.getOwnPropertyDescriptors,GM=Object.getOwnPropertySymbols,Fue=Object.prototype.hasOwnProperty,zue=Object.prototype.propertyIsEnumerable,HM=(t,e,r)=>e in t?Iue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,WM=(t,e)=>{for(var r in e||(e={}))Fue.call(e,r)&&HM(t,r,e[r]);if(GM)for(var r of GM(e))zue.call(e,r)&&HM(t,r,e[r]);return t},Vue=(t,e)=>Lue(t,Bue(e)),qM,KM;typeof window<"u"&&((qM=window.document)!=null&&qM.createElement||((KM=window.navigator)==null?void 0:KM.product)==="ReactNative")?q.useLayoutEffect:q.useEffect;function uL(t,e,r){if(!t)return;if(r(t)===!0)return t;let n=e?t.return:t.child;for(;n;){const i=uL(n,e,r);if(i)return i;n=e?null:n.sibling}}function dL(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const YM=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=YM;return}return YM.apply(this,arguments)};const NN=dL(q.createContext(null));class fL extends q.Component{render(){return q.createElement(NN.Provider,{value:this._reactInternals},this.props.children)}}function $ue(){const t=q.useContext(NN);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=q.useId();return q.useMemo(()=>{for(const n of[t,t==null?void 0:t.alternate]){if(!n)continue;const i=uL(n,!1,a=>{let s=a.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(i)return i}},[t,e])}function Uue(){const t=$ue(),[e]=q.useState(()=>new Map);e.clear();let r=t;for(;r;){if(r.type&&typeof r.type=="object"){const i=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;i&&i!==NN&&!e.has(i)&&e.set(i,q.useContext(dL(i)))}r=r.return}return e}function Gue(){const t=Uue();return q.useMemo(()=>Array.from(t.keys()).reduce((e,r)=>n=>q.createElement(e,null,q.createElement(r.Provider,Vue(WM({},n),{value:t.get(r)}))),e=>q.createElement(fL,WM({},e))),[t])}function Hue(t){const e=kt.useRef({});return kt.useLayoutEffect(()=>{e.current=t}),kt.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const Wue=t=>{const e=kt.useRef(),r=kt.useRef(),n=kt.useRef(),i=Hue(t),a=Gue(),s=o=>{const{forwardedRef:l}=t;l&&(typeof l=="function"?l(o):l.current=o)};return kt.useLayoutEffect(()=>(r.current=new Up.Stage({width:t.width,height:t.height,container:e.current}),s(r.current),n.current=Eh.createContainer(r.current,oL.LegacyRoot,!1,null),Eh.updateContainer(kt.createElement(a,{},t.children),n.current),()=>{Up.isBrowser&&(s(null),Eh.updateContainer(null,n.current,null),r.current.destroy())}),[]),kt.useLayoutEffect(()=>{s(r.current),N1(r.current,t,i),Eh.updateContainer(kt.createElement(a,{},t.children),n.current,null)}),kt.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},XM="Layer",QM="Rect",que="Line",Kue="Image",Yue="Text",Xue="Transformer",Eh=Yce(Oue);Eh.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:kt.version,rendererPackageName:"react-konva"});const Que=kt.forwardRef((t,e)=>kt.createElement(fL,{},kt.createElement(Wue,{...t,forwardedRef:e}))),LS=({stepNumber:t,title:e,isOpen:r,onClick:n,children:i})=>d.jsxs("div",{className:`border border-white/10 rounded-2xl bg-[#13141f] overflow-hidden transition-all duration-300 ${r?"ring-1 ring-primary/50":"opacity-80"}`,children:[d.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between p-6 hover:bg-white/5 transition-colors",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:`size-8 rounded-full flex items-center justify-center font-black text-sm ${r?"bg-primary text-white":"bg-white/10 text-slate-400"}`,children:t}),d.jsx("h3",{className:`text-lg font-bold ${r?"text-white":"text-slate-400"}`,children:e})]}),d.jsx("span",{className:`material-symbols-outlined transition-transform duration-300 ${r?"rotate-180 text-primary":"text-slate-500"}`,children:"expand_more"})]}),r&&d.jsx("div",{className:"p-6 pt-0 border-t border-white/5 animate-in fade-in slide-in-from-top-2",children:i})]}),BS=({icon:t,title:e,desc:r,selected:n,onClick:i})=>d.jsxs("div",{onClick:i,className:`p-6 rounded-xl border cursor-pointer transition-all relative group h-full flex flex-col justify-between ${n?"bg-primary/20 border-primary shadow-[0_0_30px_rgba(var(--color-primary),0.3)]":"bg-[#0a0a0c] border-white/10 hover:border-white/30"}`,children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("div",{className:`size-12 rounded-lg flex items-center justify-center mb-4 ${n?"bg-primary text-white":"bg-white/10 text-slate-400 group-hover:text-white group-hover:bg-white/20"}`,children:d.jsx("span",{className:"material-symbols-outlined text-2xl",children:t})}),d.jsx("h4",{className:"font-bold text-white mb-1",children:e}),d.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:r})]}),n&&d.jsx("div",{className:"absolute top-4 right-4 size-3 bg-primary rounded-full shadow-glow"})]}),Jue=({src:t,x:e,y:r,width:n,height:i})=>{const[a,s]=q.useState(null);return q.useEffect(()=>{if(!t)return;const o=new window.Image;o.src=t,o.crossOrigin="Anonymous",o.onload=()=>{s(o)}},[t]),d.jsx(Kue,{image:a,x:e,y:r,width:n,height:i})},Zue=({selectedId:t})=>{const e=kt.useRef();return kt.useEffect(()=>{if(t){const r=e.current.getStage().findOne("#"+t);r&&(e.current.nodes([r]),e.current.getLayer().batchDraw())}else e.current.nodes([])},[t]),d.jsx(Xue,{ref:e})},JM=({mode:t})=>{var ie;const{username:e,projectName:r,folderId:n,entityId:i}=Bi(),a=Li(),s=Jc(),{setRightOpen:o,setRightPanelMode:l,setAvailableTemplates:c,mapSettings:u,setMapSettings:f,setOnMapSettingsChange:h}=jl(),[m,v]=q.useState(t==="create"?"setup":"editor");q.useEffect(()=>{v(t==="create"?"setup":"editor")},[t]);const[y,x]=q.useState(((ie=s.state)==null?void 0:ie.folderId)||null),[b,S]=q.useState(1),[w,k]=q.useState({name:"New Map",description:"",parentZone:null,type:"regional",sourceType:"blank",dims:{width:800,height:600},bgImage:null}),[N,j]=q.useState(!1),[T,M]=q.useState("brush"),[A,_]=q.useState([]),[D,R]=q.useState([]),[I,$]=q.useState([]),[B,z]=q.useState(null),U=kt.useRef(!1),[F,Q]=q.useState({isOpen:!1,id:null,text:""}),K=V=>{V.target===V.target.getStage()&&z(null)},L=V=>{K(V);const te=V.target.getStage().getPointerPosition();T!=="select"&&(U.current=!0,T==="brush"||T==="eraser"?_([...A,{id:`line-${Date.now()}`,tool:T,points:[te.x,te.y],color:T==="eraser"?"#ffffff":"#df4b26",size:T==="eraser"?20:5}]):T==="rect"?R([...D,{id:`rect-${Date.now()}`,x:te.x,y:te.y,width:0,height:0,color:"#df4b26"}]):T==="text"&&($([...I,{id:`text-${Date.now()}`,x:te.x,y:te.y,text:"Double click to edit",fontSize:20,color:"#ffffff"}]),U.current=!1))},G=V=>{if(!U.current)return;const te=V.target.getStage().getPointerPosition();T==="brush"||T==="eraser"?_(Z=>{const ue=[...Z],ge={...ue[ue.length-1]};return ge.points=ge.points.concat([te.x,te.y]),ue[ue.length-1]=ge,ue}):T==="rect"&&R(Z=>{const ue=[...Z],ge={...ue[ue.length-1]};return ge.width=te.x-ge.x,ge.height=te.y-ge.y,ue[ue.length-1]=ge,ue})},ee=()=>{U.current=!1};q.useEffect(()=>{if(o(m==="editor"),m==="editor"){l("MAP");const V={showGrid:!0,gridSize:50,width:w.dims.width,height:w.dims.height};f(V),h(Y=>{Y&&k(te=>({...te,dims:{width:Y.width,height:Y.height}}))})}},[m]),q.useEffect(()=>{t==="create"&&!y&&n&&(console.log("Resolving folder ID for slug:",n),Ne.get(`/world-bible/folders/${n}`).then(V=>x(V.id)).catch(V=>console.error("Could not resolve folder ID",V)))},[t,n,y]);const re=V=>{const Y=V.target.files[0];if(Y){const te=new FileReader;te.onload=Z=>{const ue=new Image;ue.onload=()=>{k(ge=>({...ge,bgImage:Z.target.result,dims:{width:ue.width,height:ue.height},sourceType:"upload"}))},ue.src=Z.target.result},te.readAsDataURL(Y)}},se=kt.useRef(null),de=async()=>{if(!y){alert("Folder context missing. Please start from the folder view again.");return}j(!0);try{let V=w.bgImage;if(se.current){const Z=se.current.findOne("Transformer");if(Z&&Z.nodes([]),V=se.current.toDataURL({pixelRatio:.5}),Z&&B){const ue=se.current.findOne("#"+B);ue&&Z.nodes([ue])}}const Y={nombre:w.name,tipoEspecial:"map",carpetaId:y,descripcion:JSON.stringify({description:w.description,type:w.type,width:w.dims.width,height:w.dims.height,bgImage:w.bgImage,layers:{lines:A,rectangles:D,texts:I},snapshotUrl:V}),iconUrl:V},te=await Ne.post("/world-bible/entities",Y);window.dispatchEvent(new CustomEvent("folder-update",{detail:{folderId:y}})),a(`/${e}/${r}/map-editor/edit/${te.id}`,{replace:!0})}catch(V){console.error(V),alert("Error creating map. Check console.")}finally{j(!1)}},W=kt.useRef(null);q.useEffect(()=>{(!t||t==="edit")&&i&&Ne.get(`/world-bible/entities/${i}`).then(V=>{x(V.carpetaId),W.current=V.iconUrl,v("editor");let Y={};try{Y=V.descripcion?JSON.parse(V.descripcion):{}}catch(te){console.error("Error parsing map data",te)}k({name:V.nombre,description:Y.description||"",parentZone:null,type:Y.type||"regional",sourceType:Y.bgImage?"upload":"blank",dims:{width:Y.width||800,height:Y.height||600},bgImage:Y.bgImage}),Y.layers&&(_(Y.layers.lines||[]),R(Y.layers.rectangles||[]),$(Y.layers.texts||[])),f({name:V.nombre,description:Y.description||"",type:Y.type||"regional",showGrid:!0,gridSize:50,width:Y.width||800,height:Y.height||600,bgImage:Y.bgImage})}).catch(V=>console.error("Error loading entity",V))},[t,i]);const ne=async()=>{j(!0);try{let V=w.bgImage;if(se.current){z(null);const te=se.current.findOne("Transformer");te&&te.nodes([]),V=se.current.toDataURL({pixelRatio:.5})}const Y={id:i,nombre:w.name,tipoEspecial:"map",carpetaId:y,descripcion:JSON.stringify({description:w.description,type:w.type,width:w.dims.width,height:w.dims.height,bgImage:w.bgImage,layers:{lines:A,rectangles:D,texts:I},snapshotUrl:V}),iconUrl:W.current};await Ne.put(`/world-bible/entities/${i}`,Y),a(y?`/${e}/${r}/bible/folder/${y}`:`/${e}/${r}/bible`)}catch(V){console.error("Save failed",V),alert("Error saving map")}finally{j(!1)}};return m==="setup"?d.jsxs("div",{className:"flex-1 flex flex-col h-screen bg-[#060608] text-white",children:[d.jsxs("div",{className:"h-16 border-b border-white/5 flex items-center justify-between px-8 bg-[#0a0a0c]",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"p-2 bg-primary/20 rounded-lg text-primary",children:d.jsx("span",{className:"material-symbols-outlined",children:"add_circle"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-lg font-bold leading-tight",children:"Create New Map / Zone"}),d.jsx("p",{className:"text-[10px] text-slate-500 uppercase font-bold tracking-wider",children:"Configure details for your new cartography entry"})]})]}),d.jsx("button",{onClick:()=>a(-1),className:"p-2 hover:bg-white/5 rounded-full text-slate-500 hover:text-white transition-colors",children:d.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),d.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-8",children:d.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[d.jsx(LS,{stepNumber:"1",title:"Identity & Hierarchy",isOpen:b===1,onClick:()=>S(1),children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Map Name"}),d.jsx("input",{autoFocus:!0,value:w.name,onChange:V=>k({...w,name:V.target.value}),className:"w-full bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-white focus:border-primary outline-none transition-colors",placeholder:"e.g. The Sapphire Coast"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Parent Zone (Optional)"}),d.jsxs("div",{className:"w-full bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-slate-400 flex items-center justify-between cursor-pointer hover:border-white/20",children:[d.jsx("span",{children:"Current Folder (Default)"}),d.jsx("span",{className:"material-symbols-outlined text-sm",children:"expand_more"})]}),d.jsx("p",{className:"text-[10px] text-slate-600 mt-2",children:"Selecting a parent makes this a sub-zone."})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-500 mb-2 block",children:"Description"}),d.jsx("textarea",{value:w.description,onChange:V=>k({...w,description:V.target.value}),className:"w-full h-40 bg-[#0a0a0c] border border-white/10 rounded-xl p-4 text-white resize-none focus:border-primary outline-none transition-colors leading-relaxed",placeholder:"Brief description of geography, climate, or importance..."})]})]})}),d.jsx(LS,{stepNumber:"2",title:"Map Type",isOpen:b===2,onClick:()=>S(2),children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsx(BS,{icon:"public",title:"World Map",desc:"Continents, oceans, global scale.",selected:w.type==="world",onClick:()=>k({...w,type:"world"})}),d.jsx(BS,{icon:"map",title:"Regional Map",desc:"Kingdoms, provinces, biomes.",selected:w.type==="regional",onClick:()=>k({...w,type:"regional"})}),d.jsx(BS,{icon:"location_city",title:"City / Local",desc:"Cities, dungeons, battlemaps.",selected:w.type==="local",onClick:()=>k({...w,type:"local"})})]})}),d.jsx(LS,{stepNumber:"3",title:"Canvas Source",isOpen:b===3,onClick:()=>S(3),children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{onClick:()=>document.getElementById("map-upload-input").click(),className:`relative p-8 rounded-xl border-2 border-dashed flex flex-col items-center justify-center text-center cursor-pointer transition-all group min-h-[200px] ${w.sourceType==="upload"?"border-primary bg-primary/5":"border-white/10 hover:border-white/30 bg-[#0a0a0c]"}`,children:[d.jsx("input",{id:"map-upload-input",type:"file",accept:"image/*",className:"hidden",onChange:re}),w.bgImage?d.jsx("img",{src:w.bgImage,alt:"Preview",className:"absolute inset-0 w-full h-full object-cover rounded-xl opacity-50 group-hover:opacity-70"}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"size-16 bg-white/5 rounded-full flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:d.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"cloud_upload"})}),d.jsx("h4",{className:"font-bold text-white",children:"Upload Image File"}),d.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Drag & drop or click to browse"}),d.jsx("p",{className:"text-[10px] text-slate-600 mt-1 uppercase font-bold",children:"JPG, PNG, WEBP  Max 20MB"})]}),w.sourceType==="upload"&&d.jsx("div",{className:"absolute top-4 right-4 size-3 bg-primary rounded-full shadow-glow z-10"})]}),d.jsxs("div",{onClick:()=>k({...w,sourceType:"blank",bgImage:null}),className:`p-8 rounded-xl border flex flex-col items-center justify-center text-center cursor-pointer transition-all min-h-[200px] ${w.sourceType==="blank"?"border-primary bg-primary/5":"border-white/10 hover:border-white/30 bg-[#0a0a0c]"}`,children:[d.jsx("div",{className:"size-16 bg-white/5 rounded-full flex items-center justify-center mb-4",children:d.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-400",children:"check_box_outline_blank"})}),d.jsx("h4",{className:"font-bold text-white",children:"Blank Canvas"}),d.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Start a new drawing from scratch"}),w.sourceType==="blank"&&d.jsxs("div",{className:"mt-6 flex items-center gap-2 bg-black/50 p-1 rounded-lg border border-white/10",children:[d.jsx("span",{className:"text-[10px] uppercase font-bold text-slate-500 px-2",children:"Size"}),d.jsx("span",{className:"text-xs font-mono text-white",children:"4096 px"}),d.jsx("span",{className:"text-xs text-slate-500",children:"x"}),d.jsx("span",{className:"text-xs font-mono text-white",children:"4096 px"})]})]})]})})]})}),d.jsxs("div",{className:"h-20 border-t border-white/5 bg-[#0a0a0c] flex items-center justify-between px-8 z-20",children:[d.jsx("button",{onClick:()=>a(-1),className:"text-sm font-bold text-slate-500 hover:text-white transition-colors",children:"Cancel"}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("span",{className:"text-xs text-slate-600 italic",children:"Changes saved locally"}),d.jsx(Wt,{variant:"primary",size:"lg",icon:"check",onClick:de,disabled:!w.name||N,className:"bg-primary hover:bg-primary-light text-white shadow-lg shadow-primary/25 px-8",children:N?"Creating...":"Create Map"})]})]})]}):d.jsxs("div",{className:"flex flex-col h-screen w-full bg-[#0f0f13] text-white overflow-hidden",children:[d.jsxs("header",{className:"h-14 border-b border-white/5 flex items-center justify-between px-4 bg-[#1a1a20] shrink-0",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("button",{onClick:()=>a(-1),className:"p-2 hover:bg-white/5 rounded-full",title:"Back to Collection",children:d.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_back"})}),d.jsxs("div",{className:"flex flex-col",children:[d.jsx("input",{value:w.name,onChange:V=>k({...w,name:V.target.value}),className:"bg-transparent font-bold text-sm outline-none focus:bg-white/5 rounded px-2 -ml-2"}),d.jsxs("span",{className:"text-[10px] text-text-muted px-2",children:[w.dims.width," x ",w.dims.height,"  ",(u==null?void 0:u.gridSize)||50,"px Grid"]})]})]}),d.jsx("div",{className:"flex items-center gap-2",children:d.jsx(Wt,{variant:"primary",size:"sm",icon:"save",onClick:ne,disabled:N,children:N?"Saving...":"Save Changes"})})]}),d.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[d.jsx("div",{className:"w-14 bg-[#1a1a20] border-r border-white/5 flex flex-col items-center py-4 gap-4 z-10",children:[{id:"select",icon:"near_me"},{id:"brush",icon:"brush"},{id:"eraser",icon:"ink_eraser"},{id:"rect",icon:"check_box_outline_blank"},{id:"text",icon:"title"}].map(V=>d.jsx("button",{onClick:()=>M(V.id),className:`p-2 rounded-lg transition-colors ${T===V.id?"bg-primary text-white shadow-lg shadow-primary/30":"hover:bg-white/5 text-slate-400 hover:text-white"}`,children:d.jsx("span",{className:"material-symbols-outlined",children:V.icon})},V.id))}),d.jsx("div",{className:"flex-1 overflow-auto bg-[#0f0f13] relative flex items-center justify-center p-8 custom-scrollbar",children:d.jsx("div",{className:"bg-[#1a1a20] shadow-[0_0_50px_rgba(0,0,0,0.5)] flex-none",children:d.jsxs(Que,{ref:se,width:w.dims.width,height:w.dims.height,onMouseDown:L,onMouseMove:G,onMouseUp:ee,className:"bg-white",children:[d.jsxs(XM,{children:[w.bgImage&&d.jsx(Jue,{src:w.bgImage,x:0,y:0,width:w.dims.width,height:w.dims.height}),(u==null?void 0:u.showGrid)&&d.jsx(QM,{width:w.dims.width,height:w.dims.height,fillPatternImage:(()=>{const V=document.createElement("canvas");V.width=u.gridSize||50,V.height=u.gridSize||50;const Y=V.getContext("2d");return Y.strokeStyle="rgba(0,0,0,0.2)",Y.lineWidth=1,Y.strokeRect(0,0,V.width,V.height),V})(),listening:!1})]}),d.jsxs(XM,{children:[A.map((V,Y)=>d.jsx(que,{points:V.points,stroke:V.color,strokeWidth:V.size,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:V.tool==="eraser"?"destination-out":"source-over"},Y)),D.map((V,Y)=>d.jsx(QM,{id:V.id,x:V.x,y:V.y,width:V.width,height:V.height,stroke:V.color,strokeWidth:2,draggable:T==="select",onClick:()=>T==="select"&&z(V.id),onTap:()=>T==="select"&&z(V.id)},V.id)),I.map((V,Y)=>d.jsx(Yue,{id:V.id,x:V.x,y:V.y,text:V.text,fontSize:V.fontSize,fill:V.color,draggable:T==="select",onClick:()=>T==="select"&&z(V.id),onTap:()=>T==="select"&&z(V.id),onDblClick:te=>{Q({isOpen:!0,id:V.id,text:V.text})}},V.id)),d.jsx(Zue,{selectedId:B})]})]})})})]}),d.jsx(Lk,{isOpen:F.isOpen,onClose:()=>Q(V=>({...V,isOpen:!1})),title:"Edit Map Text",initialValue:F.text,onConfirm:V=>{$(Y=>Y.map(te=>te.id===F.id?{...te,text:V}:te))},confirmText:"Save Text"})]})};function ede(){return d.jsx(MV,{children:d.jsxs(wV,{children:[d.jsx(pr,{path:"/",element:d.jsx(x$,{})}),d.jsx(pr,{element:d.jsx(h$,{}),children:d.jsxs(pr,{path:"/:username/:projectName",element:d.jsx(k$,{}),children:[d.jsx(pr,{index:!0,element:d.jsx(b$,{})}),d.jsx(pr,{path:"writing",element:d.jsx(Oae,{})}),d.jsx(pr,{path:"entities/:type/:entityId",element:d.jsx(wY,{})}),d.jsx(pr,{path:"settings",element:d.jsx(w$,{})}),d.jsx(pr,{path:"map-editor/create/:folderId",element:d.jsx(JM,{mode:"create"})}),d.jsx(pr,{path:"map-editor/edit/:entityId",element:d.jsx(JM,{mode:"edit"})}),d.jsxs(pr,{path:"bible",element:d.jsx(qae,{}),children:[d.jsx(pr,{index:!0,element:d.jsx(Kae,{})}),d.jsx(pr,{path:"folder/:folderSlug/entity/new/:type",element:d.jsx(uh,{mode:"creation"})}),d.jsx(pr,{path:"folder/:folderSlug",element:d.jsx(Uae,{})}),d.jsx(pr,{path:"entity/:entitySlug",element:d.jsx(uh,{})}),d.jsx(pr,{path:"folder/:folderSlug/entity/:entitySlug",element:d.jsx(uh,{})}),d.jsx(pr,{path:"folder/:folderSlug/map/:entitySlug",element:d.jsx(uh,{})}),d.jsx(pr,{path:"folder/:folderSlug/timeline/:entitySlug",element:d.jsx(uh,{})})]}),d.jsx(pr,{path:"map",element:d.jsx(jY,{})}),d.jsx(pr,{path:"timeline",element:d.jsx(SY,{})}),d.jsx(pr,{path:"languages",element:d.jsx(AY,{})}),d.jsx(pr,{path:"trash",element:d.jsx(Iae,{})}),d.jsx(pr,{path:"graph",element:d.jsx(gY,{})})]})})]})})}const EN=(t,e,r,n="")=>{fetch("/api/logs/error",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:t,message:e,stack:r,componentStack:n})}).catch(i=>console.error("Failed to send error log:",i))};window.onerror=(t,e,r,n,i)=>{EN("Global Window Error",t,i?i.stack:`${e}:${r}:${n}`)};window.onunhandledrejection=t=>{EN("Unhandled Promise Rejection",t.reason?t.reason.message:"Unknown reason",t.reason?t.reason.stack:"")};class tde extends kt.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,r){this.setState({error:e,errorInfo:r}),console.error("Uncaught Error:",e,r),EN("React ErrorBoundary",e.message,e.stack,r.componentStack)}render(){return this.state.hasError?d.jsxs("div",{style:{padding:20,background:"#222",color:"red",height:"100vh"},children:[d.jsx("h1",{children:"Something went wrong."}),d.jsxs("details",{style:{whiteSpace:"pre-wrap"},children:[this.state.error&&this.state.error.toString(),d.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]})]}):this.props.children}}const ZM=document.getElementById("root");ZM?FS.createRoot(ZM).render(d.jsx(kt.StrictMode,{children:d.jsx(tde,{children:d.jsx(ede,{})})})):console.error("React root element not found (looked for #root)");

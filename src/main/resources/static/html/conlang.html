<!DOCTYPE html>
<html class="dark" lang="es">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Chronos Atlas - Taller de Conlangs</title>
    <link rel="stylesheet" href="../css/glass_theme.css">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
        href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&amp;family=Noto+Sans:ital,wght@0,100..900;1,100..900&amp;display=swap"
        rel="stylesheet" />
    <!-- Material Symbols -->
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <!-- OpenType.js -->
    <script src="https://cdn.jsdelivr.net/npm/opentype.js@latest/dist/opentype.min.js"></script>

    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#6467f2",
                        "background-light": "#f6f6f8",
                        "background-dark": "#101122",
                        "glass-border": "rgba(255, 255, 255, 0.08)",
                        "glass-bg": "rgba(30, 31, 58, 0.5)",
                    },
                    fontFamily: {
                        "display": ["Manrope", "sans-serif"],
                        "mono": ["Noto Sans Mono", "monospace"],
                    },
                    borderRadius: { "DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px" },
                    backdropBlur: { 'xs': '2px' }
                },
            },
        }
    </script>
    <style>
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #101122;
        }

        ::-webkit-scrollbar-thumb {
            background: #323367;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #6467f2;
        }

        .glass-panel {
            background: rgba(30, 31, 58, 0.4);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .glass-input {
            background: rgba(16, 17, 34, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
        }

        .glass-input:focus {
            border-color: #6467f2;
            outline: none;
            background: rgba(16, 17, 34, 0.8);
        }

        canvas {
            touch-action: none;
            cursor: crosshair;
        }

        .nav-trigger-container,
        .radial-menu-container {
            z-index: 50 !important;
        }
    </style>
</head>

<!-- Custom Darker BG override -->

<body class="bg-[#020410] text-slate-300 font-display overflow-hidden selection:bg-primary selection:text-white">

    <!-- Top Radial Menu (Restored) -->
    <div class="nav-trigger-container" id="nav-container">
        <div class="nav-trigger" id="nav-trigger"></div>
        <div class="radial-menu-container" id="radial-menu">
            <div class="radial-menu-bg"></div>
            <a href="dashboard.html" class="nav-item" title="Dashboard">
                <span class="material-symbols-outlined">dashboard</span>
                <span class="tooltip">Dashboard</span>
            </a>
            <a href="libreria.html" class="nav-item" title="Librería">
                <span class="material-symbols-outlined">library_books</span>
                <span class="tooltip">Librería</span>
            </a>
            <a href="biblia.html" class="nav-item" title="Biblia">
                <span class="material-symbols-outlined">menu_book</span>
                <span class="tooltip">Biblia</span>
            </a>
            <a href="timeline.html" class="nav-item" title="Cronología">
                <span class="material-symbols-outlined">schedule</span>
                <span class="tooltip">Cronología</span>
            </a>
            <a href="atlas.html" class="nav-item" title="Atlas">
                <span class="material-symbols-outlined">map</span>
                <span class="tooltip">Atlas</span>
            </a>
            <a href="conlang.html" class="nav-item" title="Lingüística">
                <span class="material-symbols-outlined">translate</span>
                <span class="tooltip">Lingüística</span>
            </a>
            <a href="settings.html" class="nav-item" title="Ajustes">
                <span class="material-symbols-outlined">settings</span>
                <span class="tooltip">Ajustes</span>
            </a>
        </div>
    </div>
    <div class="bg-overlay" id="menu-overlay"></div>

    <div class="flex h-screen w-full">
        <!-- Main Content Area -->
        <main class="flex-1 flex flex-col h-full overflow-hidden relative">
            <!-- Background Decoration -->
            <div
                class="absolute top-[-10%] left-[20%] w-[500px] h-[500px] bg-primary/10 rounded-full blur-[100px] pointer-events-none">
            </div>
            <div
                class="absolute bottom-[-10%] right-[-5%] w-[400px] h-[400px] bg-blue-500/10 rounded-full blur-[100px] pointer-events-none">
            </div>

            <div class="flex-1 overflow-y-auto z-10 p-6 lg:p-10 scroll-smooth">
                <div class="max-w-7xl mx-auto flex flex-col gap-6">

                    <!-- Header -->
                    <div class="flex flex-wrap items-end justify-between gap-4">
                        <div>
                            <div class="flex items-center gap-3 mb-1">
                                <h1 class="text-4xl font-black text-white tracking-tight">Taller de Conlangs</h1>
                                <span
                                    class="px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider bg-primary/20 text-primary border border-primary/20">Beta
                                    v2.0</span>
                            </div>
                            <p class="text-slate-400 max-w-2xl">Gestión integral de lenguas construidas. Define
                                fonología, gramática y léxico.</p>
                        </div>
                        <div class="flex items-center gap-3">
                            <div class="flex items-center gap-3">
                                <div class="flex items-center bg-[#1e1f3a] rounded-lg border border-glass-border p-1">
                                    <input id="conlangNameInput" type="text" placeholder="Nombre del Idioma"
                                        class="bg-transparent border-none text-sm text-white focus:ring-0 placeholder-slate-500 w-40 px-2" />
                                    <button onclick="saveConlangAsEntity()"
                                        class="bg-primary/20 hover:bg-primary/40 text-primary p-2 rounded transition-colors"
                                        title="Guardar como Entidad">
                                        <span class="material-symbols-outlined text-[20px]">save</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Row -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="glass-panel p-5 rounded-xl flex items-center justify-between">
                            <div>
                                <p class="text-slate-400 text-sm font-medium mb-1">Palabras Registradas</p>
                                <div class="flex items-baseline gap-2">
                                    <span id="stat-words" class="text-3xl font-bold text-white">...</span>
                                </div>
                            </div>
                            <div
                                class="size-12 rounded-full bg-primary/10 flex items-center justify-center border border-primary/20">
                                <span class="material-symbols-outlined text-primary">dictionary</span>
                            </div>
                        </div>
                        <div class="glass-panel p-5 rounded-xl flex items-center justify-between">
                            <div>
                                <p class="text-slate-400 text-sm font-medium mb-1">Reglas Fonéticas</p>
                                <div class="flex items-baseline gap-2">
                                    <span id="stat-rules" class="text-3xl font-bold text-white">...</span>
                                </div>
                            </div>
                            <div
                                class="size-12 rounded-full bg-purple-500/10 flex items-center justify-center border border-purple-500/20">
                                <span class="material-symbols-outlined text-purple-400">graphic_eq</span>
                            </div>
                        </div>
                        <div class="glass-panel p-5 rounded-xl flex items-center justify-between">
                            <div>
                                <p class="text-slate-400 text-sm font-medium mb-1">Glifos Diseñados</p>
                                <div class="flex items-baseline gap-2">
                                    <span id="stat-glyphs" class="text-3xl font-bold text-white">...</span>
                                </div>
                            </div>
                            <div
                                class="size-12 rounded-full bg-blue-500/10 flex items-center justify-center border border-blue-500/20">
                                <span class="material-symbols-outlined text-blue-400">brush</span>
                            </div>
                        </div>
                    </div>

                    <!-- Main Grid -->
                    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-auto min-h-[600px]">

                        <!-- Col 1: Dictionary (Span 4 - Smaller) -->
                        <div class="lg:col-span-4 flex flex-col glass-panel rounded-xl overflow-hidden h-full">
                            <div class="p-4 border-b border-glass-border flex flex-col gap-3">
                                <h3 class="text-lg font-bold text-white flex items-center gap-2">
                                    <span class="material-symbols-outlined text-primary">search</span>
                                    Diccionario
                                </h3>
                                <div class="relative">
                                    <span
                                        class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-500">search</span>
                                    <input
                                        class="w-full pl-10 pr-4 py-2 rounded-lg text-sm glass-input placeholder-slate-500 focus:ring-1 focus:ring-primary"
                                        placeholder="Buscar palabra..." type="text" />
                                </div>
                            </div>
                            <div class="flex-1 overflow-y-auto p-2">
                                <!-- Dictionary List Placeholder -->
                                <table class="w-full text-left text-sm">
                                    <thead class="text-slate-500 text-xs uppercase font-bold">
                                        <tr>
                                            <th class="px-2 py-1">Lema</th>
                                            <th class="px-2 py-1">IPA</th>
                                        </tr>
                                    </thead>
                                    <tbody id="dictionaryList" class="divide-y divide-glass-border">
                                        <!-- Items will be injected here by JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Col 2: Editor/Canvas (Span 8 - Bigger) -->
                        <div class="lg:col-span-8 flex flex-col gap-6 h-full">
                            <div class="glass-panel rounded-xl p-5 flex flex-col gap-4 h-full relative overflow-hidden">
                                <div class="flex justify-between items-center">
                                    <h3 class="text-base font-bold text-white">Editor de Glifos</h3>
                                    <div class="flex gap-2 items-center">
                                        <!-- Draw Tools -->
                                        <div class="flex bg-white/5 rounded p-0.5 border border-white/10 mr-2">
                                            <button onclick="setMode('free')" id="btnFree" title="Libre"
                                                class="p-1 px-2 rounded hover:bg-white/10 text-primary"><span
                                                    class="material-symbols-outlined text-[18px]">gesture</span></button>
                                            <button onclick="setMode('line')" id="btnLine" title="Línea"
                                                class="p-1 px-2 rounded hover:bg-white/10 text-slate-400"><span
                                                    class="material-symbols-outlined text-[18px]">horizontal_rule</span></button>
                                            <button onclick="setMode('curve')" id="btnCurve" title="Curva"
                                                class="p-1 px-2 rounded hover:bg-white/10 text-slate-400"><span
                                                    class="material-symbols-outlined text-[18px]">gesture_select</span></button>
                                        </div>
                                        <!-- Undo/Redo -->
                                        <div class="flex bg-white/5 rounded p-0.5 border border-white/10 mr-2">
                                            <button onclick="undo()" title="Deshacer"
                                                class="p-1 px-2 rounded hover:bg-white/10 text-slate-300"><span
                                                    class="material-symbols-outlined text-[18px]">undo</span></button>
                                            <button onclick="redo()" title="Rehacer"
                                                class="p-1 px-2 rounded hover:bg-white/10 text-slate-300"><span
                                                    class="material-symbols-outlined text-[18px]">redo</span></button>
                                        </div>
                                        <button onclick="clearCanvas()"
                                            class="text-xs bg-white/5 hover:bg-white/10 px-2 py-1 rounded text-slate-300">Borrar</button>
                                        <button onclick="vectorizeCanvas()"
                                            class="text-xs bg-primary hover:bg-primary/90 px-3 py-1 rounded text-white font-bold">Guardar</button>
                                    </div>
                                </div>

                                <!-- Inputs for New Word -->
                                <div class="grid grid-cols-2 gap-3 mb-2">
                                    <input id="lemaInput" class="w-full px-3 py-2 rounded text-sm glass-input"
                                        placeholder="Lema (ej. 'Agua')" type="text" />
                                    <input id="ipaInput" class="w-full px-3 py-2 rounded text-sm glass-input font-mono"
                                        placeholder="IPA (ej. /a.kwa/)" type="text" />
                                </div>
                                <div id="semanticsTags" class="flex flex-wrap gap-2 min-h-[24px]"></div>

                                <!-- Canvas Area -->
                                <div
                                    class="flex-1 bg-white/5 rounded-lg border border-white/10 flex items-center justify-center relative overflow-hidden min-h-[300px]">
                                    <canvas id="glyphCanvas" width="800" height="600"
                                        class="absolute inset-0 w-full h-full"></canvas>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/api.js"></script>
    <script src="../js/auth_guard.js"></script>
    <script src="../js/conlang.js"></script>
    <script src="../js/navigation.js"></script>
</body>

</html>
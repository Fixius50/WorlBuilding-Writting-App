<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ventana Creación</title>
    <style>
        :root{
            --sombra: #8000ff;
            --fondo: #000000;
        }
        * {
            box-sizing: content-box;
        }
        body{
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-items: center;
            background-color: #000000;/*  Esto ponerlo como lo último*/
        }
        header{
            width: 50%;
            height: auto;
            text-align: center;
            background: url(../imagenes/crear.jpg) center no-repeat;
            background-size: cover;
            color: white;
        }
        header h1{
            text-decoration: underline;
        }
        .zona{
            display: flex;
            flex-direction: row;
        }
        .despliegue{
            flex-grow: 1;
            margin: 1vh;
        }
        .opciones{
            border: 1px solid white;
            margin: 2vh;
            width: 25%;
            height: 50vh;
            overflow: scroll;
            padding-top: 15vh;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            align-content: center;
            justify-content: center;
        }
        .botonSalida{
            color: wheat;
            font-size: medium;
            font-weight: bolder;
            width: auto;
            height: auto;
            padding: 1%;
            position: absolute;
            bottom: 5%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-image: url(../imagenes/casting-spell.gif);
            background-size: cover;
            background-position: bottom 20% center;
            background-repeat: no-repeat;
            cursor: pointer;
        }
        .botonSalida:hover{
            box-shadow: 0vw 0vw 0vw 0vw var(--fondo) inset, 0vw 0vw 5vw 1vw var(--sombra);
        }
        figure{
            width: 30vh;
            height: 30vh;
            margin: 5vh;
            display: flex;
            flex-direction: column;
            justify-content: space-evenly;
            align-items: center;
            overflow: hidden;
            text-align: center;
            box-shadow: 0vw 0vw 0vw 0vw var(--fondo) inset, 0vw 0vw 5vw 1vw var(--sombra);
        }
        figure:hover{
            width: 35vh;
            height: 35vh;
            box-shadow: 0vw 0vw 0vw 1vw white, 0vw 0vw 5vw 1vw yellow;
        }
        figure, figure:hover{
            transition: width 0.5s ease-in-out, height 0.5s ease-in-out;
        }
        figure:hover button{
            width: 20vh;
            height: 5vh;
        }
        /*----Una imagen distinta por cada card----*/
        figure:nth-child(1){ /*ENTIDADES INDIVIDUALES*/
            background: url(../imagenes/mage.png) center no-repeat;
            background-size: cover;
            color: red;
            font-size: large;
        }
        
        figure:nth-child(2){ /*ENTIDADES COLECTIVAS*/
            background: url(../imagenes/colectivas.jpg) center no-repeat;
            background-size: cover;
            color: red;
            font-size: large;
        }

        figure:nth-child(3){ /*EFECTOS MAGIAS*/
            background: url(../imagenes/magia.png) center no-repeat;
            background-size: cover;
            color: red;
            font-size: large;
        }
        
        figure:nth-child(4){ /*CONSTRUCCIONES*/
            background: url(../imagenes/construcciones.jpg) center no-repeat;
            background-size: cover;
            color: red;
            font-size: large;
        }

        figure:nth-child(5){ /*ZONAS*/
            background: url(../imagenes/zonas.png) center no-repeat;
            background-size: cover;
            color: red;
            font-size: large;
        }

        figure:nth-child(6){ /*RELACIONES*/
            background: url(../imagenes/relaciones.jpg) center no-repeat;
            background-size: cover;
            color: red;
            font-size: large;
        }

    </style>
</head>
<body>
    <header>
        <h1>ZONA DE CREACIÓN</h1>
        <code>Selecciona una carta y rellena los datos; luego guardalos para volver al proyecto.</code>
    </header>
    <div class="zona">
        <section class="opciones">
            <figure> <!-- Imagen de lo que es -->
                <figcaption> <!-- Descripción de lo que es -->
                    <h1>ENTIDADES INDIVIDUALES</h1>
                </figcaption>
                <button type="button" onclick="mostrarContenidoRelacionado('opciones/entidad-individual.html')">SELECCIONAR</button>
            </figure>
            <figure> <!-- Imagen de lo que es -->
                <figcaption> <!-- Descripción de lo que es -->
                    <h1>ENTIDADES COLECTIVAS</h1>
                </figcaption>
                <button type="button" onclick="mostrarContenidoRelacionado('opciones/entidad-colectiva.html')">SELECCIONAR</button>
            </figure>
            <figure> <!-- Imagen de lo que es -->
                <figcaption> <!-- Descripción de lo que es -->
                    <h1>EFECTOS Y/O MAGIAS/PODERES</h1>
                </figcaption>
                <button type="button" onclick="mostrarContenidoRelacionado('opciones/efectos-magias.html')">SELECCIONAR</button>
            </figure>
            <figure> <!-- Imagen de lo que es -->
                <figcaption> <!-- Descripción de lo que es -->
                    <h1>CONSTRUCCIONES</h1>
                </figcaption>
                <button type="button" onclick="mostrarContenidoRelacionado('opciones/construcciones.html')">SELECCIONAR</button>
            </figure>
            <figure> <!-- Imagen de lo que es -->
                <figcaption> <!-- Descripción de lo que es -->
                    <h1>ZONAS</h1>
                </figcaption>
                <button type="button" onclick="mostrarContenidoRelacionado('opciones/zonas.html')">SELECCIONAR</button>
            </figure>
            <figure> <!-- Imagen de lo que es -->
                <figcaption> <!-- Descripción de lo que es -->
                    <h1>RELACIONES</h1>
                </figcaption>
                <button type="button" onclick="mostrarContenidoRelacionado('opciones/relaciones.html')">SELECCIONAR</button>
            </figure>
            <button type="button" class="botonSalida" onclick="volverAlProyectoActual()">Volver a la ventana de proyectos </button>
        </section>
        <section class="despliegue"></section>
    </div>
</body>
<script>
    let proyectoActivo = null;

    document.addEventListener('DOMContentLoaded', () => {
        fetch('/api/proyectos/activo')
            .then(res => {
                if (!res.ok) throw new Error("No hay proyecto activo");
                return res.json();
            })
            .then(data => {
                proyectoActivo = data.nombre;
            })
            .catch(err => {
                alert("Error al obtener proyecto activo: " + err.message);
            });
    });

    async function mostrarContenidoRelacionado(nombreArchivoHtml) {
        const despliegue = document.querySelector('.despliegue');
        despliegue.innerHTML = '';

        try {
            const respuesta = await fetch(new URL(nombreArchivoHtml, window.location.href));

            if (!respuesta.ok) {
                throw new Error('No se pudo cargar el panel: ' + nombreArchivoHtml);
            }

            const contenido = await respuesta.text();
            despliegue.innerHTML = contenido;
        } catch (error) {
            despliegue.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
        }
    }

    function volverAlProyectoActual(){
        window.location.href = "../html/ventanaProyectos.html";
    }
</script>
</html>